{"pr_number": 2787, "pr_title": "Cli surface proposal", "pr_createdAt": "2020-09-25T15:37:56Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2787", "timeline": [{"oid": "a8e0cb2820a824e7e7772c0c045f6203b5838281", "url": "https://github.com/GoogleContainerTools/jib/commit/a8e0cb2820a824e7e7772c0c045f6203b5838281", "message": "whatever", "committedDate": "2020-09-24T17:24:02Z", "type": "commit"}, {"oid": "a70c46658b686eacf1fdb314495e90c3a132f46a", "url": "https://github.com/GoogleContainerTools/jib/commit/a70c46658b686eacf1fdb314495e90c3a132f46a", "message": "proposal for jib cli surface", "committedDate": "2020-09-25T15:27:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njk1MDc2NQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r496950765", "bodyText": "super nit: maybe switch the ordering of the \"Commands\" section and \"Options\" section to match the format in the usage section", "author": "mpeddada1", "createdAt": "2020-09-29T18:27:53Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,62 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib command [OPTIONS]`\n+\n+## Options", "originalCommit": "a70c46658b686eacf1fdb314495e90c3a132f46a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njk1MTUxMw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r496951513", "bodyText": "I'm a little unclear about the scope of these parameters. Are these indentations intentional?", "author": "mpeddada1", "createdAt": "2020-09-29T18:29:14Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,62 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib command [OPTIONS]`\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference\n+```\n+\n+### Optional\n+```\n+-b  --build-file <file>                    location of the build file (default ./jib.yaml)\n+    --credHelper <registry>=<credHelper>   credential helper to use for a registry (repeatable)\n+    --docker-config <directory>            location of docker configuration\n+    --help                                 print usage", "originalCommit": "a70c46658b686eacf1fdb314495e90c3a132f46a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njk4Mzk2MQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r496983961", "bodyText": "yeah, generally following the format of some command --help (like ls --help) although I think java --help has a slightly different style. Anyway, the indentations are intentional, I can clean it up a little more though", "author": "loosebazooka", "createdAt": "2020-09-29T19:21:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njk1MTUxMw=="}], "type": "inlineReview"}, {"oid": "d0bd0265479cb0d4615bad8a2d88eeec1754be0b", "url": "https://github.com/GoogleContainerTools/jib/commit/d0bd0265479cb0d4615bad8a2d88eeec1754be0b", "message": "some updates", "committedDate": "2020-10-04T17:12:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc3NDI0MA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r499774240", "bodyText": "Is this the general jib-cli version?", "author": "mpeddada1", "createdAt": "2020-10-05T17:57:24Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,60 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands, mirroring what is available in the plugins\n+```\n+build        build to registry\n+dockerBuild  build to docker daemon\n+buildTar     build to a tar file\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference\n+```\n+\n+### Optional\n+```\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --credHelper <registry>=<credHelper>   credential helper to use for a registry (repeatable)\n+    --docker-config <directory>            location of docker configuration\n+    --help                                 print usage\n+-p, --parameter <name>=<value>             templating parameters replace `${name}` with `value` in the build file (repeatable)\n+    --tag <tag1>[,<tag2>,...]              additional tags for target\n+    --verbosity <level>                    set logging verbosity (error, warn, lifecycle (default), info, debug)\n+-v, --version                              print version information and exit ", "originalCommit": "d0bd0265479cb0d4615bad8a2d88eeec1754be0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc3ODcxMA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r499778710", "bodyText": "yeah this would be whatever version information we bake into the system.", "author": "loosebazooka", "createdAt": "2020-10-05T18:05:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc3NDI0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4NDQ5Mw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r499784493", "bodyText": "nice. we could add this maybe?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            -v, --version                              print version information and exit \n          \n          \n            \n            -v, --version                              print jib-cli version information and exit", "author": "mpeddada1", "createdAt": "2020-10-05T18:16:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc3NDI0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5MjI1Mg==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r499792252", "bodyText": "I think when you run tool --version, it's expected that you are expecting the version of the tool, no?", "author": "loosebazooka", "createdAt": "2020-10-05T18:31:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc3NDI0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4NjE2MQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r499786161", "bodyText": "This is just a thought and also very much optional: How about having  a separate section for \"general purpose flags\" such as help, version and verbosity?", "author": "mpeddada1", "createdAt": "2020-10-05T18:19:45Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,60 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands, mirroring what is available in the plugins\n+```\n+build        build to registry\n+dockerBuild  build to docker daemon\n+buildTar     build to a tar file\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference\n+```\n+\n+### Optional\n+```", "originalCommit": "d0bd0265479cb0d4615bad8a2d88eeec1754be0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgxNzkxNw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r499817917", "bodyText": "Just food for thoughts:\nWe have had multiple instances of feedback to be able to \"warm up a cache\" without pushing or creating a tar. Honestly, I wish the Jib build plugins had a way. And if we support the URI style, I think there's no need to have three commands.\nRelated, we may considering providing an option to configure the application layer cache (the default is to use a temporary directory) and the base image cache, but I'm not sure how useful they will be in practice.", "author": "chanseokoh", "createdAt": "2020-10-05T19:19:50Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,60 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands, mirroring what is available in the plugins\n+```\n+build        build to registry\n+dockerBuild  build to docker daemon\n+buildTar     build to a tar file", "originalCommit": "d0bd0265479cb0d4615bad8a2d88eeec1754be0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1OTU4Ng==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501859586", "bodyText": "Added a warm up cache section at the end, presumably that would be a separate command? we'd have to provide a shortcut in jib-core stepsrunner to do it though", "author": "loosebazooka", "createdAt": "2020-10-08T16:37:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgxNzkxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyMDg5OQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r499820899", "bodyText": "No simple way to pass a username and password pair if there's no credential helper or a Docker CLI? However, I don't know what's a conventional way to safely pass credentials for a CLI tool.\nAnyways, --allow-insecure or --insecure-registries=gcr.io,ghcr.io,... sounds like a useful option. (Unfortunately, jib-core doesn't support per-registry configuration.)", "author": "chanseokoh", "createdAt": "2020-10-05T19:25:37Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,60 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands, mirroring what is available in the plugins\n+```\n+build        build to registry\n+dockerBuild  build to docker daemon\n+buildTar     build to a tar file\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference\n+```\n+\n+### Optional\n+```\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --credHelper <registry>=<credHelper>   credential helper to use for a registry (repeatable)", "originalCommit": "d0bd0265479cb0d4615bad8a2d88eeec1754be0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1OTg3OQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501859879", "bodyText": "Added some more flags here to cover these", "author": "loosebazooka", "createdAt": "2020-10-08T16:38:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyMDg5OQ=="}], "type": "inlineReview"}, {"oid": "78e74cf455155d950809377c551697118e83ab8a", "url": "https://github.com/GoogleContainerTools/jib/commit/78e74cf455155d950809377c551697118e83ab8a", "message": "large update", "committedDate": "2020-10-06T16:31:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE3OTA4OA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501179088", "bodyText": "I think maybe I might split this into\n--to-auth-username <username>\n--to-auth-password <password>\n\nthis lets us take advantage of some password related tools that pico cli adds", "author": "loosebazooka", "createdAt": "2020-10-07T17:15:30Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,71 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands\n+```\n+build        build a container\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference, using the url schema defined in jib\n+                          gcr.io/project/image (default is build to registry)\n+                          registry://gcr.io/project/image\n+                          docker://some-image-ref\n+                          tar://relative/path.tar\n+                          tar:///aboslute/path.tar\n+```\n+\n+### Optional\n+\n+\n+#### Build Config\n+```\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --docker-config <directory>            location of docker configuration\n+    --name <image-ref>                     image name to bake into tar file (only available when using -t tar://...)\n+-p, --parameter <name>=<value>             templating parameters replace `${name}` with `value` in the build file (repeatable)\n+    --tag <tag1>[,<tag2>,...]              additional tags for target\n+```\n+\n+#### Auth/Security\n+```\n+    --allow-insecure-registries            allow jib to communicate with registries over https\n+    --credHelper <registry>=<credHelper>   credential helper to use for a registry (repeatable)\n+    --send-credentials-over-http           allow jib to send credentials over http (used in conjunction with --allow-insecure-registries)\n+    --to-auth <username> <password>        configure a username and password for authentication on the registry that an image is being built to", "originalCommit": "78e74cf455155d950809377c551697118e83ab8a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "eb0a3df1ec067b329c9080fca5403a2b20ec019e", "url": "https://github.com/GoogleContainerTools/jib/commit/eb0a3df1ec067b329c9080fca5403a2b20ec019e", "message": "param updates", "committedDate": "2020-10-07T17:21:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE5MjgyMw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501192823", "bodyText": "maybe this should be --to-credHelper", "author": "loosebazooka", "createdAt": "2020-10-07T17:37:58Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,74 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands\n+```\n+build        build a container\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference, using the url schema defined in jib\n+                          gcr.io/project/image (default is build to registry)\n+                          registry://gcr.io/project/image\n+                          docker://some-image-ref\n+                          tar://relative/path.tar\n+                          tar:///aboslute/path.tar\n+```\n+\n+### Optional\n+\n+\n+#### Build Config\n+```\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --docker-config <directory>            location of docker configuration\n+    --name <image-ref>                     image name to bake into tar file (only available when using -t tar://...)\n+-p, --parameter <name>=<value>             templating parameters replace `${name}` with `value` in the build file (repeatable)\n+    --tag <tag1>[,<tag2>,...]              additional tags for target\n+```\n+\n+#### Auth/Security\n+```\n+    --allow-insecure-registries            allow jib to communicate with registries over https\n+    --credHelper <registry>=<credHelper>   credential helper to use for a registry (repeatable)", "originalCommit": "eb0a3df1ec067b329c9080fca5403a2b20ec019e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7f58abd497cad73334c51ff760a583ed845546cd", "url": "https://github.com/GoogleContainerTools/jib/commit/7f58abd497cad73334c51ff760a583ed845546cd", "message": "credentials updates", "committedDate": "2020-10-07T18:17:55Z", "type": "commit"}, {"oid": "8a0a81e6f7d3d648996fe8ea9e0fd966dd59514f", "url": "https://github.com/GoogleContainerTools/jib/commit/8a0a81e6f7d3d648996fe8ea9e0fd966dd59514f", "message": "cache options", "committedDate": "2020-10-07T19:24:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyMjI3MA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501322270", "bodyText": "this is all wrong, credential helpers already encode the server url, we do no need to,from,etc for cred helpers", "author": "loosebazooka", "createdAt": "2020-10-07T21:32:28Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,101 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands\n+```\n+build        build a container\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference, using the url schema defined in jib\n+                          gcr.io/project/image (default is build to registry)\n+                          registry://gcr.io/project/image\n+                          docker://some-image-ref\n+                          tar://relative/path.tar\n+                          tar:///aboslute/path.tar\n+```\n+\n+### Optional\n+\n+\n+#### Build Config\n+```\n+    --application-cache <directory>        location of the application cache\n+    --base-image-cache <directory>         location of the base image cache\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --docker-config <directory>            location of docker configuration\n+    --name <image-ref>                     image name to bake into tar file (only available when using -t tar://...)\n+-p, --parameter <name>=<value>             templating parameters replace `${name}` with `value` in the build file (repeatable)\n+    --tag <tag1>[,<tag2>,...]              additional tags for target\n+```\n+\n+#### Auth/Security\n+```\n+    --allow-insecure-registries            allow jib to communicate with registries over https\n+    --send-credentials-over-http           allow jib to send credentials over http (used in conjunction with --allow-insecure-registries)\n+```\n+##### Credentials\n+\n+Credentials can be specified using credential helpers or username + password. The following options are available\n+```\n+    --credHelper <credHelper>              credential helper to use for a registry", "originalCommit": "8a0a81e6f7d3d648996fe8ea9e0fd966dd59514f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM0MjA4NQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501342085", "bodyText": "Some part of the general Docker auth has bothered me a bit. For example, whether using a credential helper or docker login, it didn't seem like you can provide different usernames for the base and the target repos if the repositories are on the same registry. That is, say you have two private Docker Hub repos alice/image and bob/image (i.e., repos in two different accounts), then you have to repeatedly do docker login -u alice and docker login -u bob if you need to work on both repos. Using a credential helper doesn't help either; FWIW, credentials are scoped solely by the registry.\nMaybe it's just rare in practice that one has two different login accounts on the same registry? Anyways, I think having a single credential helper makes sense. Theoretically feasible, but I think it's unlikely that someone has multiple credential helpers set up only to return different accounts for the same registry.", "author": "chanseokoh", "createdAt": "2020-10-07T22:19:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyMjI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg2MDI2Mg==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501860262", "bodyText": "Yeah, I can see that, we can always add in to/from later. It seems strange for now to do it though.", "author": "loosebazooka", "createdAt": "2020-10-08T16:38:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyMjI3MA=="}], "type": "inlineReview"}, {"oid": "c4d959a1218cc9e85989e408dae1b230a9eff9f4", "url": "https://github.com/GoogleContainerTools/jib/commit/c4d959a1218cc9e85989e408dae1b230a9eff9f4", "message": "fix credential helper config", "committedDate": "2020-10-07T21:41:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg5OTAyMg==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501899022", "bodyText": "define default?", "author": "loosebazooka", "createdAt": "2020-10-08T17:42:09Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,90 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands\n+```\n+build        build a container\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference, using the url schema defined in jib\n+                          gcr.io/project/image (default is build to registry)\n+                          registry://gcr.io/project/image\n+                          docker://some-image-ref\n+                          tar://relative/path.tar\n+                          tar:///aboslute/path.tar\n+```\n+\n+### Optional\n+\n+\n+#### Build Config\n+```\n+    --application-cache <directory>        location of the application cache\n+    --base-image-cache <directory>         location of the base image cache", "originalCommit": "c4d959a1218cc9e85989e408dae1b230a9eff9f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkzMjI2NQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501932265", "bodyText": "I think there's some work to be done here to define a better default, but the default that jib-core uses is a temporary directory.", "author": "loosebazooka", "createdAt": "2020-10-08T18:35:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg5OTAyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkzMzM2Mw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501933363", "bodyText": "added to \"Other Considerations\" section", "author": "loosebazooka", "createdAt": "2020-10-08T18:37:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg5OTAyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMDk2Mw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501900963", "bodyText": "is this required or optional?", "author": "loosebazooka", "createdAt": "2020-10-08T17:45:12Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,90 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands\n+```\n+build        build a container\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference, using the url schema defined in jib\n+                          gcr.io/project/image (default is build to registry)\n+                          registry://gcr.io/project/image\n+                          docker://some-image-ref\n+                          tar://relative/path.tar\n+                          tar:///aboslute/path.tar\n+```\n+\n+### Optional\n+\n+\n+#### Build Config\n+```\n+    --application-cache <directory>        location of the application cache\n+    --base-image-cache <directory>         location of the base image cache\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --docker-config <directory>            location of docker configuration\n+    --name <image-ref>                     image name to bake into tar file (only available when using -t tar://...)", "originalCommit": "c4d959a1218cc9e85989e408dae1b230a9eff9f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkzMDgzMw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501930833", "bodyText": "Name is required for building \"tar\" images (https://github.com/GoogleContainerTools/jib/blob/master/jib-core/src/main/java/com/google/cloud/tools/jib/api/Containerizer.java#L104)", "author": "loosebazooka", "createdAt": "2020-10-08T18:32:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMDk2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkzMzQ4Ng==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501933486", "bodyText": "updated text", "author": "loosebazooka", "createdAt": "2020-10-08T18:37:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMDk2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMjQxOQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501902419", "bodyText": "should be hidden in help?", "author": "loosebazooka", "createdAt": "2020-10-08T17:47:26Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,90 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands\n+```\n+build        build a container\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference, using the url schema defined in jib\n+                          gcr.io/project/image (default is build to registry)\n+                          registry://gcr.io/project/image\n+                          docker://some-image-ref\n+                          tar://relative/path.tar\n+                          tar:///aboslute/path.tar\n+```\n+\n+### Optional\n+\n+\n+#### Build Config\n+```\n+    --application-cache <directory>        location of the application cache\n+    --base-image-cache <directory>         location of the base image cache\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --docker-config <directory>            location of docker configuration\n+    --name <image-ref>                     image name to bake into tar file (only available when using -t tar://...)\n+-p, --parameter <name>=<value>             templating parameters replace `${name}` with `value` in the build file (repeatable)\n+    --tag <tag1>[,<tag2>,...]              additional tags for target\n+```\n+\n+#### Auth/Security\n+```\n+    --allow-insecure-registries            allow jib to communicate with registries over https\n+    --send-credentials-over-http           allow jib to send credentials over http (used in conjunction with --allow-insecure-registries)\n+```\n+##### Credentials\n+\n+Credentials can be specified using credential helpers or username + password. The following options are available\n+```\n+    --credential-helper <credHelper>       credential helper to use for a registry, a path or name suffix (docker-credential-<suffix>) (repeatable)\n+\n+    --username <username>                  configure a username for authenticating against registries\n+    --password <password>                  configure a passowrd for authenticating against registries (interactive if <password> is omitted)\n+    --to-username <username>               configure a username for authenticating on the registry that an image is being built to\n+    --to-password <password>               configure a password for authenticating on the registry and image is being built to (interactive if <password> is omitted)\n+    --from-username <username>             configure a username for authentication on the registry that a base image is being sourced from\n+    --from-password <password>             configure a password for authentication on the registry that a base image is being sourced from (interactive if <password> is omitted)\n+```\n+combinations of `username` and `password` flags come with restrictions and can be use only in the following ways:\n+1. `--username`, `--password`\n+1. `--to-username`, `--to-password`\n+1. `--from-username`, `--from-password`\n+1. `--to-username`, `--to-password`, `--from-username`, `--from-password`\n+\n+\n+#### Info Params\n+```\n+    --help                                 print usage and exit\n+    --stacktrace                           print stacktrace on error (for debugging issues in the jib-cli)", "originalCommit": "c4d959a1218cc9e85989e408dae1b230a9eff9f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMzM2Mw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501903363", "bodyText": "also enable http tracing? (default level = config, output = console)\nhttps://github.com/GoogleContainerTools/jib/blob/master/docs/faq.md#how-can-i-examine-network-traffic", "author": "loosebazooka", "createdAt": "2020-10-08T17:48:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMjQxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwNDY0Mw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501904643", "bodyText": "--serialize also hidden", "author": "loosebazooka", "createdAt": "2020-10-08T17:50:55Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,90 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands\n+```\n+build        build a container\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference, using the url schema defined in jib\n+                          gcr.io/project/image (default is build to registry)\n+                          registry://gcr.io/project/image\n+                          docker://some-image-ref\n+                          tar://relative/path.tar\n+                          tar:///aboslute/path.tar\n+```\n+\n+### Optional\n+\n+\n+#### Build Config\n+```\n+    --application-cache <directory>        location of the application cache\n+    --base-image-cache <directory>         location of the base image cache\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --docker-config <directory>            location of docker configuration\n+    --name <image-ref>                     image name to bake into tar file (only available when using -t tar://...)\n+-p, --parameter <name>=<value>             templating parameters replace `${name}` with `value` in the build file (repeatable)\n+    --tag <tag1>[,<tag2>,...]              additional tags for target\n+```\n+\n+#### Auth/Security\n+```\n+    --allow-insecure-registries            allow jib to communicate with registries over https\n+    --send-credentials-over-http           allow jib to send credentials over http (used in conjunction with --allow-insecure-registries)\n+```\n+##### Credentials\n+\n+Credentials can be specified using credential helpers or username + password. The following options are available\n+```\n+    --credential-helper <credHelper>       credential helper to use for a registry, a path or name suffix (docker-credential-<suffix>) (repeatable)\n+\n+    --username <username>                  configure a username for authenticating against registries\n+    --password <password>                  configure a passowrd for authenticating against registries (interactive if <password> is omitted)\n+    --to-username <username>               configure a username for authenticating on the registry that an image is being built to\n+    --to-password <password>               configure a password for authenticating on the registry and image is being built to (interactive if <password> is omitted)\n+    --from-username <username>             configure a username for authentication on the registry that a base image is being sourced from\n+    --from-password <password>             configure a password for authentication on the registry that a base image is being sourced from (interactive if <password> is omitted)\n+```\n+combinations of `username` and `password` flags come with restrictions and can be use only in the following ways:\n+1. `--username`, `--password`\n+1. `--to-username`, `--to-password`\n+1. `--from-username`, `--from-password`\n+1. `--to-username`, `--to-password`, `--from-username`, `--from-password`\n+\n+\n+#### Info Params\n+```\n+    --help                                 print usage and exit\n+    --stacktrace                           print stacktrace on error (for debugging issues in the jib-cli)\n+    --verbosity <level>                    set logging verbosity (error, warn, lifecycle (default), info, debug)\n+-v, --version                              print version information and exit \n+```", "originalCommit": "c4d959a1218cc9e85989e408dae1b230a9eff9f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwNjA1Ng==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r501906056", "bodyText": "jib core needs to support this?", "author": "loosebazooka", "createdAt": "2020-10-08T17:53:01Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,90 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands\n+```\n+build        build a container\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference, using the url schema defined in jib\n+                          gcr.io/project/image (default is build to registry)\n+                          registry://gcr.io/project/image\n+                          docker://some-image-ref\n+                          tar://relative/path.tar\n+                          tar:///aboslute/path.tar\n+```\n+\n+### Optional\n+\n+\n+#### Build Config\n+```\n+    --application-cache <directory>        location of the application cache\n+    --base-image-cache <directory>         location of the base image cache\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --docker-config <directory>            location of docker configuration\n+    --name <image-ref>                     image name to bake into tar file (only available when using -t tar://...)\n+-p, --parameter <name>=<value>             templating parameters replace `${name}` with `value` in the build file (repeatable)\n+    --tag <tag1>[,<tag2>,...]              additional tags for target\n+```\n+\n+#### Auth/Security\n+```\n+    --allow-insecure-registries            allow jib to communicate with registries over https\n+    --send-credentials-over-http           allow jib to send credentials over http (used in conjunction with --allow-insecure-registries)\n+```\n+##### Credentials\n+\n+Credentials can be specified using credential helpers or username + password. The following options are available\n+```\n+    --credential-helper <credHelper>       credential helper to use for a registry, a path or name suffix (docker-credential-<suffix>) (repeatable)\n+\n+    --username <username>                  configure a username for authenticating against registries\n+    --password <password>                  configure a passowrd for authenticating against registries (interactive if <password> is omitted)\n+    --to-username <username>               configure a username for authenticating on the registry that an image is being built to\n+    --to-password <password>               configure a password for authenticating on the registry and image is being built to (interactive if <password> is omitted)\n+    --from-username <username>             configure a username for authentication on the registry that a base image is being sourced from\n+    --from-password <password>             configure a password for authentication on the registry that a base image is being sourced from (interactive if <password> is omitted)\n+```\n+combinations of `username` and `password` flags come with restrictions and can be use only in the following ways:\n+1. `--username`, `--password`\n+1. `--to-username`, `--to-password`\n+1. `--from-username`, `--from-password`\n+1. `--to-username`, `--to-password`, `--from-username`, `--from-password`\n+\n+\n+#### Info Params\n+```\n+    --help                                 print usage and exit\n+    --stacktrace                           print stacktrace on error (for debugging issues in the jib-cli)\n+    --verbosity <level>                    set logging verbosity (error, warn, lifecycle (default), info, debug)\n+-v, --version                              print version information and exit \n+```\n+\n+### Flag Files\n+\n+Pico cli allows the use of flag files (https://picocli.info/#AtFiles). The jib cli will enable this feature. This will allow allow build environment configuration to be defined in a configuration file.\n+\n+## Environment Variables\n+\n+### Docker daemon specification\n+\n+Information on communicating with the docker daemon is determined using the `DOCKER_*` environment variables.\n+\n+## Other considerations\n+\n+- Users have asked to warm up the cache, perhaps we can have a cache build?", "originalCommit": "c4d959a1218cc9e85989e408dae1b230a9eff9f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "114ba488b1cfca2fa53fe52064db42b4f4fba8fb", "url": "https://github.com/GoogleContainerTools/jib/commit/114ba488b1cfca2fa53fe52064db42b4f4fba8fb", "message": "updates from design meeting", "committedDate": "2020-10-08T18:34:21Z", "type": "commit"}, {"oid": "577d7828f83208ec496a70c5bbc4daa7f29ae819", "url": "https://github.com/GoogleContainerTools/jib/commit/577d7828f83208ec496a70c5bbc4daa7f29ae819", "message": "default cache consideration", "committedDate": "2020-10-08T18:36:35Z", "type": "commit"}, {"oid": "067f2037454e7e759f4e38746a2edce0e0ec1b0b", "url": "https://github.com/GoogleContainerTools/jib/commit/067f2037454e7e759f4e38746a2edce0e0ec1b0b", "message": "change tags -> additional-tags", "committedDate": "2020-10-12T17:42:59Z", "type": "commit"}, {"oid": "96fde203442dcef80d5f56f09f88b5fbe8e1ee4f", "url": "https://github.com/GoogleContainerTools/jib/commit/96fde203442dcef80d5f56f09f88b5fbe8e1ee4f", "message": "console type", "committedDate": "2020-10-14T16:04:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDgxNDcyNw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2787#discussion_r504814727", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                --password <password>                  configure a passowrd for authenticating against registries (interactive if <password> is omitted)\n          \n          \n            \n                --password <password>                  configure a password for authenticating against registries (interactive if <password> is omitted)", "author": "mpeddada1", "createdAt": "2020-10-14T16:29:54Z", "path": "proposals/jib-cli-surface.md", "diffHunk": "@@ -0,0 +1,96 @@\n+# Jib CLI Surface Specification\n+\n+Specification for a command structures exposed to users of the jib-cli\n+\n+## Usage\n+`jib COMMAND [OPTIONS]`\n+\n+## Commands\n+\n+The jib cli exposes the following top level commands\n+```\n+build        build a container\n+```\n+\n+## Options\n+\n+### Required\n+```\n+-t  --target <image-ref>  a target image reference, using the url schema defined in jib\n+                          gcr.io/project/image (default is build to registry)\n+                          registry://gcr.io/project/image\n+                          docker://some-image-ref\n+                          tar://relative/path.tar\n+                          tar:///aboslute/path.tar\n+```\n+\n+### Optional\n+\n+\n+#### Build Config\n+```\n+    --additional-tags <tag1>[,<tag2>,...]  additional tags for target\n+    --application-cache <directory>        location of the application cache (jib default is temp directory)\n+    --base-image-cache <directory>         location of the base image cache (jib default is user cache)\n+-b, --build-file <file>                    location of the build file (default <context>/jib.yaml)\n+-c, --context <dir>                        location of the build context (default .)\n+    --docker-config <directory>            location of docker configuration\n+    --name <image-ref>                     image name to bake into tar file, required when using \"-t tar://...\" \n+-p, --parameter <name>=<value>             templating parameters replace `${name}` with `value` in the build file (repeatable)\n+```\n+\n+#### Auth/Security\n+```\n+    --allow-insecure-registries            allow jib to communicate with registries over https\n+    --send-credentials-over-http           allow jib to send credentials over http (used in conjunction with --allow-insecure-registries)\n+```\n+##### Credentials\n+\n+Credentials can be specified using credential helpers or username + password. The following options are available\n+```\n+    --credential-helper <credHelper>       credential helper to use for a registry, a path or name suffix (docker-credential-<suffix>) (repeatable)\n+\n+    --username <username>                  configure a username for authenticating against registries\n+    --password <password>                  configure a passowrd for authenticating against registries (interactive if <password> is omitted)", "originalCommit": "96fde203442dcef80d5f56f09f88b5fbe8e1ee4f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "535fd355056960de4048ea008668f6f7e556ab09", "url": "https://github.com/GoogleContainerTools/jib/commit/535fd355056960de4048ea008668f6f7e556ab09", "message": "Update proposals/jib-cli-surface.md\n\nCo-authored-by: Mridula <66699525+mpeddada1@users.noreply.github.com>", "committedDate": "2020-10-14T21:51:35Z", "type": "commit"}]}