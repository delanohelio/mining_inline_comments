{"pr_number": 2273, "pr_title": "Improve checkstyle config", "pr_createdAt": "2020-02-07T19:58:08Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2273", "timeline": [{"oid": "2cab209ffe002e8b42c5ca0185b12ed28c22ea6d", "url": "https://github.com/GoogleContainerTools/jib/commit/2cab209ffe002e8b42c5ca0185b12ed28c22ea6d", "message": "Improve checkstyle config\n\n- update checkstyle to 8.29\n- improve config modification\n- add temporary check suppressions so fixes can go in gradually", "committedDate": "2020-02-07T20:06:28Z", "type": "forcePushed"}, {"oid": "2c3e09266e2c340da4957bb1194bf322fc1806ee", "url": "https://github.com/GoogleContainerTools/jib/commit/2c3e09266e2c340da4957bb1194bf322fc1806ee", "message": "Improve checkstyle config\n\n- update checkstyle to 8.29\n- improve config modification\n- add temporary check suppressions so fixes can go in gradually", "committedDate": "2020-02-07T20:18:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU5MTQ2OQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2273#discussion_r376591469", "bodyText": "refrenced --> referenced", "author": "chanseokoh", "createdAt": "2020-02-07T20:27:15Z", "path": "build.gradle", "diffHunk": "@@ -117,39 +117,27 @@ subprojects {\n \n   /* CHECKSTYLE */\n   checkstyle {\n-    toolVersion = '8.18'\n+    toolVersion = '8.29'\n \n-    // use the google checks packaged with the jar\n+    // use google checks from the jar\n     def googleChecks = resources.text.fromArchiveEntry(configurations.checkstyle[0], 'google_checks.xml').asString()\n \n-    // preserve these, the parser erases them\n-    def xmlVersionNode = googleChecks.find(/<\\?xml version.*>/)\n-    def doctypeNode = googleChecks.find(/(?s)<!DOCTYPE[^>]*>/)\n-\n-    def parser = new XmlParser()\n-    parser.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", false)\n-    parser.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false)\n-    def rootModule = parser.parseText(googleChecks)\n-\n-    // force each module within the root checker to only work on \"properties, xml\", ignore \"java\"\n-    def fileExtensionNode = parser.parseText('<property name=\"fileExtensions\" value=\"properties, xml\"/>')\n-    rootModule.module*.append(fileExtensionNode)\n-\n-    // add in copyright header check on only java files\n-    def copyrightNode = parser.parseText('''\n-    <module name=\"RegexpHeader\">\n-        <property name=\"headerFile\" value=\"${config_loc}/copyright-java.header\"/>\n-        <property name=\"fileExtensions\" value=\"java\"/>\n-        <property name=\"id\" value=\"header\"/>\n-    </module>\n-    ''')\n-    rootModule.append(copyrightNode)\n+    // set the location of the suppressions file refrenced in google_checks.xml", "originalCommit": "2c3e09266e2c340da4957bb1194bf322fc1806ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU5MjI4NA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2273#discussion_r376592284", "bodyText": "So hopefully we will eventually fix these violations?", "author": "chanseokoh", "createdAt": "2020-02-07T20:29:10Z", "path": "config/checkstyle/checkstyle-suppressions.xml", "diffHunk": "@@ -0,0 +1,38 @@\n+<?xml version=\"1.0\"?>\n+<!DOCTYPE suppressions PUBLIC\n+  \"-//Puppy Crawl//DTD Suppressions 1.1//EN\"\n+  \"http://www.puppycrawl.com/dtds/suppressions_1_1.dtd\">\n+<suppressions>\n+  <!-- clash with google java format -->\n+  <suppress files=\".*\\.java\" checks=\"SingleLineJavadoc\"/>\n+  <suppress files=\".*\\.java\" checks=\"Indentation\"/>\n+  <suppress files=\".*\\.java\" checks=\"RightCurly\"/>\n+  <suppress files=\".*\\.java\" checks=\"LineLength\"/>\n+\n+  <!-- temporary suppressions as we work through them -->", "originalCommit": "2c3e09266e2c340da4957bb1194bf322fc1806ee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU5MjU3Nw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2273#discussion_r376592577", "bodyText": "They should be fixed, but didn't want to complicate this PR. I will work on them next.", "author": "loosebazooka", "createdAt": "2020-02-07T20:29:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU5MjI4NA=="}], "type": "inlineReview"}, {"oid": "84f8d508452696357280b5ef9faf43d321ceee02", "url": "https://github.com/GoogleContainerTools/jib/commit/84f8d508452696357280b5ef9faf43d321ceee02", "message": "Improve checkstyle config\n\n- update checkstyle to 8.29\n- improve config modification\n- add temporary check suppressions so fixes can go in gradually", "committedDate": "2020-02-07T20:30:16Z", "type": "commit"}, {"oid": "84f8d508452696357280b5ef9faf43d321ceee02", "url": "https://github.com/GoogleContainerTools/jib/commit/84f8d508452696357280b5ef9faf43d321ceee02", "message": "Improve checkstyle config\n\n- update checkstyle to 8.29\n- improve config modification\n- add temporary check suppressions so fixes can go in gradually", "committedDate": "2020-02-07T20:30:16Z", "type": "forcePushed"}]}