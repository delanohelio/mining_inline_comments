{"pr_number": 2408, "pr_title": "Add entry in faq for manifests lists", "pr_createdAt": "2020-04-15T21:09:44Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2408", "timeline": [{"oid": "717d5500888784c4b6cf8bfee72597d1df74b0c5", "url": "https://github.com/GoogleContainerTools/jib/commit/717d5500888784c4b6cf8bfee72597d1df74b0c5", "message": "Add entry in faq for manifests lists", "committedDate": "2020-04-15T21:09:15Z", "type": "commit"}, {"oid": "3c73f8b38e2201d7dfa037bff17fa8465ca9551e", "url": "https://github.com/GoogleContainerTools/jib/commit/3c73f8b38e2201d7dfa037bff17fa8465ca9551e", "message": "use java formatting on json (comment rendering)", "committedDate": "2020-04-15T21:12:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE4MzI2NA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409183264", "bodyText": "The manifest inspect command is an experimental one and needs to update ~/.docker/config.json. Maybe we can add some links:\nhttps://docs.docker.com/engine/reference/commandline/manifest_inspect/ https://docs.docker.com/engine/reference/commandline/cli/#experimental-features", "author": "chanseokoh", "createdAt": "2020-04-15T23:01:08Z", "path": "docs/faq.md", "diffHunk": "@@ -466,6 +467,38 @@ Some plugins, such as the [Docker Prepare Gradle Plugin](https://github.com/gcla\n \n To inspect the image that is produced from the build using Docker, you can use commands such as `docker inspect your/image:tag` to view the image configuration, or you can also download the image using `docker save` to manually inspect the container image. Other tools, such as [dive](https://github.com/wagoodman/dive), provide nicer UI to inspect the image.\n \n+### How do I specify an image from a manifest list?\n+\n+By design, Jib will pick always select an image for the platform:`amd64/linux` if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list). If you need to specify a different image from a manifest list you must specify the image digest for the platform you are targeting. \n+\n+To determine the digest of an image in a manifest list, you can view the manifest list with:\n+```\n+$ docker manifest inspect openjdk:8", "originalCommit": "3c73f8b38e2201d7dfa037bff17fa8465ca9551e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE4Mzg4MQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409183881", "bodyText": "\"will pick always select\" --> \"will always select\"\n\"for the platform:amd64/linux\" --> \"for the platform amd64/linux", "author": "chanseokoh", "createdAt": "2020-04-15T23:03:03Z", "path": "docs/faq.md", "diffHunk": "@@ -466,6 +467,38 @@ Some plugins, such as the [Docker Prepare Gradle Plugin](https://github.com/gcla\n \n To inspect the image that is produced from the build using Docker, you can use commands such as `docker inspect your/image:tag` to view the image configuration, or you can also download the image using `docker save` to manually inspect the container image. Other tools, such as [dive](https://github.com/wagoodman/dive), provide nicer UI to inspect the image.\n \n+### How do I specify an image from a manifest list?\n+\n+By design, Jib will pick always select an image for the platform:`amd64/linux` if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list). If you need to specify a different image from a manifest list you must specify the image digest for the platform you are targeting. ", "originalCommit": "3c73f8b38e2201d7dfa037bff17fa8465ca9551e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE4NDI3Nw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409184277", "bodyText": "For the title, how about \"a manifest list or an OCI index\"? (But we can omit OCI index in the text for brevity.)\nAnd how about \"specify OS and architecture of a base image from...\"?", "author": "chanseokoh", "createdAt": "2020-04-15T23:04:06Z", "path": "docs/faq.md", "diffHunk": "@@ -27,7 +27,8 @@ If a question you have is not answered below, please [submit an issue](/../../is\n [What would a Dockerfile for a Jib-built image look like?](#what-would-a-dockerfile-for-a-jib-built-image-look-like)\\\n [How can I inspect the image Jib built?](#how-can-i-inspect-the-image-jib-built)\\\n [I would like to run my application with a javaagent.](#i-would-like-to-run-my-application-with-a-javaagent)\\\n-[How can I tag my image with a timestamp?](#how-can-i-tag-my-image-with-a-timestamp)\n+[How can I tag my image with a timestamp?](#how-can-i-tag-my-image-with-a-timestamp)\\\n+[How do I specify an image from a manifest list?](#how-do-i-specify-an-image-from-a-manifest-list)", "originalCommit": "3c73f8b38e2201d7dfa037bff17fa8465ca9551e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI2NDU4Mg==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409264582", "bodyText": "I'm not really sure about the title.\nHow do I specify a platform in the manifest list (or OCI index) of a base image?", "author": "loosebazooka", "createdAt": "2020-04-16T03:49:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE4NDI3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI3MDM3MQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409270371", "bodyText": "Yeah, I think \"platform\" is a good keyword for search.", "author": "chanseokoh", "createdAt": "2020-04-16T04:12:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE4NDI3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE4NTAzOA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409185038", "bodyText": "\"for the platform:amd64/linux\" --> \"for the platform amd64/linux", "author": "chanseokoh", "createdAt": "2020-04-15T23:06:27Z", "path": "docs/faq.md", "diffHunk": "@@ -466,6 +467,38 @@ Some plugins, such as the [Docker Prepare Gradle Plugin](https://github.com/gcla\n \n To inspect the image that is produced from the build using Docker, you can use commands such as `docker inspect your/image:tag` to view the image configuration, or you can also download the image using `docker save` to manually inspect the container image. Other tools, such as [dive](https://github.com/wagoodman/dive), provide nicer UI to inspect the image.\n \n+### How do I specify an image from a manifest list?\n+\n+By design, Jib will pick always select an image for the platform:`amd64/linux` if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list). If you need to specify a different image from a manifest list you must specify the image digest for the platform you are targeting. \n+\n+To determine the digest of an image in a manifest list, you can view the manifest list with:\n+```\n+$ docker manifest inspect openjdk:8\n+```\n+\n+You can then inspect the output for the specific image you want (in this example an image for the platform:`arm64/linux`)", "originalCommit": "3c73f8b38e2201d7dfa037bff17fa8465ca9551e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE4NjI0NQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409186245", "bodyText": "Can we add something like\n\"As in the example, you can preserve the tag for commenting purposes, but note that the tag will not be used but ignored.\"", "author": "chanseokoh", "createdAt": "2020-04-15T23:09:56Z", "path": "docs/faq.md", "diffHunk": "@@ -466,6 +467,38 @@ Some plugins, such as the [Docker Prepare Gradle Plugin](https://github.com/gcla\n \n To inspect the image that is produced from the build using Docker, you can use commands such as `docker inspect your/image:tag` to view the image configuration, or you can also download the image using `docker save` to manually inspect the container image. Other tools, such as [dive](https://github.com/wagoodman/dive), provide nicer UI to inspect the image.\n \n+### How do I specify an image from a manifest list?\n+\n+By design, Jib will pick always select an image for the platform:`amd64/linux` if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list). If you need to specify a different image from a manifest list you must specify the image digest for the platform you are targeting. \n+\n+To determine the digest of an image in a manifest list, you can view the manifest list with:\n+```\n+$ docker manifest inspect openjdk:8\n+```\n+\n+You can then inspect the output for the specific image you want (in this example an image for the platform:`arm64/linux`)\n+```java\n+{         \n+   ...\n+   // This whole BLOB itself is a manifest list.\n+   \"mediaType\": \"application/vnd.docker.distribution.manifest.list.v2+json\",\n+   \"manifests\": [\n+      {\n+         // This entry in the list points to the manifest for the ARM64/Linux manifest.\n+         \"mediaType\": \"application/vnd.docker.distribution.manifest.v2+json\",\n+         ...\n+         \"digest\": \"sha256:1fbd49e3fc5e53154fa93cad15f211112d899a6b0c5dc1e8661d6eb6c18b30a6\",\n+         \"platform\": {\n+            \"architecture\": \"arm64\",\n+            \"os\": \"linux\",\n+            \"variant\": \"v8\"\n+         }\n+      }\n+   ]\n+}\n+```\n+\n+You then use the digest for the target platform you desire in your `jib.to.image` in the form `\"opendjdk:8@sha256:1fbd49e3fc5e53154fa93cad15f211112d899a6b0c5dc1e8661d6eb6c18b30a6\"`", "originalCommit": "3c73f8b38e2201d7dfa037bff17fa8465ca9551e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI2NDIxMQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409264211", "bodyText": "updated to show both. both are valid?", "author": "loosebazooka", "createdAt": "2020-04-16T03:47:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE4NjI0NQ=="}], "type": "inlineReview"}, {"oid": "d55672089a8996ba00223093a03be0fd0491720c", "url": "https://github.com/GoogleContainerTools/jib/commit/d55672089a8996ba00223093a03be0fd0491720c", "message": "some changes", "committedDate": "2020-04-16T03:46:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI3MDU0Nw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409270547", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To view a manifest, [enable experimental docker cli](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.\n          \n          \n            \n            To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.", "author": "chanseokoh", "createdAt": "2020-04-16T04:13:10Z", "path": "docs/faq.md", "diffHunk": "@@ -466,6 +467,38 @@ Some plugins, such as the [Docker Prepare Gradle Plugin](https://github.com/gcla\n \n To inspect the image that is produced from the build using Docker, you can use commands such as `docker inspect your/image:tag` to view the image configuration, or you can also download the image using `docker save` to manually inspect the container image. Other tools, such as [dive](https://github.com/wagoodman/dive), provide nicer UI to inspect the image.\n \n+### How do I specify an image from a manifest list?\n+\n+By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux` . If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting. \n+\n+To view a manifest, [enable experimental docker cli](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.", "originalCommit": "d55672089a8996ba00223093a03be0fd0491720c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI3MDg4Nw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409270887", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux` . If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting. \n          \n          \n            \n            By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux`. If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting.", "author": "chanseokoh", "createdAt": "2020-04-16T04:14:18Z", "path": "docs/faq.md", "diffHunk": "@@ -466,6 +467,38 @@ Some plugins, such as the [Docker Prepare Gradle Plugin](https://github.com/gcla\n \n To inspect the image that is produced from the build using Docker, you can use commands such as `docker inspect your/image:tag` to view the image configuration, or you can also download the image using `docker save` to manually inspect the container image. Other tools, such as [dive](https://github.com/wagoodman/dive), provide nicer UI to inspect the image.\n \n+### How do I specify an image from a manifest list?\n+\n+By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux` . If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting. ", "originalCommit": "d55672089a8996ba00223093a03be0fd0491720c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI3MTQ3NQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409271475", "bodyText": "We shouldn't forget to update this paragraph once we fix #1567. But I think we will forget, so should we add a link to the issue?", "author": "chanseokoh", "createdAt": "2020-04-16T04:16:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI3MDg4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTU5NjkyOQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2408#discussion_r409596929", "bodyText": "I added a todo on the bug.", "author": "loosebazooka", "createdAt": "2020-04-16T14:22:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI3MDg4Nw=="}], "type": "inlineReview"}, {"oid": "cae0ebd85ae5df23165f5ba1aa12dee1cb268a70", "url": "https://github.com/GoogleContainerTools/jib/commit/cae0ebd85ae5df23165f5ba1aa12dee1cb268a70", "message": "Update docs/faq.md\n\nCo-Authored-By: Chanseok Oh <chanseok@google.com>", "committedDate": "2020-04-16T14:13:01Z", "type": "commit"}, {"oid": "092c1a2122fef0cd0ca4e25d0d955fd3a53adfa9", "url": "https://github.com/GoogleContainerTools/jib/commit/092c1a2122fef0cd0ca4e25d0d955fd3a53adfa9", "message": "Update docs/faq.md\n\nCo-Authored-By: Chanseok Oh <chanseok@google.com>", "committedDate": "2020-04-16T14:13:30Z", "type": "commit"}, {"oid": "1259bd109032ce7bb4d95aebd3a5cb3c0c5d8bb9", "url": "https://github.com/GoogleContainerTools/jib/commit/1259bd109032ce7bb4d95aebd3a5cb3c0c5d8bb9", "message": "Update faq.md", "committedDate": "2020-04-16T14:21:10Z", "type": "commit"}]}