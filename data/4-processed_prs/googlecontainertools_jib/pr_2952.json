{"pr_number": 2952, "pr_title": "Upgrade build to 6.0.1", "pr_createdAt": "2020-12-21T19:31:03Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2952", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwMzg5Nw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546903897", "bodyText": "Why do we want to apply java-library for jib-gradle-plugin? It's not a Java library. And it's not in parity with jib-maven-plugin either.", "author": "chanseokoh", "createdAt": "2020-12-21T20:02:08Z", "path": "build.gradle", "diffHunk": "@@ -21,7 +21,7 @@ idea.project.settings {\n \n import net.ltgt.gradle.errorprone.CheckSeverity\n \n-['jib-core', 'jib-gradle-plugin-extension-api', 'jib-maven-plugin-extension-api'].each { projectName ->\n+['jib-core', 'jib-gradle-plugin', 'jib-gradle-plugin-extension-api', 'jib-maven-plugin-extension-api'].each { projectName ->", "originalCommit": "79087bf49287868821e80082191c719370ab7900", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwODU4NA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546908584", "bodyText": "ah, my comment is missing when I rewrote the PR. The java-gradle-plugin now auto applies the java-library plugin, so we must do this, I'll add in the comment.", "author": "loosebazooka", "createdAt": "2020-12-21T20:13:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwMzg5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkxMjA1MQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546912051", "bodyText": "If java-gradle-plugin auto-applies java-library, then doesn't it mean we don't have to apply it manually here? (That is, no need to include jib-gradle-plugin in this line?\nAnd the Travis \"pr\" build failed and this seems related. Interestingly, however, the \"push\" build didn't fail.", "author": "chanseokoh", "createdAt": "2020-12-21T20:21:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwMzg5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkyNzY2NQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546927665", "bodyText": "Right the reason is we need to apply Java-library before java", "author": "loosebazooka", "createdAt": "2020-12-21T21:02:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwMzg5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk2Mjk1Nw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546962957", "bodyText": "or we get some error where the something is already configured that the java-library plugin wants to modify.", "author": "loosebazooka", "createdAt": "2020-12-21T22:33:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwMzg5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwNTE2Mw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546905163", "bodyText": "I guess this fixes #2930. And I was wondering if we should fix it by converting it to a Property as we did for allowInsecureRegistries.", "author": "chanseokoh", "createdAt": "2020-12-21T20:05:07Z", "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/ContainerParameters.java", "diffHunk": "@@ -112,7 +112,6 @@ public void setExtraClasspath(List<String> classpath) {\n   }\n \n   @Input\n-  @Optional\n   public boolean getExpandClasspathDependencies() {", "originalCommit": "79087bf49287868821e80082191c719370ab7900", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwODM1NQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546908355", "bodyText": "Perhaps, but I think it's beyond the scope of this PR. (this just fixes the issue that a boolean can't be optional)", "author": "loosebazooka", "createdAt": "2020-12-21T20:12:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwNTE2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkxMjI5Nw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546912297", "bodyText": "Okay, I think this is a simple fix that works.", "author": "chanseokoh", "createdAt": "2020-12-21T20:22:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwNTE2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwNTc4MQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546905781", "bodyText": "Oh, we missed this? And I'm curious what the effect of adding this is?", "author": "chanseokoh", "createdAt": "2020-12-21T20:06:28Z", "path": "jib-gradle-plugin/build.gradle", "diffHunk": "@@ -72,6 +72,7 @@ pluginBundle {\n }\n \n gradlePlugin {\n+  testSourceSets sourceSets.integrationTest, sourceSets.test", "originalCommit": "79087bf49287868821e80082191c719370ab7900", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwODkwMw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546908903", "bodyText": "For some reason, in gradle 6.0+, without this, the gradleTestKit isn't applied to integration tests (so anything where we exectute gradle would probably not work anymore).", "author": "loosebazooka", "createdAt": "2020-12-21T20:13:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwNTc4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk2NDMyNg==", "url": "https://github.com/GoogleContainerTools/jib/pull/2952#discussion_r546964326", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            // gradle-java-plugin (in jib-gradle-plugin) auto applies java-library, so ensure that happens first\n          \n          \n            \n            // java-gradle-plugin (in jib-gradle-plugin) auto applies java-library, so ensure that happens first", "author": "chanseokoh", "createdAt": "2020-12-21T22:38:01Z", "path": "build.gradle", "diffHunk": "@@ -21,7 +21,9 @@ idea.project.settings {\n \n import net.ltgt.gradle.errorprone.CheckSeverity\n \n-['jib-core', 'jib-gradle-plugin-extension-api', 'jib-maven-plugin-extension-api'].each { projectName ->\n+// `java-library` must be applied before `java`\n+// gradle-java-plugin (in jib-gradle-plugin) auto applies java-library, so ensure that happens first", "originalCommit": "f35218b76759b41c0e2edf419b9c47d1b652cde4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ee93ae2943fe8bc98b842b089e896ff96aff95e4", "url": "https://github.com/GoogleContainerTools/jib/commit/ee93ae2943fe8bc98b842b089e896ff96aff95e4", "message": "Upgrade build to 6.0.1\n\n- minimum to run jib is still 5.1", "committedDate": "2020-12-21T23:05:53Z", "type": "commit"}, {"oid": "1625f2fb631e82771b6ccc8ba11c9f422b0738a8", "url": "https://github.com/GoogleContainerTools/jib/commit/1625f2fb631e82771b6ccc8ba11c9f422b0738a8", "message": "comment for java-library stuff", "committedDate": "2020-12-21T23:05:53Z", "type": "commit"}, {"oid": "76176f8249c0e3f806d46b792a7e4f3fbcbfeec0", "url": "https://github.com/GoogleContainerTools/jib/commit/76176f8249c0e3f806d46b792a7e4f3fbcbfeec0", "message": "naming", "committedDate": "2020-12-21T23:06:14Z", "type": "commit"}, {"oid": "76176f8249c0e3f806d46b792a7e4f3fbcbfeec0", "url": "https://github.com/GoogleContainerTools/jib/commit/76176f8249c0e3f806d46b792a7e4f3fbcbfeec0", "message": "naming", "committedDate": "2020-12-21T23:06:14Z", "type": "forcePushed"}, {"oid": "ea9f98432645905f07da57042f166ccc313626b4", "url": "https://github.com/GoogleContainerTools/jib/commit/ea9f98432645905f07da57042f166ccc313626b4", "message": "oops", "committedDate": "2020-12-21T23:18:03Z", "type": "commit"}, {"oid": "180ac6488099402d993290191da51deac2bb7471", "url": "https://github.com/GoogleContainerTools/jib/commit/180ac6488099402d993290191da51deac2bb7471", "message": "temporary fix for jib-cli", "committedDate": "2020-12-22T00:09:50Z", "type": "commit"}]}