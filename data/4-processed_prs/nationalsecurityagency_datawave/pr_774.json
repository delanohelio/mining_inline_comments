{"pr_number": 774, "pr_title": "Updated the tree flattener to better handle queries with large or'd l\u2026", "pr_createdAt": "2020-03-03T20:21:11Z", "pr_url": "https://github.com/NationalSecurityAgency/datawave/pull/774", "timeline": [{"oid": "5ddfe852272fcd92482a530cfd6ca742101d978e", "url": "https://github.com/NationalSecurityAgency/datawave/commit/5ddfe852272fcd92482a530cfd6ca742101d978e", "message": "Updated the tree flattener to better handle queries with large or'd lists, and updated the selector extractor to flatten before extracting selectors.", "committedDate": "2020-03-03T20:19:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzcxNzg2OA==", "url": "https://github.com/NationalSecurityAgency/datawave/pull/774#discussion_r387717868", "bodyText": "Make the operation precedence obvious between the initial || and the subsequent &&", "author": "ivakegg", "createdAt": "2020-03-04T14:54:15Z", "path": "warehouse/query-core/src/main/java/datawave/query/jexl/visitors/TreeFlatteningRebuilder.java", "diffHunk": "@@ -182,6 +190,32 @@ private JexlNode copyTree(JexlNode node, Deque<JexlNode> postOrderDeque) {\n         return copiedNode;\n     }\n     \n+    private List<JexlNode> getAndOrLeaves(JexlNode node) {\n+        LinkedList<JexlNode> children = new LinkedList<>();\n+        LinkedList<JexlNode> stack = new LinkedList<>();\n+        stack.push(node);\n+        \n+        while (!stack.isEmpty()) {\n+            JexlNode currNode = stack.pop();\n+            \n+            // only add children if\n+            // 1) this is the original node, or\n+            // 2) this node is the same type as the root node and\n+            // -- a) this is an OR node, or\n+            // -- b) this is an AND node (but not a bounded range)\n+            if (currNode == node || node.getClass().isInstance(currNode)", "originalCommit": "5ddfe852272fcd92482a530cfd6ca742101d978e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODM4OTQ5NA==", "url": "https://github.com/NationalSecurityAgency/datawave/pull/774#discussion_r388389494", "bodyText": "So... an extra set of parens???  I thought the comment made it obvious.", "author": "jwomeara", "createdAt": "2020-03-05T15:59:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzcxNzg2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQwOTczMQ==", "url": "https://github.com/NationalSecurityAgency/datawave/pull/774#discussion_r390409731", "bodyText": "Fixed.  What more do you want from me!!!???  I seek your approval!", "author": "jwomeara", "createdAt": "2020-03-10T15:39:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzcxNzg2OA=="}], "type": "inlineReview"}, {"oid": "122834c05d11eb420b7f72d3c530d67ca1998441", "url": "https://github.com/NationalSecurityAgency/datawave/commit/122834c05d11eb420b7f72d3c530d67ca1998441", "message": "Merge branch 'release/version2.9' into bugfix/largeOrListImprovements", "committedDate": "2020-03-06T15:37:32Z", "type": "commit"}, {"oid": "cb1d07ae75cc57330f00562d95c242eb23c7376a", "url": "https://github.com/NationalSecurityAgency/datawave/commit/cb1d07ae75cc57330f00562d95c242eb23c7376a", "message": "pr feedback", "committedDate": "2020-03-06T15:49:43Z", "type": "commit"}, {"oid": "c849c0d9eb2a61d486a52f2fea4ef412af08d340", "url": "https://github.com/NationalSecurityAgency/datawave/commit/c849c0d9eb2a61d486a52f2fea4ef412af08d340", "message": "Merge branch 'release/version2.9' into bugfix/largeOrListImprovements", "committedDate": "2020-03-06T17:07:51Z", "type": "commit"}, {"oid": "0f7659acdefe15d88cb9028a2031b883f1aea178", "url": "https://github.com/NationalSecurityAgency/datawave/commit/0f7659acdefe15d88cb9028a2031b883f1aea178", "message": "Merge branch 'release/version2.9' into bugfix/largeOrListImprovements", "committedDate": "2020-03-10T20:21:41Z", "type": "commit"}]}