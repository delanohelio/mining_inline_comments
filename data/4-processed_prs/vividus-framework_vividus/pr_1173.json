{"pr_number": 1173, "pr_title": "[plugin-web-app] Simplify proxy steps", "pr_createdAt": "2020-11-26T08:24:24Z", "pr_url": "https://github.com/vividus-framework/vividus/pull/1173", "timeline": [{"oid": "7f84a9ff4943705c16ce6bf8cf6339eec9b4086c", "url": "https://github.com/vividus-framework/vividus/commit/7f84a9ff4943705c16ce6bf8cf6339eec9b4086c", "message": "[plugin-web-app] Simplify proxy steps", "committedDate": "2020-11-26T08:43:18Z", "type": "commit"}, {"oid": "7f84a9ff4943705c16ce6bf8cf6339eec9b4086c", "url": "https://github.com/vividus-framework/vividus/commit/7f84a9ff4943705c16ce6bf8cf6339eec9b4086c", "message": "[plugin-web-app] Simplify proxy steps", "committedDate": "2020-11-26T08:43:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg3MTk5Nw==", "url": "https://github.com/vividus-framework/vividus/pull/1173#discussion_r530871997", "bodyText": "maybe something like Network Logs.har ?", "author": "uarlouski", "createdAt": "2020-11-26T09:04:37Z", "path": "vividus-plugin-web-app/src/main/java/org/vividus/proxy/steps/ProxySteps.java", "diffHunk": "@@ -96,11 +95,16 @@ public void clearProxyLog()\n      */\n     @Then(\"number of HTTP $httpMethods requests with URL pattern `$urlPattern` is $comparisonRule `$number`\")\n     public List<HarEntry> checkNumberOfRequests(Set<HttpMethod> httpMethods, Pattern urlPattern,\n-            ComparisonRule comparisonRule, long number) throws IOException\n+            ComparisonRule comparisonRule, int number) throws IOException\n     {\n         List<HarEntry> harEntries = getLogEntries(httpMethods, urlPattern);\n-        assertSize(String.format(\"Number of HTTP %s requests matching URL pattern '%s'\",\n-                methodsToString(httpMethods, \", \"), urlPattern), harEntries, comparisonRule, number);\n+        String description = String.format(\"Number of HTTP %s requests matching URL pattern '%s'\",\n+                methodsToString(httpMethods, \", \"), urlPattern);\n+        if (!softAssert.assertThat(description, harEntries.size(), comparisonRule.getComparisonRule(number)))\n+        {\n+            byte[] harBytes = OBJECT_MAPPER.writeValueAsBytes(proxy.getRecordedData());\n+            attachmentPublisher.publishAttachment(harBytes, \"har.har\");", "originalCommit": "7f84a9ff4943705c16ce6bf8cf6339eec9b4086c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg3NzU5MA==", "url": "https://github.com/vividus-framework/vividus/pull/1173#discussion_r530877590", "bodyText": "makes sense, but it should go as a separate commit\nPS: the goal of this PR is to make new logic of proxy check clearer", "author": "valfirst", "createdAt": "2020-11-26T09:13:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg3MTk5Nw=="}], "type": "inlineReview"}]}