{"pr_number": 751, "pr_title": "Switch cookies interaction to a WebDriver API", "pr_createdAt": "2020-07-17T11:53:12Z", "pr_url": "https://github.com/vividus-framework/vividus/pull/751", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5NDI0NA==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457094244", "bodyText": "@epic vividus-plugin-web-app", "author": "valfirst", "createdAt": "2020-07-20T06:29:52Z", "path": "vividus-tests/src/main/resources/story/integration/HttpCookieManagerTest.story", "diffHunk": "@@ -0,0 +1,19 @@\n+Description: Integration tests for CookieManager functionality\n+\n+Meta:\n+    @epic vividus-plugin-rest-api", "originalCommit": "b27c6314af50c29a43f000838a4629636991d276", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5NDU5Nw==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457094597", "bodyText": "Description: Integration tests for cookie management in web application", "author": "valfirst", "createdAt": "2020-07-20T06:30:26Z", "path": "vividus-tests/src/main/resources/story/integration/HttpCookieManagerTest.story", "diffHunk": "@@ -0,0 +1,19 @@\n+Description: Integration tests for CookieManager functionality", "originalCommit": "b27c6314af50c29a43f000838a4629636991d276", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5NTAwMg==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457095002", "bodyText": "Rename story: HttpCookieManagerTest.story -> WebCookieSteps.story", "author": "valfirst", "createdAt": "2020-07-20T06:31:12Z", "path": "vividus-tests/src/main/resources/story/integration/HttpCookieManagerTest.story", "diffHunk": "@@ -0,0 +1,19 @@\n+Description: Integration tests for CookieManager functionality", "originalCommit": "b27c6314af50c29a43f000838a4629636991d276", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5NTcyNw==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457095727", "bodyText": "I believe it should be enough to set only one cookie", "author": "valfirst", "createdAt": "2020-07-20T06:32:30Z", "path": "vividus-tests/src/main/resources/story/integration/HttpCookieManagerTest.story", "diffHunk": "@@ -0,0 +1,19 @@\n+Description: Integration tests for CookieManager functionality\n+\n+Meta:\n+    @epic vividus-plugin-rest-api\n+\n+Scenario: Verify step: \"I set all cookies for current domain:$parameters\"\n+Given I am on the main application page\n+When I set all cookies for current domain:\n+|cookieName |cookieValue |path|\n+|cookieName1|cookieValue1|/   |\n+|cookieName2|cookieValue2|/   |\n+Then a cookie with the name 'cookieName1' is set\n+Then a cookie with the name 'cookieName2' is set", "originalCommit": "b27c6314af50c29a43f000838a4629636991d276", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5NjA0Nw==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457096047", "bodyText": "This scenario depends on the previous one, please make them atomic", "author": "valfirst", "createdAt": "2020-07-20T06:33:06Z", "path": "vividus-tests/src/main/resources/story/integration/HttpCookieManagerTest.story", "diffHunk": "@@ -0,0 +1,19 @@\n+Description: Integration tests for CookieManager functionality\n+\n+Meta:\n+    @epic vividus-plugin-rest-api\n+\n+Scenario: Verify step: \"I set all cookies for current domain:$parameters\"\n+Given I am on the main application page\n+When I set all cookies for current domain:\n+|cookieName |cookieValue |path|\n+|cookieName1|cookieValue1|/   |\n+|cookieName2|cookieValue2|/   |\n+Then a cookie with the name 'cookieName1' is set\n+Then a cookie with the name 'cookieName2' is set\n+\n+Scenario: Verify step: \"I remove a cookie with the name '$cookieName' from the current domain\"\n+When I remove a cookie with the name 'cookieName1' from the current domain\n+When I remove a cookie with the name 'cookieName2' from the current domain", "originalCommit": "b27c6314af50c29a43f000838a4629636991d276", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5NjM1OQ==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457096359", "bodyText": "...Verify step: \"When I...", "author": "valfirst", "createdAt": "2020-07-20T06:33:45Z", "path": "vividus-tests/src/main/resources/story/integration/HttpCookieManagerTest.story", "diffHunk": "@@ -0,0 +1,19 @@\n+Description: Integration tests for CookieManager functionality\n+\n+Meta:\n+    @epic vividus-plugin-rest-api\n+\n+Scenario: Verify step: \"I set all cookies for current domain:$parameters\"", "originalCommit": "b27c6314af50c29a43f000838a4629636991d276", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5NjQyNw==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457096427", "bodyText": "...Verify step: \"When I...", "author": "valfirst", "createdAt": "2020-07-20T06:33:55Z", "path": "vividus-tests/src/main/resources/story/integration/HttpCookieManagerTest.story", "diffHunk": "@@ -0,0 +1,19 @@\n+Description: Integration tests for CookieManager functionality\n+\n+Meta:\n+    @epic vividus-plugin-rest-api\n+\n+Scenario: Verify step: \"I set all cookies for current domain:$parameters\"\n+Given I am on the main application page\n+When I set all cookies for current domain:\n+|cookieName |cookieValue |path|\n+|cookieName1|cookieValue1|/   |\n+|cookieName2|cookieValue2|/   |\n+Then a cookie with the name 'cookieName1' is set\n+Then a cookie with the name 'cookieName2' is set\n+\n+Scenario: Verify step: \"I remove a cookie with the name '$cookieName' from the current domain\"", "originalCommit": "b27c6314af50c29a43f000838a4629636991d276", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5897c5ca7dc4123eedd91fa44908e0d3a4723957", "url": "https://github.com/vividus-framework/vividus/commit/5897c5ca7dc4123eedd91fa44908e0d3a4723957", "message": "Switch cookies interaction to a WebDriver API", "committedDate": "2020-07-20T08:59:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzIwNjAwOA==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457206008", "bodyText": "logger.atInfo\njust cookie without toStr", "author": "uarlouski", "createdAt": "2020-07-20T09:12:38Z", "path": "vividus-plugin-web-app/src/main/java/org/vividus/ui/web/action/CookieManager.java", "diffHunk": "@@ -65,43 +59,24 @@ public void addCookie(String cookieName, String cookieValue, String path, URI ur\n \n     private void executeAddCookieScript(String cookieName, String cookieValue, String path, String domain)\n     {\n-        String cookie = String.format(JS_COOKIE_FORMAT, cookieName, cookieValue, path, domain);\n-        LOGGER.debug(\"Adding cookie: {}\", cookie);\n-        javascriptActions.executeScript(cookie);\n+        Cookie cookie = new Cookie.Builder(cookieName, cookieValue)\n+                .domain(\".\" + domain)\n+                .path(path)\n+                .build();\n+        LOGGER.info(\"Adding cookie: {}\", cookie.toString());", "originalCommit": "5897c5ca7dc4123eedd91fa44908e0d3a4723957", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzIwNzM0Ng==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457207346", "bodyText": "please use values different than parameter names", "author": "uarlouski", "createdAt": "2020-07-20T09:14:26Z", "path": "vividus-tests/src/main/resources/story/integration/WebCookieSteps.story", "diffHunk": "@@ -0,0 +1,19 @@\n+Description: Integration tests for cookie management in web application\n+\n+Meta:\n+    @epic vividus-plugin-web-app\n+\n+Scenario: Verify step: \"When I set all cookies for current domain:$parameters\"\n+Given I am on the main application page\n+When I set all cookies for current domain:\n+|cookieName |cookieValue |path|\n+|cookieName1|cookieValue1|/   |\n+Then a cookie with the name 'cookieName1' is set\n+\n+Scenario: Verify step: \"When I remove a cookie with the name '$cookieName' from the current domain\"\n+Given I am on the main application page\n+When I set all cookies for current domain:\n+|cookieName |cookieValue |path|\n+|cookieName |cookieValue |/   |", "originalCommit": "5897c5ca7dc4123eedd91fa44908e0d3a4723957", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "db8d991f42489a13efd22e6016c4b2751ead9e48", "url": "https://github.com/vividus-framework/vividus/commit/db8d991f42489a13efd22e6016c4b2751ead9e48", "message": "Switch cookies interaction to a WebDriver API", "committedDate": "2020-07-20T09:44:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg5MTgzNQ==", "url": "https://github.com/vividus-framework/vividus/pull/751#discussion_r457891835", "bodyText": "Why it is nor required?\nIf it still not, step description should be updated", "author": "ikalinin1", "createdAt": "2020-07-21T07:27:21Z", "path": "vividus-plugin-web-app/src/main/java/org/vividus/bdd/steps/ui/web/CookieSteps.java", "diffHunk": "@@ -194,7 +194,6 @@ public void setAllCookies(ExamplesTable parameters)\n         {\n             cookieManager.addCookie(row.get(\"cookieName\"), row.get(\"cookieValue\"), row.get(\"path\"), currentUrl);\n         });\n-        navigateActions.refresh();", "originalCommit": "db8d991f42489a13efd22e6016c4b2751ead9e48", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "36206e29485c037172f07918cebde5d093ef31f2", "url": "https://github.com/vividus-framework/vividus/commit/36206e29485c037172f07918cebde5d093ef31f2", "message": "Switch cookies interaction to a WebDriver API", "committedDate": "2020-07-30T12:37:14Z", "type": "commit"}, {"oid": "36206e29485c037172f07918cebde5d093ef31f2", "url": "https://github.com/vividus-framework/vividus/commit/36206e29485c037172f07918cebde5d093ef31f2", "message": "Switch cookies interaction to a WebDriver API", "committedDate": "2020-07-30T12:37:14Z", "type": "forcePushed"}, {"oid": "bad88ceffbf3409568b930db82ce74fb9ad49eea", "url": "https://github.com/vividus-framework/vividus/commit/bad88ceffbf3409568b930db82ce74fb9ad49eea", "message": "[vividus-plugin-web-app] Remove Android 6 and 7 profiles (#1269)", "committedDate": "2020-12-24T15:31:57Z", "type": "commit"}, {"oid": "e56d3efa903f0a8da1ab675a1d4a581e51b3e900", "url": "https://github.com/vividus-framework/vividus/commit/e56d3efa903f0a8da1ab675a1d4a581e51b3e900", "message": "Merge branch 'master' into cookie", "committedDate": "2020-12-24T15:35:25Z", "type": "commit"}, {"oid": "a0c8b97122cab2262190cb067d559a9fcdfb1ae9", "url": "https://github.com/vividus-framework/vividus/commit/a0c8b97122cab2262190cb067d559a9fcdfb1ae9", "message": "Fix PMD violations in unit tests", "committedDate": "2020-12-24T15:50:33Z", "type": "commit"}, {"oid": "1cb4f0096b993a0126fc80fec244967639a78a39", "url": "https://github.com/vividus-framework/vividus/commit/1cb4f0096b993a0126fc80fec244967639a78a39", "message": "Fix CheckStyle violations", "committedDate": "2020-12-24T16:01:43Z", "type": "commit"}, {"oid": "02ec564ad5dbfae6bf7f99e5975e8de3c244dd1c", "url": "https://github.com/vividus-framework/vividus/commit/02ec564ad5dbfae6bf7f99e5975e8de3c244dd1c", "message": "Fix one more PMD violation", "committedDate": "2020-12-25T06:23:25Z", "type": "commit"}, {"oid": "9ba988a41efa3fc7687778cd088149bfa022d920", "url": "https://github.com/vividus-framework/vividus/commit/9ba988a41efa3fc7687778cd088149bfa022d920", "message": "Fix one more CheckStyle violation", "committedDate": "2020-12-25T18:14:23Z", "type": "commit"}]}