{"pr_number": 1034, "pr_title": "[extension-selenium] Add step to check element existence for duration", "pr_createdAt": "2020-10-16T15:11:47Z", "pr_url": "https://github.com/vividus-framework/vividus/pull/1034", "timeline": [{"oid": "52aacda77ce5b29fa3fdc983a0754ce833f61a4b", "url": "https://github.com/vividus-framework/vividus/commit/52aacda77ce5b29fa3fdc983a0754ce833f61a4b", "message": "[extension-selenium] Add step to check element existence for duration", "committedDate": "2020-10-16T15:55:43Z", "type": "forcePushed"}, {"oid": "5d86affdae1aaa01823bf6af56aa80e14b7ec76b", "url": "https://github.com/vividus-framework/vividus/commit/5d86affdae1aaa01823bf6af56aa80e14b7ec76b", "message": "[extension-selenium] Add step to check element existence for duration", "committedDate": "2020-10-16T16:05:09Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk3OTE5Nw==", "url": "https://github.com/vividus-framework/vividus/pull/1034#discussion_r506979197", "bodyText": "Then element located `$locator` exists for `$duration` duration", "author": "valfirst", "createdAt": "2020-10-17T20:07:27Z", "path": "vividus-extension-selenium/src/main/java/org/vividus/bdd/steps/ui/GenericWaitSteps.java", "diffHunk": "@@ -59,6 +66,22 @@ public void waitForElementDisappearance(Locator locator)\n         waitForCondition(expectedSearchActionsConditions.invisibilityOfElement(locator));\n     }\n \n+    /**\n+     * Checks that element located by <b>locator</b> exists during the <b>duration</b>\n+     * @param locator locator to find an element\n+     * @param duration total waiting time according to <a href=\"https://en.wikipedia.org/wiki/ISO_8601\">ISO 8601</a>\n+     * standard\n+     */\n+    @Then(\"element located '$locator' exists for '$duration' duration\")", "originalCommit": "5d86affdae1aaa01823bf6af56aa80e14b7ec76b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk3OTM1NA==", "url": "https://github.com/vividus-framework/vividus/pull/1034#discussion_r506979354", "bodyText": "is there any way to pretty-print duration?", "author": "valfirst", "createdAt": "2020-10-17T20:09:37Z", "path": "vividus-extension-selenium/src/main/java/org/vividus/bdd/steps/ui/GenericWaitSteps.java", "diffHunk": "@@ -59,6 +66,22 @@ public void waitForElementDisappearance(Locator locator)\n         waitForCondition(expectedSearchActionsConditions.invisibilityOfElement(locator));\n     }\n \n+    /**\n+     * Checks that element located by <b>locator</b> exists during the <b>duration</b>\n+     * @param locator locator to find an element\n+     * @param duration total waiting time according to <a href=\"https://en.wikipedia.org/wiki/ISO_8601\">ISO 8601</a>\n+     * standard\n+     */\n+    @Then(\"element located '$locator' exists for '$duration' duration\")\n+    public void doesElementByLocatorExistsForDuration(Locator locator, Duration duration)\n+    {\n+        WaitResult<Boolean> result = waitActions.wait(uiContext.getSearchContext(), duration,\n+                expectedSearchActionsConditions\n+                        .not(expectedSearchActionsConditions.presenceOfAllElementsLocatedBy(locator)), false);\n+        softAssert.assertFalse(String.format(\"Element located by locator '%s' has existed during '%s' duration\",\n+                locator, duration.toSeconds()), result.isWaitPassed());", "originalCommit": "5d86affdae1aaa01823bf6af56aa80e14b7ec76b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk3OTY1MA==", "url": "https://github.com/vividus-framework/vividus/pull/1034#discussion_r506979650", "bodyText": "I believe we should revise org.vividus.ui.action.search.Locator#toString as first", "author": "valfirst", "createdAt": "2020-10-17T20:13:26Z", "path": "vividus-extension-selenium/src/test/java/org/vividus/bdd/steps/ui/GenericWaitStepsTests.java", "diffHunk": "@@ -75,4 +81,26 @@ void testWaitTillElementDisappears()\n         waitSteps.waitForElementDisappearance(locator);\n         verify(waitActions).wait(webElement, condition);\n     }\n+\n+    @SuppressWarnings(\"unchecked\")\n+    @Test\n+    void testElementByLocatorExistsForDuration()\n+    {\n+        Locator locator = new Locator(TestLocatorType.SEARCH, VALUE);\n+        IExpectedSearchContextCondition<List<WebElement>> presenceOfAllElements = mock(\n+                IExpectedSearchContextCondition.class);\n+        IExpectedSearchContextCondition<Boolean> not = mock(IExpectedSearchContextCondition.class);\n+        WaitResult<Boolean> waitResult = new WaitResult<>();\n+        waitResult.setWaitPassed(true);\n+\n+        when(uiContext.getSearchContext()).thenReturn(webElement);\n+        when(expectedSearchActionsConditions.presenceOfAllElementsLocatedBy(locator)).thenReturn(presenceOfAllElements);\n+        when(expectedSearchActionsConditions.not(presenceOfAllElements)).thenReturn(not);\n+        when(waitActions.wait(webElement, Duration.ZERO, not, false)).thenReturn(waitResult);\n+\n+        waitSteps.doesElementByLocatorExistsForDuration(locator, Duration.ZERO);\n+\n+        verify(softAssert).assertFalse(\"Element located by locator ' Search: 'value'; Visibility: VISIBLE;' has existed\"", "originalCommit": "5d86affdae1aaa01823bf6af56aa80e14b7ec76b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk4Mjc1Mg==", "url": "https://github.com/vividus-framework/vividus/pull/1034#discussion_r506982752", "bodyText": "since = \"0.2.9\"", "author": "valfirst", "createdAt": "2020-10-17T20:50:34Z", "path": "vividus-plugin-web-app/src/main/java/org/vividus/bdd/steps/ui/web/WaitSteps.java", "diffHunk": "@@ -338,9 +338,11 @@ public void elementByIdDisappears(String id)\n \n     /**\n      * Checks that element exists during the timeout\n+     * @deprecated Use <code>Then element located '$locator' exists for '$duration' duration</code>\n      * @param seconds timeout in seconds\n      * @param xpath XPath value of the element\n      */\n+    @Deprecated(forRemoval = true, since = \"0.3.0\")", "originalCommit": "5d86affdae1aaa01823bf6af56aa80e14b7ec76b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1da5187406e005174a3b209bbc3c43f994edf0bd", "url": "https://github.com/vividus-framework/vividus/commit/1da5187406e005174a3b209bbc3c43f994edf0bd", "message": "[extension-selenium] Add step to check element existence for duration", "committedDate": "2020-10-19T11:36:23Z", "type": "forcePushed"}, {"oid": "f7704da5faf82539c10783154774bc64c8e829e2", "url": "https://github.com/vividus-framework/vividus/commit/f7704da5faf82539c10783154774bc64c8e829e2", "message": "[extension-selenium] Add step to check element existence for duration", "committedDate": "2020-10-19T11:51:43Z", "type": "forcePushed"}, {"oid": "e51b0fd117245474962fad97dcab58a39b7ee534", "url": "https://github.com/vividus-framework/vividus/commit/e51b0fd117245474962fad97dcab58a39b7ee534", "message": "[extension-selenium] Add step to check element existence for duration", "committedDate": "2020-10-19T12:10:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzczMzc1Mg==", "url": "https://github.com/vividus-framework/vividus/pull/1034#discussion_r507733752", "bodyText": "what about adding minutes as well?", "author": "valfirst", "createdAt": "2020-10-19T13:12:40Z", "path": "vividus-extension-selenium/src/main/java/org/vividus/bdd/steps/ui/GenericWaitSteps.java", "diffHunk": "@@ -59,6 +68,41 @@ public void waitForElementDisappearance(Locator locator)\n         waitForCondition(expectedSearchActionsConditions.invisibilityOfElement(locator));\n     }\n \n+    /**\n+     * Checks that element located by <b>locator</b> exists during the <b>duration</b>\n+     * @param locator locator to find an element\n+     * @param duration total waiting time according to <a href=\"https://en.wikipedia.org/wiki/ISO_8601\">ISO 8601</a>\n+     * standard\n+     */\n+    @Then(\"element located `$locator` exists for `$duration` duration\")\n+    public void doesElementByLocatorExistsForDuration(Locator locator, Duration duration)\n+    {\n+        String prettyDuration = formatDuration(duration);\n+\n+        WaitResult<Boolean> result = waitActions.wait(uiContext.getSearchContext(), duration,\n+                expectedSearchActionsConditions\n+                        .not(expectedSearchActionsConditions.presenceOfAllElementsLocatedBy(locator)), false);\n+\n+        String assertionMessage = String.format(\"Element located by locator %s has existed during %s\",\n+                locator.toHumanReadableString(), prettyDuration);\n+        softAssert.assertFalse(assertionMessage, result.isWaitPassed());\n+    }\n+\n+    private String formatDuration(Duration duration)\n+    {\n+        String durationFormat = \"\";\n+        if (duration.toSeconds() != 0)\n+        {\n+            durationFormat += \"s' seconds' \";", "originalCommit": "e51b0fd117245474962fad97dcab58a39b7ee534", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzczNDQ1Mg==", "url": "https://github.com/vividus-framework/vividus/pull/1034#discussion_r507734452", "bodyText": "during vs for?", "author": "valfirst", "createdAt": "2020-10-19T13:13:44Z", "path": "vividus-extension-selenium/src/main/java/org/vividus/bdd/steps/ui/GenericWaitSteps.java", "diffHunk": "@@ -59,6 +68,41 @@ public void waitForElementDisappearance(Locator locator)\n         waitForCondition(expectedSearchActionsConditions.invisibilityOfElement(locator));\n     }\n \n+    /**\n+     * Checks that element located by <b>locator</b> exists during the <b>duration</b>\n+     * @param locator locator to find an element\n+     * @param duration total waiting time according to <a href=\"https://en.wikipedia.org/wiki/ISO_8601\">ISO 8601</a>\n+     * standard\n+     */\n+    @Then(\"element located `$locator` exists for `$duration` duration\")\n+    public void doesElementByLocatorExistsForDuration(Locator locator, Duration duration)\n+    {\n+        String prettyDuration = formatDuration(duration);\n+\n+        WaitResult<Boolean> result = waitActions.wait(uiContext.getSearchContext(), duration,\n+                expectedSearchActionsConditions\n+                        .not(expectedSearchActionsConditions.presenceOfAllElementsLocatedBy(locator)), false);\n+\n+        String assertionMessage = String.format(\"Element located by locator %s has existed during %s\",", "originalCommit": "e51b0fd117245474962fad97dcab58a39b7ee534", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2bf255b51b31e88dad635308d18b9d7f8f820dfc", "url": "https://github.com/vividus-framework/vividus/commit/2bf255b51b31e88dad635308d18b9d7f8f820dfc", "message": "[extension-selenium] Add step to check element existence for duration", "committedDate": "2020-10-19T13:33:07Z", "type": "forcePushed"}, {"oid": "04e7cc09779ef2966e01d582ef339fee95ce28e9", "url": "https://github.com/vividus-framework/vividus/commit/04e7cc09779ef2966e01d582ef339fee95ce28e9", "message": "[extension-selenium] Add step to check element existence for duration", "committedDate": "2020-10-21T08:41:00Z", "type": "forcePushed"}, {"oid": "3021f410f826380311ad1e9ed960c709e2fb21f9", "url": "https://github.com/vividus-framework/vividus/commit/3021f410f826380311ad1e9ed960c709e2fb21f9", "message": "[extension-selenium] Add step to check element existence for duration", "committedDate": "2020-10-21T09:55:11Z", "type": "commit"}, {"oid": "3021f410f826380311ad1e9ed960c709e2fb21f9", "url": "https://github.com/vividus-framework/vividus/commit/3021f410f826380311ad1e9ed960c709e2fb21f9", "message": "[extension-selenium] Add step to check element existence for duration", "committedDate": "2020-10-21T09:55:11Z", "type": "forcePushed"}]}