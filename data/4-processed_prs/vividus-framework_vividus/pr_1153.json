{"pr_number": 1153, "pr_title": "[plugin-web-app] Add possibility to override browser's proxy host", "pr_createdAt": "2020-11-19T12:09:13Z", "pr_url": "https://github.com/vividus-framework/vividus/pull/1153", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjg1Nzk5NQ==", "url": "https://github.com/vividus-framework/vividus/pull/1153#discussion_r526857995", "bodyText": "String proxyAddress = hostName + ':' + proxyServer.getPort();\nreturn new org.openqa.selenium.Proxy().setHttpProxy(proxyAddress)\n                                      .setSslProxy(proxyAddress);\n\nmaybe", "author": "uarlouski", "createdAt": "2020-11-19T12:54:33Z", "path": "vividus-extension-selenium/src/main/java/org/vividus/proxy/Proxy.java", "diffHunk": "@@ -112,7 +115,19 @@ public void clearRequestFilters()\n     @Override\n     public org.openqa.selenium.Proxy createSeleniumProxy()\n     {\n-        return ClientUtil.createSeleniumProxy(proxyServer, InetAddress.getLoopbackAddress());\n+        return Optional.ofNullable(proxyHost)\n+                       .map(this::createSeleniumProxy)\n+                       .orElseGet(() -> ClientUtil.createSeleniumProxy(proxyServer, InetAddress.getLoopbackAddress()));\n+    }\n+\n+    private org.openqa.selenium.Proxy createSeleniumProxy(String hostName)", "originalCommit": "9df98576c6383a09fbfbac0e7d3c6f9570e495f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzEwNjIzNg==", "url": "https://github.com/vividus-framework/vividus/pull/1153#discussion_r527106236", "bodyText": "com.browserup.bup.client.ClientUtil#createSeleniumProxy(com.browserup.bup.BrowserUpProxy, java.net.InetAddress) ?", "author": "valfirst", "createdAt": "2020-11-19T18:27:17Z", "path": "vividus-extension-selenium/src/main/java/org/vividus/proxy/Proxy.java", "diffHunk": "@@ -112,7 +115,19 @@ public void clearRequestFilters()\n     @Override\n     public org.openqa.selenium.Proxy createSeleniumProxy()\n     {\n-        return ClientUtil.createSeleniumProxy(proxyServer, InetAddress.getLoopbackAddress());\n+        return Optional.ofNullable(proxyHost)\n+                       .map(this::createSeleniumProxy)\n+                       .orElseGet(() -> ClientUtil.createSeleniumProxy(proxyServer, InetAddress.getLoopbackAddress()));\n+    }\n+\n+    private org.openqa.selenium.Proxy createSeleniumProxy(String hostName)", "originalCommit": "9df98576c6383a09fbfbac0e7d3c6f9570e495f8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQ3MTg2Nw==", "url": "https://github.com/vividus-framework/vividus/pull/1153#discussion_r527471867", "bodyText": "InetAddress will resolve it, and there is no guarantee that it could be resolved from the machine where the tests running", "author": "ikalinin1", "createdAt": "2020-11-20T06:42:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzEwNjIzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQ3NTQ3MA==", "url": "https://github.com/vividus-framework/vividus/pull/1153#discussion_r527475470", "bodyText": "Having host.docker.internal it will throw UnknownHostException with a trace:\nCaused by: java.net.UnknownHostException: host.docker.internal: nodename nor servname provided, or not known\n\tat java.base/java.net.Inet6AddressImpl.lookupAllHostAddr(Native Method)\n\tat java.base/java.net.InetAddress$PlatformNameService.lookupAllHostAddr(InetAddress.java:930)\n\tat java.base/java.net.InetAddress.getAddressesFromNameService(InetAddress.java:1499)\n\tat java.base/java.net.InetAddress$NameServiceAddresses.get(InetAddress.java:849)\n\tat java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1489)\n\tat java.base/java.net.InetAddress.getAllByName(InetAddress.java:1348)\n\tat java.base/java.net.InetAddress.getAllByName(InetAddress.java:1282)\n\tat java.base/java.net.InetAddress.getByName(InetAddress.java:1232)\n\tat org.vividus.proxy.Proxy.createSeleniumProxy(Proxy.java:133)", "author": "ikalinin1", "createdAt": "2020-11-20T06:52:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzEwNjIzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MzcwNQ==", "url": "https://github.com/vividus-framework/vividus/pull/1153#discussion_r527553705", "bodyText": "FYI: browserup/browserup-proxy#318", "author": "valfirst", "createdAt": "2020-11-20T09:16:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzEwNjIzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzEwNzMwNg==", "url": "https://github.com/vividus-framework/vividus/pull/1153#discussion_r527107306", "bodyText": "selenium.proxy.host -> proxy.connectable-host ? that's a naming from BrowserUp proxy\n\nconnectableAddress the network address the Selenium Proxy will use to reach this BrowserUpProxy instance", "author": "valfirst", "createdAt": "2020-11-19T18:29:04Z", "path": "docs/modules/plugins/pages/plugin-web-app.adoc", "diffHunk": "@@ -190,6 +190,26 @@ include::partial$selenium-properties.adoc[]\n |proxy\n |empty\n |Provides possibility to attach screenshot for failed proxy steps\n+\n+|proxy.enabled\n+|true/false\n+|false\n+|Enabled proxy for the run\n+\n+|proxy.host\n+|any host name resolving on the machine\n+|empty\n+|Overrides the host which will be used by proxy\n+\n+|proxy.ports\n+|10000-10005\n+|empty\n+|Defines ports range which could be used for proxy\n+\n+|selenium.proxy.host", "originalCommit": "9df98576c6383a09fbfbac0e7d3c6f9570e495f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3a1bbbc6b397f50b90971c12f64d2930a038d2db", "url": "https://github.com/vividus-framework/vividus/commit/3a1bbbc6b397f50b90971c12f64d2930a038d2db", "message": "[plugin-web-app] Add possibility to override browser's proxy host", "committedDate": "2020-11-20T11:01:15Z", "type": "commit"}, {"oid": "3a1bbbc6b397f50b90971c12f64d2930a038d2db", "url": "https://github.com/vividus-framework/vividus/commit/3a1bbbc6b397f50b90971c12f64d2930a038d2db", "message": "[plugin-web-app] Add possibility to override browser's proxy host", "committedDate": "2020-11-20T11:01:15Z", "type": "forcePushed"}]}