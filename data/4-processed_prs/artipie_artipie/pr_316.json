{"pr_number": 316, "pr_title": "Binary proof", "pr_createdAt": "2020-07-13T12:39:16Z", "pr_url": "https://github.com/artipie/artipie/pull/316", "timeline": [{"oid": "1b9e29e72bcf2209a1b69ba88ef6ff3e75de0d96", "url": "https://github.com/artipie/artipie/commit/1b9e29e72bcf2209a1b69ba88ef6ff3e75de0d96", "message": "#154 - binary action proof", "committedDate": "2020-07-13T13:24:07Z", "type": "commit"}, {"oid": "1b9e29e72bcf2209a1b69ba88ef6ff3e75de0d96", "url": "https://github.com/artipie/artipie/commit/1b9e29e72bcf2209a1b69ba88ef6ff3e75de0d96", "message": "#154 - binary action proof", "committedDate": "2020-07-13T13:24:07Z", "type": "forcePushed"}, {"oid": "d6384c9d786cf4f7aeda1d919a1a526f23ab02dc", "url": "https://github.com/artipie/artipie/commit/d6384c9d786cf4f7aeda1d919a1a526f23ab02dc", "message": "#154 - make action more descriptive", "committedDate": "2020-07-13T13:39:00Z", "type": "commit"}, {"oid": "0beb20188f5d965640ca160be1f1438b19144cd0", "url": "https://github.com/artipie/artipie/commit/0beb20188f5d965640ca160be1f1438b19144cd0", "message": "#154 - fix syntax error", "committedDate": "2020-07-13T13:41:35Z", "type": "commit"}, {"oid": "b48546c44c40122f34a815db8d75641a5b46a394", "url": "https://github.com/artipie/artipie/commit/b48546c44c40122f34a815db8d75641a5b46a394", "message": "#154 - add correct permission for test to pass", "committedDate": "2020-07-13T13:42:59Z", "type": "commit"}, {"oid": "543841c3d0623682d6e104e45962d213c18f5c75", "url": "https://github.com/artipie/artipie/commit/543841c3d0623682d6e104e45962d213c18f5c75", "message": "#154 - update readme with config and badge", "committedDate": "2020-07-13T13:52:53Z", "type": "commit"}, {"oid": "90cdad9bdabf2e37761161172c9e842a1846d908", "url": "https://github.com/artipie/artipie/commit/90cdad9bdabf2e37761161172c9e842a1846d908", "message": "#154 - build artipie instead of using an existed version", "committedDate": "2020-07-13T13:57:10Z", "type": "commit"}, {"oid": "052538a871cdac7f05cc5201b392f2f25be29723", "url": "https://github.com/artipie/artipie/commit/052538a871cdac7f05cc5201b392f2f25be29723", "message": "#154 - badge should refer to dir with the example", "committedDate": "2020-07-13T14:10:29Z", "type": "commit"}, {"oid": "224181da527b97a56fa6b1f4a5574c55057aac7e", "url": "https://github.com/artipie/artipie/commit/224181da527b97a56fa6b1f4a5574c55057aac7e", "message": "#154 - move actions file to proofs dir", "committedDate": "2020-07-14T04:11:57Z", "type": "commit"}, {"oid": "b782f45b5433be1910b550090932490d4d327984", "url": "https://github.com/artipie/artipie/commit/b782f45b5433be1910b550090932490d4d327984", "message": "#154 - add proof run for windows and mac os platforms", "committedDate": "2020-07-14T04:13:38Z", "type": "commit"}, {"oid": "d8c9a677250920373b5032ba9db42c297644c566", "url": "https://github.com/artipie/artipie/commit/d8c9a677250920373b5032ba9db42c297644c566", "message": "#154 - revert dir change, since dirs are not allowed", "committedDate": "2020-07-14T04:46:20Z", "type": "commit"}, {"oid": "b8164da6a4809868cda1f510408dba451651d3b6", "url": "https://github.com/artipie/artipie/commit/b8164da6a4809868cda1f510408dba451651d3b6", "message": "#154 - use matrix for all platforms run", "committedDate": "2020-07-14T04:58:42Z", "type": "commit"}, {"oid": "143eee9389d14058756cc3aa832daf867021801b", "url": "https://github.com/artipie/artipie/commit/143eee9389d14058756cc3aa832daf867021801b", "message": "#154 - fix formatting", "committedDate": "2020-07-14T05:01:28Z", "type": "commit"}, {"oid": "bbab8b5d64613da5b30b9d99ca6149117dede7f4", "url": "https://github.com/artipie/artipie/commit/bbab8b5d64613da5b30b9d99ca6149117dede7f4", "message": "#154 - fix formatting", "committedDate": "2020-07-14T05:01:53Z", "type": "commit"}, {"oid": "6a7fb3bac04c0dc7a1b57c64acafdfaa7f9f7221", "url": "https://github.com/artipie/artipie/commit/6a7fb3bac04c0dc7a1b57c64acafdfaa7f9f7221", "message": "#154 - fix formatting", "committedDate": "2020-07-14T05:02:20Z", "type": "commit"}, {"oid": "f68fcc9f4b620c085e2c925d55d93b20e18c5cd3", "url": "https://github.com/artipie/artipie/commit/f68fcc9f4b620c085e2c925d55d93b20e18c5cd3", "message": "#154 - run proof only on ubuntu", "committedDate": "2020-07-14T05:04:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIwNjIzMg==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454206232", "bodyText": "Run only on push to the master branch", "author": "Sammers21", "createdAt": "2020-07-14T08:54:27Z", "path": ".github/workflows/proof-bin.yaml", "diffHunk": "@@ -0,0 +1,26 @@\n+name: \"Proof::binary\"\n+\"on\": [push, pull_request]", "originalCommit": "f68fcc9f4b620c085e2c925d55d93b20e18c5cd3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIwNjU0Mw==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454206543", "bodyText": "Move this and subsequent line into a bash script", "author": "Sammers21", "createdAt": "2020-07-14T08:54:55Z", "path": ".github/workflows/proof-bin.yaml", "diffHunk": "@@ -0,0 +1,26 @@\n+name: \"Proof::binary\"\n+\"on\": [push, pull_request]\n+jobs:\n+  proof:\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check out the code\n+        uses: actions/checkout@v2\n+      - name: Build docker image\n+        run: |\n+          docker build . -t artipie\n+      - name: Start artipie with binary example configuration\n+        run: |\n+          cd examples/binary\n+          docker run -d -it -v $(pwd)/artipie.yaml:/etc/artipie.yml -v $(pwd):/var/artipie -p 8080:80 artipie", "originalCommit": "f68fcc9f4b620c085e2c925d55d93b20e18c5cd3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ad43dc00232899c4276c1a2f2b468e302cfddb6f", "url": "https://github.com/artipie/artipie/commit/ad43dc00232899c4276c1a2f2b468e302cfddb6f", "message": "#154 - move bash into a script", "committedDate": "2020-07-14T09:10:22Z", "type": "commit"}, {"oid": "f9c98e48040980ce0d7bca84913a0628d3cc7193", "url": "https://github.com/artipie/artipie/commit/f9c98e48040980ce0d7bca84913a0628d3cc7193", "message": "#154 - fix sed query and script launching", "committedDate": "2020-07-14T09:15:52Z", "type": "commit"}, {"oid": "795a7e6592afa7e5c5b0cedc75a77a4401f678f1", "url": "https://github.com/artipie/artipie/commit/795a7e6592afa7e5c5b0cedc75a77a4401f678f1", "message": "#154 - trigger on push only", "committedDate": "2020-07-14T09:26:14Z", "type": "commit"}, {"oid": "4ab025cbf7562406e1a47104707d07ccf4a60d9c", "url": "https://github.com/artipie/artipie/commit/4ab025cbf7562406e1a47104707d07ccf4a60d9c", "message": "#154 - fix script so it is not modified with sed", "committedDate": "2020-07-14T09:30:08Z", "type": "commit"}, {"oid": "28012bcdc91411c9bc8c2488debe2fabc970d623", "url": "https://github.com/artipie/artipie/commit/28012bcdc91411c9bc8c2488debe2fabc970d623", "message": "#154 - replace POST with PUT", "committedDate": "2020-07-14T09:35:52Z", "type": "commit"}, {"oid": "a24319f56b29efeb6bf01894bc7f4210f1e6fa0e", "url": "https://github.com/artipie/artipie/commit/a24319f56b29efeb6bf01894bc7f4210f1e6fa0e", "message": "#154 - fix a grammar error", "committedDate": "2020-07-14T09:38:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI1MTI5MQ==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454251291", "bodyText": "@Sammers21 let's start only on push to master events", "author": "g4s8", "createdAt": "2020-07-14T10:14:08Z", "path": ".github/workflows/proof-bin.yaml", "diffHunk": "@@ -0,0 +1,16 @@\n+name: \"Proof::binary\"\n+\"on\": [push]", "originalCommit": "a24319f56b29efeb6bf01894bc7f4210f1e6fa0e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fa611eb93663316c8f4b2c0d7e4631452d251ae9", "url": "https://github.com/artipie/artipie/commit/fa611eb93663316c8f4b2c0d7e4631452d251ae9", "message": "#154 - trigger only on push to the master branch", "committedDate": "2020-07-14T10:16:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI2MjI5NQ==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454262295", "bodyText": "@Sammers21 do not see why we need to remove running Artipie container in the example", "author": "olegmoz", "createdAt": "2020-07-14T10:35:05Z", "path": "examples/binary/run.sh", "diffHunk": "@@ -0,0 +1,18 @@\n+set -x\n+set -e\n+# start artipie\n+docker run --name artipie -d -it -v $(pwd)/artipie.yaml:/etc/artipie.yml -v $(pwd):/var/artipie -p 8080:80 artipie/artipie:latest\n+# wait for container to be ready for the new connections\n+sleep 5\n+# create a file for subsequent publication\n+echo \"hello world\" > text.txt\n+# publish text.txt\n+curl --silent -X PUT --data-binary \"@text.txt\" http://localhost:8080/repo/text.txt\n+# download the file\n+STATUSCODE=$(curl --silent --output /dev/stderr --write-out \"%{http_code}\" -X GET http://localhost:8080/repo/text.txt)\n+# remove container\n+docker rm -f artipie", "originalCommit": "fa611eb93663316c8f4b2c0d7e4631452d251ae9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MjY5NQ==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454272695", "bodyText": "@olegmoz, because the second attempt to run the example will fail, a user will be tempted to remove created container manually.", "author": "Sammers21", "createdAt": "2020-07-14T10:55:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI2MjI5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDMwNzc0OQ==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454307749", "bodyText": "@Sammers21 I do not see that often in examples or documentations. Why do you think user will need to run it twice?", "author": "olegmoz", "createdAt": "2020-07-14T12:07:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI2MjI5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI2NDY5NQ==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454264695", "bodyText": "@Sammers21 I'd suggest to improve code formatting:\n\nStart each comment with capital letter and end with a dot.\nPut an empty line before each block (before each comment), I believe it will be easier to read and see that comment is related no next line, not previous one.", "author": "olegmoz", "createdAt": "2020-07-14T10:39:59Z", "path": "examples/binary/run.sh", "diffHunk": "@@ -0,0 +1,18 @@\n+set -x\n+set -e\n+# start artipie\n+docker run --name artipie -d -it -v $(pwd)/artipie.yaml:/etc/artipie.yml -v $(pwd):/var/artipie -p 8080:80 artipie/artipie:latest\n+# wait for container to be ready for the new connections\n+sleep 5\n+# create a file for subsequent publication\n+echo \"hello world\" > text.txt\n+# publish text.txt\n+curl --silent -X PUT --data-binary \"@text.txt\" http://localhost:8080/repo/text.txt\n+# download the file\n+STATUSCODE=$(curl --silent --output /dev/stderr --write-out \"%{http_code}\" -X GET http://localhost:8080/repo/text.txt)\n+# remove container\n+docker rm -f artipie\n+# make sure status code is 200\n+if test $STATUSCODE -ne 200; then\n+  exit 1\n+fi", "originalCommit": "fa611eb93663316c8f4b2c0d7e4631452d251ae9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI2ODUyNg==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454268526", "bodyText": "@Sammers21 there is a grammar error, the cannot be used with plurals", "author": "olegmoz", "createdAt": "2020-07-14T10:47:37Z", "path": "examples/binary/run.sh", "diffHunk": "@@ -0,0 +1,18 @@\n+set -x\n+set -e\n+# start artipie\n+docker run --name artipie -d -it -v $(pwd)/artipie.yaml:/etc/artipie.yml -v $(pwd):/var/artipie -p 8080:80 artipie/artipie:latest\n+# wait for container to be ready for the new connections", "originalCommit": "fa611eb93663316c8f4b2c0d7e4631452d251ae9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDg4OQ==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454270889", "bodyText": "@Sammers21 I'd suggest to remove not required params from example to make it simple. metrics are not required (the bug has been fixed), layout seems to be flat by default", "author": "olegmoz", "createdAt": "2020-07-14T10:52:17Z", "path": "examples/binary/artipie.yaml", "diffHunk": "@@ -0,0 +1,7 @@\n+meta:\n+  storage:\n+    type: fs\n+    path: /var/artipie/configs\n+  metrics:\n+    type: log\n+  layout: flat", "originalCommit": "fa611eb93663316c8f4b2c0d7e4631452d251ae9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI5MDM4NQ==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454290385", "bodyText": "@olegmoz, Metrics have been removed. Layout can't be removed, because it would not work without it.", "author": "Sammers21", "createdAt": "2020-07-14T11:32:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDg4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDMwNjAxNQ==", "url": "https://github.com/artipie/artipie/pull/316#discussion_r454306015", "bodyText": "@Sammers21 that's sad, hope there is an issue about it", "author": "olegmoz", "createdAt": "2020-07-14T12:03:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDg4OQ=="}], "type": "inlineReview"}, {"oid": "cfb3e45be4c670caa4dc3bcfb1d5eeb4892080f8", "url": "https://github.com/artipie/artipie/commit/cfb3e45be4c670caa4dc3bcfb1d5eeb4892080f8", "message": "#154 - implement formatting suggestion by @olegmoz", "committedDate": "2020-07-14T11:29:10Z", "type": "commit"}, {"oid": "587dcacbb6304ebcf417c3caa52f5758e37cc718", "url": "https://github.com/artipie/artipie/commit/587dcacbb6304ebcf417c3caa52f5758e37cc718", "message": "#154 - remove logging section", "committedDate": "2020-07-14T11:30:59Z", "type": "commit"}, {"oid": "8ee1793c90369946c29155e66e8df71559c5be63", "url": "https://github.com/artipie/artipie/commit/8ee1793c90369946c29155e66e8df71559c5be63", "message": "Merge branch 'master' into binary_proof", "committedDate": "2020-07-14T11:32:13Z", "type": "commit"}, {"oid": "07540047482da21ce3415c2ee9efb528ed6792fe", "url": "https://github.com/artipie/artipie/commit/07540047482da21ce3415c2ee9efb528ed6792fe", "message": "Merge branch 'master' into binary_proof", "committedDate": "2020-07-14T11:40:36Z", "type": "commit"}, {"oid": "a43a0f1955f04a5d3666c38dd18b6f94b2be0f48", "url": "https://github.com/artipie/artipie/commit/a43a0f1955f04a5d3666c38dd18b6f94b2be0f48", "message": "Merge branch 'master' into binary_proof", "committedDate": "2020-07-14T12:47:19Z", "type": "commit"}]}