{"pr_number": 323, "pr_title": "Migrate docker image to jdk with JEP 358", "pr_createdAt": "2020-07-14T07:12:00Z", "pr_url": "https://github.com/artipie/artipie/pull/323", "timeline": [{"oid": "b8eb38bd58005c549c8fb6a44b46c5db76f43ddb", "url": "https://github.com/artipie/artipie/commit/b8eb38bd58005c549c8fb6a44b46c5db76f43ddb", "message": "#322 - migrate docker image to jdk with JEP 358", "committedDate": "2020-07-14T07:06:59Z", "type": "commit"}, {"oid": "2e1628344c118b9008c3d6a5fd7af97318302cbe", "url": "https://github.com/artipie/artipie/commit/2e1628344c118b9008c3d6a5fd7af97318302cbe", "message": "#322 - make ENTRYPOINT a one liner", "committedDate": "2020-07-14T07:10:49Z", "type": "commit"}, {"oid": "d2d6dc2b6ddbb6e32a796238d309f63d6500042c", "url": "https://github.com/artipie/artipie/commit/d2d6dc2b6ddbb6e32a796238d309f63d6500042c", "message": "#322 - use shell form for entrypoint", "committedDate": "2020-07-14T07:22:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDE2MTc4NA==", "url": "https://github.com/artipie/artipie/pull/323#discussion_r454161784", "bodyText": "@Sammers21 you've introduced env variable called JAVA_OPTS but uses JVM_OPTS", "author": "g4s8", "createdAt": "2020-07-14T07:34:59Z", "path": "Dockerfile", "diffHunk": "@@ -6,12 +6,13 @@ COPY src ./src\n RUN mvn versions:set -DnewVersion=${version} && \\\n   mvn package -P assembly\n \n-FROM adoptopenjdk/openjdk13:alpine-jre\n+FROM adoptopenjdk/openjdk14:alpine-jre\n+ENV JAVA_OPTS=\"\"\n LABEL description=\"Artipie binary repository managment tool\"\n LABEL maintainer=\"titantins@gmail.com\"\n LABEL maintainer=\"g4s8.public@gmail.com\"\n COPY --from=build_jar /jar/target/artipie-jar-with-dependencies.jar /usr/lib/artipie.jar\n COPY _config.yml /etc/artipie.yml\n EXPOSE 80\n-ENTRYPOINT [\"java\", \"-jar\", \"/usr/lib/artipie.jar\"]\n+ENTRYPOINT java $JVM_OPTS --enable-preview -XX:+ShowCodeDetailsInExceptionMessages -jar /usr/lib/artipie.jar", "originalCommit": "d2d6dc2b6ddbb6e32a796238d309f63d6500042c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "97909dda60336a6a642fe944070722fa58764ed5", "url": "https://github.com/artipie/artipie/commit/97909dda60336a6a642fe944070722fa58764ed5", "message": "#322 - remove entry and move everything to cmd", "committedDate": "2020-07-14T07:54:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDE3NjI3MQ==", "url": "https://github.com/artipie/artipie/pull/323#discussion_r454176271", "bodyText": "I use shell form because there is no different way to pass JVM_OPTS.", "author": "Sammers21", "createdAt": "2020-07-14T08:01:28Z", "path": "Dockerfile", "diffHunk": "@@ -6,12 +6,12 @@ COPY src ./src\n RUN mvn versions:set -DnewVersion=${version} && \\\n   mvn package -P assembly\n \n-FROM adoptopenjdk/openjdk13:alpine-jre\n+FROM adoptopenjdk/openjdk14:alpine-jre\n+ENV JAVA_OPTS=\"\"\n LABEL description=\"Artipie binary repository managment tool\"\n LABEL maintainer=\"titantins@gmail.com\"\n LABEL maintainer=\"g4s8.public@gmail.com\"\n COPY --from=build_jar /jar/target/artipie-jar-with-dependencies.jar /usr/lib/artipie.jar\n COPY _config.yml /etc/artipie.yml\n EXPOSE 80\n-ENTRYPOINT [\"java\", \"-jar\", \"/usr/lib/artipie.jar\"]\n-CMD [\"--config-file=/etc/artipie.yml\", \"--port=80\"]\n+CMD java $JVM_OPTS --enable-preview -XX:+ShowCodeDetailsInExceptionMessages -jar /usr/lib/artipie.jar --config-file=/etc/artipie.yml --port=80", "originalCommit": "97909dda60336a6a642fe944070722fa58764ed5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgzNTc1NA==", "url": "https://github.com/artipie/artipie/pull/323#discussion_r454835754", "bodyText": "@Sammers21 I know that. But the problem is still not fixed: you've introduced env-variable JAVA_OPTS, but uses JVM_OPTS (different name)", "author": "g4s8", "createdAt": "2020-07-15T07:03:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDE3NjI3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgzNjk1NQ==", "url": "https://github.com/artipie/artipie/pull/323#discussion_r454836955", "bodyText": "@g4s8, just fixed in 8ee88d3", "author": "Sammers21", "createdAt": "2020-07-15T07:06:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDE3NjI3MQ=="}], "type": "inlineReview"}, {"oid": "305850e30d1a4e75555fa4f1773d6224e84ec758", "url": "https://github.com/artipie/artipie/commit/305850e30d1a4e75555fa4f1773d6224e84ec758", "message": "Merge branch 'master' into docker_jdk_14", "committedDate": "2020-07-14T11:47:10Z", "type": "commit"}, {"oid": "53fc54b0f31e2a5e7c3c86b21207a58a233c925b", "url": "https://github.com/artipie/artipie/commit/53fc54b0f31e2a5e7c3c86b21207a58a233c925b", "message": "Merge branch 'master' into docker_jdk_14", "committedDate": "2020-07-14T13:05:32Z", "type": "commit"}, {"oid": "8ee88d3c1fd645e71abd10bc957c6f98ad655f98", "url": "https://github.com/artipie/artipie/commit/8ee88d3c1fd645e71abd10bc957c6f98ad655f98", "message": "#322 - fix typo", "committedDate": "2020-07-15T07:05:45Z", "type": "commit"}, {"oid": "3127c2b64e86ac2bc168c3b4f7ff7e0117ea835d", "url": "https://github.com/artipie/artipie/commit/3127c2b64e86ac2bc168c3b4f7ff7e0117ea835d", "message": "Merge branch 'master' into docker_jdk_14", "committedDate": "2020-07-15T09:21:38Z", "type": "commit"}, {"oid": "d8b01f0ba4a9e1cea83ae0581b1391c0fe34a8b6", "url": "https://github.com/artipie/artipie/commit/d8b01f0ba4a9e1cea83ae0581b1391c0fe34a8b6", "message": "Merge branch 'master' into docker_jdk_14", "committedDate": "2020-07-15T09:54:28Z", "type": "commit"}]}