{"pr_number": 483, "pr_title": "php composer proof", "pr_createdAt": "2020-08-21T12:08:36Z", "pr_url": "https://github.com/artipie/artipie/pull/483", "timeline": [{"oid": "f999820e3a02a29101f8ea77371d1aaff8dbb863", "url": "https://github.com/artipie/artipie/commit/f999820e3a02a29101f8ea77371d1aaff8dbb863", "message": "#154 - php-composer proof", "committedDate": "2020-08-21T12:08:02Z", "type": "commit"}, {"oid": "279e7e9bad6e51c5bf3ad0640742ec5004833366", "url": "https://github.com/artipie/artipie/commit/279e7e9bad6e51c5bf3ad0640742ec5004833366", "message": "#154 - enable php proof on pull request", "committedDate": "2020-08-21T12:09:20Z", "type": "commit"}, {"oid": "47332db742eb4f223334760da17a05cf389af584", "url": "https://github.com/artipie/artipie/commit/47332db742eb4f223334760da17a05cf389af584", "message": "#154 - readability improvements", "committedDate": "2020-08-21T12:11:14Z", "type": "commit"}, {"oid": "d33837f60e52c857085044c215fc1dd8bc0b02ca", "url": "https://github.com/artipie/artipie/commit/d33837f60e52c857085044c215fc1dd8bc0b02ca", "message": "#154 - polishing", "committedDate": "2020-08-21T12:13:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2MjYyMg==", "url": "https://github.com/artipie/artipie/pull/483#discussion_r474662622", "bodyText": "@Sammers21 guess this command is to clean up after previous run? If so, would not it be better move it down to somewhere around docker stop artipie command", "author": "olegmoz", "createdAt": "2020-08-21T12:23:16Z", "path": "examples/php/run.sh", "diffHunk": "@@ -0,0 +1,35 @@\n+set -x\n+set -e\n+\n+# Start artipie.\n+docker run --rm --name artipie -d -it -v $(pwd)/artipie.yaml:/etc/artipie.yml -v $(pwd):/var/artipie -p 8080:80 artipie/artipie:latest\n+\n+# Wait for container to be ready for new connections.\n+sleep 5\n+\n+# Make a zip package and post it to artipie binary storage.\n+zip -r sample-for-deployment.zip sample-for-deployment\n+curl -i -X PUT --data-binary \"@sample-for-deployment.zip\" http://localhost:8080/bin/sample-for-deployment.zip\n+\n+# Post the package to php-composer-repository.\n+curl -i -X POST  http://localhost:8080/my-php \\\n+--request PUT \\\n+-H \"Expect:\" \\\n+-H 'Content-Type: application/json; charset=utf-8' \\\n+--data-binary @- << EOF\n+{\n+  \"name\": \"artipie/sample_composer_package\",\n+  \"version\": \"1.0\",\n+  \"dist\": {\n+    \"url\": \"http://localhost:8080/bin/sample-for-deployment.zip\",\n+    \"type\": \"zip\"\n+  }\n+}\n+EOF\n+\n+# Install the deployed package.\n+cd sample-consumer; rm -rf vendor/ composer.lock", "originalCommit": "d33837f60e52c857085044c215fc1dd8bc0b02ca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2NzkxMA==", "url": "https://github.com/artipie/artipie/pull/483#discussion_r474667910", "bodyText": "@Sammers21 guess this command is to clean up after previous run?\n\n@olegmoz, Yes and for ensuring that the package will be downloaded via network and vendor/ cache would not be reused.\n\nIf so, would not it be better move it down to somewhere around docker stop artipie command\n\nIf I would do this, a user would not be able to inspect the vendor/ directory and composer.lock file, which he might find useful.", "author": "Sammers21", "createdAt": "2020-08-21T12:33:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2MjYyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2MzE2OA==", "url": "https://github.com/artipie/artipie/pull/483#discussion_r474663168", "bodyText": "@Sammers21 are these headers required? I'd keep the example as simple and short as possible and removed everything that is not mandatory", "author": "olegmoz", "createdAt": "2020-08-21T12:24:25Z", "path": "examples/php/run.sh", "diffHunk": "@@ -0,0 +1,35 @@\n+set -x\n+set -e\n+\n+# Start artipie.\n+docker run --rm --name artipie -d -it -v $(pwd)/artipie.yaml:/etc/artipie.yml -v $(pwd):/var/artipie -p 8080:80 artipie/artipie:latest\n+\n+# Wait for container to be ready for new connections.\n+sleep 5\n+\n+# Make a zip package and post it to artipie binary storage.\n+zip -r sample-for-deployment.zip sample-for-deployment\n+curl -i -X PUT --data-binary \"@sample-for-deployment.zip\" http://localhost:8080/bin/sample-for-deployment.zip\n+\n+# Post the package to php-composer-repository.\n+curl -i -X POST  http://localhost:8080/my-php \\\n+--request PUT \\\n+-H \"Expect:\" \\\n+-H 'Content-Type: application/json; charset=utf-8' \\", "originalCommit": "d33837f60e52c857085044c215fc1dd8bc0b02ca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8b77c3586af163474019ecc18e1d6cf7cc34e306", "url": "https://github.com/artipie/artipie/commit/8b77c3586af163474019ecc18e1d6cf7cc34e306", "message": "#154 - remove non-mandatory headers", "committedDate": "2020-08-21T12:30:14Z", "type": "commit"}, {"oid": "770b46933320b5e5e0f79891b60a9836543f9e6e", "url": "https://github.com/artipie/artipie/commit/770b46933320b5e5e0f79891b60a9836543f9e6e", "message": "Merge branch 'master' into php_proof", "committedDate": "2020-08-21T13:02:14Z", "type": "commit"}]}