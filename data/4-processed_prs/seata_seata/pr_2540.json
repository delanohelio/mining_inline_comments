{"pr_number": 2540, "pr_title": "optimize: refactoring rpc request method and rpc interface.", "pr_createdAt": "2020-04-12T16:44:01Z", "pr_url": "https://github.com/seata/seata/pull/2540", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUyOTA1OQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r451529059", "bodyText": "Keep abstract, there will be netty Server between TC and TC, don't write business logic dead here", "author": "slievrly", "createdAt": "2020-07-08T13:06:15Z", "path": "core/src/main/java/io/seata/core/rpc/netty/NettyRemotingServer.java", "diffHunk": "@@ -23,43 +23,105 @@\n import io.netty.handler.timeout.IdleState;\n import io.netty.handler.timeout.IdleStateEvent;\n import io.seata.common.util.NetUtil;\n+import io.seata.core.protocol.HeartbeatMessage;\n+import io.seata.core.protocol.MessageType;\n+import io.seata.core.protocol.ProtocolConstants;\n import io.seata.core.protocol.RpcMessage;\n-import io.seata.core.rpc.ChannelManager;\n+import io.seata.core.rpc.RegisterCheckAuthHandler;\n import io.seata.core.rpc.RemotingServer;\n import io.seata.core.rpc.RpcContext;\n import io.seata.core.rpc.TransactionMessageHandler;\n-import io.seata.core.rpc.processor.Pair;\n import io.seata.core.rpc.processor.RemotingProcessor;\n+import io.seata.core.rpc.processor.Pair;\n+import io.seata.core.rpc.processor.server.RegRmProcessor;\n+import io.seata.core.rpc.processor.server.RegTmProcessor;\n+import io.seata.core.rpc.processor.server.ServerHeartbeatProcessor;\n+import io.seata.core.rpc.processor.server.ServerOnRequestProcessor;\n+import io.seata.core.rpc.processor.server.ServerOnResponseProcessor;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n import java.util.concurrent.ExecutorService;\n import java.util.concurrent.ThreadPoolExecutor;\n+import java.util.concurrent.TimeoutException;\n \n /**\n- * The type Rpc remoting server.\n+ * The netty remoting server.\n  *\n  * @author slievrly\n  * @author xingfudeshi@gmail.com\n  * @author zhangchenghui.dev@gmail.com\n  */\n-public abstract class AbstractRpcRemotingServer extends AbstractRpcRemoting implements RemotingServer {\n+public class NettyRemotingServer extends AbstractNettyRemoting implements RemotingServer {", "originalCommit": "6e1ab479c801cf8d28f915da0d3823d4343f6cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjI1NTcxMQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452255711", "bodyText": "You are right, I will roll back later.", "author": "objcoding", "createdAt": "2020-07-09T14:22:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUyOTA1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY0Mjk0Mg==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452642942", "bodyText": "done.", "author": "objcoding", "createdAt": "2020-07-10T06:17:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUyOTA1OQ=="}], "type": "inlineReview"}, {"oid": "e8d3ccfa3058f8dbb2e523caa111e06a5ca403c3", "url": "https://github.com/seata/seata/commit/e8d3ccfa3058f8dbb2e523caa111e06a5ca403c3", "message": "reset format", "committedDate": "2020-07-10T01:09:32Z", "type": "commit"}, {"oid": "cdf50dbee370e730499b4d47a8aa448e4cfa57df", "url": "https://github.com/seata/seata/commit/cdf50dbee370e730499b4d47a8aa448e4cfa57df", "message": "response has msg field.", "committedDate": "2020-07-10T01:20:49Z", "type": "commit"}, {"oid": "451d58652d3ce8348e1ebd06e5154b37352bacad", "url": "https://github.com/seata/seata/commit/451d58652d3ce8348e1ebd06e5154b37352bacad", "message": "add abstract remoting remoting server.", "committedDate": "2020-07-10T06:12:33Z", "type": "commit"}, {"oid": "75e2bc0469887dc2c8a23f26c74ad7f7c40dd114", "url": "https://github.com/seata/seata/commit/75e2bc0469887dc2c8a23f26c74ad7f7c40dd114", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-07-10T06:14:02Z", "type": "commit"}, {"oid": "572cbde07c6467569a71bc2c084cce9fa5df9140", "url": "https://github.com/seata/seata/commit/572cbde07c6467569a71bc2c084cce9fa5df9140", "message": "do -> handle", "committedDate": "2020-07-10T06:19:35Z", "type": "commit"}, {"oid": "79a7b70077c99f0453cc5b6cc27ecbb48ae7d4c2", "url": "https://github.com/seata/seata/commit/79a7b70077c99f0453cc5b6cc27ecbb48ae7d4c2", "message": "comment", "committedDate": "2020-07-10T06:24:27Z", "type": "commit"}, {"oid": "fc168ce4fc857622d357519f22ba3fedbd882d51", "url": "https://github.com/seata/seata/commit/fc168ce4fc857622d357519f22ba3fedbd882d51", "message": "comment", "committedDate": "2020-07-10T06:37:19Z", "type": "commit"}, {"oid": "a96697d68ce54ef5407fe52668cc32fc55ed3aa9", "url": "https://github.com/seata/seata/commit/a96697d68ce54ef5407fe52668cc32fc55ed3aa9", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-07-10T07:28:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjczMDM3Ng==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452730376", "bodyText": "Why change the name to handleUndoLogDelete?", "author": "l81893521", "createdAt": "2020-07-10T09:25:20Z", "path": "core/src/main/java/io/seata/core/rpc/processor/client/RmBranchRollbackProcessor.java", "diffHunk": "@@ -55,19 +55,19 @@ public void process(ChannelHandlerContext ctx, RpcMessage rpcMessage) throws Exc\n         if (LOGGER.isInfoEnabled()) {\n             LOGGER.info(\"rm handle branch rollback process:\" + msg);\n         }\n-        handleBranchRollback(rpcMessage, remoteAddress, (BranchRollbackRequest) msg);\n+        handleUndoLogDelete(rpcMessage, remoteAddress, (BranchRollbackRequest) msg);", "originalCommit": "a96697d68ce54ef5407fe52668cc32fc55ed3aa9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjczNzM4MQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452737381", "bodyText": "done", "author": "objcoding", "createdAt": "2020-07-10T09:39:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjczMDM3Ng=="}], "type": "inlineReview"}, {"oid": "7f574e010f730b1e57d4326ba60e88d2c74a93f6", "url": "https://github.com/seata/seata/commit/7f574e010f730b1e57d4326ba60e88d2c74a93f6", "message": "handleBranchRollback", "committedDate": "2020-07-10T09:28:25Z", "type": "commit"}, {"oid": "41ebbe3c7df940b2039d4a7f5881fa203152bf82", "url": "https://github.com/seata/seata/commit/41ebbe3c7df940b2039d4a7f5881fa203152bf82", "message": "Merge remote-tracking branch 'origin/refactoring-rpc-phase4' into refactoring-rpc-phase4", "committedDate": "2020-07-10T09:29:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI5ODg1Nw==", "url": "https://github.com/seata/seata/pull/2540#discussion_r453298857", "bodyText": "response", "author": "slievrly", "createdAt": "2020-07-12T10:35:20Z", "path": "core/src/main/java/io/seata/core/rpc/processor/server/RegRmProcessor.java", "diffHunk": "@@ -80,7 +80,7 @@ private void onRegRmMessage(ChannelHandlerContext ctx, RpcMessage rpcMessage) {\n         if (StringUtils.isNotEmpty(errorInfo)) {\n             response.setMsg(errorInfo);\n         }\n-        remotingServer.sendResponse(rpcMessage, ctx.channel(), response);\n+        remotingServer.sendAsyncResponse(rpcMessage, ctx.channel(), new RegisterRMResponse(isSuccess));", "originalCommit": "41ebbe3c7df940b2039d4a7f5881fa203152bf82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMxMzI1Ng==", "url": "https://github.com/seata/seata/pull/2540#discussion_r453313256", "bodyText": "done", "author": "objcoding", "createdAt": "2020-07-12T12:55:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI5ODg1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI5OTAxNA==", "url": "https://github.com/seata/seata/pull/2540#discussion_r453299014", "bodyText": "response", "author": "slievrly", "createdAt": "2020-07-12T10:37:10Z", "path": "core/src/main/java/io/seata/core/rpc/processor/server/RegTmProcessor.java", "diffHunk": "@@ -82,7 +82,7 @@ private void onRegTmMessage(ChannelHandlerContext ctx, RpcMessage rpcMessage) {\n         if (StringUtils.isNotEmpty(errorInfo)) {\n             response.setMsg(errorInfo);\n         }\n-        remotingServer.sendResponse(rpcMessage, ctx.channel(), response);\n+        remotingServer.sendAsyncResponse(rpcMessage, ctx.channel(), new RegisterTMResponse(isSuccess));", "originalCommit": "41ebbe3c7df940b2039d4a7f5881fa203152bf82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMxMzI0Mg==", "url": "https://github.com/seata/seata/pull/2540#discussion_r453313242", "bodyText": "done.", "author": "objcoding", "createdAt": "2020-07-12T12:55:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI5OTAxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMwMjYzMw==", "url": "https://github.com/seata/seata/pull/2540#discussion_r453302633", "bodyText": "vs  AbstractNettyRemotingClient, why remove Bootstrap?", "author": "slievrly", "createdAt": "2020-07-12T11:14:19Z", "path": "core/src/main/java/io/seata/core/rpc/netty/AbstractNettyRemotingServer.java", "diffHunk": "@@ -23,96 +23,82 @@\n import io.netty.handler.timeout.IdleState;\n import io.netty.handler.timeout.IdleStateEvent;\n import io.seata.common.util.NetUtil;\n+import io.seata.core.protocol.HeartbeatMessage;\n+import io.seata.core.protocol.ProtocolConstants;\n import io.seata.core.protocol.RpcMessage;\n-import io.seata.core.rpc.ChannelManager;\n import io.seata.core.rpc.RemotingServer;\n import io.seata.core.rpc.RpcContext;\n-import io.seata.core.rpc.TransactionMessageHandler;\n import io.seata.core.rpc.processor.Pair;\n import io.seata.core.rpc.processor.RemotingProcessor;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n import java.util.concurrent.ExecutorService;\n import java.util.concurrent.ThreadPoolExecutor;\n+import java.util.concurrent.TimeoutException;\n \n /**\n- * The type Rpc remoting server.\n+ * The type abstract remoting server.\n  *\n- * @author slievrly\n- * @author xingfudeshi@gmail.com\n  * @author zhangchenghui.dev@gmail.com\n+ * @since 1.3.0\n  */\n-public abstract class AbstractRpcRemotingServer extends AbstractRpcRemoting implements RemotingServer {\n+public abstract class AbstractNettyRemotingServer extends AbstractNettyRemoting implements RemotingServer {\n \n-    private static final Logger LOGGER = LoggerFactory.getLogger(AbstractRpcRemotingServer.class);\n+    private static final Logger LOGGER = LoggerFactory.getLogger(AbstractNettyRemotingServer.class);\n \n-    private final RpcServerBootstrap serverBootstrap;\n-\n-    private TransactionMessageHandler transactionMessageHandler;\n-\n-    /**\n-     * Instantiates a new Rpc remoting server.\n-     *\n-     * @param messageExecutor   the message executor\n-     * @param nettyServerConfig the netty server config\n-     */\n-    public AbstractRpcRemotingServer(final ThreadPoolExecutor messageExecutor, NettyServerConfig nettyServerConfig) {\n+    public AbstractNettyRemotingServer(ThreadPoolExecutor messageExecutor) {\n         super(messageExecutor);\n-        serverBootstrap = new RpcServerBootstrap(nettyServerConfig);", "originalCommit": "41ebbe3c7df940b2039d4a7f5881fa203152bf82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMxMzIyMw==", "url": "https://github.com/seata/seata/pull/2540#discussion_r453313223", "bodyText": "Specific Bootstrap has subclasses to implement, for example, now put bootstarp in NettyRemotingServer.", "author": "objcoding", "createdAt": "2020-07-12T12:55:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMwMjYzMw=="}], "type": "inlineReview"}, {"oid": "4c0244767d35c2a6b81f21a0e9c01a24682c1482", "url": "https://github.com/seata/seata/commit/4c0244767d35c2a6b81f21a0e9c01a24682c1482", "message": "response", "committedDate": "2020-07-12T12:42:52Z", "type": "commit"}, {"oid": "bf8e4d3e5fa0886ecb4790a8b0b09038f56a3511", "url": "https://github.com/seata/seata/commit/bf8e4d3e5fa0886ecb4790a8b0b09038f56a3511", "message": "fix rpc init", "committedDate": "2020-07-13T08:29:33Z", "type": "commit"}, {"oid": "01b1deb5ef0e023152b05fb1b1a2f3d84466c08c", "url": "https://github.com/seata/seata/commit/01b1deb5ef0e023152b05fb1b1a2f3d84466c08c", "message": "optimize: refactoring rpc.", "committedDate": "2020-03-28T16:00:50Z", "type": "commit"}, {"oid": "5841bb98cfcefe566728496ffaf362034f73feee", "url": "https://github.com/seata/seata/commit/5841bb98cfcefe566728496ffaf362034f73feee", "message": "fix MessageFutureTest#testFieldSetGet.", "committedDate": "2020-03-28T16:24:56Z", "type": "commit"}, {"oid": "969a50f01eb86626726f78d64804d92fa15ce95c", "url": "https://github.com/seata/seata/commit/969a50f01eb86626726f78d64804d92fa15ce95c", "message": "fix RpcMessageTest#testFieldGetSetFromJson.", "committedDate": "2020-03-28T16:29:05Z", "type": "commit"}, {"oid": "4719ec127b755c64326846c3cdb4e1d1a550775f", "url": "https://github.com/seata/seata/commit/4719ec127b755c64326846c3cdb4e1d1a550775f", "message": "fix NullPointException when pair is null.", "committedDate": "2020-03-29T05:48:48Z", "type": "commit"}, {"oid": "f738b5339c177bcf2318a3c75c71737096a812da", "url": "https://github.com/seata/seata/commit/f738b5339c177bcf2318a3c75c71737096a812da", "message": "get type comment.", "committedDate": "2020-03-29T06:35:46Z", "type": "commit"}, {"oid": "8a8d470a38b29fbbd375f28319e70cb00d69168c", "url": "https://github.com/seata/seata/commit/8a8d470a38b29fbbd375f28319e70cb00d69168c", "message": "optimize: refactoring rpc phase3.", "committedDate": "2020-03-30T15:36:00Z", "type": "commit"}, {"oid": "7706cfabca17dcd2353fd23790a33bb3818875de", "url": "https://github.com/seata/seata/commit/7706cfabca17dcd2353fd23790a33bb3818875de", "message": "1.fix remoting lock;2.add HeartbeatMessage processor.", "committedDate": "2020-03-30T16:00:45Z", "type": "commit"}, {"oid": "a22b12173bc417cd9d655bb96f1d806d36302266", "url": "https://github.com/seata/seata/commit/a22b12173bc417cd9d655bb96f1d806d36302266", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-03-30T16:03:37Z", "type": "commit"}, {"oid": "9da2eaebc4fa88de9f54a43a2f7078fd5d13b9a2", "url": "https://github.com/seata/seata/commit/9da2eaebc4fa88de9f54a43a2f7078fd5d13b9a2", "message": "Merge branch 'refactoring-rpc-phase3' into refactoring-rpc-phase4", "committedDate": "2020-03-31T10:04:01Z", "type": "commit"}, {"oid": "7dd8486c66c2f31990ab85fa68344830ce798b6d", "url": "https://github.com/seata/seata/commit/7dd8486c66c2f31990ab85fa68344830ce798b6d", "message": "optimize process", "committedDate": "2020-04-01T04:06:40Z", "type": "commit"}, {"oid": "578053a8bace0a765522e7bef61257a96045b05a", "url": "https://github.com/seata/seata/commit/578053a8bace0a765522e7bef61257a96045b05a", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3\n\n# Conflicts:\n#\tcore/src/main/java/io/seata/core/rpc/netty/AbstractRpcRemoting.java", "committedDate": "2020-04-01T04:08:04Z", "type": "commit"}, {"oid": "651a37e23e78aca9a038bd5b9541e257a27d2448", "url": "https://github.com/seata/seata/commit/651a37e23e78aca9a038bd5b9541e257a27d2448", "message": "optimize process", "committedDate": "2020-04-01T04:08:46Z", "type": "commit"}, {"oid": "690bd806895d347fe15b77c9e47bd70daf2d0e3f", "url": "https://github.com/seata/seata/commit/690bd806895d347fe15b77c9e47bd70daf2d0e3f", "message": "optimize process", "committedDate": "2020-04-01T04:10:13Z", "type": "commit"}, {"oid": "1b7b0d2b62abcda60af841db82dc625b72cb1804", "url": "https://github.com/seata/seata/commit/1b7b0d2b62abcda60af841db82dc625b72cb1804", "message": "optimize process", "committedDate": "2020-04-01T04:10:33Z", "type": "commit"}, {"oid": "f04865005a3a6607a2cae0472b3e5a1b54a5e0c5", "url": "https://github.com/seata/seata/commit/f04865005a3a6607a2cae0472b3e5a1b54a5e0c5", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-01T04:10:44Z", "type": "commit"}, {"oid": "ab2406e177ec7150128f5188882412c83db4b88f", "url": "https://github.com/seata/seata/commit/ab2406e177ec7150128f5188882412c83db4b88f", "message": "optimize process", "committedDate": "2020-04-01T04:13:21Z", "type": "commit"}, {"oid": "31dda60a98c37cd60feb7271b50492e424f3aac0", "url": "https://github.com/seata/seata/commit/31dda60a98c37cd60feb7271b50492e424f3aac0", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-01T04:13:43Z", "type": "commit"}, {"oid": "8d0a2f35b3c9304c9c9878451d936c611a381b84", "url": "https://github.com/seata/seata/commit/8d0a2f35b3c9304c9c9878451d936c611a381b84", "message": "optimize process", "committedDate": "2020-04-01T04:17:42Z", "type": "commit"}, {"oid": "e626fe9b5c9926a24b14470da05ba46d3c498621", "url": "https://github.com/seata/seata/commit/e626fe9b5c9926a24b14470da05ba46d3c498621", "message": "optimize process", "committedDate": "2020-04-01T04:41:09Z", "type": "commit"}, {"oid": "19ec71f69f19b1696da8681f170fc7292ab296f1", "url": "https://github.com/seata/seata/commit/19ec71f69f19b1696da8681f170fc7292ab296f1", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-01T04:43:33Z", "type": "commit"}, {"oid": "0cbaee14d8d718b83487db88536e19ca58a6468d", "url": "https://github.com/seata/seata/commit/0cbaee14d8d718b83487db88536e19ca58a6468d", "message": "Add Heartbeat MessageType.", "committedDate": "2020-04-01T04:54:54Z", "type": "commit"}, {"oid": "d325d96b530ef6c2da220e9f6acb4831df749353", "url": "https://github.com/seata/seata/commit/d325d96b530ef6c2da220e9f6acb4831df749353", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-01T04:55:16Z", "type": "commit"}, {"oid": "1b64e4a2971ccf1fc922f85a961fb027a6b49bd4", "url": "https://github.com/seata/seata/commit/1b64e4a2971ccf1fc922f85a961fb027a6b49bd4", "message": "optimize do process logic", "committedDate": "2020-04-01T06:52:54Z", "type": "commit"}, {"oid": "c1f775bf59e2074fcd8ded5f5652370a145857a5", "url": "https://github.com/seata/seata/commit/c1f775bf59e2074fcd8ded5f5652370a145857a5", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-01T06:53:10Z", "type": "commit"}, {"oid": "e8accee14e63adb5bdd868740b460b206ff8c89d", "url": "https://github.com/seata/seata/commit/e8accee14e63adb5bdd868740b460b206ff8c89d", "message": "optimize do process logic", "committedDate": "2020-04-01T07:02:34Z", "type": "commit"}, {"oid": "ad86a6705d79c27226cd173eeab1dacade99fdb0", "url": "https://github.com/seata/seata/commit/ad86a6705d79c27226cd173eeab1dacade99fdb0", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-01T07:02:49Z", "type": "commit"}, {"oid": "28ab6dddd6f0a5e8d8e1530dd051337cbc12aa2b", "url": "https://github.com/seata/seata/commit/28ab6dddd6f0a5e8d8e1530dd051337cbc12aa2b", "message": "fix ClientHeartbeatMessageProcessor", "committedDate": "2020-04-01T07:18:36Z", "type": "commit"}, {"oid": "af6bf70df92e8df2a5550bf88a3c07b36c733103", "url": "https://github.com/seata/seata/commit/af6bf70df92e8df2a5550bf88a3c07b36c733103", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-01T07:18:55Z", "type": "commit"}, {"oid": "5595047b77a9083561a77f632b86de83d1e6ba3a", "url": "https://github.com/seata/seata/commit/5595047b77a9083561a77f632b86de83d1e6ba3a", "message": "fix HeartbeatMessageProcessor name", "committedDate": "2020-04-01T07:22:41Z", "type": "commit"}, {"oid": "31382358891dd8a9aa6b38a2c5c8aed06bc7df64", "url": "https://github.com/seata/seata/commit/31382358891dd8a9aa6b38a2c5c8aed06bc7df64", "message": "Merge branch 'refactoring-rpc-phase3' into refactoring-rpc-phase4", "committedDate": "2020-04-01T12:40:21Z", "type": "commit"}, {"oid": "69dafb9b4b15b38f5b6f8647c12273374855b4db", "url": "https://github.com/seata/seata/commit/69dafb9b4b15b38f5b6f8647c12273374855b4db", "message": "registry processor before init client.", "committedDate": "2020-04-01T13:28:24Z", "type": "commit"}, {"oid": "82d82a29f5e7b717874446b488444a64c21546db", "url": "https://github.com/seata/seata/commit/82d82a29f5e7b717874446b488444a64c21546db", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-01T13:29:04Z", "type": "commit"}, {"oid": "1bc6fbc172ea2f1c7bc0c0fd50fd274e2f27f1ff", "url": "https://github.com/seata/seata/commit/1bc6fbc172ea2f1c7bc0c0fd50fd274e2f27f1ff", "message": "Merge branch 'refactoring-rpc-phase3' into refactoring-rpc-phase4", "committedDate": "2020-04-01T13:34:53Z", "type": "commit"}, {"oid": "38f9aa1814bf3c7a9b8e3e3e6684e168381ab609", "url": "https://github.com/seata/seata/commit/38f9aa1814bf3c7a9b8e3e3e6684e168381ab609", "message": "remove unused class.", "committedDate": "2020-04-01T14:10:24Z", "type": "commit"}, {"oid": "79ce3e310cbcaa2e99ce4980018f0dcd72e64fac", "url": "https://github.com/seata/seata/commit/79ce3e310cbcaa2e99ce4980018f0dcd72e64fac", "message": "TrxMessageProcessor Comment.", "committedDate": "2020-04-03T09:06:42Z", "type": "commit"}, {"oid": "88aeec5ee78bd369708628a8473042d8fb0090e4", "url": "https://github.com/seata/seata/commit/88aeec5ee78bd369708628a8473042d8fb0090e4", "message": "TrxMessageProcessor Comment.", "committedDate": "2020-04-03T09:11:28Z", "type": "commit"}, {"oid": "43a0daf2095d13833a400729d6a554db7cc0fad6", "url": "https://github.com/seata/seata/commit/43a0daf2095d13833a400729d6a554db7cc0fad6", "message": "rm processor comment.", "committedDate": "2020-04-03T09:13:52Z", "type": "commit"}, {"oid": "bc83e81793580f2d4fbc06b081d1f114b6d27e7a", "url": "https://github.com/seata/seata/commit/bc83e81793580f2d4fbc06b081d1f114b6d27e7a", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-03T09:14:11Z", "type": "commit"}, {"oid": "f96b350da19e12c37660492ce345214b92c7ab41", "url": "https://github.com/seata/seata/commit/f96b350da19e12c37660492ce345214b92c7ab41", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-04-09T14:22:53Z", "type": "commit"}, {"oid": "b445c86339410111590aae0979bc73f2d459c9b2", "url": "https://github.com/seata/seata/commit/b445c86339410111590aae0979bc73f2d459c9b2", "message": "Merge branch 'refactoring-rpc-phase3' into refactoring-rpc-phase4", "committedDate": "2020-04-09T14:39:03Z", "type": "commit"}, {"oid": "6580ab774650a4dff9227ddf44b44ead1dcce96e", "url": "https://github.com/seata/seata/commit/6580ab774650a4dff9227ddf44b44ead1dcce96e", "message": "Merge branch 'develop' into refactoring-rpc-phase4\n\n# Conflicts:\n#\tcore/src/main/java/io/seata/core/rpc/netty/RpcClientBootstrap.java", "committedDate": "2020-04-10T11:47:21Z", "type": "commit"}, {"oid": "ba00a8d73be8fa0a233d7d0724fa050395e7abbb", "url": "https://github.com/seata/seata/commit/ba00a8d73be8fa0a233d7d0724fa050395e7abbb", "message": "Merge branch 'develop' into refactoring-rpc-phase2\n\n# Conflicts:\n#\tcore/src/main/java/io/seata/core/rpc/netty/RpcClientBootstrap.java", "committedDate": "2020-04-10T11:48:40Z", "type": "commit"}, {"oid": "01a8b63fa73b23dd0f138c2ce7eaecb51bfaa9e2", "url": "https://github.com/seata/seata/commit/01a8b63fa73b23dd0f138c2ce7eaecb51bfaa9e2", "message": "Merge branch 'refactoring-rpc-phase2' into refactoring-rpc-phase3", "committedDate": "2020-04-10T11:49:09Z", "type": "commit"}, {"oid": "494360d498faeeb92b7f5de5eff01ea933203850", "url": "https://github.com/seata/seata/commit/494360d498faeeb92b7f5de5eff01ea933203850", "message": "Merge branch 'refactoring-rpc-phase3' into refactoring-rpc-phase4", "committedDate": "2020-04-10T11:50:45Z", "type": "commit"}, {"oid": "3011df281ae0b78c7b3e2259f3aac26c81192a3d", "url": "https://github.com/seata/seata/commit/3011df281ae0b78c7b3e2259f3aac26c81192a3d", "message": "optimize processor.", "committedDate": "2020-04-11T08:49:59Z", "type": "commit"}, {"oid": "43125b7b90779b88f77d2b8d71d0026a08d44a01", "url": "https://github.com/seata/seata/commit/43125b7b90779b88f77d2b8d71d0026a08d44a01", "message": "optimize processor.", "committedDate": "2020-04-11T09:03:30Z", "type": "commit"}, {"oid": "54c0af8ea1148f2a5c4b5d54249043b8af2e9cc8", "url": "https://github.com/seata/seata/commit/54c0af8ea1148f2a5c4b5d54249043b8af2e9cc8", "message": "optimize processor.", "committedDate": "2020-04-11T09:16:57Z", "type": "commit"}, {"oid": "e2aa444ef951aaac417a44feb4cec0f94b95c02b", "url": "https://github.com/seata/seata/commit/e2aa444ef951aaac417a44feb4cec0f94b95c02b", "message": "optimize processor.", "committedDate": "2020-04-11T09:20:09Z", "type": "commit"}, {"oid": "f20b7d77a47a2df72b915a605e1cfd110108b51e", "url": "https://github.com/seata/seata/commit/f20b7d77a47a2df72b915a605e1cfd110108b51e", "message": "Merge branch 'refactoring-rpc-phase3' into refactoring-rpc-phase4", "committedDate": "2020-04-11T10:46:26Z", "type": "commit"}, {"oid": "f3223b8f425b68d2168eb77c528d1de1300decdc", "url": "https://github.com/seata/seata/commit/f3223b8f425b68d2168eb77c528d1de1300decdc", "message": "optimize processor.", "committedDate": "2020-04-11T13:05:50Z", "type": "commit"}, {"oid": "20407eeeefbe7480eb800d6323f9ad963b518d6e", "url": "https://github.com/seata/seata/commit/20407eeeefbe7480eb800d6323f9ad963b518d6e", "message": "Merge branch 'refactoring-rpc-phase3' into refactoring-rpc-phase4", "committedDate": "2020-04-11T13:18:19Z", "type": "commit"}, {"oid": "f238ec0ba683a5aba7da75d03f447de0fe12670c", "url": "https://github.com/seata/seata/commit/f238ec0ba683a5aba7da75d03f447de0fe12670c", "message": "refactoring rpc request method.", "committedDate": "2020-04-12T16:41:08Z", "type": "commit"}, {"oid": "deaa67cdc2d6d81edfb91396fc85ab75fa9d2406", "url": "https://github.com/seata/seata/commit/deaa67cdc2d6d81edfb91396fc85ab75fa9d2406", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-04-12T16:42:39Z", "type": "commit"}, {"oid": "55194f6a1d41f164723f2bb8f8309796e6e41a0f", "url": "https://github.com/seata/seata/commit/55194f6a1d41f164723f2bb8f8309796e6e41a0f", "message": "Name optimization and class classification.", "committedDate": "2020-04-13T03:20:07Z", "type": "commit"}, {"oid": "0caf391ccdd6ce39f86fb603ac45c9e547ee0ea2", "url": "https://github.com/seata/seata/commit/0caf391ccdd6ce39f86fb603ac45c9e547ee0ea2", "message": "Name optimization and class classification.", "committedDate": "2020-04-13T11:19:36Z", "type": "commit"}, {"oid": "2b8f4e5a77e7a2b39962de9dc5a19cbdf52dbb69", "url": "https://github.com/seata/seata/commit/2b8f4e5a77e7a2b39962de9dc5a19cbdf52dbb69", "message": "comment", "committedDate": "2020-04-13T12:02:26Z", "type": "commit"}, {"oid": "f3165d20f718e29ce548253fae89e6410e0361e2", "url": "https://github.com/seata/seata/commit/f3165d20f718e29ce548253fae89e6410e0361e2", "message": "netty client / server class code order adjustment.", "committedDate": "2020-04-13T12:33:48Z", "type": "commit"}, {"oid": "93d34a4fc9560f201222a07ae30951fd27713f4f", "url": "https://github.com/seata/seata/commit/93d34a4fc9560f201222a07ae30951fd27713f4f", "message": "remove link processMessage", "committedDate": "2020-04-13T12:45:49Z", "type": "commit"}, {"oid": "93d34a4fc9560f201222a07ae30951fd27713f4f", "url": "https://github.com/seata/seata/commit/93d34a4fc9560f201222a07ae30951fd27713f4f", "message": "remove link processMessage", "committedDate": "2020-04-13T12:45:49Z", "type": "forcePushed"}, {"oid": "28f05a1806d880b2832afe6197781c3d76f0e0d2", "url": "https://github.com/seata/seata/commit/28f05a1806d880b2832afe6197781c3d76f0e0d2", "message": "comment", "committedDate": "2020-04-13T13:05:55Z", "type": "commit"}, {"oid": "254d93602a8865bf9e571d39ce9da30bc8b56d08", "url": "https://github.com/seata/seata/commit/254d93602a8865bf9e571d39ce9da30bc8b56d08", "message": "remove mergeLock to client remoting", "committedDate": "2020-04-13T13:11:08Z", "type": "commit"}, {"oid": "272675a17a9391b1a2a0403ac1ec6dcfee25f1f4", "url": "https://github.com/seata/seata/commit/272675a17a9391b1a2a0403ac1ec6dcfee25f1f4", "message": "Change client registration processor location.", "committedDate": "2020-04-14T01:43:26Z", "type": "commit"}, {"oid": "1e055c373d5c4f80c67b4714ca52866cf8c9e232", "url": "https://github.com/seata/seata/commit/1e055c373d5c4f80c67b4714ca52866cf8c9e232", "message": "remove client useless request method.", "committedDate": "2020-04-14T01:49:40Z", "type": "commit"}, {"oid": "2cd569b9bded9dcf1905d4756cd578becaab36e3", "url": "https://github.com/seata/seata/commit/2cd569b9bded9dcf1905d4756cd578becaab36e3", "message": "comment.", "committedDate": "2020-04-14T01:54:30Z", "type": "commit"}, {"oid": "e5885a09053e495d0b25d29fbf21f6be78967aa2", "url": "https://github.com/seata/seata/commit/e5885a09053e495d0b25d29fbf21f6be78967aa2", "message": "remove AbstractNettyRemotingServer;rename netty client", "committedDate": "2020-04-14T02:52:31Z", "type": "commit"}, {"oid": "da723ee76c224439bd685981b1cb4e486df9f65a", "url": "https://github.com/seata/seata/commit/da723ee76c224439bd685981b1cb4e486df9f65a", "message": "registerProcessor alone method.", "committedDate": "2020-04-14T03:56:17Z", "type": "commit"}, {"oid": "499a83bae515f290e89532294710f932f50a4b34", "url": "https://github.com/seata/seata/commit/499a83bae515f290e89532294710f932f50a4b34", "message": "add RemotingClient.sendSyncRequest(Object) method comment.", "committedDate": "2020-04-14T15:29:06Z", "type": "commit"}, {"oid": "4e2c523387d74ecfc1d27b76d2b70393662fe294", "url": "https://github.com/seata/seata/commit/4e2c523387d74ecfc1d27b76d2b70393662fe294", "message": "Merge branch 'develop' into refactoring-rpc-phase4\n\n# Conflicts:\n#\tcore/src/main/java/io/seata/core/rpc/netty/RpcServer.java\n#\tserver/src/main/java/io/seata/server/coordinator/DefaultCore.java", "committedDate": "2020-04-14T15:31:03Z", "type": "commit"}, {"oid": "50532e258b44d6891a0b5608206ab9840727953d", "url": "https://github.com/seata/seata/commit/50532e258b44d6891a0b5608206ab9840727953d", "message": "remove RpcServer.java", "committedDate": "2020-04-14T15:35:06Z", "type": "commit"}, {"oid": "93a076b01b8c2d9da959563a8645b7a0271bbd0a", "url": "https://github.com/seata/seata/commit/93a076b01b8c2d9da959563a8645b7a0271bbd0a", "message": "DefaultCore import Logger", "committedDate": "2020-04-14T15:38:11Z", "type": "commit"}, {"oid": "5ef34fdd5977d1c11df36821aed18b954eabd72f", "url": "https://github.com/seata/seata/commit/5ef34fdd5977d1c11df36821aed18b954eabd72f", "message": "fix processMessage log level.", "committedDate": "2020-04-15T01:24:04Z", "type": "commit"}, {"oid": "7dd02fe4be9ad29955451c510da15a1a6122ff01", "url": "https://github.com/seata/seata/commit/7dd02fe4be9ad29955451c510da15a1a6122ff01", "message": "Merge branch 'develop' into refactoring-rpc-phase4\n\n# Conflicts:\n#\tserver/src/main/java/io/seata/server/coordinator/DefaultCore.java", "committedDate": "2020-04-22T05:08:22Z", "type": "commit"}, {"oid": "93d744ca625bc9f20775771c17deb648cb79614c", "url": "https://github.com/seata/seata/commit/93d744ca625bc9f20775771c17deb648cb79614c", "message": "1.3.0", "committedDate": "2020-04-22T05:11:20Z", "type": "commit"}, {"oid": "bd067e3162308192ef18f6a5d5d3d95012d24eba", "url": "https://github.com/seata/seata/commit/bd067e3162308192ef18f6a5d5d3d95012d24eba", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-04-29T03:10:49Z", "type": "commit"}, {"oid": "49ceb6ee2ed20a98365e6d7e57274728c29a2e40", "url": "https://github.com/seata/seata/commit/49ceb6ee2ed20a98365e6d7e57274728c29a2e40", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-05-02T11:18:58Z", "type": "commit"}, {"oid": "750519c4fea1a7d34591afce0ed18dba99e50300", "url": "https://github.com/seata/seata/commit/750519c4fea1a7d34591afce0ed18dba99e50300", "message": "Merge branch 'develop' into refactoring-rpc-phase4\n\n# Conflicts:\n#\tcore/src/main/java/io/seata/core/rpc/ClientMessageSender.java\n#\tcore/src/main/java/io/seata/core/rpc/ClientType.java\n#\tcore/src/main/java/io/seata/core/rpc/DefaultServerMessageListenerImpl.java\n#\tcore/src/main/java/io/seata/core/rpc/RemotingClient.java\n#\tcore/src/main/java/io/seata/core/rpc/RemotingServer.java\n#\tcore/src/main/java/io/seata/core/rpc/ServerMessageListener.java\n#\tcore/src/main/java/io/seata/core/rpc/ServerMessageSender.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/AbstractNettyRemotingClient.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/AbstractRpcRemoting.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/ChannelAuthHealthChecker.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/ChannelEventListener.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/NettyClientBootstrap.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/NettyRemotingServer.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/NettyServerBootstrap.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/RegisterMsgListener.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/RmNettyRemotingClient.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/RpcEventLoopGroup.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/RpcServer.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/TmNettyRemotingClient.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/Pair.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/client/ClientOnResponseProcessor.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/client/RmBranchCommitProcessor.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/client/RmBranchRollbackProcessor.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/client/RmUndoLogProcessor.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/server/RegRmProcessor.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/server/RegTmProcessor.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/server/ServerHeartbeatProcessor.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/server/ServerOnRequestProcessor.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/server/ServerOnResponseProcessor.java\n#\trm/src/main/java/io/seata/rm/RMClient.java\n#\tserver/src/main/java/io/seata/server/coordinator/DefaultCoordinator.java\n#\tserver/src/main/java/io/seata/server/coordinator/DefaultCore.java\n#\tserver/src/main/java/io/seata/server/transaction/saga/SagaCore.java\n#\tserver/src/test/java/ServerTest.java\n#\tserver/src/test/java/io/seata/server/coordinator/DefaultCoordinatorTest.java\n#\ttest/src/test/java/io/seata/core/rpc/netty/TmNettyClientTest.java\n#\ttest/src/test/java/io/seata/saga/engine/db/AbstractServerTest.java", "committedDate": "2020-06-16T13:49:22Z", "type": "commit"}, {"oid": "568fd201824887d74b538b8fe285af6b681dbf0d", "url": "https://github.com/seata/seata/commit/568fd201824887d74b538b8fe285af6b681dbf0d", "message": "merge phase3", "committedDate": "2020-06-16T14:09:28Z", "type": "commit"}, {"oid": "822ff61c11bd65f6242f18a38468722c2e6e8269", "url": "https://github.com/seata/seata/commit/822ff61c11bd65f6242f18a38468722c2e6e8269", "message": "merge phase3", "committedDate": "2020-06-16T14:50:59Z", "type": "commit"}, {"oid": "8c5d1badbf3476c9f32363636a9bbe2218b08d08", "url": "https://github.com/seata/seata/commit/8c5d1badbf3476c9f32363636a9bbe2218b08d08", "message": "Roll back deleted classes.", "committedDate": "2020-06-20T14:08:37Z", "type": "commit"}, {"oid": "02c33d39393d0afc4e5bce3cad122871090970ad", "url": "https://github.com/seata/seata/commit/02c33d39393d0afc4e5bce3cad122871090970ad", "message": "remove useless class", "committedDate": "2020-06-20T14:31:20Z", "type": "commit"}, {"oid": "958fd42d18db481aa915b32a558f90eed036e708", "url": "https://github.com/seata/seata/commit/958fd42d18db481aa915b32a558f90eed036e708", "message": "Merge branch 'develop' into refactoring-rpc-phase4\n\n# Conflicts:\n#\tcore/src/main/java/io/seata/core/rpc/netty/NettyClientBootstrap.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/NettyRemotingServer.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/RmNettyRemotingClient.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/RpcServer.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/TmNettyRemotingClient.java\n#\tserver/src/main/java/io/seata/server/Server.java", "committedDate": "2020-06-30T01:25:57Z", "type": "commit"}, {"oid": "45d132a8083f6f0ed18917417bcd5763fd868e08", "url": "https://github.com/seata/seata/commit/45d132a8083f6f0ed18917417bcd5763fd868e08", "message": "Resolve conflicts", "committedDate": "2020-06-30T01:32:34Z", "type": "commit"}, {"oid": "765a8eac6b40f2d8853a10e21d08bc30b079531b", "url": "https://github.com/seata/seata/commit/765a8eac6b40f2d8853a10e21d08bc30b079531b", "message": "Resolve conflicts", "committedDate": "2020-06-30T02:18:23Z", "type": "commit"}, {"oid": "1f941fa177a71f62d38a80bbbc88c971cbc1c420", "url": "https://github.com/seata/seata/commit/1f941fa177a71f62d38a80bbbc88c971cbc1c420", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-06-30T03:21:07Z", "type": "commit"}, {"oid": "eb07ef9b83f2553a463fab7a5e0c1fcd0bf9e57c", "url": "https://github.com/seata/seata/commit/eb07ef9b83f2553a463fab7a5e0c1fcd0bf9e57c", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-06-30T08:25:56Z", "type": "commit"}, {"oid": "361af26f72f18fa7dffed536b1393c01ed46f5ef", "url": "https://github.com/seata/seata/commit/361af26f72f18fa7dffed536b1393c01ed46f5ef", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-06-30T10:48:32Z", "type": "commit"}, {"oid": "e2fbf216cbbae2da14fab39e4b3444e04f45a296", "url": "https://github.com/seata/seata/commit/e2fbf216cbbae2da14fab39e4b3444e04f45a296", "message": "Merge branch 'develop' into refactoring-rpc-phase4", "committedDate": "2020-07-01T14:36:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQzNzIzNQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r448437235", "bodyText": "Why change handle something to do something? I think this method just handle it, not do it.", "author": "l81893521", "createdAt": "2020-07-01T15:18:32Z", "path": "core/src/main/java/io/seata/core/rpc/processor/client/RmUndoLogProcessor.java", "diffHunk": "@@ -48,10 +48,10 @@ public void process(ChannelHandlerContext ctx, RpcMessage rpcMessage) throws Exc\n         if (LOGGER.isInfoEnabled()) {\n             LOGGER.info(\"rm handle undo log process:\" + msg);\n         }\n-        handleUndoLogDelete((UndoLogDeleteRequest) msg);\n+        doUndoLogDelete((UndoLogDeleteRequest) msg);\n     }\n \n-    private void handleUndoLogDelete(UndoLogDeleteRequest undoLogDeleteRequest) {\n+    private void doUndoLogDelete(UndoLogDeleteRequest undoLogDeleteRequest) {", "originalCommit": "e2fbf216cbbae2da14fab39e4b3444e04f45a296", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODcxNzA2MQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r448717061", "bodyText": "Because \"do\" will be better, the meaning of \"handle\" and \"process\" is a bit repeated.", "author": "objcoding", "createdAt": "2020-07-02T02:42:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQzNzIzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODcyMjk5Ng==", "url": "https://github.com/seata/seata/pull/2540#discussion_r448722996", "bodyText": "But the method start of \"do\", usually means doing real business logic.", "author": "l81893521", "createdAt": "2020-07-02T03:07:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQzNzIzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY0Mzc5Mg==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452643792", "bodyText": "done.", "author": "objcoding", "createdAt": "2020-07-10T06:20:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQzNzIzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ0MDkxMQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r448440911", "bodyText": "Please reset this class.", "author": "l81893521", "createdAt": "2020-07-01T15:24:16Z", "path": "server/src/main/java/io/seata/server/coordinator/DefaultCore.java", "diffHunk": "@@ -38,6 +31,12 @@\n import io.seata.server.session.GlobalSession;\n import io.seata.server.session.SessionHelper;\n import io.seata.server.session.SessionHolder;\n+import org.slf4j.Logger;", "originalCommit": "e2fbf216cbbae2da14fab39e4b3444e04f45a296", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODcxODE2OQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r448718169", "bodyText": "Logger is useful in this class, cannot be removed.", "author": "objcoding", "createdAt": "2020-07-02T02:46:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ0MDkxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODcyMjg1Mg==", "url": "https://github.com/seata/seata/pull/2540#discussion_r448722852", "bodyText": "I mean, this class do not change any thing but the format. reset it can make the pr review easier.", "author": "l81893521", "createdAt": "2020-07-02T03:06:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ0MDkxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU3MDQ0Mw==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452570443", "bodyText": "Done.", "author": "objcoding", "createdAt": "2020-07-10T01:10:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ0MDkxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ0MjAwNA==", "url": "https://github.com/seata/seata/pull/2540#discussion_r448442004", "bodyText": "Please reset here.", "author": "l81893521", "createdAt": "2020-07-01T15:25:50Z", "path": "server/src/main/java/io/seata/server/store/DbcpDataSourceProvider.java", "diffHunk": "@@ -39,6 +39,7 @@ public DataSource generate() {\n         ds.setDriverClassLoader(getDriverClassLoader());\n         ds.setUrl(getUrl());\n         ds.setUsername(getUser());\n+", "originalCommit": "e2fbf216cbbae2da14fab39e4b3444e04f45a296", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODcxNzg3NQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r448717875", "bodyText": "Done.", "author": "objcoding", "createdAt": "2020-07-02T02:45:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ0MjAwNA=="}], "type": "inlineReview"}, {"oid": "b6ce79864ca15d7c7e24769baf2a7a23e05ea8dd", "url": "https://github.com/seata/seata/commit/b6ce79864ca15d7c7e24769baf2a7a23e05ea8dd", "message": "Merge branch 'develop' into refactoring-rpc-phase4\n\n# Conflicts:\n#\tcore/src/main/java/io/seata/core/rpc/DefaultServerMessageListenerImpl.java\n#\tcore/src/main/java/io/seata/core/rpc/netty/NettyPoolableFactory.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/server/RegRmProcessor.java\n#\tcore/src/main/java/io/seata/core/rpc/processor/server/RegTmProcessor.java", "committedDate": "2020-07-05T08:44:04Z", "type": "commit"}, {"oid": "27b51c11314c1db609327f4b61fffe9057189388", "url": "https://github.com/seata/seata/commit/27b51c11314c1db609327f4b61fffe9057189388", "message": "Resolve conflicts", "committedDate": "2020-07-05T09:01:48Z", "type": "commit"}, {"oid": "6e1ab479c801cf8d28f915da0d3823d4343f6cae", "url": "https://github.com/seata/seata/commit/6e1ab479c801cf8d28f915da0d3823d4343f6cae", "message": "Resolve conflicts", "committedDate": "2020-07-06T01:22:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDczMTcwMw==", "url": "https://github.com/seata/seata/pull/2540#discussion_r450731703", "bodyText": "branch register was async request.", "author": "l81893521", "createdAt": "2020-07-07T09:28:55Z", "path": "rm/src/main/java/io/seata/rm/AbstractResourceManager.java", "diffHunk": "@@ -64,7 +64,7 @@ public Long branchRegister(BranchType branchType, String resourceId, String clie\n             request.setBranchType(branchType);\n             request.setApplicationData(applicationData);\n \n-            BranchRegisterResponse response = (BranchRegisterResponse) RmRpcClient.getInstance().sendMsgWithResponse(request);\n+            BranchRegisterResponse response = (BranchRegisterResponse) RmNettyRemotingClient.getInstance().sendSyncRequest(request);", "originalCommit": "6e1ab479c801cf8d28f915da0d3823d4343f6cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDczNjYzNA==", "url": "https://github.com/seata/seata/pull/2540#discussion_r450736634", "bodyText": "My fault.", "author": "l81893521", "createdAt": "2020-07-07T09:37:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDczMTcwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM5ODAwOA==", "url": "https://github.com/seata/seata/pull/2540#discussion_r451398008", "bodyText": "ok", "author": "objcoding", "createdAt": "2020-07-08T09:10:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDczMTcwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDczMTg0NA==", "url": "https://github.com/seata/seata/pull/2540#discussion_r450731844", "bodyText": "branch report was async request.", "author": "l81893521", "createdAt": "2020-07-07T09:29:08Z", "path": "rm/src/main/java/io/seata/rm/AbstractResourceManager.java", "diffHunk": "@@ -94,7 +95,7 @@ public void branchReport(BranchType branchType, String xid, long branchId, Branc\n             request.setStatus(status);\n             request.setApplicationData(applicationData);\n \n-            BranchReportResponse response = (BranchReportResponse) RmRpcClient.getInstance().sendMsgWithResponse(request);\n+            BranchReportResponse response = (BranchReportResponse) RmNettyRemotingClient.getInstance().sendSyncRequest(request);", "originalCommit": "6e1ab479c801cf8d28f915da0d3823d4343f6cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDczNjU2Ng==", "url": "https://github.com/seata/seata/pull/2540#discussion_r450736566", "bodyText": "My fault.", "author": "l81893521", "createdAt": "2020-07-07T09:37:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDczMTg0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM5ODIyNA==", "url": "https://github.com/seata/seata/pull/2540#discussion_r451398224", "bodyText": "ok", "author": "objcoding", "createdAt": "2020-07-08T09:10:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDczMTg0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI2NjU4Mw==", "url": "https://github.com/seata/seata/pull/2540#discussion_r451266583", "bodyText": "Why remove here?", "author": "l81893521", "createdAt": "2020-07-08T03:49:36Z", "path": "rm/src/main/java/io/seata/rm/AbstractRMHandler.java", "diffHunk": "@@ -153,7 +152,7 @@ public AbstractResultMessage onRequest(AbstractMessage request, RpcContext conte\n \n     @Override\n     public void onResponse(AbstractResultMessage response, RpcContext context) {\n-        throw new ShouldNeverHappenException();\n+", "originalCommit": "6e1ab479c801cf8d28f915da0d3823d4343f6cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU3MjM0MQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452572341", "bodyText": "It may have been removed by hand, I will roll back.", "author": "objcoding", "createdAt": "2020-07-10T01:18:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI2NjU4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUxMjMyNQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r451512325", "bodyText": "response   has  msg field.", "author": "slievrly", "createdAt": "2020-07-08T12:39:18Z", "path": "core/src/main/java/io/seata/core/rpc/DefaultServerMessageListenerImpl.java", "diffHunk": "@@ -161,7 +161,7 @@ public void onRegTmMessage(RpcMessage request, ChannelHandlerContext ctx, Regist\n         if (StringUtils.isNotEmpty(errorInfo)) {\n             response.setMsg(errorInfo);\n         }\n-        getServerMessageSender().sendResponse(request, ctx.channel(), response);\n+        getServerMessageSender().sendAsyncResponse(request, ctx.channel(), new RegisterTMResponse(isSuccess));", "originalCommit": "6e1ab479c801cf8d28f915da0d3823d4343f6cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU3Mjg4Mw==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452572883", "bodyText": "done.", "author": "objcoding", "createdAt": "2020-07-10T01:20:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUxMjMyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUxMjQ2OQ==", "url": "https://github.com/seata/seata/pull/2540#discussion_r451512469", "bodyText": "response   has  msg field.", "author": "slievrly", "createdAt": "2020-07-08T12:39:31Z", "path": "core/src/main/java/io/seata/core/rpc/DefaultServerMessageListenerImpl.java", "diffHunk": "@@ -129,7 +129,7 @@ public void onRegRmMessage(RpcMessage request, ChannelHandlerContext ctx, Regist\n         if (StringUtils.isNotEmpty(errorInfo)) {\n             response.setMsg(errorInfo);\n         }\n-        getServerMessageSender().sendResponse(request, ctx.channel(), response);\n+        getServerMessageSender().sendAsyncResponse(request, ctx.channel(), new RegisterRMResponse(isSuccess));", "originalCommit": "6e1ab479c801cf8d28f915da0d3823d4343f6cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU3MjkwMg==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452572902", "bodyText": "done.", "author": "objcoding", "createdAt": "2020-07-10T01:21:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUxMjQ2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUxOTMyMA==", "url": "https://github.com/seata/seata/pull/2540#discussion_r451519320", "bodyText": "should there be a channel parameter?", "author": "slievrly", "createdAt": "2020-07-08T12:51:00Z", "path": "core/src/main/java/io/seata/core/rpc/RemotingClient.java", "diffHunk": "@@ -33,43 +34,42 @@\n public interface RemotingClient {\n \n     /**\n-     * Send msg with response object.\n+     * client send sync request.\n+     * In this request, if {@link NettyClientConfig#isEnableClientBatchSendRequest} is enabled,\n+     * the message will be sent in batches.\n      *\n-     * @param msg     the msg\n-     * @param timeout the timeout\n-     * @return the object\n-     * @throws TimeoutException the timeout exception\n+     * @param msg transaction message {@link io.seata.core.protocol}\n+     * @return server result message\n+     * @throws TimeoutException\n      */\n-    Object sendMsgWithResponse(Object msg, long timeout) throws TimeoutException;\n+    Object sendSyncRequest(Object msg) throws TimeoutException;\n \n     /**\n-     * Send msg with response object.\n+     * client send sync request.\n      *\n-     * @param serverAddress the server address\n-     * @param msg           the msg\n-     * @param timeout       the timeout\n-     * @return the object\n-     * @throws TimeoutException the timeout exception\n+     * @param channel client channel\n+     * @param msg     transaction message {@link io.seata.core.protocol}\n+     * @return server result message\n+     * @throws TimeoutException\n      */\n-    Object sendMsgWithResponse(String serverAddress, Object msg, long timeout) throws TimeoutException;\n+    Object sendSyncRequest(Channel channel, Object msg) throws TimeoutException;", "originalCommit": "6e1ab479c801cf8d28f915da0d3823d4343f6cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjI1NTgzNA==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452255834", "bodyText": "At that time, why the channel invaded the RemotingClient interface was also a helpless choice, because when called in many places, the various parameters were not uniform, it was difficult to remove the dependency of the channel. At that time, my idea was,\n\nRemotingClient as a top-level interface, when other rpc types are added in the future, their interfaces can be added to this top-level interface\nRemove the netty-related dependencies and make a RemotingClient that is truly irrelevant to the specific rpc type\nIn the end I chose the first and easiest method to refactor.\n\nI would like to add a pr later to improve it.", "author": "objcoding", "createdAt": "2020-07-09T14:23:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUxOTMyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUyMTA4Nw==", "url": "https://github.com/seata/seata/pull/2540#discussion_r451521087", "bodyText": "NettyClientBootstrap", "author": "slievrly", "createdAt": "2020-07-08T12:53:41Z", "path": "core/src/main/java/io/seata/core/rpc/netty/NettyClientBootstrap.java", "diffHunk": "@@ -49,9 +49,9 @@\n  * @author slievrly\n  * @author zhaojun\n  */\n-public class RpcClientBootstrap implements RemotingBootstrap {\n+public class NettyClientBootstrap implements RemotingBootstrap {\n \n-    private static final Logger LOGGER = LoggerFactory.getLogger(AbstractRpcRemotingClient.class);\n+    private static final Logger LOGGER = LoggerFactory.getLogger(AbstractNettyRemotingClient.class);", "originalCommit": "6e1ab479c801cf8d28f915da0d3823d4343f6cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjI0NjAyMg==", "url": "https://github.com/seata/seata/pull/2540#discussion_r452246022", "bodyText": "done.", "author": "objcoding", "createdAt": "2020-07-09T14:09:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUyMTA4Nw=="}], "type": "inlineReview"}]}