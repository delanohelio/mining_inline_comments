{"pr_number": 2208, "pr_title": "refactor: Replace getDbType with LoadLevel name", "pr_createdAt": "2020-01-19T12:52:55Z", "pr_url": "https://github.com/seata/seata/pull/2208", "timeline": [{"oid": "c3d14325a9034b8dc1995a0e0618cce7f85d2ca6", "url": "https://github.com/seata/seata/commit/c3d14325a9034b8dc1995a0e0618cce7f85d2ca6", "message": "refactor: Replace TableMetaCache and UndoLogManager and UndoExecutorHolder and KeywordChecker and SQLOperateRecognizerHolder with LoadLevel", "committedDate": "2020-01-19T12:51:39Z", "type": "commit"}, {"oid": "5f8912ae68d8a2da7f23a48c80bc92f7efe76b72", "url": "https://github.com/seata/seata/commit/5f8912ae68d8a2da7f23a48c80bc92f7efe76b72", "message": "refactor: Replace TableMetaCache and UndoLogManager and UndoExecutorHolder and KeywordChecker and SQLOperateRecognizerHolder with LoadLevel", "committedDate": "2020-01-19T13:05:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM4MDk2OA==", "url": "https://github.com/seata/seata/pull/2208#discussion_r368380968", "bodyText": "dbType.toLowerCase()?", "author": "slievrly", "createdAt": "2020-01-20T06:05:36Z", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/sql/struct/TableMetaCacheFactory.java", "diffHunk": "@@ -35,22 +34,11 @@\n      * @return table meta cache\n      */\n     public static TableMetaCache getTableMetaCache(String dbType) {\n-        dbType = dbType.toLowerCase();\n-        if (tableMetaCacheMap == null) {\n-            synchronized (TableMetaCacheFactory.class) {\n-                if (tableMetaCacheMap == null) {\n-                    Map<String, TableMetaCache> initializedMap = new HashMap<>();\n-                    List<TableMetaCache> cacheList = EnhancedServiceLoader.loadAll(TableMetaCache.class);\n-                    for (TableMetaCache cache : cacheList) {\n-                        initializedMap.put(cache.getDbType().toLowerCase(), cache);\n-                    }\n-                    tableMetaCacheMap = initializedMap;\n-                }\n-            }\n-        }\n-        if (tableMetaCacheMap.containsKey(dbType)) {\n-            return tableMetaCacheMap.get(dbType);\n+        if (TABLE_META_CACHE_MAP.get(dbType) != null) {", "originalCommit": "5f8912ae68d8a2da7f23a48c80bc92f7efe76b72", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "485d29a677561988a95da7cf9271004bcd67812c", "url": "https://github.com/seata/seata/commit/485d29a677561988a95da7cf9271004bcd67812c", "message": "Merge branch 'develop' into refactorSPIwithLoadLevel", "committedDate": "2020-01-22T04:28:54Z", "type": "commit"}, {"oid": "304bb79412a9abcf04f5faa56430e75adf996ed9", "url": "https://github.com/seata/seata/commit/304bb79412a9abcf04f5faa56430e75adf996ed9", "message": "Merge branch 'develop' into refactorSPIwithLoadLevel", "committedDate": "2020-01-22T14:55:40Z", "type": "commit"}, {"oid": "b0b6a5b89affed4685fa627879206dad27512961", "url": "https://github.com/seata/seata/commit/b0b6a5b89affed4685fa627879206dad27512961", "message": "Merge branch 'develop' into refactorSPIwithLoadLevel", "committedDate": "2020-01-23T02:55:07Z", "type": "commit"}, {"oid": "d9df3e6588d3eeb4b83758b3e695833218d6abc3", "url": "https://github.com/seata/seata/commit/d9df3e6588d3eeb4b83758b3e695833218d6abc3", "message": "Merge branch 'develop' into refactorSPIwithLoadLevel", "committedDate": "2020-01-23T08:28:08Z", "type": "commit"}]}