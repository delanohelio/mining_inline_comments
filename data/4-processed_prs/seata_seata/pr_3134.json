{"pr_number": 3134, "pr_title": "optimize: opt codes related to `Map` and `List`", "pr_createdAt": "2020-09-21T07:01:29Z", "pr_url": "https://github.com/seata/seata/pull/3134", "timeline": [{"oid": "53d15896851405f3ce055c7e573cae28a012e307", "url": "https://github.com/seata/seata/commit/53d15896851405f3ce055c7e573cae28a012e307", "message": "optimize: opt map related codes", "committedDate": "2020-09-21T05:07:19Z", "type": "commit"}, {"oid": "5fa4b20627ae99600326fbc7499eca8dadf8ea36", "url": "https://github.com/seata/seata/commit/5fa4b20627ae99600326fbc7499eca8dadf8ea36", "message": "optimize: opt map related codes", "committedDate": "2020-09-21T06:59:34Z", "type": "commit"}, {"oid": "658032e3eea9f39df9291c8766a368fbee595532", "url": "https://github.com/seata/seata/commit/658032e3eea9f39df9291c8766a368fbee595532", "message": "fix style", "committedDate": "2020-09-21T07:10:15Z", "type": "commit"}, {"oid": "0864ef1edbe8637d59bd65291aaf3307eafb7168", "url": "https://github.com/seata/seata/commit/0864ef1edbe8637d59bd65291aaf3307eafb7168", "message": "fix style", "committedDate": "2020-09-21T07:14:48Z", "type": "commit"}, {"oid": "5d102cc6900cc9be5eb6ef8c8c1d1bf0caa645d0", "url": "https://github.com/seata/seata/commit/5d102cc6900cc9be5eb6ef8c8c1d1bf0caa645d0", "message": "optimize code", "committedDate": "2020-09-21T08:23:53Z", "type": "commit"}, {"oid": "8aeda9829206de5a2576517f8d3991b3a90ace6e", "url": "https://github.com/seata/seata/commit/8aeda9829206de5a2576517f8d3991b3a90ace6e", "message": "optimize code", "committedDate": "2020-09-21T08:25:02Z", "type": "commit"}, {"oid": "1017722042941c7519dd4de58e7c621fac1d2937", "url": "https://github.com/seata/seata/commit/1017722042941c7519dd4de58e7c621fac1d2937", "message": "optimize code", "committedDate": "2020-09-21T11:00:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA2MzU2Mw==", "url": "https://github.com/seata/seata/pull/3134#discussion_r492063563", "bodyText": "\u8fd9\u91cc\u539f\u6765configListeners\u662f\u7a7amap\u7684\u65f6\u5019\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684set\uff0c\u73b0\u5728\u8fd4\u56de\u7684\u662fnull\uff0c\u4f1a\u4e0d\u4f1a\u6709\u5f71\u54cd\uff1f", "author": "caohdgege", "createdAt": "2020-09-21T13:54:31Z", "path": "config/seata-config-nacos/src/main/java/io/seata/config/nacos/NacosConfiguration.java", "diffHunk": "@@ -172,8 +174,9 @@ public void removeConfigListener(String dataId, ConfigurationChangeListener list\n \n     @Override\n     public Set<ConfigurationChangeListener> getConfigListeners(String dataId) {\n-        if (configListenersMap.containsKey(dataId)) {\n-            return configListenersMap.get(dataId).keySet();\n+        Map<ConfigurationChangeListener, NacosListener> configListeners = configListenersMap.get(dataId);\n+        if (configListeners != null && !configListeners.isEmpty()) {\n+            return configListeners.keySet();", "originalCommit": "1017722042941c7519dd4de58e7c621fac1d2937", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQzODEyNA==", "url": "https://github.com/seata/seata/pull/3134#discussion_r492438124", "bodyText": "\u4e0d\u4f1a\u6709\u5f71\u54cd\uff0c\u6709\u5224\u65ad\u8fc7\u7a7a\u503c\u7684\uff0c\u53d6\u51fa\u6765\u4e3b\u8981\u5c31\u662f\u7528\u4e8e\u5faa\u73af\u7684\u3002", "author": "wangliang181230", "createdAt": "2020-09-22T01:59:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA2MzU2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA2ODcyNA==", "url": "https://github.com/seata/seata/pull/3134#discussion_r492068724", "bodyText": "\u540c\u4e0a", "author": "caohdgege", "createdAt": "2020-09-21T14:01:25Z", "path": "config/seata-config-zk/src/main/java/io/seata/config/zk/ZookeeperConfiguration.java", "diffHunk": "@@ -210,8 +212,9 @@ public void removeConfigListener(String dataId, ConfigurationChangeListener list\n \n     @Override\n     public Set<ConfigurationChangeListener> getConfigListeners(String dataId) {\n-        if (configListenersMap.containsKey(dataId)) {\n-            return configListenersMap.get(dataId).keySet();\n+        ConcurrentMap<ConfigurationChangeListener, ZKListener> configListeners = configListenersMap.get(dataId);\n+        if (configListeners != null && !configListeners.isEmpty()) {\n+            return configListeners.keySet();", "originalCommit": "1017722042941c7519dd4de58e7c621fac1d2937", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dd2e61467bde9612bbad76355b9156d8505fc294", "url": "https://github.com/seata/seata/commit/dd2e61467bde9612bbad76355b9156d8505fc294", "message": "optimize code", "committedDate": "2020-09-22T02:28:56Z", "type": "commit"}, {"oid": "5b8b41aae075bbe139392bc765be3ecb82e53b4e", "url": "https://github.com/seata/seata/commit/5b8b41aae075bbe139392bc765be3ecb82e53b4e", "message": "add CollectionUtils.getLastItem(List list) method and unit test", "committedDate": "2020-09-22T02:52:31Z", "type": "commit"}, {"oid": "a00e4fdc8f0b7c6be801743d7f757f4a38ca533a", "url": "https://github.com/seata/seata/commit/a00e4fdc8f0b7c6be801743d7f757f4a38ca533a", "message": "optimize codes related to the `List`", "committedDate": "2020-09-22T03:23:17Z", "type": "commit"}, {"oid": "b266e0200cccd96a805f8844dce1967da464cd41", "url": "https://github.com/seata/seata/commit/b266e0200cccd96a805f8844dce1967da464cd41", "message": "Merge branch 'develop' into optimize-map-code", "committedDate": "2020-09-23T06:45:40Z", "type": "commit"}, {"oid": "cd652bec69d1a2ce59398ea1f868dc1abc7a25b4", "url": "https://github.com/seata/seata/commit/cd652bec69d1a2ce59398ea1f868dc1abc7a25b4", "message": "Merge branch 'develop' into optimize-map-code", "committedDate": "2020-09-23T09:26:18Z", "type": "commit"}, {"oid": "54817fffa072379ffd52b4dcdc7669fc53800dec", "url": "https://github.com/seata/seata/commit/54817fffa072379ffd52b4dcdc7669fc53800dec", "message": "Merge branch 'develop' into optimize-map-code", "committedDate": "2020-09-23T13:46:28Z", "type": "commit"}, {"oid": "193e5dd611d06d798ff29fcc9481ebbaacb74996", "url": "https://github.com/seata/seata/commit/193e5dd611d06d798ff29fcc9481ebbaacb74996", "message": "optimize code", "committedDate": "2020-09-24T02:37:11Z", "type": "commit"}, {"oid": "d27bf3faa742aaf9b5657f68be36181dd29ef228", "url": "https://github.com/seata/seata/commit/d27bf3faa742aaf9b5657f68be36181dd29ef228", "message": "fix style", "committedDate": "2020-09-24T02:49:38Z", "type": "commit"}, {"oid": "c6b1d0794575fe008121055bdafb6749fb441965", "url": "https://github.com/seata/seata/commit/c6b1d0794575fe008121055bdafb6749fb441965", "message": "add CollectionUtils.computeIfAbsent method", "committedDate": "2020-09-24T07:05:27Z", "type": "commit"}, {"oid": "0dda49990e529be09a7aa783a15f4e1e61076f60", "url": "https://github.com/seata/seata/commit/0dda49990e529be09a7aa783a15f4e1e61076f60", "message": "optimize code: foreach Map", "committedDate": "2020-09-24T09:27:29Z", "type": "commit"}, {"oid": "cb882ae2544934a8e120bb10f993c700d59573a0", "url": "https://github.com/seata/seata/commit/cb882ae2544934a8e120bb10f993c700d59573a0", "message": "optimize code", "committedDate": "2020-09-24T09:33:31Z", "type": "commit"}, {"oid": "6f817f7cd72f7a34f5c5344c392e5b5cba05cebc", "url": "https://github.com/seata/seata/commit/6f817f7cd72f7a34f5c5344c392e5b5cba05cebc", "message": "optimize code", "committedDate": "2020-09-24T09:50:23Z", "type": "commit"}, {"oid": "4934d6abe60a30cc10b3f500f883337e931e88e6", "url": "https://github.com/seata/seata/commit/4934d6abe60a30cc10b3f500f883337e931e88e6", "message": "optimize notes", "committedDate": "2020-09-24T09:55:50Z", "type": "commit"}, {"oid": "f4098b72e66d2d9660580538eb5161df3b7a09fa", "url": "https://github.com/seata/seata/commit/f4098b72e66d2d9660580538eb5161df3b7a09fa", "message": "optimize getLast method", "committedDate": "2020-09-24T10:09:47Z", "type": "commit"}, {"oid": "bcd8879e11a73b5e82e94cb9d71f6eb1a0028def", "url": "https://github.com/seata/seata/commit/bcd8879e11a73b5e82e94cb9d71f6eb1a0028def", "message": "optimize notes", "committedDate": "2020-09-24T10:19:29Z", "type": "commit"}, {"oid": "a2376c103b53597617afff0f3a36d1154a71b67c", "url": "https://github.com/seata/seata/commit/a2376c103b53597617afff0f3a36d1154a71b67c", "message": "optimize notes", "committedDate": "2020-09-24T10:20:13Z", "type": "commit"}, {"oid": "9807cc71390d5b8872bb91eaa2e5c3a2c858b705", "url": "https://github.com/seata/seata/commit/9807cc71390d5b8872bb91eaa2e5c3a2c858b705", "message": "Merge remote-tracking branch 'remotes/upstream/develop' into optimize-map-code", "committedDate": "2020-09-25T05:37:08Z", "type": "commit"}, {"oid": "dc73ccef529a32754189d930140ec40947d20428", "url": "https://github.com/seata/seata/commit/dc73ccef529a32754189d930140ec40947d20428", "message": "optimize code", "committedDate": "2020-09-25T08:06:20Z", "type": "commit"}, {"oid": "83ae2ed2d343e5ea2f40432e9468c0720c892841", "url": "https://github.com/seata/seata/commit/83ae2ed2d343e5ea2f40432e9468c0720c892841", "message": "Merge remote-tracking branch 'remotes/upstream/develop' into optimize-map-code\n\n# Conflicts:\n#\tspring/src/main/java/io/seata/spring/annotation/datasource/DataSourceProxyHolder.java", "committedDate": "2020-10-10T04:30:34Z", "type": "commit"}, {"oid": "6a7f3960e8bf012c51108a3eb1fd6d4a78b7fd81", "url": "https://github.com/seata/seata/commit/6a7f3960e8bf012c51108a3eb1fd6d4a78b7fd81", "message": "optimize code", "committedDate": "2020-10-10T05:25:47Z", "type": "commit"}, {"oid": "809e39d8edefee966645e6a4c8ea80f836c759cd", "url": "https://github.com/seata/seata/commit/809e39d8edefee966645e6a4c8ea80f836c759cd", "message": "optimize code", "committedDate": "2020-10-10T05:38:56Z", "type": "commit"}, {"oid": "0706ce53310b2502e1703f5e6cee98ee40eea2f5", "url": "https://github.com/seata/seata/commit/0706ce53310b2502e1703f5e6cee98ee40eea2f5", "message": "fix style", "committedDate": "2020-10-10T05:50:53Z", "type": "commit"}, {"oid": "07d5be054f1a514691327e915b758112dfd6660a", "url": "https://github.com/seata/seata/commit/07d5be054f1a514691327e915b758112dfd6660a", "message": "Merge remote-tracking branch 'remotes/upstream/develop' into optimize-map-code\n\n# Conflicts:\n#\tintegration/http/src/main/java/io/seata/integration/http/AbstractHttpExecutor.java", "committedDate": "2020-10-10T06:13:00Z", "type": "commit"}, {"oid": "a2d7dae966f2f9644ca8eca690c1ac6a28b7989f", "url": "https://github.com/seata/seata/commit/a2d7dae966f2f9644ca8eca690c1ac6a28b7989f", "message": "move the method `convert` to CollectionUtils", "committedDate": "2020-10-10T06:23:20Z", "type": "commit"}, {"oid": "b4df71ae54052a0bcbf30d1e0f0b1dad6b06fe8b", "url": "https://github.com/seata/seata/commit/b4df71ae54052a0bcbf30d1e0f0b1dad6b06fe8b", "message": "rename var", "committedDate": "2020-10-10T06:25:19Z", "type": "commit"}, {"oid": "f08c5bb9245162a180217c8c83b00126bf705249", "url": "https://github.com/seata/seata/commit/f08c5bb9245162a180217c8c83b00126bf705249", "message": "Merge branch 'develop' into optimize-map-code", "committedDate": "2020-10-10T07:46:37Z", "type": "commit"}, {"oid": "bfa6ffd6050d8620e1a0be0ff587c087bf5ffca9", "url": "https://github.com/seata/seata/commit/bfa6ffd6050d8620e1a0be0ff587c087bf5ffca9", "message": "Merge branch 'develop' into optimize-map-code", "committedDate": "2020-10-10T07:51:09Z", "type": "commit"}, {"oid": "d44038656c0b26460a04ef9612a932985fee7cf5", "url": "https://github.com/seata/seata/commit/d44038656c0b26460a04ef9612a932985fee7cf5", "message": "Merge branch 'develop' into optimize-map-code", "committedDate": "2020-10-17T11:20:15Z", "type": "commit"}]}