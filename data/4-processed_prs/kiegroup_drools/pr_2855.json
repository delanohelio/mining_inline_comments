{"pr_number": 2855, "pr_title": "Drools 5241 - Create archetype for PMML models with drool implementation", "pr_createdAt": "2020-04-15T15:12:32Z", "pr_url": "https://github.com/kiegroup/drools/pull/2855", "timeline": [{"oid": "835616bde6986f7dc0e0703429d0523f1f08be6d", "url": "https://github.com/kiegroup/drools/commit/835616bde6986f7dc0e0703429d0523f1f08be6d", "message": "[DROOLS-4859] Fixing generic models archetype", "committedDate": "2020-04-15T13:46:02Z", "type": "commit"}, {"oid": "5c128e3cd0eac7ea391897c48e847b42b327d521", "url": "https://github.com/kiegroup/drools/commit/5c128e3cd0eac7ea391897c48e847b42b327d521", "message": "[DROOLS-4859] Implemented model-drools archetype", "committedDate": "2020-04-15T15:07:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk4MDQ3OA==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r408980478", "bodyText": "Can you add some more new lines? \ud83d\ude04", "author": "danielezonca", "createdAt": "2020-04-15T16:37:32Z", "path": "kie-pmml-new/kie-pmml-models-drools-archetype/Readme.md", "diffHunk": "@@ -0,0 +1,45 @@\n+Models Archetype\n+================\n+\n+Usage:\n+\n+    cd kie-pmml-models-drools\n+\n+    mvn archetype:generate -B \\ (not interactive)\n+    -DarchetypeGroupId=org.kie \\\n+    -DarchetypeArtifactId=kie-pmml-models-drools-archetype \\\n+    -DarchetypeVersion=(current_kie_version) \\\n+    -DmodelName=(model name, first letter capital) \\ e.g. Testing\n+\n+N.B.\n+\n+For model name do follow names as defined inside PMML specs, e.g RegressionModel -> Regression, TreeModel -> Tree\n+\n+    mvn archetype:generate -B -DarchetypeGroupId=org.kie -DarchetypeArtifactId=kie-pmml-models-drools-archetype -DarchetypeVersion=7.37.0-SNAPSHOT -DmodelName=NaiveBayes\n+\n+Test:\n+\n+The src/test/resources/projects contains two folder to have IT tests of the archetype itself.\n+\n+Inside such folder there is\n+1. some specifications for the project to be created (archetype.pom.properties, archetype.properties)\n+2. a \"reference\" project, to compare the generated-one with\n+\n+During \"archetype:integration-test\" goal, what happen is\n+\n+1. a project is generated based on the given specifications\n+2. the generated project is compared (file by file) with the reference one\n+3. if the comparison is successful, the generated project goes through the phase describe inside \"goal.txt\"\n+4. Being the above \"verify\", the project is compiled and tested.\n+\n+If reference and generated project differs for number or content of files, a specific error is printed out in console\n+If the generated project does not compile (due to some modification in the underlying models) a usual \"compilation error\" is printed out in console.\n+\n+See https://maven.apache.org/archetype/maven-archetype-plugin/integration-test-mojo.html for more details.\n+\n+\n+\n+\n+\n+\n+", "originalCommit": "5c128e3cd0eac7ea391897c48e847b42b327d521", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM0NTk1Mg==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409345952", "bodyText": "@danielezonca\nDone", "author": "gitgabrio", "createdAt": "2020-04-16T07:40:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk4MDQ3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk4MTYyNQ==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r408981625", "bodyText": "I think it is better to add this step to the README instead of having it here. Wdyt?", "author": "danielezonca", "createdAt": "2020-04-15T16:39:16Z", "path": "kie-pmml-new/kie-pmml-models-drools-archetype/src/main/resources/archetype-resources/__rootArtifactId__-evaluator/pom.xml", "diffHunk": "@@ -0,0 +1,65 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+  <parent>\n+    <groupId>${groupId}</groupId>\n+    <artifactId>kie-pmml-models-drools-${artifactModelName}</artifactId>\n+    <version>${version}</version>\n+  </parent>\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <artifactId>kie-pmml-models-drools-${artifactModelName}-evaluator</artifactId>\n+  <name>KIE :: PMML :: Models :: Drools :: ${modelName} :: Evaluator</name>\n+  <description>PMML ${modelName} Evaluator</description>\n+\n+  <dependencies>\n+    <!-- PMML -->\n+    <dependency>\n+      <groupId>${groupId}</groupId>\n+      <artifactId>kie-pmml-models-drools-${artifactModelName}-model</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>${groupId}</groupId>\n+      <artifactId>kie-pmml-evaluator-core</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.kie</groupId>\n+      <artifactId>kie-test-util</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <!-- EXTERNAL -->\n+    <!-- TEST -->\n+    <dependency>\n+      <groupId>org.kie</groupId>\n+      <artifactId>kie-pmml-compiler-api</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.kie</groupId>\n+      <artifactId>kie-pmml-compiler-api</artifactId>\n+      <classifier>tests</classifier>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.kie</groupId>\n+      <artifactId>kie-pmml-models-drools-${artifactModelName}-compiler</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+  </dependencies>\n+\n+  <dependencyManagement>\n+    <!-- TODO MOVE TO kie-pmml-new/pom.xml -->", "originalCommit": "5c128e3cd0eac7ea391897c48e847b42b327d521", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM0NjA1MA==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409346050", "bodyText": "@danielezonca\nDone", "author": "gitgabrio", "createdAt": "2020-04-16T07:41:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk4MTYyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk4Njk0NA==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r408986944", "bodyText": "Don't we have a drools-core dependency in this pom? I was expecting to have it", "author": "danielezonca", "createdAt": "2020-04-15T16:47:35Z", "path": "kie-pmml-new/kie-pmml-models-drools-archetype/src/main/resources/archetype-resources/__rootArtifactId__-evaluator/pom.xml", "diffHunk": "@@ -0,0 +1,65 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "originalCommit": "5c128e3cd0eac7ea391897c48e847b42b327d521", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMzNTg2Mg==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409335862", "bodyText": "@danielezonca\nNot needed here.", "author": "gitgabrio", "createdAt": "2020-04-16T07:22:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk4Njk0NA=="}], "type": "inlineReview"}, {"oid": "3a26e6983d92102ae777c55f2f951159bacdfcda", "url": "https://github.com/kiegroup/drools/commit/3a26e6983d92102ae777c55f2f951159bacdfcda", "message": "[DROOLS-5241] Add Post-creation documentation. Declaring kie-pmml-models-drools-archetype module in parent pom", "committedDate": "2020-04-16T07:40:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ2ODQ0Nw==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409468447", "bodyText": "Isn't this inherited from parents?", "author": "jiripetrlik", "createdAt": "2020-04-16T10:59:45Z", "path": "kie-pmml-new/kie-pmml-models-drools-archetype/pom.xml", "diffHunk": "@@ -0,0 +1,100 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <parent>\n+    <groupId>org.kie</groupId>\n+    <artifactId>kie-pmml-new</artifactId>\n+    <version>7.37.0-SNAPSHOT</version>\n+  </parent>\n+\n+  <artifactId>kie-pmml-models-drools-archetype</artifactId>\n+  <packaging>jar</packaging>\n+\n+  <name>KIE :: PMML :: Models :: Drools :: Archetype</name>\n+  <description>Archetype for actual PMML model with Drools implementation</description>\n+\n+  <properties>\n+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+    <maven.compiler.source>1.8</maven.compiler.source>", "originalCommit": "3a26e6983d92102ae777c55f2f951159bacdfcda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTUwMzg4NA==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409503884", "bodyText": "@jiripetrlik\n\ud83d\udc4d", "author": "gitgabrio", "createdAt": "2020-04-16T12:07:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ2ODQ0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ2OTIxNA==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409469214", "bodyText": "I think it would be better to inherit version from parent or use plugin management or property instead of hard coded version.", "author": "jiripetrlik", "createdAt": "2020-04-16T11:01:16Z", "path": "kie-pmml-new/kie-pmml-models-drools-archetype/pom.xml", "diffHunk": "@@ -0,0 +1,100 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <parent>\n+    <groupId>org.kie</groupId>\n+    <artifactId>kie-pmml-new</artifactId>\n+    <version>7.37.0-SNAPSHOT</version>\n+  </parent>\n+\n+  <artifactId>kie-pmml-models-drools-archetype</artifactId>\n+  <packaging>jar</packaging>\n+\n+  <name>KIE :: PMML :: Models :: Drools :: Archetype</name>\n+  <description>Archetype for actual PMML model with Drools implementation</description>\n+\n+  <properties>\n+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+    <maven.compiler.source>1.8</maven.compiler.source>\n+    <maven.compiler.target>1.8</maven.compiler.target>\n+  </properties>\n+\n+  <build>\n+    <plugins>\n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-archetype-plugin</artifactId>\n+        <configuration>\n+          <ignoreEOLStyle>true</ignoreEOLStyle>\n+          <debug>true</debug>\n+          <noLog>false</noLog>\n+        </configuration>\n+        <executions>\n+          <execution>\n+            <goals>\n+              <goal>integration-test</goal>\n+            </goals>\n+          </execution>\n+        </executions>\n+      </plugin>\n+      <plugin>\n+        <artifactId>maven-resources-plugin</artifactId>\n+        <version>3.1.0</version>", "originalCommit": "3a26e6983d92102ae777c55f2f951159bacdfcda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTUwMjQyMA==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409502420", "bodyText": "@jiripetrlik\n\ud83d\udc4d", "author": "gitgabrio", "createdAt": "2020-04-16T12:04:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ2OTIxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ3MDM1NQ==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409470355", "bodyText": "Is this Maven archetype intended only for RedHat? If not I think it would be better to leave it on user to write license and copyright information.", "author": "jiripetrlik", "createdAt": "2020-04-16T11:03:36Z", "path": "kie-pmml-new/kie-pmml-models-drools-archetype/src/main/resources/archetype-resources/__rootArtifactId__-compiler/src/main/java/__packageModelName__/compiler/executor/__modelName__ModelImplementationProvider.java", "diffHunk": "@@ -0,0 +1,44 @@\n+#set($str=\"\")\n+#set($dt=$str.getClass().forName(\"java.util.Date\").newInstance())\n+#set($year=$dt.getYear()+1900)\n+/*\n+* Copyright ${year} Red Hat, Inc. and/or its affiliates.", "originalCommit": "3a26e6983d92102ae777c55f2f951159bacdfcda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ3NTEwMQ==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409475101", "bodyText": "@jiripetrlik\nCurrently this is meant to be used by us to quickly create \"stub\" modules. And I would prefer to avoid manually adding license on every generated class :)", "author": "gitgabrio", "createdAt": "2020-04-16T11:12:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ3MDM1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ3MDcwMg==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409470702", "bodyText": "Please remove license and copyright template from archetype.", "author": "jiripetrlik", "createdAt": "2020-04-16T11:04:18Z", "path": "kie-pmml-new/kie-pmml-models-drools-archetype/src/main/resources/archetype-resources/__rootArtifactId__-compiler/src/main/java/__packageModelName__/compiler/factories/KiePMML__modelName__ModelFactory.java", "diffHunk": "@@ -0,0 +1,39 @@\n+#set($str=\"\")\n+#set($dt=$str.getClass().forName(\"java.util.Date\").newInstance())\n+#set($year=$dt.getYear()+1900)\n+/*\n+ * Copyright ${year} Red Hat, Inc. and/or its affiliates.", "originalCommit": "3a26e6983d92102ae777c55f2f951159bacdfcda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ3NTIyNw==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409475227", "bodyText": "@jiripetrlik\nSee previous answer", "author": "gitgabrio", "createdAt": "2020-04-16T11:13:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ3MDcwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ3MTY3Nw==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409471677", "bodyText": "I would suggest to let this test failed with some unimplemented exception. Or at least ignore it. Otherwise it will provide the false assumption that it is implemented and working.", "author": "jiripetrlik", "createdAt": "2020-04-16T11:06:12Z", "path": "kie-pmml-new/kie-pmml-models-drools-archetype/src/main/resources/archetype-resources/__rootArtifactId__-compiler/src/test/java/__packageModelName__/drools/compiler/executor/__modelName__ModelImplementationProviderTest.java", "diffHunk": "@@ -0,0 +1,40 @@\n+#set($str=\"\")\n+#set($dt=$str.getClass().forName(\"java.util.Date\").newInstance())\n+#set($year=$dt.getYear()+1900)\n+/*\n+ * Copyright ${year} Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package ${package}.${packageModelName}.compiler.executor;\n+\n+import org.kie.pmml.commons.model.enums.PMML_MODEL;\n+import org.junit.Test;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.fail;\n+\n+public class ${modelName}ModelImplementationProviderTest {\n+\n+    private static final ${modelName}ModelImplementationProvider PROVIDER= new ${modelName}ModelImplementationProvider();\n+\n+    @Test\n+    public void getPMMLModelType(){\n+        assertEquals(PMML_MODEL.${modelNameUppercase}_MODEL,PROVIDER.getPMMLModelType());\n+    }\n+\n+    @Test\n+    public void getKiePMMLModel() throws Exception {", "originalCommit": "3a26e6983d92102ae777c55f2f951159bacdfcda", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ3MjA0Ng==", "url": "https://github.com/kiegroup/drools/pull/2855#discussion_r409472046", "bodyText": "Please remove RedHat license and copyright template from archetype.", "author": "jiripetrlik", "createdAt": "2020-04-16T11:06:58Z", "path": "kie-pmml-new/kie-pmml-models-drools-archetype/src/main/resources/archetype-resources/__rootArtifactId__-evaluator/src/main/java/__packageModelName__/drools/evaluator/PMML__modelName__ModelEvaluator.java", "diffHunk": "@@ -0,0 +1,33 @@\n+#set($str=\"\")\n+#set($dt=$str.getClass().forName(\"java.util.Date\").newInstance())\n+#set($year=$dt.getYear()+1900)\n+/*\n+ * Copyright ${year} Red Hat, Inc. and/or its affiliates.", "originalCommit": "3a26e6983d92102ae777c55f2f951159bacdfcda", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f293aa804332c3baf86e578d840cb3178daa74c5", "url": "https://github.com/kiegroup/drools/commit/f293aa804332c3baf86e578d840cb3178daa74c5", "message": "[DROOLS-5241] Fixed as per PR suggestions", "committedDate": "2020-04-16T12:04:29Z", "type": "commit"}]}