{"pr_number": 2970, "pr_title": "[DROOLS-5412] Externalize lambda for OOPath", "pr_createdAt": "2020-07-02T07:07:49Z", "pr_url": "https://github.com/kiegroup/drools/pull/2970", "timeline": [{"oid": "09ad18d4e44c5e4594a42a51bd95d35fff5e3e10", "url": "https://github.com/kiegroup/drools/commit/09ad18d4e44c5e4594a42a51bd95d35fff5e3e10", "message": "[DROOLS-5412] Externalize lambda for OOPath", "committedDate": "2020-07-02T06:22:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc5MzMwMg==", "url": "https://github.com/kiegroup/drools/pull/2970#discussion_r448793302", "bodyText": "Similar to \"from\" clause, we need to store the return type so that ExecModelLambdaPostProcessor can use it later.", "author": "tkobayas", "createdAt": "2020-07-02T07:10:23Z", "path": "drools-model/drools-model-compiler/src/main/java/org/drools/modelcompiler/builder/generator/OOPathExprGenerator.java", "diffHunk": "@@ -97,7 +99,10 @@ public void visit(Class<?> originalClass, String originalBind, DrlxParseSuccess\n                 bindingId = context.getOOPathId(fieldType, chunkKey);\n             }\n             final Expression accessorLambda = generateLambdaWithoutParameters(Collections.emptySortedSet(),\n-                                                                              prepend(new NameExpr(THIS_PLACEHOLDER), callExpr.getExpression()));\n+                                                                              prepend(new NameExpr(THIS_PLACEHOLDER), callExpr.getExpression()), false, Optional.ofNullable(previousClass), context);\n+            if (accessorLambda instanceof LambdaExpr) {\n+                context.getPackageModel().getLambdaReturnTypes().put((LambdaExpr)accessorLambda, callExpr.getType());\n+            }", "originalCommit": "09ad18d4e44c5e4594a42a51bd95d35fff5e3e10", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "572196ab3487e7102da45853a1cd94806efbb841", "url": "https://github.com/kiegroup/drools/commit/572196ab3487e7102da45853a1cd94806efbb841", "message": "- fixed code smell", "committedDate": "2020-07-02T08:19:46Z", "type": "commit"}]}