{"pr_number": 418, "pr_title": "Add a function to confirm a plan exists for a jurisdiction", "pr_createdAt": "2020-02-04T14:07:57Z", "pr_url": "https://github.com/opensrp/opensrp-client-core/pull/418", "timeline": [{"oid": "a7a3e123d59982d76934c41af2640247fd66dd77", "url": "https://github.com/opensrp/opensrp-client-core/commit/a7a3e123d59982d76934c41af2640247fd66dd77", "message": "Add a function to confirm a plan exists for a jurisdiction", "committedDate": "2020-02-04T14:03:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY5NTM3Nw==", "url": "https://github.com/opensrp/opensrp-client-core/pull/418#discussion_r374695377", "bodyText": "Simply return cursor.moveToFirst()?", "author": "vincent-karuri", "createdAt": "2020-02-04T14:17:49Z", "path": "opensrp-app/src/main/java/org/smartregister/repository/PlanDefinitionSearchRepository.java", "diffHunk": "@@ -86,6 +86,27 @@ public void addOrUpdate(PlanDefinition planDefinition, String jurisdiction) {\n         return getPlanDefinitionRepository().findPlanDefinitionByIds(planIds);\n     }\n \n+    public boolean planExists(String planId, String jurisdictionId) {\n+\n+        Cursor cursor = null;\n+        try {\n+            String query = String.format(\"SELECT %s FROM %s \" +\n+                            \"WHERE %s=? AND %s=? AND %s=?  AND %s  >=? \", PLAN_ID,\n+                    PLAN_DEFINITION_SEARCH_TABLE, PLAN_ID, JURISDICTION_ID, STATUS, END);\n+            cursor = getReadableDatabase().rawQuery(query, new String[]{planId, jurisdictionId, ACTIVE,\n+                    String.valueOf(LocalDate.now().toDate().getTime())});\n+            if (cursor.moveToFirst()) {", "originalCommit": "a7a3e123d59982d76934c41af2640247fd66dd77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY5Nzc2MQ==", "url": "https://github.com/opensrp/opensrp-client-core/pull/418#discussion_r374697761", "bodyText": "done", "author": "githengi", "createdAt": "2020-02-04T14:22:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY5NTM3Nw=="}], "type": "inlineReview"}, {"oid": "f67e2d57ef63043aaefd80b0bd4529a128877944", "url": "https://github.com/opensrp/opensrp-client-core/commit/f67e2d57ef63043aaefd80b0bd4529a128877944", "message": "code cleanup", "committedDate": "2020-02-04T14:21:39Z", "type": "commit"}]}