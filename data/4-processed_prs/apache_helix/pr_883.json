{"pr_number": 883, "pr_title": "Support enableCompression in workflow and job configs", "pr_createdAt": "2020-03-10T22:42:18Z", "pr_url": "https://github.com/apache/helix/pull/883", "timeline": [{"oid": "1ddf865025cac7a8dbf5475ab2c52bf9f5f16c25", "url": "https://github.com/apache/helix/commit/1ddf865025cac7a8dbf5475ab2c52bf9f5f16c25", "message": "Support enableCompression in workflow and job configs\n\nPreviously, there was no way for users to set enableCompression in workflows and jobs configs. This allows them to set that field in the Builder.", "committedDate": "2020-03-10T22:41:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTI0NzQ4MA==", "url": "https://github.com/apache/helix/pull/883#discussion_r391247480", "bodyText": "It is redundant to check containsKey: if the value is not set, parseBoolean still returns false.\nUnless the default value enableCompression is true, but I don't think this should be the case.", "author": "huizhilu", "createdAt": "2020-03-11T20:24:21Z", "path": "helix-core/src/main/java/org/apache/helix/task/JobConfig.java", "diffHunk": "@@ -553,7 +556,11 @@ public static Builder fromMap(Map<String, String> cfg) {\n       }\n       if (cfg.containsKey(JobConfigProperty.RebalanceRunningTask.name())) {\n         b.setRebalanceRunningTask(\n-            Boolean.valueOf(cfg.get(JobConfigProperty.RebalanceRunningTask.name())));\n+            Boolean.parseBoolean(cfg.get(JobConfigProperty.RebalanceRunningTask.name())));\n+      }\n+      if (cfg.containsKey(ZNRecord.ENABLE_COMPRESSION_BOOLEAN_FIELD)) {", "originalCommit": "1ddf865025cac7a8dbf5475ab2c52bf9f5f16c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTI0Nzg3OQ==", "url": "https://github.com/apache/helix/pull/883#discussion_r391247879", "bodyText": "No need to check containsKey, unless the default value enableCompression is true.", "author": "huizhilu", "createdAt": "2020-03-11T20:25:09Z", "path": "helix-core/src/main/java/org/apache/helix/task/WorkflowConfig.java", "diffHunk": "@@ -552,6 +559,11 @@ public Builder setConfigMap(Map<String, String> cfg) {\n         }\n       }\n \n+      if (cfg.containsKey(ZNRecord.ENABLE_COMPRESSION_BOOLEAN_FIELD)) {", "originalCommit": "1ddf865025cac7a8dbf5475ab2c52bf9f5f16c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc2MzY2NQ==", "url": "https://github.com/apache/helix/pull/883#discussion_r391763665", "bodyText": "Then we should do a check here, right? If get null, we will get exception for parse boolean.", "author": "junkaixue", "createdAt": "2020-03-12T17:03:25Z", "path": "helix-core/src/main/java/org/apache/helix/task/JobConfig.java", "diffHunk": "@@ -553,8 +556,11 @@ public static Builder fromMap(Map<String, String> cfg) {\n       }\n       if (cfg.containsKey(JobConfigProperty.RebalanceRunningTask.name())) {\n         b.setRebalanceRunningTask(\n-            Boolean.valueOf(cfg.get(JobConfigProperty.RebalanceRunningTask.name())));\n+            Boolean.parseBoolean(cfg.get(JobConfigProperty.RebalanceRunningTask.name())));\n       }\n+      // If not set, parseBoolean returns false for null\n+      b.setEnableCompression(", "originalCommit": "92729613cbc3eef1c43eb37d33f627c06bae3025", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5OTYyNQ==", "url": "https://github.com/apache/helix/pull/883#discussion_r391799625", "bodyText": "@dasahcc\nThis is the implementation for parseBoolean() if the comment wasn't clear:\n    public static boolean parseBoolean(String s) {\n        return ((s != null) && s.equalsIgnoreCase(\"true\"));\n    }\n\nDo you see why the null check is not necessary?", "author": "narendly", "createdAt": "2020-03-12T18:03:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc2MzY2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5OTkyNA==", "url": "https://github.com/apache/helix/pull/883#discussion_r391799924", "bodyText": "public static boolean parseBoolean(String s) {\n        return ((s != null) && s.equalsIgnoreCase(\"true\"));\n    }", "author": "narendly", "createdAt": "2020-03-12T18:04:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc2MzY2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjQxOTY3Mg==", "url": "https://github.com/apache/helix/pull/883#discussion_r392419672", "bodyText": "OK. The null should be final. But it make this entry explicitly in ZNRecord, right? Usually, our check is if the entry is not in ZNRecord, we use default value. But we dont carry the default value and explicitly set in ZNRecord to reduce the size of data set.\nIn this case, it is better we follow our convention: do the check when we carry it over.", "author": "junkaixue", "createdAt": "2020-03-13T19:09:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc2MzY2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU1Nzg1Mw==", "url": "https://github.com/apache/helix/pull/883#discussion_r392557853", "bodyText": "Okay I see what you mean. I will revert to the original pattern.", "author": "narendly", "createdAt": "2020-03-14T05:10:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc2MzY2NQ=="}], "type": "inlineReview"}, {"oid": "1ddf865025cac7a8dbf5475ab2c52bf9f5f16c25", "url": "https://github.com/apache/helix/commit/1ddf865025cac7a8dbf5475ab2c52bf9f5f16c25", "message": "Support enableCompression in workflow and job configs\n\nPreviously, there was no way for users to set enableCompression in workflows and jobs configs. This allows them to set that field in the Builder.", "committedDate": "2020-03-10T22:41:23Z", "type": "forcePushed"}]}