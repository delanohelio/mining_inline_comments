{"pr_number": 992, "pr_title": "Fix version comparison issue in compatibility check stage", "pr_createdAt": "2020-05-03T18:57:46Z", "pr_url": "https://github.com/apache/helix/pull/992", "timeline": [{"oid": "3a2c5e0d3025f92fdd80c462c85feaa732d543df", "url": "https://github.com/apache/helix/commit/3a2c5e0d3025f92fdd80c462c85feaa732d543df", "message": "fix version comparison issue in compatibility check stage", "committedDate": "2020-05-03T18:50:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTIwMDkwOQ==", "url": "https://github.com/apache/helix/pull/992#discussion_r419200909", "bodyText": "What's the difference here?", "author": "junkaixue", "createdAt": "2020-05-04T03:28:11Z", "path": "helix-core/src/main/java/org/apache/helix/controller/stages/CompatibilityCheckStage.java", "diffHunk": "@@ -55,7 +55,7 @@ public void process(ClusterEvent event) throws Exception {\n             \"incompatible participant. pipeline will not continue. \" + \"controller: \"\n                 + manager.getInstanceName() + \", controllerVersion: \" + properties.getVersion()\n                 + \", minimumSupportedParticipantVersion: \"\n-                + properties.getProperty(\"miminum_supported_version.participant\")\n+                + properties.getProperty(\"minimum_supported_version.participant\")", "originalCommit": "3a2c5e0d3025f92fdd80c462c85feaa732d543df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYxMTI0NQ==", "url": "https://github.com/apache/helix/pull/992#discussion_r419611245", "bodyText": "The previous one has a typo.", "author": "zhangmeng916", "createdAt": "2020-05-04T17:42:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTIwMDkwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYxMjMyNg==", "url": "https://github.com/apache/helix/pull/992#discussion_r419612326", "bodyText": "And it caused the log to always show \"null\" for minimum support version, as it cannot find it in the property file. So the log is very confusing during debug.", "author": "zhangmeng916", "createdAt": "2020-05-04T17:44:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTIwMDkwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYxOTExNQ==", "url": "https://github.com/apache/helix/pull/992#discussion_r419619115", "bodyText": "This just ignore the check, right? Can we make the logic correct here, say 1.0.x > 0.9.x?", "author": "lei-xia", "createdAt": "2020-05-04T17:55:11Z", "path": "helix-core/src/main/java/org/apache/helix/HelixManagerProperties.java", "diffHunk": "@@ -116,6 +116,8 @@ static boolean versionNoLessThan(String version1, String version2) {\n \n         if (versionNum1 < versionNum2) {\n           return false;\n+        } else if (versionNum1 > versionNum2) {", "originalCommit": "3a2c5e0d3025f92fdd80c462c85feaa732d543df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzMDk0NA==", "url": "https://github.com/apache/helix/pull/992#discussion_r419630944", "bodyText": "This is not to ignore the check. This is a digit by digit comparison. See above code, the version is already split. So we are comparing \"1\" to \"0\", which breaks the loop. If it's \"0\" to \"0\", we will continue to compare next digit. It should be complete.", "author": "zhangmeng916", "createdAt": "2020-05-04T18:14:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYxOTExNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzMjgyMQ==", "url": "https://github.com/apache/helix/pull/992#discussion_r419632821", "bodyText": "Previous error is just that it didn't break even the digit is larger the minimum version. I guess it didn't consider we might bump to 1.0.0.0.", "author": "zhangmeng916", "createdAt": "2020-05-04T18:17:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYxOTExNQ=="}], "type": "inlineReview"}]}