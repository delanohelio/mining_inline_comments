{"pr_number": 2924, "pr_title": "fix(android): incorrect keyboard height", "pr_createdAt": "2020-05-14T12:12:14Z", "pr_url": "https://github.com/ionic-team/capacitor/pull/2924", "timeline": [{"oid": "e1d6076784bd579739dc519ff75edde703e86708", "url": "https://github.com/ionic-team/capacitor/commit/e1d6076784bd579739dc519ff75edde703e86708", "message": "fix(android): incorrect keyboard height", "committedDate": "2020-05-14T12:06:15Z", "type": "commit"}, {"oid": "626f856256cd89bcfca410d495d0a3064d85dbb0", "url": "https://github.com/ionic-team/capacitor/commit/626f856256cd89bcfca410d495d0a3064d85dbb0", "message": "Merge branch 'master' into android-keyboard-fix", "committedDate": "2020-06-10T13:19:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODE2OTgzNw==", "url": "https://github.com/ionic-team/capacitor/pull/2924#discussion_r438169837", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                          screenHeight = rootViewHeight - stableInsetBottom;\n          \n          \n            \n                          screenHeight = rootViewHeight;\n          \n          \n            \n                          resultBottom = resultBottom + stableInsetBottom;\n          \n      \n    \n    \n  \n\nI think it makes more sense to add stableInsetBottom to resultBottom instead of substract it from rootViewHeight.\nThe result is the same, but it's better code legibility to add bottom to bottom.", "author": "jcesarmobile", "createdAt": "2020-06-10T14:32:34Z", "path": "android/capacitor/src/main/java/com/getcapacitor/plugin/Keyboard.java", "diffHunk": "@@ -54,18 +55,19 @@ public void onGlobalLayout() {\n             // cache properties for later use\n             int rootViewHeight = rootView.getRootView().getHeight();\n             int resultBottom = r.bottom;\n-\n-            // calculate screen height differently for android versions >= 21: Lollipop 5.x, Marshmallow 6.x\n-            //http://stackoverflow.com/a/29257533/3642890 beware of nexus 5\n             int screenHeight;\n \n-            if (Build.VERSION.SDK_INT >= 21) {\n+            if (Build.VERSION.SDK_INT >= 23) {\n+              WindowInsets windowInsets = rootView.getRootWindowInsets();\n+              int stableInsetBottom = windowInsets.getStableInsetBottom();\n+              screenHeight = rootViewHeight - stableInsetBottom;", "originalCommit": "626f856256cd89bcfca410d495d0a3064d85dbb0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8773000b24c5ece53e8cc140455611f1ab340c68", "url": "https://github.com/ionic-team/capacitor/commit/8773000b24c5ece53e8cc140455611f1ab340c68", "message": "Update android/capacitor/src/main/java/com/getcapacitor/plugin/Keyboard.java", "committedDate": "2020-06-10T16:56:37Z", "type": "commit"}]}