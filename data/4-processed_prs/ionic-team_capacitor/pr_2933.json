{"pr_number": 2933, "pr_title": "feat(ios): improve webview background experience", "pr_createdAt": "2020-05-15T15:28:38Z", "pr_url": "https://github.com/ionic-team/capacitor/pull/2933", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg4ODY4OA==", "url": "https://github.com/ionic-team/capacitor/pull/2933#discussion_r425888688", "bodyText": "what is this supposed to do? shouldn't it be reset to the default value after the splash disappears?", "author": "jcesarmobile", "createdAt": "2020-05-15T15:43:58Z", "path": "ios/Capacitor/Capacitor/CAPBridgeViewController.swift", "diffHunk": "@@ -89,15 +89,21 @@ public class CAPBridgeViewController: UIViewController, CAPBridgeDelegate, WKScr\n     }\n     webView?.configuration.preferences.setValue(true, forKey: \"allowFileAccessFromFileURLs\")\n     view = webView\n-    \n+\n     setKeyboardRequiresUserInteraction(false)\n-    \n+\n     bridge = CAPBridge(self, o, capConfig, specifiedScheme)\n \n+    webView?.isOpaque = false", "originalCommit": "3bcb50284ace3d62b2b4e3f62c43a1c198e2f956", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg4ODk4NQ==", "url": "https://github.com/ionic-team/capacitor/pull/2933#discussion_r425888985", "bodyText": "this will break the background color functionality using the systemBackground color on iOS 13 despite the value used", "author": "jcesarmobile", "createdAt": "2020-05-15T15:44:32Z", "path": "ios/Capacitor/Capacitor/CAPBridgeViewController.swift", "diffHunk": "@@ -89,15 +89,21 @@ public class CAPBridgeViewController: UIViewController, CAPBridgeDelegate, WKScr\n     }\n     webView?.configuration.preferences.setValue(true, forKey: \"allowFileAccessFromFileURLs\")\n     view = webView\n-    \n+\n     setKeyboardRequiresUserInteraction(false)\n-    \n+\n     bridge = CAPBridge(self, o, capConfig, specifiedScheme)\n \n+    webView?.isOpaque = false\n     if let backgroundColor = (bridge!.config.getValue(\"ios.backgroundColor\") as? String) ?? (bridge!.config.getValue(\"backgroundColor\") as? String) {\n-      webView?.backgroundColor = UIColor(fromHex: backgroundColor)\n-      webView?.scrollView.backgroundColor = UIColor(fromHex: backgroundColor)\n+        if #available(iOS 13.0, *) {\n+            webView?.backgroundColor = UIColor.systemBackground", "originalCommit": "3bcb50284ace3d62b2b4e3f62c43a1c198e2f956", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1e0a2cbf1211d85e11b87703f7bae9de936727ce", "url": "https://github.com/ionic-team/capacitor/commit/1e0a2cbf1211d85e11b87703f7bae9de936727ce", "message": "feat(ios): improve webview background experience", "committedDate": "2020-06-30T17:37:31Z", "type": "commit"}, {"oid": "50a50409f1e85fcaac5b0540549f5bd2cf21d1e2", "url": "https://github.com/ionic-team/capacitor/commit/50a50409f1e85fcaac5b0540549f5bd2cf21d1e2", "message": "updates based on feedback", "committedDate": "2020-07-02T17:13:33Z", "type": "commit"}, {"oid": "50a50409f1e85fcaac5b0540549f5bd2cf21d1e2", "url": "https://github.com/ionic-team/capacitor/commit/50a50409f1e85fcaac5b0540549f5bd2cf21d1e2", "message": "updates based on feedback", "committedDate": "2020-07-02T17:13:33Z", "type": "forcePushed"}, {"oid": "08bb4685034b58bd238bc023adeea7c52e49b09d", "url": "https://github.com/ionic-team/capacitor/commit/08bb4685034b58bd238bc023adeea7c52e49b09d", "message": "Merge branch 'master' into webview-background-enhancments", "committedDate": "2020-07-02T17:33:42Z", "type": "commit"}, {"oid": "c4cf61280ed2a72af835f6217e83edee1bb78fbf", "url": "https://github.com/ionic-team/capacitor/commit/c4cf61280ed2a72af835f6217e83edee1bb78fbf", "message": "apply feedback", "committedDate": "2020-07-02T20:32:50Z", "type": "commit"}, {"oid": "b505676dbe3b13b572daf4071d2d7e2c305d4f4b", "url": "https://github.com/ionic-team/capacitor/commit/b505676dbe3b13b572daf4071d2d7e2c305d4f4b", "message": "fix build", "committedDate": "2020-07-02T20:44:51Z", "type": "commit"}, {"oid": "109a7c3c8c163cc6eb51f557b86ab8aea46a1fb6", "url": "https://github.com/ionic-team/capacitor/commit/109a7c3c8c163cc6eb51f557b86ab8aea46a1fb6", "message": "actually fix build", "committedDate": "2020-07-02T20:47:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMzMDI1Ng==", "url": "https://github.com/ionic-team/capacitor/pull/2933#discussion_r452330256", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // Use the system background colors if background is not set by user\n          \n          \n            \n                    webView?.backgroundColor = UIColor.systemBackground\n          \n          \n            \n                    webView?.scrollView.backgroundColor = UIColor.systemBackground\n          \n          \n            \n                  // Use the system background colors if background is not set by user\n          \n          \n            \n                  webView?.backgroundColor = UIColor.systemBackground\n          \n          \n            \n                  webView?.scrollView.backgroundColor = UIColor.systemBackground", "author": "jcesarmobile", "createdAt": "2020-07-09T16:08:58Z", "path": "ios/Capacitor/Capacitor/CAPBridgeViewController.swift", "diffHunk": "@@ -97,7 +97,12 @@ public class CAPBridgeViewController: UIViewController, CAPBridgeDelegate, WKScr\n     if let backgroundColor = (bridge!.config.getValue(\"ios.backgroundColor\") as? String) ?? (bridge!.config.getValue(\"backgroundColor\") as? String) {\n       webView?.backgroundColor = UIColor(fromHex: backgroundColor)\n       webView?.scrollView.backgroundColor = UIColor(fromHex: backgroundColor)\n+    } else if #available(iOS 13, *) {\n+        // Use the system background colors if background is not set by user\n+        webView?.backgroundColor = UIColor.systemBackground\n+        webView?.scrollView.backgroundColor = UIColor.systemBackground", "originalCommit": "109a7c3c8c163cc6eb51f557b86ab8aea46a1fb6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3fa5be932d1118cb8b69a6682182bc3aad43c563", "url": "https://github.com/ionic-team/capacitor/commit/3fa5be932d1118cb8b69a6682182bc3aad43c563", "message": "Added state to only adjust the webview's `isOpaque` property on initial load and preserve the value in case it was modified by a plugin.", "committedDate": "2020-07-10T19:23:20Z", "type": "commit"}, {"oid": "112354ae10085ff059e244d3157d9dae98faa8b2", "url": "https://github.com/ionic-team/capacitor/commit/112354ae10085ff059e244d3157d9dae98faa8b2", "message": "Update ios/Capacitor/Capacitor/CAPBridgeViewController.swift\n\nCo-authored-by: jcesarmobile <jcesarmobile@gmail.com>", "committedDate": "2020-07-10T19:23:33Z", "type": "commit"}, {"oid": "64dbbc419faaf8c3ba8fbd8f199e49ffa2ad2311", "url": "https://github.com/ionic-team/capacitor/commit/64dbbc419faaf8c3ba8fbd8f199e49ffa2ad2311", "message": "Merge branch 'webview-background-enhancments' of github.com:ionic-team/capacitor into webview-background-enhancments", "committedDate": "2020-07-10T19:23:45Z", "type": "commit"}, {"oid": "816803d9435062f8ac4690809bed31171eac4b26", "url": "https://github.com/ionic-team/capacitor/commit/816803d9435062f8ac4690809bed31171eac4b26", "message": "Fixing optional handling.", "committedDate": "2020-07-10T19:46:41Z", "type": "commit"}, {"oid": "fc428c27c05b2dac6fb0ba68621c619866ac1891", "url": "https://github.com/ionic-team/capacitor/commit/fc428c27c05b2dac6fb0ba68621c619866ac1891", "message": "Fixing optional", "committedDate": "2020-07-10T19:53:14Z", "type": "commit"}, {"oid": "b979f681276bce455a8558f51ce8c27b8830566c", "url": "https://github.com/ionic-team/capacitor/commit/b979f681276bce455a8558f51ce8c27b8830566c", "message": "Merge branch 'master' into webview-background-enhancments", "committedDate": "2020-07-13T18:05:18Z", "type": "commit"}]}