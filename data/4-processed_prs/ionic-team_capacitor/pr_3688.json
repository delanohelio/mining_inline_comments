{"pr_number": 3688, "pr_title": "chore(iOS): Updating project build", "pr_createdAt": "2020-10-15T15:52:14Z", "pr_url": "https://github.com/ionic-team/capacitor/pull/3688", "timeline": [{"oid": "dfc4306d48d76608a84dc6882875665b726a4f78", "url": "https://github.com/ionic-team/capacitor/commit/dfc4306d48d76608a84dc6882875665b726a4f78", "message": "Minor cleanup to eliminate compiler warnings in Capacitor Cordova project", "committedDate": "2020-10-15T14:45:31Z", "type": "commit"}, {"oid": "1df74d6c6a3e4409b27690e3a2d0bdb3e22728b9", "url": "https://github.com/ionic-team/capacitor/commit/1df74d6c6a3e4409b27690e3a2d0bdb3e22728b9", "message": "Support direct building of the capacitor framework. Added modulemaps, updated umbrella headers, updated project settings, removed Capacitor project's Podfile. Updated respective podspecs to match.", "committedDate": "2020-10-15T14:45:54Z", "type": "commit"}, {"oid": "413af81a62174710655db6e29c0465087da10bb8", "url": "https://github.com/ionic-team/capacitor/commit/413af81a62174710655db6e29c0465087da10bb8", "message": "Removing unneeded pod install step so build will work.", "committedDate": "2020-10-15T14:47:02Z", "type": "commit"}, {"oid": "5338f02c2baf466949de285cf3553a942d94276f", "url": "https://github.com/ionic-team/capacitor/commit/5338f02c2baf466949de285cf3553a942d94276f", "message": "Cleanup from cherry-picking commits", "committedDate": "2020-10-15T14:52:06Z", "type": "commit"}, {"oid": "8a40a6ab6d1511187b58b0302a9021f7e1e02753", "url": "https://github.com/ionic-team/capacitor/commit/8a40a6ab6d1511187b58b0302a9021f7e1e02753", "message": "Deleted exclusion of removed file.", "committedDate": "2020-10-15T15:28:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkyMzkyNg==", "url": "https://github.com/ionic-team/capacitor/pull/3688#discussion_r505923926", "bodyText": "Why not CapacitorCordova?", "author": "imhoffd", "createdAt": "2020-10-15T23:40:34Z", "path": "ios/CapacitorCordova/CapacitorCordova/Info.plist", "diffHunk": "@@ -4,6 +4,8 @@\n <dict>\n \t<key>CFBundleDevelopmentRegion</key>\n \t<string>$(DEVELOPMENT_LANGUAGE)</string>\n+\t<key>CFBundleDisplayName</key>\n+\t<string>Cordova</string>", "originalCommit": "8a40a6ab6d1511187b58b0302a9021f7e1e02753", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM2ODE0MA==", "url": "https://github.com/ionic-team/capacitor/pull/3688#discussion_r506368140", "bodyText": "Because this matches how it is configured when importing via Cocoapods. The output bundle/module/filename are all Cordova despite what the project is named.", "author": "ikeith", "createdAt": "2020-10-16T12:35:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkyMzkyNg=="}], "type": "inlineReview"}, {"oid": "d15ab9fdb5b7b71578bfa0e0b10eea4a7324de54", "url": "https://github.com/ionic-team/capacitor/commit/d15ab9fdb5b7b71578bfa0e0b10eea4a7324de54", "message": "Merge branch 'main' into ios-build", "committedDate": "2020-10-16T16:48:25Z", "type": "commit"}, {"oid": "28f1eed110f3795cd47e00efea7bf2e02074615e", "url": "https://github.com/ionic-team/capacitor/commit/28f1eed110f3795cd47e00efea7bf2e02074615e", "message": "Reworked CAPLog to prevent race condition between it and CAPConfig.", "committedDate": "2020-10-16T19:34:26Z", "type": "commit"}, {"oid": "3d92dd0fc2825ec92638d1b481f832856d5a9f24", "url": "https://github.com/ionic-team/capacitor/commit/3d92dd0fc2825ec92638d1b481f832856d5a9f24", "message": "Adding empty application shell to host framework for unit tests.", "committedDate": "2020-10-16T19:42:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjY5MDY3NA==", "url": "https://github.com/ionic-team/capacitor/pull/3688#discussion_r506690674", "bodyText": "This is a stop-gap fix as I don't think this is really the best way to solve the problem. Ultimately, I think the enableLogging flag should be set externally, probably by CAPBridgeViewController at the point of entry, rather than letting CAPLog load a configuration. That will be the best way to handle things for an embedded context where the configuration might be programmatically changed. But that can addressed when CAPConfig is redone and the view controller is refactored.", "author": "ikeith", "createdAt": "2020-10-16T19:52:17Z", "path": "ios/Capacitor/Capacitor/CAPLog.swift", "diffHunk": "@@ -1,19 +1,26 @@\n public class CAPLog {\n-\n-    public static let config = CAPConfig()\n-\n+    public static var enableLogging: Bool = true\n+    \n+    private static var oneTimeConfigCheck: () -> () = {\n+        // `dispatch_once` is not available since Swift 3. but, since static properties are implicitly lazy,\n+        // this code will only execute once which is sufficient for our needs here. but since we need to do an\n+        // async dispatch, there is a window of time where the default value will be valid before the config\n+        // value(s) can be loaded.\n+        DispatchQueue.main.async {\n+            let config = CAPConfig()\n+            if let configFlag = (config.getValue(\"ios.hideLogs\") as? Bool) ?? (config.getValue(\"hideLogs\") as? Bool) {\n+                enableLogging = !configFlag\n+            }\n+        }\n+        return {}\n+    }()", "originalCommit": "3d92dd0fc2825ec92638d1b481f832856d5a9f24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6598cf6c557bc045be2e6d16a32c19b445b93732", "url": "https://github.com/ionic-team/capacitor/commit/6598cf6c557bc045be2e6d16a32c19b445b93732", "message": "Merge branch 'main' into ios-build", "committedDate": "2020-10-19T21:15:36Z", "type": "commit"}, {"oid": "a0e5e24c968a906fa8fff5280d696a8749419e8f", "url": "https://github.com/ionic-team/capacitor/commit/a0e5e24c968a906fa8fff5280d696a8749419e8f", "message": "Removing reference to deleted file.", "committedDate": "2020-10-19T21:28:37Z", "type": "commit"}, {"oid": "7fb3deb7791a894bb42fa098648dc39f954abfe6", "url": "https://github.com/ionic-team/capacitor/commit/7fb3deb7791a894bb42fa098648dc39f954abfe6", "message": "Merge branch 'main' into ios-build", "committedDate": "2020-10-19T23:00:03Z", "type": "commit"}, {"oid": "4495117f5ce440857491b57debf8c3d2434298be", "url": "https://github.com/ionic-team/capacitor/commit/4495117f5ce440857491b57debf8c3d2434298be", "message": "Merge branch 'main' into ios-build", "committedDate": "2020-10-20T18:24:10Z", "type": "commit"}, {"oid": "d44d62b3fe4cb1c55905f51369f8ca8c143e98ff", "url": "https://github.com/ionic-team/capacitor/commit/d44d62b3fe4cb1c55905f51369f8ca8c143e98ff", "message": "Merge branch 'main' into ios-build", "committedDate": "2020-10-21T10:13:38Z", "type": "commit"}, {"oid": "b9e996985c0c692bc4e10f27b5521a78dcda333c", "url": "https://github.com/ionic-team/capacitor/commit/b9e996985c0c692bc4e10f27b5521a78dcda333c", "message": "Removing deleted file reference.", "committedDate": "2020-10-21T17:16:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI2NDA4Nw==", "url": "https://github.com/ionic-team/capacitor/pull/3688#discussion_r510264087", "bodyText": "Why is the file excluded?\nCan it just be removed if not needed?", "author": "jcesarmobile", "createdAt": "2020-10-22T15:40:33Z", "path": "ios/Capacitor.podspec", "diffHunk": "@@ -11,6 +11,8 @@ Pod::Spec.new do |s|\n   s.authors = { 'Ionic Team' => 'hi@ionicframework.com' }\n   s.source = { :git => 'https://github.com/ionic-team/capacitor.git', :tag => s.version.to_s }\n   s.source_files = 'Capacitor/Capacitor/*.{swift,h,m}', 'Capacitor/Capacitor/Plugins/*.{swift,h,m}', 'Capacitor/Capacitor/Plugins/**/*.{swift,h,m}'\n+  s.exclude_files = 'Capacitor/Capacitor/Plugins/DefaultPlugins.h'", "originalCommit": "b9e996985c0c692bc4e10f27b5521a78dcda333c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDM1MjEzOQ==", "url": "https://github.com/ionic-team/capacitor/pull/3688#discussion_r510352139", "bodyText": "It's excluded so the cocoapods build matches. Otherwise cocoapods will try to add it to the public headers but that will generate a warning since it's not included in the umbrella header. But, yes, it's probably easier to just remove it since it is empty.", "author": "ikeith", "createdAt": "2020-10-22T17:55:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI2NDA4Nw=="}], "type": "inlineReview"}, {"oid": "4a861aed261d6d91d6260be0b2842d7aab4486d8", "url": "https://github.com/ionic-team/capacitor/commit/4a861aed261d6d91d6260be0b2842d7aab4486d8", "message": "Removing DefaultPlugins.h.", "committedDate": "2020-10-22T17:48:29Z", "type": "commit"}, {"oid": "2a317f0f398a136453cc3a533261ab631bb4b881", "url": "https://github.com/ionic-team/capacitor/commit/2a317f0f398a136453cc3a533261ab631bb4b881", "message": "Revert \"Reworked CAPLog to prevent race condition between it and CAPConfig.\"\n\nThis reverts commit 28f1eed110f3795cd47e00efea7bf2e02074615e.", "committedDate": "2020-10-22T17:49:16Z", "type": "commit"}, {"oid": "1567b1c380431fd295bf099c9d43dd6472ba3f4d", "url": "https://github.com/ionic-team/capacitor/commit/1567b1c380431fd295bf099c9d43dd6472ba3f4d", "message": "Added dummy config file to the tests host app to work around race condition between CAPLog and CAPConfig.", "committedDate": "2020-10-22T17:54:56Z", "type": "commit"}]}