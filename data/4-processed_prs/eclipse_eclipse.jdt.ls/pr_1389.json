{"pr_number": 1389, "pr_title": "Update the root path on workspace folder change event", "pr_createdAt": "2020-03-17T06:41:35Z", "pr_url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1389", "timeline": [{"oid": "d39323b27e25166b85cd8fedef6896d7dc908896", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/d39323b27e25166b85cd8fedef6896d7dc908896", "message": "Update the root path on workspace folder change event\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>", "committedDate": "2020-03-17T13:50:53Z", "type": "commit"}, {"oid": "d39323b27e25166b85cd8fedef6896d7dc908896", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/d39323b27e25166b85cd8fedef6896d7dc908896", "message": "Update the root path on workspace folder change event\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>", "committedDate": "2020-03-17T13:50:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzNzUzMg==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1389#discussion_r394837532", "bodyText": "why not use rootPathSet.addAll() api directly?", "author": "testforstephen", "createdAt": "2020-03-19T07:40:23Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/WorkspaceFolderChangeHandler.java", "diffHunk": "@@ -44,6 +49,24 @@ public void update(DidChangeWorkspaceFoldersParams params) {\n \t\t\t\tremovedRootPaths.add(rootPath);\n \t\t\t}\n \t\t}\n+\t\tupdateRootPaths(addedRootPaths, removedRootPaths);\n \t\tprojectManager.updateWorkspaceFolders(addedRootPaths, removedRootPaths);\n \t}\n+\n+\tprivate void updateRootPaths(Collection<IPath> addedRootPaths, Collection<IPath> removedRootPaths) {\n+\t\tSet<IPath> rootPathSet = new HashSet<>(preferenceManager.getPreferences().getRootPaths());\n+\n+\t\tSet<IPath> removedSet = new HashSet<>(removedRootPaths);\n+\t\tfor (IPath removed : removedSet) {\n+\t\t\tif (rootPathSet.contains(removed)) {\n+\t\t\t\trootPathSet.remove(removed);\n+\t\t\t}\n+\t\t}\n+\n+\t\tSet<IPath> addedSet = new HashSet<>(addedRootPaths);", "originalCommit": "d39323b27e25166b85cd8fedef6896d7dc908896", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg0OTI3Mg==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1389#discussion_r394849272", "bodyText": "yes, that's much better", "author": "jdneo", "createdAt": "2020-03-19T08:08:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzNzUzMg=="}], "type": "inlineReview"}, {"oid": "b1e74189fc03743b06c37b6e21bdc539eb3ac90c", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/b1e74189fc03743b06c37b6e21bdc539eb3ac90c", "message": "Use removeAll() and addAll()", "committedDate": "2020-03-19T08:54:37Z", "type": "commit"}]}