{"pr_number": 1484, "pr_title": "Optimize default VM management to avoid unnecessary project updates", "pr_createdAt": "2020-06-16T23:51:25Z", "pr_url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1484", "timeline": [{"oid": "7ca2be99f9e5729c7e0d9ea6c3e402a01d63cffa", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/7ca2be99f9e5729c7e0d9ea6c3e402a01d63cffa", "message": "Optimize default VM management to avoid unnecessary project updates\n\nSigned-off-by: Fred Bricon <fbricon@gmail.com>", "committedDate": "2020-06-16T23:50:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTIwNjI0NA==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1484#discussion_r441206244", "bodyText": "this caused full builds even though there was already a default runtime environment", "author": "fbricon", "createdAt": "2020-06-17T00:00:14Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/JVMConfigurator.java", "diffHunk": "@@ -52,55 +52,45 @@\n  */\n public class JVMConfigurator implements IVMInstallChangedListener {\n \n-\tpublic static boolean configureDefaultVM(Preferences preferences) throws CoreException {\n-\t\tif (preferences == null) {\n+\tpublic static boolean configureDefaultVM(String javaHome) throws CoreException {\n+\t\tif (StringUtils.isBlank(javaHome)) {\n \t\t\treturn false;\n \t\t}\n-\t\tString javaHome = preferences.getJavaHome();\n-\t\tboolean changed = false;\n-\t\tif (javaHome != null) {\n-\t\t\tFile jvmHome = new File(javaHome);\n-\t\t\tif (jvmHome.isDirectory()) {\n-\t\t\t\tIVMInstall vm = findVM(jvmHome, null);\n-\t\t\t\tif (vm == null) {\n-\t\t\t\t\tIVMInstallType installType = JavaRuntime.getVMInstallType(StandardVMType.ID_STANDARD_VM_TYPE);\n-\t\t\t\t\tlong unique = System.currentTimeMillis();\n-\t\t\t\t\twhile (installType.findVMInstall(String.valueOf(unique)) != null) {\n-\t\t\t\t\t\tunique++;\n-\t\t\t\t\t}\n-\t\t\t\t\tString vmId = String.valueOf(unique);\n-\t\t\t\t\tVMStandin vmStandin = new VMStandin(installType, vmId);\n-\t\t\t\t\tString name = StringUtils.defaultIfBlank(jvmHome.getName(), \"JRE\");\n-\t\t\t\t\tvmStandin.setName(name);\n-\t\t\t\t\tvmStandin.setInstallLocation(jvmHome);\n-\t\t\t\t\tvm = vmStandin.convertToRealVM();\n-\t\t\t\t\tJDTUtils.setCompatibleVMs(vm.getId());\n-\t\t\t\t\tchanged = true;", "originalCommit": "7ca2be99f9e5729c7e0d9ea6c3e402a01d63cffa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}