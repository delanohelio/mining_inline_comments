{"pr_number": 1521, "pr_title": "Add java.project.resourceFilters preference", "pr_createdAt": "2020-07-31T18:02:40Z", "pr_url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521", "timeline": [{"oid": "769a2f44067391aa2bbea4d4e668a6e06f18d2e0", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/769a2f44067391aa2bbea4d4e668a6e06f18d2e0", "message": "Add java.import.resourceFilter preference\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-08-05T02:24:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTc5NDU3MQ==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r469794571", "bodyText": "String  JDTLS_FILTER_MATCHER_ID", "author": "fbricon", "createdAt": "2020-08-13T08:44:48Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/managers/ProjectsManager.java", "diffHunk": "@@ -77,6 +80,8 @@\n \n \tpublic static final String DEFAULT_PROJECT_NAME = \"jdt.ls-java-project\";\n \tpublic static final String PROJECTS_IMPORTED = \"__PROJECTS_IMPORTED__\";\n+\tprivate static final String filterMatcherId = \"org.eclipse.jdt.ls.filterMatcher\";", "originalCommit": "769a2f44067391aa2bbea4d4e668a6e06f18d2e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDEyNDI3OQ==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r470124279", "bodyText": "Fixed.", "author": "snjeza", "createdAt": "2020-08-13T17:33:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTc5NDU3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NDQ1Mg==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r469944452", "bodyText": "java.project.resourceFilters", "author": "fbricon", "createdAt": "2020-08-13T13:19:06Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -73,6 +73,12 @@\n \t * Preference key used to include the comments during the formatting.\n \t */\n \tpublic static final String JAVA_FORMAT_COMMENTS = \"java.format.comments.enabled\";\n+\t/**\n+\t * Specifies filter applied on projects to exclude some file system objects\n+\t * while populating the resources tree.\n+\t */\n+\tpublic static final String JAVA_RESOURCE_FILTER = \"java.import.resourceFilter\";", "originalCommit": "769a2f44067391aa2bbea4d4e668a6e06f18d2e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU0ODA0Mw==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r471548043", "bodyText": "Fixed.", "author": "snjeza", "createdAt": "2020-08-17T15:13:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NDQ1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NDU3OA==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r469944578", "bodyText": "should be an actual list", "author": "fbricon", "createdAt": "2020-08-13T13:19:19Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -73,6 +73,12 @@\n \t * Preference key used to include the comments during the formatting.\n \t */\n \tpublic static final String JAVA_FORMAT_COMMENTS = \"java.format.comments.enabled\";\n+\t/**\n+\t * Specifies filter applied on projects to exclude some file system objects\n+\t * while populating the resources tree.\n+\t */\n+\tpublic static final String JAVA_RESOURCE_FILTER = \"java.import.resourceFilter\";\n+\tpublic static final String JAVA_RESOURCE_FILTER_DEFAULT = \"node_modules|.git\";", "originalCommit": "769a2f44067391aa2bbea4d4e668a6e06f18d2e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDEyNTI5Nw==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r470125297", "bodyText": "The argument is a regular expression (string), not a list.", "author": "snjeza", "createdAt": "2020-08-13T17:34:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NDU3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU0ODI1MA==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r471548250", "bodyText": "Fixed.", "author": "snjeza", "createdAt": "2020-08-17T15:14:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NDU3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NDg1Mw==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r469944853", "bodyText": "resourceFilters", "author": "fbricon", "createdAt": "2020-08-13T13:19:46Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -442,6 +448,7 @@\n \tprivate int importOnDemandThreshold;\n \tprivate int staticImportOnDemandThreshold;\n \tprivate Set<RuntimeEnvironment> runtimes = new HashSet<>();\n+\tprivate String resourceFilter;", "originalCommit": "769a2f44067391aa2bbea4d4e668a6e06f18d2e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDEyNTkzMA==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r470125930", "bodyText": "There is only one filter per a project.", "author": "snjeza", "createdAt": "2020-08-13T17:35:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NDg1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NTEwNw==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r469945107", "bodyText": "setResourceFilters(resourceFilters)", "author": "fbricon", "createdAt": "2020-08-13T13:20:08Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -891,6 +902,11 @@ public Preferences setFormatterUrl(String formatterUrl) {\n \t\treturn this;\n \t}\n \n+\tpublic Preferences setResourceFilter(String resourceFilter) {", "originalCommit": "769a2f44067391aa2bbea4d4e668a6e06f18d2e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDEyNjY0Mg==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r470126642", "bodyText": "See the comment above.", "author": "snjeza", "createdAt": "2020-08-13T17:35:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NTEwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU0ODUwNQ==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r471548505", "bodyText": "Fixed.", "author": "snjeza", "createdAt": "2020-08-17T15:14:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NTEwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NTM1OA==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r469945358", "bodyText": "getResourceFilters()", "author": "fbricon", "createdAt": "2020-08-13T13:20:30Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -1151,6 +1167,10 @@ public String getFormatterUrl() {\n \t\treturn formatterUrl;\n \t}\n \n+\tpublic String getResourceFilter() {", "originalCommit": "769a2f44067391aa2bbea4d4e668a6e06f18d2e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDEyNjgzNQ==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r470126835", "bodyText": "See the comment above.", "author": "snjeza", "createdAt": "2020-08-13T17:36:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NTM1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU0OTEyNw==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r471549127", "bodyText": "Fixed.", "author": "snjeza", "createdAt": "2020-08-17T15:15:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk0NTM1OA=="}], "type": "inlineReview"}, {"oid": "4885951383b7875cb3880dac7ac0f57c12d4fe47", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/4885951383b7875cb3880dac7ac0f57c12d4fe47", "message": "Add java.project.resourceFilter preference\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-08-13T17:32:15Z", "type": "forcePushed"}, {"oid": "5698090e6b1baba6c688187635ed1eba47ef21aa", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/5698090e6b1baba6c688187635ed1eba47ef21aa", "message": "Add java.project.resourceFilters preference\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-08-17T15:09:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI5NzE0Nw==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r472297147", "bodyText": "please remove the extra ;", "author": "fbricon", "createdAt": "2020-08-18T15:45:44Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -73,6 +73,12 @@\n \t * Preference key used to include the comments during the formatting.\n \t */\n \tpublic static final String JAVA_FORMAT_COMMENTS = \"java.format.comments.enabled\";\n+\t/**\n+\t * Specifies filter applied on projects to exclude some file system objects\n+\t * while populating the resources tree.\n+\t */\n+\tpublic static final String JAVA_RESOURCE_FILTERS = \"java.project.resourceFilters\";\n+\tpublic static final List<String> JAVA_RESOURCE_FILTERS_DEFAULT;;", "originalCommit": "5698090e6b1baba6c688187635ed1eba47ef21aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU2MDY5MA==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r472560690", "bodyText": "Fixed.", "author": "snjeza", "createdAt": "2020-08-19T00:09:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI5NzE0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI5NzcxNw==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r472297717", "bodyText": "JAVA_RESOURCE_FILTERS_DEFAULT  = Arrays.asList(\"node_modules\", \".git\")", "author": "fbricon", "createdAt": "2020-08-18T15:46:29Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -468,6 +475,9 @@\n \t\tJAVA_COMPLETION_FILTERED_TYPES_DEFAULT = new ArrayList<>();\n \t\tJAVA_COMPLETION_FILTERED_TYPES_DEFAULT.add(\"java.awt.*\");\n \t\tJAVA_COMPLETION_FILTERED_TYPES_DEFAULT.add(\"com.sun.*\");\n+\t\tJAVA_RESOURCE_FILTERS_DEFAULT = new ArrayList<>();", "originalCommit": "5698090e6b1baba6c688187635ed1eba47ef21aa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "46a089700dafedf6b23c90474204cd6e68abe5d7", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/46a089700dafedf6b23c90474204cd6e68abe5d7", "message": "Add java.project.resourceFilters preference\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-08-19T00:01:17Z", "type": "forcePushed"}, {"oid": "63d39ea59617e1ed96507273a613aef4315beee4", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/63d39ea59617e1ed96507273a613aef4315beee4", "message": "Add java.project.resourceFilters preference\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-08-19T00:08:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEzMDM1OA==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r474130358", "bodyText": "extra ; still here", "author": "fbricon", "createdAt": "2020-08-20T16:45:47Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -73,6 +74,12 @@\n \t * Preference key used to include the comments during the formatting.\n \t */\n \tpublic static final String JAVA_FORMAT_COMMENTS = \"java.format.comments.enabled\";\n+\t/**\n+\t * Specifies filter applied on projects to exclude some file system objects\n+\t * while populating the resources tree.\n+\t */\n+\tpublic static final String JAVA_RESOURCE_FILTERS = \"java.project.resourceFilters\";\n+\tpublic static final List<String> JAVA_RESOURCE_FILTERS_DEFAULT;;", "originalCommit": "63d39ea59617e1ed96507273a613aef4315beee4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE2NjIxMg==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r474166212", "bodyText": "Fixed.", "author": "snjeza", "createdAt": "2020-08-20T17:49:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEzMDM1OA=="}], "type": "inlineReview"}, {"oid": "b48c85ed7bd83bf1ec4b70dd9adc00b984372e9a", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/b48c85ed7bd83bf1ec4b70dd9adc00b984372e9a", "message": "Add java.project.resourceFilters preference\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-08-20T17:47:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM1NTY2OQ==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r474355669", "bodyText": "if resourceFilters could be null, then Line#520 will throw NPE.", "author": "testforstephen", "createdAt": "2020-08-21T01:20:31Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/managers/ProjectsManager.java", "diffHunk": "@@ -509,4 +515,38 @@ public File findFile(String formatterUrl) {\n \t\treturn null;\n \t}\n \n+\tpublic void configureFilters(IProgressMonitor monitor) throws CoreException {\n+\t\tList<String> resourceFilters = preferenceManager.getPreferences().getResourceFilters();\n+\t\tif (!resourceFilters.isEmpty()) {\n+\t\t\tresourceFilters = new ArrayList<>(resourceFilters);\n+\t\t\tresourceFilters.add(CREATED_BY_JAVA_LANGUAGE_SERVER);\n+\t\t}\n+\t\tString resourceFilter = resourceFilters == null ? null : String.join(\"|\", resourceFilters);", "originalCommit": "b48c85ed7bd83bf1ec4b70dd9adc00b984372e9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc5Njc1NQ==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1521#discussion_r474796755", "bodyText": "Fixed.", "author": "snjeza", "createdAt": "2020-08-21T16:17:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM1NTY2OQ=="}], "type": "inlineReview"}, {"oid": "7e5923c004aaa0e7ba785a20abbacd5d073ac399", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/7e5923c004aaa0e7ba785a20abbacd5d073ac399", "message": "Add java.project.resourceFilters preference\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-08-21T16:17:11Z", "type": "commit"}, {"oid": "7e5923c004aaa0e7ba785a20abbacd5d073ac399", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/7e5923c004aaa0e7ba785a20abbacd5d073ac399", "message": "Add java.project.resourceFilters preference\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-08-21T16:17:11Z", "type": "forcePushed"}]}