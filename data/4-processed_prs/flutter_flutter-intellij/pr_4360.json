{"pr_number": 4360, "pr_title": "Change the plugin tool to properly build the dev channel", "pr_createdAt": "2020-02-05T21:29:35Z", "pr_url": "https://github.com/flutter/flutter-intellij/pull/4360", "timeline": [{"oid": "27cd2adeeb01b05ef69071dbb91bfa83df7abcae", "url": "https://github.com/flutter/flutter-intellij/commit/27cd2adeeb01b05ef69071dbb91bfa83df7abcae", "message": "Build artifacts for dev channel", "committedDate": "2020-02-05T17:43:54Z", "type": "commit"}, {"oid": "b071e0427629371a9408deb77cc6c3f15ed1f382", "url": "https://github.com/flutter/flutter-intellij/commit/b071e0427629371a9408deb77cc6c3f15ed1f382", "message": "Change the plugin tool to properly build the dev channel", "committedDate": "2020-02-05T21:00:36Z", "type": "commit"}, {"oid": "3430383230cdfc3bbfc829d184722a30928db171", "url": "https://github.com/flutter/flutter-intellij/commit/3430383230cdfc3bbfc829d184722a30928db171", "message": "Fix typos", "committedDate": "2020-02-05T21:27:13Z", "type": "commit"}, {"oid": "393e06cb9949558368f5e71de3094fea40d4f2d0", "url": "https://github.com/flutter/flutter-intellij/commit/393e06cb9949558368f5e71de3094fea40d4f2d0", "message": "Add git magic", "committedDate": "2020-02-05T22:43:55Z", "type": "commit"}, {"oid": "b39feb9218d269114b84a4128fa33162469d9bb8", "url": "https://github.com/flutter/flutter-intellij/commit/b39feb9218d269114b84a4128fa33162469d9bb8", "message": "debugging", "committedDate": "2020-02-05T22:48:01Z", "type": "commit"}, {"oid": "8677098017b4b3465183c9a9b06da28e4ee8a267", "url": "https://github.com/flutter/flutter-intellij/commit/8677098017b4b3465183c9a9b06da28e4ee8a267", "message": "Initialize dev channel globals only when needed (i.e. not travis)", "committedDate": "2020-02-05T22:59:51Z", "type": "commit"}, {"oid": "f8c137b9446a1ee48b767571ac2f8350dd9e0ec2", "url": "https://github.com/flutter/flutter-intellij/commit/f8c137b9446a1ee48b767571ac2f8350dd9e0ec2", "message": "debugging", "committedDate": "2020-02-05T23:11:04Z", "type": "commit"}, {"oid": "32483bf43bdeb9652cb7f65747f9d9a5c5f0bc88", "url": "https://github.com/flutter/flutter-intellij/commit/32483bf43bdeb9652cb7f65747f9d9a5c5f0bc88", "message": "debugging", "committedDate": "2020-02-05T23:14:04Z", "type": "commit"}, {"oid": "8355d63fc2e9634a8eabb3c208964f0e45618a34", "url": "https://github.com/flutter/flutter-intellij/commit/8355d63fc2e9634a8eabb3c208964f0e45618a34", "message": "Remove obsolete comment", "committedDate": "2020-02-05T23:38:40Z", "type": "commit"}, {"oid": "18d0040500d870a605623d9e81dc96f001818f66", "url": "https://github.com/flutter/flutter-intellij/commit/18d0040500d870a605623d9e81dc96f001818f66", "message": "Rewrite the deploy command", "committedDate": "2020-02-07T21:56:16Z", "type": "commit"}, {"oid": "d4085a5f8ef775681621751f3497ea36473525a9", "url": "https://github.com/flutter/flutter-intellij/commit/d4085a5f8ef775681621751f3497ea36473525a9", "message": "Define envars for keystore", "committedDate": "2020-02-07T22:06:30Z", "type": "commit"}, {"oid": "46234ef2e9b29f676ab53edae9f654589851d1b3", "url": "https://github.com/flutter/flutter-intellij/commit/46234ef2e9b29f676ab53edae9f654589851d1b3", "message": "Update tests and refactor for testability", "committedDate": "2020-02-10T18:23:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0NDE5Nw==", "url": "https://github.com/flutter/flutter-intellij/pull/4360#discussion_r377244197", "bodyText": "Do we need to fail the build here?", "author": "devoncarew", "createdAt": "2020-02-10T18:40:21Z", "path": "tool/plugin/lib/plugin.dart", "diffHunk": "@@ -241,7 +253,7 @@ Future<bool> performReleaseChecks(ProductCommand cmd) async {\n           log('the .travis.yml file needs updating: plugin generate');\n         }\n       } else {\n-        log('the current git branch must be named \"release_${cmd.releaseMajor}\"');\n+        log('the current git branch must be named \"$expectedName\"');", "originalCommit": "46234ef2e9b29f676ab53edae9f654589851d1b3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI1OTAxNQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4360#discussion_r377259015", "bodyText": "It does fail. The function returns false, which causes failure.", "author": "stevemessick", "createdAt": "2020-02-10T19:08:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0NDE5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0NDc4Mg==", "url": "https://github.com/flutter/flutter-intellij/pull/4360#discussion_r377244782", "bodyText": "Do we have the ability to publish a rev to a weekly dev build? What if we find a P0 in the dev channel and what to patch it in order to help validate a fix? a dev channel .1", "author": "devoncarew", "createdAt": "2020-02-10T18:41:30Z", "path": "tool/plugin/lib/plugin.dart", "diffHunk": "@@ -271,6 +283,15 @@ void separator(String name) {\n   log('${ansi.red}${ansi.bold}$name${ansi.none}', indent: false);\n }\n \n+int get devBuildNumber {", "originalCommit": "46234ef2e9b29f676ab53edae9f654589851d1b3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI1OTA5OQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4360#discussion_r377259099", "bodyText": "We don't have that currently. We can add it if needed. We'd probably have to add a --patch option or similar, and it should work for stable, master, and dev builds.", "author": "stevemessick", "createdAt": "2020-02-10T19:08:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0NDc4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0NTgxOQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4360#discussion_r377245819", "bodyText": "num is a type; I assume this is valid Dart (as it analyzes correctly), but perhaps name the variable something else?", "author": "devoncarew", "createdAt": "2020-02-10T18:43:29Z", "path": "tool/plugin/lib/plugin.dart", "diffHunk": "@@ -316,6 +348,12 @@ Future<int> zip(String directory, String outFile) async {\n   return await exec('zip', args, cwd: p.dirname(directory));\n }\n \n+String _nextRelease() {\n+  var num = RegExp(r'release_(\\d+)').matchAsPrefix(lastReleaseName).group(1);", "originalCommit": "46234ef2e9b29f676ab53edae9f654589851d1b3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI1OTE2MA==", "url": "https://github.com/flutter/flutter-intellij/pull/4360#discussion_r377259160", "bodyText": "Good point. Fixed.", "author": "stevemessick", "createdAt": "2020-02-10T19:08:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0NTgxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0NjMwOA==", "url": "https://github.com/flutter/flutter-intellij/pull/4360#discussion_r377246308", "bodyText": "Why check against a specific number? If we need to check against 4. perhaps document in-line for other readers.", "author": "devoncarew", "createdAt": "2020-02-10T18:44:24Z", "path": "tool/plugin/lib/plugin.dart", "diffHunk": "@@ -632,7 +672,7 @@ class BuildCommand extends ProductCommand {\n         processedFile.writeAsStringSync(source);\n       }\n \n-      if (spec.channel == 'stable') {\n+      if (!spec.version.startsWith('4.')) {", "originalCommit": "46234ef2e9b29f676ab53edae9f654589851d1b3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI1OTI2MA==", "url": "https://github.com/flutter/flutter-intellij/pull/4360#discussion_r377259260", "bodyText": "That's standard practice; checking stable was a mistake. The edits need to be made regardless of which channel we are building.\nThere is a TODO upstream. Someday we should refactor the editing code into a separate object.", "author": "stevemessick", "createdAt": "2020-02-10T19:08:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0NjMwOA=="}], "type": "inlineReview"}, {"oid": "9f33d1d30adca554711d961facedeb34c6983746", "url": "https://github.com/flutter/flutter-intellij/commit/9f33d1d30adca554711d961facedeb34c6983746", "message": "Review comments", "committedDate": "2020-02-10T19:09:08Z", "type": "commit"}]}