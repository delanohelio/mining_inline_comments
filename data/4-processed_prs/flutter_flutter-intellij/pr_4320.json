{"pr_number": 4320, "pr_title": "Refactor build script", "pr_createdAt": "2020-01-22T21:44:29Z", "pr_url": "https://github.com/flutter/flutter-intellij/pull/4320", "timeline": [{"oid": "244b854e081518899d579ee30363def7cfa3132a", "url": "https://github.com/flutter/flutter-intellij/commit/244b854e081518899d579ee30363def7cfa3132a", "message": "Refactor build script", "committedDate": "2020-01-22T21:40:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg0ODQ2MQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4320#discussion_r369848461", "bodyText": "Add a TODO: here is this is temporary?", "author": "devoncarew", "createdAt": "2020-01-22T22:49:18Z", "path": "tool/kokoro/test.sh", "diffHunk": "@@ -1,36 +1,15 @@\n #!/bin/bash\n \n-# Fail on any error.\n-set -e\n \n-# Display commands being run. Only do this while debugging and be careful\n-# that no confidential information is displayed.\n-# set -x\n-\n-git clone --depth 1 https://github.com/flutter/flutter.git ../flutter\n-export PATH=\"$PATH\":`pwd`/../flutter/bin:`pwd`/../flutter/bin/cache/dart-sdk/bin\n-flutter config --no-analytics\n-flutter doctor\n-export FLUTTER_SDK=`pwd`/../flutter\n-\n-java -version\n-echo \"JAVA_HOME=$JAVA_HOME\"\n-\n-echo \"install ant\"\n-curl https://www-us.apache.org/dist//ant/binaries/apache-ant-1.10.7-bin.tar.gz > ../ant.tar.gz\n-(cd ..; tar fx ant.tar.gz)\n-export PATH=$PATH:`pwd`/../apache-ant-1.10.7/bin\n-\n-echo \"pub get `pwd`\"; pub get --no-precompile\n-(cd testData/sample_tests; echo \"pub get `pwd`\"; pub get --no-precompile)\n-(cd tool/plugin; echo \"pub get `pwd`\"; pub get --no-precompile)\n+source ./setup.sh\n+setup\n \n echo \"kokoro test start\"\n ./bin/plugin test\n \n echo \"kokoro test finished\"\n \n-\n+# This is temporary, duplicating build.sh", "originalCommit": "244b854e081518899d579ee30363def7cfa3132a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg0ODk5OA==", "url": "https://github.com/flutter/flutter-intellij/pull/4320#discussion_r369848998", "bodyText": "This shallow clone is faster, but this checkout of flutter won't have accurate access to things like its version info (which is stored in git metadata). I assume this won't be a problem for our use of Flutter here, but FYI if we run into issues down the road.", "author": "devoncarew", "createdAt": "2020-01-22T22:50:51Z", "path": "tool/kokoro/setup.sh", "diffHunk": "@@ -0,0 +1,29 @@\n+#!/bin/bash\n+\n+# Initialize everything required by the plugin tool.\n+setup() {\n+  # Fail on any error.\n+  set -e\n+\n+  # Display commands being run. Only do this while debugging and be careful\n+  # that no confidential information is displayed.\n+  # set -x\n+\n+  git clone --depth 1 https://github.com/flutter/flutter.git ../flutter", "originalCommit": "244b854e081518899d579ee30363def7cfa3132a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg1MDA0Nw==", "url": "https://github.com/flutter/flutter-intellij/pull/4320#discussion_r369850047", "bodyText": "www-us.apache.org/dist//ant/binaries... ==> www-us.apache.org/dist/ant/binaries (remove a double //)", "author": "devoncarew", "createdAt": "2020-01-22T22:53:52Z", "path": "tool/kokoro/setup.sh", "diffHunk": "@@ -0,0 +1,29 @@\n+#!/bin/bash\n+\n+# Initialize everything required by the plugin tool.\n+setup() {\n+  # Fail on any error.\n+  set -e\n+\n+  # Display commands being run. Only do this while debugging and be careful\n+  # that no confidential information is displayed.\n+  # set -x\n+\n+  git clone --depth 1 https://github.com/flutter/flutter.git ../flutter\n+  export PATH=\"$PATH\":`pwd`/../flutter/bin:`pwd`/../flutter/bin/cache/dart-sdk/bin\n+  flutter config --no-analytics\n+  flutter doctor\n+  export FLUTTER_SDK=`pwd`/../flutter\n+\n+  java -version\n+  echo \"JAVA_HOME=$JAVA_HOME\"\n+\n+  echo \"install ant\"\n+  curl https://www-us.apache.org/dist//ant/binaries/apache-ant-1.10.7-bin.tar.gz > ../ant.tar.gz", "originalCommit": "244b854e081518899d579ee30363def7cfa3132a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}