{"pr_number": 5148, "pr_title": "Send exception if DevTools server fails to start", "pr_createdAt": "2020-12-22T18:46:37Z", "pr_url": "https://github.com/flutter/flutter-intellij/pull/5148", "timeline": [{"oid": "9cd1df0c122f4dafd8c3946dbd0651dcea1bde52", "url": "https://github.com/flutter/flutter-intellij/commit/9cd1df0c122f4dafd8c3946dbd0651dcea1bde52", "message": "Send exception if DevTools server fails to start", "committedDate": "2020-12-22T18:42:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ3MDg4OQ==", "url": "https://github.com/flutter/flutter-intellij/pull/5148#discussion_r547470889", "bodyText": "We need to first audit these exceptions as part of this cl and change the name so it is clear we are logging the exceptions to analytics. Currently they are including the project name and a file system path both of which should not be included in exceptions that are always logged to analytics.", "author": "jacob314", "createdAt": "2020-12-22T19:36:54Z", "path": "src/io/flutter/run/daemon/DevToolsService.java", "diffHunk": "@@ -240,6 +242,7 @@ private void logExceptionAndComplete(String message) {\n \n   private void logExceptionAndComplete(Exception exception) {\n     LOG.error(exception);\n+    FlutterInitializer.getAnalytics().sendException(StringUtil.getThrowableText(exception), false);", "originalCommit": "9cd1df0c122f4dafd8c3946dbd0651dcea1bde52", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUxNTYwMg==", "url": "https://github.com/flutter/flutter-intellij/pull/5148#discussion_r547515602", "bodyText": "I don't think the project name and system path will be logged to analytics - this line makes the exception into text (which only has names of files like io.flutter.run.daemon.DevToolsService) and then goes through the sendPayload analytics function, which appends info like plugin version. Am I missing analytics getting sent through another path?", "author": "helin24", "createdAt": "2020-12-22T21:28:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ3MDg4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUxNjczNg==", "url": "https://github.com/flutter/flutter-intellij/pull/5148#discussion_r547516736", "bodyText": "(example of what would go into analytics description field)\njava.lang.Exception: test exception\n\tat io.flutter.run.daemon.DevToolsService.logExceptionAndComplete(DevToolsService.java:241)\n\tat io.flutter.run.daemon.DevToolsService.access$500(DevToolsService.java:46)\n\tat io.flutter.run.daemon.DevToolsService$2.onTextAvailable(DevToolsService.java:188)\n\tat jdk.internal.reflect.GeneratedMethodAccessor61.invoke(Unknown Source)\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.base/java.lang.reflect.Metho", "author": "helin24", "createdAt": "2020-12-22T21:31:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ3MDg4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUxOTAxNg==", "url": "https://github.com/flutter/flutter-intellij/pull/5148#discussion_r547519016", "bodyText": "The calls that concern me slightly are\nlogExceptionAndComplete(\"Unable to find daemon command for project: \" + project);\nand\nlogExceptionAndComplete(\"Handler was null for command: \" + command.toString());\nthat could expose a file path on their machine.", "author": "jacob314", "createdAt": "2020-12-22T21:38:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ3MDg4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUyMjIzNg==", "url": "https://github.com/flutter/flutter-intellij/pull/5148#discussion_r547522236", "bodyText": "Ohhh I see, I'll check through these.", "author": "helin24", "createdAt": "2020-12-22T21:46:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ3MDg4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUyNTExOA==", "url": "https://github.com/flutter/flutter-intellij/pull/5148#discussion_r547525118", "bodyText": "I just removed the contextual information that could be private. It might be nice to have this information locally logged if users report bugs, but I can always add that back later.", "author": "helin24", "createdAt": "2020-12-22T21:55:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ3MDg4OQ=="}], "type": "inlineReview"}, {"oid": "d9922ee79efd341efc7b086fe8524ed49517917d", "url": "https://github.com/flutter/flutter-intellij/commit/d9922ee79efd341efc7b086fe8524ed49517917d", "message": "Make error messages safe", "committedDate": "2020-12-22T21:53:09Z", "type": "commit"}]}