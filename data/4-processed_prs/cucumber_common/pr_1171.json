{"pr_number": 1171, "pr_title": "Remove golang gox build dependency", "pr_createdAt": "2020-09-04T03:02:57Z", "pr_url": "https://github.com/cucumber/common/pull/1171", "timeline": [{"oid": "d6614363610303efa984f8e6f0175cfb83321e27", "url": "https://github.com/cucumber/common/commit/d6614363610303efa984f8e6f0175cfb83321e27", "message": "Remove gox build dependency\n\nRemove Gox build dependency from .templates/go/default.mk makefile\nEnumerated a set of build targets compatible with golang versions 1.13-1.15\nadded a minimum supported version warning", "committedDate": "2020-09-04T02:27:52Z", "type": "commit"}, {"oid": "945d0f87ee7b52fe15c38d94bc72073e72ebb825", "url": "https://github.com/cucumber/common/commit/945d0f87ee7b52fe15c38d94bc72073e72ebb825", "message": "Merge branch 'master' into golang-makefile", "committedDate": "2020-09-04T17:23:02Z", "type": "commit"}, {"oid": "8be9a59c6425d9d3b22a02e06ae58ebc0a3d3b36", "url": "https://github.com/cucumber/common/commit/8be9a59c6425d9d3b22a02e06ae58ebc0a3d3b36", "message": "Merge branch 'master' into golang-makefile", "committedDate": "2020-09-07T11:24:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQ1MTAzNQ==", "url": "https://github.com/cucumber/common/pull/1171#discussion_r487451035", "bodyText": "Let's rename GOX_LDFLAGS to LDFLAGS now that we're no longer using gox.", "author": "aslakhellesoy", "createdAt": "2020-09-12T21:35:14Z", "path": ".templates/go/default.mk", "diffHunk": "@@ -30,23 +42,43 @@ endif\n .deps:\n \ttouch $@\n \n-dist: $(EXE)\n+dist: $(EXE) \n ifndef NO_UPX_COMPRESSION\n \tmake .dist-compressed\n endif\n \ttouch $@\n \n-$(EXE): .deps $(GO_SOURCE_FILES)\n-\tmkdir -p dist\n+# Define build $(EXE) target differentially depending on NO_CROSS_COMPILE flag\n ifndef NO_CROSS_COMPILE\n-\t# Cross-compile executable for many platforms\n-\tgo get github.com/aslakhellesoy/gox\n-\tgox -buildmode=exe -ldflags $(GOX_LDFLAGS) -output \"dist/$(EXE_BASE_NAME)-{{.OS}}-{{.Arch}}\" -rebuild ./cmd\n+$(EXE): $(PLATFORMS)\n+\t# Rename windows compilations to include .exe extension\n+\trm -f dist/*windows*.exe\n+\tfor f in dist/*windows*; do mv -f $${f} $${f}.exe; done\n else\n+$(EXE): .deps $(GO_SOURCE_FILES)\n \t# Compile executable for the local platform only\n \tgo build -ldflags $(GOX_LDFLAGS) -o $@ ./cmd\n endif\n \n+$(PLATFORMS): .deps $(GO_SOURCE_FILES) supported-go-version\n+\tmkdir -p dist\n+\t# Cross-compile executable for many platforms\n+\techo \"Building $(X-OS)-$(X-ARCH)\"\n+\tGOOS=$(X-OS) GOARCH=$(X-ARCH) go build -buildmode=exe -ldflags $(GOX_LDFLAGS) -o \"dist/$(EXE_BASE_NAME)-$(X-OS)-$(X-ARCH)\" -a ./cmd", "originalCommit": "8be9a59c6425d9d3b22a02e06ae58ebc0a3d3b36", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY2MzI3NA==", "url": "https://github.com/cucumber/common/pull/1171#discussion_r490663274", "bodyText": "Adjusted terminology to adjust LDFLAG name convention", "author": "dmboyd", "createdAt": "2020-09-18T02:23:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQ1MTAzNQ=="}], "type": "inlineReview"}, {"oid": "9ea603a7ebfea6ec736cea3ffeb0ebbb232a10f9", "url": "https://github.com/cucumber/common/commit/9ea603a7ebfea6ec736cea3ffeb0ebbb232a10f9", "message": "Merge branch 'master' into golang-makefile", "committedDate": "2020-09-12T21:37:30Z", "type": "commit"}, {"oid": "9466c848d199472080852e99cfe42c799f113fd0", "url": "https://github.com/cucumber/common/commit/9466c848d199472080852e99cfe42c799f113fd0", "message": "Merge branch 'master' into golang-makefile", "committedDate": "2020-09-13T19:46:53Z", "type": "commit"}, {"oid": "a1872d27e8394ef1b76ad7f5fbdf5588060edbed", "url": "https://github.com/cucumber/common/commit/a1872d27e8394ef1b76ad7f5fbdf5588060edbed", "message": "Merge branch 'master' into golang-makefile", "committedDate": "2020-09-18T02:00:46Z", "type": "commit"}, {"oid": "9dfaa1a3e789defa946ffc1e412432c16388ef6d", "url": "https://github.com/cucumber/common/commit/9dfaa1a3e789defa946ffc1e412432c16388ef6d", "message": "Update default.mk\n\nrename GOX_LDFLAGS to LDFLAGS now that we're no longer using gox", "committedDate": "2020-09-18T02:06:22Z", "type": "commit"}, {"oid": "f0f0f1df367ac8634e052b907d49e8e43277915b", "url": "https://github.com/cucumber/common/commit/f0f0f1df367ac8634e052b907d49e8e43277915b", "message": "remove GOX_LD_FLAGS reference\n\nRemove gox reference from all go makefiles", "committedDate": "2020-09-18T02:18:56Z", "type": "commit"}, {"oid": "6a72c7c7a067e85c8e49432ac47471af07c162b2", "url": "https://github.com/cucumber/common/commit/6a72c7c7a067e85c8e49432ac47471af07c162b2", "message": "Remove References to gox within go.mod\n\nRemove all references to gox within go.mod & removed pretty-formatter default.mk (orphan file) not propagated from .template makefile.", "committedDate": "2020-09-18T02:44:03Z", "type": "commit"}, {"oid": "89582967fb73dcc1395c40329ef4fdcf7991f62a", "url": "https://github.com/cucumber/common/commit/89582967fb73dcc1395c40329ef4fdcf7991f62a", "message": "Merge branch 'master' into golang-makefile", "committedDate": "2020-09-23T13:43:52Z", "type": "commit"}, {"oid": "fdaea6a579dc3d8e6671b62af01d26688f9fa351", "url": "https://github.com/cucumber/common/commit/fdaea6a579dc3d8e6671b62af01d26688f9fa351", "message": "Merge branch 'master' into golang-makefile", "committedDate": "2020-09-29T11:00:03Z", "type": "commit"}, {"oid": "716e8a984e1eb86250ff1c0a892157406f8b8a6e", "url": "https://github.com/cucumber/common/commit/716e8a984e1eb86250ff1c0a892157406f8b8a6e", "message": "Merge branch 'master' into golang-makefile", "committedDate": "2020-10-01T10:47:52Z", "type": "commit"}, {"oid": "1a741107507066e03cbf162bb9513f36c48d3730", "url": "https://github.com/cucumber/common/commit/1a741107507066e03cbf162bb9513f36c48d3730", "message": "Merge branch 'master' into golang-makefile", "committedDate": "2020-10-02T09:59:51Z", "type": "commit"}]}