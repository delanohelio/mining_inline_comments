{"pr_number": 940, "pr_title": "[gherkin-c] Linking against libmath", "pr_createdAt": "2020-03-21T19:20:44Z", "pr_url": "https://github.com/cucumber/common/pull/940", "timeline": [{"oid": "95f6d3a2b1b32ccef45851f4e672befa0769c925", "url": "https://github.com/cucumber/common/commit/95f6d3a2b1b32ccef45851f4e672befa0769c925", "message": "Problem: gherkin-c linking fails on log10 function\n\nSolution: Include libmath in the target_link_libraries so log10 function\ncan be linked.", "committedDate": "2020-03-21T19:14:13Z", "type": "commit"}, {"oid": "2ffefa0a8e78c3c88a17f7926f7ab33dd627649b", "url": "https://github.com/cucumber/common/commit/2ffefa0a8e78c3c88a17f7926f7ab33dd627649b", "message": "Problem: Cannot link against shared libraries\n\nSolution: Compile with -fPIC enabled by CMAKE_POSITION_INDEPENDENCT_CODE", "committedDate": "2020-04-06T10:42:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE2NDAxNg==", "url": "https://github.com/cucumber/common/pull/940#discussion_r409164016", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            target_link_libraries(gherkinexe gherkin m)\n          \n          \n            \n            target_link_libraries(gherkinexe PUBLIC gherkin PRIVATE m)\n          \n      \n    \n    \n  \n\nI don't know too much about C or CMake. But shouldn't this be linked privately so as not to expose math as part of the link interface?", "author": "mpkorstanje", "createdAt": "2020-04-15T22:10:07Z", "path": "gherkin/c/CMakeLists.txt", "diffHunk": "@@ -70,11 +71,11 @@ target_include_directories(gherkin PUBLIC\n     \"$<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include;${CMAKE_CURRENT_SOURCE_DIR}/src>\")\n \n add_executable(gherkinexe ${GHERKIN_CLI})\n-target_link_libraries(gherkinexe gherkin)\n+target_link_libraries(gherkinexe gherkin m)", "originalCommit": "2ffefa0a8e78c3c88a17f7926f7ab33dd627649b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA4NDg4Nw==", "url": "https://github.com/cucumber/common/pull/940#discussion_r410084887", "bodyText": "@mpkorstanje correct but we need to link the library privately against math not the executables. I just pushed another commit that fixes this issue. Thanks!", "author": "sappo", "createdAt": "2020-04-17T08:52:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE2NDAxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE2NDEyNA==", "url": "https://github.com/cucumber/common/pull/940#discussion_r409164124", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            target_link_libraries(gherkin_generate_tokens gherkin m)\n          \n          \n            \n            target_link_libraries(gherkin_generate_tokens PUBLIC gherkin PRIVATE m)", "author": "mpkorstanje", "createdAt": "2020-04-15T22:10:21Z", "path": "gherkin/c/CMakeLists.txt", "diffHunk": "@@ -70,11 +71,11 @@ target_include_directories(gherkin PUBLIC\n     \"$<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include;${CMAKE_CURRENT_SOURCE_DIR}/src>\")\n \n add_executable(gherkinexe ${GHERKIN_CLI})\n-target_link_libraries(gherkinexe gherkin)\n+target_link_libraries(gherkinexe gherkin m)\n target_include_directories(gherkinexe PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include ${CMAKE_CURRENT_SOURCE_DIR}/src)\n \n add_executable(gherkin_generate_tokens ${GENERATE_TOKEN})\n-target_link_libraries(gherkin_generate_tokens gherkin)\n+target_link_libraries(gherkin_generate_tokens gherkin m)", "originalCommit": "2ffefa0a8e78c3c88a17f7926f7ab33dd627649b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "af630e39cfc5b0bff3c4485293fabddc0a9acea5", "url": "https://github.com/cucumber/common/commit/af630e39cfc5b0bff3c4485293fabddc0a9acea5", "message": "Merge branch 'master' into master", "committedDate": "2020-04-15T22:19:44Z", "type": "commit"}, {"oid": "8fa3921f26e8108b68d8ece43e60afc5bbf97041", "url": "https://github.com/cucumber/common/commit/8fa3921f26e8108b68d8ece43e60afc5bbf97041", "message": "Problem: libgherkin does not link against libmath\n\nThe missing link against libmath forces users of this library\nto link against libmath themselves even though libmath is not used in\nany public interface.\n\nSolution: Tell cmake to link libgherkin against libmath and make this\nlink private so its not exposed in the link interface.", "committedDate": "2020-04-17T08:50:20Z", "type": "commit"}]}