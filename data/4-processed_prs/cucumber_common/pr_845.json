{"pr_number": 845, "pr_title": "Add gherkin query in Ruby", "pr_createdAt": "2020-01-07T16:52:29Z", "pr_url": "https://github.com/cucumber/common/pull/845", "timeline": [{"oid": "e71c51fd04e8474f263805fe075062f7b9cfb2aa", "url": "https://github.com/cucumber/common/commit/e71c51fd04e8474f263805fe075062f7b9cfb2aa", "message": "Raise an exception when messages are iterated/generated twice\n\nThis avoid generating the mesages twice, getting different IDs in the AST and so on.", "committedDate": "2020-01-07T15:35:37Z", "type": "commit"}, {"oid": "0aad9ac7f69f40855378a6b316726ccab20cebc8", "url": "https://github.com/cucumber/common/commit/0aad9ac7f69f40855378a6b316726ccab20cebc8", "message": "Add GherkinQuery object to query location of AST objects based on IDs", "committedDate": "2020-01-07T16:44:48Z", "type": "commit"}, {"oid": "5eeb702457dc5d33e4b087c5247710b63d893ef3", "url": "https://github.com/cucumber/common/commit/5eeb702457dc5d33e4b087c5247710b63d893ef3", "message": "Retro-compatibility fix for older Rubys", "committedDate": "2020-01-08T08:59:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE0MTk0OQ==", "url": "https://github.com/cucumber/common/pull/845#discussion_r364141949", "bodyText": "are these methods \"synched up\" across all implementations. If they are that's cool. If not traditionally we would drop get_ and set_ prefixes in methods.", "author": "luke-hill", "createdAt": "2020-01-08T09:44:15Z", "path": "gherkin/ruby/lib/gherkin/gherkin_query.rb", "diffHunk": "@@ -0,0 +1,54 @@\n+module Gherkin\n+  class Query\n+    def initialize\n+      @ast_node_locations = {}\n+    end\n+\n+    def update(message)\n+      update_feature(message.gherkin_document.feature) if message.gherkin_document\n+    end\n+\n+    def get_location(ast_node_id)", "originalCommit": "5eeb702457dc5d33e4b087c5247710b63d893ef3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE2Nzg0Mg==", "url": "https://github.com/cucumber/common/pull/845#discussion_r364167842", "bodyText": "We aim to have a consistent API between implementations, but I still think we should be idiomatic. Please change to location.", "author": "aslakhellesoy", "createdAt": "2020-01-08T10:42:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE0MTk0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDIxOTE1Mw==", "url": "https://github.com/cucumber/common/pull/845#discussion_r364219153", "bodyText": "done", "author": "vincent-psarga", "createdAt": "2020-01-08T13:02:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE0MTk0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE0MTk3Ng==", "url": "https://github.com/cucumber/common/pull/845#discussion_r364141976", "bodyText": "traditionally errors in ruby all end in error (I'm aware that there are existing ones here that don't), so it's not a biggie if you don't fix", "author": "luke-hill", "createdAt": "2020-01-08T09:44:19Z", "path": "gherkin/ruby/lib/gherkin/errors.rb", "diffHunk": "@@ -1,5 +1,7 @@\n module Gherkin\n   class ParserError < StandardError; end\n+  class AstNodeNotLocatedException < Exception; end", "originalCommit": "5eeb702457dc5d33e4b087c5247710b63d893ef3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE2NzQxNA==", "url": "https://github.com/cucumber/common/pull/845#discussion_r364167414", "bodyText": "Custom exceptions should extend from StandardError. Never extend Exception.", "author": "aslakhellesoy", "createdAt": "2020-01-08T10:41:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE0MTk3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDIxOTgzNw==", "url": "https://github.com/cucumber/common/pull/845#discussion_r364219837", "bodyText": "inheritance is done.\nFor the Error vs Exception, all (except ParserError) are called XXXException, so I went with the rest", "author": "vincent-psarga", "createdAt": "2020-01-08T13:04:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE0MTk3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDI5OTQ0OA==", "url": "https://github.com/cucumber/common/pull/845#discussion_r364299448", "bodyText": "Makes sense for now yeh, top work though, this stuff should get gherkin 9 ready soon :)", "author": "luke-hill", "createdAt": "2020-01-08T15:46:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE0MTk3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE4NDcyNQ==", "url": "https://github.com/cucumber/common/pull/845#discussion_r364184725", "bodyText": "Rename the file to query.rb", "author": "aslakhellesoy", "createdAt": "2020-01-08T11:26:18Z", "path": "gherkin/ruby/lib/gherkin/gherkin_query.rb", "diffHunk": "@@ -0,0 +1,54 @@\n+module Gherkin\n+  class Query", "originalCommit": "5eeb702457dc5d33e4b087c5247710b63d893ef3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDIyMDA5OQ==", "url": "https://github.com/cucumber/common/pull/845#discussion_r364220099", "bodyText": "done", "author": "vincent-psarga", "createdAt": "2020-01-08T13:05:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDE4NDcyNQ=="}], "type": "inlineReview"}, {"oid": "9d29216f7751231961909dc2c8d8427824e10b05", "url": "https://github.com/cucumber/common/commit/9d29216f7751231961909dc2c8d8427824e10b05", "message": "GherkinQuery: can get location of an examples row", "committedDate": "2020-01-08T12:50:44Z", "type": "commit"}, {"oid": "aa5fa1c75f4b8eb53c10c686c3e47e56d2eb2251", "url": "https://github.com/cucumber/common/commit/aa5fa1c75f4b8eb53c10c686c3e47e56d2eb2251", "message": "Rename gherkin_query as query", "committedDate": "2020-01-08T12:53:31Z", "type": "commit"}, {"oid": "455fe803f5473c8613b6830a7eb57b6b4bbc5525", "url": "https://github.com/cucumber/common/commit/455fe803f5473c8613b6830a7eb57b6b4bbc5525", "message": "Query.get_location is now Query.location", "committedDate": "2020-01-08T12:54:52Z", "type": "commit"}, {"oid": "bca74886b6775f5ed7cb7821973f460813a7b67c", "url": "https://github.com/cucumber/common/commit/bca74886b6775f5ed7cb7821973f460813a7b67c", "message": "AstNodeNotLocatedException now inherits from StandardError", "committedDate": "2020-01-08T12:55:34Z", "type": "commit"}, {"oid": "b451b1c19dc148cf0f0a5b7ad73d2890399af8f6", "url": "https://github.com/cucumber/common/commit/b451b1c19dc148cf0f0a5b7ad73d2890399af8f6", "message": "Update Changelog", "committedDate": "2020-01-08T12:59:10Z", "type": "commit"}, {"oid": "6830f503087ebdd1c16ed30cecd210a5eb18aca6", "url": "https://github.com/cucumber/common/commit/6830f503087ebdd1c16ed30cecd210a5eb18aca6", "message": "Add #argument_location to find location of a step argument", "committedDate": "2020-01-08T13:46:39Z", "type": "commit"}]}