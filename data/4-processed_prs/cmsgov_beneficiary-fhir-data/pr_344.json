{"pr_number": 344, "pr_title": "Feature/ab2d-1862-or-condition", "pr_createdAt": "2020-09-01T14:21:26Z", "pr_url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/344", "timeline": [{"oid": "e307c17f88be6b8e770c7bca2ff082d59c860c67", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/e307c17f88be6b8e770c7bca2ff082d59c860c67", "message": "Adding RFC for OR condition", "committedDate": "2020-08-31T13:56:17Z", "type": "commit"}, {"oid": "ce3c54d191120c5b8263b56e7ca8e72c44335f7b", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/ce3c54d191120c5b8263b56e7ca8e72c44335f7b", "message": "Adding 1 additional question", "committedDate": "2020-09-01T14:13:18Z", "type": "commit"}, {"oid": "19de5e4416927833a822918aca229236b8d868c9", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/19de5e4416927833a822918aca229236b8d868c9", "message": "Updating with PR link", "committedDate": "2020-09-01T14:33:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3MDk2Mw==", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/344#discussion_r490370963", "bodyText": "We should include proving this assumption with performance tests during the implementation phase.", "author": "jzulim", "createdAt": "2020-09-17T16:06:11Z", "path": "rfcs/0006-or-condition.md", "diffHunk": "@@ -0,0 +1,101 @@\n+# RFC Proposal\n+[RFC Proposal]: #rfc-proposal\n+\n+* RFC Proposal ID: `0006-or-condition`\n+* Start Date: 2020-08-21\n+* RFC PR: [https://github.com/CMSgov/beneficiary-fhir-data/pull/344](https://github.com/CMSgov/beneficiary-fhir-data/pull/344)\n+* JIRA Ticket(s):\n+    * [https://jira.cms.gov/browse/AB2D-1862](https://jira.cms.gov/browse/AB2D-1862)\n+\n+This proposal will suggest adding an OR clause to queries that gather the contract to patient mapping in order\n+to improve efficiency on both the client and server. \n+\n+## Table of Contents\n+[Table of Contents]: #table-of-contents\n+\n+* [RFC Proposal](#rfc-proposal)\n+* [Table of Contents](#table-of-contents)\n+* [Motivation](#motivation)\n+* [Proposed Solution](#proposed-solution)\n+    * [Proposed Solution: Detailed Design](#proposed-solution-detailed-design)\n+    * [Proposed Solution: Unresolved Questions](#proposed-solution-unresolved-questions)\n+    * [Proposed Solution: Drawbacks](#proposed-solution-drawbacks)\n+    * [Proposed Solution: Notable Alternatives](#proposed-solution-notable-alternatives)\n+* [Future Possibilities](#future-possibilities)\n+\n+## Motivation\n+[Motivation]: #motivation\n+\n+AB2D has long running export jobs where the amount of time the job takes is critical for customer happiness. In order to\n+lessen the amount of time a job takes to run, we will need to be able to improve performance in every section of our code.\n+One part that takes a long time is the call to the Patient URL that maps contracts to beneficiaries on a monthly basis.\n+Being able to query multiple months in the same call will reduce the load on the BFD database since it will reduce the ", "originalCommit": "19de5e4416927833a822918aca229236b8d868c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM4NjQ5MQ==", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/344#discussion_r490386491", "bodyText": "Comparing this implementation to the master branch will be a good validation test I believe.", "author": "adaykin", "createdAt": "2020-09-17T16:19:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3MDk2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3NDEwNg==", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/344#discussion_r490374106", "bodyText": "@msnook @dtisza1 @DeirdreHolub - Does BB2, BCDA or DPC have a use case for this OR in regards to Part D Contracts?", "author": "jzulim", "createdAt": "2020-09-17T16:09:01Z", "path": "rfcs/0006-or-condition.md", "diffHunk": "@@ -0,0 +1,101 @@\n+# RFC Proposal\n+[RFC Proposal]: #rfc-proposal\n+\n+* RFC Proposal ID: `0006-or-condition`\n+* Start Date: 2020-08-21\n+* RFC PR: [https://github.com/CMSgov/beneficiary-fhir-data/pull/344](https://github.com/CMSgov/beneficiary-fhir-data/pull/344)\n+* JIRA Ticket(s):\n+    * [https://jira.cms.gov/browse/AB2D-1862](https://jira.cms.gov/browse/AB2D-1862)\n+\n+This proposal will suggest adding an OR clause to queries that gather the contract to patient mapping in order\n+to improve efficiency on both the client and server. \n+\n+## Table of Contents\n+[Table of Contents]: #table-of-contents\n+\n+* [RFC Proposal](#rfc-proposal)\n+* [Table of Contents](#table-of-contents)\n+* [Motivation](#motivation)\n+* [Proposed Solution](#proposed-solution)\n+    * [Proposed Solution: Detailed Design](#proposed-solution-detailed-design)\n+    * [Proposed Solution: Unresolved Questions](#proposed-solution-unresolved-questions)\n+    * [Proposed Solution: Drawbacks](#proposed-solution-drawbacks)\n+    * [Proposed Solution: Notable Alternatives](#proposed-solution-notable-alternatives)\n+* [Future Possibilities](#future-possibilities)\n+\n+## Motivation\n+[Motivation]: #motivation\n+\n+AB2D has long running export jobs where the amount of time the job takes is critical for customer happiness. In order to\n+lessen the amount of time a job takes to run, we will need to be able to improve performance in every section of our code.\n+One part that takes a long time is the call to the Patient URL that maps contracts to beneficiaries on a monthly basis.\n+Being able to query multiple months in the same call will reduce the load on the BFD database since it will reduce the \n+number of calls needed to it, and be more efficient since we will reduce the number of API calls we need to make. It is more\n+efficient on the server side to make 1 call to get the data, than it is to make 6 different calls that gather the same amount\n+of data.\n+\n+## Proposed Solution\n+[Proposed Solution]: #proposed-solution\n+\n+The solution will allow a client to specify any number of months that they want to be passed to the BFD server. The BFD server\n+will be able to parse what months the client is asking for, and then return all of the months at once, instead of having the client\n+make individual requests.\n+\n+\n+### Proposed Solution: Detailed Design\n+[Proposed Solution: Detailed Design]: #proposed-solution-detailed-design\n+\n+PatientResourceProvider.queryBeneficiaryIds currently takes in just one field, and one value. This code should\n+be changed so that it takes in a list of objects. The new object would just be a simple value class that can \n+hold a field and value \n+\n+PatientResourceProvider.queryBeneficiaryIds can take in an object like so:\n+// Assume getters and setters\n+class FieldValue {\n+    private String field;\n+    private String value; \n+}\n+\n+https://bluebutton.cms.gov/resources/variables/ptdcntrct01\n+is the current variable for how data is sent over from AB2D for the month of Jan. to the BFD server\n+\n+When it is used with an identifier, it is combined with a contract, e.g. \n+https://bluebutton.cms.gov/resources/variables/ptdcntrct01|Z0001\n+\n+In order to send over multiple months using the FHIR client libraries, the systemAndIdentifier method takes\n+2 strings, the first being the one we're interested in (the system). Months can be separated by a delimiter, so\n+that multiple months can be included, e.g. https://bluebutton.cms.gov/resources/variables/ptdcntrct01-02-03\n+\n+This value can be parsed by BFD to determine if there should be an or parameter in the event there's a list of items\n+sent over. One month would mean that there's no need for a month parameter. The SQL query in queryBeneficiaryIds\n+can provide an OR clause when necessary.\n+\n+### Proposed Solution: Unresolved Questions\n+[Proposed Solution: Unresolved Questions]: #proposed-solution-unresolved-questions\n+\n+Before a solution goes into place, how can we validate that this actually does help performance?\n+Performance testing this with real world examples, e.g. comparing AB2D performance querying 6 months separately\n+vs. 1 query with 6 months.\n+\n+Will other groups use this solution?", "originalCommit": "19de5e4416927833a822918aca229236b8d868c9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3NDU1OA==", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/344#discussion_r490374558", "bodyText": "We can deploy a branch to our test environment and run performance tests manually?", "author": "jzulim", "createdAt": "2020-09-17T16:09:28Z", "path": "rfcs/0006-or-condition.md", "diffHunk": "@@ -0,0 +1,101 @@\n+# RFC Proposal\n+[RFC Proposal]: #rfc-proposal\n+\n+* RFC Proposal ID: `0006-or-condition`\n+* Start Date: 2020-08-21\n+* RFC PR: [https://github.com/CMSgov/beneficiary-fhir-data/pull/344](https://github.com/CMSgov/beneficiary-fhir-data/pull/344)\n+* JIRA Ticket(s):\n+    * [https://jira.cms.gov/browse/AB2D-1862](https://jira.cms.gov/browse/AB2D-1862)\n+\n+This proposal will suggest adding an OR clause to queries that gather the contract to patient mapping in order\n+to improve efficiency on both the client and server. \n+\n+## Table of Contents\n+[Table of Contents]: #table-of-contents\n+\n+* [RFC Proposal](#rfc-proposal)\n+* [Table of Contents](#table-of-contents)\n+* [Motivation](#motivation)\n+* [Proposed Solution](#proposed-solution)\n+    * [Proposed Solution: Detailed Design](#proposed-solution-detailed-design)\n+    * [Proposed Solution: Unresolved Questions](#proposed-solution-unresolved-questions)\n+    * [Proposed Solution: Drawbacks](#proposed-solution-drawbacks)\n+    * [Proposed Solution: Notable Alternatives](#proposed-solution-notable-alternatives)\n+* [Future Possibilities](#future-possibilities)\n+\n+## Motivation\n+[Motivation]: #motivation\n+\n+AB2D has long running export jobs where the amount of time the job takes is critical for customer happiness. In order to\n+lessen the amount of time a job takes to run, we will need to be able to improve performance in every section of our code.\n+One part that takes a long time is the call to the Patient URL that maps contracts to beneficiaries on a monthly basis.\n+Being able to query multiple months in the same call will reduce the load on the BFD database since it will reduce the \n+number of calls needed to it, and be more efficient since we will reduce the number of API calls we need to make. It is more\n+efficient on the server side to make 1 call to get the data, than it is to make 6 different calls that gather the same amount\n+of data.\n+\n+## Proposed Solution\n+[Proposed Solution]: #proposed-solution\n+\n+The solution will allow a client to specify any number of months that they want to be passed to the BFD server. The BFD server\n+will be able to parse what months the client is asking for, and then return all of the months at once, instead of having the client\n+make individual requests.\n+\n+\n+### Proposed Solution: Detailed Design\n+[Proposed Solution: Detailed Design]: #proposed-solution-detailed-design\n+\n+PatientResourceProvider.queryBeneficiaryIds currently takes in just one field, and one value. This code should\n+be changed so that it takes in a list of objects. The new object would just be a simple value class that can \n+hold a field and value \n+\n+PatientResourceProvider.queryBeneficiaryIds can take in an object like so:\n+// Assume getters and setters\n+class FieldValue {\n+    private String field;\n+    private String value; \n+}\n+\n+https://bluebutton.cms.gov/resources/variables/ptdcntrct01\n+is the current variable for how data is sent over from AB2D for the month of Jan. to the BFD server\n+\n+When it is used with an identifier, it is combined with a contract, e.g. \n+https://bluebutton.cms.gov/resources/variables/ptdcntrct01|Z0001\n+\n+In order to send over multiple months using the FHIR client libraries, the systemAndIdentifier method takes\n+2 strings, the first being the one we're interested in (the system). Months can be separated by a delimiter, so\n+that multiple months can be included, e.g. https://bluebutton.cms.gov/resources/variables/ptdcntrct01-02-03\n+\n+This value can be parsed by BFD to determine if there should be an or parameter in the event there's a list of items\n+sent over. One month would mean that there's no need for a month parameter. The SQL query in queryBeneficiaryIds\n+can provide an OR clause when necessary.\n+\n+### Proposed Solution: Unresolved Questions\n+[Proposed Solution: Unresolved Questions]: #proposed-solution-unresolved-questions\n+\n+Before a solution goes into place, how can we validate that this actually does help performance?", "originalCommit": "19de5e4416927833a822918aca229236b8d868c9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3NTM2MQ==", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/344#discussion_r490375361", "bodyText": "\ud83d\udc4d", "author": "jzulim", "createdAt": "2020-09-17T16:10:13Z", "path": "rfcs/0006-or-condition.md", "diffHunk": "@@ -0,0 +1,101 @@\n+# RFC Proposal\n+[RFC Proposal]: #rfc-proposal\n+\n+* RFC Proposal ID: `0006-or-condition`\n+* Start Date: 2020-08-21\n+* RFC PR: [https://github.com/CMSgov/beneficiary-fhir-data/pull/344](https://github.com/CMSgov/beneficiary-fhir-data/pull/344)\n+* JIRA Ticket(s):\n+    * [https://jira.cms.gov/browse/AB2D-1862](https://jira.cms.gov/browse/AB2D-1862)\n+\n+This proposal will suggest adding an OR clause to queries that gather the contract to patient mapping in order\n+to improve efficiency on both the client and server. \n+\n+## Table of Contents\n+[Table of Contents]: #table-of-contents\n+\n+* [RFC Proposal](#rfc-proposal)\n+* [Table of Contents](#table-of-contents)\n+* [Motivation](#motivation)\n+* [Proposed Solution](#proposed-solution)\n+    * [Proposed Solution: Detailed Design](#proposed-solution-detailed-design)\n+    * [Proposed Solution: Unresolved Questions](#proposed-solution-unresolved-questions)\n+    * [Proposed Solution: Drawbacks](#proposed-solution-drawbacks)\n+    * [Proposed Solution: Notable Alternatives](#proposed-solution-notable-alternatives)\n+* [Future Possibilities](#future-possibilities)\n+\n+## Motivation\n+[Motivation]: #motivation\n+\n+AB2D has long running export jobs where the amount of time the job takes is critical for customer happiness. In order to\n+lessen the amount of time a job takes to run, we will need to be able to improve performance in every section of our code.\n+One part that takes a long time is the call to the Patient URL that maps contracts to beneficiaries on a monthly basis.\n+Being able to query multiple months in the same call will reduce the load on the BFD database since it will reduce the \n+number of calls needed to it, and be more efficient since we will reduce the number of API calls we need to make. It is more\n+efficient on the server side to make 1 call to get the data, than it is to make 6 different calls that gather the same amount\n+of data.\n+\n+## Proposed Solution\n+[Proposed Solution]: #proposed-solution\n+\n+The solution will allow a client to specify any number of months that they want to be passed to the BFD server. The BFD server\n+will be able to parse what months the client is asking for, and then return all of the months at once, instead of having the client\n+make individual requests.\n+\n+\n+### Proposed Solution: Detailed Design\n+[Proposed Solution: Detailed Design]: #proposed-solution-detailed-design\n+\n+PatientResourceProvider.queryBeneficiaryIds currently takes in just one field, and one value. This code should\n+be changed so that it takes in a list of objects. The new object would just be a simple value class that can \n+hold a field and value \n+\n+PatientResourceProvider.queryBeneficiaryIds can take in an object like so:\n+// Assume getters and setters\n+class FieldValue {\n+    private String field;\n+    private String value; \n+}\n+\n+https://bluebutton.cms.gov/resources/variables/ptdcntrct01\n+is the current variable for how data is sent over from AB2D for the month of Jan. to the BFD server\n+\n+When it is used with an identifier, it is combined with a contract, e.g. \n+https://bluebutton.cms.gov/resources/variables/ptdcntrct01|Z0001\n+\n+In order to send over multiple months using the FHIR client libraries, the systemAndIdentifier method takes\n+2 strings, the first being the one we're interested in (the system). Months can be separated by a delimiter, so\n+that multiple months can be included, e.g. https://bluebutton.cms.gov/resources/variables/ptdcntrct01-02-03\n+\n+This value can be parsed by BFD to determine if there should be an or parameter in the event there's a list of items\n+sent over. One month would mean that there's no need for a month parameter. The SQL query in queryBeneficiaryIds\n+can provide an OR clause when necessary.\n+\n+### Proposed Solution: Unresolved Questions\n+[Proposed Solution: Unresolved Questions]: #proposed-solution-unresolved-questions\n+\n+Before a solution goes into place, how can we validate that this actually does help performance?\n+Performance testing this with real world examples, e.g. comparing AB2D performance querying 6 months separately\n+vs. 1 query with 6 months.\n+\n+Will other groups use this solution?\n+\n+### Proposed Solution: Drawbacks\n+[Proposed Solution: Drawbacks]: #proposed-solution-drawbacks\n+\n+This may not work if it becomes a pain to parse apart multiple months, but it shouldn't be much of an issue, \n+since there will be a large gain from being able to query for multiple months at once, instead of doing them\n+one at a time. If clients abuse this and query more months than what they need, that would be an issue, but any client\n+could abuse an API.\n+\n+### Proposed Solution: Notable Alternatives\n+[Proposed Solution: Notable Alternatives]: #proposed-solution-notable-alternatives\n+\n+We have to make a design fit within the FHIR spec, so unfortunately there's not too much room for alternatives.\n+This solution tries to make as few changes as possible to the code on BFD's side so that it's a simple one that\n+can utilize the existing system for using a month parameter, and simply expand it to optionally use additional months.\n+\n+## Future Possibilities\n+[Future Possibilities]: #future-possibilities\n+\n+There could also be an \"or\" condition for parameters beyond months, but those would come on a case by case basis.", "originalCommit": "19de5e4416927833a822918aca229236b8d868c9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "596bffb23038538eedcd3ed3d15d0d3fce8a571a", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/596bffb23038538eedcd3ed3d15d0d3fce8a571a", "message": "Merge branch 'master' into feature/AB2D-1862-or-condition", "committedDate": "2020-09-17T16:20:13Z", "type": "commit"}]}