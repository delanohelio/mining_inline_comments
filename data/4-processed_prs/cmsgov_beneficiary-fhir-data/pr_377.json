{"pr_number": 377, "pr_title": "Cbrune/bfd 482 snfdiagnosisfix", "pr_createdAt": "2020-10-16T01:00:09Z", "pr_url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/377", "timeline": [{"oid": "2b606f0af5a30fefcd6138181fa01aa121697f02", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/2b606f0af5a30fefcd6138181fa01aa121697f02", "message": "Removed the principal code out into the transformerutils", "committedDate": "2020-10-10T01:34:58Z", "type": "commit"}, {"oid": "1af5809553ccedaeecc01401e8b1faa48b16a3ce", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/1af5809553ccedaeecc01401e8b1faa48b16a3ce", "message": "Fix for snf claims not showing principal and admitting", "committedDate": "2020-10-15T16:43:14Z", "type": "commit"}, {"oid": "80930fd3202bf7304129d80b08ead46f5376111f", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/80930fd3202bf7304129d80b08ead46f5376111f", "message": "Fix for snf claims not showing principal and admitting", "committedDate": "2020-10-15T16:59:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODA4Nzk3Mg==", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/377#discussion_r508087972", "bodyText": "Moving this for reuse for inpatient and snf, nice.", "author": "jzulim", "createdAt": "2020-10-19T22:00:47Z", "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/InpatientClaimTransformer.java", "diffHunk": "@@ -313,21 +313,8 @@ private static ExplanationOfBenefit transformClaim(InpatientClaim claimGroup) {\n      * rather than requiring if-blocks.\n      */\n     Consumer<Optional<Diagnosis>> diagnosisAdder =\n-        diagnosisToAdd -> {\n-          if (diagnosisToAdd.isPresent()) {\n-            Optional<Diagnosis> matchingDiagnosis =\n-                diagnoses.stream()\n-                    .filter(d -> d.getCode().equals(diagnosisToAdd.get().getCode()))\n-                    .findFirst();\n-            if (matchingDiagnosis.isPresent()) {\n-              // append labels\n-              matchingDiagnosis.get().setLabels(DiagnosisLabel.PRINCIPAL);\n-              diagnoses.add(matchingDiagnosis.get());\n-            } else {\n-              diagnoses.add(diagnosisToAdd.get());\n-            }\n-          }\n-        };\n+        TransformerUtils.addPrincipalDiagnosis(diagnoses);", "originalCommit": "80930fd3202bf7304129d80b08ead46f5376111f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}