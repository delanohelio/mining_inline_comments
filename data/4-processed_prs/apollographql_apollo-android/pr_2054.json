{"pr_number": 2054, "pr_title": "Update Okio and Okhttp", "pr_createdAt": "2020-03-08T00:20:06Z", "pr_url": "https://github.com/apollographql/apollo-android/pull/2054", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyMjkzMA==", "url": "https://github.com/apollographql/apollo-android/pull/2054#discussion_r389322930", "bodyText": "these were never used since integration tests use the real module instead of latest maven dependency.", "author": "tasomaniac", "createdAt": "2020-03-08T00:21:55Z", "path": "gradle/dependencies.gradle", "diffHunk": "@@ -39,11 +38,9 @@ ext.dep = [\n         runtime: \"org.antlr:antlr4-runtime:$versions.antlr4\",\n     ],\n     apollo                : [\n-        plugin          : \"com.apollographql.apollo:apollo-gradle-plugin:$versions.apollo\",\n-        runtime         : \"com.apollographql.apollo:apollo-runtime:$versions.apollo\",\n-        rx2             : \"com.apollographql.apollo:apollo-rx2-support:$versions.apollo\",", "originalCommit": "5637c20ea5f3caf4e96e8fa2491a60a4a4ce7ed8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7c79888e3666ce933db9f46944abc16d3f073d80", "url": "https://github.com/apollographql/apollo-android/commit/7c79888e3666ce933db9f46944abc16d3f073d80", "message": "Update Okio and Okhttp which also brings kotlin stdlib dependencies\n\nThis also forces us to use Gradle metadata (must have for Kotlin MPP).\nAnd also for Java 8", "committedDate": "2020-03-08T00:30:19Z", "type": "commit"}, {"oid": "4a7eb066540f274aa70d34c40a9324b66a093f45", "url": "https://github.com/apollographql/apollo-android/commit/4a7eb066540f274aa70d34c40a9324b66a093f45", "message": "Also fix deprecations in integration and samples", "committedDate": "2020-03-08T00:41:04Z", "type": "commit"}, {"oid": "4a7eb066540f274aa70d34c40a9324b66a093f45", "url": "https://github.com/apollographql/apollo-android/commit/4a7eb066540f274aa70d34c40a9324b66a093f45", "message": "Also fix deprecations in integration and samples", "committedDate": "2020-03-08T00:41:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyMzk0Mg==", "url": "https://github.com/apollographql/apollo-android/pull/2054#discussion_r389323942", "bodyText": "Looks like this was never used. And also not published anymore as of OkHttp 4.x", "author": "tasomaniac", "createdAt": "2020-03-08T00:44:47Z", "path": "apollo-runtime/build.gradle.kts", "diffHunk": "@@ -19,7 +19,6 @@ dependencies {\n   add(\"testImplementation\", groovy.util.Eval.x(project, \"x.dep.junit\"))\n   add(\"testImplementation\", groovy.util.Eval.x(project, \"x.dep.truth\"))\n   add(\"testImplementation\", groovy.util.Eval.x(project, \"x.dep.okHttp.mockWebServer\"))\n-  add(\"testImplementation\", groovy.util.Eval.x(project, \"x.dep.okHttp.testSupport\"))", "originalCommit": "4a7eb066540f274aa70d34c40a9324b66a093f45", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f413fd7396b3de9990c41d25e3262d68c517999c", "url": "https://github.com/apollographql/apollo-android/commit/f413fd7396b3de9990c41d25e3262d68c517999c", "message": "Remove unused import", "committedDate": "2020-03-08T00:49:52Z", "type": "commit"}, {"oid": "40fb998fc1564cc7e3d13a2861e21a9740ed6b96", "url": "https://github.com/apollographql/apollo-android/commit/40fb998fc1564cc7e3d13a2861e21a9740ed6b96", "message": "More deprecation fixes in integration module", "committedDate": "2020-03-08T01:02:23Z", "type": "commit"}, {"oid": "678ceb28f78c4ba5ef3d73eb70567cbd3388653e", "url": "https://github.com/apollographql/apollo-android/commit/678ceb28f78c4ba5ef3d73eb70567cbd3388653e", "message": "Revert to Gradle 5.6.4", "committedDate": "2020-03-08T16:53:12Z", "type": "commit"}, {"oid": "ce3f708cf1c6be5c0e3e08b6316bee83975b0fc3", "url": "https://github.com/apollographql/apollo-android/commit/ce3f708cf1c6be5c0e3e08b6316bee83975b0fc3", "message": "Fix Java8 related issues in tests", "committedDate": "2020-03-08T21:56:09Z", "type": "commit"}, {"oid": "41f6c625bb7cfedc24ff50030730424cdd05ffea", "url": "https://github.com/apollographql/apollo-android/commit/41f6c625bb7cfedc24ff50030730424cdd05ffea", "message": "Also have Java 1.8 on integration module", "committedDate": "2020-03-09T20:15:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDAyMTE4OA==", "url": "https://github.com/apollographql/apollo-android/pull/2054#discussion_r390021188", "bodyText": "\ud83d\ude80", "author": "martinbonnin", "createdAt": "2020-03-09T23:46:04Z", "path": "gradle/dependencies.gradle", "diffHunk": "@@ -9,13 +9,12 @@ def versions = [\n     javaPoet              : '1.9.0',\n     jetbrainsAnnotations  : '13.0',\n     junit                 : '4.12',\n-    kotlin                : '1.3.50',\n+    kotlin                : '1.3.70',", "originalCommit": "41f6c625bb7cfedc24ff50030730424cdd05ffea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDAyMzkxMQ==", "url": "https://github.com/apollographql/apollo-android/pull/2054#discussion_r390023911", "bodyText": "I think this is ok but I guess it's worth double checking and give a warning in release notes if needed. I started a thread over there: #2057", "author": "martinbonnin", "createdAt": "2020-03-09T23:55:41Z", "path": "apollo-android-support/build.gradle.kts", "diffHunk": "@@ -11,8 +11,8 @@ extensions.findByType(BaseExtension::class.java)!!.apply {\n   compileSdkVersion(groovy.util.Eval.x(project, \"x.androidConfig.compileSdkVersion\").toString().toInt())\n \n   compileOptions {\n-    sourceCompatibility = JavaVersion.VERSION_1_7\n-    targetCompatibility = JavaVersion.VERSION_1_7\n+    sourceCompatibility = JavaVersion.VERSION_1_8\n+    targetCompatibility = JavaVersion.VERSION_1_8", "originalCommit": "41f6c625bb7cfedc24ff50030730424cdd05ffea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDEzNTk2Mg==", "url": "https://github.com/apollographql/apollo-android/pull/2054#discussion_r390135962", "bodyText": "Google nowadays recommends libraries to target Java 8 to move the platform forward. Very few of the AndroidX libs already do that. OkHttp too.\nTechnically we don't have to do it for all modules. But for consistency that would be good. I will check if this can be done in root.", "author": "tasomaniac", "createdAt": "2020-03-10T07:40:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDAyMzkxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDAyNTEzNw==", "url": "https://github.com/apollographql/apollo-android/pull/2054#discussion_r390025137", "bodyText": "Should this be factored-in the root build.gradle.kts file ? Make sure all sub-projects target JAVA 8 ? Or are Android projects different ?", "author": "martinbonnin", "createdAt": "2020-03-10T00:00:04Z", "path": "apollo-rx2-support/build.gradle.kts", "diffHunk": "@@ -4,8 +4,8 @@ plugins {\n }\n \n java {\n-  targetCompatibility = JavaVersion.VERSION_1_7\n-  sourceCompatibility = JavaVersion.VERSION_1_7\n+  targetCompatibility = JavaVersion.VERSION_1_8\n+  sourceCompatibility = JavaVersion.VERSION_1_8", "originalCommit": "41f6c625bb7cfedc24ff50030730424cdd05ffea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDAyNTgwMA==", "url": "https://github.com/apollographql/apollo-android/pull/2054#discussion_r390025800", "bodyText": "I was thinking of bumping Gradle to latest version (6.2.2 IIRC). It should be safe to use the latest Gradle version since we have test that check against older versions.", "author": "martinbonnin", "createdAt": "2020-03-10T00:02:21Z", "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -1,5 +1,5 @@\n distributionBase=GRADLE_USER_HOME\n distributionPath=wrapper/dists\n-distributionUrl=https\\://services.gradle.org/distributions/gradle-5.6-all.zip\n+distributionUrl=https\\://services.gradle.org/distributions/gradle-5.6.4-all.zip", "originalCommit": "41f6c625bb7cfedc24ff50030730424cdd05ffea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDEzNjQ1Mw==", "url": "https://github.com/apollographql/apollo-android/pull/2054#discussion_r390136453", "bodyText": "I actually did in previous commits. My reasoning was that Gradle metadata support officially become stable in 6.0. But I had an issue with Checkstyle task and reverted.", "author": "tasomaniac", "createdAt": "2020-03-10T07:41:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDAyNTgwMA=="}], "type": "inlineReview"}, {"oid": "475c975d2aa3a3a4117eaa236ba9515873e0b558", "url": "https://github.com/apollographql/apollo-android/commit/475c975d2aa3a3a4117eaa236ba9515873e0b558", "message": "Merge branch 'master' into update-okio-okhttp", "committedDate": "2020-03-10T19:44:47Z", "type": "commit"}, {"oid": "7ff40ebb5567cbdf1625488cd66acdbf775297f6", "url": "https://github.com/apollographql/apollo-android/commit/7ff40ebb5567cbdf1625488cd66acdbf775297f6", "message": "Move all Java source/target version into central place", "committedDate": "2020-03-10T20:11:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDYwNDY3OQ==", "url": "https://github.com/apollographql/apollo-android/pull/2054#discussion_r390604679", "bodyText": "\ud83d\udc4d", "author": "martinbonnin", "createdAt": "2020-03-10T20:54:26Z", "path": "build.gradle.kts", "diffHunk": "@@ -56,6 +53,21 @@ subprojects {\n       google()\n     }\n   }\n+\n+  plugins.withType(com.android.build.gradle.BasePlugin::class.java) {\n+    extension.compileOptions {\n+      sourceCompatibility = JavaVersion.VERSION_1_8\n+      targetCompatibility = JavaVersion.VERSION_1_8\n+    }\n+  }\n+\n+  plugins.withType(org.gradle.api.plugins.JavaPlugin::class.java) {\n+    extensions.configure(JavaPluginExtension::class.java) {\n+      sourceCompatibility = JavaVersion.VERSION_1_8\n+      targetCompatibility = JavaVersion.VERSION_1_8\n+    }", "originalCommit": "7ff40ebb5567cbdf1625488cd66acdbf775297f6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}