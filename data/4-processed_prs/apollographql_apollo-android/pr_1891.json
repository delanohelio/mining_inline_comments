{"pr_number": 1891, "pr_title": "Add support directives to inline fragments", "pr_createdAt": "2020-01-09T04:21:08Z", "pr_url": "https://github.com/apollographql/apollo-android/pull/1891", "timeline": [{"oid": "c4a2f371322c158f46194439d3d6df116e5b2e71", "url": "https://github.com/apollographql/apollo-android/commit/c4a2f371322c158f46194439d3d6df116e5b2e71", "message": "Add support directives to inline fragments\n\n- Address issue with directives with inline fragments\n- Simplify and unify code generation for  regular fragments and inline fragments\n- Address issue with fragment serialization in `ResponseWriter`\n\nCloses https://github.com/apollographql/apollo-android/issues/1883", "committedDate": "2020-01-12T20:15:38Z", "type": "commit"}, {"oid": "b3b34ab76907915e1469ce01f8d6c4d3a67be068", "url": "https://github.com/apollographql/apollo-android/commit/b3b34ab76907915e1469ce01f8d6c4d3a67be068", "message": "Fix issue with Java generics", "committedDate": "2020-01-12T20:15:38Z", "type": "commit"}, {"oid": "b3b34ab76907915e1469ce01f8d6c4d3a67be068", "url": "https://github.com/apollographql/apollo-android/commit/b3b34ab76907915e1469ce01f8d6c4d3a67be068", "message": "Fix issue with Java generics", "committedDate": "2020-01-12T20:15:38Z", "type": "forcePushed"}, {"oid": "43b519e9a0694c8cfc37bdd848e5399f0a4eb012", "url": "https://github.com/apollographql/apollo-android/commit/43b519e9a0694c8cfc37bdd848e5399f0a4eb012", "message": "Fix Java fragment codegen", "committedDate": "2020-01-12T23:09:48Z", "type": "commit"}, {"oid": "e2360d7d5e83e98836de640ec99ed166adbd7a4f", "url": "https://github.com/apollographql/apollo-android/commit/e2360d7d5e83e98836de640ec99ed166adbd7a4f", "message": "Fix read fragment test", "committedDate": "2020-01-12T23:19:10Z", "type": "commit"}, {"oid": "8d7c4befa02d01e494068cc27d7e0f358d377e44", "url": "https://github.com/apollographql/apollo-android/commit/8d7c4befa02d01e494068cc27d7e0f358d377e44", "message": "Remove unused `FragmentResponseFieldMapper` + fix regular fragment serialization / deserialization codegen", "committedDate": "2020-01-13T01:35:40Z", "type": "commit"}, {"oid": "9ae25a2f4f696ec67d3f16929415ef7ceff7e098", "url": "https://github.com/apollographql/apollo-android/commit/9ae25a2f4f696ec67d3f16929415ef7ceff7e098", "message": "Update gitignore", "committedDate": "2020-01-13T22:52:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjMwMTA0NA==", "url": "https://github.com/apollographql/apollo-android/pull/1891#discussion_r366301044", "bodyText": "typo here.", "author": "tasomaniac", "createdAt": "2020-01-14T12:04:20Z", "path": "apollo-api/src/test/java/com/apollographql/apollo/api/internal/SimpleResponseReaderTest.java", "diffHunk": "@@ -95,7 +95,7 @@\n     }\n   }\n \n-  @Test public void readDouble() {\n+  @Test public void readD1ouble() {", "originalCommit": "9ae25a2f4f696ec67d3f16929415ef7ceff7e098", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjMwMjA4NA==", "url": "https://github.com/apollographql/apollo-android/pull/1891#discussion_r366302084", "bodyText": "should this be deleted?", "author": "tasomaniac", "createdAt": "2020-01-14T12:07:05Z", "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/ResponseFieldSpec.kt", "diffHunk": "@@ -212,40 +230,26 @@ class ResponseFieldSpec(\n         READ_METHODS[responseFieldType], fieldParam, readerTypeSpec)\n   }\n \n-  private fun readInlineFragmentCode(readerParam: CodeBlock, fieldParam: CodeBlock): CodeBlock {\n-    val readerTypeSpec = TypeSpec.anonymousClassBuilder(\"\")\n-        .superclass(conditionalResponseFieldReaderType(normalizedFieldSpec.type))\n-        .addMethod(MethodSpec\n-            .methodBuilder(\"read\")\n-            .addModifiers(Modifier.PUBLIC)\n-            .addAnnotation(Override::class.java)\n-            .returns(normalizedFieldSpec.type)\n-            .addParameter(ParameterSpec.builder(String::class.java, CONDITIONAL_TYPE_VAR).build())\n-            .addParameter(RESPONSE_READER_PARAM)\n-            .addStatement(\"return \\$L.map(\\$L)\", (normalizedFieldSpec.type as ClassName).mapperFieldName(),\n-                RESPONSE_READER_PARAM.name)\n-            .build())\n-        .build()\n-    return CodeBlock.of(\"final \\$T \\$L = \\$L.\\$L(\\$L, \\$L);\\n\", normalizedFieldSpec.type, fieldSpec.name,\n-        readerParam, READ_METHODS[responseFieldType], fieldParam, readerTypeSpec)\n-  }\n-\n-  private fun readFragmentsCode(readerParam: CodeBlock, fieldParam: CodeBlock): CodeBlock {\n-    val readerTypeSpec = TypeSpec.anonymousClassBuilder(\"\")\n-        .superclass(conditionalResponseFieldReaderType(FRAGMENTS_CLASS))\n-        .addMethod(MethodSpec\n-            .methodBuilder(\"read\")\n-            .addModifiers(Modifier.PUBLIC)\n-            .addAnnotation(Override::class.java)\n-            .returns(FRAGMENTS_CLASS)\n-            .addParameter(ParameterSpec.builder(String::class.java, CONDITIONAL_TYPE_VAR).build())\n-            .addParameter(RESPONSE_READER_PARAM)\n-            .addStatement(\"return \\$L.map(\\$L, \\$L)\", FRAGMENTS_CLASS.mapperFieldName(),\n-                RESPONSE_READER_PARAM.name, CONDITIONAL_TYPE_VAR)\n-            .build())\n-        .build()\n-    return CodeBlock.of(\"final \\$T \\$L = \\$L.\\$L(\\$L, \\$L);\\n\", normalizedFieldSpec.type, fieldSpec.name,\n-        readerParam, READ_METHODS[responseFieldType], fieldParam, readerTypeSpec)\n+//  private fun readFragmentCode(readerParam: CodeBlock, fieldParam: CodeBlock): CodeBlock {", "originalCommit": "9ae25a2f4f696ec67d3f16929415ef7ceff7e098", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjMwMjUwMQ==", "url": "https://github.com/apollographql/apollo-android/pull/1891#discussion_r366302501", "bodyText": "codestyle: Looks like here, it would be better to put the first param in a new line", "author": "tasomaniac", "createdAt": "2020-01-14T12:08:11Z", "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/SchemaTypeSpecBuilder.kt", "diffHunk": "@@ -433,18 +449,18 @@ class SchemaTypeSpecBuilder(\n   }\n \n   private fun inlineFragmentsResponseMapperSpec(nameOverrideMap: Map<String, String>,", "originalCommit": "9ae25a2f4f696ec67d3f16929415ef7ceff7e098", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "35c2dbc0768937bcb64b83d8138e8581117fcb8e", "url": "https://github.com/apollographql/apollo-android/commit/35c2dbc0768937bcb64b83d8138e8581117fcb8e", "message": "Address feedback", "committedDate": "2020-01-16T04:01:11Z", "type": "commit"}]}