{"pr_number": 2690, "pr_title": "[KMP] added a 'timeoutMillis' parameter to ApolloHttpNetworkTransport", "pr_createdAt": "2020-10-23T12:50:41Z", "pr_url": "https://github.com/apollographql/apollo-android/pull/2690", "timeline": [{"oid": "049d32b2f6bc320e74c594d9f8ea9d9a2ca4c68d", "url": "https://github.com/apollographql/apollo-android/commit/049d32b2f6bc320e74c594d9f8ea9d9a2ca4c68d", "message": "added a 'timeoutMillis' parameter to ApolloHttpNetworkTransport", "committedDate": "2020-10-23T12:49:15Z", "type": "commit"}, {"oid": "d6132f2c4590bc9b778ff44e52ffcf5d8e1f69ff", "url": "https://github.com/apollographql/apollo-android/commit/d6132f2c4590bc9b778ff44e52ffcf5d8e1f69ff", "message": "fix doc", "committedDate": "2020-10-23T12:51:23Z", "type": "commit"}, {"oid": "349f43f08cd6709c4f08df521f33863044e01477", "url": "https://github.com/apollographql/apollo-android/commit/349f43f08cd6709c4f08df521f33863044e01477", "message": "use setTimeoutInterval()", "committedDate": "2020-10-23T12:57:10Z", "type": "commit"}, {"oid": "c8f5f6f6f090b2354bc0a58d6b961b3c01caa245", "url": "https://github.com/apollographql/apollo-android/commit/c8f5f6f6f090b2354bc0a58d6b961b3c01caa245", "message": "fix tests", "committedDate": "2020-10-23T17:22:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUxMzgyNg==", "url": "https://github.com/apollographql/apollo-android/pull/2690#discussion_r511513826", "bodyText": "should we have 2 timeouts for connection and reading, looks like NSURLsession allows to set both:\nhttps://developer.apple.com/documentation/foundation/nsmutableurlrequest/1414063-timeoutinterval?language=objc\nhttps://developer.apple.com/documentation/foundation/nsurlsessionconfiguration/1408259-timeoutintervalforrequest?language=objc", "author": "sav007", "createdAt": "2020-10-24T21:00:04Z", "path": "apollo-runtime-kotlin/src/commonMain/kotlin/com/apollographql/apollo/network/http/ApolloHttpNetworkTransport.kt", "diffHunk": "@@ -8,5 +8,12 @@ import com.apollographql.apollo.network.NetworkTransport\n expect class ApolloHttpNetworkTransport constructor(\n     serverUrl: String,\n     headers: Map<String, String>,\n-    httpMethod: HttpMethod = HttpMethod.Post\n+    httpMethod: HttpMethod = HttpMethod.Post,\n+    /**\n+     * The timeout interval to use when waiting for additional data.\n+     *\n+     * - on iOS, it is used to set NSMutableURLRequest.timeoutInterval\n+     * - on Android, it is used to set both readTimeout and connectTimeout\n+     */\n+    timeoutMillis: Long = 30_000", "originalCommit": "c8f5f6f6f090b2354bc0a58d6b961b3c01caa245", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUxNzM4NA==", "url": "https://github.com/apollographql/apollo-android/pull/2690#discussion_r511517384", "bodyText": "\ud83d\udc4d I missed timeoutIntervalForRequest, will add that", "author": "martinbonnin", "createdAt": "2020-10-24T21:42:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUxMzgyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUxODQzMQ==", "url": "https://github.com/apollographql/apollo-android/pull/2690#discussion_r511518431", "bodyText": "Mmm, timeoutInterval is on NSMutableUrlRequest but timeoutIntervalForRequest is for NSUrlSession. I'm not sure we can have both at the same time?", "author": "martinbonnin", "createdAt": "2020-10-24T21:54:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUxMzgyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE3MjM1Nw==", "url": "https://github.com/apollographql/apollo-android/pull/2690#discussion_r516172357", "bodyText": "Looks like we can! I just pushed a few changes", "author": "martinbonnin", "createdAt": "2020-11-02T18:25:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUxMzgyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE4OTE1Nw==", "url": "https://github.com/apollographql/apollo-android/pull/2690#discussion_r516189157", "bodyText": "i'm not 100% sure the relation between timeoutInterval and timeoutIntervalForRequest. It might make sense to map everything to the same timeout on iOS. But on the other hand, having both is more flexible in terms of API so we can certainly keep it as it is, even if there's a small chance the concept do not map 1:1", "author": "martinbonnin", "createdAt": "2020-11-02T18:56:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUxMzgyNg=="}], "type": "inlineReview"}, {"oid": "3eaf7123e3dc87a17b264b91469a2e3a3b4d4b24", "url": "https://github.com/apollographql/apollo-android/commit/3eaf7123e3dc87a17b264b91469a2e3a3b4d4b24", "message": "use timeoutIntervalForRequest", "committedDate": "2020-11-02T18:10:37Z", "type": "commit"}, {"oid": "2f82784be702ad78496df7318a19537a8a115aaf", "url": "https://github.com/apollographql/apollo-android/commit/2f82784be702ad78496df7318a19537a8a115aaf", "message": "fix tests", "committedDate": "2020-11-03T22:29:57Z", "type": "commit"}]}