{"pr_number": 1916, "pr_title": "Generate Operation.Data toJson implementation", "pr_createdAt": "2020-01-18T22:26:54Z", "pr_url": "https://github.com/apollographql/apollo-android/pull/1916", "timeline": [{"oid": "a6b69b60315e2dd6083139546ddc2937f84136de", "url": "https://github.com/apollographql/apollo-android/commit/a6b69b60315e2dd6083139546ddc2937f84136de", "message": "Generate Operation.Data toJson implementation\n\nintroduce `toJson` API to make it easier to serialize `Operation.Data` response into Json.\n\nCloses https://github.com/apollographql/apollo-android/issues/1881", "committedDate": "2020-01-18T22:23:02Z", "type": "commit"}, {"oid": "b2a8ecd81f1e7eda08f03baf17ddd85add5e5b45", "url": "https://github.com/apollographql/apollo-android/commit/b2a8ecd81f1e7eda08f03baf17ddd85add5e5b45", "message": "Update generated test fixtures", "committedDate": "2020-01-18T22:27:18Z", "type": "commit"}, {"oid": "b2a8ecd81f1e7eda08f03baf17ddd85add5e5b45", "url": "https://github.com/apollographql/apollo-android/commit/b2a8ecd81f1e7eda08f03baf17ddd85add5e5b45", "message": "Update generated test fixtures", "committedDate": "2020-01-18T22:27:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI1MjU3Mw==", "url": "https://github.com/apollographql/apollo-android/pull/1916#discussion_r368252573", "bodyText": "Would it make sense to put this first since the other one overloads this function?", "author": "tasomaniac", "createdAt": "2020-01-18T22:37:50Z", "path": "apollo-api/src/main/java/com/apollographql/apollo/api/Operation.java", "diffHunk": "@@ -78,6 +78,59 @@\n      * @return {@link ResponseFieldMarshaller} to serialize operation data\n      */\n     ResponseFieldMarshaller marshaller();\n+\n+    /**\n+     * Serializes GraphQL operation response data into its equivalent Json representation.\n+     * For example:\n+     * <pre>{@code\n+     *    {\n+     *      \"data\": {\n+     *        \"allPlanets\": {\n+     *          \"__typename\": \"PlanetsConnection\",\n+     *          \"planets\": [\n+     *            {\n+     *              \"__typename\": \"Planet\",\n+     *              \"name\": \"Tatooine\",\n+     *              \"surfaceWater\": 1.0\n+     *            }\n+     *          ]\n+     *        }\n+     *      }\n+     *    }\n+     * }</pre>\n+     *\n+     * @param indent the indentation string to be repeated for each level of indentation in the encoded document. Must be a string\n+     * containing only whitespace,\n+     * @param scalarTypeAdapters configured instance of custom GraphQL scalar type adapters\n+     * @return json representation of GraphQL operation response\n+     */\n+    String toJson(@NotNull String indent, @NotNull ScalarTypeAdapters scalarTypeAdapters);\n+\n+    /**\n+     * Serializes GraphQL operation response data into its equivalent Json representation.\n+     * For example:\n+     * <pre>{@code\n+     *    {\n+     *      \"data\": {\n+     *        \"allPlanets\": {\n+     *          \"__typename\": \"PlanetsConnection\",\n+     *          \"planets\": [\n+     *            {\n+     *              \"__typename\": \"Planet\",\n+     *              \"name\": \"Tatooine\",\n+     *              \"surfaceWater\": 1.0\n+     *            }\n+     *          ]\n+     *        }\n+     *      }\n+     *    }\n+     * }</pre>\n+     *\n+     * @param indent the indentation string to be repeated for each level of indentation in the encoded document. Must be a string\n+     * containing only whitespace,\n+     * @return json representation of GraphQL operation response\n+     */\n+    String toJson(@NotNull String indent);", "originalCommit": "b2a8ecd81f1e7eda08f03baf17ddd85add5e5b45", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI1Mjg5MQ==", "url": "https://github.com/apollographql/apollo-android/pull/1916#discussion_r368252891", "bodyText": "I wonder if there is a way to move this implementation to somewhere we can share so that we don't have to duplicate in every class generated.\nIf we target Java8, then we could use default method implementations.", "author": "tasomaniac", "createdAt": "2020-01-18T22:45:46Z", "path": "apollo-compiler/src/test/graphql/com/example/union_inline_fragments/TestQuery.kt", "diffHunk": "@@ -410,6 +411,14 @@ class TestQuery : Query<TestQuery.Data, TestQuery.Data, Operation.Variables> {\n       }\n     }\n \n+    override fun toJson(indent: String): String = toJson(indent, DEFAULT)\n+\n+    override fun toJson(indent: String, scalarTypeAdapters: ScalarTypeAdapters): String {", "originalCommit": "b2a8ecd81f1e7eda08f03baf17ddd85add5e5b45", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8ffcf4657c261ce1b2ccd90a4b87845f308f2ada", "url": "https://github.com/apollographql/apollo-android/commit/8ffcf4657c261ce1b2ccd90a4b87845f308f2ada", "message": "Revert \"Update generated test fixtures\"\n\nThis reverts commit b2a8ecd8", "committedDate": "2020-01-20T02:58:45Z", "type": "commit"}, {"oid": "6dd861c71b134a5965a065b93691458e1f746e19", "url": "https://github.com/apollographql/apollo-android/commit/6dd861c71b134a5965a065b93691458e1f746e19", "message": "Revert changes and introduce `OperationDataJsonSerializer` instead", "committedDate": "2020-01-20T03:15:14Z", "type": "commit"}, {"oid": "6dd861c71b134a5965a065b93691458e1f746e19", "url": "https://github.com/apollographql/apollo-android/commit/6dd861c71b134a5965a065b93691458e1f746e19", "message": "Revert changes and introduce `OperationDataJsonSerializer` instead", "committedDate": "2020-01-20T03:15:14Z", "type": "forcePushed"}]}