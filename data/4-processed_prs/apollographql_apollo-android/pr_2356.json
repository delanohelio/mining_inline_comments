{"pr_number": 2356, "pr_title": "Introduce KN subscriptions", "pr_createdAt": "2020-06-11T15:33:11Z", "pr_url": "https://github.com/apollographql/apollo-android/pull/2356", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY1MzUzMg==", "url": "https://github.com/apollographql/apollo-android/pull/2356#discussion_r440653532", "bodyText": "Looks like requestUuid is specific to WebSockets, a bit similar to how headers are specific to Http. Should it be in an opaque ExecutionContext.Element ?", "author": "martinbonnin", "createdAt": "2020-06-16T07:49:43Z", "path": "apollo-runtime-kotlin/src/commonMain/kotlin/com/apollographql/apollo/interceptor/ApolloRequest.kt", "diffHunk": "@@ -4,10 +4,13 @@ import com.apollographql.apollo.api.ApolloExperimental\n import com.apollographql.apollo.api.ExecutionContext\n import com.apollographql.apollo.api.Operation\n import com.apollographql.apollo.api.ScalarTypeAdapters\n+import com.benasher44.uuid.uuid4\n \n @ApolloExperimental\n-class ApolloRequest<T> constructor(\n-    val operation: Operation<*, T, *>,\n+class ApolloRequest<D : Operation.Data>(\n+    val operation: Operation<D, D, *>,\n     val scalarTypeAdapters: ScalarTypeAdapters,\n-    val executionContext: ExecutionContext = ExecutionContext.Empty\n-)\n+    val executionContext: ExecutionContext\n+) {\n+  val requestUuid = uuid4()", "originalCommit": "4666e8851bc89b80b23cb0f860caa81401e7568d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjIwNzkzMw==", "url": "https://github.com/apollographql/apollo-android/pull/2356#discussion_r442207933", "bodyText": "I would leave it to be a pat of the request ApolloRequest object for the future as it gives a way to match request with the corresponding response by requestUuid. I feel it will be helpful if someone requires it in own custom interceptor implementation.", "author": "sav007", "createdAt": "2020-06-18T13:01:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY1MzUzMg=="}], "type": "inlineReview"}, {"oid": "ecdf4681dd6a1742ccbad8fc77295266bfa09624", "url": "https://github.com/apollographql/apollo-android/commit/ecdf4681dd6a1742ccbad8fc77295266bfa09624", "message": "Introduce KN subscriptions\n\n- Introduce new API `ApolloClient.subscribe` to execute subscriptions\n- Replace `GraphQLRequest.kt` / `GraphQLResponse.kt` with new `ApolloRequest.kt` / `ApolloResponse.kt`\n- Refactor `NetworkTransport` to execute `ApolloRequest` and return `ApolloResponse`\n- Move `ApolloHttpNetworkTransport` and everything related to own package `http`\n\nAs side effect of this refactoring is that on iOS parsing now is done on background thread.\n\nPart of https://github.com/apollographql/apollo-android/issues/2222", "committedDate": "2020-06-22T22:04:22Z", "type": "commit"}, {"oid": "0811bfa9a8372cb9ecdbeae601a366f22177589a", "url": "https://github.com/apollographql/apollo-android/commit/0811bfa9a8372cb9ecdbeae601a366f22177589a", "message": "Make `ApolloWebSocketNetworkTransportTest` to be common", "committedDate": "2020-06-22T22:04:25Z", "type": "commit"}, {"oid": "0f51fbee38478a2052acd59f79bf22a0eee8fedf", "url": "https://github.com/apollographql/apollo-android/commit/0f51fbee38478a2052acd59f79bf22a0eee8fedf", "message": "Introduce auto disconnect the socket connection after timeout", "committedDate": "2020-06-22T22:04:25Z", "type": "commit"}, {"oid": "2c313dd97241fb71901af742de3c44c9616d12dc", "url": "https://github.com/apollographql/apollo-android/commit/2c313dd97241fb71901af742de3c44c9616d12dc", "message": "Update default timeouts", "committedDate": "2020-06-22T22:04:25Z", "type": "commit"}, {"oid": "d1cec46bea708b1dc700c6ce50e1ef6f30cb3787", "url": "https://github.com/apollographql/apollo-android/commit/d1cec46bea708b1dc700c6ce50e1ef6f30cb3787", "message": "Remove garbage", "committedDate": "2020-06-22T22:04:25Z", "type": "commit"}, {"oid": "d1cec46bea708b1dc700c6ce50e1ef6f30cb3787", "url": "https://github.com/apollographql/apollo-android/commit/d1cec46bea708b1dc700c6ce50e1ef6f30cb3787", "message": "Remove garbage", "committedDate": "2020-06-22T22:04:25Z", "type": "forcePushed"}, {"oid": "ab1d1231f3a0762d17df09d40787c6206f07895f", "url": "https://github.com/apollographql/apollo-android/commit/ab1d1231f3a0762d17df09d40787c6206f07895f", "message": "Fix test", "committedDate": "2020-06-23T00:42:12Z", "type": "commit"}]}