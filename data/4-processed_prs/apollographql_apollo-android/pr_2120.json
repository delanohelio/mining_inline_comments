{"pr_number": 2120, "pr_title": "[Gradle Plugin] Support Kotlin multiplatform", "pr_createdAt": "2020-03-29T17:01:22Z", "pr_url": "https://github.com/apollographql/apollo-android/pull/2120", "timeline": [{"oid": "789fd5b7f46cceba9670b9f2a5aca8187e81ae96", "url": "https://github.com/apollographql/apollo-android/commit/789fd5b7f46cceba9670b9f2a5aca8187e81ae96", "message": "Support Multiplatform projects on Apollo Gradle Plugin", "committedDate": "2020-03-29T15:35:58Z", "type": "commit"}, {"oid": "be04f17a0c2fc0de29e556f8f2831ffc99ffc8b1", "url": "https://github.com/apollographql/apollo-android/commit/be04f17a0c2fc0de29e556f8f2831ffc99ffc8b1", "message": "Support Multiplatform typealias classes explicitly", "committedDate": "2020-03-29T16:25:14Z", "type": "commit"}, {"oid": "307f89f5751db815a68ff2e68d61bdfa75527c4f", "url": "https://github.com/apollographql/apollo-android/commit/307f89f5751db815a68ff2e68d61bdfa75527c4f", "message": "Set Gradle memory for composite builds", "committedDate": "2020-03-29T16:25:41Z", "type": "commit"}, {"oid": "132839a722d6b5ba7e8015ba79a8fb62eba5a22c", "url": "https://github.com/apollographql/apollo-android/commit/132839a722d6b5ba7e8015ba79a8fb62eba5a22c", "message": "Update test fixtures regarding import changes", "committedDate": "2020-03-29T20:23:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0Njk5MQ==", "url": "https://github.com/apollographql/apollo-android/pull/2120#discussion_r403346991", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            val MULTIPLATFORM_THROWS = ClassName.bestGuess(\"com.apollographql.apollo.api.internal.Throws\")\n          \n          \n            \n            private val MULTIPLATFORM_THROWS = ClassName(\"com.apollographql.apollo.api.internal\", \"Throws\")\n          \n      \n    \n    \n  \n\nbestGuess works the same but the \"guess\" part is a bit misleading as it implies this might fail (while it won't)", "author": "martinbonnin", "createdAt": "2020-04-03T21:33:08Z", "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/codegen/kotlin/KotlinCodeGenUtil.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package com.apollographql.apollo.compiler.codegen.kotlin\n+\n+import com.squareup.kotlinpoet.AnnotationSpec\n+import com.squareup.kotlinpoet.ClassName\n+import com.squareup.kotlinpoet.FunSpec\n+\n+val MULTIPLATFORM_THROWS = ClassName.bestGuess(\"com.apollographql.apollo.api.internal.Throws\")", "originalCommit": "132839a722d6b5ba7e8015ba79a8fb62eba5a22c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQwODAxNg==", "url": "https://github.com/apollographql/apollo-android/pull/2120#discussion_r403408016", "bodyText": "I didn't see the constructor when writing this. \ud83d\ude0a", "author": "tasomaniac", "createdAt": "2020-04-04T01:53:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0Njk5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0NzA1NQ==", "url": "https://github.com/apollographql/apollo-android/pull/2120#discussion_r403347055", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            val MULTIPLATFORM_IO_EXCEPTION = ClassName.bestGuess(\"okio.IOException\")\n          \n          \n            \n            private val MULTIPLATFORM_IO_EXCEPTION = ClassName(\"okio\", \"IOException\")", "author": "martinbonnin", "createdAt": "2020-04-03T21:33:19Z", "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/codegen/kotlin/KotlinCodeGenUtil.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package com.apollographql.apollo.compiler.codegen.kotlin\n+\n+import com.squareup.kotlinpoet.AnnotationSpec\n+import com.squareup.kotlinpoet.ClassName\n+import com.squareup.kotlinpoet.FunSpec\n+\n+val MULTIPLATFORM_THROWS = ClassName.bestGuess(\"com.apollographql.apollo.api.internal.Throws\")\n+val MULTIPLATFORM_IO_EXCEPTION = ClassName.bestGuess(\"okio.IOException\")", "originalCommit": "132839a722d6b5ba7e8015ba79a8fb62eba5a22c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM1MDEzNg==", "url": "https://github.com/apollographql/apollo-android/pull/2120#discussion_r403350136", "bodyText": "\ud83d\udc4d  very nice to have that by default !", "author": "martinbonnin", "createdAt": "2020-04-03T21:41:31Z", "path": "apollo-gradle-plugin/src/main/kotlin/com/apollographql/apollo/gradle/internal/DefaultCompilationUnit.kt", "diffHunk": "@@ -104,12 +105,13 @@ abstract class DefaultCompilationUnit @Inject constructor(\n     }\n   }\n \n-  fun generateKotlinModels(): Boolean {\n-    return generateKotlinModels.orElse(service.generateKotlinModels).orElse(apolloExtension.generateKotlinModels).getOrElse(false)\n+  fun generateKotlinModels(): Boolean = when {\n+    project.isKotlinMultiplatform -> true", "originalCommit": "789fd5b7f46cceba9670b9f2a5aca8187e81ae96", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "df93de41bbcbdbcfdedd56860f4a3597e7b88a54", "url": "https://github.com/apollographql/apollo-android/commit/df93de41bbcbdbcfdedd56860f4a3597e7b88a54", "message": "add a multiplatform ios test", "committedDate": "2020-04-03T22:48:00Z", "type": "commit"}, {"oid": "9ce71106742ce7aeb588ebd9005b446a9aa62089", "url": "https://github.com/apollographql/apollo-android/commit/9ce71106742ce7aeb588ebd9005b446a9aa62089", "message": "Apply suggestions from code review\n\nCo-Authored-By: Martin Bonnin <martin@mbonnin.net>", "committedDate": "2020-04-04T01:51:52Z", "type": "commit"}]}