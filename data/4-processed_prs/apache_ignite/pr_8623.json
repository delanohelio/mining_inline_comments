{"pr_number": 8623, "pr_title": "IGNITE-13895: SSL usage in ducktape tests", "pr_createdAt": "2020-12-29T12:39:51Z", "pr_url": "https://github.com/apache/ignite/pull/8623", "timeline": [{"oid": "0d1056fa3ed63ce59b9f27d11dd01d0dcc11a3bf", "url": "https://github.com/apache/ignite/commit/0d1056fa3ed63ce59b9f27d11dd01d0dcc11a3bf", "message": "IGNITE-13895: added util mkcerts.sh", "committedDate": "2020-12-24T08:30:16Z", "type": "commit"}, {"oid": "3a70bb3ac36bcc0be2813d7dd406ac95fcf35d8c", "url": "https://github.com/apache/ignite/commit/3a70bb3ac36bcc0be2813d7dd406ac95fcf35d8c", "message": "IGNITE-13895: added util mkcerts.sh", "committedDate": "2020-12-24T09:13:36Z", "type": "commit"}, {"oid": "f34506ad42cb01b6e8cec0d2f3c246899ba3fe70", "url": "https://github.com/apache/ignite/commit/f34506ad42cb01b6e8cec0d2f3c246899ba3fe70", "message": "Merge remote-tracking branch 'ignite/ignite-ducktape' into IGNITE-13895", "committedDate": "2020-12-25T08:49:11Z", "type": "commit"}, {"oid": "f1e570dbf96066830430442998e31bec7696447f", "url": "https://github.com/apache/ignite/commit/f1e570dbf96066830430442998e31bec7696447f", "message": "IGNITE-13895: fix", "committedDate": "2020-12-28T13:32:04Z", "type": "commit"}, {"oid": "47e0580a57eb2c2ac582f719196819f4bd13f79c", "url": "https://github.com/apache/ignite/commit/47e0580a57eb2c2ac582f719196819f4bd13f79c", "message": "IGNITE-13895: fix", "committedDate": "2020-12-29T09:17:48Z", "type": "commit"}, {"oid": "604e02ba52ab743620c984dd040f888d78442637", "url": "https://github.com/apache/ignite/commit/604e02ba52ab743620c984dd040f888d78442637", "message": "IGNITE-13895: added ssl_test", "committedDate": "2020-12-29T11:27:15Z", "type": "commit"}, {"oid": "fb85bd4a9928639f02da1a2ad0893a5973175bf9", "url": "https://github.com/apache/ignite/commit/fb85bd4a9928639f02da1a2ad0893a5973175bf9", "message": "IGNITE-13895: little fix", "committedDate": "2020-12-29T12:40:30Z", "type": "commit"}, {"oid": "0ac1a048dd7940450153f9a55d3e548c92127766", "url": "https://github.com/apache/ignite/commit/0ac1a048dd7940450153f9a55d3e548c92127766", "message": "IGNITE-13895: fix control_utility.py", "committedDate": "2020-12-29T13:27:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTcwMTAxNA==", "url": "https://github.com/apache/ignite/pull/8623#discussion_r549701014", "bodyText": "Please check bash checkstyle with Inteliij IDEA plugin. It will write down all possible issues. At least ${PSWD} must be in quotes, as it can contain special symbols like &.", "author": "timoninmaxim", "createdAt": "2020-12-29T13:16:51Z", "path": "modules/ducktests/tests/certs/functions.sh", "diffHunk": "@@ -0,0 +1,92 @@\n+#!/usr/bin/env bash\n+\n+function makeRoot() {\n+    ALIAS=$1\n+    DNAME=$2\n+    PSWD=$3\n+\n+    if [[ ${ALIAS} == \"\" ]] || [[ ${DNAME} == \"\" ]] || [[ ${PSWD} == \"\" ]]\n+    then\n+        error \"makeRoot: Need ALIAS, DNAME, PSWD\"\n+    fi\n+\n+    rm ${ALIAS}.jks\n+    rm ${ALIAS}.pem\n+\n+    keytool -genkeypair -keystore ${ALIAS}.jks -alias ${ALIAS} -dname \"${DNAME}\" -ext bc:c -storepass ${PSWD} \\", "originalCommit": "fb85bd4a9928639f02da1a2ad0893a5973175bf9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTgwODAxNw==", "url": "https://github.com/apache/ignite/pull/8623#discussion_r559808017", "bodyText": "fixed", "author": "Sega76", "createdAt": "2021-01-18T21:49:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTcwMTAxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTcwMzYzMA==", "url": "https://github.com/apache/ignite/pull/8623#discussion_r549703630", "bodyText": "This is mechanism for docker env. How is it going to be distributed on real nodes on Jenkins?", "author": "timoninmaxim", "createdAt": "2020-12-29T13:25:37Z", "path": "modules/ducktests/tests/docker/run_tests.sh", "diffHunk": "@@ -158,5 +158,7 @@ if [[ -n \"$MAX_PARALLEL\" ]]; then\n   DUCKTAPE_OPTIONS=\"$DUCKTAPE_OPTIONS --max-parallel $MAX_PARALLEL\"\n fi\n \n+\"$SCRIPT_DIR\"/../certs/mkcerts.sh", "originalCommit": "fb85bd4a9928639f02da1a2ad0893a5973175bf9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTgwODA2MQ==", "url": "https://github.com/apache/ignite/pull/8623#discussion_r559808061", "bodyText": "first certificates are generated, then copied to the nodes", "author": "Sega76", "createdAt": "2021-01-18T21:49:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTcwMzYzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTcwNDYwOA==", "url": "https://github.com/apache/ignite/pull/8623#discussion_r549704608", "bodyText": "Password 123456 is a magic variable. Are there any alternatives? Config, global variable, param, or smth else?\nAt least setting global variable in run_tests.sh looks better.", "author": "timoninmaxim", "createdAt": "2020-12-29T13:28:31Z", "path": "modules/ducktests/tests/ignitetest/services/utils/control_utility.py", "diffHunk": "@@ -31,9 +31,17 @@ class ControlUtility:\n     \"\"\"\n     BASE_COMMAND = \"control.sh\"\n \n-    def __init__(self, cluster, text_context):\n+    def __init__(self, cluster,\n+                 key_store_jks: str = None, key_store_pwd: str = \"123456\",", "originalCommit": "fb85bd4a9928639f02da1a2ad0893a5973175bf9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTgwODE0MA==", "url": "https://github.com/apache/ignite/pull/8623#discussion_r559808140", "bodyText": "fixed", "author": "Sega76", "createdAt": "2021-01-18T21:49:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTcwNDYwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTcwNzU0NA==", "url": "https://github.com/apache/ignite/pull/8623#discussion_r549707544", "bodyText": "Actually do we need check of LATEST versions?", "author": "timoninmaxim", "createdAt": "2020-12-29T13:37:58Z", "path": "modules/ducktests/tests/ignitetest/tests/ssl_test.py", "diffHunk": "@@ -0,0 +1,70 @@\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#    http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\"\"\"\n+This module contains ssl tests.\n+\"\"\"\n+from ignitetest.services.ignite import IgniteService\n+from ignitetest.services.ignite_app import IgniteApplicationService\n+from ignitetest.services.utils.control_utility import ControlUtility\n+from ignitetest.services.utils.ignite_configuration import IgniteConfiguration, SslContextFactory\n+from ignitetest.services.utils.ignite_configuration.connector_configuration import ConnectorConfiguration\n+from ignitetest.services.utils.ignite_configuration.discovery import from_ignite_cluster\n+from ignitetest.utils import ignite_versions, cluster\n+from ignitetest.utils.ignite_test import IgniteTest\n+from ignitetest.utils.version import DEV_BRANCH, IgniteVersion, LATEST_2_9, LATEST_2_8\n+\n+\n+# pylint: disable=W0223\n+class SslTest(IgniteTest):\n+    \"\"\"\n+    Ssl test.\n+    \"\"\"\n+    @cluster(num_nodes=3)\n+    @ignite_versions(str(DEV_BRANCH), str(LATEST_2_9), str(LATEST_2_8))", "originalCommit": "0ac1a048dd7940450153f9a55d3e548c92127766", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTgwODY5OA==", "url": "https://github.com/apache/ignite/pull/8623#discussion_r559808698", "bodyText": "I think yes, these versions are now used", "author": "Sega76", "createdAt": "2021-01-18T21:51:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTcwNzU0NA=="}], "type": "inlineReview"}, {"oid": "93a15821a0b45d0107b341ad9d308fb1a0d3efc5", "url": "https://github.com/apache/ignite/commit/93a15821a0b45d0107b341ad9d308fb1a0d3efc5", "message": "IGNITE-13895: use globals on ControlUtility, SslContextFactory", "committedDate": "2020-12-30T15:55:31Z", "type": "commit"}, {"oid": "a86973cf9ac0f72a21e59278b3cdffa87f8e5cff", "url": "https://github.com/apache/ignite/commit/a86973cf9ac0f72a21e59278b3cdffa87f8e5cff", "message": "IGNITE-13895: use globals on ControlUtility, SslContextFactory", "committedDate": "2021-01-15T10:51:09Z", "type": "commit"}, {"oid": "2c231413e1324ef8a7895a9dee00789a80d0fbe4", "url": "https://github.com/apache/ignite/commit/2c231413e1324ef8a7895a9dee00789a80d0fbe4", "message": "IGNITE-13895: use globals on ControlUtility, SslContextFactory", "committedDate": "2021-01-15T13:01:13Z", "type": "commit"}, {"oid": "3d3e928678bdf13a9349091427047930cc963788", "url": "https://github.com/apache/ignite/commit/3d3e928678bdf13a9349091427047930cc963788", "message": "IGNITE-13895: fix IgnitePathAware#certificate_dir", "committedDate": "2021-01-15T14:03:40Z", "type": "commit"}, {"oid": "50b442f68bb4b51fe6c0f6ab5d96ddbcfb66a1df", "url": "https://github.com/apache/ignite/commit/50b442f68bb4b51fe6c0f6ab5d96ddbcfb66a1df", "message": "IGNITE-13895: fix IgniteAwareService", "committedDate": "2021-01-15T15:54:33Z", "type": "commit"}, {"oid": "737d627dcf5ea384ada3421d9f33b2ef0399f82c", "url": "https://github.com/apache/ignite/commit/737d627dcf5ea384ada3421d9f33b2ef0399f82c", "message": "IGNITE-13895: little fix", "committedDate": "2021-01-15T19:43:01Z", "type": "commit"}, {"oid": "c7584c573bb9b525f42066e2d89b65c8670fe8c2", "url": "https://github.com/apache/ignite/commit/c7584c573bb9b525f42066e2d89b65c8670fe8c2", "message": "IGNITE-13895: fix ssl_factory.py", "committedDate": "2021-01-18T20:49:14Z", "type": "commit"}, {"oid": "bd517ce7f222fb3a450b326419db61f8b4f58011", "url": "https://github.com/apache/ignite/commit/bd517ce7f222fb3a450b326419db61f8b4f58011", "message": "IGNITE-13895: fix path.py", "committedDate": "2021-01-18T20:59:36Z", "type": "commit"}, {"oid": "32dcee9952619925bc00dbcc21524ea34b8e2cbc", "url": "https://github.com/apache/ignite/commit/32dcee9952619925bc00dbcc21524ea34b8e2cbc", "message": "IGNITE-13895: fix mkcerts.sh, functions.sh", "committedDate": "2021-01-18T21:39:18Z", "type": "commit"}, {"oid": "7ee8ea01fd95fbd33c66cec313cbda4dfc38dc0f", "url": "https://github.com/apache/ignite/commit/7ee8ea01fd95fbd33c66cec313cbda4dfc38dc0f", "message": "IGNITE-13895: fix functions.sh", "committedDate": "2021-01-18T21:46:31Z", "type": "commit"}, {"oid": "3d40e9e6bb18a9b950932914ecdda263fe7991e8", "url": "https://github.com/apache/ignite/commit/3d40e9e6bb18a9b950932914ecdda263fe7991e8", "message": "IGNITE-13895: little fix", "committedDate": "2021-01-19T09:43:58Z", "type": "commit"}, {"oid": "7e890381d983ed35d783a77cd6198e88349de38d", "url": "https://github.com/apache/ignite/commit/7e890381d983ed35d783a77cd6198e88349de38d", "message": "IGNITE-13895: little fix path.py", "committedDate": "2021-01-19T10:00:00Z", "type": "commit"}, {"oid": "ac970fbf832b59d1579bd04a629e0eee50cd3780", "url": "https://github.com/apache/ignite/commit/ac970fbf832b59d1579bd04a629e0eee50cd3780", "message": "IGNITE-13895: added DEFAULT_SERVER_KEYSTORE, DEFAULT_CLIENT_KEYSTORE, DEFAULT_ADMIN_KEYSTORE", "committedDate": "2021-01-20T13:32:15Z", "type": "commit"}, {"oid": "f0be4d23745eda00f6c0fa143a9222c64bd39c7f", "url": "https://github.com/apache/ignite/commit/f0be4d23745eda00f6c0fa143a9222c64bd39c7f", "message": "IGNITE-13895: added the use of global parameters to configure the ssl", "committedDate": "2021-01-20T23:14:14Z", "type": "commit"}, {"oid": "21a7c80a11ee32f266b037f380a5d50322a7bbdc", "url": "https://github.com/apache/ignite/commit/21a7c80a11ee32f266b037f380a5d50322a7bbdc", "message": "IGNITE-13895: fix _update_ssl_config", "committedDate": "2021-01-21T00:39:30Z", "type": "commit"}, {"oid": "3731685ca7f2cecdb63e0d476ec213b42337ef96", "url": "https://github.com/apache/ignite/commit/3731685ca7f2cecdb63e0d476ec213b42337ef96", "message": "IGNITE-13895: debug", "committedDate": "2021-01-21T01:13:52Z", "type": "commit"}, {"oid": "5871a17c9e2da68bb2f3ea7b367e89d049cf3c60", "url": "https://github.com/apache/ignite/commit/5871a17c9e2da68bb2f3ea7b367e89d049cf3c60", "message": "IGNITE-13895: debug", "committedDate": "2021-01-21T08:12:54Z", "type": "commit"}, {"oid": "fb78a3a0c5de0e9032e21f574f36e5973b9b9087", "url": "https://github.com/apache/ignite/commit/fb78a3a0c5de0e9032e21f574f36e5973b9b9087", "message": "IGNITE-13895: fix control_utility.py", "committedDate": "2021-01-21T09:20:30Z", "type": "commit"}, {"oid": "0aaee328990edb45931ca0f8a1be50ae69621c43", "url": "https://github.com/apache/ignite/commit/0aaee328990edb45931ca0f8a1be50ae69621c43", "message": "IGNITE-13895: added @ignore_if(lambda version, globals: ...)", "committedDate": "2021-01-21T15:00:18Z", "type": "commit"}, {"oid": "61fd7915af655c896fa1338a02e94f560973c09c", "url": "https://github.com/apache/ignite/commit/61fd7915af655c896fa1338a02e94f560973c09c", "message": "IGNITE-13895: removed @version_if", "committedDate": "2021-01-21T15:24:10Z", "type": "commit"}, {"oid": "73408db4d2ffd1e910742ca2d5f23e2e920d0a84", "url": "https://github.com/apache/ignite/commit/73408db4d2ffd1e910742ca2d5f23e2e920d0a84", "message": "IGNITE-13895: fix pydock", "committedDate": "2021-01-21T16:58:45Z", "type": "commit"}, {"oid": "8cc88022321a5975d292b355697a61dd1ac46159", "url": "https://github.com/apache/ignite/commit/8cc88022321a5975d292b355697a61dd1ac46159", "message": "IGNITE-13895: added the ability to pass key_store_path, trust_store_path for server, client, admin through global parameters", "committedDate": "2021-01-24T14:11:05Z", "type": "commit"}, {"oid": "f259ad40a31e99a1984244466748cd81eed22d0c", "url": "https://github.com/apache/ignite/commit/f259ad40a31e99a1984244466748cd81eed22d0c", "message": "IGNITE-13895: fix comments", "committedDate": "2021-01-24T15:28:55Z", "type": "commit"}, {"oid": "6ef59cebffc330ea858f765c05969dd9ed029acc", "url": "https://github.com/apache/ignite/commit/6ef59cebffc330ea858f765c05969dd9ed029acc", "message": "IGNITE-13895: fixed pydock connector_configuration.py", "committedDate": "2021-01-25T12:27:32Z", "type": "commit"}, {"oid": "5269416901a18b507738d2e59983160d8cde8df8", "url": "https://github.com/apache/ignite/commit/5269416901a18b507738d2e59983160d8cde8df8", "message": "Merge remote-tracking branch 'ignite/ignite-ducktape' into IGNITE-13895\n\n# Conflicts:\n#\tmodules/ducktests/tests/ignitetest/services/utils/ignite_aware.py", "committedDate": "2021-01-29T12:00:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NzYxMjMyNA==", "url": "https://github.com/apache/ignite/pull/8623#discussion_r567612324", "bodyText": "Why this change?", "author": "nizhikov", "createdAt": "2021-02-01T07:36:19Z", "path": "modules/ducktests/tests/ignitetest/services/ignite_app.py", "diffHunk": "@@ -16,14 +16,14 @@\n \"\"\"\n This module contains the base class to build Ignite aware application written on java.\n \"\"\"\n-", "originalCommit": "5269416901a18b507738d2e59983160d8cde8df8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}