{"pr_number": 8071, "pr_title": "Make ducktape work with ISE / ISP", "pr_createdAt": "2020-07-22T15:45:35Z", "pr_url": "https://github.com/apache/ignite/pull/8071", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI2MDI2NA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459260264", "bodyText": "Use .j2 file extension", "author": "timoninmaxim", "createdAt": "2020-07-23T07:25:11Z", "path": "modules/ducktests/tests/ignitetest/services/utils/config/ignite-client.xml.tmpl", "diffHunk": "@@ -0,0 +1,17 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "originalCommit": "4f11d0bbb6e34b6cd625c846f7b22d4d2d1bd789", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI2MDQxNA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459260414", "bodyText": "Use signle template for client/server", "author": "timoninmaxim", "createdAt": "2020-07-23T07:25:32Z", "path": "modules/ducktests/tests/ignitetest/services/utils/config/ignite-client.xml.tmpl", "diffHunk": "@@ -0,0 +1,17 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+", "originalCommit": "4f11d0bbb6e34b6cd625c846f7b22d4d2d1bd789", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI2MDUxOQ==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459260519", "bodyText": "hasattr never returns None", "author": "timoninmaxim", "createdAt": "2020-07-23T07:25:52Z", "path": "modules/ducktests/tests/ignitetest/version.py", "diffHunk": "@@ -56,14 +58,17 @@ def get_version(node=None):\n     Return the version attached to the given node.\n     Default to DEV_BRANCH if node or node.version is undefined (aka None)\n     \"\"\"\n-    if node is not None and hasattr(node, \"version\") and node.version is not None:\n-        return node.version\n-    else:\n-        return DEV_BRANCH\n+    if isinstance(node, ClusterNode) and hasattr(node, 'version') is not None:", "originalCommit": "4f11d0bbb6e34b6cd625c846f7b22d4d2d1bd789", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI4NDU4MA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459284580", "bodyText": "I believe that there is no need to  add .gitignore here at all.\nAnd I strongly advice you to use virtualenvwrapper in order do maintain different venv's.\nIt is recommended way in python community to use venv's in developer's environment.\nIf you used it it would not be necessary add something to .gitignore.", "author": "ivandasch", "createdAt": "2020-07-23T08:16:00Z", "path": "modules/ducktests/.gitignore", "diffHunk": "@@ -0,0 +1,2 @@\n+tests/venv/", "originalCommit": "4f11d0bbb6e34b6cd625c846f7b22d4d2d1bd789", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI4NDgxNA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459284814", "bodyText": "s/bases on/is based on/", "author": "ivandasch", "createdAt": "2020-07-23T08:16:26Z", "path": "modules/ducktests/tests/README.md", "diffHunk": "@@ -0,0 +1,14 @@\n+## Overview\n+The `ignitetest` framework provides basic functionality and services\n+to write integration tests for Apache Ignite. This framework bases on ", "originalCommit": "4f11d0bbb6e34b6cd625c846f7b22d4d2d1bd789", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMwNTE4Ng==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459305186", "bodyText": "I agree and tried use passive voice but Intellij Idea recommends to use active voice here.", "author": "timoninmaxim", "createdAt": "2020-07-23T08:53:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI4NDgxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI4NjMxMQ==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459286311", "bodyText": "s/an docker image/a docker image/\nAnd is it correct that ducktape uses image? It uses a bunch of running containers, based on this image.\nI think, that \"Build a docker image for running tests.\" is a little bit better.", "author": "ivandasch", "createdAt": "2020-07-23T08:19:24Z", "path": "modules/ducktests/tests/docker/ducker-ignite", "diffHunk": "@@ -60,11 +60,18 @@ Usage: ${script_path} [command] [options]\n help|-h|--help\n     Display this help message\n \n-up [-n|--num-nodes NUM_NODES] [-f|--force] [docker-image]\n-        [-C|--custom-ducktape DIR] [-e|--expose-ports ports]\n+build [-j|--jdk JDK] [image-name]\n+    Build an docker image that ducktape uses to up cluster. Image is tagged with specified ${image_name}.", "originalCommit": "4f11d0bbb6e34b6cd625c846f7b22d4d2d1bd789", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMxNTg2MA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459315860", "bodyText": "I see such pipeline: build - up - run. Tests are running on containers on final stage while image is used on \"up\" stage. I think I should make replacement to make it clearer. Other docs use term \"node\", so let's use it too:\n\ndocker image that ducktape uses to up cluster.\n\nto\n\ndocker image that represents a ducker node.", "author": "timoninmaxim", "createdAt": "2020-07-23T09:13:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI4NjMxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMxODQyNA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459318424", "bodyText": "Please check, is it ok now?", "author": "timoninmaxim", "createdAt": "2020-07-23T09:18:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI4NjMxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI4NzMwOA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459287308", "bodyText": "I think that \"for ducktest's docker image\" is better.", "author": "ivandasch", "createdAt": "2020-07-23T08:21:18Z", "path": "modules/ducktests/tests/docker/ducker-ignite", "diffHunk": "@@ -75,6 +82,9 @@ up [-n|--num-nodes NUM_NODES] [-f|--force] [docker-image]\n     or a combination of port/port-range separated by comma (like 2181,9092 or 2181,5005-5008).\n     By default no port is exposed. See README.md for more detail on this option.\n \n+    If --jdk is specified then we will use this argument as base image for ducker docker images.", "originalCommit": "4f11d0bbb6e34b6cd625c846f7b22d4d2d1bd789", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9070540ad8548e993d753c7a0d14091a9e9f47a2", "url": "https://github.com/apache/ignite/commit/9070540ad8548e993d753c7a0d14091a9e9f47a2", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-23T12:17:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTQ2MjQyOQ==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459462429", "bodyText": "relocated.", "author": "anton-vinogradov", "createdAt": "2020-07-23T13:48:38Z", "path": "modules/ducktests/tests/README.md", "diffHunk": "@@ -0,0 +1,14 @@\n+## Overview\n+The `ignitetest` framework provides basic functionality and services\n+to write integration tests for Apache Ignite. This framework bases on \n+the `ducktape` test framework, for information about it check the links:\n+- https://github.com/confluentinc/ducktape - source code of the `ducktape`;\n+- http://ducktape-docs.readthedocs.io - documentation to the `ducktape`.\n+\n+Structure of the `ignitetest` directory is:\n+- `./ignitetest/services` contains basic services functionality;\n+- `./ignitetest/version.py` contains utils for versioning;", "originalCommit": "9070540ad8548e993d753c7a0d14091a9e9f47a2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9448d90804c906aa241e5a258ce61955827747d3", "url": "https://github.com/apache/ignite/commit/9448d90804c906aa241e5a258ce61955827747d3", "message": "Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-23T14:01:52Z", "type": "commit"}, {"oid": "2fcb5779e0983e093271444b8b3ad41e9b160658", "url": "https://github.com/apache/ignite/commit/2fcb5779e0983e093271444b8b3ad41e9b160658", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-23T14:01:54Z", "type": "commit"}, {"oid": "0dc8d757f254187802f3d83e0bc37df3f050fadb", "url": "https://github.com/apache/ignite/commit/0dc8d757f254187802f3d83e0bc37df3f050fadb", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-23T14:01:54Z", "type": "commit"}, {"oid": "f33e1ed2a9051f9c441468923c512e0368ee969c", "url": "https://github.com/apache/ignite/commit/f33e1ed2a9051f9c441468923c512e0368ee969c", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-23T14:43:43Z", "type": "commit"}, {"oid": "830c07c56de5d574bf5b4d87070a88478ea56269", "url": "https://github.com/apache/ignite/commit/830c07c56de5d574bf5b4d87070a88478ea56269", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-23T14:43:50Z", "type": "forcePushed"}, {"oid": "b03c2bcb5fc2694b918e1559deb4bd5c4344f04f", "url": "https://github.com/apache/ignite/commit/b03c2bcb5fc2694b918e1559deb4bd5c4344f04f", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-23T14:46:00Z", "type": "commit"}, {"oid": "b03c2bcb5fc2694b918e1559deb4bd5c4344f04f", "url": "https://github.com/apache/ignite/commit/b03c2bcb5fc2694b918e1559deb4bd5c4344f04f", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-23T14:46:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkzMjczMg==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459932732", "bodyText": "Can we resolve this inside IgnitePath?", "author": "anton-vinogradov", "createdAt": "2020-07-24T08:58:24Z", "path": "modules/ducktests/tests/ignitetest/services/utils/ignite_aware.py", "diffHunk": "@@ -44,11 +44,20 @@ class IgniteAwareService(BackgroundThreadService):\n     def __init__(self, context, num_nodes, version, properties):\n         super(IgniteAwareService, self).__init__(context, num_nodes)\n \n+        if 'project' in context.globals:\n+            self.path = IgnitePath(context.globals['project'])\n+        else:\n+            self.path = IgnitePath()", "originalCommit": "b03c2bcb5fc2694b918e1559deb4bd5c4344f04f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA1MDg1MA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460050850", "bodyText": "We can just call IgnitePath(context.globals.get('project'))\nGet returns None by default when key is absent.", "author": "ivandasch", "createdAt": "2020-07-24T13:26:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkzMjczMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA1NzY2Ng==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460057666", "bodyText": "Anyway, we should do it inside IgnitePath to solve possible duplications in the future.", "author": "anton-vinogradov", "createdAt": "2020-07-24T13:39:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkzMjczMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUzMTQ2Nw==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460531467", "bodyText": "fixed", "author": "timoninmaxim", "createdAt": "2020-07-26T14:01:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkzMjczMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3OTMxOA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r459979318", "bodyText": "Let's just pass _DUCKTAPE_OPTIONS (btw, what's the reason to start a variable name with _?)", "author": "anton-vinogradov", "createdAt": "2020-07-24T10:43:02Z", "path": "modules/ducktests/tests/docker/run_tests.sh", "diffHunk": "@@ -16,15 +16,29 @@\n # limitations under the License.\n \n SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n+\n+# Num of containers that ducktape will prepare for tests\n IGNITE_NUM_CONTAINERS=${IGNITE_NUM_CONTAINERS:-11}\n+# Path for tests to start\n TC_PATHS=${TC_PATHS:-./ignitetest/}\n+# Docker image name that ducktape will use to prepare containers\n+IMAGE_NAME=${IMAGE_NAME}\n \n die() {\n     echo $@\n     exit 1\n }\n \n if ${SCRIPT_DIR}/ducker-ignite ssh | grep -q '(none)'; then\n-    ${SCRIPT_DIR}/ducker-ignite up -n \"${IGNITE_NUM_CONTAINERS}\" || die \"ducker-ignite up failed\"\n+    # If image name is specified that skip build and just pull it\n+    if [ \"$IMAGE_NAME\" != \"\" ]; then\n+      IMAGE_NAME=\" --skip-build-image $IMAGE_NAME\"\n+    fi\n+    ${SCRIPT_DIR}/ducker-ignite up -n \"${IGNITE_NUM_CONTAINERS}\" ${IMAGE_NAME} || die \"ducker-ignite up failed\"\n+fi\n+\n+if [ \"$VERSION\" != \"\" ]; then\n+  export _DUCKTAPE_OPTIONS=\"$_DUCKTAPE_OPTIONS --parameters '{\\\"version\\\":\\\"${VERSION}\\\"}'\"", "originalCommit": "b03c2bcb5fc2694b918e1559deb4bd5c4344f04f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAzNjk1Mw==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460036953", "bodyText": "I've just reuse this variable, there is no reason to name it with '_'. Rename it.\nI'm not sure that we should pass DUCKTAPE_OPTIONS as it json and there could be issues with bash + json. I'd like to prepare the options in run_tests.sh script and ask user to just fill env variables: VERSION, jvm_options, paths to config templates.", "author": "timoninmaxim", "createdAt": "2020-07-24T13:00:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3OTMxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA1NjYyNg==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460056626", "bodyText": "I mean that DUCKTAPE_OPTIONS should contain --parameters as well and any other ducktape API params. No need to overcomplicate run_tests.sh API.\nJust make DUCKTAPE_OPTIONS as you want (hardcode it %)) and export at wrapping sh.", "author": "anton-vinogradov", "createdAt": "2020-07-24T13:37:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3OTMxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUzMTQ1Mw==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460531453", "bodyText": "fixed", "author": "timoninmaxim", "createdAt": "2020-07-26T14:01:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3OTMxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAyOTQ4NA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460029484", "bodyText": "Seems, you may just always read from context.globals['jvm_opts']?", "author": "anton-vinogradov", "createdAt": "2020-07-24T12:45:12Z", "path": "modules/ducktests/tests/ignitetest/services/utils/ignite_aware.py", "diffHunk": "@@ -44,11 +44,20 @@ class IgniteAwareService(BackgroundThreadService):\n     def __init__(self, context, num_nodes, version, properties):\n         super(IgniteAwareService, self).__init__(context, num_nodes)\n \n+        if 'project' in context.globals:\n+            self.path = IgnitePath(context.globals['project'])\n+        else:\n+            self.path = IgnitePath()\n+\n+        if 'jvm_opts' in context.globals:\n+            self.jvm_options = context.globals['jvm_opts']\n+        else:\n+            self.jvm_options = \"\"", "originalCommit": "b03c2bcb5fc2694b918e1559deb4bd5c4344f04f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAzNzUyMA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460037520", "bodyText": "It will raise KeyError in case that jvm_options aren't specified.", "author": "timoninmaxim", "createdAt": "2020-07-24T13:01:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAyOTQ4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA1MDA3MQ==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460050071", "bodyText": "Python dict has method get(key, default)", "author": "ivandasch", "createdAt": "2020-07-24T13:25:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAyOTQ4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUzMTQ0Mw==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460531443", "bodyText": "fixed", "author": "timoninmaxim", "createdAt": "2020-07-26T14:01:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAyOTQ4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAyOTk4NQ==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460029985", "bodyText": "IgniteConfig?", "author": "anton-vinogradov", "createdAt": "2020-07-24T12:46:12Z", "path": "modules/ducktests/tests/ignitetest/services/utils/ignite_config.py", "diffHunk": "@@ -17,71 +17,49 @@\n This module renders Ignite config and all related artifacts\n \"\"\"\n \n+from jinja2 import FileSystemLoader, Environment\n+\n+import os\n+\n+DEFAULT_CONFIG_PATH = os.path.dirname(os.path.abspath(__file__)) + \"/config\"\n+DEFAULT_IGNITE_CONF = DEFAULT_CONFIG_PATH + \"/ignite.xml.j2\"\n+\n+\n+class Config(object):", "originalCommit": "b03c2bcb5fc2694b918e1559deb4bd5c4344f04f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUzMDU4OQ==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460530589", "bodyText": "It has nothing Ignite specific. Just render any jinja2 templare.", "author": "timoninmaxim", "createdAt": "2020-07-26T13:53:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAyOTk4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcwNTg5NA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460705894", "bodyText": "the filename is ignite_config, but the class name is just config.", "author": "anton-vinogradov", "createdAt": "2020-07-27T07:47:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAyOTk4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc0Mzk2MA==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460743960", "bodyText": "there are descenders: IgniteServerConfig and IgniteClientConfig that use ignite config files. Config class could render any config", "author": "timoninmaxim", "createdAt": "2020-07-27T08:55:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAyOTk4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAzMTE2OQ==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460031169", "bodyText": "Let's keep shift to the left", "author": "anton-vinogradov", "createdAt": "2020-07-24T12:48:36Z", "path": "modules/ducktests/tests/ignitetest/tests/spark_integration_test.py", "diffHunk": "@@ -28,38 +31,37 @@ class SparkIntegrationTest(IgniteTest):\n     3. Checks results of client application.\n     \"\"\"\n \n-    @staticmethod\n-    def properties(client_mode=\"false\"):\n-        return \"\"\"\n-            <property name=\"clientMode\" value=\"{client_mode}\"/>\n-        \"\"\".format(client_mode=client_mode)\n-\n     def __init__(self, test_context):\n         super(SparkIntegrationTest, self).__init__(test_context=test_context)\n-        self.spark = SparkService(test_context, num_nodes=2)\n-        self.ignite = IgniteService(test_context, num_nodes=1)\n+        self.spark = None\n+        self.ignite = None\n \n     def setUp(self):\n-        self.spark.start()\n-        self.ignite.start()\n+        pass\n \n     def teardown(self):\n         self.spark.stop()\n         self.ignite.stop()\n \n-    def test_spark_client(self):\n+    @parametrize(version=str(DEV_BRANCH))\n+    def test_spark_client(self, version):\n+        self.spark = SparkService(self.test_context, version=version, num_nodes=2)\n+        self.spark.start()\n+\n+        self.ignite = IgniteService(self.test_context, version=version, num_nodes=1)\n+        self.ignite.start()\n+\n         self.stage(\"Starting sample data generator\")\n \n-        IgniteApplicationService(\n-            self.test_context,\n-            java_class_name=\"org.apache.ignite.internal.ducktest.tests.spark_integration_test.SampleDataStreamerApplication\",\n-            params=\"cache,1000\",\n-            properties=self.properties(client_mode=\"true\")).run()\n+        IgniteApplicationService(self.test_context,\n+                                 java_class_name=\"org.apache.ignite.internal.ducktest.tests.spark_integration_test.SampleDataStreamerApplication\",\n+                                 params=\"cache,1000\",\n+                                 version=version).run()\n \n         self.stage(\"Starting Spark application\")\n \n-        SparkIgniteApplicationService(\n-            self.test_context,\n-            \"org.apache.ignite.internal.ducktest.tests.spark_integration_test.SparkApplication\",\n-            params=\"spark://\" + self.spark.nodes[0].account.hostname + \":7077\",\n-            timeout_sec=120).run()\n+        SparkIgniteApplicationService(self.test_context,\n+                                      \"org.apache.ignite.internal.ducktest.tests.spark_integration_test.SparkApplication\",\n+                                      params=\"spark://\" + self.spark.nodes[0].account.hostname + \":7077\",\n+                                      version=version,\n+                                      timeout_sec=120).run()", "originalCommit": "b03c2bcb5fc2694b918e1559deb4bd5c4344f04f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUzMTM1Nw==", "url": "https://github.com/apache/ignite/pull/8071#discussion_r460531357", "bodyText": "fixed", "author": "timoninmaxim", "createdAt": "2020-07-26T14:00:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAzMTE2OQ=="}], "type": "inlineReview"}, {"oid": "9fe3e5d8ac6c35f931ceb2fba375aa186a289e6a", "url": "https://github.com/apache/ignite/commit/9fe3e5d8ac6c35f931ceb2fba375aa186a289e6a", "message": "WIP", "committedDate": "2020-07-26T13:42:45Z", "type": "forcePushed"}, {"oid": "e54a5f5d3123993a681277721ea238c9510d14b3", "url": "https://github.com/apache/ignite/commit/e54a5f5d3123993a681277721ea238c9510d14b3", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-26T13:57:19Z", "type": "commit"}, {"oid": "e54a5f5d3123993a681277721ea238c9510d14b3", "url": "https://github.com/apache/ignite/commit/e54a5f5d3123993a681277721ea238c9510d14b3", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-26T13:57:19Z", "type": "forcePushed"}, {"oid": "e1e301f889c25a2fa9a29fb0a9b588c4ca659cdc", "url": "https://github.com/apache/ignite/commit/e1e301f889c25a2fa9a29fb0a9b588c4ca659cdc", "message": "fixup! Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-28T08:18:41Z", "type": "commit"}, {"oid": "b41a43a7152b351e78eccc0a37ebe80c630dfd82", "url": "https://github.com/apache/ignite/commit/b41a43a7152b351e78eccc0a37ebe80c630dfd82", "message": "Provide ability to use external config, project name, jvm opts", "committedDate": "2020-07-28T14:30:41Z", "type": "commit"}]}