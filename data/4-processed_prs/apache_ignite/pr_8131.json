{"pr_number": 8131, "pr_title": "IGNITE-13330 Java thin client documentation update", "pr_createdAt": "2020-08-07T17:40:56Z", "pr_url": "https://github.com/apache/ignite/pull/8131", "timeline": [{"oid": "c66166ab93a86eb906000c6dbc5899d7e30783e2", "url": "https://github.com/apache/ignite/commit/c66166ab93a86eb906000c6dbc5899d7e30783e2", "message": "IGNITE-13330 Java thin client documentation update", "committedDate": "2020-08-07T17:11:49Z", "type": "commit"}, {"oid": "b53e9667c4442a769bcd22cb55402ae58f941cea", "url": "https://github.com/apache/ignite/commit/b53e9667c4442a769bcd22cb55402ae58f941cea", "message": "IGNITE-13330 Java thin client features and examples added", "committedDate": "2020-08-07T17:38:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTA5MzU2Mw==", "url": "https://github.com/apache/ignite/pull/8131#discussion_r469093563", "bodyText": "I think this section should be a subsection of \"Cluster API\" and should give an example of how to get a group of nodes for a specific purpose. Also, \"Cluster groups\" is an incorrect term. I know it's used in the API itself, but it should be \"Node groups\".  In fact, you don't have to use the term, you can simple say something like \"here is how you can group nodes based on some characteristic (server nodes, clients, attributes, etc.).\" and give an example.", "author": "artem-budnikov", "createdAt": "2020-08-12T08:28:36Z", "path": "docs/_docs/thin-clients/java-thin-client.adoc", "diffHunk": "@@ -170,19 +181,96 @@ NOTE: The `getAll()` method retrieves the results from the cursor and closes it.\n \n Read more about using `SqlFieldsQuery` and SQL API in the link:SQL/sql-api[Using SQL API] section.\n \n-== Handling Exceptions\n+== Cluster API\n \n-=== Handling Node Failures\n+Cluster functionality (APIs for accessing cluster and nodes) is provided via the `ClientCluster` interface. You can get an instance of `ClientCluster` from `IgniteClient` as follows:\n+[source, java]\n+-------------------------------------------------------------------------------\n+include::{sourceCodeFile}[tag=client-cluster,indent=0]\n+-------------------------------------------------------------------------------\n \n-When you provide the addresses of multiple nodes in the client configuration, the client automatically switches to the next node if the current connection fails and retries any ongoing operation.\n+Through the `ClientCluster` interface you can:\n+\n+* Get or set cluster state\n+* Get a list of all cluster members\n+* Create logical Cluster Groups\n \n-In the case of atomic operations, failover to another node is transparent to the user.  However, if you execute a scan query or a SELECT query, it may return duplicate results. This can happen because queries return data in pages, and if the node that the client is connected to goes down while the client retrieves the pages, the client connects to another node and executes the query again. To avoid this, you have to write some code in your application that checks if the entries returned by the client are duplicated. Consider the following code:\n+== Cluster groups", "originalCommit": "c66166ab93a86eb906000c6dbc5899d7e30783e2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTA5Njc5MQ==", "url": "https://github.com/apache/ignite/pull/8131#discussion_r469096791", "bodyText": "Please change the link: as of now, the cluster groups page is located here: distributed-computing/cluster-groups. I know this is not the best location, I'll deal with it later ( I'm thinking of creating the \"Cluster API\" section at the top level of the docs).", "author": "artem-budnikov", "createdAt": "2020-08-12T08:34:27Z", "path": "docs/_docs/thin-clients/java-thin-client.adoc", "diffHunk": "@@ -170,19 +181,96 @@ NOTE: The `getAll()` method retrieves the results from the cursor and closes it.\n \n Read more about using `SqlFieldsQuery` and SQL API in the link:SQL/sql-api[Using SQL API] section.\n \n-== Handling Exceptions\n+== Cluster API\n \n-=== Handling Node Failures\n+Cluster functionality (APIs for accessing cluster and nodes) is provided via the `ClientCluster` interface. You can get an instance of `ClientCluster` from `IgniteClient` as follows:\n+[source, java]\n+-------------------------------------------------------------------------------\n+include::{sourceCodeFile}[tag=client-cluster,indent=0]\n+-------------------------------------------------------------------------------\n \n-When you provide the addresses of multiple nodes in the client configuration, the client automatically switches to the next node if the current connection fails and retries any ongoing operation.\n+Through the `ClientCluster` interface you can:\n+\n+* Get or set cluster state\n+* Get a list of all cluster members\n+* Create logical Cluster Groups\n \n-In the case of atomic operations, failover to another node is transparent to the user.  However, if you execute a scan query or a SELECT query, it may return duplicate results. This can happen because queries return data in pages, and if the node that the client is connected to goes down while the client retrieves the pages, the client connects to another node and executes the query again. To avoid this, you have to write some code in your application that checks if the entries returned by the client are duplicated. Consider the following code:\n+== Cluster groups\n \n+API to create logical groups of cluster nodes within your cluster is provided by `ClientClusterGroup` interface. Instance of this interface can be obtained from a parent `ClientClusterGroup` instance using node-filtering methods.\n [source, java]\n -------------------------------------------------------------------------------\n-include::{sourceCodeFile}[tag=results-to-map,indent=0]\n+include::{sourceCodeFile}[tag=client-cluster-groups,indent=0]\n -------------------------------------------------------------------------------\n \n+The `ClientCluster` instance (see link:#cluster-api[Cluster API]) it's a root cluster group, which includes all nodes in the cluster.\n+\n+////\n+*TODO: fix link*\n+////\n+\n+Refer to link:clustering/cluster-groups[Cluster groups] to get more information about logical nodes grouping.", "originalCommit": "c66166ab93a86eb906000c6dbc5899d7e30783e2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a03bc400c5f3c090752d6518e54d72f866c09b9a", "url": "https://github.com/apache/ignite/commit/a03bc400c5f3c090752d6518e54d72f866c09b9a", "message": "Review fixes", "committedDate": "2020-08-13T15:10:38Z", "type": "commit"}]}