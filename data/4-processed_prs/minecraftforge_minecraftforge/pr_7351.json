{"pr_number": 7351, "pr_title": "Support effective materials of vanilla AxeItem", "pr_createdAt": "2020-09-23T16:22:14Z", "pr_url": "https://github.com/MinecraftForge/MinecraftForge/pull/7351", "timeline": [{"oid": "104387b460a4c6a9496691e2ed6986afed9fb3e3", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/104387b460a4c6a9496691e2ed6986afed9fb3e3", "message": "fix harvest tool and harvest level for blocks with effective material for axes", "committedDate": "2020-09-23T16:05:15Z", "type": "commit"}, {"oid": "eed8d4f9275a0080d72dcadada9248aaefa49381", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/eed8d4f9275a0080d72dcadada9248aaefa49381", "message": "change tool type string of debug line", "committedDate": "2020-09-23T16:18:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzODUwOQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7351#discussion_r494038509", "bodyText": "This is a no for a few reasons, 1) Don't make the field public/modifiable for other people. It's not good API design. The better option would be to add a 'is' method in the AxeItem class.\n2) Honestly I think you're attacking the wrong target, you should probably go after 'isToolEffective' not getHarvestTool.\nPerhaps we should change the default implementation of isToolEffective to return getHavestTool(state) == null || getHavestTool(state) == tool", "author": "LexManos", "createdAt": "2020-09-24T04:56:14Z", "path": "patches/minecraft/net/minecraft/block/Block.java.patch", "diffHunk": "@@ -108,12 +108,16 @@\n +   @Nullable\n +   @Override\n +   public net.minecraftforge.common.ToolType getHarvestTool(BlockState state) {\n++      if (this.harvestTool == null && net.minecraft.item.AxeItem.field_234662_c_.contains(state.func_185904_a()))", "originalCommit": "eed8d4f9275a0080d72dcadada9248aaefa49381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA0NjMyOQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7351#discussion_r494046329", "bodyText": "You are right, adding a static isEffectiveMaterial(BlockState) is better than making this field public. I will change that.\nAll blocks that have a material where the axe is effective have not set a harvest tool. So, only adding the check getHavestTool(state) == null to isToolEffective would not change that and pickaxes would also be an effective tool for logs for example. So, changing the getHarvestTool should also be done.", "author": "cech12", "createdAt": "2020-09-24T05:26:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzODUwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA0NzM4MA==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7351#discussion_r494047380", "bodyText": "If that's the case, then you should do your first idea and fill in the vanilla blocks with their tools based on the material.\nYou can easily iterate all blocks using the registry. So it shouldn't be hard.\nVanilla blocks do not have state based materials so you don't have to do anything special.\nModded blocks should override isToolEffective, Honestly getHarvestTool should be deleted. It's mainly still existing for JEI. Considering multiple tools may work on the same state the concept of only having one is not valid anymore.", "author": "LexManos", "createdAt": "2020-09-24T05:29:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzODUwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA0OTY2NA==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7351#discussion_r494049664", "bodyText": "Should I use the ForgeRegistries.BLOCKS registry for this?\nShould I remove that method in this PR?", "author": "cech12", "createdAt": "2020-09-24T05:37:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzODUwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA2ODc1Nw==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7351#discussion_r494068757", "bodyText": "Sure\nNo, 1.17 would be the time, we need to talk about it more.", "author": "LexManos", "createdAt": "2020-09-24T06:32:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzODUwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzOTAyMA==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7351#discussion_r494039020", "bodyText": "This logic is just wrong.. it doesn't take into account levels that are already set.\nHowever, this does look like getHarvestLevel is wrong, the javadocs say it should have a tool class passed in. Perhaps this got lost somewhere in the shuffle. We should re-add it. That way a block could require a iron shovel, or a wooden pickaxe.", "author": "LexManos", "createdAt": "2020-09-24T04:58:24Z", "path": "patches/minecraft/net/minecraft/block/Block.java.patch", "diffHunk": "@@ -108,12 +108,16 @@\n +   @Nullable\n +   @Override\n +   public net.minecraftforge.common.ToolType getHarvestTool(BlockState state) {\n++      if (this.harvestTool == null && net.minecraft.item.AxeItem.field_234662_c_.contains(state.func_185904_a()))\n++         return net.minecraftforge.common.ToolType.AXE;\n +      return harvestTool; //TODO: RE-Evaluate\n +   }\n +\n +   @Override\n +   public int getHarvestLevel(BlockState state) {\n-+     return harvestLevel; //TODO: RE-Evaluate\n++      if (this.harvestLevel < 0 && net.minecraft.item.AxeItem.field_234662_c_.contains(state.func_185904_a()))", "originalCommit": "eed8d4f9275a0080d72dcadada9248aaefa49381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA0NzMxOA==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7351#discussion_r494047318", "bodyText": "The check this.harvestLevel < 0 &&... takes that into account, I think. Or what do you mean?\nI could re-add the tool type to this method, if you want. :)", "author": "cech12", "createdAt": "2020-09-24T05:29:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzOTAyMA=="}], "type": "inlineReview"}, {"oid": "ae98aea67656bfb6ef6151a609ed9e9eb5f7bd7f", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/ae98aea67656bfb6ef6151a609ed9e9eb5f7bd7f", "message": "add review comments of LexManos\n- add the harvest tool & level in ForgeHooks\n- removed the patches in Block class\n- make the effectiveMaterials field of AxeItem private again", "committedDate": "2020-09-24T07:16:58Z", "type": "commit"}, {"oid": "65ebf6713c9020a3c851cb79e13dc12600579383", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/65ebf6713c9020a3c851cb79e13dc12600579383", "message": "forgot a damn space xD", "committedDate": "2020-09-24T07:21:09Z", "type": "commit"}]}