{"pr_number": 10658, "pr_title": "document DynamicConfigProvider for kafka consumer properties", "pr_createdAt": "2020-12-08T23:20:26Z", "pr_url": "https://github.com/apache/druid/pull/10658", "timeline": [{"oid": "744611b646f394b67c88ce9092ecb8dcd9f10083", "url": "https://github.com/apache/druid/commit/744611b646f394b67c88ce9092ecb8dcd9f10083", "message": "document DynamicConfigProvider for kafka consumer properties", "committedDate": "2020-12-08T23:20:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg4NzU4Mg==", "url": "https://github.com/apache/druid/pull/10658#discussion_r538887582", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`consumerProperties`|Map<String, Object>|A map of properties to be passed to the Kafka consumer. See next section for more information.|yes|\n          \n          \n            \n            |`consumerProperties`|Map<String, Object>|A map of properties to be passed to the Kafka consumer. See [next section](#more-on-consumerproperties) for more information.|yes|", "author": "jihoonson", "createdAt": "2020-12-08T23:27:57Z", "path": "docs/development/extensions-core/kafka-ingestion.md", "diffHunk": "@@ -134,7 +134,7 @@ A sample supervisor spec is shown below:\n |-----|----|-----------|--------|\n |`topic`|String|The Kafka topic to read from. This must be a specific topic as topic patterns are not supported.|yes|\n |`inputFormat`|Object|[`inputFormat`](../../ingestion/data-formats.md#input-format) to specify how to parse input data. See [the below section](#specifying-data-format) for details about specifying the input format.|yes|\n-|`consumerProperties`|Map<String, Object>|A map of properties to be passed to the Kafka consumer. This must contain a property `bootstrap.servers` with a list of Kafka brokers in the form: `<BROKER_1>:<PORT_1>,<BROKER_2>:<PORT_2>,...`. Users can set `isolation.level` `read_uncommitted` here if don't need Druid to consume transactional topics or need Druid to consume older versions of Kafka. For SSL connections, the `keystore`, `truststore` and `key` passwords can be provided as a [Password Provider](../../operations/password-provider.md) or String password.|yes|\n+|`consumerProperties`|Map<String, Object>|A map of properties to be passed to the Kafka consumer. See next section for more information.|yes|", "originalCommit": "744611b646f394b67c88ce9092ecb8dcd9f10083", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg4ODk3Nw==", "url": "https://github.com/apache/druid/pull/10658#discussion_r538888977", "bodyText": "It would be better to mention Druid versions. Maybe In 0.20.0 or older Druid versions?", "author": "jihoonson", "createdAt": "2020-12-08T23:31:23Z", "path": "docs/development/extensions-core/kafka-ingestion.md", "diffHunk": "@@ -147,6 +147,18 @@ A sample supervisor spec is shown below:\n |`lateMessageRejectionPeriod`|ISO8601 Period|Configure tasks to reject messages with timestamps earlier than this period before the task was created; for example if this is set to `PT1H` and the supervisor creates a task at *2016-01-01T12:00Z*, messages with timestamps earlier than *2016-01-01T11:00Z* will be dropped. This may help prevent concurrency issues if your data stream has late messages and you have multiple pipelines that need to operate on the same segments (e.g. a realtime and a nightly batch ingestion pipeline). Please note that only one of `lateMessageRejectionPeriod` or `lateMessageRejectionStartDateTime` can be specified.|no (default == none)|\n |`earlyMessageRejectionPeriod`|ISO8601 Period|Configure tasks to reject messages with timestamps later than this period after the task reached its taskDuration; for example if this is set to `PT1H`, the taskDuration is set to `PT1H` and the supervisor creates a task at *2016-01-01T12:00Z*, messages with timestamps later than *2016-01-01T14:00Z* will be dropped. **Note:** Tasks sometimes run past their task duration, for example, in cases of supervisor failover. Setting earlyMessageRejectionPeriod too low may cause messages to be dropped unexpectedly whenever a task runs past its originally configured task duration.|no (default == none)|\n \n+#### More on consumerProperties\n+\n+This must contain a property `bootstrap.servers` with a list of Kafka brokers in the form: `<BROKER_1>:<PORT_1>,<BROKER_2>:<PORT_2>,...`.\n+By default, `isolation.level` is set to `read_committed`. It should be set to `read_uncommitted` if you don't want Druid to consume only committed transactions or working with older versions of Kafka servers with no Transactions support.\n+\n+There are few cases that require fetching few/all of consumer properties at runtime e.g. when `bootstrap.servers` is not known upfront or not static, to enable SSL connections users might have to provide passwords for `keystore`, `truststore` and `key` secretly.\n+For such consumer properties, user can implement a [DynamicConfigProvider](../../operations/dynamic-config-provider.md) to supply them at runtime, by adding\n+`druid.dynamic.config.provider`=`{\"type\": \"<registered_dynamic_config_provider_name>\", ...}`\n+in consumerProperties map.\n+\n+Note: In older Druid versions, for SSL connections, the `keystore`, `truststore` and `key` passwords can also be provided as a [Password Provider](../../operations/password-provider.md). This is deprecated.", "originalCommit": "744611b646f394b67c88ce9092ecb8dcd9f10083", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg5ODc0NQ==", "url": "https://github.com/apache/druid/pull/10658#discussion_r538898745", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Note: In older Druid versions, for SSL connections, the `keystore`, `truststore` and `key` passwords can also be provided as a [Password Provider](../../operations/password-provider.md). This is deprecated.\n          \n          \n            \n            Note: In 0.20.0 or older Druid versions, for SSL connections, the `keystore`, `truststore` and `key` passwords can also be provided as a [Password Provider](../../operations/password-provider.md). This is deprecated.", "author": "himanshug", "createdAt": "2020-12-08T23:54:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg4ODk3Nw=="}], "type": "inlineReview"}, {"oid": "105d24e999adea43255156afee5f0d36d53a7662", "url": "https://github.com/apache/druid/commit/105d24e999adea43255156afee5f0d36d53a7662", "message": "Update docs/development/extensions-core/kafka-ingestion.md\n\nCo-authored-by: Jihoon Son <jihoonson@apache.org>", "committedDate": "2020-12-08T23:54:08Z", "type": "commit"}, {"oid": "c3139cb8bc7177708d6c8c2e721655f6a740b6e6", "url": "https://github.com/apache/druid/commit/c3139cb8bc7177708d6c8c2e721655f6a740b6e6", "message": "Update docs/development/extensions-core/kafka-ingestion.md", "committedDate": "2020-12-08T23:54:57Z", "type": "commit"}, {"oid": "b7b13ab017a839c559ebb2f5efab34226a327d1f", "url": "https://github.com/apache/druid/commit/b7b13ab017a839c559ebb2f5efab34226a327d1f", "message": "fix doc build", "committedDate": "2020-12-09T21:43:56Z", "type": "commit"}]}