{"pr_number": 10354, "pr_title": "Integration tests and docs for auto compaction with different partitioning", "pr_createdAt": "2020-09-04T01:39:03Z", "pr_url": "https://github.com/apache/druid/pull/10354", "timeline": [{"oid": "9ec70793430659d121c9ba1193dcc9be459519c0", "url": "https://github.com/apache/druid/commit/9ec70793430659d121c9ba1193dcc9be459519c0", "message": "Working", "committedDate": "2020-08-29T02:39:55Z", "type": "commit"}, {"oid": "c901404e292df4744fabb8acf17d2a2de069d67e", "url": "https://github.com/apache/druid/commit/c901404e292df4744fabb8acf17d2a2de069d67e", "message": "Merge branch 'master' of github.com:apache/druid into it-test-auto-compaction", "committedDate": "2020-09-01T22:51:59Z", "type": "commit"}, {"oid": "352a5a4b4c4033124a1eda29047e902f1f5b29de", "url": "https://github.com/apache/druid/commit/352a5a4b4c4033124a1eda29047e902f1f5b29de", "message": "add test", "committedDate": "2020-09-01T22:52:12Z", "type": "commit"}, {"oid": "917381a5952bf6ef3591d37f435a4987ea4f5295", "url": "https://github.com/apache/druid/commit/917381a5952bf6ef3591d37f435a4987ea4f5295", "message": "doc", "committedDate": "2020-09-02T01:30:02Z", "type": "commit"}, {"oid": "2dc4947ae3ea5ae053ce944487cddcff81dfbae3", "url": "https://github.com/apache/druid/commit/2dc4947ae3ea5ae053ce944487cddcff81dfbae3", "message": "fix test", "committedDate": "2020-09-04T01:36:29Z", "type": "commit"}, {"oid": "c8f7836364a06517d1115f6d3a212f5daaceb6bf", "url": "https://github.com/apache/druid/commit/c8f7836364a06517d1115f6d3a212f5daaceb6bf", "message": "Merge branch 'it-test-auto-compaction' of github.com:jihoonson/druid into it-test-auto-compaction", "committedDate": "2020-09-04T01:39:47Z", "type": "commit"}, {"oid": "e5f9dbc984b58f25e62393ad9f1b65cfd134560a", "url": "https://github.com/apache/druid/commit/e5f9dbc984b58f25e62393ad9f1b65cfd134560a", "message": "split other integration test", "committedDate": "2020-09-04T03:22:33Z", "type": "commit"}, {"oid": "fcc7b42dbc0dc423139a6c4da8a9aa0ae06027a3", "url": "https://github.com/apache/druid/commit/fcc7b42dbc0dc423139a6c4da8a9aa0ae06027a3", "message": "exclude other-index from other tests", "committedDate": "2020-09-04T03:23:23Z", "type": "commit"}, {"oid": "573903ac18a688bdbe4db984614c791801758476", "url": "https://github.com/apache/druid/commit/573903ac18a688bdbe4db984614c791801758476", "message": "doc anchor fix", "committedDate": "2020-09-04T06:22:05Z", "type": "commit"}, {"oid": "70bfc5bb0ae84ecc60518945ab68e988a7e2084a", "url": "https://github.com/apache/druid/commit/70bfc5bb0ae84ecc60518945ab68e988a7e2084a", "message": "adjust task slots and number of merge tasks", "committedDate": "2020-09-04T06:42:34Z", "type": "commit"}, {"oid": "bba850d8c8cb44155dc64222f116e59ede11fc6e", "url": "https://github.com/apache/druid/commit/bba850d8c8cb44155dc64222f116e59ede11fc6e", "message": "spell check", "committedDate": "2020-09-04T07:12:42Z", "type": "commit"}, {"oid": "aece722b0ed6c5b4e7b240f33d90bf6a71824704", "url": "https://github.com/apache/druid/commit/aece722b0ed6c5b4e7b240f33d90bf6a71824704", "message": "reduce maxNumConcurrentSubTasks to 1", "committedDate": "2020-09-04T17:24:42Z", "type": "commit"}, {"oid": "6613de4d31b108ebfb80c350d758747f46ea7da9", "url": "https://github.com/apache/druid/commit/6613de4d31b108ebfb80c350d758747f46ea7da9", "message": "Merge branch 'it-test-auto-compaction' of github.com:jihoonson/druid into it-test-auto-compaction", "committedDate": "2020-09-04T17:24:54Z", "type": "commit"}, {"oid": "ddecc0caf4821955d15645005fdf9f90e3d214fa", "url": "https://github.com/apache/druid/commit/ddecc0caf4821955d15645005fdf9f90e3d214fa", "message": "maxNumConcurrentSubtasks for range partitinoing", "committedDate": "2020-09-05T00:05:25Z", "type": "commit"}, {"oid": "ad58a298dbf436b44196db675d407954bbc6a4b1", "url": "https://github.com/apache/druid/commit/ad58a298dbf436b44196db675d407954bbc6a4b1", "message": "reduce memory for historical", "committedDate": "2020-09-08T21:28:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU5NTkzMQ==", "url": "https://github.com/apache/druid/pull/10354#discussion_r486595931", "bodyText": "Should be rename the TestNGGroup from \"other-index\" to \"compact\"? AFAIK, the \"other-index\" only has auto-compaction IT and manual compaction IT. If we do that then we can rename this job from \"integration_auto_compaction_tests\" to \"integration_compaction_tests\". My concern is with the job saying auto_compaction but the test group is other-index which in the future may contains non compaction related tests", "author": "maytasm", "createdAt": "2020-09-10T19:52:06Z", "path": ".travis.yml", "diffHunk": "@@ -417,11 +417,19 @@ jobs:\n       script: *run_integration_test\n       after_failure: *integration_test_diags\n \n+    - &integration_auto_compaction_tests\n+      name: \"(Compile=openjdk8, Run=openjdk8) auto compaction integration test\"\n+      jdk: openjdk8\n+      services: *integration_test_services\n+      env: TESTNG_GROUPS='-Dgroups=other-index' JVM_RUNTIME='-Djvm.runtime=8'", "originalCommit": "ad58a298dbf436b44196db675d407954bbc6a4b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQ4NzA3Ng==", "url": "https://github.com/apache/druid/pull/10354#discussion_r487487076", "bodyText": "Good point. Changed name to \"compaction\".", "author": "jihoonson", "createdAt": "2020-09-13T06:11:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU5NTkzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU5NjM1NA==", "url": "https://github.com/apache/druid/pull/10354#discussion_r486596354", "bodyText": "Doesn't have to be address but maybe we should get rid of this. This is only running a single test since we move out the \"other-index\"", "author": "maytasm", "createdAt": "2020-09-10T19:52:58Z", "path": ".travis.yml", "diffHunk": "@@ -417,11 +417,19 @@ jobs:\n       script: *run_integration_test\n       after_failure: *integration_test_diags\n \n+    - &integration_auto_compaction_tests\n+      name: \"(Compile=openjdk8, Run=openjdk8) auto compaction integration test\"\n+      jdk: openjdk8\n+      services: *integration_test_services\n+      env: TESTNG_GROUPS='-Dgroups=other-index' JVM_RUNTIME='-Djvm.runtime=8'\n+      script: *run_integration_test\n+      after_failure: *integration_test_diags\n+\n     - &integration_tests\n       name: \"(Compile=openjdk8, Run=openjdk8) other integration test\"\n       jdk: openjdk8\n       services: *integration_test_services\n-      env: TESTNG_GROUPS='-DexcludedGroups=batch-index,input-format,input-source,perfect-rollup-parallel-batch-index,kafka-index,query,query-retry,realtime-index,security,s3-deep-storage,gcs-deep-storage,azure-deep-storage,hdfs-deep-storage,s3-ingestion,kinesis-index,kinesis-data-format,kafka-transactional-index,kafka-index-slow,kafka-transactional-index-slow,kafka-data-format,hadoop-s3-to-s3-deep-storage,hadoop-s3-to-hdfs-deep-storage,hadoop-azure-to-azure-deep-storage,hadoop-azure-to-hdfs-deep-storage,hadoop-gcs-to-gcs-deep-storage,hadoop-gcs-to-hdfs-deep-storage,aliyun-oss-deep-storage,append-ingestion' JVM_RUNTIME='-Djvm.runtime=11'\n+      env: TESTNG_GROUPS='-DexcludedGroups=batch-index,input-format,input-source,perfect-rollup-parallel-batch-index,kafka-index,query,query-retry,realtime-index,security,s3-deep-storage,gcs-deep-storage,azure-deep-storage,hdfs-deep-storage,s3-ingestion,kinesis-index,kinesis-data-format,kafka-transactional-index,kafka-index-slow,kafka-transactional-index-slow,kafka-data-format,hadoop-s3-to-s3-deep-storage,hadoop-s3-to-hdfs-deep-storage,hadoop-azure-to-azure-deep-storage,hadoop-azure-to-hdfs-deep-storage,hadoop-gcs-to-gcs-deep-storage,hadoop-gcs-to-hdfs-deep-storage,aliyun-oss-deep-storage,append-ingestion,other-index' JVM_RUNTIME='-Djvm.runtime=11'", "originalCommit": "ad58a298dbf436b44196db675d407954bbc6a4b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQ4NzA3Mg==", "url": "https://github.com/apache/druid/pull/10354#discussion_r487487072", "bodyText": "Hmm, would it be better to keep this as we are going to add more tests in the future which could be not in these groups? BTW, how did you tell this job will run only one test?", "author": "jihoonson", "createdAt": "2020-09-13T06:11:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU5NjM1NA=="}], "type": "inlineReview"}, {"oid": "2ee19d4717222e8b87f5252d03f1ba58b16a42e9", "url": "https://github.com/apache/druid/commit/2ee19d4717222e8b87f5252d03f1ba58b16a42e9", "message": "change group name", "committedDate": "2020-09-13T06:10:55Z", "type": "commit"}]}