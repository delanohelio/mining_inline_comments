{"pr_number": 9630, "pr_title": "check paths used for shuffle intermediary data manager get and delete", "pr_createdAt": "2020-04-06T21:49:56Z", "pr_url": "https://github.com/apache/druid/pull/9630", "timeline": [{"oid": "c009e2ee043421990b21e225c536f3ca08baa88c", "url": "https://github.com/apache/druid/commit/c009e2ee043421990b21e225c536f3ca08baa88c", "message": "check paths used for shuffle intermediary data manager get and delete", "committedDate": "2020-04-03T22:48:15Z", "type": "commit"}, {"oid": "fc1af6533628a510ff5a6fbf678ff4f7098361df", "url": "https://github.com/apache/druid/commit/fc1af6533628a510ff5a6fbf678ff4f7098361df", "message": "Merge remote-tracking branch 'upstream/master' into sanitize-shuffle-file-path", "committedDate": "2020-04-07T00:15:10Z", "type": "commit"}, {"oid": "4b014adde22ff28f5a292d0574b7e1b2cf0fcdf2", "url": "https://github.com/apache/druid/commit/4b014adde22ff28f5a292d0574b7e1b2cf0fcdf2", "message": "add test", "committedDate": "2020-04-07T00:35:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ5NTUzNg==", "url": "https://github.com/apache/druid/pull/9630#discussion_r404495536", "bodyText": "What do you think about moving the validation up the stack to right when the external data enters druid (i.e., in the API resource layer like ShuffleResource.getPartition()/deletePartitions())? For example, in the future, there may be clients of the lower level code that do not need to do the validation.", "author": "ccaominh", "createdAt": "2020-04-07T02:12:11Z", "path": "indexing-service/src/main/java/org/apache/druid/indexing/worker/IntermediaryDataManager.java", "diffHunk": "@@ -336,6 +337,7 @@ long addSegment(String supervisorTaskId, String subTaskId, DataSegment segment,\n   @Nullable\n   public File findPartitionFile(String supervisorTaskId, String subTaskId, Interval interval, int partitionId)\n   {\n+    TaskIdUtils.validateId(\"supervisorTaskId\", supervisorTaskId);", "originalCommit": "4b014adde22ff28f5a292d0574b7e1b2cf0fcdf2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDUwMTc2Ng==", "url": "https://github.com/apache/druid/pull/9630#discussion_r404501766", "bodyText": "It seems safer to me to be here where the problem is possible so that any future potential caller wouldn't need to worry about forgetting to do this and avoid the possibility.", "author": "clintropolis", "createdAt": "2020-04-07T02:35:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ5NTUzNg=="}], "type": "inlineReview"}, {"oid": "6a98cf778e20c0769c2bc89307c8007e043bc0bc", "url": "https://github.com/apache/druid/commit/6a98cf778e20c0769c2bc89307c8007e043bc0bc", "message": "newline", "committedDate": "2020-04-07T03:49:18Z", "type": "commit"}, {"oid": "d120c288fecaab124e1953f373ea6c2b9e842d1a", "url": "https://github.com/apache/druid/commit/d120c288fecaab124e1953f373ea6c2b9e842d1a", "message": "meh", "committedDate": "2020-04-07T10:54:34Z", "type": "commit"}]}