{"pr_number": 10638, "pr_title": "Integration tests: update base image for hadoop containers to centos:7", "pr_createdAt": "2020-12-04T20:52:14Z", "pr_url": "https://github.com/apache/druid/pull/10638", "timeline": [{"oid": "9820c12a78f0029150ceb2e5ec1d2620c5e8b12a", "url": "https://github.com/apache/druid/commit/9820c12a78f0029150ceb2e5ec1d2620c5e8b12a", "message": "integration tests fix: update base image for hadoop containers to centos 7", "committedDate": "2020-12-04T19:21:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM4NTY1NQ==", "url": "https://github.com/apache/druid/pull/10638#discussion_r536385655", "bodyText": "I decided to create /usr/local/bin/start_sshd executable by RUN command to make non-standard ssh port 2122 visible in that Dockerfile", "author": "viatcheslavmogilevsky", "createdAt": "2020-12-04T21:19:32Z", "path": "examples/quickstart/tutorial/hadoop/docker/Dockerfile", "diffHunk": "@@ -109,8 +103,14 @@ RUN sed  -i \"/^[^#]*UsePAM/ s/.*/#&/\"  /etc/ssh/sshd_config\n RUN echo \"UsePAM no\" >> /etc/ssh/sshd_config\n RUN echo \"Port 2122\" >> /etc/ssh/sshd_config\n \n-RUN service sshd start && $HADOOP_PREFIX/etc/hadoop/hadoop-env.sh && $HADOOP_PREFIX/sbin/start-dfs.sh && $HADOOP_PREFIX/bin/hdfs dfs -mkdir -p /user/root\n-RUN service sshd start && $HADOOP_PREFIX/etc/hadoop/hadoop-env.sh && $HADOOP_PREFIX/sbin/start-dfs.sh && $HADOOP_PREFIX/bin/hdfs dfs -put $HADOOP_PREFIX/etc/hadoop/ input\n+# script for plain sshd start\n+RUN echo -e \\\n+\t'#!/bin/bash\\n/usr/sbin/sshd\\ntimeout 10 bash -c \"until printf \\\"\\\" 2>>/dev/null >>/dev/tcp/127.0.0.1/2122; do sleep 0.5; done\"' > \\\n+\t/usr/local/bin/start_sshd && \\\n+\tchmod a+x /usr/local/bin/start_sshd", "originalCommit": "9820c12a78f0029150ceb2e5ec1d2620c5e8b12a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}