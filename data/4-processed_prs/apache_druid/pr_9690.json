{"pr_number": 9690, "pr_title": "IntelliJ inspection and checkstyle rule for \"Collection.EMPTY_* field accesses replaceable with Collections.empty*()\"", "pr_createdAt": "2020-04-12T11:52:58Z", "pr_url": "https://github.com/apache/druid/pull/9690", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTUzMzUxNQ==", "url": "https://github.com/apache/druid/pull/9690#discussion_r409533515", "bodyText": "I don't think this rule lines up with the intelliJ inspection warning.\nSee https://github.com/JetBrains/intellij-community/blob/master/plugins/InspectionGadgets/test/com/siyeh/igtest/migration/collections_field_access_replaceable_by_method_call/CollectionsFieldAccessReplaceableByMethodCall.java\nIt appears that object comparisons against Collections.EMPTY_* are not reported as errors on purpose, but this change would make checkstyle fail.\nThe intelliJ inspections run as part of the build, so I think we can omit this change to the checkstyle.", "author": "suneet-s", "createdAt": "2020-04-16T12:56:49Z", "path": "codestyle/checkstyle.xml", "diffHunk": "@@ -325,5 +325,11 @@ codestyle/checkstyle.xml.&#10;\"/>\n \n     <module name=\"StringLiteralEquality\"/>\n \n+    <module name=\"Regexp\">\n+      <property name=\"format\" value=\"Collections\\.(EMPTY_LIST|EMPTY_MAP|EMPTY_SET)\"/>\n+      <property name=\"message\" value=\"Use Collections.empty*() method instead of Collection.EMPTY_* field\"/>\n+      <property name=\"illegalPattern\" value=\"true\"/>\n+    </module>", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg0ODUwMw==", "url": "https://github.com/apache/druid/pull/9690#discussion_r409848503", "bodyText": "In this case, you are right. Looks like it's not easy to make identical to IntelliJ inspection check by regexp.\nBut generally, additional checkstyle rule makes sense sometimes, since not all developers use IntelliJ products and checkstyle allows to verify code locally, before submitting to CI.\nI've reverted checkstyle rule.", "author": "alex-plekhanov", "createdAt": "2020-04-16T21:06:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTUzMzUxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg1MDUyMA==", "url": "https://github.com/apache/druid/pull/9690#discussion_r409850520", "bodyText": "yeah I like the checkstyle rule too, because I almost never run intelliJ inspections locally. But since they added an explicit test that verifies that style is allowed, it made me think they must have a reason to do so \ud83e\udd37\u200d\u2642\ufe0f", "author": "suneet-s", "createdAt": "2020-04-16T21:10:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTUzMzUxNQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "948dd72622bf6e9280cf3ecf8879d3ed085d8eff", "url": "https://github.com/apache/druid/commit/948dd72622bf6e9280cf3ecf8879d3ed085d8eff", "message": "IntelliJ inspection and checkstyle rule for \"Collection.EMPTY_* field accesses replaceable with Collections.empty*()\"", "committedDate": "2020-06-18T10:34:58Z", "type": "commit"}, {"oid": "4e01bdbdf8f11e4a42d4f10b10b4b3725e7c38df", "url": "https://github.com/apache/druid/commit/4e01bdbdf8f11e4a42d4f10b10b4b3725e7c38df", "message": "Reverted checkstyle rule", "committedDate": "2020-06-18T10:34:58Z", "type": "commit"}, {"oid": "fe8179d11eae36eae624440d778d68d654106429", "url": "https://github.com/apache/druid/commit/fe8179d11eae36eae624440d778d68d654106429", "message": "Added tests to pass CI", "committedDate": "2020-06-18T13:20:30Z", "type": "commit"}, {"oid": "fe8179d11eae36eae624440d778d68d654106429", "url": "https://github.com/apache/druid/commit/fe8179d11eae36eae624440d778d68d654106429", "message": "Added tests to pass CI", "committedDate": "2020-06-18T13:20:30Z", "type": "forcePushed"}, {"oid": "cd26bb59d9d29acbd3c6464af7e36317d65822a5", "url": "https://github.com/apache/druid/commit/cd26bb59d9d29acbd3c6464af7e36317d65822a5", "message": "Codestyle", "committedDate": "2020-06-18T14:22:57Z", "type": "commit"}]}