{"pr_number": 10169, "pr_title": "Fix JettyTest.testNumConnectionsMetricHttp flaky test", "pr_createdAt": "2020-07-10T19:07:37Z", "pr_url": "https://github.com/apache/druid/pull/10169", "timeline": [{"oid": "5b422b63e5dc8f1d459ad8c5fdc8dcf7cd733539", "url": "https://github.com/apache/druid/commit/5b422b63e5dc8f1d459ad8c5fdc8dcf7cd733539", "message": "JettyTest.testNumConnectionsMetricHttp is rarely flaky", "committedDate": "2020-07-10T18:36:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDA2NzQ2Mg==", "url": "https://github.com/apache/druid/pull/10169#discussion_r454067462", "bodyText": "nit: could use\n      throw new RE(\"Connections greater than 0. activeConnections=%s port=%s\", jsm.getActiveConnections(), port);", "author": "clintropolis", "createdAt": "2020-07-14T02:52:56Z", "path": "server/src/test/java/org/apache/druid/server/initialization/JettyTest.java", "diffHunk": "@@ -511,13 +511,13 @@ private void waitForJettyServerModuleActiveConnectionsZero(JettyServerModule jsm\n   {\n     // it can take a bit to close the connection, so maybe sleep for a while and hope it closes\n     final int sleepTimeMills = 10;\n-    final int totalSleeps = 10_000 / sleepTimeMills;\n+    final int totalSleeps = 15_000 / sleepTimeMills;\n     int count = 0;\n     while (jsm.getActiveConnections() > 0 && count++ < totalSleeps) {\n       Thread.sleep(sleepTimeMills);\n     }\n     if (jsm.getActiveConnections() > 0) {\n-      throw new RuntimeException(\"Connections greater than 0\");\n+      throw new RuntimeException(\"Connections greater than 0. activeConnections=\" + jsm.getActiveConnections() + \" port=\" + port);", "originalCommit": "5b422b63e5dc8f1d459ad8c5fdc8dcf7cd733539", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}