{"pr_number": 10679, "pr_title": "Adding example config files for indexer process. Also added status/selfDiscovered endpoint to indexer for self discovery", "pr_createdAt": "2020-12-14T17:10:51Z", "pr_url": "https://github.com/apache/druid/pull/10679", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU2Mzg0Nw==", "url": "https://github.com/apache/druid/pull/10679#discussion_r542563847", "bodyText": "any reason this is different than the default indexer port?", "author": "xvrl", "createdAt": "2020-12-14T17:22:15Z", "path": "examples/conf/druid/cluster/data/indexer/runtime.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+druid.service=druid/indexer\n+druid.plaintextPort=8092", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc0MTE3NQ==", "url": "https://github.com/apache/druid/pull/10679#discussion_r542741175", "bodyText": "Actually, I set it back to 8091 and tested the docker image. To avoid localhost port conflict I was using the following port mappings: 8091:8091 for MM and 8092:8092 for indexer. Now updated the indexer port mapping to 8092:8091.", "author": "harinirajendran", "createdAt": "2020-12-14T20:23:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU2Mzg0Nw=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc4NDc1OQ==", "url": "https://github.com/apache/druid/pull/10679#discussion_r542784759", "bodyText": "the corresponding middleManager config has 4 tasks, should we match that for consistency?", "author": "xvrl", "createdAt": "2020-12-14T21:04:56Z", "path": "examples/conf/druid/cluster/data/indexer/runtime.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+druid.service=druid/indexer\n+druid.plaintextPort=8091\n+\n+# Number of tasks per indexer\n+druid.worker.capacity=2", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc5NjI4MQ==", "url": "https://github.com/apache/druid/pull/10679#discussion_r542796281", "bodyText": "Sure! I can update it to match with MM config.", "author": "harinirajendran", "createdAt": "2020-12-14T21:15:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc4NDc1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc4NjAxNg==", "url": "https://github.com/apache/druid/pull/10679#discussion_r542786016", "bodyText": "given we have 1 processing thread per task in the example middle-manager config, I would set this to equal the worker capacity to have a comparable config.", "author": "xvrl", "createdAt": "2020-12-14T21:06:08Z", "path": "examples/conf/druid/cluster/data/indexer/runtime.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+druid.service=druid/indexer\n+druid.plaintextPort=8091\n+\n+# Number of tasks per indexer\n+druid.worker.capacity=2\n+\n+# Task launch parameters\n+druid.indexer.task.baseTaskDir=var/druid/task\n+\n+# HTTP server threads\n+druid.server.http.numThreads=60\n+\n+# Processing threads and buffers on Indexer\n+druid.processing.numMergeBuffers=2\n+druid.processing.buffer.sizeBytes=100MiB\n+druid.processing.numThreads=1", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc4Njg0NQ==", "url": "https://github.com/apache/druid/pull/10679#discussion_r542786845", "bodyText": "we probably need more heap to match our middle-manager config, which had 1GB per task.", "author": "xvrl", "createdAt": "2020-12-14T21:06:49Z", "path": "examples/conf/druid/cluster/data/indexer/jvm.config", "diffHunk": "@@ -0,0 +1,9 @@\n+-server\n+-Xms128m\n+-Xmx128m\n+-XX:MaxDirectMemorySize=1g", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjgwMzQyNg==", "url": "https://github.com/apache/druid/pull/10679#discussion_r542803426", "bodyText": "Made it 4g and also increased druid.processing.buffer.sizeBytes to 500MiB . Also increased -Xms and -Xmx setting to be 4x.", "author": "harinirajendran", "createdAt": "2020-12-14T21:22:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc4Njg0NQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjgyMDU4Mg==", "url": "https://github.com/apache/druid/pull/10679#discussion_r542820582", "bodyText": "processing buffers are per thread, so we you can leave that to 100MB to match the middle manager", "author": "xvrl", "createdAt": "2020-12-14T21:38:08Z", "path": "examples/conf/druid/cluster/data/indexer/runtime.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+druid.service=druid/indexer\n+druid.plaintextPort=8091\n+\n+# Number of tasks per indexer\n+druid.worker.capacity=4\n+\n+# Task launch parameters\n+druid.indexer.task.baseTaskDir=var/druid/task\n+\n+# HTTP server threads\n+druid.server.http.numThreads=60\n+\n+# Processing threads and buffers on Indexer\n+druid.processing.numMergeBuffers=2\n+druid.processing.buffer.sizeBytes=500MiB", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "062572af7c8e44d8b6a4e2ff67c9979cb9d74435", "url": "https://github.com/apache/druid/commit/062572af7c8e44d8b6a4e2ff67c9979cb9d74435", "message": "Adding example config files for indexer process. Also added status/selfDiscovered endpoint to indexer for self discovery of indexer.", "committedDate": "2020-12-14T22:10:45Z", "type": "commit"}, {"oid": "062572af7c8e44d8b6a4e2ff67c9979cb9d74435", "url": "https://github.com/apache/druid/commit/062572af7c8e44d8b6a4e2ff67c9979cb9d74435", "message": "Adding example config files for indexer process. Also added status/selfDiscovered endpoint to indexer for self discovery of indexer.", "committedDate": "2020-12-14T22:10:45Z", "type": "forcePushed"}]}