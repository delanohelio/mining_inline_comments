{"pr_number": 10620, "pr_title": "Add an integration test for HTTP inputSource", "pr_createdAt": "2020-12-02T03:13:14Z", "pr_url": "https://github.com/apache/druid/pull/10620", "timeline": [{"oid": "3479d8031728688036b8cd1690384fb4fc87318f", "url": "https://github.com/apache/druid/commit/3479d8031728688036b8cd1690384fb4fc87318f", "message": "Add an integration test for HTTP inputSource", "committedDate": "2020-12-02T03:10:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk2MzM0Nw==", "url": "https://github.com/apache/druid/pull/10620#discussion_r533963347", "bodyText": "what is the reason for adding this file twice?", "author": "abhishekagarwal87", "createdAt": "2020-12-02T08:00:14Z", "path": "integration-tests/src/test/resources/indexer/wikipedia_http_inputsource_task.json", "diffHunk": "@@ -0,0 +1,90 @@\n+{\n+  \"type\": \"index_parallel\",\n+  \"spec\": {\n+    \"dataSchema\": {\n+      \"dataSource\": \"%%DATASOURCE%%\",\n+      \"timestampSpec\": {\n+        \"column\": \"timestamp\"\n+      },\n+      \"dimensionsSpec\": {\n+        \"dimensions\": [\n+          \"page\",\n+          {\"type\": \"string\", \"name\": \"language\", \"createBitmapIndex\": false},\n+          \"user\",\n+          \"unpatrolled\",\n+          \"newPage\",\n+          \"robot\",\n+          \"anonymous\",\n+          \"namespace\",\n+          \"continent\",\n+          \"country\",\n+          \"region\",\n+          \"city\"\n+        ]\n+      },\n+      \"metricsSpec\": [\n+        {\n+          \"type\": \"count\",\n+          \"name\": \"count\"\n+        },\n+        {\n+          \"type\": \"doubleSum\",\n+          \"name\": \"added\",\n+          \"fieldName\": \"added\"\n+        },\n+        {\n+          \"type\": \"doubleSum\",\n+          \"name\": \"deleted\",\n+          \"fieldName\": \"deleted\"\n+        },\n+        {\n+          \"type\": \"doubleSum\",\n+          \"name\": \"delta\",\n+          \"fieldName\": \"delta\"\n+        },\n+        {\n+          \"name\": \"thetaSketch\",\n+          \"type\": \"thetaSketch\",\n+          \"fieldName\": \"user\"\n+        },\n+        {\n+          \"name\": \"quantilesDoublesSketch\",\n+          \"type\": \"quantilesDoublesSketch\",\n+          \"fieldName\": \"delta\"\n+        },\n+        {\n+          \"name\": \"HLLSketchBuild\",\n+          \"type\": \"HLLSketchBuild\",\n+          \"fieldName\": \"user\"\n+        }\n+      ],\n+      \"granularitySpec\": {\n+        \"segmentGranularity\": \"DAY\",\n+        \"queryGranularity\": \"second\",\n+        \"intervals\" : [ \"2016-06/P1M\" ]\n+      }\n+    },\n+    \"ioConfig\": {\n+      \"type\": \"index_parallel\",\n+      \"inputSource\": {\n+        \"type\": \"http\",\n+        \"uris\": [\"https://druid.apache.org/data/wikipedia.json.gz\", \"https://druid.apache.org/data/wikipedia.json.gz\"]", "originalCommit": "3479d8031728688036b8cd1690384fb4fc87318f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM4OTA4NQ==", "url": "https://github.com/apache/druid/pull/10620#discussion_r534389085", "bodyText": "Good question. This is sort of future proof. This task spec has maxNumFiles set to 1, so that it creates one subtask per file. Even though it currently always runs in parallel mode if maxNumConcurrentSubTasks > 1 no matter how many subtasks actually get created, I think, in the future, it should take the actual number of them into consideration when determining its running mode (parallel vs sequential). Reading 2 files makes sure that this task will always requires 2 subtasks to run and thus run in parallel mode.", "author": "jihoonson", "createdAt": "2020-12-02T18:28:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk2MzM0Nw=="}], "type": "inlineReview"}]}