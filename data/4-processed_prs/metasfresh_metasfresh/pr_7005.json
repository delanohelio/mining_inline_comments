{"pr_number": 7005, "pr_title": "#7003 support for DefaultBillTo_Contact only on Sales invoice", "pr_createdAt": "2020-07-13T13:00:29Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/7005", "timeline": [{"oid": "da95b00fc67d609bc55746df501109c0b72f3058", "url": "https://github.com/metasfresh/metasfresh/commit/da95b00fc67d609bc55746df501109c0b72f3058", "message": "#7003 support for DefaultBillTo_Contact only on Sales invoice\n\nhttps://github.com/metasfresh/metasfresh/issues/7003", "committedDate": "2020-07-13T12:58:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY1OTU5Ng==", "url": "https://github.com/metasfresh/metasfresh/pull/7005#discussion_r453659596", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            UPDATE AD_Val_Rule SET Code='AD_User.C_Bpartner_ID = @C_BPartner_ID/-1@\n          \n          \n            \n            -- fail, until the AD_Val_Rule exists (created by backend/de.metas.adempiere.adempiere/migration/src/main/sql/postgresql/system/10-de.metas.adempiere/5563310_sys_gh7003_Only_Default_BillToContact_Valrule.sql)\n          \n          \n            \n            select db_fail_unless_row_count_greater_zero('select 1 from AD_Val_Rule WHERE AD_Val_Rule_ID=540511');\n          \n          \n            \n            \n          \n          \n            \n            UPDATE AD_Val_Rule SET Code='AD_User.C_Bpartner_ID = @C_BPartner_ID/-1@", "author": "metas-ts", "createdAt": "2020-07-13T13:44:11Z", "path": "backend/de.metas.adempiere.adempiere/migration/src/main/sql/postgresql/system/10-de.metas.adempiere/5563310_sys_gh7003_Only_Default_BillToContact_Valrule.sql", "diffHunk": "@@ -0,0 +1,67 @@\n+\n+-- 2020-07-09T17:50:46.801Z\n+-- URL zum Konzept\n+INSERT INTO AD_Val_Rule (AD_Client_ID,AD_Org_ID,AD_Val_Rule_ID,Code,Created,CreatedBy,EntityType,IsActive,Name,Type,Updated,UpdatedBy) VALUES\n+ (0,0,540511,'AD_User.C_Bpartner_ID = @C_BPartner_ID/-1@\n+AND AD_User.IsBillToContact_Default = ''Y''',TO_TIMESTAMP('2020-07-09 20:50:46','YYYY-MM-DD HH24:MI:SS'),100,'D','Y',\n+'AD_User_BillToDefault of Context  Partner','S',TO_TIMESTAMP('2020-07-09 20:50:46','YYYY-MM-DD HH24:MI:SS'),100)\n+;\n+\n+\n+-- 2020-07-09T17:51:49.277Z\n+-- URL zum Konzept\n+UPDATE AD_Val_Rule SET Name='AD_User_BillToDefault of Context Partner',Updated=TO_TIMESTAMP('2020-07-09 20:51:49','YYYY-MM-DD HH24:MI:SS'),UpdatedBy=100 WHERE AD_Val_Rule_ID=540511\n+;\n+\n+-- 2020-07-09T17:52:19.262Z\n+-- URL zum Konzept\n+UPDATE AD_Val_Rule SET Code='AD_User.C_Bpartner_ID = @C_BPartner_ID/-1@\n+AND AD_User.IsBillToContact_Default = ''Y''',Updated=TO_TIMESTAMP('2020-07-09 20:52:19','YYYY-MM-DD HH24:MI:SS'),UpdatedBy=100 WHERE AD_Val_Rule_ID=540511\n+;\n+\n+\n+\n+-- 2020-07-09T18:04:42.665Z\n+-- URL zum Konzept\n+UPDATE AD_Val_Rule SET Code='AD_User.C_Bpartner_ID = @C_BPartner_ID/-1@\n+AND AD_User.IsBillToContact_Default = ''Y''\n+AND AD_User.C_BPartner_ID IS NOT NULL',Updated=TO_TIMESTAMP('2020-07-09 21:04:42','YYYY-MM-DD HH24:MI:SS'),UpdatedBy=100 WHERE AD_Val_Rule_ID=540511\n+;\n+\n+-- 2020-07-09T18:05:32.191Z\n+-- URL zum Konzept\n+UPDATE AD_Val_Rule SET Code='AD_User.C_Bpartner_ID = @C_BPartner_ID/-1@\n+AND AD_User.IsBillToContact_Default = ''Y''\n+AND AD_User.C_BPartner_ID >0',Updated=TO_TIMESTAMP('2020-07-09 21:05:32','YYYY-MM-DD HH24:MI:SS'),UpdatedBy=100 WHERE AD_Val_Rule_ID=540511\n+;\n+\n+\n+\n+-- 2020-07-09T18:19:00.185Z\n+-- URL zum Konzept\n+UPDATE AD_Val_Rule SET Code='AD_User.C_Bpartner_ID = @C_BPartner_ID/-1@", "originalCommit": "da95b00fc67d609bc55746df501109c0b72f3058", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2e309fc88a0fa808c6f7982b3832067fb42ee334", "url": "https://github.com/metasfresh/metasfresh/commit/2e309fc88a0fa808c6f7982b3832067fb42ee334", "message": "Update backend/de.metas.adempiere.adempiere/migration/src/main/sql/postgresql/system/10-de.metas.adempiere/5563310_sys_gh7003_Only_Default_BillToContact_Valrule.sql\r\n\r\n#7003", "committedDate": "2020-07-13T13:45:07Z", "type": "commit"}, {"oid": "18837aff807250c8d20b762feb5e24ad26381eed", "url": "https://github.com/metasfresh/metasfresh/commit/18837aff807250c8d20b762feb5e24ad26381eed", "message": "sorry, had mixed up some repo & filenames\n\nRevert \"Update backend/de.metas.adempiere.adempiere/migration/src/main/sql/postgresql/system/10-de.metas.adempiere/5563310_sys_gh7003_Only_Default_BillToContact_Valrule.sql\"\n\nThis reverts commit 2e309fc8", "committedDate": "2020-07-13T13:50:34Z", "type": "commit"}]}