{"pr_number": 6730, "pr_title": "fix NPE in CustomerTradeMarginPricingRule", "pr_createdAt": "2020-05-26T06:04:06Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/6730", "timeline": [{"oid": "f81ee2b93a0af5e85f1fc04fd0c013000c2a23af", "url": "https://github.com/metasfresh/metasfresh/commit/f81ee2b93a0af5e85f1fc04fd0c013000c2a23af", "message": "fix NPE in CustomerTradeMarginPricingRule", "committedDate": "2020-05-26T06:02:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE3NDIyNw==", "url": "https://github.com/metasfresh/metasfresh/pull/6730#discussion_r430174227", "bodyText": "this is the actual NPE-fix", "author": "metas-ts", "createdAt": "2020-05-26T06:06:07Z", "path": "backend/de.metas.contracts/src/main/java/de/metas/contracts/pricing/trade_margin/CustomerTradeMarginPricingRule.java", "diffHunk": "@@ -71,20 +72,25 @@\n \tprivate final MoneyService moneyService = SpringContextHolder.instance.getBean(MoneyService.class);\n \n \t@Override\n-\tpublic boolean applies(IPricingContext pricingCtx, IPricingResult result)\n+\tpublic boolean applies(@NonNull final IPricingContext pricingCtx, @NonNull final IPricingResult result)\n \t{\n+\t\tfinal ILoggable loggable = Loggables.withLogger(logger, Level.DEBUG);\n \t\tif (!result.isCalculated())\n \t\t{\n-\t\t\tLoggables.withLogger(logger, Level.DEBUG).addLog(\"Not applying due to missing calculated price!\");\n+\t\t\tloggable.addLog(\"applies - pricingResult.isCalculated=false -> return false\");\n \t\t\treturn false;\n \t\t}\n \t\tfinal BPartnerId customerId = pricingCtx.getBPartnerId();\n+\t\tif (customerId == null)", "originalCommit": "f81ee2b93a0af5e85f1fc04fd0c013000c2a23af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}