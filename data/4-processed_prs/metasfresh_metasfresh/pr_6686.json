{"pr_number": 6686, "pr_title": "Gh6511 2 repair PaySelectionTrxType calculation", "pr_createdAt": "2020-05-19T11:10:13Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/6686", "timeline": [{"oid": "2af87baac09c571fb35fb9c161647178cb57668b", "url": "https://github.com/metasfresh/metasfresh/commit/2af87baac09c571fb35fb9c161647178cb57668b", "message": "#6511 update bank statement lines and references processed flag on bank statement completion\n\nhttps://github.com/metasfresh/metasfresh/issues/6511", "committedDate": "2020-05-18T11:53:57Z", "type": "commit"}, {"oid": "389ee890d46e869045436f229eeb55fabeafac48", "url": "https://github.com/metasfresh/metasfresh/commit/389ee890d46e869045436f229eeb55fabeafac48", "message": "Merge branch 'invisible_croissant' into gh6511", "committedDate": "2020-05-18T11:54:22Z", "type": "commit"}, {"oid": "edf4a086af98dc41bf9369381a60e299ccbb2faa", "url": "https://github.com/metasfresh/metasfresh/commit/edf4a086af98dc41bf9369381a60e299ccbb2faa", "message": "#6511 repair pay selection trx type calculation\n\nhttps://github.com/metasfresh/metasfresh/issues/6511", "committedDate": "2020-05-19T11:09:15Z", "type": "commit"}, {"oid": "e6efd55973b43eac901782037c1eb5c52034f261", "url": "https://github.com/metasfresh/metasfresh/commit/e6efd55973b43eac901782037c1eb5c52034f261", "message": "Merge branch 'invisible_croissant' into gh6511_2", "committedDate": "2020-05-19T11:09:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIyNjM3OA==", "url": "https://github.com/metasfresh/metasfresh/pull/6686#discussion_r427226378", "bodyText": "pls change !='ARC' to ='ARI'.\nReason: avoid future doc base types to be matched by this rule.", "author": "teosarca", "createdAt": "2020-05-19T11:23:53Z", "path": "backend/de.metas.banking/de.metas.banking.base/src/main/java/de/metas/banking/payment/impl/PaySelectionUpdater.java", "diffHunk": "@@ -386,7 +386,7 @@ else if (getC_BP_Group_ID() > 0)\n \tprivate String buildSelectSQL_MatchRequirement()\n \t{\n \t\tfinal String whereCreditTransferToVendor = \" i.IsSOTrx='N' AND i.PaymentRule IN ('\" + PaymentRule.DirectDeposit.getCode() + \"','\" + PaymentRule.OnCredit.getCode() + \"') \";\n-\t\tfinal String whereDirectDebitFromCustomer = \" i.IsSOTrx='Y' AND dt.DocBaseType!='ARC' AND i.PaymentRule IN ('\" + PaymentRule.DirectDebit.getCode() + \"') \";\n+\t\tfinal String whereDirectDebitFromCustomer = \" i.IsSOTrx='Y' AND dt.DocBaseType!='ARC' AND i.PaymentRule IN ('\" + PaymentRule.DirectDebit.getCode() + \"','\" + PaymentRule.OnCredit.getCode() + \"') \";", "originalCommit": "e6efd55973b43eac901782037c1eb5c52034f261", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIzMTY0Mg==", "url": "https://github.com/metasfresh/metasfresh/pull/6686#discussion_r427231642", "bodyText": "Done", "author": "metas-rc", "createdAt": "2020-05-19T11:33:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIyNjM3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIyNjQ1NA==", "url": "https://github.com/metasfresh/metasfresh/pull/6686#discussion_r427226454", "bodyText": "pls change !='ARC' to ='ARI'.\nReason: avoid future doc base types to be matched by this rule.", "author": "teosarca", "createdAt": "2020-05-19T11:24:03Z", "path": "backend/de.metas.payment.sepa/base/src/main/sql/postgresql/ddl/views/C_Invoice_PaySelectionTrxType_V.sql", "diffHunk": "@@ -4,8 +4,8 @@ CREATE OR REPLACE VIEW C_Invoice_PaySelectionTrxType_V AS\n SELECT C_Invoice_ID,\n \tCASE \n \t\tWHEN /* CREDIT_TRANSFER_TO_VENDOR - \"OUT\" */ i.IsSOTrx='N' AND i.PaymentRule IN ('T'/*DirectDeposit*/, 'P'/*OnCredit*/) AND i.DocStatus IN ('CO', 'CL') THEN 'CT'\n-\t\tWHEN /* DIRECT_DEBIT_FROM_CUSTOMER - \"CDD\" */ i.IsSOTrx='Y' AND dt.DocBaseType = 'ARC' AND i.PaymentRule IN ('D'/*DirectDebit*/) AND i.DocStatus IN ('CO', 'CL') THEN 'DD'\n-\t\tWHEN /* CREDIT_TRANSFER_TO_CUSTOMER - \"CRE\" */ i.IsSOTrx='Y' AND dt.DocBaseType = 'ARC' AND i.PaymentRule IN ('T'/*DirectDeposit*/) AND i.DocStatus IN ('CO', 'CL') THEN 'CT'\n+\t\tWHEN /* DIRECT_DEBIT_FROM_CUSTOMER - \"CDD\" */ i.IsSOTrx='Y' AND dt.DocBaseType != 'ARC' AND i.PaymentRule IN ('D'/*DirectDebit*/, 'P'/*OnCredit*/) AND i.DocStatus IN ('CO', 'CL') THEN 'DD'", "originalCommit": "e6efd55973b43eac901782037c1eb5c52034f261", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIzMTY4OQ==", "url": "https://github.com/metasfresh/metasfresh/pull/6686#discussion_r427231689", "bodyText": "Done", "author": "metas-rc", "createdAt": "2020-05-19T11:33:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIyNjQ1NA=="}], "type": "inlineReview"}, {"oid": "2849cf8f5b693c66e0c4e8ed9742a49920708153", "url": "https://github.com/metasfresh/metasfresh/commit/2849cf8f5b693c66e0c4e8ed9742a49920708153", "message": "#6615 avoid future doc base types to be matched by this rule\n\nhttps://github.com/metasfresh/metasfresh/issues/6511", "committedDate": "2020-05-19T11:34:39Z", "type": "commit"}]}