{"pr_number": 10183, "pr_title": "unify SystemTime classes", "pr_createdAt": "2020-11-03T19:19:36Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/10183", "timeline": [{"oid": "6f55c16d556a19a6815dc57ff98bd1868d4230e3", "url": "https://github.com/metasfresh/metasfresh/commit/6f55c16d556a19a6815dc57ff98bd1868d4230e3", "message": "unify SystemTime classes", "committedDate": "2020-11-03T19:18:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5NDYzNQ==", "url": "https://github.com/metasfresh/metasfresh/pull/10183#discussion_r517094635", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t// SystemTime.setTimeSource(\n          \n          \n            \n            \t\t// \t\tFixedTimeSource.ofZonedDateTime(LocalDate.of(2020, Month.APRIL, 29)\n          \n          \n            \n            \t\t// \t\t\t\t.atTime(LocalTime.of(13, 14))\n          \n          \n            \n            \t\t// \t\t\t\t.atZone(ZoneId.of(\"UTC+5\"))));", "author": "metas-ts", "createdAt": "2020-11-04T04:44:25Z", "path": "backend/de.metas.adempiere.adempiere/base/src/test/java/org/compiere/util/TimeUtilTest.java", "diffHunk": "@@ -622,10 +621,11 @@ public void test_isDateOrTimeClass()\n \t@Test\n \tpublic void test_asTimestamp_asLocalDateWithTimeZone()\n \t{\n-\t\tSystemTime.setTimeSource(\n-\t\t\t\tFixedTimeSource.ofZonedDateTime(LocalDate.of(2020, Month.APRIL, 29)\n-\t\t\t\t\t\t.atTime(LocalTime.of(13, 14))\n-\t\t\t\t\t\t.atZone(ZoneId.of(\"UTC+5\"))));\n+\t\tSystemTime.setFixedTimeSource(\"2020-04-29T13:14:00+05:00\");\n+\t\t// SystemTime.setTimeSource(\n+\t\t// \t\tFixedTimeSource.ofZonedDateTime(LocalDate.of(2020, Month.APRIL, 29)\n+\t\t// \t\t\t\t.atTime(LocalTime.of(13, 14))\n+\t\t// \t\t\t\t.atZone(ZoneId.of(\"UTC+5\"))));", "originalCommit": "6f55c16d556a19a6815dc57ff98bd1868d4230e3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5NTM5OQ==", "url": "https://github.com/metasfresh/metasfresh/pull/10183#discussion_r517095399", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Please consider {@link de.metas.common.util.time.SystemTime}.\n          \n          \n            \n             * @deprecated please consider {@link de.metas.common.util.time.SystemTime}.", "author": "metas-ts", "createdAt": "2020-11-04T04:47:28Z", "path": "backend/de.metas.util/src/main/java/de/metas/util/time/SystemTime.java", "diffHunk": "@@ -1,59 +1,26 @@\n package de.metas.util.time;\n \n+import lombok.NonNull;\n+import lombok.experimental.UtilityClass;\n+\n import java.sql.Timestamp;\n import java.time.Instant;\n import java.time.LocalDate;\n import java.time.LocalDateTime;\n import java.time.ZoneId;\n import java.time.ZonedDateTime;\n-import java.time.temporal.ChronoUnit;\n-import java.util.Calendar;\n import java.util.Date;\n import java.util.GregorianCalendar;\n \n-import javax.annotation.Nullable;\n-\n-/*\n- * #%L\n- * de.metas.util\n- * %%\n- * Copyright (C) 2015 metas GmbH\n- * %%\n- * This program is free software: you can redistribute it and/or modify\n- * it under the terms of the GNU General Public License as\n- * published by the Free Software Foundation, either version 2 of the\n- * License, or (at your option) any later version.\n- *\n- * This program is distributed in the hope that it will be useful,\n- * but WITHOUT ANY WARRANTY; without even the implied warranty of\n- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n- * GNU General Public License for more details.\n- *\n- * You should have received a copy of the GNU General Public\n- * License along with this program. If not, see\n- * <http://www.gnu.org/licenses/gpl-2.0.html>.\n- * #L%\n- */\n-\n-import lombok.NonNull;\n-import lombok.experimental.UtilityClass;\n-\n /**\n- * Code taken from the book \"Test Driven\", Chapter 7 (\"Test-driving the\n- * unpredictable\") by Lasse Koskela.\n- *\n- * @author ts\n+ * Please consider {@link de.metas.common.util.time.SystemTime}.", "originalCommit": "6f55c16d556a19a6815dc57ff98bd1868d4230e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NTIzOQ==", "url": "https://github.com/metasfresh/metasfresh/pull/10183#discussion_r517245239", "bodyText": "yup... and additionally i will also replace the current usages. Just to not introduce another 600 warnings.", "author": "teosarca", "createdAt": "2020-11-04T10:31:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5NTM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1NjUxMQ==", "url": "https://github.com/metasfresh/metasfresh/pull/10183#discussion_r517256511", "bodyText": "update: i've removed that class", "author": "teosarca", "createdAt": "2020-11-04T10:50:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5NTM5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5NTg3NQ==", "url": "https://github.com/metasfresh/metasfresh/pull/10183#discussion_r517095875", "bodyText": "i suggest you add a javadoc with something like \"see {@link ZonedDateTimeparse(String)}\"", "author": "metas-ts", "createdAt": "2020-11-04T04:49:39Z", "path": "misc/de-metas-common/de-metas-common-util/src/main/java/de/metas/common/util/time/SystemTime.java", "diffHunk": "@@ -68,6 +73,11 @@ public void setFixedTimeSource(@NonNull final ZonedDateTime date)\n \t\tsetTimeSource(FixedTimeSource.ofZonedDateTime(date));\n \t}\n \n+\tpublic void setFixedTimeSource(@NonNull final String zonedDateTime)", "originalCommit": "6f55c16d556a19a6815dc57ff98bd1868d4230e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1Mzk3Mg==", "url": "https://github.com/metasfresh/metasfresh/pull/10183#discussion_r517253972", "bodyText": "done", "author": "teosarca", "createdAt": "2020-11-04T10:45:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5NTg3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5NjI0MA==", "url": "https://github.com/metasfresh/metasfresh/pull/10183#discussion_r517096240", "bodyText": "Deprecate this timesource too?", "author": "metas-ts", "createdAt": "2020-11-04T04:51:01Z", "path": "backend/de.metas.util/src/main/java/de/metas/util/time/TimeSource.java", "diffHunk": "@@ -25,7 +25,7 @@\n  */\n \n @FunctionalInterface\n-public interface TimeSource\n+public interface TimeSource extends de.metas.common.util.time.TimeSource", "originalCommit": "6f55c16d556a19a6815dc57ff98bd1868d4230e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1MTUwNQ==", "url": "https://github.com/metasfresh/metasfresh/pull/10183#discussion_r517251505", "bodyText": "actually, I will delete it", "author": "teosarca", "createdAt": "2020-11-04T10:41:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5NjI0MA=="}], "type": "inlineReview"}, {"oid": "18055240e9325ca503fa09dd30b37c316a5aace9", "url": "https://github.com/metasfresh/metasfresh/commit/18055240e9325ca503fa09dd30b37c316a5aace9", "message": "Update backend/de.metas.adempiere.adempiere/base/src/test/java/org/compiere/util/TimeUtilTest.java\n\nCo-authored-by: Tobias Sch\u00f6neberg <metas-ts@users.noreply.github.com>", "committedDate": "2020-11-04T10:12:04Z", "type": "commit"}, {"oid": "459fcde487f0cbbb80eb52303b3343dfa56fc005", "url": "https://github.com/metasfresh/metasfresh/commit/459fcde487f0cbbb80eb52303b3343dfa56fc005", "message": "deprecate de.metas.util.time.SystemTime", "committedDate": "2020-11-04T10:28:22Z", "type": "commit"}, {"oid": "58dc3b0d452aba46b7d0aeb6e65a5f6cdadfeded", "url": "https://github.com/metasfresh/metasfresh/commit/58dc3b0d452aba46b7d0aeb6e65a5f6cdadfeded", "message": "remove de.metas.util.time.SystemTime and de.metas.util.time.TimeSource", "committedDate": "2020-11-04T10:44:08Z", "type": "commit"}, {"oid": "a0aee2f2e902e50b17adf965142259f163dcd744", "url": "https://github.com/metasfresh/metasfresh/commit/a0aee2f2e902e50b17adf965142259f163dcd744", "message": "javadoc", "committedDate": "2020-11-04T10:45:25Z", "type": "commit"}, {"oid": "bfc1092a3e0870cd75b4fee12d8675fb91b77a99", "url": "https://github.com/metasfresh/metasfresh/commit/bfc1092a3e0870cd75b4fee12d8675fb91b77a99", "message": "Merge remote-tracking branch 'origin/master' into unify_SystemTime_classes\n\n# Conflicts:\n#\tbackend/metasfresh-webui-api/src/main/java/de/metas/ui/web/payment_allocation/process/PaymentsViewAllocateCommand.java", "committedDate": "2020-11-04T10:47:16Z", "type": "commit"}, {"oid": "699046e4bb8e53b7ca61445e2b7f421a8b4385aa", "url": "https://github.com/metasfresh/metasfresh/commit/699046e4bb8e53b7ca61445e2b7f421a8b4385aa", "message": "fix after merge", "committedDate": "2020-11-04T10:49:06Z", "type": "commit"}]}