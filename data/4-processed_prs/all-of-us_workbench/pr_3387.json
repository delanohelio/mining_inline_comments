{"pr_number": 3387, "pr_title": "[RW-4749][risk=no] Add Google Analytics for Registration pages", "pr_createdAt": "2020-04-13T19:05:17Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3387", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4ODc4Ng==", "url": "https://github.com/all-of-us/workbench/pull/3387#discussion_r407788786", "bodyText": "\ud83e\udd86", "author": "calbach", "createdAt": "2020-04-14T00:05:27Z", "path": "ui/src/app/pages/homepage/registration-dashboard.tsx", "diffHunk": "@@ -137,7 +141,10 @@ export const getRegistrationTasks = () => serverConfigStore.getValue() ? ([\n     completionTimestamp: (profile: Profile) => {\n       return profile.dataUseAgreementCompletionTime || profile.dataUseAgreementBypassTime;\n     },\n-    onClick: () => navigate(['data-code-of-conduct'])\n+    onClick: () => {\n+      AnalyticsTracker.Registration.EnterDUCC();", "originalCommit": "3dd42c6aa01be486991225b868d3c6244be4a673", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM1MzQ4Ng==", "url": "https://github.com/all-of-us/workbench/pull/3387#discussion_r408353486", "bodyText": "\ud83d\ude06", "author": "dolbeew", "createdAt": "2020-04-14T18:38:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4ODc4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc5MDU5Nw==", "url": "https://github.com/all-of-us/workbench/pull/3387#discussion_r407790597", "bodyText": "nit: For separation of responsibilities, I'd probably put this in the onSubmit callback below - since the createAccount method has no direct relationship to the demographics survey as a step", "author": "calbach", "createdAt": "2020-04-14T00:11:48Z", "path": "ui/src/app/pages/login/account-creation/account-creation-survey.tsx", "diffHunk": "@@ -35,6 +37,7 @@ export class AccountCreationSurvey extends React.Component<AccountCreationSurvey\n     const {invitationKey, termsOfServiceVersion, onComplete} = this.props;\n \n     try {\n+      AnalyticsTracker.Registration.DemographicSurvey();", "originalCommit": "3dd42c6aa01be486991225b868d3c6244be4a673", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNDU0Ng==", "url": "https://github.com/all-of-us/workbench/pull/3387#discussion_r408334546", "bodyText": "Makes sense. Done.", "author": "dolbeew", "createdAt": "2020-04-14T18:06:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc5MDU5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc5MTQzMw==", "url": "https://github.com/all-of-us/workbench/pull/3387#discussion_r407791433", "bodyText": "You can view this page from the profile as well. Does it make sense this bump this up to a higher level callback in the registration flow instead? Since the metric is registration specific", "author": "calbach", "createdAt": "2020-04-14T00:14:31Z", "path": "ui/src/app/pages/profile/data-user-code-of-conduct.tsx", "diffHunk": "@@ -231,6 +232,7 @@ export const DataUserCodeOfConduct = withUserProfile()(\n                       data-test-id={'submit-ducc-button'}\n                       disabled={errors || submitting}\n                       onClick={() => {\n+                        AnalyticsTracker.Registration.AcceptDUCC();", "originalCommit": "3dd42c6aa01be486991225b868d3c6244be4a673", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0OTg1OQ==", "url": "https://github.com/all-of-us/workbench/pull/3387#discussion_r408349859", "bodyText": "That does make sense, but doesn't look like there's a higher callback. The submit function just calls window.history.back() when complete.\nI'm not too familiar with this workflow but seems like we should disable the Accept button if the user has already accepted the agreement. Currently they can view and accept as many times as they want.", "author": "dolbeew", "createdAt": "2020-04-14T18:32:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc5MTQzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM2NTkyMQ==", "url": "https://github.com/all-of-us/workbench/pull/3387#discussion_r408365921", "bodyText": "OK, maybe just leave a comment for now. I think the flow from the profile page may still be a bit in flux so I don't know how well this models the desired end state, or if we should consider that behavior a bug; @als364 probably knows the state of this.", "author": "calbach", "createdAt": "2020-04-14T18:59:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc5MTQzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODkxOTk0NQ==", "url": "https://github.com/all-of-us/workbench/pull/3387#discussion_r408919945", "bodyText": "There are no current plans to change this. Before I changed the workflow you could still re-sign the DUCC from the profile page. I'm not sure whether we still want to do that, that's really more of a product question. I could see either allowing or disallowing re-signing making sense.", "author": "als364", "createdAt": "2020-04-15T15:11:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc5MTQzMw=="}], "type": "inlineReview"}, {"oid": "7f024e8176d46bce731f1f82d816595f6ff3a5ab", "url": "https://github.com/all-of-us/workbench/commit/7f024e8176d46bce731f1f82d816595f6ff3a5ab", "message": "RW-4749 pr feedback", "committedDate": "2020-04-14T18:47:05Z", "type": "forcePushed"}, {"oid": "a28fc27fa3fd3e96836d58c6858dc9f4a5377b2f", "url": "https://github.com/all-of-us/workbench/commit/a28fc27fa3fd3e96836d58c6858dc9f4a5377b2f", "message": "RW-4749 add google analytics for registration events", "committedDate": "2020-04-15T16:20:21Z", "type": "commit"}, {"oid": "6845038475bb008a6e22c9dd1bf1191b6acc81fd", "url": "https://github.com/all-of-us/workbench/commit/6845038475bb008a6e22c9dd1bf1191b6acc81fd", "message": "RW-4749 pr feedback", "committedDate": "2020-04-15T16:20:21Z", "type": "commit"}, {"oid": "e4fb0d0b1d514dd29d6382df1944bda339eafd92", "url": "https://github.com/all-of-us/workbench/commit/e4fb0d0b1d514dd29d6382df1944bda339eafd92", "message": "RW-4749 add comment at DUCC accept event", "committedDate": "2020-04-15T16:20:21Z", "type": "commit"}, {"oid": "e4fb0d0b1d514dd29d6382df1944bda339eafd92", "url": "https://github.com/all-of-us/workbench/commit/e4fb0d0b1d514dd29d6382df1944bda339eafd92", "message": "RW-4749 add comment at DUCC accept event", "committedDate": "2020-04-15T16:20:21Z", "type": "forcePushed"}]}