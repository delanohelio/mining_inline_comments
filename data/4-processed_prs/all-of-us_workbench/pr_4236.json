{"pr_number": 4236, "pr_title": "[RW-5831][risk=medium] Show warning message when 1000 concepts are added", "pr_createdAt": "2020-11-02T15:21:24Z", "pr_url": "https://github.com/all-of-us/workbench/pull/4236", "timeline": [{"oid": "765047161544ecaacd5e794192d319c42eeebc86", "url": "https://github.com/all-of-us/workbench/commit/765047161544ecaacd5e794192d319c42eeebc86", "message": "1000 Concept limit for concept set", "committedDate": "2020-11-02T14:40:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE0MDY5Mg==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r516140692", "bodyText": "Can you put a similar check in CriteriaTree component to limit selections in the hierarchy view also? I was able to max it out, then switch to the tree and select more concepts. If the layout works, it may be better to move the message up to CriteriaSearch so we can use the same one for both views.", "author": "dolbeew", "createdAt": "2020-11-02T17:30:15Z", "path": "ui/src/app/cohort-search/list-search-v2/list-search-v2.component.tsx", "diffHunk": "@@ -336,6 +340,11 @@ export const ListSearchV2 = fp.flow(withCdrVersions(), withCurrentWorkspace(), w\n       return [Domain.CONDITION, Domain.PROCEDURE].includes(this.props.searchContext.domain);\n     }\n \n+    selectIconDisabled() {\n+      const {selectedIds, source} = this.props;\n+      return source !== 'criteria' && selectedIds && selectedIds.length === 1000;", "originalCommit": "765047161544ecaacd5e794192d319c42eeebc86", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE0NTQwMQ==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r516145401", "bodyText": "Also, can you change=== to >= so it will disable in case somehow we get more more than 1000 selections?\nAnd should we remove source !== 'criteria' since I think we need this limit fo cohort builder also? We'd just need to show different text in the message if source === 'criteria'.", "author": "dolbeew", "createdAt": "2020-11-02T17:38:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE0MDY5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5Mjc0Mw==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r517092743", "bodyText": "I was not able to check the tree structure for concept Set. Regarding cohort i will create another PR just to keep them separate.", "author": "NehaBroad", "createdAt": "2020-11-04T04:35:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE0MDY5Mg=="}], "type": "inlineReview"}, {"oid": "8929e03c28e4c8390442687aa30817d3bdf51f18", "url": "https://github.com/all-of-us/workbench/commit/8929e03c28e4c8390442687aa30817d3bdf51f18", "message": "PR Comments", "committedDate": "2020-11-04T04:34:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxMzg2NQ==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r517413865", "bodyText": "nit: Remove '1'", "author": "dolbeew", "createdAt": "2020-11-04T15:09:51Z", "path": "ui/src/app/cohort-search/tree-node/tree-node.component.tsx", "diffHunk": "@@ -335,8 +344,13 @@ export class TreeNode extends React.Component<TreeNodeProps, TreeNodeState> {\n     const displayName = domainId === Domain.PHYSICALMEASUREMENT.toString() && !!searchTerms\n       ? highlightSearchTerm(searchTerms, name, colors.success)\n       : name;\n+    const selectIconStyle = this.selectIconDisabled() ? {...styles.selectIcon, ...styles.disableSelectIcon} : styles.selectIcon;\n+\n     return <React.Fragment>\n-      <div style={{...styles.treeNode}} id={`node${id}`} onClick={() => this.toggleExpanded()}>\n+      {this.selectIconDisabled() && <div style={{color: colors.warning, fontWeight: 'bold', maxWidth: '1000px'}}>\n+        NOTE: Concept Set can have only 1000 concepts. Please delete some concepts before adding more.\n+      </div>}1", "originalCommit": "8929e03c28e4c8390442687aa30817d3bdf51f18", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5MjI1MQ==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r517792251", "bodyText": "Done", "author": "NehaBroad", "createdAt": "2020-11-05T04:55:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxMzg2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQyMTQwNw==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r517421407", "bodyText": "I think we should consolidate these since the styles are the same. Maybe rename to something like disableIcon so it make sense for both cases.", "author": "dolbeew", "createdAt": "2020-11-04T15:20:21Z", "path": "ui/src/app/cohort-search/tree-node/tree-node.component.tsx", "diffHunk": "@@ -81,6 +81,10 @@ const styles = reactStyles({\n     color: colors.select,\n     margin: '5px'\n   },\n+  disableSelectIcon: {\n+    opacity: 0.4,\n+    cursor: 'not-allowed'\n+  },\n   selected: {\n     cursor: 'not-allowed',\n     opacity: 0.4", "originalCommit": "8929e03c28e4c8390442687aa30817d3bdf51f18", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5NDA4MA==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r517794080", "bodyText": "Done", "author": "NehaBroad", "createdAt": "2020-11-05T05:02:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQyMTQwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQyMzIzMw==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r517423233", "bodyText": "selectIconStyle should be on the second icon here. First icon should still be {...styles.selectIcon, ...styles.selected}", "author": "dolbeew", "createdAt": "2020-11-04T15:22:52Z", "path": "ui/src/app/cohort-search/tree-node/tree-node.component.tsx", "diffHunk": "@@ -354,7 +368,7 @@ export class TreeNode extends React.Component<TreeNodeProps, TreeNodeState> {\n                   shape='slider' dir='right' size='20'\n                   onClick={(e) => this.setAttributes(e, node)}/>\n               : selected\n-                ? <ClrIcon style={{...styles.selectIcon, ...styles.selected}}\n+                ? <ClrIcon style={selectIconStyle}\n                     shape='check-circle' size='20'/>\n                 : <ClrIcon style={styles.selectIcon}\n                     shape='plus-circle' size='20'", "originalCommit": "8929e03c28e4c8390442687aa30817d3bdf51f18", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5MjMzMQ==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r517792331", "bodyText": "Fixed", "author": "NehaBroad", "createdAt": "2020-11-05T04:55:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQyMzIzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQyNjY3Mg==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r517426672", "bodyText": "This message should move up to CriteriaTree or CriteriaSearch. Currently it displays above every tree node:", "author": "dolbeew", "createdAt": "2020-11-04T15:27:35Z", "path": "ui/src/app/cohort-search/tree-node/tree-node.component.tsx", "diffHunk": "@@ -335,8 +344,13 @@ export class TreeNode extends React.Component<TreeNodeProps, TreeNodeState> {\n     const displayName = domainId === Domain.PHYSICALMEASUREMENT.toString() && !!searchTerms\n       ? highlightSearchTerm(searchTerms, name, colors.success)\n       : name;\n+    const selectIconStyle = this.selectIconDisabled() ? {...styles.selectIcon, ...styles.disableSelectIcon} : styles.selectIcon;\n+\n     return <React.Fragment>\n-      <div style={{...styles.treeNode}} id={`node${id}`} onClick={() => this.toggleExpanded()}>\n+      {this.selectIconDisabled() && <div style={{color: colors.warning, fontWeight: 'bold', maxWidth: '1000px'}}>\n+        NOTE: Concept Set can have only 1000 concepts. Please delete some concepts before adding more.", "originalCommit": "8929e03c28e4c8390442687aa30817d3bdf51f18", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5MjM1Ng==", "url": "https://github.com/all-of-us/workbench/pull/4236#discussion_r517792356", "bodyText": "Fixed", "author": "NehaBroad", "createdAt": "2020-11-05T04:55:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQyNjY3Mg=="}], "type": "inlineReview"}, {"oid": "65baceea3e34a9aa92887dea30771500dc4e9b4b", "url": "https://github.com/all-of-us/workbench/commit/65baceea3e34a9aa92887dea30771500dc4e9b4b", "message": "Fix tree message  placement", "committedDate": "2020-11-05T04:54:58Z", "type": "commit"}, {"oid": "90a432619ba24bf399fa46f6b423218c0bd3d2b7", "url": "https://github.com/all-of-us/workbench/commit/90a432619ba24bf399fa46f6b423218c0bd3d2b7", "message": "Fix styles", "committedDate": "2020-11-05T05:01:44Z", "type": "commit"}]}