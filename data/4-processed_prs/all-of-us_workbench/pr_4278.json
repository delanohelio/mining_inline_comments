{"pr_number": 4278, "pr_title": "[RW-5690][risk=no] Navigate away from notebooks iframe on runtime status change", "pr_createdAt": "2020-11-12T01:21:26Z", "pr_url": "https://github.com/all-of-us/workbench/pull/4278", "timeline": [{"oid": "b76eed4fcb3e5b656201f2a1ffb15f9c32992133", "url": "https://github.com/all-of-us/workbench/commit/b76eed4fcb3e5b656201f2a1ffb15f9c32992133", "message": "Test", "committedDate": "2020-11-12T06:26:15Z", "type": "forcePushed"}, {"oid": "7ba6a2e5f6e9656a32d063f25708534c5395f4c5", "url": "https://github.com/all-of-us/workbench/commit/7ba6a2e5f6e9656a32d063f25708534c5395f4c5", "message": "Test", "committedDate": "2020-11-12T18:59:58Z", "type": "forcePushed"}, {"oid": "aa9515c96108cf6b7ed604d1c90bc0750ebc4474", "url": "https://github.com/all-of-us/workbench/commit/aa9515c96108cf6b7ed604d1c90bc0750ebc4474", "message": "Test", "committedDate": "2020-11-12T19:01:32Z", "type": "forcePushed"}, {"oid": "93909e39f814338ea4889bdbec7acb3ee66d5c81", "url": "https://github.com/all-of-us/workbench/commit/93909e39f814338ea4889bdbec7acb3ee66d5c81", "message": "Navigate away", "committedDate": "2020-11-12T20:05:24Z", "type": "commit"}, {"oid": "4543954ae3128e59e2c2d2f4d2ff1d6c9f82dda3", "url": "https://github.com/all-of-us/workbench/commit/4543954ae3128e59e2c2d2f4d2ff1d6c9f82dda3", "message": "Test", "committedDate": "2020-11-12T20:05:25Z", "type": "commit"}, {"oid": "4543954ae3128e59e2c2d2f4d2ff1d6c9f82dda3", "url": "https://github.com/all-of-us/workbench/commit/4543954ae3128e59e2c2d2f4d2ff1d6c9f82dda3", "message": "Test", "committedDate": "2020-11-12T20:05:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU0NjM2OQ==", "url": "https://github.com/all-of-us/workbench/pull/4278#discussion_r522546369", "bodyText": "Would this syntax work? Slightly easier to read IMO since its on one line: jest.spyOn(NavStore, 'navigate')", "author": "ericsong", "createdAt": "2020-11-13T01:12:44Z", "path": "ui/src/app/pages/analysis/notebook-redirect.spec.tsx", "diffHunk": "@@ -213,4 +214,37 @@ describe('NotebookRedirect', () => {\n     expect(currentCardText(wrapper))\n       .toContain(progressStrings.get(Progress.Redirecting));\n   });\n+\n+  it('should navigate away after runtime transitions to deleting', async() => {\n+    const navSpy = jest.fn();\n+    NavStore.navigate = navSpy;", "originalCommit": "4543954ae3128e59e2c2d2f4d2ff1d6c9f82dda3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU1Mjg0MQ==", "url": "https://github.com/all-of-us/workbench/pull/4278#discussion_r522552841", "bodyText": "NavStore is a bit odd - by default its methods are undefined... I think we may need to clean this up later for testing purposes. Unfortunately this doesn't work:\n Cannot spy the navigate property because it is not a function; undefined given instead\n\n      217 | \n      218 |   it('should navigate away after runtime transitions to deleting', async() => {\n    > 219 |     const navSpy = jest.spyOn(NavStore, 'navigate').mockImplementation(() => {});\n\nThere's also a problem with my current approach, which is that I never clear/restore the value of navigate. That said, it was undefined to begin with, so this is not the end of the world..", "author": "calbach", "createdAt": "2020-11-13T01:33:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU0NjM2OQ=="}], "type": "inlineReview"}]}