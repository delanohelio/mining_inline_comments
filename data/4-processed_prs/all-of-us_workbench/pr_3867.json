{"pr_number": 3867, "pr_title": "[RW-4594][risk=low] UI: add modifiers slideout (phase 1)", "pr_createdAt": "2020-08-10T04:19:59Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3867", "timeline": [{"oid": "2aba778f1f9b0660d8d33f647abcca3d74ca514f", "url": "https://github.com/all-of-us/workbench/commit/2aba778f1f9b0660d8d33f647abcca3d74ca514f", "message": "Apply Modifier Page", "committedDate": "2020-08-10T04:16:18Z", "type": "commit"}, {"oid": "f84e37750c1d18688200528e92f2ffbb70a43f4d", "url": "https://github.com/all-of-us/workbench/commit/f84e37750c1d18688200528e92f2ffbb70a43f4d", "message": "Revert Cohort Flag", "committedDate": "2020-08-10T04:19:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY4MTYwMg==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r467681602", "bodyText": "I just rename the old modifier-page to modifier-page-modal.component.tsx", "author": "NehaBroad", "createdAt": "2020-08-10T04:21:20Z", "path": "ui/src/app/cohort-search/modifier-page/modifier-page-modal.component.tsx", "diffHunk": "@@ -0,0 +1,568 @@\n+import * as fp from 'lodash/fp';", "originalCommit": "f84e37750c1d18688200528e92f2ffbb70a43f4d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3ab6389ce53579718f8ce0196a1e0e575973159e", "url": "https://github.com/all-of-us/workbench/commit/3ab6389ce53579718f8ce0196a1e0e575973159e", "message": "Correct Indent", "committedDate": "2020-08-10T04:24:54Z", "type": "commit"}, {"oid": "11700cc0303cce9e45d6bde897d23f2251fcab69", "url": "https://github.com/all-of-us/workbench/commit/11700cc0303cce9e45d6bde897d23f2251fcab69", "message": "Correct Indent", "committedDate": "2020-08-10T04:27:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA0NDcxNA==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468044714", "bodyText": "We'll need a condition on this button since Physical Measurements and Demographics don't get modifiers.\nAlso, the mocks show this at the bottom of the list container. Maybe use something like position: absolute; bottom: 0; on the button, may also need to set position: relative on the parent div to work.\nI know the mocks don't really show hover styles, but the current hover style looks too dark:\n\nMaybe a slight change in text and/or border color on hover like we do with the Calculate button for modifiers and attributes.", "author": "dolbeew", "createdAt": "2020-08-10T16:54:20Z", "path": "ui/src/app/cohort-search/selection-list/selection-list.component.tsx", "diffHunk": "@@ -335,22 +356,42 @@ export const SelectionList = withCurrentCohortCriteria()(class extends React.Com\n     </React.Fragment> ;\n   }\n \n+  applyModifier(modifiers) {\n+    if (modifiers) {\n+      const modifierButtonText = '(' + modifiers.length + ')  MODIFIERS APPLIED';\n+      this.setState({showModifiersSlide: false, modifierButtonText: modifierButtonText});\n+    } else {\n+      this.setState({showModifiersSlide: false, modifierButtonText: 'APPLY MODIFIERS'});\n+    }\n+\n+  }\n+\n   render() {\n     const {back, criteria} = this.props;\n+    const {modifierButtonText, showModifiersSlide} = this.state;\n     return <div>\n-      <div style={{paddingTop: '0.5rem'}}>\n-        {criteria && <div style={styles.selectionContainer}>\n+        {!showModifiersSlide && criteria &&  <React.Fragment>\n+          <h3 style={{...styles.sectionTitle, marginTop: 0}}>Add selected criteria to cohort</h3>\n+        <div style={{paddingTop: '0.5rem'}}>\n+          <div style={styles.selectionContainer}>\n           {this.renderCriteria()}\n-        </div>}\n-      </div>\n-      <FlexRowWrap style={{flexDirection: 'row-reverse', marginTop: '2rem'}}>\n+          <div style = {{padding: '1rem 0 1.2rem 1.2rem'}}>\n+        <Button style={{backgroundColor: colors.white, border: '0.1rem solid' + colors.accent, color: colors.accent}}\n+                onClick = {() => this.setState({showModifiersSlide: true})}>\n+        {modifierButtonText}\n+        </Button>", "originalCommit": "11700cc0303cce9e45d6bde897d23f2251fcab69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI1ODMxNQ==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r469258315", "bodyText": "Done, please do let me know if the new highlight color works", "author": "NehaBroad", "createdAt": "2020-08-12T13:27:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA0NDcxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0NDg2NA==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468144864", "bodyText": "My first instinct was to say we need to move ModifierPage to HelpSidebar like we have the attributes component, but I think it might be better if we move attributes here instead. That would make all the flipping back and forth between views simpler and also clean up the sidebar template a little.\nI can include moving the attributes in RW-5114 after this merges, or we can just do a separate ticket if needed.", "author": "dolbeew", "createdAt": "2020-08-10T19:53:28Z", "path": "ui/src/app/cohort-search/selection-list/selection-list.component.tsx", "diffHunk": "@@ -335,22 +356,42 @@ export const SelectionList = withCurrentCohortCriteria()(class extends React.Com\n     </React.Fragment> ;\n   }\n \n+  applyModifier(modifiers) {\n+    if (modifiers) {\n+      const modifierButtonText = '(' + modifiers.length + ')  MODIFIERS APPLIED';\n+      this.setState({showModifiersSlide: false, modifierButtonText: modifierButtonText});\n+    } else {\n+      this.setState({showModifiersSlide: false, modifierButtonText: 'APPLY MODIFIERS'});\n+    }\n+\n+  }\n+\n   render() {\n     const {back, criteria} = this.props;\n+    const {modifierButtonText, showModifiersSlide} = this.state;\n     return <div>\n-      <div style={{paddingTop: '0.5rem'}}>\n-        {criteria && <div style={styles.selectionContainer}>\n+        {!showModifiersSlide && criteria &&  <React.Fragment>\n+          <h3 style={{...styles.sectionTitle, marginTop: 0}}>Add selected criteria to cohort</h3>\n+        <div style={{paddingTop: '0.5rem'}}>\n+          <div style={styles.selectionContainer}>\n           {this.renderCriteria()}\n-        </div>}\n-      </div>\n-      <FlexRowWrap style={{flexDirection: 'row-reverse', marginTop: '2rem'}}>\n+          <div style = {{padding: '1rem 0 1.2rem 1.2rem'}}>\n+        <Button style={{backgroundColor: colors.white, border: '0.1rem solid' + colors.accent, color: colors.accent}}\n+                onClick = {() => this.setState({showModifiersSlide: true})}>\n+        {modifierButtonText}\n+        </Button>\n+        </div>\n+        </div></div>\n+        </React.Fragment>}\n+        {showModifiersSlide && <ModifierPage selections={criteria} applyModifiers={(modifier) => this.applyModifier(modifier)}/>}", "originalCommit": "11700cc0303cce9e45d6bde897d23f2251fcab69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI2MDE1Nw==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r469260157", "bodyText": "Lets chat about this offline, i have few questions", "author": "NehaBroad", "createdAt": "2020-08-12T13:30:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0NDg2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0ODM2MA==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468148360", "bodyText": "Remove if no longer needed", "author": "dolbeew", "createdAt": "2020-08-10T20:00:14Z", "path": "ui/src/app/cohort-search/modifier-page/modifier-page.component.tsx", "diffHunk": "@@ -309,20 +287,21 @@ export const ModifierPage = withCurrentWorkspace()(\n       }\n       this.setState({formState});\n       this.getExisting();\n+        // this.setState({searchContext: this.props.cohortContext});", "originalCommit": "11700cc0303cce9e45d6bde897d23f2251fcab69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY2MzEwMQ==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r469663101", "bodyText": "Done", "author": "NehaBroad", "createdAt": "2020-08-13T02:39:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0ODM2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5ODQ4MQ==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468198481", "bodyText": "Nice reusable component", "author": "dolbeew", "createdAt": "2020-08-10T21:33:15Z", "path": "ui/src/app/cohort-search/attributes-page-v2/attributes-page-v2.component.tsx", "diffHunk": "@@ -126,6 +126,24 @@ const styles = reactStyles({\n   },\n });\n \n+export const CalculateFooter = (props) => {", "originalCommit": "11700cc0303cce9e45d6bde897d23f2251fcab69", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY2MjQ5MQ==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468662491", "bodyText": "I think we can simplify the conditions here, something like:\n{!showModifiersSlide\n  ? criteria && <React.Fragment>\n      // selection list template\n    </React.Fragment>\n    <FlexRowWrap>\n      // save & back buttons\n    </FlexRowWrap>\n  : <ModifierPage />\n}", "author": "dolbeew", "createdAt": "2020-08-11T15:18:49Z", "path": "ui/src/app/cohort-search/selection-list/selection-list.component.tsx", "diffHunk": "@@ -335,22 +356,42 @@ export const SelectionList = withCurrentCohortCriteria()(class extends React.Com\n     </React.Fragment> ;\n   }\n \n+  applyModifier(modifiers) {\n+    if (modifiers) {\n+      const modifierButtonText = '(' + modifiers.length + ')  MODIFIERS APPLIED';\n+      this.setState({showModifiersSlide: false, modifierButtonText: modifierButtonText});\n+    } else {\n+      this.setState({showModifiersSlide: false, modifierButtonText: 'APPLY MODIFIERS'});\n+    }\n+\n+  }\n+\n   render() {\n     const {back, criteria} = this.props;\n+    const {modifierButtonText, showModifiersSlide} = this.state;\n     return <div>\n-      <div style={{paddingTop: '0.5rem'}}>\n-        {criteria && <div style={styles.selectionContainer}>\n+        {!showModifiersSlide && criteria &&  <React.Fragment>", "originalCommit": "11700cc0303cce9e45d6bde897d23f2251fcab69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY5ODgxOQ==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468698819", "bodyText": "Also, do we need to include criteria in the condition? I haven't tested this, but seems like it would always be true if we're already in the selection-list.", "author": "dolbeew", "createdAt": "2020-08-11T16:11:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY2MjQ5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI1OTMwMw==", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r469259303", "bodyText": "Done.", "author": "NehaBroad", "createdAt": "2020-08-12T13:28:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY2MjQ5MQ=="}], "type": "inlineReview"}, {"oid": "073b265ebbef5922c4c3ff19915c725038232cef", "url": "https://github.com/all-of-us/workbench/commit/073b265ebbef5922c4c3ff19915c725038232cef", "message": "PR Comments: Button layout and highlight", "committedDate": "2020-08-12T13:26:50Z", "type": "commit"}, {"oid": "1bbe447ba1b2e347f880e9d8e2a189bd4f4fe130", "url": "https://github.com/all-of-us/workbench/commit/1bbe447ba1b2e347f880e9d8e2a189bd4f4fe130", "message": "Will s Awesome suggestion", "committedDate": "2020-08-13T02:39:05Z", "type": "commit"}]}