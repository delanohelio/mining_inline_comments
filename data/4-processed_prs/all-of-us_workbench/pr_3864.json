{"pr_number": 3864, "pr_title": "[RW-5319][risk=no] Migrate sex at birth concept id when saving a review", "pr_createdAt": "2020-08-06T15:43:04Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3864", "timeline": [{"oid": "4e97b47476e4c2b11762dcf8bfbec6e3528caa0d", "url": "https://github.com/all-of-us/workbench/commit/4e97b47476e4c2b11762dcf8bfbec6e3528caa0d", "message": "RW-5319 adding sex at birth to response", "committedDate": "2020-08-06T15:33:54Z", "type": "commit"}, {"oid": "689b9ba8962db73807f3a40c17d734de527ff057", "url": "https://github.com/all-of-us/workbench/commit/689b9ba8962db73807f3a40c17d734de527ff057", "message": "RW-5319\nfixing tests", "committedDate": "2020-08-06T15:33:54Z", "type": "commit"}, {"oid": "76c4747185b64d39387de7b864d121521efa374a", "url": "https://github.com/all-of-us/workbench/commit/76c4747185b64d39387de7b864d121521efa374a", "message": "RW-5319 fixing test cases", "committedDate": "2020-08-06T17:00:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYxMjM1OA==", "url": "https://github.com/all-of-us/workbench/pull/3864#discussion_r466612358", "bodyText": "this could be moved to a method (maybe pass Participant Id) and called again", "author": "NehaBroad", "createdAt": "2020-08-06T18:40:38Z", "path": "api/src/bigquerytest/java/org/pmiops/workbench/api/CohortReviewControllerBQTest.java", "diffHunk": "@@ -209,57 +207,47 @@ public void setUp() {\n     stubMockFirecloudGetWorkspaceAcl();\n \n     Gson gson = new Gson();\n-    cohortWithoutEHRData = new DbCohort();\n+    DbCohort cohortWithoutEHRData = new DbCohort();\n     cohortWithoutEHRData.setWorkspaceId(workspace.getWorkspaceId());\n     cohortWithoutEHRData.setCriteria(gson.toJson(SearchRequests.males()));\n     cohortWithoutEHRData = cohortDao.save(cohortWithoutEHRData);\n \n-    cohortWithEHRData = new DbCohort();\n+    DbCohort cohortWithEHRData = new DbCohort();\n     cohortWithEHRData.setWorkspaceId(workspace.getWorkspaceId());\n     cohortWithEHRData.setCriteria(gson.toJson(SearchRequests.malesWithEHRData()));\n     cohortWithEHRData = cohortDao.save(cohortWithEHRData);\n \n-    reviewWithoutEHRData =\n-        new DbCohortReview()\n-            .cdrVersionId(cdrVersion.getCdrVersionId())\n-            .matchedParticipantCount(212)\n-            .creationTime(new Timestamp(new Date().getTime()))\n-            .lastModifiedTime(new Timestamp(new Date().getTime()))\n-            .cohortId(cohortWithoutEHRData.getCohortId());\n-    reviewWithoutEHRData = cohortReviewDao.save(reviewWithoutEHRData);\n-\n-    DbParticipantCohortStatusKey key =\n-        new DbParticipantCohortStatusKey()\n-            .participantId(PARTICIPANT_ID)\n-            .cohortReviewId(reviewWithoutEHRData.getCohortReviewId());\n-    participantCohortStatusDao.save(new DbParticipantCohortStatus().participantKey(key));\n-\n-    DbParticipantCohortStatusKey key2 =\n-        new DbParticipantCohortStatusKey()\n-            .participantId(PARTICIPANT_ID2)\n-            .cohortReviewId(reviewWithoutEHRData.getCohortReviewId());\n-    participantCohortStatusDao.save(new DbParticipantCohortStatus().participantKey(key2));\n-\n-    reviewWithEHRData =\n-        new DbCohortReview()\n-            .cdrVersionId(cdrVersion.getCdrVersionId())\n-            .matchedParticipantCount(212)\n-            .creationTime(new Timestamp(new Date().getTime()))\n-            .lastModifiedTime(new Timestamp(new Date().getTime()))\n-            .cohortId(cohortWithEHRData.getCohortId());\n-    reviewWithEHRData = cohortReviewDao.save(reviewWithEHRData);\n-\n-    DbParticipantCohortStatusKey key3 =\n-        new DbParticipantCohortStatusKey()\n-            .participantId(PARTICIPANT_ID)\n-            .cohortReviewId(reviewWithEHRData.getCohortReviewId());\n-    participantCohortStatusDao.save(new DbParticipantCohortStatus().participantKey(key3));\n-\n-    DbParticipantCohortStatusKey key4 =\n-        new DbParticipantCohortStatusKey()\n-            .participantId(PARTICIPANT_ID2)\n-            .cohortReviewId(reviewWithEHRData.getCohortReviewId());\n-    participantCohortStatusDao.save(new DbParticipantCohortStatus().participantKey(key4));\n+    reviewWithoutEHRData = createCohortReview(cohortWithoutEHRData);\n+\n+    participantCohortStatusDao.save(\n+        new DbParticipantCohortStatus()", "originalCommit": "76c4747185b64d39387de7b864d121521efa374a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODYzMTU4OQ==", "url": "https://github.com/all-of-us/workbench/pull/3864#discussion_r468631589", "bodyText": "done.", "author": "freemabd", "createdAt": "2020-08-11T14:37:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYxMjM1OA=="}], "type": "inlineReview"}, {"oid": "322caad918395ae13ac1d6c81a1cd63bb8064450", "url": "https://github.com/all-of-us/workbench/commit/322caad918395ae13ac1d6c81a1cd63bb8064450", "message": "RW-5319 changes to duplicate code in test", "committedDate": "2020-08-11T14:09:49Z", "type": "commit"}]}