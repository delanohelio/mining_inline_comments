{"pr_number": 3866, "pr_title": "[RW-5369][risk=low] Up-gradle to 5.6.3", "pr_createdAt": "2020-08-08T01:14:36Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3866", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkyMTk5OA==", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r467921998", "bodyText": "If we don't support windows or cygwin, do we still need this file and the cygwin section above?", "author": "jaycarlton", "createdAt": "2020-08-10T13:57:24Z", "path": "api/gradlew.bat", "diffHunk": "@@ -1,3 +1,19 @@\n+@rem\r", "originalCommit": "4e852ab0521cdb8beb24cc3cc9d1e1c478a463da", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODIxNTA5MQ==", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r468215091", "bodyText": "Hmm, I could see an argument to remove them - I don't feel strongly. These are all default files which get generated when you initialize the gradle wrapper. They'll probably get generated again when we upgrade to Gradle 6 as well, so the approach would probably be to .gitignore these.\nI'm not aware of anyone actively using Windows for this project, though I'd think it would be possible with some effort.\nLet me know if you prefer these gone, otherwise I'll probably keep the status quo for now.\nThere's a separate argument to avoid checking in the gradlew.jar at all, which I probably won't tackle here.", "author": "calbach", "createdAt": "2020-08-10T22:12:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkyMTk5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkyMjI1Ng==", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r467922256", "bodyText": "Interesting. Not where I would've expected these to go.", "author": "jaycarlton", "createdAt": "2020-08-10T13:57:47Z", "path": "api/gradlew.bat", "diffHunk": "@@ -14,7 +30,7 @@ set APP_BASE_NAME=%~n0\n set APP_HOME=%DIRNAME%\r\n \r\n @rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.\r\n-set DEFAULT_JVM_OPTS=\r\n+set DEFAULT_JVM_OPTS=\"-Xmx64m\" \"-Xms64m\"\r", "originalCommit": "4e852ab0521cdb8beb24cc3cc9d1e1c478a463da", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODIxMzcxNA==", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r468213714", "bodyText": "This was autogenerated when I ran gradlew wrapper --version=5.6.3", "author": "calbach", "createdAt": "2020-08-10T22:09:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkyMjI1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI2Mjk0Nw==", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r468262947", "bodyText": "Please review this. It should resolve the errors I was seeing on Circle.", "author": "calbach", "createdAt": "2020-08-11T00:45:23Z", "path": "api/build.gradle", "diffHunk": "@@ -881,3 +881,25 @@ compileTestKotlin {\n     jvmTarget = \"1.8\"\n   }\n }\n+\n+// This is a hack to populate the (empty) output directory for the Kotlin", "originalCommit": "8a6179b0ddbbf3ee68a9fa2eb5bf8603ff93413e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODU0ODEzOQ==", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r468548139", "bodyText": "Looks good. Will this fail if the directory is already there somehow? Does it need to be removed on  gradle clean?", "author": "jaycarlton", "createdAt": "2020-08-11T12:40:00Z", "path": "api/build.gradle", "diffHunk": "@@ -881,3 +881,25 @@ compileTestKotlin {\n     jvmTarget = \"1.8\"\n   }\n }\n+\n+// This is a hack to populate the (empty) output directory for the Kotlin\n+// compileGenerated source set. This source set is devoid of Kotlin code - but\n+// there appears to be no way to opt out of the Kotlin plugin for a specific Java\n+// source set. Normally this task would create the output directory along with\n+// the output files, but in this case the task :compileGenerateKotlin is skipped\n+// due to a lack of input files, and the output directory is skipped as well as\n+// it seems the Kotlin plugin does not properly declare its outputs:\n+// https://youtrack.jetbrains.com/issue/KT-23807 .\n+//\n+// Without this workaround, compilation fails with:\n+// \"\"\"\n+// A problem was found with the configuration of task ':compileGeneratedJava'.\n+// > Directory '/usr/local/google/home/calbach/aou/workbench/api/build/classes/kotlin/generated'\n+//   specified for property 'compileGeneratedKotlinOutputClasses' does not exist.\n+// \"\"\"\n+task prepareKotlinGeneratedDir() {\n+  doLast {\n+    mkdir \"$projectDir/build/classes/kotlin/generated\"", "originalCommit": "8a6179b0ddbbf3ee68a9fa2eb5bf8603ff93413e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgwOTIyMQ==", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r468809221", "bodyText": "No, it doesn't fail. I've now declared it as an output, so I think gradle clean will just delete it.", "author": "calbach", "createdAt": "2020-08-11T19:17:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODU0ODEzOQ=="}], "type": "inlineReview"}, {"oid": "ccb0c3de20872072b52140e465b1b59d7dc59eb9", "url": "https://github.com/all-of-us/workbench/commit/ccb0c3de20872072b52140e465b1b59d7dc59eb9", "message": "Declare the output directory gradle config step picks it up", "committedDate": "2020-08-11T19:01:44Z", "type": "forcePushed"}, {"oid": "bf1145f92bd06dac8a0e144643f2e2a209ea71a1", "url": "https://github.com/all-of-us/workbench/commit/bf1145f92bd06dac8a0e144643f2e2a209ea71a1", "message": "5.0 ... working?", "committedDate": "2020-08-19T00:25:07Z", "type": "commit"}, {"oid": "bccad3b2ce41fad82ce49f3d83b2ea412816e4e2", "url": "https://github.com/all-of-us/workbench/commit/bccad3b2ce41fad82ce49f3d83b2ea412816e4e2", "message": "Bump to 5.6.3, retag", "committedDate": "2020-08-19T00:25:07Z", "type": "commit"}, {"oid": "b1b9fb9ee580a08fd60cc501ba36f39fceea767a", "url": "https://github.com/all-of-us/workbench/commit/b1b9fb9ee580a08fd60cc501ba36f39fceea767a", "message": "Fix generated Kotlin", "committedDate": "2020-08-19T00:25:07Z", "type": "commit"}, {"oid": "037317d3926b9a8d6002eb1fc4d7669566c57260", "url": "https://github.com/all-of-us/workbench/commit/037317d3926b9a8d6002eb1fc4d7669566c57260", "message": "Kill gradlew.bat", "committedDate": "2020-08-19T00:25:08Z", "type": "commit"}, {"oid": "f38481683640744fc4515ffb9467cd49300e0732", "url": "https://github.com/all-of-us/workbench/commit/f38481683640744fc4515ffb9467cd49300e0732", "message": "Try invalidating the gradle cache", "committedDate": "2020-08-19T00:25:08Z", "type": "commit"}, {"oid": "ca538f00b9fb48051c7475fa65133be75a447489", "url": "https://github.com/all-of-us/workbench/commit/ca538f00b9fb48051c7475fa65133be75a447489", "message": "Declare the output directory gradle config step picks it up", "committedDate": "2020-08-19T00:25:08Z", "type": "commit"}, {"oid": "8c7988f70b7dbfa6aaadbdb87d5f311b37567000", "url": "https://github.com/all-of-us/workbench/commit/8c7988f70b7dbfa6aaadbdb87d5f311b37567000", "message": "drop mem settings", "committedDate": "2020-08-19T00:25:08Z", "type": "commit"}, {"oid": "0c8079f409d75fd2a870cadadaa0f60acb19385c", "url": "https://github.com/all-of-us/workbench/commit/0c8079f409d75fd2a870cadadaa0f60acb19385c", "message": "bump test heap size", "committedDate": "2020-08-19T01:07:20Z", "type": "commit"}, {"oid": "0c8079f409d75fd2a870cadadaa0f60acb19385c", "url": "https://github.com/all-of-us/workbench/commit/0c8079f409d75fd2a870cadadaa0f60acb19385c", "message": "bump test heap size", "committedDate": "2020-08-19T01:07:20Z", "type": "forcePushed"}]}