{"pr_number": 3568, "pr_title": "[RW-3942][risk=low] Add a new standalone command to create/update the DB (1.5/2)", "pr_createdAt": "2020-05-11T23:47:11Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3568", "timeline": [{"oid": "046d44da08869d84423ff9ee3f8cd6425e1c74dc", "url": "https://github.com/all-of-us/workbench/commit/046d44da08869d84423ff9ee3f8cd6425e1c74dc", "message": "update/create cmd", "committedDate": "2020-05-11T23:36:41Z", "type": "commit"}, {"oid": "e6e94abffc90c35f3d5e5d993cddc1303ca556ed", "url": "https://github.com/all-of-us/workbench/commit/e6e94abffc90c35f3d5e5d993cddc1303ca556ed", "message": "doc", "committedDate": "2020-05-11T23:43:34Z", "type": "commit"}, {"oid": "7b17cb64ca2a6f9a328685881481be9aa57c66d6", "url": "https://github.com/all-of-us/workbench/commit/7b17cb64ca2a6f9a328685881481be9aa57c66d6", "message": "Add verbose mysql logging for batch mode for confirmation of what ran", "committedDate": "2020-05-13T00:49:44Z", "type": "commit"}, {"oid": "c77dcd6754b6f2fe435c7dcbb44eb5336b07f490", "url": "https://github.com/all-of-us/workbench/commit/c77dcd6754b6f2fe435c7dcbb44eb5336b07f490", "message": "Revert \"Add verbose mysql logging for batch mode for confirmation of what ran\"\n\nThis reverts commit 7b17cb64ca2a6f9a328685881481be9aa57c66d6.", "committedDate": "2020-05-13T21:57:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc4NzA1MA==", "url": "https://github.com/all-of-us/workbench/pull/3568#discussion_r424787050", "bodyText": "So this is just another entry point to what we aleready have, which makes sense.\nOne confusing thing is that this always runs a had-coded create_db.sql script. Which makes it feel like a wart in some ways. It's also scary to run something called create_workbench_db when you're just doing an update.", "author": "jaycarlton", "createdAt": "2020-05-13T23:26:35Z", "path": "api/libproject/devstart.rb", "diffHunk": "@@ -2221,6 +2221,25 @@ def create_workbench_db()\n   )\n end\n \n+def create_or_update_workbench_db(cmd_name, args)\n+  ensure_docker cmd_name, args\n+  with_cloud_proxy_and_db_env(cmd_name, args) do |ctx|\n+    create_workbench_db", "originalCommit": "c77dcd6754b6f2fe435c7dcbb44eb5336b07f490", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc5MDE3OA==", "url": "https://github.com/all-of-us/workbench/pull/3568#discussion_r424790178", "bodyText": "Fair point on naming, renamed.\nThe choice for SQL and XML templates in our dev tooling is to use env substitution. For better or worse, that is the convention. I've added some comments to make the implicit parameterization that's happening here hopefully more clear.", "author": "calbach", "createdAt": "2020-05-13T23:36:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc4NzA1MA=="}], "type": "inlineReview"}, {"oid": "c8244b508d3a82adfc14aeec34c6a36c166525de", "url": "https://github.com/all-of-us/workbench/commit/c8244b508d3a82adfc14aeec34c6a36c166525de", "message": "PR changes", "committedDate": "2020-05-13T23:32:04Z", "type": "commit"}, {"oid": "1ba346b0f1f299b0fd82ca64c4a41a282a7bd44f", "url": "https://github.com/all-of-us/workbench/commit/1ba346b0f1f299b0fd82ca64c4a41a282a7bd44f", "message": "env var comments", "committedDate": "2020-05-13T23:36:25Z", "type": "commit"}]}