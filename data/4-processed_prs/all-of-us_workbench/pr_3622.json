{"pr_number": 3622, "pr_title": "[RW-4313][risk=no] Teardown cluster resources bucket", "pr_createdAt": "2020-05-29T01:27:29Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3622", "timeline": [{"oid": "2d9da4861871fcf83ba05584d7523fe9c205ccfa", "url": "https://github.com/all-of-us/workbench/commit/2d9da4861871fcf83ba05584d7523fe9c205ccfa", "message": "kill cluster-resources bucket, mv static files", "committedDate": "2020-05-29T01:20:14Z", "type": "commit"}, {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842", "url": "https://github.com/all-of-us/workbench/commit/5f01e8808aba3191f29fb2ff3f03da2723ba1842", "message": "rename dir", "committedDate": "2020-05-29T01:26:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU2ODI2OA==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432568268", "bodyText": "This doesn't look right", "author": "jmthibault79", "createdAt": "2020-05-29T15:36:27Z", "path": "api/snippets-menu/build.rb", "diffHunk": "@@ -2,6 +2,7 @@\n \n require 'fileutils'\n require_relative \"../../aou-utils/workbench\"\n+require_relative \"../../../aou-utils/utils/common\"", "originalCommit": "5f01e8808aba3191f29fb2ff3f03da2723ba1842", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYyMjYzNg==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432622636", "bodyText": "Oops, fixed - ran a demo server deploy as well to verify", "author": "calbach", "createdAt": "2020-05-29T17:08:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU2ODI2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MTg1MA==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432571850", "bodyText": "update path", "author": "jmthibault79", "createdAt": "2020-05-29T15:42:19Z", "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly\n+manual and can be improved going forwards (see RW-2665):\n+\n+Prerequisite: Must have `jq` installed (for pretty printing).\n+\n+1. In a separate directory, clone the snippets repo and build the menu config:\n+    https://github.com/all-of-us/workbench-snippets/blob/master/CONTRIBUTING.md#auto-generation-of-jupyter-snippets-menu-configuration\n+1. Run the following from the `workbench/api/cluster-resources` directory to pull in the updated JSON", "originalCommit": "5f01e8808aba3191f29fb2ff3f03da2723ba1842", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYxOTg3Ng==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432619876", "bodyText": "Done", "author": "calbach", "createdAt": "2020-05-29T17:04:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MTg1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MzI3Ng==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432573276", "bodyText": "should we add app/static here?", "author": "jmthibault79", "createdAt": "2020-05-29T15:44:43Z", "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh", "originalCommit": "5f01e8808aba3191f29fb2ff3f03da2723ba1842", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYxOTQ0NQ==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432619445", "bodyText": "Yes, thanks - updated.", "author": "calbach", "createdAt": "2020-05-29T17:03:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MzI3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MzUyNw==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432573527", "bodyText": "might as well fix this typo", "author": "jmthibault79", "createdAt": "2020-05-29T15:45:04Z", "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly", "originalCommit": "5f01e8808aba3191f29fb2ff3f03da2723ba1842", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYxOTgzMA==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432619830", "bodyText": "Done", "author": "calbach", "createdAt": "2020-05-29T17:04:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MzUyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3Njg0Nw==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432576847", "bodyText": "This script needs to be updated to copy to the correct destination.  output:\nCopied pretty printed ../../../aou-snippets/build/r_dataset_snippets_menu_config.json into /Users/thibault/src/aou/api/cluster-resources/r-dataset-snippets-menu.json", "author": "jmthibault79", "createdAt": "2020-05-29T15:50:42Z", "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly\n+manual and can be improved going forwards (see RW-2665):\n+\n+Prerequisite: Must have `jq` installed (for pretty printing).\n+\n+1. In a separate directory, clone the snippets repo and build the menu config:\n+    https://github.com/all-of-us/workbench-snippets/blob/master/CONTRIBUTING.md#auto-generation-of-jupyter-snippets-menu-configuration\n+1. Run the following from the `workbench/api/cluster-resources` directory to pull in the updated JSON\n+\n+    ```\n+    ./import_json_from_snippets_repo.sh <path to workbench-snippets repo>", "originalCommit": "5f01e8808aba3191f29fb2ff3f03da2723ba1842", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYyMTIwNw==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432621207", "bodyText": "Oops, thanks. I've now run this myself to validate.", "author": "calbach", "createdAt": "2020-05-29T17:06:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3Njg0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3Nzc1MA==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432577750", "bodyText": "no longer above - add link", "author": "jmthibault79", "createdAt": "2020-05-29T15:52:09Z", "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly\n+manual and can be improved going forwards (see RW-2665):\n+\n+Prerequisite: Must have `jq` installed (for pretty printing).\n+\n+1. In a separate directory, clone the snippets repo and build the menu config:\n+    https://github.com/all-of-us/workbench-snippets/blob/master/CONTRIBUTING.md#auto-generation-of-jupyter-snippets-menu-configuration\n+1. Run the following from the `workbench/api/cluster-resources` directory to pull in the updated JSON\n+\n+    ```\n+    ./import_json_from_snippets_repo.sh <path to workbench-snippets repo>\n+    ```\n+1. Commit changes and go through normal pull request process.\n+1. Wait for a release; note that changes are only visible for clusters started\n+    after the release.\n+\n+## Snippets Extension Implementation\n+\n+The snippets menu extension Javascript is generated dynamically at deploy time\n+by `./build.rb` into the GAE static resources folder. This process takes as\n+inputs the templated extension `snippets-menu.js.template` and the per-language\n+collocated menu JSON files.\n+\n+## Local testing\n+\n+See instructions for local extension testing above.", "originalCommit": "5f01e8808aba3191f29fb2ff3f03da2723ba1842", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYyMjIzMg==", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432622232", "bodyText": "Done", "author": "calbach", "createdAt": "2020-05-29T17:07:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3Nzc1MA=="}], "type": "inlineReview"}, {"oid": "a6c644ed6398850bd24a19e469f5a854d59bfe33", "url": "https://github.com/all-of-us/workbench/commit/a6c644ed6398850bd24a19e469f5a854d59bfe33", "message": "PR / doc fixes", "committedDate": "2020-05-29T17:22:38Z", "type": "commit"}]}