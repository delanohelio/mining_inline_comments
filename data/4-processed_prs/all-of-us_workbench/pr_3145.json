{"pr_number": 3145, "pr_title": "[RW-4244][Risk=no] Srubenst/cookie policy", "pr_createdAt": "2020-02-18T18:23:51Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3145", "timeline": [{"oid": "9e7e0eaafd1b54593d3180ff42474ee756d8d1c6", "url": "https://github.com/all-of-us/workbench/commit/9e7e0eaafd1b54593d3180ff42474ee756d8d1c6", "message": "WIP cookies warning", "committedDate": "2020-02-14T19:42:33Z", "type": "commit"}, {"oid": "e1fbd533d8680a1035ba1e3fffe084941f441443", "url": "https://github.com/all-of-us/workbench/commit/e1fbd533d8680a1035ba1e3fffe084941f441443", "message": "[RW-4244][Risk=no] Add Cookie Policy", "committedDate": "2020-02-18T18:20:43Z", "type": "commit"}, {"oid": "9b01652f4c627a522a7604d56d33f0c6fe31e9b7", "url": "https://github.com/all-of-us/workbench/commit/9b01652f4c627a522a7604d56d33f0c6fe31e9b7", "message": "Revert accidental text change", "committedDate": "2020-02-18T18:24:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg1MzE1NQ==", "url": "https://github.com/all-of-us/workbench/pull/3145#discussion_r380853155", "bodyText": "I'm not really happy with this method of doing it, but semantically it feels the closest to what we could do.", "author": "s-rubenstein", "createdAt": "2020-02-18T18:24:55Z", "path": "ui/src/app/pages/login/cookie-policy.tsx", "diffHunk": "@@ -0,0 +1,161 @@\n+import {Component} from '@angular/core';\n+import {FadeBox} from 'app/components/containers';\n+import {FlexColumn, FlexRow} from 'app/components/flex';\n+import {Header, SmallHeader} from 'app/components/headers';\n+import {SIGNED_OUT_HEADER_IMAGE} from 'app/pages/login/sign-in';\n+import {AoUTitle} from 'app/pages/profile/data-use-agreement-styles';\n+import colors, {colorWithWhiteness} from 'app/styles/colors';\n+import {ReactWrapperBase} from 'app/utils';\n+import * as React from 'react';\n+\n+const styles = {\n+  tableItem: {\n+    marginLeft: 6,\n+    marginTop: 6,\n+    height: 'auto',\n+    padding: '0.5rem',\n+    backgroundColor: colorWithWhiteness(colors.dark, 0.92),\n+    borderRadius: 5\n+  },\n+  wideItem: {\n+    width: '50%'\n+  },\n+  smallItem: {\n+    width: '25%',\n+  },\n+  tableHeader: {\n+    backgroundColor: colorWithWhiteness(colors.dark, 0.85),\n+    fontWeight: 500\n+  },\n+  inlineAnchor: {\n+    display: 'inline-block',\n+    color: colors.accent\n+  },\n+  header: {\n+    fontSize: 20,\n+    fontWeight: 600,\n+    lineHeight: '24px',\n+    marginTop: 0\n+  },\n+  smallHeader: {\n+    fontSize: 16,\n+    fontWeight: 600,\n+  },\n+  textSection: {\n+    marginTop: '.75rem'\n+  }\n+};\n+\n+const COOKIE_DELETION_LINK = 'https://www.aboutcookies.org/how-to-delete-cookies/';\n+const GOOGLE_PRIVACY_LINK = 'https://policies.google.com/privacy';\n+const ZENDESK_PRIVACY_LINK = 'https://www.zendesk.com/company/customers-partners/privacy-policy/';\n+\n+export class CookiePolicy extends React.Component<{}, {}> {\n+  render() {\n+    return <React.Fragment>\n+      <div style={{width: '100%', height: '3.5rem',\n+        borderBottom: `1px solid ${colorWithWhiteness(colors.dark, 0.7)}`}}>\n+        <img style={{height: '1.75rem', marginLeft: '1rem', marginTop: '1rem'}}\n+             src={SIGNED_OUT_HEADER_IMAGE}/>\n+      </div>\n+      <FadeBox style={{margin: 'auto', marginTop: '1rem', width: '95.7%', color: colors.primary}}>\n+        <Header style={styles.header}><AoUTitle/> Cookie Policy</Header>\n+        <div style={styles.textSection}>\n+          The <AoUTitle/> platform uses cookies to help provide you with the best experience we can.\n+          Cookies are small text files that are placed on your computer or mobile phone when you browse websites.\n+        </div>\n+        <div style={styles.textSection}>\n+          Our cookies help us to:\n+          <ul>\n+            <li>Make our platform function as you would expect</li>\n+            <li>Improve the speed and security of the site</li>\n+            <li>Continuously improve our platform for you</li>\n+          </ul>\n+        </div>\n+        <div style={styles.textSection}>\n+          We do not use cookies to:\n+          <ul>\n+            <li>Collect any personally identifiable information (without your express permission)</li>\n+            <li>Collect any sensitive information (without your express permission)</li>\n+            <li>Pass personally identifiable data to third parties</li>\n+            <li>Pay sales commissions</li>\n+          </ul>\n+        </div>\n+        <div style={styles.textSection}>\n+          You can learn more about all the cookies we use below.\n+        </div>\n+        <SmallHeader style={styles.smallHeader}>Granting us permission to use cookies</SmallHeader>\n+        <div style={styles.textSection}>If the settings on your software that you are using to view the <AoUTitle/> are\n+          adjusted to accept cookies, we take this, and your continued use of our platform, to mean that you accept\n+          this. Should you wish to not accept cookies, you can learn how to do this below.</div>\n+        <SmallHeader style={styles.smallHeader}>Anonymous visitor statistics cookies</SmallHeader>\n+        <div style={styles.textSection}>\n+          We use cookies to compile visitor statistics including the number of visitors to our platform, technology used\n+          to visit our platform (e.g. operating systems, helping to identify specific problems), time spent on the\n+          platform, popular pages, etc. This helps us to continuously improve our platform. Analytics programs also tell\n+          us, anonymously, how visitors found our platform (e.g. through a search engine) and whether they have been\n+          here before, helping us to invest in the development of our services instead of marketing.\n+        </div>\n+        <div style={styles.textSection}>\n+          There will also be cookies on our platform placed by third parties whose services we use to deliver our\n+          services. To control third-party cookies, you can adjust your browser settings, as below.\n+        </div>\n+        <SmallHeader style={styles.smallHeader}>Cookies we use</SmallHeader>\n+        <FlexRow>\n+          <div style={{...styles.tableItem, ...styles.smallItem, ...styles.tableHeader}}>Cookie ID</div>\n+          <div style={{...styles.tableItem, ...styles.smallItem, ...styles.tableHeader}}>Provider</div>\n+          <div style={{...styles.tableItem, ...styles.wideItem, ...styles.tableHeader}}>Description</div>\n+        </FlexRow>\n+        <FlexRow>\n+          <div style={{...styles.tableItem, ...styles.smallItem}}>__cfduid</div>\n+          <div style={{...styles.tableItem, ...styles.smallItem}}><a style={styles.inlineAnchor}\n+                                                                     href={ZENDESK_PRIVACY_LINK}>Zendesk</a></div>\n+          <div style={{...styles.tableItem, ...styles.wideItem}}>Used by the CloudFlare content delivery network to\n+            identify trusted web traffic from the embedded Zendesk help widget.</div>\n+        </FlexRow>\n+        <FlexRow>\n+          <FlexColumn style={{...styles.tableItem, ...styles.smallItem}}>\n+            <div>_ga*</div>\n+            <div>_gid*</div>\n+          </FlexColumn>\n+          <div style={{...styles.tableItem, ...styles.smallItem}}><a style={styles.inlineAnchor}\n+                                                                     href={GOOGLE_PRIVACY_LINK}>Google</a></div>\n+          <div style={{...styles.tableItem, ...styles.wideItem}}>Used by Google Analytics to distinguish users.</div>\n+        </FlexRow>\n+        <FlexRow>\n+          <FlexColumn style={{...styles.tableItem, ...styles.smallItem}}>", "originalCommit": "e1fbd533d8680a1035ba1e3fffe084941f441443", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg1MzQ0MQ==", "url": "https://github.com/all-of-us/workbench/pull/3145#discussion_r380853441", "bodyText": "Ideally this would be a table, but with some of the styling I think it makes more sense to do it this way. If you have any other ideas, I would love them.", "author": "s-rubenstein", "createdAt": "2020-02-18T18:25:29Z", "path": "ui/src/app/pages/login/cookie-policy.tsx", "diffHunk": "@@ -0,0 +1,161 @@\n+import {Component} from '@angular/core';\n+import {FadeBox} from 'app/components/containers';\n+import {FlexColumn, FlexRow} from 'app/components/flex';\n+import {Header, SmallHeader} from 'app/components/headers';\n+import {SIGNED_OUT_HEADER_IMAGE} from 'app/pages/login/sign-in';\n+import {AoUTitle} from 'app/pages/profile/data-use-agreement-styles';\n+import colors, {colorWithWhiteness} from 'app/styles/colors';\n+import {ReactWrapperBase} from 'app/utils';\n+import * as React from 'react';\n+\n+const styles = {\n+  tableItem: {\n+    marginLeft: 6,\n+    marginTop: 6,\n+    height: 'auto',\n+    padding: '0.5rem',\n+    backgroundColor: colorWithWhiteness(colors.dark, 0.92),\n+    borderRadius: 5\n+  },\n+  wideItem: {\n+    width: '50%'\n+  },\n+  smallItem: {\n+    width: '25%',\n+  },\n+  tableHeader: {\n+    backgroundColor: colorWithWhiteness(colors.dark, 0.85),\n+    fontWeight: 500\n+  },\n+  inlineAnchor: {\n+    display: 'inline-block',\n+    color: colors.accent\n+  },\n+  header: {\n+    fontSize: 20,\n+    fontWeight: 600,\n+    lineHeight: '24px',\n+    marginTop: 0\n+  },\n+  smallHeader: {\n+    fontSize: 16,\n+    fontWeight: 600,\n+  },\n+  textSection: {\n+    marginTop: '.75rem'\n+  }\n+};\n+\n+const COOKIE_DELETION_LINK = 'https://www.aboutcookies.org/how-to-delete-cookies/';\n+const GOOGLE_PRIVACY_LINK = 'https://policies.google.com/privacy';\n+const ZENDESK_PRIVACY_LINK = 'https://www.zendesk.com/company/customers-partners/privacy-policy/';\n+\n+export class CookiePolicy extends React.Component<{}, {}> {\n+  render() {\n+    return <React.Fragment>\n+      <div style={{width: '100%', height: '3.5rem',\n+        borderBottom: `1px solid ${colorWithWhiteness(colors.dark, 0.7)}`}}>\n+        <img style={{height: '1.75rem', marginLeft: '1rem', marginTop: '1rem'}}\n+             src={SIGNED_OUT_HEADER_IMAGE}/>\n+      </div>\n+      <FadeBox style={{margin: 'auto', marginTop: '1rem', width: '95.7%', color: colors.primary}}>\n+        <Header style={styles.header}><AoUTitle/> Cookie Policy</Header>\n+        <div style={styles.textSection}>\n+          The <AoUTitle/> platform uses cookies to help provide you with the best experience we can.\n+          Cookies are small text files that are placed on your computer or mobile phone when you browse websites.\n+        </div>\n+        <div style={styles.textSection}>\n+          Our cookies help us to:\n+          <ul>\n+            <li>Make our platform function as you would expect</li>\n+            <li>Improve the speed and security of the site</li>\n+            <li>Continuously improve our platform for you</li>\n+          </ul>\n+        </div>\n+        <div style={styles.textSection}>\n+          We do not use cookies to:\n+          <ul>\n+            <li>Collect any personally identifiable information (without your express permission)</li>\n+            <li>Collect any sensitive information (without your express permission)</li>\n+            <li>Pass personally identifiable data to third parties</li>\n+            <li>Pay sales commissions</li>\n+          </ul>\n+        </div>\n+        <div style={styles.textSection}>\n+          You can learn more about all the cookies we use below.\n+        </div>\n+        <SmallHeader style={styles.smallHeader}>Granting us permission to use cookies</SmallHeader>\n+        <div style={styles.textSection}>If the settings on your software that you are using to view the <AoUTitle/> are\n+          adjusted to accept cookies, we take this, and your continued use of our platform, to mean that you accept\n+          this. Should you wish to not accept cookies, you can learn how to do this below.</div>\n+        <SmallHeader style={styles.smallHeader}>Anonymous visitor statistics cookies</SmallHeader>\n+        <div style={styles.textSection}>\n+          We use cookies to compile visitor statistics including the number of visitors to our platform, technology used\n+          to visit our platform (e.g. operating systems, helping to identify specific problems), time spent on the\n+          platform, popular pages, etc. This helps us to continuously improve our platform. Analytics programs also tell\n+          us, anonymously, how visitors found our platform (e.g. through a search engine) and whether they have been\n+          here before, helping us to invest in the development of our services instead of marketing.\n+        </div>\n+        <div style={styles.textSection}>\n+          There will also be cookies on our platform placed by third parties whose services we use to deliver our\n+          services. To control third-party cookies, you can adjust your browser settings, as below.\n+        </div>\n+        <SmallHeader style={styles.smallHeader}>Cookies we use</SmallHeader>\n+        <FlexRow>", "originalCommit": "e1fbd533d8680a1035ba1e3fffe084941f441443", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg2NzE0Ng==", "url": "https://github.com/all-of-us/workbench/pull/3145#discussion_r380867146", "bodyText": "[File placement] I think this page doesn't belong under /login. It's an independent page which has nothing functionally to do with the login flow. We link to it from the login page, but we might also reasonably link to it from other pages too.", "author": "gjuggler", "createdAt": "2020-02-18T18:52:05Z", "path": "ui/src/app/pages/login/cookie-policy.tsx", "diffHunk": "@@ -0,0 +1,161 @@\n+import {Component} from '@angular/core';", "originalCommit": "9b01652f4c627a522a7604d56d33f0c6fe31e9b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg2ODYyNg==", "url": "https://github.com/all-of-us/workbench/pull/3145#discussion_r380868626", "bodyText": "[Opt / nitpick] Ahh, the camel-casing on this component is off... it should be AouTitle according to Google's rules: https://google.github.io/styleguide/javaguide.html#s5.3-camel-case\nAlso, it feels odd to be importing something from a file called data-use-agreement-styles which has nothing at all to do with data use agreement. Maybe this class should be bumped up to a more obviously common location? I would support doing it in this PR if it's a pretty easy refactor.", "author": "gjuggler", "createdAt": "2020-02-18T18:54:48Z", "path": "ui/src/app/pages/login/cookie-policy.tsx", "diffHunk": "@@ -0,0 +1,161 @@\n+import {Component} from '@angular/core';\n+import {FadeBox} from 'app/components/containers';\n+import {FlexColumn, FlexRow} from 'app/components/flex';\n+import {Header, SmallHeader} from 'app/components/headers';\n+import {SIGNED_OUT_HEADER_IMAGE} from 'app/pages/login/sign-in';\n+import {AoUTitle} from 'app/pages/profile/data-use-agreement-styles';", "originalCommit": "9b01652f4c627a522a7604d56d33f0c6fe31e9b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg3MDM5Mg==", "url": "https://github.com/all-of-us/workbench/pull/3145#discussion_r380870392", "bodyText": "[nit] I don't necessarily agree with it, but the mock reads \"All of Us Research Program platform\". This code is omitting the \"platform\" word. Personally I think the phrase \"Research Program platform\" sounds a bit awkward, but if we're developing straight to the mocks, this is slightly off.", "author": "gjuggler", "createdAt": "2020-02-18T18:57:55Z", "path": "ui/src/app/pages/login/cookie-policy.tsx", "diffHunk": "@@ -0,0 +1,161 @@\n+import {Component} from '@angular/core';\n+import {FadeBox} from 'app/components/containers';\n+import {FlexColumn, FlexRow} from 'app/components/flex';\n+import {Header, SmallHeader} from 'app/components/headers';\n+import {SIGNED_OUT_HEADER_IMAGE} from 'app/pages/login/sign-in';\n+import {AoUTitle} from 'app/pages/profile/data-use-agreement-styles';\n+import colors, {colorWithWhiteness} from 'app/styles/colors';\n+import {ReactWrapperBase} from 'app/utils';\n+import * as React from 'react';\n+\n+const styles = {\n+  tableItem: {\n+    marginLeft: 6,\n+    marginTop: 6,\n+    height: 'auto',\n+    padding: '0.5rem',\n+    backgroundColor: colorWithWhiteness(colors.dark, 0.92),\n+    borderRadius: 5\n+  },\n+  wideItem: {\n+    width: '50%'\n+  },\n+  smallItem: {\n+    width: '25%',\n+  },\n+  tableHeader: {\n+    backgroundColor: colorWithWhiteness(colors.dark, 0.85),\n+    fontWeight: 500\n+  },\n+  inlineAnchor: {\n+    display: 'inline-block',\n+    color: colors.accent\n+  },\n+  header: {\n+    fontSize: 20,\n+    fontWeight: 600,\n+    lineHeight: '24px',\n+    marginTop: 0\n+  },\n+  smallHeader: {\n+    fontSize: 16,\n+    fontWeight: 600,\n+  },\n+  textSection: {\n+    marginTop: '.75rem'\n+  }\n+};\n+\n+const COOKIE_DELETION_LINK = 'https://www.aboutcookies.org/how-to-delete-cookies/';\n+const GOOGLE_PRIVACY_LINK = 'https://policies.google.com/privacy';\n+const ZENDESK_PRIVACY_LINK = 'https://www.zendesk.com/company/customers-partners/privacy-policy/';\n+\n+export class CookiePolicy extends React.Component<{}, {}> {\n+  render() {\n+    return <React.Fragment>\n+      <div style={{width: '100%', height: '3.5rem',\n+        borderBottom: `1px solid ${colorWithWhiteness(colors.dark, 0.7)}`}}>\n+        <img style={{height: '1.75rem', marginLeft: '1rem', marginTop: '1rem'}}\n+             src={SIGNED_OUT_HEADER_IMAGE}/>\n+      </div>\n+      <FadeBox style={{margin: 'auto', marginTop: '1rem', width: '95.7%', color: colors.primary}}>\n+        <Header style={styles.header}><AoUTitle/> Cookie Policy</Header>\n+        <div style={styles.textSection}>\n+          The <AoUTitle/> platform uses cookies to help provide you with the best experience we can.\n+          Cookies are small text files that are placed on your computer or mobile phone when you browse websites.\n+        </div>\n+        <div style={styles.textSection}>\n+          Our cookies help us to:\n+          <ul>\n+            <li>Make our platform function as you would expect</li>\n+            <li>Improve the speed and security of the site</li>\n+            <li>Continuously improve our platform for you</li>\n+          </ul>\n+        </div>\n+        <div style={styles.textSection}>\n+          We do not use cookies to:\n+          <ul>\n+            <li>Collect any personally identifiable information (without your express permission)</li>\n+            <li>Collect any sensitive information (without your express permission)</li>\n+            <li>Pass personally identifiable data to third parties</li>\n+            <li>Pay sales commissions</li>\n+          </ul>\n+        </div>\n+        <div style={styles.textSection}>\n+          You can learn more about all the cookies we use below.\n+        </div>\n+        <SmallHeader style={styles.smallHeader}>Granting us permission to use cookies</SmallHeader>\n+        <div style={styles.textSection}>If the settings on your software that you are using to view the <AoUTitle/> are", "originalCommit": "9b01652f4c627a522a7604d56d33f0c6fe31e9b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg3MzQ1NQ==", "url": "https://github.com/all-of-us/workbench/pull/3145#discussion_r380873455", "bodyText": "[opt nit] should the href path have a preceding slash to make it an absolute path?", "author": "gjuggler", "createdAt": "2020-02-18T19:03:44Z", "path": "ui/src/app/pages/login/sign-in.tsx", "diffHunk": "@@ -289,15 +314,41 @@ export class SignInReactImpl extends React.Component<SignInProps, SignInState> {\n     }\n   }\n \n+  handleCloseCookies() {\n+    if (cookiesEnabled()) {\n+      this.setState({cookieBannerClosed: true});\n+      localStorage.setItem(cookieKey, 'cookie-banner-dismissed');\n+    }\n+  }\n+\n+  cookieBannerVisible() {\n+    if (cookiesEnabled()) {\n+      return !localStorage.getItem(cookieKey) && !this.state.cookieBannerClosed;\n+    } else {\n+      return true;\n+    }\n+  }\n+\n   render() {\n     const backgroundImages = StepToImageConfig.get(this.state.currentStep);\n     return <FlexColumn style={styles.signInContainer} data-test-id='sign-in-container'>\n       <FlexColumn data-test-id='sign-in-page'\n                   style={backgroundStyleTemplate(this.props.windowSize, backgroundImages)}>\n         <div><img style={{height: '1.75rem', marginLeft: '1rem', marginTop: '1rem'}}\n-                  src={HEADER_IMAGE}/></div>\n+                  src={SIGNED_OUT_HEADER_IMAGE}/></div>\n         {this.renderSignInStep(this.state.currentStep)}\n       </FlexColumn>\n+      {this.cookieBannerVisible() && <div style={styles.cookiePolicyMessage}>\n+        <FlexRow style={{alignItems: 'center'}}>\n+          <img src='assets/images/cookies.png'/>\n+          <div style={{paddingLeft: '1rem', color: colors.primary}}>\n+            We use cookies to help provide you with the best experience we can. By continuing to use our site, you consent\n+            to our <a href='cookie-policy' target='_blank'", "originalCommit": "9b01652f4c627a522a7604d56d33f0c6fe31e9b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "be1f8b71aa1ac221df794296d03c223b54e7b99f", "url": "https://github.com/all-of-us/workbench/commit/be1f8b71aa1ac221df794296d03c223b54e7b99f", "message": "PR feedback", "committedDate": "2020-02-18T20:17:43Z", "type": "commit"}]}