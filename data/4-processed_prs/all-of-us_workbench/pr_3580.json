{"pr_number": 3580, "pr_title": "[RW-4258][risk=low] Admin UI for List Institute entities for affiliation", "pr_createdAt": "2020-05-13T17:21:54Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3580", "timeline": [{"oid": "177772d32765fc988f7557ef0fa12e89e6e18565", "url": "https://github.com/all-of-us/workbench/commit/177772d32765fc988f7557ef0fa12e89e6e18565", "message": "Admin UI Instruction List page", "committedDate": "2020-05-13T17:16:35Z", "type": "commit"}, {"oid": "e96d41b043c08a0de4269670fc82fe2ee7cabc96", "url": "https://github.com/all-of-us/workbench/commit/e96d41b043c08a0de4269670fc82fe2ee7cabc96", "message": "Fix UI Test", "committedDate": "2020-05-13T17:36:48Z", "type": "commit"}, {"oid": "56539db8a490d5758271b0084ae639f265e7f2d6", "url": "https://github.com/all-of-us/workbench/commit/56539db8a490d5758271b0084ae639f265e7f2d6", "message": "revert data table version", "committedDate": "2020-05-13T18:20:10Z", "type": "commit"}, {"oid": "fe847d628a2e57f39acdaf40dcc2e3816a343ec6", "url": "https://github.com/all-of-us/workbench/commit/fe847d628a2e57f39acdaf40dcc2e3816a343ec6", "message": "Add some Api test for getInstitutions", "committedDate": "2020-05-13T18:37:15Z", "type": "commit"}, {"oid": "2a98bd76735d19d56ab00096a9a4f97a1be89466", "url": "https://github.com/all-of-us/workbench/commit/2a98bd76735d19d56ab00096a9a4f97a1be89466", "message": "add Loading parameter to datatable", "committedDate": "2020-05-13T18:50:43Z", "type": "commit"}, {"oid": "d55f4da2b9a537fb0b9abdc7663cfc30ea2de0e9", "url": "https://github.com/all-of-us/workbench/commit/d55f4da2b9a537fb0b9abdc7663cfc30ea2de0e9", "message": "Remove Extra line", "committedDate": "2020-05-13T18:52:13Z", "type": "commit"}, {"oid": "9a916e7d9d9072190ed2d207f54356ad37241926", "url": "https://github.com/all-of-us/workbench/commit/9a916e7d9d9072190ed2d207f54356ad37241926", "message": "Add logic to display different type of institution", "committedDate": "2020-05-13T19:10:32Z", "type": "commit"}, {"oid": "fe36239feb29a2a557332a72f3b4c1c4a11fbf89", "url": "https://github.com/all-of-us/workbench/commit/fe36239feb29a2a557332a72f3b4c1c4a11fbf89", "message": "spotless", "committedDate": "2020-05-13T19:11:38Z", "type": "commit"}, {"oid": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "url": "https://github.com/all-of-us/workbench/commit/dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "message": "udpate comments", "committedDate": "2020-05-13T19:13:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwMjE3NQ==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425302175", "bodyText": "one of these needs to be \"that\"", "author": "jmthibault79", "createdAt": "2020-05-14T17:15:11Z", "path": "api/src/main/java/org/pmiops/workbench/db/model/DbInstitutionUserInstructions.java", "diffHunk": "@@ -64,12 +67,12 @@ public boolean equals(Object o) {\n \n     DbInstitutionUserInstructions that = (DbInstitutionUserInstructions) o;\n \n-    return Objects.equals(institutionId, that.institutionId)\n+    return Objects.equals(institution.getInstitutionId(), institution.getInstitutionId())", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzQwMw==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425307403", "bodyText": "If this is now part of the Institution model, we should make it part of the DB model too", "author": "jmthibault79", "createdAt": "2020-05-14T17:24:04Z", "path": "api/src/main/java/org/pmiops/workbench/institution/InstitutionMapper.java", "diffHunk": "@@ -20,6 +20,8 @@\n   @Mapping(target = \"institutionId\", ignore = true)\n   DbInstitution modelToDb(Institution modelObject);\n \n+  // userInstructions will be populated by InstitutionUserInstructionsMapper\n+  @Mapping(target = \"userInstructions\", ignore = true)", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4OTI2Mw==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425389263", "bodyText": "So the issue was that since FK resides in user instructions, if we include userInstruction in DbInstitution, the save was throwing error and not behaving as it should.", "author": "NehaBroad", "createdAt": "2020-05-14T19:47:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzQwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ3MDQ3OQ==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425470479", "bodyText": "the email addrs and domains are like that too - so we should be able to make this work", "author": "jmthibault79", "createdAt": "2020-05-14T22:41:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzQwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTgxNjM3Mg==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425816372", "bodyText": "yes thats given me an issue too as its doing insert and not update and adding multiple rows. So as part of the edit institution PR i'll be taking that out", "author": "NehaBroad", "createdAt": "2020-05-15T13:52:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzQwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTgxODAyOA==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425818028", "bodyText": "Ripping out userInstructions was done after suggestion from @freemabd", "author": "NehaBroad", "createdAt": "2020-05-15T13:54:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzQwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxODA0OA==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r426018048", "bodyText": "I'm not sure I understand yet, but this doesn't need to be a blocker.  We can follow up on Slack.", "author": "jmthibault79", "createdAt": "2020-05-15T19:57:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzQwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzkwMA==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425307900", "bodyText": "the institutionMapper should handle this", "author": "jmthibault79", "createdAt": "2020-05-14T17:24:56Z", "path": "api/src/main/java/org/pmiops/workbench/institution/InstitutionServiceImpl.java", "diffHunk": "@@ -55,6 +55,12 @@\n   public List<Institution> getInstitutions() {\n     return StreamSupport.stream(institutionDao.findAll().spliterator(), false)\n         .map(institutionMapper::dbToModel)\n+        .map(", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ3MTU3Mg==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425471572", "bodyText": "dbToModel should handle all of the logic regarding whether instructions exist or not\nSo getInstitutions() can look simply like:\nreturn StreamSupport.stream(institutionDao.findAll().spliterator(), false)\n  .map(institutionMapper::dbToModel)\n  .collect(Collectors.toList());", "author": "jmthibault79", "createdAt": "2020-05-14T22:45:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzkwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMDQ5Mg==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425310492", "bodyText": "mention that these are sent to the users in an email", "author": "jmthibault79", "createdAt": "2020-05-14T17:28:52Z", "path": "api/src/main/resources/workbench-api.yaml", "diffHunk": "@@ -5455,6 +5455,9 @@ definitions:\n           this Institution\n         items:\n           type: string\n+      userInstructions:\n+        description: Institution-specific instructions for users to perform after registration", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNDE0Nw==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425314147", "bodyText": "what does this change do?", "author": "jmthibault79", "createdAt": "2020-05-14T17:35:05Z", "path": "ui/src/testing/stubs/institution-api-stub.ts", "diffHunk": "@@ -65,8 +67,9 @@ export class InstitutionApiStub extends InstitutionApi {\n   }\n \n   getInstitutions(shortName: string): Promise<GetInstitutionsResponse> {\n-    return new Promise(resolve => {\n-      return {institutions: this.institutions};\n+    return new Promise((resolve, reject) => {", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4OTYxNw==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425389617", "bodyText": "this was not working for me unless i added resolve(institutions)", "author": "NehaBroad", "createdAt": "2020-05-14T19:48:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNDE0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNDI5Nw==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425314297", "bodyText": "why this update?", "author": "jmthibault79", "createdAt": "2020-05-14T17:35:18Z", "path": "ui/yarn.lock", "diffHunk": "@@ -7541,8 +7541,9 @@ primeicons@^1.0.0:\n   resolved \"https://registry.yarnpkg.com/primeicons/-/primeicons-1.0.0.tgz#90061f168ef6227f21f0a7db8204ffa85cd27aec\"\n \n primereact@^3.1.1:\n-  version \"3.3.2\"\n-  resolved \"https://registry.yarnpkg.com/primereact/-/primereact-3.3.2.tgz#0d47fd6a8cc9e22e4d0beb06a86c1bf3401f1b77\"\n+  version \"3.4.0\"", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0ODMyOA==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425348328", "bodyText": "I have updated the primereact version from 3.1.1 to the latest 4.2.0 as its more stable and have better feature i'll add the package.json", "author": "NehaBroad", "createdAt": "2020-05-14T18:31:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNDI5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM2NTMyMw==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425365323", "bodyText": "Does this PR depend on any of the new features?  Might be better to make that change as a separate PR, if not.", "author": "jmthibault79", "createdAt": "2020-05-14T19:01:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNDI5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMzOTk5Ng==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425339996", "bodyText": "I like these little render functions.", "author": "jmthibault79", "createdAt": "2020-05-14T18:16:54Z", "path": "ui/src/app/pages/admin/admin-institution.tsx", "diffHunk": "@@ -0,0 +1,153 @@\n+import {Component} from '@angular/core';\n+import {Button} from 'app/components/buttons';\n+import {FadeBox} from 'app/components/containers';\n+import {SemiBoldHeader} from 'app/components/headers';\n+import {ClrIcon} from 'app/components/icons';\n+import {institutionApi} from 'app/services/swagger-fetch-clients';\n+import colors from 'app/styles/colors';\n+import {ReactWrapperBase} from 'app/utils';\n+import {reactStyles} from 'app/utils';\n+import {Institution} from 'generated/fetch';\n+import {DuaType, OrganizationType} from 'generated/fetch';\n+import * as fp from 'lodash/fp';\n+import {Column} from 'primereact/column';\n+import {DataTable} from 'primereact/datatable';\n+import * as React from 'react';\n+\n+\n+const styles = reactStyles({\n+  pageHeader: {\n+    fontSize: '18px',\n+    lineHeight: '22px',\n+    marginBottom: '1rem',\n+    marginTop: '0.5rem'\n+  },\n+  header: {\n+    fontSize: '14px',\n+    fontWeight: 600,\n+    letterSpacing: 0,\n+    lineHeight: '18px',\n+    color: colors.primary,\n+    width: '3rem',\n+    textAlign: 'start',\n+    height: '4rem',\n+  },\n+  text: {\n+    fontSize: '14px',\n+    letterSpacing: 0,\n+    lineHeight: '18px',\n+    color: colors.primary,\n+    verticalAlign: 'top',\n+    textOverflow: 'ellipsis',\n+    overflow: 'auto',\n+    height: '4rem',\n+    width: '5rem',\n+  }\n+});\n+\n+interface State {\n+  loadingInstitutions: boolean;\n+  institutions: Array<Institution>;\n+  institutionLoadError: boolean;\n+}\n+\n+export class AdminInstitution extends React.Component<{}, State> {\n+  constructor(props) {\n+    super(props);\n+    this.state = {\n+      loadingInstitutions: true,\n+      institutions: [],\n+      institutionLoadError: false\n+    };\n+  }\n+\n+  async componentDidMount() {\n+    try {\n+      const details = await institutionApi().getInstitutions();\n+      this.setState({\n+        loadingInstitutions: false,\n+        institutions: details.institutions\n+      });\n+    } catch (e) {\n+      this.setState({\n+        loadingInstitutions: false,\n+        institutionLoadError: true\n+      });\n+    }\n+  }\n+\n+  renderOrganizationType(row, col) {", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0MDc5NQ==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425340795", "bodyText": "Please add some punctuation here.", "author": "jmthibault79", "createdAt": "2020-05-14T18:18:15Z", "path": "ui/src/app/pages/admin/admin-institution.tsx", "diffHunk": "@@ -0,0 +1,153 @@\n+import {Component} from '@angular/core';\n+import {Button} from 'app/components/buttons';\n+import {FadeBox} from 'app/components/containers';\n+import {SemiBoldHeader} from 'app/components/headers';\n+import {ClrIcon} from 'app/components/icons';\n+import {institutionApi} from 'app/services/swagger-fetch-clients';\n+import colors from 'app/styles/colors';\n+import {ReactWrapperBase} from 'app/utils';\n+import {reactStyles} from 'app/utils';\n+import {Institution} from 'generated/fetch';\n+import {DuaType, OrganizationType} from 'generated/fetch';\n+import * as fp from 'lodash/fp';\n+import {Column} from 'primereact/column';\n+import {DataTable} from 'primereact/datatable';\n+import * as React from 'react';\n+\n+\n+const styles = reactStyles({\n+  pageHeader: {\n+    fontSize: '18px',\n+    lineHeight: '22px',\n+    marginBottom: '1rem',\n+    marginTop: '0.5rem'\n+  },\n+  header: {\n+    fontSize: '14px',\n+    fontWeight: 600,\n+    letterSpacing: 0,\n+    lineHeight: '18px',\n+    color: colors.primary,\n+    width: '3rem',\n+    textAlign: 'start',\n+    height: '4rem',\n+  },\n+  text: {\n+    fontSize: '14px',\n+    letterSpacing: 0,\n+    lineHeight: '18px',\n+    color: colors.primary,\n+    verticalAlign: 'top',\n+    textOverflow: 'ellipsis',\n+    overflow: 'auto',\n+    height: '4rem',\n+    width: '5rem',\n+  }\n+});\n+\n+interface State {\n+  loadingInstitutions: boolean;\n+  institutions: Array<Institution>;\n+  institutionLoadError: boolean;\n+}\n+\n+export class AdminInstitution extends React.Component<{}, State> {\n+  constructor(props) {\n+    super(props);\n+    this.state = {\n+      loadingInstitutions: true,\n+      institutions: [],\n+      institutionLoadError: false\n+    };\n+  }\n+\n+  async componentDidMount() {\n+    try {\n+      const details = await institutionApi().getInstitutions();\n+      this.setState({\n+        loadingInstitutions: false,\n+        institutions: details.institutions\n+      });\n+    } catch (e) {\n+      this.setState({\n+        loadingInstitutions: false,\n+        institutionLoadError: true\n+      });\n+    }\n+  }\n+\n+  renderOrganizationType(row, col) {\n+    switch ( row['organizationTypeEnum']) {\n+      case OrganizationType.ACADEMICRESEARCHINSTITUTION: return 'Academic Research Institution';\n+      case OrganizationType.HEALTHCENTERNONPROFIT: return 'Health Center Non-Profit';\n+      case OrganizationType.EDUCATIONALINSTITUTION: return 'Educational Institution';\n+      case OrganizationType.INDUSTRY: return 'Industry';\n+      default: return 'Other';\n+    }\n+  }\n+\n+  renderDuaType(row, col) {\n+    return row['duaTypeEnum'] === DuaType.RESTRICTED ? 'Individual' : 'Master';\n+  }\n+\n+  // If email domain list has more than 4 entries show top 4 and replace others with ...\n+  renderEmailDomain(row, col) {\n+    const emailDomain = fp.take(4, row['emailDomains']).join('\\n') ;\n+    if (row['emailDomains'] && row['emailDomains'].length > 4) {\n+      return emailDomain + '...';\n+    }\n+    return emailDomain;\n+  }\n+\n+  // If email address list has more than 4 entries show top 4 and replace others with ...\n+  renderEmailAddress(row, col) {\n+    const emailAddresses = fp.take(4, row['emailAddresses']).join('\\n') ;\n+    if (row['emailAddresses'] && row['emailAddresses'].length > 4) {\n+      return emailAddresses + '...';\n+    }\n+    return emailAddresses;\n+  }\n+\n+  render() {\n+    const {institutions, institutionLoadError, loadingInstitutions} = this.state;\n+    return <div>\n+      <FadeBox style={{marginTop: '1rem', marginLeft: '1rem'}}>\n+        <SemiBoldHeader style={styles.pageHeader}>\n+          <label>Institution admin table</label>\n+              <Button type='secondaryLight'\n+                      style={{padding: '0rem', marginTop: '0.3rem', verticalAlign: 'sub'}}\n+                      data-test-id='add-institution'>\n+                <ClrIcon shape='plus-circle' class='is-solid' size={20}/>\n+              </Button>\n+        </SemiBoldHeader>\n+        {institutionLoadError && <div style={{color: colors.danger}}>\n+          Error while loading Institution please try again later</div>}", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0MTU4Mg==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425341582", "bodyText": "Something indicating that this refers to an email.  Maybe \"User Email Instructions\"", "author": "jmthibault79", "createdAt": "2020-05-14T18:19:47Z", "path": "ui/src/app/pages/admin/admin-institution.tsx", "diffHunk": "@@ -0,0 +1,153 @@\n+import {Component} from '@angular/core';\n+import {Button} from 'app/components/buttons';\n+import {FadeBox} from 'app/components/containers';\n+import {SemiBoldHeader} from 'app/components/headers';\n+import {ClrIcon} from 'app/components/icons';\n+import {institutionApi} from 'app/services/swagger-fetch-clients';\n+import colors from 'app/styles/colors';\n+import {ReactWrapperBase} from 'app/utils';\n+import {reactStyles} from 'app/utils';\n+import {Institution} from 'generated/fetch';\n+import {DuaType, OrganizationType} from 'generated/fetch';\n+import * as fp from 'lodash/fp';\n+import {Column} from 'primereact/column';\n+import {DataTable} from 'primereact/datatable';\n+import * as React from 'react';\n+\n+\n+const styles = reactStyles({\n+  pageHeader: {\n+    fontSize: '18px',\n+    lineHeight: '22px',\n+    marginBottom: '1rem',\n+    marginTop: '0.5rem'\n+  },\n+  header: {\n+    fontSize: '14px',\n+    fontWeight: 600,\n+    letterSpacing: 0,\n+    lineHeight: '18px',\n+    color: colors.primary,\n+    width: '3rem',\n+    textAlign: 'start',\n+    height: '4rem',\n+  },\n+  text: {\n+    fontSize: '14px',\n+    letterSpacing: 0,\n+    lineHeight: '18px',\n+    color: colors.primary,\n+    verticalAlign: 'top',\n+    textOverflow: 'ellipsis',\n+    overflow: 'auto',\n+    height: '4rem',\n+    width: '5rem',\n+  }\n+});\n+\n+interface State {\n+  loadingInstitutions: boolean;\n+  institutions: Array<Institution>;\n+  institutionLoadError: boolean;\n+}\n+\n+export class AdminInstitution extends React.Component<{}, State> {\n+  constructor(props) {\n+    super(props);\n+    this.state = {\n+      loadingInstitutions: true,\n+      institutions: [],\n+      institutionLoadError: false\n+    };\n+  }\n+\n+  async componentDidMount() {\n+    try {\n+      const details = await institutionApi().getInstitutions();\n+      this.setState({\n+        loadingInstitutions: false,\n+        institutions: details.institutions\n+      });\n+    } catch (e) {\n+      this.setState({\n+        loadingInstitutions: false,\n+        institutionLoadError: true\n+      });\n+    }\n+  }\n+\n+  renderOrganizationType(row, col) {\n+    switch ( row['organizationTypeEnum']) {\n+      case OrganizationType.ACADEMICRESEARCHINSTITUTION: return 'Academic Research Institution';\n+      case OrganizationType.HEALTHCENTERNONPROFIT: return 'Health Center Non-Profit';\n+      case OrganizationType.EDUCATIONALINSTITUTION: return 'Educational Institution';\n+      case OrganizationType.INDUSTRY: return 'Industry';\n+      default: return 'Other';\n+    }\n+  }\n+\n+  renderDuaType(row, col) {\n+    return row['duaTypeEnum'] === DuaType.RESTRICTED ? 'Individual' : 'Master';\n+  }\n+\n+  // If email domain list has more than 4 entries show top 4 and replace others with ...\n+  renderEmailDomain(row, col) {\n+    const emailDomain = fp.take(4, row['emailDomains']).join('\\n') ;\n+    if (row['emailDomains'] && row['emailDomains'].length > 4) {\n+      return emailDomain + '...';\n+    }\n+    return emailDomain;\n+  }\n+\n+  // If email address list has more than 4 entries show top 4 and replace others with ...\n+  renderEmailAddress(row, col) {\n+    const emailAddresses = fp.take(4, row['emailAddresses']).join('\\n') ;\n+    if (row['emailAddresses'] && row['emailAddresses'].length > 4) {\n+      return emailAddresses + '...';\n+    }\n+    return emailAddresses;\n+  }\n+\n+  render() {\n+    const {institutions, institutionLoadError, loadingInstitutions} = this.state;\n+    return <div>\n+      <FadeBox style={{marginTop: '1rem', marginLeft: '1rem'}}>\n+        <SemiBoldHeader style={styles.pageHeader}>\n+          <label>Institution admin table</label>\n+              <Button type='secondaryLight'\n+                      style={{padding: '0rem', marginTop: '0.3rem', verticalAlign: 'sub'}}\n+                      data-test-id='add-institution'>\n+                <ClrIcon shape='plus-circle' class='is-solid' size={20}/>\n+              </Button>\n+        </SemiBoldHeader>\n+        {institutionLoadError && <div style={{color: colors.danger}}>\n+          Error while loading Institution please try again later</div>}\n+        <DataTable data-test-id='institution-datatable' value={institutions} paginator={true}\n+                   rows={5} scrollable={true} frozenWidth='7rem' loading={loadingInstitutions}>\n+          <Column field='displayName' header='Institution Name'\n+                  bodyStyle={styles.text} headerStyle={styles.header} frozen={true}/>\n+          <Column field='organizationTypeEnum' header='Institution Type'\n+                  body={this.renderOrganizationType} bodyStyle={styles.text}\n+                  headerStyle={styles.header}/>\n+          <Column field='duaTypeEnum' header='Agreement Type' body={this.renderDuaType}\n+                  bodyStyle={styles.text} headerStyle={styles.header}/>\n+          <Column field='emailDomains' header='Accepted Domain List' body={this.renderEmailDomain}\n+                  bodyStyle={styles.text} headerStyle={styles.header}/>\n+          <Column field='emailAddresses' header='Accepted Email List' body={this.renderEmailAddress}\n+                  bodyStyle={styles.text} headerStyle={styles.header}/>\n+          <Column field='userInstructions' header='User Instruction' bodyStyle={styles.text}", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0Mzg3Mw==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r425343873", "bodyText": "If organization type is OTHER, we should display the organizationTypeOtherText here instead.  Maybe both, something like \"Other: WhateverSpecialType\"", "author": "jmthibault79", "createdAt": "2020-05-14T18:23:55Z", "path": "ui/src/app/pages/admin/admin-institution.tsx", "diffHunk": "@@ -0,0 +1,153 @@\n+import {Component} from '@angular/core';\n+import {Button} from 'app/components/buttons';\n+import {FadeBox} from 'app/components/containers';\n+import {SemiBoldHeader} from 'app/components/headers';\n+import {ClrIcon} from 'app/components/icons';\n+import {institutionApi} from 'app/services/swagger-fetch-clients';\n+import colors from 'app/styles/colors';\n+import {ReactWrapperBase} from 'app/utils';\n+import {reactStyles} from 'app/utils';\n+import {Institution} from 'generated/fetch';\n+import {DuaType, OrganizationType} from 'generated/fetch';\n+import * as fp from 'lodash/fp';\n+import {Column} from 'primereact/column';\n+import {DataTable} from 'primereact/datatable';\n+import * as React from 'react';\n+\n+\n+const styles = reactStyles({\n+  pageHeader: {\n+    fontSize: '18px',\n+    lineHeight: '22px',\n+    marginBottom: '1rem',\n+    marginTop: '0.5rem'\n+  },\n+  header: {\n+    fontSize: '14px',\n+    fontWeight: 600,\n+    letterSpacing: 0,\n+    lineHeight: '18px',\n+    color: colors.primary,\n+    width: '3rem',\n+    textAlign: 'start',\n+    height: '4rem',\n+  },\n+  text: {\n+    fontSize: '14px',\n+    letterSpacing: 0,\n+    lineHeight: '18px',\n+    color: colors.primary,\n+    verticalAlign: 'top',\n+    textOverflow: 'ellipsis',\n+    overflow: 'auto',\n+    height: '4rem',\n+    width: '5rem',\n+  }\n+});\n+\n+interface State {\n+  loadingInstitutions: boolean;\n+  institutions: Array<Institution>;\n+  institutionLoadError: boolean;\n+}\n+\n+export class AdminInstitution extends React.Component<{}, State> {\n+  constructor(props) {\n+    super(props);\n+    this.state = {\n+      loadingInstitutions: true,\n+      institutions: [],\n+      institutionLoadError: false\n+    };\n+  }\n+\n+  async componentDidMount() {\n+    try {\n+      const details = await institutionApi().getInstitutions();\n+      this.setState({\n+        loadingInstitutions: false,\n+        institutions: details.institutions\n+      });\n+    } catch (e) {\n+      this.setState({\n+        loadingInstitutions: false,\n+        institutionLoadError: true\n+      });\n+    }\n+  }\n+\n+  renderOrganizationType(row, col) {\n+    switch ( row['organizationTypeEnum']) {\n+      case OrganizationType.ACADEMICRESEARCHINSTITUTION: return 'Academic Research Institution';\n+      case OrganizationType.HEALTHCENTERNONPROFIT: return 'Health Center Non-Profit';\n+      case OrganizationType.EDUCATIONALINSTITUTION: return 'Educational Institution';\n+      case OrganizationType.INDUSTRY: return 'Industry';\n+      default: return 'Other';", "originalCommit": "dd6ac1181bf23c58becb6fa6795d16900e1ccd0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c5b90bc5d5fac66ea2df0d4155e776c5c5c6b7be", "url": "https://github.com/all-of-us/workbench/commit/c5b90bc5d5fac66ea2df0d4155e776c5c5c6b7be", "message": "Pr comments", "committedDate": "2020-05-14T21:21:40Z", "type": "commit"}, {"oid": "038c63b7f66d820137d79539f9a78c75942ed48b", "url": "https://github.com/all-of-us/workbench/commit/038c63b7f66d820137d79539f9a78c75942ed48b", "message": "Pr comments equality that", "committedDate": "2020-05-14T21:23:30Z", "type": "commit"}, {"oid": "8aa8cc1488ac3b15179e4ef874bd615f6858e708", "url": "https://github.com/all-of-us/workbench/commit/8aa8cc1488ac3b15179e4ef874bd615f6858e708", "message": "Primereact 4.2 has updated dropdown onchange to originalEvent: Event, value: any, target: {name: string, id: string, value: any", "committedDate": "2020-05-15T13:35:59Z", "type": "commit"}, {"oid": "832540f36273e59ebab9ba7f7b37b4f0a1896b8b", "url": "https://github.com/all-of-us/workbench/commit/832540f36273e59ebab9ba7f7b37b4f0a1896b8b", "message": "PR COMMENTS: Use mapper for setting userInstructions", "committedDate": "2020-05-15T16:13:15Z", "type": "commit"}, {"oid": "e07bdcee21765c9dc7ccda75e82ed735befc89c6", "url": "https://github.com/all-of-us/workbench/commit/e07bdcee21765c9dc7ccda75e82ed735befc89c6", "message": "Add comments InstructionMapper", "committedDate": "2020-05-15T16:14:39Z", "type": "commit"}, {"oid": "311024f8e3e6e57a54471651186ea932eb6b4535", "url": "https://github.com/all-of-us/workbench/commit/311024f8e3e6e57a54471651186ea932eb6b4535", "message": "Remove method not being used in InstructionMapper", "committedDate": "2020-05-15T16:19:45Z", "type": "commit"}, {"oid": "590adbb9590eecf84fca804e30a7d56a2f77ac1a", "url": "https://github.com/all-of-us/workbench/commit/590adbb9590eecf84fca804e30a7d56a2f77ac1a", "message": "Fix Api Test", "committedDate": "2020-05-15T16:35:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxNTk5Nw==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r426015997", "bodyText": "this can be ifPresent(target::setUserInstructions)", "author": "jmthibault79", "createdAt": "2020-05-15T19:52:32Z", "path": "api/src/main/java/org/pmiops/workbench/institution/InstitutionMapper.java", "diffHunk": "@@ -50,4 +55,15 @@\n         .map(address -> new DbInstitutionEmailAddress().setEmailAddress(address))\n         .collect(Collectors.toSet());\n   }\n+\n+  @AfterMapping\n+  default void setUserInstruction(\n+      @MappingTarget Institution target, @Context InstitutionService institutionService) {\n+    institutionService\n+        .getInstitutionUserInstructions(target.getShortName())\n+        .ifPresent(", "originalCommit": "590adbb9590eecf84fca804e30a7d56a2f77ac1a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxNzAwOQ==", "url": "https://github.com/all-of-us/workbench/pull/3580#discussion_r426017009", "bodyText": "yes thats much neater thanks", "author": "NehaBroad", "createdAt": "2020-05-15T19:54:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxNTk5Nw=="}], "type": "inlineReview"}, {"oid": "babf665f0858785dfccdada4d53bd92efbc52586", "url": "https://github.com/all-of-us/workbench/commit/babf665f0858785dfccdada4d53bd92efbc52586", "message": "PR Comment: Neater way to set  user instruction", "committedDate": "2020-05-15T19:58:28Z", "type": "commit"}]}