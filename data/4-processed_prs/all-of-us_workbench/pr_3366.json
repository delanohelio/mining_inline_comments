{"pr_number": 3366, "pr_title": "[RW-3989][risk=low] Validate length on all workspace free text fields before creation", "pr_createdAt": "2020-04-08T05:22:46Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3366", "timeline": [{"oid": "1ef19f071c6e7f027c08dbcd32fb106171122fcd", "url": "https://github.com/all-of-us/workbench/commit/1ef19f071c6e7f027c08dbcd32fb106171122fcd", "message": "add error messages for free text char limit", "committedDate": "2020-04-08T05:19:32Z", "type": "commit"}, {"oid": "15ba2bf879776b97199eea76244faff32ed60946", "url": "https://github.com/all-of-us/workbench/commit/15ba2bf879776b97199eea76244faff32ed60946", "message": "fix test", "committedDate": "2020-04-08T05:36:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU4MTE4NA==", "url": "https://github.com/all-of-us/workbench/pull/3366#discussion_r405581184", "bodyText": "Shouldn't this error message say at most 500 characters? Since workspace table column rp_other_purpose_details is varchar(500)?", "author": "freemabd", "createdAt": "2020-04-08T14:46:33Z", "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "diffHunk": "@@ -1102,19 +1135,25 @@ export const WorkspaceEdit = fp.flow(withRouteConfigData(), withCurrentWorkspace\n             <TooltipTrigger content={\n               errors && <ul>\n                 {errors.name && <div>{errors.name}</div>}\n-                {errors.billingAccountName && <div>You must select a billing account</div>}\n-                {errors.primaryPurpose && <div>You must choose at least one primary research\n+                {errors.billingAccountName && <div>\n+                  You must select a billing account</div>}\n+                {errors.primaryPurpose && <div> You must choose at least one primary research\n                   purpose (Question 1)</div>}\n-                {errors.anticipatedFindings && <div>Answer for <i>What are the anticipated findings\n+                {errors.otherPrimaryPurpose && <div> Other primary purpose should be of atleast 500 characters</div>}", "originalCommit": "15ba2bf879776b97199eea76244faff32ed60946", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTc1MDgwOQ==", "url": "https://github.com/all-of-us/workbench/pull/3366#discussion_r405750809", "bodyText": "yes yeah i'll change it for all the relevant fields", "author": "NehaBroad", "createdAt": "2020-04-08T19:07:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU4MTE4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU4MjA4MA==", "url": "https://github.com/all-of-us/workbench/pull/3366#discussion_r405582080", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            {errors.diseaseOfFocus && <div> You must specify a disease of focus and it should be atleast 80 characters</div>}\n          \n          \n            \n                            {errors.diseaseOfFocus && <div> You must specify a disease of focus and it should be at most 80 characters</div>}", "author": "freemabd", "createdAt": "2020-04-08T14:47:46Z", "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "diffHunk": "@@ -1102,19 +1135,25 @@ export const WorkspaceEdit = fp.flow(withRouteConfigData(), withCurrentWorkspace\n             <TooltipTrigger content={\n               errors && <ul>\n                 {errors.name && <div>{errors.name}</div>}\n-                {errors.billingAccountName && <div>You must select a billing account</div>}\n-                {errors.primaryPurpose && <div>You must choose at least one primary research\n+                {errors.billingAccountName && <div>\n+                  You must select a billing account</div>}\n+                {errors.primaryPurpose && <div> You must choose at least one primary research\n                   purpose (Question 1)</div>}\n-                {errors.anticipatedFindings && <div>Answer for <i>What are the anticipated findings\n+                {errors.otherPrimaryPurpose && <div> Other primary purpose should be of atleast 500 characters</div>}\n+                {errors.anticipatedFindings && <div> Answer for <i>What are the anticipated findings\n                   from the study? (Question # 2.1)</i> cannot be empty</div>}\n-                {errors.scientificApproach && <div>Answer for <i>What are the scientific\n+                {errors.scientificApproach && <div> Answer for <i>What are the scientific\n                   approaches you plan to use for your study (Question # 2.2)</i> cannot be empty</div>}\n-                {errors.intendedStudy && <div>Answer for<i>What are the specific\n-                  scientific question(s) you intend to study (Question # 2.3)</i> cannot be empty</div>}\n-                {errors.specificPopulation && <div>You must specify a population of study</div>}\n-                {errors.diseaseOfFocus && <div>You must specify a disease of focus</div>}\n-                {errors.researchOutcoming && <div>You must specify the outcome of the research</div>}\n-                {errors.disseminate && <div>You must specific how you plan to disseminate your research findings</div>}\n+                {errors.intendedStudy && <div> Answer for<i>What are the specific scientific question(s) you intend to study\n+                  (Question # 2.3)</i> cannot be empty</div>}\n+                {errors.specificPopulation && <div> You must specify a population of study</div>}\n+                {errors.diseaseOfFocus && <div> You must specify a disease of focus and it should be atleast 80 characters</div>}", "originalCommit": "15ba2bf879776b97199eea76244faff32ed60946", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU4MjM0NA==", "url": "https://github.com/all-of-us/workbench/pull/3366#discussion_r405582344", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                              Specific Population Other text should be of atleast 100 characters</div>}\n          \n          \n            \n                              Specific Population Other text should be of at most 100 characters</div>}", "author": "freemabd", "createdAt": "2020-04-08T14:48:06Z", "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "diffHunk": "@@ -1102,19 +1135,25 @@ export const WorkspaceEdit = fp.flow(withRouteConfigData(), withCurrentWorkspace\n             <TooltipTrigger content={\n               errors && <ul>\n                 {errors.name && <div>{errors.name}</div>}\n-                {errors.billingAccountName && <div>You must select a billing account</div>}\n-                {errors.primaryPurpose && <div>You must choose at least one primary research\n+                {errors.billingAccountName && <div>\n+                  You must select a billing account</div>}\n+                {errors.primaryPurpose && <div> You must choose at least one primary research\n                   purpose (Question 1)</div>}\n-                {errors.anticipatedFindings && <div>Answer for <i>What are the anticipated findings\n+                {errors.otherPrimaryPurpose && <div> Other primary purpose should be of atleast 500 characters</div>}\n+                {errors.anticipatedFindings && <div> Answer for <i>What are the anticipated findings\n                   from the study? (Question # 2.1)</i> cannot be empty</div>}\n-                {errors.scientificApproach && <div>Answer for <i>What are the scientific\n+                {errors.scientificApproach && <div> Answer for <i>What are the scientific\n                   approaches you plan to use for your study (Question # 2.2)</i> cannot be empty</div>}\n-                {errors.intendedStudy && <div>Answer for<i>What are the specific\n-                  scientific question(s) you intend to study (Question # 2.3)</i> cannot be empty</div>}\n-                {errors.specificPopulation && <div>You must specify a population of study</div>}\n-                {errors.diseaseOfFocus && <div>You must specify a disease of focus</div>}\n-                {errors.researchOutcoming && <div>You must specify the outcome of the research</div>}\n-                {errors.disseminate && <div>You must specific how you plan to disseminate your research findings</div>}\n+                {errors.intendedStudy && <div> Answer for<i>What are the specific scientific question(s) you intend to study\n+                  (Question # 2.3)</i> cannot be empty</div>}\n+                {errors.specificPopulation && <div> You must specify a population of study</div>}\n+                {errors.diseaseOfFocus && <div> You must specify a disease of focus and it should be atleast 80 characters</div>}\n+                {errors.researchOutcoming && <div> You must specify the outcome of the research</div>}\n+                {errors.disseminate && <div> You must specific how you plan to disseminate your research findings</div>}\n+                {errors.otherDisseminateResearchFindings && <div>\n+                  Disseminate Research Findings Other text should be of atleast 100 characters</div>}\n+                {errors.otherSpecificPopulation && <div>\n+                  Specific Population Other text should be of atleast 100 characters</div>}", "originalCommit": "15ba2bf879776b97199eea76244faff32ed60946", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU5MzEzMw==", "url": "https://github.com/all-of-us/workbench/pull/3366#discussion_r405593133", "bodyText": "Should it be >= 500?", "author": "freemabd", "createdAt": "2020-04-08T15:02:17Z", "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "diffHunk": "@@ -560,6 +564,12 @@ export const WorkspaceEdit = fp.flow(withRouteConfigData(), withCurrentWorkspace\n           rp.methodsDevelopment || rp.otherPurpose || rp.populationHealth || rp.socialBehavioral;\n     }\n \n+    get isOtherPrimaryPurposeValid() {\n+      const rp = this.state.workspace.researchPurpose;\n+      return !rp.otherPurpose ||\n+          (rp.otherPurposeDetails && rp.otherPurposeDetails.length <= 500);", "originalCommit": "15ba2bf879776b97199eea76244faff32ed60946", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTc0NjA0Ng==", "url": "https://github.com/all-of-us/workbench/pull/3366#discussion_r405746046", "bodyText": "Its valid as long as its within 500", "author": "NehaBroad", "createdAt": "2020-04-08T18:59:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU5MzEzMw=="}], "type": "inlineReview"}, {"oid": "871b7678a748735c74bb1e1dcced858091eb25a0", "url": "https://github.com/all-of-us/workbench/commit/871b7678a748735c74bb1e1dcced858091eb25a0", "message": "atleast to at most", "committedDate": "2020-04-08T19:08:13Z", "type": "commit"}]}