{"pr_number": 3281, "pr_title": "Puppeteer logs dir not exists", "pr_createdAt": "2020-03-20T20:24:55Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3281", "timeline": [{"oid": "32c3789ba7b6395e55c837aecfbc05692b76f524", "url": "https://github.com/all-of-us/workbench/commit/32c3789ba7b6395e55c837aecfbc05692b76f524", "message": "not ignore logs dir", "committedDate": "2020-03-20T19:49:27Z", "type": "commit"}, {"oid": "0fe1488bf844439ecbf351e9275d307c25da0ff6", "url": "https://github.com/all-of-us/workbench/commit/0fe1488bf844439ecbf351e9275d307c25da0ff6", "message": "add fs-extra", "committedDate": "2020-03-20T20:20:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTg3NzgzNA==", "url": "https://github.com/all-of-us/workbench/pull/3281#discussion_r395877834", "bodyText": "nit: maybe name it SCREENSHOT_DIR.", "author": "jaycarlton", "createdAt": "2020-03-20T20:36:25Z", "path": "e2e/app/base-page.ts", "diffHunk": "@@ -228,9 +228,7 @@ export default abstract class BasePage {\n    */\n   async takeScreenshot(fileName: string) {\n     const dir = 'logs/screenshot';\n-    if (!fs.existsSync(dir)) {\n-      fs.mkdirSync(dir);\n-    }\n+    await fse.ensureDir(dir);", "originalCommit": "0fe1488bf844439ecbf351e9275d307c25da0ff6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTg3ODY4NA==", "url": "https://github.com/all-of-us/workbench/pull/3281#discussion_r395878684", "bodyText": "nit: maybe specify GoogleLoginPageNotFound to distinguish from the case of an unrecognized user.", "author": "jaycarlton", "createdAt": "2020-03-20T20:38:33Z", "path": "e2e/app/google-login.ts", "diffHunk": "@@ -91,11 +91,13 @@ export default class GoogleLoginPage extends BasePage {\n    */\n   async load(): Promise<void> {\n     const url = configs.uiBaseUrl + configs.loginUrlPath;\n-    await this.page.goto(url, {waitUntil: ['networkidle0', 'domcontentloaded'], timeout: 30000}).catch((err) => {\n+    try {\n+      await this.page.goto(url, {waitUntil: ['networkidle0', 'domcontentloaded'], timeout: 30000});\n+    } catch (err) {\n       console.error('Google login page not found. ' + err);\n-      this.takeScreenshot('GoogleLoginNotFound');\n+      await this.takeScreenshot('GoogleLoginNotFound');", "originalCommit": "0fe1488bf844439ecbf351e9275d307c25da0ff6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTg3OTIyOA==", "url": "https://github.com/all-of-us/workbench/pull/3281#discussion_r395879228", "bodyText": "nit: Maybe wrap this into a higher-level function like this.navigate(url).\nThe timeout seems a little generous. to my untrained eye, especially for the login page.", "author": "jaycarlton", "createdAt": "2020-03-20T20:39:51Z", "path": "e2e/app/google-login.ts", "diffHunk": "@@ -91,11 +91,13 @@ export default class GoogleLoginPage extends BasePage {\n    */\n   async load(): Promise<void> {\n     const url = configs.uiBaseUrl + configs.loginUrlPath;\n-    await this.page.goto(url, {waitUntil: ['networkidle0', 'domcontentloaded'], timeout: 30000}).catch((err) => {\n+    try {\n+      await this.page.goto(url, {waitUntil: ['networkidle0', 'domcontentloaded'], timeout: 30000});", "originalCommit": "0fe1488bf844439ecbf351e9275d307c25da0ff6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d5285857a23f3a4f29ebcb4584e94812067666a3", "url": "https://github.com/all-of-us/workbench/commit/d5285857a23f3a4f29ebcb4584e94812067666a3", "message": "PR feedback", "committedDate": "2020-03-20T20:43:25Z", "type": "commit"}]}