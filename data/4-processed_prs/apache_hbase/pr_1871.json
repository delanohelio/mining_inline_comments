{"pr_number": 1871, "pr_title": "HBASE-24005 Document maven invocation with JDK11", "pr_createdAt": "2020-06-08T18:09:50Z", "pr_url": "https://github.com/apache/hbase/pull/1871", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkyNTQyOQ==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r436925429", "bodyText": "NIT: In some sections \"Maven\" with an upper-case \"M\" is used. Here it is lower-cased. I think it is better to stay consistent.", "author": "HorizonNet", "createdAt": "2020-06-08T18:59:30Z", "path": "src/main/asciidoc/_chapters/developer.adoc", "diffHunk": "@@ -420,6 +419,27 @@ Tests may not all pass so you may need to pass `-DskipTests` unless you are incl\n \n To pick a particular Hadoop 3.y release, you'd set hadoop-three.version property e.g. `-Dhadoop-three.version=3.0.0`.\n \n+[[maven.build.jdk11_hadoop3]]\n+==== Building with JDK11 and Hadoop3\n+\n+The following guidance applies to HBase versions [2.3, 3), where both JDK8 and JDK11 are supported,\n+and both Hadoop2 and Hadoop3 are supported.\n+\n+HBase manages JDK-specific build settings using maven profiles. The profile appropriate to the JDK", "originalCommit": "e1123eeb9db25f84791b2d57895996f46598ee9e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkzMzc4MQ==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r436933781", "bodyText": "Is this really necessary as the hadoop-3.0 profile is active by default (at least on master)? Or better state it to make it generic for all mentioned releases?", "author": "HorizonNet", "createdAt": "2020-06-08T19:09:05Z", "path": "src/main/asciidoc/_chapters/developer.adoc", "diffHunk": "@@ -420,6 +419,27 @@ Tests may not all pass so you may need to pass `-DskipTests` unless you are incl\n \n To pick a particular Hadoop 3.y release, you'd set hadoop-three.version property e.g. `-Dhadoop-three.version=3.0.0`.\n \n+[[maven.build.jdk11_hadoop3]]\n+==== Building with JDK11 and Hadoop3\n+\n+The following guidance applies to HBase versions [2.3, 3), where both JDK8 and JDK11 are supported,\n+and both Hadoop2 and Hadoop3 are supported.\n+\n+HBase manages JDK-specific build settings using maven profiles. The profile appropriate to the JDK\n+in use is automatically selected. JDK8 supports both Hadoop2 and Hadoop3. For JDK11, only Hadoop3\n+is supported, which means you must specify `-Dhadoop.profile=3.0` when building with JDK11.", "originalCommit": "e1123eeb9db25f84791b2d57895996f46598ee9e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjk1NDEyMg==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r436954122", "bodyText": "By specifying -Dhadoop.profile=3.0, users are consistent across all JDK 11 supported branches. For instance, branch-2 has hadoop-2.0 active by default I believe. Hence, with this doc, users can try -Dhadoop.profile=3.0 for all supported branches and there is no harm with master branch also. This should be fine. Thought?", "author": "virajjasani", "createdAt": "2020-06-08T19:36:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkzMzc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjk1NjM3NQ==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r436956375", "bodyText": "That's what I meant by the second question. For me it's totally fine. Just wanted to shortly discuss if we should make a distinction between the different releases or not.", "author": "HorizonNet", "createdAt": "2020-06-08T19:41:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkzMzc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjk2MjE4OA==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r436962188", "bodyText": "Oh okk, got it. Thanks", "author": "virajjasani", "createdAt": "2020-06-08T19:52:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkzMzc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjk3NTY2MQ==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r436975661", "bodyText": "I called out that this is applicable to 2.3, up through but excluding 3.0. You think having this documented here will be confusing? Should I point out how 3.0 is different?", "author": "ndimiduk", "createdAt": "2020-06-08T20:19:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkzMzc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjk3NjM5Ng==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r436976396", "bodyText": "My intention (and I believe it's common practice for all release managers) is to make a blanket-copy of the docs from master back to branch-2 and branch-2.3. I've staged the commit locally and skimming through, I haven't found much content that's applicable to master but not branch-2/.3.", "author": "ndimiduk", "createdAt": "2020-06-08T20:20:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkzMzc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjk4NTQ0OQ==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r436985449", "bodyText": "I think the earlier section, Building against various hadoop versions needs updated in light of the point you've raised here. Nice find.", "author": "ndimiduk", "createdAt": "2020-06-08T20:36:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkzMzc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAxMTYyMg==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r437011622", "bodyText": "I've updated that text as well, let me know if it satisfies.", "author": "ndimiduk", "createdAt": "2020-06-08T21:28:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkzMzc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAxNjUwOA==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r437016508", "bodyText": "Bah. Now I need to update this text to refer back to what I just wrote.", "author": "ndimiduk", "createdAt": "2020-06-08T21:39:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkzMzc4MQ=="}], "type": "inlineReview"}, {"oid": "e9c8f0ffb8023bc752dc66238b3a1396591fb1c1", "url": "https://github.com/apache/hbase/commit/e9c8f0ffb8023bc752dc66238b3a1396591fb1c1", "message": "HBASE-24005 Document maven invocation with JDK11", "committedDate": "2020-06-08T20:16:44Z", "type": "forcePushed"}, {"oid": "7e695bc508159a15f9f3778c6f281d0e2e4ac0f0", "url": "https://github.com/apache/hbase/commit/7e695bc508159a15f9f3778c6f281d0e2e4ac0f0", "message": "PR feedback -- update docs around hadoop profile and version selection", "committedDate": "2020-06-08T21:57:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAyNzQxNQ==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r437027415", "bodyText": "nit: we shouldn't be telling folks to build against non-released versions of Apache Hadoop I think?", "author": "busbey", "createdAt": "2020-06-08T22:05:34Z", "path": "src/main/asciidoc/_chapters/developer.adoc", "diffHunk": "@@ -397,28 +396,109 @@ mvn clean install -DskipTests\n See the <<hbase.unittests.cmds,hbase.unittests.cmds>> section in <<hbase.unittests,hbase.unittests>>\n \n [[maven.build.hadoop]]\n-==== Building against various hadoop versions.\n+==== Building against various Hadoop versions\n+\n+HBase supports building against Apache Hadoop versions: 2.y and 3.y (early release artifacts).\n+Exactly which version of Hadoop is used by default varies by release branch. See the section\n+<<hadoop,Hadoop>> for the complete breakdown of supported Hadoop version by HBase release.\n+\n+The mechanism for selecting a Hadoop version at build time is identical across all releases. Which\n+version of Hadoop is default varies. We manage Hadoop major version selection by way of Maven\n+profiles. Due to the peculiarities of Maven profile mutual exclusion, the profile that builds\n+against a particular Hadoop version is activated by setting a property, *not* the usual profile\n+activation. Hadoop version profile activation is summarized by the following table.\n+\n+.Hadoop Profile Activation by HBase Release\n+[cols=\"3*^.^\", options=\"header\"]\n+|===\n+| | Hadoop2 Activation | Hadoop3 Activation\n+| HBase 1.3+ | _active by default_ | `-Dhadoop.profile=3.0`\n+| HBase 3.0+ | _not supported_ | _active by default_\n+|===\n+\n+[WARNING]\n+====\n+Please note that where a profile is active by default, `hadoop.profile` must NOT be provided.\n+====\n+\n+Once the Hadoop major version profile is activated, the exact Hadoop version can be\n+specified by overriding the appropriate property value. For Hadoop2 versions, the property name\n+is `hadoop-two.version`. With Hadoop3 versions, the property name is `hadoop-three.version`.\n \n-HBase supports building against Apache Hadoop versions: 2.y and 3.y (early release artifacts). By default we build against Hadoop 2.x.\n+.Example 1, Building HBase 1.7 against Hadoop 2.10.0\n \n-To build against a specific release from the Hadoop 2.y line, set e.g. `-Dhadoop-two.version=2.6.3`.\n+For example, to build HBase 1.7 against Hadoop 2.10.0, the profile is set for Hadoop2 by default,\n+so only `hadoop-two.version` must be specified:\n \n [source,bourne]\n ----\n-mvn -Dhadoop-two.version=2.6.3 ...\n+git checkout branch-1\n+mvn -Dhadoop-two.version=2.10.0 ...\n ----\n \n-To change the major release line of Hadoop we build against, add a hadoop.profile property when you invoke +mvn+:\n+.Example 2, Building HBase 2.3 against Hadoop 3.3.0-SNAPSHOT", "originalCommit": "7e695bc508159a15f9f3778c6f281d0e2e4ac0f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAyODI1NA==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r437028254", "bodyText": "this is where it's problematic that our ref guide is both the resource for downstream users of HBase and the development community of HBase. Can we make this \"build against a different major release line of hadoop\" use a released version? and then belwo when we talk about development versions include a note that the instructions are for folks subscribed to dev@hbase working on development of the project?", "author": "busbey", "createdAt": "2020-06-08T22:07:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAyNzQxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA0MzUxMw==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r437043513", "bodyText": "Is it that much of a problem? I could simply drop the SNAPSHOT bits and update the language to sound like that version was already released. It'll eventually be accurate...\nI could also edit the example context slightly, saying \"this is how a developer of Hadoop might verify the compatibility of a recent Hadoop  build against a recent hbase build.\"", "author": "ndimiduk", "createdAt": "2020-06-08T22:50:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAyNzQxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA3ODA5OQ==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r437078099", "bodyText": "I like that last proposed edit.\nHow much of a problem telling folks to use unreleased artifacts is depends on the winds of ASF policy vs spirit stuff. So I'd rather avoid getting near the morass", "author": "busbey", "createdAt": "2020-06-09T00:53:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAyNzQxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzcwNzI3MA==", "url": "https://github.com/apache/hbase/pull/1871#discussion_r437707270", "bodyText": "@busbey updated the language around the SNAPSHOT dependency, let me know if this satisfies.", "author": "ndimiduk", "createdAt": "2020-06-09T20:45:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAyNzQxNQ=="}], "type": "inlineReview"}, {"oid": "8543ac1fdcbe60a484065fc3c4f4854e23d6421e", "url": "https://github.com/apache/hbase/commit/8543ac1fdcbe60a484065fc3c4f4854e23d6421e", "message": "PR Feedback -- be less flippant about SNAPSHOT examples", "committedDate": "2020-06-09T20:44:20Z", "type": "forcePushed"}, {"oid": "e3d262fba972bf5f77c22b66bd7794f3f2862533", "url": "https://github.com/apache/hbase/commit/e3d262fba972bf5f77c22b66bd7794f3f2862533", "message": "HBASE-24005 Document maven invocation with JDK11\n\nSigned-off-by: Jan Hentschel <jan.hentschel@ultratendency.com>\nSigned-off-by: Viraj Jasani <vjasani@apache.org>\nSigned-off-by: Sean Busbey <busbey@apache.org>", "committedDate": "2020-06-09T22:31:57Z", "type": "commit"}, {"oid": "e3d262fba972bf5f77c22b66bd7794f3f2862533", "url": "https://github.com/apache/hbase/commit/e3d262fba972bf5f77c22b66bd7794f3f2862533", "message": "HBASE-24005 Document maven invocation with JDK11\n\nSigned-off-by: Jan Hentschel <jan.hentschel@ultratendency.com>\nSigned-off-by: Viraj Jasani <vjasani@apache.org>\nSigned-off-by: Sean Busbey <busbey@apache.org>", "committedDate": "2020-06-09T22:31:57Z", "type": "forcePushed"}]}