{"pr_number": 2396, "pr_title": "[Flaky Test][branch-1] TestFromClientSide#testCheckAndDeleteWithCompareOp", "pr_createdAt": "2020-09-14T11:04:41Z", "pr_url": "https://github.com/apache/hbase/pull/2396", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc4Njk3Nw==", "url": "https://github.com/apache/hbase/pull/2396#discussion_r488786977", "bodyText": "so this was just a redundant put right?", "author": "virajjasani", "createdAt": "2020-09-15T16:06:15Z", "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java", "diffHunk": "@@ -5028,73 +5028,70 @@ public void testCheckAndDeleteWithCompareOp() throws IOException, InterruptedExc\n         FAMILY);\n     TEST_UTIL.waitTableAvailable(TableName.valueOf(\"testCheckAndDeleteWithCompareOp\"), 10000);\n \n-    Put put2 = new Put(ROW);\n-    put2.add(FAMILY, QUALIFIER, value2);\n-    table.put(put2);\n+    Put bbbb = new Put(ROW);\n+    bbbb.add(FAMILY, QUALIFIER, value2);\n \n-    Put put3 = new Put(ROW);\n-    put3.add(FAMILY, QUALIFIER, value3);\n+    Put cccc = new Put(ROW);\n+    cccc.add(FAMILY, QUALIFIER, value3);\n \n     Delete delete = new Delete(ROW);\n     delete.deleteColumns(FAMILY, QUALIFIER);\n \n     // cell = \"bbbb\", using \"aaaa\" to compare only LESS/LESS_OR_EQUAL/NOT_EQUAL\n     // turns out \"match\"\n+    table.put(bbbb);\n     boolean ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.GREATER, value1, delete);\n-    assertEquals(ok, false);\n+    // aaaa is less than bbbb, > || >= should be false\n+    assertFalse(ok);\n     ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.EQUAL, value1, delete);\n-    assertEquals(ok, false);\n+    assertFalse(ok);\n     ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.GREATER_OR_EQUAL, value1, delete);\n-    assertEquals(ok, false);\n+    assertFalse(ok);\n+    // aaaa is less than bbbb, < || <= should be true\n     ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.LESS, value1, delete);\n-    assertEquals(ok, true);\n-    table.put(put2);\n+    assertTrue(ok);\n+    table.put(bbbb);\n     ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.LESS_OR_EQUAL, value1, delete);\n-    assertEquals(ok, true);\n-    table.put(put2);", "originalCommit": "74345240a52ce4684f1ee9d7b84a94d432910517", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE1NDYwMw==", "url": "https://github.com/apache/hbase/pull/2396#discussion_r489154603", "bodyText": "Yes.", "author": "Reidddddd", "createdAt": "2020-09-16T04:29:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc4Njk3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc5MDEyMg==", "url": "https://github.com/apache/hbase/pull/2396#discussion_r488790122", "bodyText": "Curious to know if keeping this put operation on this line is a code improvement or has something to do with flaky behaviour?", "author": "virajjasani", "createdAt": "2020-09-15T16:10:50Z", "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java", "diffHunk": "@@ -5028,73 +5028,70 @@ public void testCheckAndDeleteWithCompareOp() throws IOException, InterruptedExc\n         FAMILY);\n     TEST_UTIL.waitTableAvailable(TableName.valueOf(\"testCheckAndDeleteWithCompareOp\"), 10000);\n \n-    Put put2 = new Put(ROW);\n-    put2.add(FAMILY, QUALIFIER, value2);\n-    table.put(put2);\n+    Put bbbb = new Put(ROW);\n+    bbbb.add(FAMILY, QUALIFIER, value2);\n \n-    Put put3 = new Put(ROW);\n-    put3.add(FAMILY, QUALIFIER, value3);\n+    Put cccc = new Put(ROW);\n+    cccc.add(FAMILY, QUALIFIER, value3);\n \n     Delete delete = new Delete(ROW);\n     delete.deleteColumns(FAMILY, QUALIFIER);\n \n     // cell = \"bbbb\", using \"aaaa\" to compare only LESS/LESS_OR_EQUAL/NOT_EQUAL\n     // turns out \"match\"\n+    table.put(bbbb);", "originalCommit": "74345240a52ce4684f1ee9d7b84a94d432910517", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE1NDUyMw==", "url": "https://github.com/apache/hbase/pull/2396#discussion_r489154523", "bodyText": "Just for readability only, this was originally in line 5033. I just separated it from initialization.", "author": "Reidddddd", "createdAt": "2020-09-16T04:29:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc5MDEyMg=="}], "type": "inlineReview"}, {"oid": "2537bc03fe3658e28162b03445d0ca993bd8d511", "url": "https://github.com/apache/hbase/commit/2537bc03fe3658e28162b03445d0ca993bd8d511", "message": "HBASE-25025 [Flaky Test][branch-1] TestFromClientSide#testCheckAndDeleteWithCompareOp", "committedDate": "2020-09-28T09:32:15Z", "type": "commit"}, {"oid": "2537bc03fe3658e28162b03445d0ca993bd8d511", "url": "https://github.com/apache/hbase/commit/2537bc03fe3658e28162b03445d0ca993bd8d511", "message": "HBASE-25025 [Flaky Test][branch-1] TestFromClientSide#testCheckAndDeleteWithCompareOp", "committedDate": "2020-09-28T09:32:15Z", "type": "forcePushed"}]}