{"pr_number": 2726, "pr_title": "HBASE-25293 Followup jira to address the client handling issue when c\u2026", "pr_createdAt": "2020-11-30T23:59:38Z", "pr_url": "https://github.com/apache/hbase/pull/2726", "timeline": [{"oid": "bbd7d1c9bdebfe108e2431c7b8023acfb4558b90", "url": "https://github.com/apache/hbase/commit/bbd7d1c9bdebfe108e2431c7b8023acfb4558b90", "message": "HBASE-25293 Followup jira to address the client handling issue when chaning from meta replica to non-meta-replica at the server side.", "committedDate": "2020-12-01T02:10:34Z", "type": "commit"}, {"oid": "bbd7d1c9bdebfe108e2431c7b8023acfb4558b90", "url": "https://github.com/apache/hbase/commit/bbd7d1c9bdebfe108e2431c7b8023acfb4558b90", "message": "HBASE-25293 Followup jira to address the client handling issue when chaning from meta replica to non-meta-replica at the server side.", "committedDate": "2020-12-01T02:10:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzc2MjkyNQ==", "url": "https://github.com/apache/hbase/pull/2726#discussion_r537762925", "bodyText": "How often will we log this message when a client is trying to connect to the cluster? Will it happen frequently?", "author": "saintstack", "createdAt": "2020-12-07T19:17:02Z", "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/CatalogReplicaLoadBalanceSimpleSelector.java", "diffHunk": "@@ -262,16 +261,16 @@ private void cleanupReplicaReplicaStaleCache() {\n   private int refreshCatalogReplicaCount() {\n     int newNumOfReplicas = this.getNumOfReplicas.getAsInt();\n     LOG.debug(\"Refreshed replica count {}\", newNumOfReplicas);\n-    if (newNumOfReplicas == 1) {\n-      LOG.warn(\"Table {}'s region replica count is 1, maybe a misconfiguration or failure to \"\n-        + \"fetch the replica count\", tableName);\n+    // If the returned number of replicas is -1, it is caused by failure to fetch the\n+    // replica count. Do not update the numOfReplicas in this case.\n+    if (newNumOfReplicas == CatalogReplicaLoadBalanceSelector.UNINITIALIZED_NUM_OF_REPLICAS) {\n+      LOG.error(\"Failed to fetch Table {}'s region replica count\", tableName);", "originalCommit": "bbd7d1c9bdebfe108e2431c7b8023acfb4558b90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ4ODM4Mg==", "url": "https://github.com/apache/hbase/pull/2726#discussion_r539488382", "bodyText": "Currently, it is logged every 2 minutes.", "author": "huaxiangsun", "createdAt": "2020-12-09T17:09:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzc2MjkyNQ=="}], "type": "inlineReview"}]}