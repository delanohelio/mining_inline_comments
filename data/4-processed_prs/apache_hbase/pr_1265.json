{"pr_number": 1265, "pr_title": "HBASE-23077 move entirely to spotbugs", "pr_createdAt": "2020-03-10T16:28:36Z", "pr_url": "https://github.com/apache/hbase/pull/1265", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ1MzI5NA==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r390453294", "bodyText": "nit: whitespace error?", "author": "busbey", "createdAt": "2020-03-10T16:39:24Z", "path": "hbase-shaded/hbase-shaded-check-invariants/pom.xml", "diffHunk": "@@ -118,8 +118,9 @@\n                     <exclude>log4j:*</exclude>\n                     <exclude>commons-logging:*</exclude>\n                     <!-- annotations that never change -->\n-                    <exclude>com.google.code.findbugs:*</exclude>\n-                    <exclude>com.github.stephenc.findbugs:*</exclude>\n+\t\t    <exclude>com.google.code.findbugs:*</exclude>", "originalCommit": "b4b99d2f53c3ab01f8fd6d05b04b0605d4981b22", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ1MzQ2NQ==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r390453465", "bodyText": "please label optional", "author": "busbey", "createdAt": "2020-03-10T16:39:39Z", "path": "hbase-shaded/hbase-shaded-client-byo-hadoop/pom.xml", "diffHunk": "@@ -73,9 +73,9 @@\n         </activation>\n         <dependencies>\n           <dependency>\n-             <groupId>com.github.stephenc.findbugs</groupId>\n-             <artifactId>findbugs-annotations</artifactId>\n-             <optional>true</optional>\n+            <groupId>com.github.stephenc.findbugs</groupId>\n+            <artifactId>findbugs-annotations</artifactId>\n+            <scope>provided</scope>", "originalCommit": "b4b99d2f53c3ab01f8fd6d05b04b0605d4981b22", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ1MzY1NQ==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r390453655", "bodyText": "nit: whitespace error", "author": "busbey", "createdAt": "2020-03-10T16:39:58Z", "path": "hbase-shaded/hbase-shaded-testing-util/pom.xml", "diffHunk": "@@ -183,8 +183,9 @@\n                                     <!-- The rest of these should be kept in sync with the parent pom -->\n                                     <exclude>org.apache.hbase:hbase-resource-bundle</exclude>\n                                     <exclude>org.slf4j:*</exclude>\n-                                    <exclude>com.google.code.findbugs:*</exclude>\n-                                    <exclude>com.github.stephenc.findbugs:*</exclude>\n+\t\t\t\t    <exclude>com.google.code.findbugs:*</exclude>", "originalCommit": "b4b99d2f53c3ab01f8fd6d05b04b0605d4981b22", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ1Mzg0NA==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r390453844", "bodyText": "nit: whitespace error", "author": "busbey", "createdAt": "2020-03-10T16:40:17Z", "path": "hbase-shaded/pom.xml", "diffHunk": "@@ -146,8 +146,9 @@\n                                              hadoop-including module -->\n                                         <exclude>org.apache.hbase:hbase-resource-bundle</exclude>\n                                         <exclude>org.slf4j:*</exclude>\n-                                        <exclude>com.google.code.findbugs:*</exclude>\n-                                        <exclude>com.github.stephenc.findbugs:*</exclude>\n+\t\t\t\t\t<exclude>com.google.code.findbugs:*</exclude>", "originalCommit": "b4b99d2f53c3ab01f8fd6d05b04b0605d4981b22", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fed9212566559452b70d700b1c874237c30b6e84", "url": "https://github.com/apache/hbase/commit/fed9212566559452b70d700b1c874237c30b6e84", "message": "HBASE-23077 move entirely to spotbugs", "committedDate": "2020-03-11T01:09:04Z", "type": "forcePushed"}, {"oid": "dae8f81746ae6ad1ad82d2a7ee255d4b87b9068d", "url": "https://github.com/apache/hbase/commit/dae8f81746ae6ad1ad82d2a7ee255d4b87b9068d", "message": "HBASE-23077 move entirely to spotbugs", "committedDate": "2020-03-11T03:37:38Z", "type": "forcePushed"}, {"oid": "a091cc089e9e2600422a49ed7a35beb8354a8335", "url": "https://github.com/apache/hbase/commit/a091cc089e9e2600422a49ed7a35beb8354a8335", "message": "HBASE-23077 move entirely to spotbugs", "committedDate": "2020-03-11T04:17:16Z", "type": "forcePushed"}, {"oid": "12d5ac9bbe7cbc034fc629f088a4ddc854023552", "url": "https://github.com/apache/hbase/commit/12d5ac9bbe7cbc034fc629f088a4ddc854023552", "message": "HBASE-23077 move entirely to spotbugs", "committedDate": "2020-03-11T09:38:07Z", "type": "forcePushed"}, {"oid": "21b4296045a21971fdc036d26ef0a1d14d5037b1", "url": "https://github.com/apache/hbase/commit/21b4296045a21971fdc036d26ef0a1d14d5037b1", "message": "HBASE-23077 move entirely to spotbugs", "committedDate": "2020-03-11T13:43:23Z", "type": "forcePushed"}, {"oid": "163bc29c61fcdb738bd2a431acb9efa9c3699e87", "url": "https://github.com/apache/hbase/commit/163bc29c61fcdb738bd2a431acb9efa9c3699e87", "message": "HBASE-23077 move entirely to spotbugs", "committedDate": "2020-03-11T15:45:12Z", "type": "forcePushed"}, {"oid": "bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "url": "https://github.com/apache/hbase/commit/bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "message": "HBASE-23077 move entirely to spotbugs", "committedDate": "2020-03-12T00:23:28Z", "type": "commit"}, {"oid": "bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "url": "https://github.com/apache/hbase/commit/bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "message": "HBASE-23077 move entirely to spotbugs", "committedDate": "2020-03-12T00:23:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM2Nzc5Mw==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391367793", "bodyText": "Good", "author": "saintstack", "createdAt": "2020-03-12T02:17:06Z", "path": "dev-support/docker/Dockerfile", "diffHunk": "@@ -184,9 +183,9 @@ RUN mkdir -p /usr/lib/jvm && \\\n # these values to be specified here; the various --foo-path flags do not\n # propigate as expected, while these are honored.\n # TODO (nd): is this really true? investigate and file a ticket.\n-ENV FINDBUGS_HOME '/opt/findbugs'\n+ENV SPOTBUGS_HOME '/opt/spotbugs'\n ENV MAVEN_HOME '/opt/maven'\n-ENV MAVEN_OPTS '-Xms6G -Xmx6G'\n+ENV MAVEN_OPTS '-Xms4G -Xmx4G'", "originalCommit": "bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM2Nzg5OA==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391367898", "bodyText": "Good", "author": "saintstack", "createdAt": "2020-03-12T02:17:39Z", "path": "dev-support/hbase-personality.sh", "diffHunk": "@@ -184,18 +184,30 @@ function personality_modules\n     done\n   fi\n \n-  if [[ ${testtype} == findbugs ]]; then\n-    # Run findbugs on each module individually to diff pre-patch and post-patch results and\n+  if [[ ${testtype} == spotbugs ]]; then\n+    # Run spotbugs on each module individually to diff pre-patch and post-patch results and\n     # report new warnings for changed modules only.\n-    # For some reason, findbugs on root is not working, but running on individual modules is\n+    # For some reason, spotbugs on root is not working, but running on individual modules is\n     # working. For time being, let it run on original list of CHANGED_MODULES. HBASE-19491\n     for module in \"${CHANGED_MODULES[@]}\"; do\n-      # skip findbugs on hbase-shell and hbase-it. hbase-it has nothing\n-      # in src/main/java where findbugs goes to look\n+      # skip spotbugs on hbase-shell and hbase-it. hbase-it has nothing\n+      # in src/main/java where spotbugs goes to look\n+      # skip hbase-shaded* as there is no java code in them\n+      # skip all modules with no java code or at least, non test java code\n       if [[ ${module} == hbase-shell ]]; then\n         continue\n       elif [[ ${module} == hbase-it ]]; then\n         continue\n+      elif [[ ${module} == hbase-shaded* ]]; then", "originalCommit": "bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM2ODA1NQ==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391368055", "bodyText": "Says '--findbugs'... No '--spotbugs'?", "author": "saintstack", "createdAt": "2020-03-12T02:18:24Z", "path": "dev-support/jenkins_precommit_github_yetus.sh", "diffHunk": "@@ -104,14 +104,14 @@ YETUS_ARGS+=(\"--reapermode=kill\")\n # with other jobs on systemd-enabled machines\n YETUS_ARGS+=(\"--proclimit=10000\")\n YETUS_ARGS+=(\"--dockermemlimit=20g\")\n-# -1 findbugs issues that show up prior to the patch being applied\n-YETUS_ARGS+=(\"--findbugs-strict-precheck\")\n+# -1 spotbugs issues that show up prior to the patch being applied\n+YETUS_ARGS+=(\"--spotbugs-strict-precheck\")\n # rsync these files back into the archive dir\n YETUS_ARGS+=(\"--archive-list=${ARCHIVE_PATTERN_LIST}\")\n # URL for user-side presentation in reports and such to our artifacts\n YETUS_ARGS+=(\"--build-url-artifacts=${BUILD_URL_ARTIFACTS}\")\n # plugins to enable\n-YETUS_ARGS+=(\"--plugins=${PLUGINS}\")\n+YETUS_ARGS+=(\"--plugins=${PLUGINS},-findbugs\")", "originalCommit": "bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM2OTQ0OQ==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391369449", "bodyText": "This is the design of yetus... If you want to use spotbugs then specifiy -finbugs, if you want to use findbugs then specity -spotbugs...", "author": "Apache9", "createdAt": "2020-03-12T02:24:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM2ODA1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM2ODM1NA==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391368354", "bodyText": "Don't need to remove this stephenc findbugs? You do above in hbase-client/pom.xml  You seem to leave it in elsewhere so guessing it ok.", "author": "saintstack", "createdAt": "2020-03-12T02:19:41Z", "path": "hbase-examples/pom.xml", "diffHunk": "@@ -159,6 +159,8 @@\n     <dependency>\n       <groupId>com.github.stephenc.findbugs</groupId>", "originalCommit": "bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM2OTU5NA==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391369594", "bodyText": "For hbase-client and another module, the problem is that we declare this dependency only under the hadoop 2 profile and it will cause compile error with hadoop 3. So just move it to the general dependencies section.", "author": "Apache9", "createdAt": "2020-03-12T02:25:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM2ODM1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTcyMTcyMQ==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391721721", "bodyText": "\"fingbugs\" and not \"findbugs\" ?", "author": "ndimiduk", "createdAt": "2020-03-12T15:58:58Z", "path": "hbase-shaded/hbase-shaded-check-invariants/pom.xml", "diffHunk": "@@ -119,7 +119,8 @@\n                     <exclude>commons-logging:*</exclude>\n                     <!-- annotations that never change -->\n                     <exclude>com.google.code.findbugs:*</exclude>\n-                    <exclude>com.github.stephenc.findbugs:*</exclude>\n+                    <exclude>com.github.stephenc.fingbugs:*</exclude>", "originalCommit": "bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTcyMTg0MA==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391721840", "bodyText": "same.", "author": "ndimiduk", "createdAt": "2020-03-12T15:59:10Z", "path": "hbase-shaded/hbase-shaded-client/pom.xml", "diffHunk": "@@ -67,7 +67,8 @@\n                                     <exclude>org.apache.hbase:hbase-resource-bundle</exclude>\n                                     <exclude>org.slf4j:*</exclude>\n                                     <exclude>com.google.code.findbugs:*</exclude>\n-                                    <exclude>com.github.stephenc.findbugs:*</exclude>\n+                                    <exclude>com.github.stephenc.fingbugs:*</exclude>", "originalCommit": "bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTcyMjAxNQ==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391722015", "bodyText": "oops, copy-pasted everywhere.", "author": "ndimiduk", "createdAt": "2020-03-12T15:59:26Z", "path": "hbase-shaded/hbase-shaded-testing-util/pom.xml", "diffHunk": "@@ -184,7 +184,8 @@\n                                     <exclude>org.apache.hbase:hbase-resource-bundle</exclude>\n                                     <exclude>org.slf4j:*</exclude>\n                                     <exclude>com.google.code.findbugs:*</exclude>\n-                                    <exclude>com.github.stephenc.findbugs:*</exclude>\n+                                    <exclude>com.github.stephenc.fingbugs:*</exclude>", "originalCommit": "bd4edfb986b78e6aaead6bb4874cd107ba5eef39", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk3MTczMQ==", "url": "https://github.com/apache/hbase/pull/1265#discussion_r391971731", "bodyText": "Let me do a sed -i...", "author": "Apache9", "createdAt": "2020-03-13T00:26:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTcyMjAxNQ=="}], "type": "inlineReview"}]}