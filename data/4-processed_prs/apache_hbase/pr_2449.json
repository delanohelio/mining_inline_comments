{"pr_number": 2449, "pr_title": "HBASE-25091 Move LogComparator from ReplicationSource to AbstractFSWA\u2026", "pr_createdAt": "2020-09-23T18:14:47Z", "pr_url": "https://github.com/apache/hbase/pull/2449", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAwNDM5OQ==", "url": "https://github.com/apache/hbase/pull/2449#discussion_r494004399", "bodyText": "WALFileStartTimeComparator is better? We are comparing Paths here.", "author": "Apache9", "createdAt": "2020-09-24T02:37:23Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/AbstractFSWALProvider.java", "diffHunk": "@@ -418,6 +419,30 @@ public static boolean isMetaFile(String p) {\n     return p != null && p.endsWith(META_WAL_PROVIDER_ID);\n   }\n \n+  /**\n+   * Comparator used to compare logs together based on their start time.\n+   * Just compares start times and nothing else.\n+   */\n+  public static class WALsStartTimeComparator implements Comparator<Path> {", "originalCommit": "fb3ddfd265403f6fff8abcb0bfd053eb93aaed6e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQxNTY1MA==", "url": "https://github.com/apache/hbase/pull/2449#discussion_r494415650", "bodyText": "It extracts the timestamp from the filename and compares that so, yes, compares the 'start' logging timestamp.", "author": "saintstack", "createdAt": "2020-09-24T15:33:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAwNDM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQyMzQ0Ng==", "url": "https://github.com/apache/hbase/pull/2449#discussion_r494423446", "bodyText": "Here is the original comparator named LogComparator:\n-    @Override\n-    public int compare(Path o1, Path o2) {\n-      return Long.compare(getTS(o1), getTS(o2));\n-    }\n-\n-    /**\n-     * <p>\n-     * Split a path to get the start time\n-     * </p>\n-     * <p>\n-     * For example: 10.20.20.171%3A60020.1277499063250\n-     * </p>\n-     * @param p path to split\n-     * @return start time\n-     */\n-    private static long getTS(Path p) {\n-      return AbstractFSWALProvider.getWALStartTimeFromWALName(p.getName());\n-    }", "author": "saintstack", "createdAt": "2020-09-24T15:44:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAwNDM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0OTk4MA==", "url": "https://github.com/apache/hbase/pull/2449#discussion_r494849980", "bodyText": "I mean is it better to change 'WALs' to 'WALFile'? Or at least to 'WAL'? 'WALs' looks strange...", "author": "Apache9", "createdAt": "2020-09-25T09:01:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAwNDM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUzMzQ0Nw==", "url": "https://github.com/apache/hbase/pull/2449#discussion_r495533447", "bodyText": "I am +1 for \"WALStartTimeComparator\". :-)", "author": "infraio", "createdAt": "2020-09-27T06:00:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAwNDM5OQ=="}], "type": "inlineReview"}, {"oid": "33dbbe6b8480ca8077485fa5ce92ab9a6eab1e3a", "url": "https://github.com/apache/hbase/commit/33dbbe6b8480ca8077485fa5ce92ab9a6eab1e3a", "message": "HBASE-25091 Move LogComparator from ReplicationSource to AbstractFSWALProvider#.WALsStartTimeComparator\n\nGive the comparator a more descriptive name, a better location,\nand make it work even when passed hbase:meta WAL files.", "committedDate": "2020-09-24T18:48:48Z", "type": "forcePushed"}, {"oid": "8e689e893ad13e84e094455444564964e33250ff", "url": "https://github.com/apache/hbase/commit/8e689e893ad13e84e094455444564964e33250ff", "message": "HBASE-25091 Move LogComparator from ReplicationSource to AbstractFSWALProvider#.WALsStartTimeComparator\n\nGive the comparator a more descriptive name, a better location,\nand make it work even when passed hbase:meta WAL files.\n\nSigned-off-by: Duo Zhang <zhangduo@apache.org>\nSigned-off-by: Guanghao Zhang <zghao@apache.org>", "committedDate": "2020-09-30T17:18:53Z", "type": "commit"}, {"oid": "8e689e893ad13e84e094455444564964e33250ff", "url": "https://github.com/apache/hbase/commit/8e689e893ad13e84e094455444564964e33250ff", "message": "HBASE-25091 Move LogComparator from ReplicationSource to AbstractFSWALProvider#.WALsStartTimeComparator\n\nGive the comparator a more descriptive name, a better location,\nand make it work even when passed hbase:meta WAL files.\n\nSigned-off-by: Duo Zhang <zhangduo@apache.org>\nSigned-off-by: Guanghao Zhang <zghao@apache.org>", "committedDate": "2020-09-30T17:18:53Z", "type": "forcePushed"}]}