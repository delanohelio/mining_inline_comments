{"pr_number": 265, "pr_title": "Patch Nested Copybooks", "pr_createdAt": "2020-04-06T09:13:00Z", "pr_url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/265", "timeline": [{"oid": "c4b75eaf29a6963a6bf3a68a2dd450740ce1dbed", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c4b75eaf29a6963a6bf3a68a2dd450740ce1dbed", "message": "Move responsability on DependencyService and adjust unit test", "committedDate": "2020-03-16T11:44:12Z", "type": "commit"}, {"oid": "708562617e6ed5e71f4053455f01bb7f2d99b9de", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/708562617e6ed5e71f4053455f01bb7f2d99b9de", "message": "Refactor FSConfig file", "committedDate": "2020-03-20T09:00:52Z", "type": "commit"}, {"oid": "1955e9620852abcce2b851a85aeba80517c038bf", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/1955e9620852abcce2b851a85aeba80517c038bf", "message": "update unit test and concrete implementation in CopybookDependencyServiceImpl", "committedDate": "2020-03-20T10:45:07Z", "type": "commit"}, {"oid": "335d28357e703ab0ebd3b66d817089c9c24a184d", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/335d28357e703ab0ebd3b66d817089c9c24a184d", "message": "Fix lombok issue - need deep investigation", "committedDate": "2020-03-24T08:29:03Z", "type": "commit"}, {"oid": "2e0234e0afa9169c93f134b0383b64348fb100ca", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/2e0234e0afa9169c93f134b0383b64348fb100ca", "message": "Add e2e test involving preprocessor and copybook service", "committedDate": "2020-03-26T07:55:38Z", "type": "commit"}, {"oid": "2b9c7edf64bd6732bf0e5246c9ad9150e46ae3fd", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/2b9c7edf64bd6732bf0e5246c9ad9150e46ae3fd", "message": "Remove commented code after unit test refactoring", "committedDate": "2020-03-26T13:38:30Z", "type": "commit"}, {"oid": "2846fdcc3f6b513d05bef7ba45aab93e404dc9c6", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/2846fdcc3f6b513d05bef7ba45aab93e404dc9c6", "message": "Update Changelog", "committedDate": "2020-03-26T15:14:51Z", "type": "commit"}, {"oid": "9cb39ef8ac7bd1371edaa69cb4ca142edc7700a9", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/9cb39ef8ac7bd1371edaa69cb4ca142edc7700a9", "message": "Merge remote-tracking branch 'remotes/origin/development' into 251_AddNestedCpyInDep\n\n# Conflicts:\n#\tCHANGELOG.md\n#\tclients/cobol-lsp-vscode-extension/CHANGELOG.md\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/CopybookServiceImpl.java\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/delegates/dependency/CopybookDependencyServiceImpl.java\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/utils/FileSystemUtils.java\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/test/java/com/ca/lsp/cobol/FileSystemConfiguration.java\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/test/java/com/ca/lsp/cobol/service/DependencyServiceTest.java", "committedDate": "2020-03-31T07:35:44Z", "type": "commit"}, {"oid": "8f624c3754e2964eeb0a05fadc8bbb21d6c59cdb", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/8f624c3754e2964eeb0a05fadc8bbb21d6c59cdb", "message": "Address request of change", "committedDate": "2020-04-01T08:02:54Z", "type": "commit"}, {"oid": "2a3bbeb6ee3d1f277b59e009d3e090edbef6c930", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/2a3bbeb6ee3d1f277b59e009d3e090edbef6c930", "message": "Refactor CopybookDependencyServiceImpl.java", "committedDate": "2020-04-01T11:36:27Z", "type": "commit"}, {"oid": "3f7c9367178af65605d1c59635a5d777c1b43a5e", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/3f7c9367178af65605d1c59635a5d777c1b43a5e", "message": "Polish CopybookDependencyServiceImpl & FileSystemUtils.java", "committedDate": "2020-04-01T11:47:18Z", "type": "commit"}, {"oid": "d7052edcd559b47a5c154597b449d469d5ae2cbf", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/d7052edcd559b47a5c154597b449d469d5ae2cbf", "message": "Fix extra chars in javadoc", "committedDate": "2020-04-01T12:50:53Z", "type": "commit"}, {"oid": "795d4728b44d2a7f039d0e6e67e36eab727d1af8", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/795d4728b44d2a7f039d0e6e67e36eab727d1af8", "message": "Cleanup FileSystemUtils.java", "committedDate": "2020-04-01T12:53:07Z", "type": "commit"}, {"oid": "77cf43a78dfb964480988044f329a86fb4551143", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/77cf43a78dfb964480988044f329a86fb4551143", "message": "Fix code review requests", "committedDate": "2020-04-06T09:17:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY4NTQxNA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/265#discussion_r404685414", "bodyText": "This name describes the logic of the method, but not the expected result. It would be better to use something like shouldUpdateDependecies() or any more descriptive name. But it is not obligatory.\nThe real question here is exposing the internal implementation by using a data bus event in the interface. I would prefer to hide it if it is possible", "author": "temanbrcom", "createdAt": "2020-04-07T09:56:57Z", "path": "com.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/delegates/dependency/CopybookDependencyService.java", "diffHunk": "@@ -24,11 +26,14 @@\n  * management\n  */\n public interface CopybookDependencyService {\n+\n+  void addCopybookInDepFile(RequiredCopybookEvent event, String requiredCopybookName);\n+\n+  boolean isFileInDidOpen(RequiredCopybookEvent event);", "originalCommit": "77cf43a78dfb964480988044f329a86fb4551143", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY5Mjc3OQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/265#discussion_r404692779", "bodyText": "Yeah we already agree that is better hide this implementation detail, the problem is that I need PowerMock to do that, and I opened an issue to track the activity to make it private again!", "author": "zacanbrcom", "createdAt": "2020-04-07T10:09:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY4NTQxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY5NDM3MQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/265#discussion_r404694371", "bodyText": "For the naming I could change it no problem but is just check that the enum type for the document is DID_OPEN, I don't see any relation with update the dependency. Furthermore we can in the future use this method for checks not dependent on the dependency file update. Let me know if I miss something from the picture", "author": "zacanbrcom", "createdAt": "2020-04-07T10:11:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY4NTQxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDcxMDcwMQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/265#discussion_r404710701", "bodyText": "There is a little difference between the naming by method logic and by its purpose. The first one describes how the method works, and the second one describes the useful outcome of the method. Here I don't really care that processing type was used to invoke this event, the only important thing is if I need to apply some changes according to that.", "author": "temanbrcom", "createdAt": "2020-04-07T10:40:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY4NTQxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY4NzcyNQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/265#discussion_r404687725", "bodyText": "Why do you need to sort it?", "author": "temanbrcom", "createdAt": "2020-04-07T10:00:42Z", "path": "com.ca.lsp.cobol/lsp-service-cobol/src/test/java/com/ca/lsp/cobol/FileSystemConfiguration.java", "diffHunk": "@@ -85,36 +92,35 @@\n    * the filesystem service capabilities using the physical filesystem\n    */\n   @Before\n-  public void buildFS() {\n-    intializeSettings();\n+  public void buildTempFilesystem() {\n+    intializeSettingsWithSomeContent();\n+\n     createWorkspaceFolderStructure();\n-    createCopybookStructure();\n-    createDependencyFileStructure();\n+    createCopybookFolders();\n+    createDependencyFolder();\n \n-    // populate copybook folder and dependency file with some content\n     createCopybookFiles();\n+    createNestedCopybooks();\n     createDependencyFile();\n   }\n \n   @After\n-  public void cleanupTempFolder() {\n+  public void cleanupTempFilesystem() {\n     try {\n-      Files.walk(getWorkspaceFolderPath())\n-          .sorted(Comparator.reverseOrder())\n-          .map(Path::toFile)\n-          .forEach(File::delete);\n+      deleteFolders();\n     } catch (IOException e) {\n       log.error(e.getMessage());\n     }\n   }\n \n-  /**\n-   * This method define the steps necessary to emulate the json settings provided by the user in the\n-   * settings.json\n-   */\n-  private void intializeSettings() {\n-    // SettingsProvider settingsProvider = new SettingsProvider();\n+  private void deleteFolders() throws IOException {\n+    Files.walk(getWorkspaceFolderPath())\n+        .sorted(Comparator.reverseOrder())", "originalCommit": "77cf43a78dfb964480988044f329a86fb4551143", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY5OTM0Nw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/265#discussion_r404699347", "bodyText": "Because I need to remove folders and item recursively.\nSo if I try to remove a non empty folder I got exception. So I ordered to have the files first and then the folder (that will be removed easily since there isn't any file inside of it).\nHere the reference I used in the past.", "author": "zacanbrcom", "createdAt": "2020-04-07T10:20:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY4NzcyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDcxMTMzNA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/265#discussion_r404711334", "bodyText": "Nice trick, I didn't know about that", "author": "temanbrcom", "createdAt": "2020-04-07T10:41:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY4NzcyNQ=="}], "type": "inlineReview"}, {"oid": "842a925d0249c7a3d5d0e08ab4c99b415dc47d47", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/842a925d0249c7a3d5d0e08ab4c99b415dc47d47", "message": "Merge branch 'development' into PATCH_NST_CPY\n\n# Conflicts:\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/CopybookServiceImpl.java\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/delegates/dependency/CopybookDependencyServiceImpl.java\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/utils/FileSystemUtils.java", "committedDate": "2020-04-07T10:25:51Z", "type": "commit"}, {"oid": "70d777b9c7e0baaa109296665ef59c8bbb570017", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/70d777b9c7e0baaa109296665ef59c8bbb570017", "message": "Address merge conflict", "committedDate": "2020-04-07T10:30:38Z", "type": "commit"}]}