{"pr_number": 10641, "pr_title": "Add HttpScheme Support in HttpToHttp2ConnectionHandler", "pr_createdAt": "2020-10-06T09:35:24Z", "pr_url": "https://github.com/netty/netty/pull/10641", "timeline": [{"oid": "4a40db3b08dc13a3ac447e6a439e379aad9d5f53", "url": "https://github.com/netty/netty/commit/4a40db3b08dc13a3ac447e6a439e379aad9d5f53", "message": "add HttpScheme support", "committedDate": "2020-10-06T09:31:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ==", "url": "https://github.com/netty/netty/pull/10641#discussion_r511957711", "bodyText": "honestly I think thats a very bad idea... a method with get in its name should not modify the headers that are passed in. This is just super unexpected.", "author": "normanmaurer", "createdAt": "2020-10-26T13:27:56Z", "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/HttpToHttp2ConnectionHandler.java", "diffHunk": "@@ -60,6 +70,9 @@ protected HttpToHttp2ConnectionHandler(Http2ConnectionDecoder decoder, Http2Conn\n      * @throws Exception If the {@code httpHeaders} object specifies an invalid stream id\n      */\n     private int getStreamId(HttpHeaders httpHeaders) throws Exception {\n+        if (httpScheme != null && !httpHeaders.contains(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text())) {\n+            httpHeaders.set(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text(), httpScheme.name());", "originalCommit": "4a40db3b08dc13a3ac447e6a439e379aad9d5f53", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1OTQyOA==", "url": "https://github.com/netty/netty/pull/10641#discussion_r511959428", "bodyText": "Agree. Should I move into the write method?", "author": "hyperxpro", "createdAt": "2020-10-26T13:30:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk2MTQwNA==", "url": "https://github.com/netty/netty/pull/10641#discussion_r511961404", "bodyText": "yes", "author": "normanmaurer", "createdAt": "2020-10-26T13:33:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk2MTUxMA==", "url": "https://github.com/netty/netty/pull/10641#discussion_r511961510", "bodyText": "Also please add a test case", "author": "normanmaurer", "createdAt": "2020-10-26T13:33:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDEyNTc5Mw==", "url": "https://github.com/netty/netty/pull/10641#discussion_r514125793", "bodyText": "@hyperxpro please ping me once done", "author": "normanmaurer", "createdAt": "2020-10-29T09:41:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIwNjYxMQ==", "url": "https://github.com/netty/netty/pull/10641#discussion_r514206611", "bodyText": "Sorry for the delay. Been really busy. I made changes as you told and also added a test case.", "author": "hyperxpro", "createdAt": "2020-10-29T12:04:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}], "type": "inlineReview"}, {"oid": "a802c62292f8f1bb88b8a2339a291c48c976aee8", "url": "https://github.com/netty/netty/commit/a802c62292f8f1bb88b8a2339a291c48c976aee8", "message": "Move HttpScheme changing in write method", "committedDate": "2020-10-29T10:34:45Z", "type": "commit"}, {"oid": "32e1e873f51ced0501e38c9dd50b1b4228167d54", "url": "https://github.com/netty/netty/commit/32e1e873f51ced0501e38c9dd50b1b4228167d54", "message": "Add tests", "committedDate": "2020-10-29T12:01:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQzMTU2OA==", "url": "https://github.com/netty/netty/pull/10641#discussion_r517431568", "bodyText": "revert ?", "author": "normanmaurer", "createdAt": "2020-11-04T15:34:13Z", "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/AbstractHttp2ConnectionHandlerBuilder.java", "diffHunk": "@@ -17,6 +17,7 @@\n package io.netty.handler.codec.http2;\n \n import io.netty.channel.Channel;\n+import io.netty.handler.codec.http.HttpScheme;", "originalCommit": "32e1e873f51ced0501e38c9dd50b1b4228167d54", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQzMzIxOA==", "url": "https://github.com/netty/netty/pull/10641#discussion_r517433218", "bodyText": "Done", "author": "hyperxpro", "createdAt": "2020-11-04T15:36:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQzMTU2OA=="}], "type": "inlineReview"}, {"oid": "b584b212cf803ce8290b814376d1d80e2f27827b", "url": "https://github.com/netty/netty/commit/b584b212cf803ce8290b814376d1d80e2f27827b", "message": "Remove unused import", "committedDate": "2020-11-04T15:36:13Z", "type": "commit"}]}