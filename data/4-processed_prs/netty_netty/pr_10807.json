{"pr_number": 10807, "pr_title": "Let object serialisation exceptions propagate in the Object Echo example", "pr_createdAt": "2020-11-18T13:00:07Z", "pr_url": "https://github.com/netty/netty/pull/10807", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA3MDIwOQ==", "url": "https://github.com/netty/netty/pull/10807#discussion_r526070209", "bodyText": "@chrisvest this doesn't work as this will block the eventloop. Use a ChannelFutureListener", "author": "normanmaurer", "createdAt": "2020-11-18T13:05:17Z", "path": "example/src/main/java/io/netty/example/objectecho/ObjectEchoClientHandler.java", "diffHunk": "@@ -41,9 +42,10 @@ public ObjectEchoClientHandler() {\n     }\n \n     @Override\n-    public void channelActive(ChannelHandlerContext ctx) {\n+    public void channelActive(ChannelHandlerContext ctx) throws Exception {\n         // Send the first message if this handler is a client-side handler.\n-        ctx.writeAndFlush(firstMessage);\n+        ChannelFuture future = ctx.writeAndFlush(firstMessage);\n+        future.sync(); // Let object serialisation exceptions propagate.", "originalCommit": "a6407100f42e71f36911281f50bfd430d24416b5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d70f73fa5e6166529150f51e61e70c443086fb7d", "url": "https://github.com/netty/netty/commit/d70f73fa5e6166529150f51e61e70c443086fb7d", "message": "Let object serialisation exceptions propagate in the Object Echo example\n\nMotivation:\nPeople may use the object serialisation example as a vehicle to test out sending their own objects across the wire.\nIf those objects are not actually serialisable for some reason, then we need to let the exception propagate so that this becomes obvious to people.\n\nModification:\nAdd a listener to the future that sends the first serialisable message, so that we ensure that any exceptions that shows up during serialisation becomes visible.\nWithout this, the state of the future that sent the first message was never checked or inspected anywhere.\n\nResult:\nSerialisation bugs in code derived from the Object Echo example are much easier to diagnose.\n\nThis fixes #10777", "committedDate": "2020-11-18T13:15:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA4Nzg2Mg==", "url": "https://github.com/netty/netty/pull/10807#discussion_r526087862", "bodyText": "please revert this change ^^", "author": "normanmaurer", "createdAt": "2020-11-18T13:29:56Z", "path": "example/src/main/java/io/netty/example/objectecho/ObjectEchoClientHandler.java", "diffHunk": "@@ -41,9 +45,10 @@ public ObjectEchoClientHandler() {\n     }\n \n     @Override\n-    public void channelActive(ChannelHandlerContext ctx) {\n+    public void channelActive(ChannelHandlerContext ctx) throws Exception {", "originalCommit": "d70f73fa5e6166529150f51e61e70c443086fb7d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "08b496140139544aa945ddd74db9080a7445fd47", "url": "https://github.com/netty/netty/commit/08b496140139544aa945ddd74db9080a7445fd47", "message": "Let object serialisation exceptions propagate in the Object Echo example\n\nMotivation:\nPeople may use the object serialisation example as a vehicle to test out sending their own objects across the wire.\nIf those objects are not actually serialisable for some reason, then we need to let the exception propagate so that this becomes obvious to people.\n\nModification:\nAdd a listener to the future that sends the first serialisable message, so that we ensure that any exceptions that shows up during serialisation becomes visible.\nWithout this, the state of the future that sent the first message was never checked or inspected anywhere.\n\nResult:\nSerialisation bugs in code derived from the Object Echo example are much easier to diagnose.\n\nThis fixes #10777", "committedDate": "2020-11-18T16:33:45Z", "type": "commit"}, {"oid": "08b496140139544aa945ddd74db9080a7445fd47", "url": "https://github.com/netty/netty/commit/08b496140139544aa945ddd74db9080a7445fd47", "message": "Let object serialisation exceptions propagate in the Object Echo example\n\nMotivation:\nPeople may use the object serialisation example as a vehicle to test out sending their own objects across the wire.\nIf those objects are not actually serialisable for some reason, then we need to let the exception propagate so that this becomes obvious to people.\n\nModification:\nAdd a listener to the future that sends the first serialisable message, so that we ensure that any exceptions that shows up during serialisation becomes visible.\nWithout this, the state of the future that sent the first message was never checked or inspected anywhere.\n\nResult:\nSerialisation bugs in code derived from the Object Echo example are much easier to diagnose.\n\nThis fixes #10777", "committedDate": "2020-11-18T16:33:45Z", "type": "forcePushed"}]}