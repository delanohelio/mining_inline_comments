{"pr_number": 3649, "pr_title": "Add TransactionEvent for successful transactions", "pr_createdAt": "2020-09-05T05:12:52Z", "pr_url": "https://github.com/EssentialsX/Essentials/pull/3649", "timeline": [{"oid": "efd0e0d5bfd9d2577a136224ac18854f3f225105", "url": "https://github.com/EssentialsX/Essentials/commit/efd0e0d5bfd9d2577a136224ac18854f3f225105", "message": "Add TransactionEvent for successful transactions\nThis adds an event for plugins to hook into when a transaction occurs, allowing them to do whatever they want.\n\nImplements #3635", "committedDate": "2020-09-05T05:10:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTY3MDYyNA==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r485670624", "bodyText": "Should probably check the current thread here, in case transactions occur async.", "author": "mdcfe", "createdAt": "2020-09-09T14:46:10Z", "path": "Essentials/src/net/ess3/api/events/TransactionEvent.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package net.ess3.api.events;\n+\n+import com.earth2me.essentials.CommandSource;\n+import net.ess3.api.IUser;\n+import org.bukkit.event.Event;\n+import org.bukkit.event.HandlerList;\n+\n+import java.math.BigDecimal;\n+\n+public class TransactionEvent extends Event {\n+    private static final HandlerList handlers = new HandlerList();\n+\n+    private final CommandSource requester;\n+    private final IUser target;\n+    private final BigDecimal amount;\n+\n+    public TransactionEvent(CommandSource requester, IUser target, BigDecimal amount) {\n+        super();", "originalCommit": "efd0e0d5bfd9d2577a136224ac18854f3f225105", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTY5ODc1Mg==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r485698752", "bodyText": "Not sure what you mean, doesn't the event get raised after the transaction is over?", "author": "Chew", "createdAt": "2020-09-09T15:22:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTY3MDYyNA=="}], "type": "inlineReview"}, {"oid": "8623afced6d069c05863b956c717ed7693d34d61", "url": "https://github.com/EssentialsX/Essentials/commit/8623afced6d069c05863b956c717ed7693d34d61", "message": "Check if thread is primary thread", "committedDate": "2020-09-09T15:37:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2NTE5OQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r489165199", "bodyText": "Don't use * imports", "author": "pop4959", "createdAt": "2020-09-16T05:05:43Z", "path": "Essentials/src/com/earth2me/essentials/User.java", "diffHunk": "@@ -11,10 +11,7 @@\n import com.earth2me.essentials.utils.VersionUtil;\n import net.ess3.api.IEssentials;\n import net.ess3.api.MaxMoneyException;\n-import net.ess3.api.events.AfkStatusChangeEvent;\n-import net.ess3.api.events.JailStatusChangeEvent;\n-import net.ess3.api.events.MuteStatusChangeEvent;\n-import net.ess3.api.events.UserBalanceUpdateEvent;\n+import net.ess3.api.events.*;", "originalCommit": "8623afced6d069c05863b956c717ed7693d34d61", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MDA0Mw==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r489170043", "bodyText": "That's just what IntelliJ auto optimize did ;-;", "author": "Chew", "createdAt": "2020-09-16T05:23:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2NTE5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI0MzUyOA==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r489243528", "bodyText": "you can turn it off", "author": "pop4959", "createdAt": "2020-09-16T08:05:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2NTE5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MzI2MA==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r489173260", "bodyText": "It's \"receiver\"", "author": "l1ttleO", "createdAt": "2020-09-16T05:34:00Z", "path": "Essentials/src/com/earth2me/essentials/User.java", "diffHunk": "@@ -199,6 +196,8 @@ public void payUser(final User reciever, final BigDecimal value, UserBalanceUpda\n             reciever.setMoney(reciever.getMoney().add(value), cause);\n             sendMessage(tl(\"moneySentTo\", NumberUtil.displayCurrency(value, ess), reciever.getDisplayName()));\n             reciever.sendMessage(tl(\"moneyRecievedFrom\", NumberUtil.displayCurrency(value, ess), getDisplayName()));\n+            TransactionEvent transactionEvent = new TransactionEvent(this.getSource(), reciever, value);\n+            ess.getServer().getPluginManager().callEvent(transactionEvent);", "originalCommit": "8623afced6d069c05863b956c717ed7693d34d61", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU5MTIwNg==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r489591206", "bodyText": "No it's not", "author": "Chew", "createdAt": "2020-09-16T17:06:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MzI2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU5MTc4OQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r489591789", "bodyText": "To clarify: it's spelt that way in the code, not necessarily the proper spelling. I'm not here to fix typos.", "author": "Chew", "createdAt": "2020-09-16T17:07:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MzI2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU5MjMzOQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r489592339", "bodyText": "My inner perfectionist couldn't resist.", "author": "l1ttleO", "createdAt": "2020-09-16T17:08:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MzI2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTYzMTk0NA==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r489631944", "bodyText": "@l1ttleO Feel free to make a separate PR to fix the typos if you feel the need, but it's not in scope for this one.", "author": "pop4959", "createdAt": "2020-09-16T18:18:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MzI2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc4MDk3Mw==", "url": "https://github.com/EssentialsX/Essentials/pull/3649#discussion_r489780973", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import net.ess3.api.events.*;\n          \n          \n            \n            import net.ess3.api.events.AfkStatusChangeEvent;\n          \n          \n            \n            import net.ess3.api.events.JailStatusChangeEvent;\t\n          \n          \n            \n            import net.ess3.api.events.MuteStatusChangeEvent;\t\n          \n          \n            \n            import net.ess3.api.events.UserBalanceUpdateEvent;", "author": "pop4959", "createdAt": "2020-09-16T22:06:25Z", "path": "Essentials/src/com/earth2me/essentials/User.java", "diffHunk": "@@ -11,10 +11,7 @@\n import com.earth2me.essentials.utils.VersionUtil;\n import net.ess3.api.IEssentials;\n import net.ess3.api.MaxMoneyException;\n-import net.ess3.api.events.AfkStatusChangeEvent;\n-import net.ess3.api.events.JailStatusChangeEvent;\n-import net.ess3.api.events.MuteStatusChangeEvent;\n-import net.ess3.api.events.UserBalanceUpdateEvent;\n+import net.ess3.api.events.*;", "originalCommit": "8623afced6d069c05863b956c717ed7693d34d61", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6bb3f3acced48eb1b1bc10015028be94b0881ca3", "url": "https://github.com/EssentialsX/Essentials/commit/6bb3f3acced48eb1b1bc10015028be94b0881ca3", "message": "Remove wildcard import\nBeing harassed by wildcard imports? Just say no! IntellJ legally cannot use wildcard imports without your consent!", "committedDate": "2020-09-17T03:46:47Z", "type": "commit"}, {"oid": "448661cbde2ac8248a9de3cbeedbadb56fcba731", "url": "https://github.com/EssentialsX/Essentials/commit/448661cbde2ac8248a9de3cbeedbadb56fcba731", "message": "Merge remote-tracking branch 'original/2.x' into feature/transactionevent", "committedDate": "2020-11-25T22:48:38Z", "type": "commit"}, {"oid": "448661cbde2ac8248a9de3cbeedbadb56fcba731", "url": "https://github.com/EssentialsX/Essentials/commit/448661cbde2ac8248a9de3cbeedbadb56fcba731", "message": "Merge remote-tracking branch 'original/2.x' into feature/transactionevent", "committedDate": "2020-11-25T22:48:38Z", "type": "forcePushed"}, {"oid": "cc371f69b4f67d99b309de67e75769ba4f00f9c9", "url": "https://github.com/EssentialsX/Essentials/commit/cc371f69b4f67d99b309de67e75769ba4f00f9c9", "message": "Move TransactionEvent.java to proper folder", "committedDate": "2020-11-25T22:58:26Z", "type": "commit"}, {"oid": "78dc1a96b3af96ec0b0d1d0ccef409774aca4b57", "url": "https://github.com/EssentialsX/Essentials/commit/78dc1a96b3af96ec0b0d1d0ccef409774aca4b57", "message": "Fix some CheckStyle errors", "committedDate": "2020-11-25T23:12:20Z", "type": "commit"}, {"oid": "9b138510c950ffdc29dc57a2264d0484aaa4d841", "url": "https://github.com/EssentialsX/Essentials/commit/9b138510c950ffdc29dc57a2264d0484aaa4d841", "message": "Move TransactionEvent.java to proper folder... again", "committedDate": "2021-01-02T03:34:19Z", "type": "commit"}, {"oid": "24b0a98874d8b39fafb5a3d33208c344dcabae39", "url": "https://github.com/EssentialsX/Essentials/commit/24b0a98874d8b39fafb5a3d33208c344dcabae39", "message": "Merge remote-tracking branch 'original/2.x' into feature/transactionevent", "committedDate": "2021-01-02T03:39:51Z", "type": "commit"}, {"oid": "fb961505df5897dea4fce56e40643682074311a8", "url": "https://github.com/EssentialsX/Essentials/commit/fb961505df5897dea4fce56e40643682074311a8", "message": "Fix TransactionEvent import in User.java", "committedDate": "2021-01-02T03:42:01Z", "type": "commit"}]}