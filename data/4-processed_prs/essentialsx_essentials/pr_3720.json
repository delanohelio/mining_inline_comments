{"pr_number": 3720, "pr_title": "Refactor Project to Gradle", "pr_createdAt": "2020-10-09T21:01:35Z", "pr_url": "https://github.com/EssentialsX/Essentials/pull/3720", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3MTYwNQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502671605", "bodyText": "why not shadow? this isn't maven.", "author": "zml2008", "createdAt": "2020-10-09T21:07:24Z", "path": "shadow.gradle", "diffHunk": "@@ -0,0 +1,14 @@\n+apply plugin: \"com.github.johnrengelman.shadow\"\n+\n+configurations {\n+    shade", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY4MjMxNQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502682315", "bodyText": "shadow defines the configuration shadow and freaks out if you try to steal it from it", "author": "JRoy", "createdAt": "2020-10-09T21:38:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3MTYwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjcwNDc5NQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502704795", "bodyText": "it defines the configuration -- you should be able to just go ahead and reuse that shadow configuration when configuring the shadow tasks.", "author": "zml2008", "createdAt": "2020-10-09T22:57:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3MTYwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3Mjc0Ng==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502672746", "bodyText": "You can reduce duplication here by doing something like:\n[\n  \"\",\n  \"AntiBuild\",\n  \"Chat\",\n  /* ... */\n].each {\n  include(\":EssentialsX$it\")\n  project(\":EssentialsX$it\").projectDir = file(\"Essentials$it\")\n}", "author": "zml2008", "createdAt": "2020-10-09T21:10:32Z", "path": "settings.gradle", "diffHunk": "@@ -0,0 +1,36 @@\n+rootProject.name = 'EssentialsXParent'\n+\n+include(':EssentialsX')", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3Mjk2NQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502672965", "bodyText": "maybe skip the custom project directory, just do include(\":providers:BaseProviders\") and update the project deps to match?", "author": "zml2008", "createdAt": "2020-10-09T21:11:11Z", "path": "settings.gradle", "diffHunk": "@@ -0,0 +1,36 @@\n+rootProject.name = 'EssentialsXParent'\n+\n+include(':EssentialsX')\n+project(':EssentialsX').projectDir = file('Essentials')\n+\n+// Modules\n+include(':EssentialsXAntiBuild')\n+project(':EssentialsXAntiBuild').projectDir = file('EssentialsAntiBuild')\n+\n+include(':EssentialsXChat')\n+project(':EssentialsXChat').projectDir = file('EssentialsChat')\n+\n+include(':EssentialsXGeoIP')\n+project(':EssentialsXGeoIP').projectDir = file('EssentialsGeoIP')\n+\n+include(':EssentialsXProtect')\n+project(':EssentialsXProtect').projectDir = file('EssentialsProtect')\n+\n+include(':EssentialsXSpawn')\n+project(':EssentialsXSpawn').projectDir = file('EssentialsSpawn')\n+\n+include(':EssentialsXXMPP')\n+project(':EssentialsXXMPP').projectDir = file('EssentialsXMPP')\n+\n+// Providers\n+include(':BaseProviders')", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3MzUzOA==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502673538", "bodyText": "You should be able to just set the config directory here: https://github.com/KyoriPowered/indra/blob/master/indra-common/src/main/kotlin/net/kyori/indra/IndraCheckstylePlugin.kt#L42", "author": "zml2008", "createdAt": "2020-10-09T21:12:51Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NDIzOA==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502674238", "bodyText": "You should be able to do an afterEvaluate block, where you only add spigot-api as a dependency if no version of spigot or its forks has been added as a dep yet. That'd let you do this without hardcoding specific project names.", "author": "zml2008", "createdAt": "2020-10-09T21:14:51Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NDYxMw==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502674613", "bodyText": "You shouldn't be using this -- the plugins block at the top is preferred.\nIf you want a plugin that isn't applied to the root project but is available to subprojects, just add apply false after the version.", "author": "zml2008", "createdAt": "2020-10-09T21:15:50Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    buildscript {", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NDkwMg==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502674902", "bodyText": "Apply the release flag here: https://github.com/KyoriPowered/indra/blob/master/indra-common/src/main/kotlin/net/kyori/indra/IndraPlugin.kt#L57", "author": "zml2008", "createdAt": "2020-10-09T21:16:36Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    buildscript {\n+        repositories {\n+            maven {\n+                url \"https://plugins.gradle.org/m2/\"\n+            }\n+        }\n+        dependencies {\n+            classpath \"com.github.jengelman.gradle.plugins:shadow:6.1.0\"\n+        }\n+    }\n+\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": \"${version}.${GIT_DEPTH}\".toString()])\n+    }\n+\n+    sourceCompatibility = '1.8'\n+    compileJava.options.encoding = 'UTF-8'\n+\n+    tasks.withType(JavaCompile) {\n+        options.encoding = 'UTF-8'", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NjE1NQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502676155", "bodyText": "If you're trying to suppress something from Checkstyle, you should be suppressing individual checks, not everything. https://checkstyle.org/config_filters.html#SuppressWarningsFilter might be useful", "author": "zml2008", "createdAt": "2020-10-09T21:20:03Z", "path": "Essentials/src/main/java/com/earth2me/essentials/utils/StringUtil.java", "diffHunk": "@@ -8,6 +8,7 @@\n public final class StringUtil {\n     private static final Pattern INVALIDFILECHARS = Pattern.compile(\"[^a-z0-9-]\");\n     private static final Pattern STRICTINVALIDCHARS = Pattern.compile(\"[^a-z0-9]\");\n+    @SuppressWarnings(\"CheckStyle\")", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjczNTU1Mw==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502735553", "bodyText": "I don't want to fully suppress it, it's just this one place", "author": "JRoy", "createdAt": "2020-10-10T02:36:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NjE1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3Njk0MA==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502676940", "bodyText": "Jitpack should probably be specifically restricted to artifacts that supposed come from there -- at the moment is that just Vault?\nhttps://docs.gradle.org/current/userguide/declaring_repositories.html#sec:repository-content-filtering", "author": "zml2008", "createdAt": "2020-10-09T21:22:10Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NzM4Mg==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502677382", "bodyText": "Why are you applying the java and shadow plugins to the root project? There isn't any Java source here.", "author": "zml2008", "createdAt": "2020-10-09T21:23:29Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3ODM0MQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502678341", "bodyText": "you should be able to just do from(it) here -- then you don't have to explicitly declare this task's dependency on the output tasks.", "author": "zml2008", "createdAt": "2020-10-09T21:26:15Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    buildscript {\n+        repositories {\n+            maven {\n+                url \"https://plugins.gradle.org/m2/\"\n+            }\n+        }\n+        dependencies {\n+            classpath \"com.github.jengelman.gradle.plugins:shadow:6.1.0\"\n+        }\n+    }\n+\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": \"${version}.${GIT_DEPTH}\".toString()])\n+    }\n+\n+    sourceCompatibility = '1.8'\n+    compileJava.options.encoding = 'UTF-8'\n+\n+    tasks.withType(JavaCompile) {\n+        options.encoding = 'UTF-8'\n+    }\n+    tasks.withType(Jar) {\n+        archiveVersion.set(\"${this.version}.${GIT_DEPTH}\".toString())\n+    }\n+}\n+\n+def outputTasks() {\n+    [\":EssentialsX:shadowJar\", \":EssentialsXAntiBuild:jar\", \":EssentialsXChat:jar\",\n+     \":EssentialsXGeoIP:shadowJar\", \":EssentialsXProtect:jar\", \":EssentialsXSpawn:shadowJar\",\n+     \":EssentialsXXMPP:shadowJar\"].stream().map({ tasks.findByPath(it) })\n+}\n+\n+task copyToJars(type: Copy) {\n+    outputTasks().forEach {\n+        println it\n+        from(it.outputs.files)", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY4ODMwNA==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502688304", "bodyText": "yep! also spot the missed debug println \ud83d\ude04", "author": "JRoy", "createdAt": "2020-10-09T22:04:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3ODM0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3ODQyOQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502678429", "bodyText": "I assume the stuff from here on is left over from an earlier attempt?", "author": "zml2008", "createdAt": "2020-10-09T21:26:31Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    buildscript {\n+        repositories {\n+            maven {\n+                url \"https://plugins.gradle.org/m2/\"\n+            }\n+        }\n+        dependencies {\n+            classpath \"com.github.jengelman.gradle.plugins:shadow:6.1.0\"\n+        }\n+    }\n+\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": \"${version}.${GIT_DEPTH}\".toString()])\n+    }\n+\n+    sourceCompatibility = '1.8'\n+    compileJava.options.encoding = 'UTF-8'\n+\n+    tasks.withType(JavaCompile) {\n+        options.encoding = 'UTF-8'\n+    }\n+    tasks.withType(Jar) {\n+        archiveVersion.set(\"${this.version}.${GIT_DEPTH}\".toString())\n+    }\n+}\n+\n+def outputTasks() {\n+    [\":EssentialsX:shadowJar\", \":EssentialsXAntiBuild:jar\", \":EssentialsXChat:jar\",\n+     \":EssentialsXGeoIP:shadowJar\", \":EssentialsXProtect:jar\", \":EssentialsXSpawn:shadowJar\",\n+     \":EssentialsXXMPP:shadowJar\"].stream().map({ tasks.findByPath(it) })\n+}\n+\n+task copyToJars(type: Copy) {\n+    outputTasks().forEach {\n+        println it\n+        from(it.outputs.files)\n+    }\n+\n+    rename '(.*)-all.jar', '$1.jar'\n+\n+    into file('jars')\n+}\n+\n+task cleanJars() {\n+    delete file('jars')\n+}\n+\n+build.dependsOn copyToJars\n+clean.dependsOn cleanJars\n+copyToJars.dependsOn tasks.findByPath(\":EssentialsX:processResources\")\n+tasks.build.dependsOn tasks.shadowJar\n+\n+outputTasks().forEach { copyToJars.dependsOn it }\n+\n+compileJava.options.encoding = 'UTF-8'", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY4NzczNw==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502687737", "bodyText": "yeah :P", "author": "JRoy", "createdAt": "2020-10-09T22:02:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3ODQyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3ODU5OQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502678599", "bodyText": "is this supposed to be here?", "author": "zml2008", "createdAt": "2020-10-09T21:26:58Z", "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -0,0 +1,6 @@\n+distributionBase=GRADLE_USER_HOME\n+distributionPath=wrapper/dists\n+distributionUrl=https\\://services.gradle.org/distributions/gradle-6.6.1-bin.zip\n+zipStoreBase=GRADLE_USER_HOME\n+zipStorePath=wrapper/dists\n+org.gral", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY4NjYyMg==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502686622", "bodyText": "oops", "author": "JRoy", "createdAt": "2020-10-09T21:56:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3ODU5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3OTI0Nw==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502679247", "bodyText": "out/ shows up from some IDE setups, probably shouldn't remove it", "author": "zml2008", "createdAt": "2020-10-09T21:28:45Z", "path": ".gitignore", "diffHunk": "@@ -17,6 +17,6 @@\n /Essentials/usermap.csv\n \n # Build files\n-target/\n+.gradle/\n jars/\n-out/", "originalCommit": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "609ce3cf09b21602d44bfa9041f23a32e6a212d1", "url": "https://github.com/EssentialsX/Essentials/commit/609ce3cf09b21602d44bfa9041f23a32e6a212d1", "message": "Merge branch '2.x' into refactor/gradle", "committedDate": "2020-10-19T21:12:40Z", "type": "forcePushed"}, {"oid": "a6edf04a6089ab98756dacfb859ad8d418bdc940", "url": "https://github.com/EssentialsX/Essentials/commit/a6edf04a6089ab98756dacfb859ad8d418bdc940", "message": "Release 2.18.2", "committedDate": "2020-11-16T11:32:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNDc1Ng==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528324756", "bodyText": "group: bukkit?", "author": "mdcfe", "createdAt": "2020-11-22T11:57:05Z", "path": "Essentials/build.gradle", "diffHunk": "@@ -0,0 +1,25 @@\n+dependencies {\n+    compileOnly 'com.github.milkbowl:VaultAPI:1.7'\n+    compileOnly 'net.luckperms:api:5.0'\n+\n+    api 'io.papermc:paperlib:1.0.6-SNAPSHOT'\n+\n+    // Providers\n+    api project(':providers:BaseProviders')\n+    api project(':providers:PaperProvider')\n+    api project(':providers:NMSReflectionProvider')\n+    api(project(':providers:1_8Provider')) {\n+        exclude group: 'bukkit'", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTM3OA==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325378", "bodyText": "Shouldn't this be compileOnly?", "author": "mdcfe", "createdAt": "2020-11-22T12:02:38Z", "path": "EssentialsSpawn/build.gradle", "diffHunk": "@@ -0,0 +1,10 @@\n+dependencies {\n+    implementation project(':EssentialsX')", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTQxNw==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325417", "bodyText": "We could consider using EssentialsX's shaded PaperLib instead of shading our own", "author": "mdcfe", "createdAt": "2020-11-22T12:03:19Z", "path": "EssentialsSpawn/build.gradle", "diffHunk": "@@ -0,0 +1,10 @@\n+dependencies {\n+    implementation project(':EssentialsX')\n+}\n+\n+shadowJar {\n+    dependencies {\n+        include (dependency('io.papermc:paperlib'))\n+    }\n+    relocate 'io.papermc.lib', 'com.earth2me.essentials.spawn.paperlib'", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTY4Nw==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325687", "bodyText": "Is this necessary?", "author": "mdcfe", "createdAt": "2020-11-22T12:05:21Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import net.kyori.indra.data.License\n+\n+allprojects {\n+    group = 'net.essentialsx'\n+    version = '2.19.0-SNAPSHOT'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    fullVersion = \"${version}+${GIT_DEPTH}.${GIT_COMMIT}\".replace(\"-SNAPSHOT\", \"\")\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.4-R0.1-SNAPSHOT'\n+    junit5Version = '5.7.0'\n+    mockitoVersion = '3.2.0'\n+}\n+\n+subprojects {\n+    apply plugin: 'net.kyori.indra'\n+    apply plugin: 'net.kyori.indra.checkstyle'\n+    apply plugin: 'net.kyori.indra.publishing'\n+    apply plugin: 'com.github.johnrengelman.shadow'\n+\n+    repositories {\n+        mavenLocal()", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTc4Mg==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325782", "bodyText": "Todo: make root not depend on java plugin, if possible", "author": "mdcfe", "createdAt": "2020-11-22T12:06:03Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTg3NQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325875", "bodyText": "Also do we still need this?", "author": "mdcfe", "createdAt": "2020-11-22T12:06:45Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import net.kyori.indra.data.License\n+\n+allprojects {\n+    group = 'net.essentialsx'\n+    version = '2.19.0-SNAPSHOT'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    fullVersion = \"${version}+${GIT_DEPTH}.${GIT_COMMIT}\".replace(\"-SNAPSHOT\", \"\")\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.4-R0.1-SNAPSHOT'\n+    junit5Version = '5.7.0'\n+    mockitoVersion = '3.2.0'\n+}\n+\n+subprojects {\n+    apply plugin: 'net.kyori.indra'\n+    apply plugin: 'net.kyori.indra.checkstyle'\n+    apply plugin: 'net.kyori.indra.publishing'\n+    apply plugin: 'com.github.johnrengelman.shadow'\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNjA3Nw==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528326077", "bodyText": "KyoriPowered/indra#20", "author": "mdcfe", "createdAt": "2020-11-22T12:08:37Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import net.kyori.indra.data.License\n+\n+allprojects {\n+    group = 'net.essentialsx'\n+    version = '2.19.0-SNAPSHOT'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    fullVersion = \"${version}+${GIT_DEPTH}.${GIT_COMMIT}\".replace(\"-SNAPSHOT\", \"\")\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.4-R0.1-SNAPSHOT'\n+    junit5Version = '5.7.0'\n+    mockitoVersion = '3.2.0'\n+}\n+\n+subprojects {\n+    apply plugin: 'net.kyori.indra'\n+    apply plugin: 'net.kyori.indra.checkstyle'\n+    apply plugin: 'net.kyori.indra.publishing'\n+    apply plugin: 'com.github.johnrengelman.shadow'\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven {\n+            url = 'https://jitpack.io'\n+            content {\n+                includeGroup \"com.github.milkbowl\"\n+            }\n+        }\n+    }\n+\n+    dependencies {\n+        testImplementation \"org.junit.jupiter:junit-jupiter:${junit5Version}\"\n+        testRuntimeOnly \"org.junit.vintage:junit-vintage-engine:${junit5Version}\"\n+        testImplementation \"org.mockito:mockito-core:${mockitoVersion}\"\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    // Version Injection\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": fullVersion])\n+    }\n+\n+    indra {\n+        checkstyle = \"$checkstyleVersion\"\n+\n+        github('EssentialsX', 'Essentials')\n+        license = new License(\n+                'GPL-3.0-only',\n+                'GNU General Public License version 3',\n+                'https://opensource.org/licenses/GPL-3.0'\n+        )\n+\n+        publishReleasesTo('essx', 'https://repo.essentialsx.net/releases/')\n+        publishSnapshotsTo('essx', 'https://repo.essentialsx.net/snapshots/')\n+\n+        configurePublications {\n+            pom {\n+                description = 'The essential plugin suite for Minecraft servers.'\n+                url = 'https://essentialsx.net'\n+                developers {\n+                    developer {\n+                        id = 'mdcfe'\n+                        name = 'MD'\n+                        email = 'md@n3fs.co.uk'\n+                    }\n+                    developer {\n+                        id = 'pop4959'\n+                    }\n+                    developer {\n+                        id = 'JRoy'\n+                        name = 'Josh Roy'\n+                    }\n+                }\n+                ciManagement {\n+                    system = 'Jenkins'\n+                    url = 'https://ci.ender.zone/job/EssentialsX'\n+                }\n+            }\n+        }\n+    }\n+\n+    tasks.withType(Sign) {", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNjEyMA==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528326120", "bodyText": "KyoriPowered/indra#19", "author": "mdcfe", "createdAt": "2020-11-22T12:09:01Z", "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import net.kyori.indra.data.License\n+\n+allprojects {\n+    group = 'net.essentialsx'\n+    version = '2.19.0-SNAPSHOT'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    fullVersion = \"${version}+${GIT_DEPTH}.${GIT_COMMIT}\".replace(\"-SNAPSHOT\", \"\")\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.4-R0.1-SNAPSHOT'\n+    junit5Version = '5.7.0'\n+    mockitoVersion = '3.2.0'\n+}\n+\n+subprojects {\n+    apply plugin: 'net.kyori.indra'\n+    apply plugin: 'net.kyori.indra.checkstyle'\n+    apply plugin: 'net.kyori.indra.publishing'\n+    apply plugin: 'com.github.johnrengelman.shadow'\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven {\n+            url = 'https://jitpack.io'\n+            content {\n+                includeGroup \"com.github.milkbowl\"\n+            }\n+        }\n+    }\n+\n+    dependencies {\n+        testImplementation \"org.junit.jupiter:junit-jupiter:${junit5Version}\"\n+        testRuntimeOnly \"org.junit.vintage:junit-vintage-engine:${junit5Version}\"\n+        testImplementation \"org.mockito:mockito-core:${mockitoVersion}\"\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    // Version Injection\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": fullVersion])\n+    }\n+\n+    indra {\n+        checkstyle = \"$checkstyleVersion\"\n+\n+        github('EssentialsX', 'Essentials')\n+        license = new License(", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNjMyMA==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528326320", "bodyText": "Again group: bukkit?", "author": "mdcfe", "createdAt": "2020-11-22T12:10:24Z", "path": "providers/1_8Provider/build.gradle", "diffHunk": "@@ -0,0 +1,5 @@\n+dependencies {\n+    api(project(':providers:NMSReflectionProvider')) {\n+        exclude group: 'bukkit'", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNjM2OQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528326369", "bodyText": "1.16.4?", "author": "mdcfe", "createdAt": "2020-11-22T12:10:51Z", "path": "providers/PaperProvider/build.gradle", "diffHunk": "@@ -0,0 +1,4 @@\n+dependencies {\n+    implementation project(':providers:BaseProviders')\n+    compileOnly 'com.destroystokyo.paper:paper-api:1.16.3-R0.1-SNAPSHOT'", "originalCommit": "c41a4e7bf2ccb58c50d27632ee24b409038992fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODM2MDQxNQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528360415", "bodyText": "Doesn't need to be updated until we need a new method for paper provider", "author": "JRoy", "createdAt": "2020-11-22T16:39:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNjM2OQ=="}], "type": "inlineReview"}, {"oid": "8cde9d51c5391d9e9a5409815efbc0ff106cc3ee", "url": "https://github.com/EssentialsX/Essentials/commit/8cde9d51c5391d9e9a5409815efbc0ff106cc3ee", "message": "Only apply java plugin to subprojects", "committedDate": "2020-11-24T22:17:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDQ2OTkxOA==", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r530469918", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  if: ${{ success() && github.event_name == 'push' && github.ref == 'refs/head/2.x' }}\n          \n          \n            \n                  if: ${{ success() && github.event_name == 'push' && github.repository == 'EssentialsX/Essentials' && github.ref == 'refs/head/2.x' }}", "author": "mdcfe", "createdAt": "2020-11-25T15:45:18Z", "path": ".github/workflows/build.yml", "diffHunk": "@@ -2,37 +2,47 @@ name: Build EssentialsX\n \n on:\n   push:\n-    branches: \n+    branches:\n     - 2.x\n     - mc/*\n   pull_request:\n-    branches: \n+    branches:\n     - 2.x\n \n jobs:\n   build:\n-\n+    name: Build and upload\n     runs-on: ubuntu-latest\n \n     steps:\n     - name: Checkout Git repo\n-      uses: actions/checkout@v1\n-    - name: Restore Maven cache\n-      uses: actions/cache@v1\n+      uses: actions/checkout@v2\n+      with:\n+        fetch-depth: 0\n+    - name: Restore Gradle cache\n+      uses: actions/cache@v2\n       with:\n-        path: ~/.m2/repository\n-        key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}\n+        path: ~/.gradle/caches\n+        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}\n         restore-keys: |\n-          ${{ runner.os }}-maven-\n+          ${{ runner.os }}-gradle-\n     - name: Set up JDK 1.8\n       uses: actions/setup-java@v1\n       with:\n         java-version: 1.8\n-    - name: Build with Maven\n-      run: mvn package verify --file pom.xml\n-    - name: Copy artifacts\n-      run: mkdir -p ./out/ && cp -t ./out/ **/target/Essentials*.jar\n-    - uses: actions/upload-artifact@master\n+    - name: Build with Gradle\n+      run: |\n+        chmod +x gradlew\n+        ./gradlew build --stacktrace\n+    - name: Deploy with Gradle\n+      if: ${{ success() && github.event_name == 'push' && github.ref == 'refs/head/2.x' }}", "originalCommit": "8cde9d51c5391d9e9a5409815efbc0ff106cc3ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5cd6a2175c2a73bd3eb65837510a42dd62d37dba", "url": "https://github.com/EssentialsX/Essentials/commit/5cd6a2175c2a73bd3eb65837510a42dd62d37dba", "message": "Convert project to Gradle", "committedDate": "2020-11-25T16:17:27Z", "type": "commit"}, {"oid": "5cd6a2175c2a73bd3eb65837510a42dd62d37dba", "url": "https://github.com/EssentialsX/Essentials/commit/5cd6a2175c2a73bd3eb65837510a42dd62d37dba", "message": "Convert project to Gradle", "committedDate": "2020-11-25T16:17:27Z", "type": "forcePushed"}]}