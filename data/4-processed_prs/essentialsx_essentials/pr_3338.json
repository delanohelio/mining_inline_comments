{"pr_number": 3338, "pr_title": "Confirm home replacement when overwriting existing homes", "pr_createdAt": "2020-05-27T09:47:08Z", "pr_url": "https://github.com/EssentialsX/Essentials/pull/3338", "timeline": [{"oid": "e56b7b8252f70d981be8d37d8e96469f81df2aa8", "url": "https://github.com/EssentialsX/Essentials/commit/e56b7b8252f70d981be8d37d8e96469f81df2aa8", "message": "Confirm home overwriting", "committedDate": "2020-05-27T09:43:58Z", "type": "commit"}, {"oid": "6f30d4a5ab8c95c8d79db79ac95e4068dadcafd2", "url": "https://github.com/EssentialsX/Essentials/commit/6f30d4a5ab8c95c8d79db79ac95e4068dadcafd2", "message": "Merge branch '2.x' into home-overwrite", "committedDate": "2020-05-27T09:53:00Z", "type": "commit"}, {"oid": "e5f80e5cb393cf30bd5b53e331987dec82d52126", "url": "https://github.com/EssentialsX/Essentials/commit/e5f80e5cb393cf30bd5b53e331987dec82d52126", "message": "Confirmation timeout", "committedDate": "2020-06-16T00:15:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjkzODYxOQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3338#discussion_r442938619", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    user.sendMessage(tl(\"homeSet\", user.getLocation().getWorld().getName(), user.getLocation().getBlockX(), user.getLocation().getBlockY(), user.getLocation().getBlockZ(), name));\n          \n          \n            \n                    user.sendMessage(tl(\"homeSet\", user.getLocation().getWorld().getName(), user.getLocation().getBlockX(), user.getLocation().getBlockY(), user.getLocation().getBlockZ(), name));\n          \n          \n            \n                    usersHome.setLastHomeConfirmation(null);", "author": "JRoy", "createdAt": "2020-06-19T16:31:28Z", "path": "Essentials/src/com/earth2me/essentials/commands/Commandsethome.java", "diffHunk": "@@ -55,6 +56,13 @@ public void run(final Server server, final User user, final String commandLabel,\n             throw new Exception(tl(\"unsafeTeleportDestination\", location.getWorld().getName(), location.getBlockX(), location.getBlockY(), location.getBlockZ()));\n         }\n \n+        if (ess.getSettings().isConfirmHomeOverwrite() && usersHome.hasHome(name) && (!name.equals(usersHome.getLastHomeConfirmation()) || name.equals(usersHome.getLastHomeConfirmation()) && System.currentTimeMillis() - usersHome.getLastHomeConfirmationTimestamp() > TimeUnit.MINUTES.toMillis(2))) {\n+            usersHome.setLastHomeConfirmation(name);\n+            usersHome.setLastHomeConfirmationTimestamp();\n+            user.sendMessage(tl(\"homeConfirmation\", name));\n+            return;\n+        }\n+\n         usersHome.setHome(name, location);\n         user.sendMessage(tl(\"homeSet\", user.getLocation().getWorld().getName(), user.getLocation().getBlockX(), user.getLocation().getBlockY(), user.getLocation().getBlockZ(), name));", "originalCommit": "e5f80e5cb393cf30bd5b53e331987dec82d52126", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0MDQ3OQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3338#discussion_r442940479", "bodyText": "Remain consistent style with other confirm messages\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            homeConfirmation=\\u00a76You already have a home named \\u00a7c{0}\\u00a76!\\nType the command again to confirm replacement.\n          \n          \n            \n            homeConfirmation=\\u00a77To \\u00a7lCONFIRM\\u00a77 overwriting your existing home, \\u00a7c{0}\\u00a77, please repeat the command.", "author": "JRoy", "createdAt": "2020-06-19T16:35:43Z", "path": "Essentials/src/messages.properties", "diffHunk": "@@ -182,6 +182,7 @@ holdFirework=\\u00a74You must be holding a firework to add effects.\n holdPotion=\\u00a74You must be holding a potion to apply effects to it.\n holeInFloor=\\u00a74Hole in floor\\!\n homes=\\u00a76Homes\\:\\u00a7r {0}\n+homeConfirmation=\\u00a76You already have a home named \\u00a7c{0}\\u00a76!\\nType the command again to confirm replacement.", "originalCommit": "e5f80e5cb393cf30bd5b53e331987dec82d52126", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzAwMDMxNA==", "url": "https://github.com/EssentialsX/Essentials/pull/3338#discussion_r443000314", "bodyText": "If anything, the style and format of that message varies wildly from the rest of Essentials. I'm not saying the message in this PR is perfect, but I think that one is also a bit far off the mark.", "author": "pop4959", "createdAt": "2020-06-19T19:00:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0MDQ3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYxNDI3Ng==", "url": "https://github.com/EssentialsX/Essentials/pull/3338#discussion_r448614276", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            homeConfirmation=\\u00a76You already have a home named \\u00a7c{0}\\u00a76!\\nType the command again to confirm replacement.\n          \n          \n            \n            homeConfirmation=\\u00a76You already have a home named \\u00a7c{0}\\u00a76!\\nTo overwrite your existing home, type the command again.", "author": "mdcfe", "createdAt": "2020-07-01T21:01:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0MDQ3OQ=="}], "type": "inlineReview"}, {"oid": "69840c5adba13afcef72a9261c73ec7d685a6526", "url": "https://github.com/EssentialsX/Essentials/commit/69840c5adba13afcef72a9261c73ec7d685a6526", "message": "Update Essentials/src/com/earth2me/essentials/commands/Commandsethome.java\n\nCo-authored-by: Josh Roy <10731363+JRoy@users.noreply.github.com>", "committedDate": "2020-06-19T19:00:06Z", "type": "commit"}, {"oid": "ad1f3d5872fa527f0763d52a85e6a713d4fb1e32", "url": "https://github.com/EssentialsX/Essentials/commit/ad1f3d5872fa527f0763d52a85e6a713d4fb1e32", "message": "Update Essentials/src/messages.properties", "committedDate": "2020-07-01T21:02:00Z", "type": "commit"}]}