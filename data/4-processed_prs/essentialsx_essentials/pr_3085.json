{"pr_number": 3085, "pr_title": "Add UUID and User based economy methods", "pr_createdAt": "2020-03-22T21:21:39Z", "pr_url": "https://github.com/EssentialsX/Essentials/pull/3085", "timeline": [{"oid": "0d8c09e815e01691e73c6d9738e1cd40b51349b2", "url": "https://github.com/EssentialsX/Essentials/commit/0d8c09e815e01691e73c6d9738e1cd40b51349b2", "message": "Add UUID/User friendly methods", "committedDate": "2020-03-22T21:17:21Z", "type": "commit"}, {"oid": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da", "url": "https://github.com/EssentialsX/Essentials/commit/35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da", "message": "Fixup some warnings", "committedDate": "2020-03-22T21:20:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4MjU2MQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400682561", "bodyText": "Don't use RuntimeException for this. IllegalArgumentException is a far better choice.", "author": "Ichbinjoe", "createdAt": "2020-03-31T06:57:05Z", "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -86,9 +88,20 @@ private static User getUserByName(String name) {\n         return user;\n     }\n \n+    private static User getUserByUUID(UUID uuid) {\n+        if (ess == null) {\n+            throw new RuntimeException(noCallBeforeLoad);\n+        }\n+        if (uuid == null) {\n+            throw new RuntimeException(\"Economy uuid cannot be null\");", "originalCommit": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4NzE3Nw==", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400687177", "bodyText": "IllegalArgumentException", "author": "Ichbinjoe", "createdAt": "2020-03-31T07:07:44Z", "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -133,11 +160,50 @@ public static void setMoney(String name, double balance) throws UserDoesNotExist\n         }\n     }\n \n+    /**\n+     * Sets the balance of a user\n+     *\n+     * @deprecated Usernames can change use {@link Economy#setMoney(UUID, BigDecimal)} or {@link Economy#setMoney(User, BigDecimal)}\n+     *\n+     * @param name    Name of user\n+     * @param balance The balance you want to set\n+     *\n+     * @throws UserDoesNotExistException If a user by that name does not exist\n+     * @throws NoLoanPermittedException  If the user is not allowed to have a negative balance\n+     */\n+    @Deprecated\n     public static void setMoney(String name, BigDecimal balance) throws UserDoesNotExistException, NoLoanPermittedException {\n         User user = getUserByName(name);\n         if (user == null) {\n             throw new UserDoesNotExistException(name);\n         }\n+        setMoney(user, balance);\n+    }\n+\n+    /**\n+     * Sets the balance of a user\n+     *\n+     * @param uuid    UUID of user\n+     * @param balance The balance you want to set\n+     *\n+     * @throws NoLoanPermittedException If the user is not allowed to have a negative balance\n+     */\n+    public static void setMoney(UUID uuid, BigDecimal balance) throws NoLoanPermittedException {\n+        setMoney(getUserByUUID(uuid), balance);\n+    }\n+\n+    /**\n+     * Sets the balance of a user\n+     *\n+     * @param user    User\n+     * @param balance The balance you want to set\n+     *\n+     * @throws NoLoanPermittedException If the user is not allowed to have a negative balance\n+     */\n+    public static void setMoney(User user, BigDecimal balance) throws NoLoanPermittedException {\n+        if (user == null) {\n+            throw new RuntimeException(\"Economy user cannot be null\");", "originalCommit": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4NzU4OA==", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400687588", "bodyText": "user is not allowed", "author": "Ichbinjoe", "createdAt": "2020-03-31T07:08:35Z", "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -170,17 +238,64 @@ public static void add(String name, double amount) throws UserDoesNotExistExcept\n         }\n     }\n \n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @deprecated Usernames can change, use {@link Economy#add(UUID, BigDecimal)} or {@link Economy#add(User, BigDecimal)}\n+     *\n+     * @param name   Name of the user\n+     * @param amount The money you want to add\n+     *\n+     * @throws UserDoesNotExistException If a user by that name does not exist\n+     * @throws NoLoanPermittedException  If the user is now allowed to have a negative balance\n+     * @throws ArithmeticException\n+     */\n+    @Deprecated\n     public static void add(String name, BigDecimal amount) throws UserDoesNotExistException, NoLoanPermittedException, ArithmeticException {\n-        BigDecimal result = getMoneyExact(name).add(amount, MATH_CONTEXT);\n-        setMoney(name, result);\n-        Trade.log(\"API\", \"Add\", \"API\", name, new Trade(amount, ess), null, null, null, ess);\n+        User user = getUserByName(name);\n+        if (user == null) {\n+            throw new UserDoesNotExistException(name);\n+        }\n+        add(user, amount);\n+    }\n+\n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @param uuid   UUID of the user\n+     * @param amount The money you want to add\n+     *\n+     * @throws NoLoanPermittedException  If the user is now allowed to have a negative balance\n+     * @throws ArithmeticException\n+     */\n+    public static void add(UUID uuid, BigDecimal amount) throws NoLoanPermittedException, ArithmeticException {\n+        add(getUserByUUID(uuid), amount);\n+    }\n+\n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @deprecated Usernames can change, use {@link Economy#add(UUID, BigDecimal)} or {@link Economy#add(User, BigDecimal)}\n+     *\n+     * @param user   User\n+     * @param amount The money you want to add\n+     *\n+     * @throws NoLoanPermittedException  If the user is now allowed to have a negative balance", "originalCommit": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4NzY3NA==", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400687674", "bodyText": "not", "author": "Ichbinjoe", "createdAt": "2020-03-31T07:08:44Z", "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -170,17 +238,64 @@ public static void add(String name, double amount) throws UserDoesNotExistExcept\n         }\n     }\n \n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @deprecated Usernames can change, use {@link Economy#add(UUID, BigDecimal)} or {@link Economy#add(User, BigDecimal)}\n+     *\n+     * @param name   Name of the user\n+     * @param amount The money you want to add\n+     *\n+     * @throws UserDoesNotExistException If a user by that name does not exist\n+     * @throws NoLoanPermittedException  If the user is now allowed to have a negative balance", "originalCommit": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ2OTAxMw==", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r407469013", "bodyText": "@JRoy Is this fixed?", "author": "mdcfe", "createdAt": "2020-04-13T13:07:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4NzY3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ5NjQ3Nw==", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r407496477", "bodyText": "@md678685 it is now :P", "author": "JRoy", "createdAt": "2020-04-13T14:08:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4NzY3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4Nzk5OQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400687999", "bodyText": "Consider rewording all around to something more like 'The amount of money to be added to the user's account'", "author": "Ichbinjoe", "createdAt": "2020-03-31T07:09:25Z", "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -170,17 +238,64 @@ public static void add(String name, double amount) throws UserDoesNotExistExcept\n         }\n     }\n \n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @deprecated Usernames can change, use {@link Economy#add(UUID, BigDecimal)} or {@link Economy#add(User, BigDecimal)}\n+     *\n+     * @param name   Name of the user\n+     * @param amount The money you want to add", "originalCommit": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "85a32e1257efda1090eb357da4eba8ae8e2afa38", "url": "https://github.com/EssentialsX/Essentials/commit/85a32e1257efda1090eb357da4eba8ae8e2afa38", "message": "Review changes", "committedDate": "2020-03-31T15:35:02Z", "type": "commit"}, {"oid": "460d2aa0783fd5a5f906f55a1862a17f466625c6", "url": "https://github.com/EssentialsX/Essentials/commit/460d2aa0783fd5a5f906f55a1862a17f466625c6", "message": "Fix typos", "committedDate": "2020-04-13T14:07:53Z", "type": "commit"}, {"oid": "f822baccc6449b21d316e5e787105d2f5c603661", "url": "https://github.com/EssentialsX/Essentials/commit/f822baccc6449b21d316e5e787105d2f5c603661", "message": "Throw UserDoesNotExistException in UUID-based methods", "committedDate": "2020-05-02T18:35:48Z", "type": "commit"}]}