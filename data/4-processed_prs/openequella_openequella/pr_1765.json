{"pr_number": 1765, "pr_title": "Added basic datemodified component, and storybook test", "pr_createdAt": "2020-05-27T05:16:04Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/1765", "timeline": [{"oid": "46950f9c9031cf904b53cf69a5c11f5545d2cdd2", "url": "https://github.com/openequella/openEQUELLA/commit/46950f9c9031cf904b53cf69a5c11f5545d2cdd2", "message": "added basic datemodified component, and storybook test", "committedDate": "2020-05-27T04:53:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTUyNw==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430869527", "bodyText": "Please pin the version. Otherwise it'll trigger renovate bot to pin it anyway. Curious though, as I thought we already used this somewhere. \ud83e\udd14", "author": "edalex-ian", "createdAt": "2020-05-27T05:44:18Z", "path": "Source/Plugins/Core/com.equella.core/js/package.json", "diffHunk": "@@ -43,7 +44,7 @@\n     \"lodash\": \"4.17.15\",\n     \"luxon\": \"1.16.0\",\n     \"material-ui-pickers\": \"2.2.4\",\n-    \"@openequella/rest-api-client\": \"file:../../../../../oeq-ts-rest-api\",\n+    \"moment\": \"^2.26.0\",", "originalCommit": "46950f9c9031cf904b53cf69a5c11f5545d2cdd2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg5NzQxOA==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430897418", "bodyText": "Isn't luxon currently used for this purpose?", "author": "SammyIsConfused", "createdAt": "2020-05-27T07:00:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTUyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3MDMwMQ==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430870301", "bodyText": "This could be used for any date - not just modified. I think we need a new name for it (and its props). Just <Date> seems to simple, but maybe it could work. \ud83e\udd14", "author": "edalex-ian", "createdAt": "2020-05-27T05:46:51Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/DateModifiedDisplay.tsx", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Typography, Tooltip } from \"@material-ui/core\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import * as moment from \"moment\";\n+\n+const useStyles = makeStyles({\n+  dateModified: {\n+    display: \"inline-block\",\n+  },\n+});\n+export interface DateModifiedDisplayProps {\n+  displayRelative: boolean;\n+  date: Date;\n+}\n+export default function DateModifiedDisplay({", "originalCommit": "46950f9c9031cf904b53cf69a5c11f5545d2cdd2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3OTkxNQ==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430879915", "bodyText": "oh yeah, that would probably be better", "author": "mrblippy", "createdAt": "2020-05-27T06:16:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3MDMwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3Njc3NQ==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430876775", "bodyText": "I'm struggling to see if we need to bring in >50KB library just to do this - when you could write it in ~100 lines. Maybe it's okay, but.... primary date we could just go with date.toLocaleString(), it's only timeago support we'd need. I wonder what others think?", "author": "edalex-ian", "createdAt": "2020-05-27T06:06:36Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/DateModifiedDisplay.tsx", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Typography, Tooltip } from \"@material-ui/core\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import * as moment from \"moment\";\n+\n+const useStyles = makeStyles({\n+  dateModified: {\n+    display: \"inline-block\",\n+  },\n+});\n+export interface DateModifiedDisplayProps {\n+  displayRelative: boolean;\n+  date: Date;\n+}\n+export default function DateModifiedDisplay({\n+  displayRelative,\n+  date,\n+}: DateModifiedDisplayProps) {\n+  const classes = useStyles();\n+  let primaryDate = moment(date).format(\"lll\");\n+  let hoverDate = moment(date).fromNow();", "originalCommit": "46950f9c9031cf904b53cf69a5c11f5545d2cdd2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3ODA1Mg==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430878052", "bodyText": "Okay, digging further I see we already have a dependency of timeago-react which under the hood apparently uses the timeago.js library - which as a result should be in our dependencies (and is only ~3KB). So how about we use that and simple date.toLocaleString()?", "author": "edalex-ian", "createdAt": "2020-05-27T06:10:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3Njc3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg4MDU3NQ==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430880575", "bodyText": "I didn't pay any attention to how big it was. But yeah, it's not really necessary, especially since we already have timeago-react", "author": "mrblippy", "createdAt": "2020-05-27T06:17:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3Njc3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkyNDA5Mw==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430924093", "bodyText": "Ah there you go, and @SammyIsConfused points out we also have Luxon - which can do both. Cheat sheet at https://moment.github.io/luxon/docs/manual/moment.html", "author": "edalex-ian", "createdAt": "2020-05-27T07:52:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3Njc3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3Njg1Nw==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430876857", "bodyText": "JSDoc please.", "author": "edalex-ian", "createdAt": "2020-05-27T06:06:53Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/DateModifiedDisplay.tsx", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Typography, Tooltip } from \"@material-ui/core\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import * as moment from \"moment\";\n+\n+const useStyles = makeStyles({\n+  dateModified: {\n+    display: \"inline-block\",\n+  },\n+});\n+export interface DateModifiedDisplayProps {\n+  displayRelative: boolean;\n+  date: Date;\n+}", "originalCommit": "46950f9c9031cf904b53cf69a5c11f5545d2cdd2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg4MDkzOQ==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430880939", "bodyText": "Oh yes. you raise a valid point", "author": "mrblippy", "createdAt": "2020-05-27T06:18:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg3Njg1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk0NzM1OA==", "url": "https://github.com/openequella/openEQUELLA/pull/1765#discussion_r430947358", "bodyText": "I was going to suggest you put this if check inside a useEffect that takes an empty array as its dependency, to avoid running this check in each rendering. But then I realised this component does not even have any stateful value. So it's all good here.", "author": "PenghaiZhang", "createdAt": "2020-05-27T08:32:10Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/DateModifiedDisplay.tsx", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Typography, Tooltip } from \"@material-ui/core\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import * as moment from \"moment\";\n+\n+const useStyles = makeStyles({\n+  dateModified: {\n+    display: \"inline-block\",\n+  },\n+});\n+export interface DateModifiedDisplayProps {\n+  displayRelative: boolean;\n+  date: Date;\n+}\n+export default function DateModifiedDisplay({\n+  displayRelative,\n+  date,\n+}: DateModifiedDisplayProps) {\n+  const classes = useStyles();\n+  let primaryDate = moment(date).format(\"lll\");\n+  let hoverDate = moment(date).fromNow();\n+\n+  if (displayRelative) {\n+    //swap 'em around\n+    [primaryDate, hoverDate] = [hoverDate, primaryDate];", "originalCommit": "46950f9c9031cf904b53cf69a5c11f5545d2cdd2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "26e110d057a82a60a00bbcb23af1a50791427bb4", "url": "https://github.com/openequella/openEQUELLA/commit/26e110d057a82a60a00bbcb23af1a50791427bb4", "message": "Gave component a more generic name of Date. Removed moment.js, now using pre-existingtimeago.js package", "committedDate": "2020-05-28T00:52:05Z", "type": "commit"}, {"oid": "0d305f42133dd585a0e8a16bf361c4ce7eff86b6", "url": "https://github.com/openequella/openEQUELLA/commit/0d305f42133dd585a0e8a16bf361c4ce7eff86b6", "message": "Documented Date component props", "committedDate": "2020-05-28T01:17:55Z", "type": "commit"}, {"oid": "49c8ec31d7db49e5aeaa6b87f43e2d843dd800a6", "url": "https://github.com/openequella/openEQUELLA/commit/49c8ec31d7db49e5aeaa6b87f43e2d843dd800a6", "message": "now using luxon for date formatting", "committedDate": "2020-05-28T02:22:49Z", "type": "commit"}]}