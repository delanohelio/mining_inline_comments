{"pr_number": 2106, "pr_title": "Integrate date range selector to search page", "pr_createdAt": "2020-07-27T01:28:26Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/2106", "timeline": [{"oid": "e05326c69d9da92ad32dc99689c314ab17c7e774", "url": "https://github.com/openequella/openEQUELLA/commit/e05326c69d9da92ad32dc99689c314ab17c7e774", "message": "Integrate Date range selector into Search page\n\nApart from the integration, also fix the issue that date picker did not update\ncorrect field value. And Remove the usage of CardHeader and Divider for\nRefine panel.", "committedDate": "2020-07-27T00:09:55Z", "type": "commit"}, {"oid": "7ff6ed0f65d91cb07e4b79fb220b09875befb859", "url": "https://github.com/openequella/openEQUELLA/commit/7ff6ed0f65d91cb07e4b79fb220b09875befb859", "message": "Add a Jest test for Last modified date selector.", "committedDate": "2020-07-27T01:16:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwNDczNg==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460604736", "bodyText": "Oh these texts should be language strings.", "author": "PenghaiZhang", "createdAt": "2020-07-27T01:34:52Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -170,10 +185,22 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n \n       <Grid item xs={3}>\n         <RefineSearchPanel>\n+          <Typography variant=\"h6\">Collections</Typography>", "originalCommit": "7ff6ed0f65d91cb07e4b79fb220b09875befb859", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwNTU4MQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460605581", "bodyText": "This is a presentation layer concern, not business logic. Shouldn't be in the Module.\nI appreciate it may seem similar to rawMode, however that one impacts what we do with our query to the data layer - whereas this option just controls a cosmetic facade. \ud83e\udd14", "author": "edalex-ian", "createdAt": "2020-07-27T01:39:18Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SearchModule.ts", "diffHunk": "@@ -107,4 +112,12 @@ export interface SearchOptions {\n    * a wildcard operator).\n    */\n   rawMode: boolean;\n+  /**\n+   * A date range for Items' last modified dates.\n+   */\n+  lastModifiedDateRange?: DateRange;\n+  /**\n+   * Whether to enable Quick mode (true) or to use custom date pickers (false)\n+   */\n+  dateRangeQuickModeEnabled: boolean;", "originalCommit": "7ff6ed0f65d91cb07e4b79fb220b09875befb859", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwODMyNw==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460608327", "bodyText": "Surely these can just be referred to from searchStrings?", "author": "SammyIsConfused", "createdAt": "2020-07-27T01:53:26Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -43,9 +43,15 @@ import { SearchResultList } from \"./components/SearchResultList\";\n import { CollectionSelector } from \"./components/CollectionSelector\";\n import { Collection } from \"../modules/CollectionsModule\";\n import { useHistory } from \"react-router\";\n+import { DateRange, DateRangeSelector } from \"../components/DateRangeSelector\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n+  const {", "originalCommit": "7ff6ed0f65d91cb07e4b79fb220b09875befb859", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYxMjI5Ng==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460612296", "bodyText": "\ud83e\udd14 I think we can destructure object searchStrings.lastModifiedDateSelector into these variables", "author": "PenghaiZhang", "createdAt": "2020-07-27T02:13:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwODMyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwODQ2NA==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460608464", "bodyText": "Languagte string.", "author": "SammyIsConfused", "createdAt": "2020-07-27T01:54:04Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -170,10 +185,22 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n \n       <Grid item xs={3}>\n         <RefineSearchPanel>\n+          <Typography variant=\"h6\">Collections</Typography>\n           <CollectionSelector\n             onSelectionChange={handleCollectionSelectionChanged}\n             value={searchOptions.collections}\n           />\n+\n+          <Typography variant=\"h6\">Date modified</Typography>", "originalCommit": "7ff6ed0f65d91cb07e4b79fb220b09875befb859", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwODc2Mg==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460608762", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * A date range for Items' last modified dates.\n          \n          \n            \n               * A date range for searching items by last modified date.", "author": "SammyIsConfused", "createdAt": "2020-07-27T01:55:22Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SearchModule.ts", "diffHunk": "@@ -107,4 +112,12 @@ export interface SearchOptions {\n    * a wildcard operator).\n    */\n   rawMode: boolean;\n+  /**\n+   * A date range for Items' last modified dates.", "originalCommit": "7ff6ed0f65d91cb07e4b79fb220b09875befb859", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwOTEwNw==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460609107", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * Generate two Date pickers and each of them is wrapped inside a Grid item.\n          \n          \n            \n               * Generate two date pickers and wrap them with Grid items.", "author": "SammyIsConfused", "createdAt": "2020-07-27T01:56:49Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/DateRangeSelector.tsx", "diffHunk": "@@ -193,33 +211,50 @@ export const DateRangeSelector = ({\n     </FormControl>\n   );\n \n+  /**\n+   * Generate two Date pickers and each of them is wrapped inside a Grid item.", "originalCommit": "7ff6ed0f65d91cb07e4b79fb220b09875befb859", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwOTIwNA==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460609204", "bodyText": "I think this comment is redundant.", "author": "SammyIsConfused", "createdAt": "2020-07-27T01:57:17Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/DateRangeSelector.tsx", "diffHunk": "@@ -45,6 +45,24 @@ export interface DateRange {\n   end?: Date;\n }\n \n+/**\n+ * Props of date pickers.", "originalCommit": "7ff6ed0f65d91cb07e4b79fb220b09875befb859", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "721a3fb143023ed9c6c39076698988b00e51b4ff", "url": "https://github.com/openequella/openEQUELLA/commit/721a3fb143023ed9c6c39076698988b00e51b4ff", "message": "Refactor interface SearchOption\n\n1. Remove field 'dateRangeQuickModeEnabled' from 'SearchOption' because\n   this field is not related to a search.\n2. Create a subclass of SearchOptions to include 'dateRangeQuickModeEnabled'.\n3. Rename variable names and properly use language strings", "committedDate": "2020-07-27T02:30:02Z", "type": "commit"}, {"oid": "0662202564a57df8d9c61db1dd71e848901bc5c6", "url": "https://github.com/openequella/openEQUELLA/commit/0662202564a57df8d9c61db1dd71e848901bc5c6", "message": "Fix the conversion between a date range and a Quick date option.\n\n1. When end date is defined but is not equal to today, Quick option 'All'\n   should be selected.\n2. When the mode is changed, date range may be required to update.\n3. When the value of a date picker is undefined, use null instead so it\n   does not use today as default value. Also, while a value is defined, do\n   not display the label. This is due to the bug of MUI Datepicker.", "committedDate": "2020-07-27T05:16:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY1MTcyNA==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460651724", "bodyText": "The change made here is  due a MUI Datepicker UI bug. If people are curious what this bug is, please grab me.", "author": "PenghaiZhang", "createdAt": "2020-07-27T05:18:51Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/DateRangeSelector.tsx", "diffHunk": "@@ -235,8 +242,8 @@ export const DateRangeSelector = ({\n           labelFunc={(value, invalidLabel) =>\n             value?.toLocaleString() ?? invalidLabel\n           }\n-          label={label}\n-          value={value}\n+          label={!value ? label : \"\"}\n+          value={value ?? null}", "originalCommit": "0662202564a57df8d9c61db1dd71e848901bc5c6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "58f64f6a3a70edde0b4f7fcd90ed41db1d2a2b0b", "url": "https://github.com/openequella/openEQUELLA/commit/58f64f6a3a70edde0b4f7fcd90ed41db1d2a2b0b", "message": "Update Search page test for the Date range selector.", "committedDate": "2020-07-27T05:26:50Z", "type": "commit"}, {"oid": "bd4b589cd8a7b52661371a2bfd0e6e89a27f2e99", "url": "https://github.com/openequella/openEQUELLA/commit/bd4b589cd8a7b52661371a2bfd0e6e89a27f2e99", "message": "Update Search page test to use 'SearchPageOptions'.", "committedDate": "2020-07-27T05:30:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY1MjMwNg==", "url": "https://github.com/openequella/openEQUELLA/pull/2106#discussion_r460652306", "bodyText": "Missing @param for new dateRange.", "author": "edalex-ian", "createdAt": "2020-07-27T05:21:05Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/DateRangeSelector.tsx", "diffHunk": "@@ -73,7 +70,7 @@ export interface DateRangeSelectorProps {\n    * Fired when the status of Quick mode is changed.\n    * @param enabled The new status of Quick mode\n    */\n-  onQuickModeChange: (enabled: boolean) => void;\n+  onQuickModeChange: (enabled: boolean, dateRange?: DateRange) => void;", "originalCommit": "0662202564a57df8d9c61db1dd71e848901bc5c6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2187a5e1edc887380afa8ce36ca4d5c3c6bc1472", "url": "https://github.com/openequella/openEQUELLA/commit/2187a5e1edc887380afa8ce36ca4d5c3c6bc1472", "message": "Update DateRangeSelector's JSDoc.", "committedDate": "2020-07-27T05:44:13Z", "type": "commit"}]}