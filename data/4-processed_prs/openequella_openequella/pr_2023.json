{"pr_number": 2023, "pr_title": "Add a spinner for Search page", "pr_createdAt": "2020-07-08T02:05:28Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/2023", "timeline": [{"oid": "ddc1be0cf9b010432fc3569004d122f43adb6b1e", "url": "https://github.com/openequella/openEQUELLA/commit/ddc1be0cf9b010432fc3569004d122f43adb6b1e", "message": "Add a spinner for Search page\n\nShow a spinner when a search is in progress. The position of the spinner\nis determined by if the search result list is empty or not.", "committedDate": "2020-07-08T01:56:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI0NDMxNw==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451244317", "bodyText": "Oh! Nice pick-up. \ud83d\udc4d", "author": "edalex-ian", "createdAt": "2020-07-08T02:20:48Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -110,28 +128,24 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     )\n   );\n \n-  /**\n-   * Provide a memorized callback for updating sort order in order to avoid re-rendering\n-   * component SearchOrderSelect when other search control values are changed.\n-   */", "originalCommit": "ddc1be0cf9b010432fc3569004d122f43adb6b1e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI0NTk2Ng==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451245966", "bodyText": "This ternary has gone too far. Feels like it should now be if/else, or maybe...\n{ (searchResults.length < 1 && !showSpinner)\n  ? (<ListItem ...> ... </ListItem>)\n  : searchResults }", "author": "edalex-ian", "createdAt": "2020-07-08T02:27:27Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -110,28 +128,24 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     )\n   );\n \n-  /**\n-   * Provide a memorized callback for updating sort order in order to avoid re-rendering\n-   * component SearchOrderSelect when other search control values are changed.\n-   */\n   const handleSortOrderChanged = (order: SortOrder) =>\n     setSearchOptions({ ...searchOptions, sortOrder: order });\n \n   const handleQueryChanged = (query: string) =>\n     setSearchOptions({ ...searchOptions, query: query, currentPage: 0 });\n \n   /**\n-   * A list that consists of search result items.\n+   * A list that consists of search result items. Lower the list's opacity when spinner displays.\n    */\n   const searchResultList = (\n-    <List>\n-      {searchResults.length > 0 ? (\n-        searchResults\n-      ) : (\n-        <ListItem key={searchStrings.noResultsFound} divider>\n-          <Typography>{searchStrings.noResultsFound}</Typography>\n-        </ListItem>\n-      )}\n+    <List className={showSpinner ? classes.transparentList : \"\"}>\n+      {searchResults.length > 0\n+        ? searchResults\n+        : !showSpinner && (\n+            <ListItem key={searchStrings.noResultsFound} divider>\n+              <Typography>{searchStrings.noResultsFound}</Typography>\n+            </ListItem>\n+          )}", "originalCommit": "ddc1be0cf9b010432fc3569004d122f43adb6b1e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI0NjExNw==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451246117", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      {/*Add an inline style to make the spinner display at the Card's horizontal center.*/}\n          \n          \n            \n                      {/*Add an inline style to make the spinner displays at the Card's horizontal center.*/}", "author": "edalex-ian", "createdAt": "2020-07-08T02:28:03Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -155,7 +169,21 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n               />\n             }\n           />\n-          <CardContent>{searchResultList}</CardContent>\n+          {/*Add an inline style to make the spinner display at the Card's horizontal center.*/}", "originalCommit": "ddc1be0cf9b010432fc3569004d122f43adb6b1e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI2MjY0Ng==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451262646", "bodyText": "Since handleError's signature is also a single param with error, this can likely be folded.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  .catch((error: Error) => handleError(error))\n          \n          \n            \n                  .catch(handleError)", "author": "ChristianMurphy", "createdAt": "2020-07-08T03:34:55Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -91,14 +107,16 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   };\n \n   /**\n-   * Search items with specified search criteria.\n+   * Search items with specified search criteria and show a spinner when the search is in progress.\n    */\n   const search = (): void => {\n+    setShowSpinner(true);\n     searchItems(searchOptions)\n       .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n         setPagedSearchResult(items)\n       )\n-      .catch((error: Error) => handleError(error));\n+      .catch((error: Error) => handleError(error))", "originalCommit": "ddc1be0cf9b010432fc3569004d122f43adb6b1e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ac4f3611e36b708fa3fd89741b40ca32ccc98902", "url": "https://github.com/openequella/openEQUELLA/commit/ac4f3611e36b708fa3fd89741b40ca32ccc98902", "message": "Improve readability for search result list.", "committedDate": "2020-07-08T03:59:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI3MTk1MA==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451271950", "bodyText": "Pre-commit took out the parenthesis for the condition check.", "author": "PenghaiZhang", "createdAt": "2020-07-08T04:13:02Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -139,13 +139,13 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n    */\n   const searchResultList = (\n     <List className={showSpinner ? classes.transparentList : \"\"}>\n-      {searchResults.length > 0\n-        ? searchResults\n-        : !showSpinner && (\n-            <ListItem key={searchStrings.noResultsFound} divider>\n-              <Typography>{searchStrings.noResultsFound}</Typography>\n-            </ListItem>\n-          )}\n+      {searchResults.length === 0 && !showSpinner ? (", "originalCommit": "ac4f3611e36b708fa3fd89741b40ca32ccc98902", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI3NjM0OQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451276349", "bodyText": "That's okay. :)", "author": "edalex-ian", "createdAt": "2020-07-08T04:30:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI3MTk1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI4ODYxNA==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451288614", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      {/*Add an inline style to make the spinner displays at the Card's horizontal center.*/}\n          \n          \n            \n                      {/*Add an inline style to make the spinner display at the Card's horizontal center.*/}", "author": "SammyIsConfused", "createdAt": "2020-07-08T05:18:32Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -155,7 +169,21 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n               />\n             }\n           />\n-          <CardContent>{searchResultList}</CardContent>\n+          {/*Add an inline style to make the spinner displays at the Card's horizontal center.*/}", "originalCommit": "ac4f3611e36b708fa3fd89741b40ca32ccc98902", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQxNjc2NQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451416765", "bodyText": "oops Ian suggested 'display' -> 'displays' \ud83d\ude06", "author": "PenghaiZhang", "createdAt": "2020-07-08T09:41:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI4ODYxNA=="}], "type": "inlineReview"}, {"oid": "71fbdea313dd012c07e5be48436c0f0ed0ed1ce8", "url": "https://github.com/openequella/openEQUELLA/commit/71fbdea313dd012c07e5be48436c0f0ed0ed1ce8", "message": "Update Search page Jest test\n\n1. Rather than mocking 'rest-api-client', mock SearchModule and\nSearchSettingsModule as Search page interacts with these two modules.\n\n2. After mounting the component, wait for Search promise and Search\nsetting promise to make sure the initial search is completed. And therefore\nwhen tests are executed the Search page should be in order.\n\n3. Add a test for the Search setting API call and the default search.\n\n4. Add a test for the spinner.", "committedDate": "2020-07-08T09:40:01Z", "type": "commit"}, {"oid": "38cba99180e246e73f86188912bff676a8fc2d86", "url": "https://github.com/openequella/openEQUELLA/commit/38cba99180e246e73f86188912bff676a8fc2d86", "message": "Fix a comment typo issue for Search page.\n\nCo-authored-by: SammyIsConfused <samantha.fisher@edalex.com>", "committedDate": "2020-07-08T09:42:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU0MTQzMA==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451541430", "bodyText": "would it make sense to move the textAlign from being inline into makeStyles?", "author": "ChristianMurphy", "createdAt": "2020-07-08T13:25:11Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -155,7 +169,21 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n               />\n             }\n           />\n-          <CardContent>{searchResultList}</CardContent>\n+          {/*Add an inline style to make the spinner display at the Card's horizontal center.*/}\n+          <CardContent style={{ textAlign: \"center\" }}>", "originalCommit": "38cba99180e246e73f86188912bff676a8fc2d86", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTg3NTQwMw==", "url": "https://github.com/openequella/openEQUELLA/pull/2023#discussion_r451875403", "bodyText": "Hello Christian! We actually had a quick discussion about this yesterday. The reason is we think this style is quite simple and being inline with a comment may help people easily understand why we need it.", "author": "PenghaiZhang", "createdAt": "2020-07-08T23:14:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU0MTQzMA=="}], "type": "inlineReview"}]}