{"pr_number": 2055, "pr_title": "Trim the search query and only append wildcard to non-empty queries", "pr_createdAt": "2020-07-15T04:25:41Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/2055", "timeline": [{"oid": "47c668feb6b6c5761cd95f354018c345d29d558a", "url": "https://github.com/openequella/openEQUELLA/commit/47c668feb6b6c5761cd95f354018c345d29d558a", "message": "Trim the search query and only append * with nonempty queries", "committedDate": "2020-07-15T04:22:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4NTU0MQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2055#discussion_r454785541", "bodyText": "The readability here is suffering. And in trying to untangle it, it led me to a more basic question. If there is no query after trimming, then should we call onChange at all? If not, that may indeed enable simplifying this logic quite readily.", "author": "edalex-ian", "createdAt": "2020-07-15T04:35:02Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchBar.tsx", "diffHunk": "@@ -53,8 +53,10 @@ export default function SearchBar({ onChange }: SearchBarProps) {\n   const [rawSearchMode, setRawSearchMode] = useState<boolean>(false);\n   const [queryString, setQuery] = React.useState<string>(\"\");\n   const strings = languageStrings.searchpage;\n-  const callOnChange = (query: string) =>\n-    onChange(query + (rawSearchMode ? \"\" : \"*\"));\n+  const callOnChange = (query: string) => {\n+    const trimmedQuery = query.trim();\n+    onChange(trimmedQuery + (rawSearchMode || !trimmedQuery ? \"\" : \"*\"));", "originalCommit": "47c668feb6b6c5761cd95f354018c345d29d558a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4NzI3MA==", "url": "https://github.com/openequella/openEQUELLA/pull/2055#discussion_r454787270", "bodyText": "Yes, I think it should.\nFor example, you have a search query \"search1\" and you press the X button to clear the query. OnChange gets called, trimmedQuery would be \"\". It still needs calling so that you get results for no query rather than \"search1\".", "author": "SammyIsConfused", "createdAt": "2020-07-15T04:41:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4NTU0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc5NDUwOA==", "url": "https://github.com/openequella/openEQUELLA/pull/2055#discussion_r454794508", "bodyText": "Cool, in that case could you please break it out a bit and improve the readability?", "author": "edalex-ian", "createdAt": "2020-07-15T05:07:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4NTU0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgwMzA0NA==", "url": "https://github.com/openequella/openEQUELLA/pull/2055#discussion_r454803044", "bodyText": "Sure thing. That should be done now.", "author": "SammyIsConfused", "createdAt": "2020-07-15T05:36:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4NTU0MQ=="}], "type": "inlineReview"}, {"oid": "f9bbe120c6b7aade047a53f78564a0f46a5c4718", "url": "https://github.com/openequella/openEQUELLA/commit/f9bbe120c6b7aade047a53f78564a0f46a5c4718", "message": "Add test for empty queries", "committedDate": "2020-07-15T05:27:16Z", "type": "commit"}, {"oid": "2737f89fec75663fdd3ea78a097bcd0b0f7f76e2", "url": "https://github.com/openequella/openEQUELLA/commit/2737f89fec75663fdd3ea78a097bcd0b0f7f76e2", "message": "Improve readability for callOnChange", "committedDate": "2020-07-15T05:27:48Z", "type": "commit"}]}