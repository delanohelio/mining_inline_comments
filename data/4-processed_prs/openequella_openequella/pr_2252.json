{"pr_number": 2252, "pr_title": "Feature/refine panel accordion", "pr_createdAt": "2020-09-02T06:21:51Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/2252", "timeline": [{"oid": "c9e1038aa0ac71a35b009cc72a0951604bf34fe0", "url": "https://github.com/openequella/openEQUELLA/commit/c9e1038aa0ac71a35b009cc72a0951604bf34fe0", "message": "Add collapsible area to refine search panel.\n\n* All refine controls are included inside this panel, except for the Collection panel\n* Open/closed state of filter panel is remembered in history\n* A filter icon is displayed next to the 'Show more' button. This indicates that the user has set at least one of the panels inside the collapsed area", "committedDate": "2020-09-02T05:54:49Z", "type": "commit"}, {"oid": "af924013a36eb98898484bb031d635fc5f9b22c6", "url": "https://github.com/openequella/openEQUELLA/commit/af924013a36eb98898484bb031d635fc5f9b22c6", "message": "Update SearchPage test to support collapsible filter area", "committedDate": "2020-09-02T06:02:58Z", "type": "commit"}, {"oid": "50bb9e5c045b73c34d01a7186644d41b011cddf2", "url": "https://github.com/openequella/openEQUELLA/commit/50bb9e5c045b73c34d01a7186644d41b011cddf2", "message": "Delete prettier.xml", "committedDate": "2020-09-02T06:22:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTc3ODE1Ng==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r481778156", "bodyText": "This piece of code in particular is something i'm not proud of, for multiple reasons.\n\nThe destructuring looks ugly, so if anyone has any a good way to include only a subset of searchPageOptions properties\nWhat collapsed filters to include is being defined here (to determine what filters have been modified), but RefineSearchPanel is controlling what controls are appearing in the collapsible panel. So maintenance will be an issue", "author": "mrblippy", "createdAt": "2020-09-02T06:22:43Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -153,6 +189,34 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     });\n   };\n \n+  const handleCollapsibleFilterClick = () => {\n+    setFilterExpansion(!filterExpansion);\n+  };\n+\n+  /**\n+   * Determines if any collapsible filters have been modified from their defaults\n+   */\n+  const areCollapsibleFiltersSet = (): boolean => {", "originalCommit": "50bb9e5c045b73c34d01a7186644d41b011cddf2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2Nzc4NQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482667785", "bodyText": "I see what you mean! As per @ChristianMurphy suggestion, how about something like:\n  const areCollapsibleFiltersSet = (): boolean => {\n    const getCollapsedOptions = (options: SearchPageOptions) =>\n      _.pick( options, [\"lastModifiedDateRange\", \"owner\", \"status\", \"searchAttachments\"]);\n\n    return !_.isEqual(\n      getCollapsedOptions(defaultSearchOptions),\n      getCollapsedOptions(searchPageOptions));\n  }", "author": "edalex-ian", "createdAt": "2020-09-03T02:36:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTc3ODE1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3NjM5MA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482676390", "bodyText": "Yeah, this lodash pick is much better than what I ended up with \ud83e\udd2e\nFunnily enough, I was originally using the lodash pick function. So in this case I probably should've just gone with my first instinct", "author": "mrblippy", "createdAt": "2020-09-03T03:09:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTc3ODE1Ng=="}], "type": "inlineReview"}, {"oid": "2164df8d950ad25033b4b6fa56be1c5a85e5c4e4", "url": "https://github.com/openequella/openEQUELLA/commit/2164df8d950ad25033b4b6fa56be1c5a85e5c4e4", "message": "update facetselector to use generic language string", "committedDate": "2020-09-02T07:20:32Z", "type": "commit"}, {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "url": "https://github.com/openequella/openEQUELLA/commit/bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "message": "Merge branch 'feature/refine-panel-accordion' of https://github.com/mrblippy/Charliequella into feature/refine-panel-accordion", "committedDate": "2020-09-02T07:22:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3Mzk0Nw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482173947", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { Collection } from \"../modules/CollectionsModule\";\n          \n          \n            \n            import type { Collection } from \"../modules/CollectionsModule\";", "author": "ChristianMurphy", "createdAt": "2020-09-02T15:43:55Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -15,41 +15,42 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n+import { Grid } from \"@material-ui/core\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n import * as React from \"react\";\n import { useEffect, useRef, useState } from \"react\";\n+import { useHistory } from \"react-router\";\n+import { generateFromError } from \"../api/errors\";\n+import { DateRange, DateRangeSelector } from \"../components/DateRangeSelector\";\n import {\n   templateDefaults,\n   templateError,\n   TemplateUpdateProps,\n } from \"../mainui/Template\";\n-import { languageStrings } from \"../util/langstrings\";\n-import { Grid } from \"@material-ui/core\";\n+import { Collection } from \"../modules/CollectionsModule\";", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3ODQ5OA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482178498", "bodyText": "https://lodash.com/docs/#pick may help here", "author": "ChristianMurphy", "createdAt": "2020-09-02T15:50:29Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -153,6 +189,34 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     });\n   };\n \n+  const handleCollapsibleFilterClick = () => {\n+    setFilterExpansion(!filterExpansion);\n+  };\n+\n+  /**\n+   * Determines if any collapsible filters have been modified from their defaults\n+   */\n+  const areCollapsibleFiltersSet = (): boolean => {\n+    const defaultCollapsibleFilters = (({\n+      lastModifiedDateRange,\n+      owner,\n+      status,\n+      searchAttachments,\n+    }) => ({ lastModifiedDateRange, owner, status, searchAttachments }))(\n+      defaultSearchOptions\n+    );\n+\n+    const currentCollapsibleFilters = (({\n+      lastModifiedDateRange,\n+      owner,\n+      status,\n+      searchAttachments,\n+    }) => ({ lastModifiedDateRange, owner, status, searchAttachments }))(\n+      searchPageOptions\n+    );", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MDE0Nw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482640147", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            describe(\"Collapsible refine filter section\", () => {\n          \n          \n            \n            \n          \n          \n            \n            describe(\"Collapsible refine filter section\", () => {", "author": "edalex-ian", "createdAt": "2020-09-03T01:33:06Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTU0Mw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482641543", "bodyText": "Some (all?) of these have also be defined elsewhere in this file. Seeing they're a key component we need to work with, perhaps we should define them at the top level or in a SearchPageHelper.ts[x] file. If it were for such a file, it'd also be where the queryRefineSearchComponent would live too.\nOn other details, you've called these getXyz, however we're aiming to align with the React Testing Library standards and so these should all be queryXyz. (The key difference being, getXyz should throw if it can't find the element whereas queryXyz simply returns null.)", "author": "edalex-ian", "createdAt": "2020-09-03T01:38:11Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const getOwnerSelector = () =>\n+    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n+  const getDateRangeSelector = () =>\n+    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n+  const getSearchAttachmentsSelector = () =>\n+    queryRefineSearchComponent(page.container, \"SearchAttachmentsSelector\");\n+  const getCollectionSelector = () =>\n+    queryRefineSearchComponent(page.container, \"CollectionSelector\");", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTgwNw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482641807", "bodyText": "Would it be worth ensuring that there is only 1 'item'?", "author": "edalex-ian", "createdAt": "2020-09-03T01:39:14Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const getOwnerSelector = () =>\n+    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n+  const getDateRangeSelector = () =>\n+    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n+  const getSearchAttachmentsSelector = () =>\n+    queryRefineSearchComponent(page.container, \"SearchAttachmentsSelector\");\n+  const getCollectionSelector = () =>\n+    queryRefineSearchComponent(page.container, \"CollectionSelector\");\n+\n+  it(\"Should contain the correct controls\", async () => {\n+    const collapsibleSection = page.container\n+      .getElementsByClassName(\"collapsibleRefinePanel\")\n+      .item(0);", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5NjcwMw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482696703", "bodyText": "I think that would be sensible", "author": "mrblippy", "createdAt": "2020-09-03T04:29:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTgwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjcwMzM3Ng==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482703376", "bodyText": "Why not use querySelector(\".collapsibleRefinePanel\") ?", "author": "PenghaiZhang", "createdAt": "2020-09-03T04:54:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTgwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0NDAwMA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482644000", "bodyText": "Props is something different, and SearchHistory sounds more like it's about all our previous searches. Could I suggest something like:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            interface SearchHistoryProps {\n          \n          \n            \n            interface SearchPageHistoryState {", "author": "edalex-ian", "createdAt": "2020-09-03T01:46:54Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -61,6 +62,20 @@ export interface SearchPageOptions extends SearchOptions {\n   dateRangeQuickModeEnabled: boolean;\n }\n \n+/**\n+ * Type to keep track of values stored in history\n+ */\n+interface SearchHistoryProps {", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0NDM0Nw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482644347", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Type to keep track of values stored in history\n          \n          \n            \n             * Structure of data stored in browser's history state to capture the current state of the SearchPage\n          \n          \n            \n             * to support on back.", "author": "edalex-ian", "createdAt": "2020-09-03T01:48:15Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -61,6 +62,20 @@ export interface SearchPageOptions extends SearchOptions {\n   dateRangeQuickModeEnabled: boolean;\n }\n \n+/**\n+ * Type to keep track of values stored in history", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0NzA5MQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482647091", "bodyText": "It's not so much managing, it's only storing or persisting. Maybe:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              const manageSearchPageHistory = () => {\n          \n          \n            \n              const storeSearchPageHistory = () => {\n          \n      \n    \n    \n  \n\nThen again though, if you see my recommendation above about adding pagedSearchResult as a new dependency of your Effect, then this stand alone function can just be the anonymous function of useEffect.", "author": "edalex-ian", "createdAt": "2020-09-03T01:58:14Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -115,10 +140,21 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     }\n   }, [searchPageOptions]);\n \n+  useEffect(() => {\n+    manageSearchPageHistory();\n+  }, [filterExpansion]);\n+\n   const handleError = (error: Error) => {\n     updateTemplate(templateError(generateFromError(error)));\n   };\n \n+  const manageSearchPageHistory = () => {", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0ODE0Mw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482648143", "bodyText": "We can make this look after all the cases. Below in search where you've called manageSearchPageHistory is such that it only saves the options to history on a successful search which is then what drives pagedSearchResult. So:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              }, [filterExpansion]);\n          \n          \n            \n              }, [filterExpansion, pagedSearchResult]);", "author": "edalex-ian", "createdAt": "2020-09-03T02:02:04Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -115,10 +140,21 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     }\n   }, [searchPageOptions]);\n \n+  useEffect(() => {\n+    manageSearchPageHistory();\n+  }, [filterExpansion]);", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTIwNA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482669204", "bodyText": "This name sounds all encompassing. How's about onChangeExpansion or something?", "author": "edalex-ian", "createdAt": "2020-09-03T02:41:54Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEzODMyNg==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r489138326", "bodyText": "This was marked as resolved, but... Looks like it wasn't. \ud83e\udd14", "author": "edalex-ian", "createdAt": "2020-09-16T03:24:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTIwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE1MzgzOQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r489153839", "bodyText": "Sorry @edalex-ian . It is now fixed", "author": "mrblippy", "createdAt": "2020-09-16T04:26:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTIwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTM2MA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482669360", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * Determines the current state of the filter expansion panel\n          \n          \n            \n               * Specifies whether the expansion panel should be expanded or collapsed.", "author": "edalex-ian", "createdAt": "2020-09-03T02:42:29Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDQ1OQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482670459", "bodyText": "There's an assumption being made here that the Collection control is first.\nTo some degree, that's outside the purview of this component. The contract for this component is that it will display the first component outside of the selection control, so perhaps this should just be:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              const [collectionControl, ...collapsedControls] = controls.filter(\n          \n          \n            \n              const [alwaysVisibleControl, ...collapsedControls] = controls.filter(\n          \n      \n    \n    \n  \n\nFor now that's all we need. But if that ever changed then we'd possibly allow two lots of controls to be passed in - those in the expansion panel, those outside of it.", "author": "edalex-ian", "createdAt": "2020-09-03T02:46:43Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5ODYxNQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482698615", "bodyText": "Yeah, I had originally envisioned to pass in two sets of controls, but yeah, we can cross that bridge if the need arises in the future", "author": "mrblippy", "createdAt": "2020-09-03T04:36:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDQ1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDk4NQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482670985", "bodyText": "This just occurred to me, and applies to all our components. For keyboard accessibility, is it sufficient that we're only ever doing onClick?\nSee you did some of our recent accessibility work, you might be well placed to answer that.", "author": "edalex-ian", "createdAt": "2020-09-03T02:48:47Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(\n+    (c) => !c.disabled\n+  );\n+\n+  const collapsibleSection = (controls: RefinePanelControl[]) => {\n+    return (\n+      <>\n+        <Collapse className=\"collapsibleRefinePanel\" in={panelExpanded}>\n+          <List>{controls.map((control) => renderRefineControl(control))}</List>\n+        </Collapse>\n+        <Button\n+          fullWidth\n+          onClick={() => handleClick(panelExpanded)}", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3NDk4NA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482674984", "bodyText": "Yeah, that has been in the back of my mind for a while. I'm not sure on the answer to it. But it definitely warrants further investigation. Because, like you said, this could have implications for all of our React/Material components", "author": "mrblippy", "createdAt": "2020-09-03T03:04:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDk4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY4MjEwNw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482682107", "bodyText": "The button appears to be responding to the enter key. It appears that, the majority of the time the enter key will trigger an onClick event.\nSome more detailed explanation can be found here https://webaim.org/techniques/javascript/eventhandlers#onclick", "author": "mrblippy", "createdAt": "2020-09-03T03:32:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDk4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjcwMDk0MQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482700941", "bodyText": "Nice work! Thanks @mrblippy", "author": "edalex-ian", "createdAt": "2020-09-03T04:45:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDk4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MTQ4MA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482671480", "bodyText": "It was agreed we're going to aim for camelCase here, so:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  showmore: \"Show more\",\n          \n          \n            \n                  showless: \"Show less\",\n          \n          \n            \n                  showMore: \"Show more\",\n          \n          \n            \n                  showLess: \"Show less\",", "author": "edalex-ian", "createdAt": "2020-09-03T02:50:39Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/util/langstrings.ts", "diffHunk": "@@ -301,6 +301,8 @@ export const languageStrings = {\n       done: \"Done\",\n       yes: \"Yes\",\n       no: \"No\",\n+      showmore: \"Show more\",\n+      showless: \"Show less\",", "originalCommit": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "54a9b50d15b81f19d59eeeabf75e57c3ad57ce61", "url": "https://github.com/openequella/openEQUELLA/commit/54a9b50d15b81f19d59eeeabf75e57c3ad57ce61", "message": "Use camelCase for language strings, as that follows our in-house style", "committedDate": "2020-09-03T04:07:00Z", "type": "commit"}, {"oid": "95c659e04dbcc711bf3f0a36783b1be2346e81b5", "url": "https://github.com/openequella/openEQUELLA/commit/95c659e04dbcc711bf3f0a36783b1be2346e81b5", "message": "Make use of lodash pick function, instead of using destructuring to select a subset of SearchOptions properties", "committedDate": "2020-09-03T04:16:46Z", "type": "commit"}, {"oid": "d542e955d4da1ef6403cb2c184826886b1e40fef", "url": "https://github.com/openequella/openEQUELLA/commit/d542e955d4da1ef6403cb2c184826886b1e40fef", "message": "Import the Collection type from CollectionsModule", "committedDate": "2020-09-03T04:29:10Z", "type": "commit"}, {"oid": "d27b77340c0251176246b42244cbbf585f4b6729", "url": "https://github.com/openequella/openEQUELLA/commit/d27b77340c0251176246b42244cbbf585f4b6729", "message": "Tidied up interface and function names, aiding in readability", "committedDate": "2020-09-03T04:51:17Z", "type": "commit"}, {"oid": "024614a21c83896aaeb8ad09aa11c6241734f8bd", "url": "https://github.com/openequella/openEQUELLA/commit/024614a21c83896aaeb8ad09aa11c6241734f8bd", "message": "Move SearchPage test refine query selectors into helper file", "committedDate": "2020-09-04T00:48:00Z", "type": "commit"}, {"oid": "bc713c4013a70b06d8947ac327e671d26d5df3fc", "url": "https://github.com/openequella/openEQUELLA/commit/bc713c4013a70b06d8947ac327e671d26d5df3fc", "message": "Add pagedSearchResult as useEffect dependency", "committedDate": "2020-09-04T01:13:39Z", "type": "commit"}, {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab", "url": "https://github.com/openequella/openEQUELLA/commit/e113b1d874350f6fb0dc61292d0afa62ef0ef1ab", "message": "Minor wording change to RefinePanelProps jsdoc", "committedDate": "2020-09-04T01:18:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTczNg==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483409736", "bodyText": "Nit: This name makes it sound like a function. Maybe:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                const findCollapsibleSection = page.container.getElementsByClassName(\n          \n          \n            \n                const collapsibleSections = page.container.getElementsByClassName(\n          \n      \n    \n    \n  \n\nIs there a suitable RTL query we could do here directly on page rather than using container. Probably a getAllBy?", "author": "edalex-ian", "createdAt": "2020-09-04T06:17:57Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(", "originalCommit": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDQxMw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487610413", "bodyText": "Currently, the only way to target the collapsible filter section is by using a classname. There's no RTL query to perform this function. So it will have to stay as-is", "author": "mrblippy", "createdAt": "2020-09-14T01:41:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTczNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM5ODM5Mg==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r488398392", "bodyText": "I would try to give an ID to the panel, get the panel by querySelector, and then use getAllByRole(\"listitem\") to get a list of controls wrapped inside this panel. So the benefit is you don't need to check how many the length of collapsibleSections and use collapsibleSections.item(0) to access the panel.", "author": "PenghaiZhang", "createdAt": "2020-09-15T05:41:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTczNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQwMzE2MA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r488403160", "bodyText": "You may not even need an ID. You can get the panel by finding the parent node of  h5 Refine search.", "author": "PenghaiZhang", "createdAt": "2020-09-15T05:54:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTczNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMDAzNg==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483410036", "bodyText": "Good to have a line space here, as you're into a whole new logical block.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            describe(\"Hide Refine Search controls\", () => {\n          \n          \n            \n            \n          \n          \n            \n            describe(\"Hide Refine Search controls\", () => {", "author": "edalex-ian", "createdAt": "2020-09-04T06:18:49Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(\n+      \"collapsibleRefinePanel\"\n+    );\n+    expect(findCollapsibleSection).toHaveLength(1);\n+\n+    const collapsibleSection = findCollapsibleSection.item(0);\n+\n+    expect(collapsibleSection).toContainElement(\n+      queryOwnerSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      queryDateRangeSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      querySearchAttachmentsSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).not.toContainElement(\n+      queryCollectionSelector(pageContainer)\n+    );\n+  });\n+\n+  it(\"Should change button text when clicked\", async () => {\n+    const expansionButton = page.getByText(\n+      languageStrings.common.action.showMore\n+    );\n+    fireEvent.click(expansionButton);\n+    expect(expansionButton).toHaveTextContent(\n+      languageStrings.common.action.showLess\n+    );\n+  });\n+});\n+describe(\"Hide Refine Search controls\", () => {", "originalCommit": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTM3MA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483411370", "bodyText": "You may want to highlight that these are queryXyz functions. Appreciating the name would shadow the the main ones, one option is an underscore prefix:\n_queryOwnerSelector() etc.", "author": "edalex-ian", "createdAt": "2020-09-04T06:22:23Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(\n+      \"collapsibleRefinePanel\"\n+    );\n+    expect(findCollapsibleSection).toHaveLength(1);\n+\n+    const collapsibleSection = findCollapsibleSection.item(0);\n+\n+    expect(collapsibleSection).toContainElement(\n+      queryOwnerSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      queryDateRangeSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      querySearchAttachmentsSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).not.toContainElement(\n+      queryCollectionSelector(pageContainer)\n+    );\n+  });\n+\n+  it(\"Should change button text when clicked\", async () => {\n+    const expansionButton = page.getByText(\n+      languageStrings.common.action.showMore\n+    );\n+    fireEvent.click(expansionButton);\n+    expect(expansionButton).toHaveTextContent(\n+      languageStrings.common.action.showLess\n+    );\n+  });\n+});\n+describe(\"Hide Refine Search controls\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const ownerSelector = () => queryOwnerSelector(page.container);\n+  const dateSelector = () => queryDateRangeSelector(page.container);\n+  const statusSelector = () => queryStatusSelector(page.container);", "originalCommit": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU5MjYxOA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487592618", "bodyText": "Oh ok, the underscore prefix sounds good for the const names", "author": "mrblippy", "createdAt": "2020-09-13T23:39:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTM3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTYzMQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483411631", "bodyText": "Interesting you've changed all these from getXyz to queryXyz semantics. Was that intended?", "author": "edalex-ian", "createdAt": "2020-09-04T06:23:05Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -331,19 +363,19 @@ describe(\"Hide Refine Search controls\", () => {\n     // Reuse default Search settings as disableStatusSelector, enableOwnerSelector and enableDateSelector.\n     [\n       \"Owner Selector\",\n-      getOwnerSelector,\n+      ownerSelector,", "originalCommit": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU5MjQ0OA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487592448", "bodyText": "I now can't really remember why i made this change. After looking at this again, i think I should revert it to how it was", "author": "mrblippy", "createdAt": "2020-09-13T23:38:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTYzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTk3MQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483411971", "bodyText": "See you've brought this one over, it'd make sense to also bring over the getRefineSearchComponent as they're a bit of pidgeon pair.", "author": "edalex-ian", "createdAt": "2020-09-04T06:24:02Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPageHelper.tsx", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+/**\n+ * Helper function to find individual Refine Search components based on the their `idSuffix`,\n+ * or return null if the component is not found.\n+ *\n+ * @param container The root container to start the search from\n+ * @param componentSuffix Typically the `idSuffix` provided in `SearchPage.tsx`\n+ */\n+export const queryRefineSearchComponent = (", "originalCommit": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU5MjQ3Nw==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487592477", "bodyText": "Yeah, I was wondering about that. I will move it over too", "author": "mrblippy", "createdAt": "2020-09-13T23:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTk3MQ=="}], "type": "inlineReview"}, {"oid": "69256a4cb237ce03342577f2daa5cda9300ca6e5", "url": "https://github.com/openequella/openEQUELLA/commit/69256a4cb237ce03342577f2daa5cda9300ca6e5", "message": "Use more logical naming for constants. Move getRefineSearchComponent into Helper file, as it makes more sense to be there", "committedDate": "2020-09-14T01:38:15Z", "type": "commit"}, {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7", "url": "https://github.com/openequella/openEQUELLA/commit/b5f60754677f8557d753ee41c7b0aa383abef3b7", "message": "Merge branch 'component/new-search-page' into feature/refine-panel-accordion", "committedDate": "2020-09-14T07:16:19Z", "type": "commit"}, {"oid": "be6955ecc8650a5e54607d8f8555ac7a4f37d9a0", "url": "https://github.com/openequella/openEQUELLA/commit/be6955ecc8650a5e54607d8f8555ac7a4f37d9a0", "message": "Update imagemagick readme links", "committedDate": "2020-09-14T07:54:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MDc1MA==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487980750", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";\n          \n          \n            \n            import type { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";", "author": "ChristianMurphy", "createdAt": "2020-09-14T14:34:17Z", "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/CategorySelector.stories.tsx", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";", "originalCommit": "b5f60754677f8557d753ee41c7b0aa383abef3b7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI4MTIxOQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r488281219", "bodyText": "I keep forgetting about that type keyword \ud83e\udd26  thanks @ChristianMurphy", "author": "mrblippy", "createdAt": "2020-09-14T22:50:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MDc1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MTc0Ng==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487981746", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { SelectedCategories } from \"../../../tsrc/modules/SearchFacetsModule\";\n          \n          \n            \n            import type { SelectedCategories } from \"../../../tsrc/modules/SearchFacetsModule\";", "author": "ChristianMurphy", "createdAt": "2020-09-14T14:35:35Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/modules/SearchModule.test.ts", "diffHunk": "@@ -16,81 +16,92 @@\n  * limitations under the License.\n  */\n import * as OEQ from \"@openequella/rest-api-client\";\n+import { getSearchResult } from \"../../../__mocks__/SearchResult.mock\";\n+import { SelectedCategories } from \"../../../tsrc/modules/SearchFacetsModule\";", "originalCommit": "b5f60754677f8557d753ee41c7b0aa383abef3b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MjQyNQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487982425", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { SelectedCategories } from \"../../../../tsrc/modules/SearchFacetsModule\";\n          \n          \n            \n            import type { SelectedCategories } from \"../../../../tsrc/modules/SearchFacetsModule\";", "author": "ChristianMurphy", "createdAt": "2020-09-14T14:36:27Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/CategorySelector.test.tsx", "diffHunk": "@@ -24,33 +24,33 @@ import {\n   RenderResult,\n   getAllByRole,\n } from \"@testing-library/react\";\n-import { FacetSelector } from \"../../../../tsrc/search/components/FacetSelector\";\n-import * as FacetSelectorMock from \"../../../../__mocks__/FacetSelector.mock\";\n+import { SelectedCategories } from \"../../../../tsrc/modules/SearchFacetsModule\";", "originalCommit": "b5f60754677f8557d753ee41c7b0aa383abef3b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "987b983506e0c1547013f61359957414c34181d0", "url": "https://github.com/openequella/openEQUELLA/commit/987b983506e0c1547013f61359957414c34181d0", "message": "added type annotations to tests", "committedDate": "2020-09-15T01:09:06Z", "type": "commit"}, {"oid": "f918bd06c59fbb4ee1f79144f1092812a43aeef8", "url": "https://github.com/openequella/openEQUELLA/commit/f918bd06c59fbb4ee1f79144f1092812a43aeef8", "message": "Refactor test to get Refine Panel, using getByText in react testing library", "committedDate": "2020-09-15T07:57:42Z", "type": "commit"}, {"oid": "4ea06b137de2a0ce7385bc2ba5a8fa60ca788a41", "url": "https://github.com/openequella/openEQUELLA/commit/4ea06b137de2a0ce7385bc2ba5a8fa60ca788a41", "message": "Merge branch 'component/new-search-page' into feature/refine-panel-accordion", "committedDate": "2020-09-16T04:15:16Z", "type": "commit"}, {"oid": "46dc7148d57297f070b6ff6e867f05ac2b84d689", "url": "https://github.com/openequella/openEQUELLA/commit/46dc7148d57297f070b6ff6e867f05ac2b84d689", "message": "Give the expansion handler a more specific name", "committedDate": "2020-09-16T04:21:18Z", "type": "commit"}, {"oid": "0d1a244ad558d5d56dfbc51db1e7a67c8d48760e", "url": "https://github.com/openequella/openEQUELLA/commit/0d1a244ad558d5d56dfbc51db1e7a67c8d48760e", "message": "Update RefineSearchPanel prop. I put too much trust in intellij's refactor functionality :/", "committedDate": "2020-09-16T04:45:44Z", "type": "commit"}]}