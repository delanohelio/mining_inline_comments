{"pr_number": 2188, "pr_title": "Search attachment Selector", "pr_createdAt": "2020-08-17T06:54:43Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/2188", "timeline": [{"oid": "9ce9b747ac6a561058ca8ee597bdc1215f355c41", "url": "https://github.com/openequella/openEQUELLA/commit/9ce9b747ac6a561058ca8ee597bdc1215f355c41", "message": "Add a new field 'searchAttachments' to OEQ.Search.SearchParams.", "committedDate": "2020-08-17T06:44:09Z", "type": "commit"}, {"oid": "87d3fc79f9aa2c6fb067ae436d1894e8e7413096", "url": "https://github.com/openequella/openEQUELLA/commit/87d3fc79f9aa2c6fb067ae436d1894e8e7413096", "message": "Create a new component as Search attachments Selector.\n\nThis selector provides two options: yes/no. When 'yes' is selected, attachments\nwill be included in searches. By default, 'yes' is selected. There is no Search\nsettings targeting this option so this component is always visible.", "committedDate": "2020-08-17T06:44:09Z", "type": "commit"}, {"oid": "3c36cabfaab6640e73bb586cb453b9875651a9f8", "url": "https://github.com/openequella/openEQUELLA/commit/3c36cabfaab6640e73bb586cb453b9875651a9f8", "message": "Create Storybook for SearchAttachmentsSelector", "committedDate": "2020-08-17T06:44:09Z", "type": "commit"}, {"oid": "ade2470ead342dee174986588de8be6d8b7ef0e0", "url": "https://github.com/openequella/openEQUELLA/commit/ade2470ead342dee174986588de8be6d8b7ef0e0", "message": "Create Jest tests for SearchAttachmentsSelector", "committedDate": "2020-08-17T06:44:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgwNTUxNg==", "url": "https://github.com/openequella/openEQUELLA/pull/2188#discussion_r471805516", "bodyText": "Nit: could we have a blank line above here please?", "author": "edalex-ian", "createdAt": "2020-08-17T22:18:12Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchAttachmentsSelector.tsx", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { Button, ButtonGroup } from \"@material-ui/core\";\n+import * as React from \"react\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface SearchAttachmentsSelectorProps {\n+  /**\n+   * A boolean value indicating whether 'yes' or 'no' is selected.\n+   * True if 'yes' is selected.\n+   */\n+  value?: boolean;\n+  /**\n+   * Fired when a different option is selected.\n+   * @param value A boolean representing the selected option.\n+   */\n+  onChange: (value: boolean) => void;\n+}\n+export const SearchAttachmentsSelector = ({", "originalCommit": "ade2470ead342dee174986588de8be6d8b7ef0e0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgwODIyOA==", "url": "https://github.com/openequella/openEQUELLA/pull/2188#discussion_r471808228", "bodyText": "Good to see this was done in its own commit. May've also been good to be in it's own PR, but considering it's only a one liner I can see why not. Hopefully soon we can look at moving this module to stand-alone. (Probably after we merge back to develop.\nBut... This should probably have a test to confirm that the definition of this param is correct - and is harnessed into the future. Would it be much effort to do such a test? (Ideally it'd be a simple positive/negative test calling with true/false.)", "author": "edalex-ian", "createdAt": "2020-08-17T22:25:32Z", "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -59,6 +59,10 @@ export interface SearchParams {\n    * single dynamic collection uuid.\n    */\n   dynaCollection?: string;\n+  /**\n+   * A flag indicating whether to search attachments or not.\n+   */\n+  searchAttachments?: boolean;", "originalCommit": "ade2470ead342dee174986588de8be6d8b7ef0e0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMDAzNg==", "url": "https://github.com/openequella/openEQUELLA/pull/2188#discussion_r471830036", "bodyText": "Perhaps leave a newline before beforeEach", "author": "SammyIsConfused", "createdAt": "2020-08-17T23:32:07Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -152,6 +152,45 @@ const getRefineSearchComponent = (\n   return e as HTMLElement;\n };\n \n+describe(\"Refine search by searching attachments\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {", "originalCommit": "ade2470ead342dee174986588de8be6d8b7ef0e0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMDQzNQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2188#discussion_r471830435", "bodyText": "I think this line is potentially redundant.", "author": "SammyIsConfused", "createdAt": "2020-08-17T23:33:34Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchAttachmentsSelector.tsx", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { Button, ButtonGroup } from \"@material-ui/core\";\n+import * as React from \"react\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface SearchAttachmentsSelectorProps {\n+  /**\n+   * A boolean value indicating whether 'yes' or 'no' is selected.\n+   * True if 'yes' is selected.", "originalCommit": "ade2470ead342dee174986588de8be6d8b7ef0e0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMTEzOQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2188#discussion_r471831139", "bodyText": "I could have sworn there was already language strings for yes and no somewhere \ud83e\udd14 Not exactly sure where but it would be good to reduce duplication.", "author": "SammyIsConfused", "createdAt": "2020-08-17T23:35:49Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchAttachmentsSelector.tsx", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { Button, ButtonGroup } from \"@material-ui/core\";\n+import * as React from \"react\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface SearchAttachmentsSelectorProps {\n+  /**\n+   * A boolean value indicating whether 'yes' or 'no' is selected.\n+   * True if 'yes' is selected.\n+   */\n+  value?: boolean;\n+  /**\n+   * Fired when a different option is selected.\n+   * @param value A boolean representing the selected option.\n+   */\n+  onChange: (value: boolean) => void;\n+}\n+export const SearchAttachmentsSelector = ({\n+  value,\n+  onChange,\n+}: SearchAttachmentsSelectorProps) => {\n+  const variant = (option?: boolean) => (option ? \"contained\" : \"outlined\");\n+  return (\n+    <ButtonGroup color=\"secondary\">\n+      <Button variant={variant(value)} onClick={() => onChange(true)}>\n+        {languageStrings.searchpage.searchAttachmentsSelector.yes}", "originalCommit": "ade2470ead342dee174986588de8be6d8b7ef0e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTg0Mzk1Mw==", "url": "https://github.com/openequella/openEQUELLA/pull/2188#discussion_r471843953", "bodyText": "As discussed we couldn't find one, but it makes more sense for it to be in common strings (yes and no will definitely be used by more than just the searchAttachmentsSelector)", "author": "SammyIsConfused", "createdAt": "2020-08-18T00:21:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMTEzOQ=="}], "type": "inlineReview"}, {"oid": "a513d1a44c0f54ea31427fcd0ff8cd41e58a4155", "url": "https://github.com/openequella/openEQUELLA/commit/a513d1a44c0f54ea31427fcd0ff8cd41e58a4155", "message": "More tidy ups for SearchAttachmentsSelector\n\n1. Move language strings 'Yes' and 'No' to the category of 'Common'\n   for future reuse.\n2. Remove redundant JSDoc and add blank lines to improve readability.", "committedDate": "2020-08-18T00:23:27Z", "type": "commit"}, {"oid": "2878b59d7c55ad2d0583a900441e5b5f62241e94", "url": "https://github.com/openequella/openEQUELLA/commit/2878b59d7c55ad2d0583a900441e5b5f62241e94", "message": "Add Jest tests to verify search param 'searchAttachments'.\n\nPlease note I added a '_' as the prefix of variable 'testName' because\n'noUnusedParameters' is true. Parameter name starting with '_' is exempt\nfrom that check.", "committedDate": "2020-08-18T00:41:56Z", "type": "commit"}]}