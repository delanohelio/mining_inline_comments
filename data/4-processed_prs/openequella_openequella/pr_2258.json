{"pr_number": 2258, "pr_title": "Add support to REST Module for new Search term highlights ", "pr_createdAt": "2020-09-07T05:58:47Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/2258", "timeline": [{"oid": "d196c4033c7e31665516bb923032c279fb75ba84", "url": "https://github.com/openequella/openEQUELLA/commit/d196c4033c7e31665516bb923032c279fb75ba84", "message": "oeq-ts-rest-api: Add support for Search highlight terms\n\nIncludes defining an interface for the returned results. The one being used was not actually what was being used on the server side. It was similar, but different - especially in that it included the pagination token stuff.", "committedDate": "2020-09-07T05:49:23Z", "type": "commit"}, {"oid": "5110f4d675a71abf0c84e532ac4f5621cf07bbb5", "url": "https://github.com/openequella/openEQUELLA/commit/5110f4d675a71abf0c84e532ac4f5621cf07bbb5", "message": "front-end: Update interaction with Search for new interface\n\nInterface was changed in oeq-ts-rest-api to support the new `hightlight` property in the result model.", "committedDate": "2020-09-07T05:50:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU4NDQyMg==", "url": "https://github.com/openequella/openEQUELLA/pull/2258#discussion_r484584422", "bodyText": "I wonder if highlight can be optional or not because a search may not have a query.", "author": "PenghaiZhang", "createdAt": "2020-09-07T23:21:12Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SearchModule.ts", "diffHunk": "@@ -102,11 +102,12 @@ export const defaultSearchOptions: SearchOptions = {\n   searchAttachments: true,\n };\n \n-export const defaultPagedSearchResult: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem> = {\n+export const defaultPagedSearchResult: OEQ.Search.SearchResult<OEQ.Search.SearchResultItem> = {\n   start: 0,\n   length: 10,\n   available: 10,\n   results: [],\n+  highlight: [],", "originalCommit": "5110f4d675a71abf0c84e532ac4f5621cf07bbb5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTI3OTk4NA==", "url": "https://github.com/openequella/openEQUELLA/pull/2258#discussion_r485279984", "bodyText": "The server always returns it.... Which I like as then there doesn't need to be the additional handling for values that may or may not be there.", "author": "edalex-ian", "createdAt": "2020-09-09T01:16:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU4NDQyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU4NzIzNQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2258#discussion_r484587235", "bodyText": "As mentioned above, can hightlight be optional ?", "author": "PenghaiZhang", "createdAt": "2020-09-07T23:42:52Z", "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -240,6 +240,32 @@ export interface SearchResultItem {\n   };\n }\n \n+/**\n+ * Represents the results for a search query.\n+ */\n+export interface SearchResult<T> {\n+  /**\n+   * The starting offset into the total search results\n+   */\n+  start: number;\n+  /**\n+   * How many results can be found in `results`\n+   */\n+  length: number;\n+  /**\n+   * The maximum number of results available for paging\n+   */\n+  available: number;\n+  /**\n+   * The individual items which match the search\n+   */\n+  results: T[];\n+  /**\n+   * List of words to use to highlight when displaying the results\n+   */\n+  highlight: string[];", "originalCommit": "5110f4d675a71abf0c84e532ac4f5621cf07bbb5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTI4MDI2Mg==", "url": "https://github.com/openequella/openEQUELLA/pull/2258#discussion_r485280262", "bodyText": "The server always returns it, just leaves it  as an empty array if there are no highlights - say, from an empty query.", "author": "edalex-ian", "createdAt": "2020-09-09T01:17:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU4NzIzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDkwOTM3NQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2258#discussion_r484909375", "bodyText": "is all of lodash needed in this scope?\nWould\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import * as _ from \"lodash\";\n          \n          \n            \n            import { range } from \"lodash\";\n          \n      \n    \n    \n  \n\nwork? (would also need a change from _.range to range below, on line 312)", "author": "ChristianMurphy", "createdAt": "2020-09-08T13:20:23Z", "path": "Source/Plugins/Core/com.equella.core/js/__mocks__/SearchResult.mock.ts", "diffHunk": "@@ -16,15 +16,19 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import * as _ from \"lodash\";", "originalCommit": "5110f4d675a71abf0c84e532ac4f5621cf07bbb5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTI4MDUzNQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2258#discussion_r485280535", "bodyText": "I'd say so. I just replaced like for like. I'll give it a tweak. \ud83d\ude09", "author": "edalex-ian", "createdAt": "2020-09-09T01:18:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDkwOTM3NQ=="}], "type": "inlineReview"}, {"oid": "bf4e0b61e24379ef2df18e8cda3dc828553f6d3e", "url": "https://github.com/openequella/openEQUELLA/commit/bf4e0b61e24379ef2df18e8cda3dc828553f6d3e", "message": "front-end: Only import range for SearchResult.mock.ts", "committedDate": "2020-09-09T01:40:27Z", "type": "commit"}]}