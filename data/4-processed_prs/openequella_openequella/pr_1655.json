{"pr_number": 1655, "pr_title": "Feature/boost settings", "pr_createdAt": "2020-04-24T04:43:56Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/1655", "timeline": [{"oid": "3efafd9257796bc88542df6082b9d006781d77d8", "url": "https://github.com/openequella/openEQUELLA/commit/3efafd9257796bc88542df6082b9d006781d77d8", "message": "Seach boosting sliders i did all by myself", "committedDate": "2020-04-24T04:22:41Z", "type": "commit"}, {"oid": "2d7830c04b54067154f921bafb1ee21bbd35d6a1", "url": "https://github.com/openequella/openEQUELLA/commit/2d7830c04b54067154f921bafb1ee21bbd35d6a1", "message": "formatting changes", "committedDate": "2020-04-24T04:30:22Z", "type": "commit"}, {"oid": "ed3819a455cd25f954de770f87182bdb95a52bc5", "url": "https://github.com/openequella/openEQUELLA/commit/ed3819a455cd25f954de770f87182bdb95a52bc5", "message": "moved ariaText function to constant", "committedDate": "2020-04-24T04:56:22Z", "type": "commit"}, {"oid": "5d7d9dca24492403e1d81dafd5612a67b1307862", "url": "https://github.com/openequella/openEQUELLA/commit/5d7d9dca24492403e1d81dafd5612a67b1307862", "message": "Merge branch 'component/search_configuration' into feature/boost-settings", "committedDate": "2020-04-24T05:21:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM0NTE0Ng==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r414345146", "bodyText": "If we can move this to langstrings,  then we could also remove  sliderMarks .", "author": "PenghaiZhang", "createdAt": "2020-04-24T07:07:08Z", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/Search/ContentIndexSettings.tsx", "diffHunk": "@@ -46,8 +46,21 @@ function ContentIndexSettings({ updateTemplate }: TemplateUpdateProps) {\n \n   const contentIndexSettingsStrings =\n     languageStrings.settings.searching.contentIndexSettings;\n+\n+  const markStrings = contentIndexSettingsStrings.sliderMarks;\n   const classes = useStyles();\n \n+  const boostVals: Mark[] = [\n+    { label: markStrings.off, value: 0 },\n+    { label: \"x0.25\", value: 1 },\n+    { label: \"x0.5\", value: 2 },\n+    { label: markStrings.noBoost, value: 3 },\n+    { label: \"x1.5\", value: 4 },\n+    { label: \"x2\", value: 5 },\n+    { label: \"x4\", value: 6 },\n+    { label: \"x8\", value: 7 },\n+  ];", "originalCommit": "5d7d9dca24492403e1d81dafd5612a67b1307862", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY2Nzc2MQ==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417667761", "bodyText": "I didn't really think the slider marks containing numbers needed to be in language strings", "author": "mrblippy", "createdAt": "2020-04-29T23:19:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM0NTE0Ng=="}], "type": "inlineReview"}, {"oid": "9b628081023ec2eda3c4bf02b65b7bede7bb69df", "url": "https://github.com/openequella/openEQUELLA/commit/9b628081023ec2eda3c4bf02b65b7bede7bb69df", "message": "Beginnings of ContentIndexing jest test", "committedDate": "2020-04-29T06:26:10Z", "type": "commit"}, {"oid": "fc8c9da74d0b8aea335f7a51a572ef55779c3517", "url": "https://github.com/openequella/openEQUELLA/commit/fc8c9da74d0b8aea335f7a51a572ef55779c3517", "message": "Merge branch 'feature/boost-settings' of https://github.com/mrblippy/Charliequella into feature/boost-settings", "committedDate": "2020-04-29T06:29:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY2OTUwOA==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417669508", "bodyText": "Can remove this line.", "author": "PenghaiZhang", "createdAt": "2020-04-29T23:25:05Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");", "originalCommit": "fc8c9da74d0b8aea335f7a51a572ef55779c3517", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY5NDc4Mg==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417694782", "bodyText": "OOOhhhh no, I was definitely meant to remove that", "author": "mrblippy", "createdAt": "2020-04-30T00:49:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY2OTUwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY2OTgzNw==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417669837", "bodyText": "I think we can use jest.fn instead of () => null ?", "author": "PenghaiZhang", "createdAt": "2020-04-29T23:26:04Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");\n+            resolve(SearchSettingsModule.defaultSearchSettings);\n+          }\n+        )\n+    );\n+\n+  const renderComponent = () =>\n+    mount(<ContentIndexSettings updateTemplate={() => null} />);", "originalCommit": "fc8c9da74d0b8aea335f7a51a572ef55779c3517", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzcwNjc1NA==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417706754", "bodyText": "Yep, it seems fine with that change", "author": "mrblippy", "createdAt": "2020-04-30T01:35:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY2OTgzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY3NzQwMQ==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417677401", "bodyText": "Can we just use () => Promise.resolve(SearchSettingsModule.defaultSearchSettings) in the mockImplementation block?", "author": "PenghaiZhang", "createdAt": "2020-04-29T23:50:08Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");\n+            resolve(SearchSettingsModule.defaultSearchSettings);\n+          }\n+        )", "originalCommit": "9b628081023ec2eda3c4bf02b65b7bede7bb69df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY5NzMwNQ==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417697305", "bodyText": "That would certainly be a lot more concise", "author": "mrblippy", "createdAt": "2020-04-30T00:58:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY3NzQwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY3OTg2Ng==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417679866", "bodyText": "This expect does not match the description. We can have another it for testing if getSearchSettingsFromServer has been called in the useEffect.", "author": "PenghaiZhang", "createdAt": "2020-04-29T23:57:51Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");\n+            resolve(SearchSettingsModule.defaultSearchSettings);\n+          }\n+        )\n+    );\n+\n+  const renderComponent = () =>\n+    mount(<ContentIndexSettings updateTemplate={() => null} />);\n+\n+  describe(\"When content indexing settings page page is loaded\", () => {\n+    const component = renderComponent();\n+    const listControls = component.find(SettingsList);\n+    const defaultVals = SearchSettingsModule.defaultSearchSettings;\n+\n+    it(\"should display the default values\", () => {\n+      expect(listControls.length).toBeGreaterThanOrEqual(2);\n+      expect(\n+        SearchSettingsModule.getSearchSettingsFromServer\n+      ).toHaveBeenCalledTimes(1);", "originalCommit": "9b628081023ec2eda3c4bf02b65b7bede7bb69df", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY5MzUzMw==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417693533", "bodyText": "I think we can skip findWhere for Content indexing.", "author": "PenghaiZhang", "createdAt": "2020-04-30T00:44:22Z", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");\n+            resolve(SearchSettingsModule.defaultSearchSettings);\n+          }\n+        )\n+    );\n+\n+  const renderComponent = () =>\n+    mount(<ContentIndexSettings updateTemplate={() => null} />);\n+\n+  describe(\"When content indexing settings page page is loaded\", () => {\n+    const component = renderComponent();\n+    const listControls = component.find(SettingsList);\n+    const defaultVals = SearchSettingsModule.defaultSearchSettings;\n+\n+    it(\"should display the default values\", () => {\n+      expect(listControls.length).toBeGreaterThanOrEqual(2);\n+      expect(\n+        SearchSettingsModule.getSearchSettingsFromServer\n+      ).toHaveBeenCalledTimes(1);\n+\n+      //content indexing stuff\n+      const contentIndex = listControls\n+        .findWhere((c) => c.prop(\"primaryText\") === \"Content indexing\")", "originalCommit": "9b628081023ec2eda3c4bf02b65b7bede7bb69df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzcwNjg5OA==", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417706898", "bodyText": "Oh yeah, of course. Since there is only one of those components on the page", "author": "mrblippy", "createdAt": "2020-04-30T01:35:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY5MzUzMw=="}], "type": "inlineReview"}, {"oid": "7c331e9ee71b6225891f181b7069680e656e30bb", "url": "https://github.com/openequella/openEQUELLA/commit/7c331e9ee71b6225891f181b7069680e656e30bb", "message": "Refactor config.ts\n\nThis file only seems to be for the course editor (?), but we could\nupdate it to use modern syntax and also provide safer results. Without\nthis, it was causing the new Jest tests to fail due to execution on\nimport.", "committedDate": "2020-04-30T01:01:16Z", "type": "commit"}, {"oid": "28db3cacff1c6c8047cbc667557920324314a769", "url": "https://github.com/openequella/openEQUELLA/commit/28db3cacff1c6c8047cbc667557920324314a769", "message": "autotest pr feedback", "committedDate": "2020-04-30T01:38:08Z", "type": "commit"}, {"oid": "3bf49fcb1e45ecfdc024b1a0dd75ef17931d5cde", "url": "https://github.com/openequella/openEQUELLA/commit/3bf49fcb1e45ecfdc024b1a0dd75ef17931d5cde", "message": "Property setup lazy loading for RichTextEditor\n\nThe RichTextEditor pulls in the whole of TinyMCE which has some code\nthat will execute on import. This code was breaking the new Jest test as\nit was expecting various values to be pulled from the `window` object.\n\nLazily loading, helps with both of these.\n\nHowever, this is not splitting the bundle, as parcel does not support\nthis form of code splitting.", "committedDate": "2020-04-30T05:59:07Z", "type": "commit"}]}