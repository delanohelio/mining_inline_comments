{"pr_number": 173, "pr_title": "Bug/flex 5258 fix optional get", "pr_createdAt": "2020-02-14T12:23:13Z", "pr_url": "https://github.com/OSGP/open-smart-grid-platform/pull/173", "timeline": [{"oid": "8ee528fcd724ceefbb105672b67fd8b907c392b5", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/8ee528fcd724ceefbb105672b67fd8b907c392b5", "message": "FLEX-5258 ~ Fixes sonar \"Optional\" warnings", "committedDate": "2020-02-14T09:22:59Z", "type": "commit"}, {"oid": "d5ebe25233806b905f72ba80e970c2605b6111c3", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/d5ebe25233806b905f72ba80e970c2605b6111c3", "message": "FLEX-5258 ~ Minor refactoring (call map on Optional instead of Stream)", "committedDate": "2020-02-14T12:17:44Z", "type": "commit"}, {"oid": "79612f29fb4cec8622a13af24ce17860da7c4d2f", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/79612f29fb4cec8622a13af24ce17860da7c4d2f", "message": "FLEX-5258 ~ Minor refactoring (Call map on Optional instead of Stream)", "committedDate": "2020-02-14T12:22:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEwODY0OQ==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/173#discussion_r380108649", "bodyText": "No issues with this change on itself.\nTrying to understand if the chosen exception is the appropriate way to go, I looked at where this code is called from (createSsldPendingFirmwareUpdateRecord).\nBefore this method (and getFirmwareVersion from the other fix) is called the map is asserted to have exactly one element. Because of that assertion the exception here will never be triggered, since the stream on the maps entry set (or values) always has a single element.\nThe code could be simplified by obtaining the first Entry<FirmwareModule, String> (which is there because of the earlier assertion) and using its key to determine firmwareModuleType and its value as firmwareVersion.\nThat said, the code does what it needs to do. As far as I'm concerned you can check how strongly you (dis)agree about further changes being an improvement, and decide whether to leave it, or update it some more.", "author": "bvdzwet", "createdAt": "2020-02-17T10:45:34Z", "path": "osgp/platform/osgp-adapter-domain-core/src/main/java/org/opensmartgridplatform/adapter/domain/core/application/services/FirmwareManagementService.java", "diffHunk": "@@ -147,12 +148,18 @@ private static String getFirmwareFilename(final String firmwareUrl) {\n     }\n \n     private static FirmwareModuleType getFirmwareModuleType(final Map<FirmwareModule, String> firmwareModuleVersions) {\n-        final FirmwareModule firmwareModule = firmwareModuleVersions.keySet().stream().findFirst().get();\n-        return FirmwareModuleType.valueOf(firmwareModule.getDescription().toUpperCase());\n+        return firmwareModuleVersions.keySet()\n+                .stream()\n+                .findFirst()\n+                .map(fwModuleVersion -> FirmwareModuleType.valueOf(fwModuleVersion.getDescription().toUpperCase()))\n+                .orElseThrow(() -> new NoSuchElementException(\"No entries present in firmwareModuleVersions map.\"));", "originalCommit": "79612f29fb4cec8622a13af24ce17860da7c4d2f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d0fa4e345083b2b106e7e4e17265e8f0b6d023c2", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/d0fa4e345083b2b106e7e4e17265e8f0b6d023c2", "message": "FLEX-5258 ~ Processes review comment", "committedDate": "2020-02-17T15:30:58Z", "type": "commit"}]}