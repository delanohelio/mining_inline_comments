{"pr_number": 1124, "pr_title": "Run checkstyle, pmd, lint, javadocJar, and sourcesJar also for assembleDistRelease", "pr_createdAt": "2020-08-07T00:58:11Z", "pr_url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124", "timeline": [{"oid": "67660cf1d1cc392f4f4f8e5f9026d8b5eae2f7ed", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/67660cf1d1cc392f4f4f8e5f9026d8b5eae2f7ed", "message": "Run checkstyle, pmd, lint, javadocJar, and sourcesJar also for\nassembleDistRelease", "committedDate": "2020-08-07T00:55:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MzQ4OA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r466763488", "bodyText": "What about the other tasks?", "author": "shahzaibj", "createdAt": "2020-08-07T01:00:33Z", "path": "msal/build.gradle", "diffHunk": "@@ -277,7 +277,7 @@ publishing {\n }\n \n tasks.whenTaskAdded { task ->\n-    if (task.name == 'assembleDebug' || task.name == 'assembleRelease') {\n+    if (task.name == 'assembleDebug' || task.name == 'assembleRelease' || task.name == 'assembleDistRelease') {", "originalCommit": "67660cf1d1cc392f4f4f8e5f9026d8b5eae2f7ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MzU0NQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r466763545", "bodyText": "There are more assemble tasks - let's run for all of them", "author": "shahzaibj", "createdAt": "2020-08-07T01:00:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MzQ4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2NDI2NQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r466764265", "bodyText": "Good point, that way we catch lint and other errors early", "author": "kreedula", "createdAt": "2020-08-07T01:03:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MzQ4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzEyOTYwOQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r467129609", "bodyText": "These are our current assemble variants -- I don't think we necessarily want to enable this for assembleSnapshot (as it will slow that build down, generate unused artifacts). We could do task.name.contains('assemble') && !task.name.equals('assembleSnapshot').\nThoughts? @shahzaibj\nbrianmel@brianmel-devbox MINGW64 /c/dev/android-complete/msal (iambmelt/simple-build-prep)\n$ ./gradlew tasks | egrep assemble\nassemble - Assemble main outputs for all the variants.\nassembleAndroidTest - Assembles all the Test applications.\nassembleDebug - Assembles main outputs for all Debug variants.\nassembleDist - Assembles main outputs for all Dist variants.\nassembleLocal - Assembles main outputs for all Local variants.\nassembleRelease - Assembles main outputs for all Release variants.\nassembleSnapshot - Assembles main outputs for all Snapshot variants.", "author": "iambmelt", "createdAt": "2020-08-07T16:00:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MzQ4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE1OTc0Mw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r467159743", "bodyText": "I think there are even more tasks actually:\n- assemble\n- assembleLocal\n- assembleLocalDebug\n- assembleLocalRelease\n- assembleSnapshot\n- assembleSnapshotDebug\n- assembleSnapshotRelease\n- assembleDist\n- assembleDistDebug\n- assembleDistRelease \n\nThere's actually even more tasks for testing (assembleLocalReleaseUnitTest and many more)....I didn't list them here.\nIf we want to avoid running for snapshot, then I think we want to avoid for each build type of snapshot (debug vs release vs task for assemble test).\nMay be we can do this:\nif (task.name.contains('assemble') && !task.name.contains('Snapshot'))\nbut most likely we also want to avoid the test tasks so then, we can do like:\nif (task.name.contains('assemble') && !task.name.contains('Snapshot') && !task.name.contains('Test'))\nI'd leave up to you to decide how want to do it @iambmelt .\nAlso if @kreedula has any input.", "author": "shahzaibj", "createdAt": "2020-08-07T16:59:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MzQ4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE3MzIwMQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r467173201", "bodyText": "See 653bf38", "author": "iambmelt", "createdAt": "2020-08-07T17:26:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MzQ4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2NDA3Mg==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r466764072", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                if (task.name == 'assembleDebug' || task.name == 'assembleRelease' || task.name == 'assembleDistRelease') {\n          \n          \n            \n                if (task.name.contains(\"assemble\")) {", "author": "shahzaibj", "createdAt": "2020-08-07T01:03:00Z", "path": "msal/build.gradle", "diffHunk": "@@ -277,7 +277,7 @@ publishing {\n }\n \n tasks.whenTaskAdded { task ->\n-    if (task.name == 'assembleDebug' || task.name == 'assembleRelease') {\n+    if (task.name == 'assembleDebug' || task.name == 'assembleRelease' || task.name == 'assembleDistRelease') {", "originalCommit": "67660cf1d1cc392f4f4f8e5f9026d8b5eae2f7ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2NDEzNA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r466764134", "bodyText": "We can do something like this I think", "author": "shahzaibj", "createdAt": "2020-08-07T01:03:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2NDA3Mg=="}], "type": "inlineReview"}, {"oid": "1a9291f25466257530fecc9722138befb3079cc7", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/1a9291f25466257530fecc9722138befb3079cc7", "message": "Merge branch 'dev' into iambmelt/simple-build-prep", "committedDate": "2020-08-07T16:01:00Z", "type": "commit"}, {"oid": "54ea24f4600b840663510c823c504b97abc8258c", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/54ea24f4600b840663510c823c504b97abc8258c", "message": "Exclude test, snapshot from javadoc, pmd, checkstyle, etc", "committedDate": "2020-08-07T17:10:48Z", "type": "commit"}, {"oid": "b1f964d2bf3499e50282356b43edb9557f378118", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/b1f964d2bf3499e50282356b43edb9557f378118", "message": "Merge branch 'iambmelt/simple-build-prep' of https://github.com/AzureAD/microsoft-authentication-library-for-android into iambmelt/simple-build-prep", "committedDate": "2020-08-07T17:11:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE2ODQ2Ng==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r467168466", "bodyText": "I think it's better to have two separate if loops\nif (task.name.contains('assemble')) { task.dependsOn 'checkstyle', 'pmd', 'lint' }\nif (task.name.contains('assemble') && !task.name.contains('Snapshot') && !task.name.contains('Test')) { task.dependsOn  'javadocJar', 'sourcesJar' }\t    }", "author": "kreedula", "createdAt": "2020-08-07T17:17:06Z", "path": "msal/build.gradle", "diffHunk": "@@ -277,7 +277,7 @@ publishing {\n }\n \n tasks.whenTaskAdded { task ->\n-    if (task.name == 'assembleDebug' || task.name == 'assembleRelease') {\n+    if (task.name.contains('assemble') && !task.name.contains('Snapshot') && !task.name.contains('Test')) {", "originalCommit": "b1f964d2bf3499e50282356b43edb9557f378118", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE3MzE0MA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r467173140", "bodyText": "653bf38", "author": "iambmelt", "createdAt": "2020-08-07T17:26:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE2ODQ2Ng=="}], "type": "inlineReview"}, {"oid": "653bf3835853ae48449895940f772c68164a4856", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/653bf3835853ae48449895940f772c68164a4856", "message": "CR suggestion on build stages", "committedDate": "2020-08-07T17:25:49Z", "type": "commit"}, {"oid": "f5e9ae86e2b54ea5e81b85343daaf6843b9c3062", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/f5e9ae86e2b54ea5e81b85343daaf6843b9c3062", "message": "Update submodule", "committedDate": "2020-08-07T17:44:50Z", "type": "commit"}, {"oid": "9172c9fd02d00e00ffa1108d579affeb295dd7cb", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/9172c9fd02d00e00ffa1108d579affeb295dd7cb", "message": "Fix build warning related to character encoding in javadoc", "committedDate": "2020-08-07T18:12:05Z", "type": "commit"}, {"oid": "da2fc37bfbca71501f556f8baaa723d1df72d0a9", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/da2fc37bfbca71501f556f8baaa723d1df72d0a9", "message": "Moving lint task, because this also apparently triggers dist tasks?\nStrange.... working around", "committedDate": "2020-08-07T18:31:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMwNTU3NA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r467305574", "bodyText": "Don't we want lint for local?", "author": "AdamBJohnsonx", "createdAt": "2020-08-07T22:03:17Z", "path": "msal/build.gradle", "diffHunk": "@@ -277,7 +277,14 @@ publishing {\n }\n \n tasks.whenTaskAdded { task ->\n-    if (task.name == 'assembleDebug' || task.name == 'assembleRelease') {\n-        task.dependsOn 'checkstyle', 'pmd', 'lint', 'javadocJar', 'sourcesJar'\n+    if (task.name.contains('assemble')) {\n+        task.dependsOn 'checkstyle', 'pmd'\n+    }\n+\n+    if (task.name.contains('assemble')\n+        && !task.name.contains('Snapshot')\n+        && !task.name.contains('Test')\n+        && !task.name.contains('Local')) {", "originalCommit": "da2fc37bfbca71501f556f8baaa723d1df72d0a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMwNjI4MA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r467306280", "bodyText": "See commit message for da2fc37\nRunning lint was also running dist tasks for reasons I didn't fully troubleshoot", "author": "iambmelt", "createdAt": "2020-08-07T22:05:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMwNTU3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMwNjY1Mg==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1124#discussion_r467306652", "bodyText": "(Try it locally, you'll see a dist build kickoff and subsequently fail)", "author": "iambmelt", "createdAt": "2020-08-07T22:06:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMwNTU3NA=="}], "type": "inlineReview"}]}