{"pr_number": 14349, "pr_title": "Fixing date type handling in Presto-Pinot Connector", "pr_createdAt": "2020-04-06T19:01:27Z", "pr_url": "https://github.com/prestodb/presto/pull/14349", "timeline": [{"oid": "d9a1598e91e266555765072cc4251fda16ccba1f", "url": "https://github.com/prestodb/presto/commit/d9a1598e91e266555765072cc4251fda16ccba1f", "message": "fixing date type in pinot-connector", "committedDate": "2020-04-06T19:05:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTgyNzYwOQ==", "url": "https://github.com/prestodb/presto/pull/14349#discussion_r405827609", "bodyText": "Why parseDouble and then convert that to int instead of directly parsing to int ?", "author": "agrawaldevesh", "createdAt": "2020-04-08T21:32:04Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotBrokerPageSource.java", "diffHunk": "@@ -147,6 +148,9 @@ else if (type instanceof DecimalType || type instanceof DoubleType) {\n             else if (type instanceof TimestampType) {\n                 type.writeLong(blockBuilder, parseLong(value));\n             }\n+            else if (type instanceof DateType) {\n+                blockBuilder.writeInt(parseDouble(value).intValue());", "originalCommit": "1b0ee4f3af13e039b8ba69f22d9621d79bf085d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTgyODYyNA==", "url": "https://github.com/prestodb/presto/pull/14349#discussion_r405828624", "bodyText": "as for some queries like max/min, pinot will return a double value in the format of \"16453.0000\". So we need to parse a double first, then convert to int.", "author": "xiangfu0", "createdAt": "2020-04-08T21:34:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTgyNzYwOQ=="}], "type": "inlineReview"}, {"oid": "996f85d9944b299d49b578e978882db2e817d31b", "url": "https://github.com/prestodb/presto/commit/996f85d9944b299d49b578e978882db2e817d31b", "message": "fixing date type in pinot-connector", "committedDate": "2020-04-09T03:06:38Z", "type": "forcePushed"}, {"oid": "afb83d90318d2d17edbad744e19277c41ea3fd96", "url": "https://github.com/prestodb/presto/commit/afb83d90318d2d17edbad744e19277c41ea3fd96", "message": "fixing date type in pinot-connector", "committedDate": "2020-04-09T08:01:33Z", "type": "commit"}, {"oid": "afb83d90318d2d17edbad744e19277c41ea3fd96", "url": "https://github.com/prestodb/presto/commit/afb83d90318d2d17edbad744e19277c41ea3fd96", "message": "fixing date type in pinot-connector", "committedDate": "2020-04-09T08:01:33Z", "type": "forcePushed"}]}