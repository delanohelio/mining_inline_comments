{"pr_number": 15059, "pr_title": "Remove QueryInfo from DispatchManager", "pr_createdAt": "2020-08-21T04:14:21Z", "pr_url": "https://github.com/prestodb/presto/pull/15059", "timeline": [{"oid": "7b35caa24f4e51819ae54a3b31da11a2e080c44d", "url": "https://github.com/prestodb/presto/commit/7b35caa24f4e51819ae54a3b31da11a2e080c44d", "message": "Add ExecutionFailureInfo to BasicQueryInfo", "committedDate": "2020-08-21T18:22:45Z", "type": "forcePushed"}, {"oid": "4a0b7b6fcb7ebc31d4d8a48e1f5529793fbf8d21", "url": "https://github.com/prestodb/presto/commit/4a0b7b6fcb7ebc31d4d8a48e1f5529793fbf8d21", "message": "Add ExecutionFailureInfo to BasicQueryInfo", "committedDate": "2020-08-21T20:47:21Z", "type": "forcePushed"}, {"oid": "8b4e904dedc38297798aaa2c513b29632d22d33f", "url": "https://github.com/prestodb/presto/commit/8b4e904dedc38297798aaa2c513b29632d22d33f", "message": "Add ExecutionFailureInfo to BasicQueryInfo", "committedDate": "2020-08-21T21:40:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ0OTgyOA==", "url": "https://github.com/prestodb/presto/pull/15059#discussion_r481449828", "bodyText": "Not sure if it worths adding parenthesis to make it clearer :)\n(failureInfo != null && failureInfo.getErrorCode() != null) ? failureInfo.getErrorCode().getType() : null", "author": "shixuan-fan", "createdAt": "2020-09-01T21:45:21Z", "path": "presto-main/src/main/java/com/facebook/presto/server/BasicQueryInfo.java", "diffHunk": "@@ -88,6 +97,36 @@ public BasicQueryInfo(\n         this.warnings = requireNonNull(warnings, \"warnings is null\");\n     }\n \n+    public BasicQueryInfo(\n+            QueryId queryId,\n+            SessionRepresentation session,\n+            Optional<ResourceGroupId> resourceGroupId,\n+            QueryState state,\n+            MemoryPoolId memoryPool,\n+            boolean scheduled,\n+            URI self,\n+            String query,\n+            BasicQueryStats queryStats,\n+            ExecutionFailureInfo failureInfo,\n+            Optional<QueryType> queryType,\n+            List<PrestoWarning> warnings)\n+    {\n+        this(\n+                queryId,\n+                session,\n+                resourceGroupId,\n+                state,\n+                memoryPool,\n+                scheduled,\n+                self,\n+                query,\n+                queryStats,\n+                failureInfo != null && failureInfo.getErrorCode() != null ? failureInfo.getErrorCode().getType() : null,", "originalCommit": "8b4e904dedc38297798aaa2c513b29632d22d33f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "16cfeaaad4e367f50b255168b612f1c654a4db62", "url": "https://github.com/prestodb/presto/commit/16cfeaaad4e367f50b255168b612f1c654a4db62", "message": "Add ExecutionFailureInfo to BasicQueryInfo", "committedDate": "2020-09-02T03:18:31Z", "type": "forcePushed"}, {"oid": "cc827473a6b781c3484657daa7e66fb3cf3f63a9", "url": "https://github.com/prestodb/presto/commit/cc827473a6b781c3484657daa7e66fb3cf3f63a9", "message": "Remove QueryInfo from DispatchManager\n\nQueryInfo is a large class which is expensive to serialize,\nand is not necessary prior to query execution.", "committedDate": "2020-09-02T04:01:10Z", "type": "commit"}, {"oid": "674d3da5a20b600d4a6889ca82cac2bda9e18f17", "url": "https://github.com/prestodb/presto/commit/674d3da5a20b600d4a6889ca82cac2bda9e18f17", "message": "Add ExecutionFailureInfo to BasicQueryInfo", "committedDate": "2020-09-02T04:01:11Z", "type": "commit"}, {"oid": "674d3da5a20b600d4a6889ca82cac2bda9e18f17", "url": "https://github.com/prestodb/presto/commit/674d3da5a20b600d4a6889ca82cac2bda9e18f17", "message": "Add ExecutionFailureInfo to BasicQueryInfo", "committedDate": "2020-09-02T04:01:11Z", "type": "forcePushed"}]}