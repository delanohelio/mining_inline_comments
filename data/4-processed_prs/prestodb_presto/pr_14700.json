{"pr_number": 14700, "pr_title": "Include table name and parquet file name in error message on schema mismatch", "pr_createdAt": "2020-06-22T22:15:04Z", "pr_url": "https://github.com/prestodb/presto/pull/14700", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg3NDMwMQ==", "url": "https://github.com/prestodb/presto/pull/14700#discussion_r443874301", "bodyText": "we could use SchemaTableName.toString()", "author": "zhenxiao", "createdAt": "2020-06-22T23:13:12Z", "path": "presto-hive/src/main/java/com/facebook/presto/hive/parquet/ParquetPageSourceFactory.java", "diffHunk": "@@ -310,9 +316,12 @@ else if (column.getHiveColumnIndex() < messageType.getFieldCount()) {\n                 group.writeToStringBuilder(builder, \"\");\n                 parquetTypeName = builder.toString();\n             }\n-            throw new PrestoException(HIVE_PARTITION_SCHEMA_MISMATCH, format(\"The column %s is declared as type %s, but the Parquet file declares the column as type %s\",\n+            throw new PrestoException(HIVE_PARTITION_SCHEMA_MISMATCH, format(\"The column %s of table %s.%s is declared as type %s, but the Parquet file (%s) declares the column as type %s\",", "originalCommit": "0a5c674d7db40f6f17dad2fd2d9df4b798bffcad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg4MTgxMQ==", "url": "https://github.com/prestodb/presto/pull/14700#discussion_r443881811", "bodyText": "Fixed", "author": "ClarenceThreepwood", "createdAt": "2020-06-22T23:39:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg3NDMwMQ=="}], "type": "inlineReview"}, {"oid": "caa01d8f3c7e833e10b11f1f68c8fbd5e2f56f00", "url": "https://github.com/prestodb/presto/commit/caa01d8f3c7e833e10b11f1f68c8fbd5e2f56f00", "message": "Include table name and parquet file name in error message on schema mismatch", "committedDate": "2020-06-23T20:52:28Z", "type": "commit"}, {"oid": "caa01d8f3c7e833e10b11f1f68c8fbd5e2f56f00", "url": "https://github.com/prestodb/presto/commit/caa01d8f3c7e833e10b11f1f68c8fbd5e2f56f00", "message": "Include table name and parquet file name in error message on schema mismatch", "committedDate": "2020-06-23T20:52:28Z", "type": "forcePushed"}]}