{"pr_number": 14312, "pr_title": "Add documentation for KHyperLogLog", "pr_createdAt": "2020-03-31T05:17:58Z", "pr_url": "https://github.com/prestodb/presto/pull/14312", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1Njg5NQ==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400656895", "bodyText": "nit: remove function. Usually we just reference the function with the link.", "author": "caithagoras", "createdAt": "2020-03-31T05:45:41Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA0NjY2OA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r401046668", "bodyText": "Do you mean just surrounding it with double backquotes?", "author": "tdcmeehan", "createdAt": "2020-03-31T16:23:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1Njg5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE1MjM2MA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r401152360", "bodyText": "I mean removing the word function at the end of the sentence.\n... through :func:`khyperloglog_agg`.", "author": "caithagoras", "createdAt": "2020-03-31T19:13:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1Njg5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1NzAxNQ==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400657015", "bodyText": "Double backquotes:\n``MinHash``\n``HyperLogLog``", "author": "caithagoras", "createdAt": "2020-03-31T05:46:04Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA1NDE3MA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r401054170", "bodyText": "All these references to MinHash and HyperLogLog are referring to data structures and not some type in Presto.  I'm indifferent either way, but I was under the impression we'd use code formatting for Presto types that one might use in a SQL statement.  Or in other words, what's the rule for when we use monoformat?", "author": "tdcmeehan", "createdAt": "2020-03-31T16:35:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1NzAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTIwNDE4NQ==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r401204185", "bodyText": "makes sense", "author": "caithagoras", "createdAt": "2020-03-31T20:45:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1NzAxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1Nzg0MQ==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400657841", "bodyText": "Similar to HyperLogLog and P4HyperLogLog, create an entry with label in language/types.rst\n:ref:`hyperloglog_type` can be cast to and from ``varbinary`` ...", "author": "caithagoras", "createdAt": "2020-03-31T05:48:45Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE1NzQ1OA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r401157458", "bodyText": "This line is not updated yet. You can replace KHyperLogLog sketches  with\n:ref:`hyperloglog_type`", "author": "caithagoras", "createdAt": "2020-03-31T19:22:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1Nzg0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1ODA1NA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400658054", "bodyText": "``HyperLogLog``", "author": "caithagoras", "createdAt": "2020-03-31T05:49:28Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog\n+    sketches represent ``y`` values linked to ``x`` values.\n+\n+.. function:: cardinality(khll) -> bigint\n+    :noindex:\n+\n+    This calculates the cardinality of the MinHash sketch, i.e. ``x``'s cardinality\n+\n+.. function:: intersection_cardinality(khll1, khll2) ->  bigint\n+\n+    Returns the set intersection cardinality of the data represented by the MinHash\n+    structures of ``khll1`` and ``khll2``.\n+\n+.. function:: jaccard_index(khll1, khll2) ->  double\n+\n+    Returns the Jaccard index of the data represented by the MinHash structures of\n+    ``khll1`` and ``khll2``.\n+\n+.. function:: uniqueness_distribution(khll) ->  map<bigint,double>\n+\n+    For a certain value ``x'``, uniqueness is understood as how many ``y'`` values are\n+    associated to it in the source dataset. This is obtained with the cardinality\n+    of the HyperLogLog that is mapped from the MinHash bucket that corresponds to\n+    ``x'``. This function returns a histogram that represents the uniqueness\n+    distribution, the X-axis being ``uniqueness`` and the Y-axis being relative\n+    frequency of ``x`` values.\n+\n+.. function:: uniqueness_distribution(khll, histogramSize) ->  map<bigint,double>\n+\n+    Returns the uniqueness histogram with the given amount of buckets. If omitted,\n+    the value defaults to 256. All ``uniqueness``es greater than ``histogramSize`` are\n+    accumulated in the last bucket.\n+\n+.. function:: reidentification_potential(khll, threshold) ->  double\n+\n+    The reidentification potential is the ratio of ``x`` values that have a\n+    ``uniqueness`` under the given ``threshold``.\n+\n+.. function:: merge(khll) -> KHyperLogLog\n+    :noindex:\n+\n+    Returns the KHyperLogLog of the aggregate union of the individual KHyperLogLog\n+    structures.\n+\n+.. function:: merge_khll(array(khll)) -> HKyperLogLog\n+\n+    Returns the KHyperLogLog of the union of an array of KHyperLogLog structures.", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1ODA3OA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400658078", "bodyText": "``HyperLogLog``", "author": "caithagoras", "createdAt": "2020-03-31T05:49:32Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog\n+    sketches represent ``y`` values linked to ``x`` values.\n+\n+.. function:: cardinality(khll) -> bigint\n+    :noindex:\n+\n+    This calculates the cardinality of the MinHash sketch, i.e. ``x``'s cardinality\n+\n+.. function:: intersection_cardinality(khll1, khll2) ->  bigint\n+\n+    Returns the set intersection cardinality of the data represented by the MinHash\n+    structures of ``khll1`` and ``khll2``.\n+\n+.. function:: jaccard_index(khll1, khll2) ->  double\n+\n+    Returns the Jaccard index of the data represented by the MinHash structures of\n+    ``khll1`` and ``khll2``.\n+\n+.. function:: uniqueness_distribution(khll) ->  map<bigint,double>\n+\n+    For a certain value ``x'``, uniqueness is understood as how many ``y'`` values are\n+    associated to it in the source dataset. This is obtained with the cardinality\n+    of the HyperLogLog that is mapped from the MinHash bucket that corresponds to\n+    ``x'``. This function returns a histogram that represents the uniqueness\n+    distribution, the X-axis being ``uniqueness`` and the Y-axis being relative\n+    frequency of ``x`` values.\n+\n+.. function:: uniqueness_distribution(khll, histogramSize) ->  map<bigint,double>\n+\n+    Returns the uniqueness histogram with the given amount of buckets. If omitted,\n+    the value defaults to 256. All ``uniqueness``es greater than ``histogramSize`` are\n+    accumulated in the last bucket.\n+\n+.. function:: reidentification_potential(khll, threshold) ->  double\n+\n+    The reidentification potential is the ratio of ``x`` values that have a\n+    ``uniqueness`` under the given ``threshold``.\n+\n+.. function:: merge(khll) -> KHyperLogLog\n+    :noindex:\n+\n+    Returns the KHyperLogLog of the aggregate union of the individual KHyperLogLog", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1ODU1OA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400658558", "bodyText": "nit: associated with", "author": "caithagoras", "createdAt": "2020-03-31T05:51:05Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog\n+    sketches represent ``y`` values linked to ``x`` values.\n+\n+.. function:: cardinality(khll) -> bigint\n+    :noindex:\n+\n+    This calculates the cardinality of the MinHash sketch, i.e. ``x``'s cardinality\n+\n+.. function:: intersection_cardinality(khll1, khll2) ->  bigint\n+\n+    Returns the set intersection cardinality of the data represented by the MinHash\n+    structures of ``khll1`` and ``khll2``.\n+\n+.. function:: jaccard_index(khll1, khll2) ->  double\n+\n+    Returns the Jaccard index of the data represented by the MinHash structures of\n+    ``khll1`` and ``khll2``.\n+\n+.. function:: uniqueness_distribution(khll) ->  map<bigint,double>\n+\n+    For a certain value ``x'``, uniqueness is understood as how many ``y'`` values are\n+    associated to it in the source dataset. This is obtained with the cardinality", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1ODc1Mg==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400658752", "bodyText": "looks like typo", "author": "caithagoras", "createdAt": "2020-03-31T05:51:47Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog\n+    sketches represent ``y`` values linked to ``x`` values.\n+\n+.. function:: cardinality(khll) -> bigint\n+    :noindex:\n+\n+    This calculates the cardinality of the MinHash sketch, i.e. ``x``'s cardinality\n+\n+.. function:: intersection_cardinality(khll1, khll2) ->  bigint\n+\n+    Returns the set intersection cardinality of the data represented by the MinHash\n+    structures of ``khll1`` and ``khll2``.\n+\n+.. function:: jaccard_index(khll1, khll2) ->  double\n+\n+    Returns the Jaccard index of the data represented by the MinHash structures of\n+    ``khll1`` and ``khll2``.\n+\n+.. function:: uniqueness_distribution(khll) ->  map<bigint,double>\n+\n+    For a certain value ``x'``, uniqueness is understood as how many ``y'`` values are\n+    associated to it in the source dataset. This is obtained with the cardinality\n+    of the HyperLogLog that is mapped from the MinHash bucket that corresponds to\n+    ``x'``. This function returns a histogram that represents the uniqueness\n+    distribution, the X-axis being ``uniqueness`` and the Y-axis being relative\n+    frequency of ``x`` values.\n+\n+.. function:: uniqueness_distribution(khll, histogramSize) ->  map<bigint,double>\n+\n+    Returns the uniqueness histogram with the given amount of buckets. If omitted,\n+    the value defaults to 256. All ``uniqueness``es greater than ``histogramSize`` are", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA0ODgzNA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r401048834", "bodyText": "Not sure it's a typo, but does All uniqueness values greater than sound better?", "author": "tdcmeehan", "createdAt": "2020-03-31T16:26:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1ODc1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE1MzA4OA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r401153088", "bodyText": "Yes, I think that would be more readable.", "author": "caithagoras", "createdAt": "2020-03-31T19:15:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1ODc1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1ODk0MA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400658940", "bodyText": "nit:\nthe ``uniqueness``\nthe relative frequency", "author": "caithagoras", "createdAt": "2020-03-31T05:52:30Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog\n+    sketches represent ``y`` values linked to ``x`` values.\n+\n+.. function:: cardinality(khll) -> bigint\n+    :noindex:\n+\n+    This calculates the cardinality of the MinHash sketch, i.e. ``x``'s cardinality\n+\n+.. function:: intersection_cardinality(khll1, khll2) ->  bigint\n+\n+    Returns the set intersection cardinality of the data represented by the MinHash\n+    structures of ``khll1`` and ``khll2``.\n+\n+.. function:: jaccard_index(khll1, khll2) ->  double\n+\n+    Returns the Jaccard index of the data represented by the MinHash structures of\n+    ``khll1`` and ``khll2``.\n+\n+.. function:: uniqueness_distribution(khll) ->  map<bigint,double>\n+\n+    For a certain value ``x'``, uniqueness is understood as how many ``y'`` values are\n+    associated to it in the source dataset. This is obtained with the cardinality\n+    of the HyperLogLog that is mapped from the MinHash bucket that corresponds to\n+    ``x'``. This function returns a histogram that represents the uniqueness\n+    distribution, the X-axis being ``uniqueness`` and the Y-axis being relative", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1OTA2Nw==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400659067", "bodyText": "``MinHash``", "author": "caithagoras", "createdAt": "2020-03-31T05:52:53Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog\n+    sketches represent ``y`` values linked to ``x`` values.\n+\n+.. function:: cardinality(khll) -> bigint\n+    :noindex:\n+\n+    This calculates the cardinality of the MinHash sketch, i.e. ``x``'s cardinality\n+\n+.. function:: intersection_cardinality(khll1, khll2) ->  bigint\n+\n+    Returns the set intersection cardinality of the data represented by the MinHash", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1OTE0MQ==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400659141", "bodyText": "``HyperLogLog``", "author": "caithagoras", "createdAt": "2020-03-31T05:53:14Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog\n+    sketches represent ``y`` values linked to ``x`` values.\n+\n+.. function:: cardinality(khll) -> bigint\n+    :noindex:\n+\n+    This calculates the cardinality of the MinHash sketch, i.e. ``x``'s cardinality\n+\n+.. function:: intersection_cardinality(khll1, khll2) ->  bigint\n+\n+    Returns the set intersection cardinality of the data represented by the MinHash\n+    structures of ``khll1`` and ``khll2``.\n+\n+.. function:: jaccard_index(khll1, khll2) ->  double\n+\n+    Returns the Jaccard index of the data represented by the MinHash structures of\n+    ``khll1`` and ``khll2``.\n+\n+.. function:: uniqueness_distribution(khll) ->  map<bigint,double>\n+\n+    For a certain value ``x'``, uniqueness is understood as how many ``y'`` values are\n+    associated to it in the source dataset. This is obtained with the cardinality\n+    of the HyperLogLog that is mapped from the MinHash bucket that corresponds to", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1OTI2Mw==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400659263", "bodyText": "``MinHash``", "author": "caithagoras", "createdAt": "2020-03-31T05:53:36Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog\n+    sketches represent ``y`` values linked to ``x`` values.\n+\n+.. function:: cardinality(khll) -> bigint\n+    :noindex:\n+\n+    This calculates the cardinality of the MinHash sketch, i.e. ``x``'s cardinality\n+\n+.. function:: intersection_cardinality(khll1, khll2) ->  bigint\n+\n+    Returns the set intersection cardinality of the data represented by the MinHash\n+    structures of ``khll1`` and ``khll2``.\n+\n+.. function:: jaccard_index(khll1, khll2) ->  double\n+\n+    Returns the Jaccard index of the data represented by the MinHash structures of", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY2MDYwMg==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400660602", "bodyText": "MinHash\nAdd a period (\".\") at the end of the line.", "author": "caithagoras", "createdAt": "2020-03-31T05:57:59Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog\n+    sketches represent ``y`` values linked to ``x`` values.\n+\n+.. function:: cardinality(khll) -> bigint\n+    :noindex:\n+\n+    This calculates the cardinality of the MinHash sketch, i.e. ``x``'s cardinality", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY2MDY3Mg==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400660672", "bodyText": "HyperLogLog", "author": "caithagoras", "createdAt": "2020-03-31T05:58:14Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY2MDczNQ==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r400660735", "bodyText": "MinHash", "author": "caithagoras", "createdAt": "2020-03-31T05:58:26Z", "path": "presto-docs/src/main/sphinx/functions/khyperloglog.rst", "diffHunk": "@@ -0,0 +1,75 @@\n+======================\n+KHyperLogLog Functions\n+======================\n+\n+Presto implements the `KHyperLogLog <https://research.google/pubs/pub47664/>`_\n+algorithm and data structure. KHyperLogLog data structure can be created\n+through :func:`khyperloglog_agg` function.\n+\n+\n+Data Structures\n+---------------\n+\n+KHyperLogLog is a data sketch that compactly represents the association of two\n+columns. It is implemented in Presto as a two-level data structure composed of\n+a MinHash structure whose entries map to HyperLogLog sketches.\n+\n+Serialization\n+-------------\n+\n+KHyperLogLog sketches can be cast to and from ``varbinary``. This allows them to\n+be stored for later use.\n+\n+Functions\n+---------\n+\n+.. function:: khyperloglog_agg(x, y) -> KHyperLogLog\n+\n+    Returns the KHyperLogLog sketch that represents the relationship between\n+    columns ``x`` and ``y``. The MinHash structure summarizes ``x`` and the HyperLogLog", "originalCommit": "09b74ae349570a70af6b58768215c6f2088e3ecf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3f19b3a44a71f0b82eeda0b02d94cdecd6b1f326", "url": "https://github.com/prestodb/presto/commit/3f19b3a44a71f0b82eeda0b02d94cdecd6b1f326", "message": "Add documentation for KHyperLogLog\n\nCo-authored-by: Sundar Jeyaraman <sundarj@fb.com>", "committedDate": "2020-03-31T16:41:22Z", "type": "forcePushed"}, {"oid": "0c69199dd799c2f0b10969ef4d227869346ec151", "url": "https://github.com/prestodb/presto/commit/0c69199dd799c2f0b10969ef4d227869346ec151", "message": "Add documentation for KHyperLogLog\n\nCo-authored-by: Sundar Jeyaraman <sundarj@fb.com>", "committedDate": "2020-03-31T16:51:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE1Mzk2MQ==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r401153961", "bodyText": "I believe you need to add the label before the KHperLogLog heading. See example right above.", "author": "caithagoras", "createdAt": "2020-03-31T19:16:40Z", "path": "presto-docs/src/main/sphinx/language/types.rst", "diffHunk": "@@ -279,6 +279,14 @@ Calculating the approximate distinct count can be done much more cheaply than an\n     A P4HyperLogLog sketch is similar to :ref:`hyperloglog_type`, but it starts (and remains)\n     in the dense representation.\n \n+KHyperLogLog\n+------------\n+\n+KHyperLogLog is a data sketch that can be used to compactly represents the association of two\n+columns. See :doc:`/functions/khyperloglog`.\n+\n+.. _khyperloglog_type:", "originalCommit": "0c69199dd799c2f0b10969ef4d227869346ec151", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE5MzgwNA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r401193804", "bodyText": "It seems redundant to add the section header plus a sub-header with the exact same name.  Nevertheless, changed it to that for consistency.", "author": "tdcmeehan", "createdAt": "2020-03-31T20:27:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE1Mzk2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjkwNTAxNA==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r406905014", "bodyText": "Looks like we have an misunderstanding here. We don't need the sub-header. I mean to put line 291 before line 285. Line 291 is a label, which is used by other parts of the doc to reference the type. Placing the reference here is essentially making a link to the next section \"Quantile Digest\", instead of to the KHyperLogLog section.", "author": "caithagoras", "createdAt": "2020-04-10T19:21:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE1Mzk2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjkwNjMxMw==", "url": "https://github.com/prestodb/presto/pull/14312#discussion_r406906313", "bodyText": "Just to avoid confusion, by line 291, I meant this line:\n.. _khyperloglog_type:", "author": "caithagoras", "createdAt": "2020-04-10T19:24:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE1Mzk2MQ=="}], "type": "inlineReview"}, {"oid": "7195b3dfd7fb6c24b4ecdea91eb4857bc8369ddb", "url": "https://github.com/prestodb/presto/commit/7195b3dfd7fb6c24b4ecdea91eb4857bc8369ddb", "message": "Add documentation for KHyperLogLog\n\nCo-authored-by: Sundar Jeyaraman <sundarj@fb.com>", "committedDate": "2020-03-31T20:25:07Z", "type": "commit"}, {"oid": "7195b3dfd7fb6c24b4ecdea91eb4857bc8369ddb", "url": "https://github.com/prestodb/presto/commit/7195b3dfd7fb6c24b4ecdea91eb4857bc8369ddb", "message": "Add documentation for KHyperLogLog\n\nCo-authored-by: Sundar Jeyaraman <sundarj@fb.com>", "committedDate": "2020-03-31T20:25:07Z", "type": "forcePushed"}]}