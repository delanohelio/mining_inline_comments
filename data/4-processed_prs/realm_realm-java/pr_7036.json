{"pr_number": 7036, "pr_title": "Upgrade to latest Build Tools and Gradle", "pr_createdAt": "2020-08-17T14:43:48Z", "pr_url": "https://github.com/realm/realm-java/pull/7036", "timeline": [{"oid": "c7081a59faddbe23032d7fdb5ee0d200173a9460", "url": "https://github.com/realm/realm-java/commit/c7081a59faddbe23032d7fdb5ee0d200173a9460", "message": "Bump all dependencies", "committedDate": "2020-08-17T12:00:26Z", "type": "commit"}, {"oid": "e1fc3e52c0afaf0194d82bf18160905654d86806", "url": "https://github.com/realm/realm-java/commit/e1fc3e52c0afaf0194d82bf18160905654d86806", "message": "Merge branch 'v10' into cm/upgrade-build-tools-4.0\n\n# Conflicts:\n#\tdependencies.list\n#\trealm/gradle/wrapper/gradle-wrapper.properties", "committedDate": "2020-08-17T14:50:54Z", "type": "commit"}, {"oid": "64771ca25dcf08888d66acf383993f6749ecba37", "url": "https://github.com/realm/realm-java/commit/64771ca25dcf08888d66acf383993f6749ecba37", "message": "Align names", "committedDate": "2020-08-18T13:48:01Z", "type": "commit"}, {"oid": "ef53c96dea39a9501b1997a8822fe49359273dd3", "url": "https://github.com/realm/realm-java/commit/ef53c96dea39a9501b1997a8822fe49359273dd3", "message": "Configure spotbugs and enable it on jenkins", "committedDate": "2020-08-19T13:04:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzExODk2OA==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r473118968", "bodyText": "There also seem to be spotbugsBase and spotBugsObjectServer. Not 100% sure what Main covers?", "author": "cmelchior", "createdAt": "2020-08-19T15:30:35Z", "path": "Jenkinsfile", "diffHunk": "@@ -183,9 +183,16 @@ def runBuild(abiFilter, instrumentationTestTarget) {\n     },\n     'Static code analysis' : {\n       try {\n-        gradle('realm', \"findbugs ${abiFilter}\") // FIXME Renable pmd and checkstyle\n+        gradle('realm', \"spotbugsMain ${abiFilter}\") // FIXME Renable pmd and checkstyle", "originalCommit": "ef53c96dea39a9501b1997a8822fe49359273dd3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzExOTYxOQ==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r473119619", "bodyText": "Ah sorry. Missed the change where you configure this as its own target \ud83e\udd26 \ud83d\udc4d", "author": "cmelchior", "createdAt": "2020-08-19T15:31:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzExODk2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDUwNDA2NQ==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r474504065", "bodyText": "It doesnt allow me to set the \"spotbugs\" name to the task.", "author": "clementetb", "createdAt": "2020-08-21T08:10:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzExODk2OA=="}], "type": "inlineReview"}, {"oid": "ab8c95a50a7c5e4a28c0e7292045d005a4186afd", "url": "https://github.com/realm/realm-java/commit/ab8c95a50a7c5e4a28c0e7292045d005a4186afd", "message": "merge v10", "committedDate": "2020-08-20T08:34:08Z", "type": "commit"}, {"oid": "9451bae6cd145c5c1233b492e59d0726ea276794", "url": "https://github.com/realm/realm-java/commit/9451bae6cd145c5c1233b492e59d0726ea276794", "message": "Try fix jenkins javadoc build", "committedDate": "2020-08-20T08:51:17Z", "type": "commit"}, {"oid": "10fd05b31f89b1b9167f3a3745bf7284a98b9450", "url": "https://github.com/realm/realm-java/commit/10fd05b31f89b1b9167f3a3745bf7284a98b9450", "message": "Fix check task", "committedDate": "2020-08-20T17:32:36Z", "type": "commit"}, {"oid": "f41a5b9c33623206856a19ed5d3ccb6564294787", "url": "https://github.com/realm/realm-java/commit/f41a5b9c33623206856a19ed5d3ccb6564294787", "message": "Extract rxjava versioning into dependencies.list", "committedDate": "2020-08-20T18:44:33Z", "type": "commit"}, {"oid": "8a9f358c2e69496d459dfe099715fe8cc32fb9b4", "url": "https://github.com/realm/realm-java/commit/8a9f358c2e69496d459dfe099715fe8cc32fb9b4", "message": "Bump multidex library", "committedDate": "2020-08-20T18:46:50Z", "type": "commit"}, {"oid": "447a1728f76f6f8281d53cf170be2f8d9cf0aa81", "url": "https://github.com/realm/realm-java/commit/447a1728f76f6f8281d53cf170be2f8d9cf0aa81", "message": "Remove max gradle workers limit", "committedDate": "2020-08-20T18:47:28Z", "type": "commit"}, {"oid": "ba0de9e1d6da6e88825425de1640d817bc4eee40", "url": "https://github.com/realm/realm-java/commit/ba0de9e1d6da6e88825425de1640d817bc4eee40", "message": "Fix rxjava version", "committedDate": "2020-08-20T19:20:04Z", "type": "commit"}, {"oid": "63a998f6b735d98460123eac72d4b1f230b84284", "url": "https://github.com/realm/realm-java/commit/63a998f6b735d98460123eac72d4b1f230b84284", "message": "Use spotbugs annotations instead of findbugs", "committedDate": "2020-08-20T19:30:35Z", "type": "commit"}, {"oid": "74298fb054e23d1c601fd35a4b4a5cf6c24728ef", "url": "https://github.com/realm/realm-java/commit/74298fb054e23d1c601fd35a4b4a5cf6c24728ef", "message": "Merge branch 'v10' into cm/upgrade-build-tools-4.0", "committedDate": "2020-08-21T15:28:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3NjQxOA==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r475376418", "bodyText": "Not sure how long time it takes, but I guess javadoc could be generated in parallel.", "author": "rorbech", "createdAt": "2020-08-24T06:49:49Z", "path": "Jenkinsfile", "diffHunk": "@@ -175,7 +175,7 @@ try {\n def runBuild(abiFilter, instrumentationTestTarget) {\n \n   stage('Build') {\n-    sh \"chmod +x gradlew && ./gradlew assemble javadoc ${abiFilter} --stacktrace\"\n+    sh \"chmod +x gradlew && ./gradlew assemble ${abiFilter} --stacktrace && ./gradlew javadoc ${abiFilter} --stacktrace\"", "originalCommit": "74298fb054e23d1c601fd35a4b4a5cf6c24728ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTUyMTQ2Nw==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r475521467", "bodyText": "It takes ~5s to generate the javadoc, I have added a new step in Jenkins for it.", "author": "clementetb", "createdAt": "2020-08-24T11:03:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3NjQxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3NzA1Ng==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r475377056", "bodyText": "Might want to strip the version here too, or is gradle to dangerous to use as variable name?", "author": "rorbech", "createdAt": "2020-08-24T06:51:19Z", "path": "dependencies.list", "diffHunk": "@@ -1,21 +1,26 @@\n # Realm Sync release used by Realm Java (This includes Realm Core)\n # https://github.com/realm/realm-sync/releases\n-REALM_SYNC_VERSION=10.0.0-beta.6\n+REALM_SYNC=10.0.0-beta.6\n REALM_SYNC_SHA256=824192a67e7ded59d33707265f78c8d5546b1fef473e9ee5ecff8a5bc9f8506e\n \n # Version of MongoDB Realm used by integration tests\n # See https://github.com/realm/ci/packages/147854 for available versions\n-MONGODB_REALM_SERVER_VERSION=2020-08-17\n+MONGODB_REALM_SERVER=2020-08-17\n \n # Common Android settings across projects\n-GRADLE_BUILD_TOOLS=3.6.1\n+GRADLE_BUILD_TOOLS=4.0.0\n ANDROID_BUILD_TOOLS=29.0.3\n+KOTLIN=1.3.72\n \n # Common classpath dependencies\n-gradleVersion=5.6.4\n+gradleVersion=6.5", "originalCommit": "74298fb054e23d1c601fd35a4b4a5cf6c24728ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTUyMjAxNQ==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r475522015", "bodyText": "Actually this variable wasn't being used anywhere. I have renamed the variable and tweaked the gradle update script to make use of this variable.", "author": "clementetb", "createdAt": "2020-08-24T11:04:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3NzA1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3ODM4OQ==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r475378389", "bodyText": "Is this used for anything? Gradle version is given by gradle-wrapper.properties. If this is just for an overview of dependencies, maybe just put a pointer to the file. Alternatively we should maybe verify this version against the executing gradle version.", "author": "rorbech", "createdAt": "2020-08-24T06:54:48Z", "path": "dependencies.list", "diffHunk": "@@ -1,21 +1,26 @@\n # Realm Sync release used by Realm Java (This includes Realm Core)\n # https://github.com/realm/realm-sync/releases\n-REALM_SYNC_VERSION=10.0.0-beta.6\n+REALM_SYNC=10.0.0-beta.6\n REALM_SYNC_SHA256=824192a67e7ded59d33707265f78c8d5546b1fef473e9ee5ecff8a5bc9f8506e\n \n # Version of MongoDB Realm used by integration tests\n # See https://github.com/realm/ci/packages/147854 for available versions\n-MONGODB_REALM_SERVER_VERSION=2020-08-17\n+MONGODB_REALM_SERVER=2020-08-17\n \n # Common Android settings across projects\n-GRADLE_BUILD_TOOLS=3.6.1\n+GRADLE_BUILD_TOOLS=4.0.0\n ANDROID_BUILD_TOOLS=29.0.3\n+KOTLIN=1.3.72\n \n # Common classpath dependencies\n-gradleVersion=5.6.4\n+gradleVersion=6.5", "originalCommit": "74298fb054e23d1c601fd35a4b4a5cf6c24728ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM4MjgxMw==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r475382813", "bodyText": "As far as I remember there are some of the types from this library that is actually part of our API (Decoder, CodecRegistry, etc)...at least for the sync flavor, in which case it would be more correct to have this as an api dependency.", "author": "rorbech", "createdAt": "2020-08-24T07:05:13Z", "path": "realm/realm-library/build.gradle", "diffHunk": "@@ -217,22 +218,19 @@ dependencies {\n     api \"io.realm:realm-annotations:${version}\"\n     implementation 'com.google.code.findbugs:jsr305:3.0.2'\n     implementation 'com.getkeepsafe.relinker:relinker:1.4.0'\n-    implementation \"org.mongodb:bson:${properties.getProperty('BSON_DEPENDENCY_VERSION')}\"\n-    implementation('io.reactivex.rxjava2:rxandroid:2.1.1') {\n+    implementation \"org.mongodb:bson:${properties.getProperty('BSON_DEPENDENCY')}\"", "originalCommit": "74298fb054e23d1c601fd35a4b4a5cf6c24728ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTUyMjMxNA==", "url": "https://github.com/realm/realm-java/pull/7036#discussion_r475522314", "bodyText": "makes sense \ud83d\udc4c\ud83d\udc4c", "author": "clementetb", "createdAt": "2020-08-24T11:04:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM4MjgxMw=="}], "type": "inlineReview"}, {"oid": "70d3b0ff620db8fb871f1e465600b08e650b9eed", "url": "https://github.com/realm/realm-java/commit/70d3b0ff620db8fb871f1e465600b08e650b9eed", "message": "Parallelize javadoc generation", "committedDate": "2020-08-24T10:24:21Z", "type": "commit"}, {"oid": "8ca896060e7a1ebe09b54334e7f21e3956eab9e3", "url": "https://github.com/realm/realm-java/commit/8ca896060e7a1ebe09b54334e7f21e3956eab9e3", "message": "Improve gradle upgrade", "committedDate": "2020-08-24T10:47:09Z", "type": "commit"}, {"oid": "fa096e4155c02875021170df3a5de81d267b9530", "url": "https://github.com/realm/realm-java/commit/fa096e4155c02875021170df3a5de81d267b9530", "message": "Set bson library as API", "committedDate": "2020-08-24T11:05:40Z", "type": "commit"}, {"oid": "99ae6e1a090729166a88804f86b0383b8cb4a2f5", "url": "https://github.com/realm/realm-java/commit/99ae6e1a090729166a88804f86b0383b8cb4a2f5", "message": "Reenable PMD and check style", "committedDate": "2020-08-24T11:32:33Z", "type": "commit"}, {"oid": "4f3f9805664b4cc21bffcc6147eee4d593d03bbf", "url": "https://github.com/realm/realm-java/commit/4f3f9805664b4cc21bffcc6147eee4d593d03bbf", "message": "Add pmd command in Jenkins static code analysis step", "committedDate": "2020-08-24T12:29:56Z", "type": "commit"}, {"oid": "ee3b93560f2b71d580d367b1552d82d327c17c68", "url": "https://github.com/realm/realm-java/commit/ee3b93560f2b71d580d367b1552d82d327c17c68", "message": "Enable checkstyle step", "committedDate": "2020-08-24T13:17:38Z", "type": "commit"}, {"oid": "622057711f42b83f2efb363d45172e5809a4106f", "url": "https://github.com/realm/realm-java/commit/622057711f42b83f2efb363d45172e5809a4106f", "message": "Clean up checkstyle rules\nSuppress VisibilityModifier rule", "committedDate": "2020-08-24T13:55:58Z", "type": "commit"}, {"oid": "bab52ca1b6cbde5c70d5a3b0a1b06a0bbc3e034c", "url": "https://github.com/realm/realm-java/commit/bab52ca1b6cbde5c70d5a3b0a1b06a0bbc3e034c", "message": "Merge branch 'v10' into cm/upgrade-build-tools-4.0\n\n# Conflicts:\n#\tdependencies.list\n#\trealm/realm-library/src/objectServer/java/io/realm/internal/network/OkHttpNetworkTransport.java", "committedDate": "2020-08-25T09:14:10Z", "type": "commit"}, {"oid": "18de49d31b14114e90d8d2b55ac93b44b282ae15", "url": "https://github.com/realm/realm-java/commit/18de49d31b14114e90d8d2b55ac93b44b282ae15", "message": "Bump objectstore reference", "committedDate": "2020-08-25T09:19:28Z", "type": "commit"}]}