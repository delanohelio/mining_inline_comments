{"pr_number": 7142, "pr_title": "Flaky build - extensions:publishObjectServerPublicationPublicationToMavenLocal", "pr_createdAt": "2020-10-02T14:30:39Z", "pr_url": "https://github.com/realm/realm-java/pull/7142", "timeline": [{"oid": "d22c2c5e84e231f4236ae7837a4821300465d638", "url": "https://github.com/realm/realm-java/commit/d22c2c5e84e231f4236ae7837a4821300465d638", "message": "Enforced assemble task to be run to generate the aar needed by the publish to local maven task", "committedDate": "2020-10-02T14:27:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM2MDQ2NA==", "url": "https://github.com/realm/realm-java/pull/7142#discussion_r499360464", "bodyText": "In order to keep the build times low, I think doing assembleRelease here should be enough. If we just do assemble it will force a built of both debug and release variants on CI which can be quite time consuming.", "author": "cmelchior", "createdAt": "2020-10-05T06:01:58Z", "path": "realm/kotlin-extensions/build.gradle", "diffHunk": "@@ -196,7 +196,9 @@ publishing {\n             groupId 'io.realm'\n             artifactId 'realm-android-kotlin-extensions'\n             version project.version\n-            artifact file(\"${rootDir}/kotlin-extensions/build/outputs/aar/realm-kotlin-extensions-base-release.aar\")\n+            artifact (file(\"${rootDir}/kotlin-extensions/build/outputs/aar/realm-kotlin-extensions-base-release.aar\")) {\n+                builtBy assemble", "originalCommit": "d22c2c5e84e231f4236ae7837a4821300465d638", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM3MjQ0MQ==", "url": "https://github.com/realm/realm-java/pull/7142#discussion_r499372441", "bodyText": "It doesn't work when I specify assembleRelease:\nCould not get unknown property 'assembleRelease' for FileBasedMavenArtifact_Decorated aar:null of type org.gradle.api.publish.maven.internal.artifact.FileBasedMavenArtifact.", "author": "edualonso", "createdAt": "2020-10-05T06:41:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM2MDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM3MzAxNQ==", "url": "https://github.com/realm/realm-java/pull/7142#discussion_r499373015", "bodyText": "I guess this happens because the buildtype can't be used to define the precedence. If you chose to build in debug mode, then it would use assembleDebug, if it's release then it would choose assembleRelease.", "author": "edualonso", "createdAt": "2020-10-05T06:43:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM2MDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM3MzI5MQ==", "url": "https://github.com/realm/realm-java/pull/7142#discussion_r499373291", "bodyText": "Cool, should be good enough \ud83d\udc4d", "author": "cmelchior", "createdAt": "2020-10-05T06:44:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM2MDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ4MTQ5Mg==", "url": "https://github.com/realm/realm-java/pull/7142#discussion_r499481492", "bodyText": "My previous comment isn't actually true. I just checked the log from the build process and both before these changes and after, the task in question is assemble, no build type specified.\nAlso, the build times don't seem to be affected by this. Before, the time for the \"build\" stage of the job oscillated between 6-10 minutes, and now it's exactly the same.", "author": "edualonso", "createdAt": "2020-10-05T09:59:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM2MDQ2NA=="}], "type": "inlineReview"}]}