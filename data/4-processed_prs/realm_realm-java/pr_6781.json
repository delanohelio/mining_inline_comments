{"pr_number": 6781, "pr_title": "Switch to using Github Docker Registry", "pr_createdAt": "2020-03-20T07:46:05Z", "pr_url": "https://github.com/realm/realm-java/pull/6781", "timeline": [{"oid": "99e254dc69f0839005c71b47905a433f689e70a4", "url": "https://github.com/realm/realm-java/commit/99e254dc69f0839005c71b47905a433f689e70a4", "message": "Use GitHub Docker Registery instead of AWS", "committedDate": "2020-03-20T07:44:17Z", "type": "commit"}, {"oid": "e67c31a225df3562b088abeae45eaf0a11b8aca6", "url": "https://github.com/realm/realm-java/commit/e67c31a225df3562b088abeae45eaf0a11b8aca6", "message": "Add description on how to use script", "committedDate": "2020-03-20T07:57:06Z", "type": "commit"}, {"oid": "c3b6db0dba4097657987ab4afbeaa0ca6d9a86df", "url": "https://github.com/realm/realm-java/commit/c3b6db0dba4097657987ab4afbeaa0ca6d9a86df", "message": "Store server logs. Remove references to CLI image.", "committedDate": "2020-03-20T09:06:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQxOTkwNg==", "url": "https://github.com/realm/realm-java/pull/6781#discussion_r396419906", "bodyText": "Need to also use docker pull to ensure we are pulling the latest version", "author": "cmelchior", "createdAt": "2020-03-23T12:39:44Z", "path": "tools/sync_test_server/start_server.sh", "diffHunk": "@@ -10,21 +31,16 @@ adb reverse tcp:9080 tcp:9080 && \\\n adb reverse tcp:9090 tcp:9090 && \\\n adb reverse tcp:8888 tcp:8888 || { echo \"Failed to reverse adb port.\" ; exit 1 ; }\n \n-# Make sure that Docker works correctly with AWS by logging in\n-DOCKER_LOGIN=$(aws ecr get-login --no-include-email)\n-eval $DOCKER_LOGIN\n-\n-# Work-around for getting latest Stich image\n-LATEST_MONGODB_REALM_VERSION=$(aws ecr describe-images --repository-name ci/mongodb-realm-images --query 'sort_by(imageDetails,& imagePushedAt)[-1].imageTags[0]' | cut -d '\"' -f 2)\n-LATEST_CLI_VERSION=\"190\"\n+# Make sure that Docker works correctly with Github Docker Registry by logging in\n+docker login docker.pkg.github.com -u $GITHUB_DOCKER_USER -p $GITHUB_DOCKER_TOKEN\n \n # Run Stitch and Stitch CLI Docker images\n docker network create mongodb-realm-network\n docker build $DOCKERFILE_DIR -t mongodb-realm-command-server || { echo \"Failed to build Docker image.\" ; exit 1 ; }\n-ID=$(docker run --rm -i -t -d --network mongodb-realm-network  -p 8888:8888 -p 9090:9090 --name mongodb-realm 012067661104.dkr.ecr.eu-west-1.amazonaws.com/ci/mongodb-realm-images:\"$LATEST_MONGODB_REALM_VERSION\")\n+ID=$(docker run --rm -i -t -d --network mongodb-realm-network -p 9090:9090 -p 8888:8888 --name mongodb-realm docker.pkg.github.com/realm/ci/mongodb-realm-test-server:latest)", "originalCommit": "c3b6db0dba4097657987ab4afbeaa0ca6d9a86df", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7ba6e9b9760278c69a2ad7254ba268a7d9c9ce99", "url": "https://github.com/realm/realm-java/commit/7ba6e9b9760278c69a2ad7254ba268a7d9c9ce99", "message": "Use tagged version", "committedDate": "2020-03-25T10:31:06Z", "type": "commit"}, {"oid": "df1c89cd8cc3e46a45450d2674258f769177d91c", "url": "https://github.com/realm/realm-java/commit/df1c89cd8cc3e46a45450d2674258f769177d91c", "message": "Naming of property", "committedDate": "2020-03-25T10:50:32Z", "type": "commit"}, {"oid": "a8f9f625718b973218d2f0578fce0c0cfe65daca", "url": "https://github.com/realm/realm-java/commit/a8f9f625718b973218d2f0578fce0c0cfe65daca", "message": "Auto login", "committedDate": "2020-03-25T14:44:33Z", "type": "commit"}]}