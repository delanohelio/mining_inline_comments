{"pr_number": 6760, "pr_title": "Upgrade to Sync 10.0.0-alpha.1. Disable all Sync builds", "pr_createdAt": "2020-02-27T14:56:39Z", "pr_url": "https://github.com/realm/realm-java/pull/6760", "timeline": [{"oid": "b424e4ce2718de519bf9ec3bb787b26903c8f5c8", "url": "https://github.com/realm/realm-java/commit/b424e4ce2718de519bf9ec3bb787b26903c8f5c8", "message": "Upgrade to Sync 10.0.0-alpha.1. Disable all Sync builds", "committedDate": "2020-02-27T14:46:07Z", "type": "commit"}, {"oid": "4ffac1e258e4e76d2a3000c0bbdcdc917bcd0d9e", "url": "https://github.com/realm/realm-java/commit/4ffac1e258e4e76d2a3000c0bbdcdc917bcd0d9e", "message": "Disable objectServer example", "committedDate": "2020-02-27T15:20:56Z", "type": "commit"}, {"oid": "446789a838036b2dc61b141ebf6ddc7031e8bab8", "url": "https://github.com/realm/realm-java/commit/446789a838036b2dc61b141ebf6ddc7031e8bab8", "message": "Disable more examples", "committedDate": "2020-02-27T16:07:32Z", "type": "commit"}, {"oid": "fb6e5c37693bb512f1fbb6f2cdee7a1c5c0b18fc", "url": "https://github.com/realm/realm-java/commit/fb6e5c37693bb512f1fbb6f2cdee7a1c5c0b18fc", "message": "Annotation processor unit tests", "committedDate": "2020-02-27T16:50:31Z", "type": "commit"}, {"oid": "5467b15bd2009425e96589e77818dd88f1ca8eec", "url": "https://github.com/realm/realm-java/commit/5467b15bd2009425e96589e77818dd88f1ca8eec", "message": "Fix more tests", "committedDate": "2020-02-28T08:36:55Z", "type": "commit"}, {"oid": "d186a41222d7c8ac7aa970b60a6f78e4a0cd593b", "url": "https://github.com/realm/realm-java/commit/d186a41222d7c8ac7aa970b60a6f78e4a0cd593b", "message": "Disable broken unit tests", "committedDate": "2020-02-28T08:43:30Z", "type": "commit"}, {"oid": "20bdea97f36c606ac0822179a07db0bdce9d1bab", "url": "https://github.com/realm/realm-java/commit/20bdea97f36c606ac0822179a07db0bdce9d1bab", "message": "Fix more tests", "committedDate": "2020-02-28T09:54:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYwNDkxNA==", "url": "https://github.com/realm/realm-java/pull/6760#discussion_r385604914", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                // String, short, int, long and must only be present one time.\n          \n          \n            \n                // String, short, int and long must only be present one time.", "author": "nhachicha", "createdAt": "2020-02-28T09:59:47Z", "path": "realm/realm-annotations-processor/src/main/java/io/realm/processor/ClassMetaData.kt", "diffHunk": "@@ -698,7 +698,9 @@ class ClassMetaData(env: ProcessingEnvironment, typeMirrors: TypeMirrors, privat\n     }\n \n     // The field has the @PrimaryKey annotation. It is only valid for\n-    // String, short, int, long and must only be present one time\n+    // String, short, int, long and must only be present one time.", "originalCommit": "20bdea97f36c606ac0822179a07db0bdce9d1bab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYwNTEwNw==", "url": "https://github.com/realm/realm-java/pull/6760#discussion_r385605107", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                // From Core 6 primary keys are not indexed pr default anymore as\n          \n          \n            \n                // From Core 6 primary keys are not indexed by default anymore as", "author": "nhachicha", "createdAt": "2020-02-28T10:00:13Z", "path": "realm/realm-annotations-processor/src/main/java/io/realm/processor/ClassMetaData.kt", "diffHunk": "@@ -698,7 +698,9 @@ class ClassMetaData(env: ProcessingEnvironment, typeMirrors: TypeMirrors, privat\n     }\n \n     // The field has the @PrimaryKey annotation. It is only valid for\n-    // String, short, int, long and must only be present one time\n+    // String, short, int, long and must only be present one time.\n+    // From Core 6 primary keys are not indexed pr default anymore as", "originalCommit": "20bdea97f36c606ac0822179a07db0bdce9d1bab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYwODg3Nw==", "url": "https://github.com/realm/realm-java/pull/6760#discussion_r385608877", "bodyText": "Actually in Core 6 String primary keys don\u2019t need an Index, and in Core 10 none of the primary keys do", "author": "nhachicha", "createdAt": "2020-02-28T10:07:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYwNTEwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxMjQwNQ==", "url": "https://github.com/realm/realm-java/pull/6760#discussion_r385612405", "bodyText": "we're passing twice the refresh token as a parameter? \u2639\ufe0f  shouldn't the second parameter be the access_token?", "author": "nhachicha", "createdAt": "2020-02-28T10:14:58Z", "path": "realm/realm-library/src/main/cpp/io_realm_RealmFileUserStore.cpp", "diffHunk": "@@ -68,12 +68,13 @@ JNIEXPORT jstring JNICALL Java_io_realm_RealmFileUserStore_nativeGetUser(JNIEnv*\n }\n \n JNIEXPORT void JNICALL Java_io_realm_RealmFileUserStore_nativeUpdateOrCreateUser(JNIEnv* env, jclass,\n-                                                                                 jstring j_user_id, jstring json_token,\n+                                                                                 jstring j_user_id,\n+                                                                                 jstring j_refresh_json_token,\n                                                                                  jstring j_auth_url)\n {\n     try {\n-        JStringAccessor user_json_token(env, json_token); // throws\n-        SyncManager::shared().get_user(create_sync_user_identifier(env, j_user_id, j_auth_url), user_json_token);\n+        JStringAccessor refresh_json_token(env, j_refresh_json_token); // throws\n+        SyncManager::shared().get_user(create_sync_user_identifier(env, j_user_id, j_auth_url), refresh_json_token, refresh_json_token);", "originalCommit": "20bdea97f36c606ac0822179a07db0bdce9d1bab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNTQ5Nw==", "url": "https://github.com/realm/realm-java/pull/6760#discussion_r385615497", "bodyText": "Yes, I discussed this with Jason. This is just a temporary workaround until we use Stitch for Authentication.", "author": "cmelchior", "createdAt": "2020-02-28T10:21:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxMjQwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNDUzOQ==", "url": "https://github.com/realm/realm-java/pull/6760#discussion_r385614539", "bodyText": "what happens if the access_token is expired?", "author": "nhachicha", "createdAt": "2020-02-28T10:19:39Z", "path": "realm/realm-library/src/main/cpp/io_realm_internal_OsRealmConfig.cpp", "diffHunk": "@@ -346,7 +346,8 @@ JNIEXPORT jstring JNICALL Java_io_realm_internal_OsRealmConfig_nativeCreateAndSe\n         if (!user) {\n             JStringAccessor realm_auth_url(env, j_auth_url);\n             JStringAccessor refresh_token(env, j_refresh_token);\n-            user = SyncManager::shared().get_user(sync_user_identifier, refresh_token);\n+            JStringAccessor access_token(env, j_access_token);\n+            user = SyncManager::shared().get_user(sync_user_identifier, refresh_token, access_token);", "originalCommit": "20bdea97f36c606ac0822179a07db0bdce9d1bab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNTc2Nw==", "url": "https://github.com/realm/realm-java/pull/6760#discussion_r385615767", "bodyText": "This logic will change once we connect using Stitch. Right now this is just a temporary workaround.", "author": "cmelchior", "createdAt": "2020-02-28T10:22:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNDUzOQ=="}], "type": "inlineReview"}, {"oid": "2c83b8e093a1d3cb6b59ba037e38f27ecd8f2a71", "url": "https://github.com/realm/realm-java/commit/2c83b8e093a1d3cb6b59ba037e38f27ecd8f2a71", "message": "Javadoc fixes", "committedDate": "2020-02-28T11:23:31Z", "type": "commit"}]}