{"pr_number": 7035, "pr_title": "Ensure alignment between test app and server admin interface", "pr_createdAt": "2020-08-17T09:27:08Z", "pr_url": "https://github.com/realm/realm-java/pull/7035", "timeline": [{"oid": "bd67e9ec71f8b0b480f0878d71c04b88403f7d41", "url": "https://github.com/realm/realm-java/commit/bd67e9ec71f8b0b480f0878d71c04b88403f7d41", "message": "Ensure alignment between test app and server admin interface", "committedDate": "2020-08-17T09:23:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM2MjAyMg==", "url": "https://github.com/realm/realm-java/pull/7035#discussion_r471362022", "bodyText": "Interesting and good catch \ud83c\udf89 . I wonder why it even worked in the first place before? And why it was only flaky?", "author": "cmelchior", "createdAt": "2020-08-17T09:40:59Z", "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/admin/ServerAdmin.kt", "diffHunk": "@@ -80,10 +81,18 @@ class ServerAdmin {\n         result = JSONObject(executeRequest(builder))\n         groupId = (result.getJSONArray(\"roles\")[0] as JSONObject).getString(\"group_id\")\n \n-        // Get Internal App Id\n+        // Get Internal App Id of the requested app\n+        val appId = this.app.configuration.appId\n         builder = Request.Builder().url(\"$baseUrl/groups/$groupId/apps\").get()\n-        result = JSONArray(executeRequest(builder))[0] as JSONObject\n-        appId = result.getString(\"_id\")\n+        val response = JSONArray(executeRequest(builder))", "originalCommit": "bd67e9ec71f8b0b480f0878d71c04b88403f7d41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM2MzQ3MA==", "url": "https://github.com/realm/realm-java/pull/7035#discussion_r471363470", "bodyText": "Because with two apps the first one is sometimes the right one \ud83d\ude04 Maybe they are sorted by generated ids o.a.", "author": "rorbech", "createdAt": "2020-08-17T09:43:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM2MjAyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM2NTA0NA==", "url": "https://github.com/realm/realm-java/pull/7035#discussion_r471365044", "bodyText": "Doh, ofcourse \ud83d\udc4d", "author": "cmelchior", "createdAt": "2020-08-17T09:46:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM2MjAyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM2NjE1Ng==", "url": "https://github.com/realm/realm-java/pull/7035#discussion_r471366156", "bodyText": "The tricky parts is why it was almost only happening on CI?", "author": "rorbech", "createdAt": "2020-08-17T09:48:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM2MjAyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM2ODQzOQ==", "url": "https://github.com/realm/realm-java/pull/7035#discussion_r471368439", "bodyText": "Yup, I guess it is a timing issue that just surfaces there. Also, we would need to understand what the server uses for sorting when returning those apps. Maybe it is just based on how the data is stored in MongoDB instead of a specific sorting.", "author": "cmelchior", "createdAt": "2020-08-17T09:52:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM2MjAyMg=="}], "type": "inlineReview"}]}