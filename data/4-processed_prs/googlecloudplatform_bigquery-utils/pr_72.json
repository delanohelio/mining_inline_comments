{"pr_number": 72, "pr_title": "SQL Extraction: refactor to use sequences", "pr_createdAt": "2020-06-24T21:54:18Z", "pr_url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/72", "timeline": [{"oid": "1e370fe26ae3295a67a5e0c4f16e4b7420453b98", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/1e370fe26ae3295a67a5e0c4f16e4b7420453b98", "message": "SQL Extraction: refactor to use sequences", "committedDate": "2020-06-25T19:48:33Z", "type": "forcePushed"}, {"oid": "4d76278e9bbc3fdfe06dfc053a89ff3c8d031ba7", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/4d76278e9bbc3fdfe06dfc053a89ff3c8d031ba7", "message": "SQL Extraction: refactor to use sequences", "committedDate": "2020-06-25T21:48:45Z", "type": "commit"}, {"oid": "4d76278e9bbc3fdfe06dfc053a89ff3c8d031ba7", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/4d76278e9bbc3fdfe06dfc053a89ff3c8d031ba7", "message": "SQL Extraction: refactor to use sequences", "committedDate": "2020-06-25T21:48:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4NDUwMA==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/72#discussion_r446684500", "bodyText": "Pls add comment.\nI prefer to use name \"addUsage\". Also, it feels more natural to me to put the parameter \"query\" before \"usage\".", "author": "feiling", "createdAt": "2020-06-28T18:48:30Z", "path": "tools/sql_extraction/src/main/kotlin/DataFlowEngine.kt", "diffHunk": "@@ -1,7 +1,26 @@\n package com.google.cloud.sqlecosystem.sqlextraction\n \n+import com.google.cloud.sqlecosystem.sqlextraction.output.Location\n+import com.google.cloud.sqlecosystem.sqlextraction.output.QueryFragment\n+import com.google.cloud.sqlecosystem.sqlextraction.output.QueryUsages\n+\n /**\n  * Backend engine for running data-flow analysis\n  * @see FrontEnd\n  */\n-class DataFlowEngine\n\\ No newline at end of file\n+class DataFlowEngine {\n+    private val queryUsages: HashMap<QueryFragment, HashSet<Location>> = HashMap()\n+\n+    /**\n+     * Returns all query fragments and usages found by the engine thus far\n+     */\n+    fun getAllQueries(): Sequence<QueryUsages> {\n+        return queryUsages.asSequence()\n+            .filter { it.value.isNotEmpty() }\n+            .map { QueryUsages(it.key, it.value.sorted()) }\n+    }\n+\n+    private fun registerUsage(usage: Location, query: QueryFragment) {", "originalCommit": "4d76278e9bbc3fdfe06dfc053a89ff3c8d031ba7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cf194b33cffa32eb1c29023ae71070dc8e79ff85", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/cf194b33cffa32eb1c29023ae71070dc8e79ff85", "message": "Added javadoc to addUsage", "committedDate": "2020-06-29T15:50:36Z", "type": "commit"}]}