{"pr_number": 69, "pr_title": "SQL Extractor: java examples, cli, file list expander and unit tests", "pr_createdAt": "2020-06-11T20:44:59Z", "pr_url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/69", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1NDM3Mg==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/69#discussion_r440554372", "bodyText": "Please print out the usage when -h is specified. In the usage, please also include several sample usages.\nIt seems right now the program doesn't support file patterns like \"*.cs\" and it's hard-coded to look for java files?", "author": "feiling", "createdAt": "2020-06-16T02:44:40Z", "path": "tools/sql_extraction/src/main/kotlin/Cli.kt", "diffHunk": "@@ -0,0 +1,30 @@\n+package com.google.cloud.sqlecosystem.sqlextraction\n+\n+import com.github.ajalt.clikt.core.CliktCommand\n+import com.github.ajalt.clikt.parameters.arguments.argument\n+import com.github.ajalt.clikt.parameters.arguments.multiple\n+import com.github.ajalt.clikt.parameters.options.flag\n+import com.github.ajalt.clikt.parameters.options.option\n+import com.github.ajalt.clikt.parameters.types.path\n+import mu.KotlinLogging\n+import java.nio.file.Path\n+\n+private val logger = KotlinLogging.logger { }\n+\n+fun main(args: Array<String>) = Cli().main(args)\n+\n+class Cli : CliktCommand(name = \"sql_extraction\") {\n+    val recursive: Boolean by option(\"-r\", \"--recursive\", help = \"scan files in subdirectories recursively\").flag()\n+    val filePaths: List<Path> by argument(help = \"file and directory paths to code\").path(\n+        mustExist = true,\n+        canBeDir = true,\n+        canBeFile = true\n+    ).multiple()\n+\n+    override fun run() {\n+        logger.debug(\"Starting SQL Extraction from command line\")\n+\n+        val files = FileListExpander().expandAndFilter(filePaths, recursive)\n+        logger.debug { \"Files to analyze: $files\" }\n+    }\n+}", "originalCommit": "4b74bf10ca47fe570b63ffce3506d201e28084f5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDkzNzExNQ==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/69#discussion_r440937115", "bodyText": "Good idea for printing sample usages!\nCurrently, only java files are included since I wanted to focus on it first. But maybe it's a better idea to accept all file types here and filter them later based on which language frontends are implemented. This should also bring back the reason to support the --filetype flag that you mentioned.", "author": "creativitRy", "createdAt": "2020-06-16T15:21:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1NDM3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTEzNjUwMw==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/69#discussion_r441136503", "bodyText": "Looks good now.", "author": "feiling", "createdAt": "2020-06-16T20:55:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1NDM3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1NDk3NQ==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/69#discussion_r440554975", "bodyText": "Please add some comments to list the commands to\n\nbuild your program\nrun unit tests", "author": "feiling", "createdAt": "2020-06-16T02:46:47Z", "path": "tools/sql_extraction/build.gradle.kts", "diffHunk": "@@ -31,6 +38,7 @@ task<de.undercouch.gradle.tasks.download.Download>(\"downloadGrammars\") {\n     }\n     src(listOf(\"https://raw.githubusercontent.com/antlr/grammars-v4/master/java/java9/Java9.g4\"))\n     dest(\"gen/main/antlr/\")\n+    overwrite(false)\n     println(System.getProperty(\"user.dir\"))\n }\n ", "originalCommit": "4b74bf10ca47fe570b63ffce3506d201e28084f5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f6ccdb81d548c7881563760a996e52f63eb458ab", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/f6ccdb81d548c7881563760a996e52f63eb458ab", "message": "SQL Extractor: java examples, cli, file list expander and unit tests", "committedDate": "2020-06-16T19:19:45Z", "type": "forcePushed"}, {"oid": "bfeb1255ef63dc1a153af3974accc41439a1cb7d", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/bfeb1255ef63dc1a153af3974accc41439a1cb7d", "message": "SQL Extractor: java examples, cli, file list expander and unit tests", "committedDate": "2020-06-16T19:26:31Z", "type": "commit"}, {"oid": "bfeb1255ef63dc1a153af3974accc41439a1cb7d", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/bfeb1255ef63dc1a153af3974accc41439a1cb7d", "message": "SQL Extractor: java examples, cli, file list expander and unit tests", "committedDate": "2020-06-16T19:26:31Z", "type": "forcePushed"}]}