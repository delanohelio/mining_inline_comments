{"pr_number": 104, "pr_title": "Auto Query Fixer: Add Error classes to represent the BigQuery SQL errors.", "pr_createdAt": "2020-07-16T00:06:22Z", "pr_url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104", "timeline": [{"oid": "d2355b9aa3ecfe96360c54d25bc6a505de8382ce", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/d2355b9aa3ecfe96360c54d25bc6a505de8382ce", "message": "remove .idea", "committedDate": "2020-07-14T23:54:39Z", "type": "commit"}, {"oid": "55a2b8c40983c4838f18d5f847e763955aac4e0f", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/55a2b8c40983c4838f18d5f847e763955aac4e0f", "message": "Merge remote-tracking branch 'upstream/master' into master_new", "committedDate": "2020-07-15T17:06:28Z", "type": "commit"}, {"oid": "0465172fc984f9a12bf0f813e76f863ba9ca12b9", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/0465172fc984f9a12bf0f813e76f863ba9ca12b9", "message": "Add a few error classes that represents the SQL errors from BigQuery.", "committedDate": "2020-07-16T00:00:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0MzYyNQ==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455443625", "bodyText": "nit: not sure why the formatter starts new line again ==", "author": "kikkyo", "createdAt": "2020-07-16T00:40:12Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/BigQuerySqlError.java", "diffHunk": "@@ -0,0 +1,21 @@\n+package com.google.cloud.bigquery.utils.queryfixer.errors;\n+\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.utils.queryfixer.entity.Position;\n+\n+import lombok.Getter;\n+\n+/** The base class to represent the SQL Error generated by the BigQuery server. It should be resolved from\n+ * {@link BigQueryException}. */", "originalCommit": "0465172fc984f9a12bf0f813e76f863ba9ca12b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk4NTU5NQ==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455985595", "bodyText": "Ah, I think the first line is almost 100 chars, so it should be a new line.", "author": "mingen-pan", "createdAt": "2020-07-16T18:24:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0MzYyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NDExOA==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455444118", "bodyText": "nit: you can just use errorPostion - more readable and better practice.", "author": "kikkyo", "createdAt": "2020-07-16T00:42:07Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/BigQuerySemanticError.java", "diffHunk": "@@ -0,0 +1,14 @@\n+package com.google.cloud.bigquery.utils.queryfixer.errors;\n+\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.utils.queryfixer.entity.Position;\n+\n+\n+/** A class to represent the semantic errors of BigQuery.*/\n+public abstract class BigQuerySemanticError extends BigQuerySqlError {\n+\n+  public BigQuerySemanticError(Position errPos, BigQueryException errorSource) {", "originalCommit": "0465172fc984f9a12bf0f813e76f863ba9ca12b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NDQ2Nw==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455444467", "bodyText": "Should they be public fields?", "author": "kikkyo", "createdAt": "2020-07-16T00:43:24Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/BigQuerySqlError.java", "diffHunk": "@@ -0,0 +1,21 @@\n+package com.google.cloud.bigquery.utils.queryfixer.errors;\n+\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.utils.queryfixer.entity.Position;\n+\n+import lombok.Getter;\n+\n+/** The base class to represent the SQL Error generated by the BigQuery server. It should be resolved from\n+ * {@link BigQueryException}. */\n+@Getter\n+public abstract class BigQuerySqlError {\n+\n+  BigQueryException errorSource;\n+  /** The occurrence of the error at a query. It may be null if the error does not belong to any specific locations. */", "originalCommit": "0465172fc984f9a12bf0f813e76f863ba9ca12b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NTc5Ng==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455445796", "bodyText": "I think they should be protected, because they will be directly accessed by the subclasses.", "author": "mingen-pan", "createdAt": "2020-07-16T00:48:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NDQ2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk4NzE1OA==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455987158", "bodyText": "Hmm, after I rechecked the code, private should also work, I will change to private.", "author": "mingen-pan", "createdAt": "2020-07-16T18:26:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NDQ2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NDgxOA==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455444818", "bodyText": "nit: the auto formatting is really weird... :( For multiple options (1) and (2) just use new line", "author": "kikkyo", "createdAt": "2020-07-16T00:44:45Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/FunctionNotFoundError.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package com.google.cloud.bigquery.utils.queryfixer.errors;\n+\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.utils.queryfixer.entity.Position;\n+\n+import lombok.Getter;\n+\n+/** A class to represent the \"Function Not Found\" errors. The errors look like one of the two forms: (1) Function not", "originalCommit": "0465172fc984f9a12bf0f813e76f863ba9ca12b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NTY3NA==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455445674", "bodyText": "I think auto formatting does not handle it. Are you suggesting to put (1) and (2) in two different lines?", "author": "mingen-pan", "createdAt": "2020-07-16T00:47:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NDgxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NTI2NQ==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455445265", "bodyText": "nit: functionName instead of 'incorrectFunctionName'", "author": "kikkyo", "createdAt": "2020-07-16T00:46:17Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/FunctionNotFoundError.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package com.google.cloud.bigquery.utils.queryfixer.errors;\n+\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.utils.queryfixer.entity.Position;\n+\n+import lombok.Getter;\n+\n+/** A class to represent the \"Function Not Found\" errors. The errors look like one of the two forms: (1) Function not\n+ * found: [function] at [x:y] or (2) Function not found: [function]; Did you mean [suggestion]? at [x:y], where\n+ * [function] is the incorrect function, [suggestion] is one of the correct function candidates, and [x:y] is the row\n+ * and column numbers. */\n+@Getter\n+public class FunctionNotFoundError extends BigQuerySemanticError {\n+\n+  private final String incorrectFunctionName;\n+  private final String suggestion;\n+\n+\n+  public FunctionNotFoundError(String incorrectFunctionName, Position errPos, String suggestion,", "originalCommit": "0465172fc984f9a12bf0f813e76f863ba9ca12b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NTUzNA==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455445534", "bodyText": "nit: errPos -> position,", "author": "kikkyo", "createdAt": "2020-07-16T00:47:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NTI2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk5MzkwOA==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455993908", "bodyText": "Done", "author": "mingen-pan", "createdAt": "2020-07-16T18:38:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NTI2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NjA2NQ==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455446065", "bodyText": "nit: semantically it is clear the class is used to represent the errors, so you can just use \"String tableName\", \"incorrectTableName\" looks a bit redundant.", "author": "kikkyo", "createdAt": "2020-07-16T00:49:23Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/TableNotFoundError.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package com.google.cloud.bigquery.utils.queryfixer.errors;\n+\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.utils.queryfixer.entity.Position;\n+\n+import lombok.Getter;\n+\n+/** A class to represent the \"Table Not Found\" errors from BigQuery. The errors are presented in this form:\n+ * \"Not found: Table [TableName] was not found\", where TableName is the incorrect table name. */\n+@Getter\n+public class TableNotFoundError extends BigQuerySemanticError {\n+\n+  String incorrectTableName;", "originalCommit": "0465172fc984f9a12bf0f813e76f863ba9ca12b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NjY1Nw==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455446657", "bodyText": "Does bigquery error return unrecognized name? or unrecognized column name?\nIf we meant to represent unrecognized column name, maybe using unrecognizedColumnName sounds more clear", "author": "kikkyo", "createdAt": "2020-07-16T00:51:53Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/UnrecognizedNameError.java", "diffHunk": "@@ -0,0 +1,38 @@\n+package com.google.cloud.bigquery.utils.queryfixer.errors;\n+\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.utils.queryfixer.entity.Position;\n+\n+import lombok.Getter;\n+\n+/**\n+ * A class to represent the \"Unrecognized Name\" errors. The unrecognized names here actually mean\n+ * the unrecognized columns. The errors look like one of the two forms: (1) Unrecognized name:\n+ * [column] at [x:y] or (2) Unrecognized name: [column]; Did you mean [suggestion]? at [x:y], where\n+ * [column] is the incorrect column, [suggestion] is one of the correct column candidates, and [x:y]\n+ * is the row and column numbers.\n+ */\n+@Getter\n+public class UnrecognizedNameError extends BigQuerySemanticError {", "originalCommit": "0465172fc984f9a12bf0f813e76f863ba9ca12b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk5NDc3Mg==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455994772", "bodyText": "It returns \"Unrecognized name\" but it only refers to column.\nI will change the Class to UnrecognizedColumnError", "author": "mingen-pan", "createdAt": "2020-07-16T18:39:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0NjY1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0Njc1Mw==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455446753", "bodyText": "nit: unrecognizedName -> columnName if we meant it for columnName", "author": "kikkyo", "createdAt": "2020-07-16T00:52:18Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/UnrecognizedNameError.java", "diffHunk": "@@ -0,0 +1,38 @@\n+package com.google.cloud.bigquery.utils.queryfixer.errors;\n+\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.utils.queryfixer.entity.Position;\n+\n+import lombok.Getter;\n+\n+/**\n+ * A class to represent the \"Unrecognized Name\" errors. The unrecognized names here actually mean\n+ * the unrecognized columns. The errors look like one of the two forms: (1) Unrecognized name:\n+ * [column] at [x:y] or (2) Unrecognized name: [column]; Did you mean [suggestion]? at [x:y], where\n+ * [column] is the incorrect column, [suggestion] is one of the correct column candidates, and [x:y]\n+ * is the row and column numbers.\n+ */\n+@Getter\n+public class UnrecognizedNameError extends BigQuerySemanticError {\n+\n+  private final String unrecognizedName;\n+  private final String suggestion;\n+\n+  public UnrecognizedNameError(\n+      String unrecognizedName, Position errPos, String suggestion, BigQueryException errorSource) {", "originalCommit": "0465172fc984f9a12bf0f813e76f863ba9ca12b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk5NTU2Mg==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r455995562", "bodyText": "Done", "author": "mingen-pan", "createdAt": "2020-07-16T18:41:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0Njc1Mw=="}], "type": "inlineReview"}, {"oid": "b7eb53de1947c65d17ddfb6cfc988d6abda5f728", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/b7eb53de1947c65d17ddfb6cfc988d6abda5f728", "message": "refactor the code based on review", "committedDate": "2020-07-16T18:42:04Z", "type": "commit"}, {"oid": "fa4d9e8428cb506e9ae9d719f8a4171abe042699", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/fa4d9e8428cb506e9ae9d719f8a4171abe042699", "message": "change errPos to errorPosition", "committedDate": "2020-07-16T18:44:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE2Njc1OQ==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r456166759", "bodyText": "Sorry for the nit comments... but why there would be new lines in between :D? similar with the above.", "author": "kikkyo", "createdAt": "2020-07-17T01:25:21Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/BigQuerySqlError.java", "diffHunk": "@@ -5,17 +5,22 @@\n \n import lombok.Getter;\n \n-/** The base class to represent the SQL Error generated by the BigQuery server. It should be resolved from\n- * {@link BigQueryException}. */\n+/**\n+ * The base class to represent the SQL Error generated by the BigQuery server. It should be resolved\n+ * from {@link BigQueryException}.\n+ */\n @Getter\n public abstract class BigQuerySqlError {\n \n-  BigQueryException errorSource;\n-  /** The occurrence of the error at a query. It may be null if the error does not belong to any specific locations. */\n-  Position errPos;\n+  private final BigQueryException errorSource;\n+  /**\n+   * The occurrence of the error at a query. It may be null if the error does not belong to any", "originalCommit": "fa4d9e8428cb506e9ae9d719f8a4171abe042699", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjU3NTAxMQ==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r456575011", "bodyText": "After trying a few times of the auto format, I figure out I need to apply the auto format on each page. Thus, the old version is not formatted.\nI check the style guide, I think having a new line is encouraged.\nhttps://google.github.io/styleguide/javaguide.html#s7.1.1-javadoc-multi-line", "author": "mingen-pan", "createdAt": "2020-07-17T17:24:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE2Njc1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE2NzA0NQ==", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/104#discussion_r456167045", "bodyText": "same here :)", "author": "kikkyo", "createdAt": "2020-07-17T01:26:29Z", "path": "tools/automatic_query_fixer/src/main/java/com/google/cloud/bigquery/utils/queryfixer/errors/FunctionNotFoundError.java", "diffHunk": "@@ -5,27 +5,34 @@\n \n import lombok.Getter;\n \n-/** A class to represent the \"Function Not Found\" errors. The errors look like one of the two forms: (1) Function not\n- * found: [function] at [x:y] or (2) Function not found: [function]; Did you mean [suggestion]? at [x:y], where\n- * [function] is the incorrect function, [suggestion] is one of the correct function candidates, and [x:y] is the row\n- * and column numbers. */\n+/**\n+ * A class to represent the \"Function Not Found\" errors. The errors look like one of the two forms:\n+ *", "originalCommit": "fa4d9e8428cb506e9ae9d719f8a4171abe042699", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4468ee4e559b11adfa081f86e34634053360903c", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/4468ee4e559b11adfa081f86e34634053360903c", "message": "Merge branch 'master' into add_error_class", "committedDate": "2020-07-17T17:26:04Z", "type": "commit"}]}