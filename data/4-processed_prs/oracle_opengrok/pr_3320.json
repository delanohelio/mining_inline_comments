{"pr_number": 3320, "pr_title": "enable GitHub actions for building", "pr_createdAt": "2020-10-26T19:37:45Z", "pr_url": "https://github.com/oracle/opengrok/pull/3320", "timeline": [{"oid": "4e8ba95226a8acb5f899bd5b6ae0b6c2eb29248d", "url": "https://github.com/oracle/opengrok/commit/4e8ba95226a8acb5f899bd5b6ae0b6c2eb29248d", "message": "enable Github actions", "committedDate": "2020-10-26T18:37:07Z", "type": "commit"}, {"oid": "a7a60c257f13ac83ad328ed4e3e7919cc5576399", "url": "https://github.com/oracle/opengrok/commit/a7a60c257f13ac83ad328ed4e3e7919cc5576399", "message": "add on", "committedDate": "2020-10-26T18:38:49Z", "type": "commit"}, {"oid": "6780305e20e1668819c8afe60c98c0cb18839930", "url": "https://github.com/oracle/opengrok/commit/6780305e20e1668819c8afe60c98c0cb18839930", "message": "add setup-java", "committedDate": "2020-10-26T18:41:38Z", "type": "commit"}, {"oid": "6de5c297581c0bffb4685717368385e07d948328", "url": "https://github.com/oracle/opengrok/commit/6de5c297581c0bffb4685717368385e07d948328", "message": "fix name", "committedDate": "2020-10-26T18:42:31Z", "type": "commit"}, {"oid": "411e2ab49a61ae796e9d3cfae1129cf0012881f0", "url": "https://github.com/oracle/opengrok/commit/411e2ab49a61ae796e9d3cfae1129cf0012881f0", "message": "honor RUNNER_OS=Linux", "committedDate": "2020-10-26T18:45:37Z", "type": "commit"}, {"oid": "b1c0d84be26177a2ae3f8343ef1d73c211cfc0a0", "url": "https://github.com/oracle/opengrok/commit/b1c0d84be26177a2ae3f8343ef1d73c211cfc0a0", "message": "fix variable ref", "committedDate": "2020-10-26T18:47:38Z", "type": "commit"}, {"oid": "caedaf5ce477512ab33400a7e1d33775e59a80e4", "url": "https://github.com/oracle/opengrok/commit/caedaf5ce477512ab33400a7e1d33775e59a80e4", "message": "add macOS+Windows", "committedDate": "2020-10-26T18:57:57Z", "type": "commit"}, {"oid": "7bafb74fd4c53116798b5938f798886a94895326", "url": "https://github.com/oracle/opengrok/commit/7bafb74fd4c53116798b5938f798886a94895326", "message": "honor RUNNER_OS=macOS", "committedDate": "2020-10-26T19:01:36Z", "type": "commit"}, {"oid": "fb720c4a562047f5e2d118d42e62b7cc268a0070", "url": "https://github.com/oracle/opengrok/commit/fb720c4a562047f5e2d118d42e62b7cc268a0070", "message": "enable Maven cache", "committedDate": "2020-10-26T19:03:46Z", "type": "commit"}, {"oid": "ceae8bd6ce479f1138f9c1bf9c705ee5f0a378ca", "url": "https://github.com/oracle/opengrok/commit/ceae8bd6ce479f1138f9c1bf9c705ee5f0a378ca", "message": "install autoconf+automake on macOS", "committedDate": "2020-10-26T19:08:26Z", "type": "commit"}, {"oid": "9091a8e4a07f051fa5b38b0bc4a9a5403eadfce8", "url": "https://github.com/oracle/opengrok/commit/9091a8e4a07f051fa5b38b0bc4a9a5403eadfce8", "message": "run the actions for PRs too", "committedDate": "2020-10-26T19:40:45Z", "type": "commit"}, {"oid": "55a8f683258e8133c01d0bbf4e3295e9bf6dc03f", "url": "https://github.com/oracle/opengrok/commit/55a8f683258e8133c01d0bbf4e3295e9bf6dc03f", "message": "windows: install ctags+svn, run Maven", "committedDate": "2020-10-26T19:54:35Z", "type": "commit"}, {"oid": "7364a05e4da2a31c1821b4e4d52767930afcf3c6", "url": "https://github.com/oracle/opengrok/commit/7364a05e4da2a31c1821b4e4d52767930afcf3c6", "message": "enable Maven cache for Windows too", "committedDate": "2020-10-26T19:58:09Z", "type": "commit"}, {"oid": "e8f7c1aa13d3a88806bce2fc872cff93fc41882b", "url": "https://github.com/oracle/opengrok/commit/e8f7c1aa13d3a88806bce2fc872cff93fc41882b", "message": "no before actions for Windows", "committedDate": "2020-10-26T20:23:42Z", "type": "commit"}, {"oid": "ff275e62b849661abe7a08b5d40a693f86ba69fb", "url": "https://github.com/oracle/opengrok/commit/ff275e62b849661abe7a08b5d40a693f86ba69fb", "message": "no need to install Subversion on Windows", "committedDate": "2020-10-26T20:35:03Z", "type": "commit"}, {"oid": "675d990334988bca02d023f6cd7f6b32d73ead18", "url": "https://github.com/oracle/opengrok/commit/675d990334988bca02d023f6cd7f6b32d73ead18", "message": "skip MercurialRepositoryTest on Windows\n\nit times out when running 'hg update mybranch'", "committedDate": "2020-10-27T07:46:30Z", "type": "commit"}, {"oid": "1427ccfc71d146ca7b7905193343be1caf34e18e", "url": "https://github.com/oracle/opengrok/commit/1427ccfc71d146ca7b7905193343be1caf34e18e", "message": "add Apiary check", "committedDate": "2020-10-27T07:51:20Z", "type": "commit"}, {"oid": "cdf2cb315e27a71848abf5cf68d8b02f85e1c7ae", "url": "https://github.com/oracle/opengrok/commit/cdf2cb315e27a71848abf5cf68d8b02f85e1c7ae", "message": "install drafter", "committedDate": "2020-10-27T07:53:11Z", "type": "commit"}, {"oid": "26322cac0cf3f160c6e1467ae5a06e60d87f02ed", "url": "https://github.com/oracle/opengrok/commit/26322cac0cf3f160c6e1467ae5a06e60d87f02ed", "message": "add comment", "committedDate": "2020-10-27T07:56:14Z", "type": "commit"}, {"oid": "a713f1344a7f9fb59a87a82d46ee76f0975f2b5e", "url": "https://github.com/oracle/opengrok/commit/a713f1344a7f9fb59a87a82d46ee76f0975f2b5e", "message": "move Apiary blueprint check to Github actions", "committedDate": "2020-10-27T07:57:15Z", "type": "commit"}, {"oid": "8ddca3b54e064ec6e347780dec6569375ed45069", "url": "https://github.com/oracle/opengrok/commit/8ddca3b54e064ec6e347780dec6569375ed45069", "message": "restrict path", "committedDate": "2020-10-27T08:00:22Z", "type": "commit"}, {"oid": "096d2bb8d0de792dca2b4968852d69ce3def6593", "url": "https://github.com/oracle/opengrok/commit/096d2bb8d0de792dca2b4968852d69ce3def6593", "message": "revert files to avoid uncommitted changes error", "committedDate": "2020-10-27T08:11:40Z", "type": "commit"}, {"oid": "a73998433430739717a3f561a0f13b52e249748d", "url": "https://github.com/oracle/opengrok/commit/a73998433430739717a3f561a0f13b52e249748d", "message": "add Docker build", "committedDate": "2020-10-27T08:24:21Z", "type": "commit"}, {"oid": "802a85dc79bf29b5257cc700011771b70f915f9f", "url": "https://github.com/oracle/opengrok/commit/802a85dc79bf29b5257cc700011771b70f915f9f", "message": "testSymlink() fails:\n\nIndexerRepoTest.testSymlinks:193 Should match (with macOS leeway):\nC:\\Users\\RUNNER~1\\AppData\\Local\\Temp\\src14654515561148586437\\symlink\nv.\nC:\\Users\\runneradmin\\AppData\\Local\\Temp\\src14654515561148586437\\symlink", "committedDate": "2020-10-27T08:44:38Z", "type": "commit"}, {"oid": "448c330aaf8268ba45fbd1bc06a6a649e55d6f5d", "url": "https://github.com/oracle/opengrok/commit/448c330aaf8268ba45fbd1bc06a6a649e55d6f5d", "message": "revert prior to hg import", "committedDate": "2020-10-27T09:22:27Z", "type": "commit"}, {"oid": "acf42fe65da6408724f173789310235816e35f82", "url": "https://github.com/oracle/opengrok/commit/acf42fe65da6408724f173789310235816e35f82", "message": "testIndexed() fails with:\n\ncurrent version should be refreshed", "committedDate": "2020-10-27T10:08:34Z", "type": "commit"}, {"oid": "ccdbe4ca14dac739cd2f5c9676d1a3406371dd4e", "url": "https://github.com/oracle/opengrok/commit/ccdbe4ca14dac739cd2f5c9676d1a3406371dd4e", "message": "add prints", "committedDate": "2020-10-27T10:11:21Z", "type": "commit"}, {"oid": "1a66a841c48522f5698998bb8060569e129ddcf6", "url": "https://github.com/oracle/opengrok/commit/1a66a841c48522f5698998bb8060569e129ddcf6", "message": "run Javadoc refresh script", "committedDate": "2020-10-27T10:15:27Z", "type": "commit"}, {"oid": "323cc85f8424157d28196340f9f78134fd370667", "url": "https://github.com/oracle/opengrok/commit/323cc85f8424157d28196340f9f78134fd370667", "message": "remove regular builds", "committedDate": "2020-10-27T10:52:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY1MDI0NQ==", "url": "https://github.com/oracle/opengrok/pull/3320#discussion_r512650245", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  run: mvn -B -V verify\n          \n          \n            \n                  run: ./mvnw -B -V verify\n          \n      \n    \n    \n  \n\nMaybe use mvnw? I don't know what is the command on Windows to run a script :D", "author": "ahornace", "createdAt": "2020-10-27T12:27:17Z", "path": ".github/workflows/build.yml", "diffHunk": "@@ -0,0 +1,69 @@\n+name: Build\n+\n+on: [push, pull_request]\n+\n+jobs:\n+  ubuntu:\n+    name: Ubuntu with Java 11\n+    runs-on: ubuntu-latest\n+    steps:\n+    - name: Checkout master branch\n+      uses: actions/checkout@v2\n+    - name: Set up JDK 11\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: 11\n+    - name: Cache Maven packages\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.m2\n+        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n+        restore-keys: ${{ runner.os }}-m2\n+    - name: Install pre-requisites\n+      run: ./dev/before_install\n+    - name: Before build actions\n+      run: ./dev/before\n+    - name: Build\n+      run: ./dev/main\n+  macos:\n+    name: macOS with Java 11\n+    runs-on: macos-latest\n+    steps:\n+    - name: Checkout master branch\n+      uses: actions/checkout@v2\n+    - name: Set up JDK 11\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: 11\n+    - name: Cache Maven packages\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.m2\n+        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n+        restore-keys: ${{ runner.os }}-m2\n+    - name: Install pre-requisites\n+      run: ./dev/before_install\n+    - name: Before build actions\n+      run: ./dev/before\n+    - name: Build\n+      run: ./dev/main\n+  windows:\n+    name: Windows with Java 11\n+    runs-on: windows-latest\n+    steps:\n+    - name: Checkout master branch\n+      uses: actions/checkout@v2\n+    - name: Set up JDK 11\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: 11\n+    - name: Cache Maven packages\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.m2\n+        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n+        restore-keys: ${{ runner.os }}-m2\n+    - name: Install Universal ctags\n+      run: choco install universal-ctags\n+    - name: Build\n+      run: mvn -B -V verify", "originalCommit": "323cc85f8424157d28196340f9f78134fd370667", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY1NzA0Mw==", "url": "https://github.com/oracle/opengrok/pull/3320#discussion_r512657043", "bodyText": "I tried that, does not work as the default shell is Powershell. Maven is installed by default the build runs fine.", "author": "vladak", "createdAt": "2020-10-27T12:38:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY1MDI0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY2MzU4Nw==", "url": "https://github.com/oracle/opengrok/pull/3320#discussion_r512663587", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  run: ./dev/docker.sh\n          \n          \n            \n                  run: ./dev/javadoc.sh\n          \n      \n    \n    \n  \n\nMaybe this script instead of docker.sh?", "author": "ahornace", "createdAt": "2020-10-27T12:49:24Z", "path": ".github/workflows/javadoc.yml", "diffHunk": "@@ -0,0 +1,22 @@\n+name: Upload javadocs to Github pages\n+\n+on: push\n+\n+jobs:\n+  ubuntu:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - name: Checkout master branch\n+      uses: actions/checkout@v2\n+    - name: Set up JDK 11\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: 11\n+    - name: Cache Maven packages\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.m2\n+        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n+        restore-keys: ${{ runner.os }}-m2\n+    - name: Refresh Javadoc\n+      run: ./dev/docker.sh", "originalCommit": "323cc85f8424157d28196340f9f78134fd370667", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2ea8ab00f90576fc047dbdc5d75b9d0f2bb536a7", "url": "https://github.com/oracle/opengrok/commit/2ea8ab00f90576fc047dbdc5d75b9d0f2bb536a7", "message": "restrict to master branch", "committedDate": "2020-10-27T12:55:10Z", "type": "commit"}, {"oid": "57e26bf2294803342d00a61d56124e03802bfc32", "url": "https://github.com/oracle/opengrok/commit/57e26bf2294803342d00a61d56124e03802bfc32", "message": "run javadoc.sh\n\nCo-authored-by: Adam Horn\u00e1\u010dek <adam.hornacek@icloud.com>", "committedDate": "2020-10-27T13:14:56Z", "type": "commit"}]}