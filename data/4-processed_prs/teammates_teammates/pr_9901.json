{"pr_number": 9901, "pr_title": "[#9898] All records page does not show profile picture", "pr_createdAt": "2020-01-05T07:19:21Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/9901", "timeline": [{"oid": "7c707933b00ebc85b650d9605acacc26309c9688", "url": "https://github.com/TEAMMATES/teammates/commit/7c707933b00ebc85b650d9605acacc26309c9688", "message": "Fix bug", "committedDate": "2020-01-05T07:04:24Z", "type": "commit"}, {"oid": "c2819dc17cf089371dc34be2d8db04b00a2cbc46", "url": "https://github.com/TEAMMATES/teammates/commit/c2819dc17cf089371dc34be2d8db04b00a2cbc46", "message": "Fix lint error", "committedDate": "2020-01-05T07:15:49Z", "type": "commit"}, {"oid": "04348a371c4d0bfb61f40a4f762de8ce576483ce", "url": "https://github.com/TEAMMATES/teammates/commit/04348a371c4d0bfb61f40a4f762de8ce576483ce", "message": "Add snapshot", "committedDate": "2020-01-06T06:59:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE4MTk3Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/9901#discussion_r363181977", "bodyText": "Looks like snapshot testing does not capture full value.", "author": "xpdavid", "createdAt": "2020-01-06T07:21:57Z", "path": "src/web/app/pages-instructor/instructor-student-records-page/__snapshots__/instructor-student-records-page.component.spec.ts.snap", "diffHunk": "@@ -0,0 +1,29 @@\n+// Jest Snapshot v1, https://goo.gl/fbAQLP\n+\n+exports[`InstructorStudentRecordsPageComponent should snap with default fields 1`] = `\n+<tm-instructor-student-records-page\n+  courseId=\"undefined\"\n+  photoUrl={[Function String]}\n+  route={[Function ActivatedRoute]}\n+  sessions={[Function Array]}\n+  statusMessageService={[Function StatusMessageService]}\n+  studentEmail=\"undefined\"\n+  studentProfile={[Function Object]}\n+  studentProfileService={[Function StudentProfileService]}\n+>\n+  <h1>\n+    's Records\n+    <small\n+      class=\"text-muted\"\n+    >\n+       - \n+    </small>\n+  </h1><tm-student-profile\n+    ng-reflect-photo-url=\"http://localhost:8080/webapi/s\"", "originalCommit": "04348a371c4d0bfb61f40a4f762de8ce576483ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzI0ODc3MA==", "url": "https://github.com/TEAMMATES/teammates/pull/9901#discussion_r363248770", "bodyText": "I tried doing this in the past, but it seems ng-reflect has a character cap of 30, so I'm not able to see the full expression. angular/angular#28786", "author": "hcwong", "createdAt": "2020-01-06T11:02:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE4MTk3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE4MjIwNg==", "url": "https://github.com/TEAMMATES/teammates/pull/9901#discussion_r363182206", "bodyText": "We can keep the snapshot. In addition,\nI think now you can\n\ninject a fake profile data\nassert the url match your expection", "author": "xpdavid", "createdAt": "2020-01-06T07:22:52Z", "path": "src/web/app/pages-instructor/instructor-student-records-page/instructor-student-records-page.component.spec.ts", "diffHunk": "@@ -50,4 +50,8 @@ describe('InstructorStudentRecordsPageComponent', () => {\n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+\n+  it('should snap with default fields', () => {\n+    expect(fixture).toMatchSnapshot();", "originalCommit": "04348a371c4d0bfb61f40a4f762de8ce576483ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzY3MjY0MA==", "url": "https://github.com/TEAMMATES/teammates/pull/9901#discussion_r363672640", "bodyText": "I'm not quite sure how to inject the queryParams info into the subscribe callback without mocking it, but it works with undefined queryParams", "author": "hcwong", "createdAt": "2020-01-07T10:00:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE4MjIwNg=="}], "type": "inlineReview"}, {"oid": "c54e7a2de8995382d0fe746cedc68db4734e471a", "url": "https://github.com/TEAMMATES/teammates/commit/c54e7a2de8995382d0fe746cedc68db4734e471a", "message": "add assert statement for url", "committedDate": "2020-01-07T09:59:11Z", "type": "commit"}, {"oid": "ed132048644c3baf131b82267bee605a9630e9f8", "url": "https://github.com/TEAMMATES/teammates/commit/ed132048644c3baf131b82267bee605a9630e9f8", "message": "Fix bug", "committedDate": "2020-01-07T14:36:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NDg2OQ==", "url": "https://github.com/TEAMMATES/teammates/pull/9901#discussion_r363894869", "bodyText": "Great! You are on the right track. The only thing left is to inject real profile into the component. You can search on existing code (e.g. other test files) or take a look at student-course-details-page.component.spec.ts to get an idea of how to assign value to component during testing.", "author": "xpdavid", "createdAt": "2020-01-07T18:47:56Z", "path": "src/web/app/pages-instructor/instructor-student-records-page/instructor-student-records-page.component.spec.ts", "diffHunk": "@@ -50,4 +50,13 @@ describe('InstructorStudentRecordsPageComponent', () => {\n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+\n+  it('should snap with default fields', () => {\n+    expect(fixture).toMatchSnapshot();\n+  });\n+\n+  it('should output a correctly formatted url string', () => {\n+    expect(component.photoUrl)\n+      .toEqual('http://localhost:8080/webapi/student/profilePic?courseid=undefined&studentemail=undefined');", "originalCommit": "ed132048644c3baf131b82267bee605a9630e9f8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDA4MTU1NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/9901#discussion_r364081555", "bodyText": "Sorry, perhaps I should have phrased my question a little better. I'm not sure how to mock the queryParams of the ngOnInit callback. I'm trying to set the url for the specific test but I can't seem to find any examples online.\nthis.route.queryParams.subscribe((queryParams: any) => {\n      this.courseId = queryParams.courseid;\n      this.studentEmail = queryParams.studentemail;\n\n      this.loadStudentRecords();\n      this.photoUrl\n          = `${environment.backendUrl}/webapi/student/profilePic?`\n            + `courseid=${this.courseId}&studentemail=${this.studentEmail}`;\n    });", "author": "hcwong", "createdAt": "2020-01-08T06:37:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NDg2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM4ODYxNw==", "url": "https://github.com/TEAMMATES/teammates/pull/9901#discussion_r364388617", "bodyText": "https://stackoverflow.com/a/45939161 Here you go :)", "author": "xpdavid", "createdAt": "2020-01-08T18:54:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NDg2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDU1MDcyNg==", "url": "https://github.com/TEAMMATES/teammates/pull/9901#discussion_r364550726", "bodyText": "I tried this link 2 days back and it failed, turns out that I had to replace params with queryParams as stated here  zzzzz\ud83e\udd23.\nbut thanks for the help! Do you need me to squash commits or is it auto squash merge", "author": "hcwong", "createdAt": "2020-01-09T04:00:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NDg2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDU1MDg3NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/9901#discussion_r364550875", "bodyText": "\ud83d\udc4d No worry. It will be auto-squashed.", "author": "xpdavid", "createdAt": "2020-01-09T04:01:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NDg2OQ=="}], "type": "inlineReview"}, {"oid": "b47c7c0cccb1a33c8111289f989285673049285a", "url": "https://github.com/TEAMMATES/teammates/commit/b47c7c0cccb1a33c8111289f989285673049285a", "message": "Add populated snapshot", "committedDate": "2020-01-08T06:18:22Z", "type": "commit"}, {"oid": "644d13e3fda3892d98d2f4957c2e73f4450733c9", "url": "https://github.com/TEAMMATES/teammates/commit/644d13e3fda3892d98d2f4957c2e73f4450733c9", "message": "Fix test", "committedDate": "2020-01-09T03:58:45Z", "type": "commit"}, {"oid": "644d13e3fda3892d98d2f4957c2e73f4450733c9", "url": "https://github.com/TEAMMATES/teammates/commit/644d13e3fda3892d98d2f4957c2e73f4450733c9", "message": "Fix test", "committedDate": "2020-01-09T03:58:45Z", "type": "forcePushed"}, {"oid": "245e29c1a2171a23756ad6a0ad69d213eb8a079a", "url": "https://github.com/TEAMMATES/teammates/commit/245e29c1a2171a23756ad6a0ad69d213eb8a079a", "message": "Merge branch 'master' into fix/photo-not-uploaded", "committedDate": "2020-01-15T06:02:28Z", "type": "commit"}]}