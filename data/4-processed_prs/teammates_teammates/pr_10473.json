{"pr_number": 10473, "pr_title": "[#10448] Add question to session: team-contribution questions should not inherit custom visibility from previous question", "pr_createdAt": "2020-07-27T04:50:31Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10473", "timeline": [{"oid": "bccbc4780de4817c3f4b319193b2b339e2ab6b28", "url": "https://github.com/TEAMMATES/teammates/commit/bccbc4780de4817c3f4b319193b2b339e2ab6b28", "message": "add empty reject handler to handle modal close event", "committedDate": "2020-07-27T04:55:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY0NzAxNw==", "url": "https://github.com/TEAMMATES/teammates/pull/10473#discussion_r460647017", "bodyText": "The original issue was only for team contribution questions but it seems this will prevent any inheritance for questions without custom visibility settings allowed? Or are team contribution questions the only with that setting?", "author": "madanalogy", "createdAt": "2020-07-27T04:58:37Z", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -758,18 +762,50 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n         SHOW_GIVER_NAME: lastQuestionEditFormModel.showGiverNameTo,\n         SHOW_RECIPIENT_NAME: lastQuestionEditFormModel.showRecipientNameTo,\n       });\n-      this.newQuestionEditFormModel.showResponsesTo =\n+      const newQuestionShowResponsesTo: FeedbackVisibilityType[]  =\n           newQuestionVisibilityStateMachine.getVisibilityTypesUnderVisibilityControl(VisibilityControl.SHOW_RESPONSE);\n-      this.newQuestionEditFormModel.showGiverNameTo =\n+      const newQuestionShowGiverNameTo: FeedbackVisibilityType[] =\n           newQuestionVisibilityStateMachine.getVisibilityTypesUnderVisibilityControl(VisibilityControl.SHOW_GIVER_NAME);\n-      this.newQuestionEditFormModel.showRecipientNameTo =\n-          newQuestionVisibilityStateMachine.getVisibilityTypesUnderVisibilityControl(\n-              VisibilityControl.SHOW_RECIPIENT_NAME);\n+      const newQuestionShowRecipientNameTo: FeedbackVisibilityType[] =\n+          newQuestionVisibilityStateMachine\n+              .getVisibilityTypesUnderVisibilityControl(VisibilityControl.SHOW_RECIPIENT_NAME);\n+\n+      let isAllowedToUseInheritedVisibility: boolean = false;\n+      if (this.feedbackQuestionsService\n+          .isCustomFeedbackVisibilitySettingAllowed(this.newQuestionEditFormModel.questionType)) {\n+        isAllowedToUseInheritedVisibility = true;", "originalCommit": "bccbc4780de4817c3f4b319193b2b339e2ab6b28", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY0NzU4NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10473#discussion_r460647585", "bodyText": "In this case: team contribution questions the only with that setting.\nIn the future case where we add new question that only allows common feedback visibility setting, the same logic should also follow I believe (or we will end up with a new issue raised).", "author": "xpdavid", "createdAt": "2020-07-27T05:00:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY0NzAxNw=="}], "type": "inlineReview"}, {"oid": "9e83313567c34ac16b23d2c44f775bcb17c17c27", "url": "https://github.com/TEAMMATES/teammates/commit/9e83313567c34ac16b23d2c44f775bcb17c17c27", "message": "check whether it is allowed to use custom visibility settings before doing inheritance from previous question", "committedDate": "2020-07-29T01:48:47Z", "type": "commit"}, {"oid": "f0882b61b337cfd026d14e5a7582ce528cb93a67", "url": "https://github.com/TEAMMATES/teammates/commit/f0882b61b337cfd026d14e5a7582ce528cb93a67", "message": "adjust question edit UI to make save buttons aligned", "committedDate": "2020-07-29T02:08:56Z", "type": "commit"}, {"oid": "d2fa9884d311f2ec32149eeff92fbd167e85ba2b", "url": "https://github.com/TEAMMATES/teammates/commit/d2fa9884d311f2ec32149eeff92fbd167e85ba2b", "message": "add empty reject handler to handle modal close event", "committedDate": "2020-07-29T02:08:56Z", "type": "commit"}, {"oid": "d2fa9884d311f2ec32149eeff92fbd167e85ba2b", "url": "https://github.com/TEAMMATES/teammates/commit/d2fa9884d311f2ec32149eeff92fbd167e85ba2b", "message": "add empty reject handler to handle modal close event", "committedDate": "2020-07-29T02:08:56Z", "type": "forcePushed"}, {"oid": "72cd5f6e6825b3f98a77e0a550350f3520da2ec2", "url": "https://github.com/TEAMMATES/teammates/commit/72cd5f6e6825b3f98a77e0a550350f3520da2ec2", "message": "Merge branch 'master' into 10448-question-inheritence", "committedDate": "2020-07-29T08:30:45Z", "type": "commit"}]}