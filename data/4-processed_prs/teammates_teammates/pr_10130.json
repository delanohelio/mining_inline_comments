{"pr_number": 10130, "pr_title": "[#10108]  Show profile picture popover in instructor result page ", "pr_createdAt": "2020-05-28T09:39:26Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10130", "timeline": [{"oid": "2d65b61e3d72276913bc4e64f93b1a7a9a68dca3", "url": "https://github.com/TEAMMATES/teammates/commit/2d65b61e3d72276913bc4e64f93b1a7a9a68dca3", "message": "Refactor popover to view-photo-popover-component", "committedDate": "2020-05-28T02:02:44Z", "type": "commit"}, {"oid": "1b4a54df1f91dce2c5b603bc7e16ed3f6bc698c9", "url": "https://github.com/TEAMMATES/teammates/commit/1b4a54df1f91dce2c5b603bc7e16ed3f6bc698c9", "message": "Add popover to grq-rgq views", "committedDate": "2020-05-28T02:45:00Z", "type": "commit"}, {"oid": "ac2a3afb670a0ddd42d88406691de18154f0111b", "url": "https://github.com/TEAMMATES/teammates/commit/ac2a3afb670a0ddd42d88406691de18154f0111b", "message": "Add popover to per question and gqr-rqg views", "committedDate": "2020-05-28T03:09:08Z", "type": "commit"}, {"oid": "942430323be4d587a2fb6ebb36c7763a58c99385", "url": "https://github.com/TEAMMATES/teammates/commit/942430323be4d587a2fb6ebb36c7763a58c99385", "message": "Return student list popover to original behaviour", "committedDate": "2020-05-28T04:03:41Z", "type": "commit"}, {"oid": "3ce6749a13d98a9bcd52e3f23ebf9a0a7ca5c083", "url": "https://github.com/TEAMMATES/teammates/commit/3ce6749a13d98a9bcd52e3f23ebf9a0a7ca5c083", "message": "Merge branch 'master' into 10108-show-profile-popover", "committedDate": "2020-05-28T06:32:15Z", "type": "commit"}, {"oid": "6f5fae876c496e0434c78b38a643493475bce673", "url": "https://github.com/TEAMMATES/teammates/commit/6f5fae876c496e0434c78b38a643493475bce673", "message": "Shift email init logic up", "committedDate": "2020-05-28T07:01:20Z", "type": "commit"}, {"oid": "1161e8a66e2d2acf64d676f400a59985adc018f6", "url": "https://github.com/TEAMMATES/teammates/commit/1161e8a66e2d2acf64d676f400a59985adc018f6", "message": "Add popover to question view", "committedDate": "2020-05-28T07:26:25Z", "type": "commit"}, {"oid": "946634d45aa029a98252c0bf200fcb8b765e1d67", "url": "https://github.com/TEAMMATES/teammates/commit/946634d45aa029a98252c0bf200fcb8b765e1d67", "message": "Shift td tags outwards from per question view", "committedDate": "2020-05-28T08:03:01Z", "type": "commit"}, {"oid": "8b46809648ce04ffcbf7a9cf0b07be8385d28fcc", "url": "https://github.com/TEAMMATES/teammates/commit/8b46809648ce04ffcbf7a9cf0b07be8385d28fcc", "message": "Update snapshots and fix linting issues", "committedDate": "2020-05-28T08:30:31Z", "type": "commit"}, {"oid": "de10d8182efd61285841818f8be7156a5ef89875", "url": "https://github.com/TEAMMATES/teammates/commit/de10d8182efd61285841818f8be7156a5ef89875", "message": "Make click event stop at popover", "committedDate": "2020-05-28T09:40:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5MDE4OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432090188", "bodyText": "The component should be in TeammatesCommon module right?", "author": "xpdavid", "createdAt": "2020-05-28T20:00:46Z", "path": "src/web/app/pages-instructor/view-photo-popover/view-photo-popover.component.ts", "diffHunk": "@@ -0,0 +1,30 @@\n+import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\n+\n+/**\n+ * Component to display a popover for photos\n+ */\n+@Component({\n+  selector: 'tm-view-photo-popover',\n+  templateUrl: './view-photo-popover.component.html',\n+  styleUrls: ['./view-photo-popover.component.scss'],\n+})\n+export class ViewPhotoPopoverComponent implements OnInit {", "originalCommit": "de10d8182efd61285841818f8be7156a5ef89875", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5MTcxNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432091715", "bodyText": "I am not sure why do we need this event for parent to handle.\nParent can just pass the full photoUrl. There is a new attribute in the component called isPhotoShown. Once the View photo is clicked, the attribute change and the photo is shown.", "author": "xpdavid", "createdAt": "2020-05-28T20:02:52Z", "path": "src/web/app/pages-instructor/view-photo-popover/view-photo-popover.component.ts", "diffHunk": "@@ -0,0 +1,30 @@\n+import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\n+\n+/**\n+ * Component to display a popover for photos\n+ */\n+@Component({\n+  selector: 'tm-view-photo-popover',\n+  templateUrl: './view-photo-popover.component.html',\n+  styleUrls: ['./view-photo-popover.component.scss'],\n+})\n+export class ViewPhotoPopoverComponent implements OnInit {\n+\n+  @Input()\n+  photoUrl: string = '';\n+\n+  @Input()\n+  isContentAvailable: boolean = true;\n+\n+  @Output()\n+  loadPhotoEvent: EventEmitter<any> = new EventEmitter();", "originalCommit": "de10d8182efd61285841818f8be7156a5ef89875", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjIyOTU3OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432229578", "bodyText": "My initial thought was to have the event so we can sync up all of the popovers.\nFor example, in the gqr-rqg component, it has a per-question-view-response component which also has the popover.  I tried this feature in V6 and if you click on the view photo of a user in the per-question view, the header with the user name will also show the photo instead of the view photo link like shown below:\n\nSo i thought we needed some way for the popover in per-question view to communicate with the popover in the gqr-rqg parent component. Thus, i used the event.\nWould there perhaps be a simpler way to do this? If we just change the attribute to isPhotoShown we still need to sync up the different popovers in the page right?", "author": "t-cheepeng", "createdAt": "2020-05-29T02:56:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5MTcxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0MDY5OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432240698", "bodyText": "I think the simplest way is to remove the sync-up LOL.\nJustification: photoUrl is not some resources requires explicit REST loading or form sync up. Therefore, it is a bit strange to pop up the event to the root page for loading.\nA simpler implementation: keep a Set at root page to indicates which email get loaded. Pass the set to the child components. Child components fire events when the photo get loaded. There is no need to generate the URL at root page.\nWhat do you think?", "author": "xpdavid", "createdAt": "2020-05-29T03:49:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5MTcxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0MzU5NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432243595", "bodyText": "Hmm alright, i think we can just remove the sync-up. Can always add it back in the future if we need the syncing \ud83d\udc4d", "author": "t-cheepeng", "createdAt": "2020-05-29T04:01:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5MTcxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NDA2OQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432094069", "bodyText": "You already have email and courseId here, don't you?", "author": "xpdavid", "createdAt": "2020-05-28T20:07:32Z", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.html", "diffHunk": "@@ -31,7 +31,9 @@\n <ng-template #userTab let-userInfo='userInfo'>\n   <div class=\"card top-padded\">\n     <div class=\"card-header bg-primary text-white\" (click)=\"userExpanded[userInfo] = !userExpanded[userInfo]\">\n-      {{ isGqr ? 'From' : 'To' }}: {{ userInfo }}\n+      <tm-view-photo-popover [photoUrl]=\"userToPhotoUrl[userInfo]\" (loadPhotoEvent)=\"loadPhotoHandler(userInfo)\">", "originalCommit": "de10d8182efd61285841818f8be7156a5ef89875", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTQ5Ng==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432095496", "bodyText": "I don't think topName is a good name. Actually the original expression looks better", "author": "xpdavid", "createdAt": "2020-05-28T20:10:13Z", "path": "src/web/app/components/question-responses/grouped-responses/grouped-responses.component.html", "diffHunk": "@@ -2,10 +2,14 @@\n     *ngIf=\"responses.length && responses[0].allResponses.length\">\n   <div class=\"col-md-3\">\n     <div>\n-      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}} {{ teamInfo[isGrq ? 'recipient' : 'giver'] }}\n+      <tm-view-photo-popover [photoUrl]=\"userToPhotoUrl[topName]\" (loadPhotoEvent)=\"loadPhotoEvent.emit(topName)\">\n+        {{ isGrq ? 'To' : 'From' }}: {{ topName }} {{ teamInfo[isGrq ? 'recipient' : 'giver'] }}", "originalCommit": "de10d8182efd61285841818f8be7156a5ef89875", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE5NTQ0OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432195448", "bodyText": "Okay will revert to original expr", "author": "t-cheepeng", "createdAt": "2020-05-29T00:31:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTQ5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NjI0NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432096245", "bodyText": "What does isContentAvailable control?", "author": "xpdavid", "createdAt": "2020-05-28T20:11:45Z", "path": "src/web/app/pages-instructor/view-photo-popover/view-photo-popover.component.ts", "diffHunk": "@@ -0,0 +1,30 @@\n+import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\n+\n+/**\n+ * Component to display a popover for photos\n+ */\n+@Component({\n+  selector: 'tm-view-photo-popover',\n+  templateUrl: './view-photo-popover.component.html',\n+  styleUrls: ['./view-photo-popover.component.scss'],\n+})\n+export class ViewPhotoPopoverComponent implements OnInit {\n+\n+  @Input()\n+  photoUrl: string = '';\n+\n+  @Input()\n+  isContentAvailable: boolean = true;", "originalCommit": "de10d8182efd61285841818f8be7156a5ef89875", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE5NjM4NA==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432196384", "bodyText": "This is for the student list. If there is something between the tm-view-photo-popover tag, like the GRQ views, the view photo hyperlink shows in the popover. If its just a opening and closing tag, the view photo hyperlink shows like in student list", "author": "t-cheepeng", "createdAt": "2020-05-29T00:35:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE5NjczNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432196735", "bodyText": "Then we should have a better naming for it?", "author": "xpdavid", "createdAt": "2020-05-29T00:36:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE5NzI4Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432197287", "bodyText": "Alright. How would isViewPhotoLinkInPopover sound?", "author": "t-cheepeng", "createdAt": "2020-05-29T00:39:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE5NzUzOQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432197539", "bodyText": "That is definitely better than isContentAvailable \ud83d\udcaf", "author": "xpdavid", "createdAt": "2020-05-29T00:40:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NjI0NQ=="}], "type": "inlineReview"}, {"oid": "23338e6564e90f8005b1b6acf587cdd5124ee9a6", "url": "https://github.com/TEAMMATES/teammates/commit/23338e6564e90f8005b1b6acf587cdd5124ee9a6", "message": "Merge branch 'master' into 10108-show-profile-popover", "committedDate": "2020-05-29T02:06:54Z", "type": "commit"}, {"oid": "9813839d0167d383cc8a83293d0d92c7af949409", "url": "https://github.com/TEAMMATES/teammates/commit/9813839d0167d383cc8a83293d0d92c7af949409", "message": "Shift popover to tm common module and fix var name", "committedDate": "2020-05-29T02:21:18Z", "type": "commit"}, {"oid": "e676b27a4da3240c1c2d30a3a0d5daef27b7a6d5", "url": "https://github.com/TEAMMATES/teammates/commit/e676b27a4da3240c1c2d30a3a0d5daef27b7a6d5", "message": "Remove syncing of view photo popovers", "committedDate": "2020-05-29T04:39:14Z", "type": "commit"}, {"oid": "a7d1d5473d783562545b08e3d2eed7817aee04be", "url": "https://github.com/TEAMMATES/teammates/commit/a7d1d5473d783562545b08e3d2eed7817aee04be", "message": "Update snapshots and fix lint issues", "committedDate": "2020-05-29T04:46:48Z", "type": "commit"}, {"oid": "9488b0b84c8f5d9c6aa8237b926dfc963cb10a2e", "url": "https://github.com/TEAMMATES/teammates/commit/9488b0b84c8f5d9c6aa8237b926dfc963cb10a2e", "message": "Merge branch 'master' into 10108-show-profile-popover", "committedDate": "2020-05-29T04:52:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NDgwMQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432254801", "bodyText": "userToEmail[userInfo] is more important so it should be\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  <tm-view-photo-popover [photoUrl]=\"session.courseId | formatPhotoUrl: userToEmail[userInfo]\">\n          \n          \n            \n                  <tm-view-photo-popover [photoUrl]=\"userToEmail[userInfo] | formatPhotoUrl: session.courseId\">\n          \n      \n    \n    \n  \n\n?", "author": "xpdavid", "createdAt": "2020-05-29T04:53:57Z", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.html", "diffHunk": "@@ -31,7 +31,9 @@\n <ng-template #userTab let-userInfo='userInfo'>\n   <div class=\"card top-padded\">\n     <div class=\"card-header bg-primary text-white\" (click)=\"userExpanded[userInfo] = !userExpanded[userInfo]\">\n-      {{ isGqr ? 'From' : 'To' }}: {{ userInfo }}\n+      <tm-view-photo-popover [photoUrl]=\"session.courseId | formatPhotoUrl: userToEmail[userInfo]\">", "originalCommit": "9488b0b84c8f5d9c6aa8237b926dfc963cb10a2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI2NTAyNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432265025", "bodyText": "fixed", "author": "t-cheepeng", "createdAt": "2020-05-29T05:36:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NDgwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NTIyOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432255228", "bodyText": "There should be a two-spaces indentation here?", "author": "xpdavid", "createdAt": "2020-05-29T04:56:00Z", "path": "src/web/app/components/question-responses/per-question-view-responses/per-question-view-responses.component.html", "diffHunk": "@@ -34,9 +34,17 @@\n     <tbody>\n       <tr *ngFor=\"let response of responsesToShow\">\n         <td *ngIf=\"showGiver\">{{ response.giverTeam }}</td>\n-        <td *ngIf=\"showGiver\">{{ response.giver }}</td>\n+        <td *ngIf=\"showGiver\">\n+        <tm-view-photo-popover [photoUrl]=\"session.courseId | formatPhotoUrl: userToEmail[response.giver]\">", "originalCommit": "9488b0b84c8f5d9c6aa8237b926dfc963cb10a2e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NTUzOQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432255539", "bodyText": "Unnecessary changes?", "author": "xpdavid", "createdAt": "2020-05-29T04:57:22Z", "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-question-view.component.html", "diffHunk": "@@ -10,7 +10,7 @@\n     <tm-per-question-view-responses [responses]=\"question.responses\" [section]=\"section\" [sectionType]=\"sectionType\" [session]=\"session\"\n                                     [indicateMissingResponses]=\"true\" [question]=\"question.question\"\n                                     [instructorCommentTableModel]=\"instructorCommentTableModel\"\n-                                    (instructorCommentTableModelChange)=\"triggerInstructorCommentTableModelChange($event)\"\n+                                    (instructorCommentTableModelChange)=\"triggerInstructorCommentTableModelChange($event);\"", "originalCommit": "9488b0b84c8f5d9c6aa8237b926dfc963cb10a2e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NjIyOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432256228", "bodyText": "Not used?", "author": "xpdavid", "createdAt": "2020-05-29T05:00:05Z", "path": "src/web/app/components/question-responses/grouped-responses/grouped-responses.component.ts", "diffHunk": "@@ -22,6 +22,7 @@ export class GroupedResponsesComponent extends ResponsesInstructorCommentsBase i\n   CommentRowMode: typeof CommentRowMode = CommentRowMode;\n \n   @Input() responses: QuestionOutput[] = [];\n+  @Input() userToEmail: Record<string, string> = {};", "originalCommit": "9488b0b84c8f5d9c6aa8237b926dfc963cb10a2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1OTgwMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10130#discussion_r432259800", "bodyText": "It's used in the template for grouped-responses.component", "author": "t-cheepeng", "createdAt": "2020-05-29T05:16:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NjIyOA=="}], "type": "inlineReview"}, {"oid": "94ebfd2e989d6ff7d61255710107ff0f032d8b89", "url": "https://github.com/TEAMMATES/teammates/commit/94ebfd2e989d6ff7d61255710107ff0f032d8b89", "message": "Change argument order in formatPhotoUrl pipe", "committedDate": "2020-05-29T05:30:43Z", "type": "commit"}, {"oid": "27da626d4273efd1c8888773f8bc72d3885acc02", "url": "https://github.com/TEAMMATES/teammates/commit/27da626d4273efd1c8888773f8bc72d3885acc02", "message": "Merge branch 'master' into 10108-show-profile-popover", "committedDate": "2020-05-29T05:58:57Z", "type": "commit"}]}