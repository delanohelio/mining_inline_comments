{"pr_number": 10117, "pr_title": "[#10104] Append team name to participants name", "pr_createdAt": "2020-05-26T04:11:52Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10117", "timeline": [{"oid": "557dcbe80b885fd0ac715e5d780a2e8e68d66cc3", "url": "https://github.com/TEAMMATES/teammates/commit/557dcbe80b885fd0ac715e5d780a2e8e68d66cc3", "message": "Add usersToTeams map for grq-rgq-view-responses.component", "committedDate": "2020-05-25T15:57:13Z", "type": "commit"}, {"oid": "440090fc9d0bb24340d2e7935bf9971b705e441b", "url": "https://github.com/TEAMMATES/teammates/commit/440090fc9d0bb24340d2e7935bf9971b705e441b", "message": "Fix empty bracket bug", "committedDate": "2020-05-26T03:52:58Z", "type": "commit"}, {"oid": "bbfcda22de5ddb9c45b51eb38e87a434030b1883", "url": "https://github.com/TEAMMATES/teammates/commit/bbfcda22de5ddb9c45b51eb38e87a434030b1883", "message": "Convert string literals to template string", "committedDate": "2020-05-26T04:04:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzE4Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430147187", "bodyText": "Till this point, you are still dealing with data. So let's not do data formatting here (i.e. remove the brackets)", "author": "xpdavid", "createdAt": "2020-05-26T04:16:55Z", "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts", "diffHunk": "@@ -68,31 +69,35 @@ export class GrqRgqViewResponsesComponent extends ResponsesInstructorCommentsBas\n   private filterResponses(): void {\n     this.responsesToShow = {};\n     this.teamsToUsers = {};\n+    this.usersToTeams = {};\n     this.teamExpanded = {};\n     this.userExpanded = {};\n     for (const question of this.responses) {\n       for (const response of question.allResponses) {\n         if (this.isGrq) {\n           this.teamsToUsers[response.giverTeam] = this.teamsToUsers[response.giverTeam] || [];\n+          this.usersToTeams[response.giver] = this.usersToTeams[response.giver] || [];\n           if (this.teamsToUsers[response.giverTeam].indexOf(response.giver) === -1) {\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n+            this.usersToTeams[response.giver].push(`(${response.giverTeam})`);", "originalCommit": "bbfcda22de5ddb9c45b51eb38e87a434030b1883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzM4MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430147381", "bodyText": "Do you accidentally change the if statement?", "author": "xpdavid", "createdAt": "2020-05-26T04:17:59Z", "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts", "diffHunk": "@@ -68,31 +69,35 @@ export class GrqRgqViewResponsesComponent extends ResponsesInstructorCommentsBas\n   private filterResponses(): void {\n     this.responsesToShow = {};\n     this.teamsToUsers = {};\n+    this.usersToTeams = {};\n     this.teamExpanded = {};\n     this.userExpanded = {};\n     for (const question of this.responses) {\n       for (const response of question.allResponses) {\n         if (this.isGrq) {\n           this.teamsToUsers[response.giverTeam] = this.teamsToUsers[response.giverTeam] || [];\n+          this.usersToTeams[response.giver] = this.usersToTeams[response.giver] || [];\n           if (this.teamsToUsers[response.giverTeam].indexOf(response.giver) === -1) {\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n+            this.usersToTeams[response.giver].push(`(${response.giverTeam})`);\n             this.teamExpanded[response.giverTeam] = false;\n           }\n           this.userExpanded[response.giver] = false;\n-        } else {\n-          if (!response.recipientTeam) {\n-            // Recipient is team\n-            this.teamsToUsers[response.recipient] = this.teamsToUsers[response.recipient] || [];\n-            if (this.teamsToUsers[response.recipient].indexOf(response.recipient) === -1) {\n-              this.teamsToUsers[response.recipient].push(response.recipient);\n-              this.teamExpanded[response.recipient] = false;\n-            }\n-            this.userExpanded[response.recipient] = false;\n-            continue;\n+        } else if (!response.recipientTeam) {", "originalCommit": "bbfcda22de5ddb9c45b51eb38e87a434030b1883", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0ODI5MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430148290", "bodyText": "Nope I did it on purpose. The if ... continue logic could just be simplified with a if else condition branch imo\nThere were 3 distinct cases that were being managed separately from each other, so I figured it would make more sense to display them as 3 distinct options in an if else branch sequence. The logic didn't change, only the implementation that I believe would help with code clarity.", "author": "madanalogy", "createdAt": "2020-05-26T04:22:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzM4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0OTQwMQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430149401", "bodyText": "I don't think the simplification make thing clearer as the previous if-else branch make clear distinguish between true/false value of isGrq.\nAnother way to think of this is by looking at this chunk:\n\n  \n    \n      teammates/src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts\n    \n    \n        Lines 77 to 104\n      in\n      bbfcda2\n    \n    \n    \n    \n\n        \n          \n           if (this.isGrq) { \n        \n\n        \n          \n             this.teamsToUsers[response.giverTeam] = this.teamsToUsers[response.giverTeam] || []; \n        \n\n        \n          \n             this.usersToTeams[response.giver] = this.usersToTeams[response.giver] || []; \n        \n\n        \n          \n             if (this.teamsToUsers[response.giverTeam].indexOf(response.giver) === -1) { \n        \n\n        \n          \n               this.teamsToUsers[response.giverTeam].push(response.giver); \n        \n\n        \n          \n               this.usersToTeams[response.giver].push(`(${response.giverTeam})`); \n        \n\n        \n          \n               this.teamExpanded[response.giverTeam] = false; \n        \n\n        \n          \n             } \n        \n\n        \n          \n             this.userExpanded[response.giver] = false; \n        \n\n        \n          \n           } else if (!response.recipientTeam) { \n        \n\n        \n          \n             // Recipient is team \n        \n\n        \n          \n             this.teamsToUsers[response.recipient] = this.teamsToUsers[response.recipient] || []; \n        \n\n        \n          \n             this.usersToTeams[response.recipient] = this.usersToTeams[response.recipient] || []; \n        \n\n        \n          \n             if (this.teamsToUsers[response.recipient].indexOf(response.recipient) === -1) { \n        \n\n        \n          \n               this.teamsToUsers[response.recipient].push(response.recipient); \n        \n\n        \n          \n               this.teamExpanded[response.recipient] = false; \n        \n\n        \n          \n             } \n        \n\n        \n          \n             this.userExpanded[response.recipient] = false; \n        \n\n        \n          \n           } else { \n        \n\n        \n          \n             this.teamsToUsers[response.recipientTeam] = this.teamsToUsers[response.recipientTeam] || []; \n        \n\n        \n          \n             this.usersToTeams[response.recipient] = this.usersToTeams[response.recipient] || []; \n        \n\n        \n          \n             if (this.teamsToUsers[response.recipientTeam].indexOf(response.recipient) === -1) { \n        \n\n        \n          \n               this.teamsToUsers[response.recipientTeam].push(response.recipient); \n        \n\n        \n          \n               this.usersToTeams[response.recipient].push(`(${response.recipientTeam})`); \n        \n\n        \n          \n               this.teamExpanded[response.recipientTeam] = false; \n        \n\n        \n          \n             } \n        \n\n        \n          \n             this.userExpanded[response.recipient] = false; \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nCan you immediately tells what code will be executed if isGrq is false.", "author": "xpdavid", "createdAt": "2020-05-26T04:28:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzM4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0OTg2Ng==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430149866", "bodyText": "Ah okay I get what you mean, the more important distinction is in isGrq. I'll revert the changes then :)", "author": "madanalogy", "createdAt": "2020-05-26T04:30:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzM4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE4NzU4MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430187580", "bodyText": "I reverted the top level branch tree but kept the changes to the nested branch (i.e. use if else instead of if continue. Let me know if there's any issue with that, thanks!", "author": "madanalogy", "createdAt": "2020-05-26T06:42:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzM4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzU0Mg==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430147542", "bodyText": "Try this https://stackoverflow.com/a/43710820", "author": "xpdavid", "createdAt": "2020-05-26T04:18:49Z", "path": "src/web/app/components/question-responses/grouped-responses/grouped-responses.component.html", "diffHunk": "@@ -2,10 +2,10 @@\n     *ngIf=\"responses.length && responses[0].allResponses.length\">\n   <div class=\"col-md-3\">\n     <div>\n-      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}}\n+      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}} {{ isGrq ? responses[0].allResponses[0].recipientTeam != '' ? '(' + responses[0].allResponses[0].recipientTeam + ')' : '' : '(' + responses[0].allResponses[0].giverTeam + ')'}}", "originalCommit": "bbfcda22de5ddb9c45b51eb38e87a434030b1883", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0ODQzNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430148435", "bodyText": "Yeap I'll take a look, thanks!", "author": "madanalogy", "createdAt": "2020-05-26T04:23:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzU0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzU5NA==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430147594", "bodyText": "Same here", "author": "xpdavid", "createdAt": "2020-05-26T04:19:06Z", "path": "src/web/app/components/question-responses/grouped-responses/grouped-responses.component.html", "diffHunk": "@@ -2,10 +2,10 @@\n     *ngIf=\"responses.length && responses[0].allResponses.length\">\n   <div class=\"col-md-3\">\n     <div>\n-      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}}\n+      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}} {{ isGrq ? responses[0].allResponses[0].recipientTeam != '' ? '(' + responses[0].allResponses[0].recipientTeam + ')' : '' : '(' + responses[0].allResponses[0].giverTeam + ')'}}\n     </div>\n     <div class=\"top-padded\">\n-      {{ isGrq ? 'From' : 'To' }}: {{ responses[0].allResponses[0][isGrq ? 'giver' : 'recipient']}}\n+      {{ isGrq ? 'From' : 'To' }}: {{ responses[0].allResponses[0][isGrq ? 'giver' : 'recipient']}} {{ isGrq ? '(' + responses[0].allResponses[0].giverTeam + ')' : responses[0].allResponses[0].recipientTeam != '' ? '(' + responses[0].allResponses[0].recipientTeam + ')' : ''}}", "originalCommit": "bbfcda22de5ddb9c45b51eb38e87a434030b1883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8e252a3b7c820cd013ab3d88bb9796ce939c56dc", "url": "https://github.com/TEAMMATES/teammates/commit/8e252a3b7c820cd013ab3d88bb9796ce939c56dc", "message": "Move formatting to html", "committedDate": "2020-05-26T06:16:06Z", "type": "commit"}, {"oid": "030d221240ac4b7218122ad50edf5905c7455195", "url": "https://github.com/TEAMMATES/teammates/commit/030d221240ac4b7218122ad50edf5905c7455195", "message": "Move fromTo logic to ts file", "committedDate": "2020-05-26T06:33:41Z", "type": "commit"}, {"oid": "73ae6401c2fcca3875d6169e636f14fb0d2b7817", "url": "https://github.com/TEAMMATES/teammates/commit/73ae6401c2fcca3875d6169e636f14fb0d2b7817", "message": "Merge branch 'master' into 10104-usersToTeams\n\n# Conflicts:\n#\tsrc/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts", "committedDate": "2020-05-26T06:38:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE5Mjc0Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430192747", "bodyText": "A thing to note here is that you do not need to combine the string. It would make thing more complicated.. At least, you will find it is hard to give a proper name to it.\nMy suggestions is that you only need to append the suffix:\n{{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}} {{ teamInfo }}", "author": "xpdavid", "createdAt": "2020-05-26T06:54:38Z", "path": "src/web/app/components/question-responses/grouped-responses/grouped-responses.component.html", "diffHunk": "@@ -2,10 +2,10 @@\n     *ngIf=\"responses.length && responses[0].allResponses.length\">\n   <div class=\"col-md-3\">\n     <div>\n-      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}}\n+      {{ fromToTop }}", "originalCommit": "73ae6401c2fcca3875d6169e636f14fb0d2b7817", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE5NDY5OQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430194699", "bodyText": "A user can only belong to one team right?", "author": "xpdavid", "createdAt": "2020-05-26T06:59:04Z", "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts", "diffHunk": "@@ -46,6 +47,7 @@ export class GrqRgqViewResponsesComponent extends ResponsesInstructorCommentsBas\n   @Input() isGrq: boolean = true;\n \n   teamsToUsers: Record<string, string[]> = {};\n+  usersToTeams: Record<string, string[]> = {};", "originalCommit": "73ae6401c2fcca3875d6169e636f14fb0d2b7817", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9b9b00962e45182bd9f62a7e8643be85eafdb140", "url": "https://github.com/TEAMMATES/teammates/commit/9b9b00962e45182bd9f62a7e8643be85eafdb140", "message": "Apply suggestions from code review", "committedDate": "2020-05-26T08:36:21Z", "type": "commit"}, {"oid": "a394072ab3390c85f4a75493fda4052a31bf68e2", "url": "https://github.com/TEAMMATES/teammates/commit/a394072ab3390c85f4a75493fda4052a31bf68e2", "message": "Fix lint errors", "committedDate": "2020-05-26T08:39:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI2MTU2MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430261560", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  {{ isGrq ? 'From' : 'To' }}: {{ userInfo }} {{ usersToTeams[userInfo] != '' ? '(' + usersToTeams[userInfo] + ')' : ''}}\n          \n          \n            \n                  {{ isGrq ? 'From' : 'To' }}: {{ userInfo }} {{ usersToTeams[userInfo] !== '' ? '(' + usersToTeams[userInfo] + ')' : ''}}", "author": "xpdavid", "createdAt": "2020-05-26T09:00:19Z", "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.html", "diffHunk": "@@ -33,7 +33,7 @@\n <ng-template #userTab let-userInfo='userInfo'>\n   <div class=\"card top-padded\">\n     <div class=\"card-header bg-primary text-white\" (click)=\"userExpanded[userInfo] = !userExpanded[userInfo]\">\n-      {{ isGrq ? 'From' : 'To' }}: {{ userInfo }}\n+      {{ isGrq ? 'From' : 'To' }}: {{ userInfo }} {{ usersToTeams[userInfo] != '' ? '(' + usersToTeams[userInfo] + ')' : ''}}", "originalCommit": "a394072ab3390c85f4a75493fda4052a31bf68e2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2966d3184c4354d1d11c3b62eb8c88db78fa1f09", "url": "https://github.com/TEAMMATES/teammates/commit/2966d3184c4354d1d11c3b62eb8c88db78fa1f09", "message": "Update src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.html\n\nCo-authored-by: Xiao Pu <xp.xiaopu@gmail.com>", "committedDate": "2020-05-26T09:09:44Z", "type": "commit"}]}