{"pr_number": 10301, "pr_title": "[#9495] Add cancel button when editing an existing session", "pr_createdAt": "2020-07-12T07:53:23Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10301", "timeline": [{"oid": "6137c97c15932691a731d373d8c27c6cf0f120f9", "url": "https://github.com/TEAMMATES/teammates/commit/6137c97c15932691a731d373d8c27c6cf0f120f9", "message": "Adds \"Discard\" button to session edit", "committedDate": "2019-03-13T18:24:40Z", "type": "commit"}, {"oid": "9cf84afaef4665b85c6bb202cf515bdbd73ace33", "url": "https://github.com/TEAMMATES/teammates/commit/9cf84afaef4665b85c6bb202cf515bdbd73ace33", "message": "Merge branch 'master' into 9495-Cancel-Button", "committedDate": "2019-03-13T18:27:25Z", "type": "commit"}, {"oid": "a3fba8f35075c6e12ce7cef584d6ce6c6f789cb6", "url": "https://github.com/TEAMMATES/teammates/commit/a3fba8f35075c6e12ce7cef584d6ce6c6f789cb6", "message": "Removes unnecessary change.", "committedDate": "2019-03-13T18:39:22Z", "type": "commit"}, {"oid": "3dd9e825e78f6c07a5a2c42c37d2da9213288d45", "url": "https://github.com/TEAMMATES/teammates/commit/3dd9e825e78f6c07a5a2c42c37d2da9213288d45", "message": "Added warning modal and tooltip", "committedDate": "2019-03-13T22:26:20Z", "type": "commit"}, {"oid": "11d93a87894a8419c0d089d495c7143fa85b6d08", "url": "https://github.com/TEAMMATES/teammates/commit/11d93a87894a8419c0d089d495c7143fa85b6d08", "message": "Update package.json", "committedDate": "2019-03-13T22:38:08Z", "type": "commit"}, {"oid": "b285f5f1948638a570ae2d0ca8b0cbfad6ad8525", "url": "https://github.com/TEAMMATES/teammates/commit/b285f5f1948638a570ae2d0ca8b0cbfad6ad8525", "message": "Changes modal text to match others", "committedDate": "2019-03-13T22:49:08Z", "type": "commit"}, {"oid": "651bd2603a87e56e4d8123494a7bb00dc623b04f", "url": "https://github.com/TEAMMATES/teammates/commit/651bd2603a87e56e4d8123494a7bb00dc623b04f", "message": "Removes call to backend, instead stores session instructions locally on clicking \"Edit\"", "committedDate": "2019-03-14T15:11:35Z", "type": "commit"}, {"oid": "2fd47a928375aff25031b33bcf0d180362891d2a", "url": "https://github.com/TEAMMATES/teammates/commit/2fd47a928375aff25031b33bcf0d180362891d2a", "message": "Merge branch '9495-Cancel-Button' of https://github.com/martinoamigo/teammates into 9495-Cancel-Button", "committedDate": "2019-03-14T15:12:32Z", "type": "commit"}, {"oid": "2130aa1cf78a97d3c90d8ac4484d1337efb5f406", "url": "https://github.com/TEAMMATES/teammates/commit/2130aa1cf78a97d3c90d8ac4484d1337efb5f406", "message": "fixes linting issues", "committedDate": "2019-03-14T21:44:33Z", "type": "commit"}, {"oid": "b1b778ef295704f0ef8df89fb5df4fb59d6867ec", "url": "https://github.com/TEAMMATES/teammates/commit/b1b778ef295704f0ef8df89fb5df4fb59d6867ec", "message": "Uses getSessionEditFormModel to update form", "committedDate": "2019-03-15T15:07:15Z", "type": "commit"}, {"oid": "bc8829d60d18c515d9495ffac5111436040e6da2", "url": "https://github.com/TEAMMATES/teammates/commit/bc8829d60d18c515d9495ffac5111436040e6da2", "message": "tslint ignores no null assertion for one line", "committedDate": "2019-03-15T15:45:47Z", "type": "commit"}, {"oid": "0e6f94357e608d57afcc71cd92e0943725cc60f1", "url": "https://github.com/TEAMMATES/teammates/commit/0e6f94357e608d57afcc71cd92e0943725cc60f1", "message": "Merge branch 'master' into 9495-Cancel-Button", "committedDate": "2019-03-18T16:05:33Z", "type": "commit"}, {"oid": "7581e680f1abc22543b12a90f983b31bbb26b6ec", "url": "https://github.com/TEAMMATES/teammates/commit/7581e680f1abc22543b12a90f983b31bbb26b6ec", "message": "Merge branch 'master' into 9495-Cancel-Button", "committedDate": "2019-03-19T21:33:37Z", "type": "commit"}, {"oid": "06becf063984f787cd901b644ada97b3f7106cd3", "url": "https://github.com/TEAMMATES/teammates/commit/06becf063984f787cd901b644ada97b3f7106cd3", "message": "Removed Map for FeedbackSession", "committedDate": "2019-04-10T16:40:39Z", "type": "commit"}, {"oid": "2a18bcea4dd7b6dc1ac695e188f67ac790a38556", "url": "https://github.com/TEAMMATES/teammates/commit/2a18bcea4dd7b6dc1ac695e188f67ac790a38556", "message": "Renamed variables and updated comments", "committedDate": "2019-06-07T14:24:35Z", "type": "commit"}, {"oid": "6faf79dd8fae6d7cf10f0cf0428170f5753180e2", "url": "https://github.com/TEAMMATES/teammates/commit/6faf79dd8fae6d7cf10f0cf0428170f5753180e2", "message": "Renamed cancel event and handler", "committedDate": "2019-06-07T14:27:03Z", "type": "commit"}, {"oid": "b4332d5c83ff0002e9e537d23d02568784647408", "url": "https://github.com/TEAMMATES/teammates/commit/b4332d5c83ff0002e9e537d23d02568784647408", "message": "renamed functions and variables", "committedDate": "2019-06-07T14:32:28Z", "type": "commit"}, {"oid": "ea0dd9be411ebc8250d91cc0b0e0428b1fd6b054", "url": "https://github.com/TEAMMATES/teammates/commit/ea0dd9be411ebc8250d91cc0b0e0428b1fd6b054", "message": "Merge branch 'master' into 9495-Cancel-Button", "committedDate": "2020-05-06T09:03:28Z", "type": "commit"}, {"oid": "fe4c24b4b15687baa8f7bc68cabc077cffe0cb27", "url": "https://github.com/TEAMMATES/teammates/commit/fe4c24b4b15687baa8f7bc68cabc077cffe0cb27", "message": "Merge branch 'master' into 9495-sessionEdit", "committedDate": "2020-07-12T07:32:52Z", "type": "commit"}, {"oid": "4e32a30ad37cebe14d00c233dc95843ab626ae5a", "url": "https://github.com/TEAMMATES/teammates/commit/4e32a30ad37cebe14d00c233dc95843ab626ae5a", "message": "Change feedbackSessionModelBeforeEditing to model", "committedDate": "2020-07-12T07:50:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzM1MTA2NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453351065", "bodyText": "I don't think this will work as the two variable refer to the same object.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.feedbackSessionModelBeforeEditing = this.sessionEditFormModel;\n          \n          \n            \n                    this.feedbackSessionModelBeforeEditing = this.getSessionEditFormModel(feedbackSession);\n          \n      \n    \n    \n  \n\nEdit: Will work as the event emitter always emit a new object :P But let's not depends on the implicit setting.", "author": "xpdavid", "createdAt": "2020-07-12T18:56:55Z", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -209,6 +212,7 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       })\n       .subscribe((feedbackSession: FeedbackSession) => {\n         this.sessionEditFormModel = this.getSessionEditFormModel(feedbackSession);\n+        this.feedbackSessionModelBeforeEditing = this.sessionEditFormModel;", "originalCommit": "4e32a30ad37cebe14d00c233dc95843ab626ae5a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7b9c0f0f45da21ead38ca17f0f4cfff8a116a3fb", "url": "https://github.com/TEAMMATES/teammates/commit/7b9c0f0f45da21ead38ca17f0f4cfff8a116a3fb", "message": "Refactor edit model in subscription\n\nCo-authored-by: Xiao Pu <xp.xiaopu@gmail.com>", "committedDate": "2020-07-13T01:20:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxODY3Mw==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453418673", "bodyText": "We should inform #10293 to include the model in the standardization also.", "author": "xpdavid", "createdAt": "2020-07-13T03:41:55Z", "path": "src/web/app/components/session-edit-form/session-edit-form.component.html", "diffHunk": "@@ -36,6 +36,22 @@ <h5 class=\"text-md-right\">Or: </h5>\n       <div class=\"col-12 text-center text-md-right session-form-buttons\">\n         <button type=\"button\" class=\"btn btn-primary\" (click)=\"triggerModelChange('isEditable', true)\" *ngIf=\"formMode == SessionEditFormMode.EDIT && !model.isEditable\"><i class=\"fas fa-pencil-alt\"></i> Edit</button>\n         <button type=\"button\" class=\"btn btn-primary\" (click)=\"submitFormHandler()\" [disabled]=\"model.isSaving\" *ngIf=\"model.isEditable\"><i class=\"fas fa-check\"></i> Save <tm-ajax-loading *ngIf=\"model.isSaving\"></tm-ajax-loading></button>\n+        <button type=\"button\" class=\"btn btn-primary\" ngbTooltip=\"Discard changes to the feedback session\" (click)=\"cancelHandler(sessionDiscardModal)\" *ngIf=\"model.isEditable\"><i class=\"fas fa-ban\"></i> Cancel </button>\n+        <ng-template #sessionDiscardModal let-modal>", "originalCommit": "7b9c0f0f45da21ead38ca17f0f4cfff8a116a3fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIzNDAwOQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r454234009", "bodyText": "@ccyccyccy fyi", "author": "madanalogy", "createdAt": "2020-07-14T09:42:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxODY3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxOTEyNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453419125", "bodyText": "Same problem here (they refer to the same thing).", "author": "xpdavid", "createdAt": "2020-07-13T03:44:06Z", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -115,6 +115,9 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n     hasEmailSettingsPanelExpanded: false,\n   };\n \n+  // to get the original session model on discard changes\n+  feedbackSessionModelBeforeEditing: SessionEditFormModel = this.sessionEditFormModel;", "originalCommit": "7b9c0f0f45da21ead38ca17f0f4cfff8a116a3fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0MzQ0MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453543440", "bodyText": "This is just the declaration? I figured this was better than copy pasting a duplicate of the skeleton", "author": "madanalogy", "createdAt": "2020-07-13T10:11:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxOTEyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzcyNjc0Mw==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453726743", "bodyText": "Nope. It is the initial value for the component (although they will be overwritten later).", "author": "xpdavid", "createdAt": "2020-07-13T15:17:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxOTEyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxOTI3Ng==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453419276", "bodyText": "And here", "author": "xpdavid", "createdAt": "2020-07-13T03:44:38Z", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -333,6 +337,7 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n    */\n   editExistingSessionHandler(): void {\n     this.sessionEditFormModel.isSaving = true;\n+    this.feedbackSessionModelBeforeEditing = this.sessionEditFormModel;", "originalCommit": "7b9c0f0f45da21ead38ca17f0f4cfff8a116a3fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0NTE0MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453545140", "bodyText": "feedbackSession is not available here, maybe I could use JSON.parse(JSON.stringify(Object)) for deep copy?", "author": "madanalogy", "createdAt": "2020-07-13T10:14:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxOTI3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzcyNzA3NA==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453727074", "bodyText": "Yes. We can should standardize the behavior of deep copy later.", "author": "xpdavid", "createdAt": "2020-07-13T15:18:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxOTI3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxOTM5MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453419390", "bodyText": "And here.", "author": "xpdavid", "createdAt": "2020-07-13T03:45:05Z", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -382,6 +387,13 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n     });\n   }\n \n+  /**\n+   * Handles canceling existing session event without saving changes.\n+   */\n+  cancelEditingSessionHandler(): void {\n+    this.sessionEditFormModel = this.feedbackSessionModelBeforeEditing;", "originalCommit": "7b9c0f0f45da21ead38ca17f0f4cfff8a116a3fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0NTUzNw==", "url": "https://github.com/TEAMMATES/teammates/pull/10301#discussion_r453545537", "bodyText": "Same question regarding how to go about implementing the deep copy", "author": "madanalogy", "createdAt": "2020-07-13T10:15:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxOTM5MA=="}], "type": "inlineReview"}, {"oid": "3edf5d8892144fe7a7178b5bddc4b23142803e9c", "url": "https://github.com/TEAMMATES/teammates/commit/3edf5d8892144fe7a7178b5bddc4b23142803e9c", "message": "Implement deep copy of session model", "committedDate": "2020-07-14T03:08:58Z", "type": "commit"}, {"oid": "20377280b9b23f9818809e3069f2caa8686d9d37", "url": "https://github.com/TEAMMATES/teammates/commit/20377280b9b23f9818809e3069f2caa8686d9d37", "message": "Merge branch 'master' into 9495-sessionEdit", "committedDate": "2020-07-14T09:42:30Z", "type": "commit"}, {"oid": "9f5dcc4016ee11b4ad46c1bd938ac968a12c0499", "url": "https://github.com/TEAMMATES/teammates/commit/9f5dcc4016ee11b4ad46c1bd938ac968a12c0499", "message": "Merge branch 'master' into 9495-sessionEdit", "committedDate": "2020-07-14T14:38:56Z", "type": "commit"}]}