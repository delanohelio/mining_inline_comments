{"pr_number": 10145, "pr_title": "[#10141] Extract common code for section filtering to FeedbackResponsesService", "pr_createdAt": "2020-06-01T05:07:44Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10145", "timeline": [{"oid": "2f41c1a225d1045b038ed3f0a84b0a36cf4b6713", "url": "https://github.com/TEAMMATES/teammates/commit/2f41c1a225d1045b038ed3f0a84b0a36cf4b6713", "message": "extract common section filtering code to feedbackResponsesService", "committedDate": "2020-06-01T05:01:16Z", "type": "commit"}, {"oid": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02", "url": "https://github.com/TEAMMATES/teammates/commit/5008ec3d1e884a20b7d5d4145d7456ce99d33e02", "message": "updated spec files with HttpClientTestingModule", "committedDate": "2020-06-01T05:02:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzExMTQwNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433111405", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      const shouldDisplayBasedOnSection: boolean\n          \n          \n            \n                        = this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(this.section,\n          \n          \n            \n                            this.sectionType, response);\n          \n          \n            \n                      const shouldDisplayBasedOnSection: boolean = this.feedbackResponsesService\n          \n          \n            \n                        .isFeedbackResponsesDisplayedOnSection(this.section, this.sectionType, response);\n          \n      \n    \n    \n  \n\nMight be worthwhile having this as two lines instead of three, feels cleaner in my opinion", "author": "madanalogy", "createdAt": "2020-06-01T08:40:26Z", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -129,32 +130,17 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             return false;\n           }\n \n-          let shouldDisplayBasedOnSection: boolean = true;\n-          if (this.section) {\n-            switch (this.sectionType) {\n-              case InstructorSessionResultSectionType.EITHER:\n-                shouldDisplayBasedOnSection =\n-                    response.giverSection === this.section || response.recipientSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.GIVER:\n-                shouldDisplayBasedOnSection = response.giverSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.EVALUEE:\n-                shouldDisplayBasedOnSection = response.recipientSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.BOTH:\n-                shouldDisplayBasedOnSection =\n-                    response.giverSection === this.section && response.recipientSection === this.section;\n-                break;\n-              default:\n-            }\n-          }\n+          const shouldDisplayBasedOnSection: boolean\n+            = this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(this.section,\n+                this.sectionType, response);", "originalCommit": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzExMTc1NA==", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433111754", "bodyText": "Similarly here", "author": "madanalogy", "createdAt": "2020-06-01T08:41:10Z", "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts", "diffHunk": "@@ -129,32 +130,17 @@ export class GrqRgqViewResponsesComponent extends ResponsesInstructorCommentsBas\n             return false;\n           }\n \n-          let shouldDisplayBasedOnSection: boolean = true;\n-          if (this.section) {\n-            switch (this.sectionType) {\n-              case InstructorSessionResultSectionType.EITHER:\n-                shouldDisplayBasedOnSection =\n-                    response.giverSection === this.section || response.recipientSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.GIVER:\n-                shouldDisplayBasedOnSection = response.giverSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.EVALUEE:\n-                shouldDisplayBasedOnSection = response.recipientSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.BOTH:\n-                shouldDisplayBasedOnSection =\n-                    response.giverSection === this.section && response.recipientSection === this.section;\n-                break;\n-              default:\n-            }\n-          }\n+          const shouldDisplayBasedOnSection: boolean\n+            = this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(this.section,\n+                this.sectionType, response);", "originalCommit": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzExMTg5MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433111891", "bodyText": "Here as well", "author": "madanalogy", "createdAt": "2020-06-01T08:41:29Z", "path": "src/web/app/components/question-responses/per-question-view-responses/per-question-view-responses.component.ts", "diffHunk": "@@ -80,29 +82,15 @@ export class PerQuestionViewResponsesComponent extends ResponsesInstructorCommen\n       if (response.giverEmail) {\n         this.userToEmail[response.giver] = response.giverEmail;\n       }\n-      if (this.section) {\n-        let shouldDisplayBasedOnSection: boolean = true;\n-        switch (this.sectionType) {\n-          case InstructorSessionResultSectionType.EITHER:\n-            shouldDisplayBasedOnSection =\n-                response.giverSection === this.section || response.recipientSection === this.section;\n-            break;\n-          case InstructorSessionResultSectionType.GIVER:\n-            shouldDisplayBasedOnSection = response.giverSection === this.section;\n-            break;\n-          case InstructorSessionResultSectionType.EVALUEE:\n-            shouldDisplayBasedOnSection = response.recipientSection === this.section;\n-            break;\n-          case InstructorSessionResultSectionType.BOTH:\n-            shouldDisplayBasedOnSection =\n-                response.giverSection === this.section && response.recipientSection === this.section;\n-            break;\n-          default:\n-        }\n-        if (!shouldDisplayBasedOnSection) {\n-          continue;\n-        }\n+\n+      const shouldDisplayBasedOnSection: boolean\n+        = this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(this.section,\n+            this.sectionType, response);", "originalCommit": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzExMjg2MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433112861", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    default:\n          \n      \n    \n    \n  \n\nCould do without the empty default imo, clean the code up a little since you're doing the refactoring haha", "author": "madanalogy", "createdAt": "2020-06-01T08:43:39Z", "path": "src/web/services/feedback-responses.service.ts", "diffHunk": "@@ -122,6 +126,35 @@ export class FeedbackResponsesService {\n     }\n   }\n \n+  /**\n+   * Determines whether responses should be displayed based on the selected section.\n+   */\n+  isFeedbackResponsesDisplayedOnSection(section: string, sectionType: InstructorSessionResultSectionType,\n+      response: ResponseOutput): boolean {\n+\n+    let isDisplayed: boolean = true;\n+\n+    if (section) {\n+      switch (sectionType) {\n+        case InstructorSessionResultSectionType.EITHER:\n+          isDisplayed = response.giverSection === section || response.recipientSection === section;\n+          break;\n+        case InstructorSessionResultSectionType.GIVER:\n+          isDisplayed = response.giverSection === section;\n+          break;\n+        case InstructorSessionResultSectionType.EVALUEE:\n+          isDisplayed = response.recipientSection === section;\n+          break;\n+        case InstructorSessionResultSectionType.BOTH:\n+          isDisplayed = response.giverSection === section && response.recipientSection === section;\n+          break;\n+        default:", "originalCommit": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzI3NjI3Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433276277", "bodyText": "There are lint restrictions that prevent from doing so.\nERROR: TEAMMATES/teammates/src/web/services/feedback-responses.service.ts:138:7 - Switch statement should include a 'default' case\nERROR: TEAMMATES/teammates/src/web/services/feedback-responses.service.ts:150:11 - Final clause in 'switch' statement should not end with 'break;'.", "author": "Derek-Hardy", "createdAt": "2020-06-01T14:43:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzExMjg2MQ=="}], "type": "inlineReview"}, {"oid": "55847d91d336df31377de8ee100452ebcef02395", "url": "https://github.com/TEAMMATES/teammates/commit/55847d91d336df31377de8ee100452ebcef02395", "message": "improved line breaks", "committedDate": "2020-06-01T14:43:02Z", "type": "commit"}, {"oid": "7f1609102eb654c67f5164d46016a249612007b4", "url": "https://github.com/TEAMMATES/teammates/commit/7f1609102eb654c67f5164d46016a249612007b4", "message": "Merge branch 'master' into 10141-extract-section-filter", "committedDate": "2020-06-01T14:44:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQxNzE0MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433417141", "bodyText": "A more logic way of organizing parameters would be to put response as the first argument.", "author": "xpdavid", "createdAt": "2020-06-01T18:39:10Z", "path": "src/web/services/feedback-responses.service.ts", "diffHunk": "@@ -122,6 +126,35 @@ export class FeedbackResponsesService {\n     }\n   }\n \n+  /**\n+   * Determines whether responses should be displayed based on the selected section.\n+   */\n+  isFeedbackResponsesDisplayedOnSection(section: string, sectionType: InstructorSessionResultSectionType,", "originalCommit": "7f1609102eb654c67f5164d46016a249612007b4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "432e7797e63fdca6a36cf435d8f14e82c1ea50b5", "url": "https://github.com/TEAMMATES/teammates/commit/432e7797e63fdca6a36cf435d8f14e82c1ea50b5", "message": "rearraged param order in service method", "committedDate": "2020-06-02T01:22:37Z", "type": "commit"}, {"oid": "bcc4f3005b590c8cfbc9723eecabf8f995a8287f", "url": "https://github.com/TEAMMATES/teammates/commit/bcc4f3005b590c8cfbc9723eecabf8f995a8287f", "message": "Merge https://github.com/TEAMMATES/teammates into 10141-extract-section-filter", "committedDate": "2020-06-02T01:24:14Z", "type": "commit"}, {"oid": "61817862a8a4f2f9f9e2e82639e0eb676a4922d0", "url": "https://github.com/TEAMMATES/teammates/commit/61817862a8a4f2f9f9e2e82639e0eb676a4922d0", "message": "Merge branch '10141-extract-section-filter' of https://github.com/Derek-Hardy/teammates into 10141-extract-section-filter", "committedDate": "2020-06-02T01:26:24Z", "type": "commit"}, {"oid": "bcdd934b2dd359b48701a1cdb98946e44146e914", "url": "https://github.com/TEAMMATES/teammates/commit/bcdd934b2dd359b48701a1cdb98946e44146e914", "message": "Merge branch 'master' into 10141-extract-section-filter", "committedDate": "2020-06-02T02:03:39Z", "type": "commit"}]}