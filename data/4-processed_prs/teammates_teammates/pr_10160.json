{"pr_number": 10160, "pr_title": "[#10155] Add sort function to numerical scale summary", "pr_createdAt": "2020-06-03T09:53:05Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10160", "timeline": [{"oid": "2b702f580f0aff24b43fedbcb725e244c0fd6d66", "url": "https://github.com/TEAMMATES/teammates/commit/2b702f580f0aff24b43fedbcb725e244c0fd6d66", "message": "added sort icon template", "committedDate": "2020-06-03T07:18:45Z", "type": "commit"}, {"oid": "836dabadd854b5a9e440c7448a6a7b3638752e74", "url": "https://github.com/TEAMMATES/teammates/commit/836dabadd854b5a9e440c7448a6a7b3638752e74", "message": "added sort function to numerical scale summary", "committedDate": "2020-06-03T09:38:06Z", "type": "commit"}, {"oid": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca", "url": "https://github.com/TEAMMATES/teammates/commit/2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca", "message": "updated method naming, removed unused code", "committedDate": "2020-06-03T09:48:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ2MTkyMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r434461920", "bodyText": "You might want to prefix the properties", "author": "xpdavid", "createdAt": "2020-06-03T10:17:36Z", "path": "src/web/types/sort-properties.ts", "diffHunk": "@@ -121,6 +121,26 @@ export enum SortBy {\n      * Name of the recipient of the feedback response.\n      */\n     RECIPIENT_NAME,\n+\n+    /**\n+     * Average score of the numerical scale question.\n+     */\n+    AVERAGE,", "originalCommit": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ2MjMwOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r434462308", "bodyText": "\ud83d\udc4d", "author": "xpdavid", "createdAt": "2020-06-03T10:18:20Z", "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.ts", "diffHunk": "@@ -1,11 +1,21 @@\n-import { Component, OnChanges, OnInit } from '@angular/core';\n+import { Component, Input, OnChanges, OnInit } from '@angular/core';\n import {\n   FeedbackNumericalScaleQuestionDetails,\n   FeedbackNumericalScaleResponseDetails,\n } from '../../../../types/api-output';\n import { DEFAULT_NUMSCALE_QUESTION_DETAILS } from '../../../../types/default-question-structs';\n+import { SortBy, SortOrder } from '../../../../types/sort-properties';\n import { QuestionStatistics } from './question-statistics';\n \n+interface NumericalScaleStatsRowModel {", "originalCommit": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ2MjYzNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r434462635", "bodyText": "Why you need it to be @Input?", "author": "xpdavid", "createdAt": "2020-06-03T10:18:55Z", "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.ts", "diffHunk": "@@ -18,8 +28,21 @@ export class NumScaleQuestionStatisticsComponent\n     extends QuestionStatistics<FeedbackNumericalScaleQuestionDetails, FeedbackNumericalScaleResponseDetails>\n     implements OnInit, OnChanges {\n \n+  // enum\n+  SortBy: typeof SortBy = SortBy;\n+  SortOrder: typeof SortOrder = SortOrder;\n+\n+  @Input()", "originalCommit": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ2Mjc0MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r434462741", "bodyText": "Consider using TableComparatorService", "author": "xpdavid", "createdAt": "2020-06-03T10:19:07Z", "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.ts", "diffHunk": "@@ -32,6 +55,49 @@ export class NumScaleQuestionStatisticsComponent\n     this.calculateStatistics();\n   }\n \n+  sortNumericalScaleStatsRowModel(by: SortBy): void {\n+    this.teamToRecipientToScoresSortBy = by;\n+    this.teamToRecipientToScoresSortOrder =\n+      (this.teamToRecipientToScoresSortOrder === SortOrder.DESC) ? SortOrder.ASC : SortOrder.DESC;\n+\n+    this.numericalScaleStatsRowModel.sort(this.sortStatsRowBy(by, this.teamToRecipientToScoresSortOrder));\n+  }\n+\n+  sortStatsRowBy(by: SortBy, order: SortOrder):", "originalCommit": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAyNDM4Mw==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r435024383", "bodyText": "Do you think that we can have some sort of component like SortableTable that gets rid of the need for all these boilerplate code?", "author": "ccyccyccy", "createdAt": "2020-06-04T06:40:29Z", "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.html", "diffHunk": "@@ -11,23 +11,53 @@\n       <table class=\"table table-bordered striped margin-0\">\n         <thead>\n         <tr>\n-          <td>Team</td>\n-          <td>Recipient</td>\n-          <td><span ngbTooltip=\"Average of the visible responses\">Average</span></td>\n-          <td><span ngbTooltip=\"Maximum of the visible responses\">Max</span></td>\n-          <td><span ngbTooltip=\"Minimum of the visible responses\">Min</span></td>\n-          <td><span ngbTooltip=\"Average of the visible responses excluding recipient's own response to himself/herself\">Average excluding self response</span></td>\n+          <th class=\"sortable-header\" (click)=\"sortNumericalScaleStatsRowModel(SortBy.TEAM_NAME)\">\n+              Team\n+              <span *ngIf=\"teamToRecipientToScoresSortBy !== SortBy.TEAM_NAME\"><i class=\"fas fa-sort\"></i></span>\n+              <span *ngIf=\"teamToRecipientToScoresSortBy === SortBy.TEAM_NAME && teamToRecipientToScoresSortOrder === SortOrder.DESC\"><i class=\"fas fa-sort-down\"></i></span>\n+              <span *ngIf=\"teamToRecipientToScoresSortBy === SortBy.TEAM_NAME && teamToRecipientToScoresSortOrder === SortOrder.ASC\"><i class=\"fas fa-sort-up\"></i></span>", "originalCommit": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAyNjExNg==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r435026116", "bodyText": "Good idea. It worth to try and it is tricky to design it generically.", "author": "xpdavid", "createdAt": "2020-06-04T06:44:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAyNDM4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTA0MDY3Mw==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r435040673", "bodyText": "Will try to do this for my MCQ table implementation.", "author": "ccyccyccy", "createdAt": "2020-06-04T07:15:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAyNDM4Mw=="}], "type": "inlineReview"}, {"oid": "81c01c6c3d0cbcf9a6c3d1169295788a9395f56a", "url": "https://github.com/TEAMMATES/teammates/commit/81c01c6c3d0cbcf9a6c3d1169295788a9395f56a", "message": "adopt tableComparatorService, add number comparator, add prefix to enum", "committedDate": "2020-06-04T10:23:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUzNzM4OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r435537388", "bodyText": "The @Input here is for?", "author": "xpdavid", "createdAt": "2020-06-04T20:43:36Z", "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.ts", "diffHunk": "@@ -18,9 +29,21 @@ export class NumScaleQuestionStatisticsComponent\n     extends QuestionStatistics<FeedbackNumericalScaleQuestionDetails, FeedbackNumericalScaleResponseDetails>\n     implements OnInit, OnChanges {\n \n+  // enum\n+  SortBy: typeof SortBy = SortBy;\n+  SortOrder: typeof SortOrder = SortOrder;\n+\n+  teamToRecipientToScoresSortBy: SortBy = SortBy.NONE;\n+\n+  @Input()", "originalCommit": "81c01c6c3d0cbcf9a6c3d1169295788a9395f56a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUzODQ4Mg==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r435538482", "bodyText": "My indentation is actually suggest you to use compare in the service. The comparison logic here is essentially the same as compareNaturally.", "author": "xpdavid", "createdAt": "2020-06-04T20:45:50Z", "path": "src/web/services/table-comparator.service.ts", "diffHunk": "@@ -11,6 +11,27 @@ export class TableComparatorService {\n \n   constructor() { }\n \n+  /**\n+   * Compares two numbers naturally depending on order given.\n+   */\n+  compareAsNumber(order: SortOrder, numA: number, numB: number): number {", "originalCommit": "81c01c6c3d0cbcf9a6c3d1169295788a9395f56a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyODU3OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r435628578", "bodyText": "Initially thought comparing number as string might give unintended behaviour. Did not realise it is handled by option in .localeCompare().\nUpdated.", "author": "Derek-Hardy", "createdAt": "2020-06-05T00:31:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUzODQ4Mg=="}], "type": "inlineReview"}, {"oid": "ec7272c155923a58e8f1ede71329259f7025d2a3", "url": "https://github.com/TEAMMATES/teammates/commit/ec7272c155923a58e8f1ede71329259f7025d2a3", "message": "removed unnecessary @input and improved sort logic", "committedDate": "2020-06-05T00:29:03Z", "type": "commit"}, {"oid": "01781dfb368dc1ae9b4c8903b98035f0588dd53e", "url": "https://github.com/TEAMMATES/teammates/commit/01781dfb368dc1ae9b4c8903b98035f0588dd53e", "message": "Merge branch 'master' into 10155-sort-numerical-summary", "committedDate": "2020-06-05T03:51:28Z", "type": "commit"}]}