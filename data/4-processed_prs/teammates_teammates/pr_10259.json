{"pr_number": 10259, "pr_title": "[#10213] Fix instructor session edit UI UX", "pr_createdAt": "2020-06-29T07:52:51Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10259", "timeline": [{"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57", "url": "https://github.com/TEAMMATES/teammates/commit/630f9b6fe853c7885103ffaf61193c550cdc7c57", "message": "Add collapsing for editing question", "committedDate": "2020-06-30T04:00:58Z", "type": "commit"}, {"oid": "52886c84b53bc217503ea9d61616ce1507cc0940", "url": "https://github.com/TEAMMATES/teammates/commit/52886c84b53bc217503ea9d61616ce1507cc0940", "message": "Lint and test fix", "committedDate": "2020-06-30T04:09:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0OTc2OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r447849768", "bodyText": "Use triggerModelChange('isCollapsed', !model.isCollapsed)", "author": "xpdavid", "createdAt": "2020-06-30T17:15:44Z", "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -1,20 +1,24 @@\n <div class=\"card\" xmlns=\"http://www.w3.org/1999/html\">\n-  <div class=\"card-header text-white question-header\">\n+  <div class=\"card-header text-white question-header cursor-pointer\" (click)=\"model.isCollapsed = !model.isCollapsed\">", "originalCommit": "630f9b6fe853c7885103ffaf61193c550cdc7c57", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMxNTE5NA==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448315194", "bodyText": "What's the difference using triggerModelChange? I don't think it matters for saving the model?", "author": "ccyccyccy", "createdAt": "2020-07-01T12:02:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0OTc2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYxNDQ0OQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448614449", "bodyText": "If we don't fire event to change the model explicitly but change it silently like this. This will cause hard-to-find bug like this (more technically, the information flow between child and parent component is broken):\nDo you expect the model to change if you do this?\n<tm-question-edit-form [formMode]=\"QuestionEditFormMode.EDIT\"\n                         [formModel]=\"questionEditFormModels[i]\"></tm-question-edit-form>\nOr this?\n<tm-question-edit-form [formMode]=\"QuestionEditFormMode.EDIT\"\n                         [(formModel)]=\"questionEditFormModels[i]\"></tm-question-edit-form>\nOr this?\n<tm-question-edit-form [formMode]=\"QuestionEditFormMode.EDIT\"\n                         [formModel]=\"questionEditFormModels[i]\" (formModelChange)=\"questionEditFormModels[i] = $event\"></tm-question-edit-form>\nP.S. The behavior of the second and the third one are the same.", "author": "xpdavid", "createdAt": "2020-07-01T21:02:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0OTc2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODcxODczOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448718738", "bodyText": "So the point of emitting the event is to force Angular to detect the change and update the model right?\nMy thought was that since saveExistingQuestionHandler doesn't make use of the isChanged field, it wouldn't break anything, even if the parent and child are de-synced. But I guess it is better to be future-proof.", "author": "ccyccyccy", "createdAt": "2020-07-02T02:49:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0OTc2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg1MTIzNg==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r447851236", "bodyText": "I hope you can understand why you can directly change the model here.", "author": "xpdavid", "createdAt": "2020-06-30T17:18:15Z", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -884,6 +893,18 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       { courseid: this.courseId, fsname: this.feedbackSessionName, previewas: this.emailOfInstructorToPreview });\n   }\n \n+  expandAll(): void {\n+    this.questionEditFormModels.forEach(((model: QuestionEditFormModel): void => {\n+      model.isCollapsed = false;", "originalCommit": "630f9b6fe853c7885103ffaf61193c550cdc7c57", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg1MTczNw==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r447851737", "bodyText": "I think this will cause the style of rich-texst-editor to be changed globally. Can we just pass the property in the place where you need?", "author": "xpdavid", "createdAt": "2020-06-30T17:19:05Z", "path": "src/web/app/components/rich-text-editor/rich-text-editor.component.ts", "diffHunk": "@@ -17,7 +17,7 @@ export class RichTextEditorComponent implements OnInit {\n   isInlineMode: boolean = true;\n \n   @Input()\n-  minHeightInPx: number = 150;\n+  minHeightInPx: number = 80;", "originalCommit": "b594bf6f34092b63fb98a09897f654e3353ae313", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODAxNg==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098016", "bodyText": "I think this should be put at the top.", "author": "xpdavid", "createdAt": "2020-07-01T03:41:57Z", "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "diffHunk": "@@ -306,3 +318,5 @@ export class QuestionEditFormComponent implements OnInit {\n     }, () => {});\n   }\n }\n+\n+const CLEAN_PROPERTIES: Set<string> = new Set<string>(['isEditable', 'isCollapsed', 'isChanged']);", "originalCommit": "44e1daec14248d89882f60ad8510e0dcacb32253", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODE3MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098170", "bodyText": "I think we can just delete the comment.", "author": "xpdavid", "createdAt": "2020-07-01T03:42:45Z", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -447,14 +448,14 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n    * Converts feedback question to the question edit form model.\n    */\n   private getQuestionEditFormModel(feedbackQuestion: FeedbackQuestion): QuestionEditFormModel {\n-    return {\n+    const model: QuestionEditFormModel = {\n       feedbackQuestionId: feedbackQuestion.feedbackQuestionId,\n \n       questionNumber: feedbackQuestion.questionNumber,\n       questionBrief: feedbackQuestion.questionBrief,\n       questionDescription: feedbackQuestion.questionDescription,\n \n-      isQuestionHasResponses: false, // TODO use API to determine\n+      isQuestionHasResponses: false, // Using loadResponseStatusForQuestion to determine", "originalCommit": "44e1daec14248d89882f60ad8510e0dcacb32253", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098588", "bodyText": "If we just want to fix the bug for not popping up the alert model when saving the second time, I think the root cause is the response status is not updated when saving. Therefore, it is not necessary to add isChanged to the model?", "author": "xpdavid", "createdAt": "2020-07-01T03:44:41Z", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -473,7 +474,10 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       isEditable: false,\n       isSaving: false,\n       isCollapsed: false,\n+      isChanged: false,\n     };\n+    this.loadResponseStatusForQuestion(model);", "originalCommit": "44e1daec14248d89882f60ad8510e0dcacb32253", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODc1OQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098759", "bodyText": "In addition, I don't think this is the correct place to call the method.\n\nget*** should not trigger any side-effect.\nloadResponseStatusForQuestion will be called twice I believe when the page is loaded.", "author": "xpdavid", "createdAt": "2020-07-01T03:45:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQyNjExMg==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448426112", "bodyText": "If we just want to fix the bug for not popping up the alert model when saving the second time, I think the root cause is the response status is not updated when saving. Therefore, it is not necessary to add isChanged to the model?\n\nI added the isChanged as an initial value for the model, since it is definitely unchanged upon creating the edit form model. Not related to the bug.\n\nIn addition, I don't think this is the correct place to call the method.\n* `get***` should not trigger any side-effect.\n\n* `loadResponseStatusForQuestion` will be called twice I believe when the page is loaded.\n\n\nYep. I moved it to within saveExistingQuestionHandler.", "author": "ccyccyccy", "createdAt": "2020-07-01T15:01:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYxMjMyMw==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448612323", "bodyText": "I added the isChanged as an initial value for the model, since it is definitely unchanged upon creating the edit form model. Not related to the bug.\n\nSo the isChange field is added for better user experience?", "author": "xpdavid", "createdAt": "2020-07-01T20:57:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODcyMjEzMQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448722131", "bodyText": "Yes", "author": "ccyccyccy", "createdAt": "2020-07-02T03:03:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5OTM0OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448099348", "bodyText": "f?\n\n\nSince we are here. I think we can just create new component for the modal instead of appending it here.", "author": "xpdavid", "createdAt": "2020-07-01T03:48:30Z", "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -277,6 +264,21 @@ <h5>Changing the visibility after collecting responses is not recommended.</h5>\n     </div>\n   </div>\n </div>\n+<ng-template #discardModal let-modal>f", "originalCommit": "c891b5e0e55ec1ff9ef61f7a3fd94e129a3e1d6c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQyMzE2OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448423168", "bodyText": "* Since we are here. I think we can just create new component for the modal instead of appending it here.\n\n\nI think can deter to UI / UX improvements? I think there are plans to standardize the modals.", "author": "ccyccyccy", "createdAt": "2020-07-01T14:57:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5OTM0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYxMjAxOQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448612019", "bodyText": "Ok", "author": "xpdavid", "createdAt": "2020-07-01T20:56:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5OTM0OA=="}], "type": "inlineReview"}, {"oid": "694f072f06848cf462a0664bbeb409e1f0de6ea7", "url": "https://github.com/TEAMMATES/teammates/commit/694f072f06848cf462a0664bbeb409e1f0de6ea7", "message": "Reduce size of optional description box", "committedDate": "2020-07-01T12:11:15Z", "type": "commit"}, {"oid": "52f70dc13e1ebf593e956480a2441f534f33b3c9", "url": "https://github.com/TEAMMATES/teammates/commit/52f70dc13e1ebf593e956480a2441f534f33b3c9", "message": "Add click on hover submenu not dismiss menu", "committedDate": "2020-07-01T12:11:23Z", "type": "commit"}, {"oid": "f4263dc00b5f7fac49073ba692326e15f3361a90", "url": "https://github.com/TEAMMATES/teammates/commit/f4263dc00b5f7fac49073ba692326e15f3361a90", "message": "Add stricter typing for some functions", "committedDate": "2020-07-01T12:11:23Z", "type": "commit"}, {"oid": "45c1bcaccf65f269196d60c8cdb07efcfabbcc00", "url": "https://github.com/TEAMMATES/teammates/commit/45c1bcaccf65f269196d60c8cdb07efcfabbcc00", "message": "Add no modal saving and cancelling if no change detected. Side-effect include hasResponse modal for saving popping up more than once for multiple saves\"", "committedDate": "2020-07-01T14:47:00Z", "type": "commit"}, {"oid": "0b79ef5d5b093fcdf7aa7988b1847bbf24e53677", "url": "https://github.com/TEAMMATES/teammates/commit/0b79ef5d5b093fcdf7aa7988b1847bbf24e53677", "message": "Add red highlight on click for delete option buttons", "committedDate": "2020-07-01T14:47:12Z", "type": "commit"}, {"oid": "cc4c845c39c199f73c5c08e4783de1d3929fa129", "url": "https://github.com/TEAMMATES/teammates/commit/cc4c845c39c199f73c5c08e4783de1d3929fa129", "message": "Add divider below 'Choose from template questions'", "committedDate": "2020-07-01T14:47:12Z", "type": "commit"}, {"oid": "2739673403b517e5abb1cfc7efa7be3be68b6ade", "url": "https://github.com/TEAMMATES/teammates/commit/2739673403b517e5abb1cfc7efa7be3be68b6ade", "message": "Add some space between questions to more distinctly separate them", "committedDate": "2020-07-01T14:47:12Z", "type": "commit"}, {"oid": "259caa42e8a78cf6678c6b06c764ec753312e65e", "url": "https://github.com/TEAMMATES/teammates/commit/259caa42e8a78cf6678c6b06c764ec753312e65e", "message": "Add icon for 'Save Changes' button to make it more similar to the other save button", "committedDate": "2020-07-01T14:47:12Z", "type": "commit"}, {"oid": "74cdd42878187fb95bc9adb33e11a770e52f5713", "url": "https://github.com/TEAMMATES/teammates/commit/74cdd42878187fb95bc9adb33e11a770e52f5713", "message": "Rename cancel to discard", "committedDate": "2020-07-01T14:47:12Z", "type": "commit"}, {"oid": "2ae441c3191e479c311433f0bc64c4a8c9c2c47a", "url": "https://github.com/TEAMMATES/teammates/commit/2ae441c3191e479c311433f0bc64c4a8c9c2c47a", "message": "Add cancel to the bottom of the question beside 'Save Changes'", "committedDate": "2020-07-01T14:51:37Z", "type": "commit"}, {"oid": "ec433d7e230225485b8f0e911fbce2e261663a72", "url": "https://github.com/TEAMMATES/teammates/commit/ec433d7e230225485b8f0e911fbce2e261663a72", "message": "Lint and test fix", "committedDate": "2020-07-01T14:51:42Z", "type": "forcePushed"}, {"oid": "10e30d5134bc433731141daf686928545d0fa41a", "url": "https://github.com/TEAMMATES/teammates/commit/10e30d5134bc433731141daf686928545d0fa41a", "message": "Lint and test fix", "committedDate": "2020-07-01T15:32:01Z", "type": "commit"}, {"oid": "10e30d5134bc433731141daf686928545d0fa41a", "url": "https://github.com/TEAMMATES/teammates/commit/10e30d5134bc433731141daf686928545d0fa41a", "message": "Lint and test fix", "committedDate": "2020-07-01T15:32:01Z", "type": "forcePushed"}, {"oid": "e8b952c00e0ea3564d4772008dd36c3e2880680a", "url": "https://github.com/TEAMMATES/teammates/commit/e8b952c00e0ea3564d4772008dd36c3e2880680a", "message": "Change direct assignment to triggerModelChange for isCollapsed", "committedDate": "2020-07-03T05:53:39Z", "type": "commit"}, {"oid": "bda64fb210219dcab77fa5376501b1e4c6cd67b0", "url": "https://github.com/TEAMMATES/teammates/commit/bda64fb210219dcab77fa5376501b1e4c6cd67b0", "message": "Merge branch 'master' into 10213-instructor-session-edit-ui-ux", "committedDate": "2020-07-04T06:52:35Z", "type": "commit"}]}