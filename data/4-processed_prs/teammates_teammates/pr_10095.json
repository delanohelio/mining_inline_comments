{"pr_number": 10095, "pr_title": "[#9989] Migrate GET /courses/enroll/students to RESTful API", "pr_createdAt": "2020-05-22T03:14:00Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10095", "timeline": [{"oid": "48b9253c03ad08fb4803491974ffb473dd4741b6", "url": "https://github.com/TEAMMATES/teammates/commit/48b9253c03ad08fb4803491974ffb473dd4741b6", "message": "Migrate course enroll students endpoint", "committedDate": "2020-05-22T03:01:36Z", "type": "commit"}, {"oid": "8ee83820c1066d657893a2f9b15ae0762610005a", "url": "https://github.com/TEAMMATES/teammates/commit/8ee83820c1066d657893a2f9b15ae0762610005a", "message": "Merge branch 'master' into 9989-rest", "committedDate": "2020-05-22T03:01:59Z", "type": "commit"}, {"oid": "4d9fa47c60474f9a71e962dfa7daad6bbdff114e", "url": "https://github.com/TEAMMATES/teammates/commit/4d9fa47c60474f9a71e962dfa7daad6bbdff114e", "message": "Remove endpoint references", "committedDate": "2020-05-22T03:12:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTAzMzMyNw==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429033327", "bodyText": "The method should be in the student service right?", "author": "xpdavid", "createdAt": "2020-05-22T04:12:38Z", "path": "src/web/services/course.service.ts", "diffHunk": "@@ -254,6 +254,6 @@ export class CourseService {\n     const paramsMap: Record<string, string> = {", "originalCommit": "4d9fa47c60474f9a71e962dfa7daad6bbdff114e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA0MjAyNA==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429042024", "bodyText": "I just replaced the endpoint, it was already being called from course service, do you want me to move it to student service? It should be fine since the only component using this method already has a dependency on student service", "author": "madanalogy", "createdAt": "2020-05-22T04:56:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTAzMzMyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA0MjM1Mg==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429042352", "bodyText": "We have to do that as it is not the responsibility of course service to get students. Remember SRP?", "author": "xpdavid", "createdAt": "2020-05-22T04:57:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTAzMzMyNw=="}], "type": "inlineReview"}, {"oid": "20a8d930772afc22de93f9031ba6dc3e14cadee4", "url": "https://github.com/TEAMMATES/teammates/commit/20a8d930772afc22de93f9031ba6dc3e14cadee4", "message": "Move method to student.service.ts", "committedDate": "2020-05-22T07:04:05Z", "type": "commit"}, {"oid": "2665b58fff2fe72ac521feedcb6ec0683acc3f41", "url": "https://github.com/TEAMMATES/teammates/commit/2665b58fff2fe72ac521feedcb6ec0683acc3f41", "message": "Remove unused import", "committedDate": "2020-05-22T07:14:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTExNTUwNA==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429115504", "bodyText": "Why not merge with getStudentsFromCourse?", "author": "xpdavid", "createdAt": "2020-05-22T08:32:52Z", "path": "src/web/services/student.service.ts", "diffHunk": "@@ -124,4 +127,14 @@ export class StudentService {\n     const responseType: string = 'text';\n     return this.httpRequestService.get(ResourceEndpoints.STUDENTS_CSV, paramsMap, responseType);\n   }\n+\n+  /**\n+   * Returns a list of students enrolled in a course.\n+   */\n+  getStudentsEnrolledInCourse(queryParams: { courseId: string }): Observable<StudentListResults> {", "originalCommit": "2665b58fff2fe72ac521feedcb6ec0683acc3f41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTExNzkxMg==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429117912", "bodyText": "I tried haha, as I mentioned in my comment the StudentListResults is not of Students type because of the difference in the way they refer to \"Teams\" and \"Sections\". I could try to standardise them but that would require extensive code rewrite in a lot of other components, might be worth doing in a separate issue?", "author": "madanalogy", "createdAt": "2020-05-22T08:37:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTExNTUwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTEyMDk2MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429120960", "bodyText": "Let's do it in this PR. Even if you do not want to do it in this PR. We still need to address this: #10095 (comment)\nHere is the step:\n\nDelete type StudentListResults\nDelete type StudentAttributes and use Student instead\nFix code that turns to red.\n\nI hope you can see why we want to do this (instead of just creating a mapping from the data returned by API endpoint to the StudentListResults)", "author": "xpdavid", "createdAt": "2020-05-22T08:44:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTExNTUwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTE1NjIzNA==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429156234", "bodyText": "I tried this at first but I encountered problems with the handsontable mapping (elaborated on in #10095 (comment)) but I googled a fix and looks like everything is working, manually verified :)", "author": "madanalogy", "createdAt": "2020-05-22T09:59:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTExNTUwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTExNzQxMg==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429117412", "bodyText": "A note, the data type returned by /students from the backend is not of the type StudentListResults.", "author": "xpdavid", "createdAt": "2020-05-22T08:36:48Z", "path": "src/web/services/student.service.ts", "diffHunk": "@@ -124,4 +127,14 @@ export class StudentService {\n     const responseType: string = 'text';\n     return this.httpRequestService.get(ResourceEndpoints.STUDENTS_CSV, paramsMap, responseType);\n   }\n+\n+  /**\n+   * Returns a list of students enrolled in a course.\n+   */\n+  getStudentsEnrolledInCourse(queryParams: { courseId: string }): Observable<StudentListResults> {\n+    const paramsMap: Record<string, string> = {\n+      courseid: queryParams.courseId,\n+    };\n+    return this.httpRequestService.get(ResourceEndpoints.STUDENTS, paramsMap);", "originalCommit": "2665b58fff2fe72ac521feedcb6ec0683acc3f41", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c8bda7cb307d86b9b08936528305584182665741", "url": "https://github.com/TEAMMATES/teammates/commit/c8bda7cb307d86b9b08936528305584182665741", "message": "Remove use of StudentAttributes", "committedDate": "2020-05-22T09:55:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTE2MjAyMw==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429162023", "bodyText": "To keep the code simple, I think you can change the colHeaders instead.", "author": "xpdavid", "createdAt": "2020-05-22T10:12:47Z", "path": "src/web/app/pages-instructor/instructor-course-enroll-page/instructor-course-enroll-page.component.ts", "diffHunk": "@@ -277,16 +260,24 @@ export class InstructorCourseEnrollPageComponent implements OnInit {\n   /**\n    * Converts returned student list to a suitable format required by Handsontable.\n    */\n-  studentListDataToHandsontableData(studentsData: StudentAttributes[], handsontableColHeader: any[]): string[][] {\n+  studentListDataToHandsontableData(studentsData: Student[], handsontableColHeader: any[]): string[][] {\n     const headers: string[] = handsontableColHeader.map(this.unCapitalizeFirstLetter);\n-    return studentsData.map((student: StudentAttributes) => (headers.map(\n-        (header: string) => (student as any)[header])));\n+    return studentsData.map((student: Student) => (headers.map(", "originalCommit": "c8bda7cb307d86b9b08936528305584182665741", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI0MzM2NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10095#discussion_r429243365", "bodyText": "I think that might overly complicate it actually, since it will change the name of the table headers displayed to users, which will need more code to handle. I could give it a shot if you really want though just let me know", "author": "madanalogy", "createdAt": "2020-05-22T13:24:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTE2MjAyMw=="}], "type": "inlineReview"}]}