{"pr_number": 10899, "pr_title": "[#10825] Remove Const.StatusMessages, Const.StudentsLogicConst, Const.StatusCodes", "pr_createdAt": "2020-12-28T17:35:15Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10899", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQyODA1NA==", "url": "https://github.com/TEAMMATES/teammates/pull/10899#discussion_r550428054", "bodyText": "Why not return a boolean here instead of throwing an exception?", "author": "rrtheonlyone", "createdAt": "2020-12-31T08:30:00Z", "path": "src/test/java/teammates/test/AbstractBackDoor.java", "diffHunk": "@@ -260,11 +261,14 @@ public void removeDataBundle(DataBundle dataBundle) {\n     /**\n      * Puts searchable documents in data bundle into the datastore.\n      */\n-    public String putDocuments(DataBundle dataBundle) {\n+    public String putDocuments(DataBundle dataBundle) throws HttpRequestFailedException {", "originalCommit": "ee0d9f1debdab3ab231e38ed85d18742b452a0d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQ3MTEwOQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10899#discussion_r550471109", "bodyText": "To make it the same as removeAndRestoreDataBundle. The latter needs to be String-returning as there is a usage in L&P test case that requires it to be. And I do think there might be future usage of putDocuments that requires the output result, but I could be wrong.\nGoing by the YAGNI principle I could revert this back to boolean-returning, but I do think it's fine either way.", "author": "wkurniawan07", "createdAt": "2020-12-31T12:15:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQyODA1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQ3ODEyMQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10899#discussion_r550478121", "bodyText": "Well fair enough, if it makes the codebase more consistent we can retain this approach. I believe we should however, make the happy path prominent:\n        if (putRequestOutput.responseCode != HttpStatus.SC_OK) {\n            throw new HttpRequestFailedException(\"Request failed: [\" + putRequestOutput.responseCode + \"] \"\n                + putRequestOutput.responseBody);\n        }\n        \n        return putRequestOutput.responseBody;\n\nIt helps to make the code more readable", "author": "rrtheonlyone", "createdAt": "2020-12-31T12:57:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQyODA1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQyODkwNA==", "url": "https://github.com/TEAMMATES/teammates/pull/10899#discussion_r550428904", "bodyText": "Why is there a println here?", "author": "rrtheonlyone", "createdAt": "2020-12-31T08:35:11Z", "path": "src/e2e/java/teammates/e2e/cases/BaseE2ETestCase.java", "diffHunk": "@@ -349,13 +350,25 @@ protected String getKeyForStudent(StudentAttributes student) {\n     }\n \n     @Override\n-    protected String doRemoveAndRestoreDataBundle(DataBundle testData) throws HttpRequestFailedException {\n-        return BACKDOOR.removeAndRestoreDataBundle(testData);\n+    protected boolean doRemoveAndRestoreDataBundle(DataBundle testData) {\n+        try {\n+            BACKDOOR.removeAndRestoreDataBundle(testData);\n+            return true;\n+        } catch (HttpRequestFailedException e) {\n+            System.out.println(TeammatesException.toStringWithStackTrace(e));", "originalCommit": "ee0d9f1debdab3ab231e38ed85d18742b452a0d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQ3MDUyOQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10899#discussion_r550470529", "bodyText": "You'd want to know why it fails.", "author": "wkurniawan07", "createdAt": "2020-12-31T12:12:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQyODkwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQyODkzNg==", "url": "https://github.com/TEAMMATES/teammates/pull/10899#discussion_r550428936", "bodyText": "same here", "author": "rrtheonlyone", "createdAt": "2020-12-31T08:35:18Z", "path": "src/e2e/java/teammates/e2e/cases/BaseE2ETestCase.java", "diffHunk": "@@ -349,13 +350,25 @@ protected String getKeyForStudent(StudentAttributes student) {\n     }\n \n     @Override\n-    protected String doRemoveAndRestoreDataBundle(DataBundle testData) throws HttpRequestFailedException {\n-        return BACKDOOR.removeAndRestoreDataBundle(testData);\n+    protected boolean doRemoveAndRestoreDataBundle(DataBundle testData) {\n+        try {\n+            BACKDOOR.removeAndRestoreDataBundle(testData);\n+            return true;\n+        } catch (HttpRequestFailedException e) {\n+            System.out.println(TeammatesException.toStringWithStackTrace(e));\n+            return false;\n+        }\n     }\n \n     @Override\n-    protected String doPutDocuments(DataBundle testData) {\n-        return BACKDOOR.putDocuments(testData);\n+    protected boolean doPutDocuments(DataBundle testData) {\n+        try {\n+            BACKDOOR.putDocuments(testData);\n+            return true;\n+        } catch (HttpRequestFailedException e) {\n+            System.out.println(TeammatesException.toStringWithStackTrace(e));", "originalCommit": "ee0d9f1debdab3ab231e38ed85d18742b452a0d3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQzMDEzNw==", "url": "https://github.com/TEAMMATES/teammates/pull/10899#discussion_r550430137", "bodyText": "This is not related to this PR but catching all Exception is rarely a good choice. It is much better to catch the specific ones that you know will be thrown and handle them.", "author": "rrtheonlyone", "createdAt": "2020-12-31T08:41:32Z", "path": "src/test/java/teammates/test/BaseComponentTestCase.java", "diffHunk": "@@ -115,23 +114,25 @@ protected void removeAndRestoreTypicalDataBundle() {\n     }\n \n     @Override\n-    protected String doRemoveAndRestoreDataBundle(DataBundle dataBundle) {\n+    protected boolean doRemoveAndRestoreDataBundle(DataBundle dataBundle) {\n         try {\n             logic.removeDataBundle(dataBundle);\n             logic.persistDataBundle(dataBundle);\n-            return Const.StatusCodes.BACKDOOR_STATUS_SUCCESS;\n+            return true;\n         } catch (Exception e) {\n-            return Const.StatusCodes.BACKDOOR_STATUS_FAILURE + \": \" + TeammatesException.toStringWithStackTrace(e);\n+            System.out.println(TeammatesException.toStringWithStackTrace(e));\n+            return false;\n         }\n     }\n \n     @Override\n-    protected String doPutDocuments(DataBundle dataBundle) {\n+    protected boolean doPutDocuments(DataBundle dataBundle) {\n         try {\n             logic.putDocuments(dataBundle);\n-            return Const.StatusCodes.BACKDOOR_STATUS_SUCCESS;\n+            return true;\n         } catch (Exception e) {", "originalCommit": "ee0d9f1debdab3ab231e38ed85d18742b452a0d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQ3MDQ4Mw==", "url": "https://github.com/TEAMMATES/teammates/pull/10899#discussion_r550470483", "bodyText": "Rarely does not mean always. In this case:\n\nThis is a test only method. That on its own doesn't justify to be lazy and catch all Exceptions, but the next reason will/should.\nAny kind of failure during persisting search documents (or test data, because the methodology of catching-all-Exceptions are the same) warrant the same handling: retry or halt (depending on number of attempts), i.e. no special case needs to be handled differently. If each case is caught separately but in the end everything is handled the same, that becomes a case of \"doing it just for the sake of doing it\", which is an anti-pattern.", "author": "wkurniawan07", "createdAt": "2020-12-31T12:11:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQzMDEzNw=="}], "type": "inlineReview"}, {"oid": "1f0a714762d8cdccf0aec59965f45d8cd4341fb1", "url": "https://github.com/TEAMMATES/teammates/commit/1f0a714762d8cdccf0aec59965f45d8cd4341fb1", "message": "Remove Const.StatusCodes", "committedDate": "2021-01-02T23:19:03Z", "type": "forcePushed"}, {"oid": "2c1e99330dd2b605117434e6c30bc3aeee725d66", "url": "https://github.com/TEAMMATES/teammates/commit/2c1e99330dd2b605117434e6c30bc3aeee725d66", "message": "Remove Const.StatusCodes", "committedDate": "2021-01-02T23:52:57Z", "type": "forcePushed"}, {"oid": "6a43908061a4fab8b09345ca116f153b6478dd1a", "url": "https://github.com/TEAMMATES/teammates/commit/6a43908061a4fab8b09345ca116f153b6478dd1a", "message": "Remove Const.StatusCodes", "committedDate": "2021-01-04T01:17:34Z", "type": "forcePushed"}, {"oid": "421ab6686bc2cba3183fea503cf894c8989ae9c9", "url": "https://github.com/TEAMMATES/teammates/commit/421ab6686bc2cba3183fea503cf894c8989ae9c9", "message": "Remove Const.StatusMessages", "committedDate": "2021-01-08T14:34:45Z", "type": "commit"}, {"oid": "93cfbbea655991d80a89f369bc02aeac45ab405e", "url": "https://github.com/TEAMMATES/teammates/commit/93cfbbea655991d80a89f369bc02aeac45ab405e", "message": "Remove Const.StudentsLogicConst", "committedDate": "2021-01-08T14:34:45Z", "type": "commit"}, {"oid": "555c719884cf73cf7caab20a9b70c3d4e160507c", "url": "https://github.com/TEAMMATES/teammates/commit/555c719884cf73cf7caab20a9b70c3d4e160507c", "message": "Remove usage of BACKDOOR_STATUS", "committedDate": "2021-01-08T14:34:45Z", "type": "commit"}, {"oid": "12b4e157902339f5ec5abdb9f86266f3b996507a", "url": "https://github.com/TEAMMATES/teammates/commit/12b4e157902339f5ec5abdb9f86266f3b996507a", "message": "Remove Const.StatusCodes", "committedDate": "2021-01-08T14:34:45Z", "type": "commit"}, {"oid": "12b4e157902339f5ec5abdb9f86266f3b996507a", "url": "https://github.com/TEAMMATES/teammates/commit/12b4e157902339f5ec5abdb9f86266f3b996507a", "message": "Remove Const.StatusCodes", "committedDate": "2021-01-08T14:34:45Z", "type": "forcePushed"}]}