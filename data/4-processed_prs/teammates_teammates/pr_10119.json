{"pr_number": 10119, "pr_title": "[#10107] Append email after participants' name for GRQ/RGQ/GQR/RQG view", "pr_createdAt": "2020-05-26T09:48:40Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10119", "timeline": [{"oid": "7b1bf2dc0239980ca8a0283f508c67a0f918b0a4", "url": "https://github.com/TEAMMATES/teammates/commit/7b1bf2dc0239980ca8a0283f508c67a0f918b0a4", "message": "Add giver and recipient email to response output", "committedDate": "2020-05-26T08:29:56Z", "type": "commit"}, {"oid": "fa17a6cfd2e9b53e3a6f066d4b2fe28dc4b630ff", "url": "https://github.com/TEAMMATES/teammates/commit/fa17a6cfd2e9b53e3a6f066d4b2fe28dc4b630ff", "message": "Add email text to grq-rgq views", "committedDate": "2020-05-26T08:34:59Z", "type": "commit"}, {"oid": "5526e10e2670c38e8269512098bfd447748ae664", "url": "https://github.com/TEAMMATES/teammates/commit/5526e10e2670c38e8269512098bfd447748ae664", "message": "Add email text to gqr-rqg views", "committedDate": "2020-05-26T08:47:12Z", "type": "commit"}, {"oid": "107f58dc0c528ec836cdb80759c5594d130d7e5a", "url": "https://github.com/TEAMMATES/teammates/commit/107f58dc0c528ec836cdb80759c5594d130d7e5a", "message": "Add conditionals to display of email text", "committedDate": "2020-05-26T09:13:38Z", "type": "commit"}, {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0", "url": "https://github.com/TEAMMATES/teammates/commit/1b847c7042e36945fd049d25e2d778cf2dc7cdc0", "message": "Add line breaks for linting", "committedDate": "2020-05-26T09:30:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0NjMwOQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430646309", "bodyText": "Let's follow V6 where we should use mailto here.\nhttps://www.w3schools.com/tags/tag_address.asp", "author": "xpdavid", "createdAt": "2020-05-26T19:13:59Z", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.html", "diffHunk": "@@ -32,8 +32,11 @@\n   <div class=\"card top-padded\">\n     <div class=\"card-header bg-primary text-white\" (click)=\"userExpanded[userInfo] = !userExpanded[userInfo]\">\n       {{ isGqr ? 'From' : 'To' }}: {{ userInfo }}\n+      <span *ngIf=\"userToEmail[userInfo]\">\n+        [{{ userToEmail[userInfo] }}]", "originalCommit": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgxNzE1MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430817150", "bodyText": "Alright will use that!", "author": "t-cheepeng", "createdAt": "2020-05-27T02:04:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0NjMwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0ODgyMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430648820", "bodyText": "Whats this indoxOf for?", "author": "xpdavid", "createdAt": "2020-05-26T19:18:33Z", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -100,6 +106,11 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.recipientTeam].push(response.recipient);\n             this.teamExpanded[response.recipientTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.recipient] = this.userToEmail[response.recipient] || '';\n+          if (this.userToEmail[response.recipient].indexOf(response.recipient) === -1", "originalCommit": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0OTA3Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430649077", "bodyText": "If you want to check something not to be undefined.\nYou can do\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      if (this.userToEmail[response.giver].indexOf(response.giver) === -1 && response.giverEmail !== undefined) {\n          \n          \n            \n                      if (this.userToEmail[response.giver].indexOf(response.giver) === -1 && response.giverEmail) {", "author": "xpdavid", "createdAt": "2020-05-26T19:19:01Z", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -83,6 +85,10 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n             this.teamExpanded[response.giverTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.giver] = this.userToEmail[response.giver] || '';\n+          if (this.userToEmail[response.giver].indexOf(response.giver) === -1 && response.giverEmail !== undefined) {", "originalCommit": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0OTIyNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430649225", "bodyText": "Same here, what the indexOf for?", "author": "xpdavid", "createdAt": "2020-05-26T19:19:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0OTA3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgyMDU2Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430820567", "bodyText": "Initially was to check for undefined keys in the map but I forgot to remove it after adding the initialization. Have removed it now", "author": "t-cheepeng", "createdAt": "2020-05-27T02:19:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0OTA3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY1MDY3MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430650671", "bodyText": "I think giverEmail will never be null in this case, it would be Anonymous Student xxx@Anonymous Student xxx.com for anonymous response in this case. However this is not what we want right? Maybe follow the hint by checking isGiverVisible and isRecipientVisible?", "author": "xpdavid", "createdAt": "2020-05-26T19:22:00Z", "path": "src/main/java/teammates/ui/webapi/output/SessionResultsData.java", "diffHunk": "@@ -163,6 +164,8 @@ private static String removeAnonymousHash(String identifier) {\n \n             for (FeedbackResponseAttributes response : responsesForRecipient) {\n                 String giverName = removeAnonymousHash(bundle.getGiverNameForResponse(response));\n+                String giverEmail = bundle.getDisplayableEmailGiver(response);", "originalCommit": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgxNzMyOQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430817329", "bodyText": "So we send a null from backend if the Giver/Recipient is not visible right?", "author": "t-cheepeng", "createdAt": "2020-05-27T02:05:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY1MDY3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgyMDAyOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430820028", "bodyText": "Of course or why we use @Nullable?", "author": "xpdavid", "createdAt": "2020-05-27T02:17:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY1MDY3MQ=="}], "type": "inlineReview"}, {"oid": "9a31f6b3361794c97b28af941441c76a02eb5c93", "url": "https://github.com/TEAMMATES/teammates/commit/9a31f6b3361794c97b28af941441c76a02eb5c93", "message": "Merge branch 'master' into 10107-append-participant-email", "committedDate": "2020-05-27T02:09:41Z", "type": "commit"}, {"oid": "2a7bc8f4be25c933b6183353a25e9f88f9091180", "url": "https://github.com/TEAMMATES/teammates/commit/2a7bc8f4be25c933b6183353a25e9f88f9091180", "message": "Simplify conditional checks for email map", "committedDate": "2020-05-27T02:20:15Z", "type": "commit"}, {"oid": "cfab6aaf1a9fb510659c53d383de73eb66c52ba5", "url": "https://github.com/TEAMMATES/teammates/commit/cfab6aaf1a9fb510659c53d383de73eb66c52ba5", "message": "Add mailto for email text", "committedDate": "2020-05-27T02:38:25Z", "type": "commit"}, {"oid": "e61f4cd0e56f83597d842510ef12e0cfdf7b6d77", "url": "https://github.com/TEAMMATES/teammates/commit/e61f4cd0e56f83597d842510ef12e0cfdf7b6d77", "message": "Change backend to send null email if not visible", "committedDate": "2020-05-27T03:05:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg0NDIxNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430844215", "bodyText": "This is no necessary if you have *ngIf=\"userToEmail[userInfo]\"?", "author": "xpdavid", "createdAt": "2020-05-27T04:00:15Z", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -83,6 +85,10 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n             this.teamExpanded[response.giverTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.giver] = this.userToEmail[response.giver] || '';", "originalCommit": "e61f4cd0e56f83597d842510ef12e0cfdf7b6d77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg0ODAwNQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430848005", "bodyText": "done", "author": "t-cheepeng", "createdAt": "2020-05-27T04:18:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg0NDIxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg0NDI0Mg==", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430844242", "bodyText": "Same here and other places", "author": "xpdavid", "createdAt": "2020-05-27T04:00:21Z", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -100,6 +106,10 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.recipientTeam].push(response.recipient);\n             this.teamExpanded[response.recipientTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.recipient] = this.userToEmail[response.recipient] || '';", "originalCommit": "e61f4cd0e56f83597d842510ef12e0cfdf7b6d77", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4c2c355afafe8762e2eb7a34712b43c80f3519fa", "url": "https://github.com/TEAMMATES/teammates/commit/4c2c355afafe8762e2eb7a34712b43c80f3519fa", "message": "Remove unnecessary code and check for team name", "committedDate": "2020-05-27T04:17:57Z", "type": "commit"}]}