{"pr_number": 10717, "pr_title": "[#10703] Fix warning when instructor change visibility of question", "pr_createdAt": "2020-09-18T16:59:42Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10717", "timeline": [{"oid": "bf47ec58244f90cf43e61c9e326677915189bcd0", "url": "https://github.com/TEAMMATES/teammates/commit/bf47ec58244f90cf43e61c9e326677915189bcd0", "message": "Add isVisibilityChanged flag and alert user accordingly", "committedDate": "2020-09-18T16:50:46Z", "type": "commit"}, {"oid": "672ecfc4d468b4cdac3f8d4c9b03dbe5b7bd8d25", "url": "https://github.com/TEAMMATES/teammates/commit/672ecfc4d468b4cdac3f8d4c9b03dbe5b7bd8d25", "message": "Empty commit", "committedDate": "2020-09-19T04:10:27Z", "type": "commit"}, {"oid": "d2b18a5f7d68afd1e54a1e07b7358d7a177a8018", "url": "https://github.com/TEAMMATES/teammates/commit/d2b18a5f7d68afd1e54a1e07b7358d7a177a8018", "message": "Empty commit", "committedDate": "2020-09-19T04:33:36Z", "type": "commit"}, {"oid": "dca87d2c6b1da0ffddec2338582c64c66920527b", "url": "https://github.com/TEAMMATES/teammates/commit/dca87d2c6b1da0ffddec2338582c64c66920527b", "message": "Edit message to instructor to be more descriptive", "committedDate": "2020-09-19T08:24:21Z", "type": "commit"}, {"oid": "fe5fbcde4c42374a64967407c95afc95650aa244", "url": "https://github.com/TEAMMATES/teammates/commit/fe5fbcde4c42374a64967407c95afc95650aa244", "message": "Remove trailing white space", "committedDate": "2020-09-19T08:36:37Z", "type": "commit"}, {"oid": "7da7ba52100385a60d9bc176b57ad804174f65fb", "url": "https://github.com/TEAMMATES/teammates/commit/7da7ba52100385a60d9bc176b57ad804174f65fb", "message": "Add correct warning for editing question feedback path", "committedDate": "2020-09-20T15:33:44Z", "type": "commit"}, {"oid": "2bc649a1a044be92ee0673f23843fdb44b8fd4e6", "url": "https://github.com/TEAMMATES/teammates/commit/2bc649a1a044be92ee0673f23843fdb44b8fd4e6", "message": "Empty commit", "committedDate": "2020-09-20T16:46:35Z", "type": "commit"}, {"oid": "1d8bd3c76f3da16ec0b32629ed110e07e5f25488", "url": "https://github.com/TEAMMATES/teammates/commit/1d8bd3c76f3da16ec0b32629ed110e07e5f25488", "message": "Merge branch 'master' into 10703-visibility-warning", "committedDate": "2020-09-21T08:06:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg3MTMzOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r491871338", "bodyText": "Typo", "author": "niqiukun", "createdAt": "2020-09-21T08:32:23Z", "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "diffHunk": "@@ -15,7 +15,26 @@ import { SimpleModalType } from '../simple-modal/simple-modal-type';\n import { collapseAnim } from '../teammates-common/collapse-anim';\n import { QuestionEditFormMode, QuestionEditFormModel } from './question-edit-form-model';\n \n-const CLEAN_PROPERTIES: Set<string> = new Set<string>(['isEditable', 'isCollapsed', 'isChanged']);\n+const FEEDBACK_PATH_PROPERTIES: Set<string> = new Set<string>([\n+  'giverType',\n+  'recipientType',\n+  'isUsingOtherFeedbackPath',\n+  'numberOfEntitiesToGiveFeedbackToSetting',\n+  'customNumberOfEntitiesToGiveFeedbackTo',\n+]);\n+const VISIBILITY_PROPTERIES: Set<string> = new Set<string>([", "originalCommit": "1d8bd3c76f3da16ec0b32629ed110e07e5f25488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg3Mjc2NA==", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r491872764", "bodyText": "I wouldn't put visibilities inside clean properties because clean properties represent UI properties that does not affect the question at the backend. Visibilities do change the question at the backend.", "author": "niqiukun", "createdAt": "2020-09-21T08:34:54Z", "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "diffHunk": "@@ -15,7 +15,26 @@ import { SimpleModalType } from '../simple-modal/simple-modal-type';\n import { collapseAnim } from '../teammates-common/collapse-anim';\n import { QuestionEditFormMode, QuestionEditFormModel } from './question-edit-form-model';\n \n-const CLEAN_PROPERTIES: Set<string> = new Set<string>(['isEditable', 'isCollapsed', 'isChanged']);\n+const FEEDBACK_PATH_PROPERTIES: Set<string> = new Set<string>([\n+  'giverType',\n+  'recipientType',\n+  'isUsingOtherFeedbackPath',\n+  'numberOfEntitiesToGiveFeedbackToSetting',\n+  'customNumberOfEntitiesToGiveFeedbackTo',\n+]);\n+const VISIBILITY_PROPTERIES: Set<string> = new Set<string>([\n+  'isUsingOtherVisibilitySetting',\n+  'showResponsesTo',\n+  'showGiverNameTo',\n+  'showRecipientNameTo',\n+  'commonVisibilitySettingName',\n+]);\n+const CLEAN_PROPERTIES: Set<string> = new Set<string>([\n+  ...VISIBILITY_PROPTERIES,", "originalCommit": "1d8bd3c76f3da16ec0b32629ed110e07e5f25488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5766d6865cdc377e62200465327c1f12610c7367", "url": "https://github.com/TEAMMATES/teammates/commit/5766d6865cdc377e62200465327c1f12610c7367", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into 10703-visibility-warning", "committedDate": "2020-09-25T02:04:17Z", "type": "commit"}, {"oid": "35fd98dcfced4dac6c0778c3eaf707b504c3a1ec", "url": "https://github.com/TEAMMATES/teammates/commit/35fd98dcfced4dac6c0778c3eaf707b504c3a1ec", "message": "Merge branch '10703-visibility-warning' of https://github.com/helloImHai/teammates into 10703-visibility-warning", "committedDate": "2020-09-25T02:17:48Z", "type": "commit"}, {"oid": "ebd1698a9cee2fe821829899ad51f69f9badeed4", "url": "https://github.com/TEAMMATES/teammates/commit/ebd1698a9cee2fe821829899ad51f69f9badeed4", "message": "Merge branch '10703-visibility-warning' of https://github.com/helloImHai/teammates into 10703-visibility-warning", "committedDate": "2020-09-25T02:53:41Z", "type": "commit"}, {"oid": "6246c37769b4a3a60f074f561894bbd329fc2b1a", "url": "https://github.com/TEAMMATES/teammates/commit/6246c37769b4a3a60f074f561894bbd329fc2b1a", "message": "Merge branch '10703-visibility-warning' of https://github.com/helloImHai/teammates into 10703-visibility-warning", "committedDate": "2020-09-25T02:54:09Z", "type": "commit"}, {"oid": "113e83b209a89325d0408606a607db097867a9b7", "url": "https://github.com/TEAMMATES/teammates/commit/113e83b209a89325d0408606a607db097867a9b7", "message": "Make changes for lint", "committedDate": "2020-09-25T03:00:30Z", "type": "commit"}, {"oid": "9ec0c72c326a6851e15d34f879aee0b78e7d7c17", "url": "https://github.com/TEAMMATES/teammates/commit/9ec0c72c326a6851e15d34f879aee0b78e7d7c17", "message": "Empty commit", "committedDate": "2020-09-25T03:39:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc0MDA2Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r494740067", "bodyText": "Can we remove isChanged then?", "author": "xpdavid", "createdAt": "2020-09-25T04:26:42Z", "path": "src/web/app/components/question-edit-form/question-edit-form-model.ts", "diffHunk": "@@ -54,4 +54,7 @@ export interface QuestionEditFormModel {\n   isSaving: boolean;\n   isCollapsed: boolean;\n   isChanged: boolean;", "originalCommit": "9ec0c72c326a6851e15d34f879aee0b78e7d7c17", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1ccfc80e3b907413bcc7b8b4710affdeba271333", "url": "https://github.com/TEAMMATES/teammates/commit/1ccfc80e3b907413bcc7b8b4710affdeba271333", "message": "Remove isChanged flag", "committedDate": "2020-09-25T05:20:15Z", "type": "commit"}, {"oid": "2cb77403b1b91287f6536a2cdebc5b2620a8ec43", "url": "https://github.com/TEAMMATES/teammates/commit/2cb77403b1b91287f6536a2cdebc5b2620a8ec43", "message": "Empty commit", "committedDate": "2020-09-25T06:06:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc2NjEyNw==", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r494766127", "bodyText": "We can use a more strict type here (and similarly below)\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            const FEEDBACK_PATH_PROPERTIES: Set<string> = new Set<string>([\n          \n          \n            \n            const FEEDBACK_PATH_PROPERTIES: Set<keyof QuestionEditFormModel> = new Set<string>([", "author": "xpdavid", "createdAt": "2020-09-25T06:06:08Z", "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "diffHunk": "@@ -15,7 +15,26 @@ import { SimpleModalType } from '../simple-modal/simple-modal-type';\n import { collapseAnim } from '../teammates-common/collapse-anim';\n import { QuestionEditFormMode, QuestionEditFormModel } from './question-edit-form-model';\n \n-const CLEAN_PROPERTIES: Set<string> = new Set<string>(['isEditable', 'isCollapsed', 'isChanged']);\n+const FEEDBACK_PATH_PROPERTIES: Set<string> = new Set<string>([", "originalCommit": "1ccfc80e3b907413bcc7b8b4710affdeba271333", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQyODM3NA==", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r495428374", "bodyText": "I think this change would not be compatible with the way we use the keys below,\nObject.keys(obj).some((key: string) => VISIBILITY_PROPERTIES.has(key))\nWhere key is expected to be of type string, and not keyof QuestionEditFormModel? Maybe it's possible but I can't seem to get it to work.\nWe can do this to ensure the keys added in do not have typos tho, do you want me to proceed with this change?\nconst FEEDBACK_PATH_PROPERTIES: Set<string> = new Set<keyof QuestionEditFormModel>([...", "author": "helloImHai", "createdAt": "2020-09-26T07:42:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc2NjEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUyNDk0OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r495524948", "bodyText": "It's fine if it is difficult to do so", "author": "xpdavid", "createdAt": "2020-09-27T04:01:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc2NjEyNw=="}], "type": "inlineReview"}, {"oid": "29e50669d31d1edce9ed609f77440971c0c6644d", "url": "https://github.com/TEAMMATES/teammates/commit/29e50669d31d1edce9ed609f77440971c0c6644d", "message": "Merge branch 'master' into 10703-visibility-warning", "committedDate": "2020-10-02T08:27:21Z", "type": "commit"}]}