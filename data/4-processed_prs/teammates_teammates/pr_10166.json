{"pr_number": 10166, "pr_title": "[#10155] Add sortable table, with MCQ statistics calling it", "pr_createdAt": "2020-06-05T04:32:14Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10166", "timeline": [{"oid": "30ea6ee7de23fd7afe7d69fc5b735de3c585426d", "url": "https://github.com/TEAMMATES/teammates/commit/30ea6ee7de23fd7afe7d69fc5b735de3c585426d", "message": "Add sortable table, with MCQ statistics calling it", "committedDate": "2020-06-05T04:40:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY4NTgyMw==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435685823", "bodyText": "Should this be in the TableComparatorService?", "author": "ccyccyccy", "createdAt": "2020-06-05T04:39:05Z", "path": "src/web/app/components/question-types/question-statistics/mcq-question-statistics.component.ts", "diffHunk": "@@ -124,4 +132,31 @@ export class McqQuestionStatisticsComponent\n     }\n   }\n \n+  private sortChoices = (item1: string, item2: string): number => {\n+    return this.tableComparatorService.compareLexicographically(item1, item2, SortOrder.ASC);\n+  }\n+\n+  private sortNumbers(item1: number, item2: number): number {\n+    return item1 - item2;\n+  }", "originalCommit": "ea2285f2b1d92b39d1122d184c32a7af2cecaa13", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY5NzA1MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435697050", "bodyText": "You can take a look at my PR #10155 for the use of TableComparatorService . Basically all comparison should be delegated to this.tableComparatorService.compare().", "author": "Derek-Hardy", "createdAt": "2020-06-05T05:26:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY4NTgyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY4NzU5MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435687590", "bodyText": "Not sure if we can use typescript to enforce that the types of items in the columns and rows arrays are properly aligned. Searched around for quite a bit and couldn't find any solutions.", "author": "ccyccyccy", "createdAt": "2020-06-05T04:47:09Z", "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -0,0 +1,78 @@\n+import { Component, Input, OnInit } from '@angular/core';\n+import { SortOrder } from '../../../types/sort-properties';\n+\n+/**\n+ * Column data for sortable table\n+ */\n+export interface ColumnData<T> {\n+  header: string;\n+  headerToolTip?: string;\n+  sortBy?(item1: T, item2: T): number; // Don't provide this field if you don't want this column to be sortable\n+}\n+\n+/**\n+ * Displays a sortable table, sorting by clicking on the header\n+ * Optional sorting function to be inputted provided for each column\n+ * Columns and rows provided must be aligned\n+ */\n+@Component({\n+  selector: 'tm-sortable-table',\n+  templateUrl: './sortable-table.component.html',\n+  styleUrls: ['./sortable-table.component.scss'],\n+})\n+export class SortableTableComponent implements OnInit {\n+\n+  @Input()\n+  columns: ColumnData<any>[] = [];\n+\n+  @Input()\n+  rows: any[][] = [];", "originalCommit": "30ea6ee7de23fd7afe7d69fc5b735de3c585426d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY5NzYzNg==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435697636", "bodyText": "You should use this.tableComparatorService.compare(), declare the respective enum in src/web/types/sort-properties.ts for switch case in the function.", "author": "Derek-Hardy", "createdAt": "2020-06-05T05:29:31Z", "path": "src/web/app/components/question-types/question-statistics/mcq-question-statistics.component.ts", "diffHunk": "@@ -124,4 +132,31 @@ export class McqQuestionStatisticsComponent\n     }\n   }\n \n+  private sortChoices = (item1: string, item2: string): number => {\n+    return this.tableComparatorService.compareLexicographically(item1, item2, SortOrder.ASC);", "originalCommit": "a8d06e91ee94d3459521e87c23d9a1931d5a28a1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcwOTA5MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435709091", "bodyText": "I think it would be better to name as headerData? Else it might be misinterpreted as data for the whole column.", "author": "Derek-Hardy", "createdAt": "2020-06-05T06:11:29Z", "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -0,0 +1,78 @@\n+import { Component, Input, OnInit } from '@angular/core';\n+import { SortOrder } from '../../../types/sort-properties';\n+\n+/**\n+ * Column data for sortable table\n+ */\n+export interface ColumnData<T> {\n+  header: string;\n+  headerToolTip?: string;\n+  sortBy?(item1: T, item2: T): number; // Don't provide this field if you don't want this column to be sortable", "originalCommit": "a8d06e91ee94d3459521e87c23d9a1931d5a28a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcxMDE0OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435710148", "bodyText": "But the sorting option is for the whole column though.\nOr it can be something like columnMetadata?", "author": "ccyccyccy", "createdAt": "2020-06-05T06:15:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcwOTA5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcxMjI3Mw==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435712273", "bodyText": "I felt sortBy here should be the enum type SortBy?\nIt should then be passed into tableComparatorService.comapre(), which will handle the comparison logic.", "author": "Derek-Hardy", "createdAt": "2020-06-05T06:21:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcwOTA5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcxNjA0Mg==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435716042", "bodyText": "Was in the process of changing it. Seems like we had the same idea :)", "author": "ccyccyccy", "createdAt": "2020-06-05T06:32:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcwOTA5MQ=="}], "type": "inlineReview"}, {"oid": "21e1e2df03d4fbd0e24edc37786d5f5f957bbe7a", "url": "https://github.com/TEAMMATES/teammates/commit/21e1e2df03d4fbd0e24edc37786d5f5f957bbe7a", "message": "Add sortable table, with MCQ statistics calling it", "committedDate": "2020-06-05T06:35:38Z", "type": "commit"}, {"oid": "e34e8297a4d75552ac6694a8e29e8f31094ad67a", "url": "https://github.com/TEAMMATES/teammates/commit/e34e8297a4d75552ac6694a8e29e8f31094ad67a", "message": "Fix CSS", "committedDate": "2020-06-05T06:35:38Z", "type": "commit"}, {"oid": "ae1d51d3ac7595560f6ba47e7e946046d78c240f", "url": "https://github.com/TEAMMATES/teammates/commit/ae1d51d3ac7595560f6ba47e7e946046d78c240f", "message": "Refactor to use more of table comparator service", "committedDate": "2020-06-05T06:38:24Z", "type": "commit"}, {"oid": "ae1d51d3ac7595560f6ba47e7e946046d78c240f", "url": "https://github.com/TEAMMATES/teammates/commit/ae1d51d3ac7595560f6ba47e7e946046d78c240f", "message": "Refactor to use more of table comparator service", "committedDate": "2020-06-05T06:38:24Z", "type": "forcePushed"}, {"oid": "4ca4a521cc9604415cc2dcf5123ebed67b9d8470", "url": "https://github.com/TEAMMATES/teammates/commit/4ca4a521cc9604415cc2dcf5123ebed67b9d8470", "message": "Fix doc", "committedDate": "2020-06-05T06:47:22Z", "type": "commit"}, {"oid": "a2a8441deaca0843a232f8930356d124edc63d77", "url": "https://github.com/TEAMMATES/teammates/commit/a2a8441deaca0843a232f8930356d124edc63d77", "message": "Clone original row instead of assigning", "committedDate": "2020-06-05T06:57:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc3NTcwMg==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435775702", "bodyText": "We should follow the enum convention to have all letters capitalised.", "author": "Derek-Hardy", "createdAt": "2020-06-05T08:41:10Z", "path": "src/web/types/sort-properties.ts", "diffHunk": "@@ -141,6 +141,31 @@ export enum SortBy {\n      * Average score (exclude self-review) of the numerical scale question.\n      */\n     NUMERICAL_SCALE_AVERAGE_EXCLUDE_SELF,\n+\n+    /**\n+     * Option text\n+     */\n+    MCQ_Choice,\n+\n+    /**\n+     * Weight assigned to the option\n+     */\n+    MCQ_Weight,\n+\n+    /**\n+     * Number of selection of that option\n+     */\n+    MCQ_Response_Count,\n+\n+    /**\n+     * Percentage of selection of that option\n+     */\n+    MCQ_Percentage,\n+\n+    /**\n+     * Weighted percentage of selection of that option\n+     */\n+    MCQ_Weighted_Percentage,", "originalCommit": "a2a8441deaca0843a232f8930356d124edc63d77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4MTkzMg==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435781932", "bodyText": "Oops will change.", "author": "ccyccyccy", "createdAt": "2020-06-05T08:52:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc3NTcwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc3NzIyMw==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435777223", "bodyText": "To be consistent with other files, we put enum declaration at the top of class.", "author": "Derek-Hardy", "createdAt": "2020-06-05T08:44:05Z", "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -0,0 +1,79 @@\n+import { Component, Input, OnInit } from '@angular/core';\n+import { TableComparatorService } from '../../../services/table-comparator.service';\n+import { SortBy, SortOrder } from '../../../types/sort-properties';\n+\n+/**\n+ * Column data for sortable table\n+ */\n+export interface ColumnData {\n+  header: string;\n+  headerToolTip?: string;\n+  sortBy?: SortBy; // Don't provide this field if you don't want this column to be sortable\n+}\n+\n+/**\n+ * Displays a sortable table, sorting by clicking on the header\n+ * Optional sortBy option provided for each column\n+ * Columns and rows provided must be aligned\n+ */\n+@Component({\n+  selector: 'tm-sortable-table',\n+  templateUrl: './sortable-table.component.html',\n+  styleUrls: ['./sortable-table.component.scss'],\n+})\n+export class SortableTableComponent implements OnInit {\n+\n+  @Input()\n+  columns: ColumnData[] = [];\n+\n+  @Input()\n+  rows: any[][] = [];\n+\n+  columnToSortBy: string = '';\n+  sortOrder: SortOrder = SortOrder.ASC;\n+  tableRows: any[][] = [];\n+\n+  // enum\n+  SortOrder: typeof SortOrder = SortOrder;", "originalCommit": "a2a8441deaca0843a232f8930356d124edc63d77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4MjQxOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435782418", "bodyText": "Actually there's some inconsistencies between files for this. But majority put it at the top, so I'll make this change as well.", "author": "ccyccyccy", "createdAt": "2020-06-05T08:53:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc3NzIyMw=="}], "type": "inlineReview"}, {"oid": "a885c9b6e62f94b380c0cf52b38ec4c11a45d037", "url": "https://github.com/TEAMMATES/teammates/commit/a885c9b6e62f94b380c0cf52b38ec4c11a45d037", "message": "Fix enum casing, change enum placement", "committedDate": "2020-06-05T08:54:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjEwNDM2MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r436104360", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              sortBy?: SortBy; // Don't provide this field if you don't want this column to be sortable\n          \n          \n            \n              sortBy?: SortBy; // optional if the column is not sortable\n          \n      \n    \n    \n  \n\nI would say comment like this is better :P", "author": "xpdavid", "createdAt": "2020-06-05T18:49:29Z", "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -0,0 +1,79 @@\n+import { Component, Input, OnInit } from '@angular/core';\n+import { TableComparatorService } from '../../../services/table-comparator.service';\n+import { SortBy, SortOrder } from '../../../types/sort-properties';\n+\n+/**\n+ * Column data for sortable table\n+ */\n+export interface ColumnData {\n+  header: string;\n+  headerToolTip?: string;\n+  sortBy?: SortBy; // Don't provide this field if you don't want this column to be sortable", "originalCommit": "a885c9b6e62f94b380c0cf52b38ec4c11a45d037", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIzMDg5MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r436230891", "bodyText": "Yep much more concise", "author": "ccyccyccy", "createdAt": "2020-06-06T02:50:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjEwNDM2MA=="}], "type": "inlineReview"}, {"oid": "79d7fef05270e7e858f8147201e80ee9abe25b26", "url": "https://github.com/TEAMMATES/teammates/commit/79d7fef05270e7e858f8147201e80ee9abe25b26", "message": "Make sortBy comment more concise\n\nCo-authored-by: Xiao Pu <xp.xiaopu@gmail.com>", "committedDate": "2020-06-06T02:50:37Z", "type": "commit"}, {"oid": "7f4626ed04e2852724180e496d0f3bc9e98487f4", "url": "https://github.com/TEAMMATES/teammates/commit/7f4626ed04e2852724180e496d0f3bc9e98487f4", "message": "Merge branch 'master' into 10155-sort-mcq-summary", "committedDate": "2020-06-06T03:42:40Z", "type": "commit"}]}