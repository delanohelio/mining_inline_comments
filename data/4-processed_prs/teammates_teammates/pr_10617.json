{"pr_number": 10617, "pr_title": "[#10614][#10616] Fix session results page issues", "pr_createdAt": "2020-08-16T08:31:43Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10617", "timeline": [{"oid": "8717bb8523a5bc2490430d16867c92f5241102d4", "url": "https://github.com/TEAMMATES/teammates/commit/8717bb8523a5bc2490430d16867c92f5241102d4", "message": "Fix session results page issues", "committedDate": "2020-08-16T08:29:19Z", "type": "commit"}, {"oid": "2d578510243c177beca774f5b144db6cfe791593", "url": "https://github.com/TEAMMATES/teammates/commit/2d578510243c177beca774f5b144db6cfe791593", "message": "Fix lint", "committedDate": "2020-08-16T08:51:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM5NTM5MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10617#discussion_r471395391", "bodyText": "I might be wrong, but I don't think you need this. Both (unpublish|publish)FeedbackSession endpoint should return the session object itself, which you can use straightaway to construct the new visible from time.", "author": "wkurniawan07", "createdAt": "2020-08-17T10:44:39Z", "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "diffHunk": "@@ -383,7 +402,13 @@ export class InstructorSessionResultPageComponent extends InstructorCommentsComp\n       ;\n \n       response.subscribe(() => {\n-        this.router.navigateByUrl('/web/instructor/sessions');\n+        this.loadFeedbackSessionVisibleFromTime(this.courseId, this.fsName);", "originalCommit": "2d578510243c177beca774f5b144db6cfe791593", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ1NTUzMQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10617#discussion_r471455531", "bodyText": "Yes you are right. Thanks for pointing out. I should have checked the response type from the endpoint. I think part of the reason for me to overlook this is because the type of the variable response is Observable<any> where it actually can be Observable<FeedbackSession>.", "author": "niqiukun", "createdAt": "2020-08-17T12:50:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM5NTM5MQ=="}], "type": "inlineReview"}, {"oid": "dba0c88e93d025f1b0a1fa65b091ce05d6c4eb47", "url": "https://github.com/TEAMMATES/teammates/commit/dba0c88e93d025f1b0a1fa65b091ce05d6c4eb47", "message": "Use response from endpoint", "committedDate": "2020-08-17T12:50:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ3NDE2Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10617#discussion_r471474167", "bodyText": "If this variable is not read by the HTML file, you can move it to outside the export class definition. That way you don't need this.TIME_FORMAT.", "author": "wkurniawan07", "createdAt": "2020-08-17T13:22:00Z", "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "diffHunk": "@@ -109,6 +109,8 @@ export class InstructorSessionResultPageComponent extends InstructorCommentsComp\n   FeedbackSessionPublishStatus: typeof FeedbackSessionPublishStatus = FeedbackSessionPublishStatus;\n   isExpandAll: boolean = false;\n \n+  readonly TIME_FORMAT: string = 'ddd, DD MMM, YYYY, hh:mm A zz';", "originalCommit": "dba0c88e93d025f1b0a1fa65b091ce05d6c4eb47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ3NDU3Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10617#discussion_r471474577", "bodyText": "Are the conditionals isPublished and this.session.resultVisibleFromTimestamp equivalent?", "author": "wkurniawan07", "createdAt": "2020-08-17T13:22:42Z", "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "diffHunk": "@@ -382,8 +384,20 @@ export class InstructorSessionResultPageComponent extends InstructorCommentsComp\n           )\n       ;\n \n-      response.subscribe(() => {\n-        this.router.navigateByUrl('/web/instructor/sessions');\n+      response.subscribe((res: FeedbackSession) => {\n+        this.session = res;\n+        if (this.session.resultVisibleFromTimestamp) {\n+          this.formattedResultVisibleFromTime = this.timezoneService\n+            .formatToString(this.session.resultVisibleFromTimestamp, this.session.timeZone, this.TIME_FORMAT);\n+        } else {\n+          this.formattedResultVisibleFromTime = 'Not applicable';\n+        }\n+        if (isPublished) {", "originalCommit": "dba0c88e93d025f1b0a1fa65b091ce05d6c4eb47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "08ebd08cfe378583547a27927a9ffe79944dea3d", "url": "https://github.com/TEAMMATES/teammates/commit/08ebd08cfe378583547a27927a9ffe79944dea3d", "message": "Move TIME_FORMAT outside class and remove if", "committedDate": "2020-08-17T13:35:29Z", "type": "commit"}, {"oid": "aa23607aef4034dd47d565a5f280997c19a24a95", "url": "https://github.com/TEAMMATES/teammates/commit/aa23607aef4034dd47d565a5f280997c19a24a95", "message": "Merge branch 'master' into result-page-fix", "committedDate": "2020-08-17T15:38:50Z", "type": "commit"}]}