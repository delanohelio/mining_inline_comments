{"pr_number": 10288, "pr_title": "[#10213] Add default sorting of tables and pages", "pr_createdAt": "2020-07-08T07:06:26Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10288", "timeline": [{"oid": "3dc33ebac466b5d503694977f17156c83b2a583c", "url": "https://github.com/TEAMMATES/teammates/commit/3dc33ebac466b5d503694977f17156c83b2a583c", "message": "Add sort by to student home page", "committedDate": "2020-07-07T10:38:32Z", "type": "commit"}, {"oid": "4ef92c4cfdd8e7205f79cdfc1b95725ed8ecb222", "url": "https://github.com/TEAMMATES/teammates/commit/4ef92c4cfdd8e7205f79cdfc1b95725ed8ecb222", "message": "Add default sort to instructor course page", "committedDate": "2020-07-07T10:39:11Z", "type": "commit"}, {"oid": "9235d94d864727e892db08c1727385746bcdbe12", "url": "https://github.com/TEAMMATES/teammates/commit/9235d94d864727e892db08c1727385746bcdbe12", "message": "Add comment sort by last edited date", "committedDate": "2020-07-07T10:40:24Z", "type": "commit"}, {"oid": "f21af8e1d783f1a104e1cc0480da29971ce216a6", "url": "https://github.com/TEAMMATES/teammates/commit/f21af8e1d783f1a104e1cc0480da29971ce216a6", "message": "Add initial sorting to sortable table", "committedDate": "2020-07-08T06:49:22Z", "type": "commit"}, {"oid": "3434ba3de4c924feb758d2197b5ab8aa3eb76293", "url": "https://github.com/TEAMMATES/teammates/commit/3434ba3de4c924feb758d2197b5ab8aa3eb76293", "message": "Add sorting to instructor home, session, student", "committedDate": "2020-07-08T06:51:40Z", "type": "commit"}, {"oid": "f9fbdb81344a5bb270d70b28a8d4712957e57edb", "url": "https://github.com/TEAMMATES/teammates/commit/f9fbdb81344a5bb270d70b28a8d4712957e57edb", "message": "Update snapshots and fix lint issues", "committedDate": "2020-07-08T06:52:04Z", "type": "commit"}, {"oid": "5bd839bf3d2c7012ca3e639eedb36f5016930f69", "url": "https://github.com/TEAMMATES/teammates/commit/5bd839bf3d2c7012ca3e639eedb36f5016930f69", "message": "Fix instructor home page", "committedDate": "2020-07-08T07:49:46Z", "type": "commit"}, {"oid": "382538275e8218b844eda972c55cdbcd134ec9c1", "url": "https://github.com/TEAMMATES/teammates/commit/382538275e8218b844eda972c55cdbcd134ec9c1", "message": "Merge branch 'master' into 10213-table-consistent-load", "committedDate": "2020-07-09T03:17:58Z", "type": "commit"}, {"oid": "6c507ef547eae330dee2e26c4adaada93b1740fa", "url": "https://github.com/TEAMMATES/teammates/commit/6c507ef547eae330dee2e26c4adaada93b1740fa", "message": "Fix instructor course page E2E test", "committedDate": "2020-07-09T04:54:48Z", "type": "commit"}, {"oid": "6002cb853b9fe787f2f3b5a204e9b75a7665ee59", "url": "https://github.com/TEAMMATES/teammates/commit/6002cb853b9fe787f2f3b5a204e9b75a7665ee59", "message": "Merge branch 'master' into 10213-table-consistent-load", "committedDate": "2020-07-09T06:32:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3MzEzMw==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452373133", "bodyText": "The sorting should be done at the root page? (single point of truth?)", "author": "xpdavid", "createdAt": "2020-07-09T17:20:27Z", "path": "src/web/app/components/comment-box/comment-table/comment-table.component.ts", "diffHunk": "@@ -70,9 +72,28 @@ export class CommentTableComponent implements OnInit {\n   @Output()\n   updateCommentEvent: EventEmitter<number> = new EventEmitter();\n \n-  constructor() { }\n+  constructor(private tableComparatorService: TableComparatorService) { }\n \n   ngOnInit(): void {\n+    this.sortComments();\n+  }\n+\n+  ngOnChanges(): void {\n+    this.sortComments();\n+  }\n+\n+  /**\n+   * Sorts the comments by last edited date.\n+   */\n+  sortComments(): void {", "originalCommit": "6002cb853b9fe787f2f3b5a204e9b75a7665ee59", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU5OTM4Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452599387", "bodyText": "There's quite a bit of pages that uses the comment table component other than session result ones and those pages don't have comments pre-processed. So i was thinking if there was an alternative way to do the sorting? Or would the only option be to preprocess comments at these pages too?", "author": "t-cheepeng", "createdAt": "2020-07-10T03:12:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3MzEzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYwMTc4Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452601787", "bodyText": "The main concert here is we break the single point of truth. The parent component losses control on the model.\n\nThere's quite a bit of pages\n\nThere are only two if I am not wrong? We don't need the help page example box to be sorted.", "author": "xpdavid", "createdAt": "2020-07-10T03:23:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3MzEzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYwMjY1MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452602651", "bodyText": "Got it. then will stick with preprocessing the comments since help page doesn't need to be sorted", "author": "t-cheepeng", "createdAt": "2020-07-10T03:27:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3MzEzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3NTI4Mw==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452375283", "bodyText": "You can make this to return void Observable to indicate the completion and subscribe it.\nIf you think it is overkill, I would suggest just keep parameter index as (index and model refer to the same thing)", "author": "xpdavid", "createdAt": "2020-07-09T17:24:16Z", "path": "src/web/app/pages-instructor/instructor-home-page/instructor-home-page.component.ts", "diffHunk": "@@ -198,9 +198,9 @@ export class InstructorHomePageComponent extends InstructorSessionModalPageCompo\n   }\n \n   /**\n-   * Loads the feedback session in the course.\n+   * Loads the feedback session in the course and sorts them according to end date.\n    */\n-  loadFeedbackSessions(model: CourseTabModel): void {\n+  loadFeedbackSessions(model: CourseTabModel, index: number): void {", "originalCommit": "6002cb853b9fe787f2f3b5a204e9b75a7665ee59", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3NjkzNg==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452376936", "bodyText": "Is it possible to do this more explicitly?", "author": "xpdavid", "createdAt": "2020-07-09T17:27:16Z", "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -94,4 +98,19 @@ export class SortableTableComponent implements OnInit {\n     });\n   }\n \n+  /**\n+   * Sorts the table with initial column index or leftmost sortable column", "originalCommit": "6002cb853b9fe787f2f3b5a204e9b75a7665ee59", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU5OTg1Mw==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452599853", "bodyText": "What do you mean by doing it more explicitly? Like the parent component has to call the method?", "author": "t-cheepeng", "createdAt": "2020-07-10T03:14:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3NjkzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYwMDQ1NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452600455", "bodyText": "Use SortBy.* instead of initial column index or leftmost sortable column.", "author": "xpdavid", "createdAt": "2020-07-10T03:17:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3NjkzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYxNTIxNw==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452615217", "bodyText": "See if you can reuse/remove the sorting logic in the CSV generation code (as the sortable table is related to question stats and CSV has a deterministic order for question stats).", "author": "xpdavid", "createdAt": "2020-07-10T04:25:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3NjkzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY2MTM0Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r452661347", "bodyText": "resuse/remove the sorting logic in the csv generation code\n\nWill look into this", "author": "t-cheepeng", "createdAt": "2020-07-10T07:07:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3NjkzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQxOTgyNw==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r453419827", "bodyText": "The only way i can see resuse is to add some sort method to the *-calculation class. But it seems to be break the purpose of the class since it is supposed to be for calculation of statistics only. Don't think that it brings about much benefit also since they have very different logic(the one in CSV and the one in sortable table). Unless I'm missing something?", "author": "t-cheepeng", "createdAt": "2020-07-13T03:47:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3NjkzNg=="}], "type": "inlineReview"}, {"oid": "68ebc127af8a25847c494bbe034a36a4ea4d3a91", "url": "https://github.com/TEAMMATES/teammates/commit/68ebc127af8a25847c494bbe034a36a4ea4d3a91", "message": "Specify initial sort more explicitly", "committedDate": "2020-07-10T06:57:48Z", "type": "commit"}, {"oid": "87efe849aec4a986e165f4bda1e742821b6ef3bb", "url": "https://github.com/TEAMMATES/teammates/commit/87efe849aec4a986e165f4bda1e742821b6ef3bb", "message": "Change loadFeedbackSession to use index", "committedDate": "2020-07-10T06:58:25Z", "type": "commit"}, {"oid": "ea4fb34716daab82cbe9f290062a471a09841a73", "url": "https://github.com/TEAMMATES/teammates/commit/ea4fb34716daab82cbe9f290062a471a09841a73", "message": "Move comment sorting to root page", "committedDate": "2020-07-10T07:06:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyMDc4OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r453420788", "bodyText": "Can we make this as @Input() (take place of initialSortBy )\nI just realize this break the promise of @Input().", "author": "xpdavid", "createdAt": "2020-07-13T03:51:50Z", "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -49,6 +49,9 @@ export class SortableTableComponent implements OnInit {\n   @Input()\n   rows: SortableTableCellData[][] = [];\n \n+  @Input()\n+  initialSortBy: SortBy = SortBy.NONE;\n+\n   columnToSortBy: string = '';", "originalCommit": "ea4fb34716daab82cbe9f290062a471a09841a73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyMTYwMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r453421600", "bodyText": "I think it is unnecessary to add sorting when CUD are happening.\n\nDelete won't affect the order\nFor update, we could have a recent edited comment jumping from the first row to the last row. I don't think user will expect this. I don't think V6 has this behavior either. We should sort by created data instead. However, if we do this, them, update won't affect the order also\nFor create, the order won't be affected as we do append.", "author": "xpdavid", "createdAt": "2020-07-13T03:56:02Z", "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "diffHunk": "@@ -125,8 +130,18 @@ export abstract class InstructorCommentsComponent {\n             },\n             isAddingNewComment: false,\n           };\n+          this.sortComments(this.instructorCommentTableModel[responseId]);\n         }, (resp: ErrorMessageOutput) => {\n           this.statusMessageService.showErrorToast(resp.error.message);\n         });\n   }\n+\n+  sortComments(commentTable: CommentTableModel): void {", "originalCommit": "ea4fb34716daab82cbe9f290062a471a09841a73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyMjI2Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10288#discussion_r453422267", "bodyText": "Although this work, can we do this with .pipe or other method. The current solution looks like a hack as it sort the list every time when activeCourses is udpated.", "author": "xpdavid", "createdAt": "2020-07-13T03:59:09Z", "path": "src/web/app/pages-instructor/instructor-courses-page/instructor-courses-page.component.ts", "diffHunk": "@@ -94,6 +90,7 @@ export class InstructorCoursesPageComponent implements OnInit {\n           const canModifyStudent: boolean = instructorPrivilege.canModifyStudent;\n           const activeCourse: CourseModel = Object.assign({}, { course, canModifyCourse, canModifyStudent });\n           this.activeCourses.push(activeCourse);\n+          this.sortCoursesEvent(SortBy.COURSE_CREATION_DATE);", "originalCommit": "ea4fb34716daab82cbe9f290062a471a09841a73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1441d613ba8c7afa18dcdb4515f23d5ca2f41068", "url": "https://github.com/TEAMMATES/teammates/commit/1441d613ba8c7afa18dcdb4515f23d5ca2f41068", "message": "Remove sorting from CUD and sort by creation date", "committedDate": "2020-07-13T04:50:39Z", "type": "commit"}, {"oid": "1f8b94f41dad1239a944aca4439badf15e6eaed7", "url": "https://github.com/TEAMMATES/teammates/commit/1f8b94f41dad1239a944aca4439badf15e6eaed7", "message": "Change sortCoursesEvent to be called at the end", "committedDate": "2020-07-13T05:00:18Z", "type": "commit"}, {"oid": "1c51841ade4a30c5abba0272b2f44b42b231c4c5", "url": "https://github.com/TEAMMATES/teammates/commit/1c51841ade4a30c5abba0272b2f44b42b231c4c5", "message": "Fix E2E tests for instructor course page", "committedDate": "2020-07-14T03:29:08Z", "type": "commit"}, {"oid": "53064439d4363931bb8fe7eb89e024287d538555", "url": "https://github.com/TEAMMATES/teammates/commit/53064439d4363931bb8fe7eb89e024287d538555", "message": "Merge branch 'master' into 10213-table-consistent-load", "committedDate": "2020-07-15T07:02:34Z", "type": "commit"}]}