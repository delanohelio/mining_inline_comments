{"pr_number": 9931, "pr_title": "[#9382] Add ActionFactoryTest", "pr_createdAt": "2020-01-28T07:00:13Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/9931", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1ODYyMQ==", "url": "https://github.com/TEAMMATES/teammates/pull/9931#discussion_r373758621", "bodyText": "This comment does not seem to be necessary because it does not add much information. You might want to remove this (and for the other tests below as well).", "author": "joanneong", "createdAt": "2020-02-01T05:04:03Z", "path": "src/test/java/teammates/test/cases/webapi/ActionFactoryTest.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package teammates.test.cases.webapi;\n+\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.client.methods.HttpPost;\n+import org.testng.annotations.Test;\n+\n+import teammates.common.exception.ActionMappingException;\n+import teammates.common.util.Const;\n+import teammates.test.cases.BaseTestCase;\n+import teammates.test.driver.MockHttpServletRequest;\n+import teammates.ui.webapi.action.Action;\n+import teammates.ui.webapi.action.ActionFactory;\n+import teammates.ui.webapi.action.GetAuthInfoAction;\n+\n+/**\n+ * SUT: {@link ActionFactory}.\n+ */\n+public class ActionFactoryTest extends BaseTestCase {\n+\n+    @Test\n+    public void testGetAction() throws Exception {\n+        ActionFactory actionFactory = new ActionFactory();\n+\n+        ______TS(\"Action exists and is retrieved\");\n+\n+        MockHttpServletRequest existingActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + Const.ResourceURIs.AUTH);\n+        // Use this value for testing", "originalCommit": "9d6822e18f22fd2a8a91b688f9d15e191ea770c5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1ODc2Ng==", "url": "https://github.com/TEAMMATES/teammates/pull/9931#discussion_r373758766", "bodyText": "Besides just checking whether the exception is thrown, is it possible for you to check the error message? This is because even with ActionFactory.java, there can be ActionMappingException thrown for different reasons.\n(Same for the test below)", "author": "joanneong", "createdAt": "2020-02-01T05:08:00Z", "path": "src/test/java/teammates/test/cases/webapi/ActionFactoryTest.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package teammates.test.cases.webapi;\n+\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.client.methods.HttpPost;\n+import org.testng.annotations.Test;\n+\n+import teammates.common.exception.ActionMappingException;\n+import teammates.common.util.Const;\n+import teammates.test.cases.BaseTestCase;\n+import teammates.test.driver.MockHttpServletRequest;\n+import teammates.ui.webapi.action.Action;\n+import teammates.ui.webapi.action.ActionFactory;\n+import teammates.ui.webapi.action.GetAuthInfoAction;\n+\n+/**\n+ * SUT: {@link ActionFactory}.\n+ */\n+public class ActionFactoryTest extends BaseTestCase {\n+\n+    @Test\n+    public void testGetAction() throws Exception {\n+        ActionFactory actionFactory = new ActionFactory();\n+\n+        ______TS(\"Action exists and is retrieved\");\n+\n+        MockHttpServletRequest existingActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + Const.ResourceURIs.AUTH);\n+        // Use this value for testing\n+        existingActionServletRequest.addHeader(\"Backdoor-Key\", \"samplekey\");\n+        Action existingAction = actionFactory.getAction(existingActionServletRequest, HttpGet.METHOD_NAME);\n+        assertTrue(existingAction instanceof GetAuthInfoAction);\n+\n+        ______TS(\"Action does not exist and ActionMappingException is thrown\");\n+\n+        MockHttpServletRequest nonExistentActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + \"blahblahblah\");\n+        // Use this value for testing\n+        nonExistentActionServletRequest.addHeader(\"Backdoor-Key\", \"samplekey\");\n+        assertThrows(ActionMappingException.class, () -> {\n+            actionFactory.getAction(nonExistentActionServletRequest, HttpGet.METHOD_NAME);\n+        });", "originalCommit": "9d6822e18f22fd2a8a91b688f9d15e191ea770c5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1ODgwMA==", "url": "https://github.com/TEAMMATES/teammates/pull/9931#discussion_r373758800", "bodyText": "There is a slight grammatical error here for \"Method does not on action exist\".", "author": "joanneong", "createdAt": "2020-02-01T05:08:39Z", "path": "src/test/java/teammates/test/cases/webapi/ActionFactoryTest.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package teammates.test.cases.webapi;\n+\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.client.methods.HttpPost;\n+import org.testng.annotations.Test;\n+\n+import teammates.common.exception.ActionMappingException;\n+import teammates.common.util.Const;\n+import teammates.test.cases.BaseTestCase;\n+import teammates.test.driver.MockHttpServletRequest;\n+import teammates.ui.webapi.action.Action;\n+import teammates.ui.webapi.action.ActionFactory;\n+import teammates.ui.webapi.action.GetAuthInfoAction;\n+\n+/**\n+ * SUT: {@link ActionFactory}.\n+ */\n+public class ActionFactoryTest extends BaseTestCase {\n+\n+    @Test\n+    public void testGetAction() throws Exception {\n+        ActionFactory actionFactory = new ActionFactory();\n+\n+        ______TS(\"Action exists and is retrieved\");\n+\n+        MockHttpServletRequest existingActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + Const.ResourceURIs.AUTH);\n+        // Use this value for testing\n+        existingActionServletRequest.addHeader(\"Backdoor-Key\", \"samplekey\");\n+        Action existingAction = actionFactory.getAction(existingActionServletRequest, HttpGet.METHOD_NAME);\n+        assertTrue(existingAction instanceof GetAuthInfoAction);\n+\n+        ______TS(\"Action does not exist and ActionMappingException is thrown\");\n+\n+        MockHttpServletRequest nonExistentActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + \"blahblahblah\");\n+        // Use this value for testing\n+        nonExistentActionServletRequest.addHeader(\"Backdoor-Key\", \"samplekey\");\n+        assertThrows(ActionMappingException.class, () -> {\n+            actionFactory.getAction(nonExistentActionServletRequest, HttpGet.METHOD_NAME);\n+        });\n+\n+        ______TS(\"Method does not on action exist and ActionMappingException is thrown\");", "originalCommit": "9d6822e18f22fd2a8a91b688f9d15e191ea770c5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "869e596aaf36b8b3d25657482ecdbabadc3e5cdf", "url": "https://github.com/TEAMMATES/teammates/commit/869e596aaf36b8b3d25657482ecdbabadc3e5cdf", "message": "WIP ActionFactoryTest", "committedDate": "2020-02-01T09:47:24Z", "type": "commit"}, {"oid": "b808bd1a2594b321fbd4d48dee5a73da65b9a2d9", "url": "https://github.com/TEAMMATES/teammates/commit/b808bd1a2594b321fbd4d48dee5a73da65b9a2d9", "message": "Add more tests for ActionFactory", "committedDate": "2020-02-01T09:47:24Z", "type": "commit"}, {"oid": "8f9512c03d38f1e8e543468d2a709581bc4f7a28", "url": "https://github.com/TEAMMATES/teammates/commit/8f9512c03d38f1e8e543468d2a709581bc4f7a28", "message": "Add newline at end", "committedDate": "2020-02-01T09:47:24Z", "type": "commit"}, {"oid": "130bb9c94d6c32b16142aacd4f3c34f6513c91ae", "url": "https://github.com/TEAMMATES/teammates/commit/130bb9c94d6c32b16142aacd4f3c34f6513c91ae", "message": "Add comment", "committedDate": "2020-02-01T09:47:24Z", "type": "commit"}, {"oid": "c88847058c24a19b70132fc57b9672d05ecbec40", "url": "https://github.com/TEAMMATES/teammates/commit/c88847058c24a19b70132fc57b9672d05ecbec40", "message": "Fix lint errors", "committedDate": "2020-02-01T09:47:24Z", "type": "commit"}, {"oid": "bcf326939bfc90b038d3015feea663f27962b5c1", "url": "https://github.com/TEAMMATES/teammates/commit/bcf326939bfc90b038d3015feea663f27962b5c1", "message": "Fix comments", "committedDate": "2020-02-01T09:47:24Z", "type": "commit"}, {"oid": "bcf326939bfc90b038d3015feea663f27962b5c1", "url": "https://github.com/TEAMMATES/teammates/commit/bcf326939bfc90b038d3015feea663f27962b5c1", "message": "Fix comments", "committedDate": "2020-02-01T09:47:24Z", "type": "forcePushed"}, {"oid": "fff5bd3c4acb33a75f955bbbc42583a3068aace7", "url": "https://github.com/TEAMMATES/teammates/commit/fff5bd3c4acb33a75f955bbbc42583a3068aace7", "message": "Merge branch 'master' into tests/add-action-factory-test", "committedDate": "2020-02-02T06:08:37Z", "type": "commit"}]}