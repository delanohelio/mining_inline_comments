{"pr_number": 472, "pr_title": "API improvements", "pr_createdAt": "2020-02-03T08:33:08Z", "pr_url": "https://github.com/b2ihealthcare/snow-owl/pull/472", "timeline": [{"oid": "e4c4407117a063cdda9e0e9be7547db0bd112836", "url": "https://github.com/b2ihealthcare/snow-owl/commit/e4c4407117a063cdda9e0e9be7547db0bd112836", "message": "SO-3864: change cardinality of ValueSet.compose to 0..1\n\nAs of https://www.hl7.org/fhir/valueset-definitions.html#ValueSet.compose", "committedDate": "2020-01-09T15:39:00Z", "type": "commit"}, {"oid": "f1bb16c89f9db28ebea6a3a0e182abd46f82a67d", "url": "https://github.com/b2ihealthcare/snow-owl/commit/f1bb16c89f9db28ebea6a3a0e182abd46f82a67d", "message": "SO-3864: return object ID from TransactionContext.add method", "committedDate": "2020-01-10T11:13:55Z", "type": "commit"}, {"oid": "932e0597a5dc9a3f750785761bd268afc5c661fc", "url": "https://github.com/b2ihealthcare/snow-owl/commit/932e0597a5dc9a3f750785761bd268afc5c661fc", "message": "SO-3864: set clearResources to true by default in SnowOwlAppRule", "committedDate": "2020-01-10T12:59:49Z", "type": "commit"}, {"oid": "d84c1b002aff00c304598f593b498685c142d001", "url": "https://github.com/b2ihealthcare/snow-owl/commit/d84c1b002aff00c304598f593b498685c142d001", "message": "SO-3864: extract common repository APIs to core.rest module", "committedDate": "2020-01-10T15:24:59Z", "type": "commit"}, {"oid": "079da7897094baba7d9c7416d27872524119c54e", "url": "https://github.com/b2ihealthcare/snow-owl/commit/079da7897094baba7d9c7416d27872524119c54e", "message": "SO-3864: extract common Resource search props to ResourceRestSearch\n\nIntroduce SnomedReferenceSetRestSearch and `POST /:path/refsets/search`\nendpoint.", "committedDate": "2020-01-10T15:36:16Z", "type": "commit"}, {"oid": "37174b5390f3a60fff8a8cc20ed847699702b860", "url": "https://github.com/b2ihealthcare/snow-owl/commit/37174b5390f3a60fff8a8cc20ed847699702b860", "message": "SO-3864: remove unused classes from snomed.core.rest plugin", "committedDate": "2020-01-10T15:36:41Z", "type": "commit"}, {"oid": "418feefebc4c0c010e55ac1cf5efeb821805fb19", "url": "https://github.com/b2ihealthcare/snow-owl/commit/418feefebc4c0c010e55ac1cf5efeb821805fb19", "message": "SO-3864: support dynamic loading of available API docs", "committedDate": "2020-01-10T16:30:57Z", "type": "commit"}, {"oid": "b60db7123dda142a6120a7745437cb9be349cb28", "url": "https://github.com/b2ihealthcare/snow-owl/commit/b60db7123dda142a6120a7745437cb9be349cb28", "message": "SO-3864: extract common branch aware test infrastructure to test.commons", "committedDate": "2020-01-14T16:50:23Z", "type": "commit"}, {"oid": "a29dbe480b64cca823e4e0cf8ad6c5592957b7c4", "url": "https://github.com/b2ihealthcare/snow-owl/commit/a29dbe480b64cca823e4e0cf8ad6c5592957b7c4", "message": "SO-3864: minor changes to test.commons MANIFEST.MF", "committedDate": "2020-01-14T19:42:52Z", "type": "commit"}, {"oid": "9a3351df7808db8bda42b7173df94cd946889755", "url": "https://github.com/b2ihealthcare/snow-owl/commit/9a3351df7808db8bda42b7173df94cd946889755", "message": "SO-3864: expose Elasticsearch Base64 UUID generator as IDs.base64UUID()", "committedDate": "2020-01-15T15:50:51Z", "type": "commit"}, {"oid": "d811db352d6772e67e5e9f6776019152bff6f404", "url": "https://github.com/b2ihealthcare/snow-owl/commit/d811db352d6772e67e5e9f6776019152bff6f404", "message": "SO-3864: expose core.id package", "committedDate": "2020-01-15T17:10:02Z", "type": "commit"}, {"oid": "e93885a65c8f9b88f8a2f04efc70fa7e30345442", "url": "https://github.com/b2ihealthcare/snow-owl/commit/e93885a65c8f9b88f8a2f04efc70fa7e30345442", "message": "SO-3864: rename ChangeRequest types\n\n`core.rest.codesystem.ChangeRequest` to\n`core.rest.domain.ResourceRequest`.\n`snomed.core.rest.domain.ChangeRequest` to\n`snomed.core.rest.domain.SnomedResourceRequest`.", "committedDate": "2020-01-16T11:17:40Z", "type": "commit"}, {"oid": "0fa57bf045047ae66d611d6cde0eeacb0b4d74f1", "url": "https://github.com/b2ihealthcare/snow-owl/commit/0fa57bf045047ae66d611d6cde0eeacb0b4d74f1", "message": "SO-3864: pull up getResourceLocationURI to AbstractRestService", "committedDate": "2020-01-16T12:35:47Z", "type": "commit"}, {"oid": "385b1187b20d8427609a00281b7839dbcce88a47", "url": "https://github.com/b2ihealthcare/snow-owl/commit/385b1187b20d8427609a00281b7839dbcce88a47", "message": "SO-3864: pull up comma joiner and JSON_UTF8 constants to RestExtensions", "committedDate": "2020-01-16T14:42:11Z", "type": "commit"}, {"oid": "5819f7161e5cdabab9c86218c00c294759c5c8a1", "url": "https://github.com/b2ihealthcare/snow-owl/commit/5819f7161e5cdabab9c86218c00c294759c5c8a1", "message": "SO-3864: fix failed SNOMED CT FHIR ValueSet API tests", "committedDate": "2020-01-16T15:02:18Z", "type": "commit"}, {"oid": "39664117d8fcc13c6431f6f38e7829af446a0040", "url": "https://github.com/b2ihealthcare/snow-owl/commit/39664117d8fcc13c6431f6f38e7829af446a0040", "message": "SO-3864: minor API improvements", "committedDate": "2020-01-16T17:01:16Z", "type": "commit"}, {"oid": "71cd4c390cb0353d1eb393a7f9f370e2b13fa930", "url": "https://github.com/b2ihealthcare/snow-owl/commit/71cd4c390cb0353d1eb393a7f9f370e2b13fa930", "message": "SO-3864: minor API improvements", "committedDate": "2020-01-16T20:10:49Z", "type": "commit"}, {"oid": "85ec91ad8e048623063027b75389c4eb2b466f36", "url": "https://github.com/b2ihealthcare/snow-owl/commit/85ec91ad8e048623063027b75389c4eb2b466f36", "message": "SO-3864: add RestExtensions.assertCreated helper", "committedDate": "2020-01-16T21:47:14Z", "type": "commit"}, {"oid": "5a16c02000e94c5379cec195aa9e106830a435b7", "url": "https://github.com/b2ihealthcare/snow-owl/commit/5a16c02000e94c5379cec195aa9e106830a435b7", "message": "SO-3864: report method not allowed errors properly", "committedDate": "2020-01-21T15:52:26Z", "type": "commit"}, {"oid": "3dd796efb130859d23b7e952e834a39f083dea6c", "url": "https://github.com/b2ihealthcare/snow-owl/commit/3dd796efb130859d23b7e952e834a39f083dea6c", "message": "Merge remote-tracking branch 'origin/7.x' into feature/SO-3864-valueset-model-changes", "committedDate": "2020-01-29T19:04:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk5MzEyMw==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/472#discussion_r373993123", "bodyText": "If anyone is wondering (I sure was): https://stackoverflow.com/questions/2621701/setting-log-level-of-message-at-runtime-in-slf4j/7829534\nQuick summary: there is no way to do this programmatically in SLF4j without a helper method.", "author": "apeteri", "createdAt": "2020-02-03T09:21:49Z", "path": "core/com.b2international.snowowl.core.rest/src/com/b2international/snowowl/core/rest/ControllerExceptionMapper.java", "diffHunk": "@@ -50,11 +52,21 @@\n \t\tif (Throwables.getRootCause(ex).getMessage().toLowerCase().contains(\"broken pipe\")) {\n \t        return null; // socket is closed, cannot return any response    \n \t    } else {\n-\t    \tLOG.trace(\"Exception during request processing\", ex);\n+\t    \tif (PlatformUtil.isDevVersion()) {", "originalCommit": "3dd796efb130859d23b7e952e834a39f083dea6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk5NjI3OQ==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/472#discussion_r373996279", "bodyText": "\u26a0\ufe0f typo\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Generates a time-based UUID (similar to Flake IDs), which is preferred when generating an ID to be indexed into a Lucene index asprimary key. \n          \n          \n            \n            \t * Generates a time-based UUID (similar to Flake IDs), which is preferred when generating an ID to be indexed into a Lucene index as primary key.", "author": "apeteri", "createdAt": "2020-02-03T09:28:41Z", "path": "core/com.b2international.snowowl.core/src/com/b2international/snowowl/core/id/IDs.java", "diffHunk": "@@ -13,25 +13,24 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-package com.b2international.snowowl.snomed.core.rest.domain;\n+package com.b2international.snowowl.core.id;\n+\n+import org.elasticsearch.common.UUIDs;\n \n /**\n- * @since 1.0\n+ * Class to use to generate decentralized random UUIDs. \n+ * \n+ * @since 7.3\n  */\n-public class SnomedIdentifierResponse {\n+public class IDs {\n \n-\tprivate String id;\n-\t\n-\tpublic SnomedIdentifierResponse(String id) {\n-\t\tthis.id = id;\n-\t}\n-\n-\tpublic String getId() {\n-\t\treturn id;\n-\t}\n-\t\n-\tpublic void setId(String id) {\n-\t\tthis.id = id;\n+\t/**\n+\t * Generates a time-based UUID (similar to Flake IDs), which is preferred when generating an ID to be indexed into a Lucene index asprimary key. ", "originalCommit": "3dd796efb130859d23b7e952e834a39f083dea6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk5NjgzMQ==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/472#discussion_r373996831", "bodyText": "Javadoc is half-true: the default implementation returns an identifier for CodeSystemEntry and CodeSystemVersionEntry instances as well.", "author": "apeteri", "createdAt": "2020-02-03T09:29:53Z", "path": "core/com.b2international.snowowl.core/src/com/b2international/snowowl/core/domain/TransactionContext.java", "diffHunk": "@@ -44,8 +44,9 @@\n \t * Adds the given {@link Object} to this transaction context as a completely new object. \n \t * \n \t * @param obj - the object to persist and add to the repository\n+\t * @return the identifier if the given object is an instanceof of {@link Revision} or <code>null</code> if the object is not a {@link Revision}.", "originalCommit": "3dd796efb130859d23b7e952e834a39f083dea6c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk5NzkyMg==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/472#discussion_r373997922", "bodyText": "(Also, didn't add support indexing non-revision controlled documents before? Did this functionality disappear with 7.x, or does it only exist in my mind?)", "author": "apeteri", "createdAt": "2020-02-03T09:32:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk5NjgzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDAzOTQzNw==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/472#discussion_r374039437", "bodyText": "Fixing it directly on 7.x after merging PR. Thanks!\nYeah, I think it did not, the StagingArea accepts any model, but the TransactionContext is primarily for RevisionDocuments.", "author": "cmark", "createdAt": "2020-02-03T10:58:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk5NjgzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDAyMTU2Ng==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/472#discussion_r374021566", "bodyText": "\ud83e\udd14", "author": "apeteri", "createdAt": "2020-02-03T10:20:19Z", "path": "snomed/com.b2international.snowowl.snomed.core.rest/src/com/b2international/snowowl/snomed/core/rest/domain/SnomedResourceRequest.java", "diffHunk": "@@ -15,31 +15,27 @@\n  */\n package com.b2international.snowowl.snomed.core.rest.domain;\n \n-import com.b2international.snowowl.core.terminology.ComponentCategory;\n-\n+import com.b2international.snowowl.core.rest.domain.ResourceRequest;\n+import com.google.common.base.MoreObjects.ToStringHelper;\n \n /**\n  * @since 1.0", "originalCommit": "3dd796efb130859d23b7e952e834a39f083dea6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "677a5dd0874f8e615ae0bfb5bac09fafc5c26b39", "url": "https://github.com/b2ihealthcare/snow-owl/commit/677a5dd0874f8e615ae0bfb5bac09fafc5c26b39", "message": "Update core/com.b2international.snowowl.core/src/com/b2international/snowowl/core/id/IDs.java\n\nCo-Authored-By: Andr\u00e1s P\u00e9teri <apeteri@b2international.com>", "committedDate": "2020-02-03T10:56:51Z", "type": "commit"}]}