{"pr_number": 597, "pr_title": "Release v7.7.0 fixes/changes", "pr_createdAt": "2020-06-26T07:33:26Z", "pr_url": "https://github.com/b2ihealthcare/snow-owl/pull/597", "timeline": [{"oid": "d7a8e766a15ae25316fdf8410a1322b118d95ee8", "url": "https://github.com/b2ihealthcare/snow-owl/commit/d7a8e766a15ae25316fdf8410a1322b118d95ee8", "message": "[vs] support query evaluation in non SNOMED terminologies", "committedDate": "2020-06-24T09:04:58Z", "type": "commit"}, {"oid": "23889a7aad4a301f8360d8ec6bba0a7895962077", "url": "https://github.com/b2ihealthcare/snow-owl/commit/23889a7aad4a301f8360d8ec6bba0a7895962077", "message": "[vs] fix getIds()", "committedDate": "2020-06-24T09:33:31Z", "type": "commit"}, {"oid": "5885667e100330d480495b3092ada7da1e1ecb2b", "url": "https://github.com/b2ihealthcare/snow-owl/commit/5885667e100330d480495b3092ada7da1e1ecb2b", "message": "[owl authoring] check if there is at least one axiom or relationship", "committedDate": "2020-06-24T14:31:40Z", "type": "commit"}, {"oid": "76e491e89049d7547131e9e3fed9f5cb9dd22ca3", "url": "https://github.com/b2ihealthcare/snow-owl/commit/76e491e89049d7547131e9e3fed9f5cb9dd22ca3", "message": "[core] Add helper method to retrieve authorized system bus", "committedDate": "2020-06-25T09:33:58Z", "type": "commit"}, {"oid": "322e4fa23c02ac8b043707f40a6c4305835e13bf", "url": "https://github.com/b2ihealthcare/snow-owl/commit/322e4fa23c02ac8b043707f40a6c4305835e13bf", "message": "[validation] connect filtering with toolingId", "committedDate": "2020-06-25T12:49:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMTgzOA==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/597#discussion_r446021838", "bodyText": "Isn't there a need here to check array length? I'm also not sure whether it is guaranteed that the query string does have at least one whitespace or not?", "author": "nagyo", "createdAt": "2020-06-26T07:44:16Z", "path": "core/com.b2international.snowowl.core/src/com/b2international/snowowl/core/request/ConceptSearchRequestEvaluator.java", "diffHunk": "@@ -113,4 +116,17 @@ public Concepts evaluate(CodeSystemURI uri, BranchContext context, Options searc\n \t\t}\n \t};\n \t\n+\t/**\n+\t * Support value set clause evaluation\n+\t * @since 7.7\n+\t */\n+\tpublic static Collection<String> getIds(Collection<String> querys) {\n+\t\tCollection<String> ids = Lists.newArrayList();\n+\t\tquerys.forEach(query -> {\n+\t\t\tString[] id = query.replaceAll(\"\\\\|\", \"\").split(\" \", 2);\n+\t\t\tids.add(id[0]);", "originalCommit": "322e4fa23c02ac8b043707f40a6c4305835e13bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAzNzY2Mg==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/597#discussion_r446037662", "bodyText": "Fixed.", "author": "cmark", "createdAt": "2020-06-26T08:17:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMTgzOA=="}], "type": "inlineReview"}, {"oid": "a66ac47419e98495e09b74c906bc1c5d3b09328c", "url": "https://github.com/b2ihealthcare/snow-owl/commit/a66ac47419e98495e09b74c906bc1c5d3b09328c", "message": "[core] support extracting ids from ID|TERM| like query strings", "committedDate": "2020-06-26T08:15:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAzNjQ3OQ==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/597#discussion_r446036479", "bodyText": "This will throw UnsupportedOperationException if no extension has been registered for a tooling ID.", "author": "apeteri", "createdAt": "2020-06-26T08:14:55Z", "path": "core/com.b2international.snowowl.core/src/com/b2international/snowowl/core/validation/issue/ValidationIssueSearchRequest.java", "diffHunk": "@@ -175,10 +175,11 @@ protected Expression prepareQuery(ServiceProvider context) {\n \t\t}\n \t\t\n \t\tif (containsKey(OptionKey.DETAILS)) {\n-\t\t\tfinal Collection<ValidationIssueDetailExtension> validationDetailExtensions = ValidationIssueDetailExtensionProvider.INSTANCE.getExtensions();\n-\t\t\tfor (ValidationIssueDetailExtension extension : validationDetailExtensions) {\n+\t\t\tfinal Collection<String> toolingIds = getCollection(OptionKey.TOOLING_ID, String.class);\n+\t\t\tfor (String toolingId : toolingIds) {\n+\t\t\t\tfinal ValidationIssueDetailExtension validationDetailExtension = ValidationIssueDetailExtensionProvider.INSTANCE.getExtensions(toolingId);", "originalCommit": "322e4fa23c02ac8b043707f40a6c4305835e13bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA0MzU2NQ==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/597#discussion_r446043565", "bodyText": "Fixed.", "author": "cmark", "createdAt": "2020-06-26T08:28:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAzNjQ3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAzNzI1MA==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/597#discussion_r446037250", "bodyText": "If there are multiple toolingId values given, and one adds their own query clauses to the builder, we might end up with a final query that is \"impossible\".", "author": "apeteri", "createdAt": "2020-06-26T08:16:27Z", "path": "core/com.b2international.snowowl.core/src/com/b2international/snowowl/core/validation/issue/ValidationIssueSearchRequest.java", "diffHunk": "@@ -175,10 +175,11 @@ protected Expression prepareQuery(ServiceProvider context) {\n \t\t}\n \t\t\n \t\tif (containsKey(OptionKey.DETAILS)) {\n-\t\t\tfinal Collection<ValidationIssueDetailExtension> validationDetailExtensions = ValidationIssueDetailExtensionProvider.INSTANCE.getExtensions();\n-\t\t\tfor (ValidationIssueDetailExtension extension : validationDetailExtensions) {\n+\t\t\tfinal Collection<String> toolingIds = getCollection(OptionKey.TOOLING_ID, String.class);\n+\t\t\tfor (String toolingId : toolingIds) {\n+\t\t\t\tfinal ValidationIssueDetailExtension validationDetailExtension = ValidationIssueDetailExtensionProvider.INSTANCE.getExtensions(toolingId);\n \t\t\t\tOptions options = getOptions(OptionKey.DETAILS);\n-\t\t\t\textension.prepareQuery(queryBuilder, options);\n+\t\t\t\tvalidationDetailExtension.prepareQuery(queryBuilder, options);", "originalCommit": "322e4fa23c02ac8b043707f40a6c4305835e13bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA0MzY0OA==", "url": "https://github.com/b2ihealthcare/snow-owl/pull/597#discussion_r446043648", "bodyText": "Fixed.", "author": "cmark", "createdAt": "2020-06-26T08:29:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAzNzI1MA=="}], "type": "inlineReview"}, {"oid": "01a3de1cf8df01ba0ff87c6b13f28753b98b4726", "url": "https://github.com/b2ihealthcare/snow-owl/commit/01a3de1cf8df01ba0ff87c6b13f28753b98b4726", "message": "[core] fix multiple tooling ID filter issues", "committedDate": "2020-06-26T08:29:15Z", "type": "commit"}, {"oid": "253a03eee79bf8a34a3342e7c56d84eecccd663d", "url": "https://github.com/b2ihealthcare/snow-owl/commit/253a03eee79bf8a34a3342e7c56d84eecccd663d", "message": "[validation] use toolingIDs to filter details by corresponding tooling..\n\n...specific queries only", "committedDate": "2020-06-26T09:14:26Z", "type": "commit"}]}