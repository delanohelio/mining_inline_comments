{"pr_number": 2704, "pr_title": "Add UM_HYBRID_GROUP_ROLE table", "pr_createdAt": "2020-06-15T09:39:03Z", "pr_url": "https://github.com/wso2/carbon-kernel/pull/2704", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5ODg0OQ==", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r443298849", "bodyText": "We will have to look at execution plans and add necessary indexes and all for optimization.\nPlease create a task to track such and attend", "author": "malithie", "createdAt": "2020-06-22T03:17:15Z", "path": "distribution/kernel/carbon-home/dbscripts/db2.sql", "diffHunk": "@@ -796,6 +796,17 @@ CREATE TABLE UM_HYBRID_USER_ROLE(\n     PRIMARY KEY(UM_ID,UM_TENANT_ID)\n )/\n \n+CREATE TABLE UM_HYBRID_GROUP_ROLE(\n+    UM_ID DECIMAL(31,0) NOT NULL,\n+    UM_GROUP_NAME VARCHAR(255) NOT NULL,\n+    UM_ROLE_ID DECIMAL(31,0) NOT NULL,\n+    UM_TENANT_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UM_DOMAIN_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UNIQUE(UM_GROUP_NAME,UM_ROLE_ID,UM_TENANT_ID),\n+    FOREIGN KEY(UM_ROLE_ID,UM_TENANT_ID) REFERENCES UM_HYBRID_ROLE(UM_ID,UM_TENANT_ID) ON DELETE CASCADE,\n+    PRIMARY KEY(UM_ID,UM_TENANT_ID)\n+)/\n+", "originalCommit": "8ece06730d4254e78e19e1e62f29dbae41bb2f6b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE5ODk4OA==", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448198988", "bodyText": "Created a task wso2/product-is#8595", "author": "ashensw", "createdAt": "2020-07-01T08:22:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5ODg0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMTc3NQ==", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448211775", "bodyText": "I think we need to write a trigger to implement auto-generated ID for UM_ID column similar to what we have done in UM_HYBRID_ROLE_TR1", "author": "mefarazath", "createdAt": "2020-07-01T08:44:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5ODg0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxOTYxOA==", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448219618", "bodyText": "Fixed and updated the PR.", "author": "ashensw", "createdAt": "2020-07-01T08:57:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5ODg0OQ=="}], "type": "inlineReview"}, {"oid": "a65f7ccbae43675e9d2f6166240d68cffee03f4b", "url": "https://github.com/wso2/carbon-kernel/commit/a65f7ccbae43675e9d2f6166240d68cffee03f4b", "message": "Add UM_HYBRID_GROUP_ROLE table", "committedDate": "2020-07-01T08:56:56Z", "type": "forcePushed"}, {"oid": "b205ade8db7d1e0f281db1a0630a72d1ae94a72f", "url": "https://github.com/wso2/carbon-kernel/commit/b205ade8db7d1e0f281db1a0630a72d1ae94a72f", "message": "Add UM_HYBRID_GROUP_ROLE table", "committedDate": "2020-07-01T08:58:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIyNDY3MQ==", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448224671", "bodyText": "Any specific reason why we don't have foreign key references in this table?", "author": "mefarazath", "createdAt": "2020-07-01T09:06:26Z", "path": "distribution/kernel/carbon-home/dbscripts/mysql_cluster.sql", "diffHunk": "@@ -393,6 +393,16 @@ CREATE TABLE UM_HYBRID_USER_ROLE(\n             PRIMARY KEY (UM_ID, UM_TENANT_ID)\n )ENGINE NDB;\n \n+CREATE TABLE UM_HYBRID_GROUP_ROLE(\n+            UM_ID INTEGER NOT NULL AUTO_INCREMENT,\n+            UM_GROUP_NAME VARCHAR(255),\n+            UM_ROLE_ID INTEGER NOT NULL,\n+            UM_TENANT_ID INTEGER DEFAULT 0,\n+            UM_DOMAIN_ID INTEGER,\n+            UNIQUE (UM_GROUP_NAME, UM_ROLE_ID, UM_TENANT_ID, UM_DOMAIN_ID),", "originalCommit": "b205ade8db7d1e0f281db1a0630a72d1ae94a72f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ1MjkyNg==", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448452926", "bodyText": "Added foreign keys for both UM_HYBRID_USER_ROLE and UM_HYBRID_GROUP_ROLE.", "author": "ashensw", "createdAt": "2020-07-01T15:42:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIyNDY3MQ=="}], "type": "inlineReview"}, {"oid": "6755446bdd0b032e929d4544de87cdf24d3863dc", "url": "https://github.com/wso2/carbon-kernel/commit/6755446bdd0b032e929d4544de87cdf24d3863dc", "message": "Add UM_HYBRID_GROUP_ROLE table", "committedDate": "2020-07-01T15:36:40Z", "type": "commit"}, {"oid": "6755446bdd0b032e929d4544de87cdf24d3863dc", "url": "https://github.com/wso2/carbon-kernel/commit/6755446bdd0b032e929d4544de87cdf24d3863dc", "message": "Add UM_HYBRID_GROUP_ROLE table", "committedDate": "2020-07-01T15:36:40Z", "type": "forcePushed"}]}