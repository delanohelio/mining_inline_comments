{"pr_number": 4274, "pr_title": "fix: Include functional tests jar in docker images", "pr_createdAt": "2020-01-10T22:04:10Z", "pr_url": "https://github.com/confluentinc/ksql/pull/4274", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ4Mzk1MQ==", "url": "https://github.com/confluentinc/ksql/pull/4274#discussion_r365483951", "bodyText": "What's this dockerfile? Can we keep the old one with all the instructions on how to build and run it locally? Also this one uses the local image, which probably shouldn't be checked in.", "author": "agavra", "createdAt": "2020-01-11T00:52:59Z", "path": "ksql-docker/docker-compose.yml", "diffHunk": "@@ -0,0 +1,51 @@\n+version: '2'", "originalCommit": "963e70cf9d4f05f4466662f70c785619d47dd6f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTk5NTgzMA==", "url": "https://github.com/confluentinc/ksql/pull/4274#discussion_r365995830", "bodyText": "My bad, shouldn't haven been checked in. I thought I had specifically removed it :/", "author": "vpapavas", "createdAt": "2020-01-13T19:50:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ4Mzk1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ4NDAxMw==", "url": "https://github.com/confluentinc/ksql/pull/4274#discussion_r365484013", "bodyText": "do we need to specify the version here?", "author": "agavra", "createdAt": "2020-01-11T00:53:23Z", "path": "ksql-docker/pom.xml", "diffHunk": "@@ -0,0 +1,96 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Copyright 2018 Confluent Inc.\n+  ~\n+  ~ Licensed under the Confluent Community License (the \"License\"); you may not use\n+  ~ this file except in compliance with the License.  You may obtain a copy of the\n+  ~ License at\n+  ~\n+  ~ http://www.confluent.io/confluent-community-license\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+  ~ WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations under the License.\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+  xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <parent>\n+    <artifactId>ksql-parent</artifactId>\n+    <groupId>io.confluent.ksql</groupId>\n+    <version>5.5.0-SNAPSHOT</version>\n+  </parent>\n+\n+  <artifactId>ksql-docker</artifactId>\n+\n+  <properties>\n+    <air.main.basedir>${project.parent.basedir}</air.main.basedir>\n+    <main-class>io.confluent.ksql.rest.server.KsqlRestApplication</main-class>\n+    <cli.skip-execute>false</cli.skip-execute>\n+    <cli.main-class>${main-class}</cli.main-class>\n+    <docker.skip-build>${skip.docker.build}</docker.skip-build>\n+    <docker.skip-test>${skip.docker.test}</docker.skip-test>\n+  </properties>\n+\n+  <dependencies>\n+    <dependency>\n+      <groupId>io.confluent.ksql</groupId>\n+      <artifactId>ksql-rest-app</artifactId>\n+    </dependency>\n+\n+    <dependency>\n+      <groupId>io.confluent.ksql</groupId>\n+      <artifactId>ksql-cli</artifactId>\n+    </dependency>\n+\n+    <dependency>\n+      <groupId>io.confluent.ksql</groupId>\n+      <artifactId>ksql-functional-tests</artifactId>\n+      <version>${project.version}</version>", "originalCommit": "963e70cf9d4f05f4466662f70c785619d47dd6f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjA4OTk5OQ==", "url": "https://github.com/confluentinc/ksql/pull/4274#discussion_r366089999", "bodyText": "We do, else maven errors out with\n[ERROR]   The project io.confluent.ksql:ksql-docker:5.5.0-SNAPSHOT (/Users/vpapavasileiou/Documents/confluent/ksql/ksql-docker/pom.xml) has 1 error\n[ERROR]     'dependencies.dependency.version' for io.confluent.ksql:ksql-functional-tests:jar is missing. @ line 50, column 17", "author": "vpapavas", "createdAt": "2020-01-13T23:51:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ4NDAxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjA5MTUwMQ==", "url": "https://github.com/confluentinc/ksql/pull/4274#discussion_r366091501", "bodyText": "Ahhhh.... instead of updating it here, can you update it in the parent POM alongside the other cross-submodule dependencies?", "author": "agavra", "createdAt": "2020-01-13T23:56:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ4NDAxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEwNDA2OQ==", "url": "https://github.com/confluentinc/ksql/pull/4274#discussion_r366104069", "bodyText": "done", "author": "vpapavas", "createdAt": "2020-01-14T00:46:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ4NDAxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ4NDE4NQ==", "url": "https://github.com/confluentinc/ksql/pull/4274#discussion_r365484185", "bodyText": "\ud83e\udd14 is this true for both the CLI and the Rest App? Can you test that the image works with our existing docker tutorials, and if not then see what we need to change? I think you asked this question, but is this main-class necessary (can we remove it)?", "author": "agavra", "createdAt": "2020-01-11T00:54:38Z", "path": "ksql-docker/pom.xml", "diffHunk": "@@ -0,0 +1,96 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Copyright 2018 Confluent Inc.\n+  ~\n+  ~ Licensed under the Confluent Community License (the \"License\"); you may not use\n+  ~ this file except in compliance with the License.  You may obtain a copy of the\n+  ~ License at\n+  ~\n+  ~ http://www.confluent.io/confluent-community-license\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+  ~ WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations under the License.\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+  xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <parent>\n+    <artifactId>ksql-parent</artifactId>\n+    <groupId>io.confluent.ksql</groupId>\n+    <version>5.5.0-SNAPSHOT</version>\n+  </parent>\n+\n+  <artifactId>ksql-docker</artifactId>\n+\n+  <properties>\n+    <air.main.basedir>${project.parent.basedir}</air.main.basedir>\n+    <main-class>io.confluent.ksql.rest.server.KsqlRestApplication</main-class>", "originalCommit": "963e70cf9d4f05f4466662f70c785619d47dd6f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEwNDQ0Ng==", "url": "https://github.com/confluentinc/ksql/pull/4274#discussion_r366104446", "bodyText": "Removed the main-class and rest. It was needed for enabling executing the created jar via -jar which we don't need in the image", "author": "vpapavas", "createdAt": "2020-01-14T00:47:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ4NDE4NQ=="}], "type": "inlineReview"}, {"oid": "9ef345e1ce1451e93ee798221ea63f51c23b45df", "url": "https://github.com/confluentinc/ksql/commit/9ef345e1ce1451e93ee798221ea63f51c23b45df", "message": "merged #4260", "committedDate": "2020-01-14T00:12:41Z", "type": "forcePushed"}, {"oid": "7fab1d89714f8f21a4c5e5b34fab70e04eae89ad", "url": "https://github.com/confluentinc/ksql/commit/7fab1d89714f8f21a4c5e5b34fab70e04eae89ad", "message": "build new server image with functional tests jar\n\nremoved not needed files\n\nrename module\n\nremove docker compose file", "committedDate": "2020-01-28T21:48:05Z", "type": "commit"}, {"oid": "f230fcd3338d9a48aec99ca07e381b51acced2a5", "url": "https://github.com/confluentinc/ksql/commit/f230fcd3338d9a48aec99ca07e381b51acced2a5", "message": "merged #4260", "committedDate": "2020-01-28T21:48:09Z", "type": "commit"}, {"oid": "1cb912bc1b430ed098d13bf9986a76580ab359a6", "url": "https://github.com/confluentinc/ksql/commit/1cb912bc1b430ed098d13bf9986a76580ab359a6", "message": "addressed comments", "committedDate": "2020-01-28T21:48:09Z", "type": "commit"}, {"oid": "1cb912bc1b430ed098d13bf9986a76580ab359a6", "url": "https://github.com/confluentinc/ksql/commit/1cb912bc1b430ed098d13bf9986a76580ab359a6", "message": "addressed comments", "committedDate": "2020-01-28T21:48:09Z", "type": "forcePushed"}, {"oid": "2091b5b9f7e5b7f0d047fdda8e4ee3529cae0226", "url": "https://github.com/confluentinc/ksql/commit/2091b5b9f7e5b7f0d047fdda8e4ee3529cae0226", "message": "added missing dependencies", "committedDate": "2020-01-29T19:05:42Z", "type": "commit"}]}