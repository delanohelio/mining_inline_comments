{"pr_number": 5641, "pr_title": "feat(client): support streaming inserts in Java client", "pr_createdAt": "2020-06-18T16:39:44Z", "pr_url": "https://github.com/confluentinc/ksql/pull/5641", "timeline": [{"oid": "23955f6b4c07c8fb166ee788b8648c303f38b686", "url": "https://github.com/confluentinc/ksql/commit/23955f6b4c07c8fb166ee788b8648c303f38b686", "message": "feat(client): support streaming inserts (wip)", "committedDate": "2020-06-17T16:34:45Z", "type": "commit"}, {"oid": "ec060cb236925ec23c8b81bc94fd056114aab98e", "url": "https://github.com/confluentinc/ksql/commit/ec060cb236925ec23c8b81bc94fd056114aab98e", "message": "chore: add example publisher", "committedDate": "2020-06-17T20:26:11Z", "type": "commit"}, {"oid": "309e874c5c1328b81dc30eea67a68d0d7a5a20ae", "url": "https://github.com/confluentinc/ksql/commit/309e874c5c1328b81dc30eea67a68d0d7a5a20ae", "message": "chore: clean up isFailed() from example publisher", "committedDate": "2020-06-17T20:26:14Z", "type": "commit"}, {"oid": "f56d070064651256681ab855f1c7f9d6613cf640", "url": "https://github.com/confluentinc/ksql/commit/f56d070064651256681ab855f1c7f9d6613cf640", "message": "test: add unit test", "committedDate": "2020-06-17T22:24:04Z", "type": "commit"}, {"oid": "1a61ed042b86ea3aa0c2cbca8377d4ce353d496b", "url": "https://github.com/confluentinc/ksql/commit/1a61ed042b86ea3aa0c2cbca8377d4ce353d496b", "message": "fix: switch to writing HTTP/2 frames", "committedDate": "2020-06-17T22:37:57Z", "type": "commit"}, {"oid": "4fb75c27cb8b6606c89a7b3bcb406a5f0a505168", "url": "https://github.com/confluentinc/ksql/commit/4fb75c27cb8b6606c89a7b3bcb406a5f0a505168", "message": "fix: fix failing test by disabling http2 cleartext upgrade", "committedDate": "2020-06-17T22:53:42Z", "type": "commit"}, {"oid": "7189c4065abc5c7b3f9c63f60ad7d2544eb85f1a", "url": "https://github.com/confluentinc/ksql/commit/7189c4065abc5c7b3f9c63f60ad7d2544eb85f1a", "message": "test: more unit tests", "committedDate": "2020-06-17T23:33:42Z", "type": "commit"}, {"oid": "5de76cf9c8fea67519e9e3cb4741a0c4e2ff404f", "url": "https://github.com/confluentinc/ksql/commit/5de76cf9c8fea67519e9e3cb4741a0c4e2ff404f", "message": "test: add integration test", "committedDate": "2020-06-18T00:00:18Z", "type": "commit"}, {"oid": "62004d9e104e5682659133ff5a427dd174793101", "url": "https://github.com/confluentinc/ksql/commit/62004d9e104e5682659133ff5a427dd174793101", "message": "Merge branch '6.0.x' into java-client-stream-inserts", "committedDate": "2020-06-18T00:06:20Z", "type": "commit"}, {"oid": "627e0f442d67f63040ea2a5a6d74fbc1e92c4342", "url": "https://github.com/confluentinc/ksql/commit/627e0f442d67f63040ea2a5a6d74fbc1e92c4342", "message": "chore: checkstyle and javadocs", "committedDate": "2020-06-18T16:28:41Z", "type": "commit"}, {"oid": "1d85b2a09aea0bbad5f839e3ff25faeb22eadbfe", "url": "https://github.com/confluentinc/ksql/commit/1d85b2a09aea0bbad5f839e3ff25faeb22eadbfe", "message": "Merge branch 'master' into java-client-stream-inserts", "committedDate": "2020-06-18T16:34:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM2MjYxMw==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r442362613", "bodyText": "Hey @purplefox I had to set this since otherwise the new tests were failing with\njava.lang.IllegalStateException: Cannot write an HTTP/2 frame over an HTTP/1.x connection\n\nbut I don't understand why that is. How come the cleartext upgrade prevents writing of HTTP/2 frames? Is the issue a race condition where the upgrade hasn't taken place by the time I try writing an HTTP/2 frame?", "author": "vcrfxia", "createdAt": "2020-06-18T16:43:17Z", "path": "ksqldb-api-client/src/main/java/io/confluent/ksql/api/client/impl/ClientImpl.java", "diffHunk": "@@ -254,6 +299,7 @@ private static HttpClient createHttpClient(final Vertx vertx, final ClientOption\n         .setSsl(clientOptions.isUseTls())\n         .setUseAlpn(clientOptions.isUseAlpn())\n         .setProtocolVersion(HttpVersion.HTTP_2)\n+        .setHttp2ClearTextUpgrade(false)", "originalCommit": "1d85b2a09aea0bbad5f839e3ff25faeb22eadbfe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM3NjIzNA==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r442376234", "bodyText": "Relatedly, do you think this change needs to be backported to the 6.0.x branch? (The old integrations tests pass on 6.0.x without this change so it seems fine to not backport but I wonder if I'm not realizing additional implications of this change.)", "author": "vcrfxia", "createdAt": "2020-06-18T17:06:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM2MjYxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ2MTIwNQ==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445461205", "bodyText": "Tbh I am not an expert on the http2 stuff here. I'd recommend posting on the vert.x google group.", "author": "purplefox", "createdAt": "2020-06-25T10:28:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM2MjYxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM2MzUwOQ==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r442363509", "bodyText": "Couldn't think of a way to make the methods in this class thread-safe without synchronizing all the public methods, but that doesn't feel right. Hopefully someone else has better ideas?", "author": "vcrfxia", "createdAt": "2020-06-18T16:44:47Z", "path": "ksqldb-api-client/src/main/java/io/confluent/ksql/api/client/InsertsPublisher.java", "diffHunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.api.client;\n+\n+import java.util.ArrayDeque;\n+import java.util.Objects;\n+import java.util.Queue;\n+import org.reactivestreams.Publisher;\n+import org.reactivestreams.Subscriber;\n+import org.reactivestreams.Subscription;\n+\n+/**\n+ * A {@code org.reactivestreams.Publisher} suitable for use with the\n+ * {@link Client#streamInserts(String, Publisher)} method. Rows for insertion are passed to the\n+ * publisher via the {@link #accept(KsqlObject)} method, and buffered for delivery once the\n+ * {@link Client#streamInserts} request is made and the server-side subscriber has been subscribed.\n+ */\n+public class InsertsPublisher implements Publisher<KsqlObject> {\n+\n+  /**\n+   * The buffer max size indicator value used by the default constructor. See\n+   * {@link #InsertsPublisher(int)} for how this value is used.\n+   */\n+  public static final int DEFAULT_BUFFER_MAX_SIZE = 200;\n+\n+  private Subscriber<? super KsqlObject> subscriber;\n+  private final Queue<KsqlObject> buffer = new ArrayDeque<>();\n+  private final int bufferMaxSize;\n+  private long demand;\n+  private Runnable drainHandler;\n+  private volatile boolean cancelled;\n+  private boolean complete;\n+  private boolean shouldSendComplete;\n+  private boolean sentComplete;\n+\n+  /**\n+   * Creates an {@code InsertsPublisher}.\n+   */\n+  public InsertsPublisher() {\n+    this(DEFAULT_BUFFER_MAX_SIZE);\n+  }\n+\n+  /**\n+   * Creates an {@code InsertsPublisher}.\n+   *\n+   * @param bufferMaxSize Indicative max number of elements to store in the buffer. Note that this\n+   *                      value is not enforced, but it used to determine what to return from the\n+   *                      {@link #accept(KsqlObject)} method so the caller can stop sending more\n+   *                      rows and set a drainHandler to be notified when the buffer is cleared\n+   */\n+  public InsertsPublisher(final int bufferMaxSize) {\n+    this.bufferMaxSize = bufferMaxSize;\n+  }\n+\n+  /**\n+   * Provides a new row for insertion. The publisher will attempt to deliver it to server endpoint,\n+   * once the {@link Client#streamInserts} request has been made. The publisher will buffer the row\n+   * internally if it can't deliver it immediately. Note that the row will be buffered even if the\n+   * buffer is 'full', i.e., if number of elements is at least {@code bufferMaxSize}, as the\n+   * {@code bufferMaxSize} value is not a hard limit. See {@link #InsertsPublisher(int)} for more.\n+   *\n+   * @param row the row to insert\n+   * @return whether the internal buffer is 'full', i.e., if number of elements is at least\n+   *         {@code bufferMaxSize}.\n+   */\n+  public synchronized boolean accept(final KsqlObject row) {", "originalCommit": "1d85b2a09aea0bbad5f839e3ff25faeb22eadbfe", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM2ODE1Mw==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r442368153", "bodyText": "Because AcksPublisherImpl is a buffered publisher, if a user that is not interested in acks and does not subscribe a subscriber to the AcksPublisher, then the record parser will be paused and any errors later written to the response will not be read. On the one hand this seems bad, but OTOH if the user isn't consuming acks then they're likely not interested? An alternative would be to switch the AcksPublisher to not be buffered, which means we can continue to consume messages from the response and log any potential errors even if no subscriber is subscribed.", "author": "vcrfxia", "createdAt": "2020-06-18T16:52:29Z", "path": "ksqldb-api-client/src/main/java/io/confluent/ksql/api/client/impl/StreamInsertsResponseHandler.java", "diffHunk": "@@ -0,0 +1,101 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.api.client.impl;\n+\n+import io.confluent.ksql.api.client.AcksPublisher;\n+import io.confluent.ksql.api.client.InsertAck;\n+import io.confluent.ksql.api.client.KsqlClientException;\n+import io.confluent.ksql.api.client.KsqlObject;\n+import io.vertx.core.Context;\n+import io.vertx.core.buffer.Buffer;\n+import io.vertx.core.http.HttpClientRequest;\n+import io.vertx.core.json.JsonObject;\n+import io.vertx.core.logging.Logger;\n+import io.vertx.core.logging.LoggerFactory;\n+import io.vertx.core.parsetools.RecordParser;\n+import java.util.Objects;\n+import java.util.concurrent.CompletableFuture;\n+import org.reactivestreams.Publisher;\n+\n+public class StreamInsertsResponseHandler\n+    extends ResponseHandler<CompletableFuture<AcksPublisher>> {\n+\n+  private static final Logger log = LoggerFactory.getLogger(StreamInsertsResponseHandler.class);\n+\n+  private final AcksPublisherImpl acksPublisher;\n+  private boolean paused;\n+\n+  StreamInsertsResponseHandler(\n+      final Context context,\n+      final RecordParser recordParser,\n+      final CompletableFuture<AcksPublisher> cf,\n+      final HttpClientRequest request,\n+      final Publisher<KsqlObject> insertsPublisher\n+  ) {\n+    super(context, recordParser, cf);\n+\n+    Objects.requireNonNull(request);\n+    insertsPublisher.subscribe(new StreamInsertsSubscriber(context, request));\n+\n+    this.acksPublisher = new AcksPublisherImpl(context);\n+    cf.complete(acksPublisher);\n+  }\n+\n+  @Override\n+  protected void doHandleBodyBuffer(final Buffer buff) {\n+    final JsonObject jsonObject = new JsonObject(buff);\n+    final long seqNum = jsonObject.getLong(\"seq\");\n+    final String status = jsonObject.getString(\"status\");\n+    if (\"ok\".equals(status)) {\n+      final InsertAck ack = new InsertAckImpl(seqNum);\n+      final boolean full = acksPublisher.accept(ack);\n+      if (full && !paused) {", "originalCommit": "1d85b2a09aea0bbad5f839e3ff25faeb22eadbfe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ2MjUyOQ==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445462529", "bodyText": "I think it's ok. If they don't subscribe they can't expect to get errors.", "author": "purplefox", "createdAt": "2020-06-25T10:31:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM2ODE1Mw=="}], "type": "inlineReview"}, {"oid": "059a8be9843413044052fbc14d33c8ca5e26d730", "url": "https://github.com/confluentinc/ksql/commit/059a8be9843413044052fbc14d33c8ca5e26d730", "message": "Merge branch 'master' into java-client-stream-inserts", "committedDate": "2020-06-24T15:50:19Z", "type": "commit"}, {"oid": "89ae5936441e3b8a5963c96d8e10ac8f9f0bd8da", "url": "https://github.com/confluentinc/ksql/commit/89ae5936441e3b8a5963c96d8e10ac8f9f0bd8da", "message": "Merge branch 'master' into java-client-stream-inserts", "committedDate": "2020-06-24T15:50:49Z", "type": "commit"}, {"oid": "b2ec8e47f0804457548b3610f3313b0717b9de50", "url": "https://github.com/confluentinc/ksql/commit/b2ec8e47f0804457548b3610f3313b0717b9de50", "message": "chore: fix merge from master", "committedDate": "2020-06-24T18:54:23Z", "type": "commit"}, {"oid": "559aec60035ed60da3dc4f8b0715752351299994", "url": "https://github.com/confluentinc/ksql/commit/559aec60035ed60da3dc4f8b0715752351299994", "message": "Merge branch 'master' into java-client-stream-inserts", "committedDate": "2020-06-24T23:50:01Z", "type": "commit"}, {"oid": "e3cb408736d9374b42163e8ce991d7518181739a", "url": "https://github.com/confluentinc/ksql/commit/e3cb408736d9374b42163e8ce991d7518181739a", "message": "chore: add equals/hashCode/toString methods to InsertAckImpl", "committedDate": "2020-06-24T23:51:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM2ODEzMQ==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445368131", "bodyText": "Why not extend BufferedPublisher? Then you get most of this for free.", "author": "purplefox", "createdAt": "2020-06-25T07:44:30Z", "path": "ksqldb-api-client/src/main/java/io/confluent/ksql/api/client/InsertsPublisher.java", "diffHunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.api.client;\n+\n+import java.util.ArrayDeque;\n+import java.util.Objects;\n+import java.util.Queue;\n+import org.reactivestreams.Publisher;\n+import org.reactivestreams.Subscriber;\n+import org.reactivestreams.Subscription;\n+\n+/**\n+ * A {@code org.reactivestreams.Publisher} suitable for use with the\n+ * {@link Client#streamInserts(String, Publisher)} method. Rows for insertion are passed to the\n+ * publisher via the {@link #accept(KsqlObject)} method, and buffered for delivery once the\n+ * {@link Client#streamInserts} request is made and the server-side subscriber has been subscribed.\n+ */\n+public class InsertsPublisher implements Publisher<KsqlObject> {", "originalCommit": "e3cb408736d9374b42163e8ce991d7518181739a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcxODQ3Ng==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445718476", "bodyText": "I thought when we first discussed providing InsertsPublisher and RowSubscriber (I plan to add this in a future PR) implementations for use with the client, we said the implementations shouldn't be tied to Vert.x. Did I misunderstand what you meant at the time?\nBesides not having Vert.x, this InsertsPublisher is also simpler than BufferedPublisher in that it doesn't expose sending custom errors to the subscriber (since there's no reason to do that here), and a few other minor bits.\nAlso, by decoupling InsertsPublisher from BufferedPublisher, we can evolve BufferedPublisher in breaking ways without affecting the user-facing API.\nWDYT?", "author": "vcrfxia", "createdAt": "2020-06-25T17:23:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM2ODEzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM3Mjc0NQ==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445372745", "bodyText": "What's the purpose of this block? Is it to write some data without ending the request? If so, request.write() should do that.", "author": "purplefox", "createdAt": "2020-06-25T07:52:47Z", "path": "ksqldb-api-client/src/main/java/io/confluent/ksql/api/client/impl/ClientImpl.java", "diffHunk": "@@ -259,7 +297,14 @@ public void close() {\n     if (clientOptions.isUseBasicAuth()) {\n       request = configureBasicAuth(request);\n     }\n-    request.end(requestBody);\n+    if (endRequest) {\n+      request.end(requestBody);\n+    } else {\n+      final HttpClientRequest finalRequest = request;", "originalCommit": "e3cb408736d9374b42163e8ce991d7518181739a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcxOTc3Nw==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445719777", "bodyText": "I actually had request.write() initially but hit\njava.lang.IllegalStateException: You must set the Content-Length header to be the total size of the message body BEFORE sending any data if you are not using HTTP chunked encoding.\n\n\tat io.vertx.core.http.impl.HttpClientRequestImpl.write(HttpClientRequestImpl.java:619)\n\tat io.vertx.core.http.impl.HttpClientRequestImpl.write(HttpClientRequestImpl.java:575)\n\tat io.vertx.core.http.impl.HttpClientRequestImpl.write(HttpClientRequestImpl.java:569)\n\tat io.confluent.ksql.api.client.impl.ClientImpl.makeRequest(ClientImpl.java:241)\n\tat io.confluent.ksql.api.client.impl.ClientImpl.streamInserts(ClientImpl.java:152)\n\tat io.confluent.ksql.api.client.ClientTest.shouldStreamInserts(ClientTest.java:576)\n\nMy understanding is that request.write() is meant for (1) non-streaming use cases where the content length is known upfront, and (2) HTTP/1.x streaming with chunked encoding, whereas request.writeCustomFrame() is meant for HTTP/2 streaming.", "author": "vcrfxia", "createdAt": "2020-06-25T17:25:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM3Mjc0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcyMjQ3Mw==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445722473", "bodyText": "I think you should be able to call write with HTTP 2 with setting content-length, perhaps this is due to the alpn/cleartext weirdness?", "author": "purplefox", "createdAt": "2020-06-25T17:30:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM3Mjc0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcyNDMzMw==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445724333", "bodyText": "How would I know what to set the content-length to, though? This is for the inserts stream use case, so more data may be written to the connection later (as more rows are inserted).", "author": "vcrfxia", "createdAt": "2020-06-25T17:33:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM3Mjc0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcyNDkzMw==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445724933", "bodyText": "In HTTP2 you don't need to set content-length", "author": "purplefox", "createdAt": "2020-06-25T17:34:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM3Mjc0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcyNzc5OA==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445727798", "bodyText": "That's what writeCustomFrame() lets us achieve, right? I guess I'm not understanding how the behavior of write(), assuming it's allowed for HTTP/2 without setting content length upfront, would differ from writeCustomFrame() as used in the current implementation.\n(Just asking to improve my understanding of HTTP at this point. IIUC, this discussion is not blocking this PR :) )", "author": "vcrfxia", "createdAt": "2020-06-25T17:39:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM3Mjc0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg3OTIxOQ==", "url": "https://github.com/confluentinc/ksql/pull/5641#discussion_r445879219", "bodyText": "Merged the PR for now. Can update in a follow-up if we decide writeCustomFrame() isn't the way to go.", "author": "vcrfxia", "createdAt": "2020-06-25T22:46:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM3Mjc0NQ=="}], "type": "inlineReview"}, {"oid": "685d4e9cc07f297b9134b61d040b7e0323e6ec40", "url": "https://github.com/confluentinc/ksql/commit/685d4e9cc07f297b9134b61d040b7e0323e6ec40", "message": "test: add EqualsTester test", "committedDate": "2020-06-25T21:06:27Z", "type": "commit"}]}