{"pr_number": 5769, "pr_title": "fix: ensure null values cast to varchar/string remain null", "pr_createdAt": "2020-07-06T23:55:00Z", "pr_url": "https://github.com/confluentinc/ksql/pull/5769", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjkyNzE3Mw==", "url": "https://github.com/confluentinc/ksql/pull/5769#discussion_r452927173", "bodyText": "looking at the plan.json that was generated from the test, I'm not sure this is backwards compatible - unless I'm missing something, we don't add the generated java code to the plan that we enqueue (cc @rodesai to comment on whether or not including that might be a good idea). That would mean that we would be changing any existing query to have this behavior.\nwe should consider whether this backwards incompatible change is acceptable or if we should guard this with a config that defaults to disabled, but any new query would have it enabled", "author": "agavra", "createdAt": "2020-07-10T15:49:52Z", "path": "ksqldb-execution/src/main/java/io/confluent/ksql/execution/codegen/SqlToJavaVisitor.java", "diffHunk": "@@ -932,7 +933,7 @@ private CastVisitor() {\n         final int scale = decimal.getScale();\n         exprStr = String.format(\"DecimalUtil.format(%d, %d, %s)\", precision, scale, expr.getLeft());\n       } else {\n-        exprStr = \"String.valueOf(\" + expr.getLeft() + \")\";\n+        exprStr = \"Objects.toString(\" + expr.getLeft() + \", null)\";", "originalCommit": "e0c79f43643c7a9ef09b7d14540cc7da05e7e5e2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "66c34aca1b086a4e558d567a8276228f981dd083", "url": "https://github.com/confluentinc/ksql/commit/66c34aca1b086a4e558d567a8276228f981dd083", "message": "fix: ensure null values cast to varchar/string remain null", "committedDate": "2020-07-10T18:06:07Z", "type": "commit"}, {"oid": "66c34aca1b086a4e558d567a8276228f981dd083", "url": "https://github.com/confluentinc/ksql/commit/66c34aca1b086a4e558d567a8276228f981dd083", "message": "fix: ensure null values cast to varchar/string remain null", "committedDate": "2020-07-10T18:06:07Z", "type": "forcePushed"}, {"oid": "e1440810db9f2d6d04e09894d3ddbd1fab94c0bf", "url": "https://github.com/confluentinc/ksql/commit/e1440810db9f2d6d04e09894d3ddbd1fab94c0bf", "message": "make a config to toggle fix", "committedDate": "2020-07-13T16:59:44Z", "type": "commit"}, {"oid": "e1440810db9f2d6d04e09894d3ddbd1fab94c0bf", "url": "https://github.com/confluentinc/ksql/commit/e1440810db9f2d6d04e09894d3ddbd1fab94c0bf", "message": "make a config to toggle fix", "committedDate": "2020-07-13T16:59:44Z", "type": "forcePushed"}, {"oid": "2a4c54dca04d32194d9272f6e4279e4465f6e63e", "url": "https://github.com/confluentinc/ksql/commit/2a4c54dca04d32194d9272f6e4279e4465f6e63e", "message": "update plans", "committedDate": "2020-07-13T19:41:57Z", "type": "forcePushed"}, {"oid": "728f4b41a39876fb056431fae0be6eda6440a15f", "url": "https://github.com/confluentinc/ksql/commit/728f4b41a39876fb056431fae0be6eda6440a15f", "message": "update plans", "committedDate": "2020-07-13T19:46:27Z", "type": "commit"}, {"oid": "728f4b41a39876fb056431fae0be6eda6440a15f", "url": "https://github.com/confluentinc/ksql/commit/728f4b41a39876fb056431fae0be6eda6440a15f", "message": "update plans", "committedDate": "2020-07-13T19:46:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzk2ODE5OA==", "url": "https://github.com/confluentinc/ksql/pull/5769#discussion_r453968198", "bodyText": "maybe ksql.cast.strings.stringify.nulls (or flipping the semantics ksql.cast.strings.preserve.nulls)", "author": "agavra", "createdAt": "2020-07-13T22:09:16Z", "path": "ksqldb-common/src/main/java/io/confluent/ksql/util/KsqlConfig.java", "diffHunk": "@@ -215,8 +215,10 @@\n   public static final String KSQL_QUERY_PULL_MAX_QPS_DOC = \"The maximum qps allowed for pull \"\n       + \"queries. Once the limit is hit, queries will fail immediately\";\n \n-  public static final Collection<CompatibilityBreakingConfigDef> COMPATIBLY_BREAKING_CONFIG_DEFS\n-      = ImmutableList.of();\n+  public static final String KSQL_STRING_CASE_CONFIG_TOGGLE = \"ksql.string.case.toggle\";", "originalCommit": "728f4b41a39876fb056431fae0be6eda6440a15f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "02a70989390ae4ec688bf499b70dbcf5adeb26b3", "url": "https://github.com/confluentinc/ksql/commit/02a70989390ae4ec688bf499b70dbcf5adeb26b3", "message": "change config name", "committedDate": "2020-07-13T23:11:40Z", "type": "commit"}, {"oid": "02a70989390ae4ec688bf499b70dbcf5adeb26b3", "url": "https://github.com/confluentinc/ksql/commit/02a70989390ae4ec688bf499b70dbcf5adeb26b3", "message": "change config name", "committedDate": "2020-07-13T23:11:40Z", "type": "forcePushed"}]}