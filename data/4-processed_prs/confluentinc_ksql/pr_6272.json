{"pr_number": 6272, "pr_title": "docs: Improve security docs for authentication", "pr_createdAt": "2020-09-22T20:04:27Z", "pr_url": "https://github.com/confluentinc/ksql/pull/6272", "timeline": [{"oid": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "url": "https://github.com/confluentinc/ksql/commit/76e3d0c3f7b7c563145604a6fbf0100136de1c24", "message": "docs: Improve security docs for authentication", "committedDate": "2020-09-22T20:03:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAyMzUwNw==", "url": "https://github.com/confluentinc/ksql/pull/6272#discussion_r493023507", "bodyText": "Maybe \"Copy all of the password encrypted lines\"?", "author": "JimGalasyn", "createdAt": "2020-09-22T20:46:51Z", "path": "docs/operate-and-deploy/installation/server-config/security.md", "diffHunk": "@@ -287,7 +248,86 @@ CRYPT:frd5btY/mvXo6\n ```\n \n Where each line of the output is the password encrypted using different\n-mechanisms, starting with plain text.\n+mechanisms, starting with plain text. Copy any of the password encrypted", "originalCommit": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAyMzY3MA==", "url": "https://github.com/confluentinc/ksql/pull/6272#discussion_r493023670", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The roles names are defined next to the encrypted password. These\n          \n          \n            \n            The role names are defined next to the encrypted password. These", "author": "JimGalasyn", "createdAt": "2020-09-22T20:47:09Z", "path": "docs/operate-and-deploy/installation/server-config/security.md", "diffHunk": "@@ -287,7 +248,86 @@ CRYPT:frd5btY/mvXo6\n ```\n \n Where each line of the output is the password encrypted using different\n-mechanisms, starting with plain text.\n+mechanisms, starting with plain text. Copy any of the password encrypted\n+lines onto the password file.\n+\n+The roles names are defined next to the encrypted password. These", "originalCommit": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAyNDI3Ng==", "url": "https://github.com/confluentinc/ksql/pull/6272#discussion_r493024276", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The `authentication.method` specifies ksqlDB to authenticate users using `BASIC`\n          \n          \n            \n            The `authentication.method` property indicates that ksqlDB authenticates users by using `BASIC`", "author": "JimGalasyn", "createdAt": "2020-09-22T20:48:10Z", "path": "docs/operate-and-deploy/installation/server-config/security.md", "diffHunk": "@@ -287,7 +248,86 @@ CRYPT:frd5btY/mvXo6\n ```\n \n Where each line of the output is the password encrypted using different\n-mechanisms, starting with plain text.\n+mechanisms, starting with plain text. Copy any of the password encrypted\n+lines onto the password file.\n+\n+The roles names are defined next to the encrypted password. These\n+are used by the `LoginModule` to map users to roles.\n+\n+Here's an example of the password file:\n+\n+```\n+fred: OBF:1w8t1tvf1w261w8v1w1c1tvn1w8x,user,admin\n+harry: changeme,user,developer\n+tom: MD5:164c88b302622e17050af52c89945d44,user\n+dick: CRYPT:adpexzg3FUZAk,admin,ksql-user\n+```\n+\n+### Configure the ksqlDB server settings\n+\n+Use the following settings in the `ksql-server.properties` file:\n+\n+```properties\n+authentication.method=BASIC\n+authentication.realm=<KsqlServer-Props-in-jaas_config.file>\n+authentication.roles=<user-role1>,<user-role2>,...\n+```\n+\n+The `authentication.method` specifies ksqlDB to authenticate users using `BASIC`", "originalCommit": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAyNDQzMw==", "url": "https://github.com/confluentinc/ksql/pull/6272#discussion_r493024433", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In this example, the `authentication.realm` config is set to the `KsqlServer-Props`, which\n          \n          \n            \n            In this example, the `authentication.realm` config is set to `KsqlServer-Props`, which", "author": "JimGalasyn", "createdAt": "2020-09-22T20:48:31Z", "path": "docs/operate-and-deploy/installation/server-config/security.md", "diffHunk": "@@ -287,7 +248,86 @@ CRYPT:frd5btY/mvXo6\n ```\n \n Where each line of the output is the password encrypted using different\n-mechanisms, starting with plain text.\n+mechanisms, starting with plain text. Copy any of the password encrypted\n+lines onto the password file.\n+\n+The roles names are defined next to the encrypted password. These\n+are used by the `LoginModule` to map users to roles.\n+\n+Here's an example of the password file:\n+\n+```\n+fred: OBF:1w8t1tvf1w261w8v1w1c1tvn1w8x,user,admin\n+harry: changeme,user,developer\n+tom: MD5:164c88b302622e17050af52c89945d44,user\n+dick: CRYPT:adpexzg3FUZAk,admin,ksql-user\n+```\n+\n+### Configure the ksqlDB server settings\n+\n+Use the following settings in the `ksql-server.properties` file:\n+\n+```properties\n+authentication.method=BASIC\n+authentication.realm=<KsqlServer-Props-in-jaas_config.file>\n+authentication.roles=<user-role1>,<user-role2>,...\n+```\n+\n+The `authentication.method` specifies ksqlDB to authenticate users using `BASIC`\n+user and password credentials.\n+\n+The `authentication.realm` config must match a section within\n+`jaas_config.file`, which provides the login module for authentication.\n+\n+In this example, the `authentication.realm` config is set to the `KsqlServer-Props`, which", "originalCommit": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAyNTAwNg==", "url": "https://github.com/confluentinc/ksql/pull/6272#discussion_r493025006", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            For example, if you define `admin` and `developer` roles, ksqlDB will allow access to only users that contain these roles\n          \n          \n            \n            For example, if you define `admin` and `developer` roles, ksqlDB allows access only to users that contain these roles", "author": "JimGalasyn", "createdAt": "2020-09-22T20:49:36Z", "path": "docs/operate-and-deploy/installation/server-config/security.md", "diffHunk": "@@ -287,7 +248,86 @@ CRYPT:frd5btY/mvXo6\n ```\n \n Where each line of the output is the password encrypted using different\n-mechanisms, starting with plain text.\n+mechanisms, starting with plain text. Copy any of the password encrypted\n+lines onto the password file.\n+\n+The roles names are defined next to the encrypted password. These\n+are used by the `LoginModule` to map users to roles.\n+\n+Here's an example of the password file:\n+\n+```\n+fred: OBF:1w8t1tvf1w261w8v1w1c1tvn1w8x,user,admin\n+harry: changeme,user,developer\n+tom: MD5:164c88b302622e17050af52c89945d44,user\n+dick: CRYPT:adpexzg3FUZAk,admin,ksql-user\n+```\n+\n+### Configure the ksqlDB server settings\n+\n+Use the following settings in the `ksql-server.properties` file:\n+\n+```properties\n+authentication.method=BASIC\n+authentication.realm=<KsqlServer-Props-in-jaas_config.file>\n+authentication.roles=<user-role1>,<user-role2>,...\n+```\n+\n+The `authentication.method` specifies ksqlDB to authenticate users using `BASIC`\n+user and password credentials.\n+\n+The `authentication.realm` config must match a section within\n+`jaas_config.file`, which provides the login module for authentication.\n+\n+In this example, the `authentication.realm` config is set to the `KsqlServer-Props`, which\n+was defined in the previous section:\n+\n+```properties\n+authentication.realm=KsqlServer-Props\n+```\n+\n+The `authentication.roles` config defines a comma-separated list of user\n+roles with access to the ksqlDB server. To be authorized to use the ksqlDB Server,\n+an authenticated user must belong to at least one of these roles.\n+\n+For example, if you define `admin` and `developer` roles, ksqlDB will allow access to only users that contain these roles", "originalCommit": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAyNTI3NQ==", "url": "https://github.com/confluentinc/ksql/pull/6272#discussion_r493025275", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            (see configuration for the password file under the `jaas_config.file` section).\n          \n          \n            \n            For more information, see the configuration for the password file in the `jaas_config.file` section.", "author": "JimGalasyn", "createdAt": "2020-09-22T20:50:04Z", "path": "docs/operate-and-deploy/installation/server-config/security.md", "diffHunk": "@@ -287,7 +248,86 @@ CRYPT:frd5btY/mvXo6\n ```\n \n Where each line of the output is the password encrypted using different\n-mechanisms, starting with plain text.\n+mechanisms, starting with plain text. Copy any of the password encrypted\n+lines onto the password file.\n+\n+The roles names are defined next to the encrypted password. These\n+are used by the `LoginModule` to map users to roles.\n+\n+Here's an example of the password file:\n+\n+```\n+fred: OBF:1w8t1tvf1w261w8v1w1c1tvn1w8x,user,admin\n+harry: changeme,user,developer\n+tom: MD5:164c88b302622e17050af52c89945d44,user\n+dick: CRYPT:adpexzg3FUZAk,admin,ksql-user\n+```\n+\n+### Configure the ksqlDB server settings\n+\n+Use the following settings in the `ksql-server.properties` file:\n+\n+```properties\n+authentication.method=BASIC\n+authentication.realm=<KsqlServer-Props-in-jaas_config.file>\n+authentication.roles=<user-role1>,<user-role2>,...\n+```\n+\n+The `authentication.method` specifies ksqlDB to authenticate users using `BASIC`\n+user and password credentials.\n+\n+The `authentication.realm` config must match a section within\n+`jaas_config.file`, which provides the login module for authentication.\n+\n+In this example, the `authentication.realm` config is set to the `KsqlServer-Props`, which\n+was defined in the previous section:\n+\n+```properties\n+authentication.realm=KsqlServer-Props\n+```\n+\n+The `authentication.roles` config defines a comma-separated list of user\n+roles with access to the ksqlDB server. To be authorized to use the ksqlDB Server,\n+an authenticated user must belong to at least one of these roles.\n+\n+For example, if you define `admin` and `developer` roles, ksqlDB will allow access to only users that contain these roles\n+(see configuration for the password file under the `jaas_config.file` section).", "originalCommit": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAyNzE1Mw==", "url": "https://github.com/confluentinc/ksql/pull/6272#discussion_r493027153", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Note. You can authorize any role by setting the `authentication.roles` to `**`.\n          \n          \n            \n            !!! note\n          \n          \n            \n                You can authorize any role by setting the `authentication.roles` to `**`.", "author": "JimGalasyn", "createdAt": "2020-09-22T20:53:43Z", "path": "docs/operate-and-deploy/installation/server-config/security.md", "diffHunk": "@@ -287,7 +248,86 @@ CRYPT:frd5btY/mvXo6\n ```\n \n Where each line of the output is the password encrypted using different\n-mechanisms, starting with plain text.\n+mechanisms, starting with plain text. Copy any of the password encrypted\n+lines onto the password file.\n+\n+The roles names are defined next to the encrypted password. These\n+are used by the `LoginModule` to map users to roles.\n+\n+Here's an example of the password file:\n+\n+```\n+fred: OBF:1w8t1tvf1w261w8v1w1c1tvn1w8x,user,admin\n+harry: changeme,user,developer\n+tom: MD5:164c88b302622e17050af52c89945d44,user\n+dick: CRYPT:adpexzg3FUZAk,admin,ksql-user\n+```\n+\n+### Configure the ksqlDB server settings\n+\n+Use the following settings in the `ksql-server.properties` file:\n+\n+```properties\n+authentication.method=BASIC\n+authentication.realm=<KsqlServer-Props-in-jaas_config.file>\n+authentication.roles=<user-role1>,<user-role2>,...\n+```\n+\n+The `authentication.method` specifies ksqlDB to authenticate users using `BASIC`\n+user and password credentials.\n+\n+The `authentication.realm` config must match a section within\n+`jaas_config.file`, which provides the login module for authentication.\n+\n+In this example, the `authentication.realm` config is set to the `KsqlServer-Props`, which\n+was defined in the previous section:\n+\n+```properties\n+authentication.realm=KsqlServer-Props\n+```\n+\n+The `authentication.roles` config defines a comma-separated list of user\n+roles with access to the ksqlDB server. To be authorized to use the ksqlDB Server,\n+an authenticated user must belong to at least one of these roles.\n+\n+For example, if you define `admin` and `developer` roles, ksqlDB will allow access to only users that contain these roles\n+(see configuration for the password file under the `jaas_config.file` section).\n+\n+```properties\n+authentication.roles=admin,developer\n+```\n+\n+Note. You can authorize any role by setting the `authentication.roles` to `**`.", "originalCommit": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAzMjU3MQ==", "url": "https://github.com/confluentinc/ksql/pull/6272#discussion_r493032571", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            user and password credentials found in the password file. But only `fred` and `dick` will\n          \n          \n            \n            user and password credentials found in the password file. But only `fred` and `dick`", "author": "JimGalasyn", "createdAt": "2020-09-22T21:04:05Z", "path": "docs/operate-and-deploy/installation/server-config/security.md", "diffHunk": "@@ -287,7 +248,86 @@ CRYPT:frd5btY/mvXo6\n ```\n \n Where each line of the output is the password encrypted using different\n-mechanisms, starting with plain text.\n+mechanisms, starting with plain text. Copy any of the password encrypted\n+lines onto the password file.\n+\n+The roles names are defined next to the encrypted password. These\n+are used by the `LoginModule` to map users to roles.\n+\n+Here's an example of the password file:\n+\n+```\n+fred: OBF:1w8t1tvf1w261w8v1w1c1tvn1w8x,user,admin\n+harry: changeme,user,developer\n+tom: MD5:164c88b302622e17050af52c89945d44,user\n+dick: CRYPT:adpexzg3FUZAk,admin,ksql-user\n+```\n+\n+### Configure the ksqlDB server settings\n+\n+Use the following settings in the `ksql-server.properties` file:\n+\n+```properties\n+authentication.method=BASIC\n+authentication.realm=<KsqlServer-Props-in-jaas_config.file>\n+authentication.roles=<user-role1>,<user-role2>,...\n+```\n+\n+The `authentication.method` specifies ksqlDB to authenticate users using `BASIC`\n+user and password credentials.\n+\n+The `authentication.realm` config must match a section within\n+`jaas_config.file`, which provides the login module for authentication.\n+\n+In this example, the `authentication.realm` config is set to the `KsqlServer-Props`, which\n+was defined in the previous section:\n+\n+```properties\n+authentication.realm=KsqlServer-Props\n+```\n+\n+The `authentication.roles` config defines a comma-separated list of user\n+roles with access to the ksqlDB server. To be authorized to use the ksqlDB Server,\n+an authenticated user must belong to at least one of these roles.\n+\n+For example, if you define `admin` and `developer` roles, ksqlDB will allow access to only users that contain these roles\n+(see configuration for the password file under the `jaas_config.file` section).\n+\n+```properties\n+authentication.roles=admin,developer\n+```\n+\n+Note. You can authorize any role by setting the `authentication.roles` to `**`.\n+\n+###  Example\n+\n+Password file:\n+```\n+fred: OBF:1w8t1tvf1w261w8v1w1c1tvn1w8x,user,admin\n+harry: changeme,user,developer\n+tom: MD5:164c88b302622e17050af52c89945d44,user\n+dick: CRYPT:adpexzg3FUZAk,admin,ksql-user\n+```\n+\n+JAAS config file (`jaas_config.file`):\n+```java\n+KsqlServer-Props {\n+  org.eclipse.jetty.jaas.spi.PropertyFileLoginModule required\n+  file=\"/path/to/password-file\"\n+  debug=\"false\";\n+};\n+```\n+\n+ksqlDB settings:\n+```properties\n+authentication.method=BASIC\n+authentication.realm=KsqlServer-Props\n+authentication.roles=admin\n+```\n+\n+The ksqlDB server authenticates users `fred`, `harry`, `tom`, and `dick` based on the\n+user and password credentials found in the password file. But only `fred` and `dick` will", "originalCommit": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAzMjY1Nw==", "url": "https://github.com/confluentinc/ksql/pull/6272#discussion_r493032657", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            be authorized to access the server because they're under the `admin` role.\n          \n          \n            \n            authorized to access the server because they're under the `admin` role.", "author": "JimGalasyn", "createdAt": "2020-09-22T21:04:16Z", "path": "docs/operate-and-deploy/installation/server-config/security.md", "diffHunk": "@@ -287,7 +248,86 @@ CRYPT:frd5btY/mvXo6\n ```\n \n Where each line of the output is the password encrypted using different\n-mechanisms, starting with plain text.\n+mechanisms, starting with plain text. Copy any of the password encrypted\n+lines onto the password file.\n+\n+The roles names are defined next to the encrypted password. These\n+are used by the `LoginModule` to map users to roles.\n+\n+Here's an example of the password file:\n+\n+```\n+fred: OBF:1w8t1tvf1w261w8v1w1c1tvn1w8x,user,admin\n+harry: changeme,user,developer\n+tom: MD5:164c88b302622e17050af52c89945d44,user\n+dick: CRYPT:adpexzg3FUZAk,admin,ksql-user\n+```\n+\n+### Configure the ksqlDB server settings\n+\n+Use the following settings in the `ksql-server.properties` file:\n+\n+```properties\n+authentication.method=BASIC\n+authentication.realm=<KsqlServer-Props-in-jaas_config.file>\n+authentication.roles=<user-role1>,<user-role2>,...\n+```\n+\n+The `authentication.method` specifies ksqlDB to authenticate users using `BASIC`\n+user and password credentials.\n+\n+The `authentication.realm` config must match a section within\n+`jaas_config.file`, which provides the login module for authentication.\n+\n+In this example, the `authentication.realm` config is set to the `KsqlServer-Props`, which\n+was defined in the previous section:\n+\n+```properties\n+authentication.realm=KsqlServer-Props\n+```\n+\n+The `authentication.roles` config defines a comma-separated list of user\n+roles with access to the ksqlDB server. To be authorized to use the ksqlDB Server,\n+an authenticated user must belong to at least one of these roles.\n+\n+For example, if you define `admin` and `developer` roles, ksqlDB will allow access to only users that contain these roles\n+(see configuration for the password file under the `jaas_config.file` section).\n+\n+```properties\n+authentication.roles=admin,developer\n+```\n+\n+Note. You can authorize any role by setting the `authentication.roles` to `**`.\n+\n+###  Example\n+\n+Password file:\n+```\n+fred: OBF:1w8t1tvf1w261w8v1w1c1tvn1w8x,user,admin\n+harry: changeme,user,developer\n+tom: MD5:164c88b302622e17050af52c89945d44,user\n+dick: CRYPT:adpexzg3FUZAk,admin,ksql-user\n+```\n+\n+JAAS config file (`jaas_config.file`):\n+```java\n+KsqlServer-Props {\n+  org.eclipse.jetty.jaas.spi.PropertyFileLoginModule required\n+  file=\"/path/to/password-file\"\n+  debug=\"false\";\n+};\n+```\n+\n+ksqlDB settings:\n+```properties\n+authentication.method=BASIC\n+authentication.realm=KsqlServer-Props\n+authentication.roles=admin\n+```\n+\n+The ksqlDB server authenticates users `fred`, `harry`, `tom`, and `dick` based on the\n+user and password credentials found in the password file. But only `fred` and `dick` will\n+be authorized to access the server because they're under the `admin` role.", "originalCommit": "76e3d0c3f7b7c563145604a6fbf0100136de1c24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "495e2b9caf9c16239f2d39126b258fbbccfcd3c2", "url": "https://github.com/confluentinc/ksql/commit/495e2b9caf9c16239f2d39126b258fbbccfcd3c2", "message": "docs: minor changes based on Jim's feedback\n\nCo-authored-by: Jim Galasyn <jim.galasyn@confluent.io>", "committedDate": "2020-09-23T15:53:08Z", "type": "commit"}]}