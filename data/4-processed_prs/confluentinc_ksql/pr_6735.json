{"pr_number": 6735, "pr_title": "docs: clarify that all data types except maps are supported as keys", "pr_createdAt": "2020-12-08T18:26:19Z", "pr_url": "https://github.com/confluentinc/ksql/pull/6735", "timeline": [{"oid": "e68be39ada6e147657d9c387e29b0c7ed3787874", "url": "https://github.com/confluentinc/ksql/commit/e68be39ada6e147657d9c387e29b0c7ed3787874", "message": "docs: clarify that all data types except maps are supported as keys", "committedDate": "2020-12-08T18:23:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODcwMDE1NQ==", "url": "https://github.com/confluentinc/ksql/pull/6735#discussion_r538700155", "bodyText": "are you sure this is true? I thought there were some assumptions baked in at the ksql layer (not the serde layer) about string keys.", "author": "agavra", "createdAt": "2020-12-08T18:30:57Z", "path": "docs/developer-guide/syntax-reference.md", "diffHunk": "@@ -254,13 +254,17 @@ SELECT ARRAY[s1.colA, s1.colB, s1.colC] FROM s1 EMIT CHANGES;\n MAP<KeyType, ValueType>\n ```\n \n+!!! note\n+    The `MAP` type is only supported for value columns, not key columns, as map keys\n+    may lead to unexpected behavior due to inconsistent serialization.\n+    This restriction includes nested types containing maps as well.\n+\n !!! note\n \t\tThe `DELIMITED` format doesn't support maps.\n \n ksqlDB supports fields that are maps. A map has a key and value type. All\n of the keys must be of the same type, and all of the values must be also\n-be of the same type. Currently only `STRING` keys are supported. The\n-value type can be any valid SQL type.\n+be of the same type.", "originalCommit": "e68be39ada6e147657d9c387e29b0c7ed3787874", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODcwNzg5NQ==", "url": "https://github.com/confluentinc/ksql/pull/6735#discussion_r538707895", "bodyText": "That's funny, the reason I made this change was because I remembered #6182 which removed all the assumptions that were previously baked in at non-serde layers. However. I forgot that the PR didn't actually add support for protobuf maps with non-string keys, even though we in theory could. So ultimately you're right ( for the wrong reason ;) ). I'll put the statement back in.", "author": "vcrfxia", "createdAt": "2020-12-08T18:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODcwMDE1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODcxMDcwMg==", "url": "https://github.com/confluentinc/ksql/pull/6735#discussion_r538710702", "bodyText": "Thanks for the catch!", "author": "vcrfxia", "createdAt": "2020-12-08T18:41:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODcwMDE1NQ=="}], "type": "inlineReview"}, {"oid": "eca191ffa213221d2b6df3b669eab4ec4c671177", "url": "https://github.com/confluentinc/ksql/commit/eca191ffa213221d2b6df3b669eab4ec4c671177", "message": "docs: add back string key restriction", "committedDate": "2020-12-08T18:40:33Z", "type": "commit"}]}