{"pr_number": 12470, "pr_title": "Update SmallRye Reactive Messaging to 2.4.0 and Mutiny to 0.9.0", "pr_createdAt": "2020-10-02T07:50:16Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12470", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg0MTkyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/12470#discussion_r498841921", "bodyText": "As this is being used to retrieve the blocking annotation as well, maybe rename to getAnnotation and change onOverflowAnnotation to onAnnotation?", "author": "kenfinnigan", "createdAt": "2020-10-02T14:03:30Z", "path": "extensions/smallrye-reactive-messaging/deployment/src/main/java/io/quarkus/smallrye/reactivemessaging/deployment/SmallRyeReactiveMessagingProcessor.java", "diffHunk": "@@ -221,27 +201,37 @@ void validateBeanDeployment(\n                                             .getTargetInfo()));\n                 } else {\n                     String channelName = instance.value().asString();\n-                    Optional<AnnotationInstance> overflow = annotationStore.getAnnotations(injectionPoint.getTarget())\n-                            .stream()\n-                            .filter(ai -> ReactiveMessagingDotNames.LEGACY_ON_OVERFLOW\n-                                    .equals(ai.name()))\n-                            .filter(ai -> {\n-                                if (ai.target().kind() == AnnotationTarget.Kind.METHOD_PARAMETER && injectionPoint\n-                                        .isParam()) {\n-                                    return ai.target().asMethodParameter().position() == injectionPoint.getPosition();\n-                                }\n-                                return true;\n-                            })\n-                            .findAny();\n+                    Optional<AnnotationInstance> overflow = getOverflow(annotationStore, injectionPoint,\n+                            ReactiveMessagingDotNames.LEGACY_ON_OVERFLOW);\n \n                     createEmitter(emitters, injectionPoint, channelName, overflow, broadcast);\n                 }\n             }\n         }\n     }\n \n+    private Optional<AnnotationInstance> getOverflow(AnnotationStore annotationStore, InjectionPointInfo injectionPoint,", "originalCommit": "45bd6b444d701883314a34959b64b25582d9c884", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg2NTE5MQ==", "url": "https://github.com/quarkusio/quarkus/pull/12470#discussion_r498865191", "bodyText": "Fixed and rebased.", "author": "cescoffier", "createdAt": "2020-10-02T14:42:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg0MTkyMQ=="}], "type": "inlineReview"}, {"oid": "624f82cb254b98ab65866f60881d851b2b0d28d4", "url": "https://github.com/quarkusio/quarkus/commit/624f82cb254b98ab65866f60881d851b2b0d28d4", "message": "Update SmallRye Reactive Messaging to version 2.4.0", "committedDate": "2020-10-02T14:35:53Z", "type": "commit"}, {"oid": "79f6d82eb184117cf976654d800f9d3fc7a79021", "url": "https://github.com/quarkusio/quarkus/commit/79f6d82eb184117cf976654d800f9d3fc7a79021", "message": "Integrate the expected payload type extraction", "committedDate": "2020-10-02T14:35:56Z", "type": "commit"}, {"oid": "3598333e0dade31d6ee725f488b0b9695ce9f9e8", "url": "https://github.com/quarkusio/quarkus/commit/3598333e0dade31d6ee725f488b0b9695ce9f9e8", "message": "Move all emitter and channel tests in a dedicated package", "committedDate": "2020-10-02T14:35:56Z", "type": "commit"}, {"oid": "62d0df3f7d78b4452b1ad44fde5a5cfd6b4758cb", "url": "https://github.com/quarkusio/quarkus/commit/62d0df3f7d78b4452b1ad44fde5a5cfd6b4758cb", "message": "Add support for mutiny emitter", "committedDate": "2020-10-02T14:38:20Z", "type": "commit"}, {"oid": "363ac6a1fdf8cda790e60653ff6e42c9574017b5", "url": "https://github.com/quarkusio/quarkus/commit/363ac6a1fdf8cda790e60653ff6e42c9574017b5", "message": "Implement converter support", "committedDate": "2020-10-02T14:38:22Z", "type": "commit"}, {"oid": "6d1b4d7b637d949725b69a5efff7a1685117a6e5", "url": "https://github.com/quarkusio/quarkus/commit/6d1b4d7b637d949725b69a5efff7a1685117a6e5", "message": "Integrate the update of the MutinyEmitter API", "committedDate": "2020-10-02T14:38:22Z", "type": "commit"}, {"oid": "ab8ba2627c05bbe1f7be5048cb5e3bcd8cbc330d", "url": "https://github.com/quarkusio/quarkus/commit/ab8ba2627c05bbe1f7be5048cb5e3bcd8cbc330d", "message": "Update Mutiny to 0.9.0 (performance fix)", "committedDate": "2020-10-02T14:38:22Z", "type": "commit"}, {"oid": "ab8ba2627c05bbe1f7be5048cb5e3bcd8cbc330d", "url": "https://github.com/quarkusio/quarkus/commit/ab8ba2627c05bbe1f7be5048cb5e3bcd8cbc330d", "message": "Update Mutiny to 0.9.0 (performance fix)", "committedDate": "2020-10-02T14:38:22Z", "type": "forcePushed"}]}