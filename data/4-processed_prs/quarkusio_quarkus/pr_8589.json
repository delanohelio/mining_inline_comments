{"pr_number": 8589, "pr_title": "Fail the build if multiple container-image extensions are available", "pr_createdAt": "2020-04-15T11:52:37Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/8589", "timeline": [{"oid": "346074f5c6d150ff5e4c082f9abf52fe3cd74ed5", "url": "https://github.com/quarkusio/quarkus/commit/346074f5c6d150ff5e4c082f9abf52fe3cd74ed5", "message": "Introduce QuarkusProdTest module for container-image tests and add test for multiple container-image extensions", "committedDate": "2020-04-15T11:56:09Z", "type": "forcePushed"}, {"oid": "c7b1960534de8ec131ca209d92e2d0c282e7d2a9", "url": "https://github.com/quarkusio/quarkus/commit/c7b1960534de8ec131ca209d92e2d0c282e7d2a9", "message": "Introduce QuarkusProdTest module for container-image tests and add test for multiple container-image extensions", "committedDate": "2020-04-15T11:58:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgwNzAxNA==", "url": "https://github.com/quarkusio/quarkus/pull/8589#discussion_r408807014", "bodyText": "I don't like standard name. Can be more descriptive name picked?", "author": "rsvoboda", "createdAt": "2020-04-15T12:35:24Z", "path": "integration-tests/container-image/pom.xml", "diffHunk": "@@ -7,91 +7,13 @@\n     <artifactId>quarkus-integration-tests-parent</artifactId>\n     <version>999-SNAPSHOT</version>\n   </parent>\n-  <artifactId>quarkus-integration-test-container-image</artifactId>\n-  <name>Quarkus - Integration Tests - Container Image</name>\n-  <properties>\n-    <skipTests>true</skipTests>\n-  </properties>\n-  <dependencyManagement>\n-    <dependencies>\n-      <dependency>\n-        <groupId>com.google.j2objc</groupId>\n-        <artifactId>j2objc-annotations</artifactId>\n-        <version>1.3</version>\n-      </dependency>\n-    </dependencies>\n-  </dependencyManagement>\n-  <dependencies>\n-    <dependency>\n-      <groupId>io.quarkus</groupId>\n-      <artifactId>quarkus-core-deployment</artifactId>\n-      <scope>test</scope>\n-    </dependency>\n-    <dependency>\n-      <groupId>io.quarkus</groupId>\n-      <artifactId>quarkus-test-maven</artifactId>\n-      <scope>test</scope>\n-    </dependency>\n-  </dependencies>\n-  <build>\n-    <testResources>\n-      <testResource>\n-        <directory>src/it</directory>\n-        <filtering>true</filtering>\n-      </testResource>\n-    </testResources>\n-    <plugins>\n-      <plugin>\n-        <artifactId>maven-invoker-plugin</artifactId>\n-        <version>3.1.0</version>\n-        <executions>\n-          <execution>\n-            <id>integration-tests</id>\n-            <goals>\n-              <goal>install</goal>\n-              <goal>run</goal>\n-              <goal>verify</goal>\n-            </goals>\n-          </execution>\n-        </executions>\n-        <configuration>\n-          <cloneProjectsTo>${project.build.directory}/it</cloneProjectsTo>\n-          <cloneClean>true</cloneClean>\n-          <postBuildHookScript>verify</postBuildHookScript>\n-          <addTestClassPath>true</addTestClassPath>\n-          <skipInvocation>${skipTests}</skipInvocation>\n-          <streamLogs>true</streamLogs>\n-          <invokerPropertiesFile>invoker.properties</invokerPropertiesFile>\n-        </configuration>\n-      </plugin>\n-      <plugin>\n-        <artifactId>maven-failsafe-plugin</artifactId>\n-        <executions>\n-          <execution>\n-            <goals>\n-              <goal>integration-test</goal>\n-              <goal>verify</goal>\n-            </goals>\n-          </execution>\n-        </executions>\n-      </plugin>\n-    </plugins>\n-  </build>\n \n-  <profiles>\n-    <profile>\n-      <id>container-image-docker</id>\n-      <activation>\n-        <property>\n-          <name>docker</name>\n-        </property>\n-        <os>\n-          <family>linux</family>\n-        </os>\n-      </activation>\n-      <properties>\n-        <skipTests>false</skipTests>\n-      </properties>\n-    </profile>\n-  </profiles>\n+  <artifactId>quarkus-integration-test-container-image-parent</artifactId>\n+  <name>Quarkus - Integration Tests - Container Image - Parent</name>\n+  <packaging>pom</packaging>\n+\n+  <modules>\n+    <module>invoker</module>\n+    <module>standard</module>", "originalCommit": "c7b1960534de8ec131ca209d92e2d0c282e7d2a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgwODQyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/8589#discussion_r408808421", "bodyText": "Do you have a suggestion? I suck horribly at naming.\nFWIW we already use that name in kubernetes tests.", "author": "geoand", "createdAt": "2020-04-15T12:37:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgwNzAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgxODE4MQ==", "url": "https://github.com/quarkusio/quarkus/pull/8589#discussion_r408818181", "bodyText": "so there is maven-invoker way and standard Quarkus way of working with container-image\nwhat about:\n\ninvoker => maven-invoker-way\nstandard => quarkus-standard-way\n?", "author": "rsvoboda", "createdAt": "2020-04-15T12:53:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgwNzAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgyOTM4NA==", "url": "https://github.com/quarkusio/quarkus/pull/8589#discussion_r408829384", "bodyText": "I don't particularly like way in there TBH. @gsmet any good suggestions here?", "author": "geoand", "createdAt": "2020-04-15T13:11:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgwNzAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTEzNjU0Mw==", "url": "https://github.com/quarkusio/quarkus/pull/8589#discussion_r409136543", "bodyText": "I couldn't come up with anything better, so I went with your suggestion.", "author": "geoand", "createdAt": "2020-04-15T21:11:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgwNzAxNA=="}], "type": "inlineReview"}, {"oid": "2cfa7a5605229167fc6480785023b19459f62127", "url": "https://github.com/quarkusio/quarkus/commit/2cfa7a5605229167fc6480785023b19459f62127", "message": "Introduce QuarkusProdTest module for container-image tests and add test for multiple container-image extensions", "committedDate": "2020-04-15T13:09:43Z", "type": "forcePushed"}, {"oid": "b7f6d5b50e154ca7514fc3098f7a8dc1317ff4bd", "url": "https://github.com/quarkusio/quarkus/commit/b7f6d5b50e154ca7514fc3098f7a8dc1317ff4bd", "message": "Add exception assertion capability to prod mode test", "committedDate": "2020-04-15T21:11:26Z", "type": "commit"}, {"oid": "274b6f5c454c5baed6d4aa8c6c59edadb6ca181e", "url": "https://github.com/quarkusio/quarkus/commit/274b6f5c454c5baed6d4aa8c6c59edadb6ca181e", "message": "Fail the build if multiple container-image extensions are available\n\nFixes: #8584", "committedDate": "2020-04-15T21:11:26Z", "type": "commit"}, {"oid": "0a2b90201ee80c21f7e48af14a5e1c4120284738", "url": "https://github.com/quarkusio/quarkus/commit/0a2b90201ee80c21f7e48af14a5e1c4120284738", "message": "Introduce QuarkusProdTest module for container-image tests and add test for multiple container-image extensions", "committedDate": "2020-04-15T21:11:26Z", "type": "commit"}, {"oid": "9fbfbc9cac92654dd04ccce5d4cc0842aa6faa02", "url": "https://github.com/quarkusio/quarkus/commit/9fbfbc9cac92654dd04ccce5d4cc0842aa6faa02", "message": "Rename kubernetes test modules to match naming in container-image tests", "committedDate": "2020-04-15T21:11:26Z", "type": "commit"}, {"oid": "9fbfbc9cac92654dd04ccce5d4cc0842aa6faa02", "url": "https://github.com/quarkusio/quarkus/commit/9fbfbc9cac92654dd04ccce5d4cc0842aa6faa02", "message": "Rename kubernetes test modules to match naming in container-image tests", "committedDate": "2020-04-15T21:11:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM2ODM0OQ==", "url": "https://github.com/quarkusio/quarkus/pull/8589#discussion_r409368349", "bodyText": "Do we need to also intercept AfterAll / AfterEach? And all the other methods :-)", "author": "Ladicek", "createdAt": "2020-04-16T08:17:48Z", "path": "test-framework/junit5-internal/src/main/java/io/quarkus/test/QuarkusProdModeTest.java", "diffHunk": "@@ -408,6 +454,32 @@ private void ensureApplicationStartupOrFailure() throws IOException {\n         }\n     }\n \n+    @Override\n+    public void interceptBeforeAllMethod(Invocation<Void> invocation, ReflectiveInvocationContext<Method> invocationContext,\n+            ExtensionContext extensionContext) throws Throwable {\n+        doIntercept(invocation);\n+    }\n+\n+    @Override\n+    public void interceptBeforeEachMethod(Invocation<Void> invocation, ReflectiveInvocationContext<Method> invocationContext,\n+            ExtensionContext extensionContext) throws Throwable {\n+        doIntercept(invocation);\n+    }\n+\n+    @Override\n+    public void interceptTestMethod(Invocation<Void> invocation, ReflectiveInvocationContext<Method> invocationContext,\n+            ExtensionContext extensionContext) throws Throwable {\n+        doIntercept(invocation);\n+    }", "originalCommit": "9fbfbc9cac92654dd04ccce5d4cc0842aa6faa02", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM2OTQ4Nw==", "url": "https://github.com/quarkusio/quarkus/pull/8589#discussion_r409369487", "bodyText": "There might will be situations were we have to, but they are unlikely to ever come up with this kind of internal test (hopefully \ud83d\ude06).\nI say we leave it as is for now and fix if it ever comes up.", "author": "geoand", "createdAt": "2020-04-16T08:19:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM2ODM0OQ=="}], "type": "inlineReview"}]}