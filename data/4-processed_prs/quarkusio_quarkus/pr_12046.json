{"pr_number": 12046, "pr_title": "Handle gradle included-builds in quarkusDev task", "pr_createdAt": "2020-09-11T12:34:29Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12046", "timeline": [{"oid": "298070ae63d97163ed4c80ae336465834c68500d", "url": "https://github.com/quarkusio/quarkus/commit/298070ae63d97163ed4c80ae336465834c68500d", "message": "handle gradle included builds", "committedDate": "2020-09-16T08:57:53Z", "type": "forcePushed"}, {"oid": "c98fbaa6392212b199b8bac912d072022a621bb2", "url": "https://github.com/quarkusio/quarkus/commit/c98fbaa6392212b199b8bac912d072022a621bb2", "message": "handle gradle included builds", "committedDate": "2020-09-16T12:00:10Z", "type": "forcePushed"}, {"oid": "ebea2112712144f60d66e98b822035b48a4efd4a", "url": "https://github.com/quarkusio/quarkus/commit/ebea2112712144f60d66e98b822035b48a4efd4a", "message": "add some debug for failed tests", "committedDate": "2020-09-23T13:42:14Z", "type": "forcePushed"}, {"oid": "1292f8dcf7b0bc12f8be6792ebe941712039361b", "url": "https://github.com/quarkusio/quarkus/commit/1292f8dcf7b0bc12f8be6792ebe941712039361b", "message": "handle gradle included builds", "committedDate": "2020-11-12T11:12:01Z", "type": "forcePushed"}, {"oid": "4ae2ed90731e57f4a8b02c6a0e6b0285bd036029", "url": "https://github.com/quarkusio/quarkus/commit/4ae2ed90731e57f4a8b02c6a0e6b0285bd036029", "message": "handle gradle included builds", "committedDate": "2021-02-11T21:09:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg0OTMxNQ==", "url": "https://github.com/quarkusio/quarkus/pull/12046#discussion_r574849315", "bodyText": "Couldn't this be replaced with project.getGradle().includedBuild(name)?", "author": "aloubyansky", "createdAt": "2021-02-11T21:47:14Z", "path": "devtools/gradle/src/main/java/io/quarkus/gradle/builder/QuarkusModelBuilder.java", "diffHunk": "@@ -331,9 +337,14 @@ private void collectDependencies(ResolvedConfiguration configuration,\n             final DependencyImpl dep = initDependency(a);\n             if (LaunchMode.DEVELOPMENT.equals(mode) &&\n                     a.getId().getComponentIdentifier() instanceof ProjectComponentIdentifier) {\n-                Project projectDep = project.getRootProject()\n-                        .findProject(((ProjectComponentIdentifier) a.getId().getComponentIdentifier()).getProjectPath());\n-                addDevModePaths(dep, a, projectDep);\n+                Optional<IncludedBuild> includedBuild = includedBuild(project, a.getName());", "originalCommit": "4ae2ed90731e57f4a8b02c6a0e6b0285bd036029", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTEyNzI4MQ==", "url": "https://github.com/quarkusio/quarkus/pull/12046#discussion_r575127281", "bodyText": "yes, I just wrapped that in a try/catch because project.getGradle().includedBuild(name) throws an exception if the project is not an included build.", "author": "glefloch", "createdAt": "2021-02-12T10:32:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg0OTMxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg1MDM2Mg==", "url": "https://github.com/quarkusio/quarkus/pull/12046#discussion_r574850362", "bodyText": "Just curious, have you tried to measure how long this method takes to execute? Is it seconds?", "author": "aloubyansky", "createdAt": "2021-02-11T21:49:00Z", "path": "devtools/gradle/src/main/java/io/quarkus/gradle/builder/QuarkusModelBuilder.java", "diffHunk": "@@ -402,6 +413,25 @@ private void addDevModePaths(final DependencyImpl dep, ResolvedArtifact a, Proje\n         }\n     }\n \n+    private void addSubstitutedProject(final DependencyImpl dep, File projectFile, LaunchMode mode) {", "originalCommit": "4ae2ed90731e57f4a8b02c6a0e6b0285bd036029", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTEyNzYyMg==", "url": "https://github.com/quarkusio/quarkus/pull/12046#discussion_r575127622", "bodyText": "I just ran some really basics benchmarks, it takes 2 to 4 seconds..", "author": "glefloch", "createdAt": "2021-02-12T10:32:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg1MDM2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTUwOTA3Mw==", "url": "https://github.com/quarkusio/quarkus/pull/12046#discussion_r575509073", "bodyText": "Sorry, do you mind not using Optional in this case? Making includeBuild return boolean will make it look simpler and perform better.", "author": "aloubyansky", "createdAt": "2021-02-12T20:43:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg1MDM2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTUyMjY3NA==", "url": "https://github.com/quarkusio/quarkus/pull/12046#discussion_r575522674", "bodyText": "Oh yes for sure. I'm trying to understand why the test fails in ci and passes on my machine. I will remove the optional once everything is ok.", "author": "glefloch", "createdAt": "2021-02-12T21:13:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg1MDM2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3Njg2NjQ2Nw==", "url": "https://github.com/quarkusio/quarkus/pull/12046#discussion_r576866467", "bodyText": "I just ran some really basics benchmarks, it takes 2 to 4 seconds..\n\nJust to clarify, was it a restart/reload that was taking 2 to 4 seconds in dev mode?", "author": "aloubyansky", "createdAt": "2021-02-16T14:31:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg1MDM2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3Njg3MzY3MA==", "url": "https://github.com/quarkusio/quarkus/pull/12046#discussion_r576873670", "bodyText": "It's for the first quarkusDev start. Reload is not impacted, and thanks to daemons/caches, next restart are not really impacted.", "author": "glefloch", "createdAt": "2021-02-16T14:41:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg1MDM2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjkwODA2Mg==", "url": "https://github.com/quarkusio/quarkus/pull/12046#discussion_r576908062", "bodyText": "Right, that's good. Thanks!", "author": "aloubyansky", "createdAt": "2021-02-16T15:24:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg1MDM2Mg=="}], "type": "inlineReview"}, {"oid": "d06042e06e18e6472d4fa2e11af551756f36639a", "url": "https://github.com/quarkusio/quarkus/commit/d06042e06e18e6472d4fa2e11af551756f36639a", "message": "handle gradle included builds", "committedDate": "2021-02-12T10:31:06Z", "type": "forcePushed"}, {"oid": "4f224826f20ff1307baacb7865d1c756a23efc0a", "url": "https://github.com/quarkusio/quarkus/commit/4f224826f20ff1307baacb7865d1c756a23efc0a", "message": "handle gradle included builds", "committedDate": "2021-02-16T12:47:46Z", "type": "commit"}, {"oid": "4f224826f20ff1307baacb7865d1c756a23efc0a", "url": "https://github.com/quarkusio/quarkus/commit/4f224826f20ff1307baacb7865d1c756a23efc0a", "message": "handle gradle included builds", "committedDate": "2021-02-16T12:47:46Z", "type": "forcePushed"}]}