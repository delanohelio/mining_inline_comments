{"pr_number": 13053, "pr_title": "Hibernate ORM 5.4.23 and Hibernate Reactive 1.0.0.Alpha11", "pr_createdAt": "2020-11-01T22:51:28Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/13053", "timeline": [{"oid": "247df9cc01edc4618cc395a200eb75cdde3fc323", "url": "https://github.com/quarkusio/quarkus/commit/247df9cc01edc4618cc395a200eb75cdde3fc323", "message": "Upgrade to Hibernate Reactive 1.0.0.Alpha11", "committedDate": "2020-11-02T10:09:36Z", "type": "forcePushed"}, {"oid": "e810bf0f5fd5b2d9bc070be9d01ac49841df1e5a", "url": "https://github.com/quarkusio/quarkus/commit/e810bf0f5fd5b2d9bc070be9d01ac49841df1e5a", "message": "Upgrade to Hibernate Reactive 1.0.0.Alpha11", "committedDate": "2020-11-02T14:52:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE1MzQzNA==", "url": "https://github.com/quarkusio/quarkus/pull/13053#discussion_r516153434", "bodyText": "We should maybe rename the method to popRecordedState or something similar? So that consumers know what they are doing?", "author": "gsmet", "createdAt": "2020-11-02T17:51:19Z", "path": "extensions/hibernate-orm/runtime/src/main/java/io/quarkus/hibernate/orm/runtime/PersistenceUnitsHolder.java", "diffHunk": "@@ -54,7 +54,7 @@ public static RecordedState getRecordedState(String persistenceUnitName) {\n         if (persistenceUnitName == null) {\n             key = NO_NAME_TOKEN;\n         }\n-        return persistenceUnits.recordedStates.get(key);\n+        return persistenceUnits.recordedStates.remove(key);", "originalCommit": "f6075e2df4220bd6496c9d3d26baa8256581d72c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE1OTE0OQ==", "url": "https://github.com/quarkusio/quarkus/pull/13053#discussion_r516159149", "bodyText": "ok good point.", "author": "Sanne", "createdAt": "2020-11-02T18:00:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE1MzQzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE2ODM3Mw==", "url": "https://github.com/quarkusio/quarkus/pull/13053#discussion_r516168373", "bodyText": "OK, then, if we can just adjust the method name in this commit, we can merge.", "author": "gsmet", "createdAt": "2020-11-02T18:17:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE1MzQzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE1NzcyMw==", "url": "https://github.com/quarkusio/quarkus/pull/13053#discussion_r516157723", "bodyText": "I'm not sure these will be included in the native image? Given it's a runtime class, I suppose it can be called at runtime?\nFor JAXB, I had to add this: https://github.com/quarkusio/quarkus/blob/master/extensions/jaxb/deployment/src/main/java/io/quarkus/jaxb/deployment/JaxbProcessor.java#L152 .\nI don't know if you're having this new method for a similar purpose.", "author": "gsmet", "createdAt": "2020-11-02T17:58:39Z", "path": "extensions/hibernate-orm/runtime/src/main/java/io/quarkus/hibernate/orm/runtime/service/FlatClassLoaderService.java", "diffHunk": "@@ -98,6 +98,20 @@ public InputStream locateResourceStream(String name) {\n         throw new AssertionFailure(\"Not implemented! generateProxy(InvocationHandler handler, Class... interfaces)\");\n     }\n \n+    @Override\n+    public Package packageForNameOrNull(String packageName) {\n+        try {\n+            Class<?> aClass = Class.forName(packageName + \".package-info\", false, getClassLoader());", "originalCommit": "d7aa8967e26b90b3acf68b744120e59da6bce0bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE2MDMxMw==", "url": "https://github.com/quarkusio/quarkus/pull/13053#discussion_r516160313", "bodyText": "No we don't need to access these at runtime, the purpose is for package-level annotations to be discoverable during metadata scanning when not using Jandex. I even doubt it's at all useful for Quarkus.\nTo be clear, this is code that previously was handled by HCANN, I moved the responsibility to the ClassLoaderService - this method is just doing exactly the same as it was done before.", "author": "Sanne", "createdAt": "2020-11-02T18:03:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE1NzcyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE2NzY4Mg==", "url": "https://github.com/quarkusio/quarkus/pull/13053#discussion_r516167682", "bodyText": "OK, if it's used when we build the metadata at build time, it's all good.", "author": "gsmet", "createdAt": "2020-11-02T18:16:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE1NzcyMw=="}], "type": "inlineReview"}, {"oid": "eedf3007de8580ff1af784f90e40cf4e57eb16f7", "url": "https://github.com/quarkusio/quarkus/commit/eedf3007de8580ff1af784f90e40cf4e57eb16f7", "message": "Release references to PU metadata after it was booted", "committedDate": "2020-11-02T18:38:37Z", "type": "commit"}, {"oid": "b5c5dbdd0a7dfc2fe12ae6ee960f4fc8f802fbac", "url": "https://github.com/quarkusio/quarkus/commit/b5c5dbdd0a7dfc2fe12ae6ee960f4fc8f802fbac", "message": "Use the correct ASM API version constant: the one from the ASM version used by Gizmo", "committedDate": "2020-11-02T18:38:37Z", "type": "commit"}, {"oid": "8cb5780b18e1abb2b27c2b382b7d5b215880be1d", "url": "https://github.com/quarkusio/quarkus/commit/8cb5780b18e1abb2b27c2b382b7d5b215880be1d", "message": "Release the Hibernate ORM metadata caches before recording its state", "committedDate": "2020-11-02T18:38:37Z", "type": "commit"}, {"oid": "c167010684b562649f41a3262148c6af3bb8a5d5", "url": "https://github.com/quarkusio/quarkus/commit/c167010684b562649f41a3262148c6af3bb8a5d5", "message": "Upgrade to Hibernate ORM 5.4.23.Final", "committedDate": "2020-11-02T18:38:37Z", "type": "commit"}, {"oid": "2527225632bd5bb547320e48348a90e93ec93136", "url": "https://github.com/quarkusio/quarkus/commit/2527225632bd5bb547320e48348a90e93ec93136", "message": "Upgrade to Hibernate Reactive 1.0.0.Alpha11", "committedDate": "2020-11-02T18:38:37Z", "type": "commit"}, {"oid": "2527225632bd5bb547320e48348a90e93ec93136", "url": "https://github.com/quarkusio/quarkus/commit/2527225632bd5bb547320e48348a90e93ec93136", "message": "Upgrade to Hibernate Reactive 1.0.0.Alpha11", "committedDate": "2020-11-02T18:38:37Z", "type": "forcePushed"}]}