{"pr_number": 12288, "pr_title": "Kubernetes hostAliases property", "pr_createdAt": "2020-09-23T11:24:48Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12288", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg1MDI5OA==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r493850298", "bodyText": "Is there a link to the Kubernetes documentation where one could see more info?", "author": "geoand", "createdAt": "2020-09-23T19:41:55Z", "path": "docs/src/main/asciidoc/deploying-to-kubernetes.adoc", "diffHunk": "@@ -441,6 +441,42 @@ quarkus.kubernetes.readiness-probe.initial-delay=20s\n quarkus.kubernetes.readiness-probe.period=45s\n ----\n \n+=== Add hostAliases\n+To add entries to a Pod's `/etc/hosts` file, just apply the following configuration:", "originalCommit": "9f4ee8fcebbd60d8c3f2834a19562f6b13ecf7f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg5NTc0OA==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r493895748", "bodyText": "Done.", "author": "Vinche59", "createdAt": "2020-09-23T21:07:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg1MDI5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg1MDc1NA==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r493850754", "bodyText": "If this is going to contain multiple values, why not make it a List?", "author": "geoand", "createdAt": "2020-09-23T19:42:46Z", "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/HostAliasConfig.java", "diffHunk": "@@ -0,0 +1,28 @@\n+\n+package io.quarkus.kubernetes.deployment;\n+\n+import java.util.Optional;\n+\n+import io.quarkus.runtime.annotations.ConfigGroup;\n+import io.quarkus.runtime.annotations.ConfigItem;\n+\n+@ConfigGroup\n+public class HostAliasConfig {\n+\n+    /**\n+     * The ip address\n+     *\n+     * @return The ip.\n+     */\n+    @ConfigItem\n+    Optional<String> ip;\n+\n+    /**\n+     * The hostnames (comma separated) to resolve to the ip\n+     *\n+     * @return The path.\n+     */\n+    @ConfigItem\n+    Optional<String> hostnames;", "originalCommit": "9f4ee8fcebbd60d8c3f2834a19562f6b13ecf7f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg5NjMwMw==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r493896303", "bodyText": "True...\nDone", "author": "Vinche59", "createdAt": "2020-09-23T21:08:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg1MDc1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzMzMyNQ==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r494033325", "bodyText": "Small nitpick: you don't need to mention comma separated anymore", "author": "geoand", "createdAt": "2020-09-24T04:36:03Z", "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/HostAliasConfig.java", "diffHunk": "@@ -0,0 +1,28 @@\n+\n+package io.quarkus.kubernetes.deployment;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import io.quarkus.runtime.annotations.ConfigGroup;\n+import io.quarkus.runtime.annotations.ConfigItem;\n+\n+@ConfigGroup\n+public class HostAliasConfig {\n+\n+    /**\n+     * The ip address\n+     *\n+     * @return The ip.\n+     */\n+    @ConfigItem\n+    Optional<String> ip;\n+\n+    /**\n+     * The hostnames (comma separated) to resolve to the ip", "originalCommit": "7363b22baa33408fede9f6d715ab00a4546716e3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzMzYwMw==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r494033603", "bodyText": "This doesn't apply anymore.", "author": "geoand", "createdAt": "2020-09-24T04:37:19Z", "path": "docs/src/main/asciidoc/deploying-to-kubernetes.adoc", "diffHunk": "@@ -441,6 +441,42 @@ quarkus.kubernetes.readiness-probe.initial-delay=20s\n quarkus.kubernetes.readiness-probe.period=45s\n ----\n \n+=== Add hostAliases\n+To add entries to a Pod's `/etc/hosts` file (more information can be found in https://kubernetes.io/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/[Kubernetes documentation]), just apply the following configuration:\n+\n+[source]\n+----\n+quarkus.kubernetes.host-aliases.\"10.0.0.0\".hostnames=foo.com\n+----\n+\n+This would generate the following section in the deployment descriptor:\n+\n+[source,yaml]\n+----\n+hostAliases:\n+- hostnames:\n+  - foo.com\n+  ip: 10.0.0.0\n+----\n+\n+To define multiple hostnames for the same ip address, just provide a list of hostnames separated by a comma (`,`):", "originalCommit": "7363b22baa33408fede9f6d715ab00a4546716e3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzMzkxOQ==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r494033919", "bodyText": "This is misleading, no?\nIt doesn't show the quarkus or the kubernetes group.\nFurthermore, I am pretty sure it's host-aliases, right?", "author": "geoand", "createdAt": "2020-09-24T04:38:47Z", "path": "docs/src/main/asciidoc/deploying-to-kubernetes.adoc", "diffHunk": "@@ -441,6 +441,42 @@ quarkus.kubernetes.readiness-probe.initial-delay=20s\n quarkus.kubernetes.readiness-probe.period=45s\n ----\n \n+=== Add hostAliases\n+To add entries to a Pod's `/etc/hosts` file (more information can be found in https://kubernetes.io/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/[Kubernetes documentation]), just apply the following configuration:\n+\n+[source]\n+----\n+quarkus.kubernetes.host-aliases.\"10.0.0.0\".hostnames=foo.com\n+----\n+\n+This would generate the following section in the deployment descriptor:\n+\n+[source,yaml]\n+----\n+hostAliases:", "originalCommit": "7363b22baa33408fede9f6d715ab00a4546716e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE0NDIzNg==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r494144236", "bodyText": "Actually, the kubernetes directive is : hostAliases\nI renamed quarkus config name to match it, it was indeed misleading here ;-)", "author": "Vinche59", "createdAt": "2020-09-24T08:45:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzMzkxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE0NzM0Nw==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r494147347", "bodyText": "What I mean is that the Quarkus configuration would be\nquarkus:\n   kubernetes:\n     host-alieases:\n     ....\n(as you have already speciified in the properties version)", "author": "geoand", "createdAt": "2020-09-24T08:50:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzMzkxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE2MjgyMA==", "url": "https://github.com/quarkusio/quarkus/pull/12288#discussion_r494162820", "bodyText": "Ok I understand.\nWhat I wanted to show here in the doc is actually an excerpt of the generated kubernetes.yaml file.\nIs more clear like this :\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            hostAliases:\n          \n          \n            \n            This would generate the following `hostAliases` section in the `deployment` definition:\n          \n          \n            \n            \n          \n          \n            \n            [source,yaml]\n          \n          \n            \n            ----\n          \n          \n            \n            kind: Deployment\n          \n          \n            \n            spec:\n          \n          \n            \n              template:\n          \n          \n            \n                spec:\n          \n          \n            \n                  hostAliases:\n          \n          \n            \n                  - hostnames:\n          \n          \n            \n                    - foo.com\n          \n          \n            \n                    - bar.org\n          \n          \n            \n                    ip: 10.0.0.0\n          \n          \n            \n            ----", "author": "Vinche59", "createdAt": "2020-09-24T09:15:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAzMzkxOQ=="}], "type": "inlineReview"}, {"oid": "cfb65fde0694748fde230667c6cb091ad23526c6", "url": "https://github.com/quarkusio/quarkus/commit/cfb65fde0694748fde230667c6cb091ad23526c6", "message": "Kubernetes hostAliases property\n\nAdd the possibility to generate hostAliases properties in Kubernetes deployment\n\nSigned-off-by: Vincent Sourtin <sourin-v@bridgestone-bae.com>", "committedDate": "2020-09-24T09:12:50Z", "type": "commit"}]}