{"pr_number": 7361, "pr_title": "Document how to protect routes in Quarkus", "pr_createdAt": "2020-02-22T17:26:19Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7361", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzMjU5MA==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r382932590", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To configure the protected routes using the `application.properties file`, check the link:security-openid-connect-web-authentication[Protecting Web Applications Using OpenID Connect] tutorial. For more details, check the link:security[Security Guide].\n          \n          \n            \n            To configure the protected routes using the `application.properties` file, check the link:security-openid-connect-web-authentication[Protecting Web Applications Using OpenID Connect] guide. For more details, check the link:security[Security guide].", "author": "gsmet", "createdAt": "2020-02-22T18:42:20Z", "path": "docs/src/main/asciidoc/security-keycloak-authorization.adoc", "diffHunk": "@@ -169,6 +169,12 @@ quarkus.keycloak.policy-enforcer.enable=true\n \n NOTE: By default, applications using the `quarkus-oidc` extension are marked as a `service` type application (see `quarkus.oidc.application-type`). This extension currently supports only such `service` type applications.\n \n+=== Configuring protected routes\n+\n+In the default configuration, Keycloak is responsible for managing the roles and deciding who can access which routes. \n+\n+To configure the protected routes using the `application.properties file`, check the link:security-openid-connect-web-authentication[Protecting Web Applications Using OpenID Connect] tutorial. For more details, check the link:security[Security Guide].", "originalCommit": "91b79c32d1f8c6b1dc69043dab23667a2df6edaf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAxNjEzNQ==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r383016135", "bodyText": "Hi, FYI, quarkus-keycloak-authorization is not activated for the web-app applications which is what this section refers to. Can you please clarify what do you mean when you say the protected routes ?", "author": "sberyozkin", "createdAt": "2020-02-23T15:56:43Z", "path": "docs/src/main/asciidoc/security-keycloak-authorization.adoc", "diffHunk": "@@ -169,6 +169,12 @@ quarkus.keycloak.policy-enforcer.enable=true\n \n NOTE: By default, applications using the `quarkus-oidc` extension are marked as a `service` type application (see `quarkus.oidc.application-type`). This extension currently supports only such `service` type applications.\n \n+=== Configuring protected routes\n+\n+In the default configuration, Keycloak is responsible for managing the roles and deciding who can access which routes. \n+\n+To configure the protected routes using the `application.properties` file, check the link:security-openid-connect-web-authentication[Protecting Web Applications Using OpenID Connect] guide. For more details, check the link:security[Security guide].\n+", "originalCommit": "2938e0ee2d3d92f3e18d327f61ff56c558e72b03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAxNzk1NQ==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r383017955", "bodyText": "the protected routes refers to the URIs such as this one https://github.com/quarkusio/quarkus-quickstarts/blob/1fcd29b58ba3a80bf25ce3f5dab8d02ad0a56226/security-keycloak-authorization-quickstart/config/quarkus-realm.json#L477", "author": "stefnotch", "createdAt": "2020-02-23T16:19:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAxNjEzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAzMjAzMA==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r383032030", "bodyText": "@stefnotch Thanks. I'm sorry but I don't understand the new document addition. quarkus-keycloak-authorization is to support the OIDC service applications only when (as per your PR, Keycloak does the policy-driven authorization). If one has an OIDC web-app application which your PR links to then this quarkus-keycloak-authorization will not be activated.\nThis is why I'm confused about the message of this PR. Perhaps I'm missing the point :-), please clarify. CC @pedroigor\nThanks", "author": "sberyozkin", "createdAt": "2020-02-23T19:35:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAxNjEzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAzMjI1Ng==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r383032256", "bodyText": "@stefnotch Perhaps you meant to link to security-openid-connect ?", "author": "sberyozkin", "createdAt": "2020-02-23T19:38:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAxNjEzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAzNDUzNQ==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r383034535", "bodyText": "I see, I indeed missed quarkus.oidc.application-type=web-app. Thank you for catching it, I'll fix it.", "author": "stefnotch", "createdAt": "2020-02-23T20:10:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAxNjEzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAzNTQwMg==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r383035402", "bodyText": "@stefnotch Thank you :-)", "author": "sberyozkin", "createdAt": "2020-02-23T20:22:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAxNjEzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI3MTExNQ==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r385271115", "bodyText": "Hi @stefnotch I've had another look at this doc snippet, sorry, it is just a few lines, but I have one more proposal on how to change it. At the moment it feels it is out of context as it is placed in a section where the quickstart steps are described, showing how to protect the routes using this extension. Another minor bit is that this extension is also configured in application.properties :-)\nIMHO it will read better if you add a single line pointing to the alternative approach at the very end of the introduction section at the top of the document:\nTo configure the protected routes using the `@RolesAllowed` annotation or Quarkus HTTP security policies, check the link:security-openid-connect[Using OpenID Connect Adapter to Protect JAX-RS Applications] guide and the link:security#authorization-of-web-endpoints-using-configuration[Security guide].\n\nThis way the quickstart solution section will be just about this quickstart.\nThanks", "author": "sberyozkin", "createdAt": "2020-02-27T17:49:26Z", "path": "docs/src/main/asciidoc/security-keycloak-authorization.adoc", "diffHunk": "@@ -169,6 +169,12 @@ quarkus.keycloak.policy-enforcer.enable=true\n \n NOTE: By default, applications using the `quarkus-oidc` extension are marked as a `service` type application (see `quarkus.oidc.application-type`). This extension currently supports only such `service` type applications.\n \n+=== Configuring protected routes", "originalCommit": "e0688f83e059799a383b0a7c2024490f1380d5c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI3NjQ2MA==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r385276460", "bodyText": "I see, it is indeed a bit out of place. I wanted to put it in its own section, to make it very visible.\nWould putting it in its own section at the end, also be a reasonable option? Maybe right after Mapping Protected Resources, since it's basically a recommendation to look at those tutorials after the quickstart?", "author": "stefnotch", "createdAt": "2020-02-27T17:59:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI3MTExNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMwMzE2OQ==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r385303169", "bodyText": "@stefnotch, sure, how would you name this dedicated section though ? Next Steps ? May be Additional Information ? This last one might be fine, what do you think ?", "author": "sberyozkin", "createdAt": "2020-02-27T18:50:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI3MTExNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxODI2Mw==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r385318263", "bodyText": "An alternative name, in line with the heading above it, would be Configuring Protected Resources. But Additional Information also seems fine.", "author": "stefnotch", "createdAt": "2020-02-27T19:18:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI3MTExNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM4NjIzOQ==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r385386239", "bodyText": "Hi @stefnotch, but this extension is also about protecting the resources with the relevant configuration. That said, lets settle around your Configuring Protected Resources but highlight somehow this section is about the alternatives, More About Configuring Protected Resources or Other Options for Configuring Protected Resources or Configuring Protected Resources without Keycloak, etc, find the line you like please :-).\nPlease also review the proposed amendment to the section text itself but tweak as needed\nThanks, and sorry it takes us awhile to finalize this PR :-)\nCC @pedroigor", "author": "sberyozkin", "createdAt": "2020-02-27T21:38:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI3MTExNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU1NTc4Nw==", "url": "https://github.com/quarkusio/quarkus/pull/7361#discussion_r385555787", "bodyText": "Ok, I updated it according to your suggestions.", "author": "stefnotch", "createdAt": "2020-02-28T08:06:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI3MTExNQ=="}], "type": "inlineReview"}, {"oid": "9a3a86092949c137183876a49f911a695855779e", "url": "https://github.com/quarkusio/quarkus/commit/9a3a86092949c137183876a49f911a695855779e", "message": "Document how to protect routes in Quarkus\n\nFix #7240\nUpdate docs/src/main/asciidoc/security-keycloak-authorization.adoc\n\nCo-Authored-By: Guillaume Smet <guillaume.smet@gmail.com>\naa\n\n\nSTuff", "committedDate": "2020-02-28T08:03:23Z", "type": "commit"}]}