{"pr_number": 7666, "pr_title": "Polish container image extensions and doc", "pr_createdAt": "2020-03-07T09:01:24Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7666", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NTgxNw==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389245817", "bodyText": "Should we link to each extension's section?", "author": "machi1990", "createdAt": "2020-03-07T10:49:33Z", "path": "docs/src/main/asciidoc/container-image.adoc", "diffHunk": "@@ -9,16 +9,16 @@ include::./attributes.adoc[]\n \n Quarkus provides extensions for building (and pushing) container images. Currently it supports:\n \n-- jib\n-- docker\n-- s2i\n+- JIB\n+- Docker\n+- S2I", "originalCommit": "f16f9c9e208ab7d127d8851e8ac54633cc7df857", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0ODY0OA==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389248648", "bodyText": "If we do, please use ids for the links.", "author": "gsmet", "createdAt": "2020-03-07T11:38:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NTgxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM3ODkzMQ==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389378931", "bodyText": "Is my change the correct way to do it?", "author": "geoand", "createdAt": "2020-03-08T15:19:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NTgxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQwMzc1NQ==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389403755", "bodyText": "Not sure. Did you define ids on the paragraphs? I don\u2019t see them in your diff but maybe they were preexisting (I\u2019m on my phone).", "author": "gsmet", "createdAt": "2020-03-08T20:45:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NTgxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQwNDE4MA==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389404180", "bodyText": "I didn't (I didn't even know you could). I'll update the PR in the morning", "author": "geoand", "createdAt": "2020-03-08T20:52:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NTgxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQwNDgyMg==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389404822", "bodyText": "Should be fixed with my latest change (I assume)", "author": "geoand", "createdAt": "2020-03-08T21:00:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NTgxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NjA4MA==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389246080", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            mvn clean package -Dquarkus.container-image.push=true\n          \n          \n            \n            ./mvnw clean package -Dquarkus.container-image.push=true", "author": "machi1990", "createdAt": "2020-03-07T10:54:39Z", "path": "docs/src/main/asciidoc/container-image.adoc", "diffHunk": "@@ -69,69 +72,46 @@ The creation of such objects is being taken care of by the Quarkus kubernetes ex\n \n == Building\n \n-To build a container image for your project, you just need to specify `quarkus.container-image.build=true` either to the `application.properties` or as a system property.\n+To build a container image for your project, `quarkus.container-image.build=true` needs to be set using any of the ways that Quarkus supports.\n \n [source, subs=attributes+]\n ----\n mvn clean package -Dquarkus.container-image.build=true\n ----\n \n-Setting the environment variable `QUARKUS_CONTAINER_IMAGE_EXECUTION` to `build` can be used instead of the system propery.\n-\n == Pushing\n \n-If the execution is set to `push` then after the build, the image will also be pushed to an image registry.\n-The registry can be specified using `quarkus.container-image.registry` and will default to `docker.io`.\n+To build a container image for your project, `quarkus.container-image.push=true` needs to be set using any of the ways that Quarkus supports.\n+\n+[source, subs=attributes+]\n+----\n+mvn clean package -Dquarkus.container-image.push=true", "originalCommit": "f16f9c9e208ab7d127d8851e8ac54633cc7df857", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NjIzMA==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389246230", "bodyText": "We can use the wrapper in the Pushing section too, https://github.com/quarkusio/quarkus/blob/f16f9c9e208ab7d127d8851e8ac54633cc7df857/docs/src/main/asciidoc/container-image.adoc#pushing", "author": "machi1990", "createdAt": "2020-03-07T10:57:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NjA4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NjEzNA==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389246134", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            log.info(\"No container image registry was set, so 'docker.io' will be used\");\n          \n          \n            \n                            log.info(\"No container image registry was set, defaulting to 'docker.io' \");", "author": "machi1990", "createdAt": "2020-03-07T10:55:36Z", "path": "extensions/container-image/container-image-jib/deployment/src/main/java/io/quarkus/container/image/jib/deployment/JibProcessor.java", "diffHunk": "@@ -135,6 +135,9 @@ private Containerizer createContainerizer(ContainerImageConfig containerImageCon\n         ImageReference imageReference = getImageReference(containerImageConfig, applicationInfo);\n \n         if (pushRequested || containerImageConfig.push) {\n+            if (!containerImageConfig.registry.isPresent()) {\n+                log.info(\"No container image registry was set, so 'docker.io' will be used\");", "originalCommit": "f16f9c9e208ab7d127d8851e8ac54633cc7df857", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM3ODY5Mg==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389378692", "bodyText": "I don't think this is an improvement to be honest", "author": "geoand", "createdAt": "2020-03-08T15:16:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NjEzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NjE3Mg==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389246172", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            log.info(\"No container image registry was set, so 'docker.io' will be used\");\n          \n          \n            \n                            log.info(\"No container image registry was set, defaulting to 'docker.io'\");", "author": "machi1990", "createdAt": "2020-03-07T10:55:59Z", "path": "extensions/container-image/container-image-docker/deployment/src/main/java/io/quarkus/container/image/docker/deployment/DockerProcessor.java", "diffHunk": "@@ -118,6 +118,9 @@ private void createContainerImage(ContainerImageConfig containerImageConfig, Doc\n         log.infof(\"Pushed container image %s (%s)\\n\", image, reader.getImageId());\n \n         if (pushRequested || containerImageConfig.push) {\n+            if (!containerImageConfig.registry.isPresent()) {\n+                log.info(\"No container image registry was set, so 'docker.io' will be used\");", "originalCommit": "f16f9c9e208ab7d127d8851e8ac54633cc7df857", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0ODYxMw==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389248613", "bodyText": "I dunno if it's worth having an info for that.", "author": "gsmet", "createdAt": "2020-03-07T11:37:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NjE3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM3ODc2Ng==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389378766", "bodyText": "I don't agree with the proposed change, but I do think that a log message should be used. After all the registry is Optional so when it's not set the user should know that some default was used", "author": "geoand", "createdAt": "2020-03-08T15:17:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0NjE3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0ODUzMw==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389248533", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The major benefit of using Jib with Quarkus, is that all dependencies (everything found under target/lib) are cached in a different layer than the actual application making rebuilds really fast and small (when it comes to pushing).\n          \n          \n            \n            The major benefit of using Jib with Quarkus is that all dependencies (everything found under target/lib) are cached in a different layer than the actual application making rebuilds really fast and small (when it comes to pushing).", "author": "gsmet", "createdAt": "2020-03-07T11:35:40Z", "path": "docs/src/main/asciidoc/container-image.adoc", "diffHunk": "@@ -9,16 +9,16 @@ include::./attributes.adoc[]\n \n Quarkus provides extensions for building (and pushing) container images. Currently it supports:\n \n-- jib\n-- docker\n-- s2i\n+- JIB\n+- Docker\n+- S2I\n \n == Container Image extensions\n \n === JIB\n \n-The extension `quarkus-container-image-jib` is powered by https://github.com/GoogleContainerTools/jib[Jib] for performing container builds.\n-The major benefit of using Jib with Quarkus, is that all dependencies (everything found under target/lib) are cached in a different layer than the actual application making rebuilds extra fast and extra small (when it comes to pushing).\n+The extension `quarkus-container-image-jib` is powered by https://github.com/GoogleContainerTools/jib[Jib] for performing container image builds.\n+The major benefit of using Jib with Quarkus, is that all dependencies (everything found under target/lib) are cached in a different layer than the actual application making rebuilds really fast and small (when it comes to pushing).", "originalCommit": "f16f9c9e208ab7d127d8851e8ac54633cc7df857", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0ODU4OQ==", "url": "https://github.com/quarkusio/quarkus/pull/7666#discussion_r389248589", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            NOTE: If no registry is set (using `quarkus.container-image.registry`) then `docker.io` will be used by as the default.\n          \n          \n            \n            NOTE: If no registry is set (using `quarkus.container-image.registry`) then `docker.io` will be used as the default.", "author": "gsmet", "createdAt": "2020-03-07T11:36:43Z", "path": "docs/src/main/asciidoc/container-image.adoc", "diffHunk": "@@ -69,69 +72,46 @@ The creation of such objects is being taken care of by the Quarkus kubernetes ex\n \n == Building\n \n-To build a container image for your project, you just need to specify `quarkus.container-image.build=true` either to the `application.properties` or as a system property.\n+To build a container image for your project, `quarkus.container-image.build=true` needs to be set using any of the ways that Quarkus supports.\n \n [source, subs=attributes+]\n ----\n mvn clean package -Dquarkus.container-image.build=true\n ----\n \n-Setting the environment variable `QUARKUS_CONTAINER_IMAGE_EXECUTION` to `build` can be used instead of the system propery.\n-\n == Pushing\n \n-If the execution is set to `push` then after the build, the image will also be pushed to an image registry.\n-The registry can be specified using `quarkus.container-image.registry` and will default to `docker.io`.\n+To build a container image for your project, `quarkus.container-image.push=true` needs to be set using any of the ways that Quarkus supports.\n+\n+[source, subs=attributes+]\n+----\n+mvn clean package -Dquarkus.container-image.push=true\n+----\n \n+NOTE: If no registry is set (using `quarkus.container-image.registry`) then `docker.io` will be used by as the default.", "originalCommit": "f16f9c9e208ab7d127d8851e8ac54633cc7df857", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6e846110d7c3bd3a348b704908910143fcfee2b2", "url": "https://github.com/quarkusio/quarkus/commit/6e846110d7c3bd3a348b704908910143fcfee2b2", "message": "Polish container image extensions and doc", "committedDate": "2020-03-08T15:18:21Z", "type": "forcePushed"}, {"oid": "e55ffe064c9664e64a3c04459f33ed28324a86a2", "url": "https://github.com/quarkusio/quarkus/commit/e55ffe064c9664e64a3c04459f33ed28324a86a2", "message": "Polish container image extensions and doc", "committedDate": "2020-03-08T20:56:38Z", "type": "commit"}, {"oid": "e55ffe064c9664e64a3c04459f33ed28324a86a2", "url": "https://github.com/quarkusio/quarkus/commit/e55ffe064c9664e64a3c04459f33ed28324a86a2", "message": "Polish container image extensions and doc", "committedDate": "2020-03-08T20:56:38Z", "type": "forcePushed"}]}