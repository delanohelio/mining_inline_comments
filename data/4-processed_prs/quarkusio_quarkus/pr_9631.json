{"pr_number": 9631, "pr_title": "Introduce QuarkusProject and Quarkus project zipping in codegen", "pr_createdAt": "2020-05-27T11:25:05Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9631", "timeline": [{"oid": "1dc58e909465157a2465e317069edd5f0e8f193d", "url": "https://github.com/quarkusio/quarkus/commit/1dc58e909465157a2465e317069edd5f0e8f193d", "message": "Introduce QuarkusProject in codegen to reduce ProjectWriter and BuildTool coupling\n\nThis is part of #8178\n\nThis is a good one :-), things starts to get nicer and cleaner (but not quite there yet ^^)..", "committedDate": "2020-05-27T11:41:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA2MzA5Mg==", "url": "https://github.com/quarkusio/quarkus/pull/9631#discussion_r431063092", "bodyText": "I need to check that it still works..", "author": "ia3andy", "createdAt": "2020-05-27T12:01:05Z", "path": "devtools/maven/src/main/java/io/quarkus/maven/CreateProjectMojo.java", "diffHunk": "@@ -236,10 +235,9 @@ public void execute() throws MojoExecutionException {\n         }\n     }\n \n-    private void createGradleWrapper(QuarkusPlatformDescriptor platform,\n-            ProjectWriter writer) {\n+    private void createGradleWrapper(QuarkusPlatformDescriptor platform, Path projectFolderPath) {\n         try {\n-            writer.mkdirs(\"gradle/wrapper\");\n+            Files.createDirectories(projectFolderPath.resolve(\"gradle/wrapper\"));", "originalCommit": "4c7f189912c22d2beca000ae46d70e1d8ce5e944", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4NTEyNA==", "url": "https://github.com/quarkusio/quarkus/pull/9631#discussion_r431285124", "bodyText": "Working..", "author": "ia3andy", "createdAt": "2020-05-27T16:37:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA2MzA5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQyMTMyOA==", "url": "https://github.com/quarkusio/quarkus/pull/9631#discussion_r431421328", "bodyText": "Just a note, previously a single invocation could have been passed to multiple handlers (e.g. create followed by add extensions) that would use the same project writer instance. It doesn't mean it has to stay that way.", "author": "aloubyansky", "createdAt": "2020-05-27T20:26:28Z", "path": "independent-projects/tools/common/src/main/java/io/quarkus/cli/commands/CreateProjectCommandHandler.java", "diffHunk": "@@ -20,10 +21,8 @@\n \n     @Override\n     public QuarkusCommandOutcome execute(QuarkusCommandInvocation invocation) throws QuarkusCommandException {\n-        final ProjectWriter projectWriter = invocation.getProjectWriter();\n-        if (projectWriter == null) {\n-            throw new IllegalStateException(\"Project writer has not been provided\");\n-        }\n+        final ProjectWriter projectWriter = new FileProjectWriter(\n+                invocation.getQuarkusProject().getProjectFolderPath().toFile());", "originalCommit": "4c7f189912c22d2beca000ae46d70e1d8ce5e944", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTYzMjA2Ng==", "url": "https://github.com/quarkusio/quarkus/pull/9631#discussion_r431632066", "bodyText": "I am not there yet, but to make it more consistent and simple, my intent is to go toward atomic operations (without having to deal with the writer close/save from outside):\n\ncreate (directly with or without extensions)\nadd extension(s)\nremove extension(s)\n\nUsing the same writer would make it more performant when doing multiple of those, but I guess there is no use case for it.\nOne good example of the risk of having this close/save handled externally is that (as I did without knowing) having multiple writer and closing the one without the modification after ending up with reseting the modification \ud83d\ude05\nWDYT?", "author": "ia3andy", "createdAt": "2020-05-28T07:22:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQyMTMyOA=="}], "type": "inlineReview"}, {"oid": "555c7c79f82a01a2318e424650c7cde06d28b236", "url": "https://github.com/quarkusio/quarkus/commit/555c7c79f82a01a2318e424650c7cde06d28b236", "message": "Introduce QuarkusProject in codegen to reduce ProjectWriter and BuildTool coupling\n\nThis is part of #8178\n\nThis is a good one :-), things starts to get nicer and cleaner (but not quite there yet ^^)..", "committedDate": "2020-05-28T09:42:20Z", "type": "commit"}, {"oid": "6b304180d91f3c569b1b8beab6ce88b4ae1fa268", "url": "https://github.com/quarkusio/quarkus/commit/6b304180d91f3c569b1b8beab6ce88b4ae1fa268", "message": "Clean package structure", "committedDate": "2020-05-28T09:42:21Z", "type": "commit"}, {"oid": "658d730226e43c155dc16fb43c4f1989c144bc96", "url": "https://github.com/quarkusio/quarkus/commit/658d730226e43c155dc16fb43c4f1989c144bc96", "message": "Fix multiple close overriding modification when adding extensions", "committedDate": "2020-05-28T09:42:21Z", "type": "commit"}, {"oid": "d3b2456f713ea543ea5bfb6bc641c53e9cbd9566", "url": "https://github.com/quarkusio/quarkus/commit/d3b2456f713ea543ea5bfb6bc641c53e9cbd9566", "message": "Introduce QuarkusProjectCompress to zip QuarkusProject", "committedDate": "2020-05-28T09:42:21Z", "type": "forcePushed"}, {"oid": "8a3c24d4718d24d8f8743ddc91425b132209c069", "url": "https://github.com/quarkusio/quarkus/commit/8a3c24d4718d24d8f8743ddc91425b132209c069", "message": "Minor refactor in QuarkusProject", "committedDate": "2020-05-28T13:41:32Z", "type": "commit"}, {"oid": "2e7b78b331d7c4422dfa86d122f4af1dd3b1865a", "url": "https://github.com/quarkusio/quarkus/commit/2e7b78b331d7c4422dfa86d122f4af1dd3b1865a", "message": "Introduce QuarkusProjectCompress to zip QuarkusProject", "committedDate": "2020-05-28T13:41:37Z", "type": "commit"}, {"oid": "2e7b78b331d7c4422dfa86d122f4af1dd3b1865a", "url": "https://github.com/quarkusio/quarkus/commit/2e7b78b331d7c4422dfa86d122f4af1dd3b1865a", "message": "Introduce QuarkusProjectCompress to zip QuarkusProject", "committedDate": "2020-05-28T13:41:37Z", "type": "forcePushed"}]}