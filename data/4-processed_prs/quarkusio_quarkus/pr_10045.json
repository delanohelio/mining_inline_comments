{"pr_number": 10045, "pr_title": "Prevent NPE in Spring Web when no \"Accept\" header is specified", "pr_createdAt": "2020-06-16T12:12:31Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10045", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgxMjE0MQ==", "url": "https://github.com/quarkusio/quarkus/pull/10045#discussion_r440812141", "bodyText": "This is done because negotiation.setAcceptHeaders(anEmptyList); throws a NPE", "author": "geoand", "createdAt": "2020-06-16T12:31:19Z", "path": "extensions/spring-web/runtime/src/main/java/io/quarkus/spring/web/runtime/ResponseContentTypeResolver.java", "diffHunk": "@@ -20,7 +20,9 @@ public static MediaType resolve(HttpHeaders httpHeaders, String... supportedMedi\n         Objects.requireNonNull(httpHeaders, \"HttpHeaders cannot be null\");\n         Objects.requireNonNull(supportedMediaTypes, \"Supported media types array cannot be null\");\n \n-        Variant bestVariant = getBestVariant(httpHeaders.getRequestHeader(ACCEPT), getMediaTypeVariants(supportedMediaTypes));\n+        List<String> acceptHeaders = httpHeaders.getRequestHeader(ACCEPT);\n+        Variant bestVariant = acceptHeaders.isEmpty() ? null\n+                : getBestVariant(acceptHeaders, getMediaTypeVariants(supportedMediaTypes));", "originalCommit": "aa42efab7c4aa78043f0fadfef49d087aba26336", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDg3MjE4Mw==", "url": "https://github.com/quarkusio/quarkus/pull/10045#discussion_r440872183", "bodyText": "It would be cleaner to do the list check in the getBesetVariant method.", "author": "gytis", "createdAt": "2020-06-16T13:58:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgxMjE0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDg5MTk5Nw==", "url": "https://github.com/quarkusio/quarkus/pull/10045#discussion_r440891997", "bodyText": "Indeed", "author": "geoand", "createdAt": "2020-06-16T14:24:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgxMjE0MQ=="}], "type": "inlineReview"}, {"oid": "559ecbcda58074ebc7b4798c4287114cfeabe96f", "url": "https://github.com/quarkusio/quarkus/commit/559ecbcda58074ebc7b4798c4287114cfeabe96f", "message": "Prevent NPE in Spring Web when no \"Accept\" header is specified\n\nFixes: #10033", "committedDate": "2020-06-16T14:20:32Z", "type": "commit"}, {"oid": "559ecbcda58074ebc7b4798c4287114cfeabe96f", "url": "https://github.com/quarkusio/quarkus/commit/559ecbcda58074ebc7b4798c4287114cfeabe96f", "message": "Prevent NPE in Spring Web when no \"Accept\" header is specified\n\nFixes: #10033", "committedDate": "2020-06-16T14:20:32Z", "type": "forcePushed"}]}