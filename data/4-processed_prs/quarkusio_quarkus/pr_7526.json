{"pr_number": 7526, "pr_title": "Fix metrics of the default Agroal data source", "pr_createdAt": "2020-03-03T08:27:24Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7526", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg4NzY5NQ==", "url": "https://github.com/quarkusio/quarkus/pull/7526#discussion_r386887695", "bodyText": "Sorry I missed that but... could we adjust that, pass the name to the gauge and counter and use DataSourceUtil.isDefault() there?\nThat would be more consistent and avoid this sort of issues.", "author": "gsmet", "createdAt": "2020-03-03T09:19:15Z", "path": "extensions/agroal/deployment/src/main/java/io/quarkus/agroal/deployment/AgroalProcessor.java", "diffHunk": "@@ -551,89 +551,91 @@ void registerMetrics(\n             boolean metricsEnabledForThisDatasource = dataSourcesBuildTimeConfig.metricsEnabled &&\n                     aggregatedDataSourceBuildTimeConfig.getJdbcConfig().enableMetrics.orElse(true);\n             Tag tag = new Tag(\"datasource\", DataSourceUtil.isDefault(dataSourceName) ? \"default\" : dataSourceName);\n+            // Metric classes expect null as the name for the default DS\n+            String dataSourceNameOrNull = DataSourceUtil.isDefault(dataSourceName) ? null : dataSourceName;", "originalCommit": "0518b2b1962ffdf392bc46fb06f1adf9f01055b2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg5NzEwOA==", "url": "https://github.com/quarkusio/quarkus/pull/7526#discussion_r386897108", "bodyText": "Sounds like a good idea. Done", "author": "jmartisk", "createdAt": "2020-03-03T09:35:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg4NzY5NQ=="}], "type": "inlineReview"}, {"oid": "8c7a54ac156dcaa82bb9ae2b55a36e9e49c530d9", "url": "https://github.com/quarkusio/quarkus/commit/8c7a54ac156dcaa82bb9ae2b55a36e9e49c530d9", "message": "Fix metrics of the default Agroal data source", "committedDate": "2020-03-03T09:34:06Z", "type": "forcePushed"}, {"oid": "88a86bf88281e26a4232767582c7fa926c5349b5", "url": "https://github.com/quarkusio/quarkus/commit/88a86bf88281e26a4232767582c7fa926c5349b5", "message": "Fix metrics of the default Agroal data source", "committedDate": "2020-03-03T11:05:22Z", "type": "commit"}, {"oid": "88a86bf88281e26a4232767582c7fa926c5349b5", "url": "https://github.com/quarkusio/quarkus/commit/88a86bf88281e26a4232767582c7fa926c5349b5", "message": "Fix metrics of the default Agroal data source", "committedDate": "2020-03-03T11:05:22Z", "type": "forcePushed"}]}