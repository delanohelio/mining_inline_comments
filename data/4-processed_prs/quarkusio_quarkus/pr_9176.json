{"pr_number": 9176, "pr_title": "Fix deadlock in command mode", "pr_createdAt": "2020-05-08T11:02:42Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9176", "timeline": [{"oid": "faf5774113c01dde3b394fdd237cc263e724c0f2", "url": "https://github.com/quarkusio/quarkus/commit/faf5774113c01dde3b394fdd237cc263e724c0f2", "message": "Fix deadlock in command mode\n\nFixes: #9163", "committedDate": "2020-05-08T11:02:21Z", "type": "commit"}, {"oid": "11a529e9595f33d22bd4c77082b4d2a07509c5cd", "url": "https://github.com/quarkusio/quarkus/commit/11a529e9595f33d22bd4c77082b4d2a07509c5cd", "message": "Improve assertions for command mode tests", "committedDate": "2020-05-08T11:02:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE0NDkxOQ==", "url": "https://github.com/quarkusio/quarkus/pull/9176#discussion_r422144919", "bodyText": "I think this will break some tests, although I can't remember the details. Maybe the default handler that calls System.exit() needs to do it from a new thread.", "author": "stuartwdouglas", "createdAt": "2020-05-08T13:32:43Z", "path": "core/runtime/src/main/java/io/quarkus/runtime/ApplicationLifecycleManager.java", "diffHunk": "@@ -142,12 +142,8 @@ public static final void run(Application application, Class<? extends QuarkusApp\n             } finally {\n                 stateLock.unlock();\n             }\n-            application.stop(new Runnable() {", "originalCommit": "11a529e9595f33d22bd4c77082b4d2a07509c5cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE0NjIxNQ==", "url": "https://github.com/quarkusio/quarkus/pull/9176#discussion_r422146215", "bodyText": "Yeah I thought so as well, but when I ran the CI on my fork, all tests passed.\nSo should I leave it as is (assuming we'll get green CI here as well) or change to use another thread?", "author": "geoand", "createdAt": "2020-05-08T13:35:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE0NDkxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE0ODA3MA==", "url": "https://github.com/quarkusio/quarkus/pull/9176#discussion_r422148070", "bodyText": "I know I had a good reason for doing it this way, but I can't actually remember what it was. Maybe subsequent changes mean it is not needed now, so if CI passes then lets merge, and if we see intermittent failures we can change it.", "author": "stuartwdouglas", "createdAt": "2020-05-08T13:38:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE0NDkxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE0OTM0OA==", "url": "https://github.com/quarkusio/quarkus/pull/9176#discussion_r422149348", "bodyText": "Cool, makes sense", "author": "geoand", "createdAt": "2020-05-08T13:41:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE0NDkxOQ=="}], "type": "inlineReview"}]}