{"pr_number": 11637, "pr_title": "Neo4j driver metrics", "pr_createdAt": "2020-08-26T09:28:57Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/11637", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMwNDQ4Ng==", "url": "https://github.com/quarkusio/quarkus/pull/11637#discussion_r478304486", "bodyText": "I'm wondering if it would be better to have a global metrics setting rather than something under pool. Wouldn't it be more in line with the other extensions?\nIf we want to add other metrics, will we add more boolean settings?", "author": "gsmet", "createdAt": "2020-08-27T10:05:29Z", "path": "docs/src/main/asciidoc/neo4j.adoc", "diffHunk": "@@ -403,6 +403,11 @@ So when you access the `/health/ready` endpoint of your application you will hav\n \n This behavior can be disabled by setting the `quarkus.neo4j.health.enabled` property to `false` in your `application.properties`.\n \n+=== Driver metrics\n+\n+If you are using a metrics extension and specify the config property `quarkus.neo4j.pool.metrics-enabled=true`, the Neo4j extension will", "originalCommit": "e2a9dc61ec506a96d73f4d58ff8e15031515bc21", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMxNDQwNA==", "url": "https://github.com/quarkusio/quarkus/pull/11637#discussion_r478314404", "bodyText": "That's a very good point. At first I was planning to add a quarkus.neo4j.metrics-enabled property, but then I saw that there already exists quarkus.neo4j.pool.metrics-enabled which enables collection of metrics (internally without exporting them). So what I did instead of adding a new property (which would be confusing due to a very similar name), I changed the meaning of the original property, and now, rather than just enable collection of metrics, it also enables exporting them by the Metrics extension.\nWe could potentially rename the original one to quarkus.neo4j.metrics-enabled and let it do both these things at the same time, but it would break any usage of the original property, so I decided to go with the backward compatible approach.\nIn the Agroal extension, we do have two different properties\nquarkus.datasource.jdbc.metrics-enabled and\nquarkus.datasource.DS_NAME.jdbc.enable-metrics\nThere it makes sense to me because here you can enable metrics for each named data source separately, but in Neo4j we only support one connection pool, so it doesn't seem to have much value to have two separate properties for it.", "author": "jmartisk", "createdAt": "2020-08-27T10:23:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMwNDQ4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMyMjEzMQ==", "url": "https://github.com/quarkusio/quarkus/pull/11637#discussion_r478322131", "bodyText": "I think I would make it a global metric property, deprecate the old one (but still consider it if it's true). If you use the @Deprecated annotation, the old one won't be included in the config reference doc.", "author": "gsmet", "createdAt": "2020-08-27T10:38:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMwNDQ4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMyMjUwNQ==", "url": "https://github.com/quarkusio/quarkus/pull/11637#discussion_r478322505", "bodyText": "But better wait for @michael-simons 's feedback.", "author": "gsmet", "createdAt": "2020-08-27T10:38:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMwNDQ4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMyNDM1OA==", "url": "https://github.com/quarkusio/quarkus/pull/11637#discussion_r478324358", "bodyText": "When I read the PR I expected the meaning of the property to stay the same plus when SmallRye Metrics is available that our pool metrics are exported (Probably because that's the way we role with Spring Boot, which I actually like).\nApart from that we don't have any plans for metrics apart the pool itself in the driver for the time being (Thinking query metrics (which I would like btw)). But if we do this in the future, I would prefer dedicated a dedicated property for it.", "author": "michael-simons", "createdAt": "2020-08-27T10:42:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMwNDQ4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMyNTQwNA==", "url": "https://github.com/quarkusio/quarkus/pull/11637#discussion_r478325404", "bodyText": "OK, I suppose we can keep it that way then and wait for user complaints if any.", "author": "gsmet", "createdAt": "2020-08-27T10:45:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMwNDQ4Ng=="}], "type": "inlineReview"}, {"oid": "347cf6291aec9e45412fc2930655da4fa558205b", "url": "https://github.com/quarkusio/quarkus/commit/347cf6291aec9e45412fc2930655da4fa558205b", "message": "Neo4j metrics", "committedDate": "2020-08-27T10:48:53Z", "type": "forcePushed"}, {"oid": "d2d6ee61b28a52b4b1ea59075e944db7cd28880d", "url": "https://github.com/quarkusio/quarkus/commit/d2d6ee61b28a52b4b1ea59075e944db7cd28880d", "message": "Neo4j metrics", "committedDate": "2020-08-27T11:14:01Z", "type": "forcePushed"}, {"oid": "f0abfbc00fbe9c3b553a8b1cda76d62169eff8ff", "url": "https://github.com/quarkusio/quarkus/commit/f0abfbc00fbe9c3b553a8b1cda76d62169eff8ff", "message": "Neo4j metrics", "committedDate": "2020-08-28T06:44:18Z", "type": "forcePushed"}, {"oid": "98695826f43280f20c6176281c08cc7020a06529", "url": "https://github.com/quarkusio/quarkus/commit/98695826f43280f20c6176281c08cc7020a06529", "message": "Neo4j metrics", "committedDate": "2020-08-28T08:13:01Z", "type": "commit"}, {"oid": "98695826f43280f20c6176281c08cc7020a06529", "url": "https://github.com/quarkusio/quarkus/commit/98695826f43280f20c6176281c08cc7020a06529", "message": "Neo4j metrics", "committedDate": "2020-08-28T08:13:01Z", "type": "forcePushed"}]}