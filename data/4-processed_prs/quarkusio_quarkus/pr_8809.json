{"pr_number": 8809, "pr_title": "Document @ActivateRequestContext for command mode", "pr_createdAt": "2020-04-24T05:43:34Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/8809", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM0ODAzMg==", "url": "https://github.com/quarkusio/quarkus/pull/8809#discussion_r414348032", "bodyText": "As discussed on zulip, this sentence is wrong. @ActivateRequestContext merely activates the request context and makes it possible to use @RequestScoped beans in the command mode.", "author": "mkouba", "createdAt": "2020-04-24T07:12:44Z", "path": "docs/src/main/asciidoc/command-mode-reference.adoc", "diffHunk": "@@ -20,25 +20,28 @@ that exit.\n In this document the `QuarkusApplication` instance is referred to as the application main,\n and a class with a Java main method is the Java main.\n \n-The simplest possible command mode application might appear as follows:\n+The simplest possible command mode application with access to Quarkus API's might appear as follows:\n \n [source,java]\n ----\n import io.quarkus.runtime.QuarkusApplication;\n import io.quarkus.runtime.annotations.QuarkusMain;\n \n-@QuarkusMain    // <1>\n+@QuarkusMain    // <.>\n public class HelloWorldMain implements QuarkusApplication {\n   @Override\n-  public int run(String... args) throws Exception {   // <2>\n+  @ActivateRequestContext // <.>\n+  public int run(String... args) throws Exception {   // <.>\n     System.out.println(\"Hello World\");\n     return 10;\n  }\n }\n ----\n-<1> The `@QuarkusMain` annotation tells Quarkus that this is the main entry point.\n-<2> The `run` method is invoked once Quarkus starts, and the application stops when it finishes.\n+<.> The `@QuarkusMain` annotation tells Quarkus that this is the main entry point.\n+<.> The `@ActivateRequestContext` annotation is not strictly required for this example, but ensures you have access to context dependency injection. Allowing you to use API's such as Hibernate Panache.", "originalCommit": "703d48868ff2c78b6605f3ed42c170b55728a767", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM3NzA3OA==", "url": "https://github.com/quarkusio/quarkus/pull/8809#discussion_r414377078", "bodyText": "@mkouba what would be the cost of activating it always?", "author": "gsmet", "createdAt": "2020-04-24T08:02:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM0ODAzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM4OTA5Mw==", "url": "https://github.com/quarkusio/quarkus/pull/8809#discussion_r414389093", "bodyText": "what would be the cost\n\nNegligible. So in general, a command execution is a kind of a request. The only concern I have is that someone can use the command mode to execute a relatively long-lived app and since the automatic activation turns @RequestScoped into @ApplicationScoped it loses its meaning...", "author": "mkouba", "createdAt": "2020-04-24T08:22:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM0ODAzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5NjQ4Mw==", "url": "https://github.com/quarkusio/quarkus/pull/8809#discussion_r414496483", "bodyText": "I'm going to update this pr - cli's can easily be long lived and have multiple (even concurrent) requests thus it makes sense to be explicit wehn you want one over the other.", "author": "maxandersen", "createdAt": "2020-04-24T11:17:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM0ODAzMg=="}], "type": "inlineReview"}, {"oid": "5bdeacf8e334d65655f95e8c1c75943cf3e4290c", "url": "https://github.com/quarkusio/quarkus/commit/5bdeacf8e334d65655f95e8c1c75943cf3e4290c", "message": "Document @ActivateRequestContext for command mode", "committedDate": "2020-04-24T11:45:53Z", "type": "forcePushed"}, {"oid": "d969fa1253d5d258d25d2bf121b5eacb8f2820f9", "url": "https://github.com/quarkusio/quarkus/commit/d969fa1253d5d258d25d2bf121b5eacb8f2820f9", "message": "Document @ActivateRequestContext for command mode", "committedDate": "2020-04-24T11:47:17Z", "type": "commit"}, {"oid": "d969fa1253d5d258d25d2bf121b5eacb8f2820f9", "url": "https://github.com/quarkusio/quarkus/commit/d969fa1253d5d258d25d2bf121b5eacb8f2820f9", "message": "Document @ActivateRequestContext for command mode", "committedDate": "2020-04-24T11:47:17Z", "type": "forcePushed"}]}