{"pr_number": 9773, "pr_title": "Make REST Client work whether or not SSL is enabled or not in native", "pr_createdAt": "2020-06-04T08:32:32Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9773", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEzODY5MQ==", "url": "https://github.com/quarkusio/quarkus/pull/9773#discussion_r435138691", "bodyText": "What does ImageInfo.inImageRuntimeCode() return if it's running on OpenJDK?", "author": "kenfinnigan", "createdAt": "2020-06-04T10:03:27Z", "path": "extensions/rest-client/runtime/src/main/java/io/quarkus/restclient/runtime/RestClientBase.java", "diffHunk": "@@ -77,6 +80,12 @@ private void configureSsl(RestClientBuilder builder) {\n         if (maybeHostnameVerifier.isPresent()) {\n             registerHostnameVerifier(maybeHostnameVerifier.get(), builder);\n         }\n+\n+        // we need to push a disabled SSL context when SSL has been disabled\n+        // because otherwise Apache HTTP Client will try to initialize one and will fail\n+        if (ImageInfo.inImageRuntimeCode() && !SslContextConfiguration.isSslNativeEnabled()) {", "originalCommit": "8fdb04149af38233826c595b21577de6e3ee9ddc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTE0MjgzNA==", "url": "https://github.com/quarkusio/quarkus/pull/9773#discussion_r435142834", "bodyText": "It returns false. We use that in a couple more places in Quarkus as well (for example: \n  \n    \n      quarkus/core/runtime/src/main/java/io/quarkus/runtime/ApplicationLifecycleManager.java\n    \n    \n         Line 157\n      in\n      f89650b\n    \n    \n    \n    \n\n        \n          \n           if (ImageInfo.inImageRuntimeCode() && System.getenv(DISABLE_SIGNAL_HANDLERS) == null) { \n        \n    \n  \n\n)", "author": "geoand", "createdAt": "2020-06-04T10:11:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEzODY5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTE0NTQzNA==", "url": "https://github.com/quarkusio/quarkus/pull/9773#discussion_r435145434", "bodyText": "Fair enough, I was half expecting it to majorly fail if it wasn't on GraalVM JDK", "author": "kenfinnigan", "createdAt": "2020-06-04T10:15:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEzODY5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTE0NjUyOQ==", "url": "https://github.com/quarkusio/quarkus/pull/9773#discussion_r435146529", "bodyText": "Under the hood it just checks for a system property, so it's not that smart :)", "author": "geoand", "createdAt": "2020-06-04T10:17:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEzODY5MQ=="}], "type": "inlineReview"}, {"oid": "8293c6bb6062cda2fbc532ea68d9dd4d4b20491b", "url": "https://github.com/quarkusio/quarkus/commit/8293c6bb6062cda2fbc532ea68d9dd4d4b20491b", "message": "Make REST Client work whether or not SSL is enabled or not in native\n\nThis is done in order to enable the use of Apache HTTP Client in all\ncases where the REST Client is used.\nThis enables us to drop the fallback to URLConnection which is rather limited\n\nFixes: #9342", "committedDate": "2020-06-04T10:55:02Z", "type": "forcePushed"}, {"oid": "d82c9089c069500f66fb5ccaf9225696a3bbc4ff", "url": "https://github.com/quarkusio/quarkus/commit/d82c9089c069500f66fb5ccaf9225696a3bbc4ff", "message": "Make REST Client work whether or not SSL is enabled or not in native\n\nThis is done in order to enable the use of Apache HTTP Client in all\ncases where the REST Client is used.\nThis enables us to drop the fallback to URLConnection which is rather limited\n\nFixes: #9342", "committedDate": "2020-06-09T15:13:17Z", "type": "forcePushed"}, {"oid": "b406f7ac160389fdcf19ef95225afbdea7a48441", "url": "https://github.com/quarkusio/quarkus/commit/b406f7ac160389fdcf19ef95225afbdea7a48441", "message": "Make REST Client work whether or not SSL is enabled or not in native\n\nThis is done in order to enable the use of Apache HTTP Client in all\ncases where the REST Client is used.\nThis enables us to drop the fallback to URLConnection which is rather limited\n\nFixes: #9342", "committedDate": "2020-06-09T17:45:33Z", "type": "commit"}, {"oid": "b406f7ac160389fdcf19ef95225afbdea7a48441", "url": "https://github.com/quarkusio/quarkus/commit/b406f7ac160389fdcf19ef95225afbdea7a48441", "message": "Make REST Client work whether or not SSL is enabled or not in native\n\nThis is done in order to enable the use of Apache HTTP Client in all\ncases where the REST Client is used.\nThis enables us to drop the fallback to URLConnection which is rather limited\n\nFixes: #9342", "committedDate": "2020-06-09T17:45:33Z", "type": "forcePushed"}]}