{"pr_number": 9213, "pr_title": "NettyProcessor - init EventLoopGroup synthetic beans RUN_TIME", "pr_createdAt": "2020-05-11T14:45:15Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9213", "timeline": [{"oid": "0228adce2dbda9cb928210ed22ad205bd0c35d04", "url": "https://github.com/quarkusio/quarkus/commit/0228adce2dbda9cb928210ed22ad205bd0c35d04", "message": "NettyProcessor - init EventLoopGroup synthetic beans RUN_TIME\n\n- make EventLoopGroup beans singletons (client proxies cause problems\nwith some Netty classes compiled with JDK6)\n- init Vertx event loops during RUN_TIME (they are not usable during\nSTATIC_INIT)\n- introduce the EventLoopReadyBuildItem empty build item\n- also add a test for client proxies and covariant return types (bridge\nmethods are generated by the compiler in JDK8+)", "committedDate": "2020-05-11T14:58:50Z", "type": "forcePushed"}, {"oid": "c01994a1b1b4fb35a3492eb4e6337d0827194f6d", "url": "https://github.com/quarkusio/quarkus/commit/c01994a1b1b4fb35a3492eb4e6337d0827194f6d", "message": "NettyProcessor - init EventLoopGroup synthetic beans RUN_TIME\n\n- make EventLoopGroup beans singletons (client proxies cause problems\nwith some Netty classes compiled with JDK6)\n- init Vertx event loops during RUN_TIME (they are not usable during\nSTATIC_INIT)\n- introduce the SyntheticBeansRuntimeInitBuildItem empty build item\n- also add a test for client proxies and covariant return types (bridge\nmethods are generated by the compiler in JDK8+)", "committedDate": "2020-05-11T16:06:00Z", "type": "commit"}, {"oid": "c01994a1b1b4fb35a3492eb4e6337d0827194f6d", "url": "https://github.com/quarkusio/quarkus/commit/c01994a1b1b4fb35a3492eb4e6337d0827194f6d", "message": "NettyProcessor - init EventLoopGroup synthetic beans RUN_TIME\n\n- make EventLoopGroup beans singletons (client proxies cause problems\nwith some Netty classes compiled with JDK6)\n- init Vertx event loops during RUN_TIME (they are not usable during\nSTATIC_INIT)\n- introduce the SyntheticBeansRuntimeInitBuildItem empty build item\n- also add a test for client proxies and covariant return types (bridge\nmethods are generated by the compiler in JDK8+)", "committedDate": "2020-05-11T16:06:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQwNDIxMw==", "url": "https://github.com/quarkusio/quarkus/pull/9213#discussion_r423404213", "bodyText": "It does not look like anything in the PR is depending on this?", "author": "stuartwdouglas", "createdAt": "2020-05-12T01:03:14Z", "path": "extensions/arc/deployment/src/main/java/io/quarkus/arc/deployment/SyntheticBeansRuntimeInitBuildItem.java", "diffHunk": "@@ -0,0 +1,10 @@\n+package io.quarkus.arc.deployment;\n+\n+import io.quarkus.builder.item.EmptyBuildItem;\n+\n+/**\n+ * This build item should be consumed by build steps that require RUNTIME_INIT synthetic beans to be initialized.\n+ */\n+public final class SyntheticBeansRuntimeInitBuildItem extends EmptyBuildItem {", "originalCommit": "c01994a1b1b4fb35a3492eb4e6337d0827194f6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ3OTUwMQ==", "url": "https://github.com/quarkusio/quarkus/pull/9213#discussion_r423479501", "bodyText": "Right, it's the Cassandra extension POC (linked with this PR) that would make use of it. Anyway, I believe it would be useful for other extensions as well - right now, you can only depend on ServiceStartBuildItem that may be too late. WDYT?", "author": "mkouba", "createdAt": "2020-05-12T05:59:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQwNDIxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ5NTY0Mg==", "url": "https://github.com/quarkusio/quarkus/pull/9213#discussion_r423495642", "bodyText": "Is the container even ready by this point?\ninitRuntime that produces this injects BuildProducer, which means that when the init is done the runtime beans will be ready. It seems that just waiting for the container to be ready would be enough?", "author": "stuartwdouglas", "createdAt": "2020-05-12T06:40:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQwNDIxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ5OTUxNA==", "url": "https://github.com/quarkusio/quarkus/pull/9213#discussion_r423499514", "bodyText": "Not really - the CDI container is started during STATIC_INIT. We're talking about RUNTIME_INIT.", "author": "mkouba", "createdAt": "2020-05-12T06:49:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQwNDIxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUwNzI3Mg==", "url": "https://github.com/quarkusio/quarkus/pull/9213#discussion_r423507272", "bodyText": "Ah yea, I was not really thinking there :-)", "author": "stuartwdouglas", "createdAt": "2020-05-12T07:05:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQwNDIxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUyNDAxNg==", "url": "https://github.com/quarkusio/quarkus/pull/9213#discussion_r423524016", "bodyText": "Yeah, it usually takes me a while until I realize what happens in which phase... ;-)", "author": "mkouba", "createdAt": "2020-05-12T07:37:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQwNDIxMw=="}], "type": "inlineReview"}]}