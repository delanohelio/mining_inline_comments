{"pr_number": 7336, "pr_title": "Avoid annoying Warning logs when Sentry is disabled", "pr_createdAt": "2020-02-21T16:15:53Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7336", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4NDMyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/7336#discussion_r382684321", "bodyText": "Looks a bit like dark magic to me :).", "author": "gsmet", "createdAt": "2020-02-21T16:38:17Z", "path": "extensions/logging-sentry/runtime/src/main/java/io/quarkus/logging/sentry/SentryHandlerValueFactory.java", "diffHunk": "@@ -11,14 +11,20 @@\n import io.sentry.Sentry;\n import io.sentry.SentryOptions;\n import io.sentry.config.Lookup;\n+import io.sentry.dsn.Dsn;\n import io.sentry.jul.SentryHandler;\n \n @Recorder\n public class SentryHandlerValueFactory {\n     private static final Logger LOG = Logger.getLogger(SentryConfigProvider.class);\n \n     public RuntimeValue<Optional<Handler>> create(final SentryConfig config) {\n+        final SentryConfigProvider provider = new SentryConfigProvider(config);\n+        final Lookup lookup = new Lookup(provider, provider);\n+\n         if (!config.enable) {\n+            // Disable Sentry\n+            Sentry.init(SentryOptions.from(lookup, Dsn.DEFAULT_DSN));", "originalCommit": "7d2ed70e24517ad081d27b7eac232e81b6b2d2ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc1ODUzNA==", "url": "https://github.com/quarkusio/quarkus/pull/7336#discussion_r382758534", "bodyText": "@gsmet,\nIt's a bit magic indeed, but Sentry API is not really made for this kind of use case.\nI Already had to implement the Lookup in order to use our own config.\nJust to make you understand this code, when there is no DSN, Sentry shows a warning and set it to Dsn.DEFAULT_DSN, Using this just prevent from showing the warning..", "author": "ia3andy", "createdAt": "2020-02-21T19:15:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4NDMyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTI3OQ==", "url": "https://github.com/quarkusio/quarkus/pull/7336#discussion_r383129279", "bodyText": "This is what I am referring to above: https://github.com/getsentry/sentry-java/blob/master/sentry/src/main/java/io/sentry/dsn/Dsn.java#L101", "author": "ia3andy", "createdAt": "2020-02-24T08:29:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4NDMyMQ=="}], "type": "inlineReview"}, {"oid": "486eb8ebd4ddc6d1261421b695b497dd61fa3f94", "url": "https://github.com/quarkusio/quarkus/commit/486eb8ebd4ddc6d1261421b695b497dd61fa3f94", "message": "Avoid annoying Warning log when Sentry is disabled\n\nThose log are not supposed to be visible when Sentry is disabled:\n```\n2020-02-21 17:13:08,062 WARN  [io.sen.dsn.Dsn] (executor-thread-1) *** Couldn't find a suitable DSN, Sentry operations will do nothing! See documentation: https://docs.sentry.io/clients/java/ ***\n2020-02-21 17:13:08,072 WARN  [io.sen.DefaultSentryClientFactory] (executor-thread-1) No 'stacktrace.app.packages' was configured, this option is highly recommended as it affects stacktrace grouping and display on Sentry. See documentation: https://docs.sentry.io/cl\n```", "committedDate": "2020-02-27T09:18:45Z", "type": "commit"}, {"oid": "57f88d190662585dc5345648f42404711f14774e", "url": "https://github.com/quarkusio/quarkus/commit/57f88d190662585dc5345648f42404711f14774e", "message": "Update Sentry version to 1.7.30", "committedDate": "2020-02-27T09:18:45Z", "type": "commit"}, {"oid": "57f88d190662585dc5345648f42404711f14774e", "url": "https://github.com/quarkusio/quarkus/commit/57f88d190662585dc5345648f42404711f14774e", "message": "Update Sentry version to 1.7.30", "committedDate": "2020-02-27T09:18:45Z", "type": "forcePushed"}]}