{"pr_number": 11967, "pr_title": "Allow to ignore explicit JAX-RS application-classes", "pr_createdAt": "2020-09-08T09:26:48Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/11967", "timeline": [{"oid": "3d3428742cd48ee7c0f2148ae9ec21c19dc18470", "url": "https://github.com/quarkusio/quarkus/commit/3d3428742cd48ee7c0f2148ae9ec21c19dc18470", "message": "Via application.properties, ignore explicit JAX-RS application-classes.\n\nFixes #11966", "committedDate": "2020-09-10T15:15:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAyNjI3Ng==", "url": "https://github.com/quarkusio/quarkus/pull/11967#discussion_r488026276", "bodyText": "The index.getAnnotations call above can be avoided if resteasyConfig.ignoreApplicationClasses is true", "author": "gastaldi", "createdAt": "2020-09-14T15:30:47Z", "path": "extensions/resteasy-server-common/deployment/src/main/java/io/quarkus/resteasy/server/common/deployment/ResteasyServerCommonProcessor.java", "diffHunk": "@@ -182,6 +189,10 @@ public void build(\n \n         Collection<AnnotationInstance> applicationPaths = index.getAnnotations(ResteasyDotNames.APPLICATION_PATH);\n \n+        if (resteasyConfig.ignoreApplicationClasses) {\n+            applicationPaths = Collections.emptySet();\n+        }", "originalCommit": "3d3428742cd48ee7c0f2148ae9ec21c19dc18470", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "28fcc8a134873ccf07388ab569600004db62c861", "url": "https://github.com/quarkusio/quarkus/commit/28fcc8a134873ccf07388ab569600004db62c861", "message": "Via application.properties, ignore explicit JAX-RS application-classes.\n\nFixes #11966", "committedDate": "2020-09-14T18:36:51Z", "type": "forcePushed"}, {"oid": "d92a368ef9a0906f926d8a983d931b59a54e5d0c", "url": "https://github.com/quarkusio/quarkus/commit/d92a368ef9a0906f926d8a983d931b59a54e5d0c", "message": "Via application.properties, ignore explicit JAX-RS application-classes.\n\nFixes #11966", "committedDate": "2020-09-14T18:47:13Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE1NTg1MQ==", "url": "https://github.com/quarkusio/quarkus/pull/11967#discussion_r488155851", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            === Only single JAX-RS application\n          \n          \n            \n            === Only a single JAX-RS application", "author": "gastaldi", "createdAt": "2020-09-14T19:02:25Z", "path": "docs/src/main/asciidoc/rest-json.adoc", "diffHunk": "@@ -552,9 +552,16 @@ to solve this problem.\n \n Configuration via an application-supplied subclass of `Application` is supported, but not required.\n \n+=== Only single JAX-RS application", "originalCommit": "d92a368ef9a0906f926d8a983d931b59a54e5d0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE1NjY0NQ==", "url": "https://github.com/quarkusio/quarkus/pull/11967#discussion_r488156645", "bodyText": "This effectively merges the JAX-RS applications into one\n\nAre you sure? AFAIK this setting will only ignore the existing Application classes, not merge them", "author": "gastaldi", "createdAt": "2020-09-14T19:03:59Z", "path": "docs/src/main/asciidoc/rest-json.adoc", "diffHunk": "@@ -552,9 +552,16 @@ to solve this problem.\n \n Configuration via an application-supplied subclass of `Application` is supported, but not required.\n \n+=== Only single JAX-RS application\n+\n+In contrast to JAX-RS (and RESTeasy) running in a standard servlet-container, Quarkus only supports the deployment of a single JAX-RS application.\n+If multiple JAX-RS `Application` classes are defined, the build will fail with the message `Multiple classes have been annotated with @ApplicationPath which is currently not supported`.\n+\n+If multiple JAX-RS applications are defined, the property `quarkus.resteasy.ignoreApplicationClasses=true` can be used to ignore all explicit `Application` classes. This effectively merges the JAX-RS applications into one and all resources are available via the application-path as defined by `quarkus.resteasy.path` (default: `/`).", "originalCommit": "d92a368ef9a0906f926d8a983d931b59a54e5d0c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODIwNjI4MQ==", "url": "https://github.com/quarkusio/quarkus/pull/11967#discussion_r488206281", "bodyText": "Merging applications in the sense that all resources are merged/collected into one application.\nQuarkus collects all rest resource classes and makes them available under either the explicit application or, if no explicit application is defined, it will make all resources available under the path as defined via quarkus.resteasy.path (lets call this \"implicit application\").\nSo, if there are multiple Jax-rs application-classes and they are all ignored, then it will effectively merge them into this implicit application.\nIn regular JAX-RS the, the application-class' getClasses method can be overriden to specify which resource classes belong to which application; this method is not used in Quarkus; so all resources are just collected into whatever rest application is defined; explicit or implicit.", "author": "38leinaD", "createdAt": "2020-09-14T20:39:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE1NjY0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODIwOTM5MA==", "url": "https://github.com/quarkusio/quarkus/pull/11967#discussion_r488209390", "bodyText": "Yes, I understand that, but I am not sure if when we say that this property merges the JAX-RS applications into one would not confuse the reader (but maybe that's just me \ud83d\ude09 )", "author": "gastaldi", "createdAt": "2020-09-14T20:45:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE1NjY0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQwODQ3Mg==", "url": "https://github.com/quarkusio/quarkus/pull/11967#discussion_r488408472", "bodyText": "Ok, i have been talking about \"merging jax-rs applications\" to much. I have rephrased it:\nIf multiple JAX-RS applications are defined, the property quarkus.resteasy.ignoreApplicationClasses=true can be used to ignore all explicit Application classes. This makes all resource-classes available via the application-path as defined by quarkus.resteasy.path (default: /).", "author": "38leinaD", "createdAt": "2020-09-15T06:08:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE1NjY0NQ=="}], "type": "inlineReview"}, {"oid": "75a74d8623ad9c8301dbd5118532693169fc3f11", "url": "https://github.com/quarkusio/quarkus/commit/75a74d8623ad9c8301dbd5118532693169fc3f11", "message": "Via application.properties, ignore explicit JAX-RS application-classes.\n\nFixes #11966", "committedDate": "2020-09-15T06:06:37Z", "type": "forcePushed"}, {"oid": "8bf33cb125285194f6e03ea595fe245409e8ed48", "url": "https://github.com/quarkusio/quarkus/commit/8bf33cb125285194f6e03ea595fe245409e8ed48", "message": "Via application.properties, ignore explicit JAX-RS application-classes.\n\nFixes #11966", "committedDate": "2020-09-27T07:18:01Z", "type": "commit"}, {"oid": "8bf33cb125285194f6e03ea595fe245409e8ed48", "url": "https://github.com/quarkusio/quarkus/commit/8bf33cb125285194f6e03ea595fe245409e8ed48", "message": "Via application.properties, ignore explicit JAX-RS application-classes.\n\nFixes #11966", "committedDate": "2020-09-27T07:18:01Z", "type": "forcePushed"}]}