{"pr_number": 7737, "pr_title": "Do not turn fields into accessors in Hibernate ORM entity constructors", "pr_createdAt": "2020-03-10T14:46:51Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7737", "timeline": [{"oid": "b855cd89b5717d78370baaa6a356bff94f81949c", "url": "https://github.com/quarkusio/quarkus/commit/b855cd89b5717d78370baaa6a356bff94f81949c", "message": "Fix for #7721: do not turn fields into accessors in constructors", "committedDate": "2020-03-10T14:55:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzNTM4OQ==", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390435389", "bodyText": "Should the FIXME be removed?", "author": "Sanne", "createdAt": "2020-03-10T16:13:55Z", "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "diffHunk": "@@ -28,6 +28,10 @@ public void visitFieldInsn(int opcode, String owner, String fieldName, String de\n         // FIXME: do not substitute to accessors to this or super fields inside constructor?", "originalCommit": "b855cd89b5717d78370baaa6a356bff94f81949c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ0MTI2OQ==", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390441269", "bodyText": "ah yes :)", "author": "FroMage", "createdAt": "2020-03-10T16:22:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzNTM4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzODg1MQ==", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390438851", "bodyText": "the code owner.replace('/', '.')) could be extracted since you need it twice?\nWhile at it, might be useful to extract the regex into a constant? Entirely optional of course: I'm aware I'm nitpicking.", "author": "Sanne", "createdAt": "2020-03-10T16:18:55Z", "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "diffHunk": "@@ -28,6 +28,10 @@ public void visitFieldInsn(int opcode, String owner, String fieldName, String de\n         // FIXME: do not substitute to accessors to this or super fields inside constructor?\n         if ((opcode == Opcodes.GETFIELD\n                 || opcode == Opcodes.PUTFIELD)\n+                // if we're in the constructor, do not replace field accesses to this type and its supertypes\n+                // otherwise we risk running setters that depend on initialisation\n+                && (!this.methodName.equals(\"<init>\")\n+                        || !targetIsInHierarchy(this.owner.replace('/', '.'), owner.replace('/', '.')))", "originalCommit": "b855cd89b5717d78370baaa6a356bff94f81949c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ0MTE1OA==", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390441158", "bodyText": "It's not a regex ;) But I have moved it up.", "author": "FroMage", "createdAt": "2020-03-10T16:22:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzODg1MQ=="}], "type": "inlineReview"}, {"oid": "2a24f0f4569d0ca759a41359d98a9847dc44f5ea", "url": "https://github.com/quarkusio/quarkus/commit/2a24f0f4569d0ca759a41359d98a9847dc44f5ea", "message": "Fix for #7721: do not turn fields into accessors in constructors", "committedDate": "2020-03-10T16:21:44Z", "type": "commit"}, {"oid": "2a24f0f4569d0ca759a41359d98a9847dc44f5ea", "url": "https://github.com/quarkusio/quarkus/commit/2a24f0f4569d0ca759a41359d98a9847dc44f5ea", "message": "Fix for #7721: do not turn fields into accessors in constructors", "committedDate": "2020-03-10T16:21:44Z", "type": "forcePushed"}]}