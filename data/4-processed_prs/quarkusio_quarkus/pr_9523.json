{"pr_number": 9523, "pr_title": "Add ${maven.home} to all surefire and failsafe executions ", "pr_createdAt": "2020-05-21T22:10:19Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9523", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r429060046", "bodyText": "This is a little strongly worded and would scare users who don't really understand what that configuration usually does (which is pretty much nothing by default).\nHow about we word it a in way that lets users know that if they have changed any settings in conf/settings.xml, then either MAVEN_HOME or the maven.home system property needs to be set?", "author": "geoand", "createdAt": "2020-05-22T06:11:33Z", "path": "docs/src/main/asciidoc/maven-tooling.adoc", "diffHunk": "@@ -7,6 +7,14 @@ https://github.com/quarkusio/quarkus/tree/master/docs/src/main/asciidoc\n \n include::./attributes.adoc[]\n \n+[[prerequisites]]\n+== Prerequisites\n+\n+A working link:https://maven.apache.org/install.html[installation of Apache Maven] is required.\n+\n+IMPORTANT: Make sure that the environment variable `MAVEN_HOME` is pointing to your Maven installation. +\n+Otherwise _none_ of the \"global\" settings from `conf/settings.xml` will be picked up by Quarkus.", "originalCommit": "43cb56c30046857db47e58e3b039bf7428305c82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMzMjI4NQ==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r429332285", "bodyText": "Ok, I'll try.\nIf we start mentioning maven.home here we should also implement @aloubyansky's idea of generating a systemPropertyVariables entry, no?", "author": "famod", "createdAt": "2020-05-22T16:09:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMzNjgxNQ==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r429336815", "bodyText": "Yeah, that makes perfect sense", "author": "geoand", "createdAt": "2020-05-22T16:17:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMzODQ4Mg==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r429338482", "bodyText": "So I'll take a stab at this. Once I'm done someone with a IntelliJ installation should check how it reacts to ${maven.home} in systemPropertyVariables.", "author": "famod", "createdAt": "2020-05-22T16:21:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ0ODAzNw==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r429448037", "bodyText": "Do we want to have this new systemPropertyVariable everywhere where we already have the LogManager configured?\n$ grep -Rl --exclude-dir=target '<java.util.logging.manager>org.jboss.logmanager.LogManager</java.util.logging.manager>' .\n./build-parent/pom.xml\n./core/builder/pom.xml\n./devtools/aesh/dependency-reduced-pom.xml\n./devtools/aesh/pom.xml\n./devtools/platform-descriptor-json/src/main/resources/templates/basic-rest/java/pom.xml-template.ftl\n./devtools/platform-descriptor-json/src/main/resources/templates/basic-rest/kotlin/pom.xml-template.ftl\n./devtools/platform-descriptor-json/src/main/resources/templates/basic-rest/scala/pom.xml-template.ftl\n./docs/src/main/asciidoc/building-my-first-extension.adoc\n./docs/src/main/asciidoc/getting-started-testing.adoc\n./docs/src/main/asciidoc/getting-started.adoc\n./docs/src/main/asciidoc/logging.adoc\n./docs/src/main/asciidoc/tests-with-coverage.adoc\n./extensions/amazon-lambda/maven-archetype/src/main/resources/archetype-resources/pom.xml\n./extensions/amazon-lambda-http/maven-archetype/src/main/resources/archetype-resources/pom.xml\n./extensions/azure-functions-http/maven-archetype/src/main/resources/archetype-resources/pom.xml\n./extensions/funqy/funqy-amazon-lambda/maven-archetype/src/main/resources/archetype-resources/pom.xml\n./extensions/grpc/deployment/pom.xml\n./independent-projects/tools/common/src/test/resources/templates/basic-rest/java/pom.xml-template.ftl\n./independent-projects/tools/common/src/test/resources/templates/basic-rest/kotlin/pom.xml-template.ftl\n./independent-projects/tools/common/src/test/resources/templates/basic-rest/scala/pom.xml-template.ftl\n./integration-tests/bootstrap-config/application/pom.xml\n./integration-tests/container-image/maven-invoker-way/src/it/container-build-docker/pom.xml\n./integration-tests/container-image/maven-invoker-way/src/it/container-build-jib/pom.xml\n./integration-tests/container-image/maven-invoker-way/src/it/container-build-multiple-tags-docker/pom.xml\n./integration-tests/container-image/maven-invoker-way/src/it/container-build-multiple-tags-jib/pom.xml\n./integration-tests/container-image/maven-invoker-way/src/it/container-image-push/pom.xml\n./integration-tests/grpc-health/pom.xml\n./integration-tests/grpc-interceptors/pom.xml\n./integration-tests/grpc-mutual-auth/pom.xml\n./integration-tests/hibernate-orm-panache/pom.xml\n./integration-tests/kubernetes/maven-invoker-way/src/it/kubernetes-docker-build-and-deploy/pom.xml\n./integration-tests/kubernetes/maven-invoker-way/src/it/kubernetes-jib-build-and-deploy/pom.xml\n./integration-tests/kubernetes/maven-invoker-way/src/it/kubernetes-with-existing-manifest/pom.xml\n./integration-tests/kubernetes/maven-invoker-way/src/it/openshift-s2i-build-and-deploy/pom.xml\n./integration-tests/kubernetes/src/it/openshift-s2i-build-and-deploy/pom.xml\n./integration-tests/maven/src/test/resources/projects/multimodule/runner/pom.xml\n./integration-tests/maven/src/test/resources/projects/multimodule-revision-prop/runner/pom.xml\n./integration-tests/maven/src/test/resources/projects/property-overrides/runner/pom.xml\n./integration-tests/picocli/pom.xml\n./integration-tests/spring-data-jpa/pom.xml\n./integration-tests/vault/pom.xml\n\nplatform-descriptor-json is obvious but I am not sure about:\n\nall docs\nQuarkus internal pom.xml files\n\nWould be more consistent to do it for all, though.", "author": "famod", "createdAt": "2020-05-22T20:55:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1NDg3OQ==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r429454879", "bodyText": "I'd say yes. /independent-projects/tools/common/src/test/resources/templates/basic-rest/* are formal templates, could be excluded.", "author": "aloubyansky", "createdAt": "2020-05-22T21:18:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1NzAxOA==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r429457018", "bodyText": "Phew, I had a quick look at some of those pom.xml (especially under integration-tests) and it all seems a bit inconsistent.\nWhy are so many integration-tests-projects redefining maven-surefire-plugin?\nAt least one of them is also passing the LogManager via maven-failsafe-plugin.\nI'd say this should be cleaned up first in a separate PR. WDYT?", "author": "famod", "createdAt": "2020-05-22T21:26:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ2MTQ4Ng==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r429461486", "bodyText": "It could surely be reorganized to not repeat common config. If you are up for it, sure :)", "author": "aloubyansky", "createdAt": "2020-05-22T21:34:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUxMzYzMA==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r429513630", "bodyText": "A cleanup is certainly welcome if you want to take up the task \ud83d\ude09", "author": "geoand", "createdAt": "2020-05-23T04:39:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgxNzE0Mg==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r431817142", "bodyText": "@geoand\n\nThis is a little strongly worded and would scare users who don't really understand what that configuration usually does (which is pretty much nothing by default).\nHow about we word it a in way that lets users know that if they have changed any settings in conf/settings.xml, then either MAVEN_HOME or the maven.home system property needs to be set?\n\nThat initial comment has just been resolved: The section is now gone. \ud83d\ude04", "author": "famod", "createdAt": "2020-05-28T13:02:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDA0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgxNzk2MA==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r431817960", "bodyText": "I hope this link works. I wasn't abe to test this properly.", "author": "famod", "createdAt": "2020-05-28T13:03:57Z", "path": "docs/src/main/asciidoc/logging.adoc", "diffHunk": "@@ -247,33 +248,8 @@ test {\n \tsystemProperty \"java.util.logging.manager\", \"org.jboss.logmanager.LogManager\"\n }\n ----\n-== Running `@QuarkusTest` from an IDE\n \n-Most IDEs offer the possibility to run a selected class as JUnit test directly, in which case the above workaround will not be applied. You will need to apply it in the settings of your chosen IDE.\n-\n-=== Eclipse separate JRE definition\n-\n-Copy your current \"Installed JRE\" definition into a new one, where you will add the workaround as a new VM argument \n-`-Djava.util.logging.manager=org.jboss.logmanager.LogManager`. Use this JRE definition as your Quarkus project targeted runtime and the workaround will be applied to any \"Run as JUnit\" configuration.\n-\n-=== VSCode \"run with\" configuration\n-\n-The `settings.json` placed in the root of your project directory or in the workspace will need the workaround in your test configuration:\n-[source, json]\n-----\n-\"java.test.config\": [\n-    {\n-        \"name\": \"quarkusConfiguration\",\n-        \"vmargs\": [ \"-Djava.util.logging.manager=org.jboss.logmanager.LogManager ...\" ],\n-        ...\n-    },\n-  ...\n-]\n-----\n-\n-=== IntelliJ JUnit template\n-\n-Nothing needed in IntelliJ because the IDE will pick the `systemPropertyVariables` from the surefire plugin configuration in `pom.xml`.\n+See also: <<getting-started-testing.adoc#test-from-ide,Running `@QuarkusTest` from an IDE>>", "originalCommit": "aa865463ef04ee41770ce923384dc7ebf7f69264", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgyNDM0Ng==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r431824346", "bodyText": "It should, but I'm not an adoc expert. @gastaldi perhaps?", "author": "geoand", "createdAt": "2020-05-28T13:13:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgxNzk2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgyODM0Ng==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r431828346", "bodyText": "Sorry, I'm no adoc expert either :)\nTry building the project and see the output in docs/target/generated-docs", "author": "gastaldi", "createdAt": "2020-05-28T13:19:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgxNzk2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTg0MDUwNg==", "url": "https://github.com/quarkusio/quarkus/pull/9523#discussion_r431840506", "bodyText": "Try building the project and see the output in docs/target/generated-docs\n\n\ud83e\udd26 Sure, silly me. Just checked: It works!", "author": "famod", "createdAt": "2020-05-28T13:37:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgxNzk2MA=="}], "type": "inlineReview"}, {"oid": "b352b4a38c3d7efa53f4685585f40ba46f95c015", "url": "https://github.com/quarkusio/quarkus/commit/b352b4a38c3d7efa53f4685585f40ba46f95c015", "message": "Add maven.home to surefire/failsafe systemPropertyVariables\n\nAnd add LogManager where \"missing\".", "committedDate": "2020-05-28T20:03:57Z", "type": "commit"}, {"oid": "247a169b09ce79daeda0bfbcf470111a701e8d47", "url": "https://github.com/quarkusio/quarkus/commit/247a169b09ce79daeda0bfbcf470111a701e8d47", "message": "Add missing return code checks to CreateProjectMojoIT", "committedDate": "2020-05-28T20:03:57Z", "type": "commit"}, {"oid": "e77829c7d174f107c38cef9453df15e5639ca846", "url": "https://github.com/quarkusio/quarkus/commit/e77829c7d174f107c38cef9453df15e5639ca846", "message": "Fix MojoTestBase.initEmptyProject() non-empty dir on deletion error", "committedDate": "2020-05-28T20:03:57Z", "type": "commit"}, {"oid": "cc83379664f15dcd86006018e0ac78ecd75c89b7", "url": "https://github.com/quarkusio/quarkus/commit/cc83379664f15dcd86006018e0ac78ecd75c89b7", "message": "Document maven.home system property", "committedDate": "2020-05-28T20:03:57Z", "type": "commit"}]}