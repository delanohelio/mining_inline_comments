{"pr_number": 11090, "pr_title": "Print the URL where the Openshift application can be found", "pr_createdAt": "2020-07-30T10:01:35Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/11090", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwNzQ1Ng==", "url": "https://github.com/quarkusio/quarkus/pull/11090#discussion_r462907456", "bodyText": "Two things:\n\nThis would print all deployed routes. Most of the time, there will be just 1, but wouldn't it be better to print only the application's route? That is, the one with the same name as all the other generated resources.\nIf TLS is configured in the route, shouldn't we print https://...?", "author": "Ladicek", "createdAt": "2020-07-30T10:37:53Z", "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeployer.java", "diffHunk": "@@ -192,6 +196,21 @@ private DeploymentResultBuildItem deploy(DeploymentTargetEntry deploymentTarget,\n \n     }\n \n+    private void printExposeInformation(KubernetesClient client, KubernetesList list) {\n+        List<HasMetadata> items = list.getItems();\n+        for (HasMetadata item : items) {\n+            if (Constants.ROUTE_API_GROUP.equals(item.getApiVersion()) && Constants.ROUTE.equals(item.getKind())) {\n+                try {\n+                    DefaultOpenShiftClient openShiftClient = new DefaultOpenShiftClient(client.getConfiguration());\n+                    Route route = openShiftClient.routes().withName(item.getMetadata().getName()).get();\n+                    log.infov(\"The deployed application can be accessed at: http://{0}\", route.getSpec().getHost());", "originalCommit": "bf1b9ee148faf452dd7e534f77fd73a85d912d39", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwNzk0Ng==", "url": "https://github.com/quarkusio/quarkus/pull/11090#discussion_r462907946", "bodyText": "Ah, also -- new DefaultOpenShiftClient for each deployed route?\nAnd do we even need to create an OpenShiftClient when we already have the KubernetesClient? Isn't it enough to .adapt?", "author": "Ladicek", "createdAt": "2020-07-30T10:38:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwNzQ1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwOTk4Mg==", "url": "https://github.com/quarkusio/quarkus/pull/11090#discussion_r462909982", "bodyText": "I don't see how that can happen - as the code reads the Route from the generated manifest\nGood idea. I assume just checking if tls is part of the spec would suffice?", "author": "geoand", "createdAt": "2020-07-30T10:43:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwNzQ1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkxMDMyNQ==", "url": "https://github.com/quarkusio/quarkus/pull/11090#discussion_r462910325", "bodyText": "And do we even need to create an OpenShiftClient when we already have the KubernetesClient? Isn't it enough to .adapt?\n\nThis one is easy, I didn't know about it :P", "author": "geoand", "createdAt": "2020-07-30T10:43:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwNzQ1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkxMDY2MA==", "url": "https://github.com/quarkusio/quarkus/pull/11090#discussion_r462910660", "bodyText": "If I understand correctly, this can happen when you put \"supplementary applications\" into src/main/kubernetes.\nI think so, yes.", "author": "Ladicek", "createdAt": "2020-07-30T10:44:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwNzQ1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkxMTIzOA==", "url": "https://github.com/quarkusio/quarkus/pull/11090#discussion_r462911238", "bodyText": "Interesting... I didn't think of that one. Let's be defensive", "author": "geoand", "createdAt": "2020-07-30T10:45:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwNzQ1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkxMzM1Nw==", "url": "https://github.com/quarkusio/quarkus/pull/11090#discussion_r462913357", "bodyText": "Actually I think both approaches may make sense.\nIf there's just one route, print it the way you do now.\nIf there's more, than first print the \"other\" routes, with a slightly different message (e.g. \"Deployment xxx can be accessed at: ...\"), and print the application's route at the end, with current message.\nYour call :-)", "author": "Ladicek", "createdAt": "2020-07-30T10:50:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwNzQ1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkyMzYxNQ==", "url": "https://github.com/quarkusio/quarkus/pull/11090#discussion_r462923615", "bodyText": "Let's keep the logs are clutter free as possible \ud83d\ude06 .\nI went with only printing the application Route", "author": "geoand", "createdAt": "2020-07-30T11:12:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkwNzQ1Ng=="}], "type": "inlineReview"}, {"oid": "e8f41653eb7c3466a38ca2281afdf077ed7e30c4", "url": "https://github.com/quarkusio/quarkus/commit/e8f41653eb7c3466a38ca2281afdf077ed7e30c4", "message": "Print the URL where the Openshift application can be found", "committedDate": "2020-07-30T11:11:11Z", "type": "commit"}, {"oid": "e8f41653eb7c3466a38ca2281afdf077ed7e30c4", "url": "https://github.com/quarkusio/quarkus/commit/e8f41653eb7c3466a38ca2281afdf077ed7e30c4", "message": "Print the URL where the Openshift application can be found", "committedDate": "2020-07-30T11:11:11Z", "type": "forcePushed"}]}