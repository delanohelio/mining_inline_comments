{"pr_number": 10305, "pr_title": "Qute - remove standalone lines by default", "pr_createdAt": "2020-06-26T14:06:21Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10305", "timeline": [{"oid": "c274fbb1c4085e863b6f6b068ed0ca5264c7b7ee", "url": "https://github.com/quarkusio/quarkus/commit/c274fbb1c4085e863b6f6b068ed0ca5264c7b7ee", "message": "Qute - remove standalone lines by default\n\n- resolves #8753", "committedDate": "2020-06-26T14:10:10Z", "type": "forcePushed"}, {"oid": "b2f1949d23b5a20506c2aa19cde9f50b943f3ce9", "url": "https://github.com/quarkusio/quarkus/commit/b2f1949d23b5a20506c2aa19cde9f50b943f3ce9", "message": "Qute - remove standalone lines by default\n\n- resolves #8753", "committedDate": "2020-06-29T07:25:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg3NjE5MQ==", "url": "https://github.com/quarkusio/quarkus/pull/10305#discussion_r446876191", "bodyText": "I think adding a sentence mentioning, what disabling such a behaviour can result in, would be a good thing. I see that there's an example output a few lines down, which shows what happens, but explicitly stating something like  \"If this property is disabled, then each standalone line will result in a new line character, in the generated output\" might be helpful", "author": "jaikiran", "createdAt": "2020-06-29T09:00:32Z", "path": "docs/src/main/asciidoc/qute-reference.adoc", "diffHunk": "@@ -124,6 +124,55 @@ A closing curly bracket (`}`) is ignored if not inside an expression/tag.\n \n TIP: It is also possible to use escape sequences `\\{` and `\\}` to insert delimiters in the text. In fact, an escape sequence is usually only needed for the start delimiter, ie. `\\\\{foo}` will be rendered as `{foo}` (no evaluation will happen).\n \n+=== Removing Standalone Lines From the Template\n+\n+By default, the parser removes standalone lines from the template output.\n+A *standalone line* is a line that contains only section tags (e.g. `{#each}` and `{/each}`), parameter declarations (e.g. `{@org.acme.Foo foo}`) and whitespace characters.\n+The default behavior can be disabled by setting the property `quarkus.qute.remove-standalone-lines` to `false`.", "originalCommit": "b2f1949d23b5a20506c2aa19cde9f50b943f3ce9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg3ODAyMw==", "url": "https://github.com/quarkusio/quarkus/pull/10305#discussion_r446878023", "bodyText": "Yep, that makes sense. Except that it's not \"a new line character\" but \"a bunch of whitespace chars resulting in a new line\" ;-).", "author": "mkouba", "createdAt": "2020-06-29T09:03:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg3NjE5MQ=="}], "type": "inlineReview"}, {"oid": "c0eaba44fe0964061adea76ab26a97b5e54f728d", "url": "https://github.com/quarkusio/quarkus/commit/c0eaba44fe0964061adea76ab26a97b5e54f728d", "message": "Qute - remove standalone lines by default\n\n- resolves #8753", "committedDate": "2020-06-29T13:37:40Z", "type": "forcePushed"}, {"oid": "291a50af6bd36e7a49df4318c57e5d601f1162b4", "url": "https://github.com/quarkusio/quarkus/commit/291a50af6bd36e7a49df4318c57e5d601f1162b4", "message": "Qute - remove standalone lines by default\n\n- resolves #8753", "committedDate": "2020-06-30T08:13:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUzNTUxNQ==", "url": "https://github.com/quarkusio/quarkus/pull/10305#discussion_r447535515", "bodyText": "So, this appears to validate that the description:\n\nA standalone line is a line that contains only section tags (e.g. {#each} and {/each}), parameter declarations (e.g. {@org.acme.Foo foo}) and whitespace characters.\n\nhas a confusing and. I initially thought this applied to empty lines as well, but this test says it does not.\nPerhaps the following is less confusing for people like me?\n\nA standalone line is a line that contains at least one of: section tags (e.g. {#each} and {/each}) or parameter declarations (e.g. {@org.acme.Foo foo}), ignoring any whitespace characters on the same line.\n\nIt's not perfect yet, though so if you find better, I'll take it :)", "author": "FroMage", "createdAt": "2020-06-30T09:13:55Z", "path": "independent-projects/qute/core/src/test/java/io/quarkus/qute/ParserTest.java", "diffHunk": "@@ -180,6 +180,18 @@ public void testCdata() {\n         assertEquals(\"Hello world <strong>\", engine.parse(\"Hello {name} {[<strong>]}\").data(\"name\", \"world\").render());\n     }\n \n+    @Test\n+    public void testRemoveStandaloneLines() {\n+        Engine engine = Engine.builder().addDefaults().removeStandaloneLines(true).build();\n+        String content = \"{@java.lang.String foo}\\n\" // -> standalone\n+                + \"\\n\"", "originalCommit": "291a50af6bd36e7a49df4318c57e5d601f1162b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUzODc1Mg==", "url": "https://github.com/quarkusio/quarkus/pull/10305#discussion_r447538752", "bodyText": "Yeah, as I read it it's confusing... let's fix it!", "author": "mkouba", "createdAt": "2020-06-30T09:19:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUzNTUxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU4NTk5MA==", "url": "https://github.com/quarkusio/quarkus/pull/10305#discussion_r447585990", "bodyText": "Is it better now?", "author": "mkouba", "createdAt": "2020-06-30T10:38:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUzNTUxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUzNTk4Mw==", "url": "https://github.com/quarkusio/quarkus/pull/10305#discussion_r447535983", "bodyText": "Here I'm missing an example of a line with whitespace but no section/parameter, to show that they get kept.", "author": "FroMage", "createdAt": "2020-06-30T09:14:44Z", "path": "docs/src/main/asciidoc/qute-reference.adoc", "diffHunk": "@@ -124,6 +124,56 @@ A closing curly bracket (`}`) is ignored if not inside an expression/tag.\n \n TIP: It is also possible to use escape sequences `\\{` and `\\}` to insert delimiters in the text. In fact, an escape sequence is usually only needed for the start delimiter, ie. `\\\\{foo}` will be rendered as `{foo}` (no evaluation will happen).\n \n+=== Removing Standalone Lines From the Template\n+\n+By default, Qute parser removes standalone lines from the template output.\n+A *standalone line* is a line that contains only section tags (e.g. `{#each}` and `{/each}`), parameter declarations (e.g. `{@org.acme.Foo foo}`) and whitespace characters.\n+The default behavior can be disabled by setting the property `quarkus.qute.remove-standalone-lines` to `false`.\n+In this case, all whitespace characters from a standalone line will be printed to the output.\n+\n+.Template Example\n+[source,html]\n+----\n+<html>\n+  <body>\n+     <ul>\n+     {#for item in items} <1>\n+       <li>{item.name}</li> <2>\n+     {/for} <3>\n+     </ul>\n+   <body>\n+</html>\n+----\n+<1> This is a standalone line and will be removed.\n+<2> This is not a standalone line as it contains non-whitespace characters and an expression.\n+<3> This is a standalone line and will be removed.", "originalCommit": "291a50af6bd36e7a49df4318c57e5d601f1162b4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b9a670bf910e9e4d6383fdd32a3bbf59a1be9c05", "url": "https://github.com/quarkusio/quarkus/commit/b9a670bf910e9e4d6383fdd32a3bbf59a1be9c05", "message": "Qute - remove standalone lines by default\n\n- resolves #8753", "committedDate": "2020-06-30T10:38:18Z", "type": "commit"}, {"oid": "b9a670bf910e9e4d6383fdd32a3bbf59a1be9c05", "url": "https://github.com/quarkusio/quarkus/commit/b9a670bf910e9e4d6383fdd32a3bbf59a1be9c05", "message": "Qute - remove standalone lines by default\n\n- resolves #8753", "committedDate": "2020-06-30T10:38:18Z", "type": "forcePushed"}]}