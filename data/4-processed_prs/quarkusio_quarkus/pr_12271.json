{"pr_number": 12271, "pr_title": "Deprecate QuarkusTestBeforeAllCallback", "pr_createdAt": "2020-09-22T20:42:11Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12271", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAyNzgzNw==", "url": "https://github.com/quarkusio/quarkus/pull/12271#discussion_r493027837", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            WARNING: `io.quarkus.test.junit.callback.QuarkusTestAfterConstructCallback` has been deprecated in favor of `io.quarkus.test.junit.callback.QuarkusTestAfterConstructCallback` and will be removed in future releases of Quarkus\n          \n          \n            \n            WARNING: `io.quarkus.test.junit.callback.QuarkusTestBeforeAllCallback` has been deprecated in favor of `io.quarkus.test.junit.callback.QuarkusTestAfterConstructCallback` and will be removed in future releases of Quarkus", "author": "gastaldi", "createdAt": "2020-09-22T20:55:00Z", "path": "docs/src/main/asciidoc/getting-started-testing.adoc", "diffHunk": "@@ -436,10 +436,12 @@ transaction, but roll it back once the test method is complete to revert any dat\n \n Alternatively or additionally to an interceptor, you can enrich *all* your `@QuarkusTest` classes by implementing the following callback interfaces:\n \n-* `io.quarkus.test.junit.callback.QuarkusTestBeforeAllCallback`\n+* `io.quarkus.test.junit.callback.QuarkusTestAfterConstructCallback`\n * `io.quarkus.test.junit.callback.QuarkusTestBeforeEachCallback`\n * `io.quarkus.test.junit.callback.QuarkusTestAfterEachCallback`\n \n+WARNING: `io.quarkus.test.junit.callback.QuarkusTestAfterConstructCallback` has been deprecated in favor of `io.quarkus.test.junit.callback.QuarkusTestAfterConstructCallback` and will be removed in future releases of Quarkus", "originalCommit": "b339124810258171866e2f825e5001fb475debda", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA0MDg4MA==", "url": "https://github.com/quarkusio/quarkus/pull/12271#discussion_r493040880", "bodyText": "I suppose we cannot (yet) log something here? If not, can we when calling afterConstruct?", "author": "famod", "createdAt": "2020-09-22T21:21:05Z", "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/QuarkusTestExtension.java", "diffHunk": "@@ -329,14 +331,20 @@ private void populateCallbacks(ClassLoader classLoader) throws ClassNotFoundExce\n         // make sure that we start over everytime we populate the callbacks\n         // otherwise previous runs of QuarkusTest (with different TestProfile values can leak into the new run)\n         quarkusTestMethodContextClass = null;\n-        beforeAllCallbacks = new ArrayList<>();\n+        afterConstructCallbacks = new ArrayList<>();\n+        legacyAfterConstructCallbacks = new ArrayList<>();\n         beforeEachCallbacks = new ArrayList<>();\n         afterEachCallbacks = new ArrayList<>();\n \n-        ServiceLoader<?> quarkusTestBeforeAllLoader = ServiceLoader\n+        ServiceLoader<?> quarkusTestAfterConstructLoader = ServiceLoader\n+                .load(Class.forName(QuarkusTestAfterConstructCallback.class.getName(), false, classLoader), classLoader);\n+        for (Object quarkusTestAfterConstructCallback : quarkusTestAfterConstructLoader) {\n+            afterConstructCallbacks.add(quarkusTestAfterConstructCallback);\n+        }\n+        ServiceLoader<?> quarkusTestLegacyAfterConstructLoader = ServiceLoader\n                 .load(Class.forName(QuarkusTestBeforeAllCallback.class.getName(), false, classLoader), classLoader);\n-        for (Object quarkusTestBeforeAllCallback : quarkusTestBeforeAllLoader) {\n-            beforeAllCallbacks.add(quarkusTestBeforeAllCallback);\n+        for (Object quarkusTestLegacyAfterConstructCallback : quarkusTestLegacyAfterConstructLoader) {\n+            legacyAfterConstructCallbacks.add(quarkusTestLegacyAfterConstructCallback);", "originalCommit": "b339124810258171866e2f825e5001fb475debda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE5NTY2NQ==", "url": "https://github.com/quarkusio/quarkus/pull/12271#discussion_r493195665", "bodyText": "I've never been able to log anything from the extension exception with System.out...", "author": "geoand", "createdAt": "2020-09-23T04:51:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA0MDg4MA=="}], "type": "inlineReview"}, {"oid": "2515e9545f56a313df1502b8e5b7a0b5f9839373", "url": "https://github.com/quarkusio/quarkus/commit/2515e9545f56a313df1502b8e5b7a0b5f9839373", "message": "Deprecate QuarkusTestBeforeAllCallback\n\nIntroduce the properly named QuarkusTestAfterConstructCallback\nin it's place.\n\nFixes: #12250", "committedDate": "2020-09-23T04:49:48Z", "type": "commit"}, {"oid": "2515e9545f56a313df1502b8e5b7a0b5f9839373", "url": "https://github.com/quarkusio/quarkus/commit/2515e9545f56a313df1502b8e5b7a0b5f9839373", "message": "Deprecate QuarkusTestBeforeAllCallback\n\nIntroduce the properly named QuarkusTestAfterConstructCallback\nin it's place.\n\nFixes: #12250", "committedDate": "2020-09-23T04:49:48Z", "type": "forcePushed"}]}