{"pr_number": 10492, "pr_title": "Make Spring Security play with @TestSecurity", "pr_createdAt": "2020-07-06T10:34:35Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10492", "timeline": [{"oid": "b158bd3660c6606ff0c95de691a64202a28382d4", "url": "https://github.com/quarkusio/quarkus/commit/b158bd3660c6606ff0c95de691a64202a28382d4", "message": "Make Spring Security play with @TestSecurity\n\nFollows up on: #10487\nResolves: #10490", "committedDate": "2020-07-06T10:51:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE1MTMzMg==", "url": "https://github.com/quarkusio/quarkus/pull/10492#discussion_r450151332", "bodyText": "Maybe clearly talk about security context mocking as it's not testing security features but tesing secured features.", "author": "loicmathieu", "createdAt": "2020-07-06T11:13:49Z", "path": "docs/src/main/asciidoc/getting-started-testing.adoc", "diffHunk": "@@ -698,6 +698,10 @@ public class GreetingResourceTest {\n \n If you are using the `quarkus-hibernate-orm-panache` or `quarkus-mongodb-panache` extensions, check out the link:hibernate-orm-panache#mocking[Hibernate ORM with Panache Mocking] and link:mongodb-panache#mocking[MongoDB with Panache Mocking] documentation for the easiest way to mock your data access.\n \n+== Testing Security\n+\n+If you are using Quarkus Security, check out the link:security.adoc#testing-security[Testing Security] section for information on how to easily test security features of the application.", "originalCommit": "b158bd3660c6606ff0c95de691a64202a28382d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE1NzkwNQ==", "url": "https://github.com/quarkusio/quarkus/pull/10492#discussion_r450157905", "bodyText": "I don't want to get too technical here and confuse users, just to make the capability known", "author": "geoand", "createdAt": "2020-07-06T11:28:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE1MTMzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU1ODQyNg==", "url": "https://github.com/quarkusio/quarkus/pull/10492#discussion_r450558426", "bodyText": "So this would only be an issue for basic auth, as it is the fallback if no other authentication mechanisms are defined. Because it uses @DefaultBean installing the test authentication provider will disable the basic auth mechanism. Can you change this slightly to explain that it is only an issue with 'implicit' basic auth (i.e. when no auth mechanisms have been explicitly configured).", "author": "stuartwdouglas", "createdAt": "2020-07-07T01:16:14Z", "path": "docs/src/main/asciidoc/security.adoc", "diffHunk": "@@ -456,5 +457,15 @@ void someTestMethod() {\n ----\n \n This will run the test with an identity with the given username and roles. Note that these can be combined, so you can\n-disable authorisation and also provide an identity to run the test under, which can be userful if the endpoint expects an\n-identity to be present.\n\\ No newline at end of file\n+disable authorization while also providing an identity to run the test under, which can be useful if the endpoint expects an\n+identity to be present.\n+\n+[WARNING]\n+====\n+The feature is only available for `@QuarkusTest` and will **not** work on a `@NativeImageTest`.\n+====\n+\n+=== Mixing security tests\n+\n+If it becomes necessary to test security features using both `@TestSecurity` and a real authentication mechanism (like Basic Auth), then that authentication mechanism", "originalCommit": "b158bd3660c6606ff0c95de691a64202a28382d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDYyOTk4NA==", "url": "https://github.com/quarkusio/quarkus/pull/10492#discussion_r450629984", "bodyText": "Sure yeah", "author": "geoand", "createdAt": "2020-07-07T06:06:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU1ODQyNg=="}], "type": "inlineReview"}, {"oid": "99d8daba1f116bf4aac2e8233a6628af4e8053a2", "url": "https://github.com/quarkusio/quarkus/commit/99d8daba1f116bf4aac2e8233a6628af4e8053a2", "message": "Make Spring Security play with @TestSecurity\n\nFollows up on: #10487\nResolves: #10490", "committedDate": "2020-07-07T06:10:38Z", "type": "commit"}, {"oid": "99d8daba1f116bf4aac2e8233a6628af4e8053a2", "url": "https://github.com/quarkusio/quarkus/commit/99d8daba1f116bf4aac2e8233a6628af4e8053a2", "message": "Make Spring Security play with @TestSecurity\n\nFollows up on: #10487\nResolves: #10490", "committedDate": "2020-07-07T06:10:38Z", "type": "forcePushed"}]}