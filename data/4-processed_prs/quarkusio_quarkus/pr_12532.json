{"pr_number": 12532, "pr_title": "Ability to handle both exit code and exception when running CLI applications", "pr_createdAt": "2020-10-05T19:49:55Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12532", "timeline": [{"oid": "17cfbcf235ed5f00b90600025c64494268547bad", "url": "https://github.com/quarkusio/quarkus/commit/17cfbcf235ed5f00b90600025c64494268547bad", "message": "Ability to handle both exit code and exception when running CLI applications", "committedDate": "2020-10-05T20:50:25Z", "type": "forcePushed"}, {"oid": "ac593bfae6fc45d1eea21f2dd4c5e64c7e32570f", "url": "https://github.com/quarkusio/quarkus/commit/ac593bfae6fc45d1eea21f2dd4c5e64c7e32570f", "message": "Ability to handle both exit code and exception when running CLI applications", "committedDate": "2020-10-05T21:35:13Z", "type": "forcePushed"}, {"oid": "95470281c06dcd19361e198695144859e4fb9d3c", "url": "https://github.com/quarkusio/quarkus/commit/95470281c06dcd19361e198695144859e4fb9d3c", "message": "Ability to handle both exit code and exception when running CLI applications", "committedDate": "2020-10-05T22:37:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDcxMjM4NA==", "url": "https://github.com/quarkusio/quarkus/pull/12532#discussion_r500712384", "bodyText": "I don't think this is true any more.", "author": "stuartwdouglas", "createdAt": "2020-10-07T03:10:17Z", "path": "core/runtime/src/main/java/io/quarkus/runtime/ApplicationLifecycleManager.java", "diffHunk": "@@ -136,10 +138,15 @@ public static void run(Application application, Class<? extends QuarkusApplicati\n                 }\n             }\n         } catch (Exception e) {\n-            if (appStarted) {\n-                //we only log if the error occurred after the application was started\n-                //as the generated application class already has logging\n-                Logger.getLogger(Application.class).error(\"Error running Quarkus application\", e);\n+            if (exitCodeHandler == null) {\n+                if (appStarted) {\n+                    //we only log if the error occurred after the application was started\n+                    //as the generated application class already has logging", "originalCommit": "95470281c06dcd19361e198695144859e4fb9d3c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDcxNDYwMQ==", "url": "https://github.com/quarkusio/quarkus/pull/12532#discussion_r500714601", "bodyText": "I don't think the if statement is necessary here any more.", "author": "stuartwdouglas", "createdAt": "2020-10-07T03:19:28Z", "path": "core/runtime/src/main/java/io/quarkus/runtime/ApplicationLifecycleManager.java", "diffHunk": "@@ -136,10 +138,15 @@ public static void run(Application application, Class<? extends QuarkusApplicati\n                 }\n             }\n         } catch (Exception e) {\n-            if (appStarted) {\n-                //we only log if the error occurred after the application was started\n-                //as the generated application class already has logging\n-                Logger.getLogger(Application.class).error(\"Error running Quarkus application\", e);\n+            if (exitCodeHandler == null) {\n+                if (appStarted) {\n+                    //we only log if the error occurred after the application was started\n+                    //as the generated application class already has logging\n+                    Logger.getLogger(Application.class).error(\"Error running Quarkus application\", e);\n+                } else {\n+                    Logger.getLogger(Application.class).errorv(e, \"Failed to start application (with profile {0})\",", "originalCommit": "95470281c06dcd19361e198695144859e4fb9d3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDkzNzI1MQ==", "url": "https://github.com/quarkusio/quarkus/pull/12532#discussion_r500937251", "bodyText": "I remember having appStarted == true indicating that the application was started but failed for some reason afterward. But I could not make it happen again. I thought the if the statement was intentional to differentiate errors in the different stages.\nGoing to remove.", "author": "pedroigor", "createdAt": "2020-10-07T11:28:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDcxNDYwMQ=="}], "type": "inlineReview"}, {"oid": "1e6302b4b4a32b5d7b25cc08869c7445489cb0d6", "url": "https://github.com/quarkusio/quarkus/commit/1e6302b4b4a32b5d7b25cc08869c7445489cb0d6", "message": "Ability to handle both exit code and exception when running CLI applications", "committedDate": "2020-10-07T11:18:42Z", "type": "commit"}, {"oid": "1e6302b4b4a32b5d7b25cc08869c7445489cb0d6", "url": "https://github.com/quarkusio/quarkus/commit/1e6302b4b4a32b5d7b25cc08869c7445489cb0d6", "message": "Ability to handle both exit code and exception when running CLI applications", "committedDate": "2020-10-07T11:18:42Z", "type": "forcePushed"}]}