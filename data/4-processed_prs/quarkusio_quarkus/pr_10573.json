{"pr_number": 10573, "pr_title": "Fix issue with Opentracing and Servlet in native", "pr_createdAt": "2020-07-08T13:45:13Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10573", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgzMzczMg==", "url": "https://github.com/quarkusio/quarkus/pull/10573#discussion_r452833732", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * isn't loaded unless it's Undertow has been explicitly added.\n          \n          \n            \n             * isn't loaded unless Undertow has been explicitly added.", "author": "gsmet", "createdAt": "2020-07-10T13:12:02Z", "path": "extensions/smallrye-opentracing/runtime/src/main/java/io/quarkus/smallrye/opentracing/runtime/graal/Target_org_jboss_resteasy_microprofile_config_ServletContextConfigSource.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package io.quarkus.smallrye.opentracing.runtime.graal;\n+\n+import org.jboss.resteasy.microprofile.config.ServletContextConfigSource;\n+import org.jboss.resteasy.microprofile.config.ServletContextConfigSourceImpl;\n+\n+import com.oracle.svm.core.annotate.Alias;\n+import com.oracle.svm.core.annotate.RecomputeFieldValue;\n+import com.oracle.svm.core.annotate.TargetClass;\n+\n+/**\n+ * We need this class to ensure that {@link ServletContextConfigSourceImpl}\n+ * isn't loaded unless it's Undertow has been explicitly added.", "originalCommit": "ba2a01931174ce549aa175398286698efca70a3e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgzMzkyOQ==", "url": "https://github.com/quarkusio/quarkus/pull/10573#discussion_r452833929", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * being loaded (due to what {@link ServletContextConfigSource} checks for), which in turns leads to the\n          \n          \n            \n             * being loaded (due to what {@link ServletContextConfigSource} checks for), which in turns leads to", "author": "gsmet", "createdAt": "2020-07-10T13:12:21Z", "path": "extensions/smallrye-opentracing/runtime/src/main/java/io/quarkus/smallrye/opentracing/runtime/graal/Target_org_jboss_resteasy_microprofile_config_ServletContextConfigSource.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package io.quarkus.smallrye.opentracing.runtime.graal;\n+\n+import org.jboss.resteasy.microprofile.config.ServletContextConfigSource;\n+import org.jboss.resteasy.microprofile.config.ServletContextConfigSourceImpl;\n+\n+import com.oracle.svm.core.annotate.Alias;\n+import com.oracle.svm.core.annotate.RecomputeFieldValue;\n+import com.oracle.svm.core.annotate.TargetClass;\n+\n+/**\n+ * We need this class to ensure that {@link ServletContextConfigSourceImpl}\n+ * isn't loaded unless it's Undertow has been explicitly added.\n+ *\n+ * This is done because the OpenTracing extension depends on javax.servlet which results in\n+ * {@link ServletContextConfigSourceImpl}\n+ * being loaded (due to what {@link ServletContextConfigSource} checks for), which in turns leads to the", "originalCommit": "ba2a01931174ce549aa175398286698efca70a3e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgzNTA2NQ==", "url": "https://github.com/quarkusio/quarkus/pull/10573#discussion_r452835065", "bodyText": "I'm not particularly excited to have RESTEasy related substitutions in the opentracing extension?\nShouldn't this be part of the RESTEasy extension itself?", "author": "gsmet", "createdAt": "2020-07-10T13:14:29Z", "path": "extensions/smallrye-opentracing/runtime/src/main/java/io/quarkus/smallrye/opentracing/runtime/graal/Target_org_jboss_resteasy_microprofile_config_FilterConfigSource.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package io.quarkus.smallrye.opentracing.runtime.graal;\n+\n+import org.jboss.resteasy.microprofile.config.FilterConfigSource;", "originalCommit": "ba2a01931174ce549aa175398286698efca70a3e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjg2NjY5OQ==", "url": "https://github.com/quarkusio/quarkus/pull/10573#discussion_r452866699", "bodyText": "It wouldn't hurt, but it's not really necessary because the problem only surfaces because of how OpenTracing relies on some servlet stuff being available (but the extension doesn't depend on undertow, it simply brings in the servlet API).\nIMHO, we should leave it here, but keep it mind for the future (but I seriously doubt it would ever be needed because we would have long have run into the problem).", "author": "geoand", "createdAt": "2020-07-10T14:08:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgzNTA2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU1NDU4Ng==", "url": "https://github.com/quarkusio/quarkus/pull/10573#discussion_r453554586", "bodyText": "I suppose I'll keep my \"I told you so\" for later :).", "author": "gsmet", "createdAt": "2020-07-13T10:32:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgzNTA2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU1NjQwNQ==", "url": "https://github.com/quarkusio/quarkus/pull/10573#discussion_r453556405", "bodyText": "Well you know that if it happens, I'll fix it ASAP :)", "author": "geoand", "createdAt": "2020-07-13T10:35:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgzNTA2NQ=="}], "type": "inlineReview"}, {"oid": "588c1b3e6a86cc20d0e9754886f7ea8d520e1ef0", "url": "https://github.com/quarkusio/quarkus/commit/588c1b3e6a86cc20d0e9754886f7ea8d520e1ef0", "message": "Fix issue with Opentracing and Servlet in native\n\nFixes: #9086\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>", "committedDate": "2020-07-10T14:10:19Z", "type": "commit"}, {"oid": "588c1b3e6a86cc20d0e9754886f7ea8d520e1ef0", "url": "https://github.com/quarkusio/quarkus/commit/588c1b3e6a86cc20d0e9754886f7ea8d520e1ef0", "message": "Fix issue with Opentracing and Servlet in native\n\nFixes: #9086\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>", "committedDate": "2020-07-10T14:10:19Z", "type": "forcePushed"}]}