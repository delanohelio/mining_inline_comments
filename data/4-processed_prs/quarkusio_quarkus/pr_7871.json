{"pr_number": 7871, "pr_title": "Add documentation for building native on Windows", "pr_createdAt": "2020-03-15T22:00:41Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7871", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1ODgyMw==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r392858823", "bodyText": "I installed windows 7 sdk based on instructions given from graalvm team info - but that was months ago;  has it changed ?", "author": "maxandersen", "createdAt": "2020-03-16T08:43:33Z", "path": "docs/src/main/asciidoc/building-native-image.adoc", "diffHunk": "@@ -47,6 +47,7 @@ sudo apt-get install build-essential libz-dev zlib1g-dev\n ----\n xcode-select --install\n ----\n+* On Windows you'll need to install the https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools&rel=16[Visual Studio Build Tools]\n ====", "originalCommit": "70f07ef1e37e505095abb683ec9b0e05b3e0064e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjk0NDY2Ng==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r392944666", "bodyText": "I think it depends if you used jdk8 or jdk11 based GraalVM/native-image.\nwindows 7 sdk fir jdk8 one, VS 2017 for jdk11\ni used instructions from #7663", "author": "rsvoboda", "createdAt": "2020-03-16T11:14:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1ODgyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzAwODkwNQ==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393008905", "bodyText": "No the official message from the SubstrateVM team has not changed according to the github readme, but according to this thread it looks like the the Windows 7 sdk is only required for older versions of GraalVM and with Java 8.\nIt looks like if you want to run JDK 11 on a modern graal you'll need at least VS 2017:\n\nThe JDK 8 versions used Visual Studio 10. The Java team builds JDK 11 with Visual Studio 2017. There is a Windows implementation of GraalVM 19.3 that uses JDK 8. You can try this as a work-around until you get a newer VS version.\n\nSo I could update this here to link to VS 2017 and add instructions based on the JDK wanting to be used.", "author": "gdoenlen", "createdAt": "2020-03-16T13:06:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1ODgyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY2NTQ2Ng==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393665466", "bodyText": "@gsmet How would you like this worded?\n* On Windows you will need to install the Visual Studio Build Tools:\n** For JDK 8 based projects you need to install the https://www.microsoft.com/en-us/download/details.aspx?id=8442[Windows 7 SDK]\n** For JDK 11 based projects you need to install the https://aka.ms/vs/15/release/vs_buildtools.exe[Visual Studio 2017 Build Tools]", "author": "gdoenlen", "createdAt": "2020-03-17T13:09:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1ODgyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzkxMjc0MA==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393912740", "bodyText": "I would just keep it simple and only describe what needs to be done for JDK 11 projects.\nJDK 8 is deprecated in master so no need to make things more awkward than necessary.", "author": "gsmet", "createdAt": "2020-03-17T19:17:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1ODgyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1OTQxNw==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r392859417", "bodyText": "a google search didn't reveal to me how to install graalvm with scoop - got a pointer ?", "author": "maxandersen", "createdAt": "2020-03-16T08:44:42Z", "path": "docs/src/main/asciidoc/building-native-image.adoc", "diffHunk": "@@ -75,6 +76,13 @@ On macOS, point the variable to the `Home` sub-directory:\n ----\n export GRAALVM_HOME=$HOME/Development/graalvm/Contents/Home/\n ----\n++\n+On Windows, you'll have to go through the Control Panel to set your environment variables.\n++\n+[TIP]\n+====\n+Installing via scoop will do this for you.", "originalCommit": "70f07ef1e37e505095abb683ec9b0e05b3e0064e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzAwNDE5Mw==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393004193", "bodyText": "Above I linked to the scoop bucket for Java. Once you install scoop, you'll have to enable the bucket scoop bucket add java and then install graal: scoop install graalvm. That installs the latest release (jdk 11), but theres also graalvm-nightly, graalvm8, graalvm8-nightly, graalvm11, and graalvm11-nightly.", "author": "gdoenlen", "createdAt": "2020-03-16T12:57:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1OTQxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzAwNjE5NA==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393006194", "bodyText": "very nice! good to know!", "author": "maxandersen", "createdAt": "2020-03-16T13:01:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1OTQxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjkyOTU1OA==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r392929558", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * On Windows you'll need to install the https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools&rel=16[Visual Studio Build Tools]\n          \n          \n            \n            * On Windows, you will need to install the https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools&rel=16[Visual Studio Build Tools]", "author": "gsmet", "createdAt": "2020-03-16T10:45:11Z", "path": "docs/src/main/asciidoc/building-native-image.adoc", "diffHunk": "@@ -47,6 +47,7 @@ sudo apt-get install build-essential libz-dev zlib1g-dev\n ----\n xcode-select --install\n ----\n+* On Windows you'll need to install the https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools&rel=16[Visual Studio Build Tools]", "originalCommit": "70f07ef1e37e505095abb683ec9b0e05b3e0064e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjkyOTg3MQ==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r392929871", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ** Use platform-specific install tools like https://github.com/graalvm/homebrew-tap[homebrew] or https://sdkman.io/jdks#Oracle[sdkman] or https://github.com/ScoopInstaller/Java[scoop].\n          \n          \n            \n            ** Use platform-specific install tools like https://github.com/graalvm/homebrew-tap[homebrew], https://sdkman.io/jdks#Oracle[sdkman] or https://github.com/ScoopInstaller/Java[scoop].", "author": "gsmet", "createdAt": "2020-03-16T10:45:42Z", "path": "docs/src/main/asciidoc/building-native-image.adoc", "diffHunk": "@@ -60,7 +61,7 @@ If you cannot install GraalVM, you can use a multi-stage Docker build to run Mav\n Version {graalvm-version} is required. Using the community edition is enough.\n \n 1. Install GraalVM if you haven't already. You have a few options for this:\n-** Use platform-specific install tools like https://github.com/graalvm/homebrew-tap[homebrew] or https://sdkman.io/jdks#Oracle[sdkman].\n+** Use platform-specific install tools like https://github.com/graalvm/homebrew-tap[homebrew] or https://sdkman.io/jdks#Oracle[sdkman] or https://github.com/ScoopInstaller/Java[scoop].", "originalCommit": "70f07ef1e37e505095abb683ec9b0e05b3e0064e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjkzMDAyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r392930021", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            On Windows, you'll have to go through the Control Panel to set your environment variables.\n          \n          \n            \n            On Windows, you will have to go through the Control Panel to set your environment variables.", "author": "gsmet", "createdAt": "2020-03-16T10:45:56Z", "path": "docs/src/main/asciidoc/building-native-image.adoc", "diffHunk": "@@ -75,6 +76,13 @@ On macOS, point the variable to the `Home` sub-directory:\n ----\n export GRAALVM_HOME=$HOME/Development/graalvm/Contents/Home/\n ----\n++\n+On Windows, you'll have to go through the Control Panel to set your environment variables.", "originalCommit": "70f07ef1e37e505095abb683ec9b0e05b3e0064e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NDM5MQ==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393294391", "bodyText": "For Windows I would mention Chocolatey tool, not just scoop.\nChocolatey is very popular on Windows platform - 6.3k stars on Chocolatey GH vs. 358 stars for scoop.\nhttps://chocolatey.org/packages/graalvm", "author": "rsvoboda", "createdAt": "2020-03-16T20:35:04Z", "path": "docs/src/main/asciidoc/building-native-image.adoc", "diffHunk": "@@ -60,7 +61,7 @@ If you cannot install GraalVM, you can use a multi-stage Docker build to run Mav\n Version {graalvm-version} is required. Using the community edition is enough.\n \n 1. Install GraalVM if you haven't already. You have a few options for this:\n-** Use platform-specific install tools like https://github.com/graalvm/homebrew-tap[homebrew] or https://sdkman.io/jdks#Oracle[sdkman].\n+** Use platform-specific install tools like https://github.com/graalvm/homebrew-tap[homebrew] or https://sdkman.io/jdks#Oracle[sdkman] or https://github.com/ScoopInstaller/Java[scoop].", "originalCommit": "70f07ef1e37e505095abb683ec9b0e05b3e0064e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzMxMjU0Nw==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393312547", "bodyText": "scoop has the advantage to not require admin so of such its a simpler model.", "author": "maxandersen", "createdAt": "2020-03-16T21:10:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NDM5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzMzODgxNA==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393338814", "bodyText": "The main scoop github repo actually has 9.9k stars. It's also much easier to contribute to (in fact I just had the PR to export GRAALVM_HOME accepted last night), but I can include choco as well.", "author": "gdoenlen", "createdAt": "2020-03-16T22:14:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NDM5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ2Nzc1Ng==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393467756", "bodyText": "ah, I looked at https://github.com/ScoopInstaller\nnot require admin - that's a strong argument for scoop\nConsider my comment about choco inclusion as optional", "author": "rsvoboda", "createdAt": "2020-03-17T06:30:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NDM5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NzkxMA==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393297910", "bodyText": "For VS 2017 the path is call \"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Auxiliary\\Build\\vcvars64.bat\"", "author": "rsvoboda", "createdAt": "2020-03-16T20:42:12Z", "path": "docs/src/main/asciidoc/building-native-image.adoc", "diffHunk": "@@ -158,6 +166,20 @@ just pass -Dquarkus.package.type=native as a property on the command line, howev\n this allows native image tests to also be run.\n \n Create a native executable using: `./mvnw package -Pnative`.\n+[[graal-and-windows]]\n+[NOTE]\n+.Issues with packaging on Windows\n+====\n+The Microsoft Native Tools for Visual Studio must first be initialized before packaging. You can do this by starting\n+the `x64 Native Tools Command Prompt` that was installed with the Visual Studio Build Tools.\n+\n+Another solution is to write a script to do this for you:\n+\n+[source,shell]\n+----\n+cmd /c '\"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\VC\\Auxiliary\\Build\\vcvars64.bat\" && mvn package -Pnative'", "originalCommit": "70f07ef1e37e505095abb683ec9b0e05b3e0064e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzMzODk5Ng==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393338996", "bodyText": "Will do.", "author": "gdoenlen", "createdAt": "2020-03-16T22:14:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NzkxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY2OTU0Mg==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393669542", "bodyText": "@maxandersen Is there a different path for the Windows 7 vars file?", "author": "gdoenlen", "createdAt": "2020-03-17T13:15:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NzkxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM0OTg1Mw==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r394349853", "bodyText": "@rsvoboda I updated this to cmd /c 'call \"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\BuildTools\\VC\\Auxiliary\\Build\\vcvars64.bat\" && mvn package -Pnative' as that's where the file lives when only installing the build tools.\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2017> gci -r | where name -eq 'vcvars64.bat'\n\n\n    Directory: C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\BuildTools\\VC\\Auxiliary\\Build\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a---           3/18/2020  9:10 AM             39 vcvars64.bat", "author": "gdoenlen", "createdAt": "2020-03-18T13:35:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NzkxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY2ODM5MQ==", "url": "https://github.com/quarkusio/quarkus/pull/7871#discussion_r393668391", "bodyText": "@gsmet Wording here will be a little odd as well with the Windows 7 SDK vs Visual Studio 2017 Build Tools.", "author": "gdoenlen", "createdAt": "2020-03-17T13:13:41Z", "path": "docs/src/main/asciidoc/building-native-image.adoc", "diffHunk": "@@ -158,6 +166,20 @@ just pass -Dquarkus.package.type=native as a property on the command line, howev\n this allows native image tests to also be run.\n \n Create a native executable using: `./mvnw package -Pnative`.\n+[[graal-and-windows]]\n+[NOTE]\n+.Issues with packaging on Windows\n+====\n+The Microsoft Native Tools for Visual Studio must first be initialized before packaging. You can do this by starting\n+the `x64 Native Tools Command Prompt` that was installed with the Visual Studio Build Tools.", "originalCommit": "70f07ef1e37e505095abb683ec9b0e05b3e0064e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4588915803b0a228cf0c818fe1901d713691641d", "url": "https://github.com/quarkusio/quarkus/commit/4588915803b0a228cf0c818fe1901d713691641d", "message": "Add documentation for building native on windows\n\nNow that compiling to native on windows is working properly add\ndocumentation on the steps required as discussed in #5675", "committedDate": "2020-03-18T13:29:58Z", "type": "forcePushed"}, {"oid": "78fa3da6945a32dd42e53a829ea389922e0e0e77", "url": "https://github.com/quarkusio/quarkus/commit/78fa3da6945a32dd42e53a829ea389922e0e0e77", "message": "Add documentation for building native on windows\n\nNow that compiling to native on windows is working properly add\ndocumentation on the steps required as discussed in #5675", "committedDate": "2020-03-19T17:48:44Z", "type": "commit"}, {"oid": "78fa3da6945a32dd42e53a829ea389922e0e0e77", "url": "https://github.com/quarkusio/quarkus/commit/78fa3da6945a32dd42e53a829ea389922e0e0e77", "message": "Add documentation for building native on windows\n\nNow that compiling to native on windows is working properly add\ndocumentation on the steps required as discussed in #5675", "committedDate": "2020-03-19T17:48:44Z", "type": "forcePushed"}]}