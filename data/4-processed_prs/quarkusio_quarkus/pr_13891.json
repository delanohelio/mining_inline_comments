{"pr_number": 13891, "pr_title": "Basic ClientHeadersFactory documentation", "pr_createdAt": "2020-12-15T08:53:33Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/13891", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY0NTQwNQ==", "url": "https://github.com/quarkusio/quarkus/pull/13891#discussion_r543645405", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            == Custom header support\n          \n          \n            \n            == Custom headers support", "author": "gsmet", "createdAt": "2020-12-15T19:57:20Z", "path": "docs/src/main/asciidoc/rest-client.adoc", "diffHunk": "@@ -456,6 +456,68 @@ If you use a `CompletionStage`, you would need to call the service's method to r\n This difference comes from the laziness aspect of Mutiny and its subscription protocol.\n More details about this can be found in https://smallrye.io/smallrye-mutiny/#_uni_and_multi[the Mutiny documentation].\n \n+== Custom header support", "originalCommit": "b7e53149081daeb7f2bffca4d67f62102412a9a7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY0Njc5MA==", "url": "https://github.com/quarkusio/quarkus/pull/13891#discussion_r543646790", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The mp-rest client allows registering factory to amend requests headers using `@RegisterClientHeaders` annotation.\n          \n          \n            \n            The MicroProfile REST client allows amending request headers by registering a `ClientHeadersFactory` with the `@RegisterClientHeaders` annotation.", "author": "gsmet", "createdAt": "2020-12-15T19:59:38Z", "path": "docs/src/main/asciidoc/rest-client.adoc", "diffHunk": "@@ -456,6 +456,68 @@ If you use a `CompletionStage`, you would need to call the service's method to r\n This difference comes from the laziness aspect of Mutiny and its subscription protocol.\n More details about this can be found in https://smallrye.io/smallrye-mutiny/#_uni_and_multi[the Mutiny documentation].\n \n+== Custom header support\n+The mp-rest client allows registering factory to amend requests headers using `@RegisterClientHeaders` annotation.", "originalCommit": "b7e53149081daeb7f2bffca4d67f62102412a9a7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY0Njk4OQ==", "url": "https://github.com/quarkusio/quarkus/pull/13891#discussion_r543646989", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Let's see it in action by adding a `RequestUUIDHeaderFactory` method in our `CountriesService` REST interface. The code should look like:\n          \n          \n            \n            Let's see it in action by adding a `@RegisterClientHeaders` annotation pointing to a `RequestUUIDHeaderFactory` class in our `CountriesService` REST interface:", "author": "gsmet", "createdAt": "2020-12-15T19:59:59Z", "path": "docs/src/main/asciidoc/rest-client.adoc", "diffHunk": "@@ -456,6 +456,68 @@ If you use a `CompletionStage`, you would need to call the service's method to r\n This difference comes from the laziness aspect of Mutiny and its subscription protocol.\n More details about this can be found in https://smallrye.io/smallrye-mutiny/#_uni_and_multi[the Mutiny documentation].\n \n+== Custom header support\n+The mp-rest client allows registering factory to amend requests headers using `@RegisterClientHeaders` annotation.\n+\n+Let's see it in action by adding a `RequestUUIDHeaderFactory` method in our `CountriesService` REST interface. The code should look like:", "originalCommit": "b7e53149081daeb7f2bffca4d67f62102412a9a7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY0NzI5MA==", "url": "https://github.com/quarkusio/quarkus/pull/13891#discussion_r543647290", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            And the RequestUUIDHeaderFactory` :\n          \n          \n            \n            And the `RequestUUIDHeaderFactory` would look like:", "author": "gsmet", "createdAt": "2020-12-15T20:00:27Z", "path": "docs/src/main/asciidoc/rest-client.adoc", "diffHunk": "@@ -456,6 +456,68 @@ If you use a `CompletionStage`, you would need to call the service's method to r\n This difference comes from the laziness aspect of Mutiny and its subscription protocol.\n More details about this can be found in https://smallrye.io/smallrye-mutiny/#_uni_and_multi[the Mutiny documentation].\n \n+== Custom header support\n+The mp-rest client allows registering factory to amend requests headers using `@RegisterClientHeaders` annotation.\n+\n+Let's see it in action by adding a `RequestUUIDHeaderFactory` method in our `CountriesService` REST interface. The code should look like:\n+\n+[source, java]\n+----\n+package org.acme.rest.client;\n+\n+import org.eclipse.microprofile.rest.client.inject.RegisterRestClient;\n+import org.jboss.resteasy.annotations.jaxrs.PathParam;\n+\n+import javax.ws.rs.GET;\n+import javax.ws.rs.Path;\n+import javax.ws.rs.Produces;\n+import java.util.concurrent.CompletionStage;\n+import java.util.Set;\n+\n+@Path(\"/v2\")\n+@RegisterRestClient\n+@RegisterClientHeaders(RequestUUIDHeaderFactory.class)\n+public interface CountriesService {\n+\n+    @GET\n+    @Path(\"/name/{name}\")\n+    @Produces(\"application/json\")\n+    Set<Country> getByName(@PathParam String name);\n+\n+    @GET\n+    @Path(\"/name/{name}\")\n+    @Produces(\"application/json\")\n+    CompletionStage<Set<Country>> getByNameAsync(@PathParam String name);\n+}\n+----\n+\n+And the RequestUUIDHeaderFactory` :", "originalCommit": "b7e53149081daeb7f2bffca4d67f62102412a9a7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY0NzcwNQ==", "url": "https://github.com/quarkusio/quarkus/pull/13891#discussion_r543647705", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Any CDI bean matching the declared factory will be picked-up and can of course benefit from quarkus features.\n          \n          \n            \n            Any CDI bean matching the declared factory class will be picked up and can of course benefit from the usual CDI infrastructure.", "author": "gsmet", "createdAt": "2020-12-15T20:01:10Z", "path": "docs/src/main/asciidoc/rest-client.adoc", "diffHunk": "@@ -456,6 +456,68 @@ If you use a `CompletionStage`, you would need to call the service's method to r\n This difference comes from the laziness aspect of Mutiny and its subscription protocol.\n More details about this can be found in https://smallrye.io/smallrye-mutiny/#_uni_and_multi[the Mutiny documentation].\n \n+== Custom header support\n+The mp-rest client allows registering factory to amend requests headers using `@RegisterClientHeaders` annotation.\n+\n+Let's see it in action by adding a `RequestUUIDHeaderFactory` method in our `CountriesService` REST interface. The code should look like:\n+\n+[source, java]\n+----\n+package org.acme.rest.client;\n+\n+import org.eclipse.microprofile.rest.client.inject.RegisterRestClient;\n+import org.jboss.resteasy.annotations.jaxrs.PathParam;\n+\n+import javax.ws.rs.GET;\n+import javax.ws.rs.Path;\n+import javax.ws.rs.Produces;\n+import java.util.concurrent.CompletionStage;\n+import java.util.Set;\n+\n+@Path(\"/v2\")\n+@RegisterRestClient\n+@RegisterClientHeaders(RequestUUIDHeaderFactory.class)\n+public interface CountriesService {\n+\n+    @GET\n+    @Path(\"/name/{name}\")\n+    @Produces(\"application/json\")\n+    Set<Country> getByName(@PathParam String name);\n+\n+    @GET\n+    @Path(\"/name/{name}\")\n+    @Produces(\"application/json\")\n+    CompletionStage<Set<Country>> getByNameAsync(@PathParam String name);\n+}\n+----\n+\n+And the RequestUUIDHeaderFactory` :\n+\n+[source, java]\n+----\n+package org.acme.rest.client;\n+\n+import org.eclipse.microprofile.rest.client.ext.ClientHeadersFactory;\n+import org.jboss.resteasy.specimpl.MultivaluedMapImpl;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.ws.rs.core.MultivaluedMap;\n+import java.util.UUID;\n+\n+@ApplicationScoped\n+public class RequestUUIDHeaderFactory implements ClientHeadersFactory {\n+\n+    @Override\n+    public MultivaluedMap<String, String> update(MultivaluedMap<String, String> multivaluedMap, MultivaluedMap<String, String> multivaluedMap1) {\n+        MultivaluedMap<String, String> result = new MultivaluedMapImpl<>();\n+        result.add(\"X-request-uuid\", UUID.randomUUID().toString());\n+        return result;\n+    }\n+}\n+----\n+\n+Any CDI bean matching the declared factory will be picked-up and can of course benefit from quarkus features.", "originalCommit": "b7e53149081daeb7f2bffca4d67f62102412a9a7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY0OTA5Nw==", "url": "https://github.com/quarkusio/quarkus/pull/13891#discussion_r543649097", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public MultivaluedMap<String, String> update(MultivaluedMap<String, String> multivaluedMap, MultivaluedMap<String, String> multivaluedMap1) {\n          \n          \n            \n                public MultivaluedMap<String, String> update(MultivaluedMap<String, String> incomingHeaders, MultivaluedMap<String, String> clientOutgoingHeaders) {", "author": "gsmet", "createdAt": "2020-12-15T20:03:28Z", "path": "docs/src/main/asciidoc/rest-client.adoc", "diffHunk": "@@ -456,6 +456,68 @@ If you use a `CompletionStage`, you would need to call the service's method to r\n This difference comes from the laziness aspect of Mutiny and its subscription protocol.\n More details about this can be found in https://smallrye.io/smallrye-mutiny/#_uni_and_multi[the Mutiny documentation].\n \n+== Custom header support\n+The mp-rest client allows registering factory to amend requests headers using `@RegisterClientHeaders` annotation.\n+\n+Let's see it in action by adding a `RequestUUIDHeaderFactory` method in our `CountriesService` REST interface. The code should look like:\n+\n+[source, java]\n+----\n+package org.acme.rest.client;\n+\n+import org.eclipse.microprofile.rest.client.inject.RegisterRestClient;\n+import org.jboss.resteasy.annotations.jaxrs.PathParam;\n+\n+import javax.ws.rs.GET;\n+import javax.ws.rs.Path;\n+import javax.ws.rs.Produces;\n+import java.util.concurrent.CompletionStage;\n+import java.util.Set;\n+\n+@Path(\"/v2\")\n+@RegisterRestClient\n+@RegisterClientHeaders(RequestUUIDHeaderFactory.class)\n+public interface CountriesService {\n+\n+    @GET\n+    @Path(\"/name/{name}\")\n+    @Produces(\"application/json\")\n+    Set<Country> getByName(@PathParam String name);\n+\n+    @GET\n+    @Path(\"/name/{name}\")\n+    @Produces(\"application/json\")\n+    CompletionStage<Set<Country>> getByNameAsync(@PathParam String name);\n+}\n+----\n+\n+And the RequestUUIDHeaderFactory` :\n+\n+[source, java]\n+----\n+package org.acme.rest.client;\n+\n+import org.eclipse.microprofile.rest.client.ext.ClientHeadersFactory;\n+import org.jboss.resteasy.specimpl.MultivaluedMapImpl;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.ws.rs.core.MultivaluedMap;\n+import java.util.UUID;\n+\n+@ApplicationScoped\n+public class RequestUUIDHeaderFactory implements ClientHeadersFactory {\n+\n+    @Override\n+    public MultivaluedMap<String, String> update(MultivaluedMap<String, String> multivaluedMap, MultivaluedMap<String, String> multivaluedMap1) {", "originalCommit": "b7e53149081daeb7f2bffca4d67f62102412a9a7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "49c47a4de717c91d635f64792ab266c0c6a23ac9", "url": "https://github.com/quarkusio/quarkus/commit/49c47a4de717c91d635f64792ab266c0c6a23ac9", "message": "Basic header factory documentation", "committedDate": "2020-12-16T16:06:24Z", "type": "commit"}, {"oid": "49c47a4de717c91d635f64792ab266c0c6a23ac9", "url": "https://github.com/quarkusio/quarkus/commit/49c47a4de717c91d635f64792ab266c0c6a23ac9", "message": "Basic header factory documentation", "committedDate": "2020-12-16T16:06:24Z", "type": "forcePushed"}]}