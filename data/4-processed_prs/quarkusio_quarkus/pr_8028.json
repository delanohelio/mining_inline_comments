{"pr_number": 8028, "pr_title": "Various Liquibase improvements", "pr_createdAt": "2020-03-20T16:01:06Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/8028", "timeline": [{"oid": "a3bcd5c22c4f0757d696a7107cc237b54c095f4e", "url": "https://github.com/quarkusio/quarkus/commit/a3bcd5c22c4f0757d696a7107cc237b54c095f4e", "message": "Improve the javadoc of the native enableReports option.", "committedDate": "2020-03-20T16:00:01Z", "type": "commit"}, {"oid": "b1fdc157db0064ff89e121d3509affb5272d45ab", "url": "https://github.com/quarkusio/quarkus/commit/b1fdc157db0064ff89e121d3509affb5272d45ab", "message": "Liquibase - Debug logging improvement", "committedDate": "2020-03-20T16:00:01Z", "type": "commit"}, {"oid": "3763e96e16f22f0ab42a45ffbbab753ae1622230", "url": "https://github.com/quarkusio/quarkus/commit/3763e96e16f22f0ab42a45ffbbab753ae1622230", "message": "Liquibase - Enable the reports in the native image generation", "committedDate": "2020-03-20T16:00:01Z", "type": "commit"}, {"oid": "4762140fdc8319db0bff06a96bda0047072db8ad", "url": "https://github.com/quarkusio/quarkus/commit/4762140fdc8319db0bff06a96bda0047072db8ad", "message": "Liquibase - Only parse changelog files when generating native image\n\nPlus some additional cleanup.\n\nFixes #7956", "committedDate": "2020-03-20T16:00:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTczNTU5OA==", "url": "https://github.com/quarkusio/quarkus/pull/8028#discussion_r395735598", "bodyText": "This is the gist of it: only analyzing the changelog in the native image case as we don't need it in other cases.", "author": "gsmet", "createdAt": "2020-03-20T16:01:41Z", "path": "extensions/liquibase/deployment/src/main/java/io/quarkus/liquibase/LiquibaseProcessor.java", "diffHunk": "@@ -54,26 +55,21 @@\n \n     private static final Logger LOGGER = Logger.getLogger(LiquibaseServiceLoader.class);\n \n-    /**\n-     * The change log parser factory singleton used for the liquibase service classpath scanner\n-     */\n-    private static final ChangeLogParserFactory CHANGE_LOG_PARSER_FACTORY = ChangeLogParserFactory.getInstance();\n-\n-    /**\n-     * Liquibase build time configuration\n-     */\n     LiquibaseBuildTimeConfig liquibaseBuildConfig;\n \n     @BuildStep\n     CapabilityBuildItem capability() {\n         return new CapabilityBuildItem(Capabilities.LIQUIBASE);\n     }\n \n-    @BuildStep\n-    void reflection(BuildProducer<ReflectiveClassBuildItem> reflective,\n-            BuildProducer<NativeImageResourceBuildItem> resourceProducer,\n-            BuildProducer<GeneratedResourceBuildItem> generatedResourceProducer,\n-            BuildProducer<RuntimeInitializedClassBuildItem> runtimeInitialized) {\n+    @BuildStep(onlyIf = NativeBuild.class, loadsApplicationClasses = true)", "originalCommit": "4762140fdc8319db0bff06a96bda0047072db8ad", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTczNjA3NA==", "url": "https://github.com/quarkusio/quarkus/pull/8028#discussion_r395736074", "bodyText": "This is where all the time is passed: it has a very flawed and slow scanning process.\nWe now only create that instance when building a native image.", "author": "gsmet", "createdAt": "2020-03-20T16:02:20Z", "path": "extensions/liquibase/deployment/src/main/java/io/quarkus/liquibase/LiquibaseProcessor.java", "diffHunk": "@@ -54,26 +55,21 @@\n \n     private static final Logger LOGGER = Logger.getLogger(LiquibaseServiceLoader.class);\n \n-    /**\n-     * The change log parser factory singleton used for the liquibase service classpath scanner\n-     */\n-    private static final ChangeLogParserFactory CHANGE_LOG_PARSER_FACTORY = ChangeLogParserFactory.getInstance();", "originalCommit": "4762140fdc8319db0bff06a96bda0047072db8ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc4MjI0MA==", "url": "https://github.com/quarkusio/quarkus/pull/8028#discussion_r395782240", "bodyText": "Hi - I am the Liquibase Community Manager. Wanted to let y'all know that this is something that should be improved in our next major release, 4.0.0. Keep an eye on the blog for more info. 4.0 Beta 1 should be available in the next month.", "author": "SteveDonie", "createdAt": "2020-03-20T17:19:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTczNjA3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc4NTU2Nw==", "url": "https://github.com/quarkusio/quarkus/pull/8028#discussion_r395785567", "bodyText": "@SteveDonie ah cool! Feel free to ping us if you want to discuss things.", "author": "gsmet", "createdAt": "2020-03-20T17:25:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTczNjA3NA=="}], "type": "inlineReview"}]}