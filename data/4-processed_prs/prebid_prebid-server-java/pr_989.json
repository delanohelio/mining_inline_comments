{"pr_number": 989, "pr_title": "Optionally read IFA value and add it the the request url (Adhese)", "pr_createdAt": "2020-11-02T15:25:36Z", "pr_url": "https://github.com/prebid/prebid-server-java/pull/989", "timeline": [{"oid": "7bdfc98a69db1209fd8594a25da4668b49171a13", "url": "https://github.com/prebid/prebid-server-java/commit/7bdfc98a69db1209fd8594a25da4668b49171a13", "message": "Optionally read IFA value and add it the the request url (Adhese)", "committedDate": "2020-11-02T15:18:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjEzOTY4MQ==", "url": "https://github.com/prebid/prebid-server-java/pull/989#discussion_r516139681", "bodyText": "Minor. Maybe one line will be better\n return device != null && StringUtils.isNotBlank(device.getIfa())\n? String.format(\"%s%s\", QUERY_PARAMETER_IFA, device.getIfa()) : \"\";", "author": "snahornyi", "createdAt": "2020-11-02T17:29:08Z", "path": "src/main/java/org/prebid/server/bidder/adhese/AdheseBidder.java", "diffHunk": "@@ -145,6 +149,13 @@ private static String getRefererParameter(Site site) {\n                 : \"\";\n     }\n \n+    private static String getIfaParameter(Device device) {\n+        final String ifa = device != null ? device.getIfa() : null;\n+        return StringUtils.isNotBlank(ifa)\n+                ? String.format(\"%s%s\", QUERY_PARAMETER_IFA, ifa)\n+                : \"\";", "originalCommit": "7bdfc98a69db1209fd8594a25da4668b49171a13", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE0Mjg2Mg==", "url": "https://github.com/prebid/prebid-server-java/pull/989#discussion_r516142862", "bodyText": "Minor. We prefer to use builder in separate lines only in case if single line is more then checkstyle line length rule constant.", "author": "snahornyi", "createdAt": "2020-11-02T17:33:48Z", "path": "src/test/java/org/prebid/server/bidder/adhese/AdheseBidderTest.java", "diffHunk": "@@ -106,6 +107,9 @@ public void makeHttpRequestsShouldModifyIncomingRequestAndSetExpectedHttpRequest\n                         .ext(mapper.valueToTree(ExtPrebid.of(null, ExtImpAdhese.of(\"demo\",\n                                 \"_adhese_prebid_demo_\", \"leaderboard\", mapper.convertValue(targets, JsonNode.class)))))\n                         .build()))\n+                .device(Device.builder()\n+                        .ifa(\"dum-my\")\n+                        .build())", "originalCommit": "7bdfc98a69db1209fd8594a25da4668b49171a13", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d3cb7ae75bc4897cad8a3dc142a0c54bb5320477", "url": "https://github.com/prebid/prebid-server-java/commit/d3cb7ae75bc4897cad8a3dc142a0c54bb5320477", "message": "Process feedback + changed a similar occurrence", "committedDate": "2020-11-03T07:38:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTEwOTg4Mg==", "url": "https://github.com/prebid/prebid-server-java/pull/989#discussion_r525109882", "bodyText": "i'd recommend ifa as separate variable.", "author": "rpanchyk", "createdAt": "2020-11-17T12:16:45Z", "path": "src/main/java/org/prebid/server/bidder/adhese/AdheseBidder.java", "diffHunk": "@@ -139,12 +143,16 @@ private static String getGdprParameter(User user) {\n     }\n \n     private static String getRefererParameter(Site site) {\n-        final String page = site != null ? site.getPage() : null;\n-        return StringUtils.isNotBlank(page)\n-                ? String.format(\"%s%s\", QUERY_PARAMETER_REFERER, HttpUtil.encodeUrl(page))\n+        return site != null && StringUtils.isNotBlank(site.getPage())\n+                ? String.format(\"%s%s\", QUERY_PARAMETER_REFERER, HttpUtil.encodeUrl(site.getPage()))\n                 : \"\";\n     }\n \n+    private static String getIfaParameter(Device device) {\n+        return device != null && StringUtils.isNotBlank(device.getIfa())", "originalCommit": "d3cb7ae75bc4897cad8a3dc142a0c54bb5320477", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExMDI4Nw==", "url": "https://github.com/prebid/prebid-server-java/pull/989#discussion_r525110287", "bodyText": "Should we make url-encoding here?", "author": "rpanchyk", "createdAt": "2020-11-17T12:17:30Z", "path": "src/main/java/org/prebid/server/bidder/adhese/AdheseBidder.java", "diffHunk": "@@ -139,12 +143,16 @@ private static String getGdprParameter(User user) {\n     }\n \n     private static String getRefererParameter(Site site) {\n-        final String page = site != null ? site.getPage() : null;\n-        return StringUtils.isNotBlank(page)\n-                ? String.format(\"%s%s\", QUERY_PARAMETER_REFERER, HttpUtil.encodeUrl(page))\n+        return site != null && StringUtils.isNotBlank(site.getPage())\n+                ? String.format(\"%s%s\", QUERY_PARAMETER_REFERER, HttpUtil.encodeUrl(site.getPage()))\n                 : \"\";\n     }\n \n+    private static String getIfaParameter(Device device) {\n+        return device != null && StringUtils.isNotBlank(device.getIfa())\n+                ? String.format(\"%s%s\", QUERY_PARAMETER_IFA, device.getIfa()) : \"\";", "originalCommit": "d3cb7ae75bc4897cad8a3dc142a0c54bb5320477", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExMTk5Ng==", "url": "https://github.com/prebid/prebid-server-java/pull/989#discussion_r525111996", "bodyText": "Minor. Usually most valuable thing can placed at first position, like IFA_QUERY_PARAMETER.\nIf you're ok with it, pls check for other fields.", "author": "rpanchyk", "createdAt": "2020-11-17T12:20:20Z", "path": "src/main/java/org/prebid/server/bidder/adhese/AdheseBidder.java", "diffHunk": "@@ -57,6 +58,7 @@\n     private static final String ORIGIN = \"JERLICIA\";\n     private static final String QUERY_PARAMETER_GDPR = \"/xt\";\n     private static final String QUERY_PARAMETER_REFERER = \"/xf\";\n+    private static final String QUERY_PARAMETER_IFA = \"/xz\";", "originalCommit": "d3cb7ae75bc4897cad8a3dc142a0c54bb5320477", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f71b4313f49714874f7971eb2b314d8321e53ef6", "url": "https://github.com/prebid/prebid-server-java/commit/f71b4313f49714874f7971eb2b314d8321e53ef6", "message": "Process feedback", "committedDate": "2020-11-17T14:38:34Z", "type": "commit"}]}