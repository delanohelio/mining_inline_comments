{"pr_number": 1316, "pr_title": "New Field-Mapping component", "pr_createdAt": "2020-12-18T21:51:36Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/1316", "timeline": [{"oid": "a2708223c2ab520df5fee1e609c4b6edc84b15ee", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a2708223c2ab520df5fee1e609c4b6edc84b15ee", "message": "feat(FieldMappingField): Added a new component for mapping between two select fields. Added this feature to the dynamic fieldMapping util.", "committedDate": "2020-12-17T22:05:39Z", "type": "commit"}, {"oid": "6928e88bb137ed62e495dffb97b2d5bd121b0eb8", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/6928e88bb137ed62e495dffb97b2d5bd121b0eb8", "message": "feat(JiraCloudDistributionUIConfig): Added the new FieldMappingField to the java files to show working field generation in UI.", "committedDate": "2020-12-18T14:58:04Z", "type": "commit"}, {"oid": "0789e87a24bad402dce1180c33dbf7295475ed35", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/0789e87a24bad402dce1180c33dbf7295475ed35", "message": "feat(FieldMappingEndpointField): The field will now be displayed dynamically when set in the java descriptor", "committedDate": "2020-12-18T19:36:01Z", "type": "commit"}, {"oid": "63f3908c7661213831650da5e6ac485d34f76608", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/63f3908c7661213831650da5e6ac485d34f76608", "message": "Merge branch 'master' into bm-field-mapping", "committedDate": "2020-12-18T19:36:34Z", "type": "commit"}, {"oid": "7d89f3ff0d53a83445882a614783b696cab52dba", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/7d89f3ff0d53a83445882a614783b696cab52dba", "message": "feat(FieldMappingField.js): Converted the select fields in the modal to be text fields so that users have greater flexibility. Also fixed some smaller issues.", "committedDate": "2020-12-18T21:38:59Z", "type": "commit"}, {"oid": "09d5be1c20eeb9c14c643674f5e1c2200e414bde", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/09d5be1c20eeb9c14c643674f5e1c2200e414bde", "message": "deleted a number of classes that were used to set up custom options from the backend, use text fields now and no longer need options.", "committedDate": "2020-12-18T21:49:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njc3Njk4NA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1316#discussion_r546776984", "bodyText": "We'll need to eventually add this to Jira Server as well.", "author": "gkillough", "createdAt": "2020-12-21T15:42:31Z", "path": "channel/src/main/java/com/synopsys/integration/alert/channel/jira/cloud/descriptor/JiraCloudDistributionUIConfig.java", "diffHunk": "@@ -67,8 +70,10 @@ public JiraCloudDistributionUIConfig() {\n         ConfigField resolveWorkflow = new TextInputConfigField(JiraCloudDescriptor.KEY_RESOLVE_WORKFLOW_TRANSITION, LABEL_RESOLVE_WORKFLOW_TRANSITION, DESCRIPTION_RESOLVE_WORKFLOW_TRANSITION);\n         ConfigField openWorkflow = new TextInputConfigField(JiraCloudDescriptor.KEY_OPEN_WORKFLOW_TRANSITION, LABEL_OPEN_WORKFLOW_TRANSITION, DESCRIPTION_OPEN_WORKFLOW_TRANSITION)\n                                        .applyRequiredRelatedField(resolveWorkflow.getKey());\n+        ConfigField fieldMapping = new FieldMappingEndpointField(JiraCloudDescriptor.KEY_FIELD_MAPPING, LABEL_FIELD_MAPPING, DESCRIPTION_FIELD_MAPPING, \"Jira Field\", \"Notification content\")\n+                                       .applyNewMappingTitle(\"Create Jira Field Mapping\");", "originalCommit": "09d5be1c20eeb9c14c643674f5e1c2200e414bde", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "948ab86acf3184067a11be93d3c8daccc93fc85a", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/948ab86acf3184067a11be93d3c8daccc93fc85a", "message": "Working on the custom field mapping, adding the predefined replacement values", "committedDate": "2020-12-21T16:26:54Z", "type": "commit"}, {"oid": "7217686dfebe5f454a8148655978ca1b527f2124", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/7217686dfebe5f454a8148655978ca1b527f2124", "message": "Merge branch 'master' into bm-field-mapping", "committedDate": "2020-12-21T18:45:26Z", "type": "commit"}, {"oid": "2860afd25bdedcb4a7cb423e61bd17efac40ee35", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/2860afd25bdedcb4a7cb423e61bd17efac40ee35", "message": "Refactor: working on saving and editing the Jira custom field mappings", "committedDate": "2020-12-21T23:19:12Z", "type": "commit"}, {"oid": "f02751834e364edea430cd44c17cadd2628c0c1c", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f02751834e364edea430cd44c17cadd2628c0c1c", "message": "Refactor: Fixing the field mapping deletion", "committedDate": "2020-12-22T16:27:37Z", "type": "commit"}, {"oid": "4f3dcd163b2e0782d1919e15cefe4ecaf558dd8c", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/4f3dcd163b2e0782d1919e15cefe4ecaf558dd8c", "message": "Fixing the Jira Server validation", "committedDate": "2020-12-22T16:31:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM3NzQzNA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1316#discussion_r547377434", "bodyText": "Added this to address browser errors with columns not having unique keys.", "author": "jamesrichard91", "createdAt": "2020-12-22T16:33:57Z", "path": "ui/src/main/js/field/TableDisplay.js", "diffHunk": "@@ -408,6 +408,7 @@ class TableDisplay extends Component {\n     createIconTableHeader(dataFormat, text) {\n         return (\n             <TableHeaderColumn\n+                key={`${text}Key`}", "originalCommit": "f02751834e364edea430cd44c17cadd2628c0c1c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM3NzUyOA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1316#discussion_r547377528", "bodyText": "Added this to address browser errors with columns not having unique keys.", "author": "jamesrichard91", "createdAt": "2020-12-22T16:34:08Z", "path": "ui/src/main/js/field/input/TableSelectInput.js", "diffHunk": "@@ -383,7 +383,7 @@ class TableSelectInput extends Component {\n         ));\n \n         // Need to add this column to the array as you can't display tableColumns dynamically and statically https://github.com/AllenFang/react-bootstrap-table/issues/1814\n-        tableColumns.push(<TableHeaderColumn dataField=\"missing\" dataFormat={assignDataFormat} hidden>Missing Data</TableHeaderColumn>);\n+        tableColumns.push(<TableHeaderColumn key=\"missingHeaderKey\" dataField=\"missing\" dataFormat={assignDataFormat} hidden>Missing Data</TableHeaderColumn>);", "originalCommit": "f02751834e364edea430cd44c17cadd2628c0c1c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4MzU3NA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1316#discussion_r547383574", "bodyText": "Oh wow. This is probably a bug in a few other places as well. I'll create a ticket against 6.4.0", "author": "gkillough", "createdAt": "2020-12-22T16:45:39Z", "path": "alert-database/src/main/java/com/synopsys/integration/alert/database/job/jira/cloud/JiraCloudJobDetailsAccessor.java", "diffHunk": "@@ -68,6 +67,8 @@ public JiraCloudJobDetailsEntity saveJiraCloudJobDetails(UUID jobId, JiraCloudJo\n         if (!customFieldsToSave.isEmpty()) {\n             List<JiraCloudJobCustomFieldEntity> savedCustomFields = jiraCloudJobCustomFieldRepository.saveAll(customFieldsToSave);\n             savedJobDetails.setJobCustomFields(savedCustomFields);\n+        } else {\n+            savedJobDetails.setJobCustomFields(List.of());", "originalCommit": "4f3dcd163b2e0782d1919e15cefe4ecaf558dd8c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4NjIwMg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1316#discussion_r547386202", "bodyText": "Do we still need these fields in the DB if we aren't storing them with these tables? Does the UI config adequately handle the current dynamic field generation without these being stored?", "author": "gkillough", "createdAt": "2020-12-22T16:50:35Z", "path": "alert-database/src/main/resources/liquibase/6.4.0/jira-custom-fields.xml", "diffHunk": "@@ -76,4 +76,33 @@\n         />\n     </changeSet>\n \n+    <changeSet author=\"jrichard\" id=\"add-defined-field-field-mapping\">", "originalCommit": "4f3dcd163b2e0782d1919e15cefe4ecaf558dd8c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM5NDYwMw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1316#discussion_r547394603", "bodyText": "I added these, because our current job config handling strips out all non-registered fields from the key value pairs. When we change the job handling, this will no longer be necessary.", "author": "jamesrichard91", "createdAt": "2020-12-22T17:07:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4NjIwMg=="}], "type": "inlineReview"}, {"oid": "1c84e4eefd05fde81a002422203f1a647daf8184", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/1c84e4eefd05fde81a002422203f1a647daf8184", "message": "Fix: prevent new row being added when editing a row.", "committedDate": "2020-12-22T16:53:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM5MDMzOQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1316#discussion_r547390339", "bodyText": "We should put this in its own field group. \"Advanced\" or something. I think you can apply it to ConfigField.", "author": "gkillough", "createdAt": "2020-12-22T16:58:40Z", "path": "channel/src/main/java/com/synopsys/integration/alert/channel/jira/cloud/descriptor/JiraCloudDistributionUIConfig.java", "diffHunk": "@@ -67,8 +86,33 @@ public JiraCloudDistributionUIConfig() {\n         ConfigField resolveWorkflow = new TextInputConfigField(JiraCloudDescriptor.KEY_RESOLVE_WORKFLOW_TRANSITION, LABEL_RESOLVE_WORKFLOW_TRANSITION, DESCRIPTION_RESOLVE_WORKFLOW_TRANSITION);\n         ConfigField openWorkflow = new TextInputConfigField(JiraCloudDescriptor.KEY_OPEN_WORKFLOW_TRANSITION, LABEL_OPEN_WORKFLOW_TRANSITION, DESCRIPTION_OPEN_WORKFLOW_TRANSITION)\n                                        .applyRequiredRelatedField(resolveWorkflow.getKey());\n+        ConfigField fieldMapping = new FieldMappingEndpointField(JiraCloudDescriptor.KEY_FIELD_MAPPING, LABEL_FIELD_MAPPING, DESCRIPTION_FIELD_MAPPING, \"Jira Field\", \"Value\")\n+                                       .applyNewMappingTitle(\"Create Jira Field Mapping\")\n+                                       .applyValidationFunctions(this::validateFieldMapping);\n+", "originalCommit": "4f3dcd163b2e0782d1919e15cefe4ecaf558dd8c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM5MDY5MQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1316#discussion_r547390691", "bodyText": "Same group comment here.", "author": "gkillough", "createdAt": "2020-12-22T16:59:16Z", "path": "channel/src/main/java/com/synopsys/integration/alert/channel/jira/server/descriptor/JiraServerDistributionUIConfig.java", "diffHunk": "@@ -64,8 +85,33 @@ public JiraServerDistributionUIConfig() {\n         ConfigField resolveWorkflow = new TextInputConfigField(JiraServerDescriptor.KEY_RESOLVE_WORKFLOW_TRANSITION, LABEL_RESOLVE_WORKFLOW_TRANSITION, DESCRIPTION_RESOLVE_WORKFLOW_TRANSITION);\n         ConfigField openWorkflow = new TextInputConfigField(JiraServerDescriptor.KEY_OPEN_WORKFLOW_TRANSITION, LABEL_OPEN_WORKFLOW_TRANSITION, DESCRIPTION_OPEN_WORKFLOW_TRANSITION)\n                                        .applyRequiredRelatedField(resolveWorkflow.getKey());\n+        ConfigField fieldMapping = new FieldMappingEndpointField(JiraCloudDescriptor.KEY_FIELD_MAPPING, LABEL_FIELD_MAPPING, DESCRIPTION_FIELD_MAPPING, \"Jira Field\", \"Value\")\n+                                       .applyNewMappingTitle(\"Create Jira Field Mapping\")\n+                                       .applyValidationFunctions(this::validateFieldMapping);\n+", "originalCommit": "4f3dcd163b2e0782d1919e15cefe4ecaf558dd8c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5649b0e0c25a9edb90fcbacc715469fb2bd130ac", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/5649b0e0c25a9edb90fcbacc715469fb2bd130ac", "message": "Refactor: moving field mapping to a panel, and updating the field descriptions", "committedDate": "2020-12-22T17:19:22Z", "type": "commit"}, {"oid": "e260a2ed0a64d538a65120f968535c488ae7f1e5", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/e260a2ed0a64d538a65120f968535c488ae7f1e5", "message": "Fixing potential NPE with the JiraServerJobDetailsAccessor", "committedDate": "2020-12-22T17:25:31Z", "type": "commit"}]}