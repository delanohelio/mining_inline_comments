{"pr_number": 1217, "pr_title": "Update headers to use Headers object", "pr_createdAt": "2020-10-12T13:54:26Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/1217", "timeline": [{"oid": "c1128e23410ee95a6869882cdccd4e8bae0ecef4", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/c1128e23410ee95a6869882cdccd4e8bae0ecef4", "message": "refactor: Updating fetches to use a Headers object", "committedDate": "2020-10-12T13:38:58Z", "type": "commit"}, {"oid": "a7ff57093ea5a43bf88ef64be2ec211ddf98010e", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a7ff57093ea5a43bf88ef64be2ec211ddf98010e", "message": "Merge branch 'master' into mc_accept_headers_object", "committedDate": "2020-10-12T13:39:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzMyMTU4Ng==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1217#discussion_r503321586", "bodyText": "Since headers is now an object, let's add functions to the object that does this for us. Such as\n\nheaders.addXCrsfToken(csrfToken)", "author": "bamandel", "createdAt": "2020-10-12T14:08:35Z", "path": "web/src/main/js/store/actions/audit.js", "diffHunk": "@@ -87,11 +87,11 @@ export function getAuditData(pageNumber, pageSize, searchTerm, sortField, sortOr\n         const errorHandlers = [];\n         errorHandlers.push(HTTPErrorUtils.createUnauthorizedHandler(unauthorized));\n         errorHandlers.push(HTTPErrorUtils.createForbiddenHandler(() => auditDataFetchError(HTTPErrorUtils.MESSAGES.FORBIDDEN_READ)));\n+        const headers = new Headers();\n+        headers.append('X-CSRF-TOKEN', csrfToken);", "originalCommit": "a7ff57093ea5a43bf88ef64be2ec211ddf98010e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzMyNzkyNg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1217#discussion_r503327926", "bodyText": "We should add functions for each of these 3 headers as they are the most commonly used.", "author": "bamandel", "createdAt": "2020-10-12T14:18:40Z", "path": "web/src/main/js/util/RequestUtilities.js", "diffHunk": "@@ -1,47 +1,47 @@\n export function createReadRequest(url, csrfToken) {\n+    const headers = new Headers();\n+    headers.append('Accept', 'application/json');\n+    headers.append('X-CSRF-TOKEN', csrfToken);\n     return fetch(url, {\n         credentials: 'same-origin',\n         method: 'GET',\n-        headers: {\n-            accept: 'application/json',\n-            'X-CSRF-TOKEN': csrfToken\n-        }\n+        headers\n     });\n }\n \n export function createUpdateRequest(url, csrfToken, body) {\n+    const headers = new Headers();\n+    headers.append('Accept', 'application/json');\n+    headers.append('Content-Type', 'application/json');\n+    headers.append('X-CSRF-TOKEN', csrfToken);", "originalCommit": "a7ff57093ea5a43bf88ef64be2ec211ddf98010e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzMyODgxNw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1217#discussion_r503328817", "bodyText": "You could also create constant header objects in the header class that will return this grouping of headers so you don't have to repeat it every time.", "author": "bamandel", "createdAt": "2020-10-12T14:20:02Z", "path": "web/src/main/js/util/configurationRequestBuilder.js", "diffHunk": "@@ -37,52 +37,52 @@ export function createReadRequest(apiUrl, csrfToken, configurationId = null) {\n     if (configurationId) {\n         url = url.concat(`/${configurationId}`);\n     }\n+    const headers = new Headers();\n+    headers.append('X-CSRF-TOKEN', csrfToken);\n     return fetch(url, {\n         credentials: 'same-origin',\n-        headers: {\n-            'X-CSRF-TOKEN': csrfToken\n-        }\n+        headers\n     });\n }\n \n export function createNewConfigurationRequest(apiUrl, csrfToken, fieldModel) {\n+    const headers = new Headers();\n+    headers.append('Accept', 'application/json');\n+    headers.append('Content-Type', 'application/json');\n+    headers.append('X-CSRF-TOKEN', csrfToken);", "originalCommit": "a7ff57093ea5a43bf88ef64be2ec211ddf98010e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzMyOTExMg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1217#discussion_r503329112", "bodyText": "The function would need to take in a csrfToken though.", "author": "bamandel", "createdAt": "2020-10-12T14:20:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzMyODgxNw=="}], "type": "inlineReview"}, {"oid": "f2c118d34a9dd667108bfaac061b4fcbc7fd02ab", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f2c118d34a9dd667108bfaac061b4fcbc7fd02ab", "message": "refactor: Update headers to use HeaderUtilities wrapper", "committedDate": "2020-10-12T19:30:01Z", "type": "commit"}, {"oid": "8e997468b24025e5dda9bfba176b814718189567", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/8e997468b24025e5dda9bfba176b814718189567", "message": "refactor: Adding descriptive method name to addApplicationJsonContentType and fixing missing csrf tokens", "committedDate": "2020-10-12T19:42:54Z", "type": "commit"}]}