{"pr_number": 1107, "pr_title": "Field Message refactor for feat_field_warnings", "pr_createdAt": "2020-08-07T15:00:46Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107", "timeline": [{"oid": "87daed148e0ee918cbe91a16f7965acbba6e7962", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/87daed148e0ee918cbe91a16f7965acbba6e7962", "message": "refactor: Move AlertFieldStatus and FieldErrorsSeverity to a new package", "committedDate": "2020-08-03T18:18:32Z", "type": "commit"}, {"oid": "a8c482b0acd59bb4b4abb06881266b8651704a4d", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a8c482b0acd59bb4b4abb06881266b8651704a4d", "message": "refactor: Change AlertFieldStatus to store the the FieldName rather than use a map for AlertFieldException", "committedDate": "2020-08-04T19:56:36Z", "type": "commit"}, {"oid": "a5499e7fbf6e85729703c5477ec178872d0da2a8", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a5499e7fbf6e85729703c5477ec178872d0da2a8", "message": "refactor: Update classes to remove HashMaps and use new AlertFieldStatus object", "committedDate": "2020-08-05T14:54:39Z", "type": "commit"}, {"oid": "d895afd73e02717c38c8f539ab0e8a97a1bbdc91", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/d895afd73e02717c38c8f539ab0e8a97a1bbdc91", "message": "test: Update tests to use Lists of AlertFieldStatus over HashMaps", "committedDate": "2020-08-07T13:47:40Z", "type": "commit"}, {"oid": "018e8453cf7ecdec2fee1c39b9776062918cef1d", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/018e8453cf7ecdec2fee1c39b9776062918cef1d", "message": "refactor: Update ValidationResult by making duplicate streams into private method", "committedDate": "2020-08-07T14:59:02Z", "type": "commit"}, {"oid": "6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "message": "refactor: Update LabelField to use ternary operator", "committedDate": "2020-08-07T15:07:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzExOTA4MA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467119080", "bodyText": "Is the idea for this method to turn the Array of ValidationResult's into a Collection?", "author": "jamesrichard91", "createdAt": "2020-08-07T15:41:49Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/descriptor/config/field/validators/ValidationResult.java", "diffHunk": "@@ -103,4 +99,11 @@ public String combineWarningMessages() {\n     private String combineMessages(Collection<String> messages) {\n         return StringUtils.join(messages, \", \");\n     }\n+\n+    private static Collection<String> getStatus(Function<ValidationResult, Collection<String>> mapResults, ValidationResult... validationResults) {", "originalCommit": "6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzEyMjEzOA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467122138", "bodyText": "this was created to simplify calling getErrors and getWarnings in the static of method above. We are using the ValidationResult(Collection<String> errors, Collection<String> warnings) constructor to set the errors and warnings collections.", "author": "ChomickiM", "createdAt": "2020-08-07T15:47:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzExOTA4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzExOTM2NQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467119365", "bodyText": "We should delete the commented out lines of code.", "author": "jamesrichard91", "createdAt": "2020-08-07T15:42:22Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/exception/AlertFieldException.java", "diffHunk": "@@ -22,52 +22,52 @@\n  */\n package com.synopsys.integration.alert.common.exception;\n \n-import java.util.Map;\n+import java.util.List;\n+\n+import com.synopsys.integration.alert.common.descriptor.config.field.errors.AlertFieldStatus;\n \n public class AlertFieldException extends AlertException {\n     private static final long serialVersionUID = 7993564907680483145L;\n \n-    private final Map<String, AlertFieldStatus> fieldErrors;\n+    private final List<AlertFieldStatus> fieldErrors;\n \n-    public static AlertFieldException singleFieldError(String fieldKey, AlertFieldStatus fieldError) {\n-        return new AlertFieldException(Map.of(fieldKey, fieldError));\n+    public static AlertFieldException singleFieldError(String fieldKey, String fieldError) {\n+        //return new AlertFieldException(Map.of(fieldKey, fieldError));", "originalCommit": "6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzEyMTM4Mw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467121383", "bodyText": "Can we change the variable name mapResults to extractValidationResults.", "author": "gkillough", "createdAt": "2020-08-07T15:45:49Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/descriptor/config/field/validators/ValidationResult.java", "diffHunk": "@@ -103,4 +99,11 @@ public String combineWarningMessages() {\n     private String combineMessages(Collection<String> messages) {\n         return StringUtils.join(messages, \", \");\n     }\n+\n+    private static Collection<String> getStatus(Function<ValidationResult, Collection<String>> mapResults, ValidationResult... validationResults) {", "originalCommit": "6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzEyMTk2Ng==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467121966", "bodyText": "We should update the variable name since it is no longer a Map.", "author": "jamesrichard91", "createdAt": "2020-08-07T15:46:59Z", "path": "src/main/java/com/synopsys/integration/alert/component/authentication/actions/AuthenticationTestAction.java", "diffHunk": "@@ -67,9 +67,9 @@ public MessageResult testConfig(String configId, FieldModel fieldModel, FieldAcc\n         boolean samlEnabled = registeredFieldValues.getBooleanOrFalse(AuthenticationDescriptor.KEY_SAML_ENABLED);\n         if (!ldapEnabled && !samlEnabled) {\n             String errorMessage = \"Enable LDAP or SAML authentication.\";\n-            Map<String, AlertFieldStatus> errorsMap = Map.of(\n-                AuthenticationDescriptor.KEY_LDAP_ENABLED, AlertFieldStatus.error(errorMessage),\n-                AuthenticationDescriptor.KEY_SAML_ENABLED, AlertFieldStatus.error(errorMessage));\n+            List<AlertFieldStatus> errorsMap = List.of(", "originalCommit": "6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzEyMjEyNg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467122126", "bodyText": "Update variable name", "author": "jamesrichard91", "createdAt": "2020-08-07T15:47:14Z", "path": "src/main/java/com/synopsys/integration/alert/component/authentication/actions/AuthenticationTestAction.java", "diffHunk": "@@ -112,7 +112,7 @@ private void performSAMLTest(FieldAccessor registeredFieldValues) throws Integra\n         Optional<ConfigurationFieldModel> metaDataFileField = registeredFieldValues.getField(AuthenticationDescriptor.KEY_SAML_METADATA_FILE);\n         boolean testMetaDataURL = metaDataURLField.map(ConfigurationFieldModel::isSet).orElse(false);\n         boolean testMetaDataFile = metaDataFileField.map(ConfigurationFieldModel::isSet).orElse(false);\n-        Map<String, AlertFieldStatus> errorsMap = new HashMap<>();\n+        List<AlertFieldStatus> errorsMap = new ArrayList<>();", "originalCommit": "6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzEyMjMxNQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467122315", "bodyText": "Update variable name", "author": "jamesrichard91", "createdAt": "2020-08-07T15:47:32Z", "path": "src/main/java/com/synopsys/integration/alert/component/authentication/actions/AuthenticationTestAction.java", "diffHunk": "@@ -89,15 +89,15 @@ private void performLdapTest(FieldModel fieldModel, FieldAccessor registeredFiel\n         String userName = fieldModel.getFieldValue(AuthenticationUIConfig.TEST_FIELD_KEY_USERNAME).orElse(\"\");\n         Optional<LdapAuthenticationProvider> ldapProvider = ldapManager.createAuthProvider(registeredFieldValues);\n         String errorMessage = String.format(\"Ldap Authentication test failed for the test user %s.  Please check the LDAP configuration.\", userName);\n-        Map<String, AlertFieldStatus> errorsMap = new HashMap<>();\n+        List<AlertFieldStatus> errorsMap = new ArrayList<>();", "originalCommit": "6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzEyNDA1Mg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467124052", "bodyText": "Let's rename this to just errors because it is no longer a Map. It also helps if we change the type in the future so that it's not coupled to a specific data structure.", "author": "gkillough", "createdAt": "2020-08-07T15:50:38Z", "path": "src/main/java/com/synopsys/integration/alert/component/authentication/actions/AuthenticationTestAction.java", "diffHunk": "@@ -67,9 +67,9 @@ public MessageResult testConfig(String configId, FieldModel fieldModel, FieldAcc\n         boolean samlEnabled = registeredFieldValues.getBooleanOrFalse(AuthenticationDescriptor.KEY_SAML_ENABLED);\n         if (!ldapEnabled && !samlEnabled) {\n             String errorMessage = \"Enable LDAP or SAML authentication.\";\n-            Map<String, AlertFieldStatus> errorsMap = Map.of(\n-                AuthenticationDescriptor.KEY_LDAP_ENABLED, AlertFieldStatus.error(errorMessage),\n-                AuthenticationDescriptor.KEY_SAML_ENABLED, AlertFieldStatus.error(errorMessage));\n+            List<AlertFieldStatus> errorsMap = List.of(", "originalCommit": "6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzEyNDE3NA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467124174", "bodyText": "errors", "author": "gkillough", "createdAt": "2020-08-07T15:50:51Z", "path": "src/main/java/com/synopsys/integration/alert/component/authentication/actions/AuthenticationTestAction.java", "diffHunk": "@@ -89,15 +89,15 @@ private void performLdapTest(FieldModel fieldModel, FieldAccessor registeredFiel\n         String userName = fieldModel.getFieldValue(AuthenticationUIConfig.TEST_FIELD_KEY_USERNAME).orElse(\"\");\n         Optional<LdapAuthenticationProvider> ldapProvider = ldapManager.createAuthProvider(registeredFieldValues);\n         String errorMessage = String.format(\"Ldap Authentication test failed for the test user %s.  Please check the LDAP configuration.\", userName);\n-        Map<String, AlertFieldStatus> errorsMap = new HashMap<>();\n+        List<AlertFieldStatus> errorsMap = new ArrayList<>();", "originalCommit": "6843bcc404eba87929b257a0a6cbd9d88e9e4e37", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d5b4632953258f344085f66c91350e828e3e50b3", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/d5b4632953258f344085f66c91350e828e3e50b3", "message": "style: Removing comments and renaming variables", "committedDate": "2020-08-07T16:03:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE4MDg5Nw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1107#discussion_r467180897", "bodyText": "We have DataStructureUtils which essentially does these conversions I believe. I would verify whether this class is absolutely necessary.", "author": "bamandel", "createdAt": "2020-08-07T17:42:43Z", "path": "src/test/java/com/synopsys/integration/alert/util/AlertFieldStatusConverter.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.synopsys.integration.alert.util;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.function.Function;\n+import java.util.stream.Collectors;\n+\n+import com.synopsys.integration.alert.common.descriptor.config.field.errors.AlertFieldStatus;\n+\n+public class AlertFieldStatusConverter {", "originalCommit": "d5b4632953258f344085f66c91350e828e3e50b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3a8e864c502e0bebc1dfded2e80246186490ed64", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/3a8e864c502e0bebc1dfded2e80246186490ed64", "message": "refactor: Add new static method to DataStructureUtils", "committedDate": "2020-08-07T19:21:34Z", "type": "commit"}]}