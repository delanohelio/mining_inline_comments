{"pr_number": 992, "pr_title": "Separating gradle tasks into their own files", "pr_createdAt": "2020-05-26T18:41:28Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/992", "timeline": [{"oid": "4820cec721e3aec17fb6a96bfc7d343a7d9b3bb5", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/4820cec721e3aec17fb6a96bfc7d343a7d9b3bb5", "message": "Build: moving some of the tasks into a separate file.", "committedDate": "2020-05-22T20:21:09Z", "type": "commit"}, {"oid": "80d030073eeb8a7de5de9879ab256b1d06a42f4e", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/80d030073eeb8a7de5de9879ab256b1d06a42f4e", "message": "Refactor: Updating the docker task handling. Moving the new .gradle files into the buildSrc directory", "committedDate": "2020-05-26T18:30:17Z", "type": "commit"}, {"oid": "7fa14cfe3334697496c838eba7055c8bd110eec7", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/7fa14cfe3334697496c838eba7055c8bd110eec7", "message": "Merge branch 'jr_docker_build_update' into jr_build_cleanup\n\n# Conflicts:\n#\tbuild.gradle", "committedDate": "2020-05-26T18:32:50Z", "type": "commit"}, {"oid": "12c25ddccd14463823fa8fa0e4647d149ea5d81a", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/12c25ddccd14463823fa8fa0e4647d149ea5d81a", "message": "Merge branch 'jr_docker_build_update' into jr_build_cleanup\n\n# Conflicts:\n#\tbuild.gradle", "committedDate": "2020-05-26T18:34:49Z", "type": "commit"}, {"oid": "a4bd31e396bf9fc14ac333d5c0908a84ecd485a2", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a4bd31e396bf9fc14ac333d5c0908a84ecd485a2", "message": "Fix: Updating the version tokens", "committedDate": "2020-05-26T18:46:07Z", "type": "commit"}, {"oid": "ae02a58c1f6b97db7b9fd955045be97c29ba2dbf", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/ae02a58c1f6b97db7b9fd955045be97c29ba2dbf", "message": "Merge branch 'master' into jr_build_cleanup", "committedDate": "2020-05-26T18:54:19Z", "type": "commit"}, {"oid": "a4812a621797b3d36bcd8937ba458e2c8a269332", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a4812a621797b3d36bcd8937ba458e2c8a269332", "message": "Merge branch 'master' into jr_build_cleanup\n\n# Conflicts:\n#\tbuild.gradle", "committedDate": "2020-05-28T21:10:39Z", "type": "commit"}, {"oid": "3f4acae58247de8c7982ad05f198c2f0975fd9c1", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/3f4acae58247de8c7982ad05f198c2f0975fd9c1", "message": "Build: updating the build files to set the postgres container version in the main build.gradle", "committedDate": "2020-05-29T14:12:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYwOTg0Nw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/992#discussion_r432609847", "bodyText": "Should this task be in the main gradle file since it is calling tasks from other gradle files?", "author": "psantos1113", "createdAt": "2020-05-29T16:48:52Z", "path": "buildSrc/docker.gradle", "diffHunk": "@@ -0,0 +1,55 @@\n+buildscript {\n+    repositories {\n+        mavenCentral()\n+    }\n+\n+    dependencies {\n+        classpath 'com.bmuschko:gradle-docker-plugin:6.4.0'\n+    }\n+}\n+\n+apply plugin: com.bmuschko.gradle.docker.DockerRemoteApiPlugin\n+\n+apply from: 'buildSrc/deploymentTasks.gradle'\n+\n+import com.bmuschko.gradle.docker.tasks.image.DockerBuildImage\n+\n+task untarArchiveForDocker(type: Copy, dependsOn: [build]) {\n+    from tarTree(\"${project.buildDir}/distributions/blackduck-alert-boot-${project.version}.tar\")\n+    into \"${project.buildDir}/docker\"\n+}\n+\n+task stageDocker(type: Copy, dependsOn: [untarArchiveForDocker]) {\n+    into \"${project.buildDir}/docker\"\n+    from(\"${project.projectDir}\") {\n+        include 'Dockerfile'\n+        include 'docker-entrypoint.sh'\n+    }\n+    from(\"${project.buildDir}/distributions\") {\n+        include \"blackduck-alert-boot-${project.version}.tar\"\n+    }\n+}\n+\n+task buildDockerImage(type: DockerBuildImage, dependsOn: [stageDocker]) {\n+    inputDir = file(\"${project.buildDir}/docker\")\n+    buildArgs = ['VERSION': \"${project.version}\"]\n+    images.add(\"blackducksoftware/${project.name}:${project.version}\")\n+}\n+\n+task dockerLogin(type: Exec) {\n+    commandLine \"docker\", \"login\", \"--username\", \"$System.env.DOCKER_INT_BLACKDUCK_USER\", \"--password\", \"$System.env.DOCKER_INT_BLACKDUCK_PASSWORD\"\n+}\n+\n+task pushImage(type: Exec, dependsOn: [buildDockerImage]) {\n+    commandLine \"docker\", \"push\", \"blackducksoftware/${project.name}:${project.version}\"\n+}\n+\n+task all(dependsOn: [build, helmValidation, createDeploymentZip, dockerLogin, buildDockerImage, pushImage]) {", "originalCommit": "3f4acae58247de8c7982ad05f198c2f0975fd9c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMyNTk1MA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/992#discussion_r433325950", "bodyText": "Good suggestion! That also removed the inter-dependencies of the task files.", "author": "jamesrichard91", "createdAt": "2020-06-01T15:52:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYwOTg0Nw=="}], "type": "inlineReview"}, {"oid": "929a11b7e395c5c7752d1dc11aac0d5945ea0139", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/929a11b7e395c5c7752d1dc11aac0d5945ea0139", "message": "Build: refactoring based on PR comments. Moving the 'all' task to the main build.gradle file", "committedDate": "2020-06-01T15:50:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMyNjk4MA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/992#discussion_r433326980", "bodyText": "Let's move this comment down to the line declaring the tags.", "author": "gkillough", "createdAt": "2020-06-01T15:53:09Z", "path": "build.gradle", "diffHunk": "@@ -22,21 +22,28 @@ plugins {\n }\n \n // Copied from src/test/java - com.synopsys.integration.alert.TestTags", "originalCommit": "929a11b7e395c5c7752d1dc11aac0d5945ea0139", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1a459707ce1ac9a0d05b57ffb01af1d081d47165", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/1a459707ce1ac9a0d05b57ffb01af1d081d47165", "message": "Build: Moving the test tag comment to the line defining the test tags", "committedDate": "2020-06-01T15:55:23Z", "type": "commit"}, {"oid": "a2ed8a4fd8745ad859a49d8c9ffc9ebbba61506b", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a2ed8a4fd8745ad859a49d8c9ffc9ebbba61506b", "message": "Merge branch 'master' into jr_build_cleanup", "committedDate": "2020-06-01T15:56:06Z", "type": "commit"}]}