{"pr_number": 907, "pr_title": "Add support for MySQL", "pr_createdAt": "2020-07-06T11:58:35Z", "pr_url": "https://github.com/ibissource/iaf/pull/907", "timeline": [{"oid": "053e4f15c3ab48dd4d7e9e4266fdcc9374145f80", "url": "https://github.com/ibissource/iaf/commit/053e4f15c3ab48dd4d7e9e4266fdcc9374145f80", "message": "Add basic support for MySQL\n\nTable names are case sensitive in MySQL, therefor made references to\ntables all uppercase.", "committedDate": "2020-07-06T11:57:55Z", "type": "commit"}, {"oid": "510ddf62f802f7ea322264d61458665e739fd0fd", "url": "https://github.com/ibissource/iaf/commit/510ddf62f802f7ea322264d61458665e739fd0fd", "message": "fixes", "committedDate": "2020-07-06T12:18:20Z", "type": "commit"}, {"oid": "6fdb02d7d937c4e42c594cc49df8fb1daf4df6c8", "url": "https://github.com/ibissource/iaf/commit/6fdb02d7d937c4e42c594cc49df8fb1daf4df6c8", "message": "Fix basic blob handling", "committedDate": "2020-07-06T14:39:15Z", "type": "commit"}, {"oid": "d3778bfcfad4a9a02b5a26ac5e88ca4a88cbf669", "url": "https://github.com/ibissource/iaf/commit/d3778bfcfad4a9a02b5a26ac5e88ca4a88cbf669", "message": "Add missing javax.sql.Types", "committedDate": "2020-07-06T15:30:42Z", "type": "commit"}, {"oid": "63707e0f755816bcb08b0c92f73be314283f384e", "url": "https://github.com/ibissource/iaf/commit/63707e0f755816bcb08b0c92f73be314283f384e", "message": "fix ibisconsoletest", "committedDate": "2020-07-06T15:42:23Z", "type": "commit"}, {"oid": "772759bad0cd05ebc57ad7134954ce1bb18f8341", "url": "https://github.com/ibissource/iaf/commit/772759bad0cd05ebc57ad7134954ce1bb18f8341", "message": "Use table IBISTEMP for BatchFileTransformerPipe, drop table IBISDATA", "committedDate": "2020-07-07T08:42:47Z", "type": "commit"}, {"oid": "1a9773f45b3daa00d9410e8468b7c70372c2b557", "url": "https://github.com/ibissource/iaf/commit/1a9773f45b3daa00d9410e8468b7c70372c2b557", "message": "Fix limit clause", "committedDate": "2020-07-07T08:44:05Z", "type": "commit"}, {"oid": "98801676ff8cbc71f6bb86cb061c3332efc55ec6", "url": "https://github.com/ibissource/iaf/commit/98801676ff8cbc71f6bb86cb061c3332efc55ec6", "message": "Use LONGBLOB/LONGCLOB datatypes in Liquibase for BLOBs", "committedDate": "2020-07-07T09:15:27Z", "type": "commit"}, {"oid": "c5c41063e57d99596ee5fb6b9a10e46fadb1a47b", "url": "https://github.com/ibissource/iaf/commit/c5c41063e57d99596ee5fb6b9a10e46fadb1a47b", "message": "Fix NPE in IbisDebuggerAdvice when in jms afterMessageProcessed", "committedDate": "2020-07-07T09:16:32Z", "type": "commit"}, {"oid": "e88ba22da17787bb78b8e37fc800c1b5ef2b2166", "url": "https://github.com/ibissource/iaf/commit/e88ba22da17787bb78b8e37fc800c1b5ef2b2166", "message": "ibisstore to uppercase", "committedDate": "2020-07-07T10:48:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc3OTUwNA==", "url": "https://github.com/ibissource/iaf/pull/907#discussion_r450779504", "bodyText": "oh oh, kom ik weer met mijn ENUM's", "author": "nielsm5", "createdAt": "2020-07-07T10:56:51Z", "path": "core/src/main/java/nl/nn/adapterframework/jdbc/dbms/DbmsSupportFactory.java", "diffHunk": "@@ -33,8 +33,10 @@\n public class DbmsSupportFactory implements IDbmsSupportFactory {\n \tprotected Logger log = LogUtil.getLogger(this.getClass());\n \n-\tprivate final static String PRODUCT_NAME_ORACLE_=\"Oracle\";\n-\tprivate final static String PRODUCT_NAME_MSSQLSERVER=\"Microsoft SQL Server\";\n+\tpublic final static String PRODUCT_NAME_ORACLE=\"Oracle\";\n+\tpublic final static String PRODUCT_NAME_MSSQLSERVER=\"Microsoft SQL Server\";\n+\tpublic final static String PRODUCT_NAME_MYSQL=\"MySQL\";\n+", "originalCommit": "c5c41063e57d99596ee5fb6b9a10e46fadb1a47b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc3OTgxNA==", "url": "https://github.com/ibissource/iaf/pull/907#discussion_r450779814", "bodyText": "ook enums?", "author": "nielsm5", "createdAt": "2020-07-07T10:57:26Z", "path": "core/src/main/java/nl/nn/adapterframework/jdbc/dbms/IDbmsSupportFactory.java", "diffHunk": "@@ -28,6 +28,7 @@\n \tfinal int DBMS_MSSQLSERVER=2;\n \tfinal int DBMS_DB2=3;\n \tfinal int DBMS_H2=4;\n+\tfinal int DBMS_MYSQL=5;", "originalCommit": "c5c41063e57d99596ee5fb6b9a10e46fadb1a47b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc4Mjg0Nw==", "url": "https://github.com/ibissource/iaf/pull/907#discussion_r450782847", "bodyText": "Misschien kan dit geheel vervangen worden met return JDBCType.valueOf(type)", "author": "nielsm5", "createdAt": "2020-07-07T11:03:42Z", "path": "core/src/main/java/nl/nn/adapterframework/util/DB2XMLWriter.java", "diffHunk": "@@ -74,40 +74,54 @@\n \tprivate String blobCharset = Misc.DEFAULT_INPUT_STREAM_ENCODING;\n \tprivate static boolean convertFieldnamesToUppercase = AppConstants.getInstance().getBoolean(\"jdbc.convertFieldnamesToUppercase\", false);\n \n-    public static String getFieldType (int type) {\n-\t    switch (type) {\n-\t          case Types.INTEGER : return (\"INTEGER\");\n-\t          case Types.NUMERIC : return (\"NUMERIC\");\n-\t          case Types.CHAR :    return (\"CHAR\");\n-\t          case Types.DATE :    return (\"DATE\");\n-\t          case Types.TIMESTAMP : return (\"TIMESTAMP\");\n-\t          case Types.DOUBLE : return (\"DOUBLE\");\n-\t          case Types.FLOAT : return (\"FLOAT\");\n-\t          case Types.ARRAY : return (\"ARRAY\");\n-\t          case Types.BLOB : return (\"BLOB\");\n-\t          case Types.CLOB : return (\"CLOB\");\n-\t          case Types.DISTINCT : return (\"DISTINCT\");\n-\t          case Types.LONGVARBINARY : return (\"LONGVARBINARY\");\n-\t          case Types.VARBINARY : return (\"VARBINARY\");\n-\t          case Types.BINARY : return (\"BINARY\");\n-\t          case Types.REF : return (\"REF\");\n-\t          case Types.STRUCT : return (\"STRUCT\");\n-\t          case Types.JAVA_OBJECT  : return (\"JAVA_OBJECT\");\n-\t          case Types.VARCHAR  : return (\"VARCHAR\");\n-\t          case Types.TINYINT: return (\"TINYINT\");\n-\t          case Types.TIME: return (\"TIME\");\n-\t          case Types.REAL: return (\"REAL\");\n-\t          case Types.BOOLEAN: return (\"BOOLEAN\");\n-\t          case Types.BIT: return (\"BIT\");\n-\t          case Types.BIGINT: return (\"BIGINT\");\n-\t          case Types.SMALLINT: return (\"SMALLINT\");\n+\tpublic static String getFieldType (int type) {\n+\t\tswitch (type) {\n+\t\t\tcase Types.INTEGER :   return \"INTEGER\";\n+\t\t\tcase Types.NUMERIC :   return \"NUMERIC\";\n+\t\t\tcase Types.CHAR :      return \"CHAR\";\n+\t\t\tcase Types.DATE :      return \"DATE\";\n+\t\t\tcase Types.TIMESTAMP : return \"TIMESTAMP\";\n+\t\t\tcase Types.DOUBLE :    return \"DOUBLE\";\n+\t\t\tcase Types.FLOAT :     return \"FLOAT\";\n+\t\t\tcase Types.ARRAY :     return \"ARRAY\";\n+\t\t\tcase Types.BLOB :      return \"BLOB\";\n+\t\t\tcase Types.CLOB :      return \"CLOB\";\n+\t\t\tcase Types.DISTINCT :  return \"DISTINCT\";\n+\t\t\tcase Types.LONGVARBINARY : return \"LONGVARBINARY\";\n+\t\t\tcase Types.VARBINARY : return \"VARBINARY\";\n+\t\t\tcase Types.BINARY :    return \"BINARY\";\n+\t\t\tcase Types.REF :       return \"REF\";\n+\t\t\tcase Types.STRUCT :    return \"STRUCT\";\n+\t\t\tcase Types.JAVA_OBJECT : return \"JAVA_OBJECT\";\n+\t\t\tcase Types.VARCHAR  :  return \"VARCHAR\";\n+\t\t\tcase Types.TINYINT:    return \"TINYINT\";\n+\t\t\tcase Types.TIME:       return \"TIME\";\n+\t\t\tcase Types.REAL:       return \"REAL\";\n+\t\t\tcase Types.BOOLEAN:    return \"BOOLEAN\";\n+\t\t\tcase Types.BIT:        return \"BIT\";\n+\t\t\tcase Types.BIGINT:     return \"BIGINT\";\n+\t\t\tcase Types.SMALLINT:   return \"SMALLINT\";\n+\t\t\tcase Types.DATALINK:   return \"DATALINK\";\n+\t\t\tcase Types.DECIMAL:    return \"DECIMAL\";\n+\t\t\tcase Types.LONGNVARCHAR: return \"LONGNVARCHAR\";\n+\t\t\tcase Types.LONGVARCHAR: return \"LONGVARCHAR\";\n+\t\t\tcase Types.NCHAR:      return \"NCHAR\";\n+\t\t\tcase Types.NCLOB:      return \"NCLOB\";\n+\t\t\tcase Types.NULL:       return \"NULL\";\n+\t\t\tcase Types.NVARCHAR:   return \"NVARCHAR\";\n+\t\t\tcase Types.OTHER:      return \"OTHER\";\n+\t\t\tcase Types.REF_CURSOR: return \"REF_CURSOR\";\n+\t\t\tcase Types.ROWID:      return \"ROWID\";\n+\t\t\tcase Types.SQLXML:     return \"SQLXML\";\n+\t\t\tcase Types.TIME_WITH_TIMEZONE: return \"TIME_WITH_TIMEZONE\";\n+\t\t\tcase Types.TIMESTAMP_WITH_TIMEZONE: return \"TIMESTAMP_WITH_TIMEZONE\";\n \t\t}\n-     \treturn (\"Unknown\");\n-    }\n+\t\treturn \"Unknown\";", "originalCommit": "e88ba22da17787bb78b8e37fc800c1b5ef2b2166", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc4NDEzMw==", "url": "https://github.com/ibissource/iaf/pull/907#discussion_r450784133", "bodyText": "Ik ben bang dat dit problemen op gaat lossen bij mensen die dit al een keer uitgevoerd hebben.\nOm dit te omzeilen kan je de oude checksum accepteren door de tag <validCheckSum>...</validCheckSum> toe te voegen", "author": "nielsm5", "createdAt": "2020-07-07T11:06:22Z", "path": "core/src/main/resources/IAF_WebControl/IAF_DatabaseChangelog.xml", "diffHunk": "@@ -36,7 +36,7 @@ TagDatabase\n \t\t\t<column name=\"CORRELATIONID\" type=\"java.sql.Types.VARCHAR(256)\"/>\n \t\t\t<column name=\"MESSAGEDATE\" type=\"DATETIME\"/>\n \t\t\t<column name=\"COMMENTS\" type=\"java.sql.Types.VARCHAR(1000)\"/>\n-\t\t\t<column name=\"MESSAGE\" type=\"BLOB\"/>\n+\t\t\t<column name=\"MESSAGE\" type=\"LONGBLOB\"/> <!-- LONGBLOB required for MySQL, compatible with BLOB for other dbmses -->", "originalCommit": "e88ba22da17787bb78b8e37fc800c1b5ef2b2166", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc4NzM5MQ==", "url": "https://github.com/ibissource/iaf/pull/907#discussion_r450787391", "bodyText": "Ik heb het getest tegen Oracle, H2 en MS SQL databases met bestaande tabellen. Die piepten niet.", "author": "gvanbrakel", "createdAt": "2020-07-07T11:13:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc4NDEzMw=="}], "type": "inlineReview"}, {"oid": "ea99e1b10f995ab937326fc99ac43a4c3dac78d2", "url": "https://github.com/ibissource/iaf/commit/ea99e1b10f995ab937326fc99ac43a4c3dac78d2", "message": "Fix issues", "committedDate": "2020-07-07T13:47:29Z", "type": "commit"}]}