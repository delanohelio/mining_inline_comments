{"pr_number": 1035, "pr_title": "Doclets: Continue separating content from information gathering", "pr_createdAt": "2020-09-04T07:14:51Z", "pr_url": "https://github.com/ibissource/iaf/pull/1035", "timeline": [{"oid": "1514138077fb5b061c2a10e75984c98ae2f52dc7", "url": "https://github.com/ibissource/iaf/commit/1514138077fb5b061c2a10e75984c98ae2f52dc7", "message": "Add Lombok and start separating content from information gathering\n\nThis is the first step to generate the Frank configuration schema, the\nFrankDoc and the syntax 1.0 lookup compile-time. The plan is to\nseparate the logic to gather the relevant information from the\nlogic that writes the generated files.", "committedDate": "2020-09-03T10:12:13Z", "type": "commit"}, {"oid": "158b40c91381e5098ff65a332b037f1d39ae6f48", "url": "https://github.com/ibissource/iaf/commit/158b40c91381e5098ff65a332b037f1d39ae6f48", "message": "Start splitting method addIbisBeanToSchema", "committedDate": "2020-09-03T12:03:34Z", "type": "commit"}, {"oid": "00e785a3aae899d26c1cbb3d3107799a4854226b", "url": "https://github.com/ibissource/iaf/commit/00e785a3aae899d26c1cbb3d3107799a4854226b", "message": "Refactor more of method addIbisBeanToSchema", "committedDate": "2020-09-03T13:29:46Z", "type": "commit"}, {"oid": "afb2fee4922673963d852a6dd985321fa96f6b21", "url": "https://github.com/ibissource/iaf/commit/afb2fee4922673963d852a6dd985321fa96f6b21", "message": "Refactor method addPropertiesToSchemaOrHtml", "committedDate": "2020-09-03T16:00:26Z", "type": "commit"}, {"oid": "60e06b3818d8965a2e27005c14608dd7cc5b4d8d", "url": "https://github.com/ibissource/iaf/commit/60e06b3818d8965a2e27005c14608dd7cc5b4d8d", "message": "Refactor JSON generation and uglify_lookup generation", "committedDate": "2020-09-04T08:08:30Z", "type": "commit"}, {"oid": "b52f957bf7d80ed6bca996322287a5b829399aea", "url": "https://github.com/ibissource/iaf/commit/b52f957bf7d80ed6bca996322287a5b829399aea", "message": "Merge branch 'master' into doclet2", "committedDate": "2020-09-07T11:16:47Z", "type": "commit"}, {"oid": "00221d5f4f9a6cf8707c2a2de8ff307354af9b21", "url": "https://github.com/ibissource/iaf/commit/00221d5f4f9a6cf8707c2a2de8ff307354af9b21", "message": "Finish removing information gathering logic from code that outputs HTML or XML", "committedDate": "2020-09-07T13:06:12Z", "type": "commit"}, {"oid": "627a0c910389bdb0fbd59a5064e714d4e22c5839", "url": "https://github.com/ibissource/iaf/commit/627a0c910389bdb0fbd59a5064e714d4e22c5839", "message": "Move info gathering logic to new class InfoBuilder", "committedDate": "2020-09-07T15:46:06Z", "type": "commit"}, {"oid": "0dfe5a2112d83b820fd7fa1a5d738094f2b1989d", "url": "https://github.com/ibissource/iaf/commit/0dfe5a2112d83b820fd7fa1a5d738094f2b1989d", "message": "Split servlet code and writing HTML and XML output", "committedDate": "2020-09-07T16:19:25Z", "type": "commit"}, {"oid": "39d873a0e86b56ce52568f51350cbdae319aef95", "url": "https://github.com/ibissource/iaf/commit/39d873a0e86b56ce52568f51350cbdae319aef95", "message": "Finish previous commit", "committedDate": "2020-09-08T08:14:06Z", "type": "commit"}, {"oid": "3e5cdd6152ceebc5e8f4c371364fe8261b3cee7b", "url": "https://github.com/ibissource/iaf/commit/3e5cdd6152ceebc5e8f4c371364fe8261b3cee7b", "message": "Turn AFolder and AClass into simple Java beans", "committedDate": "2020-09-08T09:13:10Z", "type": "commit"}, {"oid": "330aaecd03d442aaebabea900ca126cade7a9afa", "url": "https://github.com/ibissource/iaf/commit/330aaecd03d442aaebabea900ca126cade7a9afa", "message": "Small simplifications", "committedDate": "2020-09-08T09:43:44Z", "type": "commit"}, {"oid": "ba10637323d349f4dd6dd31ad83cc114ebd392ad", "url": "https://github.com/ibissource/iaf/commit/ba10637323d349f4dd6dd31ad83cc114ebd392ad", "message": "Remove most business logic from class AMethod", "committedDate": "2020-09-08T12:36:07Z", "type": "commit"}, {"oid": "007f8df1ffd6cc06e8ef692f9d3828d04482b993", "url": "https://github.com/ibissource/iaf/commit/007f8df1ffd6cc06e8ef692f9d3828d04482b993", "message": "Merge branch 'master' into doclet2", "committedDate": "2020-09-08T12:37:46Z", "type": "commit"}, {"oid": "3ccc2ba58691f6c8ddf39022ae058fa7fab6f375", "url": "https://github.com/ibissource/iaf/commit/3ccc2ba58691f6c8ddf39022ae058fa7fab6f375", "message": "Work in progress", "committedDate": "2020-09-08T13:25:38Z", "type": "commit"}, {"oid": "8932b59501be520f54f5b97648fd4acfa8576fcf", "url": "https://github.com/ibissource/iaf/commit/8932b59501be520f54f5b97648fd4acfa8576fcf", "message": "Not yet tested", "committedDate": "2020-09-08T16:07:29Z", "type": "commit"}, {"oid": "312b9df58186815d5531bf30f2b281f08c3eac10", "url": "https://github.com/ibissource/iaf/commit/312b9df58186815d5531bf30f2b281f08c3eac10", "message": "Merge branch 'master' into temp", "committedDate": "2020-09-09T07:20:43Z", "type": "commit"}, {"oid": "d6c82cef99aaf1e9715606815139796a94755d86", "url": "https://github.com/ibissource/iaf/commit/d6c82cef99aaf1e9715606815139796a94755d86", "message": "Fix producing ibisdoc.xsd", "committedDate": "2020-09-09T07:33:52Z", "type": "commit"}, {"oid": "91157c5f3826e8f7063171d4085ffabaed3758a1", "url": "https://github.com/ibissource/iaf/commit/91157c5f3826e8f7063171d4085ffabaed3758a1", "message": "Merge branch 'temp' into doclet2", "committedDate": "2020-09-09T07:34:21Z", "type": "commit"}, {"oid": "110164de19ac8d4fa850db8ba41f51398eda6301", "url": "https://github.com/ibissource/iaf/commit/110164de19ac8d4fa850db8ba41f51398eda6301", "message": "Information for generated docs comes from strict Java beans, but they contain reflect Class and Method", "committedDate": "2020-09-09T07:58:21Z", "type": "commit"}, {"oid": "9ac6a2709745d4d62ccf16566d6b8c138dc5ba00", "url": "https://github.com/ibissource/iaf/commit/9ac6a2709745d4d62ccf16566d6b8c138dc5ba00", "message": "Merge class IbisBeanExtra into class IbisBean", "committedDate": "2020-09-09T09:32:01Z", "type": "commit"}, {"oid": "ec96765b2bc24bd106726bd036a7cea4e6e93101", "url": "https://github.com/ibissource/iaf/commit/ec96765b2bc24bd106726bd036a7cea4e6e93101", "message": "Doc generation: add test for JSON and fix code for ibisdoc.xsd", "committedDate": "2020-09-09T11:29:00Z", "type": "commit"}, {"oid": "d97de197c417a4b01edf16d684408de5e45f2d66", "url": "https://github.com/ibissource/iaf/commit/d97de197c417a4b01edf16d684408de5e45f2d66", "message": "Merge branch 'addDocJsonTest' into doclet2", "committedDate": "2020-09-09T11:38:15Z", "type": "commit"}, {"oid": "38590e8aa44b0063f0624fb866c5617dcfe3d1dc", "url": "https://github.com/ibissource/iaf/commit/38590e8aa44b0063f0624fb866c5617dcfe3d1dc", "message": "Work in progress", "committedDate": "2020-09-10T06:56:49Z", "type": "commit"}, {"oid": "659ed6726798b95a74051e1ae60c1b5f98b6da91", "url": "https://github.com/ibissource/iaf/commit/659ed6726798b95a74051e1ae60c1b5f98b6da91", "message": "Fix calculating superclasses of AClass", "committedDate": "2020-09-10T08:41:44Z", "type": "commit"}, {"oid": "67e8bfc84c35013c14c2af19d0bcaa87e1403dc0", "url": "https://github.com/ibissource/iaf/commit/67e8bfc84c35013c14c2af19d0bcaa87e1403dc0", "message": "Another fix of setting superclasses", "committedDate": "2020-09-10T11:04:17Z", "type": "commit"}, {"oid": "8a17fd2e2614eb19ef499f56c2172d58bb8bd4de", "url": "https://github.com/ibissource/iaf/commit/8a17fd2e2614eb19ef499f56c2172d58bb8bd4de", "message": "All scenarios passed of IbisDocPipe test", "committedDate": "2020-09-10T14:43:36Z", "type": "commit"}, {"oid": "eafbec124fc83949cae7a721b4d6973d7ffcfaa3", "url": "https://github.com/ibissource/iaf/commit/eafbec124fc83949cae7a721b4d6973d7ffcfaa3", "message": "Fix workaround applied to JdbcIteratingPipeBase", "committedDate": "2020-09-10T15:26:32Z", "type": "commit"}, {"oid": "881520ae041aaccd9ac6548d1c7f617bb0479e30", "url": "https://github.com/ibissource/iaf/commit/881520ae041aaccd9ac6548d1c7f617bb0479e30", "message": "Improve names", "committedDate": "2020-09-10T15:58:49Z", "type": "commit"}, {"oid": "2f055572bc72943ed5e7f5c1c6334f23a414395c", "url": "https://github.com/ibissource/iaf/commit/2f055572bc72943ed5e7f5c1c6334f23a414395c", "message": "Make the code easier to understand", "committedDate": "2020-09-10T19:06:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgxOTUxOA==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r486819518", "bodyText": "Deze aanpassing moet NIET gedaan worden. De IbisDoc-code moet de documentatie ook kunnen vinden als de IbisDocRef naar FixedQuerySender verwijst.", "author": "gvanbrakel", "createdAt": "2020-09-11T07:13:08Z", "path": "core/src/main/java/nl/nn/adapterframework/jdbc/JdbcIteratingPipeBase.java", "diffHunk": "@@ -47,7 +47,7 @@\n \n \tprotected MixedQuerySender querySender = new MixedQuerySender();\n \n-\tprivate final String FIXEDQUERYSENDER = \"nl.nn.adapterframework.jdbc.FixedQuerySender\";\n+\tprivate final String JDBCQUERYSENDERBASE = \"nl.nn.adapterframework.jdbc.JdbcQuerySenderBase\";", "originalCommit": "881520ae041aaccd9ac6548d1c7f617bb0479e30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODEwMjM2OA==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r488102368", "bodyText": "Dit is min of meer opgelost. Ik heb de wijziging teruggedraaid. Er kwamen bugs aan het licht die ik in deze pull request gedeeltelijk ga oplossen. Ik voeg een TODO in de code toe voor het punt dat ik in een volgende pull request wil aanpakken.", "author": "mhdirkse", "createdAt": "2020-09-14T17:26:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgxOTUxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyMjc5OQ==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r486822799", "bodyText": "Ik vind deze naam een beetje complex.\nZou 'ChildElementMapping' niet net zo goed kunnen?", "author": "gvanbrakel", "createdAt": "2020-09-11T07:20:30Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/objects/MethodNameToChildIbisBeanNameMapping.java", "diffHunk": "@@ -0,0 +1,25 @@\n+/*\n+   Copyright 2019, 2020 Integration Partners\n+\n+   Licensed under the Apache License, Version 2.0 (the \"License\");\n+   you may not use this file except in compliance with the License.\n+   You may obtain a copy of the License at\n+\n+       http://www.apache.org/licenses/LICENSE-2.0\n+\n+   Unless required by applicable law or agreed to in writing, software\n+   distributed under the License is distributed on an \"AS IS\" BASIS,\n+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+   See the License for the specific language governing permissions and\n+   limitations under the License.\n+*/\n+package nl.nn.adapterframework.doc.objects;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+\n+public class MethodNameToChildIbisBeanNameMapping {", "originalCommit": "881520ae041aaccd9ac6548d1c7f617bb0479e30", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyNDAzMw==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r486824033", "bodyText": "Wat is er hier 'extra' en waarom?", "author": "gvanbrakel", "createdAt": "2020-09-11T07:23:06Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/objects/MethodExtra.java", "diffHunk": "@@ -0,0 +1,15 @@\n+package nl.nn.adapterframework.doc.objects;\n+\n+import java.lang.reflect.Method;\n+import java.util.TreeSet;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+\n+public class MethodExtra {", "originalCommit": "881520ae041aaccd9ac6548d1c7f617bb0479e30", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyNTMzOQ==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r486825339", "bodyText": "Bij elk class in src/main/java moet een dergelijke copyright notice staan. Je kan die bijwerken, maar je moet hem niet weghalen.", "author": "gvanbrakel", "createdAt": "2020-09-11T07:25:52Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/objects/IbisBean.java", "diffHunk": "@@ -1,43 +1,23 @@\n-/*\n-   Copyright 2019, 2020 Integration Partners\n-\n-   Licensed under the Apache License, Version 2.0 (the \"License\");\n-   you may not use this file except in compliance with the License.\n-   You may obtain a copy of the License at\n+package nl.nn.adapterframework.doc.objects;\n \n-       http://www.apache.org/licenses/LICENSE-2.0\n+import java.util.Map;\n \n-   Unless required by applicable law or agreed to in writing, software\n-   distributed under the License is distributed on an \"AS IS\" BASIS,\n-   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n-   See the License for the specific language governing permissions and\n-   limitations under the License.\n-*/", "originalCommit": "881520ae041aaccd9ac6548d1c7f617bb0479e30", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyNjUzMg==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r486826532", "bodyText": "Welke XML wordt hiermee gedigest?", "author": "gvanbrakel", "createdAt": "2020-09-11T07:28:18Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/DigesterXmlHandler.java", "diffHunk": "@@ -13,19 +13,21 @@\n    See the License for the specific language governing permissions and\n    limitations under the License.\n */\n-package nl.nn.adapterframework.doc.objects;\n+package nl.nn.adapterframework.doc;\n \n import org.xml.sax.Attributes;\n import org.xml.sax.SAXException;\n import org.xml.sax.helpers.DefaultHandler;\n \n+import nl.nn.adapterframework.doc.objects.MethodNameToChildIbisBeanNameMapping;\n+\n import java.util.ArrayList;\n import java.util.List;\n import java.util.StringTokenizer;\n \n public class DigesterXmlHandler extends DefaultHandler {", "originalCommit": "881520ae041aaccd9ac6548d1c7f617bb0479e30", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njg0ODE3Nw==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r486848177", "bodyText": "van deze vier regels kan je een method addElement() maken, waardoor het uiteindelijk veel duidelijker wordt wat er in getSchema() gebeurt.", "author": "gvanbrakel", "createdAt": "2020-09-11T08:10:34Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/DocWriter.java", "diffHunk": "@@ -0,0 +1,375 @@\n+package nl.nn.adapterframework.doc;\n+\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.TreeSet;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+import nl.nn.adapterframework.core.PipeRunException;\n+import nl.nn.adapterframework.doc.objects.AClass;\n+import nl.nn.adapterframework.doc.objects.AFolder;\n+import nl.nn.adapterframework.doc.objects.AMethod;\n+import nl.nn.adapterframework.doc.objects.BeanProperty;\n+import nl.nn.adapterframework.doc.objects.IbisBean;\n+import nl.nn.adapterframework.doc.objects.MethodExtra;\n+import nl.nn.adapterframework.doc.objects.DocInfo;\n+import nl.nn.adapterframework.util.XmlBuilder;\n+\n+public class DocWriter {\n+\tpublic static String getSchema(DocInfo docInfo) throws PipeRunException {\n+\t\tXmlBuilder schema;\n+\t\tXmlBuilder element;\n+\t\tXmlBuilder complexType;\n+\t\tXmlBuilder choice;\n+\n+\t\tschema = new XmlBuilder(\"schema\", \"xs\", \"http://www.w3.org/2001/XMLSchema\");\n+\t\tschema.addAttribute(\"xmlns:xs\", \"http://www.w3.org/2001/XMLSchema\");\n+\t\tschema.addAttribute(\"elementFormDefault\", \"qualified\");\n+\n+\t\telement = new XmlBuilder(\"element\", \"xs\", \"http://www.w3.org/2001/XMLSchema\");\n+\t\telement.addAttribute(\"name\", \"Configuration\");\n+\t\telement.addAttribute(\"type\", \"ConfigurationType\");\n+\t\tschema.addSubElement(element);", "originalCommit": "881520ae041aaccd9ac6548d1c7f617bb0479e30", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njg0ODcyOQ==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r486848729", "bodyText": "Wat wordt er hier gedigest?", "author": "gvanbrakel", "createdAt": "2020-09-11T08:11:36Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/DigesterXmlHandler.java", "diffHunk": "@@ -13,19 +13,21 @@\n    See the License for the specific language governing permissions and\n    limitations under the License.\n */\n-package nl.nn.adapterframework.doc.objects;\n+package nl.nn.adapterframework.doc;\n \n import org.xml.sax.Attributes;\n import org.xml.sax.SAXException;\n import org.xml.sax.helpers.DefaultHandler;\n \n+import nl.nn.adapterframework.doc.objects.MethodNameToChildIbisBeanNameMapping;\n+\n import java.util.ArrayList;\n import java.util.List;\n import java.util.StringTokenizer;\n \n public class DigesterXmlHandler extends DefaultHandler {\n     private String currentIbisBeanName;", "originalCommit": "881520ae041aaccd9ac6548d1c7f617bb0479e30", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "613ba9baa69a30e60c62f90d7c7015519595f12d", "url": "https://github.com/ibissource/iaf/commit/613ba9baa69a30e60c62f90d7c7015519595f12d", "message": "Fix expected value for JSON related to JsonXsltPipe", "committedDate": "2020-09-11T16:14:00Z", "type": "commit"}, {"oid": "4bd7c56b0ddc1adad1ac1495190e649cd675b29b", "url": "https://github.com/ibissource/iaf/commit/4bd7c56b0ddc1adad1ac1495190e649cd675b29b", "message": "Refactor code and fix tests again", "committedDate": "2020-09-11T16:15:27Z", "type": "commit"}, {"oid": "ca4f539c6556a9e925e3376c5576c9ba2cde4a63", "url": "https://github.com/ibissource/iaf/commit/ca4f539c6556a9e925e3376c5576c9ba2cde4a63", "message": "Undo unwanted change in JdbcIteratingPipeBase", "committedDate": "2020-09-14T08:25:22Z", "type": "commit"}, {"oid": "0f932ed5b34a9df17adf09cc28970d6171391f1e", "url": "https://github.com/ibissource/iaf/commit/0f932ed5b34a9df17adf09cc28970d6171391f1e", "message": "Fix XSD, not yet JSON", "committedDate": "2020-09-14T09:59:51Z", "type": "commit"}, {"oid": "5cbcdbc00817a2723710aa43729de06bceebe9d9", "url": "https://github.com/ibissource/iaf/commit/5cbcdbc00817a2723710aa43729de06bceebe9d9", "message": "Fix ibisdoc.json\n\nBlobLineIteratingPipe, ClobLineIteratingPipe and ResultSetIteratingPipe\ninherit from JdbcIteratingPipeBase. That class has @IbisDocRef\nannotations to FixedQuerySender. But that is not the end of the\nreferencing chain. Property datasourceName actually comes from a\nsuperclass of FixedQuerySender, which is JdbcFacade. The expected value\nis changed to include datasourceName. Furthermore, JdbcFacade is added\nto the superclasses of the three mentioned classes.", "committedDate": "2020-09-14T17:08:13Z", "type": "commit"}, {"oid": "c8d3ac2ecd4cd560cc6d48c729cbe88c09312975", "url": "https://github.com/ibissource/iaf/commit/c8d3ac2ecd4cd560cc6d48c729cbe88c09312975", "message": "Consider the superclasses of IbisDocRef target", "committedDate": "2020-09-14T17:16:41Z", "type": "commit"}, {"oid": "bd9d375bb042c392b0be71d0f85ea3707422a31c", "url": "https://github.com/ibissource/iaf/commit/bd9d375bb042c392b0be71d0f85ea3707422a31c", "message": "Follow-up of review comments", "committedDate": "2020-09-15T08:42:44Z", "type": "commit"}, {"oid": "ede4b8119b23f26ea9442a97f90d935a63eb2568", "url": "https://github.com/ibissource/iaf/commit/ede4b8119b23f26ea9442a97f90d935a63eb2568", "message": "Renames", "committedDate": "2020-09-15T09:18:01Z", "type": "commit"}, {"oid": "0f02d8c81486c92106167e84260b948a020ae2ec", "url": "https://github.com/ibissource/iaf/commit/0f02d8c81486c92106167e84260b948a020ae2ec", "message": "Merge branch 'master' into doclet2", "committedDate": "2020-09-15T09:28:40Z", "type": "commit"}, {"oid": "17b14ef85884c728561963cf662ac0b36ea696bb", "url": "https://github.com/ibissource/iaf/commit/17b14ef85884c728561963cf662ac0b36ea696bb", "message": "Simplify reviewing by renaming back to old names", "committedDate": "2020-09-17T08:37:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU5OTM0OQ==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r488599349", "bodyText": "De copyright notice moet helemaal bovenin de file staan, nog boven de package declaration.\nOok moet 'Integration Partners' steeds vervangen worden door 'WeAreFrank!'", "author": "gvanbrakel", "createdAt": "2020-09-15T11:42:38Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/objects/IbisBean.java", "diffHunk": "@@ -1,43 +1,39 @@\n-/*\n-   Copyright 2019, 2020 Integration Partners\n+package nl.nn.adapterframework.doc.objects;\n+\n+/* \n+Copyright 2019, 2020 Integration Partners \n \n-   Licensed under the Apache License, Version 2.0 (the \"License\");\n-   you may not use this file except in compliance with the License.\n-   You may obtain a copy of the License at\n+Licensed under the Apache License, Version 2.0 (the \"License\"); \n+you may not use this file except in compliance with the License. \n+You may obtain a copy of the License at \n \n-       http://www.apache.org/licenses/LICENSE-2.0\n+    http://www.apache.org/licenses/LICENSE-2.0 \n \n-   Unless required by applicable law or agreed to in writing, software\n-   distributed under the License is distributed on an \"AS IS\" BASIS,\n-   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n-   See the License for the specific language governing permissions and\n-   limitations under the License.\n+Unless required by applicable law or agreed to in writing, software \n+distributed under the License is distributed on an \"AS IS\" BASIS, \n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \n+See the License for the specific language governing permissions and \n+limitations under the License. \n */", "originalCommit": "0f02d8c81486c92106167e84260b948a020ae2ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk2OTg2OA==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r491969868", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-09-21T11:30:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU5OTM0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY2NjgzNA==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r488666834", "bodyText": "Als ik het goed begrijp is IbisMethod vervangen door MethodJson en MethodXsd.\nWaarom is dat? Het lijkt me voor de hand liggen om \u00e9\u00e9n datamodel te maken, waar je zowel XSD als JSON, als later misschien ook nog wel HTML, uit kan genereren.", "author": "gvanbrakel", "createdAt": "2020-09-15T13:28:26Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/objects/IbisMethod.java", "diffHunk": "@@ -1,49 +0,0 @@\n-/*\n-   Copyright 2019, 2020 Integration Partners\n-\n-   Licensed under the Apache License, Version 2.0 (the \"License\");\n-   you may not use this file except in compliance with the License.\n-   You may obtain a copy of the License at\n-\n-       http://www.apache.org/licenses/LICENSE-2.0\n-\n-   Unless required by applicable law or agreed to in writing, software\n-   distributed under the License is distributed on an \"AS IS\" BASIS,\n-   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n-   See the License for the specific language governing permissions and\n-   limitations under the License.\n-*/\n-package nl.nn.adapterframework.doc.objects;\n-\n-public class IbisMethod {", "originalCommit": "0f02d8c81486c92106167e84260b948a020ae2ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk2OTI5OA==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r491969298", "bodyText": "JSON werd gegenereerd met aparte code. Dat los ik in deze pull request nog niet op. Ik had een nieuwe class MethodXsd nodig om lokale variabelen in de XSD flow te vervangen.", "author": "mhdirkse", "createdAt": "2020-09-21T11:29:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY2NjgzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk2OTczMg==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r491969732", "bodyText": "MethodJson was de oude AMethod. Inmiddels heb ik hem terug hernoemd naar AMethod.", "author": "mhdirkse", "createdAt": "2020-09-21T11:30:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY2NjgzNA=="}], "type": "inlineReview"}, {"oid": "4b712037e3009a665777ece1b429b9757eadc0ce", "url": "https://github.com/ibissource/iaf/commit/4b712037e3009a665777ece1b429b9757eadc0ce", "message": "Name back renamed class for easy review and correct copyright", "committedDate": "2020-09-21T11:25:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg1ODczNg==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r492858736", "bodyText": "Ik zie dat excludeFilters naar DocInfo verplaatst is, maar ik vind deze configuratie van excludes niet meer terug. Waar is die gebleven? Of is die niet meer nodig?", "author": "gvanbrakel", "createdAt": "2020-09-22T16:06:10Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/IbisDocPipe.java", "diffHunk": "@@ -15,328 +15,30 @@\n */\n package nl.nn.adapterframework.doc;\n \n-import java.io.IOException;\n-import java.lang.reflect.Method;\n-import java.lang.reflect.Modifier;\n-import java.util.ArrayList;\n-import java.util.Arrays;\n-import java.util.Comparator;\n-import java.util.HashMap;\n-import java.util.HashSet;\n-import java.util.Iterator;\n-import java.util.LinkedHashMap;\n-import java.util.List;\n-import java.util.Map;\n-import java.util.Set;\n-import java.util.TreeSet;\n-import java.util.regex.Pattern;\n-\n-import org.apache.commons.lang3.StringUtils;\n-import org.apache.logging.log4j.Logger;\n-import org.springframework.beans.factory.BeanDefinitionStoreException;\n-import org.springframework.beans.factory.config.BeanDefinition;\n-import org.springframework.beans.factory.support.BeanDefinitionRegistry;\n-import org.springframework.beans.factory.support.BeanNameGenerator;\n-import org.springframework.beans.factory.support.SimpleBeanDefinitionRegistry;\n-import org.springframework.context.annotation.AnnotationBeanNameGenerator;\n-import org.springframework.context.annotation.ClassPathBeanDefinitionScanner;\n-import org.springframework.core.annotation.AnnotationUtils;\n-import org.springframework.core.type.filter.AssignableTypeFilter;\n-import org.springframework.core.type.filter.RegexPatternTypeFilter;\n-import org.springframework.util.Assert;\n-import org.xml.sax.SAXException;\n-\n-import nl.nn.adapterframework.core.IPipe;\n import nl.nn.adapterframework.core.IPipeLineSession;\n import nl.nn.adapterframework.core.ParameterException;\n import nl.nn.adapterframework.core.PipeRunException;\n import nl.nn.adapterframework.core.PipeRunResult;\n-import nl.nn.adapterframework.doc.objects.AMethod;\n-import nl.nn.adapterframework.doc.objects.DigesterXmlHandler;\n-import nl.nn.adapterframework.doc.objects.IbisBean;\n-import nl.nn.adapterframework.doc.objects.IbisMethod;\n-import nl.nn.adapterframework.doc.objects.SchemaInfo;\n-import nl.nn.adapterframework.doc.objects.SpringBean;\n+import nl.nn.adapterframework.doc.objects.DocInfo;\n import nl.nn.adapterframework.parameters.ParameterList;\n import nl.nn.adapterframework.parameters.ParameterValueList;\n import nl.nn.adapterframework.pipes.FixedForwardPipe;\n import nl.nn.adapterframework.stream.Message;\n-import nl.nn.adapterframework.util.ClassUtils;\n-import nl.nn.adapterframework.util.LogUtil;\n-import nl.nn.adapterframework.util.Misc;\n-import nl.nn.adapterframework.util.XmlBuilder;\n-import nl.nn.adapterframework.util.XmlUtils;\n \n /**\n  * Generate documentation and XSD for code completion of beautiful Ibis configurations in Eclipse\n  *\n  * @author Jaco de Groot\n  */\n public class IbisDocPipe extends FixedForwardPipe {\n-\tprivate static Logger log = LogUtil.getLogger(IbisDocPipe.class);\n-\tprivate static Set<String> excludeFilters = new TreeSet<String>();\n-\tstatic {\n-\t\t// Exclude classes that will give conflicts with existing, non-compatible bean definition of same name and class\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.esb\\\\.WsdlGeneratorPipe\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.ifsa\\\\.IfsaRequesterSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.ifsa\\\\.IfsaProviderListener\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco2\\\\.SapSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco2\\\\.SapListener\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco2\\\\.SapLUWManager\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco3\\\\.SapSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco3\\\\.SapListener\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco3\\\\.SapLUWManager\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.CommandSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.EchoSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.FixedResultSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.LogSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.MailSender\");\n-\t\texcludeFilters.add(\".*\\\\.IbisstoreSummaryQuerySender\");\n-\t\t// Exclude classes that cannot be used directly in configurations\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.MessageSendingPipe\");\n-\t\t\n-\t\t// Exclude classes that should only be used in internal configurations\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.doc\\\\.IbisDocPipe\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.webcontrol\\\\..*\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.CreateRestViewPipe\");", "originalCommit": "4b712037e3009a665777ece1b429b9757eadc0ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI4OTQ2MQ==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r493289461", "bodyText": "Class nl.nn.adapterframework.doc.InfoBuilderSource", "author": "mhdirkse", "createdAt": "2020-09-23T08:10:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg1ODczNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg2MDQwNg==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r492860406", "bodyText": "Klopt het dat deze sortWeigths niet meer gebruikt worden?", "author": "gvanbrakel", "createdAt": "2020-09-22T16:08:37Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/IbisDocPipe.java", "diffHunk": "@@ -15,328 +15,30 @@\n */\n package nl.nn.adapterframework.doc;\n \n-import java.io.IOException;\n-import java.lang.reflect.Method;\n-import java.lang.reflect.Modifier;\n-import java.util.ArrayList;\n-import java.util.Arrays;\n-import java.util.Comparator;\n-import java.util.HashMap;\n-import java.util.HashSet;\n-import java.util.Iterator;\n-import java.util.LinkedHashMap;\n-import java.util.List;\n-import java.util.Map;\n-import java.util.Set;\n-import java.util.TreeSet;\n-import java.util.regex.Pattern;\n-\n-import org.apache.commons.lang3.StringUtils;\n-import org.apache.logging.log4j.Logger;\n-import org.springframework.beans.factory.BeanDefinitionStoreException;\n-import org.springframework.beans.factory.config.BeanDefinition;\n-import org.springframework.beans.factory.support.BeanDefinitionRegistry;\n-import org.springframework.beans.factory.support.BeanNameGenerator;\n-import org.springframework.beans.factory.support.SimpleBeanDefinitionRegistry;\n-import org.springframework.context.annotation.AnnotationBeanNameGenerator;\n-import org.springframework.context.annotation.ClassPathBeanDefinitionScanner;\n-import org.springframework.core.annotation.AnnotationUtils;\n-import org.springframework.core.type.filter.AssignableTypeFilter;\n-import org.springframework.core.type.filter.RegexPatternTypeFilter;\n-import org.springframework.util.Assert;\n-import org.xml.sax.SAXException;\n-\n-import nl.nn.adapterframework.core.IPipe;\n import nl.nn.adapterframework.core.IPipeLineSession;\n import nl.nn.adapterframework.core.ParameterException;\n import nl.nn.adapterframework.core.PipeRunException;\n import nl.nn.adapterframework.core.PipeRunResult;\n-import nl.nn.adapterframework.doc.objects.AMethod;\n-import nl.nn.adapterframework.doc.objects.DigesterXmlHandler;\n-import nl.nn.adapterframework.doc.objects.IbisBean;\n-import nl.nn.adapterframework.doc.objects.IbisMethod;\n-import nl.nn.adapterframework.doc.objects.SchemaInfo;\n-import nl.nn.adapterframework.doc.objects.SpringBean;\n+import nl.nn.adapterframework.doc.objects.DocInfo;\n import nl.nn.adapterframework.parameters.ParameterList;\n import nl.nn.adapterframework.parameters.ParameterValueList;\n import nl.nn.adapterframework.pipes.FixedForwardPipe;\n import nl.nn.adapterframework.stream.Message;\n-import nl.nn.adapterframework.util.ClassUtils;\n-import nl.nn.adapterframework.util.LogUtil;\n-import nl.nn.adapterframework.util.Misc;\n-import nl.nn.adapterframework.util.XmlBuilder;\n-import nl.nn.adapterframework.util.XmlUtils;\n \n /**\n  * Generate documentation and XSD for code completion of beautiful Ibis configurations in Eclipse\n  *\n  * @author Jaco de Groot\n  */\n public class IbisDocPipe extends FixedForwardPipe {\n-\tprivate static Logger log = LogUtil.getLogger(IbisDocPipe.class);\n-\tprivate static Set<String> excludeFilters = new TreeSet<String>();\n-\tstatic {\n-\t\t// Exclude classes that will give conflicts with existing, non-compatible bean definition of same name and class\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.esb\\\\.WsdlGeneratorPipe\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.ifsa\\\\.IfsaRequesterSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.ifsa\\\\.IfsaProviderListener\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco2\\\\.SapSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco2\\\\.SapListener\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco2\\\\.SapLUWManager\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco3\\\\.SapSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco3\\\\.SapListener\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.extensions\\\\.sap\\\\.jco3\\\\.SapLUWManager\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.CommandSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.EchoSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.FixedResultSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.LogSender\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.MailSender\");\n-\t\texcludeFilters.add(\".*\\\\.IbisstoreSummaryQuerySender\");\n-\t\t// Exclude classes that cannot be used directly in configurations\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.MessageSendingPipe\");\n-\t\t\n-\t\t// Exclude classes that should only be used in internal configurations\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.doc\\\\.IbisDocPipe\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.webcontrol\\\\..*\");\n-\t\texcludeFilters.add(\"nl\\\\.nn\\\\.adapterframework\\\\.pipes\\\\.CreateRestViewPipe\");\n-\t}\n-\tprivate static Map<String, String> ignores = new HashMap<String, String>();\n-\tstatic {\n-\t\t// Adding a sender to a listener has been used in the past but is not (commonly) used anymore\n-\t\tignores.put(\"Listener\", \"Sender\");\n-\t}\n-\tprivate static List<String> excludeNameAttribute = new ArrayList<String>();\n-\tstatic {\n-\t\texcludeNameAttribute.add(\"putValidator\");\n-\t\texcludeNameAttribute.add(\"putWrapper\");\n-\t}\n-\tprivate static List<String> overwriteMaxOccursToOne= new ArrayList<String>();\n-\tstatic {\n-\t\t// When registerPipeLine in Adapter has been renamed to setPipeLine this workaround can be removed.\n-\t\toverwriteMaxOccursToOne.add(\"registerPipeLine\");\n-\t}\n-\tprivate static List<String> overwriteMaxOccursToUnbounded = new ArrayList<String>();\n-\tstatic {\n-\t\t// The setSender in ParallelSenders adds senders to a list. When setSender  has been renamed to addSender this\n-\t\t// workaround can be removed.\n-\t\toverwriteMaxOccursToUnbounded.add(\"parallelSendersSender\");\n-\t}\n-\t// Influence the order of elements in the XSD, this will override the alphabetic order.\n-\t// Instead of using the Maps below it might be a good idea to use annotations on the specified methods.\n-\tprivate static Map<String, Integer> sortWeightAdapter = new HashMap<String, Integer>();\n-\tstatic {\n-\t\tsortWeightAdapter.put(\"registerReceiver\", 100);\n-\t}\n-\tprivate static Map<String, Integer> sortWeightReceiver = new HashMap<String, Integer>();", "originalCommit": "4b712037e3009a665777ece1b429b9757eadc0ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzMwMjg3OA==", "url": "https://github.com/ibissource/iaf/pull/1035#discussion_r493302878", "bodyText": "Ik heb de sortWeights ook verplaatst naar nl.nn.adapterframework.doc.InfoBuilderSource. Ik zal vertellen waarom ik deze class in het leven heb geroepen. Toen ik met file IbisDocPipe werkte, merkte ik dat de code boven method doPipe() en de code vanaf doPipe() aparte eenheden vormen. De code boven doPipe() had het karakter van utilities, terwijl het gebruik van die utilities vanaf doPipe() was. Het leek me overzichtelijk om dit expliciet te maken door een aparte klasse te maken. In de code die ik gemaakt heb is duidelijker welke stappen worden genomen om de DocInfo te vullen. Details over hoe dat gebeurt, zoals lange lijsten waardes en Spring details staan nu apart.", "author": "mhdirkse", "createdAt": "2020-09-23T08:23:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg2MDQwNg=="}], "type": "inlineReview"}]}