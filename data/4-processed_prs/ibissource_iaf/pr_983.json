{"pr_number": 983, "pr_title": "Add Amount of pages pipe to Aspose module", "pr_createdAt": "2020-08-10T08:54:16Z", "pr_url": "https://github.com/ibissource/iaf/pull/983", "timeline": [{"oid": "1a796ab7fb1cea386835b88ee9b4f26c485e3b94", "url": "https://github.com/ibissource/iaf/commit/1a796ab7fb1cea386835b88ee9b4f26c485e3b94", "message": "Merge pull request #1 from ibissource/master\n\nMerge", "committedDate": "2020-03-26T15:21:19Z", "type": "commit"}, {"oid": "b5e578e45a7c0bf1e4846e16136e04be3a9d4b15", "url": "https://github.com/ibissource/iaf/commit/b5e578e45a7c0bf1e4846e16136e04be3a9d4b15", "message": "Merge branch 'master' of https://github.com/ibissource/iaf", "committedDate": "2020-04-01T12:46:06Z", "type": "commit"}, {"oid": "d966ccbf341d3335ef99b5877912f31085fd529b", "url": "https://github.com/ibissource/iaf/commit/d966ccbf341d3335ef99b5877912f31085fd529b", "message": "Merge branch 'master' of https://github.com/ibissource/iaf", "committedDate": "2020-04-16T16:42:40Z", "type": "commit"}, {"oid": "3363f89d543ae2127cb39ba6863c8c8189c41857", "url": "https://github.com/ibissource/iaf/commit/3363f89d543ae2127cb39ba6863c8c8189c41857", "message": "Merge branch 'master' of https://github.com/ibissource/iaf", "committedDate": "2020-04-29T14:39:29Z", "type": "commit"}, {"oid": "c99cb5b06b2663ad013f4b31552b4ca606ebc370", "url": "https://github.com/ibissource/iaf/commit/c99cb5b06b2663ad013f4b31552b4ca606ebc370", "message": "Merge branch 'master' of https://github.com/ibissource/iaf", "committedDate": "2020-05-19T09:02:57Z", "type": "commit"}, {"oid": "e34a8471a5bf93a31e8817aac128f84a4c3ef839", "url": "https://github.com/ibissource/iaf/commit/e34a8471a5bf93a31e8817aac128f84a4c3ef839", "message": "Merge branch 'master' of https://github.com/ibissource/iaf", "committedDate": "2020-06-22T13:03:03Z", "type": "commit"}, {"oid": "9549c1e8cd4e6c13e9c59487747ef57f396d0069", "url": "https://github.com/ibissource/iaf/commit/9549c1e8cd4e6c13e9c59487747ef57f396d0069", "message": "Merge branch 'master' of https://github.com/ibissource/iaf", "committedDate": "2020-06-25T12:46:59Z", "type": "commit"}, {"oid": "cffed786d591c0b26ca0b860a1ff86c7e512b9ab", "url": "https://github.com/ibissource/iaf/commit/cffed786d591c0b26ca0b860a1ff86c7e512b9ab", "message": "Merge branch 'master' of https://github.com/ibissource/iaf", "committedDate": "2020-07-06T11:25:58Z", "type": "commit"}, {"oid": "7863ff0613daed8ff08a385de0aa3a461d86d34f", "url": "https://github.com/ibissource/iaf/commit/7863ff0613daed8ff08a385de0aa3a461d86d34f", "message": "Merge branch 'master' of https://github.com/ibissource/iaf", "committedDate": "2020-08-10T08:33:42Z", "type": "commit"}, {"oid": "5ba9b6f5960dad52038eb30d4328e111a9dfdd29", "url": "https://github.com/ibissource/iaf/commit/5ba9b6f5960dad52038eb30d4328e111a9dfdd29", "message": "Add amount of pages pipe", "committedDate": "2020-08-10T08:47:10Z", "type": "commit"}, {"oid": "2f22df7734ad4412b058d1e724e5f7c2a12ce594", "url": "https://github.com/ibissource/iaf/commit/2f22df7734ad4412b058d1e724e5f7c2a12ce594", "message": "Add java/ibis doc and license info", "committedDate": "2020-08-10T08:49:56Z", "type": "commit"}, {"oid": "9c8764711acd0c5934755c79d6b4e801ecb1eb19", "url": "https://github.com/ibissource/iaf/commit/9c8764711acd0c5934755c79d6b4e801ecb1eb19", "message": "Fix codacy", "committedDate": "2020-08-10T09:28:45Z", "type": "commit"}, {"oid": "b2e4120fcf5ce4065911f4262c8abf570cb47637", "url": "https://github.com/ibissource/iaf/commit/b2e4120fcf5ce4065911f4262c8abf570cb47637", "message": "Private string*", "committedDate": "2020-08-10T09:31:38Z", "type": "commit"}, {"oid": "a730cc600d661d671438fa78684b2f9eac951ee8", "url": "https://github.com/ibissource/iaf/commit/a730cc600d661d671438fa78684b2f9eac951ee8", "message": "Remove OcrPipe", "committedDate": "2020-08-10T09:33:28Z", "type": "commit"}, {"oid": "505bc8006aef4cb2f84d542b71393390870080e3", "url": "https://github.com/ibissource/iaf/commit/505bc8006aef4cb2f84d542b71393390870080e3", "message": "Import IbisDoc", "committedDate": "2020-08-10T11:46:18Z", "type": "commit"}, {"oid": "82c9681c056920241d5482c10281bacb48291131", "url": "https://github.com/ibissource/iaf/commit/82c9681c056920241d5482c10281bacb48291131", "message": "Add passwordProtected forward", "committedDate": "2020-08-10T12:31:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA5MjkwNQ==", "url": "https://github.com/ibissource/iaf/pull/983#discussion_r472092905", "bodyText": "Why isn't this StreamUtil.DEFAULT_INPUT_STREAM_ENCODING?", "author": "gvanbrakel", "createdAt": "2020-08-18T10:59:16Z", "path": "aspose/src/main/java/nl/nn/adapterframework/extensions/aspose/pipe/AmountOfPagesPipe.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+   Copyright 2019, 2020 WeAreFrank!\n+\n+   Licensed under the Apache License, Version 2.0 (the \"License\");\n+   you may not use this file except in compliance with the License.\n+   You may obtain a copy of the License at\n+\n+       http://www.apache.org/licenses/LICENSE-2.0\n+\n+   Unless required by applicable law or agreed to in writing, software\n+   distributed under the License is distributed on an \"AS IS\" BASIS,\n+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+   See the License for the specific language governing permissions and\n+   limitations under the License.\n+*/\n+package nl.nn.adapterframework.extensions.aspose.pipe;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+\n+import nl.nn.adapterframework.configuration.ConfigurationException;\n+import nl.nn.adapterframework.core.IPipeLineSession;\n+import nl.nn.adapterframework.core.PipeRunException;\n+import nl.nn.adapterframework.core.PipeRunResult;\n+import nl.nn.adapterframework.doc.IbisDoc;\n+import nl.nn.adapterframework.pipes.FixedForwardPipe;\n+import nl.nn.adapterframework.stream.Message;\n+import com.aspose.pdf.Document;\n+\n+/**\n+ * Returns the amount of pages of a PDF file.\n+ * \n+ * \n+ * @author Laurens M\u00e4kel\n+ * @since  7.6\n+ *\n+ */\n+public class AmountOfPagesPipe extends FixedForwardPipe {\n+\tprivate String charset = \"ISO-8859-1\";", "originalCommit": "82c9681c056920241d5482c10281bacb48291131", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ5NTU4MQ==", "url": "https://github.com/ibissource/iaf/pull/983#discussion_r488495581", "bodyText": "I have written this pipe for a use case where we use ISO-8859-1.", "author": "Laurens-makel", "createdAt": "2020-09-15T08:47:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA5MjkwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDE0NzcxMg==", "url": "https://github.com/ibissource/iaf/pull/983#discussion_r544147712", "bodyText": "Misschien de default op utf-8 zetten, dat is namelijk overal binnen het framework zo.", "author": "nielsm5", "createdAt": "2020-12-16T09:35:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA5MjkwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzczMjI2Nw==", "url": "https://github.com/ibissource/iaf/pull/983#discussion_r563732267", "bodyText": "Done", "author": "Laurens-makel", "createdAt": "2021-01-25T13:43:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA5MjkwNQ=="}], "type": "inlineReview"}, {"oid": "c38a1ce94c778f71bdb0e65191f1094569c66728", "url": "https://github.com/ibissource/iaf/commit/c38a1ce94c778f71bdb0e65191f1094569c66728", "message": "Merge branch 'master' of https://github.com/ibissource/iaf", "committedDate": "2020-08-25T07:24:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDE0NzQ0NQ==", "url": "https://github.com/ibissource/iaf/pull/983#discussion_r544147445", "bodyText": "je moet de inputstream ook sluiten. (of doet document dit!??) Ik stel voor, om voor de zekerheid, een try-with-resources block te gebruiken.", "author": "nielsm5", "createdAt": "2020-12-16T09:35:19Z", "path": "aspose/src/main/java/nl/nn/adapterframework/extensions/aspose/pipe/AmountOfPagesPipe.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+   Copyright 2019, 2020 WeAreFrank!\n+\n+   Licensed under the Apache License, Version 2.0 (the \"License\");\n+   you may not use this file except in compliance with the License.\n+   You may obtain a copy of the License at\n+\n+       http://www.apache.org/licenses/LICENSE-2.0\n+\n+   Unless required by applicable law or agreed to in writing, software\n+   distributed under the License is distributed on an \"AS IS\" BASIS,\n+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+   See the License for the specific language governing permissions and\n+   limitations under the License.\n+*/\n+package nl.nn.adapterframework.extensions.aspose.pipe;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+\n+import nl.nn.adapterframework.configuration.ConfigurationException;\n+import nl.nn.adapterframework.core.IPipeLineSession;\n+import nl.nn.adapterframework.core.PipeRunException;\n+import nl.nn.adapterframework.core.PipeRunResult;\n+import nl.nn.adapterframework.doc.IbisDoc;\n+import nl.nn.adapterframework.pipes.FixedForwardPipe;\n+import nl.nn.adapterframework.stream.Message;\n+import com.aspose.pdf.Document;\n+\n+/**\n+ * Returns the amount of pages of a PDF file.\n+ * \n+ * \n+ * @author Laurens M\u00e4kel\n+ * @since  7.6\n+ *\n+ */\n+public class AmountOfPagesPipe extends FixedForwardPipe {\n+\tprivate String charset = \"ISO-8859-1\";\n+\n+\t@Override\n+\tpublic void configure() throws ConfigurationException {\n+\t\tsuper.configure();\n+\t}\n+\n+\t@Override\n+\tpublic PipeRunResult doPipe(Message input, IPipeLineSession session) throws PipeRunException {\n+\t\tint result = 0;\n+\n+\t\tInputStream binaryInputStream;\n+\t\ttry {\n+\t\t\tbinaryInputStream = input.asInputStream(getCharset());\n+\t\t} catch (IOException e1) {\n+\t\t\tthrow new PipeRunException(this,\n+\t\t\t\t\t\tgetLogPrefix(session) + \"cannot encode message using charset [\" + getCharset() + \"]\", e1);\n+\t\t}\n+\n+\t\ttry {\n+\t\t\tDocument doc = new Document(binaryInputStream);", "originalCommit": "82c9681c056920241d5482c10281bacb48291131", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzczMjA3Mw==", "url": "https://github.com/ibissource/iaf/pull/983#discussion_r563732073", "bodyText": "Done", "author": "Laurens-makel", "createdAt": "2021-01-25T13:43:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDE0NzQ0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NTE2NDgyMQ==", "url": "https://github.com/ibissource/iaf/pull/983#discussion_r565164821", "bodyText": "Het kan nog eenvoudiger. Je kan regels 53 t/m 61 vervangen door:\ntry (InputStream binaryInputStream = input.asInputStream(getCharset())) {\n\nen dan regels 66 t/m 75 vervangen door een simpele catch clause", "author": "gvanbrakel", "createdAt": "2021-01-27T09:45:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDE0NzQ0NQ=="}], "type": "inlineReview"}, {"oid": "3771d2a0fa70f3c45978ea727f5bd51584ae0379", "url": "https://github.com/ibissource/iaf/commit/3771d2a0fa70f3c45978ea727f5bd51584ae0379", "message": "Merge branch 'master' into AmountOfPagesPipe", "committedDate": "2021-01-25T12:56:27Z", "type": "commit"}, {"oid": "73e450bd5b7e49a410e3e671a898e86725a8e217", "url": "https://github.com/ibissource/iaf/commit/73e450bd5b7e49a410e3e671a898e86725a8e217", "message": "Fix imports and set default encoding to FF standards", "committedDate": "2021-01-25T13:30:40Z", "type": "commit"}, {"oid": "db33ad748b07138d80728b22495dc10c6ac15063", "url": "https://github.com/ibissource/iaf/commit/db33ad748b07138d80728b22495dc10c6ac15063", "message": "Close stream after reading amount of pages", "committedDate": "2021-01-25T13:39:38Z", "type": "commit"}, {"oid": "ea60839ad9b7895a54b0e9d524bb02635632d79d", "url": "https://github.com/ibissource/iaf/commit/ea60839ad9b7895a54b0e9d524bb02635632d79d", "message": "Refactor try catch statement in amount of pages pipe", "committedDate": "2021-01-27T10:09:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MzU4MDg5MA==", "url": "https://github.com/ibissource/iaf/pull/983#discussion_r573580890", "bodyText": "De default is UTF-8", "author": "gvanbrakel", "createdAt": "2021-02-10T09:41:40Z", "path": "aspose/src/main/java/nl/nn/adapterframework/extensions/aspose/pipe/AmountOfPagesPipe.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/*\n+   Copyright 2019, 2020 WeAreFrank!\n+\n+   Licensed under the Apache License, Version 2.0 (the \"License\");\n+   you may not use this file except in compliance with the License.\n+   You may obtain a copy of the License at\n+\n+       http://www.apache.org/licenses/LICENSE-2.0\n+\n+   Unless required by applicable law or agreed to in writing, software\n+   distributed under the License is distributed on an \"AS IS\" BASIS,\n+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+   See the License for the specific language governing permissions and\n+   limitations under the License.\n+*/\n+package nl.nn.adapterframework.extensions.aspose.pipe;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+\n+import nl.nn.adapterframework.configuration.ConfigurationException;\n+import nl.nn.adapterframework.core.IPipeLineSession;\n+import nl.nn.adapterframework.core.PipeRunException;\n+import nl.nn.adapterframework.core.PipeRunResult;\n+import nl.nn.adapterframework.doc.IbisDoc;\n+import nl.nn.adapterframework.pipes.FixedForwardPipe;\n+import nl.nn.adapterframework.stream.Message;\n+import nl.nn.adapterframework.util.StreamUtil;\n+\n+import com.aspose.pdf.Document;\n+import com.aspose.pdf.exceptions.InvalidPasswordException;\n+\n+/**\n+ * Returns the amount of pages of a PDF file.\n+ * \n+ * \n+ * @author Laurens M\u00e4kel\n+ * @since  7.6\n+ *\n+ */\n+public class AmountOfPagesPipe extends FixedForwardPipe {\n+\tprivate String charset = StreamUtil.DEFAULT_INPUT_STREAM_ENCODING;\n+\n+\t@Override\n+\tpublic void configure() throws ConfigurationException {\n+\t\tsuper.configure();\n+\t}\n+\n+\t@Override\n+\tpublic PipeRunResult doPipe(Message input, IPipeLineSession session) throws PipeRunException {\n+\t\tint result = 0;\n+\n+\t\ttry (InputStream binaryInputStream = input.asInputStream(getCharset())){\n+\t\t\tDocument doc = new Document(binaryInputStream);\n+\t\t\tresult = doc.getPages().size();\n+\t\t\tbinaryInputStream.close();\n+\t\t} catch (IOException e1) {\n+\t\t\tthrow new PipeRunException(this,\n+\t\t\t\t\t\tgetLogPrefix(session) + \"cannot encode message using charset [\" + getCharset() + \"]\", e1);\n+\t\t} catch (InvalidPasswordException ip) {\n+\t\t\treturn new PipeRunResult(findForward(\"passwordProtected\"), \"File is password protected.\" );\n+\t\t}\n+      \n+\t\treturn new PipeRunResult(getForward(), Integer.toString(result) );\n+\t}\n+\n+\t@IbisDoc({ \"charset to be used to encode the given input string \", \"ISO-8859-1\" })", "originalCommit": "ea60839ad9b7895a54b0e9d524bb02635632d79d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8f3cc49df6adef865aa203547ee58b361790367a", "url": "https://github.com/ibissource/iaf/commit/8f3cc49df6adef865aa203547ee58b361790367a", "message": "Merge branch 'master' into AmountOfPagesPipe", "committedDate": "2021-03-11T11:18:42Z", "type": "commit"}, {"oid": "8b31ffa7c90be211c2bb9b4efa0b6df3737c432f", "url": "https://github.com/ibissource/iaf/commit/8b31ffa7c90be211c2bb9b4efa0b6df3737c432f", "message": "Update AmountOfPagesPipe.java", "committedDate": "2021-03-11T11:22:41Z", "type": "commit"}]}