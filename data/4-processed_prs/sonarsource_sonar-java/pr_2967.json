{"pr_number": 2967, "pr_title": "SONARJAVA-3349 support AssertJ assertions with missing message", "pr_createdAt": "2020-05-26T15:01:09Z", "pr_url": "https://github.com/SonarSource/sonar-java/pull/2967", "timeline": [{"oid": "ea982d7b86ec7a98ec82f0203b5b07644756462b", "url": "https://github.com/SonarSource/sonar-java/commit/ea982d7b86ec7a98ec82f0203b5b07644756462b", "message": "SONARJAVA-3349 Added support AssertJ assertions lacking messages. Also added support for a couple more message methods in Fest along the way, reducing the FP rate.", "committedDate": "2020-05-26T10:36:53Z", "type": "commit"}, {"oid": "9a96b256b4ee9bcf13f226e9a21b3607c37458e1", "url": "https://github.com/SonarSource/sonar-java/commit/9a96b256b4ee9bcf13f226e9a21b3607c37458e1", "message": "SONARJAVA-3349 Added ruling findings for S2698 to expected findings.", "committedDate": "2020-05-26T14:59:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk1MTM3NQ==", "url": "https://github.com/SonarSource/sonar-java/pull/2967#discussion_r430951375", "bodyText": "You can merge these two matchers.", "author": "quentin-jaquier-sonarsource", "createdAt": "2020-05-27T08:38:44Z", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/AssertionsWithoutMessageCheck.java", "diffHunk": "@@ -51,33 +62,48 @@\n   @Override\n   protected MethodMatchers getMethodInvocationMatchers() {\n     return MethodMatchers.or(\n-      MethodMatchers.create().ofTypes(\"org.junit.jupiter.api.Assertions\").name(name -> name.startsWith(ASSERT) || name.equals(\"fail\")).withAnyParameters().build(),\n-      MethodMatchers.create().ofTypes(\"org.junit.Assert\").name(name -> name.startsWith(ASSERT) || name.equals(\"fail\")).withAnyParameters().build(),\n-      MethodMatchers.create().ofTypes(\"junit.framework.Assert\").name(name -> name.startsWith(ASSERT) || name.startsWith(\"fail\")).withAnyParameters().build(),\n-      MethodMatchers.create().ofTypes(\"org.fest.assertions.Fail\").name(name -> name.startsWith(\"fail\")).withAnyParameters().build(),\n-      MethodMatchers.create().ofSubTypes(GENERIC_ASSERT).anyName().withAnyParameters().build()\n+      MethodMatchers.create()\n+        .ofTypes(\"org.junit.jupiter.api.Assertions\", \"org.junit.Assert\", \"junit.framework.Assert\", \"org.fest.assertions.Fail\",\n+          \"org.assertj.core.api.Fail\")\n+        .name(name -> name.startsWith(ASSERT) || name.equals(\"fail\")).withAnyParameters().build(),\n+      MethodMatchers.create().ofSubTypes(FEST_GENERIC_ASSERT).anyName().withAnyParameters().build(),\n+      MethodMatchers.create().ofSubTypes(ASSERTJ_ABSTRACT_ASSERT).anyName().withAnyParameters().build()", "originalCommit": "ea982d7b86ec7a98ec82f0203b5b07644756462b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk1OTI4OQ==", "url": "https://github.com/SonarSource/sonar-java/pull/2967#discussion_r430959289", "bodyText": "I feel we can find a better name for the parameter, to clearly show that it will match message methods.", "author": "quentin-jaquier-sonarsource", "createdAt": "2020-05-27T08:51:47Z", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/AssertionsWithoutMessageCheck.java", "diffHunk": "@@ -128,19 +166,21 @@ private static boolean isAssertWithTwoParams(MethodInvocationTree mit) {\n   }\n \n   private static boolean isString(ExpressionTree expressionTree) {\n-    return expressionTree.symbolType().is(\"java.lang.String\");\n+    return expressionTree.symbolType().is(JAVA_LANG_STRING);\n   }\n \n-  private static class FestVisitor extends BaseTreeVisitor {\n+  private static class FestLikeVisitor extends BaseTreeVisitor {\n     boolean useDescription = false;\n+    private final MethodMatchers methodMatchers;\n+\n+    public FestLikeVisitor(MethodMatchers methodMatchers) {", "originalCommit": "ea982d7b86ec7a98ec82f0203b5b07644756462b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6b7a1f505400512e021a7f247c6f73bb156d4acc", "url": "https://github.com/SonarSource/sonar-java/commit/6b7a1f505400512e021a7f247c6f73bb156d4acc", "message": "SONARJAVA-3349 Improved rule description/title and improved naming of a variable.", "committedDate": "2020-05-27T09:35:07Z", "type": "commit"}, {"oid": "c616355f0461c993ba04490ce9b85b32a1b1c68f", "url": "https://github.com/SonarSource/sonar-java/commit/c616355f0461c993ba04490ce9b85b32a1b1c68f", "message": "Merged two MethodMatchers", "committedDate": "2020-05-27T09:58:08Z", "type": "commit"}]}