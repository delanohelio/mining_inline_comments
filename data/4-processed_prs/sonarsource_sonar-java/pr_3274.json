{"pr_number": 3274, "pr_title": "SONARJAVA-3617 S1170 should not raise an issue when the initializer contains \"this\" or \"super\"", "pr_createdAt": "2020-11-16T14:20:55Z", "pr_url": "https://github.com/SonarSource/sonar-java/pull/3274", "timeline": [{"oid": "9a2f70ffa33a2085d7766718198a9ff109492016", "url": "https://github.com/SonarSource/sonar-java/commit/9a2f70ffa33a2085d7766718198a9ff109492016", "message": "SONARJAVA-3617 S1170 raises should not raise an issue when the initializer contains \"this\" or \"super\"", "committedDate": "2020-11-16T15:26:58Z", "type": "commit"}, {"oid": "9a2f70ffa33a2085d7766718198a9ff109492016", "url": "https://github.com/SonarSource/sonar-java/commit/9a2f70ffa33a2085d7766718198a9ff109492016", "message": "SONARJAVA-3617 S1170 raises should not raise an issue when the initializer contains \"this\" or \"super\"", "committedDate": "2020-11-16T15:26:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTAxMjE0Mw==", "url": "https://github.com/SonarSource/sonar-java/pull/3274#discussion_r525012143", "bodyText": "Would be nice to extract it to a separate method. And combine these 2 conditions using Predicate.or() if possible.", "author": "margarita-nedzelska-sonarsource", "createdAt": "2020-11-17T09:37:22Z", "path": "java-checks/src/main/java/org/sonar/java/checks/ConstantsShouldBeStaticFinalCheck.java", "diffHunk": "@@ -96,7 +96,14 @@ private static boolean hasConstantInitializer(VariableTree variableTree) {\n       if (init.is(Tree.Kind.NEW_ARRAY)) {\n         return false;\n       }\n-      return !containsChildrenOfKind((JavaTree) init, Tree.Kind.METHOD_INVOCATION, Tree.Kind.NEW_CLASS);\n+      return !containsChildMatchingPredicate((JavaTree) init, tree -> {\n+          if (tree.is(Tree.Kind.IDENTIFIER)) {", "originalCommit": "9a2f70ffa33a2085d7766718198a9ff109492016", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7a021418f35c33db92434807058948e99750d23e", "url": "https://github.com/SonarSource/sonar-java/commit/7a021418f35c33db92434807058948e99750d23e", "message": "Extract methods and use predicate.or", "committedDate": "2020-11-17T10:42:54Z", "type": "commit"}, {"oid": "d2b535f9753ed608975353c760e6bfaea0003896", "url": "https://github.com/SonarSource/sonar-java/commit/d2b535f9753ed608975353c760e6bfaea0003896", "message": "Migrate test file in compiled module for S1170", "committedDate": "2020-11-17T11:21:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExMDU3Ng==", "url": "https://github.com/SonarSource/sonar-java/pull/3274#discussion_r525110576", "bodyText": "Looks like my suggestion was not that elegant. For me it will be more readable to use lambda.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ((Predicate<Tree>) ConstantsShouldBeStaticFinalCheck::isIgnoredKind).or(ConstantsShouldBeStaticFinalCheck::isThisOrSuper));\n          \n          \n            \n                    (tree -> isIgnoredKind(tree) || isThisOrSuper(tree)));", "author": "margarita-nedzelska-sonarsource", "createdAt": "2020-11-17T12:17:58Z", "path": "java-checks/src/main/java/org/sonar/java/checks/ConstantsShouldBeStaticFinalCheck.java", "diffHunk": "@@ -96,7 +96,20 @@ private static boolean hasConstantInitializer(VariableTree variableTree) {\n       if (init.is(Tree.Kind.NEW_ARRAY)) {\n         return false;\n       }\n-      return !containsChildrenOfKind((JavaTree) init, Tree.Kind.METHOD_INVOCATION, Tree.Kind.NEW_CLASS);\n+      return !containsChildMatchingPredicate((JavaTree) init,\n+        ((Predicate<Tree>) ConstantsShouldBeStaticFinalCheck::isIgnoredKind).or(ConstantsShouldBeStaticFinalCheck::isThisOrSuper));", "originalCommit": "d2b535f9753ed608975353c760e6bfaea0003896", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTEzMjUyMg==", "url": "https://github.com/SonarSource/sonar-java/pull/3274#discussion_r525132522", "bodyText": "Of course, thanks!", "author": "quentin-jaquier-sonarsource", "createdAt": "2020-11-17T12:56:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExMDU3Ng=="}], "type": "inlineReview"}, {"oid": "acee354242c0fa5a3cdabd2769617c861d2a3a68", "url": "https://github.com/SonarSource/sonar-java/commit/acee354242c0fa5a3cdabd2769617c861d2a3a68", "message": "Update java-checks/src/main/java/org/sonar/java/checks/ConstantsShouldBeStaticFinalCheck.java\n\nCo-authored-by: margarita-nedzelska-sonarsource <70522623+margarita-nedzelska-sonarsource@users.noreply.github.com>", "committedDate": "2020-11-17T12:56:22Z", "type": "commit"}]}