{"pr_number": 3174, "pr_title": "SONARJAVA-3523 Extend S3415 (Arguments order) to support TestNG assertions", "pr_createdAt": "2020-09-11T16:57:00Z", "pr_url": "https://github.com/SonarSource/sonar-java/pull/3174", "timeline": [{"oid": "c33918fcfc77f84129d6916ba030b252c9bb16b1", "url": "https://github.com/SonarSource/sonar-java/commit/c33918fcfc77f84129d6916ba030b252c9bb16b1", "message": "SONARJAVA-3523 Extend S3415 (Arguments order) to support TestNG assertions", "committedDate": "2020-09-11T17:08:12Z", "type": "commit"}, {"oid": "c33918fcfc77f84129d6916ba030b252c9bb16b1", "url": "https://github.com/SonarSource/sonar-java/commit/c33918fcfc77f84129d6916ba030b252c9bb16b1", "message": "SONARJAVA-3523 Extend S3415 (Arguments order) to support TestNG assertions", "committedDate": "2020-09-11T17:08:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc4NzcwNQ==", "url": "https://github.com/SonarSource/sonar-java/pull/3174#discussion_r487787705", "bodyText": "Maybe it would be nice if you move all string literals into constants to have the consistency here", "author": "margarita-nedzelska-sonarsource", "createdAt": "2020-09-14T09:49:46Z", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/AssertionArgumentOrderCheck.java", "diffHunk": "@@ -59,12 +65,17 @@\n   protected MethodMatchers getMethodInvocationMatchers() {\n     return MethodMatchers.or(\n       MethodMatchers.create().ofTypes(ORG_JUNIT_ASSERT)\n-        .names(\"assertEquals\", \"assertSame\", \"assertNotSame\")\n+        .names(ASSERT_EQUALS, ASSERT_SAME, ASSERT_NOT_SAME)\n+        .withAnyParameters()\n+        .build(),\n+      // TestNG\n+      MethodMatchers.create().ofTypes(ORG_TESTNG_ASSERT)\n+        .names(ASSERT_EQUALS, ASSERT_NOT_EQUALS, ASSERT_SAME, ASSERT_NOT_SAME)\n         .withAnyParameters()\n         .build(),\n       // JUnit 5\n       MethodMatchers.create().ofTypes(ORG_JUNIT5_ASSERTIONS)\n-        .names(\"assertArrayEquals\", \"assertEquals\", \"assertIterableEquals\", \"assertLinesMatch\", \"assertNotEquals\", \"assertNotSame\", \"assertSame\")\n+        .names(\"assertArrayEquals\", ASSERT_EQUALS, \"assertIterableEquals\", \"assertLinesMatch\", ASSERT_NOT_EQUALS, ASSERT_NOT_SAME, ASSERT_SAME)", "originalCommit": "c33918fcfc77f84129d6916ba030b252c9bb16b1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc5MDIzOA==", "url": "https://github.com/SonarSource/sonar-java/pull/3174#discussion_r487790238", "bodyText": "This message could be extracted to string constants, cause it's used in few places.", "author": "margarita-nedzelska-sonarsource", "createdAt": "2020-09-14T09:54:00Z", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/AssertionArgumentOrderCheck.java", "diffHunk": "@@ -77,11 +88,14 @@ protected MethodMatchers getMethodInvocationMatchers() {\n \n   @Override\n   protected void onMethodInvocationFound(MethodInvocationTree mit) {\n-    if (mit.symbol().owner().type().is(ORG_JUNIT5_ASSERTIONS)) {\n+    Type ownerType = mit.symbol().owner().type();\n+    if (ownerType.is(ORG_JUNIT5_ASSERTIONS)) {\n       checkArguments(mit.arguments().get(0), mit.arguments().get(1), \"expected value, actual value\");", "originalCommit": "c33918fcfc77f84129d6916ba030b252c9bb16b1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc5MDY4NQ==", "url": "https://github.com/SonarSource/sonar-java/pull/3174#discussion_r487790685", "bodyText": "Could be moved to constants too.", "author": "margarita-nedzelska-sonarsource", "createdAt": "2020-09-14T09:54:37Z", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/AssertionArgumentOrderCheck.java", "diffHunk": "@@ -77,11 +88,14 @@ protected MethodMatchers getMethodInvocationMatchers() {\n \n   @Override\n   protected void onMethodInvocationFound(MethodInvocationTree mit) {\n-    if (mit.symbol().owner().type().is(ORG_JUNIT5_ASSERTIONS)) {\n+    Type ownerType = mit.symbol().owner().type();\n+    if (ownerType.is(ORG_JUNIT5_ASSERTIONS)) {\n       checkArguments(mit.arguments().get(0), mit.arguments().get(1), \"expected value, actual value\");\n-    } else if (mit.symbol().owner().type().is(ORG_JUNIT_ASSERT)) {\n+    } else if (ownerType.is(ORG_JUNIT_ASSERT)) {\n       ExpressionTree argToCheck = getActualArgument(mit);\n       checkArguments(previousArg(argToCheck, mit), argToCheck, \"expected value, actual value\");\n+    } else if (ownerType.is(ORG_TESTNG_ASSERT)) {\n+      checkArguments(mit.arguments().get(1), mit.arguments().get(0), \"actual value, expected value\");", "originalCommit": "c33918fcfc77f84129d6916ba030b252c9bb16b1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc5MTcwNw==", "url": "https://github.com/SonarSource/sonar-java/pull/3174#discussion_r487791707", "bodyText": "I am not sure whether these matchers could be used in other places. If so, might be a nice candidate for moving to Utils/Helpers", "author": "margarita-nedzelska-sonarsource", "createdAt": "2020-09-14T09:56:08Z", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/AssertionArgumentOrderCheck.java", "diffHunk": "@@ -59,12 +65,17 @@\n   protected MethodMatchers getMethodInvocationMatchers() {\n     return MethodMatchers.or(\n       MethodMatchers.create().ofTypes(ORG_JUNIT_ASSERT)", "originalCommit": "c33918fcfc77f84129d6916ba030b252c9bb16b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAxMjc5Mg==", "url": "https://github.com/SonarSource/sonar-java/pull/3174#discussion_r488012792", "bodyText": "This matcher is related to 4 specific methods of org.junit.Assert that have an expected and an actual argument. I didn't find this exact need in other rules related to org.junit.Assert, so I keep this matcher here for now.", "author": "alban-auzeill", "createdAt": "2020-09-14T15:15:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc5MTcwNw=="}], "type": "inlineReview"}, {"oid": "d27ad37aaf93411680b9426cb601997bd5a7a829", "url": "https://github.com/SonarSource/sonar-java/commit/d27ad37aaf93411680b9426cb601997bd5a7a829", "message": "Move string literals into constants", "committedDate": "2020-09-14T15:17:21Z", "type": "commit"}]}