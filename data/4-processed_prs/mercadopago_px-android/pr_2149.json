{"pr_number": 2149, "pr_title": "[Feature] CVV caixa", "pr_createdAt": "2020-05-14T14:41:57Z", "pr_url": "https://github.com/mercadopago/px-android/pull/2149", "timeline": [{"oid": "9b8537ee3e1329b6ab6b5bbd647a6f50403aca2d", "url": "https://github.com/mercadopago/px-android/commit/9b8537ee3e1329b6ab6b5bbd647a6f50403aca2d", "message": "update model, layout updated", "committedDate": "2020-05-13T14:00:34Z", "type": "commit"}, {"oid": "ba054ceb899ebb8af19db45930a0c17e504f2b88", "url": "https://github.com/mercadopago/px-android/commit/ba054ceb899ebb8af19db45930a0c17e504f2b88", "message": "add sample", "committedDate": "2020-05-13T17:31:33Z", "type": "commit"}, {"oid": "a2f25172ac8301e562f8e5034a3e3a417df3a56c", "url": "https://github.com/mercadopago/px-android/commit/a2f25172ac8301e562f8e5034a3e3a417df3a56c", "message": "add cvv info to groups", "committedDate": "2020-05-14T12:25:40Z", "type": "commit"}, {"oid": "cfc89a26dddfd5e115acb52c7832327c0d23b783", "url": "https://github.com/mercadopago/px-android/commit/cfc89a26dddfd5e115acb52c7832327c0d23b783", "message": "bottom_description fixed", "committedDate": "2020-05-14T13:43:49Z", "type": "commit"}, {"oid": "eab7925746eeda04eb780b4fe3f9b66f0b049715", "url": "https://github.com/mercadopago/px-android/commit/eab7925746eeda04eb780b4fe3f9b66f0b049715", "message": "revert test changes", "committedDate": "2020-05-14T14:17:31Z", "type": "commit"}, {"oid": "52a8eda5aa8e4ee99e76bece68b3220f6810f9ee", "url": "https://github.com/mercadopago/px-android/commit/52a8eda5aa8e4ee99e76bece68b3220f6810f9ee", "message": "revert test onetap", "committedDate": "2020-05-14T14:19:02Z", "type": "commit"}, {"oid": "480082fb07f46028b8178fdf3274f4cd0edfcb8c", "url": "https://github.com/mercadopago/px-android/commit/480082fb07f46028b8178fdf3274f4cd0edfcb8c", "message": "revert changes CheckoutService", "committedDate": "2020-05-14T14:24:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE5OTA1NA==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425199054", "bodyText": "podemos encapsular la l\u00f3gica del if else en m\u00e9todos para que no quede tan grande y este mas contextualizado, no?\ntipo\nif(showCvv){\nshowCvv()\n} else {\nshowCustomView()\n}", "author": "cgaggino", "createdAt": "2020-05-14T14:52:15Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/SecurityCodeActivity.java", "diffHunk": "@@ -228,30 +232,43 @@ public void stopLoadingView() {\n     }\n \n     private void loadViews() {\n-        mCardView = new CardView(this);\n-        final String lastFourDigits = presenter.getCardInfo().getLastFourDigits();\n-        mCardView.setSize(CardRepresentationModes.BIG_SIZE);\n-        mCardView.inflateInParent(mCardContainer, true);\n-        mCardView.initializeControls();\n-        mCardView.setPaymentMethod(presenter.getPaymentMethod());\n-        mCardView.setSecurityCodeLength(presenter.getSecurityCodeLength());\n-        mCardView.setSecurityCodeLocation(presenter.getSecurityCodeLocation());\n-        mCardView.setCardNumberLength(presenter.getCardNumberLength());\n-        mCardView.setLastFourDigits(lastFourDigits);\n-        mCardView.draw(CardView.CARD_SIDE_FRONT);\n-        mCardView.drawFullCard();\n-        mCardView.drawEditingSecurityCode(\"\");\n-        presenter.setSecurityCodeCardType();\n \n-        executeIfAccessibilityTalkBackEnable(this, () -> {\n-            mCardContainer.setContentDescription(new SpannableStringBuilder()\n-                .append(getString(R.string.px_card_number_label))\n-                .append(TextUtil.SPACE)\n-                .append(getString(R.string.px_ending_in))\n-                .append(TextUtil.SPACE)\n-                .append(lastFourDigits));\n-            return null;\n-        });\n+        if (!presenter.showCvvInfo()) {\n+            mCardView = new CardView(this);", "originalCommit": "480082fb07f46028b8178fdf3274f4cd0edfcb8c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE5OTgxOQ==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425199819", "bodyText": "Dale!", "author": "jorGonzalez291292", "createdAt": "2020-05-14T14:53:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE5OTA1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIwMTc1OA==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425201758", "bodyText": "esto parece una acci\u00f3n pero es una validaci\u00f3n, seria mas onda shouldShowCvvInfo", "author": "cgaggino", "createdAt": "2020-05-14T14:55:35Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/SecurityCodePresenter.java", "diffHunk": "@@ -100,6 +100,10 @@ public PaymentMethod getPaymentMethod() {\n         return paymentMethod;\n     }\n \n+    public boolean showCvvInfo() {", "originalCommit": "480082fb07f46028b8178fdf3274f4cd0edfcb8c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIwNDUyOQ==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425204529", "bodyText": "Tenes raz\u00f3n", "author": "jorGonzalez291292", "createdAt": "2020-05-14T14:58:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIwMTc1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIxMTE2NQ==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425211165", "bodyText": "por que hacemos el gone del shadow siempre?", "author": "cgaggino", "createdAt": "2020-05-14T15:08:00Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/slider/PaymentMethodFragment.java", "diffHunk": "@@ -78,8 +78,8 @@ public void initializeViews(@NonNull final View view) {\n             ViewUtils.setBackgroundColor(view.findViewById(R.id.bottom_description_background),\n                 model.getBottomDescription().getBackgroundColor());\n             ViewUtils.loadOrHide(View.INVISIBLE, model.getBottomDescription(), bottomDescription);\n-            view.findViewById(R.id.bottom_description_shadow).setVisibility(View.GONE);\n         }\n+        view.findViewById(R.id.bottom_description_shadow).setVisibility(View.GONE);", "originalCommit": "480082fb07f46028b8178fdf3274f4cd0edfcb8c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIyNTU5NA==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425225594", "bodyText": "esto no iria si usamos directamente el payment method dentro de la pantalla de security code", "author": "cgaggino", "createdAt": "2020-05-14T15:27:02Z", "path": "px-services/src/main/java/com/mercadopago/android/px/model/Card.java", "diffHunk": "@@ -23,6 +23,7 @@\n     private String lastFourDigits;\n     private PaymentMethod paymentMethod;\n     private SecurityCode securityCode;\n+    private CvvInfo cvvInfo;", "originalCommit": "480082fb07f46028b8178fdf3274f4cd0edfcb8c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d194b814d26dc0c98043f414928c69643115aa08", "url": "https://github.com/mercadopago/px-android/commit/d194b814d26dc0c98043f414928c69643115aa08", "message": "review changes", "committedDate": "2020-05-14T17:05:20Z", "type": "commit"}, {"oid": "f44d6ba794575c85b5e6921a816d25d459fb23f8", "url": "https://github.com/mercadopago/px-android/commit/f44d6ba794575c85b5e6921a816d25d459fb23f8", "message": "Merge branch 'master' of github.com:mercadopago/px-android into feature/cvv-caixa", "committedDate": "2020-05-14T17:15:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNDE4Mw==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425304183", "bodyText": "Us\u00e1 el MPTextView", "author": "guchito9", "createdAt": "2020-05-14T17:18:34Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/SecurityCodeActivity.java", "diffHunk": "@@ -254,6 +266,17 @@ private void loadViews() {\n         });\n     }\n \n+    private void showCustomView() {\n+        final CvvInfo cvvInfo = presenter.getCvvInfo();\n+        final View view = LayoutInflater.from(this).inflate(R.layout.px_cvv_info, mCardContainer, true);\n+\n+        final AppCompatTextView title = view.findViewById(R.id.title);\n+\n+        FontHelper.setFont(title, PxFont.SEMI_BOLD);", "originalCommit": "d194b814d26dc0c98043f414928c69643115aa08", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNTg1Mg==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425305852", "bodyText": "Us\u00e1 MPTextview", "author": "guchito9", "createdAt": "2020-05-14T17:21:27Z", "path": "px-checkout/src/main/res/layout/px_cvv_info.xml", "diffHunk": "@@ -0,0 +1,65 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<android.support.constraint.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+    xmlns:tools=\"http://schemas.android.com/tools\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"wrap_content\"\n+    tools:background=\"@color/px_blue_status_bar\">\n+\n+    <android.support.constraint.Guideline\n+        android:id=\"@+id/guidelineStart\"\n+        android:layout_width=\"wrap_content\"\n+        android:layout_height=\"wrap_content\"\n+        android:orientation=\"vertical\"\n+        app:layout_constraintGuide_percent=\"0.10\" />\n+\n+    <android.support.constraint.Guideline\n+        android:id=\"@+id/guidelineEnd\"\n+        android:layout_width=\"wrap_content\"\n+        android:layout_height=\"wrap_content\"\n+        android:orientation=\"vertical\"\n+        app:layout_constraintGuide_percent=\"0.90\" />\n+\n+    <android.support.v7.widget.AppCompatTextView", "originalCommit": "d194b814d26dc0c98043f414928c69643115aa08", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNTk1NQ==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425305955", "bodyText": "Hay que usar MPTextview por favor", "author": "guchito9", "createdAt": "2020-05-14T17:21:39Z", "path": "px-checkout/src/main/res/layout/px_cvv_info.xml", "diffHunk": "@@ -0,0 +1,65 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<android.support.constraint.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+    xmlns:tools=\"http://schemas.android.com/tools\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"wrap_content\"\n+    tools:background=\"@color/px_blue_status_bar\">\n+\n+    <android.support.constraint.Guideline\n+        android:id=\"@+id/guidelineStart\"\n+        android:layout_width=\"wrap_content\"\n+        android:layout_height=\"wrap_content\"\n+        android:orientation=\"vertical\"\n+        app:layout_constraintGuide_percent=\"0.10\" />\n+\n+    <android.support.constraint.Guideline\n+        android:id=\"@+id/guidelineEnd\"\n+        android:layout_width=\"wrap_content\"\n+        android:layout_height=\"wrap_content\"\n+        android:orientation=\"vertical\"\n+        app:layout_constraintGuide_percent=\"0.90\" />\n+\n+    <android.support.v7.widget.AppCompatTextView\n+        android:id=\"@id/title\"\n+        android:layout_width=\"0dp\"\n+        android:layout_height=\"wrap_content\"\n+        android:textColor=\"@color/px_white\"\n+        android:textSize=\"@dimen/px_xxl_text\"\n+        android:layout_marginBottom=\"@dimen/ui_1_5m\"\n+        android:lineSpacingExtra=\"6sp\"\n+        android:gravity=\"center_horizontal\"\n+        app:layout_constraintVertical_chainStyle=\"packed\"\n+        app:layout_constraintBottom_toTopOf=\"@id/message\"\n+        app:layout_constraintEnd_toEndOf=\"parent\"\n+        app:layout_constraintEnd_toStartOf=\"@id/guidelineEnd\"\n+        app:layout_constraintHorizontal_bias=\"0.5\"\n+        app:layout_constraintStart_toEndOf=\"@id/guidelineStart\"\n+        app:layout_constraintTop_toTopOf=\"parent\"\n+        tools:text=\"Ingresa el c\u00f3digo de seguridad din\u00e1mico\" />\n+\n+    <android.support.v7.widget.AppCompatTextView", "originalCommit": "d194b814d26dc0c98043f414928c69643115aa08", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNjUwMw==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425306503", "bodyText": "Esto parece estar al pedo", "author": "guchito9", "createdAt": "2020-05-14T17:22:36Z", "path": "px-services/src/main/java/com/mercadopago/android/px/model/PaymentMethodSearch.java", "diffHunk": "@@ -3,6 +3,7 @@\n import android.support.annotation.NonNull;\n import android.support.annotation.Nullable;\n import com.google.gson.annotations.SerializedName;\n+import com.mercadopago.android.px.model.display_info.DisplayInfo;", "originalCommit": "d194b814d26dc0c98043f414928c69643115aa08", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNjkwMA==", "url": "https://github.com/mercadopago/px-android/pull/2149#discussion_r425306900", "bodyText": "Falta el @nullable del m\u00e9todo", "author": "guchito9", "createdAt": "2020-05-14T17:23:15Z", "path": "px-services/src/main/java/com/mercadopago/android/px/model/display_info/DisplayInfo.java", "diffHunk": "@@ -23,18 +27,24 @@ public Text getDescription() {\n         return description;\n     }\n \n+    public CvvInfo getCvvInfo() {", "originalCommit": "d194b814d26dc0c98043f414928c69643115aa08", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "132c8b621cd8cc980f9d464e110fb5644756296e", "url": "https://github.com/mercadopago/px-android/commit/132c8b621cd8cc980f9d464e110fb5644756296e", "message": "MPTextView added", "committedDate": "2020-05-14T18:01:49Z", "type": "commit"}, {"oid": "8d68ff5ca808043922f8725c4cc6aecb84d88eb7", "url": "https://github.com/mercadopago/px-android/commit/8d68ff5ca808043922f8725c4cc6aecb84d88eb7", "message": "remove import", "committedDate": "2020-05-14T18:09:06Z", "type": "commit"}]}