{"pr_number": 2289, "pr_title": "Fixing tracking in new congrats", "pr_createdAt": "2020-08-19T16:03:35Z", "pr_url": "https://github.com/mercadopago/px-android/pull/2289", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkzMDQwMg==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r473930402", "bodyText": "sacar del BPM el paymentId o receipt es exactamente lo mismo no?", "author": "mmunozpatinomeli", "createdAt": "2020-08-20T12:25:34Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultMapper.java", "diffHunk": "@@ -38,8 +38,8 @@ public BusinessPaymentResultViewModel map(@NonNull final PaymentCongratsModel mo\n             .setMethodModels(methodModels)\n             .setCongratsViewModel(new PaymentCongratsResponseMapper(new BusinessPaymentResultTracker())\n                 .map(model.getPaymentCongratsResponse()))\n-            .setReceiptId((type == PaymentCongratsModel.CongratsType.APPROVED && model.getShouldShowReceipt()) ? model\n-                .getReceiptId() : null)\n+            .setReceiptId((type == PaymentCongratsModel.CongratsType.APPROVED && model.getShouldShowReceipt()) ? String\n+                .valueOf(model.getPaymentId()) : null)", "originalCommit": "39495da3433951e485dc3d319884f7339ea4c436", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk2MTczMg==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r473961732", "bodyText": "si, el paymentID es el recepitID renombrado", "author": "nmanuelidesML", "createdAt": "2020-08-20T13:18:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkzMDQwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkzMDk4OQ==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r473930989", "bodyText": "niko ac\u00e1 no quedan varias l\u00edneas comentadas m\u00e1s abajo en este mismo archivo??", "author": "mmunozpatinomeli", "createdAt": "2020-08-20T12:26:38Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultPresenter.java", "diffHunk": "@@ -42,7 +44,7 @@\n         @NonNull final FlowBehaviour flowBehaviour, final boolean isMP) {\n         this.model = model;\n         this.flowBehaviour = flowBehaviour;\n-//        viewTracker = new ResultViewTrack(model, paymentSettings, isMP);\n+        viewTracker = new ResultViewTrack(model, isMP);", "originalCommit": "39495da3433951e485dc3d319884f7339ea4c436", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk2MzMyNQ==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r473963325", "bodyText": "uff, si no sabia siquiera q habia mas cosas comentadas, ahora lo arreglo", "author": "nmanuelidesML", "createdAt": "2020-08-20T13:19:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkzMDk4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkzMzQzMA==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r473933430", "bodyText": "esto no toca borrarlo?", "author": "mmunozpatinomeli", "createdAt": "2020-08-20T12:30:55Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/tracking/internal/views/ResultViewTrack.kt", "diffHunk": "@@ -19,18 +19,25 @@ class ResultViewTrack : TrackWrapper {\n     private val remediesResponse: RemediesResponse\n \n     constructor(paymentModel: PaymentModel, screenConfiguration: PaymentResultScreenConfiguration,\n-        paymentSetting: PaymentSettingRepository, isMP: Boolean) {\n+                paymentSetting: PaymentSettingRepository, isMP: Boolean) {\n         resultViewTrackModel = ResultViewTrackModel(paymentModel, screenConfiguration, paymentSetting.checkoutPreference!!,\n-            paymentSetting.currency.id, isMP)\n+                paymentSetting.currency.id, isMP)\n         paymentStatus = getMappedResult(paymentModel.paymentResult)\n         this.remediesResponse = paymentModel.remedies\n     }\n \n-    constructor(paymentModel: BusinessPaymentModel, paymentSetting: PaymentSettingRepository, isMP: Boolean) {\n+    /*constructor(paymentModel: BusinessPaymentModel, paymentSetting: PaymentSettingRepository, isMP: Boolean) {", "originalCommit": "39495da3433951e485dc3d319884f7339ea4c436", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkzNDMyOA==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r473934328", "bodyText": "ac\u00e1 s\u00f3lo agregaste un import??? o.O", "author": "mmunozpatinomeli", "createdAt": "2020-08-20T12:32:31Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/tracking/internal/mapper/FromDiscountItemToItemId.java", "diffHunk": "@@ -1,6 +1,7 @@\n package com.mercadopago.android.px.tracking.internal.mapper;\n \n import android.support.annotation.NonNull;\n+import com.mercadopago.android.px.internal.features.payment_congrats.model.PaymentCongratsResponse;", "originalCommit": "39495da3433951e485dc3d319884f7339ea4c436", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b33f054296cb3e9e9d9e98347a080269621792f8", "url": "https://github.com/mercadopago/px-android/commit/b33f054296cb3e9e9d9e98347a080269621792f8", "message": "fixing tracking", "committedDate": "2020-08-24T19:13:35Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTg0OTA4Nw==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r475849087", "bodyText": "niko esta l\u00ednea no deber\u00eda borrarse", "author": "mmunozpatinomeli", "createdAt": "2020-08-24T19:37:58Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonFragment.kt", "diffHunk": "@@ -101,7 +100,6 @@ class PayButtonFragment : Fragment(), PayButton.View, SecurityValidationHandler\n             is UIResult.VisualProcessorResult -> PaymentProcessorActivity.start(this, REQ_CODE_PAYMENT_PROCESSOR)\n             is UIError.ConnectionError -> showSnackBar(stateUI.error)\n             is UIResult.PaymentResult -> PaymentResultActivity.start(this, REQ_CODE_CONGRATS, stateUI.model)\n-            is UIResult.NoCongratsResult -> DummyResultActivity.start(this, REQ_CODE_CONGRATS, stateUI.model)", "originalCommit": "b33f054296cb3e9e9d9e98347a080269621792f8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTg1NDQ0Ng==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r475854446", "bodyText": "eso fue al resolver los conflictos damn it", "author": "nmanuelidesML", "createdAt": "2020-08-24T19:49:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTg0OTA4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTg1MDg0Mg==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r475850842", "bodyText": "todos estos with, validamos que en la firma en iOS respecto a estos datos est\u00e1 igual?", "author": "mmunozpatinomeli", "createdAt": "2020-08-24T19:41:47Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/payment_congrats/model/PaymentCongratsModel.java", "diffHunk": "@@ -467,5 +669,68 @@ public Builder withExpenseSplit(final PaymentCongratsResponse.ExpenseSplit expen\n             this.customSorting = customSorting;\n             return this;\n         }\n+\n+        /**\n+         * @param campaignId the id of the campaign for the payment\n+         * @return builder with the added String\n+         */\n+        /* default */ Builder withCampaignId(@Nullable final String campaignId) {\n+            this.campaignId = campaignId;\n+            return this;\n+        }\n+\n+        /**\n+         * @param flow the name of the flow building the congrats (e.g \"buyer_qr\")\n+         * @return builder with the added String\n+         */\n+        /* default */ Builder withFlow(final String flow) {\n+            this.flow = flow;\n+            return this;\n+        }\n+\n+        /**\n+         * @param currencyId the id of the currency being used to pay\n+         * @return builder with the added String\n+         */\n+        /* default */ Builder withCurrencyId(final String currencyId) {\n+            this.currencyId = currencyId;\n+            return this;\n+        }\n+\n+        /**\n+         * @param paymentStatus the status of the payment\n+         * @return builder with the added String\n+         */\n+        /* default */ Builder withPaymentStatus(final String paymentStatus) {\n+            this.paymentStatus = paymentStatus;\n+            return this;\n+        }\n+\n+        /**\n+         * @param paymentStatusDetail a description for the payment status\n+         * @return builder with the added String\n+         */\n+        /* default */ Builder withPaymentStatusDetail(final String paymentStatusDetail) {\n+            this.paymentStatusDetail = paymentStatusDetail;\n+            return this;\n+        }\n+\n+        /**\n+         * @param paymentData info about the payment for internal tracking purposes\n+         * @return builder with the added paymentData\n+         */\n+        /* default */ Builder withPaymentData(final PaymentData paymentData) {\n+            this.paymentData = paymentData;\n+            return this;\n+        }\n+\n+        /**\n+         * @param discountCouponsAmount the total amount of discounts from the coupons\n+         * @return builder with the added discount coupons amount\n+         */\n+        /* default */ Builder withDiscountCouponsAmount(final BigDecimal discountCouponsAmount) {", "originalCommit": "b33f054296cb3e9e9d9e98347a080269621792f8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTg1NTIxMA==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r475855210", "bodyText": "son internos igual, no se si es necesario pq el integrador no los va a ver", "author": "nmanuelidesML", "createdAt": "2020-08-24T19:50:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTg1MDg0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTg2MDQyMQ==", "url": "https://github.com/mercadopago/px-android/pull/2289#discussion_r475860421", "bodyText": "todos quedaron internos? el integrador no iba a pasarnos el flow o el totalAmount?", "author": "mmunozpatinomeli", "createdAt": "2020-08-24T20:00:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTg1MDg0Mg=="}], "type": "inlineReview"}, {"oid": "86bf2d1f46a54c22512d4a279eaeacd3a6fe960a", "url": "https://github.com/mercadopago/px-android/commit/86bf2d1f46a54c22512d4a279eaeacd3a6fe960a", "message": "fixing tracking", "committedDate": "2020-08-25T19:12:23Z", "type": "forcePushed"}, {"oid": "320ac13f5a2f64fa5fa73b0bfa482a185fdc5923", "url": "https://github.com/mercadopago/px-android/commit/320ac13f5a2f64fa5fa73b0bfa482a185fdc5923", "message": "fixing tracking", "committedDate": "2020-08-25T20:16:25Z", "type": "forcePushed"}, {"oid": "673ae164309e86c907f0c8afacdc3f7d08749f78", "url": "https://github.com/mercadopago/px-android/commit/673ae164309e86c907f0c8afacdc3f7d08749f78", "message": "fixing tracking", "committedDate": "2020-08-26T13:43:48Z", "type": "commit"}, {"oid": "673ae164309e86c907f0c8afacdc3f7d08749f78", "url": "https://github.com/mercadopago/px-android/commit/673ae164309e86c907f0c8afacdc3f7d08749f78", "message": "fixing tracking", "committedDate": "2020-08-26T13:43:48Z", "type": "forcePushed"}]}