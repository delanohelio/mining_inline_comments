{"pr_number": 4840, "pr_title": "Start a mongo instance for testing using docker via java code", "pr_createdAt": "2020-05-03T11:22:18Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/4840", "timeline": [{"oid": "15d318f60862f8eb66eabdfe68fcb2a5da8a08b4", "url": "https://github.com/eclipse/jetty.project/commit/15d318f60862f8eb66eabdfe68fcb2a5da8a08b4", "message": "remove slow mongo maven plugin which was forking an external process and now run mongodb in a container so we can even now test with different version using -Dmongo.docker.version\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-03T11:23:01Z", "type": "forcePushed"}, {"oid": "d08e0ceafe10997c86cea1ff9d3bc39141460a7b", "url": "https://github.com/eclipse/jetty.project/commit/d08e0ceafe10997c86cea1ff9d3bc39141460a7b", "message": "remove slow mongo maven plugin which was forking an external process and now run mongodb in a container so we can even now test with different version using -Dmongo.docker.version\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-03T11:34:02Z", "type": "forcePushed"}, {"oid": "485ca1a37a904365544e37f85fc4edec6bdbc3e9", "url": "https://github.com/eclipse/jetty.project/commit/485ca1a37a904365544e37f85fc4edec6bdbc3e9", "message": "remove slow mongo maven plugin which was forking an external process and now run mongodb in a container so we can even now test with different version using -Dmongo.docker.version\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-03T22:05:33Z", "type": "forcePushed"}, {"oid": "d2ad9f3d9039442238b573fbd2c850a7efd5cd84", "url": "https://github.com/eclipse/jetty.project/commit/d2ad9f3d9039442238b573fbd2c850a7efd5cd84", "message": "remove slow mongo maven plugin which was forking an external process and now run mongodb in a container so we can even now test with different version using -Dmongo.docker.version\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-04T07:53:56Z", "type": "commit"}, {"oid": "d2ad9f3d9039442238b573fbd2c850a7efd5cd84", "url": "https://github.com/eclipse/jetty.project/commit/d2ad9f3d9039442238b573fbd2c850a7efd5cd84", "message": "remove slow mongo maven plugin which was forking an external process and now run mongodb in a container so we can even now test with different version using -Dmongo.docker.version\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-04T07:53:56Z", "type": "forcePushed"}, {"oid": "4e745ec9b7440298dd6269a1f9f7e350e4d4f5b7", "url": "https://github.com/eclipse/jetty.project/commit/4e745ec9b7440298dd6269a1f9f7e350e4d4f5b7", "message": "activate docker test only if docker is available\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-05T04:09:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk5NzQ3OQ==", "url": "https://github.com/eclipse/jetty.project/pull/4840#discussion_r419997479", "bodyText": "I'd still call the profile \"mongodb\". It just happens to be being used in a ci environment, but can also be run locally.", "author": "janbartel", "createdAt": "2020-05-05T10:04:38Z", "path": "tests/test-sessions/test-mongodb-sessions/pom.xml", "diffHunk": "@@ -95,15 +96,27 @@\n       <artifactId>jetty-test-helper</artifactId>\n       <scope>test</scope>\n     </dependency>\n+    <dependency>\n+      <groupId>org.testcontainers</groupId>\n+      <artifactId>testcontainers</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.testcontainers</groupId>\n+      <artifactId>junit-jupiter</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.slf4j</groupId>\n+      <artifactId>slf4j-simple</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n   </dependencies>\n   <profiles>\n     <profile>\n-      <id>mongodb</id>\n+      <id>ci</id>", "originalCommit": "4e745ec9b7440298dd6269a1f9f7e350e4d4f5b7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDAxMzI3OA==", "url": "https://github.com/eclipse/jetty.project/pull/4840#discussion_r420013278", "bodyText": "what about a system property such -Dmongodb.enabled=true otherwise we will have a lot of profile here \n  \n    \n      jetty.project/Jenkinsfile\n    \n    \n         Line 14\n      in\n      0ab2b42\n    \n    \n    \n    \n\n        \n          \n           mavenBuild(\"jdk8\", \"-T3 -Pmongodb clean install\", \"maven3\", true) \n        \n    \n  \n\n such -Pmongo -Pinfinispan -Pmemcache -Phazelcast etc which is a bit complicated to read.\nWhat is the goal exactly of having a profile named mongodb?", "author": "olamy", "createdAt": "2020-05-05T10:35:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk5NzQ3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDYzNjA1Ng==", "url": "https://github.com/eclipse/jetty.project/pull/4840#discussion_r420636056", "bodyText": "OK, well what about a profile name that is more related to what it is actually doing: something like remote-session-tests or something?", "author": "janbartel", "createdAt": "2020-05-06T08:49:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk5NzQ3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1ODYzMA==", "url": "https://github.com/eclipse/jetty.project/pull/4840#discussion_r420658630", "bodyText": "Sounds good.\nBut I will definitely bookmark this comment to be sure I have when I will hear  grhhh this parameter remote-session-tests is too long when I use the command line \ud83d\ude1c", "author": "olamy", "createdAt": "2020-05-06T09:29:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk5NzQ3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDczMDM4OQ==", "url": "https://github.com/eclipse/jetty.project/pull/4840#discussion_r420730389", "bodyText": "Well with the activation test you added to the profile, you never really have to specify anything on the command line :)  Unless, of course, you're using windows .... is there any activation test that is generic enough that would work on most windows environments?", "author": "janbartel", "createdAt": "2020-05-06T11:51:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk5NzQ3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDc0NDMyMw==", "url": "https://github.com/eclipse/jetty.project/pull/4840#discussion_r420744323", "bodyText": "I removed the file activation otherwise it is running all the time on linux/osx as long as you have docker and even if I'm happy with that not sure everyone will be? :) \ud83d\ude04", "author": "olamy", "createdAt": "2020-05-06T12:17:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk5NzQ3OQ=="}], "type": "inlineReview"}, {"oid": "45137cc200545da7df6dd7f4d093546685015db6", "url": "https://github.com/eclipse/jetty.project/commit/45137cc200545da7df6dd7f4d093546685015db6", "message": "change profile name\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-06T09:35:36Z", "type": "commit"}, {"oid": "6939f3c0ae6810ea53dcb5f895992edb9a923f36", "url": "https://github.com/eclipse/jetty.project/commit/6939f3c0ae6810ea53dcb5f895992edb9a923f36", "message": "add default value for mongo version\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-06T21:09:38Z", "type": "commit"}, {"oid": "26694adaf29232eba8e4f50a42d789e62930bb51", "url": "https://github.com/eclipse/jetty.project/commit/26694adaf29232eba8e4f50a42d789e62930bb51", "message": "add comment regarding mongodb version in pom\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-07T01:37:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQ1OTE0Ng==", "url": "https://github.com/eclipse/jetty.project/pull/4840#discussion_r421459146", "bodyText": "Delete this commented out line and you're good to go.", "author": "janbartel", "createdAt": "2020-05-07T12:18:55Z", "path": "tests/test-sessions/test-mongodb-sessions/pom.xml", "diffHunk": "@@ -95,13 +97,29 @@\n       <artifactId>jetty-test-helper</artifactId>\n       <scope>test</scope>\n     </dependency>\n+    <dependency>\n+      <groupId>org.testcontainers</groupId>\n+      <artifactId>testcontainers</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.testcontainers</groupId>\n+      <artifactId>junit-jupiter</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.slf4j</groupId>\n+      <artifactId>slf4j-simple</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n   </dependencies>\n   <profiles>\n     <profile>\n-      <id>mongodb</id>\n+      <id>remote-session-tests</id>\n       <activation>\n+<!--        <file><exists>/var/run/docker.sock</exists></file>-->", "originalCommit": "26694adaf29232eba8e4f50a42d789e62930bb51", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "558fa6ac2910633129a363ab5f8160f8ce4c2bd5", "url": "https://github.com/eclipse/jetty.project/commit/558fa6ac2910633129a363ab5f8160f8ce4c2bd5", "message": "remove comment\n\nSigned-off-by: olivier lamy <oliver.lamy@gmail.com>", "committedDate": "2020-05-07T20:15:09Z", "type": "commit"}]}