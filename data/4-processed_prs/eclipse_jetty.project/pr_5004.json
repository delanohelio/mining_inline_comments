{"pr_number": 5004, "pr_title": "Issue #4985 - fix NPE related to use of Attributes.Wrapper getAttributeNameSet()", "pr_createdAt": "2020-06-29T01:25:17Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/5004", "timeline": [{"oid": "693312a577b921a4e58c85776898a730ae1b5576", "url": "https://github.com/eclipse/jetty.project/commit/693312a577b921a4e58c85776898a730ae1b5576", "message": "Issue #4985 - ensure every attribute in getAttributeNameSet has a non null value\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-06-25T13:15:12Z", "type": "commit"}, {"oid": "9126b282b1a0e76cd28a19c59d680ac1356afc83", "url": "https://github.com/eclipse/jetty.project/commit/9126b282b1a0e76cd28a19c59d680ac1356afc83", "message": "Merge remote-tracking branch 'origin/jetty-9.4.x' into jetty-9.4.x-4985-AttributeNameSet", "committedDate": "2020-06-30T01:22:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYzMzY4Ng==", "url": "https://github.com/eclipse/jetty.project/pull/5004#discussion_r448633686", "bodyText": "Because if you do an include then forward, you need to remove the include attributes, else the target will serve them rather than the getServletPath and getPathInfo indicated resources.\nIt is all to do with the strange setup of includes not changing the path methods and only setting attributes.", "author": "gregw", "createdAt": "2020-07-01T21:47:50Z", "path": "jetty-server/src/main/java/org/eclipse/jetty/server/Dispatcher.java", "diffHunk": "@@ -296,26 +297,23 @@ public Object getAttribute(String key)\n         public Set<String> getAttributeNameSet()\n         {\n             HashSet<String> set = new HashSet<>();\n-            for (String name : _attributes.getAttributeNameSet())\n-            {\n-                if (!name.startsWith(__INCLUDE_PREFIX) &&\n-                    !name.startsWith(__FORWARD_PREFIX))\n-                    set.add(name);\n-            }\n+            super.getAttributeNameSet().stream()\n+                .filter(name -> !name.startsWith(__INCLUDE_PREFIX)) // TODO: why does this filter the __INCLUDE_PREFIX as well?", "originalCommit": "9126b282b1a0e76cd28a19c59d680ac1356afc83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f35d6cfd80b39e6be75c00aa25ef0d7ef7bbda49", "url": "https://github.com/eclipse/jetty.project/commit/f35d6cfd80b39e6be75c00aa25ef0d7ef7bbda49", "message": "Issue #4985 - remove TODO in Dispatcher\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-07-02T06:02:24Z", "type": "commit"}]}