{"pr_number": 4580, "pr_title": "Fixes #4577 IPAccessHandler in context", "pr_createdAt": "2020-02-17T07:14:02Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/4580", "timeline": [{"oid": "80e481ea1af7fbb1b8c76bc29133f3ff939f251d", "url": "https://github.com/eclipse/jetty.project/commit/80e481ea1af7fbb1b8c76bc29133f3ff939f251d", "message": "Fixes #4577 IPAccessHandler in context\n\nFixes and tests #4577 IPAccessHandler in context by using target instead of pathInfo for path matching.\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-02-17T07:13:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQzMzAzNw==", "url": "https://github.com/eclipse/jetty.project/pull/4580#discussion_r382433037", "bodyText": "Use try-with-resources for the Socket.", "author": "sbordet", "createdAt": "2020-02-21T07:32:30Z", "path": "jetty-server/src/test/java/org/eclipse/jetty/server/handler/IPAccessHandlerTest.java", "diffHunk": "@@ -119,6 +136,44 @@ public void testHandler(String white, String black, String host, String uri, Str\n         }\n     }\n \n+    @ParameterizedTest\n+    @MethodSource(\"data\")\n+    public void testContext(String white, String black, String host, String uri, String code, boolean byPath)\n+        throws Exception\n+    {\n+        ContextHandler context = new ContextHandler(_server, \"/ctx\");\n+        context.setHandler(_handler);\n+        _server.setHandler(context);\n+        _server.start();\n+\n+        _handler.setWhite(white.split(\";\", -1));\n+        _handler.setBlack(black.split(\";\", -1));\n+        _handler.setWhiteListByPath(byPath);\n+\n+        String request = \"GET /ctx\" + uri + \" HTTP/1.1\\n\" + \"Host: \" + host + \"\\n\\n\";\n+        Socket socket = new Socket(\"127.0.0.1\", _connector.getLocalPort());\n+        socket.setSoTimeout(5000);\n+        try", "originalCommit": "80e481ea1af7fbb1b8c76bc29133f3ff939f251d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQzNDQ0Mg==", "url": "https://github.com/eclipse/jetty.project/pull/4580#discussion_r382434442", "bodyText": "Now that you have changed the test annotation to be per-instance, all fields should not be static: _server, _connector, _handler.", "author": "sbordet", "createdAt": "2020-02-21T07:36:55Z", "path": "jetty-server/src/test/java/org/eclipse/jetty/server/handler/IPAccessHandlerTest.java", "diffHunk": "@@ -57,30 +57,44 @@\n     private static NetworkConnector _connector;\n     private static IPAccessHandler _handler;\n \n-    @BeforeAll\n-    public static void setUp()\n+    @BeforeEach", "originalCommit": "80e481ea1af7fbb1b8c76bc29133f3ff939f251d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d95f2fbea3a7cac24026b14208240301f21a0154", "url": "https://github.com/eclipse/jetty.project/commit/d95f2fbea3a7cac24026b14208240301f21a0154", "message": "Tests #4577 IPAccessHandler target\n\nUpdates from review.\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-02-21T19:33:01Z", "type": "commit"}, {"oid": "5480da40090a576a6a02c8acb4eb8c75bc887832", "url": "https://github.com/eclipse/jetty.project/commit/5480da40090a576a6a02c8acb4eb8c75bc887832", "message": "Issue #4577 IpAccessHandler NPE\n\nMatch on full URI path rather than target.\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-02-24T09:52:35Z", "type": "commit"}]}