{"pr_number": 3298, "pr_title": "TRUNK-5813 Replace all ExpectedException Rules and the @Test(expected..)", "pr_createdAt": "2020-07-06T20:02:59Z", "pr_url": "https://github.com/openmrs/openmrs-core/pull/3298", "timeline": [{"oid": "e15cf1d7e26f0f98a314fa1315174170979332af", "url": "https://github.com/openmrs/openmrs-core/commit/e15cf1d7e26f0f98a314fa1315174170979332af", "message": "TRUNK-5813 Replace all ExpectedException Rules and the @Test(expected..)", "committedDate": "2020-07-06T19:57:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY4MTcwNQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3298#discussion_r450681705", "bodyText": "I thought is and startsWith are different. Correct?", "author": "dkayiwa", "createdAt": "2020-07-07T08:03:53Z", "path": "api/src/test/java/org/openmrs/util/databasechange/Database1_9_7UpgradeIT.java", "diffHunk": "@@ -247,7 +246,7 @@ public void shouldFailIfAnyDrugOrderFrequenciesNotMappedToConceptsAreFound() thr\n \t\tString errorMsgSubString1 = \"liquibase.exception.MigrationFailedException: Migration failed for change set liquibase-update-to-latest.xml::201401101647-TRUNK-4187::wyclif\";\n \t\t\n \t\tIOException exception = assertThrows(IOException.class, () -> upgradeTestUtil.upgrade());\n-\t\tassertThat(exception.getMessage(), is(errorMsgSubString1));\n+\t\tassertThat(exception.getMessage(), startsWith(errorMsgSubString1));", "originalCommit": "e15cf1d7e26f0f98a314fa1315174170979332af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY4MjA1OQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3298#discussion_r450682059", "bodyText": "For instance: This is a vs This is a boy", "author": "dkayiwa", "createdAt": "2020-07-07T08:04:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY4MTcwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDcwODIzNA==", "url": "https://github.com/openmrs/openmrs-core/pull/3298#discussion_r450708234", "bodyText": "Yes they are :) is checks for equality as opposed to startsWith\nThe thing is that the expectedException.expectMessage() was doing a containsString so sometimes the string we expect was an exact match, sometimes in was not. In the former case using the is is fine, in the later we have to either use startsWith or containsString", "author": "teleivo", "createdAt": "2020-07-07T08:49:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY4MTcwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE0NjAxNw==", "url": "https://github.com/openmrs/openmrs-core/pull/3298#discussion_r451146017", "bodyText": "Is line 250 above also using expectedException.expectMessage()?", "author": "dkayiwa", "createdAt": "2020-07-07T21:12:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY4MTcwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI2MjkwMA==", "url": "https://github.com/openmrs/openmrs-core/pull/3298#discussion_r451262900", "bodyText": "Not anymore. We are replacing the deprecated Junit 4 ExpectedException. Here you can see the first change d0871ee#diff-9715472d14ed569e3b08d1dfaafec969L251-R250 which failed since we used the is assertion but expectedException.expectMessage() does a containsString which in this case made a difference since errorMsgSubString1 is just a substring.", "author": "teleivo", "createdAt": "2020-07-08T03:35:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY4MTcwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgxNDYzMQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3298#discussion_r451814631", "bodyText": "Oh i see!", "author": "dkayiwa", "createdAt": "2020-07-08T20:44:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY4MTcwNQ=="}], "type": "inlineReview"}]}