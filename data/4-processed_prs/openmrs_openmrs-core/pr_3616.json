{"pr_number": 3616, "pr_title": "TRUNK-5969: Wrong default directory on Windows", "pr_createdAt": "2020-10-26T21:44:10Z", "pr_url": "https://github.com/openmrs/openmrs-core/pull/3616", "timeline": [{"oid": "ff8deb9d56625bd77db615499369468c2db7164d", "url": "https://github.com/openmrs/openmrs-core/commit/ff8deb9d56625bd77db615499369468c2db7164d", "message": "Merge pull request #1 from openmrs/master\n\nupdate", "committedDate": "2020-10-26T21:01:00Z", "type": "commit"}, {"oid": "d1ce56221004418f1880e340dd19f693d1ffe527", "url": "https://github.com/openmrs/openmrs-core/commit/d1ce56221004418f1880e340dd19f693d1ffe527", "message": "Wrong default directory on Windows", "committedDate": "2020-10-26T21:38:31Z", "type": "commit"}, {"oid": "0b8d695598ae81f3b00137728249def8c2e8f666", "url": "https://github.com/openmrs/openmrs-core/commit/0b8d695598ae81f3b00137728249def8c2e8f666", "message": "Wrong default directory on Windows", "committedDate": "2020-10-26T21:41:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4OTQ0OA==", "url": "https://github.com/openmrs/openmrs-core/pull/3616#discussion_r516889448", "bodyText": "Probably this condition is never caught in tests and hence the failing coverage check.", "author": "ShivanshRakesh", "createdAt": "2020-11-03T18:59:23Z", "path": "api/src/main/java/org/openmrs/util/OpenmrsUtil.java", "diffHunk": "@@ -1101,8 +1101,7 @@ public static String getApplicationDataDirectory() {\n \t\t\t\t\tfilepath = OpenmrsConstants.APPLICATION_DATA_DIRECTORY_FALLBACK_UNIX + File.separator + openmrsDir;\n \t\t\t\t}\n \t\t\t} else {\n-\t\t\t\tfilepath = System.getProperty(\"user.home\") + File.separator + \"Application Data\" + File.separator\n-\t\t\t\t        + \"OpenMRS\";\n+\t\t\t\tfilepath = System.getenv(\"appdata\") + File.separator + \"OpenMRS\";\n \t\t\t\tif (!canWrite(new File(filepath))) {", "originalCommit": "0b8d695598ae81f3b00137728249def8c2e8f666", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzM3Mjk1Mw==", "url": "https://github.com/openmrs/openmrs-core/pull/3616#discussion_r517372953", "bodyText": "@theanandankit First of all, thank you for this! It's important that we get this right. I would be concerned that we might be breaking existing Windows-based installs without having a proper fallback. Could we implement this as something like:\nfilepath = System.getProperty(\"user.home\") + File.separator + \"Application Data\" + File.separator + \"OpenMRS\";\nif (!new File(filepath).exists()) { \n    filepath = System.getenv(\"appdata\") + File.separator + \"OpenMRS\";\n}", "author": "ibacher", "createdAt": "2020-11-04T14:14:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4OTQ0OA=="}], "type": "inlineReview"}, {"oid": "402ee909eb288c96a94533614097c54907fcda14", "url": "https://github.com/openmrs/openmrs-core/commit/402ee909eb288c96a94533614097c54907fcda14", "message": "Update OpenmrsUtil.java", "committedDate": "2020-11-04T14:48:07Z", "type": "commit"}]}