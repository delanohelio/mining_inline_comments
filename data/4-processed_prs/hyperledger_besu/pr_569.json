{"pr_number": 569, "pr_title": "remove unnecessary persist", "pr_createdAt": "2020-03-25T00:06:49Z", "pr_url": "https://github.com/hyperledger/besu/pull/569", "timeline": [{"oid": "5d65e06d0a43a4f9db574381ae7d0a3fa65dc1d7", "url": "https://github.com/hyperledger/besu/commit/5d65e06d0a43a4f9db574381ae7d0a3fa65dc1d7", "message": "remove unnecessary persist\n\nSigned-off-by: Ratan Rai Sur <ratan.r.sur@gmail.com>", "committedDate": "2020-03-24T23:48:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5MzY1Nw==", "url": "https://github.com/hyperledger/besu/pull/569#discussion_r405993657", "bodyText": "Current behaviour for Mainnet block importer being persisting the state on every block imported.\nAny thoughts on the potential impact this PR might have? ...is the state still persisted on each block imported (perhaps done elsewhere), or is the persist performed less frequently, if so at what cadence?", "author": "CjHare", "createdAt": "2020-04-09T06:57:14Z", "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/mainnet/MainnetBlockImporter.java", "diffHunk": "@@ -46,20 +45,13 @@ public synchronized boolean importBlock(\n         blockValidator.validateAndProcessBlock(\n             context, block, headerValidationMode, ommerValidationMode);\n \n-    outputs.ifPresent(processingOutputs -> persistState(processingOutputs, block, context));\n+    outputs.ifPresent(", "originalCommit": "5d65e06d0a43a4f9db574381ae7d0a3fa65dc1d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE3MTYzNQ==", "url": "https://github.com/hyperledger/besu/pull/569#discussion_r408171635", "bodyText": "As I read it, it still does persist on every block, here:\n\n  \n    \n      besu/ethereum/core/src/main/java/org/hyperledger/besu/ethereum/mainnet/AbstractBlockProcessor.java\n    \n    \n         Line 165\n      in\n      9fa9c85\n    \n    \n    \n    \n\n        \n          \n           worldState.persist(); \n        \n    \n  \n\n\nI'm also going to manually test this for sure since it's such a core change. Just haven't gotten around to it.", "author": "RatanRSur", "createdAt": "2020-04-14T14:16:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5MzY1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODQ5NTA2OA==", "url": "https://github.com/hyperledger/besu/pull/569#discussion_r408495068", "bodyText": "Sounds like a plan \ud83d\udc4d", "author": "CjHare", "createdAt": "2020-04-14T23:32:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5MzY1Nw=="}], "type": "inlineReview"}, {"oid": "cc3ea2915bad210940dc098bf2f9724b7f32cb7c", "url": "https://github.com/hyperledger/besu/commit/cc3ea2915bad210940dc098bf2f9724b7f32cb7c", "message": "Revert \"Merge branch 'master' into remove-unnecessary-persist\"\n\nThis reverts commit 7e5a584a9ed3ad141d49086befe31f5c7c9d5a78, reversing\nchanges made to 5d65e06d0a43a4f9db574381ae7d0a3fa65dc1d7.\n\nSigned-off-by: Ratan Rai Sur <ratan.r.sur@gmail.com>", "committedDate": "2020-04-16T20:00:14Z", "type": "forcePushed"}, {"oid": "21d749cce9b6cff0a9e81ae728cdeb4ca2e6637e", "url": "https://github.com/hyperledger/besu/commit/21d749cce9b6cff0a9e81ae728cdeb4ca2e6637e", "message": "Merge remote-tracking branch 'upstream' into remove-unnecessary-persist", "committedDate": "2020-04-24T17:18:18Z", "type": "commit"}, {"oid": "21d749cce9b6cff0a9e81ae728cdeb4ca2e6637e", "url": "https://github.com/hyperledger/besu/commit/21d749cce9b6cff0a9e81ae728cdeb4ca2e6637e", "message": "Merge remote-tracking branch 'upstream' into remove-unnecessary-persist", "committedDate": "2020-04-24T17:18:18Z", "type": "forcePushed"}, {"oid": "f07f6d46c4ec1e85d3561bbe8920440f2ee29f82", "url": "https://github.com/hyperledger/besu/commit/f07f6d46c4ec1e85d3561bbe8920440f2ee29f82", "message": "Merge remote-tracking branch 'upstream' into remove-unnecessary-persist", "committedDate": "2020-04-27T14:01:07Z", "type": "commit"}]}