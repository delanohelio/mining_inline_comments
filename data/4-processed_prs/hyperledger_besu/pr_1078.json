{"pr_number": 1078, "pr_title": "Add cli option to specify the name of the loadbalancer used by the Kubernetes nat manager ", "pr_createdAt": "2020-06-15T14:39:55Z", "pr_url": "https://github.com/hyperledger/besu/pull/1078", "timeline": [{"oid": "f780963f2561a5556c671154d66a9c1577ff612b", "url": "https://github.com/hyperledger/besu/commit/f780963f2561a5556c671154d66a9c1577ff612b", "message": "add cli option for kubernetes nat manager  (service besu name)\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-06-15T14:35:06Z", "type": "commit"}, {"oid": "b251d04a6b622dceeb7213506eafe3fbf7ad118b", "url": "https://github.com/hyperledger/besu/commit/b251d04a6b622dceeb7213506eafe3fbf7ad118b", "message": "update test\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-06-15T16:48:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMxOTM2Ng==", "url": "https://github.com/hyperledger/besu/pull/1078#discussion_r440319366", "bodyText": "Could we create a KubernetesConfiguration object, i suspect we will have more Kubernetes options in the future.", "author": "abdelhamidbakhta", "createdAt": "2020-06-15T17:02:46Z", "path": "besu/src/main/java/org/hyperledger/besu/cli/BesuCommand.java", "diffHunk": "@@ -419,6 +420,13 @@ void setBannedNodeIds(final List<String> values) {\n               + \" NONE disables NAT functionality. (default: ${DEFAULT-VALUE})\")\n   private final NatMethod natMethod = DEFAULT_NAT_METHOD;\n \n+  @SuppressWarnings({\"FieldCanBeFinal\", \"FieldMayBeFinal\"}) // PicoCLI requires non-final Strings.\n+  @Option(\n+      names = {\"--Xnat-manager-pod-name\"},", "originalCommit": "b251d04a6b622dceeb7213506eafe3fbf7ad118b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMyMDQ1MQ==", "url": "https://github.com/hyperledger/besu/pull/1078#discussion_r440320451", "bodyText": "Or maybe NatConfiguration to group all NAT related CLI options.", "author": "abdelhamidbakhta", "createdAt": "2020-06-15T17:04:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMxOTM2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMyMjU0Mg==", "url": "https://github.com/hyperledger/besu/pull/1078#discussion_r440322542", "bodyText": "Also i would not use the term manager in the name of the option. I would use something like --Xnat-kubernetes-pod-name or --Xnat-kube-pod-name", "author": "abdelhamidbakhta", "createdAt": "2020-06-15T17:08:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMxOTM2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMyNTc3OQ==", "url": "https://github.com/hyperledger/besu/pull/1078#discussion_r440325779", "bodyText": "Or maybe NatConfiguration to group all NAT related CLI options.\n\nI was also thinking of adding an object like that. but I think it's better to be sure we have more than two parameters before creating it", "author": "matkt", "createdAt": "2020-06-15T17:14:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMxOTM2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMzNDA1NA==", "url": "https://github.com/hyperledger/besu/pull/1078#discussion_r440334054", "bodyText": "Also i would not use the term manager in the name of the option. I would use something like --Xnat-kubernetes-pod-name or --Xnat-kube-pod-name\n\nDone. I'm now using --Xnat-kube-pod-name", "author": "matkt", "createdAt": "2020-06-15T17:29:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMxOTM2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMyMTYwNQ==", "url": "https://github.com/hyperledger/besu/pull/1078#discussion_r440321605", "bodyText": "Can you add a test with a non default value and check the value is used ?", "author": "abdelhamidbakhta", "createdAt": "2020-06-15T17:06:49Z", "path": "besu/src/test/java/org/hyperledger/besu/cli/BesuCommandTest.java", "diffHunk": "@@ -1329,6 +1330,16 @@ public void natMethodPropertyDefaultIsAuto() {\n     assertThat(commandErrorOutput.toString()).isEmpty();\n   }\n \n+  @Test", "originalCommit": "b251d04a6b622dceeb7213506eafe3fbf7ad118b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMyMjk4MA==", "url": "https://github.com/hyperledger/besu/pull/1078#discussion_r440322980", "bodyText": "Can you add a test that would trigger the exception raised by validateNatParams in BesuCommand ?", "author": "abdelhamidbakhta", "createdAt": "2020-06-15T17:09:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMyMTYwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMzMzYwMg==", "url": "https://github.com/hyperledger/besu/pull/1078#discussion_r440333602", "bodyText": "Done", "author": "matkt", "createdAt": "2020-06-15T17:28:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMyMTYwNQ=="}], "type": "inlineReview"}, {"oid": "2932f7b8a79aa728fe9b381f65a501a00c6e4aab", "url": "https://github.com/hyperledger/besu/commit/2932f7b8a79aa728fe9b381f65a501a00c6e4aab", "message": "fix review issues\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-06-15T17:28:30Z", "type": "commit"}, {"oid": "e1f5d16fb481bff10442933fff005cfae17256ab", "url": "https://github.com/hyperledger/besu/commit/e1f5d16fb481bff10442933fff005cfae17256ab", "message": "spotless apply\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-06-15T17:35:47Z", "type": "commit"}, {"oid": "e16a59a769dd0fd5e93c69d8d9b341e2ed23142c", "url": "https://github.com/hyperledger/besu/commit/e16a59a769dd0fd5e93c69d8d9b341e2ed23142c", "message": "Merge branch 'upstream/master' into feature/make-name-load-balancer-configurable\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-06-16T09:42:32Z", "type": "commit"}]}