{"pr_number": 1065, "pr_title": "Resolve inconsistent handling of certain config options.", "pr_createdAt": "2020-06-10T18:13:35Z", "pr_url": "https://github.com/hyperledger/besu/pull/1065", "timeline": [{"oid": "a276ca4b5d941ea20bd6e931de2dd5388685c35a", "url": "https://github.com/hyperledger/besu/commit/a276ca4b5d941ea20bd6e931de2dd5388685c35a", "message": "Resolve inconsistent handling of [Bb]oolean config options by handling primitives the same as the boxed type.\n\nSigned-off-by: Steven J Schroeder <steven.schroeder@consensys.net>", "committedDate": "2020-06-10T17:59:05Z", "type": "commit"}, {"oid": "426c1665563236f666a1e0e2234034138fe1bae4", "url": "https://github.com/hyperledger/besu/commit/426c1665563236f666a1e0e2234034138fe1bae4", "message": "Include unit tests for inconsistent formatting fix.\n\nSigned-off-by: Steven J Schroeder <steven.schroeder@consensys.net>", "committedDate": "2020-06-10T18:23:16Z", "type": "forcePushed"}, {"oid": "a78dede764d57bdc948dcd6460a62dbb44b1a240", "url": "https://github.com/hyperledger/besu/commit/a78dede764d57bdc948dcd6460a62dbb44b1a240", "message": "Include unit tests for inconsistent formatting fix.\n\nSigned-off-by: Steven J Schroeder <steven.schroeder@consensys.net>", "committedDate": "2020-06-10T19:07:05Z", "type": "commit"}, {"oid": "a78dede764d57bdc948dcd6460a62dbb44b1a240", "url": "https://github.com/hyperledger/besu/commit/a78dede764d57bdc948dcd6460a62dbb44b1a240", "message": "Include unit tests for inconsistent formatting fix.\n\nSigned-off-by: Steven J Schroeder <steven.schroeder@consensys.net>", "committedDate": "2020-06-10T19:07:05Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM1ODY3MQ==", "url": "https://github.com/hyperledger/besu/pull/1065#discussion_r438358671", "bodyText": "These unit tests were changed, as they relied on the errant behavior that was fixed in this PR in order to function properly.\nBecause a type was not specified in the OptionSpec Builder, picocli would treat them as boolean primitives. Previously, this would fail through to the default string handler, but would get caught and fail in the boolean handling logic after the change. As integers adequately describe these options in the test, they are explicitly cast as such.\nSingle-quoted literal strings were added to the TOML spec in 2014 by toml-lang/toml#232, however it seems as though version 4.1.4 of picocli fails to infer it is a String by default. In any case, the test is not compromised by this change, as it deals mainly with key matching and not type inference.", "author": "schroedingerscode", "createdAt": "2020-06-10T19:28:27Z", "path": "besu/src/test/java/org/hyperledger/besu/cli/TomlConfigFileDefaultProviderTest.java", "diffHunk": "@@ -72,21 +72,25 @@ public void defaultValueForMatchingKey() throws IOException {\n           new TomlConfigFileDefaultProvider(mockCommandLine, tempConfigFile);\n \n       // this option must be found in config\n-      assertThat(providerUnderTest.defaultValue(OptionSpec.builder(\"a-short-option\").build()))\n+      assertThat(\n+              providerUnderTest.defaultValue(\n+                  OptionSpec.builder(\"a-short-option\").type(Integer.class).build()))\n           .isEqualTo(\"123\");\n \n       // this option must be found in config as one of its names is present in the file.\n       // also this is the shortest one.\n       assertThat(\n               providerUnderTest.defaultValue(\n-                  OptionSpec.builder(\"a-short-option\", \"another-name-for-the-option\").build()))\n+                  OptionSpec.builder(\"a-short-option\", \"another-name-for-the-option\")\n+                      .type(Integer.class)\n+                      .build()))", "originalCommit": "a78dede764d57bdc948dcd6460a62dbb44b1a240", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1ea0b24b6436f4dc3727b45e9bbd09dd374d4d6c", "url": "https://github.com/hyperledger/besu/commit/1ea0b24b6436f4dc3727b45e9bbd09dd374d4d6c", "message": "Merge branch 'master' into bug/inconsistent-config-formatting", "committedDate": "2020-06-10T21:38:22Z", "type": "commit"}, {"oid": "cf3f5ac481741dfdece9930e04545697addcf0c8", "url": "https://github.com/hyperledger/besu/commit/cf3f5ac481741dfdece9930e04545697addcf0c8", "message": "Merge branch 'master' into bug/inconsistent-config-formatting", "committedDate": "2020-06-11T15:47:24Z", "type": "commit"}]}