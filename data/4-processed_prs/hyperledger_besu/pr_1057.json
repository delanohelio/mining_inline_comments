{"pr_number": 1057, "pr_title": "Add 0x check for Address, Bytes, and Bytes32 in GraphQl requests", "pr_createdAt": "2020-06-08T14:09:15Z", "pr_url": "https://github.com/hyperledger/besu/pull/1057", "timeline": [{"oid": "67b6fafd2394f496273c8c6662b136c4bedb79ed", "url": "https://github.com/hyperledger/besu/commit/67b6fafd2394f496273c8c6662b136c4bedb79ed", "message": "Add 0x check for Address, Bytes, and Bytes32 in GraphQl requests\n\nProduce error response if any of Address, Bytes or Bytes values\ninside GraphQl requests are not prefixed with 0x as defined by the spec.\n\nFix old tests that used values that are not prefixed with 0x and add\nadditional tests to confirm Address, Bytes and Bytes32 values will be\nrejected if not prefixed with 0x.\n\nSigned-off-by: Mak Muftic <mak@nodefactory.io>", "committedDate": "2020-06-08T12:43:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc3NjI3MQ==", "url": "https://github.com/hyperledger/besu/pull/1057#discussion_r436776271", "bodyText": "Just for the sake of keeping things logically co-located, I'd like to see this functionality in Quantity.java which has a lot of utility methods related to this. Maybe a static method like Quantity.isValid(String string)?", "author": "RatanRSur", "createdAt": "2020-06-08T15:00:20Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/graphql/internal/Scalars.java", "diffHunk": "@@ -55,8 +55,13 @@ public Address parseLiteral(final Object input) throws CoercingParseLiteralExcep\n           if (!(input instanceof StringValue)) {\n             throw new CoercingParseLiteralException(\"Value is not any Address : '\" + input + \"'\");\n           }\n+          String inputValue = ((StringValue) input).getValue();\n+          if (!inputValue.startsWith(\"0x\")) {\n+            throw new CoercingParseLiteralException(\n+                \"Address value '\" + inputValue + \"' is not prefixed with 0x\");\n+          }", "originalCommit": "67b6fafd2394f496273c8c6662b136c4bedb79ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI1NDYxMA==", "url": "https://github.com/hyperledger/besu/pull/1057#discussion_r437254610", "bodyText": "@RatanRSur thanks for the suggestion, I moved this check to Qunatitiy.java but as I read jdoc of class (...Quantity fields are represented as minimal length hex strings with no zero-padding...) I think this Quantity.isValid(String string) function should do additional checks\n\nis provided string valid hex string (just check that characters are valid)\nthat provided hex string is not padded with 0\n\nor I could rename function to something that reflects what exactly is tested.\nWhat do you think ?", "author": "MakMuftic", "createdAt": "2020-06-09T09:06:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc3NjI3MQ=="}], "type": "inlineReview"}, {"oid": "5f0e4e0e509a130113f53b0aa76c9877e771602c", "url": "https://github.com/hyperledger/besu/commit/5f0e4e0e509a130113f53b0aa76c9877e771602c", "message": "Move hex check to Quantity class\n\nSigned-off-by: Mak Muftic <mak@nodefactory.io>", "committedDate": "2020-06-09T08:54:34Z", "type": "commit"}, {"oid": "89a629ab5c79280e4ddb605ddc59ee14a4efe8c6", "url": "https://github.com/hyperledger/besu/commit/89a629ab5c79280e4ddb605ddc59ee14a4efe8c6", "message": "Merge branch 'master' into require-0x-prefix-bytes", "committedDate": "2020-06-18T08:48:18Z", "type": "commit"}, {"oid": "80e2c1088dd29bc22b5e6571ff193ab84b25fbe4", "url": "https://github.com/hyperledger/besu/commit/80e2c1088dd29bc22b5e6571ff193ab84b25fbe4", "message": "Fix tests with appropriate error messages\n\nSigned-off-by: Mak Muftic <mak@nodefactory.io>", "committedDate": "2020-06-18T11:06:47Z", "type": "commit"}, {"oid": "95fa72acb6b4517501f81c80002aae867dd1fa31", "url": "https://github.com/hyperledger/besu/commit/95fa72acb6b4517501f81c80002aae867dd1fa31", "message": "Merge branch 'master' into require-0x-prefix-bytes", "committedDate": "2020-06-30T07:49:30Z", "type": "commit"}, {"oid": "99ff600062849e368a91d501896bc5a409d7b36f", "url": "https://github.com/hyperledger/besu/commit/99ff600062849e368a91d501896bc5a409d7b36f", "message": "Merge branch 'master' into require-0x-prefix-bytes", "committedDate": "2020-07-01T09:10:01Z", "type": "commit"}, {"oid": "4004c4deaf96b0486763bb909b06fba8d31f4eac", "url": "https://github.com/hyperledger/besu/commit/4004c4deaf96b0486763bb909b06fba8d31f4eac", "message": "Merge branch 'master' into require-0x-prefix-bytes", "committedDate": "2020-07-02T07:39:07Z", "type": "commit"}, {"oid": "aa41433ab0044c04819cd109d12403f2ee9dc0a3", "url": "https://github.com/hyperledger/besu/commit/aa41433ab0044c04819cd109d12403f2ee9dc0a3", "message": "Merge branch 'master' into require-0x-prefix-bytes", "committedDate": "2020-07-03T10:00:31Z", "type": "commit"}]}