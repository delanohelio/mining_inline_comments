{"pr_number": 1556, "pr_title": "Merge CallParameter and JsonCallParameter classes", "pr_createdAt": "2020-11-12T15:36:43Z", "pr_url": "https://github.com/hyperledger/besu/pull/1556", "timeline": [{"oid": "5570e827ac1cdde772d2c1dc2736ec7e516d8bc6", "url": "https://github.com/hyperledger/besu/commit/5570e827ac1cdde772d2c1dc2736ec7e516d8bc6", "message": "clean JsonCallParameter class\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-11-12T15:24:18Z", "type": "commit"}, {"oid": "000bff0f5b50c597830e45fb656df8b2ce4cf58b", "url": "https://github.com/hyperledger/besu/commit/000bff0f5b50c597830e45fb656df8b2ce4cf58b", "message": "fix test failed\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-11-12T16:27:07Z", "type": "commit"}, {"oid": "84ef2446a45fad3d989ae1f798bf833ff6ec283f", "url": "https://github.com/hyperledger/besu/commit/84ef2446a45fad3d989ae1f798bf833ff6ec283f", "message": "Merge branch 'master' into feature/fix_invalid_call_params", "committedDate": "2020-11-12T16:29:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjQzMDg1NA==", "url": "https://github.com/hyperledger/besu/pull/1556#discussion_r522430854", "bodyText": "Why can't we just use the CallParameter with all of these annotations? Why do we need a separate JsonCallParameter class?", "author": "RatanRSur", "createdAt": "2020-11-12T21:15:37Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/JsonCallParameter.java", "diffHunk": "@@ -15,44 +15,36 @@\n package org.hyperledger.besu.ethereum.api.jsonrpc.internal.parameters;\n \n import org.hyperledger.besu.ethereum.core.Address;\n+import org.hyperledger.besu.ethereum.core.Gas;\n import org.hyperledger.besu.ethereum.core.Wei;\n import org.hyperledger.besu.ethereum.transaction.CallParameter;\n \n+import java.util.Optional;\n+\n import com.fasterxml.jackson.annotation.JsonCreator;\n import com.fasterxml.jackson.annotation.JsonProperty;\n-import com.google.common.annotations.VisibleForTesting;\n+import com.fasterxml.jackson.databind.annotation.JsonDeserialize;\n import org.apache.tuweni.bytes.Bytes;\n \n public class JsonCallParameter extends CallParameter {", "originalCommit": "84ef2446a45fad3d989ae1f798bf833ff6ec283f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjg0OTg1MQ==", "url": "https://github.com/hyperledger/besu/pull/1556#discussion_r522849851", "bodyText": "This was what I wanted to do at the beginning but the CallParameter class is in the core module and allows to use the TransactionSimulator. I looked in the core module and outside of the tests no class has this kind of annotation JsonProperty\nAs CallParamater is used in code to call the TransactionSimulator and JsonCallParamater is used to call RPC APIs. You may want to pass additional fields to the API without needing to pass it to the simulator. So for me it is two distinct objects but we can inherit for the common part", "author": "matkt", "createdAt": "2020-11-13T10:06:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjQzMDg1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk0NzYxMA==", "url": "https://github.com/hyperledger/besu/pull/1556#discussion_r522947610", "bodyText": "I can only easily imagine the simulator taking more parameters than a call parameter in the rpc since the simulator would need to know at least as much info as a normal call to do its job. Even if that happens eventually, that person will be empowered to split it in whichever way works for them.\nI don't think that other classes in the package not using JsonProperty annotations need block us from adding it. If it keeps the data model cleaner that's a plus. Also, if \"it hasn't been done before\" becomes a justification for things then many people can come across the same problem with the same solution and discard it because \"it hasn't been done before\", thus preventing others from seeing it has been done before.", "author": "RatanRSur", "createdAt": "2020-11-13T13:24:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjQzMDg1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzAxNjc3Mw==", "url": "https://github.com/hyperledger/besu/pull/1556#discussion_r523016773", "bodyText": "I don't think that other classes in the package not using JsonProperty annotations need block us from adding it.\n\nI just merged the two classes. I don't have a strong opinion on that.\n\nEven if that happens eventually, that person will be empowered to split it in whichever way works for them.\n\n\ud83d\udc4d", "author": "matkt", "createdAt": "2020-11-13T15:18:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjQzMDg1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk0NTIwNw==", "url": "https://github.com/hyperledger/besu/pull/1556#discussion_r522945207", "bodyText": "I'd rename this to HexStringDeserializer", "author": "RatanRSur", "createdAt": "2020-11-13T13:20:26Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/BytesDeserializer.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+package org.hyperledger.besu.ethereum.api.jsonrpc.internal.parameters;\n+\n+import java.io.IOException;\n+\n+import com.fasterxml.jackson.core.JsonParser;\n+import com.fasterxml.jackson.databind.DeserializationContext;\n+import com.fasterxml.jackson.databind.deser.std.StdDeserializer;\n+import org.apache.tuweni.bytes.Bytes;\n+\n+public class BytesDeserializer extends StdDeserializer<Bytes> {", "originalCommit": "84ef2446a45fad3d989ae1f798bf833ff6ec283f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzAxNTI0OQ==", "url": "https://github.com/hyperledger/besu/pull/1556#discussion_r523015249", "bodyText": "Done \ud83d\udc4d", "author": "matkt", "createdAt": "2020-11-13T15:15:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk0NTIwNw=="}], "type": "inlineReview"}, {"oid": "693b9a42cd965e3783e77c3f6078c399bab451de", "url": "https://github.com/hyperledger/besu/commit/693b9a42cd965e3783e77c3f6078c399bab451de", "message": "merge CallParameter and JsonCallParameter\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-11-13T15:08:17Z", "type": "commit"}, {"oid": "de3fb45111b6e65fd898e9e592eea0c95d70a55a", "url": "https://github.com/hyperledger/besu/commit/de3fb45111b6e65fd898e9e592eea0c95d70a55a", "message": "Merge branch 'feature/fix_invalid_call_params' with master\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-11-13T15:09:19Z", "type": "commit"}, {"oid": "1b3b3e864cee6822374feb49b68aa9e66fab1dab", "url": "https://github.com/hyperledger/besu/commit/1b3b3e864cee6822374feb49b68aa9e66fab1dab", "message": "Merge branch 'master' into feature/fix_invalid_call_params", "committedDate": "2020-11-13T15:09:32Z", "type": "commit"}, {"oid": "0be5ea61559068ea4730327f82c73c9314ede1a8", "url": "https://github.com/hyperledger/besu/commit/0be5ea61559068ea4730327f82c73c9314ede1a8", "message": "clean code\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-11-13T15:11:41Z", "type": "commit"}, {"oid": "a420b6e6e39531f235b3018097ba832d853813d6", "url": "https://github.com/hyperledger/besu/commit/a420b6e6e39531f235b3018097ba832d853813d6", "message": "Merge branch 'master' into feature/fix_invalid_call_params\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-11-13T15:14:10Z", "type": "commit"}, {"oid": "70fd86a5d04a8b7678fb20d1502f76dfd92ec411", "url": "https://github.com/hyperledger/besu/commit/70fd86a5d04a8b7678fb20d1502f76dfd92ec411", "message": "Merge branch 'master' into feature/fix_invalid_call_params", "committedDate": "2020-11-17T13:11:06Z", "type": "commit"}, {"oid": "d92ebdaef2d30a7ea8744a5cd027fc664283ea48", "url": "https://github.com/hyperledger/besu/commit/d92ebdaef2d30a7ea8744a5cd027fc664283ea48", "message": "Merge branch 'master' into feature/fix_invalid_call_params", "committedDate": "2020-11-17T13:37:38Z", "type": "commit"}]}