{"pr_number": 1567, "pr_title": "added blockhash as alias for blockHash param; added tests", "pr_createdAt": "2020-11-16T03:29:29Z", "pr_url": "https://github.com/hyperledger/besu/pull/1567", "timeline": [{"oid": "6d5a0df12e7a99c3b006081a4eb7aeca4e761bf1", "url": "https://github.com/hyperledger/besu/commit/6d5a0df12e7a99c3b006081a4eb7aeca4e761bf1", "message": "added case insensitive annotation for blockHash param; added tests\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-16T02:15:05Z", "type": "commit"}, {"oid": "2d5e3d97654ce39851c5888c2a4393ed369d920a", "url": "https://github.com/hyperledger/besu/commit/2d5e3d97654ce39851c5888c2a4393ed369d920a", "message": "Merge branch 'master' of https://github.com/hyperledger/besu into block-hash-rpc", "committedDate": "2020-11-16T03:29:50Z", "type": "commit"}, {"oid": "63349ae4343609b77065ed57332949256ef4ea93", "url": "https://github.com/hyperledger/besu/commit/63349ae4343609b77065ed57332949256ef4ea93", "message": "gradle jackson version\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-20T04:12:17Z", "type": "commit"}, {"oid": "de51b61660eab67d0e7992fc0cb2357e54fcfcb1", "url": "https://github.com/hyperledger/besu/commit/de51b61660eab67d0e7992fc0cb2357e54fcfcb1", "message": "Merge branch 'master' of https://github.com/hyperledger/besu into block-hash-rpc", "committedDate": "2020-11-22T23:56:10Z", "type": "commit"}, {"oid": "83ee230b1f5d3c521ce64cb85b3a5f67e7df9e2e", "url": "https://github.com/hyperledger/besu/commit/83ee230b1f5d3c521ce64cb85b3a5f67e7df9e2e", "message": "reverted gradle changes\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-22T23:57:24Z", "type": "commit"}, {"oid": "3adcd2a8eed4812c71fd51a339c6ddc637e82526", "url": "https://github.com/hyperledger/besu/commit/3adcd2a8eed4812c71fd51a339c6ddc637e82526", "message": "JsonAlias\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-23T00:39:53Z", "type": "commit"}, {"oid": "1151979e80e2638c4d7acd6596b1cebd1045ba8e", "url": "https://github.com/hyperledger/besu/commit/1151979e80e2638c4d7acd6596b1cebd1045ba8e", "message": "Merge branch 'master' of https://github.com/hyperledger/besu into block-hash-rpc", "committedDate": "2020-11-23T00:54:53Z", "type": "commit"}, {"oid": "6dbc968ba149c1f3d56ca8233b683359ae8fb620", "url": "https://github.com/hyperledger/besu/commit/6dbc968ba149c1f3d56ca8233b683359ae8fb620", "message": "formatting\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-23T00:55:11Z", "type": "commit"}, {"oid": "9bd646cb1832a2006be3469f7ea8f60aec8ef1ec", "url": "https://github.com/hyperledger/besu/commit/9bd646cb1832a2006be3469f7ea8f60aec8ef1ec", "message": "changelog entry\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-23T01:07:08Z", "type": "commit"}, {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642", "url": "https://github.com/hyperledger/besu/commit/8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642", "message": "spaces\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-23T01:09:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzODg5Ng==", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528438896", "bodyText": "Looks like you don't need to include blockHash in @JsonAlias.", "author": "mark-terry", "createdAt": "2020-11-23T01:40:07Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameter.java", "diffHunk": "@@ -49,7 +50,7 @@ public FilterParameter(\n           final List<Address> address,\n       @JsonDeserialize(using = TopicsDeserializer.class) @JsonProperty(\"topics\")\n           final List<List<LogTopic>> topics,\n-      @JsonProperty(\"blockhash\") final Hash blockHash) {\n+      @JsonProperty(\"blockHash\") @JsonAlias({\"blockhash\", \"blockHash\"}) final Hash blockHash) {", "originalCommit": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzOTU5Mg==", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528439592", "bodyText": "I'd consider deleting the previous test because the name clash is a bit confusing and the case of blockHash doesn't seem significant to the test case.", "author": "mark-terry", "createdAt": "2020-11-23T01:45:06Z", "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "diffHunk": "@@ -179,6 +180,68 @@ public void jsonWithBlockAndFromAndToParametersIsInvalid() throws Exception {\n     assertThat(parsedFilterParameter.isValid()).isFalse();\n   }\n \n+  @Test", "originalCommit": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ0Mjc5Mw==", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528442793", "bodyText": "put it into a single test", "author": "macfarla", "createdAt": "2020-11-23T02:06:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzOTU5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ0MDA5Mg==", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528440092", "bodyText": "The different casing of the test names is a bit confusing again...\nWould it make sense to merge both of these test cases into a blockHashAliasSucceeds that asserts the output of both requests is valid and that the output is equal?", "author": "mark-terry", "createdAt": "2020-11-23T01:48:58Z", "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "diffHunk": "@@ -179,6 +180,68 @@ public void jsonWithBlockAndFromAndToParametersIsInvalid() throws Exception {\n     assertThat(parsedFilterParameter.isValid()).isFalse();\n   }\n \n+  @Test\n+  public void jsonWithBlockHashAndFromAndToParametersIsInvalid() throws Exception {\n+    final String json =\n+        \"{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"method\\\":\\\"eth_getLogs\\\",\\\"params\\\":[{\"\n+            + \"\\\"address\\\":\\\"0x0\\\", \\\"fromBlock\\\": \\\"0x0\\\", \\\"toBlock\\\": \\\"pending\\\",\"\n+            + \"\\\"topics\\\":[\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \",\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \"], \\\"blockHash\\\": \\\"\"\n+            + Hash.ZERO\n+            + \"\\\"}],\\\"id\\\":1}\";\n+\n+    final JsonRpcRequestContext request = new JsonRpcRequestContext(readJsonAsJsonRpcRequest(json));\n+    final FilterParameter parsedFilterParameter =\n+        request.getRequiredParameter(0, FilterParameter.class);\n+\n+    assertThat(parsedFilterParameter.isValid()).isFalse();\n+  }\n+\n+  @Test\n+  public void jsonWithBlockHashIsValid() throws Exception {\n+    final String json =\n+        \"{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"method\\\":\\\"eth_getLogs\\\",\\\"params\\\":[{\"\n+            + \"\\\"address\\\":\\\"0x0\\\",\"\n+            + \"\\\"topics\\\":[\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \",\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \"], \\\"blockHash\\\": \\\"\"\n+            + Hash.ZERO\n+            + \"\\\"}],\\\"id\\\":1}\";\n+\n+    final JsonRpcRequestContext request = new JsonRpcRequestContext(readJsonAsJsonRpcRequest(json));\n+    final FilterParameter parsedFilterParameter =\n+        request.getRequiredParameter(0, FilterParameter.class);\n+\n+    assertThat(parsedFilterParameter.isValid()).isTrue();\n+    assertThat(parsedFilterParameter.getBlockHash()).isEqualTo(Optional.of(Hash.ZERO));\n+  }\n+\n+  @Test", "originalCommit": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ0MjAxNQ==", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528442015", "bodyText": "good idea", "author": "macfarla", "createdAt": "2020-11-23T02:01:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ0MDA5Mg=="}], "type": "inlineReview"}, {"oid": "b2c04d2b5479bcb6573005a4d164c6d18a423e7b", "url": "https://github.com/hyperledger/besu/commit/b2c04d2b5479bcb6573005a4d164c6d18a423e7b", "message": "space\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-23T01:54:10Z", "type": "commit"}, {"oid": "47798fe43b7abbd0190a3a20895d0ae17a775237", "url": "https://github.com/hyperledger/besu/commit/47798fe43b7abbd0190a3a20895d0ae17a775237", "message": "refactored testing of alias\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-23T02:05:46Z", "type": "commit"}, {"oid": "9a47ab299ed570625fdacad52041b06da3549317", "url": "https://github.com/hyperledger/besu/commit/9a47ab299ed570625fdacad52041b06da3549317", "message": "made past tense\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-11-23T02:06:00Z", "type": "commit"}]}