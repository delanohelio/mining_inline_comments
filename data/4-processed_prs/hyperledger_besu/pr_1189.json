{"pr_number": 1189, "pr_title": "Fix tracing with reference tests", "pr_createdAt": "2020-07-02T15:22:22Z", "pr_url": "https://github.com/hyperledger/besu/pull/1189", "timeline": [{"oid": "1932e13a7287d2df894d8cfaa23f04e4cd0e00a7", "url": "https://github.com/hyperledger/besu/commit/1932e13a7287d2df894d8cfaa23f04e4cd0e00a7", "message": "fix tracing with reference tests\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-07-02T15:06:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTEwNTc2Mg==", "url": "https://github.com/hyperledger/besu/pull/1189#discussion_r449105762", "bodyText": "If we are adding blocks for 1D and 1E we should have test traces for those blocks as well.", "author": "shemnon", "createdAt": "2020-07-02T15:45:36Z", "path": "ethereum/api/src/test/resources/org/hyperledger/besu/ethereum/api/jsonrpc/trace/chain-data/blocks.json", "diffHunk": "@@ -499,6 +499,32 @@\n           \"data\": \"0x60806040523373ffffffffffffffffffffffffffffffffffffffff16fffe\"\n         }\n       ]\n+    },\n+    {\n+      \"number\": \"0x1D\",", "originalCommit": "1932e13a7287d2df894d8cfaa23f04e4cd0e00a7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTExMDg0NQ==", "url": "https://github.com/hyperledger/besu/pull/1189#discussion_r449110845", "bodyText": "I just added it. good catch", "author": "matkt", "createdAt": "2020-07-02T15:49:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTEwNTc2Mg=="}], "type": "inlineReview"}, {"oid": "86a0d6acc590f86385c0afa05501c49eff40773f", "url": "https://github.com/hyperledger/besu/commit/86a0d6acc590f86385c0afa05501c49eff40773f", "message": "fix tracing with reference tests\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-07-02T15:47:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTExNDY5MQ==", "url": "https://github.com/hyperledger/besu/pull/1189#discussion_r449114691", "bodyText": "since this wraps all of the remaining conditions should it be changed to a mini guard-block?\nif (currentContext == null) {\n  continue;\n}\n\nor even a break since there is no way the currentContext will ever get changed?", "author": "shemnon", "createdAt": "2020-07-02T15:55:04Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/results/tracing/flat/FlatTraceGenerator.java", "diffHunk": "@@ -124,25 +129,25 @@\n               + traceFrame.getPrecompiledGasCost().orElse(Gas.ZERO).toLong();\n \n       final String opcodeString = traceFrame.getOpcode();\n-      if (\"CALL\".equals(opcodeString)\n-          || \"CALLCODE\".equals(opcodeString)\n-          || \"DELEGATECALL\".equals(opcodeString)\n-          || \"STATICCALL\".equals(opcodeString)) {\n-\n-        currentContext =\n-            handleCall(\n-                transactionTrace,\n-                traceFrame,\n-                nextTraceFrame,\n-                flatTraces,\n-                cumulativeGasCost,\n-                tracesContexts,\n-                opcodeString.toLowerCase(Locale.US));\n-\n-      } else if (\"CALLDATALOAD\".equals(opcodeString)) {\n-        if (currentContext != null) currentContext = handleCallDataLoad(currentContext, traceFrame);\n-      } else if (\"RETURN\".equals(opcodeString) || \"STOP\".equals(opcodeString)) {\n-        if (currentContext != null) {\n+      if (currentContext != null) {", "originalCommit": "86a0d6acc590f86385c0afa05501c49eff40773f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ2NjEzMA==", "url": "https://github.com/hyperledger/besu/pull/1189#discussion_r449466130", "bodyText": "Done . I will use break", "author": "matkt", "createdAt": "2020-07-03T08:58:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTExNDY5MQ=="}], "type": "inlineReview"}, {"oid": "b6ff56c4b90f648e563ee5444a212902ff405cf4", "url": "https://github.com/hyperledger/besu/commit/b6ff56c4b90f648e563ee5444a212902ff405cf4", "message": "fix review issue\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-07-03T08:56:14Z", "type": "commit"}, {"oid": "4f314d52de54733e920cc06f548bbaca9d065865", "url": "https://github.com/hyperledger/besu/commit/4f314d52de54733e920cc06f548bbaca9d065865", "message": "Merge branch 'upstream/master' into feature/reference-test-for-tracing\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-07-03T08:57:38Z", "type": "commit"}]}