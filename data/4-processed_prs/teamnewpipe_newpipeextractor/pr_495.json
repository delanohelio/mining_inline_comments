{"pr_number": 495, "pr_title": "[PeerTube] Implement sepia search", "pr_createdAt": "2020-12-23T14:10:12Z", "pr_url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/495", "timeline": [{"oid": "3ae924a7f18d5ee5b4aa0bd13d7179922cc094fa", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/3ae924a7f18d5ee5b4aa0bd13d7179922cc094fa", "message": "Implement sepia search", "committedDate": "2020-12-23T14:07:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2MjU4NQ==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/495#discussion_r550762585", "bodyText": "JDoc please", "author": "TobiGr", "createdAt": "2021-01-01T12:09:56Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/peertube/PeertubeParsingHelper.java", "diffHunk": "@@ -63,6 +64,11 @@ public static Page getNextPage(final String prevPageUrl, final long total) {\n     }\n \n     public static void collectStreamsFrom(final InfoItemsCollector collector, final JsonObject json, final String baseUrl) throws ParsingException {\n+        collectStreamsFrom(collector, json, baseUrl, false);\n+    }\n+\n+    // sepia: if we should use PeertubeSepiaStreamInfoItemExtractor\n+    public static void collectStreamsFrom(final InfoItemsCollector collector, final JsonObject json, final String baseUrl, boolean sepia) throws ParsingException {", "originalCommit": "3ae924a7f18d5ee5b4aa0bd13d7179922cc094fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2Mjc5MQ==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/495#discussion_r550762791", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void setBaseUrl(final String baseUrl) {\n          \n          \n            \n                protected void setBaseUrl(final String baseUrl) {", "author": "TobiGr", "createdAt": "2021-01-01T12:13:17Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/peertube/extractors/PeertubeStreamInfoItemExtractor.java", "diffHunk": "@@ -84,4 +84,8 @@ public StreamType getStreamType() {\n     public long getDuration() {\n         return item.getLong(\"duration\");\n     }\n+\n+    public void setBaseUrl(final String baseUrl) {", "originalCommit": "3ae924a7f18d5ee5b4aa0bd13d7179922cc094fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2MzM1MA==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/495#discussion_r550763350", "bodyText": "Why only startsWith(\"sepia_\") and not equals(SEPIA_VIDEOS)?", "author": "TobiGr", "createdAt": "2021-01-01T12:20:11Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/peertube/PeertubeService.java", "diffHunk": "@@ -59,7 +61,12 @@ public ListLinkHandlerFactory getCommentsLHFactory() {\n \n     @Override\n     public SearchExtractor getSearchExtractor(SearchQueryHandler queryHandler) {\n-        return new PeertubeSearchExtractor(this, queryHandler);\n+        final List<String> contentFilters = queryHandler.getContentFilters();\n+        boolean external = false;\n+        if (contentFilters.size() > 0 && contentFilters.get(0).startsWith(\"sepia_\")) {", "originalCommit": "3ae924a7f18d5ee5b4aa0bd13d7179922cc094fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc3MDA0MA==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/495#discussion_r550770040", "bodyText": "I used the same convention as YoutubeMusicSearchExtractor, i.e. filters start with music_ when using MusicSearchExtractor", "author": "B0pol", "createdAt": "2021-01-01T13:46:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2MzM1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2MzM3Ng==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/495#discussion_r550763376", "bodyText": "same question as above", "author": "TobiGr", "createdAt": "2021-01-01T12:20:42Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/peertube/linkHandler/PeertubeSearchQueryHandlerFactory.java", "diffHunk": "@@ -20,7 +22,12 @@ public static PeertubeSearchQueryHandlerFactory getInstance() {\n \n     @Override\n     public String getUrl(String searchString, List<String> contentFilters, String sortFilter) throws ParsingException {\n-        String baseUrl = ServiceList.PeerTube.getBaseUrl();\n+        String baseUrl;\n+        if (contentFilters.size() > 0 && contentFilters.get(0).startsWith(\"sepia_\")) {", "originalCommit": "3ae924a7f18d5ee5b4aa0bd13d7179922cc094fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2OTkxOQ==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/495#discussion_r550769919", "bodyText": "because if we implement other search filters (e.g. channels), it will not change, the baseUrl with sepia filters will still be sepiasearch.org (by default, unless another baseUrl for another index is provided)", "author": "B0pol", "createdAt": "2021-01-01T13:45:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2MzM3Ng=="}], "type": "inlineReview"}, {"oid": "0e45c25ea93101b86dc5cbc2b3fd46bf37d690a8", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/0e45c25ea93101b86dc5cbc2b3fd46bf37d690a8", "message": "Update extractor/src/main/java/org/schabi/newpipe/extractor/services/peertube/extractors/PeertubeStreamInfoItemExtractor.java\n\nCo-authored-by: Tobias Groza <TobiGr@users.noreply.github.com>", "committedDate": "2021-01-01T13:20:47Z", "type": "commit"}, {"oid": "0bcea9c2cd49889f1a748c6e2a0328af0b083756", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/0bcea9c2cd49889f1a748c6e2a0328af0b083756", "message": "add JDoc", "committedDate": "2021-01-01T13:37:32Z", "type": "commit"}]}