{"pr_number": 953, "pr_title": "Add message to confirm that user wants to update MODS record without adding a title", "pr_createdAt": "2020-04-03T15:13:27Z", "pr_url": "https://github.com/UNC-Libraries/box-c/pull/953", "timeline": [{"oid": "43e4bf5f698bccb6436ecf09b3d39c0af11fd72c", "url": "https://github.com/UNC-Libraries/box-c/commit/43e4bf5f698bccb6436ecf09b3d39c0af11fd72c", "message": "Add message to confirm that user want to update MODS record without setting a title.", "committedDate": "2020-04-03T15:11:05Z", "type": "commit"}, {"oid": "341bda97cc4a8c74ff567420f05426b23b10e388", "url": "https://github.com/UNC-Libraries/box-c/commit/341bda97cc4a8c74ff567420f05426b23b10e388", "message": "* Don't set title to an empty string\n* Refactor getAlternativeTitle. Variable \"title\" was always null", "committedDate": "2020-04-08T15:59:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ4OTMzMQ==", "url": "https://github.com/UNC-Libraries/box-c/pull/953#discussion_r407489331", "bodyText": "Should we do empty checks before returning these values? StringUtils.isBlank catches null, blank, or all whitespace. If the title is present but empty, we'd want to fall back to the other options", "author": "bbpennel", "createdAt": "2020-04-13T13:53:53Z", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetDescriptiveMetadataFilter.java", "diffHunk": "@@ -97,23 +97,18 @@ public void filter(DocumentIndexingPackage dip) throws IndexingException {\n     }\n \n     private String getAlternativeTitle(DocumentIndexingPackage dip) throws FedoraException, IndexingException {\n-        String title = null;\n         Resource resc = dip.getContentObject().getResource();\n \n         // Use dc:title as a default\n         if (resc.hasProperty(DcElements.title)) {\n             Statement dcTitle = resc.getProperty(DcElements.title);\n             return dcTitle.getString();\n-        }\n-\n-        // fall back to filename if one is present\n-        if (title == null && resc.hasProperty(Ebucore.filename)) {\n+        } else if (resc.hasProperty(Ebucore.filename)) { // fall back to filename if one is present", "originalCommit": "341bda97cc4a8c74ff567420f05426b23b10e388", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ5MTA1Mw==", "url": "https://github.com/UNC-Libraries/box-c/pull/953#discussion_r407491053", "bodyText": "you can use StringUtils.isBlank in place of these two checks (the apache commons lang3 version)", "author": "bbpennel", "createdAt": "2020-04-13T13:57:22Z", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetDescriptiveMetadataFilter.java", "diffHunk": "@@ -131,7 +126,11 @@ private void extractTitles(Element mods, IndexDocumentBean idb) {\n                 }\n             }\n         }\n-        idb.setTitle(mainTitle);\n+\n+        if (mainTitle != null && !mainTitle.equals(\"\")) {", "originalCommit": "341bda97cc4a8c74ff567420f05426b23b10e388", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ5MTU4NA==", "url": "https://github.com/UNC-Libraries/box-c/pull/953#discussion_r407491584", "bodyText": "This statement probably isn't accurate anymore. Maybe we can remove this warning, assuming the indexing part works correctly?", "author": "bbpennel", "createdAt": "2020-04-13T13:58:23Z", "path": "static/js/xmleditor/jquery.xmleditor.js", "diffHunk": "@@ -905,6 +905,18 @@ $.widget( \"xml.xmlEditor\", {\n \t\t}\n \t\t// convert XML DOM to string\n \t\tvar xmlString = this.xml2Str(this.xmlState.xml);\n+\n+\t\tif (/mods:title.*?\\/>/.test(xmlString)) {\n+\t\t\tif (window.confirm(\"The current MODS document has no title. \" +\n+\t\t\t\t\"This will result in no title displaying for the record. Would you like to save anyway?\")) {", "originalCommit": "341bda97cc4a8c74ff567420f05426b23b10e388", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5b8444b823839786f9f0b8b1d83a3a7499a6c713", "url": "https://github.com/UNC-Libraries/box-c/commit/5b8444b823839786f9f0b8b1d83a3a7499a6c713", "message": "Remove editor note and add blank check.", "committedDate": "2020-04-13T19:25:34Z", "type": "commit"}, {"oid": "9ccc521477ffd6ac54d912ebd0b713d0e5d4038d", "url": "https://github.com/UNC-Libraries/box-c/commit/9ccc521477ffd6ac54d912ebd0b713d0e5d4038d", "message": "Remove unused import", "committedDate": "2020-04-13T19:31:26Z", "type": "commit"}, {"oid": "a22a684fd954ac7b18983ec0c14aa5489e1b2407", "url": "https://github.com/UNC-Libraries/box-c/commit/a22a684fd954ac7b18983ec0c14aa5489e1b2407", "message": "Add tests for altTitle", "committedDate": "2020-04-13T20:09:34Z", "type": "commit"}]}