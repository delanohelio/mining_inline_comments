{"pr_number": 997, "pr_title": "Fix issues with display showing the wrong user prinicipal in some situations", "pr_createdAt": "2020-05-26T17:38:21Z", "pr_url": "https://github.com/UNC-Libraries/box-c/pull/997", "timeline": [{"oid": "5708dcd26f680e0dbb69f0b75f09c6d3989bfe4f", "url": "https://github.com/UNC-Libraries/box-c/commit/5708dcd26f680e0dbb69f0b75f09c6d3989bfe4f", "message": "Fix issues with display showing the wrong user prinicpal in some situations", "committedDate": "2020-05-26T17:24:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcwNjY3Mw==", "url": "https://github.com/UNC-Libraries/box-c/pull/997#discussion_r430706673", "bodyText": "I'm having a hard time following this. If i'm understanding correctly, it will display a single \"staff only\" line if all of the following are try 1) both the assigned roles are the same, 2) the computed user roles are both \"none\", 3) either both the inherited roles are the same or there are no inherited roles + the assigned roles at the same.\nI'm wondering why both 1 and 2 are required? Seems like the computed roles on the object would be what determines the display here, unless its to avoid rows coming and going too frequently when toggling options? Could 1 & 2 be replaced with users[0].role === users[1].role && users[0].role === 'none'? Guess I'm just not sure why the assigned roles matter, but I probably am missing something.\nCould hasSameInheritedRoles return true if there are no inherited roles? That might simplify things some.", "author": "bbpennel", "createdAt": "2020-05-26T21:03:50Z", "path": "static/js/admin/vue-permissions-editor/src/components/patronRoles.vue", "diffHunk": "@@ -378,7 +378,8 @@\n \n                 if (users.length === 0) {\n                     return users;\n-                } else if (this.hasSameAssignedRoles && users[0].role === 'none' && users[1].role === 'none') {\n+                } else if (this.hasSameAssignedRoles && users[0].role === 'none' && users[1].role === 'none'", "originalCommit": "5708dcd26f680e0dbb69f0b75f09c6d3989bfe4f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcxMTcwMQ==", "url": "https://github.com/UNC-Libraries/box-c/pull/997#discussion_r430711701", "bodyText": "Should this test be verifying that the parents aren't merged? And that the correct rows are being marked as active? (both the parent roles I believe).", "author": "bbpennel", "createdAt": "2020-05-26T21:14:39Z", "path": "static/js/admin/vue-permissions-editor/tests/unit/patronRoles.spec.js", "diffHunk": "@@ -535,6 +558,25 @@ describe('patronRoles.vue', () => {\n         });\n     });\n \n+    it(\"does not merge display permissions if assigned roles are different but inherited roles are the same\", (done) => {", "originalCommit": "5708dcd26f680e0dbb69f0b75f09c6d3989bfe4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5MzU4OA==", "url": "https://github.com/UNC-Libraries/box-c/pull/997#discussion_r431193588", "bodyText": "Yes. I think I copied another test and apparently only partly updated it.", "author": "lfarrell", "createdAt": "2020-05-27T14:45:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcxMTcwMQ=="}], "type": "inlineReview"}, {"oid": "de58f35a6333e0e56104cd6d532b51b53e88ba72", "url": "https://github.com/UNC-Libraries/box-c/commit/de58f35a6333e0e56104cd6d532b51b53e88ba72", "message": "Encapsulate and simplify conditional", "committedDate": "2020-05-27T18:45:33Z", "type": "commit"}, {"oid": "9c424223d088e24b2c91448c64fa85303090c88e", "url": "https://github.com/UNC-Libraries/box-c/commit/9c424223d088e24b2c91448c64fa85303090c88e", "message": "Fix issue with 'patron' displaying incorrectly, if assigned roles are different", "committedDate": "2020-05-27T18:46:33Z", "type": "commit"}]}