{"pr_number": 969, "pr_title": "Upgrade Vue.js CLI to 4.x", "pr_createdAt": "2020-04-29T18:39:43Z", "pr_url": "https://github.com/UNC-Libraries/box-c/pull/969", "timeline": [{"oid": "6561bf42c9d455b06c9dc6dbe8922121ea567649", "url": "https://github.com/UNC-Libraries/box-c/commit/6561bf42c9d455b06c9dc6dbe8922121ea567649", "message": "Package updates", "committedDate": "2020-04-28T15:32:20Z", "type": "commit"}, {"oid": "962797ab909300b041dba4da010e4294eefdef20", "url": "https://github.com/UNC-Libraries/box-c/commit/962797ab909300b041dba4da010e4294eefdef20", "message": "Update for new output names", "committedDate": "2020-04-28T15:32:40Z", "type": "commit"}, {"oid": "9899190762bd5ea26dd1dcabdfb38567ca637315", "url": "https://github.com/UNC-Libraries/box-c/commit/9899190762bd5ea26dd1dcabdfb38567ca637315", "message": "Update permissions editor to vue-cli 4.3.x", "committedDate": "2020-04-28T16:46:39Z", "type": "commit"}, {"oid": "72b4e4face07c4006dae6388a70626597a98d1ca", "url": "https://github.com/UNC-Libraries/box-c/commit/72b4e4face07c4006dae6388a70626597a98d1ca", "message": "Update vue-cdr-access packages", "committedDate": "2020-04-28T18:07:59Z", "type": "commit"}, {"oid": "657fc1106cf6f35737f0fa902302dc258365eb5f", "url": "https://github.com/UNC-Libraries/box-c/commit/657fc1106cf6f35737f0fa902302dc258365eb5f", "message": "Router push needs a catch block, as navigating to same route throws an error, see https://github.com/vuejs/vue-router/issues/2881#issuecomment-520554378. It seems it's not supposed to throw the error if parameters are changed, so maybe a bug in vue-router?", "committedDate": "2020-04-28T18:10:10Z", "type": "commit"}, {"oid": "e92e54b0a3f3e98ed1a419d5bad09105ce054411", "url": "https://github.com/UNC-Libraries/box-c/commit/e92e54b0a3f3e98ed1a419d5bad09105ce054411", "message": "* Update vue-cdr-access packages\n* Security fixes", "committedDate": "2020-04-28T20:29:50Z", "type": "commit"}, {"oid": "51f91dbd765294dddc44c60312ba273c4697dc3e", "url": "https://github.com/UNC-Libraries/box-c/commit/51f91dbd765294dddc44c60312ba273c4697dc3e", "message": "Fix issue with js build not overwriting previous build", "committedDate": "2020-04-29T14:00:24Z", "type": "commit"}, {"oid": "8a7249ce1c3e42ffb8ff979cb302b076e729cf25", "url": "https://github.com/UNC-Libraries/box-c/commit/8a7249ce1c3e42ffb8ff979cb302b076e729cf25", "message": "Update vue-test-utils and fix tests. There were breaking changes in 1.0.0-beta.30", "committedDate": "2020-04-29T17:20:54Z", "type": "commit"}, {"oid": "ead054709c84446be4ad78f5aaa5cea1ed5f656c", "url": "https://github.com/UNC-Libraries/box-c/commit/ead054709c84446be4ad78f5aaa5cea1ed5f656c", "message": "Remove unneeded import", "committedDate": "2020-04-29T19:04:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE0NjI0Ng==", "url": "https://github.com/UNC-Libraries/box-c/pull/969#discussion_r418146246", "bodyText": "Just checking, but is the case now that we don't need to change behaviors depending on the deploy type for the permissions editor js, but do still need to for the css?", "author": "bbpennel", "createdAt": "2020-04-30T16:43:56Z", "path": "Makefile", "diffHunk": "@@ -14,18 +14,13 @@ endif\n \n \tcat /dev/null > static/js/vue-permissions.js\n \n-ifeq ($(DEPLOY_TYPE), prod)\n-\tcat static/js/admin/vue-permissions-editor/dist/js/chunk-vendors*.js > static/js/vue-permissions.js\n-endif\n+\tcat static/js/admin/vue-permissions-editor/dist/js/chunk-vendors*js > static/js/vue-permissions.js\n+\n \n \t# Add new line so app*.js doesn't get commented out\n \techo >> static/js/vue-permissions.js\n \n-ifeq ($(DEPLOY_TYPE), prod)\n-\tcat static/js/admin/vue-permissions-editor/dist/js/app*.js >> static/js/vue-permissions.js\n-else\n-\tcat static/js/admin/vue-permissions-editor/dist/app.js >> static/js/vue-permissions.js\n-endif\n+\tcat static/js/admin/vue-permissions-editor/dist/js/app*js >> static/js/vue-permissions.js", "originalCommit": "ead054709c84446be4ad78f5aaa5cea1ed5f656c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5ODE0Ng==", "url": "https://github.com/UNC-Libraries/box-c/pull/969#discussion_r418198146", "bodyText": "Correct, the JS files should be the same now across deployment types. In the dev build the css still get bundled into the JS files.", "author": "lfarrell", "createdAt": "2020-04-30T18:12:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE0NjI0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE1OTk1Mg==", "url": "https://github.com/UNC-Libraries/box-c/pull/969#discussion_r418159952", "bodyText": "what triggers NavigationDuplicated errors? Something like clicking twice on a link?", "author": "bbpennel", "createdAt": "2020-04-30T17:07:22Z", "path": "static/js/vue-cdr-access/src/components/browseSearch.vue", "diffHunk": "@@ -41,7 +41,12 @@\n         methods: {\n             getResults() {\n                 let update_params = { anywhere: encodeURIComponent(this.search_query) };\n-                this.$router.push({ name: 'displayRecords', query: this.urlParams(update_params) });\n+                this.$router.push({ name: 'displayRecords', query: this.urlParams(update_params) })\n+                    .catch((e) => {\n+                        if (e.name !== 'NavigationDuplicated') {", "originalCommit": "ead054709c84446be4ad78f5aaa5cea1ed5f656c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODIwMDg5Mw==", "url": "https://github.com/UNC-Libraries/box-c/pull/969#discussion_r418200893", "bodyText": "I think that or trying to redirect to the same url you're at. If I read the ticket mentioned in the commit correctly, it shouldn't give this error if you update parameters. It's possible that doesn't include parameters's specified via the ?. It might only refer to params in the route, like :uuid in our case. Not catching the error doesn't break anything, but it does throw a bunch of warnings in the tests.", "author": "lfarrell", "createdAt": "2020-04-30T18:17:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE1OTk1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE2NzYwNg==", "url": "https://github.com/UNC-Libraries/box-c/pull/969#discussion_r418167606", "bodyText": "Real dean is getting prettified!", "author": "bbpennel", "createdAt": "2020-04-30T17:20:16Z", "path": "static/js/vue-cdr-access/tests/unit/modalMetadata.spec.js", "diffHunk": "@@ -9,7 +10,7 @@ localVue.use(VueRouter);\n \n const updated_uuid = 'c03a4bd7-25f4-4a6c-a68d-fedc4251b680';\n const title = 'Test Collection';\n-const response = `<table><tbody><tr><th>Creator</th> <td><p>Real Dean</p></td></tr></tbody></table>`;\n+const response = pretty(`<table><tbody><tr><th>Creator</th><td><p>Real Dean</p></td></tr></tbody></table>`);", "originalCommit": "ead054709c84446be4ad78f5aaa5cea1ed5f656c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5OTI4MA==", "url": "https://github.com/UNC-Libraries/box-c/pull/969#discussion_r418199280", "bodyText": "Yeah, vue test utils changed how they return HTML. It used to have no spaces, but they switched to formatting the HTML with the pretty package before returning it.", "author": "lfarrell", "createdAt": "2020-04-30T18:14:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE2NzYwNg=="}], "type": "inlineReview"}]}