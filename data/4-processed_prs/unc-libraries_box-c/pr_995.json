{"pr_number": 995, "pr_title": "Add note about max file size and throw an error if file is larger than the max allowed", "pr_createdAt": "2020-05-20T14:18:38Z", "pr_url": "https://github.com/UNC-Libraries/box-c/pull/995", "timeline": [{"oid": "af8d9593732627fc2e690e462a5350e4898af300", "url": "https://github.com/UNC-Libraries/box-c/commit/af8d9593732627fc2e690e462a5350e4898af300", "message": "Add note about max file size and throw an error if file is larger than the max allowed.", "committedDate": "2020-05-20T14:16:27Z", "type": "commit"}, {"oid": "33b362c335f55a66b5a150c3fcb1c826a973ae7b", "url": "https://github.com/UNC-Libraries/box-c/commit/33b362c335f55a66b5a150c3fcb1c826a973ae7b", "message": "Update note and file size", "committedDate": "2020-05-22T15:28:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQyMzQ5Mg==", "url": "https://github.com/UNC-Libraries/box-c/pull/995#discussion_r429423492", "bodyText": "this message doesn't match the size elsewhere", "author": "bbpennel", "createdAt": "2020-05-22T19:36:26Z", "path": "static/js/admin/src/AbstractFileUploadForm.js", "diffHunk": "@@ -24,20 +24,29 @@ define('AbstractFileUploadForm', [ 'jquery', 'jquery-ui', 'underscore', 'Abstrac\n \tAbstractFileUploadForm.prototype.open = function(resultObject) {\n \t\tvar dialogBox = new ModalCreate(this.options);\n \t\tvar formContents = dialogBox.formContents(resultObject);\n+\t\tvar errors = [];\n+\t\tvar maxFileSize = 1610612736; // 1.5gb\n \t\tvar self = this;\n \t\tthis.closed = false;\n \t\t\n \t\tthis.dialog = $(\"<div class='containingDialog'>\" + formContents + \"</div>\");\n \t\tthis.$form = this.dialog.first();\n \t\tthis.dialog.dialog = dialogBox.modalDialog(this.dialog, self);\n \t\t\n-\t\t$(\"input[type='file']\", this.$form).change(function(){\n+\t\t$(\"input[type='file']\", this.$form).change(function() {\n+\t\t\terrors = []; // reset errors on change\n \t\t\tself.ingestFile = this.files[0];\n \t\t\tif (self.ingestFile) {\n+\t\t\t\tvar fileSize = self.ingestFile.size\n+\n+\t\t\t\tif (fileSize > maxFileSize) {\n+\t\t\t\t\terrors.push(\"The uploaded file is too large. The maximum allowed file size is: 500mb\");", "originalCommit": "33b362c335f55a66b5a150c3fcb1c826a973ae7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c7e3f82158b0e8ba09136bf5bc20278d37660314", "url": "https://github.com/UNC-Libraries/box-c/commit/c7e3f82158b0e8ba09136bf5bc20278d37660314", "message": "Fix error note", "committedDate": "2020-05-22T19:47:43Z", "type": "commit"}]}