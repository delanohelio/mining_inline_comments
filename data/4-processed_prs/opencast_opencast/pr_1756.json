{"pr_number": 1756, "pr_title": "Change markdown CI checks to bash", "pr_createdAt": "2020-08-10T19:25:44Z", "pr_url": "https://github.com/opencast/opencast/pull/1756", "timeline": [{"oid": "b40147d51bf5b130faa7be4efbbb64034d15de72", "url": "https://github.com/opencast/opencast/commit/b40147d51bf5b130faa7be4efbbb64034d15de72", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-10T19:29:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODEzNTU4Nw==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r468135587", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # maven-dependency-plugin should be active for all now modules\n          \n          \n            \n            # maven-dependency-plugin should be active for all new modules", "author": "lkiesow", "createdAt": "2020-08-10T19:35:11Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,60 @@\n+#!/bin/bash\n+\n+ret=0\n+\n+if grep -rn $'\\t' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Tabs found!\"\n+  ret=1\n+fi\n+if grep -rn ' $' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Trailing spaces found!\"\n+  ret=1\n+fi\n+if grep -rn '\t' etc; then\n+  echo \"Tabs found in config files!\"\n+  ret=1\n+fi\n+if grep -rn ' $' etc; then\n+  echo \"Trailing spaces found in config files!\"\n+  ret=1\n+fi\n+\n+\n+# build number must be present in all modules\n+if ! grep -L '<Build-Number>${buildNumber}</Build-Number>' modules/*/pom.xml | wc -l | grep -q '^0$'; then\n+  echo \"Build number is missing from a module!\"\n+  ret=1\n+fi\n+\n+# maven-dependency-plugin should be active for all now modules", "originalCommit": "b40147d51bf5b130faa7be4efbbb64034d15de72", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "27c8a7d513c07480c2262d55f02e1f5756204ee0", "url": "https://github.com/opencast/opencast/commit/27c8a7d513c07480c2262d55f02e1f5756204ee0", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-10T19:55:14Z", "type": "forcePushed"}, {"oid": "fcf2f8568777dbed148d485fc7c26fe4173559f8", "url": "https://github.com/opencast/opencast/commit/fcf2f8568777dbed148d485fc7c26fe4173559f8", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-10T20:28:38Z", "type": "forcePushed"}, {"oid": "f397d0a4ab67a1ff48498b3fcf89aaa716f7851b", "url": "https://github.com/opencast/opencast/commit/f397d0a4ab67a1ff48498b3fcf89aaa716f7851b", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-10T20:40:11Z", "type": "forcePushed"}, {"oid": "9204833d364a7104417faa892edd9c388f53565b", "url": "https://github.com/opencast/opencast/commit/9204833d364a7104417faa892edd9c388f53565b", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-10T20:52:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA3NzQzNw==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470077437", "bodyText": "Why the additional cd? This should have no effect whatsoever since you are executing the code in a subshell, should it?\n% (cd ..; pwd); pwd\n/home\n/home/lars\n% (cd ..; pwd; cd ..); pwd\n/home\n/home/lars", "author": "lkiesow", "createdAt": "2020-08-13T16:30:37Z", "path": ".travis.yml", "diffHunk": "@@ -66,33 +66,9 @@ jobs:\n       python: \"3.6\"\n       install:\n         - pip install mkdocs markdown_inline_graphviz_extension mkdocs-windmill\n-        - (cd docs/guides && npm install)\n+        - (cd docs/guides && npm install && cd ../..)", "originalCommit": "9204833d364a7104417faa892edd9c388f53565b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE0ODMyMQ==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470148321", "bodyText": "Derp.  That's a leftover from an initial revision which had the checks in separate files.", "author": "gregorydlogan", "createdAt": "2020-08-13T18:06:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA3NzQzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4NjM4OA==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470086388", "bodyText": "Don't just continue if errors happen e.g. when changing directory:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            \n          \n          \n            \n            set -eu", "author": "lkiesow", "createdAt": "2020-08-13T16:45:33Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,60 @@\n+#!/bin/bash\n+", "originalCommit": "9204833d364a7104417faa892edd9c388f53565b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDg3NzM2MA==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470877360", "bodyText": "Not sure if you missed this. But without this, the script will run successfully with a return value of 0 even if the mkdocs command fails.", "author": "lkiesow", "createdAt": "2020-08-14T21:41:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4NjM4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkzMzk0MA==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470933940", "bodyText": "It shouldn't, that's what the ret flag is for.  I'd like it to run all the tests, and then fail if any of them have failed.\nBut now that you mention it, there's a typo in the commented out code :D", "author": "gregorydlogan", "createdAt": "2020-08-15T03:58:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4NjM4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk2NDUwNQ==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470964505", "bodyText": "It shouldn't, that's what the ret flag is for. I'd like it to run all the tests, and then fail if any of them have failed.\n\nYes it will and the ret will not help you a bit.\nLet me give you one example (there are lots of other things which can go wrong. Don't try to catch them yourself):\n% bash .style-and-markdown-build.sh\nMarkdown doc admin build log:\n.style-and-markdown-build.sh: line 43: mkdocs: command not found\nMarkdown doc developer build log:\n.style-and-markdown-build.sh: line 43: mkdocs: command not found\nMarkdown doc user build log:\n.style-and-markdown-build.sh: line 43: mkdocs: command not found\n\n> docs@ test /home/lars/dev/opencast/docs/guides\n> markdownlint *.md ./admin/**/*.md ./developer/**/*.md ./user/**/*.md ../../*.md\n\n% echo $?\n0\n\nAs you can see, mkdocs clearly failed since the command did not exist but your script returned success.\nYour script currently works fundamentally different than the tests did before since you are just looking at the specific tests but knowingly ignore all errors happening with the commands itself. The set -e will change that. It has no effect on the ret values and their evaluation you built.", "author": "lkiesow", "createdAt": "2020-08-15T10:43:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4NjM4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY2ODY3NQ==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r471668675", "bodyText": "Good point, added.", "author": "gregorydlogan", "createdAt": "2020-08-17T18:07:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4NjM4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4OTQ2Ng==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470089466", "bodyText": "pushd stores the original directory, making the additional cd somewhat weird.\nUsing this would work the same:\npushd \"$docs\"\nBut since you are not keeping multiple locations, you can also just use the simpler cd; \u2026; cd - which also does not print making the pipe unnecessary.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              pushd . > /dev/null\n          \n          \n            \n              cd $docs\n          \n          \n            \n              cd \"$docs\"", "author": "lkiesow", "createdAt": "2020-08-13T16:50:56Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,60 @@\n+#!/bin/bash\n+\n+ret=0\n+\n+if grep -rn $'\\t' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Tabs found!\"\n+  ret=1\n+fi\n+if grep -rn ' $' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Trailing spaces found!\"\n+  ret=1\n+fi\n+if grep -rn '\t' etc; then\n+  echo \"Tabs found in config files!\"\n+  ret=1\n+fi\n+if grep -rn ' $' etc; then\n+  echo \"Trailing spaces found in config files!\"\n+  ret=1\n+fi\n+\n+\n+# build number must be present in all modules\n+if ! grep -L '<Build-Number>${buildNumber}</Build-Number>' modules/*/pom.xml | wc -l | grep -q '^0$'; then\n+  echo \"Build number is missing from a module!\"\n+  ret=1\n+fi\n+\n+# maven-dependency-plugin should be active for all new modules\n+#grep -L maven-dependency-plugin modules/*/pom.xml > maven-dependency-plugin.list\n+#if ! diff -q maven-dependency-plugin.list docs/checkstyle/maven-dependency-plugin.exceptions; then\n+#  rev=1\n+#fi\n+\n+cd docs/guides\n+\n+for docs in admin developer user; do\n+  pushd . > /dev/null\n+  cd $docs", "originalCommit": "9204833d364a7104417faa892edd9c388f53565b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4OTYzNw==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470089637", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              popd > /dev/null\n          \n          \n            \n              cd -", "author": "lkiesow", "createdAt": "2020-08-13T16:51:12Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,60 @@\n+#!/bin/bash\n+\n+ret=0\n+\n+if grep -rn $'\\t' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Tabs found!\"\n+  ret=1\n+fi\n+if grep -rn ' $' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Trailing spaces found!\"\n+  ret=1\n+fi\n+if grep -rn '\t' etc; then\n+  echo \"Tabs found in config files!\"\n+  ret=1\n+fi\n+if grep -rn ' $' etc; then\n+  echo \"Trailing spaces found in config files!\"\n+  ret=1\n+fi\n+\n+\n+# build number must be present in all modules\n+if ! grep -L '<Build-Number>${buildNumber}</Build-Number>' modules/*/pom.xml | wc -l | grep -q '^0$'; then\n+  echo \"Build number is missing from a module!\"\n+  ret=1\n+fi\n+\n+# maven-dependency-plugin should be active for all new modules\n+#grep -L maven-dependency-plugin modules/*/pom.xml > maven-dependency-plugin.list\n+#if ! diff -q maven-dependency-plugin.list docs/checkstyle/maven-dependency-plugin.exceptions; then\n+#  rev=1\n+#fi\n+\n+cd docs/guides\n+\n+for docs in admin developer user; do\n+  pushd . > /dev/null\n+  cd $docs\n+  mkdocs build > mkdocs.log 2>&1\n+  if grep \\\n+       -e 'WARNING.*Documentation file' \\\n+       -e 'pages exist in the docs directory' \\\n+       -e 'is not found in the documentation files' \\\n+        mkdocs.log;\n+    then\n+      echo \"$docs did not build correctly!\"\n+      ret=1\n+  fi\n+  echo \"Markdown doc $docs build log:\"\n+  cat mkdocs.log\n+  popd > /dev/null", "originalCommit": "9204833d364a7104417faa892edd9c388f53565b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA5MTU0Nw==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470091547", "bodyText": "Only with the additional set -e will the script fail if mkdocs fails. Right now, actually being able to build the docs is not checked like this. Once set -e is included, that should be fine.", "author": "lkiesow", "createdAt": "2020-08-13T16:54:19Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,60 @@\n+#!/bin/bash\n+\n+ret=0\n+\n+if grep -rn $'\\t' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Tabs found!\"\n+  ret=1\n+fi\n+if grep -rn ' $' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Trailing spaces found!\"\n+  ret=1\n+fi\n+if grep -rn '\t' etc; then\n+  echo \"Tabs found in config files!\"\n+  ret=1\n+fi\n+if grep -rn ' $' etc; then\n+  echo \"Trailing spaces found in config files!\"\n+  ret=1\n+fi\n+\n+\n+# build number must be present in all modules\n+if ! grep -L '<Build-Number>${buildNumber}</Build-Number>' modules/*/pom.xml | wc -l | grep -q '^0$'; then\n+  echo \"Build number is missing from a module!\"\n+  ret=1\n+fi\n+\n+# maven-dependency-plugin should be active for all new modules\n+#grep -L maven-dependency-plugin modules/*/pom.xml > maven-dependency-plugin.list\n+#if ! diff -q maven-dependency-plugin.list docs/checkstyle/maven-dependency-plugin.exceptions; then\n+#  rev=1\n+#fi\n+\n+cd docs/guides\n+\n+for docs in admin developer user; do\n+  pushd . > /dev/null\n+  cd $docs\n+  mkdocs build > mkdocs.log 2>&1", "originalCommit": "9204833d364a7104417faa892edd9c388f53565b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE0OTcxNw==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470149717", "bodyText": "IIRC, when I was testing this some of the useful logging output was ending up to stderr and not in the log, hence the redirect.", "author": "gregorydlogan", "createdAt": "2020-08-13T18:08:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA5MTU0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA5NTM0MQ==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470095341", "bodyText": "Not strictly necessary but maybe add a\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            cd \"$(dirname $(realpath -s $0))\"\n          \n      \n    \n    \n  \n\nThat makes it work when it's run from different locations.", "author": "lkiesow", "createdAt": "2020-08-13T17:00:36Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,60 @@\n+#!/bin/bash\n+\n+ret=0\n+", "originalCommit": "9204833d364a7104417faa892edd9c388f53565b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDEzODk3MA==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470138970", "bodyText": "Is it intentional that mkdocs.log is always printed? Before it was only printed in case there was an error. Both are fine, I just want to make sure it's intentional.\nIf you want to print it regardless, you can use tee above:\nmkdocs build 2>&1 | tee mkdocs.log", "author": "lkiesow", "createdAt": "2020-08-13T17:51:25Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,60 @@\n+#!/bin/bash\n+\n+ret=0\n+\n+if grep -rn $'\\t' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Tabs found!\"\n+  ret=1\n+fi\n+if grep -rn ' $' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Trailing spaces found!\"\n+  ret=1\n+fi\n+if grep -rn '\t' etc; then\n+  echo \"Tabs found in config files!\"\n+  ret=1\n+fi\n+if grep -rn ' $' etc; then\n+  echo \"Trailing spaces found in config files!\"\n+  ret=1\n+fi\n+\n+\n+# build number must be present in all modules\n+if ! grep -L '<Build-Number>${buildNumber}</Build-Number>' modules/*/pom.xml | wc -l | grep -q '^0$'; then\n+  echo \"Build number is missing from a module!\"\n+  ret=1\n+fi\n+\n+# maven-dependency-plugin should be active for all new modules\n+#grep -L maven-dependency-plugin modules/*/pom.xml > maven-dependency-plugin.list\n+#if ! diff -q maven-dependency-plugin.list docs/checkstyle/maven-dependency-plugin.exceptions; then\n+#  rev=1\n+#fi\n+\n+cd docs/guides\n+\n+for docs in admin developer user; do\n+  pushd . > /dev/null\n+  cd $docs\n+  mkdocs build > mkdocs.log 2>&1\n+  if grep \\\n+       -e 'WARNING.*Documentation file' \\\n+       -e 'pages exist in the docs directory' \\\n+       -e 'is not found in the documentation files' \\\n+        mkdocs.log;\n+    then\n+      echo \"$docs did not build correctly!\"\n+      ret=1\n+  fi\n+  echo \"Markdown doc $docs build log:\"\n+  cat mkdocs.log", "originalCommit": "9204833d364a7104417faa892edd9c388f53565b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE1MDgzNQ==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r470150835", "bodyText": "I thought it handy?  I ran into issues getting markdown to fail during testing, so I wanted to be sure the log contained everything and that my checks were at fault :)", "author": "gregorydlogan", "createdAt": "2020-08-13T18:10:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDEzODk3MA=="}], "type": "inlineReview"}, {"oid": "068547507a310d3676f37fbc402b94e3736c5499", "url": "https://github.com/opencast/opencast/commit/068547507a310d3676f37fbc402b94e3736c5499", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-15T04:01:27Z", "type": "forcePushed"}, {"oid": "8b10c723accd34f8ba0345d18e0fe42ef1fa8d24", "url": "https://github.com/opencast/opencast/commit/8b10c723accd34f8ba0345d18e0fe42ef1fa8d24", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-15T04:12:27Z", "type": "forcePushed"}, {"oid": "4288cfb7f7fe0b35f1c1aa761baee171d3eb146f", "url": "https://github.com/opencast/opencast/commit/4288cfb7f7fe0b35f1c1aa761baee171d3eb146f", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-17T18:06:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjExNDM0MA==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r472114340", "bodyText": "Is there a particular reason to not set nounset? You resolved my suggestion for adding it without comment. I don't think it will have a huge effect here but it also will not hurt and is a safer choice when people potentially modify the script.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            set -e\n          \n          \n            \n            set -ue", "author": "lkiesow", "createdAt": "2020-08-18T11:42:35Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,63 @@\n+#!/bin/bash\n+\n+set -e", "originalCommit": "4288cfb7f7fe0b35f1c1aa761baee171d3eb146f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM4NzIxMg==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r472387212", "bodyText": "Nope, no reason, just forgot to add it :D", "author": "gregorydlogan", "createdAt": "2020-08-18T18:09:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjExNDM0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjExNTczMA==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r472115730", "bodyText": "This has no function anymore\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              pushd . > /dev/null", "author": "lkiesow", "createdAt": "2020-08-18T11:45:11Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,63 @@\n+#!/bin/bash\n+\n+set -e\n+\n+ret=0\n+\n+cd \"$(dirname $(realpath -s $0))\"\n+\n+if grep -rn $'\\t' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Tabs found!\"\n+  ret=1\n+fi\n+if grep -rn ' $' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Trailing spaces found!\"\n+  ret=1\n+fi\n+if grep -rn '\t' etc; then\n+  echo \"Tabs found in config files!\"\n+  ret=1\n+fi\n+if grep -rn ' $' etc; then\n+  echo \"Trailing spaces found in config files!\"\n+  ret=1\n+fi\n+\n+\n+# build number must be present in all modules\n+if ! grep -L '<Build-Number>${buildNumber}</Build-Number>' modules/*/pom.xml | wc -l | grep -q '^0$'; then\n+  echo \"Build number is missing from a module!\"\n+  ret=1\n+fi\n+\n+# maven-dependency-plugin should be active for all new modules\n+#grep -L maven-dependency-plugin modules/*/pom.xml > maven-dependency-plugin.list\n+#if ! diff -q maven-dependency-plugin.list docs/checkstyle/maven-dependency-plugin.exceptions; then\n+#  ret=1\n+#fi\n+\n+cd docs/guides\n+\n+for docs in admin developer user; do\n+  pushd . > /dev/null", "originalCommit": "4288cfb7f7fe0b35f1c1aa761baee171d3eb146f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjExNjgwMg==", "url": "https://github.com/opencast/opencast/pull/1756#discussion_r472116802", "bodyText": "Just to keep to one style:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            if grep -rn '\t' etc; then\n          \n          \n            \n            if grep -rn $'\\t' etc; then", "author": "lkiesow", "createdAt": "2020-08-18T11:47:09Z", "path": ".style-and-markdown-build.sh", "diffHunk": "@@ -0,0 +1,63 @@\n+#!/bin/bash\n+\n+set -e\n+\n+ret=0\n+\n+cd \"$(dirname $(realpath -s $0))\"\n+\n+if grep -rn $'\\t' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Tabs found!\"\n+  ret=1\n+fi\n+if grep -rn ' $' modules assemblies pom.xml --include=pom.xml; then\n+  echo \"Trailing spaces found!\"\n+  ret=1\n+fi\n+if grep -rn '\t' etc; then", "originalCommit": "4288cfb7f7fe0b35f1c1aa761baee171d3eb146f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4a4047f69465610fa614c185580291a0f44349ea", "url": "https://github.com/opencast/opencast/commit/4a4047f69465610fa614c185580291a0f44349ea", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-18T18:08:56Z", "type": "forcePushed"}, {"oid": "0da324965464eb371030626e5a6f222f2fd5f791", "url": "https://github.com/opencast/opencast/commit/0da324965464eb371030626e5a6f222f2fd5f791", "message": "Switch to a bash script for extra checks, which makes the tests reusable with other CI systems.", "committedDate": "2020-08-18T21:11:28Z", "type": "commit"}, {"oid": "f1c96052fbb6472030c265fb8d31c0a8e52875f5", "url": "https://github.com/opencast/opencast/commit/f1c96052fbb6472030c265fb8d31c0a8e52875f5", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-18T21:11:29Z", "type": "commit"}, {"oid": "f1c96052fbb6472030c265fb8d31c0a8e52875f5", "url": "https://github.com/opencast/opencast/commit/f1c96052fbb6472030c265fb8d31c0a8e52875f5", "message": "This script was developed with develop (9.x) in mind, this patch adds compatibility for 8.x.  Revert this for 9.x and newer.", "committedDate": "2020-08-18T21:11:29Z", "type": "forcePushed"}]}