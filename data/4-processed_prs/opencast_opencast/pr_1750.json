{"pr_number": 1750, "pr_title": "HTTPS with Apache httpd", "pr_createdAt": "2020-08-09T12:57:55Z", "pr_url": "https://github.com/opencast/opencast/pull/1750", "timeline": [{"oid": "748fc8369654bb3f7554fb0118b6e836f204499b", "url": "https://github.com/opencast/opencast/commit/748fc8369654bb3f7554fb0118b6e836f204499b", "message": "HTTPS with Apache httpd\n\nThis patch documents how to enable HTTPS for Opencast using Apache httpd\nas reverse proxy.", "committedDate": "2020-08-09T13:00:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI2MzI0Ng==", "url": "https://github.com/opencast/opencast/pull/1750#discussion_r469263246", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            > refer to the [Nginx guide for configuration instructions](nginx.md) for that type of setup.\n          \n          \n            \n            > Refer to the [Nginx guide for configuration instructions](nginx.md) for that type of setup.", "author": "Arnei", "createdAt": "2020-08-12T13:34:49Z", "path": "docs/guides/admin/docs/configuration/https/apache-httpd.md", "diffHunk": "@@ -0,0 +1,79 @@\n+Enable HTTPS using Apache httpd\n+===============================\n+\n+> [Using Nginx as reverse proxy for Opencast](nginx.md) is the preferred way of running Opencast.\n+> refer to the [Nginx guide for configuration instructions](nginx.md) for that type of setup.", "originalCommit": "748fc8369654bb3f7554fb0118b6e836f204499b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI2NDY3Mg==", "url": "https://github.com/opencast/opencast/pull/1750#discussion_r469264672", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Als enable secure cookies in `etc/org.ops4j.pax.web.cfg`:\n          \n          \n            \n            Also enable secure cookies in `etc/org.ops4j.pax.web.cfg`:", "author": "Arnei", "createdAt": "2020-08-12T13:36:58Z", "path": "docs/guides/admin/docs/configuration/https/apache-httpd.md", "diffHunk": "@@ -0,0 +1,79 @@\n+Enable HTTPS using Apache httpd\n+===============================\n+\n+> [Using Nginx as reverse proxy for Opencast](nginx.md) is the preferred way of running Opencast.\n+> refer to the [Nginx guide for configuration instructions](nginx.md) for that type of setup.\n+\n+This guide will help you to configure httpd to act as HTTP(S) proxy for Opencast.\n+\n+\n+Opencast Configuration\n+----------------------\n+\n+Make sure to use `https` as protocol for `org.opencastproject.server.url` in `etc/custom.properties`.\n+\n+```ini\n+org.opencastproject.server.url=https://example.opencast.org\n+```\n+\n+Als enable secure cookies in `etc/org.ops4j.pax.web.cfg`:", "originalCommit": "748fc8369654bb3f7554fb0118b6e836f204499b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "38c177a6c8b994ab1b152823289f2eca9ceaa270", "url": "https://github.com/opencast/opencast/commit/38c177a6c8b994ab1b152823289f2eca9ceaa270", "message": "HTTPS with Apache httpd\n\nThis patch documents how to enable HTTPS for Opencast using Apache httpd\nas reverse proxy.", "committedDate": "2020-08-12T15:10:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODY1ODM4OQ==", "url": "https://github.com/opencast/opencast/pull/1750#discussion_r498658389", "bodyText": "I think these lines should also go into nginx-documentation.", "author": "pascalseeland", "createdAt": "2020-10-02T07:33:18Z", "path": "docs/guides/admin/docs/configuration/https/apache-httpd.md", "diffHunk": "@@ -0,0 +1,79 @@\n+Enable HTTPS using Apache httpd\n+===============================\n+\n+> [Using Nginx as reverse proxy for Opencast](nginx.md) is the preferred way of running Opencast.\n+> Refer to the [Nginx guide for configuration instructions](nginx.md) for that type of setup.\n+\n+This guide will help you to configure httpd to act as HTTP(S) proxy for Opencast.\n+\n+\n+Opencast Configuration\n+----------------------\n+\n+Make sure to use `https` as protocol for `org.opencastproject.server.url` in `etc/custom.properties`.\n+\n+```ini\n+org.opencastproject.server.url=https://example.opencast.org\n+```\n+\n+Also enable secure cookies in `etc/org.ops4j.pax.web.cfg`:\n+\n+```ini\n+org.ops4j.pax.web.session.cookie.secure=true\n+org.ops4j.pax.web.session.cookie.httpOnly=true\n+```", "originalCommit": "38c177a6c8b994ab1b152823289f2eca9ceaa270", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODcxODY5MQ==", "url": "https://github.com/opencast/opencast/pull/1750#discussion_r498718691", "bodyText": "No. You don't need that since Nginx takes care of that :)\nThat's also, what I think this would do for Apache httpd and I tend to replace this.\nBut I have no test system to try it out any longer:\n  Header edit Set-Cookie ^(.*)$ $1; HttpOnly; Secure; SameSite=None", "author": "lkiesow", "createdAt": "2020-10-02T09:37:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODY1ODM4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ1NDc5Ng==", "url": "https://github.com/opencast/opencast/pull/1750#discussion_r499454796", "bodyText": "This does the same as the nginx code. For consistency reasons, I would prefer this option instead of the ini file.", "author": "pascalseeland", "createdAt": "2020-10-05T09:16:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODY1ODM4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODY2MjI4NQ==", "url": "https://github.com/opencast/opencast/pull/1750#discussion_r498662285", "bodyText": "This should be example.opencast.org as mentioned in line 42 to be consistent", "author": "pascalseeland", "createdAt": "2020-10-02T07:42:16Z", "path": "docs/guides/admin/docs/configuration/https/apache-httpd.md", "diffHunk": "@@ -0,0 +1,79 @@\n+Enable HTTPS using Apache httpd\n+===============================\n+\n+> [Using Nginx as reverse proxy for Opencast](nginx.md) is the preferred way of running Opencast.\n+> Refer to the [Nginx guide for configuration instructions](nginx.md) for that type of setup.\n+\n+This guide will help you to configure httpd to act as HTTP(S) proxy for Opencast.\n+\n+\n+Opencast Configuration\n+----------------------\n+\n+Make sure to use `https` as protocol for `org.opencastproject.server.url` in `etc/custom.properties`.\n+\n+```ini\n+org.opencastproject.server.url=https://example.opencast.org\n+```\n+\n+Also enable secure cookies in `etc/org.ops4j.pax.web.cfg`:\n+\n+```ini\n+org.ops4j.pax.web.session.cookie.secure=true\n+org.ops4j.pax.web.session.cookie.httpOnly=true\n+```\n+\n+No other configuration is required.\n+Do not enable TLS in Opencast.\n+Listen to local connections only.\n+Both are the default settings.\n+\n+\n+Minimal Set-up\n+--------------\n+\n+> Note that this guide does not give any security advice but is meant to provide a minimal working example which works\n+> well with Opencast.\n+\n+The following configuration is an example for `/etc/httpd/conf.d/opencast.conf`.\n+Note that depending on your distributions packaging, often `conf.d` or `sites-enabled` directories are used.\n+Adjust the file path accordingly.\n+\n+Explanations for the configuration directives are provided inline. Please make sure to replace `example.opencast.org`\n+with your node's domain name.\n+\n+The main goals of this set-up are:\n+\n+- Always redirect to HTTPS\n+- Proxy to Opencast and take care of TLS\n+- Avoid caching\n+\n+\n+```\n+<VirtualHost *:80>\n+  ServerName opencast.lkiesow.io", "originalCommit": "38c177a6c8b994ab1b152823289f2eca9ceaa270", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODczMDczNQ==", "url": "https://github.com/opencast/opencast/pull/1750#discussion_r498730735", "bodyText": "Fixed", "author": "lkiesow", "createdAt": "2020-10-02T10:03:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODY2MjI4NQ=="}], "type": "inlineReview"}, {"oid": "1f6a4e58fefd2b32ea93556d9b330cecef8a2e8a", "url": "https://github.com/opencast/opencast/commit/1f6a4e58fefd2b32ea93556d9b330cecef8a2e8a", "message": "HTTPS with Apache httpd\n\nThis patch documents how to enable HTTPS for Opencast using Apache httpd\nas reverse proxy.", "committedDate": "2020-10-02T10:02:59Z", "type": "forcePushed"}, {"oid": "7431709e568817e85748ff83b1be7e2308c05471", "url": "https://github.com/opencast/opencast/commit/7431709e568817e85748ff83b1be7e2308c05471", "message": "HTTPS with Apache httpd\n\nThis patch documents how to enable HTTPS for Opencast using Apache httpd\nas reverse proxy.", "committedDate": "2020-10-05T10:57:48Z", "type": "commit"}, {"oid": "7431709e568817e85748ff83b1be7e2308c05471", "url": "https://github.com/opencast/opencast/commit/7431709e568817e85748ff83b1be7e2308c05471", "message": "HTTPS with Apache httpd\n\nThis patch documents how to enable HTTPS for Opencast using Apache httpd\nas reverse proxy.", "committedDate": "2020-10-05T10:57:48Z", "type": "forcePushed"}]}