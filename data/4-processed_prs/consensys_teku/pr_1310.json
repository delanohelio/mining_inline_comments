{"pr_number": 1310, "pr_title": "Add interface level object definitions for BeaconBlock endpoint.", "pr_createdAt": "2020-03-06T11:57:17Z", "pr_url": "https://github.com/ConsenSys/teku/pull/1310", "timeline": [{"oid": "b29e24e2057a5e49554358a949b67cfb8a27dc08", "url": "https://github.com/ConsenSys/teku/commit/b29e24e2057a5e49554358a949b67cfb8a27dc08", "message": "Add interface level object definitions for BeaconBlock endpoint.\n\nAdded tests for some utility functions, moved functional tests from the interface level down to the ChainDataProvider.\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>\n\n#1301", "committedDate": "2020-03-06T11:55:44Z", "type": "commit"}, {"oid": "8ab889558a4d07c17183de718be2c1b371311d02", "url": "https://github.com/ConsenSys/teku/commit/8ab889558a4d07c17183de718be2c1b371311d02", "message": "rename RestApiUtils to be more specific\n\nStart a CacheControlUtils\n\nRefactor the context handling in BeaconBlockHandler.\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-03-08T20:36:10Z", "type": "commit"}, {"oid": "3524232ec12d5bd6da67716fd2cc7de769c50fe8", "url": "https://github.com/ConsenSys/teku/commit/3524232ec12d5bd6da67716fd2cc7de769c50fe8", "message": "Merge remote-tracking branch 'upstream/master' into 1301-beaconBlockHandler", "committedDate": "2020-03-08T20:40:14Z", "type": "commit"}, {"oid": "6c6c39393ace8d90ed65bc5a47cca890d051b0c0", "url": "https://github.com/ConsenSys/teku/commit/6c6c39393ace8d90ed65bc5a47cca890d051b0c0", "message": "Merge remote-tracking branch 'upstream/master' into 1301-beaconBlockHandler", "committedDate": "2020-03-08T22:55:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNjczMg==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389416732", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              void getMaxAgeForSignedBlock_shouldSetZeroIfNotFinalized() {\n          \n          \n            \n              void getMaxAgeForSignedBlock_shouldReturnZeroIfNotFinalized() {", "author": "macfarla", "createdAt": "2020-03-08T23:17:44Z", "path": "data/beaconrestapi/src/test/java/tech/pegasys/artemis/beaconrestapi/CacheControlUtilsTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.beaconrestapi;\n+\n+import static com.google.common.primitives.UnsignedLong.ZERO;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.Mockito.when;\n+import static tech.pegasys.artemis.beaconrestapi.CacheControlUtils.CACHE_FINALIZED;\n+import static tech.pegasys.artemis.beaconrestapi.CacheControlUtils.CACHE_NONE;\n+\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import tech.pegasys.artemis.api.ChainDataProvider;\n+import tech.pegasys.artemis.api.schema.SignedBeaconBlock;\n+import tech.pegasys.artemis.datastructures.util.DataStructureUtil;\n+\n+@ExtendWith(MockitoExtension.class)\n+public class CacheControlUtilsTest {\n+\n+  SignedBeaconBlock signedBlock =\n+      new SignedBeaconBlock(DataStructureUtil.randomSignedBeaconBlock(1, 1));\n+  @Mock private ChainDataProvider provider;\n+\n+  @Test\n+  void getMaxAgeForSignedBlock_shouldSetZeroIfNotFinalized() {", "originalCommit": "6c6c39393ace8d90ed65bc5a47cca890d051b0c0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNjc2NA==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389416764", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              void getMaxAgeForSignedBlock_shouldSetZeroIfFinalized() {\n          \n          \n            \n              void getMaxAgeForSignedBlock_shouldReturnZeroIfFinalized() {", "author": "macfarla", "createdAt": "2020-03-08T23:17:58Z", "path": "data/beaconrestapi/src/test/java/tech/pegasys/artemis/beaconrestapi/CacheControlUtilsTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.beaconrestapi;\n+\n+import static com.google.common.primitives.UnsignedLong.ZERO;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.Mockito.when;\n+import static tech.pegasys.artemis.beaconrestapi.CacheControlUtils.CACHE_FINALIZED;\n+import static tech.pegasys.artemis.beaconrestapi.CacheControlUtils.CACHE_NONE;\n+\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import tech.pegasys.artemis.api.ChainDataProvider;\n+import tech.pegasys.artemis.api.schema.SignedBeaconBlock;\n+import tech.pegasys.artemis.datastructures.util.DataStructureUtil;\n+\n+@ExtendWith(MockitoExtension.class)\n+public class CacheControlUtilsTest {\n+\n+  SignedBeaconBlock signedBlock =\n+      new SignedBeaconBlock(DataStructureUtil.randomSignedBeaconBlock(1, 1));\n+  @Mock private ChainDataProvider provider;\n+\n+  @Test\n+  void getMaxAgeForSignedBlock_shouldSetZeroIfNotFinalized() {\n+    when(provider.isFinalized(signedBlock)).thenReturn(false);\n+    String cacheControl = CacheControlUtils.getMaxAgeForSignedBlock(provider, signedBlock);\n+    assertThat(cacheControl).isEqualTo(CACHE_NONE);\n+  }\n+\n+  @Test\n+  void getMaxAgeForSignedBlock_shouldSetZeroIfFinalized() {", "originalCommit": "6c6c39393ace8d90ed65bc5a47cca890d051b0c0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNjg0OA==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389416848", "bodyText": "hang on they aren't both zero are they?", "author": "macfarla", "createdAt": "2020-03-08T23:18:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNjc2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNzkyOQ==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389417929", "bodyText": "ok, bad naming of the test.\nIf the object is not finalized, i want to set max-age=zero in the cache header, otherwise setting to the cache-finalized string (cache timeout = 1 year)\nHopefully the new names make more sense..", "author": "rolfyone", "createdAt": "2020-03-08T23:27:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNjc2NA=="}], "type": "inlineReview"}, {"oid": "e555c181aa4032ed6d070ed29ebe9acbc6e40eff", "url": "https://github.com/ConsenSys/teku/commit/e555c181aa4032ed6d070ed29ebe9acbc6e40eff", "message": "Update data/beaconrestapi/src/test/java/tech/pegasys/artemis/beaconrestapi/CacheControlUtilsTest.java\n\nCo-Authored-By: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-08T23:21:29Z", "type": "commit"}, {"oid": "8c72349ef53bb2567474c0e7eb3dd3a22c4748a1", "url": "https://github.com/ConsenSys/teku/commit/8c72349ef53bb2567474c0e7eb3dd3a22c4748a1", "message": "changes to hopefully clear up test naming, from review feedback\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-03-08T23:25:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNzM2MQ==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389417361", "bodyText": "why is Bytes4 48 bytes?", "author": "macfarla", "createdAt": "2020-03-08T23:23:00Z", "path": "data/provider/src/main/java/tech/pegasys/artemis/api/schema/BLSPubKey.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.api.schema;\n+\n+import static com.google.common.base.Preconditions.checkArgument;\n+\n+import java.util.Objects;\n+import org.apache.tuweni.bytes.Bytes;\n+\n+public class BLSPubKey {\n+  /** The number of bytes in this value - i.e. 48 */\n+  private final int SIZE = 48;\n+\n+  private final Bytes bytes;\n+\n+  public BLSPubKey(Bytes bytes) {\n+    checkArgument(\n+        bytes.size() == SIZE, \"Bytes4 should be %s bytes, but was %s bytes.\", SIZE, bytes.size());", "originalCommit": "6c6c39393ace8d90ed65bc5a47cca890d051b0c0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQyMTQzNQ==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389421435", "bodyText": "comment should be bringing in size, i'll fix those.", "author": "rolfyone", "createdAt": "2020-03-09T00:09:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNzM2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNzQ2Ng==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389417466", "bodyText": "should it just be Bytes should be ...", "author": "macfarla", "createdAt": "2020-03-08T23:23:35Z", "path": "data/provider/src/main/java/tech/pegasys/artemis/api/schema/BLSSignature.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.api.schema;\n+\n+import static com.google.common.base.Preconditions.checkArgument;\n+\n+import java.util.Objects;\n+import org.apache.tuweni.bytes.Bytes;\n+\n+public class BLSSignature {\n+  /** The number of bytes in this value - i.e. 96 */\n+  private final int SIZE = 96;\n+\n+  private final Bytes bytes;\n+\n+  public BLSSignature(Bytes bytes) {\n+    checkArgument(\n+        bytes.size() == SIZE, \"Bytes4 should be %s bytes, but was %s bytes.\", SIZE, bytes.size());", "originalCommit": "6c6c39393ace8d90ed65bc5a47cca890d051b0c0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNzkyMA==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389417920", "bodyText": "is this change related?", "author": "macfarla", "createdAt": "2020-03-08T23:27:11Z", "path": "data/provider/src/main/java/tech/pegasys/artemis/provider/BLSSignatureSerializer.java", "diffHunk": "@@ -17,12 +17,12 @@\n import com.fasterxml.jackson.databind.JsonSerializer;\n import com.fasterxml.jackson.databind.SerializerProvider;\n import java.io.IOException;\n-import tech.pegasys.artemis.util.bls.BLSSignature;\n+import tech.pegasys.artemis.api.schema.BLSSignature;\n \n public class BLSSignatureSerializer extends JsonSerializer<BLSSignature> {\n   @Override\n   public void serialize(BLSSignature value, JsonGenerator gen, SerializerProvider serializers)\n       throws IOException {\n-    gen.writeString(value.toBytes().toHexString().toLowerCase());\n+    gen.writeString(value.toHexString().toLowerCase());", "originalCommit": "8c72349ef53bb2567474c0e7eb3dd3a22c4748a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQyMTQ4NA==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389421484", "bodyText": "because BLSSignature changed, and the toBytes isn't on the new object... We're the only consumers of the serializers, so i updated it.", "author": "rolfyone", "createdAt": "2020-03-09T00:10:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNzkyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNzk1OQ==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389417959", "bodyText": "why do we have BLSPublicKey and BLSPubKey?", "author": "macfarla", "createdAt": "2020-03-08T23:27:44Z", "path": "data/provider/src/main/java/tech/pegasys/artemis/provider/JsonProvider.java", "diffHunk": "@@ -38,6 +39,7 @@ private void addTekuMappers() {\n \n     module.addDeserializer(BLSPublicKey.class, new BLSPublicKeyDeserializer());\n     module.addSerializer(BLSPublicKey.class, new BLSPublicKeySerializer());\n+    module.addSerializer(BLSPubKey.class, new BLSPubKeySerializer());", "originalCommit": "8c72349ef53bb2567474c0e7eb3dd3a22c4748a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQyMjQxNg==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389422416", "bodyText": "as discussed, will stick with spec name, and remove the serializer for BLSPublicKey", "author": "rolfyone", "createdAt": "2020-03-09T00:21:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxNzk1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQxODE1OQ==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389418159", "bodyText": "stray comment - is epoch not needed?", "author": "macfarla", "createdAt": "2020-03-08T23:30:12Z", "path": "data/provider/src/test/java/tech/pegasys/artemis/api/ChainDataProviderTest.java", "diffHunk": "@@ -51,9 +53,9 @@\n   private static UnsignedLong slot;\n   private static EventBus localEventBus;\n   private static ChainStorageClient chainStorageClient;\n-\n-  @SuppressWarnings(\"unused\")\n-  private static UnsignedLong epoch;\n+  private final tech.pegasys.artemis.datastructures.blocks.SignedBeaconBlock signedBeaconBlock =\n+      DataStructureUtil.randomSignedBeaconBlock(1, 1);\n+  //  private static UnsignedLong epoch;", "originalCommit": "8c72349ef53bb2567474c0e7eb3dd3a22c4748a1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQyMDg0MQ==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389420841", "bodyText": "myClient??", "author": "macfarla", "createdAt": "2020-03-09T00:02:00Z", "path": "data/provider/src/test/java/tech/pegasys/artemis/api/ChainDataProviderTest.java", "diffHunk": "@@ -174,4 +176,86 @@ public void getGenesisTime_shouldReturnValueIfStoreAvailable() {\n     Optional<UnsignedLong> optionalData = provider.getGenesisTime();\n     assertEquals(genesis, optionalData.get());\n   }\n+\n+  @Test\n+  public void getBlockBySlot_shouldReturnEmptyWhenStoreNotFound()\n+      throws ExecutionException, InterruptedException {\n+    CombinedChainDataClient myClient = mock(CombinedChainDataClient.class);\n+    ChainDataProvider provider = new ChainDataProvider(null, myClient);\n+\n+    SafeFuture<Optional<SignedBeaconBlock>> future = provider.getBlockBySlot(ZERO);\n+    assertTrue(future.get().isEmpty());\n+  }\n+\n+  @Test\n+  public void getBlockBySlot_shouldReturnEmptyWhenSlotNotFound()\n+      throws ExecutionException, InterruptedException {\n+    CombinedChainDataClient myClient = mock(CombinedChainDataClient.class);\n+    ChainDataProvider provider = new ChainDataProvider(chainStorageClient, myClient);\n+\n+    when(myClient.isStoreAvailable()).thenReturn(true);\n+    when(myClient.getBlockBySlot(ZERO)).thenReturn(completedFuture(Optional.empty()));\n+    SafeFuture<Optional<SignedBeaconBlock>> future = provider.getBlockBySlot(ZERO);\n+    assertTrue(future.get().isEmpty());\n+  }\n+\n+  @Test\n+  public void getBlockBySlot_shouldReturnBlockWhenFound()\n+      throws ExecutionException, InterruptedException {\n+    CombinedChainDataClient myClient = mock(CombinedChainDataClient.class);\n+    ChainDataProvider provider = new ChainDataProvider(chainStorageClient, myClient);\n+    SafeFuture<Optional<tech.pegasys.artemis.datastructures.blocks.SignedBeaconBlock>> data =\n+        completedFuture(Optional.of(signedBeaconBlock));\n+\n+    when(myClient.isStoreAvailable()).thenReturn(true);\n+    when(myClient.getBlockBySlot(ZERO)).thenReturn(data);\n+    SafeFuture<Optional<SignedBeaconBlock>> future = provider.getBlockBySlot(ZERO);\n+    verify(myClient).getBlockBySlot(ZERO);\n+\n+    SignedBeaconBlock result = future.get().get();\n+    assertThat(result)\n+        .usingRecursiveComparison()\n+        .isEqualTo(new SignedBeaconBlock(signedBeaconBlock));\n+  }\n+\n+  @Test\n+  public void getBlockByBlockRoot_shouldReturnEmptyWhenStoreNotFound()\n+      throws ExecutionException, InterruptedException {\n+    CombinedChainDataClient myClient = mock(CombinedChainDataClient.class);", "originalCommit": "8c72349ef53bb2567474c0e7eb3dd3a22c4748a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQyMzE5Nw==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389423197", "bodyText": "renamed", "author": "rolfyone", "createdAt": "2020-03-09T00:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQyMDg0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQyMTE0MA==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389421140", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    final Bytes32 blockParam = getParameterValueAsBytes32(queryParamMap, ROOT);\n          \n          \n            \n                    final Bytes32 blockRoot = getParameterValueAsBytes32(queryParamMap, ROOT);", "author": "macfarla", "createdAt": "2020-03-09T00:05:27Z", "path": "data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/beaconhandlers/BeaconBlockHandler.java", "diffHunk": "@@ -66,65 +77,61 @@ public BeaconBlockHandler(\n       responses = {\n         @OpenApiResponse(\n             status = RES_OK,\n-            content = @OpenApiContent(from = BeaconBlockResponse.class)),\n+            content = @OpenApiContent(from = SignedBeaconBlock.class)),\n         @OpenApiResponse(status = RES_BAD_REQUEST, description = \"Invalid parameter supplied\"),\n         @OpenApiResponse(status = RES_NOT_FOUND, description = \"Specified block not found\")\n       })\n   @Override\n   public void handle(final Context ctx) throws Exception {\n     try {\n-      if (ctx.queryParamMap().size() > 1) {\n-        throw new IllegalArgumentException(\n-            \"Too many query parameters specified. Please supply only one.\");\n+      final Map<String, List<String>> queryParamMap = ctx.queryParamMap();\n+      if (queryParamMap.size() < 1) {\n+        throw new IllegalArgumentException(NO_PARAMETERS);\n+      } else if (queryParamMap.size() > 1) {\n+        throw new IllegalArgumentException(TOO_MANY_PARAMETERS);\n       }\n \n-      final Map<String, List<String>> queryParamMap = ctx.queryParamMap();\n-      if (ctx.queryParamMap().containsKey(ROOT)) {\n-        final Bytes32 blockParam =\n-            Bytes32.fromHexString(validateQueryParameter(queryParamMap, ROOT));\n+      if (queryParamMap.containsKey(ROOT)) {\n+        final Bytes32 blockParam = getParameterValueAsBytes32(queryParamMap, ROOT);", "originalCommit": "8c72349ef53bb2567474c0e7eb3dd3a22c4748a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQyMzI0Mg==", "url": "https://github.com/ConsenSys/teku/pull/1310#discussion_r389423242", "bodyText": "will do this as part of bigger commit.", "author": "rolfyone", "createdAt": "2020-03-09T00:30:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQyMTE0MA=="}], "type": "inlineReview"}, {"oid": "c0fdd6cb4557f86ad0c0791c23a1e062853e01a9", "url": "https://github.com/ConsenSys/teku/commit/c0fdd6cb4557f86ad0c0791c23a1e062853e01a9", "message": "changes per review comments.\n\nCan't remove BLSPublicKeySerializer yet, because its used in beacon/state, but i'll clean that up when i do that endpoint.\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-03-09T00:40:48Z", "type": "commit"}, {"oid": "3ebf16700ce64532bc17fc5013b4fdd1fa8d421e", "url": "https://github.com/ConsenSys/teku/commit/3ebf16700ce64532bc17fc5013b4fdd1fa8d421e", "message": "Merge branch 'master' into 1301-beaconBlockHandler", "committedDate": "2020-03-09T01:18:27Z", "type": "commit"}]}