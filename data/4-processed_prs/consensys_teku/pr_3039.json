{"pr_number": 3039, "pr_title": "Add changelog for 0.12.11 release", "pr_createdAt": "2020-10-20T23:54:50Z", "pr_url": "https://github.com/ConsenSys/teku/pull/3039", "timeline": [{"oid": "ce640316d7f3f73fed74c202daab9ef65554d42d", "url": "https://github.com/ConsenSys/teku/commit/ce640316d7f3f73fed74c202daab9ef65554d42d", "message": "Add changelog for 0.12.11.", "committedDate": "2020-10-20T23:39:27Z", "type": "commit"}, {"oid": "4aa28566fba078b99ef69cea371b81476b6682af", "url": "https://github.com/ConsenSys/teku/commit/4aa28566fba078b99ef69cea371b81476b6682af", "message": "Add detail on changes to REST APIs.", "committedDate": "2020-10-20T23:51:43Z", "type": "commit"}, {"oid": "a58d7e7821db923fece1353173bf87234176bfe6", "url": "https://github.com/ConsenSys/teku/commit/a58d7e7821db923fece1353173bf87234176bfe6", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into changelog", "committedDate": "2020-10-20T23:54:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkxMTg4NQ==", "url": "https://github.com/ConsenSys/teku/pull/3039#discussion_r508911885", "bodyText": "is the @ in red because it's invalid?", "author": "rolfyone", "createdAt": "2020-10-21T00:03:16Z", "path": "CHANGELOG.md", "diffHunk": "@@ -5,10 +5,78 @@ we recommend most users use the latest `master` branch of Teku.\n \n ## Upcoming Breaking Changes\n \n-- REST API endpoints will be updated to match emerging standards in a future release.\n+- REST API endpoints will be updated to match emerging standards in a future release. Current replacements:\n+  - GET `/eth/v1/beacon/states/{state_id}/validators/{validator_id}` replaced by POST `/eth/v1/beacon/states/{state_id}/validators/{validator_id}`\n+  - `/network/enr` replaced by `/eth/v1/node/identity`\n+  - `/network/listen_addresses` replaced by `/eth/v1/node/identity`\n+  - `/network/peer_id` replaced by `/eth/v1/node/identity`\n+  - `/network/peers` replaced by `/eth/v1/node/peers`\n+  - `/network/peer_count` replaced by `/eth/v1/node/peers`\n+  - `/network/listen_port` replaced by `/eth/v1/node/identity`\n+  - `/node/fork` replaced by `/eth/v1/beacon/states/{state_id}/fork`\n+  - `/node/genesis_time` replaced by `/eth/v1/beacon/genesis`\n+  - `/node/syncing` replaced by `/eth/v1/node/syncing`\n+  - `/node/version` replaced by `/eth/v1/node/version`\n+  - GET `/validator/attestation` replaced by `/eth/v1/validator/attestation_data`\n+  - POST `/validator/attestation` replaced by `/eth/v1/beacon/pool/attestations`\n+  - GET `/validator/block` replaced by `/eth/v1/validator/blocks/{slot}`\n+  - POST `/validator/block` replaced by `/eth/v1/beacon/blocks`\n+  - `/validator/aggregate_attestation` replaced by `/eth/v1/validator/aggregate_attestation`\n+  - POST `/validator/duties` replaced by POST `/eth/v1/validator/duties/attester/{epoch}` and GET `/eth/v1/validator/duties/proposer/{epoch}`\n+  - `/validator/aggregate_and_proofs` replaced by `/eth/v1/validator/aggregate_and_proofs`\n+  - `/validator/beacon_committee_subscription` replaced by `/eth/v1/validator/beacon_committee_subscriptions`\n+  - `/validator/persistent_subnets_subscription` deprecated. The beacon node now automatically establishes persistent subnet subscriptions based on calls to `/eth/v1/validator/beacon_committee_subscriptions`\n - `--validators-key-files` and `--validators-key-password-files` have been replaced by `--validator-keys`. The old arguments still work but will be removed in a future release.\n - Validator subcommands for generating and registering validators are now deprecated and will be removed in a future release to encourage the use of the Eth2 Launchpad, which is the most secure way of generating keys and sending deposits.\n \n+## 0.12.11\n+\n+### Additions and Improvements\n+- Teku now supports running the validator client as a separate process via the `teku validator-client` subcommand. The in-process validator client is still supported. \n+  \n+  **IMPORTANT**: Ensure validator keys are only passed as arguments to *either* the beacon node or the validator client but never both at the same time.\n+- Migrates to a new directory structure for data storage to provide clear separation between beacon node and validator files. Existing databases will be automatically migrated.\n+- Improved management of states to reduce on-heap memory usage during long periods of non-finalization.\n+- Head update and chain reorg events are no longer published during sync. A single coalesced event is published when sync completes.\n+- Reduced database growth rate during periods of non-finalization. State snapshots are only stored every two epochs instead of each epoch. This can be further adjusted with `--Xhot-state-persistence-frequency`.\n+- New standard REST API endpoints:\n+  - `/eth/v1/beacon/headers/{block_id}`\n+  - `/eth/v1/beacon/states/:state_id/committees/`\n+  - `/eth/v1/beacon/states/:state_id/committees/:epoch`\n+  - `/eth/v1/beacon/states/:state_id/finality_checkpoints`\n+  - `/eth/v1/beacon/states/:state_id/validators`\n+  - `/eth/v1/beacon/states/:state_id/validator_balances`\n+  - `/eth/v1/validator/aggregate_attestation`\n+  - `/eth/v1/validator/aggregate_and_proofs`\n+  - `/eth/v1/validator/beacon_committee_subscriptions`\n+  - `/eth/v1/validator/attestation_data`\n+  - `/eth/v1/beacon/pool/attestations`\n+  - `/eth/v1/beacon/states/:state_id/root`\n+  - `/eth/v1/beacon/blocks`\n+  - `/eth/v1/validator/blocks/{slot}`\n+- `/eth/v1/validator/duties/attester/:epoch` now includes the `committees_at_slot` value.\n+- `/eth/v1/validator/duties/attester/:epoch` now supports using the `POST` method to specify validator IDs, avoiding URL length limits.\n+- The beacon node now automatically manages persistent subnet subscriptions based on the requests to `/eth/v1/validator/beacon_committee_subscriptions` endpoint\n+- Log to the console if the ETH1 node's chain ID doesn't match the expected value from the ETH2 network definition. This alerts users if the ETH1 node is sync'd to the wrong ETH1 network. Thanks to @systemfreund.", "originalCommit": "a58d7e7821db923fece1353173bf87234176bfe6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkxNDgzNQ==", "url": "https://github.com/ConsenSys/teku/pull/3039#discussion_r508914835", "bodyText": "Not sure, expected that to become a link on Github but it didn't happen.  Went with making it literal text instead.", "author": "ajsutton", "createdAt": "2020-10-21T00:13:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkxMTg4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkxMjUwMA==", "url": "https://github.com/ConsenSys/teku/pull/3039#discussion_r508912500", "bodyText": "this doesn't really suggest that we're planning on deleting the old ones soon...\nReplacements have been added, endpoints that have been superseded will be removed in a future release\nNot sure thats a lot better...", "author": "rolfyone", "createdAt": "2020-10-21T00:05:26Z", "path": "CHANGELOG.md", "diffHunk": "@@ -5,10 +5,78 @@ we recommend most users use the latest `master` branch of Teku.\n \n ## Upcoming Breaking Changes\n \n-- REST API endpoints will be updated to match emerging standards in a future release.\n+- REST API endpoints will be updated to match emerging standards in a future release. Current replacements:", "originalCommit": "a58d7e7821db923fece1353173bf87234176bfe6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkxNDczNQ==", "url": "https://github.com/ConsenSys/teku/pull/3039#discussion_r508914735", "bodyText": "Tweaked it a bit.  Still not great but will have to do.", "author": "ajsutton", "createdAt": "2020-10-21T00:13:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkxMjUwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkxMjkyNA==", "url": "https://github.com/ConsenSys/teku/pull/3039#discussion_r508912924", "bodyText": "is there something i should look out for to indicate that i've passed the same key to both, and what is the likely outcome if i get it wrong?", "author": "rolfyone", "createdAt": "2020-10-21T00:07:01Z", "path": "CHANGELOG.md", "diffHunk": "@@ -5,10 +5,78 @@ we recommend most users use the latest `master` branch of Teku.\n \n ## Upcoming Breaking Changes\n \n-- REST API endpoints will be updated to match emerging standards in a future release.\n+- REST API endpoints will be updated to match emerging standards in a future release. Current replacements:\n+  - GET `/eth/v1/beacon/states/{state_id}/validators/{validator_id}` replaced by POST `/eth/v1/beacon/states/{state_id}/validators/{validator_id}`\n+  - `/network/enr` replaced by `/eth/v1/node/identity`\n+  - `/network/listen_addresses` replaced by `/eth/v1/node/identity`\n+  - `/network/peer_id` replaced by `/eth/v1/node/identity`\n+  - `/network/peers` replaced by `/eth/v1/node/peers`\n+  - `/network/peer_count` replaced by `/eth/v1/node/peers`\n+  - `/network/listen_port` replaced by `/eth/v1/node/identity`\n+  - `/node/fork` replaced by `/eth/v1/beacon/states/{state_id}/fork`\n+  - `/node/genesis_time` replaced by `/eth/v1/beacon/genesis`\n+  - `/node/syncing` replaced by `/eth/v1/node/syncing`\n+  - `/node/version` replaced by `/eth/v1/node/version`\n+  - GET `/validator/attestation` replaced by `/eth/v1/validator/attestation_data`\n+  - POST `/validator/attestation` replaced by `/eth/v1/beacon/pool/attestations`\n+  - GET `/validator/block` replaced by `/eth/v1/validator/blocks/{slot}`\n+  - POST `/validator/block` replaced by `/eth/v1/beacon/blocks`\n+  - `/validator/aggregate_attestation` replaced by `/eth/v1/validator/aggregate_attestation`\n+  - POST `/validator/duties` replaced by POST `/eth/v1/validator/duties/attester/{epoch}` and GET `/eth/v1/validator/duties/proposer/{epoch}`\n+  - `/validator/aggregate_and_proofs` replaced by `/eth/v1/validator/aggregate_and_proofs`\n+  - `/validator/beacon_committee_subscription` replaced by `/eth/v1/validator/beacon_committee_subscriptions`\n+  - `/validator/persistent_subnets_subscription` deprecated. The beacon node now automatically establishes persistent subnet subscriptions based on calls to `/eth/v1/validator/beacon_committee_subscriptions`\n - `--validators-key-files` and `--validators-key-password-files` have been replaced by `--validator-keys`. The old arguments still work but will be removed in a future release.\n - Validator subcommands for generating and registering validators are now deprecated and will be removed in a future release to encourage the use of the Eth2 Launchpad, which is the most secure way of generating keys and sending deposits.\n \n+## 0.12.11\n+\n+### Additions and Improvements\n+- Teku now supports running the validator client as a separate process via the `teku validator-client` subcommand. The in-process validator client is still supported. \n+  \n+  **IMPORTANT**: Ensure validator keys are only passed as arguments to *either* the beacon node or the validator client but never both at the same time.", "originalCommit": "a58d7e7821db923fece1353173bf87234176bfe6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkxNDY2Nw==", "url": "https://github.com/ConsenSys/teku/pull/3039#discussion_r508914667", "bodyText": "I think that level of detail is more for the docs.  The main thing is to make people aware that they shouldn't do it. Made it clear that this is to avoid a risk of slashing though.", "author": "ajsutton", "createdAt": "2020-10-21T00:13:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkxMjkyNA=="}], "type": "inlineReview"}, {"oid": "424fd2eed88ef0ea8cc73739cc5292b7c562574e", "url": "https://github.com/ConsenSys/teku/commit/424fd2eed88ef0ea8cc73739cc5292b7c562574e", "message": "Tweak wording.", "committedDate": "2020-10-21T00:12:15Z", "type": "commit"}]}