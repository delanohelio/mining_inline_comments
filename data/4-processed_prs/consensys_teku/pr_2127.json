{"pr_number": 2127, "pr_title": "Make BLS library more fit for general use", "pr_createdAt": "2020-06-11T10:03:16Z", "pr_url": "https://github.com/ConsenSys/teku/pull/2127", "timeline": [{"oid": "8bb02c44e648aaee130f713b705c7fc2d7a585f2", "url": "https://github.com/ConsenSys/teku/commit/8bb02c44e648aaee130f713b705c7fc2d7a585f2", "message": "Make BLS library more fit for general use", "committedDate": "2020-06-11T09:57:47Z", "type": "commit"}, {"oid": "77dc56aad05d22b23b9a8ec7859d70846306ee6f", "url": "https://github.com/ConsenSys/teku/commit/77dc56aad05d22b23b9a8ec7859d70846306ee6f", "message": "Add getter for the G1 point to BLSPublicKey", "committedDate": "2020-06-11T10:35:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzMDU1MQ==", "url": "https://github.com/ConsenSys/teku/pull/2127#discussion_r438830551", "bodyText": "I couldn't find the documentation but I'm assuming BIG.randomnum is exclusive?", "author": "cemozerr", "createdAt": "2020-06-11T14:31:22Z", "path": "bls/src/main/java/tech/pegasys/teku/bls/mikuli/KeyPair.java", "diffHunk": "@@ -36,24 +33,30 @@ public static KeyPair random(final SecureRandom srng) {\n     byte[] b = new byte[128];\n     srng.nextBytes(b);\n     rng.seed(128, b);\n-    Scalar secret = new Scalar(BIG.randomnum(curveOrder, rng));\n+    // secret key must be between 1 and (curveOrder - 1) inclusive\n+    BIG bigSecret = BIG.randomnum(curveOrder.minus(new BIG(1)), rng);", "originalCommit": "77dc56aad05d22b23b9a8ec7859d70846306ee6f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg1NTk3Mw==", "url": "https://github.com/ConsenSys/teku/pull/2127#discussion_r438855973", "bodyText": "Afaics, the BIG.randomnum() method includes 0, but excludes the upper limit (curveOrder here.) in its range of results. My workaround is to subtract one from curveOrder and add one to the result. This is hard to test: we might be waiting around to the end of the universe before it generates a number at the end of the range.", "author": "benjaminion", "createdAt": "2020-06-11T15:07:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzMDU1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2ODUwMw==", "url": "https://github.com/ConsenSys/teku/pull/2127#discussion_r438868503", "bodyText": "Yeah, that made sense to me, assuming that the upper bound is exclusive. LOL about waiting around to the end of the universe :D", "author": "cemozerr", "createdAt": "2020-06-11T15:25:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzMDU1MQ=="}], "type": "inlineReview"}]}