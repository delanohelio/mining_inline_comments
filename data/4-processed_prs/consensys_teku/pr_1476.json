{"pr_number": 1476, "pr_title": "Revert testcontainer file mount in acceptance tests", "pr_createdAt": "2020-03-25T23:32:24Z", "pr_url": "https://github.com/ConsenSys/teku/pull/1476", "timeline": [{"oid": "b6da6b8bf8d0358a42d2c9176c90bc61b3f7c4ba", "url": "https://github.com/ConsenSys/teku/commit/b6da6b8bf8d0358a42d2c9176c90bc61b3f7c4ba", "message": "Revert docker file mount in acceptance tests\n\n -- Revert file mount to obtain yaml keys as this was causing intermittent failure in CI\n -- Modify DepositGeneratecommand to supress warning if dev option is specified\n\nSigned-off-by: Usman Saleem <usman@usmans.info>", "committedDate": "2020-03-25T23:30:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNjY4Ng==", "url": "https://github.com/ConsenSys/teku/pull/1476#discussion_r398236686", "bodyText": "We should only display the confirmation when we're outputting to a console.  So when you run the command with output redirected to a file it should automatically not show the warning (which will corrupt your file).  Not sure if it will help with the docker tests but would definitely be a good thing to do for normal command line users.", "author": "ajsutton", "createdAt": "2020-03-25T23:43:13Z", "path": "artemis/src/main/java/tech/pegasys/artemis/cli/deposit/CommonParams.java", "diffHunk": "@@ -154,6 +154,10 @@ public UnsignedLong getAmount() {\n     return amount;\n   }\n \n+  public boolean isDisplayConfirmation() {\n+    return displayConfirmation;\n+  }", "originalCommit": "b6da6b8bf8d0358a42d2c9176c90bc61b3f7c4ba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNzQ3OA==", "url": "https://github.com/ConsenSys/teku/pull/1476#discussion_r398237478", "bodyText": "yes, we only display confirmation if we are not outputting to a file. I exposed this method so that we can suppress the warning when we are in \"console\" mode so that we don't have to parse the output for acceptance test.", "author": "usmansaleem", "createdAt": "2020-03-25T23:45:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNjY4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI0MjgyOQ==", "url": "https://github.com/ConsenSys/teku/pull/1476#discussion_r398242829", "bodyText": "I think you're misunderstanding.  Even when you're outputting to system out you might be outputting to a file.  e.g.\nteku validator generate > someFile.yaml\nWe can check if System.console() returns null to set the default value (it's not perfect but seems to be the best you can do from plain java).", "author": "ajsutton", "createdAt": "2020-03-26T00:02:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNjY4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI0ODc1Ng==", "url": "https://github.com/ConsenSys/teku/pull/1476#discussion_r398248756", "bodyText": "Ohh ... we are currently throwing error if System.console returned null, I need to slightly re-design the approach.", "author": "usmansaleem", "createdAt": "2020-03-26T00:22:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNjY4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI0OTA3Mg==", "url": "https://github.com/ConsenSys/teku/pull/1476#discussion_r398249072", "bodyText": "we have introduced \"interactive mode\" ... for which we check System.console not to be null.", "author": "usmansaleem", "createdAt": "2020-03-26T00:23:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNjY4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI1MDg4OA==", "url": "https://github.com/ConsenSys/teku/pull/1476#discussion_r398250888", "bodyText": "Console can be null if either stdin or stdout is null :(. We only want to supress if stdout is null :(", "author": "usmansaleem", "createdAt": "2020-03-26T00:30:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNjY4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI1MTI4NQ==", "url": "https://github.com/ConsenSys/teku/pull/1476#discussion_r398251285", "bodyText": "http://hg.openjdk.java.net/jdk8/jdk8/jdk/file/687fd7c7986d/src/solaris/native/java/io/Console_md.c#l36", "author": "usmansaleem", "createdAt": "2020-03-26T00:31:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNjY4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI1MTMyNA==", "url": "https://github.com/ConsenSys/teku/pull/1476#discussion_r398251324", "bodyText": "If stdin is null someone is doing something interesting so you may as well just suppress.  It's better to suppress the message than to accidentally create a corrupt file.", "author": "ajsutton", "createdAt": "2020-03-26T00:32:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNjY4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI2MDAwMw==", "url": "https://github.com/ConsenSys/teku/pull/1476#discussion_r398260003", "bodyText": "In case of stdout redirection we don't print out warnings anymore.", "author": "usmansaleem", "createdAt": "2020-03-26T01:04:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzNjY4Ng=="}], "type": "inlineReview"}, {"oid": "7affee40d1763b6011d5b796568fdc9d31451793", "url": "https://github.com/ConsenSys/teku/commit/7affee40d1763b6011d5b796568fdc9d31451793", "message": "Merge remote-tracking branch 'upstream/master' into fix_unreliable_acceptance_test_docker\n\nSigned-off-by: Usman Saleem <usman@usmans.info>", "committedDate": "2020-03-25T23:54:39Z", "type": "commit"}, {"oid": "b9ca6106e56ec9557346023c0b9a15cb6c2fde27", "url": "https://github.com/ConsenSys/teku/commit/b9ca6106e56ec9557346023c0b9a15cb6c2fde27", "message": "Supress warnings if console is not available\n\nSigned-off-by: Usman Saleem <usman@usmans.info>", "committedDate": "2020-03-26T01:03:27Z", "type": "commit"}, {"oid": "a467ecdc7b2ca0ec216b47e5d51e1c429e2f6f79", "url": "https://github.com/ConsenSys/teku/commit/a467ecdc7b2ca0ec216b47e5d51e1c429e2f6f79", "message": "Merge branch 'master' into fix_unreliable_acceptance_test_docker", "committedDate": "2020-03-26T01:18:29Z", "type": "commit"}]}