{"pr_number": 1362, "pr_title": "Validator duties", "pr_createdAt": "2020-03-11T23:30:14Z", "pr_url": "https://github.com/ConsenSys/teku/pull/1362", "timeline": [{"oid": "b147482038835d751e0bc7f68a25d52543c964cf", "url": "https://github.com/ConsenSys/teku/commit/b147482038835d751e0bc7f68a25d52543c964cf", "message": "first draft\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-10T02:54:51Z", "type": "commit"}, {"oid": "cb3f44c46fe46ca73e67b97b8579f3c2d5cb255e", "url": "https://github.com/ConsenSys/teku/commit/cb3f44c46fe46ca73e67b97b8579f3c2d5cb255e", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into validator-duties", "committedDate": "2020-03-10T03:54:59Z", "type": "commit"}, {"oid": "3ed75ac732ff62ef736656f21a13fe1b8f44c111", "url": "https://github.com/ConsenSys/teku/commit/3ed75ac732ff62ef736656f21a13fe1b8f44c111", "message": "draft of validator data provider\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-10T23:04:32Z", "type": "commit"}, {"oid": "16ea454951fb72b61d177a8583a3fc81063f27bd", "url": "https://github.com/ConsenSys/teku/commit/16ea454951fb72b61d177a8583a3fc81063f27bd", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into validator-duties", "committedDate": "2020-03-10T23:04:41Z", "type": "commit"}, {"oid": "125b8e18c2a7c1042294ed7058a970787ab1413d", "url": "https://github.com/ConsenSys/teku/commit/125b8e18c2a7c1042294ed7058a970787ab1413d", "message": "making a mess\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T03:57:59Z", "type": "commit"}, {"oid": "539ffa94513a79d220dc1672f41f075f88a5ca0a", "url": "https://github.com/ConsenSys/teku/commit/539ffa94513a79d220dc1672f41f075f88a5ca0a", "message": "merge\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T04:04:02Z", "type": "commit"}, {"oid": "414997436e55bc0bb83ed371d7d256819ea7e344", "url": "https://github.com/ConsenSys/teku/commit/414997436e55bc0bb83ed371d7d256819ea7e344", "message": "added ValidatorRequest and BLSPubKeyDeserializer\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T07:42:17Z", "type": "commit"}, {"oid": "bd8e8f0b8b137ede066beb1e3bb2e2949db8492d", "url": "https://github.com/ConsenSys/teku/commit/bd8e8f0b8b137ede066beb1e3bb2e2949db8492d", "message": "messy draft\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T08:51:59Z", "type": "commit"}, {"oid": "1052d4b301bbbc01ecf83918e78035324277b3de", "url": "https://github.com/ConsenSys/teku/commit/1052d4b301bbbc01ecf83918e78035324277b3de", "message": "added tests\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T09:26:30Z", "type": "commit"}, {"oid": "de62e970565787717e34dfff60c655df9ec63415", "url": "https://github.com/ConsenSys/teku/commit/de62e970565787717e34dfff60c655df9ec63415", "message": "merge\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T22:07:09Z", "type": "commit"}, {"oid": "efe17e2b089e88106ce9f8176a048ca49d329ef9", "url": "https://github.com/ConsenSys/teku/commit/efe17e2b089e88106ce9f8176a048ca49d329ef9", "message": "rename to match the new world\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T22:15:14Z", "type": "commit"}, {"oid": "ac96626c6b8a321ab0fed06ecfb4ad14fcf67329", "url": "https://github.com/ConsenSys/teku/commit/ac96626c6b8a321ab0fed06ecfb4ad14fcf67329", "message": "tests for chain provider\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T22:49:12Z", "type": "commit"}, {"oid": "6d33ceea6baa76d14426768cf4be8365408405df", "url": "https://github.com/ConsenSys/teku/commit/6d33ceea6baa76d14426768cf4be8365408405df", "message": "merge\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T23:27:33Z", "type": "commit"}, {"oid": "da962a1bf31cb8c5a4d1292f2e96d3077aab1a60", "url": "https://github.com/ConsenSys/teku/commit/da962a1bf31cb8c5a4d1292f2e96d3077aab1a60", "message": "unneeded dep\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-11T23:29:46Z", "type": "commit"}, {"oid": "a139f24ab8b9df3694ec64e1f1b76669bfbf9bda", "url": "https://github.com/ConsenSys/teku/commit/a139f24ab8b9df3694ec64e1f1b76669bfbf9bda", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into validator-duties", "committedDate": "2020-03-11T23:30:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTMzNzAyMw==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391337023", "bodyText": "We shouldn't need to use MockitoExtension because we're using the static mock method to create mocks.  We shouldn't actually have it even on the class path to force us to be consistent but somehow it snuck in...", "author": "ajsutton", "createdAt": "2020-03-12T00:04:30Z", "path": "data/beaconrestapi/src/test/java/tech/pegasys/artemis/beaconrestapi/handlers/validator/GetValidatorDutiesTest.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.beaconrestapi.handlers.validator;\n+\n+import static javax.servlet.http.HttpServletResponse.SC_NO_CONTENT;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.when;\n+\n+import io.javalin.http.Context;\n+import java.util.Optional;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import tech.pegasys.artemis.api.ChainDataProvider;\n+import tech.pegasys.artemis.provider.JsonProvider;\n+\n+@ExtendWith(MockitoExtension.class)", "originalCommit": "a139f24ab8b9df3694ec64e1f1b76669bfbf9bda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5MTE3Mg==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391391172", "bodyText": "this is the way we currently use @captor - without it that won't work. we can investigate how to fix that, but maybe not in this PR, as it's a pretty common pattern...", "author": "rolfyone", "createdAt": "2020-03-12T04:05:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTMzNzAyMw=="}], "type": "inlineReview"}, {"oid": "a88913d9971d3454779d7dc75c55d77e37564a48", "url": "https://github.com/ConsenSys/teku/commit/a88913d9971d3454779d7dc75c55d77e37564a48", "message": "post\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T01:14:12Z", "type": "commit"}, {"oid": "c3175e675ae76cd0b625bdb4b505a8430decbd7b", "url": "https://github.com/ConsenSys/teku/commit/c3175e675ae76cd0b625bdb4b505a8430decbd7b", "message": "added tests\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T02:42:54Z", "type": "commit"}, {"oid": "4603d5e94b2330a23455ad63ddd19c11f57dbbc8", "url": "https://github.com/ConsenSys/teku/commit/4603d5e94b2330a23455ad63ddd19c11f57dbbc8", "message": "catch json mapping ex\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T03:10:06Z", "type": "commit"}, {"oid": "fb472fa3e69ba49d72de3288990d8ecf0a30ae31", "url": "https://github.com/ConsenSys/teku/commit/fb472fa3e69ba49d72de3288990d8ecf0a30ae31", "message": "cracked the future\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T03:17:41Z", "type": "commit"}, {"oid": "a45ccd505377c05b1e3e1ad71fa229502d93ff21", "url": "https://github.com/ConsenSys/teku/commit/a45ccd505377c05b1e3e1ad71fa229502d93ff21", "message": "post\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T03:20:21Z", "type": "commit"}, {"oid": "b215634a30b75185701455780efb92be0c94bebd", "url": "https://github.com/ConsenSys/teku/commit/b215634a30b75185701455780efb92be0c94bebd", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into validator-duties", "committedDate": "2020-03-12T03:24:10Z", "type": "commit"}, {"oid": "9ef35cd95e2f4677db6ab584c66ec29db1ed8b77", "url": "https://github.com/ConsenSys/teku/commit/9ef35cd95e2f4677db6ab584c66ec29db1ed8b77", "message": "removed unused code\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T03:26:30Z", "type": "commit"}, {"oid": "da251125b0c3c527b5f67146dde904fb83b82345", "url": "https://github.com/ConsenSys/teku/commit/da251125b0c3c527b5f67146dde904fb83b82345", "message": "nullable fields\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T03:56:27Z", "type": "commit"}, {"oid": "b31071ecba8bf6d60ddb75b9e925bb95d574c942", "url": "https://github.com/ConsenSys/teku/commit/b31071ecba8bf6d60ddb75b9e925bb95d574c942", "message": "field names\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T03:59:50Z", "type": "commit"}, {"oid": "49e52b8abc91d6158c0a4093c51c3a5ea659776d", "url": "https://github.com/ConsenSys/teku/commit/49e52b8abc91d6158c0a4093c51c3a5ea659776d", "message": "alpha\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T04:02:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5MDUzOA==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391390538", "bodyText": "nit: it was alphabetic order...", "author": "rolfyone", "createdAt": "2020-03-12T04:02:32Z", "path": "data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/RestApiConstants.java", "diffHunk": "@@ -23,9 +23,9 @@\n   public static final String COMMITTEE_INDEX = \"committee_index\";\n \n   public static final String TAG_BEACON = \"Beacon\";\n+  public static final String TAG_VALIDATOR = \"Validator\";\n   public static final String TAG_NODE = \"Node\";\n   public static final String TAG_NETWORK = \"Network\";\n-  public static final String TAG_VALIDATOR = \"Validator\";", "originalCommit": "9ef35cd95e2f4677db6ab584c66ec29db1ed8b77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5NzU0Mg==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391397542", "bodyText": "fixed", "author": "macfarla", "createdAt": "2020-03-12T04:38:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5MDUzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5MDYxMA==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391390610", "bodyText": "PostValidatorDuties...", "author": "rolfyone", "createdAt": "2020-03-12T04:02:58Z", "path": "data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/handlers/validator/GetValidatorDuties.java", "diffHunk": "@@ -0,0 +1,87 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.beaconrestapi.handlers.validator;\n+\n+import static javax.servlet.http.HttpServletResponse.SC_BAD_REQUEST;\n+import static javax.servlet.http.HttpServletResponse.SC_NO_CONTENT;\n+import static tech.pegasys.artemis.beaconrestapi.CacheControlUtils.CACHE_NONE;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.NO_CONTENT_PRE_GENESIS;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.RES_INTERNAL_ERROR;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.RES_NO_CONTENT;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.RES_OK;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.TAG_VALIDATOR;\n+\n+import com.fasterxml.jackson.databind.JsonMappingException;\n+import io.javalin.core.util.Header;\n+import io.javalin.http.Context;\n+import io.javalin.http.Handler;\n+import io.javalin.plugin.openapi.annotations.HttpMethod;\n+import io.javalin.plugin.openapi.annotations.OpenApi;\n+import io.javalin.plugin.openapi.annotations.OpenApiContent;\n+import io.javalin.plugin.openapi.annotations.OpenApiRequestBody;\n+import io.javalin.plugin.openapi.annotations.OpenApiResponse;\n+import java.util.List;\n+import tech.pegasys.artemis.api.ChainDataProvider;\n+import tech.pegasys.artemis.api.schema.ValidatorDuties;\n+import tech.pegasys.artemis.api.schema.ValidatorsRequest;\n+import tech.pegasys.artemis.beaconrestapi.schema.BadRequest;\n+import tech.pegasys.artemis.provider.JsonProvider;\n+import tech.pegasys.artemis.util.async.SafeFuture;\n+\n+public class GetValidatorDuties implements Handler {", "originalCommit": "9ef35cd95e2f4677db6ab584c66ec29db1ed8b77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5Nzk3NQ==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391397975", "bodyText": "fixed", "author": "macfarla", "createdAt": "2020-03-12T04:41:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5MDYxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5MDc5Nw==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391390797", "bodyText": "you can add a description here that can be handy:\ndescription = \"```\\n{\\n  \\\"epoch\\\": (uint64),\\n  \\\"pubkeys\\\": [(Bytes48 as Hex String)]\\n}\\n```\"", "author": "rolfyone", "createdAt": "2020-03-12T04:04:00Z", "path": "data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/handlers/validator/GetValidatorDuties.java", "diffHunk": "@@ -0,0 +1,87 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.beaconrestapi.handlers.validator;\n+\n+import static javax.servlet.http.HttpServletResponse.SC_BAD_REQUEST;\n+import static javax.servlet.http.HttpServletResponse.SC_NO_CONTENT;\n+import static tech.pegasys.artemis.beaconrestapi.CacheControlUtils.CACHE_NONE;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.NO_CONTENT_PRE_GENESIS;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.RES_INTERNAL_ERROR;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.RES_NO_CONTENT;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.RES_OK;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.TAG_VALIDATOR;\n+\n+import com.fasterxml.jackson.databind.JsonMappingException;\n+import io.javalin.core.util.Header;\n+import io.javalin.http.Context;\n+import io.javalin.http.Handler;\n+import io.javalin.plugin.openapi.annotations.HttpMethod;\n+import io.javalin.plugin.openapi.annotations.OpenApi;\n+import io.javalin.plugin.openapi.annotations.OpenApiContent;\n+import io.javalin.plugin.openapi.annotations.OpenApiRequestBody;\n+import io.javalin.plugin.openapi.annotations.OpenApiResponse;\n+import java.util.List;\n+import tech.pegasys.artemis.api.ChainDataProvider;\n+import tech.pegasys.artemis.api.schema.ValidatorDuties;\n+import tech.pegasys.artemis.api.schema.ValidatorsRequest;\n+import tech.pegasys.artemis.beaconrestapi.schema.BadRequest;\n+import tech.pegasys.artemis.provider.JsonProvider;\n+import tech.pegasys.artemis.util.async.SafeFuture;\n+\n+public class GetValidatorDuties implements Handler {\n+  private final ChainDataProvider provider;\n+\n+  public GetValidatorDuties(final ChainDataProvider provider, final JsonProvider jsonProvider) {\n+    this.provider = provider;\n+    this.jsonProvider = jsonProvider;\n+  }\n+\n+  public static final String ROUTE = \"/validator/duties\";\n+  private final JsonProvider jsonProvider;\n+\n+  @OpenApi(\n+      path = ROUTE,\n+      method = HttpMethod.POST,\n+      summary = \"Returns validator duties that match the specified query.\",\n+      tags = {TAG_VALIDATOR},\n+      description = \"Returns validator duties for the given epoch.\",\n+      requestBody = @OpenApiRequestBody(content = @OpenApiContent(from = ValidatorsRequest.class)),", "originalCommit": "9ef35cd95e2f4677db6ab584c66ec29db1ed8b77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5ODM4MA==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391398380", "bodyText": "done", "author": "macfarla", "createdAt": "2020-03-12T04:43:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5MDc5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5MDg2MA==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391390860", "bodyText": "add bad_request", "author": "rolfyone", "createdAt": "2020-03-12T04:04:20Z", "path": "data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/handlers/validator/GetValidatorDuties.java", "diffHunk": "@@ -0,0 +1,87 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.beaconrestapi.handlers.validator;\n+\n+import static javax.servlet.http.HttpServletResponse.SC_BAD_REQUEST;\n+import static javax.servlet.http.HttpServletResponse.SC_NO_CONTENT;\n+import static tech.pegasys.artemis.beaconrestapi.CacheControlUtils.CACHE_NONE;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.NO_CONTENT_PRE_GENESIS;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.RES_INTERNAL_ERROR;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.RES_NO_CONTENT;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.RES_OK;\n+import static tech.pegasys.artemis.beaconrestapi.RestApiConstants.TAG_VALIDATOR;\n+\n+import com.fasterxml.jackson.databind.JsonMappingException;\n+import io.javalin.core.util.Header;\n+import io.javalin.http.Context;\n+import io.javalin.http.Handler;\n+import io.javalin.plugin.openapi.annotations.HttpMethod;\n+import io.javalin.plugin.openapi.annotations.OpenApi;\n+import io.javalin.plugin.openapi.annotations.OpenApiContent;\n+import io.javalin.plugin.openapi.annotations.OpenApiRequestBody;\n+import io.javalin.plugin.openapi.annotations.OpenApiResponse;\n+import java.util.List;\n+import tech.pegasys.artemis.api.ChainDataProvider;\n+import tech.pegasys.artemis.api.schema.ValidatorDuties;\n+import tech.pegasys.artemis.api.schema.ValidatorsRequest;\n+import tech.pegasys.artemis.beaconrestapi.schema.BadRequest;\n+import tech.pegasys.artemis.provider.JsonProvider;\n+import tech.pegasys.artemis.util.async.SafeFuture;\n+\n+public class GetValidatorDuties implements Handler {\n+  private final ChainDataProvider provider;\n+\n+  public GetValidatorDuties(final ChainDataProvider provider, final JsonProvider jsonProvider) {\n+    this.provider = provider;\n+    this.jsonProvider = jsonProvider;\n+  }\n+\n+  public static final String ROUTE = \"/validator/duties\";\n+  private final JsonProvider jsonProvider;\n+\n+  @OpenApi(\n+      path = ROUTE,\n+      method = HttpMethod.POST,\n+      summary = \"Returns validator duties that match the specified query.\",\n+      tags = {TAG_VALIDATOR},\n+      description = \"Returns validator duties for the given epoch.\",\n+      requestBody = @OpenApiRequestBody(content = @OpenApiContent(from = ValidatorsRequest.class)),\n+      responses = {\n+        @OpenApiResponse(status = RES_OK, content = @OpenApiContent(from = ValidatorDuties.class)),\n+        @OpenApiResponse(status = RES_NO_CONTENT, description = NO_CONTENT_PRE_GENESIS),\n+        @OpenApiResponse(status = RES_INTERNAL_ERROR)", "originalCommit": "9ef35cd95e2f4677db6ab584c66ec29db1ed8b77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5ODIzOQ==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391398239", "bodyText": "done", "author": "macfarla", "createdAt": "2020-03-12T04:42:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM5MDg2MA=="}], "type": "inlineReview"}, {"oid": "aa899b826563251644b9682e6329f86a7aeaf21b", "url": "https://github.com/ConsenSys/teku/commit/aa899b826563251644b9682e6329f86a7aeaf21b", "message": "Tests\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T04:37:42Z", "type": "commit"}, {"oid": "76d707d15e71177c1a0676c90a4c1cfe37786f4b", "url": "https://github.com/ConsenSys/teku/commit/76d707d15e71177c1a0676c90a4c1cfe37786f4b", "message": "PR review\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T04:44:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwMDIwNQ==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391400205", "bodyText": "int: I'm thinking it might be better to group the POSTs down the bottom initially, potentially at some point we might break them into separate setup functions...", "author": "rolfyone", "createdAt": "2020-03-12T04:51:20Z", "path": "data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/BeaconRestApi.java", "diffHunk": "@@ -122,6 +123,7 @@ private void addBeaconHandlers(final DataProvider dataProvider) {\n \n   private void addValidatorHandlers(DataProvider dataProvider) {\n     ChainDataProvider provider = dataProvider.getChainDataProvider();\n+    app.post(PostValidatorDuties.ROUTE, new PostValidatorDuties(provider, jsonProvider));", "originalCommit": "76d707d15e71177c1a0676c90a4c1cfe37786f4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwMDk0Nw==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391400947", "bodyText": "do you want a new method or just put it at the bottom of the list?", "author": "macfarla", "createdAt": "2020-03-12T04:54:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwMDIwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwMTk1OA==", "url": "https://github.com/ConsenSys/teku/pull/1362#discussion_r391401958", "bodyText": "done", "author": "macfarla", "createdAt": "2020-03-12T04:59:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwMDIwNQ=="}], "type": "inlineReview"}, {"oid": "6e6d974933c2483930c700197e0feb6f558d47df", "url": "https://github.com/ConsenSys/teku/commit/6e6d974933c2483930c700197e0feb6f558d47df", "message": "formatting\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>", "committedDate": "2020-03-12T04:57:02Z", "type": "commit"}]}