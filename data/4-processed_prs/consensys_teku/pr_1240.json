{"pr_number": 1240, "pr_title": "Improve rpc logging, only close outgoing rpc stream once", "pr_createdAt": "2020-02-27T17:44:35Z", "pr_url": "https://github.com/ConsenSys/teku/pull/1240", "timeline": [{"oid": "d027850583803258ea0efbea64d581d2c7243ac4", "url": "https://github.com/ConsenSys/teku/commit/d027850583803258ea0efbea64d581d2c7243ac4", "message": "Improve rpc logging, only close outgoing rpc stream once", "committedDate": "2020-02-27T17:34:15Z", "type": "commit"}, {"oid": "405e50ef04318a6e2e3590a42aef84798132b70f", "url": "https://github.com/ConsenSys/teku/commit/405e50ef04318a6e2e3590a42aef84798132b70f", "message": "Merge branch 'master' into minor/improve-rpc-logs", "committedDate": "2020-02-27T17:44:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNjI5Nw==", "url": "https://github.com/ConsenSys/teku/pull/1240#discussion_r385316297", "bodyText": "Why use compare and set here instead of just setting is closed to true?", "author": "cemozerr", "createdAt": "2020-02-27T19:14:29Z", "path": "networking/eth2/src/main/java/tech/pegasys/artemis/networking/eth2/rpc/core/Eth2OutgoingRequestHandler.java", "diffHunk": "@@ -135,6 +140,9 @@ private void completeRequest(final RpcStream rpcStream) {\n   }\n \n   private void cancelRequest(final RpcStream rpcStream, Throwable error) {\n+    if (!isClosed.compareAndSet(false, true)) {", "originalCommit": "405e50ef04318a6e2e3590a42aef84798132b70f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMyMDgxNA==", "url": "https://github.com/ConsenSys/teku/pull/1240#discussion_r385320814", "bodyText": "This ensures that we only run the closing code once.  If isClosed is already true, we'll exit early.", "author": "mbaxter", "createdAt": "2020-02-27T19:23:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNjI5Nw=="}], "type": "inlineReview"}]}