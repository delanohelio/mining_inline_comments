{"pr_number": 2696, "pr_title": "Check gossip message size by ByteBuf.readableBytes() instead of ByteBuf.capacity()", "pr_createdAt": "2020-08-31T14:41:06Z", "pr_url": "https://github.com/ConsenSys/teku/pull/2696", "timeline": [{"oid": "9c407151a321fc354524228e72bbeab8a2dc92a5", "url": "https://github.com/ConsenSys/teku/commit/9c407151a321fc354524228e72bbeab8a2dc92a5", "message": "Check gossip message size by ByteBuf.readableBytes() instead of ByteBuf.capacity()", "committedDate": "2020-08-31T14:37:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE4OTA1NA==", "url": "https://github.com/ConsenSys/teku/pull/2696#discussion_r480189054", "bodyText": "Might be worth adding a test for this.", "author": "mbaxter", "createdAt": "2020-08-31T14:59:54Z", "path": "networking/p2p/src/main/java/tech/pegasys/teku/networking/p2p/libp2p/gossip/GossipHandler.java", "diffHunk": "@@ -54,7 +54,7 @@ public GossipHandler(\n \n   @Override\n   public SafeFuture<ValidationResult> apply(final MessageApi message) {\n-    final int messageSize = message.getData().capacity();\n+    final int messageSize = message.getData().readableBytes();", "originalCommit": "9c407151a321fc354524228e72bbeab8a2dc92a5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "28131e6d3f8ef907aa4cbd16afe5b7b4c77c33a9", "url": "https://github.com/ConsenSys/teku/commit/28131e6d3f8ef907aa4cbd16afe5b7b4c77c33a9", "message": "Add testcase when buffer capacity is larger then max message size while the readable bytes fit the max size", "committedDate": "2020-08-31T15:09:58Z", "type": "commit"}, {"oid": "abf19dc873f2e8ece727eb3f14169532c80b495a", "url": "https://github.com/ConsenSys/teku/commit/abf19dc873f2e8ece727eb3f14169532c80b495a", "message": "Apply spotless", "committedDate": "2020-08-31T15:33:13Z", "type": "commit"}]}