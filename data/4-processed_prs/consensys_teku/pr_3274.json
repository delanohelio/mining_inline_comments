{"pr_number": 3274, "pr_title": "Exit cleanly if remote host is not available for voluntary exit.", "pr_createdAt": "2020-11-22T20:59:13Z", "pr_url": "https://github.com/ConsenSys/teku/pull/3274", "timeline": [{"oid": "1e159fe53421e97939adb6b0d92a6e4c5193f7fa", "url": "https://github.com/ConsenSys/teku/commit/1e159fe53421e97939adb6b0d92a6e4c5193f7fa", "message": "Exit cleanly if remote host is not available for voluntary exit.\n\nFixes #3272\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-11-22T20:58:00Z", "type": "commit"}, {"oid": "dc1a2bfd54bfc55b2dee9f47bbc601af13ebc28b", "url": "https://github.com/ConsenSys/teku/commit/dc1a2bfd54bfc55b2dee9f47bbc601af13ebc28b", "message": "Merge remote-tracking branch 'upstream/master' into 3272", "committedDate": "2020-11-22T20:59:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQwNzcwOQ==", "url": "https://github.com/ConsenSys/teku/pull/3274#discussion_r528407709", "bodyText": "Would be good to avoid the duplication in this try catch.  Given it's a RuntimeException I wonder if we can just catch it higher up instead of in these private methods and handle it in one place?\nWould also be kind of nice if the api client threw UncheckedIOException instead of RuntimeException so we don't have to catch something so generic.", "author": "ajsutton", "createdAt": "2020-11-22T21:32:11Z", "path": "teku/src/main/java/tech/pegasys/teku/cli/subcommand/VoluntaryExitCommand.java", "diffHunk": "@@ -149,15 +153,31 @@ private void submitExitForValidator(final BLSPublicKey publicKey, final Integer\n   }\n \n   private Optional<Bytes32> getGenesisRoot() {\n-    return apiClient.getGenesis().map(response -> response.getData().getGenesisValidatorsRoot());\n+    try {\n+      return apiClient.getGenesis().map(response -> response.getData().getGenesisValidatorsRoot());\n+    } catch (RuntimeException ex) {\n+      if (Throwables.getRootCause(ex) instanceof ConnectException) {\n+        SUB_COMMAND_LOG.error(getFailedToConnectMessage());\n+        System.exit(1);\n+      }\n+    }", "originalCommit": "dc1a2bfd54bfc55b2dee9f47bbc601af13ebc28b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dfec3f0d26e270ac17f3c078b63a2e9b7c8a9ae1", "url": "https://github.com/ConsenSys/teku/commit/dfec3f0d26e270ac17f3c078b63a2e9b7c8a9ae1", "message": "Merge remote-tracking branch 'upstream/master' into 3272", "committedDate": "2020-11-22T21:39:07Z", "type": "commit"}, {"oid": "7412024365c40bdc5c0f770e89486ec38a9a722a", "url": "https://github.com/ConsenSys/teku/commit/7412024365c40bdc5c0f770e89486ec38a9a722a", "message": "review feedback\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-11-22T22:00:09Z", "type": "commit"}]}