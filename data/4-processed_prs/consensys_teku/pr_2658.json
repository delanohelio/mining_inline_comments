{"pr_number": 2658, "pr_title": "Fix exit code when confirmation is rejected for validator register command", "pr_createdAt": "2020-08-26T09:53:25Z", "pr_url": "https://github.com/ConsenSys/teku/pull/2658", "timeline": [{"oid": "453258464c48167b3cd64d4ef0aa80089700b4ee", "url": "https://github.com/ConsenSys/teku/commit/453258464c48167b3cd64d4ef0aa80089700b4ee", "message": "Return non-zero exit code when confirmation rejected for validator register", "committedDate": "2020-08-26T09:51:55Z", "type": "commit"}, {"oid": "0e79b3924a938055a93875b1aafc868d08b5b41b", "url": "https://github.com/ConsenSys/teku/commit/0e79b3924a938055a93875b1aafc868d08b5b41b", "message": "Run spotless", "committedDate": "2020-08-26T09:55:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzU1MDM3NA==", "url": "https://github.com/ConsenSys/teku/pull/2658#discussion_r477550374", "bodyText": "is this the only case we needed to change? I know this was the concrete example given in the ticket, but if the transaction fails to submit somehow, like the eth1 node didn't respond or something i guess? Insufficient credit to consume maybe?", "author": "rolfyone", "createdAt": "2020-08-26T19:50:58Z", "path": "teku/src/main/java/tech/pegasys/teku/cli/deposit/RegisterAction.java", "diffHunk": "@@ -114,7 +114,7 @@ public void displayConfirmation(final int totalNumberOfDeposits) {\n       return;\n     }\n     System.out.println(\"Transaction cancelled.\");\n-    shutdownFunction.accept(0);\n+    shutdownFunction.accept(1);", "originalCommit": "0e79b3924a938055a93875b1aafc868d08b5b41b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODI4NTI4MQ==", "url": "https://github.com/ConsenSys/teku/pull/2658#discussion_r478285281", "bodyText": "That case is already covered here in DepositRegisterCommand.java:\n  @Override\n  public void run() {\n    final BLSKeyPair validatorKey = getValidatorKey();\n\n    try (final RegisterAction registerAction =\n        registerParams.createRegisterAction(verboseOutputParam.isVerboseOutputEnabled())) {\n      registerAction.displayConfirmation(1);\n      registerAction.sendDeposit(validatorKey).get();\n    } catch (final Throwable t) {\n      SUB_COMMAND_LOG.sendDepositFailure(t);\n      shutdownFunction.accept(1);\n    }\n    shutdownFunction.accept(0);\n  }", "author": "cemozerr", "createdAt": "2020-08-27T09:32:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzU1MDM3NA=="}], "type": "inlineReview"}, {"oid": "0b82c66c1672e863e70efde8df7704a07f708333", "url": "https://github.com/ConsenSys/teku/commit/0b82c66c1672e863e70efde8df7704a07f708333", "message": "Merge branch 'master' into returnNonZeroWhenRegisterCommandNotConfirmed", "committedDate": "2020-08-26T23:25:50Z", "type": "commit"}]}