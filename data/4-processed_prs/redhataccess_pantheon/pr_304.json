{"pr_number": 304, "pr_title": "uploader validation QA comments", "pr_createdAt": "2020-06-01T14:51:32Z", "pr_url": "https://github.com/redhataccess/pantheon/pull/304", "timeline": [{"oid": "b6c7cbff71fd056479422b85c965789c9bd94e60", "url": "https://github.com/redhataccess/pantheon/commit/b6c7cbff71fd056479422b85c965789c9bd94e60", "message": "uploader validation QA comments", "committedDate": "2020-06-01T14:47:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMzNDM0Ng==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433334346", "bodyText": "Do we need update the jcr:lastModified timestamp. My understanding is that sling populates for us by default", "author": "xdavidson", "createdAt": "2020-06-01T16:03:51Z", "path": "uploader/pantheon.py", "diffHunk": "@@ -299,22 +300,26 @@ def process_workspace(path):\n     logger.debug('url: %s', url)\n     workspace = {}\n     workspace['jcr:primaryType'] = 'pant:workspace'\n+    workspace['jcr:lastModified'] = datetime.now().strftime(\"%Y-%m-%dT%H:%m:%S\") #SimpleDateFormat:yyyy-MM-dd'T'HH:mm:ss", "originalCommit": "b6c7cbff71fd056479422b85c965789c9bd94e60", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzM3MjI2Ng==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433372266", "bodyText": "I see there might be a reason we need update the jcr:lastModified timestamp where same repo is re-uploaded with modifications. the timestamp you populated here is based off the timezone on the client size. On the serverside the time is UTC based. If you have to generate the modified timestamp on the client side, you should ensure it's utc time.", "author": "xdavidson", "createdAt": "2020-06-01T17:14:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMzNDM0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU5MjgwMw==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433592803", "bodyText": "Added changes to convert localtime to UTC in latest commit", "author": "rednitish", "createdAt": "2020-06-02T02:53:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMzNDM0Ng=="}], "type": "inlineReview"}, {"oid": "ca441c48e8e43b63899698905566e4a03933f653", "url": "https://github.com/redhataccess/pantheon/commit/ca441c48e8e43b63899698905566e4a03933f653", "message": "CCS-3600 validation related to changes in JCR syntax, ist to utc", "committedDate": "2020-06-02T02:51:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1NTI0NQ==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433655245", "bodyText": "Hey Nitish, can you confirm if \"yyyy-MM-dd\" is the format same as that being used consistently in the Pantheon App?", "author": "anknite", "createdAt": "2020-06-02T06:48:04Z", "path": "uploader/pantheon.py", "diffHunk": "@@ -299,22 +301,26 @@ def process_workspace(path):\n     logger.debug('url: %s', url)\n     workspace = {}\n     workspace['jcr:primaryType'] = 'pant:workspace'\n+    workspace['jcr:lastModified'] = datetime.now().utcnow().strftime(\"%Y-%m-%dT%H:%m:%S\") #SimpleDateFormat:yyyy-MM-dd'T'HH:mm:ss", "originalCommit": "ca441c48e8e43b63899698905566e4a03933f653", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc4MDMwMg==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433780302", "bodyText": "Yes @anknite  it's the same.:)", "author": "rednitish", "createdAt": "2020-06-02T10:36:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1NTI0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1Njk3Ng==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433656976", "bodyText": "There seems to be a warning here, nothing major just a uniformity check for new line I guess. Could you please add it.", "author": "anknite", "createdAt": "2020-06-02T06:51:56Z", "path": "uploader/pantheon.py", "diffHunk": "@@ -483,5 +493,6 @@ def process_attributes_as_resources(variants):\n         _warn(f'{leftoverFiles} additional files detected but not uploaded. Only files specified in '\n               + CONFIG_FILE\n               + ' are handled for upload.')\n-\n+else:\n+    sys.exit('Modules and resources not found, please check yaml syntax')\n print('Finished!')", "originalCommit": "ca441c48e8e43b63899698905566e4a03933f653", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc4MzY0OA==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433783648", "bodyText": "added new line at the end of script for uniformity", "author": "rednitish", "createdAt": "2020-06-02T10:43:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1Njk3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1ODg2Ng==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433658866", "bodyText": "I see that cannonicalPresent is being initialized to False and not being used further. Is there a reason this was left off?", "author": "anknite", "createdAt": "2020-06-02T06:56:20Z", "path": "uploader/pantheon.py", "diffHunk": "@@ -299,22 +301,26 @@ def process_workspace(path):\n     logger.debug('url: %s', url)\n     workspace = {}\n     workspace['jcr:primaryType'] = 'pant:workspace'\n+    workspace['jcr:lastModified'] = datetime.now().utcnow().strftime(\"%Y-%m-%dT%H:%m:%S\") #SimpleDateFormat:yyyy-MM-dd'T'HH:mm:ss\n     # Process variants. variants is a list of dictionaries\n \n     data = {}\n+    cannonicalPresent = False", "originalCommit": "ca441c48e8e43b63899698905566e4a03933f653", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc4MzA0NQ==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433783045", "bodyText": "answered below", "author": "rednitish", "createdAt": "2020-06-02T10:41:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1ODg2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1OTM0NQ==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433659345", "bodyText": "Similar to my earlier comment cannonicalPresent is now 'true' however its not being used. Am I missing something?", "author": "anknite", "createdAt": "2020-06-02T06:57:20Z", "path": "uploader/pantheon.py", "diffHunk": "@@ -299,22 +301,26 @@ def process_workspace(path):\n     logger.debug('url: %s', url)\n     workspace = {}\n     workspace['jcr:primaryType'] = 'pant:workspace'\n+    workspace['jcr:lastModified'] = datetime.now().utcnow().strftime(\"%Y-%m-%dT%H:%m:%S\") #SimpleDateFormat:yyyy-MM-dd'T'HH:mm:ss\n     # Process variants. variants is a list of dictionaries\n \n     data = {}\n+    cannonicalPresent = False\n     if variants:\n         validateVariants()\n         for variant in variants:\n             # Each variant is of type dictionary. Rename the keys to match ModuleVariantDefinition\n             module_variants = {}\n+            module_variants['pant:canonical'] = 'false'\n             for key, value in variant.items():\n                 if key.lower() == 'name':\n                     module_variants['pant:name'] = value\n                 if key.lower() == 'path':\n                     module_variants['pant:attributesFilePath'] = value\n                 if key.lower() == 'canonical':\n                     module_variants['pant:canonical'] = value\n-            if 'pant:canonical' not in module_variants:\n+                    cannonicalPresent = 'true'", "originalCommit": "ca441c48e8e43b63899698905566e4a03933f653", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc4Mjg4Ng==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433782886", "bodyText": "Good catch, cannonicalPresent was used earlier code , this PR eliminated cannonicalPresent. we can remove it.", "author": "rednitish", "createdAt": "2020-06-02T10:41:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1OTM0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY2MDYyOQ==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433660629", "bodyText": "Should we be adding a warning/error message if 'canonical' not in variant\nessentially an else of this if", "author": "anknite", "createdAt": "2020-06-02T07:00:14Z", "path": "uploader/pantheon.py", "diffHunk": "@@ -338,8 +344,11 @@ def validateVariants():\n             sys.exit(\"Variant (name) missing, please correct variant name \")\n         if 'path' not in variant or  variant['path'] is None:  # path is mandatory for variant, throw errors in case of missing\n             sys.exit(\"Variant (path) missing, please correct variant path \")\n-        if 'canonical' in variant and variant['canonical'] is not None:\n-            isCannonicalList.append(variant['canonical'])\n+        if 'canonical' in variant:", "originalCommit": "ca441c48e8e43b63899698905566e4a03933f653", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc4MjE3OQ==", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433782179", "bodyText": "It shouldn't be the case as in a single variant case, cannonical is optional.", "author": "rednitish", "createdAt": "2020-06-02T10:40:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY2MDYyOQ=="}], "type": "inlineReview"}, {"oid": "ab0dc0fb3d0d681ddbb127932d8cc240e291c5be", "url": "https://github.com/redhataccess/pantheon/commit/ab0dc0fb3d0d681ddbb127932d8cc240e291c5be", "message": "CCS-3600 validation related to changes in JCR syntax, ankit reviews", "committedDate": "2020-06-02T10:43:49Z", "type": "commit"}, {"oid": "c2683ec505561520959b788e9720726831997b34", "url": "https://github.com/redhataccess/pantheon/commit/c2683ec505561520959b788e9720726831997b34", "message": "CCS-3600 validation related to changes in JCR syntax, ankit reviews", "committedDate": "2020-06-02T10:46:54Z", "type": "commit"}, {"oid": "213bd7e42b2c2024854a9764274754b2fd8f287e", "url": "https://github.com/redhataccess/pantheon/commit/213bd7e42b2c2024854a9764274754b2fd8f287e", "message": "CCS-3600 validation related to changes in JCR syntax, ankit reviews", "committedDate": "2020-06-02T10:48:54Z", "type": "commit"}]}