{"pr_number": 717, "pr_title": "Config fetch", "pr_createdAt": "2020-04-09T20:27:20Z", "pr_url": "https://github.com/senx/warp10-platform/pull/717", "timeline": [{"oid": "132e45deed12a4a5fd76d2b76241c9dd29a072d6", "url": "https://github.com/senx/warp10-platform/commit/132e45deed12a4a5fd76d2b76241c9dd29a072d6", "message": "Changed config fetch by launching JVM once instead of 3 times", "committedDate": "2020-04-09T20:23:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE1Njg5NA==", "url": "https://github.com/senx/warp10-platform/pull/717#discussion_r408156894", "bodyText": "Should be ^leveldb\\.home=.", "author": "ftence", "createdAt": "2020-04-14T13:57:26Z", "path": "warp10/src/main/sh/warp10-standalone.sh", "diffHunk": "@@ -388,15 +388,21 @@ start() {\n   getConfigFiles\n \n   #\n-  # Config file exists ?\n+  # Config file exists?\n   #\n   if [[ -z \"${CONFIG_FILES}\" ]]; then\n     echo \"Config file does not exist - Use 'bootstrap' command before the very first launch (it must be run as root)\"\n     echo \"WARNING: Since version 2.1.0, Warp 10 can use multiple configuration files. The files have to be present in ${WARP10_CONFIG_DIR}\"\n     exit 1\n   fi\n \n-  LEVELDB_HOME=\"`${JAVACMD} -Xms64m -Xmx64m -XX:+UseG1GC -cp ${WARP10_CP} io.warp10.WarpConfig ${CONFIG_FILES} 'leveldb.home' | grep 'leveldb.home' | sed -e 's/^.*=//'`\"\n+  //\n+  // Extract configuration keys\n+  //\n+\n+  CONFIG_KEYS=$(${JAVACMD} -Xms64m -Xmx64m -XX:+UseG1GC -cp ${WARP10_CP} io.warp10.WarpConfig ${CONFIG_FILES} . 'leveldb.home' 'standalone.host' 'standalone.port'|grep -e '^@CONF@ '|sed -e 's/^@CONF@ //')\n+\n+  LEVELDB_HOME=\"$(echo \"${CONFIG_KEYS}\"|grep -e '^leveldb.home='| sed -e 's/^.*=//')\"", "originalCommit": "132e45deed12a4a5fd76d2b76241c9dd29a072d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE1NzE3NA==", "url": "https://github.com/senx/warp10-platform/pull/717#discussion_r408157174", "bodyText": "^standalone\\.host=", "author": "ftence", "createdAt": "2020-04-14T13:57:48Z", "path": "warp10/src/main/sh/warp10-standalone.sh", "diffHunk": "@@ -417,8 +423,8 @@ start() {\n     ${JAVACMD} ${JAVA_OPTS} -cp ${WARP10_CP} ${WARP10_INIT} ${LEVELDB_HOME} >> ${WARP10_HOME}/logs/warp10.log 2>&1\n   fi\n \n-  WARP10_LISTENSTO_HOST=\"`${JAVACMD} -Xms64m -Xmx64m -XX:+UseG1GC -cp ${WARP10_CP} io.warp10.WarpConfig ${CONFIG_FILES} 'standalone.host' | grep 'standalone.host' | sed -e 's/^.*=//'`\"\n-  WARP10_LISTENSTO_PORT=\"`${JAVACMD} -Xms64m -Xmx64m -XX:+UseG1GC -cp ${WARP10_CP} io.warp10.WarpConfig ${CONFIG_FILES} 'standalone.port' | grep 'standalone.port' | sed -e 's/^.*=//'`\"\n+  WARP10_LISTENSTO_HOST=\"$(echo \"${CONFIG_KEYS}\"|grep -e '^standalone.host='| sed -e 's/^.*=//')\"", "originalCommit": "132e45deed12a4a5fd76d2b76241c9dd29a072d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE1NzM0Mw==", "url": "https://github.com/senx/warp10-platform/pull/717#discussion_r408157343", "bodyText": "^standalone\\.port=", "author": "ftence", "createdAt": "2020-04-14T13:58:04Z", "path": "warp10/src/main/sh/warp10-standalone.sh", "diffHunk": "@@ -417,8 +423,8 @@ start() {\n     ${JAVACMD} ${JAVA_OPTS} -cp ${WARP10_CP} ${WARP10_INIT} ${LEVELDB_HOME} >> ${WARP10_HOME}/logs/warp10.log 2>&1\n   fi\n \n-  WARP10_LISTENSTO_HOST=\"`${JAVACMD} -Xms64m -Xmx64m -XX:+UseG1GC -cp ${WARP10_CP} io.warp10.WarpConfig ${CONFIG_FILES} 'standalone.host' | grep 'standalone.host' | sed -e 's/^.*=//'`\"\n-  WARP10_LISTENSTO_PORT=\"`${JAVACMD} -Xms64m -Xmx64m -XX:+UseG1GC -cp ${WARP10_CP} io.warp10.WarpConfig ${CONFIG_FILES} 'standalone.port' | grep 'standalone.port' | sed -e 's/^.*=//'`\"\n+  WARP10_LISTENSTO_HOST=\"$(echo \"${CONFIG_KEYS}\"|grep -e '^standalone.host='| sed -e 's/^.*=//')\"\n+  WARP10_LISTENSTO_PORT=\"$(echo \"${CONFIG_KEYS}\"|grep -e '^standalone.port='| sed -e 's/^.*=//')\"", "originalCommit": "132e45deed12a4a5fd76d2b76241c9dd29a072d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE2MzU4NA==", "url": "https://github.com/senx/warp10-platform/pull/717#discussion_r408163584", "bodyText": "Not bash comments!", "author": "ftence", "createdAt": "2020-04-14T14:05:55Z", "path": "warp10/src/main/sh/warp10-standalone.sh", "diffHunk": "@@ -388,15 +388,21 @@ start() {\n   getConfigFiles\n \n   #\n-  # Config file exists ?\n+  # Config file exists?\n   #\n   if [[ -z \"${CONFIG_FILES}\" ]]; then\n     echo \"Config file does not exist - Use 'bootstrap' command before the very first launch (it must be run as root)\"\n     echo \"WARNING: Since version 2.1.0, Warp 10 can use multiple configuration files. The files have to be present in ${WARP10_CONFIG_DIR}\"\n     exit 1\n   fi\n \n-  LEVELDB_HOME=\"`${JAVACMD} -Xms64m -Xmx64m -XX:+UseG1GC -cp ${WARP10_CP} io.warp10.WarpConfig ${CONFIG_FILES} 'leveldb.home' | grep 'leveldb.home' | sed -e 's/^.*=//'`\"\n+  //\n+  // Extract configuration keys\n+  //", "originalCommit": "132e45deed12a4a5fd76d2b76241c9dd29a072d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE2OTU5NQ==", "url": "https://github.com/senx/warp10-platform/pull/717#discussion_r408169595", "bodyText": "I found it clearer to put a space before and after |, all following lines are concerned.", "author": "ftence", "createdAt": "2020-04-14T14:13:56Z", "path": "warp10/src/main/sh/warp10-standalone.sh", "diffHunk": "@@ -388,15 +388,21 @@ start() {\n   getConfigFiles\n \n   #\n-  # Config file exists ?\n+  # Config file exists?\n   #\n   if [[ -z \"${CONFIG_FILES}\" ]]; then\n     echo \"Config file does not exist - Use 'bootstrap' command before the very first launch (it must be run as root)\"\n     echo \"WARNING: Since version 2.1.0, Warp 10 can use multiple configuration files. The files have to be present in ${WARP10_CONFIG_DIR}\"\n     exit 1\n   fi\n \n-  LEVELDB_HOME=\"`${JAVACMD} -Xms64m -Xmx64m -XX:+UseG1GC -cp ${WARP10_CP} io.warp10.WarpConfig ${CONFIG_FILES} 'leveldb.home' | grep 'leveldb.home' | sed -e 's/^.*=//'`\"\n+  //\n+  // Extract configuration keys\n+  //\n+\n+  CONFIG_KEYS=$(${JAVACMD} -Xms64m -Xmx64m -XX:+UseG1GC -cp ${WARP10_CP} io.warp10.WarpConfig ${CONFIG_FILES} . 'leveldb.home' 'standalone.host' 'standalone.port'|grep -e '^@CONF@ '|sed -e 's/^@CONF@ //')", "originalCommit": "132e45deed12a4a5fd76d2b76241c9dd29a072d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "39e9503149971f0c0470ef3416eb1aaf0a74f6b2", "url": "https://github.com/senx/warp10-platform/commit/39e9503149971f0c0470ef3416eb1aaf0a74f6b2", "message": "Merge branch 'master' of github.com:senx/warp10-platform into config-fetch", "committedDate": "2020-04-14T14:37:25Z", "type": "commit"}, {"oid": "0c29514ebb2248c84ea586fcd55f2e6684258855", "url": "https://github.com/senx/warp10-platform/commit/0c29514ebb2248c84ea586fcd55f2e6684258855", "message": "Addressed PR comments", "committedDate": "2020-04-14T14:53:02Z", "type": "commit"}, {"oid": "e7240a9a605d0071f87a6bc20a5d73228f9f94ff", "url": "https://github.com/senx/warp10-platform/commit/e7240a9a605d0071f87a6bc20a5d73228f9f94ff", "message": "Addressed PR comments", "committedDate": "2020-04-14T15:49:50Z", "type": "commit"}]}