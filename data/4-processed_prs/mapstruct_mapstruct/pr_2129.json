{"pr_number": 2129, "pr_title": "#2122 fix for 2 step mapping and generics", "pr_createdAt": "2020-06-28T08:33:52Z", "pr_url": "https://github.com/mapstruct/mapstruct/pull/2129", "timeline": [{"oid": "77a2e054d896f5f3d53b0f187ec95d60aaf56115", "url": "https://github.com/mapstruct/mapstruct/commit/77a2e054d896f5f3d53b0f187ec95d60aaf56115", "message": "Reproducer for #2122", "committedDate": "2020-06-27T09:48:55Z", "type": "commit"}, {"oid": "c1a675c2531d423353bf6dc7e88d101335b99954", "url": "https://github.com/mapstruct/mapstruct/commit/c1a675c2531d423353bf6dc7e88d101335b99954", "message": "#2122 wip", "committedDate": "2020-06-28T08:33:08Z", "type": "commit"}, {"oid": "a11861257add540fe6f83041c28bb2b3fd4a7be6", "url": "https://github.com/mapstruct/mapstruct/commit/a11861257add540fe6f83041c28bb2b3fd4a7be6", "message": "#2122 fix", "committedDate": "2020-06-28T10:59:55Z", "type": "commit"}, {"oid": "726c283415174a0b7eee0a642ca3852383c5ae29", "url": "https://github.com/mapstruct/mapstruct/commit/726c283415174a0b7eee0a642ca3852383c5ae29", "message": "#2122 extra test 1", "committedDate": "2020-06-28T12:55:14Z", "type": "commit"}, {"oid": "00bf425f7237b6b245ec0926ec330096da02bd6d", "url": "https://github.com/mapstruct/mapstruct/commit/00bf425f7237b6b245ec0926ec330096da02bd6d", "message": "#2122 refactor method to Type", "committedDate": "2020-06-28T17:50:12Z", "type": "commit"}, {"oid": "2ab01a28e52ad1d59b2cc4ccbddc0ea37f634bcf", "url": "https://github.com/mapstruct/mapstruct/commit/2ab01a28e52ad1d59b2cc4ccbddc0ea37f634bcf", "message": "#2122 adding test for asignabillity", "committedDate": "2020-06-28T18:27:30Z", "type": "commit"}, {"oid": "884416e64b6860ad7ea7b1f304b1671b439a548e", "url": "https://github.com/mapstruct/mapstruct/commit/884416e64b6860ad7ea7b1f304b1671b439a548e", "message": "#2122 adding test for parametertype nessting", "committedDate": "2020-06-28T21:18:49Z", "type": "commit"}, {"oid": "884416e64b6860ad7ea7b1f304b1671b439a548e", "url": "https://github.com/mapstruct/mapstruct/commit/884416e64b6860ad7ea7b1f304b1671b439a548e", "message": "#2122 adding test for parametertype nessting", "committedDate": "2020-06-28T21:18:49Z", "type": "forcePushed"}, {"oid": "ece885b866fa62d8a899a99254a87032b9b9e4c5", "url": "https://github.com/mapstruct/mapstruct/commit/ece885b866fa62d8a899a99254a87032b9b9e4c5", "message": "#2133 reorg unit test", "committedDate": "2020-07-04T09:56:17Z", "type": "commit"}, {"oid": "0eee1f5c5bd958d1229278387c62ee41655b9a79", "url": "https://github.com/mapstruct/mapstruct/commit/0eee1f5c5bd958d1229278387c62ee41655b9a79", "message": "#2133 type-conversion to method", "committedDate": "2020-07-04T10:17:07Z", "type": "commit"}, {"oid": "8856e10f5d0a79464291631f1ea356994f1d8f16", "url": "https://github.com/mapstruct/mapstruct/commit/8856e10f5d0a79464291631f1ea356994f1d8f16", "message": "#2133 method-to-typeconversion", "committedDate": "2020-07-04T10:37:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc3OTUwNg==", "url": "https://github.com/mapstruct/mapstruct/pull/2129#discussion_r449779506", "bodyText": "resolveToType already checks for isTypeVar(). You can directly do\nySourceType = ySourceType.resolveToType( targetType, methodYCandidate.getResultType() );", "author": "filiphr", "createdAt": "2020-07-04T14:52:21Z", "path": "processor/src/main/java/org/mapstruct/ap/internal/processor/creation/MappingResolverImpl.java", "diffHunk": "@@ -426,29 +426,33 @@ private Assignment resolveViaMethodAndMethod(Type sourceType, Type targetType) {\n             // sourceMethod or builtIn that fits the signature B to C. Only then there is a match. If we have a match\n             // a nested method call can be called. so C = methodY( methodX (A) )\n             for ( Method methodYCandidate : methodYCandidates ) {\n-                if ( Object.class.getName()\n-                    .equals( methodYCandidate.getSourceParameters().get( 0 ).getType().getName() ) ) {\n+                Type ySourceType = methodYCandidate.getSourceParameters().get( 0 ).getType();\n+                if ( Object.class.getName().equals( ySourceType.getName() ) ) {\n                     //  java.lang.Object as intermediate result\n                     continue;\n                 }\n \n-                methodRefY =\n-                    resolveViaMethod( methodYCandidate.getSourceParameters().get( 0 ).getType(), targetType, true );\n+                if ( ySourceType.isTypeVar() ) {\n+                    ySourceType = ySourceType.resolveToType( targetType, methodYCandidate.getResultType() );\n+                }", "originalCommit": "8856e10f5d0a79464291631f1ea356994f1d8f16", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc4NjM4Mw==", "url": "https://github.com/mapstruct/mapstruct/pull/2129#discussion_r449786383", "bodyText": "that's true..  but there's actually a reason for this:\n\nI did not want to do the resolveToType unchecked in the resolveToType method itself.. Was a bit struggling with the method name.\nI wanted to make the flow clear at the call site..\n\nI could have made it resolveTypeVarToType at hind site.  Will do this.", "author": "sjaakd", "createdAt": "2020-07-04T16:29:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc3OTUwNg=="}], "type": "inlineReview"}, {"oid": "abc2b0d5eaad0366edf3b98e90d3ff26116f9e54", "url": "https://github.com/mapstruct/mapstruct/commit/abc2b0d5eaad0366edf3b98e90d3ff26116f9e54", "message": "#2133 rework", "committedDate": "2020-07-04T16:31:27Z", "type": "commit"}]}