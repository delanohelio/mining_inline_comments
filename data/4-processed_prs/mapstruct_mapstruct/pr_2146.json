{"pr_number": 2146, "pr_title": "#2145 fixing 2 step mapping methods (refactoring)", "pr_createdAt": "2020-07-07T17:51:12Z", "pr_url": "https://github.com/mapstruct/mapstruct/pull/2146", "timeline": [{"oid": "ce140371d2a2b200bcb69f5a02d199cf6ae20e2b", "url": "https://github.com/mapstruct/mapstruct/commit/ce140371d2a2b200bcb69f5a02d199cf6ae20e2b", "message": "#2145 reproducer", "committedDate": "2020-07-07T18:07:38Z", "type": "forcePushed"}, {"oid": "c8f558c9d95ea771d8f119851bb107ee1306644f", "url": "https://github.com/mapstruct/mapstruct/commit/c8f558c9d95ea771d8f119851bb107ee1306644f", "message": "#2145 cleanup 4", "committedDate": "2020-07-12T12:18:58Z", "type": "forcePushed"}, {"oid": "c7dd76cb3bd2ec73e6525154d21185bc8b0f86e0", "url": "https://github.com/mapstruct/mapstruct/commit/c7dd76cb3bd2ec73e6525154d21185bc8b0f86e0", "message": "#2145 wrap up.", "committedDate": "2020-07-13T21:18:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU1MTM2Mw==", "url": "https://github.com/mapstruct/mapstruct/pull/2146#discussion_r455551363", "bodyText": "Does it matter that we are not doing getValue for the name?", "author": "filiphr", "createdAt": "2020-07-16T06:57:49Z", "path": "processor/src/main/java/org/mapstruct/ap/internal/model/source/selector/XmlElementDeclSelector.java", "diffHunk": "@@ -69,7 +69,7 @@ public XmlElementDeclSelector(Types typeUtils) {\n             }\n \n             String name = xmlElementDecl.name().get();\n-            TypeMirror scope = xmlElementDecl.scope().get();\n+            TypeMirror scope = xmlElementDecl.scope().getValue();", "originalCommit": "46c8fcd016a78bfca99054cbdd7f1bf47895298a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY1MTc1MQ==", "url": "https://github.com/mapstruct/mapstruct/pull/2146#discussion_r455651751", "bodyText": "From the top of my head: get() will return the default value when null,  but in this case we want getValue();", "author": "sjaakd", "createdAt": "2020-07-16T09:28:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU1MTM2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY5OTU4OA==", "url": "https://github.com/mapstruct/mapstruct/pull/2146#discussion_r455699588", "bodyText": "So.. to be precise. It does perhaps not make a difference.  Its indeed as above. Omitting scope from the annotation (as is done in the test case) gives  a scope:\n\nGLOBAL.class with get()\nnull with getValue()\n\nI prefer the latter one.. It will not go into typeUtils.isSameType( scope, xmlElementRefInfo.sourceType() ) on line 76", "author": "sjaakd", "createdAt": "2020-07-16T10:53:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU1MTM2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcwMTczMA==", "url": "https://github.com/mapstruct/mapstruct/pull/2146#discussion_r455701730", "bodyText": "Makes sense", "author": "filiphr", "createdAt": "2020-07-16T10:57:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU1MTM2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU1NDQ5Nw==", "url": "https://github.com/mapstruct/mapstruct/pull/2146#discussion_r455554497", "bodyText": "Why do we need 2 methods? One with Set and another one with List?", "author": "filiphr", "createdAt": "2020-07-16T07:04:33Z", "path": "processor/src/main/java/org/mapstruct/ap/internal/processor/creation/MappingResolverImpl.java", "diffHunk": "@@ -640,15 +433,21 @@ private boolean isUpdateMethodForMapping(Method methodCandidate) {\n                 && !methodCandidate.isLifecycleCallbackMethod();\n         }\n \n-        private <T extends Method> SelectedMethod<T> getBestMatch(List<T> methods, Type sourceType, Type returnType) {\n+        private <T extends Method> List<SelectedMethod<T>> getBestMatch(Set<T> methods, Type source, Type target) {", "originalCommit": "46c8fcd016a78bfca99054cbdd7f1bf47895298a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY1MzI0NQ==", "url": "https://github.com/mapstruct/mapstruct/pull/2146#discussion_r455653245", "bodyText": "I do use sets in the 2 step matchers to store unique 'SelectedMethods'.. I don't do that in the regular one-step variant. So I wanted to preserve order there (did not want to touch it). I bolted on the Set and did not want to change it all over the place..\nPerhaps later in a cleanup?", "author": "sjaakd", "createdAt": "2020-07-16T09:30:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU1NDQ5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY5OTkwNg==", "url": "https://github.com/mapstruct/mapstruct/pull/2146#discussion_r455699906", "bodyText": "I'll push an update.. removing the method.. I'll change it at the (one) call site.", "author": "sjaakd", "createdAt": "2020-07-16T10:53:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU1NDQ5Nw=="}], "type": "inlineReview"}, {"oid": "209e98d1c6d16233a7f10a767556f59ed23693d7", "url": "https://github.com/mapstruct/mapstruct/commit/209e98d1c6d16233a7f10a767556f59ed23693d7", "message": "#2145 fixing 2 step mapping methods (refactoring)", "committedDate": "2020-07-16T11:12:46Z", "type": "commit"}, {"oid": "209e98d1c6d16233a7f10a767556f59ed23693d7", "url": "https://github.com/mapstruct/mapstruct/commit/209e98d1c6d16233a7f10a767556f59ed23693d7", "message": "#2145 fixing 2 step mapping methods (refactoring)", "committedDate": "2020-07-16T11:12:46Z", "type": "forcePushed"}]}