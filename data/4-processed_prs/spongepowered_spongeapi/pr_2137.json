{"pr_number": 2137, "pr_title": "[API-8] Improve Tristate", "pr_createdAt": "2020-06-30T14:17:10Z", "pr_url": "https://github.com/SpongePowered/SpongeAPI/pull/2137", "timeline": [{"oid": "d0426575e3c6197363550a072f2a7c80b5d384d1", "url": "https://github.com/SpongePowered/SpongeAPI/commit/d0426575e3c6197363550a072f2a7c80b5d384d1", "message": "Improve Tristate:\n* Add Tristate#not\n* Add Tristate#fromNullable", "committedDate": "2020-06-30T14:14:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcxOTk0Nw==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447719947", "bodyText": "Maybe call it negate?", "author": "Zidane", "createdAt": "2020-06-30T14:18:50Z", "path": "src/main/java/org/spongepowered/api/util/Tristate.java", "diffHunk": "@@ -94,6 +126,13 @@ public static Tristate fromBoolean(boolean val) {\n      */\n     public abstract Tristate or(Tristate other);\n \n+    /**\n+     * NOTs this tristate.", "originalCommit": "d0426575e3c6197363550a072f2a7c80b5d384d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyNTI3OA==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447725278", "bodyText": "Edited", "author": "ItsDoot", "createdAt": "2020-06-30T14:25:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcxOTk0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzczNTg1OA==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447735858", "bodyText": "Maybe also change the method name accordingly?", "author": "ST-DDT", "createdAt": "2020-06-30T14:39:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcxOTk0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc2MjA0NQ==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447762045", "bodyText": "IMO not lines up better with and/or than negate does.", "author": "ItsDoot", "createdAt": "2020-06-30T15:12:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcxOTk0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyMTAxNA==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447721014", "bodyText": "I feel like this should be named fromNullableBoolean.\nIf we have this, should we also have an asNullableBoolean analogue?", "author": "dualspiral", "createdAt": "2020-06-30T14:20:14Z", "path": "src/main/java/org/spongepowered/api/util/Tristate.java", "diffHunk": "@@ -78,6 +95,21 @@ public static Tristate fromBoolean(boolean val) {\n         return val ? TRUE : FALSE;\n     }\n \n+    /**\n+     * Returns the appropriate tristate for a given nullable boolean value,\n+     * where null equates to {@link Tristate#UNDEFINED}.\n+     *\n+     * @param val The nullable boolean value\n+     * @return The appropriate tristate\n+     */\n+    public static Tristate fromNullable(@Nullable Boolean val) {", "originalCommit": "d0426575e3c6197363550a072f2a7c80b5d384d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyNDEyNQ==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447724125", "bodyText": "See, I was thinking about doing asNullableBoolean, but what should it return? Returning an actual nullable boolean would make sense, but Sponge prefers Optionals... which to me would feel a little weird.", "author": "ItsDoot", "createdAt": "2020-06-30T14:24:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyMTAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyOTk2OQ==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447729969", "bodyText": "This is one of those rare cases I'd have a nullable return type as a one-to-one mapping of Boolean<->Tristate - if you can get a Tristate from a Boolean, it stands to reason that you should be able to go the other way just as simply.\nI'll let @Zidane call this one, but I think it should just be a @Nullable Boolean return type. There is an extra clue in the name of the method here, if you're not expecting the possibility of it being null if you grab the Boolean then that's really your lookout.", "author": "dualspiral", "createdAt": "2020-06-30T14:31:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyMTAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzczMTkzOA==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447731938", "bodyText": "I would prefer, not to have a asNullableBoolean, because this class is the replacement for the nullable/unset boolean.\nAs for the fromX methods, I would rather name them both from (or fromBoolean) with just different parameters. Let the compiler decide which one it should use.", "author": "ST-DDT", "createdAt": "2020-06-30T14:33:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyMTAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1MDg4OQ==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447750889", "bodyText": "because this class is the replacement for the nullable/unset boolean.\n\nThat doesn't change my argument at all. I'm saying the mapping should work both ways in case you then interact with some system that isn't Tristate aware - plugins can (and often do) work with third party libraries.", "author": "dualspiral", "createdAt": "2020-06-30T14:57:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyMTAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg4OTIxMw==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447889213", "bodyText": "Changed fromNullable to fromNullableBoolean, and added asNullableBoolean.\n\nAs for the fromX methods, I would rather name them both from (or fromBoolean) with just different parameters. Let the compiler decide which one it should use.\n\n@ST-DDT I'd rather users explicitly opt-in to using the nullable boolean conversions. Then it's clear when someone else is reading your code, for example.", "author": "ItsDoot", "createdAt": "2020-06-30T18:19:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyMTAxNA=="}], "type": "inlineReview"}, {"oid": "3a2ef17f00aa1e6cd8afb1564a2fd62539dc0d1c", "url": "https://github.com/SpongePowered/SpongeAPI/commit/3a2ef17f00aa1e6cd8afb1564a2fd62539dc0d1c", "message": "Edit Tristate#not javadocs", "committedDate": "2020-06-30T14:23:49Z", "type": "commit"}, {"oid": "f932920d80adeb3922eee4b8f6c9a07e0c6eae82", "url": "https://github.com/SpongePowered/SpongeAPI/commit/f932920d80adeb3922eee4b8f6c9a07e0c6eae82", "message": "Simplify Tristate.TRUE#and", "committedDate": "2020-06-30T14:31:36Z", "type": "commit"}, {"oid": "f28569b34306bf9bb2a22e0c45a6a30ed7356805", "url": "https://github.com/SpongePowered/SpongeAPI/commit/f28569b34306bf9bb2a22e0c45a6a30ed7356805", "message": "* Tristate#fromNullable -> Tristate#fromNullableBoolean\n* Add Tristate#asNullableBoolean", "committedDate": "2020-06-30T18:17:26Z", "type": "commit"}, {"oid": "818b463bf67c836dfb6cc6dddb897f06cb5e9efd", "url": "https://github.com/SpongePowered/SpongeAPI/commit/818b463bf67c836dfb6cc6dddb897f06cb5e9efd", "message": "Added an extra note to Tristate#asNullableBoolean about the nullable return type.", "committedDate": "2020-06-30T18:29:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkxMDA2Ng==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447910066", "bodyText": "may return? I see no Optional return so state it will.", "author": "Zidane", "createdAt": "2020-06-30T18:55:41Z", "path": "src/main/java/org/spongepowered/api/util/Tristate.java", "diffHunk": "@@ -102,4 +141,23 @@ public static Tristate fromBoolean(boolean val) {\n     public boolean asBoolean() {\n         return this.val;\n     }\n+\n+    /**\n+     * Returns the nullable boolean representation of this tristate,\n+     * where {@link Tristate#UNDEFINED} equates to null.\n+     *\n+     * <p>Note: To ensure that there is a one-to-one mapping of nullable\n+     * booleans to and from {@link Tristate}, this method may return null", "originalCommit": "818b463bf67c836dfb6cc6dddb897f06cb5e9efd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkxODk3Mg==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2137#discussion_r447918972", "bodyText": "Fixed", "author": "ItsDoot", "createdAt": "2020-06-30T19:11:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkxMDA2Ng=="}], "type": "inlineReview"}, {"oid": "35ba0c0bfa79a79794b72ec9974aad898370dae5", "url": "https://github.com/SpongePowered/SpongeAPI/commit/35ba0c0bfa79a79794b72ec9974aad898370dae5", "message": "Grammar", "committedDate": "2020-06-30T19:10:56Z", "type": "commit"}]}