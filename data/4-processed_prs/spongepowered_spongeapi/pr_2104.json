{"pr_number": 2104, "pr_title": "Add SaveChunkEvent.", "pr_createdAt": "2020-04-04T16:04:13Z", "pr_url": "https://github.com/SpongePowered/SpongeAPI/pull/2104", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4NzE5Ng==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r403487196", "bodyText": "Why might you want to cancel a chunk save? Isn't that what the serialisation behaviours for?", "author": "dualspiral", "createdAt": "2020-04-04T16:14:49Z", "path": "src/main/java/org/spongepowered/api/event/world/chunk/SaveChunkEvent.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/*\n+ * This file is part of SpongeAPI, licensed under the MIT License (MIT).\n+ *\n+ * Copyright (c) SpongePowered <https://www.spongepowered.org>\n+ * Copyright (c) contributors\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+package org.spongepowered.api.event.world.chunk;\n+\n+import com.flowpowered.math.vector.Vector3i;\n+import org.spongepowered.api.event.Cancellable;\n+import org.spongepowered.api.event.Event;\n+import org.spongepowered.api.world.Chunk;\n+\n+/**\n+ * Called when a {@link Chunk} is performing a save.\n+ */\n+public interface SaveChunkEvent extends Event {\n+\n+    Vector3i getPosition();\n+\n+    interface Pre extends SaveChunkEvent, TargetChunkEvent, Cancellable {}", "originalCommit": "b1caf54a9d73a4acafdf2ab20d582921fc94b0ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4OTkxMg==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r403489912", "bodyText": "SerializationBehavior is all or nothing. You could choose to not save certain chunks. Debate could be made either way", "author": "Zidane", "createdAt": "2020-04-04T16:42:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4NzE5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5MDA2NQ==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r403490065", "bodyText": "I don't have an issue with this personally - dunno if anyone else does.", "author": "dualspiral", "createdAt": "2020-04-04T16:43:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4NzE5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5MTMyMw==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r403491323", "bodyText": "One thought I had in mind is an area of the world where any changes wouldn't be wrote. You enter this \"zone\" and when you leave and it unloads and loads again the zone resets.\nThink \"mining worlds\" but no need to do more worlds, lol.", "author": "Zidane", "createdAt": "2020-04-04T16:55:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4NzE5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUyMTUwNQ==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r423521505", "bodyText": "I can see some issues with this though, if handled improperly, couldn't the chunk load having not been saved cause some entity weirdness?", "author": "gabizou", "createdAt": "2020-05-12T07:32:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4NzE5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4NzI5NA==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r403487294", "bodyText": "I'm assuming that this is the chunk position - in which case I think we should name this getChunkPosition() to make it crystal clear that's what this is. I know we'll add javadocs to this BUT many a developer may not read the javadocs and assume.", "author": "dualspiral", "createdAt": "2020-04-04T16:15:51Z", "path": "src/main/java/org/spongepowered/api/event/world/chunk/SaveChunkEvent.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/*\n+ * This file is part of SpongeAPI, licensed under the MIT License (MIT).\n+ *\n+ * Copyright (c) SpongePowered <https://www.spongepowered.org>\n+ * Copyright (c) contributors\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+package org.spongepowered.api.event.world.chunk;\n+\n+import com.flowpowered.math.vector.Vector3i;\n+import org.spongepowered.api.event.Cancellable;\n+import org.spongepowered.api.event.Event;\n+import org.spongepowered.api.world.Chunk;\n+\n+/**\n+ * Called when a {@link Chunk} is performing a save.\n+ */\n+public interface SaveChunkEvent extends Event {\n+\n+    Vector3i getPosition();", "originalCommit": "b1caf54a9d73a4acafdf2ab20d582921fc94b0ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4OTgwNA==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r403489804", "bodyText": "Agreed", "author": "Zidane", "createdAt": "2020-04-04T16:41:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4NzI5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4NzQ5NA==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r403487494", "bodyText": "Just read Discord, this basically means that the save is going ahead, but may not yet be on the disc. We will want to mention that in the JDs.", "author": "dualspiral", "createdAt": "2020-04-04T16:18:12Z", "path": "src/main/java/org/spongepowered/api/event/world/chunk/SaveChunkEvent.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/*\n+ * This file is part of SpongeAPI, licensed under the MIT License (MIT).\n+ *\n+ * Copyright (c) SpongePowered <https://www.spongepowered.org>\n+ * Copyright (c) contributors\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+package org.spongepowered.api.event.world.chunk;\n+\n+import com.flowpowered.math.vector.Vector3i;\n+import org.spongepowered.api.event.Cancellable;\n+import org.spongepowered.api.event.Event;\n+import org.spongepowered.api.world.Chunk;\n+\n+/**\n+ * Called when a {@link Chunk} is performing a save.\n+ */\n+public interface SaveChunkEvent extends Event {\n+\n+    Vector3i getPosition();\n+\n+    interface Pre extends SaveChunkEvent, TargetChunkEvent, Cancellable {}\n+\n+    interface Post extends SaveChunkEvent {}", "originalCommit": "b1caf54a9d73a4acafdf2ab20d582921fc94b0ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5MDA0Mg==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r403490042", "bodyText": "It was but ultimately that isnt enough for Joni's usecase. He needs to be sure that file wrote to disk. Therefore this is as post as you get, the file is on the disk.", "author": "Zidane", "createdAt": "2020-04-04T16:43:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ4NzQ5NA=="}], "type": "inlineReview"}, {"oid": "c7657db9d85b061ba7b867170d58250b684708a4", "url": "https://github.com/SpongePowered/SpongeAPI/commit/c7657db9d85b061ba7b867170d58250b684708a4", "message": "Add SaveChunkEvent.\n\nSigned-off-by: Chris Sanders <zidane@spongepowered.org>", "committedDate": "2020-04-04T18:27:42Z", "type": "forcePushed"}, {"oid": "0891b43c43936a00dcb279a82d24ca06f84339c3", "url": "https://github.com/SpongePowered/SpongeAPI/commit/0891b43c43936a00dcb279a82d24ca06f84339c3", "message": "Add SaveChunkEvent.\n\nSigned-off-by: Chris Sanders <zidane@spongepowered.org>", "committedDate": "2020-06-09T16:32:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYzMTUzNg==", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2104#discussion_r437631536", "bodyText": "Shouldn't this extends TargetChunkEvent ?\nEDIT: no, it's too late", "author": "ImMorpheus", "createdAt": "2020-06-09T18:23:49Z", "path": "src/main/java/org/spongepowered/api/event/world/chunk/SaveChunkEvent.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * This file is part of SpongeAPI, licensed under the MIT License (MIT).\n+ *\n+ * Copyright (c) SpongePowered <https://www.spongepowered.org>\n+ * Copyright (c) contributors\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+package org.spongepowered.api.event.world.chunk;\n+\n+import com.flowpowered.math.vector.Vector3i;\n+import org.spongepowered.api.event.Cancellable;\n+import org.spongepowered.api.event.Event;\n+import org.spongepowered.api.world.Chunk;\n+\n+/**\n+ * Called when a {@link Chunk} is performing a save.\n+ */\n+public interface SaveChunkEvent extends Event {\n+\n+    /**\n+     * Gets the position of the {@link Chunk}.\n+     *\n+     * @return the position\n+     */\n+    Vector3i getChunkPosition();\n+\n+    /**\n+     * Called before the {@link Chunk} is saved. Cancelling this will prevent any of\n+     * the chunk's data being written to it's storage container.\n+     */\n+    interface Pre extends SaveChunkEvent, TargetChunkEvent, Cancellable {}\n+\n+    /**\n+     * Called after the {@link Chunk} is saved. Guaranteed to exist in the chunk's\n+     * storage container.\n+     *\n+     * Depending on the implementation, this event may be called off-thread.\n+     */\n+    interface Post extends SaveChunkEvent {}", "originalCommit": "0891b43c43936a00dcb279a82d24ca06f84339c3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c154fd4b06cddc1dd0f3557f46349eddf681fee1", "url": "https://github.com/SpongePowered/SpongeAPI/commit/c154fd4b06cddc1dd0f3557f46349eddf681fee1", "message": "Add SaveChunkEvent.\n\nSigned-off-by: Chris Sanders <zidane@spongepowered.org>", "committedDate": "2020-06-10T17:36:05Z", "type": "commit"}, {"oid": "c154fd4b06cddc1dd0f3557f46349eddf681fee1", "url": "https://github.com/SpongePowered/SpongeAPI/commit/c154fd4b06cddc1dd0f3557f46349eddf681fee1", "message": "Add SaveChunkEvent.\n\nSigned-off-by: Chris Sanders <zidane@spongepowered.org>", "committedDate": "2020-06-10T17:36:05Z", "type": "forcePushed"}]}