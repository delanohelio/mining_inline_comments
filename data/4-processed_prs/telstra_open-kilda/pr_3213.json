{"pr_number": 3213, "pr_title": "Extend detaild of swmanager log messages", "pr_createdAt": "2020-02-17T12:59:04Z", "pr_url": "https://github.com/telstra/open-kilda/pull/3213", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5ODgzNA==", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r380498834", "bodyText": "maybe it's worth to log tuple payload as well? also, have you checked it doesn't spam a ton of errors?", "author": "timofei-durakov", "createdAt": "2020-02-18T07:35:14Z", "path": "src-java/base-topology/base-storm-topology/src/main/java/org/openkilda/wfm/share/hubandspoke/WorkerBolt.java", "diffHunk": "@@ -87,7 +87,8 @@ private void dispatchResponse(Tuple input) throws Exception {\n         if (request != null) {\n             onAsyncResponse(request, input);\n         } else {\n-            unhandledInput(input);\n+            log.error(\"{} drop worker async response. because {} key is not listed in pending response list\",", "originalCommit": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE3NDQ4Ng==", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381174486", "bodyText": "It produce same amount of messages as removed unhandledInput() call. I don't see any benefits from logging tuple here (from my point of view, whole picture can be seen only when log records are filtered by correlation it...)", "author": "surabujin", "createdAt": "2020-02-19T09:37:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5ODgzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5OTY1MQ==", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r380499651", "bodyText": "don't get this fixme, null for the errors seems bad idea, also take into account this one #3160", "author": "timofei-durakov", "createdAt": "2020-02-18T07:37:37Z", "path": "src-java/floodlight-service/floodlight-modules/src/main/java/org/openkilda/floodlight/kafka/RecordHandler.java", "diffHunk": "@@ -1424,6 +1424,7 @@ private void dumpMeters(SwitchId switchId, String correlationId, String replyToT\n         try {\n             logger.debug(\"Get all meters for switch {}\", switchId);\n             ISwitchManager switchManager = context.getSwitchManager();\n+            // FIXME(surabujin): return null in case of errors", "originalCommit": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE3MjkxMQ==", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381172911", "bodyText": "I do not propose to return null. Now witchManager.dumpMeters(DatapathId.of(switchId.toLong())) return null in some cases and it leads to NPE in this method. This FIXME is reminder to fix it.", "author": "surabujin", "createdAt": "2020-02-19T09:34:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5OTY1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTgzMjY1Mg==", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381832652", "bodyText": "ok, it's just composed badly then. It should be get rid of returning null.", "author": "timofei-durakov", "createdAt": "2020-02-20T07:54:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5OTY1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDUwMDQxNQ==", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r380500415", "bodyText": "just for the sake of curiosity, is it better to move key from the beginning from the search perspective?", "author": "timofei-durakov", "createdAt": "2020-02-18T07:39:51Z", "path": "src-java/swmanager-topology/swmanager-storm-topology/src/main/java/org/openkilda/wfm/topology/switchmanager/fsm/SwitchSyncFsm.java", "diffHunk": "@@ -171,15 +171,15 @@ public String getKey() {\n \n     protected void initialized(SwitchSyncState from, SwitchSyncState to,\n                                SwitchSyncEvent event, Object context) {\n-        log.info(\"Key: {}, sync FSM initialized\", key);\n+        log.info(\"The switch sync process for {} has been started (key={})\", switchId, key);", "originalCommit": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE3NTYwMA==", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381175600", "bodyText": "No. For the same sake - will you ever search any records by this key?", "author": "surabujin", "createdAt": "2020-02-19T09:39:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDUwMDQxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTgzMzE0NA==", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381833144", "bodyText": "it was aligned at least as for me. yeah, why not. (not a blocker, just curious)", "author": "timofei-durakov", "createdAt": "2020-02-20T07:55:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDUwMDQxNQ=="}], "type": "inlineReview"}, {"oid": "627c40839973b07c4859fd8a643cfe87c1727e81", "url": "https://github.com/telstra/open-kilda/commit/627c40839973b07c4859fd8a643cfe87c1727e81", "message": "Extend detaild of swmanager log messages\n\nAdd more details in log messages, to improve chance of finding RCA of\nswmanager releate issues.", "committedDate": "2020-02-19T10:14:45Z", "type": "commit"}, {"oid": "627c40839973b07c4859fd8a643cfe87c1727e81", "url": "https://github.com/telstra/open-kilda/commit/627c40839973b07c4859fd8a643cfe87c1727e81", "message": "Extend detaild of swmanager log messages\n\nAdd more details in log messages, to improve chance of finding RCA of\nswmanager releate issues.", "committedDate": "2020-02-19T10:14:45Z", "type": "forcePushed"}]}