{"pr_number": 3888, "pr_title": "Zero Downtime for Flow HS", "pr_createdAt": "2020-11-29T15:17:38Z", "pr_url": "https://github.com/telstra/open-kilda/pull/3888", "timeline": [{"oid": "4ac707ac929448b64f2d471c79a2e8818ab5d547", "url": "https://github.com/telstra/open-kilda/commit/4ac707ac929448b64f2d471c79a2e8818ab5d547", "message": "Zero Downtime for Flow HS", "committedDate": "2020-11-29T17:35:27Z", "type": "forcePushed"}, {"oid": "dd6ea94d0f6beed9794fcf443434862b52e6e2eb", "url": "https://github.com/telstra/open-kilda/commit/dd6ea94d0f6beed9794fcf443434862b52e6e2eb", "message": "Zero Downtime for Flow HS", "committedDate": "2020-11-29T18:04:42Z", "type": "forcePushed"}, {"oid": "c785897f4c2b4c4ad3e2e1e98adb5462c220192b", "url": "https://github.com/telstra/open-kilda/commit/c785897f4c2b4c4ad3e2e1e98adb5462c220192b", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-03T06:27:51Z", "type": "forcePushed"}, {"oid": "6c28e63fc22c853b626556f2aa04cca0f293206b", "url": "https://github.com/telstra/open-kilda/commit/6c28e63fc22c853b626556f2aa04cca0f293206b", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-07T09:16:35Z", "type": "forcePushed"}, {"oid": "58efc92a89bc0110112340b9ff6e11e9aa43a2bd", "url": "https://github.com/telstra/open-kilda/commit/58efc92a89bc0110112340b9ff6e11e9aa43a2bd", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-07T09:17:37Z", "type": "forcePushed"}, {"oid": "0c532365c227dee18c8154fe92927d0c19bfb76d", "url": "https://github.com/telstra/open-kilda/commit/0c532365c227dee18c8154fe92927d0c19bfb76d", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-07T09:43:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzYxMTIxNw==", "url": "https://github.com/telstra/open-kilda/pull/3888#discussion_r537611217", "bodyText": "incorrect. should be {} instead of %s", "author": "niksv", "createdAt": "2020-12-07T15:47:22Z", "path": "src-java/flowhs-topology/flowhs-storm-topology/src/main/java/org/openkilda/wfm/topology/flowhs/bolts/FlowCreateHubBolt.java", "diffHunk": "@@ -87,6 +94,22 @@ protected void init() {\n                 config.getPathAllocationRetryDelay(), config.getSpeakerCommandRetriesLimit());\n     }\n \n+    @Override\n+    protected void handleLifeCycleEvent(LifecycleEvent event) {\n+        if (event.getSignal().equals(Signal.SHUTDOWN)) {\n+            if (service.deactivate()) {\n+                emit(ZkStreams.ZK.toString(), getCurrentTuple(), new Values(event, getCommandContext()));\n+            } else {\n+                deferedShutdownEvent = event;\n+            }\n+        } else if (event.getSignal().equals(Signal.START)) {\n+            service.activate();\n+            emit(ZkStreams.ZK.toString(), getCurrentTuple(), new Values(event, getCommandContext()));\n+        } else {\n+            log.info(\"Received signal info %s\", event.getSignal());", "originalCommit": "0c532365c227dee18c8154fe92927d0c19bfb76d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5f7cb5e2a2e2fa8ef31c53526c06132a2f8bdf74", "url": "https://github.com/telstra/open-kilda/commit/5f7cb5e2a2e2fa8ef31c53526c06132a2f8bdf74", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-08T07:27:44Z", "type": "forcePushed"}, {"oid": "025cf527da525e72e7a2978ec774fee74f862448", "url": "https://github.com/telstra/open-kilda/commit/025cf527da525e72e7a2978ec774fee74f862448", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-09T11:52:50Z", "type": "forcePushed"}, {"oid": "01768de1a135aa7e988e8df5a1bfc719d9e26987", "url": "https://github.com/telstra/open-kilda/commit/01768de1a135aa7e988e8df5a1bfc719d9e26987", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-11T15:12:38Z", "type": "forcePushed"}, {"oid": "139bf506ae184d2217fbe8384e42f13e23716331", "url": "https://github.com/telstra/open-kilda/commit/139bf506ae184d2217fbe8384e42f13e23716331", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-17T12:41:40Z", "type": "forcePushed"}, {"oid": "8e82a1feeee041cc723102de3af21863c265252d", "url": "https://github.com/telstra/open-kilda/commit/8e82a1feeee041cc723102de3af21863c265252d", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-21T19:47:13Z", "type": "forcePushed"}, {"oid": "dc1185319bb40bffbeac3dfa06057460585539fe", "url": "https://github.com/telstra/open-kilda/commit/dc1185319bb40bffbeac3dfa06057460585539fe", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-23T06:39:17Z", "type": "forcePushed"}, {"oid": "cdb05a45e77a89cb0d3edabb10fa726d3a16c058", "url": "https://github.com/telstra/open-kilda/commit/cdb05a45e77a89cb0d3edabb10fa726d3a16c058", "message": "Zero Downtime for Flow HS", "committedDate": "2020-12-28T10:56:40Z", "type": "forcePushed"}, {"oid": "adbedbf4f67dbaa1b7781d1f950383ce721bb657", "url": "https://github.com/telstra/open-kilda/commit/adbedbf4f67dbaa1b7781d1f950383ce721bb657", "message": "Zero Downtime for Flow HS", "committedDate": "2021-01-14T14:19:19Z", "type": "forcePushed"}, {"oid": "b66a2babaad03f8247988ac7167bd82bebddb60f", "url": "https://github.com/telstra/open-kilda/commit/b66a2babaad03f8247988ac7167bd82bebddb60f", "message": "Zero Downtime for Flow HS", "committedDate": "2021-01-14T19:19:31Z", "type": "forcePushed"}, {"oid": "cfcd80450d93e3c68ee9392a13040c5d5317f3cf", "url": "https://github.com/telstra/open-kilda/commit/cfcd80450d93e3c68ee9392a13040c5d5317f3cf", "message": "Zero Downtime for Flow HS", "committedDate": "2021-01-25T08:09:22Z", "type": "forcePushed"}, {"oid": "3b4ee858d91ad628702e8cec6afc6252d6da7fe2", "url": "https://github.com/telstra/open-kilda/commit/3b4ee858d91ad628702e8cec6afc6252d6da7fe2", "message": "Zero Downtime for Flow HS", "committedDate": "2021-01-27T08:18:49Z", "type": "forcePushed"}, {"oid": "77fd5014fa6d34e8c16c5ee24e75b21a51ae44c4", "url": "https://github.com/telstra/open-kilda/commit/77fd5014fa6d34e8c16c5ee24e75b21a51ae44c4", "message": "Zero Downtime for Flow HS", "committedDate": "2021-01-29T06:08:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NzUwODY0NA==", "url": "https://github.com/telstra/open-kilda/pull/3888#discussion_r567508644", "bodyText": "Why not move this logic up to the abstract topology?", "author": "sergii-iakovenko", "createdAt": "2021-02-01T00:18:17Z", "path": "src-java/flowhs-topology/flowhs-storm-topology/src/main/java/org/openkilda/wfm/topology/flowhs/FlowHsTopology.java", "diffHunk": "@@ -105,17 +108,41 @@ public StormTopology createTopology() {\n \n         history(tb, persistenceManager);\n \n+        zkSpout(tb);\n+        zkBolt(tb);\n+\n         return tb.createTopology();\n     }\n \n+    private void zkSpout(TopologyBuilder topologyBuilder) {", "originalCommit": "77fd5014fa6d34e8c16c5ee24e75b21a51ae44c4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d8e8bde5018f5743eaa44c0aca596d1b3c7fa61b", "url": "https://github.com/telstra/open-kilda/commit/d8e8bde5018f5743eaa44c0aca596d1b3c7fa61b", "message": "Zero Downtime for Flow HS", "committedDate": "2021-02-03T13:03:31Z", "type": "forcePushed"}, {"oid": "41b492754dcac9a42d8f82e51d74f696ca081cca", "url": "https://github.com/telstra/open-kilda/commit/41b492754dcac9a42d8f82e51d74f696ca081cca", "message": "Zero Downtime for Flow HS", "committedDate": "2021-02-04T16:16:26Z", "type": "commit"}, {"oid": "41b492754dcac9a42d8f82e51d74f696ca081cca", "url": "https://github.com/telstra/open-kilda/commit/41b492754dcac9a42d8f82e51d74f696ca081cca", "message": "Zero Downtime for Flow HS", "committedDate": "2021-02-04T16:16:26Z", "type": "forcePushed"}]}