{"pr_number": 5904, "pr_title": "6301 check reg ripper error logs and report any errors", "pr_createdAt": "2020-05-19T14:27:23Z", "pr_url": "https://github.com/sleuthkit/autopsy/pull/5904", "timeline": [{"oid": "50c7a80e79f9c86df5cedd760514821bd91994ea", "url": "https://github.com/sleuthkit/autopsy/commit/50c7a80e79f9c86df5cedd760514821bd91994ea", "message": "Read error logs and update plugins for errors\n\nRead error logs and update pluginks for errors.", "committedDate": "2020-05-14T13:05:20Z", "type": "commit"}, {"oid": "1612b219c1552cd2146744ff0ddf3ec92c0ac4a0", "url": "https://github.com/sleuthkit/autopsy/commit/1612b219c1552cd2146744ff0ddf3ec92c0ac4a0", "message": "Error checking for regripper plugins\n\nError checking for regripper plugins", "committedDate": "2020-05-19T14:11:30Z", "type": "commit"}, {"oid": "e70b72913996d68680119ba4bd20f4fede92db19", "url": "https://github.com/sleuthkit/autopsy/commit/e70b72913996d68680119ba4bd20f4fede92db19", "message": "Merge branch '6300-Update-Regripper-modules-to-current-version' into 6301-Check-RegRipper-error-logs-and-report-any-errors", "committedDate": "2020-05-19T19:08:37Z", "type": "commit"}, {"oid": "aa21dd279636d1c13d5c9132a64424a52de09c70", "url": "https://github.com/sleuthkit/autopsy/commit/aa21dd279636d1c13d5c9132a64424a52de09c70", "message": "Merge remote-tracking branch 'upstream/develop' into 6301-Check-RegRipper-error-logs-and-report-any-errors", "committedDate": "2020-05-21T19:14:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2ODYxNg==", "url": "https://github.com/sleuthkit/autopsy/pull/5904#discussion_r429368616", "bodyText": "Are these and the changes in all other .pl files still part of the upgrade or are these yours?", "author": "dannysmyda", "createdAt": "2020-05-22T17:25:42Z", "path": "thirdparty/rr-full/plugins/eventlogs.pl", "diffHunk": "@@ -57,9 +57,11 @@ sub pluginmain {\n \t\t\t::rptMsg($win_path);\n \t\t\t::rptMsg(\"LastWrite Time \".gmtime($win->get_timestamp()).\" (UTC)\");\n \t\t\tmy $cn;\n-\t\t\tif ($cn = $win->get_value(\"ComputerName\")->get_data()) {\n-\t\t\t\t::rptMsg(\"ComputerName = \".$cn);\t\t\t\t\n-\t\t\t}\n+            if (defined($win->get_value(\"ComputerName\"))) {", "originalCommit": "aa21dd279636d1c13d5c9132a64424a52de09c70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ1MjQ3Nw==", "url": "https://github.com/sleuthkit/autopsy/pull/5904#discussion_r430452477", "bodyText": "These changes are fixes to undefined values that cause an error in the plugin and it will not completely execute.  These are separate from the upgrade PR.", "author": "markmckinnon", "createdAt": "2020-05-26T14:24:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2ODYxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA3MTY5Ng==", "url": "https://github.com/sleuthkit/autopsy/pull/5904#discussion_r439071696", "bodyText": "Okay, should these changes also be submitted to the RegRipper project? Reason I ask is that if we ever upgrade again these changes will get lost.", "author": "dannysmyda", "createdAt": "2020-06-11T21:08:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2ODYxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE3NDcxNw==", "url": "https://github.com/sleuthkit/autopsy/pull/5904#discussion_r439174717", "bodyText": "Regripper 2.8 is no longer being supported as of 5/28/2020 according to this http://windowsir.blogspot.com/2020/05/regripper-v30.html so adding a PR to it will never happen as this is end of life for this version we are using.", "author": "markmckinnon", "createdAt": "2020-06-12T02:31:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2ODYxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2OTU5Nw==", "url": "https://github.com/sleuthkit/autopsy/pull/5904#discussion_r429369597", "bodyText": "Would it be worth also sending a notification to the user to let them know? Or is the fact that we are running regripper not explicitly stated in the Recent Activity module description?", "author": "dannysmyda", "createdAt": "2020-05-22T17:27:51Z", "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/ExtractRegistry.java", "diffHunk": "@@ -418,10 +418,31 @@ private RegOutputFiles ripRegistryFile(String regFilePath, String outFilePathBas\n             String errFilePath = outFilePathBase + \"-full.err.txt\"; //NON-NLS\n             logger.log(Level.INFO, \"Writing Full RegRipper results to: {0}\", regOutputFiles.fullPlugins); //NON-NLS\n             executeRegRipper(rrFullCmd, rrFullHome, regFilePath, fullType, regOutputFiles.fullPlugins, errFilePath);\n+            try {\n+                scanErrorLogs(errFilePath);\n+            } catch (IOException ex) {\n+            logger.log(Level.SEVERE, \"Unable to run RegRipper\", ex); //NON-NLS\n+            this.addErrorMessage(NbBundle.getMessage(this.getClass(), \"ExtractRegistry.execRegRip.errMsg.failedAnalyzeRegFile\", this.getName()));\n+        } \n         }\n         return regOutputFiles;\n     }\n \n+    private void scanErrorLogs(String errFilePath) throws IOException {\n+        File regfile = new File(errFilePath);\n+        try (BufferedReader reader = new BufferedReader(new FileReader(regfile))) {\n+            String line = reader.readLine();\n+            while (line != null) {\n+                line = line.trim();\n+                if (line.contains(\"Error\") || line.contains(\"@INC\")) {\n+                   logger.log(Level.WARNING, \"Regripper file {0} contains errors from run\", errFilePath); //NON-NLS", "originalCommit": "aa21dd279636d1c13d5c9132a64424a52de09c70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMwMzM1Ng==", "url": "https://github.com/sleuthkit/autopsy/pull/5904#discussion_r431303356", "bodyText": "I just put the warning in the log for debugging purposes if needed. Since not all plugins are parsed in Autopsy this will log the plugins that actually get an error that autopsy may not use.", "author": "markmckinnon", "createdAt": "2020-05-27T17:04:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2OTU5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA4OTI1NQ==", "url": "https://github.com/sleuthkit/autopsy/pull/5904#discussion_r439089255", "bodyText": "Okay, last thing, could we make the string checking case insensitive?", "author": "dannysmyda", "createdAt": "2020-06-11T21:49:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2OTU5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQyMjUxNQ==", "url": "https://github.com/sleuthkit/autopsy/pull/5904#discussion_r439422515", "bodyText": "changed to check to for case insensitive, good catch.", "author": "markmckinnon", "createdAt": "2020-06-12T13:36:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2OTU5Nw=="}], "type": "inlineReview"}, {"oid": "72242c5e9b94be73b4480c85cc69c13e6b695592", "url": "https://github.com/sleuthkit/autopsy/commit/72242c5e9b94be73b4480c85cc69c13e6b695592", "message": "Update ExtractRegistry.java\n\nChange contains to also ccheck only for lower case as well", "committedDate": "2020-06-12T13:35:53Z", "type": "commit"}]}