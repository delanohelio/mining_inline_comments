{"pr_number": 1283, "pr_title": "Fix checkstyle issues", "pr_createdAt": "2020-01-03T12:02:48Z", "pr_url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1283", "timeline": [{"oid": "29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "message": "Fix checkstyle issues", "committedDate": "2020-01-03T12:24:40Z", "type": "commit"}, {"oid": "29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "message": "Fix checkstyle issues", "committedDate": "2020-01-03T12:24:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE2MjY4MQ==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1283#discussion_r363162681", "bodyText": "Shall we add a colon : before the user parameter?", "author": "tharindu-bandara", "createdAt": "2020-01-06T05:29:00Z", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/OAuthAdminServiceImpl.java", "diffHunk": "@@ -97,8 +98,8 @@\n \n         String loggedInUser = CarbonContext.getThreadLocalCarbonContext().getUsername();\n \n-        if (log.isDebugEnabled()) {\n-            log.debug(\"Adding a consumer secret for the logged in user \" + loggedInUser);\n+        if (LOG.isDebugEnabled()) {\n+            LOG.debug(\"Adding a consumer secret for the logged in user \" + loggedInUser);", "originalCommit": "29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE2MzEzNA==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1283#discussion_r363163134", "bodyText": "Shall we add a colon before the parameters?", "author": "tharindu-bandara", "createdAt": "2020-01-06T05:32:30Z", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/OAuthAdminServiceImpl.java", "diffHunk": "@@ -887,52 +889,52 @@ public OAuthRevocationResponseDTO revokeAuthzForAppsByResourceOwner(\n                             OAuthUtil.clearOAuthCache(accessTokenDO.getConsumerKey(), authzUser,\n                                     buildScopeString(accessTokenDO.getScope()), tokenBindingReference);\n                             OAuthUtil.clearOAuthCache(accessTokenDO.getConsumerKey(), authzUser,\n-                                                      buildScopeString(accessTokenDO.getScope()));\n+                                    buildScopeString(accessTokenDO.getScope()));\n                             OAuthUtil.clearOAuthCache(accessTokenDO.getConsumerKey(), authzUser);\n                             OAuthUtil.clearOAuthCache(accessTokenDO.getAccessToken());\n                             AccessTokenDO scopedToken;\n                             try {\n                                 // Retrieve latest access token for particular client, user and scope combination if\n                                 // its ACTIVE or EXPIRED.\n                                 scopedToken = OAuthTokenPersistenceFactory.getInstance().getAccessTokenDAO()\n-                                                                          .getLatestAccessToken(\n-                                                                                  appDTO.getOauthConsumerKey(), user,\n-                                                                                  userStoreDomain,\n-                                                                                  buildScopeString(\n-                                                                                          accessTokenDO.getScope()),\n-                                                                                  true);\n+                                        .getLatestAccessToken(\n+                                                appDTO.getOauthConsumerKey(), user,\n+                                                userStoreDomain,\n+                                                buildScopeString(\n+                                                        accessTokenDO.getScope()),\n+                                                true);\n                             } catch (IdentityOAuth2Exception e) {\n                                 String errorMsg = \"Error occurred while retrieving latest \" +\n-                                                  \"access token issued for Client ID : \" +\n-                                                  appDTO.getOauthConsumerKey() + \", User ID : \" + userName +\n-                                                  \" and Scope : \" + buildScopeString(accessTokenDO.getScope());\n+                                        \"access token issued for Client ID : \" +\n+                                        appDTO.getOauthConsumerKey() + \", User ID : \" + userName +\n+                                        \" and Scope : \" + buildScopeString(accessTokenDO.getScope());\n                                 throw handleError(errorMsg, e);\n                             }\n                             if (scopedToken != null) {\n                                 //Revoking token from database\n                                 try {\n                                     OAuthTokenPersistenceFactory.getInstance().getAccessTokenDAO()\n-                                                                .revokeAccessTokens(new String[]{scopedToken\n-                                                                        .getAccessToken()});\n+                                            .revokeAccessTokens(new String[]{scopedToken\n+                                                    .getAccessToken()});\n                                 } catch (IdentityOAuth2Exception e) {\n                                     String errorMsg = \"Error occurred while revoking \" + \"Access Token : \" +\n-                                                      scopedToken.getAccessToken();\n+                                            scopedToken.getAccessToken();\n                                     throw handleError(errorMsg, e);\n                                 }\n                                 //Revoking the oauth consent from database.\n                                 try {\n                                     OAuthTokenPersistenceFactory.getInstance().getTokenManagementDAO()\n-                                            .revokeOAuthConsentByApplicationAndUser((\n-                                                    (AuthenticatedUser) authzUser).getAuthenticatedSubjectIdentifier(),\n-                                                                                    tenantDomain, appName);\n+                                            .revokeOAuthConsentByApplicationAndUser(\n+                                                    authzUser.getAuthenticatedSubjectIdentifier(),\n+                                                    tenantDomain, appName);\n                                 } catch (IdentityOAuth2Exception e) {\n                                     String errorMsg = \"Error occurred while removing OAuth Consent of Application \" +\n-                                                      appName + \" of user \" + userName;\n+                                            appName + \" of user \" + userName;", "originalCommit": "29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE2Mzc4OA==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1283#discussion_r363163788", "bodyText": "Space at the end of the log might not be required.", "author": "tharindu-bandara", "createdAt": "2020-01-06T05:37:07Z", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/OAuthAdminServiceImpl.java", "diffHunk": "@@ -998,16 +1000,16 @@ void triggerPostRevokeListeners(OAuthRevocationRequestDTO revokeRequestDTO,\n                                     OAuthRevocationResponseDTO revokeRespDTO, AccessTokenDO[] accessTokenDOs) {\n \n         OAuthEventInterceptor oAuthEventInterceptorProxy = OAuthComponentServiceHolder.getInstance()\n-                                                                                      .getOAuthEventInterceptorProxy();\n+                .getOAuthEventInterceptorProxy();\n \n         for (AccessTokenDO accessTokenDO : accessTokenDOs) {\n             if (oAuthEventInterceptorProxy != null && oAuthEventInterceptorProxy.isEnabled()) {\n                 try {\n                     Map<String, Object> paramMap = new HashMap<String, Object>();\n                     oAuthEventInterceptorProxy.onPostTokenRevocationByResourceOwner(revokeRequestDTO, revokeRespDTO,\n-                                                                                    accessTokenDO, paramMap);\n+                            accessTokenDO, paramMap);\n                 } catch (IdentityOAuth2Exception e) {\n-                    log.error(\"Error occurred with post revocation listener \", e);\n+                    LOG.error(\"Error occurred with post revocation listener \", e);", "originalCommit": "29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE2MzkyNA==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1283#discussion_r363163924", "bodyText": "Shall we add a colon before the token type parameter?", "author": "tharindu-bandara", "createdAt": "2020-01-06T05:38:07Z", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/OAuthAdminServiceImpl.java", "diffHunk": "@@ -1137,36 +1140,36 @@ void validateTokenExpiryConfigurations(OAuthConsumerAppDTO oAuthConsumerAppDTO)\n             oAuthConsumerAppDTO.setUserAccessTokenExpiryTime(\n                     OAuthServerConfiguration.getInstance().getUserAccessTokenValidityPeriodInSeconds());\n             logOnInvalidConfig(oAuthConsumerAppDTO.getApplicationName(), \"user access token\",\n-                               oAuthConsumerAppDTO.getUserAccessTokenExpiryTime());\n+                    oAuthConsumerAppDTO.getUserAccessTokenExpiryTime());\n         }\n \n         if (oAuthConsumerAppDTO.getApplicationAccessTokenExpiryTime() == 0) {\n             oAuthConsumerAppDTO.setApplicationAccessTokenExpiryTime(\n                     OAuthServerConfiguration.getInstance().getApplicationAccessTokenValidityPeriodInSeconds());\n             logOnInvalidConfig(oAuthConsumerAppDTO.getApplicationName(), \"application access token\",\n-                               oAuthConsumerAppDTO.getApplicationAccessTokenExpiryTime());\n+                    oAuthConsumerAppDTO.getApplicationAccessTokenExpiryTime());\n         }\n \n         if (oAuthConsumerAppDTO.getRefreshTokenExpiryTime() == 0) {\n             oAuthConsumerAppDTO.setRefreshTokenExpiryTime(\n                     OAuthServerConfiguration.getInstance().getRefreshTokenValidityPeriodInSeconds());\n             logOnInvalidConfig(oAuthConsumerAppDTO.getApplicationName(), \"refresh token\",\n-                               oAuthConsumerAppDTO.getRefreshTokenExpiryTime());\n+                    oAuthConsumerAppDTO.getRefreshTokenExpiryTime());\n         }\n \n         if (oAuthConsumerAppDTO.getIdTokenExpiryTime() == 0) {\n             oAuthConsumerAppDTO.setIdTokenExpiryTime(\n                     OAuthServerConfiguration.getInstance().getOpenIDConnectIDTokenExpiryTimeInSeconds());\n             logOnInvalidConfig(oAuthConsumerAppDTO.getApplicationName(), \"id token\",\n-                               oAuthConsumerAppDTO.getIdTokenExpiryTime());\n+                    oAuthConsumerAppDTO.getIdTokenExpiryTime());\n         }\n     }\n \n     void logOnInvalidConfig(String appName, String tokenType, long defaultValue) {\n \n-        if (log.isDebugEnabled()) {\n-            log.debug(\"Invalid expiry time value '0' set for \" + tokenType + \" in ServiceProvider: \" + appName + \". \"\n-                      + \"Defaulting to expiry value: \" + defaultValue + \" seconds.\");\n+        if (LOG.isDebugEnabled()) {\n+            LOG.debug(\"Invalid expiry time value '0' set for \" + tokenType + \" in ServiceProvider: \" + appName + \". \"", "originalCommit": "29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE2NDkxNg==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1283#discussion_r363164916", "bodyText": "Shall we add the full stop for the debug messages?", "author": "pamodaaw", "createdAt": "2020-01-06T05:43:56Z", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/OAuthAdminServiceImpl.java", "diffHunk": "@@ -122,8 +123,8 @@\n \n         if (userName == null) {\n             String msg = \"User not logged in to get all registered OAuth Applications\";", "originalCommit": "29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE2NTg3OA==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1283#discussion_r363165878", "bodyText": "Can't these two lines be combined?", "author": "pamodaaw", "createdAt": "2020-01-06T05:50:23Z", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/OAuthAdminServiceImpl.java", "diffHunk": "@@ -700,36 +701,36 @@ void updateAppAndRevokeTokensAndAuthzCodes(String consumerKey,\n                     cacheKeyString = consumerKey + \":\" + authorizedUser + \":\" + scope + \":\" + authenticatedIDP;\n                 } else {\n                     cacheKeyString = consumerKey + \":\" + authorizedUser.toLowerCase() + \":\" + scope + \":\"\n-                                     + authenticatedIDP;\n+                            + authenticatedIDP;\n                 }\n                 OAuthCacheKey cacheKeyUser = new OAuthCacheKey(cacheKeyString);\n                 OAuthCache.getInstance().clearCacheEntry(cacheKeyUser);\n             }\n \n-            if (log.isDebugEnabled()) {\n-                log.debug(\"Access tokens and token of users are removed from the cache for OAuth App with \" +\n-                          \"consumerKey: \" + consumerKey);\n+            if (LOG.isDebugEnabled()) {\n+                LOG.debug(\"Access tokens and token of users are removed from the cache for OAuth App with \" +\n+                        \"consumerKey: \" + consumerKey);\n             }\n \n             Set<String> authorizationCodes = OAuthTokenPersistenceFactory.getInstance().getAuthorizationCodeDAO()\n-                                                                         .getActiveAuthorizationCodesByConsumerKey\n-                                                                                 (consumerKey);\n+                    .getActiveAuthorizationCodesByConsumerKey\n+                            (consumerKey);", "originalCommit": "29b087e150eddf3a94c4c4a7e8aa97c362b772b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "79c5215a8ded08479712a7fefce1ee9b14a7e320", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/79c5215a8ded08479712a7fefce1ee9b14a7e320", "message": "Fix PR comments", "committedDate": "2020-01-06T06:18:00Z", "type": "commit"}, {"oid": "79c5215a8ded08479712a7fefce1ee9b14a7e320", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/79c5215a8ded08479712a7fefce1ee9b14a7e320", "message": "Fix PR comments", "committedDate": "2020-01-06T06:18:00Z", "type": "forcePushed"}, {"oid": "5a9ed3c5454bd5f4c2966ace459d86bb835c757e", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/5a9ed3c5454bd5f4c2966ace459d86bb835c757e", "message": "Fix test failure", "committedDate": "2020-01-06T06:35:27Z", "type": "commit"}]}