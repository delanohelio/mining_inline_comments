{"pr_number": 1216, "pr_title": "test: set up objc unit tests", "pr_createdAt": "2020-12-18T20:41:05Z", "pr_url": "https://github.com/envoyproxy/envoy-mobile/pull/1216", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA5NDg2MA==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1216#discussion_r546094860", "bodyText": "Guessing the reason this doesn't work is because you need an ios_unit_test like we have here: \n  \n    \n      envoy-mobile/bazel/swift_test.bzl\n    \n    \n        Lines 32 to 36\n      in\n      0774f4d\n    \n    \n    \n    \n\n        \n          \n           ios_unit_test( \n        \n\n        \n          \n               name = name, \n        \n\n        \n          \n               deps = [test_lib_name], \n        \n\n        \n          \n               minimum_os_version = \"11.0\", \n        \n\n        \n          \n           )", "author": "rebello95", "createdAt": "2020-12-18T21:17:11Z", "path": "library/objective-c/test/BUILD", "diffHunk": "@@ -0,0 +1,13 @@\n+load(\"@rules_cc//cc:defs.bzl\", \"objc_library\")\n+\n+licenses([\"notice\"])  # Apache 2\n+\n+objc_library(", "originalCommit": "34782335a3d80d21555dda8f4312c1b7266a8de6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NDAxODE3OQ==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1216#discussion_r584018179", "bodyText": "yep, for sure this won't run tests w/o it", "author": "keith", "createdAt": "2021-02-27T01:57:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA5NDg2MA=="}], "type": "inlineReview"}, {"oid": "5a3e117fb4dbf6b8b03c4588ad3603b287cdec2a", "url": "https://github.com/envoyproxy/envoy-mobile/commit/5a3e117fb4dbf6b8b03c4588ad3603b287cdec2a", "message": "test: set up objc unit tests\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2021-05-05T09:02:57Z", "type": "commit"}, {"oid": "c987c39098e110caff8f41728bc8ea0c758e017b", "url": "https://github.com/envoyproxy/envoy-mobile/commit/c987c39098e110caff8f41728bc8ea0c758e017b", "message": "tweak build settings, add passing test\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2021-05-05T11:31:59Z", "type": "commit"}, {"oid": "c987c39098e110caff8f41728bc8ea0c758e017b", "url": "https://github.com/envoyproxy/envoy-mobile/commit/c987c39098e110caff8f41728bc8ea0c758e017b", "message": "tweak build settings, add passing test\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2021-05-05T11:31:59Z", "type": "forcePushed"}, {"oid": "07be70c3d994996e8c263e0c0a46887694b93f0d", "url": "https://github.com/envoyproxy/envoy-mobile/commit/07be70c3d994996e8c263e0c0a46887694b93f0d", "message": "fix format\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2021-05-12T10:07:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMTMyNTIxNg==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1216#discussion_r631325216", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              XCTAssertTrue(memcmp(nativeData.bytes, testData.bytes, 3) == 0);\n          \n          \n            \n              XCTAssertEqual(memcmp(nativeData.bytes, testData.bytes, 3), 0);", "author": "rebello95", "createdAt": "2021-05-12T19:03:19Z", "path": "test/objective-c/EnvoyBridgeUtilityTest.m", "diffHunk": "@@ -0,0 +1,29 @@\n+#import <XCTest/XCTest.h>\n+\n+typedef NSDictionary<NSString *, NSArray<NSString *> *> EnvoyHeaders;\n+\n+typedef NSDictionary<NSString *, NSString *> EnvoyTags;\n+\n+#import \"library/objective-c/EnvoyBridgeUtility.h\"\n+\n+@interface EnvoyBridgeUtilityTest : XCTestCase\n+@end\n+\n+@implementation EnvoyBridgeUtilityTest\n+\n+- (void)setUp {\n+  [super setUp];\n+}\n+\n+- (void)tearDown {\n+  [super tearDown];\n+}\n+\n+- (void)testToNativeData {\n+  NSString *testString = @\"abc\";\n+  NSData *testData = [testString dataUsingEncoding:NSUTF8StringEncoding];\n+  envoy_data nativeData = toNativeData(testData);\n+  XCTAssertTrue(memcmp(nativeData.bytes, testData.bytes, 3) == 0);", "originalCommit": "07be70c3d994996e8c263e0c0a46887694b93f0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMTMyNTM1OA==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1216#discussion_r631325358", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - (void)setUp {\n          \n          \n            \n              [super setUp];\n          \n          \n            \n            }\n          \n          \n            \n            \n          \n          \n            \n            - (void)tearDown {\n          \n          \n            \n              [super tearDown];\n          \n          \n            \n            }", "author": "rebello95", "createdAt": "2021-05-12T19:03:33Z", "path": "test/objective-c/EnvoyBridgeUtilityTest.m", "diffHunk": "@@ -0,0 +1,29 @@\n+#import <XCTest/XCTest.h>\n+\n+typedef NSDictionary<NSString *, NSArray<NSString *> *> EnvoyHeaders;\n+\n+typedef NSDictionary<NSString *, NSString *> EnvoyTags;\n+\n+#import \"library/objective-c/EnvoyBridgeUtility.h\"\n+\n+@interface EnvoyBridgeUtilityTest : XCTestCase\n+@end\n+\n+@implementation EnvoyBridgeUtilityTest\n+\n+- (void)setUp {\n+  [super setUp];\n+}\n+\n+- (void)tearDown {\n+  [super tearDown];\n+}\n+", "originalCommit": "07be70c3d994996e8c263e0c0a46887694b93f0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMTMyNTU1Mw==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1216#discussion_r631325553", "bodyText": "Are these necessary?", "author": "rebello95", "createdAt": "2021-05-12T19:03:50Z", "path": "test/objective-c/EnvoyBridgeUtilityTest.m", "diffHunk": "@@ -0,0 +1,29 @@\n+#import <XCTest/XCTest.h>\n+\n+typedef NSDictionary<NSString *, NSArray<NSString *> *> EnvoyHeaders;\n+\n+typedef NSDictionary<NSString *, NSString *> EnvoyTags;", "originalCommit": "07be70c3d994996e8c263e0c0a46887694b93f0d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMTMzMjM4Ng==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1216#discussion_r631332386", "bodyText": "They are, unfortunately; this is a side effect of the bridge header issue.", "author": "goaway", "createdAt": "2021-05-12T19:15:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMTMyNTU1Mw=="}], "type": "inlineReview"}, {"oid": "bf5252ad75558b8f1de8659d999850746663e919", "url": "https://github.com/envoyproxy/envoy-mobile/commit/bf5252ad75558b8f1de8659d999850746663e919", "message": "updates for comments\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2021-05-12T19:16:14Z", "type": "commit"}]}