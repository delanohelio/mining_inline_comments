{"pr_number": 1218, "pr_title": "python: implement stream-related classes", "pr_createdAt": "2020-12-18T22:33:07Z", "pr_url": "https://github.com/envoyproxy/envoy-mobile/pull/1218", "timeline": [{"oid": "c769cb86d722ba8db0bd79fea950ab4d44ffb6e5", "url": "https://github.com/envoyproxy/envoy-mobile/commit/c769cb86d722ba8db0bd79fea950ab4d44ffb6e5", "message": "impl stream\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>", "committedDate": "2021-01-06T19:16:24Z", "type": "commit"}, {"oid": "49f5c5f11af63b95ff242f261102abc89a338f6b", "url": "https://github.com/envoyproxy/envoy-mobile/commit/49f5c5f11af63b95ff242f261102abc89a338f6b", "message": "lib changes\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>", "committedDate": "2021-01-06T19:26:49Z", "type": "commit"}, {"oid": "7405637c00e9956ac072af9f45d2b2a42cedbacc", "url": "https://github.com/envoyproxy/envoy-mobile/commit/7405637c00e9956ac072af9f45d2b2a42cedbacc", "message": "implement relevant shims\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>", "committedDate": "2021-01-06T19:35:25Z", "type": "commit"}, {"oid": "3f2aafe0e37d6347fd53aefba7d35784688f7078", "url": "https://github.com/envoyproxy/envoy-mobile/commit/3f2aafe0e37d6347fd53aefba7d35784688f7078", "message": "add shims for the rest of the callbacks so we can assume GIL\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>", "committedDate": "2021-01-06T20:09:44Z", "type": "commit"}, {"oid": "3f2aafe0e37d6347fd53aefba7d35784688f7078", "url": "https://github.com/envoyproxy/envoy-mobile/commit/3f2aafe0e37d6347fd53aefba7d35784688f7078", "message": "add shims for the rest of the callbacks so we can assume GIL\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>", "committedDate": "2021-01-06T20:09:44Z", "type": "forcePushed"}, {"oid": "569912781d2bd4b20415c906694eb42013d7bd38", "url": "https://github.com/envoyproxy/envoy-mobile/commit/569912781d2bd4b20415c906694eb42013d7bd38", "message": "Merge branch 'main' of github.com:envoyproxy/envoy-mobile into ch/python-stream-impl\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>", "committedDate": "2021-01-08T15:42:25Z", "type": "commit"}, {"oid": "48fb7229e98ef6b6970a64c01b9357f8434c541d", "url": "https://github.com/envoyproxy/envoy-mobile/commit/48fb7229e98ef6b6970a64c01b9357f8434c541d", "message": "move closure defn to a template\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>", "committedDate": "2021-01-11T14:30:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk3OTA3OA==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1218#discussion_r555979078", "bodyText": "Envoy style is for all instance methods to be camelCase.", "author": "goaway", "createdAt": "2021-01-12T18:17:41Z", "path": "library/cc/stream.cc", "diffHunk": "@@ -0,0 +1,37 @@\n+#include \"stream.h\"\n+\n+#include <iostream>\n+\n+#include \"bridge_utility.h\"\n+#include \"library/common/main_interface.h\"\n+#include \"library/common/types/c_types.h\"\n+\n+namespace Envoy {\n+namespace Platform {\n+\n+Stream::Stream(envoy_stream_t handle, EnvoyHttpCallbacksAdapterSharedPtr adapter)\n+    : handle_(handle), adapter_(adapter) {}\n+\n+Stream& Stream::send_headers(RequestHeadersSharedPtr headers, bool end_stream) {", "originalCommit": "48fb7229e98ef6b6970a64c01b9357f8434c541d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk4MDAwMA==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1218#discussion_r555980000", "bodyText": "Let's worry about this later though, I'm going to approve and merge.", "author": "goaway", "createdAt": "2021-01-12T18:19:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk3OTA3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk3OTMzOQ==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1218#discussion_r555979339", "bodyText": "These though I think we can leave as snake_case to distinguish them", "author": "goaway", "createdAt": "2021-01-12T18:18:06Z", "path": "library/cc/stream_callbacks.cc", "diffHunk": "@@ -0,0 +1,96 @@\n+#include \"stream_callbacks.h\"\n+\n+#include \"bridge_utility.h\"\n+#include \"response_headers_builder.h\"\n+#include \"response_trailers_builder.h\"\n+\n+namespace Envoy {\n+namespace Platform {\n+\n+EnvoyHttpCallbacksAdapter::EnvoyHttpCallbacksAdapter(StreamCallbacksSharedPtr callbacks)\n+    : stream_callbacks_(callbacks) {}\n+\n+envoy_http_callbacks EnvoyHttpCallbacksAdapter::as_envoy_http_callbacks() {\n+  envoy_http_callbacks callbacks{\n+      .on_headers = &EnvoyHttpCallbacksAdapter::c_on_headers,\n+      .on_data = &EnvoyHttpCallbacksAdapter::c_on_data,\n+      // on_metadata is not used\n+      .on_trailers = &EnvoyHttpCallbacksAdapter::c_on_trailers,\n+      .on_error = &EnvoyHttpCallbacksAdapter::c_on_error,\n+      .on_complete = &EnvoyHttpCallbacksAdapter::c_on_complete,\n+      .on_cancel = &EnvoyHttpCallbacksAdapter::c_on_cancel,\n+      .context = this,\n+  };\n+  return callbacks;\n+}\n+\n+void* EnvoyHttpCallbacksAdapter::c_on_headers(envoy_headers headers, bool end_stream,", "originalCommit": "48fb7229e98ef6b6970a64c01b9357f8434c541d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}