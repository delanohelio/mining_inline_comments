{"pr_number": 1143, "pr_title": "java: add Android and Java async filter callback support", "pr_createdAt": "2020-10-21T10:40:38Z", "pr_url": "https://github.com/envoyproxy/envoy-mobile/pull/1143", "timeline": [{"oid": "8fd72cc02ae82dc10f8a4c7a5e0b4d4a6fbbd9b6", "url": "https://github.com/envoyproxy/envoy-mobile/commit/8fd72cc02ae82dc10f8a4c7a5e0b4d4a6fbbd9b6", "message": "wiring\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2020-10-22T11:06:45Z", "type": "forcePushed"}, {"oid": "34d29fa9905b18c435c8d5b281492f846d676dd3", "url": "https://github.com/envoyproxy/envoy-mobile/commit/34d29fa9905b18c435c8d5b281492f846d676dd3", "message": "java: add Android/Java async filter callback support\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2020-10-22T12:06:16Z", "type": "forcePushed"}, {"oid": "a6217188749d6335dc23b57b9f4fd4274525944d", "url": "https://github.com/envoyproxy/envoy-mobile/commit/a6217188749d6335dc23b57b9f4fd4274525944d", "message": "java: add Android/Java async filter callback support\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2020-10-22T12:13:50Z", "type": "commit"}, {"oid": "42d5a6d3e82c14a7fd88d0eb9857830e31600596", "url": "https://github.com/envoyproxy/envoy-mobile/commit/42d5a6d3e82c14a7fd88d0eb9857830e31600596", "message": "format\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2020-10-22T12:13:50Z", "type": "commit"}, {"oid": "42d5a6d3e82c14a7fd88d0eb9857830e31600596", "url": "https://github.com/envoyproxy/envoy-mobile/commit/42d5a6d3e82c14a7fd88d0eb9857830e31600596", "message": "format\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2020-10-22T12:13:50Z", "type": "forcePushed"}, {"oid": "68cbf96f188ef90fd45a3f0421d7fb757d52db6d", "url": "https://github.com/envoyproxy/envoy-mobile/commit/68cbf96f188ef90fd45a3f0421d7fb757d52db6d", "message": "kotlin format\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2020-10-22T12:15:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMwOTA3OA==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1143#discussion_r510309078", "bodyText": "I might have my rules mixed up but do we need to delete this local ref here?", "author": "buildbreaker", "createdAt": "2020-10-22T16:44:51Z", "path": "library/common/jni/jni_interface.cc", "diffHunk": "@@ -362,6 +363,122 @@ static envoy_filter_trailers_status jvm_http_filter_on_response_trailers(envoy_h\n                                         /*trailers*/ native_headers};\n }\n \n+static void jvm_http_filter_set_request_callbacks(envoy_http_filter_callbacks callbacks,\n+                                                  const void* context) {\n+\n+  __android_log_write(ANDROID_LOG_VERBOSE, \"[Envoy]\", \"jvm_http_filter_set_request_callbacks\");\n+\n+  JNIEnv* env = get_env();\n+  jobject j_context = static_cast<jobject>(const_cast<void*>(context));", "originalCommit": "68cbf96f188ef90fd45a3f0421d7fb757d52db6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDM5NDE3Nw==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1143#discussion_r510394177", "bodyText": "Yep, great catch. In a separate branch I started on last week, I'm adding caching to a bunch of the JNI refs, which in addition to being a noteworthy performance improvement, also reduces the number of locations we need to track refs like this and risk leaking.", "author": "goaway", "createdAt": "2020-10-22T19:08:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMwOTA3OA=="}], "type": "inlineReview"}, {"oid": "9584b4efe41c25c1612823fcfeda750b4eae243f", "url": "https://github.com/envoyproxy/envoy-mobile/commit/9584b4efe41c25c1612823fcfeda750b4eae243f", "message": "add missing ref cleanup\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>", "committedDate": "2020-10-22T19:22:35Z", "type": "commit"}]}