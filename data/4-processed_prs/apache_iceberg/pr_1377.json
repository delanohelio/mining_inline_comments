{"pr_number": 1377, "pr_title": "Flink: optimize the parquet writer getter method", "pr_createdAt": "2020-08-25T03:47:34Z", "pr_url": "https://github.com/apache/iceberg/pull/1377", "timeline": [{"oid": "226745dcd129c43fcf0b0048d6294c99fe71768a", "url": "https://github.com/apache/iceberg/commit/226745dcd129c43fcf0b0048d6294c99fe71768a", "message": "Flink: optimize the parquet writer getter method", "committedDate": "2020-08-25T03:44:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjEyODcwNQ==", "url": "https://github.com/apache/iceberg/pull/1377#discussion_r476128705", "bodyText": "The ArrayData interface only defines getElementOrNull.", "author": "chenjunjiedada", "createdAt": "2020-08-25T03:48:25Z", "path": "flink/src/main/java/org/apache/iceberg/flink/data/FlinkParquetWriters.java", "diffHunk": "@@ -424,13 +428,7 @@ public boolean hasNext() {\n           throw new NoSuchElementException();\n         }\n \n-        if (values.isNullAt(index)) {\n-          entry.set((K) ArrayData.createElementGetter(keyType).getElementOrNull(keys, index), null);\n-        } else {\n-          entry.set((K) ArrayData.createElementGetter(keyType).getElementOrNull(keys, index),\n-              (V) ArrayData.createElementGetter(valueType).getElementOrNull(values, index));\n-        }\n-\n+        entry.set((K) keyGetter.getElementOrNull(keys, index), (V) valueGetter.getElementOrNull(values, index));", "originalCommit": "226745dcd129c43fcf0b0048d6294c99fe71768a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}