{"pr_number": 925, "pr_title": "Move manifest factory methods", "pr_createdAt": "2020-04-15T19:45:07Z", "pr_url": "https://github.com/apache/iceberg/pull/925", "timeline": [{"oid": "dbb0c52dba461abdbe533271dce8189f370d7628", "url": "https://github.com/apache/iceberg/commit/dbb0c52dba461abdbe533271dce8189f370d7628", "message": "Move manifest factory methods to ManifestFiles.", "committedDate": "2020-04-15T22:07:02Z", "type": "commit"}, {"oid": "689c3709389cf5f124f2b19670f27c82ac84c6b7", "url": "https://github.com/apache/iceberg/commit/689c3709389cf5f124f2b19670f27c82ac84c6b7", "message": "Move copyManifest methods and add format version argument.", "committedDate": "2020-04-15T22:07:02Z", "type": "commit"}, {"oid": "72bd99d21840eb0f9c9367200f15301840221b33", "url": "https://github.com/apache/iceberg/commit/72bd99d21840eb0f9c9367200f15301840221b33", "message": "Fix tests added in #845.", "committedDate": "2020-04-15T22:08:03Z", "type": "commit"}, {"oid": "72bd99d21840eb0f9c9367200f15301840221b33", "url": "https://github.com/apache/iceberg/commit/72bd99d21840eb0f9c9367200f15301840221b33", "message": "Fix tests added in #845.", "committedDate": "2020-04-15T22:08:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3MDYwMQ==", "url": "https://github.com/apache/iceberg/pull/925#discussion_r409170601", "bodyText": "Do we want to deprecate this too?", "author": "aokolnychyi", "createdAt": "2020-04-15T22:27:22Z", "path": "core/src/main/java/org/apache/iceberg/ManifestWriter.java", "diffHunk": "@@ -94,15 +46,7 @@ static ManifestFile copyManifest(ManifestReader reader, OutputFile outputFile, l\n    * @return a manifest writer\n    */\n   public static ManifestWriter write(PartitionSpec spec, OutputFile outputFile) {", "originalCommit": "72bd99d21840eb0f9c9367200f15301840221b33", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3NzQ2Ng==", "url": "https://github.com/apache/iceberg/pull/925#discussion_r409177466", "bodyText": "Good catch. I've updated it.", "author": "rdblue", "createdAt": "2020-04-15T22:45:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3MDYwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3MTg0Nw==", "url": "https://github.com/apache/iceberg/pull/925#discussion_r409171847", "bodyText": "Why do we keep only this version for compatibility? I thought the one below was the preferred way. Would it make sense to keep both and mark them deprecated? Versions that accept ManifestFile were not released yet, so we should definitely remove those.", "author": "aokolnychyi", "createdAt": "2020-04-15T22:30:33Z", "path": "core/src/main/java/org/apache/iceberg/ManifestReader.java", "diffHunk": "@@ -62,63 +61,18 @@\n   /**\n    * Returns a new {@link ManifestReader} for an {@link InputFile}.\n    * <p>\n-   * <em>Note:</em> Most callers should use {@link #read(ManifestFile, FileIO, Map)} to ensure that\n+   * <em>Note:</em> Callers should use {@link ManifestFiles#read(ManifestFile, FileIO, Map)} to ensure that\n    * manifest entries with partial metadata can inherit missing properties from the manifest metadata.\n-   * <p>\n-   * <em>Note:</em> Most callers should use {@link #read(InputFile, Map)} if all manifest entries\n-   * contain full metadata and they want to ensure that the schema used by filters is the latest\n-   * table schema. This should be used only when reading a manifest without filters.\n    *\n    * @param file an InputFile\n    * @return a manifest reader\n+   * @deprecated use {@link ManifestFiles#read(ManifestFile, FileIO, Map)}.\n    */\n+  @Deprecated", "originalCommit": "72bd99d21840eb0f9c9367200f15301840221b33", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3NjM3MA==", "url": "https://github.com/apache/iceberg/pull/925#discussion_r409176370", "bodyText": "The version released in 0.7.0 was read(InputFile, Function) because we used to pass a function to look up a spec instead of a map. We could bring that back and deprecate it, but I think I'm fine with just deprecating this one. This is the one that I know people use.", "author": "rdblue", "createdAt": "2020-04-15T22:42:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3MTg0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3NzM1Mw==", "url": "https://github.com/apache/iceberg/pull/925#discussion_r409177353", "bodyText": "I think it makes sense for consistency. We were using it but we will have to adapt anyway.", "author": "aokolnychyi", "createdAt": "2020-04-15T22:44:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3MTg0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3NzY2OA==", "url": "https://github.com/apache/iceberg/pull/925#discussion_r409177668", "bodyText": "For us, it does not matter.", "author": "aokolnychyi", "createdAt": "2020-04-15T22:45:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3MTg0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3OTEyOQ==", "url": "https://github.com/apache/iceberg/pull/925#discussion_r409179129", "bodyText": "Nevermind, it was much easier than I thought to bring this back because we don't pass the map to any other class.", "author": "rdblue", "createdAt": "2020-04-15T22:49:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE3MTg0Nw=="}], "type": "inlineReview"}, {"oid": "c565af50ae9bbaffd59c3acd39b0335c099ad97a", "url": "https://github.com/apache/iceberg/commit/c565af50ae9bbaffd59c3acd39b0335c099ad97a", "message": "Deprecate ManifestWriter.write method.", "committedDate": "2020-04-15T22:44:40Z", "type": "commit"}, {"oid": "3ebeb7bce6e7201292f3acdb924c61b8cfc56de3", "url": "https://github.com/apache/iceberg/commit/3ebeb7bce6e7201292f3acdb924c61b8cfc56de3", "message": "Add old ManifestReader.read method and remove deprecated uses.", "committedDate": "2020-04-15T22:54:17Z", "type": "commit"}, {"oid": "ff8e18238534ad350b8f929d4e9bbfda9f5f7756", "url": "https://github.com/apache/iceberg/commit/ff8e18238534ad350b8f929d4e9bbfda9f5f7756", "message": "Fix tests.", "committedDate": "2020-04-15T23:34:11Z", "type": "commit"}]}