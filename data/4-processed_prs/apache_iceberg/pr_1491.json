{"pr_number": 1491, "pr_title": "[API][Core - Types/Avro][Parquet] Add a precondition null check for the constructor arg of PruneColumns", "pr_createdAt": "2020-09-23T10:31:09Z", "pr_url": "https://github.com/apache/iceberg/pull/1491", "timeline": [{"oid": "e99314ccec546dfc3ffba1ec1225a5689c9d249a", "url": "https://github.com/apache/iceberg/commit/e99314ccec546dfc3ffba1ec1225a5689c9d249a", "message": "Adds a not null check for the constructor argument of PruneColumns", "committedDate": "2020-09-23T10:19:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDUxMzQ5Ng==", "url": "https://github.com/apache/iceberg/pull/1491#discussion_r494513496", "bodyText": "Rather than just using the name of the variable, I think this should give more context to users when it happens. \"Field id set\" or \"Selected field ids\" would be better.", "author": "rdblue", "createdAt": "2020-09-24T18:09:27Z", "path": "api/src/main/java/org/apache/iceberg/types/PruneColumns.java", "diffHunk": "@@ -22,12 +22,14 @@\n import java.util.List;\n import java.util.Set;\n import org.apache.iceberg.Schema;\n+import org.apache.iceberg.relocated.com.google.common.base.Preconditions;\n import org.apache.iceberg.relocated.com.google.common.collect.Lists;\n \n class PruneColumns extends TypeUtil.SchemaVisitor<Type> {\n   private final Set<Integer> selected;\n \n   PruneColumns(Set<Integer> selected) {\n+    Preconditions.checkNotNull(selected, \"Selected cannot be null\");", "originalCommit": "e99314ccec546dfc3ffba1ec1225a5689c9d249a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUxODc0OA==", "url": "https://github.com/apache/iceberg/pull/1491#discussion_r495518748", "bodyText": "I agree with you on this. I was following what I thought was somewhat of a convention - what I should really refer to as something I've seen previously in the code base - of using the argument name directly. However, I also just today saw some instances that are definitely much more explicit.\nI will update to be Selected field ids as its inline with our definitions of Select and Project as well as it still contains the argument name in it. Please correct me if I'm incorrect about select vs project. @rdblue", "author": "kbendick", "createdAt": "2020-09-27T02:38:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDUxMzQ5Ng=="}], "type": "inlineReview"}, {"oid": "078d7066ef4935dc796646186dc6f349dacd6e94", "url": "https://github.com/apache/iceberg/commit/078d7066ef4935dc796646186dc6f349dacd6e94", "message": "Use more explicit language in message of added precondition check", "committedDate": "2020-09-27T02:43:32Z", "type": "commit"}, {"oid": "d805d403348221026b5f8eccbcc5fbfacfd0ff35", "url": "https://github.com/apache/iceberg/commit/d805d403348221026b5f8eccbcc5fbfacfd0ff35", "message": "Adds precondition checks to more classs named PruneColumns with same patterns using null", "committedDate": "2020-09-27T02:47:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUxOTgyOQ==", "url": "https://github.com/apache/iceberg/pull/1491#discussion_r495519829", "bodyText": "I will also check if nameMapping needs a precondition null check.", "author": "kbendick", "createdAt": "2020-09-27T02:52:50Z", "path": "core/src/main/java/org/apache/iceberg/avro/PruneColumns.java", "diffHunk": "@@ -39,6 +39,7 @@\n   private final NameMapping nameMapping;\n \n   PruneColumns(Set<Integer> selectedIds, NameMapping nameMapping) {\n+    Preconditions.checkNotNull(selectedIds, \"Selected field ids cannot be null\");", "originalCommit": "d805d403348221026b5f8eccbcc5fbfacfd0ff35", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e3eb6a7adc89ac4ffd750fa466695592f05aa49e", "url": "https://github.com/apache/iceberg/commit/e3eb6a7adc89ac4ffd750fa466695592f05aa49e", "message": "Adds in missing import for Preconditions", "committedDate": "2020-09-27T04:05:48Z", "type": "commit"}]}