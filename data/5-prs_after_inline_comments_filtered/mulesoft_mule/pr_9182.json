{"pr_number": 9182, "pr_title": "MULE-18609: Add record count/size of the streams to FlowConstructStatistics", "pr_createdAt": "2020-08-10T14:51:04Z", "pr_url": "https://github.com/mulesoft/mule/pull/9182", "timeline": [{"oid": "23b73447fd137f909f67bf5512f211b20ea93e6f", "url": "https://github.com/mulesoft/mule/commit/23b73447fd137f909f67bf5512f211b20ea93e6f", "message": "MULE-18609: Add record count/size of the streams to\nFlowConstructStatistics", "committedDate": "2020-08-06T16:08:05Z", "type": "commit"}, {"oid": "9766d91de66ae8c628cbc811091b362752111dd4", "url": "https://github.com/mulesoft/mule/commit/9766d91de66ae8c628cbc811091b362752111dd4", "message": "review", "committedDate": "2020-08-06T19:26:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODEzNDUzNQ==", "url": "https://github.com/mulesoft/mule/pull/9182#discussion_r468134535", "bodyText": "It should be better to receive a Component instead of a String and do the transformation (component.getLocation().getLocation()) inside this method to be consistent with computePayloadStatisticsIfAbsent", "author": "szaffarano", "createdAt": "2020-08-10T19:33:03Z", "path": "core/src/main/java/org/mule/runtime/core/api/management/stats/AllStatistics.java", "diffHunk": "@@ -86,4 +94,36 @@ public synchronized void remove(FlowConstructStatistics stat) {\n   public FlowConstructStatistics getApplicationStatistics() {\n     return appStats;\n   }\n+\n+  /**\n+   * @return the available payload statistics for all components.\n+   * @since 4.4, 4.3.1\n+   */\n+  public Collection<PayloadStatistics> getPayloadStatistics() {\n+    return payloadStatistics.values();\n+  }\n+\n+  /**\n+   * @param component the component to get the statistics for.\n+   * @return the statistics for the provided {@code component}.\n+   * @since 4.4, 4.3.1\n+   */\n+  public PayloadStatistics computePayloadStatisticsIfAbsent(Component component) {\n+    return payloadStatistics.computeIfAbsent(component.getLocation().getLocation(),\n+                                             loc -> {\n+                                               final PayloadStatistics statistics =\n+                                                   new PayloadStatistics(loc, component.getIdentifier().toString());\n+                                               statistics.setEnabled(isEnabled());\n+                                               return statistics;\n+                                             });\n+  }\n+\n+  /**\n+   * @param componentLocation the location of the component to get the statistics for.\n+   * @return the statistics for the component with the provided {@code componentLocation}.\n+   * @since 4.4, 4.3.1\n+   */\n+  public PayloadStatistics getPayloadStatistics(String componentLocation) {", "originalCommit": "9766d91de66ae8c628cbc811091b362752111dd4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODEzNjM0NA==", "url": "https://github.com/mulesoft/mule/pull/9182#discussion_r468136344", "bodyText": "This is on purpose, i don't need this method to be consistent because this method is to be used within ARM, and i don't want to force them to obtain a proper Component, when the may already know the location they want.", "author": "elrodro83", "createdAt": "2020-08-10T19:36:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODEzNDUzNQ=="}], "type": "inlineReview"}]}