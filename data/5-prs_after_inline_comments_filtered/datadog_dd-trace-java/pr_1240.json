{"pr_number": 1240, "pr_title": "Merge pull request #1240 from DataDog/tyler/executor-matcher-reorder", "pr_createdAt": "2020-02-20T19:35:28Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/1240", "timeline": [{"oid": "b80e9857d241bb25d3bf079517e1c5ede7ebd9db", "url": "https://github.com/DataDog/dd-trace-java/commit/b80e9857d241bb25d3bf079517e1c5ede7ebd9db", "message": "Reorder java-concurrent matchers\n\nMove the expensive matcher to last.\n\nIn theory this should help, but did not seem to make a significant difference in basic startup benchmarks.", "committedDate": "2020-02-20T19:34:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM1ODI2NQ==", "url": "https://github.com/DataDog/dd-trace-java/pull/1240#discussion_r382358265", "bodyText": "We might get a bit more from turning this into a string switch, but I suspect we've probably reached a point of diminishing returns.", "author": "dougqh", "createdAt": "2020-02-21T01:52:59Z", "path": "dd-java-agent/instrumentation/java-concurrent/src/main/java/datadog/trace/instrumentation/java/concurrent/AbstractExecutorInstrumentation.java", "diffHunk": "@@ -102,33 +102,34 @@ public AbstractExecutorInstrumentation(final String... additionalNames) {\n \n   @Override\n   public ElementMatcher<TypeDescription> typeMatcher() {\n-    final ElementMatcher.Junction<TypeDescription> matcher =\n-        not(isInterface()).and(safeHasInterface(named(Executor.class.getName())));\n-    if (TRACE_ALL_EXECUTORS) {\n-      return matcher;\n+    ElementMatcher.Junction<TypeDescription> matcher = not(isInterface());\n+    if (!TRACE_ALL_EXECUTORS) {\n+      matcher =\n+          matcher.and(\n+              new ElementMatcher<TypeDescription>() {\n+                @Override\n+                public boolean matches(final TypeDescription target) {\n+                  boolean whitelisted = WHITELISTED_EXECUTORS.contains(target.getName());", "originalCommit": "b80e9857d241bb25d3bf079517e1c5ede7ebd9db", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM1ODc0OQ==", "url": "https://github.com/DataDog/dd-trace-java/pull/1240#discussion_r382358749", "bodyText": "Let's consider that in the future.", "author": "tylerbenson", "createdAt": "2020-02-21T01:55:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM1ODI2NQ=="}], "type": "inlineReview"}]}