{"pr_number": 1350, "pr_title": "Add fix suggestion when JFR API not found", "pr_createdAt": "2020-04-03T18:03:26Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/1350", "timeline": [{"oid": "343a77d6190d687a97c1d45f4c73a1540af0e85a", "url": "https://github.com/DataDog/dd-trace-java/commit/343a77d6190d687a97c1d45f4c73a1540af0e85a", "message": "Add fix suggestion when JFR API not found\n\nsuggests to use zulu 1.8u212 at least which include JFR or OpenJDK11+", "committedDate": "2020-04-03T18:00:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI2Mzc4Mg==", "url": "https://github.com/DataDog/dd-trace-java/pull/1350#discussion_r403263782", "bodyText": "Mind adding a test for this? We are running on at least some version that this should be testable from.", "author": "mar-kolya", "createdAt": "2020-04-03T19:28:46Z", "path": "dd-java-agent/agent-profiling/profiling-controller/src/main/java/com/datadog/profiling/controller/ControllerFactory.java", "diffHunk": "@@ -49,8 +49,28 @@ public static Controller createController(final Config config)\n         | InstantiationException\n         | IllegalAccessException\n         | InvocationTargetException e) {\n-      throw new UnsupportedEnvironmentException(\n-          \"The JFR controller could not find a supported JFR API\", e);\n+      String exMsg = \"The JFR controller could not find a supported JFR API\"\n+        + getFixProposalMessage();\n+      throw new UnsupportedEnvironmentException(exMsg, e);\n+    }\n+  }\n+\n+  private static String getFixProposalMessage() {\n+    try {\n+      String javaVersion = System.getProperty(\"java.version\");\n+      if (javaVersion == null) {\n+        return \"\";\n+      }\n+      String javaVendor = System.getProperty(\"java.vendor\", \"\");\n+      if (javaVersion.startsWith(\"1.8\")) {\n+        if (javaVendor.startsWith(\"Azul Systems\")) {\n+          return \", use Azul zulu version 1.8.0_212+\";\n+        }\n+        // TODO Add version minimum once JFR backported into OpenJDK distros\n+      }\n+      return \", use OpenJDK 11+ or Azul zulu version 1.8.0_212+\";\n+    } catch (Exception ex) {\n+      return \"\";", "originalCommit": "343a77d6190d687a97c1d45f4c73a1540af0e85a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ce26d0532e781354f69225efb2b509b66e587abd", "url": "https://github.com/DataDog/dd-trace-java/commit/ce26d0532e781354f69225efb2b509b66e587abd", "message": "Add test for improved messages", "committedDate": "2020-04-06T10:19:20Z", "type": "commit"}, {"oid": "658544fb38843b543d6a6be8ed7f755386b0b08d", "url": "https://github.com/DataDog/dd-trace-java/commit/658544fb38843b543d6a6be8ed7f755386b0b08d", "message": "Fix formatting", "committedDate": "2020-04-06T11:26:55Z", "type": "commit"}]}