{"pr_number": 1703, "pr_title": "Check for error condition before setting ERROR_MSG", "pr_createdAt": "2020-07-22T16:46:16Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/1703", "timeline": [{"oid": "cf542a773a72db77254581f26272baa407de27d7", "url": "https://github.com/DataDog/dd-trace-java/commit/cf542a773a72db77254581f26272baa407de27d7", "message": "Check for error condition before setting ERROR_MSG", "committedDate": "2020-07-22T16:40:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk0MDM0NA==", "url": "https://github.com/DataDog/dd-trace-java/pull/1703#discussion_r458940344", "bodyText": "Can we assign map.get(EVENT) to a local and check span.isError() first please?", "author": "richardstartin", "createdAt": "2020-07-22T16:53:15Z", "path": "dd-java-agent/instrumentation/opentracing/src/main/java/datadog/trace/instrumentation/opentracing/DefaultLogHandler.java", "diffHunk": "@@ -34,11 +35,15 @@ public void log(final long timestampMicroseconds, final String event, final Agen\n     log.debug(\"`log` method is not implemented. Provided log: {}\", event);\n   }\n \n+  private boolean isErrorSpan(final Map<String, ?> map, final AgentSpan span) {\n+    return (map.get(EVENT) instanceof String && map.get(EVENT).equals(\"error\")) || span.isError();", "originalCommit": "cf542a773a72db77254581f26272baa407de27d7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "da544690a46e75feb51727321d12253ad7aa50c7", "url": "https://github.com/DataDog/dd-trace-java/commit/da544690a46e75feb51727321d12253ad7aa50c7", "message": "Reverse order of short circuit logic\n\nAlso assign map value to a local variable.", "committedDate": "2020-07-22T20:00:28Z", "type": "commit"}, {"oid": "3775aa563b5eb3e58c5130398489717b0079ca85", "url": "https://github.com/DataDog/dd-trace-java/commit/3775aa563b5eb3e58c5130398489717b0079ca85", "message": "Update the other DefaultLogHandler", "committedDate": "2020-07-28T19:57:31Z", "type": "commit"}, {"oid": "c36a15d75eeebb28cf6d614bc4c1e34ae6460703", "url": "https://github.com/DataDog/dd-trace-java/commit/c36a15d75eeebb28cf6d614bc4c1e34ae6460703", "message": "Add tests", "committedDate": "2020-07-28T19:57:58Z", "type": "commit"}, {"oid": "48eafc0a6548ff2250867621083a225755d8e237", "url": "https://github.com/DataDog/dd-trace-java/commit/48eafc0a6548ff2250867621083a225755d8e237", "message": "Make test names  more descriptive", "committedDate": "2020-07-28T20:02:12Z", "type": "commit"}]}