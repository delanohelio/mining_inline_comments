{"pr_number": 1136, "pr_title": "Allow getIdealAssignmentForWagedFullAuto return preference list based results, add result filtering", "pr_createdAt": "2020-07-02T18:41:22Z", "pr_url": "https://github.com/apache/helix/pull/1136", "timeline": [{"oid": "9615592e372deb1492198d12621f00303ab5ecfe", "url": "https://github.com/apache/helix/commit/9615592e372deb1492198d12621f00303ab5ecfe", "message": "Add option to return pref lists based results", "committedDate": "2020-07-02T01:37:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIxMTQ1MQ==", "url": "https://github.com/apache/helix/pull/1136#discussion_r449211451", "bodyText": "The names are not clear enough, IMO.\nHow about getTargetAssignmentForWagedFullAuto and getImmediateAssignmentForWagedFullAutoImpl ?", "author": "jiajunwang", "createdAt": "2020-07-02T18:57:43Z", "path": "helix-core/src/main/java/org/apache/helix/util/HelixUtil.java", "diffHunk": "@@ -177,6 +178,39 @@ public static String serializeByComma(List<String> objects) {\n       String metadataStoreAddress, ClusterConfig clusterConfig,\n       List<InstanceConfig> instanceConfigs, List<String> liveInstances,\n       List<IdealState> idealStates, List<ResourceConfig> resourceConfigs) {\n+    return getIdealAssignmentForWagedFullAutoImpl(metadataStoreAddress, clusterConfig,\n+        instanceConfigs, liveInstances, idealStates, resourceConfigs, true);\n+  }\n+\n+  /**\n+   * Returns the expected ideal ResourceAssignments for the given resources in the cluster\n+   * calculated using the read-only WAGED rebalancer. The returned result is based on partition\n+   * state mapping.\n+   * @param metadataStoreAddress\n+   * @param clusterConfig\n+   * @param instanceConfigs\n+   * @param liveInstances\n+   * @param idealStates\n+   * @param resourceConfigs\n+   * @return\n+   */\n+  public static Map<String, ResourceAssignment> getIdealPartitionMapForWagedFullAuto(", "originalCommit": "9615592e372deb1492198d12621f00303ab5ecfe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI0OTA3Mw==", "url": "https://github.com/apache/helix/pull/1136#discussion_r449249073", "bodyText": "Sure, I was also thinking what's a good way to differentiate these two.", "author": "NealSun96", "createdAt": "2020-07-02T20:25:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIxMTQ1MQ=="}], "type": "inlineReview"}, {"oid": "107617e0d24367b13b5d0b4e0726d73b6287a16f", "url": "https://github.com/apache/helix/commit/107617e0d24367b13b5d0b4e0726d73b6287a16f", "message": "Renaming", "committedDate": "2020-07-02T20:27:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI1Nzc3Mg==", "url": "https://github.com/apache/helix/pull/1136#discussion_r449257772", "bodyText": "Should we leave this unchanged since this is a public method and we know there are users using this?", "author": "narendly", "createdAt": "2020-07-02T20:45:46Z", "path": "helix-core/src/main/java/org/apache/helix/util/HelixUtil.java", "diffHunk": "@@ -173,10 +174,43 @@ public static String serializeByComma(List<String> objects) {\n    * @param resourceConfigs\n    * @return\n    */\n-  public static Map<String, ResourceAssignment> getIdealAssignmentForWagedFullAuto(\n+  public static Map<String, ResourceAssignment> getTargetAssignmentForWagedFullAuto(", "originalCommit": "107617e0d24367b13b5d0b4e0726d73b6287a16f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzc5MTQxMg==", "url": "https://github.com/apache/helix/pull/1136#discussion_r453791412", "bodyText": "That's my initial thought too, which is why I kept the method name in my initial commit.\nHowever, keeping this name makes it hard to differentiate from the other method (both are \"ideal\" assignments), and I liked Jiajun's new names. The only current reference is the migration testing tool, which I think is fine to be updated as Helix version is updated.", "author": "NealSun96", "createdAt": "2020-07-13T16:54:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI1Nzc3Mg=="}], "type": "inlineReview"}, {"oid": "ca07e4eccac12c0e51c58d6fc912836c23a51ed4", "url": "https://github.com/apache/helix/commit/ca07e4eccac12c0e51c58d6fc912836c23a51ed4", "message": "Filter results and add comment", "committedDate": "2020-07-02T23:48:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzg3OTA1OQ==", "url": "https://github.com/apache/helix/pull/1136#discussion_r453879059", "bodyText": "Let's add this section of test for the getImmediateAssignmentForWagedFullAuto too.", "author": "jiajunwang", "createdAt": "2020-07-13T19:25:00Z", "path": "helix-core/src/test/java/org/apache/helix/integration/rebalancer/WagedRebalancer/TestWagedRebalance.java", "diffHunk": "@@ -209,7 +229,7 @@ public void testRebalanceTool() throws InterruptedException {\n     }\n \n     utilResult = HelixUtil\n-        .getIdealAssignmentForWagedFullAuto(ZK_ADDR, clusterConfig, instanceConfigs, liveInstances,\n+        .getTargetAssignmentForWagedFullAuto(ZK_ADDR, clusterConfig, instanceConfigs, liveInstances,", "originalCommit": "ca07e4eccac12c0e51c58d6fc912836c23a51ed4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzk4MTU2Mw==", "url": "https://github.com/apache/helix/pull/1136#discussion_r453981563", "bodyText": "Done so.", "author": "NealSun96", "createdAt": "2020-07-13T22:29:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzg3OTA1OQ=="}], "type": "inlineReview"}, {"oid": "ff27b83d32ce86a736b27802843aac87656f0596", "url": "https://github.com/apache/helix/commit/ff27b83d32ce86a736b27802843aac87656f0596", "message": "expand test coverage", "committedDate": "2020-07-13T20:48:45Z", "type": "commit"}]}