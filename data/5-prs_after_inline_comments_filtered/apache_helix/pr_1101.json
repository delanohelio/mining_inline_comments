{"pr_number": 1101, "pr_title": "Add metrics for expired session count", "pr_createdAt": "2020-06-17T21:33:21Z", "pr_url": "https://github.com/apache/helix/pull/1101", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU2Nzg4Ng==", "url": "https://github.com/apache/helix/pull/1101#discussion_r442567886", "bodyText": "I think it would be simpler that we let the caller checking this dependency but not the record method.\nSo just do\nif (stateChange) {}\nif (dataChange) {}\nif (sessionExpired) {}", "author": "jiajunwang", "createdAt": "2020-06-19T00:21:10Z", "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -2138,11 +2139,14 @@ private void recordFailure(String path, ZkClientMonitor.AccessType accessType) {\n     }\n   }\n \n-  private void recordStateChange(boolean stateChanged, boolean dataChanged) {\n+  private void recordStateChange(boolean stateChanged, boolean dataChanged, boolean sessionExpired) {\n     // update state change counter.\n     if (_monitor != null) {\n       if (stateChanged) {\n         _monitor.increaseStateChangeEventCounter();\n+        if (sessionExpired) {", "originalCommit": "e2606680f59d667b969d91765cf567cb2df758dc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg1ODAzMg==", "url": "https://github.com/apache/helix/pull/1101#discussion_r443858032", "bodyText": "Updated.", "author": "xyuanlu", "createdAt": "2020-06-22T22:22:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU2Nzg4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU2ODc5MA==", "url": "https://github.com/apache/helix/pull/1101#discussion_r442568790", "bodyText": "This looks duplicate to the testSessionExpiry method. Could you please merge the test logic if possible?", "author": "jiajunwang", "createdAt": "2020-06-19T00:24:34Z", "path": "zookeeper-api/src/test/java/org/apache/helix/zookeeper/impl/client/TestRawZkClient.java", "diffHunk": "@@ -487,6 +488,50 @@ void testPendingRequestGauge()\n     }\n   }\n \n+  @Test(dependsOnMethods = \"testZkClientMonitor\")\n+  void testSessionExpireCount() throws Exception {", "originalCommit": "e2606680f59d667b969d91765cf567cb2df758dc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg1ODA2Mw==", "url": "https://github.com/apache/helix/pull/1101#discussion_r443858063", "bodyText": "Updated.", "author": "xyuanlu", "createdAt": "2020-06-22T22:22:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU2ODc5MA=="}], "type": "inlineReview"}, {"oid": "5b07f4bfa59c1069f6eb6d2fe922599e5bd09f0c", "url": "https://github.com/apache/helix/commit/5b07f4bfa59c1069f6eb6d2fe922599e5bd09f0c", "message": "Add metrics for expired session count", "committedDate": "2020-06-22T18:55:00Z", "type": "commit"}, {"oid": "78c0bedda81294e56a904cd5cc11dae7c25a0f7b", "url": "https://github.com/apache/helix/commit/78c0bedda81294e56a904cd5cc11dae7c25a0f7b", "message": "address comments", "committedDate": "2020-06-22T18:55:00Z", "type": "commit"}, {"oid": "78c0bedda81294e56a904cd5cc11dae7c25a0f7b", "url": "https://github.com/apache/helix/commit/78c0bedda81294e56a904cd5cc11dae7c25a0f7b", "message": "address comments", "committedDate": "2020-06-22T18:55:00Z", "type": "forcePushed"}]}