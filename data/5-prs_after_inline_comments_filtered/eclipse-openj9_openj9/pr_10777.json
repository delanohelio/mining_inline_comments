{"pr_number": 10777, "pr_title": "Reduce the number of TargetVM in test_startupShutdownRobustness()", "pr_createdAt": "2020-10-03T00:08:53Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/10777", "timeline": [{"oid": "8bd8532dcdb4036847e4bf23ce965da6ff74accb", "url": "https://github.com/eclipse-openj9/openj9/commit/8bd8532dcdb4036847e4bf23ce965da6ff74accb", "message": "Reduce the number of TargetVM in test_startupShutdownRobustness()\n\nChanged the number of TargetVM from 10 to 5 to ensure all target VM can\nbe notified when the target folders are deleted;\nAdded more log messages and trace points.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>", "committedDate": "2020-10-02T19:44:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY3MTEyNQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/10777#discussion_r499671125", "bodyText": "Since only AIX has a problem with the larger number, perhaps this change should be platform specific so as not to change the testing for other platforms.", "author": "pshipton", "createdAt": "2020-10-05T15:09:01Z", "path": "test/functional/Java8andUp/src/org/openj9/test/attachAPI/TestAttachErrorHandling.java", "diffHunk": "@@ -96,15 +96,17 @@ public void testTracepoint() {\n \tpublic void test_startupShutdownRobustness() throws IOException {\n \t\tFile ipcDir=new File(System.getProperty(\"java.io.tmpdir\"), testName);\n \t\tipcDir.mkdir();\n+\t\tlogger.debug(\"test_startupShutdownRobustness ipcDir = \" + ipcDir.getAbsolutePath());\n \t\tFile logDir=new File(System.getProperty(\"java.io.tmpdir\"), testName+\"_logs\");\n \t\tlogDir.mkdir();\n+\t\tlogger.debug(\"test_startupShutdownRobustness logDir = \" + logDir.getAbsolutePath());\n \t\t\n \t\tArrayList<TargetManager> targets = new ArrayList<TargetManager>();\n \t\tArrayList<String> vmArgs = new ArrayList<String>();\n \t\tvmArgs.add(\"-Dcom.ibm.tools.attach.directory=\"+ ipcDir.getAbsolutePath());\n \t\tvmArgs.add(\"-Dcom.ibm.tools.attach.logging=yes\");\n \t\tvmArgs.add(\"-Dcom.ibm.tools.attach.log.name=\"+logDir.getAbsolutePath()+File.separatorChar);\n-\t\tfor (int i = 0; i < 10; ++i)  {\n+\t\tfor (int i = 0; i < 5; ++i)  {", "originalCommit": "8bd8532dcdb4036847e4bf23ce965da6ff74accb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY3ODc1OQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/10777#discussion_r499678759", "bodyText": "It occurred in OSX as well just less often than AIX. To ensure all the targetVM can be waked, the numTargets within CommonDirectory.notifyVm(numTargets, true) must not less than the actual targetVM number.", "author": "JasonFengJ9", "createdAt": "2020-10-05T15:19:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY3MTEyNQ=="}], "type": "inlineReview"}]}