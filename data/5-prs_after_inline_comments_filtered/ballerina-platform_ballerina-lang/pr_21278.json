{"pr_number": 21278, "pr_title": "Fix typetest equality check in TypeChecker", "pr_createdAt": "2020-02-26T12:54:12Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278", "timeline": [{"oid": "a9cbf7b04fb2edfa7fb0087961d6706475558602", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a9cbf7b04fb2edfa7fb0087961d6706475558602", "message": "Fix typetest for Typedefs", "committedDate": "2020-02-26T12:52:00Z", "type": "commit"}, {"oid": "77c34db61d196cfd41005b0a447cd6cee748c45e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/77c34db61d196cfd41005b0a447cd6cee748c45e", "message": "Fix checkstyle errors", "committedDate": "2020-02-26T16:35:27Z", "type": "commit"}, {"oid": "417fc6b2f85504f6bc8c0196e18955504b9d52c3", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/417fc6b2f85504f6bc8c0196e18955504b9d52c3", "message": "Add checkstyle fixes 2", "committedDate": "2020-02-26T17:09:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkyNTc1Nw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278#discussion_r384925757", "bodyText": "Shouldn't this go into checkIsRecursiveType similar to maps, lists, etc.?", "author": "MaryamZi", "createdAt": "2020-02-27T05:53:20Z", "path": "bvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/TypeChecker.java", "diffHunk": "@@ -502,6 +503,8 @@ public static boolean checkIsType(BType sourceType, BType targetType, List<TypeP\n                 return checkIsServiceType(sourceType);\n             case TypeTags.HANDLE_TAG:\n                 return sourceType.getTag() == TypeTags.HANDLE_TAG;\n+            case TypeTags.TYPEDESC_TAG:", "originalCommit": "417fc6b2f85504f6bc8c0196e18955504b9d52c3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkyNTkyMw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278#discussion_r384925923", "bodyText": "Shall we pass down the unresolved types also and use it when calling checkIsType for the constraint?", "author": "MaryamZi", "createdAt": "2020-02-27T05:54:03Z", "path": "bvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/TypeChecker.java", "diffHunk": "@@ -510,6 +513,15 @@ public static boolean checkIsType(BType sourceType, BType targetType, List<TypeP\n \n     // Private methods\n \n+    private static boolean checkTypeDescType(BType sourceType, BTypedescType targetType) {", "originalCommit": "417fc6b2f85504f6bc8c0196e18955504b9d52c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNDgzNQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278#discussion_r384934835", "bodyText": "+1", "author": "SupunS", "createdAt": "2020-02-27T06:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkyNTkyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDk3NjQ1OA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278#discussion_r384976458", "bodyText": "+1. Will fix.", "author": "dulvinw", "createdAt": "2020-02-27T08:31:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkyNTkyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkyNjcyNg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278#discussion_r384926726", "bodyText": "Should we call .equals() instead?", "author": "MaryamZi", "createdAt": "2020-02-27T05:57:36Z", "path": "bvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/types/BTypedescType.java", "diffHunk": "@@ -52,6 +52,17 @@ public int getTag() {\n         return TypeTags.TYPEDESC_TAG;\n     }\n \n+    @Override\n+    public boolean equals(Object obj) {\n+        if (this == obj) {\n+            return true;\n+        }\n+        if (obj instanceof BTypedescType) {\n+            return constraint == ((BTypedescType) obj).getConstraint();", "originalCommit": "417fc6b2f85504f6bc8c0196e18955504b9d52c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDk3NjQwOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278#discussion_r384976409", "bodyText": "Will do.", "author": "dulvinw", "createdAt": "2020-02-27T08:31:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkyNjcyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNDE0Mg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278#discussion_r384934142", "bodyText": "Do we need the describingType field anymore, since that is already there in the type now?", "author": "SupunS", "createdAt": "2020-02-27T06:27:21Z", "path": "bvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/values/TypedescValue.java", "diffHunk": "@@ -44,7 +44,7 @@\n \n     @Deprecated\n     public TypedescValue(BType describingType) {\n-        this.type = BTypes.typeTypedesc;\n+        this.type = new BTypedescType(describingType);\n         this.describingType = describingType;", "originalCommit": "417fc6b2f85504f6bc8c0196e18955504b9d52c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNTEzMw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278#discussion_r384935133", "bodyText": "On a second thought, I think we may have to keep it. Please ignore my previous comment :)", "author": "SupunS", "createdAt": "2020-02-27T06:31:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNDE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDk3NjI5MQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21278#discussion_r384976291", "bodyText": "OK :)", "author": "dulvinw", "createdAt": "2020-02-27T08:31:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNDE0Mg=="}], "type": "inlineReview"}, {"oid": "16ec475b05be3be82c2ffa1267801e50d0cb389d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/16ec475b05be3be82c2ffa1267801e50d0cb389d", "message": "Fix review suggestions", "committedDate": "2020-02-27T09:43:42Z", "type": "commit"}, {"oid": "d3bb04f193db7ccae1fdbf223dcbf3e3aac6c55d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d3bb04f193db7ccae1fdbf223dcbf3e3aac6c55d", "message": "Revert unneccesary file changes", "committedDate": "2020-02-28T05:06:46Z", "type": "commit"}]}