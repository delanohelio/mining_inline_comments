{"pr_number": 26673, "pr_title": "Remove version parsing support from import declaration", "pr_createdAt": "2020-10-29T06:33:38Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/26673", "timeline": [{"oid": "d573d255753c6960bbcdb70857226600756cf9b8", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d573d255753c6960bbcdb70857226600756cf9b8", "message": "Remove version parsing support from import declaration", "committedDate": "2020-10-29T06:30:06Z", "type": "commit"}, {"oid": "94e7a3833eb95ee9d4208d2722620890729f5637", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/94e7a3833eb95ee9d4208d2722620890729f5637", "message": "Disable jbal-unit-test: ImportsTests.java", "committedDate": "2020-10-29T06:30:14Z", "type": "commit"}, {"oid": "e792b584e2291c51f55163b9a3d6f9d02f6a167f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e792b584e2291c51f55163b9a3d6f9d02f6a167f", "message": "Fix usages in OptimizeImportsCodeAction.java", "committedDate": "2020-10-29T07:31:57Z", "type": "commit"}, {"oid": "15cd9ff2e95a583930bbd16d7a5f311f08bc1413", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/15cd9ff2e95a583930bbd16d7a5f311f08bc1413", "message": "Disable jbal-integration-test: MultipleVersionsModuleTestCase.java", "committedDate": "2020-10-29T11:44:40Z", "type": "commit"}, {"oid": "cba670d33f827fa355da35d4acdf53ada119c744", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/cba670d33f827fa355da35d4acdf53ada119c744", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into remove-version", "committedDate": "2020-11-02T05:23:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQwNjYwOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26673#discussion_r516406609", "bodyText": "error code seems to be a duplicate.", "author": "SupunS", "createdAt": "2020-11-03T03:10:17Z", "path": "compiler/ballerina-parser/src/main/java/io/ballerina/compiler/internal/diagnostics/DiagnosticErrorCode.java", "diffHunk": "@@ -292,6 +292,8 @@\n     ERROR_INVALID_CHARACTER_IN_XML_ATTRIBUTE_VALUE(\"BCE0653\", \"error.invalid.character.in.xml.attribute.value\"),\n     ERROR_INVALID_ENTITY_REFERENCE_NAME_START(\"BCE0654\", \"error.invalid.entity.reference.name.start\"),\n     ERROR_DOUBLE_HYPHEN_NOT_ALLOWED_WITHIN_XML_COMMENT(\"BCE0655\", \"error.double.hyphen.not.allowed.within.xml.comment\"),\n+    ERROR_VERSION_IN_IMPORT_DECLARATION_NO_LONGER_SUPPORTED(\"BCE0622\",", "originalCommit": "cba670d33f827fa355da35d4acdf53ada119c744", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQwNjgxNg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26673#discussion_r516406816", "bodyText": "We can make this function to have a void return.", "author": "SupunS", "createdAt": "2020-11-03T03:11:15Z", "path": "compiler/ballerina-parser/src/main/java/io/ballerina/compiler/internal/parser/BallerinaParser.java", "diffHunk": "@@ -546,30 +543,37 @@ private boolean isEndOfImportDecl(STToken nextToken) {\n \n     /**\n      * Parse version component of a import declaration.\n+     * @deprecated\n+     * Version is no longer supported. Hence, parse it and log an error.\n      * <p>\n      * <code>version-decl := version sem-ver</code>\n      *\n      * @return Parsed node\n      */\n+    @Deprecated\n     private STNode parseVersion() {\n         STToken nextToken = peek();\n         switch (nextToken.kind) {\n             case VERSION_KEYWORD:\n                 STNode versionKeyword = parseVersionKeyword();\n                 STNode versionNumber = parseVersionNumber();\n-                return STNodeFactory.createImportVersionNode(versionKeyword, versionNumber);\n+                addInvalidNodeToNextToken(versionKeyword,\n+                        DiagnosticErrorCode.ERROR_VERSION_IN_IMPORT_DECLARATION_NO_LONGER_SUPPORTED);\n+                addInvalidNodeToNextToken(versionNumber, null);\n+                break;\n             case AS_KEYWORD:\n             case SEMICOLON_TOKEN:\n-                return STNodeFactory.createEmptyNode();\n+                break;\n             default:\n                 if (isEndOfImportDecl(nextToken)) {\n-                    return STNodeFactory.createEmptyNode();\n+                    break;\n                 }\n \n                 recover(peek(), ParserRuleContext.IMPORT_VERSION_DECL);\n                 return parseVersion();\n         }\n \n+        return STNodeFactory.createEmptyNode();", "originalCommit": "cba670d33f827fa355da35d4acdf53ada119c744", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ddeb02294114ea568a1eec5115cff80af458c887", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ddeb02294114ea568a1eec5115cff80af458c887", "message": "Add review suggestions", "committedDate": "2020-11-04T07:52:39Z", "type": "commit"}, {"oid": "f3220cc1fa3293f9bda354a920dc817b6781aa78", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f3220cc1fa3293f9bda354a920dc817b6781aa78", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into remove-version\n\n\u0001 Conflicts:\n\u0001\tcompiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/parser/BLangNodeTransformer.java\n\u0001\tcompiler/ballerina-parser/src/main/java/io/ballerina/compiler/syntax/tree/ImportDeclarationNode.java\n\u0001\tmisc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "committedDate": "2020-11-04T07:59:31Z", "type": "commit"}, {"oid": "d4095309142f90e868b4a7616850d460afcba380", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d4095309142f90e868b4a7616850d460afcba380", "message": "Regenerate syntax tree", "committedDate": "2020-11-04T08:02:02Z", "type": "commit"}]}