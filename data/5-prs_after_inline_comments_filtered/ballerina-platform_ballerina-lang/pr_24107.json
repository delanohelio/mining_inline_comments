{"pr_number": 24107, "pr_title": "Consider the requirement of a field to be readonly for record/object subtyping", "pr_createdAt": "2020-06-14T12:43:23Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/24107", "timeline": [{"oid": "b3f9d4da12891da652d72e66161c4a35a2662b9e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b3f9d4da12891da652d72e66161c4a35a2662b9e", "message": "Fix test names", "committedDate": "2020-06-14T08:43:36Z", "type": "commit"}, {"oid": "5fee26d24e175d6c082fa6bb22e3c6ffe8ca6914", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5fee26d24e175d6c082fa6bb22e3c6ffe8ca6914", "message": "Consider the readonly flag of fields for record/object subtyping", "committedDate": "2020-06-14T08:54:33Z", "type": "commit"}, {"oid": "d875439364cd0f238223688330da3b98237e075b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d875439364cd0f238223688330da3b98237e075b", "message": "Add tests for considering readonly flag for subtyping", "committedDate": "2020-06-14T12:33:02Z", "type": "commit"}, {"oid": "e052eee74fc5b3c44e063297f96da48272261d0e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e052eee74fc5b3c44e063297f96da48272261d0e", "message": "Temporarily disable failing table test for union CET", "committedDate": "2020-06-14T12:38:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg0ODk0Mg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24107#discussion_r439848942", "bodyText": "Should we consider extracting this out as a method? Seeing this repeated a couple of times + would probably be easier to read when used in more complex checks", "author": "pubudu91", "createdAt": "2020-06-14T17:00:56Z", "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/Types.java", "diffHunk": "@@ -750,8 +750,16 @@ private boolean isAssignableMapType(BMapType sourceMapType, BRecordType targetRe\n         }\n \n         for (BField field : targetRecType.fields.values()) {\n-            if (!(Symbols.isFlagOn(field.symbol.flags, Flags.OPTIONAL) &&\n-                    isAssignable(sourceMapType.constraint, field.type))) {\n+            if (!Symbols.isFlagOn(field.symbol.flags, Flags.OPTIONAL)) {\n+                return false;\n+            }\n+\n+            if (Symbols.isFlagOn(field.symbol.flags, Flags.READONLY) &&\n+                    !Symbols.isFlagOn(sourceMapType.flags, Flags.READONLY)) {", "originalCommit": "e052eee74fc5b3c44e063297f96da48272261d0e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2994fa7395b3e1e7724e59494e3c3d328fccfb62", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2994fa7395b3e1e7724e59494e3c3d328fccfb62", "message": "Address review suggestions", "committedDate": "2020-06-14T18:27:04Z", "type": "commit"}]}