{"pr_number": 23522, "pr_title": "Improve syntaxTreeModify to remove imports automatically", "pr_createdAt": "2020-05-26T16:55:19Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/23522", "timeline": [{"oid": "99e0bea81477c083276f3d4a92bf32b7ed840b19", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/99e0bea81477c083276f3d4a92bf32b7ed840b19", "message": "Implement Syntax Tree Json LS extension", "committedDate": "2020-05-26T14:19:34Z", "type": "commit"}, {"oid": "d3478791568fd9a4dd3c8d9331ff65514e1c6353", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d3478791568fd9a4dd3c8d9331ff65514e1c6353", "message": "Remove parser errors logged to System.out", "committedDate": "2020-05-26T14:52:59Z", "type": "commit"}, {"oid": "9fc916cf125fb3b7cfb0058989cb4e7ec2cbbf07", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9fc916cf125fb3b7cfb0058989cb4e7ec2cbbf07", "message": "Create json instead of map<string, object> inside transformer", "committedDate": "2020-05-26T14:53:59Z", "type": "commit"}, {"oid": "bb4aeaae8e541233d7411778efd574b414cdddc3", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bb4aeaae8e541233d7411778efd574b414cdddc3", "message": "Restructure json for syntax tree", "committedDate": "2020-05-26T14:55:10Z", "type": "commit"}, {"oid": "f0aa9697d12965d07e75ece1974c8a29e9c8a169", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f0aa9697d12965d07e75ece1974c8a29e9c8a169", "message": "Fix Ballerina Doc Service for Syntax Tree API changes", "committedDate": "2020-05-26T14:56:47Z", "type": "commit"}, {"oid": "dd156ea935826286b2ec4f05083af65f48fb5ecf", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/dd156ea935826286b2ec4f05083af65f48fb5ecf", "message": "Add language server SyntaxTree modifier\n\nSupport for insert, update and delete nodes to SyntaxTree", "committedDate": "2020-05-26T14:57:46Z", "type": "commit"}, {"oid": "a4d3dd901cf83fd0bdd891b2ed32f0ab60c2b9bd", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a4d3dd901cf83fd0bdd891b2ed32f0ab60c2b9bd", "message": "Add language server SyntaxTree modifier\n\nSupport for insert, update and delete nodes to SyntaxTree", "committedDate": "2020-05-26T15:07:06Z", "type": "commit"}, {"oid": "923cf4fd7cbb5738ab034f8ab71e25a49c710e97", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/923cf4fd7cbb5738ab034f8ab71e25a49c710e97", "message": "Add main and service support for language server SyntaxTree modifier\n\nSupport for insert of main and service functions in SyntaxTree", "committedDate": "2020-05-26T15:08:54Z", "type": "commit"}, {"oid": "72e65ed6cd5dda333a6cc8422b26bb3794ebbd6e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/72e65ed6cd5dda333a6cc8422b26bb3794ebbd6e", "message": "Add support to find unused variable declarations", "committedDate": "2020-05-26T15:09:03Z", "type": "commit"}, {"oid": "a06481feeabebd88da998688ede4f4bbac4e473f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a06481feeabebd88da998688ede4f4bbac4e473f", "message": "Fix build issue", "committedDate": "2020-05-26T15:09:22Z", "type": "commit"}, {"oid": "2394d081eacd2929a87a45127ef532ad83b426c7", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2394d081eacd2929a87a45127ef532ad83b426c7", "message": "Improve syntaxTreeModify to remove imports automatically", "committedDate": "2020-05-26T15:09:38Z", "type": "commit"}, {"oid": "74a46de6480c8e253ee1dd49ceda61cb5be4165c", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/74a46de6480c8e253ee1dd49ceda61cb5be4165c", "message": "Fix build", "committedDate": "2020-05-26T15:09:45Z", "type": "commit"}, {"oid": "5a186d8ae0b5784c8ba0a6876fcf540138c15eed", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5a186d8ae0b5784c8ba0a6876fcf540138c15eed", "message": "Fix build error", "committedDate": "2020-05-26T15:38:45Z", "type": "commit"}, {"oid": "4f84f38d6dd0473c6fc1b3b240f1602aa139f5d0", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4f84f38d6dd0473c6fc1b3b240f1602aa139f5d0", "message": "Add support to AST modification", "committedDate": "2020-05-26T16:49:11Z", "type": "commit"}, {"oid": "2175afd8d961c8c19f2386f703f2dac00fa33ea8", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2175afd8d961c8c19f2386f703f2dac00fa33ea8", "message": "Skip a test", "committedDate": "2020-05-26T16:51:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzMzc0MQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23522#discussion_r430633741", "bodyText": "We are fixing this with the following PR.\n#23500", "author": "sameerajayasoma", "createdAt": "2020-05-26T18:51:44Z", "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParserErrorListener.java", "diffHunk": "@@ -47,7 +45,8 @@ public void reportInvalidNodeError(STToken token, String message) {\n     }\n     \n     private void logError(int line, int col, String message) {\n-        PrintStream out = System.out;\n-        out.println(\"xxx.bal:\" + line + \":\" + col + \":\" + message);\n+        // TODO - Removing below lines as it breaks lang-server rpc", "originalCommit": "2175afd8d961c8c19f2386f703f2dac00fa33ea8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAxMzAxMA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23522#discussion_r435013010", "bodyText": "Noted", "author": "suhothayan", "createdAt": "2020-06-04T06:10:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzMzc0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNDI5Mw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23522#discussion_r430634293", "bodyText": "Can you please create an issue for this change? I think we need to fix this in other places too. Issue will help us to track it. Thanks.", "author": "sameerajayasoma", "createdAt": "2020-05-26T18:52:39Z", "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/incremental/HybridNodeStorage.java", "diffHunk": "@@ -80,6 +80,9 @@ HybridNode peekSubtree() {\n     }\n \n     HybridNode consumeToken() {\n+        if (currentToken == null) {\n+            currentToken = peekToken();\n+        }\n         HybridNode hybridNode = currentToken;", "originalCommit": "2175afd8d961c8c19f2386f703f2dac00fa33ea8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAxOTg1NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23522#discussion_r435019855", "bodyText": "Created an issue #23719", "author": "suhothayan", "createdAt": "2020-06-04T06:29:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNDI5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNDkyOA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23522#discussion_r430634928", "bodyText": "Can you please create an issue explaining the bug here?", "author": "sameerajayasoma", "createdAt": "2020-05-26T18:53:39Z", "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/tree/STNode.java", "diffHunk": "@@ -156,7 +156,7 @@ private void updateWidth(STNode[] children, int firstChildIndex, int lastChildIn\n     private int getFirstChildIndex(STNode... children) {\n         for (int index = 0; index < children.length; index++) {\n             STNode child = children[index];\n-            if (SyntaxUtils.isSTNodePresent(child) && child.widthWithMinutiae != 0) {\n+            if (SyntaxUtils.isSTNodePresent(child) && child.widthWithLeadingMinutiae != 0) {", "originalCommit": "2175afd8d961c8c19f2386f703f2dac00fa33ea8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAzNDAyOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23522#discussion_r435034029", "bodyText": "This seems to be unnecessary now. I'll revert this.", "author": "suhothayan", "createdAt": "2020-06-04T07:02:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNDkyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNTM1NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23522#discussion_r430635355", "bodyText": "This class is not part of the public syntax API. I think I've mistakenly made this class public.\nWhy do you want to directly access this class anyway?", "author": "sameerajayasoma", "createdAt": "2020-05-26T18:54:22Z", "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/text/StringTextDocument.java", "diffHunk": "@@ -28,7 +28,7 @@\n     private final String text;\n     private LineMap textLineMap;\n \n-    StringTextDocument(String text) {\n+    public StringTextDocument(String text) {", "originalCommit": "2175afd8d961c8c19f2386f703f2dac00fa33ea8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAzNDMxOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23522#discussion_r435034319", "bodyText": "This is not needed, as there are other ways to create StringTextDocument. I'll revert this.", "author": "suhothayan", "createdAt": "2020-06-04T07:02:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNTM1NQ=="}], "type": "inlineReview"}, {"oid": "db585742ec82894e5d2dfb228429c0bf636d720f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/db585742ec82894e5d2dfb228429c0bf636d720f", "message": "Improve build speed", "committedDate": "2020-05-26T18:57:49Z", "type": "commit"}, {"oid": "bfeb9eb154fd5dc904c513aa6550b821954fb81d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bfeb9eb154fd5dc904c513aa6550b821954fb81d", "message": "Fix checkstyle issues", "committedDate": "2020-05-26T19:47:42Z", "type": "commit"}, {"oid": "fde582f8d5913bca5f6e91738ef43554023452d6", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fde582f8d5913bca5f6e91738ef43554023452d6", "message": "Merge branch 'suho-master-1' into master-suho\n\n# Conflicts:\n#\tlanguage-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/extensions/ballerina/document/BallerinaDocumentServiceImpl.java", "committedDate": "2020-05-26T20:17:46Z", "type": "commit"}, {"oid": "7560db5a53edef7b55742328d5e5e94cc40ef7d1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7560db5a53edef7b55742328d5e5e94cc40ef7d1", "message": "Add test dependencies", "committedDate": "2020-05-26T20:34:36Z", "type": "commit"}, {"oid": "c4fa1124a8ed5d839c0650bd2d42663420c20c6b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c4fa1124a8ed5d839c0650bd2d42663420c20c6b", "message": "Fix test ordering", "committedDate": "2020-05-26T20:39:15Z", "type": "commit"}, {"oid": "c10aa14e03ae450f235f79cc4bcdddf965a47ea1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c10aa14e03ae450f235f79cc4bcdddf965a47ea1", "message": "Fix test on windows", "committedDate": "2020-05-27T04:25:39Z", "type": "commit"}, {"oid": "ff5c3ea5e78f21363472bf08a36e136daedf76ef", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ff5c3ea5e78f21363472bf08a36e136daedf76ef", "message": "Add debug logs", "committedDate": "2020-05-27T05:12:50Z", "type": "commit"}, {"oid": "750587bd519cd297414b5636de0032489b82459a", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/750587bd519cd297414b5636de0032489b82459a", "message": "Add logs and improve test", "committedDate": "2020-05-27T06:36:35Z", "type": "commit"}, {"oid": "01f9babe2ecaa64c396868a22ea91f6fa49c4fbb", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/01f9babe2ecaa64c396868a22ea91f6fa49c4fbb", "message": "Remove testcases", "committedDate": "2020-05-27T07:06:17Z", "type": "commit"}, {"oid": "d9ed2fb4fddccbade448ea47c2ff0124e236b809", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d9ed2fb4fddccbade448ea47c2ff0124e236b809", "message": "Merge remote-tracking branch 'origin/master' into master-suho", "committedDate": "2020-05-27T07:21:57Z", "type": "commit"}, {"oid": "071e90bf9521a8f58ac4334fa5432ee801658f51", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/071e90bf9521a8f58ac4334fa5432ee801658f51", "message": "Fix build", "committedDate": "2020-05-27T07:25:24Z", "type": "commit"}, {"oid": "4dd91111d76d2cd3fa29a6f88d402340e8edb14e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4dd91111d76d2cd3fa29a6f88d402340e8edb14e", "message": "Skip test on windows", "committedDate": "2020-05-27T08:53:00Z", "type": "commit"}, {"oid": "e2b5c1baf6725633fa15a83d720e3cb5d97206e1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e2b5c1baf6725633fa15a83d720e3cb5d97206e1", "message": "Update file system", "committedDate": "2020-05-27T09:39:39Z", "type": "commit"}, {"oid": "b22dc7905b2fd391c06befea62f33e2f20c075d5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b22dc7905b2fd391c06befea62f33e2f20c075d5", "message": "Merge branch 'master-suho' into suho-master-1\n\n# Conflicts:\n#\tlanguage-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/extensions/ballerina/document/BallerinaDocumentServiceImpl.java\n#\tlanguage-server/modules/langserver-core/src/test/java/org/ballerinalang/langserver/extensions/document/ASTModifyTest.java", "committedDate": "2020-05-27T09:52:20Z", "type": "commit"}, {"oid": "8ea4543a6b1686d8300fb9b9e916603b42093cde", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8ea4543a6b1686d8300fb9b9e916603b42093cde", "message": "Fix SyntaxTreeModifyTest and skip test in Windows", "committedDate": "2020-05-27T10:46:17Z", "type": "commit"}, {"oid": "71b1277c080fc643536151e8b8ac46c0c0c40d22", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/71b1277c080fc643536151e8b8ac46c0c0c40d22", "message": "Make StringTextDocument constructor private", "committedDate": "2020-05-27T11:50:29Z", "type": "commit"}, {"oid": "88c17d7adb02490e08b39f7327dd55c6d7e04c24", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/88c17d7adb02490e08b39f7327dd55c6d7e04c24", "message": "Return source during AST modify", "committedDate": "2020-05-27T12:16:02Z", "type": "commit"}, {"oid": "b095c73307eb1af296e6b7c3c8a9be6cac790471", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b095c73307eb1af296e6b7c3c8a9be6cac790471", "message": "Fix find bugs", "committedDate": "2020-05-27T12:28:34Z", "type": "commit"}, {"oid": "46744875dd74d2ecb9b88ba526f84563f6df2ec0", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/46744875dd74d2ecb9b88ba526f84563f6df2ec0", "message": "Add source code to response of AST modify", "committedDate": "2020-05-27T18:40:10Z", "type": "commit"}, {"oid": "fe6d0f02fb047d75dd306f5d08f341551ed73ba8", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fe6d0f02fb047d75dd306f5d08f341551ed73ba8", "message": "Merge remote-tracking branch 'origin/master' into suho-master-1", "committedDate": "2020-05-28T06:47:55Z", "type": "commit"}, {"oid": "fdb33d57c423f34bfadff4949acc8ac30f279d36", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fdb33d57c423f34bfadff4949acc8ac30f279d36", "message": "Fix testcases", "committedDate": "2020-05-28T19:24:21Z", "type": "commit"}, {"oid": "77582e218453adf647bc1a05b8ef58f048b7eedb", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/77582e218453adf647bc1a05b8ef58f048b7eedb", "message": "Fix build", "committedDate": "2020-05-28T19:28:26Z", "type": "commit"}, {"oid": "03c9b9bba1759c183b120ba41b3d9a1980f06759", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/03c9b9bba1759c183b120ba41b3d9a1980f06759", "message": "Merge remote-tracking branch 'origin/master' into suho-master-1", "committedDate": "2020-06-04T05:59:22Z", "type": "commit"}, {"oid": "4f790f4cc8325711bc8f51201a2191eb3d24f3ee", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4f790f4cc8325711bc8f51201a2191eb3d24f3ee", "message": "Fix testcases and remove unnecessary fixes", "committedDate": "2020-06-04T07:01:21Z", "type": "commit"}, {"oid": "290a99d2f8e297df74785691eb92ddf510c4028e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/290a99d2f8e297df74785691eb92ddf510c4028e", "message": "Fix checkstyle issue", "committedDate": "2020-06-04T08:04:01Z", "type": "commit"}]}