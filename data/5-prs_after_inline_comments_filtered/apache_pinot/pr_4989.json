{"pr_number": 4989, "pr_title": "Add documentation to fields of important query execution stats.", "pr_createdAt": "2020-01-15T19:55:07Z", "pr_url": "https://github.com/apache/pinot/pull/4989", "timeline": [{"oid": "71df3cbb8d3ca4c085f5e241f965283d96b50883", "url": "https://github.com/apache/pinot/commit/71df3cbb8d3ca4c085f5e241f965283d96b50883", "message": "Add documentation to fields of important query execution stats.", "committedDate": "2020-01-15T21:38:36Z", "type": "commit"}, {"oid": "71df3cbb8d3ca4c085f5e241f965283d96b50883", "url": "https://github.com/apache/pinot/commit/71df3cbb8d3ca4c085f5e241f965283d96b50883", "message": "Add documentation to fields of important query execution stats.", "committedDate": "2020-01-15T21:38:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3MzA3MQ==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369173071", "bodyText": "Remove the empty javadoc?", "author": "Jackie-Jiang", "createdAt": "2020-01-21T18:36:56Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/dociditerators/SortedDocIdIterator.java", "diffHunk": "@@ -24,14 +24,12 @@\n \n \n public final class SortedDocIdIterator implements IndexBasedDocIdIterator {\n-  /**\n-   *\n-   */\n   private List<IntPair> pairs;\n   private String datasourceName;\n \n   /**\n-   * @param sortedDocIdSet\n+   * @param datasourceName", "originalCommit": "71df3cbb8d3ca4c085f5e241f965283d96b50883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3Njg3OQ==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369176879", "bodyText": "No need to scan values when filtering with inverted index", "author": "Jackie-Jiang", "createdAt": "2020-01-21T18:44:18Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/BitmapDocIdSet.java", "diffHunk": "@@ -79,6 +79,7 @@ public void setEndDocId(int endDocId) {\n \n   @Override\n   public long getNumEntriesScannedInFilter() {\n+    // TODO: explain why there is no entries scanned in this filter.", "originalCommit": "71df3cbb8d3ca4c085f5e241f965283d96b50883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3ODQ3OQ==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369178479", "bodyText": "Can you change the TODO to: Rename the class to MatchAllDocIdSet", "author": "Jackie-Jiang", "createdAt": "2020-01-21T18:47:26Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "diffHunk": "@@ -21,7 +21,7 @@\n import org.apache.pinot.core.common.BlockDocIdIterator;\n import org.apache.pinot.core.operator.dociditerators.SizeBasedDocIdIterator;\n \n-\n+// TODO: javadoc this class.", "originalCommit": "71df3cbb8d3ca4c085f5e241f965283d96b50883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3ODczNw==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369178737", "bodyText": "No need to scan values when filtering with sorted index", "author": "Jackie-Jiang", "createdAt": "2020-01-21T18:47:59Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SortedDocIdSet.java", "diffHunk": "@@ -77,6 +77,7 @@ public void setEndDocId(int endDocId) {\n \n   @Override\n   public long getNumEntriesScannedInFilter() {\n+    // TODO: explain return 0.", "originalCommit": "71df3cbb8d3ca4c085f5e241f965283d96b50883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3OTM2OQ==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369179369", "bodyText": "No need to scan values when all values match the filter", "author": "Jackie-Jiang", "createdAt": "2020-01-21T18:49:15Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "diffHunk": "@@ -49,6 +49,7 @@ public void setEndDocId(int endDocId) {\n \n   @Override\n   public long getNumEntriesScannedInFilter() {\n+    // TODO explain why return 0.", "originalCommit": "71df3cbb8d3ca4c085f5e241f965283d96b50883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE4MDUyOQ==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369180529", "bodyText": "The number of entries (single-value entry contains one value, multi-value entry may contain multiple values) scanned ...", "author": "Jackie-Jiang", "createdAt": "2020-01-21T18:51:35Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,12 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of doc ids scanned in the filtering phase of the query execution: could be larger than the total doc num", "originalCommit": "71df3cbb8d3ca4c085f5e241f965283d96b50883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE4MDgzOA==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369180838", "bodyText": "Equal to numDocsScanned * numProjectedColumns", "author": "Jackie-Jiang", "createdAt": "2020-01-21T18:52:13Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,12 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of doc ids scanned in the filtering phase of the query execution: could be larger than the total doc num\n+  // because of multiple filtering predicates.\n   private long _numEntriesScannedInFilter;\n+  // Equal to _numDocsScanned * number_of_projected_columns", "originalCommit": "71df3cbb8d3ca4c085f5e241f965283d96b50883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9be4b4eb8622a22aab68d1181246b74d242616b9", "url": "https://github.com/apache/pinot/commit/9be4b4eb8622a22aab68d1181246b74d242616b9", "message": "Revised based on comments.", "committedDate": "2020-01-23T07:42:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370275890", "bodyText": "The number of entries (single-value entry contains 1 value, multi-value entry may contain multiple values) scanned in the filtering phase of the query execution. Could be larger than the number of documents scanned because of multiple filtering predicates.", "author": "Jackie-Jiang", "createdAt": "2020-01-23T18:13:13Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,13 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of entries (single value entry contains 1 entry, multi-value entry may contain multiple entries) in the\n+  // filtering phase of the query execution: could be larger than the total scanned doc num because of multiple\n+  // filtering predicates and multi-value entry.", "originalCommit": "9be4b4eb8622a22aab68d1181246b74d242616b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc2NjM4OA==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370766388", "bodyText": "Last sentence also changed (multi-value entry is not the reason)", "author": "Jackie-Jiang", "createdAt": "2020-01-24T18:02:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc4MTY3Mw==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370781673", "bodyText": "I thought one reason why number_of_entries_scanned > number_of_doc_scanned is that for a multi-value entry, each value in it could count as one entry scanned. Is it right?", "author": "chenboat", "createdAt": "2020-01-24T18:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc5MTk0Nw==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370791947", "bodyText": "Oh sorry my bad, you are right. The semantic for this value changed with #4455 and I totally forgot about it...\nSo right now the entry has different meaning in _numEntriesScannedInFilter (each MV value contains multiple entries) and _numEntriesScannedInFilter (both SV and MV value are counted as one entry).\nCan you please add a TODO to make entry semantic the same in _numEntriesScannedInFilter and _numEntriesScannedInFilter? Currently it is very misleading.\nI think it might be better to add a new stats _numValuesScannedInFilter to replace the current _numEntriesScannedInFilter, but it is out of the scope of this pr.", "author": "Jackie-Jiang", "createdAt": "2020-01-24T19:00:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDgxNTcyOA==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370815728", "bodyText": "TODO added. Thanks for the clarification.", "author": "chenboat", "createdAt": "2020-01-24T19:55:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NjE0Ng==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370276146", "bodyText": "Add TODO:", "author": "Jackie-Jiang", "createdAt": "2020-01-23T18:13:50Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "diffHunk": "@@ -21,7 +21,7 @@\n import org.apache.pinot.core.common.BlockDocIdIterator;\n import org.apache.pinot.core.operator.dociditerators.SizeBasedDocIdIterator;\n \n-\n+// Rename this class to MatchAllDocIdSet.", "originalCommit": "9be4b4eb8622a22aab68d1181246b74d242616b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NjM5NQ==", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370276395", "bodyText": "matched", "author": "Jackie-Jiang", "createdAt": "2020-01-23T18:14:25Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "diffHunk": "@@ -49,6 +49,7 @@ public void setEndDocId(int endDocId) {\n \n   @Override\n   public long getNumEntriesScannedInFilter() {\n+    // No value scanned because all docs are matches and will be returned.", "originalCommit": "9be4b4eb8622a22aab68d1181246b74d242616b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "eb5716abc444caf8d6a262cfad26f04cdefccdce", "url": "https://github.com/apache/pinot/commit/eb5716abc444caf8d6a262cfad26f04cdefccdce", "message": "Revised based on comments.", "committedDate": "2020-01-24T07:13:46Z", "type": "commit"}, {"oid": "94017b3b03171fec824a76b5d9a0ee6e9b08edd5", "url": "https://github.com/apache/pinot/commit/94017b3b03171fec824a76b5d9a0ee6e9b08edd5", "message": "Add a TODO for the entry semantic issue.", "committedDate": "2020-01-24T19:55:24Z", "type": "commit"}]}