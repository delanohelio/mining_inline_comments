{"pr_number": 5435, "pr_title": "[TE] clean up decprecated/unused code", "pr_createdAt": "2020-05-23T00:42:38Z", "pr_url": "https://github.com/apache/pinot/pull/5435", "timeline": [{"oid": "2933c48b4af6a27cba182bfd5879b5e82d397fe3", "url": "https://github.com/apache/pinot/commit/2933c48b4af6a27cba182bfd5879b5e82d397fe3", "message": "[TE] clean up decprecated/unused code", "committedDate": "2020-05-23T00:39:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMjg4Mw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r429602883", "bodyText": "initAnomalyClassifierFactory, initAlertFilterFactory could be deleted.", "author": "xiaohui-sun", "createdAt": "2020-05-24T06:10:17Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/anomaly/ThirdEyeAnomalyApplication.java", "diffHunk": "@@ -273,9 +224,4 @@ private void initAnomalyClassifierFactory(String anomalyClassifierConfigPath) {\n     }", "originalCommit": "2933c48b4af6a27cba182bfd5879b5e82d397fe3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzEwNQ==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r429603105", "bodyText": "anomalyClassifierFactory not used.", "author": "xiaohui-sun", "createdAt": "2020-05-24T06:13:22Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/anomaly/ThirdEyeAnomalyApplication.java", "diffHunk": "@@ -61,18 +54,12 @@\n public class ThirdEyeAnomalyApplication\n     extends BaseThirdEyeApplication<ThirdEyeAnomalyConfiguration> {\n \n-  private DetectionJobScheduler detectionJobScheduler = null;\n   private TaskDriver taskDriver = null;\n   private MonitorJobScheduler monitorJobScheduler = null;\n-  private AlertJobSchedulerV2 alertJobSchedulerV2;\n   private AnomalyFunctionFactory anomalyFunctionFactory = null;\n   private AutoOnboardService autoOnboardService = null;\n-  private DataCompletenessScheduler dataCompletenessScheduler = null;\n   private AlertFilterFactory alertFilterFactory = null;\n   private AnomalyClassifierFactory anomalyClassifierFactory = null;", "originalCommit": "2933c48b4af6a27cba182bfd5879b5e82d397fe3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzEyNg==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r429603126", "bodyText": "alertFilterFactory not used.", "author": "xiaohui-sun", "createdAt": "2020-05-24T06:13:53Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/anomaly/ThirdEyeAnomalyApplication.java", "diffHunk": "@@ -61,18 +54,12 @@\n public class ThirdEyeAnomalyApplication\n     extends BaseThirdEyeApplication<ThirdEyeAnomalyConfiguration> {\n \n-  private DetectionJobScheduler detectionJobScheduler = null;\n   private TaskDriver taskDriver = null;\n   private MonitorJobScheduler monitorJobScheduler = null;\n-  private AlertJobSchedulerV2 alertJobSchedulerV2;\n   private AnomalyFunctionFactory anomalyFunctionFactory = null;\n   private AutoOnboardService autoOnboardService = null;\n-  private DataCompletenessScheduler dataCompletenessScheduler = null;\n   private AlertFilterFactory alertFilterFactory = null;", "originalCommit": "2933c48b4af6a27cba182bfd5879b5e82d397fe3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzM3MA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r429603370", "bodyText": "ANOMALY_DETECTION and MERGE tasks are not used.", "author": "xiaohui-sun", "createdAt": "2020-05-24T06:17:20Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/anomaly/task/TaskInfoFactory.java", "diffHunk": "@@ -67,16 +64,6 @@ public static TaskInfo getTaskInfoFromTaskType(TaskType taskType, String taskInf\n         case MONITOR:\n           taskInfo = OBJECT_MAPPER.readValue(taskInfoString, MonitorTaskInfo.class);\n           break;\n-        case ALERT:", "originalCommit": "2933c48b4af6a27cba182bfd5879b5e82d397fe3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzQ0MQ==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r429603441", "bodyText": "ANOMALY_DETECTION and MERGE tasks are not used.", "author": "xiaohui-sun", "createdAt": "2020-05-24T06:18:10Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/anomaly/task/TaskRunnerFactory.java", "diffHunk": "@@ -59,16 +56,6 @@ public static TaskRunner getTaskRunnerFromTaskType(TaskType taskType) {\n       case MONITOR:\n         taskRunner = new MonitorTaskRunner();\n         break;\n-      case DATA_COMPLETENESS:", "originalCommit": "2933c48b4af6a27cba182bfd5879b5e82d397fe3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY4OTY2Mw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430689663", "bodyText": "Removed.", "author": "vincentchenjl", "createdAt": "2020-05-26T20:29:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzQ0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzQ4MA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r429603480", "bodyText": "This whole class could be deleted.", "author": "xiaohui-sun", "createdAt": "2020-05-24T06:19:02Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/completeness/checker/DataCompletenessUtils.java", "diffHunk": "@@ -261,13 +261,4 @@ public static DateTimeFormatter getDateTimeFormatterForDataset(TimeSpec timeSpec\n     return bucketNameToCountStar;\n   }\n \n-  public static double getPercentCompleteness(PercentCompletenessFunctionInput input) {", "originalCommit": "2933c48b4af6a27cba182bfd5879b5e82d397fe3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MTg4NA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430691884", "bodyText": "This class is used in Wo4WAvgDataCompletenessAlgorithm. We need to drop both of them if we want to drop this. Wo4WAvgDataCompletenessAlgorithm cannot be dropped due to the issue below.", "author": "vincentchenjl", "createdAt": "2020-05-26T20:34:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzQ4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5ODk5MQ==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430698991", "bodyText": "We should remove it and also remove getter/setter.\nThat should be safe.", "author": "xiaohui-sun", "createdAt": "2020-05-26T20:48:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzQ4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDc2MTgzMg==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430761832", "bodyText": "I remove Wo4WAvgDataCompletenessAlgorithm completely and also the field DatasetConfigBean.dataCompletenessAlgorithm from DatasetConfigBean.", "author": "vincentchenjl", "createdAt": "2020-05-26T23:28:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzQ4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzUyMg==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r429603522", "bodyText": "This class could be deleted.\nLet's delete everything under /completeness.checker", "author": "xiaohui-sun", "createdAt": "2020-05-24T06:19:53Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/completeness/checker/Wo4WAvgDataCompletenessAlgorithm.java", "diffHunk": "@@ -41,6 +41,7 @@\n /**\n  * This is the implementation of the WO4W Average function or checking data completeness of datasets\n  */\n+@Deprecated\n public class Wo4WAvgDataCompletenessAlgorithm implements DataCompletenessAlgorithm {\n \n   public static double DEFAULT_EXPECTED_COMPLETENESS = 80;", "originalCommit": "2933c48b4af6a27cba182bfd5879b5e82d397fe3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MTA1Mg==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430691052", "bodyText": "The issue is that  Wo4WAvgDataCompletenessAlgorithm is used as default value for DatasetConfigBean.dataCompletenessAlgorithm. I understand that it is not used, but i am not sure about the impact if i remove this field from DatasetConfigBean and still have this field inside the JSON in DB.", "author": "vincentchenjl", "createdAt": "2020-05-26T20:32:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwMzUyMg=="}], "type": "inlineReview"}, {"oid": "78d2fc2af8ad0e193c1cd4f2076c27adff714b60", "url": "https://github.com/apache/pinot/commit/78d2fc2af8ad0e193c1cd4f2076c27adff714b60", "message": "remove more code based on comments", "committedDate": "2020-05-26T20:29:12Z", "type": "commit"}, {"oid": "6f6e945a49fecadf9acc246240153c938b855d35", "url": "https://github.com/apache/pinot/commit/6f6e945a49fecadf9acc246240153c938b855d35", "message": "address comments", "committedDate": "2020-05-26T23:25:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2MTIxNw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430861217", "bodyText": "Remove //TODO", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:14:28Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/anomaly/task/TaskConstants.java", "diffHunk": "@@ -26,15 +26,8 @@\n     DETECTION,\n     DETECTION_ALERT,\n     YAML_DETECTION_ONBOARD,\n-    ANOMALY_DETECTION,\n-    MERGE,\n     // TODO: deprecate ALERT task type", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2MTczMQ==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430861731", "bodyText": "Update error log accordingly.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:16:39Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/anomaly/task/TaskInfoFactory.java", "diffHunk": "@@ -58,25 +54,9 @@ public static TaskInfo getTaskInfoFromTaskType(TaskType taskType, String taskInf\n         case YAML_DETECTION_ONBOARD:\n           taskInfo = OBJECT_MAPPER.readValue(taskInfoString, YamlOnboardingTaskInfo.class);\n           break;\n-        case ANOMALY_DETECTION:\n-          taskInfo = OBJECT_MAPPER.readValue(taskInfoString, DetectionTaskInfo.class);\n-          break;\n-        case MERGE:\n-          LOG.error(\"TaskType MERGE not supported\");\n-          break;\n         case MONITOR:\n           taskInfo = OBJECT_MAPPER.readValue(taskInfoString, MonitorTaskInfo.class);\n           break;\n-        case ALERT:\n-        case ALERT2:\n-          taskInfo = OBJECT_MAPPER.readValue(taskInfoString, AlertTaskInfo.class);\n-          break;\n-        case DATA_COMPLETENESS:\n-          taskInfo = OBJECT_MAPPER.readValue(taskInfoString, DataCompletenessTaskInfo.class);\n-          break;\n-        case CLASSIFICATION:\n-          taskInfo = OBJECT_MAPPER.readValue(taskInfoString, ClassificationTaskInfo.class);\n-          break;\n         default:\n           LOG.error(\"TaskType must be one of ANOMALY_DETECTION, MONITOR, ALERT, ALERT2, DATA_COMPLETENESS, CLASSIFICATION\");", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2MTk1Nw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430861957", "bodyText": "Add a simple description for each task type.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:17:37Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/anomaly/task/TaskConstants.java", "diffHunk": "@@ -26,15 +26,8 @@\n     DETECTION,\n     DETECTION_ALERT,\n     YAML_DETECTION_ONBOARD,\n-    ANOMALY_DETECTION,\n-    MERGE,\n     // TODO: deprecate ALERT task type\n-    ALERT,\n-    ALERT2,\n-    MONITOR,\n-    DATA_COMPLETENESS,\n-    CLASSIFICATION,\n-    REPLAY\n+    MONITOR", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyMjYzOA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r431522638", "bodyText": "Added one line description each type.", "author": "vincentchenjl", "createdAt": "2020-05-28T00:49:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2MTk1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2MzY0Nw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430863647", "bodyText": "anomalyFunctionDAO is not used, including AnomalyFunctionManager.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:24:27Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/common/BaseThirdEyeApplication.java", "diffHunk": "@@ -51,11 +46,9 @@\n   protected final Logger LOG = LoggerFactory.getLogger(this.getClass());\n \n   protected AnomalyFunctionManager anomalyFunctionDAO;", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2Mzg2NA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430863864", "bodyText": "AnomalyFunctionFactory is not used.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:25:16Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/ThirdEyeDashboardApplication.java", "diffHunk": "@@ -160,14 +155,12 @@ public void run(ThirdEyeDashboardConfiguration config, Environment env)\n \n     AnomalyFunctionFactory anomalyFunctionFactory = new AnomalyFunctionFactory(config.getFunctionConfigPath());", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyNjkzOA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r431526938", "bodyText": "anomalyFunctionFactory is used to initialize AnomalyResource, DataResource, and AnomaliesResource. Could we confirm all these three resources are not used?", "author": "vincentchenjl", "createdAt": "2020-05-28T01:06:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2Mzg2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk0MjgzOA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r431942838", "bodyText": "@jihaozh can you check which resource is used? I believe most endpoints in AnomalyResource and AnomaliesResource are not used. From Harley's doc only \"/anomalies/search/time/\" is used, but let's double check with them.", "author": "xiaohui-sun", "createdAt": "2020-05-28T15:51:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2Mzg2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjAwNDAxNw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r432004017", "bodyText": "I think AnomalyResource is not used.  In AnomaliesResource, only the search endpoints listed by Harley is used. DataResource is being used, but it shouldn't need anomalyFunctionFactory anymore.", "author": "jihaozh", "createdAt": "2020-05-28T17:28:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2Mzg2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc4OTY1MQ==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r432789651", "bodyText": "When we search for anomalies by using /anomalies/search/time/, we construct AnomalyDetails, and it requires BaseAnomalyFunction to do it.", "author": "vincentchenjl", "createdAt": "2020-05-30T00:18:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2Mzg2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NDA5MA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430864090", "bodyText": "AlertFilterFactory is not used.\nAll the classes under org.apache.pinot.thirdeye.detector.email.filter are not used.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:26:09Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/ThirdEyeDashboardApplication.java", "diffHunk": "@@ -160,14 +155,12 @@ public void run(ThirdEyeDashboardConfiguration config, Environment env)\n \n     AnomalyFunctionFactory anomalyFunctionFactory = new AnomalyFunctionFactory(config.getFunctionConfigPath());\n     AlertFilterFactory alertFilterFactory = new AlertFilterFactory(config.getAlertFilterConfigPath());", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyNzczMQ==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r431527731", "bodyText": "Same as above.", "author": "vincentchenjl", "createdAt": "2020-05-28T01:09:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NDA5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NDYyMw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430864623", "bodyText": "The above three lines are not used.\nenv.jersey().register(new DataResource(anomalyFunctionFactory, alertFilterFactory));\t    env.jersey().register(new DataResource(anomalyFunctionFactory, alertFilterFactory));\nenv.jersey().register(new AnomaliesResource(anomalyFunctionFactory, alertFilterFactory));", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:28:13Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/ThirdEyeDashboardApplication.java", "diffHunk": "@@ -181,7 +174,6 @@ public void run(ThirdEyeDashboardConfiguration config, Environment env)\n     env.jersey().register(new AutoOnboardResource(config));\n     env.jersey().register(new ConfigResource(DAO_REGISTRY.getConfigDAO()));\n     env.jersey().register(new CustomizedEventResource(DAO_REGISTRY.getEventDAO()));\n-    env.jersey().register(new TimeSeriesResource());", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NDg0MA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430864840", "bodyText": "This is not used.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:29:02Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/AnomalyResource.java", "diffHunk": "@@ -101,21 +99,18 @@\n   private MergedAnomalyResultManager anomalyMergedResultDAO;\n   private AlertConfigManager emailConfigurationDAO;\n   private MergedAnomalyResultManager mergedAnomalyResultDAO;\n-  private AutotuneConfigManager autotuneConfigDAO;\n   private DatasetConfigManager datasetConfigDAO;\n   private AnomalyFunctionFactory anomalyFunctionFactory;\n   private AlertFilterFactory alertFilterFactory;\n   private LoadingCache<String, Long> collectionMaxDataTimeCache;\n \n   private static final DAORegistry DAO_REGISTRY = DAORegistry.getInstance();\n \n-  public AnomalyResource(AnomalyFunctionFactory anomalyFunctionFactory, AlertFilterFactory alertFilterFactory,\n-      AlertFilterAutotuneFactory alertFilterAutotuneFactory) {\n+  public AnomalyResource(AnomalyFunctionFactory anomalyFunctionFactory, AlertFilterFactory alertFilterFactory) {\n     this.anomalyFunctionDAO = DAO_REGISTRY.getAnomalyFunctionDAO();", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyOTI2Ng==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r431529266", "bodyText": "anomalyFunctionDAO is used in multiple places in this class.", "author": "vincentchenjl", "createdAt": "2020-05-28T01:15:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NDg0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NTAwMw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430865003", "bodyText": "What is the difference between anomalyMergedResultDAO and mergedAnomalyResultDAO. Seems duplicate.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:29:37Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/AnomalyResource.java", "diffHunk": "@@ -101,21 +99,18 @@\n   private MergedAnomalyResultManager anomalyMergedResultDAO;\n   private AlertConfigManager emailConfigurationDAO;\n   private MergedAnomalyResultManager mergedAnomalyResultDAO;\n-  private AutotuneConfigManager autotuneConfigDAO;\n   private DatasetConfigManager datasetConfigDAO;\n   private AnomalyFunctionFactory anomalyFunctionFactory;\n   private AlertFilterFactory alertFilterFactory;\n   private LoadingCache<String, Long> collectionMaxDataTimeCache;\n \n   private static final DAORegistry DAO_REGISTRY = DAORegistry.getInstance();\n \n-  public AnomalyResource(AnomalyFunctionFactory anomalyFunctionFactory, AlertFilterFactory alertFilterFactory,\n-      AlertFilterAutotuneFactory alertFilterAutotuneFactory) {\n+  public AnomalyResource(AnomalyFunctionFactory anomalyFunctionFactory, AlertFilterFactory alertFilterFactory) {\n     this.anomalyFunctionDAO = DAO_REGISTRY.getAnomalyFunctionDAO();\n     this.anomalyMergedResultDAO = DAO_REGISTRY.getMergedAnomalyResultDAO();", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyODA0MA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r431528040", "bodyText": "Both these two are used in the class. If we r sure AnomalyResource is not used, we can remove the whole class.", "author": "vincentchenjl", "createdAt": "2020-05-28T01:11:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NTAwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTkzNTU1OQ==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r431935559", "bodyText": "The question is duplication. We should remove one of them.", "author": "xiaohui-sun", "createdAt": "2020-05-28T15:41:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NTAwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NTA2OA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430865068", "bodyText": "This is not used.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:29:50Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/AnomalyResource.java", "diffHunk": "@@ -101,21 +99,18 @@\n   private MergedAnomalyResultManager anomalyMergedResultDAO;\n   private AlertConfigManager emailConfigurationDAO;\n   private MergedAnomalyResultManager mergedAnomalyResultDAO;\n-  private AutotuneConfigManager autotuneConfigDAO;\n   private DatasetConfigManager datasetConfigDAO;\n   private AnomalyFunctionFactory anomalyFunctionFactory;\n   private AlertFilterFactory alertFilterFactory;\n   private LoadingCache<String, Long> collectionMaxDataTimeCache;\n \n   private static final DAORegistry DAO_REGISTRY = DAORegistry.getInstance();\n \n-  public AnomalyResource(AnomalyFunctionFactory anomalyFunctionFactory, AlertFilterFactory alertFilterFactory,\n-      AlertFilterAutotuneFactory alertFilterAutotuneFactory) {\n+  public AnomalyResource(AnomalyFunctionFactory anomalyFunctionFactory, AlertFilterFactory alertFilterFactory) {\n     this.anomalyFunctionDAO = DAO_REGISTRY.getAnomalyFunctionDAO();\n     this.anomalyMergedResultDAO = DAO_REGISTRY.getMergedAnomalyResultDAO();\n     this.emailConfigurationDAO = DAO_REGISTRY.getAlertConfigDAO();\n     this.mergedAnomalyResultDAO = DAO_REGISTRY.getMergedAnomalyResultDAO();\n-    this.autotuneConfigDAO = DAO_REGISTRY.getAutotuneConfigDAO();\n     this.datasetConfigDAO = DAO_REGISTRY.getDatasetConfigDAO();\n     this.anomalyFunctionFactory = anomalyFunctionFactory;", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NTIxMw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430865213", "bodyText": "Not used.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:30:23Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/AnomalyResource.java", "diffHunk": "@@ -101,21 +99,18 @@\n   private MergedAnomalyResultManager anomalyMergedResultDAO;\n   private AlertConfigManager emailConfigurationDAO;\n   private MergedAnomalyResultManager mergedAnomalyResultDAO;\n-  private AutotuneConfigManager autotuneConfigDAO;\n   private DatasetConfigManager datasetConfigDAO;\n   private AnomalyFunctionFactory anomalyFunctionFactory;\n   private AlertFilterFactory alertFilterFactory;", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc5MDQ0MA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r432790440", "bodyText": "It is used in line 141.\nanomalyResults = AlertFilterHelper.applyFiltrationRule(anomalyResults, alertFilterFactory);", "author": "vincentchenjl", "createdAt": "2020-05-30T00:24:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NTIxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NTUxOQ==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430865519", "bodyText": "Not used.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:31:05Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/datalayer/pojo/DatasetConfigBean.java", "diffHunk": "@@ -93,10 +89,6 @@\n   private boolean requiresCompletenessCheck = false;", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NTc1MA==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r430865750", "bodyText": "Not used.", "author": "xiaohui-sun", "createdAt": "2020-05-27T05:31:54Z", "path": "thirdeye/thirdeye-pinot/src/test/java/org/apache/pinot/thirdeye/datalayer/DaoTestUtils.java", "diffHunk": "@@ -275,22 +273,6 @@ public static DetectionStatusDTO getTestDetectionStatus(String dataset, long dat\n     return detectionStatusDTO;\n   }\n \n-  public static AutotuneConfigDTO getTestAutotuneConfig(long functionId, long start, long end) {\n-    AutotuneConfigDTO autotuneConfigDTO = new AutotuneConfigDTO();\n-    autotuneConfigDTO.setFunctionId(functionId);\n-    autotuneConfigDTO.setStartTime(start);\n-    autotuneConfigDTO.setEndTime(end);\n-    autotuneConfigDTO.setPerformanceEvaluationMethod(PerformanceEvaluationMethod.ANOMALY_PERCENTAGE);\n-    autotuneConfigDTO.setLastUpdateTimestamp(DateTime.now().getMillis());\n-    Map<String, String> config = new HashMap<>();\n-    config.put(\"ConfigKey\", \"ConfigValue\");\n-    autotuneConfigDTO.setConfiguration(config);\n-    Map<String, Double> performance = new HashMap<>();\n-    performance.put(autotuneConfigDTO.getPerformanceEvaluationMethod().name(), 0.5);\n-    autotuneConfigDTO.setPerformance(performance);\n-    return autotuneConfigDTO;\n-  }\n-\n   public static ClassificationConfigDTO getTestClassificationConfig(String name, List<Long> mainFunctionIdList,", "originalCommit": "6f6e945a49fecadf9acc246240153c938b855d35", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyODcxNw==", "url": "https://github.com/apache/pinot/pull/5435#discussion_r431528717", "bodyText": "This can be removed in next PR with all the unused DAO objects.", "author": "vincentchenjl", "createdAt": "2020-05-28T01:13:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NTc1MA=="}], "type": "inlineReview"}, {"oid": "2d345700efcf3f62b12fc0b0021ce30a8723d744", "url": "https://github.com/apache/pinot/commit/2d345700efcf3f62b12fc0b0021ce30a8723d744", "message": "more cleanup from PR comments", "committedDate": "2020-05-28T00:48:46Z", "type": "commit"}, {"oid": "d8f111aafa93b85394f1dc223241a0c4f93e6b5a", "url": "https://github.com/apache/pinot/commit/d8f111aafa93b85394f1dc223241a0c4f93e6b5a", "message": "minor change", "committedDate": "2020-05-28T00:57:24Z", "type": "commit"}, {"oid": "dbce47560652897c86789a64b373da3b9dbe7b98", "url": "https://github.com/apache/pinot/commit/dbce47560652897c86789a64b373da3b9dbe7b98", "message": "more cleanup", "committedDate": "2020-05-30T00:22:56Z", "type": "commit"}]}