{"pr_number": 5603, "pr_title": "Fix LocalPinotFSTest that fails on fast hardware", "pr_createdAt": "2020-06-22T18:40:39Z", "pr_url": "https://github.com/apache/pinot/pull/5603", "timeline": [{"oid": "b721ead9ec1693dede866a046959c33d306a9e66", "url": "https://github.com/apache/pinot/commit/b721ead9ec1693dede866a046959c33d306a9e66", "message": "Fix LocalPinotFSTest that fails on fast hardware\n\nThe unit test would fail if the assertion would be executed in the same\nmillisecond than the file modification.", "committedDate": "2020-06-22T18:38:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc5MjA4OQ==", "url": "https://github.com/apache/pinot/pull/5603#discussion_r443792089", "bodyText": "Perhaps add sleep to ensure < can be used?", "author": "mayankshriv", "createdAt": "2020-06-22T19:58:15Z", "path": "pinot-spi/src/test/java/org/apache/pinot/spi/filesystem/LocalPinotFSTest.java", "diffHunk": "@@ -188,7 +188,7 @@ public void testFS()\n     localPinotFS.touch(nonExistingFile.toURI());\n     Assert.assertTrue(nonExistingFile.exists());\n     long currentTime = System.currentTimeMillis();\n-    Assert.assertTrue(localPinotFS.lastModified(nonExistingFile.toURI()) < currentTime);\n+    Assert.assertTrue(localPinotFS.lastModified(nonExistingFile.toURI()) <= currentTime);", "originalCommit": "b721ead9ec1693dede866a046959c33d306a9e66", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc5OTM4Mg==", "url": "https://github.com/apache/pinot/pull/5603#discussion_r443799382", "bodyText": "I don't see in what <= is not a valid assertion. I'm not a fan of adding sleeps in a codebase :/", "author": "daniellavoie", "createdAt": "2020-06-22T20:13:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc5MjA4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzgwMTAxNw==", "url": "https://github.com/apache/pinot/pull/5603#discussion_r443801017", "bodyText": "I dont believe mayank was asking to add sleep in code base. I think he was suggesting a sleep before line 190. Say, Thread.sleep(10)", "author": "mcvsubbu", "createdAt": "2020-06-22T20:17:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc5MjA4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzgwMjc1Nw==", "url": "https://github.com/apache/pinot/pull/5603#discussion_r443802757", "bodyText": "That's what I understood too. One or the other I don't really mind. I just think that an equals value is still a valid assertion in that context and would save us an irrelevant Thread.sleep. Just my 2 cents :)", "author": "daniellavoie", "createdAt": "2020-06-22T20:20:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc5MjA4OQ=="}], "type": "inlineReview"}]}