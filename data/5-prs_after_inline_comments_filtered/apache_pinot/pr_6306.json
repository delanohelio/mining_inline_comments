{"pr_number": 6306, "pr_title": "some geo function improvements", "pr_createdAt": "2020-12-02T06:30:19Z", "pr_url": "https://github.com/apache/pinot/pull/6306", "timeline": [{"oid": "d434bb9a5bcc8610fbdd5ad65e1d42c854f9564c", "url": "https://github.com/apache/pinot/commit/d434bb9a5bcc8610fbdd5ad65e1d42c854f9564c", "message": "some geo function improvements", "committedDate": "2020-12-02T05:57:53Z", "type": "commit"}, {"oid": "ad112bd795f79284e8266ee5f055cc7ca47319ea", "url": "https://github.com/apache/pinot/commit/ad112bd795f79284e8266ee5f055cc7ca47319ea", "message": "relax check on StContain", "committedDate": "2020-12-02T06:24:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzkyNzY1NA==", "url": "https://github.com/apache/pinot/pull/6306#discussion_r533927654", "bodyText": "remove the comment?", "author": "xiangfu0", "createdAt": "2020-12-02T06:34:50Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/geospatial/transform/function/StDistanceFunction.java", "diffHunk": "@@ -126,7 +127,8 @@ private static double sphericalDistance(Geometry leftGeometry, Geometry rightGeo\n     Point leftPoint = (Point) leftGeometry;\n     Point rightPoint = (Point) rightGeometry;\n \n-    return greatCircleDistance(leftPoint.getY(), leftPoint.getX(), rightPoint.getY(), rightPoint.getX());\n+//    return greatCircleDistance(leftPoint.getY(), leftPoint.getX(), rightPoint.getY(), rightPoint.getX());", "originalCommit": "ad112bd795f79284e8266ee5f055cc7ca47319ea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzkyODAwNQ==", "url": "https://github.com/apache/pinot/pull/6306#discussion_r533928005", "bodyText": "missing space\nif (_bytesResult == null) {", "author": "xiangfu0", "createdAt": "2020-12-02T06:35:52Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/LiteralTransformFunction.java", "diffHunk": "@@ -145,7 +147,11 @@ public Dictionary getDictionary() {\n \n   @Override\n   public byte[][] transformToBytesValuesSV(ProjectionBlock projectionBlock) {\n-    throw new UnsupportedOperationException();\n+    if(_bytesResult==null) {", "originalCommit": "ad112bd795f79284e8266ee5f055cc7ca47319ea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1d735501741c3ca218e6d15f303f977fdcb5274d", "url": "https://github.com/apache/pinot/commit/1d735501741c3ca218e6d15f303f977fdcb5274d", "message": "addressed comments", "committedDate": "2020-12-02T06:47:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5NjgyMg==", "url": "https://github.com/apache/pinot/pull/6306#discussion_r534396822", "bodyText": "Does boolean work as argument? If not, int might be a better option?", "author": "Jackie-Jiang", "createdAt": "2020-12-02T18:40:27Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/geospatial/transform/function/ScalarFunctions.java", "diffHunk": "@@ -43,6 +44,23 @@\n         .serialize(GeometryUtils.GEOMETRY_FACTORY.createPoint(new Coordinate(x, y)));\n   }\n \n+  /**\n+   * Creates a point.\n+   *\n+   * @param x x\n+   * @param y y\n+   * @param isGeography if it's geography\n+   * @return the created point\n+   */\n+  @ScalarFunction\n+  public static byte[] stPoint(double x, double y, double isGeography) {", "originalCommit": "ad112bd795f79284e8266ee5f055cc7ca47319ea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQzOTA1Ng==", "url": "https://github.com/apache/pinot/pull/6306#discussion_r534439056", "bodyText": "Unfortunately it does not.... The PQL parser will invoke this scalar function and pass in the constant. Since boolean is not available in PQL/SQL, we need to use a number. Also, somehow the parser parses 1 into a double type, any idea on that?", "author": "yupeng9", "createdAt": "2020-12-02T19:50:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5NjgyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ3ODQ1Ng==", "url": "https://github.com/apache/pinot/pull/6306#discussion_r534478456", "bodyText": "The parser parses the value based on the method signature. If you change the third argument to int, it should be able to parse 1 to int", "author": "Jackie-Jiang", "createdAt": "2020-12-02T21:01:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5NjgyMg=="}], "type": "inlineReview"}, {"oid": "292e538955d65c6dce447dcd16be1680d2cc23d2", "url": "https://github.com/apache/pinot/commit/292e538955d65c6dce447dcd16be1680d2cc23d2", "message": "type change", "committedDate": "2020-12-02T21:35:06Z", "type": "commit"}]}