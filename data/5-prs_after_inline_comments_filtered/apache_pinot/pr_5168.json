{"pr_number": 5168, "pr_title": "Refactor DistinctQueriesTest to cover more scenarios", "pr_createdAt": "2020-03-20T05:41:25Z", "pr_url": "https://github.com/apache/pinot/pull/5168", "timeline": [{"oid": "54488d9fa72ab82033b47ee43375e8b843e99f4c", "url": "https://github.com/apache/pinot/commit/54488d9fa72ab82033b47ee43375e8b843e99f4c", "message": "Refactor DistinctQueriesTest to cover more scenarios\n\n- Test all data types (including BYTES)\n- Test empty responses\n- Test merge of non-empty response and empty response for both server side and broker side\n\nTODO:\n- ORDER BY bytesColumn is not properly supported right now\n- DistinceTable limit is not properly set", "committedDate": "2020-03-20T18:19:58Z", "type": "forcePushed"}, {"oid": "205aec16201e27b80e44df2e6e2d50664dc49977", "url": "https://github.com/apache/pinot/commit/205aec16201e27b80e44df2e6e2d50664dc49977", "message": "Refactor DistinctQueriesTest to cover more scenarios\n\n- Test all data types (including BYTES)\n- Test empty responses\n- Test merge of non-empty response and empty response for both server side and broker side\n\nTODO:\n- ORDER BY bytesColumn is not properly supported right now\n- DistinceTable limit is not properly set", "committedDate": "2020-03-30T00:05:13Z", "type": "forcePushed"}, {"oid": "65a7042e9e0b2309390d7a256b9aef04620943c7", "url": "https://github.com/apache/pinot/commit/65a7042e9e0b2309390d7a256b9aef04620943c7", "message": "Refactor DistinctQueriesTest to cover more scenarios\n\n- Test all data types (including BYTES)\n- Test empty responses\n- Test merge of non-empty response and empty response for both server side and broker side\n\nTODO:\n- ORDER BY bytesColumn is not properly supported right now\n- DistinceTable limit is not properly set", "committedDate": "2020-03-30T00:59:35Z", "type": "forcePushed"}, {"oid": "74574eabac8c987cdfceba4ad174584cefd1a472", "url": "https://github.com/apache/pinot/commit/74574eabac8c987cdfceba4ad174584cefd1a472", "message": "Refactor DistinctQueriesTest to cover more scenarios\n\n- Test all data types (including BYTES)\n- Test empty responses\n- Test merge of non-empty response and empty response for both server side and broker side\n\nTODO:\n- ORDER BY bytesColumn is not properly supported right now\n- DistinceTable limit is not properly set", "committedDate": "2020-03-30T21:55:14Z", "type": "commit"}, {"oid": "74574eabac8c987cdfceba4ad174584cefd1a472", "url": "https://github.com/apache/pinot/commit/74574eabac8c987cdfceba4ad174584cefd1a472", "message": "Refactor DistinctQueriesTest to cover more scenarios\n\n- Test all data types (including BYTES)\n- Test empty responses\n- Test merge of non-empty response and empty response for both server side and broker side\n\nTODO:\n- ORDER BY bytesColumn is not properly supported right now\n- DistinceTable limit is not properly set", "committedDate": "2020-03-30T21:55:14Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE4OTE1Mg==", "url": "https://github.com/apache/pinot/pull/5168#discussion_r401189152", "bodyText": "IIUC, this is needed because for the case of empty, it may return a new object as opposed to merging into existing ones?", "author": "siddharthteotia", "createdAt": "2020-03-31T20:19:18Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/query/reduce/DistinctDataTableReducer.java", "diffHunk": "@@ -108,7 +108,7 @@ public void reduceAndSetResults(String tableName, DataSchema dataSchema,\n       if (mergedIntermediateResult == null) {\n         mergedIntermediateResult = intermediateResultToMerge;\n       } else {\n-        _aggregationFunction.merge(mergedIntermediateResult, intermediateResultToMerge);\n+        mergedIntermediateResult = _aggregationFunction.merge(mergedIntermediateResult, intermediateResultToMerge);", "originalCommit": "74574eabac8c987cdfceba4ad174584cefd1a472", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTIzMTQ0NQ==", "url": "https://github.com/apache/pinot/pull/5168#discussion_r401231445", "bodyText": "Yes, and we should not make the assumption that the second result is merged into the first (for Double intermediateResult, that is not even possible)", "author": "Jackie-Jiang", "createdAt": "2020-03-31T21:39:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE4OTE1Mg=="}], "type": "inlineReview"}]}