{"pr_number": 5234, "pr_title": "[TE] add rate limiter to batch alert onboarding", "pr_createdAt": "2020-04-10T00:37:51Z", "pr_url": "https://github.com/apache/pinot/pull/5234", "timeline": [{"oid": "5db1df231c062e79bbf1a062bf72725338ff3060", "url": "https://github.com/apache/pinot/commit/5db1df231c062e79bbf1a062bf72725338ff3060", "message": "[TE] add rate limiter on alert onboarding", "committedDate": "2020-04-09T23:58:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE0NDI5NA==", "url": "https://github.com/apache/pinot/pull/5234#discussion_r407144294", "bodyText": "Can you put the rate limit in the error message?", "author": "xiaohui-sun", "createdAt": "2020-04-12T04:30:36Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/yaml/YamlResource.java", "diffHunk": "@@ -366,6 +369,11 @@ long createDetectionConfig(@NotNull String yamlDetectionConfig) throws Exception\n   }\n \n   long createDetectionConfig(@NotNull String payload, long startTime, long endTime) throws Exception {\n+    // if can't acquire alert onboarding QPS permit, throw an exception\n+    if (!this.onboardingRateLimiter.tryAcquire()) {\n+      throw new RuntimeException(\"Server is busy handling create detection requests. Please retry later.\");", "originalCommit": "5db1df231c062e79bbf1a062bf72725338ff3060", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "30e4e99fd7b636dc23a85a8a3abf0dd62345792d", "url": "https://github.com/apache/pinot/commit/30e4e99fd7b636dc23a85a8a3abf0dd62345792d", "message": "address comment", "committedDate": "2020-04-13T17:51:11Z", "type": "commit"}]}