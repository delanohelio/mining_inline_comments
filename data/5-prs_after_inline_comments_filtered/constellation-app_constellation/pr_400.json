{"pr_number": 400, "pr_title": "Add in type-to-filter attributes option for Import from CSV", "pr_createdAt": "2020-04-05T06:51:23Z", "pr_url": "https://github.com/constellation-app/constellation/pull/400", "timeline": [{"oid": "964f588d49dda6d89c3d9798a4c6092c2465907c", "url": "https://github.com/constellation-app/constellation/commit/964f588d49dda6d89c3d9798a4c6092c2465907c", "message": "Add in type-to-filter attributes option for Import from CSV", "committedDate": "2020-04-05T06:32:52Z", "type": "commit"}, {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40", "url": "https://github.com/constellation-app/constellation/commit/f84b0d6c50d93c074c0433a4583a6667ca523c40", "message": "Add in type-to-filter attributes option for Import from CSV", "committedDate": "2020-04-05T06:38:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4Mjk2OQ==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403782969", "bodyText": "This should be setAttributeFilter, and the variable should be attributeFilter.", "author": "cygnus-x-1", "createdAt": "2020-04-06T00:49:25Z", "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -488,6 +508,10 @@ public void setShowAllSchemaAttributes(final boolean showAllSchemaAttributes) {\n         // TODO: the tick box could have changed but the menu item isn't updated, fix it\n     }\n \n+    public void setShowFilteredSchemaAttributes(final String filterAttributes) {", "originalCommit": "f84b0d6c50d93c074c0433a4583a6667ca523c40", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzA0MA==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783040", "bodyText": "You should use contains over matches with a regex.", "author": "cygnus-x-1", "createdAt": "2020-04-06T00:49:54Z", "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -328,8 +334,22 @@ public void updateDisplayedAttributes() {\n \n     private Map<String, Attribute> createDisplayedAttributes(final Map<String, Attribute> autoAddedAttributes, final Map<String, Attribute> manuallyAddedAttributes) {\n         Map<String, Attribute> displayedAttributes = new HashMap<>();\n-        displayedAttributes.putAll(manuallyAddedAttributes);\n-        displayedAttributes.putAll(autoAddedAttributes);\n+\n+        if (filterAttributes != null &&  filterAttributes.length() > 0) {\n+            for (String name : autoAddedAttributes.keySet()) {\n+                if (name.toUpperCase().matches(\".*\" + filterAttributes.toUpperCase() + \".*\")) {", "originalCommit": "f84b0d6c50d93c074c0433a4583a6667ca523c40", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzEyNw==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783127", "bodyText": "I think we have a utility method to check for both bull and blank - @arcturus2?", "author": "cygnus-x-1", "createdAt": "2020-04-06T00:50:32Z", "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -328,8 +334,22 @@ public void updateDisplayedAttributes() {\n \n     private Map<String, Attribute> createDisplayedAttributes(final Map<String, Attribute> autoAddedAttributes, final Map<String, Attribute> manuallyAddedAttributes) {\n         Map<String, Attribute> displayedAttributes = new HashMap<>();\n-        displayedAttributes.putAll(manuallyAddedAttributes);\n-        displayedAttributes.putAll(autoAddedAttributes);\n+\n+        if (filterAttributes != null &&  filterAttributes.length() > 0) {", "originalCommit": "f84b0d6c50d93c074c0433a4583a6667ca523c40", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzgxMzg2NA==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403813864", "bodyText": "isEmpty?", "author": "CrucisGamma", "createdAt": "2020-04-06T03:39:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzgzODc3Mw==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403838773", "bodyText": "StringUtils.isBlank(...) and StringUtils.isNotBlank(...)", "author": "antares1470", "createdAt": "2020-04-06T05:34:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg2NzYwNg==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403867606", "bodyText": "Sorry for the delay @cygnus-x-1 in response, @antares1470 thanks for chipping in!", "author": "arcturus2", "createdAt": "2020-04-06T06:59:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQzMDA5Mw==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r404430093", "bodyText": "I can find only one instance of 'isBlank' being called (at ,\nCoreUtilities\\src\\au\\gov\\asd\\tac\\constellation\\utilities\\temporal\\TemporalFormatting.java line 497ish), no isNotBlank and about 515 isEmpty (515 empties? We are a territory but this is not NT).", "author": "CrucisGamma", "createdAt": "2020-04-06T22:37:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDUxNDExNA==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r404514114", "bodyText": "StringUtils.isBlank(str) is equivalent to str == null || str.IsEmpty().\nSimilarly, StringUtils.isNotBlank(str) is equivalent to str !=null && !str.isEmpty()\nWe probably haven't gotten around to fixing all instances yet but this is the way we'd prefer to test for emptiness (unless of course the null check isn't needed in which case just use isEmpty)", "author": "antares1470", "createdAt": "2020-04-07T03:27:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzEyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzE3Ng==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783176", "bodyText": "Make name final.", "author": "cygnus-x-1", "createdAt": "2020-04-06T00:50:54Z", "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -328,8 +334,22 @@ public void updateDisplayedAttributes() {\n \n     private Map<String, Attribute> createDisplayedAttributes(final Map<String, Attribute> autoAddedAttributes, final Map<String, Attribute> manuallyAddedAttributes) {\n         Map<String, Attribute> displayedAttributes = new HashMap<>();\n-        displayedAttributes.putAll(manuallyAddedAttributes);\n-        displayedAttributes.putAll(autoAddedAttributes);\n+\n+        if (filterAttributes != null &&  filterAttributes.length() > 0) {\n+            for (String name : autoAddedAttributes.keySet()) {", "originalCommit": "f84b0d6c50d93c074c0433a4583a6667ca523c40", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzE5MA==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783190", "bodyText": "Make name final.", "author": "cygnus-x-1", "createdAt": "2020-04-06T00:51:03Z", "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -328,8 +334,22 @@ public void updateDisplayedAttributes() {\n \n     private Map<String, Attribute> createDisplayedAttributes(final Map<String, Attribute> autoAddedAttributes, final Map<String, Attribute> manuallyAddedAttributes) {\n         Map<String, Attribute> displayedAttributes = new HashMap<>();\n-        displayedAttributes.putAll(manuallyAddedAttributes);\n-        displayedAttributes.putAll(autoAddedAttributes);\n+\n+        if (filterAttributes != null &&  filterAttributes.length() > 0) {\n+            for (String name : autoAddedAttributes.keySet()) {\n+                if (name.toUpperCase().matches(\".*\" + filterAttributes.toUpperCase() + \".*\")) {\n+                    displayedAttributes.put(name, autoAddedAttributes.get(name));\n+                }\n+            }\n+            for (String name : manuallyAddedAttributes.keySet()) {", "originalCommit": "f84b0d6c50d93c074c0433a4583a6667ca523c40", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzM1OQ==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783359", "bodyText": "You could make this more concise using:\nif (destination == null) {\n    return;\n}\nthis.currentDestination = destination;\n\n...but is there an issue with setting currentDestination to null?", "author": "cygnus-x-1", "createdAt": "2020-04-06T00:52:09Z", "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -170,7 +171,12 @@ public void setClearManuallyAdded(final boolean b) {\n     }\n \n     public void setDestination(final ImportDestination<?> destination) {\n-        this.currentDestination = destination;\n+        if (destination != null) {", "originalCommit": "f84b0d6c50d93c074c0433a4583a6667ca523c40", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzgxMjM2MA==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403812360", "bodyText": "No, I specifically am calling addDestination with 'null' from the RunPane.java call.  If it's already got a valid destination setup, I don't want to overwrite it.  I kept with the 'this.currentDestination' which should probably be just 'currentDestination' though.", "author": "CrucisGamma", "createdAt": "2020-04-06T03:32:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzM1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzgzOTk0Mg==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403839942", "bodyText": "Sonar will flag the return statement in the void function so I'd say it would be ideal if it can be written without it (if there is a nice way of doing so)", "author": "antares1470", "createdAt": "2020-04-06T05:38:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzM1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg3ODg4MA==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403878880", "bodyText": "@CrucisGamma @antares1470  I've tagged you both on a different PR but I did a test to see if SQ complained about an empty return and it was OK with it. See #401.", "author": "arcturus2", "createdAt": "2020-04-06T07:24:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzM1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzgxNA==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783814", "bodyText": "In the interest of good UX, I would strongly recommend having a visual element to this filter. Having it just hide attributes as you type with no visual feedback is begging for erroneous bug reports.", "author": "cygnus-x-1", "createdAt": "2020-04-06T00:55:15Z", "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/RunPane.java", "diffHunk": "@@ -186,6 +189,19 @@ public RunPane(final ImportController importController) {\n \n         attributePane.addRow(0, sourceVertexScrollPane, destinationVertexScrollPane, transactionScrollPane);\n \n+        attributePane.setOnKeyPressed(event -> {", "originalCommit": "f84b0d6c50d93c074c0433a4583a6667ca523c40", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzgxNTY0NA==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403815644", "bodyText": "I've added a blurb to the 'help text' on that middle section and the responsiveness of it changing is fairly clear that you caused something to change when you start typing.  I did have it as a text edit button under Options, but that sucked", "author": "CrucisGamma", "createdAt": "2020-04-06T03:48:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzgxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg1NDA0MA==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403854040", "bodyText": "What about something like, when you start typing, a text input pops up to show that you're doing something?", "author": "cygnus-x-1", "createdAt": "2020-04-06T06:25:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzgxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE0NDM4MQ==", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r404144381", "bodyText": "Have added the text field in.", "author": "CrucisGamma", "createdAt": "2020-04-06T14:39:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzgxNA=="}], "type": "inlineReview"}, {"oid": "15c772b2035ddaccc006ad774627e920979ce979", "url": "https://github.com/constellation-app/constellation/commit/15c772b2035ddaccc006ad774627e920979ce979", "message": "Updates", "committedDate": "2020-04-06T08:36:33Z", "type": "commit"}, {"oid": "f338d73fd56a53439450d02af2559b774b1236c4", "url": "https://github.com/constellation-app/constellation/commit/f338d73fd56a53439450d02af2559b774b1236c4", "message": "Add in type-to-filter attributes option for Import from CSV", "committedDate": "2020-04-06T14:37:33Z", "type": "commit"}, {"oid": "db349e7d579eec4df67b2fffbf9125bd0f6ce658", "url": "https://github.com/constellation-app/constellation/commit/db349e7d579eec4df67b2fffbf9125bd0f6ce658", "message": "Merge branch 'master' into update_error_format_messages", "committedDate": "2020-04-07T06:45:13Z", "type": "commit"}]}