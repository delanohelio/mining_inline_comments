{"pr_number": 559, "pr_title": "Make global parameters singletons", "pr_createdAt": "2020-06-02T05:31:11Z", "pr_url": "https://github.com/constellation-app/constellation/pull/559", "timeline": [{"oid": "76117ee717034698d47ed90738da9f72f1c460ff", "url": "https://github.com/constellation-app/constellation/commit/76117ee717034698d47ed90738da9f72f1c460ff", "message": "dummy_commit", "committedDate": "2020-05-27T07:09:57Z", "type": "commit"}, {"oid": "865210ddb1ba67dbf00542073f8d68f5f81a89f8", "url": "https://github.com/constellation-app/constellation/commit/865210ddb1ba67dbf00542073f8d68f5f81a89f8", "message": "Merge branch 'master' into Make-global-parameters-singletons", "committedDate": "2020-05-27T07:11:34Z", "type": "commit"}, {"oid": "dde35f5ef792026a20e1317c23edbe15a2a3493f", "url": "https://github.com/constellation-app/constellation/commit/dde35f5ef792026a20e1317c23edbe15a2a3493f", "message": "Merge branch 'master' into Make-global-parameters-singletons", "committedDate": "2020-05-28T06:39:06Z", "type": "commit"}, {"oid": "8ffcfc155d895795c36067be805d65b34bb6a92b", "url": "https://github.com/constellation-app/constellation/commit/8ffcfc155d895795c36067be805d65b34bb6a92b", "message": "Singleton fix", "committedDate": "2020-05-28T06:40:04Z", "type": "commit"}, {"oid": "8a6ff5c0644caa2595b463e0d74c890d646956ba", "url": "https://github.com/constellation-app/constellation/commit/8a6ff5c0644caa2595b463e0d74c890d646956ba", "message": "Update TestParametersPlugin.java", "committedDate": "2020-05-28T06:51:39Z", "type": "commit"}, {"oid": "b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b", "url": "https://github.com/constellation-app/constellation/commit/b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b", "message": "Merge branch 'master' into Make-global-parameters-singletons", "committedDate": "2020-06-02T05:11:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDI1MjE1Nw==", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r434252157", "bodyText": "If checking for whether a key exists, better using containsKey().\ni.e. if (!SINGLETON_MAP.containsKey(PARAMETER_ID)) {", "author": "antares1470", "createdAt": "2020-06-03T00:55:32Z", "path": "CoreDataAccessView/src/au/gov/asd/tac/constellation/views/dataaccess/CoreGlobalParameters.java", "diffHunk": "@@ -51,7 +55,26 @@\n      */\n     private static final int DATETIME_RANGE_PARAMETER_ID_INDEX = 1;\n     public static final String DATETIME_RANGE_PARAMETER_ID = PluginParameter.buildId(CoreGlobalParameters.class, \"datetime_range\");\n-\n+    \n+    // Map of string types, datetime types, etc.\n+    private static final Map<String,PluginParameter> SINGLETON_MAP = new HashMap<>();\n+    \n+    public static PluginParameter getStringParameterType(final String PARAMETER_ID) {\n+        if (SINGLETON_MAP.get(PARAMETER_ID) == null) {", "originalCommit": "b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDI1MjI5OQ==", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r434252299", "bodyText": "same here", "author": "antares1470", "createdAt": "2020-06-03T00:56:04Z", "path": "CoreDataAccessView/src/au/gov/asd/tac/constellation/views/dataaccess/CoreGlobalParameters.java", "diffHunk": "@@ -51,7 +55,26 @@\n      */\n     private static final int DATETIME_RANGE_PARAMETER_ID_INDEX = 1;\n     public static final String DATETIME_RANGE_PARAMETER_ID = PluginParameter.buildId(CoreGlobalParameters.class, \"datetime_range\");\n-\n+    \n+    // Map of string types, datetime types, etc.\n+    private static final Map<String,PluginParameter> SINGLETON_MAP = new HashMap<>();\n+    \n+    public static PluginParameter getStringParameterType(final String PARAMETER_ID) {\n+        if (SINGLETON_MAP.get(PARAMETER_ID) == null) {\n+            SINGLETON_MAP.put(PARAMETER_ID, StringParameterType.build(PARAMETER_ID));\n+        }\n+        \n+        return SINGLETON_MAP.get(PARAMETER_ID);\n+    }\n+    \n+    public static PluginParameter getDateTimeRangeParameterType(final String PARAMETER_ID) {\n+        if (SINGLETON_MAP.get(PARAMETER_ID) == null) {", "originalCommit": "b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ce586d92a561b2a7f8795e57890bbfa60f718bfb", "url": "https://github.com/constellation-app/constellation/commit/ce586d92a561b2a7f8795e57890bbfa60f718bfb", "message": "Merge branch 'master' into Make-global-parameters-singletons", "committedDate": "2020-06-03T05:43:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk5MDI4NA==", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r434990284", "bodyText": "Rather than having the parameter id's as keys (and having to deal with the issue of figuring out what type of parameter it is), couldn't you just build the parameters upfront and make the actual parameter objects the keys?", "author": "cygnus-x-1", "createdAt": "2020-06-04T04:48:03Z", "path": "CoreDataAccessView/src/au/gov/asd/tac/constellation/views/dataaccess/plugins/experimental/TestParametersPlugin.java", "diffHunk": "@@ -178,10 +178,10 @@ public PluginParameters createParameters() {\n         selected.setDescription(\"Only use selected elements\");\n         params.addParameter(selected);\n \n-        final PluginParameter<StringParameterValue> queryName = StringParameterType.build(CoreGlobalParameters.QUERY_NAME_PARAMETER_ID);\n+        final PluginParameter<StringParameterValue> queryName = CoreGlobalParameters.getStringParameterType(CoreGlobalParameters.QUERY_NAME_PARAMETER_ID);", "originalCommit": "ce586d92a561b2a7f8795e57890bbfa60f718bfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAzNjI1NA==", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r435036254", "bodyText": "Is that approach scalable? Could you elaborate? What would the \"value\" be if the object was the \"key\"?", "author": "sol695510", "createdAt": "2020-06-04T07:06:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk5MDI4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTczMzI1NQ==", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r435733255", "bodyText": "What would the \"value\" be if the object was the \"key\"?\n\n@cygnus-x-1 this is what I was going to ask too. Please elaborate when you can.", "author": "arcturus2", "createdAt": "2020-06-05T07:18:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk5MDI4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA1ODc3Mg==", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r437058772", "bodyText": "Key was probably the wrong word to use there. If the parameters are built up-front, you could refer to them directly (ie. CoreGlobalParameters.QUERY_NAME_PARAMETER), or look them up using their parameter ID. I guess this technically wouldn't make them singletons - however the root issue here was having multiple instances of them built across multiple modules, and that would be addressed. It would also make using them simpler as the developer wouldn't have to know what type they are up-front.", "author": "cygnus-x-1", "createdAt": "2020-06-08T23:40:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk5MDI4NA=="}], "type": "inlineReview"}, {"oid": "7723c367175cc6650e16c0faf2a589b77fb9b5bb", "url": "https://github.com/constellation-app/constellation/commit/7723c367175cc6650e16c0faf2a589b77fb9b5bb", "message": "Merge branch 'master' into Make-global-parameters-singletons", "committedDate": "2020-06-09T02:23:17Z", "type": "commit"}, {"oid": "84d17fdcae00b5aecf0adfc2e0d53efca539cabd", "url": "https://github.com/constellation-app/constellation/commit/84d17fdcae00b5aecf0adfc2e0d53efca539cabd", "message": "Merge branch 'master' into Make-global-parameters-singletons", "committedDate": "2020-06-10T00:14:48Z", "type": "commit"}, {"oid": "60b3df8bdec45060d0b227be43681eb93cb0fd93", "url": "https://github.com/constellation-app/constellation/commit/60b3df8bdec45060d0b227be43681eb93cb0fd93", "message": "Update TestParametersPlugin.java", "committedDate": "2020-06-10T04:05:23Z", "type": "commit"}, {"oid": "ccc5e8f3b5f81b78843e43ee832ad677feeb6f43", "url": "https://github.com/constellation-app/constellation/commit/ccc5e8f3b5f81b78843e43ee832ad677feeb6f43", "message": "Update CoreGlobalParameters.java", "committedDate": "2020-06-10T04:05:45Z", "type": "commit"}, {"oid": "cfb3c37a23861c27f40c75551915e35f27c35415", "url": "https://github.com/constellation-app/constellation/commit/cfb3c37a23861c27f40c75551915e35f27c35415", "message": "Remove unnecessary imports and code", "committedDate": "2020-06-10T04:33:51Z", "type": "commit"}, {"oid": "7e65ace50bc5c174f035a86710bd527be8d87e65", "url": "https://github.com/constellation-app/constellation/commit/7e65ace50bc5c174f035a86710bd527be8d87e65", "message": "Merge branch 'master' into Make-global-parameters-singletons", "committedDate": "2020-06-11T06:13:21Z", "type": "commit"}, {"oid": "0eed890fde54bd314eb8e2bf3390160797234cd2", "url": "https://github.com/constellation-app/constellation/commit/0eed890fde54bd314eb8e2bf3390160797234cd2", "message": "Merge branch 'master' into Make-global-parameters-singletons", "committedDate": "2020-06-15T00:15:44Z", "type": "commit"}, {"oid": "e4127d943a2d9bb4c94e9d5ebbee8cf5e1061d73", "url": "https://github.com/constellation-app/constellation/commit/e4127d943a2d9bb4c94e9d5ebbee8cf5e1061d73", "message": "Update CHANGELOG.md and CONTRIBUTING.md", "committedDate": "2020-06-15T05:22:09Z", "type": "commit"}, {"oid": "4e5dfc9b40aba631f7c2a767f86bc9ec028c731c", "url": "https://github.com/constellation-app/constellation/commit/4e5dfc9b40aba631f7c2a767f86bc9ec028c731c", "message": "Update CHANGELOG.md", "committedDate": "2020-06-15T05:26:05Z", "type": "commit"}]}