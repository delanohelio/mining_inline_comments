{"pr_number": 472, "pr_title": "Map view invert mouse controls", "pr_createdAt": "2020-04-30T13:36:41Z", "pr_url": "https://github.com/constellation-app/constellation/pull/472", "timeline": [{"oid": "f252c3a96cb7968fbc7820fd4326b7bc0db3227b", "url": "https://github.com/constellation-app/constellation/commit/f252c3a96cb7968fbc7820fd4326b7bc0db3227b", "message": "Change feature in Map View to invert the mouse click controls.\nThis makes the functionality consistent with the CONSTELLATION graph.  Addresses current issue #45", "committedDate": "2020-04-11T10:37:45Z", "type": "commit"}, {"oid": "20fb64a232116629d3aca82b67b0bc1262641f8c", "url": "https://github.com/constellation-app/constellation/commit/20fb64a232116629d3aca82b67b0bc1262641f8c", "message": "Add change to CHANGELOG about the Map View Controls", "committedDate": "2020-04-12T13:57:51Z", "type": "commit"}, {"oid": "f88c17fbfa262c8d8114b7102b6cad89adbd65e8", "url": "https://github.com/constellation-app/constellation/commit/f88c17fbfa262c8d8114b7102b6cad89adbd65e8", "message": "Update whats new message to include changes in map view mouse controls", "committedDate": "2020-04-12T14:06:13Z", "type": "commit"}, {"oid": "01263a6abec918e02301147d0bf46edf7e850ad3", "url": "https://github.com/constellation-app/constellation/commit/01263a6abec918e02301147d0bf46edf7e850ad3", "message": "Merge branch 'master' into MapViewInvertMouseControls", "committedDate": "2020-04-12T14:14:53Z", "type": "commit"}, {"oid": "07f02bbc1db2e610c4e9d2f7e0029d1a0e70ce9f", "url": "https://github.com/constellation-app/constellation/commit/07f02bbc1db2e610c4e9d2f7e0029d1a0e70ce9f", "message": "Fixed both the OverviewOverlay and ToolsOverlay to not select markers when in use", "committedDate": "2020-04-28T00:31:09Z", "type": "commit"}, {"oid": "22fd858e058ebbb1941b95edabfad5308150f554", "url": "https://github.com/constellation-app/constellation/commit/22fd858e058ebbb1941b95edabfad5308150f554", "message": "Changed MapView default double left click to right click to be similar to graph view", "committedDate": "2020-04-28T02:45:18Z", "type": "commit"}, {"oid": "4549476ae053bea521581dd13afb4bbad9ddd3d0", "url": "https://github.com/constellation-app/constellation/commit/4549476ae053bea521581dd13afb4bbad9ddd3d0", "message": "Fixed issue where custom markers were always hidden when toggling 'Selected only'", "committedDate": "2020-04-30T01:40:34Z", "type": "commit"}, {"oid": "ea699f615a17f252b82caf9d0eb3218bb2c05532", "url": "https://github.com/constellation-app/constellation/commit/ea699f615a17f252b82caf9d0eb3218bb2c05532", "message": "cleaned up Overview overlay", "committedDate": "2020-04-30T12:41:39Z", "type": "commit"}, {"oid": "aa6a84ec66d480e79bc210b30315d0ed9493d413", "url": "https://github.com/constellation-app/constellation/commit/aa6a84ec66d480e79bc210b30315d0ed9493d413", "message": "Updated styling in Map Tile Viewer", "committedDate": "2020-04-30T13:30:47Z", "type": "commit"}, {"oid": "b17a8c7ec89e4a65a38b6c5d43b21beaf70fced2", "url": "https://github.com/constellation-app/constellation/commit/b17a8c7ec89e4a65a38b6c5d43b21beaf70fced2", "message": "Merge branch 'master' into MapViewInvertMouseControls", "committedDate": "2020-04-30T13:38:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTc2ODQ4Mg==", "url": "https://github.com/constellation-app/constellation/pull/472#discussion_r419768482", "bodyText": "add finals.", "author": "cygnus-x-1", "createdAt": "2020-05-04T22:34:22Z", "path": "CoreMapView/src/au/gov/asd/tac/constellation/views/mapview/MapViewTileRenderer.java", "diffHunk": "@@ -461,17 +464,46 @@ public void mousePressed(final MouseEvent event) {\n     @Override\n     public void mouseDragged(final MouseEvent event) {\n         assert !SwingUtilities.isEventDispatchThread();\n-\n-        if (event.getButton() == PConstants.CENTER) {\n-            // zoom to box\n-            boxZoomEnabled = true;\n-            boxDeltaX = event.getX();\n-            boxDeltaY = event.getY();\n-        } else if (event.getButton() == PConstants.RIGHT) {\n-            // select markers\n-            boxSelectionEnabled = true;\n-            boxDeltaX = event.getX();\n-            boxDeltaY = event.getY();\n+        \n+        //Checks to see if click was on the map\n+        final boolean ignoreMapInteractions = isIgnoreMapInteractions();\n+        \n+        switch (event.getButton()) {\n+            case PConstants.CENTER:\n+                // zoom to box\n+                boxZoomEnabled = true;\n+                boxDeltaX = event.getX();\n+                boxDeltaY = event.getY();\n+                break;\n+            case PConstants.RIGHT:\n+                // select markers\n+                boxSelectionEnabled = false;\n+                \n+                if (!ignoreMapInteractions) {\n+                    // Triggers a pan event for a right click & drag if within map\n+                    dispatcher.register(map, PanMapEvent.TYPE_PAN, map.getId());\n+                    Location oldLocation = map.getLocation(pmouseX, pmouseY);", "originalCommit": "b17a8c7ec89e4a65a38b6c5d43b21beaf70fced2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTc2OTY0Mw==", "url": "https://github.com/constellation-app/constellation/pull/472#discussion_r419769643", "bodyText": "There should not be any references to specific plugins in the tile renderer if at all possible. Perhaps instead you could add an abstract method to MapOverlay to signal when the overlay has priority on interactions. This way any overlay could take control of interactions when it makes sense for that overlay.", "author": "cygnus-x-1", "createdAt": "2020-05-04T22:37:41Z", "path": "CoreMapView/src/au/gov/asd/tac/constellation/views/mapview/MapViewTileRenderer.java", "diffHunk": "@@ -461,17 +464,46 @@ public void mousePressed(final MouseEvent event) {\n     @Override\n     public void mouseDragged(final MouseEvent event) {\n         assert !SwingUtilities.isEventDispatchThread();\n-\n-        if (event.getButton() == PConstants.CENTER) {\n-            // zoom to box\n-            boxZoomEnabled = true;\n-            boxDeltaX = event.getX();\n-            boxDeltaY = event.getY();\n-        } else if (event.getButton() == PConstants.RIGHT) {\n-            // select markers\n-            boxSelectionEnabled = true;\n-            boxDeltaX = event.getX();\n-            boxDeltaY = event.getY();\n+        \n+        //Checks to see if click was on the map\n+        final boolean ignoreMapInteractions = isIgnoreMapInteractions();\n+        \n+        switch (event.getButton()) {\n+            case PConstants.CENTER:\n+                // zoom to box\n+                boxZoomEnabled = true;\n+                boxDeltaX = event.getX();\n+                boxDeltaY = event.getY();\n+                break;\n+            case PConstants.RIGHT:\n+                // select markers\n+                boxSelectionEnabled = false;\n+                \n+                if (!ignoreMapInteractions) {\n+                    // Triggers a pan event for a right click & drag if within map\n+                    dispatcher.register(map, PanMapEvent.TYPE_PAN, map.getId());\n+                    Location oldLocation = map.getLocation(pmouseX, pmouseY);\n+                    Location newLocation = map.getLocation(mouseX, mouseY);\n+                    PanMapEvent panMapEvent = new PanMapEvent(this, map.getId(), PanMapEvent.PAN_BY);\n+                    panMapEvent.setFromLocation(oldLocation);\n+                    panMapEvent.setToLocation(newLocation);\n+                    dispatcher.fireMapEvent(panMapEvent);\n+                    dispatcher.unregister(map, PanMapEvent.TYPE_PAN, map.getId());\n+                }   \n+                break;\n+            case PConstants.LEFT:\n+                // select markers\n+                final boolean isMeasuring = overlays.stream().filter( overlay -> \n+                        ToolsOverlay.class.isInstance(overlay) && overlay.isEnabled()", "originalCommit": "b17a8c7ec89e4a65a38b6c5d43b21beaf70fced2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b7328866d6788003428b6f832449f0b46683e42e", "url": "https://github.com/constellation-app/constellation/commit/b7328866d6788003428b6f832449f0b46683e42e", "message": "Merge branch 'MapViewInvertMouseControls' of github.com:bentipping/constellation into MapViewInvertMouseControls", "committedDate": "2020-05-05T10:39:31Z", "type": "commit"}, {"oid": "b9212297cf983352b22cd742701b0e9337b7bc8b", "url": "https://github.com/constellation-app/constellation/commit/b9212297cf983352b22cd742701b0e9337b7bc8b", "message": "Changed mouse deselect to double click", "committedDate": "2020-05-05T11:17:22Z", "type": "commit"}, {"oid": "bdc32db645ec38066312fe3ea41fad2895d2ed54", "url": "https://github.com/constellation-app/constellation/commit/bdc32db645ec38066312fe3ea41fad2895d2ed54", "message": "Fixed single click map deselect to double click", "committedDate": "2020-05-05T11:21:45Z", "type": "commit"}, {"oid": "2c30a99c47def44f105010a98208ac2c2f136804", "url": "https://github.com/constellation-app/constellation/commit/2c30a99c47def44f105010a98208ac2c2f136804", "message": "Fixed direct reference to ToolOverlay in TileView to allow overlays to steal focus", "committedDate": "2020-05-05T15:48:23Z", "type": "commit"}, {"oid": "ea136fc8e5258631b09f93f21555b3b0de8d7285", "url": "https://github.com/constellation-app/constellation/commit/ea136fc8e5258631b09f93f21555b3b0de8d7285", "message": "Merged master with revision", "committedDate": "2020-05-05T16:02:36Z", "type": "commit"}, {"oid": "58a1a8daed7978b80bfbbeb3c9995412ff69f116", "url": "https://github.com/constellation-app/constellation/commit/58a1a8daed7978b80bfbbeb3c9995412ff69f116", "message": "reverting merge", "committedDate": "2020-05-05T16:17:35Z", "type": "commit"}, {"oid": "8300e3accc860de68ca7f3480f07e21a7a2b7319", "url": "https://github.com/constellation-app/constellation/commit/8300e3accc860de68ca7f3480f07e21a7a2b7319", "message": "abstracting isInFocus to the overlays", "committedDate": "2020-05-05T16:26:27Z", "type": "commit"}, {"oid": "b602ef37e16db37b56b455c32023289467afa424", "url": "https://github.com/constellation-app/constellation/commit/b602ef37e16db37b56b455c32023289467afa424", "message": "Merge branch 'master' into MapViewInvertMouseControls", "committedDate": "2020-05-05T16:29:13Z", "type": "commit"}, {"oid": "c75ea51f7066b2aa457a8417fb66d68f68c2d814", "url": "https://github.com/constellation-app/constellation/commit/c75ea51f7066b2aa457a8417fb66d68f68c2d814", "message": "Fixed map double click deselect", "committedDate": "2020-05-05T16:54:30Z", "type": "commit"}, {"oid": "82c350411e49c090c95b0695725ae47df6102ff4", "url": "https://github.com/constellation-app/constellation/commit/82c350411e49c090c95b0695725ae47df6102ff4", "message": "Merge branch 'MapViewInvertMouseControls' of https://github.com/Guilty-Spark-343/constellation into MapViewInvertMouseControls", "committedDate": "2020-05-05T17:03:17Z", "type": "commit"}, {"oid": "59b36fb444e54f6e41611e41315ef2ebe53f24ec", "url": "https://github.com/constellation-app/constellation/commit/59b36fb444e54f6e41611e41315ef2ebe53f24ec", "message": "Revert \"Fixed map double click deselect\"\n\nThis reverts commit c75ea51f7066b2aa457a8417fb66d68f68c2d814.", "committedDate": "2020-05-05T17:10:01Z", "type": "commit"}, {"oid": "e893b476d2d78e3ff59da1c0ab27cb697963cefe", "url": "https://github.com/constellation-app/constellation/commit/e893b476d2d78e3ff59da1c0ab27cb697963cefe", "message": "Refix the double click deselect on map view", "committedDate": "2020-05-05T17:43:10Z", "type": "commit"}, {"oid": "362e17ad3a4fb592db77f9345b76b97255a0d975", "url": "https://github.com/constellation-app/constellation/commit/362e17ad3a4fb592db77f9345b76b97255a0d975", "message": "Merge branch 'master' into MapViewInvertMouseControls", "committedDate": "2020-05-18T10:53:55Z", "type": "commit"}]}