{"pr_number": 2485, "pr_title": "Add GraphQL Query Generation Functionality", "pr_createdAt": "2020-07-06T22:19:17Z", "pr_url": "https://github.com/zaproxy/zap-extensions/pull/2485", "timeline": [{"oid": "5ee2bdc183d19f659707775e5056f77fe6611aa2", "url": "https://github.com/zaproxy/zap-extensions/commit/5ee2bdc183d19f659707775e5056f77fe6611aa2", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-07T14:05:18Z", "type": "forcePushed"}, {"oid": "674252103bbc8b0496c025ff5de3d7ab8d8aa1b2", "url": "https://github.com/zaproxy/zap-extensions/commit/674252103bbc8b0496c025ff5de3d7ab8d8aa1b2", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-07T14:09:34Z", "type": "forcePushed"}, {"oid": "f5747d19351b5eff89a926917d64bcded94eacea", "url": "https://github.com/zaproxy/zap-extensions/commit/f5747d19351b5eff89a926917d64bcded94eacea", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-07T14:13:32Z", "type": "forcePushed"}, {"oid": "f3374744b3a43948dc03121a4c99ba05b433db88", "url": "https://github.com/zaproxy/zap-extensions/commit/f3374744b3a43948dc03121a4c99ba05b433db88", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-09T21:14:07Z", "type": "forcePushed"}, {"oid": "5ccccad7e431f07279bc017b3d52a37560831a89", "url": "https://github.com/zaproxy/zap-extensions/commit/5ccccad7e431f07279bc017b3d52a37560831a89", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-10T21:19:00Z", "type": "forcePushed"}, {"oid": "3db325ce5ba05b5e44c4c9504745ef23a70e3d35", "url": "https://github.com/zaproxy/zap-extensions/commit/3db325ce5ba05b5e44c4c9504745ef23a70e3d35", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-15T12:23:20Z", "type": "forcePushed"}, {"oid": "3b7224b7923659b3a2cfb3586c566614c611b7e0", "url": "https://github.com/zaproxy/zap-extensions/commit/3b7224b7923659b3a2cfb3586c566614c611b7e0", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-15T18:49:02Z", "type": "forcePushed"}, {"oid": "bb7b07bf4c7b0d928c6970194353e63b391c8549", "url": "https://github.com/zaproxy/zap-extensions/commit/bb7b07bf4c7b0d928c6970194353e63b391c8549", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-16T14:41:40Z", "type": "forcePushed"}, {"oid": "47a2041bea301ac3c05ac1e09282ac5bc17002e7", "url": "https://github.com/zaproxy/zap-extensions/commit/47a2041bea301ac3c05ac1e09282ac5bc17002e7", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-21T08:50:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODA1ODgzNw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r458058837", "bodyText": "This is the second use of these strings, specifically with a trailing space. It would probably be best to extract constants for them.", "author": "kingthorin", "createdAt": "2020-07-21T12:31:03Z", "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/GraphQlGenerator.java", "diffHunk": "@@ -0,0 +1,329 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.graphql;\n+\n+import graphql.schema.GraphQLArgument;\n+import graphql.schema.GraphQLEnumType;\n+import graphql.schema.GraphQLFieldDefinition;\n+import graphql.schema.GraphQLInputObjectField;\n+import graphql.schema.GraphQLInputObjectType;\n+import graphql.schema.GraphQLInterfaceType;\n+import graphql.schema.GraphQLList;\n+import graphql.schema.GraphQLNamedOutputType;\n+import graphql.schema.GraphQLNamedType;\n+import graphql.schema.GraphQLNonNull;\n+import graphql.schema.GraphQLObjectType;\n+import graphql.schema.GraphQLScalarType;\n+import graphql.schema.GraphQLSchema;\n+import graphql.schema.GraphQLType;\n+import graphql.schema.GraphQLTypeUtil;\n+import graphql.schema.GraphQLUnionType;\n+import graphql.schema.idl.SchemaParser;\n+import graphql.schema.idl.UnExecutableSchemaGenerator;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.control.Control;\n+import org.zaproxy.zap.extension.spider.ExtensionSpider;\n+import org.zaproxy.zap.model.ValueGenerator;\n+\n+public class GraphQlGenerator {\n+\n+    private static final Logger LOG = Logger.getLogger(GraphQlGenerator.class);\n+    private static final int MAX_DEPTH = 5;\n+    private final Requestor requestor;\n+    private GraphQLSchema schema;\n+\n+    protected enum RequestType {\n+        QUERY,\n+        MUTATION,\n+        SUBSCRIPTION\n+    };\n+\n+    public GraphQlGenerator(String sdl) {\n+        this(sdl, null);\n+    }\n+\n+    public GraphQlGenerator(String sdl, Requestor requestor) {\n+        schema = UnExecutableSchemaGenerator.makeUnExecutableSchema(new SchemaParser().parse(sdl));\n+        this.requestor = requestor;\n+    }\n+\n+    public void checkServiceMethods() {\n+        String query = \"{__schema{types{name kind description}}}\";\n+        requestor.sendQueryByGet(query);\n+        requestor.sendQueryByGraphQlPost(query);\n+        requestor.sendQuery(query);\n+    }\n+\n+    public String generateFull(RequestType requestType) {\n+        StringBuilder query = new StringBuilder();\n+        GraphQLObjectType object = null;\n+        switch (requestType) {\n+            case QUERY:\n+                object = schema.getQueryType();\n+                break;\n+            case MUTATION:\n+                query.append(\"mutation \");\n+                object = schema.getMutationType();\n+                break;\n+            case SUBSCRIPTION:\n+                query.append(\"subscription \");\n+                object = schema.getSubscriptionType();\n+                break;\n+        }\n+        generate(query, object, 0);\n+        return query.toString();\n+    }\n+\n+    public void sendFull(RequestType requestType) {\n+        switch (requestType) {\n+            case QUERY:\n+                StringBuilder query = new StringBuilder();\n+                generate(query, schema.getQueryType(), 0);\n+                requestor.sendQuery(query.toString());\n+                break;\n+            case MUTATION:\n+                StringBuilder mutation = new StringBuilder(\"mutation \");\n+                generate(mutation, schema.getMutationType(), 0);\n+                requestor.sendQuery(mutation.toString());\n+                break;\n+            case SUBSCRIPTION:\n+                StringBuilder subscription = new StringBuilder(\"subscription \");", "originalCommit": "47a2041bea301ac3c05ac1e09282ac5bc17002e7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODA2Mjc0Ng==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r458062746", "bodyText": "Are the case strings part of a spec/standard or will we potentially run into case sensitivity problems with this?", "author": "kingthorin", "createdAt": "2020-07-21T12:38:03Z", "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/GraphQlGenerator.java", "diffHunk": "@@ -0,0 +1,329 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.graphql;\n+\n+import graphql.schema.GraphQLArgument;\n+import graphql.schema.GraphQLEnumType;\n+import graphql.schema.GraphQLFieldDefinition;\n+import graphql.schema.GraphQLInputObjectField;\n+import graphql.schema.GraphQLInputObjectType;\n+import graphql.schema.GraphQLInterfaceType;\n+import graphql.schema.GraphQLList;\n+import graphql.schema.GraphQLNamedOutputType;\n+import graphql.schema.GraphQLNamedType;\n+import graphql.schema.GraphQLNonNull;\n+import graphql.schema.GraphQLObjectType;\n+import graphql.schema.GraphQLScalarType;\n+import graphql.schema.GraphQLSchema;\n+import graphql.schema.GraphQLType;\n+import graphql.schema.GraphQLTypeUtil;\n+import graphql.schema.GraphQLUnionType;\n+import graphql.schema.idl.SchemaParser;\n+import graphql.schema.idl.UnExecutableSchemaGenerator;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.control.Control;\n+import org.zaproxy.zap.extension.spider.ExtensionSpider;\n+import org.zaproxy.zap.model.ValueGenerator;\n+\n+public class GraphQlGenerator {\n+\n+    private static final Logger LOG = Logger.getLogger(GraphQlGenerator.class);\n+    private static final int MAX_DEPTH = 5;\n+    private final Requestor requestor;\n+    private GraphQLSchema schema;\n+\n+    protected enum RequestType {\n+        QUERY,\n+        MUTATION,\n+        SUBSCRIPTION\n+    };\n+\n+    public GraphQlGenerator(String sdl) {\n+        this(sdl, null);\n+    }\n+\n+    public GraphQlGenerator(String sdl, Requestor requestor) {\n+        schema = UnExecutableSchemaGenerator.makeUnExecutableSchema(new SchemaParser().parse(sdl));\n+        this.requestor = requestor;\n+    }\n+\n+    public void checkServiceMethods() {\n+        String query = \"{__schema{types{name kind description}}}\";\n+        requestor.sendQueryByGet(query);\n+        requestor.sendQueryByGraphQlPost(query);\n+        requestor.sendQuery(query);\n+    }\n+\n+    public String generateFull(RequestType requestType) {\n+        StringBuilder query = new StringBuilder();\n+        GraphQLObjectType object = null;\n+        switch (requestType) {\n+            case QUERY:\n+                object = schema.getQueryType();\n+                break;\n+            case MUTATION:\n+                query.append(\"mutation \");\n+                object = schema.getMutationType();\n+                break;\n+            case SUBSCRIPTION:\n+                query.append(\"subscription \");\n+                object = schema.getSubscriptionType();\n+                break;\n+        }\n+        generate(query, object, 0);\n+        return query.toString();\n+    }\n+\n+    public void sendFull(RequestType requestType) {\n+        switch (requestType) {\n+            case QUERY:\n+                StringBuilder query = new StringBuilder();\n+                generate(query, schema.getQueryType(), 0);\n+                requestor.sendQuery(query.toString());\n+                break;\n+            case MUTATION:\n+                StringBuilder mutation = new StringBuilder(\"mutation \");\n+                generate(mutation, schema.getMutationType(), 0);\n+                requestor.sendQuery(mutation.toString());\n+                break;\n+            case SUBSCRIPTION:\n+                StringBuilder subscription = new StringBuilder(\"subscription \");\n+                generate(subscription, schema.getSubscriptionType(), 0);\n+                requestor.sendQuery(subscription.toString());\n+                break;\n+        }\n+    }\n+\n+    public void sendByLeaf(RequestType requestType) {\n+        switch (requestType) {\n+            case QUERY:\n+                StringBuilder query = new StringBuilder();\n+                generate(query, schema.getQueryType(), 0, requestor);\n+                break;\n+            case MUTATION:\n+                StringBuilder mutation = new StringBuilder();\n+                generate(mutation, schema.getMutationType(), 0, requestor);\n+                break;\n+            case SUBSCRIPTION:\n+                StringBuilder subscription = new StringBuilder();\n+                generate(subscription, schema.getSubscriptionType(), 0, requestor);\n+                break;\n+        }\n+    }\n+\n+    public void sendByField(RequestType requestType) {\n+        GraphQLObjectType object = null;\n+        switch (requestType) {\n+            case QUERY:\n+                object = schema.getQueryType();\n+                break;\n+            case MUTATION:\n+                object = schema.getMutationType();\n+                break;\n+            case SUBSCRIPTION:\n+                object = schema.getSubscriptionType();\n+                break;\n+        }\n+        List<GraphQLFieldDefinition> fields = object.getFieldDefinitions();\n+        for (GraphQLFieldDefinition field : fields) {\n+            StringBuilder query = new StringBuilder();\n+            generate(query, field.getType(), 1, null);\n+            requestor.sendQuery(query.toString());\n+        }\n+    }\n+\n+    private void generate(StringBuilder query, GraphQLType type, int depth) {\n+        generate(query, type, depth, null);\n+    }\n+\n+    private void generate(StringBuilder query, GraphQLType type, int depth, Requestor requestor) {\n+        if (type instanceof GraphQLObjectType) {\n+            query.append(\"{\\n\");\n+            GraphQLObjectType object = (GraphQLObjectType) type;\n+            List<GraphQLFieldDefinition> fields = object.getFieldDefinitions();\n+            for (GraphQLFieldDefinition field : fields) {\n+                GraphQLType fieldType = field.getType();\n+                int parentLength = query.length();\n+                if (GraphQLTypeUtil.isWrapped(fieldType)) {\n+                    fieldType = GraphQLTypeUtil.unwrapAll(fieldType);\n+                }\n+                if (GraphQLTypeUtil.isLeaf(fieldType)) {\n+                    indent(query, depth + 1);\n+                    query.append(field.getName()).append(' ');\n+                    addArguments(query, field);\n+                    query.append('\\n');\n+                    if (requestor != null) {\n+                        for (int i = 0; i <= depth; ++i) {\n+                            indent(query, depth - i);\n+                            query.append(\"}\\n\");\n+                        }\n+                        requestor.sendQuery(query.toString());\n+                    }\n+                } else if (depth < MAX_DEPTH) {\n+                    indent(query, depth + 1);\n+                    query.append(field.getName()).append(' ');\n+                    addArguments(query, field);\n+                    generate(query, fieldType, depth + 1, requestor);\n+                }\n+                if (requestor != null) {\n+                    query.setLength(parentLength);\n+                }\n+            }\n+            indent(query, depth);\n+            query.append(\"}\\n\");\n+        } else if (type instanceof GraphQLInterfaceType) {\n+            List<GraphQLObjectType> objects =\n+                    schema.getImplementations((GraphQLInterfaceType) type);\n+            query.append(\"{\\n\");\n+            for (GraphQLObjectType object : objects) {\n+                indent(query, depth + 1);\n+                query.append(\"... on \").append(object.getName()).append(' ');\n+                generate(query, object, depth + 1, requestor);\n+            }\n+            indent(query, depth);\n+            query.append(\"}\\n\");\n+        } else if (type instanceof GraphQLUnionType) {\n+            GraphQLUnionType union = (GraphQLUnionType) type;\n+            List<GraphQLNamedOutputType> members = union.getTypes();\n+            query.append(\"{\\n\");\n+            for (GraphQLNamedOutputType member : members) {\n+                indent(query, depth + 1);\n+                query.append(\"... on \").append(member.getName()).append(' ');\n+                generate(query, member, depth + 1, requestor);\n+            }\n+            indent(query, depth);\n+            query.append(\"}\\n\");\n+        }\n+    }\n+\n+    private void indent(StringBuilder query, int n) {\n+        for (int i = 0; i < n; ++i) {\n+            query.append(\"    \");\n+        }\n+    }\n+\n+    private void addArguments(StringBuilder query, GraphQLFieldDefinition field) {\n+        List<GraphQLArgument> args = field.getArguments();\n+        if (!args.isEmpty()) {\n+            query.append('(');\n+            for (GraphQLArgument arg : args) {\n+                query.append(arg.getName())\n+                        .append(\": \")\n+                        .append(getDefaultValue(arg.getType()))\n+                        .append(\", \");\n+            }\n+            query.setLength(query.length() - 2);\n+            query.append(\") \");\n+        }\n+    }\n+\n+    private String getDefaultValue(GraphQLType type) {\n+        return getDefaultValue(type, 0);\n+    }\n+\n+    private String getDefaultValue(GraphQLType type, int depth) {\n+        if (depth > MAX_DEPTH) return \"null\";\n+        StringBuilder defaultValue = new StringBuilder();\n+        if (type instanceof GraphQLNonNull) {\n+            GraphQLNonNull nonNullType = (GraphQLNonNull) type;\n+            type = nonNullType.getWrappedType();\n+        }\n+        if (type instanceof GraphQLScalarType) {\n+            GraphQLScalarType scalar = (GraphQLScalarType) type;\n+            switch (scalar.getName()) {\n+                case \"Int\":\n+                case \"ID\":\n+                    defaultValue.append(\"1\");\n+                    break;\n+                case \"Float\":\n+                    defaultValue.append(\"3.14\");\n+                    break;\n+                case \"String\":\n+                    defaultValue.append(\"\\\"hello\\\"\");\n+                    break;\n+                case \"Boolean\":\n+                    defaultValue.append(\"true\");\n+                    break;\n+            }", "originalCommit": "47a2041bea301ac3c05ac1e09282ac5bc17002e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODY5MTQwOQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r458691409", "bodyText": "They are part of the spec: http://spec.graphql.org/draft/#sec-Scalars.Built-in-Scalars", "author": "ricekot", "createdAt": "2020-07-22T10:23:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODA2Mjc0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODY5NTI2Mw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r458695263", "bodyText": "Okay great.", "author": "kingthorin", "createdAt": "2020-07-22T10:30:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODA2Mjc0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODA2NDI4MQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r458064281", "bodyText": "Should probably use \"\\\"ZAP\\\"\" to be similar to form handler.", "author": "kingthorin", "createdAt": "2020-07-21T12:40:35Z", "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/GraphQlGenerator.java", "diffHunk": "@@ -0,0 +1,329 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.graphql;\n+\n+import graphql.schema.GraphQLArgument;\n+import graphql.schema.GraphQLEnumType;\n+import graphql.schema.GraphQLFieldDefinition;\n+import graphql.schema.GraphQLInputObjectField;\n+import graphql.schema.GraphQLInputObjectType;\n+import graphql.schema.GraphQLInterfaceType;\n+import graphql.schema.GraphQLList;\n+import graphql.schema.GraphQLNamedOutputType;\n+import graphql.schema.GraphQLNamedType;\n+import graphql.schema.GraphQLNonNull;\n+import graphql.schema.GraphQLObjectType;\n+import graphql.schema.GraphQLScalarType;\n+import graphql.schema.GraphQLSchema;\n+import graphql.schema.GraphQLType;\n+import graphql.schema.GraphQLTypeUtil;\n+import graphql.schema.GraphQLUnionType;\n+import graphql.schema.idl.SchemaParser;\n+import graphql.schema.idl.UnExecutableSchemaGenerator;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.control.Control;\n+import org.zaproxy.zap.extension.spider.ExtensionSpider;\n+import org.zaproxy.zap.model.ValueGenerator;\n+\n+public class GraphQlGenerator {\n+\n+    private static final Logger LOG = Logger.getLogger(GraphQlGenerator.class);\n+    private static final int MAX_DEPTH = 5;\n+    private final Requestor requestor;\n+    private GraphQLSchema schema;\n+\n+    protected enum RequestType {\n+        QUERY,\n+        MUTATION,\n+        SUBSCRIPTION\n+    };\n+\n+    public GraphQlGenerator(String sdl) {\n+        this(sdl, null);\n+    }\n+\n+    public GraphQlGenerator(String sdl, Requestor requestor) {\n+        schema = UnExecutableSchemaGenerator.makeUnExecutableSchema(new SchemaParser().parse(sdl));\n+        this.requestor = requestor;\n+    }\n+\n+    public void checkServiceMethods() {\n+        String query = \"{__schema{types{name kind description}}}\";\n+        requestor.sendQueryByGet(query);\n+        requestor.sendQueryByGraphQlPost(query);\n+        requestor.sendQuery(query);\n+    }\n+\n+    public String generateFull(RequestType requestType) {\n+        StringBuilder query = new StringBuilder();\n+        GraphQLObjectType object = null;\n+        switch (requestType) {\n+            case QUERY:\n+                object = schema.getQueryType();\n+                break;\n+            case MUTATION:\n+                query.append(\"mutation \");\n+                object = schema.getMutationType();\n+                break;\n+            case SUBSCRIPTION:\n+                query.append(\"subscription \");\n+                object = schema.getSubscriptionType();\n+                break;\n+        }\n+        generate(query, object, 0);\n+        return query.toString();\n+    }\n+\n+    public void sendFull(RequestType requestType) {\n+        switch (requestType) {\n+            case QUERY:\n+                StringBuilder query = new StringBuilder();\n+                generate(query, schema.getQueryType(), 0);\n+                requestor.sendQuery(query.toString());\n+                break;\n+            case MUTATION:\n+                StringBuilder mutation = new StringBuilder(\"mutation \");\n+                generate(mutation, schema.getMutationType(), 0);\n+                requestor.sendQuery(mutation.toString());\n+                break;\n+            case SUBSCRIPTION:\n+                StringBuilder subscription = new StringBuilder(\"subscription \");\n+                generate(subscription, schema.getSubscriptionType(), 0);\n+                requestor.sendQuery(subscription.toString());\n+                break;\n+        }\n+    }\n+\n+    public void sendByLeaf(RequestType requestType) {\n+        switch (requestType) {\n+            case QUERY:\n+                StringBuilder query = new StringBuilder();\n+                generate(query, schema.getQueryType(), 0, requestor);\n+                break;\n+            case MUTATION:\n+                StringBuilder mutation = new StringBuilder();\n+                generate(mutation, schema.getMutationType(), 0, requestor);\n+                break;\n+            case SUBSCRIPTION:\n+                StringBuilder subscription = new StringBuilder();\n+                generate(subscription, schema.getSubscriptionType(), 0, requestor);\n+                break;\n+        }\n+    }\n+\n+    public void sendByField(RequestType requestType) {\n+        GraphQLObjectType object = null;\n+        switch (requestType) {\n+            case QUERY:\n+                object = schema.getQueryType();\n+                break;\n+            case MUTATION:\n+                object = schema.getMutationType();\n+                break;\n+            case SUBSCRIPTION:\n+                object = schema.getSubscriptionType();\n+                break;\n+        }\n+        List<GraphQLFieldDefinition> fields = object.getFieldDefinitions();\n+        for (GraphQLFieldDefinition field : fields) {\n+            StringBuilder query = new StringBuilder();\n+            generate(query, field.getType(), 1, null);\n+            requestor.sendQuery(query.toString());\n+        }\n+    }\n+\n+    private void generate(StringBuilder query, GraphQLType type, int depth) {\n+        generate(query, type, depth, null);\n+    }\n+\n+    private void generate(StringBuilder query, GraphQLType type, int depth, Requestor requestor) {\n+        if (type instanceof GraphQLObjectType) {\n+            query.append(\"{\\n\");\n+            GraphQLObjectType object = (GraphQLObjectType) type;\n+            List<GraphQLFieldDefinition> fields = object.getFieldDefinitions();\n+            for (GraphQLFieldDefinition field : fields) {\n+                GraphQLType fieldType = field.getType();\n+                int parentLength = query.length();\n+                if (GraphQLTypeUtil.isWrapped(fieldType)) {\n+                    fieldType = GraphQLTypeUtil.unwrapAll(fieldType);\n+                }\n+                if (GraphQLTypeUtil.isLeaf(fieldType)) {\n+                    indent(query, depth + 1);\n+                    query.append(field.getName()).append(' ');\n+                    addArguments(query, field);\n+                    query.append('\\n');\n+                    if (requestor != null) {\n+                        for (int i = 0; i <= depth; ++i) {\n+                            indent(query, depth - i);\n+                            query.append(\"}\\n\");\n+                        }\n+                        requestor.sendQuery(query.toString());\n+                    }\n+                } else if (depth < MAX_DEPTH) {\n+                    indent(query, depth + 1);\n+                    query.append(field.getName()).append(' ');\n+                    addArguments(query, field);\n+                    generate(query, fieldType, depth + 1, requestor);\n+                }\n+                if (requestor != null) {\n+                    query.setLength(parentLength);\n+                }\n+            }\n+            indent(query, depth);\n+            query.append(\"}\\n\");\n+        } else if (type instanceof GraphQLInterfaceType) {\n+            List<GraphQLObjectType> objects =\n+                    schema.getImplementations((GraphQLInterfaceType) type);\n+            query.append(\"{\\n\");\n+            for (GraphQLObjectType object : objects) {\n+                indent(query, depth + 1);\n+                query.append(\"... on \").append(object.getName()).append(' ');\n+                generate(query, object, depth + 1, requestor);\n+            }\n+            indent(query, depth);\n+            query.append(\"}\\n\");\n+        } else if (type instanceof GraphQLUnionType) {\n+            GraphQLUnionType union = (GraphQLUnionType) type;\n+            List<GraphQLNamedOutputType> members = union.getTypes();\n+            query.append(\"{\\n\");\n+            for (GraphQLNamedOutputType member : members) {\n+                indent(query, depth + 1);\n+                query.append(\"... on \").append(member.getName()).append(' ');\n+                generate(query, member, depth + 1, requestor);\n+            }\n+            indent(query, depth);\n+            query.append(\"}\\n\");\n+        }\n+    }\n+\n+    private void indent(StringBuilder query, int n) {\n+        for (int i = 0; i < n; ++i) {\n+            query.append(\"    \");\n+        }\n+    }\n+\n+    private void addArguments(StringBuilder query, GraphQLFieldDefinition field) {\n+        List<GraphQLArgument> args = field.getArguments();\n+        if (!args.isEmpty()) {\n+            query.append('(');\n+            for (GraphQLArgument arg : args) {\n+                query.append(arg.getName())\n+                        .append(\": \")\n+                        .append(getDefaultValue(arg.getType()))\n+                        .append(\", \");\n+            }\n+            query.setLength(query.length() - 2);\n+            query.append(\") \");\n+        }\n+    }\n+\n+    private String getDefaultValue(GraphQLType type) {\n+        return getDefaultValue(type, 0);\n+    }\n+\n+    private String getDefaultValue(GraphQLType type, int depth) {\n+        if (depth > MAX_DEPTH) return \"null\";\n+        StringBuilder defaultValue = new StringBuilder();\n+        if (type instanceof GraphQLNonNull) {\n+            GraphQLNonNull nonNullType = (GraphQLNonNull) type;\n+            type = nonNullType.getWrappedType();\n+        }\n+        if (type instanceof GraphQLScalarType) {\n+            GraphQLScalarType scalar = (GraphQLScalarType) type;\n+            switch (scalar.getName()) {\n+                case \"Int\":\n+                case \"ID\":\n+                    defaultValue.append(\"1\");\n+                    break;\n+                case \"Float\":\n+                    defaultValue.append(\"3.14\");\n+                    break;\n+                case \"String\":\n+                    defaultValue.append(\"\\\"hello\\\"\");", "originalCommit": "47a2041bea301ac3c05ac1e09282ac5bc17002e7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODA2NDg3Nw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r458064877", "bodyText": "For consistency this should use curly braces too.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    } else defaultValue.append(\"null\");\n          \n          \n            \n                    } else {\n          \n          \n            \n                        defaultValue.append(\"null\");\n          \n          \n            \n                    }", "author": "kingthorin", "createdAt": "2020-07-21T12:41:39Z", "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/GraphQlGenerator.java", "diffHunk": "@@ -0,0 +1,329 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.graphql;\n+\n+import graphql.schema.GraphQLArgument;\n+import graphql.schema.GraphQLEnumType;\n+import graphql.schema.GraphQLFieldDefinition;\n+import graphql.schema.GraphQLInputObjectField;\n+import graphql.schema.GraphQLInputObjectType;\n+import graphql.schema.GraphQLInterfaceType;\n+import graphql.schema.GraphQLList;\n+import graphql.schema.GraphQLNamedOutputType;\n+import graphql.schema.GraphQLNamedType;\n+import graphql.schema.GraphQLNonNull;\n+import graphql.schema.GraphQLObjectType;\n+import graphql.schema.GraphQLScalarType;\n+import graphql.schema.GraphQLSchema;\n+import graphql.schema.GraphQLType;\n+import graphql.schema.GraphQLTypeUtil;\n+import graphql.schema.GraphQLUnionType;\n+import graphql.schema.idl.SchemaParser;\n+import graphql.schema.idl.UnExecutableSchemaGenerator;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.control.Control;\n+import org.zaproxy.zap.extension.spider.ExtensionSpider;\n+import org.zaproxy.zap.model.ValueGenerator;\n+\n+public class GraphQlGenerator {\n+\n+    private static final Logger LOG = Logger.getLogger(GraphQlGenerator.class);\n+    private static final int MAX_DEPTH = 5;\n+    private final Requestor requestor;\n+    private GraphQLSchema schema;\n+\n+    protected enum RequestType {\n+        QUERY,\n+        MUTATION,\n+        SUBSCRIPTION\n+    };\n+\n+    public GraphQlGenerator(String sdl) {\n+        this(sdl, null);\n+    }\n+\n+    public GraphQlGenerator(String sdl, Requestor requestor) {\n+        schema = UnExecutableSchemaGenerator.makeUnExecutableSchema(new SchemaParser().parse(sdl));\n+        this.requestor = requestor;\n+    }\n+\n+    public void checkServiceMethods() {\n+        String query = \"{__schema{types{name kind description}}}\";\n+        requestor.sendQueryByGet(query);\n+        requestor.sendQueryByGraphQlPost(query);\n+        requestor.sendQuery(query);\n+    }\n+\n+    public String generateFull(RequestType requestType) {\n+        StringBuilder query = new StringBuilder();\n+        GraphQLObjectType object = null;\n+        switch (requestType) {\n+            case QUERY:\n+                object = schema.getQueryType();\n+                break;\n+            case MUTATION:\n+                query.append(\"mutation \");\n+                object = schema.getMutationType();\n+                break;\n+            case SUBSCRIPTION:\n+                query.append(\"subscription \");\n+                object = schema.getSubscriptionType();\n+                break;\n+        }\n+        generate(query, object, 0);\n+        return query.toString();\n+    }\n+\n+    public void sendFull(RequestType requestType) {\n+        switch (requestType) {\n+            case QUERY:\n+                StringBuilder query = new StringBuilder();\n+                generate(query, schema.getQueryType(), 0);\n+                requestor.sendQuery(query.toString());\n+                break;\n+            case MUTATION:\n+                StringBuilder mutation = new StringBuilder(\"mutation \");\n+                generate(mutation, schema.getMutationType(), 0);\n+                requestor.sendQuery(mutation.toString());\n+                break;\n+            case SUBSCRIPTION:\n+                StringBuilder subscription = new StringBuilder(\"subscription \");\n+                generate(subscription, schema.getSubscriptionType(), 0);\n+                requestor.sendQuery(subscription.toString());\n+                break;\n+        }\n+    }\n+\n+    public void sendByLeaf(RequestType requestType) {\n+        switch (requestType) {\n+            case QUERY:\n+                StringBuilder query = new StringBuilder();\n+                generate(query, schema.getQueryType(), 0, requestor);\n+                break;\n+            case MUTATION:\n+                StringBuilder mutation = new StringBuilder();\n+                generate(mutation, schema.getMutationType(), 0, requestor);\n+                break;\n+            case SUBSCRIPTION:\n+                StringBuilder subscription = new StringBuilder();\n+                generate(subscription, schema.getSubscriptionType(), 0, requestor);\n+                break;\n+        }\n+    }\n+\n+    public void sendByField(RequestType requestType) {\n+        GraphQLObjectType object = null;\n+        switch (requestType) {\n+            case QUERY:\n+                object = schema.getQueryType();\n+                break;\n+            case MUTATION:\n+                object = schema.getMutationType();\n+                break;\n+            case SUBSCRIPTION:\n+                object = schema.getSubscriptionType();\n+                break;\n+        }\n+        List<GraphQLFieldDefinition> fields = object.getFieldDefinitions();\n+        for (GraphQLFieldDefinition field : fields) {\n+            StringBuilder query = new StringBuilder();\n+            generate(query, field.getType(), 1, null);\n+            requestor.sendQuery(query.toString());\n+        }\n+    }\n+\n+    private void generate(StringBuilder query, GraphQLType type, int depth) {\n+        generate(query, type, depth, null);\n+    }\n+\n+    private void generate(StringBuilder query, GraphQLType type, int depth, Requestor requestor) {\n+        if (type instanceof GraphQLObjectType) {\n+            query.append(\"{\\n\");\n+            GraphQLObjectType object = (GraphQLObjectType) type;\n+            List<GraphQLFieldDefinition> fields = object.getFieldDefinitions();\n+            for (GraphQLFieldDefinition field : fields) {\n+                GraphQLType fieldType = field.getType();\n+                int parentLength = query.length();\n+                if (GraphQLTypeUtil.isWrapped(fieldType)) {\n+                    fieldType = GraphQLTypeUtil.unwrapAll(fieldType);\n+                }\n+                if (GraphQLTypeUtil.isLeaf(fieldType)) {\n+                    indent(query, depth + 1);\n+                    query.append(field.getName()).append(' ');\n+                    addArguments(query, field);\n+                    query.append('\\n');\n+                    if (requestor != null) {\n+                        for (int i = 0; i <= depth; ++i) {\n+                            indent(query, depth - i);\n+                            query.append(\"}\\n\");\n+                        }\n+                        requestor.sendQuery(query.toString());\n+                    }\n+                } else if (depth < MAX_DEPTH) {\n+                    indent(query, depth + 1);\n+                    query.append(field.getName()).append(' ');\n+                    addArguments(query, field);\n+                    generate(query, fieldType, depth + 1, requestor);\n+                }\n+                if (requestor != null) {\n+                    query.setLength(parentLength);\n+                }\n+            }\n+            indent(query, depth);\n+            query.append(\"}\\n\");\n+        } else if (type instanceof GraphQLInterfaceType) {\n+            List<GraphQLObjectType> objects =\n+                    schema.getImplementations((GraphQLInterfaceType) type);\n+            query.append(\"{\\n\");\n+            for (GraphQLObjectType object : objects) {\n+                indent(query, depth + 1);\n+                query.append(\"... on \").append(object.getName()).append(' ');\n+                generate(query, object, depth + 1, requestor);\n+            }\n+            indent(query, depth);\n+            query.append(\"}\\n\");\n+        } else if (type instanceof GraphQLUnionType) {\n+            GraphQLUnionType union = (GraphQLUnionType) type;\n+            List<GraphQLNamedOutputType> members = union.getTypes();\n+            query.append(\"{\\n\");\n+            for (GraphQLNamedOutputType member : members) {\n+                indent(query, depth + 1);\n+                query.append(\"... on \").append(member.getName()).append(' ');\n+                generate(query, member, depth + 1, requestor);\n+            }\n+            indent(query, depth);\n+            query.append(\"}\\n\");\n+        }\n+    }\n+\n+    private void indent(StringBuilder query, int n) {\n+        for (int i = 0; i < n; ++i) {\n+            query.append(\"    \");\n+        }\n+    }\n+\n+    private void addArguments(StringBuilder query, GraphQLFieldDefinition field) {\n+        List<GraphQLArgument> args = field.getArguments();\n+        if (!args.isEmpty()) {\n+            query.append('(');\n+            for (GraphQLArgument arg : args) {\n+                query.append(arg.getName())\n+                        .append(\": \")\n+                        .append(getDefaultValue(arg.getType()))\n+                        .append(\", \");\n+            }\n+            query.setLength(query.length() - 2);\n+            query.append(\") \");\n+        }\n+    }\n+\n+    private String getDefaultValue(GraphQLType type) {\n+        return getDefaultValue(type, 0);\n+    }\n+\n+    private String getDefaultValue(GraphQLType type, int depth) {\n+        if (depth > MAX_DEPTH) return \"null\";\n+        StringBuilder defaultValue = new StringBuilder();\n+        if (type instanceof GraphQLNonNull) {\n+            GraphQLNonNull nonNullType = (GraphQLNonNull) type;\n+            type = nonNullType.getWrappedType();\n+        }\n+        if (type instanceof GraphQLScalarType) {\n+            GraphQLScalarType scalar = (GraphQLScalarType) type;\n+            switch (scalar.getName()) {\n+                case \"Int\":\n+                case \"ID\":\n+                    defaultValue.append(\"1\");\n+                    break;\n+                case \"Float\":\n+                    defaultValue.append(\"3.14\");\n+                    break;\n+                case \"String\":\n+                    defaultValue.append(\"\\\"hello\\\"\");\n+                    break;\n+                case \"Boolean\":\n+                    defaultValue.append(\"true\");\n+                    break;\n+            }\n+        } else if (type instanceof GraphQLEnumType) {\n+            GraphQLEnumType enumType = (GraphQLEnumType) type;\n+            defaultValue.append(enumType.getValues().get(0).getName());\n+        } else if (type instanceof GraphQLInputObjectType) {\n+            GraphQLInputObjectType object = (GraphQLInputObjectType) type;\n+            defaultValue.append(\"{ \");\n+            List<GraphQLInputObjectField> fields = object.getFields();\n+            for (GraphQLInputObjectField field : fields) {\n+                defaultValue\n+                        .append(field.getName())\n+                        .append(\": \")\n+                        .append(getDefaultValue(field.getType(), depth + 1))\n+                        .append(\", \");\n+            }\n+            defaultValue.setLength(defaultValue.length() - 2);\n+            defaultValue.append(\" }\");\n+        } else if (type instanceof GraphQLList) {\n+            GraphQLList list = (GraphQLList) type;\n+            String wrappedValue = getDefaultValue(list.getWrappedType(), depth + 1);\n+            defaultValue\n+                    .append(\"[\")\n+                    .append(wrappedValue)\n+                    .append(\", \")\n+                    .append(wrappedValue)\n+                    .append(\", \")\n+                    .append(wrappedValue)\n+                    .append(\"]\");\n+        } else defaultValue.append(\"null\");", "originalCommit": "47a2041bea301ac3c05ac1e09282ac5bc17002e7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODA2ODg3Mw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r458068873", "bodyText": "There are probably core constants for a bunch of these, check HttpHeader etc. (Maybe not the content types, but the HTTP declaration and header field names I'm pretty sure about). Maybe make local constants for the content types.", "author": "kingthorin", "createdAt": "2020-07-21T12:48:30Z", "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/Requestor.java", "diffHunk": "@@ -49,6 +55,61 @@ public Requestor(int initiator) {\n                 HttpRequestConfig.builder().setRedirectionValidator(new MessageHandler()).build();\n     }\n \n+    public HttpMessage sendQueryByGet(String query) {\n+        HttpMessage message = null;\n+        try {\n+            URI url =\n+                    UrlBuilder.build(\n+                            endpointUrl\n+                                    + \"?query=\"\n+                                    + URLEncoder.encode(query, StandardCharsets.UTF_8.toString()));\n+            message = new HttpMessage(url);\n+            send(message);\n+        } catch (IOException e) {\n+            LOG.error(e.getMessage());\n+        }\n+        return message;\n+    }\n+\n+    public HttpMessage sendQueryByGraphQlPost(String query) {\n+        HttpMessage message = null;\n+        try {\n+            HttpRequestBody msgBody = new HttpRequestBody(query);\n+            HttpRequestHeader msgHeader =\n+                    new HttpRequestHeader(HttpRequestHeader.POST, endpointUrl, \"HTTP/1.1\");\n+            msgHeader.setHeader(\"Accept\", \"application/json\");\n+            msgHeader.setHeader(\"Content-Type\", \"application/graphql\");", "originalCommit": "47a2041bea301ac3c05ac1e09282ac5bc17002e7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6dbd0e26114a77d4b99cdb3bdc77a1e84501f76c", "url": "https://github.com/zaproxy/zap-extensions/commit/6dbd0e26114a77d4b99cdb3bdc77a1e84501f76c", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-22T11:14:03Z", "type": "forcePushed"}, {"oid": "47f304ad0ab709707119715959da6ee797f96e2d", "url": "https://github.com/zaproxy/zap-extensions/commit/47f304ad0ab709707119715959da6ee797f96e2d", "message": "Add Query Generation Functionality\n\n- Add class GraphQlGenerator\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-22T16:18:24Z", "type": "forcePushed"}, {"oid": "60f4c6a089f35f4ca4b0d1ebe8f3d0a6ffe04442", "url": "https://github.com/zaproxy/zap-extensions/commit/60f4c6a089f35f4ca4b0d1ebe8f3d0a6ffe04442", "message": "Add Query Generation Functionality\n\n- Add classes GraphQlGenerator, GraphQlOptionsPanel, GraphQlParam\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-24T11:50:58Z", "type": "forcePushed"}, {"oid": "c39f80e29dc950e01ab3ee889a054cf4f4c2ae64", "url": "https://github.com/zaproxy/zap-extensions/commit/c39f80e29dc950e01ab3ee889a054cf4f4c2ae64", "message": "Add Query Generation Functionality\n\n- Add classes GraphQlGenerator, GraphQlOptionsPanel, GraphQlParam\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-25T08:52:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjIzNjY2Mg==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r462236662", "bodyText": "t seems like this is being done in every test. Should it be being done in the code somewhere? Or does it indicate an issue with the generator?", "author": "kingthorin", "createdAt": "2020-07-29T11:44:35Z", "path": "addOns/graphql/src/test/java/org/zaproxy/addon/graphql/GraphQlGeneratorUnitTest.java", "diffHunk": "@@ -0,0 +1,211 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.graphql;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.zaproxy.zap.testutils.TestUtils;\n+\n+public class GraphQlGeneratorUnitTest extends TestUtils {\n+    GraphQlGenerator generator;\n+    GraphQlParam param;\n+\n+    @BeforeEach\n+    public void setup() throws Exception {\n+        setUpZap();\n+        param = new GraphQlParam(5, 5, true, null, null);\n+    }\n+\n+    @Test\n+    public void scalarFieldsOnly() throws Exception {\n+        generator = new GraphQlGenerator(getHtml(\"scalarFieldsOnly.graphql\"), null, param);\n+        String query = generator.generateFull(GraphQlGenerator.RequestType.QUERY);\n+        query = query.replaceAll(\"\\\\s+\", \" \").trim();\n+        String expectedQuery = \"{ name id age height human }\";\n+        assertEquals(query, expectedQuery);\n+    }\n+\n+    @Test\n+    public void zeroDepthObjects() throws Exception {\n+        generator = new GraphQlGenerator(getHtml(\"zeroDepthObjects.graphql\"), null, param);\n+        String query = generator.generateFull(GraphQlGenerator.RequestType.QUERY);\n+        query = query.replaceAll(\"\\\\s+\", \" \").trim();", "originalCommit": "c39f80e29dc950e01ab3ee889a054cf4f4c2ae64", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI1NTAzNg==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r462255036", "bodyText": "Seems like this isn't required anymore. I had put it there originally because the generator was adding spaces and newlines for pretty printing each query. But since the pretty printing is actually pointless (because the escape characters show as-is as part of a JSON string in the request editor), I had removed all of them, but forgot to update the tests. Good catch; I'll update the tests.", "author": "ricekot", "createdAt": "2020-07-29T12:19:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjIzNjY2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI1ODAwOA==", "url": "https://github.com/zaproxy/zap-extensions/pull/2485#discussion_r462258008", "bodyText": "Okay no worries.", "author": "kingthorin", "createdAt": "2020-07-29T12:24:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjIzNjY2Mg=="}], "type": "inlineReview"}, {"oid": "404dac778e1893b313443f8e8955262e08c1c59d", "url": "https://github.com/zaproxy/zap-extensions/commit/404dac778e1893b313443f8e8955262e08c1c59d", "message": "Add Query Generation Functionality\n\n- Add classes GraphQlGenerator, GraphQlOptionsPanel, GraphQlParam\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-29T12:22:59Z", "type": "commit"}, {"oid": "404dac778e1893b313443f8e8955262e08c1c59d", "url": "https://github.com/zaproxy/zap-extensions/commit/404dac778e1893b313443f8e8955262e08c1c59d", "message": "Add Query Generation Functionality\n\n- Add classes GraphQlGenerator, GraphQlOptionsPanel, GraphQlParam\n- Add tests for the generator\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-07-29T12:22:59Z", "type": "forcePushed"}]}