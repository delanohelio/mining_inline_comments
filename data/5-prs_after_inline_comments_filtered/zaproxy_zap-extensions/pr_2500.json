{"pr_number": 2500, "pr_title": "CsrfTokenScanRule Ignore Non-HTML & Prepare Release", "pr_createdAt": "2020-07-23T01:29:10Z", "pr_url": "https://github.com/zaproxy/zap-extensions/pull/2500", "timeline": [{"oid": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951", "url": "https://github.com/zaproxy/zap-extensions/commit/5fa7f1c8c53238aaee2eb9f85dd49a2b34257951", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare Next Dev Iteration\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next iteration and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-07-23T01:29:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMxMzk3Mg==", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#discussion_r459313972", "bodyText": "Remove?", "author": "thc202", "createdAt": "2020-07-23T09:09:40Z", "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/CsrfTokenScanRule.java", "diffHunk": "@@ -131,8 +131,11 @@ public void init() {\n      */\n     @Override\n     public void scan() {\n-        if (AlertThreshold.HIGH.equals(getAlertThreshold()) && !getBaseMsg().isInScope()) {\n-            return; // At HIGH threshold return if the msg isn't in scope\n+        if ((AlertThreshold.HIGH.equals(getAlertThreshold()) && !getBaseMsg().isInScope())\n+                || !getBaseMsg().getResponseHeader().isHtml()) {\n+            // At HIGH threshold return if the msg isn't in scope\n+            // If the original isn't an HTML response then we shouldn't analyze it.", "originalCommit": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMxODc2Mw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#discussion_r459318763", "bodyText": "shouldNotProcessNonHtml would be more accurate, it's not just JavaScript. It could also be parameterized with more types.", "author": "thc202", "createdAt": "2020-07-23T09:18:41Z", "path": "addOns/ascanrulesBeta/src/test/java/org/zaproxy/zap/extension/ascanrulesBeta/CsrfTokenScanRuleUnitTest.java", "diffHunk": "@@ -98,6 +99,27 @@ public void shouldNotProcessWithoutForm() throws Exception {\n         assertThat(httpMessagesSent, hasSize(0));\n     }\n \n+    @Test\n+    public void shouldNotProcessJavaScript() throws Exception {", "originalCommit": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "74f50bfc68ef421a05caf131bcb4468fc445e728", "url": "https://github.com/zaproxy/zap-extensions/commit/74f50bfc68ef421a05caf131bcb4468fc445e728", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare Next Dev Iteration\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next iteration and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-07-23T10:53:42Z", "type": "forcePushed"}, {"oid": "a3d2f3c2a4eaa5b8142a424001d7640c25fb8f55", "url": "https://github.com/zaproxy/zap-extensions/commit/a3d2f3c2a4eaa5b8142a424001d7640c25fb8f55", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare release\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next release and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-07-23T10:55:51Z", "type": "forcePushed"}, {"oid": "e7633b9706ee0b6cf0cc32936c4cb157bfe362e5", "url": "https://github.com/zaproxy/zap-extensions/commit/e7633b9706ee0b6cf0cc32936c4cb157bfe362e5", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare release\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next release and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-07-23T12:21:16Z", "type": "commit"}, {"oid": "e7633b9706ee0b6cf0cc32936c4cb157bfe362e5", "url": "https://github.com/zaproxy/zap-extensions/commit/e7633b9706ee0b6cf0cc32936c4cb157bfe362e5", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare release\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next release and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-07-23T12:21:16Z", "type": "forcePushed"}]}