{"pr_number": 2591, "pr_title": "Retire: Add example alerts", "pr_createdAt": "2020-10-28T17:50:21Z", "pr_url": "https://github.com/zaproxy/zap-extensions/pull/2591", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDA2ODcxNA==", "url": "https://github.com/zaproxy/zap-extensions/pull/2591#discussion_r514068714", "bodyText": "The types could be removed.", "author": "thc202", "createdAt": "2020-10-29T08:06:04Z", "path": "addOns/retire/src/main/java/org/zaproxy/addon/retire/RetireScanRule.java", "diffHunk": "@@ -88,27 +91,39 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n                     otherInfo = otherInfo + result.getOtherinfo();\n                 }\n \n-                newAlert()\n-                        .setRisk(Alert.RISK_MEDIUM)\n-                        .setConfidence(Alert.CONFIDENCE_MEDIUM)\n-                        .setDescription(\n-                                Constant.messages.getString(\n-                                        \"retire.rule.desc\",\n-                                        result.getFilename(),\n-                                        result.getVersion()))\n-                        .setOtherInfo(otherInfo)\n-                        .setReference(getDetails(Result.INFO, result.getInfo()))\n-                        .setSolution(\n-                                Constant.messages.getString(\n-                                        \"retire.rule.soln\", result.getFilename()))\n-                        .setEvidence(result.getEvidence())\n-                        .setCweId(829) // CWE-829: Inclusion of Functionality from Untrusted Control\n-                        // Sphere\n-                        .raise();\n+                buildAlert(result, otherInfo).raise();\n             }\n         }\n     }\n \n+    private AlertBuilder buildAlert(Result result, String otherInfo) {\n+        return newAlert()\n+                .setRisk(Alert.RISK_MEDIUM)\n+                .setConfidence(Alert.CONFIDENCE_MEDIUM)\n+                .setDescription(\n+                        Constant.messages.getString(\n+                                \"retire.rule.desc\", result.getFilename(), result.getVersion()))\n+                .setOtherInfo(otherInfo)\n+                .setReference(getDetails(Result.INFO, result.getInfo()))\n+                .setSolution(Constant.messages.getString(\"retire.rule.soln\", result.getFilename()))\n+                .setEvidence(result.getEvidence())\n+                .setCweId(829); // CWE-829: Inclusion of Functionality from Untrusted Control Sphere\n+    }\n+\n+    public List<Alert> getExampleAlerts() {\n+        List<Alert> alerts = new ArrayList<Alert>();\n+        alerts.add(\n+                buildAlert(\n+                                new Result(\n+                                        \"ExampleLibrary\",\n+                                        \"x.y.z\",\n+                                        Collections.<String, Set<String>>emptyMap(),", "originalCommit": "e28418fc3c18d3ea0c4003f6b904879991746c9e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDEwMjgwNg==", "url": "https://github.com/zaproxy/zap-extensions/pull/2591#discussion_r514102806", "bodyText": "Done :)", "author": "psiinon", "createdAt": "2020-10-29T09:05:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDA2ODcxNA=="}], "type": "inlineReview"}, {"oid": "0b54f2110354f66186f713a5d481c672307b2e8f", "url": "https://github.com/zaproxy/zap-extensions/commit/0b54f2110354f66186f713a5d481c672307b2e8f", "message": "Retire: Add example alerts\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>", "committedDate": "2020-10-29T09:05:04Z", "type": "commit"}, {"oid": "0b54f2110354f66186f713a5d481c672307b2e8f", "url": "https://github.com/zaproxy/zap-extensions/commit/0b54f2110354f66186f713a5d481c672307b2e8f", "message": "Retire: Add example alerts\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>", "committedDate": "2020-10-29T09:05:04Z", "type": "forcePushed"}]}