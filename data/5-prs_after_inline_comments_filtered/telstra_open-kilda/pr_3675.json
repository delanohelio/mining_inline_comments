{"pr_number": 3675, "pr_title": "Add check for the allocated paths to ensure that all ISLs are active on those paths", "pr_createdAt": "2020-08-05T13:24:12Z", "pr_url": "https://github.com/telstra/open-kilda/pull/3675", "timeline": [{"oid": "876d29d8518846dc5c71d7d9d96cfad5021af237", "url": "https://github.com/telstra/open-kilda/commit/876d29d8518846dc5c71d7d9d96cfad5021af237", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths.", "committedDate": "2020-08-06T12:52:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg1NTQ1Mw==", "url": "https://github.com/telstra/open-kilda/pull/3675#discussion_r466855453", "bodyText": "if this check fails will we end up with stalled resources allocated for the flow? since transaction is committed", "author": "timofei-durakov", "createdAt": "2020-08-07T06:53:26Z", "path": "src-java/flowhs-topology/flowhs-storm-topology/src/main/java/org/openkilda/wfm/topology/flowhs/fsm/common/actions/BaseResourceAllocationAction.java", "diffHunk": "@@ -196,6 +201,8 @@ private void doAllocateInTransaction(T stateMachine) {\n         } catch (FailsafeException ex) {\n             throw ex.getCause();\n         }\n+\n+        checkAllocatedPaths(stateMachine);", "originalCommit": "876d29d8518846dc5c71d7d9d96cfad5021af237", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg3NDQ0OA==", "url": "https://github.com/telstra/open-kilda/pull/3675#discussion_r466874448", "bodyText": "Yes, you are right. Added a method for removing paths.", "author": "dpoltavets", "createdAt": "2020-08-07T07:38:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg1NTQ1Mw=="}], "type": "inlineReview"}, {"oid": "21d413ce3d8016710439a13cc87bd8094425ed98", "url": "https://github.com/telstra/open-kilda/commit/21d413ce3d8016710439a13cc87bd8094425ed98", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths.", "committedDate": "2020-08-07T07:36:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg4MTY1OQ==", "url": "https://github.com/telstra/open-kilda/pull/3675#discussion_r466881659", "bodyText": "what's aabout cookies, meters, vlans?", "author": "timofei-durakov", "createdAt": "2020-08-07T07:53:04Z", "path": "src-java/flowhs-topology/flowhs-storm-topology/src/main/java/org/openkilda/wfm/topology/flowhs/fsm/common/actions/BaseResourceAllocationAction.java", "diffHunk": "@@ -196,6 +201,13 @@ private void doAllocateInTransaction(T stateMachine) {\n         } catch (FailsafeException ex) {\n             throw ex.getCause();\n         }\n+\n+        try {\n+            checkAllocatedPaths(stateMachine);\n+        } catch (ResourceAllocationException ex) {\n+            removeAllocatedPaths(stateMachine);", "originalCommit": "21d413ce3d8016710439a13cc87bd8094425ed98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg5MTEyOQ==", "url": "https://github.com/telstra/open-kilda/pull/3675#discussion_r466891129", "bodyText": "Added deletion of these resources.", "author": "dpoltavets", "createdAt": "2020-08-07T08:12:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg4MTY1OQ=="}], "type": "inlineReview"}, {"oid": "c53f981b2cb94e82b53b1fab86e9eaa5b831e122", "url": "https://github.com/telstra/open-kilda/commit/c53f981b2cb94e82b53b1fab86e9eaa5b831e122", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths.", "committedDate": "2020-08-07T08:11:45Z", "type": "forcePushed"}, {"oid": "7d9ba629d59a0429bd1f2aa9a40e81486371fd8f", "url": "https://github.com/telstra/open-kilda/commit/7d9ba629d59a0429bd1f2aa9a40e81486371fd8f", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths.", "committedDate": "2020-08-07T11:59:00Z", "type": "commit"}, {"oid": "7d9ba629d59a0429bd1f2aa9a40e81486371fd8f", "url": "https://github.com/telstra/open-kilda/commit/7d9ba629d59a0429bd1f2aa9a40e81486371fd8f", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths.", "committedDate": "2020-08-07T11:59:00Z", "type": "forcePushed"}]}