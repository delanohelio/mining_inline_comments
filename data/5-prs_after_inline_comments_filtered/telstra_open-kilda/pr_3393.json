{"pr_number": 3393, "pr_title": "Expose discovery latency as separate log field", "pr_createdAt": "2020-04-15T10:29:55Z", "pr_url": "https://github.com/telstra/open-kilda/pull/3393", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODc3NzcyNQ==", "url": "https://github.com/telstra/open-kilda/pull/3393#discussion_r408777725", "bodyText": "Shouldn't the method be private? I don't a reason for  PathVerificationService to expose such methods.", "author": "sergii-iakovenko", "createdAt": "2020-04-15T11:41:06Z", "path": "src-java/floodlight-service/floodlight-modules/src/main/java/org/openkilda/floodlight/pathverification/PathVerificationService.java", "diffHunk": "@@ -740,4 +740,14 @@ private long getSwitchPortSpeed(IOFSwitch sw, OFPort inPort) {\n     private long getAvailableBandwidth(long speed) {\n         return (long) (speed * islBandwidthQuotient);\n     }\n+\n+    /**\n+     * Convert milliseconds into nanoseconds, taking in account illegal (-1) latency value.\n+     */\n+    public static long scaleLatencyMsToNs(long latencyMs) {", "originalCommit": "490e2108c4895b28c607651958f8b9a468889d75", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgwNDQ2MA==", "url": "https://github.com/telstra/open-kilda/pull/3393#discussion_r408804460", "bodyText": "yes, it should. There was a plan to use it outside, but this is not required anymore.", "author": "surabujin", "createdAt": "2020-04-15T12:30:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODc3NzcyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODc3NzI2NQ==", "url": "https://github.com/telstra/open-kilda/pull/3393#discussion_r408777265", "bodyText": "yes, we need it because this value could be used in\n\nIsl latency database field\nopentsdb rtt metric\nboth these metrics are in nano seconds", "author": "niksv", "createdAt": "2020-04-15T11:40:11Z", "path": "src-java/floodlight-service/floodlight-modules/src/main/java/org/openkilda/floodlight/pathverification/PathVerificationService.java", "diffHunk": "@@ -601,7 +604,7 @@ private void handleDiscoveryPacket(OfInput input, IOFSwitch destSwitch, Discover\n                 source.getPortNo(),\n                 destination.getSwitchId(),\n                 destination.getPortNo(),\n-                latency,\n+                scaleLatencyMsToNs(latencyMs),  // TODO(surabujin): do we really need fake ns accuracy?", "originalCommit": "490e2108c4895b28c607651958f8b9a468889d75", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODkxMzI0Nw==", "url": "https://github.com/telstra/open-kilda/pull/3393#discussion_r408913247", "bodyText": "So we should make this conversion right before storing it in the mentioned storage. At least the fake ns accuracy conversion reason will be more obvious.", "author": "surabujin", "createdAt": "2020-04-15T15:02:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODc3NzI2NQ=="}], "type": "inlineReview"}, {"oid": "4184e41f68fbdb557c1b3f03477886d53023de97", "url": "https://github.com/telstra/open-kilda/commit/4184e41f68fbdb557c1b3f03477886d53023de97", "message": "Expose discovery latency as separate log field", "committedDate": "2020-04-15T12:31:39Z", "type": "forcePushed"}, {"oid": "6b22e5a64b0a4d64367d0a9751fe22226a71528a", "url": "https://github.com/telstra/open-kilda/commit/6b22e5a64b0a4d64367d0a9751fe22226a71528a", "message": "Expose discovery latency as separate log field", "committedDate": "2020-04-15T15:53:06Z", "type": "commit"}, {"oid": "6b22e5a64b0a4d64367d0a9751fe22226a71528a", "url": "https://github.com/telstra/open-kilda/commit/6b22e5a64b0a4d64367d0a9751fe22226a71528a", "message": "Expose discovery latency as separate log field", "committedDate": "2020-04-15T15:53:06Z", "type": "forcePushed"}]}