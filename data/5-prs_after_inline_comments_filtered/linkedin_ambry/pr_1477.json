{"pr_number": 1477, "pr_title": "Use DelayedAutoRebalancer in Helix VCR cluster", "pr_createdAt": "2020-04-17T00:18:40Z", "pr_url": "https://github.com/linkedin/ambry/pull/1477", "timeline": [{"oid": "da58f46dc91128eaa56d6b3884454ad59e27e959", "url": "https://github.com/linkedin/ambry/commit/da58f46dc91128eaa56d6b3884454ad59e27e959", "message": "Use DelayedAutoRebalancer in Helix VCR cluster\nAdd tool option to update existing resources", "committedDate": "2020-04-17T00:16:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0MjEzMg==", "url": "https://github.com/linkedin/ambry/pull/1477#discussion_r416142132", "bodyText": "I am a little confused about this comment because I see resource ideal state is updated in the following lines.", "author": "jsjtzyy", "createdAt": "2020-04-27T20:55:52Z", "path": "ambry-tools/src/main/java/com/github/ambry/clustermap/HelixVcrPopulateTool.java", "diffHunk": "@@ -92,11 +101,26 @@ public static void main(String[] args) {\n     }\n \n     if (options.has(updateClusterOpt)) {\n-      String srcZkString = options.valueOf(srcOpt).split(SEPARATOR)[0];\n-      String srcClusterName = options.valueOf(srcOpt).split(SEPARATOR)[1];\n-      System.out.println(\"Updating cluster: \" + destClusterName + \"by checking \" + srcClusterName);\n       boolean dryRun = options.has(dryRunOpt);\n-      updateResourceAndPartition(srcZkString, srcClusterName, destZkString, destClusterName, dryRun);\n+      if (options.has(srcOpt)) {\n+        String[] srcZkAndCluster = options.valueOf(srcOpt).split(SEPARATOR);\n+        if (srcZkAndCluster.length != 2) {\n+          errorAndExit(\"src argument must have form 'zkString/clusterName'\");\n+        }\n+        String srcZkString = srcZkAndCluster[0];\n+        String srcClusterName = srcZkAndCluster[1];\n+        System.out.println(\"Updating cluster: \" + destClusterName + \"by checking \" + srcClusterName);\n+        updateResourceAndPartition(srcZkString, srcClusterName, destZkString, destClusterName, dryRun);\n+      } else {\n+        // Just update cluster config, not resources", "originalCommit": "da58f46dc91128eaa56d6b3884454ad59e27e959", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjIzMzYzMg==", "url": "https://github.com/linkedin/ambry/pull/1477#discussion_r416233632", "bodyText": "Yeah, I meant the resources would not be updated with any new partitions, though their idealstate is still updated.  I removed the comment, it's not needed.", "author": "lightningrob", "createdAt": "2020-04-28T00:10:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0MjEzMg=="}], "type": "inlineReview"}, {"oid": "7c53ba3debc4d918436ede42dae9c9276147f6dc", "url": "https://github.com/linkedin/ambry/commit/7c53ba3debc4d918436ede42dae9c9276147f6dc", "message": "Remove confusing comment", "committedDate": "2020-04-28T00:03:33Z", "type": "commit"}]}