{"pr_number": 3208, "pr_title": "[STORM-3579]  use the topo conf for thrift client in Worker code", "pr_createdAt": "2020-02-11T04:06:19Z", "pr_url": "https://github.com/apache/storm/pull/3208", "timeline": [{"oid": "65f374c5e9a258d1d485e8c99c334c0ba6122f74", "url": "https://github.com/apache/storm/commit/65f374c5e9a258d1d485e8c99c334c0ba6122f74", "message": "[STORM-3579]  use the topo conf for thrift client in Worker code", "committedDate": "2020-02-11T03:50:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzY3MjM5Mg==", "url": "https://github.com/apache/storm/pull/3208#discussion_r377672392", "bodyText": "can we update the javadoc that this is a supervisor conf?", "author": "agresch", "createdAt": "2020-02-11T14:36:16Z", "path": "storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java", "diffHunk": "@@ -106,9 +105,9 @@\n      * @param port           - port on which the worker runs\n      * @param workerId       - worker id\n      */\n-\n     public Worker(Map<String, Object> conf, IContext context, String topologyId, String assignmentId,", "originalCommit": "65f374c5e9a258d1d485e8c99c334c0ba6122f74", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODM5MzY2NA==", "url": "https://github.com/apache/storm/pull/3208#discussion_r378393664", "bodyText": "That would be great. Will do it (or some can do it) in the future if come across this code again.", "author": "Ethanlm", "createdAt": "2020-02-12T17:14:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzY3MjM5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzY3NDUyMg==", "url": "https://github.com/apache/storm/pull/3208#discussion_r377674522", "bodyText": "Can you update the javadoc for NimbusClient.getConfiguredClient() to indicate it needs a topoconf?\nAre there any other uses of NimbusClient.getConfiguredClient() that need fixing?", "author": "agresch", "createdAt": "2020-02-11T14:39:37Z", "path": "storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java", "diffHunk": "@@ -443,7 +451,7 @@ private void heartbeatToMasterIfLocalbeatFail(LSWorkerHeartbeat lsWorkerHeartbea\n         } catch (Exception tr1) {\n             //If any error/exception thrown, report directly to nimbus.\n             LOG.warn(\"Exception when send heartbeat to local supervisor\", tr1.getMessage());\n-            try (NimbusClient nimbusClient = NimbusClient.getConfiguredClient(conf)) {\n+            try (NimbusClient nimbusClient = NimbusClient.getConfiguredClient(topologyConf)) {", "originalCommit": "65f374c5e9a258d1d485e8c99c334c0ba6122f74", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODM5MjY0OA==", "url": "https://github.com/apache/storm/pull/3208#discussion_r378392648", "bodyText": "NimbusClient does not need a topoConf strictly. If it's used on supervisor, it will be a supervisor conf.", "author": "Ethanlm", "createdAt": "2020-02-12T17:12:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzY3NDUyMg=="}], "type": "inlineReview"}]}