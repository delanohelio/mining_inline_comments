{"pr_number": 13506, "pr_title": "Create local session based on remote session and distributed applicat\u2026", "pr_createdAt": "2020-06-08T10:44:33Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/13506", "timeline": [{"oid": "a95f1ce7879669ce0c5ec109835fe35cd7a5b2fb", "url": "https://github.com/vespa-engine/vespa/commit/a95f1ce7879669ce0c5ec109835fe35cd7a5b2fb", "message": "Create local session based on remote session and distributed application package\n\nDoes not use the local session yet (not added to LocalSessionRepo), but application\npackage is added to file system", "committedDate": "2020-06-08T10:42:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjcwOTM3Mw==", "url": "https://github.com/vespa-engine/vespa/pull/13506#discussion_r436709373", "bodyText": "Why should it, any consequences?", "author": "gjoranv", "createdAt": "2020-06-08T13:41:23Z", "path": "configserver/src/main/java/com/yahoo/vespa/config/server/session/SessionFactory.java", "diffHunk": "@@ -161,23 +164,47 @@ private LocalSession create(File applicationFile, ApplicationId applicationId, l\n                                 boolean internalRedeploy, TimeoutBudget timeoutBudget) {\n         long sessionId = getNextSessionId();\n         try {\n-            ensureSessionPathDoesNotExist(sessionId);\n+            ApplicationPackage app = createApplicationPackage(applicationFile, applicationId,\n+                                                              sessionId, currentlyActiveSessionId, internalRedeploy);\n+            return createSessionFromApplication(app, sessionId, timeoutBudget, clock);\n+        } catch (Exception e) {\n+            throw new RuntimeException(\"Error creating session \" + sessionId, e);\n+        }\n+    }\n+\n+    /**\n+     * This method is used when creating a session based on a remote session and the distributed application package\n+     * It does not wait for session being created on other servers", "originalCommit": "a95f1ce7879669ce0c5ec109835fe35cd7a5b2fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjU3OA==", "url": "https://github.com/vespa-engine/vespa/pull/13506#discussion_r436802578", "bodyText": "The other methods will do that because at that point the session is created for the first time and we want to wait until it is created on all servers. In this method we know that has already happened. Doing so would just be unnecessary (probably not an error, though, I haven't looked int it)", "author": "hmusum", "createdAt": "2020-06-08T15:38:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjcwOTM3Mw=="}], "type": "inlineReview"}]}