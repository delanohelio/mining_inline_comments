{"pr_number": 13727, "pr_title": "Config server refactoring, remove TenantHandlerProvider", "pr_createdAt": "2020-06-28T09:52:28Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/13727", "timeline": [{"oid": "c45b449ed249b6c2cdd1910eb89ddd5ab342cb44", "url": "https://github.com/vespa-engine/vespa/commit/c45b449ed249b6c2cdd1910eb89ddd5ab342cb44", "message": "Do not hardcode application id in MockTenantProvider and MockRequestHandler\n\nHardcoding makes it really hard to understand what is going on when you\ntry to use something else than the default application id in a test", "committedDate": "2020-06-28T08:32:40Z", "type": "commit"}, {"oid": "afbbd3230a33e7e572d246a4de0d5650e3161fa2", "url": "https://github.com/vespa-engine/vespa/commit/afbbd3230a33e7e572d246a4de0d5650e3161fa2", "message": "Remove unused argument", "committedDate": "2020-06-28T08:41:26Z", "type": "commit"}, {"oid": "8ec420c7f72686162b797826d61f6408e379b805", "url": "https://github.com/vespa-engine/vespa/commit/8ec420c7f72686162b797826d61f6408e379b805", "message": "Rewrite test to use less low-level code\n\nAlso use TenantHandlerProvider less", "committedDate": "2020-06-28T09:46:07Z", "type": "commit"}, {"oid": "06df2bd19373923c0566ec2d8f83d674458d9c38", "url": "https://github.com/vespa-engine/vespa/commit/06df2bd19373923c0566ec2d8f83d674458d9c38", "message": "Remove TenantHandlerProvider", "committedDate": "2020-06-28T09:50:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg1MTIxNw==", "url": "https://github.com/vespa-engine/vespa/pull/13727#discussion_r446851217", "bodyText": "It would probably make sense to rename this class to MockRpcServer", "author": "gjoranv", "createdAt": "2020-06-29T08:18:16Z", "path": "configserver/src/test/java/com/yahoo/vespa/config/server/rpc/MockRpc.java", "diffHunk": "@@ -39,20 +37,15 @@\n     public volatile JRTServerConfigRequest latestRequest = null;\n \n \n-    public MockRpc(int port, boolean createDefaultTenant, boolean pretendToHaveLoadedAnyApplication, File tempDir) {\n-        super(createConfig(port), null, Metrics.createTestMetrics(), \n-              new HostRegistries(), new ConfigRequestHostLivenessTracker(), new FileServer(tempDir), new NoopRpcAuthorizer(), new RpcRequestHandlerProvider());\n-        if (createDefaultTenant) {\n-            onTenantCreate(TenantName.from(\"default\"), new MockTenantProvider(pretendToHaveLoadedAnyApplication));\n-        }\n-    }\n-\n-    public MockRpc(int port, boolean createDefaultTenant, File tempDir) {\n-        this(port, createDefaultTenant, true, tempDir);\n-    }\n-\n     public MockRpc(int port, File tempDir) {", "originalCommit": "c45b449ed249b6c2cdd1910eb89ddd5ab342cb44", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4MzYyMg==", "url": "https://github.com/vespa-engine/vespa/pull/13727#discussion_r446883622", "bodyText": "Agreed, I'll do that in a later PR", "author": "hmusum", "createdAt": "2020-06-29T10:11:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg1MTIxNw=="}], "type": "inlineReview"}]}