{"pr_number": 13072, "pr_title": "Use fewer threads to get next generation of config", "pr_createdAt": "2020-04-26T19:46:08Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/13072", "timeline": [{"oid": "c6f4c3c58e85b059caeb33b6654e713977408b3d", "url": "https://github.com/vespa-engine/vespa/commit/c6f4c3c58e85b059caeb33b6654e713977408b3d", "message": "Use fewer threads to get next generation of config\n\nCheck for next config generation in one thread.\nSimplify Subscriber.\nUse a ConcurrentHashMap for active subscribers.\nReduces the number of threads used by config proxy from ~230 to ~30", "committedDate": "2020-04-26T19:43:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM5MzI1Mg==", "url": "https://github.com/vespa-engine/vespa/pull/13072#discussion_r415393252", "bodyText": "Every 10ms sounds like it is often enough :)", "author": "baldersheim", "createdAt": "2020-04-26T20:24:57Z", "path": "config-proxy/src/main/java/com/yahoo/vespa/config/proxy/RpcConfigSourceClient.java", "diffHunk": "@@ -69,14 +74,10 @@\n         this.memoryCache = memoryCache;\n         this.delayedResponses = new DelayedResponses();\n         checkConfigSources();\n-        exec = Executors.newCachedThreadPool(new DaemonThreadFactory(\"subscriber-\"));\n+        nextConfigFuture = nextConfigScheduler.scheduleAtFixedRate(this, 0, 10, MILLISECONDS);", "originalCommit": "c6f4c3c58e85b059caeb33b6654e713977408b3d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}