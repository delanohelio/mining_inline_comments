{"pr_number": 13394, "pr_title": "Do not schedule NodeAgentContext if not waiting", "pr_createdAt": "2020-05-27T09:30:21Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/13394", "timeline": [{"oid": "f9fdcc763aa61a57ebe036664fe2a58b2e922164", "url": "https://github.com/vespa-engine/vespa/commit/f9fdcc763aa61a57ebe036664fe2a58b2e922164", "message": "Do not schedule new context unless already waiting for one", "committedDate": "2020-05-27T09:24:51Z", "type": "commit"}, {"oid": "9d056d05c4b37f41e46e7a8a2a62794952c26498", "url": "https://github.com/vespa-engine/vespa/commit/9d056d05c4b37f41e46e7a8a2a62794952c26498", "message": "Simplify", "committedDate": "2020-05-27T09:27:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAxMTM0NA==", "url": "https://github.com/vespa-engine/vespa/pull/13394#discussion_r431011344", "bodyText": "This meant that if NA spent >1 HA tick, the context it eventually picked up on its next NA tick was >1 HA tick old?", "author": "hakonhall", "createdAt": "2020-05-27T10:18:50Z", "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/nodeagent/NodeAgentContextManager.java", "diffHunk": "@@ -76,7 +77,6 @@ public NodeAgentContext nextContext() throws InterruptedException {\n             }\n \n             currentContext = nextContext;\n-            nextContext = null;", "originalCommit": "9d056d05c4b37f41e46e7a8a2a62794952c26498", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAxNDI0MQ==", "url": "https://github.com/vespa-engine/vespa/pull/13394#discussion_r431014241", "bodyText": "No, NA would pick up the context set during the last HA tick.", "author": "freva", "createdAt": "2020-05-27T10:24:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAxMTM0NA=="}], "type": "inlineReview"}]}