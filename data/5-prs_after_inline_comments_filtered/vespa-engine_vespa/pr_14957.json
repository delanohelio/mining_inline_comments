{"pr_number": 14957, "pr_title": "Remove allow host sharing", "pr_createdAt": "2020-10-19T15:50:14Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/14957", "timeline": [{"oid": "1ccd768578e5aef40d4d19c43987fa46ce98e057", "url": "https://github.com/vespa-engine/vespa/commit/1ccd768578e5aef40d4d19c43987fa46ce98e057", "message": "Remove allowHostSharing", "committedDate": "2020-10-19T15:49:03Z", "type": "commit"}, {"oid": "771cfd6c9bf3f537715acaa0f2bdb693f45164d6", "url": "https://github.com/vespa-engine/vespa/commit/771cfd6c9bf3f537715acaa0f2bdb693f45164d6", "message": "Use dynamicProvisioning property", "committedDate": "2020-10-19T15:49:03Z", "type": "commit"}, {"oid": "ea72fc4e53147f6bb03bca9237e1cacd0df468d1", "url": "https://github.com/vespa-engine/vespa/commit/ea72fc4e53147f6bb03bca9237e1cacd0df468d1", "message": "Make sure HostProvisioner presence is 1-to-1 with dynamicProvisioning property", "committedDate": "2020-10-19T15:49:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3MzI1OQ==", "url": "https://github.com/vespa-engine/vespa/pull/14957#discussion_r507973259", "bodyText": "\"not necessary\" is not correct - we hope to enable rebalancing even with dynamic provisioning, but it's a todo.", "author": "hakonhall", "createdAt": "2020-10-19T18:27:59Z", "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/maintenance/Rebalancer.java", "diffHunk": "@@ -35,7 +35,7 @@ public Rebalancer(Deployer deployer,\n     @Override\n     protected boolean maintain() {\n         boolean success = true;\n-        if ( ! nodeRepository().zone().getCloud().allowHostSharing()) return success; // Rebalancing not necessary\n+        if (nodeRepository().zone().getCloud().dynamicProvisioning()) return success; // Rebalancing not necessary", "originalCommit": "ea72fc4e53147f6bb03bca9237e1cacd0df468d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3NTM4Ng==", "url": "https://github.com/vespa-engine/vespa/pull/14957#discussion_r507975386", "bodyText": "We'd like to maintain spare capacity in dynamically provisioned zones too - but it will depend on flags.", "author": "hakonhall", "createdAt": "2020-10-19T18:31:29Z", "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/maintenance/SpareCapacityMaintainer.java", "diffHunk": "@@ -68,7 +68,8 @@ public SpareCapacityMaintainer(Deployer deployer,\n     @Override\n     protected boolean maintain() {\n         boolean success = true;\n-        if ( ! nodeRepository().zone().getCloud().allowHostSharing()) return success;\n+        // Don't need to maintain spare capacity in dynamically provisioned zones; can provision more on demand.", "originalCommit": "ea72fc4e53147f6bb03bca9237e1cacd0df468d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}