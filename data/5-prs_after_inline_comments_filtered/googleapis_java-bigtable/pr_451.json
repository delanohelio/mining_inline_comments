{"pr_number": 451, "pr_title": "chore: make version embedding more robust", "pr_createdAt": "2020-10-07T20:45:08Z", "pr_url": "https://github.com/googleapis/java-bigtable/pull/451", "timeline": [{"oid": "696dc80bf9a7977992a08444c45c045fa7cedd77", "url": "https://github.com/googleapis/java-bigtable/commit/696dc80bf9a7977992a08444c45c045fa7cedd77", "message": "chore: make version embedding more robust\n\nThe previous approach used the jar manifest. Unfortunately that approaches falls apart when the consumer shades the client jar.\nThe new approach uses a combination of releasetool's version tag replacement and maven-resources-plugin to generate a class with an embedded version string", "committedDate": "2020-10-08T02:05:10Z", "type": "forcePushed"}, {"oid": "f6dd067bc4306dd02d829198daea8d7a05185756", "url": "https://github.com/googleapis/java-bigtable/commit/f6dd067bc4306dd02d829198daea8d7a05185756", "message": "chore: make version embedding more robust\n\nThe previous approach used the jar manifest. Unfortunately that approaches falls apart when the\nconsumer shades the client jar. The new approach uses a combination of releasetool's version tag\nreplacement and maven-resources-plugin to generate a class with an embedded version string.", "committedDate": "2020-10-08T02:07:50Z", "type": "commit"}, {"oid": "f6dd067bc4306dd02d829198daea8d7a05185756", "url": "https://github.com/googleapis/java-bigtable/commit/f6dd067bc4306dd02d829198daea8d7a05185756", "message": "chore: make version embedding more robust\n\nThe previous approach used the jar manifest. Unfortunately that approaches falls apart when the\nconsumer shades the client jar. The new approach uses a combination of releasetool's version tag\nreplacement and maven-resources-plugin to generate a class with an embedded version string.", "committedDate": "2020-10-08T02:07:50Z", "type": "forcePushed"}, {"oid": "22d831cc7dad747f4eb67b7eefd9e36fd437dc73", "url": "https://github.com/googleapis/java-bigtable/commit/22d831cc7dad747f4eb67b7eefd9e36fd437dc73", "message": "Simplify by using a file allowlisted in release-tool", "committedDate": "2020-10-16T18:54:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjY5NDA5Mw==", "url": "https://github.com/googleapis/java-bigtable/pull/451#discussion_r506694093", "bodyText": "@chingor13, to get this to work, I'm guessing we need to add a path here?  https://github.com/googleapis/release-please/blob/master/src/releasers/java-yoshi.ts#L182  Any thing else?", "author": "kolea2", "createdAt": "2020-10-16T20:00:25Z", "path": "google-cloud-bigtable/src/main/java/com/google/cloud/bigtable/GoogleUtils.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.google.cloud.bigtable;\n+\n+import com.google.api.core.InternalApi;\n+\n+/** Utility to get the current version of the Bigtable client. */\n+@InternalApi(\"For internal use only\")\n+// Note: this file MUST be named GoogleUtils.java so that it can be picked up by releasetool\n+public class GoogleUtils {\n+  public static final String BIGTABLE_CLIENT_VERSION =\n+      \"1.16.1-SNAPSHOT\"; // {x-version-update:google-cloud-bigtable:current}", "originalCommit": "22d831cc7dad747f4eb67b7eefd9e36fd437dc73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cccd64c83b2aa791c3b628c74fd2060ed0f9fd9e", "url": "https://github.com/googleapis/java-bigtable/commit/cccd64c83b2aa791c3b628c74fd2060ed0f9fd9e", "message": "Revert \"Simplify by using a file allowlisted in release-tool\"\n\nThis reverts commit 22d831cc7dad747f4eb67b7eefd9e36fd437dc73.", "committedDate": "2020-10-16T20:11:44Z", "type": "commit"}]}