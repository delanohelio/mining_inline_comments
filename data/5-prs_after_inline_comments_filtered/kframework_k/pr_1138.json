{"pr_number": 1138, "pr_title": "Patch for Issue #1137", "pr_createdAt": "2020-03-03T12:46:00Z", "pr_url": "https://github.com/kframework/k/pull/1138", "timeline": [{"oid": "abe5e902818bc2749aa184ba60edeb16d98341c1", "url": "https://github.com/kframework/k/commit/abe5e902818bc2749aa184ba60edeb16d98341c1", "message": "Patch for Issue #1137", "committedDate": "2020-03-03T12:41:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE2OTE5MA==", "url": "https://github.com/kframework/k/pull/1138#discussion_r387169190", "bodyText": "KompileOptions should be taken from original CompiledDefinition.", "author": "denis-bogdanas", "createdAt": "2020-03-03T17:12:51Z", "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "diffHunk": "@@ -55,6 +62,19 @@ public int run() {\n \n         Tuple2<Definition, Module> compiled = proofDefinitionBuilder\n                 .build(kproveOptions.specFile(files), kproveOptions.defModule, kproveOptions.specModule);\n+\n+        // Saving compiled definition to disk to be usable by other tools (e.g., kast)\n+        CompiledDefinition compiledDefinition = new CompiledDefinition(\n+                new KompileOptions(), compiled._1(), compiled._1(), files, kem, null);", "originalCommit": "abe5e902818bc2749aa184ba60edeb16d98341c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE3MTUxNQ==", "url": "https://github.com/kframework/k/pull/1138#discussion_r387171515", "bodyText": "this code should be separated to a method.", "author": "denis-bogdanas", "createdAt": "2020-03-03T17:16:37Z", "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "diffHunk": "@@ -55,6 +62,19 @@ public int run() {\n \n         Tuple2<Definition, Module> compiled = proofDefinitionBuilder\n                 .build(kproveOptions.specFile(files), kproveOptions.defModule, kproveOptions.specModule);\n+\n+        // Saving compiled definition to disk to be usable by other tools (e.g., kast)\n+        CompiledDefinition compiledDefinition = new CompiledDefinition(\n+                new KompileOptions(), compiled._1(), compiled._1(), files, kem, null);\n+        Path proveKompiledDir = files.resolveTemp(\"prove-spec-kompiled\").toPath();\n+        try {\n+            Files.createDirectory(proveKompiledDir);\n+            loader.saveOrDie(proveKompiledDir.resolve(\"compiled.bin\").toFile(), compiledDefinition);\n+        } catch (IOException e) {\n+            kem.registerCriticalWarning(\n+                    \"Could not create prove-spec-kompiled directory. Definition will not be saved.\", e);\n+        }\n+", "originalCommit": "abe5e902818bc2749aa184ba60edeb16d98341c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE3NDI3NA==", "url": "https://github.com/kframework/k/pull/1138#discussion_r387174274", "bodyText": "It will be useful to log the directory, because I expect there will be multiple dirs there with similar names.", "author": "denis-bogdanas", "createdAt": "2020-03-03T17:21:31Z", "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "diffHunk": "@@ -55,6 +62,19 @@ public int run() {\n \n         Tuple2<Definition, Module> compiled = proofDefinitionBuilder\n                 .build(kproveOptions.specFile(files), kproveOptions.defModule, kproveOptions.specModule);\n+\n+        // Saving compiled definition to disk to be usable by other tools (e.g., kast)\n+        CompiledDefinition compiledDefinition = new CompiledDefinition(\n+                new KompileOptions(), compiled._1(), compiled._1(), files, kem, null);\n+        Path proveKompiledDir = files.resolveTemp(\"prove-spec-kompiled\").toPath();\n+        try {\n+            Files.createDirectory(proveKompiledDir);\n+            loader.saveOrDie(proveKompiledDir.resolve(\"compiled.bin\").toFile(), compiledDefinition);\n+        } catch (IOException e) {\n+            kem.registerCriticalWarning(\n+                    \"Could not create prove-spec-kompiled directory. Definition will not be saved.\", e);", "originalCommit": "abe5e902818bc2749aa184ba60edeb16d98341c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE3ODIyOA==", "url": "https://github.com/kframework/k/pull/1138#discussion_r387178228", "bodyText": "if this directory is not writeable it's probably better to raise an error instead of a warning.", "author": "dwightguth", "createdAt": "2020-03-03T17:28:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE3NDI3NA=="}], "type": "inlineReview"}, {"oid": "02939ba4a97e051d8e84a61582fb98c7a8c22583", "url": "https://github.com/kframework/k/commit/02939ba4a97e051d8e84a61582fb98c7a8c22583", "message": "Merge remote-tracking branch 'upstream/master' into issue-1137", "committedDate": "2020-03-05T14:46:48Z", "type": "commit"}, {"oid": "f725aace1b58d4b0b7045abe7974c300b1fbfd47", "url": "https://github.com/kframework/k/commit/f725aace1b58d4b0b7045abe7974c300b1fbfd47", "message": "Merge remote-tracking branch 'upstream/master' into issue-1137", "committedDate": "2020-03-06T14:20:38Z", "type": "commit"}, {"oid": "c6e2790b77f6c189b38a04473d6345ff3d9a54a9", "url": "https://github.com/kframework/k/commit/c6e2790b77f6c189b38a04473d6345ff3d9a54a9", "message": "Addressing reviews", "committedDate": "2020-03-06T14:23:30Z", "type": "forcePushed"}, {"oid": "bc1d83319384aeb6ed546cd017ead15a3bd99456", "url": "https://github.com/kframework/k/commit/bc1d83319384aeb6ed546cd017ead15a3bd99456", "message": "Addressing reviews", "committedDate": "2020-03-06T14:42:32Z", "type": "forcePushed"}, {"oid": "200b5f5d8bcf404b7db154dab4a0872e77619897", "url": "https://github.com/kframework/k/commit/200b5f5d8bcf404b7db154dab4a0872e77619897", "message": "Addressing reviews", "committedDate": "2020-03-06T14:55:15Z", "type": "commit"}, {"oid": "200b5f5d8bcf404b7db154dab4a0872e77619897", "url": "https://github.com/kframework/k/commit/200b5f5d8bcf404b7db154dab4a0872e77619897", "message": "Addressing reviews", "committedDate": "2020-03-06T14:55:15Z", "type": "forcePushed"}, {"oid": "626c83ef4272b97064828660b89e461eb4cb9dfd", "url": "https://github.com/kframework/k/commit/626c83ef4272b97064828660b89e461eb4cb9dfd", "message": "Merge remote-tracking branch 'upstream/master' into issue-1137", "committedDate": "2020-03-09T14:58:53Z", "type": "commit"}, {"oid": "a27120d7e0bf07d1b7a35208635616d4ccf10783", "url": "https://github.com/kframework/k/commit/a27120d7e0bf07d1b7a35208635616d4ccf10783", "message": "Use createDirectories instead of createDirectory", "committedDate": "2020-03-09T15:00:41Z", "type": "commit"}, {"oid": "bc7ebe33a0d0c8c392a6f684741a51e1f3b68678", "url": "https://github.com/kframework/k/commit/bc7ebe33a0d0c8c392a6f684741a51e1f3b68678", "message": "Merge branch 'master' into issue-1137", "committedDate": "2020-06-15T15:38:40Z", "type": "commit"}, {"oid": "2b9fb175929e03ac4b89cab41c424b30832c593a", "url": "https://github.com/kframework/k/commit/2b9fb175929e03ac4b89cab41c424b30832c593a", "message": "Merge remote-tracking branch 'upstream/master' into issue-1137", "committedDate": "2020-06-25T16:14:56Z", "type": "commit"}, {"oid": "4115690a1672735f99c234fcf30e9b1fd618ce37", "url": "https://github.com/kframework/k/commit/4115690a1672735f99c234fcf30e9b1fd618ce37", "message": "Updated test", "committedDate": "2020-06-25T16:46:52Z", "type": "commit"}, {"oid": "3565933af681158b8ca29a189be7f568d78e2ff1", "url": "https://github.com/kframework/k/commit/3565933af681158b8ca29a189be7f568d78e2ff1", "message": "Attempting to remove test", "committedDate": "2020-06-25T17:05:43Z", "type": "commit"}, {"oid": "54f81556bd2a2c96f01c94430ac81a18fa1b111f", "url": "https://github.com/kframework/k/commit/54f81556bd2a2c96f01c94430ac81a18fa1b111f", "message": "Merge branch 'master' into issue-1137", "committedDate": "2020-06-26T05:40:04Z", "type": "commit"}]}