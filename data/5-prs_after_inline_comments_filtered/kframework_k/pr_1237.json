{"pr_number": 1237, "pr_title": "java-backend: support SMTLIB translation for KVar binders", "pr_createdAt": "2020-04-26T06:17:25Z", "pr_url": "https://github.com/kframework/k/pull/1237", "timeline": [{"oid": "3e9a3836193510570bdb6fc368a9c8e700b74e9a", "url": "https://github.com/kframework/k/commit/3e9a3836193510570bdb6fc368a9c8e700b74e9a", "message": "support smtlib forall", "committedDate": "2020-04-26T06:15:01Z", "type": "commit"}, {"oid": "edb4b23f0f6142daaa6a0db54fa5d7fb83da2b80", "url": "https://github.com/kframework/k/commit/edb4b23f0f6142daaa6a0db54fa5d7fb83da2b80", "message": "support more generalized format", "committedDate": "2020-04-26T07:06:21Z", "type": "commit"}, {"oid": "edb4b23f0f6142daaa6a0db54fa5d7fb83da2b80", "url": "https://github.com/kframework/k/commit/edb4b23f0f6142daaa6a0db54fa5d7fb83da2b80", "message": "support more generalized format", "committedDate": "2020-04-26T07:06:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI3MDAxNQ==", "url": "https://github.com/kframework/k/pull/1237#discussion_r415270015", "bodyText": "contains() must be used here", "author": "denis-bogdanas", "createdAt": "2020-04-26T09:56:07Z", "path": "java-backend/src/main/java/org/kframework/backend/java/symbolic/KILtoSMTLib.java", "diffHunk": "@@ -656,6 +676,13 @@ public SMTLibTerm transform(BitVector bitVector) {\n \n     @Override\n     public SMTLibTerm transform(UninterpretedToken uninterpretedToken) {\n+        if (uninterpretedToken.sort() == Sort.KVARIABLE) {\n+            if (binders.search(uninterpretedToken) != -1) {", "originalCommit": "edb4b23f0f6142daaa6a0db54fa5d7fb83da2b80", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUxNTEyMw==", "url": "https://github.com/kframework/k/pull/1237#discussion_r415515123", "bodyText": "fixed", "author": "daejunpark", "createdAt": "2020-04-27T05:12:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI3MDAxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI3MDY3NA==", "url": "https://github.com/kframework/k/pull/1237#discussion_r415270674", "bodyText": "This whole feature is extraordinary error-prone. I'd say a warning must be added here when it is used.", "author": "denis-bogdanas", "createdAt": "2020-04-26T09:59:31Z", "path": "java-backend/src/main/java/org/kframework/backend/java/symbolic/KILtoSMTLib.java", "diffHunk": "@@ -571,10 +587,14 @@ public SMTLibTerm transform(KItem kItem) {\n         if (label.startsWith(\"(\")) {\n             // smtlib expression instead of operator\n             String expression = label;\n+            boolean hasBinder = recordBinders(label, kList);", "originalCommit": "edb4b23f0f6142daaa6a0db54fa5d7fb83da2b80", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUxNTE1Mw==", "url": "https://github.com/kframework/k/pull/1237#discussion_r415515153", "bodyText": "added", "author": "daejunpark", "createdAt": "2020-04-27T05:12:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI3MDY3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTcyMzY4Mg==", "url": "https://github.com/kframework/k/pull/1237#discussion_r415723682", "bodyText": "This is no longer applicable.", "author": "daejunpark", "createdAt": "2020-04-27T11:13:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI3MDY3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI3Mjc2Nw==", "url": "https://github.com/kframework/k/pull/1237#discussion_r415272767", "bodyText": "This variable must be renamed. Like smtlibForallOrExistsBinder ? Long names are better than confusing names.", "author": "denis-bogdanas", "createdAt": "2020-04-26T10:10:49Z", "path": "java-backend/src/main/java/org/kframework/backend/java/symbolic/KILtoSMTLib.java", "diffHunk": "@@ -243,6 +246,7 @@ public static CharSequence translateImplication(\n     private final LinkedHashSet<Variable> variables;\n     private final LinkedHashMap<Term, Variable> termAbstractionMap;\n     private final LinkedHashMap<UninterpretedToken, Integer> tokenEncoding;\n+    private final Stack<Term> binders;", "originalCommit": "edb4b23f0f6142daaa6a0db54fa5d7fb83da2b80", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUxNTE4MQ==", "url": "https://github.com/kframework/k/pull/1237#discussion_r415515181", "bodyText": "done", "author": "daejunpark", "createdAt": "2020-04-27T05:12:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI3Mjc2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTcyNDMzMQ==", "url": "https://github.com/kframework/k/pull/1237#discussion_r415724331", "bodyText": "Now this PR becomes more general, and the name binders is appropriate.", "author": "daejunpark", "createdAt": "2020-04-27T11:14:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI3Mjc2Nw=="}], "type": "inlineReview"}, {"oid": "5360668cd76355b05503d1d3d8fe0b3cbaec0d39", "url": "https://github.com/kframework/k/commit/5360668cd76355b05503d1d3d8fe0b3cbaec0d39", "message": "add warning + refactoring", "committedDate": "2020-04-27T05:11:30Z", "type": "commit"}, {"oid": "a55441593cabce35b8f150fc9dc5155d3267b97d", "url": "https://github.com/kframework/k/commit/a55441593cabce35b8f150fc9dc5155d3267b97d", "message": "add nested quantifiers test", "committedDate": "2020-04-27T05:21:37Z", "type": "commit"}, {"oid": "46f8b9c24eec6106f6fe7b88969e49c7b0fd2a97", "url": "https://github.com/kframework/k/commit/46f8b9c24eec6106f6fe7b88969e49c7b0fd2a97", "message": "more general support for smt translation of binders", "committedDate": "2020-04-27T11:02:51Z", "type": "commit"}, {"oid": "e20eedf737961f3d2e54c80bf3482789643fdafd", "url": "https://github.com/kframework/k/commit/e20eedf737961f3d2e54c80bf3482789643fdafd", "message": "Merge branch 'master' into smtlib-forall", "committedDate": "2020-04-27T21:38:00Z", "type": "commit"}]}