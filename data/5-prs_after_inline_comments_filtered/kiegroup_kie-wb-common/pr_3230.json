{"pr_number": 3230, "pr_title": "DROOLS-5045: [DMN Designer] Marshaller does not support DMN1.2 DecisionTable RuleAnnotation", "pr_createdAt": "2020-03-19T23:29:33Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3230", "timeline": [{"oid": "c604b090ccb18a738c924348d8590512908865ff", "url": "https://github.com/kiegroup/kie-wb-common/commit/c604b090ccb18a738c924348d8590512908865ff", "message": "Fixing tests.", "committedDate": "2020-03-20T22:10:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ4NjU2NA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396486564", "bodyText": "@Bindable, @Definition and @FormDefinition and DomainObject all relate to instances of these classes appearing in the \"Properties Panel\". However since DecisionTableGrid.doAfterSelectionChange(..) and DecisionTableGrid.doAfterHeaderSelectionChange(..) are not calling BaseGrid.fireDomainObjectSelectionEvent(..) both RuleAnnotationClause and RuleAnnotationClauseText can have all these annotations/interfaces removed.\nIF you wanted RuleAnnotationClause to appear in the \"Properties Panel\" you would keep the annotations/interfaces and change DecisionTableGrid.doAfterHeaderSelectionChange(..) to call fireDomainObjectSelectionEvent(..) for the ANNOTATION_CLAUSES section.", "author": "manstis", "createdAt": "2020-03-23T14:21:15Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-api/src/main/java/org/kie/workbench/common/dmn/api/definition/model/RuleAnnotationClause.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.dmn.api.definition.model;\n+\n+import java.util.Set;\n+\n+import org.jboss.errai.common.client.api.annotations.Portable;\n+import org.jboss.errai.databinding.client.api.Bindable;\n+import org.kie.soup.commons.util.Sets;\n+import org.kie.workbench.common.dmn.api.definition.HasName;\n+import org.kie.workbench.common.dmn.api.property.dmn.Name;\n+import org.kie.workbench.common.dmn.api.resource.i18n.DMNAPIConstants;\n+import org.kie.workbench.common.forms.adf.definitions.annotations.FieldParam;\n+import org.kie.workbench.common.forms.adf.definitions.annotations.FormDefinition;\n+import org.kie.workbench.common.forms.adf.definitions.annotations.FormField;\n+import org.kie.workbench.common.forms.adf.definitions.annotations.i18n.I18nSettings;\n+import org.kie.workbench.common.forms.adf.definitions.settings.FieldPolicy;\n+import org.kie.workbench.common.stunner.core.definition.annotation.Definition;\n+import org.kie.workbench.common.stunner.core.definition.annotation.PropertySet;\n+import org.kie.workbench.common.stunner.core.definition.annotation.definition.Category;\n+import org.kie.workbench.common.stunner.core.definition.annotation.definition.Labels;\n+import org.kie.workbench.common.stunner.core.domainobject.DomainObject;\n+import org.kie.workbench.common.stunner.core.factory.graph.NodeFactory;\n+\n+import static org.kie.workbench.common.forms.adf.engine.shared.formGeneration.processing.fields.fieldInitializers.nestedForms.AbstractEmbeddedFormsInitializer.COLLAPSIBLE_CONTAINER;\n+import static org.kie.workbench.common.forms.adf.engine.shared.formGeneration.processing.fields.fieldInitializers.nestedForms.AbstractEmbeddedFormsInitializer.FIELD_CONTAINER_PARAM;\n+\n+@Portable\n+@Bindable", "originalCommit": "11221c5eb9c9fe1e949ca6826ef0b760f46ba599", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ4OTM3Mw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396489373", "bodyText": "This only adds a RuleAnnotationClause IF at least one existing row has a non-empty description.\nWhat happens if a DMN model is imported without any descriptions? We'd have no RuleAnnotationClause added and none could be added in the UI (as we need at least one RuleAnnotationClause column so that the context menu to add/remove others can be shown). I think we need to create a RuleAnnotationClause IF none exist; and copy the description to it (even if empty).", "author": "manstis", "createdAt": "2020-03-23T14:25:01Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-backend/src/main/java/org/kie/workbench/common/dmn/backend/definition/v1_1/DecisionTablePropertyConverter.java", "diffHunk": "@@ -39,6 +41,21 @@ public static DecisionTable wbFromDMN(final org.kie.dmn.model.api.DecisionTable\n         result.setDescription(description);\n         result.setTypeRef(typeRef);\n \n+        if (dmn.getRule().stream().anyMatch(r -> !StringUtils.isEmpty(r.getDescription()))", "originalCommit": "11221c5eb9c9fe1e949ca6826ef0b760f46ba599", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEzOTA5Mg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r397139092", "bodyText": "You're right, I changed the 'DecisionTableEditorDefinitionEnricher' to handle new DecisionTable, but it doesn't handle imported DMN files without description. I'm making all proposed changes including the inline text editor. Thank you!", "author": "danielzhe", "createdAt": "2020-03-24T13:10:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ4OTM3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU3MzUzOA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396573538", "bodyText": "Can this be package protected? It's only used by this class and the test.", "author": "manstis", "createdAt": "2020-03-23T16:14:12Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/commands/expressions/types/dtable/AddRuleAnnotationClauseCommand.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.dmn.client.commands.expressions.types.dtable;\n+\n+import java.util.Optional;\n+import java.util.function.Supplier;\n+\n+import org.kie.workbench.common.dmn.api.definition.model.DecisionTable;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClause;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClauseText;\n+import org.kie.workbench.common.dmn.client.commands.VetoExecutionCommand;\n+import org.kie.workbench.common.dmn.client.commands.VetoUndoCommand;\n+import org.kie.workbench.common.dmn.client.commands.util.CommandUtils;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableDefaultValueUtilities;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapper;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapperHelper;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.RuleAnnotationClauseColumn;\n+import org.kie.workbench.common.stunner.core.client.canvas.AbstractCanvasHandler;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasCommand;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasGraphCommand;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasCommandResultBuilder;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasViolation;\n+import org.kie.workbench.common.stunner.core.command.Command;\n+import org.kie.workbench.common.stunner.core.command.CommandResult;\n+import org.kie.workbench.common.stunner.core.graph.command.GraphCommandExecutionContext;\n+import org.kie.workbench.common.stunner.core.graph.command.GraphCommandResultBuilder;\n+import org.kie.workbench.common.stunner.core.graph.command.impl.AbstractGraphCommand;\n+import org.kie.workbench.common.stunner.core.rule.RuleViolation;\n+import org.kie.workbench.common.stunner.core.util.StringUtils;\n+import org.uberfire.ext.wires.core.grids.client.model.GridData;\n+\n+public class AddRuleAnnotationClauseCommand extends AbstractCanvasGraphCommand implements VetoExecutionCommand,\n+                                                                                          VetoUndoCommand {\n+\n+    private final DecisionTable decisionTable;\n+    private final RuleAnnotationClause ruleAnnotationClause;\n+    private final GridData uiModel;\n+    private final Supplier<RuleAnnotationClauseColumn> uiModelColumnSupplier;\n+    private final int uiColumnIndex;\n+    private final DecisionTableUIModelMapper uiModelMapper;\n+    private final org.uberfire.mvp.Command executeCanvasOperation;\n+    private final org.uberfire.mvp.Command undoCanvasOperation;\n+    private String name;\n+\n+    private Optional<RuleAnnotationClauseColumn> uiModelColumn = Optional.empty();\n+\n+    public AddRuleAnnotationClauseCommand(final DecisionTable decisionTable,\n+                                          final RuleAnnotationClause ruleAnnotationClause,\n+                                          final GridData uiModel,\n+                                          final Supplier<RuleAnnotationClauseColumn> uiModelColumnSupplier,\n+                                          final int uiColumnIndex,\n+                                          final DecisionTableUIModelMapper uiModelMapper,\n+                                          final org.uberfire.mvp.Command executeCanvasOperation,\n+                                          final org.uberfire.mvp.Command undoCanvasOperation) {\n+        this.decisionTable = decisionTable;\n+        this.ruleAnnotationClause = ruleAnnotationClause;\n+        this.uiModel = uiModel;\n+        this.uiModelColumnSupplier = uiModelColumnSupplier;\n+        this.uiColumnIndex = uiColumnIndex;\n+        this.uiModelMapper = uiModelMapper;\n+        this.executeCanvasOperation = executeCanvasOperation;\n+        this.undoCanvasOperation = undoCanvasOperation;\n+    }\n+\n+    public Optional<RuleAnnotationClauseColumn> getUiModelColumn() {", "originalCommit": "11221c5eb9c9fe1e949ca6826ef0b760f46ba599", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU3NjE5NA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396576194", "bodyText": "In fact why do we need it at all!?\nIf it's only use is this class or the test, the value is know by the test already as it constructs the instance.", "author": "manstis", "createdAt": "2020-03-23T16:17:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU3MzUzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzUxMTQ2MQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r397511461", "bodyText": "We need to test this, because uiModelColumn is only known after this.", "author": "danielzhe", "createdAt": "2020-03-24T22:57:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU3MzUzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU3NDE3Mg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396574172", "bodyText": "Can this be private (or at least package protected)? It's only used by this class.", "author": "manstis", "createdAt": "2020-03-23T16:15:00Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/commands/expressions/types/dtable/AddRuleAnnotationClauseCommand.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.dmn.client.commands.expressions.types.dtable;\n+\n+import java.util.Optional;\n+import java.util.function.Supplier;\n+\n+import org.kie.workbench.common.dmn.api.definition.model.DecisionTable;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClause;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClauseText;\n+import org.kie.workbench.common.dmn.client.commands.VetoExecutionCommand;\n+import org.kie.workbench.common.dmn.client.commands.VetoUndoCommand;\n+import org.kie.workbench.common.dmn.client.commands.util.CommandUtils;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableDefaultValueUtilities;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapper;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapperHelper;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.RuleAnnotationClauseColumn;\n+import org.kie.workbench.common.stunner.core.client.canvas.AbstractCanvasHandler;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasCommand;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasGraphCommand;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasCommandResultBuilder;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasViolation;\n+import org.kie.workbench.common.stunner.core.command.Command;\n+import org.kie.workbench.common.stunner.core.command.CommandResult;\n+import org.kie.workbench.common.stunner.core.graph.command.GraphCommandExecutionContext;\n+import org.kie.workbench.common.stunner.core.graph.command.GraphCommandResultBuilder;\n+import org.kie.workbench.common.stunner.core.graph.command.impl.AbstractGraphCommand;\n+import org.kie.workbench.common.stunner.core.rule.RuleViolation;\n+import org.kie.workbench.common.stunner.core.util.StringUtils;\n+import org.uberfire.ext.wires.core.grids.client.model.GridData;\n+\n+public class AddRuleAnnotationClauseCommand extends AbstractCanvasGraphCommand implements VetoExecutionCommand,\n+                                                                                          VetoUndoCommand {\n+\n+    private final DecisionTable decisionTable;\n+    private final RuleAnnotationClause ruleAnnotationClause;\n+    private final GridData uiModel;\n+    private final Supplier<RuleAnnotationClauseColumn> uiModelColumnSupplier;\n+    private final int uiColumnIndex;\n+    private final DecisionTableUIModelMapper uiModelMapper;\n+    private final org.uberfire.mvp.Command executeCanvasOperation;\n+    private final org.uberfire.mvp.Command undoCanvasOperation;\n+    private String name;\n+\n+    private Optional<RuleAnnotationClauseColumn> uiModelColumn = Optional.empty();\n+\n+    public AddRuleAnnotationClauseCommand(final DecisionTable decisionTable,\n+                                          final RuleAnnotationClause ruleAnnotationClause,\n+                                          final GridData uiModel,\n+                                          final Supplier<RuleAnnotationClauseColumn> uiModelColumnSupplier,\n+                                          final int uiColumnIndex,\n+                                          final DecisionTableUIModelMapper uiModelMapper,\n+                                          final org.uberfire.mvp.Command executeCanvasOperation,\n+                                          final org.uberfire.mvp.Command undoCanvasOperation) {\n+        this.decisionTable = decisionTable;\n+        this.ruleAnnotationClause = ruleAnnotationClause;\n+        this.uiModel = uiModel;\n+        this.uiModelColumnSupplier = uiModelColumnSupplier;\n+        this.uiColumnIndex = uiColumnIndex;\n+        this.uiModelMapper = uiModelMapper;\n+        this.executeCanvasOperation = executeCanvasOperation;\n+        this.undoCanvasOperation = undoCanvasOperation;\n+    }\n+\n+    public Optional<RuleAnnotationClauseColumn> getUiModelColumn() {\n+        return uiModelColumn;\n+    }\n+\n+    public String getName() {", "originalCommit": "11221c5eb9c9fe1e949ca6826ef0b760f46ba599", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU4NTA4OA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396585088", "bodyText": "IIRC there's good reason the other add commands derive the name in the constructor and not at execution time. I also notice that add, add, rename, rename, undo, undo, undo, redo, redo, redo does not appear to work properly when I tried setting an expression to a Decision Table, add Annotation, add Annotation etc in the UI.", "author": "manstis", "createdAt": "2020-03-23T16:29:27Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/commands/expressions/types/dtable/AddRuleAnnotationClauseCommand.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.dmn.client.commands.expressions.types.dtable;\n+\n+import java.util.Optional;\n+import java.util.function.Supplier;\n+\n+import org.kie.workbench.common.dmn.api.definition.model.DecisionTable;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClause;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClauseText;\n+import org.kie.workbench.common.dmn.client.commands.VetoExecutionCommand;\n+import org.kie.workbench.common.dmn.client.commands.VetoUndoCommand;\n+import org.kie.workbench.common.dmn.client.commands.util.CommandUtils;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableDefaultValueUtilities;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapper;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapperHelper;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.RuleAnnotationClauseColumn;\n+import org.kie.workbench.common.stunner.core.client.canvas.AbstractCanvasHandler;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasCommand;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasGraphCommand;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasCommandResultBuilder;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasViolation;\n+import org.kie.workbench.common.stunner.core.command.Command;\n+import org.kie.workbench.common.stunner.core.command.CommandResult;\n+import org.kie.workbench.common.stunner.core.graph.command.GraphCommandExecutionContext;\n+import org.kie.workbench.common.stunner.core.graph.command.GraphCommandResultBuilder;\n+import org.kie.workbench.common.stunner.core.graph.command.impl.AbstractGraphCommand;\n+import org.kie.workbench.common.stunner.core.rule.RuleViolation;\n+import org.kie.workbench.common.stunner.core.util.StringUtils;\n+import org.uberfire.ext.wires.core.grids.client.model.GridData;\n+\n+public class AddRuleAnnotationClauseCommand extends AbstractCanvasGraphCommand implements VetoExecutionCommand,\n+                                                                                          VetoUndoCommand {\n+\n+    private final DecisionTable decisionTable;\n+    private final RuleAnnotationClause ruleAnnotationClause;\n+    private final GridData uiModel;\n+    private final Supplier<RuleAnnotationClauseColumn> uiModelColumnSupplier;\n+    private final int uiColumnIndex;\n+    private final DecisionTableUIModelMapper uiModelMapper;\n+    private final org.uberfire.mvp.Command executeCanvasOperation;\n+    private final org.uberfire.mvp.Command undoCanvasOperation;\n+    private String name;\n+\n+    private Optional<RuleAnnotationClauseColumn> uiModelColumn = Optional.empty();\n+\n+    public AddRuleAnnotationClauseCommand(final DecisionTable decisionTable,\n+                                          final RuleAnnotationClause ruleAnnotationClause,\n+                                          final GridData uiModel,\n+                                          final Supplier<RuleAnnotationClauseColumn> uiModelColumnSupplier,\n+                                          final int uiColumnIndex,\n+                                          final DecisionTableUIModelMapper uiModelMapper,\n+                                          final org.uberfire.mvp.Command executeCanvasOperation,\n+                                          final org.uberfire.mvp.Command undoCanvasOperation) {\n+        this.decisionTable = decisionTable;\n+        this.ruleAnnotationClause = ruleAnnotationClause;\n+        this.uiModel = uiModel;\n+        this.uiModelColumnSupplier = uiModelColumnSupplier;\n+        this.uiColumnIndex = uiColumnIndex;\n+        this.uiModelMapper = uiModelMapper;\n+        this.executeCanvasOperation = executeCanvasOperation;\n+        this.undoCanvasOperation = undoCanvasOperation;\n+    }\n+\n+    public Optional<RuleAnnotationClauseColumn> getUiModelColumn() {\n+        return uiModelColumn;\n+    }\n+\n+    public String getName() {\n+        if (StringUtils.isEmpty(name)) {", "originalCommit": "11221c5eb9c9fe1e949ca6826ef0b760f46ba599", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU5MjI1OA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396592258", "bodyText": "Being picky, it'd be nice to have these 2 new methods at the end of the class so that the method order is input related methods, output related methods and annotations related methods.", "author": "manstis", "createdAt": "2020-03-23T16:39:24Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/editors/expressions/types/dtable/DecisionTableDefaultValueUtilities.java", "diffHunk": "@@ -54,6 +59,21 @@ private static int getMaxUnusedInputClauseIndex(final DecisionTable dtable) {\n         return maxIndex + 1;\n     }\n \n+    public static String getNewRuleAnnotationClauseName(final DecisionTable decisionTable) {", "originalCommit": "11221c5eb9c9fe1e949ca6826ef0b760f46ba599", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU5MjU4OA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396592588", "bodyText": "I still wonder whether to have \"in cell\" editing of names vs popup. WDYT? Did you ask UX?", "author": "manstis", "createdAt": "2020-03-23T16:39:52Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/editors/expressions/types/dtable/DecisionTableEditorDefinition.java", "diffHunk": "@@ -73,7 +74,8 @@ public DecisionTableEditorDefinition(final DefinitionUtils definitionUtils,\n                                          final TranslationService translationService,\n                                          final HitPolicyPopoverView.Presenter hitPolicyEditor,\n                                          final ManagedInstance<ValueAndDataTypePopoverView.Presenter> headerEditors,\n-                                         final DecisionTableEditorDefinitionEnricher enricher) {\n+                                         final DecisionTableEditorDefinitionEnricher enricher,\n+                                         final ManagedInstance<ValuePopoverView.Presenter> valueEditors) {", "originalCommit": "11221c5eb9c9fe1e949ca6826ef0b760f46ba599", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjYyMjI0Mg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396622242", "bodyText": "Yes, I think you have a good point. I commented in the chat right now to see what UX thinks (I'm replying here too for the case other peoples reads the PR don't thinks that I'm ignoring your suggestion)", "author": "danielzhe", "createdAt": "2020-03-23T17:21:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU5MjU4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU5NDQ1Mg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396594452", "bodyText": "Please delete commented block.", "author": "manstis", "createdAt": "2020-03-23T16:42:22Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/editors/expressions/types/dtable/DecisionTableUIModelMapperHelper.java", "diffHunk": "@@ -84,4 +83,32 @@ public static int getOutputEntryIndex(final DecisionTable dtable,\n         }\n         return _columnIndex;\n     }\n+\n+    public static int getAnnotationEntryIndex(final DecisionTable dtable,\n+                                              final int columnIndex) {\n+\n+        final int inputClauseColumnCount = dtable.getInput().size();\n+        final int outputClauseColumnCount = dtable.getOutput().size();\n+        final int annotationClauseColumnCount = dtable.getAnnotations().size();\n+\n+        int _columnIndex = columnIndex;\n+        if ((_columnIndex = _columnIndex - ROW_INDEX_COLUMN_COUNT) < 0) {\n+            throw new IllegalArgumentException(\"columnIndex referenced 'Row index' column. Should be a valid AnnotationEntry column.\");\n+        }\n+        if ((_columnIndex = _columnIndex - inputClauseColumnCount) < 0) {\n+            throw new IllegalArgumentException(\"columnIndex referenced an InputEntry column. Should be a valid AnnotationEntry column.\");\n+        }\n+        if ((_columnIndex = _columnIndex - outputClauseColumnCount) < 0) {\n+            throw new IllegalArgumentException(\"columnIndex referenced an OutputEntry column. Should be a valid AnnotationEntry column.\");\n+        }\n+        if (_columnIndex > annotationClauseColumnCount - 1) {\n+            throw new IllegalArgumentException(\"columnIndex did not reference a valid AnnotationEntry column.\");\n+        }\n+\n+        return _columnIndex;\n+//        final int annotationIndex = columnIndex - inputClauseColumnCount - outputClauseColumnCount - 1;", "originalCommit": "11221c5eb9c9fe1e949ca6826ef0b760f46ba599", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjYwMTg5Ng==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r396601896", "bodyText": "Not really a le here.. just a copy and paste artifact!", "author": "manstis", "createdAt": "2020-03-23T16:52:37Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/commands/expressions/types/dtable/AddRuleAnnotationClauseCommand.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.dmn.client.commands.expressions.types.dtable;\n+\n+import java.util.Optional;\n+import java.util.function.Supplier;\n+\n+import org.kie.workbench.common.dmn.api.definition.model.DecisionTable;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClause;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClauseText;\n+import org.kie.workbench.common.dmn.client.commands.VetoExecutionCommand;\n+import org.kie.workbench.common.dmn.client.commands.VetoUndoCommand;\n+import org.kie.workbench.common.dmn.client.commands.util.CommandUtils;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableDefaultValueUtilities;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapper;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapperHelper;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.RuleAnnotationClauseColumn;\n+import org.kie.workbench.common.stunner.core.client.canvas.AbstractCanvasHandler;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasCommand;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasGraphCommand;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasCommandResultBuilder;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasViolation;\n+import org.kie.workbench.common.stunner.core.command.Command;\n+import org.kie.workbench.common.stunner.core.command.CommandResult;\n+import org.kie.workbench.common.stunner.core.graph.command.GraphCommandExecutionContext;\n+import org.kie.workbench.common.stunner.core.graph.command.GraphCommandResultBuilder;\n+import org.kie.workbench.common.stunner.core.graph.command.impl.AbstractGraphCommand;\n+import org.kie.workbench.common.stunner.core.rule.RuleViolation;\n+import org.kie.workbench.common.stunner.core.util.StringUtils;\n+import org.uberfire.ext.wires.core.grids.client.model.GridData;\n+\n+public class AddRuleAnnotationClauseCommand extends AbstractCanvasGraphCommand implements VetoExecutionCommand,\n+                                                                                          VetoUndoCommand {\n+\n+    private final DecisionTable decisionTable;\n+    private final RuleAnnotationClause ruleAnnotationClause;\n+    private final GridData uiModel;\n+    private final Supplier<RuleAnnotationClauseColumn> uiModelColumnSupplier;\n+    private final int uiColumnIndex;\n+    private final DecisionTableUIModelMapper uiModelMapper;\n+    private final org.uberfire.mvp.Command executeCanvasOperation;\n+    private final org.uberfire.mvp.Command undoCanvasOperation;\n+    private String name;\n+\n+    private Optional<RuleAnnotationClauseColumn> uiModelColumn = Optional.empty();\n+\n+    public AddRuleAnnotationClauseCommand(final DecisionTable decisionTable,\n+                                          final RuleAnnotationClause ruleAnnotationClause,\n+                                          final GridData uiModel,\n+                                          final Supplier<RuleAnnotationClauseColumn> uiModelColumnSupplier,\n+                                          final int uiColumnIndex,\n+                                          final DecisionTableUIModelMapper uiModelMapper,\n+                                          final org.uberfire.mvp.Command executeCanvasOperation,\n+                                          final org.uberfire.mvp.Command undoCanvasOperation) {\n+        this.decisionTable = decisionTable;\n+        this.ruleAnnotationClause = ruleAnnotationClause;\n+        this.uiModel = uiModel;\n+        this.uiModelColumnSupplier = uiModelColumnSupplier;\n+        this.uiColumnIndex = uiColumnIndex;\n+        this.uiModelMapper = uiModelMapper;\n+        this.executeCanvasOperation = executeCanvasOperation;\n+        this.undoCanvasOperation = undoCanvasOperation;\n+    }\n+\n+    public Optional<RuleAnnotationClauseColumn> getUiModelColumn() {\n+        return uiModelColumn;\n+    }\n+\n+    public String getName() {\n+        if (StringUtils.isEmpty(name)) {\n+            this.name = getNewRuleAnnotationClauseName();\n+        }\n+        return this.name;\n+    }\n+\n+    String getNewRuleAnnotationClauseName() {\n+        return DecisionTableDefaultValueUtilities.getNewRuleAnnotationClauseName(decisionTable);\n+    }\n+\n+    @Override\n+    protected Command<GraphCommandExecutionContext, RuleViolation> newGraphCommand(final AbstractCanvasHandler context) {\n+        return new AbstractGraphCommand() {\n+            @Override\n+            protected CommandResult<RuleViolation> check(final GraphCommandExecutionContext context) {\n+                return GraphCommandResultBuilder.SUCCESS;\n+            }\n+\n+            @Override\n+            public CommandResult<RuleViolation> execute(final GraphCommandExecutionContext context) {\n+                decisionTable.getComponentWidths().add(uiColumnIndex, null);\n+\n+                final int clauseIndex = getClauseIndex();\n+                decisionTable.getAnnotations().add(clauseIndex, ruleAnnotationClause);\n+                ruleAnnotationClause.getName().setValue(getName());\n+\n+                decisionTable.getRule().forEach(rule -> {\n+                    final RuleAnnotationClauseText le = new RuleAnnotationClauseText();", "originalCommit": "11221c5eb9c9fe1e949ca6826ef0b760f46ba599", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "url": "https://github.com/kiegroup/kie-wb-common/commit/dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "message": "Fixes", "committedDate": "2020-03-24T23:38:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODEyOTExOA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r398129118", "bodyText": "STATIC_COLUMNS should now be 1 (it used to be Row Number and Description columns, now it is only Row Number). Sorry, I think I must have missed this last time.", "author": "manstis", "createdAt": "2020-03-25T19:54:33Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-api/src/main/java/org/kie/workbench/common/dmn/api/definition/model/DecisionTable.java", "diffHunk": "@@ -150,7 +158,7 @@ public void setOutputLabel(final String value) {\n \n     @Override\n     public int getRequiredComponentWidthCount() {\n-        return getInput().size() + getOutput().size() + STATIC_COLUMNS;\n+        return getInput().size() + getOutput().size() + getAnnotations().size() + STATIC_COLUMNS;", "originalCommit": "dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODEzNzI1OA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r398137258", "bodyText": "Is this still needed?", "author": "manstis", "createdAt": "2020-03-25T20:09:28Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/resources/i18n/DMNEditorConstants.java", "diffHunk": "@@ -271,6 +289,9 @@\n     @TranslationKey(defaultValue = \"\")\n     public static final String NameAndDataTypePopover_DataTypeLabel = \"NameAndDataTypePopover.DataTypeLabel\";\n \n+    @TranslationKey(defaultValue = \"\")\n+    public static final String ValuePopover_ValueLabel = \"ValuePopover.ValueLabel\";", "originalCommit": "dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODEzNzkzMQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r398137931", "bodyText": "Is this still needed?", "author": "manstis", "createdAt": "2020-03-25T20:10:46Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/resources/i18n/DMNEditorConstants.java", "diffHunk": "@@ -172,6 +172,9 @@\n     @TranslationKey(defaultValue = \"\")\n     public static final String FunctionEditor_SelectFunctionKind = \"FunctionEditor.SelectFunctionKind\";\n \n+    @TranslationKey(defaultValue = \"\")\n+    public static final String DecisionTableEditor_SelectRuleAnnotationName = \"DecisionTableEditor.SelectRuleAnnotationName\";", "originalCommit": "dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODEzODE1Nw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r398138157", "bodyText": "I don't think this is needed either.", "author": "manstis", "createdAt": "2020-03-25T20:11:13Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/resources/i18n/DMNEditorConstants.java", "diffHunk": "@@ -172,6 +172,9 @@\n     @TranslationKey(defaultValue = \"\")\n     public static final String FunctionEditor_SelectFunctionKind = \"FunctionEditor.SelectFunctionKind\";\n \n+    @TranslationKey(defaultValue = \"\")\n+    public static final String DecisionTableEditor_SelectRuleAnnotationName = \"DecisionTableEditor.SelectRuleAnnotationName\";\n+\n     @TranslationKey(defaultValue = \"\")\n     public static final String DecisionTableEditor_DescriptionColumnHeader = \"DecisionTableEditor.DescriptionColumnHeader\";", "originalCommit": "dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE0MjE3NQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r398142175", "bodyText": "You can probably remove all the form type stuff from this class too (like you did for RuleAnnotationClause).\nYou don't have support for selecting the annotation cells in DecisionTableGrid and hence their properties can never be shown in the Properties Panel and hence all the form binding stuff is not necessary.\nSee here where I give more detail.", "author": "manstis", "createdAt": "2020-03-25T20:18:25Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-api/src/main/java/org/kie/workbench/common/dmn/api/definition/model/RuleAnnotationClauseText.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.dmn.api.definition.model;\n+\n+import java.util.Set;\n+\n+import org.jboss.errai.common.client.api.annotations.Portable;\n+import org.jboss.errai.databinding.client.api.Bindable;\n+import org.kie.soup.commons.util.Sets;\n+import org.kie.workbench.common.dmn.api.definition.HasText;\n+import org.kie.workbench.common.dmn.api.property.dmn.Text;\n+import org.kie.workbench.common.forms.adf.definitions.annotations.FieldParam;\n+import org.kie.workbench.common.forms.adf.definitions.annotations.FormDefinition;\n+import org.kie.workbench.common.forms.adf.definitions.annotations.i18n.I18nSettings;\n+import org.kie.workbench.common.forms.adf.definitions.settings.FieldPolicy;\n+import org.kie.workbench.common.stunner.core.definition.annotation.Definition;\n+import org.kie.workbench.common.stunner.core.definition.annotation.Property;\n+import org.kie.workbench.common.stunner.core.definition.annotation.definition.Category;\n+import org.kie.workbench.common.stunner.core.definition.annotation.definition.Labels;\n+import org.kie.workbench.common.stunner.core.factory.graph.NodeFactory;\n+\n+import static org.kie.workbench.common.forms.adf.engine.shared.formGeneration.processing.fields.fieldInitializers.nestedForms.AbstractEmbeddedFormsInitializer.COLLAPSIBLE_CONTAINER;\n+import static org.kie.workbench.common.forms.adf.engine.shared.formGeneration.processing.fields.fieldInitializers.nestedForms.AbstractEmbeddedFormsInitializer.FIELD_CONTAINER_PARAM;\n+\n+@Portable\n+@Bindable\n+@Definition(graphFactory = NodeFactory.class, nameField = \"text\")\n+@FormDefinition(policy = FieldPolicy.ONLY_MARKED,", "originalCommit": "dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM3NDIxNQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r398374215", "bodyText": "can be simplified Objects.equals(annotationEntry, that.annotationEntry)", "author": "jomarko", "createdAt": "2020-03-26T07:54:14Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-api/src/main/java/org/kie/workbench/common/dmn/api/definition/model/DecisionRule.java", "diffHunk": "@@ -89,6 +97,9 @@ public boolean equals(final Object o) {\n         if (inputEntry != null ? !inputEntry.equals(that.inputEntry) : that.inputEntry != null) {\n             return false;\n         }\n+        if (annotationEntry != null ? !annotationEntry.equals(that.annotationEntry) : that.annotationEntry != null) {", "originalCommit": "dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4Mzg5MA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r399383890", "bodyText": "I'm trying to follow the pattern used in the equals method, for other values. I agree with that simplification, but should I ignore the others right above the line I wrote? Or should I change the others?", "author": "danielzhe", "createdAt": "2020-03-27T16:20:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM3NDIxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM3NDU3OQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r398374579", "bodyText": "Objects.equals ?", "author": "jomarko", "createdAt": "2020-03-26T07:55:04Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-api/src/main/java/org/kie/workbench/common/dmn/api/definition/model/DecisionTable.java", "diffHunk": "@@ -185,6 +193,9 @@ public boolean equals(final Object o) {\n         if (rule != null ? !rule.equals(that.rule) : that.rule != null) {\n             return false;\n         }\n+        if (annotations != null ? !annotations.equals(that.annotations) : that.annotations != null) {", "originalCommit": "dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM3NjAzMQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r398376031", "bodyText": "Is this import used? Would be nice to not mix both stunner core Command and uberfire mvp.", "author": "jomarko", "createdAt": "2020-03-26T07:58:02Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/commands/expressions/types/dtable/DeleteRuleAnnotationClauseCommand.java", "diffHunk": "@@ -0,0 +1,196 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.dmn.client.commands.expressions.types.dtable;\n+\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.IntStream;\n+\n+import org.kie.workbench.common.dmn.api.definition.model.DecisionTable;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClause;\n+import org.kie.workbench.common.dmn.api.definition.model.RuleAnnotationClauseText;\n+import org.kie.workbench.common.dmn.client.commands.VetoExecutionCommand;\n+import org.kie.workbench.common.dmn.client.commands.VetoUndoCommand;\n+import org.kie.workbench.common.dmn.client.commands.util.CommandUtils;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapper;\n+import org.kie.workbench.common.dmn.client.editors.expressions.types.dtable.DecisionTableUIModelMapperHelper;\n+import org.kie.workbench.common.stunner.core.client.canvas.AbstractCanvasHandler;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasCommand;\n+import org.kie.workbench.common.stunner.core.client.canvas.command.AbstractCanvasGraphCommand;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasCommandResultBuilder;\n+import org.kie.workbench.common.stunner.core.client.command.CanvasViolation;\n+import org.kie.workbench.common.stunner.core.command.Command;", "originalCommit": "dc3836d7c358ac60b1372fa4db4c3738d0bf460d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4NTMwNQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3230#discussion_r399385305", "bodyText": "Yes, it is used. Sorry, I don't get this comment. What should I change?", "author": "danielzhe", "createdAt": "2020-03-27T16:22:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM3NjAzMQ=="}], "type": "inlineReview"}, {"oid": "ba52ff6c2b6e79afe534e24793a74e14272d97f1", "url": "https://github.com/kiegroup/kie-wb-common/commit/ba52ff6c2b6e79afe534e24793a74e14272d97f1", "message": "Fixes", "committedDate": "2020-03-27T16:23:15Z", "type": "forcePushed"}, {"oid": "419092c21fbe57411a05fd825e1f6affc544385c", "url": "https://github.com/kiegroup/kie-wb-common/commit/419092c21fbe57411a05fd825e1f6affc544385c", "message": "Fix issue comment #2", "committedDate": "2020-03-30T21:07:14Z", "type": "forcePushed"}, {"oid": "a1accd2925fdf04928a51723a67dea0ba3aa0fca", "url": "https://github.com/kiegroup/kie-wb-common/commit/a1accd2925fdf04928a51723a67dea0ba3aa0fca", "message": "fixes", "committedDate": "2020-04-01T13:22:57Z", "type": "forcePushed"}, {"oid": "48520a1bd1446d439ec237c5a8a1ca29ef547b45", "url": "https://github.com/kiegroup/kie-wb-common/commit/48520a1bd1446d439ec237c5a8a1ca29ef547b45", "message": "DROOLS-5045: [DMN Designer] Marshaller does not support DMN1.2 DecisionTable RuleAnnotation", "committedDate": "2020-04-03T18:10:16Z", "type": "commit"}, {"oid": "6ea0589365dcc162637c28ae7a71c14f8017868e", "url": "https://github.com/kiegroup/kie-wb-common/commit/6ea0589365dcc162637c28ae7a71c14f8017868e", "message": "Fixing tests.", "committedDate": "2020-04-03T18:10:16Z", "type": "commit"}, {"oid": "404f8a8b6a4c513241f249a5038ff1bdcfd55255", "url": "https://github.com/kiegroup/kie-wb-common/commit/404f8a8b6a4c513241f249a5038ff1bdcfd55255", "message": "Fix for moving column.", "committedDate": "2020-04-03T18:10:17Z", "type": "commit"}, {"oid": "a15845c050940f6517036b1ba686ded7f004d297", "url": "https://github.com/kiegroup/kie-wb-common/commit/a15845c050940f6517036b1ba686ded7f004d297", "message": "Fixes", "committedDate": "2020-04-03T18:10:17Z", "type": "commit"}, {"oid": "de4a95d2b60256098e00c4dd03965a9ec324b1b7", "url": "https://github.com/kiegroup/kie-wb-common/commit/de4a95d2b60256098e00c4dd03965a9ec324b1b7", "message": "Fixes", "committedDate": "2020-04-03T18:10:17Z", "type": "commit"}, {"oid": "2e36fb2dd648db270c23c3964d3e1a8de5131563", "url": "https://github.com/kiegroup/kie-wb-common/commit/2e36fb2dd648db270c23c3964d3e1a8de5131563", "message": "Columns are not merged anymore", "committedDate": "2020-04-03T18:10:18Z", "type": "commit"}, {"oid": "d8e8faba1cebc188a78457ebdd035680db6cfa85", "url": "https://github.com/kiegroup/kie-wb-common/commit/d8e8faba1cebc188a78457ebdd035680db6cfa85", "message": "Fix issue comment #2", "committedDate": "2020-04-03T18:10:18Z", "type": "commit"}, {"oid": "3165d644fb76d26e4d4a233ba183ce84ad53b613", "url": "https://github.com/kiegroup/kie-wb-common/commit/3165d644fb76d26e4d4a233ba183ce84ad53b613", "message": "fixes", "committedDate": "2020-04-03T18:10:18Z", "type": "commit"}, {"oid": "7e48b9a0308cbfabd79e5d055582647aa0738bb3", "url": "https://github.com/kiegroup/kie-wb-common/commit/7e48b9a0308cbfabd79e5d055582647aa0738bb3", "message": "Fix issue moving columns with the same name.", "committedDate": "2020-04-03T18:10:18Z", "type": "commit"}, {"oid": "e501a65ac069d7fd071e14bfdfdeb06328d89657", "url": "https://github.com/kiegroup/kie-wb-common/commit/e501a65ac069d7fd071e14bfdfdeb06328d89657", "message": "Support for Kogito.", "committedDate": "2020-04-03T23:35:50Z", "type": "commit"}, {"oid": "e501a65ac069d7fd071e14bfdfdeb06328d89657", "url": "https://github.com/kiegroup/kie-wb-common/commit/e501a65ac069d7fd071e14bfdfdeb06328d89657", "message": "Support for Kogito.", "committedDate": "2020-04-03T23:35:50Z", "type": "forcePushed"}]}