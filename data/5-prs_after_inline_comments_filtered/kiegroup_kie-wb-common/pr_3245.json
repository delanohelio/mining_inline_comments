{"pr_number": 3245, "pr_title": "KOGITO-1426: Re-enable Resource Content API", "pr_createdAt": "2020-03-25T17:10:21Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3245", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM5ODQ4NA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3245#discussion_r398398484", "bodyText": "File.separator ? What about windows? Corner case but asking to be sure.", "author": "domhanak", "createdAt": "2020-03-26T08:41:08Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-sets/kie-wb-common-stunner-bpmn/kie-wb-common-stunner-bpmn-kogito-runtime/src/main/java/org/kie/workbench/common/stunner/kogito/client/services/util/impl/ResourceSearchPathImpl.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.stunner.kogito.client.services.util.impl;\n+\n+import java.util.Optional;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+\n+import org.kie.workbench.common.stunner.kogito.client.services.util.ResourceSearchPath;\n+\n+@ApplicationScoped\n+public class ResourceSearchPathImpl implements ResourceSearchPath {\n+\n+    private static final String SEPARATOR = \"/\";", "originalCommit": "49d3e6608ddb99cea8980e5caaad71b96bd0c009", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODQ2Mzk2Mg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3245#discussion_r398463962", "bodyText": "@domhanak on vscode the path always use \"/\" as a separator. Also we cannot use File there becuause that' code is GWT and File isn't part of the jre emulation layer.", "author": "pefernan", "createdAt": "2020-03-26T10:26:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM5ODQ4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODQ2NTA2Ng==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3245#discussion_r398465066", "bodyText": "Thanks, for checking and for the GWT knowledge reminder.", "author": "domhanak", "createdAt": "2020-03-26T10:28:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM5ODQ4NA=="}], "type": "inlineReview"}, {"oid": "38889c546493bd0bddd3c027be035190a29c04fc", "url": "https://github.com/kiegroup/kie-wb-common/commit/38889c546493bd0bddd3c027be035190a29c04fc", "message": "KOGITO-1426: Re-enable Resource Content API", "committedDate": "2020-03-26T08:44:02Z", "type": "forcePushed"}, {"oid": "74c490637cbdf2faa03dc14cceb78843b7145239", "url": "https://github.com/kiegroup/kie-wb-common/commit/74c490637cbdf2faa03dc14cceb78843b7145239", "message": "KOGITO-1426: Re-enable Resource Content API", "committedDate": "2020-03-26T08:52:15Z", "type": "forcePushed"}, {"oid": "4a49faa2f7db5dd41e83566d991816a04ef7c751", "url": "https://github.com/kiegroup/kie-wb-common/commit/4a49faa2f7db5dd41e83566d991816a04ef7c751", "message": "KOGITO-1426: Re-enable Resource Content API", "committedDate": "2020-03-27T13:54:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQwNjI4NA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3245#discussion_r399406284", "bodyText": "@romartin this is a workaround to make work the wid parser on windows... it still keeps working in linx and mac the same.", "author": "pefernan", "createdAt": "2020-03-27T16:54:14Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-sets/kie-wb-common-stunner-bpmn/kie-wb-common-stunner-bpmn-client/src/main/java/org/kie/workbench/common/stunner/bpmn/client/workitem/WorkItemDefinitionClientParser.java", "diffHunk": "@@ -51,6 +51,8 @@\n             return Collections.emptyList();\n         }\n \n+        widStr = widStr.replace(\"\\r\\n\", \"\\n\");", "originalCommit": "0cdc1733a5ecc0628fe3634f1fc4ab64ae3476be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU4NTQzMQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3245#discussion_r399585431", "bodyText": "Hey @pefernan\nGood catch! Thanks for letting me know.\nI was wrong as I though it was due to the file encoding itself, but as you pointed out, it's due how parsers expect new lines on raw text files, so sorry and good catch again!! \ud83d\udc4d\nAnyway, instead of replacing and then splitting, and also to make it Unix/Win/Mac compatible, maybe results better to just change the regexp for the split method, and so NO need to perform the replace, so no need to process all string content twice (replace + split). this way it should look like as:\nString[] lines = widStr.split(\"\\r\\n|\\r|\\n\"); // This should be all OS platform supported.\nAlso, could you please add some test case for this regexp?\nPS: Maybe you can even move this splitting logic to some helper method (eg: org.kie.workbench.common.stunner.core.util.StringUtils) and give a proper name to the method (eg: splitNewLines), so we will be able to reuse this across our codebase.\nWDYT? Thanks a lot, great job!!", "author": "romartin", "createdAt": "2020-03-27T23:46:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQwNjI4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU4NjAwOA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3245#discussion_r399586008", "bodyText": "Also I'd been looking across Stunnet codebase too see if we're facing this issue in some other place, by looking for that Strings in the sources, and I think that's the only place, so we should be safe just by fixing this", "author": "romartin", "createdAt": "2020-03-27T23:48:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQwNjI4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU4NzEyMg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3245#discussion_r399587122", "bodyText": "FYI @ederign ^^ thx!!", "author": "romartin", "createdAt": "2020-03-27T23:54:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQwNjI4NA=="}], "type": "inlineReview"}, {"oid": "8cc6508b4de8669ed31b1051b13d07724a4f97ef", "url": "https://github.com/kiegroup/kie-wb-common/commit/8cc6508b4de8669ed31b1051b13d07724a4f97ef", "message": "fix", "committedDate": "2020-03-30T09:47:36Z", "type": "forcePushed"}, {"oid": "b5ce49cc2a0777cf92c6f4f06506c953436d954a", "url": "https://github.com/kiegroup/kie-wb-common/commit/b5ce49cc2a0777cf92c6f4f06506c953436d954a", "message": "KOGITO-1426: Re-enable Resource Content API", "committedDate": "2020-04-02T13:15:46Z", "type": "commit"}, {"oid": "f48a540b770fbc2c40fb0872ecd937fbf7e1134f", "url": "https://github.com/kiegroup/kie-wb-common/commit/f48a540b770fbc2c40fb0872ecd937fbf7e1134f", "message": "- Temporary workaround for Windows encoding issue.", "committedDate": "2020-04-02T13:15:46Z", "type": "commit"}, {"oid": "69746350fa437e3a2d956e49d4ec03f04732c872", "url": "https://github.com/kiegroup/kie-wb-common/commit/69746350fa437e3a2d956e49d4ec03f04732c872", "message": "fix", "committedDate": "2020-04-02T13:15:46Z", "type": "commit"}, {"oid": "86e7d421ff0a31da413eb2a2f1600b2ca54f5026", "url": "https://github.com/kiegroup/kie-wb-common/commit/86e7d421ff0a31da413eb2a2f1600b2ca54f5026", "message": "- Adding latest resource content API changes", "committedDate": "2020-04-02T13:15:46Z", "type": "forcePushed"}, {"oid": "e0d2bf31ac6361ffa3e1dc724532336b090424c0", "url": "https://github.com/kiegroup/kie-wb-common/commit/e0d2bf31ac6361ffa3e1dc724532336b090424c0", "message": "- Adding latest resource content API changes", "committedDate": "2020-04-03T11:00:45Z", "type": "commit"}, {"oid": "e0d2bf31ac6361ffa3e1dc724532336b090424c0", "url": "https://github.com/kiegroup/kie-wb-common/commit/e0d2bf31ac6361ffa3e1dc724532336b090424c0", "message": "- Adding latest resource content API changes", "committedDate": "2020-04-03T11:00:45Z", "type": "forcePushed"}]}