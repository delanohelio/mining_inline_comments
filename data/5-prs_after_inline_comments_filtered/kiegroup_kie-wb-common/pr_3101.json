{"pr_number": 3101, "pr_title": "[KOGITO-844] Replacing VFSService with ResourceContentService", "pr_createdAt": "2020-01-07T16:25:45Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3101", "timeline": [{"oid": "6f837c4e44853c7eb8182b21c5b66582271efe88", "url": "https://github.com/kiegroup/kie-wb-common/commit/6f837c4e44853c7eb8182b21c5b66582271efe88", "message": "[KOGITO-884] Replacing VFSService with ResourceContentService", "committedDate": "2020-01-07T16:23:25Z", "type": "commit"}, {"oid": "e718392f46cdf967a22082b582e81f1ed4553bf7", "url": "https://github.com/kiegroup/kie-wb-common/commit/e718392f46cdf967a22082b582e81f1ed4553bf7", "message": "Merge remote-tracking branch 'origin/master' into KOGITO-844", "committedDate": "2020-01-08T09:25:46Z", "type": "commit"}, {"oid": "5246cf78bc418dbbb168cd1f4e98ff70b7d7d221", "url": "https://github.com/kiegroup/kie-wb-common/commit/5246cf78bc418dbbb168cd1f4e98ff70b7d7d221", "message": "Merge remote-tracking branch 'origin/master' into KOGITO-844", "committedDate": "2020-01-08T16:25:22Z", "type": "commit"}, {"oid": "a8ca02f4f26267b6f7e7b08acf814c10cb8f91e9", "url": "https://github.com/kiegroup/kie-wb-common/commit/a8ca02f4f26267b6f7e7b08acf814c10cb8f91e9", "message": "[KOGITO-844] Minor modifications", "committedDate": "2020-01-10T09:18:00Z", "type": "commit"}, {"oid": "6a9b8f7925274094d1d65036a7a3865c6eadd39c", "url": "https://github.com/kiegroup/kie-wb-common/commit/6a9b8f7925274094d1d65036a7a3865c6eadd39c", "message": "[KOGITO-844] Fixed API usage", "committedDate": "2020-01-10T13:49:45Z", "type": "commit"}, {"oid": "04e3b0f9938f5580170968202c55d3554854b8be", "url": "https://github.com/kiegroup/kie-wb-common/commit/04e3b0f9938f5580170968202c55d3554854b8be", "message": "[KOGITO-844] Fixed promise usage. Implemented catch test", "committedDate": "2020-01-13T10:16:04Z", "type": "commit"}, {"oid": "6ac74165f8acb9ae807fc52b10200877545a9d82", "url": "https://github.com/kiegroup/kie-wb-common/commit/6ac74165f8acb9ae807fc52b10200877545a9d82", "message": "Merge remote-tracking branch 'origin/master' into KOGITO-844", "committedDate": "2020-01-13T10:16:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMTU4OA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3101#discussion_r365821588", "bodyText": "So is the first parameter uri or path? I am confused after reading javadoc.", "author": "jomarko", "createdAt": "2020-01-13T14:07:42Z", "path": "kie-wb-common-kogito/kie-wb-common-kogito-webapp-base/src/main/java/org/kie/workbench/common/kogito/webapp/base/client/workarounds/KogitoResourceContentService.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright 2019 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.kie.workbench.common.kogito.webapp.base.client.workarounds;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import elemental2.promise.IThenable;\n+import org.appformer.kogito.bridge.client.resource.ResourceContentService;\n+import org.jboss.errai.common.client.api.ErrorCallback;\n+import org.jboss.errai.common.client.api.RemoteCallback;\n+import org.uberfire.client.mvp.PlaceManager;\n+import org.uberfire.client.promise.Promises;\n+import org.uberfire.mvp.PlaceRequest;\n+import org.uberfire.mvp.impl.DefaultPlaceRequest;\n+\n+/**\n+ * Class used to provide <i>resources</i> access to <i>kogito editors</i>\n+ */\n+@ApplicationScoped\n+public class KogitoResourceContentService {\n+\n+    public static final String CONTENT_PARAMETER_NAME = \"content\";\n+    public static final String FILE_NAME_PARAMETER_NAME = \"fileName\";\n+    private PlaceManager placeManager;\n+    private ResourceContentService resourceContentService;\n+    private Promises promises;\n+\n+    private KogitoResourceContentService() {\n+        //CDI proxy\n+    }\n+\n+    @Inject\n+    public KogitoResourceContentService(final PlaceManager placeManager,\n+                                        final ResourceContentService resourceContentService,\n+                                        final Promises promises) {\n+        this.placeManager = placeManager;\n+        this.resourceContentService = resourceContentService;\n+        this.promises = promises;\n+    }\n+\n+    /**\n+     * Open a file at given <code>Path</code> inside an <b>editor</b>\n+     * @param fileUri the <b>uri</code> to the file\n+     * @param editorId The <b>id</b> of the editor to open by the <code>PlaceRequest</code>", "originalCommit": "6ac74165f8acb9ae807fc52b10200877545a9d82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMTk1MA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3101#discussion_r365821950", "bodyText": "similar question uri vs path", "author": "jomarko", "createdAt": "2020-01-13T14:08:24Z", "path": "kie-wb-common-kogito/kie-wb-common-kogito-webapp-base/src/main/java/org/kie/workbench/common/kogito/webapp/base/client/workarounds/KogitoResourceContentService.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright 2019 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.kie.workbench.common.kogito.webapp.base.client.workarounds;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import elemental2.promise.IThenable;\n+import org.appformer.kogito.bridge.client.resource.ResourceContentService;\n+import org.jboss.errai.common.client.api.ErrorCallback;\n+import org.jboss.errai.common.client.api.RemoteCallback;\n+import org.uberfire.client.mvp.PlaceManager;\n+import org.uberfire.client.promise.Promises;\n+import org.uberfire.mvp.PlaceRequest;\n+import org.uberfire.mvp.impl.DefaultPlaceRequest;\n+\n+/**\n+ * Class used to provide <i>resources</i> access to <i>kogito editors</i>\n+ */\n+@ApplicationScoped\n+public class KogitoResourceContentService {\n+\n+    public static final String CONTENT_PARAMETER_NAME = \"content\";\n+    public static final String FILE_NAME_PARAMETER_NAME = \"fileName\";\n+    private PlaceManager placeManager;\n+    private ResourceContentService resourceContentService;\n+    private Promises promises;\n+\n+    private KogitoResourceContentService() {\n+        //CDI proxy\n+    }\n+\n+    @Inject\n+    public KogitoResourceContentService(final PlaceManager placeManager,\n+                                        final ResourceContentService resourceContentService,\n+                                        final Promises promises) {\n+        this.placeManager = placeManager;\n+        this.resourceContentService = resourceContentService;\n+        this.promises = promises;\n+    }\n+\n+    /**\n+     * Open a file at given <code>Path</code> inside an <b>editor</b>\n+     * @param fileUri the <b>uri</code> to the file\n+     * @param editorId The <b>id</b> of the editor to open by the <code>PlaceRequest</code>\n+     */\n+    public void openFile(final String fileUri,\n+                         final String editorId) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+            final PlaceRequest placeRequest = new DefaultPlaceRequest(editorId);\n+            placeRequest.addParameter(FILE_NAME_PARAMETER_NAME, fileUri);\n+            placeRequest.addParameter(CONTENT_PARAMETER_NAME, fileContent);\n+            placeManager.goTo(placeRequest);\n+            return promises.resolve();\n+        });\n+    }\n+\n+    /**\n+     * Load the file at given <code>Path</code> and returns content inside a callback\n+     * @param fileUri\n+     * @param callback\n+     */", "originalCommit": "6ac74165f8acb9ae807fc52b10200877545a9d82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMjUwNg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3101#discussion_r365822506", "bodyText": "Don't we need something similar for opening file?", "author": "jomarko", "createdAt": "2020-01-13T14:09:37Z", "path": "kie-wb-common-kogito/kie-wb-common-kogito-webapp-base/src/main/java/org/kie/workbench/common/kogito/webapp/base/client/workarounds/KogitoResourceContentService.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright 2019 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.kie.workbench.common.kogito.webapp.base.client.workarounds;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import elemental2.promise.IThenable;\n+import org.appformer.kogito.bridge.client.resource.ResourceContentService;\n+import org.jboss.errai.common.client.api.ErrorCallback;\n+import org.jboss.errai.common.client.api.RemoteCallback;\n+import org.uberfire.client.mvp.PlaceManager;\n+import org.uberfire.client.promise.Promises;\n+import org.uberfire.mvp.PlaceRequest;\n+import org.uberfire.mvp.impl.DefaultPlaceRequest;\n+\n+/**\n+ * Class used to provide <i>resources</i> access to <i>kogito editors</i>\n+ */\n+@ApplicationScoped\n+public class KogitoResourceContentService {\n+\n+    public static final String CONTENT_PARAMETER_NAME = \"content\";\n+    public static final String FILE_NAME_PARAMETER_NAME = \"fileName\";\n+    private PlaceManager placeManager;\n+    private ResourceContentService resourceContentService;\n+    private Promises promises;\n+\n+    private KogitoResourceContentService() {\n+        //CDI proxy\n+    }\n+\n+    @Inject\n+    public KogitoResourceContentService(final PlaceManager placeManager,\n+                                        final ResourceContentService resourceContentService,\n+                                        final Promises promises) {\n+        this.placeManager = placeManager;\n+        this.resourceContentService = resourceContentService;\n+        this.promises = promises;\n+    }\n+\n+    /**\n+     * Open a file at given <code>Path</code> inside an <b>editor</b>\n+     * @param fileUri the <b>uri</code> to the file\n+     * @param editorId The <b>id</b> of the editor to open by the <code>PlaceRequest</code>\n+     */\n+    public void openFile(final String fileUri,\n+                         final String editorId) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+            final PlaceRequest placeRequest = new DefaultPlaceRequest(editorId);\n+            placeRequest.addParameter(FILE_NAME_PARAMETER_NAME, fileUri);\n+            placeRequest.addParameter(CONTENT_PARAMETER_NAME, fileContent);\n+            placeManager.goTo(placeRequest);\n+            return promises.resolve();\n+        });\n+    }\n+\n+    /**\n+     * Load the file at given <code>Path</code> and returns content inside a callback\n+     * @param fileUri\n+     * @param callback\n+     */\n+    public void loadFile(final String fileUri,\n+                         final RemoteCallback<String> callback,\n+                         final ErrorCallback<Object> errorCallback) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+                                                     callback.callback(fileContent);\n+                                                     return promises.resolve();\n+                                                 })\n+                .catch_(error -> {\n+                    errorCallback.error(\"Error \" + error, new Throwable(\"Failed to load file \" + fileUri));\n+                    return null;\n+                })", "originalCommit": "6ac74165f8acb9ae807fc52b10200877545a9d82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMzU2Mw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3101#discussion_r365823563", "bodyText": "Can we clarify the javadoc and state that obtained list is returned via callback. As the method returns void?", "author": "jomarko", "createdAt": "2020-01-13T14:11:40Z", "path": "kie-wb-common-kogito/kie-wb-common-kogito-webapp-base/src/main/java/org/kie/workbench/common/kogito/webapp/base/client/workarounds/KogitoResourceContentService.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright 2019 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.kie.workbench.common.kogito.webapp.base.client.workarounds;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import elemental2.promise.IThenable;\n+import org.appformer.kogito.bridge.client.resource.ResourceContentService;\n+import org.jboss.errai.common.client.api.ErrorCallback;\n+import org.jboss.errai.common.client.api.RemoteCallback;\n+import org.uberfire.client.mvp.PlaceManager;\n+import org.uberfire.client.promise.Promises;\n+import org.uberfire.mvp.PlaceRequest;\n+import org.uberfire.mvp.impl.DefaultPlaceRequest;\n+\n+/**\n+ * Class used to provide <i>resources</i> access to <i>kogito editors</i>\n+ */\n+@ApplicationScoped\n+public class KogitoResourceContentService {\n+\n+    public static final String CONTENT_PARAMETER_NAME = \"content\";\n+    public static final String FILE_NAME_PARAMETER_NAME = \"fileName\";\n+    private PlaceManager placeManager;\n+    private ResourceContentService resourceContentService;\n+    private Promises promises;\n+\n+    private KogitoResourceContentService() {\n+        //CDI proxy\n+    }\n+\n+    @Inject\n+    public KogitoResourceContentService(final PlaceManager placeManager,\n+                                        final ResourceContentService resourceContentService,\n+                                        final Promises promises) {\n+        this.placeManager = placeManager;\n+        this.resourceContentService = resourceContentService;\n+        this.promises = promises;\n+    }\n+\n+    /**\n+     * Open a file at given <code>Path</code> inside an <b>editor</b>\n+     * @param fileUri the <b>uri</code> to the file\n+     * @param editorId The <b>id</b> of the editor to open by the <code>PlaceRequest</code>\n+     */\n+    public void openFile(final String fileUri,\n+                         final String editorId) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+            final PlaceRequest placeRequest = new DefaultPlaceRequest(editorId);\n+            placeRequest.addParameter(FILE_NAME_PARAMETER_NAME, fileUri);\n+            placeRequest.addParameter(CONTENT_PARAMETER_NAME, fileContent);\n+            placeManager.goTo(placeRequest);\n+            return promises.resolve();\n+        });\n+    }\n+\n+    /**\n+     * Load the file at given <code>Path</code> and returns content inside a callback\n+     * @param fileUri\n+     * @param callback\n+     */\n+    public void loadFile(final String fileUri,\n+                         final RemoteCallback<String> callback,\n+                         final ErrorCallback<Object> errorCallback) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+                                                     callback.callback(fileContent);\n+                                                     return promises.resolve();\n+                                                 })\n+                .catch_(error -> {\n+                    errorCallback.error(\"Error \" + error, new Throwable(\"Failed to load file \" + fileUri));\n+                    return null;\n+                })\n+        ;\n+    }\n+\n+    /**\n+     * Get the <code>List&lt;Path&gt;</code> from the project/workspace where the editor is running", "originalCommit": "6ac74165f8acb9ae807fc52b10200877545a9d82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMzYyNA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3101#discussion_r365823624", "bodyText": "formatting", "author": "jomarko", "createdAt": "2020-01-13T14:11:47Z", "path": "kie-wb-common-kogito/kie-wb-common-kogito-webapp-base/src/main/java/org/kie/workbench/common/kogito/webapp/base/client/workarounds/KogitoResourceContentService.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright 2019 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.kie.workbench.common.kogito.webapp.base.client.workarounds;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import elemental2.promise.IThenable;\n+import org.appformer.kogito.bridge.client.resource.ResourceContentService;\n+import org.jboss.errai.common.client.api.ErrorCallback;\n+import org.jboss.errai.common.client.api.RemoteCallback;\n+import org.uberfire.client.mvp.PlaceManager;\n+import org.uberfire.client.promise.Promises;\n+import org.uberfire.mvp.PlaceRequest;\n+import org.uberfire.mvp.impl.DefaultPlaceRequest;\n+\n+/**\n+ * Class used to provide <i>resources</i> access to <i>kogito editors</i>\n+ */\n+@ApplicationScoped\n+public class KogitoResourceContentService {\n+\n+    public static final String CONTENT_PARAMETER_NAME = \"content\";\n+    public static final String FILE_NAME_PARAMETER_NAME = \"fileName\";\n+    private PlaceManager placeManager;\n+    private ResourceContentService resourceContentService;\n+    private Promises promises;\n+\n+    private KogitoResourceContentService() {\n+        //CDI proxy\n+    }\n+\n+    @Inject\n+    public KogitoResourceContentService(final PlaceManager placeManager,\n+                                        final ResourceContentService resourceContentService,\n+                                        final Promises promises) {\n+        this.placeManager = placeManager;\n+        this.resourceContentService = resourceContentService;\n+        this.promises = promises;\n+    }\n+\n+    /**\n+     * Open a file at given <code>Path</code> inside an <b>editor</b>\n+     * @param fileUri the <b>uri</code> to the file\n+     * @param editorId The <b>id</b> of the editor to open by the <code>PlaceRequest</code>\n+     */\n+    public void openFile(final String fileUri,\n+                         final String editorId) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+            final PlaceRequest placeRequest = new DefaultPlaceRequest(editorId);\n+            placeRequest.addParameter(FILE_NAME_PARAMETER_NAME, fileUri);\n+            placeRequest.addParameter(CONTENT_PARAMETER_NAME, fileContent);\n+            placeManager.goTo(placeRequest);\n+            return promises.resolve();\n+        });\n+    }\n+\n+    /**\n+     * Load the file at given <code>Path</code> and returns content inside a callback\n+     * @param fileUri\n+     * @param callback\n+     */\n+    public void loadFile(final String fileUri,\n+                         final RemoteCallback<String> callback,\n+                         final ErrorCallback<Object> errorCallback) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+                                                     callback.callback(fileContent);\n+                                                     return promises.resolve();\n+                                                 })\n+                .catch_(error -> {\n+                    errorCallback.error(\"Error \" + error, new Throwable(\"Failed to load file \" + fileUri));\n+                    return null;\n+                })\n+        ;\n+    }\n+\n+    /**\n+     * Get the <code>List&lt;Path&gt;</code> from the project/workspace where the editor is running\n+     *\n+     * @param callback\n+     * @param errorCallback\n+     *\n+     * @see ResourceContentService#list(String)\n+     */\n+    public void getAllItems(final RemoteCallback<List<String>> callback,\n+                               final ErrorCallback<Object> errorCallback) {", "originalCommit": "6ac74165f8acb9ae807fc52b10200877545a9d82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMzgwNA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3101#discussion_r365823804", "bodyText": "similar question as above", "author": "jomarko", "createdAt": "2020-01-13T14:12:06Z", "path": "kie-wb-common-kogito/kie-wb-common-kogito-webapp-base/src/main/java/org/kie/workbench/common/kogito/webapp/base/client/workarounds/KogitoResourceContentService.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright 2019 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.kie.workbench.common.kogito.webapp.base.client.workarounds;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import elemental2.promise.IThenable;\n+import org.appformer.kogito.bridge.client.resource.ResourceContentService;\n+import org.jboss.errai.common.client.api.ErrorCallback;\n+import org.jboss.errai.common.client.api.RemoteCallback;\n+import org.uberfire.client.mvp.PlaceManager;\n+import org.uberfire.client.promise.Promises;\n+import org.uberfire.mvp.PlaceRequest;\n+import org.uberfire.mvp.impl.DefaultPlaceRequest;\n+\n+/**\n+ * Class used to provide <i>resources</i> access to <i>kogito editors</i>\n+ */\n+@ApplicationScoped\n+public class KogitoResourceContentService {\n+\n+    public static final String CONTENT_PARAMETER_NAME = \"content\";\n+    public static final String FILE_NAME_PARAMETER_NAME = \"fileName\";\n+    private PlaceManager placeManager;\n+    private ResourceContentService resourceContentService;\n+    private Promises promises;\n+\n+    private KogitoResourceContentService() {\n+        //CDI proxy\n+    }\n+\n+    @Inject\n+    public KogitoResourceContentService(final PlaceManager placeManager,\n+                                        final ResourceContentService resourceContentService,\n+                                        final Promises promises) {\n+        this.placeManager = placeManager;\n+        this.resourceContentService = resourceContentService;\n+        this.promises = promises;\n+    }\n+\n+    /**\n+     * Open a file at given <code>Path</code> inside an <b>editor</b>\n+     * @param fileUri the <b>uri</code> to the file\n+     * @param editorId The <b>id</b> of the editor to open by the <code>PlaceRequest</code>\n+     */\n+    public void openFile(final String fileUri,\n+                         final String editorId) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+            final PlaceRequest placeRequest = new DefaultPlaceRequest(editorId);\n+            placeRequest.addParameter(FILE_NAME_PARAMETER_NAME, fileUri);\n+            placeRequest.addParameter(CONTENT_PARAMETER_NAME, fileContent);\n+            placeManager.goTo(placeRequest);\n+            return promises.resolve();\n+        });\n+    }\n+\n+    /**\n+     * Load the file at given <code>Path</code> and returns content inside a callback\n+     * @param fileUri\n+     * @param callback\n+     */\n+    public void loadFile(final String fileUri,\n+                         final RemoteCallback<String> callback,\n+                         final ErrorCallback<Object> errorCallback) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+                                                     callback.callback(fileContent);\n+                                                     return promises.resolve();\n+                                                 })\n+                .catch_(error -> {\n+                    errorCallback.error(\"Error \" + error, new Throwable(\"Failed to load file \" + fileUri));\n+                    return null;\n+                })\n+        ;\n+    }\n+\n+    /**\n+     * Get the <code>List&lt;Path&gt;</code> from the project/workspace where the editor is running\n+     *\n+     * @param callback\n+     * @param errorCallback\n+     *\n+     * @see ResourceContentService#list(String)\n+     */\n+    public void getAllItems(final RemoteCallback<List<String>> callback,\n+                               final ErrorCallback<Object> errorCallback) {\n+        getFilteredItems(\"*\", callback, errorCallback);\n+    }\n+\n+    /**\n+     * Get <b>filtered</b> <code>List&lt;Path&gt;</code> from the project/workspace where the editor is running\n+     * @param pattern A GLOB pattern to filter files. To list all files use \"*\"\n+     * @param callback\n+     * @param errorCallback\n+     *\n+     * @see ResourceContentService#list(String)\n+     */", "originalCommit": "6ac74165f8acb9ae807fc52b10200877545a9d82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMzg5Nw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3101#discussion_r365823897", "bodyText": "formating", "author": "jomarko", "createdAt": "2020-01-13T14:12:16Z", "path": "kie-wb-common-kogito/kie-wb-common-kogito-webapp-base/src/main/java/org/kie/workbench/common/kogito/webapp/base/client/workarounds/KogitoResourceContentService.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright 2019 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.kie.workbench.common.kogito.webapp.base.client.workarounds;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import elemental2.promise.IThenable;\n+import org.appformer.kogito.bridge.client.resource.ResourceContentService;\n+import org.jboss.errai.common.client.api.ErrorCallback;\n+import org.jboss.errai.common.client.api.RemoteCallback;\n+import org.uberfire.client.mvp.PlaceManager;\n+import org.uberfire.client.promise.Promises;\n+import org.uberfire.mvp.PlaceRequest;\n+import org.uberfire.mvp.impl.DefaultPlaceRequest;\n+\n+/**\n+ * Class used to provide <i>resources</i> access to <i>kogito editors</i>\n+ */\n+@ApplicationScoped\n+public class KogitoResourceContentService {\n+\n+    public static final String CONTENT_PARAMETER_NAME = \"content\";\n+    public static final String FILE_NAME_PARAMETER_NAME = \"fileName\";\n+    private PlaceManager placeManager;\n+    private ResourceContentService resourceContentService;\n+    private Promises promises;\n+\n+    private KogitoResourceContentService() {\n+        //CDI proxy\n+    }\n+\n+    @Inject\n+    public KogitoResourceContentService(final PlaceManager placeManager,\n+                                        final ResourceContentService resourceContentService,\n+                                        final Promises promises) {\n+        this.placeManager = placeManager;\n+        this.resourceContentService = resourceContentService;\n+        this.promises = promises;\n+    }\n+\n+    /**\n+     * Open a file at given <code>Path</code> inside an <b>editor</b>\n+     * @param fileUri the <b>uri</code> to the file\n+     * @param editorId The <b>id</b> of the editor to open by the <code>PlaceRequest</code>\n+     */\n+    public void openFile(final String fileUri,\n+                         final String editorId) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+            final PlaceRequest placeRequest = new DefaultPlaceRequest(editorId);\n+            placeRequest.addParameter(FILE_NAME_PARAMETER_NAME, fileUri);\n+            placeRequest.addParameter(CONTENT_PARAMETER_NAME, fileContent);\n+            placeManager.goTo(placeRequest);\n+            return promises.resolve();\n+        });\n+    }\n+\n+    /**\n+     * Load the file at given <code>Path</code> and returns content inside a callback\n+     * @param fileUri\n+     * @param callback\n+     */\n+    public void loadFile(final String fileUri,\n+                         final RemoteCallback<String> callback,\n+                         final ErrorCallback<Object> errorCallback) {\n+        resourceContentService.get(fileUri).then((IThenable.ThenOnFulfilledCallbackFn<String, Void>) fileContent -> {\n+                                                     callback.callback(fileContent);\n+                                                     return promises.resolve();\n+                                                 })\n+                .catch_(error -> {\n+                    errorCallback.error(\"Error \" + error, new Throwable(\"Failed to load file \" + fileUri));\n+                    return null;\n+                })\n+        ;\n+    }\n+\n+    /**\n+     * Get the <code>List&lt;Path&gt;</code> from the project/workspace where the editor is running\n+     *\n+     * @param callback\n+     * @param errorCallback\n+     *\n+     * @see ResourceContentService#list(String)\n+     */\n+    public void getAllItems(final RemoteCallback<List<String>> callback,\n+                               final ErrorCallback<Object> errorCallback) {\n+        getFilteredItems(\"*\", callback, errorCallback);\n+    }\n+\n+    /**\n+     * Get <b>filtered</b> <code>List&lt;Path&gt;</code> from the project/workspace where the editor is running\n+     * @param pattern A GLOB pattern to filter files. To list all files use \"*\"\n+     * @param callback\n+     * @param errorCallback\n+     *\n+     * @see ResourceContentService#list(String)\n+     */\n+    public void getFilteredItems(final String pattern,\n+                               final RemoteCallback<List<String>> callback,\n+                               final ErrorCallback<Object> errorCallback) {", "originalCommit": "6ac74165f8acb9ae807fc52b10200877545a9d82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1dd806ba31d0b9a4e057934fe02fc87981ac3b95", "url": "https://github.com/kiegroup/kie-wb-common/commit/1dd806ba31d0b9a4e057934fe02fc87981ac3b95", "message": "[KOGITO-844] Add \"NOT_AVALIABLE_IN_KOGITO\" constant as per PR suggestion", "committedDate": "2020-01-13T14:29:58Z", "type": "commit"}, {"oid": "3b897fecaa65eb021724e1f02455e70d84083900", "url": "https://github.com/kiegroup/kie-wb-common/commit/3b897fecaa65eb021724e1f02455e70d84083900", "message": "[KOGITO-844] Fixed as per PR suggestion", "committedDate": "2020-01-13T14:49:08Z", "type": "commit"}]}