{"pr_number": 215, "pr_title": "feat(status): Detectors field in status.json now has more concise and\u2026", "pr_createdAt": "2020-08-26T16:08:24Z", "pr_url": "https://github.com/blackducksoftware/synopsys-detect/pull/215", "timeline": [{"oid": "6ff0d597c0ba83942d08e49eb78425579271f0b8", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/6ff0d597c0ba83942d08e49eb78425579271f0b8", "message": "feat(status): Detectors field in status.json now has more concise and expressive codes and messages (IDETECT-2188)", "committedDate": "2020-08-25T20:53:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQzODk5MA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r477438990", "bodyText": "I think this should be done before this class is constructed - ie, this class is given the formatted result name.", "author": "taikuukaits", "createdAt": "2020-08-26T16:40:24Z", "path": "detector/src/main/java/com/synopsys/integration/detector/result/DetectorResult.java", "diffHunk": "@@ -42,4 +44,27 @@ public boolean getPassed() {\n     public String getDescription() {\n         return description;\n     }\n+\n+    public String getStatusCode() {\n+        if (!passed) {\n+            return formatResultNameToStatusCode(resultName);\n+        }\n+        return \"PASSED\";\n+    }\n+\n+    private String formatResultNameToStatusCode(String resultName) {", "originalCommit": "6ff0d597c0ba83942d08e49eb78425579271f0b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ5MTE1OA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r477491158", "bodyText": "My concern with that proposal is that then the format method would need to become a class, and all the places that instantiate a DetectorResult would need to instantiate that class.  It just seems messier than this setup where DetectorResult is passed the name of the result it is actually wrapping, and then determines its own status code internally, making the formatting happen in one place.", "author": "crowleySynopsys", "createdAt": "2020-08-26T18:07:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQzODk5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzU5NzM2OA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r477597368", "bodyText": "I'd like to keep these kind of result classes as simple data objects and immutable. I also don't see any tests for this code which would be easier to test if it lived in its own formatter class. And I think tests for this are important as we don't want them to accidentally change. I also prefer that in general, getters should be as simple as possible.\nWhat I would be inclined to do is have Detect Result only contain the raw class name (we could call it ResultClassName) and formatted output manager does the conversion to display name (formatted name) - I am inclined to think if we dramatically changed the format of the names, we would have to bump the formatted output version so I'd also prefer the conversion from some internal class name to a formal external value be as close to formatted output manager as possible.\nRegardless, I think that I would have preferred a DetectResultFactory which enforced the formatting (and the getter was still simple) to doing the work in the getter.", "author": "taikuukaits", "createdAt": "2020-08-26T21:22:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQzODk5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY3OTg4MQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r478679881", "bodyText": "@taikuukaits I did some refactoring to move the conversion of result class name to FormattedOutputManager.  I also added a test.", "author": "crowleySynopsys", "createdAt": "2020-08-27T20:34:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQzODk5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQzOTk5Mw==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r477439993", "bodyText": "Your example contains \"DetectResult\" but you try to strip it here?", "author": "taikuukaits", "createdAt": "2020-08-26T16:42:00Z", "path": "detector/src/main/java/com/synopsys/integration/detector/result/DetectorResult.java", "diffHunk": "@@ -42,4 +44,27 @@ public boolean getPassed() {\n     public String getDescription() {\n         return description;\n     }\n+\n+    public String getStatusCode() {\n+        if (!passed) {\n+            return formatResultNameToStatusCode(resultName);\n+        }\n+        return \"PASSED\";\n+    }\n+\n+    private String formatResultNameToStatusCode(String resultName) {\n+        // Regular Expression\n+        String regex = \"([a-z])([A-Z]+)\";\n+\n+        // Replacement string\n+        String replacement = \"$1_$2\";\n+\n+        // Strip fully qualified class name\n+        String[] classnamePieces = resultName.split(\"\\\\.\");\n+        String actualResultName = classnamePieces[classnamePieces.length-1].replace(\"DetectResult\", \"\");", "originalCommit": "6ff0d597c0ba83942d08e49eb78425579271f0b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ4MjQ4OA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r477482488", "bodyText": "ah yeah my bad that was an example from before I added that replace, the strip works", "author": "crowleySynopsys", "createdAt": "2020-08-26T17:53:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQzOTk5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ0MDExMQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r477440111", "bodyText": "Comments seem unnecessary.", "author": "taikuukaits", "createdAt": "2020-08-26T16:42:12Z", "path": "detector/src/main/java/com/synopsys/integration/detector/result/DetectorResult.java", "diffHunk": "@@ -42,4 +44,27 @@ public boolean getPassed() {\n     public String getDescription() {\n         return description;\n     }\n+\n+    public String getStatusCode() {\n+        if (!passed) {\n+            return formatResultNameToStatusCode(resultName);\n+        }\n+        return \"PASSED\";\n+    }\n+\n+    private String formatResultNameToStatusCode(String resultName) {\n+        // Regular Expression", "originalCommit": "6ff0d597c0ba83942d08e49eb78425579271f0b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ4MTk3Mw==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r477481973", "bodyText": "agreed", "author": "crowleySynopsys", "createdAt": "2020-08-26T17:52:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ0MDExMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ0MDM1Nw==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r477440357", "bodyText": "Don't see why the regex needs to be on its own line and defined before it's used.", "author": "taikuukaits", "createdAt": "2020-08-26T16:42:38Z", "path": "detector/src/main/java/com/synopsys/integration/detector/result/DetectorResult.java", "diffHunk": "@@ -42,4 +44,27 @@ public boolean getPassed() {\n     public String getDescription() {\n         return description;\n     }\n+\n+    public String getStatusCode() {\n+        if (!passed) {\n+            return formatResultNameToStatusCode(resultName);\n+        }\n+        return \"PASSED\";\n+    }\n+\n+    private String formatResultNameToStatusCode(String resultName) {\n+        // Regular Expression\n+        String regex = \"([a-z])([A-Z]+)\";", "originalCommit": "6ff0d597c0ba83942d08e49eb78425579271f0b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ4MTkwMg==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/215#discussion_r477481902", "bodyText": "agreed", "author": "crowleySynopsys", "createdAt": "2020-08-26T17:52:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ0MDM1Nw=="}], "type": "inlineReview"}, {"oid": "0d24c803234949b463f6782d87dd0abb146bdf60", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/0d24c803234949b463f6782d87dd0abb146bdf60", "message": "refactor: Pass regex and replacement directly to replace method, remove comments.", "committedDate": "2020-08-26T18:09:00Z", "type": "commit"}, {"oid": "072d0c08d873802522a3c3b48d083853f6c519ae", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/072d0c08d873802522a3c3b48d083853f6c519ae", "message": "refactor: Pass name of detector result class to FormattedOutputManager.", "committedDate": "2020-08-27T17:29:31Z", "type": "commit"}, {"oid": "ab4c356fffc5cdf89c5ccaaf44626ff91dff8421", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/ab4c356fffc5cdf89c5ccaaf44626ff91dff8421", "message": "feat: Added test for format of new detector items in status.json.", "committedDate": "2020-08-27T20:32:47Z", "type": "commit"}]}