{"pr_number": 11557, "pr_title": "[BEAM-9845] Stage artifacts over expansion service.", "pr_createdAt": "2020-04-28T17:11:08Z", "pr_url": "https://github.com/apache/beam/pull/11557", "timeline": [{"oid": "8fbb78a493b1baa5b4e6e1ae3e12a1f4575f8c64", "url": "https://github.com/apache/beam/commit/8fbb78a493b1baa5b4e6e1ae3e12a1f4575f8c64", "message": "[BEAM-9845] Stage artifacts over expansion service.", "committedDate": "2020-04-28T17:14:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODA1Nzk4Mg==", "url": "https://github.com/apache/beam/pull/11557#discussion_r418057982", "bodyText": "Is the resolution order documented somewhere?", "author": "mxm", "createdAt": "2020-04-30T14:35:47Z", "path": "runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/DefaultArtifactResolver.java", "diffHunk": "@@ -62,6 +63,24 @@ public void register(ResolutionFn fn) {\n     fns.add(fn);\n   }\n \n+  @Override\n+  public List<RunnerApi.ArtifactInformation> resolveArtifacts(\n+      List<RunnerApi.ArtifactInformation> artifacts) {\n+    for (ResolutionFn fn : Lists.reverse(fns)) {", "originalCommit": "4e39d055007060288d6c3abc32cd14f51d47f3a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM0ODI4Ng==", "url": "https://github.com/apache/beam/pull/11557#discussion_r418348286", "bodyText": "Yes, this is documented in the class's docstring.", "author": "robertwb", "createdAt": "2020-04-30T23:39:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODA1Nzk4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM3NTEwNg==", "url": "https://github.com/apache/beam/pull/11557#discussion_r418375106", "bodyText": "This assumes that the set of classpath resources required to execute Java SDK harness and execute the cross-langauge Java step to be the same as the set of classpath resources specified when starting up the expansion service, right ?\nI'm wondering if we can always rely on this. At least we should document this so that users are aware how to stage additional resources if needed.", "author": "chamikaramj", "createdAt": "2020-05-01T01:22:16Z", "path": "sdks/java/expansion-service/src/main/java/org/apache/beam/sdk/expansion/service/ExpansionService.java", "diffHunk": "@@ -317,6 +321,14 @@ default InputT createInput(Pipeline p, Map<String, PCollection<?>> inputs) {\n     Pipeline pipeline = Pipeline.create();\n     ExperimentalOptions.addExperiment(\n         pipeline.getOptions().as(ExperimentalOptions.class), \"beam_fn_api\");\n+    List<String> classpathResources =\n+        detectClassPathResourcesToStage(Environments.class.getClassLoader(), pipeline.getOptions());", "originalCommit": "b47361eccc0ff5b9c64e7cd30702c27a25a518e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQwMTk4Nw==", "url": "https://github.com/apache/beam/pull/11557#discussion_r418401987", "bodyText": "Correct. This is a reasonable default (and the provider of an expansion service can always arrange that it is so), but we'll probably eventually want a way to customize this.", "author": "robertwb", "createdAt": "2020-05-01T03:34:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM3NTEwNg=="}], "type": "inlineReview"}, {"oid": "93fe47337a5dbd14e3d6dba79484f51bf82d424c", "url": "https://github.com/apache/beam/commit/93fe47337a5dbd14e3d6dba79484f51bf82d424c", "message": "[BEAM-9577] Resolve dependencies in Java expansion service.", "committedDate": "2020-05-05T08:26:52Z", "type": "forcePushed"}, {"oid": "e725118fb1afb6d869b9b4e19110aae26ddd26ed", "url": "https://github.com/apache/beam/commit/e725118fb1afb6d869b9b4e19110aae26ddd26ed", "message": "Move job server to its own module.\n\nThis avoids circular dependencies with the expansion service.", "committedDate": "2020-05-06T08:46:27Z", "type": "commit"}, {"oid": "61d0029246b7af7c656d03f10b3001475a811ea9", "url": "https://github.com/apache/beam/commit/61d0029246b7af7c656d03f10b3001475a811ea9", "message": "[BEAM-9845] Stage artifacts over expansion service.", "committedDate": "2020-05-06T08:46:27Z", "type": "commit"}, {"oid": "544e56874a84deee4e597b48ce8d3b501ab117a6", "url": "https://github.com/apache/beam/commit/544e56874a84deee4e597b48ce8d3b501ab117a6", "message": "[BEAM-9577] Resolve dependencies in Java expansion service.", "committedDate": "2020-05-06T08:46:27Z", "type": "commit"}, {"oid": "de83a82c1d22a8eda9f214a6d57e9d69215979de", "url": "https://github.com/apache/beam/commit/de83a82c1d22a8eda9f214a6d57e9d69215979de", "message": "Start artifact service in expansion service driver.\n0;256;0c# Please enter the commit message for your changes. Lines starting", "committedDate": "2020-05-06T10:09:18Z", "type": "commit"}, {"oid": "de83a82c1d22a8eda9f214a6d57e9d69215979de", "url": "https://github.com/apache/beam/commit/de83a82c1d22a8eda9f214a6d57e9d69215979de", "message": "Start artifact service in expansion service driver.\n0;256;0c# Please enter the commit message for your changes. Lines starting", "committedDate": "2020-05-06T10:09:18Z", "type": "forcePushed"}]}