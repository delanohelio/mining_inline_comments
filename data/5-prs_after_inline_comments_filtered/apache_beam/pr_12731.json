{"pr_number": 12731, "pr_title": "[BEAM-10830] Twister2 quickstarts and the runner maven archetypes", "pr_createdAt": "2020-08-30T04:12:20Z", "pr_url": "https://github.com/apache/beam/pull/12731", "timeline": [{"oid": "8339055857ad99183077068a0ce3f8f2af940646", "url": "https://github.com/apache/beam/commit/8339055857ad99183077068a0ce3f8f2af940646", "message": "adding twister2 quickstart", "committedDate": "2020-08-30T02:10:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY5NjExMA==", "url": "https://github.com/apache/beam/pull/12731#discussion_r487696110", "bodyText": "Is there any particular reason to use a different logger kind here?\nWe use slf4j in most of the Beam code base for logging so maybe good to follow this on the Twister2 runner. Notice that this can be done in a separate PR.", "author": "iemejia", "createdAt": "2020-09-14T07:11:44Z", "path": "runners/twister2/src/main/java/org/apache/beam/runners/twister2/Twister2PipelineResult.java", "diffHunk": "@@ -17,15 +17,21 @@\n  */\n package org.apache.beam.runners.twister2;\n \n+import edu.iu.dsc.tws.api.scheduler.Twister2JobState;\n import java.io.IOException;\n import org.apache.beam.sdk.PipelineResult;\n import org.apache.beam.sdk.metrics.MetricResults;\n import org.joda.time.Duration;\n+import org.mortbay.log.Log;", "originalCommit": "8339055857ad99183077068a0ce3f8f2af940646", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc1MDcwMw==", "url": "https://github.com/apache/beam/pull/12731#discussion_r494750703", "bodyText": "@iemejia No, I will create separate PR that encapsulates all the changes you have mentioned. I will remove this log import", "author": "pulasthi", "createdAt": "2020-09-25T05:11:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY5NjExMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk0MTg4Nw==", "url": "https://github.com/apache/beam/pull/12731#discussion_r487941887", "bodyText": "with guava (use vendor if so) this can be simpler, but that's not blocking at all for this PR\nreturn Strings.isNullOrEmpty(options.getTwister2Home());", "author": "iemejia", "createdAt": "2020-09-14T13:57:21Z", "path": "runners/twister2/src/main/java/org/apache/beam/runners/twister2/Twister2Runner.java", "diffHunk": "@@ -119,19 +129,27 @@ public PipelineResult run(Pipeline pipeline) {\n             .addComputeResource(options.getWorkerCPUs(), options.getRamMegaBytes(), workers)\n             .setConfig(jobConfig)\n             .build();\n-    Twister2JobState jobState = Twister2Submitter.submitJob(twister2Job, config);\n \n-    Twister2PipelineResult result = new Twister2PipelineResult();\n-    // TODO: Need to fix the check for \"RUNNING\" once fix for this is done on Twister2 end.\n-    if (jobState.getJobstate() == DriverJobState.FAILED\n-        || jobState.getJobstate() == DriverJobState.RUNNING) {\n-      throw new RuntimeException(\"Pipeline execution failed\", jobState.getCause());\n+    Twister2JobState jobState;\n+    if (isLocalMode(options)) {\n+      jobState = LocalSubmitter.submitJob(twister2Job, config);\n     } else {\n-      result.setState(PipelineResult.State.DONE);\n+      jobState = Twister2Submitter.submitJob(twister2Job, config);\n     }\n+\n+    Twister2PipelineResult result = new Twister2PipelineResult(jobState);\n     return result;\n   }\n \n+  /** Check if the Runner is set to use Twister local mode or pointing to a deployment. */\n+  private boolean isLocalMode(Twister2PipelineOptions options) {\n+    if (options.getTwister2Home() == null || \"\".equals(options.getTwister2Home())) {", "originalCommit": "8339055857ad99183077068a0ce3f8f2af940646", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}