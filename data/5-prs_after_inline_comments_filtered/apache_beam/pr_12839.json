{"pr_number": 12839, "pr_title": "[BEAM-10893] Add Json support to Kafka Table Provider", "pr_createdAt": "2020-09-14T13:23:54Z", "pr_url": "https://github.com/apache/beam/pull/12839", "timeline": [{"oid": "2f85391a62b5cc98c0e67f9efeebdf195e04f02e", "url": "https://github.com/apache/beam/commit/2f85391a62b5cc98c0e67f9efeebdf195e04f02e", "message": "Remove booleans, use List of values", "committedDate": "2020-09-17T09:36:47Z", "type": "forcePushed"}, {"oid": "f0bb3d5bd340c036e28fa8ff49ca3d88af189809", "url": "https://github.com/apache/beam/commit/f0bb3d5bd340c036e28fa8ff49ca3d88af189809", "message": "Remove booleans, use List of values", "committedDate": "2020-09-25T07:33:00Z", "type": "forcePushed"}, {"oid": "ae4234196e7d4f6aa78e1c278df0c5f0296288bd", "url": "https://github.com/apache/beam/commit/ae4234196e7d4f6aa78e1c278df0c5f0296288bd", "message": "[BEAM-10893] Add Json support to Kafka Table Provider", "committedDate": "2020-10-19T14:27:02Z", "type": "forcePushed"}, {"oid": "ee8db52ad407a3cd25695b93928e7efba0c1e30d", "url": "https://github.com/apache/beam/commit/ee8db52ad407a3cd25695b93928e7efba0c1e30d", "message": "[BEAM-10893] Add Json support to Kafka Table Provider", "committedDate": "2020-10-27T09:10:37Z", "type": "commit"}, {"oid": "ee8db52ad407a3cd25695b93928e7efba0c1e30d", "url": "https://github.com/apache/beam/commit/ee8db52ad407a3cd25695b93928e7efba0c1e30d", "message": "[BEAM-10893] Add Json support to Kafka Table Provider", "committedDate": "2020-10-27T09:10:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzAxMTQ1Ng==", "url": "https://github.com/apache/beam/pull/12839#discussion_r513011456", "bodyText": "nit: I think this and JsonRecorderEncoder can be private", "author": "TheNeuralBit", "createdAt": "2020-10-27T20:32:35Z", "path": "sdks/java/extensions/sql/src/main/java/org/apache/beam/sdk/extensions/sql/meta/provider/kafka/BeamKafkaJsonTable.java", "diffHunk": "@@ -0,0 +1,107 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.extensions.sql.meta.provider.kafka;\n+\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import java.util.List;\n+import org.apache.beam.sdk.schemas.Schema;\n+import org.apache.beam.sdk.transforms.DoFn;\n+import org.apache.beam.sdk.transforms.PTransform;\n+import org.apache.beam.sdk.transforms.ParDo;\n+import org.apache.beam.sdk.util.RowJson;\n+import org.apache.beam.sdk.util.RowJsonUtils;\n+import org.apache.beam.sdk.values.KV;\n+import org.apache.beam.sdk.values.PCollection;\n+import org.apache.beam.sdk.values.Row;\n+\n+public class BeamKafkaJsonTable extends BeamKafkaTable {\n+  public BeamKafkaJsonTable(Schema beamSchema, String bootstrapServers, List<String> topics) {\n+    super(beamSchema, bootstrapServers, topics);\n+  }\n+\n+  @Override\n+  public PTransform<PCollection<KV<byte[], byte[]>>, PCollection<Row>> getPTransformForInput() {\n+    ObjectMapper objectMapper =\n+        RowJsonUtils.newObjectMapperWith(RowJson.RowJsonDeserializer.forSchema(schema));\n+    return new BeamKafkaJsonTable.JsonRecorderDecoder(schema, objectMapper);\n+  }\n+\n+  @Override\n+  public PTransform<PCollection<Row>, PCollection<KV<byte[], byte[]>>> getPTransformForOutput() {\n+    ObjectMapper objectMapper =\n+        RowJsonUtils.newObjectMapperWith(RowJson.RowJsonSerializer.forSchema(schema));\n+    return new BeamKafkaJsonTable.JsonRecorderEncoder(objectMapper);\n+  }\n+\n+  /** A PTransform to convert {@code KV<byte[], byte[]>} to {@link Row}. */\n+  public static class JsonRecorderDecoder", "originalCommit": "ee8db52ad407a3cd25695b93928e7efba0c1e30d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIyMjkxNw==", "url": "https://github.com/apache/beam/pull/12839#discussion_r513222917", "bodyText": "Done", "author": "piotr-szuberski", "createdAt": "2020-10-28T07:15:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzAxMTQ1Ng=="}], "type": "inlineReview"}, {"oid": "17609e97cd3b144397cb35f90d1c6f2334b4d308", "url": "https://github.com/apache/beam/commit/17609e97cd3b144397cb35f90d1c6f2334b4d308", "message": "Make inner classes private", "committedDate": "2020-10-28T07:12:45Z", "type": "commit"}, {"oid": "65c049374766782426af6004db4e0af0ae1afdd0", "url": "https://github.com/apache/beam/commit/65c049374766782426af6004db4e0af0ae1afdd0", "message": "Update website and CHANGES.md", "committedDate": "2020-10-28T08:50:11Z", "type": "commit"}, {"oid": "65c049374766782426af6004db4e0af0ae1afdd0", "url": "https://github.com/apache/beam/commit/65c049374766782426af6004db4e0af0ae1afdd0", "message": "Update website and CHANGES.md", "committedDate": "2020-10-28T08:50:11Z", "type": "forcePushed"}]}