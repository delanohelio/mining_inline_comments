{"pr_number": 860, "pr_title": "issue #858 - added logic to set summary=count when size=0", "pr_createdAt": "2020-03-27T18:48:28Z", "pr_url": "https://github.com/IBM/FHIR/pull/860", "timeline": [{"oid": "c2fe69915f52ba81fa209ac8dcd95d4faca6561e", "url": "https://github.com/IBM/FHIR/commit/c2fe69915f52ba81fa209ac8dcd95d4faca6561e", "message": "issue #858 - added logic to set summary=count when size=0\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-03-27T18:44:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ4MTEwMw==", "url": "https://github.com/IBM/FHIR/pull/860#discussion_r399481103", "bodyText": "leaving one comment - makes sense to me - do we want a test for it?", "author": "prb112", "createdAt": "2020-03-27T19:04:31Z", "path": "fhir-search/src/main/java/com/ibm/fhir/search/util/SearchUtil.java", "diffHunk": "@@ -1074,11 +1074,19 @@ private static void parseSearchResultParameter(Class<?> resourceType, FHIRSearch\n             if (SearchConstants.COUNT.equals(name)) {\n                 int pageSize = Integer.parseInt(first);\n \n-                // If the user specified a value > max, then use the max.\n-                if (pageSize > SearchConstants.MAX_PAGE_SIZE) {\n-                    pageSize = SearchConstants.MAX_PAGE_SIZE;\n+                if (pageSize < 0) {\n+                    throw new IllegalArgumentException(\"pageSize must be greater than or equal to zero\");\n+                } else if (pageSize == 0) {\n+                    // if _count has the value 0, this shall be treated the same as _summary=count\n+                    // https://www.hl7.org/fhir/r4/search.html#count\n+                    context.setSummaryParameter(SummaryValueSet.COUNT);", "originalCommit": "c2fe69915f52ba81fa209ac8dcd95d4faca6561e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ4MzY5NA==", "url": "https://github.com/IBM/FHIR/pull/860#discussion_r399483694", "bodyText": "will this change the link in the search result? I mean will this append _summary=count there? can not remember clearly does this impact or not ...", "author": "albertwang-ibm", "createdAt": "2020-03-27T19:09:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ4MTEwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTUwNjk0OQ==", "url": "https://github.com/IBM/FHIR/pull/860#discussion_r399506949", "bodyText": "do we want a test for it?\n\ni debated it, but wanted to get this out fast to make sure it makes 4.1.0.  now i circled back and added a single e2e test for it\n\nwill this change the link in the search result?\n\nyes, it does affect the self url and I think this is actually a GOOD thing:\nhttps://localhost:9443/fhir-server/api/v4/Practitioner?_count=10&_id=e98d6843-2a73-46b7-889f-4c097da8f267&_summary=count&_page=1", "author": "lmsurpre", "createdAt": "2020-03-27T19:56:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ4MTEwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTUwOTk3MA==", "url": "https://github.com/IBM/FHIR/pull/860#discussion_r399509970", "bodyText": "request _count=0 but response with _count=10&_summary=count seems a little bit weird for me, but not a block issue. I think it's LGTM.", "author": "albertwang-ibm", "createdAt": "2020-03-27T20:02:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ4MTEwMw=="}], "type": "inlineReview"}, {"oid": "ed9cf3ec7be131bba33635a56c8f2d649e6dcce6", "url": "https://github.com/IBM/FHIR/commit/ed9cf3ec7be131bba33635a56c8f2d649e6dcce6", "message": "issue #851 - add delete to the pre-packed openapi\n\nwe already had a flag for this, i just made it true by default\n\ni also updated the definition to say it returns HTTP 204 (No Content) on\nsuccess (vs 200 OK)\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-03-27T19:26:08Z", "type": "commit"}, {"oid": "da4a849969c2c3ffa760552556e210d0656a5028", "url": "https://github.com/IBM/FHIR/commit/da4a849969c2c3ffa760552556e210d0656a5028", "message": "Merge pull request #861 from IBM/issue-851\n\nissue #851 - add delete to the pre-packed openapi", "committedDate": "2020-03-27T19:46:18Z", "type": "commit"}, {"oid": "861619ac643826d7820ebb44ca737c353be5d709", "url": "https://github.com/IBM/FHIR/commit/861619ac643826d7820ebb44ca737c353be5d709", "message": "issue #858 - added summary=count and count=0 e2e tests\n\nAdded them in SearchTest which is where the other Summary tests were\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-03-27T19:59:32Z", "type": "commit"}]}