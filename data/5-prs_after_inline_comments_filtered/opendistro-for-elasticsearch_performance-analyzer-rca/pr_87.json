{"pr_number": 87, "pr_title": "Made RCA Sqlite retention configurable with config file", "pr_createdAt": "2020-02-05T04:02:44Z", "pr_url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/87", "timeline": [{"oid": "261fd553e45d49053ba4fb518ca1a7352e883d4f", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/261fd553e45d49053ba4fb518ca1a7352e883d4f", "message": "Made RCA Sqlite retention configurable with config file", "committedDate": "2020-02-05T03:58:28Z", "type": "commit"}, {"oid": "644505ebde0d1acd075e32e0b739f5ccda7b403b", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/644505ebde0d1acd075e32e0b739f5ccda7b403b", "message": "Fixed checkstyle", "committedDate": "2020-02-05T18:44:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ2NDE2Mg==", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/87#discussion_r375464162", "bodyText": "can we make it screaming snake case for final fields ?", "author": "yojs", "createdAt": "2020-02-05T19:33:41Z", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/persistence/PersistorBase.java", "diffHunk": "@@ -48,11 +51,12 @@\n   protected String filenameParam;\n   protected String dbProtocol;\n   private static final int FILE_ROTATION_PERIOD_SECS = 3600;\n-  private static final int SQLITE_FILES_TO_KEEP = 5;\n+  private final int storageFileRetentionCount;", "originalCommit": "644505ebde0d1acd075e32e0b739f5ccda7b403b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ3MDcwOA==", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/87#discussion_r375470708", "bodyText": "The default constructor takes the current time new Date()", "author": "yojs", "createdAt": "2020-02-05T19:46:16Z", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/persistence/PersistorBase.java", "diffHunk": "@@ -122,14 +134,26 @@ public synchronized void openNewDBFile() throws SQLException {\n     createNewDSLContext();\n   }\n \n+  /**\n+   * This method check if there is a need to delete old sqlite files and create a new one.\n+   * Ideally we will be using new sqlite files at the start of every hour, ideally the whenever the\n+   * function write is called for the first time in that very hour\n+   */\n   public synchronized void rotateDBIfRequired() throws ParseException, SQLException {\n-    Date currTimeMs = new Date(System.currentTimeMillis());\n-    if ((currTimeMs.getTime() - this.fileCreateTime.getTime()) / 1000 > FILE_ROTATION_PERIOD_SECS) {\n+    LocalDateTime currentLocalDateTime = getLocalDateTimeFromDateObj(new Date(System.currentTimeMillis()));", "originalCommit": "644505ebde0d1acd075e32e0b739f5ccda7b403b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ5Mzc5Ng==", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/87#discussion_r375493796", "bodyText": "Done", "author": "palashhedau", "createdAt": "2020-02-05T20:35:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ3MDcwOA=="}], "type": "inlineReview"}, {"oid": "8450f180af17b0c16a1e9553052e223b93a1d953", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/8450f180af17b0c16a1e9553052e223b93a1d953", "message": "Fixes - Minor Bug and variable names", "committedDate": "2020-02-05T20:24:25Z", "type": "commit"}, {"oid": "9e102e04f6dec6ec69aa596c62db6f3eaf5e91de", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/9e102e04f6dec6ec69aa596c62db6f3eaf5e91de", "message": "Merge branch 'palash-rca-sqlite-merge' of github.com:opendistro-for-elasticsearch/performance-analyzer-rca into palash-rca-sqlite-merge", "committedDate": "2020-02-05T20:26:55Z", "type": "commit"}]}