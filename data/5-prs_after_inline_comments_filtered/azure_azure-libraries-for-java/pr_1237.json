{"pr_number": 1237, "pr_title": "Resources: upgrade to package-2020-06", "pr_createdAt": "2020-07-15T12:47:55Z", "pr_url": "https://github.com/Azure/azure-libraries-for-java/pull/1237", "timeline": [{"oid": "f06fd6e1786762e0e9dfcf33b9cc9deab0d3c004", "url": "https://github.com/Azure/azure-libraries-for-java/commit/f06fd6e1786762e0e9dfcf33b9cc9deab0d3c004", "message": "upgrade resources", "committedDate": "2020-07-15T08:05:49Z", "type": "commit"}, {"oid": "fa28d5814a7275791c026b745c10fe751a9d9e49", "url": "https://github.com/Azure/azure-libraries-for-java/commit/fa28d5814a7275791c026b745c10fe751a9d9e49", "message": "generate package-2020-06", "committedDate": "2020-07-15T08:32:13Z", "type": "commit"}, {"oid": "4708f4a57d0f22ce7eaca45038855182452c1d2a", "url": "https://github.com/Azure/azure-libraries-for-java/commit/4708f4a57d0f22ce7eaca45038855182452c1d2a", "message": "fix compile errors and add outResources", "committedDate": "2020-07-15T12:46:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAyNjA5Mw==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455026093", "bodyText": "This is not valid change as template got removed from return type. Need to check with @weidongxu-microsoft  if we can have alternative inner classes.", "author": "xseeseesee", "createdAt": "2020-07-15T12:50:46Z", "path": "azure-mgmt-resources/src/test/java/com/microsoft/azure/management/resources/implementation/TypeSerializationTests.java", "diffHunk": "@@ -29,7 +29,7 @@ private static DeploymentInner createRequestFromInner(DeploymentImpl deployment)\n         DeploymentInner inner = new DeploymentInner()\n                 .withProperties(new DeploymentProperties());\n         inner.properties().withMode(deployment.mode());\n-        inner.properties().withTemplate(deployment.template());\n+        inner.properties().withTemplate(\"{\\\"$schema\\\":\\\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\\\",\\\"contentVersion\\\":\\\"1.0.0.0\\\",\\\"parameters\\\":{\\\"vnetName\\\":{\\\"type\\\":\\\"string\\\",\\\"defaultValue\\\":\\\"VNet2\\\",\\\"metadata\\\":{\\\"description\\\":\\\"VNet name\\\"}},\\\"vnetAddressPrefix\\\":{\\\"type\\\":\\\"string\\\",\\\"defaultValue\\\":\\\"10.0.0.0/16\\\",\\\"metadata\\\":{\\\"description\\\":\\\"Address prefix\\\"}},\\\"subnet1Prefix\\\":{\\\"type\\\":\\\"string\\\",\\\"defaultValue\\\":\\\"10.0.0.0/24\\\",\\\"metadata\\\":{\\\"description\\\":\\\"Subnet 1 Prefix\\\"}},\\\"subnet1Name\\\":{\\\"type\\\":\\\"string\\\",\\\"defaultValue\\\":\\\"Subnet1\\\",\\\"metadata\\\":{\\\"description\\\":\\\"Subnet 1 Name\\\"}},\\\"subnet2Prefix\\\":{\\\"type\\\":\\\"string\\\",\\\"defaultValue\\\":\\\"10.0.1.0/24\\\",\\\"metadata\\\":{\\\"description\\\":\\\"Subnet 2 Prefix\\\"}},\\\"subnet2Name\\\":{\\\"type\\\":\\\"string\\\",\\\"defaultValue\\\":\\\"Subnet222\\\",\\\"metadata\\\":{\\\"description\\\":\\\"Subnet 2 Name\\\"}}},\\\"variables\\\":{\\\"apiVersion\\\":\\\"2015-06-15\\\"},\\\"resources\\\":[{\\\"apiVersion\\\":\\\"[variables('apiVersion')]\\\",\\\"type\\\":\\\"Microsoft.Network/virtualNetworks\\\",\\\"name\\\":\\\"[parameters('vnetName')]\\\",\\\"location\\\":\\\"[resourceGroup().location]\\\",\\\"properties\\\":{\\\"addressSpace\\\":{\\\"addressPrefixes\\\":[\\\"[parameters('vnetAddressPrefix')]\\\"]},\\\"subnets\\\":[{\\\"name\\\":\\\"[parameters('subnet1Name')]\\\",\\\"properties\\\":{\\\"addressPrefix\\\":\\\"[parameters('subnet1Prefix')]\\\"}},{\\\"name\\\":\\\"[parameters('subnet2Name')]\\\",\\\"properties\\\":{\\\"addressPrefix\\\":\\\"[parameters('subnet2Prefix')]\\\"}}]}}]}\");", "originalCommit": "4708f4a57d0f22ce7eaca45038855182452c1d2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQzMTQ3MQ==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455431471", "bodyText": "This test is only for request POJO.\nIf you have problem with it, you can comment out the test. I will try fix it after your PR.", "author": "weidongxu-microsoft", "createdAt": "2020-07-15T23:57:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAyNjA5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzMjExMQ==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455532111", "bodyText": "Marked by Ignore to skip for now.", "author": "xseeseesee", "createdAt": "2020-07-16T06:12:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAyNjA5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQzMjI4Mg==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455432282", "bodyText": "If deleting this method does not affect compilation, you can delete it.", "author": "weidongxu-microsoft", "createdAt": "2020-07-16T00:00:30Z", "path": "azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/implementation/DeploymentImpl.java", "diffHunk": "@@ -355,16 +354,6 @@ public DeploymentImpl beginCreate() {\n \n     @Override\n     public Observable<Deployment> updateResourceAsync() {", "originalCommit": "4708f4a57d0f22ce7eaca45038855182452c1d2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzMjIwNg==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455532206", "bodyText": "Deleted.", "author": "xseeseesee", "createdAt": "2020-07-16T06:13:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQzMjI4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQzMjg3OQ==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455432879", "bodyText": "Maybe better name it as deploymentCreateUpdateParameters. And you need to reset it after create/update (so next update will start clean).\nFor update, you might check if some fields need to be copied from inner() to this object (region etc.).", "author": "weidongxu-microsoft", "createdAt": "2020-07-16T00:02:27Z", "path": "azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/implementation/DeploymentImpl.java", "diffHunk": "@@ -58,13 +58,15 @@\n     private Creatable<ResourceGroup> creatableResourceGroup;\n     private ObjectMapper objectMapper;\n     private DeploymentWhatIf deploymentWhatIf;\n+    private DeploymentInner deploymentInner;", "originalCommit": "4708f4a57d0f22ce7eaca45038855182452c1d2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzMjI3MA==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455532270", "bodyText": "Done.", "author": "xseeseesee", "createdAt": "2020-07-16T06:13:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQzMjg3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ3NTM1OQ==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455475359", "bodyText": "No. This losses information.\nIf service do this intentionally, the right approach is to had GenericResource wraps GenericResourceExpandedInner (when by get, there additional properties be null).", "author": "weidongxu-microsoft", "createdAt": "2020-07-16T02:39:49Z", "path": "azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/implementation/GenericResourcesImpl.java", "diffHunk": "@@ -35,29 +37,37 @@\n         ResourceManager>\n     implements GenericResources {\n \n-    GenericResourcesImpl(ResourceManager resourceManager) {\n+    private PagedListConverter<GenericResourceExpandedInner, GenericResource> converter;\n+\n+    GenericResourcesImpl(final ResourceManager resourceManager) {\n         super(resourceManager.inner().resources(), resourceManager);\n+        converter = new PagedListConverter<GenericResourceExpandedInner, GenericResource>() {\n+            @Override\n+            public Observable<GenericResource> typeConvertAsync(GenericResourceExpandedInner inner) {\n+                return Observable.just((GenericResource) new GenericResourceImpl(inner.name(), inner, manager()));\n+            }", "originalCommit": "4708f4a57d0f22ce7eaca45038855182452c1d2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ3NTgzMA==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455475830", "bodyText": "It might be OK if we determined not to maintain it anymore...", "author": "weidongxu-microsoft", "createdAt": "2020-07-16T02:41:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ3NTM1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUxMTA2Ng==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455511066", "bodyText": "Maybe it is OK.\nEven if we later need to expose createdTime etc., we can hack by first check inner instanceof GenericResourceExpandedInner , if yet, cast and return value, if not, return null.", "author": "weidongxu-microsoft", "createdAt": "2020-07-16T05:01:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ3NTM1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUxODAyNQ==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455518025", "bodyText": "Now I'm not sure if we should expose filter/expand in APIs. For the solution, I agree we can do in that way by checking instanceof.", "author": "xseeseesee", "createdAt": "2020-07-16T05:27:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ3NTM1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUyMTYxMA==", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1237#discussion_r455521610", "bodyText": "Generally speaking, we should expose as overloaded method. But for track1, I think we will not expose them, until requested by customer.\nFor track2, I think the question is whether we expose a simple string (and let user compose it based on description), or try standardize it a bit.\nWe likely need to gather more info on existing ones.\nE.g. description on compute\n     * @param filter The filter to apply to the operation. Allowed values are 'startswith(instanceView/statuses/code,\n     *     'PowerState') eq true', 'properties/latestModelApplied eq true', 'properties/latestModelApplied eq false'.\n\nSo I think most is using odata $filter $expand. We need first investigate on existing support on odata.", "author": "weidongxu-microsoft", "createdAt": "2020-07-16T05:40:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ3NTM1OQ=="}], "type": "inlineReview"}, {"oid": "8e705c7605bae18f60e6f1855da2b8b741b63855", "url": "https://github.com/Azure/azure-libraries-for-java/commit/8e705c7605bae18f60e6f1855da2b8b741b63855", "message": "update by review comments", "committedDate": "2020-07-16T06:11:46Z", "type": "commit"}, {"oid": "02177f6b64ba19d7888318f90d15ed983c3e11b5", "url": "https://github.com/Azure/azure-libraries-for-java/commit/02177f6b64ba19d7888318f90d15ed983c3e11b5", "message": "update session records", "committedDate": "2020-07-20T03:07:00Z", "type": "commit"}, {"oid": "9e92b126729ec680b0fc0b476de1a23ab28ff4cf", "url": "https://github.com/Azure/azure-libraries-for-java/commit/9e92b126729ec680b0fc0b476de1a23ab28ff4cf", "message": "update for tag operation enum", "committedDate": "2020-07-20T05:10:09Z", "type": "commit"}]}