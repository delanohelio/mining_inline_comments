{"pr_number": 6349, "pr_title": "feat: `NONE` format for key-less streams", "pr_createdAt": "2020-10-02T10:43:36Z", "pr_url": "https://github.com/confluentinc/ksql/pull/6349", "timeline": [{"oid": "9b7419812277731dcc2f5a21cfd7124a17e389f8", "url": "https://github.com/confluentinc/ksql/commit/9b7419812277731dcc2f5a21cfd7124a17e389f8", "message": "feat: add NONE format\n\nfixes: https://github.com/confluentinc/ksql/issues/6221\n\nIntroduce a `NONE` format, used to indicate the key data, in key-less streams, should not be deserialized.", "committedDate": "2020-10-02T10:42:22Z", "type": "commit"}, {"oid": "451f166349180f7dc2048ae8afd508dfd310e31c", "url": "https://github.com/confluentinc/ksql/commit/451f166349180f7dc2048ae8afd508dfd310e31c", "message": "test: historical plans", "committedDate": "2020-10-02T10:42:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgyMDQ2NA==", "url": "https://github.com/confluentinc/ksql/pull/6349#discussion_r498820464", "bodyText": "Is the thinking here that JSON works even if no key columns are specified, so we might as well always use JSON so that if a stream with no key columns is the source for a another stream/table down the line, then the sink stream/table will automatically get JSON as the key format, regardless of what the config default key format is?", "author": "vcrfxia", "createdAt": "2020-10-02T13:27:31Z", "path": "ksqldb-engine/src/main/java/io/confluent/ksql/serde/InternalFormats.java", "diffHunk": "@@ -50,10 +52,15 @@ private InternalFormats() {\n    * @see SerdeFeaturesFactory#buildInternal\n    */\n   public static Formats of(final KeyFormat keyFormat, final ValueFormat valueFormat) {\n+    // Do not use NONE format for internal topics:", "originalCommit": "451f166349180f7dc2048ae8afd508dfd310e31c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgyODYyNQ==", "url": "https://github.com/confluentinc/ksql/pull/6349#discussion_r498828625", "bodyText": "Perhaps I've missed it but I don't see any QTT for testing this. Can we add one in order to prevent regressions here?", "author": "vcrfxia", "createdAt": "2020-10-02T13:41:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgyMDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgzNzcyMg==", "url": "https://github.com/confluentinc/ksql/pull/6349#discussion_r498837722", "bodyText": "if no key columns are specified\n\nInternal topics always have a key column.\nThis is just stop-gap functionality. I'm working on better handling of internal key format in another PR.", "author": "big-andy-coates", "createdAt": "2020-10-02T13:56:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgyMDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg0MTI1OQ==", "url": "https://github.com/confluentinc/ksql/pull/6349#discussion_r498841259", "bodyText": "If that's the case, why would we ever arrive in this situation (of trying to build an internal topic with key format NONE)? Can we just fail if that happens, instead of converting the format to JSON?", "author": "vcrfxia", "createdAt": "2020-10-02T14:02:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgyMDQ2NA=="}], "type": "inlineReview"}, {"oid": "ce80465f860bad5d1b3cbff110310674e9384209", "url": "https://github.com/confluentinc/ksql/commit/ce80465f860bad5d1b3cbff110310674e9384209", "message": "Update docs/developer-guide/serialization.md\n\nCo-authored-by: Victoria Xia <victoria.f.xia281@gmail.com>", "committedDate": "2020-10-02T13:40:48Z", "type": "commit"}, {"oid": "6683779f8289fe5559415dd866097f298b1f92cb", "url": "https://github.com/confluentinc/ksql/commit/6683779f8289fe5559415dd866097f298b1f92cb", "message": "chore: requested changes", "committedDate": "2020-10-02T14:06:28Z", "type": "commit"}]}