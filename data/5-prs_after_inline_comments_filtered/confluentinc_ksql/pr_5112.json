{"pr_number": 5112, "pr_title": "refactor: Migrate server metadata endpoints", "pr_createdAt": "2020-04-20T08:51:34Z", "pr_url": "https://github.com/confluentinc/ksql/pull/5112", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcxOTY1Mg==", "url": "https://github.com/confluentinc/ksql/pull/5112#discussion_r412719652", "bodyText": "Why are these tests being removed?", "author": "vcrfxia", "createdAt": "2020-04-22T06:57:24Z", "path": "ksqldb-rest-app/src/test/java/io/confluent/ksql/rest/integration/RestApiTest.java", "diffHunk": "@@ -470,68 +488,6 @@ public void shouldFailToExecuteQueryUsingRestWithHttp2() throws Exception {\n     }\n   }\n \n-  @Test\n-  public void shouldExecuteStatementWithConnectionCloseHeaderHTTP1_1() throws Exception {", "originalCommit": "826e8301ef1688d766a8c7172505107b93f19183", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjc3ODk4MQ==", "url": "https://github.com/confluentinc/ksql/pull/5112#discussion_r412778981", "bodyText": "Because now there are no proxied http requests, and this tested proxy behaviour", "author": "purplefox", "createdAt": "2020-04-22T08:27:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcxOTY1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcxOTk1MA==", "url": "https://github.com/confluentinc/ksql/pull/5112#discussion_r412719950", "bodyText": "nit: rename to executeServerClusterId()", "author": "vcrfxia", "createdAt": "2020-04-22T06:57:55Z", "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/endpoints/KsqlServerEndpoints.java", "diffHunk": "@@ -219,6 +223,20 @@ public KsqlServerEndpoints(\n         .completedFuture(EndpointResponse.create(healthCheckResource.checkHealth()));\n   }\n \n+  @Override\n+  public CompletableFuture<EndpointResponse> executeServerMetadata(\n+      final ApiSecurityContext apiSecurityContext) {\n+    return CompletableFuture\n+        .completedFuture(EndpointResponse.create(serverMetadataResource.getServerMetadata()));\n+  }\n+\n+  @Override\n+  public CompletableFuture<EndpointResponse> executeServerMetadataClusterId(", "originalCommit": "826e8301ef1688d766a8c7172505107b93f19183", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjc4MTAzOQ==", "url": "https://github.com/confluentinc/ksql/pull/5112#discussion_r412781039", "bodyText": "I kind of like the current naming as it's clear it's from the metadata", "author": "purplefox", "createdAt": "2020-04-22T08:30:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcxOTk1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcyMDg3OA==", "url": "https://github.com/confluentinc/ksql/pull/5112#discussion_r412720878", "bodyText": "nit: let's keep naming consistent throughout? If we go with the suggestion of executeServerClusterId() in the previous comment, then should be makeServerClusterIdRequest(), and RestApiTest, KsqlRestClient, and KsqlTarget should also be updated accordingly.", "author": "vcrfxia", "createdAt": "2020-04-22T06:59:29Z", "path": "ksqldb-rest-app/src/test/java/io/confluent/ksql/rest/integration/RestIntegrationTestUtil.java", "diffHunk": "@@ -123,6 +125,28 @@ static CommandStatuses makeStatusesRequest(final TestKsqlRestApp restApp) {\n     }\n   }\n \n+  static ServerMetadata makeServerMetadataRequest(final TestKsqlRestApp restApp) {\n+    try (final KsqlRestClient restClient = restApp.buildKsqlClient(Optional.empty())) {\n+\n+      final RestResponse<ServerMetadata> res = restClient.getServerMetadata();\n+\n+      throwOnError(res);\n+\n+      return res.getResponse();\n+    }\n+  }\n+\n+  static ServerClusterId makeServerMetadataIdRequest(final TestKsqlRestApp restApp) {", "originalCommit": "826e8301ef1688d766a8c7172505107b93f19183", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cd6650c20ea208617abb3d0cbf99e9b745e17c1e", "url": "https://github.com/confluentinc/ksql/commit/cd6650c20ea208617abb3d0cbf99e9b745e17c1e", "message": "migrate sever metadata endpoints", "committedDate": "2020-04-22T07:26:11Z", "type": "forcePushed"}, {"oid": "489512d12d69ed2148d5972480b37a33d2cc0e38", "url": "https://github.com/confluentinc/ksql/commit/489512d12d69ed2148d5972480b37a33d2cc0e38", "message": "migrate sever metadata endpoints", "committedDate": "2020-04-22T08:25:59Z", "type": "commit"}, {"oid": "489512d12d69ed2148d5972480b37a33d2cc0e38", "url": "https://github.com/confluentinc/ksql/commit/489512d12d69ed2148d5972480b37a33d2cc0e38", "message": "migrate sever metadata endpoints", "committedDate": "2020-04-22T08:25:59Z", "type": "forcePushed"}]}