{"pr_number": 1005, "pr_title": "Improve Eth/64 compatibility", "pr_createdAt": "2020-05-29T18:02:53Z", "pr_url": "https://github.com/hyperledger/besu/pull/1005", "timeline": [{"oid": "326b9e9b39f1e0307bfa1ae6b28a035616b4fb2b", "url": "https://github.com/hyperledger/besu/commit/326b9e9b39f1e0307bfa1ae6b28a035616b4fb2b", "message": "Revert \"Handle backward compatibility for EIP-2124 fork id management (#981)\"\n\nThis reverts commit 1d8218ae\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2020-05-29T18:01:06Z", "type": "commit"}, {"oid": "28bcfa9120634bfb143475ade393c88612870b9b", "url": "https://github.com/hyperledger/besu/commit/28bcfa9120634bfb143475ade393c88612870b9b", "message": "Revert \"[EIP-2124] Backward compatible fork id management implementation (#979)\"\n\nThis reverts commit cb2c67d7\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2020-05-29T18:01:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY1NDM2Mg==", "url": "https://github.com/hyperledger/besu/pull/1005#discussion_r432654362", "bodyText": "Is this code comment still accurate if you delete the second part?", "author": "atoulme", "createdAt": "2020-05-29T18:10:54Z", "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/manager/ForkIdManager.java", "diffHunk": "@@ -121,50 +73,40 @@ public static ForkId readFrom(final RLPInput in) {\n    * @return boolean (peer valid (true) or invalid (false))\n    */\n   boolean peerCheck(final ForkId forkId) {\n-    return forkIDCheckers.stream().anyMatch(checker -> checker.check(forkId));\n-  }\n-\n-  private static ForkIDChecker eip2124(\n-      final Blockchain blockchain,\n-      final long forkNext,\n-      final List<ForkId> forkAndHashList,\n-      final long highestKnownFork) {\n-    return forkId -> {\n-      if (forkId == null) {\n-        return true; // Another method must be used to validate (i.e. genesis hash)\n-      }\n-      // Run the fork checksum validation rule set:\n-      //   1. If local and remote FORK_CSUM matches, connect.\n-      //        The two nodes are in the same fork state currently. They might know\n-      //        of differing future forks, but that's not relevant until the fork\n-      //        triggers (might be postponed, nodes might be updated to match).\n-      //   2. If the remote FORK_CSUM is a subset of the local past forks and the\n-      //      remote FORK_NEXT matches with the locally following fork block number,\n-      //      connect.\n-      //        Remote node is currently syncing. It might eventually diverge from\n-      //        us, but at this current point in time we don't have enough information.\n-      //   3. If the remote FORK_CSUM is a superset of the local past forks and can\n-      //      be completed with locally known future forks, connect.\n-      //        Local node is currently syncing. It might eventually diverge from\n-      //        the remote, but at this current point in time we don't have enough\n-      //        information.\n-      //   4. Reject in all other cases.\n-      if (isHashKnown(forkId.getHash(), forkAndHashList)) {\n-        if (blockchain.getChainHeadBlockNumber() < forkNext) {\n-          return true;\n+    if (forkId == null) {\n+      return true; // Another method must be used to validate (i.e. genesis hash)\n+    }\n+    // Run the fork checksum validation rule set:\n+    //   1. If local and remote FORK_CSUM matches, connect.", "originalCommit": "28bcfa9120634bfb143475ade393c88612870b9b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MTA1Nw==", "url": "https://github.com/hyperledger/besu/pull/1005#discussion_r432661057", "bodyText": "This is a full clean revert.  We can address stuff like this in another PR.", "author": "shemnon", "createdAt": "2020-05-29T18:23:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY1NDM2Mg=="}], "type": "inlineReview"}]}