{"pr_number": 1732, "pr_title": "Add BlockHash to WorldStateArchive query", "pr_createdAt": "2020-12-18T23:00:22Z", "pr_url": "https://github.com/hyperledger/besu/pull/1732", "timeline": [{"oid": "7d6d31bdc7cc29c7c11aabc55a1338727b7bc295", "url": "https://github.com/hyperledger/besu/commit/7d6d31bdc7cc29c7c11aabc55a1338727b7bc295", "message": "Add BlockHash to WorldStateArchive query\n\nBonsai tries will require storing state by block hash rather than by\nstate root.  To accommodate both forest mode and bonsai mode all state\nqueries will pass in both the block hash and state root.  This also\npermits parallel forest/bonsai modes for private state with bonsai\npublic state.\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2020-12-18T22:59:27Z", "type": "commit"}, {"oid": "ec828caa0fa6a09b78e7dc6676d89c9b4c887962", "url": "https://github.com/hyperledger/besu/commit/ec828caa0fa6a09b78e7dc6676d89c9b4c887962", "message": "bonsai archive\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2020-12-18T23:05:38Z", "type": "commit"}, {"oid": "32e47ad33eac6beb2ade7e39aeb38e3cd41374fd", "url": "https://github.com/hyperledger/besu/commit/32e47ad33eac6beb2ade7e39aeb38e3cd41374fd", "message": "extend to isWorldStateAvailable\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2020-12-18T23:11:50Z", "type": "commit"}, {"oid": "09ebcd84b10ed0274ce8699944a73e17dd2a2a41", "url": "https://github.com/hyperledger/besu/commit/09ebcd84b10ed0274ce8699944a73e17dd2a2a41", "message": "Merge branch 'master' into stateByBlockHash", "committedDate": "2021-01-05T06:58:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTgwMTA0OA==", "url": "https://github.com/hyperledger/besu/pull/1732#discussion_r551801048", "bodyText": "missing final for the blockHash field", "author": "matkt", "createdAt": "2021-01-05T09:05:59Z", "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/worldstate/WorldStateArchive.java", "diffHunk": "@@ -30,11 +30,11 @@\n public interface WorldStateArchive {\n   Hash EMPTY_ROOT_HASH = Hash.wrap(MerklePatriciaTrie.EMPTY_TRIE_NODE_HASH);\n \n-  Optional<WorldState> get(final Hash rootHash);\n+  Optional<WorldState> get(final Hash rootHash, Hash blockHash);\n \n-  boolean isWorldStateAvailable(final Hash rootHash);\n+  boolean isWorldStateAvailable(final Hash rootHash, Hash blockHash);", "originalCommit": "09ebcd84b10ed0274ce8699944a73e17dd2a2a41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjA3NDUzMg==", "url": "https://github.com/hyperledger/besu/pull/1732#discussion_r552074532", "bodyText": "For interfaces final on parameters has no impact (much like the public and abstract modifiers).  Rather than add additional finals I removed the ones that were not there.  A mix of final and non-final params is confusing.", "author": "shemnon", "createdAt": "2021-01-05T17:17:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTgwMTA0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTgwMTA3OQ==", "url": "https://github.com/hyperledger/besu/pull/1732#discussion_r551801079", "bodyText": "missing final for the blockHash field", "author": "matkt", "createdAt": "2021-01-05T09:06:03Z", "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/worldstate/WorldStateArchive.java", "diffHunk": "@@ -30,11 +30,11 @@\n public interface WorldStateArchive {\n   Hash EMPTY_ROOT_HASH = Hash.wrap(MerklePatriciaTrie.EMPTY_TRIE_NODE_HASH);\n \n-  Optional<WorldState> get(final Hash rootHash);\n+  Optional<WorldState> get(final Hash rootHash, Hash blockHash);", "originalCommit": "09ebcd84b10ed0274ce8699944a73e17dd2a2a41", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTgwMTE0Ng==", "url": "https://github.com/hyperledger/besu/pull/1732#discussion_r551801146", "bodyText": "missing final for the blockHash field", "author": "matkt", "createdAt": "2021-01-05T09:06:09Z", "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/worldstate/WorldStateArchive.java", "diffHunk": "@@ -30,11 +30,11 @@\n public interface WorldStateArchive {\n   Hash EMPTY_ROOT_HASH = Hash.wrap(MerklePatriciaTrie.EMPTY_TRIE_NODE_HASH);\n \n-  Optional<WorldState> get(final Hash rootHash);\n+  Optional<WorldState> get(final Hash rootHash, Hash blockHash);\n \n-  boolean isWorldStateAvailable(final Hash rootHash);\n+  boolean isWorldStateAvailable(final Hash rootHash, Hash blockHash);\n \n-  Optional<MutableWorldState> getMutable(final Hash rootHash);\n+  Optional<MutableWorldState> getMutable(final Hash rootHash, Hash blockHash);", "originalCommit": "09ebcd84b10ed0274ce8699944a73e17dd2a2a41", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3a38a175daf29ce03a5ea9c5a4eff767b409a1b1", "url": "https://github.com/hyperledger/besu/commit/3a38a175daf29ce03a5ea9c5a4eff767b409a1b1", "message": "Merge branch 'master' of github.com:hyperledger/besu into stateByBlockHash\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2021-01-05T17:11:11Z", "type": "commit"}, {"oid": "f549d6e14ca55776e0fdf24cfce0b034dca0dd84", "url": "https://github.com/hyperledger/besu/commit/f549d6e14ca55776e0fdf24cfce0b034dca0dd84", "message": "remove finals from interface\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2021-01-05T17:16:25Z", "type": "commit"}, {"oid": "3ffb07e89cd4134027c0ef3e1090359c77be5948", "url": "https://github.com/hyperledger/besu/commit/3ffb07e89cd4134027c0ef3e1090359c77be5948", "message": "Merge branch 'master' into stateByBlockHash", "committedDate": "2021-01-05T17:18:14Z", "type": "commit"}, {"oid": "13752c7a01daf26abe1a933308b773f7c99ad738", "url": "https://github.com/hyperledger/besu/commit/13752c7a01daf26abe1a933308b773f7c99ad738", "message": "Merge remote-tracking branch 'origin/stateByBlockHash' into stateByBlockHash\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2021-01-05T17:19:07Z", "type": "commit"}]}