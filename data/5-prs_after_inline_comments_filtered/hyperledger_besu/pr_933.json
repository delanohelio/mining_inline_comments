{"pr_number": 933, "pr_title": "Support rocks DBs in EVMTool", "pr_createdAt": "2020-05-15T19:41:22Z", "pr_url": "https://github.com/hyperledger/besu/pull/933", "timeline": [{"oid": "8cffe1e1909df45d3692ee283da3ea046c011a95", "url": "https://github.com/hyperledger/besu/commit/8cffe1e1909df45d3692ee283da3ea046c011a95", "message": "Support rocks DBs in EVMTool\n\nAllows the DB of a stopped node to be used for benchmarking.\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2020-05-15T19:38:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA1ODc5MQ==", "url": "https://github.com/hyperledger/besu/pull/933#discussion_r426058791", "bodyText": "Does this need to be a supplier? I think the db is only created when you call create", "author": "RatanRSur", "createdAt": "2020-05-15T21:38:21Z", "path": "ethereum/evmtool/src/main/java/org/hyperledger/besu/evmtool/DataStoreModule.java", "diffHunk": "@@ -17,25 +17,116 @@\n \n import org.hyperledger.besu.ethereum.chain.BlockchainStorage;\n import org.hyperledger.besu.ethereum.core.BlockHeaderFunctions;\n+import org.hyperledger.besu.ethereum.storage.keyvalue.KeyValueSegmentIdentifier;\n import org.hyperledger.besu.ethereum.storage.keyvalue.KeyValueStoragePrefixedKeyBlockchainStorage;\n+import org.hyperledger.besu.plugin.services.BesuConfiguration;\n+import org.hyperledger.besu.plugin.services.MetricsSystem;\n import org.hyperledger.besu.plugin.services.storage.KeyValueStorage;\n+import org.hyperledger.besu.plugin.services.storage.SegmentIdentifier;\n+import org.hyperledger.besu.plugin.services.storage.rocksdb.RocksDBKeyValueStorageFactory;\n+import org.hyperledger.besu.plugin.services.storage.rocksdb.RocksDBMetricsFactory;\n+import org.hyperledger.besu.plugin.services.storage.rocksdb.configuration.RocksDBCLIOptions;\n+import org.hyperledger.besu.services.kvstore.InMemoryKeyValueStorage;\n+import org.hyperledger.besu.services.kvstore.LimitedInMemoryKeyValueStorage;\n \n+import java.util.List;\n+import java.util.function.Supplier;\n+import javax.inject.Named;\n+import javax.inject.Singleton;\n+\n+import com.google.common.base.Suppliers;\n import dagger.Module;\n import dagger.Provides;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n \n-@SuppressWarnings(\"WeakerAccess\")\n+@SuppressWarnings({\"CloseableProvides\"})\n @Module(includes = GenesisFileModule.class)\n public class DataStoreModule {\n \n+  private static final Logger LOG = LogManager.getLogger();\n+  private final Supplier<RocksDBKeyValueStorageFactory> rocksDBFactory =", "originalCommit": "8cffe1e1909df45d3692ee283da3ea046c011a95", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA3OTE4Mw==", "url": "https://github.com/hyperledger/besu/pull/933#discussion_r426079183", "bodyText": "It's a supplier so we don't initialize it unless we actually need it.  @Lazy would be the lombok annotation.", "author": "shemnon", "createdAt": "2020-05-15T22:51:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA1ODc5MQ=="}], "type": "inlineReview"}, {"oid": "41235ab4cc7a62d80e6376f0574683cda7f6de03", "url": "https://github.com/hyperledger/besu/commit/41235ab4cc7a62d80e6376f0574683cda7f6de03", "message": "spotless\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>", "committedDate": "2020-05-15T22:49:53Z", "type": "commit"}, {"oid": "80391112028c372518d5827adda59bdfbedaa66d", "url": "https://github.com/hyperledger/besu/commit/80391112028c372518d5827adda59bdfbedaa66d", "message": "Merge branch 'master' into evmtool", "committedDate": "2020-05-15T22:52:20Z", "type": "commit"}]}