{"pr_number": 1326, "pr_title": "Implemented priv_debugGetStateRoot JSON RPC API.", "pr_createdAt": "2020-08-24T14:30:55Z", "pr_url": "https://github.com/hyperledger/besu/pull/1326", "timeline": [{"oid": "ab6e4dd3117e0a25570ba48e13715e2f9a5de541", "url": "https://github.com/hyperledger/besu/commit/ab6e4dd3117e0a25570ba48e13715e2f9a5de541", "message": "Implemented priv_debugGetStateRoot JSON RPC API.\n\nSigned-off-by: Mark Terry <mark.terry@consensys.net>", "committedDate": "2020-08-24T14:29:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkyMTcxMg==", "url": "https://github.com/hyperledger/besu/pull/1326#discussion_r475921712", "bodyText": "I am happy to see this refactor", "author": "macfarla", "createdAt": "2020-08-24T22:07:50Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/methods/PrivJsonRpcMethods.java", "diffHunk": "@@ -65,57 +66,44 @@ protected RpcApi getApiGroup() {\n   protected Map<String, JsonRpcMethod> create(\n       final PrivacyController privacyController,\n       final EnclavePublicKeyProvider enclavePublicKeyProvider) {\n-    if (getPrivacyParameters().isOnchainPrivacyGroupsEnabled()) {\n-      return mapOf(\n-          new PrivGetTransactionReceipt(\n-              getPrivacyParameters().getPrivateStateStorage(),\n-              privacyController,\n-              enclavePublicKeyProvider),\n-          new PrivGetPrivacyPrecompileAddress(getPrivacyParameters()),\n-          new PrivGetTransactionCount(privacyController, enclavePublicKeyProvider),\n-          new PrivGetPrivateTransaction(privacyController, enclavePublicKeyProvider),\n-          new PrivDistributeRawTransaction(\n-              privacyController,\n-              enclavePublicKeyProvider,\n-              getPrivacyParameters().isOnchainPrivacyGroupsEnabled()),\n-          new PrivCall(getBlockchainQueries(), privacyController, enclavePublicKeyProvider),\n-          new PrivGetCode(getBlockchainQueries(), privacyController, enclavePublicKeyProvider),\n-          new PrivGetLogs(\n-              getBlockchainQueries(),\n-              getPrivacyQueries(),\n-              privacyController,\n-              enclavePublicKeyProvider),\n-          new PrivNewFilter(filterManager, privacyController, enclavePublicKeyProvider),\n-          new PrivUninstallFilter(filterManager, privacyController, enclavePublicKeyProvider),\n-          new PrivGetFilterLogs(filterManager, privacyController, enclavePublicKeyProvider),\n-          new PrivGetFilterChanges(filterManager, privacyController, enclavePublicKeyProvider));\n-    } else {\n-      return mapOf(\n-          new PrivGetTransactionReceipt(\n-              getPrivacyParameters().getPrivateStateStorage(),\n-              privacyController,\n-              enclavePublicKeyProvider),\n-          new PrivCreatePrivacyGroup(privacyController, enclavePublicKeyProvider),\n-          new PrivDeletePrivacyGroup(privacyController, enclavePublicKeyProvider),\n-          new PrivFindPrivacyGroup(privacyController, enclavePublicKeyProvider),\n-          new PrivGetPrivacyPrecompileAddress(getPrivacyParameters()),\n-          new PrivGetTransactionCount(privacyController, enclavePublicKeyProvider),\n-          new PrivGetPrivateTransaction(privacyController, enclavePublicKeyProvider),\n-          new PrivDistributeRawTransaction(\n-              privacyController,\n-              enclavePublicKeyProvider,\n-              getPrivacyParameters().isOnchainPrivacyGroupsEnabled()),\n-          new PrivCall(getBlockchainQueries(), privacyController, enclavePublicKeyProvider),\n-          new PrivGetCode(getBlockchainQueries(), privacyController, enclavePublicKeyProvider),\n-          new PrivGetLogs(\n-              getBlockchainQueries(),\n-              getPrivacyQueries(),\n-              privacyController,\n-              enclavePublicKeyProvider),\n-          new PrivNewFilter(filterManager, privacyController, enclavePublicKeyProvider),\n-          new PrivUninstallFilter(filterManager, privacyController, enclavePublicKeyProvider),\n-          new PrivGetFilterLogs(filterManager, privacyController, enclavePublicKeyProvider),\n-          new PrivGetFilterChanges(filterManager, privacyController, enclavePublicKeyProvider));\n+\n+    final Map<String, JsonRpcMethod> RPC_METHODS =", "originalCommit": "ab6e4dd3117e0a25570ba48e13715e2f9a5de541", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkzNjE1Mw==", "url": "https://github.com/hyperledger/besu/pull/1326#discussion_r475936153", "bodyText": "adding a unit test would take it to next level", "author": "macfarla", "createdAt": "2020-08-24T22:47:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkyMTcxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk4NzM5Nw==", "url": "https://github.com/hyperledger/besu/pull/1326#discussion_r475987397", "bodyText": "The existing tests have good coverage of what I've changed. \ud83d\udc4d", "author": "mark-terry", "createdAt": "2020-08-25T00:10:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkyMTcxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzY3NzEyOQ==", "url": "https://github.com/hyperledger/besu/pull/1326#discussion_r477677129", "bodyText": "even better", "author": "macfarla", "createdAt": "2020-08-26T23:32:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkyMTcxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njg4MDI2MQ==", "url": "https://github.com/hyperledger/besu/pull/1326#discussion_r476880261", "bodyText": "Do we need to expose this method in this interface? Isn't it used internally?\nI recon we could just find the blockhash from the number inside getStateRootByBlockNumber() method.", "author": "lucassaldanha", "createdAt": "2020-08-25T23:51:09Z", "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/privacy/PrivacyController.java", "diffHunk": "@@ -100,5 +100,8 @@ void verifyPrivacyGroupContainsEnclavePublicKey(\n \n   PrivateTransactionSimulator getTransactionSimulator();\n \n-  Optional<Hash> getBlockHashByBlockNumber(Optional<Long> blockNumber);\n+  Optional<Hash> getBlockHashByBlockNumber(final Long blockNumber);", "originalCommit": "ab6e4dd3117e0a25570ba48e13715e2f9a5de541", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "55f9d8c2dd54bf2334959445c96364013bafe01a", "url": "https://github.com/hyperledger/besu/commit/55f9d8c2dd54bf2334959445c96364013bafe01a", "message": "PR fixes and improvements.\n\nSigned-off-by: Mark Terry <mark.terry@consensys.net>", "committedDate": "2020-08-26T03:13:03Z", "type": "commit"}, {"oid": "b388588dcbbf7ac77a0267ea697c576b619010bb", "url": "https://github.com/hyperledger/besu/commit/b388588dcbbf7ac77a0267ea697c576b619010bb", "message": "Merge branch 'master' into 764", "committedDate": "2020-08-26T10:01:58Z", "type": "commit"}, {"oid": "76de216d0977553743f70e2409138ac40dbd68e2", "url": "https://github.com/hyperledger/besu/commit/76de216d0977553743f70e2409138ac40dbd68e2", "message": "Changelog.\n\nSigned-off-by: Mark Terry <mark.terry@consensys.net>", "committedDate": "2020-08-26T10:17:34Z", "type": "commit"}, {"oid": "bc526e862660d92aa26d4794361ea7f16ea92596", "url": "https://github.com/hyperledger/besu/commit/bc526e862660d92aa26d4794361ea7f16ea92596", "message": "Changelog fix.\n\nSigned-off-by: Mark Terry <mark.terry@consensys.net>", "committedDate": "2020-08-26T23:38:38Z", "type": "commit"}, {"oid": "51cdadc8e9665d2e61791ff7aae95f024f2ea554", "url": "https://github.com/hyperledger/besu/commit/51cdadc8e9665d2e61791ff7aae95f024f2ea554", "message": "Merge branch 'master' into 764", "committedDate": "2020-08-26T23:40:14Z", "type": "commit"}]}