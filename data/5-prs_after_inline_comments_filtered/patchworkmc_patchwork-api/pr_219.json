{"pr_number": 219, "pr_title": "Update patchwork-gui", "pr_createdAt": "2020-12-27T04:41:31Z", "pr_url": "https://github.com/PatchworkMC/patchwork-api/pull/219", "timeline": [{"oid": "92c2c725f41311cd6e3509f524414fca8f08ac1c", "url": "https://github.com/PatchworkMC/patchwork-api/commit/92c2c725f41311cd6e3509f524414fca8f08ac1c", "message": "patchwork-gui 1.16.4 port", "committedDate": "2020-12-26T23:33:45Z", "type": "commit"}, {"oid": "5ec7bcde1f83612d83d8b53fabba22ff6d849d27", "url": "https://github.com/PatchworkMC/patchwork-api/commit/5ec7bcde1f83612d83d8b53fabba22ff6d849d27", "message": "Cleanup", "committedDate": "2020-12-27T02:33:08Z", "type": "commit"}, {"oid": "59acfa780af2fd05f0f25aab7e27b9a573fb74c7", "url": "https://github.com/PatchworkMC/patchwork-api/commit/59acfa780af2fd05f0f25aab7e27b9a573fb74c7", "message": "Checkstyle", "committedDate": "2020-12-27T03:41:14Z", "type": "commit"}, {"oid": "de2be3f5fbcae1491a047521d64bd08cd5868c63", "url": "https://github.com/PatchworkMC/patchwork-api/commit/de2be3f5fbcae1491a047521d64bd08cd5868c63", "message": "More cleanup", "committedDate": "2020-12-27T04:40:22Z", "type": "commit"}, {"oid": "f0559391df7d441acb5cfa80b30f9e37f01800ab", "url": "https://github.com/PatchworkMC/patchwork-api/commit/f0559391df7d441acb5cfa80b30f9e37f01800ab", "message": "Fix license violations", "committedDate": "2020-12-27T04:48:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTg0ODIwMA==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/219#discussion_r549848200", "bodyText": "Use the signature in the method target since this isn't a @Inject", "author": "TheGlitch76", "createdAt": "2020-12-29T21:11:18Z", "path": "patchwork-gui/src/main/java/net/patchworkmc/mixin/gui/MixinAbstractButtonWidget.java", "diffHunk": "@@ -21,52 +21,57 @@\n \n import org.spongepowered.asm.mixin.Mixin;\n import org.spongepowered.asm.mixin.Shadow;\n+import org.spongepowered.asm.mixin.Unique;\n import org.spongepowered.asm.mixin.injection.At;\n import org.spongepowered.asm.mixin.injection.ModifyVariable;\n \n import net.minecraft.client.gui.DrawableHelper;\n import net.minecraft.client.gui.widget.AbstractButtonWidget;\n \n+import net.patchworkmc.impl.gui.ForgeAbstractButtonWidget;\n+\n @Mixin(AbstractButtonWidget.class)\n-public abstract class MixinAbstractButtonWidget extends DrawableHelper {\n+public abstract class MixinAbstractButtonWidget extends DrawableHelper implements ForgeAbstractButtonWidget {\n \t@Shadow\n \tprotected int height;\n \n \t@Shadow\n \tpublic boolean active;\n \n-\t@Shadow\n-\tpublic abstract boolean isHovered();\n+\t@Unique\n+\tprivate static final int UNSET_FG_COLOR = -1;\n+\n+\t@Unique\n+\tprotected int packedFGColor = UNSET_FG_COLOR;\n \n-\tprotected int packedFGColor = 0;\n+\t@ModifyVariable(method = \"renderButton\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/client/gui/widget/AbstractButtonWidget;getMessage()Lnet/minecraft/text/Text;\", ordinal = 0), ordinal = 2)", "originalCommit": "f0559391df7d441acb5cfa80b30f9e37f01800ab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTg0ODMyNg==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/219#discussion_r549848326", "bodyText": "targetting all or just one?", "author": "TheGlitch76", "createdAt": "2020-12-29T21:11:53Z", "path": "patchwork-gui/src/main/java/net/patchworkmc/mixin/gui/MixinKeyboard.java", "diffHunk": "@@ -55,6 +57,7 @@ private void preKeyEvent(int i, boolean[] bls, ParentElement element, int key, i\n \t\t}\n \t}\n \n+\t@Dynamic(\"lambda in onKey\")\n \t@Inject(method = \"method_1454\", at = @At(\"RETURN\"))", "originalCommit": "f0559391df7d441acb5cfa80b30f9e37f01800ab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTg0ODQxMw==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/219#discussion_r549848413", "bodyText": "method signature in redirect", "author": "TheGlitch76", "createdAt": "2020-12-29T21:12:12Z", "path": "patchwork-gui/src/main/java/net/patchworkmc/mixin/gui/MixinKeyboard.java", "diffHunk": "@@ -74,26 +77,30 @@ private void postKeyEvent(int i, boolean[] bls, ParentElement element, int key,\n \t\t}\n \t}\n \n+\t@Dynamic(\"lambda in onChar\")\n \t@Inject(method = \"method_1458\", at = @At(\"HEAD\"), cancellable = true)\n \tprivate static void preCharTyped(Element element, int character, int mods, CallbackInfo info) {\n \t\tif (MinecraftForge.EVENT_BUS.post(new GuiScreenEvent.KeyboardCharTypedEvent.Pre((Screen) element, (char) character, mods))) {\n \t\t\tinfo.cancel();\n \t\t}\n \t}\n \n-\t@Redirect(method = \"method_1458\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/client/gui/Element;charTyped(CI)Z\"))\n+\t@Dynamic(\"lambda in onChar\")\n+\t@Redirect(method = \"method_1458\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/client/gui/Element;charTyped(CI)Z\", ordinal = 0))\n \tprivate static boolean charTyped(Element element, char character, int mods) {\n \t\treturn element.charTyped(character, mods) || MinecraftForge.EVENT_BUS.post(new GuiScreenEvent.KeyboardCharTypedEvent.Post((Screen) element, character, mods));\n \t}\n \n+\t@Dynamic(\"lambda in onChar\")\n \t@Inject(method = \"method_1473\", at = @At(\"HEAD\"), cancellable = true)\n \tprivate static void preCharTyped(Element element, char character, int mods, CallbackInfo info) {\n-\t\tif (MinecraftForge.EVENT_BUS.post(new GuiScreenEvent.KeyboardCharTypedEvent.Pre((Screen) element, (char) character, mods))) {\n+\t\tif (MinecraftForge.EVENT_BUS.post(new GuiScreenEvent.KeyboardCharTypedEvent.Pre((Screen) element, character, mods))) {\n \t\t\tinfo.cancel();\n \t\t}\n \t}\n \n-\t@Redirect(method = \"method_1473\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/client/gui/Element;charTyped(CI)Z\"))\n+\t@Dynamic(\"lambda in onChar\")\n+\t@Redirect(method = \"method_1473\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/client/gui/Element;charTyped(CI)Z\", ordinal = 0))", "originalCommit": "f0559391df7d441acb5cfa80b30f9e37f01800ab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ba9d663b888ec60d1e2f7c9a42b72504e9070298", "url": "https://github.com/PatchworkMC/patchwork-api/commit/ba9d663b888ec60d1e2f7c9a42b72504e9070298", "message": "Merge remote-tracking branch 'upstream/1.16.x' into port/patchwork-gui", "committedDate": "2020-12-29T21:21:19Z", "type": "commit"}, {"oid": "28b72cc7e02a0a1a9318a81e6d956febd88e79be", "url": "https://github.com/PatchworkMC/patchwork-api/commit/28b72cc7e02a0a1a9318a81e6d956febd88e79be", "message": "Fix mixin style", "committedDate": "2020-12-29T21:33:35Z", "type": "commit"}]}