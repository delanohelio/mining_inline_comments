{"pr_number": 963, "pr_title": "fabric-rendering-v1: Custom Armor Model & Texture", "pr_createdAt": "2020-07-28T14:37:45Z", "pr_url": "https://github.com/FabricMC/fabric/pull/963", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTgyNjk5MA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r461826990", "bodyText": "Honestly I think just implementing the interface and using the item's registry namespace and path would probably suffice over a whole method.", "author": "i509VCB", "createdAt": "2020-07-28T19:39:24Z", "path": "fabric-armor-api-v1/src/main/java/net/fabricmc/fabric/api/client/armor/v1/CustomTexturedArmor.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.armor.v1;\n+\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+\n+/**\n+ * Implement this interface on an Item which you would like to have a custom textured armor model.\n+ */\n+public interface CustomTexturedArmor {", "originalCommit": "8d838f520f48a69c9d6154516c9267977b48cb1b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkzMDY1NA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r463930654", "bodyText": "Well possibly, I may default the return value to the item registry namespace? Since I really want the customizability here without limiting due to the item registry namespace.\nIt will be useful for items that use the same texture (and maybe using the different UV).", "author": "shedaniel", "createdAt": "2020-08-01T06:38:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTgyNjk5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkzMjE2Mw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r463932163", "bodyText": "I could see a reason making the selected texture stack aware and slightly more contextual.", "author": "i509VCB", "createdAt": "2020-08-01T06:57:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTgyNjk5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTgzMjU3MA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r461832570", "bodyText": "Injection method doesn't describe very well what this does. Maybe selectArmorModel", "author": "i509VCB", "createdAt": "2020-07-28T19:46:17Z", "path": "fabric-armor-api-v1/src/main/java/net/fabricmc/fabric/mixin/armor/client/ArmorFeatureRendererMixin.java", "diffHunk": "@@ -0,0 +1,102 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.armor.client;\n+\n+import java.util.Map;\n+\n+import org.spongepowered.asm.mixin.Final;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.Shadow;\n+import org.spongepowered.asm.mixin.Unique;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n+\n+import net.minecraft.client.render.VertexConsumerProvider;\n+import net.minecraft.client.render.entity.feature.ArmorFeatureRenderer;\n+import net.minecraft.client.render.entity.feature.FeatureRenderer;\n+import net.minecraft.client.render.entity.feature.FeatureRendererContext;\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.client.util.math.MatrixStack;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ArmorItem;\n+import net.minecraft.item.ItemStack;\n+import net.minecraft.util.Identifier;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.client.armor.v1.CustomModeledArmor;\n+import net.fabricmc.fabric.api.client.armor.v1.CustomTexturedArmor;\n+\n+@Mixin(ArmorFeatureRenderer.class)\n+@Environment(EnvType.CLIENT)\n+public abstract class ArmorFeatureRendererMixin extends FeatureRenderer {\n+\t@Shadow\n+\t@Final\n+\tprivate static Map<String, Identifier> ARMOR_TEXTURE_CACHE;\n+\n+\tpublic ArmorFeatureRendererMixin(FeatureRendererContext context) {\n+\t\tsuper(context);\n+\t}\n+\n+\t@Unique\n+\tprivate LivingEntity storedEntity;\n+\tprivate EquipmentSlot storedSlot;\n+\n+\t@Inject(method = \"render\", at = @At(\"HEAD\"))\n+\tprivate void storeEntity(MatrixStack matrixStack, VertexConsumerProvider vertexConsumerProvider, int i, LivingEntity livingEntity, float f, float g, float h, float j, float k, float l, CallbackInfo ci) {\n+\t\tthis.storedEntity = livingEntity;\n+\t}\n+\n+\t@Inject(method = \"renderArmor\", at = @At(\"HEAD\"))\n+\tprivate void storeSlot(MatrixStack matrices, VertexConsumerProvider vertexConsumers, LivingEntity livingEntity, EquipmentSlot slot, int i, BipedEntityModel bipedEntityModel, CallbackInfo ci) {\n+\t\tthis.storedSlot = slot;\n+\t}\n+\n+\t@Inject(method = \"render\", at = @At(\"RETURN\"))\n+\tprivate void removeStored(MatrixStack matrixStack, VertexConsumerProvider vertexConsumerProvider, int i, LivingEntity livingEntity, float f, float g, float h, float j, float k, float l, CallbackInfo ci) {\n+\t\tthis.storedEntity = null;\n+\t\tthis.storedSlot = null;\n+\t}\n+\n+\t@Inject(method = \"getArmor\", at = @At(\"RETURN\"), cancellable = true)\n+\tprivate void getArmor(EquipmentSlot slot, CallbackInfoReturnable<BipedEntityModel<LivingEntity>> cir) {", "originalCommit": "8d838f520f48a69c9d6154516c9267977b48cb1b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0NTEyMA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465145120", "bodyText": "I dont think we should really have what should be client only interfaces like this, Vanilla is moving away from this (think render layers) a registry would be better IMO.", "author": "modmuss50", "createdAt": "2020-08-04T15:40:05Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/CustomModeledArmor.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+\n+/**\n+ * Implement this interface on an {@link net.minecraft.item.ArmorItem} which you would like to have a custom armor model.", "originalCommit": "227fa2687a2c94b94b62adde4978fb0760b94d01", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0NjY2NQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465146665", "bodyText": "think it's easier to have an interface, for example: BlockEntityClientSerializable, you don't want to have an registry for such a thing. since the armor models and textures might depend on the item itself, I think it is more simple and easier to have it be an interface.", "author": "shedaniel", "createdAt": "2020-08-04T15:42:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0NTEyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0Nzc1NA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465147754", "bodyText": "BlockEntityClientSerializable is for the server tho. A vanilla example of this is the BlockEntityRenderers, there is a clear speration between client and server code, without relaying on the annotations. A registry might make it easier for a mod to change the model of lets say the vanilla armor without requiring a mixin.", "author": "modmuss50", "createdAt": "2020-08-04T15:44:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0NTEyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0OTYyMw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465149623", "bodyText": "hmm true, I agree that it will be easier to change the vanilla armor that way. I will change this into a registry", "author": "shedaniel", "createdAt": "2020-08-04T15:46:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0NTEyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI1ODA4Mw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465258083", "bodyText": "I personally want to move away from the instance design of this. Personally I think we should make this entirely static so we chop off the INSTANCE call.\nAlso why is this itself an armor provider. That should really be impl detail.", "author": "i509VCB", "createdAt": "2020-08-04T18:49:24Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/CustomModeledArmorRegistry.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import net.minecraft.item.Item;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.CustomModeledArmorRegistryImpl;\n+\n+@Environment(EnvType.CLIENT)\n+public interface CustomModeledArmorRegistry extends CustomModeledArmorProvider {\n+\tCustomModeledArmorRegistry INSTANCE = CustomModeledArmorRegistryImpl.INSTANCE;", "originalCommit": "426b5940389b87e181ca41adbdb42947687feb24", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2NTEzNw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465265137", "bodyText": "Also why is this itself an armor provider. That should really be impl detail.\n\nwhy not, it's just duplicate methods, but if we are moving away from INSTANCE this can go", "author": "shedaniel", "createdAt": "2020-08-04T19:02:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI1ODA4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI1OTE1OA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465259158", "bodyText": "Why would you implement an interface meant for impl", "author": "i509VCB", "createdAt": "2020-08-04T18:51:21Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/CustomTexturedArmorRegistry.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import net.minecraft.item.Item;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.CustomTexturedArmorRegistryImpl;\n+\n+/**\n+ * Implement this interface on an {@link net.minecraft.item.ArmorItem} which you would like to have a custom armor model.", "originalCommit": "426b5940389b87e181ca41adbdb42947687feb24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI1OTYwMQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465259601", "bodyText": "I think a static method would suffice over the instance.", "author": "i509VCB", "createdAt": "2020-08-04T18:52:13Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/CustomTexturedArmorRegistry.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import net.minecraft.item.Item;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.CustomTexturedArmorRegistryImpl;\n+\n+/**\n+ * Implement this interface on an {@link net.minecraft.item.ArmorItem} which you would like to have a custom armor model.\n+ */\n+@Environment(EnvType.CLIENT)\n+public interface CustomTexturedArmorRegistry extends CustomTexturedArmorProvider {\n+\tCustomTexturedArmorRegistry INSTANCE = CustomTexturedArmorRegistryImpl.INSTANCE;", "originalCommit": "426b5940389b87e181ca41adbdb42947687feb24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2MDAxMA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465260010", "bodyText": "Maybe mixin to item and store the provider there to reduce the map.get calls", "author": "i509VCB", "createdAt": "2020-08-04T18:53:03Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/impl/client/item/CustomTexturedArmorRegistryImpl.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.client.item;\n+\n+import java.util.Map;\n+\n+import it.unimi.dsi.fastutil.objects.Reference2ObjectOpenHashMap;\n+\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.Item;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.fabric.api.client.item.v1.CustomTexturedArmorProvider;\n+import net.fabricmc.fabric.api.client.item.v1.CustomTexturedArmorRegistry;\n+\n+public final class CustomTexturedArmorRegistryImpl implements CustomTexturedArmorRegistry {\n+\tpublic static final CustomTexturedArmorRegistry INSTANCE = new CustomTexturedArmorRegistryImpl();\n+\tprivate final Map<Item, CustomTexturedArmorProvider> providerMap = new Reference2ObjectOpenHashMap<>();", "originalCommit": "426b5940389b87e181ca41adbdb42947687feb24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2MDM3Mg==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465260372", "bodyText": "I think we should mixin to item and store the model provided on items to reduce map.get calls", "author": "i509VCB", "createdAt": "2020-08-04T18:53:47Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/impl/client/item/CustomModeledArmorRegistryImpl.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.client.item;\n+\n+import java.util.Map;\n+\n+import it.unimi.dsi.fastutil.objects.Reference2ObjectOpenHashMap;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.Item;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.fabric.api.client.item.v1.CustomModeledArmorProvider;\n+import net.fabricmc.fabric.api.client.item.v1.CustomModeledArmorRegistry;\n+\n+public final class CustomModeledArmorRegistryImpl implements CustomModeledArmorRegistry {\n+\tpublic static final CustomModeledArmorRegistry INSTANCE = new CustomModeledArmorRegistryImpl();\n+\tprivate final Map<Item, CustomModeledArmorProvider> providerMap = new Reference2ObjectOpenHashMap<>();", "originalCommit": "426b5940389b87e181ca41adbdb42947687feb24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2MDY1MQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465260651", "bodyText": "What about duplicates, how should we handle those?", "author": "i509VCB", "createdAt": "2020-08-04T18:54:23Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/impl/client/item/CustomTexturedArmorRegistryImpl.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.client.item;\n+\n+import java.util.Map;\n+\n+import it.unimi.dsi.fastutil.objects.Reference2ObjectOpenHashMap;\n+\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.Item;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.fabric.api.client.item.v1.CustomTexturedArmorProvider;\n+import net.fabricmc.fabric.api.client.item.v1.CustomTexturedArmorRegistry;\n+\n+public final class CustomTexturedArmorRegistryImpl implements CustomTexturedArmorRegistry {\n+\tpublic static final CustomTexturedArmorRegistry INSTANCE = new CustomTexturedArmorRegistryImpl();\n+\tprivate final Map<Item, CustomTexturedArmorProvider> providerMap = new Reference2ObjectOpenHashMap<>();\n+\n+\tprivate CustomTexturedArmorRegistryImpl() {\n+\t}\n+\n+\t@Override\n+\tpublic void registerCustomArmorTexture(CustomTexturedArmorProvider provider, Item... items) {\n+\t\tfor (Item item : items) {\n+\t\t\tproviderMap.put(item, provider);", "originalCommit": "426b5940389b87e181ca41adbdb42947687feb24", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2NDgzNQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465264835", "bodyText": "we don't, the one registered last gets it", "author": "shedaniel", "createdAt": "2020-08-04T19:02:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2MDY1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2NTM3OQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465265379", "bodyText": "That somewhat seems like a load order battle", "author": "i509VCB", "createdAt": "2020-08-04T19:03:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2MDY1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2NzY4Ng==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r465267686", "bodyText": "you can't have two textures at the same time, also that's rare since usually you only edit your own item. If two mods edit the same vanilla item, you can't guarantee compatibility between them at all.", "author": "shedaniel", "createdAt": "2020-08-04T19:07:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2MDY1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzMyNA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r467483324", "bodyText": "I don't really know why you would want a null provider for this.", "author": "i509VCB", "createdAt": "2020-08-08T16:53:51Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/CustomModeledArmorRegistry.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.Item;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.CustomModeledArmorRegistryImpl;\n+\n+@Environment(EnvType.CLIENT)\n+public final class CustomModeledArmorRegistry {\n+\tprivate CustomModeledArmorRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerCustomArmorModel(/* @Nullable */ Provider provider, Item... items) {", "originalCommit": "5613af2f14698fa77211a4dcd2c66fbf408d17a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4Mzc2NQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r467483765", "bodyText": "to maybe unregister? I don't see a point to limit the api", "author": "shedaniel", "createdAt": "2020-08-08T16:58:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzMyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzUzMg==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r467483532", "bodyText": "I think we should use ItemConvertible here in case someone decides to make a literal armor block so you don't need an asItem call.", "author": "i509VCB", "createdAt": "2020-08-08T16:55:08Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/CustomModeledArmorRegistry.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.Item;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.CustomModeledArmorRegistryImpl;\n+\n+@Environment(EnvType.CLIENT)\n+public final class CustomModeledArmorRegistry {\n+\tprivate CustomModeledArmorRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerCustomArmorModel(/* @Nullable */ Provider provider, Item... items) {", "originalCommit": "5613af2f14698fa77211a4dcd2c66fbf408d17a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzY4NA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r467483684", "bodyText": "I think you should null check the items varargs.", "author": "i509VCB", "createdAt": "2020-08-08T16:57:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzUzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4Mzc4OQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r467483789", "bodyText": "True", "author": "shedaniel", "createdAt": "2020-08-08T16:58:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzUzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4NDQ2NQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r467484465", "bodyText": "the null check can implicitly happen when iterating", "author": "liach", "createdAt": "2020-08-08T17:06:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzUzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzYxMw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r467483613", "bodyText": "Like the other api class, same questions", "author": "i509VCB", "createdAt": "2020-08-08T16:56:22Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/CustomTexturedArmorRegistry.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.Item;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.CustomTexturedArmorRegistryImpl;\n+\n+@Environment(EnvType.CLIENT)\n+public final class CustomTexturedArmorRegistry {\n+\tprivate CustomTexturedArmorRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom texture models for an item.\n+\t *\n+\t * @param provider the provider for the texture\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerCustomArmorTexture(/* @Nullable */ Provider provider, Item... items) {", "originalCommit": "5613af2f14698fa77211a4dcd2c66fbf408d17a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzcxNA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r467483714", "bodyText": "Would there be a specific reason you'd want to register the same armor model to several items at once?", "author": "i509VCB", "createdAt": "2020-08-08T16:57:33Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/CustomModeledArmorRegistry.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.Item;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.CustomModeledArmorRegistryImpl;\n+\n+@Environment(EnvType.CLIENT)\n+public final class CustomModeledArmorRegistry {\n+\tprivate CustomModeledArmorRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerCustomArmorModel(/* @Nullable */ Provider provider, Item... items) {", "originalCommit": "5613af2f14698fa77211a4dcd2c66fbf408d17a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzgyMw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r467483823", "bodyText": "It's not the same model, it's a model provider.", "author": "shedaniel", "createdAt": "2020-08-08T16:59:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MzcxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAxMjkyMw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r469012923", "bodyText": "Mark method or interface as client only", "author": "i509VCB", "createdAt": "2020-08-12T05:27:32Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/CustomModeledArmorRegistry.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+import java.util.Objects;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ItemConvertible;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.CustomModeledArmorRegistryImpl;\n+\n+@Environment(EnvType.CLIENT)\n+public final class CustomModeledArmorRegistry {\n+\tprivate CustomModeledArmorRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerCustomArmorModel(/* @Nullable */ Provider provider, ItemConvertible... items) {\n+\t\tregisterCustomArmorModel(provider, Arrays.asList(items));\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerCustomArmorModel(/* @Nullable */ Provider provider, Iterable<ItemConvertible> items) {\n+\t\tCustomModeledArmorRegistryImpl.registerCustomArmorModel(provider, Objects.requireNonNull(items));\n+\t}\n+\n+\t/**\n+\t * Gets the model of the armor piece.\n+\t *\n+\t * @param entity       The entity equipping the armor\n+\t * @param stack        The item stack of the armor\n+\t * @param slot         The slot which the armor is in\n+\t * @param defaultModel The default model that vanilla provides\n+\t * @return The model of the armor piece. Should never be null.\n+\t */\n+\tpublic static BipedEntityModel<LivingEntity> getCustomArmorModel(LivingEntity entity, ItemStack stack, EquipmentSlot slot, BipedEntityModel<LivingEntity> defaultModel) {\n+\t\treturn CustomModeledArmorRegistryImpl.getCustomArmorModel(entity, stack, slot, defaultModel);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface Provider {\n+\t\t/**\n+\t\t * Gets the model of the armor piece.\n+\t\t *\n+\t\t * @param entity       The entity equipping the armor\n+\t\t * @param stack        The item stack of the armor\n+\t\t * @param slot         The slot which the armor is in\n+\t\t * @param defaultModel The default model that vanilla provides\n+\t\t * @return The model of the armor piece. Should never be null.\n+\t\t */\n+\t\tBipedEntityModel<LivingEntity> getCustomArmorModel(LivingEntity entity, ItemStack stack, EquipmentSlot slot, BipedEntityModel<LivingEntity> defaultModel);", "originalCommit": "04b33ac4e25a5c4ef69e4be36a1af4ee2edb7f0e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyMDg2OQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471620869", "bodyText": "No optional closing tags, opening tag in the same line without space please.", "author": "sfPlayer1", "createdAt": "2020-08-17T17:07:07Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/ArmorModelRegistry.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+import java.util.Objects;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ItemConvertible;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.ArmorModelRegistryImpl;\n+\n+/**\n+ * A class for registering custom armor models for {@link ItemConvertible}, to be provided by a {@link Provider}.\n+ *\n+ * <p>\n+ * This can be used to replace existing vanilla armor models conditionally, however each {@link net.minecraft.item.Item}\n+ * instance can only allow one {@link Provider}.\n+ * </p>", "originalCommit": "47a5c6496b9db43fe2a64852c313f951af33eacc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyMzA0Mg==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471623042", "bodyText": "Not sure about using ItemConvertible over Item. Blocks are unusual for armor and for the rare exception the caller can convert easily. Item may be less confusing. The implementation mandates ArmorItem, so maybe we should use/require that in the API as well.", "author": "sfPlayer1", "createdAt": "2020-08-17T17:09:02Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/ArmorModelRegistry.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+import java.util.Objects;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ItemConvertible;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.ArmorModelRegistryImpl;\n+\n+/**\n+ * A class for registering custom armor models for {@link ItemConvertible}, to be provided by a {@link Provider}.\n+ *\n+ * <p>\n+ * This can be used to replace existing vanilla armor models conditionally, however each {@link net.minecraft.item.Item}\n+ * instance can only allow one {@link Provider}.\n+ * </p>\n+ */\n+@Environment(EnvType.CLIENT)\n+public final class ArmorModelRegistry {\n+\tprivate ArmorModelRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void register(/* @Nullable */ Provider provider, ItemConvertible... items) {", "originalCommit": "47a5c6496b9db43fe2a64852c313f951af33eacc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY2ODYzMA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471668630", "bodyText": "Hmm, can't carved pumpkins be used as armor", "author": "liach", "createdAt": "2020-08-17T18:06:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyMzA0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY3MTExMA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471671110", "bodyText": "Carved pumpkins aren't armor but BlockItems and they use their item model instead of an armor model (this behavior is probably specific to the head slot).", "author": "Juuxel", "createdAt": "2020-08-17T18:10:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyMzA0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY3MTg1MQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471671851", "bodyText": "The instrumented code starts with if (itemStack.getItem() instanceof ArmorItem) {", "author": "sfPlayer1", "createdAt": "2020-08-17T18:12:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyMzA0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY3NDE0MQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471674141", "bodyText": "More precisely, the pumpkin or worn heads use separate feature renderers that aren't covered by this PR.", "author": "sfPlayer1", "createdAt": "2020-08-17T18:16:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyMzA0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyNDYyMA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471624620", "bodyText": "We concluded in Discord to put this in the rendering module.", "author": "sfPlayer1", "createdAt": "2020-08-17T17:10:21Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/ArmorModelRegistry.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;", "originalCommit": "47a5c6496b9db43fe2a64852c313f951af33eacc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyNjc2MA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471626760", "bodyText": "We usually check preconditions first, then blank line, then implementation.", "author": "sfPlayer1", "createdAt": "2020-08-17T17:12:11Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/ArmorModelRegistry.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+import java.util.Objects;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ItemConvertible;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.ArmorModelRegistryImpl;\n+\n+/**\n+ * A class for registering custom armor models for {@link ItemConvertible}, to be provided by a {@link Provider}.\n+ *\n+ * <p>\n+ * This can be used to replace existing vanilla armor models conditionally, however each {@link net.minecraft.item.Item}\n+ * instance can only allow one {@link Provider}.\n+ * </p>\n+ */\n+@Environment(EnvType.CLIENT)\n+public final class ArmorModelRegistry {\n+\tprivate ArmorModelRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void register(/* @Nullable */ Provider provider, ItemConvertible... items) {\n+\t\tregister(provider, Arrays.asList(items));\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void register(/* @Nullable */ Provider provider, Iterable<ItemConvertible> items) {\n+\t\tArmorModelRegistryImpl.register(provider, Objects.requireNonNull(items));", "originalCommit": "47a5c6496b9db43fe2a64852c313f951af33eacc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY3NDU2OA==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471674568", "bodyText": "Not documented in conventions. Will add that to doc for future.", "author": "i509VCB", "createdAt": "2020-08-17T18:17:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyNjc2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyOTM0Nw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471629347", "bodyText": "Objects.requireNonNull use is inconsistent wrt relying on later rejection or not, in this case the implementation would crash already.", "author": "sfPlayer1", "createdAt": "2020-08-17T17:14:17Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/ArmorTextureRegistry.java", "diffHunk": "@@ -0,0 +1,100 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+import java.util.Objects;\n+\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ItemConvertible;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.ArmorTextureRegistryImpl;\n+\n+/**\n+ * A class for registering custom armor textures for {@link ItemConvertible}, to be provided by a {@link Provider}.\n+ *\n+ * <p>\n+ * This can be used to replace existing vanilla armor textures conditionally, however each {@link net.minecraft.item.Item}\n+ * instance can only allow one {@link Provider}.\n+ * </p>\n+ *\n+ * <p>\n+ * Since armor textures identifier in vanilla is hardcoded to be in the {@code minecraft} namespace, this registry can also be\n+ * used to use a custom namespace if desired.\n+ * </p>\n+ */\n+@Environment(EnvType.CLIENT)\n+public final class ArmorTextureRegistry {\n+\tprivate ArmorTextureRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom texture models for an item.\n+\t *\n+\t * @param provider the provider for the texture\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void register(/* @Nullable */ Provider provider, ItemConvertible... items) {\n+\t\tregister(provider, Arrays.asList(items));\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom texture models for an item.\n+\t *\n+\t * @param provider the provider for the texture\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void register(/* @Nullable */ Provider provider, Iterable<ItemConvertible> items) {\n+\t\tArmorTextureRegistryImpl.register(provider, Objects.requireNonNull(items));", "originalCommit": "47a5c6496b9db43fe2a64852c313f951af33eacc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYzMjI3MQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471632271", "bodyText": "This needs more documentation on how models and textures relate to each other.\nThe suggestion around replacing vanilla armor should be more like a warning along the lines of \"While this can be used to replace vanilla armor, there can be only one replacement at a time, causing potential conflicts with other mods. Consider using a separate item instead.\"\nArmor models and texture are so tightly connected that a single ArmorRenderingRegistry class may be more appropriate.\nIMO we should also offer a wider hook that effectively replaces all of renderArmor() with a handler for more invasive customization.", "author": "sfPlayer1", "createdAt": "2020-08-17T17:16:38Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/ArmorTextureRegistry.java", "diffHunk": "@@ -0,0 +1,100 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+import java.util.Objects;\n+\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ItemConvertible;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.ArmorTextureRegistryImpl;\n+\n+/**\n+ * A class for registering custom armor textures for {@link ItemConvertible}, to be provided by a {@link Provider}.\n+ *\n+ * <p>\n+ * This can be used to replace existing vanilla armor textures conditionally, however each {@link net.minecraft.item.Item}\n+ * instance can only allow one {@link Provider}.\n+ * </p>\n+ *\n+ * <p>\n+ * Since armor textures identifier in vanilla is hardcoded to be in the {@code minecraft} namespace, this registry can also be\n+ * used to use a custom namespace if desired.\n+ * </p>", "originalCommit": "47a5c6496b9db43fe2a64852c313f951af33eacc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjcyOTEyMw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r486729123", "bodyText": "IMO we should also offer a wider hook that effectively replaces all of renderArmor() with a handler for more invasive customization.\n\nThe BipedEntityModel should be possible to be entirely customized, you can completely rip out BipedEntityModel#render.", "author": "shedaniel", "createdAt": "2020-09-11T02:00:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYzMjI3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY2MDQ2Nw==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r471660467", "bodyText": "I don't think we should pass secondLayer like that while also supplying the slot. It is just a weird artefact of MC's implementation. Likewise suffix should probably be replaced with boolean overlay to denote the 2nd render pass without dye.\nWe could instead supply the full vanilla path in the textures/models/armor/[..]_layer_[..].png form to make this easy for namespace replacement use cases, the proposed ArmorModelRegistry already does something similar with defaultModel.", "author": "sfPlayer1", "createdAt": "2020-08-17T17:52:03Z", "path": "fabric-item-api-v1/src/main/java/net/fabricmc/fabric/api/client/item/v1/ArmorTextureRegistry.java", "diffHunk": "@@ -0,0 +1,100 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.item.v1;\n+\n+import java.util.Arrays;\n+import java.util.Objects;\n+\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ItemConvertible;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.item.ArmorTextureRegistryImpl;\n+\n+/**\n+ * A class for registering custom armor textures for {@link ItemConvertible}, to be provided by a {@link Provider}.\n+ *\n+ * <p>\n+ * This can be used to replace existing vanilla armor textures conditionally, however each {@link net.minecraft.item.Item}\n+ * instance can only allow one {@link Provider}.\n+ * </p>\n+ *\n+ * <p>\n+ * Since armor textures identifier in vanilla is hardcoded to be in the {@code minecraft} namespace, this registry can also be\n+ * used to use a custom namespace if desired.\n+ * </p>\n+ */\n+@Environment(EnvType.CLIENT)\n+public final class ArmorTextureRegistry {\n+\tprivate ArmorTextureRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom texture models for an item.\n+\t *\n+\t * @param provider the provider for the texture\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void register(/* @Nullable */ Provider provider, ItemConvertible... items) {\n+\t\tregister(provider, Arrays.asList(items));\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom texture models for an item.\n+\t *\n+\t * @param provider the provider for the texture\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void register(/* @Nullable */ Provider provider, Iterable<ItemConvertible> items) {\n+\t\tArmorTextureRegistryImpl.register(provider, Objects.requireNonNull(items));\n+\t}\n+\n+\t/**\n+\t * Gets the armor texture identifier in string, to be converted to {@link net.minecraft.util.Identifier}.\n+\t *\n+\t * @param entity      The entity equipping the armor\n+\t * @param stack       The item stack of the armor\n+\t * @param slot        The slot which the armor is in\n+\t * @param secondLayer Whether the texture should use the second layer, only true when the {@code slot} is {@link EquipmentSlot#LEGS}\n+\t * @param suffix      The nullable suffix of the texture, may be \"overlay\" in vanilla when the item is {@link net.minecraft.item.DyeableArmorItem}\n+\t * @return the custom armor texture identifier, return null to use the vanilla ones. Defaulted to the item's registry id.\n+\t */\n+\t/* @Nullable */\n+\tpublic static String getArmorTexture(LivingEntity entity, ItemStack stack, EquipmentSlot slot, boolean secondLayer, /* @Nullable */  String suffix) {\n+\t\treturn ArmorTextureRegistryImpl.getArmorTexture(entity, stack, slot, secondLayer, suffix);\n+\t}\n+\n+\t@FunctionalInterface\n+\t@Environment(EnvType.CLIENT)\n+\tpublic interface Provider {\n+\t\t/**\n+\t\t * Gets the armor texture identifier in string, to be converted to {@link net.minecraft.util.Identifier}.\n+\t\t *\n+\t\t * @param entity      The entity equipping the armor\n+\t\t * @param stack       The item stack of the armor\n+\t\t * @param slot        The slot which the armor is in\n+\t\t * @param secondLayer Whether the texture should use the second layer, only true when the {@code slot} is {@link EquipmentSlot#LEGS}", "originalCommit": "47a5c6496b9db43fe2a64852c313f951af33eacc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cd1788978200b856b71b95e16165d3098bb6c2e9", "url": "https://github.com/FabricMC/fabric/commit/cd1788978200b856b71b95e16165d3098bb6c2e9", "message": "Moving testmod id to rendering-v1\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nMoving testmod to rendering-v1\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nReviews\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nprefix the extensions with armor\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nchange name\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\ndrop custom\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nthing\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\njavadocs\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nfix imports\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nforgot to do asItem\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nadd null checks and convert to ItemConvertible\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nfix license\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\ndid thing\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nit now compiles\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nchange to a registry\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nadd @Unique\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nmigrate to fabric-item-api-v1\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\ndid some renaming and improvements\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\ndon't need that\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\narmor\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T01:32:14Z", "type": "forcePushed"}, {"oid": "cd1788978200b856b71b95e16165d3098bb6c2e9", "url": "https://github.com/FabricMC/fabric/commit/cd1788978200b856b71b95e16165d3098bb6c2e9", "message": "Moving testmod id to rendering-v1\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nMoving testmod to rendering-v1\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nReviews\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nprefix the extensions with armor\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nchange name\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\ndrop custom\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nthing\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\njavadocs\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nfix imports\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nforgot to do asItem\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nadd null checks and convert to ItemConvertible\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nfix license\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\ndid thing\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nit now compiles\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nchange to a registry\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nadd @Unique\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\nmigrate to fabric-item-api-v1\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\ndid some renaming and improvements\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\ndon't need that\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>\n\narmor\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T01:32:14Z", "type": "commit"}, {"oid": "0c75fcf70cd8854f272d48d549098c2802fe0b51", "url": "https://github.com/FabricMC/fabric/commit/0c75fcf70cd8854f272d48d549098c2802fe0b51", "message": "add license to CustomArmorTests\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T01:33:51Z", "type": "commit"}, {"oid": "06aa8b9875296849ff22cca555a8c637f267276c", "url": "https://github.com/FabricMC/fabric/commit/06aa8b9875296849ff22cca555a8c637f267276c", "message": "Add @Nullable annotations and fix compile\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T01:43:10Z", "type": "commit"}, {"oid": "9df57a43587f2ae463d192560b01d57e8342369c", "url": "https://github.com/FabricMC/fabric/commit/9df57a43587f2ae463d192560b01d57e8342369c", "message": "javadoc\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T02:02:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE2NDQxOQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r491164419", "bodyText": "Missed annotation comment?", "author": "NinjaPhenix", "createdAt": "2020-09-18T20:04:17Z", "path": "fabric-rendering-v1/src/main/java/net/fabricmc/fabric/api/client/rendering/v1/ArmorRenderingRegistry.java", "diffHunk": "@@ -0,0 +1,149 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.rendering.v1;\n+\n+import java.util.Arrays;\n+\n+import org.jetbrains.annotations.NotNull;\n+import org.jetbrains.annotations.Nullable;\n+\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.Item;\n+import net.minecraft.item.ItemStack;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.impl.client.rendering.ArmorRenderingRegistryImpl;\n+\n+/**\n+ * A class for registering custom armor models and textures for {@link Item}, to be provided by a {@link ModelProvider} or {@link TextureProvider}.\n+ *\n+ * <p>This can be used to replace existing vanilla armor models and textures conditionally, however each {@link Item}\n+ * instance can only allow one {@link ModelProvider} or {@link TextureProvider} respectively, causing potential conflicts\n+ * with other mods if you replace the model or texture for vanilla items. Consider using a separate item instead.</p>\n+ *\n+ * <p>A custom model would probably also require a custom texture to go along it, the model will use the vanilla texture if it is undefined.</p>\n+ *\n+ * <p>Since armor textures identifier in vanilla is hardcoded to be in the {@code minecraft} namespace, this registry can also be\n+ * used to use a custom namespace if desired.</p>\n+ */\n+@Environment(EnvType.CLIENT)\n+public final class ArmorRenderingRegistry {\n+\tprivate ArmorRenderingRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerModel(@Nullable ModelProvider provider, Item... items) {\n+\t\tregisterModel(provider, Arrays.asList(items));\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom armor models for an item.\n+\t *\n+\t * @param provider the provider for the model\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerModel(@Nullable ModelProvider provider, Iterable<Item> items) {\n+\t\tArmorRenderingRegistryImpl.registerModel(provider, items);\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom texture models for an item.\n+\t *\n+\t * @param provider the provider for the texture\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerTexture(@Nullable TextureProvider provider, Item... items) {\n+\t\tregisterTexture(provider, Arrays.asList(items));\n+\t}\n+\n+\t/**\n+\t * Registers a provider for custom texture models for an item.\n+\t *\n+\t * @param provider the provider for the texture\n+\t * @param items    the items to be registered for\n+\t */\n+\tpublic static void registerTexture(@Nullable TextureProvider provider, Iterable<Item> items) {\n+\t\tArmorRenderingRegistryImpl.registerTexture(provider, items);\n+\t}\n+\n+\t/**\n+\t * Gets the model of the armor piece.\n+\t *\n+\t * @param entity       The entity equipping the armor\n+\t * @param stack        The item stack of the armor\n+\t * @param slot         The slot which the armor is in\n+\t * @param defaultModel The default model that vanilla provides\n+\t * @return The model of the armor piece. Should never be null.\n+\t */\n+\tpublic static BipedEntityModel<LivingEntity> getArmorModel(LivingEntity entity, ItemStack stack, EquipmentSlot slot, BipedEntityModel<LivingEntity> defaultModel) {\n+\t\treturn ArmorRenderingRegistryImpl.getArmorModel(entity, stack, slot, defaultModel);\n+\t}\n+\n+\t/**\n+\t * Gets the armor texture identifier in string, to be converted to {@link net.minecraft.util.Identifier}.\n+\t *\n+\t * @param entity         The entity equipping the armor\n+\t * @param stack          The item stack of the armor\n+\t * @param slot           The slot which the armor is in\n+\t * @param defaultTexture The default vanilla texture identifier\n+\t * @return the custom armor texture identifier, return null to use the vanilla ones. Defaulted to the item's registry id.\n+\t */\n+\t/* @Nullable */", "originalCommit": "9df57a43587f2ae463d192560b01d57e8342369c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE2NDk0OQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r491164949", "bodyText": "Two missed annotation comments", "author": "NinjaPhenix", "createdAt": "2020-09-18T20:05:32Z", "path": "fabric-rendering-v1/src/main/java/net/fabricmc/fabric/impl/client/rendering/ArmorProviderExtensions.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.client.rendering;\n+\n+import net.fabricmc.fabric.api.client.rendering.v1.ArmorRenderingRegistry;\n+\n+public interface ArmorProviderExtensions {\n+\t/* @Nullable */", "originalCommit": "9df57a43587f2ae463d192560b01d57e8342369c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7289945d528745cf1167e458e2c4910bb82dceee", "url": "https://github.com/FabricMC/fabric/commit/7289945d528745cf1167e458e2c4910bb82dceee", "message": "Fix reviews\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-10-10T17:40:19Z", "type": "commit"}, {"oid": "999562ac563d5ecf1f7f9edeedb8a9f93c31e624", "url": "https://github.com/FabricMC/fabric/commit/999562ac563d5ecf1f7f9edeedb8a9f93c31e624", "message": "Merge remote-tracking branch 'fabric/1.16' into armor\n\n# Conflicts:\n#\tfabric-rendering-v1/build.gradle", "committedDate": "2020-10-10T17:40:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ1NTcyNQ==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r503455725", "bodyText": "This (client) mod initializer registers items, meaning that it is not dedicated server compatible. It would be very simple to split this into two initializers in case someone would like to test this with a server.", "author": "JamiesWhiteShirt", "createdAt": "2020-10-12T18:08:28Z", "path": "fabric-rendering-v1/src/testmod/java/net/fabricmc/fabric/test/rendering/client/CustomArmorTests.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.test.rendering.client;\n+\n+import java.util.Collections;\n+\n+import net.minecraft.client.model.ModelPart;\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ArmorItem;\n+import net.minecraft.item.ArmorMaterials;\n+import net.minecraft.item.Item;\n+import net.minecraft.item.ItemGroup;\n+import net.minecraft.util.Identifier;\n+import net.minecraft.util.registry.Registry;\n+\n+import net.fabricmc.api.ClientModInitializer;\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.client.rendering.v1.ArmorRenderingRegistry;\n+\n+@Environment(EnvType.CLIENT)\n+public class CustomArmorTests implements ClientModInitializer {", "originalCommit": "999562ac563d5ecf1f7f9edeedb8a9f93c31e624", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzE4OTMyNg==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r507189326", "bodyText": "Good point, IMO this is a blocker for merging.", "author": "modmuss50", "createdAt": "2020-10-18T17:24:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ1NTcyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ2MDg4Mg==", "url": "https://github.com/FabricMC/fabric/pull/963#discussion_r503460882", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tString model = ArmorRenderingRegistry.getArmorTexture(storedEntity, storedEntity.getEquippedStack(storedSlot), storedSlot, vanillaIdentifier);\n          \n          \n            \n            \n          \n          \n            \n            \t\tif (!Objects.equals(model, vanillaIdentifier)) {\n          \n          \n            \n            \t\t\tcir.setReturnValue(ARMOR_TEXTURE_CACHE.computeIfAbsent(model, Identifier::new));\n          \n          \n            \n            \t\tString texture = ArmorRenderingRegistry.getArmorTexture(storedEntity, storedEntity.getEquippedStack(storedSlot), storedSlot, vanillaIdentifier);\n          \n          \n            \n            \n          \n          \n            \n            \t\tif (!Objects.equals(texture, vanillaIdentifier)) {\n          \n          \n            \n            \t\t\tcir.setReturnValue(ARMOR_TEXTURE_CACHE.computeIfAbsent(texture, Identifier::new));", "author": "JamiesWhiteShirt", "createdAt": "2020-10-12T18:17:39Z", "path": "fabric-rendering-v1/src/main/java/net/fabricmc/fabric/mixin/client/rendering/MixinArmorFeatureRenderer.java", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.client.rendering;\n+\n+import java.util.Map;\n+import java.util.Objects;\n+\n+import org.spongepowered.asm.mixin.Final;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.Shadow;\n+import org.spongepowered.asm.mixin.Unique;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n+import org.spongepowered.asm.mixin.injection.callback.LocalCapture;\n+\n+import net.minecraft.client.render.VertexConsumerProvider;\n+import net.minecraft.client.render.entity.feature.ArmorFeatureRenderer;\n+import net.minecraft.client.render.entity.feature.FeatureRenderer;\n+import net.minecraft.client.render.entity.feature.FeatureRendererContext;\n+import net.minecraft.client.render.entity.model.BipedEntityModel;\n+import net.minecraft.client.util.math.MatrixStack;\n+import net.minecraft.entity.EquipmentSlot;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.item.ArmorItem;\n+import net.minecraft.item.ItemStack;\n+import net.minecraft.util.Identifier;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.client.rendering.v1.ArmorRenderingRegistry;\n+\n+@Mixin(ArmorFeatureRenderer.class)\n+@Environment(EnvType.CLIENT)\n+public abstract class MixinArmorFeatureRenderer extends FeatureRenderer {\n+\t@Shadow\n+\t@Final\n+\tprivate static Map<String, Identifier> ARMOR_TEXTURE_CACHE;\n+\n+\tpublic MixinArmorFeatureRenderer(FeatureRendererContext context) {\n+\t\tsuper(context);\n+\t}\n+\n+\t@Unique\n+\tprivate LivingEntity storedEntity;\n+\t@Unique\n+\tprivate EquipmentSlot storedSlot;\n+\n+\t@Inject(method = \"render\", at = @At(\"HEAD\"))\n+\tprivate void storeEntity(MatrixStack matrixStack, VertexConsumerProvider vertexConsumerProvider, int i, LivingEntity livingEntity, float f, float g, float h, float j, float k, float l, CallbackInfo ci) {\n+\t\t// We store the living entity wearing the armor before we render\n+\t\tthis.storedEntity = livingEntity;\n+\t}\n+\n+\t@Inject(method = \"renderArmor\", at = @At(\"HEAD\"))\n+\tprivate void storeSlot(MatrixStack matrices, VertexConsumerProvider vertexConsumers, LivingEntity livingEntity, EquipmentSlot slot, int i, BipedEntityModel bipedEntityModel, CallbackInfo ci) {\n+\t\t// We store the current armor slot that is rendering before we render each armor piece\n+\t\tthis.storedSlot = slot;\n+\t}\n+\n+\t@Inject(method = \"render\", at = @At(\"RETURN\"))\n+\tprivate void removeStored(MatrixStack matrixStack, VertexConsumerProvider vertexConsumerProvider, int i, LivingEntity livingEntity, float f, float g, float h, float j, float k, float l, CallbackInfo ci) {\n+\t\t// We remove the stored data after we render\n+\t\tthis.storedEntity = null;\n+\t\tthis.storedSlot = null;\n+\t}\n+\n+\t@Inject(method = \"getArmor\", at = @At(\"RETURN\"), cancellable = true)\n+\tprivate void selectArmorModel(EquipmentSlot slot, CallbackInfoReturnable<BipedEntityModel<LivingEntity>> cir) {\n+\t\tItemStack stack = storedEntity.getEquippedStack(slot);\n+\n+\t\tBipedEntityModel<LivingEntity> defaultModel = cir.getReturnValue();\n+\t\tBipedEntityModel<LivingEntity> model = ArmorRenderingRegistry.getArmorModel(storedEntity, stack, slot, defaultModel);\n+\n+\t\tif (model != defaultModel) {\n+\t\t\tcir.setReturnValue(model);\n+\t\t}\n+\t}\n+\n+\t@Inject(method = \"getArmorTexture\", at = @At(value = \"INVOKE\", target = \"Ljava/util/Map;computeIfAbsent(Ljava/lang/Object;Ljava/util/function/Function;)Ljava/lang/Object;\"), cancellable = true, locals = LocalCapture.CAPTURE_FAILHARD)\n+\tprivate void getArmorTexture(ArmorItem armorItem, boolean secondLayer, /* @Nullable */ String suffix, CallbackInfoReturnable<Identifier> cir, String vanillaIdentifier) {\n+\t\tString model = ArmorRenderingRegistry.getArmorTexture(storedEntity, storedEntity.getEquippedStack(storedSlot), storedSlot, vanillaIdentifier);\n+\n+\t\tif (!Objects.equals(model, vanillaIdentifier)) {\n+\t\t\tcir.setReturnValue(ARMOR_TEXTURE_CACHE.computeIfAbsent(model, Identifier::new));", "originalCommit": "999562ac563d5ecf1f7f9edeedb8a9f93c31e624", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b099994b40ae9dde4281a80d19a3ea35b97f521c", "url": "https://github.com/FabricMC/fabric/commit/b099994b40ae9dde4281a80d19a3ea35b97f521c", "message": "Update fabric-rendering-v1/src/main/java/net/fabricmc/fabric/mixin/client/rendering/MixinArmorFeatureRenderer.java\n\nCo-authored-by: Erlend \u00c5mdal <erlend@aamdal.com>", "committedDate": "2020-10-12T18:45:10Z", "type": "commit"}, {"oid": "8d5cdbe9a609b7b24b44e3dc8b7af85d9147f0bb", "url": "https://github.com/FabricMC/fabric/commit/8d5cdbe9a609b7b24b44e3dc8b7af85d9147f0bb", "message": "Add registerSimpleTexture\nPass through secondLayer and suffix\nUse Identifier's over strings\nFix the test mod", "committedDate": "2020-10-26T21:58:10Z", "type": "commit"}, {"oid": "693553d88264b71f31d85afacb293c7fd01e4307", "url": "https://github.com/FabricMC/fabric/commit/693553d88264b71f31d85afacb293c7fd01e4307", "message": "license fix", "committedDate": "2020-10-27T18:20:57Z", "type": "commit"}]}