{"pr_number": 261, "pr_title": "Disable Teammate kill sound", "pr_createdAt": "2020-01-25T22:51:05Z", "pr_url": "https://github.com/PGMDev/PGM/pull/261", "timeline": [{"oid": "54d6825fd26737d7680d8aead43836992559f020", "url": "https://github.com/PGMDev/PGM/commit/54d6825fd26737d7680d8aead43836992559f020", "message": "Disable Teammate kill sound\n\nSigned-off-by: Vlad <me@vladyslav.xyz>", "committedDate": "2020-01-25T22:48:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MTA0MA==", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370961040", "bodyText": "remove the own-kill check if we have a same-party check", "author": "Pablete1234", "createdAt": "2020-01-25T22:55:13Z", "path": "src/main/java/tc/oc/pgm/modules/SoundsMatchModule.java", "diffHunk": "@@ -55,7 +55,9 @@ private void playRaindrop(Competitor competitor) {\n   public void onMatchPlayerDeath(MatchPlayerDeathEvent event) {\n     ParticipantState killer = event.getKiller();\n     MatchPlayer victim = event.getVictim();\n-    if (killer != null && !killer.getId().equals(victim.getId())) {\n+    if (killer != null\n+        && !killer.getId().equals(victim.getId())", "originalCommit": "54d6825fd26737d7680d8aead43836992559f020", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MTQ1Mg==", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370961452", "bodyText": "Yeah thought about it", "author": "VladyslavLukyanenko", "createdAt": "2020-01-25T23:06:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MTA0MA=="}], "type": "inlineReview"}, {"oid": "d3e3c4072c9d54e5f0e1ac833b27b9a1800dfdfc", "url": "https://github.com/PGMDev/PGM/commit/d3e3c4072c9d54e5f0e1ac833b27b9a1800dfdfc", "message": "Refactor SoundsMatchModule\n\nSigned-off-by: Vlad <me@vladyslav.xyz>", "committedDate": "2020-01-25T23:29:08Z", "type": "commit"}, {"oid": "3857dbb485273e111acdf8e23fec6703e996a297", "url": "https://github.com/PGMDev/PGM/commit/3857dbb485273e111acdf8e23fec6703e996a297", "message": "Refactor SoundsMatchModule\n\nSigned-off-by: Vlad <me@vladyslav.xyz>", "committedDate": "2020-01-25T23:29:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MjUyNQ==", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370962525", "bodyText": "Any reason not to use killer.getParty().equals(victim.getParty())?", "author": "Meeples10", "createdAt": "2020-01-25T23:31:44Z", "path": "src/main/java/tc/oc/pgm/modules/SoundsMatchModule.java", "diffHunk": "@@ -32,51 +32,56 @@ public SoundsMatchModule createMatchModule(Match match) throws ModuleLoadExcepti\n   }\n \n   private static final Sound RAINDROP_SOUND = new Sound(\"random.levelup\", 1f, 1.5f);\n+  private static final Sound ENDERMAN_SCREAM = new Sound(\"mob.endermen.scream\", 1f, 1.5f);\n \n   public SoundsMatchModule(Match match) {\n     super(match);\n   }\n \n-  private void playRaindrop(MatchPlayer player) {\n+  private void playSound(MatchPlayer player, Sound sound) {\n     if (player.getSettings().getValue(SettingKey.SOUNDS).equals(SettingValue.SOUNDS_ON)) {\n-      player.playSound(RAINDROP_SOUND);\n+      player.playSound(sound);\n     }\n   }\n \n-  private void playRaindrop(MatchPlayerState playerState) {\n-    playerState.getPlayer().ifPresent(this::playRaindrop);\n+  private void playSound(MatchPlayerState playerState, Sound sound) {\n+    playerState.getPlayer().ifPresent(player -> playSound(player, sound));\n   }\n \n-  private void playRaindrop(Competitor competitor) {\n-    competitor.getPlayers().forEach(this::playRaindrop);\n+  private void playSound(Competitor competitor, Sound sound) {\n+    competitor.getPlayers().forEach(player -> playSound(player, sound));\n   }\n \n   @EventHandler(priority = EventPriority.MONITOR)\n   public void onMatchPlayerDeath(MatchPlayerDeathEvent event) {\n     ParticipantState killer = event.getKiller();\n     MatchPlayer victim = event.getVictim();\n-    if (killer != null\n-        && !killer.getId().equals(victim.getId())\n-        && !killer.getParty().getName().equals(victim.getParty().getName())) {\n-      playRaindrop(killer);\n+    if (killer != null) {\n+      if (killer.getId().equals(victim.getId())) {\n+\n+      } else if (killer.getParty().getName().equals(victim.getParty().getName())) {", "originalCommit": "3857dbb485273e111acdf8e23fec6703e996a297", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MjU0OQ==", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370962549", "bodyText": "I can use that actually thanks for the heads up.", "author": "VladyslavLukyanenko", "createdAt": "2020-01-25T23:32:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MjUyNQ=="}], "type": "inlineReview"}, {"oid": "31c82c10968168fb57fcdac589aa18894934b54f", "url": "https://github.com/PGMDev/PGM/commit/31c82c10968168fb57fcdac589aa18894934b54f", "message": "Refactor SoundsMatchModule\n\nSigned-off-by: Vlad <me@vladyslav.xyz>", "committedDate": "2020-01-25T23:33:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MjgyNQ==", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370962825", "bodyText": "Let's not do this", "author": "Pablete1234", "createdAt": "2020-01-25T23:39:23Z", "path": "src/main/java/tc/oc/pgm/modules/SoundsMatchModule.java", "diffHunk": "@@ -32,49 +32,56 @@ public SoundsMatchModule createMatchModule(Match match) throws ModuleLoadExcepti\n   }\n \n   private static final Sound RAINDROP_SOUND = new Sound(\"random.levelup\", 1f, 1.5f);\n+  private static final Sound ENDERMAN_SCREAM = new Sound(\"mob.endermen.scream\", 1f, 1.5f);\n \n   public SoundsMatchModule(Match match) {\n     super(match);\n   }\n \n-  private void playRaindrop(MatchPlayer player) {\n+  private void playSound(MatchPlayer player, Sound sound) {\n     if (player.getSettings().getValue(SettingKey.SOUNDS).equals(SettingValue.SOUNDS_ON)) {\n-      player.playSound(RAINDROP_SOUND);\n+      player.playSound(sound);\n     }\n   }\n \n-  private void playRaindrop(MatchPlayerState playerState) {\n-    playerState.getPlayer().ifPresent(this::playRaindrop);\n+  private void playSound(MatchPlayerState playerState, Sound sound) {\n+    playerState.getPlayer().ifPresent(player -> playSound(player, sound));\n   }\n \n-  private void playRaindrop(Competitor competitor) {\n-    competitor.getPlayers().forEach(this::playRaindrop);\n+  private void playSound(Competitor competitor, Sound sound) {\n+    competitor.getPlayers().forEach(player -> playSound(player, sound));\n   }\n \n   @EventHandler(priority = EventPriority.MONITOR)\n   public void onMatchPlayerDeath(MatchPlayerDeathEvent event) {\n     ParticipantState killer = event.getKiller();\n     MatchPlayer victim = event.getVictim();\n-    if (killer != null && !killer.getId().equals(victim.getId())) {\n-      playRaindrop(killer);\n+    if (killer != null) {\n+      if (killer.getId().equals(victim.getId())) {\n+\n+      } else if (killer.getParty().equals(victim.getParty())) {\n+        playSound(killer, ENDERMAN_SCREAM);", "originalCommit": "31c82c10968168fb57fcdac589aa18894934b54f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "86a2b32418a06ad5c62e45cb65e1c00944f228fb", "url": "https://github.com/PGMDev/PGM/commit/86a2b32418a06ad5c62e45cb65e1c00944f228fb", "message": "Refactor SoundsMatchModule\n\nSigned-off-by: Vlad <me@vladyslav.xyz>", "committedDate": "2020-01-25T23:47:27Z", "type": "commit"}, {"oid": "367cffead3ecc42f70d9d7a336592653f6370e7c", "url": "https://github.com/PGMDev/PGM/commit/367cffead3ecc42f70d9d7a336592653f6370e7c", "message": "Add custom message\n\nSigned-off-by: Vlad <me@vladyslav.xyz>", "committedDate": "2020-01-26T01:48:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk3MTU4MQ==", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370971581", "bodyText": "It is not PGM's duty to moderate, and not every same-team kill is bad. Accidents can happen and there's no need to play enderman scream & warn them they're getting punished.", "author": "Pablete1234", "createdAt": "2020-01-26T03:46:50Z", "path": "src/main/java/tc/oc/pgm/modules/SoundsMatchModule.java", "diffHunk": "@@ -32,49 +33,57 @@ public SoundsMatchModule createMatchModule(Match match) throws ModuleLoadExcepti\n   }\n \n   private static final Sound RAINDROP_SOUND = new Sound(\"random.levelup\", 1f, 1.5f);\n+  private static final Sound ENDERMAN_SCREAM = new Sound(\"mob.endermen.scream\", 1f, 1.5f);\n \n   public SoundsMatchModule(Match match) {\n     super(match);\n   }\n \n-  private void playRaindrop(MatchPlayer player) {\n+  private void playSound(MatchPlayer player, Sound sound) {\n     if (player.getSettings().getValue(SettingKey.SOUNDS).equals(SettingValue.SOUNDS_ON)) {\n-      player.playSound(RAINDROP_SOUND);\n+      player.playSound(sound);\n     }\n   }\n \n-  private void playRaindrop(MatchPlayerState playerState) {\n-    playerState.getPlayer().ifPresent(this::playRaindrop);\n+  private void playSound(MatchPlayerState playerState, Sound sound) {\n+    playerState.getPlayer().ifPresent(player -> playSound(player, sound));\n   }\n \n-  private void playRaindrop(Competitor competitor) {\n-    competitor.getPlayers().forEach(this::playRaindrop);\n+  private void playSound(Competitor competitor, Sound sound) {\n+    competitor.getPlayers().forEach(player -> playSound(player, sound));\n   }\n \n   @EventHandler(priority = EventPriority.MONITOR)\n   public void onMatchPlayerDeath(MatchPlayerDeathEvent event) {\n     ParticipantState killer = event.getKiller();\n     MatchPlayer victim = event.getVictim();\n-    if (killer != null && !killer.getId().equals(victim.getId())) {\n-      playRaindrop(killer);\n+    if (killer != null) {\n+      if (!killer.getId().equals(victim.getId())) {\n+        if (killer.getParty().equals(victim.getParty())) {\n+          playSound(killer, ENDERMAN_SCREAM);\n+          killer.sendWarning(new PersonalizedTranslatable(\"death.friendlyfire.warning\"), false);", "originalCommit": "367cffead3ecc42f70d9d7a336592653f6370e7c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "04cce6b09ead87c3366feedd0302457e1ce080bf", "url": "https://github.com/PGMDev/PGM/commit/04cce6b09ead87c3366feedd0302457e1ce080bf", "message": "Comply to Pablete\n\nSigned-off-by: Vlad <me@vladyslav.xyz>", "committedDate": "2020-01-26T11:44:05Z", "type": "commit"}, {"oid": "32d4948453ad864eddfaf63dbfd8c6de7eafd26c", "url": "https://github.com/PGMDev/PGM/commit/32d4948453ad864eddfaf63dbfd8c6de7eafd26c", "message": "Comply to Pablete\n\nSigned-off-by: Vlad <me@vladyslav.xyz>", "committedDate": "2020-01-26T11:54:51Z", "type": "commit"}, {"oid": "615de28bf98a6e74cf4da2d444437858bb0cfaa5", "url": "https://github.com/PGMDev/PGM/commit/615de28bf98a6e74cf4da2d444437858bb0cfaa5", "message": "Merge branch 'master' into fix-teammate-death-sound", "committedDate": "2020-01-28T19:27:43Z", "type": "commit"}]}