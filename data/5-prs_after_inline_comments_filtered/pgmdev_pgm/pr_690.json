{"pr_number": 690, "pr_title": "Refactor: Remove old sendMessage/showTitle", "pr_createdAt": "2020-11-03T18:46:26Z", "pr_url": "https://github.com/PGMDev/PGM/pull/690", "timeline": [{"oid": "b10a5e112420e4788ba490315e8ba111f9962ea7", "url": "https://github.com/PGMDev/PGM/commit/b10a5e112420e4788ba490315e8ba111f9962ea7", "message": "Start moving away from old PGM Audience class\n- MatchPlayer(State)/Party/Match etc. now implements adventure ForwardingAudience(creates an audience at creation) instead of going the detour through the old Audience class. This also results in a move to adventure objects for Titles/Components/Bossbars etc.\n- Make a centralized AudienceProvider in PGMAudiences that can be passed around\n- Move the widely used sendWarning to PGMAudiences as a static method\n\n- Fixed a couple of sound names\n\nSigned-off-by: KingSimon <19822231+KingOfSquares@users.noreply.github.com>", "committedDate": "2020-11-03T18:42:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4NTY4Nw==", "url": "https://github.com/PGMDev/PGM/pull/690#discussion_r516885687", "bodyText": "Switch this to use TextFormatter#horizontalLineHeading \ud83d\ude04", "author": "applenick", "createdAt": "2020-11-03T18:52:18Z", "path": "core/src/main/java/tc/oc/pgm/command/ClassCommand.java", "diffHunk": "@@ -65,10 +65,12 @@ public void classList(Match match, MatchPlayer player) {\n     final PlayerClass currentClass = classes.getSelectedClass(player.getId());\n \n     player.sendMessage(\n-        LegacyFormatUtils.dashedChatMessage(\n-            ChatColor.GOLD + TextTranslations.translate(\"match.class.title\", player.getBukkit()),\n-            \"-\",\n-            ChatColor.RED.toString()));\n+        text(\n+            LegacyFormatUtils.dashedChatMessage(", "originalCommit": "b10a5e112420e4788ba490315e8ba111f9962ea7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4NzY1MQ==", "url": "https://github.com/PGMDev/PGM/pull/690#discussion_r516887651", "bodyText": "Yeah I know, I just thought it would make sense to do such a big refactor step by step.\nI was thinking TextFormatter should be refactored to use MatchPlayers instead anyways", "author": "KingOfSquares", "createdAt": "2020-11-03T18:55:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4NTY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg5MDE2NA==", "url": "https://github.com/PGMDev/PGM/pull/690#discussion_r516890164", "bodyText": "Ah just be careful about that, since if an outside plugin wants to use the utils you don\u2019t want them to be forced to use PGM just to get the MatchPlayer.", "author": "applenick", "createdAt": "2020-11-03T19:00:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4NTY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg5MTMyNQ==", "url": "https://github.com/PGMDev/PGM/pull/690#discussion_r516891325", "bodyText": "Right, then the bukkit Player would also work, yeah? player.getBukkit()", "author": "KingOfSquares", "createdAt": "2020-11-03T19:02:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4NTY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg5MzE0NA==", "url": "https://github.com/PGMDev/PGM/pull/690#discussion_r516893144", "bodyText": "It depends on the method. For example I use the horizontalLineHeading methods in my requests plugin here. If it were switched to player, then would no longer be able to run the command from the console.", "author": "applenick", "createdAt": "2020-11-03T19:05:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4NTY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkwMTMxNQ==", "url": "https://github.com/PGMDev/PGM/pull/690#discussion_r516901315", "bodyText": "Then what about a Locale ? This seems to be the only need for the sender", "author": "KingOfSquares", "createdAt": "2020-11-03T19:20:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4NTY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkwMjM3MA==", "url": "https://github.com/PGMDev/PGM/pull/690#discussion_r516902370", "bodyText": "I don\u2019t have time atm to look into what the sender is needed for, but awesome yeah if it\u2019s something more general like Locale that would be the best path to take \ud83d\udc4d", "author": "applenick", "createdAt": "2020-11-03T19:22:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg4NTY4Nw=="}], "type": "inlineReview"}, {"oid": "3e5e43a751e82b26593dab962427d2ff87736dc0", "url": "https://github.com/PGMDev/PGM/commit/3e5e43a751e82b26593dab962427d2ff87736dc0", "message": "rename console refrence\n\nSigned-off-by: KingSimon <19822231+KingOfSquares@users.noreply.github.com>", "committedDate": "2020-11-03T19:18:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAwODkzOQ==", "url": "https://github.com/PGMDev/PGM/pull/690#discussion_r517008939", "bodyText": "Instead of having something like PGMAudiences, I would like this to live in util.\ntc.oc.util.text.Audience would be both an interface, with things like sendWarning wrapper, and 1-stop-shop to create audiences from players or groups of players.", "author": "Electroid", "createdAt": "2020-11-03T23:10:04Z", "path": "core/src/main/java/tc/oc/pgm/PGMAudiences.java", "diffHunk": "@@ -0,0 +1,30 @@\n+package tc.oc.pgm;\n+\n+import net.kyori.adventure.audience.Audience;\n+import net.kyori.adventure.key.Key;\n+import net.kyori.adventure.platform.bukkit.BukkitAudiences;\n+import net.kyori.adventure.sound.Sound;\n+import net.kyori.adventure.text.Component;\n+import net.kyori.adventure.text.format.NamedTextColor;\n+import org.bukkit.plugin.Plugin;\n+\n+public class PGMAudiences {", "originalCommit": "3e5e43a751e82b26593dab962427d2ff87736dc0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzE2MzI0Nw==", "url": "https://github.com/PGMDev/PGM/pull/690#discussion_r517163247", "bodyText": "I see, any reason you decided to deprecate the provider that was in there?\nThe way im understanding this is that the provider also should stay in this Audience class", "author": "KingOfSquares", "createdAt": "2020-11-04T08:16:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAwODkzOQ=="}], "type": "inlineReview"}, {"oid": "fa5b237c4e1a2c3a3b3ceef12628c6fc03680356", "url": "https://github.com/PGMDev/PGM/commit/fa5b237c4e1a2c3a3b3ceef12628c6fc03680356", "message": "Move back to PGM Audience\n- Remove all references to adventure Audience in favour of our Audience\n- remove deprecation\n- add identities to ChatDispatcher\n\nSigned-off-by: KingSimon <19822231+KingOfSquares@users.noreply.github.com>", "committedDate": "2020-11-04T11:29:22Z", "type": "commit"}]}