{"pr_number": 3206, "pr_title": "[NCL-5885] DONE WS message wrongly sent after final NO_REBUILD_REQUIRED", "pr_createdAt": "2020-07-28T11:44:05Z", "pr_url": "https://github.com/project-ncl/pnc/pull/3206", "timeline": [{"oid": "8be7905700900fd83d6b3df2001cdb8c1affaca6", "url": "https://github.com/project-ncl/pnc/commit/8be7905700900fd83d6b3df2001cdb8c1affaca6", "message": "[NCL-5885] fix unexpected WS message with status DONE after NO_REBUILD_REQUIRED", "committedDate": "2020-07-28T12:37:18Z", "type": "commit"}, {"oid": "8be7905700900fd83d6b3df2001cdb8c1affaca6", "url": "https://github.com/project-ncl/pnc/commit/8be7905700900fd83d6b3df2001cdb8c1affaca6", "message": "[NCL-5885] fix unexpected WS message with status DONE after NO_REBUILD_REQUIRED", "committedDate": "2020-07-28T12:37:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU2NTIyNg==", "url": "https://github.com/project-ncl/pnc/pull/3206#discussion_r461565226", "bodyText": "Can you merge this with the condition above L543?", "author": "matejonnet", "createdAt": "2020-07-28T13:08:52Z", "path": "build-coordinator/src/main/java/org/jboss/pnc/coordinator/builder/DefaultBuildCoordinator.java", "diffHunk": "@@ -561,7 +561,9 @@ private void updateBuildTaskStatus(BuildTask task, BuildCoordinationStatus statu\n \n         userLog.info(\"Build status updated to {}; previous: {}\", status, oldStatus);\n \n-        if (BuildStatus.fromBuildCoordinationStatus(oldStatus) != BuildStatus.fromBuildCoordinationStatus(status)) {\n+        BuildStatus oldBuildStatus = BuildStatus.fromBuildCoordinationStatus(oldStatus);\n+        BuildStatus newBuildStatus = BuildStatus.fromBuildCoordinationStatus(status);\n+        if ((oldBuildStatus != newBuildStatus) && !(oldBuildStatus.isFinal() && newBuildStatus.isFinal())) {", "originalCommit": "8be7905700900fd83d6b3df2001cdb8c1affaca6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjE1Mzc4NA==", "url": "https://github.com/project-ncl/pnc/pull/3206#discussion_r462153784", "bodyText": "Do you mean that I should use the same condition also on L543?", "author": "michalovjan", "createdAt": "2020-07-29T09:09:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU2NTIyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI1OTc2Ng==", "url": "https://github.com/project-ncl/pnc/pull/3206#discussion_r462259766", "bodyText": "I've added the edge-case to markFinished condition also with some clarifying comments.", "author": "michalovjan", "createdAt": "2020-07-29T12:28:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU2NTIyNg=="}], "type": "inlineReview"}, {"oid": "afad1601222e28c5425c20f24c41e890266807cf", "url": "https://github.com/project-ncl/pnc/commit/afad1601222e28c5425c20f24c41e890266807cf", "message": "[NCL-5885] add condition clarifying comments", "committedDate": "2020-07-29T12:32:52Z", "type": "commit"}, {"oid": "afad1601222e28c5425c20f24c41e890266807cf", "url": "https://github.com/project-ncl/pnc/commit/afad1601222e28c5425c20f24c41e890266807cf", "message": "[NCL-5885] add condition clarifying comments", "committedDate": "2020-07-29T12:32:52Z", "type": "forcePushed"}]}