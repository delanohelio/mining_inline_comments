{"pr_number": 959, "pr_title": "feat(datastore) selective sync", "pr_createdAt": "2020-11-13T21:09:50Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/959", "timeline": [{"oid": "7b54ee44b526e1fb55f45079482644ed87889559", "url": "https://github.com/aws-amplify/amplify-android/commit/7b54ee44b526e1fb55f45079482644ed87889559", "message": "feat(datastore) selective sync", "committedDate": "2020-11-16T17:50:39Z", "type": "commit"}, {"oid": "091940f85c361bb338252269caf6b257365b0bba", "url": "https://github.com/aws-amplify/amplify-android/commit/091940f85c361bb338252269caf6b257365b0bba", "message": "Update aws-datastore/src/main/java/com/amplifyframework/datastore/DataStoreConfiguration.java\n\nCo-authored-by: Jameson Williams <jhwill@amazon.com>", "committedDate": "2020-11-16T17:50:39Z", "type": "commit"}, {"oid": "556f46b825212a0b5a0eb0747809561b6a6378a0", "url": "https://github.com/aws-amplify/amplify-android/commit/556f46b825212a0b5a0eb0747809561b6a6378a0", "message": "Update aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/SubscriptionProcessor.java\n\nCo-authored-by: Jameson Williams <jhwill@amazon.com>", "committedDate": "2020-11-16T17:50:40Z", "type": "commit"}, {"oid": "933765a3d0819d08cdc0863cf96a33fbbd2165ff", "url": "https://github.com/aws-amplify/amplify-android/commit/933765a3d0819d08cdc0863cf96a33fbbd2165ff", "message": "Update aws-datastore/src/test/java/com/amplifyframework/datastore/syncengine/SubscriptionProcessorTest.java\n\nCo-authored-by: Jameson Williams <jhwill@amazon.com>", "committedDate": "2020-11-16T17:50:40Z", "type": "commit"}, {"oid": "680f10fb995e5ed15a15d864c250eda975e5ac7e", "url": "https://github.com/aws-amplify/amplify-android/commit/680f10fb995e5ed15a15d864c250eda975e5ac7e", "message": "Address PR feedback", "committedDate": "2020-11-16T17:50:40Z", "type": "commit"}, {"oid": "680f10fb995e5ed15a15d864c250eda975e5ac7e", "url": "https://github.com/aws-amplify/amplify-android/commit/680f10fb995e5ed15a15d864c250eda975e5ac7e", "message": "Address PR feedback", "committedDate": "2020-11-16T17:50:40Z", "type": "forcePushed"}, {"oid": "7ec0f5ac27ec396168887283a5bd15fe23449e1b", "url": "https://github.com/aws-amplify/amplify-android/commit/7ec0f5ac27ec396168887283a5bd15fe23449e1b", "message": "Fix merge conflict", "committedDate": "2020-11-16T20:09:49Z", "type": "commit"}, {"oid": "7ec0f5ac27ec396168887283a5bd15fe23449e1b", "url": "https://github.com/aws-amplify/amplify-android/commit/7ec0f5ac27ec396168887283a5bd15fe23449e1b", "message": "Fix merge conflict", "committedDate": "2020-11-16T20:09:49Z", "type": "forcePushed"}, {"oid": "b165be7ee0a90b020e76d517b8a63a8837f57d5a", "url": "https://github.com/aws-amplify/amplify-android/commit/b165be7ee0a90b020e76d517b8a63a8837f57d5a", "message": "Change modelClass to modelName to more easily support hybrid platforms", "committedDate": "2020-11-16T23:30:16Z", "type": "commit"}, {"oid": "721048fccf04ccb3c5c908c40806223d4cff0a06", "url": "https://github.com/aws-amplify/amplify-android/commit/721048fccf04ccb3c5c908c40806223d4cff0a06", "message": "Only evaluate DataStoreSyncExpressions on DataStore.start", "committedDate": "2020-11-17T20:17:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQwMzk5NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/959#discussion_r526403994", "bodyText": "Not that this matters or is worth changing but is there a reason you switched from passing in params to passing in the Builder instance? We do the opposite elsewhere in the code.", "author": "TrekSoft", "createdAt": "2020-11-18T20:36:20Z", "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/SyncProcessor.java", "diffHunk": "@@ -69,20 +69,16 @@\n     private final Merger merger;\n     private final DataStoreConfigurationProvider dataStoreConfigurationProvider;\n     private final String[] modelNames;\n-\n-    private SyncProcessor(\n-            ModelProvider modelProvider,\n-            ModelSchemaRegistry modelSchemaRegistry,\n-            SyncTimeRegistry syncTimeRegistry,\n-            AppSync appSync,\n-            Merger merger,\n-            DataStoreConfigurationProvider dataStoreConfigurationProvider) {\n-        this.modelProvider = Objects.requireNonNull(modelProvider);\n-        this.modelSchemaRegistry = Objects.requireNonNull(modelSchemaRegistry);\n-        this.syncTimeRegistry = Objects.requireNonNull(syncTimeRegistry);\n-        this.appSync = Objects.requireNonNull(appSync);\n-        this.merger = Objects.requireNonNull(merger);\n-        this.dataStoreConfigurationProvider = dataStoreConfigurationProvider;\n+    private final QueryPredicateProvider queryPredicateProvider;\n+\n+    private SyncProcessor(Builder builder) {", "originalCommit": "721048fccf04ccb3c5c908c40806223d4cff0a06", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQwNzc5NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/959#discussion_r526407794", "bodyText": "I've seen both patterns in our code base.  I like the single Builder parameter approach a little better, because then we don't end up with a constructor that takes a ton of parameters, and one of the main reasons for using the Builder pattern is to avoid constructors with lots of parameters :).   I'm open to other thoughts on why the other pattern might be better though.", "author": "richardmcclellan", "createdAt": "2020-11-18T20:43:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQwMzk5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ3MTkyMA==", "url": "https://github.com/aws-amplify/amplify-android/pull/959#discussion_r528471920", "bodyText": "My argument for all-args constructor is that the constructor should not know any detail about the builder, or how it is being constructed. However, if the constructor is going to be private anyway, then it really doesn't matter. @richardmcclellan's point about not having to maintain the constructor argument list makes sense to me.", "author": "jamesonwilliams", "createdAt": "2020-11-23T04:56:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQwMzk5NA=="}], "type": "inlineReview"}]}