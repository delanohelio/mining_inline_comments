{"pr_number": 927, "pr_title": "feature(build): Trigger unit and integration tests in CodeBuild", "pr_createdAt": "2020-10-23T23:45:34Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/927", "timeline": [{"oid": "7729346b969aa4474bb0d3d7659c35f6c5069448", "url": "https://github.com/aws-amplify/amplify-android/commit/7729346b969aa4474bb0d3d7659c35f6c5069448", "message": "chore(build): Update buildspec to build test APKs", "committedDate": "2020-10-19T17:13:52Z", "type": "commit"}, {"oid": "4c44dcd791b928ada515743d67be79b203c447a4", "url": "https://github.com/aws-amplify/amplify-android/commit/4c44dcd791b928ada515743d67be79b203c447a4", "message": "Copy different reports", "committedDate": "2020-10-19T19:25:27Z", "type": "commit"}, {"oid": "d56de48a338e5e4def3e9026d32a3fd6155fc45d", "url": "https://github.com/aws-amplify/amplify-android/commit/d56de48a338e5e4def3e9026d32a3fd6155fc45d", "message": "Copy config files to all subdirectories", "committedDate": "2020-10-19T21:02:10Z", "type": "commit"}, {"oid": "08c00e6729feef92bc89438d0cbecf38acbdfe4d", "url": "https://github.com/aws-amplify/amplify-android/commit/08c00e6729feef92bc89438d0cbecf38acbdfe4d", "message": "Commenting out ignored test causing build failure", "committedDate": "2020-10-19T22:17:07Z", "type": "commit"}, {"oid": "5feaa5975ad067784ddaf6c3279ba52347dfc76f", "url": "https://github.com/aws-amplify/amplify-android/commit/5feaa5975ad067784ddaf6c3279ba52347dfc76f", "message": "Checkstyle issues", "committedDate": "2020-10-19T22:30:21Z", "type": "commit"}, {"oid": "ab56ad3dfa3d650a70121a87058c519ff86b073f", "url": "https://github.com/aws-amplify/amplify-android/commit/ab56ad3dfa3d650a70121a87058c519ff86b073f", "message": "Revert to previous test reports", "committedDate": "2020-10-19T22:43:29Z", "type": "commit"}, {"oid": "f095f7c77f24746a622be421c65257acd2e66063", "url": "https://github.com/aws-amplify/amplify-android/commit/f095f7c77f24746a622be421c65257acd2e66063", "message": "Ignoring individual tests", "committedDate": "2020-10-21T14:26:36Z", "type": "commit"}, {"oid": "2bc5f305e9d85c59f1037717bf463c1dcffa9ee1", "url": "https://github.com/aws-amplify/amplify-android/commit/2bc5f305e9d85c59f1037717bf463c1dcffa9ee1", "message": "Set node to version 12", "committedDate": "2020-10-23T16:22:10Z", "type": "commit"}, {"oid": "0f3e785514383d0a9ea8ca937bae290de38e53ef", "url": "https://github.com/aws-amplify/amplify-android/commit/0f3e785514383d0a9ea8ca937bae290de38e53ef", "message": "Fix runtime name", "committedDate": "2020-10-23T16:31:45Z", "type": "commit"}, {"oid": "d30e96f451175acb55e906db021169951c3ed37b", "url": "https://github.com/aws-amplify/amplify-android/commit/d30e96f451175acb55e906db021169951c3ed37b", "message": "Pin cli version", "committedDate": "2020-10-23T16:43:56Z", "type": "commit"}, {"oid": "69d24d6e8e20fbf07b69ca5e675f90b20d648f99", "url": "https://github.com/aws-amplify/amplify-android/commit/69d24d6e8e20fbf07b69ca5e675f90b20d648f99", "message": "Add ignore at the function level instead of class", "committedDate": "2020-10-23T23:05:53Z", "type": "commit"}, {"oid": "5b56ac7d591e531e024007298d661cda6933a2fc", "url": "https://github.com/aws-amplify/amplify-android/commit/5b56ac7d591e531e024007298d661cda6933a2fc", "message": "Checkstyle fix", "committedDate": "2020-10-23T23:20:04Z", "type": "commit"}, {"oid": "3152dd70f256acec5e93c829efa6de74cf880974", "url": "https://github.com/aws-amplify/amplify-android/commit/3152dd70f256acec5e93c829efa6de74cf880974", "message": "Checkstyle fix", "committedDate": "2020-10-23T23:30:45Z", "type": "commit"}, {"oid": "045066c6ae9f204dd7e2466ba6f0889a5d9eee01", "url": "https://github.com/aws-amplify/amplify-android/commit/045066c6ae9f204dd7e2466ba6f0889a5d9eee01", "message": "Checkstyle fix", "committedDate": "2020-10-23T23:43:14Z", "type": "commit"}, {"oid": "d277aeff5172d28a591e2de639323f8d1cf58209", "url": "https://github.com/aws-amplify/amplify-android/commit/d277aeff5172d28a591e2de639323f8d1cf58209", "message": "Checkstyle fix", "committedDate": "2020-10-23T23:56:21Z", "type": "commit"}, {"oid": "44a9845a979d8ae92cf91b7dbcf170c01473fa5a", "url": "https://github.com/aws-amplify/amplify-android/commit/44a9845a979d8ae92cf91b7dbcf170c01473fa5a", "message": "Add code to pull amplify backend config for tests", "committedDate": "2020-10-25T14:51:03Z", "type": "commit"}, {"oid": "5aeab5fa4d56e1665d7470bd4f307b82fa7381b0", "url": "https://github.com/aws-amplify/amplify-android/commit/5aeab5fa4d56e1665d7470bd4f307b82fa7381b0", "message": "Adding echo statements for troubleshooting", "committedDate": "2020-10-25T15:20:06Z", "type": "commit"}, {"oid": "10fc85a439dc5777939af33208e2e50e18239ee7", "url": "https://github.com/aws-amplify/amplify-android/commit/10fc85a439dc5777939af33208e2e50e18239ee7", "message": "Add task dependency", "committedDate": "2020-10-25T22:00:42Z", "type": "commit"}, {"oid": "49ce450bf211174da50abbba7c04e103c4a96c2c", "url": "https://github.com/aws-amplify/amplify-android/commit/49ce450bf211174da50abbba7c04e103c4a96c2c", "message": "Fix task dependency", "committedDate": "2020-10-25T22:11:41Z", "type": "commit"}, {"oid": "a530d1c572ab31b22821e82e229404761eb66327", "url": "https://github.com/aws-amplify/amplify-android/commit/a530d1c572ab31b22821e82e229404761eb66327", "message": "Updating build script dependencies", "committedDate": "2020-10-25T22:32:53Z", "type": "commit"}, {"oid": "331595eb7dfea026fff5a1c0d72c3c95dd5129a8", "url": "https://github.com/aws-amplify/amplify-android/commit/331595eb7dfea026fff5a1c0d72c3c95dd5129a8", "message": "Ignore configureAndInitializeInLocalMode", "committedDate": "2020-10-25T22:53:38Z", "type": "commit"}, {"oid": "0b81a7b0f08ba3331588ec12dc1445b199496934", "url": "https://github.com/aws-amplify/amplify-android/commit/0b81a7b0f08ba3331588ec12dc1445b199496934", "message": "Pull config file in pre-build", "committedDate": "2020-10-25T23:32:59Z", "type": "commit"}, {"oid": "07e5e05341ca18906b801bb9dca94eda9d14f375", "url": "https://github.com/aws-amplify/amplify-android/commit/07e5e05341ca18906b801bb9dca94eda9d14f375", "message": "Don't add task as dependency", "committedDate": "2020-10-25T23:36:08Z", "type": "commit"}, {"oid": "6ceb929bb9a5b9033a4189658b61d1570634c033", "url": "https://github.com/aws-amplify/amplify-android/commit/6ceb929bb9a5b9033a4189658b61d1570634c033", "message": "Add debugging statements", "committedDate": "2020-10-26T00:14:34Z", "type": "commit"}, {"oid": "b82b75a88e06205839aa4f39f35e9af99c909880", "url": "https://github.com/aws-amplify/amplify-android/commit/b82b75a88e06205839aa4f39f35e9af99c909880", "message": "Modify resource dir", "committedDate": "2020-10-26T00:46:47Z", "type": "commit"}, {"oid": "d94c12086bc7e74f2b5a6ab46a2f262895fbbb56", "url": "https://github.com/aws-amplify/amplify-android/commit/d94c12086bc7e74f2b5a6ab46a2f262895fbbb56", "message": "Fixing resource path", "committedDate": "2020-10-26T01:03:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTc1MDI4Mg==", "url": "https://github.com/aws-amplify/amplify-android/pull/927#discussion_r511750282", "bodyText": "The test is @Ignore'd anyway -- do you need to comment the code out, too?", "author": "jamesonwilliams", "createdAt": "2020-10-26T07:01:02Z", "path": "aws-api/src/androidTest/java/com/amplifyframework/api/aws/GraphQLInstrumentationTest.java", "diffHunk": "@@ -123,12 +120,12 @@ public void subscriptionReceivesMutationOverAwsIam() throws ApiException {\n     @Ignore(\"Relies on an AWS account which is no longer active.  Resources need to be regenerated.\")\n     public void subscriptionReceivesMutationOverCognitoUserPools() throws\n             ApiException, JSONException, SynchronousMobileClient.MobileClientException {\n-        currentApiName = API_WITH_COGNITO_USER_POOLS;\n+        /*currentApiName = API_WITH_COGNITO_USER_POOLS;", "originalCommit": "d94c12086bc7e74f2b5a6ab46a2f262895fbbb56", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk5MjUxNQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/927#discussion_r511992515", "bodyText": "I noticed that last night. The problem I was having is that it wasn't compiling because I had no credentials.json file. I was trying to generate the config files using the CLI so that file wasn't getting generated. I'm going to do that part as a follow up. For now, I'm copying the config files for the backend resources that circle-ci currently uses.\nI'm going to revert this change.", "author": "rjuliano", "createdAt": "2020-10-26T14:15:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTc1MDI4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTc1MTc0Ng==", "url": "https://github.com/aws-amplify/amplify-android/pull/927#discussion_r511751746", "bodyText": "Do we know how/why these tests fail? Can we add that description here, instead of this note?", "author": "jamesonwilliams", "createdAt": "2020-10-26T07:05:45Z", "path": "core/src/androidTest/java/com/amplifyframework/devmenu/DevMenuMainViewInstrumentationTest.java", "diffHunk": "@@ -60,7 +59,7 @@ public void resetView() {\n      * Tests that the app is navigated to the environment information\n      * screen when the view environment information button is pressed.\n      */\n-    @Test\n+    @Ignore(\"DeviceFarm does not appear to recognize ignore at the class level.\")", "originalCommit": "d94c12086bc7e74f2b5a6ab46a2f262895fbbb56", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk5ODE1MQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/927#discussion_r511998151", "bodyText": "The comment at the class level states that:\n\n\"All of these tests timeout frequently with an error about the root of the view hierarchy never taking focus\"\n\nI can probably just switch them all to that. Ultimately I wanted to figure out why device farm doesn't honor the class-level ignore", "author": "rjuliano", "createdAt": "2020-10-26T14:23:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTc1MTc0Ng=="}], "type": "inlineReview"}, {"oid": "7d62deae1a7939a6b54ba616e9fb590f61b7eca0", "url": "https://github.com/aws-amplify/amplify-android/commit/7d62deae1a7939a6b54ba616e9fb590f61b7eca0", "message": "Add option to pull config files from S3", "committedDate": "2020-10-26T13:11:48Z", "type": "commit"}, {"oid": "54509db33ed0176bcd1958a52e450d0f246a33d2", "url": "https://github.com/aws-amplify/amplify-android/commit/54509db33ed0176bcd1958a52e450d0f246a33d2", "message": "Addressing PR feedback. Moving gradle task", "committedDate": "2020-10-26T14:54:35Z", "type": "commit"}, {"oid": "5d11625c04a50c3eb090bcd3fd20bcc7ee075336", "url": "https://github.com/aws-amplify/amplify-android/commit/5d11625c04a50c3eb090bcd3fd20bcc7ee075336", "message": "Tweak runtime config", "committedDate": "2020-10-26T16:10:46Z", "type": "commit"}, {"oid": "35e7c18a48610591a2ff921fc9b03e818180856b", "url": "https://github.com/aws-amplify/amplify-android/commit/35e7c18a48610591a2ff921fc9b03e818180856b", "message": "Inherit java runtime from android runtime", "committedDate": "2020-10-26T16:39:44Z", "type": "commit"}, {"oid": "283c79db53bd8443e1b7058407ebed8198f27186", "url": "https://github.com/aws-amplify/amplify-android/commit/283c79db53bd8443e1b7058407ebed8198f27186", "message": "clean up gradle file", "committedDate": "2020-10-26T16:59:37Z", "type": "commit"}, {"oid": "d5153b6cbe0c57b60644065722d45ef088dc82ed", "url": "https://github.com/aws-amplify/amplify-android/commit/d5153b6cbe0c57b60644065722d45ef088dc82ed", "message": "Add ignore annotation to methods", "committedDate": "2020-10-26T18:36:35Z", "type": "commit"}, {"oid": "565c1f70a7cc37072b8f7ade040e1213e7984027", "url": "https://github.com/aws-amplify/amplify-android/commit/565c1f70a7cc37072b8f7ade040e1213e7984027", "message": "Checkstyle fixes", "committedDate": "2020-10-26T19:11:41Z", "type": "commit"}, {"oid": "950c98986061905fd32d650e4fdd034b5b3f67dc", "url": "https://github.com/aws-amplify/amplify-android/commit/950c98986061905fd32d650e4fdd034b5b3f67dc", "message": "Copying different test files for report", "committedDate": "2020-10-27T01:08:47Z", "type": "commit"}, {"oid": "10c6e11e84b2b47094e8e1ea961fd6a7e40f2f5a", "url": "https://github.com/aws-amplify/amplify-android/commit/10c6e11e84b2b47094e8e1ea961fd6a7e40f2f5a", "message": "Testing trigger", "committedDate": "2020-10-28T01:19:19Z", "type": "commit"}, {"oid": "b735f4468d1cba4eb1ab5befef1206e52eb29acd", "url": "https://github.com/aws-amplify/amplify-android/commit/b735f4468d1cba4eb1ab5befef1206e52eb29acd", "message": "Adding separate buildspec files", "committedDate": "2020-10-29T02:45:14Z", "type": "commit"}, {"oid": "8ff6ed00883e390314abac72a54b2a86b0a6b75f", "url": "https://github.com/aws-amplify/amplify-android/commit/8ff6ed00883e390314abac72a54b2a86b0a6b75f", "message": "Cleanup buildspec", "committedDate": "2020-10-29T03:14:36Z", "type": "commit"}, {"oid": "8724b02243d57ee9338defc5634e5ac07f8ba6d1", "url": "https://github.com/aws-amplify/amplify-android/commit/8724b02243d57ee9338defc5634e5ac07f8ba6d1", "message": "Remove buildspec from repo root", "committedDate": "2020-10-29T03:31:50Z", "type": "commit"}, {"oid": "64b3f5caefb083eec36c8da7260997ddec30e7d3", "url": "https://github.com/aws-amplify/amplify-android/commit/64b3f5caefb083eec36c8da7260997ddec30e7d3", "message": "Run integ tests from CodeBuild", "committedDate": "2020-10-30T07:38:20Z", "type": "commit"}, {"oid": "0b957348d118bfc577b1cb295971b104e10f15ba", "url": "https://github.com/aws-amplify/amplify-android/commit/0b957348d118bfc577b1cb295971b104e10f15ba", "message": "Cleaning up buildspec", "committedDate": "2020-10-30T07:49:05Z", "type": "commit"}, {"oid": "e77d5639a3f70a77143929ec70252db4da0021c5", "url": "https://github.com/aws-amplify/amplify-android/commit/e77d5639a3f70a77143929ec70252db4da0021c5", "message": "Update docs in the buildspec for APK builder project", "committedDate": "2020-10-30T15:17:26Z", "type": "commit"}, {"oid": "dff7fc838c46e343994dc879627a640cf3f61285", "url": "https://github.com/aws-amplify/amplify-android/commit/dff7fc838c46e343994dc879627a640cf3f61285", "message": "Fix bug in scripts", "committedDate": "2020-10-30T16:08:47Z", "type": "commit"}, {"oid": "3bb8778aa390f1210b3a5f01409c005b15431234", "url": "https://github.com/aws-amplify/amplify-android/commit/3bb8778aa390f1210b3a5f01409c005b15431234", "message": "Fix buildspec for test runner", "committedDate": "2020-10-30T16:13:52Z", "type": "commit"}, {"oid": "1ce54f3d5a3bada71f9263d304adde8d2dc4ac7d", "url": "https://github.com/aws-amplify/amplify-android/commit/1ce54f3d5a3bada71f9263d304adde8d2dc4ac7d", "message": "Pass device farm params in environment variables", "committedDate": "2020-10-30T16:33:20Z", "type": "commit"}, {"oid": "bc0272bed1a313f4b1de36092ad4ca6d6ed2794f", "url": "https://github.com/aws-amplify/amplify-android/commit/bc0272bed1a313f4b1de36092ad4ca6d6ed2794f", "message": "Add remaining modules", "committedDate": "2020-10-30T17:10:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTMxMjY0MQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/927#discussion_r515312641", "bodyText": "I believe this test is passing on CircleCI currently, right?  Why @ignore it?", "author": "richardmcclellan", "createdAt": "2020-10-30T18:54:11Z", "path": "aws-datastore/src/test/java/com/amplifyframework/datastore/AWSDataStorePluginTest.java", "diffHunk": "@@ -106,7 +106,7 @@ public void setup() {\n      * crashing the calling thread. Basic. \ud83d\ude44\n      * @throws AmplifyException Not expected; on failure to configure of initialize plugin.\n      */\n-    @Test\n+    @Ignore(\"Needs investigation as it fails sporadically.\")", "originalCommit": "bc0272bed1a313f4b1de36092ad4ca6d6ed2794f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM4NjIxNQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/927#discussion_r515386215", "bodyText": "This was supposed to be temporary. I'm going to remove the ignore. I was having issues with this one test failing at times both locally and inside the container. Need to do some investigating", "author": "rjuliano", "createdAt": "2020-10-30T21:15:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTMxMjY0MQ=="}], "type": "inlineReview"}, {"oid": "ae8c52e65fab71a79b68c71885db482f72bd674b", "url": "https://github.com/aws-amplify/amplify-android/commit/ae8c52e65fab71a79b68c71885db482f72bd674b", "message": "Rolling back the ignore directive", "committedDate": "2020-10-30T21:17:43Z", "type": "commit"}, {"oid": "60c6ed2b5f8901f15d6920455f3054fc106b707b", "url": "https://github.com/aws-amplify/amplify-android/commit/60c6ed2b5f8901f15d6920455f3054fc106b707b", "message": "Merge remote-tracking branch 'origin/main' into rjuliano/codebuild-source", "committedDate": "2020-10-31T19:10:21Z", "type": "commit"}, {"oid": "324b65bc32879198ae14037c8ac7fe10582a9cae", "url": "https://github.com/aws-amplify/amplify-android/commit/324b65bc32879198ae14037c8ac7fe10582a9cae", "message": "Trigger build", "committedDate": "2020-11-01T01:35:03Z", "type": "commit"}, {"oid": "3247ae20f65cb8bc4bd9f280165161144f76eb0f", "url": "https://github.com/aws-amplify/amplify-android/commit/3247ae20f65cb8bc4bd9f280165161144f76eb0f", "message": "Remove unused buildspec", "committedDate": "2020-11-02T13:16:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIwODY0NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/927#discussion_r516208644", "bodyText": "You can leave the @Tests in place, and just add the @Ignore, right?", "author": "jamesonwilliams", "createdAt": "2020-11-02T19:35:08Z", "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/AWSS3StorageDownloadTest.java", "diffHunk": "@@ -40,7 +40,6 @@\n import org.junit.Before;\n import org.junit.BeforeClass;\n import org.junit.Ignore;\n-import org.junit.Test;", "originalCommit": "3247ae20f65cb8bc4bd9f280165161144f76eb0f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}