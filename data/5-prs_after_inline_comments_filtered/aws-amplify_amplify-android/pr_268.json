{"pr_number": 268, "pr_title": "[rxbindings] Add an RxJava2 facade", "pr_createdAt": "2020-02-17T05:20:10Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/268", "timeline": [{"oid": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "url": "https://github.com/aws-amplify/amplify-android/commit/89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "message": "[rxbindings] Add an RxJava2 facade\n\nRxAmplify exposes all of the functionalities of the Amplify library, but\nusing RxJava2 primitives: Observable, Single, Completable.", "committedDate": "2020-02-17T05:16:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDI3NDQzOQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r380274439", "bodyText": "This line is problematic when writing a unit test that exercises the AWSHubPlugin. It is also a strange choice, to callback on the main thread, when the subscription did not necessarily happen on the main thread. So, while this line doesn't appear to have to do with the purpose of the PR at first glance -- it's towards making this class test-able.", "author": "jamesonwilliams", "createdAt": "2020-02-17T16:24:39Z", "path": "core/src/main/java/com/amplifyframework/hub/AWSHubPlugin.java", "diffHunk": "@@ -68,8 +65,7 @@\n                         !subscription.getHubEventFilter().filter(hubEvent)) {\n                     continue;\n                 }\n-\n-                mainHandler.post(() -> subscription.getHubSubscriber().onEvent(hubEvent));", "originalCommit": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1MzI5OA==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382253298", "bodyText": "Aren't we making them both Async as per our last initialization workflow discussion?", "author": "raphkim", "createdAt": "2020-02-20T20:57:02Z", "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxAmplify.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.rx;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.AmplifyException;\n+import com.amplifyframework.core.Amplify;\n+import com.amplifyframework.core.AmplifyConfiguration;\n+import com.amplifyframework.core.plugin.Plugin;\n+\n+/**\n+ * A collection of bindings to facilitate use of the Amplify framework with Rx-centered APIs.\n+ */\n+@SuppressWarnings({\"WeakerAccess\", \"unused\"})\n+public final class RxAmplify {\n+\n+    @SuppressWarnings(\"checkstyle:all\") private RxAmplify() {}\n+\n+    // Breaking the rules, here. Don't look.\n+    @SuppressWarnings({\"checkstyle:all\", \"unused\"}) public static final RxApi API = new RxApiBinding();\n+    @SuppressWarnings({\"checkstyle:all\", \"unused\"}) public static final RxDataStore DataStore = new RxDataStoreBinding();\n+    @SuppressWarnings({\"checkstyle:all\", \"unused\"}) public static final RxHub Hub = new RxHubBinding();\n+    @SuppressWarnings({\"checkstyle:all\", \"unused\"}) public static final RxStorage Storage = new RxStorageBinding();\n+    // Logging currently has no callback/async behaviors\n+    // Analytics currently has no callback/async behaviors", "originalCommit": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDQ2Mw==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382314463", "bodyText": "Yea, we'll have to. But we should do it in a separate PR. This RxAmplify will need to be updated as well, but the nice thing is the compiler will tell us about it since they're in the same repo.", "author": "jamesonwilliams", "createdAt": "2020-02-20T23:22:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1MzI5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1ODA1MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382258050", "bodyText": "public interface RxApiCategoryBehavior extends RxRestBehavior, RxGraphQLBehavior {}\nAlso would be nice to agree on GraphQL vs GraphQl when naming our java classes.\nOn somewhat-related note, there is also similar inconsistency in datastore storage engine (Sql vs SQL, SQLite vs Sqlite)", "author": "raphkim", "createdAt": "2020-02-20T21:06:05Z", "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxApi.java", "diffHunk": "@@ -0,0 +1,25 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.rx;\n+\n+import com.amplifyframework.api.ApiCategoryBehavior;\n+\n+/**\n+ * An Rx-idiomatic expression of Amplify's {@link ApiCategoryBehavior}s.\n+ */\n+@SuppressWarnings(\"WeakerAccess\") // This is a public API.\n+public interface RxApi extends RxRestApi, RxGraphQlApi {\n+}", "originalCommit": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNjE5NQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382316195", "bodyText": "there is this guidance -\nhttps://stackoverflow.com/a/15526526/695787\nBut it\u2019s complicated since the acronyms are embedded in other words. I guess it should be GraphQL and Sqlite in pascal-case, and graphql and sqlite in camel-case? Does that sound right?", "author": "jamesonwilliams", "createdAt": "2020-02-20T23:27:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1ODA1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1ODc1MQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382258751", "bodyText": "Is this meant to be for plugin or category?", "author": "raphkim", "createdAt": "2020-02-20T21:07:48Z", "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxApiBinding.java", "diffHunk": "@@ -0,0 +1,262 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.rx;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.api.ApiCategoryBehavior;\n+import com.amplifyframework.api.ApiException;\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+import com.amplifyframework.api.graphql.GraphQLResponse;\n+import com.amplifyframework.api.graphql.MutationType;\n+import com.amplifyframework.api.graphql.SubscriptionType;\n+import com.amplifyframework.api.rest.RestOptions;\n+import com.amplifyframework.api.rest.RestResponse;\n+import com.amplifyframework.core.Amplify;\n+import com.amplifyframework.core.model.Model;\n+import com.amplifyframework.core.model.query.predicate.QueryPredicate;\n+\n+import io.reactivex.Observable;\n+import io.reactivex.Single;\n+\n+/**\n+ * An implementation of the RxApi which satisfies the API contract by wrapping\n+ * {@link ApiCategoryBehavior} in Rx primitives.\n+ */\n+final class RxApiBinding implements RxApi {\n+    private final ApiCategoryBehavior api;\n+\n+    RxApiBinding() {\n+        this(Amplify.API);\n+    }\n+\n+    @SuppressWarnings(\"WeakerAccess\")\n+    RxApiBinding(ApiCategoryBehavior api) {", "originalCommit": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxODM4MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382318380", "bodyText": "For the category\u2019s APIs. This stuff should work regardless of which plugin is implementing the behaviors.", "author": "jamesonwilliams", "createdAt": "2020-02-20T23:34:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1ODc1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMzNDUwMQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382334501", "bodyText": "Then I think ApiCategory is a better fit than ApiCategoryBehavior, since RxApiBinding simulates the category, not just a plugin", "author": "raphkim", "createdAt": "2020-02-21T00:25:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1ODc1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM3NTgxOQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382375819", "bodyText": "Hmm, yes you might be right. I think I agree. Let me give it a try anyway and see if there are any negative side effects to that proposal.", "author": "jamesonwilliams", "createdAt": "2020-02-21T03:07:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1ODc1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM5Mjk4NQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382392985", "bodyText": "It worked, I just had to play some small games in the unit tests to deal with the final categories.", "author": "jamesonwilliams", "createdAt": "2020-02-21T04:34:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1ODc1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1OTAzMw==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382259033", "bodyText": "RxDataStoreCategoryBehavior", "author": "raphkim", "createdAt": "2020-02-20T21:08:23Z", "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxDataStore.java", "diffHunk": "@@ -0,0 +1,137 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.rx;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.core.model.Model;\n+import com.amplifyframework.core.model.query.predicate.QueryPredicate;\n+import com.amplifyframework.datastore.DataStoreCategoryBehavior;\n+import com.amplifyframework.datastore.DataStoreItemChange;\n+\n+import io.reactivex.Completable;\n+import io.reactivex.Observable;\n+\n+/**\n+ * An Rx-idiomatic expression of the behaviors in {@link DataStoreCategoryBehavior}.\n+ */\n+@SuppressWarnings(\"unused\") // These are all public APIs\n+public interface RxDataStore {", "originalCommit": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM3NjIyNQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382376225", "bodyText": "Eh, yea, I think you're probably right.\nWe had talked at one point about dropping the CategoryBehavior from even core. They're descriptive, but when you think about it from a customer standpoint, they have like:\nDataStoreCategoryBehavior ds = Amplify.DataStore;\n\nBut the customer would probably rather just write like:\nDataStore ds = Amplify.DataStore", "author": "jamesonwilliams", "createdAt": "2020-02-21T03:09:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1OTAzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM5MzA1NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382393054", "bodyText": "I went with the + CategoryBehavior versions for now. We can come back and remove them from all places at the same time, maybe.", "author": "jamesonwilliams", "createdAt": "2020-02-21T04:34:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1OTAzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1OTU0Nw==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382259547", "bodyText": "RxHubCategoryBehavior", "author": "raphkim", "createdAt": "2020-02-20T21:09:40Z", "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxHub.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.rx;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.hub.HubCategoryBehavior;\n+import com.amplifyframework.hub.HubChannel;\n+import com.amplifyframework.hub.HubEvent;\n+import com.amplifyframework.hub.HubException;\n+\n+import io.reactivex.Completable;\n+import io.reactivex.Observable;\n+\n+/**\n+ * An Rx-idiomatic version of Amplify's {@link HubCategoryBehavior}.\n+ */\n+@SuppressWarnings(\"unused\") // These are public APIs\n+public interface RxHub {", "originalCommit": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM5MzEzMw==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382393133", "bodyText": "Done", "author": "jamesonwilliams", "createdAt": "2020-02-21T04:35:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1OTU0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1OTkxMw==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382259913", "bodyText": "public interface RxStorageCategoryBehavior {", "author": "raphkim", "createdAt": "2020-02-20T21:10:35Z", "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxStorage.java", "diffHunk": "@@ -0,0 +1,149 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.rx;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.storage.StorageCategoryBehavior;\n+import com.amplifyframework.storage.options.StorageDownloadFileOptions;\n+import com.amplifyframework.storage.options.StorageListOptions;\n+import com.amplifyframework.storage.options.StorageRemoveOptions;\n+import com.amplifyframework.storage.options.StorageUploadFileOptions;\n+import com.amplifyframework.storage.result.StorageDownloadFileResult;\n+import com.amplifyframework.storage.result.StorageListResult;\n+import com.amplifyframework.storage.result.StorageRemoveResult;\n+import com.amplifyframework.storage.result.StorageUploadFileResult;\n+\n+import io.reactivex.Single;\n+\n+/**\n+ * An Rx idiomatic expression of the facilities in Amplify's {@link StorageCategoryBehavior}.\n+ */\n+@SuppressWarnings(\"unused\")\n+public interface RxStorage {", "originalCommit": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM5MzExMg==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382393112", "bodyText": "Done", "author": "jamesonwilliams", "createdAt": "2020-02-21T04:35:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI1OTkxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI2MTQ1MQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382261451", "bodyText": "Is it cancelable in iOS?", "author": "raphkim", "createdAt": "2020-02-20T21:14:01Z", "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxStorageBinding.java", "diffHunk": "@@ -0,0 +1,114 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.rx;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.VisibleForTesting;\n+\n+import com.amplifyframework.core.Amplify;\n+import com.amplifyframework.core.async.NoOpCancelable;\n+import com.amplifyframework.storage.StorageCategoryBehavior;\n+import com.amplifyframework.storage.StorageException;\n+import com.amplifyframework.storage.options.StorageDownloadFileOptions;\n+import com.amplifyframework.storage.options.StorageListOptions;\n+import com.amplifyframework.storage.options.StorageRemoveOptions;\n+import com.amplifyframework.storage.options.StorageUploadFileOptions;\n+import com.amplifyframework.storage.result.StorageDownloadFileResult;\n+import com.amplifyframework.storage.result.StorageListResult;\n+import com.amplifyframework.storage.result.StorageRemoveResult;\n+import com.amplifyframework.storage.result.StorageUploadFileResult;\n+\n+import io.reactivex.Single;\n+\n+final class RxStorageBinding implements RxStorage {\n+    private final StorageCategoryBehavior storage;\n+\n+    RxStorageBinding() {\n+        this(Amplify.Storage);\n+    }\n+\n+    @VisibleForTesting\n+    @SuppressWarnings(\"WeakerAccess\")\n+    RxStorageBinding(StorageCategoryBehavior storage) {\n+        this.storage = storage;\n+    }\n+\n+    @NonNull\n+    @Override\n+    public Single<StorageDownloadFileResult> downloadFile(@NonNull String key, @NonNull String local) {\n+        return toSingle((onResult, onError) -> storage.downloadFile(key, local, onResult, onError));\n+    }\n+\n+    @NonNull\n+    @Override\n+    public Single<StorageDownloadFileResult> downloadFile(\n+            @NonNull String key, @NonNull String local, @NonNull StorageDownloadFileOptions options) {\n+        return toSingle((onResult, onError) -> storage.downloadFile(key, local, options, onResult, onError));\n+    }\n+\n+    @NonNull\n+    @Override\n+    public Single<StorageUploadFileResult> uploadFile(@NonNull String key, @NonNull String local) {\n+        return toSingle((onResult, onError) -> storage.uploadFile(key, local, onResult, onError));\n+    }\n+\n+    @NonNull\n+    @Override\n+    public Single<StorageUploadFileResult> uploadFile(\n+            @NonNull String key, @NonNull String local, @NonNull StorageUploadFileOptions options) {\n+        return toSingle((onResult, onError) -> storage.uploadFile(key, local, options, onResult, onError));\n+    }\n+\n+    @NonNull\n+    @Override\n+    public Single<StorageRemoveResult> remove(@NonNull String key) {\n+        return toSingle((onResult, onError) -> {\n+            storage.remove(key, onResult, onError);\n+            return new NoOpCancelable(); // StorageRemoveOperation (above) is not Cancelable right now!", "originalCommit": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM3NjUwNw==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382376507", "bodyText": "Looks like it is, yea: https://github.com/aws-amplify/amplify-ios/blob/master/AmplifyPlugins/Storage/AWSS3StoragePlugin/Operation/AWSS3StorageRemoveOperation.swift#L32", "author": "jamesonwilliams", "createdAt": "2020-02-21T03:10:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI2MTQ1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI2MzE0OA==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382263148", "bodyText": "Ugh, we should just use Cancellable and Cancelled everywhere since that's what RX went with when naming Cancellable interface.", "author": "raphkim", "createdAt": "2020-02-20T21:18:18Z", "path": "rxbindings/src/test/java/com/amplifyframework/rx/RxAdaptersTest.java", "diffHunk": "@@ -0,0 +1,185 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.rx;\n+\n+import com.amplifyframework.core.async.Cancelable;\n+import com.amplifyframework.core.async.NoOpCancelable;\n+import com.amplifyframework.rx.RxAdapters.CancelableResultEmitter;\n+import com.amplifyframework.rx.RxAdapters.CancelableStreamEmitter;\n+import com.amplifyframework.rx.RxAdapters.VoidResultEmitter;\n+import com.amplifyframework.testutils.RandomString;\n+import com.amplifyframework.testutils.SimpleCancelable;\n+\n+import org.junit.Test;\n+\n+import io.reactivex.Completable;\n+import io.reactivex.Observable;\n+import io.reactivex.Single;\n+import io.reactivex.observers.TestObserver;\n+\n+import static org.junit.Assert.assertTrue;\n+\n+/**\n+ * Tests the {@link RxAdapters} utility methods.\n+ */\n+public final class RxAdaptersTest {\n+    /**\n+     * The {@link Completable} returned by {@link RxAdapters#toCompletable(VoidResultEmitter)}\n+     * will complete when {@link VoidResultEmitter}'s result consumer is invoked.\n+     */\n+    @Test\n+    public void completableFiresOnCompleteWhenResultEmitted() {\n+        RxAdapters\n+            .toCompletable((onResult, onError) -> onResult.accept(RandomString.string()))\n+            .test()\n+            .assertComplete()\n+            .assertNoErrors();\n+    }\n+\n+    /**\n+     * The {@link Completable} returned by {@link RxAdapters#toCompletable(VoidResultEmitter)}\n+     * will dispatch an error when {@link VoidResultEmitter}'s error consumer is invoked.\n+     */\n+    @Test\n+    public void completableFiresErrorWhenErrorEmitted() {\n+        Throwable expected = new Throwable(RandomString.string());\n+        RxAdapters\n+            .toCompletable((onResult, onError) -> onError.accept(expected))\n+            .test()\n+            .assertError(expected)\n+            .assertNotComplete();\n+    }\n+\n+    /**\n+     * The {@link Completable} returned by {@link RxAdapters#toCompletable(VoidResultEmitter)}\n+     * is cancelable.\n+     */\n+    @SuppressWarnings(\"checkstyle:WhitespaceAround\")\n+    @Test\n+    public void completableIsCancellable() {\n+        Completable completable = RxAdapters.toCompletable(((onResult, onError) -> {}));\n+        TestObserver<?> observer = completable.test();\n+        observer.cancel();\n+        assertTrue(observer.isCancelled());\n+    }\n+\n+    /**\n+     * The {@link Single} returned by {@link RxAdapters#toSingle(CancelableResultEmitter)}\n+     * will dispatch an error when the {@link CancelableResultEmitter}'s error consumer is\n+     * invoked.\n+     */\n+    @Test\n+    public void singleFiresErrorWhenErrorEmitted() {\n+        Throwable expected = new Throwable(RandomString.string());\n+        RxAdapters\n+            .toSingle((onResult, onError) -> {\n+                onError.accept(expected);\n+                return new NoOpCancelable();\n+            })\n+            .test()\n+            .assertError(expected)\n+            .assertNoValues();\n+    }\n+\n+    /**\n+     * The {@link Single} returned by {@link RxAdapters#toSingle(CancelableResultEmitter)}\n+     * will dispatch a result when the {@link CancelableResultEmitter}'s value consumer\n+     * is invoked.\n+     */\n+    @Test\n+    public void singleFiresResultWhenEmitted() {\n+        String result = RandomString.string();\n+        RxAdapters\n+            .toSingle((onResult, onError) -> {\n+                onResult.accept(result);\n+                return new NoOpCancelable();\n+            })\n+            .test()\n+            .assertValue(result)\n+            .assertComplete();\n+    }\n+\n+    /**\n+     * {@link RxAdapters#toSingle(CancelableResultEmitter)} returns a {@link Single} which\n+     * can be canceled. The Amplify {@link Cancelable} returned by that emitter will also show\n+     * as canceled.\n+     */\n+    @Test\n+    public void singleIsCancelable() {\n+        SimpleCancelable cancelable = new SimpleCancelable();\n+        TestObserver<?> observer = RxAdapters.toSingle(((onResult, onError) -> cancelable))\n+            .test();\n+        observer.cancel();\n+        assertTrue(observer.isCancelled());\n+        assertTrue(cancelable.isCanceled());", "originalCommit": "89bab29cc9b8fd66db1a819dd7cd1fb5dd0951a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM3ODIzNw==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382378237", "bodyText": "Yea, I agree. American English is the only dialect of English that prefers the spelling Cancelable. But, I think I researched this one day and determined that it was a non-American who added Cancellable into Java. So, I guess they win by virtue of getting their first!", "author": "jamesonwilliams", "createdAt": "2020-02-21T03:18:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI2MzE0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM5MzA5MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/268#discussion_r382393090", "bodyText": "For another PR...", "author": "jamesonwilliams", "createdAt": "2020-02-21T04:35:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI2MzE0OA=="}], "type": "inlineReview"}, {"oid": "da2c13e6e24c0f06b0dbb723d4f192294f8e0802", "url": "https://github.com/aws-amplify/amplify-android/commit/da2c13e6e24c0f06b0dbb723d4f192294f8e0802", "message": "Address comments from Raphael's review", "committedDate": "2020-02-21T04:26:46Z", "type": "commit"}, {"oid": "d59e7b33408363ce699eb3c81c7bbd30c447b7e9", "url": "https://github.com/aws-amplify/amplify-android/commit/d59e7b33408363ce699eb3c81c7bbd30c447b7e9", "message": "Merge remote-tracking branch 'origin/master' into rxbindings", "committedDate": "2020-02-21T04:30:34Z", "type": "commit"}]}