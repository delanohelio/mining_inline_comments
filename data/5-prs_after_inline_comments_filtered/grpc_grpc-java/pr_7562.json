{"pr_number": 7562, "pr_title": "xds: add a V2 test for CDS response with UpstreamTlsContext and fix the broken CDS response processing", "pr_createdAt": "2020-10-28T00:10:02Z", "pr_url": "https://github.com/grpc/grpc-java/pull/7562", "timeline": [{"oid": "94bdb9c3f98fec0e2a39a2fcb4fd997894b8aa30", "url": "https://github.com/grpc/grpc-java/commit/94bdb9c3f98fec0e2a39a2fcb4fd997894b8aa30", "message": "xds: add a V2 test for CDS response with UpstreamTlsContext", "committedDate": "2020-10-28T00:05:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzEwODE3Ng==", "url": "https://github.com/grpc/grpc-java/pull/7562#discussion_r513108176", "bodyText": "These two typeUrl should be defined in ClientXdsClient as they are used for client's specific business logic.\nThe abstract layer only decode xDS resource blobs to List<Any>, the remaining processing should be done in the  business logic layer.", "author": "voidzcy", "createdAt": "2020-10-28T00:23:38Z", "path": "xds/src/main/java/io/grpc/xds/AbstractXdsClient.java", "diffHunk": "@@ -64,13 +64,20 @@\n       \"type.googleapis.com/envoy.api.v2.RouteConfiguration\";\n   private static final String ADS_TYPE_URL_RDS =\n       \"type.googleapis.com/envoy.config.route.v3.RouteConfiguration\";\n-  private static final String ADS_TYPE_URL_CDS_V2 = \"type.googleapis.com/envoy.api.v2.Cluster\";\n+  @VisibleForTesting\n+  static final String ADS_TYPE_URL_CDS_V2 = \"type.googleapis.com/envoy.api.v2.Cluster\";\n   private static final String ADS_TYPE_URL_CDS =\n       \"type.googleapis.com/envoy.config.cluster.v3.Cluster\";\n   private static final String ADS_TYPE_URL_EDS_V2 =\n       \"type.googleapis.com/envoy.api.v2.ClusterLoadAssignment\";\n   private static final String ADS_TYPE_URL_EDS =\n       \"type.googleapis.com/envoy.config.endpoint.v3.ClusterLoadAssignment\";\n+  @VisibleForTesting\n+  static final String TYPE_URL_UPSTREAM_TLS_CONTEXT =", "originalCommit": "94bdb9c3f98fec0e2a39a2fcb4fd997894b8aa30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzEwODk2OA==", "url": "https://github.com/grpc/grpc-java/pull/7562#discussion_r513108968", "bodyText": "There is an existing example for HttpConnectionManager:\n\n  \n    \n      grpc-java/xds/src/main/java/io/grpc/xds/ClientXdsClient.java\n    \n    \n        Lines 71 to 76\n      in\n      90a3873\n    \n    \n    \n    \n\n        \n          \n           private static final String TYPE_URL_HTTP_CONNECTION_MANAGER_V2 = \n        \n\n        \n          \n               \"type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2\" \n        \n\n        \n          \n                   + \".HttpConnectionManager\"; \n        \n\n        \n          \n           private static final String TYPE_URL_HTTP_CONNECTION_MANAGER = \n        \n\n        \n          \n               \"type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3\" \n        \n\n        \n          \n                   + \".HttpConnectionManager\";", "author": "voidzcy", "createdAt": "2020-10-28T00:26:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzEwODE3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzExNDY2Mg==", "url": "https://github.com/grpc/grpc-java/pull/7562#discussion_r513114662", "bodyText": "fixed", "author": "sanjaypujare", "createdAt": "2020-10-28T00:46:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzEwODE3Ng=="}], "type": "inlineReview"}, {"oid": "23c7d91c995dad5d9a616c341da73f2d73b7e4a8", "url": "https://github.com/grpc/grpc-java/commit/23c7d91c995dad5d9a616c341da73f2d73b7e4a8", "message": "address review comments", "committedDate": "2020-10-28T00:45:37Z", "type": "commit"}]}