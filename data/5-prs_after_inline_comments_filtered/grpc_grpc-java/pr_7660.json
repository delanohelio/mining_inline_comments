{"pr_number": 7660, "pr_title": "xds: provide more debug info for priority lb error-picker", "pr_createdAt": "2020-11-24T08:48:44Z", "pr_url": "https://github.com/grpc/grpc-java/pull/7660", "timeline": [{"oid": "a9be986ad65bb10b8bbf137583c18cfe77b0e451", "url": "https://github.com/grpc/grpc-java/commit/a9be986ad65bb10b8bbf137583c18cfe77b0e451", "message": "xds: provide more debug info for priority lb error-picker", "committedDate": "2020-11-24T20:41:58Z", "type": "forcePushed"}, {"oid": "b6ac91cd336033f22272e118829eda91401a8281", "url": "https://github.com/grpc/grpc-java/commit/b6ac91cd336033f22272e118829eda91401a8281", "message": "xds: provide more debug info for priority lb error-picker", "committedDate": "2020-11-30T17:21:06Z", "type": "commit"}, {"oid": "b6ac91cd336033f22272e118829eda91401a8281", "url": "https://github.com/grpc/grpc-java/commit/b6ac91cd336033f22272e118829eda91401a8281", "message": "xds: provide more debug info for priority lb error-picker", "committedDate": "2020-11-30T17:21:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzgyNjE2NQ==", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r533826165", "bodyText": "I don't think using the last priority's error message is better than just saying cannot establish connection to any priority.", "author": "voidzcy", "createdAt": "2020-12-02T01:04:41Z", "path": "xds/src/main/java/io/grpc/xds/PriorityLoadBalancer.java", "diffHunk": "@@ -153,7 +153,9 @@ private void tryNextPriority(boolean reportConnecting) {\n     }\n     // TODO(zdapeng): Include error details of each priority.\n     logger.log(XdsLogLevel.DEBUG, \"All priority failed\");\n-    updateOverallState(TRANSIENT_FAILURE, new ErrorPicker(Status.UNAVAILABLE));\n+    String lastPriority = priorityNames.get(priorityNames.size() - 1);", "originalCommit": "b6ac91cd336033f22272e118829eda91401a8281", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ5MjAxMg==", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r534492012", "bodyText": "I am fine with using the last priority's error state as the overall error state for the LB. I am encountering the similar situation in cluster_resolver LB.", "author": "voidzcy", "createdAt": "2020-12-02T21:26:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzgyNjE2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ5NDAwNQ==", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r534494005", "bodyText": "We could delete this TODO. It's a bit undefined for how to aggregate multiple error statuses.", "author": "voidzcy", "createdAt": "2020-12-02T21:30:20Z", "path": "xds/src/main/java/io/grpc/xds/PriorityLoadBalancer.java", "diffHunk": "@@ -153,7 +153,9 @@ private void tryNextPriority(boolean reportConnecting) {\n     }\n     // TODO(zdapeng): Include error details of each priority.", "originalCommit": "b6ac91cd336033f22272e118829eda91401a8281", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUzNDA0MA==", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r535534040", "bodyText": "I was considering a status with a cause that suppresses a list of status exceptions for all priorities, or something similar, as further improvement in the future.", "author": "dapengzhang0", "createdAt": "2020-12-03T19:42:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ5NDAwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTU3NDEyNg==", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r535574126", "bodyText": "That sounds a horrible idea though. Using the last priority's connection status is good enough as per current design.", "author": "voidzcy", "createdAt": "2020-12-03T20:30:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ5NDAwNQ=="}], "type": "inlineReview"}]}