{"pr_number": 1467, "pr_title": "Import of SlackTerminal extension during CGMES import (SynchronousMachine.referencePriority)", "pr_createdAt": "2020-09-11T13:50:39Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1467", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg0NzgzMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1467#discussion_r487847832", "bodyText": "I am not sure to understand: why do you attach a bus instead of a bus ?", "author": "annetill", "createdAt": "2020-09-14T11:43:03Z", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/SynchronousMachineConversion.java", "diffHunk": "@@ -55,6 +56,13 @@ public void convert() {\n         Generator g = adder.add();\n         convertedTerminals(g.getTerminal());\n         convertReactiveLimits(g);\n+        if (p.asInt(\"referencePriority\", 0) > 0) {\n+            if (g.getTerminal().getBusBreakerView().getBus() == null) {\n+                context.ignored(\"referencePriority\", () -> String.format(\"%s is disconnected from the network\", g.getId()));\n+            } else {\n+                SlackTerminal.attach(g.getTerminal().getBusBreakerView().getBus());", "originalCommit": "a78eff783198d5326e3c6ce4ddf08720666875df", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA2Mjk5NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1467#discussion_r490062994", "bodyText": "Even if the generator is disconnected from the network at this point, it may become eventually connected (if a switch is closed).\nAlso, we could keep the information to be able to reproduce in the CGMES SSH export the same Steady State Hypothesis we have seen in the original files.", "author": "zamarrenolm", "createdAt": "2020-09-17T08:25:24Z", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/SynchronousMachineConversion.java", "diffHunk": "@@ -57,7 +57,11 @@ public void convert() {\n         convertedTerminals(g.getTerminal());\n         convertReactiveLimits(g);\n         if (p.asInt(\"referencePriority\", 0) > 0) {\n-            SlackTerminal.attach(g.getTerminal().getBusBreakerView().getBus());\n+            if (g.getTerminal().getBusBreakerView().getBus() == null) {\n+                context.ignored(\"referencePriority\", () -> String.format(\"%s is disconnected from the network\", g.getId()));", "originalCommit": "767ac3f272a372a23a476f073cba417ffc523ef5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ5MTMwNQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1467#discussion_r490491305", "bodyText": "@MioRtia can you here not use the attach method but the set one in provinding directly the connected terminal of the generator ? With that, you can always set the extension, no ?", "author": "annetill", "createdAt": "2020-09-17T19:08:17Z", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/SynchronousMachineConversion.java", "diffHunk": "@@ -55,6 +56,13 @@ public void convert() {\n         Generator g = adder.add();\n         convertedTerminals(g.getTerminal());\n         convertReactiveLimits(g);\n+        if (p.asInt(\"referencePriority\", 0) > 0) {\n+            if (g.getTerminal().getBusBreakerView().getBus() == null) {\n+                context.ignored(\"referencePriority\", () -> String.format(\"%s is disconnected from the network\", g.getId()));\n+            } else {\n+                SlackTerminal.attach(g.getTerminal().getBusBreakerView().getBus());", "originalCommit": "3444694c0712dd01492045c07cb109d31aaf0dae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDgzODYxMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1467#discussion_r490838612", "bodyText": "@zamarrenolm This will solve your third point (the terminal defined will be the terminal of the equipment). For the other point, since I think the case where a voltage level contains two slack terminals of different synchronous components is rare, couldn't we ignore this case? Maybe we should look at how often it happens in real life.", "author": "miovd", "createdAt": "2020-09-18T09:58:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ5MTMwNQ=="}], "type": "inlineReview"}, {"oid": "d7236d8bb44a9c41d177271c19b2172666aec10f", "url": "https://github.com/powsybl/powsybl-core/commit/d7236d8bb44a9c41d177271c19b2172666aec10f", "message": "Set SlackTerminal directly with the terminal and not the bus\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-18T10:06:54Z", "type": "forcePushed"}, {"oid": "dc4b23019b488239ba37fc51ff2c8baa69439353", "url": "https://github.com/powsybl/powsybl-core/commit/dc4b23019b488239ba37fc51ff2c8baa69439353", "message": "cgmes import : use reference priority to define slack\n\nSigned-off-by: Luma <zamarrenolm@aia.es>", "committedDate": "2020-09-18T10:08:08Z", "type": "commit"}, {"oid": "d087f1c2eff23d6c6449659767f30f3f6822a0da", "url": "https://github.com/powsybl/powsybl-core/commit/d087f1c2eff23d6c6449659767f30f3f6822a0da", "message": "Update comparison to compare SlackTerminal extension after CGMES import\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-18T10:08:08Z", "type": "commit"}, {"oid": "3943f7f499a134ccc2f688134f8612deb4e5a0dc", "url": "https://github.com/powsybl/powsybl-core/commit/3943f7f499a134ccc2f688134f8612deb4e5a0dc", "message": "Ignore SynchronousMachine.referencePriority if the synchronous machine is disconnected from the network\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-18T10:08:09Z", "type": "commit"}, {"oid": "f109d52869faeea330d087fa20bda95f06b81c8a", "url": "https://github.com/powsybl/powsybl-core/commit/f109d52869faeea330d087fa20bda95f06b81c8a", "message": "Add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-18T10:08:09Z", "type": "commit"}, {"oid": "8b4e4f2a25e5e79c4b75e584ede1d94791e92481", "url": "https://github.com/powsybl/powsybl-core/commit/8b4e4f2a25e5e79c4b75e584ede1d94791e92481", "message": "Revert \"Add test\"\n\nThis reverts commit a78eff7\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-18T10:08:09Z", "type": "commit"}, {"oid": "b0def484e25423fbc0058e0e19f058f36a39591e", "url": "https://github.com/powsybl/powsybl-core/commit/b0def484e25423fbc0058e0e19f058f36a39591e", "message": "Set SlackTerminal directly with the terminal and not the bus\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-18T10:08:09Z", "type": "commit"}, {"oid": "b0def484e25423fbc0058e0e19f058f36a39591e", "url": "https://github.com/powsybl/powsybl-core/commit/b0def484e25423fbc0058e0e19f058f36a39591e", "message": "Set SlackTerminal directly with the terminal and not the bus\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-18T10:08:09Z", "type": "forcePushed"}]}