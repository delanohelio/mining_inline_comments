{"pr_number": 1494, "pr_title": "Deplace LoadDetailXmlSerializer in iidm-xml-converter", "pr_createdAt": "2020-10-01T14:38:08Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1494", "timeline": [{"oid": "a89ed5498d961bb8cc7f8ff579fb7c6740a6737e", "url": "https://github.com/powsybl/powsybl-core/commit/a89ed5498d961bb8cc7f8ff579fb7c6740a6737e", "message": "Deplace LoadDetailXmlSerializer in iidm-xml-converter\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-10-01T14:37:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODMxNjA2OA==", "url": "https://github.com/powsybl/powsybl-core/pull/1494#discussion_r498316068", "bodyText": "I'm not sure it's useful (or it's working...):\n\nPeople that need this serializer needs powsybl-iidm-xml-converter, so they automatically have the serializer\nYou will have 2 serializer for the same extension: is it working?\n\nI propose to simply move the class without managing the compatibility at compile time. At runtime, it will work perfectly.", "author": "mathbagu", "createdAt": "2020-10-01T15:04:35Z", "path": "iidm/iidm-extensions/src/main/java/com/powsybl/iidm/network/extensions/LoadDetailXmlSerializer.java", "diffHunk": "@@ -6,61 +6,10 @@\n  */\n package com.powsybl.iidm.network.extensions;\n \n-import com.google.auto.service.AutoService;\n-import com.powsybl.commons.extensions.AbstractExtensionXmlSerializer;\n-import com.powsybl.commons.extensions.ExtensionXmlSerializer;\n-import com.powsybl.commons.xml.XmlReaderContext;\n-import com.powsybl.commons.xml.XmlUtil;\n-import com.powsybl.commons.xml.XmlWriterContext;\n-import com.powsybl.iidm.network.Load;\n-\n-import javax.xml.stream.XMLStreamException;\n-\n /**\n  * @author Geoffroy Jamgotchian <geoffroy.jamgotchian at rte-france.com>\n+ *\n+ * @deprecated Use {@link com.powsybl.iidm.xml.extensions.LoadDetailXmlSerializer} instead.\n  */\n-@AutoService(ExtensionXmlSerializer.class)\n-public class LoadDetailXmlSerializer extends AbstractExtensionXmlSerializer<Load, LoadDetail> {\n-\n-    public LoadDetailXmlSerializer() {\n-        super(\"detail\", \"network\", LoadDetail.class,\n-                false, \"loadDetail.xsd\",\n-                \"http://www.itesla_project.eu/schema/iidm/ext/load_detail/1_0\",\n-                \"ld\");\n-    }\n-\n-    @Override\n-    public void write(LoadDetail detail, XmlWriterContext context) throws XMLStreamException {\n-        XmlUtil.writeFloat(\"fixedActivePower\", detail.getFixedActivePower(), context.getExtensionsWriter());\n-        XmlUtil.writeFloat(\"fixedReactivePower\", detail.getFixedReactivePower(), context.getExtensionsWriter());\n-        XmlUtil.writeFloat(\"variableActivePower\", detail.getVariableActivePower(), context.getExtensionsWriter());\n-        XmlUtil.writeFloat(\"variableReactivePower\", detail.getVariableReactivePower(), context.getExtensionsWriter());\n-    }\n-\n-    @Override\n-    public LoadDetail read(Load load, XmlReaderContext context) {\n-        float fixedActivePower = XmlUtil.readOptionalFloatAttribute(context.getReader(), \"fixedActivePower\");\n-        if (Float.isNaN(fixedActivePower)) {\n-            fixedActivePower = XmlUtil.readFloatAttribute(context.getReader(), \"subLoad1ActivePower\");\n-        }\n-        float fixedReactivePower = XmlUtil.readOptionalFloatAttribute(context.getReader(), \"fixedReactivePower\");\n-        if (Float.isNaN(fixedReactivePower)) {\n-            fixedReactivePower = XmlUtil.readFloatAttribute(context.getReader(), \"subLoad1ReactivePower\");\n-        }\n-        float variableActivePower = XmlUtil.readOptionalFloatAttribute(context.getReader(), \"variableActivePower\");\n-        if (Float.isNaN(variableActivePower)) {\n-            variableActivePower = XmlUtil.readFloatAttribute(context.getReader(), \"subLoad2ActivePower\");\n-        }\n-        float variableReactivePower = XmlUtil.readOptionalFloatAttribute(context.getReader(), \"variableReactivePower\");\n-        if (Float.isNaN(variableReactivePower)) {\n-            variableReactivePower = XmlUtil.readFloatAttribute(context.getReader(), \"subLoad2ReactivePower\");\n-        }\n-        load.newExtension(LoadDetailAdder.class)\n-                .withFixedActivePower(fixedActivePower)\n-                .withFixedReactivePower(fixedReactivePower)\n-                .withVariableActivePower(variableActivePower)\n-                .withVariableReactivePower(variableReactivePower)\n-                .add();\n-        return load.getExtension(LoadDetail.class);\n-    }\n+public class LoadDetailXmlSerializer extends com.powsybl.iidm.xml.extensions.LoadDetailXmlSerializer {", "originalCommit": "a89ed5498d961bb8cc7f8ff579fb7c6740a6737e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc4ODcxNw==", "url": "https://github.com/powsybl/powsybl-core/pull/1494#discussion_r498788717", "bodyText": "You're right, it is only ever used in runtime so keeping it is useless.", "author": "miovd", "createdAt": "2020-10-02T12:25:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODMxNjA2OA=="}], "type": "inlineReview"}, {"oid": "dd067278b2a3879b6ea9622aed872f6a45565ff9", "url": "https://github.com/powsybl/powsybl-core/commit/dd067278b2a3879b6ea9622aed872f6a45565ff9", "message": "Delete old LoadDetailXmlSerializer\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-10-02T12:32:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM4MDYwMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1494#discussion_r499380602", "bodyText": "Maybe this test could be part of the TCK and have a subclass in each implementation?", "author": "mathbagu", "createdAt": "2020-10-05T07:03:09Z", "path": "iidm/iidm-impl/src/test/java/com/powsybl/iidm/network/impl/extensions/LoadDetailTest.java", "diffHunk": "@@ -24,7 +26,7 @@\n  */\n public class LoadDetailTest {", "originalCommit": "dd067278b2a3879b6ea9622aed872f6a45565ff9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "84b68a97cd74e9cf23d148e009a32421ce319812", "url": "https://github.com/powsybl/powsybl-core/commit/84b68a97cd74e9cf23d148e009a32421ce319812", "message": "Merge branch 'master' into deplace_loaddetailxmlserializer", "committedDate": "2020-10-05T08:30:28Z", "type": "commit"}]}