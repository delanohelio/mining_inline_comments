{"pr_number": 1204, "pr_title": "Fix bug: check target deadband when setting regulation status to prevent inconsistent data", "pr_createdAt": "2020-03-04T15:00:11Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1204", "timeline": [{"oid": "14ecb08a18f6e810a2d19a6e0782d98d58141068", "url": "https://github.com/powsybl/powsybl-core/commit/14ecb08a18f6e810a2d19a6e0782d98d58141068", "message": "Fix bug: check target deadband when setting regulation status to prevent inconsistent data\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-03-04T14:58:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzczNTMxNA==", "url": "https://github.com/powsybl/powsybl-core/pull/1204#discussion_r387735314", "bodyText": "This seems to imply that the target deadband should always be set before using setRegulating. Should we propose a function to set the PST as regulating, together with the definition of the target deadband?", "author": "agnesLeroy", "createdAt": "2020-03-04T15:20:06Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/PhaseTapChangerImpl.java", "diffHunk": "@@ -58,6 +58,7 @@ protected NetworkImpl getNetwork() {\n     @Override\n     public PhaseTapChangerImpl setRegulating(boolean regulating) {\n         ValidationUtil.checkPhaseTapChangerRegulation(parent, getRegulationMode(), getRegulationValue(), regulating, getRegulationTerminal(), getNetwork());\n+        ValidationUtil.checkTargetDeadband(parent, type, regulating, getTargetDeadband());", "originalCommit": "14ecb08a18f6e810a2d19a6e0782d98d58141068", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc2MDg4MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1204#discussion_r387760880", "bodyText": "It is the same principle as regulationValue, regulationMode and regulationTerminal: targetDeadband must be defined before setting regulation status to true. To do otherwise, a method with all these parameters should be implemented since they are all dependent on each other and it increases risks of confusion when using the API. The pattern setAttribute(attribute) has been chosen to be user-friendly even if the drawback is to be careful of the set order.", "author": "miovd", "createdAt": "2020-03-04T15:56:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzczNTMxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc3ODc0Ng==", "url": "https://github.com/powsybl/powsybl-core/pull/1204#discussion_r387778746", "bodyText": "I am adding some tests to check the exception is thrown if setters are not called in the right order.", "author": "miovd", "createdAt": "2020-03-04T16:21:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzczNTMxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzczNTQ5MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1204#discussion_r387735491", "bodyText": "Same comment", "author": "agnesLeroy", "createdAt": "2020-03-04T15:20:22Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/RatioTapChangerImpl.java", "diffHunk": "@@ -57,6 +57,7 @@ protected NetworkImpl getNetwork() {\n     @Override\n     public RatioTapChangerImpl setRegulating(boolean regulating) {\n         ValidationUtil.checkRatioTapChangerRegulation(parent, regulating, regulationTerminal, getTargetV(), getNetwork());\n+        ValidationUtil.checkTargetDeadband(parent, type, regulating, getTargetDeadband());", "originalCommit": "14ecb08a18f6e810a2d19a6e0782d98d58141068", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "19fc7b89e2a8debfa65e1fd2a5a414e299b60663", "url": "https://github.com/powsybl/powsybl-core/commit/19fc7b89e2a8debfa65e1fd2a5a414e299b60663", "message": "refactoring\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-03-04T16:25:28Z", "type": "commit"}, {"oid": "f159ced23f11618640239164055281d88b32b395", "url": "https://github.com/powsybl/powsybl-core/commit/f159ced23f11618640239164055281d88b32b395", "message": "add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-03-04T16:25:36Z", "type": "commit"}, {"oid": "c60a90d1b1e8b031f8dc87ebd766a91de66d060d", "url": "https://github.com/powsybl/powsybl-core/commit/c60a90d1b1e8b031f8dc87ebd766a91de66d060d", "message": "Merge branch 'master' into bug_targetDeadband", "committedDate": "2020-03-05T09:19:59Z", "type": "commit"}]}