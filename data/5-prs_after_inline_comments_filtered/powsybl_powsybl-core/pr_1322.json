{"pr_number": 1322, "pr_title": "Redesign IIDM shunt compensator allowing non linear shunts + updated conversions + updated serialization", "pr_createdAt": "2020-05-26T07:59:31Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1322", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzNzcxOA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r430237718", "bodyText": "This function will be shared by ShuntCompensatorLinearModel and ShuntCompensatorNonLinearModel, right ? Why cannot we have simply getbPerSection(int sectionIndex) ?", "author": "annetill", "createdAt": "2020-05-26T08:20:47Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ShuntCompensatorModel.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public interface ShuntCompensatorModel {\n+\n+    /**\n+     * Get the section susceptance in S of the section with a given section number if it exists.\n+     * Return 0 if sectionIndex is equal to 0 (disconnected state).\n+     * Throw an exception if such a section does not exist.\n+     */\n+    double getBSection(int sectionIndex);", "originalCommit": "a7b9c075bd3a072369ad8c3f7dd1eccf58cdff1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1ODU2OA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r431358568", "bodyText": "Do you have any other idea ?", "author": "annetill", "createdAt": "2020-05-27T18:33:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzNzcxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEzNzI1Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435137252", "bodyText": "Yes, I agree with your proposition. It will probably be clearer.", "author": "miovd", "createdAt": "2020-06-04T10:01:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzNzcxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzODE0MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r430238140", "bodyText": "getbPerSection or getBPerSection ?", "author": "annetill", "createdAt": "2020-05-26T08:21:32Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ShuntCompensatorLinearModel.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public interface ShuntCompensatorLinearModel extends ShuntCompensatorModel {\n+\n+    /**\n+     * Get the susceptance per section in S.\n+     */\n+    double getbPerSection();", "originalCommit": "a7b9c075bd3a072369ad8c3f7dd1eccf58cdff1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEzNzg3MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435137871", "bodyText": "For consistence, we might as well rename as getBPerSection", "author": "miovd", "createdAt": "2020-06-04T10:02:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzODE0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r430239029", "bodyText": "Why do you need this function ?", "author": "annetill", "createdAt": "2020-05-26T08:23:07Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ShuntCompensatorNonLinearModel.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public interface ShuntCompensatorNonLinearModel extends ShuntCompensatorModel {\n+\n+    interface Section {\n+\n+        /**\n+         * Get the susceptance in S of the section.\n+         */\n+        double getB();\n+\n+        /**\n+         * Get the conductance in S of the section.\n+         */\n+        double getG();\n+    }\n+\n+    /**\n+     * Get an optional of the section associated with a given section number if it exists.\n+     * If such a section does not exist, return an empty optional.\n+     *\n+     */\n+    Optional<Section> getSection(int sectionIndex);\n+\n+    /**\n+     * Get all the sections associated with their section number.\n+     */\n+    List<Section> getSections();\n+\n+    /**\n+     * For a given section number, add a section with a given susceptance and conductance in S to the model.\n+     * If a section already exists for this section number, respectively replace its susceptance and conductance with the given susceptance and conductance.\n+     * Throw an exception if the section index equals to 0 (corresponds to disconnected state).\n+     */\n+    ShuntCompensatorNonLinearModel addOrReplaceSection(int sectionIndex, double b, double g);\n+\n+    /**\n+     * Remove the section associated with a given section number if it exists <b>and</b> the current section count is different of the given section number.\n+     * Else, throw an exception.\n+     */\n+    ShuntCompensatorNonLinearModel removeLastSection();", "originalCommit": "a7b9c075bd3a072369ad8c3f7dd1eccf58cdff1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEzODM3OA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435138378", "bodyText": "Otherwise, it would be impossible to remove shunt section in non linear shunt (for development purposes for example)", "author": "miovd", "createdAt": "2020-06-04T10:02:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTE3NTA0Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435175043", "bodyText": "I am not sure to get what you mean :-) The function is not to remove a given section, just the last one.", "author": "annetill", "createdAt": "2020-06-04T11:11:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIxNjg2OA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435216868", "bodyText": "When you have a non linear shunt, what you can want to do is:\n\nadding a new section\nreplacing the value of an existing section\nremoving an existing section\n\nHowever, when you remove an existing section, it cannot be one in the middle (you cannot have a \"hole\" in your section list), so it is necessarily the last section. It occurs to me that a method can however be added to remove the last 2, 3, etc sections of a non linear shunt and not only the last one... (for now, to do that we have to call removeLastSection 2, 3, etc times)", "author": "miovd", "createdAt": "2020-06-04T12:32:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIxNzU4Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435217583", "bodyText": "Side note, it is the same for adding a new section, you cannot add a section with a index strictly superior to the last index + 1 to avoid \"holes\"", "author": "miovd", "createdAt": "2020-06-04T12:34:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM0MTgzMQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435341831", "bodyText": "Thanks so Indeed this remove function is using by the function addOrReplace ? Why have you decided to put it in the interface and not just in the implementation?", "author": "annetill", "createdAt": "2020-06-04T15:20:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc0NjkzNw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435746937", "bodyText": "No it is used when we really want to remove a section! addOrReplace can not remove a section, only replacing a value or adding a section.", "author": "miovd", "createdAt": "2020-06-05T07:46:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwNDA1MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436404051", "bodyText": "I don't understand why is a problem to remove a section that is not the last.\nIn any case if you remove a section it doesn't make sense anymore to update back the original model so we can allow everything.", "author": "geofjamg", "createdAt": "2020-06-07T21:35:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc0OTY3Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436749672", "bodyText": "Okay, just a question: when a section is removed, should all the cumulated susceptances and admittances of following sections be calculated again or does it just mean it will not be possible anymore to activate a certain section count to access a given cumulated susceptance and admittance?\nFor example, if we have:\n<shunt id=\"SHUNT\">\n  <shuntNonLinearModel>\n    <section b=\"1.0\" g=\"1.0\"/>\n    <section b=\"2.0\" g=\"2.0\"/>\n    <section b=\"4.0\" g=\"5.0\"/>\n  </shuntNonLinearModel>\n</shunt>\nIf the section section is removed, should we have:\n<shunt id=\"SHUNT\">\n  <shuntNonLinearModel>\n    <section b=\"1.0\" g=\"1.0\"/>\n    <section b=\"4.0\" g=\"5.0\"/>\n  </shuntNonLinearModel>\n</shunt>\nor:\n<shunt id=\"SHUNT\">\n  <shuntNonLinearModel>\n    <section b=\"1.0\" g=\"1.0\"/>\n    <section b=\"3.0\" g=\"4.0\"/>\n  </shuntNonLinearModel>\n</shunt>\n?", "author": "miovd", "createdAt": "2020-06-08T14:25:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc1MjA0Nw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436752047", "bodyText": "I guess my question should be: do you know the use case where a section is \"removed\" (for maintenance, etc) and what is the behavior of the shunt in this case?\nEdit: If there is no real use case, this method might not be useful", "author": "miovd", "createdAt": "2020-06-08T14:28:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTAyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTUwOQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r430239509", "bodyText": "The name chosen is not so clear. See remark above.", "author": "annetill", "createdAt": "2020-05-26T08:23:56Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ValidationUtil.java", "diffHunk": "@@ -228,26 +228,42 @@ public static void checkForecastDistance(Validable validable, int forecastDistan\n         }\n     }\n \n-    public static void checkbPerSection(Validable validable, double bPerSection) {\n-        if (Double.isNaN(bPerSection)) {\n-            throw new ValidationException(validable, \"susceptance per section is invalid\");\n+    public static void checkSectionNumber(Validable validable, int sectionNum) {\n+        if (sectionNum < 0) {\n+            throw new ValidationException(validable,\n+                    \"this number of section (\" + sectionNum\n+                            + \") should be greater than or equal to 0\");\n         }\n+    }\n+\n+    public static void checkbPerSection(Validable validable, double bPerSection) {\n+        checkSectionB(validable, bPerSection);\n         if (bPerSection == 0) {\n             throw new ValidationException(validable, \"susceptance per section is equal to zero\");\n         }\n     }\n \n+    public static void checkSectionB(Validable validable, double sectionB) {", "originalCommit": "a7b9c075bd3a072369ad8c3f7dd1eccf58cdff1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI4ODYzNQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r430288635", "bodyText": "I fall in this exception on some TSOs, included for our French network !", "author": "annetill", "createdAt": "2020-05-26T09:45:20Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ValidationUtil.java", "diffHunk": "@@ -228,26 +228,42 @@ public static void checkForecastDistance(Validable validable, int forecastDistan\n         }\n     }\n \n-    public static void checkbPerSection(Validable validable, double bPerSection) {\n-        if (Double.isNaN(bPerSection)) {\n-            throw new ValidationException(validable, \"susceptance per section is invalid\");\n+    public static void checkSectionNumber(Validable validable, int sectionNum) {\n+        if (sectionNum < 0) {\n+            throw new ValidationException(validable,\n+                    \"this number of section (\" + sectionNum\n+                            + \") should be greater than or equal to 0\");\n         }\n+    }\n+\n+    public static void checkbPerSection(Validable validable, double bPerSection) {", "originalCommit": "a7b9c075bd3a072369ad8c3f7dd1eccf58cdff1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEzODc1MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435138751", "bodyText": "Corrected in CGMES conversion", "author": "miovd", "createdAt": "2020-06-04T10:03:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI4ODYzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM0NDYxNw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r430344617", "bodyText": "I fall in this exception with NGESO network.", "author": "annetill", "createdAt": "2020-05-26T11:32:27Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorAdderImpl.java", "diffHunk": "@@ -46,16 +45,120 @@ protected String getTypeDescription() {\n         return \"Shunt compensator\";\n     }\n \n+    class ShuntCompensatorLinearModelAdderImpl implements ShuntCompensatorLinearModelAdder {\n+\n+        private double bPerSection = Double.NaN;\n+\n+        private double gPerSection = Double.NaN;\n+\n+        private int maximumSectionCount = -1;\n+\n+        @Override\n+        public ShuntCompensatorLinearModelAdder setbPerSection(double bPerSection) {\n+            this.bPerSection = bPerSection;\n+            return this;\n+        }\n+\n+        @Override\n+        public ShuntCompensatorLinearModelAdder setgPerSection(double gPerSection) {\n+            this.gPerSection = gPerSection;\n+            return this;\n+        }\n+\n+        @Override\n+        public ShuntCompensatorLinearModelAdder setMaximumSectionCount(int maximumSectionCount) {\n+            this.maximumSectionCount = maximumSectionCount;\n+            return this;\n+        }\n+\n+        @Override\n+        public ShuntCompensatorAdder add() {\n+            ValidationUtil.checkbPerSection(ShuntCompensatorAdderImpl.this, bPerSection);\n+            ValidationUtil.checkMaximumSectionCount(ShuntCompensatorAdderImpl.this, maximumSectionCount);\n+            model = new ShuntCompensatorLinearModelImpl(bPerSection, gPerSection, maximumSectionCount);\n+            return ShuntCompensatorAdderImpl.this;\n+        }\n+    }\n+\n+    class ShuntCompensatorNonLinearModelAdderImpl implements ShuntCompensatorNonLinearModelAdder {\n+\n+        private final TreeMap<Integer, ShuntCompensatorNonLinearModelImpl.SectionImpl> sectionsMap = new TreeMap<>();\n+        private boolean hasDefinedG = false;\n+\n+        class SectionAdderImpl implements SectionAdder {\n+\n+            private int sectionIndex = -1;\n+\n+            private double b = Double.NaN;\n+\n+            private double g = Double.NaN;\n+\n+            @Override\n+            public SectionAdder setSectionIndex(int sectionIndex) {\n+                this.sectionIndex = sectionIndex;\n+                return this;\n+            }\n+\n+            @Override\n+            public SectionAdder setB(double b) {\n+                this.b = b;\n+                return this;\n+            }\n+\n+            @Override\n+            public SectionAdder setG(double g) {\n+                this.g = g;\n+                return this;\n+            }\n+\n+            @Override\n+            public ShuntCompensatorNonLinearModelAdder endSection() {\n+                if (sectionIndex == 0) {\n+                    throw new ValidationException(ShuntCompensatorAdderImpl.this, \"section 0 (b = 0.0, g = 0.0) should not be written, it corresponds to disconnected state\");", "originalCommit": "a7b9c075bd3a072369ad8c3f7dd1eccf58cdff1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEzOTIxNQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435139215", "bodyText": "I will check but I think I will add a fix on CGMES converter here.", "author": "miovd", "createdAt": "2020-06-04T10:04:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM0NDYxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIzMjczOQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435232739", "bodyText": "Is it in the CGMES documentation that section 0 should have a b equal to zero ?", "author": "annetill", "createdAt": "2020-06-04T12:59:09Z", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/ShuntConversion.java", "diffHunk": "@@ -43,31 +46,48 @@ public void convert() {\n         int sections = getSections(p, normalSections);\n         sections = Math.abs(sections);\n         maximumSections = Math.max(maximumSections, sections);\n-        double bPerSection = 0;\n-        if (p.containsKey(CgmesNames.B_PER_SECTION)) {\n-            bPerSection = p.asDouble(CgmesNames.B_PER_SECTION, 0.0);\n-        } else {\n+        ShuntCompensatorAdder adder = voltageLevel().newShuntCompensator().setCurrentSectionCount(sections);\n+        String shuntType = p.getId(\"type\");\n+        if (\"LinearShuntCompensator\".equals(shuntType)) {\n+            double bPerSection = p.asDouble(CgmesNames.B_PER_SECTION, Float.MIN_VALUE);\n+            if (bPerSection == 0) {\n+                double bPerSectionFixed = Double.MIN_VALUE;\n+                fixed(CgmesNames.B_PER_SECTION, \"Can not be zero\", bPerSection, bPerSectionFixed);\n+                bPerSection = bPerSectionFixed;\n+            }\n+            double gPerSection = p.asDouble(\"gPerSection\", Double.NaN);\n+            adder.newLinearModel()\n+                    .setBPerSection(bPerSection)\n+                    .setGPerSection(gPerSection)\n+                    .setMaximumSectionCount(maximumSections)\n+                    .add();\n+        } else if (\"NonlinearShuntCompensator\".equals(shuntType)) {\n+            ShuntCompensatorNonLinearModelAdder modelAdder = adder.newNonLinearModel();\n             PropertyBags ss = context.cgmes().nonlinearShuntCompensatorPoints(id);\n-            final int nlsections = sections;\n-            double sumSections = ss.stream()\n-                    .filter(s -> s.asInt(\"sectionNumber\") <= nlsections)\n-                    .map(s -> s.asDouble(\"b\"))\n-                    .reduce(0.0, Double::sum);\n-            // Convert to a shunt compensator with a single section\n-            maximumSections = 1;\n-            sections = 1;\n-            bPerSection = sumSections;\n-        }\n-        if (bPerSection == 0) {\n-            float bPerSectionFixed = Float.MIN_VALUE;\n-            fixed(CgmesNames.B_PER_SECTION, \"Can not be zero\", bPerSection, bPerSectionFixed);\n-            bPerSection = bPerSectionFixed;\n+            for (PropertyBag sp : ss) {\n+                int sectionNumber = sp.asInt(SECTION_NUMBER);\n+                double b = ss.stream().filter(s -> s.asInt(SECTION_NUMBER) <= sectionNumber).map(s -> s.asDouble(\"b\")).reduce(0.0, Double::sum);\n+                if (sectionNumber == 0) {\n+                    if (b != 0) {\n+                        fixed(\"Shunt.section0\", \"Susceptance of section 0 should always be zero (disconnected state)\", b, 0.);", "originalCommit": "8dfa58bac0f8c83700cab9c188ed9141badcab7f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTI1MzQ3Nw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435253477", "bodyText": "It doesn't but I don't know if it makes sense?\nActually I think it is linked to your other remark: to be \"realistic\", it doesn't really matter if b is 0 at section 0 as long as there is a section where b is 0 (a section where the shunt can be considered as disconnected). Maybe we should go in that sense? However in CGMES datasets, even in explicit section 0, the susceptance is always 0 from what I've seen.", "author": "miovd", "createdAt": "2020-06-04T13:29:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIzMjczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTMyODg5OA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435328898", "bodyText": "From Implementation guide:\nUse the cim:ShuntCompensator.sections to control the impedance where cim:ShuntCompensator.sections=0 means zero admittance. For linear shunt this means multiplying with the per section admittance results in zero impedance. For nonlinear shunts the cim:NonlinearShuntCompensatorPoint.sectionNumber=0 shall have the corresponding admittance values equal zero.\nIt means that we should leave it to zero in IIDM...", "author": "annetill", "createdAt": "2020-06-04T15:02:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIzMjczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM4OTQyNA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435389424", "bodyText": "Okay, so we keep ignoring it then?", "author": "miovd", "createdAt": "2020-06-04T16:27:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIzMjczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMzI3MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436403271", "bodyText": "I don't understand the meaning of a zero admittance section. For me this should not be a requirement in IIDM but we need to accept it in order to keep the same number of section between CGMES and IIDM and then be able to update back the current section in case of regulation.\nWhy having a special meaning for section 0? section 0 is just the first one and could have an admittance. Also the shunt should accept 0 sections activated.", "author": "geofjamg", "createdAt": "2020-06-07T21:24:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIzMjczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU1NDQ2OQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436554469", "bodyText": "In what I implemented, section 0 is in fact the disconnected state (like linear shunts: when sectionIndex == 0 , b and g are also at 0 because they are proportional to sectionIndex ; this is also the convention adopted in CGMES). We can not do things like this but this would imply:\n\nthat a load-flow can disconnect the shunt's terminal or we create a parameter to indicate if the shunt is in disconnected state or not (and in which case, we do not consider its b and g)\nhaving different definitions of what section 0 is for linear and non linear shunts (that might be leading to different behaviors after a load-flow)", "author": "miovd", "createdAt": "2020-06-08T09:05:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIzMjczOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIzNDE3Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435234173", "bodyText": "It is wierd that CGMES requires a b equal to zero and that we don't allow it in IIDM. No?", "author": "annetill", "createdAt": "2020-06-04T13:01:04Z", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/ShuntConversion.java", "diffHunk": "@@ -43,31 +46,48 @@ public void convert() {\n         int sections = getSections(p, normalSections);\n         sections = Math.abs(sections);\n         maximumSections = Math.max(maximumSections, sections);\n-        double bPerSection = 0;\n-        if (p.containsKey(CgmesNames.B_PER_SECTION)) {\n-            bPerSection = p.asDouble(CgmesNames.B_PER_SECTION, 0.0);\n-        } else {\n+        ShuntCompensatorAdder adder = voltageLevel().newShuntCompensator().setCurrentSectionCount(sections);\n+        String shuntType = p.getId(\"type\");\n+        if (\"LinearShuntCompensator\".equals(shuntType)) {\n+            double bPerSection = p.asDouble(CgmesNames.B_PER_SECTION, Float.MIN_VALUE);\n+            if (bPerSection == 0) {\n+                double bPerSectionFixed = Double.MIN_VALUE;\n+                fixed(CgmesNames.B_PER_SECTION, \"Can not be zero\", bPerSection, bPerSectionFixed);\n+                bPerSection = bPerSectionFixed;\n+            }\n+            double gPerSection = p.asDouble(\"gPerSection\", Double.NaN);\n+            adder.newLinearModel()\n+                    .setBPerSection(bPerSection)\n+                    .setGPerSection(gPerSection)\n+                    .setMaximumSectionCount(maximumSections)\n+                    .add();\n+        } else if (\"NonlinearShuntCompensator\".equals(shuntType)) {\n+            ShuntCompensatorNonLinearModelAdder modelAdder = adder.newNonLinearModel();\n             PropertyBags ss = context.cgmes().nonlinearShuntCompensatorPoints(id);\n-            final int nlsections = sections;\n-            double sumSections = ss.stream()\n-                    .filter(s -> s.asInt(\"sectionNumber\") <= nlsections)\n-                    .map(s -> s.asDouble(\"b\"))\n-                    .reduce(0.0, Double::sum);\n-            // Convert to a shunt compensator with a single section\n-            maximumSections = 1;\n-            sections = 1;\n-            bPerSection = sumSections;\n-        }\n-        if (bPerSection == 0) {\n-            float bPerSectionFixed = Float.MIN_VALUE;\n-            fixed(CgmesNames.B_PER_SECTION, \"Can not be zero\", bPerSection, bPerSectionFixed);\n-            bPerSection = bPerSectionFixed;\n+            for (PropertyBag sp : ss) {\n+                int sectionNumber = sp.asInt(SECTION_NUMBER);\n+                double b = ss.stream().filter(s -> s.asInt(SECTION_NUMBER) <= sectionNumber).map(s -> s.asDouble(\"b\")).reduce(0.0, Double::sum);\n+                if (sectionNumber == 0) {\n+                    if (b != 0) {\n+                        fixed(\"Shunt.section0\", \"Susceptance of section 0 should always be zero (disconnected state)\", b, 0.);\n+                    }\n+                    continue;\n+                }\n+                if (b == 0) {\n+                    double bFixed = Double.MIN_VALUE;", "originalCommit": "8dfa58bac0f8c83700cab9c188ed9141badcab7f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTI1NDg5MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435254890", "bodyText": "This check might actually not be useful for non linear shunt (see above). Maybe there are shunt that can be considered as disconnected in several positions.", "author": "miovd", "createdAt": "2020-06-04T13:31:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIzNDE3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTMzMDA1Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435330052", "bodyText": "The check has to be removed (see above).", "author": "annetill", "createdAt": "2020-06-04T15:04:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIzNDE3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM0NDExNA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435344114", "bodyText": "Yes great, so we can leave the check!", "author": "annetill", "createdAt": "2020-06-04T15:23:40Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ValidationUtil.java", "diffHunk": "@@ -228,26 +228,42 @@ public static void checkForecastDistance(Validable validable, int forecastDistan\n         }\n     }\n \n-    public static void checkbPerSection(Validable validable, double bPerSection) {\n-        if (Double.isNaN(bPerSection)) {\n-            throw new ValidationException(validable, \"susceptance per section is invalid\");\n+    public static void checkSectionNumber(Validable validable, int sectionNum) {\n+        if (sectionNum < 0) {\n+            throw new ValidationException(validable,\n+                    \"this number of section (\" + sectionNum\n+                            + \") should be greater than or equal to 0\");\n         }\n+    }\n+\n+    public static void checkLinearBPerSection(Validable validable, double bPerSection) {\n+        checkBPerSection(validable, bPerSection);\n         if (bPerSection == 0) {\n             throw new ValidationException(validable, \"susceptance per section is equal to zero\");\n         }\n     }\n \n+    public static void checkBPerSection(Validable validable, double sectionB) {\n+        if (Double.isNaN(sectionB)) {", "originalCommit": "8dfa58bac0f8c83700cab9c188ed9141badcab7f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM0NjQ5MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r435346490", "bodyText": "Great!", "author": "annetill", "createdAt": "2020-06-04T15:26:46Z", "path": "loadflow/loadflow-api/src/main/java/com/powsybl/loadflow/LoadFlowParameters.java", "diffHunk": "@@ -52,6 +52,7 @@\n     public static final boolean DEFAULT_NO_GENERATOR_REACTIVE_LIMITS = false;\n     public static final boolean DEFAULT_PHASE_SHIFTER_REGULATION_ON = false;\n     public static final boolean DEFAULT_T2WT_SPLIT_SHUNT_ADMITTANCE = false;\n+    public static final boolean DEFAULT_SIMUL_SHUNT = false;", "originalCommit": "8dfa58bac0f8c83700cab9c188ed9141badcab7f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMTg2Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436401862", "bodyText": "Why? It should be possible to have 0 section activated?", "author": "geofjamg", "createdAt": "2020-06-07T21:05:52Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ShuntCompensator.java", "diffHunk": "@@ -17,71 +17,79 @@\n public interface ShuntCompensator extends Injection<ShuntCompensator> {\n \n     /**\n-     * Get the maximum section count.\n+     * Get the current count of sections in service.\n+     * Please note sections can only be sequentially in service i.e. all sections from section 1 to section currentSectionCount are in service.\n+     * <p>\n+     * It is expected to be greater than one and lesser than or equal to the", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU1OTgzOA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436559838", "bodyText": "By default for me when 0 section is activated, it means that there is zero susceptance and admittance (cf. answer above)", "author": "miovd", "createdAt": "2020-06-08T09:15:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMTg2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA4ODg2Nw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444088867", "bodyText": "doc should be updated?", "author": "geofjamg", "createdAt": "2020-06-23T09:27:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMTg2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMTk5Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436401993", "bodyText": "Maybe we could try to find a better naming than current. What I don't like with current is that in power system it is also a unit.", "author": "geofjamg", "createdAt": "2020-06-07T21:07:44Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ShuntCompensator.java", "diffHunk": "@@ -17,71 +17,79 @@\n public interface ShuntCompensator extends Injection<ShuntCompensator> {\n \n     /**\n-     * Get the maximum section count.\n+     * Get the current count of sections in service.\n+     * Please note sections can only be sequentially in service i.e. all sections from section 1 to section currentSectionCount are in service.\n+     * <p>\n+     * It is expected to be greater than one and lesser than or equal to the\n+     * maximum section count.\n+     * <p>\n+     * Depends on the working variant.\n+     * @see VariantManager\n+     */\n+    int getCurrentSectionCount();", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2MDgzOA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436560838", "bodyText": "Maybe getActivatedSectionCount()?", "author": "miovd", "createdAt": "2020-06-08T09:16:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMTk5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc2NjE3NQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436766175", "bodyText": "Should we also rename getCurrentB() and getCurrentG()? What do you propose for those?", "author": "miovd", "createdAt": "2020-06-08T14:47:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMTk5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMjM5MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436402391", "bodyText": "If first section is section 0, we must have a non zero value as all section should have a b or g?", "author": "geofjamg", "createdAt": "2020-06-07T21:12:39Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ShuntCompensatorModel.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public interface ShuntCompensatorModel {\n+\n+    /**\n+     * Get the section susceptance in S of the section with a given section number if it exists.\n+     * Return 0 if sectionIndex is equal to 0 (disconnected state).", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2MTI5OQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436561299", "bodyText": "cf answer above", "author": "miovd", "createdAt": "2020-06-08T09:17:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMjM5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMjQ0NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436402444", "bodyText": "You should use == for an enum", "author": "geofjamg", "createdAt": "2020-06-07T21:13:29Z", "path": "ampl-converter/src/main/java/com/powsybl/ampl/converter/AmplNetworkReader.java", "diffHunk": "@@ -277,6 +278,9 @@ private Void readShunt(String[] tokens) {\n             throw new AmplException(\"Invalid shunt compensator id '\" + id + \"'\");\n         }\n \n+        if (ShuntCompensatorModelType.NON_LINEAR.equals(sc.getModelType())) {", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMjQ2Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436402463", "bodyText": "Same", "author": "geofjamg", "createdAt": "2020-06-07T21:13:43Z", "path": "ampl-converter/src/main/java/com/powsybl/ampl/converter/AmplNetworkWriter.java", "diffHunk": "@@ -1310,6 +1311,9 @@ private void writeShunts(AmplExportContext context) throws IOException {\n                      new Column(\"sections count\"))) {\n             List<String> skipped = new ArrayList<>();\n             for (ShuntCompensator sc : network.getShuntCompensators()) {\n+                if (ShuntCompensatorModelType.NON_LINEAR.equals(sc.getModelType())) {", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMjYyMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436402622", "bodyText": "Is it really need to specify an index? It could be implicit (builder order)", "author": "geofjamg", "createdAt": "2020-06-07T21:15:53Z", "path": "cgmes/cgmes-conformity/src/test/java/com/powsybl/cgmes/conformity/test/CgmesConformity1NetworkCatalog.java", "diffHunk": "@@ -1028,6 +1034,42 @@ public static Network microType4BE() {\n                 .setP0(-11.518776)\n                 .setQ0(67.377544);\n \n+        network.getShuntCompensator(\"_002b0a40-3957-46db-b84a-30420083558f\").remove();\n+        network.getVoltageLevel(\"_469df5f7-058f-4451-a998-57a48e8a56fe\")\n+                .newShuntCompensator()\n+                    .setId(\"_002b0a40-3957-46db-b84a-30420083558f\")\n+                    .setName(\"BE_S2\")\n+                    .setConnectableBus(busBrussels380.getId())\n+                    .setBus(busBrussels380.getId())\n+                    .setCurrentSectionCount(1)\n+                    .newNonLinearModel()\n+                        .beginSection()\n+                            .setSectionIndex(1)", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc2MTQxMw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436761413", "bodyText": "cf answer below", "author": "miovd", "createdAt": "2020-06-08T14:41:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMjYyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMzM3MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436403371", "bodyText": "Is it really necessary to keep the number, if we keep all of them in the right order?", "author": "geofjamg", "createdAt": "2020-06-07T21:25:49Z", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/ShuntConversion.java", "diffHunk": "@@ -43,31 +46,43 @@ public void convert() {\n         int sections = getSections(p, normalSections);\n         sections = Math.abs(sections);\n         maximumSections = Math.max(maximumSections, sections);\n-        double bPerSection = 0;\n-        if (p.containsKey(CgmesNames.B_PER_SECTION)) {\n-            bPerSection = p.asDouble(CgmesNames.B_PER_SECTION, 0.0);\n-        } else {\n+        ShuntCompensatorAdder adder = voltageLevel().newShuntCompensator().setCurrentSectionCount(sections);\n+        String shuntType = p.getId(\"type\");\n+        if (\"LinearShuntCompensator\".equals(shuntType)) {\n+            double bPerSection = p.asDouble(CgmesNames.B_PER_SECTION, Float.MIN_VALUE);\n+            if (bPerSection == 0) {\n+                double bPerSectionFixed = Double.MIN_VALUE;\n+                fixed(CgmesNames.B_PER_SECTION, \"Can not be zero\", bPerSection, bPerSectionFixed);\n+                bPerSection = bPerSectionFixed;\n+            }\n+            double gPerSection = p.asDouble(\"gPerSection\", Double.NaN);\n+            adder.newLinearModel()\n+                    .setBPerSection(bPerSection)\n+                    .setGPerSection(gPerSection)\n+                    .setMaximumSectionCount(maximumSections)\n+                    .add();\n+        } else if (\"NonlinearShuntCompensator\".equals(shuntType)) {\n+            ShuntCompensatorNonLinearModelAdder modelAdder = adder.newNonLinearModel();\n             PropertyBags ss = context.cgmes().nonlinearShuntCompensatorPoints(id);\n-            final int nlsections = sections;\n-            double sumSections = ss.stream()\n-                    .filter(s -> s.asInt(\"sectionNumber\") <= nlsections)\n-                    .map(s -> s.asDouble(\"b\"))\n-                    .reduce(0.0, Double::sum);\n-            // Convert to a shunt compensator with a single section\n-            maximumSections = 1;\n-            sections = 1;\n-            bPerSection = sumSections;\n-        }\n-        if (bPerSection == 0) {\n-            float bPerSectionFixed = Float.MIN_VALUE;\n-            fixed(CgmesNames.B_PER_SECTION, \"Can not be zero\", bPerSection, bPerSectionFixed);\n-            bPerSection = bPerSectionFixed;\n+            for (PropertyBag sp : ss) {\n+                int sectionNumber = sp.asInt(SECTION_NUMBER);\n+                double b = ss.stream().filter(s -> s.asInt(SECTION_NUMBER) <= sectionNumber).map(s -> s.asDouble(\"b\")).reduce(0.0, Double::sum);\n+                if (sectionNumber == 0) {\n+                    if (b != 0) {\n+                        fixed(\"Shunt.section0\", \"Susceptance of section 0 should always be zero (disconnected state)\", b, 0.);\n+                    }\n+                    continue;\n+                }\n+                modelAdder.beginSection()\n+                        .setB(b)\n+                        .setG(ss.stream().filter(s -> s.asInt(SECTION_NUMBER) <= sectionNumber).map(s -> s.asDouble(\"g\")).reduce(0.0, Double::sum))\n+                        .setSectionIndex(sp.asInt(SECTION_NUMBER))", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2Mjk4Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436562982", "bodyText": "In my opinion, it makes it less efficient in cases when we are not sure in which order we receive the sections during the building (typically the case in CGMES). However, it makes the implementation less heavy (no need to use a map), what do you think?", "author": "miovd", "createdAt": "2020-06-08T09:20:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMzM3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwMzc4NQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436403785", "bodyText": "I would model section in IIDM as a [0, maxSectionCount[ array and here avoid the optional.", "author": "geofjamg", "createdAt": "2020-06-07T21:31:37Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ShuntCompensatorNonLinearModel.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public interface ShuntCompensatorNonLinearModel extends ShuntCompensatorModel {\n+\n+    interface Section {\n+\n+        /**\n+         * Get the susceptance in S of the section.\n+         */\n+        double getB();\n+\n+        /**\n+         * Get the conductance in S of the section.\n+         */\n+        double getG();\n+    }\n+\n+    /**\n+     * Get an optional of the section associated with a given section number if it exists.\n+     * If such a section does not exist, return an empty optional.\n+     *\n+     */\n+    Optional<Section> getSection(int sectionIndex);", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwNDIzMQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436404231", "bodyText": "It is not really a wrapper?", "author": "geofjamg", "createdAt": "2020-06-07T21:37:49Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorModelWrapper.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network.impl;\n+\n+import com.powsybl.iidm.network.ShuntCompensatorModel;\n+import com.powsybl.iidm.network.ShuntCompensatorModelType;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+interface ShuntCompensatorModelWrapper extends ShuntCompensatorModel {", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU3NDM1Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436574352", "bodyText": "Yes, I'm not really sure how to name this interface...", "author": "miovd", "createdAt": "2020-06-08T09:41:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwNDIzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwNDQ4MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436404480", "bodyText": "As I said before, it seems to me very confusing to have a different root name when just changing the model. It is still a shunt compensator.", "author": "geofjamg", "createdAt": "2020-06-07T21:41:34Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/LinearShuntXml.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.xml;\n+\n+import com.powsybl.commons.xml.XmlUtil;\n+import com.powsybl.iidm.network.ShuntCompensator;\n+import com.powsybl.iidm.network.ShuntCompensatorAdder;\n+import com.powsybl.iidm.network.ShuntCompensatorLinearModel;\n+import com.powsybl.iidm.network.VoltageLevel;\n+import com.powsybl.iidm.xml.util.IidmXmlUtil;\n+\n+import javax.xml.stream.XMLStreamException;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public class LinearShuntXml extends AbstractConnectableXml<ShuntCompensator, ShuntCompensatorAdder, VoltageLevel> {\n+\n+    static final LinearShuntXml INSTANCE = new LinearShuntXml();\n+\n+    static final String ROOT_ELEMENT_NAME = \"linearShunt\";\n+\n+    @Override\n+    protected String getRootElementName() {\n+        return ROOT_ELEMENT_NAME;", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwNDYxNQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436404615", "bodyText": "Be careful, you forgot to take into account this new attribute in many places in this class.", "author": "geofjamg", "createdAt": "2020-06-07T21:43:20Z", "path": "loadflow/loadflow-api/src/main/java/com/powsybl/loadflow/LoadFlowParameters.java", "diffHunk": "@@ -104,13 +105,20 @@ protected static void load(LoadFlowParameters parameters, PlatformConfig platfor\n \n     private boolean t2wtSplitShuntAdmittance;\n \n-    public LoadFlowParameters(VoltageInitMode voltageInitMode, boolean transformerVoltageControlOn,\n-                              boolean noGeneratorReactiveLimits, boolean phaseShifterRegulationOn, boolean t2wtSplitShuntAdmittance) {\n+    private boolean simulShunt;", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwNDYzOQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r436404639", "bodyText": "== is more common for enum", "author": "geofjamg", "createdAt": "2020-06-07T21:43:49Z", "path": "loadflow/loadflow-validation/src/main/java/com/powsybl/loadflow/validation/ShuntCompensatorsValidation.java", "diffHunk": "@@ -85,11 +84,15 @@ public boolean checkShunts(ShuntCompensator shunt, ValidationConfig config, Vali\n         Objects.requireNonNull(config);\n         Objects.requireNonNull(shuntsWriter);\n \n+        if (ShuntCompensatorModelType.NON_LINEAR.equals(shunt.getModelType())) {", "originalCommit": "12ab6c1c768d0b07d5a4f899c156241915d16f9c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e0be4c244a89bcdd2970db3108fdef32a5c77f39", "url": "https://github.com/powsybl/powsybl-core/commit/e0be4c244a89bcdd2970db3108fdef32a5c77f39", "message": "Update a test file (XIIDM version)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-11T15:30:55Z", "type": "forcePushed"}, {"oid": "ee50d5cfcdcad56869572b2c90fd7c4c6e01fca3", "url": "https://github.com/powsybl/powsybl-core/commit/ee50d5cfcdcad56869572b2c90fd7c4c6e01fca3", "message": "Change XML serialisation for shunts\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-12T07:37:24Z", "type": "forcePushed"}, {"oid": "9bc99e87a1458bf23c95e0bda39d3ebca8f89796", "url": "https://github.com/powsybl/powsybl-core/commit/9bc99e87a1458bf23c95e0bda39d3ebca8f89796", "message": "Change methods name in Shunt API\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-12T14:32:23Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA4OTE3NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444089174", "bodyText": "Same?", "author": "geofjamg", "createdAt": "2020-06-23T09:28:13Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ShuntCompensator.java", "diffHunk": "@@ -17,71 +17,83 @@\n public interface ShuntCompensator extends Injection<ShuntCompensator> {\n \n     /**\n-     * Get the maximum section count.\n+     * Get the count of sections in service.\n+     * Please note sections can only be sequentially in service i.e. all sections from section 1 to section currentSectionCount are in service.\n+     * <p>\n+     * It is expected to be greater than one and lesser than or equal to the\n+     * maximum section count.\n+     * <p>\n+     * Depends on the working variant.\n+     * @see VariantManager\n+     */\n+    int getSectionCount();\n+\n+    /**\n+     * Get the maximum number of sections that can be in service\n      */\n     int getMaximumSectionCount();\n \n     /**\n-     * Set the maximum number of section.\n+     * Change the count of sections in service.\n+     * Please note sections can only be sequentially in service i.e. all section from section 1 to section currentSectionCount are in service.", "originalCommit": "206b208ef8515dd455b5b0041473dde3f086e981", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA5MTg0Nw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444091847", "bodyText": "sectionCount?", "author": "geofjamg", "createdAt": "2020-06-23T09:32:46Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ShuntCompensatorNonLinearModel.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network;\n+\n+import java.util.List;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public interface ShuntCompensatorNonLinearModel extends ShuntCompensatorModel {\n+\n+    interface Section {\n+\n+        /**\n+         * Get the accumulated susceptance in S if this section and all the previous ones are activated.\n+         */\n+        double getB();\n+\n+        /**\n+         * Set the accumulated susceptance in S if this section and all the previous ones are activated.\n+         */\n+        Section setB(double b);\n+\n+        /**\n+         * Get the accumulated conductance in S if this section and all the previous ones are activated.\n+         */\n+        double getG();\n+\n+        /**\n+         * Set the accumulated conductance in S if this section and all the previous ones are activated.\n+         */\n+        Section setG(double g);\n+    }\n+\n+    /**\n+     * Get an optional of the section associated with a given section index if it exists.\n+     *\n+     * @param sectionIndex the index of the wanted section. Must be in [1;maximumSectionCount]. Else, throws a {@link ValidationException}.\n+     *\n+     */\n+    Section getSection(int sectionIndex);", "originalCommit": "206b208ef8515dd455b5b0041473dde3f086e981", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA5MjgyMQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444092821", "bodyText": "Is it just for debugging?", "author": "geofjamg", "createdAt": "2020-06-23T09:34:32Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorAdderImpl.java", "diffHunk": "@@ -46,21 +44,106 @@ protected String getTypeDescription() {\n         return \"Shunt compensator\";\n     }\n \n+    class ShuntCompensatorLinearModelAdderImpl implements ShuntCompensatorLinearModelAdder {\n+\n+        private double bPerSection = Double.NaN;\n+\n+        private double gPerSection = Double.NaN;\n+\n+        private int maximumSectionCount = -1;\n+\n+        @Override\n+        public ShuntCompensatorLinearModelAdder setBPerSection(double bPerSection) {\n+            this.bPerSection = bPerSection;\n+            return this;\n+        }\n+\n+        @Override\n+        public ShuntCompensatorLinearModelAdder setGPerSection(double gPerSection) {\n+            this.gPerSection = gPerSection;\n+            return this;\n+        }\n+\n+        @Override\n+        public ShuntCompensatorLinearModelAdder setMaximumSectionCount(int maximumSectionCount) {\n+            this.maximumSectionCount = maximumSectionCount;\n+            return this;\n+        }\n+\n+        @Override\n+        public ShuntCompensatorAdder add() {\n+            ValidationUtil.checkLinearBPerSection(ShuntCompensatorAdderImpl.this, bPerSection);\n+            ValidationUtil.checkMaximumSectionCount(ShuntCompensatorAdderImpl.this, maximumSectionCount);\n+            model = new ShuntCompensatorLinearModelImpl(bPerSection, gPerSection, maximumSectionCount);\n+            return ShuntCompensatorAdderImpl.this;\n+        }\n+    }\n+\n+    class ShuntCompensatorNonLinearModelAdderImpl implements ShuntCompensatorNonLinearModelAdder {\n+\n+        private final List<ShuntCompensatorNonLinearModelImpl.SectionImpl> sections = new ArrayList<>();\n+        private boolean hasDefinedG = false;", "originalCommit": "206b208ef8515dd455b5b0041473dde3f086e981", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDIzNjQzMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444236432", "bodyText": "No, this is a bit complicated for what it does, but it is to check that if the conductance of one section has been defined, all sections must have defined conductance (and vice versa, if a section with an undefined conductance has been added, all sections must have undefined conductances).", "author": "miovd", "createdAt": "2020-06-23T13:46:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA5MjgyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA5MzIxNw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444093217", "bodyText": "currentSectionCount => currentSectionCount", "author": "geofjamg", "createdAt": "2020-06-23T09:35:11Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorAdderImpl.java", "diffHunk": "@@ -46,21 +44,106 @@ protected String getTypeDescription() {\n         return \"Shunt compensator\";\n     }\n \n+    class ShuntCompensatorLinearModelAdderImpl implements ShuntCompensatorLinearModelAdder {\n+\n+        private double bPerSection = Double.NaN;\n+\n+        private double gPerSection = Double.NaN;\n+\n+        private int maximumSectionCount = -1;\n+\n+        @Override\n+        public ShuntCompensatorLinearModelAdder setBPerSection(double bPerSection) {\n+            this.bPerSection = bPerSection;\n+            return this;\n+        }\n+\n+        @Override\n+        public ShuntCompensatorLinearModelAdder setGPerSection(double gPerSection) {\n+            this.gPerSection = gPerSection;\n+            return this;\n+        }\n+\n+        @Override\n+        public ShuntCompensatorLinearModelAdder setMaximumSectionCount(int maximumSectionCount) {\n+            this.maximumSectionCount = maximumSectionCount;\n+            return this;\n+        }\n+\n+        @Override\n+        public ShuntCompensatorAdder add() {\n+            ValidationUtil.checkLinearBPerSection(ShuntCompensatorAdderImpl.this, bPerSection);\n+            ValidationUtil.checkMaximumSectionCount(ShuntCompensatorAdderImpl.this, maximumSectionCount);\n+            model = new ShuntCompensatorLinearModelImpl(bPerSection, gPerSection, maximumSectionCount);\n+            return ShuntCompensatorAdderImpl.this;\n+        }\n+    }\n+\n+    class ShuntCompensatorNonLinearModelAdderImpl implements ShuntCompensatorNonLinearModelAdder {\n+\n+        private final List<ShuntCompensatorNonLinearModelImpl.SectionImpl> sections = new ArrayList<>();\n+        private boolean hasDefinedG = false;\n+        private int index = 1;\n+\n+        class SectionAdderImpl implements SectionAdder {\n+\n+            private double b = Double.NaN;\n+\n+            private double g = Double.NaN;\n+\n+            @Override\n+            public SectionAdder setB(double b) {\n+                this.b = b;\n+                return this;\n+            }\n+\n+            @Override\n+            public SectionAdder setG(double g) {\n+                this.g = g;\n+                return this;\n+            }\n+\n+            @Override\n+            public ShuntCompensatorNonLinearModelAdder endSection() {\n+                ValidationUtil.checkBPerSection(ShuntCompensatorAdderImpl.this, b);\n+                if ((Double.isNaN(g) && hasDefinedG) || (!Double.isNaN(g) && !hasDefinedG && !sections.isEmpty())) {\n+                    throw new ValidationException(ShuntCompensatorAdderImpl.this, \"if conductance has been defined for a section, it must be defined for all sections.\");\n+                }\n+                hasDefinedG = hasDefinedG || !Double.isNaN(g);\n+                sections.add(new ShuntCompensatorNonLinearModelImpl.SectionImpl(index, b, g));\n+                index++;\n+                return ShuntCompensatorNonLinearModelAdderImpl.this;\n+            }\n+        }\n+\n+        @Override\n+        public SectionAdder beginSection() {\n+            return new SectionAdderImpl();\n+        }\n+\n+        @Override\n+        public ShuntCompensatorAdder add() {\n+            if (sections.isEmpty()) {\n+                throw new ValidationException(ShuntCompensatorAdderImpl.this, \"a shunt compensator must have at least one section\");\n+            }\n+            model = new ShuntCompensatorNonLinearModelImpl(sections);\n+            return ShuntCompensatorAdderImpl.this;\n+        }\n+    }\n+\n     @Override\n-    public ShuntCompensatorAdder setbPerSection(double bPerSection) {\n-        this.bPerSection = bPerSection;\n-        return this;\n+    public ShuntCompensatorLinearModelAdder newLinearModel() {\n+        return new ShuntCompensatorLinearModelAdderImpl();\n     }\n \n     @Override\n-    public ShuntCompensatorAdder setMaximumSectionCount(int maximumSectionCount) {\n-        this.maximumSectionCount = maximumSectionCount;\n-        return this;\n+    public ShuntCompensatorNonLinearModelAdder newNonLinearModel() {\n+        return new ShuntCompensatorNonLinearModelAdderImpl();\n     }\n \n     @Override\n-    public ShuntCompensatorAdder setCurrentSectionCount(int currentSectionCount) {\n-        this.currentSectionCount = currentSectionCount;\n+    public ShuntCompensatorAdder setSectionCount(int sectionCount) {\n+        this.currentSectionCount = sectionCount;", "originalCommit": "206b208ef8515dd455b5b0041473dde3f086e981", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA5MzQ5OQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444093499", "bodyText": "currentSectionCount => sectionCount", "author": "geofjamg", "createdAt": "2020-06-23T09:35:38Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorImpl.java", "diffHunk": "@@ -47,13 +39,12 @@\n     private final TDoubleArrayList targetDeadband;\n \n     ShuntCompensatorImpl(Ref<? extends VariantManagerHolder> network,\n-                         String id, String name, boolean fictitious, double bPerSection, int maximumSectionCount,\n+                         String id, String name, boolean fictitious, ShuntCompensatorModelWrapper model,\n                          int currentSectionCount, TerminalExt regulatingTerminal, boolean voltageRegulatorOn,", "originalCommit": "206b208ef8515dd455b5b0041473dde3f086e981", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA5MzYzNw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444093637", "bodyText": "currentSectionCount => sectionCount", "author": "geofjamg", "createdAt": "2020-06-23T09:35:51Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorImpl.java", "diffHunk": "@@ -79,51 +75,68 @@ public TerminalExt getTerminal() {\n     }\n \n     @Override\n-    public double getbPerSection() {\n-        return bPerSection;\n+    public int getSectionCount() {\n+        return currentSectionCount.get(network.get().getVariantIndex());", "originalCommit": "206b208ef8515dd455b5b0041473dde3f086e981", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA5OTY3Nw==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444099677", "bodyText": "I still do not understand why section index start from 1, it is a bad convention.\nOr we want in some use cases (like CGMES) manage an offset, we just have to add a lowSectionIndex (default to zero), but it should not be the default (and mandatory) behaviour.", "author": "geofjamg", "createdAt": "2020-06-23T09:46:14Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorNonLinearModelImpl.java", "diffHunk": "@@ -0,0 +1,142 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network.impl;\n+\n+import com.powsybl.commons.PowsyblException;\n+import com.powsybl.iidm.network.*;\n+\n+import java.util.*;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+class ShuntCompensatorNonLinearModelImpl extends AbstractShuntCompensatorModel implements ShuntCompensatorNonLinearModel {\n+\n+    static class SectionImpl implements Section {\n+\n+        private ShuntCompensatorImpl shuntCompensator = null;\n+\n+        private final int index;\n+\n+        private double b;\n+\n+        private double g;\n+\n+        SectionImpl(int index, double b, double g) {\n+            this.index = index;\n+            this.b = b;\n+            this.g = g;\n+        }\n+\n+        @Override\n+        public double getB() {\n+            return b;\n+        }\n+\n+        @Override\n+        public Section setB(double b) {\n+            ValidationUtil.checkB(shuntCompensator, b);\n+            double oldValue = this.b;\n+            this.b = b;\n+            shuntCompensator.notifyUpdate(notifyUpdateSection(index, \"b\"), oldValue, this.b);\n+            return this;\n+        }\n+\n+        @Override\n+        public double getG() {\n+            return g;\n+        }\n+\n+        @Override\n+        public Section setG(double g) {\n+            ValidationUtil.checkG(shuntCompensator, g);\n+            double oldValue = this.g;\n+            this.g = g;\n+            shuntCompensator.notifyUpdate(notifyUpdateSection(index, \"g\"), oldValue, this.g);\n+            return this;\n+        }\n+\n+        private static String notifyUpdateSection(int sectionNum, String attribute) {\n+            return \"section\" + sectionNum + \".\" + attribute;\n+        }\n+\n+        void setShuntCompensator(ShuntCompensatorImpl shuntCompensator) {\n+            if (this.shuntCompensator != null) {\n+                throw new PowsyblException(\"Shunt compensator \" + shuntCompensator.getId() + \" has been set twice for the section \" + index);\n+            }\n+            this.shuntCompensator = shuntCompensator;\n+        }\n+    }\n+\n+    private final List<SectionImpl> sections;\n+\n+    ShuntCompensatorNonLinearModelImpl(List<SectionImpl> sections) {\n+        this.sections = sections;\n+    }\n+\n+    @Override\n+    public Section getSection(int sectionIndex) {\n+        if (sectionIndex < 1 || sectionIndex > sections.size()) {", "originalCommit": "206b208ef8515dd455b5b0041473dde3f086e981", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDIzMzI4NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444233284", "bodyText": "Method deleted (as every method using sectionIndex concept)", "author": "miovd", "createdAt": "2020-06-23T13:42:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA5OTY3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDEwMDExNg==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444100116", "bodyText": "This is very dirty code just because of index > 0 convention ?", "author": "geofjamg", "createdAt": "2020-06-23T09:46:59Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorNonLinearModelImpl.java", "diffHunk": "@@ -0,0 +1,142 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network.impl;\n+\n+import com.powsybl.commons.PowsyblException;\n+import com.powsybl.iidm.network.*;\n+\n+import java.util.*;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+class ShuntCompensatorNonLinearModelImpl extends AbstractShuntCompensatorModel implements ShuntCompensatorNonLinearModel {\n+\n+    static class SectionImpl implements Section {\n+\n+        private ShuntCompensatorImpl shuntCompensator = null;\n+\n+        private final int index;\n+\n+        private double b;\n+\n+        private double g;\n+\n+        SectionImpl(int index, double b, double g) {\n+            this.index = index;\n+            this.b = b;\n+            this.g = g;\n+        }\n+\n+        @Override\n+        public double getB() {\n+            return b;\n+        }\n+\n+        @Override\n+        public Section setB(double b) {\n+            ValidationUtil.checkB(shuntCompensator, b);\n+            double oldValue = this.b;\n+            this.b = b;\n+            shuntCompensator.notifyUpdate(notifyUpdateSection(index, \"b\"), oldValue, this.b);\n+            return this;\n+        }\n+\n+        @Override\n+        public double getG() {\n+            return g;\n+        }\n+\n+        @Override\n+        public Section setG(double g) {\n+            ValidationUtil.checkG(shuntCompensator, g);\n+            double oldValue = this.g;\n+            this.g = g;\n+            shuntCompensator.notifyUpdate(notifyUpdateSection(index, \"g\"), oldValue, this.g);\n+            return this;\n+        }\n+\n+        private static String notifyUpdateSection(int sectionNum, String attribute) {\n+            return \"section\" + sectionNum + \".\" + attribute;\n+        }\n+\n+        void setShuntCompensator(ShuntCompensatorImpl shuntCompensator) {\n+            if (this.shuntCompensator != null) {\n+                throw new PowsyblException(\"Shunt compensator \" + shuntCompensator.getId() + \" has been set twice for the section \" + index);\n+            }\n+            this.shuntCompensator = shuntCompensator;\n+        }\n+    }\n+\n+    private final List<SectionImpl> sections;\n+\n+    ShuntCompensatorNonLinearModelImpl(List<SectionImpl> sections) {\n+        this.sections = sections;\n+    }\n+\n+    @Override\n+    public Section getSection(int sectionIndex) {\n+        if (sectionIndex < 1 || sectionIndex > sections.size()) {\n+            throw new ValidationException(shuntCompensator, \"invalid section index (must be in [1;maximumSectionCount]\");\n+        }\n+        return sections.get(sectionIndex - 1);\n+    }\n+\n+    @Override\n+    public List<Section> getAllSections() {\n+        return Collections.unmodifiableList(sections);\n+    }\n+\n+    @Override\n+    public ShuntCompensatorModelType getType() {\n+        return ShuntCompensatorModelType.NON_LINEAR;\n+    }\n+\n+    @Override\n+    public int getMaximumSectionCount() {\n+        return sections.size();\n+    }\n+\n+    @Override\n+    public double getB(int sectionCount) {\n+        if (sectionCount < 0 || sectionCount > sections.size()) {\n+            throw new ValidationException(shuntCompensator, \"invalid section count (must be in [0;maximumSectionCount]\");\n+        }\n+        return sectionCount == 0 ? 0 : sections.get(sectionCount - 1).getB();\n+    }\n+\n+    @Override\n+    public double getG(int sectionCount) {\n+        if (sectionCount < 0 || sectionCount > sections.size()) {\n+            throw new ValidationException(shuntCompensator, \"invalid section count (must be in [0;maximumSectionCount]\");\n+        }\n+        return sectionCount == 0 || Double.isNaN(sections.get(sectionCount - 1).getG()) ? 0 : sections.get(sectionCount - 1).getG();\n+    }\n+\n+    @Override\n+    public double getBPerSection(int sectionIndex) {\n+        if (sectionIndex < 1 || sectionIndex > sections.size()) {\n+            throw new ValidationException(shuntCompensator, \"invalid section index (must be in [1;maximumSectionCount]\");\n+        }\n+        return sectionIndex == 1 ? sections.get(0).getB() : sections.get(sectionIndex - 1).getB() - sections.get(sectionIndex - 2).getB();", "originalCommit": "206b208ef8515dd455b5b0041473dde3f086e981", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDIzMzM2OA==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444233368", "bodyText": "Method deleted (as every method using sectionIndex concept)", "author": "miovd", "createdAt": "2020-06-23T13:42:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDEwMDExNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU0Njg5MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1322#discussion_r444546891", "bodyText": "Maybe change CurrentSectionCount to be coherent", "author": "marqueslanauja", "createdAt": "2020-06-23T22:39:21Z", "path": "iidm/iidm-tck/src/test/java/com/powsybl/iidm/network/tck/AbstractShuntCompensatorTest.java", "diffHunk": "@@ -268,18 +471,25 @@ public void testSetterGetterInMultiVariants() {\n         }\n     }\n \n-    private void createShunt(String id, String name, double bPerSection, int currentSectionCount, int maxSectionCount, Terminal regulatingTerminal, boolean voltageRegulatorOn, double targetV, double targetDeadband) {\n-        voltageLevel.newShuntCompensator()\n+    private ShuntCompensator createLinearShunt(String id, String name, double bPerSection, double gPerSection, int currentSectionCount, int maxSectionCount, Terminal regulatingTerminal, boolean voltageRegulatorOn, double targetV, double targetDeadband) {\n+        return createShuntAdder(id, name, currentSectionCount, regulatingTerminal, voltageRegulatorOn, targetV, targetDeadband)\n+                .newLinearModel()\n+                .setBPerSection(bPerSection)\n+                .setGPerSection(gPerSection)\n+                .setMaximumSectionCount(maxSectionCount)\n+                .add()\n+                .add();\n+    }\n+\n+    private ShuntCompensatorAdder createShuntAdder(String id, String name, int currentSectionCount, Terminal regulatingTerminal, boolean voltageRegulatorOn, double targetV, double targetDeadband) {\n+        return voltageLevel.newShuntCompensator()\n                 .setId(id)\n                 .setName(name)\n                 .setConnectableBus(\"busA\")\n-                .setbPerSection(bPerSection)\n-                .setCurrentSectionCount(currentSectionCount)\n-                .setMaximumSectionCount(maxSectionCount)\n+                .setSectionCount(currentSectionCount)", "originalCommit": "8a3e22c4dd4e26ce87b74cea24fa454aaad97524", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7f42a520d8b47e097d9938df2bb925523f52a4cc", "url": "https://github.com/powsybl/powsybl-core/commit/7f42a520d8b47e097d9938df2bb925523f52a4cc", "message": "Rename currentSectionCount parameter\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-24T13:33:37Z", "type": "forcePushed"}, {"oid": "51877f1e100e664e162d8d506aec43a19f2bbd29", "url": "https://github.com/powsybl/powsybl-core/commit/51877f1e100e664e162d8d506aec43a19f2bbd29", "message": "Revert \"Fix conflicts: correct loss factors values + add test for shunt.getOptionalName()\"\n\nThis reverts commit 2610d2724070bcd9324fddf901d4f0eca06c1c07.\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:56:20Z", "type": "commit"}, {"oid": "c3d7ca5046c5e7c52a4786880e413833afb2cbe0", "url": "https://github.com/powsybl/powsybl-core/commit/c3d7ca5046c5e7c52a4786880e413833afb2cbe0", "message": "Revert \"Revert \"Introduction of non linear shunt compensators (#1202)\"\"\n\nThis reverts commit f60b5da8e9a8c0a8506bb2d6c9b148d3eebcf8af.\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:56:20Z", "type": "commit"}, {"oid": "b08f2e46219d07116cbe9d7d00da3e5d9ad993d7", "url": "https://github.com/powsybl/powsybl-core/commit/b08f2e46219d07116cbe9d7d00da3e5d9ad993d7", "message": "Revert \"Revert \"Support XIIDM serialization/deserialization with new shunt API (#1244)\"\"\n\nThis reverts commit 0b8b3a8c17bbbd7a368ba9445ce639d3d697ed27.\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:56:20Z", "type": "commit"}, {"oid": "7d783b6743d998f846f0313e778504b08f43cd0d", "url": "https://github.com/powsybl/powsybl-core/commit/7d783b6743d998f846f0313e778504b08f43cd0d", "message": "Bug fix: correct inconsistencies in shunt API and implementation\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nSmall correction: linearShuntModel.getB(0) returns 0 (not bPerSection)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nAdd coverage test for ShuntCompensatorAdapter\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nAdd coverage test for linear shunts\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nAdd coverage test for non linear shunts\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nRename parameters\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\ncorrections implementations\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\ncorrections javadoc\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nApply reviewer's remarks\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\njavadoc more comprehensive\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nDelete shunt.getMax/MinB/G + rename model.getB/G as model.getB/GSection + introduce shunt.getB/G\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\ncheck before getB()\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nrenaming + section 0 corresponds to disconnected state + coverage tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nupdate javadoc\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nupdate javadoc\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nsmall correction\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nCorrect CGMES import of non linear shunts\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nRename setSectionNum() as setSectionIndex()\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:56:20Z", "type": "commit"}, {"oid": "b54cf29144b805201276a3173ea8c3335d834021", "url": "https://github.com/powsybl/powsybl-core/commit/b54cf29144b805201276a3173ea8c3335d834021", "message": "Section number could be 0 for non linear shunt model.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:56:20Z", "type": "commit"}, {"oid": "7e093dfab44a94d9f117fdfb39244cff8810d3f0", "url": "https://github.com/powsybl/powsybl-core/commit/7e093dfab44a94d9f117fdfb39244cff8810d3f0", "message": "Add simulShunt in LoadflowParameters\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nChange Shunt API/impl\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nChange ShuntXml conversion\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nChange CGMES Shunt conversion\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nAdd fix in shunt CGMES conversion\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nRenaming methods\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nFix in CGMES shunt conversion: if section number is 0, ignore\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nDelete check CGMES\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nsmall corrections: use == to check equality of shunt types\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nadd simulshunt in lf parameters methods + lf paramas deserializer/serializer (and test corrections)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nChange Shunt API/impl\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nCorrect test impl\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:56:21Z", "type": "commit"}, {"oid": "6b67e623ca4d7c8683ee2a2969bd449fa3d7304d", "url": "https://github.com/powsybl/powsybl-core/commit/6b67e623ca4d7c8683ee2a2969bd449fa3d7304d", "message": "Fix compilation errors after rebase\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "e0845971b35debd054ff28e74e33f326174e6a75", "url": "https://github.com/powsybl/powsybl-core/commit/e0845971b35debd054ff28e74e33f326174e6a75", "message": "Revert files XIIDM 1.2\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "4040774788da7a9660cdd73979643459cfde06ca", "url": "https://github.com/powsybl/powsybl-core/commit/4040774788da7a9660cdd73979643459cfde06ca", "message": "Correct json parameters files\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "dc561f3299341831dc83db1eecec608c146bf920", "url": "https://github.com/powsybl/powsybl-core/commit/dc561f3299341831dc83db1eecec608c146bf920", "message": "Change XML serialisation for shunts\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "08aa9814ebfb5b0af41a60b9d7b45439f79e5854", "url": "https://github.com/powsybl/powsybl-core/commit/08aa9814ebfb5b0af41a60b9d7b45439f79e5854", "message": "Correct CGMES shunt import\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "e03108ca006a9a249f0bae2299114cf7496a59d7", "url": "https://github.com/powsybl/powsybl-core/commit/e03108ca006a9a249f0bae2299114cf7496a59d7", "message": "Correct IEEE converter tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "2de565061fbdf5c1cde8c7c6f67b29a017483e95", "url": "https://github.com/powsybl/powsybl-core/commit/2de565061fbdf5c1cde8c7c6f67b29a017483e95", "message": "Correct groovy binding\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "e5645215b832e733e0c1d3908522b876c260b144", "url": "https://github.com/powsybl/powsybl-core/commit/e5645215b832e733e0c1d3908522b876c260b144", "message": "Correct matpower tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "7ac5af538a9f17f6ee777b72d7c39b7da938e4ff", "url": "https://github.com/powsybl/powsybl-core/commit/7ac5af538a9f17f6ee777b72d7c39b7da938e4ff", "message": "Correct merging view tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "a147b69231f149ea9748ac93436227599ae511b2", "url": "https://github.com/powsybl/powsybl-core/commit/a147b69231f149ea9748ac93436227599ae511b2", "message": "Correct psse converter tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "26b7617e9820434297c31c5a9037cfd262468263", "url": "https://github.com/powsybl/powsybl-core/commit/26b7617e9820434297c31c5a9037cfd262468263", "message": "Change methods name in Shunt API\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:01Z", "type": "commit"}, {"oid": "0c5018dc10df0bedc6772ccdea59ec35ae028853", "url": "https://github.com/powsybl/powsybl-core/commit/0c5018dc10df0bedc6772ccdea59ec35ae028853", "message": "Update sectionCount attribute in XIIDM\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:02Z", "type": "commit"}, {"oid": "ae921747e589d6e28519e0d0cb60e35e15429b0a", "url": "https://github.com/powsybl/powsybl-core/commit/ae921747e589d6e28519e0d0cb60e35e15429b0a", "message": "Delete methods for shunts using the concept of sectionIndex\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:02Z", "type": "commit"}, {"oid": "5330932dd5f435b7a19e695140beddabeeb2275b", "url": "https://github.com/powsybl/powsybl-core/commit/5330932dd5f435b7a19e695140beddabeeb2275b", "message": "Replace currentSectionCount parameters/fields by sectionCount\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:02Z", "type": "commit"}, {"oid": "77eaaab9f8bc7b8ad1c979bd9387776e4a82b016", "url": "https://github.com/powsybl/powsybl-core/commit/77eaaab9f8bc7b8ad1c979bd9387776e4a82b016", "message": "Update javadoc\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:02Z", "type": "commit"}, {"oid": "ec48e38f25d4a20194288d0ecd7698fec55b55d7", "url": "https://github.com/powsybl/powsybl-core/commit/ec48e38f25d4a20194288d0ecd7698fec55b55d7", "message": "Rename currentSectionCount parameter\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:02Z", "type": "commit"}, {"oid": "eeea873f701565f174b8b5d8d2c5f38a4fd52f5b", "url": "https://github.com/powsybl/powsybl-core/commit/eeea873f701565f174b8b5d8d2c5f38a4fd52f5b", "message": "If the g is undefined in non linear shunt model adder, g per section is considered equal to 0 (g = g of last section)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T13:57:02Z", "type": "commit"}, {"oid": "4823054b81f59a3ada35ea40febb959836f09f7d", "url": "https://github.com/powsybl/powsybl-core/commit/4823054b81f59a3ada35ea40febb959836f09f7d", "message": "Corrections after rebase\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T14:05:22Z", "type": "commit"}, {"oid": "4823054b81f59a3ada35ea40febb959836f09f7d", "url": "https://github.com/powsybl/powsybl-core/commit/4823054b81f59a3ada35ea40febb959836f09f7d", "message": "Corrections after rebase\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-25T14:05:22Z", "type": "forcePushed"}]}