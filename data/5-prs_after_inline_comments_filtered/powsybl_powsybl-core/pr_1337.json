{"pr_number": 1337, "pr_title": "Add an option to sort equipments in IIDM XML export", "pr_createdAt": "2020-06-05T15:26:29Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1337", "timeline": [{"oid": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "url": "https://github.com/powsybl/powsybl-core/commit/5ec66d10493a4186d3286ee1f4ecb279a37a758c", "message": "Add an option to sort equipments in IIDM XML export\n\nSigned-off-by: Geoffroy Jamgotchian <geoffroy.jamgotchian@rte-france.com>", "committedDate": "2020-06-05T15:24:03Z", "type": "commit"}, {"oid": "ae679bcc0a803ca3232c5c0369a9e9ceaeea13d9", "url": "https://github.com/powsybl/powsybl-core/commit/ae679bcc0a803ca3232c5c0369a9e9ceaeea13d9", "message": "Merge branch 'master' into xml_sorted", "committedDate": "2020-06-08T21:11:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0MDcwMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437240702", "bodyText": "Don't know if we should change the signature of this deprecated method? I think we can either delete it directly or not change it and make it call writeCurrentLimits(index, limits, writer, IidmXmlConstants.CURRENT_IIDM_XML_VERSION, new ExportOptions());", "author": "MioRtia", "createdAt": "2020-06-09T08:47:52Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AbstractConnectableXml.java", "diffHunk": "@@ -162,26 +164,29 @@ public static void readCurrentLimits(Integer index, Supplier<CurrentLimitsAdder>\n     }\n \n     /**\n-     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion)} instead.\n+     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion, ExportOptions)} instead.\n      */\n     @Deprecated\n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, ExportOptions exportOptions) throws XMLStreamException {", "originalCommit": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQzMjc5Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437432793", "bodyText": "Deprecation has been put end of January (so 3.1?) so maybe the best solution is to to remove it? Using new ExportOptions() would be very confusing as we could end up using this deprecated method as partially sorted file (but we are not suppose to start using a deprecated method).\nAs you want.", "author": "geofjamg", "createdAt": "2020-06-09T13:47:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0MDcwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkzNzAxNQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437937015", "bodyText": "In this case, I think we can remove the deprecated methods, it will be cleaner.", "author": "miovd", "createdAt": "2020-06-10T08:05:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0MDcwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3NDg1Nw==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r464874857", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-04T08:07:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0MDcwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0MDgzNQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437240835", "bodyText": "Same remark", "author": "MioRtia", "createdAt": "2020-06-09T08:48:03Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AbstractConnectableXml.java", "diffHunk": "@@ -162,26 +164,29 @@ public static void readCurrentLimits(Integer index, Supplier<CurrentLimitsAdder>\n     }\n \n     /**\n-     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion)} instead.\n+     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion, ExportOptions)} instead.\n      */\n     @Deprecated\n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, ExportOptions exportOptions) throws XMLStreamException {\n+        writeCurrentLimits(index, limits, writer, IidmXmlConstants.CURRENT_IIDM_XML_VERSION, exportOptions);\n     }\n \n     /**\n-     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, String, IidmXmlVersion)} instead.\n+     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, String, IidmXmlVersion, ExportOptions)} instead.\n      */\n     @Deprecated\n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, String nsUri) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, nsUri, IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, String nsUri,", "originalCommit": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3NDkzMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r464874932", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-04T08:07:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0MDgzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0Mzc0MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437243741", "bodyText": "Should we keep the previous signature writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion) as deprecated? It can be used in extensions outside iidm-xml-converter)", "author": "MioRtia", "createdAt": "2020-06-09T08:52:37Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AbstractConnectableXml.java", "diffHunk": "@@ -162,26 +164,29 @@ public static void readCurrentLimits(Integer index, Supplier<CurrentLimitsAdder>\n     }\n \n     /**\n-     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion)} instead.\n+     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion, ExportOptions)} instead.\n      */\n     @Deprecated\n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, ExportOptions exportOptions) throws XMLStreamException {\n+        writeCurrentLimits(index, limits, writer, IidmXmlConstants.CURRENT_IIDM_XML_VERSION, exportOptions);\n     }\n \n     /**\n-     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, String, IidmXmlVersion)} instead.\n+     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, String, IidmXmlVersion, ExportOptions)} instead.\n      */\n     @Deprecated\n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, String nsUri) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, nsUri, IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, String nsUri,\n+                                          ExportOptions exportOptions) throws XMLStreamException {\n+        writeCurrentLimits(index, limits, writer, nsUri, IidmXmlConstants.CURRENT_IIDM_XML_VERSION, exportOptions);\n     }\n \n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, IidmXmlVersion version) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, version.getNamespaceURI(), version);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, IidmXmlVersion version,", "originalCommit": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQzNDM3OQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437434379", "bodyText": "Ok I will keep it for backward compat.", "author": "geofjamg", "createdAt": "2020-06-09T13:49:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0Mzc0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3NDk5NQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r464874995", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-04T08:07:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0Mzc0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0Mzg2NQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437243865", "bodyText": "Same question", "author": "MioRtia", "createdAt": "2020-06-09T08:52:49Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AbstractConnectableXml.java", "diffHunk": "@@ -162,26 +164,29 @@ public static void readCurrentLimits(Integer index, Supplier<CurrentLimitsAdder>\n     }\n \n     /**\n-     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion)} instead.\n+     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion, ExportOptions)} instead.\n      */\n     @Deprecated\n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, ExportOptions exportOptions) throws XMLStreamException {\n+        writeCurrentLimits(index, limits, writer, IidmXmlConstants.CURRENT_IIDM_XML_VERSION, exportOptions);\n     }\n \n     /**\n-     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, String, IidmXmlVersion)} instead.\n+     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, String, IidmXmlVersion, ExportOptions)} instead.\n      */\n     @Deprecated\n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, String nsUri) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, nsUri, IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, String nsUri,\n+                                          ExportOptions exportOptions) throws XMLStreamException {\n+        writeCurrentLimits(index, limits, writer, nsUri, IidmXmlConstants.CURRENT_IIDM_XML_VERSION, exportOptions);\n     }\n \n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, IidmXmlVersion version) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, version.getNamespaceURI(), version);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, IidmXmlVersion version,\n+                                          ExportOptions exportOptions) throws XMLStreamException {\n+        writeCurrentLimits(index, limits, writer, version.getNamespaceURI(), version, exportOptions);\n     }\n \n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, String nsUri, IidmXmlVersion version) throws XMLStreamException {\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, String nsUri, IidmXmlVersion version,", "originalCommit": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3NTA0OQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r464875049", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-04T08:07:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0Mzg2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NTcwMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437245702", "bodyText": "Maybe add some javadoc? It is rather intuitive but I'd rather have public util methods well documentated here (particularly specifying by what are the extensions sorted, here by their names).", "author": "MioRtia", "createdAt": "2020-06-09T08:55:29Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/util/IidmXmlUtil.java", "diffHunk": "@@ -177,6 +186,49 @@ public static void writeIntAttributeUntilMaximumVersion(String attributeName, in\n         }\n     }\n \n+    public static Iterable<? extends Extension<? extends Identifiable<?>>> sortedExtensions(Iterable<? extends Extension<? extends Identifiable<?>>> extensions, ExportOptions exportOptions) {", "originalCommit": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQzNjAyOQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437436029", "bodyText": "I can just globally document the sorted option in ExportOptions (so describe the sorting key for each of the xml element) ?", "author": "geofjamg", "createdAt": "2020-06-09T13:50:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NTcwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkzNzM0Ng==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437937346", "bodyText": "Yes, it works for me.", "author": "miovd", "createdAt": "2020-06-10T08:05:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NTcwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3NTE1NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r464875154", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-04T08:07:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NTcwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NTk1MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437245950", "bodyText": "Same remark", "author": "MioRtia", "createdAt": "2020-06-09T08:55:48Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/util/IidmXmlUtil.java", "diffHunk": "@@ -177,6 +186,49 @@ public static void writeIntAttributeUntilMaximumVersion(String attributeName, in\n         }\n     }\n \n+    public static Iterable<? extends Extension<? extends Identifiable<?>>> sortedExtensions(Iterable<? extends Extension<? extends Identifiable<?>>> extensions, ExportOptions exportOptions) {\n+        Objects.requireNonNull(exportOptions);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(extensions.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(Extension::getName))\n+                                                       .collect(Collectors.toList())\n+                : extensions;\n+    }\n+\n+    public static <T extends Identifiable> Iterable<T> sorted(Iterable<T> identifiables, ExportOptions exportOptions) {", "originalCommit": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3NTI2OQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r464875269", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-04T08:08:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NTk1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NjAzNw==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437246037", "bodyText": "Same remark", "author": "MioRtia", "createdAt": "2020-06-09T08:55:56Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/util/IidmXmlUtil.java", "diffHunk": "@@ -177,6 +186,49 @@ public static void writeIntAttributeUntilMaximumVersion(String attributeName, in\n         }\n     }\n \n+    public static Iterable<? extends Extension<? extends Identifiable<?>>> sortedExtensions(Iterable<? extends Extension<? extends Identifiable<?>>> extensions, ExportOptions exportOptions) {\n+        Objects.requireNonNull(exportOptions);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(extensions.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(Extension::getName))\n+                                                       .collect(Collectors.toList())\n+                : extensions;\n+    }\n+\n+    public static <T extends Identifiable> Iterable<T> sorted(Iterable<T> identifiables, ExportOptions exportOptions) {\n+        Objects.requireNonNull(identifiables);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(identifiables.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(Identifiable::getId))\n+                                                       .collect(Collectors.toList())\n+                                        : identifiables;\n+    }\n+\n+    public static Iterable<CurrentLimits.TemporaryLimit> sortedTemporaryLimits(Iterable<CurrentLimits.TemporaryLimit> temporaryLimits, ExportOptions exportOptions) {", "originalCommit": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3NTMwNA==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r464875304", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-04T08:08:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NjAzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NjE0MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437246141", "bodyText": "Same remark", "author": "MioRtia", "createdAt": "2020-06-09T08:56:05Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/util/IidmXmlUtil.java", "diffHunk": "@@ -177,6 +186,49 @@ public static void writeIntAttributeUntilMaximumVersion(String attributeName, in\n         }\n     }\n \n+    public static Iterable<? extends Extension<? extends Identifiable<?>>> sortedExtensions(Iterable<? extends Extension<? extends Identifiable<?>>> extensions, ExportOptions exportOptions) {\n+        Objects.requireNonNull(exportOptions);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(extensions.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(Extension::getName))\n+                                                       .collect(Collectors.toList())\n+                : extensions;\n+    }\n+\n+    public static <T extends Identifiable> Iterable<T> sorted(Iterable<T> identifiables, ExportOptions exportOptions) {\n+        Objects.requireNonNull(identifiables);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(identifiables.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(Identifiable::getId))\n+                                                       .collect(Collectors.toList())\n+                                        : identifiables;\n+    }\n+\n+    public static Iterable<CurrentLimits.TemporaryLimit> sortedTemporaryLimits(Iterable<CurrentLimits.TemporaryLimit> temporaryLimits, ExportOptions exportOptions) {\n+        Objects.requireNonNull(temporaryLimits);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(temporaryLimits.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(CurrentLimits.TemporaryLimit::getName))\n+                                                       .collect(Collectors.toList())\n+                                        : temporaryLimits;\n+    }\n+\n+    public static Iterable<VoltageLevel.NodeBreakerView.InternalConnection> sortedInternalConnections(Iterable<VoltageLevel.NodeBreakerView.InternalConnection> internalConnections, ExportOptions exportOptions) {", "originalCommit": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3NTM0Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r464875342", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-04T08:08:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI0NjE0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI1MzQ4Ng==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r437253486", "bodyText": "Same remark", "author": "MioRtia", "createdAt": "2020-06-09T09:04:57Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/util/IidmXmlUtil.java", "diffHunk": "@@ -177,6 +186,49 @@ public static void writeIntAttributeUntilMaximumVersion(String attributeName, in\n         }\n     }\n \n+    public static Iterable<? extends Extension<? extends Identifiable<?>>> sortedExtensions(Iterable<? extends Extension<? extends Identifiable<?>>> extensions, ExportOptions exportOptions) {\n+        Objects.requireNonNull(exportOptions);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(extensions.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(Extension::getName))\n+                                                       .collect(Collectors.toList())\n+                : extensions;\n+    }\n+\n+    public static <T extends Identifiable> Iterable<T> sorted(Iterable<T> identifiables, ExportOptions exportOptions) {\n+        Objects.requireNonNull(identifiables);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(identifiables.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(Identifiable::getId))\n+                                                       .collect(Collectors.toList())\n+                                        : identifiables;\n+    }\n+\n+    public static Iterable<CurrentLimits.TemporaryLimit> sortedTemporaryLimits(Iterable<CurrentLimits.TemporaryLimit> temporaryLimits, ExportOptions exportOptions) {\n+        Objects.requireNonNull(temporaryLimits);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(temporaryLimits.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(CurrentLimits.TemporaryLimit::getName))\n+                                                       .collect(Collectors.toList())\n+                                        : temporaryLimits;\n+    }\n+\n+    public static Iterable<VoltageLevel.NodeBreakerView.InternalConnection> sortedInternalConnections(Iterable<VoltageLevel.NodeBreakerView.InternalConnection> internalConnections, ExportOptions exportOptions) {\n+        Objects.requireNonNull(internalConnections);\n+        Objects.requireNonNull(exportOptions);\n+        return exportOptions.isSorted() ? StreamSupport.stream(internalConnections.spliterator(), false)\n+                                                       .sorted(Comparator.comparing(VoltageLevel.NodeBreakerView.InternalConnection::getNode1)\n+                                                                         .thenComparing(VoltageLevel.NodeBreakerView.InternalConnection::getNode2))\n+                                                       .collect(Collectors.toList())\n+                : internalConnections;\n+    }\n+\n+    public static <T extends Identifiable<T>> Stream<T> sorted(Stream<T> stream, ExportOptions exportOptions) {", "originalCommit": "5ec66d10493a4186d3286ee1f4ecb279a37a758c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3NTM3OQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r464875379", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-04T08:08:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI1MzQ4Ng=="}], "type": "inlineReview"}, {"oid": "0c2c002c3f406c2cc420ac897261c93bd9286eb9", "url": "https://github.com/powsybl/powsybl-core/commit/0c2c002c3f406c2cc420ac897261c93bd9286eb9", "message": "Merge branch 'master' into xml_sorted\n\n# Conflicts:\n#\tiidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/NetworkXml.java", "committedDate": "2020-08-04T07:19:15Z", "type": "commit"}, {"oid": "2b1c10ea0d20acdb1fb65f437a4df43a01aa5599", "url": "https://github.com/powsybl/powsybl-core/commit/2b1c10ea0d20acdb1fb65f437a4df43a01aa5599", "message": "Fix merge\n\nSigned-off-by: Geoffroy Jamgotchian <geoffroy.jamgotchian@rte-france.com>", "committedDate": "2020-08-04T07:23:41Z", "type": "commit"}, {"oid": "82214c9456c3242b8382b449ec16fd1106cce8af", "url": "https://github.com/powsybl/powsybl-core/commit/82214c9456c3242b8382b449ec16fd1106cce8af", "message": "Review changes\n\nSigned-off-by: Geoffroy Jamgotchian <geoffroy.jamgotchian@rte-france.com>", "committedDate": "2020-08-04T08:05:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM1MjA2MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r471352061", "bodyText": "Please add the @Deprecated tag", "author": "MioRtia", "createdAt": "2020-08-17T09:22:56Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AbstractConnectableXml.java", "diffHunk": "@@ -162,26 +164,27 @@ public static void readCurrentLimits(Integer index, Supplier<CurrentLimitsAdder>\n     }\n \n     /**\n-     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion)} instead.\n+     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion, ExportOptions)} instead.\n      */\n-    @Deprecated\n-    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer) throws XMLStreamException {\n-        writeCurrentLimits(index, limits, writer, IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+    public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer, IidmXmlVersion version) throws XMLStreamException {", "originalCommit": "82214c9456c3242b8382b449ec16fd1106cce8af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU3MjM5MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1337#discussion_r475572391", "bodyText": "Done", "author": "geofjamg", "createdAt": "2020-08-24T12:46:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM1MjA2MQ=="}], "type": "inlineReview"}, {"oid": "37356adcd087cbddd8752b868dee37691d1cc254", "url": "https://github.com/powsybl/powsybl-core/commit/37356adcd087cbddd8752b868dee37691d1cc254", "message": "Add missing deprecated\n\nSigned-off-by: Geoffroy Jamgotchian <geoffroy.jamgotchian@rte-france.com>", "committedDate": "2020-08-24T12:45:16Z", "type": "commit"}, {"oid": "17bc64e351382c2daa4c8ba9d2884a3862eba05a", "url": "https://github.com/powsybl/powsybl-core/commit/17bc64e351382c2daa4c8ba9d2884a3862eba05a", "message": "Merge branch 'master' into xml_sorted", "committedDate": "2020-08-24T12:45:39Z", "type": "commit"}]}