{"pr_number": 1488, "pr_title": "Introduce concept of Boundary for DanglingLine and TieLine", "pr_createdAt": "2020-09-25T13:37:28Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1488", "timeline": [{"oid": "eedaa00e85843f5dc0684631c37817fbc5d468e2", "url": "https://github.com/powsybl/powsybl-core/commit/eedaa00e85843f5dc0684631c37817fbc5d468e2", "message": "Implementation in memory for new API\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-10-06T14:01:50Z", "type": "forcePushed"}, {"oid": "16df6056af6d5651e4d2c0fb1ebcf11da689f5b0", "url": "https://github.com/powsybl/powsybl-core/commit/16df6056af6d5651e4d2c0fb1ebcf11da689f5b0", "message": "Update serialization\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-10-09T08:07:13Z", "type": "forcePushed"}, {"oid": "cb754900e9bd44cf30cf8451311fc93ac6a6dc2c", "url": "https://github.com/powsybl/powsybl-core/commit/cb754900e9bd44cf30cf8451311fc93ac6a6dc2c", "message": "Add a warning if tieline values are ignored during XML import\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-10-15T08:07:48Z", "type": "forcePushed"}, {"oid": "7d46db3937dcb937305e90a30d044c4d9b20a593", "url": "https://github.com/powsybl/powsybl-core/commit/7d46db3937dcb937305e90a30d044c4d9b20a593", "message": "Add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-10-19T12:06:52Z", "type": "forcePushed"}, {"oid": "7d55f397519adcef3175b75ed55f3677e42a1397", "url": "https://github.com/powsybl/powsybl-core/commit/7d55f397519adcef3175b75ed55f3677e42a1397", "message": "Add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-10-19T12:24:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjYwMzAzMw==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r512603033", "bodyText": "I am not sure to like BoundaryPoint name choice indeed. We have no Point in IIDM: we have node, bus and terminal. When you do getBoundaryPoint(Branch.Side.ONE).getP() for me you refer to a terminal and it will be clearer to do getHalf1().getBoundaryTerminal().getP().", "author": "annetill", "createdAt": "2020-10-27T11:10:27Z", "path": "ampl-converter/src/main/java/com/powsybl/ampl/converter/AmplNetworkWriter.java", "diffHunk": "@@ -639,9 +639,9 @@ private void writeLines(AmplExportContext context, TableFormatter formatter) thr\n                         .writeCell(-1) // no ratio tap changer\n                         .writeCell(-1) // no phase tap changer\n                         .writeCell(t1.getP())\n-                        .writeCell(-tl.getHalf1().getXnodeP()) // xnode node flow side 1\n+                        .writeCell(-tl.getBoundaryPoint(Branch.Side.ONE).getP()) // xnode node flow side 1", "originalCommit": "72e7c9ee55cedb05cc15fe1c61103c8bc882d82d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTc5ODE5Ng==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r515798196", "bodyText": "I don't like using the term Terminal when it is not really a Terminal object... It is a bit confusing, for me it is not a node, bus or terminal and this is why I created another term.", "author": "miovd", "createdAt": "2020-11-02T08:11:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjYwMzAzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY0NjQ1MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r518646450", "bodyText": "Maybe we can remove the point word and keep getBoundary(Side)? But I agree with @MioRtia, terminal would be confusing for IIDM-fluent people as there is no Terminal object there", "author": "mathbagu", "createdAt": "2020-11-06T10:04:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjYwMzAzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgxNTUwOA==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r518815508", "bodyText": "Another proposal:\ntieLine.getHalf1().getOtherSide().getP()\ndanglingLine.getOtherSide().getP()\nIn that proposal for tie lines, the half line is not hidden because it is comparable to dangling line concept.\nAbout the sign: I think that Mathieu is right, the sign should not changed as P at t1 has the opposite sign of P at boundary terminal. Indeed a test is missing in the AMPL converter.", "author": "annetill", "createdAt": "2020-11-06T15:14:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjYwMzAzMw=="}], "type": "inlineReview"}, {"oid": "2917863bca715f4ec4a787d7d24e1104950f0fc6", "url": "https://github.com/powsybl/powsybl-core/commit/2917863bca715f4ec4a787d7d24e1104950f0fc6", "message": "Rename boundary point values of tieline in XIIDM 1.5\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-02T08:25:50Z", "type": "forcePushed"}, {"oid": "ee867e1e7cd692766e8a12218db452331d0d4849", "url": "https://github.com/powsybl/powsybl-core/commit/ee867e1e7cd692766e8a12218db452331d0d4849", "message": "Rename boundary point values of tieline in XIIDM 1.5\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-02T09:21:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1NjgxMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r518656812", "bodyText": "I wonder if the sign are OK (same question above): could you confirm it is?", "author": "mathbagu", "createdAt": "2020-11-06T10:23:23Z", "path": "ampl-converter/src/main/java/com/powsybl/ampl/converter/AmplNetworkWriter.java", "diffHunk": "@@ -665,9 +665,9 @@ private void writeLines(AmplExportContext context, TableFormatter formatter) thr\n                         .writeCell(1f) // constant ratio\n                         .writeCell(-1) // no ratio tap changer\n                         .writeCell(-1) // no phase tap changer\n-                        .writeCell(-tl.getHalf2().getXnodeP()) // xnode node flow side 2\n+                        .writeCell(-tl.getBoundaryPoint(Branch.Side.TWO).getP()) // xnode node flow side 2\n                         .writeCell(t2.getP())\n-                        .writeCell(-tl.getHalf2().getXnodeQ()) // xnode node flow side 2\n+                        .writeCell(-tl.getBoundaryPoint(Branch.Side.TWO).getQ()) // xnode node flow side 2", "originalCommit": "ee867e1e7cd692766e8a12218db452331d0d4849", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc0NDQxNw==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r526744417", "bodyText": "Not sure but xnodeQ and otherSide.getQ() were the same sign but I will check", "author": "miovd", "createdAt": "2020-11-19T10:16:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1NjgxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1NzYyNQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r518657625", "bodyText": "Is returning null better?", "author": "mathbagu", "createdAt": "2020-11-06T10:24:53Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/DanglingLine.java", "diffHunk": "@@ -278,4 +278,7 @@ default Generation getGeneration() {\n \n     CurrentLimitsAdder newCurrentLimits();\n \n+    default BoundaryPoint getBoundaryPoint() {\n+        throw new UnsupportedOperationException();", "originalCommit": "ee867e1e7cd692766e8a12218db452331d0d4849", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc1MTQ2Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r526751463", "bodyText": "See answer below", "author": "miovd", "createdAt": "2020-11-19T10:26:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1NzYyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1ODAxNw==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r518658017", "bodyText": "Is returning null better?", "author": "mathbagu", "createdAt": "2020-11-06T10:25:40Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/TieLine.java", "diffHunk": "@@ -289,4 +301,7 @@ default HalfLine setFictitious(boolean fictitious) {\n      */\n     HalfLine getHalf(Side side);\n \n+    default BoundaryPoint getBoundaryPoint(Side side) {\n+        throw new UnsupportedOperationException();", "originalCommit": "ee867e1e7cd692766e8a12218db452331d0d4849", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc0MjAxNA==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r526742014", "bodyText": "I don't know, it would throw a null pointer exception (as every time we call it, it is to have a value and this object is supposed to never be null), wouldn't it be weird and more difficult to debug?", "author": "miovd", "createdAt": "2020-11-19T10:12:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1ODAxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY3NzI2Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r518677263", "bodyText": "To make the code simpler to read, add two private methods to get the Voltage and the Angle a bus\nprivate double getV(Bus b) {\n    return bus == null ? Double.NaN : b.getV();\n}\nprivate double getAngle(Bus b) {\n    return bus == null ? Double.NaN : b.getAngle();\n}\n\nand use them everywhere. Maybe these methods could be share with the other implementation", "author": "mathbagu", "createdAt": "2020-11-06T10:59:40Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/DanglingLineBoundaryPointImpl.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network.impl;\n+\n+import com.powsybl.iidm.network.BoundaryPoint;\n+import com.powsybl.iidm.network.Bus;\n+import com.powsybl.iidm.network.DanglingLine;\n+import com.powsybl.iidm.network.Terminal;\n+import com.powsybl.iidm.network.util.SV;\n+\n+import java.util.Objects;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+class DanglingLineBoundaryPointImpl implements BoundaryPoint {\n+\n+    private final DanglingLine parent;\n+\n+    DanglingLineBoundaryPointImpl(DanglingLine parent) {\n+        this.parent = Objects.requireNonNull(parent);\n+    }\n+\n+    @Override\n+    public double getV() {\n+        Terminal t = parent.getTerminal();\n+        Bus b = t.getBusView().getBus();\n+        return new SV(t.getP(), t.getQ(), b != null ? b.getV() : Double.NaN, b != null ? b.getAngle() : Double.NaN).otherSideU(parent);\n+    }\n+\n+    @Override\n+    public double getAngle() {\n+        Terminal t = parent.getTerminal();\n+        Bus b = t.getBusView().getBus();\n+        return new SV(t.getP(), t.getQ(), b != null ? b.getV() : Double.NaN, b != null ? b.getAngle() : Double.NaN).otherSideA(parent);\n+    }\n+\n+    @Override\n+    public double getP() {\n+        Terminal t = parent.getTerminal();\n+        Bus b = t.getBusView().getBus();\n+        return new SV(t.getP(), t.getQ(), b != null ? b.getV() : Double.NaN, b != null ? b.getAngle() : Double.NaN).otherSideP(parent);\n+    }\n+\n+    @Override\n+    public double getQ() {\n+        Terminal t = parent.getTerminal();\n+        Bus b = t.getBusView().getBus();\n+        return new SV(t.getP(), t.getQ(), b != null ? b.getV() : Double.NaN, b != null ? b.getAngle() : Double.NaN).otherSideQ(parent);", "originalCommit": "ee867e1e7cd692766e8a12218db452331d0d4849", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY3Nzk4NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r518677984", "bodyText": "terminalSupplier is a better name", "author": "mathbagu", "createdAt": "2020-11-06T11:00:30Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TieLineBoundaryPointImpl.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network.impl;\n+\n+import com.powsybl.iidm.network.BoundaryPoint;\n+import com.powsybl.iidm.network.Bus;\n+import com.powsybl.iidm.network.Terminal;\n+import com.powsybl.iidm.network.TieLine;\n+import com.powsybl.iidm.network.util.SV;\n+\n+import java.util.Objects;\n+import java.util.function.Supplier;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+class TieLineBoundaryPointImpl implements BoundaryPoint {\n+\n+    private final Supplier<Terminal> terminalGetter;\n+\n+    private final TieLine.HalfLine halfLine;\n+\n+    TieLineBoundaryPointImpl(TieLine.HalfLine halfLine, Supplier<Terminal> terminalGetter) {", "originalCommit": "ee867e1e7cd692766e8a12218db452331d0d4849", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY4MTY0NQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r518681645", "bodyText": "If values are computed, why do we read/write them? For instance we do not serialize the intensity (Terminal.getI())", "author": "mathbagu", "createdAt": "2020-11-06T11:06:51Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/DanglingLineXml.java", "diffHunk": "@@ -132,4 +161,30 @@ protected void readSubElements(DanglingLine dl, NetworkXmlReaderContext context)\n             }\n         });\n     }\n+\n+    private static void readBoundaryPoint(String dlId, BoundaryPoint boundaryPoint, NetworkXmlReaderContext context) {\n+        XMLStreamReader reader = context.getReader();\n+        double p = XmlUtil.readOptionalDoubleAttribute(reader, \"p\");\n+        double q = XmlUtil.readOptionalDoubleAttribute(reader, \"q\");\n+        double v = XmlUtil.readOptionalDoubleAttribute(reader, \"v\");\n+        double angle = XmlUtil.readOptionalDoubleAttribute(reader, ANGLE);\n+        context.getEndTasks().add(() -> {\n+            checkBoundaryValue(p, boundaryPoint.getP(), \"p\", dlId);\n+            checkBoundaryValue(q, boundaryPoint.getQ(), \"q\", dlId);\n+            checkBoundaryValue(v, boundaryPoint.getV(), \"v\", dlId);\n+            checkBoundaryValue(angle, boundaryPoint.getAngle(), ANGLE, dlId);\n+        });\n+    }\n+\n+    private static void checkBoundaryValue(double imported, double calculated, String name, String dlId) {\n+        if (!Double.isNaN(imported) && imported != calculated) {\n+            LOG.info(\"boundaryPoint.{} of DanglingLine {} is recalculated. Its imported value is not used (imported value = {}; calculated value = {})\", name, dlId, imported, calculated);\n+        }\n+    }\n+\n+    private static boolean hasDefinedBoundaryPoint(DanglingLine dl) {\n+        BoundaryPoint boundaryPoint = dl.getBoundaryPoint();\n+        return !Double.isNaN(boundaryPoint.getP()) || !Double.isNaN(boundaryPoint.getQ()) ||\n+                !Double.isNaN(boundaryPoint.getV()) || !Double.isNaN(boundaryPoint.getAngle());\n+    }", "originalCommit": "ee867e1e7cd692766e8a12218db452331d0d4849", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc0Mjk1Ng==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r526742956", "bodyText": "Good question, I don't remember why we wanted to serialize it... maybe it is not useful as you said. What do you think @annetill ?", "author": "miovd", "createdAt": "2020-11-19T10:13:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY4MTY0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc1ODI0Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r526758243", "bodyText": "After thinking and @zamarrenolm 's input, I think you are right", "author": "miovd", "createdAt": "2020-11-19T10:37:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY4MTY0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY4MjQ0NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r518682444", "bodyText": "Same question: I would only write xnodeP and xnodeQ to keep compatibilty with old XIIDM version", "author": "mathbagu", "createdAt": "2020-11-06T11:08:20Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/TieLineXml.java", "diffHunk": "@@ -45,8 +56,16 @@ private static void writeHalf(TieLine.HalfLine halfLine, NetworkXmlWriterContext\n         XmlUtil.writeDouble(\"b1_\" + side, halfLine.getB1(), context.getWriter());\n         XmlUtil.writeDouble(\"g2_\" + side, halfLine.getG2(), context.getWriter());\n         XmlUtil.writeDouble(\"b2_\" + side, halfLine.getB2(), context.getWriter());\n-        XmlUtil.writeDouble(\"xnodeP_\" + side, halfLine.getXnodeP(), context.getWriter());\n-        XmlUtil.writeDouble(\"xnodeQ_\" + side, halfLine.getXnodeQ(), context.getWriter());\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_4, context, () -> {\n+            XmlUtil.writeDouble(\"xnodeP_\" + side, boundaryPoint.getP(), context.getWriter());\n+            XmlUtil.writeDouble(\"xnodeQ_\" + side, boundaryPoint.getQ(), context.getWriter());\n+        });", "originalCommit": "ee867e1e7cd692766e8a12218db452331d0d4849", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6b06c98ffbeccefb8b2d4975db962c2669dee8cd", "url": "https://github.com/powsybl/powsybl-core/commit/6b06c98ffbeccefb8b2d4975db962c2669dee8cd", "message": "Make IIDM test files in XIIDM 1.5\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T11:17:05Z", "type": "commit"}, {"oid": "8c7f5ed87f3320b7cdba023ae7a4bf41d3c0306f", "url": "https://github.com/powsybl/powsybl-core/commit/8c7f5ed87f3320b7cdba023ae7a4bf41d3c0306f", "message": "Update with loadDetailRef.xml\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T11:17:05Z", "type": "commit"}, {"oid": "152cef109fdfc075d090a69dd5a10dd1fb2eb7ca", "url": "https://github.com/powsybl/powsybl-core/commit/152cef109fdfc075d090a69dd5a10dd1fb2eb7ca", "message": "Change API to introduce BoundaryPoint\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:05:01Z", "type": "commit"}, {"oid": "949dc0b53e64d4d702604c670b184595c0cc728f", "url": "https://github.com/powsybl/powsybl-core/commit/949dc0b53e64d4d702604c670b184595c0cc728f", "message": "Implementation in merging view\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:05:01Z", "type": "commit"}, {"oid": "f1b7ecaa3a9e6fc1cbff9fcb89e041dc735480b9", "url": "https://github.com/powsybl/powsybl-core/commit/f1b7ecaa3a9e6fc1cbff9fcb89e041dc735480b9", "message": "P0/Q0 are not updated anymore when P/Q of mergedline are modified: it is P/Q of BoundaryPoint\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:05:01Z", "type": "commit"}, {"oid": "39d5aa8f245ee905eb6433f8b7770ae019e1f2eb", "url": "https://github.com/powsybl/powsybl-core/commit/39d5aa8f245ee905eb6433f8b7770ae019e1f2eb", "message": "Modify API\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:05:29Z", "type": "commit"}, {"oid": "8e5d6801b0fa349ec231eec10801bbca8ba104b3", "url": "https://github.com/powsybl/powsybl-core/commit/8e5d6801b0fa349ec231eec10801bbca8ba104b3", "message": "Modify MergingView impl + tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:05:29Z", "type": "commit"}, {"oid": "d3e869eec175b2cc4ddf40659186d6cc35bb01d2", "url": "https://github.com/powsybl/powsybl-core/commit/d3e869eec175b2cc4ddf40659186d6cc35bb01d2", "message": "Implementation in memory for new API\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:00Z", "type": "commit"}, {"oid": "4fcd17649a7d057f2b188f72539a05e7963db8ef", "url": "https://github.com/powsybl/powsybl-core/commit/4fcd17649a7d057f2b188f72539a05e7963db8ef", "message": "Update serialization\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:00Z", "type": "commit"}, {"oid": "56d33641110932533159e7e5105282f85ce3716b", "url": "https://github.com/powsybl/powsybl-core/commit/56d33641110932533159e7e5105282f85ce3716b", "message": "Create constants (code smells)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:00Z", "type": "commit"}, {"oid": "f10bcce8b25a0654631355918c00c37e59f8c29e", "url": "https://github.com/powsybl/powsybl-core/commit/f10bcce8b25a0654631355918c00c37e59f8c29e", "message": "XnodeV and XnodeAngle cannot be set by user but are calculated\nSame for XnodeP and XnodeQ (setters are deprecated)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:08Z", "type": "commit"}, {"oid": "18671cc2e258dd0be8f88f20e708875264c55643", "url": "https://github.com/powsybl/powsybl-core/commit/18671cc2e258dd0be8f88f20e708875264c55643", "message": "Breaking change: delete setXnodeP/Q\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:24Z", "type": "commit"}, {"oid": "9e88af003b2f71192194c516b73e8da3c4be9aea", "url": "https://github.com/powsybl/powsybl-core/commit/9e88af003b2f71192194c516b73e8da3c4be9aea", "message": "Delete setXnodeP/Q + adapt tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:33Z", "type": "commit"}, {"oid": "81eb6c5b085d8b80f730eb945f01f4ea3da77ca3", "url": "https://github.com/powsybl/powsybl-core/commit/81eb6c5b085d8b80f730eb945f01f4ea3da77ca3", "message": "Add warning to ignore incorrect xnodeP/Q\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:34Z", "type": "commit"}, {"oid": "4b873e2ecedebdb217c2f2d6ffa6664a0af3a7f2", "url": "https://github.com/powsybl/powsybl-core/commit/4b873e2ecedebdb217c2f2d6ffa6664a0af3a7f2", "message": "Add a warning if tieline values are ignored during XML import\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:34Z", "type": "commit"}, {"oid": "792187c8c7b1e61b715b1e6d3b6e0ce7c4ec632c", "url": "https://github.com/powsybl/powsybl-core/commit/792187c8c7b1e61b715b1e6d3b6e0ce7c4ec632c", "message": "Refactoring code\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:42Z", "type": "commit"}, {"oid": "54b6f1981e353c6285f3d72c85b4737fd342413d", "url": "https://github.com/powsybl/powsybl-core/commit/54b6f1981e353c6285f3d72c85b4737fd342413d", "message": "Add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:07:51Z", "type": "commit"}, {"oid": "50a22561014fd10c166df1202b630a79ba8aed94", "url": "https://github.com/powsybl/powsybl-core/commit/50a22561014fd10c166df1202b630a79ba8aed94", "message": "Use SV to calculate Xnode values\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:08:03Z", "type": "commit"}, {"oid": "f2cf2b2fd03eb9abad7b77fe83c43b26501f4b35", "url": "https://github.com/powsybl/powsybl-core/commit/f2cf2b2fd03eb9abad7b77fe83c43b26501f4b35", "message": "Add danglingLine listener\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:08:03Z", "type": "commit"}, {"oid": "9eefa97c2ec00cbe2a941760adc80eee72d21c4c", "url": "https://github.com/powsybl/powsybl-core/commit/9eefa97c2ec00cbe2a941760adc80eee72d21c4c", "message": "Init boundary/xnodes values when the equipment is created\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:08:11Z", "type": "commit"}, {"oid": "e390a0f77180f2501a924ed5f0e9f8cdb03ca7aa", "url": "https://github.com/powsybl/powsybl-core/commit/e390a0f77180f2501a924ed5f0e9f8cdb03ca7aa", "message": "Delete setters of DanglingLine's BoundaryPoint\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:08:11Z", "type": "commit"}, {"oid": "67a7028995e12a5d52bd2ee6ac1497f72cb7c1f1", "url": "https://github.com/powsybl/powsybl-core/commit/67a7028995e12a5d52bd2ee6ac1497f72cb7c1f1", "message": "Create variable (code smell)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:08:11Z", "type": "commit"}, {"oid": "ce0bc21e2762a875e7da198684b2a46ddf48432a", "url": "https://github.com/powsybl/powsybl-core/commit/ce0bc21e2762a875e7da198684b2a46ddf48432a", "message": "BoundaryValues are calculated \"on the fly\" for dangling lines\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:08:11Z", "type": "commit"}, {"oid": "546abed9f8867221a330187b1604c0335694e1e0", "url": "https://github.com/powsybl/powsybl-core/commit/546abed9f8867221a330187b1604c0335694e1e0", "message": "Calculate boundary values \"on the fly\" for tie lines\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:10:54Z", "type": "commit"}, {"oid": "6fd02a2eec6443ed73531c3d84339aeed77a1468", "url": "https://github.com/powsybl/powsybl-core/commit/6fd02a2eec6443ed73531c3d84339aeed77a1468", "message": "Delete useless code\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:11:03Z", "type": "commit"}, {"oid": "c95faae9cb90958588d479690549bd7b5639ccb7", "url": "https://github.com/powsybl/powsybl-core/commit/c95faae9cb90958588d479690549bd7b5639ccb7", "message": "Refactor SV\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:11:16Z", "type": "commit"}, {"oid": "31f2c5d7b67cd5ed956af7c97d7b34fe3f405927", "url": "https://github.com/powsybl/powsybl-core/commit/31f2c5d7b67cd5ed956af7c97d7b34fe3f405927", "message": "Delete XnodeValuesComputation\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:11:28Z", "type": "commit"}, {"oid": "cf0088e4223669e460d3eba9fd5224a36734e48e", "url": "https://github.com/powsybl/powsybl-core/commit/cf0088e4223669e460d3eba9fd5224a36734e48e", "message": "Add a test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:11:28Z", "type": "commit"}, {"oid": "5206069453ba03b916a206b3cbb0ab707e932a5f", "url": "https://github.com/powsybl/powsybl-core/commit/5206069453ba03b916a206b3cbb0ab707e932a5f", "message": "Rename boundary point values of tieline in XIIDM 1.5\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T14:11:28Z", "type": "commit"}, {"oid": "8e39e6dface7a4ca3f8b78798abf45c6479521a2", "url": "https://github.com/powsybl/powsybl-core/commit/8e39e6dface7a4ca3f8b78798abf45c6479521a2", "message": "Fix AmplNetworkWriter implementation for TieLines\nExport AMPL exporter options\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>", "committedDate": "2020-11-18T14:11:28Z", "type": "commit"}, {"oid": "269814f441e45ea7caa703a9df164d392cc2b61a", "url": "https://github.com/powsybl/powsybl-core/commit/269814f441e45ea7caa703a9df164d392cc2b61a", "message": "Correction after rebasing\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T15:04:43Z", "type": "commit"}, {"oid": "269814f441e45ea7caa703a9df164d392cc2b61a", "url": "https://github.com/powsybl/powsybl-core/commit/269814f441e45ea7caa703a9df164d392cc2b61a", "message": "Correction after rebasing\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T15:04:43Z", "type": "forcePushed"}, {"oid": "b8330428d700faae4d9610f7c1cc1d29161c79ea", "url": "https://github.com/powsybl/powsybl-core/commit/b8330428d700faae4d9610f7c1cc1d29161c79ea", "message": "Rename BoundaryPoint as OtherSide\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-18T16:25:02Z", "type": "commit"}, {"oid": "bbdafe59b03454feb9823d0076dd7fd3c2580b45", "url": "https://github.com/powsybl/powsybl-core/commit/bbdafe59b03454feb9823d0076dd7fd3c2580b45", "message": "Reviewer's comment: creating otherSide objects in tieLine in XIIDM\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-19T10:07:30Z", "type": "commit"}, {"oid": "d91cd193df6cd71a8b2c787fec706fa2bedaf6bb", "url": "https://github.com/powsybl/powsybl-core/commit/d91cd193df6cd71a8b2c787fec706fa2bedaf6bb", "message": "Reviewer's comment: variable name and intermediary methods\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-19T10:29:54Z", "type": "commit"}, {"oid": "7ce13df8710e3c2d1f694c3c6b8da0bea7aeefe3", "url": "https://github.com/powsybl/powsybl-core/commit/7ce13df8710e3c2d1f694c3c6b8da0bea7aeefe3", "message": "Reviewer's comment: other side's values are not serialized\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-19T10:45:11Z", "type": "commit"}, {"oid": "2f03317670ac300eef29c4235f2bf8dde684bd60", "url": "https://github.com/powsybl/powsybl-core/commit/2f03317670ac300eef29c4235f2bf8dde684bd60", "message": "Sonar: delete useless constants\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-19T12:31:54Z", "type": "commit"}, {"oid": "0058f9f60c26c53de9ba9ff09537051b25620583", "url": "https://github.com/powsybl/powsybl-core/commit/0058f9f60c26c53de9ba9ff09537051b25620583", "message": "Rename OtherSide as Boundary\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-19T12:39:32Z", "type": "commit"}, {"oid": "63d1e6e19b613759444c69de786f5f6d755b291e", "url": "https://github.com/powsybl/powsybl-core/commit/63d1e6e19b613759444c69de786f5f6d755b291e", "message": "Correct sign of xnodeP/Q\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-20T15:03:04Z", "type": "commit"}, {"oid": "0058f9f60c26c53de9ba9ff09537051b25620583", "url": "https://github.com/powsybl/powsybl-core/commit/0058f9f60c26c53de9ba9ff09537051b25620583", "message": "Rename OtherSide as Boundary\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-19T12:39:32Z", "type": "forcePushed"}, {"oid": "0bfb2ce834e54b80d002945e905138952a46d930", "url": "https://github.com/powsybl/powsybl-core/commit/0bfb2ce834e54b80d002945e905138952a46d930", "message": "Re-organize SV class.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>", "committedDate": "2020-11-23T11:16:08Z", "type": "commit"}, {"oid": "8362a4a4d12ad7d1f49ecba4f594e2af4cf49699", "url": "https://github.com/powsybl/powsybl-core/commit/8362a4a4d12ad7d1f49ecba4f594e2af4cf49699", "message": "Revert \"Correct sign of xnodeP/Q\"\n\nThis reverts commit 63d1e6e\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-11-23T11:32:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTM3NTcyNg==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r529375726", "bodyText": "maybe use rho instead of ratio", "author": "marqueslanauja", "createdAt": "2020-11-24T09:53:12Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/util/SV.java", "diffHunk": "@@ -72,28 +84,49 @@ public double getA() {\n         return a;\n     }\n \n-    public SV otherSide(double r, double x, double g, double b, double ratio) {\n-        Complex z = new Complex(r, x); // z=r+jx\n-        Complex y = new Complex(g, b); // y=g+jb\n-        Complex s1 = new Complex(p, q); // s1=p1+jq1\n-        Complex u1 = ComplexUtils.polar2Complex(u, Math.toRadians(a));\n-        Complex v1 = u1.divide(Math.sqrt(3f)); // v1=u1/sqrt(3)\n-\n+    private Complex computeU2(Complex y1, Complex y2, Complex z, double ratio) {\n         Complex v1p = v1.multiply(ratio); // v1p=v1*rho\n-        Complex i1 = s1.divide(v1.multiply(3)).conjugate(); // i1=conj(s1/(3*v1))\n         Complex i1p = i1.divide(ratio); // i1p=i1/rho", "originalCommit": "0bfb2ce834e54b80d002945e905138952a46d930", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTM4MjU3OQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1488#discussion_r529382579", "bodyText": "Maybe change ratio by rho in all the class", "author": "marqueslanauja", "createdAt": "2020-11-24T09:58:30Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/util/SV.java", "diffHunk": "@@ -72,28 +84,49 @@ public double getA() {\n         return a;\n     }\n \n-    public SV otherSide(double r, double x, double g, double b, double ratio) {\n-        Complex z = new Complex(r, x); // z=r+jx\n-        Complex y = new Complex(g, b); // y=g+jb\n-        Complex s1 = new Complex(p, q); // s1=p1+jq1\n-        Complex u1 = ComplexUtils.polar2Complex(u, Math.toRadians(a));\n-        Complex v1 = u1.divide(Math.sqrt(3f)); // v1=u1/sqrt(3)\n-\n+    private Complex computeU2(Complex y1, Complex y2, Complex z, double ratio) {\n         Complex v1p = v1.multiply(ratio); // v1p=v1*rho\n-        Complex i1 = s1.divide(v1.multiply(3)).conjugate(); // i1=conj(s1/(3*v1))\n         Complex i1p = i1.divide(ratio); // i1p=i1/rho\n-        Complex i2 = i1p.subtract(y.multiply(v1p)); // i2=i1p-y*v1p\n-        Complex v2 = v1p.subtract(z.multiply(i2)); // v2=v1p-z*i2\n+\n+        Complex i2p = i1p.subtract(y1.multiply(v1p)); // i2p=i1p-y1*v1p\n+        Complex v2 = v1p.subtract(z.multiply(i2p)); // v2p=v1p-z*i2\n+        Complex i2 = i2p.subtract(y2.multiply(v2)); // i2=i2p-y2*v2\n         Complex s2 = v2.multiply(3).multiply(i2.conjugate()); // s2=3*v2*conj(i2)\n+        return v2.multiply(Math.sqrt(3f));\n+    }\n \n-        Complex u2 = v2.multiply(Math.sqrt(3f));\n+    private Complex computeU2(Complex y, Complex z, double ratio) {\n+        return computeU2(y, new Complex(0, 0), z, ratio);\n+    }", "originalCommit": "0bfb2ce834e54b80d002945e905138952a46d930", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0004823226e62138f081fa21d3e0fc8b5ab159e7", "url": "https://github.com/powsybl/powsybl-core/commit/0004823226e62138f081fa21d3e0fc8b5ab159e7", "message": "Rename after review.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>", "committedDate": "2020-11-24T13:30:01Z", "type": "commit"}, {"oid": "756b7e46c4fdc3940d49d3cdd7fe5fab242f80c9", "url": "https://github.com/powsybl/powsybl-core/commit/756b7e46c4fdc3940d49d3cdd7fe5fab242f80c9", "message": "Merge branch 'evolution_xiidm/1.5' into boundary_point\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\n# Conflicts:\n#\tiidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/DanglingLineImpl.java\n#\tiidm/iidm-xml-converter/src/main/resources/xsd/iidm_V1_5.xsd\n#\tiidm/iidm-xml-converter/src/test/resources/V1_5/danglingLine.xml\n#\tiidm/iidm-xml-converter/src/test/resources/V1_5/tieline.xml\n#\tiidm/iidm-xml-converter/src/test/resources/V1_5/tielineWithAliases.xml", "committedDate": "2020-12-01T09:26:20Z", "type": "commit"}, {"oid": "3aa4f76bf6af97e649e560c75fd6b30df73a52be", "url": "https://github.com/powsybl/powsybl-core/commit/3aa4f76bf6af97e649e560c75fd6b30df73a52be", "message": "Corrections tests following merge\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\n# Conflicts:\n#\tiidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/DanglingLineImpl.java\n#\tiidm/iidm-xml-converter/src/main/resources/xsd/iidm_V1_5.xsd\n#\tiidm/iidm-xml-converter/src/test/resources/V1_5/danglingLine.xml\n#\tiidm/iidm-xml-converter/src/test/resources/V1_5/tieline.xml\n#\tiidm/iidm-xml-converter/src/test/resources/V1_5/tielineWithAliases.xml", "committedDate": "2020-12-01T09:49:09Z", "type": "commit"}, {"oid": "3aa4f76bf6af97e649e560c75fd6b30df73a52be", "url": "https://github.com/powsybl/powsybl-core/commit/3aa4f76bf6af97e649e560c75fd6b30df73a52be", "message": "Corrections tests following merge\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\n# Conflicts:\n#\tiidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/DanglingLineImpl.java\n#\tiidm/iidm-xml-converter/src/main/resources/xsd/iidm_V1_5.xsd\n#\tiidm/iidm-xml-converter/src/test/resources/V1_5/danglingLine.xml\n#\tiidm/iidm-xml-converter/src/test/resources/V1_5/tieline.xml\n#\tiidm/iidm-xml-converter/src/test/resources/V1_5/tielineWithAliases.xml", "committedDate": "2020-12-01T09:49:09Z", "type": "forcePushed"}]}