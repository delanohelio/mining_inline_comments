{"pr_number": 3471, "pr_title": "Clean-ups following \"CAMEL-14361: Update to avoid reflection in creating http method\"", "pr_createdAt": "2020-01-09T19:01:45Z", "pr_url": "https://github.com/apache/camel/pull/3471", "timeline": [{"oid": "ee544424659883f13aaf5f2dad782c27b3662a36", "url": "https://github.com/apache/camel/commit/ee544424659883f13aaf5f2dad782c27b3662a36", "message": "CAMEL-14361: Update to avoid reflection in creating http method\n\nRemove unnecessary wrapping of IllegalArgumentException in RuntimeException.", "committedDate": "2020-01-09T18:56:56Z", "type": "commit"}, {"oid": "6d573054ddf6b1b539a0323171b1f01d87d2cf15", "url": "https://github.com/apache/camel/commit/6d573054ddf6b1b539a0323171b1f01d87d2cf15", "message": "CAMEL-14361: Update to avoid reflection in creating http method\n\nRemove unused clazz field.", "committedDate": "2020-01-09T18:59:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDkxMzExMg==", "url": "https://github.com/apache/camel/pull/3471#discussion_r364913112", "bodyText": "Perhaps?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        throw new RuntimeException(\"no such method \" + this);\n          \n          \n            \n                        throw new IllegalArgumentException(\"Unupported HTTP verb: \" + this);", "author": "zregvart", "createdAt": "2020-01-09T19:11:58Z", "path": "components/camel-http/src/main/java/org/apache/camel/component/http/HttpMethods.java", "diffHunk": "@@ -41,38 +41,32 @@\n     OPTIONS(HttpOptions.class),\n     TRACE(HttpTrace.class);\n \n-    final Class<? extends HttpRequestBase> clazz;\n     final boolean entity;\n \n     HttpMethods(Class<? extends HttpRequestBase> clazz) {\n-        this.clazz = clazz;\n         entity = HttpEntityEnclosingRequestBase.class.isAssignableFrom(clazz);\n     }\n \n     public HttpRequestBase createMethod(final String url) {\n-        try {\n-            switch (this) {\n-            case GET:\n-                return new HttpGet(url);\n-            case PATCH:\n-                return new HttpPatch(url);\n-            case POST:\n-                return new HttpPost(url);\n-            case PUT:\n-                return new HttpPut(url);\n-            case DELETE:\n-                return new HttpDelete(url);\n-            case HEAD:\n-                return new HttpHead(url);\n-            case OPTIONS:\n-                return new HttpOptions(url);\n-            case TRACE:\n-                return new HttpTrace(url);\n-            default:\n-                throw new RuntimeException(\"no such method \" + this);\n-            }\n-        } catch (IllegalArgumentException e) {\n-            throw new RuntimeException(e);\n+        switch (this) {\n+        case GET:\n+            return new HttpGet(url);\n+        case PATCH:\n+            return new HttpPatch(url);\n+        case POST:\n+            return new HttpPost(url);\n+        case PUT:\n+            return new HttpPut(url);\n+        case DELETE:\n+            return new HttpDelete(url);\n+        case HEAD:\n+            return new HttpHead(url);\n+        case OPTIONS:\n+            return new HttpOptions(url);\n+        case TRACE:\n+            return new HttpTrace(url);\n+        default:\n+            throw new RuntimeException(\"no such method \" + this);", "originalCommit": "6d573054ddf6b1b539a0323171b1f01d87d2cf15", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDkzOTc3Mg==", "url": "https://github.com/apache/camel/pull/3471#discussion_r364939772", "bodyText": "Yes, that was another part of ceffe62 I considered changing.\nBut the exception will only be thrown if another constant is added to the HttpMethods enum and no matching case is added to this switch (or am I missing something?). I was not sure which exception class to use. My first thought was llegalArgumentException as well, but as the switch is on this and not on an argument of the createMethod method so using an llegalArgumentException seemed misleading. An exception signalling that a bug (missing implementation) was encountered seems more appropriate (like GroovyBugError used by Groovy).", "author": "PascalSchumacher", "createdAt": "2020-01-09T20:14:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDkxMzExMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE3NzM1Mg==", "url": "https://github.com/apache/camel/pull/3471#discussion_r365177352", "bodyText": "Yeah, I'm nitpicking, there's little chance for that exception to even occur. IllegalArgumentException or IllegalStateException are my go-to exceptions in lieu of RuntimeException. Not that important, only of you think it merits the change...", "author": "zregvart", "createdAt": "2020-01-10T10:50:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDkxMzExMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTI3ODcxOQ==", "url": "https://github.com/apache/camel/pull/3471#discussion_r365278719", "bodyText": "Replacing the swith with inheritance (see: #3475) would allow us to get rid of the exception.", "author": "PascalSchumacher", "createdAt": "2020-01-10T15:09:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDkxMzExMg=="}], "type": "inlineReview"}]}