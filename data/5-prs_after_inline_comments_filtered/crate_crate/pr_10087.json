{"pr_number": 10087, "pr_title": "Re-enable IAM Roles for s3 repositories (bp #10071)", "pr_createdAt": "2020-06-16T21:45:13Z", "pr_url": "https://github.com/crate/crate/pull/10087", "timeline": [{"oid": "f9bb70a1021eed6ae17c1ffcce0edaf343f07c48", "url": "https://github.com/crate/crate/commit/f9bb70a1021eed6ae17c1ffcce0edaf343f07c48", "message": "Adapt iam roles fix to 4.1 structure", "committedDate": "2020-06-17T09:24:20Z", "type": "forcePushed"}, {"oid": "b6d84f8ae0d72f1c24e1a54d9b1a4bbb1b5e8604", "url": "https://github.com/crate/crate/commit/b6d84f8ae0d72f1c24e1a54d9b1a4bbb1b5e8604", "message": "Adapt iam roles fix to 4.1 structure", "committedDate": "2020-06-17T09:32:24Z", "type": "forcePushed"}, {"oid": "6388257c70be0d83a4963732a711579ede61c04c", "url": "https://github.com/crate/crate/commit/6388257c70be0d83a4963732a711579ede61c04c", "message": "Adapt iam roles fix to 4.1 structure", "committedDate": "2020-06-17T09:37:34Z", "type": "forcePushed"}, {"oid": "8e93c8a524055f4c9651bf3adc5d00a74bd43c05", "url": "https://github.com/crate/crate/commit/8e93c8a524055f4c9651bf3adc5d00a74bd43c05", "message": "Fix exception handling", "committedDate": "2020-06-17T12:42:05Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUyNjI1MA==", "url": "https://github.com/crate/crate/pull/10087#discussion_r441526250", "bodyText": "I use a ElasticsearchException instead of a CrateException, because in 4.1 the crate packages are not available.", "author": "mkleen", "createdAt": "2020-06-17T13:01:32Z", "path": "es/es-server/src/main/java/org/elasticsearch/repositories/blobstore/InvalidArgumentException.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed to Crate under one or more contributor license agreements.\n+ * See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.  Crate licenses this file\n+ * to you under the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.  You may\n+ * obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n+ * implied.  See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ *\n+ * However, if you have executed another commercial license agreement\n+ * with Crate these terms will supersede the license and you may use the\n+ * software solely pursuant to the terms of the relevant commercial\n+ * agreement.\n+ */\n+\n+package org.elasticsearch.repositories.blobstore;\n+\n+import org.elasticsearch.ElasticsearchException;\n+\n+public class InvalidArgumentException extends ElasticsearchException {", "originalCommit": "8e93c8a524055f4c9651bf3adc5d00a74bd43c05", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUyNjYzOQ==", "url": "https://github.com/crate/crate/pull/10087#discussion_r441526639", "bodyText": "This will result correctly in a 4000 error as it does in master (now).", "author": "mkleen", "createdAt": "2020-06-17T13:02:07Z", "path": "sql/src/main/java/io/crate/exceptions/SQLExceptions.java", "diffHunk": "@@ -225,6 +226,9 @@ private static Throwable esToCrateException(Throwable unwrappedError) {\n         } else if (unwrappedError instanceof SnapshotCreationException) {\n             SnapshotCreationException creationException = (SnapshotCreationException) unwrappedError;\n             return new SnapshotAlreadyExistsException(creationException.getRepositoryName(), creationException.getSnapshotName());\n+        } else if (unwrappedError instanceof InvalidArgumentException) {\n+            var invalidArgument = (InvalidArgumentException) unwrappedError;\n+            return new SQLParseException(invalidArgument.getMessage());", "originalCommit": "8e93c8a524055f4c9651bf3adc5d00a74bd43c05", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "659d2c89fd06d5eefdaafa32f0320985d603cb55", "url": "https://github.com/crate/crate/commit/659d2c89fd06d5eefdaafa32f0320985d603cb55", "message": "Add documentation for iam roles\n\n(cherry picked from commit 1a72fd9cc15a3279cbe45c1f992eeea57bc4b485)", "committedDate": "2020-06-17T13:23:52Z", "type": "forcePushed"}, {"oid": "64059bd8b68b98f2b44465081e70b586aa98a901", "url": "https://github.com/crate/crate/commit/64059bd8b68b98f2b44465081e70b586aa98a901", "message": "Re-enable IAM Roles for s3 repositories\n\n(cherry picked from commit 5a668e15a34c5207d9dfa7a549ff38c32aa20511)", "committedDate": "2020-06-17T14:16:56Z", "type": "commit"}, {"oid": "03100c7cc6cf0cf2239ab606e91c55fde0f576cf", "url": "https://github.com/crate/crate/commit/03100c7cc6cf0cf2239ab606e91c55fde0f576cf", "message": "Add documentation for iam roles\n\n(cherry picked from commit 1a72fd9cc15a3279cbe45c1f992eeea57bc4b485)", "committedDate": "2020-06-17T14:16:56Z", "type": "commit"}, {"oid": "03100c7cc6cf0cf2239ab606e91c55fde0f576cf", "url": "https://github.com/crate/crate/commit/03100c7cc6cf0cf2239ab606e91c55fde0f576cf", "message": "Add documentation for iam roles\n\n(cherry picked from commit 1a72fd9cc15a3279cbe45c1f992eeea57bc4b485)", "committedDate": "2020-06-17T14:16:56Z", "type": "forcePushed"}]}