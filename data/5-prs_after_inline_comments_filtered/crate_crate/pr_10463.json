{"pr_number": 10463, "pr_title": "Map AmbiguousColumnException to PG 42702 ambiguous_column error code", "pr_createdAt": "2020-08-31T09:49:25Z", "pr_url": "https://github.com/crate/crate/pull/10463", "timeline": [{"oid": "ae5ef8eb184ac9020ff06be00b4d1354598f37a5", "url": "https://github.com/crate/crate/commit/ae5ef8eb184ac9020ff06be00b4d1354598f37a5", "message": "Map AmbiguousColumnException to PG 42702 ambiguous_column error code\n\nThis changes the error code for the psql protocol when a column\n reference is ambiguous from `XX000` `internal_error` to `42702`\n`ambiguous_column`.", "committedDate": "2020-08-31T10:08:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4MDc3Nw==", "url": "https://github.com/crate/crate/pull/10463#discussion_r480080777", "bodyText": "Could we maybe come up with a unit test for this? I think adding integration tests for error code mapping will slow down the test suite to much for what is being tested.", "author": "mfussenegger", "createdAt": "2020-08-31T11:56:19Z", "path": "server/src/test/java/io/crate/integrationtests/JoinIntegrationTest.java", "diffHunk": "@@ -1108,4 +1110,16 @@ public void test_many_table_join_with_filter_pushdown() throws Exception {\n         execute(stmt);\n         assertThat(response.rowCount(), is(0L));\n     }\n+\n+    @Test\n+    public void test_ambiguous_columns() {", "originalCommit": "ae5ef8eb184ac9020ff06be00b4d1354598f37a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA5NDUxMA==", "url": "https://github.com/crate/crate/pull/10463#discussion_r480094510", "bodyText": "There are a couple of unit tests that assert for AmbiguousColumnException\nMaybe we could extend the assertion there to also verify the mapped errors.\nWe could have some kind of\nassertThrows(... , errors(orginalExcpetion, mappedPsqlError))", "author": "mfussenegger", "createdAt": "2020-08-31T12:24:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4MDc3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA5ODY4OA==", "url": "https://github.com/crate/crate/pull/10463#discussion_r480098688", "bodyText": "Or alternatively we could write a dedicated unit test for the mapping logic. That way we wouldn't clutter all the other unit tests with additional mapping information and we'd still have the integration level tests where we confirm both http and postgresql error codes.", "author": "mfussenegger", "createdAt": "2020-08-31T12:32:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4MDc3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA5OTQ5NA==", "url": "https://github.com/crate/crate/pull/10463#discussion_r480099494", "bodyText": "Ok, thanks for feedback. I will see what I can do.", "author": "mkleen", "createdAt": "2020-08-31T12:34:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4MDc3Nw=="}], "type": "inlineReview"}, {"oid": "e128289e6fbc1ef26c6cd007f265bf5389b0f481", "url": "https://github.com/crate/crate/commit/e128289e6fbc1ef26c6cd007f265bf5389b0f481", "message": "Add error mapping unit test", "committedDate": "2020-08-31T14:10:17Z", "type": "forcePushed"}, {"oid": "13e9ac065e2a5d3e01722b7f8e3a7239c70b0f05", "url": "https://github.com/crate/crate/commit/13e9ac065e2a5d3e01722b7f8e3a7239c70b0f05", "message": "Add error mapping unit test", "committedDate": "2020-08-31T14:11:23Z", "type": "forcePushed"}, {"oid": "018e6397fd64818c98fab7cbb78ad00fbf027b7f", "url": "https://github.com/crate/crate/commit/018e6397fd64818c98fab7cbb78ad00fbf027b7f", "message": "Add error mapping unit test", "committedDate": "2020-08-31T14:14:27Z", "type": "forcePushed"}, {"oid": "0a8ff2a1bfa62d1cb8a2226026ad0e54fe148c0d", "url": "https://github.com/crate/crate/commit/0a8ff2a1bfa62d1cb8a2226026ad0e54fe148c0d", "message": "Add error mapping unit test", "committedDate": "2020-08-31T14:15:09Z", "type": "forcePushed"}, {"oid": "02d9ec586aa17a1eaf2a62fc1cba2cb7fbd96b39", "url": "https://github.com/crate/crate/commit/02d9ec586aa17a1eaf2a62fc1cba2cb7fbd96b39", "message": "Add error mapping unit test", "committedDate": "2020-08-31T14:19:41Z", "type": "forcePushed"}, {"oid": "f3c24b3ac5e311f0c6ab781473483276ebe42865", "url": "https://github.com/crate/crate/commit/f3c24b3ac5e311f0c6ab781473483276ebe42865", "message": "Add error mapping unit test", "committedDate": "2020-08-31T14:22:51Z", "type": "forcePushed"}, {"oid": "c09d1b26e9293ca45529a352a31f1d5851c014cf", "url": "https://github.com/crate/crate/commit/c09d1b26e9293ca45529a352a31f1d5851c014cf", "message": "Add error mapping unit test", "committedDate": "2020-08-31T14:31:01Z", "type": "forcePushed"}, {"oid": "c68426fd93bfa15ca7e35434a9b184ce956af79d", "url": "https://github.com/crate/crate/commit/c68426fd93bfa15ca7e35434a9b184ce956af79d", "message": "Map AmbiguousColumnException to PG 42702 ambiguous_column error code\n\nThis changes the error code for the psql protocol when a column\n reference is ambiguous from `XX000` `internal_error` to `42702`\n`ambiguous_column`.", "committedDate": "2020-08-31T14:35:58Z", "type": "forcePushed"}, {"oid": "08e3bc238c1b7e8b2314bd71068c32c446d76d42", "url": "https://github.com/crate/crate/commit/08e3bc238c1b7e8b2314bd71068c32c446d76d42", "message": "Map AmbiguousColumnException to PG 42702 ambiguous_column error code\n\nThis changes the error code for the psql protocol when a column\n reference is ambiguous from `XX000` `internal_error` to `42702`\n`ambiguous_column`.", "committedDate": "2020-08-31T15:29:24Z", "type": "commit"}, {"oid": "08e3bc238c1b7e8b2314bd71068c32c446d76d42", "url": "https://github.com/crate/crate/commit/08e3bc238c1b7e8b2314bd71068c32c446d76d42", "message": "Map AmbiguousColumnException to PG 42702 ambiguous_column error code\n\nThis changes the error code for the psql protocol when a column\n reference is ambiguous from `XX000` `internal_error` to `42702`\n`ambiguous_column`.", "committedDate": "2020-08-31T15:29:24Z", "type": "forcePushed"}]}