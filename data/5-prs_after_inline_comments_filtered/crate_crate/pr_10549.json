{"pr_number": 10549, "pr_title": "Deprecate the overhead circuit breaker setting", "pr_createdAt": "2020-09-16T14:24:03Z", "pr_url": "https://github.com/crate/crate/pull/10549", "timeline": [{"oid": "34ea50862fc5c3ec7eb4cd310ef46b64f019485e", "url": "https://github.com/crate/crate/commit/34ea50862fc5c3ec7eb4cd310ef46b64f019485e", "message": "Deprecate the overhead circuit breaker setting\n\nThis deprecated the settings and internally removes any usages.\nThe only circuit breaker where the default diverged from 1.0 was the\nquery breaker and the already unused fielddata breaker.\n\nThe usefulness of the setting was questionable. It provided another\nknob to tune the circuit breaker behavior, but it is somewhat redundant\nbecause tuning the limit had more or less the same outcome.\n\n    newUsed * overheadConstant > memoryBytesLimit\n\n    =\n\n    newUsed > memoryBytesLimit / overheadConstant\n\nIt made the implementations more complicated and also made it harder to\nreason about how the memory accounting works. Acting a bit like a smoke\nbomb.\n\nThere were also inconsistencies in its use. In one place it was applied\nto the *delta*, in other cases it was applied to the *total*.", "committedDate": "2020-09-16T15:02:26Z", "type": "forcePushed"}, {"oid": "9f35017ea5f92a59d8d85d54cecdd6d2fba4295b", "url": "https://github.com/crate/crate/commit/9f35017ea5f92a59d8d85d54cecdd6d2fba4295b", "message": "Deprecate the overhead circuit breaker setting\n\nThis deprecated the settings and internally removes any usages.\nThe only circuit breaker where the default diverged from 1.0 was the\nquery breaker and the already unused fielddata breaker.\n\nThe usefulness of the setting was questionable. It provided another\nknob to tune the circuit breaker behavior, but it is somewhat redundant\nbecause tuning the limit had more or less the same outcome.\n\n    newUsed * overheadConstant > memoryBytesLimit\n\n    =\n\n    newUsed > memoryBytesLimit / overheadConstant\n\nIt made the implementations more complicated and also made it harder to\nreason about how the memory accounting works. Acting a bit like a smoke\nbomb.\n\nThere were also inconsistencies in its use. In one place it was applied\nto the *delta*, in other cases it was applied to the *total*.", "committedDate": "2020-09-16T15:26:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDEwNzQ4Ng==", "url": "https://github.com/crate/crate/pull/10549#discussion_r490107486", "bodyText": "maybe also add the @Deprecated annotation?", "author": "seut", "createdAt": "2020-09-17T09:35:18Z", "path": "server/src/main/java/org/elasticsearch/indices/breaker/CircuitBreakerStats.java", "diffHunk": "@@ -32,6 +32,8 @@\n     private final long limit;\n     private final long used;\n     private final long trippedCount;\n+\n+    // kept around for BWC of JMX metrics", "originalCommit": "9f35017ea5f92a59d8d85d54cecdd6d2fba4295b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3983755334baed9dda0007fede27e8f7e876b9c7", "url": "https://github.com/crate/crate/commit/3983755334baed9dda0007fede27e8f7e876b9c7", "message": "Remove name argument from ChildMemoryCircuitBreaker\n\nThe name is also present in the `BreakerSettings`", "committedDate": "2020-09-18T12:20:39Z", "type": "commit"}, {"oid": "cb6aacdc091808036dad5673f14c374caeaf3bc2", "url": "https://github.com/crate/crate/commit/cb6aacdc091808036dad5673f14c374caeaf3bc2", "message": "Deprecate the overhead circuit breaker setting\n\nThis deprecated the settings and internally removes any usages.\nThe only circuit breaker where the default diverged from 1.0 was the\nquery breaker and the already unused fielddata breaker.\n\nThe usefulness of the setting was questionable. It provided another\nknob to tune the circuit breaker behavior, but it is somewhat redundant\nbecause tuning the limit had more or less the same outcome.\n\n    newUsed * overheadConstant > memoryBytesLimit\n\n    =\n\n    newUsed > memoryBytesLimit / overheadConstant\n\nIt made the implementations more complicated and also made it harder to\nreason about how the memory accounting works. Acting a bit like a smoke\nbomb.\n\nThere were also inconsistencies in its use. In one place it was applied\nto the *delta*, in other cases it was applied to the *total*.", "committedDate": "2020-09-18T12:23:30Z", "type": "commit"}, {"oid": "cb6aacdc091808036dad5673f14c374caeaf3bc2", "url": "https://github.com/crate/crate/commit/cb6aacdc091808036dad5673f14c374caeaf3bc2", "message": "Deprecate the overhead circuit breaker setting\n\nThis deprecated the settings and internally removes any usages.\nThe only circuit breaker where the default diverged from 1.0 was the\nquery breaker and the already unused fielddata breaker.\n\nThe usefulness of the setting was questionable. It provided another\nknob to tune the circuit breaker behavior, but it is somewhat redundant\nbecause tuning the limit had more or less the same outcome.\n\n    newUsed * overheadConstant > memoryBytesLimit\n\n    =\n\n    newUsed > memoryBytesLimit / overheadConstant\n\nIt made the implementations more complicated and also made it harder to\nreason about how the memory accounting works. Acting a bit like a smoke\nbomb.\n\nThere were also inconsistencies in its use. In one place it was applied\nto the *delta*, in other cases it was applied to the *total*.", "committedDate": "2020-09-18T12:23:30Z", "type": "forcePushed"}]}