{"pr_number": 2839, "pr_title": "Deprecate ambiguous constructors", "pr_createdAt": "2020-06-05T14:44:32Z", "pr_url": "https://github.com/testcontainers/testcontainers-java/pull/2839", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk4OTMxOQ==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r435989319", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             */\n          \n          \n            \n            public class FixedHostPortGenericContainer<SELF extends FixedHostPortGenericContainer<SELF>> extends GenericContainer<SELF> {\n          \n          \n            \n                @Deprecated\n          \n          \n            \n             */\n          \n          \n            \n            @Deprecated\n          \n          \n            \n            public class FixedHostPortGenericContainer<SELF extends FixedHostPortGenericContainer<SELF>> extends GenericContainer<SELF> {\n          \n      \n    \n    \n  \n\n\ud83d\ude02 \ud83d\ude02 \ud83d\ude02", "author": "bsideup", "createdAt": "2020-06-05T15:15:48Z", "path": "core/src/main/java/org/testcontainers/containers/FixedHostPortGenericContainer.java", "diffHunk": "@@ -12,6 +12,7 @@\n  * not available - which could manifest as flaky or unstable tests.</p>\n  */\n public class FixedHostPortGenericContainer<SELF extends FixedHostPortGenericContainer<SELF>> extends GenericContainer<SELF> {\n+    @Deprecated", "originalCommit": "b60d19c8eefa330fe5549513cf843fc11ea7481d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjAwMTU1MA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r436001550", "bodyText": "Deprecated without replacement - because it's evil.", "author": "rnorth", "createdAt": "2020-06-05T15:35:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk4OTMxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk5MDA4Mg==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r435990082", "bodyText": "what about GenericContainer(Future)? Since it can be replaced with new GenericContainer(new RemoteDockerImage(future))", "author": "bsideup", "createdAt": "2020-06-05T15:17:03Z", "path": "core/src/main/java/org/testcontainers/containers/GenericContainer.java", "diffHunk": "@@ -241,10 +242,16 @@\n     @Setter(AccessLevel.NONE)\n     private boolean shouldBeReused = false;\n \n+    @Deprecated\n     public GenericContainer() {\n         this(TestcontainersConfiguration.getInstance().getTinyImage());\n     }\n \n+    public GenericContainer(DockerImageName dockerImageName) {\n+        this.image = new RemoteDockerImage(dockerImageName);\n+    }\n+\n+    @Deprecated", "originalCommit": "b60d19c8eefa330fe5549513cf843fc11ea7481d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjEzNzM1Nw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r436137357", "bodyText": "Ooh, interesting suggestion - I'll explore that.", "author": "rnorth", "createdAt": "2020-06-05T19:59:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk5MDA4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA1ODA1Ng==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449058056", "bodyText": "I've not done this yet.", "author": "rnorth", "createdAt": "2020-07-02T14:50:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk5MDA4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ2MDk4Ng==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449460986", "bodyText": "I've had a quick try, but I'm not sure about this.\nThis example from existing code:\nnew GenericContainer(new ImageFromDockerfile() ...\n\nwould become\nnew GenericContainer(new RemoteDockerImage(new ImageFromDockerfile() ...\n\nwhich I think is quite ugly - it's really not a 'remote docker image', so naming-wise it's a bit of a stretch.\nI wonder if, really, the way to make this work would be to rename RemoteDockerImage to FutureDockerImageName, which more accurately reflects what it's used for. So the example would become:\nnew GenericContainer(new FutureDockerImageName(new ImageFromDockerfile() ...\n\nWe'd of course keep RemoteDockerImage around, deprecated, as no more than an alias to FutureDockerImageName.\nTwo problems I see with this that I don't think we can magic away. I think I could live with these:\n\nthe three levels of constructors involved are a bit clunky, but it's not a big deal\nit's such as shame that type erasure prevents us from overloading the GenericContainer(Future<String>) constructor, because otherwise FutureDockerImageName could just be Future<DockerImageName> \ud83d\ude02  \ud83d\ude2d", "author": "rnorth", "createdAt": "2020-07-03T08:48:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk5MDA4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ2NTUzMQ==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449465531", "bodyText": "Yeah, I agree that \"Remote\" is misleading here.\nBut the example you provided made me think whether we should even wrap ImageFromDockerfile with RemoteDockerImage, since it is definitely local, does not need an auth resolve, etc etc...\nwhat if we extract a common interface from RemoteDockerImage and make ImageFromDockerfile implement it?", "author": "bsideup", "createdAt": "2020-07-03T08:57:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk5MDA4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4MTc3Mw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449481773", "bodyText": "With the interface being DockerImage?", "author": "kiview", "createdAt": "2020-07-03T09:29:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk5MDA4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU0OTc1OQ==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449549759", "bodyText": "As discussed on Slack, we'll defer this to a separate PR.\nIt feels like more extensive and complicated changes are needed to refactor the Remote/Future images code, and I feel it would be sensible to not add that complexity on top of this, already massive, PR.", "author": "rnorth", "createdAt": "2020-07-03T12:08:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk5MDA4Mg=="}], "type": "inlineReview"}, {"oid": "68ee3bcc5e0a5b417139159487687c8bdadd1b9e", "url": "https://github.com/testcontainers/testcontainers-java/commit/68ee3bcc5e0a5b417139159487687c8bdadd1b9e", "message": "WIP", "committedDate": "2020-06-25T13:04:35Z", "type": "commit"}, {"oid": "68ee3bcc5e0a5b417139159487687c8bdadd1b9e", "url": "https://github.com/testcontainers/testcontainers-java/commit/68ee3bcc5e0a5b417139159487687c8bdadd1b9e", "message": "WIP", "committedDate": "2020-06-25T13:04:35Z", "type": "forcePushed"}, {"oid": "46c7e1b8d6f16e68800681f1dc08694139bd4cf5", "url": "https://github.com/testcontainers/testcontainers-java/commit/46c7e1b8d6f16e68800681f1dc08694139bd4cf5", "message": "WIP", "committedDate": "2020-06-25T13:18:30Z", "type": "commit"}, {"oid": "054b637698318f587a4c41f34e81149d2ae71cca", "url": "https://github.com/testcontainers/testcontainers-java/commit/054b637698318f587a4c41f34e81149d2ae71cca", "message": "WIP", "committedDate": "2020-06-25T18:32:21Z", "type": "commit"}, {"oid": "196f1a9da93bd8ae36d36550d549c90fc5a6024e", "url": "https://github.com/testcontainers/testcontainers-java/commit/196f1a9da93bd8ae36d36550d549c90fc5a6024e", "message": "WIP", "committedDate": "2020-06-29T18:16:41Z", "type": "commit"}, {"oid": "f3fe8078ac4500d09dfa706d2a1c692358bbd6d1", "url": "https://github.com/testcontainers/testcontainers-java/commit/f3fe8078ac4500d09dfa706d2a1c692358bbd6d1", "message": "Tidy up test image references", "committedDate": "2020-07-02T14:04:43Z", "type": "commit"}, {"oid": "c523b388c9fa4e3e2d6c65e9126dbb4f9c10b7b9", "url": "https://github.com/testcontainers/testcontainers-java/commit/c523b388c9fa4e3e2d6c65e9126dbb4f9c10b7b9", "message": "Merge remote-tracking branch 'origin/master' into deprecate-ambiguous-constructors\n\n# Conflicts:\n#\tcore/src/test/java/org/testcontainers/images/RemoteDockerImageTest.java\n#\tmodules/kafka/src/main/java/org/testcontainers/containers/KafkaContainer.java\n#\tmodules/kafka/src/test/java/org/testcontainers/containers/KafkaContainerTest.java\n#\tmodules/pulsar/src/main/java/org/testcontainers/containers/PulsarContainer.java\n#\tmodules/selenium/src/test/java/org/testcontainers/junit/ChromeRecordingWebDriverContainerTest.java", "committedDate": "2020-07-02T14:31:17Z", "type": "commit"}, {"oid": "296f9f7a90a03b173fa24a1b2a57cd973d80b995", "url": "https://github.com/testcontainers/testcontainers-java/commit/296f9f7a90a03b173fa24a1b2a57cd973d80b995", "message": "Update docs re contrainer creation and specifying versions", "committedDate": "2020-07-02T14:31:37Z", "type": "commit"}, {"oid": "aa94289f1b3d69548a39c818329e7cb368d1754f", "url": "https://github.com/testcontainers/testcontainers-java/commit/aa94289f1b3d69548a39c818329e7cb368d1754f", "message": "Update Javadocs with deprecation warnings.", "committedDate": "2020-07-02T14:49:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTEzMDE1MA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449130150", "bodyText": "I always get a strange feeling when toString() is used outside of a context of e.g. logging or being a human-readable presentation.", "author": "kiview", "createdAt": "2020-07-02T16:19:49Z", "path": "core/src/main/java/org/testcontainers/DockerClientFactory.java", "diffHunk": "@@ -55,7 +55,7 @@\n             TESTCONTAINERS_SESSION_ID_LABEL, SESSION_ID\n     );\n \n-    private static final String TINY_IMAGE = TestcontainersConfiguration.getInstance().getTinyImage();\n+    private static final String TINY_IMAGE = TestcontainersConfiguration.getInstance().getTinyDockerImageName().toString();", "originalCommit": "aa94289f1b3d69548a39c818329e7cb368d1754f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI2MTkwMQ==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449261901", "bodyText": "Yeah, TBH I had a slight feeling of discomfort writing it. I think I\u2019ll change it.", "author": "rnorth", "createdAt": "2020-07-02T20:56:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTEzMDE1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4MTA4Nw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449481087", "bodyText": "Oh, the new one is much better! I struggled to find a good method name, but I think canonicalName works pretty good :)", "author": "kiview", "createdAt": "2020-07-03T09:27:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTEzMDE1MA=="}], "type": "inlineReview"}, {"oid": "77aa41801afb757e7abc8a019afb4d10c332956f", "url": "https://github.com/testcontainers/testcontainers-java/commit/77aa41801afb757e7abc8a019afb4d10c332956f", "message": "Add `asCanonicalNameString()` method on `DockerImageName`", "committedDate": "2020-07-03T08:33:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4MzUzMA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449483530", "bodyText": "Just thinking... what if we keep the default constructors in \"utility\" classes like this one, where the users do not / should not care about the version used? it is a bit contradictory to the idea of this whole change, but I think a few exceptions can be made", "author": "bsideup", "createdAt": "2020-07-03T09:32:57Z", "path": "core/src/main/java/org/testcontainers/containers/SocatContainer.java", "diffHunk": "@@ -15,8 +16,16 @@\n \n     private final Map<Integer, String> targets = new HashMap<>();\n \n+    /**\n+     * @deprecated use {@link SocatContainer(DockerImageName)} instead\n+     */\n+    @Deprecated", "originalCommit": "77aa41801afb757e7abc8a019afb4d10c332956f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1MDc5Nw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449550797", "bodyText": "Yeah, I was thinking the same. If these had not been essentially in our public API it would have been a no-brainer.\nBut I'm fine with doing it. I'll move to deprecate these classes away from view (e.g. if we can eventually get them to be package-private then this becomes moot).", "author": "rnorth", "createdAt": "2020-07-03T12:10:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4MzUzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1ODEyNg==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449558126", "bodyText": "well, I would not hide/deprecate them, because they are helpful for building complex 3rd party containers", "author": "bsideup", "createdAt": "2020-07-03T12:29:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4MzUzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc1MTgwMw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449751803", "bodyText": "Reverted", "author": "rnorth", "createdAt": "2020-07-04T08:15:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4MzUzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4NDkyMg==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449484922", "bodyText": "Since the contract was always that RemoteDockerImage accepts a full image name, perhaps we can keep this and (String,String) constructors?\nOtherwise, it becomes a bit too long:\nnew GenericContainer(new RemoveDockerImage(new DockerImageName(\"missed-me:1\"))", "author": "bsideup", "createdAt": "2020-07-03T09:35:43Z", "path": "core/src/main/java/org/testcontainers/images/RemoteDockerImage.java", "diffHunk": "@@ -38,10 +38,16 @@\n     @ToString.Exclude\n     private DockerClient dockerClient = DockerClientFactory.lazyClient();\n \n+    public RemoteDockerImage(DockerImageName dockerImageName) {\n+        this.imageNameFuture = CompletableFuture.completedFuture(dockerImageName);\n+    }\n+\n+    @Deprecated", "originalCommit": "77aa41801afb757e7abc8a019afb4d10c332956f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1MDA2Mg==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449550062", "bodyText": "Will defer as per #2839 (comment)", "author": "rnorth", "createdAt": "2020-07-03T12:09:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4NDkyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4NjE1Nw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449486157", "bodyText": "Love it!\nMade me thinking whether we should even have a fully featured builder as well:\nDockerImageName.builder()\n    .registry(\"repo.example.com\")\n    .image(\"services/foo\")\n    .tag(\"123\")\n    .build();", "author": "bsideup", "createdAt": "2020-07-03T09:38:13Z", "path": "core/src/main/java/org/testcontainers/utility/DockerImageName.java", "diffHunk": "@@ -124,8 +144,13 @@ public String getRegistry() {\n         return registry;\n     }\n \n+    public DockerImageName withTag(final String newTag) {", "originalCommit": "77aa41801afb757e7abc8a019afb4d10c332956f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1Mzk0Ng==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449553946", "bodyText": "I feel like the halfway house of Dockerfilename.of(\"repo.example.com/services/foo\").withTag(\"123\") is probably enough - I'd like to try that first.", "author": "rnorth", "createdAt": "2020-07-03T12:18:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4NjE1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1NDIyNw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449554227", "bodyText": "FTR the builder idea is just an idea, don't need to be in this PR and can easily be a follow up :)", "author": "bsideup", "createdAt": "2020-07-03T12:19:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4NjE1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4NzgwMw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449487803", "bodyText": "FTR if I remember correctly, I had to use IMAGE_FUTURE here to avoid the side effect we had in the constructor, but now it can be as simple as new GenericContainer<>(TINY_IMAGE)", "author": "bsideup", "createdAt": "2020-07-03T09:41:36Z", "path": "core/src/test/java/org/testcontainers/containers/ReusabilityUnitTests.java", "diffHunk": "@@ -61,8 +67,8 @@\n         @Parameterized.Parameters(name = \"{0}\")\n         public static Object[][] data() {\n             return new Object[][] {\n-                { \"generic\", new GenericContainer(IMAGE_FUTURE), true },\n-                { \"anonymous generic\", new GenericContainer(IMAGE_FUTURE) {}, true },\n+                { \"generic\", new GenericContainer<>(new RemoteDockerImage(IMAGE_FUTURE)), true },", "originalCommit": "77aa41801afb757e7abc8a019afb4d10c332956f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MjI3MA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r456892270", "bodyText": "Updated", "author": "rnorth", "createdAt": "2020-07-19T10:43:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4NzgwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4ODYzNw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449488637", "bodyText": "I liked the idea of TestImages, btw. Perhaps we can/should move such references to that class as well", "author": "bsideup", "createdAt": "2020-07-03T09:43:18Z", "path": "core/src/test/java/org/testcontainers/images/ImagePullPolicyTest.java", "diffHunk": "@@ -23,10 +20,13 @@\n import java.util.UUID;\n import java.util.concurrent.TimeUnit;\n \n+import static org.junit.Assert.fail;\n+import static org.mockito.ArgumentMatchers.any;\n+\n public class ImagePullPolicyTest {\n \n     @ClassRule\n-    public static GenericContainer<?> registry = new GenericContainer<>(\"registry:2\")\n+    public static GenericContainer<?> registry = new GenericContainer<>(new DockerImageName(\"registry:2.7.0\"))", "originalCommit": "77aa41801afb757e7abc8a019afb4d10c332956f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1MTIwMQ==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449551201", "bodyText": "Sure, I missed this one!", "author": "rnorth", "createdAt": "2020-07-03T12:11:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4ODYzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MjI1Mw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r456892253", "bodyText": "Updated", "author": "rnorth", "createdAt": "2020-07-19T10:42:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4ODYzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4ODk2Ng==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449488966", "bodyText": "nit: imageName field can be changed to DockerImageName, to make tests' bodies a little bit smaller", "author": "bsideup", "createdAt": "2020-07-03T09:43:59Z", "path": "core/src/test/java/org/testcontainers/images/ImagePullPolicyTest.java", "diffHunk": "@@ -74,7 +74,7 @@ public void setUp() {\n     @Test\n     public void pullsByDefault() {\n         try (\n-            GenericContainer<?> container = new GenericContainer<>(imageName)\n+            GenericContainer<?> container = new GenericContainer(new DockerImageName(imageName))", "originalCommit": "77aa41801afb757e7abc8a019afb4d10c332956f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MjI0MA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r456892240", "bodyText": "Done", "author": "rnorth", "createdAt": "2020-07-19T10:42:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4ODk2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ5MjUxOA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449492518", "bodyText": "a bit unrelated, but... don't we have a mongodb module now? :D", "author": "bsideup", "createdAt": "2020-07-03T09:50:50Z", "path": "examples/mongodb-container/src/test/java/org/testcontainers/containers/MongoDbContainer.java", "diffHunk": "@@ -24,7 +25,9 @@\n \n     /**\n      * Creates a new {@link MongoDbContainer} with the {@value DEFAULT_IMAGE_AND_TAG} image.\n+     * @deprecated use {@link MongoDbContainer(DockerImageName)} instead\n      */\n+    @Deprecated", "originalCommit": "77aa41801afb757e7abc8a019afb4d10c332956f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1MTM3Mw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449551373", "bodyText": "Yeah, we should discuss nuking this example...", "author": "rnorth", "createdAt": "2020-07-03T12:12:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ5MjUxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1Mjg4MA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449552880", "bodyText": "perhaps we should inline the image here, as it will be in the docs", "author": "bsideup", "createdAt": "2020-07-03T12:16:08Z", "path": "modules/mongodb/src/test/java/org/testcontainers/containers/MongoDBContainerTest.java", "diffHunk": "@@ -11,20 +11,24 @@\n import com.mongodb.client.TransactionBody;\n import org.bson.Document;\n import org.junit.Test;\n+import org.testcontainers.utility.DockerImageName;\n \n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertNotNull;\n \n \n public class MongoDBContainerTest {\n+\n+    private static final DockerImageName MONGO_IMAGE = new DockerImageName(\"mongo:4.0.10\");\n+\n     /**\n      * Taken from <a href=\"https://docs.mongodb.com/manual/core/transactions/\">https://docs.mongodb.com</a>\n      */\n     @Test\n     public void shouldExecuteTransactions() {\n         try (\n             // creatingMongoDBContainer {\n-            final MongoDBContainer mongoDBContainer = new MongoDBContainer()\n+            final MongoDBContainer mongoDBContainer = new MongoDBContainer(MONGO_IMAGE)", "originalCommit": "77aa41801afb757e7abc8a019afb4d10c332956f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MjIxNA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r456892214", "bodyText": "Done.", "author": "rnorth", "createdAt": "2020-07-19T10:42:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1Mjg4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1NTA2Nw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449555067", "bodyText": "this.customImageNameIsSet = true; and recordingMode = VncRecordingMode.SKIP; from BrowserWebDriverContainer(String) are missing", "author": "bsideup", "createdAt": "2020-07-03T12:21:40Z", "path": "modules/selenium/src/main/java/org/testcontainers/containers/BrowserWebDriverContainer.java", "diffHunk": "@@ -87,15 +88,29 @@ public BrowserWebDriverContainer() {\n     /**\n      * Constructor taking a specific webdriver container name and tag\n      * @param dockerImageName Name of the docker image to pull\n+     * @deprecated use {@link BrowserWebDriverContainer(DockerImageName)} instead\n      */\n+    @Deprecated\n     public BrowserWebDriverContainer(String dockerImageName) {\n-        this();\n-        super.setDockerImageName(dockerImageName);\n+        this(new DockerImageName(dockerImageName));\n         this.customImageNameIsSet = true;\n         // We have to force SKIP mode for the recording by default because we don't know if the image has VNC or not\n         recordingMode = VncRecordingMode.SKIP;\n     }\n \n+    public BrowserWebDriverContainer(DockerImageName dockerImageName) {", "originalCommit": "77aa41801afb757e7abc8a019afb4d10c332956f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc1MTgyMg==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r449751822", "bodyText": "Fixed", "author": "rnorth", "createdAt": "2020-07-04T08:16:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTU1NTA2Nw=="}], "type": "inlineReview"}, {"oid": "592f08aad393adb3616e4ce94c155ad0389b4b68", "url": "https://github.com/testcontainers/testcontainers-java/commit/592f08aad393adb3616e4ce94c155ad0389b4b68", "message": "Use static factory method instead of constructor", "committedDate": "2020-07-03T21:21:54Z", "type": "commit"}, {"oid": "1edc3077bf76e15df2724adea6ff8d64e7521e9e", "url": "https://github.com/testcontainers/testcontainers-java/commit/1edc3077bf76e15df2724adea6ff8d64e7521e9e", "message": "Use constant for docker registry image name", "committedDate": "2020-07-04T08:01:01Z", "type": "commit"}, {"oid": "113f3b37ad068e636fe2a55017aa2b1e311ea878", "url": "https://github.com/testcontainers/testcontainers-java/commit/113f3b37ad068e636fe2a55017aa2b1e311ea878", "message": "Simplify image usage in ReusabilityUnitTests", "committedDate": "2020-07-04T08:03:02Z", "type": "commit"}, {"oid": "fc7f62570b4ef32fe36238f30c21f02e1614917e", "url": "https://github.com/testcontainers/testcontainers-java/commit/fc7f62570b4ef32fe36238f30c21f02e1614917e", "message": "Use `DockerImageName` instead of `String` for image name", "committedDate": "2020-07-04T08:08:24Z", "type": "commit"}, {"oid": "cd7e13b9bc1f8a1ec9d03a06ad1c1e3c21074c78", "url": "https://github.com/testcontainers/testcontainers-java/commit/cd7e13b9bc1f8a1ec9d03a06ad1c1e3c21074c78", "message": "Inline Mongo image name parsing", "committedDate": "2020-07-04T08:09:03Z", "type": "commit"}, {"oid": "a35b3c4f34d83981282ea6dc2de5f53ee4824442", "url": "https://github.com/testcontainers/testcontainers-java/commit/a35b3c4f34d83981282ea6dc2de5f53ee4824442", "message": "Fix constructor delegation", "committedDate": "2020-07-04T08:11:17Z", "type": "commit"}, {"oid": "868f962393063893870d9055bc9dadc37f48b5b3", "url": "https://github.com/testcontainers/testcontainers-java/commit/868f962393063893870d9055bc9dadc37f48b5b3", "message": "Undo deprecation of SocatContainer no-args constructor", "committedDate": "2020-07-04T08:15:09Z", "type": "commit"}, {"oid": "faf1217e3476256c3b3c4fbd3968633263be1b9f", "url": "https://github.com/testcontainers/testcontainers-java/commit/faf1217e3476256c3b3c4fbd3968633263be1b9f", "message": "Update references to DockerImageName.parse in example code", "committedDate": "2020-07-04T10:36:51Z", "type": "commit"}, {"oid": "ee450035b3a4bc2aff4ec30cec6dbdf2c07c53d9", "url": "https://github.com/testcontainers/testcontainers-java/commit/ee450035b3a4bc2aff4ec30cec6dbdf2c07c53d9", "message": "Merge remote-tracking branch 'origin/master' into deprecate-ambiguous-constructors", "committedDate": "2020-07-04T10:37:27Z", "type": "commit"}, {"oid": "8960ceb8800b95de3834a77d600547eb61b310b3", "url": "https://github.com/testcontainers/testcontainers-java/commit/8960ceb8800b95de3834a77d600547eb61b310b3", "message": "Merge remote-tracking branch 'origin/master' into deprecate-ambiguous-constructors", "committedDate": "2020-07-06T07:36:47Z", "type": "commit"}, {"oid": "f4e314dbb50bdf9eab09d049166a17f0e2ce1fb0", "url": "https://github.com/testcontainers/testcontainers-java/commit/f4e314dbb50bdf9eab09d049166a17f0e2ce1fb0", "message": "Merge remote-tracking branch 'origin/master' into deprecate-ambiguous-constructors", "committedDate": "2020-07-16T10:53:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyMzczNA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r456823734", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    DockerClientFactory.instance().client()\n          \n          \n            \n                        .removeImageCmd(imageName.asCanonicalNameString())\n          \n          \n            \n                        .withForce(true)\n          \n          \n            \n                        .exec();\n          \n          \n            \n                    removeImage();", "author": "bsideup", "createdAt": "2020-07-18T20:12:11Z", "path": "core/src/test/java/org/testcontainers/images/ImagePullPolicyTest.java", "diffHunk": "@@ -90,7 +85,10 @@ public void shouldAlwaysPull() {\n             container.start();\n         }\n \n-        DockerClientFactory.instance().client().removeImageCmd(imageName).withForce(true).exec();\n+        DockerClientFactory.instance().client()\n+            .removeImageCmd(imageName.asCanonicalNameString())\n+            .withForce(true)\n+            .exec();", "originalCommit": "f4e314dbb50bdf9eab09d049166a17f0e2ce1fb0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MjE4OQ==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2839#discussion_r456892189", "bodyText": "Thanks, done.", "author": "rnorth", "createdAt": "2020-07-19T10:42:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyMzczNA=="}], "type": "inlineReview"}, {"oid": "cc4190d5af24b5c4580ae2bf75b741663d34f91b", "url": "https://github.com/testcontainers/testcontainers-java/commit/cc4190d5af24b5c4580ae2bf75b741663d34f91b", "message": "Update core/src/test/java/org/testcontainers/images/ImagePullPolicyTest.java\n\nCo-authored-by: Sergei Egorov <bsideup@gmail.com>", "committedDate": "2020-07-19T10:41:40Z", "type": "commit"}, {"oid": "0eee5d8653dc1795429a9d6709333e0d4ad41b09", "url": "https://github.com/testcontainers/testcontainers-java/commit/0eee5d8653dc1795429a9d6709333e0d4ad41b09", "message": "Merge branch 'master' into deprecate-ambiguous-constructors", "committedDate": "2020-07-19T11:41:20Z", "type": "commit"}]}