{"pr_number": 162, "pr_title": "Share pictures from marker.", "pr_createdAt": "2020-03-16T10:39:15Z", "pr_url": "https://github.com/OpenTracksApp/OpenTracks/pull/162", "timeline": [{"oid": "0125b940d55b1318c983772b182b1cb5bb576e5e", "url": "https://github.com/OpenTracksApp/OpenTracks/commit/0125b940d55b1318c983772b182b1cb5bb576e5e", "message": "Share pictures from marker.\nFixes #89.", "committedDate": "2020-03-16T18:34:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDM2Ng==", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393250366", "bodyText": "Could you use a line break after every sentence?\nIt is usually easier to read", "author": "dennisguse", "createdAt": "2020-03-16T19:02:34Z", "path": "src/main/java/de/dennisguse/opentracks/util/IntentUtils.java", "diffHunk": "@@ -99,6 +101,29 @@ public static Intent newShareFileIntent(Context context, long[] trackIds) {\n                 .putExtra(Intent.EXTRA_TEXT, context.getString(R.string.share_track_share_file_body, trackDescription));\n     }\n \n+    /**\n+     * Creates an intent to share a waypoint image with an app.\n+     *\n+     * @param context the context.\n+     * @param uri     uri with the image to share.\n+     */\n+    public static Intent newShareImageIntent(Context context, Uri uri) {\n+        String mime = context.getContentResolver().getType(uri);\n+\n+        // Because the #166 bug, when you import KMZ tracks then it creates file:/// from markers", "originalCommit": "0125b940d55b1318c983772b182b1cb5bb576e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5MDY1NA==", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393290654", "bodyText": "Of course ;)", "author": "rgmf", "createdAt": "2020-03-16T20:26:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDM2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDEyOTkwNw==", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r394129907", "bodyText": "This is the last one (I promise): but could you modify the comment layout to use:\n\n/* */\nBecause all\nWrite one sentence per line followed by a line break\nIt is usually easier to read and will apply the proper formatting depending on the IDE's window width.", "author": "dennisguse", "createdAt": "2020-03-18T06:32:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDM2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDYwMg==", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393250602", "bodyText": "needs to be:\nintent = Intent.createChooser(intent, null);", "author": "dennisguse", "createdAt": "2020-03-16T19:02:59Z", "path": "src/main/java/de/dennisguse/opentracks/fragments/MarkerDetailFragment.java", "diffHunk": "@@ -188,6 +197,13 @@ public boolean onOptionsItemSelected(MenuItem item) {\n                         .putExtra(MarkerEditActivity.EXTRA_MARKER_ID, markerId);\n                 startActivity(intent);\n                 return true;\n+            case R.id.marker_detail_share:\n+                if (waypoint.hasPhoto()) {\n+                    intent = IntentUtils.newShareImageIntent(getContext(), waypoint.getPhotoURI());\n+                    Intent.createChooser(intent, null);", "originalCommit": "0125b940d55b1318c983772b182b1cb5bb576e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5MTQwNg==", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393291406", "bodyText": "Ops, you are right. Sorry ;)", "author": "rgmf", "createdAt": "2020-03-16T20:28:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDYwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NzIzMw==", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393297233", "bodyText": "Happens to me all the time :)", "author": "dennisguse", "createdAt": "2020-03-16T20:40:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDYwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MTI4Ng==", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393251286", "bodyText": "Is this null check required?\nAnd this code could actually be moved into the calling methods (as long as it is only one menuItem).", "author": "dennisguse", "createdAt": "2020-03-16T19:04:27Z", "path": "src/main/java/de/dennisguse/opentracks/fragments/MarkerDetailFragment.java", "diffHunk": "@@ -170,8 +173,14 @@ public void setMenuVisibility(boolean menuVisible) {\n     @Override\n     public void onCreateOptionsMenu(@NonNull Menu menu, MenuInflater inflater) {\n         inflater.inflate(R.menu.marker_detail, menu);\n-\n+        shareMarkerImageMenuItem = menu.findItem(R.id.marker_detail_share);\n         updateWaypoint(false);\n+        updateMenuItems();\n+    }\n+\n+    private void updateMenuItems() {\n+        if (shareMarkerImageMenuItem != null)", "originalCommit": "0125b940d55b1318c983772b182b1cb5bb576e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI4OTYwMg==", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393289602", "bodyText": "Yes, it's required because I need to check if this option must be hidden every time this MarkerDetailFragment is resumed.\nThe first time the user goes to the marker detail, MarkerDetailFragment onResume is execute and the menu isn't created yet so shareMarkerImageMenuItem is null.\nBut now, you imagine that you go to the detail of a marker with image. Then you edit the marker and you deletes the image. Later you go back to the MarkerDetailFragment, onResume is executed, shareMarkerImageMenuItem isn't null and it must be not visible because the image was deleted.", "author": "rgmf", "createdAt": "2020-03-16T20:24:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MTI4Ng=="}], "type": "inlineReview"}, {"oid": "3f01cca724215c21c570a2a1143c60a3a5844e59", "url": "https://github.com/OpenTracksApp/OpenTracks/commit/3f01cca724215c21c570a2a1143c60a3a5844e59", "message": "Share pictures from marker.\nFixes #89.", "committedDate": "2020-03-17T08:44:48Z", "type": "forcePushed"}, {"oid": "821007ab2c146a28dd4e8915cfe6d9f7f20d5d27", "url": "https://github.com/OpenTracksApp/OpenTracks/commit/821007ab2c146a28dd4e8915cfe6d9f7f20d5d27", "message": "Share pictures from marker.\nFixes #89.", "committedDate": "2020-03-17T21:29:55Z", "type": "forcePushed"}, {"oid": "6ddd97f5795ecbcf1ae43f8bf4829177d97a9650", "url": "https://github.com/OpenTracksApp/OpenTracks/commit/6ddd97f5795ecbcf1ae43f8bf4829177d97a9650", "message": "Share pictures from marker.\nFixes #89.", "committedDate": "2020-03-17T21:38:50Z", "type": "forcePushed"}, {"oid": "eebed68de693c6e69e012ed96ebb05e55ce0d1f5", "url": "https://github.com/OpenTracksApp/OpenTracks/commit/eebed68de693c6e69e012ed96ebb05e55ce0d1f5", "message": "Share pictures from marker.\nFixes #89.", "committedDate": "2020-03-18T08:29:47Z", "type": "forcePushed"}, {"oid": "a6f03d0f232aa830934f3212d482e8b75720dafd", "url": "https://github.com/OpenTracksApp/OpenTracks/commit/a6f03d0f232aa830934f3212d482e8b75720dafd", "message": "Share pictures from marker.\nFixes #89.", "committedDate": "2020-03-18T18:33:57Z", "type": "forcePushed"}, {"oid": "a6f03d0f232aa830934f3212d482e8b75720dafd", "url": "https://github.com/OpenTracksApp/OpenTracks/commit/a6f03d0f232aa830934f3212d482e8b75720dafd", "message": "Share pictures from marker.\nFixes #89.", "committedDate": "2020-03-18T18:33:57Z", "type": "commit"}]}