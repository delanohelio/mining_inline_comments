{"pr_number": 608, "pr_title": "Add Language Features Support for Sections #502", "pr_createdAt": "2020-11-04T09:55:28Z", "pr_url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyMzQzOA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517223438", "bodyText": "private is not needed for @Value annotation", "author": "Nurkambay", "createdAt": "2020-11-04T09:56:18Z", "path": "server/src/main/java/com/broadcom/lsp/cobol/core/semantics/SemanticContext.java", "diffHunk": "@@ -29,15 +30,18 @@\n  * variables, paragraphs, copybooks etc., with their definitions and usages.\n  */\n @Value\n+@Builder\n @AllArgsConstructor\n public class SemanticContext {\n-  private Map<String, Collection<Location>> variableDefinitions;\n-  private Map<String, Collection<Location>> variableUsages;\n-  private Map<String, Collection<Location>> paragraphDefinitions;\n-  private Map<String, Collection<Location>> paragraphUsages;\n-  private Map<String, Collection<Location>> constantDefinitions;\n-  private Map<String, Collection<Location>> constantUsages;\n-  private Map<String, Collection<Location>> copybookDefinitions;\n-  private Map<String, Collection<Location>> copybookUsages;\n-  private List<DocumentSymbol> outlineTree;\n+  Map<String, Collection<Location>> variableDefinitions;", "originalCommit": "77cbb63f7ca65ac0c2816b3f014e41989b167e52", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyMzczOA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517223738", "bodyText": "Maybe the order should be different", "author": "Nurkambay", "createdAt": "2020-11-04T09:56:49Z", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/delegates/completions/CompletionOrder.java", "diffHunk": "@@ -19,6 +19,7 @@\n public enum CompletionOrder {\n   VARIABLES,\n   PARAGRAPHS,\n+  SECTIONS,", "originalCommit": "77cbb63f7ca65ac0c2816b3f014e41989b167e52", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzNDEyNg==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517234126", "bodyText": "It is ok", "author": "temanbrcom", "createdAt": "2020-11-04T10:13:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyMzczOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyNTkzNQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517225935", "bodyText": "Builder better for a big list of parameters", "author": "Nurkambay", "createdAt": "2020-11-04T10:00:01Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/core/engine/CobolLanguageEngineTest.java", "diffHunk": "@@ -132,18 +132,21 @@ void testLanguageEngineRun() {\n                         List.of()))));\n \n     ResultWithErrors<SemanticContext> expected =\n-        new ResultWithErrors<>(\n-            new SemanticContext(\n-                Map.of(),\n-                Map.of(),\n-                Map.of(),\n-                Map.of(),\n-                getConstantDefinitions(),\n-                Map.of(),\n-                Map.of(),\n-                Map.of(),\n-                expectedOutlineTree),\n-            List.of(error));\n+            new ResultWithErrors<>(\n+                    SemanticContext.builder()", "originalCommit": "77cbb63f7ca65ac0c2816b3f014e41989b167e52", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-04T10:00:36Z", "type": "forcePushed"}, {"oid": "7aba39f611bebd601115363210e4d790ae702844", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/7aba39f611bebd601115363210e4d790ae702844", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-04T10:29:19Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyODc0Ng==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517228746", "bodyText": "@AllArgsConstructor can be removed, added as a part of @value", "author": "asatklichov", "createdAt": "2020-11-04T10:04:40Z", "path": "server/src/main/java/com/broadcom/lsp/cobol/core/semantics/SemanticContext.java", "diffHunk": "@@ -29,15 +30,18 @@\n  * variables, paragraphs, copybooks etc., with their definitions and usages.\n  */\n @Value\n+@Builder\n @AllArgsConstructor", "originalCommit": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1MjE3MA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517252170", "bodyText": "The builder overrides constructor to package-private @AllArgsConstructor, so this constructor can be used only inside a package :-(", "author": "Nurkambay", "createdAt": "2020-11-04T10:42:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyODc0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMDQwNQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517230405", "bodyText": "Why not  List ?  in UseCasePreprocessorListener, AnalysisResult they are List, so better to keep same", "author": "asatklichov", "createdAt": "2020-11-04T10:07:18Z", "path": "server/src/main/java/com/broadcom/lsp/cobol/core/semantics/SemanticContext.java", "diffHunk": "@@ -29,15 +30,18 @@\n  * variables, paragraphs, copybooks etc., with their definitions and usages.\n  */\n @Value\n+@Builder\n @AllArgsConstructor\n public class SemanticContext {\n-  private Map<String, Collection<Location>> variableDefinitions;\n-  private Map<String, Collection<Location>> variableUsages;\n-  private Map<String, Collection<Location>> paragraphDefinitions;\n-  private Map<String, Collection<Location>> paragraphUsages;\n-  private Map<String, Collection<Location>> constantDefinitions;\n-  private Map<String, Collection<Location>> constantUsages;\n-  private Map<String, Collection<Location>> copybookDefinitions;\n-  private Map<String, Collection<Location>> copybookUsages;\n-  private List<DocumentSymbol> outlineTree;\n+  Map<String, Collection<Location>> variableDefinitions;\n+  Map<String, Collection<Location>> variableUsages;\n+  Map<String, Collection<Location>> paragraphDefinitions;", "originalCommit": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1MTE2MA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517251160", "bodyText": "It is a result of Multimap.asMap()", "author": "temanbrcom", "createdAt": "2020-11-04T10:41:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMDQwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1NDI2MQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517254261", "bodyText": "In that case, CobolVisitor becomes more complicated and here we have to convert Multimap<String, Location> explicetely:\n  @NonNull\n  public SemanticContext getSemanticContext() {\n    return new SemanticContext(\n        variables.getDefinitions().asMap(),\n        variables.getUsages().asMap(),\n        paragraphs.getDefinitions().asMap(),\n        paragraphs.getUsages().asMap(),\n        sections.getDefinitions().asMap(),\n        sections.getUsages().asMap(),\n        constants.getDefinitions().asMap(),\n        constants.getUsages().asMap(),\n        copybooks.getDefinitions().asMap(),\n        copybooks.getUsages().asMap(),\n        buildOutlineTree());\n  }", "author": "Nurkambay", "createdAt": "2020-11-04T10:46:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMDQwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1NjY1MA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517256650", "bodyText": "It is a known issue, to be fixed after introducing the type check for variables", "author": "temanbrcom", "createdAt": "2020-11-04T10:50:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMDQwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMzY1Mw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517233653", "bodyText": "@nonnull is non-consistent here, because of  ofNullable (yes empty value returned).  Moreover as in SectionLocations class you can add: @nonnull CobolDocumentModel", "author": "asatklichov", "createdAt": "2020-11-04T10:12:37Z", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/delegates/completions/SectionCompletion.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *    Broadcom, Inc. - initial API and implementation\n+ *\n+ */\n+package com.broadcom.lsp.cobol.service.delegates.completions;\n+\n+import com.broadcom.lsp.cobol.service.CobolDocumentModel;\n+import com.broadcom.lsp.cobol.service.delegates.validations.AnalysisResult;\n+import com.google.inject.Singleton;\n+import lombok.NonNull;\n+import org.eclipse.lsp4j.CompletionItemKind;\n+\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Optional;\n+\n+import static com.broadcom.lsp.cobol.service.delegates.completions.CompletionOrder.SECTIONS;\n+\n+/**\n+ * Provide completion functionality for sections\n+ */\n+@Singleton\n+public class SectionCompletion implements Completion {\n+\n+  @NonNull\n+  @Override\n+  public Collection<String> getCompletionSource(CobolDocumentModel document) {", "originalCommit": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1NTk1MQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517255951", "bodyText": "So should I remove all @NonNull statements for getCompletionSource for all Completion classes?", "author": "Nurkambay", "createdAt": "2020-11-04T10:49:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMzY1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1ODY0Mw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517258643", "bodyText": "We do not return the Optional, we just use it to wrap the given value. CobolDocumentModel here is nullable", "author": "temanbrcom", "createdAt": "2020-11-04T10:53:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMzY1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1ODc0MA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517258740", "bodyText": "So should I remove all @NonNull statements for getCompletionSource for all Completion classes?\n\nFor this method yes, but for  other methods they look fine", "author": "asatklichov", "createdAt": "2020-11-04T10:53:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMzY1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI2MTgwMA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517261800", "bodyText": "So should I remove all @NonNull statements for getCompletionSource for all Completion classes?\n\nFor this method yes, but for other methods they look fine\n\nWhy? Let them stay there", "author": "temanbrcom", "createdAt": "2020-11-04T10:59:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMzY1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzMwMTM3Mw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517301373", "bodyText": "em stay t\n\nIt has no affect here, for this situation", "author": "asatklichov", "createdAt": "2020-11-04T12:15:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMzY1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzM5NjIzNw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517396237", "bodyText": "OK! Removed :-)", "author": "Nurkambay", "createdAt": "2020-11-04T14:46:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMzY1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzNzMyNA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517237324", "bodyText": "I suggest to introduce constructor (chain) to which provides all theses init-values by default. Otherwise it will be reteated all the like this way.", "author": "asatklichov", "createdAt": "2020-11-04T10:18:45Z", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/delegates/validations/AnalysisResult.java", "diffHunk": "@@ -30,23 +29,25 @@\n  * Diagnostic} grouped by related documents, all the\n  */\n @Value\n-@AllArgsConstructor\n @Builder(toBuilder = true)\n public class AnalysisResult {\n-  private Map<String, List<Diagnostic>> diagnostics;\n-  private Map<String, List<Location>> variableDefinitions;\n-  private Map<String, List<Location>> variableUsages;\n-  private Map<String, List<Location>> paragraphDefinitions;\n-  private Map<String, List<Location>> paragraphUsages;\n-  private Map<String, List<Location>> constantDefinitions;\n-  private Map<String, List<Location>> constantUsages;\n-  private Map<String, List<Location>> copybookDefinitions;\n-  private Map<String, List<Location>> copybookUsages;\n-  private List<DocumentSymbol> outlineTree;\n+  Map<String, List<Diagnostic>> diagnostics;\n+  Map<String, List<Location>> variableDefinitions;\n+  Map<String, List<Location>> variableUsages;\n+  Map<String, List<Location>> paragraphDefinitions;\n+  Map<String, List<Location>> paragraphUsages;\n+  Map<String, List<Location>> sectionDefinitions;\n+  Map<String, List<Location>> sectionUsages;\n+  Map<String, List<Location>> constantDefinitions;\n+  Map<String, List<Location>> constantUsages;\n+  Map<String, List<Location>> copybookDefinitions;\n+  Map<String, List<Location>> copybookUsages;\n+  List<DocumentSymbol> outlineTree;\n \n   public static AnalysisResult empty() {\n     return new AnalysisResult(\n-        Map.of(), Map.of(), Map.of(), Map.of(), Map.of(), Map.of(), Map.of(), Map.of(), Map.of(),\n+        Map.of(), Map.of(), Map.of(), Map.of(), Map.of(), Map.of(),  Map.of(), Map.of(),", "originalCommit": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0MTMzMA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517241330", "bodyText": "Defining Builder with default values(Map.of()) would help here not to repeat Map.of()", "author": "asatklichov", "createdAt": "2020-11-04T10:25:04Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/core/engine/CobolLanguageEngineTest.java", "diffHunk": "@@ -132,18 +132,21 @@ void testLanguageEngineRun() {\n                         List.of()))));\n \n     ResultWithErrors<SemanticContext> expected =\n-        new ResultWithErrors<>(\n-            new SemanticContext(\n-                Map.of(),\n-                Map.of(),\n-                Map.of(),\n-                Map.of(),\n-                getConstantDefinitions(),\n-                Map.of(),\n-                Map.of(),\n-                Map.of(),\n-                expectedOutlineTree),\n-            List.of(error));\n+            new ResultWithErrors<>(\n+                    SemanticContext.builder()\n+                            .constantDefinitions(getConstantDefinitions())\n+                            .outlineTree(expectedOutlineTree)", "originalCommit": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0MjY4Mw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517242683", "bodyText": "new Completions(Set.of(new SectionCompletion()) so above two lines can be removed", "author": "asatklichov", "createdAt": "2020-11-04T10:27:09Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/service/delegates/completions/SectionCompletionTest.java", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.broadcom.lsp.cobol.service.delegates.completions;\n+\n+import com.broadcom.lsp.cobol.service.CobolDocumentModel;\n+import com.broadcom.lsp.cobol.service.delegates.validations.AnalysisResult;\n+import org.eclipse.lsp4j.*;\n+import org.junit.jupiter.api.Test;\n+\n+import java.util.*;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/** Test to check SectionCompletion */\n+class SectionCompletionTest {\n+    private static final String TEXT =\n+            \"       Identification Division. \\n\"\n+                    + \"       Program-id.    ProgramId.\\n\"\n+                    + \"       Data Division.\\n\"\n+                    + \"       Working-Storage Section.\\n\"\n+                    + \"       01   outer1.\\n\"\n+                    + \"        02   INNER1      PIC 9(4) Binary. \\n\"\n+                    + \"        02   inner2      PIC X(10).\\n\"\n+                    + \"       Procedure Division section.\\n\"\n+                    + \"       000-Main-Logic Section.\\n\"\n+                    + \"           Perform 100-Test.\\n\"\n+                    + \"           Stop Run.\\n\"\n+                    + \"       100-Test Section.\\n\"\n+                    + \"           Move INNER1 of OUTER1 to Str.\\n\"\n+                    + \"       End program ProgramId.\";\n+\n+    /**\n+     * this test creates a test document, scans it for section names, adds them to completionItems,\n+     * then attempts to find the expected output\n+     */\n+    @Test\n+    void testSectionCompletion() {\n+        CobolDocumentModel document = createModel();\n+\n+        Set<Completion> completionSet = new HashSet<>();\n+        completionSet.add(new SectionCompletion());\n+        Completions completions = new Completions(completionSet);", "originalCommit": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0MzM4Nw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517243387", "bodyText": "or logic here can be extracted as a method and can be re-used on below assertion as well", "author": "asatklichov", "createdAt": "2020-11-04T10:28:18Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/service/delegates/completions/SectionCompletionTest.java", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.broadcom.lsp.cobol.service.delegates.completions;\n+\n+import com.broadcom.lsp.cobol.service.CobolDocumentModel;\n+import com.broadcom.lsp.cobol.service.delegates.validations.AnalysisResult;\n+import org.eclipse.lsp4j.*;\n+import org.junit.jupiter.api.Test;\n+\n+import java.util.*;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/** Test to check SectionCompletion */\n+class SectionCompletionTest {\n+    private static final String TEXT =\n+            \"       Identification Division. \\n\"\n+                    + \"       Program-id.    ProgramId.\\n\"\n+                    + \"       Data Division.\\n\"\n+                    + \"       Working-Storage Section.\\n\"\n+                    + \"       01   outer1.\\n\"\n+                    + \"        02   INNER1      PIC 9(4) Binary. \\n\"\n+                    + \"        02   inner2      PIC X(10).\\n\"\n+                    + \"       Procedure Division section.\\n\"\n+                    + \"       000-Main-Logic Section.\\n\"\n+                    + \"           Perform 100-Test.\\n\"\n+                    + \"           Stop Run.\\n\"\n+                    + \"       100-Test Section.\\n\"\n+                    + \"           Move INNER1 of OUTER1 to Str.\\n\"\n+                    + \"       End program ProgramId.\";\n+\n+    /**\n+     * this test creates a test document, scans it for section names, adds them to completionItems,\n+     * then attempts to find the expected output\n+     */\n+    @Test\n+    void testSectionCompletion() {\n+        CobolDocumentModel document = createModel();\n+\n+        Set<Completion> completionSet = new HashSet<>();\n+        completionSet.add(new SectionCompletion());\n+        Completions completions = new Completions(completionSet);\n+        List<CompletionItem> completionItems =\n+                completions.collectFor(document, createCompletionParams()).getItems();\n+\n+        assertEquals(2, completionItems.size());\n+        assertTrue(\n+                completionItems.get(0).getLabel().contains(\"100-Test\")", "originalCommit": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI2NDc2OA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517264768", "bodyText": "Fixed", "author": "Nurkambay", "createdAt": "2020-11-04T11:04:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0MzM4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NTczNQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517245735", "bodyText": "This if condition, itself can be asserted, so test continues", "author": "asatklichov", "createdAt": "2020-11-04T10:31:57Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/usecases/engine/UseCaseEngine.java", "diffHunk": "@@ -209,10 +210,17 @@ private static void assertResultEquals(AnalysisResult actual, TestData expected)\n     assertResult(\"Constant usages:\", expected.getConstantUsages(), actual.getConstantUsages());\n \n     assertResult(\n-        \"Paragraph definition:\",\n-        expected.getParagraphDefinitions(),\n-        actual.getParagraphDefinitions());\n-    assertResult(\"Paragraph usage:\", expected.getParagraphUsages(), actual.getParagraphUsages());\n+        \"Paragraph definition:\", expected.getParagraphDefinitions(), actual.getParagraphDefinitions());\n+\n+    if (!actual.getParagraphUsages().equals(actual.getSectionUsages())) {", "originalCommit": "7aba39f611bebd601115363210e4d790ae702844", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1OTI4NQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517259285", "bodyText": "Sounds reasonable, but it should be a part of a different activity", "author": "temanbrcom", "createdAt": "2020-11-04T10:54:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NTczNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI3OTkxMA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517279910", "bodyText": "I mean no need if condition, just replacing it with asserted line ;)", "author": "asatklichov", "createdAt": "2020-11-04T11:32:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NTczNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI4NDM5MQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517284391", "bodyText": "It will not work because when we have PERFORM statement it is a paragraph usage and section usage at the same time. But expected paragraph usages is not equal to actual paragraph usages in that case :-)", "author": "Nurkambay", "createdAt": "2020-11-04T11:41:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NTczNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI4NDY4NA==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517284684", "bodyText": "I have refactored this statement, maybe it is better now", "author": "Nurkambay", "createdAt": "2020-11-04T11:42:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NTczNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzM5MTYwNw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517391607", "bodyText": "Refactored due to change the logic", "author": "Nurkambay", "createdAt": "2020-11-04T14:39:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NTczNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NjUyMw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517246523", "bodyText": "This if condition, itself can be asserted, so test continues;", "author": "asatklichov", "createdAt": "2020-11-04T10:33:17Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/usecases/engine/UseCaseEngine.java", "diffHunk": "@@ -209,10 +210,17 @@ private static void assertResultEquals(AnalysisResult actual, TestData expected)\n     assertResult(\"Constant usages:\", expected.getConstantUsages(), actual.getConstantUsages());\n \n     assertResult(\n-        \"Paragraph definition:\",\n-        expected.getParagraphDefinitions(),\n-        actual.getParagraphDefinitions());\n-    assertResult(\"Paragraph usage:\", expected.getParagraphUsages(), actual.getParagraphUsages());\n+        \"Paragraph definition:\", expected.getParagraphDefinitions(), actual.getParagraphDefinitions());\n+\n+    if (!actual.getParagraphUsages().equals(actual.getSectionUsages())) {\n+      assertResult(\"Paragraph usages:\", expected.getParagraphUsages(), actual.getParagraphUsages());\n+    }\n+\n+    if (expected.getSectionDefinitions().size() > 0) {", "originalCommit": "7aba39f611bebd601115363210e4d790ae702844", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI4NTk2Nw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517285967", "bodyText": "This if condition is needed because section definition is needed to be verified only if we expect that there is a section to check. Such tests as TestSameCopybookStatementsInDifferentPlacesTreatedAsDifferentEntries will not pass in that case, because engine will find several sections that are not expected.", "author": "Nurkambay", "createdAt": "2020-11-04T11:44:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NjUyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI4NzM2OQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517287369", "bodyText": "So I don't know how to make it better. Any thoughts?", "author": "Nurkambay", "createdAt": "2020-11-04T11:47:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0NjUyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzNTc3NQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517235775", "bodyText": "To differ from the paragraphs, I would suggest using CompletionItemKind.Function here", "author": "temanbrcom", "createdAt": "2020-11-04T10:16:04Z", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/delegates/completions/SectionCompletion.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *    Broadcom, Inc. - initial API and implementation\n+ *\n+ */\n+package com.broadcom.lsp.cobol.service.delegates.completions;\n+\n+import com.broadcom.lsp.cobol.service.CobolDocumentModel;\n+import com.broadcom.lsp.cobol.service.delegates.validations.AnalysisResult;\n+import com.google.inject.Singleton;\n+import lombok.NonNull;\n+import org.eclipse.lsp4j.CompletionItemKind;\n+\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Optional;\n+\n+import static com.broadcom.lsp.cobol.service.delegates.completions.CompletionOrder.SECTIONS;\n+\n+/**\n+ * Provide completion functionality for sections\n+ */\n+@Singleton\n+public class SectionCompletion implements Completion {\n+\n+  @NonNull\n+  @Override\n+  public Collection<String> getCompletionSource(CobolDocumentModel document) {\n+    return Optional.ofNullable(document)\n+        .map(CobolDocumentModel::getAnalysisResult)\n+        .map(AnalysisResult::getSections)\n+        .orElse(Collections.emptySet());\n+  }\n+\n+  @NonNull\n+  @Override\n+  public String getSortOrderPrefix() {\n+    return SECTIONS.prefix;\n+  }\n+\n+  @NonNull\n+  @Override\n+  public CompletionItemKind getKind() {\n+    return CompletionItemKind.Method;", "originalCommit": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0MzEzNw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517243137", "bodyText": "This is not really representative, better using somethin like assertThat(list, contains(\"foo\", \"boo\")); from Hamcrest", "author": "temanbrcom", "createdAt": "2020-11-04T10:27:54Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/service/delegates/completions/SectionCompletionTest.java", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.broadcom.lsp.cobol.service.delegates.completions;\n+\n+import com.broadcom.lsp.cobol.service.CobolDocumentModel;\n+import com.broadcom.lsp.cobol.service.delegates.validations.AnalysisResult;\n+import org.eclipse.lsp4j.*;\n+import org.junit.jupiter.api.Test;\n+\n+import java.util.*;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/** Test to check SectionCompletion */\n+class SectionCompletionTest {\n+    private static final String TEXT =\n+            \"       Identification Division. \\n\"\n+                    + \"       Program-id.    ProgramId.\\n\"\n+                    + \"       Data Division.\\n\"\n+                    + \"       Working-Storage Section.\\n\"\n+                    + \"       01   outer1.\\n\"\n+                    + \"        02   INNER1      PIC 9(4) Binary. \\n\"\n+                    + \"        02   inner2      PIC X(10).\\n\"\n+                    + \"       Procedure Division section.\\n\"\n+                    + \"       000-Main-Logic Section.\\n\"\n+                    + \"           Perform 100-Test.\\n\"\n+                    + \"           Stop Run.\\n\"\n+                    + \"       100-Test Section.\\n\"\n+                    + \"           Move INNER1 of OUTER1 to Str.\\n\"\n+                    + \"       End program ProgramId.\";\n+\n+    /**\n+     * this test creates a test document, scans it for section names, adds them to completionItems,\n+     * then attempts to find the expected output\n+     */\n+    @Test\n+    void testSectionCompletion() {\n+        CobolDocumentModel document = createModel();\n+\n+        Set<Completion> completionSet = new HashSet<>();\n+        completionSet.add(new SectionCompletion());\n+        Completions completions = new Completions(completionSet);\n+        List<CompletionItem> completionItems =\n+                completions.collectFor(document, createCompletionParams()).getItems();\n+\n+        assertEquals(2, completionItems.size());\n+        assertTrue(\n+                completionItems.get(0).getLabel().contains(\"100-Test\")\n+                        || completionItems.get(0).getLabel().contains(\"000-Main-Logic\"),\n+                \"100-Test\");\n+        assertTrue(\n+                completionItems.get(1).getLabel().contains(\"100-Test\")\n+                        || completionItems.get(1).getLabel().contains(\"000-Main-Logic\"),\n+                \"000-Main-Logic\");", "originalCommit": "080e9e324aca5e0fa9069794f2dfa5fdb8daabef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI2NDM2Mg==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517264362", "bodyText": "Fixed", "author": "Nurkambay", "createdAt": "2020-11-04T11:03:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0MzEzNw=="}], "type": "inlineReview"}, {"oid": "efb119fa0267b9b71231aa1b3b86498c8315e549", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/efb119fa0267b9b71231aa1b3b86498c8315e549", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-04T11:05:11Z", "type": "forcePushed"}, {"oid": "4c0ab2807c9c5b69fa9f662207e0dc50554d8661", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/4c0ab2807c9c5b69fa9f662207e0dc50554d8661", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-04T11:41:50Z", "type": "forcePushed"}, {"oid": "555f16bf725cbee819a0482a529f31f387fe5c0d", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/555f16bf725cbee819a0482a529f31f387fe5c0d", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-04T14:38:21Z", "type": "forcePushed"}, {"oid": "da52da94c16eec194bda9c33c887545d596febea", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/da52da94c16eec194bda9c33c887545d596febea", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-04T14:45:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzM5NTk3Ng==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517395976", "bodyText": "Please, provide javadocs for the class and all the public methods", "author": "temanbrcom", "createdAt": "2020-11-04T14:45:49Z", "path": "server/src/main/java/com/broadcom/lsp/cobol/core/semantics/GroupContext.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.broadcom.lsp.cobol.core.semantics;\n+\n+import com.broadcom.lsp.cobol.core.messages.MessageService;\n+import com.broadcom.lsp.cobol.core.model.ErrorSeverity;\n+import com.broadcom.lsp.cobol.core.model.Locality;\n+import com.broadcom.lsp.cobol.core.model.SyntaxError;\n+import com.google.common.collect.HashMultimap;\n+import com.google.common.collect.Multimap;\n+import lombok.NoArgsConstructor;\n+import org.eclipse.lsp4j.Location;\n+\n+import java.util.*;\n+import java.util.stream.Collectors;\n+\n+@NoArgsConstructor\n+public class GroupContext {", "originalCommit": "555f16bf725cbee819a0482a529f31f387fe5c0d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwOTE2Ng==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517409166", "bodyText": "Done", "author": "Nurkambay", "createdAt": "2020-11-04T15:03:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzM5NTk3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwMTA3OQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517401079", "bodyText": "Please, add a javadoc here.", "author": "temanbrcom", "createdAt": "2020-11-04T14:52:50Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/core/semantics/GroupContextTest.java", "diffHunk": "@@ -0,0 +1,54 @@\n+package com.broadcom.lsp.cobol.core.semantics;\n+\n+import com.broadcom.lsp.cobol.core.model.Locality;\n+import org.eclipse.lsp4j.Location;\n+import org.junit.jupiter.api.Test;\n+\n+import java.util.Collection;\n+import java.util.Map;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+class GroupContextTest {", "originalCommit": "da52da94c16eec194bda9c33c887545d596febea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwOTA5Mg==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517409092", "bodyText": "Done", "author": "Nurkambay", "createdAt": "2020-11-04T15:03:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwMTA3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwMTQwNw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517401407", "bodyText": "Please, cover this method with a test", "author": "temanbrcom", "createdAt": "2020-11-04T14:53:18Z", "path": "server/src/main/java/com/broadcom/lsp/cobol/core/semantics/GroupContext.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.broadcom.lsp.cobol.core.semantics;\n+\n+import com.broadcom.lsp.cobol.core.messages.MessageService;\n+import com.broadcom.lsp.cobol.core.model.ErrorSeverity;\n+import com.broadcom.lsp.cobol.core.model.Locality;\n+import com.broadcom.lsp.cobol.core.model.SyntaxError;\n+import com.google.common.collect.HashMultimap;\n+import com.google.common.collect.Multimap;\n+import lombok.NoArgsConstructor;\n+import org.eclipse.lsp4j.Location;\n+\n+import java.util.*;\n+import java.util.stream.Collectors;\n+\n+@NoArgsConstructor\n+public class GroupContext {\n+  private final Multimap<String, Location> sections = HashMultimap.create();\n+  private final Multimap<String, Location> paragraphs = HashMultimap.create();\n+\n+  private final Multimap<String, Locality> candidateUsageLocalities = HashMultimap.create();\n+\n+  public void addSectionDefinition(String name, Locality locality) {\n+    sections.put(name, locality.toLocation());\n+  }\n+\n+  public void addParagraphDefinition(String name, Locality locality) {\n+    paragraphs.put(name, locality.toLocation());\n+  }\n+\n+  public void addCandidateUsage(String name, Locality locality) {\n+    candidateUsageLocalities.put(name, locality);\n+  }\n+\n+  public Map<String, Collection<Location>> getParagraphDefinitions() {\n+    return paragraphs.asMap();\n+  }\n+\n+  public Map<String, Collection<Location>> getSectionDefinitions() {\n+    return sections.asMap();\n+  }\n+\n+  public Map<String, Collection<Location>> getParagraphUsages() {\n+    return prepareUsages(paragraphs.keySet());\n+  }\n+\n+  public Map<String, Collection<Location>> getSectionUsages() {\n+    return prepareUsages(sections.keySet());\n+  }\n+\n+  public List<SyntaxError> generateParagraphErrors(MessageService messageService) {", "originalCommit": "da52da94c16eec194bda9c33c887545d596febea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxMjUzOQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517412539", "bodyText": "Done", "author": "Nurkambay", "createdAt": "2020-11-04T15:07:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwMTQwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwMjgxMQ==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517402811", "bodyText": "Why did you replace it?", "author": "temanbrcom", "createdAt": "2020-11-04T14:55:07Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/usecases/TestParagraphNotDefined.java", "diffHunk": "@@ -1,38 +1,47 @@\n package com.broadcom.lsp.cobol.usecases;\n \n-import com.broadcom.lsp.cobol.service.delegates.validations.SourceInfoLevels;\n-import com.broadcom.lsp.cobol.usecases.engine.UseCaseEngine;\n import org.eclipse.lsp4j.Diagnostic;\n-import org.eclipse.lsp4j.DiagnosticSeverity;\n-import org.eclipse.lsp4j.Position;\n import org.eclipse.lsp4j.Range;\n import org.junit.jupiter.api.Test;\n \n import java.util.List;\n-import java.util.Map;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n \n /** This test checks that performing not defined paragraph causes a diagnostic error */\n-class TestParagraphNotDefined {\n+class TestParagraphNotDefined extends NegativeUseCase {\n   private static final String TEXT =\n       \"        IDENTIFICATION DIVISION.\\r\\n\"\n           + \"        PROGRAM-ID. test1.\\r\\n\"\n           + \"        DATA DIVISION.\\r\\n\"\n           + \"        WORKING-STORAGE SECTION.\\r\\n\"\n           + \"        PROCEDURE DIVISION.\\r\\n\"\n-          + \"        {#*PROGA}.\\r\\n\"\n-          + \"           PERFORM {#PRINT-DATA|1}.\";\n+          + \"        PROGA.\\r\\n\"\n+          + \"           PERFORM PRINT-DATA.\";\n+\n+  TestParagraphNotDefined() {\n+    super(TEXT);\n+  }\n+\n \n   @Test\n-  void test() {\n-    UseCaseEngine.runTest(\n-        TEXT,\n-        List.of(),\n-        Map.of(\n-            \"1\",\n-            new Diagnostic(\n-                null,\n-                \"The following paragraph is not defined: PRINT-DATA\",\n-                DiagnosticSeverity.Error,\n-                SourceInfoLevels.ERROR.getText())));\n+  public void test() {\n+    super.test();\n+  }\n+\n+  @Override\n+  protected void assertDiagnostics(List<Diagnostic> diagnostics) {\n+    {\n+      assertEquals(1, diagnostics.size(), \"Number of diagnostics\");\n+\n+      Diagnostic diagnostic = diagnostics.get(0);\n+      assertEquals(\"The following paragraph is not defined: PRINT-DATA\", diagnostic.getMessage());\n+\n+      Range range = diagnostic.getRange();\n+      assertEquals(6, range.getStart().getLine(), \"Diagnostic start line\");\n+      assertEquals(19, range.getStart().getCharacter(), \"Diagnostic start character\");\n+      assertEquals(6, range.getEnd().getLine(), \"Diagnostic end line\");\n+      assertEquals(29, range.getEnd().getCharacter(), \"Diagnostic end character\");\n+    }", "originalCommit": "da52da94c16eec194bda9c33c887545d596febea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwODEzNg==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517408136", "bodyText": "After changing logic the previous test was failing on paragraph usages expected and actual counts and did not check the error message, because this check is performing after expected and actual counts.", "author": "Nurkambay", "createdAt": "2020-11-04T15:01:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwMjgxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwNDIwMw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517404203", "bodyText": "You don't need this condition, the assertion should be applied in any case", "author": "temanbrcom", "createdAt": "2020-11-04T14:56:56Z", "path": "server/src/test/java/com/broadcom/lsp/cobol/usecases/engine/UseCaseEngine.java", "diffHunk": "@@ -209,10 +210,14 @@ private static void assertResultEquals(AnalysisResult actual, TestData expected)\n     assertResult(\"Constant usages:\", expected.getConstantUsages(), actual.getConstantUsages());\n \n     assertResult(\n-        \"Paragraph definition:\",\n-        expected.getParagraphDefinitions(),\n-        actual.getParagraphDefinitions());\n-    assertResult(\"Paragraph usage:\", expected.getParagraphUsages(), actual.getParagraphUsages());\n+        \"Paragraph definition:\", expected.getParagraphDefinitions(), actual.getParagraphDefinitions());\n+    assertResult(\"Paragraph usages:\", expected.getParagraphUsages(), actual.getParagraphUsages());\n+\n+    if (!expected.getSectionDefinitions().isEmpty()) {", "originalCommit": "da52da94c16eec194bda9c33c887545d596febea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzkwNTY0Nw==", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/608#discussion_r517905647", "bodyText": "Thanks for help! Closed.", "author": "Nurkambay", "createdAt": "2020-11-05T09:26:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwNDIwMw=="}], "type": "inlineReview"}, {"oid": "58ebc3e4a5cf544a4a8a8addd7bcdb0d883a68c9", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/58ebc3e4a5cf544a4a8a8addd7bcdb0d883a68c9", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-04T15:07:50Z", "type": "forcePushed"}, {"oid": "530350b6219b8f5e1e827022498f3a3078e9236d", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/530350b6219b8f5e1e827022498f3a3078e9236d", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-05T09:25:51Z", "type": "forcePushed"}, {"oid": "67d8ff438b7c6cbda208e98863bf9245446bec24", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/67d8ff438b7c6cbda208e98863bf9245446bec24", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-05T10:40:40Z", "type": "forcePushed"}, {"oid": "09feb8646fce9b556fb90c99e2838cae8762b4ff", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/09feb8646fce9b556fb90c99e2838cae8762b4ff", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-05T10:41:04Z", "type": "forcePushed"}, {"oid": "47ef23ed5f96ff18fd102933a1d69fe8c3912a19", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/47ef23ed5f96ff18fd102933a1d69fe8c3912a19", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-05T12:06:25Z", "type": "commit"}, {"oid": "47ef23ed5f96ff18fd102933a1d69fe8c3912a19", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/47ef23ed5f96ff18fd102933a1d69fe8c3912a19", "message": "feat: Add Language Features Support for Sections #502\n\nSigned-off-by: Leonid Baranov <leonid.baranov@broadcom.com>", "committedDate": "2020-11-05T12:06:25Z", "type": "forcePushed"}]}