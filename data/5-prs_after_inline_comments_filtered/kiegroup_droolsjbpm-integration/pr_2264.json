{"pr_number": 2264, "pr_title": "[JBPM-9407] Spring Boot - Multiple Data Sources and Pluggable Variable Persistence", "pr_createdAt": "2020-10-06T13:11:12Z", "pr_url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2264", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMyNTY1Mw==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2264#discussion_r504325653", "bodyText": "Though it's not mandatory, perhaps it's more clear if \"Override\" annotation is explicitly shown.", "author": "gmunozfe", "createdAt": "2020-10-14T00:04:04Z", "path": "kie-spring-boot/kie-spring-boot-autoconfiguration/jbpm-spring-boot-autoconfiguration/src/main/java/org/jbpm/springboot/services/SpringKModuleDeploymentService.java", "diffHunk": "@@ -50,7 +53,16 @@ protected RegisterableItemsFactory getRegisterableItemsFactory(AuditEventBuilder\n         return factory;\n     }\n \n-    \n+    protected Map<String, Object> buildContextParameters(KieContainer kieContainer) {", "originalCommit": "66ab0078f294a877f5bdeb68a021715caf7e8891", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg3MjkxNQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2264#discussion_r515872915", "bodyText": "done", "author": "elguardian", "createdAt": "2020-11-02T10:23:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMyNTY1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMyNzY2Nw==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2264#discussion_r504327667", "bodyText": "In the parent invocation, (\"entityManagerFactory\", emf) is also added, shouldn't it be redundant?", "author": "gmunozfe", "createdAt": "2020-10-14T00:11:36Z", "path": "kie-spring-boot/kie-spring-boot-autoconfiguration/jbpm-spring-boot-autoconfiguration/src/main/java/org/jbpm/springboot/services/SpringKModuleDeploymentService.java", "diffHunk": "@@ -50,7 +53,16 @@ protected RegisterableItemsFactory getRegisterableItemsFactory(AuditEventBuilder\n         return factory;\n     }\n \n-    \n+    protected Map<String, Object> buildContextParameters(KieContainer kieContainer) {\n+        Map<String, Object> contextParams = new HashMap<>();\n+        Map<String, EntityManagerFactory> emfsFound = context.getBeansOfType(EntityManagerFactory.class);\n+        for(Map.Entry<String, EntityManagerFactory> entry : emfsFound.entrySet()) {\n+            contextParams.put(entry.getKey(), entry.getValue());\n+        }\n+        contextParams.putAll(super.buildContextParameters(kieContainer));", "originalCommit": "66ab0078f294a877f5bdeb68a021715caf7e8891", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg3NDg3Mg==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2264#discussion_r515874872", "bodyText": "not really.\nNot all deployment service use this spring for instance kie server. so the parents needs to add the entity manager.\nAlso we need the parameters defined in there.\nThere is no point to do any check away just to remove the jbpm entity manager as it cannot be override.", "author": "elguardian", "createdAt": "2020-11-02T10:26:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMyNzY2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI5OTUwNg==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2264#discussion_r513299506", "bodyText": "+1\nThough this could override entityManagerFactory key entry in the map", "author": "afalhambra", "createdAt": "2020-10-28T09:35:51Z", "path": "kie-spring-boot/kie-spring-boot-autoconfiguration/jbpm-spring-boot-autoconfiguration/src/main/java/org/jbpm/springboot/services/SpringKModuleDeploymentService.java", "diffHunk": "@@ -50,7 +53,16 @@ protected RegisterableItemsFactory getRegisterableItemsFactory(AuditEventBuilder\n         return factory;\n     }\n \n-    \n+    protected Map<String, Object> buildContextParameters(KieContainer kieContainer) {\n+        Map<String, Object> contextParams = new HashMap<>();\n+        Map<String, EntityManagerFactory> emfsFound = context.getBeansOfType(EntityManagerFactory.class);\n+        for(Map.Entry<String, EntityManagerFactory> entry : emfsFound.entrySet()) {\n+            contextParams.put(entry.getKey(), entry.getValue());\n+        }\n+        contextParams.putAll(super.buildContextParameters(kieContainer));", "originalCommit": "66ab0078f294a877f5bdeb68a021715caf7e8891", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg3NDk0Nw==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2264#discussion_r515874947", "bodyText": "not really.\nNot all deployment service use this spring for instance kie server. so the parents needs to add the entity manager.\nAlso we need the parameters defined in there.\nThere is no point to do any check away just to remove the jbpm entity manager as it cannot be override.", "author": "elguardian", "createdAt": "2020-11-02T10:26:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI5OTUwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI5OTc5MQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2264#discussion_r513299791", "bodyText": "+1", "author": "afalhambra", "createdAt": "2020-10-28T09:36:17Z", "path": "kie-spring-boot/kie-spring-boot-autoconfiguration/jbpm-spring-boot-autoconfiguration/src/main/java/org/jbpm/springboot/services/SpringKModuleDeploymentService.java", "diffHunk": "@@ -50,7 +53,16 @@ protected RegisterableItemsFactory getRegisterableItemsFactory(AuditEventBuilder\n         return factory;\n     }\n \n-    \n+    protected Map<String, Object> buildContextParameters(KieContainer kieContainer) {", "originalCommit": "66ab0078f294a877f5bdeb68a021715caf7e8891", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8f067e7aee8a6dfbe875b79eb66f41c1c0c057ef", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/8f067e7aee8a6dfbe875b79eb66f41c1c0c057ef", "message": "[JBPM-9407] Spring Boot - Multiple Data Sources and Pluggable Variable Persistence", "committedDate": "2020-11-02T10:26:50Z", "type": "commit"}, {"oid": "8f067e7aee8a6dfbe875b79eb66f41c1c0c057ef", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/8f067e7aee8a6dfbe875b79eb66f41c1c0c057ef", "message": "[JBPM-9407] Spring Boot - Multiple Data Sources and Pluggable Variable Persistence", "committedDate": "2020-11-02T10:26:50Z", "type": "forcePushed"}]}