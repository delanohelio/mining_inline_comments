{"pr_number": 1744, "pr_title": "JBTM 3407 (backport of JBTM-3406 and JBTM-3407 to the 4.17 branch)", "pr_createdAt": "2020-12-13T12:31:29Z", "pr_url": "https://github.com/jbosstm/narayana/pull/1744", "timeline": [{"oid": "bb5af00656dcabbb414bbb2906768747ccae6db8", "url": "https://github.com/jbosstm/narayana/commit/bb5af00656dcabbb414bbb2906768747ccae6db8", "message": "[JBTM-3406] InboundBridge should recover only local tx", "committedDate": "2020-12-11T16:00:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjI3MDEzNQ==", "url": "https://github.com/jbosstm/narayana/pull/1744#discussion_r542270135", "bodyText": "Maybe, it would  be good to close the ByteArrayOutputStream in finally block in fact.", "author": "ochaloup", "createdAt": "2020-12-14T10:21:28Z", "path": "XTS/WSTX/classes/com/arjuna/mw/wstx/logging/wstxLogger.java", "diffHunk": "@@ -33,9 +33,35 @@\n \n import org.jboss.logging.Logger;\n \n+import javax.xml.soap.SOAPException;\n+import javax.xml.soap.SOAPMessage;\n+import javax.xml.ws.handler.MessageContext;\n+import javax.xml.ws.handler.soap.SOAPMessageContext;\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+\n \n public class wstxLogger\n {\n     public static final Logger logger = Logger.getLogger(\"com.arjuna.mw.wstx\");\n     public static final wstxI18NLogger i18NLogger = Logger.getMessageLogger(wstxI18NLogger.class, \"com.arjuna.mw.wstx\");\n+\n+    /**\n+     * Print the content of the SOAP message.\n+     *\n+     * @param soapMessageContext  SOAP message context to extract and log the message content from\n+     */\n+    public static final void traceMessage(SOAPMessageContext soapMessageContext) {\n+        SOAPMessage soapMessage = ((SOAPMessageContext) soapMessageContext).getMessage();\n+        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n+\n+        try {\n+            soapMessage.writeTo(baos);\n+            logger.trace(baos);\n+        } catch (IOException e) {\n+            logger.trace(\"Failure on logging content of the SOAP message \" + soapMessage, e);\n+        } catch (SOAPException e) {\n+            logger.trace(\"Failure on logging content of the SOAP message \" + soapMessage, e);\n+        }", "originalCommit": "3c6a3d15dd8bde837c159df72ae7fdcc86d6ccc0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "38f36831234ef879c2878fc7caf7a94b5799e0bc", "url": "https://github.com/jbosstm/narayana/commit/38f36831234ef879c2878fc7caf7a94b5799e0bc", "message": "[JBTM-3407] additional logging of XTS SOAP processing", "committedDate": "2020-12-14T17:06:51Z", "type": "commit"}, {"oid": "38f36831234ef879c2878fc7caf7a94b5799e0bc", "url": "https://github.com/jbosstm/narayana/commit/38f36831234ef879c2878fc7caf7a94b5799e0bc", "message": "[JBTM-3407] additional logging of XTS SOAP processing", "committedDate": "2020-12-14T17:06:51Z", "type": "forcePushed"}]}