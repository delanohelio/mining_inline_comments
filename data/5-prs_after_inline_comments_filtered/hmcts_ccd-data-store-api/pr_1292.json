{"pr_number": 1292, "pr_title": "RDM-6873: Event Enabling Condition - Data Store Changes", "pr_createdAt": "2020-12-17T12:39:00Z", "pr_url": "https://github.com/hmcts/ccd-data-store-api/pull/1292", "timeline": [{"oid": "46b0e6fb47cf0d0eece5954c86ab7c45c48f9f0e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/46b0e6fb47cf0d0eece5954c86ab7c45c48f9f0e", "message": "RDM-6873: Event Enabling Condition - Data Store Changes", "committedDate": "2020-12-16T13:15:39Z", "type": "commit"}, {"oid": "71e123c5da2ffea64895327b57aa07868d3f52f5", "url": "https://github.com/hmcts/ccd-data-store-api/commit/71e123c5da2ffea64895327b57aa07868d3f52f5", "message": "RDM-6873: Event Enabling Condition - Data Store Changes", "committedDate": "2020-12-16T17:17:20Z", "type": "commit"}, {"oid": "23a3e10023a50e2b6c71ba7ef1f6cb6143fed681", "url": "https://github.com/hmcts/ccd-data-store-api/commit/23a3e10023a50e2b6c71ba7ef1f6cb6143fed681", "message": "RDM-6873: Event Enabling Condition - Data Store Changes", "committedDate": "2020-12-16T18:52:19Z", "type": "commit"}, {"oid": "c28d962cfa86336fa79237fff67d7632363cbf67", "url": "https://github.com/hmcts/ccd-data-store-api/commit/c28d962cfa86336fa79237fff67d7632363cbf67", "message": "RDM-6873: CVE-2020-8908 issue addressed", "committedDate": "2020-12-17T15:41:32Z", "type": "commit"}, {"oid": "ccd3501783cdc93aa79a92b05ec1c174fbd8d381", "url": "https://github.com/hmcts/ccd-data-store-api/commit/ccd3501783cdc93aa79a92b05ec1c174fbd8d381", "message": "RDM-6873: removed unused imports", "committedDate": "2020-12-17T15:50:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyMjUyNg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1292#discussion_r545722526", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public Boolean evaluate(String enablingCondition,\n          \n          \n            \n                public Boolean isEventEnabled(String enablingCondition,", "author": "mario-paniccia", "createdAt": "2020-12-18T09:53:55Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/common/CaseEventEnablingService.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package uk.gov.hmcts.ccd.domain.service.common;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import java.util.Map;\n+import javax.inject.Inject;\n+import org.apache.commons.lang3.StringUtils;\n+import org.springframework.stereotype.Service;\n+import uk.gov.hmcts.ccd.domain.enablingcondition.EnablingConditionParser;\n+\n+@Service\n+public class CaseEventEnablingService {\n+\n+    private final EnablingConditionParser enablingConditionParser;\n+\n+    @Inject\n+    public CaseEventEnablingService(EnablingConditionParser enablingConditionParser) {\n+        this.enablingConditionParser = enablingConditionParser;\n+    }\n+\n+    public Boolean evaluate(String enablingCondition,", "originalCommit": "ccd3501783cdc93aa79a92b05ec1c174fbd8d381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc4MTgzMw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1292#discussion_r545781833", "bodyText": "done", "author": "kiran-yenigala-hmcts", "createdAt": "2020-12-18T11:49:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyMjUyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyMzYwOA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1292#discussion_r545723608", "bodyText": "something weird here. Show condition can have metadata fields in them, i.e. [STATE]=someState.\nI would have thought you needed to pass the whole case so that metadata can be evaluated as well. Instead we are passing only the case fields in the data field", "author": "mario-paniccia", "createdAt": "2020-12-18T09:55:48Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/common/CaseEventEnablingService.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package uk.gov.hmcts.ccd.domain.service.common;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import java.util.Map;\n+import javax.inject.Inject;\n+import org.apache.commons.lang3.StringUtils;\n+import org.springframework.stereotype.Service;\n+import uk.gov.hmcts.ccd.domain.enablingcondition.EnablingConditionParser;\n+\n+@Service\n+public class CaseEventEnablingService {\n+\n+    private final EnablingConditionParser enablingConditionParser;\n+\n+    @Inject\n+    public CaseEventEnablingService(EnablingConditionParser enablingConditionParser) {\n+        this.enablingConditionParser = enablingConditionParser;\n+    }\n+\n+    public Boolean evaluate(String enablingCondition,\n+                           Map<String, JsonNode> caseEventData) {", "originalCommit": "ccd3501783cdc93aa79a92b05ec1c174fbd8d381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyNTQ0OQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1292#discussion_r545725449", "bodyText": "If this issue is confirmed, can we also add some integration tests for event enabling conditions with metadata in show conditions to avoid regressions", "author": "mario-paniccia", "createdAt": "2020-12-18T09:58:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyMzYwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyNjQxOA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1292#discussion_r545726418", "bodyText": "I'm thinking, do we have the same issue with case post states? Do we support metadata fields in show conditions there? we should...", "author": "mario-paniccia", "createdAt": "2020-12-18T10:00:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyMzYwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTczNDI5OA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1292#discussion_r545734298", "bodyText": "We are not supporting metadata fields in case post states for now...", "author": "kiran-yenigala-hmcts", "createdAt": "2020-12-18T10:15:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyMzYwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgxMzE4Mw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1292#discussion_r545813183", "bodyText": "something weird here. Show condition can have metadata fields in them, i.e. [STATE]=someState.\nI would have thought you needed to pass the whole case so that metadata can be evaluated as well. Instead we are passing only the case fields in the data field\n\nchanged to include CaseDetails and now supporting meta data as well in this..", "author": "kiran-yenigala-hmcts", "createdAt": "2020-12-18T12:55:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyMzYwOA=="}], "type": "inlineReview"}, {"oid": "2927a2cb8ce01de3f6b81ab9749f009439a4242a", "url": "https://github.com/hmcts/ccd-data-store-api/commit/2927a2cb8ce01de3f6b81ab9749f009439a4242a", "message": "RDM-6873: included meta data as well in event enable condition", "committedDate": "2020-12-18T12:53:42Z", "type": "commit"}, {"oid": "6228dbd9df740838e799ffbde1011b2be79a771b", "url": "https://github.com/hmcts/ccd-data-store-api/commit/6228dbd9df740838e799ffbde1011b2be79a771b", "message": "RDM-6873: fixed duplicate guid issues", "committedDate": "2020-12-29T18:16:17Z", "type": "commit"}, {"oid": "2cd792cbad8ad07c7b17960a413a481e7e2ec508", "url": "https://github.com/hmcts/ccd-data-store-api/commit/2cd792cbad8ad07c7b17960a413a481e7e2ec508", "message": "RDM-6873: CVE-2020-26939 suppressed", "committedDate": "2020-12-30T08:33:26Z", "type": "commit"}, {"oid": "7e34cb39f3aa0644ef1eea113613b2713cc9adb9", "url": "https://github.com/hmcts/ccd-data-store-api/commit/7e34cb39f3aa0644ef1eea113613b2713cc9adb9", "message": "Merge branch 'develop' into RDM-6873", "committedDate": "2020-12-30T09:11:31Z", "type": "commit"}, {"oid": "ec7f752579767cbf499d5e4cb1e687b12c70de42", "url": "https://github.com/hmcts/ccd-data-store-api/commit/ec7f752579767cbf499d5e4cb1e687b12c70de42", "message": "RDM-6873: functional test cases updated", "committedDate": "2020-12-30T09:18:22Z", "type": "commit"}, {"oid": "82291f289b3378378f4f6753317d24de81fd1645", "url": "https://github.com/hmcts/ccd-data-store-api/commit/82291f289b3378378f4f6753317d24de81fd1645", "message": "Merge remote-tracking branch 'origin/RDM-6873' into RDM-6873", "committedDate": "2020-12-30T09:18:39Z", "type": "commit"}, {"oid": "597c7f4db93fe40adcfa3175ba362871e90cb25a", "url": "https://github.com/hmcts/ccd-data-store-api/commit/597c7f4db93fe40adcfa3175ba362871e90cb25a", "message": "RDM-6873: CVE-2020-29242, CVE-2020-29243, CVE-2020-29244, CVE-2020-29245 suppressed", "committedDate": "2020-12-30T09:26:39Z", "type": "commit"}, {"oid": "88bb76f7c6c52eb97dcf49f15fba9860705e2000", "url": "https://github.com/hmcts/ccd-data-store-api/commit/88bb76f7c6c52eb97dcf49f15fba9860705e2000", "message": "RDM-6873: functional test cases updated", "committedDate": "2020-12-30T09:58:45Z", "type": "commit"}, {"oid": "47cda8aad4c5d31231e581ccf283726fb069b1e1", "url": "https://github.com/hmcts/ccd-data-store-api/commit/47cda8aad4c5d31231e581ccf283726fb069b1e1", "message": "RDM-6873: befta-fw version updated", "committedDate": "2020-12-30T11:08:48Z", "type": "commit"}, {"oid": "67c0c75450ac06612269b0ba5daa7b3e723809a9", "url": "https://github.com/hmcts/ccd-data-store-api/commit/67c0c75450ac06612269b0ba5daa7b3e723809a9", "message": "RDM-6873: fixed functional tests", "committedDate": "2020-12-30T14:13:06Z", "type": "commit"}, {"oid": "d6825c3a31f6f52bd44a1f5ed3956f4a9f85bead", "url": "https://github.com/hmcts/ccd-data-store-api/commit/d6825c3a31f6f52bd44a1f5ed3956f4a9f85bead", "message": "RDM-6873: Post state condition using full case data instead of event specific data", "committedDate": "2021-01-04T15:58:39Z", "type": "commit"}, {"oid": "046dfd1e6feb95e6b35e103786ed304a315e431b", "url": "https://github.com/hmcts/ccd-data-store-api/commit/046dfd1e6feb95e6b35e103786ed304a315e431b", "message": "RDM-6873: Post state condition using full case data instead of event specific data", "committedDate": "2021-01-05T09:05:44Z", "type": "commit"}, {"oid": "2db0c873b56ce63eb31b56ac61a3bc34a9556450", "url": "https://github.com/hmcts/ccd-data-store-api/commit/2db0c873b56ce63eb31b56ac61a3bc34a9556450", "message": "RDM-6873: befta-fw version updated (to relax ssl handshake)", "committedDate": "2021-01-05T10:37:36Z", "type": "commit"}, {"oid": "c2fb4efde693cd23ba6ce5983c37355f8cf1f976", "url": "https://github.com/hmcts/ccd-data-store-api/commit/c2fb4efde693cd23ba6ce5983c37355f8cf1f976", "message": "RDM-10429: befta-fw version updated and fixed test cases", "committedDate": "2021-01-05T13:06:56Z", "type": "commit"}, {"oid": "e0c55b9f2c71844bccb2f0c177e568a04495c33e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e0c55b9f2c71844bccb2f0c177e568a04495c33e", "message": "Merge branch 'develop' into RDM-6873", "committedDate": "2021-01-05T13:15:09Z", "type": "commit"}, {"oid": "0236cdf49df6e42b4c56f00584b39deb65b582ac", "url": "https://github.com/hmcts/ccd-data-store-api/commit/0236cdf49df6e42b4c56f00584b39deb65b582ac", "message": "RDM-6873: befta-fw tests fixed", "committedDate": "2021-01-05T14:00:18Z", "type": "commit"}, {"oid": "27470190d448597c71117763f16def538e18efba", "url": "https://github.com/hmcts/ccd-data-store-api/commit/27470190d448597c71117763f16def538e18efba", "message": "Merge branch 'RDM-6873' of https://github.com/hmcts/ccd-data-store-api into RDM-6873", "committedDate": "2021-01-05T14:00:45Z", "type": "commit"}, {"oid": "5fc2e87f4bf57627dbefd7cc8baf7bf8d9efd5d3", "url": "https://github.com/hmcts/ccd-data-store-api/commit/5fc2e87f4bf57627dbefd7cc8baf7bf8d9efd5d3", "message": "RDM-6873: befta-fw tests fixed", "committedDate": "2021-01-05T15:08:19Z", "type": "commit"}, {"oid": "f4bfd74fb9c8eeac6e299a8f707074e77264aab2", "url": "https://github.com/hmcts/ccd-data-store-api/commit/f4bfd74fb9c8eeac6e299a8f707074e77264aab2", "message": "RDM-6873: user credentials changed", "committedDate": "2021-01-05T16:33:32Z", "type": "commit"}, {"oid": "1cd888eeac159d7c2e73471bfaed0632944d816c", "url": "https://github.com/hmcts/ccd-data-store-api/commit/1cd888eeac159d7c2e73471bfaed0632944d816c", "message": "RDM-6873:                   \"event_enabling_condition\" removed", "committedDate": "2021-01-05T17:21:08Z", "type": "commit"}, {"oid": "59de6ea79f9a5c8f2f74841c12e7cc467a651f33", "url": "https://github.com/hmcts/ccd-data-store-api/commit/59de6ea79f9a5c8f2f74841c12e7cc467a651f33", "message": "RDM-6873:                   \"event_enabling_condition\" removed", "committedDate": "2021-01-05T17:21:24Z", "type": "commit"}, {"oid": "50ccbd9e667de79d4f86092af69b70b80efa77fa", "url": "https://github.com/hmcts/ccd-data-store-api/commit/50ccbd9e667de79d4f86092af69b70b80efa77fa", "message": "RDM-6873: user credentials updated", "committedDate": "2021-01-05T23:07:46Z", "type": "commit"}, {"oid": "64ad198ef59afc8eb0069fcafc20d4b3e004e4a7", "url": "https://github.com/hmcts/ccd-data-store-api/commit/64ad198ef59afc8eb0069fcafc20d4b3e004e4a7", "message": "RDM-6873: fixed test case failures", "committedDate": "2021-01-05T23:57:26Z", "type": "commit"}, {"oid": "107976556c98e92c3fbd855b5df317c674b7d0da", "url": "https://github.com/hmcts/ccd-data-store-api/commit/107976556c98e92c3fbd855b5df317c674b7d0da", "message": "RDM-6873: removed tags", "committedDate": "2021-01-05T23:57:59Z", "type": "commit"}, {"oid": "8135fcb48a465b55cd6eb88195b4f86cc78eb8ae", "url": "https://github.com/hmcts/ccd-data-store-api/commit/8135fcb48a465b55cd6eb88195b4f86cc78eb8ae", "message": "RDM-6873: befta test cases fixed", "committedDate": "2021-01-06T01:28:49Z", "type": "commit"}, {"oid": "9197710b3a1e2bca07c45202237a2c1b5203f732", "url": "https://github.com/hmcts/ccd-data-store-api/commit/9197710b3a1e2bca07c45202237a2c1b5203f732", "message": "RDM-6873: befta test cases fixed", "committedDate": "2021-01-06T01:30:15Z", "type": "commit"}, {"oid": "384d786449d5903eb03fc957e960dcb4f803947a", "url": "https://github.com/hmcts/ccd-data-store-api/commit/384d786449d5903eb03fc957e960dcb4f803947a", "message": "RDM-6873: befta test cases fixed", "committedDate": "2021-01-06T09:02:12Z", "type": "commit"}, {"oid": "57c7c122f17703a5bcba60f15cb100ed4a79bf95", "url": "https://github.com/hmcts/ccd-data-store-api/commit/57c7c122f17703a5bcba60f15cb100ed4a79bf95", "message": "RDM-6873: befta test cases fixed", "committedDate": "2021-01-06T11:18:35Z", "type": "commit"}, {"oid": "af0d3e890bf3947dc11f641e6ab999637f8121b3", "url": "https://github.com/hmcts/ccd-data-store-api/commit/af0d3e890bf3947dc11f641e6ab999637f8121b3", "message": "RDM-6873: removed tag", "committedDate": "2021-01-06T11:30:14Z", "type": "commit"}, {"oid": "1e5ae9b6414c8d7948d90bd658f3cf4e2203d452", "url": "https://github.com/hmcts/ccd-data-store-api/commit/1e5ae9b6414c8d7948d90bd658f3cf4e2203d452", "message": "RDM-6873: defintion store pr updated", "committedDate": "2021-01-06T12:33:53Z", "type": "commit"}, {"oid": "2d26e8e5412011ef097f9301f0713e3b9bcb725f", "url": "https://github.com/hmcts/ccd-data-store-api/commit/2d26e8e5412011ef097f9301f0713e3b9bcb725f", "message": "Merge branch 'develop' into RDM-6873", "committedDate": "2021-01-08T10:29:25Z", "type": "commit"}, {"oid": "29fb1bd3987f5ee65fc862b64688a9f000be6800", "url": "https://github.com/hmcts/ccd-data-store-api/commit/29fb1bd3987f5ee65fc862b64688a9f000be6800", "message": "Merge branch 'develop' into RDM-6873", "committedDate": "2021-01-08T13:49:02Z", "type": "commit"}, {"oid": "234b8a9d6623a14f20f40cee8a7a6843cb4ee837", "url": "https://github.com/hmcts/ccd-data-store-api/commit/234b8a9d6623a14f20f40cee8a7a6843cb4ee837", "message": "Update build.gradle\n\nUpdated to latest befta-fw version", "committedDate": "2021-01-08T13:54:26Z", "type": "commit"}, {"oid": "24e891a9f41871c2f0d51a4100ef443f949f5b9c", "url": "https://github.com/hmcts/ccd-data-store-api/commit/24e891a9f41871c2f0d51a4100ef443f949f5b9c", "message": "Merge branch 'develop' into RDM-6873", "committedDate": "2021-01-11T08:30:57Z", "type": "commit"}, {"oid": "75f5e026ceb948ba7db5fc602afd3e55f50a7bbf", "url": "https://github.com/hmcts/ccd-data-store-api/commit/75f5e026ceb948ba7db5fc602afd3e55f50a7bbf", "message": "RDM-6873: Fix event enabling condition metadata validation issues", "committedDate": "2021-01-11T18:04:40Z", "type": "commit"}, {"oid": "2f806c5932b417000101cc1816e476b246253896", "url": "https://github.com/hmcts/ccd-data-store-api/commit/2f806c5932b417000101cc1816e476b246253896", "message": "Merge branch 'develop' into RDM-6873", "committedDate": "2021-01-11T18:12:02Z", "type": "commit"}, {"oid": "61897c48cd7c8fd961c874412c99fb4536475cec", "url": "https://github.com/hmcts/ccd-data-store-api/commit/61897c48cd7c8fd961c874412c99fb4536475cec", "message": "Merge branch 'develop' into RDM-6873", "committedDate": "2021-01-12T15:00:48Z", "type": "commit"}, {"oid": "ad6fb19974fa5716d38732ef5b4275d1a20a0a2b", "url": "https://github.com/hmcts/ccd-data-store-api/commit/ad6fb19974fa5716d38732ef5b4275d1a20a0a2b", "message": "Update build.gradle\n\nUpdated to latest befta-fw version", "committedDate": "2021-01-12T16:35:49Z", "type": "commit"}, {"oid": "48875a69b93db4b9fcb6a8a7c06dffbaa817ca1c", "url": "https://github.com/hmcts/ccd-data-store-api/commit/48875a69b93db4b9fcb6a8a7c06dffbaa817ca1c", "message": "Update build.gradle\n\nUse befta-fw pre-release version", "committedDate": "2021-01-12T17:53:55Z", "type": "commit"}, {"oid": "6937cac7818aa548994506ce04e94933950024fa", "url": "https://github.com/hmcts/ccd-data-store-api/commit/6937cac7818aa548994506ce04e94933950024fa", "message": "Merge branch 'develop' into RDM-6873", "committedDate": "2021-01-13T11:15:21Z", "type": "commit"}, {"oid": "6a3300da089d19624598233744e6ff85a8b0d879", "url": "https://github.com/hmcts/ccd-data-store-api/commit/6a3300da089d19624598233744e6ff85a8b0d879", "message": "Updated to latest befta-fw version. Revert to develop def-store", "committedDate": "2021-01-13T12:03:32Z", "type": "commit"}, {"oid": "06333f31d3ec0f1e1a2b7d1ae6ee5e2440b1a337", "url": "https://github.com/hmcts/ccd-data-store-api/commit/06333f31d3ec0f1e1a2b7d1ae6ee5e2440b1a337", "message": "RDM-6873: fixed wording issues", "committedDate": "2021-01-13T16:05:50Z", "type": "commit"}, {"oid": "d62c73b37400049aaf1a788864addae953001190", "url": "https://github.com/hmcts/ccd-data-store-api/commit/d62c73b37400049aaf1a788864addae953001190", "message": "Empty commit to trigger build", "committedDate": "2021-01-13T16:11:01Z", "type": "commit"}]}