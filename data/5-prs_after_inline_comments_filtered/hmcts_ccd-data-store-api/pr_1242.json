{"pr_number": 1242, "pr_title": "Resolve conflicts", "pr_createdAt": "2020-11-26T11:42:59Z", "pr_url": "https://github.com/hmcts/ccd-data-store-api/pull/1242", "timeline": [{"oid": "6ae7c521a1b68a3abc7f7f4119d65667e27c52d6", "url": "https://github.com/hmcts/ccd-data-store-api/commit/6ae7c521a1b68a3abc7f7f4119d65667e27c52d6", "message": "Rdm 9052 (#1155)\n\n* upgraded spring boot to 2.3.4\n\n* error message update\n\n* updated the preconditions\n\n* RDM-9480 Fix All Temporarily Suppressed CVEs - Hazelcast code change.\nIncludes Liquibase changes from RDM-9052\n\n* updated charts\n\n* updated format\n\n* swagger update\n\n* spring fox ui update\n\n* RDM-9052: Swagger config upgraded to springfox 3.0.0\n\n* RDM-9052: Swagger config upgraded to springfox 3.0.0\nRemoved AliasWebConfig as it is not needed\n\n* update for swagger-ui whitelist\n\n* updated precondition for liquibase\n\n* RDM-9480 Fix All Temporarily Suppressed CVEs - Data Store Api\n\nCo-authored-by: Sita <sita.kandala@hmcts.net>\nCo-authored-by: MSancaktutar <mutlu.sancaktutar@hmcts.net>\nCo-authored-by: kiran.yenigala@hmcts.net <Yrlks1091327~>\nCo-authored-by: Ashley Noronha <ashleydeannoronha@gmail.com>", "committedDate": "2020-11-16T13:23:04Z", "type": "commit"}, {"oid": "04132a6591a9d74b230447c6a0c29ff7faca9510", "url": "https://github.com/hmcts/ccd-data-store-api/commit/04132a6591a9d74b230447c6a0c29ff7faca9510", "message": "Rdm 9052 (#1184)\n\n* upgraded spring boot to 2.3.4\n\n* error message update\n\n* updated the preconditions\n\n* RDM-9480 Fix All Temporarily Suppressed CVEs - Hazelcast code change.\nIncludes Liquibase changes from RDM-9052\n\n* updated charts\n\n* updated format\n\n* swagger update\n\n* spring fox ui update\n\n* RDM-9052: Swagger config upgraded to springfox 3.0.0\n\n* RDM-9052: Swagger config upgraded to springfox 3.0.0\nRemoved AliasWebConfig as it is not needed\n\n* update for swagger-ui whitelist\n\n* updated precondition for liquibase\n\n* RDM-9480 Fix All Temporarily Suppressed CVEs - Data Store Api\n\n* reverted liquibase changes and upated liquibase version to 3.10.3\n\n* suppressed CVE-2020-13943\n\n* deleted the change log for rdm-9052\n\n* remove es smoke test\n\n* temp suppression\n\n* remove ES test from smoke test\n\n* disable es test run on preview\n\n* revert change\n\nCo-authored-by: Sita <sita.kandala@hmcts.net>\nCo-authored-by: MSancaktutar <mutlu.sancaktutar@hmcts.net>\nCo-authored-by: kiran.yenigala@hmcts.net <Yrlks1091327~>\nCo-authored-by: Ashley Noronha <ashleydeannoronha@gmail.com>", "committedDate": "2020-11-16T13:24:13Z", "type": "commit"}, {"oid": "abeaef23b6e6be31d824df23a09f2b1d424699da", "url": "https://github.com/hmcts/ccd-data-store-api/commit/abeaef23b6e6be31d824df23a09f2b1d424699da", "message": "adjust supression file", "committedDate": "2020-11-16T14:06:21Z", "type": "commit"}, {"oid": "1ccabe9f91867d78b46bb8e8833a26e6c1aacfa0", "url": "https://github.com/hmcts/ccd-data-store-api/commit/1ccabe9f91867d78b46bb8e8833a26e6c1aacfa0", "message": "remove file form changelog master", "committedDate": "2020-11-16T15:33:42Z", "type": "commit"}, {"oid": "25935e86bbcdc3601602e449a6b910f99c2455a3", "url": "https://github.com/hmcts/ccd-data-store-api/commit/25935e86bbcdc3601602e449a6b910f99c2455a3", "message": "Update values.preview.template.yaml", "committedDate": "2020-11-18T08:54:23Z", "type": "commit"}, {"oid": "dd73183a17be7461855308c3162cc113fa660eb7", "url": "https://github.com/hmcts/ccd-data-store-api/commit/dd73183a17be7461855308c3162cc113fa660eb7", "message": "Update values.preview.template.yaml", "committedDate": "2020-11-18T09:31:24Z", "type": "commit"}, {"oid": "28a524d250800e5d68bfc71e9a962f3a440a6712", "url": "https://github.com/hmcts/ccd-data-store-api/commit/28a524d250800e5d68bfc71e9a962f3a440a6712", "message": "Merge branch 'master' into release-cut-20.2.0", "committedDate": "2020-11-18T09:32:28Z", "type": "commit"}, {"oid": "54a7cb47caea7ecd300f6ba32984dae67f312822", "url": "https://github.com/hmcts/ccd-data-store-api/commit/54a7cb47caea7ecd300f6ba32984dae67f312822", "message": "Remove temporary readiness check", "committedDate": "2020-11-18T09:50:37Z", "type": "commit"}, {"oid": "63113a53688266458706a576fd2aa86c7249d3bc", "url": "https://github.com/hmcts/ccd-data-store-api/commit/63113a53688266458706a576fd2aa86c7249d3bc", "message": "updated the cve suppressions", "committedDate": "2020-11-18T15:14:23Z", "type": "commit"}, {"oid": "d541494e9d7b10acbd9884f8faf3847fb45dbf7c", "url": "https://github.com/hmcts/ccd-data-store-api/commit/d541494e9d7b10acbd9884f8faf3847fb45dbf7c", "message": "remove ReadinessHealthIndicator.java as it is nolonger needed after spring boot upgrade", "committedDate": "2020-11-18T15:21:51Z", "type": "commit"}, {"oid": "c3fa3f2c3acc438812ed3af164ea5161e14c3202", "url": "https://github.com/hmcts/ccd-data-store-api/commit/c3fa3f2c3acc438812ed3af164ea5161e14c3202", "message": "Merge branch 'release-cut-20.2.0' of https://github.com/hmcts/ccd-data-store-api into release-cut-20.2.0", "committedDate": "2020-11-18T15:37:13Z", "type": "commit"}, {"oid": "ffd91f395017a8fd781e4c0ca87a0a8f50f064ed", "url": "https://github.com/hmcts/ccd-data-store-api/commit/ffd91f395017a8fd781e4c0ca87a0a8f50f064ed", "message": "removed sonar issues in the class", "committedDate": "2020-11-18T17:13:02Z", "type": "commit"}, {"oid": "2c12e5bbb211195f01cad5f402389584fdddc8a5", "url": "https://github.com/hmcts/ccd-data-store-api/commit/2c12e5bbb211195f01cad5f402389584fdddc8a5", "message": "Release cut demo deployment fix (#1231)\n\n* Update liquibase.gradle\r\n\r\n* Update dependency-check-suppressions.xml\r\n\r\n* Update liquibase.gradle (#1228)\r\n\r\n* Update gssEncMode  (#1230)\r\n\r\n* Update values.yaml\r\n\r\n* Update liquibase.gradle\r\n\r\n* Update values.yaml\r\n\r\n* removed gssmode, it will be governed by env variable..\r\n\r\n* reverted the change gssEncMode\r\n\r\n* enable forward for status health\r\n\r\nCo-authored-by: Dan Lysiak <50049163+danlysiak@users.noreply.github.com>\r\nCo-authored-by: Hemanth <hrpotipati@gmail.com>\r\nCo-authored-by: henryk <kornelee.henry@hmcts.net>", "committedDate": "2020-11-25T13:37:05Z", "type": "commit"}, {"oid": "5a75aae1fa282d957cbfcbdb3b0cf7ebe1864e06", "url": "https://github.com/hmcts/ccd-data-store-api/commit/5a75aae1fa282d957cbfcbdb3b0cf7ebe1864e06", "message": "Merge branch 'master' into release-cut-20.2.0", "committedDate": "2020-11-25T13:38:58Z", "type": "commit"}, {"oid": "93ba72a317d994dd337d13d1b30af856887c9432", "url": "https://github.com/hmcts/ccd-data-store-api/commit/93ba72a317d994dd337d13d1b30af856887c9432", "message": "Bumping chart version", "committedDate": "2020-11-25T13:39:41Z", "type": "commit"}, {"oid": "e6a46e2f4d32d78cd6e3ee439a311403a39bee36", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e6a46e2f4d32d78cd6e3ee439a311403a39bee36", "message": "logging for calls to IdamRepo to distinguish api fetches & cache hits", "committedDate": "2020-11-25T17:01:15Z", "type": "commit"}, {"oid": "ea0406dc8a4f116038be6c2b32f6b1819b88420f", "url": "https://github.com/hmcts/ccd-data-store-api/commit/ea0406dc8a4f116038be6c2b32f6b1819b88420f", "message": "Merge pull request #1240 from hmcts/add_log_for_user_info\n\nlog retrieved user info from idam", "committedDate": "2020-11-25T17:36:34Z", "type": "commit"}, {"oid": "ea164d061e19fa038b6295cb225ec42d89cc55de", "url": "https://github.com/hmcts/ccd-data-store-api/commit/ea164d061e19fa038b6295cb225ec42d89cc55de", "message": "Merge branch 'master' into release-cut-20.2.0", "committedDate": "2020-11-25T20:03:05Z", "type": "commit"}, {"oid": "366d0c98c19911fb1d1e5294a56613d3b8f92870", "url": "https://github.com/hmcts/ccd-data-store-api/commit/366d0c98c19911fb1d1e5294a56613d3b8f92870", "message": "Merge pull request #1216 from hmcts/release-cut-20.2.0\n\nRelease cut 20.2.0", "committedDate": "2020-11-25T20:51:54Z", "type": "commit"}, {"oid": "eb43aacc9b0785b52679757d8646967bfe537ac4", "url": "https://github.com/hmcts/ccd-data-store-api/commit/eb43aacc9b0785b52679757d8646967bfe537ac4", "message": "Merge branch 'master' into develop\n\n# Conflicts:\n#\tbuild.gradle\n#\tcharts/ccd-data-store-api/values.preview.template.yaml\n#\tdependency-check-suppressions.xml\n#\tliquibase.gradle\n#\tsrc/main/java/uk/gov/hmcts/ccd/AliasWebConfig.java\n#\tsrc/main/java/uk/gov/hmcts/ccd/SecurityConfiguration.java\n#\tsrc/main/java/uk/gov/hmcts/ccd/config/SwaggerConfiguration.java", "committedDate": "2020-11-26T11:21:42Z", "type": "commit"}, {"oid": "8c6ee156372206ac66fc3dc29deaeebea6a4352d", "url": "https://github.com/hmcts/ccd-data-store-api/commit/8c6ee156372206ac66fc3dc29deaeebea6a4352d", "message": "Bumping chart version", "committedDate": "2020-11-26T11:43:42Z", "type": "commit"}, {"oid": "8c2c9c99945074c49ca8dc10132e82580df1bc3d", "url": "https://github.com/hmcts/ccd-data-store-api/commit/8c2c9c99945074c49ca8dc10132e82580df1bc3d", "message": "Update values.preview.template.yaml", "committedDate": "2020-11-26T12:41:10Z", "type": "commit"}, {"oid": "71f85e158ed447e6db0fa12008f46983cd1470a7", "url": "https://github.com/hmcts/ccd-data-store-api/commit/71f85e158ed447e6db0fa12008f46983cd1470a7", "message": "Update values.preview.template.yaml", "committedDate": "2020-11-26T12:42:02Z", "type": "commit"}, {"oid": "a96800c900424b2da1348c3c368259874bbfebc7", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a96800c900424b2da1348c3c368259874bbfebc7", "message": "bump up charts revision to 3.4.4 to match master", "committedDate": "2020-11-26T12:51:27Z", "type": "commit"}, {"oid": "3e0407872add6ce07c402fef432068887f5f380f", "url": "https://github.com/hmcts/ccd-data-store-api/commit/3e0407872add6ce07c402fef432068887f5f380f", "message": "Merge branch 'resolve-conflicts' of https://github.com/hmcts/ccd-data-store-api into resolve-conflicts", "committedDate": "2020-11-26T12:52:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5MjU2OQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531492569", "bodyText": "we are already logging in idamRepository, it is not needed again here... it will log the same info multiple times", "author": "kiran-yenigala-hmcts", "createdAt": "2020-11-27T09:51:07Z", "path": "src/main/java/uk/gov/hmcts/ccd/security/JwtGrantedAuthoritiesConverter.java", "diffHunk": "@@ -33,6 +36,8 @@ public JwtGrantedAuthoritiesConverter(IdamRepository idamRepository) {\n         List<GrantedAuthority> authorities = new ArrayList<>();\n         if (jwt.containsClaim(TOKEN_NAME) && jwt.getClaim(TOKEN_NAME).equals(ACCESS_TOKEN)) {\n             UserInfo userInfo = idamRepository.getUserInfo(jwt.getTokenValue());\n+            log.info(\"JwtGrantedAuthoritiesConverter retrieved user info from idamRepository. User Id={}. Roles={}.\",", "originalCommit": "3e0407872add6ce07c402fef432068887f5f380f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5Mjk0OQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531492949", "bodyText": "we are already logging in idamRepository, it is not needed again here... it will log the same info multiple times", "author": "kiran-yenigala-hmcts", "createdAt": "2020-11-27T09:51:50Z", "path": "src/main/java/uk/gov/hmcts/ccd/data/SecurityUtils.java", "diffHunk": "@@ -54,7 +56,13 @@ public HttpHeaders userAuthorizationHeaders() {\n     }\n \n     public UserInfo getUserInfo() {\n-        return idamRepository.getUserInfo(getUserToken());\n+        UserInfo userInfo = idamRepository.getUserInfo(getUserToken());\n+        if (userInfo != null) {\n+            log.info(\"SecurityUtils retrieved user info from idamRepository. User Id={}. Roles={}.\",", "originalCommit": "3e0407872add6ce07c402fef432068887f5f380f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5Mzc2Ng==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531493766", "bodyText": "can we use ParameterType.HEADER(\"header\"), instead of hard coding \"header\"", "author": "kiran-yenigala-hmcts", "createdAt": "2020-11-27T09:53:18Z", "path": "src/main/java/uk/gov/hmcts/ccd/config/SwaggerConfiguration.java", "diffHunk": "@@ -83,7 +87,8 @@ private RequestParameter headerAuthorization() {\n         return new RequestParameterBuilder()\n             .name(\"Authorization\")\n             .description(\"Keyword `Bearer` followed by a valid IDAM user token\")\n-            .in(ParameterType.HEADER)\n+            .in(\"header\")", "originalCommit": "3e0407872add6ce07c402fef432068887f5f380f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5Mzg1MA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531493850", "bodyText": "can we use ParameterType.HEADER(\"header\"), instead of hard coding \"header\"", "author": "kiran-yenigala-hmcts", "createdAt": "2020-11-27T09:53:28Z", "path": "src/main/java/uk/gov/hmcts/ccd/config/SwaggerConfiguration.java", "diffHunk": "@@ -92,7 +97,8 @@ private RequestParameter headerServiceAuthorization() {\n         return new RequestParameterBuilder()\n             .name(\"ServiceAuthorization\")\n             .description(\"Valid Service-to-Service JWT token for a whitelisted micro-service\")\n-            .in(ParameterType.HEADER)\n+            .in(\"header\")\n+            .accepts(Collections.singleton(MediaType.APPLICATION_JSON))", "originalCommit": "3e0407872add6ce07c402fef432068887f5f380f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5NDYyNw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531494627", "bodyText": "if we are forwarding the request to \"/health\" do we need to add this in \"SecurityConfiguration --> AUTH_WHITELIST\"", "author": "kiran-yenigala-hmcts", "createdAt": "2020-11-27T09:54:46Z", "path": "src/main/java/uk/gov/hmcts/ccd/AliasWebConfig.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package uk.gov.hmcts.ccd;\n+\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.web.servlet.config.annotation.ViewControllerRegistry;\n+import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;\n+\n+@Configuration\n+public class AliasWebConfig implements WebMvcConfigurer {\n+\n+    @Override\n+    public void addViewControllers(ViewControllerRegistry registry) {\n+        /**\n+         * This alias is to support Tactical health checks. Once support of Tactical is dropped,\n+         * this alias can be removed.\n+         */\n+        registry.addViewController(\"/status/health\").setViewName(\"forward:/health\");", "originalCommit": "3e0407872add6ce07c402fef432068887f5f380f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}