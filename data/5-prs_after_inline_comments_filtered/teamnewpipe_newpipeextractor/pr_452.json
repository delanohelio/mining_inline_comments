{"pr_number": 452, "pr_title": "Implement youtube subscription import from Google takeout", "pr_createdAt": "2020-11-01T19:49:13Z", "pr_url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/452", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY3ODU1NQ==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/452#discussion_r515678555", "bodyText": "Is it intended to set the content language to en_GB?", "author": "TobiGr", "createdAt": "2020-11-01T22:08:57Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/youtube/extractors/YoutubeSubscriptionExtractor.java", "diffHunk": "@@ -1,126 +1,71 @@\n package org.schabi.newpipe.extractor.services.youtube.extractors;\n \n-import org.jsoup.Jsoup;\n-import org.jsoup.nodes.Document;\n-import org.jsoup.nodes.Element;\n+import com.grack.nanojson.JsonArray;\n+import com.grack.nanojson.JsonObject;\n+import com.grack.nanojson.JsonParser;\n+import com.grack.nanojson.JsonParserException;\n+\n import org.schabi.newpipe.extractor.exceptions.ExtractionException;\n import org.schabi.newpipe.extractor.services.youtube.YoutubeService;\n import org.schabi.newpipe.extractor.subscription.SubscriptionExtractor;\n import org.schabi.newpipe.extractor.subscription.SubscriptionItem;\n-import org.schabi.newpipe.extractor.utils.Parser;\n \n-import java.io.IOException;\n import java.io.InputStream;\n import java.util.ArrayList;\n import java.util.Collections;\n import java.util.List;\n \n+import javax.annotation.Nonnull;\n+\n import static org.schabi.newpipe.extractor.subscription.SubscriptionExtractor.ContentSource.INPUT_STREAM;\n \n /**\n- * Extract subscriptions from a YouTube export (OPML format supported)\n+ * Extract subscriptions from a Google takout export (the user has to get the JSON out of the zip)\n  */\n public class YoutubeSubscriptionExtractor extends SubscriptionExtractor {\n+    private static final String BASE_CHANNEL_URL = \"https://www.youtube.com/channel/\";\n \n-    public YoutubeSubscriptionExtractor(YoutubeService service) {\n-        super(service, Collections.singletonList(INPUT_STREAM));\n+    public YoutubeSubscriptionExtractor(final YoutubeService youtubeService) {\n+        super(youtubeService, Collections.singletonList(INPUT_STREAM));\n     }\n \n     @Override\n     public String getRelatedUrl() {\n-        return \"https://www.youtube.com/subscription_manager?action_takeout=1\";\n+        return \"https://takeout.google.com/takeout/custom/youtube?continue=https%3A%2F%2Fmyaccount.google.com%2Fyourdata%2Fyoutube%3Fhl%3Den_GB%26authuser%3D0\";", "originalCommit": "bfdb1d1661724d59d93bebd877e994469857bf16", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTczMDQ5NA==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/452#discussion_r515730494", "bodyText": "URL decoder at https://www.urldecoder.org/ shows that\nhttps://takeout.google.com/takeout/custom/youtube?continue=https%3A%2F%2Fmyaccount.google.com%2Fyourdata%2Fyoutube%3Fhl%3Den_GB%26authuser%3D0\nto be\nhttps://takeout.google.com/takeout/custom/youtube?continue=https://myaccount.google.com/yourdata/youtube?hl=en_GB&authuser=0\nRemoving the URL arguments:\nhttps://takeout.google.com/takeout/custom/youtube?continue=https%3A%2F%2Fmyaccount.google.com%2Fyourdata%2Fyoutube\nis\nhttps://takeout.google.com/takeout/custom/youtube?continue=https://myaccount.google.com/yourdata/youtube\nThis seems to work too for downloading the subscriptions", "author": "simula67", "createdAt": "2020-11-02T04:04:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY3ODU1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg1ODAzNg==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/452#discussion_r515858036", "bodyText": "I just used the url from TeamNewPipe/NewPipe#4759, but https://takeout.google.com/takeout/custom/youtube?continue=https://myaccount.google.com/yourdata/youtube is shorter and more human-readable, so I'm gonna use that", "author": "Stypox", "createdAt": "2020-11-02T09:58:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY3ODU1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg1ODgyNw==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/452#discussion_r515858827", "bodyText": "Oh, it even works without any continue: https://takeout.google.com/takeout/custom/youtube", "author": "Stypox", "createdAt": "2020-11-02T09:59:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY3ODU1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg2MDQ4NA==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/452#discussion_r515860484", "bodyText": "Done", "author": "Stypox", "createdAt": "2020-11-02T10:02:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY3ODU1NQ=="}], "type": "inlineReview"}, {"oid": "1355f458f8de5cffffd06f100b651784ab7d95ce", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/1355f458f8de5cffffd06f100b651784ab7d95ce", "message": "Implement youtube subscription import from Google takeout", "committedDate": "2020-11-02T10:02:00Z", "type": "forcePushed"}, {"oid": "501ec30152642ad49ce0a1825410d200942d174c", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/501ec30152642ad49ce0a1825410d200942d174c", "message": "Implement youtube subscription import from Google takeout", "committedDate": "2020-11-02T10:04:48Z", "type": "commit"}, {"oid": "501ec30152642ad49ce0a1825410d200942d174c", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/501ec30152642ad49ce0a1825410d200942d174c", "message": "Implement youtube subscription import from Google takeout", "committedDate": "2020-11-02T10:04:48Z", "type": "forcePushed"}]}