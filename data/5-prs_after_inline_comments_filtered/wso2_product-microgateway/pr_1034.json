{"pr_number": 1034, "pr_title": "Revamp json schema validator", "pr_createdAt": "2020-02-25T11:31:24Z", "pr_url": "https://github.com/wso2/product-microgateway/pull/1034", "timeline": [{"oid": "ea45a5780ec33b5fd6d245d2ecbc36dba9e338a0", "url": "https://github.com/wso2/product-microgateway/commit/ea45a5780ec33b5fd6d245d2ecbc36dba9e338a0", "message": "extract resources artifacts", "committedDate": "2020-02-23T14:15:23Z", "type": "commit"}, {"oid": "bddefbaeca6b4d312c1e2abb458f3ef2171e8ab0", "url": "https://github.com/wso2/product-microgateway/commit/bddefbaeca6b4d312c1e2abb458f3ef2171e8ab0", "message": "adding validation filter", "committedDate": "2020-02-23T23:53:05Z", "type": "commit"}, {"oid": "582fc84548f7769287b29c7ef4e1c527da9c99e6", "url": "https://github.com/wso2/product-microgateway/commit/582fc84548f7769287b29c7ef4e1c527da9c99e6", "message": "adding resource folder", "committedDate": "2020-02-25T04:41:07Z", "type": "commit"}, {"oid": "c4f50b7a9cf35c65ce841e3b64f2041a8769fe99", "url": "https://github.com/wso2/product-microgateway/commit/c4f50b7a9cf35c65ce841e3b64f2041a8769fe99", "message": "fix merge conflicts", "committedDate": "2020-02-25T04:43:58Z", "type": "commit"}, {"oid": "11434a497f2188acfda0b7ef42945fa8747a54c3", "url": "https://github.com/wso2/product-microgateway/commit/11434a497f2188acfda0b7ef42945fa8747a54c3", "message": "fixing issues in validator", "committedDate": "2020-02-25T11:08:00Z", "type": "commit"}, {"oid": "19b842948040c90bfe6b9929c09d54a467f58979", "url": "https://github.com/wso2/product-microgateway/commit/19b842948040c90bfe6b9929c09d54a467f58979", "message": "fix code issues", "committedDate": "2020-02-25T11:28:00Z", "type": "commit"}, {"oid": "4cabbb94979b354fee0e0a07c1d059e9ffcde8a0", "url": "https://github.com/wso2/product-microgateway/commit/4cabbb94979b354fee0e0a07c1d059e9ffcde8a0", "message": "Merge branch 'master' of https://github.com/wso2/product-microgateway into restRel", "committedDate": "2020-02-26T04:14:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNDk4Mw==", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r384934983", "bodyText": "Why are we not copying this", "author": "Rajith90", "createdAt": "2020-02-27T06:30:51Z", "path": "components/micro-gateway-cli/src/main/java/org/wso2/apimgt/gateway/cli/cmd/BuildCmd.java", "diffHunk": "@@ -135,9 +139,16 @@ public void execute() {\n             ThrottlePolicyGenerator policyGenerator = new ThrottlePolicyGenerator();\n             policyGenerator.generate(genPoliciesPath, projectName);\n \n+            // Created resources directory\n+            String resourcesPath =\n+                    CmdUtils.getProjectTargetModulePath(projectName) + File.separator + CliConstants.RESOURCES_DIR;\n+            CmdUtils.copyFolder(CmdUtils.getAPIDefinitionPath(projectName), resourcesPath);\n+            // If resources folder contains .yaml file, replace the .yaml with .json file\n+            replaceYAMLFilesToJson(resourcesPath);\n+\n             // Copy static source files\n-            CmdUtils.copyAndReplaceFolder(CmdUtils.getProjectInterceptorsPath(projectName),\n-                    CmdUtils.getProjectTargetInterceptorsPath(projectName));\n+            //CmdUtils.copyAndReplaceFolder(CmdUtils.getProjectInterceptorsPath(projectName),", "originalCommit": "19b842948040c90bfe6b9929c09d54a467f58979", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA3MTU0Mg==", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r386071542", "bodyText": "Fixed.", "author": "hasuniea", "createdAt": "2020-03-01T02:43:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNDk4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNTMyMA==", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r384935320", "bodyText": "Streams are not closed properly", "author": "Rajith90", "createdAt": "2020-02-27T06:32:20Z", "path": "components/micro-gateway-cli/src/main/java/org/wso2/apimgt/gateway/cli/cmd/BuildCmd.java", "diffHunk": "@@ -146,6 +157,40 @@ public void execute() {\n         }\n     }\n \n+    private String convertYamlToJson(String yaml) throws IOException {\n+        ObjectMapper yamlReader = new ObjectMapper(new YAMLFactory());\n+        Object obj = yamlReader.readValue(yaml, Object.class);\n+\n+        ObjectMapper jsonWriter = new ObjectMapper();\n+        return jsonWriter.writeValueAsString(obj);\n+    }\n+\n+    private void replaceYAMLFilesToJson(String resPath) throws IOException {\n+        String fileContent;\n+        String val = null;\n+        FileInputStream fileInputStream;", "originalCommit": "19b842948040c90bfe6b9929c09d54a467f58979", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA3MTU1MA==", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r386071550", "bodyText": "fixed", "author": "hasuniea", "createdAt": "2020-03-01T02:43:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNTMyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNTQyNw==", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r384935427", "bodyText": "Lets remove this from the API", "author": "Rajith90", "createdAt": "2020-02-27T06:32:48Z", "path": "components/micro-gateway-cli/src/main/java/org/wso2/apimgt/gateway/cli/model/rest/ext/ExtendedAPI.java", "diffHunk": "@@ -33,6 +33,8 @@\n     private String mgwApiScope = null;\n     //isGrpc\n     private boolean isGrpc = false;\n+    //projectName\n+    private  String projectName = null;", "originalCommit": "19b842948040c90bfe6b9929c09d54a467f58979", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA3MTU1Mg==", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r386071552", "bodyText": "removed", "author": "hasuniea", "createdAt": "2020-03-01T02:43:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNTQyNw=="}], "type": "inlineReview"}, {"oid": "2a76b499dbfd26ea381450b66c35a01838e47c35", "url": "https://github.com/wso2/product-microgateway/commit/2a76b499dbfd26ea381450b66c35a01838e47c35", "message": "fixed issues", "committedDate": "2020-02-29T12:29:00Z", "type": "commit"}, {"oid": "d67438be3293d2c9506a5e492c3b6d548b11f878", "url": "https://github.com/wso2/product-microgateway/commit/d67438be3293d2c9506a5e492c3b6d548b11f878", "message": "fix merge conflicts", "committedDate": "2020-02-29T18:27:47Z", "type": "commit"}, {"oid": "e36d7dac48546c4c6e79530533cc087b88b5d278", "url": "https://github.com/wso2/product-microgateway/commit/e36d7dac48546c4c6e79530533cc087b88b5d278", "message": "adding tests", "committedDate": "2020-02-29T18:39:39Z", "type": "commit"}, {"oid": "f1b76d060d92419c3a402bf05be29a6abc8cd63d", "url": "https://github.com/wso2/product-microgateway/commit/f1b76d060d92419c3a402bf05be29a6abc8cd63d", "message": "remove project property", "committedDate": "2020-02-29T18:51:56Z", "type": "commit"}, {"oid": "b37d27d344a8ff5eeaf35bc7fcbb7b8026b1eaf1", "url": "https://github.com/wso2/product-microgateway/commit/b37d27d344a8ff5eeaf35bc7fcbb7b8026b1eaf1", "message": "enable testcases", "committedDate": "2020-02-29T18:55:20Z", "type": "commit"}, {"oid": "d5ddae06c1e77ac90c69b131d7a97db903ed72f5", "url": "https://github.com/wso2/product-microgateway/commit/d5ddae06c1e77ac90c69b131d7a97db903ed72f5", "message": "Merge branch 'master' of https://github.com/wso2/product-microgateway into restRel", "committedDate": "2020-03-01T05:41:50Z", "type": "commit"}, {"oid": "7652806eee474e65ff89568bb109b82d2c845104", "url": "https://github.com/wso2/product-microgateway/commit/7652806eee474e65ff89568bb109b82d2c845104", "message": "add copy dependency", "committedDate": "2020-03-01T06:36:38Z", "type": "commit"}, {"oid": "ec2b9f42a2802d24bf3a06f580ee87892dcab7c5", "url": "https://github.com/wso2/product-microgateway/commit/ec2b9f42a2802d24bf3a06f580ee87892dcab7c5", "message": "fix testng", "committedDate": "2020-03-01T08:21:41Z", "type": "commit"}]}