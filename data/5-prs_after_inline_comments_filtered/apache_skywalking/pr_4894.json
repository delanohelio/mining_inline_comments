{"pr_number": 4894, "pr_title": "provide shardingSphere(4.0.0,4.0.1, 4.1.0 ,4.1.1) plugin.", "pr_createdAt": "2020-06-10T07:39:20Z", "pr_url": "https://github.com/apache/skywalking/pull/4894", "timeline": [{"oid": "9c324b4e487781fc4cc8a6eb010265ff9bdef7b3", "url": "https://github.com/apache/skywalking/commit/9c324b4e487781fc4cc8a6eb010265ff9bdef7b3", "message": "provide shardingSphere(4.0.0,4.0.1, 4.1.0 ,4.1.1) plugin.", "committedDate": "2020-06-10T07:37:20Z", "type": "commit"}, {"oid": "b40434b4df949eaa2d1c927378520a02a9e7db6d", "url": "https://github.com/apache/skywalking/commit/b40434b4df949eaa2d1c927378520a02a9e7db6d", "message": "Merge branch 'master' into ss-4.1.0", "committedDate": "2020-06-10T07:39:59Z", "type": "commit"}, {"oid": "983e5c33acfc3a73f13c7b417f6e4ec077459f1e", "url": "https://github.com/apache/skywalking/commit/983e5c33acfc3a73f13c7b417f6e4ec077459f1e", "message": "update support version.", "committedDate": "2020-06-10T10:10:53Z", "type": "commit"}, {"oid": "4f74168012c162efd2722ef88480ba50e32567df", "url": "https://github.com/apache/skywalking/commit/4f74168012c162efd2722ef88480ba50e32567df", "message": "Merge remote-tracking branch 'origin/ss-4.1.0' into ss-4.1.0", "committedDate": "2020-06-10T10:11:19Z", "type": "commit"}, {"oid": "72b0ede025f30ec20ebd89741509a396b5e37f02", "url": "https://github.com/apache/skywalking/commit/72b0ede025f30ec20ebd89741509a396b5e37f02", "message": "Merge branch 'master' into ss-4.1.0", "committedDate": "2020-06-10T12:37:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4OTk2OQ==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438089969", "bodyText": "This is some I mean duplicated codes. If you merge the plugin codes into one, then don't need so many Constant.", "author": "wu-sheng", "createdAt": "2020-06-10T12:41:32Z", "path": "apm-sniffer/apm-sdk-plugin/sharding-sphere-4.1.0-plugin/src/main/java/org/apache/skywalking/apm/plugin/shardingsphere/v41/Constant.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.shardingsphere.v41;\n+\n+/**\n+ * The type Constant.\n+ */\n+public final class Constant {\n+    \n+    /**\n+     * The constant CONTEXT_SNAPSHOT.\n+     */\n+    public static final String CONTEXT_SNAPSHOT = \"CONTEXT_SNAPSHOT\";", "originalCommit": "72b0ede025f30ec20ebd89741509a396b5e37f02", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ5OTMzNw==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438499337", "bodyText": "I think your suggestion is very good, in other PR, we will optimize it, this pr not work here,is also i think.", "author": "yu199195", "createdAt": "2020-06-11T01:52:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4OTk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwNTYwMw==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438505603", "bodyText": "In JDBC case, there is usually a common module, then you have different versions.", "author": "wu-sheng", "createdAt": "2020-06-11T02:17:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4OTk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwNTcxMw==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438505713", "bodyText": "sharding-sphere-plugin\n---- sharding-sphere-common\n---- sharding-sphere-3.x-plugin\n---- sharding-sphere-4.x-plugin\n---- sharding-sphere-4.x-RC3-plugin\n---- sharding-sphere-4.1.0-plugin", "author": "wu-sheng", "createdAt": "2020-06-11T02:18:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4OTk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwNzM5Mg==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438507392", "bodyText": "sheng\uff0cwe will provide other PR optimize it\uff0cinclude test case \u3002 this pr work it\uff0cmaybe is too many\u3002", "author": "yu199195", "createdAt": "2020-06-11T02:25:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4OTk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwOTQ0Ng==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438509446", "bodyText": "OK. Then please update the changes file in the root folder. Once this gets being merged, this is included in the 8.0.0 release.", "author": "wu-sheng", "createdAt": "2020-06-11T02:33:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4OTk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMDQ3Nw==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438510477", "bodyText": "thanks\uff0cI have complied with your Suggestions and review . Now  the code is update\uff0cand summited.", "author": "yu199195", "createdAt": "2020-06-11T02:38:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4OTk2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA5NTYwMA==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438095600", "bodyText": "When we take a look this interceptor, there is nothing related to the shardingsphere package too.", "author": "wu-sheng", "createdAt": "2020-06-10T12:50:28Z", "path": "apm-sniffer/apm-sdk-plugin/sharding-sphere-4.1.0-plugin/src/main/java/org/apache/skywalking/apm/plugin/shardingsphere/v41/ExecuteInterceptor.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.shardingsphere.v41;\n+\n+import java.lang.reflect.Method;\n+import java.util.Map;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.context.ContextSnapshot;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+import org.apache.skywalking.apm.plugin.shardingsphere.v41.threadlocal.ContextThreadLocal;\n+\n+/**\n+ * {@link ExecuteInterceptor} enhances.\n+ * creating a local span that records the execution of sql.\n+ */\n+public class ExecuteInterceptor implements InstanceMethodsAroundInterceptor {", "originalCommit": "72b0ede025f30ec20ebd89741509a396b5e37f02", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ5OTQwOQ==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438499409", "bodyText": "i will  fix it.", "author": "yu199195", "createdAt": "2020-06-11T01:52:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA5NTYwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA5NTg3NA==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438095874", "bodyText": "Same here, besides the comment.", "author": "wu-sheng", "createdAt": "2020-06-10T12:50:50Z", "path": "apm-sniffer/apm-sdk-plugin/sharding-sphere-4.1.0-plugin/src/main/java/org/apache/skywalking/apm/plugin/shardingsphere/v41/JDBCRootInvokeInterceptor.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.shardingsphere.v41;\n+\n+import java.lang.reflect.Method;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+import org.apache.skywalking.apm.plugin.shardingsphere.v41.threadlocal.ContextThreadLocal;\n+\n+/**\n+ * {@link JDBCRootInvokeInterceptor} enhances {@link org.apache.shardingsphere.shardingjdbc.executor.AbstractStatementExecutor},\n+ * creating a local span that records the overall execution of sql.\n+ */\n+public class JDBCRootInvokeInterceptor implements InstanceMethodsAroundInterceptor {", "originalCommit": "72b0ede025f30ec20ebd89741509a396b5e37f02", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA5NTk3MQ==", "url": "https://github.com/apache/skywalking/pull/4894#discussion_r438095971", "bodyText": "Same here.", "author": "wu-sheng", "createdAt": "2020-06-10T12:51:00Z", "path": "apm-sniffer/apm-sdk-plugin/sharding-sphere-4.1.0-plugin/src/main/java/org/apache/skywalking/apm/plugin/shardingsphere/v41/ParseInterceptor.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.shardingsphere.v41;\n+\n+import java.lang.reflect.Method;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+\n+/**\n+ * {@link ParseInterceptor} enhances {@link org.apache.shardingsphere.sql.parser.SQLParserEngine}.\n+ * creating a local span that records the parse of sql.\n+ */\n+public class ParseInterceptor implements InstanceMethodsAroundInterceptor {", "originalCommit": "72b0ede025f30ec20ebd89741509a396b5e37f02", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "69b4ed92a33476e237622660a07f3c5787ee3ecc", "url": "https://github.com/apache/skywalking/commit/69b4ed92a33476e237622660a07f3c5787ee3ecc", "message": "fix some advice by wusheng.", "committedDate": "2020-06-11T01:59:47Z", "type": "commit"}, {"oid": "c553c1615b5b0e78a9b424e02c55eb92b8036c7e", "url": "https://github.com/apache/skywalking/commit/c553c1615b5b0e78a9b424e02c55eb92b8036c7e", "message": "Merge remote-tracking branch 'origin/ss-4.1.0' into ss-4.1.0", "committedDate": "2020-06-11T02:01:09Z", "type": "commit"}, {"oid": "40a88fcab68b7fe7ded05dceeb86fdaca6e64bb5", "url": "https://github.com/apache/skywalking/commit/40a88fcab68b7fe7ded05dceeb86fdaca6e64bb5", "message": "modify apache ShardingSphere support version.", "committedDate": "2020-06-11T02:55:42Z", "type": "commit"}, {"oid": "e19e506f5313acd38f72a3e113e3cea6db2eff9c", "url": "https://github.com/apache/skywalking/commit/e19e506f5313acd38f72a3e113e3cea6db2eff9c", "message": "Merge branch 'master' into ss-4.1.0", "committedDate": "2020-06-11T03:28:25Z", "type": "commit"}, {"oid": "29adae690d2c4ec4544ea04c006dc2984d9bfa93", "url": "https://github.com/apache/skywalking/commit/29adae690d2c4ec4544ea04c006dc2984d9bfa93", "message": "Changes add Apache ShardingSphere(4.0.0, 4.1.1) agent plugin provided.", "committedDate": "2020-06-11T03:49:17Z", "type": "commit"}, {"oid": "89d2dd2139f1e64e560c797ace1b72153bf9d95e", "url": "https://github.com/apache/skywalking/commit/89d2dd2139f1e64e560c797ace1b72153bf9d95e", "message": "Merge remote-tracking branch 'origin/ss-4.1.0' into ss-4.1.0", "committedDate": "2020-06-11T03:50:03Z", "type": "commit"}]}