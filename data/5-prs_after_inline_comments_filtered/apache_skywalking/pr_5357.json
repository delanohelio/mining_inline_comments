{"pr_number": 5357, "pr_title": "JsonLogger implementation (#5356)", "pr_createdAt": "2020-08-20T02:39:03Z", "pr_url": "https://github.com/apache/skywalking/pull/5357", "timeline": [{"oid": "a59682b1e2e3bf8c2a4701d79f8461320eb7f631", "url": "https://github.com/apache/skywalking/commit/a59682b1e2e3bf8c2a4701d79f8461320eb7f631", "message": "add json logger", "committedDate": "2020-08-26T01:51:32Z", "type": "commit"}, {"oid": "3385a2fc15e305df8a23ce6fad6090c83ffef5ff", "url": "https://github.com/apache/skywalking/commit/3385a2fc15e305df8a23ce6fad6090c83ffef5ff", "message": "add unit test", "committedDate": "2020-08-26T01:51:36Z", "type": "commit"}, {"oid": "f1b8d92701e29bc73b03a957ff0f25466edf5328", "url": "https://github.com/apache/skywalking/commit/f1b8d92701e29bc73b03a957ff0f25466edf5328", "message": "catch illegal logger exception", "committedDate": "2020-08-26T01:51:36Z", "type": "commit"}, {"oid": "ba9fd9924ac3eedfe1757c6cd371a205a4e529e4", "url": "https://github.com/apache/skywalking/commit/ba9fd9924ac3eedfe1757c6cd371a205a4e529e4", "message": "add test for agent", "committedDate": "2020-08-26T01:51:36Z", "type": "commit"}, {"oid": "210a69aaba1efff5eb6aae86ca21e419ab893313", "url": "https://github.com/apache/skywalking/commit/210a69aaba1efff5eb6aae86ca21e419ab893313", "message": "fix style issues", "committedDate": "2020-08-26T01:51:36Z", "type": "commit"}, {"oid": "e8b17290499ef6d9f8754ff5842df52d55862013", "url": "https://github.com/apache/skywalking/commit/e8b17290499ef6d9f8754ff5842df52d55862013", "message": "use ConfigInitializer", "committedDate": "2020-08-26T01:53:11Z", "type": "commit"}, {"oid": "9be6e96b1cc6506828932ce2f87fe448e808b327", "url": "https://github.com/apache/skywalking/commit/9be6e96b1cc6506828932ce2f87fe448e808b327", "message": "add benchmark", "committedDate": "2020-08-26T01:53:14Z", "type": "commit"}, {"oid": "dbe4d32684cd111331b3fa594af5611b6adda686", "url": "https://github.com/apache/skywalking/commit/dbe4d32684cd111331b3fa594af5611b6adda686", "message": "init logger in SnifferConfigInitializer", "committedDate": "2020-08-26T01:54:52Z", "type": "commit"}, {"oid": "d845b7300879fb8701c802b28c591b0f44ba4b51", "url": "https://github.com/apache/skywalking/commit/d845b7300879fb8701c802b28c591b0f44ba4b51", "message": "refactor AbstractLogger", "committedDate": "2020-08-26T01:54:53Z", "type": "commit"}, {"oid": "fe9e5f8f77129199bab9afe0d29c69040745ad5b", "url": "https://github.com/apache/skywalking/commit/fe9e5f8f77129199bab9afe0d29c69040745ad5b", "message": "revert logger name", "committedDate": "2020-08-26T01:54:53Z", "type": "commit"}, {"oid": "42c8a75e153872e478a3620b1af5f76dc56742a8", "url": "https://github.com/apache/skywalking/commit/42c8a75e153872e478a3620b1af5f76dc56742a8", "message": "use RESOLVER instead of LOGGER", "committedDate": "2020-08-26T01:54:53Z", "type": "commit"}, {"oid": "5db8be15c0005e270039f2987d1e7dd273019801", "url": "https://github.com/apache/skywalking/commit/5db8be15c0005e270039f2987d1e7dd273019801", "message": "add benchmark result", "committedDate": "2020-08-26T01:54:53Z", "type": "commit"}, {"oid": "c2ff5d706b0c1a3f8c498ea26b7976c9f744f289", "url": "https://github.com/apache/skywalking/commit/c2ff5d706b0c1a3f8c498ea26b7976c9f744f289", "message": "refactor interface not to use default method for getKey()", "committedDate": "2020-08-26T01:54:53Z", "type": "commit"}, {"oid": "c6c3e8b9f8b4bb6780c817eb0a17ff8fcee21f8b", "url": "https://github.com/apache/skywalking/commit/c6c3e8b9f8b4bb6780c817eb0a17ff8fcee21f8b", "message": "separate try/catch/finally for SnifferConfigInitializer.initializeCoreConfig", "committedDate": "2020-08-26T01:54:53Z", "type": "commit"}, {"oid": "d3625fb942804ad330036f32db483fd87bc26a57", "url": "https://github.com/apache/skywalking/commit/d3625fb942804ad330036f32db483fd87bc26a57", "message": "polish", "committedDate": "2020-08-26T01:54:53Z", "type": "commit"}, {"oid": "96c92eae89f6e1d2d667d883d9da5c4f095ec718", "url": "https://github.com/apache/skywalking/commit/96c92eae89f6e1d2d667d883d9da5c4f095ec718", "message": "fix LOGGER style after rebase master", "committedDate": "2020-08-26T02:14:38Z", "type": "commit"}, {"oid": "1b24bbef7e3673c0b8504782cd9ba5526168b19f", "url": "https://github.com/apache/skywalking/commit/1b24bbef7e3673c0b8504782cd9ba5526168b19f", "message": "improve style", "committedDate": "2020-08-26T02:18:46Z", "type": "commit"}, {"oid": "8b600d2a7ac32191373068043133f9e1191fb0f6", "url": "https://github.com/apache/skywalking/commit/8b600d2a7ac32191373068043133f9e1191fb0f6", "message": "improve code format", "committedDate": "2020-08-26T02:19:14Z", "type": "commit"}, {"oid": "61614375052f07c6030d50ca0768e2ef1c4d7f8d", "url": "https://github.com/apache/skywalking/commit/61614375052f07c6030d50ca0768e2ef1c4d7f8d", "message": "re-throw exception if creating converter fails", "committedDate": "2020-08-26T02:22:24Z", "type": "commit"}, {"oid": "b94b80bd7166bc2aa78d25410cdbe6f6c51c9571", "url": "https://github.com/apache/skywalking/commit/b94b80bd7166bc2aa78d25410cdbe6f6c51c9571", "message": "Merge branch 'master' into master", "committedDate": "2020-08-26T02:24:49Z", "type": "commit"}, {"oid": "c0cfa7311d436715976641d9a023194de922406f", "url": "https://github.com/apache/skywalking/commit/c0cfa7311d436715976641d9a023194de922406f", "message": "remove configuration for json logger", "committedDate": "2020-08-26T02:51:54Z", "type": "commit"}, {"oid": "ca9e321be6f576e8a2fb23c4bcc6707d7b77ba35", "url": "https://github.com/apache/skywalking/commit/ca9e321be6f576e8a2fb23c4bcc6707d7b77ba35", "message": "fix test", "committedDate": "2020-08-26T02:55:41Z", "type": "commit"}, {"oid": "ee7dd0fae63c794e21e86a1ed523f2ac9373edae", "url": "https://github.com/apache/skywalking/commit/ee7dd0fae63c794e21e86a1ed523f2ac9373edae", "message": "add docs", "committedDate": "2020-08-26T03:19:05Z", "type": "commit"}, {"oid": "2f48ca0e9102f9fc0a684a821f7473d2def7e792", "url": "https://github.com/apache/skywalking/commit/2f48ca0e9102f9fc0a684a821f7473d2def7e792", "message": "Merge branch 'master' into master", "committedDate": "2020-08-26T05:23:13Z", "type": "commit"}, {"oid": "970364d996214a4a230ff489bef0c8edc7d06f93", "url": "https://github.com/apache/skywalking/commit/970364d996214a4a230ff489bef0c8edc7d06f93", "message": "Merge branch 'master' into master", "committedDate": "2020-08-26T08:49:53Z", "type": "commit"}, {"oid": "f3009c39d3fca70e1cba217b11502f0144b26da0", "url": "https://github.com/apache/skywalking/commit/f3009c39d3fca70e1cba217b11502f0144b26da0", "message": "Merge branch 'master' into master", "committedDate": "2020-08-26T15:35:56Z", "type": "commit"}, {"oid": "c0dab0008fa9494e5bc3bfa723d05036aa095a26", "url": "https://github.com/apache/skywalking/commit/c0dab0008fa9494e5bc3bfa723d05036aa095a26", "message": "Merge branch 'master' into master", "committedDate": "2020-08-26T15:51:13Z", "type": "commit"}, {"oid": "3c8390cfad1ea86e5d7a893af9debac4afeea029", "url": "https://github.com/apache/skywalking/commit/3c8390cfad1ea86e5d7a893af9debac4afeea029", "message": "Merge branch 'master' into master", "committedDate": "2020-08-28T06:28:26Z", "type": "commit"}, {"oid": "7658d69e41460d181b2448dc64e2aae4216874f4", "url": "https://github.com/apache/skywalking/commit/7658d69e41460d181b2448dc64e2aae4216874f4", "message": "fix wrong key issue", "committedDate": "2020-08-28T08:32:48Z", "type": "commit"}, {"oid": "121db31f481ab77e7fb884f023a1524bf9c71951", "url": "https://github.com/apache/skywalking/commit/121db31f481ab77e7fb884f023a1524bf9c71951", "message": "move jmh-annotation-processor to dependencyManagement", "committedDate": "2020-08-28T09:38:15Z", "type": "commit"}, {"oid": "5eff29e091211351dca57f1c3fc8f351083a875e", "url": "https://github.com/apache/skywalking/commit/5eff29e091211351dca57f1c3fc8f351083a875e", "message": "explicitly exclude generated benchmarks", "committedDate": "2020-08-28T10:02:00Z", "type": "commit"}, {"oid": "15a976445378b36a77a0549bad949a9e4d443ecf", "url": "https://github.com/apache/skywalking/commit/15a976445378b36a77a0549bad949a9e4d443ecf", "message": "Merge branch 'master' into master", "committedDate": "2020-08-28T14:27:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTM3NjkwNA==", "url": "https://github.com/apache/skywalking/pull/5357#discussion_r479376904", "bodyText": "Add comments for this.", "author": "wu-sheng", "createdAt": "2020-08-28T15:26:16Z", "path": "apm-sniffer/apm-agent/src/main/java/org/apache/skywalking/apm/agent/SkyWalkingAgent.java", "diffHunk": "@@ -62,7 +63,15 @@ public static void premain(String agentArgs, Instrumentation instrumentation) th\n         final PluginFinder pluginFinder;\n         try {\n             SnifferConfigInitializer.initializeCoreConfig(agentArgs);\n+        } catch (Exception e) {\n+            LogManager.getLogger(SkyWalkingAgent.class)\n+                    .error(e, \"SkyWalking agent initialized failure. Shutting down.\");\n+            return;\n+        } finally {\n+            LOGGER = LogManager.getLogger(SkyWalkingAgent.class);", "originalCommit": "15a976445378b36a77a0549bad949a9e4d443ecf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTM5MTczMg==", "url": "https://github.com/apache/skywalking/pull/5357#discussion_r479391732", "bodyText": "Added", "author": "lujiajing1126", "createdAt": "2020-08-28T15:52:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTM3NjkwNA=="}], "type": "inlineReview"}, {"oid": "7a90ce66ee5542cbc97be3fce9a5598a0cf5825a", "url": "https://github.com/apache/skywalking/commit/7a90ce66ee5542cbc97be3fce9a5598a0cf5825a", "message": "change order of exclude rules", "committedDate": "2020-08-28T15:43:15Z", "type": "commit"}, {"oid": "ed2bd6df8112406bcfd6bc186dc50b752d1baf3b", "url": "https://github.com/apache/skywalking/commit/ed2bd6df8112406bcfd6bc186dc50b752d1baf3b", "message": "add comment for agent", "committedDate": "2020-08-28T15:52:19Z", "type": "commit"}, {"oid": "50346fdd7709a77cb3fb9c5285bcef6abe613ff2", "url": "https://github.com/apache/skywalking/commit/50346fdd7709a77cb3fb9c5285bcef6abe613ff2", "message": "Merge branch 'master' into master", "committedDate": "2020-08-29T07:30:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTYyMDMxNA==", "url": "https://github.com/apache/skywalking/pull/5357#discussion_r479620314", "bodyText": "Could you recheck, whether we are going to use timestamp or @timestamp.", "author": "wu-sheng", "createdAt": "2020-08-29T07:34:30Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/logging/core/JsonLogger.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.logging.core;\n+\n+import com.google.gson.Gson;\n+import org.apache.skywalking.apm.agent.core.logging.core.converters.LiteralConverter;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+/**\n+ * An alternative logger for the SkyWalking agent. The default layout is\n+ * {\n+ *     \"timestamp\": \"\", // timestamp", "originalCommit": "50346fdd7709a77cb3fb9c5285bcef6abe613ff2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTYyMjQ4OA==", "url": "https://github.com/apache/skywalking/pull/5357#discussion_r479622488", "bodyText": "A typo here. Should be @timestamp. Fixed", "author": "lujiajing1126", "createdAt": "2020-08-29T07:49:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTYyMDMxNA=="}], "type": "inlineReview"}, {"oid": "ed94bc706d0898d6dcfe1fb3c14d53a8c6117d2d", "url": "https://github.com/apache/skywalking/commit/ed94bc706d0898d6dcfe1fb3c14d53a8c6117d2d", "message": "remove version of jmh-generator-annprocess as dep management is used", "committedDate": "2020-08-29T07:48:04Z", "type": "commit"}, {"oid": "5369d54b68202a22f2a01064c702b2d0caa32f2c", "url": "https://github.com/apache/skywalking/commit/5369d54b68202a22f2a01064c702b2d0caa32f2c", "message": "Merge branch 'master' of github.com:lujiajing1126/skywalking into master", "committedDate": "2020-08-29T07:48:32Z", "type": "commit"}, {"oid": "adc88c982712c9881eb9970ac9ea08813d361294", "url": "https://github.com/apache/skywalking/commit/adc88c982712c9881eb9970ac9ea08813d361294", "message": "fix typo", "committedDate": "2020-08-29T07:49:22Z", "type": "commit"}, {"oid": "44f4a7ebc8d4b666108a1d38c77cf55ebb3a190c", "url": "https://github.com/apache/skywalking/commit/44f4a7ebc8d4b666108a1d38c77cf55ebb3a190c", "message": "update agent settings docs", "committedDate": "2020-08-29T07:59:11Z", "type": "commit"}, {"oid": "81ffebdbef41f35ccc69630e2795170e03d481b5", "url": "https://github.com/apache/skywalking/commit/81ffebdbef41f35ccc69630e2795170e03d481b5", "message": "add necessary jmh processor to all modules containing Benchmark codes. And generally exclude jmh generated classes", "committedDate": "2020-08-29T08:31:01Z", "type": "commit"}, {"oid": "f146b120d34d9a1a68c175e96ccedecfae5d02eb", "url": "https://github.com/apache/skywalking/commit/f146b120d34d9a1a68c175e96ccedecfae5d02eb", "message": "Update docs/en/setup/service-agent/java-agent/README.md\n\nCo-authored-by: \u5434\u665f Wu Sheng <wu.sheng@foxmail.com>", "committedDate": "2020-08-29T09:51:39Z", "type": "commit"}, {"oid": "79391aeca4409352c7dc4b145a23182141634b85", "url": "https://github.com/apache/skywalking/commit/79391aeca4409352c7dc4b145a23182141634b85", "message": "check every output in PatterLoggerTest", "committedDate": "2020-08-29T10:51:33Z", "type": "commit"}, {"oid": "4ce3cf927d2b8d9eb31303a72fba6961a4ec8543", "url": "https://github.com/apache/skywalking/commit/4ce3cf927d2b8d9eb31303a72fba6961a4ec8543", "message": "use LogMatch to do the test", "committedDate": "2020-08-29T13:08:39Z", "type": "commit"}, {"oid": "985098c6c97749a0923700ade38bda5b785fe7b8", "url": "https://github.com/apache/skywalking/commit/985098c6c97749a0923700ade38bda5b785fe7b8", "message": "fix style issues", "committedDate": "2020-08-29T13:12:34Z", "type": "commit"}]}