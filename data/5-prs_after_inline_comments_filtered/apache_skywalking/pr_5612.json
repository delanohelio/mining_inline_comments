{"pr_number": 5612, "pr_title": "fix INEFFICIENT_KEYSET_ITERATOR", "pr_createdAt": "2020-10-01T02:20:43Z", "pr_url": "https://github.com/apache/skywalking/pull/5612", "timeline": [{"oid": "e3db3e2f3e3b60f5bdab92766447b20b280368d2", "url": "https://github.com/apache/skywalking/commit/e3db3e2f3e3b60f5bdab92766447b20b280368d2", "message": "fix INEFFICIENT_KEYSET_ITERATOR", "committedDate": "2020-10-01T02:17:22Z", "type": "commit"}, {"oid": "00e76028913ff6d6b082fe8e7f045bf4796767f9", "url": "https://github.com/apache/skywalking/commit/00e76028913ff6d6b082fe8e7f045bf4796767f9", "message": "fix code style issue.", "committedDate": "2020-10-04T03:05:59Z", "type": "commit"}, {"oid": "a10062536bba60ceabb677e1cacf251d73eb4b62", "url": "https://github.com/apache/skywalking/commit/a10062536bba60ceabb677e1cacf251d73eb4b62", "message": "Merge branch 'master' into fix-INEFFICIENT_KEYSET_ITERATOR", "committedDate": "2020-10-04T03:22:09Z", "type": "commit"}, {"oid": "cf2cf8db9a5b358c74e285bde8da4d4789fca1f2", "url": "https://github.com/apache/skywalking/commit/cf2cf8db9a5b358c74e285bde8da4d4789fca1f2", "message": "Merge branch 'master' into fix-INEFFICIENT_KEYSET_ITERATOR", "committedDate": "2020-10-06T10:03:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI5MTk4Nw==", "url": "https://github.com/apache/skywalking/pull/5612#discussion_r500291987", "bodyText": "Well, I'm late for just a second \ud83e\udd23 but this doesn't fix what you said in the comment\n\nAccessing a value using a key that was retrieved from a keySet iterator. It is more efficient to use an iterator on the entrySet of the map, avoiding the extra HashMap.get(key) lookup.\n\n\"avoiding the extra HashMap.get(key) lookup.\", you are still looking up with the key, should replace logs.get(entries.getKey()) entries.getValue()", "author": "kezhenxu94", "createdAt": "2020-10-06T13:46:13Z", "path": "apm-sniffer/optional-plugins/customize-enhance-plugin/src/main/java/org/apache/skywalking/apm/plugin/customize/interceptor/BaseInterceptorMethods.java", "diffHunk": "@@ -56,15 +56,14 @@ void beforeMethod(Method method, Object[] allArguments) {\n                     }\n                 }\n                 if (tags != null && !tags.isEmpty()) {\n-                    for (String key : tags.keySet()) {\n-                        String expression = tags.get(key);\n-                        spanTags.put(key, CustomizeExpression.parseExpression(expression, context));\n+                    for (Map.Entry<String, String> expression: tags.entrySet()) {\n+                        spanTags.put(expression.getKey(), CustomizeExpression.parseExpression(expression.getValue(), context));\n                     }\n                 }\n                 if (logs != null && !logs.isEmpty()) {\n-                    for (String key : logs.keySet()) {\n-                        String expression = logs.get(key);\n-                        spanLogs.put(key, CustomizeExpression.parseExpression(expression, context));\n+                    for (Map.Entry<String, String> entries : logs.entrySet()) {\n+                        String expression = logs.get(entries.getKey());", "originalCommit": "cf2cf8db9a5b358c74e285bde8da4d4789fca1f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI5MzcxMA==", "url": "https://github.com/apache/skywalking/pull/5612#discussion_r500293710", "bodyText": "Seems so, just clicked the merge. Anyway, no real harm, if you want, submit a pull request to fix again.", "author": "wu-sheng", "createdAt": "2020-10-06T13:48:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI5MTk4Nw=="}], "type": "inlineReview"}]}