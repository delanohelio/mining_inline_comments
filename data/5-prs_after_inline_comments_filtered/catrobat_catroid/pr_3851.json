{"pr_number": 3851, "pr_title": "CATROID-734 Update Design for Terms of Use and Service", "pr_createdAt": "2020-10-29T10:42:31Z", "pr_url": "https://github.com/Catrobat/Catroid/pull/3851", "timeline": [{"oid": "dd4fed0e808c1507d640fe15d1b6980c2015b630", "url": "https://github.com/Catrobat/Catroid/commit/dd4fed0e808c1507d640fe15d1b6980c2015b630", "message": "CATROID-734 Update Design for Terms of Use and Service", "committedDate": "2020-10-29T11:12:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUzMjMyNg==", "url": "https://github.com/Catrobat/Catroid/pull/3851#discussion_r514532326", "bodyText": "Please outsource this to an extra method (e.g. showTermsOfUseDialog()) in order to keep the onCreate() method compact.", "author": "mstoeg", "createdAt": "2020-10-29T20:04:02Z", "path": "catroid/src/main/java/org/catrobat/catroid/ui/MainMenuActivity.java", "diffHunk": "@@ -87,28 +89,54 @@ protected void onCreate(Bundle savedInstanceState) {\n \t\tPreferenceManager.setDefaultValues(this, R.xml.preferences, true);\n \t\tScreenValueHandler.updateScreenWidthAndHeight(this);\n \n-\t\tint oldPrivacyPolicyHash = PreferenceManager.getDefaultSharedPreferences(this)\n+\t\tint oldPrivacyPolicy = PreferenceManager.getDefaultSharedPreferences(this)\n \t\t\t\t\t\t.getInt(AGREED_TO_PRIVACY_POLICY_VERSION, 0);\n-\t\tint currentPrivacyPolicyHash = getResources().getString(R.string.dialog_privacy_policy_text)\n-\t\t\t\t\t\t.hashCode();\n-\t\tif (oldPrivacyPolicyHash == currentPrivacyPolicyHash) {\n+\n+\t\tif (oldPrivacyPolicy == Constants.CATROBAT_TERMS_OF_USE_ACCEPTED) {\n \t\t\tloadContent();\n \t\t} else {\n-\t\t\tsetContentView(R.layout.privacy_policy_view);\n+\t\t\tView view = View.inflate(this, R.layout.privacy_policy_view, null);", "originalCommit": "dd4fed0e808c1507d640fe15d1b6980c2015b630", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUzMjkwNw==", "url": "https://github.com/Catrobat/Catroid/pull/3851#discussion_r514532907", "bodyText": "Please use lambda-expressions here. They should be suggested by Android Studio automatically.", "author": "mstoeg", "createdAt": "2020-10-29T20:04:49Z", "path": "catroid/src/main/java/org/catrobat/catroid/ui/MainMenuActivity.java", "diffHunk": "@@ -87,28 +89,54 @@ protected void onCreate(Bundle savedInstanceState) {\n \t\tPreferenceManager.setDefaultValues(this, R.xml.preferences, true);\n \t\tScreenValueHandler.updateScreenWidthAndHeight(this);\n \n-\t\tint oldPrivacyPolicyHash = PreferenceManager.getDefaultSharedPreferences(this)\n+\t\tint oldPrivacyPolicy = PreferenceManager.getDefaultSharedPreferences(this)\n \t\t\t\t\t\t.getInt(AGREED_TO_PRIVACY_POLICY_VERSION, 0);\n-\t\tint currentPrivacyPolicyHash = getResources().getString(R.string.dialog_privacy_policy_text)\n-\t\t\t\t\t\t.hashCode();\n-\t\tif (oldPrivacyPolicyHash == currentPrivacyPolicyHash) {\n+\n+\t\tif (oldPrivacyPolicy == Constants.CATROBAT_TERMS_OF_USE_ACCEPTED) {\n \t\t\tloadContent();\n \t\t} else {\n-\t\t\tsetContentView(R.layout.privacy_policy_view);\n+\t\t\tView view = View.inflate(this, R.layout.privacy_policy_view, null);\n+\n+\t\t\tTextView termsOfUseUrlTextView = view.findViewById(R.id.dialog_privacy_policy_text_view_url);\n+\n+\t\t\ttermsOfUseUrlTextView.setMovementMethod(LinkMovementMethod.getInstance());\n+\n+\t\t\tString termsOfUseUrlStringText = getString(R.string.main_menu_terms_of_use);\n+\n+\t\t\tString termsOfUseUrl = getString(R.string.terms_of_use_link_template, Constants.CATROBAT_TERMS_OF_USE_URL\n+\t\t\t\t\t\t\t+ Constants.CATROBAT_TERMS_OF_USE_TOKEN_FLAVOR_URL + BuildConfig.FLAVOR\n+\t\t\t\t\t\t\t+ Constants.CATROBAT_TERMS_OF_USE_TOKEN_VERSION_URL + BuildConfig.VERSION_CODE,\n+\t\t\t\t\t\t\ttermsOfUseUrlStringText);\n+\n+\t\t\ttermsOfUseUrlTextView.setText(Html.fromHtml(termsOfUseUrl));\n+\n+\t\t\tnew AlertDialog.Builder(this)\n+\t\t\t\t\t.setNegativeButton(R.string.decline, new DialogInterface.OnClickListener() {", "originalCommit": "dd4fed0e808c1507d640fe15d1b6980c2015b630", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f385cca4b0c4ada32c218ae81559142836b75987", "url": "https://github.com/Catrobat/Catroid/commit/f385cca4b0c4ada32c218ae81559142836b75987", "message": "CATROID-734 Update Design for Terms of Use and Service", "committedDate": "2020-10-30T21:59:27Z", "type": "forcePushed"}, {"oid": "303f908c5c380f359f6d89d91a7e2d5ffb664fc3", "url": "https://github.com/Catrobat/Catroid/commit/303f908c5c380f359f6d89d91a7e2d5ffb664fc3", "message": "CATROID-734 Update Design for Terms of Use and Service", "committedDate": "2020-11-17T14:48:12Z", "type": "forcePushed"}, {"oid": "abf52e0fd9d925bd594617bec7a459ab5dfae913", "url": "https://github.com/Catrobat/Catroid/commit/abf52e0fd9d925bd594617bec7a459ab5dfae913", "message": "CATROID-734 Update Design for Terms of Use and Service", "committedDate": "2020-11-21T20:59:24Z", "type": "commit"}, {"oid": "abf52e0fd9d925bd594617bec7a459ab5dfae913", "url": "https://github.com/Catrobat/Catroid/commit/abf52e0fd9d925bd594617bec7a459ab5dfae913", "message": "CATROID-734 Update Design for Terms of Use and Service", "committedDate": "2020-11-21T20:59:24Z", "type": "forcePushed"}]}