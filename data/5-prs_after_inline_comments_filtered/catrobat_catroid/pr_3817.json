{"pr_number": 3817, "pr_title": "CATROID-724 Create new project dialog", "pr_createdAt": "2020-09-23T20:21:25Z", "pr_url": "https://github.com/Catrobat/Catroid/pull/3817", "timeline": [{"oid": "b2cdcaecb7fd684888657b5672374aa5c024b560", "url": "https://github.com/Catrobat/Catroid/commit/b2cdcaecb7fd684888657b5672374aa5c024b560", "message": "CATROID-724 Create new project dialog", "committedDate": "2020-09-23T20:57:07Z", "type": "forcePushed"}, {"oid": "0ec0ea680ad21bf75c1030d6428917b8d79d1a19", "url": "https://github.com/Catrobat/Catroid/commit/0ec0ea680ad21bf75c1030d6428917b8d79d1a19", "message": "CATROID-724 Create new project dialog", "committedDate": "2020-09-23T21:34:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE4NjI0Mg==", "url": "https://github.com/Catrobat/Catroid/pull/3817#discussion_r494186242", "bodyText": "Simply write exampleProject = exampleProjectSwicth.isChecked() to simplify this if/else. Or remove the variable entirely and use it directly in the function call of createProject().", "author": "mstoeg", "createdAt": "2020-09-24T09:53:09Z", "path": "catroid/src/main/java/org/catrobat/catroid/ui/recyclerview/dialog/NewProjectDialogFragment.java", "diffHunk": "@@ -40,79 +40,96 @@\n \n import androidx.fragment.app.DialogFragment;\n \n-import static org.catrobat.catroid.common.DefaultProjectHandler.ProjectCreatorType.PROJECT_CREATOR_DRONE;\n-import static org.catrobat.catroid.common.DefaultProjectHandler.ProjectCreatorType.PROJECT_CREATOR_JUMPING_SUMO;\n+import static org.catrobat.catroid.common.DefaultProjectHandler.ProjectCreatorType.PROJECT_CREATOR_DEFAULT;\n+import static org.catrobat.catroid.common.DefaultProjectHandler.ProjectCreatorType.PROJECT_CREATOR_CAST;\n \n public class NewProjectDialogFragment extends DialogFragment {\n \n \tpublic static final String TAG = NewProjectDialogFragment.class.getSimpleName();\n \n+\tprivate boolean exampleProject;\n+\tprivate boolean castProject;\n+\tprivate boolean landscape;\n+\n \t@Override\n \tpublic Dialog onCreateDialog(Bundle savedInstanceState) {\n \t\tView view = View.inflate(getActivity(), R.layout.dialog_new_project, null);\n \n \t\tfinal RadioGroup radioGroup = view.findViewById(R.id.radio_group);\n+\t\tfinal Switch exampleProjectSwitch = view.findViewById(R.id.example_project_switch);\n \n-\t\tif (SettingsFragment.isDroneSharedPreferenceEnabled(getContext())) {\n-\t\t\tview.findViewById(R.id.project_default_drone_radio_button).setVisibility(View.VISIBLE);\n-\t\t}\n-\n-\t\tif (JumpingSumoServiceWrapper.isJumpingSumoSharedPreferenceEnabled()) {\n-\t\t\tview.findViewById(R.id.project_default_jumping_sumo_radio_button).setVisibility(View.VISIBLE);\n+\t\tif (SettingsFragment.isCastSharedPreferenceEnabled(getActivity())) {\n+\t\t\tview.findViewById(R.id.cast).setVisibility(View.VISIBLE);\n \t\t}\n \n \t\tTextInputDialog.Builder builder = new TextInputDialog.Builder(getContext())\n \t\t\t\t.setHint(getString(R.string.project_name_label))\n+\t\t\t\t.setText(getUniqueDefaultProjectName())\n \t\t\t\t.setTextWatcher(new NewProjectNameTextWatcher<>())\n \t\t\t\t.setPositiveButton(getString(R.string.ok), (TextInputDialog.OnClickListener) (dialog, textInput) -> {\n+\t\t\t\t\tif (exampleProjectSwitch.isChecked()) {\n+\t\t\t\t\t\texampleProject = true;\n+\t\t\t\t\t} else {\n+\t\t\t\t\t\texampleProject = false;\n+\t\t\t\t\t}", "originalCommit": "0ec0ea680ad21bf75c1030d6428917b8d79d1a19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE5Mzg4Ng==", "url": "https://github.com/Catrobat/Catroid/pull/3817#discussion_r494193886", "bodyText": "Please have a look at the UniqueNameProvider class. Getting a unique name with ascending values is already implemented there. Use something like return new UniqueNameProvider(default_project_name, listOfProjectNames).", "author": "mstoeg", "createdAt": "2020-09-24T10:05:49Z", "path": "catroid/src/main/java/org/catrobat/catroid/ui/recyclerview/dialog/NewProjectDialogFragment.java", "diffHunk": "@@ -40,79 +40,96 @@\n \n import androidx.fragment.app.DialogFragment;\n \n-import static org.catrobat.catroid.common.DefaultProjectHandler.ProjectCreatorType.PROJECT_CREATOR_DRONE;\n-import static org.catrobat.catroid.common.DefaultProjectHandler.ProjectCreatorType.PROJECT_CREATOR_JUMPING_SUMO;\n+import static org.catrobat.catroid.common.DefaultProjectHandler.ProjectCreatorType.PROJECT_CREATOR_DEFAULT;\n+import static org.catrobat.catroid.common.DefaultProjectHandler.ProjectCreatorType.PROJECT_CREATOR_CAST;\n \n public class NewProjectDialogFragment extends DialogFragment {\n \n \tpublic static final String TAG = NewProjectDialogFragment.class.getSimpleName();\n \n+\tprivate boolean exampleProject;\n+\tprivate boolean castProject;\n+\tprivate boolean landscape;\n+\n \t@Override\n \tpublic Dialog onCreateDialog(Bundle savedInstanceState) {\n \t\tView view = View.inflate(getActivity(), R.layout.dialog_new_project, null);\n \n \t\tfinal RadioGroup radioGroup = view.findViewById(R.id.radio_group);\n+\t\tfinal Switch exampleProjectSwitch = view.findViewById(R.id.example_project_switch);\n \n-\t\tif (SettingsFragment.isDroneSharedPreferenceEnabled(getContext())) {\n-\t\t\tview.findViewById(R.id.project_default_drone_radio_button).setVisibility(View.VISIBLE);\n-\t\t}\n-\n-\t\tif (JumpingSumoServiceWrapper.isJumpingSumoSharedPreferenceEnabled()) {\n-\t\t\tview.findViewById(R.id.project_default_jumping_sumo_radio_button).setVisibility(View.VISIBLE);\n+\t\tif (SettingsFragment.isCastSharedPreferenceEnabled(getActivity())) {\n+\t\t\tview.findViewById(R.id.cast).setVisibility(View.VISIBLE);\n \t\t}\n \n \t\tTextInputDialog.Builder builder = new TextInputDialog.Builder(getContext())\n \t\t\t\t.setHint(getString(R.string.project_name_label))\n+\t\t\t\t.setText(getUniqueDefaultProjectName())\n \t\t\t\t.setTextWatcher(new NewProjectNameTextWatcher<>())\n \t\t\t\t.setPositiveButton(getString(R.string.ok), (TextInputDialog.OnClickListener) (dialog, textInput) -> {\n+\t\t\t\t\tif (exampleProjectSwitch.isChecked()) {\n+\t\t\t\t\t\texampleProject = true;\n+\t\t\t\t\t} else {\n+\t\t\t\t\t\texampleProject = false;\n+\t\t\t\t\t}\n+\n \t\t\t\t\tswitch (radioGroup.getCheckedRadioButtonId()) {\n-\t\t\t\t\t\tcase R.id.project_empty_radio_button:\n-\t\t\t\t\t\t\tshowOrientationDialog(textInput, true);\n-\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\tcase R.id.project_default_radio_button:\n-\t\t\t\t\t\t\tshowOrientationDialog(textInput, false);\n+\t\t\t\t\t\tcase R.id.portrait:\n+\t\t\t\t\t\t\tlandscape = false;\n \t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\tcase R.id.project_default_drone_radio_button:\n-\t\t\t\t\t\t\tcreateARDroneProject(textInput);\n+\t\t\t\t\t\tcase R.id.landscape_mode:\n+\t\t\t\t\t\t\tlandscape = true;\n \t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\tcase R.id.project_default_jumping_sumo_radio_button:\n-\t\t\t\t\t\t\tcreateJumpingSumoProject(textInput);\n+\t\t\t\t\t\tcase R.id.cast:\n+\t\t\t\t\t\t\tcastProject = true;\n \t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\tdefault:\n \t\t\t\t\t\t\tthrow new IllegalStateException(TAG + \": No radio button id match, check layout?\");\n \t\t\t\t\t}\n+\n+\t\t\t\t\tcreateProject(textInput, landscape, exampleProject, castProject);\n \t\t\t\t});\n \n \t\treturn builder\n-\t\t\t\t.setTitle(R.string.new_project_dialog_title)\n \t\t\t\t.setView(view)\n \t\t\t\t.setNegativeButton(R.string.cancel, null)\n \t\t\t\t.create();\n \t}\n \n-\tvoid showOrientationDialog(String projectName, boolean createEmptyProject) {\n-\t\tOrientationDialogFragment\n-\t\t\t\t.newInstance(projectName, createEmptyProject)\n-\t\t\t\t.show(getFragmentManager(), OrientationDialogFragment.TAG);\n-\t}\n+\tpublic String getUniqueDefaultProjectName() {\n \n-\tvoid createARDroneProject(String name) {\n-\t\ttry {\n-\t\t\tProjectManager.getInstance()\n-\t\t\t\t\t.createNewExampleProject(name, getContext(), PROJECT_CREATOR_DRONE, false);\n-\t\t\tIntent intent = new Intent(getActivity(), ProjectActivity.class);\n-\t\t\tstartActivity(intent);\n-\t\t} catch (IOException e) {\n-\t\t\tToastUtil.showError(getActivity(), R.string.error_new_project);\n+\t\tfor (int i = 1; i < Integer.MAX_VALUE; i++) {", "originalCommit": "0ec0ea680ad21bf75c1030d6428917b8d79d1a19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjcwODIyMA==", "url": "https://github.com/Catrobat/Catroid/pull/3817#discussion_r502708220", "bodyText": "The UniqueNameProvider class does not match the required pattern for the name, it would return \"My project (1)\" instead of \"My project 1\".", "author": "dandrawes", "createdAt": "2020-10-09T23:13:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE5Mzg4Ng=="}], "type": "inlineReview"}, {"oid": "bc46af1c680e263f01244691090730064da48f22", "url": "https://github.com/Catrobat/Catroid/commit/bc46af1c680e263f01244691090730064da48f22", "message": "CATROID-724 Create new project dialog", "committedDate": "2020-10-09T23:08:23Z", "type": "forcePushed"}, {"oid": "34333a97f4337d007d7d35c49fc4008127c83c77", "url": "https://github.com/Catrobat/Catroid/commit/34333a97f4337d007d7d35c49fc4008127c83c77", "message": "CATROID-724 Create new project dialog", "committedDate": "2020-10-28T14:13:22Z", "type": "forcePushed"}, {"oid": "a781be461c42d452f7882b6c6328b8fc7c7b1a67", "url": "https://github.com/Catrobat/Catroid/commit/a781be461c42d452f7882b6c6328b8fc7c7b1a67", "message": "CATROID-724 Create new project dialog", "committedDate": "2020-10-28T14:38:50Z", "type": "commit"}, {"oid": "a781be461c42d452f7882b6c6328b8fc7c7b1a67", "url": "https://github.com/Catrobat/Catroid/commit/a781be461c42d452f7882b6c6328b8fc7c7b1a67", "message": "CATROID-724 Create new project dialog", "committedDate": "2020-10-28T14:38:50Z", "type": "forcePushed"}, {"oid": "cabfdad515a592539c5f2ad395981701fca74b93", "url": "https://github.com/Catrobat/Catroid/commit/cabfdad515a592539c5f2ad395981701fca74b93", "message": "No need for fabric b/c #3840", "committedDate": "2020-11-04T19:12:06Z", "type": "commit"}]}