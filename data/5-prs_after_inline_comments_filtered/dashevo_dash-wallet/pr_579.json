{"pr_number": 579, "pr_title": "Avatar Hash and Fingerprint", "pr_createdAt": "2020-12-17T11:23:51Z", "pr_url": "https://github.com/dashevo/dash-wallet/pull/579", "timeline": [{"oid": "48aaa41d12c7d640385449084ccb10f2850c7c0e", "url": "https://github.com/dashevo/dash-wallet/commit/48aaa41d12c7d640385449084ccb10f2850c7c0e", "message": "Use 0.17-SNAPSHOT of platform related libraries", "committedDate": "2020-12-17T00:49:51Z", "type": "commit"}, {"oid": "fd9e346efa3a29f448fca5ce292fd34c2e0b7e19", "url": "https://github.com/dashevo/dash-wallet/commit/fd9e346efa3a29f448fca5ce292fd34c2e0b7e19", "message": "Add fields to profile and contact request tables", "committedDate": "2020-12-17T00:53:09Z", "type": "commit"}, {"oid": "93fbbf339cb4812641b512534a7e45a7417eab86", "url": "https://github.com/dashevo/dash-wallet/commit/93fbbf339cb4812641b512534a7e45a7417eab86", "message": "Add accountReference to exists", "committedDate": "2020-12-17T00:53:33Z", "type": "commit"}, {"oid": "fe86a7835abdef0e83df8ef895c5400338a70a40", "url": "https://github.com/dashevo/dash-wallet/commit/fe86a7835abdef0e83df8ef895c5400338a70a40", "message": "DashPayContactRequestDaoAsync: Return lists of contact requests", "committedDate": "2020-12-17T00:53:58Z", "type": "commit"}, {"oid": "34e45c0a233589857591a3098b206ef729d8bc7d", "url": "https://github.com/dashevo/dash-wallet/commit/34e45c0a233589857591a3098b206ef729d8bc7d", "message": "Add some support for avatar hash values\n\n* feature is not complete", "committedDate": "2020-12-17T00:54:51Z", "type": "commit"}, {"oid": "55dfc7b7f8531a61d5929452a48569c2b1ad545b", "url": "https://github.com/dashevo/dash-wallet/commit/55dfc7b7f8531a61d5929452a48569c2b1ad545b", "message": "Use accountReference to when obtaining contact payment address", "committedDate": "2020-12-17T00:56:12Z", "type": "commit"}, {"oid": "0fe4cabcbf6f4d487de15a6bae18608d8170b338", "url": "https://github.com/dashevo/dash-wallet/commit/0fe4cabcbf6f4d487de15a6bae18608d8170b338", "message": "Use the first contactRequest received for payments and searches", "committedDate": "2020-12-17T06:25:19Z", "type": "commit"}, {"oid": "42bc7ba97fbc2c7f716a3a8000173b8300fe7b9e", "url": "https://github.com/dashevo/dash-wallet/commit/42bc7ba97fbc2c7f716a3a8000173b8300fe7b9e", "message": "DashPayContactRequest: include accountReference as a primary key", "committedDate": "2020-12-17T06:36:47Z", "type": "commit"}, {"oid": "11412a237260d9c95a37ef8ba98ccaaec5dcd669", "url": "https://github.com/dashevo/dash-wallet/commit/11412a237260d9c95a37ef8ba98ccaaec5dcd669", "message": "Added avatarHash and avatarFingerprint support to PlatformRepo class", "committedDate": "2020-12-17T09:56:21Z", "type": "commit"}, {"oid": "1411bc2a3346494d2388fb1ca20e6bd47818fef0", "url": "https://github.com/dashevo/dash-wallet/commit/1411bc2a3346494d2388fb1ca20e6bd47818fef0", "message": "Calculating avatar hash", "committedDate": "2020-12-17T11:20:57Z", "type": "commit"}, {"oid": "4b583b3eb6ad7c3021c34881c690c6f64a6bf6b4", "url": "https://github.com/dashevo/dash-wallet/commit/4b583b3eb6ad7c3021c34881c690c6f64a6bf6b4", "message": "Use avatarHash as a signature with Glide", "committedDate": "2020-12-17T11:43:54Z", "type": "commit"}, {"oid": "99c6a5afbd4d41c67e031940b6203e3c5b115bfb", "url": "https://github.com/dashevo/dash-wallet/commit/99c6a5afbd4d41c67e031940b6203e3c5b115bfb", "message": "Setting and validating the value of avatarHash being the SHA256 of profile picture", "committedDate": "2020-12-17T16:31:27Z", "type": "commit"}, {"oid": "676573e5f1efb18ee42fb923a7d7158ce12bd81f", "url": "https://github.com/dashevo/dash-wallet/commit/676573e5f1efb18ee42fb923a7d7158ce12bd81f", "message": "Setting the value of avatarHash for pictures stored on GoogleDrive", "committedDate": "2020-12-17T16:53:54Z", "type": "commit"}, {"oid": "8577999902eea3f2892d7a0af58a604dd1075c19", "url": "https://github.com/dashevo/dash-wallet/commit/8577999902eea3f2892d7a0af58a604dd1075c19", "message": "Setting the value of avatarFingerprint being the dHash of profile picture", "committedDate": "2020-12-18T17:44:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzA3ODk1NA==", "url": "https://github.com/dashevo/dash-wallet/pull/579#discussion_r547078954", "bodyText": "Some commented code here.", "author": "HashEngineering", "createdAt": "2020-12-22T05:40:02Z", "path": "wallet/src/de/schildbach/wallet/ui/dashpay/utils/DHash.java", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * Copyright 2020 Dash Core Group\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package de.schildbach.wallet.ui.dashpay.utils;\n+\n+import android.graphics.Bitmap;\n+import android.graphics.Canvas;\n+import android.graphics.ColorMatrix;\n+import android.graphics.ColorMatrixColorFilter;\n+import android.graphics.Paint;\n+\n+import java.math.BigInteger;\n+\n+// base on:\n+// https://benhoyt.com/writings/duplicate-image-detection/\n+// https://www.hackerfactor.com/blog/index.php?/archives/529-Kind-of-Like-That.html\n+// https://github.com/tistaharahap/android-dhash/blob/master/src/com/bango/imagereco/Reco.java\n+\n+public class DHash {\n+\n+    private static final int HASH_SIZE = 8;\n+\n+    public static BigInteger of(Bitmap srcBmp) {\n+        Bitmap resizedBmp = Bitmap.createScaledBitmap(srcBmp, HASH_SIZE + 1, HASH_SIZE + 1, false);\n+        if (resizedBmp != srcBmp) {\n+            srcBmp.recycle();\n+        }\n+        Bitmap resizedGrayscaleBmp = toGrayscale(resizedBmp);\n+        if (resizedGrayscaleBmp != resizedBmp) {\n+            resizedBmp.recycle();\n+        }\n+\n+//        String fileName = \"test1.png\";\n+//        File file = new File(storageDir, fileName);\n+//        resizedGrayscaleBmp = BitmapFactory.decodeFile(file.getPath());\n+\n+        String dHashH = getHorizontalDifferences(resizedGrayscaleBmp);\n+//        String dHashV = getVerticalDifferences(resizedGrayscaleBmp);", "originalCommit": "8577999902eea3f2892d7a0af58a604dd1075c19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQ0NTI1Mw==", "url": "https://github.com/dashevo/dash-wallet/pull/579#discussion_r549445253", "bodyText": "Fixed", "author": "tomasz-ludek", "createdAt": "2020-12-28T18:28:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzA3ODk1NA=="}], "type": "inlineReview"}, {"oid": "250c6fbb3c8abbeabe4b68596a2bfa0417569f08", "url": "https://github.com/dashevo/dash-wallet/commit/250c6fbb3c8abbeabe4b68596a2bfa0417569f08", "message": "Final improvements of CocoaImageDHash based on comparision of results against iOS", "committedDate": "2020-12-28T13:39:11Z", "type": "commit"}, {"oid": "bbfca5b0a806f3a21c8ddedcb89b7e1b8e74953b", "url": "https://github.com/dashevo/dash-wallet/commit/bbfca5b0a806f3a21c8ddedcb89b7e1b8e74953b", "message": "Added tests based on data from iOS", "committedDate": "2020-12-29T04:53:17Z", "type": "commit"}, {"oid": "d3bc177a4836551d5f318239765a86570290954c", "url": "https://github.com/dashevo/dash-wallet/commit/d3bc177a4836551d5f318239765a86570290954c", "message": "Fixed the issue found during the code review", "committedDate": "2020-12-29T06:02:28Z", "type": "commit"}, {"oid": "c0c0d0dfaaf1986624a68d5d4b410a93a0afa5f5", "url": "https://github.com/dashevo/dash-wallet/commit/c0c0d0dfaaf1986624a68d5d4b410a93a0afa5f5", "message": "Merge branch 'dpp-0.17' of https://github.com/dashevo/dash-wallet into avatar-hash-fingerprint", "committedDate": "2021-01-05T00:03:59Z", "type": "commit"}]}