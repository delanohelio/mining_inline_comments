{"pr_number": 10775, "pr_title": "[FLINK-15482][hive] Failed to call Hive functions returning decimal type", "pr_createdAt": "2020-01-06T10:48:42Z", "pr_url": "https://github.com/apache/flink/pull/10775", "timeline": [{"oid": "230118fe22abdfa2adae7fabcd4ce6577c92bceb", "url": "https://github.com/apache/flink/commit/230118fe22abdfa2adae7fabcd4ce6577c92bceb", "message": "[FLINK-15482][hive] Failed to call Hive functions returning decimal type", "committedDate": "2020-01-06T10:45:40Z", "type": "commit"}, {"oid": "58c6c4bbe58dce3da8eed8133e234e61c8fc1db0", "url": "https://github.com/apache/flink/commit/58c6c4bbe58dce3da8eed8133e234e61c8fc1db0", "message": "DataFormatConverters should throw exception for unsupported decimal conversion class", "committedDate": "2020-01-06T12:12:16Z", "type": "commit"}, {"oid": "d09f924b8a299087584f822180dd0fd51f50e0c1", "url": "https://github.com/apache/flink/commit/d09f924b8a299087584f822180dd0fd51f50e0c1", "message": "ScalarFunctionCallGen should call LogicalTypeDataTypeConverter to get logical type for result DataType", "committedDate": "2020-01-06T12:21:54Z", "type": "commit"}, {"oid": "9f3e87d2f247d4970fdd41e9758f5575710f9cfa", "url": "https://github.com/apache/flink/commit/9f3e87d2f247d4970fdd41e9758f5575710f9cfa", "message": "fix checkstyle", "committedDate": "2020-01-06T13:08:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzYxOTM4OA==", "url": "https://github.com/apache/flink/pull/10775#discussion_r363619388", "bodyText": "Put it in the else branch? Could you help to update other types which have the same problem, e.g. TIMESTAMP_WITHOUT_TIME_ZONE, TIMESTAMP_WITH_LOCAL_TIME_ZONE, TIMESTAMP_WITH_LOCAL_TIME_ZONE...", "author": "wuchong", "createdAt": "2020-01-07T07:26:02Z", "path": "flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/dataformat/DataFormatConverters.java", "diffHunk": "@@ -164,9 +164,10 @@ public static DataFormatConverter getConverterForDataType(DataType originDataTyp\n \t\t\t\tTuple2<Integer, Integer> ps = getPrecision(logicalType);\n \t\t\t\tif (clazz == BigDecimal.class) {\n \t\t\t\t\treturn new BigDecimalConverter(ps.f0, ps.f1);\n-\t\t\t\t} else {\n+\t\t\t\t} else if (clazz == Decimal.class) {\n \t\t\t\t\treturn new DecimalConverter(ps.f0, ps.f1);\n \t\t\t\t}\n+\t\t\t\tthrow new RuntimeException(\"Not support class for DECIMAL: \" + clazz);", "originalCommit": "9f3e87d2f247d4970fdd41e9758f5575710f9cfa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a219cce89f3c6fa14c063f4f2231b5f9830b68f6", "url": "https://github.com/apache/flink/commit/a219cce89f3c6fa14c063f4f2231b5f9830b68f6", "message": "add test and more fixes for DataFormatConverters", "committedDate": "2020-01-07T08:41:49Z", "type": "commit"}]}