{"pr_number": 11236, "pr_title": "[FLINK-16269][FLINK-16108][table-planner-blink] Fix schema of query and sink do not match when generic or POJO type is requested", "pr_createdAt": "2020-02-27T10:32:22Z", "pr_url": "https://github.com/apache/flink/pull/11236", "timeline": [{"oid": "6454804b4dd2e9d7295cc49e26940cac9d0cf9a1", "url": "https://github.com/apache/flink/commit/6454804b4dd2e9d7295cc49e26940cac9d0cf9a1", "message": "[FLINK-16269][table-planner-blink] Fix schema of query and sink do not match when generic type is requested", "committedDate": "2020-02-27T10:01:05Z", "type": "commit"}, {"oid": "7404df3a2130267c63a43d42398f08fd6ae09b0b", "url": "https://github.com/apache/flink/commit/7404df3a2130267c63a43d42398f08fd6ae09b0b", "message": "[FLINK-16108][table-planner-blink] Fix schema of query and sink do not match when POJO type is requested\n\nThis also fixes failure of StreamSQLExample when running in blink planner.", "committedDate": "2020-02-27T10:01:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA0MTI3OQ==", "url": "https://github.com/apache/flink/pull/11236#discussion_r385041279", "bodyText": "Please help to check this change. cc @twalthr", "author": "wuchong", "createdAt": "2020-02-27T10:33:19Z", "path": "flink-table/flink-table-common/src/main/java/org/apache/flink/table/types/utils/LegacyTypeInfoDataTypeConverter.java", "diffHunk": "@@ -181,6 +182,10 @@ else if (typeInfo instanceof CompositeType) {\n \t\t\treturn createLegacyType(LogicalTypeRoot.STRUCTURED_TYPE, typeInfo);\n \t\t}\n \n+\t\telse if (typeInfo instanceof GenericTypeInfo) {\n+\t\t\treturn DataTypes.RAW(typeInfo).bridgedTo(typeInfo.getTypeClass());", "originalCommit": "7404df3a2130267c63a43d42398f08fd6ae09b0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fd488f5cf0bf428170cb72cf434e01780cac8ef7", "url": "https://github.com/apache/flink/commit/fd488f5cf0bf428170cb72cf434e01780cac8ef7", "message": "fix checkstyle", "committedDate": "2020-02-27T11:38:40Z", "type": "commit"}, {"oid": "c2e5a4fb73a7b2aca22e914e57b36bc3128bb966", "url": "https://github.com/apache/flink/commit/c2e5a4fb73a7b2aca22e914e57b36bc3128bb966", "message": "fix", "committedDate": "2020-02-27T12:16:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgwMTE2Ng==", "url": "https://github.com/apache/flink/pull/11236#discussion_r386801166", "bodyText": "Can you add test to LegacyTypeInfoDataTypeConverterTest?", "author": "JingsongLi", "createdAt": "2020-03-03T05:05:40Z", "path": "flink-table/flink-table-common/src/main/java/org/apache/flink/table/types/utils/LegacyTypeInfoDataTypeConverter.java", "diffHunk": "@@ -181,6 +182,10 @@ else if (typeInfo instanceof CompositeType) {\n \t\t\treturn createLegacyType(LogicalTypeRoot.STRUCTURED_TYPE, typeInfo);\n \t\t}\n \n+\t\telse if (typeInfo instanceof GenericTypeInfo) {", "originalCommit": "7404df3a2130267c63a43d42398f08fd6ae09b0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjkxNzE1NA==", "url": "https://github.com/apache/flink/pull/11236#discussion_r386917154", "bodyText": "LegacyTypeInfoDataTypeConverterTest already covers RAW type, I updated the test result.", "author": "wuchong", "createdAt": "2020-03-03T10:10:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgwMTE2Ng=="}], "type": "inlineReview"}, {"oid": "a82548bb1a4625f01ef9af16da11f6073832d957", "url": "https://github.com/apache/flink/commit/a82548bb1a4625f01ef9af16da11f6073832d957", "message": "address comments.", "committedDate": "2020-03-03T10:10:30Z", "type": "commit"}, {"oid": "ce440c8129607cd06f742fb0835da449f0456814", "url": "https://github.com/apache/flink/commit/ce440c8129607cd06f742fb0835da449f0456814", "message": "use TypeTransformation to fix the legacy raw type instead of changing LegacyTypeInfoDataTypeConverter", "committedDate": "2020-03-03T14:15:51Z", "type": "commit"}, {"oid": "ff034a88286bfc73d03ada3e74f4fb6b964cfffb", "url": "https://github.com/apache/flink/commit/ff034a88286bfc73d03ada3e74f4fb6b964cfffb", "message": "fixup", "committedDate": "2020-03-03T16:23:22Z", "type": "commit"}]}