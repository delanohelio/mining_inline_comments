{"pr_number": 11277, "pr_title": "[FLINK-16360][orc] Flink STRING data type should map to ORC STRING type", "pr_createdAt": "2020-03-02T06:57:16Z", "pr_url": "https://github.com/apache/flink/pull/11277", "timeline": [{"oid": "8fb0e375ba23258bb6425dee43640bffc8bf75c0", "url": "https://github.com/apache/flink/commit/8fb0e375ba23258bb6425dee43640bffc8bf75c0", "message": "[FLINK-16360][orc] Flink STRING data type should map to ORC STRING type", "committedDate": "2020-03-02T06:55:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIyNTEyMg==", "url": "https://github.com/apache/flink/pull/11277#discussion_r386225122", "bodyText": "What if user specifies VARCHAR(2147483647) in the schema and we convert it to string here? Will there be a problem?", "author": "lirui-apache", "createdAt": "2020-03-02T07:08:53Z", "path": "flink-formats/flink-orc/src/main/java/org/apache/flink/orc/OrcSplitReaderUtil.java", "diffHunk": "@@ -140,7 +140,12 @@ static TypeDescription logicalTypeToOrcType(LogicalType type) {\n \t\t\tcase CHAR:\n \t\t\t\treturn TypeDescription.createChar().withMaxLength(((CharType) type).getLength());\n \t\t\tcase VARCHAR:\n-\t\t\t\treturn TypeDescription.createVarchar().withMaxLength(((VarCharType) type).getLength());\n+\t\t\t\tint len = ((VarCharType) type).getLength();\n+\t\t\t\tif (len == VarCharType.MAX_LENGTH) {\n+\t\t\t\t\treturn TypeDescription.createString();", "originalCommit": "8fb0e375ba23258bb6425dee43640bffc8bf75c0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIyNjA5NA==", "url": "https://github.com/apache/flink/pull/11277#discussion_r386226094", "bodyText": "VARCHAR(2147483647) is STRING in Flink.\nWe don't need support real VARCHAR(2147483647) in orc for hive 2.0. Hive don't have this type.", "author": "JingsongLi", "createdAt": "2020-03-02T07:12:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIyNTEyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIyNjI2MQ==", "url": "https://github.com/apache/flink/pull/11277#discussion_r386226261", "bodyText": "For newer versions, orc can schema evolution. So VARCHAR(2147483647) is supported.", "author": "JingsongLi", "createdAt": "2020-03-02T07:13:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIyNTEyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjI1MTAxOA==", "url": "https://github.com/apache/flink/pull/11277#discussion_r386251018", "bodyText": "Got it. Thanks for the explanation.", "author": "lirui-apache", "createdAt": "2020-03-02T08:29:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIyNTEyMg=="}], "type": "inlineReview"}]}