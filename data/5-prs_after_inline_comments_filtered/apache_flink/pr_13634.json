{"pr_number": 13634, "pr_title": "[FLINK-19629]Fix NullPointException in avro format as null value on MAP type", "pr_createdAt": "2020-10-14T11:59:57Z", "pr_url": "https://github.com/apache/flink/pull/13634", "timeline": [{"oid": "d719acbd86db08cb920aac511e4ef0e82720469f", "url": "https://github.com/apache/flink/commit/d719acbd86db08cb920aac511e4ef0e82720469f", "message": "[FLINK-19629]Fix NullPointException in avro format whith null value in map type", "committedDate": "2020-10-14T11:28:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI2NDE2OQ==", "url": "https://github.com/apache/flink/pull/13634#discussion_r509264169", "bodyText": "We don't need to add such a big test. You can just add a null entry to the map in the testSerializeDeserialize.", "author": "wuchong", "createdAt": "2020-10-21T13:10:39Z", "path": "flink-formats/flink-avro/src/test/java/org/apache/flink/formats/avro/AvroRowDataDeSerializationSchemaTest.java", "diffHunk": "@@ -198,4 +198,38 @@ public void testSpecificType() throws Exception {\n \t\tAssert.assertEquals(\"12:12:12\", DataFormatConverters.LocalTimeConverter.INSTANCE.toExternal(\n \t\t\t\trowData.getInt(2)).toString());\n \t}\n+\n+\t@Test\n+\tpublic void testNullableMapType() throws Exception {", "originalCommit": "d719acbd86db08cb920aac511e4ef0e82720469f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI5NDM5OA==", "url": "https://github.com/apache/flink/pull/13634#discussion_r509294398", "bodyText": "OK, i will remove it , and add in the testSerializeDeserialize", "author": "shizhengchao", "createdAt": "2020-10-21T13:43:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI2NDE2OQ=="}], "type": "inlineReview"}, {"oid": "16a7e73c66d66707a59d19be6ace83ba664f20fc", "url": "https://github.com/apache/flink/commit/16a7e73c66d66707a59d19be6ace83ba664f20fc", "message": "[FLINK-19629][Formats] Remove testNullableMapType method and add a null entry to the map in the testSerializeDeserialize", "committedDate": "2020-10-21T14:28:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgzOTA4MA==", "url": "https://github.com/apache/flink/pull/13634#discussion_r509839080", "bodyText": "key can also be null?", "author": "libenchao", "createdAt": "2020-10-22T02:16:52Z", "path": "flink-formats/flink-avro/src/main/java/org/apache/flink/formats/avro/AvroToRowDataConverters.java", "diffHunk": "@@ -178,7 +178,7 @@ private static AvroToRowDataConverter createArrayConverter(ArrayType arrayType)\n \n \tprivate static AvroToRowDataConverter createMapConverter(LogicalType type) {\n \t\tfinal AvroToRowDataConverter keyConverter = createConverter(DataTypes.STRING().getLogicalType());", "originalCommit": "16a7e73c66d66707a59d19be6ace83ba664f20fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0NjM2Nw==", "url": "https://github.com/apache/flink/pull/13634#discussion_r509846367", "bodyText": "Avro can't serialize null key for map.", "author": "wuchong", "createdAt": "2020-10-22T02:43:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgzOTA4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0ODk4OQ==", "url": "https://github.com/apache/flink/pull/13634#discussion_r509848989", "bodyText": "Avro can't serialize null key for map.\n\nThat's right, and this problem only exists when the type of map entry is STRING()", "author": "shizhengchao", "createdAt": "2020-10-22T02:53:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgzOTA4MA=="}], "type": "inlineReview"}]}