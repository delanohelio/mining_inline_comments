{"pr_number": 14160, "pr_title": "[FLINK-19795][table-blink] Fix Flink SQL throws exception when changelog source contains duplicate change events", "pr_createdAt": "2020-11-22T16:18:49Z", "pr_url": "https://github.com/apache/flink/pull/14160", "timeline": [{"oid": "250fae8059b6141ed0bb3e244a522751f20c2e8b", "url": "https://github.com/apache/flink/commit/250fae8059b6141ed0bb3e244a522751f20c2e8b", "message": "[FLINK-19795][table-blink] Fix Flink SQL throws exception when changelog source contains duplicate change events", "committedDate": "2020-11-23T13:19:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDEwNDYwNQ==", "url": "https://github.com/apache/flink/pull/14160#discussion_r530104605", "bodyText": "The condition!changelogMode.containsOnly(RowKind.INSERT) does not indicate the source is a CDC source which is non-upsert", "author": "leonardBang", "createdAt": "2020-11-25T04:43:01Z", "path": "flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/sources/DynamicSourceUtils.java", "diffHunk": "@@ -267,6 +302,20 @@ private static void validateScanSourceForStreaming(\n \t\t\t\t\tscanSource.getClass().getName()\n \t\t\t\t)\n \t\t\t);\n+\t\t} else if (!changelogMode.containsOnly(RowKind.INSERT)) {", "originalCommit": "af478685f91c3cf99c0553eeddd320bb8c3f4b35", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDE0NDk3NA==", "url": "https://github.com/apache/flink/pull/14160#discussion_r530144974", "bodyText": "This is in the else branch which means it doesn't match !hasUpdateBefore && hasUpdateAfter (upsert source).", "author": "wuchong", "createdAt": "2020-11-25T06:59:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDEwNDYwNQ=="}], "type": "inlineReview"}, {"oid": "5507e70adece61819ef8e20e7333be58e460c6b2", "url": "https://github.com/apache/flink/commit/5507e70adece61819ef8e20e7333be58e460c6b2", "message": "[hotfix][docs] Update YARN config docs", "committedDate": "2020-11-25T07:25:54Z", "type": "commit"}, {"oid": "2ee27f0eff7494ea4a75f20f3a2309132af341bc", "url": "https://github.com/apache/flink/commit/2ee27f0eff7494ea4a75f20f3a2309132af341bc", "message": "[hotfix][table-planner-blink] Enable idle state cleanup for ChangelogNormalize operator", "committedDate": "2020-11-25T07:25:54Z", "type": "commit"}, {"oid": "b67c5115a88afff62c32307f8cfe7210dd10d646", "url": "https://github.com/apache/flink/commit/b67c5115a88afff62c32307f8cfe7210dd10d646", "message": "[FLINK-19795][table-blink] Fix Flink SQL throws exception when changelog source contains duplicate change events\n\nThis closes #14160\n\nfixup docs\n\naddress review comments.\n\nupdate comment\n\nfix", "committedDate": "2020-11-25T07:25:57Z", "type": "commit"}, {"oid": "b67c5115a88afff62c32307f8cfe7210dd10d646", "url": "https://github.com/apache/flink/commit/b67c5115a88afff62c32307f8cfe7210dd10d646", "message": "[FLINK-19795][table-blink] Fix Flink SQL throws exception when changelog source contains duplicate change events\n\nThis closes #14160\n\nfixup docs\n\naddress review comments.\n\nupdate comment\n\nfix", "committedDate": "2020-11-25T07:25:57Z", "type": "forcePushed"}]}