{"pr_number": 2222, "pr_title": "Simplify edge geometry before the distance is calculated", "pr_createdAt": "2020-12-21T21:55:52Z", "pr_url": "https://github.com/graphhopper/graphhopper/pull/2222", "timeline": [{"oid": "650bea4a33465760b021ecf86654474399314b3a", "url": "https://github.com/graphhopper/graphhopper/commit/650bea4a33465760b021ecf86654474399314b3a", "message": "Simplify edge geometry before the distance is calculated", "committedDate": "2020-12-21T21:51:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk1MDA0MQ==", "url": "https://github.com/graphhopper/graphhopper/pull/2222#discussion_r546950041", "bodyText": "This is the only test where my change lead to a distance deviation above 1m, is this ok?", "author": "easbar", "createdAt": "2020-12-21T21:57:54Z", "path": "reader-osm/src/test/java/com/graphhopper/GraphHopperTest.java", "diffHunk": "@@ -887,7 +887,7 @@ public void testSRTMWithInstructions() {\n                 setAlgorithm(ASTAR).setProfile(profile));\n \n         ResponsePath res = rsp.getBest();\n-        assertEquals(1625.4, res.getDistance(), .1);\n+        assertEquals(1614.3, res.getDistance(), .1);", "originalCommit": "650bea4a33465760b021ecf86654474399314b3a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQyMzQzMg==", "url": "https://github.com/graphhopper/graphhopper/pull/2222#discussion_r549423432", "bodyText": "I had a look at this and the difference of about 11m is the result of multiple edges that have a slightly different distance due to the change in this PR. The biggest contribution is an edge with a 6.9m difference and the full geometry is shown here:\n\nDue to the simplification it looks like this:\n\nBecause point 2 is removed we get a longer less steep segment instead of a short steep and a long flat one and this leads to the different distance with and without simplification. Note that the long edge sampling that would normally prevent the loss of these elevation details is not enabled in this test.\nSo yes this PR changes the distance of this edge by a significant amount, but no this is nothing to worry about, because all we do now is that we store the distance of this edge's final geometry instead of storing the distance of a geometry that we do not keep anyway.", "author": "easbar", "createdAt": "2020-12-28T17:23:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk1MDA0MQ=="}], "type": "inlineReview"}, {"oid": "ad65f7f61f30987e58369775520132617185eb0c", "url": "https://github.com/graphhopper/graphhopper/commit/ad65f7f61f30987e58369775520132617185eb0c", "message": "Fix gtfs test", "committedDate": "2020-12-22T06:55:52Z", "type": "commit"}, {"oid": "d1b37f127131b49d47e32d73aecd59c739fb9471", "url": "https://github.com/graphhopper/graphhopper/commit/d1b37f127131b49d47e32d73aecd59c739fb9471", "message": "Remove unused wayOsmId parameter", "committedDate": "2020-12-22T12:09:26Z", "type": "commit"}, {"oid": "629bb2e1e4408fe7f4217d1758a32222c6b89903", "url": "https://github.com/graphhopper/graphhopper/commit/629bb2e1e4408fe7f4217d1758a32222c6b89903", "message": "Merge branch 'master' into simplify_before_dist", "committedDate": "2020-12-29T10:09:49Z", "type": "commit"}]}