{"pr_number": 3303, "pr_title": "ExprDurability - fix for 1.12.2 and below with block's data values", "pr_createdAt": "2020-08-13T10:18:09Z", "pr_url": "https://github.com/SkriptLang/Skript/pull/3303", "timeline": [{"oid": "05be906686d0f742a3eb6570da565c935a8b4a37", "url": "https://github.com/SkriptLang/Skript/commit/05be906686d0f742a3eb6570da565c935a8b4a37", "message": "Introducing block state modification", "committedDate": "2020-08-03T08:11:23Z", "type": "commit"}, {"oid": "2ea350b47773ff6ebaf48bf6a3c44833778e7838", "url": "https://github.com/SkriptLang/Skript/commit/2ea350b47773ff6ebaf48bf6a3c44833778e7838", "message": "Revert \"Introducing block state modification\"\n\nThis reverts commit 05be9066", "committedDate": "2020-08-03T08:24:46Z", "type": "commit"}, {"oid": "29a0869b3b6553fc1043066413d30c2ffe486916", "url": "https://github.com/SkriptLang/Skript/commit/29a0869b3b6553fc1043066413d30c2ffe486916", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-06T18:58:31Z", "type": "commit"}, {"oid": "23785c76083b6eca9c26a3c9cd0d7674def09aa8", "url": "https://github.com/SkriptLang/Skript/commit/23785c76083b6eca9c26a3c9cd0d7674def09aa8", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-06T20:48:52Z", "type": "commit"}, {"oid": "e81e1b28e76c0bfcaeb6970bb0c9d6545d242294", "url": "https://github.com/SkriptLang/Skript/commit/e81e1b28e76c0bfcaeb6970bb0c9d6545d242294", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-09T02:19:46Z", "type": "commit"}, {"oid": "08d03bcea367a59149c785a9653c5c1e755e95da", "url": "https://github.com/SkriptLang/Skript/commit/08d03bcea367a59149c785a9653c5c1e755e95da", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-09T07:09:44Z", "type": "commit"}, {"oid": "9001efcf33e39f290d5957351ff19e2ade694944", "url": "https://github.com/SkriptLang/Skript/commit/9001efcf33e39f290d5957351ff19e2ade694944", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-10T01:30:06Z", "type": "commit"}, {"oid": "1695141b1a408522b1c061afb09f17b536f4a7ab", "url": "https://github.com/SkriptLang/Skript/commit/1695141b1a408522b1c061afb09f17b536f4a7ab", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-10T02:09:45Z", "type": "commit"}, {"oid": "80c69bdebdc09a0d83878f3b8de40b695981cabf", "url": "https://github.com/SkriptLang/Skript/commit/80c69bdebdc09a0d83878f3b8de40b695981cabf", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-11T03:58:37Z", "type": "commit"}, {"oid": "a26eba6519fbb63a6cb82ef63d85f34910014c16", "url": "https://github.com/SkriptLang/Skript/commit/a26eba6519fbb63a6cb82ef63d85f34910014c16", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-11T10:40:47Z", "type": "commit"}, {"oid": "7b238a75c58a1626fa23da2d177831e68a9ca606", "url": "https://github.com/SkriptLang/Skript/commit/7b238a75c58a1626fa23da2d177831e68a9ca606", "message": "ExprDurability - fix for 1.12.2 and below with setting a block's data value", "committedDate": "2020-08-13T10:11:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDYwOTkyOQ==", "url": "https://github.com/SkriptLang/Skript/pull/3303#discussion_r470609929", "bodyText": "For this one, I think it's fine to do\nif (mode == ChangeMode.DELETE)\n\treturn CollectionUtils.array(Number.class);\nreturn null\n\nBecause the addition of future ChangeModes are not affected.", "author": "Wealthyturtle", "createdAt": "2020-08-14T13:03:12Z", "path": "src/main/java/ch/njol/skript/expressions/ExprDurability.java", "diffHunk": "@@ -73,45 +85,67 @@ public String getPropertyName() {\n \t@Override\n \t@Nullable\n \tpublic Class<?>[] acceptChange(final ChangeMode mode) {\n-\t\tif (mode == ChangeMode.REMOVE_ALL)\n-\t\t\treturn null;\n-\t\tif (Slot.class.isAssignableFrom(getExpr().getReturnType()) || getExpr().isSingle() && ChangerUtils.acceptsChange(getExpr(), ChangeMode.SET, ItemStack.class, ItemType.class))\n-\t\t\treturn CollectionUtils.array(Number.class);\n+\t\tswitch (mode) {", "originalCommit": "7b238a75c58a1626fa23da2d177831e68a9ca606", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDg0Mjg5Ng==", "url": "https://github.com/SkriptLang/Skript/pull/3303#discussion_r470842896", "bodyText": "Why would I only return number.class if the mode == Delete? What about the other modes?", "author": "ShaneBeee", "createdAt": "2020-08-14T20:08:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDYwOTkyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxOTEyMQ==", "url": "https://github.com/SkriptLang/Skript/pull/3303#discussion_r470919121", "bodyText": "Oops, I misread, yeah, that's the right way to do it then.", "author": "Wealthyturtle", "createdAt": "2020-08-15T01:09:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDYwOTkyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDYxMDQxMw==", "url": "https://github.com/SkriptLang/Skript/pull/3303#discussion_r470610413", "bodyText": "Maybe we could replace this with number? Or that could be for a future PR, up to you :)", "author": "Wealthyturtle", "createdAt": "2020-08-14T13:04:14Z", "path": "src/main/java/ch/njol/skript/expressions/ExprDurability.java", "diffHunk": "@@ -37,27 +40,36 @@\n /**\n  * @author Peter G\u00fcttinger\n  */\n-@Name(\"Data Value\")\n-@Description({\"The data value of an item.\",\n-\t\t\"You usually don't need this expression as you can check and set items with aliases easily, \" +\n-\t\t\t\t\"but this expression can e.g. be used to \\\"add 1 to data of &lt;item&gt;\\\", e.g. for cycling through all wool colours.\"})\n-@Examples({\"add 1 to the data value of the clicked block\"})\n+@Name(\"Data/Damage Value\")\n+@Description({\"The data/damage value of an item/block. Data values of blocks are only supported on 1.12.2 and below.\",\n+\t\t\"You usually don't need this expression as you can check and set items with aliases easily, \",\n+\t\t\"but this expression can e.g. be used to \\\"add 1 to data of &lt;item&gt;\\\", e.g. for cycling through all wool colours.\"})\n+@Examples({\"set damage value of player's tool to 10\",\n+\t\t\"set data value of target block of player to 3\",\n+\t\t\"add 1 to the data value of the clicked block\",\n+\t\t\"reset data value of block at player\"})\n @Since(\"1.2\")\n public class ExprDurability extends SimplePropertyExpression<Object, Short> {", "originalCommit": "7b238a75c58a1626fa23da2d177831e68a9ca606", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDg0NjMwNw==", "url": "https://github.com/SkriptLang/Skript/pull/3303#discussion_r470846307", "bodyText": "Good thinking, ill change that up now.", "author": "ShaneBeee", "createdAt": "2020-08-14T20:17:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDYxMDQxMw=="}], "type": "inlineReview"}, {"oid": "70b64b2262afe6b64dc7d6a27a918308972be3dc", "url": "https://github.com/SkriptLang/Skript/commit/70b64b2262afe6b64dc7d6a27a918308972be3dc", "message": "ExprDurability - change to use Number class rather than Short", "committedDate": "2020-08-14T20:22:28Z", "type": "commit"}, {"oid": "ff5db881b886cbc4670fa2223175d2189a55fb30", "url": "https://github.com/SkriptLang/Skript/commit/ff5db881b886cbc4670fa2223175d2189a55fb30", "message": "ExprDurability - add regression test", "committedDate": "2020-08-14T20:22:40Z", "type": "commit"}, {"oid": "a86ee246d4712e512980d8b06b606287cb3ddc66", "url": "https://github.com/SkriptLang/Skript/commit/a86ee246d4712e512980d8b06b606287cb3ddc66", "message": "Merge branch 'master' into fix/data-value-block", "committedDate": "2020-08-18T07:39:38Z", "type": "commit"}]}