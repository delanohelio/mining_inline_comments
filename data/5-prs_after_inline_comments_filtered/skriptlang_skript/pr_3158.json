{"pr_number": 3158, "pr_title": "Create ExprFallenDistance.java", "pr_createdAt": "2020-07-17T21:08:05Z", "pr_url": "https://github.com/SkriptLang/Skript/pull/3158", "timeline": [{"oid": "fb3262d265184f02694454e4c483242e3072fc93", "url": "https://github.com/SkriptLang/Skript/commit/fb3262d265184f02694454e4c483242e3072fc93", "message": "Create ExprFallenDistance.java", "committedDate": "2020-07-17T21:06:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4MDcyMQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456680721", "bodyText": "Need some docs here", "author": "ShaneBeee", "createdAt": "2020-07-17T21:23:54Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+", "originalCommit": "fb3262d265184f02694454e4c483242e3072fc93", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4MTAyMg==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456681022", "bodyText": "this should support multiple entities", "author": "ShaneBeee", "createdAt": "2020-07-17T21:24:47Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entity\");", "originalCommit": "fb3262d265184f02694454e4c483242e3072fc93", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4NjYzMQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456686631", "bodyText": "Also, missing new line before static statement", "author": "FranKusmiruk", "createdAt": "2020-07-17T21:42:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4MTAyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4MTI4NA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456681284", "bodyText": "break should be on the next line", "author": "ShaneBeee", "createdAt": "2020-07-17T21:25:34Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entity\");\n+\t}\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"fall(en|ed|) distance\";\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Number> getReturnType() {\n+\t\treturn Number.class;\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, Changer.ChangeMode mode) {\n+\t\tif(delta != null){\n+\t\t\tEntity entity = getExpr().getSingle(e);\n+\t\t\tif(entity == null) return;\n+\t\t\tFloat number = ((Number) delta[0]).floatValue();\n+\t\t\tswitch (mode){\n+\t\t\t\tcase ADD:\n+\t\t\t\t\tentity.setFallDistance(entity.getFallDistance()+number);\n+\t\t\t\t\tbreak;\n+\t\t\t\tcase SET:\n+\t\t\t\t\tentity.setFallDistance(number);break;", "originalCommit": "fb3262d265184f02694454e4c483242e3072fc93", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4Njk3NA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456686974", "bodyText": "The changer should also support multiple entities", "author": "FranKusmiruk", "createdAt": "2020-07-17T21:43:45Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entity\");\n+\t}\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"fall(en|ed|) distance\";\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Number> getReturnType() {\n+\t\treturn Number.class;\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, Changer.ChangeMode mode) {\n+\t\tif(delta != null){\n+\t\t\tEntity entity = getExpr().getSingle(e);", "originalCommit": "fb3262d265184f02694454e4c483242e3072fc93", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4Nzg2Nw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456687867", "bodyText": "As per the coding conventions file, the method order should be:\n(init) -> convert -> (acceptChange) -> (change) -> getReturnType -> getPropertyName\n\nAnd the Changer.ChangeMode class should be imported directly.", "author": "FranKusmiruk", "createdAt": "2020-07-17T21:46:34Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entity\");\n+\t}\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"fall(en|ed|) distance\";\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Number> getReturnType() {\n+\t\treturn Number.class;\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, Changer.ChangeMode mode) {\n+\t\tif(delta != null){\n+\t\t\tEntity entity = getExpr().getSingle(e);\n+\t\t\tif(entity == null) return;\n+\t\t\tFloat number = ((Number) delta[0]).floatValue();\n+\t\t\tswitch (mode){\n+\t\t\t\tcase ADD:\n+\t\t\t\t\tentity.setFallDistance(entity.getFallDistance()+number);\n+\t\t\t\t\tbreak;\n+\t\t\t\tcase SET:\n+\t\t\t\t\tentity.setFallDistance(number);break;\n+\t\t\t\tcase REMOVE:\n+\t\t\t\t\tentity.setFallDistance(entity.getFallDistance()-number);\n+\t\t\t\t\tbreak;\n+\t\t\t\tdefault:\n+\t\t\t\t\tentity.setFallDistance(0);\n+\t\t\t}\n+\t\t}\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(Changer.ChangeMode mode) {", "originalCommit": "fb3262d265184f02694454e4c483242e3072fc93", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4ODMyNA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456688324", "bodyText": "REMOVE_ALL should either not be supported in acceptChange or have the same behaviour as REMOVE, in this case, the former is preferred.\nAlso, is RESET behaviour correct here? DELETE is fine like this but resetting the fall distance definitely shouldn't behave like this. I don't believe you can \"reset\" the fall distance at all so it should just not be supported in acceptChange.", "author": "FranKusmiruk", "createdAt": "2020-07-17T21:48:09Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entity\");\n+\t}\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"fall(en|ed|) distance\";\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Number> getReturnType() {\n+\t\treturn Number.class;\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, Changer.ChangeMode mode) {\n+\t\tif(delta != null){\n+\t\t\tEntity entity = getExpr().getSingle(e);\n+\t\t\tif(entity == null) return;\n+\t\t\tFloat number = ((Number) delta[0]).floatValue();\n+\t\t\tswitch (mode){\n+\t\t\t\tcase ADD:\n+\t\t\t\t\tentity.setFallDistance(entity.getFallDistance()+number);\n+\t\t\t\t\tbreak;\n+\t\t\t\tcase SET:\n+\t\t\t\t\tentity.setFallDistance(number);break;\n+\t\t\t\tcase REMOVE:\n+\t\t\t\t\tentity.setFallDistance(entity.getFallDistance()-number);\n+\t\t\t\t\tbreak;\n+\t\t\t\tdefault:\n+\t\t\t\t\tentity.setFallDistance(0);", "originalCommit": "fb3262d265184f02694454e4c483242e3072fc93", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4ODgzNQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456688835", "bodyText": "return should be on the next line.", "author": "FranKusmiruk", "createdAt": "2020-07-17T21:49:49Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entity\");\n+\t}\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"fall(en|ed|) distance\";\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Number> getReturnType() {\n+\t\treturn Number.class;\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, Changer.ChangeMode mode) {\n+\t\tif(delta != null){\n+\t\t\tEntity entity = getExpr().getSingle(e);\n+\t\t\tif(entity == null) return;", "originalCommit": "fb3262d265184f02694454e4c483242e3072fc93", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4ODk2Mg==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456688962", "bodyText": "Missing space before starting brace", "author": "FranKusmiruk", "createdAt": "2020-07-17T21:50:09Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entity\");\n+\t}\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"fall(en|ed|) distance\";\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Number> getReturnType() {\n+\t\treturn Number.class;\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, Changer.ChangeMode mode) {\n+\t\tif(delta != null){\n+\t\t\tEntity entity = getExpr().getSingle(e);\n+\t\t\tif(entity == null) return;\n+\t\t\tFloat number = ((Number) delta[0]).floatValue();\n+\t\t\tswitch (mode){", "originalCommit": "fb3262d265184f02694454e4c483242e3072fc93", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY4OTY0Mw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456689643", "bodyText": "Instead of getting the fall distance on each case, just make a variable for it before the switch statement.", "author": "FranKusmiruk", "createdAt": "2020-07-17T21:52:27Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entity\");\n+\t}\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"fall(en|ed|) distance\";\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Number> getReturnType() {\n+\t\treturn Number.class;\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, Changer.ChangeMode mode) {\n+\t\tif(delta != null){\n+\t\t\tEntity entity = getExpr().getSingle(e);\n+\t\t\tif(entity == null) return;\n+\t\t\tFloat number = ((Number) delta[0]).floatValue();\n+\t\t\tswitch (mode){\n+\t\t\t\tcase ADD:\n+\t\t\t\t\tentity.setFallDistance(entity.getFallDistance()+number);", "originalCommit": "fb3262d265184f02694454e4c483242e3072fc93", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "bc9909f39d332c1c3d89d40655edeaeca9be92a7", "url": "https://github.com/SkriptLang/Skript/commit/bc9909f39d332c1c3d89d40655edeaeca9be92a7", "message": "Merge branch 'master' into ExprFallenDistance", "committedDate": "2020-07-18T08:38:14Z", "type": "commit"}, {"oid": "e1094f7416598db9ee4c6d449141fa4e39fe86af", "url": "https://github.com/SkriptLang/Skript/commit/e1094f7416598db9ee4c6d449141fa4e39fe86af", "message": "Updated ExprFallenDistance accordingly to the coding conventions, formatted the code, added support for setting multiple entities' fall distance", "committedDate": "2020-07-18T09:15:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzE5MA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456783190", "bodyText": "wouldn't reset make more sense here?", "author": "Pikachu920", "createdAt": "2020-07-18T12:01:55Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fallen distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fallen distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\t\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entities\");\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(ChangeMode mode) {\n+\t\treturn (mode == ChangeMode.RESET || mode == ChangeMode.REMOVE_ALL) ? null : CollectionUtils.array(Number.class);\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, ChangeMode mode) {\n+\t\tif (delta != null) {\n+\t\t\tEntity[] entities = getExpr().getArray(e);\n+\t\t\tif (entities.length < 1)\n+\t\t\t\treturn;\n+\t\t\tFloat number = ((Number) delta[0]).floatValue();\n+\t\t\tfor (Entity entity : entities) {\n+\t\t\t\t\n+\t\t\t\tFloat fallDistance = entity.getFallDistance();\n+\t\t\t\t\n+\t\t\t\tswitch (mode) {\n+\t\t\t\t\tcase ADD:\n+\t\t\t\t\t\tentity.setFallDistance(fallDistance + number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase SET:\n+\t\t\t\t\t\tentity.setFallDistance(number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase REMOVE:\n+\t\t\t\t\t\tentity.setFallDistance(fallDistance - number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase DELETE:", "originalCommit": "e1094f7416598db9ee4c6d449141fa4e39fe86af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4NDc5Nw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456784797", "bodyText": "FranKusmiruk said\n'Also, is RESET behaviour correct here? DELETE is fine like this but resetting the fall distance definitely shouldn't behave like this. I don't believe you can \"reset\" the fall distance at all so it should just not be supported in acceptChange.'", "author": "DeltaRays", "createdAt": "2020-07-18T12:22:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzE5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4NDg5MQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456784891", "bodyText": "At that point DELETE doesn't make sense, either", "author": "DeltaRays", "createdAt": "2020-07-18T12:23:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzE5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyNTY3MA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456825670", "bodyText": "I believe DELETE makes a bit more sense due to the fact you can use clear fallen distance of entity, but I do get the point", "author": "FranKusmiruk", "createdAt": "2020-07-18T20:36:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzE5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyNjA1MQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456826051", "bodyText": "hmmm i didn't think about clear. i wish we could differentiate between the two. I think i would be okay with either using delete or neither, wish a slight lean toward neither", "author": "Pikachu920", "createdAt": "2020-07-18T20:41:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzE5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyODQ0NQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456828445", "bodyText": "Yup, that's what I did", "author": "DeltaRays", "createdAt": "2020-07-18T21:12:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzE5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzI3NQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456783275", "bodyText": "delta will be null if the change mode is reset or delete, so this is preventing your delete change from doing anything", "author": "Pikachu920", "createdAt": "2020-07-18T12:03:09Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fallen distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fallen distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\t\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entities\");\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(ChangeMode mode) {\n+\t\treturn (mode == ChangeMode.RESET || mode == ChangeMode.REMOVE_ALL) ? null : CollectionUtils.array(Number.class);\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, ChangeMode mode) {\n+\t\tif (delta != null) {", "originalCommit": "e1094f7416598db9ee4c6d449141fa4e39fe86af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzMwOQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456783309", "bodyText": "falled distance isn't proper english", "author": "Pikachu920", "createdAt": "2020-07-18T12:03:38Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fallen distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fallen distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\t\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entities\");", "originalCommit": "e1094f7416598db9ee4c6d449141fa4e39fe86af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzQ1Nw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456783457", "bodyText": "this would just be one of the syntax options", "author": "Pikachu920", "createdAt": "2020-07-18T12:05:39Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fallen distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fallen distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\t\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"fall(en|ed|) distance\", \"entities\");\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(ChangeMode mode) {\n+\t\treturn (mode == ChangeMode.RESET || mode == ChangeMode.REMOVE_ALL) ? null : CollectionUtils.array(Number.class);\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, ChangeMode mode) {\n+\t\tif (delta != null) {\n+\t\t\tEntity[] entities = getExpr().getArray(e);\n+\t\t\tif (entities.length < 1)\n+\t\t\t\treturn;\n+\t\t\tFloat number = ((Number) delta[0]).floatValue();\n+\t\t\tfor (Entity entity : entities) {\n+\t\t\t\t\n+\t\t\t\tFloat fallDistance = entity.getFallDistance();\n+\t\t\t\t\n+\t\t\t\tswitch (mode) {\n+\t\t\t\t\tcase ADD:\n+\t\t\t\t\t\tentity.setFallDistance(fallDistance + number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase SET:\n+\t\t\t\t\t\tentity.setFallDistance(number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase REMOVE:\n+\t\t\t\t\t\tentity.setFallDistance(fallDistance - number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase DELETE:\n+\t\t\t\t\t\tentity.setFallDistance(0);\n+\t\t\t\t}\n+\t\t\t}\n+\t\t}\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Number> getReturnType() {\n+\t\treturn Number.class;\n+\t}\n+\t\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"fall(en|ed|) distance\";", "originalCommit": "e1094f7416598db9ee4c6d449141fa4e39fe86af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4NDY4MQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456784681", "bodyText": "What do you think about the new syntax?", "author": "DeltaRays", "createdAt": "2020-07-18T12:20:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzQ1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyNjE2OA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456826168", "bodyText": "remove felled and it will be perfect \ud83d\udc4d\nfor this specific review though, it should just be return \"fallen distance\" - for getPropertyName you just return a single possibility for the syntax.", "author": "Pikachu920", "createdAt": "2020-07-18T20:43:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzQ1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyNzE4Mg==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456827182", "bodyText": "Thanks, also felled is a thing according to google", "author": "DeltaRays", "createdAt": "2020-07-18T20:56:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzQ1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzMjU1Mw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456832553", "bodyText": "yes, felled is a the past participle of fell but it is grammatically wrong in this context", "author": "FranKusmiruk", "createdAt": "2020-07-18T22:06:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc4MzQ1Nw=="}], "type": "inlineReview"}, {"oid": "676c3ac42da4b1be632e378d211b4a89825dd905", "url": "https://github.com/SkriptLang/Skript/commit/676c3ac42da4b1be632e378d211b4a89825dd905", "message": "Update ExprFallenDistance.java", "committedDate": "2020-07-18T12:20:10Z", "type": "commit"}, {"oid": "514e0128c75d97feeaaac23c88505b85b4645444", "url": "https://github.com/SkriptLang/Skript/commit/514e0128c75d97feeaaac23c88505b85b4645444", "message": "Removed the DELETE case", "committedDate": "2020-07-18T12:24:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyNjMzMg==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456826332", "bodyText": "missing a space after the second || - if you're using intellij and it's git integration it might be worthwhile to enable the reformat code before commit option to catch small things like this", "author": "Pikachu920", "createdAt": "2020-07-18T20:45:29Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fallen distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fallen distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\t\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"[the] (fall[en]|fell[ed]) (distance|height)\", \"entities\");\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(ChangeMode mode) {\n+\t\treturn (mode == ChangeMode.RESET || mode == ChangeMode.REMOVE_ALL ||mode == ChangeMode.DELETE) ? null : CollectionUtils.array(Number.class);", "originalCommit": "514e0128c75d97feeaaac23c88505b85b4645444", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyNzE0Nw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456827147", "bodyText": "The issue with that is that it would always format it and if it hasn't been formatted beforehand I'm told to format it in another pull request", "author": "DeltaRays", "createdAt": "2020-07-18T20:56:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyNjMzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyOTIzNA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456829234", "bodyText": "I mean, you can avoid committing changes unrelated to the PR or do them on a separate branch if needed", "author": "FranKusmiruk", "createdAt": "2020-07-18T21:22:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyNjMzMg=="}], "type": "inlineReview"}, {"oid": "badd11c25a73c850f2548bbe1dabd111fa5d19e3", "url": "https://github.com/SkriptLang/Skript/commit/badd11c25a73c850f2548bbe1dabd111fa5d19e3", "message": "Update ExprFallenDistance.java", "committedDate": "2020-07-18T21:14:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MTQwMg==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456891402", "bodyText": "In my opinion, the name here should just be \"Fall Distance\"\nI understand fallen is grammatically correct, but it just doesn't look right.", "author": "ShaneBeee", "createdAt": "2020-07-19T10:33:45Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fallen distance\")", "originalCommit": "badd11c25a73c850f2548bbe1dabd111fa5d19e3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MTY0OA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456891648", "bodyText": "\"felled\" typical refers to the past action of falling an object, ie: falling a tree (cutting it down/knocking it over)\nPersonally I feel like theres a few too many options here.\nIn my opinion it should just be \"fall\". The Bukkit method is getFallDistance, i really dont feel we need fell, felled, fallen.\nI cant really see someone typing set {_f} to fallen distance of player\nAgain, this is my opinion based on cleaning this up, but its open for discussion.", "author": "ShaneBeee", "createdAt": "2020-07-19T10:36:10Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fallen distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fallen distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\t\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"[the] (fall[en]|fell[ed]) (distance|height)\", \"entities\");", "originalCommit": "badd11c25a73c850f2548bbe1dabd111fa5d19e3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MTY5Nw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456891697", "bodyText": "same as name of this expression, this should just be \"fall distance\"", "author": "ShaneBeee", "createdAt": "2020-07-19T10:36:39Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fallen distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fallen distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\t\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"[the] (fall[en]|fell[ed]) (distance|height)\", \"entities\");\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(ChangeMode mode) {\n+\t\treturn (mode == ChangeMode.RESET || mode == ChangeMode.REMOVE_ALL || mode == ChangeMode.DELETE) ? null : CollectionUtils.array(Number.class);\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, ChangeMode mode) {\n+\t\tif (delta != null) {\n+\t\t\tEntity[] entities = getExpr().getArray(e);\n+\t\t\tif (entities.length < 1)\n+\t\t\t\treturn;\n+\t\t\tFloat number = ((Number) delta[0]).floatValue();\n+\t\t\tfor (Entity entity : entities) {\n+\t\t\t\t\n+\t\t\t\tFloat fallDistance = entity.getFallDistance();\n+\t\t\t\t\n+\t\t\t\tswitch (mode) {\n+\t\t\t\t\tcase ADD:\n+\t\t\t\t\t\tentity.setFallDistance(fallDistance + number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase SET:\n+\t\t\t\t\t\tentity.setFallDistance(number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase REMOVE:\n+\t\t\t\t\t\tentity.setFallDistance(fallDistance - number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tdefault:\n+\t\t\t\t\t\tassert false;\n+\t\t\t\t}\n+\t\t\t}\n+\t\t}\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Number> getReturnType() {\n+\t\treturn Number.class;\n+\t}\n+\t\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"fallen distance\";", "originalCommit": "badd11c25a73c850f2548bbe1dabd111fa5d19e3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MTc2NQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r456891765", "bodyText": "For the sake of the Bukkit method being getFallDistance, this should probably be ExprFallDistance, to keep up with continuity.", "author": "ShaneBeee", "createdAt": "2020-07-19T10:37:43Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fallen distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fallen distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {", "originalCommit": "badd11c25a73c850f2548bbe1dabd111fa5d19e3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a715b26c3d233f30891081cb96eb10f1e77cfbdc", "url": "https://github.com/SkriptLang/Skript/commit/a715b26c3d233f30891081cb96eb10f1e77cfbdc", "message": "Update ExprFallenDistance.java", "committedDate": "2020-07-19T12:31:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzIyOTQ1MQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457229451", "bodyText": "To keep continuity, the \"d\" should be upper cased \"Fall Distance\"", "author": "ShaneBeee", "createdAt": "2020-07-20T09:43:33Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fall distance\")", "originalCommit": "a715b26c3d233f30891081cb96eb10f1e77cfbdc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzIzMDExOA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457230118", "bodyText": "I know this may seem silly/picky, but again to stick with continuity with the docs, this sentence should have a period at the end.", "author": "ShaneBeee", "createdAt": "2020-07-20T09:44:30Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fall distance\")\n+@Description({\"The distance an entity has fallen for\"})", "originalCommit": "a715b26c3d233f30891081cb96eb10f1e77cfbdc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI1MDg2NA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457250864", "bodyText": "I see this was marked as resolved, and I was requested for review, yet nothing changed here.\nIf you are going to mark something as resolved, with no change, please detail why you chose to resolve it.", "author": "ShaneBeee", "createdAt": "2020-07-20T10:13:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzIzMDExOA=="}], "type": "inlineReview"}, {"oid": "53870be4963cc7323955189a281676fab5823422", "url": "https://github.com/SkriptLang/Skript/commit/53870be4963cc7323955189a281676fab5823422", "message": "Merge branch 'master' into ExprFallenDistance", "committedDate": "2020-07-20T09:58:52Z", "type": "commit"}, {"oid": "885151687805914f4a750aa8d798ce97bbd1ee02", "url": "https://github.com/SkriptLang/Skript/commit/885151687805914f4a750aa8d798ce97bbd1ee02", "message": "Update ExprFallenDistance.java", "committedDate": "2020-07-20T10:03:23Z", "type": "commit"}, {"oid": "89f0eda3b13d86ce417ea874f717993b7b5422d1", "url": "https://github.com/SkriptLang/Skript/commit/89f0eda3b13d86ce417ea874f717993b7b5422d1", "message": "Merge branch 'ExprFallenDistance' of https://github.com/DeltaRays/Skript into ExprFallenDistance", "committedDate": "2020-07-20T10:04:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0ODc2Nw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457248767", "bodyText": "Class should be ExprFallDistance with the file being ExprFallDistance.java", "author": "Wealthyturtle", "createdAt": "2020-07-20T10:10:41Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fall Distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fall distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {", "originalCommit": "89f0eda3b13d86ce417ea874f717993b7b5422d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0OTM2Ng==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457249366", "bodyText": "Does it really matter?", "author": "DeltaRays", "createdAt": "2020-07-20T10:11:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0ODc2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI1MDIxNw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457250217", "bodyText": "Your @Name is (\"Fall Distance\"), not (\"Fallen Distance\")", "author": "Wealthyturtle", "createdAt": "2020-07-20T10:12:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0ODc2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI1MDM0Mg==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457250342", "bodyText": "I 100% agree.\nThis was something I had previously reviewed, but it was ignored and \"resolved\"", "author": "ShaneBeee", "createdAt": "2020-07-20T10:13:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0ODc2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI1MTIzNg==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457251236", "bodyText": "My bad", "author": "DeltaRays", "createdAt": "2020-07-20T10:14:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0ODc2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0OTY4OQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457249689", "bodyText": "What happens if x is passed onto entity.setFallDistance(x) where x is negative? E.g. when the user gives a negative number, or they try and subtract too much from the entity's original fallDistance?", "author": "Wealthyturtle", "createdAt": "2020-07-20T10:12:05Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallenDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fall Distance\")\n+@Description({\"The distance an entity has fallen for\"})\n+@Examples({\"set all entities' fall distance to 10\",\n+\t\"on damage:\",\n+\t\"\\tsend \\\"%victim's fall distance%\\\" to victim\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprFallenDistance extends SimplePropertyExpression<Entity, Number> {\n+\t\n+\tstatic {\n+\t\tregister(ExprFallenDistance.class, Number.class, \"[the] fall[en] (distance|height)\", \"entities\");\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Number convert(Entity entity) {\n+\t\treturn entity.getFallDistance();\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(ChangeMode mode) {\n+\t\treturn (mode == ChangeMode.RESET || mode == ChangeMode.REMOVE_ALL || mode == ChangeMode.DELETE) ? null : CollectionUtils.array(Number.class);\n+\t}\n+\t\n+\t@Override\n+\tpublic void change(Event e, @Nullable Object[] delta, ChangeMode mode) {\n+\t\tif (delta != null) {\n+\t\t\tEntity[] entities = getExpr().getArray(e);\n+\t\t\tif (entities.length < 1)\n+\t\t\t\treturn;\n+\t\t\tFloat number = ((Number) delta[0]).floatValue();\n+\t\t\tfor (Entity entity : entities) {\n+\t\t\t\t\n+\t\t\t\tFloat fallDistance = entity.getFallDistance();\n+\t\t\t\t\n+\t\t\t\tswitch (mode) {\n+\t\t\t\t\tcase ADD:\n+\t\t\t\t\t\tentity.setFallDistance(fallDistance + number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase SET:\n+\t\t\t\t\t\tentity.setFallDistance(number);\n+\t\t\t\t\t\tbreak;\n+\t\t\t\t\tcase REMOVE:\n+\t\t\t\t\t\tentity.setFallDistance(fallDistance - number);\n+\t\t\t\t\t\tbreak;", "originalCommit": "89f0eda3b13d86ce417ea874f717993b7b5422d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI1MDE2NA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457250164", "bodyText": "Not much, bukkit handles it as if it were 0", "author": "DeltaRays", "createdAt": "2020-07-20T10:12:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0OTY4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI1MjE2MQ==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457252161", "bodyText": "Did you actually test this? Because sometimes Bukkit may be absolutely fine with it but then when it gets passed down the chain into NMS Minecraft starts throwing exceptions...", "author": "Wealthyturtle", "createdAt": "2020-07-20T10:15:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0OTY4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI1MzA1Nw==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457253057", "bodyText": "Yeah I tested it", "author": "DeltaRays", "createdAt": "2020-07-20T10:17:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI0OTY4OQ=="}], "type": "inlineReview"}, {"oid": "152172a5278ae3b7b0ec9d99c4de18435accf1b3", "url": "https://github.com/SkriptLang/Skript/commit/152172a5278ae3b7b0ec9d99c4de18435accf1b3", "message": "Update ExprFallDistance.java", "committedDate": "2020-07-20T10:14:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzI1NDQ5NA==", "url": "https://github.com/SkriptLang/Skript/pull/3158#discussion_r457254494", "bodyText": "Still missing a .", "author": "Wealthyturtle", "createdAt": "2020-07-20T10:19:20Z", "path": "src/main/java/ch/njol/skript/expressions/ExprFallDistance.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Entity;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Fall Distance\")\n+@Description({\"The distance an entity has fallen for\"})", "originalCommit": "152172a5278ae3b7b0ec9d99c4de18435accf1b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "98124627cba0d1f267a9f9f3501a150450a07dbf", "url": "https://github.com/SkriptLang/Skript/commit/98124627cba0d1f267a9f9f3501a150450a07dbf", "message": "Update ExprFallDistance.java", "committedDate": "2020-07-20T10:19:47Z", "type": "commit"}]}