{"pr_number": 936, "pr_title": "fix for partial deploy with blue-green, LMCROSSITXSADEPLOY-2154", "pr_createdAt": "2020-08-20T14:19:57Z", "pr_url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/936", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDAzNjQyOQ==", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/936#discussion_r474036429", "bodyText": "I don't understand the need for this variable.\nJust pass the list (and remove the List suffix from its name) to the other method", "author": "radito3", "createdAt": "2020-08-20T14:42:02Z", "path": "multiapps-controller-process/src/main/java/org/cloudfoundry/multiapps/controller/process/steps/DetectApplicationsToRenameStep.java", "diffHunk": "@@ -49,13 +51,28 @@ protected StepPhase executeStep(ProcessContext context) {\n         return StepPhase.DONE;\n     }\n \n-    private List<String> computeOldAppsToRename(Set<String> appsToProcess) {\n-        return appsToProcess.stream()\n-                            .filter(appName -> !BlueGreenApplicationNameSuffix.isSuffixContainedIn(appName))\n-                            .collect(Collectors.toList());\n+    private List<String> computeOldAppsToRename(DeployedMta deployedMta, List<String> selectedModulesList) {        \n+        Set<String> selectedModulesSet = new TreeSet<>();", "originalCommit": "8a0252f8542a4f2b51550012b79d8fe597e01099", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA0Mzg2Mg==", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/936#discussion_r474043862", "bodyText": "the set will have better performance when later making the contains check", "author": "ikasarov", "createdAt": "2020-08-20T14:52:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDAzNjQyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA0OTM0OA==", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/936#discussion_r474049348", "bodyText": "will remove in service of code clarity, performance isn't really a concern here", "author": "ikasarov", "createdAt": "2020-08-20T14:59:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDAzNjQyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDAzNjc5OQ==", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/936#discussion_r474036799", "bodyText": "Wouldn't isModuleSelectedForDeployment be better?\nAnd rename the first parameter to moduleName", "author": "radito3", "createdAt": "2020-08-20T14:42:33Z", "path": "multiapps-controller-process/src/main/java/org/cloudfoundry/multiapps/controller/process/steps/DetectApplicationsToRenameStep.java", "diffHunk": "@@ -49,13 +51,28 @@ protected StepPhase executeStep(ProcessContext context) {\n         return StepPhase.DONE;\n     }\n \n-    private List<String> computeOldAppsToRename(Set<String> appsToProcess) {\n-        return appsToProcess.stream()\n-                            .filter(appName -> !BlueGreenApplicationNameSuffix.isSuffixContainedIn(appName))\n-                            .collect(Collectors.toList());\n+    private List<String> computeOldAppsToRename(DeployedMta deployedMta, List<String> selectedModulesList) {        \n+        Set<String> selectedModulesSet = new TreeSet<>();\n+        selectedModulesSet.addAll(CollectionUtils.emptyIfNull(selectedModulesList));\n+\n+        return deployedMta.getApplications()\n+                          .stream()\n+                          .filter(app -> !BlueGreenApplicationNameSuffix.isSuffixContainedIn(app.getName()))\n+                          .filter(app -> moduleIsSelectedForDeployment(app.getModuleName(), selectedModulesSet))\n+                          .map(DeployedMtaApplication::getName)\n+                          .collect(Collectors.toList());\n+    }\n+\n+    private boolean moduleIsSelectedForDeployment(String module, Set<String> selectedModules) {", "originalCommit": "8a0252f8542a4f2b51550012b79d8fe597e01099", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0afbe6f55a9643c55c445a90f69c4981049b7522", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/0afbe6f55a9643c55c445a90f69c4981049b7522", "message": "fix for partial deploy with blue-green, LMCROSSITXSADEPLOY-2154", "committedDate": "2020-08-20T14:53:58Z", "type": "forcePushed"}, {"oid": "41a18569e3e8aab44907e15aaa6c3d8cd983da0f", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/41a18569e3e8aab44907e15aaa6c3d8cd983da0f", "message": "fix for partial deploy with blue-green, LMCROSSITXSADEPLOY-2154\n\nasd", "committedDate": "2020-08-20T15:03:50Z", "type": "commit"}, {"oid": "41a18569e3e8aab44907e15aaa6c3d8cd983da0f", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/41a18569e3e8aab44907e15aaa6c3d8cd983da0f", "message": "fix for partial deploy with blue-green, LMCROSSITXSADEPLOY-2154\n\nasd", "committedDate": "2020-08-20T15:03:50Z", "type": "forcePushed"}]}