{"pr_number": 1570, "pr_title": "Add support for new arguments in GameLaunchMessage", "pr_createdAt": "2020-01-31T21:22:31Z", "pr_url": "https://github.com/FAForever/downlords-faf-client/pull/1570", "timeline": [{"oid": "ddba564a6d7b882e85435e8a042399a3a982ca9e", "url": "https://github.com/FAForever/downlords-faf-client/commit/ddba564a6d7b882e85435e8a042399a3a982ca9e", "message": "Add support for new arguments in GameLaunchMessage\n(fixes #1281)\n\nServer side changes to be found here: https://github.com/FAForever/server/pull/517", "committedDate": "2020-01-31T21:30:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzczMDU1Ng==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r373730556", "bodyText": "What does this actually get used for?", "author": "Askaholic", "createdAt": "2020-01-31T23:35:32Z", "path": "src/main/java/com/faforever/client/remote/domain/GameLaunchMessage.java", "diffHunk": "@@ -1,50 +1,33 @@\n package com.faforever.client.remote.domain;\n \n+import com.faforever.client.fa.relay.LobbyMode;\n+import com.faforever.client.game.Faction;\n+import lombok.Getter;\n+import lombok.NonNull;\n+import lombok.Setter;\n+\n import java.util.List;\n \n+@Getter\n+@Setter\n public class GameLaunchMessage extends FafServerMessage {\n \n+  /**\n+   * Stores game launch arguments, like \"/ratingcolor d8d8d8d8\", \"/numgames 236\".\n+   */\n   private List<String> args;\n   private int uid;\n   private String mod;\n   private String mapname;\n+  @NonNull\n+  private String name;\n+  private int expectedPlayers;\n+  private int team;\n+  private int mapPosition;", "originalCommit": "ddba564a6d7b882e85435e8a042399a3a982ca9e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwODA0OQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r373808049", "bodyText": "I think it's the slot you spawn in.", "author": "Geosearchef", "createdAt": "2020-02-01T23:20:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzczMDU1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwODU0NA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r373808544", "bodyText": "Yea but the PR doesn\u2019t reference it anywhere", "author": "Askaholic", "createdAt": "2020-02-01T23:33:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzczMDU1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgzNTU0NA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r373835544", "bodyText": "Indeed. I just copied the stuff from the old GW branch and did not cross-check.\nIn ladder the map positions somehow work out of the box.\nBut if you have more than 2 players and you need sorting (left vs right or top vs bottom) you will somehow need to solve that.", "author": "Brutus5000", "createdAt": "2020-02-02T10:38:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzczMDU1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzczMDg0OA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r373730848", "bodyText": "So this would be the number of players when the lobby is full? I don't think the server implements it correctly yet. It'll be easy to fix though.", "author": "Askaholic", "createdAt": "2020-01-31T23:37:04Z", "path": "src/main/java/com/faforever/client/remote/domain/GameLaunchMessage.java", "diffHunk": "@@ -1,50 +1,33 @@\n package com.faforever.client.remote.domain;\n \n+import com.faforever.client.fa.relay.LobbyMode;\n+import com.faforever.client.game.Faction;\n+import lombok.Getter;\n+import lombok.NonNull;\n+import lombok.Setter;\n+\n import java.util.List;\n \n+@Getter\n+@Setter\n public class GameLaunchMessage extends FafServerMessage {\n \n+  /**\n+   * Stores game launch arguments, like \"/ratingcolor d8d8d8d8\", \"/numgames 236\".\n+   */\n   private List<String> args;\n   private int uid;\n   private String mod;\n   private String mapname;\n+  @NonNull\n+  private String name;\n+  private int expectedPlayers;", "originalCommit": "ddba564a6d7b882e85435e8a042399a3a982ca9e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgzNTU5MA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r373835590", "bodyText": "Yes, the autolobby starts the game if the number of expectedPlayers is connected. Until then you are in the connecting stage.", "author": "Brutus5000", "createdAt": "2020-02-02T10:40:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzczMDg0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwODAwMA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r373808000", "bodyText": "we should remove the todo", "author": "Geosearchef", "createdAt": "2020-02-01T23:19:51Z", "path": "src/main/java/com/faforever/client/game/GameService.java", "diffHunk": "@@ -442,8 +442,8 @@ public void addOnRankedMatchNotificationListener(Consumer<MatchmakerMessage> lis\n             .thenRun(() -> {\n               // TODO this should be sent by the server!", "originalCommit": "ddba564a6d7b882e85435e8a042399a3a982ca9e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM5Mzg4NA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r379393884", "bodyText": "No. We still lack the team number and whatever the players argument does.", "author": "Brutus5000", "createdAt": "2020-02-14T11:57:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwODAwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE5ODY0OQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r426198649", "bodyText": "Team number and players are being sent now. The players argument is just a number that tells the lobby it should wait until that many players have joined before launching the game.", "author": "Askaholic", "createdAt": "2020-05-16T23:02:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwODAwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE4NzgxMw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r427187813", "bodyText": "So u are argueing for removing it?", "author": "1-alex98", "createdAt": "2020-05-19T10:12:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwODAwMA=="}], "type": "inlineReview"}, {"oid": "6c01a025b6ce56524c3385e572f7164a9308bc8b", "url": "https://github.com/FAForever/downlords-faf-client/commit/6c01a025b6ce56524c3385e572f7164a9308bc8b", "message": "Add support for new arguments in GameLaunchMessage\n(fixes #1281)\n\nServer side changes to be found here: https://github.com/FAForever/server/pull/517", "committedDate": "2020-02-14T11:57:51Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY1MTA3Ng==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r392651076", "bodyText": "Can we add the numgames parameter as a dedicated field in this message too instead of passing it via args?", "author": "Askaholic", "createdAt": "2020-03-15T08:10:01Z", "path": "src/main/java/com/faforever/client/remote/domain/GameLaunchMessage.java", "diffHunk": "@@ -1,50 +1,33 @@\n package com.faforever.client.remote.domain;\n \n+import com.faforever.client.fa.relay.LobbyMode;\n+import com.faforever.client.game.Faction;\n+import lombok.Getter;\n+import lombok.NonNull;\n+import lombok.Setter;\n+\n import java.util.List;\n \n+@Getter\n+@Setter\n public class GameLaunchMessage extends FafServerMessage {\n \n+  /**\n+   * Stores game launch arguments, like \"/ratingcolor d8d8d8d8\", \"/numgames 236\".\n+   */\n   private List<String> args;\n   private int uid;\n   private String mod;\n   private String mapname;\n+  @NonNull\n+  private String name;\n+  private int expectedPlayers;\n+  private int team;\n+  private int mapPosition;\n+  private Faction faction;\n+  private LobbyMode initMode;\n ", "originalCommit": "6c01a025b6ce56524c3385e572f7164a9308bc8b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2MTQxNg==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r392661416", "bodyText": "I would say yes why not", "author": "1-alex98", "createdAt": "2020-03-15T10:44:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY1MTA3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5ODk4Nw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r392698987", "bodyText": "Shall we call it num_games?", "author": "Askaholic", "createdAt": "2020-03-15T18:21:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY1MTA3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQxMjU4Nw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r393412587", "bodyText": "I decided not to do this for now", "author": "Askaholic", "createdAt": "2020-03-17T02:35:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY1MTA3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY4MDk4MQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r393680981", "bodyText": "No commented out code ever", "author": "1-alex98", "createdAt": "2020-03-17T13:32:43Z", "path": "src/main/java/com/faforever/client/fa/relay/ice/IceAdapterImpl.java", "diffHunk": "@@ -175,10 +175,10 @@ public void onGpgGameMessage(GpgGameMessageEvent event) {\n         log.warn(\"Forcing ice adapter relay connection\");\n       }\n \n-      if (clientProperties.isShowIceAdapterDebugWindow()) {\n+//      if (clientProperties.isShowIceAdapterDebugWindow()) {", "originalCommit": "f15889792996e2f45be7c1291e09c8c2b1e039b5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5fed913b60fcf23cebcdce564401367011b8672f", "url": "https://github.com/FAForever/downlords-faf-client/commit/5fed913b60fcf23cebcdce564401367011b8672f", "message": "add startspot cmd line parameter", "committedDate": "2020-03-17T21:17:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYyMDgzOQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1570#discussion_r395620839", "bodyText": "no commented out code", "author": "1-alex98", "createdAt": "2020-03-20T13:03:03Z", "path": "src/main/java/com/faforever/client/fa/relay/ice/IceAdapterImpl.java", "diffHunk": "@@ -175,10 +176,10 @@ public void onGpgGameMessage(GpgGameMessageEvent event) {\n         log.warn(\"Forcing ice adapter relay connection\");\n       }\n \n-//      if (clientProperties.isShowIceAdapterDebugWindow()) {", "originalCommit": "96e11a7e6361c9e94638ab22860c7d1c88c0cf22", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8cb89a29d40446f5ce10d885667257e8b0818175", "url": "https://github.com/FAForever/downlords-faf-client/commit/8cb89a29d40446f5ce10d885667257e8b0818175", "message": "Add support for new arguments in GameLaunchMessage\n(fixes #1281)\n\nServer side changes to be found here: https://github.com/FAForever/server/pull/517", "committedDate": "2020-05-20T22:42:22Z", "type": "commit"}, {"oid": "d346488d90f962bb63d08c01fb7f2e692ee11499", "url": "https://github.com/FAForever/downlords-faf-client/commit/d346488d90f962bb63d08c01fb7f2e692ee11499", "message": "fix team parameter, fix unit test", "committedDate": "2020-05-20T22:42:22Z", "type": "commit"}, {"oid": "e5beea738ae3ab0848960ece2aebd446483d2953", "url": "https://github.com/FAForever/downlords-faf-client/commit/e5beea738ae3ab0848960ece2aebd446483d2953", "message": "add startspot cmd line parameter", "committedDate": "2020-05-20T22:42:22Z", "type": "commit"}, {"oid": "e38f51ba941ac965a8166756249a80798290b249", "url": "https://github.com/FAForever/downlords-faf-client/commit/e38f51ba941ac965a8166756249a80798290b249", "message": "support legacy server versions", "committedDate": "2020-05-20T22:42:22Z", "type": "commit"}, {"oid": "e38f51ba941ac965a8166756249a80798290b249", "url": "https://github.com/FAForever/downlords-faf-client/commit/e38f51ba941ac965a8166756249a80798290b249", "message": "support legacy server versions", "committedDate": "2020-05-20T22:42:22Z", "type": "forcePushed"}, {"oid": "10ed76d7fcb866829aee5abbb38e0a67965f8847", "url": "https://github.com/FAForever/downlords-faf-client/commit/10ed76d7fcb866829aee5abbb38e0a67965f8847", "message": "Remove fallback check as the server already supports it", "committedDate": "2020-05-20T22:44:35Z", "type": "commit"}, {"oid": "201ca052abc5ccc9ffed0e5e8c3b72feca19844b", "url": "https://github.com/FAForever/downlords-faf-client/commit/201ca052abc5ccc9ffed0e5e8c3b72feca19844b", "message": "Make unit tests compile again", "committedDate": "2020-05-21T10:31:01Z", "type": "commit"}]}