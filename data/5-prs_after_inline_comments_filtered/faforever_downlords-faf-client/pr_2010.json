{"pr_number": 2010, "pr_title": "Feature/#1400 Information on games", "pr_createdAt": "2020-11-01T07:41:46Z", "pr_url": "https://github.com/FAForever/downlords-faf-client/pull/2010", "timeline": [{"oid": "b882b2ecc9151ea3dabbb26ad6901d0a8e7b3d9d", "url": "https://github.com/FAForever/downlords-faf-client/commit/b882b2ecc9151ea3dabbb26ad6901d0a8e7b3d9d", "message": "#1400 implement displaying tooltip about game info", "committedDate": "2020-11-06T03:59:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODczNDc2Nw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r518734767", "bodyText": "This would be better if the i18n key was an instance variable of the enum. See RatingMode.java for an example.", "author": "Sheikah45", "createdAt": "2020-11-06T12:58:24Z", "path": "src/main/java/com/faforever/client/chat/ChatUserService.java", "diffHunk": "@@ -128,6 +130,15 @@ public void onChatUserGameChange(ChatUserGameChangeEvent event) {\n       chatChannelUser.setStatusImage(null);\n     }\n   }\n+\n+  private String getLocalizedStatusGame(PlayerStatus status) {\n+    return switch (status) {", "originalCommit": "17602d7c0cdc1cd830c3d4330076d88b5d10659f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk5NDkxMQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r518994911", "bodyText": "Okay, I can do it better, but what about a separate IDLE variable that does not have a string? I do not want to put an empty string '' or null for this because a man will have to write extra checks for an empty string or null before getting a localized string else we will get exception NoSuchMessageException.\nHow about adding this check to the get(String, Object...) method of I18n class? Like:\npublic String get(String key, Object... args) {\n    return key == null || key.isEmpty() ? null : get(userSpecificLocale, key, args);\n  }\nOr to implement a method like:\npublic String tryGet(String key, Object... args) {\n    try {\n      return get(key, args);\n    } catch (NoSuchMessageException e) {\n      return null;\n    }\n  }\nWhat do you think about it?", "author": "ivan-gryzunov", "createdAt": "2020-11-06T20:42:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODczNDc2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTAyODczNQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519028735", "bodyText": "I think it would be best to just give idle a message that way if it is used in the future it can be as well.", "author": "Sheikah45", "createdAt": "2020-11-06T22:05:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODczNDc2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA2MTk4NQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519061985", "bodyText": "You can just use this no need for the switch statement\ngameStatusMenu.setText(i18n.get(status.getI18nKey()));", "author": "Sheikah45", "createdAt": "2020-11-07T00:01:52Z", "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "diffHunk": "@@ -209,19 +209,13 @@ private void updateGameStatusMenuText(PlayerStatus status) {\n       return;\n     }\n \n-    switch (status) {\n-      case PLAYING:\n-        gameStatusMenu.setText(i18n.get(\"game.gameStatus.playing\"));\n-        break;\n-      case LOBBYING:\n-        gameStatusMenu.setText(i18n.get(\"game.gameStatus.lobby\"));\n-        break;\n-      case IDLE:\n-        gameStatusMenu.setText(i18n.get(\"game.gameStatus.none\"));\n-        break;\n-      default:\n-        throw new ProgrammingError(\"Uncovered player status: \" + status);\n-    }\n+    String key =  switch (status) {\n+      case PLAYING -> PLAYING.getI18nKey();\n+      case LOBBYING -> LOBBYING.getI18nKey();\n+      case IDLE -> IDLE.getI18nKey();\n+      default -> throw new ProgrammingError(\"Uncovered player status: \" + status);\n+    };\n+    gameStatusMenu.setText(i18n.get(key));", "originalCommit": "509317d6ec57fb6a0e1ef560d2959c56eaf48eb6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NTk5NA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519185994", "bodyText": "java fx tooltips are dangerous in terms of memory leaks. Especially here where content is frequently changed", "author": "1-alex98", "createdAt": "2020-11-07T15:01:28Z", "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "diffHunk": "@@ -70,14 +73,17 @@\n   private final WeakInvalidationListener weakFormatInvalidationListener;\n   private final WeakInvalidationListener weakColorPerUserInvalidationListener;\n \n+  public ImageView playerMapImage;\n   public ImageView playerStatusIndicator;\n+  protected Tooltip statusGameTooltip;\n+  protected Tooltip gameInfoTooltip;", "originalCommit": "a490255f77696a11d79c884dc2a2b7f22f61005a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjA5OA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519186098", "bodyText": "but you seem to take care of it", "author": "1-alex98", "createdAt": "2020-11-07T15:02:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NTk5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIyMA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519186220", "bodyText": "Chat user items are in a recycler view. Meaning tons of them are created and destroyed while scrolling. So all this is safer if it runs on mouse over only", "author": "1-alex98", "createdAt": "2020-11-07T15:04:19Z", "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "diffHunk": "@@ -151,8 +151,72 @@ public void initialize() {\n     JavaFxUtil.bind(playerMapImage.visibleProperty(), Bindings.isNotNull(playerMapImage.imageProperty()));\n \n     updateFormat();\n+    addEventHandlersToPlayerMapImage();\n+  }\n+\n+  private void initializeTooltips() {\n+    userTooltip = new Tooltip();\n+    usernameLabel.setTooltip(userTooltip);\n+\n+    avatarTooltip = new Tooltip();\n+    avatarTooltip.setAnchorLocation(PopupWindow.AnchorLocation.CONTENT_TOP_LEFT);\n+    Tooltip.install(avatarImageView, avatarTooltip);\n+\n+    countryTooltip = new Tooltip();\n+    countryTooltip.showDelayProperty().set(Duration.millis(250));\n+    Tooltip.install(countryImageView, countryTooltip);\n+\n+    statusGameTooltip = new Tooltip();\n+    statusGameTooltip.setShowDuration(Duration.seconds(30));\n+    statusGameTooltip.setShowDelay(Duration.ZERO);\n+    statusGameTooltip.setHideDelay(Duration.ZERO);\n+    Tooltip.install(playerStatusIndicator, statusGameTooltip);\n   }", "originalCommit": "a490255f77696a11d79c884dc2a2b7f22f61005a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjczMw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519186733", "bodyText": "This was a change in the chat optimization so might not be related to this pr specifically and would probably need to be done in another pr.", "author": "Sheikah45", "createdAt": "2020-11-07T15:09:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTIxNjEzOA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519216138", "bodyText": "I understand that there is no need to redo this code?", "author": "ivan-gryzunov", "createdAt": "2020-11-07T20:38:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTIzMDUzNg==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519230536", "bodyText": "Yeah if it is redone it wont be in this pr", "author": "Sheikah45", "createdAt": "2020-11-07T23:02:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIyMA=="}], "type": "inlineReview"}, {"oid": "09529a61b40287e2931c72e8961f9c27c80ff004", "url": "https://github.com/FAForever/downlords-faf-client/commit/09529a61b40287e2931c72e8961f9c27c80ff004", "message": "#1400 implement displaying tooltip about game info", "committedDate": "2020-11-07T22:52:20Z", "type": "commit"}, {"oid": "38e2184e700fada9da34fe2ac5749e0954f5cd77", "url": "https://github.com/FAForever/downlords-faf-client/commit/38e2184e700fada9da34fe2ac5749e0954f5cd77", "message": "Merge branch 'develop' into feature/#1400-information-on-games", "committedDate": "2020-11-07T22:57:32Z", "type": "commit"}, {"oid": "38e2184e700fada9da34fe2ac5749e0954f5cd77", "url": "https://github.com/FAForever/downlords-faf-client/commit/38e2184e700fada9da34fe2ac5749e0954f5cd77", "message": "Merge branch 'develop' into feature/#1400-information-on-games", "committedDate": "2020-11-07T22:57:32Z", "type": "forcePushed"}, {"oid": "fbac4262d453dcd4447e85db220c74951655d2a8", "url": "https://github.com/FAForever/downlords-faf-client/commit/fbac4262d453dcd4447e85db220c74951655d2a8", "message": "Merge branch 'develop' into feature/#1400-information-on-games", "committedDate": "2020-11-09T14:13:49Z", "type": "commit"}]}