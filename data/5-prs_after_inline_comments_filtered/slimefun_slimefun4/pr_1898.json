{"pr_number": 1898, "pr_title": "Backpack command", "pr_createdAt": "2020-05-10T21:39:00Z", "pr_url": "https://github.com/Slimefun/Slimefun4/pull/1898", "timeline": [{"oid": "fcf28fdf7f662379946b7e0e3511b6d1e750f9d7", "url": "https://github.com/Slimefun/Slimefun4/commit/fcf28fdf7f662379946b7e0e3511b6d1e750f9d7", "message": "Added a command to retrieve lost backpacks", "committedDate": "2020-05-10T21:27:09Z", "type": "commit"}, {"oid": "0fc0a0be29b22d98129afbea4fe9a94b54f423ee", "url": "https://github.com/Slimefun/Slimefun4/commit/0fc0a0be29b22d98129afbea4fe9a94b54f423ee", "message": "I said, added a command!", "committedDate": "2020-05-10T21:28:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcwNTU3Mw==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422705573", "bodyText": "This is a little redundant. Bukkit.getOfflinePlayer(...) will return an online player if possible anyway, so potentially calling this twice makes little sense, can pretty much just call Bukkit.getOfflinePlayer(...) right away", "author": "TheBusyBiscuit", "createdAt": "2020-05-10T21:53:27Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/BackpackCommand.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerBackpack;\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerProfile;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;\n+import org.bukkit.Bukkit;\n+import org.bukkit.ChatColor;\n+import org.bukkit.OfflinePlayer;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+\n+import java.util.List;\n+\n+class BackpackCommand extends SubCommand {\n+\n+    BackpackCommand(SlimefunPlugin plugin, SlimefunCommand cmd) {\n+        super(plugin, cmd);\n+    }\n+\n+    @Override\n+    public String getName() {\n+        return \"backpack\";\n+    }\n+\n+    @Override\n+    public boolean isHidden() {\n+        return false;\n+    }\n+\n+    @Override\n+    public void onExecute(CommandSender sender, String[] args) {\n+        if (!(sender instanceof Player) || !(sender.hasPermission(\"slimefun.command.backpack\"))) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.no-permission\", true);\n+            return;\n+        }\n+        if (args.length != 3) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.usage\", true, msg -> msg.replace(\"%usage%\", \"/sf backpack <Player> <Number>\"));\n+            return;\n+        }\n+\n+        Player p = (Player) sender;\n+        String ownerName = args[1];\n+        int id = Integer.parseInt(args[2]);\n+        OfflinePlayer owner = Bukkit.getPlayer(ownerName);\n+\n+        if (owner == null) {\n+            owner = Bukkit.getOfflinePlayer(ownerName);", "originalCommit": "0fc0a0be29b22d98129afbea4fe9a94b54f423ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcwNTg5OA==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422705898", "bodyText": "Please add a space after the comma", "author": "TheBusyBiscuit", "createdAt": "2020-05-10T21:56:52Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/Commands.java", "diffHunk": "@@ -25,5 +25,6 @@ public static void addCommands(SlimefunCommand cmd, Collection<SubCommand> comma\n         commands.add(new OpenGuideCommand(plugin, cmd));\n         commands.add(new SearchCommand(plugin, cmd));\n         commands.add(new DebugFishCommand(plugin, cmd));\n+        commands.add(new BackpackCommand(plugin,cmd));", "originalCommit": "0fc0a0be29b22d98129afbea4fe9a94b54f423ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcwNTk1Ng==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422705956", "bodyText": "Pretty sure you can just use BackpackListener#setBackpackId(...) or so here, might have to look into that", "author": "TheBusyBiscuit", "createdAt": "2020-05-10T21:57:34Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/BackpackCommand.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerBackpack;\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerProfile;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;\n+import org.bukkit.Bukkit;\n+import org.bukkit.ChatColor;\n+import org.bukkit.OfflinePlayer;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+\n+import java.util.List;\n+\n+class BackpackCommand extends SubCommand {\n+\n+    BackpackCommand(SlimefunPlugin plugin, SlimefunCommand cmd) {\n+        super(plugin, cmd);\n+    }\n+\n+    @Override\n+    public String getName() {\n+        return \"backpack\";\n+    }\n+\n+    @Override\n+    public boolean isHidden() {\n+        return false;\n+    }\n+\n+    @Override\n+    public void onExecute(CommandSender sender, String[] args) {\n+        if (!(sender instanceof Player) || !(sender.hasPermission(\"slimefun.command.backpack\"))) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.no-permission\", true);\n+            return;\n+        }\n+        if (args.length != 3) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.usage\", true, msg -> msg.replace(\"%usage%\", \"/sf backpack <Player> <Number>\"));\n+            return;\n+        }\n+\n+        Player p = (Player) sender;\n+        String ownerName = args[1];\n+        int id = Integer.parseInt(args[2]);\n+        OfflinePlayer owner = Bukkit.getPlayer(ownerName);\n+\n+        if (owner == null) {\n+            owner = Bukkit.getOfflinePlayer(ownerName);\n+            if (!owner.hasPlayedBefore()) {\n+                SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.player-never-joined\");\n+                return;\n+            }\n+        }\n+\n+        PlayerProfile.get(owner, profile -> {\n+            if (!profile.getBackpack(id).isPresent()) {\n+                SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.backpack-does-not-exist\");\n+                return;\n+            }\n+            PlayerBackpack bp = profile.getBackpack(id).get();\n+            //No point switching for size, would still miss soulbound\n+            ItemStack item = SlimefunItems.BACKPACK_MEDIUM;\n+            ItemMeta meta = item.getItemMeta();\n+            List lore = meta.getLore();\n+            lore.set(2, ChatColor.GRAY + \"ID: \" + profile.getUUID().toString() + \"#\" + id);\n+            meta.setLore(lore);\n+            item.setItemMeta(meta);", "originalCommit": "0fc0a0be29b22d98129afbea4fe9a94b54f423ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcwNjE5NQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422706195", "bodyText": "Should probably also send a message like \"Heres your backpack\" or so", "author": "TheBusyBiscuit", "createdAt": "2020-05-10T21:58:43Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/BackpackCommand.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerBackpack;\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerProfile;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;\n+import org.bukkit.Bukkit;\n+import org.bukkit.ChatColor;\n+import org.bukkit.OfflinePlayer;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+\n+import java.util.List;\n+\n+class BackpackCommand extends SubCommand {\n+\n+    BackpackCommand(SlimefunPlugin plugin, SlimefunCommand cmd) {\n+        super(plugin, cmd);\n+    }\n+\n+    @Override\n+    public String getName() {\n+        return \"backpack\";\n+    }\n+\n+    @Override\n+    public boolean isHidden() {\n+        return false;\n+    }\n+\n+    @Override\n+    public void onExecute(CommandSender sender, String[] args) {\n+        if (!(sender instanceof Player) || !(sender.hasPermission(\"slimefun.command.backpack\"))) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.no-permission\", true);\n+            return;\n+        }\n+        if (args.length != 3) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.usage\", true, msg -> msg.replace(\"%usage%\", \"/sf backpack <Player> <Number>\"));\n+            return;\n+        }\n+\n+        Player p = (Player) sender;\n+        String ownerName = args[1];\n+        int id = Integer.parseInt(args[2]);\n+        OfflinePlayer owner = Bukkit.getPlayer(ownerName);\n+\n+        if (owner == null) {\n+            owner = Bukkit.getOfflinePlayer(ownerName);\n+            if (!owner.hasPlayedBefore()) {\n+                SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.player-never-joined\");\n+                return;\n+            }\n+        }\n+\n+        PlayerProfile.get(owner, profile -> {\n+            if (!profile.getBackpack(id).isPresent()) {\n+                SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.backpack-does-not-exist\");\n+                return;\n+            }\n+            PlayerBackpack bp = profile.getBackpack(id).get();\n+            //No point switching for size, would still miss soulbound\n+            ItemStack item = SlimefunItems.BACKPACK_MEDIUM;\n+            ItemMeta meta = item.getItemMeta();\n+            List lore = meta.getLore();\n+            lore.set(2, ChatColor.GRAY + \"ID: \" + profile.getUUID().toString() + \"#\" + id);\n+            meta.setLore(lore);\n+            item.setItemMeta(meta);\n+            Slimefun.runSync(() -> p.getInventory().addItem(item));", "originalCommit": "0fc0a0be29b22d98129afbea4fe9a94b54f423ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e021fb9ce35eb7ede4cf3ebf65991e9c24af3813", "url": "https://github.com/Slimefun/Slimefun4/commit/e021fb9ce35eb7ede4cf3ebf65991e9c24af3813", "message": "Tweaked, requested changes added", "committedDate": "2020-05-10T23:25:59Z", "type": "commit"}, {"oid": "cedd749edb4a740bba18a5bdd549c1b6a45fead7", "url": "https://github.com/Slimefun/Slimefun4/commit/cedd749edb4a740bba18a5bdd549c1b6a45fead7", "message": "Split a line for readability", "committedDate": "2020-05-10T23:46:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxODE4Mw==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422718183", "bodyText": "Variable is only ever used once, no point in it", "author": "WalshyDev", "createdAt": "2020-05-10T23:44:12Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/BackpackCommand.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerProfile;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import io.github.thebusybiscuit.slimefun4.utils.PatternUtils;\n+import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;\n+import org.bukkit.Bukkit;\n+import org.bukkit.OfflinePlayer;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+\n+class BackpackCommand extends SubCommand {\n+\n+    BackpackCommand(SlimefunPlugin plugin, SlimefunCommand cmd) {\n+        super(plugin, cmd);\n+    }\n+\n+    @Override\n+    public String getName() {\n+        return \"backpack\";\n+    }\n+\n+    @Override\n+    public boolean isHidden() {\n+        return false;\n+    }\n+\n+    @Override\n+    public void onExecute(CommandSender sender, String[] args) {\n+        if (!(sender instanceof Player) || !(sender.hasPermission(\"slimefun.command.backpack\"))) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.no-permission\", true);\n+            return;\n+        }\n+        if (args.length != 3) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.usage\", true, msg -> msg.replace(\"%usage%\", \"/sf backpack <Player> <ID>\"));\n+            return;\n+        }\n+\n+        final Player p = (Player) sender;\n+        final String ownerName = args[1];", "originalCommit": "e021fb9ce35eb7ede4cf3ebf65991e9c24af3813", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxODI0NQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422718245", "bodyText": "Looks very long, I assume this is over column limit?", "author": "WalshyDev", "createdAt": "2020-05-10T23:44:40Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/BackpackCommand.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerProfile;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import io.github.thebusybiscuit.slimefun4.utils.PatternUtils;\n+import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;\n+import org.bukkit.Bukkit;\n+import org.bukkit.OfflinePlayer;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+\n+class BackpackCommand extends SubCommand {\n+\n+    BackpackCommand(SlimefunPlugin plugin, SlimefunCommand cmd) {\n+        super(plugin, cmd);\n+    }\n+\n+    @Override\n+    public String getName() {\n+        return \"backpack\";\n+    }\n+\n+    @Override\n+    public boolean isHidden() {\n+        return false;\n+    }\n+\n+    @Override\n+    public void onExecute(CommandSender sender, String[] args) {\n+        if (!(sender instanceof Player) || !(sender.hasPermission(\"slimefun.command.backpack\"))) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.no-permission\", true);\n+            return;\n+        }\n+        if (args.length != 3) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.usage\", true, msg -> msg.replace(\"%usage%\", \"/sf backpack <Player> <ID>\"));", "originalCommit": "e021fb9ce35eb7ede4cf3ebf65991e9c24af3813", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxODI5NA==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422718294", "bodyText": "Redundant brackets around hasPermission statement", "author": "WalshyDev", "createdAt": "2020-05-10T23:45:04Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/BackpackCommand.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerProfile;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import io.github.thebusybiscuit.slimefun4.utils.PatternUtils;\n+import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;\n+import org.bukkit.Bukkit;\n+import org.bukkit.OfflinePlayer;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+\n+class BackpackCommand extends SubCommand {\n+\n+    BackpackCommand(SlimefunPlugin plugin, SlimefunCommand cmd) {\n+        super(plugin, cmd);\n+    }\n+\n+    @Override\n+    public String getName() {\n+        return \"backpack\";\n+    }\n+\n+    @Override\n+    public boolean isHidden() {\n+        return false;\n+    }\n+\n+    @Override\n+    public void onExecute(CommandSender sender, String[] args) {\n+        if (!(sender instanceof Player) || !(sender.hasPermission(\"slimefun.command.backpack\"))) {", "originalCommit": "e021fb9ce35eb7ede4cf3ebf65991e9c24af3813", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxODQ0OQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422718449", "bodyText": "Make this a SlimefunItemStack", "author": "WalshyDev", "createdAt": "2020-05-10T23:46:14Z", "path": "src/main/java/me/mrCookieSlime/Slimefun/Lists/SlimefunItems.java", "diffHunk": "@@ -72,6 +72,8 @@ private SlimefunItems() {}\n     public static final ItemStack RADIANT_BACKPACK = new SlimefunItemStack(\"RADIANT_BACKPACK\", \"40cb1e67b512ab2d4bf3d7ace0eaaf61c32cd4681ddc3987ceb326706a33fa\", \"&eRadiant Backpack\", \"\", \"&7Size: &e54 (Double chest)\", \"&7ID: <ID>\", \"\", \"&7&eRight Click&7 to open\");\n     public static final SlimefunItemStack BOUND_BACKPACK = new SlimefunItemStack(\"BOUND_BACKPACK\", \"2a3b34862b9afb63cf8d5779966d3fba70af82b04e83f3eaf6449aeba\", \"&cSoulbound Backpack\", \"\", \"&7Size: &e36\", \"&7ID: <ID>\", \"\", \"&7&eRight Click&7 to open\");\n     public static final SlimefunItemStack COOLER = new SlimefunItemStack(\"COOLER\", \"d4c1572584eb5de229de9f5a4f779d0aacbaffd33bcb33eb4536a6a2bc6a1\", \"&bCooler\", \"&rAllows you to store Juices/Smoothies\", \"&rand automatically consumes them when you are hungry\", \"&rand you have this in your Inventory\", \"\", \"&7Size: &e27\", \"&7ID: <ID>\", \"\", \"&7&eRight Click&7 to open\");\n+    public static final ItemStack RESTORED_BACKPACK = new SlimefunItemStack(\"RESTORED_BACKPACK\", \"40cb1e67b512ab2d4bf3d7ace0eaaf61c32cd4681ddc3987ceb326706a33fa\", \"&eRestored Backpack\", \"\", \"&7Retrieve your lost items\", \"\", \"&7&eRight Click&7 to open\");", "originalCommit": "e021fb9ce35eb7ede4cf3ebf65991e9c24af3813", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxOTAzMQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422719031", "bodyText": "Why? All of them are ItemStack, it would not be coherent", "author": "Sfiguz7", "createdAt": "2020-05-10T23:50:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxODQ0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxOTE3OA==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422719178", "bodyText": "They're being moved to SlimefunItemStack. ItemStack is the old shit. You're right now just causing stupidly useless casts.", "author": "WalshyDev", "createdAt": "2020-05-10T23:51:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxODQ0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxODU2Mg==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r422718562", "bodyText": "Never set the backpack ID or anything...", "author": "WalshyDev", "createdAt": "2020-05-10T23:47:25Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/BackpackCommand.java", "diffHunk": "@@ -0,0 +1,67 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerProfile;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import io.github.thebusybiscuit.slimefun4.utils.PatternUtils;\n+import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;\n+import org.bukkit.Bukkit;\n+import org.bukkit.OfflinePlayer;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+\n+class BackpackCommand extends SubCommand {\n+\n+    BackpackCommand(SlimefunPlugin plugin, SlimefunCommand cmd) {\n+        super(plugin, cmd);\n+    }\n+\n+    @Override\n+    public String getName() {\n+        return \"backpack\";\n+    }\n+\n+    @Override\n+    public boolean isHidden() {\n+        return false;\n+    }\n+\n+    @Override\n+    public void onExecute(CommandSender sender, String[] args) {\n+        if (!(sender instanceof Player) || !(sender.hasPermission(\"slimefun.command.backpack\"))) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.no-permission\", true);\n+            return;\n+        }\n+        if (args.length != 3) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.usage\", true,\n+                    msg -> msg.replace(\"%usage%\", \"/sf backpack <Player> <ID>\"));\n+            return;\n+        }\n+\n+        final Player p = (Player) sender;\n+        final String ownerName = args[1];\n+        if (!PatternUtils.NUMERIC.matcher(args[2]).matches()){\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.invalid-id\");\n+            return;\n+        }\n+        final int id = Integer.parseInt(args[2]);\n+        final OfflinePlayer owner = Bukkit.getOfflinePlayer(ownerName);\n+        if (!owner.hasPlayedBefore()) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.player-never-joined\");\n+            return;\n+        }\n+\n+        PlayerProfile.get(owner, profile -> {\n+            if (!profile.getBackpack(id).isPresent()) {\n+                SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.backpack-does-not-exist\");\n+                return;\n+            }\n+            Slimefun.runSync(() -> {\n+                p.getInventory().addItem(SlimefunItems.RESTORED_BACKPACK);", "originalCommit": "cedd749edb4a740bba18a5bdd549c1b6a45fead7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "21f21ed67160ea4ee3a81f8e08f67a1ef0f0d610", "url": "https://github.com/Slimefun/Slimefun4/commit/21f21ed67160ea4ee3a81f8e08f67a1ef0f0d610", "message": "Last fixes(?)", "committedDate": "2020-05-11T00:18:06Z", "type": "commit"}, {"oid": "cb8efb2d55b9cb9033a927495c6fa0cd38c12b3e", "url": "https://github.com/Slimefun/Slimefun4/commit/cb8efb2d55b9cb9033a927495c6fa0cd38c12b3e", "message": "Revert \"Last fixes(?)\"\n\nThis reverts commit 21f21ed67160ea4ee3a81f8e08f67a1ef0f0d610.", "committedDate": "2020-05-11T07:19:25Z", "type": "commit"}, {"oid": "da25ac9f80e0cedbd7381bba9e21a9e684fdb6e6", "url": "https://github.com/Slimefun/Slimefun4/commit/da25ac9f80e0cedbd7381bba9e21a9e684fdb6e6", "message": "Redone fixes without formatting", "committedDate": "2020-05-11T07:24:01Z", "type": "commit"}, {"oid": "bcb2add2a67e94cf9eff324cf547436b11f965ab", "url": "https://github.com/Slimefun/Slimefun4/commit/bcb2add2a67e94cf9eff324cf547436b11f965ab", "message": "Integrity! HiddenBackpack now accepts size, restored bp has 54", "committedDate": "2020-05-11T13:19:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzAzMTY4Nw==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r423031687", "bodyText": "Pretty sure you can do BackpackListener#setBackpackId(...) her... wait a second didn't I already say that?", "author": "TheBusyBiscuit", "createdAt": "2020-05-11T13:17:56Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/BackpackCommand.java", "diffHunk": "@@ -0,0 +1,77 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerProfile;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import io.github.thebusybiscuit.slimefun4.utils.PatternUtils;\n+import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;\n+import org.bukkit.Bukkit;\n+import org.bukkit.ChatColor;\n+import org.bukkit.OfflinePlayer;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+\n+import java.util.List;\n+\n+class BackpackCommand extends SubCommand {\n+\n+    BackpackCommand(SlimefunPlugin plugin, SlimefunCommand cmd) {\n+        super(plugin, cmd);\n+    }\n+\n+    @Override\n+    public String getName() {\n+        return \"backpack\";\n+    }\n+\n+    @Override\n+    public boolean isHidden() {\n+        return false;\n+    }\n+\n+    @Override\n+    public void onExecute(CommandSender sender, String[] args) {\n+        if (!(sender instanceof Player) || !sender.hasPermission(\"slimefun.command.backpack\")) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.no-permission\", true);\n+            return;\n+        }\n+        if (args.length != 3) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.usage\", true,\n+                    msg -> msg.replace(\"%usage%\", \"/sf backpack <Player> <ID>\"));\n+            return;\n+        }\n+\n+        final Player p = (Player) sender;\n+        if (!PatternUtils.NUMERIC.matcher(args[2]).matches()) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.invalid-id\");\n+            return;\n+        }\n+        final int id = Integer.parseInt(args[2]);\n+        final OfflinePlayer owner = Bukkit.getOfflinePlayer(args[1]);\n+        if (!owner.hasPlayedBefore()) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.player-never-joined\");\n+            return;\n+        }\n+\n+        PlayerProfile.get(owner, profile -> {\n+            if (!profile.getBackpack(id).isPresent()) {\n+                SlimefunPlugin.getLocal().sendMessage(sender, \"guide.backpack.backpack-does-not-exist\");\n+                return;\n+            }\n+            Slimefun.runSync(() -> {\n+                ItemStack item = SlimefunItems.RESTORED_BACKPACK;\n+                ItemMeta meta = item.getItemMeta();\n+                List lore = meta.getLore();\n+                lore.set(2, ChatColor.GRAY + \"ID: \" + profile.getUUID().toString() + \"#\" + id);\n+                meta.setLore(lore);\n+                item.setItemMeta(meta);", "originalCommit": "da25ac9f80e0cedbd7381bba9e21a9e684fdb6e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA0NDAxOA==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r423044018", "bodyText": "I think I mistakenly resolved it and didn't read it heh now it's resolved", "author": "Sfiguz7", "createdAt": "2020-05-11T13:36:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzAzMTY4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzAzMjA5Mw==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r423032093", "bodyText": "Should maybe rather be called \"RestoredBackpack\". Also please add adequate javadocs here.", "author": "TheBusyBiscuit", "createdAt": "2020-05-11T13:18:35Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/tools/HiddenBackpack.java", "diffHunk": "@@ -0,0 +1,14 @@\n+package io.github.thebusybiscuit.slimefun4.implementation.items.tools;\n+\n+import me.mrCookieSlime.Slimefun.Lists.RecipeType;\n+import me.mrCookieSlime.Slimefun.Objects.Category;\n+import me.mrCookieSlime.Slimefun.api.SlimefunItemStack;\n+import org.bukkit.inventory.ItemStack;\n+\n+public class HiddenBackpack extends SlimefunBackpack {", "originalCommit": "da25ac9f80e0cedbd7381bba9e21a9e684fdb6e6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "23fdd45b3dedd898b711d1fd1db7b5b854d6329a", "url": "https://github.com/Slimefun/Slimefun4/commit/23fdd45b3dedd898b711d1fd1db7b5b854d6329a", "message": "Messages fixes, Refactored HiddenBackpack to be dedicated to restored bp", "committedDate": "2020-05-11T13:35:35Z", "type": "commit"}, {"oid": "b2856755d9b89e9dacbfba6e7cd0b6709fcb2f4f", "url": "https://github.com/Slimefun/Slimefun4/commit/b2856755d9b89e9dacbfba6e7cd0b6709fcb2f4f", "message": "Added Javadocs, removed unnecessary parameter", "committedDate": "2020-05-11T14:11:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA5NjYxOA==", "url": "https://github.com/Slimefun/Slimefun4/pull/1898#discussion_r423096618", "bodyText": "Hold up...\nVery dangerous here, you need to add a .clone() otherwise you are modifying the original and not a copy.", "author": "TheBusyBiscuit", "createdAt": "2020-05-11T14:50:31Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/BackpackCommand.java", "diffHunk": "@@ -0,0 +1,72 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.api.player.PlayerProfile;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import io.github.thebusybiscuit.slimefun4.utils.PatternUtils;\n+import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;\n+import org.bukkit.Bukkit;\n+import org.bukkit.ChatColor;\n+import org.bukkit.OfflinePlayer;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+\n+import java.util.List;\n+\n+class BackpackCommand extends SubCommand {\n+\n+    BackpackCommand(SlimefunPlugin plugin, SlimefunCommand cmd) {\n+        super(plugin, cmd);\n+    }\n+\n+    @Override\n+    public String getName() {\n+        return \"backpack\";\n+    }\n+\n+    @Override\n+    public boolean isHidden() {\n+        return false;\n+    }\n+\n+    @Override\n+    public void onExecute(CommandSender sender, String[] args) {\n+        if (!(sender instanceof Player) || !sender.hasPermission(\"slimefun.command.backpack\")) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.no-permission\", true);\n+            return;\n+        }\n+        if (args.length != 3) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"messages.usage\", true,\n+                    msg -> msg.replace(\"%usage%\", \"/sf backpack <Player> <ID>\"));\n+            return;\n+        }\n+\n+        final Player p = (Player) sender;\n+        if (!PatternUtils.NUMERIC.matcher(args[2]).matches()) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"commands.backpack.invalid-id\");\n+            return;\n+        }\n+        final int id = Integer.parseInt(args[2]);\n+        final OfflinePlayer owner = Bukkit.getOfflinePlayer(args[1]);\n+        if (!owner.hasPlayedBefore()) {\n+            SlimefunPlugin.getLocal().sendMessage(sender, \"commands.backpack.player-never-joined\");\n+            return;\n+        }\n+\n+        PlayerProfile.get(owner, profile -> {\n+            if (!profile.getBackpack(id).isPresent()) {\n+                SlimefunPlugin.getLocal().sendMessage(sender, \"commands.backpack.backpack-does-not-exist\");\n+                return;\n+            }\n+            Slimefun.runSync(() -> {\n+                ItemStack item = SlimefunItems.RESTORED_BACKPACK;", "originalCommit": "b2856755d9b89e9dacbfba6e7cd0b6709fcb2f4f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8c0ff9acfb2149b9e8a5a1c2c7bf5e9cc9866b6f", "url": "https://github.com/Slimefun/Slimefun4/commit/8c0ff9acfb2149b9e8a5a1c2c7bf5e9cc9866b6f", "message": "Now cloning :/ Also fixed double key in messages", "committedDate": "2020-05-11T14:58:58Z", "type": "commit"}, {"oid": "8b09111b4a11b226114780cef966eeddd3957973", "url": "https://github.com/Slimefun/Slimefun4/commit/8b09111b4a11b226114780cef966eeddd3957973", "message": "Overridden description getter", "committedDate": "2020-05-11T20:19:33Z", "type": "commit"}]}