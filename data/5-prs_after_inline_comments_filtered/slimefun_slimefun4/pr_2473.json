{"pr_number": 2473, "pr_title": "Fixes ArmorForge", "pr_createdAt": "2020-10-14T16:42:23Z", "pr_url": "https://github.com/Slimefun/Slimefun4/pull/2473", "timeline": [{"oid": "1437a8d55550f841b98f4529c66929e8f2f28ef2", "url": "https://github.com/Slimefun/Slimefun4/commit/1437a8d55550f841b98f4529c66929e8f2f28ef2", "message": "Added FakeInv in ArmorForge", "committedDate": "2020-10-14T16:04:57Z", "type": "commit"}, {"oid": "35fc23c428a7bbeefde12f3e4c7c263a09bbd281", "url": "https://github.com/Slimefun/Slimefun4/commit/35fc23c428a7bbeefde12f3e4c7c263a09bbd281", "message": "Redundant import", "committedDate": "2020-10-14T16:10:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1MDE5Ng==", "url": "https://github.com/Slimefun/Slimefun4/pull/2473#discussion_r507650196", "bodyText": "This could use some annotations.", "author": "TheBusyBiscuit", "createdAt": "2020-10-19T10:47:34Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/multiblocks/ArmorForge.java", "diffHunk": "@@ -71,26 +66,51 @@ private boolean isCraftable(Inventory inv, ItemStack[] recipe) {\n         return true;\n     }\n \n-    private void craft(Player p, ItemStack output, Inventory inv, Inventory outputInv) {\n-        for (int j = 0; j < 9; j++) {\n-            ItemStack item = inv.getContents()[j];\n+    private Inventory createVirtualInventory(Inventory inv) {\n+        Inventory fakeInv = Bukkit.createInventory(null, 9, \"Fake Inventory\");\n+\n+        for (int j = 0; j < inv.getContents().length; j++) {\n+            ItemStack stack = inv.getContents()[j];\n \n-            if (item != null && item.getType() != Material.AIR) {\n-                ItemUtils.consumeItem(item, true);\n+            if (stack != null) {\n+                stack = stack.clone();\n+                ItemUtils.consumeItem(stack, true);\n             }\n+\n+            fakeInv.setItem(j, stack);\n         }\n \n-        for (int j = 0; j < 4; j++) {\n-            int current = j;\n+        return fakeInv;\n+    }\n+\n+    private void craft(Player p, ItemStack output, Inventory inv, Block dispenser) {", "originalCommit": "35fc23c428a7bbeefde12f3e4c7c263a09bbd281", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1MDc3NQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2473#discussion_r507650775", "bodyText": "Is this method copied from anywhere?\nI think it would make sense to make it a static utility method or so since we would otherwise face a lot of redundancies and duplications.", "author": "TheBusyBiscuit", "createdAt": "2020-10-19T10:48:35Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/multiblocks/ArmorForge.java", "diffHunk": "@@ -71,26 +66,51 @@ private boolean isCraftable(Inventory inv, ItemStack[] recipe) {\n         return true;\n     }\n \n-    private void craft(Player p, ItemStack output, Inventory inv, Inventory outputInv) {\n-        for (int j = 0; j < 9; j++) {\n-            ItemStack item = inv.getContents()[j];\n+    private Inventory createVirtualInventory(Inventory inv) {\n+        Inventory fakeInv = Bukkit.createInventory(null, 9, \"Fake Inventory\");\n+\n+        for (int j = 0; j < inv.getContents().length; j++) {\n+            ItemStack stack = inv.getContents()[j];\n \n-            if (item != null && item.getType() != Material.AIR) {\n-                ItemUtils.consumeItem(item, true);\n+            if (stack != null) {\n+                stack = stack.clone();\n+                ItemUtils.consumeItem(stack, true);\n             }\n+\n+            fakeInv.setItem(j, stack);\n         }\n \n-        for (int j = 0; j < 4; j++) {\n-            int current = j;\n+        return fakeInv;\n+    }", "originalCommit": "35fc23c428a7bbeefde12f3e4c7c263a09bbd281", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkzNDM0OQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2473#discussion_r507934349", "bodyText": "Is this method copied from anywhere?\n\nYes, from BackpackCrafter: \n  \n    \n      Slimefun4/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/multiblocks/BackpackCrafter.java\n    \n    \n         Line 43\n      in\n      c9adba2\n    \n    \n    \n    \n\n        \n          \n           protected Inventory createVirtualInventory(Inventory inv) { \n        \n    \n  \n\n\nHow do I tackle this? Make ArmorForge extends BackpackCrafter instead of MultiBlockMachine since latter is already extended in BackpackCrafter. Sorry. I know its messy but I am learning and loving it so far :D", "author": "CURVX", "createdAt": "2020-10-19T17:39:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1MDc3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk4MzIwOQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2473#discussion_r507983209", "bodyText": "I think making it extend BackpackCrafter should be fine, even though the BackpackCrafter class might need a new name after this XD", "author": "TheBusyBiscuit", "createdAt": "2020-10-19T18:44:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1MDc3NQ=="}], "type": "inlineReview"}, {"oid": "f651f960c0bf36fb8fc05cab09a61985e07c1343", "url": "https://github.com/Slimefun/Slimefun4/commit/f651f960c0bf36fb8fc05cab09a61985e07c1343", "message": "Made ArmorForge extend BackpackCrafter", "committedDate": "2020-10-19T17:26:14Z", "type": "commit"}, {"oid": "71ca1458fef2837b77871aaa91e457293981770e", "url": "https://github.com/Slimefun/Slimefun4/commit/71ca1458fef2837b77871aaa91e457293981770e", "message": "Changes req. by TTB", "committedDate": "2020-10-19T19:02:20Z", "type": "commit"}]}