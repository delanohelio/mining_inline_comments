{"pr_number": 4324, "pr_title": "[GEOS-9658] SecuredFeatureSource incorrectly logs when requesting Com\u2026", "pr_createdAt": "2020-06-22T12:30:44Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4324", "timeline": [{"oid": "d9464783479756a0cf67cb452d7a89940f267bcb", "url": "https://github.com/geoserver/geoserver/commit/d9464783479756a0cf67cb452d7a89940f267bcb", "message": "[GEOS-9658] SecuredFeatureSource incorrectly logs when requesting ComplexFeatures with a sld style", "committedDate": "2020-06-22T12:26:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzYyMzgzNA==", "url": "https://github.com/geoserver/geoserver/pull/4324#discussion_r443623834", "bodyText": "Ah ok, so this hides the log in case the security subsystem specifies no restrictions right?\nHowever, the check seems to be too broad, what if the security subsystem was returning a filter to reduce the features, while keeping all the attributes? Better to check the readQuery for the property list, and see if all properties were allowed instead.", "author": "aaime", "createdAt": "2020-06-22T15:00:04Z", "path": "src/main/src/main/java/org/geoserver/security/decorators/SecuredFeatureSource.java", "diffHunk": "@@ -89,12 +89,14 @@ protected SecuredFeatureSource(FeatureSource<T, F> delegate, WrapperPolicy polic\n                     ReTypingFeatureCollection retyped = new ReTypingFeatureCollection(sfc, target);\n                     return (FeatureCollection) SecuredObjects.secure(retyped, policy);\n                 } else {\n-                    // complex feature store eh? No way to fix it at least warn the admin\n-                    LOGGER.log(\n-                            Level.SEVERE,\n-                            \"Complex store returned more properties than allowed \"\n-                                    + \"by security (because they are required by the schema). \"\n-                                    + \"Either the security setup is broken or you have a security breach\");\n+                    if (!readQuery.equals(Query.ALL)) {", "originalCommit": "d9464783479756a0cf67cb452d7a89940f267bcb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "19717bf4f91051be0926a042ebd4c8971930d122", "url": "https://github.com/geoserver/geoserver/commit/19717bf4f91051be0926a042ebd4c8971930d122", "message": "reviewer's suggestions applied", "committedDate": "2020-06-23T07:51:50Z", "type": "forcePushed"}, {"oid": "2d999efb530c192818603a2aee3cad9772814de7", "url": "https://github.com/geoserver/geoserver/commit/2d999efb530c192818603a2aee3cad9772814de7", "message": "reviewer's suggestions applied", "committedDate": "2020-06-23T08:46:46Z", "type": "commit"}, {"oid": "2d999efb530c192818603a2aee3cad9772814de7", "url": "https://github.com/geoserver/geoserver/commit/2d999efb530c192818603a2aee3cad9772814de7", "message": "reviewer's suggestions applied", "committedDate": "2020-06-23T08:46:46Z", "type": "forcePushed"}]}