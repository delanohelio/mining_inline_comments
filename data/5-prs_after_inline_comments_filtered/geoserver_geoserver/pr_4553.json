{"pr_number": 4553, "pr_title": "[GEOS-9756] Layer configured with missing style throws NPE", "pr_createdAt": "2020-10-30T16:03:19Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4553", "timeline": [{"oid": "4fb3971f0a1262045e28a7afe7fef4301b19c63c", "url": "https://github.com/geoserver/geoserver/commit/4fb3971f0a1262045e28a7afe7fef4301b19c63c", "message": "remove broken styles from layers on load", "committedDate": "2020-10-30T16:01:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg5NTYwNA==", "url": "https://github.com/geoserver/geoserver/pull/4553#discussion_r515895604", "bodyText": "So this is collecting a list of nulls, which are all equals (actually all same) ... a boolean to track presence would do the same I guess. But I'm guessing it would not be same when removing them, removeAll should go an remove each one, otherwise if there are more than one, not all would be removed? :-D", "author": "aaime", "createdAt": "2020-11-02T11:02:43Z", "path": "src/main/src/main/java/org/geoserver/config/GeoServerLoader.java", "diffHunk": "@@ -211,15 +211,18 @@ public void accept(LayerContents lc) {\n                 catalog.add(l);\n \n                 LOGGER.info(\"Loaded layer '\" + l.getName() + \"'\");\n-\n+                List<StyleInfo> badStyles = new ArrayList<>();\n                 for (StyleInfo style : l.getStyles()) {\n                     if (null == style) {\n                         LOGGER.log(\n                                 Level.SEVERE,\n                                 \"Layer '\" + l.getName() + \"' references a missing style\");\n                     }\n+                    badStyles.add(style);", "originalCommit": "4fb3971f0a1262045e28a7afe7fef4301b19c63c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg5NzYxNw==", "url": "https://github.com/geoserver/geoserver/pull/4553#discussion_r515897617", "bodyText": "You're right they are all Null - I should have thought of that! As for what removeAll does with many Nulls? https://stackoverflow.com/questions/60417963/does-arraylist-removeallcollection-cares-about-duplicates seems to indicate removing a single Null should work - I'll simplfy", "author": "ianturton", "createdAt": "2020-11-02T11:06:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg5NTYwNA=="}], "type": "inlineReview"}, {"oid": "42edcede970ba5af637e8ba7fd70032381112d29", "url": "https://github.com/geoserver/geoserver/commit/42edcede970ba5af637e8ba7fd70032381112d29", "message": "wip", "committedDate": "2020-11-04T16:47:49Z", "type": "commit"}, {"oid": "9739c1ea1010d2c4ffe2dd7697e116cf6c6a47c7", "url": "https://github.com/geoserver/geoserver/commit/9739c1ea1010d2c4ffe2dd7697e116cf6c6a47c7", "message": "wip", "committedDate": "2020-11-18T09:04:19Z", "type": "commit"}, {"oid": "afc01226f5af17db18dd3e244cde85f7553c0d17", "url": "https://github.com/geoserver/geoserver/commit/afc01226f5af17db18dd3e244cde85f7553c0d17", "message": "added test", "committedDate": "2020-11-22T12:02:42Z", "type": "commit"}, {"oid": "eb02587ecf0f28afcd6955dc46540d31e4df5422", "url": "https://github.com/geoserver/geoserver/commit/eb02587ecf0f28afcd6955dc46540d31e4df5422", "message": "test works and handles default style too", "committedDate": "2020-11-22T14:52:13Z", "type": "commit"}, {"oid": "9c5b39e41dcc8472d167c3738c76959138c462dd", "url": "https://github.com/geoserver/geoserver/commit/9c5b39e41dcc8472d167c3738c76959138c462dd", "message": "fix format", "committedDate": "2020-11-22T15:05:17Z", "type": "commit"}, {"oid": "d56aa67147f99bb7877e11b49b740c5336200954", "url": "https://github.com/geoserver/geoserver/commit/d56aa67147f99bb7877e11b49b740c5336200954", "message": "remove obseleted test and printlns", "committedDate": "2020-11-23T14:46:41Z", "type": "commit"}]}