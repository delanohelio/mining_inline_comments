{"pr_number": 4547, "pr_title": "[GEOS-9779][GEOS-9780] Upgrade OSHI from 3.13.3 to 5.3.3", "pr_createdAt": "2020-10-25T10:45:07Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4547", "timeline": [{"oid": "482aa88b0d189063bf9213cfa868e0f7663570cd", "url": "https://github.com/geoserver/geoserver/commit/482aa88b0d189063bf9213cfa868e0f7663570cd", "message": "WIP upgrade OSHI from 3.13.3 to 5.3.x", "committedDate": "2020-10-25T11:27:53Z", "type": "forcePushed"}, {"oid": "95d9487bc4b987d82b01deece5ac4d11992f0002", "url": "https://github.com/geoserver/geoserver/commit/95d9487bc4b987d82b01deece5ac4d11992f0002", "message": "keep track of cpu ticks for processorload", "committedDate": "2020-10-26T13:51:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMDY4OA==", "url": "https://github.com/geoserver/geoserver/pull/4547#discussion_r512120688", "bodyText": "should this just be removed from the enum?", "author": "mprins", "createdAt": "2020-10-26T16:57:57Z", "path": "src/main/src/main/java/org/geoserver/system/status/MetricInfo.java", "diffHunk": "@@ -18,7 +18,7 @@\n     LOGICAL_CPUS(\"CPU\", 101, \"Number of logical CPUs\"),\n     RUNNING_PROCESS(\"CPU\", 102, \"Number of running process\"),\n     RUNNING_THREADS(\"CPU\", 103, \"Number of running threads\"),\n-    CPU_LOAD(\"CPU\", 104, \"CPU average load\", \"%\"),\n+    // removed from OSHI    CPU_LOAD(\"CPU\", 104, \"CPU average load\", \"%\"),", "originalCommit": "b74175830e6e96273690e8bece86a8be6f4fb76a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMTYzMg==", "url": "https://github.com/geoserver/geoserver/pull/4547#discussion_r512121632", "bodyText": "Yep please", "author": "aaime", "createdAt": "2020-10-26T16:59:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMDY4OA=="}], "type": "inlineReview"}, {"oid": "7025a5011f58e6b5a59724383a493632667b649c", "url": "https://github.com/geoserver/geoserver/commit/7025a5011f58e6b5a59724383a493632667b649c", "message": "[GEOS-9779] Upgrade OSHI from 3.13.3 to 5.3.2\n\n- keep track of cpu ticks for processorload\n- mark all OSHI class members transient as these are not serializable and were throwing errors like\n- remove CPU_LOAD from the code as it is no longer available through OSHI", "committedDate": "2020-10-26T17:06:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE1ODM1OQ==", "url": "https://github.com/geoserver/geoserver/pull/4547#discussion_r512158359", "bodyText": "What was removed was OSHI tracking its own ticks here. You could keep track of the ticks yourself imilar to how you do for PER_CPU_LOAD and keep this.", "author": "dbwiddis", "createdAt": "2020-10-26T17:53:47Z", "path": "src/main/src/main/java/org/geoserver/system/status/MetricInfo.java", "diffHunk": "@@ -18,7 +18,7 @@\n     LOGICAL_CPUS(\"CPU\", 101, \"Number of logical CPUs\"),\n     RUNNING_PROCESS(\"CPU\", 102, \"Number of running process\"),\n     RUNNING_THREADS(\"CPU\", 103, \"Number of running threads\"),\n-    CPU_LOAD(\"CPU\", 104, \"CPU average load\", \"%\"),\n+    // 104 removed from OSHI", "originalCommit": "7025a5011f58e6b5a59724383a493632667b649c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE2MDMzNw==", "url": "https://github.com/geoserver/geoserver/pull/4547#discussion_r512160337", "bodyText": "Rather than removing this entirely you could use an oldTicks value (like you do below on line 194 for per-CPU) and pass to the getSystemCpuLoadBetweenTicks() method.  Alternately you could duplicate the per-cpu logic and sum up the arrays to get a system average.", "author": "dbwiddis", "createdAt": "2020-10-26T17:56:51Z", "path": "src/main/src/main/java/org/geoserver/system/status/OSHISystemInfoCollector.java", "diffHunk": "@@ -184,22 +187,11 @@ public OSHISystemInfoCollector() {\n                         si = Collections.singletonList(mv);\n                         break;\n                     }\n-                case CPU_LOAD:", "originalCommit": "7025a5011f58e6b5a59724383a493632667b649c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE2MTg4OQ==", "url": "https://github.com/geoserver/geoserver/pull/4547#discussion_r512161889", "bodyText": "\ud83d\udc4d", "author": "mprins", "createdAt": "2020-10-26T17:59:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE2MDMzNw=="}], "type": "inlineReview"}, {"oid": "8064599519d3e9a785a4124bced3579df1c10a3c", "url": "https://github.com/geoserver/geoserver/commit/8064599519d3e9a785a4124bced3579df1c10a3c", "message": "[GEOS-9779] Upgrade OSHI from 3.13.3 to 5.3.2\n\n- keep track of cpu ticks for processorload\n- mark all OSHI class members transient as these are not serializable and were throwing errors like\n- OSHI is available wunder MIT license, no need for exemptions in our license file", "committedDate": "2020-10-26T18:56:17Z", "type": "commit"}, {"oid": "8064599519d3e9a785a4124bced3579df1c10a3c", "url": "https://github.com/geoserver/geoserver/commit/8064599519d3e9a785a4124bced3579df1c10a3c", "message": "[GEOS-9779] Upgrade OSHI from 3.13.3 to 5.3.2\n\n- keep track of cpu ticks for processorload\n- mark all OSHI class members transient as these are not serializable and were throwing errors like\n- OSHI is available wunder MIT license, no need for exemptions in our license file", "committedDate": "2020-10-26T18:56:17Z", "type": "forcePushed"}, {"oid": "814a9cfafc1e4c38eba4b6c00917351c9adc6508", "url": "https://github.com/geoserver/geoserver/commit/814a9cfafc1e4c38eba4b6c00917351c9adc6508", "message": "[GEOS-9780] Bump oshi-core 5.3.2 -> 5.3.3 to resolve status page shows (read-only) loopback partitions", "committedDate": "2020-10-29T08:26:28Z", "type": "commit"}]}