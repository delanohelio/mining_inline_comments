{"pr_number": 783, "pr_title": "CDI Events for Consumer/Producer", "pr_createdAt": "2020-09-30T00:51:21Z", "pr_url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/783", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2NTA1OQ==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/783#discussion_r497265059", "bodyText": "Can you add a comment about this constructor that is not used during \"normal\" operations.", "author": "cescoffier", "createdAt": "2020-09-30T06:14:49Z", "path": "smallrye-reactive-messaging-kafka/src/main/java/io/smallrye/reactive/messaging/kafka/KafkaCDIEvents.java", "diffHunk": "@@ -0,0 +1,97 @@\n+package io.smallrye.reactive.messaging.kafka;\n+\n+import java.lang.annotation.Annotation;\n+import java.util.concurrent.CompletionStage;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.enterprise.event.Event;\n+import javax.enterprise.event.NotificationOptions;\n+import javax.enterprise.util.TypeLiteral;\n+import javax.inject.Inject;\n+\n+import org.apache.kafka.clients.consumer.Consumer;\n+import org.apache.kafka.clients.producer.Producer;\n+\n+@ApplicationScoped\n+public class KafkaCDIEvents {\n+    @Inject\n+    Event<Consumer<?, ?>> consumerEvent;\n+\n+    @Inject\n+    Event<Producer<?, ?>> producerEvent;\n+\n+    public Event<Consumer<?, ?>> consumer() {\n+        return consumerEvent;\n+    }\n+\n+    public Event<Producer<?, ?>> producer() {\n+        return producerEvent;\n+    }\n+\n+    public KafkaCDIEvents() {\n+    }\n+\n+    private KafkaCDIEvents(boolean isNoop) {", "originalCommit": "056efa4b5d56308b8e5341661a00feb538b2dc85", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2NTk5MA==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/783#discussion_r497265990", "bodyText": "Is it even used?", "author": "cescoffier", "createdAt": "2020-09-30T06:17:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2NTA1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3MDg4Mw==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/783#discussion_r497470883", "bodyText": "Not anymore. I thought I removed it.. but I may not have pushed the change. Will double check.", "author": "ebullient", "createdAt": "2020-09-30T12:32:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2NTA1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2NjQ5NA==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/783#discussion_r497266494", "bodyText": "Should we reset the counter at the end of each test?", "author": "cescoffier", "createdAt": "2020-09-30T06:18:58Z", "path": "smallrye-reactive-messaging-kafka/src/test/java/io/smallrye/reactive/messaging/kafka/CountKafkaCdiEvents.java", "diffHunk": "@@ -0,0 +1,89 @@\n+package io.smallrye.reactive.messaging.kafka;\n+\n+import java.lang.annotation.Annotation;\n+import java.util.concurrent.CompletionStage;\n+import java.util.concurrent.atomic.LongAdder;\n+\n+import javax.enterprise.event.Event;\n+import javax.enterprise.event.NotificationOptions;\n+import javax.enterprise.util.TypeLiteral;\n+\n+import org.apache.kafka.clients.consumer.Consumer;\n+import org.apache.kafka.clients.producer.Producer;\n+\n+public class CountKafkaCdiEvents extends KafkaCDIEvents {\n+    public static final KafkaCDIEvents noCdiEvents = new CountKafkaCdiEvents();", "originalCommit": "056efa4b5d56308b8e5341661a00feb538b2dc85", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3MTE4Mg==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/783#discussion_r497471182", "bodyText": "For this one.. it's saying \"I don't care\" (effectively a no-op) .. so I didn't bother resetting the counter", "author": "ebullient", "createdAt": "2020-09-30T12:32:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2NjQ5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU5NzkwMQ==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/783#discussion_r497597901", "bodyText": "ok", "author": "cescoffier", "createdAt": "2020-09-30T15:22:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2NjQ5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2NjY2Mg==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/783#discussion_r497266662", "bodyText": "Nice, I always used AtomicLong! @jponge might be interesting for the spies.", "author": "cescoffier", "createdAt": "2020-09-30T06:19:29Z", "path": "smallrye-reactive-messaging-kafka/src/test/java/io/smallrye/reactive/messaging/kafka/CountKafkaCdiEvents.java", "diffHunk": "@@ -0,0 +1,89 @@\n+package io.smallrye.reactive.messaging.kafka;\n+\n+import java.lang.annotation.Annotation;\n+import java.util.concurrent.CompletionStage;\n+import java.util.concurrent.atomic.LongAdder;\n+\n+import javax.enterprise.event.Event;\n+import javax.enterprise.event.NotificationOptions;\n+import javax.enterprise.util.TypeLiteral;\n+\n+import org.apache.kafka.clients.consumer.Consumer;\n+import org.apache.kafka.clients.producer.Producer;\n+\n+public class CountKafkaCdiEvents extends KafkaCDIEvents {\n+    public static final KafkaCDIEvents noCdiEvents = new CountKafkaCdiEvents();\n+\n+    public final LongAdder firedConsumerEvents = new LongAdder();", "originalCommit": "056efa4b5d56308b8e5341661a00feb538b2dc85", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQxNzQ3OA==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/783#discussion_r497417478", "bodyText": "Yep", "author": "jponge", "createdAt": "2020-09-30T10:51:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2NjY2Mg=="}], "type": "inlineReview"}, {"oid": "dd5d344f5d44974d9f4674801d2576dc839dc3fc", "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/dd5d344f5d44974d9f4674801d2576dc839dc3fc", "message": "CDI Events for Consumer/Producer", "committedDate": "2020-09-30T12:48:01Z", "type": "commit"}, {"oid": "dd5d344f5d44974d9f4674801d2576dc839dc3fc", "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/dd5d344f5d44974d9f4674801d2576dc839dc3fc", "message": "CDI Events for Consumer/Producer", "committedDate": "2020-09-30T12:48:01Z", "type": "forcePushed"}]}