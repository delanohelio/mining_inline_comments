{"pr_number": 527, "pr_title": "Feature/slim 2863 retry on all exceptions", "pr_createdAt": "2020-12-01T11:54:48Z", "pr_url": "https://github.com/OSGP/open-smart-grid-platform/pull/527", "timeline": [{"oid": "24a300f0be3c435679fab60eaf54fe1727571d3d", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/24a300f0be3c435679fab60eaf54fe1727571d3d", "message": "removed RetryableException, all exceptions possibly lead to retries", "committedDate": "2020-11-30T13:06:29Z", "type": "commit"}, {"oid": "2e64ed1ac6a127e452e5b51ed121be9757c08f94", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/2e64ed1ac6a127e452e5b51ed121be9757c08f94", "message": "added unit tests", "committedDate": "2020-12-01T10:55:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQyNDM3Mg==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/527#discussion_r533424372", "bodyText": "Why is this line necessary? Have you added unused mock elements by any change? It would be nicer without this line of code.", "author": "JelleHoffman", "createdAt": "2020-12-01T13:55:47Z", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/test/java/org/opensmartgridplatform/adapter/protocol/dlms/infra/messaging/processors/BundleMessageProcessorTest.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.adapter.protocol.dlms.infra.messaging.processors;\n+\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.when;\n+\n+import java.net.ConnectException;\n+\n+import javax.jms.JMSException;\n+import javax.jms.ObjectMessage;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.protocol.dlms.application.services.BundleService;\n+import org.opensmartgridplatform.adapter.protocol.dlms.application.services.DomainHelperService;\n+import org.opensmartgridplatform.adapter.protocol.dlms.application.services.ThrottlingService;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.entities.DlmsDevice;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.entities.DlmsDeviceBuilder;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.factories.DlmsConnectionHelper;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.factories.DlmsConnectionManager;\n+import org.opensmartgridplatform.adapter.protocol.dlms.exceptions.ConnectionException;\n+import org.opensmartgridplatform.adapter.protocol.dlms.exceptions.OsgpExceptionConverter;\n+import org.opensmartgridplatform.adapter.protocol.dlms.infra.messaging.DeviceResponseMessageSender;\n+import org.opensmartgridplatform.adapter.protocol.dlms.infra.messaging.DlmsMessageListener;\n+import org.opensmartgridplatform.adapter.protocol.dlms.infra.messaging.RetryHeaderFactory;\n+import org.opensmartgridplatform.dto.valueobjects.smartmetering.BundleMessagesRequestDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.OsgpException;\n+import org.opensmartgridplatform.shared.infra.jms.MessageMetadata;\n+import org.opensmartgridplatform.shared.infra.jms.MessageType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)", "originalCommit": "2e64ed1ac6a127e452e5b51ed121be9757c08f94", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQyNjAxMw==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/527#discussion_r533426013", "bodyText": "However it is not a must.", "author": "JelleHoffman", "createdAt": "2020-12-01T13:58:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQyNDM3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUwMjIyMw==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/527#discussion_r533502223", "bodyText": "No, good find, I forgot to remove this.", "author": "jboon", "createdAt": "2020-12-01T15:29:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQyNDM3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ4NTgwOA==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/527#discussion_r533485808", "bodyText": "minor: maybe put this in the setUp method so all init stuff is in the same place.", "author": "coendamen", "createdAt": "2020-12-01T15:08:52Z", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/test/java/org/opensmartgridplatform/adapter/protocol/dlms/infra/messaging/processors/BundleMessageProcessorTest.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.adapter.protocol.dlms.infra.messaging.processors;\n+\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.when;\n+\n+import java.net.ConnectException;\n+\n+import javax.jms.JMSException;\n+import javax.jms.ObjectMessage;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.protocol.dlms.application.services.BundleService;\n+import org.opensmartgridplatform.adapter.protocol.dlms.application.services.DomainHelperService;\n+import org.opensmartgridplatform.adapter.protocol.dlms.application.services.ThrottlingService;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.entities.DlmsDevice;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.entities.DlmsDeviceBuilder;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.factories.DlmsConnectionHelper;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.factories.DlmsConnectionManager;\n+import org.opensmartgridplatform.adapter.protocol.dlms.exceptions.ConnectionException;\n+import org.opensmartgridplatform.adapter.protocol.dlms.exceptions.OsgpExceptionConverter;\n+import org.opensmartgridplatform.adapter.protocol.dlms.infra.messaging.DeviceResponseMessageSender;\n+import org.opensmartgridplatform.adapter.protocol.dlms.infra.messaging.DlmsMessageListener;\n+import org.opensmartgridplatform.adapter.protocol.dlms.infra.messaging.RetryHeaderFactory;\n+import org.opensmartgridplatform.dto.valueobjects.smartmetering.BundleMessagesRequestDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.OsgpException;\n+import org.opensmartgridplatform.shared.infra.jms.MessageMetadata;\n+import org.opensmartgridplatform.shared.infra.jms.MessageType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)\n+class BundleMessageProcessorTest {\n+\n+    @Mock\n+    private ObjectMessage message;\n+\n+    @Mock\n+    private OsgpExceptionConverter osgpExceptionConverter;\n+\n+    @Mock\n+    private RetryHeaderFactory retryHeaderFactory;\n+\n+    @Mock\n+    private DeviceResponseMessageSender responseMessageSender;\n+\n+    @Mock\n+    private DomainHelperService domainHelperService;\n+\n+    @Mock\n+    private ThrottlingService throttlingService;\n+\n+    @Mock\n+    private DlmsConnectionHelper dlmsConnectionHelper;\n+\n+    @Mock\n+    private BundleService bundleService;\n+\n+    @Mock\n+    private DlmsConnectionManager dlmsConnectionManager;\n+\n+    @Mock\n+    private DlmsMessageListener messageListener;\n+\n+    @InjectMocks\n+    private BundleMessageProcessor messageProcessor;\n+\n+    private DlmsDevice dlmsDevice = new DlmsDeviceBuilder().withHls5Active(true).build();", "originalCommit": "2e64ed1ac6a127e452e5b51ed121be9757c08f94", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUwMjQ0MA==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/527#discussion_r533502440", "bodyText": "yes", "author": "jboon", "createdAt": "2020-12-01T15:29:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ4NTgwOA=="}], "type": "inlineReview"}, {"oid": "4ecfdfcc19e82cc4041e7ccd213f78c941b9d27a", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/4ecfdfcc19e82cc4041e7ccd213f78c941b9d27a", "message": "review comments processed unit test", "committedDate": "2020-12-01T15:30:32Z", "type": "commit"}]}