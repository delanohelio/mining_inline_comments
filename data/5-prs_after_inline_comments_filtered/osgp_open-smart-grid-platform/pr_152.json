{"pr_number": 152, "pr_title": "SLIM-2196 power quality readout for SMR 5.n devices", "pr_createdAt": "2020-01-22T06:50:59Z", "pr_url": "https://github.com/OSGP/open-smart-grid-platform/pull/152", "timeline": [{"oid": "fc13434f9748677b9ed41fd962e6593c28027c3c", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/fc13434f9748677b9ed41fd962e6593c28027c3c", "message": "SLIM-2196 first working readout", "committedDate": "2020-01-22T06:43:08Z", "type": "commit"}, {"oid": "bcef077a292951a0347bead1be014ee43426fe59", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/bcef077a292951a0347bead1be014ee43426fe59", "message": "SLIM-2196 refactoring", "committedDate": "2020-01-22T13:13:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDgwODM0OA==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/152#discussion_r370808348", "bodyText": "Complete the task associated to this TODO comment.", "author": "jenkins-ip-10-4-24-184", "createdAt": "2020-01-24T19:38:06Z", "path": "osgp/platform/osgp-adapter-domain-smartmetering/src/main/java/org/opensmartgridplatform/adapter/domain/smartmetering/application/services/ActionMapperService.java", "diffHunk": "@@ -248,8 +248,8 @@ private ActionDto mapActionWithMapper(final SmartMeter smartMeter, final ActionR\n         @SuppressWarnings(\"unchecked\")\n         // TODO: fix this", "originalCommit": "bcef077a292951a0347bead1be014ee43426fe59", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a0dd9477228fed60f74c6a67dbea415961284e9c", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/a0dd9477228fed60f74c6a67dbea415961284e9c", "message": "Merge branch 'development' of https://github.com/OSGP/open-smart-grid-platform into SLIM-2196/power_quality_readout_for_smr5_devices", "committedDate": "2020-02-12T13:38:20Z", "type": "commit"}, {"oid": "6cb3dd008a1f53e3f51648292a57e0b2997f333e", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/6cb3dd008a1f53e3f51648292a57e0b2997f333e", "message": "SLIM-2196 updated model, added tests, reverted ConfigureDefinableLoadProfileCommandExecutor", "committedDate": "2020-02-17T12:23:16Z", "type": "commit"}, {"oid": "a724e933ebd6c375a80480f9d915020b2bd1e8a9", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/a724e933ebd6c375a80480f9d915020b2bd1e8a9", "message": "Merge branch 'development' of https://github.com/OSGP/open-smart-grid-platform into SLIM-2196/power_quality_readout_for_smr5_devices", "committedDate": "2020-02-17T12:23:39Z", "type": "commit"}, {"oid": "d2e48857861de0ffc0acae1b34cdc28b85d3fcfb", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/d2e48857861de0ffc0acae1b34cdc28b85d3fcfb", "message": "SLIM-2196 change message model from ObisCodes to profileType, rename to proper message model", "committedDate": "2020-02-18T11:25:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDYxODUyNA==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/152#discussion_r380618524", "bodyText": "Reduce the number of conditional operators (4) used in the expression (maximum allowed 3).", "author": "jenkins-ip-10-4-24-184", "createdAt": "2020-02-18T11:37:33Z", "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/ConfigureDefinableLoadProfileRequestDto.java", "diffHunk": "@@ -0,0 +1,89 @@\n+/**\n+ * Copyright 2017 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.dto.valueobjects.smartmetering;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.Date;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * request for ProfileGenericData\n+ */\n+public class ConfigureDefinableLoadProfileRequestDto implements ActionRequestDto {\n+\n+    private final String deviceIdentification;\n+    private final ObisCodeValuesDto obisCode;\n+    private final Date beginDate;\n+    private final Date endDate;\n+    private final List<CaptureObjectDefinitionDto> selectedValues;\n+\n+    private static final long serialVersionUID = -2483665562035897062L;\n+\n+    public ConfigureDefinableLoadProfileRequestDto(final String deviceIdentification, final ObisCodeValuesDto obisCode,\n+            final Date beginDate, final Date endDate, final List<CaptureObjectDefinitionDto> selectedValues) {\n+\n+        this.deviceIdentification = deviceIdentification;\n+        this.obisCode = obisCode;\n+        this.beginDate = beginDate;\n+        this.endDate = endDate;\n+        this.selectedValues = selectedValues;\n+    }\n+\n+    public ConfigureDefinableLoadProfileRequestDto(final String deviceIdentification, final ObisCodeValuesDto obisCode,\n+            final Date beginDate, final Date endDate) {\n+        this(deviceIdentification, obisCode, beginDate, endDate, Collections.emptyList());\n+    }\n+\n+    @Override\n+    public String toString() {\n+        return String\n+                .format(\"%s[device=%s, obisCode=%s, begin=%tF %<tT.%<tL %<tZ, end=%tF %<tT.%<tL %<tZ, selected=%s]\",\n+                        ConfigureDefinableLoadProfileRequestDto.class.getSimpleName(), this.deviceIdentification,\n+                        this.obisCode, this.beginDate, this.endDate,\n+                        this.selectedValues.isEmpty() ? \"all capture objects\" : this.selectedValues);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return Objects\n+                .hash(this.deviceIdentification, this.obisCode, this.beginDate, this.endDate, this.selectedValues);\n+    }\n+\n+    @Override\n+    public boolean equals(final Object obj) {\n+        if (this == obj) {\n+            return true;\n+        }\n+        if (!(obj instanceof ConfigureDefinableLoadProfileRequestDto)) {\n+            return false;\n+        }\n+        final ConfigureDefinableLoadProfileRequestDto other = (ConfigureDefinableLoadProfileRequestDto) obj;\n+        return Objects.equals(this.deviceIdentification, other.deviceIdentification) && Objects", "originalCommit": "d2e48857861de0ffc0acae1b34cdc28b85d3fcfb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDYxODU0NQ==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/152#discussion_r380618545", "bodyText": "Reduce the number of conditional operators (4) used in the expression (maximum allowed 3).", "author": "jenkins-ip-10-4-24-184", "createdAt": "2020-02-18T11:37:35Z", "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetPowerQualityProfileRequest.java", "diffHunk": "@@ -95,12 +95,12 @@ public boolean equals(final Object obj) {\n         if (this == obj) {\n             return true;\n         }\n-        if (!(obj instanceof ProfileGenericDataRequest)) {\n+        if (!(obj instanceof GetPowerQualityProfileRequest)) {\n             return false;\n         }\n-        final ProfileGenericDataRequest other = (ProfileGenericDataRequest) obj;\n+        final GetPowerQualityProfileRequest other = (GetPowerQualityProfileRequest) obj;\n         return Objects.equals(this.deviceIdentification, other.deviceIdentification)", "originalCommit": "d2e48857861de0ffc0acae1b34cdc28b85d3fcfb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "67751e1af57603bb89f0b02065d6911e636d6c50", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/67751e1af57603bb89f0b02065d6911e636d6c50", "message": "SLIM-2196 renamed", "committedDate": "2020-02-18T16:37:30Z", "type": "commit"}, {"oid": "6345e76211f30f5c50c0778da7beea406083a882", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/6345e76211f30f5c50c0778da7beea406083a882", "message": "SLIM-2196 renamed", "committedDate": "2020-02-18T16:47:22Z", "type": "commit"}, {"oid": "0cc37c826d25fdb61cdc6a4ec2f1489f8ef68a76", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/0cc37c826d25fdb61cdc6a4ec2f1489f8ef68a76", "message": "SLIM-2196 multiple return objects in PQ data", "committedDate": "2020-02-19T17:41:59Z", "type": "commit"}, {"oid": "9ed00174bb55307a3e588d7734262022dcf5bb84", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/9ed00174bb55307a3e588d7734262022dcf5bb84", "message": "SLIM-2196 return data for PQ", "committedDate": "2020-02-20T15:55:46Z", "type": "commit"}, {"oid": "e7a7a1abed5a1dc42cd5b436f2d7498809136049", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/e7a7a1abed5a1dc42cd5b436f2d7498809136049", "message": "SLIM-2196 add mapper for PowerQualityProfileData", "committedDate": "2020-02-24T12:28:11Z", "type": "commit"}, {"oid": "f0ae76727250037186d70c811d9ec1400fd096c7", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/f0ae76727250037186d70c811d9ec1400fd096c7", "message": "SLIM-2196 added time interval data", "committedDate": "2020-03-05T17:09:42Z", "type": "commit"}, {"oid": "0a70caa74eb00a94f7cb61838ec5ba1092e3587c", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/0a70caa74eb00a94f7cb61838ec5ba1092e3587c", "message": "Merge branch 'development' of https://github.com/OSGP/open-smart-grid-platform into SLIM-2196/power_quality_readout_for_smr5_devices", "committedDate": "2020-03-09T08:03:56Z", "type": "commit"}, {"oid": "80ebb34e99e7e82b73a8235c1429ad989426006e", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/80ebb34e99e7e82b73a8235c1429ad989426006e", "message": "SLIM-2196 simplified GetPowerQualityProfileDtoConverter, some Sonar warnings", "committedDate": "2020-03-09T13:09:55Z", "type": "commit"}, {"oid": "e4c265016d7f980e2e711f4224617c327544bd2a", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/e4c265016d7f980e2e711f4224617c327544bd2a", "message": "SLIM-2196 sonar", "committedDate": "2020-03-11T13:42:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk5MzgxMw==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/152#discussion_r390993813", "bodyText": "mostly formatting, added one method: fromReferenceDateTime", "author": "coendamen", "createdAt": "2020-03-11T14:05:30Z", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/domain/commands/utils/DlmsHelper.java", "diffHunk": "@@ -24,6 +24,7 @@\n import org.apache.commons.lang3.StringUtils;", "originalCommit": "e4c265016d7f980e2e711f4224617c327544bd2a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2NjA4Mw==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/152#discussion_r391066083", "bodyText": "mostly formatting, some renaming", "author": "coendamen", "createdAt": "2020-03-11T15:41:30Z", "path": "osgp/platform/osgp-adapter-ws-smartmetering/src/main/java/org/opensmartgridplatform/adapter/ws/smartmetering/application/services/MonitoringService.java", "diffHunk": "@@ -17,9 +17,9 @@\n import org.opensmartgridplatform.domain.core.valueobjects.DeviceFunction;", "originalCommit": "e4c265016d7f980e2e711f4224617c327544bd2a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2NjUyOA==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/152#discussion_r391066528", "bodyText": "formatting and renaming", "author": "coendamen", "createdAt": "2020-03-11T15:42:04Z", "path": "osgp/platform/osgp-adapter-ws-smartmetering/src/main/java/org/opensmartgridplatform/adapter/ws/smartmetering/application/services/ActionMapperResponseService.java", "diffHunk": "@@ -1,9 +1,10 @@\n /**", "originalCommit": "e4c265016d7f980e2e711f4224617c327544bd2a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ce195b92582f64421e21a829695a397ed3d51bd0", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/ce195b92582f64421e21a829695a397ed3d51bd0", "message": "SLIM-2196 sonar", "committedDate": "2020-03-12T07:59:25Z", "type": "commit"}, {"oid": "7785dec92bfdbc3fdb73a76783407ddda32d3181", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/7785dec92bfdbc3fdb73a76783407ddda32d3181", "message": "SLIM-2196 more sonar warnings", "committedDate": "2020-03-12T08:34:38Z", "type": "commit"}, {"oid": "45f4b2d691f512b84dbe331598c1dcfa4ad227d0", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/45f4b2d691f512b84dbe331598c1dcfa4ad227d0", "message": "Merge branch 'development' of https://github.com/OSGP/open-smart-grid-platform into SLIM-2196/power_quality_readout_for_smr5_devices", "committedDate": "2020-03-12T08:34:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ3MjI2MQ==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/152#discussion_r391472261", "bodyText": "Reduce this lambda expression number of lines from 24 to at most 20.", "author": "jenkins-ip-10-4-24-184", "createdAt": "2020-03-12T08:46:12Z", "path": "osgp/platform/osgp-adapter-domain-smartmetering/src/main/java/org/opensmartgridplatform/adapter/domain/smartmetering/infra/jms/ws/WebServiceResponseMessageSender.java", "diffHunk": "@@ -35,51 +32,47 @@\n      * live.\n      *\n      * @param responseMessage\n-     *            The response message to send.\n+     *         The response message to send.\n      * @param timeToLive\n-     *            The custom time to live value in milliseconds.\n+     *         The custom time to live value in milliseconds.\n      */\n     public void send(final ResponseMessage responseMessage, final Long timeToLive, final String messageType) {\n \n         // Keep the original time to live from configuration.\n-        final Long originalTimeToLive = this.jmsTemplate.getTimeToLive();\n+        final long originalTimeToLive = this.jmsTemplate.getTimeToLive();\n         if (timeToLive != null) {\n             // Set the custom time to live.\n             this.jmsTemplate.setTimeToLive(timeToLive);\n         }\n \n-        this.jmsTemplate.send(new MessageCreator() {\n+        this.jmsTemplate.send(session -> {", "originalCommit": "45f4b2d691f512b84dbe331598c1dcfa4ad227d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9973d8d01d0c7efeb3626394f0872a2f1bad360d", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/9973d8d01d0c7efeb3626394f0872a2f1bad360d", "message": "SLIM-2196 update feature file to fix test", "committedDate": "2020-03-12T11:56:48Z", "type": "commit"}, {"oid": "7f17d081bcaf0b692fbfcf80b9a841cbfac965a7", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/7f17d081bcaf0b692fbfcf80b9a841cbfac965a7", "message": "SLIM-2196 update feature file to fix test", "committedDate": "2020-03-12T12:57:48Z", "type": "commit"}, {"oid": "b23aa08cc426e55043c8372ceb4b3763dc65444f", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/b23aa08cc426e55043c8372ceb4b3763dc65444f", "message": "SLIM-2196 disabled cucumber test while simulator is not ready yet, some code improvements", "committedDate": "2020-03-17T05:38:31Z", "type": "commit"}, {"oid": "bb5bacce4914cda53f855387de335a9a12f884c2", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/bb5bacce4914cda53f855387de335a9a12f884c2", "message": "SLIM-2196 skiptest, added unit test for GetPowerQualityProfileCommandExecutor", "committedDate": "2020-03-17T13:56:37Z", "type": "commit"}, {"oid": "09dafce2c35c4f159fe206ab480df6cae70aa869", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/09dafce2c35c4f159fe206ab480df6cae70aa869", "message": "Merge branch 'development' of https://github.com/OSGP/open-smart-grid-platform into SLIM-2196/power_quality_readout_for_smr5_devices", "committedDate": "2020-03-17T13:56:50Z", "type": "commit"}, {"oid": "3ec50e26a01f943cfd5da26389981327e2ce27ad", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/3ec50e26a01f943cfd5da26389981327e2ce27ad", "message": "SLIM-2196 removed obsolete profile generic data feature scenarios", "committedDate": "2020-03-17T14:44:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNDgyMQ==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/152#discussion_r394224821", "bodyText": "Moet serialVersionUID niet bijgewerkt worden?", "author": "evanbarn", "createdAt": "2020-03-18T09:55:37Z", "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetPowerQualityProfileRequest.java", "diffHunk": "@@ -78,15 +78,15 @@ public DeviceFunction getDeviceFunction() {\n     @Override\n     public String toString() {\n         return String.format(\n-                \"%s[device=%s, obisCode=%s, begin=%tF %<tT.%<tL %<tZ, end=%tF %<tT.%<tL %<tZ, selected=%s]\",\n-                ProfileGenericDataRequest.class.getSimpleName(), this.deviceIdentification, this.obisCode,\n+                \"%s[device=%s, profileType=%s, begin=%tF %<tT.%<tL %<tZ, end=%tF %<tT.%<tL %<tZ, selected=%s]\",\n+                GetPowerQualityProfileRequest.class.getSimpleName(), this.deviceIdentification, this.profileType,\n                 this.beginDate, this.endDate,\n                 this.selectedValues.isEmpty() ? \"all capture objects\" : this.selectedValues);\n     }\n \n     @Override\n     public int hashCode() {\n-        return Objects.hash(this.deviceIdentification, this.obisCode, this.beginDate, this.endDate,\n+        return Objects.hash(this.deviceIdentification, this.profileType, this.beginDate, this.endDate,\n                 this.selectedValues);\n     }\n ", "originalCommit": "3ec50e26a01f943cfd5da26389981327e2ce27ad", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg2NTUyMA==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/152#discussion_r394865520", "bodyText": "Wat is een ObisCode?", "author": "jboon", "createdAt": "2020-03-19T08:41:13Z", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/domain/commands/misc/GetPowerQualityProfileCommandExecutor.java", "diffHunk": "@@ -25,28 +25,31 @@\n import org.opensmartgridplatform.adapter.protocol.dlms.domain.commands.AbstractCommandExecutor;\n import org.opensmartgridplatform.adapter.protocol.dlms.domain.commands.utils.JdlmsObjectToStringUtil;\n import org.opensmartgridplatform.adapter.protocol.dlms.domain.entities.DlmsDevice;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.entities.Protocol;\n import org.opensmartgridplatform.adapter.protocol.dlms.domain.factories.DlmsConnectionManager;\n import org.opensmartgridplatform.adapter.protocol.dlms.exceptions.ConnectionException;\n import org.opensmartgridplatform.adapter.protocol.dlms.exceptions.ProtocolAdapterException;\n import org.opensmartgridplatform.dto.valueobjects.smartmetering.ActionResponseDto;\n import org.opensmartgridplatform.dto.valueobjects.smartmetering.CaptureObjectDefinitionDto;\n-import org.opensmartgridplatform.dto.valueobjects.smartmetering.DefinableLoadProfileConfigurationDto;\n+import org.opensmartgridplatform.dto.valueobjects.smartmetering.GetPowerQualityProfileRequestDto;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n \n @Component\n-public class ConfigureDefinableLoadProfileCommandExecutor\n-        extends AbstractCommandExecutor<DefinableLoadProfileConfigurationDto, Void> {\n+public class GetPowerQualityProfileCommandExecutor\n+        extends AbstractCommandExecutor<GetPowerQualityProfileRequestDto, Void> {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(GetPowerQualityProfileCommandExecutor.class);\n \n     private static final int CLASS_ID = InterfaceClass.PROFILE_GENERIC.id();\n-    private static final ObisCode LOGICAL_NAME = new ObisCode(\"0.1.94.31.6.255\");\n \n-    private static final AttributeAddress ATTRIBUTE_CAPTURE_OBJECTS = new AttributeAddress(CLASS_ID, LOGICAL_NAME,\n-            ProfileGenericAttribute.CAPTURE_OBJECTS.attributeId());\n-    private static final String ATTRIBUTE_NAME_CAPTURE_OBJECTS = \"capture objects\";\n+    private static final ObisCode OBIS_CODE_DEFINABLE_LOAD_PROFILE = new ObisCode(\"0.1.94.31.6.255\");", "originalCommit": "bcef077a292951a0347bead1be014ee43426fe59", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}