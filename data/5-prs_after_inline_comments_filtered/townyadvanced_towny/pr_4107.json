{"pr_number": 4107, "pr_title": "Add Mayoral Succession", "pr_createdAt": "2020-06-22T03:32:47Z", "pr_url": "https://github.com/TownyAdvanced/Towny/pull/4107", "timeline": [{"oid": "e5bfd328a3bd586f66955338fbcccabb0df24ca9", "url": "https://github.com/TownyAdvanced/Towny/commit/e5bfd328a3bd586f66955338fbcccabb0df24ca9", "message": "Add `Town.getRank`\n\nAdd `getRank` method to `Town` class to get a list of town residents with the rank specified as an argument to `getRank`.", "committedDate": "2019-09-21T23:08:25Z", "type": "commit"}, {"oid": "90aa311363f4f25ef76d09045841c32f59d5c40b", "url": "https://github.com/TownyAdvanced/Towny/commit/90aa311363f4f25ef76d09045841c32f59d5c40b", "message": "Make `Town.getAssistant` use `Town.getRank`", "committedDate": "2019-09-21T23:14:42Z", "type": "commit"}, {"oid": "6de51da5251f60aeed7f0a43206d70ff55c58ad2", "url": "https://github.com/TownyAdvanced/Towny/commit/6de51da5251f60aeed7f0a43206d70ff55c58ad2", "message": "Check mayoralSuccession ranks when removing mayor\n\nCheck ranks in `Town.mayoralSuccession` when removing mayor with `Town.remove`.\r\n\r\nTODO: Set `mayoralSuccession` with config file instead of hard coding it.", "committedDate": "2019-09-21T23:51:38Z", "type": "commit"}, {"oid": "a1b2703f6b003eed03b8cc8ad1082260ff3ed5b4", "url": "https://github.com/TownyAdvanced/Towny/commit/a1b2703f6b003eed03b8cc8ad1082260ff3ed5b4", "message": "Reformat `Town.getAssistant`", "committedDate": "2020-05-31T19:56:22Z", "type": "commit"}, {"oid": "dfa3e82daff0e29fcde5d60cc7f6ab8d074baa87", "url": "https://github.com/TownyAdvanced/Towny/commit/dfa3e82daff0e29fcde5d60cc7f6ab8d074baa87", "message": "Merge branch 'master' into remove-mayor", "committedDate": "2020-05-31T20:20:11Z", "type": "commit"}, {"oid": "e82de8657401a74046f090bfe66edb6552466a5a", "url": "https://github.com/TownyAdvanced/Towny/commit/e82de8657401a74046f090bfe66edb6552466a5a", "message": "Add config option for order of mayoral succession", "committedDate": "2020-05-31T23:43:19Z", "type": "commit"}, {"oid": "e128ecb5aaaf87264e071b9d9b907a61a8f3b851", "url": "https://github.com/TownyAdvanced/Towny/commit/e128ecb5aaaf87264e071b9d9b907a61a8f3b851", "message": "Fix undefined variable in `Town.getRank()`\n\nChange `assistant` to `resident` in `Town.getRank()`.", "committedDate": "2020-06-01T00:08:01Z", "type": "commit"}, {"oid": "63fd0e2132a3661a2110277e11739cd20b22e36b", "url": "https://github.com/TownyAdvanced/Towny/commit/63fd0e2132a3661a2110277e11739cd20b22e36b", "message": "Add `Town.hasRank()` method", "committedDate": "2020-06-01T00:11:11Z", "type": "commit"}, {"oid": "e38e83a7d4e140391584c037950d8c264c840d3b", "url": "https://github.com/TownyAdvanced/Towny/commit/e38e83a7d4e140391584c037950d8c264c840d3b", "message": "Update `Town.hasAssistant()` to use `hasRank()`", "committedDate": "2020-06-01T00:11:56Z", "type": "commit"}, {"oid": "0c05ca1db3fff4be3f5e3c85ec1c27a41670f077", "url": "https://github.com/TownyAdvanced/Towny/commit/0c05ca1db3fff4be3f5e3c85ec1c27a41670f077", "message": "Fix `TownySettings.getOrderOfMayoralSuccession()`", "committedDate": "2020-06-01T00:15:55Z", "type": "commit"}, {"oid": "c0de021540e1662d400a4c108f496357189a64e5", "url": "https://github.com/TownyAdvanced/Towny/commit/c0de021540e1662d400a4c108f496357189a64e5", "message": "Update mayoral succession config comment\n\nUpdate mayoral succession config comment to note that the order the\nranks specified will be checked in (prior to checking regular residents)\nis not guaranteed.", "committedDate": "2020-06-20T21:24:04Z", "type": "commit"}, {"oid": "e8b546b42b002b8b5ff2a66c08e8d412fa24c81a", "url": "https://github.com/TownyAdvanced/Towny/commit/e8b546b42b002b8b5ff2a66c08e8d412fa24c81a", "message": "Merge branch 'master' into remove-mayor", "committedDate": "2020-06-20T21:26:54Z", "type": "commit"}, {"oid": "a62f28929da724836e476b96391835e4a6d8fce5", "url": "https://github.com/TownyAdvanced/Towny/commit/a62f28929da724836e476b96391835e4a6d8fce5", "message": "Fix syntax error in mayoral succession config", "committedDate": "2020-06-20T21:29:59Z", "type": "commit"}, {"oid": "fde605843b5ffb3d6d112ba9f195c9372e33570c", "url": "https://github.com/TownyAdvanced/Towny/commit/fde605843b5ffb3d6d112ba9f195c9372e33570c", "message": "Add debugging output for mayoral succession", "committedDate": "2020-06-24T01:06:08Z", "type": "commit"}, {"oid": "c4cd8924b819d0cf0aa780b268e0ed83b229c81f", "url": "https://github.com/TownyAdvanced/Towny/commit/c4cd8924b819d0cf0aa780b268e0ed83b229c81f", "message": "Fix mayoral succession rank ordering issue\n\nFix issue where mayoral succession rank loop not being broken/exited\nwhen a new mayor is appointed, which had resulted in the first eligible\nresident for each rank in the order of succession being being made mayor\n(with the last one to be made mayor ending up as the mayor when the\nsuccession process completed).\n\nUpdate config comment for the order of mayoral succession to reflect the\nrank ordering issue being resolved.", "committedDate": "2020-06-24T01:58:01Z", "type": "commit"}, {"oid": "c4cd8924b819d0cf0aa780b268e0ed83b229c81f", "url": "https://github.com/TownyAdvanced/Towny/commit/c4cd8924b819d0cf0aa780b268e0ed83b229c81f", "message": "Fix mayoral succession rank ordering issue\n\nFix issue where mayoral succession rank loop not being broken/exited\nwhen a new mayor is appointed, which had resulted in the first eligible\nresident for each rank in the order of succession being being made mayor\n(with the last one to be made mayor ending up as the mayor when the\nsuccession process completed).\n\nUpdate config comment for the order of mayoral succession to reflect the\nrank ordering issue being resolved.", "committedDate": "2020-06-24T01:58:01Z", "type": "forcePushed"}, {"oid": "48a978a2e8c3684d6c0ca7f9b810524ccdcacfa4", "url": "https://github.com/TownyAdvanced/Towny/commit/48a978a2e8c3684d6c0ca7f9b810524ccdcacfa4", "message": "Merge branch 'master' into remove-mayor", "committedDate": "2020-06-24T02:10:04Z", "type": "commit"}, {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "url": "https://github.com/TownyAdvanced/Towny/commit/d5143348f1a5c64afd62b25a86af75df085ee5ec", "message": "Merge branch 'master' into remove-mayor", "committedDate": "2020-07-11T01:49:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc0OA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238748", "bodyText": "Remove debug.", "author": "LlmDl", "createdAt": "2020-07-11T21:53:04Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -661,7 +671,7 @@ private void removeAllResidents() {\n \t}\n \n \tprivate void remove(Resident resident) {\n-\t\t\n+\t\tSystem.out.println(\"private void remove(Resident residen = \" + resident + \")\");", "originalCommit": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MzU2NA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456183564", "bodyText": "Removed by commit cc62ab9.", "author": "docwhomc", "createdAt": "2020-07-17T02:28:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc1Nw==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238757", "bodyText": "Remove debug.", "author": "LlmDl", "createdAt": "2020-07-11T21:53:15Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -683,34 +693,21 @@ private void remove(Resident resident) {\n \t\t\t}\n \t\t}\n \n+\t\t// Mayoral succession.\n \t\tif (isMayor(resident)) {\n-\n \t\t\tif (residents.size() > 1) {\n-\t\t\t\tfor (Resident assistant : new ArrayList<>(getAssistants()))\n-\t\t\t\t\tif ((assistant != resident) && (resident.hasTownRank(\"assistant\"))) {\n-\t\t\t\t\t\ttry {\n-\t\t\t\t\t\t\tsetMayor(assistant);\n-\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t} catch (TownyException e) {\n-\t\t\t\t\t\t\t// Error setting mayor.\n-\t\t\t\t\t\t\te.printStackTrace();\n-\t\t\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"TownySettings.getOrderOfMayoralSuccession() = \" + TownySettings.getOrderOfMayoralSuccession());", "originalCommit": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MjUwMA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456182500", "bodyText": "Removed by commit 5316b5f.", "author": "docwhomc", "createdAt": "2020-07-17T02:24:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc4Nw==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238787", "bodyText": "Remove debug.", "author": "LlmDl", "createdAt": "2020-07-11T21:53:43Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));", "originalCommit": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MjY3MQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456182671", "bodyText": "Removed by commit 5316b5f.", "author": "docwhomc", "createdAt": "2020-07-17T02:25:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc5MA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238790", "bodyText": "Remove debug.", "author": "LlmDl", "createdAt": "2020-07-11T21:53:49Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);", "originalCommit": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MzA1Nw==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456183057", "bodyText": "Removed by commit 5316b5f.", "author": "docwhomc", "createdAt": "2020-07-17T02:26:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODgxMw==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238813", "bodyText": "Remove debug.", "author": "LlmDl", "createdAt": "2020-07-11T21:53:56Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif ((newMayor != mayor) && (newMayor.hasTownRank(rank))) {  // The latter portion seems redundant.\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);", "originalCommit": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MzAyMw==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456183023", "bodyText": "Removed by commit 5316b5f.", "author": "docwhomc", "createdAt": "2020-07-17T02:26:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODgxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODgzMA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238830", "bodyText": "Remove debug.", "author": "LlmDl", "createdAt": "2020-07-11T21:54:17Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif ((newMayor != mayor) && (newMayor.hasTownRank(rank))) {  // The latter portion seems redundant.\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);\n+\t\t\t}\n+\t\t}\n+\t\treturn found;\n+\t}\n+\t\n+\t/**\n+\t * Tries to find a new mayor from among the town's residents.\n+\t * \n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor() {\n+\t\tboolean found = false;\n+\t\tfor (Resident newMayor : new ArrayList<>(getResidents())) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);", "originalCommit": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MzExMg==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456183112", "bodyText": "Removed by commit 5316b5f.", "author": "docwhomc", "createdAt": "2020-07-17T02:27:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODgzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODgzOQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238839", "bodyText": "Remove debug.", "author": "LlmDl", "createdAt": "2020-07-11T21:54:28Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif ((newMayor != mayor) && (newMayor.hasTownRank(rank))) {  // The latter portion seems redundant.\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);\n+\t\t\t}\n+\t\t}\n+\t\treturn found;\n+\t}\n+\t\n+\t/**\n+\t * Tries to find a new mayor from among the town's residents.\n+\t * \n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor() {\n+\t\tboolean found = false;\n+\t\tfor (Resident newMayor : new ArrayList<>(getResidents())) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif (newMayor != mayor) {\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);", "originalCommit": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MzA4OQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456183089", "bodyText": "Removed by commit 5316b5f.", "author": "docwhomc", "createdAt": "2020-07-17T02:27:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODgzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc0OTM3OQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r454749379", "bodyText": "There's no need for an array copy here new ArrayList<>(getRank(rank)) should just be getRank(Rank)", "author": null, "createdAt": "2020-07-15T02:16:30Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {", "originalCommit": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE2Njg5Mw==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456166893", "bodyText": "I believe this is how the corresponding loop was coded before I rewrote the mayoral succession system.", "author": "docwhomc", "createdAt": "2020-07-17T01:25:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc0OTM3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MTY4Mg==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456181682", "bodyText": "This should be resolved as of 9606f94.", "author": "docwhomc", "createdAt": "2020-07-17T02:21:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc0OTM3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc0OTg4NQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r454749885", "bodyText": "Again, another array copy", "author": null, "createdAt": "2020-07-15T02:18:03Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif ((newMayor != mayor) && (newMayor.hasTownRank(rank))) {  // The latter portion seems redundant.\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);\n+\t\t\t}\n+\t\t}\n+\t\treturn found;\n+\t}\n+\t\n+\t/**\n+\t * Tries to find a new mayor from among the town's residents.\n+\t * \n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor() {\n+\t\tboolean found = false;\n+\t\tfor (Resident newMayor : new ArrayList<>(getResidents())) {", "originalCommit": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MTcyOA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456181728", "bodyText": "This should also be resolved as of 9606f94.", "author": "docwhomc", "createdAt": "2020-07-17T02:21:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc0OTg4NQ=="}], "type": "inlineReview"}, {"oid": "cc62ab9a07b643c2d0ecae03aad2ad5a76942757", "url": "https://github.com/TownyAdvanced/Towny/commit/cc62ab9a07b643c2d0ecae03aad2ad5a76942757", "message": "Merge branch 'master' into remove-mayor", "committedDate": "2020-07-17T01:47:27Z", "type": "commit"}, {"oid": "5316b5fa5816423a2b9ba5f60ce3e8ece1d4bf81", "url": "https://github.com/TownyAdvanced/Towny/commit/5316b5fa5816423a2b9ba5f60ce3e8ece1d4bf81", "message": "Remove debugging output from remove-mayor", "committedDate": "2020-07-17T02:08:50Z", "type": "commit"}, {"oid": "9606f94d6c95ec81a934e87eca2e5ac72278463d", "url": "https://github.com/TownyAdvanced/Towny/commit/9606f94d6c95ec81a934e87eca2e5ac72278463d", "message": "Clean up loops in Town.findNewMayor() methods\n\nDon't create new `ArrayList`s in the for loops of the\n`Town.findNewMayor()` methods.", "committedDate": "2020-07-17T02:12:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMDUxMg==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456420512", "bodyText": "this should probably just return resident.hasTownRank(\"assistant\"); and the hasRank() method below can be scrapped. Eventually I want all of the assistant stuff removed from being hardcoded, including the saving/loading assistants in the DB.", "author": "LlmDl", "createdAt": "2020-07-17T12:49:01Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -254,7 +259,12 @@ public boolean hasResident(Resident resident) {\n \n \tpublic boolean hasAssistant(Resident resident) {\n \n-\t\treturn getAssistants().contains(resident);\n+\t\treturn hasRank(resident, \"assistant\");", "originalCommit": "9606f94d6c95ec81a934e87eca2e5ac72278463d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjUyNTAxNA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456525014", "bodyText": "Is Resident.hasTownRank() new?", "author": "docwhomc", "createdAt": "2020-07-17T15:46:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMDUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjU5MTA1OQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456591059", "bodyText": "No it's fairly old.", "author": "LlmDl", "createdAt": "2020-07-17T17:56:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMDUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjcyNzQ0Nw==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456727447", "bodyText": "Oh yeah, I used it in Town.findNewMayor(String rank).  I'm not sure why I set up Town.hasRank(Resident resident, String rank)that way except that that was the wayTown.hasAssistant(Resident resident)` originally worked.", "author": "docwhomc", "createdAt": "2020-07-18T00:46:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMDUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjcyNzY0NQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456727645", "bodyText": "Commits ea3df36 and fb20ac2 resolve this.", "author": "docwhomc", "createdAt": "2020-07-18T00:48:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMDUxMg=="}], "type": "inlineReview"}, {"oid": "88789ef7191b8d910123e55b3d5a1d52b3d0f01a", "url": "https://github.com/TownyAdvanced/Towny/commit/88789ef7191b8d910123e55b3d5a1d52b3d0f01a", "message": "Merge branch 'master' into remove-mayor", "committedDate": "2020-07-17T23:56:38Z", "type": "commit"}, {"oid": "b090fe7d02927f3e26f0252757cd817533daf905", "url": "https://github.com/TownyAdvanced/Towny/commit/b090fe7d02927f3e26f0252757cd817533daf905", "message": "Depreciate `Town.getAssistants()`", "committedDate": "2020-07-17T23:57:51Z", "type": "commit"}, {"oid": "ea3df36b146343b759d970e672d52a33ea9c72ad", "url": "https://github.com/TownyAdvanced/Towny/commit/ea3df36b146343b759d970e672d52a33ea9c72ad", "message": "Use Resident.hasTownRank() in Town.hasAssistant()\n\nSwitch from using `Town.hasRank()` to `Resident.hasTownRank()` in\n`Town.hasAssistant()`.", "committedDate": "2020-07-18T00:04:53Z", "type": "commit"}, {"oid": "fb20ac24c5f90fcc964700766eff98cf54398eaa", "url": "https://github.com/TownyAdvanced/Towny/commit/fb20ac24c5f90fcc964700766eff98cf54398eaa", "message": "Remove redundant method `Town.hasRank()`\n\nThe single use of `Town.hasRank()` has already been replaced with the\npreexisting `Resident.hasTownRank()` method, which provides the same\nfunctionality.", "committedDate": "2020-07-18T00:07:33Z", "type": "commit"}, {"oid": "0953fef0bc9d07024b20d47b113aa3a2253fe430", "url": "https://github.com/TownyAdvanced/Towny/commit/0953fef0bc9d07024b20d47b113aa3a2253fe430", "message": "Depreciate `Town.hasAssistant()`", "committedDate": "2020-07-18T00:36:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjcyODE4Nw==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456728187", "bodyText": "When you deprecate something you need to provide information as to what version it was deprecated as well as alternative methods in the javadoc for example:\n/**\n* @deprecated Since VERSION, use {@link myNewMethod} instead.\n*\n*/\npublic void myDeprecatedMethod(){}", "author": null, "createdAt": "2020-07-18T00:52:01Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -192,9 +198,10 @@ public boolean hasResident(Resident resident) {\n \t\treturn residents.contains(resident);\n \t}\n \n+\t@Deprecated\n \tpublic boolean hasAssistant(Resident resident) {", "originalCommit": "0953fef0bc9d07024b20d47b113aa3a2253fe430", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjcyOTY4OA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456729688", "bodyText": "What Javadoc? Most of Towny, including (Town.hasAssistant()) is\nundocumented and the replacement is obviously the code the method is\nfunctioning as an alias to for.", "author": "docwhomc", "createdAt": "2020-07-18T01:03:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjcyODE4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjczMjI3OA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456732278", "bodyText": "Resolved by commit b1b7da5.", "author": "docwhomc", "createdAt": "2020-07-18T01:26:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjcyODE4Nw=="}], "type": "inlineReview"}, {"oid": "b1b7da5dddceb3fdae695faabceaf1d4e5edc5b9", "url": "https://github.com/TownyAdvanced/Towny/commit/b1b7da5dddceb3fdae695faabceaf1d4e5edc5b9", "message": "Add depreciation note for Town#hasAssistantTown\n\nAdd depreciation note for `Town#hasAssistant(Resident)`.", "committedDate": "2020-07-18T01:22:31Z", "type": "commit"}]}