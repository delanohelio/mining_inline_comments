{"pr_number": 3710, "pr_title": "Added proper tab completion for /nation", "pr_createdAt": "2020-02-20T20:37:35Z", "pr_url": "https://github.com/TownyAdvanced/Towny/pull/3710", "timeline": [{"oid": "11ea1ba82564972916a926cfd2995d7f96c819f7", "url": "https://github.com/TownyAdvanced/Towny/commit/11ea1ba82564972916a926cfd2995d7f96c819f7", "message": "Added proper tab completion for /nation", "committedDate": "2020-02-20T20:16:42Z", "type": "commit"}, {"oid": "202c0e6584096a036b9cf6468cc4450f1812b726", "url": "https://github.com/TownyAdvanced/Towny/commit/202c0e6584096a036b9cf6468cc4450f1812b726", "message": "Made nationEnemyTabCompletes and nationAllyTabCompletes static", "committedDate": "2020-02-20T21:32:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNDQxOQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382304419", "bodyText": "The rank will have to return a list of players in the nation", "author": "LlmDl", "createdAt": "2020-02-20T22:54:00Z", "path": "src/com/palmergames/bukkit/towny/command/NationCommand.java", "diffHunk": "@@ -188,43 +204,110 @@\n \t@Override\r\n \tpublic List<String> onTabComplete(CommandSender sender, Command command, String alias, String[] args) {\r\n \r\n-\t\tif (args.length == 1) {\r\n-\t\t\tList<String> nationNames = NameUtil.getNationNames();\r\n-\t\t\tnationNames.addAll(nationTabCompletes);\r\n-\t\t\treturn NameUtil.filterByStart(nationNames, args[0]);\r\n-\t\t}\r\n-\r\n-\t\tif (args.length == 2) {\r\n-\t\t\tswitch (args[0].toLowerCase()) {\r\n-\t\t\t\tcase \"set\":\r\n-\t\t\t\t\treturn NameUtil.filterByStart(nationSetTabCompletes, args[1]);\r\n-\t\t\t\tcase \"rank\":\r\n-\t\t\t\tcase \"ally\":\r\n-\t\t\t\tcase \"enemy\":\r\n-\t\t\t\t\treturn NameUtil.filterByStart(new ArrayList<>(Arrays.asList(\r\n-\t\t\t\t\t\t\"add\",\r\n-\t\t\t\t\t\t\"remove\"\r\n-\t\t\t\t\t)), args[1]);\r\n-\t\t\t\tcase \"kick\":\r\n-\t\t\t\tcase \"add\":\r\n-\t\t\t\t\treturn NameUtil.getTownNamesStartingWith(args[1]);\r\n-\t\t\t\tcase \"toggle\":\r\n-\t\t\t\t\treturn NameUtil.filterByStart(nationToggleTabCompletes, args[1]);\r\n-\t\t\t\tcase \"join\":\r\n-\t\t\t\t\treturn NameUtil.getNationNamesStartingWith(args[1]);\r\n-\r\n+\t\tif (sender instanceof Player) {\r\n+\t\t\tPlayer player = (Player) sender;\r\n+\t\t\tswitch (args.length) {\r\n+\t\t\t\tcase 1:\r\n+\t\t\t\t\t// Only suggest nation names in tab complete if the player is not typing a valid sub command. This reduces clutter and the unnecessary checking of all nation names for tab completion\r\n+\t\t\t\t\tList<String> nationNames = NameUtil.filterByStart(nationTabCompletes, args[0]);\r\n+\t\t\t\t\tif (nationNames.size() > 0) {\r\n+\t\t\t\t\t\treturn nationNames;\r\n+\t\t\t\t\t} else {\r\n+\t\t\t\t\t\treturn NameUtil.getNationNamesStartingWith(args[0]);\r\n+\t\t\t\t\t}\r\n+\t\t\t\tcase 2:\r\n+\t\t\t\t\tswitch (args[0].toLowerCase()) {\r\n+\t\t\t\t\t\tcase \"set\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(nationSetTabCompletes, args[1]);\r\n+\t\t\t\t\t\tcase \"rank\":\r", "originalCommit": "202c0e6584096a036b9cf6468cc4450f1812b726", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNTkyMw==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382315923", "bodyText": "It does farther down, see the following lines around 270-ish.\nI'm not sure if I want to go with this style, but for the first switch statement I have cases that return possible sub commands. If none of the cases return anything, the second switch inside of the if (args.length > 1) { will handle returning possible residents, towns, nations, ranks, perms, etc.\nI may want to everything in one switch which has cases for each sub command. This may be easier in terms of readability with especially long commands, such as /t set perm ally build off as an example", "author": "stzups", "createdAt": "2020-02-20T23:26:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNDQxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNTAyOA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382305028", "bodyText": "Not sure what the king bit here is for, /n set king is a command but I don't think /n king is.", "author": "LlmDl", "createdAt": "2020-02-20T22:55:37Z", "path": "src/com/palmergames/bukkit/towny/command/NationCommand.java", "diffHunk": "@@ -188,43 +204,110 @@\n \t@Override\r\n \tpublic List<String> onTabComplete(CommandSender sender, Command command, String alias, String[] args) {\r\n \r\n-\t\tif (args.length == 1) {\r\n-\t\t\tList<String> nationNames = NameUtil.getNationNames();\r\n-\t\t\tnationNames.addAll(nationTabCompletes);\r\n-\t\t\treturn NameUtil.filterByStart(nationNames, args[0]);\r\n-\t\t}\r\n-\r\n-\t\tif (args.length == 2) {\r\n-\t\t\tswitch (args[0].toLowerCase()) {\r\n-\t\t\t\tcase \"set\":\r\n-\t\t\t\t\treturn NameUtil.filterByStart(nationSetTabCompletes, args[1]);\r\n-\t\t\t\tcase \"rank\":\r\n-\t\t\t\tcase \"ally\":\r\n-\t\t\t\tcase \"enemy\":\r\n-\t\t\t\t\treturn NameUtil.filterByStart(new ArrayList<>(Arrays.asList(\r\n-\t\t\t\t\t\t\"add\",\r\n-\t\t\t\t\t\t\"remove\"\r\n-\t\t\t\t\t)), args[1]);\r\n-\t\t\t\tcase \"kick\":\r\n-\t\t\t\tcase \"add\":\r\n-\t\t\t\t\treturn NameUtil.getTownNamesStartingWith(args[1]);\r\n-\t\t\t\tcase \"toggle\":\r\n-\t\t\t\t\treturn NameUtil.filterByStart(nationToggleTabCompletes, args[1]);\r\n-\t\t\t\tcase \"join\":\r\n-\t\t\t\t\treturn NameUtil.getNationNamesStartingWith(args[1]);\r\n-\r\n+\t\tif (sender instanceof Player) {\r\n+\t\t\tPlayer player = (Player) sender;\r\n+\t\t\tswitch (args.length) {\r\n+\t\t\t\tcase 1:\r\n+\t\t\t\t\t// Only suggest nation names in tab complete if the player is not typing a valid sub command. This reduces clutter and the unnecessary checking of all nation names for tab completion\r\n+\t\t\t\t\tList<String> nationNames = NameUtil.filterByStart(nationTabCompletes, args[0]);\r\n+\t\t\t\t\tif (nationNames.size() > 0) {\r\n+\t\t\t\t\t\treturn nationNames;\r\n+\t\t\t\t\t} else {\r\n+\t\t\t\t\t\treturn NameUtil.getNationNamesStartingWith(args[0]);\r\n+\t\t\t\t\t}\r\n+\t\t\t\tcase 2:\r\n+\t\t\t\t\tswitch (args[0].toLowerCase()) {\r\n+\t\t\t\t\t\tcase \"set\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(nationSetTabCompletes, args[1]);\r\n+\t\t\t\t\t\tcase \"rank\":\r\n+\t\t\t\t\t\tcase \"enemy\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(nationEnemyTabCompletes, args[1]);\r\n+\t\t\t\t\t\tcase \"ally\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(nationAllyTabCompletes, args[1]);\r\n+\t\t\t\t\t\tcase \"toggle\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(nationToggleTabCompletes, args[1]);\r\n+\t\t\t\t\t\tcase \"king\":\r", "originalCommit": "202c0e6584096a036b9cf6468cc4450f1812b726", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxMjEwNA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382312104", "bodyText": "/n king is not a command but /n king ? shows a help page for commands relevant to a nation's king. This isn't necessary but is on purpose.", "author": "stzups", "createdAt": "2020-02-20T23:15:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNTAyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMyNjA5NQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382326095", "bodyText": "Ah right", "author": "LlmDl", "createdAt": "2020-02-20T23:55:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNTAyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNTUyNQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382305525", "bodyText": "I believe this one you're handling the admin ability to make a nation for a capital, this command has already been removed (and will be off the commands wikipage after we put out the  next release build.)", "author": "LlmDl", "createdAt": "2020-02-20T22:57:02Z", "path": "src/com/palmergames/bukkit/towny/command/NationCommand.java", "diffHunk": "@@ -188,43 +204,110 @@\n \t@Override\r\n \tpublic List<String> onTabComplete(CommandSender sender, Command command, String alias, String[] args) {\r\n \r\n-\t\tif (args.length == 1) {\r\n-\t\t\tList<String> nationNames = NameUtil.getNationNames();\r\n-\t\t\tnationNames.addAll(nationTabCompletes);\r\n-\t\t\treturn NameUtil.filterByStart(nationNames, args[0]);\r\n-\t\t}\r\n-\r\n-\t\tif (args.length == 2) {\r\n-\t\t\tswitch (args[0].toLowerCase()) {\r\n-\t\t\t\tcase \"set\":\r\n-\t\t\t\t\treturn NameUtil.filterByStart(nationSetTabCompletes, args[1]);\r\n-\t\t\t\tcase \"rank\":\r\n-\t\t\t\tcase \"ally\":\r\n-\t\t\t\tcase \"enemy\":\r\n-\t\t\t\t\treturn NameUtil.filterByStart(new ArrayList<>(Arrays.asList(\r\n-\t\t\t\t\t\t\"add\",\r\n-\t\t\t\t\t\t\"remove\"\r\n-\t\t\t\t\t)), args[1]);\r\n-\t\t\t\tcase \"kick\":\r\n-\t\t\t\tcase \"add\":\r\n-\t\t\t\t\treturn NameUtil.getTownNamesStartingWith(args[1]);\r\n-\t\t\t\tcase \"toggle\":\r\n-\t\t\t\t\treturn NameUtil.filterByStart(nationToggleTabCompletes, args[1]);\r\n-\t\t\t\tcase \"join\":\r\n-\t\t\t\t\treturn NameUtil.getNationNamesStartingWith(args[1]);\r\n-\r\n+\t\tif (sender instanceof Player) {\r\n+\t\t\tPlayer player = (Player) sender;\r\n+\t\t\tswitch (args.length) {\r\n+\t\t\t\tcase 1:\r\n+\t\t\t\t\t// Only suggest nation names in tab complete if the player is not typing a valid sub command. This reduces clutter and the unnecessary checking of all nation names for tab completion\r\n+\t\t\t\t\tList<String> nationNames = NameUtil.filterByStart(nationTabCompletes, args[0]);\r\n+\t\t\t\t\tif (nationNames.size() > 0) {\r\n+\t\t\t\t\t\treturn nationNames;\r\n+\t\t\t\t\t} else {\r\n+\t\t\t\t\t\treturn NameUtil.getNationNamesStartingWith(args[0]);\r\n+\t\t\t\t\t}\r\n+\t\t\t\tcase 2:\r\n+\t\t\t\t\tswitch (args[0].toLowerCase()) {\r\n+\t\t\t\t\t\tcase \"set\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(nationSetTabCompletes, args[1]);\r\n+\t\t\t\t\t\tcase \"rank\":\r\n+\t\t\t\t\t\tcase \"enemy\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(nationEnemyTabCompletes, args[1]);\r\n+\t\t\t\t\t\tcase \"ally\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(nationAllyTabCompletes, args[1]);\r\n+\t\t\t\t\t\tcase \"toggle\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(nationToggleTabCompletes, args[1]);\r\n+\t\t\t\t\t\tcase \"king\":\r\n+\t\t\t\t\t\t\treturn NameUtil.filterByStart(new ArrayList<>(Collections.singletonList(\"?\")), args[1]);\r\n+\t\t\t\t\t}\r\n \t\t\t}\r\n-\t\t}\r\n \r\n-\t\tif (args.length == 3) {\r\n-\t\t\tswitch (args[1].toLowerCase()) {\r\n-\t\t\t\tcase \"remove\":\r\n-\t\t\t\tcase \"add\":\r\n-\t\t\t\t\treturn NameUtil.getNationNamesStartingWith(args[2]);\r\n+\t\t\tif (args.length > 1) {\r\n+\t\t\t\tswitch (args[0].toLowerCase()) {\r\n+\t\t\t\t\tcase \"townlist\":\r\n+\t\t\t\t\tcase \"allylist\":\r\n+\t\t\t\t\tcase \"enemylist\":\r\n+\t\t\t\t\tcase \"join\":\r\n+\t\t\t\t\tcase \"delete\":\r\n+\t\t\t\t\tcase \"spawn\":\r\n+\t\t\t\t\t\treturn NameUtil.getNationNamesStartingWith(args[1]);\r\n+\t\t\t\t\tcase \"new\":\r", "originalCommit": "202c0e6584096a036b9cf6468cc4450f1812b726", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxODgxMg==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382318812", "bodyText": "Removed", "author": "stzups", "createdAt": "2020-02-20T23:35:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNTUyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNjQxMA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382306410", "bodyText": "The original command was neutral, and someone thought this wasn't quite clear enough and changed it to peaceful. Both should be available.", "author": "LlmDl", "createdAt": "2020-02-20T22:59:08Z", "path": "src/com/palmergames/bukkit/towny/command/NationCommand.java", "diffHunk": "@@ -110,10 +111,25 @@\n \t\t\"tag\"\r\n \t));\r\n \t\r\n-\tpublic static final List<String> nationToggleTabCompletes = new ArrayList<>(Arrays.asList(\r\n-\t\t\"neutral\",\r\n+\tstatic final List<String> nationToggleTabCompletes = new ArrayList<>(Arrays.asList(\r\n+\t\t\"peaceful\",\r", "originalCommit": "202c0e6584096a036b9cf6468cc4450f1812b726", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxODA0OQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382318049", "bodyText": "If both are available, then should both be show in the /n toggle help? This may be confusing to users because there are two different words that do the same thing. What if the /n toggle looked like this?", "author": "stzups", "createdAt": "2020-02-20T23:33:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNjQxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMyNjM3OA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3710#discussion_r382326378", "bodyText": "make it so", "author": "LlmDl", "createdAt": "2020-02-20T23:56:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwNjQxMA=="}], "type": "inlineReview"}, {"oid": "81ed8008c196d3f1cf50591e0eab7e41583b63c5", "url": "https://github.com/TownyAdvanced/Towny/commit/81ed8008c196d3f1cf50591e0eab7e41583b63c5", "message": "Removed tab completion for /new, added neutral /n toggle tab completes but not the help page", "committedDate": "2020-02-20T23:34:36Z", "type": "commit"}, {"oid": "0c3b731c971887308041560cea5bb0b82b26c9cb", "url": "https://github.com/TownyAdvanced/Towny/commit/0c3b731c971887308041560cea5bb0b82b26c9cb", "message": "Made NationCommand tab complete more readable, made tab completions better", "committedDate": "2020-02-21T00:22:43Z", "type": "commit"}, {"oid": "711da404e12d59708424aa824ac1c69a242aa35d", "url": "https://github.com/TownyAdvanced/Towny/commit/711da404e12d59708424aa824ac1c69a242aa35d", "message": "/n enemy remove only returns nation's current enemies", "committedDate": "2020-02-21T00:33:20Z", "type": "commit"}, {"oid": "7154dccced9354c7fc41910a088b86dec7d51e40", "url": "https://github.com/TownyAdvanced/Towny/commit/7154dccced9354c7fc41910a088b86dec7d51e40", "message": "Added comments", "committedDate": "2020-02-21T00:37:48Z", "type": "commit"}]}