{"pr_number": 2306, "pr_title": "CorfuStoreBrowser: Support infoTable and dropTable", "pr_createdAt": "2020-01-11T02:11:05Z", "pr_url": "https://github.com/CorfuDB/CorfuDB/pull/2306", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NzIwMQ==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r365567201", "bodyText": "what if namespace or/and table doesn't exist?", "author": "xnull", "createdAt": "2020-01-12T08:52:48Z", "path": "corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowser.java", "diffHunk": "@@ -81,10 +82,23 @@ public void listTables(String namespace)\n     {\n         log.info(\"\\n=====Tables=======\\n\");\n         for (CorfuStoreMetadata.TableName tableName : runtime.getTableRegistry()\n-            .listTables(namespace)) {\n+                .listTables(namespace)) {\n             log.info(\"Table: \" + tableName.getTableName());\n             log.info(\"Namespace: \" + tableName.getNamespace());\n         }\n         log.info(\"\\n======================\\n\");\n     }\n+\n+    /**\n+     * Print information about a specific table in CorfuStore\n+     */\n+    public void printTableInfo(String namespace, String tablename) {\n+        log.info(\"\\n======================\\n\");", "originalCommit": "5ba85c2ac4d354ffc8c8fda3465988b0eb0c4c94", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjA4NTMzOQ==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r366085339", "bodyText": "Good point, I think its better to detect and fail gracefully. fixed in latest patch. thanks", "author": "hisundar", "createdAt": "2020-01-13T23:34:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NzIwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NzI4OA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r365567288", "bodyText": "let's use Optional here and avoid using null-s", "author": "xnull", "createdAt": "2020-01-12T08:54:01Z", "path": "corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowserMain.java", "diffHunk": "@@ -75,17 +75,23 @@ public static void main(String[] args) {\n             log.info(\"Successfully connected to {}\", singleNodeEndpoint);\n \n             CorfuStoreBrowser browser = new CorfuStoreBrowser(runtime);\n+            CorfuTable<CorfuDynamicKey, CorfuDynamicRecord> table;\n+            String namespace = opts.containsKey(\"--namespace\") ?", "originalCommit": "5ba85c2ac4d354ffc8c8fda3465988b0eb0c4c94", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjA4NTY2Mg==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r366085662", "bodyText": "actually using null makes it easier to detect and fail gracefully.", "author": "hisundar", "createdAt": "2020-01-13T23:35:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NzI4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NzMwNA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r365567304", "bodyText": "same here", "author": "xnull", "createdAt": "2020-01-12T08:54:19Z", "path": "corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowserMain.java", "diffHunk": "@@ -75,17 +75,23 @@ public static void main(String[] args) {\n             log.info(\"Successfully connected to {}\", singleNodeEndpoint);\n \n             CorfuStoreBrowser browser = new CorfuStoreBrowser(runtime);\n+            CorfuTable<CorfuDynamicKey, CorfuDynamicRecord> table;\n+            String namespace = opts.containsKey(\"--namespace\") ?\n+                    opts.get(\"--namespace\").toString() : null;\n+            String tableName = opts.containsKey(\"--tablename\") ?", "originalCommit": "5ba85c2ac4d354ffc8c8fda3465988b0eb0c4c94", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NzMzOA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r365567338", "bodyText": "please use an enum instead of strings", "author": "xnull", "createdAt": "2020-01-12T08:54:59Z", "path": "corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowserMain.java", "diffHunk": "@@ -75,17 +75,23 @@ public static void main(String[] args) {\n             log.info(\"Successfully connected to {}\", singleNodeEndpoint);\n \n             CorfuStoreBrowser browser = new CorfuStoreBrowser(runtime);\n+            CorfuTable<CorfuDynamicKey, CorfuDynamicRecord> table;\n+            String namespace = opts.containsKey(\"--namespace\") ?\n+                    opts.get(\"--namespace\").toString() : null;\n+            String tableName = opts.containsKey(\"--tablename\") ?\n+                    opts.get(\"--tablename\").toString() : null;\n             switch (operation) {\n                 case \"listTables\":\n-                    String namespace = opts.containsKey(\"--namespace\") ?\n-                        opts.get(\"--namespace\").toString() : null;\n                     browser.listTables(namespace);\n                     break;\n-\n+                case \"infoTable\":", "originalCommit": "5ba85c2ac4d354ffc8c8fda3465988b0eb0c4c94", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjA4NTcxNQ==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r366085715", "bodyText": "done. thanks", "author": "hisundar", "createdAt": "2020-01-13T23:36:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NzMzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAyMjc2Ng==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r366022766", "bodyText": "Use {} as a placeholder to make this statement clearer.", "author": "lixinchengdu", "createdAt": "2020-01-13T20:54:40Z", "path": "corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowser.java", "diffHunk": "@@ -81,10 +82,23 @@ public void listTables(String namespace)\n     {\n         log.info(\"\\n=====Tables=======\\n\");\n         for (CorfuStoreMetadata.TableName tableName : runtime.getTableRegistry()\n-            .listTables(namespace)) {\n+                .listTables(namespace)) {\n             log.info(\"Table: \" + tableName.getTableName());\n             log.info(\"Namespace: \" + tableName.getNamespace());\n         }\n         log.info(\"\\n======================\\n\");\n     }\n+\n+    /**\n+     * Print information about a specific table in CorfuStore\n+     */\n+    public void printTableInfo(String namespace, String tablename) {\n+        log.info(\"\\n======================\\n\");\n+        String fullName = TableRegistry.getFullyQualifiedTableName(namespace, tablename);\n+        UUID streamUUID = UUID.nameUUIDFromBytes(fullName.getBytes());\n+        CorfuTable<CorfuDynamicKey, CorfuDynamicRecord> table = getTable(namespace, tablename);\n+        log.info(\"Table \" + tablename + \" in namespace \" + namespace", "originalCommit": "5ba85c2ac4d354ffc8c8fda3465988b0eb0c4c94", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjA4NTgxOA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r366085818", "bodyText": "done. thanks", "author": "hisundar", "createdAt": "2020-01-13T23:36:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAyMjc2Ng=="}], "type": "inlineReview"}, {"oid": "47ac9cd42ea2b7a55c06e483ea5c348ae67f6c27", "url": "https://github.com/CorfuDB/CorfuDB/commit/47ac9cd42ea2b7a55c06e483ea5c348ae67f6c27", "message": "CorfuStoreBrowser: Support infoTable and dropTable\n\ninfoTable prints the size without iterating the contents.\ndropTable allows clearing entries of a large table.", "committedDate": "2020-01-13T23:39:41Z", "type": "commit"}, {"oid": "47ac9cd42ea2b7a55c06e483ea5c348ae67f6c27", "url": "https://github.com/CorfuDB/CorfuDB/commit/47ac9cd42ea2b7a55c06e483ea5c348ae67f6c27", "message": "CorfuStoreBrowser: Support infoTable and dropTable\n\ninfoTable prints the size without iterating the contents.\ndropTable allows clearing entries of a large table.", "committedDate": "2020-01-13T23:39:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjExNjc3Mg==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2306#discussion_r366116772", "bodyText": "we can just call verifyNamespace here", "author": "pankti-m", "createdAt": "2020-01-14T01:41:34Z", "path": "corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowserMain.java", "diffHunk": "@@ -19,6 +20,28 @@\n  */\n @Slf4j\n public class CorfuStoreBrowserMain {\n+    private enum OperationType {\n+        listTables,\n+        infoTable,\n+        showTable,\n+        dropTable\n+    }\n+\n+    private static void verifyNamespace(String namespace) {\n+        if (namespace == null) {\n+            throw new IllegalArgumentException(\"Please specify --namespace\");\n+        }\n+    }\n+\n+    private static void verifyNamespaceAndTablename(String namespace, String tableName) {\n+        if (namespace == null) {", "originalCommit": "47ac9cd42ea2b7a55c06e483ea5c348ae67f6c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}