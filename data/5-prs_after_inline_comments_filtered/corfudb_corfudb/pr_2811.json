{"pr_number": 2811, "pr_title": "CICD workflow: fix flaky CorfuStoreShimTest#checkRevisionValidation", "pr_createdAt": "2020-11-03T01:29:36Z", "pr_url": "https://github.com/CorfuDB/CorfuDB/pull/2811", "timeline": [{"oid": "aee17da3f417a318ba15fb88bacdebfaa59d8751", "url": "https://github.com/CorfuDB/CorfuDB/commit/aee17da3f417a318ba15fb88bacdebfaa59d8751", "message": "CICD workflow: fix flaky CorfuStoreShimTest#checkRevisionValidation", "committedDate": "2020-11-03T01:28:21Z", "type": "commit"}, {"oid": "2f56a318601302defe4dd2985214d3a9cfeb3724", "url": "https://github.com/CorfuDB/CorfuDB/commit/2f56a318601302defe4dd2985214d3a9cfeb3724", "message": "Merge branch 'master' into cicd-corfu-store-shim-test-flakyness", "committedDate": "2020-11-03T02:13:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQxMTI3MA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#discussion_r516411270", "bodyText": "Maybe consider using .isLessThanOrEqualTo() instead?", "author": "zfrenette", "createdAt": "2020-11-03T03:33:04Z", "path": "test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java", "diffHunk": "@@ -248,7 +249,7 @@ public void checkRevisionValidation() throws Exception {\n         }\n         assertThat(entry.getMetadata().getRevision()).isEqualTo(2L);\n         assertThat(entry.getMetadata().getCreateUser()).isEqualTo(\"user_1\");\n-        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis());\n+        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis() + 1);", "originalCommit": "2f56a318601302defe4dd2985214d3a9cfeb3724", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzYxNzk1OA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#discussion_r517617958", "bodyText": "done", "author": "xnull", "createdAt": "2020-11-04T20:39:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQxMTI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODMyNzk1Mg==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#discussion_r518327952", "bodyText": "@xnull The change to isLessThanOrEqualTo() did not take effect in the patch", "author": "WenbinZhu", "createdAt": "2020-11-05T19:57:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQxMTI3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQzMjc3Nw==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#discussion_r516432777", "bodyText": "Please add a comment on why you are comparing with a future timestamp. I believe you did it to avoid having to sleep() which I think is a great idea, but would be good to document.", "author": "hisundar", "createdAt": "2020-11-03T05:19:28Z", "path": "test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java", "diffHunk": "@@ -248,7 +249,7 @@ public void checkRevisionValidation() throws Exception {\n         }\n         assertThat(entry.getMetadata().getRevision()).isEqualTo(2L);\n         assertThat(entry.getMetadata().getCreateUser()).isEqualTo(\"user_1\");\n-        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis());\n+        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis() + 1);", "originalCommit": "2f56a318601302defe4dd2985214d3a9cfeb3724", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ2Mjk4OA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#discussion_r516462988", "bodyText": "Yeah, probably then @zfrenette 's idea of using isLessThanOrEqualTo would be self-describing, now it seems that we compare with the future", "author": "xnull", "createdAt": "2020-11-03T07:19:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQzMjc3Nw=="}], "type": "inlineReview"}, {"oid": "c7194e72aeb0ed7f1126742f415c730459eb9ea6", "url": "https://github.com/CorfuDB/CorfuDB/commit/c7194e72aeb0ed7f1126742f415c730459eb9ea6", "message": "Merge branch 'master' into cicd-corfu-store-shim-test-flakyness", "committedDate": "2020-11-04T20:39:52Z", "type": "commit"}]}