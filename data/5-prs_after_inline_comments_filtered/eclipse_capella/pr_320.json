{"pr_number": 320, "pr_title": "IS 2 IS added menu when selecting Capability/Capa Realization, Cap. Realiz.pkg architectures", "pr_createdAt": "2020-08-07T11:04:37Z", "pr_url": "https://github.com/eclipse/capella/pull/320", "timeline": [{"oid": "a8299cf2054e33dafdd2f114dbc0266a295705f9", "url": "https://github.com/eclipse/capella/commit/a8299cf2054e33dafdd2f114dbc0266a295705f9", "message": "IS 2 IS added menu when selecting Capability/Capa Realiz, Cap.\nRealiz.pkg architectures\n\n\nChange-Id: I34a9d8b352b3159e52d28aa44bed197e0a0284a2\nSigned-off-by: Georgiana Ecobici <georgiana-elena.ecobici@thalesgroup.com>", "committedDate": "2020-08-07T10:30:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzg0NTg0Ng==", "url": "https://github.com/eclipse/capella/pull/320#discussion_r467845846", "bodyText": "Is the check\n(object instanceof CapellaElement)\n&& (CapellaLayerCheckingExt.isInContextLayer((CapellaElement) object)\n|| CapellaLayerCheckingExt.isInLogicalLayer((CapellaElement) object)\n|| CapellaLayerCheckingExt.isInPhysicalLayer((CapellaElement) object))\nredundant (every object passed to the method is already sure to be a CapellaElement & belongs to SA/LA/PA)?", "author": "minhtutonthat", "createdAt": "2020-08-10T11:38:39Z", "path": "core/plugins/org.polarsys.capella.core.projection.common/src/org/polarsys/capella/core/projection/common/TransitionHelper.java", "diffHunk": "@@ -489,54 +489,61 @@ public boolean isPropertyValueTransitionAvailable(EObject object) {\n   }\n \n   public boolean isIS2ISSALATransitionAvailable(EObject element) {\n-    return element instanceof Scenario && ((Scenario) element).getKind() == ScenarioKind.INTERFACE\n-        && CapellaLayerCheckingExt.isAOrInContextLayer((Scenario) element)\n-        && isIS2ISTransitionAvailable((Scenario) element, \"SALA\");\n+    return element instanceof CapellaElement && CapellaLayerCheckingExt.isAOrInContextLayer((CapellaElement) element)\n+        && isIS2ISTransitionAvailable(element, \"SALA\");\n   }\n \n   public boolean isIS2ISLAPATransitionAvailable(EObject element) {\n-    return element instanceof Scenario && ((Scenario) element).getKind() == ScenarioKind.INTERFACE\n-        && CapellaLayerCheckingExt.isAOrInLogicalLayer((Scenario) element)\n-        && isIS2ISTransitionAvailable((Scenario) element, \"LAPA\");\n+    return element instanceof CapellaElement && CapellaLayerCheckingExt.isAOrInLogicalLayer((CapellaElement) element)\n+        && isIS2ISTransitionAvailable(element, \"LAPA\");\n   }\n \n   public boolean isIS2ISPAEPBSTransitionAvailable(EObject element) {\n-    return element instanceof Scenario && ((Scenario) element).getKind() == ScenarioKind.INTERFACE\n-        && CapellaLayerCheckingExt.isAOrInPhysicalLayer((Scenario) element)\n-        && isIS2ISTransitionAvailable((Scenario) element, \"PAEPBS\");\n+    return element instanceof CapellaElement && CapellaLayerCheckingExt.isAOrInPhysicalLayer((CapellaElement) element)\n+        && isIS2ISTransitionAvailable(element, \"PAEPBS\");\n   }\n-  \n-  private boolean isIS2ISTransitionAvailable(Scenario scenario, String transition) {\n-\n-    BlockArchitecture architectureSource = BlockArchitectureExt.getRootBlockArchitecture(scenario);\n-\n-    // Disable command if there is a transitioned IS\n-    for (AbstractTrace trace : scenario.getIncomingTraces()) {\n-      TraceableElement src = trace.getSourceElement();\n-      if (src instanceof Scenario) {\n-        Scenario existingScenario = (Scenario) src;\n-        // Should be an Interface Scenario\n-        if (existingScenario.getKind() == ScenarioKind.INTERFACE) {\n-          BlockArchitecture architectureTarget = BlockArchitectureExt.getRootBlockArchitecture(existingScenario);\n-          if (\"SALA\".equals(transition)) {\n-            if (architectureSource instanceof SystemAnalysis && architectureTarget instanceof LogicalArchitecture) {\n-              return false;\n-            }\n-          } else if (\"LAPA\".equals(transition)) {\n-            if (architectureSource instanceof LogicalArchitecture\n-                && architectureTarget instanceof PhysicalArchitecture) {\n-              return false;\n-            }\n-          } else if (\"PAEPBS\".equals(transition)) {\n-            if (architectureSource instanceof PhysicalArchitecture && architectureTarget instanceof EPBSArchitecture) {\n-              return false;\n+\n+  private boolean isIS2ISTransitionAvailable(EObject object, String transition) {\n+    if (object instanceof Scenario && ((Scenario) object).getKind() == ScenarioKind.INTERFACE) {\n+      Scenario scenario = (Scenario) object;\n+      BlockArchitecture architectureSource = BlockArchitectureExt.getRootBlockArchitecture(scenario);\n+\n+      // Disable command if there is a transitioned IS\n+      for (AbstractTrace trace : scenario.getIncomingTraces()) {\n+        TraceableElement src = trace.getSourceElement();\n+        if (src instanceof Scenario) {\n+          Scenario existingScenario = (Scenario) src;\n+          // Should be an Interface Scenario\n+          if (existingScenario.getKind() == ScenarioKind.INTERFACE) {\n+            BlockArchitecture architectureTarget = BlockArchitectureExt.getRootBlockArchitecture(existingScenario);\n+            if (\"SALA\".equals(transition)) {\n+              if (architectureSource instanceof SystemAnalysis && architectureTarget instanceof LogicalArchitecture) {\n+                return false;\n+              }\n+            } else if (\"LAPA\".equals(transition)) {\n+              if (architectureSource instanceof LogicalArchitecture\n+                  && architectureTarget instanceof PhysicalArchitecture) {\n+                return false;\n+              }\n+            } else if (\"PAEPBS\".equals(transition)) {\n+              if (architectureSource instanceof PhysicalArchitecture\n+                  && architectureTarget instanceof EPBSArchitecture) {\n+                return false;\n+              }\n             }\n-          }\n \n-          continue;\n+            continue;\n+          }\n         }\n       }\n+      return true;\n     }\n-    return true;\n+    return ((object instanceof SystemAnalysis) || (object instanceof LogicalArchitecture)\n+        || (object instanceof PhysicalArchitecture))\n+        || ((object instanceof CapellaElement)", "originalCommit": "a8299cf2054e33dafdd2f114dbc0266a295705f9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzg0OTQzNA==", "url": "https://github.com/eclipse/capella/pull/320#discussion_r467849434", "bodyText": "Yes, it seems redundant, I will update.", "author": "georgiana-ecobici", "createdAt": "2020-08-10T11:47:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzg0NTg0Ng=="}], "type": "inlineReview"}, {"oid": "368bf1d8f1b6774a42420390e3d6741ec501a412", "url": "https://github.com/eclipse/capella/commit/368bf1d8f1b6774a42420390e3d6741ec501a412", "message": "IS 2 IS added menu when selecting Capability/Capa Realiz, Cap.\nRealiz.pkg architectures\n\n\nChange-Id: I2a232329e1ef86be5b964b5f3e1d5ff74e99471b\nSigned-off-by: Georgiana Ecobici <georgiana-elena.ecobici@thalesgroup.com>", "committedDate": "2020-08-10T11:56:32Z", "type": "commit"}]}