{"pr_number": 693, "pr_title": "Defines a default Index including  the tenant and searchPrefixes", "pr_createdAt": "2020-02-25T15:47:05Z", "pr_url": "https://github.com/scireum/sirius-biz/pull/693", "timeline": [{"oid": "a59cdc403a090bb60bbf278a37dedfa5da0e5612", "url": "https://github.com/scireum/sirius-biz/commit/a59cdc403a090bb60bbf278a37dedfa5da0e5612", "message": "Defines a default Index including  the tenant and searchPrefixes\n\nWhich will be created for all MongoTenantAware entities.\n\nFixes: SIRI-184", "committedDate": "2020-02-25T15:43:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM0NjYyMw==", "url": "https://github.com/scireum/sirius-biz/pull/693#discussion_r384346623", "bodyText": "shouldn't this be named prefix_index to overwrite the index defined by PrefixSearchable Entity?\notherwise we end up with two entities where the original one will almost never be used(?)", "author": "andyHa", "createdAt": "2020-02-26T08:51:46Z", "path": "src/main/java/sirius/biz/tenants/mongo/MongoTenantAware.java", "diffHunk": "@@ -11,14 +11,23 @@\n import sirius.biz.mongo.MongoBizEntity;\n import sirius.biz.tenants.Tenant;\n import sirius.biz.web.TenantAware;\n+import sirius.db.mixing.annotations.Index;\n+import sirius.db.mongo.Mango;\n import sirius.db.mongo.types.MongoRef;\n import sirius.kernel.di.std.Part;\n \n import java.util.Optional;\n \n /**\n  * Base class which marks subclasses as aware of their tenant they belong to.\n+ * <p>\n+ * Note that an index is automatically created containing the tenant itself and the searchPrefixes,\n+ * which are added via {@link MongoBizEntity}. You can skip the index creation by defining an {@link Index}\n+ * without columns.\n  */\n+@Index(name = \"tenant_searchPrefixes\",", "originalCommit": "a59cdc403a090bb60bbf278a37dedfa5da0e5612", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM4MDExMw==", "url": "https://github.com/scireum/sirius-biz/pull/693#discussion_r384380113", "bodyText": "The real index name is searchPrefixes_1 since it wasn't using the name property of the annotation. All indexes must be dropped and recreated anyway, therefore I would include the word tenant in the name to better indicate how the index is build up.", "author": "idlira", "createdAt": "2020-02-26T09:47:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM0NjYyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQwOTI4Nw==", "url": "https://github.com/scireum/sirius-biz/pull/693#discussion_r384409287", "bodyText": "i meant name it so that the parent index as defined by PrefixSearchableEntity is suppressed - although a misleading name in mongo would be created then - still better than a mostly unused index", "author": "andyHa", "createdAt": "2020-02-26T10:39:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM0NjYyMw=="}], "type": "inlineReview"}, {"oid": "ee42a8fd8ae1324a242bce99287e5dfefbdd1421", "url": "https://github.com/scireum/sirius-biz/commit/ee42a8fd8ae1324a242bce99287e5dfefbdd1421", "message": "Removes default prefix_index in PrefixSearchableEntity\n\nFixes: SIRI-184", "committedDate": "2020-02-26T13:09:55Z", "type": "commit"}, {"oid": "a9b1393fdf40e8355bacf067af7c9d85fabd0f7f", "url": "https://github.com/scireum/sirius-biz/commit/a9b1393fdf40e8355bacf067af7c9d85fabd0f7f", "message": "Adds an index for searchPrefixes\n\nFixes: SIRI-84", "committedDate": "2020-02-26T13:10:36Z", "type": "commit"}, {"oid": "240e3ef1ec82bcd98080fdd0ad07d889a0f820db", "url": "https://github.com/scireum/sirius-biz/commit/240e3ef1ec82bcd98080fdd0ad07d889a0f820db", "message": "Renames index to better match other entities\n\nFixes: SIRI-184", "committedDate": "2020-02-26T13:10:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDUxMDQyMg==", "url": "https://github.com/scireum/sirius-biz/pull/693#discussion_r384510422", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Note that the <tt>searchPrefixes</tt> is not automatically indexed as it usually only make sense if indexed\n          \n          \n            \n             * Note that the <tt>searchPrefixes</tt> is not automatically indexed as it usually only makes sense if indexed", "author": "sabieber", "createdAt": "2020-02-26T14:03:25Z", "path": "src/main/java/sirius/biz/mongo/PrefixSearchableEntity.java", "diffHunk": "@@ -29,8 +29,12 @@\n \n /**\n  * Maintains a <tt>prefixSearchField</tt> in which all fields annotated with {@link PrefixSearchContent} are indexed.\n+ *\n+ * Note that the <tt>searchPrefixes</tt> is not automatically indexed as it usually only make sense if indexed", "originalCommit": "240e3ef1ec82bcd98080fdd0ad07d889a0f820db", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDUxMDkzNg==", "url": "https://github.com/scireum/sirius-biz/pull/693#discussion_r384510936", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * without columns.\n          \n          \n            \n             * with the same name and without columns.", "author": "sabieber", "createdAt": "2020-02-26T14:04:17Z", "path": "src/main/java/sirius/biz/tenants/mongo/MongoTenantAware.java", "diffHunk": "@@ -11,14 +11,23 @@\n import sirius.biz.mongo.MongoBizEntity;\n import sirius.biz.tenants.Tenant;\n import sirius.biz.web.TenantAware;\n+import sirius.db.mixing.annotations.Index;\n+import sirius.db.mongo.Mango;\n import sirius.db.mongo.types.MongoRef;\n import sirius.kernel.di.std.Part;\n \n import java.util.Optional;\n \n /**\n  * Base class which marks subclasses as aware of their tenant they belong to.\n+ * <p>\n+ * Note that an index is automatically created containing the tenant itself and the searchPrefixes,\n+ * which are added via {@link MongoBizEntity}. You can skip the index creation by defining an {@link Index}\n+ * without columns.", "originalCommit": "240e3ef1ec82bcd98080fdd0ad07d889a0f820db", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9f82ccca8c4981d6fb2713bd15cfde3e7c9dc4af", "url": "https://github.com/scireum/sirius-biz/commit/9f82ccca8c4981d6fb2713bd15cfde3e7c9dc4af", "message": "Updates Javadoc Typos\n\nCo-Authored-By: Sascha Bieberstein <sabieber@users.noreply.github.com>", "committedDate": "2020-02-26T18:36:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNjk2Ng==", "url": "https://github.com/scireum/sirius-biz/pull/693#discussion_r384936966", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             *\n          \n          \n            \n             * <p>", "author": "jmuscireum", "createdAt": "2020-02-27T06:37:53Z", "path": "src/main/java/sirius/biz/mongo/PrefixSearchableEntity.java", "diffHunk": "@@ -29,8 +29,12 @@\n \n /**\n  * Maintains a <tt>prefixSearchField</tt> in which all fields annotated with {@link PrefixSearchContent} are indexed.\n+ *", "originalCommit": "9f82ccca8c4981d6fb2713bd15cfde3e7c9dc4af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "130224be51a3226f72fd9709bfbfee073c731285", "url": "https://github.com/scireum/sirius-biz/commit/130224be51a3226f72fd9709bfbfee073c731285", "message": "Updates JavaDoc\n\nCo-Authored-By: jmuscireum <31538484+jmuscireum@users.noreply.github.com>", "committedDate": "2020-02-27T07:11:32Z", "type": "commit"}]}