{"pr_number": 10772, "pr_title": "RESTEasy - skip reflect. reg. for all types from javax.json package", "pr_createdAt": "2020-07-16T09:52:32Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10772", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY2ODc5OQ==", "url": "https://github.com/quarkusio/quarkus/pull/10772#discussion_r455668799", "bodyText": "To be totally safe, I think you need to add a dot at the end of the package name. It's not a biggie for this one but might be in the future for other packages.\nIt's probably better to do it here than in the startsWith as it will avoid creating new strings.", "author": "gsmet", "createdAt": "2020-07-16T09:56:27Z", "path": "extensions/resteasy-common/deployment/src/main/java/io/quarkus/resteasy/common/deployment/ResteasyDotNames.java", "diffHunk": "@@ -95,4 +99,8 @@ public boolean test(DotName name) {\n             // Vert-x\n             DotName.createSimple(\"io.vertx.core.json.JsonArray\"),\n             DotName.createSimple(\"io.vertx.core.json.JsonObject\")));\n+    \n+    private static final String[] PACKAGES_IGNORED_FOR_REFLECTION = {\n+            \"javax.json\"", "originalCommit": "77cc76fa34dc787632c7dccb10450f070b931773", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY5ODY2OA==", "url": "https://github.com/quarkusio/quarkus/pull/10772#discussion_r455698668", "bodyText": "Ok. Let's be \"totally safe\" :-)", "author": "mkouba", "createdAt": "2020-07-16T10:51:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY2ODc5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY3MDI5Ng==", "url": "https://github.com/quarkusio/quarkus/pull/10772#discussion_r455670296", "bodyText": "Wouldn't these also need to go away?", "author": "geoand", "createdAt": "2020-07-16T09:59:08Z", "path": "extensions/resteasy-common/deployment/src/main/java/io/quarkus/resteasy/common/deployment/ResteasyDotNames.java", "diffHunk": "@@ -63,19 +63,23 @@\n     private static class IgnoreForReflectionPredicate implements Predicate<DotName> {\n \n         @Override\n-        public boolean test(DotName name) {\n-            return ResteasyDotNames.TYPES_IGNORED_FOR_REFLECTION.contains(name)\n-                    || ReflectiveHierarchyBuildItem.DefaultIgnorePredicate.INSTANCE.test(name);\n+        public boolean test(DotName dotName) {\n+            if (ResteasyDotNames.TYPES_IGNORED_FOR_REFLECTION.contains(dotName)\n+                    || ReflectiveHierarchyBuildItem.DefaultIgnorePredicate.INSTANCE.test(dotName)) {\n+                return true;\n+            }\n+            String name = dotName.toString();\n+            for (String packageName : PACKAGES_IGNORED_FOR_REFLECTION) {\n+                if (name.startsWith(packageName)) {\n+                    return true;\n+                }\n+            }\n+            return false;\n         }\n     }\n \n     // Types ignored for reflection used by the RESTEasy and SmallRye REST client extensions.\n     private static final Set<DotName> TYPES_IGNORED_FOR_REFLECTION = new HashSet<>(Arrays.asList(\n-            // javax.json\n-            DotName.createSimple(\"javax.json.JsonObject\"),\n-            DotName.createSimple(\"javax.json.JsonArray\"),\n-            DotName.createSimple(\"javax.json.JsonValue\"),", "originalCommit": "77cc76fa34dc787632c7dccb10450f070b931773", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY3MDcxNw==", "url": "https://github.com/quarkusio/quarkus/pull/10772#discussion_r455670717", "bodyText": "Nevermind, my screen practically doesn't show the color GH uses to mark removal...", "author": "geoand", "createdAt": "2020-07-16T09:59:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY3MDI5Ng=="}], "type": "inlineReview"}, {"oid": "6f18bad467e9ff05b6efe1161db72d1c287abf3c", "url": "https://github.com/quarkusio/quarkus/commit/6f18bad467e9ff05b6efe1161db72d1c287abf3c", "message": "RESTEasy - skip reflect. reg. for all types from javax.json package", "committedDate": "2020-07-16T11:17:41Z", "type": "commit"}, {"oid": "6f18bad467e9ff05b6efe1161db72d1c287abf3c", "url": "https://github.com/quarkusio/quarkus/commit/6f18bad467e9ff05b6efe1161db72d1c287abf3c", "message": "RESTEasy - skip reflect. reg. for all types from javax.json package", "committedDate": "2020-07-16T11:17:41Z", "type": "forcePushed"}]}