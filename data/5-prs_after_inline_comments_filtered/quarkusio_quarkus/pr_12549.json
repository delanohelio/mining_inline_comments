{"pr_number": 12549, "pr_title": "Introduce QuarkusTestBeforeClassCallback", "pr_createdAt": "2020-10-06T13:44:48Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12549", "timeline": [{"oid": "2a1e3c27ce223884f5671c273b22d135afe1fe49", "url": "https://github.com/quarkusio/quarkus/commit/2a1e3c27ce223884f5671c273b22d135afe1fe49", "message": "Introduce QuarkusTestBeforeClassCallback\n\nFixes: #12544", "committedDate": "2020-10-06T13:57:42Z", "type": "forcePushed"}, {"oid": "cc62edfa6b2cdc90d2de8d8fb0780d8e96804926", "url": "https://github.com/quarkusio/quarkus/commit/cc62edfa6b2cdc90d2de8d8fb0780d8e96804926", "message": "Introduce QuarkusTestBeforeClassCallback\n\nFixes: #12544", "committedDate": "2020-10-06T14:12:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5MDIwNw==", "url": "https://github.com/quarkusio/quarkus/pull/12549#discussion_r500390207", "bodyText": "\ud83d\udc4d for adding a test for it! AFAICS it would be more correct if the test would make sure that testBeforeClass() is really called last via @Order.\nhttps://junit.org/junit5/docs/current/user-guide/#writing-tests-test-execution-order", "author": "famod", "createdAt": "2020-10-06T15:28:13Z", "path": "integration-tests/main/src/test/java/io/quarkus/it/main/QuarkusTestCallbacksTestCase.java", "diffHunk": "@@ -23,6 +25,11 @@ public void testTestMethodHasAnnotation() {\n \n     }\n \n+    @Test\n+    public void testBeforeClass() {\n+        assertEquals(1, SimpleAnnotationCheckerBeforeClassCallback.count.get());", "originalCommit": "cc62edfa6b2cdc90d2de8d8fb0780d8e96804926", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5Mjk0MA==", "url": "https://github.com/quarkusio/quarkus/pull/12549#discussion_r500392940", "bodyText": "Not sure what you mean here", "author": "geoand", "createdAt": "2020-10-06T15:31:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5MDIwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQyNjg5Nw==", "url": "https://github.com/quarkusio/quarkus/pull/12549#discussion_r500426897", "bodyText": "Without @Order there is no guarantee that this new method is called after the existing one.\nIf it is called as the first method and there is (for instance) a bug that the new callback is called for every method, then there will be a false positive.", "author": "famod", "createdAt": "2020-10-06T16:16:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5MDIwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQyOTkyNw==", "url": "https://github.com/quarkusio/quarkus/pull/12549#discussion_r500429927", "bodyText": "Not really, because the callback is executed for each test, not just this one.\nSo this test basically ensure that the callback is passed the proper parameter.", "author": "geoand", "createdAt": "2020-10-06T16:20:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5MDIwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ0MDMwMg==", "url": "https://github.com/quarkusio/quarkus/pull/12549#discussion_r500440302", "bodyText": "The callback shall run once for QuarkusTestCallbacksTestCase, but not again for each of the methods of this test class, right?\nSo, if I'm not missing something, in case there is a bug and the callback is invoked too often (e.g. for each test method), the test will not detect this when testBeforeClass() is called before testTestMethodHasAnnotation().", "author": "famod", "createdAt": "2020-10-06T16:36:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5MDIwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ0MTc2MQ==", "url": "https://github.com/quarkusio/quarkus/pull/12549#discussion_r500441761", "bodyText": "Yeah, that's the case. To be honest I don't think it's something that could happen, but on the other hand it's not a problem for me to add it.", "author": "geoand", "createdAt": "2020-10-06T16:38:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5MDIwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ0NjY3Ng==", "url": "https://github.com/quarkusio/quarkus/pull/12549#discussion_r500446676", "bodyText": "Up to you! Just something I ran into a couple of times, especially on different operating systems (but mostly with JUnit 4).\nAnd in some older major JDK update the order of methods gathered via reflection changed (in a non-deterministic way) which had some nasty effects for some projects that (partially unknowingly) relied on some order.", "author": "famod", "createdAt": "2020-10-06T16:46:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5MDIwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ0NzY4NQ==", "url": "https://github.com/quarkusio/quarkus/pull/12549#discussion_r500447685", "bodyText": "Fixed :)", "author": "geoand", "createdAt": "2020-10-06T16:48:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5MDIwNw=="}], "type": "inlineReview"}, {"oid": "fac1388a1471b8912afc448c29b4b5235b50a020", "url": "https://github.com/quarkusio/quarkus/commit/fac1388a1471b8912afc448c29b4b5235b50a020", "message": "Introduce QuarkusTestBeforeClassCallback\n\nFixes: #12544", "committedDate": "2020-10-06T16:46:41Z", "type": "forcePushed"}, {"oid": "e341c2021ba97cd09d143df37b02f452a4ce4e81", "url": "https://github.com/quarkusio/quarkus/commit/e341c2021ba97cd09d143df37b02f452a4ce4e81", "message": "Introduce QuarkusTestBeforeClassCallback\n\nFixes: #12544", "committedDate": "2020-10-08T05:41:49Z", "type": "commit"}, {"oid": "e341c2021ba97cd09d143df37b02f452a4ce4e81", "url": "https://github.com/quarkusio/quarkus/commit/e341c2021ba97cd09d143df37b02f452a4ce4e81", "message": "Introduce QuarkusTestBeforeClassCallback\n\nFixes: #12544", "committedDate": "2020-10-08T05:41:49Z", "type": "forcePushed"}]}