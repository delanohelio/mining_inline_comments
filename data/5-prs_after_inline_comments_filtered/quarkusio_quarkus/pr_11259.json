{"pr_number": 11259, "pr_title": "Fixing version range to support backward compatibility", "pr_createdAt": "2020-08-06T15:33:14Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/11259", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwMTY0MA==", "url": "https://github.com/quarkusio/quarkus/pull/11259#discussion_r466501640", "bodyText": "Use .equals() instead of ==", "author": "gastaldi", "createdAt": "2020-08-06T15:35:59Z", "path": "devtools/maven/src/main/java/io/quarkus/maven/CreateUtils.java", "diffHunk": "@@ -81,6 +82,14 @@ static QuarkusPlatformDescriptor resolvePlatformDescriptor(final String bomGroup\n             version = resolvePluginInfo(CreateUtils.class).getVersion();\n         }\n \n+        if((bomGroupId==null && bomArtifactId==null && bomVersion==null) || bomArtifactId==\"quarkus-universe-bom\"){", "originalCommit": "8b4579c57f044aeb5adf88706209070d2ffd899d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwMjkzNg==", "url": "https://github.com/quarkusio/quarkus/pull/11259#discussion_r466502936", "bodyText": "Also it would be nice to invert the comparison, to make sure that a NPE isn't accidentally thrown:\n\"quarkus-universe-bom\".equals(bomArtifactId)", "author": "gastaldi", "createdAt": "2020-08-06T15:37:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwMTY0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUxNjk2Ng==", "url": "https://github.com/quarkusio/quarkus/pull/11259#discussion_r466516966", "bodyText": "okk", "author": "Garima829", "createdAt": "2020-08-06T15:58:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwMTY0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwMzUwMQ==", "url": "https://github.com/quarkusio/quarkus/pull/11259#discussion_r466503501", "bodyText": "It should be -SNAPSHOT", "author": "gastaldi", "createdAt": "2020-08-06T15:38:34Z", "path": "devtools/maven/src/main/java/io/quarkus/maven/CreateUtils.java", "diffHunk": "@@ -81,6 +82,14 @@ static QuarkusPlatformDescriptor resolvePlatformDescriptor(final String bomGroup\n             version = resolvePluginInfo(CreateUtils.class).getVersion();\n         }\n \n+        if((bomGroupId==null && bomArtifactId==null && bomVersion==null) || bomArtifactId==\"quarkus-universe-bom\"){\n+            String baseVersion = resolvePluginInfo(CreateUtils.class).getVersion();\n+            DefaultArtifactVersion pluginVersion= new DefaultArtifactVersion(baseVersion);\n+            int majorVer=pluginVersion.getMajorVersion();\n+            int minorVer=pluginVersion.getMinorVersion();\n+            version = \"[\" + majorVer + \".\" + minorVer + \"-snapshot, \" + majorVer + \".\" + (minorVer + 1) + \")\";", "originalCommit": "8b4579c57f044aeb5adf88706209070d2ffd899d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwNDcyOA==", "url": "https://github.com/quarkusio/quarkus/pull/11259#discussion_r466504728", "bodyText": "-snapshot is ok, i suggested that actually", "author": "aloubyansky", "createdAt": "2020-08-06T15:40:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwMzUwMQ=="}], "type": "inlineReview"}, {"oid": "b8561f6bf44d3965b33b0aad3154012e86c099e8", "url": "https://github.com/quarkusio/quarkus/commit/b8561f6bf44d3965b33b0aad3154012e86c099e8", "message": "Modified if condition", "committedDate": "2020-08-06T17:07:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4NzQwMQ==", "url": "https://github.com/quarkusio/quarkus/pull/11259#discussion_r466687401", "bodyText": "Looks good. Now, given that the outer if is checking the version for null, we can be sure that the version will be null inside its block. So you don't have to be checking it again in the nested ifs.", "author": "aloubyansky", "createdAt": "2020-08-06T21:08:34Z", "path": "devtools/maven/src/main/java/io/quarkus/maven/CreateUtils.java", "diffHunk": "@@ -76,9 +77,18 @@ static QuarkusPlatformDescriptor resolvePlatformDescriptor(final String bomGroup\n         String artifactId = StringUtils.defaultIfBlank(bomArtifactId, null);\n         String version = StringUtils.defaultIfBlank(bomVersion, null);\n \n-        if (CreateUtils.QUARKUS_CORE_BOM_ARTIFACT_ID.equals(artifactId)\n-                && version == null) {\n-            version = resolvePluginInfo(CreateUtils.class).getVersion();\n+        if (version == null) {\n+            if (CreateUtils.QUARKUS_CORE_BOM_ARTIFACT_ID.equals(artifactId)) {\n+                version = resolvePluginInfo(CreateUtils.class).getVersion();\n+            } else if ((groupId == null && artifactId == null && version == null)\n+                    || (\"quarkus-universe-bom\".equals(artifactId) && version == null)) {", "originalCommit": "b8561f6bf44d3965b33b0aad3154012e86c099e8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjgzMDA3Ng==", "url": "https://github.com/quarkusio/quarkus/pull/11259#discussion_r466830076", "bodyText": "Oh yes I am sorry IDK how I skipped those", "author": "Garima829", "createdAt": "2020-08-07T05:33:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4NzQwMQ=="}], "type": "inlineReview"}, {"oid": "267b64e3984554af7d5e5d234e8ecc95292e6793", "url": "https://github.com/quarkusio/quarkus/commit/267b64e3984554af7d5e5d234e8ecc95292e6793", "message": "Removed extra version checks", "committedDate": "2020-08-07T06:04:47Z", "type": "commit"}, {"oid": "267b64e3984554af7d5e5d234e8ecc95292e6793", "url": "https://github.com/quarkusio/quarkus/commit/267b64e3984554af7d5e5d234e8ecc95292e6793", "message": "Removed extra version checks", "committedDate": "2020-08-07T06:04:47Z", "type": "forcePushed"}]}