{"pr_number": 8031, "pr_title": "Fix AmazonLambdaProcessor SkillStreamHandler subclass check", "pr_createdAt": "2020-03-20T16:34:43Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/8031", "timeline": [{"oid": "47565448e2a593b6dda474c18d3d732405b89174", "url": "https://github.com/quarkusio/quarkus/commit/47565448e2a593b6dda474c18d3d732405b89174", "message": "Fix SkillStreamHandler", "committedDate": "2020-03-20T16:14:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc4NzI3NA==", "url": "https://github.com/quarkusio/quarkus/pull/8031#discussion_r395787274", "bodyText": "Do we need to execute this if streamHandler is true?", "author": "gsmet", "createdAt": "2020-03-20T17:28:29Z", "path": "extensions/amazon-lambda/deployment/src/main/java/io/quarkus/amazon/lambda/deployment/AmazonLambdaProcessor.java", "diffHunk": "@@ -102,7 +102,7 @@ AdditionalApplicationArchiveMarkerBuildItem marker() {\n \n             ClassInfo current = info;\n             boolean done = false;\n-            boolean streamHandler = false;\n+            boolean streamHandler = info.superName().equals(SKILL_STREAM_HANDLER) ? true : false;\n             while (current != null && !done) {", "originalCommit": "47565448e2a593b6dda474c18d3d732405b89174", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk1OTg3Mw==", "url": "https://github.com/quarkusio/quarkus/pull/8031#discussion_r395959873", "bodyText": "Discussed below.", "author": "oztimpower", "createdAt": "2020-03-21T04:18:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc4NzI3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc4NzY4OA==", "url": "https://github.com/quarkusio/quarkus/pull/8031#discussion_r395787688", "bodyText": "That won't work if you have an intermediary subclass.", "author": "gsmet", "createdAt": "2020-03-20T17:29:14Z", "path": "extensions/amazon-lambda/deployment/src/main/java/io/quarkus/amazon/lambda/deployment/AmazonLambdaProcessor.java", "diffHunk": "@@ -102,7 +102,7 @@ AdditionalApplicationArchiveMarkerBuildItem marker() {\n \n             ClassInfo current = info;\n             boolean done = false;\n-            boolean streamHandler = false;\n+            boolean streamHandler = info.superName().equals(SKILL_STREAM_HANDLER) ? true : false;", "originalCommit": "47565448e2a593b6dda474c18d3d732405b89174", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc4ODMyNA==", "url": "https://github.com/quarkusio/quarkus/pull/8031#discussion_r395788324", "bodyText": "Ah OK I see we couldn't arrive here with an intermediary class.", "author": "gsmet", "createdAt": "2020-03-20T17:30:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc4NzY4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk1OTY1MA==", "url": "https://github.com/quarkusio/quarkus/pull/8031#discussion_r395959650", "bodyText": "Yes, in the while loop it doesn't enter the handleRequest() check, due to methods() only returning methods of the subclass.\n            while (current != null && !done) {\n                for (MethodInfo method : current.methods()) {\n                    if (method.name().equals(\"handleRequest\")) {\n\n\nIt does skip around the while loop a couple of times, though I though for readability I didn't want to add another condition to the while statement -> && !streamHandler\nI debated doing this, and decided against in the end to minimise changes.\n           while (current != null && !done &&!streamHandler) {\nI also though about doing it a more verbose way for readability and to be consistent on the place in the code where the decision is made:\n            boolean streamHandler = false;\n            while (current != null && !done) {\n                for (MethodInfo method : current.methods()) {\n\n                    if (current.superName().equals(SKILL_STREAM_HANDLER)) {\n                        streamHandler = true;\n                        done = true;\n                        break;\n                    }\n                    \n                    if (method.name().equals(\"handleRequest\")) {\n                        ...", "author": "oztimpower", "createdAt": "2020-03-21T04:15:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc4NzY4OA=="}], "type": "inlineReview"}]}