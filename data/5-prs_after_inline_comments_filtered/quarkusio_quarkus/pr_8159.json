{"pr_number": 8159, "pr_title": "Make list-extensions work even if it's executed in a directory that doesn't have pom.xml", "pr_createdAt": "2020-03-25T16:07:07Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/8159", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4OTY1OQ==", "url": "https://github.com/quarkusio/quarkus/pull/8159#discussion_r397989659", "bodyText": "Maybe log.debug just in case?", "author": "gastaldi", "createdAt": "2020-03-25T16:23:20Z", "path": "independent-projects/tools/common/src/main/java/io/quarkus/cli/commands/ListExtensionsCommandHandler.java", "diffHunk": "@@ -66,30 +66,41 @@ public QuarkusCommandOutcome execute(QuarkusCommandInvocation invocation) throws\n                     currentFormatter = this::conciseFormatter;\n             }\n \n-            final BuildFile buildFile = invocation.getBuildFile();\n+            final BuildFile buildFile = getBuildFileSafe(invocation);\n             loadedExtensions.forEach(extension -> display(extension, installed, all, currentFormatter, buildFile));\n \n-            if (\"concise\".equalsIgnoreCase(format)) {\n+            if (buildFile != null) {\n+                if (\"concise\".equalsIgnoreCase(format)) {\n+                    if (buildFile instanceof GradleBuildFile) {\n+                        System.out.println(\"\\nTo get more information, append --format=full to your command line.\");\n+                    } else {\n+                        System.out\n+                                .println(\n+                                        \"\\nTo get more information, append -Dquarkus.extension.format=full to your command line.\");\n+                    }\n+                }\n+\n                 if (buildFile instanceof GradleBuildFile) {\n-                    System.out.println(\"\\nTo get more information, append --format=full to your command line.\");\n+                    System.out.println(\"\\nAdd an extension to your project by adding the dependency to your \" +\n+                            \"build.gradle or use `./gradlew addExtension --extensions=\\\"artifactId\\\"`\");\n                 } else {\n-                    System.out\n-                            .println(\"\\nTo get more information, append -Dquarkus.extension.format=full to your command line.\");\n+                    System.out.println(\"\\nAdd an extension to your project by adding the dependency to your \" +\n+                            \"pom.xml or use `./mvnw quarkus:add-extension -Dextensions=\\\"artifactId\\\"`\");\n                 }\n             }\n-\n-            if (buildFile instanceof GradleBuildFile) {\n-                System.out.println(\"\\nAdd an extension to your project by adding the dependency to your \" +\n-                        \"build.gradle or use `./gradlew addExtension --extensions=\\\"artifactId\\\"`\");\n-            } else {\n-                System.out.println(\"\\nAdd an extension to your project by adding the dependency to your \" +\n-                        \"pom.xml or use `./mvnw quarkus:add-extension -Dextensions=\\\"artifactId\\\"`\");\n-            }\n         }\n \n         return QuarkusCommandOutcome.success();\n     }\n \n+    private BuildFile getBuildFileSafe(QuarkusCommandInvocation invocation) {\n+        try {\n+            return invocation.getBuildFile();\n+        } catch (Exception e) {\n+            return null;", "originalCommit": "4281f0e044defd951da9cc292c90186520e52621", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAwMTEwMQ==", "url": "https://github.com/quarkusio/quarkus/pull/8159#discussion_r398001101", "bodyText": "Done", "author": "geoand", "createdAt": "2020-03-25T16:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4OTY1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4ODM3NA==", "url": "https://github.com/quarkusio/quarkus/pull/8159#discussion_r397988374", "bodyText": "Can it be on 2 lines with nicer formatting?", "author": "rsvoboda", "createdAt": "2020-03-25T16:21:38Z", "path": "independent-projects/tools/common/src/main/java/io/quarkus/cli/commands/ListExtensionsCommandHandler.java", "diffHunk": "@@ -66,30 +66,41 @@ public QuarkusCommandOutcome execute(QuarkusCommandInvocation invocation) throws\n                     currentFormatter = this::conciseFormatter;\n             }\n \n-            final BuildFile buildFile = invocation.getBuildFile();\n+            final BuildFile buildFile = getBuildFileSafe(invocation);\n             loadedExtensions.forEach(extension -> display(extension, installed, all, currentFormatter, buildFile));\n \n-            if (\"concise\".equalsIgnoreCase(format)) {\n+            if (buildFile != null) {\n+                if (\"concise\".equalsIgnoreCase(format)) {\n+                    if (buildFile instanceof GradleBuildFile) {\n+                        System.out.println(\"\\nTo get more information, append --format=full to your command line.\");\n+                    } else {\n+                        System.out", "originalCommit": "4281f0e044defd951da9cc292c90186520e52621", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAwMTMzMQ==", "url": "https://github.com/quarkusio/quarkus/pull/8159#discussion_r398001331", "bodyText": "Like this?", "author": "geoand", "createdAt": "2020-03-25T16:38:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4ODM3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE0ODYxMA==", "url": "https://github.com/quarkusio/quarkus/pull/8159#discussion_r398148610", "bodyText": "\ud83d\udc4d", "author": "rsvoboda", "createdAt": "2020-03-25T20:29:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4ODM3NA=="}], "type": "inlineReview"}, {"oid": "a81b1753e34230c7f96f4f47c5616b58d922af77", "url": "https://github.com/quarkusio/quarkus/commit/a81b1753e34230c7f96f4f47c5616b58d922af77", "message": "Make list-extensions work even if it's executed in a directory that doesn't have pom.xml\n\nFixes: #8157", "committedDate": "2020-03-25T16:38:19Z", "type": "commit"}, {"oid": "a81b1753e34230c7f96f4f47c5616b58d922af77", "url": "https://github.com/quarkusio/quarkus/commit/a81b1753e34230c7f96f4f47c5616b58d922af77", "message": "Make list-extensions work even if it's executed in a directory that doesn't have pom.xml\n\nFixes: #8157", "committedDate": "2020-03-25T16:38:19Z", "type": "forcePushed"}]}