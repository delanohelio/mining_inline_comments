{"pr_number": 13977, "pr_title": "Reactive Connection Pools: always use TLOCAL, HealthCheck refactoring", "pr_createdAt": "2020-12-18T22:19:57Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/13977", "timeline": [{"oid": "12d31adb0586132bc3990c689b6f9d7dcd00052d", "url": "https://github.com/quarkusio/quarkus/commit/12d31adb0586132bc3990c689b6f9d7dcd00052d", "message": "Refactor the Reactive Datasource Healthcheck implementations", "committedDate": "2020-12-19T09:59:23Z", "type": "forcePushed"}, {"oid": "f7ada06013e1c6d85eb9c3ce2e8cd86a9c94cd0f", "url": "https://github.com/quarkusio/quarkus/commit/f7ada06013e1c6d85eb9c3ce2e8cd86a9c94cd0f", "message": "Simplify possible states of Reactive ThreadLocalPool", "committedDate": "2020-12-21T15:52:16Z", "type": "forcePushed"}, {"oid": "93d29191b9ce39f7405de8ac87fd2a7321eddfe6", "url": "https://github.com/quarkusio/quarkus/commit/93d29191b9ce39f7405de8ac87fd2a7321eddfe6", "message": "Always use a Thread-local scoped Reactive SQL Pool", "committedDate": "2020-12-22T13:41:12Z", "type": "commit"}, {"oid": "fecf636d4d158c691436b947d888491b5a2e9969", "url": "https://github.com/quarkusio/quarkus/commit/fecf636d4d158c691436b947d888491b5a2e9969", "message": "Refactor the Reactive Datasource Healthcheck implementations", "committedDate": "2020-12-22T13:41:12Z", "type": "commit"}, {"oid": "5ba7d9811aa00cd197d93437ae3aec2184186c61", "url": "https://github.com/quarkusio/quarkus/commit/5ba7d9811aa00cd197d93437ae3aec2184186c61", "message": "Simplify possible states of Reactive ThreadLocalPool", "committedDate": "2020-12-22T13:41:12Z", "type": "commit"}, {"oid": "d7f3362e99ce9c8d6d5ddf610d1cb567dd4cb26f", "url": "https://github.com/quarkusio/quarkus/commit/d7f3362e99ce9c8d6d5ddf610d1cb567dd4cb26f", "message": "Run the health check in a Vert.x context if found", "committedDate": "2020-12-22T13:41:22Z", "type": "commit"}, {"oid": "17d1ca164858c82af000d38664ec31635128433d", "url": "https://github.com/quarkusio/quarkus/commit/17d1ca164858c82af000d38664ec31635128433d", "message": "Improve warnings on lack of Vert.x context", "committedDate": "2020-12-22T13:41:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI5MzY0OQ==", "url": "https://github.com/quarkusio/quarkus/pull/13977#discussion_r547293649", "bodyText": "This is unlikely to work correctly.\n\nAre you sure about this? I think it should be possible to run this without a context. Not sure why we had that issue only for MySQL and only on CI.", "author": "DavideD", "createdAt": "2020-12-22T14:00:58Z", "path": "extensions/reactive-datasource/runtime/src/main/java/io/quarkus/reactive/datasource/runtime/ReactiveDatasourceHealthCheck.java", "diffHunk": "@@ -64,7 +64,7 @@ public HealthCheckResponse call() {\n                                 });\n                     });\n                 } else {\n-                    log.debug(\"Vert.x context not found for health check\");\n+                    log.warn(\"Vert.x context unavailable to perform healthcheck of reactive datasource `\" + dataSourceName + \"`. This is unlikely to work correctly.\");", "originalCommit": "17d1ca164858c82af000d38664ec31635128433d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI5Njc2Ng==", "url": "https://github.com/quarkusio/quarkus/pull/13977#discussion_r547296766", "bodyText": "You'll have the previous behaviour, which seems to timeout frequently. I'll keep the warning for now, as running w/o a Vert.x context seems tricky for other reasons as well.", "author": "Sanne", "createdAt": "2020-12-22T14:07:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI5MzY0OQ=="}], "type": "inlineReview"}, {"oid": "6b33c181ab6354c2ed185e08e3506a490b0a3d98", "url": "https://github.com/quarkusio/quarkus/commit/6b33c181ab6354c2ed185e08e3506a490b0a3d98", "message": "Improve warnings on lack of Vert.x context", "committedDate": "2020-12-22T14:14:22Z", "type": "commit"}, {"oid": "6b33c181ab6354c2ed185e08e3506a490b0a3d98", "url": "https://github.com/quarkusio/quarkus/commit/6b33c181ab6354c2ed185e08e3506a490b0a3d98", "message": "Improve warnings on lack of Vert.x context", "committedDate": "2020-12-22T14:14:22Z", "type": "forcePushed"}]}