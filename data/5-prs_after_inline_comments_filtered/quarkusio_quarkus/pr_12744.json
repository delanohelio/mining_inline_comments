{"pr_number": 12744, "pr_title": "Export Micrometer metrics to Signalfx", "pr_createdAt": "2020-10-15T16:25:03Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12744", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc2NjIwMA==", "url": "https://github.com/quarkusio/quarkus/pull/12744#discussion_r505766200", "bodyText": "Should the config be captured in a boolean or just used directly?", "author": "kenfinnigan", "createdAt": "2020-10-15T18:48:38Z", "path": "extensions/micrometer/deployment/src/main/java/io/quarkus/micrometer/deployment/export/SignalFxRegistryProcessor.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package io.quarkus.micrometer.deployment.export;\n+\n+import java.util.function.BooleanSupplier;\n+\n+import org.jboss.logging.Logger;\n+\n+import io.quarkus.arc.deployment.AdditionalBeanBuildItem;\n+import io.quarkus.deployment.annotations.BuildProducer;\n+import io.quarkus.deployment.annotations.BuildStep;\n+import io.quarkus.micrometer.deployment.MicrometerRegistryProviderBuildItem;\n+import io.quarkus.micrometer.runtime.MicrometerRecorder;\n+import io.quarkus.micrometer.runtime.config.MicrometerConfig;\n+import io.quarkus.micrometer.runtime.export.SignalFxMeterRegistryProvider;\n+\n+/**\n+ * Add support for the SignalFx Meter Registry. Note that the registry may not\n+ * be available at deployment time for some projects: Avoid direct class\n+ * references.\n+ */\n+public class SignalFxRegistryProcessor {\n+    private static final Logger log = Logger.getLogger(SignalFxRegistryProcessor.class);\n+\n+    static final String REGISTRY_CLASS_NAME = \"io.micrometer.signalfx.SignalFxMeterRegistry\";\n+    static final Class<?> REGISTRY_CLASS = MicrometerRecorder.getClassForName(REGISTRY_CLASS_NAME);\n+\n+    public static class SignalFxRegistryEnabled implements BooleanSupplier {\n+        MicrometerConfig mConfig;\n+\n+        @Override\n+        public boolean getAsBoolean() {\n+            boolean test = mConfig.checkRegistryEnabledWithDefault(mConfig.export.signalfx);\n+            return REGISTRY_CLASS != null && mConfig.checkRegistryEnabledWithDefault(mConfig.export.signalfx);", "originalCommit": "435fcbd17e39128b9c2ae7404c8bf3eda151f59e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3OTg2Nw==", "url": "https://github.com/quarkusio/quarkus/pull/12744#discussion_r505779867", "bodyText": "woops!! good catch!\nthat was a debug.. because I'd done something else stupid. Thanks!", "author": "ebullient", "createdAt": "2020-10-15T19:13:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc2NjIwMA=="}], "type": "inlineReview"}, {"oid": "b3ab82a935999eeca96a013fc0c2f348fa882410", "url": "https://github.com/quarkusio/quarkus/commit/b3ab82a935999eeca96a013fc0c2f348fa882410", "message": "Refactor config validation", "committedDate": "2020-10-15T19:08:04Z", "type": "commit"}, {"oid": "14187ff06dfeba6ead722a4cc305488879431260", "url": "https://github.com/quarkusio/quarkus/commit/14187ff06dfeba6ead722a4cc305488879431260", "message": "Add SignalFx support", "committedDate": "2020-10-15T19:08:04Z", "type": "forcePushed"}, {"oid": "3eb921dc0107eff6ee8b8bc2c2814a6505e1f5ba", "url": "https://github.com/quarkusio/quarkus/commit/3eb921dc0107eff6ee8b8bc2c2814a6505e1f5ba", "message": "Add SignalFx support", "committedDate": "2020-10-15T19:15:10Z", "type": "forcePushed"}, {"oid": "9ba0efb223c9beb44ce5189b020c9054cb7f033a", "url": "https://github.com/quarkusio/quarkus/commit/9ba0efb223c9beb44ce5189b020c9054cb7f033a", "message": "Add SignalFx support", "committedDate": "2020-10-15T19:28:42Z", "type": "commit"}, {"oid": "9ba0efb223c9beb44ce5189b020c9054cb7f033a", "url": "https://github.com/quarkusio/quarkus/commit/9ba0efb223c9beb44ce5189b020c9054cb7f033a", "message": "Add SignalFx support", "committedDate": "2020-10-15T19:28:42Z", "type": "forcePushed"}, {"oid": "7aad0ce3f16f5a386cd331d9b70877afda9e5a8c", "url": "https://github.com/quarkusio/quarkus/commit/7aad0ce3f16f5a386cd331d9b70877afda9e5a8c", "message": "Verify Log messages; clean up UT", "committedDate": "2020-10-15T21:36:20Z", "type": "commit"}]}