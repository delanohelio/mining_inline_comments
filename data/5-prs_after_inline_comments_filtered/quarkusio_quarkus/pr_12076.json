{"pr_number": 12076, "pr_title": "AdditionalBeanBuildItem - clarify javadoc and improve the transformer", "pr_createdAt": "2020-09-14T13:29:23Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12076", "timeline": [{"oid": "baa108673a0500bce5e8de6eda264dc824008d90", "url": "https://github.com/quarkusio/quarkus/commit/baa108673a0500bce5e8de6eda264dc824008d90", "message": "AdditionalBeanBuildItem - clarify javadoc and improve the transformer\n\n- clarify javadoc in the AdditionalBean annotation\n- also deprecate BeanArchiveIndexBuildItem#getAdditionalBeans()", "committedDate": "2020-09-14T13:28:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkyMDAwNA==", "url": "https://github.com/quarkusio/quarkus/pull/12076#discussion_r487920004", "bodyText": "Nice!", "author": "geoand", "createdAt": "2020-09-14T13:36:27Z", "path": "extensions/arc/deployment/src/main/java/io/quarkus/arc/deployment/ArcProcessor.java", "diffHunk": "@@ -153,7 +153,21 @@ public ContextRegistrationPhaseBuildItem initialize(\n                     \" Please use one of \" + ArcConfig.ALLOWED_REMOVE_UNUSED_BEANS_VALUES);\n         }\n \n-        List<String> additionalBeansTypes = beanArchiveIndex.getAdditionalBeans();\n+        // bean type -> default scope (may be null)\n+        Map<String, DotName> additionalBeanTypes = new HashMap<>();\n+        for (AdditionalBeanBuildItem additionalBean : additionalBeans) {\n+            DotName defaultScope = additionalBean.getDefaultScope();\n+            for (String beanClass : additionalBean.getBeanClasses()) {\n+                DotName existingDefaultScope = additionalBeanTypes.get(beanClass);\n+                if (existingDefaultScope != null && defaultScope != null && !existingDefaultScope.equals(defaultScope)) {\n+                    throw new IllegalStateException(\"Different default scopes defined for additional bean class: \" + beanClass", "originalCommit": "baa108673a0500bce5e8de6eda264dc824008d90", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}