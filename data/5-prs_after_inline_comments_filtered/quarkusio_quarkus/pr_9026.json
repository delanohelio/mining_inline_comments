{"pr_number": 9026, "pr_title": "Get rid of volatile configuration fields for Scheduler", "pr_createdAt": "2020-05-02T13:59:00Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9026", "timeline": [{"oid": "8ed1191a333e457b8b5b338d9ec427d36e4415a1", "url": "https://github.com/quarkusio/quarkus/commit/8ed1191a333e457b8b5b338d9ec427d36e4415a1", "message": "Get rid of volatile configuration fields for Scheduler", "committedDate": "2020-05-02T13:59:37Z", "type": "forcePushed"}, {"oid": "c91407f42d10888c50762e296d870a6ab6f35d8c", "url": "https://github.com/quarkusio/quarkus/commit/c91407f42d10888c50762e296d870a6ab6f35d8c", "message": "Get rid of volatile configuration fields for Scheduler", "committedDate": "2020-05-02T14:08:39Z", "type": "forcePushed"}, {"oid": "b98ea413286fa247ace36aa56bbfa49671903f74", "url": "https://github.com/quarkusio/quarkus/commit/b98ea413286fa247ace36aa56bbfa49671903f74", "message": "Get rid of volatile configuration fields for Scheduler", "committedDate": "2020-05-02T15:33:58Z", "type": "forcePushed"}, {"oid": "f706c14054b7802e019e26a7e89b2e2cecdcc545", "url": "https://github.com/quarkusio/quarkus/commit/f706c14054b7802e019e26a7e89b2e2cecdcc545", "message": "Get rid of volatile configuration fields for Scheduler", "committedDate": "2020-05-02T21:53:56Z", "type": "forcePushed"}, {"oid": "bb58035bfb3184c60c04875586bb5425ca837cd1", "url": "https://github.com/quarkusio/quarkus/commit/bb58035bfb3184c60c04875586bb5425ca837cd1", "message": "Get rid of volatile configuration fields for Scheduler", "committedDate": "2020-05-03T08:27:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTEwNTAyMw==", "url": "https://github.com/quarkusio/quarkus/pull/9026#discussion_r419105023", "bodyText": "Can be moved to where the initialisation occurs? https://github.com/quarkusio/quarkus/pull/9026/files#diff-f3233ae68279acfe2869eaffaeb10682R76", "author": "machi1990", "createdAt": "2020-05-03T13:37:44Z", "path": "extensions/quartz/runtime/src/main/java/io/quarkus/quartz/runtime/QuartzScheduler.java", "diffHunk": "@@ -68,13 +67,13 @@\n     }\n \n     public QuartzScheduler(SchedulerContext context, QuartzSupport quartzSupport, Config config) {\n+        Map<String, ScheduledInvoker> invokers;", "originalCommit": "bb58035bfb3184c60c04875586bb5425ca837cd1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTEwNTk3Ng==", "url": "https://github.com/quarkusio/quarkus/pull/9026#discussion_r419105976", "bodyText": "Good idea, done", "author": "geoand", "createdAt": "2020-05-03T13:45:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTEwNTAyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTEwNTEyOQ==", "url": "https://github.com/quarkusio/quarkus/pull/9026#discussion_r419105129", "bodyText": "Ah did not know we have this. Thanks :)", "author": "machi1990", "createdAt": "2020-05-03T13:38:42Z", "path": "extensions/quartz/deployment/src/main/java/io/quarkus/quartz/deployment/QuartzProcessor.java", "diffHunk": "@@ -168,13 +170,22 @@ private String guessDriver(Optional<JdbcDataSourceBuildItem> jdbcDataSource) {\n     }\n \n     @BuildStep\n-    @Record(RUNTIME_INIT)\n-    public void build(QuartzRuntimeConfig runtimeConfig, QuartzBuildTimeConfig buildTimeConfig, QuartzRecorder recorder,\n-            BeanContainerBuildItem beanContainer,\n-            BuildProducer<ServiceStartBuildItem> serviceStart, QuartzJDBCDriverDialectBuildItem driverDialect,\n-            List<JdbcDataSourceSchemaReadyBuildItem> schemaReadyBuildItem) {\n-        recorder.initialize(runtimeConfig, buildTimeConfig, beanContainer.getValue(), driverDialect.getDriver());\n+    public void start(BuildProducer<ServiceStartBuildItem> serviceStart,\n+            @SuppressWarnings(\"unused\") List<JdbcDataSourceSchemaReadyBuildItem> schemaReadyBuildItem) {\n         // Make sure that StartupEvent is fired after the init\n         serviceStart.produce(new ServiceStartBuildItem(\"quartz\"));\n     }\n+\n+    @BuildStep\n+    @Record(RUNTIME_INIT)\n+    public void quartzSupportBean(QuartzRuntimeConfig runtimeConfig, QuartzBuildTimeConfig buildTimeConfig,\n+            QuartzRecorder recorder,\n+            BuildProducer<SyntheticBeanBuildItem> syntheticBeanBuildItemBuildProducer,\n+            QuartzJDBCDriverDialectBuildItem driverDialect) {\n+\n+        syntheticBeanBuildItemBuildProducer.produce(SyntheticBeanBuildItem.configure(QuartzSupport.class)", "originalCommit": "bb58035bfb3184c60c04875586bb5425ca837cd1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTEwNjEwNA==", "url": "https://github.com/quarkusio/quarkus/pull/9026#discussion_r419106104", "bodyText": "Yeah. @mkouba has improved the experience of \"creating\" beans at \"build time\".", "author": "geoand", "createdAt": "2020-05-03T13:46:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTEwNTEyOQ=="}], "type": "inlineReview"}, {"oid": "3eb5ec215873da743979f0f615d2d35905d1eeb0", "url": "https://github.com/quarkusio/quarkus/commit/3eb5ec215873da743979f0f615d2d35905d1eeb0", "message": "Get rid of volatile configuration fields for Scheduler", "committedDate": "2020-05-03T13:45:32Z", "type": "commit"}, {"oid": "3eb5ec215873da743979f0f615d2d35905d1eeb0", "url": "https://github.com/quarkusio/quarkus/commit/3eb5ec215873da743979f0f615d2d35905d1eeb0", "message": "Get rid of volatile configuration fields for Scheduler", "committedDate": "2020-05-03T13:45:32Z", "type": "forcePushed"}]}