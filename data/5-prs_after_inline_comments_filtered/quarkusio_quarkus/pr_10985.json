{"pr_number": 10985, "pr_title": "SmallRye CP - replace ManagedExecutor producer with synthetic bean", "pr_createdAt": "2020-07-27T11:16:45Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10985", "timeline": [{"oid": "26f1fda51a37c5215f779fbe4a9c76eb0cccde03", "url": "https://github.com/quarkusio/quarkus/commit/26f1fda51a37c5215f779fbe4a9c76eb0cccde03", "message": "SmallRye CP - replace ManagedExecutor producer with synthetic bean\n\n- deprecate ManagedExecutorInitializedBuildItem\n- resolves #10963", "committedDate": "2020-07-27T11:14:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg1MjQyMA==", "url": "https://github.com/quarkusio/quarkus/pull/10985#discussion_r460852420", "bodyText": "What's the rationale for this change? (asking as I would like to understand)", "author": "gsmet", "createdAt": "2020-07-27T12:25:38Z", "path": "extensions/smallrye-context-propagation/runtime/src/main/java/io/quarkus/smallrye/context/runtime/SmallRyeContextPropagationProvider.java", "diffHunk": "@@ -1,53 +1,21 @@\n package io.quarkus.smallrye.context.runtime;\n \n-import java.util.List;\n-import java.util.concurrent.ExecutorService;\n-\n-import javax.enterprise.context.ApplicationScoped;\n+import javax.enterprise.context.Dependent;\n import javax.enterprise.inject.Produces;\n-import javax.enterprise.inject.Typed;\n import javax.inject.Singleton;\n \n-import org.eclipse.microprofile.context.ManagedExecutor;\n import org.eclipse.microprofile.context.ThreadContext;\n \n import io.quarkus.arc.DefaultBean;\n-import io.smallrye.context.SmallRyeManagedExecutor;\n-import io.smallrye.context.SmallRyeThreadContext;\n \n-@ApplicationScoped\n+@Dependent", "originalCommit": "26f1fda51a37c5215f779fbe4a9c76eb0cccde03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg3Nzk2MQ==", "url": "https://github.com/quarkusio/quarkus/pull/10985#discussion_r460877961", "bodyText": "The producer is @Singleton, i.e. will only be called once and the result is stored in the singleton context. Therefore, there is no need to keep the SmallRyeContextPropagationProvider instance around. Not to mention the generated client proxy class.", "author": "mkouba", "createdAt": "2020-07-27T13:10:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg1MjQyMA=="}], "type": "inlineReview"}]}