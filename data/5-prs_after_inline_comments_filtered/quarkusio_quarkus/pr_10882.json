{"pr_number": 10882, "pr_title": "Enabling dev mode for jandex plugin", "pr_createdAt": "2020-07-21T10:21:42Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10882", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI2NzE4OQ==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r459267189", "bodyText": "I assume this change along with the one AppModelGradleResolver have been vetted by @aloubyansky ?", "author": "geoand", "createdAt": "2020-07-23T07:40:53Z", "path": "core/deployment/src/main/java/io/quarkus/deployment/index/ApplicationArchiveBuildStep.java", "diffHunk": "@@ -247,18 +247,6 @@ private static boolean containsMarker(Path dir, Set<String> applicationArchiveFi\n     }\n \n     private static Index handleFilePath(Path path) throws IOException {", "originalCommit": "72f56a3cae1e8650e9ba13939a26e26bf8732e24", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMxODkxNA==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r459318914", "bodyText": "Yes, he was guiding me throughout this so most probably", "author": "Garima829", "createdAt": "2020-07-23T09:19:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI2NzE4OQ=="}], "type": "inlineReview"}, {"oid": "8ae405c1539c27a0e794dfeb9a9a595a21153ef2", "url": "https://github.com/quarkusio/quarkus/commit/8ae405c1539c27a0e794dfeb9a9a595a21153ef2", "message": "Enabling dev mode for jandex plugin", "committedDate": "2020-07-23T09:33:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTM2ODMxOA==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r459368318", "bodyText": "\"jandex\" should not be replacing \"processResources\" here. There should be an additional if block for \"jandex\".", "author": "aloubyansky", "createdAt": "2020-07-23T10:57:34Z", "path": "devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java", "diffHunk": "@@ -249,7 +249,7 @@ private void setupQuarkusBuildTaskDeps(Project project, Project dep, Set<String>\n \n         final Task quarkusDev = project.getTasks().findByName(QUARKUS_DEV_TASK_NAME);\n         if (quarkusDev != null) {\n-            final Task resourcesTask = dep.getTasks().findByName(JavaPlugin.PROCESS_RESOURCES_TASK_NAME);\n+            final Task resourcesTask = dep.getTasks().findByName(\"jandex\");", "originalCommit": "8ae405c1539c27a0e794dfeb9a9a595a21153ef2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTM4MDAxNQ==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r459380015", "bodyText": "Okk", "author": "Garima829", "createdAt": "2020-07-23T11:23:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTM2ODMxOA=="}], "type": "inlineReview"}, {"oid": "e99396eb1e45e40d7ed6530611f11dd817e66301", "url": "https://github.com/quarkusio/quarkus/commit/e99396eb1e45e40d7ed6530611f11dd817e66301", "message": "Enabling dev mode for Jandex plugin", "committedDate": "2020-07-23T18:23:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA5NDIzNg==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r460094236", "bodyText": "This one is checking the content of the index.html. Which you can remove given that you removed the index.xml.", "author": "aloubyansky", "createdAt": "2020-07-24T14:38:17Z", "path": "integration-tests/gradle/src/test/java/io/quarkus/gradle/devmode/JandexMultiModuleProjectDevModeTest.java", "diffHunk": "@@ -0,0 +1,34 @@\n+package io.quarkus.gradle.devmode;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import com.google.common.collect.ImmutableMap;\n+\n+public class JandexMultiModuleProjectDevModeTest extends QuarkusDevGradleTestBase {\n+\n+    @Override\n+    protected String projectDirectoryName() {\n+        return \"jandex-basic-multi-module-project\";\n+    }\n+\n+    @Override\n+    protected String[] buildArguments() {\n+        return new String[] { \"clean\", \":application:quarkusDev\", \"-s\" };\n+    }\n+\n+    protected void testDevMode() throws Exception {\n+\n+        assertThat(getHttpResponse())\n+                .contains(\"ready\")\n+                .contains(\"my-quarkus-project\")\n+                .contains(\"org.acme.quarkus.sample\")\n+                .contains(\"1.0-SNAPSHOT\");", "originalCommit": "e99396eb1e45e40d7ed6530611f11dd817e66301", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDEwMTQ1Mw==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r460101453", "bodyText": "Will remove it", "author": "Garima829", "createdAt": "2020-07-24T14:49:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA5NDIzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDEwNjg2OQ==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r460106869", "bodyText": "The idea behind removing this assert statement is to straightaway check for the /hello endpoint right ?", "author": "Garima829", "createdAt": "2020-07-24T14:58:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA5NDIzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDEwOTQyOA==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r460109428", "bodyText": "The idea is that the application no longer serves the index.html and it suffices to just check /hello - checking the contents of index.html doesn't provide anything useful to this test", "author": "geoand", "createdAt": "2020-07-24T15:02:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA5NDIzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDExMTY1Ng==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r460111656", "bodyText": "Okk", "author": "Garima829", "createdAt": "2020-07-24T15:05:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA5NDIzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE3MDczOQ==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r460170739", "bodyText": "This change should now move to https://github.com/quarkusio/quarkus/blob/master/devtools/gradle/src/main/java/io/quarkus/gradle/builder/QuarkusModelBuilder.java#L285", "author": "aloubyansky", "createdAt": "2020-07-24T16:49:02Z", "path": "devtools/gradle/src/main/java/io/quarkus/gradle/AppModelGradleResolver.java", "diffHunk": "@@ -273,6 +273,13 @@ private void collectDependencies(Configuration config, AppModel.Builder appBuild\n                             paths.add(resourcesDir.toPath());\n                         }\n                     }\n+\n+                    for (File outputDir : depProject.getTasks().findByName(JavaPlugin.PROCESS_RESOURCES_TASK_NAME)\n+                            .getOutputs().getFiles()) {\n+                        if (outputDir.exists()) {\n+                            paths.add(outputDir.toPath());\n+                        }\n+                    }", "originalCommit": "e99396eb1e45e40d7ed6530611f11dd817e66301", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1NTY0MA==", "url": "https://github.com/quarkusio/quarkus/pull/10882#discussion_r460355640", "bodyText": "Okk", "author": "Garima829", "createdAt": "2020-07-25T02:57:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE3MDczOQ=="}], "type": "inlineReview"}, {"oid": "6d13e1c1f442cb5a1a04a59d09c932f2f5bc3e93", "url": "https://github.com/quarkusio/quarkus/commit/6d13e1c1f442cb5a1a04a59d09c932f2f5bc3e93", "message": "Enabling dev mode for Jandex plugin, rebased PR", "committedDate": "2020-07-25T09:01:54Z", "type": "commit"}, {"oid": "6d13e1c1f442cb5a1a04a59d09c932f2f5bc3e93", "url": "https://github.com/quarkusio/quarkus/commit/6d13e1c1f442cb5a1a04a59d09c932f2f5bc3e93", "message": "Enabling dev mode for Jandex plugin, rebased PR", "committedDate": "2020-07-25T09:01:54Z", "type": "forcePushed"}]}