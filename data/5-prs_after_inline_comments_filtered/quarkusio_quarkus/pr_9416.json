{"pr_number": 9416, "pr_title": "Devmode: filter out modules that aren't application compile or runtime dependencies", "pr_createdAt": "2020-05-18T14:39:33Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9416", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NzkyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/9416#discussion_r426967921", "bodyText": "Are classifiers relevant here?", "author": "stuartwdouglas", "createdAt": "2020-05-19T00:48:08Z", "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -832,11 +832,16 @@ public void stop() throws InterruptedException {\n         for (LocalProject project : localProject.getSelfWithLocalDeps()) {\n             inProject.add(project.getKey());\n             if (project.getClassesDir() != null &&\n-            //if this project also contains Quarkus extensions we do no want to include these in the discovery\n-            //a bit of an edge case, but if you try and include a sample project with your extension you will\n-            //run into problems without this\n-                    (Files.exists(project.getClassesDir().resolve(\"META-INF/quarkus-extension.properties\")) ||\n-                            Files.exists(project.getClassesDir().resolve(\"META-INF/quarkus-build-steps.list\")))) {\n+                    (\n+                    // if it is not found among project.getArtifacts() it shouldn't be included (e.g. a local test dependency)\n+                    localProject != project", "originalCommit": "596a418aa0448751654fd0a2cd7bea41bea2419b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAyMjI1Mw==", "url": "https://github.com/quarkusio/quarkus/pull/9416#discussion_r427022253", "bodyText": "It's interesting, I thought they should be checked too. But I couldn't get test scope deps into it. I guess it's related to the phase the dev mode is running in.\nJavadoc says the content of project.getArtifacts() will depend on the phase and which dependencies have been resolved, iiuc. I tried mvn clean test quarkus:dev. That would actually run tests before the devmode. But the test dependencies still wouldn't be found in project.getArtifactMap()", "author": "aloubyansky", "createdAt": "2020-05-19T04:24:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NzkyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAyNTA2OQ==", "url": "https://github.com/quarkusio/quarkus/pull/9416#discussion_r427025069", "bodyText": "Actually, it's a good opportunity to check the type of the dependency. Sometimes people add dependencies on POMs, just for the transitive dependencies. I'll add that here and the check for the scope anyway.", "author": "aloubyansky", "createdAt": "2020-05-19T04:37:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NzkyMQ=="}], "type": "inlineReview"}, {"oid": "ec41e7aeb90e2f06de692a44020432013a3a1bee", "url": "https://github.com/quarkusio/quarkus/commit/ec41e7aeb90e2f06de692a44020432013a3a1bee", "message": "Devmode: filter out modules that aren't application's compile or runtime dependencies", "committedDate": "2020-05-19T08:04:13Z", "type": "forcePushed"}, {"oid": "47c8157bb80375cfbdde29a353a4ad25bead8d10", "url": "https://github.com/quarkusio/quarkus/commit/47c8157bb80375cfbdde29a353a4ad25bead8d10", "message": "Devmode: filter out modules that aren't application's compile or runtime dependencies", "committedDate": "2020-05-19T11:58:48Z", "type": "forcePushed"}, {"oid": "78805b9d1129efb40eb418596b937b6ce3817671", "url": "https://github.com/quarkusio/quarkus/commit/78805b9d1129efb40eb418596b937b6ce3817671", "message": "Devmode: filter out modules that aren't application's compile or runtime dependencies", "committedDate": "2020-05-19T12:49:40Z", "type": "forcePushed"}, {"oid": "a7a00654822bd66fbac6d90f3c1ec301142c35c1", "url": "https://github.com/quarkusio/quarkus/commit/a7a00654822bd66fbac6d90f3c1ec301142c35c1", "message": "Devmode: filter out modules that aren't application's compile or runtime dependencies", "committedDate": "2020-05-19T17:17:21Z", "type": "forcePushed"}, {"oid": "f043971c7dac8b98c244d9a028693229844f78c0", "url": "https://github.com/quarkusio/quarkus/commit/f043971c7dac8b98c244d9a028693229844f78c0", "message": "Devmode: filter out modules that aren't application's compile or runtime dependencies", "committedDate": "2020-05-20T07:02:16Z", "type": "commit"}, {"oid": "f043971c7dac8b98c244d9a028693229844f78c0", "url": "https://github.com/quarkusio/quarkus/commit/f043971c7dac8b98c244d9a028693229844f78c0", "message": "Devmode: filter out modules that aren't application's compile or runtime dependencies", "committedDate": "2020-05-20T07:02:16Z", "type": "forcePushed"}]}