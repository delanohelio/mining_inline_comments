{"pr_number": 13296, "pr_title": "Introduce cache injection and NoOpCache", "pr_createdAt": "2020-11-14T20:53:12Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/13296", "timeline": [{"oid": "eef343940080c408ae015fc887f7901d396f6f5b", "url": "https://github.com/quarkusio/quarkus/commit/eef343940080c408ae015fc887f7901d396f6f5b", "message": "Introduce cache injection and NoOpCache", "committedDate": "2020-11-14T21:28:31Z", "type": "forcePushed"}, {"oid": "97755312c16e510fcdce953f31c062967c7ce87a", "url": "https://github.com/quarkusio/quarkus/commit/97755312c16e510fcdce953f31c062967c7ce87a", "message": "Introduce cache injection and NoOpCache", "committedDate": "2020-11-23T22:03:52Z", "type": "forcePushed"}, {"oid": "35212e59210903193fdcdfd2b175c9e4d6977d08", "url": "https://github.com/quarkusio/quarkus/commit/35212e59210903193fdcdfd2b175c9e4d6977d08", "message": "Introduce cache injection and NoOpCache", "committedDate": "2020-11-25T20:00:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTE1NzI1Ng==", "url": "https://github.com/quarkusio/quarkus/pull/13296#discussion_r531157256", "bodyText": "You allow it for methods here but you don't check the method case in the processor. Is it normal?", "author": "gsmet", "createdAt": "2020-11-26T17:17:05Z", "path": "extensions/cache/runtime/src/main/java/io/quarkus/cache/CacheName.java", "diffHunk": "@@ -0,0 +1,45 @@\n+package io.quarkus.cache;\n+\n+import static java.lang.annotation.ElementType.FIELD;\n+import static java.lang.annotation.ElementType.METHOD;\n+import static java.lang.annotation.ElementType.PARAMETER;\n+\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+import javax.enterprise.util.Nonbinding;\n+import javax.inject.Qualifier;\n+\n+/**\n+ * <p>\n+ * Use this annotation to inject a {@link Cache} and interact with it programmatically.\n+ * </p>\n+ * <p>\n+ * Code example:\n+ * \n+ * <pre>\n+ * {@literal @}ApplicationScoped\n+ * public class CachedService {\n+ * \n+ *     {@literal @}CacheName(\"my-cache\")\n+ *     Cache cache;\n+ *     \n+ *     // Interact with the cache.\n+ * }\n+ * </pre>\n+ * </p>\n+ * \n+ * @see CacheManager\n+ */\n+@Qualifier\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target({ FIELD, METHOD, PARAMETER })", "originalCommit": "35212e59210903193fdcdfd2b175c9e4d6977d08", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI5ODE1Mw==", "url": "https://github.com/quarkusio/quarkus/pull/13296#discussion_r540298153", "bodyText": "Good catch! It is allowed on methods because of CacheProducer but I should add a check in CacheProcessor to forbid the annotation on any other method than the one from the producer.", "author": "gwenneg", "createdAt": "2020-12-10T16:13:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTE1NzI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM5MDAxNg==", "url": "https://github.com/quarkusio/quarkus/pull/13296#discussion_r540390016", "bodyText": "I made the following changes:\n\nrebase on master to fix conflicts\nnew check in CacheProcessor: @CacheName is now only allowed on methods from io.quarkus.cache.runtime.CacheProducer\ninjection tests coverage improvement\n\nDespite the targets of @CacheName and the new check, it is possible to inject a cache using that annotation at all CDI usual injections points: fields, constructors parameters and methods parameters. These are all tested in this PR.", "author": "gwenneg", "createdAt": "2020-12-10T18:12:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTE1NzI1Ng=="}], "type": "inlineReview"}, {"oid": "b3b6e0f114dce6f92f83103ed3521a42ef17c9c4", "url": "https://github.com/quarkusio/quarkus/commit/b3b6e0f114dce6f92f83103ed3521a42ef17c9c4", "message": "Introduce cache injection and NoOpCache", "committedDate": "2020-12-10T18:07:48Z", "type": "forcePushed"}, {"oid": "33288856544881f3819eca74ba454ef2149bb1a7", "url": "https://github.com/quarkusio/quarkus/commit/33288856544881f3819eca74ba454ef2149bb1a7", "message": "Introduce cache injection and NoOpCache", "committedDate": "2020-12-11T00:02:05Z", "type": "forcePushed"}, {"oid": "ddd838252c0670dc2bfca48b0f91eb9d636d66e6", "url": "https://github.com/quarkusio/quarkus/commit/ddd838252c0670dc2bfca48b0f91eb9d636d66e6", "message": "Introduce cache injection and NoOpCache", "committedDate": "2020-12-11T08:30:19Z", "type": "commit"}, {"oid": "ddd838252c0670dc2bfca48b0f91eb9d636d66e6", "url": "https://github.com/quarkusio/quarkus/commit/ddd838252c0670dc2bfca48b0f91eb9d636d66e6", "message": "Introduce cache injection and NoOpCache", "committedDate": "2020-12-11T08:30:19Z", "type": "forcePushed"}]}