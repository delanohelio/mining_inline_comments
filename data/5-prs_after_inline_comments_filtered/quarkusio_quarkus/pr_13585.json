{"pr_number": 13585, "pr_title": "Fix generated project with wrong duplicated package name", "pr_createdAt": "2020-12-01T12:56:38Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/13585", "timeline": [{"oid": "a3afc23f1aa0de68557fa13f18ed371c973a00e4", "url": "https://github.com/quarkusio/quarkus/commit/a3afc23f1aa0de68557fa13f18ed371c973a00e4", "message": "Fix generated project with wrong duplicated package name\nCloses #13581", "committedDate": "2020-12-01T13:15:42Z", "type": "forcePushed"}, {"oid": "3ad46ba8516d2ee9a63605e4f1bc42dffc759911", "url": "https://github.com/quarkusio/quarkus/commit/3ad46ba8516d2ee9a63605e4f1bc42dffc759911", "message": "Fix generated project with wrong duplicated package name\nCloses #13581", "committedDate": "2020-12-02T10:43:08Z", "type": "forcePushed"}, {"oid": "8c36d2157084bf486b51e68c3e9a0accbdedf733", "url": "https://github.com/quarkusio/quarkus/commit/8c36d2157084bf486b51e68c3e9a0accbdedf733", "message": "Fix generated project with wrong duplicated package name\nCloses #13581", "committedDate": "2020-12-02T13:21:19Z", "type": "forcePushed"}, {"oid": "15035be44fa00839e77f6b60f44d220c4e5aa985", "url": "https://github.com/quarkusio/quarkus/commit/15035be44fa00839e77f6b60f44d220c4e5aa985", "message": "Fix generated project with wrong duplicated package name\nCloses #13581", "committedDate": "2020-12-02T13:28:03Z", "type": "commit"}, {"oid": "15035be44fa00839e77f6b60f44d220c4e5aa985", "url": "https://github.com/quarkusio/quarkus/commit/15035be44fa00839e77f6b60f44d220c4e5aa985", "message": "Fix generated project with wrong duplicated package name\nCloses #13581", "committedDate": "2020-12-02T13:28:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk2MDM0NA==", "url": "https://github.com/quarkusio/quarkus/pull/13585#discussion_r534960344", "bodyText": "Does this mean it's not a user's choice anymore?", "author": "aloubyansky", "createdAt": "2020-12-03T08:57:00Z", "path": "devtools/platform-descriptor-json/src/main/resources/codestarts/quarkus/core/examples/commandmode-example/java/src/main/java/org/acme/{main.class-name}.tpl.qute.java", "diffHunk": "@@ -1,4 +1,4 @@\n-package {package-name};\n+package org.acme;", "originalCommit": "15035be44fa00839e77f6b60f44d220c4e5aa985", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk3MTU4Nw==", "url": "https://github.com/quarkusio/quarkus/pull/13585#discussion_r534971587", "bodyText": "@aloubyansky nop it's still the user choice, just it's now handled the same way for all codestarts org.acme is replaced by the selected package name at gen time.", "author": "ia3andy", "createdAt": "2020-12-03T09:03:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk2MDM0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk3OTc4MQ==", "url": "https://github.com/quarkusio/quarkus/pull/13585#discussion_r534979781", "bodyText": "In that case why not keep the parameter with the default value org.acme?", "author": "aloubyansky", "createdAt": "2020-12-03T09:08:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk2MDM0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk4NjY1NA==", "url": "https://github.com/quarkusio/quarkus/pull/13585#discussion_r534986654", "bodyText": "@aloubyansky\nThose \"core\" examples (resteasy, springweb and commandmode) were a bit special and allowed change in the class name and package name.\nTo avoid unnecessary templating in most codestarts like this one:\nhttps://github.com/quarkusio/quarkus/blob/master/devtools/platform-descriptor-json/src/main/resources/codestarts/quarkus/examples/funqy-http-example/java/src/main/java/org/acme/funqy/Funqy.java\nWe decided to make it a convention to use org.acme and auto replace it for all java/kotlin/scala files:\nhttps://github.com/quarkusio/quarkus/blob/master/independent-projects/tools/codestarts/src/main/java/io/quarkus/devtools/codestarts/core/strategy/SmartPackageFileStrategyHandler.java\nI kept that here thinking it was ok, but then if you use org.acme.something, it gets replaced twice leading to the actual bug :)\nreplace the {package-name} param: org.acme.something ->, then replace org.acme: [org.acme.something].something", "author": "ia3andy", "createdAt": "2020-12-03T09:16:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk2MDM0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk4OTg5Mg==", "url": "https://github.com/quarkusio/quarkus/pull/13585#discussion_r534989892", "bodyText": "dynamic package should not be done with {package-name} anymore, or else, we should either:\n\nmake a change so that we don't do the replace twice which is can of hard to know since we would have mixed approach\nmake sure the dynamic package doesn't contain org.acme.*\n\nbut I don't see the point since the current org.acme is consistent and you don't have to care about it..", "author": "ia3andy", "createdAt": "2020-12-03T09:21:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk2MDM0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTAxNDkzNQ==", "url": "https://github.com/quarkusio/quarkus/pull/13585#discussion_r535014935", "bodyText": "It looks like the package is generally modeled as {root-package}[.{extension-name}] It would be more intuitive if it was configured as a kind of expression.\nUsing a specific constant org.acme as the default and a placeholder is confusing and not practical in case one day you want to change the default value to something else.\nThat's just my opinion.", "author": "aloubyansky", "createdAt": "2020-12-03T09:40:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk2MDM0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTAzNzM4MQ==", "url": "https://github.com/quarkusio/quarkus/pull/13585#discussion_r535037381", "bodyText": "@aloubyansky  We could still easily change the default package (this is unrelated), it just means the codestart template would keep org.acme which is fine (or else we could also refactor the codestarts with another placeholder if that's really a problem).\nThe big advantage of that convention is that most example classes which don't use qute, compile as is.. adding an expression means that we would need qute processing for all our classes.\nAnyway, I really find it handy this way. we may decide to change that at some point, but this will not be in that PR. CC @maxandersen", "author": "ia3andy", "createdAt": "2020-12-03T10:00:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk2MDM0NA=="}], "type": "inlineReview"}]}