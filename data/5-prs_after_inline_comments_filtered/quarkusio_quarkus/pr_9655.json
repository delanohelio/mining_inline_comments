{"pr_number": 9655, "pr_title": "Funqy Google Cloud Function", "pr_createdAt": "2020-05-28T11:10:05Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9655", "timeline": [{"oid": "1a78986e0a8d279a0fa894fb2a1ae2bbec612dca", "url": "https://github.com/quarkusio/quarkus/commit/1a78986e0a8d279a0fa894fb2a1ae2bbec612dca", "message": "Funqy Google Cloud Function", "committedDate": "2020-05-28T12:34:43Z", "type": "forcePushed"}, {"oid": "a8c0702f38b196a5f3e925fbf7520a0b706f022d", "url": "https://github.com/quarkusio/quarkus/commit/a8c0702f38b196a5f3e925fbf7520a0b706f022d", "message": "Funqy Google Cloud Function", "committedDate": "2020-05-28T12:55:55Z", "type": "forcePushed"}, {"oid": "88ee6797ee7d4498694c0d904282e9f76b14e421", "url": "https://github.com/quarkusio/quarkus/commit/88ee6797ee7d4498694c0d904282e9f76b14e421", "message": "Funqy Google Cloud Function", "committedDate": "2020-05-29T10:16:29Z", "type": "forcePushed"}, {"oid": "d6f2cc434620f21f12b83adb19de94aca013b4d7", "url": "https://github.com/quarkusio/quarkus/commit/d6f2cc434620f21f12b83adb19de94aca013b4d7", "message": "Funqy Google Cloud Functions", "committedDate": "2020-06-09T16:03:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r437585522", "bodyText": "We is there a specific need for Funqy + HTTP + GCP?  Isn't this handled by a more generic function?", "author": "patriot1burke", "createdAt": "2020-06-09T17:05:30Z", "path": "extensions/funqy/funqy-google-cloud-functions/runtime/src/main/java/io/quarkus/funqy/gcp/functions/FunqyHttpFunction.java", "diffHunk": "@@ -0,0 +1,59 @@\n+package io.quarkus.funqy.gcp.functions;\n+\n+import java.io.IOException;\n+import java.io.PrintWriter;\n+import java.io.StringWriter;\n+\n+import com.google.cloud.functions.HttpFunction;\n+import com.google.cloud.functions.HttpRequest;\n+import com.google.cloud.functions.HttpResponse;\n+\n+import io.quarkus.runtime.Application;\n+\n+public class FunqyHttpFunction implements HttpFunction {", "originalCommit": "d6f2cc434620f21f12b83adb19de94aca013b4d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkxNTc2MA==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r437915760", "bodyText": "GCF have 3 distinct function interface, one for HttpFunction and two for BackgroundFunction. So I use two different implementation.\nWe can mix the two function inside he same implementation if you think it's easier for the user to use and easier for us to maintain.", "author": "loicmathieu", "createdAt": "2020-06-10T07:31:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA3MDczMQ==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r438070731", "bodyText": "I'm saying the work you already did that is merged for GCP + HTTP will work with Funqy already.  If your extension works for Servlet, JAX-RS, and Vert.x Web, it will work for Funqy.  There's no need for a new  funqy+http+gcp extension.", "author": "patriot1burke", "createdAt": "2020-06-10T12:06:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODExNDIzMg==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r438114232", "bodyText": "OK, so I need to update the GCF HTTP support to support Funqy right ?", "author": "loicmathieu", "createdAt": "2020-06-10T13:18:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODE4NzkyOQ==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r438187929", "bodyText": "No, GCF HTTP wont' have to do anything to support Funqy.  That's my point.  We only have quarkus-funqy-amazon-lambda because raw lambda does not use HTTP.  Notice that we don't have quarkus-funqy-azure-functions either.", "author": "patriot1burke", "createdAt": "2020-06-10T14:55:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODIwMzA3OQ==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r438203079", "bodyText": "I'm lost here, how do you call a GCF HttpFunction via Funqy ? Or maybe you're saying that we don't as Funqy is designed only for not-http function (BackgroundFunction for GCP).", "author": "loicmathieu", "createdAt": "2020-06-10T15:15:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk5MDQ2NA==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r439990464", "bodyText": "If I compare whith what you provides for Amazon, Funqy HTTP for GCF should be using both funqy-http and google-cloud-http.\nIf it's the case, I need to test it and, if working, just provides documentation.", "author": "loicmathieu", "createdAt": "2020-06-15T07:50:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDE3NDEyNQ==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r440174125", "bodyText": "Yes exactly:  funqy-http + google-cloud-http.  No need for a funqy-gcf-http layer.\nAlso, what about my other question?  If you have funqy integrated with gcf http, why would you want background implementation?  I can understand pub/sub, but what does background provide?", "author": "patriot1burke", "createdAt": "2020-06-15T13:27:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDE5MTc2Nw==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r440191767", "bodyText": "OK, I'll remove it and document the fact that funqy-http will work with google-cloud-functions-http.\nBackground is the generic term for not-http function, it is triggered by any event that Google Cloud support (pubsub, storage, firestore, ...).\nSo this is why we need Funqy for.\nI give examples for PubSub and Storage, on the example I show how you can trigger them via HTTP for testing purpose (via the local invoker) but on GCP this will not be triggered via HTTP so we need Funqy for it.", "author": "loicmathieu", "createdAt": "2020-06-15T13:53:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDIyMjIwOQ==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r440222209", "bodyText": "HttpFunction binding removed, we can know call only background function via Funqy (so only respond to Cloud events, not to HTTP trigger).", "author": "loicmathieu", "createdAt": "2020-06-15T14:36:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM2MzE0OQ==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r442363149", "bodyText": "@patriot1burke is it OK now that I remove the HttpFunction binding ?", "author": "loicmathieu", "createdAt": "2020-06-18T16:44:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTUyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU5MTQ4Mw==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r437591483", "bodyText": "Why are you using the lambda client to test GCP?", "author": "patriot1burke", "createdAt": "2020-06-09T17:15:34Z", "path": "integration-tests/funqy-amazon-lambda/src/test/java/io/quarkus/funqy/gcp/functions/test/GreetTestBase.java", "diffHunk": "@@ -24,7 +22,7 @@ public void testGreetNPE() {\n         try {\n             LambdaClient.invoke(Greeting.class, null);", "originalCommit": "d6f2cc434620f21f12b83adb19de94aca013b4d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkxNTAyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r437915021", "bodyText": "Leftover, I'll remove it.\nThere is no integration test support for the moment.", "author": "loicmathieu", "createdAt": "2020-06-10T07:30:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU5MTQ4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk2OTE5MQ==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r437969191", "bodyText": "In fact, it worse than that, IDEA refactor all the funqy tests when I refactory the one for GCF ... I'll revert this ...", "author": "loicmathieu", "createdAt": "2020-06-10T08:56:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU5MTQ4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk4MzIxMA==", "url": "https://github.com/quarkusio/quarkus/pull/9655#discussion_r437983210", "bodyText": "Change reverted.", "author": "loicmathieu", "createdAt": "2020-06-10T09:20:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU5MTQ4Mw=="}], "type": "inlineReview"}, {"oid": "260da661e8c70952f32b54839574d15d39fee8e1", "url": "https://github.com/quarkusio/quarkus/commit/260da661e8c70952f32b54839574d15d39fee8e1", "message": "Funqy Google Cloud Functions", "committedDate": "2020-06-10T09:02:49Z", "type": "forcePushed"}, {"oid": "0355b42748858e93f6ef86ba8ad8c85e6ea7bc37", "url": "https://github.com/quarkusio/quarkus/commit/0355b42748858e93f6ef86ba8ad8c85e6ea7bc37", "message": "Funqy Google Cloud Functions", "committedDate": "2020-06-10T13:45:52Z", "type": "forcePushed"}, {"oid": "884b70638faf16592137f7a4cf64ad652d0e1c38", "url": "https://github.com/quarkusio/quarkus/commit/884b70638faf16592137f7a4cf64ad652d0e1c38", "message": "Funqy Google Cloud Functions", "committedDate": "2020-06-10T14:55:16Z", "type": "forcePushed"}, {"oid": "80e797ca7852fc037e8a32facb1b2ca82df4ff11", "url": "https://github.com/quarkusio/quarkus/commit/80e797ca7852fc037e8a32facb1b2ca82df4ff11", "message": "Funqy Google Cloud Functions", "committedDate": "2020-06-11T09:43:16Z", "type": "forcePushed"}, {"oid": "ee3f10b2069ca25c1263a47afc764968799f23ce", "url": "https://github.com/quarkusio/quarkus/commit/ee3f10b2069ca25c1263a47afc764968799f23ce", "message": "Funqy Google Cloud Functions", "committedDate": "2020-06-15T12:17:28Z", "type": "forcePushed"}, {"oid": "1dbdb8d0b88a0195047c943c64959b07fed862ba", "url": "https://github.com/quarkusio/quarkus/commit/1dbdb8d0b88a0195047c943c64959b07fed862ba", "message": "Remove HttpFunction binding", "committedDate": "2020-06-18T16:42:01Z", "type": "forcePushed"}, {"oid": "6c3a01b9e634525a9be87914edc0afa4a8278a76", "url": "https://github.com/quarkusio/quarkus/commit/6c3a01b9e634525a9be87914edc0afa4a8278a76", "message": "Fix Java 8 CI", "committedDate": "2020-06-24T12:56:40Z", "type": "forcePushed"}, {"oid": "3901795a1fefd7029d9c674562021928dd0776e9", "url": "https://github.com/quarkusio/quarkus/commit/3901795a1fefd7029d9c674562021928dd0776e9", "message": "Remove HttpFunction binding", "committedDate": "2020-07-02T12:48:21Z", "type": "forcePushed"}, {"oid": "7aaf22ddef817bf4b79950fed3c86b728c03f0de", "url": "https://github.com/quarkusio/quarkus/commit/7aaf22ddef817bf4b79950fed3c86b728c03f0de", "message": "Remove HttpFunction binding", "committedDate": "2020-07-02T16:11:07Z", "type": "forcePushed"}, {"oid": "d77a092a5f13ebcbbc51fb2999b72a61e36fc877", "url": "https://github.com/quarkusio/quarkus/commit/d77a092a5f13ebcbbc51fb2999b72a61e36fc877", "message": "Funqy Google Cloud Functions", "committedDate": "2020-07-16T10:26:19Z", "type": "commit"}, {"oid": "7ae62d08bcf1145934b9907ad55fdcbc9912b265", "url": "https://github.com/quarkusio/quarkus/commit/7ae62d08bcf1145934b9907ad55fdcbc9912b265", "message": "Remove HttpFunction binding", "committedDate": "2020-07-16T10:26:19Z", "type": "commit"}, {"oid": "7ae62d08bcf1145934b9907ad55fdcbc9912b265", "url": "https://github.com/quarkusio/quarkus/commit/7ae62d08bcf1145934b9907ad55fdcbc9912b265", "message": "Remove HttpFunction binding", "committedDate": "2020-07-16T10:26:19Z", "type": "forcePushed"}]}