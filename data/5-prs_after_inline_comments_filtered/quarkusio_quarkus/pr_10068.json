{"pr_number": 10068, "pr_title": "Usability improvements around Panache annotation processors", "pr_createdAt": "2020-06-17T02:58:42Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10068", "timeline": [{"oid": "e89f4e9e0a14dcc711d9d3d20b86f3fce4ac71d4", "url": "https://github.com/quarkusio/quarkus/commit/e89f4e9e0a14dcc711d9d3d20b86f3fce4ac71d4", "message": "Usability improvements around Panache annotation processors\n\n- Document that the jpa-modelgen processor may cause issues\n- Always transform the application\n- Make fields protected to avoid silent failures if there is a problem\n\nFixes #9961", "committedDate": "2020-06-17T06:22:40Z", "type": "commit"}, {"oid": "e89f4e9e0a14dcc711d9d3d20b86f3fce4ac71d4", "url": "https://github.com/quarkusio/quarkus/commit/e89f4e9e0a14dcc711d9d3d20b86f3fce4ac71d4", "message": "Usability improvements around Panache annotation processors\n\n- Document that the jpa-modelgen processor may cause issues\n- Always transform the application\n- Make fields protected to avoid silent failures if there is a problem\n\nFixes #9961", "committedDate": "2020-06-17T06:22:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5MTYzMQ==", "url": "https://github.com/quarkusio/quarkus/pull/10068#discussion_r441391631", "bodyText": "Why protected and not private?\nNote that this may impact the jsonb/jackson/jaxb marshaller strategy, but probably tests would expose this.", "author": "FroMage", "createdAt": "2020-06-17T08:57:30Z", "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheEntityEnhancer.java", "diffHunk": "@@ -91,10 +91,19 @@ public PanacheEntityClassVisitor(String className, ClassVisitor outputClassVisit\n \n         @Override\n         public FieldVisitor visitField(int access, String name, String descriptor, String signature, Object value) {\n-            FieldVisitor superVisitor = super.visitField(access, name, descriptor, signature, value);\n             EntityField ef = fields.get(name);\n             if (ef == null) {\n-                return superVisitor;\n+                return super.visitField(access, name, descriptor, signature, value);\n+            }\n+            //we make the fields protected", "originalCommit": "e89f4e9e0a14dcc711d9d3d20b86f3fce4ac71d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQxNTgzOQ==", "url": "https://github.com/quarkusio/quarkus/pull/10068#discussion_r441415839", "bodyText": "Because I think we allow sub classes to access parent fields directly.\nWe can remove this from the PR, but I thought it would be interesting to add, as I assumed that nothing would be using the fields directly but it looks like this is not the case.", "author": "stuartwdouglas", "createdAt": "2020-06-17T09:36:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5MTYzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQyMDIxMQ==", "url": "https://github.com/quarkusio/quarkus/pull/10068#discussion_r441420211", "bodyText": "Mmm, I think we don't actually allow field access from within the entity, except in the constructor.", "author": "FroMage", "createdAt": "2020-06-17T09:43:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5MTYzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0Njg0NQ==", "url": "https://github.com/quarkusio/quarkus/pull/10068#discussion_r441446845", "bodyText": "panache rest data uses the id field, it was originally private but it failed because of this so I changed it. Maybe I should move this into a seperate pr? It's not really needed for this one, I thought it would just work and make these sort of errors more obvious.", "author": "stuartwdouglas", "createdAt": "2020-06-17T10:30:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5MTYzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUzODQ3MQ==", "url": "https://github.com/quarkusio/quarkus/pull/10068#discussion_r441538471", "bodyText": "Well it did make this sort of error more obvious, so I think it's fine.", "author": "FroMage", "createdAt": "2020-06-17T13:20:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5MTYzMQ=="}], "type": "inlineReview"}]}