{"pr_number": 11474, "pr_title": "Codestarts testing", "pr_createdAt": "2020-08-19T16:41:28Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/11474", "timeline": [{"oid": "bbe207d183f7bf14e3a3e30687cef8560c866d4c", "url": "https://github.com/quarkusio/quarkus/commit/bbe207d183f7bf14e3a3e30687cef8560c866d4c", "message": "Codestarts tests", "committedDate": "2020-08-20T08:03:45Z", "type": "commit"}, {"oid": "bbe207d183f7bf14e3a3e30687cef8560c866d4c", "url": "https://github.com/quarkusio/quarkus/commit/bbe207d183f7bf14e3a3e30687cef8560c866d4c", "message": "Codestarts tests", "committedDate": "2020-08-20T08:03:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA2ODEzMA==", "url": "https://github.com/quarkusio/quarkus/pull/11474#discussion_r474068130", "bodyText": "What's wrong with \"*\".equals(codestartFileStrategy.getFilter()) ? \ud83d\ude1b", "author": "gastaldi", "createdAt": "2020-08-20T15:25:09Z", "path": "independent-projects/tools/codestarts/src/main/java/io/quarkus/devtools/codestarts/CodestartProcessor.java", "diffHunk": "@@ -137,12 +132,25 @@ public void writeFiles() throws IOException {\n         for (Map.Entry<String, List<CodestartFile>> e : files.entrySet()) {\n             final String relativePath = e.getKey();\n             Files.createDirectories(targetDirectory.resolve(relativePath).getParent());\n-            getStrategy(relativePath).orElse(CodestartFileStrategyHandler.DEFAULT_STRATEGY)\n+            getStrategy(relativePath).orElse(getSelectedDefaultStrategy())\n                     .process(targetDirectory, relativePath, e.getValue(), data);\n         }\n     }\n \n-    private Optional<CodestartFileStrategyHandler> getStrategy(final String key) {\n+    DefaultCodestartFileStrategyHandler getSelectedDefaultStrategy() {\n+        for (CodestartFileStrategy codestartFileStrategy : strategies) {\n+            if (Objects.equals(codestartFileStrategy.getFilter(), \"*\")) {", "originalCommit": "bbe207d183f7bf14e3a3e30687cef8560c866d4c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1MjkxMg==", "url": "https://github.com/quarkusio/quarkus/pull/11474#discussion_r474452912", "bodyText": "I guess the result is the same but I always favor Objects.equals then I don't have to think too much about NPE (even if in that case it's not the case :p)", "author": "ia3andy", "createdAt": "2020-08-21T07:08:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA2ODEzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA2OTIyOA==", "url": "https://github.com/quarkusio/quarkus/pull/11474#discussion_r474069228", "bodyText": "This throws FileAlreadyExistsException if targetPath.getParent() already exists", "author": "gastaldi", "createdAt": "2020-08-20T15:26:45Z", "path": "independent-projects/tools/codestarts/src/main/java/io/quarkus/devtools/codestarts/strategy/ReplaceCodestartFileStrategyHandler.java", "diffHunk": "@@ -4,16 +4,23 @@\n import java.io.IOException;\n import java.nio.file.Files;\n import java.nio.file.Path;\n+import java.nio.file.StandardCopyOption;\n import java.util.List;\n import java.util.Map;\n \n-final class ReplaceCodestartFileStrategyHandler implements CodestartFileStrategyHandler {\n+final class ReplaceCodestartFileStrategyHandler implements DefaultCodestartFileStrategyHandler {\n \n     @Override\n     public String name() {\n         return \"replace\";\n     }\n \n+    @Override\n+    public void copyStaticFile(Path sourcePath, Path targetPath) throws IOException {\n+        Files.createDirectories(targetPath.getParent());", "originalCommit": "bbe207d183f7bf14e3a3e30687cef8560c866d4c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1MTE2MA==", "url": "https://github.com/quarkusio/quarkus/pull/11474#discussion_r474451160", "bodyText": "@gastaldi yeah, only if the file exists AND is not a directory, which makes sense here:\n\"Creates a directory by creating all nonexistent parent directories first. Unlike the createDirectory method, an exception is NOT thrown if the directory could not be created because it already exists.\"", "author": "ia3andy", "createdAt": "2020-08-21T07:06:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA2OTIyOA=="}], "type": "inlineReview"}]}