{"pr_number": 18538, "pr_title": "Release 5.3.0", "pr_createdAt": "2020-05-21T19:24:35Z", "pr_url": "https://github.com/dotCMS/core/pull/18538", "timeline": [{"oid": "bd9886068ea607ed7994253bf1e402d2b975b886", "url": "https://github.com/dotCMS/core/commit/bd9886068ea607ed7994253bf1e402d2b975b886", "message": "Update dotcmsReleaseVersion and coreWebReleasion version", "committedDate": "2020-05-11T21:53:57Z", "type": "commit"}, {"oid": "1a994155b2bbdf52f62b0d29abee07c95b8a87d1", "url": "https://github.com/dotCMS/core/commit/1a994155b2bbdf52f62b0d29abee07c95b8a87d1", "message": "Updating commit reference for src/main/enterprise", "committedDate": "2020-05-11T21:54:53Z", "type": "commit"}, {"oid": "eb722534e913079833d1f8b4297af939475ea4f0", "url": "https://github.com/dotCMS/core/commit/eb722534e913079833d1f8b4297af939475ea4f0", "message": "update release version", "committedDate": "2020-05-11T21:55:41Z", "type": "commit"}, {"oid": "1613b267d73ccabe1ecd68572dae69252e70f6f2", "url": "https://github.com/dotCMS/core/commit/1613b267d73ccabe1ecd68572dae69252e70f6f2", "message": "dotCMS/core#18475 Update starters to do publish as default WF action for DotAssets", "committedDate": "2020-05-13T15:40:01Z", "type": "commit"}, {"oid": "980987b9b88bab7fba025ee9985412108427e716", "url": "https://github.com/dotCMS/core/commit/980987b9b88bab7fba025ee9985412108427e716", "message": "Additional fix for issue 14385 (#18493)\n\n* #14385 Initializing Hikari datasource in a cleaner way\r\n\r\n* #14385 Applying code review suggestion: https://github.com/dotCMS/core/pull/18493#pullrequestreview-411336143\r\n\r\nCo-authored-by: Nollymar Longa <>", "committedDate": "2020-05-14T15:24:16Z", "type": "commit"}, {"oid": "e284640fc8fe6cbdf98b98600d9a2264fa79bb42", "url": "https://github.com/dotCMS/core/commit/e284640fc8fe6cbdf98b98600d9a2264fa79bb42", "message": "dotCMS/core#18185 Ship with Empty Starter\n\n* #18185 fix for the DotAssetBaseTypeToContentTypeStrategyImplTest\r\n\r\n* #18185 fixing unit test", "committedDate": "2020-05-14T15:57:54Z", "type": "commit"}, {"oid": "12392a6a0ff0fa7e29a583899f79ffafc59ebab4", "url": "https://github.com/dotCMS/core/commit/12392a6a0ff0fa7e29a583899f79ffafc59ebab4", "message": "dotCMS/core#18485 NPE trying to a content from binary field in other language #18485\n\n* #18485 fixing the npe\r\n\r\n* #18485 adding unit test", "committedDate": "2020-05-14T16:15:55Z", "type": "commit"}, {"oid": "84581dca779586764b5eeaa8e060f90aa8130a44", "url": "https://github.com/dotCMS/core/commit/84581dca779586764b5eeaa8e060f90aa8130a44", "message": "Add webcomponents versioning (#18511)", "committedDate": "2020-05-18T15:05:18Z", "type": "commit"}, {"oid": "8c18fea20eabd09c93fb34ab20b3c3b92b603141", "url": "https://github.com/dotCMS/core/commit/8c18fea20eabd09c93fb34ab20b3c3b92b603141", "message": "Fix the bad npm name (#18514)", "committedDate": "2020-05-18T15:26:08Z", "type": "commit"}, {"oid": "c9a4202310bc4494cc941ce7b6c336f0f1c73490", "url": "https://github.com/dotCMS/core/commit/c9a4202310bc4494cc941ce7b6c336f0f1c73490", "message": "Fix the naming in npm packs", "committedDate": "2020-05-18T15:40:35Z", "type": "commit"}, {"oid": "6632fd5d9039f09dd9c496b841e460cf3a8d2e0b", "url": "https://github.com/dotCMS/core/commit/6632fd5d9039f09dd9c496b841e460cf3a8d2e0b", "message": "#18456 fix (#18517)", "committedDate": "2020-05-18T15:48:30Z", "type": "commit"}, {"oid": "5d660d7a76a95372e94589819d3b5c452829be3d", "url": "https://github.com/dotCMS/core/commit/5d660d7a76a95372e94589819d3b5c452829be3d", "message": "#18215 merged", "committedDate": "2020-05-19T20:43:20Z", "type": "commit"}, {"oid": "609ad3aeab334a9b1d36dbc91097023937c1df18", "url": "https://github.com/dotCMS/core/commit/609ad3aeab334a9b1d36dbc91097023937c1df18", "message": "Osgi reloading (#18523)\n\n* failed reloading will not kill server\r\n\r\n* osgi resource working", "committedDate": "2020-05-20T14:46:29Z", "type": "commit"}, {"oid": "efb4f4d6b8811394823f9e75d5ffcd54a09acab0", "url": "https://github.com/dotCMS/core/commit/efb4f4d6b8811394823f9e75d5ffcd54a09acab0", "message": "Add configuration to support providedCompile method (#18527)\n\nCo-authored-by: Nollymar Longa <>", "committedDate": "2020-05-20T22:18:06Z", "type": "commit"}, {"oid": "aa1b86e26e59bf920ab3c085363ad4fd9a76965e", "url": "https://github.com/dotCMS/core/commit/aa1b86e26e59bf920ab3c085363ad4fd9a76965e", "message": "Lang props for 5.3.0 (#18534)", "committedDate": "2020-05-21T18:24:54Z", "type": "commit"}, {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "url": "https://github.com/dotCMS/core/commit/f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "message": "Merge branch 'master' into release-5.3.0", "committedDate": "2020-05-21T22:50:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODUyOQ==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958529", "bodyText": "Issue found: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:39Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/db/DBPropertiesDataSourceStrategyTest.java", "diffHunk": "@@ -84,16 +85,20 @@ public void testApplyWithValidFileShouldPass()\n     @Test\n     public void testGetHikariConfigWithValidFileShouldPass()\n             throws IOException, ConfigurationException {\n-        final File tempFile = createTempFile(\"connection_db_driver=org.postgresql.Driver\\n\"\n-                + \"connection_db_base_url=jdbc:postgresql://localhost/dotcms\\n\"\n-                + \"connection_db_username=postgres\\n\"\n-                + \"connection_db_password=postgres\\n\"\n-                + \"connection_db_validation_query=SELECT 1\");\n+        final File tempFile = createTempFile(\"driverClassName=org.postgresql.Driver\\n\"\n+                + \"jdbcUrl=jdbc:postgresql://localhost/dotcms\\n\"\n+                + \"username=postgres\\n\"\n+                + \"password=postgres\\n\"\n+                + \"connectionTestQuery=SELECT 1\\n\"\n+                + \"maximumPoolSize=60\\n\"\n+                + \"idleTimeout=10000\\n\"\n+                + \"maxLifetime=60000\\n\"\n+                + \"leakDetectionThreshold=60000\");\n \n         final PropertiesConfiguration properties = new PropertiesConfiguration();\n-        properties.load(tempFile);\n+        properties.load(new FileInputStream(tempFile));", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODUzNg==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958536", "bodyText": "Issue found: Parameter 'clazz' is not assigned and could be declared final", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:40Z", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU0Nw==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958547", "bodyText": "Issue found: Parameter 'clazz' is not assigned and could be declared final", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:41Z", "path": "dotCMS/src/main/java/com/dotcms/rest/config/RestServiceUtil.java", "diffHunk": "@@ -1,37 +1,14 @@\n package com.dotcms.rest.config;\n \n-import com.dotcms.rest.servlet.ReloadableServletContainer;\n-\n-\n-\n public class RestServiceUtil {\n-\t\n-\tpublic synchronized static void addResource(Class clazz){\n-\t\t\n-\t\tnew DotRestApplication().getClasses();\n-\t\tif(DotRestApplication.REST_CLASSES.contains(clazz)){\n-\t\t\treturn;\n-\t\t}\n-\t\t\n-\t\tDotRestApplication.REST_CLASSES.add(clazz);\n \n-\t\treloadRest();\n-\t\t\n+    public static void addResource(Class clazz) {", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU1MQ==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958551", "bodyText": "Issue found: Use block level rather than method level synchronization", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:42Z", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {\n+        if(clazz==null)return;\n+        if(!customClasses.containsKey(clazz)) {\n+            customClasses.put(clazz, true);\n+            ReloadableServletContainer.reload(new DotRestApplication());\n+        }\n+    }\n+\n+    /**\n+     * removes a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void removeClass(Class<?> clazz) {", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU1NQ==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958555", "bodyText": "Issue found: Use block level rather than method level synchronization", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:43Z", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU2MQ==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958561", "bodyText": "Issue found: Local variable 'config' could be declared final", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:44Z", "path": "dotCMS/src/integration-test/java/com/dotcms/util/TestDataSourceProvider.java", "diffHunk": "@@ -11,50 +12,12 @@\n \n public class TestDataSourceProvider implements DotDataSourceStrategy {\n \n-    private Properties prop;\n-\n     @Override\n     public DataSource apply() {\n \n-        String dbType = \"postgres.\";\n-\n-        if (System.getProperty(\"databaseType\")!=null){\n-            dbType = System.getProperty(\"databaseType\") + \".\";\n-        } else if(System.getenv(\"databaseType\")!=null){\n-            dbType = System.getenv(\"databaseType\") + \".\";\n-        }\n-\n-        loadProperties();\n-\n-        // https://github.com/brettwooldridge/HikariCP#configuration-knobs-baby\n-        HikariConfig config = new HikariConfig();\n+        HikariConfig config = new HikariConfig(getProperties());", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU2OA==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958568", "bodyText": "Issue found: This statement should have braces", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:45Z", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {\n+        if(clazz==null)return;", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU3NQ==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958575", "bodyText": "Issue found: Useless parentheses.", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:47Z", "path": "dotCMS/src/integration-test/java/com/dotcms/util/TestDataSourceProvider.java", "diffHunk": "@@ -63,18 +26,22 @@ public DataSource apply() {\n      * Load properties file with DB connection details\n      * @throws NamingException\n      */\n-    private void loadProperties()  {\n-        ClassLoader loader = Thread.currentThread().getContextClassLoader();\n-        prop = new Properties();\n+    private Properties getProperties()  {\n+        final ClassLoader loader = Thread.currentThread().getContextClassLoader();\n+        final Properties properties = new Properties();\n \n-        try (InputStream resourceStream = loader.getResourceAsStream(\"db-config.properties\")) {\n-            prop.load(resourceStream);\n+        final String dbType = System.getProperty(\"databaseType\",\n+                (System.getenv(\"databaseType\") != null ? System.getenv(\"databaseType\")", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU3OQ==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958579", "bodyText": "Issue found: Do not hard code the IP address", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:48Z", "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/system/monitor/MonitorHelper.java", "diffHunk": "@@ -47,7 +47,7 @@\n     private static final long   DEFAULT_ASSET_FS_TIMEOUT    = 1000;\n     private static final long   DEFAULT_INDEX_TIMEOUT       = 1000;\n     private static final long   DEFAULT_DB_TIMEOUT          = 1000;\n-    private static final String DEFAULT_IP_ACL_VALUE        = \"127.0.0.1/32,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,0:0:0:0:0:0:0:1/128\";\n+    private static final String[] DEFAULT_IP_ACL_VALUE        = new String[] {\"127.0.0.1/32\",\"10.0.0.0/8\",\"172.16.0.0/12\",\"192.168.0.0/16\",\"0:0:0:0:0:0:0:1\"};", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU4NQ==", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958585", "bodyText": "Issue found: Parameter 'clazz' is not assigned and could be declared final", "author": "dev-dotcms", "createdAt": "2020-05-21T22:56:49Z", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {\n+        if(clazz==null)return;\n+        if(!customClasses.containsKey(clazz)) {\n+            customClasses.put(clazz, true);\n+            ReloadableServletContainer.reload(new DotRestApplication());\n+        }\n+    }\n+\n+    /**\n+     * removes a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void removeClass(Class<?> clazz) {", "originalCommit": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}