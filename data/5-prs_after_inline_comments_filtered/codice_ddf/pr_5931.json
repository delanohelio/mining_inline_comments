{"pr_number": 5931, "pr_title": "[2.19.x] DDF-UI-135 filter blank attributes from CSV export result", "pr_createdAt": "2020-03-25T03:19:54Z", "pr_url": "https://github.com/codice/ddf/pull/5931", "timeline": [{"oid": "3f15971fb35123562f7f59e9d1125471f277e636", "url": "https://github.com/codice/ddf/commit/3f15971fb35123562f7f59e9d1125471f277e636", "message": "DDF-UI-135 pass attributes to the transformer", "committedDate": "2020-03-25T00:45:11Z", "type": "commit"}, {"oid": "c2cca4d28b3e525458865ad6586646b58ad35548", "url": "https://github.com/codice/ddf/commit/c2cca4d28b3e525458865ad6586646b58ad35548", "message": "DDF-UI-135 remove commented line", "committedDate": "2020-03-25T14:33:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzkzNzI0NQ==", "url": "https://github.com/codice/ddf/pull/5931#discussion_r397937245", "bodyText": "Is this transformer used anywhere else? wondering if we should avoid filtering if no columnOrder arg is passed in", "author": "andrewzimmer", "createdAt": "2020-03-25T15:17:45Z", "path": "catalog/transformer/catalog-transformer-csv-queryresponse/src/main/java/ddf/catalog/transformer/csv/CsvMetacardTransformer.java", "diffHunk": "@@ -43,11 +46,20 @@ public BinaryContent transform(Metacard metacard, Map<String, Serializable> argu\n \n     Map<String, String> aliases =\n         (Map<String, String>) arguments.getOrDefault(\"aliases\", new HashMap<>());\n+    String attributeString = (String) arguments.get(\"columnOrder\");\n+    ArrayList<String> attributes =\n+        new ArrayList<String>(Arrays.asList((attributeString).split(\",\")));\n \n     Appendable appendable =\n         writeMetacardsToCsv(\n             Collections.singletonList(metacard),\n-            new ArrayList<>(metacard.getMetacardType().getAttributeDescriptors()),\n+            new ArrayList<AttributeDescriptor>(\n+                metacard\n+                    .getMetacardType()\n+                    .getAttributeDescriptors()\n+                    .stream()\n+                    .filter(attr -> attributes.contains(attr.getName()))", "originalCommit": "c2cca4d28b3e525458865ad6586646b58ad35548", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1MTA5NA==", "url": "https://github.com/codice/ddf/pull/5931#discussion_r398051094", "bodyText": "I don't think it's used anywhere else but it's probably a good idea to add that logic anyway", "author": "cassandrabailey293", "createdAt": "2020-03-25T17:47:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzkzNzI0NQ=="}], "type": "inlineReview"}, {"oid": "8fd9de65f08de704012defb8e8b84f0695c24b86", "url": "https://github.com/codice/ddf/commit/8fd9de65f08de704012defb8e8b84f0695c24b86", "message": "DDF-UI-135 use .get", "committedDate": "2020-03-25T15:23:27Z", "type": "commit"}, {"oid": "71a5e7b4e577be4e2462870ac6d398e9ea516605", "url": "https://github.com/codice/ddf/commit/71a5e7b4e577be4e2462870ac6d398e9ea516605", "message": "DDF-UI-135 fix get attributes", "committedDate": "2020-03-25T15:28:06Z", "type": "commit"}, {"oid": "39a249f2c3a3cf3e26f1590b6b063f6367b0e1d0", "url": "https://github.com/codice/ddf/commit/39a249f2c3a3cf3e26f1590b6b063f6367b0e1d0", "message": "DDF-UI-135 only filter if columnOrder is provided", "committedDate": "2020-03-25T18:12:37Z", "type": "commit"}, {"oid": "dd70cc4cafcb9f479704c11024b8652d2bb23f70", "url": "https://github.com/codice/ddf/commit/dd70cc4cafcb9f479704c11024b8652d2bb23f70", "message": "DDF-UI-135 use List instead of ArrayList", "committedDate": "2020-03-26T16:43:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODczNjIyMA==", "url": "https://github.com/codice/ddf/pull/5931#discussion_r398736220", "bodyText": "\u270f\ufe0f Same comment as the other PR, could use CollectionUtils.isEmpty(attributes) here", "author": "zta6", "createdAt": "2020-03-26T16:59:59Z", "path": "catalog/transformer/catalog-transformer-csv-queryresponse/src/main/java/ddf/catalog/transformer/csv/CsvMetacardTransformer.java", "diffHunk": "@@ -43,12 +46,21 @@ public BinaryContent transform(Metacard metacard, Map<String, Serializable> argu\n \n     Map<String, String> aliases =\n         (Map<String, String>) arguments.getOrDefault(\"aliases\", new HashMap<>());\n-\n+    String attributeString = (String) arguments.get(\"columnOrder\");\n+    List<String> attributes =\n+        new ArrayList<String>(Arrays.asList((attributeString).split(\",\")));\n+    List<AttributeDescriptor> allAttributes =\n+        new ArrayList<AttributeDescriptor>(metacard.getMetacardType().getAttributeDescriptors());\n+    List<AttributeDescriptor> descriptors =\n+        new ArrayList<AttributeDescriptor>(\n+            attributes == null || attributes.isEmpty()", "originalCommit": "dd70cc4cafcb9f479704c11024b8652d2bb23f70", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4cabae96808196b487b3c32d5cfc2570641c9b2c", "url": "https://github.com/codice/ddf/commit/4cabae96808196b487b3c32d5cfc2570641c9b2c", "message": "DDF-UI-135 use CollectionUtils and import List", "committedDate": "2020-03-26T17:07:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODc1ODIyNg==", "url": "https://github.com/codice/ddf/pull/5931#discussion_r398758226", "bodyText": "if no columnOrder arg is present, will this return an empty string or null?", "author": "andrewzimmer", "createdAt": "2020-03-26T17:30:16Z", "path": "catalog/transformer/catalog-transformer-csv-queryresponse/src/main/java/ddf/catalog/transformer/csv/CsvMetacardTransformer.java", "diffHunk": "@@ -43,12 +48,20 @@ public BinaryContent transform(Metacard metacard, Map<String, Serializable> argu\n \n     Map<String, String> aliases =\n         (Map<String, String>) arguments.getOrDefault(\"aliases\", new HashMap<>());\n-\n+    String attributeString = (String) arguments.get(\"columnOrder\");", "originalCommit": "4cabae96808196b487b3c32d5cfc2570641c9b2c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgzOTkxNA==", "url": "https://github.com/codice/ddf/pull/5931#discussion_r398839914", "bodyText": "i think it actually returns null, so I should guard for that \ud83d\udc4d", "author": "cassandrabailey293", "createdAt": "2020-03-26T19:34:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODc1ODIyNg=="}], "type": "inlineReview"}, {"oid": "6f5ace17f6fd8a422b26aac24d18cd7172470c12", "url": "https://github.com/codice/ddf/commit/6f5ace17f6fd8a422b26aac24d18cd7172470c12", "message": "DDF-UI-135 guard against null columnOrder", "committedDate": "2020-03-26T19:43:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg1MTkzNg==", "url": "https://github.com/codice/ddf/pull/5931#discussion_r398851936", "bodyText": "any reason these all need to be new ArrayList? I think it should already be returning a list of strings. Same question for the two below", "author": "andrewzimmer", "createdAt": "2020-03-26T19:55:20Z", "path": "catalog/transformer/catalog-transformer-csv-queryresponse/src/main/java/ddf/catalog/transformer/csv/CsvMetacardTransformer.java", "diffHunk": "@@ -43,12 +48,21 @@ public BinaryContent transform(Metacard metacard, Map<String, Serializable> argu\n \n     Map<String, String> aliases =\n         (Map<String, String>) arguments.getOrDefault(\"aliases\", new HashMap<>());\n-\n+    String attributeString =\n+        arguments.get(\"columnOrder\") != null ? (String) arguments.get(\"columnOrder\") : \"\";\n+    List<String> attributes = new ArrayList<String>(Arrays.asList((attributeString).split(\",\")));", "originalCommit": "6f5ace17f6fd8a422b26aac24d18cd7172470c12", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg1NjUzNg==", "url": "https://github.com/codice/ddf/pull/5931#discussion_r398856536", "bodyText": "I think two of them can be changed, the metacard.getMetacardType().getAttributeDescriptors() returns a Set so I'll probably leave that as is. Alternatively I could instantiate allAttributes as a Set, but i'd just have to change it to a list when instantiating descriptors so I'll leave it as-is. I can change the other two though", "author": "cassandrabailey293", "createdAt": "2020-03-26T20:03:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg1MTkzNg=="}], "type": "inlineReview"}, {"oid": "ef822ea3f54732fe5bf992a7de901f93aa228aaf", "url": "https://github.com/codice/ddf/commit/ef822ea3f54732fe5bf992a7de901f93aa228aaf", "message": "DDF-UI-135 remove unnecessary new operators", "committedDate": "2020-03-26T20:04:05Z", "type": "commit"}, {"oid": "4202517cefa3903e4aa6ee278a89d839bcb06e1c", "url": "https://github.com/codice/ddf/commit/4202517cefa3903e4aa6ee278a89d839bcb06e1c", "message": "DDF-UI-135 use const", "committedDate": "2020-03-26T22:38:38Z", "type": "commit"}, {"oid": "813f3c19639fe15bf3cfd36c32fb946138cbad53", "url": "https://github.com/codice/ddf/commit/813f3c19639fe15bf3cfd36c32fb946138cbad53", "message": "DDF-UI-135 formatting", "committedDate": "2020-03-30T14:33:34Z", "type": "commit"}, {"oid": "634634da246cae3852341647502073c60e09b380", "url": "https://github.com/codice/ddf/commit/634634da246cae3852341647502073c60e09b380", "message": "DDF-UI-135 fix unit test", "committedDate": "2020-04-01T19:04:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODI0NTg3OA==", "url": "https://github.com/codice/ddf/pull/5931#discussion_r408245878", "bodyText": "According to the documentation for CollectionUtils.isEmpty, it returns true on null. Do we want to return null here?", "author": "AzGoalie", "createdAt": "2020-04-14T15:51:33Z", "path": "catalog/transformer/catalog-transformer-csv-queryresponse/src/main/java/ddf/catalog/transformer/csv/CsvMetacardTransformer.java", "diffHunk": "@@ -43,12 +48,20 @@ public BinaryContent transform(Metacard metacard, Map<String, Serializable> argu\n \n     Map<String, String> aliases =\n         (Map<String, String>) arguments.getOrDefault(\"aliases\", new HashMap<>());\n-\n+    String attributeString =\n+        arguments.get(\"columnOrder\") != null ? (String) arguments.get(\"columnOrder\") : \"\";\n+    List<String> attributes = Arrays.asList((attributeString).split(\",\"));\n+    List<AttributeDescriptor> allAttributes =\n+        new ArrayList<AttributeDescriptor>(metacard.getMetacardType().getAttributeDescriptors());\n+    List<AttributeDescriptor> descriptors =\n+        CollectionUtils.isEmpty(attributes)\n+            ? allAttributes", "originalCommit": "634634da246cae3852341647502073c60e09b380", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM5NjE2MA==", "url": "https://github.com/codice/ddf/pull/5931#discussion_r408396160", "bodyText": "attributes will never be null because we initialize it with Arrays.asList((attributeString).split(\",\")), which will return an empty list when given an empty string.  attributeString defaults to the empty string if no columnOrder argument is found.", "author": "cassandrabailey293", "createdAt": "2020-04-14T19:54:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODI0NTg3OA=="}], "type": "inlineReview"}]}