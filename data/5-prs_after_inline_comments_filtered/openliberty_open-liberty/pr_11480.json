{"pr_number": 11480, "pr_title": "Repeat FAT tests with Jakarta EE", "pr_createdAt": "2020-03-26T14:41:18Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/11480", "timeline": [{"oid": "b0517f0f2c391475765fe80f130c0d492464d93a", "url": "https://github.com/OpenLiberty/open-liberty/commit/b0517f0f2c391475765fe80f130c0d492464d93a", "message": "Upgrade to jakarta transformer 0.0.6", "committedDate": "2020-03-26T15:51:14Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODc3ODQyMQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11480#discussion_r398778421", "bodyText": "Why is jdbc-4.2 an EE9 feature?  Also, concurrent-2.0 is missing.  Are others missing as well - I don't see EJB (whatever the new name for it is) ?", "author": "njr-11", "createdAt": "2020-03-26T17:58:37Z", "path": "dev/fattest.simplicity/src/componenttest/rules/repeater/JakartaEE9Action.java", "diffHunk": "@@ -0,0 +1,226 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+package componenttest.rules.repeater;\n+\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+import java.io.PrintStream;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.Set;\n+\n+import com.ibm.websphere.simplicity.log.Log;\n+import com.ibm.ws.jakarta.transformer.JakartaTransformer;\n+\n+import componenttest.custom.junit.runner.Mode.TestMode;\n+import componenttest.custom.junit.runner.RepeatTestFilter;\n+\n+/**\n+ * Test repeat action that will do 2 things:\n+ * <ol>\n+ * <li>Invoke the Jakarta transformer on all war/ear files under the autoFVT/publish/ folder</li>\n+ * <li>Update all server.xml configs under the autoFVT/publish/ folder to use EE 9 features</li>\n+ * </ol>\n+ */\n+public class JakartaEE9Action extends FeatureReplacementAction {\n+\n+    private static final Class<?> c = JakartaEE9Action.class;\n+\n+    public static final String ID = \"EE9_FEATURES\";\n+\n+    static final String[] EE9_FEATURES_ARRAY = { \"jakartaee-9.0\", \"webProfile-9.0\", \"jakartaeeClient-9.0\", \"servlet-5.0\", \"jdbc-4.2\", \"javaMail-2.0\", \"cdi-3.0\", \"jpa-3.0\",", "originalCommit": "4a267e7a7b3388a8f5d87acee336961b5e325b48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgyMDk0NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11480#discussion_r398820945", "bodyText": "jdbc-4.2 doesn't have to be in here, what this implies is that when server.xml's are getting upgraded to EE9-level features, we will also upgrade to jdbc-4.2 if older jdbc version are specified like 4.0 or 4.1. While tests would technically work with any JDBC feature version, I think it would be good for us to test with the latest features when possible -- this list can also be customized at the FAT bucket level, so if a FAT wants to specifically test an older JDBC version it can still do so.\nRegarding other features like concurrent-2.0, yes I will get those added.", "author": "aguibert", "createdAt": "2020-03-26T19:02:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODc3ODQyMQ=="}], "type": "inlineReview"}, {"oid": "b172c6ba430d1302e716dc8966cf428232138193", "url": "https://github.com/OpenLiberty/open-liberty/commit/b172c6ba430d1302e716dc8966cf428232138193", "message": "Review comments", "committedDate": "2020-03-26T22:01:49Z", "type": "forcePushed"}, {"oid": "ebbb91d2b0765fc7060dceb803a4b81daeb8eda3", "url": "https://github.com/OpenLiberty/open-liberty/commit/ebbb91d2b0765fc7060dceb803a4b81daeb8eda3", "message": "Create componenttest-2.0 feature for jakarta-based FATServlet", "committedDate": "2020-03-26T22:02:32Z", "type": "commit"}, {"oid": "62a5669ffd639b7b2af59db4e90408c77c2497dd", "url": "https://github.com/OpenLiberty/open-liberty/commit/62a5669ffd639b7b2af59db4e90408c77c2497dd", "message": "Initial prototype with repeat action working", "committedDate": "2020-03-26T22:02:32Z", "type": "commit"}, {"oid": "1ced40b3c39c4d6a6c2f66bdc3365cf265e95083", "url": "https://github.com/OpenLiberty/open-liberty/commit/1ced40b3c39c4d6a6c2f66bdc3365cf265e95083", "message": "Update transformer jar to version 0.0.5", "committedDate": "2020-03-26T22:02:32Z", "type": "commit"}, {"oid": "84f34eefaf19f3e932c2b683715dba61d2543328", "url": "https://github.com/OpenLiberty/open-liberty/commit/84f34eefaf19f3e932c2b683715dba61d2543328", "message": "Move JakartaEE repeat action to FAT infra", "committedDate": "2020-03-26T22:06:28Z", "type": "commit"}, {"oid": "843905205e90955dda1aa41316c9be27b5e88356", "url": "https://github.com/OpenLiberty/open-liberty/commit/843905205e90955dda1aa41316c9be27b5e88356", "message": "Upgrade to jakarta transformer 0.0.6", "committedDate": "2020-03-26T22:06:29Z", "type": "commit"}, {"oid": "adce66d59eb631ba8ba133621d54b7fe06438303", "url": "https://github.com/OpenLiberty/open-liberty/commit/adce66d59eb631ba8ba133621d54b7fe06438303", "message": "Perform Jakarta xform in ShrinkHelper instead of RepeatAction.setup()", "committedDate": "2020-03-26T22:06:29Z", "type": "commit"}, {"oid": "ae177a3e01a3d78519fafc9dc2ba1425848ef1c8", "url": "https://github.com/OpenLiberty/open-liberty/commit/ae177a3e01a3d78519fafc9dc2ba1425848ef1c8", "message": "Integration with JakartaEE9Action and SharedServer", "committedDate": "2020-03-26T22:06:29Z", "type": "commit"}, {"oid": "66194c19d261c9c7f97ebdf5bfced699f5855bf8", "url": "https://github.com/OpenLiberty/open-liberty/commit/66194c19d261c9c7f97ebdf5bfced699f5855bf8", "message": "Review comments", "committedDate": "2020-03-26T22:07:15Z", "type": "forcePushed"}, {"oid": "1f1944324ddd61872333126ad5f5165572fcba9b", "url": "https://github.com/OpenLiberty/open-liberty/commit/1f1944324ddd61872333126ad5f5165572fcba9b", "message": "Review comments", "committedDate": "2020-03-26T22:59:37Z", "type": "commit"}, {"oid": "1f1944324ddd61872333126ad5f5165572fcba9b", "url": "https://github.com/OpenLiberty/open-liberty/commit/1f1944324ddd61872333126ad5f5165572fcba9b", "message": "Review comments", "committedDate": "2020-03-26T22:59:37Z", "type": "forcePushed"}]}