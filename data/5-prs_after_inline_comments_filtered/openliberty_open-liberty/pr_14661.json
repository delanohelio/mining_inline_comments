{"pr_number": 14661, "pr_title": "trusted header configuration improvements ", "pr_createdAt": "2020-10-22T20:49:42Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/14661", "timeline": [{"oid": "27da4f06619599036a46ebe9044f8d338cb848f4", "url": "https://github.com/OpenLiberty/open-liberty/commit/27da4f06619599036a46ebe9044f8d338cb848f4", "message": "keep existing public method names", "committedDate": "2020-11-04T21:26:13Z", "type": "forcePushed"}, {"oid": "31ce26a0291417064185682e75098786bf384f39", "url": "https://github.com/OpenLiberty/open-liberty/commit/31ce26a0291417064185682e75098786bf384f39", "message": "refactor to use chfw FilterList utilities", "committedDate": "2020-12-02T22:00:48Z", "type": "forcePushed"}, {"oid": "95201f2b33d455fa994a66f1488538baad269f88", "url": "https://github.com/OpenLiberty/open-liberty/commit/95201f2b33d455fa994a66f1488538baad269f88", "message": "refactor to use chfw FilterList utilities", "committedDate": "2020-12-02T23:42:57Z", "type": "forcePushed"}, {"oid": "9b26213e1f742ce7bec05cc2f1abec173a9677f5", "url": "https://github.com/OpenLiberty/open-liberty/commit/9b26213e1f742ce7bec05cc2f1abec173a9677f5", "message": "refactor to use cfw FilterList objects", "committedDate": "2020-12-03T16:32:33Z", "type": "forcePushed"}, {"oid": "a43f0b89d47115262f4167a5256cf5103053c67e", "url": "https://github.com/OpenLiberty/open-liberty/commit/a43f0b89d47115262f4167a5256cf5103053c67e", "message": "refactor to use cfw FilterList objects", "committedDate": "2020-12-03T19:48:55Z", "type": "forcePushed"}, {"oid": "862d3565b658a548611c784a54f1508e337241dd", "url": "https://github.com/OpenLiberty/open-liberty/commit/862d3565b658a548611c784a54f1508e337241dd", "message": "refactor to use cfw FilterList objects", "committedDate": "2020-12-03T20:02:01Z", "type": "forcePushed"}, {"oid": "303e649296e5374b671b87d8afde907a10bb864d", "url": "https://github.com/OpenLiberty/open-liberty/commit/303e649296e5374b671b87d8afde907a10bb864d", "message": "refactor to use cfw FilterList objects", "committedDate": "2020-12-03T20:04:32Z", "type": "forcePushed"}, {"oid": "7f9abc2b56e0b62437afd7464f0ca77cb5af2f51", "url": "https://github.com/OpenLiberty/open-liberty/commit/7f9abc2b56e0b62437afd7464f0ca77cb5af2f51", "message": "refactor to use cfw FilterList objects", "committedDate": "2020-12-03T20:07:40Z", "type": "forcePushed"}, {"oid": "a90a8b81136e1b8ecb089d4f60d3c1ae66b9316c", "url": "https://github.com/OpenLiberty/open-liberty/commit/a90a8b81136e1b8ecb089d4f60d3c1ae66b9316c", "message": "update metatype and add messages for trustedHeaderOrigin update", "committedDate": "2020-12-11T17:40:07Z", "type": "forcePushed"}, {"oid": "268d72cc13e456bd5bfaf557a15b59dc8293c3d5", "url": "https://github.com/OpenLiberty/open-liberty/commit/268d72cc13e456bd5bfaf557a15b59dc8293c3d5", "message": "update unittests", "committedDate": "2020-12-14T15:05:13Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzcwMDg2NA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14661#discussion_r543700864", "bodyText": "Will 'trusted' be true if remoteAddr==null? Otherwise this line might potentially NPE since remoteAddr may not have been initialized in lines 2181-2182.", "author": "mrsaldana", "createdAt": "2020-12-15T21:31:30Z", "path": "dev/com.ibm.ws.transport.http/src/com/ibm/ws/http/channel/internal/HttpRequestMessageImpl.java", "diffHunk": "@@ -2178,16 +2178,15 @@ protected boolean filterAdd(HeaderKeys key, byte[] value) {\n     private boolean isPrivateHeaderTrusted(HeaderKeys key) {\n         HttpServiceContextImpl hisc = getServiceContext();\n         InetAddress remoteAddr = null;\n-        String address = null;\n-        if (hisc != null && (remoteAddr = hisc.getRemoteAddr()) != null) {\n-            address = remoteAddr.getHostAddress();\n+        if (hisc != null) {\n+            remoteAddr = hisc.getRemoteAddr();\n         }\n \n-        boolean trusted = HttpDispatcher.usePrivateHeaders(address, key.getName());\n+        boolean trusted = HttpDispatcher.usePrivateHeaders(remoteAddr, key.getName());\n \n         if (!trusted) {\n             if (TraceComponent.isAnyTracingEnabled() && tc.isDebugEnabled()) {\n-                Tr.debug(tc, \"isPrivateHeaderTrusted: \" + key.getName() + \" is not trusted for host \" + address);\n+                Tr.debug(tc, \"isPrivateHeaderTrusted: \" + key.getName() + \" is not trusted for host \" + remoteAddr.getHostAddress());", "originalCommit": "268d72cc13e456bd5bfaf557a15b59dc8293c3d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6172cd5570c3f0cb175f57db2b3b51b6c444408b", "url": "https://github.com/OpenLiberty/open-liberty/commit/6172cd5570c3f0cb175f57db2b3b51b6c444408b", "message": "code review comments", "committedDate": "2020-12-16T21:33:13Z", "type": "forcePushed"}, {"oid": "68e04a5baa0535338d12997a43a5002bfc2b800c", "url": "https://github.com/OpenLiberty/open-liberty/commit/68e04a5baa0535338d12997a43a5002bfc2b800c", "message": "code review updates: restore public APIs, add unittests", "committedDate": "2020-12-17T18:55:15Z", "type": "forcePushed"}, {"oid": "2f43eaf8bc6ddecd35725caa78d36119dafefd1a", "url": "https://github.com/OpenLiberty/open-liberty/commit/2f43eaf8bc6ddecd35725caa78d36119dafefd1a", "message": "support hostnames and wildcards for trusted*HeaderOrigin", "committedDate": "2021-01-05T17:11:54Z", "type": "commit"}, {"oid": "03e81d4ad1edf9ad75bc80891441f9c7e597acd6", "url": "https://github.com/OpenLiberty/open-liberty/commit/03e81d4ad1edf9ad75bc80891441f9c7e597acd6", "message": "update metatype and add messages for trustedHeaderOrigin update", "committedDate": "2021-01-05T17:11:54Z", "type": "commit"}, {"oid": "8f21ee237dad9aeb1a897e73d3bc7ef98aacb448", "url": "https://github.com/OpenLiberty/open-liberty/commit/8f21ee237dad9aeb1a897e73d3bc7ef98aacb448", "message": "update unittests", "committedDate": "2021-01-05T17:11:54Z", "type": "commit"}, {"oid": "a218e0b2ec487979079fe4d372cf47922f5e6981", "url": "https://github.com/OpenLiberty/open-liberty/commit/a218e0b2ec487979079fe4d372cf47922f5e6981", "message": "code review updates: restore public APIs, add unittests", "committedDate": "2021-01-05T17:11:55Z", "type": "commit"}, {"oid": "a218e0b2ec487979079fe4d372cf47922f5e6981", "url": "https://github.com/OpenLiberty/open-liberty/commit/a218e0b2ec487979079fe4d372cf47922f5e6981", "message": "code review updates: restore public APIs, add unittests", "committedDate": "2021-01-05T17:11:55Z", "type": "forcePushed"}, {"oid": "77d8f36dc18cf1a41efb311e1fd13b694d0a5406", "url": "https://github.com/OpenLiberty/open-liberty/commit/77d8f36dc18cf1a41efb311e1fd13b694d0a5406", "message": "message review comments", "committedDate": "2021-01-05T19:57:16Z", "type": "commit"}, {"oid": "c326647fc09204f90ec477013d9bff97aba94f21", "url": "https://github.com/OpenLiberty/open-liberty/commit/c326647fc09204f90ec477013d9bff97aba94f21", "message": "minor logging and readability improvements", "committedDate": "2021-01-10T14:34:56Z", "type": "commit"}]}