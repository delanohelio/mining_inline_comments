{"pr_number": 15196, "pr_title": "xmlClient-3.0/jaxwsClient-2.3 clientcontainer runtime updates", "pr_createdAt": "2020-12-07T06:29:48Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/15196", "timeline": [{"oid": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "url": "https://github.com/OpenLiberty/open-liberty/commit/b060abbfebc04abb43791dd6f2e25e4d63f31457", "message": "jaxwsClient-2.3 runtime update", "committedDate": "2020-12-07T06:35:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NjU0MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r537266540", "bodyText": "This code is identical to what's in the com.ibm.ws.jaxws.2.3.common bundle, but I intend to refactor all of the jaxws.2.x.common/jaxws.2.x.clientcontainer bundles to remove duplicate code.", "author": "neuwerk", "createdAt": "2020-12-07T06:45:33Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws/ConduitConfigurer.java", "diffHunk": "@@ -0,0 +1,213 @@\n+/**", "originalCommit": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NjYwMA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r537266600", "bodyText": "This code is identical to what's in the com.ibm.ws.jaxws.2.3.common bundle, but I intend to refactor all of the jaxws.2.x.common/jaxws.2.x.clientcontainer bundles to remove duplicate code.", "author": "neuwerk", "createdAt": "2020-12-07T06:45:43Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws/ConduitConfigurerService.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/**", "originalCommit": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NjY4OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r537266689", "bodyText": "This code is identical to what's in the com.ibm.ws.jaxws.2.3.common bundle, but I intend to refactor all of the jaxws.2.x.common/jaxws.2.x.clientcontainer bundles to remove duplicate code.", "author": "neuwerk", "createdAt": "2020-12-07T06:46:02Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws/JaxwsConduitConfigActivator.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/**", "originalCommit": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2Njc0NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r537266745", "bodyText": "This code is identical to what's in the com.ibm.ws.jaxws.2.3.common bundle, but I intend to refactor all of the jaxws.2.x.common/jaxws.2.x.clientcontainer bundles to remove duplicate code.", "author": "neuwerk", "createdAt": "2020-12-07T06:46:11Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws/JaxwsHttpConduitConfigApplier.java", "diffHunk": "@@ -0,0 +1,387 @@\n+/**", "originalCommit": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NzA0Ng==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r537267046", "bodyText": "Remove  unnecessary duplicate vars with final attribute", "author": "neuwerk", "createdAt": "2020-12-07T06:46:59Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws/bus/LibertyApplicationBusFactory.java", "diffHunk": "@@ -95,9 +106,16 @@ public LibertyApplicationBus createBus(Map<Class<?>, Object> e, Map<String, Obje\n \n         Bus originalBus = getThreadDefaultBus(false);\n \n+        final Map<Class<?>, Object> e1 = e;", "originalCommit": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NzM3Mw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r537267373", "bodyText": "Add a TODO to remove the LoggingInterceptors from the client and server, and switch to using the LoggingFeature", "author": "neuwerk", "createdAt": "2020-12-07T06:47:48Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws/bus/LibertyApplicationBusFactory.java", "diffHunk": "@@ -115,6 +133,16 @@ public LibertyApplicationBus createBus(Map<Class<?>, Object> e, Map<String, Obje\n             }\n \n             bus.initialize();\n+\n+            // Always register LibertyLoggingIn(Out)Interceptor Pretty print the SOAP Messages\n+            final LibertyLoggingInInterceptor in = new LibertyLoggingInInterceptor();", "originalCommit": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NzU1Mw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r537267553", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Copyright (c) 2012 IBM Corporation and others.\n          \n          \n            \n             * Copyright (c) 2012, 2020 IBM Corporation and others.", "author": "neuwerk", "createdAt": "2020-12-07T06:48:20Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws/client/injection/ServiceRefObjectFactory.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*******************************************************************************\n- * Copyright (c) 2019 IBM Corporation and others.\n+ * Copyright (c) 2012 IBM Corporation and others.", "originalCommit": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NzYyNw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r537267627", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Copyright (c) 2012 IBM Corporation and others.\n          \n          \n            \n             * Copyright (c) 2012,2020 IBM Corporation and others.", "author": "neuwerk", "createdAt": "2020-12-07T06:48:37Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws/client/injection/WebServiceRefBinding.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*******************************************************************************\n- * Copyright (c) 2019 IBM Corporation and others.\n+ * Copyright (c) 2012 IBM Corporation and others.", "originalCommit": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2OTIzNw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r537269237", "bodyText": "This change is simply the easiest way to test a jaxwsClient-2.3 feature, but will not be delivered once I've verified  that the runtime update is successful in a Personal Build.", "author": "neuwerk", "createdAt": "2020-12-07T06:52:45Z", "path": "dev/com.ibm.ws.jaxws.clientcontainer_fat/fat/src/com/ibm/ws/jaxws/clientcontainer/fat/FATSuite.java", "diffHunk": "@@ -25,4 +28,8 @@\n                 WsBndServiceRefOverrideTest.class\n })\n public class FATSuite {\n+    @ClassRule\n+    public static RepeatTests r = RepeatTests.withoutModification()\n+                    .andWith(FeatureReplacementAction.EE8_FEATURES());", "originalCommit": "b060abbfebc04abb43791dd6f2e25e4d63f31457", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3426fb7adc6c323f4cc77eb0f858ad182bb417b9", "url": "https://github.com/OpenLiberty/open-liberty/commit/3426fb7adc6c323f4cc77eb0f858ad182bb417b9", "message": "intial code review changes", "committedDate": "2020-12-10T19:27:22Z", "type": "forcePushed"}, {"oid": "4ac288de36320b53dbf1f1fd39a622ddd071cb35", "url": "https://github.com/OpenLiberty/open-liberty/commit/4ac288de36320b53dbf1f1fd39a622ddd071cb35", "message": "intial code review changes", "committedDate": "2020-12-11T05:34:29Z", "type": "forcePushed"}, {"oid": "f91d4b23dc53930bdc29382932fa0ce48f9206ba", "url": "https://github.com/OpenLiberty/open-liberty/commit/f91d4b23dc53930bdc29382932fa0ce48f9206ba", "message": "Add xmlWSClient-3.0 feature", "committedDate": "2020-12-15T19:37:40Z", "type": "forcePushed"}, {"oid": "993f60414cbe4ac9f95a1d19ffde9fc9aa066fa1", "url": "https://github.com/OpenLiberty/open-liberty/commit/993f60414cbe4ac9f95a1d19ffde9fc9aa066fa1", "message": "Add xmlWSClient-3.0 feature\n\nClean up jaxwsClient changes\n\nRemove doPriv dupped vars'\n\nfix missing import", "committedDate": "2020-12-15T20:35:42Z", "type": "forcePushed"}, {"oid": "d6ade2ea067848fda253db590a8da3490cb2717c", "url": "https://github.com/OpenLiberty/open-liberty/commit/d6ade2ea067848fda253db590a8da3490cb2717c", "message": "Add xmlWSClient-3.0 feature\n\nClean up jaxwsClient changes\n\nRemove doPriv dupped vars'\n\nfix missing import\n\nRemove unnecessary change", "committedDate": "2020-12-15T20:50:00Z", "type": "forcePushed"}, {"oid": "9506ca0bfa5edd175491dfd932b2f63e1a27bf44", "url": "https://github.com/OpenLiberty/open-liberty/commit/9506ca0bfa5edd175491dfd932b2f63e1a27bf44", "message": "Add xmlWSClient-3.0 feature\n\nClean up jaxwsClient changes\n\nRemove doPriv dupped vars'\n\nfix missing import\n\nRemove unnecessary change\n\nPB fixes and bringing in needed dependencies\n\nAdd proper versioning", "committedDate": "2020-12-16T16:54:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDYzMjkwMQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r544632901", "bodyText": "Should be fixed in com.ibm.ws.jaxws.clientcontainer, com.ibm.ws.jaxrs.2.0.common and com.ibm.ws.org.apache.cxf.cxf.rt.frontend.jaxrs.3.2 components as well?", "author": "jhanders34", "createdAt": "2020-12-16T21:23:47Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws/bus/LibertyApplicationBusFactory.java", "diffHunk": "@@ -242,7 +268,7 @@ public void postShutdown() {\n         @Override\n         public void preShutdown() {\n             for (LibertyApplicationBusListener listener : listeners) {\n-                listener.postShutdown(bus);\n+                listener.preShutdown(bus);", "originalCommit": "9506ca0bfa5edd175491dfd932b2f63e1a27bf44", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDcwODAwNg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r544708006", "bodyText": "Yes, good catch.", "author": "neuwerk", "createdAt": "2020-12-16T23:54:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDYzMjkwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDY4NjY3OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r544686679", "bodyText": "In the common component we renamed this to be Security instead of SSL", "author": "jhanders34", "createdAt": "2020-12-16T23:03:23Z", "path": "dev/com.ibm.ws.jaxws.2.3.clientcontainer/src/com/ibm/ws/jaxws23/client/security/LibertyJaxWsClientSSLOutInterceptor.java", "diffHunk": "@@ -0,0 +1,241 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+package com.ibm.ws.jaxws23.client.security;\n+\n+import java.io.IOException;\n+import java.lang.reflect.Method;\n+import java.security.AccessController;\n+import java.security.PrivilegedAction;\n+import java.security.PrivilegedExceptionAction;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.atomic.AtomicReference;\n+\n+import javax.net.ssl.SSLSocketFactory;\n+import javax.xml.namespace.QName;\n+\n+import org.apache.cxf.common.util.PropertyUtils;\n+import org.apache.cxf.common.util.StringUtils;\n+import org.apache.cxf.configuration.jsse.TLSClientParameters;\n+import org.apache.cxf.interceptor.Fault;\n+import org.apache.cxf.message.Message;\n+import org.apache.cxf.phase.AbstractPhaseInterceptor;\n+import org.apache.cxf.transport.Conduit;\n+import org.apache.cxf.transport.http.HTTPConduit;\n+import org.apache.cxf.transports.http.configuration.HTTPClientPolicy;\n+import org.apache.cxf.ws.addressing.EndpointReferenceType;\n+\n+import com.ibm.websphere.ras.Tr;\n+import com.ibm.websphere.ras.TraceComponent;\n+import com.ibm.ws.jaxws.metadata.ConfigProperties;\n+import com.ibm.ws.jaxws.metadata.PortComponentRefInfo;\n+import com.ibm.ws.jaxws.metadata.WebServiceRefInfo;\n+import com.ibm.ws.jaxws.security.JaxWsSecurityConfigurationService;\n+import com.ibm.wsspi.kernel.service.utils.AtomicServiceReference;\n+\n+import org.apache.cxf.Bus;\n+import org.apache.cxf.interceptor.Fault;\n+import org.apache.cxf.message.Message;\n+import org.apache.cxf.phase.AbstractPhaseInterceptor;\n+import org.apache.cxf.phase.Phase;\n+import org.apache.cxf.service.model.EndpointInfo;\n+import org.apache.cxf.transport.Conduit;\n+import org.apache.cxf.transport.http.HTTPConduit;\n+import org.apache.cxf.transport.http.HTTPConduitConfigurer;\n+import org.osgi.service.cm.ConfigurationException;\n+import org.osgi.service.cm.ManagedServiceFactory;\n+\n+import com.ibm.websphere.ras.ProtectedString;\n+import com.ibm.websphere.ras.Tr;\n+import com.ibm.websphere.ras.TraceComponent;\n+import com.ibm.websphere.ras.annotation.Sensitive;\n+import com.ibm.ws.jaxws.JaxWsConstants;\n+import com.ibm.ws.jaxws.metadata.ConfigProperties;\n+import com.ibm.ws.jaxws.metadata.PortComponentRefInfo;\n+import com.ibm.ws.jaxws.metadata.WebServiceRefInfo;\n+import com.ibm.ws.jaxws.security.JaxWsSecurityConfigurationService;\n+\n+/**\n+ * Used to set the SSL config on the Client side conduit. This removes the need to modify the\n+ * HttpConduit directly through an extended LibertyHttpConduit \n+ */\n+public class LibertyJaxWsClientSSLOutInterceptor extends AbstractPhaseInterceptor<Message> {", "originalCommit": "c0133534f970eb84111f82164f68c623fa686461", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDcxMDMwNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r544710305", "bodyText": "I hadn't intended this to remain when I pulled in my changes from the other PR, I will fix it.", "author": "neuwerk", "createdAt": "2020-12-17T00:00:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDY4NjY3OQ=="}], "type": "inlineReview"}, {"oid": "fa05ae1595eb2bd00dc6f1c2cf4aa6ee1a7e8777", "url": "https://github.com/OpenLiberty/open-liberty/commit/fa05ae1595eb2bd00dc6f1c2cf4aa6ee1a7e8777", "message": "Updates to get xmlWS working more\n\n- Updates to get xml files to parse correctly\n- Transformation updates for both soap and jaxb\n- Transform com.ibm.ws.jaxws.tools\n- Updates to do proper replacement for jaxws-2.2 when doing EE9 testing\n\nCode review changes", "committedDate": "2020-12-17T01:53:58Z", "type": "forcePushed"}, {"oid": "0a827ccef06eda7a1cb23892303a340919b57960", "url": "https://github.com/OpenLiberty/open-liberty/commit/0a827ccef06eda7a1cb23892303a340919b57960", "message": "Update jaxws.2.3.common to implement missing methods", "committedDate": "2020-12-17T18:01:43Z", "type": "commit"}, {"oid": "1b505c70937f277372053683cb7c113a18a1f86c", "url": "https://github.com/OpenLiberty/open-liberty/commit/1b505c70937f277372053683cb7c113a18a1f86c", "message": "jaxwsClient-2.3 runtime update", "committedDate": "2020-12-17T18:01:44Z", "type": "commit"}, {"oid": "07e3e3ef8169ccf82b4d464602548a00e95a411e", "url": "https://github.com/OpenLiberty/open-liberty/commit/07e3e3ef8169ccf82b4d464602548a00e95a411e", "message": "intial code review changes", "committedDate": "2020-12-17T18:01:45Z", "type": "commit"}, {"oid": "d236f12fc0906e2a9d7a44e170a3b55177b25751", "url": "https://github.com/OpenLiberty/open-liberty/commit/d236f12fc0906e2a9d7a44e170a3b55177b25751", "message": "Add xmlWSClient-3.0 feature\n\nClean up jaxwsClient changes\n\nRemove doPriv dupped vars'\n\nfix missing import\n\nRemove unnecessary change\n\nPB fixes and bringing in needed dependencies\n\nAdd proper versioning", "committedDate": "2020-12-17T18:01:45Z", "type": "commit"}, {"oid": "32710d8e95feb94ed007162b7c697a450a6068a8", "url": "https://github.com/OpenLiberty/open-liberty/commit/32710d8e95feb94ed007162b7c697a450a6068a8", "message": "Updates to get xmlWS working more\n\n- Updates to get xml files to parse correctly\n- Transformation updates for both soap and jaxb\n- Transform com.ibm.ws.jaxws.tools\n- Updates to do proper replacement for jaxws-2.2 when doing EE9 testing\n\nCode review changes", "committedDate": "2020-12-17T18:01:46Z", "type": "commit"}, {"oid": "82b858f4e32b74e6fc3ba1bd4515f3d274a6d2c5", "url": "https://github.com/OpenLiberty/open-liberty/commit/82b858f4e32b74e6fc3ba1bd4515f3d274a6d2c5", "message": "More code review clean up\n\nCode review changes continued\n\n...yet more fixes\n\nRemove feature default\n\nRemove additional feature disable\n\nRemove duplicate cxf client bundle from jaxrs-2.1 features", "committedDate": "2020-12-17T18:01:50Z", "type": "commit"}, {"oid": "82b858f4e32b74e6fc3ba1bd4515f3d274a6d2c5", "url": "https://github.com/OpenLiberty/open-liberty/commit/82b858f4e32b74e6fc3ba1bd4515f3d274a6d2c5", "message": "More code review clean up\n\nCode review changes continued\n\n...yet more fixes\n\nRemove feature default\n\nRemove additional feature disable\n\nRemove duplicate cxf client bundle from jaxrs-2.1 features", "committedDate": "2020-12-17T18:01:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMxMzc3Ng==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r545313776", "bodyText": "Good catch!", "author": "andymc12", "createdAt": "2020-12-17T18:35:54Z", "path": "dev/com.ibm.ws.jaxrs.2.0.common/src/com/ibm/ws/jaxrs20/bus/LibertyApplicationBusFactory.java", "diffHunk": "@@ -260,7 +260,7 @@ public void postShutdown() {\n         @Override\n         public void preShutdown() {\n             for (LibertyApplicationBusListener listener : listeners) {\n-                listener.postShutdown(bus);\n+                listener.preShutdown(bus);", "originalCommit": "82b858f4e32b74e6fc3ba1bd4515f3d274a6d2c5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMyNzc5Mw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/15196#discussion_r545327793", "bodyText": "\ud83d\udc4d", "author": "andymc12", "createdAt": "2020-12-17T18:56:22Z", "path": "dev/com.ibm.ws.org.apache.cxf.cxf.rt.frontend.jaxrs.3.2/src/com/ibm/ws/jaxrs20/bus/LibertyApplicationBusFactory.java", "diffHunk": "@@ -260,7 +260,7 @@ public void postShutdown() {\n         @Override\n         public void preShutdown() {\n             for (LibertyApplicationBusListener listener : listeners) {\n-                listener.postShutdown(bus);\n+                listener.preShutdown(bus);", "originalCommit": "82b858f4e32b74e6fc3ba1bd4515f3d274a6d2c5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a1b8ea2b02b01831560495680d5a529fbe774080", "url": "https://github.com/OpenLiberty/open-liberty/commit/a1b8ea2b02b01831560495680d5a529fbe774080", "message": "Code review changes", "committedDate": "2020-12-17T21:55:22Z", "type": "commit"}]}