{"pr_number": 12935, "pr_title": "Issue 12934: Initial ejbLite-4.0 implemenation", "pr_createdAt": "2020-07-08T04:11:48Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/12935", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM4NjUxMg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12935#discussion_r451386512", "bodyText": "I created an convenience method for this that you might wish to try...\n\n  \n    \n      open-liberty/dev/fattest.simplicity/src/componenttest/rules/repeater/EERepeatTests.java\n    \n    \n         Line 61\n      in\n      654502a\n    \n    \n    \n    \n\n        \n          \n           public static RepeatTests with(String serverName, EEVersion version, EEVersion... otherVersions) {", "author": "tevans78", "createdAt": "2020-07-08T08:51:16Z", "path": "dev/com.ibm.ws.ejbcontainer.session.passivation_fat/fat/src/com/ibm/ws/ejbcontainer/session/passivation/tests/StatefulTimeoutTest.java", "diffHunk": "@@ -48,7 +49,7 @@ public LibertyServer getServer() {\n     }\n \n     @ClassRule\n-    public static RepeatTests r = RepeatTests.with(FeatureReplacementAction.EE7_FEATURES().forServers(\"com.ibm.ws.ejbcontainer.session.passivation.fat.sfTimeout\")).andWith(FeatureReplacementAction.EE8_FEATURES().forServers(\"com.ibm.ws.ejbcontainer.session.passivation.fat.sfTimeout\"));\n+    public static RepeatTests r = RepeatTests.with(FeatureReplacementAction.EE7_FEATURES().forServers(\"com.ibm.ws.ejbcontainer.session.passivation.fat.sfTimeout\")).andWith(FeatureReplacementAction.EE8_FEATURES().forServers(\"com.ibm.ws.ejbcontainer.session.passivation.fat.sfTimeout\")).andWith(new JakartaEE9Action().forServers(\"com.ibm.ws.ejbcontainer.session.passivation.fat.sfTimeout\"));", "originalCommit": "eeaeb5a22b876d29c1401161321dbcd408ec6c7e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3OTE5NA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12935#discussion_r451579194", "bodyText": "@tevans78 That is a nice convenience method, but I generally try to adhere to the FAT guidelines that indicate FAT should only run one repeat action in lite mode, the others in full mode.  I had overlooked that this test was repeating both 7 and 8 in lite mode already..... I've updated the test to repeat ee7 in full mode only.  For now, it will run both ee8 and ee9 in lite mode, as I don't want to lose the ee8 since it is the ga version, but would like to get some minimal ee9 testing.\nPerhaps that convenience method could be updated to allow passing in something like (\"myserver\", EE7-FF, EE8, EE9-FF), to allow designating some to repeat full fat only?  We like to switch things up a bit, always have some FAT run lite mode for  EE7, some EE8, and eventually some EE9, but the majority run the latest ga in lite.", "author": "tkburroughs", "createdAt": "2020-07-08T14:15:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM4NjUxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM5Mjk0Nw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12935#discussion_r451392947", "bodyText": "The wiki doesn't have an example for a version specific package name but how about\nio.openliberty.ejb.internal.container.v40?", "author": "tevans78", "createdAt": "2020-07-08T09:01:19Z", "path": "dev/io.openliberty.ejbcontainer.v40/src/io/openliberty/ejbcontainer/v40/internal/EJBRuntimeVersionV40.java", "diffHunk": "@@ -0,0 +1,19 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+package io.openliberty.ejbcontainer.v40.internal;", "originalCommit": "eeaeb5a22b876d29c1401161321dbcd408ec6c7e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTYzMjQyNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12935#discussion_r451632425", "bodyText": "@tevans78 see my above comments. I consider this a \"component\" project not directly related to a specific public \"ejb\" feature.  I view \".ejb.\" in the package name to be too ambiguous.  Using \"ejbcotnainer\" makes it easier to identify which aspec of EJB, Managed Beans, and MDB this relates to.... the EJB container, not EJB security, or EJB integration with CDI, JAX-RS, WebContainer, etc.\nI prefer to include the full \"component\" (i.e. project name) prior to the \"internal\".  Seems to make it easier to avoid multiple project/bundles ever exporting the same package.  Also, with the other ejbcontainer projects, I assume this view would make more sense:\nio.openliberty.ejbcontainer.async\nio.openliberty.ejbcontainer.async.spi\nio.openliberty.ejbcontainer.async.internal\nio.openliberty.ejbcontainer.timer\nio.openliberty.ejbcontainer.timer.spi\nio.openliberty.ejbcontainer.timer.internal\nio.openliberty.ejbcontainer.v40\nio.openliberty.ejbcontainer.v40.spi\nio.openliberty.ejbcontainer.v40.internal\nKeep in mind that these are all related to a component, like \"transactions\", which are included by many features, some with \"ejb\" in the name, and some not, like \"mdb\" and \"managedBeans\".", "author": "tkburroughs", "createdAt": "2020-07-08T15:27:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM5Mjk0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY1NTk2Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12935#discussion_r451655962", "bodyText": "Agreed. I like your examples so I may use those in the wiki. Just need to try and define what a \"component\" is??", "author": "tevans78", "createdAt": "2020-07-08T16:01:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM5Mjk0Nw=="}], "type": "inlineReview"}, {"oid": "8fcd32e030d2bb7138ef6cc3b022f43b5b9046f9", "url": "https://github.com/OpenLiberty/open-liberty/commit/8fcd32e030d2bb7138ef6cc3b022f43b5b9046f9", "message": "Issue 12934: Initial ejbLite-4.0 implemenation\n\nAdd necessary transforms for jakarta ee and add required\nfeatures to support ejbLite-4.0\n\nEnabled one basic test using repeat action.", "committedDate": "2020-07-08T14:07:37Z", "type": "forcePushed"}, {"oid": "29da03e33585922d782f40b6dafa786ba02d8376", "url": "https://github.com/OpenLiberty/open-liberty/commit/29da03e33585922d782f40b6dafa786ba02d8376", "message": "Issue 12934: Initial ejbLite-4.0 implemenation\n\nAdd necessary transforms for jakarta ee and add required\nfeatures to support ejbLite-4.0\n\nEnabled one basic test using repeat action.", "committedDate": "2020-07-08T17:07:53Z", "type": "commit"}, {"oid": "29da03e33585922d782f40b6dafa786ba02d8376", "url": "https://github.com/OpenLiberty/open-liberty/commit/29da03e33585922d782f40b6dafa786ba02d8376", "message": "Issue 12934: Initial ejbLite-4.0 implemenation\n\nAdd necessary transforms for jakarta ee and add required\nfeatures to support ejbLite-4.0\n\nEnabled one basic test using repeat action.", "committedDate": "2020-07-08T17:07:53Z", "type": "forcePushed"}]}