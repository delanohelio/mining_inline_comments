{"pr_number": 12238, "pr_title": "Issue 11916: Bean Validation 3.0 initial drop.", "pr_createdAt": "2020-05-18T18:52:58Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/12238", "timeline": [{"oid": "91eca976b4859d1dcd0081fd012e231d4ea02438", "url": "https://github.com/OpenLiberty/open-liberty/commit/91eca976b4859d1dcd0081fd012e231d4ea02438", "message": "Issue 11916: Bean Validation 3.0 initial drop.", "committedDate": "2020-05-28T15:05:07Z", "type": "forcePushed"}, {"oid": "cf73e8e7333d18234461fa427ff004438103b514", "url": "https://github.com/OpenLiberty/open-liberty/commit/cf73e8e7333d18234461fa427ff004438103b514", "message": "Issue 11916: Bean Validation 3.0 initial drop.", "committedDate": "2020-05-28T15:23:03Z", "type": "forcePushed"}, {"oid": "1185e54cd20c744ca87cf9c4fdd34e1f61264429", "url": "https://github.com/OpenLiberty/open-liberty/commit/1185e54cd20c744ca87cf9c4fdd34e1f61264429", "message": "Issue 11916: Bean Validation 3.0 initial drop.", "committedDate": "2020-05-28T15:25:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2ODMyMg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12238#discussion_r432168322", "bodyText": "Are we tracking this in any github issues? Perhaps under the CDI epic for EE9?", "author": "aguibert", "createdAt": "2020-05-28T22:56:25Z", "path": "dev/com.ibm.ws.beanvalidation.v11_fat/fat/src/com/ibm/ws/beanvalidation/fat/cdi/BeanValidation20CDITest.java", "diffHunk": "@@ -33,6 +34,8 @@\n  */\n @RunWith(FATRunner.class)\n @MinimumJavaLevel(javaLevel = 8)\n+// TODO: Remove skip when injection is enabled for jakartaee9", "originalCommit": "cd23f534df9249f6043b2270b20acf956c756e69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjcxMTg0Ng==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12238#discussion_r432711846", "bodyText": "Yes, #12434 and #12435", "author": "nmittles", "createdAt": "2020-05-29T20:10:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2ODMyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2ODYxNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12238#discussion_r432168615", "bodyText": "Perhaps a simpler way to do this check is:\nif (!JakartaEE9Action.isActive()) {", "author": "aguibert", "createdAt": "2020-05-28T22:57:17Z", "path": "dev/com.ibm.ws.beanvalidation.v11_fat/fat/src/com/ibm/ws/beanvalidation/fat/ejb/EJBModule_Common.java", "diffHunk": "@@ -36,6 +38,12 @@ public static void createAndExportEJBWARs(LibertyServer server) throws Exception\n         JavaArchive jar = ShrinkHelper.buildJavaArchive(\"EJBModule1EJB.jar\", \"beanvalidation.ejbmodule.*\");\n         JavaArchive jar2 = ShrinkHelper.buildJavaArchive(\"EJBModule2EJB.jar\", \"beanvalidation.ejbmodule2.ejb\");\n \n+        Set<String> features = server.getServerConfiguration().getFeatureManager().getFeatures();\n+        if (!(features.contains(\"beanValidation-1.0\") || features.contains(\"beanValidation-1.1\") || features.contains(\"beanValidation-2.0\"))) {", "originalCommit": "cd23f534df9249f6043b2270b20acf956c756e69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ5NjU2MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12238#discussion_r432496561", "bodyText": "Thanks, that would be better.", "author": "nmittles", "createdAt": "2020-05-29T13:51:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2ODYxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE3MDUzNg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12238#discussion_r432170536", "bodyText": "We don't want to disable these tests outright because we will lose coverage for bval-2.0 in the short term.\nInstead, can we just disable these tests using @SkipForRepeat on the test servlet class? Currently you can use @SkipForRepeat on test servlet methods, but not at the class level. It would be nice to have class-level support, but if that's too much work you could just add the annotation on each test servlet method instead", "author": "aguibert", "createdAt": "2020-05-28T23:02:58Z", "path": "dev/com.ibm.ws.beanvalidation.v20_fat/fat/src/com/ibm/ws/bval/v20/fat/BeanVal20Test.java", "diffHunk": "@@ -54,43 +40,52 @@\n     @Server(\"beanval.v20_fat\")\n     @TestServlets({\n                     @TestServlet(servlet = BeanVal20TestServlet.class, contextRoot = REG_APP),\n-                    @TestServlet(servlet = BeanValCDIServlet.class, contextRoot = CDI_APP),\n-                    @TestServlet(servlet = BeanValidationTestServlet.class, contextRoot = MULTI_VAL_APP),\n-                    @TestServlet(servlet = ValueExtractorServlet.class, contextRoot = VAL_EXT_APP),\n+                    //TODO: Once CDI 3.0 and EJBLite 4.0 are ready, enable these four applications for Jakarta EE 9.\n+//                    @TestServlet(servlet = BeanValCDIServlet.class, contextRoot = CDI_APP),", "originalCommit": "cd23f534df9249f6043b2270b20acf956c756e69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ5MDIzMA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12238#discussion_r432490230", "bodyText": "The tests are temporarily disabled here. They have been moved to their own test class that only runs for bval 1.1 and bval 2.0, so we don't lose coverage.", "author": "nmittles", "createdAt": "2020-05-29T13:41:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE3MDUzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE3MTc5NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12238#discussion_r432171795", "bodyText": "I guess this is a good compromise. If you are interested though, the class-level support for @SkipForRepeat on test servlets would be nice", "author": "aguibert", "createdAt": "2020-05-28T23:07:08Z", "path": "dev/com.ibm.ws.beanvalidation.v20_fat/fat/src/com/ibm/ws/bval/v20/fat/BeanVal20_CDI_EJB_Test.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+package com.ibm.ws.bval.v20.fat;\n+\n+import static com.ibm.websphere.simplicity.ShrinkHelper.addDirectory;\n+import static com.ibm.websphere.simplicity.ShrinkHelper.buildDefaultApp;\n+import static com.ibm.websphere.simplicity.ShrinkHelper.buildJavaArchive;\n+import static com.ibm.websphere.simplicity.ShrinkHelper.defaultDropinApp;\n+import static com.ibm.websphere.simplicity.ShrinkHelper.exportToServer;\n+\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.spec.EnterpriseArchive;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.junit.AfterClass;\n+import org.junit.Assert;\n+import org.junit.BeforeClass;\n+import org.junit.runner.RunWith;\n+\n+import com.ibm.websphere.simplicity.ShrinkHelper;\n+\n+import bval.v20.cdi.web.BeanValCDIServlet;\n+import bval.v20.customprovider.CustomProviderTestServlet;\n+import bval.v20.multixml.web.BeanValidationTestServlet;\n+import bval.v20.valueextractor.web.ValueExtractorServlet;\n+import componenttest.annotation.Server;\n+import componenttest.annotation.SkipForRepeat;\n+import componenttest.annotation.TestServlet;\n+import componenttest.annotation.TestServlets;\n+import componenttest.custom.junit.runner.FATRunner;\n+import componenttest.topology.impl.LibertyServer;\n+import componenttest.topology.utils.FATServletClient;\n+\n+//TODO: Delete this class and re-enable these tests in BeanVal20Test once CDI 3.0 and EJBLite 4.0 are ready.\n+@SkipForRepeat({ SkipForRepeat.EE9_FEATURES })\n+@RunWith(FATRunner.class)\n+public class BeanVal20_CDI_EJB_Test extends FATServletClient {", "originalCommit": "cd23f534df9249f6043b2270b20acf956c756e69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ4OTEzMw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12238#discussion_r432489133", "bodyText": "I couldn't get the class-level support for the @SkipForRepeat to work since that required the applications to start, and these apps depend on CDI and EJB to start up.", "author": "nmittles", "createdAt": "2020-05-29T13:40:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE3MTc5NQ=="}], "type": "inlineReview"}, {"oid": "14392b65d83122f9ec2ad759b5b6f67c720b39da", "url": "https://github.com/OpenLiberty/open-liberty/commit/14392b65d83122f9ec2ad759b5b6f67c720b39da", "message": "Code review updates.", "committedDate": "2020-05-29T20:15:27Z", "type": "forcePushed"}, {"oid": "95d21e6cc80ec2d63c293fc90d06acaffd75fd2a", "url": "https://github.com/OpenLiberty/open-liberty/commit/95d21e6cc80ec2d63c293fc90d06acaffd75fd2a", "message": "Code review updates.", "committedDate": "2020-05-29T20:21:51Z", "type": "forcePushed"}, {"oid": "9c09a4d569bf7abe8af12d2813217e484d94fcde", "url": "https://github.com/OpenLiberty/open-liberty/commit/9c09a4d569bf7abe8af12d2813217e484d94fcde", "message": "Minor fixes for feature checker and bvt tests.", "committedDate": "2020-06-08T15:22:49Z", "type": "forcePushed"}, {"oid": "4469f4a09cdc89d979b0531fdbbf54396380b61a", "url": "https://github.com/OpenLiberty/open-liberty/commit/4469f4a09cdc89d979b0531fdbbf54396380b61a", "message": "Minor fixes for feature checker and bvt tests.", "committedDate": "2020-06-08T15:43:31Z", "type": "forcePushed"}, {"oid": "7893ce83e68e12563ba69a802ec887af61b59336", "url": "https://github.com/OpenLiberty/open-liberty/commit/7893ce83e68e12563ba69a802ec887af61b59336", "message": "Cleanup ejbLite from EE8FeatureReplacementAction and EE7FeatureReplacementAction.", "committedDate": "2020-06-16T04:40:25Z", "type": "forcePushed"}, {"oid": "89975a34d20d80319950461844007b94825665bc", "url": "https://github.com/OpenLiberty/open-liberty/commit/89975a34d20d80319950461844007b94825665bc", "message": "com.ibm.websphere.appserver.jakarta.cdi-3.0 was renamed to io.openliberty...\ncdi-3.0 public feature now exists.", "committedDate": "2020-06-16T13:49:45Z", "type": "forcePushed"}, {"oid": "373051a777868b004205fadb822ec47fc0991840", "url": "https://github.com/OpenLiberty/open-liberty/commit/373051a777868b004205fadb822ec47fc0991840", "message": "Interceptor-2.0 was renamed to jakarta naming scheme. Fixed alphabetization.", "committedDate": "2020-06-22T07:54:48Z", "type": "forcePushed"}, {"oid": "aa9cde33443517a50eccc404459422b985933c13", "url": "https://github.com/OpenLiberty/open-liberty/commit/aa9cde33443517a50eccc404459422b985933c13", "message": "Interceptor-2.0 was renamed to jakarta naming scheme. Fixed alphabetization.", "committedDate": "2020-06-24T19:12:29Z", "type": "forcePushed"}, {"oid": "7ede683b8694cd77fed9aedb694cf329ba83c040", "url": "https://github.com/OpenLiberty/open-liberty/commit/7ede683b8694cd77fed9aedb694cf329ba83c040", "message": "Interceptor-2.0 was renamed to jakarta naming scheme. Fixed alphabetization.", "committedDate": "2020-06-24T19:15:51Z", "type": "forcePushed"}, {"oid": "8c43c02fce278941366e515037211f7698698d38", "url": "https://github.com/OpenLiberty/open-liberty/commit/8c43c02fce278941366e515037211f7698698d38", "message": "Issue 11916: Bean Validation 3.0 initial drop.", "committedDate": "2020-06-25T13:20:58Z", "type": "commit"}, {"oid": "f2b4b76743c467923584a6098a1714a94c7bebbf", "url": "https://github.com/OpenLiberty/open-liberty/commit/f2b4b76743c467923584a6098a1714a94c7bebbf", "message": "Rename of bean validation bundle and features to io.openliberty scheme. Also added beanValidation-3.0 to jakartaeeClient-9.0 and webProfile-9.0.", "committedDate": "2020-06-25T13:20:59Z", "type": "commit"}, {"oid": "db92ec2e42fedf2e5757b9181596d2258c6fa377", "url": "https://github.com/OpenLiberty/open-liberty/commit/db92ec2e42fedf2e5757b9181596d2258c6fa377", "message": "Code review updates.", "committedDate": "2020-06-25T13:20:59Z", "type": "commit"}, {"oid": "2bfd6dcf8bf2be98d4f4c09423e61d5fc0b2cae9", "url": "https://github.com/OpenLiberty/open-liberty/commit/2bfd6dcf8bf2be98d4f4c09423e61d5fc0b2cae9", "message": "Minor fixes for feature checker and bvt tests.", "committedDate": "2020-06-25T13:20:59Z", "type": "commit"}, {"oid": "53b9ca9f5700d591ad3724779649a863c4039365", "url": "https://github.com/OpenLiberty/open-liberty/commit/53b9ca9f5700d591ad3724779649a863c4039365", "message": "Cleanup ejbLite from EE8FeatureReplacementAction and EE7FeatureReplacementAction.", "committedDate": "2020-06-25T13:21:00Z", "type": "commit"}, {"oid": "780970ebf10e76be384789103c6217d2fdeb544b", "url": "https://github.com/OpenLiberty/open-liberty/commit/780970ebf10e76be384789103c6217d2fdeb544b", "message": "com.ibm.websphere.appserver.jakarta.cdi-3.0 was renamed to io.openliberty...\ncdi-3.0 public feature now exists.", "committedDate": "2020-06-25T13:21:00Z", "type": "commit"}, {"oid": "2430ca4bef6b78176f099e2df4c7661da1795d50", "url": "https://github.com/OpenLiberty/open-liberty/commit/2430ca4bef6b78176f099e2df4c7661da1795d50", "message": "Interceptor-2.0 was renamed to jakarta naming scheme. Fixed alphabetization. Added CDI 3.0 support.", "committedDate": "2020-06-25T14:09:57Z", "type": "commit"}, {"oid": "2430ca4bef6b78176f099e2df4c7661da1795d50", "url": "https://github.com/OpenLiberty/open-liberty/commit/2430ca4bef6b78176f099e2df4c7661da1795d50", "message": "Interceptor-2.0 was renamed to jakarta naming scheme. Fixed alphabetization. Added CDI 3.0 support.", "committedDate": "2020-06-25T14:09:57Z", "type": "forcePushed"}]}