{"pr_number": 14899, "pr_title": "refactor how SPI extensions are initilized", "pr_createdAt": "2020-11-10T12:26:44Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/14899", "timeline": [{"oid": "4ca8425e2191142f878fe1f41ac908682ec63538", "url": "https://github.com/OpenLiberty/open-liberty/commit/4ca8425e2191142f878fe1f41ac908682ec63538", "message": "refactor how SPI extensions are initilized", "committedDate": "2020-11-10T12:28:19Z", "type": "forcePushed"}, {"oid": "d01c304f6010ad428fd4ef4cab0f25e153ebad83", "url": "https://github.com/OpenLiberty/open-liberty/commit/d01c304f6010ad428fd4ef4cab0f25e153ebad83", "message": "refactor how SPI extensions are initilized", "committedDate": "2020-11-10T12:29:03Z", "type": "forcePushed"}, {"oid": "37d3ff017b742c60d3268a0c5be520bff66f2793", "url": "https://github.com/OpenLiberty/open-liberty/commit/37d3ff017b742c60d3268a0c5be520bff66f2793", "message": "refactor how SPI extensions are initilized", "committedDate": "2020-11-10T12:29:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcxNTc5OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14899#discussion_r520715799", "bodyText": "If we're adding this requirement, it should be added to the javadoc for CDIExtensionMetadata.\nCurrently it says that the result of getBeanClasses() must be in the same archive, but doesn't say this for getExtensionClasses().", "author": "Azquelt", "createdAt": "2020-11-10T16:52:42Z", "path": "dev/com.ibm.ws.cdi.weld/src/com/ibm/ws/cdi/impl/CDIContainerImpl.java", "diffHunk": "@@ -632,10 +632,28 @@ private ExtensionArchive newSPIExtensionArchive(ServiceReference<CDIExtensionMet\n         Bundle bundle = sr.getBundle();\n \n         Set<Class<? extends Extension>> extensionClasses = webSphereCDIExtensionMetaData.getExtensions();\n+        Set<Class<?>> beanClasses = webSphereCDIExtensionMetaData.getBeanClasses();\n+\n+        for (Iterator<Class<? extends Extension>> i = extensionClasses.iterator(); i.hasNext();) {\n+            Class extensionClass = i.next();\n+            if (extensionClass.getClassLoader() != webSphereCDIExtensionMetaData.getClass().getClassLoader()) {\n+                i.remove();\n+                Tr.error(tc, \"spi.extension.class.in.different.bundle.CWOWB1011E\", extensionClass.getCanonicalName());\n+            }\n+        }", "originalCommit": "8793e10294d620206b9e7727dff88fed1680950e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c2508ce3d2f0620dba5181da561b976474650df5", "url": "https://github.com/OpenLiberty/open-liberty/commit/c2508ce3d2f0620dba5181da561b976474650df5", "message": "Enforce same bundle restriction", "committedDate": "2020-11-11T10:58:33Z", "type": "forcePushed"}, {"oid": "7d77676aa8ddb5ab560418687c47331f123f291b", "url": "https://github.com/OpenLiberty/open-liberty/commit/7d77676aa8ddb5ab560418687c47331f123f291b", "message": "Enforce same bundle restriction", "committedDate": "2020-11-11T23:56:22Z", "type": "forcePushed"}, {"oid": "c9a2a7fbd3380020e616c557aa40722584ac0ac3", "url": "https://github.com/OpenLiberty/open-liberty/commit/c9a2a7fbd3380020e616c557aa40722584ac0ac3", "message": "refactor how SPI extensions are initilized", "committedDate": "2020-11-12T11:24:00Z", "type": "commit"}, {"oid": "45e54f216be673d7144fba375a57e1c71c17cc0c", "url": "https://github.com/OpenLiberty/open-liberty/commit/45e54f216be673d7144fba375a57e1c71c17cc0c", "message": "Enforce same bundle restriction", "committedDate": "2020-11-12T11:24:05Z", "type": "commit"}, {"oid": "45e54f216be673d7144fba375a57e1c71c17cc0c", "url": "https://github.com/OpenLiberty/open-liberty/commit/45e54f216be673d7144fba375a57e1c71c17cc0c", "message": "Enforce same bundle restriction", "committedDate": "2020-11-12T11:24:05Z", "type": "forcePushed"}, {"oid": "93e5db7d0e9afe7d4ec4c7b4e9f93b1b12da774f", "url": "https://github.com/OpenLiberty/open-liberty/commit/93e5db7d0e9afe7d4ec4c7b4e9f93b1b12da774f", "message": "Update copyrights and message", "committedDate": "2020-11-13T10:55:08Z", "type": "commit"}, {"oid": "93e5db7d0e9afe7d4ec4c7b4e9f93b1b12da774f", "url": "https://github.com/OpenLiberty/open-liberty/commit/93e5db7d0e9afe7d4ec4c7b4e9f93b1b12da774f", "message": "Update copyrights and message", "committedDate": "2020-11-13T10:55:08Z", "type": "forcePushed"}, {"oid": "435be30f7380b3adec4c862c27764e8228565056", "url": "https://github.com/OpenLiberty/open-liberty/commit/435be30f7380b3adec4c862c27764e8228565056", "message": "message review changes", "committedDate": "2020-12-16T10:09:34Z", "type": "commit"}]}