{"pr_number": 12893, "pr_title": "Change logging.json_fat tests to check trace for server config update \u2026", "pr_createdAt": "2020-07-06T18:17:41Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/12893", "timeline": [{"oid": "f3623129b0919397f13c6d54f53a4757999d42be", "url": "https://github.com/OpenLiberty/open-liberty/commit/f3623129b0919397f13c6d54f53a4757999d42be", "message": "Change logging.json_fat tests to check trace fo server config update complete message", "committedDate": "2020-07-06T18:15:44Z", "type": "commit"}, {"oid": "82fd19d6f8bca81dcd915cc05b9888f8a33cd7ca", "url": "https://github.com/OpenLiberty/open-liberty/commit/82fd19d6f8bca81dcd915cc05b9888f8a33cd7ca", "message": "Reset server.xml in tests to default console log settings to check console log when server stops", "committedDate": "2020-07-07T18:20:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNTU4OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12893#discussion_r455215588", "bodyText": "Is trace enabled when this method is called?", "author": "fmhwong", "createdAt": "2020-07-15T17:28:40Z", "path": "dev/com.ibm.ws.logging.json_fat/fat/src/com/ibm/ws/logging/json/fat/JsonConfigBootstrapTest.java", "diffHunk": "@@ -496,10 +503,11 @@ private void runApplication(RemoteFile consoleLogFile) throws Exception {\n         TestUtils.runApp(server, \"logServlet\");\n     }\n \n-    private static String setServerConfig(String fileName) throws Exception {\n-        server.setMarkToEndOfLog();\n+    private static void setServerConfig(String fileName) throws Exception {\n+        RemoteFile log = server.getDefaultTraceFile();\n+        server.setMarkToEndOfLog(log);\n         server.setServerConfigurationFile(fileName);\n-        return server.waitForStringInLogUsingMark(\"CWWKG0017I.*|CWWKG0018I.*\");\n+        Assert.assertNotNull(server.waitForStringInLog(\"CWWKG0017I.*|CWWKG0018I.*\", log));", "originalCommit": "82fd19d6f8bca81dcd915cc05b9888f8a33cd7ca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI5ODM2Mw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12893#discussion_r455298363", "bodyText": "Trace should be enabled by default to *=info:logservice=detail:com.ibm.ws.runtime.update.*=all. None of the server.xml configurations have an empty traceSpecification like traceSpecification=\"\", so there should be trace enabled for every server config update.\n\n  \n    \n      open-liberty/dev/fattest.simplicity/autoFVT-defaults/testports.properties\n    \n    \n        Lines 145 to 146\n      in\n      76bc2fe\n    \n    \n    \n    \n\n        \n          \n           # If a FAT does not specify any trace spec, they will get this setting by default \n        \n\n        \n          \n           com.ibm.ws.logging.trace.specification=*=info:logservice=detail:com.ibm.ws.runtime.update.*=all", "author": "ellen-lau", "createdAt": "2020-07-15T19:43:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNTU4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNjA5MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12893#discussion_r455216091", "bodyText": "Is trace enabled when this method is called?", "author": "fmhwong", "createdAt": "2020-07-15T17:29:07Z", "path": "dev/com.ibm.ws.logging.json_fat/fat/src/com/ibm/ws/logging/json/fat/JsonConfigTest.java", "diffHunk": "@@ -356,10 +356,12 @@ private void runApplication(RemoteFile consoleLogFile) throws Exception {\n         TestUtils.runApp(server, \"logServlet\");\n     }\n \n-    private static String setServerConfig(String fileName) throws Exception {\n-        server.setMarkToEndOfLog();\n+    //check message.log for CWWKG0017I.*|CWWKG0018I. message, messageSource must have \"message\"\n+    private static void setServerConfig(String fileName) throws Exception {\n+        RemoteFile log = server.getDefaultTraceFile();\n+        server.setMarkToEndOfLog(log);\n         server.setServerConfigurationFile(fileName);\n-        return server.waitForStringInLogUsingMark(\"CWWKG0017I.*|CWWKG0018I.*\");\n+        Assert.assertNotNull(server.waitForStringInLog(\"CWWKG0017I.*|CWWKG0018I.*\", log));", "originalCommit": "82fd19d6f8bca81dcd915cc05b9888f8a33cd7ca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ2OTU1NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12893#discussion_r455469555", "bodyText": "Same as above comment.", "author": "ellen-lau", "createdAt": "2020-07-16T02:17:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNjA5MQ=="}], "type": "inlineReview"}]}