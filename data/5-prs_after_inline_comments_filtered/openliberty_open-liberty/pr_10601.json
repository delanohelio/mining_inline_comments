{"pr_number": 10601, "pr_title": "disabled test for two embedded resource adapters with login modules", "pr_createdAt": "2020-01-27T22:42:05Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/10601", "timeline": [{"oid": "c505f85b741c41b9c57713a255eaf0cbff400a26", "url": "https://github.com/OpenLiberty/open-liberty/commit/c505f85b741c41b9c57713a255eaf0cbff400a26", "message": "Issue #10529 disabled test for two embedded resource adapters with login modules", "committedDate": "2020-01-27T22:39:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyNzQwOQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10601#discussion_r371527409", "bodyText": "Not sure if you meant to leave this print statement here.  If so, maybe something like, Found login module property key=loginName value=", "author": "KyleAure", "createdAt": "2020-01-27T22:51:06Z", "path": "dev/com.ibm.ws.jca_fat_enterpriseApp/test-resourceadapters/enterpriseAppRA/src/com/ibm/test/jca/enterprisera/EALoginModule.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+package com.ibm.test.jca.enterprisera;\n+\n+import java.security.AccessController;\n+import java.security.PrivilegedAction;\n+import java.util.Map;\n+\n+import javax.resource.spi.security.PasswordCredential;\n+import javax.security.auth.Subject;\n+import javax.security.auth.callback.Callback;\n+import javax.security.auth.callback.CallbackHandler;\n+import javax.security.auth.login.LoginException;\n+import javax.security.auth.spi.LoginModule;\n+\n+import com.ibm.wsspi.security.auth.callback.WSManagedConnectionFactoryCallback;\n+import com.ibm.wsspi.security.auth.callback.WSMappingPropertiesCallback;\n+\n+/**\n+ * This login module always assigns the user name based on a login property called \"loginName\".\n+ */\n+public class EALoginModule implements LoginModule {\n+    private CallbackHandler callbackHandler;\n+    private Subject subject;\n+\n+    @Override\n+    public void initialize(Subject subject, CallbackHandler callbackHandler, Map<String, ?> sharedState, Map<String, ?> options) {\n+        this.callbackHandler = callbackHandler;\n+        this.subject = subject;\n+    }\n+\n+    @Override\n+    public boolean login() throws LoginException {\n+        try {\n+            final WSManagedConnectionFactoryCallback mcfCallback = new WSManagedConnectionFactoryCallback(\"Target ManagedConnectionFactory: \");\n+            WSMappingPropertiesCallback mpropsCallback = new WSMappingPropertiesCallback(\"Mapping Properties (HashMap): \");\n+            callbackHandler.handle(new Callback[] { mcfCallback, mpropsCallback });\n+\n+            Map<?, ?> properties = mpropsCallback.getProperties();\n+            final String loginName = (String) properties.get(\"loginName\");\n+            System.out.println(\"### LOGINMODULE PROP \" + loginName);", "originalCommit": "c505f85b741c41b9c57713a255eaf0cbff400a26", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyOTI4MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10601#discussion_r371529280", "bodyText": "Good catch. That was a mistake to leave the println, and I have removed it under 34432f1", "author": "njr-11", "createdAt": "2020-01-27T22:56:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyNzQwOQ=="}], "type": "inlineReview"}, {"oid": "34432f1fea78f20fc714e96be0596399d5d210d0", "url": "https://github.com/OpenLiberty/open-liberty/commit/34432f1fea78f20fc714e96be0596399d5d210d0", "message": "Issue #10529 code review fix for println left in code", "committedDate": "2020-01-27T22:56:02Z", "type": "commit"}]}