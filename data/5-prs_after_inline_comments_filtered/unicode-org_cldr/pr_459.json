{"pr_number": 459, "pr_title": "CLDR-13750 Refactoring collection utilities (part 2, addAll and asMap)", "pr_createdAt": "2020-05-10T18:47:17Z", "pr_url": "https://github.com/unicode-org/cldr/pull/459", "timeline": [{"oid": "3c815e9163375c5f7c2a3214b751ae2397fe72f4", "url": "https://github.com/unicode-org/cldr/commit/3c815e9163375c5f7c2a3214b751ae2397fe72f4", "message": "CLDR-13750 Refactoring collection utilities (part 2)", "committedDate": "2020-05-27T17:57:00Z", "type": "commit"}, {"oid": "3c815e9163375c5f7c2a3214b751ae2397fe72f4", "url": "https://github.com/unicode-org/cldr/commit/3c815e9163375c5f7c2a3214b751ae2397fe72f4", "message": "CLDR-13750 Refactoring collection utilities (part 2)", "committedDate": "2020-05-27T17:57:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1MjEwNw==", "url": "https://github.com/unicode-org/cldr/pull/459#discussion_r431352107", "bodyText": "most changes are just this sort of thing.\noccasionally you'll see \"forEachRemaining()\" which is what you have to do if there's no iterable available, only an iterator.", "author": "hagbard", "createdAt": "2020-05-27T18:22:37Z", "path": "tools/cldr-unittest/src/org/unicode/cldr/unittest/TestCldrFactory.java", "diffHunk": "@@ -138,8 +137,8 @@ private String getUncontainedPath(CLDRFile subset, CLDRFile superset) {\n     private String differentPathValue(CLDRFile a, CLDRFile b) {\n         int debugCount = 0;\n         Set<String> paths = new TreeSet<>();\n-        CollectionUtilities.addAll(a.iterator(), paths);\n-        CollectionUtilities.addAll(b.iterator(), paths);\n+        a.forEach(paths::add);", "originalCommit": "3c815e9163375c5f7c2a3214b751ae2397fe72f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1MjcxMw==", "url": "https://github.com/unicode-org/cldr/pull/459#discussion_r431352713", "bodyText": "Cases like this have to be unpacked so you make the container and then add to it, rather than passing it into the utility method.", "author": "hagbard", "createdAt": "2020-05-27T18:23:43Z", "path": "tools/cldr-unittest/src/org/unicode/cldr/unittest/TestPaths.java", "diffHunk": "@@ -46,11 +45,10 @@ public static void main(String[] args) {\n     }\n \n     public void VerifyEnglishVsRoot() {\n-        Set<String> rootPaths = CollectionUtilities.addAll(testInfo\n-            .getRoot().iterator(),\n-            new HashSet<String>());\n-        Set<String> englishPaths = CollectionUtilities.addAll(testInfo\n-            .getEnglish().iterator(), new HashSet<String>());\n+        HashSet<String> rootPaths = new HashSet<String>();", "originalCommit": "3c815e9163375c5f7c2a3214b751ae2397fe72f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1MzM1Mg==", "url": "https://github.com/unicode-org/cldr/pull/459#discussion_r431353352", "bodyText": "These are the \"asMap()\" changes which were manual (but still mostly just search & replace).", "author": "hagbard", "createdAt": "2020-05-27T18:24:44Z", "path": "tools/java/org/unicode/cldr/tool/CountItems.java", "diffHunk": "@@ -85,35 +85,36 @@\n         + \" America/Los_Angeles America/Phoenix America/Denver America/Chicago America/Indianapolis\"\n         + \" America/New_York\";\n \n-    static final Map<String, String> country_map = CollectionUtilities.asMap(new String[][] {\n-        { \"AQ\", \"http://www.worldtimezone.com/time-antarctica24.php\" },\n-        { \"AR\", \"http://www.worldtimezone.com/time-south-america24.php\" },\n-        { \"AU\", \"http://www.worldtimezone.com/time-australia24.php\" },\n-        { \"BR\", \"http://www.worldtimezone.com/time-south-america24.php\" },\n-        { \"CA\", \"http://www.worldtimezone.com/time-canada24.php\" },\n-        { \"CD\", \"http://www.worldtimezone.com/time-africa24.php\" },\n-        { \"CL\", \"http://www.worldtimezone.com/time-south-america24.php\" },\n-        { \"CN\", \"http://www.worldtimezone.com/time-cis24.php\" },\n-        { \"EC\", \"http://www.worldtimezone.com/time-south-america24.php\" },\n-        { \"ES\", \"http://www.worldtimezone.com/time-europe24.php\" },\n-        { \"FM\", \"http://www.worldtimezone.com/time-oceania24.php\" },\n-        { \"GL\", \"http://www.worldtimezone.com/index24.php\" },\n-        { \"ID\", \"http://www.worldtimezone.com/time-asia24.php\" },\n-        { \"KI\", \"http://www.worldtimezone.com/time-oceania24.php\" },\n-        { \"KZ\", \"http://www.worldtimezone.com/time-cis24.php\" },\n-        { \"MH\", \"http://www.worldtimezone.com/time-oceania24.php\" },\n-        { \"MN\", \"http://www.worldtimezone.com/time-cis24.php\" },\n-        { \"MX\", \"http://www.worldtimezone.com/index24.php\" },\n-        { \"MY\", \"http://www.worldtimezone.com/time-asia24.php\" },\n-        { \"NZ\", \"http://www.worldtimezone.com/time-oceania24.php\" },\n-        { \"PF\", \"http://www.worldtimezone.com/time-oceania24.php\" },\n-        { \"PT\", \"http://www.worldtimezone.com/time-europe24.php\" },\n-        { \"RU\", \"http://www.worldtimezone.com/time-russia24.php\" },\n-        { \"SJ\", \"http://www.worldtimezone.com/index24.php\" },\n-        { \"UA\", \"http://www.worldtimezone.com/time-cis24.php\" },\n-        { \"UM\", \"http://www.worldtimezone.com/time-oceania24.php\" },\n-        { \"US\", \"http://www.worldtimezone.com/time-usa24.php\" },\n-        { \"UZ\", \"http://www.worldtimezone.com/time-cis24.php\" }, });\n+    static final ImmutableMap<String, String> country_map = ImmutableMap.<String, String>builder()", "originalCommit": "3c815e9163375c5f7c2a3214b751ae2397fe72f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1MzY5OQ==", "url": "https://github.com/unicode-org/cldr/pull/459#discussion_r431353699", "bodyText": "An example of where only an iterator is available.", "author": "hagbard", "createdAt": "2020-05-27T18:25:17Z", "path": "tools/java/org/unicode/cldr/tool/GenerateCasingChart.java", "diffHunk": "@@ -101,7 +100,7 @@ public static void main(String[] args) {\n             Level level = CLDRConfig.getInstance().getStandardCodes().getLocaleCoverageLevel(\"cldr\", locale);\n             boolean hasCasedLetters = changesUpper.containsSome(exemplars);\n             Set<String> items = new LinkedHashSet<>();\n-            CollectionUtilities.addAll(cldrFile.iterator(\"//ldml/contextTransforms\"), items);\n+            cldrFile.iterator(\"//ldml/contextTransforms\").forEachRemaining(items::add);", "originalCommit": "3c815e9163375c5f7c2a3214b751ae2397fe72f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyNDQ5Mg==", "url": "https://github.com/unicode-org/cldr/pull/459#discussion_r431524492", "bodyText": "thanks for the comments, that helps.", "author": "macchiati", "createdAt": "2020-05-28T00:57:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1MzY5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1NDM2OQ==", "url": "https://github.com/unicode-org/cldr/pull/459#discussion_r431354369", "bodyText": "I could split these onto one-per-line, but left them like this so it's easier to see nothing important changed since lines line up in the diff.", "author": "hagbard", "createdAt": "2020-05-27T18:26:29Z", "path": "tools/java/org/unicode/cldr/tool/GenerateEnums.java", "diffHunk": "@@ -570,15 +570,14 @@ private void checkDuplicates(Map m) {\n     Set<String> corrigendum = new TreeSet<String>(Arrays.asList(new String[] { \"QE\", \"833\",\n         \"830\", \"172\" })); // 003, 419\n \n-    private Map extraNames = CollectionUtilities.asMap(new String[][] {\n-        { \"BU\", \"Burma\" }, { \"TP\", \"East Timor\" }, { \"YU\", \"Yugoslavia\" },\n-        { \"ZR\", \"Zaire\" }, { \"CD\", \"Congo (Kinshasa, Democratic Republic)\" },\n-        { \"CI\", \"Ivory Coast (Cote d'Ivoire)\" },\n-        { \"FM\", \"Micronesia (Federated States)\" },\n-        { \"TL\", \"East Timor (Timor-Leste)\" },\n-        // {\"155\",\"Western Europe\"},\n-\n-    });\n+    private ImmutableMap<String, String> extraNames = ImmutableMap.<String, String>builder()\n+        .put(\"BU\", \"Burma\").put(\"TP\", \"East Timor\").put(\"YU\", \"Yugoslavia\")", "originalCommit": "3c815e9163375c5f7c2a3214b751ae2397fe72f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyNDU4NQ==", "url": "https://github.com/unicode-org/cldr/pull/459#discussion_r431524585", "bodyText": "np", "author": "macchiati", "createdAt": "2020-05-28T00:57:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1NDM2OQ=="}], "type": "inlineReview"}]}