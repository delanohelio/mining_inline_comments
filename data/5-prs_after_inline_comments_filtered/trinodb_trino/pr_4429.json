{"pr_number": 4429, "pr_title": "Fix flaky testParquetTimestampPredicatePushdown", "pr_createdAt": "2020-07-12T15:09:00Z", "pr_url": "https://github.com/trinodb/trino/pull/4429", "timeline": [{"oid": "a152dd0ba726cb28c199f400ba3ce4ef8e18b492", "url": "https://github.com/trinodb/trino/commit/a152dd0ba726cb28c199f400ba3ce4ef8e18b492", "message": "Fix flaky testParquetTimestampPredicatePushdown\n\nQuery info contains zeroes if updates haven't been applied yet.\nFixed by retrying with increasing delay between query and getQueryInfo.", "committedDate": "2020-07-14T00:01:16Z", "type": "commit"}, {"oid": "a152dd0ba726cb28c199f400ba3ce4ef8e18b492", "url": "https://github.com/trinodb/trino/commit/a152dd0ba726cb28c199f400ba3ce4ef8e18b492", "message": "Fix flaky testParquetTimestampPredicatePushdown\n\nQuery info contains zeroes if updates haven't been applied yet.\nFixed by retrying with increasing delay between query and getQueryInfo.", "committedDate": "2020-07-14T00:01:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA2OTYxMw==", "url": "https://github.com/trinodb/trino/pull/4429#discussion_r455069613", "bodyText": "would assertEventually, or FailSafe do?", "author": "findepi", "createdAt": "2020-07-15T13:54:03Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveIntegrationSmokeTest.java", "diffHunk": "@@ -7056,4 +7069,39 @@ public TypeAndEstimate(Type type, EstimatedStatsAndCost estimate)\n             this.estimate = requireNonNull(estimate, \"estimate is null\");\n         }\n     }\n+\n+    private static class ExponentialSleeper", "originalCommit": "a152dd0ba726cb28c199f400ba3ce4ef8e18b492", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU1Mjg2Mw==", "url": "https://github.com/trinodb/trino/pull/4429#discussion_r455552863", "bodyText": "See conversation above", "author": "losipiuk", "createdAt": "2020-07-16T07:01:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA2OTYxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA2OTY2Ng==", "url": "https://github.com/trinodb/trino/pull/4429#discussion_r455069666", "bodyText": "cc @dain", "author": "findepi", "createdAt": "2020-07-15T13:54:07Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveIntegrationSmokeTest.java", "diffHunk": "@@ -4129,10 +4133,19 @@ public void testParquetTimestampPredicatePushdown()\n                 \"SELECT * FROM test_parquet_timestamp_predicate_pushdown WHERE t > TIMESTAMP '2012-10-31 01:00'\");\n         assertEquals(getQueryInfo(queryRunner, queryResult).getQueryStats().getProcessedInputDataSize().toBytes(), 0);\n \n-        queryResult = queryRunner.executeWithQueryId(\n-                getSession(),\n-                \"SELECT * FROM test_parquet_timestamp_predicate_pushdown WHERE t = TIMESTAMP '2012-10-31 01:00'\");\n-        assertThat(getQueryInfo(queryRunner, queryResult).getQueryStats().getProcessedInputDataSize().toBytes()).isGreaterThan(0);\n+        // TODO: replace this with a simple query stats check once we find a way to wait until all pending updates to query stats have been applied", "originalCommit": "a152dd0ba726cb28c199f400ba3ce4ef8e18b492", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}