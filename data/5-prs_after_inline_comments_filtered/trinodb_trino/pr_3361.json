{"pr_number": 3361, "pr_title": "Implement applyProjection for JDBC connectors", "pr_createdAt": "2020-04-06T23:09:11Z", "pr_url": "https://github.com/trinodb/trino/pull/3361", "timeline": [{"oid": "af3ffcc1188b87ab14725c413bdb1ff175d29407", "url": "https://github.com/trinodb/trino/commit/af3ffcc1188b87ab14725c413bdb1ff175d29407", "message": "Allow table metadata with no columns\n\nSince the introduction of the applyXXX methods, a TableScan\nrepresents a subquery, not just a raw table. It is possible that\nsuch a subquery might have no columns due to a projection being\napplied by the optimizer.", "committedDate": "2020-04-07T14:56:08Z", "type": "commit"}, {"oid": "6e3f08e5b858920b65e1bdf726cf73f193d33fcb", "url": "https://github.com/trinodb/trino/commit/6e3f08e5b858920b65e1bdf726cf73f193d33fcb", "message": "Implement applyProjection for JDBC connectors", "committedDate": "2020-04-07T20:16:01Z", "type": "commit"}, {"oid": "6e3f08e5b858920b65e1bdf726cf73f193d33fcb", "url": "https://github.com/trinodb/trino/commit/6e3f08e5b858920b65e1bdf726cf73f193d33fcb", "message": "Implement applyProjection for JDBC connectors", "committedDate": "2020-04-07T20:16:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTExMjk3Ng==", "url": "https://github.com/trinodb/trino/pull/3361#discussion_r405112976", "bodyText": "What about order here?", "author": "kokosing", "createdAt": "2020-04-07T21:06:29Z", "path": "presto-base-jdbc/src/main/java/io/prestosql/plugin/jdbc/JdbcMetadata.java", "diffHunk": "@@ -322,4 +363,9 @@ public void dropSchema(ConnectorSession session, String schemaName)\n     {\n         jdbcClient.dropSchema(JdbcIdentity.from(session), schemaName);\n     }\n+\n+    private static boolean containSameElements(Iterable<? extends ColumnHandle> first, Iterable<? extends ColumnHandle> second)\n+    {\n+        return ImmutableSet.copyOf(first).equals(ImmutableSet.copyOf(second));", "originalCommit": "6e3f08e5b858920b65e1bdf726cf73f193d33fcb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEzODQ0MQ==", "url": "https://github.com/trinodb/trino/pull/3361#discussion_r405138441", "bodyText": "I can change it, but it doesn't really matter here. There's not much benefit in accepting a pushdown if it only changes the order of the fields (other than eliminating an almost-free projection from the plan)", "author": "martint", "createdAt": "2020-04-07T21:58:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTExMjk3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0NDA0Nw==", "url": "https://github.com/trinodb/trino/pull/3361#discussion_r405144047", "bodyText": "Actually, we have to keep it like this for now. There's something going on in PushProjectionsIntoTableScan that's not preserving the order as it extracts the expressions to project. As a result, the plan never converges. I'll look into it separately and change this later when it's fixed.", "author": "martint", "createdAt": "2020-04-07T22:12:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTExMjk3Ng=="}], "type": "inlineReview"}]}