{"pr_number": 3714, "pr_title": "Replace x-forwarded support with Airlift version", "pr_createdAt": "2020-05-13T05:33:34Z", "pr_url": "https://github.com/trinodb/trino/pull/3714", "timeline": [{"oid": "9178b064a79951468532768c8191943812505ae8", "url": "https://github.com/trinodb/trino/commit/9178b064a79951468532768c8191943812505ae8", "message": "Replace x-forwarded support with Airlift version\n\nReplace manual handling of forwarded headers with request rewriting in Airlift", "committedDate": "2020-05-13T20:37:06Z", "type": "commit"}, {"oid": "9178b064a79951468532768c8191943812505ae8", "url": "https://github.com/trinodb/trino/commit/9178b064a79951468532768c8191943812505ae8", "message": "Replace x-forwarded support with Airlift version\n\nReplace manual handling of forwarded headers with request rewriting in Airlift", "committedDate": "2020-05-13T20:37:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc2NjU4NA==", "url": "https://github.com/trinodb/trino/pull/3714#discussion_r424766584", "bodyText": "Format with trailing comma\n        \"dispatcher.forwarded-header\",\n})", "author": "electrum", "createdAt": "2020-05-13T22:27:23Z", "path": "presto-main/src/main/java/io/prestosql/server/security/SecurityConfig.java", "diffHunk": "@@ -24,13 +24,15 @@\n import java.util.List;\n import java.util.Optional;\n \n-@DefunctConfig(\"http.server.authentication.enabled\")\n+@DefunctConfig({\n+        \"http.server.authentication.enabled\",\n+        \"http-server.authentication.allow-forwarded-https\",\n+        \"dispatcher.forwarded-header\"})", "originalCommit": "9178b064a79951468532768c8191943812505ae8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc2ODE4NQ==", "url": "https://github.com/trinodb/trino/pull/3714#discussion_r424768185", "bodyText": "Why?", "author": "electrum", "createdAt": "2020-05-13T22:31:30Z", "path": "presto-main/src/test/java/io/prestosql/server/ui/TestWebUi.java", "diffHunk": "@@ -433,11 +434,11 @@ private static void testAlwaysAuthorized(URI baseUri, OkHttpClient authorizedCli\n \n         assertOk(authorizedClient, getValidApiLocation(baseUri));\n \n-        assertRedirect(authorizedClient, getLoginHtmlLocation(baseUri), getUiLocation(baseUri));\n+        assertRedirect(authorizedClient, getLoginHtmlLocation(baseUri), getUiLocation(baseUri), false);", "originalCommit": "9178b064a79951468532768c8191943812505ae8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDg4OTA4Ng==", "url": "https://github.com/trinodb/trino/pull/3714#discussion_r424889086", "bodyText": "The proxy test doesn't go over https so the protocol authentication does not work", "author": "dain", "createdAt": "2020-05-14T06:03:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc2ODE4NQ=="}], "type": "inlineReview"}]}