{"pr_number": 5698, "pr_title": "Push complex expression filters into Glue metastore", "pr_createdAt": "2020-10-26T19:31:29Z", "pr_url": "https://github.com/trinodb/trino/pull/5698", "timeline": [{"oid": "0ba28c52ec7c17b34007f80c7e67ba987f3049d5", "url": "https://github.com/trinodb/trino/commit/0ba28c52ec7c17b34007f80c7e67ba987f3049d5", "message": "Push complex expression filters into Glue metastore\n\nPreviously, only single value equality filters were pushed down.", "committedDate": "2020-10-26T23:55:39Z", "type": "commit"}, {"oid": "0ba28c52ec7c17b34007f80c7e67ba987f3049d5", "url": "https://github.com/trinodb/trino/commit/0ba28c52ec7c17b34007f80c7e67ba987f3049d5", "message": "Push complex expression filters into Glue metastore\n\nPreviously, only single value equality filters were pushed down.", "committedDate": "2020-10-26T23:55:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ3MDk0Mw==", "url": "https://github.com/trinodb/trino/pull/5698#discussion_r512470943", "bodyText": "There are many layers between query and metastore communication and we already had regressions more than once. Can we also have an end-to-end test with Glue metastore showing the functionality works as intended?\nThis could go into TestHiveGlueMetastore to use real Glue. We probably should add GlueMetastoreStats metric to account for size of responses being pulled from the service.", "author": "findepi", "createdAt": "2020-10-27T07:41:09Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/metastore/TestMetastoreUtil.java", "diffHunk": "@@ -153,4 +167,34 @@ public void testHiveSchemaPartition()\n         Properties actual = MetastoreUtil.getHiveSchema(ThriftMetastoreUtil.fromMetastoreApiPartition(TEST_PARTITION_WITH_UNSUPPORTED_FIELDS), ThriftMetastoreUtil.fromMetastoreApiTable(TEST_TABLE_WITH_UNSUPPORTED_FIELDS, TEST_SCHEMA));\n         assertEquals(actual, expected);\n     }\n+\n+    @Test\n+    public void testComputePartitionKeyFilter()", "originalCommit": "0ba28c52ec7c17b34007f80c7e67ba987f3049d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg3MDQxMA==", "url": "https://github.com/trinodb/trino/pull/5698#discussion_r512870410", "bodyText": "TestHiveGlueMetastore is doing low level tests of the metastore calls, so it wouldn't help with this issue. I filed #5709 to add product tests that work end-to-end.", "author": "electrum", "createdAt": "2020-10-27T17:05:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ3MDk0Mw=="}], "type": "inlineReview"}]}