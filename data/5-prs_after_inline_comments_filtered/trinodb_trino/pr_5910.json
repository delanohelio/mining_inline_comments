{"pr_number": 5910, "pr_title": "Update and extend Hive VIEW tests", "pr_createdAt": "2020-11-10T22:09:33Z", "pr_url": "https://github.com/trinodb/trino/pull/5910", "timeline": [{"oid": "b20e7fc65d1458c1b98fc41ee8da145a196c3bdb", "url": "https://github.com/trinodb/trino/commit/b20e7fc65d1458c1b98fc41ee8da145a196c3bdb", "message": "Update Tempto to 182", "committedDate": "2020-11-10T22:08:33Z", "type": "commit"}, {"oid": "37696b1e2a0be82c589c9ae79db6f9f56be199dd", "url": "https://github.com/trinodb/trino/commit/37696b1e2a0be82c589c9ae79db6f9f56be199dd", "message": "Update and extend Hive VIEW tests\n\n- compare Hive and Presto view results\n- setup TABLE-s with Presto (typically faster)\n- add more coverage, e.g. test `SELECT *` instead of `SELECT count(*)`.", "committedDate": "2020-11-10T22:08:33Z", "type": "commit"}, {"oid": "ba34e82e410ee05e13d75b9da26575ca99f14eb1", "url": "https://github.com/trinodb/trino/commit/ba34e82e410ee05e13d75b9da26575ca99f14eb1", "message": "Test Hive VIEW with functions", "committedDate": "2020-11-10T22:08:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk0MTc0NA==", "url": "https://github.com/trinodb/trino/pull/5910#discussion_r521941744", "bodyText": "having a separate test for each feature would be appreciated. Not it is hard to follow.", "author": "kokosing", "createdAt": "2020-11-12T08:59:50Z", "path": "presto-product-tests/src/main/java/io/prestosql/tests/hive/TestHiveViews.java", "diffHunk": "@@ -169,19 +169,20 @@ public void testRichSqlSyntax()\n                 // TODO (https://github.com/prestosql/presto/issues/5837) \"   CASE n_regionkey WHEN 0 THEN 'Africa' WHEN 1 THEN 'America' END region_name, \\n\" + // simple CASE\n                 \"   CASE WHEN n_name = \\\"BRAZIL\\\" THEN 'is BRAZIL' WHEN n_name = \\\"ALGERIA\\\" THEN 'is ALGERIA' ELSE \\\"\\\" END is_something,\\n\" + // searched CASE, double quote string literals\n                 \"   COALESCE(IF(n_name LIKE 'A%', NULL, n_name), 'A%') AS coalesced_name, \\n\" + // coalesce\n+                \"   round(tan(n_nationkey), 3) AS rounded_tan, \\n\" + // functions\n                 \"   `n`.`n_nationkey` + `n_nationkey` + n.n_nationkey + n_nationkey + 10000 - -1 AS arithmetic--some comment without leading space \\n\" +\n                 \"FROM `default`.`nation` AS `n`\");\n         assertViewQuery(\"\" +", "originalCommit": "ba34e82e410ee05e13d75b9da26575ca99f14eb1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjAwMDExNQ==", "url": "https://github.com/trinodb/trino/pull/5910#discussion_r522000115", "bodyText": "i agree in general. I am doing this not to pay high penalty for using hive in a product test.\nI think in this particular case it's a reasonable choice.", "author": "findepi", "createdAt": "2020-11-12T10:29:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk0MTc0NA=="}], "type": "inlineReview"}]}