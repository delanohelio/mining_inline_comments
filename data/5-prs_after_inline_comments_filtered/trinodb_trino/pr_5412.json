{"pr_number": 5412, "pr_title": "Forbid @BeforeMethod, @AfterMethod in multi-threaded tests ", "pr_createdAt": "2020-10-04T18:43:16Z", "pr_url": "https://github.com/trinodb/trino/pull/5412", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQxNDI3NA==", "url": "https://github.com/trinodb/trino/pull/5412#discussion_r499414274", "bodyText": "optional: While you are here, can you please change the code to not to swallow exceptions in tearDown?", "author": "kokosing", "createdAt": "2020-10-05T08:06:34Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/util/TestFSDataInputStreamTail.java", "diffHunk": "@@ -39,6 +39,7 @@\n import static org.testng.Assert.assertTrue;\n import static org.testng.Assert.fail;\n \n+@Test(singleThreaded = true) // e.g. test methods operate on shared, mutated tempFile", "originalCommit": "b838557eb6a0bc15b33253600f72c0647466ee70", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "daf7e16d13e62412668572aafd97800d7e55ed3a", "url": "https://github.com/trinodb/trino/commit/daf7e16d13e62412668572aafd97800d7e55ed3a", "message": "Mark test classes single-threaded", "committedDate": "2020-10-05T10:57:23Z", "type": "commit"}, {"oid": "23580da3dc0aaf76261c064aeca376e5ac7e3f88", "url": "https://github.com/trinodb/trino/commit/23580da3dc0aaf76261c064aeca376e5ac7e3f88", "message": "Forbid @BeforeMethod, @AfterMethod in multi-threaded tests\n\nExistence of `@BeforeMethod` or `@AfterMethod` most often indicates a\nshared mutable state that needs to be e.g. reset. This means the class\nshould be marked `@Test(singleThreaded=true)`.", "committedDate": "2020-10-05T14:05:55Z", "type": "commit"}, {"oid": "14bc7a9df9f61d68ff1476feabc818fbc39e9ec2", "url": "https://github.com/trinodb/trino/commit/14bc7a9df9f61d68ff1476feabc818fbc39e9ec2", "message": "Do not ingnore tear down exceptions", "committedDate": "2020-10-05T14:05:55Z", "type": "commit"}, {"oid": "14bc7a9df9f61d68ff1476feabc818fbc39e9ec2", "url": "https://github.com/trinodb/trino/commit/14bc7a9df9f61d68ff1476feabc818fbc39e9ec2", "message": "Do not ingnore tear down exceptions", "committedDate": "2020-10-05T14:05:55Z", "type": "forcePushed"}]}