{"pr_number": 3206, "pr_title": "Stop at first LDAP match when distinguished name is not required", "pr_createdAt": "2020-03-23T09:54:27Z", "pr_url": "https://github.com/trinodb/trino/pull/3206", "timeline": [{"oid": "7a0492f654d03563fcba6c5f72a3106e8b4a8361", "url": "https://github.com/trinodb/trino/commit/7a0492f654d03563fcba6c5f72a3106e8b4a8361", "message": "Stop at first LDAP match when distinguished name is not required", "committedDate": "2020-03-23T10:24:53Z", "type": "commit"}, {"oid": "7a0492f654d03563fcba6c5f72a3106e8b4a8361", "url": "https://github.com/trinodb/trino/commit/7a0492f654d03563fcba6c5f72a3106e8b4a8361", "message": "Stop at first LDAP match when distinguished name is not required", "committedDate": "2020-03-23T10:24:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM3MDkxNw==", "url": "https://github.com/trinodb/trino/pull/3206#discussion_r396370917", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                String message = format(\"User [%s] not a member of the authorized group\", user);\n          \n          \n            \n                                String message = format(\"User [%s] not a member of an authorized group\", user);", "author": "findepi", "createdAt": "2020-03-23T11:07:10Z", "path": "presto-password-authenticators/src/main/java/io/prestosql/plugin/password/ldap/LdapAuthenticator.java", "diffHunk": "@@ -180,6 +180,28 @@ private String validateGroupMembership(String user, String contextUserDistinguis\n         }\n     }\n \n+    private void checkGroupMembership(String user, String contextUserDistinguishedName, String contextPassword)\n+            throws NamingException\n+    {\n+        DirContext context = createUserDirContext(contextUserDistinguishedName, contextPassword);\n+        try {\n+            NamingEnumeration<SearchResult> search = searchGroupMembership(user, context);\n+            try {\n+                if (!search.hasMore()) {\n+                    String message = format(\"User [%s] not a member of the authorized group\", user);", "originalCommit": "7a0492f654d03563fcba6c5f72a3106e8b4a8361", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7f5c6c2c2ebc3f4c433ab055fbb852672e58fc77", "url": "https://github.com/trinodb/trino/commit/7f5c6c2c2ebc3f4c433ab055fbb852672e58fc77", "message": "Fix message", "committedDate": "2020-03-25T15:47:42Z", "type": "commit"}, {"oid": "7f5c6c2c2ebc3f4c433ab055fbb852672e58fc77", "url": "https://github.com/trinodb/trino/commit/7f5c6c2c2ebc3f4c433ab055fbb852672e58fc77", "message": "Fix message", "committedDate": "2020-03-25T15:47:42Z", "type": "forcePushed"}]}