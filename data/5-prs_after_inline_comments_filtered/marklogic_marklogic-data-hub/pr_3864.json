{"pr_number": 3864, "pr_title": "DHFPROD-4757: Removing HC dependency on the filesystem", "pr_createdAt": "2020-04-23T16:50:01Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3864", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk3MDQ4NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3864#discussion_r413970485", "bodyText": "This is called \"temporaryLoadDataDirectory\". Do we have any intention of cleaning up the directory or are we saying that it is temporary, as in it will go away when we rework the \"Load Data\" feature?", "author": "ryanjdew", "createdAt": "2020-04-23T17:05:02Z", "path": "marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/HubCentral.java", "diffHunk": "@@ -42,23 +37,19 @@\n     public void afterPropertiesSet() {\n         logger.info(\"Will connect to MarkLogic host: \" + host);\n \n-        hubProject = new HubProjectImpl();\n-        logger.info(\"Temporarily initializing project at: \" + projectPath);\n-        hubProject.createProject(projectPath);\n-\n-        HubConfigImpl tempHubConfig = new HubConfigImpl(hubProject, environment);\n-        tempHubConfig.initHubProject();\n-        logger.info(\"Initialized project at: \" + getProjectDirectory());\n-\n         if (useLocalDefaults) {\n             logger.info(\"Local defaults of digest authentication and no SSL will be used when connecting to MarkLogic\");\n         }\n \n+        temporaryLoadDataDirectory = new File(\"build/data-sets\");", "originalCommit": "8596f8bf3185a2e3019fa8c44f22d4a32562e399", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4NTk5Nw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3864#discussion_r413985997", "bodyText": "Right, it will go away once we tackle that set of stories.", "author": "rjrudin", "createdAt": "2020-04-23T17:27:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk3MDQ4NQ=="}], "type": "inlineReview"}, {"oid": "ce26595f0bf6dabba44b79041f3e0f22a95b95b3", "url": "https://github.com/marklogic/marklogic-data-hub/commit/ce26595f0bf6dabba44b79041f3e0f22a95b95b3", "message": "DHFPROD-4757: Removing HC dependency on the filesystem\n\nAdded a BaseController that is the one and only one bean that accesses HubConfigSession. Every controller extends that and is now abstracted from how a HubConfig is obtained.\n\nRemoved every controller method that both did not have a test and that I could not find any way to access it via the UI code. Doing this to bump up code coverage.\n\nRenamed methods in subclasses of AbstractArtifactController and changed the tests to call those methods; again, to improve code coverage. \n\nChanges to core are minimal - removed file-writing from ArtifactManagerImpl; added a null-check to HubProjectImpl so it doesn't assume a token exists (this doesn't impact HC app code, but HC test code - which does need to initialize project - will otherwise break without this check); and made a couple methods in EntityManagerImpl and FlowManagerImpl visible to HC (the methods have useful logic that don't depend on a filesystem). \n\nRemoved two deleted endpoints from the mocks files.", "committedDate": "2020-04-23T17:36:09Z", "type": "forcePushed"}, {"oid": "baf3811d5e639a5cd1ab856393b08c6cab69c0f6", "url": "https://github.com/marklogic/marklogic-data-hub/commit/baf3811d5e639a5cd1ab856393b08c6cab69c0f6", "message": "DHFPROD-4757: Removing HC dependency on the filesystem\n\nAdded a BaseController that is the one and only one bean that accesses HubConfigSession. Every controller extends that and is now abstracted from how a HubConfig is obtained.\n\nRemoved every controller method that both did not have a test and that I could not find any way to access it via the UI code. Doing this to bump up code coverage.\n\nRenamed methods in subclasses of AbstractArtifactController and changed the tests to call those methods; again, to improve code coverage. \n\nChanges to core are minimal - removed file-writing from ArtifactManagerImpl; added a null-check to HubProjectImpl so it doesn't assume a token exists (this doesn't impact HC app code, but HC test code - which does need to initialize project - will otherwise break without this check); and made a couple methods in EntityManagerImpl and FlowManagerImpl visible to HC (the methods have useful logic that don't depend on a filesystem). \n\nRemoved two deleted endpoints from the mocks files.", "committedDate": "2020-04-23T19:48:11Z", "type": "forcePushed"}, {"oid": "baf3811d5e639a5cd1ab856393b08c6cab69c0f6", "url": "https://github.com/marklogic/marklogic-data-hub/commit/baf3811d5e639a5cd1ab856393b08c6cab69c0f6", "message": "DHFPROD-4757: Removing HC dependency on the filesystem\n\nAdded a BaseController that is the one and only one bean that accesses HubConfigSession. Every controller extends that and is now abstracted from how a HubConfig is obtained.\n\nRemoved every controller method that both did not have a test and that I could not find any way to access it via the UI code. Doing this to bump up code coverage.\n\nRenamed methods in subclasses of AbstractArtifactController and changed the tests to call those methods; again, to improve code coverage. \n\nChanges to core are minimal - removed file-writing from ArtifactManagerImpl; added a null-check to HubProjectImpl so it doesn't assume a token exists (this doesn't impact HC app code, but HC test code - which does need to initialize project - will otherwise break without this check); and made a couple methods in EntityManagerImpl and FlowManagerImpl visible to HC (the methods have useful logic that don't depend on a filesystem). \n\nRemoved two deleted endpoints from the mocks files.", "committedDate": "2020-04-23T19:48:11Z", "type": "commit"}]}