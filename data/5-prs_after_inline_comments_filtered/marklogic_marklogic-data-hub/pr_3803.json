{"pr_number": 3803, "pr_title": "DHFPROD-4440: Improving how resetProject works in HubTestBase", "pr_createdAt": "2020-04-09T14:11:10Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3803", "timeline": [{"oid": "be3698f38c07c9123d1c576066df343797178877", "url": "https://github.com/marklogic/marklogic-data-hub/commit/be3698f38c07c9123d1c576066df343797178877", "message": "DHFPROD-4440: Improving how resetProject works in HubTestBase\n\nMain change is that clearDatabases in HubTestBase no longer deletes the hub-core-artifact collection. That keeps all DH core artifacts present. Had to improve some legacy tests that were assuming that the database was empty after calling clear (making assertions on the number of docs in a database leads to brittle tests).\n\nAlso made a tweak to LoadUserModulesCommand that both speeds up tests and fixes a long-standing issue when running \"mlWatch\", which is - when you run mlWatch, DHF generates and deploys entity-based search options over and over and over. That also adds some time to every test, and none of our tests depend on LoadUserModulesCommand deploying entity-based search options.", "committedDate": "2020-04-09T14:10:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM0NDc3Nw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3803#discussion_r406344777", "bodyText": "A small typo here. Other than that everything looks good.", "author": "srinathgit", "createdAt": "2020-04-09T16:58:14Z", "path": "marklogic-data-hub/src/test/java/com/marklogic/hub/AbstractHubTest.java", "diffHunk": "@@ -1,16 +1,20 @@\n package com.marklogic.hub;\n \n-import com.fasterxml.jackson.databind.ObjectMapper;\n+import org.junit.jupiter.api.BeforeEach;\n import org.junit.jupiter.api.extension.ExtendWith;\n import org.springframework.test.context.ContextConfiguration;\n import org.springframework.test.context.junit.jupiter.SpringExtension;\n \n /**\n- * Adding this so that a class can subclass HubTestBase without having to define the same two Spring annotations\n+ * Adding this so that a class can subclass HubTestBase without hing to define the same two Spring annotations", "originalCommit": "be3698f38c07c9123d1c576066df343797178877", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM4NDM2Mw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3803#discussion_r406384363", "bodyText": "Thanks @srinathgit  - I'll have another PR for 4440 with the real impl in it; I'll fix the typo in that one.", "author": "rjrudin", "createdAt": "2020-04-09T18:08:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM0NDc3Nw=="}], "type": "inlineReview"}]}