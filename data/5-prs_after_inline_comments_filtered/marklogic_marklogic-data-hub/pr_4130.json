{"pr_number": 4130, "pr_title": "DHFPROD-4998: Deploy custom steps, view them in HC", "pr_createdAt": "2020-06-23T17:38:14Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4130", "timeline": [{"oid": "cede6d42cf2c7f67cd4e3e1bc631d11ae0e05a12", "url": "https://github.com/marklogic/marklogic-data-hub/commit/cede6d42cf2c7f67cd4e3e1bc631d11ae0e05a12", "message": "DHFPROD-4998: Deploy custom steps, view them in HC", "committedDate": "2020-06-23T18:05:59Z", "type": "forcePushed"}, {"oid": "06985e9ab3eb80c1b0b2bc7de17bdd1207f14e25", "url": "https://github.com/marklogic/marklogic-data-hub/commit/06985e9ab3eb80c1b0b2bc7de17bdd1207f14e25", "message": "DHFPROD-4998: Deploy custom steps, view them in HC", "committedDate": "2020-06-23T18:57:38Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUwMzg3MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4130#discussion_r444503870", "bodyText": "Does this force the UI to make two calls? If so, I'd rather it be one call where the response is an object - e.g.:\n{\n  \"stepsWithoutEntity\": [...],\n  \"stepsWithEntity\": [\n    {\n      \"entityType\": \"Customer\",\n      \"steps\": [...]\n    }\n  ] \n}", "author": "rjrudin", "createdAt": "2020-06-23T20:57:02Z", "path": "marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/controllers/steps/CustomStepController.java", "diffHunk": "@@ -0,0 +1,51 @@\n+package com.marklogic.hub.central.controllers.steps;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.marklogic.hub.central.controllers.BaseController;\n+import com.marklogic.hub.central.schemas.StepSchema;\n+import com.marklogic.hub.dataservices.ArtifactService;\n+import com.marklogic.hub.dataservices.CustomService;\n+import io.swagger.annotations.ApiOperation;\n+import org.apache.commons.lang3.BooleanUtils;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.security.access.annotation.Secured;\n+import org.springframework.stereotype.Controller;\n+import org.springframework.web.bind.annotation.PathVariable;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RequestParam;\n+\n+import java.util.ArrayList;\n+\n+@Controller\n+@RequestMapping(\"/api/steps/custom\")\n+public class CustomStepController extends BaseController {\n+    private final static String STEP_DEFINITION_TYPE = \"custom\";\n+\n+    @RequestMapping(method = RequestMethod.GET)\n+    @ApiOperation(value = \"Get custom steps associated with entity type, if the  optional boolean parameter 'withoutEntity' is set \" +\n+        \"to true, it returns custom steps not associated with any entity types \", response = CustomSteps.class)\n+    @Secured(\"ROLE_readCustom\")\n+    public ResponseEntity<JsonNode> getCustomStepsWithEntity(@RequestParam(required = false,value=\"withoutEntity\") Boolean withoutEntity) {\n+        if(BooleanUtils.isTrue(withoutEntity)){", "originalCommit": "06985e9ab3eb80c1b0b2bc7de17bdd1207f14e25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUwNjYxMA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4130#discussion_r444506610", "bodyText": "I think this should really be \"CustomStepService\". While we have \"MappingService\", \"Mapping\" is able to be by itself and avoid confusion. But \"Custom\" by itself should be avoided unless we have no choice, as it could refer to a custom step, or a custom module, or a custom hook.", "author": "rjrudin", "createdAt": "2020-06-23T21:02:17Z", "path": "marklogic-data-hub/src/main/java/com/marklogic/hub/dataservices/CustomService.java", "diffHunk": "@@ -0,0 +1,110 @@\n+package com.marklogic.hub.dataservices;\n+\n+// IMPORTANT: Do not edit. This file is generated.\n+\n+import com.marklogic.client.io.Format;\n+\n+\n+import com.marklogic.client.DatabaseClient;\n+import com.marklogic.client.io.marker.JSONWriteHandle;\n+\n+import com.marklogic.client.impl.BaseProxy;\n+\n+/**\n+ * Provides a set of operations on the database server\n+ */\n+public interface CustomService {", "originalCommit": "06985e9ab3eb80c1b0b2bc7de17bdd1207f14e25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b7f56a56e4e664aa7e6c6e5a3d949750bb93de9f", "url": "https://github.com/marklogic/marklogic-data-hub/commit/b7f56a56e4e664aa7e6c6e5a3d949750bb93de9f", "message": "DHFPROD-4998: Deploy custom steps, view them in HC", "committedDate": "2020-06-24T04:03:45Z", "type": "forcePushed"}, {"oid": "cfd4df914cbcf408d4dd5ada88067def23dd7390", "url": "https://github.com/marklogic/marklogic-data-hub/commit/cfd4df914cbcf408d4dd5ada88067def23dd7390", "message": "DHFPROD-4998: Deploy custom steps, view them in HC", "committedDate": "2020-06-24T18:57:03Z", "type": "commit"}, {"oid": "cfd4df914cbcf408d4dd5ada88067def23dd7390", "url": "https://github.com/marklogic/marklogic-data-hub/commit/cfd4df914cbcf408d4dd5ada88067def23dd7390", "message": "DHFPROD-4998: Deploy custom steps, view them in HC", "committedDate": "2020-06-24T18:57:03Z", "type": "forcePushed"}]}