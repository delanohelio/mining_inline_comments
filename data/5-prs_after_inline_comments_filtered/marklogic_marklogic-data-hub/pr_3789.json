{"pr_number": 3789, "pr_title": "DHFPROD-3649: View list of personal queries previously saved", "pr_createdAt": "2020-04-04T01:56:53Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3789", "timeline": [{"oid": "e3b36d1a6ae981103788a82d1296ffb4c0ba3581", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e3b36d1a6ae981103788a82d1296ffb4c0ba3581", "message": "DHFPROD-3649: View list of personal queries previously saved", "committedDate": "2020-04-04T18:47:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NzM0MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3789#discussion_r403697340", "bodyText": "I don't think these annotations are needed - they seem redundant with what the method is already doing, which is building a request-based EntitySearchManager with a session-based hubConfig.", "author": "rjrudin", "createdAt": "2020-04-05T12:47:54Z", "path": "one-ui/src/main/java/com/marklogic/hub/oneui/controllers/EntitySearchController.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright 2012-2020 MarkLogic Corporation\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package com.marklogic.hub.oneui.controllers;\n+\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.marklogic.hub.dataservices.EntitySearchService;\n+import com.marklogic.hub.oneui.managers.EntitySearchManager;\n+import com.marklogic.hub.oneui.models.Document;\n+import com.marklogic.hub.oneui.models.HubConfigSession;\n+import com.marklogic.hub.oneui.models.SearchQuery;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.context.annotation.ScopedProxyMode;\n+import org.springframework.http.HttpHeaders;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.http.MediaType;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.stereotype.Controller;\n+import org.springframework.web.bind.annotation.RequestBody;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RequestParam;\n+import org.springframework.web.bind.annotation.ResponseBody;\n+\n+import java.util.Optional;\n+\n+\n+@Controller\n+@RequestMapping(value = \"/api/entitySearch\")\n+public class EntitySearchController {\n+\n+    @Autowired\n+    private HubConfigSession hubConfig;\n+\n+    @Autowired\n+    private EntitySearchManager entitySearchManager;\n+\n+    @Bean\n+    @Scope(proxyMode = ScopedProxyMode.TARGET_CLASS, value = \"request\")", "originalCommit": "e3b36d1a6ae981103788a82d1296ffb4c0ba3581", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NzM3OQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3789#discussion_r403697379", "bodyText": "Shouldn't need this, since you have the method below this to construct an EntitySearchManager.", "author": "rjrudin", "createdAt": "2020-04-05T12:48:24Z", "path": "one-ui/src/main/java/com/marklogic/hub/oneui/controllers/EntitySearchController.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright 2012-2020 MarkLogic Corporation\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package com.marklogic.hub.oneui.controllers;\n+\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.marklogic.hub.dataservices.EntitySearchService;\n+import com.marklogic.hub.oneui.managers.EntitySearchManager;\n+import com.marklogic.hub.oneui.models.Document;\n+import com.marklogic.hub.oneui.models.HubConfigSession;\n+import com.marklogic.hub.oneui.models.SearchQuery;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.context.annotation.ScopedProxyMode;\n+import org.springframework.http.HttpHeaders;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.http.MediaType;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.stereotype.Controller;\n+import org.springframework.web.bind.annotation.RequestBody;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RequestParam;\n+import org.springframework.web.bind.annotation.ResponseBody;\n+\n+import java.util.Optional;\n+\n+\n+@Controller\n+@RequestMapping(value = \"/api/entitySearch\")\n+public class EntitySearchController {\n+\n+    @Autowired\n+    private HubConfigSession hubConfig;\n+\n+    @Autowired\n+    private EntitySearchManager entitySearchManager;", "originalCommit": "e3b36d1a6ae981103788a82d1296ffb4c0ba3581", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NzUzNg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3789#discussion_r403697536", "bodyText": "If you need a method that returns an ArrayNode, let's not modify this - just add a \"readJsonArray\" method.", "author": "rjrudin", "createdAt": "2020-04-05T12:49:20Z", "path": "one-ui/src/test/java/com/marklogic/hub/oneui/AbstractOneUiTest.java", "diffHunk": "@@ -124,6 +124,11 @@ protected File getFileFromClasspath(String resourceName) {\n \n     protected ObjectNode readJsonObject(String json) {\n         try {\n+            if(objectMapper.readTree(json).isArray()) {", "originalCommit": "e3b36d1a6ae981103788a82d1296ffb4c0ba3581", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "937b4dedd867c9a320313125fd5287995bfd2700", "url": "https://github.com/marklogic/marklogic-data-hub/commit/937b4dedd867c9a320313125fd5287995bfd2700", "message": "DHFPROD-3649: View list of personal queries previously saved", "committedDate": "2020-04-05T23:37:12Z", "type": "forcePushed"}, {"oid": "6a44c2c6d4e16c1e0dff28a975b842726b3016c8", "url": "https://github.com/marklogic/marklogic-data-hub/commit/6a44c2c6d4e16c1e0dff28a975b842726b3016c8", "message": "DHFPROD-3649: Refactoring explorer search features as entity search\n\nDHFPROD-3649: facet values endpoint changes", "committedDate": "2020-04-06T19:20:16Z", "type": "commit"}, {"oid": "a2ab02eac254537ac9e1ad8fb7fe5f7dc7ed69f9", "url": "https://github.com/marklogic/marklogic-data-hub/commit/a2ab02eac254537ac9e1ad8fb7fe5f7dc7ed69f9", "message": "DHFPROD-3649: Refactoring search endpoints to entitySearch", "committedDate": "2020-04-06T19:20:26Z", "type": "commit"}, {"oid": "4ad04507802f86340bff072b594f6119edec2342", "url": "https://github.com/marklogic/marklogic-data-hub/commit/4ad04507802f86340bff072b594f6119edec2342", "message": "DHFPROD-3649: View list of personal queries previously saved", "committedDate": "2020-04-06T19:20:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ2NDAxNw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3789#discussion_r404464017", "bodyText": "It seems you expect an ArrayNode back, right? So just make this \"readJsonArray\" and have it return an ArrayNode.", "author": "rjrudin", "createdAt": "2020-04-07T00:17:38Z", "path": "one-ui/src/test/java/com/marklogic/hub/oneui/AbstractOneUiTest.java", "diffHunk": "@@ -130,6 +130,16 @@ protected ObjectNode readJsonObject(String json) {\n         }\n     }\n \n+    protected ObjectNode readJsonArrayObject(String json) {\n+        try {\n+            ObjectNode objectNode = objectMapper.createObjectNode();\n+            objectNode.putArray(\"arrayKey\").add(objectMapper.readTree(json));", "originalCommit": "4ad04507802f86340bff072b594f6119edec2342", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "249b56c5657d33fcf9eeaff9fbfad39a8c2c3273", "url": "https://github.com/marklogic/marklogic-data-hub/commit/249b56c5657d33fcf9eeaff9fbfad39a8c2c3273", "message": "DHFPROD-3649: View list of personal queries previously saved", "committedDate": "2020-04-07T01:18:35Z", "type": "commit"}, {"oid": "249b56c5657d33fcf9eeaff9fbfad39a8c2c3273", "url": "https://github.com/marklogic/marklogic-data-hub/commit/249b56c5657d33fcf9eeaff9fbfad39a8c2c3273", "message": "DHFPROD-3649: View list of personal queries previously saved", "committedDate": "2020-04-07T01:18:35Z", "type": "forcePushed"}]}