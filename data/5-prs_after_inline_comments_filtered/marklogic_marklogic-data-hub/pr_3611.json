{"pr_number": 3611, "pr_title": "DHFPROD-4487: Add user creation to run unit tests", "pr_createdAt": "2020-02-24T23:32:13Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3611", "timeline": [{"oid": "e5fbfc3c9dc9b90787de49f20a416b1d7666b641", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e5fbfc3c9dc9b90787de49f20a416b1d7666b641", "message": "DHFPROD-4487:create user and add role to run unit  tests", "committedDate": "2020-02-27T00:11:56Z", "type": "commit"}, {"oid": "bd134066ede796ef280fb968894d09e145608003", "url": "https://github.com/marklogic/marklogic-data-hub/commit/bd134066ede796ef280fb968894d09e145608003", "message": "DHFPROD-4487:diable  testUploadProject unit test so it  will not delete data-hub-developer role", "committedDate": "2020-02-27T00:11:56Z", "type": "commit"}, {"oid": "3994f0ab441d24fe38eb483cd94d7fb094145649", "url": "https://github.com/marklogic/marklogic-data-hub/commit/3994f0ab441d24fe38eb483cd94d7fb094145649", "message": "DHFPROD-4487:fix testUploadProject unit test not to delete role", "committedDate": "2020-02-27T00:11:56Z", "type": "commit"}, {"oid": "3994f0ab441d24fe38eb483cd94d7fb094145649", "url": "https://github.com/marklogic/marklogic-data-hub/commit/3994f0ab441d24fe38eb483cd94d7fb094145649", "message": "DHFPROD-4487:fix testUploadProject unit test not to delete role", "committedDate": "2020-02-27T00:11:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEyMDcyMQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3611#discussion_r385120721", "bodyText": "Is this actually called? I believe this method must be static - see https://howtodoinjava.com/junit5/after-all-annotation-example/ .\nI also don't think there's any need to delete the user, it can be considered part of the test setup. Just make sure it has a name that makes it clear it's for running tests.", "author": "rjrudin", "createdAt": "2020-02-27T13:21:03Z", "path": "one-ui/src/test/java/com/marklogic/hub/oneui/TestHelper.java", "diffHunk": "@@ -102,4 +122,20 @@ public void addStagingDoc(String uri, DocumentMetadataHandle meta, String resour\n     public File getResourceFile(String resourceName) {\n         return new File(Objects.requireNonNull(TestHelper.class.getClassLoader().getResource(resourceName)).getFile());\n     }\n+    private void createUser(String username, String password, String role) {\n+        client = new ManageClient();\n+        client.setManageConfig(new ManageConfig(mlHost, 8002, adminUserName, adminPassword));\n+        adminAPI = new API(client);\n+\n+        user = new User(adminAPI, username);\n+        user.setUserName(username);\n+        user.setPassword(password);\n+        user.setRole(Stream.of(role).collect(Collectors.toList()));\n+        user.save();\n+    }\n+\n+    @AfterAll", "originalCommit": "3994f0ab441d24fe38eb483cd94d7fb094145649", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEyMDg4OQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3611#discussion_r385120889", "bodyText": "Can just call \"addRole\" here", "author": "rjrudin", "createdAt": "2020-02-27T13:21:16Z", "path": "one-ui/src/test/java/com/marklogic/hub/oneui/TestHelper.java", "diffHunk": "@@ -102,4 +122,20 @@ public void addStagingDoc(String uri, DocumentMetadataHandle meta, String resour\n     public File getResourceFile(String resourceName) {\n         return new File(Objects.requireNonNull(TestHelper.class.getClassLoader().getResource(resourceName)).getFile());\n     }\n+    private void createUser(String username, String password, String role) {\n+        client = new ManageClient();\n+        client.setManageConfig(new ManageConfig(mlHost, 8002, adminUserName, adminPassword));\n+        adminAPI = new API(client);\n+\n+        user = new User(adminAPI, username);\n+        user.setUserName(username);\n+        user.setPassword(password);\n+        user.setRole(Stream.of(role).collect(Collectors.toList()));", "originalCommit": "3994f0ab441d24fe38eb483cd94d7fb094145649", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}