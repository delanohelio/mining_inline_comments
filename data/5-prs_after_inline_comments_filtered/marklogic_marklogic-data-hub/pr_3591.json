{"pr_number": 3591, "pr_title": "DHFPROD-4308: Middle-Tier: Create extension to existing mapping artif\u2026", "pr_createdAt": "2020-02-19T18:32:11Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3591", "timeline": [{"oid": "444132446c8b57c288c4bcd0dbf51995d5df20e5", "url": "https://github.com/marklogic/marklogic-data-hub/commit/444132446c8b57c288c4bcd0dbf51995d5df20e5", "message": "DHFPROD-4308: Middle-Tier: Create extension to existing mapping artifact API", "committedDate": "2020-02-19T18:30:19Z", "type": "commit"}, {"oid": "35af2da18b5b64fabe60abf9cfda9f32755627c7", "url": "https://github.com/marklogic/marklogic-data-hub/commit/35af2da18b5b64fabe60abf9cfda9f32755627c7", "message": "DHFPROD-4308: moved the collection api endpoint to one-ui", "committedDate": "2020-02-19T19:42:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTU0NTQ1NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3591#discussion_r381545455", "bodyText": "This seems like it can be deleted?", "author": "rjrudin", "createdAt": "2020-02-19T21:08:57Z", "path": "one-ui/src/main/java/com/marklogic/hub/curation/controllers/CollectionsController.java", "diffHunk": "@@ -0,0 +1,4 @@\n+package com.marklogic.hub.curation.controllers;\n+\n+public class CollectionsController {", "originalCommit": "35af2da18b5b64fabe60abf9cfda9f32755627c7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTU3MDI0Mg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3591#discussion_r381570242", "bodyText": "my bad, something wrong during commit and push.", "author": "hao1st", "createdAt": "2020-02-19T21:59:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTU0NTQ1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk5MDg5Nw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3591#discussion_r381990897", "bodyText": "This is still in the PR, it should be removed, right?", "author": "rjrudin", "createdAt": "2020-02-20T13:16:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTU0NTQ1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU0NzM1MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3591#discussion_r382547350", "bodyText": "Let's put this in a separate PR for a separate sub-task under 3991. It needs a test for it, and we should instead use a new DS endpoint instead of continuing use of REST endpoints (and the mlCollections REST extension is doing too many things too, it's not just used for retrieving collections).", "author": "rjrudin", "createdAt": "2020-02-21T12:06:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTU0NTQ1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTU0NjUyOA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3591#discussion_r381546528", "bodyText": "This doesn't appear to be used anywhere, so it should be deleted.\nIf there is a need for it, I'd like to talk about it. There is nothing preventing a database from having millions of collections or more. And collections are implementation details - it's very rare that we ever want to expose them to users. So I'd want to think carefully about the requirement of \"Get me all the collections except 'internal' ones\".", "author": "rjrudin", "createdAt": "2020-02-19T21:11:10Z", "path": "one-ui/src/main/java/com/marklogic/hub/curation/services/CollectionsService.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Copyright 2012-2019 MarkLogic Corporation\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package com.marklogic.hub.web.service;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.marklogic.client.DatabaseClient;\n+import com.marklogic.client.extensions.ResourceManager;\n+import com.marklogic.client.extensions.ResourceServices;\n+import com.marklogic.client.io.JacksonHandle;\n+import com.marklogic.client.util.RequestParameters;\n+import com.marklogic.hub.HubConfig;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Service;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+@Service\n+public class CollectionsService {", "originalCommit": "35af2da18b5b64fabe60abf9cfda9f32755627c7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6326a9db7939d1a13605d5827a16ffa51d3d9273", "url": "https://github.com/marklogic/marklogic-data-hub/commit/6326a9db7939d1a13605d5827a16ffa51d3d9273", "message": "DHFPROD-4308: Fixed wrong commit/push", "committedDate": "2020-02-19T21:59:02Z", "type": "commit"}, {"oid": "93f88c8007e0dd01242e91c38a11ea4295216dd3", "url": "https://github.com/marklogic/marklogic-data-hub/commit/93f88c8007e0dd01242e91c38a11ea4295216dd3", "message": "DHFPROD-4308: changed entityName to targetEntity & simplify javascript query func", "committedDate": "2020-02-20T03:37:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTc1NjMyNQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3591#discussion_r381756325", "bodyText": "Does this go with the discussion we had today. Should this be @service or @component.", "author": "bsrikan", "createdAt": "2020-02-20T05:02:26Z", "path": "one-ui/src/main/java/com/marklogic/hub/curation/services/CollectionsManager.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/*\n+ * Copyright 2012-2019 MarkLogic Corporation\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package com.marklogic.hub.curation.services;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.marklogic.client.DatabaseClient;\n+import com.marklogic.client.extensions.ResourceManager;\n+import com.marklogic.client.extensions.ResourceServices;\n+import com.marklogic.client.io.JacksonHandle;\n+import com.marklogic.client.util.RequestParameters;\n+import com.marklogic.hub.oneui.models.HubConfigSession;\n+import java.util.ArrayList;\n+import java.util.List;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Service;\n+\n+@Service\n+public class CollectionsManager {", "originalCommit": "93f88c8007e0dd01242e91c38a11ea4295216dd3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk5MTE5MQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3591#discussion_r381991191", "bodyText": "I don't think this class is supposed to be in here, right? It's only used by CollectionsCOntroller, which isn't used - nor seems relevant to DHFPROD-4308.", "author": "rjrudin", "createdAt": "2020-02-20T13:17:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTc1NjMyNQ=="}], "type": "inlineReview"}, {"oid": "91c8cc4f9ff194cf371ef657160fc4e217b64a84", "url": "https://github.com/marklogic/marklogic-data-hub/commit/91c8cc4f9ff194cf371ef657160fc4e217b64a84", "message": "DHFPROD-4308: Optimize query to get configs grouped by entity", "committedDate": "2020-02-20T06:09:14Z", "type": "commit"}, {"oid": "fc5368ed4abad2fd4f6f8f907be46e49b26c9a81", "url": "https://github.com/marklogic/marklogic-data-hub/commit/fc5368ed4abad2fd4f6f8f907be46e49b26c9a81", "message": "DHFPROD-4308: changed annotation from service to component", "committedDate": "2020-02-20T06:30:25Z", "type": "commit"}, {"oid": "a8096d7050cece99405ee0892eed71dcbd23ebf7", "url": "https://github.com/marklogic/marklogic-data-hub/commit/a8096d7050cece99405ee0892eed71dcbd23ebf7", "message": "DHFPROD-4308: rename mapping and artifact", "committedDate": "2020-02-20T17:31:28Z", "type": "commit"}, {"oid": "1862b59a03cf8013bee16acb9bcb8c1b5ad5d870", "url": "https://github.com/marklogic/marklogic-data-hub/commit/1862b59a03cf8013bee16acb9bcb8c1b5ad5d870", "message": "DHFPROD-4308: add validateArtifact test cases", "committedDate": "2020-02-20T18:30:21Z", "type": "commit"}, {"oid": "b1694b237c4ba1ab2d7c7bf477cf29ab77699772", "url": "https://github.com/marklogic/marklogic-data-hub/commit/b1694b237c4ba1ab2d7c7bf477cf29ab77699772", "message": "DHFPROD-4308: rename a better variable and query simplification", "committedDate": "2020-02-20T19:48:59Z", "type": "commit"}]}