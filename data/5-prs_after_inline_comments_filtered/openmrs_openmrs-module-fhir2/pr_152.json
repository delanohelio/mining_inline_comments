{"pr_number": 152, "pr_title": "FM2-152: Update Encounter DAO and Service", "pr_createdAt": "2020-04-28T09:47:06Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY4OTk2Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416689967", "bodyText": "You shouldn't need to implement this method at all.", "author": "ibacher", "createdAt": "2020-04-28T15:06:15Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirEncounterDaoImpl.java", "diffHunk": "@@ -9,41 +9,31 @@\n  */\n package org.openmrs.module.fhir2.api.dao.impl;\n \n-import static org.hibernate.criterion.Restrictions.eq;\n-\n import java.util.Collection;\n \n import ca.uhn.fhir.rest.param.DateRangeParam;\n import ca.uhn.fhir.rest.param.ReferenceAndListParam;\n import lombok.AccessLevel;\n import lombok.Setter;\n import org.hibernate.Criteria;\n-import org.hibernate.SessionFactory;\n import org.openmrs.Encounter;\n import org.openmrs.module.fhir2.api.dao.FhirEncounterDao;\n-import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.beans.factory.annotation.Qualifier;\n import org.springframework.stereotype.Component;\n \n @Component\n @Setter(AccessLevel.PACKAGE)\n-public class FhirEncounterDaoImpl extends BaseDaoImpl implements FhirEncounterDao {\n-\t\n-\t@Autowired\n-\t@Qualifier(\"sessionFactory\")\n-\tprivate SessionFactory sessionFactory;\n+public class FhirEncounterDaoImpl extends BaseFhirDaoImpl<Encounter> implements FhirEncounterDao {\n \t\n \t@Override\n-\tpublic Encounter getEncounterByUuid(String uuid) {\n-\t\treturn (Encounter) sessionFactory.getCurrentSession().createCriteria(Encounter.class).add(eq(\"uuid\", uuid))\n-\t\t        .uniqueResult();\n+\tpublic Encounter get(String uuid) {\n+\t\treturn super.get(uuid);\n \t}", "originalCommit": "f606f192b9cea83100e305c8d30721d997c88e48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5NTIwMA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416795200", "bodyText": "@ibacher  thanks for the review ,,\ni getting abit confused here why the method should be implemented since its coming from the super class being extended and its only refactoring an already existing method with a change in the method name ..\nJust requesting for some more explanation here to help me better understand ..Thanks", "author": "gitcliff", "createdAt": "2020-04-28T17:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY4OTk2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5NjQxMQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416796411", "bodyText": "It doesn't need to be here at all. I think it's left in the FhirEncounterDao interface so we can include Javadoc documenting its use, but in the actual implementation, we can rely on the super class version.", "author": "ibacher", "createdAt": "2020-04-28T17:32:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY4OTk2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzMDgzMw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416830833", "bodyText": "thanks ,,have fixed it ..", "author": "gitcliff", "createdAt": "2020-04-28T18:26:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY4OTk2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY5MDUxNQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416690515", "bodyText": "This shouldn't be necessary to have here at all.", "author": "ibacher", "createdAt": "2020-04-28T15:06:52Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirEncounterServiceImpl.java", "diffHunk": "@@ -37,8 +39,8 @@\n \t\n \t@Override\n \t@Transactional(readOnly = true)\n-\tpublic Encounter getEncounterByUuid(String uuid) {\n-\t\treturn translator.toFhirResource(dao.getEncounterByUuid(uuid));\n+\tpublic Encounter get(String uuid) {\n+\t\treturn translator.toFhirResource(dao.get(uuid));\n \t}", "originalCommit": "f606f192b9cea83100e305c8d30721d997c88e48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzMTA3NQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416831075", "bodyText": "thanks ,,have removed it", "author": "gitcliff", "createdAt": "2020-04-28T18:26:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY5MDUxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY5NjEyMA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416696120", "bodyText": "Rather than explicitly generating these fields, I would add the annotation @Getter(AccessLevel.PROTECTED) right above the annotation for @Setter at the top of the class.", "author": "ibacher", "createdAt": "2020-04-28T15:13:54Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirEncounterServiceImpl.java", "diffHunk": "@@ -48,4 +50,14 @@ public Encounter getEncounterByUuid(String uuid) {\n \t\treturn dao.searchForEncounters(date, location, participant, subject).stream().map(translator::toFhirResource)\n \t\t        .collect(Collectors.toList());\n \t}\n+\t\n+\t@Override\n+\tprotected FhirDao<org.openmrs.Encounter> getDao() {\n+\t\treturn dao;\n+\t}\n+\t\n+\t@Override\n+\tprotected OpenmrsFhirTranslator<org.openmrs.Encounter, Encounter> getTranslator() {\n+\t\treturn translator;\n+\t}", "originalCommit": "f606f192b9cea83100e305c8d30721d997c88e48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgwNzI5Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416807297", "bodyText": "yes sure ,,,thanks", "author": "gitcliff", "createdAt": "2020-04-28T17:48:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY5NjEyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzMDM3NA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416830374", "bodyText": "have added it", "author": "gitcliff", "createdAt": "2020-04-28T18:25:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY5NjEyMA=="}], "type": "inlineReview"}, {"oid": "62280a8b5f606f2f5899827d2d9763665e6a22ce", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/62280a8b5f606f2f5899827d2d9763665e6a22ce", "message": "FM2-152:Update Encounter DAO and Service", "committedDate": "2020-04-28T18:22:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzMTUyNg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416831526", "bodyText": "Can we get rid of this comment?", "author": "ibacher", "createdAt": "2020-04-28T18:27:33Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirEncounterServiceImpl.java", "diffHunk": "@@ -24,22 +20,26 @@\n import org.springframework.stereotype.Component;\n import org.springframework.transaction.annotation.Transactional;\n \n+import ca.uhn.fhir.rest.param.DateRangeParam;\n+import ca.uhn.fhir.rest.param.ReferenceAndListParam;\n+import lombok.AccessLevel;\n+import lombok.Getter;\n+import lombok.Setter;\n+\n @Component\n @Transactional\n @Setter(AccessLevel.PACKAGE)\n-public class FhirEncounterServiceImpl implements FhirEncounterService {\n+@Getter(AccessLevel.PROTECTED)\n+public class FhirEncounterServiceImpl extends BaseFhirService<Encounter, org.openmrs.Encounter> implements FhirEncounterService {\n \t\n \t@Autowired\n \tFhirEncounterDao dao;\n \t\n \t@Autowired\n \tEncounterTranslator translator;\n \t\n-\t@Override\n-\t@Transactional(readOnly = true)\n-\tpublic Encounter getEncounterByUuid(String uuid) {\n-\t\treturn translator.toFhirResource(dao.getEncounterByUuid(uuid));\n-\t}\n+\n+\t//The get(String uuid) method which fetches the encounter by a uuid is handled in the FhirEncounterService interface ", "originalCommit": "62280a8b5f606f2f5899827d2d9763665e6a22ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg2Mjk0Mw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416862943", "bodyText": "i have removed them ..thanks", "author": "gitcliff", "createdAt": "2020-04-28T19:20:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzMTUyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzMTYxMA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416831610", "bodyText": "Can we get rid of this comment?", "author": "ibacher", "createdAt": "2020-04-28T18:27:43Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirEncounterDaoImpl.java", "diffHunk": "@@ -9,41 +9,28 @@\n  */\n package org.openmrs.module.fhir2.api.dao.impl;\n \n-import static org.hibernate.criterion.Restrictions.eq;\n-\n import java.util.Collection;\n \n import ca.uhn.fhir.rest.param.DateRangeParam;\n import ca.uhn.fhir.rest.param.ReferenceAndListParam;\n import lombok.AccessLevel;\n import lombok.Setter;\n import org.hibernate.Criteria;\n-import org.hibernate.SessionFactory;\n import org.openmrs.Encounter;\n import org.openmrs.module.fhir2.api.dao.FhirEncounterDao;\n-import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.beans.factory.annotation.Qualifier;\n import org.springframework.stereotype.Component;\n \n @Component\n @Setter(AccessLevel.PACKAGE)\n-public class FhirEncounterDaoImpl extends BaseDaoImpl implements FhirEncounterDao {\n-\t\n-\t@Autowired\n-\t@Qualifier(\"sessionFactory\")\n-\tprivate SessionFactory sessionFactory;\n+public class FhirEncounterDaoImpl extends BaseFhirDaoImpl<Encounter> implements FhirEncounterDao {\n \t\n-\t@Override\n-\tpublic Encounter getEncounterByUuid(String uuid) {\n-\t\treturn (Encounter) sessionFactory.getCurrentSession().createCriteria(Encounter.class).add(eq(\"uuid\", uuid))\n-\t\t        .uniqueResult();\n-\t}\n+\t//The get(String uuid) method which fetches the encounter by a uuid is handled in the FhirEncounterDao interface ", "originalCommit": "62280a8b5f606f2f5899827d2d9763665e6a22ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg2MzExNw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/152#discussion_r416863117", "bodyText": "i have removed them,,thanks", "author": "gitcliff", "createdAt": "2020-04-28T19:21:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzMTYxMA=="}], "type": "inlineReview"}, {"oid": "e0a2de5f0bf458bdce1738d19702cae8fee328ad", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/e0a2de5f0bf458bdce1738d19702cae8fee328ad", "message": "FM2-152:Update Encounter DAO and Service", "committedDate": "2020-04-28T19:13:33Z", "type": "forcePushed"}, {"oid": "9710fd1bb1f646af3ae00cd2061ffed20672cda2", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/9710fd1bb1f646af3ae00cd2061ffed20672cda2", "message": "FM2-152:Update Encounter Dao and Service", "committedDate": "2020-05-01T09:18:49Z", "type": "commit"}, {"oid": "9710fd1bb1f646af3ae00cd2061ffed20672cda2", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/9710fd1bb1f646af3ae00cd2061ffed20672cda2", "message": "FM2-152:Update Encounter Dao and Service", "committedDate": "2020-05-01T09:18:49Z", "type": "forcePushed"}]}