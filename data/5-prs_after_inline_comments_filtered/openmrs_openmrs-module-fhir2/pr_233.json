{"pr_number": 233, "pr_title": "FM2-234: Ensure search returns unique results", "pr_createdAt": "2020-06-27T16:43:12Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/233", "timeline": [{"oid": "bb51db7a4a131cb8ec0f0ae7f9172af4dda98932", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/bb51db7a4a131cb8ec0f0ae7f9172af4dda98932", "message": "FM2-234: Ensure search returns unique results", "committedDate": "2020-06-27T16:34:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg1MDc5Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/233#discussion_r446850792", "bodyText": "Remove the comments", "author": "corneliouzbett", "createdAt": "2020-06-29T08:17:26Z", "path": "api/src/test/java/org/openmrs/module/fhir2/api/search/DiagnosticReportSearchQueryImplTest.java", "diffHunk": "@@ -333,6 +335,24 @@ public void searchForDiagnosticReports_shouldReturnCorrectObsByPatientName() {\n \t\t    equalTo(DIAGNOSTIC_REPORT_UUID));\n \t}\n \t\n+\t@Test\n+\tpublic void searchForDiagnosticReports_shouldSearchForUniqueObsByPatientName() {\n+\t\tReferenceParam patientReference = new ReferenceParam(Patient.SP_NAME, \"Horatio Hornblower\");\n+\t\tReferenceAndListParam patientList = new ReferenceAndListParam();\n+\t\tpatientList.addValue(new ReferenceOrListParam().add(patientReference));\n+\t\t\n+\t\tSearchParameterMap theParams = new SearchParameterMap().addParameter(FhirConstants.PATIENT_REFERENCE_SEARCH_HANDLER,\n+\t\t    patientList);\n+\t\t\n+\t\tIBundleProvider results = search(theParams);\n+\t\t\n+\t\tassertThat(results, notNullValue());\n+\t\tassertThat(results.size(), equalTo(1));\n+\t\t\n+\t\tSet<String> resultSet = new HashSet<>(dao.getResultUuids(theParams));\n+\t\tassertThat(resultSet.size(), equalTo(1)); // 3 with repetitions", "originalCommit": "bb51db7a4a131cb8ec0f0ae7f9172af4dda98932", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg1ODUzNQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/233#discussion_r446858535", "bodyText": "I think the comments here justify that we are indeed not getting repeated results and should be kept. What do you think?", "author": "varung-31", "createdAt": "2020-06-29T08:30:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg1MDc5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjkwMTM1Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/233#discussion_r446901356", "bodyText": "That's fine with me \ud83d\udc4c", "author": "corneliouzbett", "createdAt": "2020-06-29T11:34:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg1MDc5Mg=="}], "type": "inlineReview"}]}