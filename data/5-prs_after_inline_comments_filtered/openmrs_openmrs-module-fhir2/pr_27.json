{"pr_number": 27, "pr_title": "Location telecom translator implementation", "pr_createdAt": "2020-01-15T14:31:55Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/27", "timeline": [{"oid": "ed5af414628a06c6a87b5460fd75603670199b52", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/ed5af414628a06c6a87b5460fd75603670199b52", "message": "Location telecom translator implementation", "committedDate": "2020-01-15T15:09:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkzNzMyMg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/27#discussion_r366937322", "bodyText": "Prefer this, It's more readable\nassertThat(contactPoint.getId(), notNullValue())\nassertThat(contactPoint.getId(), equalTo(LOCATION_ATTRIBUTE_UUID))", "author": "corneliouzbett", "createdAt": "2020-01-15T15:25:30Z", "path": "api/src/test/java/org/openmrs/module/fhir2/api/translators/impl/LocationTelecomTranslatorImplTest.java", "diffHunk": "@@ -0,0 +1,167 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import org.hl7.fhir.r4.model.ContactPoint;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import org.mockito.runners.MockitoJUnitRunner;\n+import org.openmrs.LocationAttribute;\n+import org.openmrs.LocationAttributeType;\n+import org.openmrs.api.LocationService;\n+import org.openmrs.module.fhir2.FhirConstants;\n+import org.openmrs.module.fhir2.api.FhirGlobalPropertyService;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertNotNull;\n+import static org.mockito.Mockito.when;\n+\n+@RunWith(MockitoJUnitRunner.class)\n+public class LocationTelecomTranslatorImplTest {\n+\t\n+\tprivate static final String CONTACT_POINT_ID = \"c0938432-1691-11df-97a5-7038c432aabf\";\n+\t\n+\tprivate static final String CONTACT_POINT_VALUE = \"Pipeline\";\n+\t\n+\tprivate static final String LOCATION_ATTRIBUTE_UUID = \"c0938432-1691-11df-97a5-7038c432abcd\";\n+\t\n+\tprivate static final String LOCATION_ATTRIBUTE_VALUE = \"Neiya street\";\n+\t\n+\tprivate static final String LOCATION_ATTRIBUTE_TYPE_UUID = \"abcde432-1691-11df-97a5-7038c432abcd\";\n+\t\n+\tprivate static final String LOCATION_ATTRIBUTE_TYPE_NAME = \"street name\";\n+\t\n+\tprivate static final String TEST_LOCATION_ATTRIBUTE_UUID = \"c0938432-1691-1111-97a5-7038c432abcd\";\n+\t\n+\tprivate static final String TEST_LOCATION_ATTRIBUTE_VALUE = \"Ngeria street\";\n+\t\n+\t@Mock\n+\tprivate LocationService locationService;\n+\t\n+\t@Mock\n+\tprivate FhirGlobalPropertyService propertyService;\n+\t\n+\tprivate LocationTelecomTranslatorImpl translator;\n+\t\n+\tprivate LocationAttribute locationAttribute;\n+\t\n+\tprivate ContactPoint contactPoint;\n+\t\n+\t@Before\n+\tpublic void setup() {\n+\t\ttranslator = new LocationTelecomTranslatorImpl();\n+\t\ttranslator.setLocationService(locationService);\n+\t\ttranslator.setGlobalPropertyService(propertyService);\n+\t\t\n+\t\tlocationAttribute = new LocationAttribute();\n+\t\tcontactPoint = new ContactPoint();\n+\t}\n+\t\n+\t@Test\n+\tpublic void toFhirResource_shouldTranslateUuidToId() {\n+\t\tlocationAttribute.setUuid(LOCATION_ATTRIBUTE_UUID);\n+\t\tlocationAttribute.setValue(LOCATION_ATTRIBUTE_VALUE);\n+\t\tcontactPoint = translator.toFhirResource(locationAttribute);\n+\t\tassertNotNull(contactPoint.getId());\n+\t\tassertEquals(contactPoint.getId(), LOCATION_ATTRIBUTE_UUID);", "originalCommit": "ed5af414628a06c6a87b5460fd75603670199b52", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkzODgzNw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/27#discussion_r366938837", "bodyText": "assertThat(locationAttribute.getUuid(), notNullValue())", "author": "corneliouzbett", "createdAt": "2020-01-15T15:27:50Z", "path": "api/src/test/java/org/openmrs/module/fhir2/api/translators/impl/LocationTelecomTranslatorImplTest.java", "diffHunk": "@@ -0,0 +1,167 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import org.hl7.fhir.r4.model.ContactPoint;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import org.mockito.runners.MockitoJUnitRunner;\n+import org.openmrs.LocationAttribute;\n+import org.openmrs.LocationAttributeType;\n+import org.openmrs.api.LocationService;\n+import org.openmrs.module.fhir2.FhirConstants;\n+import org.openmrs.module.fhir2.api.FhirGlobalPropertyService;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertNotNull;\n+import static org.mockito.Mockito.when;\n+\n+@RunWith(MockitoJUnitRunner.class)\n+public class LocationTelecomTranslatorImplTest {\n+\t\n+\tprivate static final String CONTACT_POINT_ID = \"c0938432-1691-11df-97a5-7038c432aabf\";\n+\t\n+\tprivate static final String CONTACT_POINT_VALUE = \"Pipeline\";\n+\t\n+\tprivate static final String LOCATION_ATTRIBUTE_UUID = \"c0938432-1691-11df-97a5-7038c432abcd\";\n+\t\n+\tprivate static final String LOCATION_ATTRIBUTE_VALUE = \"Neiya street\";\n+\t\n+\tprivate static final String LOCATION_ATTRIBUTE_TYPE_UUID = \"abcde432-1691-11df-97a5-7038c432abcd\";\n+\t\n+\tprivate static final String LOCATION_ATTRIBUTE_TYPE_NAME = \"street name\";\n+\t\n+\tprivate static final String TEST_LOCATION_ATTRIBUTE_UUID = \"c0938432-1691-1111-97a5-7038c432abcd\";\n+\t\n+\tprivate static final String TEST_LOCATION_ATTRIBUTE_VALUE = \"Ngeria street\";\n+\t\n+\t@Mock\n+\tprivate LocationService locationService;\n+\t\n+\t@Mock\n+\tprivate FhirGlobalPropertyService propertyService;\n+\t\n+\tprivate LocationTelecomTranslatorImpl translator;\n+\t\n+\tprivate LocationAttribute locationAttribute;\n+\t\n+\tprivate ContactPoint contactPoint;\n+\t\n+\t@Before\n+\tpublic void setup() {\n+\t\ttranslator = new LocationTelecomTranslatorImpl();\n+\t\ttranslator.setLocationService(locationService);\n+\t\ttranslator.setGlobalPropertyService(propertyService);\n+\t\t\n+\t\tlocationAttribute = new LocationAttribute();\n+\t\tcontactPoint = new ContactPoint();\n+\t}\n+\t\n+\t@Test\n+\tpublic void toFhirResource_shouldTranslateUuidToId() {\n+\t\tlocationAttribute.setUuid(LOCATION_ATTRIBUTE_UUID);\n+\t\tlocationAttribute.setValue(LOCATION_ATTRIBUTE_VALUE);\n+\t\tcontactPoint = translator.toFhirResource(locationAttribute);\n+\t\tassertNotNull(contactPoint.getId());\n+\t\tassertEquals(contactPoint.getId(), LOCATION_ATTRIBUTE_UUID);\n+\t}\n+\t\n+\t@Test\n+\tpublic void toFhirResource_shouldTranslateValueToContactPointValue() {\n+\t\tlocationAttribute.setUuid(LOCATION_ATTRIBUTE_UUID);\n+\t\tlocationAttribute.setValue(LOCATION_ATTRIBUTE_VALUE);\n+\t\tcontactPoint = translator.toFhirResource(locationAttribute);\n+\t\tassertNotNull(contactPoint.getValue());\n+\t\tassertEquals(contactPoint.getValue(), LOCATION_ATTRIBUTE_VALUE);\n+\t}\n+\t\n+\t@Test\n+\tpublic void toOpenmrsType_shouldTranslateIdToUuid() {\n+\t\tcontactPoint.setId(CONTACT_POINT_ID);\n+\t\tcontactPoint.setValue(CONTACT_POINT_VALUE);\n+\t\tlocationAttribute = translator.toOpenmrsType(contactPoint);\n+\t\tassertNotNull(locationAttribute.getUuid());", "originalCommit": "ed5af414628a06c6a87b5460fd75603670199b52", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk0MTU4OA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/27#discussion_r366941588", "bodyText": "Declared but not used? You should probably remove this", "author": "corneliouzbett", "createdAt": "2020-01-15T15:32:04Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/LocationTranslatorImpl.java", "diffHunk": "@@ -11,20 +11,45 @@\n \n import lombok.AccessLevel;\n import lombok.Setter;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.hl7.fhir.r4.model.ContactPoint;\n import org.hl7.fhir.r4.model.Location;\n+import org.openmrs.LocationAttribute;\n+import org.openmrs.LocationAttributeType;\n+import org.openmrs.api.LocationService;\n+import org.openmrs.module.fhir2.FhirConstants;\n+import org.openmrs.module.fhir2.api.FhirGlobalPropertyService;\n import org.openmrs.module.fhir2.api.translators.LocationAddressTranslator;\n+import org.openmrs.module.fhir2.api.translators.LocationTelecomTranslator;\n import org.openmrs.module.fhir2.api.translators.LocationTranslator;\n import org.springframework.stereotype.Component;\n \n import javax.inject.Inject;\n+import javax.validation.constraints.NotNull;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n \n @Component\n @Setter(AccessLevel.PACKAGE)\n public class LocationTranslatorImpl implements LocationTranslator {\n \t\n+\tprivate static Log log = LogFactory.getLog(LocationAddressTranslatorImpl.class);\n+\t", "originalCommit": "ed5af414628a06c6a87b5460fd75603670199b52", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4a7f024502061f334ea923c8daca3bd7a4523804", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/4a7f024502061f334ea923c8daca3bd7a4523804", "message": "Location telecom translator implementation", "committedDate": "2020-01-15T18:57:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA1MTUxMw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/27#discussion_r367051513", "bodyText": "Can you remove this file from this PR? Thanks!", "author": "ibacher", "createdAt": "2020-01-15T19:01:26Z", "path": "omod/src/main/java/org/openmrs/module/fhir2/web/servlet/FhirRestServlet.java", "diffHunk": "@@ -35,10 +35,10 @@\n public class FhirRestServlet extends RestfulServer {", "originalCommit": "4a7f024502061f334ea923c8daca3bd7a4523804", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA1NTkzNA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/27#discussion_r367055934", "bodyText": "done \ud83d\udc4d", "author": "jecihjoy", "createdAt": "2020-01-15T19:11:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA1MTUxMw=="}], "type": "inlineReview"}, {"oid": "3a496031166af8e56201b0477affedc698d034ac", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/3a496031166af8e56201b0477affedc698d034ac", "message": "Location telecom translator implementation", "committedDate": "2020-01-15T19:02:56Z", "type": "commit"}, {"oid": "3a496031166af8e56201b0477affedc698d034ac", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/3a496031166af8e56201b0477affedc698d034ac", "message": "Location telecom translator implementation", "committedDate": "2020-01-15T19:02:56Z", "type": "forcePushed"}]}