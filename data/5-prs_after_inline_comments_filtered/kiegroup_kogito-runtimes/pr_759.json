{"pr_number": 759, "pr_title": "KOGITO-3325 DMN hot reload manage accessor cache when stronglytyped", "pr_createdAt": "2020-09-11T21:28:19Z", "pr_url": "https://github.com/kiegroup/kogito-runtimes/pull/759", "timeline": [{"oid": "8c4902dec1a5329b62be2edfb58bca1627e4ea55", "url": "https://github.com/kiegroup/kogito-runtimes/commit/8c4902dec1a5329b62be2edfb58bca1627e4ea55", "message": "reproducer", "committedDate": "2020-09-11T21:27:15Z", "type": "commit"}, {"oid": "20b243758fde8de979cf23be2e0efd3c42b8f4d8", "url": "https://github.com/kiegroup/kogito-runtimes/commit/20b243758fde8de979cf23be2e0efd3c42b8f4d8", "message": "fix.", "committedDate": "2020-09-11T21:27:21Z", "type": "commit"}, {"oid": "3253398e4c6048d004c8ddeaa380cb9eadabd411", "url": "https://github.com/kiegroup/kogito-runtimes/commit/3253398e4c6048d004c8ddeaa380cb9eadabd411", "message": ".", "committedDate": "2020-09-11T21:29:15Z", "type": "commit"}, {"oid": "0d28dc450f80e45ba8b15486b653c2d8e8af6a69", "url": "https://github.com/kiegroup/kogito-runtimes/commit/0d28dc450f80e45ba8b15486b653c2d8e8af6a69", "message": ".", "committedDate": "2020-09-11T21:30:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY4OTY4Mw==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/759#discussion_r487689683", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                final static QuarkusDevModeTest test = new QuarkusDevModeTest().setArchiveProducer(\n          \n          \n            \n                        new Supplier<JavaArchive>() {\n          \n          \n            \n            \n          \n          \n            \n                            @Override\n          \n          \n            \n                            public JavaArchive get() {\n          \n          \n            \n                                JavaArchive ja = ShrinkWrap.create(JavaArchive.class)\n          \n          \n            \n                                        .addAsResource(\"application.properties.stronglytyped\", \"/application.properties\")\n          \n          \n            \n                                        .addAsResource(\"TrafficViolation.txt\", DMN_RESOURCE_FILE);\n          \n          \n            \n                                return ja;\n          \n          \n            \n                            }\n          \n          \n            \n                        });\n          \n          \n            \n                final static QuarkusDevModeTest test = new QuarkusDevModeTest().setArchiveProducer(\n          \n          \n            \n                        () -> ShrinkWrap.create(JavaArchive.class)\n          \n          \n            \n                                        .addAsResource(\"application.properties.stronglytyped\", \"/application.properties\")\n          \n          \n            \n                                        .addAsResource(\"TrafficViolation.txt\", DMN_RESOURCE_FILE));", "author": "danielezonca", "createdAt": "2020-09-14T06:57:15Z", "path": "kogito-quarkus-extension/integration-test-hot-reload/src/test/java/io/quarkus/it/kogito/decision/SimpleModifyHotReloadTest.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.quarkus.it.kogito.decision;\n+\n+import java.util.function.Supplier;\n+\n+import io.quarkus.test.QuarkusDevModeTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import io.restassured.response.ValidatableResponse;\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.spec.JavaArchive;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.RegisterExtension;\n+\n+import static io.restassured.RestAssured.given;\n+import static org.hamcrest.Matchers.is;\n+\n+public class SimpleModifyHotReloadTest {\n+\n+    static {\n+        RestAssured.enableLoggingOfRequestAndResponseIfValidationFails();\n+    }\n+\n+    private static final String PACKAGE = \"io.quarkus.it.kogito.decision\";\n+    private static final String RESOURCE_FILE_PATH = PACKAGE.replace( '.', '/' );\n+    private static final String DMN_RESOURCE_FILE = RESOURCE_FILE_PATH + \"/TrafficViolation.dmn\";\n+\n+    private static final String HTTP_TEST_PORT = \"65535\";\n+\n+    @RegisterExtension\n+    final static QuarkusDevModeTest test = new QuarkusDevModeTest().setArchiveProducer(\n+            new Supplier<JavaArchive>() {\n+\n+                @Override\n+                public JavaArchive get() {\n+                    JavaArchive ja = ShrinkWrap.create(JavaArchive.class)\n+                            .addAsResource(\"application.properties.stronglytyped\", \"/application.properties\")\n+                            .addAsResource(\"TrafficViolation.txt\", DMN_RESOURCE_FILE);\n+                    return ja;\n+                }\n+            });", "originalCommit": "0d28dc450f80e45ba8b15486b653c2d8e8af6a69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc2NTQ4Mw==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/759#discussion_r487765483", "bodyText": "rejected, lambda here is useless, we do Quarkus style which is anonymous class ;)", "author": "tarilabs", "createdAt": "2020-09-14T09:12:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY4OTY4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY5MDA3NA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/759#discussion_r487690074", "bodyText": "What about a comment to explain this code?", "author": "danielezonca", "createdAt": "2020-09-14T06:58:13Z", "path": "drools/kogito-dmn/src/main/java/org/kie/kogito/dmn/DMNKogito.java", "diffHunk": "@@ -60,6 +61,7 @@ public static DMNRuntime createGenericDMNRuntime(Reader... readers) {\n \n     public static DMNRuntime createGenericDMNRuntime(Function<String, KieRuntimeFactory> kiePMMLRuntimeFactoryFunction, Reader... readers) {\n         List<Resource> resources = Stream.of(readers).map(ReaderResource::new).collect(Collectors.toList());\n+        EvalHelper.clearGenericAccessorCache();", "originalCommit": "0d28dc450f80e45ba8b15486b653c2d8e8af6a69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzgyOTIyNQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/759#discussion_r487829225", "bodyText": "done \ud83d\udc4d", "author": "tarilabs", "createdAt": "2020-09-14T11:05:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY5MDA3NA=="}], "type": "inlineReview"}, {"oid": "68f510efb916460503f884e004b7ce4435e5d8f5", "url": "https://github.com/kiegroup/kogito-runtimes/commit/68f510efb916460503f884e004b7ce4435e5d8f5", "message": ".", "committedDate": "2020-09-14T11:04:52Z", "type": "commit"}]}