{"pr_number": 870, "pr_title": "KOGITO-3604 - Assign constant value to sub process model", "pr_createdAt": "2020-11-06T08:37:09Z", "pr_url": "https://github.com/kiegroup/kogito-runtimes/pull/870", "timeline": [{"oid": "c635bcc28effe9dec362c05ba5df76ac5bd7e293", "url": "https://github.com/kiegroup/kogito-runtimes/commit/c635bcc28effe9dec362c05ba5df76ac5bd7e293", "message": "KOGITO-3604 - Assign constant value to sub process model", "committedDate": "2020-11-10T08:37:57Z", "type": "forcePushed"}, {"oid": "c1b5136d7a435009cbf6dffec9dea91401ea7e7d", "url": "https://github.com/kiegroup/kogito-runtimes/commit/c1b5136d7a435009cbf6dffec9dea91401ea7e7d", "message": "KOGITO-3604 - Assign constant value to sub process model", "committedDate": "2020-11-10T08:44:35Z", "type": "forcePushed"}, {"oid": "5fc8f09162a37dd7086f7939c89ea13757a87ccc", "url": "https://github.com/kiegroup/kogito-runtimes/commit/5fc8f09162a37dd7086f7939c89ea13757a87ccc", "message": "KOGITO-3604 - Assign constant value to sub process model", "committedDate": "2020-11-10T10:45:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA1NDU1OQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/870#discussion_r527054559", "bodyText": "I assume this was added just to distinguish between assigning a constant and copying the value of the parent process variable to the subprocess model.", "author": "MarianMacik", "createdAt": "2020-11-19T17:08:30Z", "path": "jbpm/jbpm-bpmn2/src/main/java/org/jbpm/bpmn2/xml/CallActivityHandler.java", "diffHunk": "@@ -189,30 +192,31 @@ protected void readDataInputAssociation(org.w3c.dom.Node xmlNode, SubProcessNode\n \t\t\t}\n \t\t\tsubProcessNode.addInMapping(dataInputs.get(to), from, transformation);\n         } else {\n-            // targetRef\n-            String to = subNode.getTextContent();            \n-            // assignment\n-            subNode = subNode.getNextSibling();\n-            if (subNode != null) {\n-                org.w3c.dom.Node subSubNode = subNode.getFirstChild();\n-                NodeList nl = subSubNode.getChildNodes();\n-                if (nl.getLength() > 1) {\n-                    // not supported ?\n-                    subProcessNode.addInMapping(dataInputs.get(to), subSubNode.getTextContent());\n-                    return;\n-                } else if (nl.getLength() == 0) {\n-                    return;\n-                }\n-                Object result = null;\n-                Object from = nl.item(0);\n-                if (from instanceof Text) {\n-                    result = ((Text) from).getTextContent();\n-                } else {\n-                    result = nl.item(0);\n-                }\n-                subProcessNode.addInMapping(dataInputs.get(to), result.toString());\n-                \n-            }\n+\t\t\t// targetRef\n+\t\t\tString to = subNode.getTextContent();\n+\t\t\t// assignment\n+\t\t\tsubNode = subNode.getNextSibling();\n+\t\t\tif (subNode != null) {\n+\t\t\t\torg.w3c.dom.Node subSubNode = subNode.getFirstChild();\n+\t\t\t\tNodeList nl = subSubNode.getChildNodes();\n+\t\t\t\tif (nl.getLength() > 1) {\n+\t\t\t\t\t// not supported ?\n+\t\t\t\t\tsubProcessNode.addInAssociation(\n+\t\t\t\t\t\t\tnew DataAssociation(subSubNode.getTextContent(), dataInputs.get(to), singletonList(new Assignment(null, subSubNode.getTextContent(), to)), null));\n+\t\t\t\t\treturn;\n+\t\t\t\t} else if (nl.getLength() == 0) {\n+\t\t\t\t\treturn;\n+\t\t\t\t}\n+\t\t\t\tObject result = null;\n+\t\t\t\tObject from = nl.item(0);\n+\t\t\t\tif (from instanceof Text) {\n+\t\t\t\t\tresult = ((Text) from).getTextContent();\n+\t\t\t\t} else {\n+\t\t\t\t\tresult = nl.item(0);\n+\t\t\t\t}\n+\t\t\t\tsubProcessNode.addInAssociation(\n+\t\t\t\t\t\tnew DataAssociation(result.toString(), dataInputs.get(to), singletonList(new Assignment(null, result.toString(), to)), null));", "originalCommit": "5fc8f09162a37dd7086f7939c89ea13757a87ccc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzMzMTIxNQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/870#discussion_r527331215", "bodyText": "@MarianMacik correct.", "author": "cristianonicolai", "createdAt": "2020-11-20T01:13:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA1NDU1OQ=="}], "type": "inlineReview"}, {"oid": "929c5d30c0ff900c7ac3378f36b6149a5940017c", "url": "https://github.com/kiegroup/kogito-runtimes/commit/929c5d30c0ff900c7ac3378f36b6149a5940017c", "message": "KOGITO-3604 - Assign constant value to sub process model", "committedDate": "2020-11-20T01:14:27Z", "type": "forcePushed"}, {"oid": "6648f0b79eff67404933881602cd1c6f140b0693", "url": "https://github.com/kiegroup/kogito-runtimes/commit/6648f0b79eff67404933881602cd1c6f140b0693", "message": "KOGITO-3604 - Assign constant value to sub process model", "committedDate": "2020-11-24T04:13:08Z", "type": "commit"}, {"oid": "6648f0b79eff67404933881602cd1c6f140b0693", "url": "https://github.com/kiegroup/kogito-runtimes/commit/6648f0b79eff67404933881602cd1c6f140b0693", "message": "KOGITO-3604 - Assign constant value to sub process model", "committedDate": "2020-11-24T04:13:08Z", "type": "forcePushed"}]}