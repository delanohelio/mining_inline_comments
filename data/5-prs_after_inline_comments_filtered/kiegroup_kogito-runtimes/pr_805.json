{"pr_number": 805, "pr_title": "KOGITO-3477 - Refactoring protobuf generation", "pr_createdAt": "2020-10-05T10:16:09Z", "pr_url": "https://github.com/kiegroup/kogito-runtimes/pull/805", "timeline": [{"oid": "aee19c0003cb6ca965674b9722fcfb9812c8b511", "url": "https://github.com/kiegroup/kogito-runtimes/commit/aee19c0003cb6ca965674b9722fcfb9812c8b511", "message": "refactoring protobuf generation", "committedDate": "2020-10-05T10:12:31Z", "type": "commit"}, {"oid": "7a30cc8976777c2364e4781284001a998b0618ab", "url": "https://github.com/kiegroup/kogito-runtimes/commit/7a30cc8976777c2364e4781284001a998b0618ab", "message": "add undertow dependency in generated project", "committedDate": "2020-10-05T12:22:33Z", "type": "commit"}, {"oid": "adf467b06e49fe4c8f39df2d430ab70d2e845bbe", "url": "https://github.com/kiegroup/kogito-runtimes/commit/adf467b06e49fe4c8f39df2d430ab70d2e845bbe", "message": "refactoring", "committedDate": "2020-10-05T12:33:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU2NTg4MQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r499565881", "bodyText": "We have to keep writing this file directly to the FS since the protobuf generation code is a bit more complicated to be refactored (there are some procedures that need these files to be there before we really write the GeneratedFiles with the kogito file hanlder) and I'd like to do that in another dedicated ticket.", "author": "r00ta", "createdAt": "2020-10-05T12:37:47Z", "path": "kogito-codegen/src/main/java/org/kie/kogito/codegen/process/persistence/proto/AbstractProtoGenerator.java", "diffHunk": "@@ -41,34 +43,43 @@ public AbstractProtoGenerator() {\n     }\n \n     /**\n-     * Flushes the generated proto files into the FileSystem\n+     * Generates the proto files from the given model.\n      */\n-    public final void writeFilesToFS(final String processId, final String targetDirectory, final Proto modelProto) throws IOException {\n+    public final List<GeneratedFile> generateProtoFiles(final String processId, final String targetDirectory, final Proto modelProto) throws IOException {\n         String protoFileName = processId + \".proto\";\n-        List<Path> protoFilePaths = new ArrayList<>();\n-        protoFilePaths.add(Paths.get(targetDirectory, GENERATED_PROTO_PERSISTENCE_PATH + protoFileName));\n-        protoFilePaths.add(Paths.get(targetDirectory, GENERATED_PROTO_RES_PATH + protoFileName));\n-        for (Path protoFilePath : protoFilePaths) {\n-            Files.createDirectories(protoFilePath.getParent());\n-            Files.write(protoFilePath, modelProto.toString().getBytes(StandardCharsets.UTF_8));\n-        }\n+        List<GeneratedFile> protoFiles = new ArrayList<>();\n+\n+        protoFiles.add(new GeneratedFile(GeneratedFile.Type.GENERATED_CP_RESOURCE,\n+                                         GENERATED_PROTO_RES_PATH + protoFileName,\n+                                         modelProto.toString().getBytes(StandardCharsets.UTF_8))\n+        );\n+\n+        Path protoFilePath = Paths.get(targetDirectory, GENERATED_PROTO_PERSISTENCE_PATH + protoFileName);", "originalCommit": "adf467b06e49fe4c8f39df2d430ab70d2e845bbe", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0933f9f474e4dc29fedd8f958b2dffce933fc805", "url": "https://github.com/kiegroup/kogito-runtimes/commit/0933f9f474e4dc29fedd8f958b2dffce933fc805", "message": "Merge remote-tracking branch 'upstream/master' into KOGITO-3477-protobuf-refactoring", "committedDate": "2020-10-05T14:07:53Z", "type": "commit"}, {"oid": "6427d4e188650c32c64d76ba851e4b1d5597961f", "url": "https://github.com/kiegroup/kogito-runtimes/commit/6427d4e188650c32c64d76ba851e4b1d5597961f", "message": "fix tests", "committedDate": "2020-10-05T15:14:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY5MDExMg==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r499690112", "bodyText": "Maybe this is not a list? Since it's one protobuf file per process id?", "author": "ricardozanini", "createdAt": "2020-10-05T15:35:29Z", "path": "kogito-codegen/src/main/java/org/kie/kogito/codegen/process/persistence/proto/AbstractProtoGenerator.java", "diffHunk": "@@ -41,34 +43,43 @@ public AbstractProtoGenerator() {\n     }\n \n     /**\n-     * Flushes the generated proto files into the FileSystem\n+     * Generates the proto files from the given model.\n      */\n-    public final void writeFilesToFS(final String processId, final String targetDirectory, final Proto modelProto) throws IOException {\n+    public final List<GeneratedFile> generateProtoFiles(final String processId, final String targetDirectory, final Proto modelProto) throws IOException {", "originalCommit": "6427d4e188650c32c64d76ba851e4b1d5597961f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDExODY2MQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r500118661", "bodyText": "Refactored \ud83d\udc4d", "author": "r00ta", "createdAt": "2020-10-06T09:02:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY5MDExMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY5MjE2NQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r499692165", "bodyText": "Is this safe? Won't make sense to do some checks first? I understand that's unlikely, but we could see ArrayBounds | NPE exceptions in the log that would be hard to track. :/", "author": "ricardozanini", "createdAt": "2020-10-05T15:38:26Z", "path": "kogito-codegen/src/main/java/org/kie/kogito/codegen/process/persistence/proto/AbstractProtoGenerator.java", "diffHunk": "@@ -41,34 +43,43 @@ public AbstractProtoGenerator() {\n     }\n \n     /**\n-     * Flushes the generated proto files into the FileSystem\n+     * Generates the proto files from the given model.\n      */\n-    public final void writeFilesToFS(final String processId, final String targetDirectory, final Proto modelProto) throws IOException {\n+    public final List<GeneratedFile> generateProtoFiles(final String processId, final String targetDirectory, final Proto modelProto) throws IOException {\n         String protoFileName = processId + \".proto\";\n-        List<Path> protoFilePaths = new ArrayList<>();\n-        protoFilePaths.add(Paths.get(targetDirectory, GENERATED_PROTO_PERSISTENCE_PATH + protoFileName));\n-        protoFilePaths.add(Paths.get(targetDirectory, GENERATED_PROTO_RES_PATH + protoFileName));\n-        for (Path protoFilePath : protoFilePaths) {\n-            Files.createDirectories(protoFilePath.getParent());\n-            Files.write(protoFilePath, modelProto.toString().getBytes(StandardCharsets.UTF_8));\n-        }\n+        List<GeneratedFile> protoFiles = new ArrayList<>();\n+\n+        protoFiles.add(new GeneratedFile(GeneratedFile.Type.GENERATED_CP_RESOURCE,\n+                                         GENERATED_PROTO_RES_PATH + protoFileName,\n+                                         modelProto.toString().getBytes(StandardCharsets.UTF_8))\n+        );\n+\n+        Path protoFilePath = Paths.get(targetDirectory, GENERATED_PROTO_PERSISTENCE_PATH + protoFileName);\n+        Files.createDirectories(protoFilePath.getParent());\n+        Files.write(protoFilePath, modelProto.toString().getBytes(StandardCharsets.UTF_8));\n+\n+        return protoFiles;\n     }\n \n     /**\n-     * Reads from the persistence directory and generates a listing file ({@link #LISTING_FILE}) from its content\n+     * Iterates over the generated files and extract all the proto files. Then it creates and add to the generated files collection\n+     * a listing file ({@link #LISTING_FILE}) from its content.\n      *\n-     * @param targetDirectory target directory generated by Maven\n+     * @param generatedFiles  The list of generated files.\n+     * @param targetDirectory target directory generated by Maven.\n      * @throws IOException if something wrong occurs during I/O\n      */\n-    public final void generateProtoListing(final String targetDirectory) throws IOException {\n-        final Path persistencePath = Paths.get(targetDirectory, GENERATED_PROTO_RES_PATH);\n-        final List<String> fileList = new ArrayList<>();\n-        if (Files.isDirectory(persistencePath)) {\n-            for (final File protoFile : persistencePath.toFile().listFiles((dir, name) ->\n-                                                                                   name.toLowerCase().endsWith(PersistenceProtoFilesLabeler.PROTO_FILE_EXT))) {\n-                fileList.add(protoFile.getName());\n-            }\n+    public final Optional<GeneratedFile> generateProtoListingFile(Collection<GeneratedFile> generatedFiles, final String targetDirectory) throws IOException {\n+        List<String> fileNames = generatedFiles.stream()\n+                .filter(x -> x.relativePath().contains(GENERATED_PROTO_RES_PATH))\n+                .map(x -> x.relativePath().substring(x.relativePath().lastIndexOf(\"/\") + 1))", "originalCommit": "6427d4e188650c32c64d76ba851e4b1d5597961f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA5NTgzMw==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r500095833", "bodyText": "In theory this is not possible since we first check that the relative path contains GENERATED_PROTO_RES_PATH, which contains slashes. If GENERATED_PROTO_RES_PATH will change to a string without slashes, yeah, there will be exceptions we will be caught by the tests.\nFor me it's ok to leave it as it is since the relative path is static and well known, but if you think we should make some checks anyway I'll do that. Let me know what you think @ricardozanini", "author": "r00ta", "createdAt": "2020-10-06T08:27:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY5MjE2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE2NjgxOQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r500166819", "bodyText": "Oh don't mind. I just brought this up because I always fear the split with magic numbers combination! Hahaha", "author": "ricardozanini", "createdAt": "2020-10-06T10:24:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY5MjE2NQ=="}], "type": "inlineReview"}, {"oid": "ab7f9a9715361c0a7c93eae55dbd0c9fb9c03be8", "url": "https://github.com/kiegroup/kogito-runtimes/commit/ab7f9a9715361c0a7c93eae55dbd0c9fb9c03be8", "message": "filter non-class files in maven plugin", "committedDate": "2020-10-06T08:06:04Z", "type": "commit"}, {"oid": "ddc2a808d2070b877f601c4d76ae159e7d0734a7", "url": "https://github.com/kiegroup/kogito-runtimes/commit/ddc2a808d2070b877f601c4d76ae159e7d0734a7", "message": "Merge remote-tracking branch 'upstream/master' into KOGITO-3477-protobuf-refactoring", "committedDate": "2020-10-06T08:22:22Z", "type": "commit"}, {"oid": "6c18e4963a8922960c0c0b2225ee2d945ed9a4f6", "url": "https://github.com/kiegroup/kogito-runtimes/commit/6c18e4963a8922960c0c0b2225ee2d945ed9a4f6", "message": "refactoring", "committedDate": "2020-10-06T08:31:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTU5MjA2Ng==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r501592066", "bodyText": "I don't like that this method now has both return value and side effect (add file to generatedFiles).\nI would prefer to remove the side effect from here and move it to infinispanBasedPersistence.\nWhat about make generateModelClassProto a public method that accept a Collection<Class<?>> input + targetDirectory and returns a Collection<GeneratedFile>?\nAfter these two changes we can remove generatedFiles parameter from extractDataClasses.\nWdyt?", "author": "danielezonca", "createdAt": "2020-10-08T09:52:09Z", "path": "kogito-codegen/src/main/java/org/kie/kogito/codegen/process/persistence/proto/ReflectionProtoGenerator.java", "diffHunk": "@@ -83,9 +85,9 @@ public Proto generate(String messageComment, String fieldComment, String package\n                     dataModelClasses.add(propertyType);\n                 }\n \n-                generateModelClassProto(modelClazz, targetDirectory);\n+                generateModelClassProto(modelClazz, targetDirectory).ifPresent(generatedFiles::add);\n             }\n-            this.generateProtoListing(targetDirectory);\n+            this.generateProtoListingFile(generatedFiles, targetDirectory).ifPresent(generatedFiles::add);", "originalCommit": "6c18e4963a8922960c0c0b2225ee2d945ed9a4f6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5NTY5MQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r503295691", "bodyText": "I've refactored it, let me know wdyt @danielezonca", "author": "r00ta", "createdAt": "2020-10-12T13:27:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTU5MjA2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTU5NjUyOQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r501596529", "bodyText": "Why does generatedFiles contain files that you need to filter out?\nIn any case, what about add some log information? For example I think it could make sense to log (as debug) the number of generated files before and after the filter", "author": "danielezonca", "createdAt": "2020-10-08T09:59:16Z", "path": "kogito-maven-plugin/src/main/java/org/kie/kogito/maven/plugin/ProcessClassesMojo.java", "diffHunk": "@@ -113,18 +114,17 @@ public void execute() throws MojoExecutionException, MojoFailureException {\n                         parameters.add(t.getTypeName());\n                     }\n                 }\n-                \n+\n                 GeneratorContext context = GeneratorContext.ofResourcePath(kieSourcesDirectory);\n                 context.withBuildContext(discoverKogitoRuntimeContext(project));\n-                \n+\n                 String persistenceType = context.getApplicationProperty(\"kogito.persistence.type\").orElse(PersistenceGenerator.DEFAULT_PERSISTENCE_TYPE);\n                 PersistenceGenerator persistenceGenerator = new PersistenceGenerator(new File(project.getBuild().getDirectory()), modelClasses, !classes.isEmpty(), new ReflectionProtoGenerator(), cl, parameters, persistenceType);\n                 persistenceGenerator.setPackageName(appPackageName);\n                 persistenceGenerator.setDependencyInjection(discoverDependencyInjectionAnnotator(project));\n                 persistenceGenerator.setContext(context);\n                 Collection<GeneratedFile> generatedFiles = persistenceGenerator.generate();\n-\n-\n+                generatedFiles = generatedFiles.stream().filter(x -> x.getType().equals(GeneratedFile.Type.CLASS)).collect(Collectors.toList());", "originalCommit": "6c18e4963a8922960c0c0b2225ee2d945ed9a4f6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjI0ODE0OA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r502248148", "bodyText": "Hi @danielezonca, I'll try to summarize a bit:\n\nBefore this refactoring all the proto files were stored directly to the FS, while in kogito is the main processor that collects all the files that have to be generated and then write them. Since we have to use the main processor to write the static resources to the right place, we now have to collect all those resources into GeneratedFile envelops.\nThe current function ProcessClassesMojo.execute first of all generates some java classes and now also some static resources, after some calculations it calls CompilationResult result = JAVA_COMPILER.compile(sources, srcMfs, trgMfs, cl, settings);, but it raises some exceptions given that it expects to get only java classes. That's why we have to filter out all the non-java classes like the persistence files.", "author": "r00ta", "createdAt": "2020-10-09T07:47:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTU5NjUyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYwNDAyOA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r501604028", "bodyText": "Same as above", "author": "danielezonca", "createdAt": "2020-10-08T10:11:28Z", "path": "kogito-quarkus-extension/deployment/src/main/java/org/kie/kogito/quarkus/deployment/JandexProtoGenerator.java", "diffHunk": "@@ -205,18 +207,18 @@ private void addEnumField(FieldInfo field, ProtoEnum pEnum) {\n                     dataModelClasses.add(index.getClassByName(pd.type().name()));\n                 }\n \n-                generateModelClassProto(modelClazz, targetDirectory);\n+                generateModelClassProto(modelClazz, targetDirectory).ifPresent(generatedFiles::add);\n             }\n \n-            this.generateProtoListing(targetDirectory);\n+            this.generateProtoListingFile(generatedFiles, targetDirectory).ifPresent(generatedFiles::add);", "originalCommit": "6c18e4963a8922960c0c0b2225ee2d945ed9a4f6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY3OTAyMA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r501679020", "bodyText": "I have mixed feeling about this code, what if getGeneratedPersistenceFiles generates a file that is not a CLASS nor a GENERATED_CP_RESOURCE?", "author": "danielezonca", "createdAt": "2020-10-08T12:26:15Z", "path": "kogito-quarkus-extension/deployment/src/main/java/org/kie/kogito/quarkus/deployment/KogitoAssetsProcessor.java", "diffHunk": "@@ -288,12 +293,14 @@ private void generatePersistenceInfo(AppPaths appPaths, IndexView inputIndex) th\n         }\n         GeneratorContext context = buildContext(appPaths, index);\n         String persistenceType = context.getApplicationProperty(\"kogito.persistence.type\").orElse(PersistenceGenerator.DEFAULT_PERSISTENCE_TYPE);\n-        Collection<GeneratedFile> generatedFiles = getGeneratedPersistenceFiles(appPaths, index, usePersistence, parameters, context, persistenceType);\n+        Collection<GeneratedFile> persistenceGeneratedFiles = getGeneratedPersistenceFiles(appPaths, index, usePersistence, parameters, context, persistenceType);\n+        Collection<GeneratedFile> persistenceClasses = persistenceGeneratedFiles.stream().filter(x -> x.getType().equals(GeneratedFile.Type.CLASS)).collect(Collectors.toList());\n+        Collection<GeneratedFile> persistenceProtoFiles = persistenceGeneratedFiles.stream().filter(x -> x.getType().equals(GeneratedFile.Type.GENERATED_CP_RESOURCE)).collect(Collectors.toList());", "originalCommit": "6c18e4963a8922960c0c0b2225ee2d945ed9a4f6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjI1MTEyMw==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r502251123", "bodyText": "Same as above: given that now we put some resource files in the generatedFiles so that the kogito main procedure will store them, in the next lines of this function\n            InMemoryCompiler inMemoryCompiler = new InMemoryCompiler(appPaths.classesPaths,\n                                                                     curateOutcomeBuildItem.getEffectiveModel().getUserDependencies());\n            inMemoryCompiler.compile(persistenceClasses);\n\na compiler is called and it expects to get only java classes, that's why we have to remove the non-java classes from the generated files.", "author": "r00ta", "createdAt": "2020-10-09T07:53:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY3OTAyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQyNzkwNw==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r505427907", "bodyText": "What about add a similar check?\nif(persistenceGeneratedFiles.stream().anyMatch(x -> !x.getType().equals(GeneratedFile.Type.CLASS) && !x.getType().equals(GeneratedFile.Type.GENERATED_CP_RESOURCE))) {\n   throws new IllegalStateException(\"Only type CLASS and GENERATED_CP_RESOURCE expected here\");\n}", "author": "danielezonca", "createdAt": "2020-10-15T10:17:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY3OTAyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODM5ODU3OQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/805#discussion_r508398579", "bodyText": "Done \ud83d\udc4d", "author": "r00ta", "createdAt": "2020-10-20T10:45:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY3OTAyMA=="}], "type": "inlineReview"}, {"oid": "e9bd3cc9ece6334ac4168b3bfde88e71fd877c4b", "url": "https://github.com/kiegroup/kogito-runtimes/commit/e9bd3cc9ece6334ac4168b3bfde88e71fd877c4b", "message": "refactoring", "committedDate": "2020-10-09T07:54:02Z", "type": "commit"}, {"oid": "c41a4dcc98a35c673a99666c7fdfd3468275055d", "url": "https://github.com/kiegroup/kogito-runtimes/commit/c41a4dcc98a35c673a99666c7fdfd3468275055d", "message": "add check on generated persistence files", "committedDate": "2020-10-20T10:45:42Z", "type": "commit"}, {"oid": "9c9585e82d147cffad9d6dc8b9fa6db1a160fb27", "url": "https://github.com/kiegroup/kogito-runtimes/commit/9c9585e82d147cffad9d6dc8b9fa6db1a160fb27", "message": "Merge branch 'master' into KOGITO-3477-protobuf-refactoring", "committedDate": "2020-10-22T11:58:07Z", "type": "commit"}, {"oid": "45570e131c8f42590e7dc20db467a8c86ad1d1eb", "url": "https://github.com/kiegroup/kogito-runtimes/commit/45570e131c8f42590e7dc20db467a8c86ad1d1eb", "message": "Merge remote-tracking branch 'upstream/master' into KOGITO-3477-protobuf-refactoring", "committedDate": "2020-10-22T12:37:12Z", "type": "commit"}, {"oid": "311dc5d4b512c56836632a11c03f00de8be45917", "url": "https://github.com/kiegroup/kogito-runtimes/commit/311dc5d4b512c56836632a11c03f00de8be45917", "message": "Merge branch 'master' into KOGITO-3477-protobuf-refactoring", "committedDate": "2020-10-22T19:03:23Z", "type": "commit"}]}