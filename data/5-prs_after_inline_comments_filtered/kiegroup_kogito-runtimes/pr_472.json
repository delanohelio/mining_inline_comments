{"pr_number": 472, "pr_title": "KOGITO-1985 - Add Workflow Context for serverless workflow metadata", "pr_createdAt": "2020-04-22T20:01:35Z", "pr_url": "https://github.com/kiegroup/kogito-runtimes/pull/472", "timeline": [{"oid": "f757d9e8a954d5cc390c522188fe386bf80eed64", "url": "https://github.com/kiegroup/kogito-runtimes/commit/f757d9e8a954d5cc390c522188fe386bf80eed64", "message": "generator context for sw", "committedDate": "2020-04-22T19:54:20Z", "type": "commit"}, {"oid": "85fa6922d3a66b4758b7d9bb63f2536d443c9471", "url": "https://github.com/kiegroup/kogito-runtimes/commit/85fa6922d3a66b4758b7d9bb63f2536d443c9471", "message": "adding tests and update", "committedDate": "2020-04-22T19:55:07Z", "type": "commit"}, {"oid": "17f69263f8af64c827fdd859aaec8afed15abe60", "url": "https://github.com/kiegroup/kogito-runtimes/commit/17f69263f8af64c827fdd859aaec8afed15abe60", "message": "fix for tests", "committedDate": "2020-04-22T19:58:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI5NDMwOQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/472#discussion_r413294309", "bodyText": "Maybe move all those strings to constants?", "author": "ricardozanini", "createdAt": "2020-04-22T20:11:20Z", "path": "jbpm/jbpm-serverless-workflow/src/main/java/org/jbpm/serverless/workflow/parser/core/ServerlessWorkflowFactory.java", "diffHunk": "@@ -249,13 +256,13 @@ public WorkItemNode serviceNode(long id, String name, Function function, NodeCon\n         workItemNode.setWork(work);\n \n         work.setName(\"Service Task\");\n-        work.setParameter(\"Interface\", function.getMetadata().get(\"interface\"));\n-        work.setParameter(\"Operation\", function.getMetadata().get(\"operation\"));\n-        work.setParameter(\"interfaceImplementationRef\", function.getMetadata().get(\"interface\"));\n-        work.setParameter(\"operationImplementationRef\", function.getMetadata().get(\"operation\"));\n+        work.setParameter(\"Interface\", ServerlessWorkflowUtils.resolveFunctionMetadata(function, \"interface\", workflowAppContext));\n+        work.setParameter(\"Operation\", ServerlessWorkflowUtils.resolveFunctionMetadata(function, \"operation\", workflowAppContext));\n+        work.setParameter(\"interfaceImplementationRef\", ServerlessWorkflowUtils.resolveFunctionMetadata(function, \"interface\", workflowAppContext));\n+        work.setParameter(\"operationImplementationRef\", ServerlessWorkflowUtils.resolveFunctionMetadata(function, \"operation\", workflowAppContext));\n         work.setParameter(\"ParameterType\", JSON_NODE);\n-        String metaImpl = function.getMetadata().get(\"implementation\");\n-        if(metaImpl == null) {\n+        String metaImpl = ServerlessWorkflowUtils.resolveFunctionMetadata(function, \"implementation\", workflowAppContext);\n+        if (metaImpl == null || metaImpl.isEmpty()) {\n             metaImpl = \"Java\";\n         }\n         work.setParameter(\"implementation\", metaImpl);", "originalCommit": "17f69263f8af64c827fdd859aaec8afed15abe60", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzMwODc3Ng==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/472#discussion_r413308776", "bodyText": "ok. moved", "author": "tsurdilo", "createdAt": "2020-04-22T20:32:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI5NDMwOQ=="}], "type": "inlineReview"}, {"oid": "ee6b5b5e22d097b829c654d02fab077f37fb50e3", "url": "https://github.com/kiegroup/kogito-runtimes/commit/ee6b5b5e22d097b829c654d02fab077f37fb50e3", "message": "externalizing strings", "committedDate": "2020-04-22T20:31:37Z", "type": "commit"}, {"oid": "d518bf50aeb923d4f0da5208067b2f98c45e339e", "url": "https://github.com/kiegroup/kogito-runtimes/commit/d518bf50aeb923d4f0da5208067b2f98c45e339e", "message": "returning empty string rather than null", "committedDate": "2020-04-24T03:47:30Z", "type": "commit"}]}