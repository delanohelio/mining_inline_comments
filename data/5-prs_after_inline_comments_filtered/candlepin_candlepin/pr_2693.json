{"pr_number": 2693, "pr_title": "ENT-1885: Port RoleResource to spec-first", "pr_createdAt": "2020-04-30T06:47:21Z", "pr_url": "https://github.com/candlepin/candlepin/pull/2693", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzg4MjIwNA==", "url": "https://github.com/candlepin/candlepin/pull/2693#discussion_r417882204", "bodyText": "Not part of your changes but ownerCurator and permissionCurator are not used anymore so we could get rid of them.", "author": "Januson", "createdAt": "2020-04-30T09:35:58Z", "path": "server/src/main/java/org/candlepin/resource/RoleResource.java", "diffHunk": "@@ -30,38 +30,16 @@\n \n import com.google.inject.Inject;\n \n-import io.swagger.annotations.Api;\n-import io.swagger.annotations.ApiOperation;\n-import io.swagger.annotations.ApiParam;\n-import io.swagger.annotations.ApiResponse;\n-import io.swagger.annotations.ApiResponses;\n-import io.swagger.annotations.Authorization;\n-\n-import org.jboss.resteasy.annotations.providers.jaxb.Wrapped;\n import org.jboss.resteasy.spi.BadRequestException;\n import org.xnap.commons.i18n.I18n;\n \n import java.util.Collection;\n-import java.util.stream.Stream;\n-\n-import javax.ws.rs.Consumes;\n-import javax.ws.rs.DELETE;\n-import javax.ws.rs.GET;\n-import javax.ws.rs.POST;\n-import javax.ws.rs.PUT;\n-import javax.ws.rs.Path;\n-import javax.ws.rs.PathParam;\n-import javax.ws.rs.Produces;\n-import javax.ws.rs.core.MediaType;\n-\n-\n+import java.util.stream.Collectors;\n \n /**\n- *\n+ * API implementation for Role operations\n  */\n-@Path(\"/roles\")\n-@Api(value = \"roles\", authorizations = { @Authorization(\"basic\") })\n-public class RoleResource {\n+public class RoleResource implements RolesApi {\n \n     private UserServiceAdapter userService;\n     private OwnerCurator ownerCurator;", "originalCommit": "02f115d098a694539a83a1ac3d2eee3e6d66de52", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzkxMTYwMw==", "url": "https://github.com/candlepin/candlepin/pull/2693#discussion_r417911603", "bodyText": "Fixed it.", "author": "wolfdale", "createdAt": "2020-04-30T10:28:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzg4MjIwNA=="}], "type": "inlineReview"}, {"oid": "72fecd242196b5604766e956629a2c92909d191e", "url": "https://github.com/candlepin/candlepin/commit/72fecd242196b5604766e956629a2c92909d191e", "message": "ENT-1885: Port RoleResource to spec-first", "committedDate": "2020-04-30T10:25:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUzODI0MQ==", "url": "https://github.com/candlepin/candlepin/pull/2693#discussion_r421538241", "bodyText": "There's no reason to change this into returning a Set. We can still return a Stream here, by the x-java-response: type: to java.util.stream.Stream from Iterable (check other examples in the spec file)", "author": "nikosmoum", "createdAt": "2020-05-07T14:15:20Z", "path": "server/src/main/java/org/candlepin/resource/RoleResource.java", "diffHunk": "@@ -283,14 +239,15 @@ public RoleDTO deleteUserFromRole(@PathParam(\"role_name\") String roleName,\n         return this.modelTranslator.translate(role, RoleDTO.class);\n     }\n \n-    @ApiOperation(notes = \"Retrieves a list of Roles\", value = \"getRoles\")\n-    @GET\n-    @Produces(MediaType.APPLICATION_JSON)\n-    @Wrapped(element = \"roles\")\n-    public Stream<RoleDTO> getRoles() {\n+    /**\n+     * {@InheritDoc}\n+     */\n+    @Override\n+    public Iterable<RoleDTO> getRoles() {\n         // TODO: Add in filter options\n \n         Collection<? extends RoleInfo> roles = this.userService.listRoles();\n-        return roles.stream().map(this.modelTranslator.getStreamMapper(RoleInfo.class, RoleDTO.class));\n+        return roles.stream().map(this.modelTranslator.getStreamMapper(RoleInfo.class, RoleDTO.class))\n+            .collect(Collectors.toSet());", "originalCommit": "72fecd242196b5604766e956629a2c92909d191e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTkyNDY2NQ==", "url": "https://github.com/candlepin/candlepin/pull/2693#discussion_r421924665", "bodyText": "Fixed it.", "author": "wolfdale", "createdAt": "2020-05-08T04:03:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUzODI0MQ=="}], "type": "inlineReview"}, {"oid": "8d15b7065d6d519147feb58b6359a70ee7aaa689", "url": "https://github.com/candlepin/candlepin/commit/8d15b7065d6d519147feb58b6359a70ee7aaa689", "message": "ENT-1885: Port RoleResource to spec-first", "committedDate": "2020-05-08T03:41:12Z", "type": "commit"}, {"oid": "8d15b7065d6d519147feb58b6359a70ee7aaa689", "url": "https://github.com/candlepin/candlepin/commit/8d15b7065d6d519147feb58b6359a70ee7aaa689", "message": "ENT-1885: Port RoleResource to spec-first", "committedDate": "2020-05-08T03:41:12Z", "type": "forcePushed"}]}