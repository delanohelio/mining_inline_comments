{"pr_number": 1508, "pr_title": "Apoc periodic iterate", "pr_createdAt": "2020-05-12T13:21:58Z", "pr_url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1508", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg0MTU0NA==", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1508#discussion_r423841544", "bodyText": "I don't think we need this you can use BatchMode#valueOf method instead", "author": "conker84", "createdAt": "2020-05-12T15:48:11Z", "path": "src/main/java/apoc/periodic/BatchMode.java", "diffHunk": "@@ -0,0 +1,44 @@\n+package apoc.periodic;\n+\n+import apoc.util.Util;\n+\n+import java.util.Arrays;\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+enum BatchMode {\n+    BATCH,\n+    BATCH_SINGLE,\n+    SINGLE;\n+\n+\n+    private static final Map<String, BatchMode> nameIndex =  new HashMap<>();\n+    static {\n+        for (BatchMode batchMode : BatchMode.values()) {\n+            nameIndex.put(batchMode.name(), batchMode);\n+        }\n+    }", "originalCommit": "e68a5488e696d5e341e46ba1328c06d3ee323c3e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg0MjMxNQ==", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1508#discussion_r423842315", "bodyText": "if we get rid of nameIndex you can change it into:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        BatchMode lookedUpBatchMode = nameIndex.get(batchMode.toString().toUpperCase());\n          \n          \n            \n                        BatchMode lookedUpBatchMode = BatchMode.valueOf(batchMode.toString().toUpperCase());", "author": "conker84", "createdAt": "2020-05-12T15:49:19Z", "path": "src/main/java/apoc/periodic/BatchMode.java", "diffHunk": "@@ -0,0 +1,44 @@\n+package apoc.periodic;\n+\n+import apoc.util.Util;\n+\n+import java.util.Arrays;\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+enum BatchMode {\n+    BATCH,\n+    BATCH_SINGLE,\n+    SINGLE;\n+\n+\n+    private static final Map<String, BatchMode> nameIndex =  new HashMap<>();\n+    static {\n+        for (BatchMode batchMode : BatchMode.values()) {\n+            nameIndex.put(batchMode.name(), batchMode);\n+        }\n+    }\n+\n+   static BatchMode fromIterateList(boolean iterateList) {\n+        return iterateList ? BATCH : SINGLE;\n+    }\n+\n+    static BatchMode fromConfig(Map<String,Object> config) {\n+        Object batchMode = config.get(\"batchMode\");\n+\n+        if(batchMode != null) {\n+            BatchMode lookedUpBatchMode = nameIndex.get(batchMode.toString().toUpperCase());", "originalCommit": "e68a5488e696d5e341e46ba1328c06d3ee323c3e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg0NDM2MQ==", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1508#discussion_r423844361", "bodyText": "And we can also get rid of the following exception", "author": "conker84", "createdAt": "2020-05-12T15:51:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg0MjMxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg0Mjk5NA==", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1508#discussion_r423842994", "bodyText": "Maybe a better name could be PeriodicUtils?\nAnd add a private constructor so we can prevent the initialization", "author": "conker84", "createdAt": "2020-05-12T15:50:13Z", "path": "src/main/java/apoc/periodic/PeriodicIterate.java", "diffHunk": "@@ -0,0 +1,44 @@\n+package apoc.periodic;\n+\n+import apoc.util.Util;\n+import org.neo4j.internal.helpers.collection.Pair;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+\n+public class PeriodicIterate {", "originalCommit": "e68a5488e696d5e341e46ba1328c06d3ee323c3e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f4e2997b946ddfea25afbf68212c85a9385a6c5b", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/f4e2997b946ddfea25afbf68212c85a9385a6c5b", "message": "introduce batchMode", "committedDate": "2020-05-13T13:13:46Z", "type": "commit"}, {"oid": "d0fd6c0390e4fb71ad2f2049e3d6886208afbe92", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/d0fd6c0390e4fb71ad2f2049e3d6886208afbe92", "message": "Wire up batch mode -> iterateList -> BATCH defaults", "committedDate": "2020-05-13T13:13:46Z", "type": "commit"}, {"oid": "e97c48221ab2a9800f6d96d7b972468bdf3b4687", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/e97c48221ab2a9800f6d96d7b972468bdf3b4687", "message": "tidying up the periodic execution docs", "committedDate": "2020-05-13T13:13:46Z", "type": "commit"}, {"oid": "9c7f1b006594a30709185612d6123356c87b4cc4", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/9c7f1b006594a30709185612d6123356c87b4cc4", "message": "add docs explaining how to use BATCH_SINGLE", "committedDate": "2020-05-13T13:13:46Z", "type": "commit"}, {"oid": "86f8e2302f34193ec34fa3e96a7e17a9da42d64b", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/86f8e2302f34193ec34fa3e96a7e17a9da42d64b", "message": "operation", "committedDate": "2020-05-13T13:13:46Z", "type": "commit"}, {"oid": "63f07c2b8b754cd0389ad3776845c046b4e8f8fa", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/63f07c2b8b754cd0389ad3776845c046b4e8f8fa", "message": "remove outer and inner", "committedDate": "2020-05-13T13:13:46Z", "type": "commit"}, {"oid": "f21894091d410059f6d3cbb6a35b3c71d2fafb5d", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/f21894091d410059f6d3cbb6a35b3c71d2fafb5d", "message": "inline iterateList", "committedDate": "2020-05-13T13:13:46Z", "type": "commit"}, {"oid": "bf502154d92e7ebd90b920cd90ed478691a83d3b", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/bf502154d92e7ebd90b920cd90ed478691a83d3b", "message": "andrea feedback", "committedDate": "2020-05-13T13:14:44Z", "type": "commit"}, {"oid": "bf502154d92e7ebd90b920cd90ed478691a83d3b", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/bf502154d92e7ebd90b920cd90ed478691a83d3b", "message": "andrea feedback", "committedDate": "2020-05-13T13:14:44Z", "type": "forcePushed"}]}