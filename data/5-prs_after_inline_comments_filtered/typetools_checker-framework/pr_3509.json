{"pr_number": 3509, "pr_title": "Add a new parameter \"-string\" to CFGVisualizeLauncher to print the string representation of the control flow graph.", "pr_createdAt": "2020-07-24T22:03:41Z", "pr_url": "https://github.com/typetools/checker-framework/pull/3509", "timeline": [{"oid": "11e855286a37a1b7a4988f132eaf7489289fabaf", "url": "https://github.com/typetools/checker-framework/commit/11e855286a37a1b7a4988f132eaf7489289fabaf", "message": "Now we can pass -string to make CFGVisualizeLauncher print string representation cfg.", "committedDate": "2020-07-20T19:45:22Z", "type": "commit"}, {"oid": "5420d323ed84b160bcbc142b1e7a072179d51eca", "url": "https://github.com/typetools/checker-framework/commit/5420d323ed84b160bcbc142b1e7a072179d51eca", "message": "Tweaks.", "committedDate": "2020-07-20T20:39:57Z", "type": "commit"}, {"oid": "03000ee1792c7114659ea1132f65d09ac9349961", "url": "https://github.com/typetools/checker-framework/commit/03000ee1792c7114659ea1132f65d09ac9349961", "message": "Pull the latest code.", "committedDate": "2020-07-24T21:54:35Z", "type": "commit"}, {"oid": "941bc4c421da136441600c50540a0e850b5c2ccf", "url": "https://github.com/typetools/checker-framework/commit/941bc4c421da136441600c50540a0e850b5c2ccf", "message": "Pass dataflow:checkNullness.", "committedDate": "2020-07-24T22:10:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQxNjUyMA==", "url": "https://github.com/typetools/checker-framework/pull/3509#discussion_r460416520", "bodyText": "What does \"without analysis\" mean?  It's here and in the method name.\nI realize this phrase exists elsewhere in the code (it's not your invention), but I don't understand it in the other places and its documentation could be improved throughout.  Thanks!", "author": "mernst", "createdAt": "2020-07-25T15:41:35Z", "path": "dataflow/src/main/java/org/checkerframework/dataflow/cfg/CFGVisualizeLauncher.java", "diffHunk": "@@ -116,6 +127,25 @@ protected void generateDOTofCFGWithoutAnalysis(\n         generateDOTofCFG(inputFile, outputDir, method, clas, pdf, verbose, null);\n     }\n \n+    /**\n+     * Generate the String representation of the CFG for a method without analysis.", "originalCommit": "941bc4c421da136441600c50540a0e850b5c2ccf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzY0Ng==", "url": "https://github.com/typetools/checker-framework/pull/3509#discussion_r460423646", "bodyText": "\"without analysis\" means that analysis=null. So analysis.performAnalysis(cfg); will not be executed. Only the control flow graph will be visualized.\nBefore this PR, you can generate the dot representation of the control flow graph by:\njava -Xbootclasspath/p:$CHECKERFRAMEWORK/checker/dist/javac.jar \\\n  -cp $CHECKERFRAMEWORK/checker/dist/checker.jar \\\n  org.checkerframework.dataflow.cfg.CFGVisualizeLauncher \\\nTest.java cfg -class Test -method test\n\nThen the dot files will be generated. (You can also add -pdf to generate pdf files.)\nBut there is no way to see the string representation from the command line.\nAfter this PR (add -string at the end of the command):\njava -Xbootclasspath/p:$CHECKERFRAMEWORK/checker/dist/javac.jar \\\n  -cp $CHECKERFRAMEWORK/checker/dist/checker.jar \\\n  org.checkerframework.dataflow.cfg.CFGVisualizeLauncher \\\nTest.java cfg -class Test -method test -string\n\nA string graph will be printed:\n2 -> 3\n3 -> 4\n4 -> 8\n4 -> 10\n8 -> 0\n10 -> 0\n\n2:\n<entry>\n\n3:\na   [ VariableDeclaration ]\n1   [ IntegerLiteral ]\na = 1   [ Assignment ]\nb   [ VariableDeclaration ]\n2   [ IntegerLiteral ]\nb = 2   [ Assignment ]\nc   [ VariableDeclaration ]\n3   [ IntegerLiteral ]\nc = 3   [ Assignment ]\na   [ LocalVariable ]\n0   [ IntegerLiteral ]\n(a > 0)   [ GreaterThan ]\n\n4:\nConditionalBlock: then: 8, else: 10\n\n8:\nd   [ VariableDeclaration ]\na   [ LocalVariable ]\nc   [ LocalVariable ]\n(a + c)   [ NumericalAddition ]\nd = (a + c)   [ Assignment ]\n\n10:\ne   [ VariableDeclaration ]\na   [ LocalVariable ]\nb   [ LocalVariable ]\n(a + b)   [ NumericalAddition ]\ne = (a + b)   [ Assignment ]\n\n0:\n<exit>\n\nI think this may be convenient when we only want to visualize a simple program.", "author": "xingweitian", "createdAt": "2020-07-25T17:01:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQxNjUyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ1ODU3OQ==", "url": "https://github.com/typetools/checker-framework/pull/3509#discussion_r460458579", "bodyText": "Thanks for the explanation.  I wrote some text for the manual (which is what I really wanted.)  Please check to see that it is accurate.\nI am not convinced I would want to use this, but I don't object to providing the feature.\nCould you please document it in the manual as well as in the changelog?", "author": "mernst", "createdAt": "2020-07-25T23:53:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQxNjUyMA=="}], "type": "inlineReview"}, {"oid": "f4317f77e7488ea73ed77cb5e3d6f4a28cca2fa8", "url": "https://github.com/typetools/checker-framework/commit/f4317f77e7488ea73ed77cb5e3d6f4a28cca2fa8", "message": "Explain \"without analysis\"", "committedDate": "2020-07-25T23:51:13Z", "type": "commit"}, {"oid": "3028dbece5c29c2a97a5c4efc7eb8274e055980c", "url": "https://github.com/typetools/checker-framework/commit/3028dbece5c29c2a97a5c4efc7eb8274e055980c", "message": "Merge remote-tracking branch 'typetools/master' into typetools-improve-cfgvisualizelauncher", "committedDate": "2020-07-27T02:25:50Z", "type": "commit"}, {"oid": "ea6cf84f380ba7ead826942c26a5cfec95b8ab45", "url": "https://github.com/typetools/checker-framework/commit/ea6cf84f380ba7ead826942c26a5cfec95b8ab45", "message": "Merge remote-tracking branch 'origin/typetools-improve-cfgvisualizelauncher' into typetools-improve-cfgvisualizelauncher", "committedDate": "2020-07-27T02:29:33Z", "type": "commit"}, {"oid": "52be206e5f46b1033be1a32d40cf10f5cb67e6d6", "url": "https://github.com/typetools/checker-framework/commit/52be206e5f46b1033be1a32d40cf10f5cb67e6d6", "message": "Pull the latest code.\nResolve comments.", "committedDate": "2020-07-27T03:41:51Z", "type": "commit"}, {"oid": "aadaebdba8853a0e7bc875e60aaf552d6f6db8a2", "url": "https://github.com/typetools/checker-framework/commit/aadaebdba8853a0e7bc875e60aaf552d6f6db8a2", "message": "Tweaks.", "committedDate": "2020-07-27T03:50:52Z", "type": "commit"}, {"oid": "3dca8f8229ebe5f95f017b3738b53afa5da4f972", "url": "https://github.com/typetools/checker-framework/commit/3dca8f8229ebe5f95f017b3738b53afa5da4f972", "message": "Revert unrelated changes.", "committedDate": "2020-07-27T03:59:14Z", "type": "commit"}, {"oid": "e2f02e9b9652da4ca52503c6c53df87694dd4ac2", "url": "https://github.com/typetools/checker-framework/commit/e2f02e9b9652da4ca52503c6c53df87694dd4ac2", "message": "Tweaks.", "committedDate": "2020-07-27T04:03:16Z", "type": "commit"}, {"oid": "81721d8b67d2eccdeebd3fc00027f2b68f69b4f5", "url": "https://github.com/typetools/checker-framework/commit/81721d8b67d2eccdeebd3fc00027f2b68f69b4f5", "message": "Put changelog entry in user-visible details", "committedDate": "2020-07-27T19:15:52Z", "type": "commit"}, {"oid": "c24d409531ac2db6c6eb9bead90804ce4e326106", "url": "https://github.com/typetools/checker-framework/commit/c24d409531ac2db6c6eb9bead90804ce4e326106", "message": "Make wording more precise", "committedDate": "2020-07-27T19:18:36Z", "type": "commit"}, {"oid": "01a5c7bba092f5a87a042e27f9aee8a80da31e83", "url": "https://github.com/typetools/checker-framework/commit/01a5c7bba092f5a87a042e27f9aee8a80da31e83", "message": "-pdf command-line option is not new", "committedDate": "2020-07-27T19:20:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTExNTMwNA==", "url": "https://github.com/typetools/checker-framework/pull/3509#discussion_r461115304", "bodyText": "This name suggests a file to me.  I would call it \"--outputdir\".", "author": "mernst", "createdAt": "2020-07-27T19:22:26Z", "path": "dataflow/src/main/java/org/checkerframework/dataflow/cfg/CFGVisualizeLauncher.java", "diffHunk": "@@ -53,12 +52,22 @@ public static void main(String[] args) {\n \n         String method = \"test\";\n         String clas = \"Test\";\n+        String output = \".\";\n         boolean pdf = false;\n         boolean error = false;\n         boolean verbose = false;\n+        boolean string = false;\n \n-        for (int i = 2; i < args.length; i++) {\n+        for (int i = 1; i < args.length; i++) {\n             switch (args[i]) {\n+                case \"-output\":", "originalCommit": "01a5c7bba092f5a87a042e27f9aee8a80da31e83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c2d90b5e63b014ba64b460e8e7460caff40405fa", "url": "https://github.com/typetools/checker-framework/commit/c2d90b5e63b014ba64b460e8e7460caff40405fa", "message": "Merge remote-tracking branch 'typetools/master' into typetools-improve-cfgvisualizelauncher", "committedDate": "2020-07-27T19:39:17Z", "type": "commit"}, {"oid": "970ac08a8778e968d17e509695532c082f75ddc9", "url": "https://github.com/typetools/checker-framework/commit/970ac08a8778e968d17e509695532c082f75ddc9", "message": "Resolve comments.", "committedDate": "2020-07-28T00:19:07Z", "type": "commit"}, {"oid": "2e491820c2d7c8940785009b96cefe3d7a6c7fd9", "url": "https://github.com/typetools/checker-framework/commit/2e491820c2d7c8940785009b96cefe3d7a6c7fd9", "message": "Resolve comments.", "committedDate": "2020-07-28T00:25:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjM3NDAzMQ==", "url": "https://github.com/typetools/checker-framework/pull/3509#discussion_r462374031", "bodyText": "Is == 0 clearer?", "author": "wmdietl", "createdAt": "2020-07-29T15:08:59Z", "path": "dataflow/src/main/java/org/checkerframework/dataflow/cfg/CFGVisualizeLauncher.java", "diffHunk": "@@ -38,12 +38,11 @@\n      */\n     public static void main(String[] args) {\n         CFGVisualizeLauncher cfgVisualizeLauncher = new CFGVisualizeLauncher();\n-        if (args.length < 2) {\n+        if (args.length < 1) {", "originalCommit": "2e491820c2d7c8940785009b96cefe3d7a6c7fd9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjM3NDMxNA==", "url": "https://github.com/typetools/checker-framework/pull/3509#discussion_r462374314", "bodyText": "Use -- for all mentions of flags.", "author": "wmdietl", "createdAt": "2020-07-29T15:09:20Z", "path": "dataflow/src/main/java/org/checkerframework/dataflow/cfg/CFGVisualizeLauncher.java", "diffHunk": "@@ -53,34 +52,48 @@ public static void main(String[] args) {\n \n         String method = \"test\";\n         String clas = \"Test\";\n+        String output = \".\";\n         boolean pdf = false;\n         boolean error = false;\n         boolean verbose = false;\n+        boolean string = false;\n \n-        for (int i = 2; i < args.length; i++) {\n+        for (int i = 1; i < args.length; i++) {\n             switch (args[i]) {\n-                case \"-pdf\":\n+                case \"--outputdir\":\n+                    if (i >= args.length - 1) {\n+                        cfgVisualizeLauncher.printError(\n+                                \"Did not find <outputdir> after -outputdir.\");", "originalCommit": "2e491820c2d7c8940785009b96cefe3d7a6c7fd9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjM3NzU2Mw==", "url": "https://github.com/typetools/checker-framework/pull/3509#discussion_r462377563", "bodyText": "Duplicate analysis.", "author": "wmdietl", "createdAt": "2020-07-29T15:13:40Z", "path": "dataflow/src/main/java/org/checkerframework/dataflow/cfg/CFGVisualizeLauncher.java", "diffHunk": "@@ -116,6 +136,26 @@ protected void generateDOTofCFGWithoutAnalysis(\n         generateDOTofCFG(inputFile, outputDir, method, clas, pdf, verbose, null);\n     }\n \n+    /**\n+     * Generate the String representation of the CFG for a method, only. Does no dataflow analysis\n+     * analysis.", "originalCommit": "2e491820c2d7c8940785009b96cefe3d7a6c7fd9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjM3OTMyNQ==", "url": "https://github.com/typetools/checker-framework/pull/3509#discussion_r462379325", "bodyText": "Make non-null.", "author": "wmdietl", "createdAt": "2020-07-29T15:15:56Z", "path": "dataflow/src/main/java/org/checkerframework/dataflow/cfg/CFGVisualizeLauncher.java", "diffHunk": "@@ -116,6 +136,26 @@ protected void generateDOTofCFGWithoutAnalysis(\n         generateDOTofCFG(inputFile, outputDir, method, clas, pdf, verbose, null);\n     }\n \n+    /**\n+     * Generate the String representation of the CFG for a method, only. Does no dataflow analysis\n+     * analysis.\n+     *\n+     * @param inputFile java source input file\n+     * @param method name of the method to generate the CFG for\n+     * @param clas name of the class which includes the method to generate the CFG for\n+     * @param verbose show verbose information in CFG\n+     * @return the String representation of the CFG\n+     */\n+    protected @Nullable String generateStringOfCFGWithoutAnalysis(", "originalCommit": "2e491820c2d7c8940785009b96cefe3d7a6c7fd9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjM3OTQ4Nw==", "url": "https://github.com/typetools/checker-framework/pull/3509#discussion_r462379487", "bodyText": "Return useful error message?", "author": "wmdietl", "createdAt": "2020-07-29T15:16:11Z", "path": "dataflow/src/main/java/org/checkerframework/dataflow/cfg/CFGVisualizeLauncher.java", "diffHunk": "@@ -116,6 +136,26 @@ protected void generateDOTofCFGWithoutAnalysis(\n         generateDOTofCFG(inputFile, outputDir, method, clas, pdf, verbose, null);\n     }\n \n+    /**\n+     * Generate the String representation of the CFG for a method, only. Does no dataflow analysis\n+     * analysis.\n+     *\n+     * @param inputFile java source input file\n+     * @param method name of the method to generate the CFG for\n+     * @param clas name of the class which includes the method to generate the CFG for\n+     * @param verbose show verbose information in CFG\n+     * @return the String representation of the CFG\n+     */\n+    protected @Nullable String generateStringOfCFGWithoutAnalysis(\n+            String inputFile, String method, String clas, boolean verbose) {\n+        @Nullable Map<String, Object> res = generateStringOfCFG(inputFile, method, clas, verbose, null);\n+        if (res != null) {\n+            return (String) res.get(\"stringGraph\");\n+        } else {\n+            return \"null\";", "originalCommit": "2e491820c2d7c8940785009b96cefe3d7a6c7fd9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a8bfe0c0f6d486e722f4d1df6ccb79b6d5d34d92", "url": "https://github.com/typetools/checker-framework/commit/a8bfe0c0f6d486e722f4d1df6ccb79b6d5d34d92", "message": "Merge remote-tracking branch 'typetools/master' into typetools-improve-cfgvisualizelauncher", "committedDate": "2020-07-29T20:58:34Z", "type": "commit"}, {"oid": "0ba26c2d43c4015be8e70d74d08acfc6a891f160", "url": "https://github.com/typetools/checker-framework/commit/0ba26c2d43c4015be8e70d74d08acfc6a891f160", "message": "Resolve comments.", "committedDate": "2020-07-29T21:15:14Z", "type": "commit"}, {"oid": "00e77218c52dd2137f6f278dbdc9c1ff94f62337", "url": "https://github.com/typetools/checker-framework/commit/00e77218c52dd2137f6f278dbdc9c1ff94f62337", "message": "Wording tweak.", "committedDate": "2020-07-29T23:32:33Z", "type": "commit"}, {"oid": "9790f91494cce2890ec86b5be1c19210b3e87aa8", "url": "https://github.com/typetools/checker-framework/commit/9790f91494cce2890ec86b5be1c19210b3e87aa8", "message": "Make block explicit.", "committedDate": "2020-07-29T23:35:50Z", "type": "commit"}]}