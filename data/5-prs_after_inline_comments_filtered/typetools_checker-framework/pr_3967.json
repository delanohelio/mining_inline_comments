{"pr_number": 3967, "pr_title": "Define method createWholeProgramInference", "pr_createdAt": "2020-12-03T23:04:41Z", "pr_url": "https://github.com/typetools/checker-framework/pull/3967", "timeline": [{"oid": "dd00d85c236f260231207e13c934caaa206327fb", "url": "https://github.com/typetools/checker-framework/commit/dd00d85c236f260231207e13c934caaa206327fb", "message": "Reduce differences against upstream", "committedDate": "2020-12-01T17:29:09Z", "type": "commit"}, {"oid": "ac32256de0aa9f5f96b577db6c16f11cbdae1f0a", "url": "https://github.com/typetools/checker-framework/commit/ac32256de0aa9f5f96b577db6c16f11cbdae1f0a", "message": "Merge branch 'master' of github.com:typetools/checker-framework", "committedDate": "2020-12-01T21:20:28Z", "type": "commit"}, {"oid": "8ea50f27ee7f99636ab5ac371b4f0896a72a5ba0", "url": "https://github.com/typetools/checker-framework/commit/8ea50f27ee7f99636ab5ac371b4f0896a72a5ba0", "message": "Merge branch 'master' of github.com:typetools/checker-framework", "committedDate": "2020-12-01T22:21:49Z", "type": "commit"}, {"oid": "a39cd271f79ba2e9cf4bc5e4a7f948165c30c335", "url": "https://github.com/typetools/checker-framework/commit/a39cd271f79ba2e9cf4bc5e4a7f948165c30c335", "message": "Merge branch 'master' of github.com:typetools/checker-framework", "committedDate": "2020-12-01T23:40:39Z", "type": "commit"}, {"oid": "3297300b35ce8a3286b1ac95c3d959da6204eedd", "url": "https://github.com/typetools/checker-framework/commit/3297300b35ce8a3286b1ac95c3d959da6204eedd", "message": "Merge branch 'master' of github.com:mernst/checker-framework", "committedDate": "2020-12-03T01:59:10Z", "type": "commit"}, {"oid": "5675628b4e254d6b9744186c5f320851b2301670", "url": "https://github.com/typetools/checker-framework/commit/5675628b4e254d6b9744186c5f320851b2301670", "message": "Merge branch 'master' of github.com:mernst/checker-framework", "committedDate": "2020-12-03T13:54:10Z", "type": "commit"}, {"oid": "5aa247f0035863f7900d9dac320d8689e7296acc", "url": "https://github.com/typetools/checker-framework/commit/5aa247f0035863f7900d9dac320d8689e7296acc", "message": "Merge branch 'master' of github.com:mernst/checker-framework", "committedDate": "2020-12-03T19:48:45Z", "type": "commit"}, {"oid": "00e15a8c367585700667b7bdd75be73d97014077", "url": "https://github.com/typetools/checker-framework/commit/00e15a8c367585700667b7bdd75be73d97014077", "message": "Define WholeProgramInferenceScenes.updateAnnotationSetInScene()", "committedDate": "2020-12-03T20:21:11Z", "type": "commit"}, {"oid": "6cda68f965eceeb6abb6b8d08844a8a0c33dc2f9", "url": "https://github.com/typetools/checker-framework/commit/6cda68f965eceeb6abb6b8d08844a8a0c33dc2f9", "message": "Define method createWholeProgramInference", "committedDate": "2020-12-03T20:22:46Z", "type": "commit"}, {"oid": "0672f46114248d1ee7260f0879107553e18cd60c", "url": "https://github.com/typetools/checker-framework/commit/0672f46114248d1ee7260f0879107553e18cd60c", "message": "Merge ../checker-framework-fork-mernst-branch-updateAnnotationSetInScene into createWholeProgramInference", "committedDate": "2020-12-03T20:26:55Z", "type": "commit"}, {"oid": "3e93724cb9af59252c1d3487f720eefdb19734e8", "url": "https://github.com/typetools/checker-framework/commit/3e93724cb9af59252c1d3487f720eefdb19734e8", "message": "Add Javadoc", "committedDate": "2020-12-03T22:18:53Z", "type": "commit"}, {"oid": "da5f248b16d079bd0c1d768207ea3e8420283df6", "url": "https://github.com/typetools/checker-framework/commit/da5f248b16d079bd0c1d768207ea3e8420283df6", "message": "Merge ../checker-framework-branch-master into createWholeProgramInference", "committedDate": "2020-12-03T23:06:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1OTYyOQ==", "url": "https://github.com/typetools/checker-framework/pull/3967#discussion_r536259629", "bodyText": "Should the AnnotatedTypeFactory parameter be removed?", "author": "smillst", "createdAt": "2020-12-04T17:29:31Z", "path": "framework/src/main/java/org/checkerframework/common/wholeprograminference/WholeProgramInference.java", "diffHunk": "@@ -151,6 +135,18 @@ void updateFromLocalAssignment(\n     void updateFromFieldAssignment(", "originalCommit": "da5f248b16d079bd0c1d768207ea3e8420283df6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI2MDM3Mg==", "url": "https://github.com/typetools/checker-framework/pull/3967#discussion_r536260372", "bodyText": "I don't think you need to pass the type factory anymore.", "author": "smillst", "createdAt": "2020-12-04T17:30:36Z", "path": "framework/src/main/java/org/checkerframework/common/wholeprograminference/WholeProgramInferenceScenes.java", "diffHunk": "@@ -256,22 +281,27 @@ public void updateFromLocalAssignment(\n                     // https://github.com/typetools/checker-framework/issues/682\n                     continue;\n                 }\n-                AnnotatedTypeMirror paramATM = atf.getAnnotatedType(vt);\n-                AnnotatedTypeMirror argATM = atf.getAnnotatedType(rhsTree);\n+                AnnotatedTypeMirror paramATM = atypeFactory.getAnnotatedType(vt);\n+                AnnotatedTypeMirror argATM = atypeFactory.getAnnotatedType(rhsTree);\n                 VariableElement ve = TreeUtils.elementFromDeclaration(vt);\n                 AField param =\n                         method.vivifyAndAddTypeMirrorToParameter(\n                                 i, argATM.getUnderlyingType(), ve.getSimpleName());\n                 updateAnnotationSetInScene(\n-                        param.type, TypeUseLocation.PARAMETER, argATM, paramATM, atf, jaifPath);\n+                        param.type,\n+                        TypeUseLocation.PARAMETER,\n+                        argATM,\n+                        paramATM,\n+                        atypeFactory,", "originalCommit": "da5f248b16d079bd0c1d768207ea3e8420283df6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI2MDc4NA==", "url": "https://github.com/typetools/checker-framework/pull/3967#discussion_r536260784", "bodyText": "Should this type factory be removed?", "author": "smillst", "createdAt": "2020-12-04T17:31:13Z", "path": "framework/src/main/java/org/checkerframework/common/wholeprograminference/WholeProgramInferenceScenes.java", "diffHunk": "@@ -256,22 +281,27 @@ public void updateFromLocalAssignment(\n                     // https://github.com/typetools/checker-framework/issues/682\n                     continue;\n                 }\n-                AnnotatedTypeMirror paramATM = atf.getAnnotatedType(vt);\n-                AnnotatedTypeMirror argATM = atf.getAnnotatedType(rhsTree);\n+                AnnotatedTypeMirror paramATM = atypeFactory.getAnnotatedType(vt);\n+                AnnotatedTypeMirror argATM = atypeFactory.getAnnotatedType(rhsTree);\n                 VariableElement ve = TreeUtils.elementFromDeclaration(vt);\n                 AField param =\n                         method.vivifyAndAddTypeMirrorToParameter(\n                                 i, argATM.getUnderlyingType(), ve.getSimpleName());\n                 updateAnnotationSetInScene(\n-                        param.type, TypeUseLocation.PARAMETER, argATM, paramATM, atf, jaifPath);\n+                        param.type,\n+                        TypeUseLocation.PARAMETER,\n+                        argATM,\n+                        paramATM,\n+                        atypeFactory,\n+                        jaifPath);\n                 break;\n             }\n         }\n     }\n \n     @Override\n     public void updateFromFieldAssignment(\n-            Node lhs, Node rhs, ClassTree classTree, AnnotatedTypeFactory atf) {\n+            Node lhs, Node rhs, ClassTree classTree, AnnotatedTypeFactory atypeFactory) {", "originalCommit": "da5f248b16d079bd0c1d768207ea3e8420283df6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI2MjM1OQ==", "url": "https://github.com/typetools/checker-framework/pull/3967#discussion_r536262359", "bodyText": "This method creates the WholeProgramInference. getWholeProgramInference returns it.  Also, I think this method should be protected.", "author": "smillst", "createdAt": "2020-12-04T17:33:38Z", "path": "framework/src/main/java/org/checkerframework/framework/type/AnnotatedTypeFactory.java", "diffHunk": "@@ -4520,4 +4518,13 @@ public boolean containsSameByClass(\n         }\n         return null;\n     }\n+\n+    /**\n+     * Returns a WholeProgramInference for use by this type factory.", "originalCommit": "da5f248b16d079bd0c1d768207ea3e8420283df6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "15e28cc0ef636f704eaa480a72f2d3899dc6d4c2", "url": "https://github.com/typetools/checker-framework/commit/15e28cc0ef636f704eaa480a72f2d3899dc6d4c2", "message": "Remove AnnotatedTypeFactory argument", "committedDate": "2020-12-04T18:24:07Z", "type": "commit"}]}