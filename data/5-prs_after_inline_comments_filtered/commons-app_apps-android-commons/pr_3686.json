{"pr_number": 3686, "pr_title": "Fixes #3639 (Fix Save State implementation of CheckBoxTriState )", "pr_createdAt": "2020-04-21T06:19:27Z", "pr_url": "https://github.com/commons-app/apps-android-commons/pull/3686", "timeline": [{"oid": "31c479bb19475e0455adc33f265fc94d9c48bb56", "url": "https://github.com/commons-app/apps-android-commons/commit/31c479bb19475e0455adc33f265fc94d9c48bb56", "message": "Fixes #3639\n* Removed custom save state implementatio of CheckBoxTriState\n* Save/Restore CheckBox state in NearbyParentFragment", "committedDate": "2020-04-21T06:14:54Z", "type": "commit"}, {"oid": "28f4aaa08d76df7b8c662d9bb2375efc02a389d4", "url": "https://github.com/commons-app/apps-android-commons/commit/28f4aaa08d76df7b8c662d9bb2375efc02a389d4", "message": "removed unused imports in CheckBoxTriStates", "committedDate": "2020-04-21T06:20:26Z", "type": "commit"}, {"oid": "cd3dc1ce3ad365c4cead6e662959338c99e57f01", "url": "https://github.com/commons-app/apps-android-commons/commit/cd3dc1ce3ad365c4cead6e662959338c99e57f01", "message": "set CheckBoxTriState onViewStateRestored", "committedDate": "2020-04-21T18:35:16Z", "type": "commit"}, {"oid": "431b2d2b1e92dd07f56b1640b91edfff1699bf84", "url": "https://github.com/commons-app/apps-android-commons/commit/431b2d2b1e92dd07f56b1640b91edfff1699bf84", "message": "Set Callback for CheckBoxTriState in onViewCreated as well, it maybe called before onViewRestored sometimes", "committedDate": "2020-04-22T08:45:52Z", "type": "commit"}, {"oid": "9f0f1328cd7550fb82299ef9c18d2f1a791d83ea", "url": "https://github.com/commons-app/apps-android-commons/commit/9f0f1328cd7550fb82299ef9c18d2f1a791d83ea", "message": "bug-fix restore check box state", "committedDate": "2020-04-22T16:50:48Z", "type": "commit"}, {"oid": "ebe2511e0b9f742425b7af72e8ec47e7d849a948", "url": "https://github.com/commons-app/apps-android-commons/commit/ebe2511e0b9f742425b7af72e8ec47e7d849a948", "message": "donot save checkbox state", "committedDate": "2020-04-23T17:00:38Z", "type": "commit"}, {"oid": "f0f4e182c0ddadd7754c0deb1b48ca60d456fbd8", "url": "https://github.com/commons-app/apps-android-commons/commit/f0f4e182c0ddadd7754c0deb1b48ca60d456fbd8", "message": "donot save checkbox's state in onSaveInstanceState", "committedDate": "2020-04-23T17:02:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM3MDY4Nw==", "url": "https://github.com/commons-app/apps-android-commons/pull/3686#discussion_r414370687", "bodyText": "I would expect zero changes to this file, if we just remove the state restoration in CheckboxTriState that is the minimal change to solve this issue", "author": "macgills", "createdAt": "2020-04-24T07:52:09Z", "path": "app/src/main/java/fr/free/nrw/commons/nearby/fragments/NearbyParentFragment.java", "diffHunk": "@@ -118,8 +118,9 @@\n \n public class NearbyParentFragment extends CommonsDaggerSupportFragment\n         implements NearbyParentFragmentContract.View,\n-        WikidataEditListener.WikidataP18EditListener, LocationUpdateListener {\n+        WikidataEditListener.WikidataP18EditListener, LocationUpdateListener ,CheckBoxTriStates.Callback{", "originalCommit": "f0f4e182c0ddadd7754c0deb1b48ca60d456fbd8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM4ODgxNQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3686#discussion_r414388815", "bodyText": "@macgills  We have removed the manual state restoration thing, but the android system also restores the view right so if we don't set the callback in such cases, it will throw an NPE, right?", "author": "ashishkumar468", "createdAt": "2020-04-24T08:22:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM3MDY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM5NTEzNg==", "url": "https://github.com/commons-app/apps-android-commons/pull/3686#discussion_r414395136", "bodyText": "This is called on master after onViewCreated\ncheckBoxTriStates.setCallback((o, state, b, b1) -> presenter.filterByMarkerType(o,state,b,b1));\n\nThere was an internal problem where the checkbox will throw an NPE if you don't set a click listener to it and it processes a click event, that should not be the case. That problem arose because the state restoration was happening before the click listener was set and your version of state restoration didn't use the isRestoring flag to prevent the state restoration being interpreted as human input.", "author": "macgills", "createdAt": "2020-04-24T08:32:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM3MDY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM5NjAxNg==", "url": "https://github.com/commons-app/apps-android-commons/pull/3686#discussion_r414396016", "bodyText": "I am still halfway through my morning coffee, that wasn't a great explanation...\nI'll perk up in a bit if you have any questions", "author": "macgills", "createdAt": "2020-04-24T08:33:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM3MDY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ3ODcxOQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3686#discussion_r414478719", "bodyText": "Fair point, done", "author": "ashishkumar468", "createdAt": "2020-04-24T10:44:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM3MDY4Nw=="}], "type": "inlineReview"}, {"oid": "5a9932f895f3fe469b3f9113601dbc64a30a93ff", "url": "https://github.com/commons-app/apps-android-commons/commit/5a9932f895f3fe469b3f9113601dbc64a30a93ff", "message": "reset changes in ProjectCodeStyleConfiguration", "committedDate": "2020-04-24T08:31:50Z", "type": "commit"}, {"oid": "95507bc7df4f6afd516d0642fb8e2cec49b787be", "url": "https://github.com/commons-app/apps-android-commons/commit/95507bc7df4f6afd516d0642fb8e2cec49b787be", "message": "reset changes in NearbyParentFragment", "committedDate": "2020-04-24T10:44:11Z", "type": "commit"}]}