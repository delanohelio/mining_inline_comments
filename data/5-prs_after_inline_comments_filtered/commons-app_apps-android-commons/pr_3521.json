{"pr_number": 3521, "pr_title": "Fixes #3465 Use AndroidX Pref", "pr_createdAt": "2020-03-15T23:23:34Z", "pr_url": "https://github.com/commons-app/apps-android-commons/pull/3521", "timeline": [{"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f", "url": "https://github.com/commons-app/apps-android-commons/commit/4f04d31da314daa0e239a37a7e4ec531c681108f", "message": "[WIP] Fixes #3465 Use AndroidX Pref", "committedDate": "2020-03-15T23:21:37Z", "type": "commit"}, {"oid": "c9f454372ff70dcbb149e5a714f0b01ad0190166", "url": "https://github.com/commons-app/apps-android-commons/commit/c9f454372ff70dcbb149e5a714f0b01ad0190166", "message": "Deleted Unused Files", "committedDate": "2020-03-16T16:59:39Z", "type": "commit"}, {"oid": "07618c8ad3dddf144381f6e052277f8b42e70a2e", "url": "https://github.com/commons-app/apps-android-commons/commit/07618c8ad3dddf144381f6e052277f8b42e70a2e", "message": "Added singleLineTitle", "committedDate": "2020-03-16T17:16:39Z", "type": "commit"}, {"oid": "812de25842c0b89ecaff36186fbd1b2beed52009", "url": "https://github.com/commons-app/apps-android-commons/commit/812de25842c0b89ecaff36186fbd1b2beed52009", "message": "Updated Gradle Properties", "committedDate": "2020-03-16T17:44:58Z", "type": "commit"}, {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7", "url": "https://github.com/commons-app/apps-android-commons/commit/6438e537752a963e3bddfdcb0ec73d3ec86a46e7", "message": "Migrated to Androidx", "committedDate": "2020-03-16T21:11:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyODYzOQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393528639", "bodyText": "I suspect this is a behaviour change", "author": "macgills", "createdAt": "2020-03-17T09:00:18Z", "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "diffHunk": "@@ -195,19 +167,14 @@ private void prepareLanguages() {\n         String languageCode = getCurrentLanguageCode();\n         if (languageCode.equals(\"\")){\n             // If current language code is empty, means none selected by user yet so use phone local\n-            langListPreference.setSummary(Locale.getDefault().getDisplayLanguage());", "originalCommit": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzMDU5MQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393530591", "bodyText": "I tested it for me it seems fine. I will revert this change if needed.", "author": "madhurgupta10", "createdAt": "2020-03-17T09:03:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyODYzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzNzc5NA==", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393537794", "bodyText": "Nope, I was wrong. Works great", "author": "macgills", "createdAt": "2020-03-17T09:16:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyODYzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MjQ0NQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393542445", "bodyText": "This variables has an overly broad scope, I would even say you could inline (cursor on the variable name, ctrl+alt+n or right click>refactor>inline) it and the other variables you just disable when not logged in because their variable names are just repeating their Pref keys, the varaible name doesn't help describe them better so I think findPreference(\"useAuthorName\").setEnabled(false) reads just as well", "author": "macgills", "createdAt": "2020-03-17T09:24:44Z", "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "diffHunk": "@@ -49,29 +44,21 @@\n     private ListPreference langListPreference;\n \n     @Override\n-    public void onCreate(Bundle savedInstanceState) {\n-        super.onCreate(savedInstanceState);\n+    public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {\n         ApplicationlessInjection\n-                .getInstance(getActivity().getApplicationContext())\n-                .getCommonsApplicationComponent()\n-                .inject(this);\n+            .getInstance(getActivity().getApplicationContext())\n+            .getCommonsApplicationComponent()\n+            .inject(this);\n \n-        // Load the preferences from an XML resource\n-        addPreferencesFromResource(R.xml.preferences);\n+        // Set the preferences from an XML resource\n+        setPreferencesFromResource(R.xml.preferences, rootKey);\n \n-        themeListPreference = (ListPreference) findPreference(Prefs.KEY_THEME_VALUE);\n+        themeListPreference = findPreference(Prefs.KEY_THEME_VALUE);\n         prepareTheme();\n \n-        //Check if the Author Name switch is enabled and appropriately handle the author name usage\n-        SwitchPreference useAuthorName = (SwitchPreference) findPreference(\"useAuthorName\");\n-        EditTextPreference authorName = (EditTextPreference) findPreference(\"authorName\");\n-        authorName.setEnabled(defaultKvStore.getBoolean(\"useAuthorName\", false));\n-        useAuthorName.setOnPreferenceChangeListener((preference, newValue) -> {\n-            authorName.setEnabled((Boolean)newValue);\n-            return true;\n-        });\n+        SwitchPreference useAuthorName = findPreference(\"useAuthorName\");", "originalCommit": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY0Mjg3MQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393642871", "bodyText": "Done!", "author": "madhurgupta10", "createdAt": "2020-03-17T12:29:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MjQ0NQ=="}], "type": "inlineReview"}, {"oid": "e96fc10f8aa4f94e6d0cc4f66c96df1b07597487", "url": "https://github.com/commons-app/apps-android-commons/commit/e96fc10f8aa4f94e6d0cc4f66c96df1b07597487", "message": "Inline Variable change", "committedDate": "2020-03-17T12:29:10Z", "type": "commit"}, {"oid": "f629c09154fd1c6c75153304d8b0ea8643299f46", "url": "https://github.com/commons-app/apps-android-commons/commit/f629c09154fd1c6c75153304d8b0ea8643299f46", "message": "optimise imports", "committedDate": "2020-03-17T12:30:28Z", "type": "commit"}, {"oid": "f3069f3deba74b97ccda2b7e7fd0fdcaccfe44d3", "url": "https://github.com/commons-app/apps-android-commons/commit/f3069f3deba74b97ccda2b7e7fd0fdcaccfe44d3", "message": "Fixed Crash on empty input", "committedDate": "2020-03-17T12:47:27Z", "type": "commit"}]}