{"pr_number": 3597, "pr_title": "exit app on back pressed in tutorial", "pr_createdAt": "2020-03-29T13:16:06Z", "pr_url": "https://github.com/commons-app/apps-android-commons/pull/3597", "timeline": [{"oid": "dd24136718685f3753fb24cc4b0751de3402c065", "url": "https://github.com/commons-app/apps-android-commons/commit/dd24136718685f3753fb24cc4b0751de3402c065", "message": "exit app on back pressed in tutorial", "committedDate": "2020-03-29T13:06:40Z", "type": "commit"}, {"oid": "3c03b327dad077c3db8df5c509858f1c23640b87", "url": "https://github.com/commons-app/apps-android-commons/commit/3c03b327dad077c3db8df5c509858f1c23640b87", "message": "exit app from ongoing tutorial", "committedDate": "2020-04-01T15:04:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk2OTYzNA==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r403969634", "bodyText": "does finishTask work too? I never want to have to think about task affinity", "author": "macgills", "createdAt": "2020-04-06T09:58:27Z", "path": "app/src/main/java/fr/free/nrw/commons/WelcomeActivity.java", "diffHunk": "@@ -86,7 +86,11 @@ public void onBackPressed() {\n         if (pager.getCurrentItem() != 0) {\n             pager.setCurrentItem(pager.getCurrentItem() - 1, true);\n         } else {\n-            finish();\n+            if(defaultKvStore.getBoolean(\"firstrun\",true)){\n+                finishAffinity();", "originalCommit": "3c03b327dad077c3db8df5c509858f1c23640b87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA3MjUwNA==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r404072504", "bodyText": "On app resume, loginActivity keeps calling WelcomeActivity if firstrun is set true. So it's kinda stuck in loop and that's why finish() doesn't work.\nfinishAndRemoveTask?", "author": "318anushka", "createdAt": "2020-04-06T13:03:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk2OTYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA4Mzg4MA==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r404083880", "bodyText": "finishTask()/finishAndRemoveTask() whatever works and doesn't mention affinities", "author": "macgills", "createdAt": "2020-04-06T13:20:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk2OTYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA5NTg2MA==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r404095860", "bodyText": "it requires min api 21 so i am using moveTaskToBack() instead", "author": "318anushka", "createdAt": "2020-04-06T13:37:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk2OTYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA5ODYwOA==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r404098608", "bodyText": "hmmm that moves us even further from what we want to express. I guess finishAffinity  is best here, it at least has the word finish in it", "author": "macgills", "createdAt": "2020-04-06T13:40:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk2OTYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDEwMjMwNg==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r404102306", "bodyText": "Exactly, or there is one more solution creating new intent and setting flag  FLAG_ACTIVITY_CLEAR_TOP", "author": "318anushka", "createdAt": "2020-04-06T13:45:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk2OTYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDEwNDg2NQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r404104865", "bodyText": "Or Welcome could be started for result, a cancel could be read as a finish for login,\npros: very explicit\ncons: way too much code.\nLets keep finishAffinity. it is easy to get rid of if minds change later.", "author": "macgills", "createdAt": "2020-04-06T13:49:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk2OTYzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk3MDA0MA==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r403970040", "bodyText": "we could call super here instead", "author": "macgills", "createdAt": "2020-04-06T09:59:03Z", "path": "app/src/main/java/fr/free/nrw/commons/WelcomeActivity.java", "diffHunk": "@@ -86,7 +86,11 @@ public void onBackPressed() {\n         if (pager.getCurrentItem() != 0) {\n             pager.setCurrentItem(pager.getCurrentItem() - 1, true);\n         } else {\n-            finish();\n+            if(defaultKvStore.getBoolean(\"firstrun\",true)){\n+                finishAffinity();\n+            } else{\n+                finish();", "originalCommit": "3c03b327dad077c3db8df5c509858f1c23640b87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA3Mzk0OQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r404073949", "bodyText": "instead of finish right?", "author": "318anushka", "createdAt": "2020-04-06T13:05:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk3MDA0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA4MzA4Mg==", "url": "https://github.com/commons-app/apps-android-commons/pull/3597#discussion_r404083082", "bodyText": "yes because it is the default behaviour of onBackpressed", "author": "macgills", "createdAt": "2020-04-06T13:18:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk3MDA0MA=="}], "type": "inlineReview"}, {"oid": "6919f55bb022270813ba2b1dd2c2c94aab0f6ac5", "url": "https://github.com/commons-app/apps-android-commons/commit/6919f55bb022270813ba2b1dd2c2c94aab0f6ac5", "message": "exit app on back press in tutorial", "committedDate": "2020-04-06T13:56:26Z", "type": "commit"}]}