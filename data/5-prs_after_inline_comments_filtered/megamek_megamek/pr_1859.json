{"pr_number": 1859, "pr_title": "Various QoL MapEditor changes and issue 1856", "pr_createdAt": "2020-04-17T13:47:31Z", "pr_url": "https://github.com/MegaMek/megamek/pull/1859", "timeline": [{"oid": "539732c81197a66a0aa010c0608bde2e663c7c9d", "url": "https://github.com/MegaMek/megamek/commit/539732c81197a66a0aa010c0608bde2e663c7c9d", "message": "MapEditor FileDialog remembers size", "committedDate": "2020-04-15T17:44:52Z", "type": "commit"}, {"oid": "da3e9f8349762508d6be3c4613b6b817b0eee73b", "url": "https://github.com/MegaMek/megamek/commit/da3e9f8349762508d6be3c4613b6b817b0eee73b", "message": "BoardEditor Positioning of various dialogs", "committedDate": "2020-04-15T18:07:16Z", "type": "commit"}, {"oid": "572e90ed0ff2b470749c2184543ebe4290394f76", "url": "https://github.com/MegaMek/megamek/commit/572e90ed0ff2b470749c2184543ebe4290394f76", "message": "Show invalid hexes on the minimap", "committedDate": "2020-04-16T15:52:00Z", "type": "commit"}, {"oid": "179916a4d3239e51ca9b0faf3a793c9f33dd5a7a", "url": "https://github.com/MegaMek/megamek/commit/179916a4d3239e51ca9b0faf3a793c9f33dd5a7a", "message": "Frame Title marks changes, safety prompt when exiting", "committedDate": "2020-04-16T19:55:17Z", "type": "commit"}, {"oid": "066b935e975dd935f9f8624d91aea9b4d38db239", "url": "https://github.com/MegaMek/megamek/commit/066b935e975dd935f9f8624d91aea9b4d38db239", "message": "Option to disable RandomMap dialog at MapEd start", "committedDate": "2020-04-17T12:46:33Z", "type": "commit"}, {"oid": "2daf54558914640724faff6595b8c80f3fbbaff1", "url": "https://github.com/MegaMek/megamek/commit/2daf54558914640724faff6595b8c80f3fbbaff1", "message": "Issue 1856: Bridges (orthos) now appear in the MapEd work hex", "committedDate": "2020-04-17T13:22:51Z", "type": "commit"}, {"oid": "047a45bbc43faa769b0f30312961f16c9dfd2fe8", "url": "https://github.com/MegaMek/megamek/commit/047a45bbc43faa769b0f30312961f16c9dfd2fe8", "message": "Correction to work hex size and JScrollpane setting", "committedDate": "2020-04-17T13:29:49Z", "type": "commit"}, {"oid": "83ff49b4f3e87e14e9d51b555543f42b4ffc34b3", "url": "https://github.com/MegaMek/megamek/commit/83ff49b4f3e87e14e9d51b555543f42b4ffc34b3", "message": "Editor JScrollpane scroll speed adjustment", "committedDate": "2020-04-17T13:32:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQyOTA1NQ==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410429055", "bodyText": "I think this is tab versus space spacing, which would be good to fix.", "author": "Windchild292", "createdAt": "2020-04-17T19:33:17Z", "path": "megamek/src/megamek/client/ui/swing/BoardEditor.java", "diffHunk": "@@ -1345,16 +1376,19 @@ private void updateWhenSelected() {\n             addSetTerrain();\n     }\n \n-    public void boardNew() {\n-    \tRandomMapDialog rmd = new RandomMapDialog(frame, this, null, mapSettings);\n-    \tboolean userCancel = rmd.activateDialog(bv.getTilesetManager().getThemes());\n-    \tif (!userCancel) {\n-    \t\tboard = BoardUtilities.generateRandom(mapSettings);\n-    \t\tgame.setBoard(board);\n-    \t\tcurfile = null;\n-    \t\tbutSourceFile.setEnabled(false);\n-    \t\tframe.setTitle(Messages.getString(\"BoardEditor.title\")); //$NON-NLS-1$\n-    \t\tmenuBar.setBoard(true);\n+    public void boardNew(boolean showDialog) {\n+        boolean userCancel = false;\n+        if (showDialog) {\n+            RandomMapDialog rmd = new RandomMapDialog(frame, this, null, mapSettings);\n+            userCancel = rmd.activateDialog(bv.getTilesetManager().getThemes());\n+        }\n+        if (!userCancel) {\n+            board = BoardUtilities.generateRandom(mapSettings);\n+            game.setBoard(board);\n+            curfile = null;\n+            butSourceFile.setEnabled(false);\n+            frame.setTitle(Messages.getString(\"BoardEditor.title\")); //$NON-NLS-1$\n+            menuBar.setBoard(true);\n     \t\tbvc.doLayout();\n     \t\tresetUndo();\n     \t\tchoTheme.setSelectedItem(mapSettings.getTheme());", "originalCommit": "83ff49b4f3e87e14e9d51b555543f42b4ffc34b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQzMDQ1MQ==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410430451", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                JOptionPane.showMessageDialog(frame, \"Could not open the file \"+curfile+\". \"+e.getMessage());\n          \n          \n            \n                                JOptionPane.showMessageDialog(frame, \"Could not open the file \" + curfile + \". \" + e.getMessage());", "author": "Windchild292", "createdAt": "2020-04-17T19:36:25Z", "path": "megamek/src/megamek/client/ui/swing/BoardEditor.java", "diffHunk": "@@ -1759,21 +1807,17 @@ public void actionPerformed(ActionEvent ae) {\n                 try {\n                     Desktop.getDesktop().open(curfile);\n                 } catch (IOException e) {\n-                    JOptionPane.showMessageDialog(this, \"Could not open the file \"+curfile+\". \"+e.getMessage());\n+                    ignoreHotKeys = true;\n+                    JOptionPane.showMessageDialog(frame, \"Could not open the file \"+curfile+\". \"+e.getMessage());", "originalCommit": "83ff49b4f3e87e14e9d51b555543f42b4ffc34b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQzMjY1OA==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410432658", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String title = Messages.getString(\"BoardEditor.title\"); //$NON-NLS-1$\n          \n          \n            \n                    if (curfile != null) {\n          \n          \n            \n                        title = Messages.getString(\"BoardEditor.title\") + curfile; //$NON-NLS-1$\n          \n          \n            \n                    }\n          \n          \n            \n                    String title = Messages.getString(\"BoardEditor.title\"); //$NON-NLS-1$\n          \n          \n            \n                    if (curfile != null) {\n          \n          \n            \n                        title += curfile;\n          \n          \n            \n                    }", "author": "Windchild292", "createdAt": "2020-04-17T19:41:06Z", "path": "megamek/src/megamek/client/ui/swing/BoardEditor.java", "diffHunk": "@@ -2069,6 +2124,31 @@ public boolean shouldIgnoreHotKeys() {\n                 || texTerrainLevel.hasFocus() || texTerrExits.hasFocus();\n     }\n     \n+    private void setDialogSize(JFileChooser dialog) {\n+        int width = guip.getBoardEditLoadWidth();\n+        int height = guip.getBoardEditLoadHeight();\n+        dialog.setPreferredSize(new Dimension(width, height));   \n+    }\n+    \n+    private void saveDialogSize(JComponent dialog) {\n+        guip.setBoardEditLoadHeight(dialog.getHeight());\n+        guip.setBoardEditLoadWidth(dialog.getWidth());\n+    }\n+    \n+    /** \n+     *  Sets the Board Editor frame title, adding the current file name if any\n+     *  and a \"*\" if the board has been changed.\n+     */\n+    private void setFrameTitle() {\n+        String title = Messages.getString(\"BoardEditor.title\"); //$NON-NLS-1$\n+        if (curfile != null) {\n+            title = Messages.getString(\"BoardEditor.title\") + curfile; //$NON-NLS-1$\n+        }", "originalCommit": "83ff49b4f3e87e14e9d51b555543f42b4ffc34b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQzMzA3NA==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410433074", "bodyText": "Is red really the best choice, given that some people can't see it?", "author": "Windchild292", "createdAt": "2020-04-17T19:42:06Z", "path": "megamek/src/megamek/client/ui/swing/MiniMap.java", "diffHunk": "@@ -728,6 +728,13 @@ protected synchronized void drawMapOrig() {\n                         paintCoord(gg, j, k, true);\n                     }\n                     addRoadElements(h, j, k);\n+                    // Color invalid hexes red when in the Map Editor\n+                    if ((m_game != null) && \n+                            (m_game.getPhase() == IGame.Phase.PHASE_UNKNOWN)\n+                            && !h.isValid(null)) {\n+                        gg.setColor(Color.RED);\n+                        paintCoord(gg, j, k, true);\n+                    }", "originalCommit": "83ff49b4f3e87e14e9d51b555543f42b4ffc34b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQzNDA0MA==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410434040", "bodyText": "Suggested change", "author": "Windchild292", "createdAt": "2020-04-17T19:44:07Z", "path": "megamek/src/megamek/client/ui/swing/RandomMapDialog.java", "diffHunk": "@@ -271,8 +274,22 @@ private JPanel setupTopPanel() {\n     }\n \n     private JPanel setupControlsPanel() {\n+        JPanel outerpanel = new JPanel(new BorderLayout());\n+        \n+        // The left-side panel contains only the Show on startup option\n+        JPanel leftPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 2, 2));\n+       \n+        // Add the option only when in the Map Editor\n+        if (CLIENT == null) {\n+            showAtStartButton.addActionListener(this);\n+            showAtStartButton.setMnemonic(showAtStartButton.getText().charAt(0));\n+            showAtStartButton.setSelected(guip.getBoardEdRndStart());\n+            leftPanel.add(showAtStartButton);\n+        }\n+        \n+        // The main panel with the Okay, Cancel etc. buttons\n         JPanel panel = new JPanel(new FlowLayout(FlowLayout.CENTER, 2, 2));\n-\n+        ", "originalCommit": "83ff49b4f3e87e14e9d51b555543f42b4ffc34b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8fac64340da2296ec12997298c3682c27c08f8fc", "url": "https://github.com/MegaMek/megamek/commit/8fac64340da2296ec12997298c3682c27c08f8fc", "message": "Corrections: remove tabs, Messages", "committedDate": "2020-04-18T06:28:13Z", "type": "commit"}, {"oid": "6e7f66fbf5ac8d0930b8d04862b6885dda65ed92", "url": "https://github.com/MegaMek/megamek/commit/6e7f66fbf5ac8d0930b8d04862b6885dda65ed92", "message": "Board saved status tracking correction", "committedDate": "2020-04-18T13:43:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMDA3NQ==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410720075", "bodyText": "I'm not sure about this name, as it took me a second to realise what it meant.", "author": "Windchild292", "createdAt": "2020-04-18T16:37:58Z", "path": "megamek/src/megamek/client/ui/swing/BoardEditor.java", "diffHunk": "@@ -1751,6 +1761,17 @@ private void showSettings() {\n         // Show the settings dialog.\n         setdlg.setVisible(true);\n     }\n+    \n+    private void freshBoardSettings() {", "originalCommit": "6e7f66fbf5ac8d0930b8d04862b6885dda65ed92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNjg3MA==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410726870", "bodyText": "Do you have a suggestion? Its not necessarily a new board, not necessarily a loaded board. updateUiForFreshBoard...", "author": "SJuliez", "createdAt": "2020-04-18T17:33:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMDA3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNzYzMQ==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410727631", "bodyText": "refreshBoardSettings? Not super fitting, but better. refreshBoardUI?", "author": "Windchild292", "createdAt": "2020-04-18T17:39:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMDA3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMDU2Mw==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410720563", "bodyText": "Why are you removing the original side of things?", "author": "Windchild292", "createdAt": "2020-04-18T16:41:53Z", "path": "megamek/src/megamek/client/ui/Messages.java", "diffHunk": "@@ -1,16 +1,16 @@\n-/*\n- * MegaMek - Copyright (C) 2005 Ben Mazur (bmazur@sev.org)\n- *\n- *  This program is free software; you can redistribute it and/or modify it\n- *  under the terms of the GNU General Public License as published by the Free\n- *  Software Foundation; either version 2 of the License, or (at your option)\n- *  any later version.\n- *\n- *  This program is distributed in the hope that it will be useful, but\n- *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n- *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License\n- *  for more details.\n- */\n+/*  \n+* MegaMek - Copyright (C) 2020 - The MegaMek Team  ", "originalCommit": "6e7f66fbf5ac8d0930b8d04862b6885dda65ed92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNzAzOQ==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410727039", "bodyText": "Please explain. Im not remotely an expert on copyright in software applications so I thought why not update it to the current example in the wiki.", "author": "SJuliez", "createdAt": "2020-04-18T17:34:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMDU2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNzM1Mg==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410727352", "bodyText": "I did that originally, but was told to instead leave the original and add the new line below it when I first started contributing. Hence the question.", "author": "Windchild292", "createdAt": "2020-04-18T17:37:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMDU2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNjE1OA==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410736158", "bodyText": "Basically we can't erase Ben's copyright on his work. Unless this is a total rewrite.", "author": "sixlettervariables", "createdAt": "2020-04-18T18:53:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMDU2Mw=="}], "type": "inlineReview"}, {"oid": "4a1821040b201c3130ef7537f28beb5d104d118e", "url": "https://github.com/MegaMek/megamek/commit/4a1821040b201c3130ef7537f28beb5d104d118e", "message": "Messages Copyright notice and code commenting/method rename", "committedDate": "2020-04-19T06:32:59Z", "type": "commit"}, {"oid": "be2c3720f230596a194679961ba287e11375fa95", "url": "https://github.com/MegaMek/megamek/commit/be2c3720f230596a194679961ba287e11375fa95", "message": "Accessibility: add Warning Color, default red, to the GUIPrefs", "committedDate": "2020-04-19T06:51:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDkzMTk5NQ==", "url": "https://github.com/MegaMek/megamek/pull/1859#discussion_r410931995", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                ((Graphics2D)g).setRenderingHint(\n          \n          \n            \n                                ((Graphics2D) g).setRenderingHint(", "author": "Windchild292", "createdAt": "2020-04-19T15:42:40Z", "path": "megamek/src/megamek/client/ui/swing/BoardEditor.java", "diffHunk": "@@ -2137,17 +2143,25 @@ public void paintComponent(Graphics g) {\n                     g.drawImage(newVar, 0, 0, this);\n                 }\n                 // add level and INVALID if necessary\n+                if (guip.getAntiAliasing()) {\n+                    ((Graphics2D)g).setRenderingHint(", "originalCommit": "be2c3720f230596a194679961ba287e11375fa95", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6ee9db60b300b7c6d19f1ab48534c6d12fcabd8a", "url": "https://github.com/MegaMek/megamek/commit/6ee9db60b300b7c6d19f1ab48534c6d12fcabd8a", "message": "Spacing amendment\n\nCo-Authored-By: Justin Bowen <39067288+Windchild292@users.noreply.github.com>", "committedDate": "2020-04-19T16:24:41Z", "type": "commit"}]}