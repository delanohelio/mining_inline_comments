{"pr_number": 1736, "pr_title": "[Parquet] Fix vectorized reads for negative decimals", "pr_createdAt": "2020-11-06T18:19:31Z", "pr_url": "https://github.com/apache/iceberg/pull/1736", "timeline": [{"oid": "986fceef212659482b85a73369fa5cb3a3b2f694", "url": "https://github.com/apache/iceberg/commit/986fceef212659482b85a73369fa5cb3a3b2f694", "message": "[Parquet] Fix vectorized reads for negative decimals", "committedDate": "2020-11-06T19:12:02Z", "type": "commit"}, {"oid": "986fceef212659482b85a73369fa5cb3a3b2f694", "url": "https://github.com/apache/iceberg/commit/986fceef212659482b85a73369fa5cb3a3b2f694", "message": "[Parquet] Fix vectorized reads for negative decimals", "committedDate": "2020-11-06T19:12:02Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk1MzU2NQ==", "url": "https://github.com/apache/iceberg/pull/1736#discussion_r518953565", "bodyText": "All tests need to use the Random that is passed in so that the values that are generated are deterministic and repeatable. That's what allows us to generated an iterator instead of a list in some cases, and makes it so if we do have a problem, we can repeat the test and debug.", "author": "rdblue", "createdAt": "2020-11-06T19:16:41Z", "path": "api/src/test/java/org/apache/iceberg/util/RandomUtil.java", "diffHunk": "@@ -31,6 +31,12 @@\n   private RandomUtil() {\n   }\n \n+  private static final Random NEGATIVE_VALUES = new Random();", "originalCommit": "986fceef212659482b85a73369fa5cb3a3b2f694", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk1NzIxNw==", "url": "https://github.com/apache/iceberg/pull/1736#discussion_r518957217", "bodyText": "For some reason, TestLocalScan#testRandomData() fails if I use the random passed in to do\nboolean negate = random.nextInt(2) == 1", "author": "samarthjain", "createdAt": "2020-11-06T19:24:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk1MzU2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk4NDA0OA==", "url": "https://github.com/apache/iceberg/pull/1736#discussion_r518984048", "bodyText": "Looks like this caused a test failure in TestSparkParquetWriter#testCorrectness also. Pushed a commit to get rid of the new Random.", "author": "samarthjain", "createdAt": "2020-11-06T20:16:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk1MzU2NQ=="}], "type": "inlineReview"}, {"oid": "0c747aa6a946d470c57d2a639fd0e3542ca02cbb", "url": "https://github.com/apache/iceberg/commit/0c747aa6a946d470c57d2a639fd0e3542ca02cbb", "message": "Get rid of the extra random", "committedDate": "2020-11-06T20:11:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk4NzIzOQ==", "url": "https://github.com/apache/iceberg/pull/1736#discussion_r518987239", "bodyText": "nit: extra space", "author": "aokolnychyi", "createdAt": "2020-11-06T20:24:43Z", "path": "api/src/test/java/org/apache/iceberg/util/RandomUtil.java", "diffHunk": "@@ -155,15 +160,15 @@ public static Object generateDictionaryEncodablePrimitive(Type.PrimitiveType pri\n         return true; // doesn't really matter for booleans since they are not dictionary encoded\n       case INTEGER:\n       case DATE:\n-        return value;\n+        return  negate(value) ? -1 * value : value;", "originalCommit": "0c747aa6a946d470c57d2a639fd0e3542ca02cbb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1f7f284868452d32de80383daa17336ea39f1e39", "url": "https://github.com/apache/iceberg/commit/1f7f284868452d32de80383daa17336ea39f1e39", "message": "Negative values for time/timestamp are invalid", "committedDate": "2020-11-06T20:47:26Z", "type": "commit"}]}