{"pr_number": 941, "pr_title": "Refactor metadata inheritance for manifest rewrites", "pr_createdAt": "2020-04-20T22:15:03Z", "pr_url": "https://github.com/apache/iceberg/pull/941", "timeline": [{"oid": "fc658d0632b084f60d81c48dcef248f785414bf3", "url": "https://github.com/apache/iceberg/commit/fc658d0632b084f60d81c48dcef248f785414bf3", "message": "Refactor manifest rewrite inherited metadata.", "committedDate": "2020-04-20T22:00:44Z", "type": "commit"}, {"oid": "13e4511f5a6caccc5ab0df7705c12e78d17e0ce9", "url": "https://github.com/apache/iceberg/commit/13e4511f5a6caccc5ab0df7705c12e78d17e0ce9", "message": "Fix checkstyle error.", "committedDate": "2020-04-21T17:45:57Z", "type": "commit"}, {"oid": "34c207ec5f3d0270235ced43880b0d2ddc51b9ee", "url": "https://github.com/apache/iceberg/commit/34c207ec5f3d0270235ced43880b0d2ddc51b9ee", "message": "Fix forward compatibility test.", "committedDate": "2020-04-21T19:09:39Z", "type": "forcePushed"}, {"oid": "89a107753b5a737582e47120d1fafa8600c9d6f4", "url": "https://github.com/apache/iceberg/commit/89a107753b5a737582e47120d1fafa8600c9d6f4", "message": "Fix forward compatibility test.", "committedDate": "2020-04-21T21:35:40Z", "type": "commit"}, {"oid": "89a107753b5a737582e47120d1fafa8600c9d6f4", "url": "https://github.com/apache/iceberg/commit/89a107753b5a737582e47120d1fafa8600c9d6f4", "message": "Fix forward compatibility test.", "committedDate": "2020-04-21T21:35:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyOTI5OA==", "url": "https://github.com/apache/iceberg/pull/941#discussion_r412529298", "bodyText": "This test needed to change because the update started catching that the manifest didn't have a snapshot ID for entries to inherit. The solution is to append the manifest like normal instead of using the commit API directly. To be able to commit the manifest without rewriting it (which fails on the fake partition data), this sets snapshot ID inheritance to true.", "author": "rdblue", "createdAt": "2020-04-21T22:16:32Z", "path": "spark/src/test/java/org/apache/iceberg/spark/source/TestForwardCompatibility.java", "diffHunk": "@@ -192,8 +197,7 @@ public void testSparkCanReadUnknownTransform() throws IOException {\n       manifestWriter.close();\n     }\n \n-    TableOperations ops = ((HasTableOperations) table).operations();\n-    ops.commit(ops.current(), ops.current().replaceCurrentSnapshot(new FakeSnapshot(manifestWriter.toManifestFile())));\n+    table.newFastAppend().appendManifest(manifestWriter.toManifestFile()).commit();", "originalCommit": "89a107753b5a737582e47120d1fafa8600c9d6f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7a517ee1784bf65790b5e18231c559ef312bda38", "url": "https://github.com/apache/iceberg/commit/7a517ee1784bf65790b5e18231c559ef312bda38", "message": "Remove unused imports.", "committedDate": "2020-04-21T23:00:16Z", "type": "commit"}]}