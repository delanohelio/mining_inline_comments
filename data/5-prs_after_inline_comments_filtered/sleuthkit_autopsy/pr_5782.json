{"pr_number": 5782, "pr_title": "6161 render waypoints different colors depending on their type", "pr_createdAt": "2020-04-07T16:35:47Z", "pr_url": "https://github.com/sleuthkit/autopsy/pull/5782", "timeline": [{"oid": "b8f2c693fd210a29db866f87f8781583db6d0105", "url": "https://github.com/sleuthkit/autopsy/commit/b8f2c693fd210a29db866f87f8781583db6d0105", "message": "6161: First steps at implementation", "committedDate": "2020-04-03T16:40:16Z", "type": "commit"}, {"oid": "161c792de4a2558fa285fd0944899a0b961422ac", "url": "https://github.com/sleuthkit/autopsy/commit/161c792de4a2558fa285fd0944899a0b961422ac", "message": "Merge branch 'develop' into 6161_geolocation_waypoint_render_diff", "committedDate": "2020-04-06T16:04:41Z", "type": "commit"}, {"oid": "b71e79c1a2e737017dad95272e35e975208b503d", "url": "https://github.com/sleuthkit/autopsy/commit/b71e79c1a2e737017dad95272e35e975208b503d", "message": "Merge branch 'develop' into 6161_geolocation_waypoint_render_diff", "committedDate": "2020-04-06T16:09:43Z", "type": "commit"}, {"oid": "95611cf4e301464d1e9746d7d075d411741cdd4a", "url": "https://github.com/sleuthkit/autopsy/commit/95611cf4e301464d1e9746d7d075d411741cdd4a", "message": "6161 Give different colors to different waypoint types", "committedDate": "2020-04-07T16:34:44Z", "type": "commit"}, {"oid": "fa1b9ff93037947b43e8805e2351559e777639e9", "url": "https://github.com/sleuthkit/autopsy/commit/fa1b9ff93037947b43e8805e2351559e777639e9", "message": "6161: Making codacy happy", "committedDate": "2020-04-07T18:06:26Z", "type": "commit"}, {"oid": "cbc8da324f8ce750675042a10a44e629ba5e759e", "url": "https://github.com/sleuthkit/autopsy/commit/cbc8da324f8ce750675042a10a44e629ba5e759e", "message": "6161 Restoring form", "committedDate": "2020-04-07T19:37:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NTk5MA==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405065990", "bodyText": "Why put the colors here instead of in Waypoint?  I would have added a getColor to Waypoint and have the subclass set the color if they want it to be something other than the default.", "author": "kellykelly3", "createdAt": "2020-04-07T19:42:11Z", "path": "Core/src/org/sleuthkit/autopsy/geolocation/MapWaypoint.java", "diffHunk": "@@ -64,6 +67,18 @@\n     private static final Logger logger = Logger.getLogger(MapWaypoint.class.getName());\n     private final static String HTML_PROP_FORMAT = \"<b>%s: </b>%s<br>\";\n     static private final SimpleDateFormat DATE_FORMAT = new SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm:ssX\", Locale.US);\n+    \n+    private static final Map<Integer, Color> artifactTypesToColors = new HashMap();\n+    \n+    static {\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_BOOKMARK.getTypeID(), Color.BLUE);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_LAST_KNOWN_LOCATION.getTypeID(), Color.RED);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_ROUTE.getTypeID(), Color.YELLOW);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_SEARCH.getTypeID(), Color.GREEN);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_TRACK.getTypeID(), Color.ORANGE);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_TRACKPOINT.getTypeID(), Color.ORANGE);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_METADATA_EXIF.getTypeID(), Color.CYAN);\n+    }", "originalCommit": "fa1b9ff93037947b43e8805e2351559e777639e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA5MDc3Ng==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405090776", "bodyText": "I don't think Waypoint, which seems to be a data representation of a waypoint, should be storing information about its color, which is more of a visual feature and has nothing to do with the data inside the waypoint object.", "author": "ethteck", "createdAt": "2020-04-07T20:26:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NTk5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEwNTA0NA==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405105044", "bodyText": "@rcordovano and I were talking about this the other day.  I think the Waypoint class (and its subclasses) will need to become a bit more than they are.  Adding a color property to them does not seem out of line as it is a property of the Waypoint.  I would like to see the color go there so that we can avoid this type checking.", "author": "kellykelly3", "createdAt": "2020-04-07T20:51:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NTk5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEzNTAyOA==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405135028", "bodyText": "@ethteck and @kellykelly3, working from the premise that I tentatively stated in another comment, i.e., that MapWaypoint is a view class wrapped around a Waypoint model class, it makes sense to me to put color properties here in the view class instead of in the data model class. It is my recollection that Waypoint imposes a data model on the weakly typed BlackboardArtifact construct beneath it, which is the justification for the class. I certainly am a fan of separating the model and the view.\nRegarding the future of the Waypoint class, in the cited conversation I was wondering about how the fact that the refactoring Brian requested at the SleuthKit level has given us a new concept of a Waypoint data model class. Specifically, a waypoint as a property of a route. At the time, the meaning of Waypoint in the context of the geolocation packages was no longer loaded into my brain, so I was starting to question whether or not TSK Waypoints could take the place of Autopsy geolocation Waypoints. That notion is not surviving the light of day. Even the cursory glance I have taken at this Autopsy code shows that TSK Waypoints and Autopsy Waypoints are orthogonal, despite the unfortunate similarity in their names. Like I said, a TSK Waypoint is a component of a route and exists to support Java serialization, while an Autopsy Waypoint imposes a welcome layer of abstraction over a family of related artifacts that have no mechanism for expressing that homogeneity in terms of the geolocation data display data model. I think that MapWaypoint and Waypopint are looking secure in their respective roles and are in accord with the Single Responsibility Principle (SRP).  So Kelly, I think what we hammered out together when this feature first appeared is holding up.", "author": "rcordovano", "createdAt": "2020-04-07T21:51:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NTk5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NjY3NQ==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405066675", "bodyText": "This class is probably big enough for its own class file now.  Leaving it in MapPanel just bloats the file.", "author": "kellykelly3", "createdAt": "2020-04-07T19:43:29Z", "path": "Core/src/org/sleuthkit/autopsy/geolocation/MapPanel.java", "diffHunk": "@@ -685,17 +689,85 @@ private void zoomOutBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FI\n      * Renderer for the map waypoints.\n      */\n     private class MapWaypointRenderer implements WaypointRenderer<MapWaypoint> {\n+        private final Map<Color, BufferedImage> imageCache = new HashMap<>();", "originalCommit": "fa1b9ff93037947b43e8805e2351559e777639e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA5MTAzMA==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405091030", "bodyText": "Okay, I'll move it out.", "author": "ethteck", "createdAt": "2020-04-07T20:27:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NjY3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEwMTU5MQ==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405101591", "bodyText": "MapWaypoint is not public, so it would require making it so to move this class out from being an inner class. I don't really think it's that large. Thoughts @rcordovano ?", "author": "ethteck", "createdAt": "2020-04-07T20:45:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NjY3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEwNjgxMg==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405106812", "bodyText": "You would not have to make it public.  By specifying neither public nor private at the class definition the class will be visible to all other classes in the package.\nPlease move it to its own class file.  I don't recall at the moment why I made MapPanel public that might be erroneous.", "author": "kellykelly3", "createdAt": "2020-04-07T20:55:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NjY3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTExODQ0OQ==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405118449", "bodyText": "@ethteck and @kellykelly3, some thoughts...\nNone of this code is public API, i.e., none of the packages we are discussing are visible to code outside of this NetBeans module / JAR. That give us some welcome flexibility in refactoring and evolving the code over time, versus getting it absolutely right the first time. This is a good thing.\nThe MapWaypoint class does seem to be fairly large, so that is an argument in favor of giving it its own file. However, that is not the only criterion for judging whether a class should be an inner class, at least in my opinion. In fact, I have I have wrestled long and hard with these types of decisions, and have not come to a universal conclusion or reliable rule of thumb. I think as a general guideline, if something has no meaning outside of its use in another class, it is a good candidate for an inner class. From what I am seeing, it looks like MapWaypoint is a view class wrapped around a Waypoint model class with usage outside of a MapPanel (but please correct me if I am wrong, I am guilty of code skimming here), so it does seem to merit its own file. It looks that has already been done, so I think that's fine. We can change it later if we wish.", "author": "rcordovano", "createdAt": "2020-04-07T21:17:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NjY3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU3Mzk4NA==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405573984", "bodyText": "@rcordovano I may have misunderstood your answer, but it seems like you're talking about whether MapWaypoint should have its own file. However, what Kelly is suggesting is that MapWaypointRenderer be its own file. Do you have an opinion on this?\nI tried to do so earlier, and for some reason I was getting errors saying MapWaypoint wasn't public despite both being classes being in the same package. Maybe that was just the IDE being buggy. I can try again if you think that's what we should do.", "author": "ethteck", "createdAt": "2020-04-08T14:36:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NjY3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTYzNzY5Nw==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405637697", "bodyText": "@ethteck and @kellykelly3, I was talking about the wrong class, which explains a lot. I apologize for any confusion caused by my confusion. I have to go with Ethan's argument for the location of MapWaypointRenderer. It is a small, private class which has no use outside of MapPanel. If we want to cut down the size of the MapPanel class, I think we need to look elsewhere.", "author": "rcordovano", "createdAt": "2020-04-08T16:03:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NjY3NQ=="}], "type": "inlineReview"}, {"oid": "5c3443cdec5066b2dc57d5a09348570ebc8cf01f", "url": "https://github.com/sleuthkit/autopsy/commit/5c3443cdec5066b2dc57d5a09348570ebc8cf01f", "message": "6161 Restored form, boosted selection brightness for now", "committedDate": "2020-04-07T20:30:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEwNzUwOA==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405107508", "bodyText": "new HashMap<>();", "author": "kellykelly3", "createdAt": "2020-04-07T20:56:20Z", "path": "Core/src/org/sleuthkit/autopsy/geolocation/MapWaypoint.java", "diffHunk": "@@ -64,6 +67,18 @@\n     private static final Logger logger = Logger.getLogger(MapWaypoint.class.getName());\n     private final static String HTML_PROP_FORMAT = \"<b>%s: </b>%s<br>\";\n     static private final SimpleDateFormat DATE_FORMAT = new SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm:ssX\", Locale.US);\n+    \n+    private static final Map<Integer, Color> artifactTypesToColors = new HashMap();", "originalCommit": "5c3443cdec5066b2dc57d5a09348570ebc8cf01f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEwODAwMQ==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405108001", "bodyText": "You are getting a warning for the use of the deprecated value, add the annotation to ignore the warning.", "author": "kellykelly3", "createdAt": "2020-04-07T20:57:13Z", "path": "Core/src/org/sleuthkit/autopsy/geolocation/MapWaypoint.java", "diffHunk": "@@ -64,6 +67,18 @@\n     private static final Logger logger = Logger.getLogger(MapWaypoint.class.getName());\n     private final static String HTML_PROP_FORMAT = \"<b>%s: </b>%s<br>\";\n     static private final SimpleDateFormat DATE_FORMAT = new SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm:ssX\", Locale.US);\n+    \n+    private static final Map<Integer, Color> artifactTypesToColors = new HashMap();\n+    \n+    static {\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_BOOKMARK.getTypeID(), Color.BLUE);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_LAST_KNOWN_LOCATION.getTypeID(), Color.RED);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_ROUTE.getTypeID(), Color.YELLOW);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_SEARCH.getTypeID(), Color.GREEN);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_TRACK.getTypeID(), Color.ORANGE);\n+        artifactTypesToColors.put(BlackboardArtifact.ARTIFACT_TYPE.TSK_GPS_TRACKPOINT.getTypeID(), Color.ORANGE);", "originalCommit": "5c3443cdec5066b2dc57d5a09348570ebc8cf01f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU2ODQzNw==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405568437", "bodyText": "The annotation isn't playing well with the static block apparently. I think it's a fair warning that will remind us to remove this deprecated artifact type once it's removed.\nEdit: well, if it's gone from sleuthkit I guess the code won't build anyway..", "author": "ethteck", "createdAt": "2020-04-08T14:28:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEwODAwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTYzNTczNw==", "url": "https://github.com/sleuthkit/autopsy/pull/5782#discussion_r405635737", "bodyText": "@ethteck and @kellykelly3, we will likely never remove the deprecated artifact type. At least not until there is a TSK 5, something which I currently have no reason to expect will happen soon. If we can't figure out where to put the suppress deprecation warnings annotation, we will just have to live with the warning. It will be annoying and more or less permanent, but we can only do our best within the constraints we have. I think that we shouldn't let this issue hold up the PR.", "author": "rcordovano", "createdAt": "2020-04-08T16:00:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEwODAwMQ=="}], "type": "inlineReview"}, {"oid": "6ef470b2aefe276225841f8c55824f7da2b3a1c3", "url": "https://github.com/sleuthkit/autopsy/commit/6ef470b2aefe276225841f8c55824f7da2b3a1c3", "message": "6161: Addressing PR comments", "committedDate": "2020-04-07T21:10:39Z", "type": "commit"}, {"oid": "0335b5a84410bf742daf38dd590a4c89e1d2da6f", "url": "https://github.com/sleuthkit/autopsy/commit/0335b5a84410bf742daf38dd590a4c89e1d2da6f", "message": "6161: Formatted files", "committedDate": "2020-04-07T21:11:59Z", "type": "commit"}, {"oid": "32c67382cca734993cddfc1d05ea410eea600db7", "url": "https://github.com/sleuthkit/autopsy/commit/32c67382cca734993cddfc1d05ea410eea600db7", "message": "6161: Fixing build", "committedDate": "2020-04-08T14:31:57Z", "type": "commit"}, {"oid": "3a110c2849cfcd72cab0dd693429d8bd65b5e00b", "url": "https://github.com/sleuthkit/autopsy/commit/3a110c2849cfcd72cab0dd693429d8bd65b5e00b", "message": "6161: Highlight color -> white", "committedDate": "2020-04-10T13:57:41Z", "type": "commit"}, {"oid": "e4f38daf5094460c36688e2a8e072172890e39ea", "url": "https://github.com/sleuthkit/autopsy/commit/e4f38daf5094460c36688e2a8e072172890e39ea", "message": "Merge branch 'develop' into 6161_geolocation_waypoint_render_diff", "committedDate": "2020-04-10T14:00:08Z", "type": "commit"}, {"oid": "e44251ce0b44499e8ee08f09b4bb23f962930530", "url": "https://github.com/sleuthkit/autopsy/commit/e44251ce0b44499e8ee08f09b4bb23f962930530", "message": "6161: Icons are now the color of their waypoint rather than the artifact type icon", "committedDate": "2020-04-10T16:30:10Z", "type": "commit"}, {"oid": "fdb013d407986fbd49e9014e90f41046155d08dd", "url": "https://github.com/sleuthkit/autopsy/commit/fdb013d407986fbd49e9014e90f41046155d08dd", "message": "6161: Hightlight color -> yellow", "committedDate": "2020-04-10T16:37:49Z", "type": "commit"}]}