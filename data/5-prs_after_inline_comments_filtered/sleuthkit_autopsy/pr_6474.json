{"pr_number": 6474, "pr_title": "6994 get or add artifact type change", "pr_createdAt": "2020-11-18T21:29:57Z", "pr_url": "https://github.com/sleuthkit/autopsy/pull/6474", "timeline": [{"oid": "201f25ecfa585f9c196250a9e83fa602d2b3c685", "url": "https://github.com/sleuthkit/autopsy/commit/201f25ecfa585f9c196250a9e83fa602d2b3c685", "message": "Switched addArtifactAttributeType to getOrAddAttributeType", "committedDate": "2020-11-16T22:15:14Z", "type": "commit"}, {"oid": "6ed5712d868214c9616ce1e8a35ecce0c95267db", "url": "https://github.com/sleuthkit/autopsy/commit/6ed5712d868214c9616ce1e8a35ecce0c95267db", "message": "Switched addXXXType to getOrAddXXXType", "committedDate": "2020-11-18T21:29:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk1MzMxNw==", "url": "https://github.com/sleuthkit/autopsy/pull/6474#discussion_r526953317", "bodyText": "Do we need to log the exception here? I would expect the calling code to handle it.", "author": "APriestman", "createdAt": "2020-11-19T14:59:14Z", "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/ExtractRegistry.java", "diffHunk": "@@ -1961,18 +1963,13 @@ void createShellBagArtifacts(AbstractFile regFile, List<ShellBag> shellbags) thr\n      */\n     private BlackboardArtifact.Type getShellBagArtifact() throws TskCoreException {\n         if (shellBagArtifactType == null) {\n-            shellBagArtifactType = tskCase.getArtifactType(SHELLBAG_ARTIFACT_NAME);\n-\n-            if (shellBagArtifactType == null) {\n-                try {\n-                    tskCase.addBlackboardArtifactType(SHELLBAG_ARTIFACT_NAME, Bundle.Shellbag_Artifact_Display_Name()); //NON-NLS\n-                } catch (TskDataException ex) {\n-                    // Artifact already exists\n-                    logger.log(Level.INFO, String.format(\"%s may have already been defined for this case\", SHELLBAG_ARTIFACT_NAME));\n-                }\n-\n-                shellBagArtifactType = tskCase.getArtifactType(SHELLBAG_ARTIFACT_NAME);\n-            }\n+            try {\n+                shellBagArtifactType = tskCase.getBlackboard().getOrAddArtifactType(SHELLBAG_ARTIFACT_NAME, Bundle.Shellbag_Artifact_Display_Name());\n+            } catch (BlackboardException ex) {\n+                String msg = String.format(\"Failed to get shell bag artifact type\", SHELLBAG_ARTIFACT_NAME);\n+                logger.log(Level.SEVERE, msg, ex);\n+                throw new TskCoreException(msg, ex);", "originalCommit": "6ed5712d868214c9616ce1e8a35ecce0c95267db", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk1Mzg1OA==", "url": "https://github.com/sleuthkit/autopsy/pull/6474#discussion_r526953858", "bodyText": "I'm assuming that should be \"custom\"?", "author": "APriestman", "createdAt": "2020-11-19T14:59:53Z", "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/ExtractRegistry.java", "diffHunk": "@@ -1989,12 +1986,12 @@ void createShellBagArtifacts(AbstractFile regFile, List<ShellBag> shellbags) thr\n     private BlackboardAttribute.Type getLastWriteAttribute() throws TskCoreException {\n         if (shellBagLastWriteAttributeType == null) {\n             try {\n-                shellBagLastWriteAttributeType = tskCase.addArtifactAttributeType(SHELLBAG_ATTRIBUTE_LAST_WRITE,\n+                shellBagLastWriteAttributeType = tskCase.getBlackboard().getOrAddAttributeType(SHELLBAG_ATTRIBUTE_LAST_WRITE,\n                         BlackboardAttribute.TSK_BLACKBOARD_ATTRIBUTE_VALUE_TYPE.DATETIME,\n                         Bundle.Shellbag_Last_Write_Attribute_Display_Name());\n-            } catch (TskDataException ex) {\n+            } catch (BlackboardException ex) {\n                 // Attribute already exists get it from the case\n-                shellBagLastWriteAttributeType = tskCase.getAttributeType(SHELLBAG_ATTRIBUTE_LAST_WRITE);\n+                throw new TskCoreException(String.format(\"Failed to get costume attribute %s\", SHELLBAG_ATTRIBUTE_LAST_WRITE), ex);", "originalCommit": "6ed5712d868214c9616ce1e8a35ecce0c95267db", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk1NDI5Nw==", "url": "https://github.com/sleuthkit/autopsy/pull/6474#discussion_r526954297", "bodyText": "Typo on attribute", "author": "APriestman", "createdAt": "2020-11-19T15:00:21Z", "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/ExtractRegistry.java", "diffHunk": "@@ -2011,12 +2008,11 @@ void createShellBagArtifacts(AbstractFile regFile, List<ShellBag> shellbags) thr\n     private BlackboardAttribute.Type getKeyAttribute() throws TskCoreException {\n         if (shellBagKeyAttributeType == null) {\n             try {\n-                shellBagKeyAttributeType = tskCase.addArtifactAttributeType(SHELLBAG_ATTRIBUTE_KEY,\n+                shellBagKeyAttributeType = tskCase.getBlackboard().getOrAddAttributeType(SHELLBAG_ATTRIBUTE_KEY,\n                         BlackboardAttribute.TSK_BLACKBOARD_ATTRIBUTE_VALUE_TYPE.STRING,\n                         Bundle.Shellbag_Key_Attribute_Display_Name());\n-            } catch (TskDataException ex) {\n-                // The attribute already exists get it from the case\n-                shellBagKeyAttributeType = tskCase.getAttributeType(SHELLBAG_ATTRIBUTE_KEY);\n+            } catch (BlackboardException ex) {\n+                throw new TskCoreException(String.format(\"Failed to get key attriubte %s\", SHELLBAG_ATTRIBUTE_KEY), ex);", "originalCommit": "6ed5712d868214c9616ce1e8a35ecce0c95267db", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a6ca1359e5c072bf5d4704e75aae7dad4b0e3d5a", "url": "https://github.com/sleuthkit/autopsy/commit/a6ca1359e5c072bf5d4704e75aae7dad4b0e3d5a", "message": "Handled review comments", "committedDate": "2020-11-19T15:30:55Z", "type": "commit"}]}