{"pr_number": 5953, "pr_title": "6413 Throttle number of Extracted Content node refreshes to once every 5 seconds.", "pr_createdAt": "2020-06-08T21:10:49Z", "pr_url": "https://github.com/sleuthkit/autopsy/pull/5953", "timeline": [{"oid": "0ae4510b18f154c39292b3441a1d16f707014c10", "url": "https://github.com/sleuthkit/autopsy/commit/0ae4510b18f154c39292b3441a1d16f707014c10", "message": "Throttle number of Extracted Content node refreshes to once every 5 seconds.", "committedDate": "2020-06-02T13:44:33Z", "type": "commit"}, {"oid": "2495deb56e3d8a24b2c6b63f2ec9acd5598f67e9", "url": "https://github.com/sleuthkit/autopsy/commit/2495deb56e3d8a24b2c6b63f2ec9acd5598f67e9", "message": "Merge branch 'develop' of github.com:sleuthkit/autopsy into 6413-throttle-refresh", "committedDate": "2020-06-02T15:25:48Z", "type": "commit"}, {"oid": "bf929f1cd214be7e53729a611cd861adbe755102", "url": "https://github.com/sleuthkit/autopsy/commit/bf929f1cd214be7e53729a611cd861adbe755102", "message": "Second pass at refresh throttling.", "committedDate": "2020-06-08T21:05:55Z", "type": "commit"}, {"oid": "752538e76ac792903021dee25e96b188c9650ea7", "url": "https://github.com/sleuthkit/autopsy/commit/752538e76ac792903021dee25e96b188c9650ea7", "message": "Changed module event refresh. Added comments.", "committedDate": "2020-06-09T16:40:42Z", "type": "commit"}, {"oid": "751edacd7f03cda91412a5a7547cc0717a1e8ff5", "url": "https://github.com/sleuthkit/autopsy/commit/751edacd7f03cda91412a5a7547cc0717a1e8ff5", "message": "Removed unneeded import.", "committedDate": "2020-06-09T16:41:44Z", "type": "commit"}, {"oid": "ef4269933d6c8e467143b700e472d9f0b50605bb", "url": "https://github.com/sleuthkit/autopsy/commit/ef4269933d6c8e467143b700e472d9f0b50605bb", "message": "Changed to first check every event to see if it would result in a refresh.", "committedDate": "2020-06-10T17:59:34Z", "type": "commit"}, {"oid": "60dae2406f988ffec3e7d00101d8b97ea1c50cb7", "url": "https://github.com/sleuthkit/autopsy/commit/60dae2406f988ffec3e7d00101d8b97ea1c50cb7", "message": "Make FileTypesByExtension use RefreshThrottler.", "committedDate": "2020-06-10T18:02:54Z", "type": "commit"}, {"oid": "1e4b6d28156d1fa3c2227330dd84127a2dcc1dba", "url": "https://github.com/sleuthkit/autopsy/commit/1e4b6d28156d1fa3c2227330dd84127a2dcc1dba", "message": "Shut Codacy up.", "committedDate": "2020-06-10T18:39:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzgyNTg1MA==", "url": "https://github.com/sleuthkit/autopsy/pull/5953#discussion_r443825850", "bodyText": "There is a typo on this line.", "author": "rcordovano", "createdAt": "2020-06-22T21:05:28Z", "path": "Core/src/org/sleuthkit/autopsy/datamodel/RefreshThrottler.java", "diffHunk": "@@ -0,0 +1,125 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2011-2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.datamodel;\n+\n+import com.google.common.util.concurrent.ThreadFactoryBuilder;\n+import java.beans.PropertyChangeEvent;\n+import java.beans.PropertyChangeListener;\n+import java.util.EnumSet;\n+import java.util.Set;\n+import java.util.concurrent.ScheduledThreadPoolExecutor;\n+import java.util.concurrent.TimeUnit;\n+import java.util.concurrent.atomic.AtomicReference;\n+import org.sleuthkit.autopsy.ingest.IngestManager;\n+\n+/**\n+ * Utility class that can be used by UI nodes to reduce the number of\n+ * potentially expensive UI refresh events when DATA_ADDED and CONTENT_CHANGED\n+ * ingest manager events are received.\n+ */\n+class RefreshThrottler {\n+\n+    /**\n+     * The Refresher interface needs to be implemented by ChildFactory instances\n+     * that wish to take advantage of throttled refresh functionality.\n+     */\n+    interface Refresher {\n+\n+        /**\n+         * The RefreshThrottler calls this method when the RefreshTask runs.\n+         *\n+         */\n+        void refresh();\n+\n+        /**\n+         * Determine whether the given event should result in a refresh.\n+         *\n+         * @param evt\n+         *\n+         * @return true if event should trigger a refresh, otherwise false.\n+         */\n+        boolean isRefreshRequired(PropertyChangeEvent evt);\n+    }\n+\n+    static ScheduledThreadPoolExecutor refreshExecutor = new ScheduledThreadPoolExecutor(1, new ThreadFactoryBuilder().setNameFormat(\"Node Refresh Thread\").build());\n+    // Keep a thread safe reference to the current refresh task (if any)\n+    private final AtomicReference<RefreshTask> refreshTaskRef;\n+\n+    // The factory instance that will be called when a refresh is due.\n+    private final Refresher refresher;\n+\n+    private static final long MIN_SECONDS_BETWEEN_RERFESH = 5;", "originalCommit": "1e4b6d28156d1fa3c2227330dd84127a2dcc1dba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1NTk2Mw==", "url": "https://github.com/sleuthkit/autopsy/pull/5953#discussion_r444855963", "bodyText": "Fixed. Thanks.", "author": "esaunders", "createdAt": "2020-06-24T12:25:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzgyNTg1MA=="}], "type": "inlineReview"}, {"oid": "583ccf22e148134cca43c177dc01ce40e224b02a", "url": "https://github.com/sleuthkit/autopsy/commit/583ccf22e148134cca43c177dc01ce40e224b02a", "message": "Fix typo.", "committedDate": "2020-06-24T12:24:59Z", "type": "commit"}]}