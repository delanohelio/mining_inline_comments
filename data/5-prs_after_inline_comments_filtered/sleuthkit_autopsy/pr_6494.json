{"pr_number": 6494, "pr_title": "7002 domain names", "pr_createdAt": "2020-11-24T19:30:19Z", "pr_url": "https://github.com/sleuthkit/autopsy/pull/6494", "timeline": [{"oid": "a843d34b2c883fc27e9c5b0b6fc87710b2c5d313", "url": "https://github.com/sleuthkit/autopsy/commit/a843d34b2c883fc27e9c5b0b6fc87710b2c5d313", "message": "domain categorization", "committedDate": "2020-11-24T17:37:10Z", "type": "commit"}, {"oid": "2396d2224af53c7779c12caf9cbce049703c0ed4", "url": "https://github.com/sleuthkit/autopsy/commit/2396d2224af53c7779c12caf9cbce049703c0ed4", "message": "fix for issue", "committedDate": "2020-11-24T19:10:10Z", "type": "commit"}, {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8", "url": "https://github.com/sleuthkit/autopsy/commit/95b9e51362c08033b5502f232ab6e383869e7bc8", "message": "formatting", "committedDate": "2020-11-24T19:29:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjc5NTkwNg==", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532795906", "bodyText": "Reader should be closed.", "author": "dannysmyda", "createdAt": "2020-11-30T18:06:03Z", "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "diffHunk": "@@ -0,0 +1,173 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.coreutils;\n+\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+import org.apache.commons.lang3.StringUtils;\n+\n+/**\n+ * Attempts to get the domain from a url/domain provided removing the\n+ * subdomain(s).\n+ */\n+class DomainCategorizer {\n+\n+    /**\n+     * This is a node in the trie. Children in the hashmap are identified by\n+     * token. So for example, for a domain google.co.uk, the top level category\n+     * would have an entry for \"uk\" linking to a domain category with \"co\".\n+     */\n+    private static class DomainCategory extends HashMap<String, DomainCategory> {\n+\n+        private DomainCategory getOrAddChild(String childKey) {\n+            DomainCategory cat = this.get(childKey);\n+            if (cat == null) {\n+                cat = new DomainCategory();\n+                this.put(childKey, cat);\n+            }\n+\n+            return cat;\n+        }\n+    }\n+\n+    // Character for joining domain segments.\n+    private static final String JOINER = \".\";\n+    // delimiter when used with regex\n+    private static final String DELIMITER = \"\\\\\" + JOINER;\n+\n+    // taken from https://publicsuffix.org/list/public_suffix_list.dat\n+    // file containing line seperated suffixes\n+    private static final String DOMAIN_LIST = \"public_suffix_list.dat\";\n+\n+    // token for comments\n+    private static final String COMMENT_TOKEN = \"//\";\n+\n+    // singleton instance of this class.\n+    private static DomainCategorizer categorizer = null;\n+\n+    /**\n+     * Returns the singleton instance of this class.\n+     *\n+     * @return The DomainCategorizer instance.\n+     * @throws IOException\n+     */\n+    static DomainCategorizer getInstance() throws IOException {\n+        if (categorizer == null) {\n+            categorizer = load();\n+        }\n+\n+        return categorizer;\n+    }\n+\n+    /**\n+     * Loads a DomainCategorizer instance using the public suffix list.\n+     *\n+     * @return The DomainCategorizer instance.\n+     * @throws IOException If there is an error reading the file.\n+     */\n+    private static DomainCategorizer load() throws IOException {\n+        InputStream is = DomainCategorizer.class.getResourceAsStream(DOMAIN_LIST);\n+        BufferedReader reader = new BufferedReader(new InputStreamReader(is));", "originalCommit": "95b9e51362c08033b5502f232ab6e383869e7bc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0NDMwNg==", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532844306", "bodyText": "Will do.", "author": "gdicristofaro", "createdAt": "2020-11-30T19:27:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjc5NTkwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0MTY4OA==", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532841688", "bodyText": "This isn't really categorization and will be confusing with some of our other uses of categorization. We should call this something like DomainTokenizer.", "author": "bcarrier", "createdAt": "2020-11-30T19:22:55Z", "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "diffHunk": "@@ -0,0 +1,173 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.coreutils;\n+\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+import org.apache.commons.lang3.StringUtils;\n+\n+/**\n+ * Attempts to get the domain from a url/domain provided removing the\n+ * subdomain(s).\n+ */\n+class DomainCategorizer {", "originalCommit": "95b9e51362c08033b5502f232ab6e383869e7bc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0NDQxMQ==", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532844411", "bodyText": "Sounds good.", "author": "gdicristofaro", "createdAt": "2020-11-30T19:27:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0MTY4OA=="}], "type": "inlineReview"}, {"oid": "7736629de14b4ce4b53af07c73ca7625b391656e", "url": "https://github.com/sleuthkit/autopsy/commit/7736629de14b4ce4b53af07c73ca7625b391656e", "message": "naming updates, close resources, NPE fix", "committedDate": "2020-11-30T19:48:49Z", "type": "commit"}, {"oid": "1e270cc0e3363465137ec745103cdcb7c72a7355", "url": "https://github.com/sleuthkit/autopsy/commit/1e270cc0e3363465137ec745103cdcb7c72a7355", "message": "fixes for domain rules", "committedDate": "2020-12-01T13:52:12Z", "type": "commit"}, {"oid": "4a5e224228bdc96d5815075d29ac1cc5609c81d2", "url": "https://github.com/sleuthkit/autopsy/commit/4a5e224228bdc96d5815075d29ac1cc5609c81d2", "message": "Merge branch 'develop' of github.com:sleuthkit/autopsy into 7002-domainNames", "committedDate": "2020-12-01T20:13:17Z", "type": "commit"}, {"oid": "cb1736f33398ae63741d28dcd308c264d462ff11", "url": "https://github.com/sleuthkit/autopsy/commit/cb1736f33398ae63741d28dcd308c264d462ff11", "message": "fix for more domains", "committedDate": "2020-12-01T20:44:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc2NDEzNg==", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r533764136", "bodyText": "Oh, just noticed this. This is not the right logger, should be the coreutils one.", "author": "dannysmyda", "createdAt": "2020-12-01T22:28:37Z", "path": "Core/src/org/sleuthkit/autopsy/coreutils/NetworkUtils.java", "diffHunk": "@@ -18,21 +18,25 @@\n  */\n package org.sleuthkit.autopsy.coreutils;\n \n+import java.io.IOException;\n import java.net.MalformedURLException;\n import java.net.URL;\n import java.net.UnknownHostException;\n-import java.util.StringTokenizer;\n+import java.util.logging.Level;", "originalCommit": "cb1736f33398ae63741d28dcd308c264d462ff11", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc4OTgxNQ==", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r533789815", "bodyText": "This is the logging level, not logger. My mistake.", "author": "dannysmyda", "createdAt": "2020-12-01T23:23:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc2NDEzNg=="}], "type": "inlineReview"}, {"oid": "bb4f0d0751c4e2dc3a4f5723de8fe6302d71bdfd", "url": "https://github.com/sleuthkit/autopsy/commit/bb4f0d0751c4e2dc3a4f5723de8fe6302d71bdfd", "message": "lower case normalization", "committedDate": "2020-12-02T13:32:57Z", "type": "commit"}]}