{"pr_number": 1894, "pr_title": "SOLR-14878: Expose solr.xml's coreRootDirectory property via the System Settings API", "pr_createdAt": "2020-09-20T01:07:46Z", "pr_url": "https://github.com/apache/lucene-solr/pull/1894", "timeline": [{"oid": "d6262cb8fdb76166bd621e08a5d80229eb226cd2", "url": "https://github.com/apache/lucene-solr/commit/d6262cb8fdb76166bd621e08a5d80229eb226cd2", "message": "Added property", "committedDate": "2020-09-20T01:03:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI1MTgxOQ==", "url": "https://github.com/apache/lucene-solr/pull/1894#discussion_r492251819", "bodyText": "coreRootDirectory is always non-null.  I don't like null checks that are unnecessary; it may feel \"safe\" but slightly obscures code clarity and suggests possibilities that are impossibilities.", "author": "dsmiley", "createdAt": "2020-09-21T18:08:29Z", "path": "solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler.java", "diffHunk": "@@ -139,8 +140,19 @@ public void handleRequestBody(SolrQueryRequest req, SolrQueryResponse rsp) throw\n     if (solrCloudMode) {\n       rsp.add(\"zkHost\", getCoreContainer(req, core).getZkController().getZkServerAddress());\n     }\n-    if (cc != null)\n-      rsp.add( \"solr_home\", cc.getSolrHome());\n+    if (cc != null) {\n+      String solrHome = cc.getSolrHome();\n+      rsp.add(\"solr_home\", solrHome);\n+\n+      Path coreRootDirectory = cc.getCoreRootDirectory();\n+      if (coreRootDirectory != null) {", "originalCommit": "d6262cb8fdb76166bd621e08a5d80229eb226cd2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI1MjI2MQ==", "url": "https://github.com/apache/lucene-solr/pull/1894#discussion_r492252261", "bodyText": "I disagree with this condition.  I think this should always emitted no matter where it is.  It's more helpful on consumers to depend on its existence rather than having it vary in some cases but not others.", "author": "dsmiley", "createdAt": "2020-09-21T18:09:20Z", "path": "solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler.java", "diffHunk": "@@ -139,8 +140,19 @@ public void handleRequestBody(SolrQueryRequest req, SolrQueryResponse rsp) throw\n     if (solrCloudMode) {\n       rsp.add(\"zkHost\", getCoreContainer(req, core).getZkController().getZkServerAddress());\n     }\n-    if (cc != null)\n-      rsp.add( \"solr_home\", cc.getSolrHome());\n+    if (cc != null) {\n+      String solrHome = cc.getSolrHome();\n+      rsp.add(\"solr_home\", solrHome);\n+\n+      Path coreRootDirectory = cc.getCoreRootDirectory();\n+      if (coreRootDirectory != null) {\n+        String coreRootDirectoryString = coreRootDirectory.toString();\n+        if (!coreRootDirectoryString.equals(solrHome)) {", "originalCommit": "d6262cb8fdb76166bd621e08a5d80229eb226cd2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI3MDMzMg==", "url": "https://github.com/apache/lucene-solr/pull/1894#discussion_r492270332", "bodyText": "Ok, I was on borderline myself. I felt that because this option is barely used, having the same long string sent twice was bit of a waste of bandwidth. But, I guess it does not happen too often.\nI can correct both generation and invocation of this option to make it a guaranteed setup. Let's just hope they don't run version 9 tool against version 8 core.\nAlso, if you don't like the name (the other open point), this is a good time to mention it.", "author": "arafalov", "createdAt": "2020-09-21T18:41:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI1MjI2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI3NDU0Ng==", "url": "https://github.com/apache/lucene-solr/pull/1894#discussion_r492274546", "bodyText": "The \"solr_\" part should be skipped IMO.  Everything here is Solr :-)\n\nLet's just hope they don't run version 9 tool against version 8 core.\n\nWell it's up to them to have a tolerant client.  For the SolrCLI I think it makes sense to check for null in case of a cross-version situation.", "author": "dsmiley", "createdAt": "2020-09-21T18:49:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI1MjI2MQ=="}], "type": "inlineReview"}]}