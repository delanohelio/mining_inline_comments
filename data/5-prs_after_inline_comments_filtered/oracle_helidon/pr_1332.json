{"pr_number": 1332, "pr_title": "Config now uses common media type module instead of FileTypeDetector.", "pr_createdAt": "2020-01-29T19:42:02Z", "pr_url": "https://github.com/oracle/helidon/pull/1332", "timeline": [{"oid": "53bfac9cfc4ab8c1261bb0918a1851a2e8de4481", "url": "https://github.com/oracle/helidon/commit/53bfac9cfc4ab8c1261bb0918a1851a2e8de4481", "message": "Config now uses common media type module instead of FileTypeDetector.", "committedDate": "2020-01-29T19:31:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjYyNzA0Mg==", "url": "https://github.com/oracle/helidon/pull/1332#discussion_r372627042", "bodyText": "Very minor point. The probeContentType methods in the other classes return Optional<String>. This one returns String and uses orElse. After a quick look I did not see any null checks on the returned String from this method. Just for consistency would it make sense (without excessive disruption of the other sites which invoke UrlConfigSource#probeContentType) to  return the Optional just as probeContentType in the other classes do?", "author": "tjquinno", "createdAt": "2020-01-29T21:00:53Z", "path": "config/config/src/main/java/io/helidon/config/UrlConfigSource.java", "diffHunk": "@@ -162,25 +160,8 @@ private String mediaType(String responseMediaType) throws URISyntaxException {\n         return mediaType;\n     }\n \n-    private String probeContentType() throws URISyntaxException {\n-        URI uri = url.toURI();\n-        Path path;\n-        switch (uri.getScheme()) {\n-            case \"jar\":\n-                String relativePath = uri.getSchemeSpecificPart();\n-                int idx = relativePath.indexOf(\"!\");\n-                if (idx > 0 && idx < relativePath.length()) {\n-                    relativePath = relativePath.substring(idx + 1);\n-                }\n-                path = Paths.get(relativePath);\n-                break;\n-            case \"file\":\n-                path = Paths.get(uri);\n-                break;\n-            default:\n-                path = Paths.get(url.getPath());\n-        }\n-        return ConfigHelper.detectContentType(path);\n+    private String probeContentType() {\n+        return MediaTypes.detectType(url).orElse(null);", "originalCommit": "53bfac9cfc4ab8c1261bb0918a1851a2e8de4481", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY2OTk0OQ==", "url": "https://github.com/oracle/helidon/pull/1332#discussion_r372669949", "bodyText": "I wanted to simply replace the existing usage. In other classes, Optional was removed. This class just returned the value (which could have been null with previous implementation).\nI will have a look if this is not a too complicated change to do", "author": "tomas-langer", "createdAt": "2020-01-29T22:37:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjYyNzA0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY3MDk5NA==", "url": "https://github.com/oracle/helidon/pull/1332#discussion_r372670994", "bodyText": "This seems to be a deeper problem in the implementation, as ConfigParser.Content.mediaType() is allowed to return null. I will create a follow up issue to clean this up", "author": "tomas-langer", "createdAt": "2020-01-29T22:40:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjYyNzA0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY3MTg0MA==", "url": "https://github.com/oracle/helidon/pull/1332#discussion_r372671840", "bodyText": "Follow up: #1333", "author": "tomas-langer", "createdAt": "2020-01-29T22:42:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjYyNzA0Mg=="}], "type": "inlineReview"}]}