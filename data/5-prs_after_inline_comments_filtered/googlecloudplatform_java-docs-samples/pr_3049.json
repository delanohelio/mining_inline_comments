{"pr_number": 3049, "pr_title": "Fix DLP inspect tests to fail on timeout", "pr_createdAt": "2020-06-04T00:02:42Z", "pr_url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3049", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5MDY4NA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3049#discussion_r435390684", "bodyText": "It's actually best to throw the most specific exceptions so that users understand and can mitigate what's going on.  That said, in a test, this is less important.", "author": "lesv", "createdAt": "2020-06-04T16:28:51Z", "path": "dlp/src/test/java/dlp/snippets/InspectTests.java", "diffHunk": "@@ -124,60 +122,30 @@ public void testInspectImageFile() {\n   }\n \n   @Test\n-  public void testInspectGcsFile() throws InterruptedException, ExecutionException, IOException {\n-\n+  public void testInspectGcsFile() throws Exception {", "originalCommit": "0f58e94bc1c87d79a0a3959ae90f689cfb218cac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5NjU5NQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3049#discussion_r435396595", "bodyText": "See below.", "author": "sushicw", "createdAt": "2020-06-04T16:38:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5MDY4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5MTYzMw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3049#discussion_r435391633", "bodyText": "Why did you reduce the throws here?", "author": "lesv", "createdAt": "2020-06-04T16:30:15Z", "path": "dlp/src/test/java/dlp/snippets/InspectTests.java", "diffHunk": "@@ -124,60 +122,30 @@ public void testInspectImageFile() {\n   }\n \n   @Test\n-  public void testInspectGcsFile() throws InterruptedException, ExecutionException, IOException {\n-\n+  public void testInspectGcsFile() throws Exception {\n     InspectGcsFile.inspectGcsFile(PROJECT_ID, GCS_PATH, TOPIC_ID, SUBSCRIPTION_ID);\n-    // Await job creation\n-    TimeUnit.SECONDS.sleep(3);\n \n     String output = bout.toString();\n-    assertThat(output, containsString(\"Job created: \"));\n-\n-    // Cancelling the job early to conserve quota\n-    String jobId = output.split(\"Job created: \")[1].split(\"\\n\")[0];\n-    CancelDlpJobRequest request = CancelDlpJobRequest.newBuilder().setName(jobId).build();\n-    try (DlpServiceClient client = DlpServiceClient.create()) {\n-      client.cancelDlpJob(request);\n-    }\n+    assertThat(output, containsString(\"Job status: DONE\"));\n   }\n \n   @Test\n-  public void testInspectDatastoreEntity()\n-      throws InterruptedException, ExecutionException, IOException {\n+  public void testInspectDatastoreEntity() throws Exception {", "originalCommit": "0f58e94bc1c87d79a0a3959ae90f689cfb218cac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5NjQ5Mg==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3049#discussion_r435396492", "bodyText": "It seemed unnecessarily verbose.\nI was trying to follow the guidance in https://engdoc.corp.google.com/eng/doc/devguide/java/practices/exceptions.md?cl=head#test_methods.\nTests are currently inconsistent in how they handle this but given the above, I wanted to move towards the simpler throws Exception.", "author": "sushicw", "createdAt": "2020-06-04T16:38:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5MTYzMw=="}], "type": "inlineReview"}, {"oid": "33a67014907bad01b0faaca615e2bcba8b6d350a", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/33a67014907bad01b0faaca615e2bcba8b6d350a", "message": "Fix inspect tests", "committedDate": "2020-06-04T20:28:59Z", "type": "commit"}, {"oid": "33a67014907bad01b0faaca615e2bcba8b6d350a", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/33a67014907bad01b0faaca615e2bcba8b6d350a", "message": "Fix inspect tests", "committedDate": "2020-06-04T20:28:59Z", "type": "forcePushed"}]}