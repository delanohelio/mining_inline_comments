{"pr_number": 2810, "pr_title": "Wrap BufferedWriter in PrintWriter to simplify some code.", "pr_createdAt": "2020-04-28T21:59:34Z", "pr_url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2810", "timeline": [{"oid": "375f31e3aa16a686848da05c63cb23c3c022b2bb", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/375f31e3aa16a686848da05c63cb23c3c022b2bb", "message": "Wrap BufferedWriter in PrintWriter to simplify some code.\n\nThis enables us to replace `writer.write(String.format(...))` with\n`writer.printf(...)`.\n\nAlso use the `var` keyword to simplify a couple of places where a type\nhad to be fully-qualified because of a naming conflict.", "committedDate": "2020-04-28T21:49:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk1NTc2Ng==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2810#discussion_r416955766", "bodyText": "I have mixed feelings on var - it's simpler, but (to me) feels less idiomatic for Java.\n@kurtisvg @lesv WDYT?", "author": "ace-n", "createdAt": "2020-04-28T22:13:12Z", "path": "functions/http/send-http-request/src/main/java/functions/SendHttpRequest.java", "diffHunk": "@@ -41,17 +41,15 @@ public void service(HttpRequest request, HttpResponse response)\n       throws IOException, InterruptedException {\n     // Create a GET sendHttpRequest to \"http://example.com\"\n     String url = \"http://example.com\";\n-    java.net.http.HttpRequest getRequest =\n-        java.net.http.HttpRequest.newBuilder().uri(URI.create(url)).GET().build();\n+    var getRequest = java.net.http.HttpRequest.newBuilder().uri(URI.create(url)).GET().build();", "originalCommit": "375f31e3aa16a686848da05c63cb23c3c022b2bb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk2Mjc4OQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2810#discussion_r416962789", "bodyText": "It hasn't been in the language all that long, but I think everyone should use it in appropriate places, of which this is definitely one since it allows us to replace three fully-qualified class names with just one.", "author": "eamonnmcmanus", "createdAt": "2020-04-28T22:30:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk1NTc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ3NjI2Ng==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2810#discussion_r417476266", "bodyText": "It should be fine to use in Java 11 apps.", "author": "lesv", "createdAt": "2020-04-29T17:10:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk1NTc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ3NzA3NA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2810#discussion_r417477074", "bodyText": "It's J11, it's often clearer and less error prone.", "author": "lesv", "createdAt": "2020-04-29T17:11:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk1NTc2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk1NjAzMg==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2810#discussion_r416956032", "bodyText": "Nit: spotbugs does not like \\n, and prefers %n instead.\nApply that comment throughout this file.", "author": "ace-n", "createdAt": "2020-04-28T22:13:51Z", "path": "functions/spanner/src/main/java/functions/HelloSpanner.java", "diffHunk": "@@ -97,27 +97,26 @@ DatabaseClient getClient() throws Throwable {\n \n   @Override\n   public void service(HttpRequest request, HttpResponse response) throws Exception {\n-    BufferedWriter writer = response.getWriter();\n+    var writer = new PrintWriter(response.getWriter());\n     try {\n       DatabaseClient client = getClient();\n       try (ResultSet rs =\n           client\n               .singleUse()\n               .executeQuery(Statement.of(\"SELECT SingerId, AlbumId, AlbumTitle FROM Albums\"))) {\n-        writer.write(\"Albums:\\n\");\n+        writer.printf(\"Albums:\\n\");\n         while (rs.next()) {\n-          writer.write(\n-              String.format(\n-                  \"%d %d %s\\n\",\n-                  rs.getLong(\"SingerId\"), rs.getLong(\"AlbumId\"), rs.getString(\"AlbumTitle\")));\n+          writer.printf(\n+              \"%d %d %s\\n\",", "originalCommit": "375f31e3aa16a686848da05c63cb23c3c022b2bb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk2MjM3NA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2810#discussion_r416962374", "bodyText": "Will do, though I'll note that I didn't change these strings, which already had \\n in them.", "author": "eamonnmcmanus", "createdAt": "2020-04-28T22:29:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk1NjAzMg=="}], "type": "inlineReview"}, {"oid": "826c331cd824b08d91d302c86a23cbeeca41e252", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/826c331cd824b08d91d302c86a23cbeeca41e252", "message": "Replace `\\n` with `%n` in a format string.", "committedDate": "2020-04-28T22:33:21Z", "type": "commit"}, {"oid": "b028fce17b6b110fa56d7cf73290552ec2011fc5", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/b028fce17b6b110fa56d7cf73290552ec2011fc5", "message": "Merge branch 'master' into function-sample-printf", "committedDate": "2020-04-28T22:34:45Z", "type": "commit"}]}