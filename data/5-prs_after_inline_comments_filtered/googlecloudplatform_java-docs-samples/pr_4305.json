{"pr_number": 4305, "pr_title": "STS check latest transfer operation sample", "pr_createdAt": "2020-11-24T21:54:23Z", "pr_url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4305", "timeline": [{"oid": "408400f7cd89481eed4533b6daa9b99c3d9b61e8", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/408400f7cd89481eed4533b6daa9b99c3d9b61e8", "message": "STS check latest transfer operation sample", "committedDate": "2020-11-24T21:31:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTk5MzczMg==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4305#discussion_r529993732", "bodyText": "Add new lines to end of both files.", "author": "frankyn", "createdAt": "2020-11-24T23:19:03Z", "path": "storage/storage-transfer/src/test/java/com/google/cloud/storage/storagetransfer/samples/test/CheckLatestTransferOperationTest.java", "diffHunk": "@@ -0,0 +1,57 @@\n+package com.google.cloud.storage.storagetransfer.samples.test;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+\n+import com.google.api.services.storagetransfer.v1.Storagetransfer;\n+import com.google.api.services.storagetransfer.v1.model.Date;\n+import com.google.api.services.storagetransfer.v1.model.GcsData;\n+import com.google.api.services.storagetransfer.v1.model.ObjectConditions;\n+import com.google.api.services.storagetransfer.v1.model.Schedule;\n+import com.google.api.services.storagetransfer.v1.model.TimeOfDay;\n+import com.google.api.services.storagetransfer.v1.model.TransferJob;\n+import com.google.api.services.storagetransfer.v1.model.TransferOptions;\n+import com.google.api.services.storagetransfer.v1.model.TransferSpec;\n+import com.google.cloud.storage.storagetransfer.samples.CheckLatestTransferOperation;\n+import com.google.cloud.storage.storagetransfer.samples.TransferClientCreator;\n+import com.google.cloud.storage.storagetransfer.samples.TransferJobUtils;\n+import java.io.ByteArrayOutputStream;\n+import java.io.PrintStream;\n+import org.junit.Test;\n+\n+public class CheckLatestTransferOperationTest {\n+  private static final String PROJECT_ID = System.getenv(\"GOOGLE_CLOUD_PROJECT\");\n+\n+  @Test\n+  public void testCheckLatestTransferOperation() throws Exception {\n+    Date date = TransferJobUtils.createDate(\"2000-01-01\");\n+    TimeOfDay time = TransferJobUtils.createTimeOfDay(\"00:00:00\");\n+    TransferJob transferJob =\n+        new TransferJob()\n+            .setDescription(\"Sample job\")\n+            .setProjectId(PROJECT_ID)\n+            .setTransferSpec(\n+                new TransferSpec()\n+                    .setGcsDataSource(new GcsData().setBucketName(PROJECT_ID + \"-storagetransfer-source\"))\n+                    .setGcsDataSink(new GcsData().setBucketName(PROJECT_ID + \"-storagetransfer-sink\"))\n+                    .setObjectConditions(\n+                        new ObjectConditions()\n+                            .setMinTimeElapsedSinceLastModification(\"2592000s\" /* 30 days */))\n+                    .setTransferOptions(\n+                        new TransferOptions().setDeleteObjectsFromSourceAfterTransfer(true)))\n+            .setSchedule(new Schedule().setScheduleStartDate(date).setStartTimeOfDay(time))\n+            .setStatus(\"ENABLED\");\n+\n+    Storagetransfer client = TransferClientCreator.createStorageTransferClient();\n+    TransferJob response  = client.transferJobs().create(transferJob).execute();\n+\n+    PrintStream standardOut = System.out;\n+    final ByteArrayOutputStream sampleOutputCapture = new ByteArrayOutputStream();\n+    System.setOut(new PrintStream(sampleOutputCapture));\n+\n+    CheckLatestTransferOperation.CheckLatestTransferOperation(PROJECT_ID, response.getName());\n+\n+    String sampleOutput = sampleOutputCapture.toString();\n+    System.setOut(standardOut);\n+    assertThat(sampleOutput.contains(response.getName()));\n+  }\n+}", "originalCommit": "408400f7cd89481eed4533b6daa9b99c3d9b61e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTk5NTE2NQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4305#discussion_r529995165", "bodyText": "Is there an example you could use in place of my-job-name or is this the format it uses?", "author": "frankyn", "createdAt": "2020-11-24T23:20:31Z", "path": "storage/storage-transfer/src/main/java/com/google/cloud/storage/storagetransfer/samples/CheckLatestTransferOperation.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 Google Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.google.cloud.storage.storagetransfer.samples;\n+\n+// [START storagetransfer_get_latest_transfer_operation]\n+\n+import com.google.api.client.googleapis.util.Utils;\n+import com.google.api.services.storagetransfer.v1.Storagetransfer;\n+import com.google.api.services.storagetransfer.v1.StoragetransferScopes;\n+import com.google.api.services.storagetransfer.v1.model.Operation;\n+import com.google.api.services.storagetransfer.v1.model.TransferJob;\n+import com.google.auth.http.HttpCredentialsAdapter;\n+import com.google.auth.oauth2.GoogleCredentials;\n+\n+import java.io.IOException;\n+\n+public class CheckLatestTransferOperation {\n+\n+  // Gets the requested transfer job and checks its latest operation\n+  public static void CheckLatestTransferOperation(String projectId, String jobName)\n+      throws IOException {\n+    // Your Google Cloud Project ID\n+    // String projectId = \"your-project-id\";\n+\n+    // The name of the job to check\n+    // String jobName = \"my-job-name\";", "originalCommit": "408400f7cd89481eed4533b6daa9b99c3d9b61e8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDAwNTgxOQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4305#discussion_r530005819", "bodyText": "I'll update it with a better example", "author": "JesseLovelace", "createdAt": "2020-11-24T23:31:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTk5NTE2NQ=="}], "type": "inlineReview"}, {"oid": "38b0141e72878fbd8ccd729c7edd84c1e8904195", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/38b0141e72878fbd8ccd729c7edd84c1e8904195", "message": "Merge branch 'master' into stslatestopsample", "committedDate": "2020-11-25T22:36:22Z", "type": "commit"}, {"oid": "7882f35c9aa3dea083eb0b702f1d271d1885cc8a", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/7882f35c9aa3dea083eb0b702f1d271d1885cc8a", "message": "STS check latest transfer operation sample", "committedDate": "2020-12-03T19:43:26Z", "type": "commit"}, {"oid": "9503402bb2807eaab857aa16e017c3be234e0afe", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/9503402bb2807eaab857aa16e017c3be234e0afe", "message": "Merge branch 'stslatestopsample' of github.com:GoogleCloudPlatform/java-docs-samples into stslatestopsample", "committedDate": "2020-12-03T19:44:44Z", "type": "commit"}, {"oid": "11d6533e76bca80cc7fbb077091ac7bdd48a0f59", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/11d6533e76bca80cc7fbb077091ac7bdd48a0f59", "message": "Merge branch 'stslatestopsample' of github.com:GoogleCloudPlatform/java-docs-samples into stslatestopsample", "committedDate": "2020-12-03T20:53:20Z", "type": "commit"}, {"oid": "351673fb71d90dae1c70991efd2f9eb8cdc126e4", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/351673fb71d90dae1c70991efd2f9eb8cdc126e4", "message": "Merge branch 'stslatestopsample' of github.com:GoogleCloudPlatform/java-docs-samples into stslatestopsample", "committedDate": "2020-12-03T20:53:26Z", "type": "commit"}]}