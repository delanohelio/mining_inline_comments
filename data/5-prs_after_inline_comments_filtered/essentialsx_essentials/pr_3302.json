{"pr_number": 3302, "pr_title": "Allow for specifying amount to increase itemstack in /more", "pr_createdAt": "2020-05-17T04:34:33Z", "pr_url": "https://github.com/EssentialsX/Essentials/pull/3302", "timeline": [{"oid": "2dc8dd9edd9c4f1da7d01fb73fe38370bf583a76", "url": "https://github.com/EssentialsX/Essentials/commit/2dc8dd9edd9c4f1da7d01fb73fe38370bf583a76", "message": "Allow specifying amount to increase the itemstack in /more", "committedDate": "2020-05-17T04:28:23Z", "type": "commit"}, {"oid": "dd0d973b6d0e4471f8212b206a4e019c18edd471", "url": "https://github.com/EssentialsX/Essentials/commit/dd0d973b6d0e4471f8212b206a4e019c18edd471", "message": "Include max stack size in message", "committedDate": "2020-05-17T04:33:30Z", "type": "commit"}, {"oid": "4bac7ed39b77b79e5ba8485b24179513cbe8755d", "url": "https://github.com/EssentialsX/Essentials/commit/4bac7ed39b77b79e5ba8485b24179513cbe8755d", "message": "Fix issue with incrementing to max stack size", "committedDate": "2020-05-17T15:59:27Z", "type": "commit"}, {"oid": "a69e556fc488b76c9ac329ba65927d75170d6ad9", "url": "https://github.com/EssentialsX/Essentials/commit/a69e556fc488b76c9ac329ba65927d75170d6ad9", "message": "Validate increment is non-zero positive", "committedDate": "2020-05-17T16:00:13Z", "type": "commit"}, {"oid": "70eb24f79b15f8e2e3912fa0ed1f8a2632b250ac", "url": "https://github.com/EssentialsX/Essentials/commit/70eb24f79b15f8e2e3912fa0ed1f8a2632b250ac", "message": "Default to proper stack size when invalid number provided", "committedDate": "2020-05-17T16:22:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDA0ODQ4Ng==", "url": "https://github.com/EssentialsX/Essentials/pull/3302#discussion_r440048486", "bodyText": "Not really a big fan of this kind of try/throw/catch, looks very messy. Maybe use NumberUtil::isInt(String) here instead, and additionally check that the parsed number is greater than zero. If either fails, throw the exception for nonZeroPosNumber.", "author": "pop4959", "createdAt": "2020-06-15T09:31:09Z", "path": "Essentials/src/com/earth2me/essentials/commands/Commandmore.java", "diffHunk": "@@ -17,22 +18,42 @@ public Commandmore() {\n     @Override\n     public void run(final Server server, final User user, final String commandLabel, final String[] args) throws Exception {\n         final ItemStack stack = user.getItemInHand();\n-        if (stack == null) {\n+        if (stack == null || stack.getType() == Material.AIR) {\n             throw new Exception(tl(\"cantSpawnItem\", \"Air\"));\n         }\n \n-        if (stack.getAmount() >= ((user.isAuthorized(\"essentials.oversizedstacks\")) ? ess.getSettings().getOversizedStackSize() : stack.getMaxStackSize())) {\n+        boolean canOversized = user.isAuthorized(\"essentials.oversizedstacks\");\n+        if (stack.getAmount() >= ((canOversized) ? ess.getSettings().getOversizedStackSize() : stack.getMaxStackSize())) {\n             throw new Exception(tl(\"fullStack\"));\n         }\n+\n         final String itemname = stack.getType().toString().toLowerCase(Locale.ENGLISH).replace(\"_\", \"\");\n         if (!user.canSpawnItem(stack.getType())) {\n             throw new Exception(tl(\"cantSpawnItem\", itemname));\n         }\n-        if (user.isAuthorized(\"essentials.oversizedstacks\")) {\n-            stack.setAmount(ess.getSettings().getOversizedStackSize());\n+\n+        int newStackSize = stack.getAmount();\n+        if (args.length >= 1) {\n+            try {\n+                int increment = Integer.parseInt(args[0]);\n+                if (increment < 1) {\n+                    throw new NumberFormatException(\"increment is less than or equal to zero\");\n+                }\n+                newStackSize += increment;\n+            } catch(NumberFormatException e) {\n+                throw new Exception(tl(\"nonZeroPosNumber\"));\n+            }", "originalCommit": "70eb24f79b15f8e2e3912fa0ed1f8a2632b250ac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f0a6981c75c8800a0c98e271dce392cf3b5ad333", "url": "https://github.com/EssentialsX/Essentials/commit/f0a6981c75c8800a0c98e271dce392cf3b5ad333", "message": "Clean up int validation", "committedDate": "2020-06-15T14:35:01Z", "type": "commit"}, {"oid": "f79a457272da5e41fe600337f07651e4f55d9482", "url": "https://github.com/EssentialsX/Essentials/commit/f79a457272da5e41fe600337f07651e4f55d9482", "message": "Rework messages", "committedDate": "2020-06-15T14:40:35Z", "type": "commit"}, {"oid": "881852309f2bcf9b696e9d3d7916d4a99faaca10", "url": "https://github.com/EssentialsX/Essentials/commit/881852309f2bcf9b696e9d3d7916d4a99faaca10", "message": "Merge branch '2.x' into feature/enchanced-more", "committedDate": "2020-06-16T21:05:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYxMTk5MA==", "url": "https://github.com/EssentialsX/Essentials/pull/3302#discussion_r448611990", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public static boolean isPosInt(final String sInt) {\n          \n          \n            \n                public static boolean isPositiveInt(final String sInt) {\n          \n      \n    \n    \n  \n\nAs opposed to \"positional\" or something similar, which is what I thought this was at first glance", "author": "mdcfe", "createdAt": "2020-07-01T20:56:32Z", "path": "Essentials/src/com/earth2me/essentials/utils/NumberUtil.java", "diffHunk": "@@ -105,4 +105,11 @@ public static boolean isInt(final String sInt) {\n         }\n         return true;\n     }\n+\n+    public static boolean isPosInt(final String sInt) {", "originalCommit": "881852309f2bcf9b696e9d3d7916d4a99faaca10", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1edac51f2327720e3777dbf76d6f25cd76d8f3e0", "url": "https://github.com/EssentialsX/Essentials/commit/1edac51f2327720e3777dbf76d6f25cd76d8f3e0", "message": "Review changes", "committedDate": "2020-07-02T02:04:52Z", "type": "commit"}]}