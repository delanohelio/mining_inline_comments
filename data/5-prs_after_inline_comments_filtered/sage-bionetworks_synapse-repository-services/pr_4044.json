{"pr_number": 4044, "pr_title": "PLFM-6158 - Final Refactoring", "pr_createdAt": "2020-05-14T00:08:14Z", "pr_url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4044", "timeline": [{"oid": "956c32ade5db567dd2a8e98f7bbd35e86b900c74", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/956c32ade5db567dd2a8e98f7bbd35e86b900c74", "message": "PLFM-6158: Move the replication manager", "committedDate": "2020-05-13T19:05:32Z", "type": "commit"}, {"oid": "1b3e69294984bfe2d945a7e4eb8de8416a6a97b9", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/1b3e69294984bfe2d945a7e4eb8de8416a6a97b9", "message": "PLFM-6158: Move replication workers", "committedDate": "2020-05-13T19:05:32Z", "type": "commit"}, {"oid": "aaff1f1db50d7f605a8d925a6d57287dc96d1a78", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/aaff1f1db50d7f605a8d925a6d57287dc96d1a78", "message": "PLFM-6158: Table index manager refactored", "committedDate": "2020-05-13T19:05:33Z", "type": "commit"}, {"oid": "c6b726c98c9adbd3d3d61512a371f11f7f6a7b67", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/c6b726c98c9adbd3d3d61512a371f11f7f6a7b67", "message": "PLFM-6158: RowMetadataColumnTranslationReference uses integer for benefactor", "committedDate": "2020-05-13T19:05:33Z", "type": "commit"}, {"oid": "ac6dfec6d4091ee5747eea7a9b9a45609901f5e9", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/ac6dfec6d4091ee5747eea7a9b9a45609901f5e9", "message": "PLFM-6158: Push view containers computation to provider", "committedDate": "2020-05-13T19:05:33Z", "type": "commit"}, {"oid": "a38bb328b76a53206bf8ae44bfd7202547672003", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/a38bb328b76a53206bf8ae44bfd7202547672003", "message": "PLFM-6158: Push object data fetching to metadata index provider", "committedDate": "2020-05-13T19:05:33Z", "type": "commit"}, {"oid": "1d8aa1cd81f109d323161552572a0150cdbae1ff", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/1d8aa1cd81f109d323161552572a0150cdbae1ff", "message": "Validate the view id when updating from a row set", "committedDate": "2020-05-13T19:05:34Z", "type": "commit"}, {"oid": "48e163e7452b4c1e03e49e9ecdc5e2da7a79f073", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/48e163e7452b4c1e03e49e9ecdc5e2da7a79f073", "message": "PLFM-6158: Push annotation get/set to metadata index provider", "committedDate": "2020-05-13T19:05:34Z", "type": "commit"}, {"oid": "c5d28d5fb2919cb1570ec78cd09562417ce26512", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/c5d28d5fb2919cb1570ec78cd09562417ce26512", "message": "Fix for circular dependency injection issue", "committedDate": "2020-05-13T19:05:34Z", "type": "commit"}, {"oid": "bd2956e537df7a63bfb95cf9ab207e93fc1ffff5", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/bd2956e537df7a63bfb95cf9ab207e93fc1ffff5", "message": "PLFM-6158: Push CRC and default columns to metadata index provider", "committedDate": "2020-05-13T19:05:34Z", "type": "commit"}, {"oid": "8d8064181bda5121c134e8f3ee4efb7e319b5b55", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/8d8064181bda5121c134e8f3ee4efb7e319b5b55", "message": "Remove unused method", "committedDate": "2020-05-13T19:05:34Z", "type": "commit"}, {"oid": "ccb9315955b259c9a60fd581cb38a075e6da7014", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/ccb9315955b259c9a60fd581cb38a075e6da7014", "message": "PLFM-6158: Default column model for views refactored", "committedDate": "2020-05-13T19:05:35Z", "type": "commit"}, {"oid": "626bc993dca1dc03f8210d2858092a69e6e66ca2", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/626bc993dca1dc03f8210d2858092a69e6e66ca2", "message": "PLFM-6158: Remove deprecated method", "committedDate": "2020-05-13T19:05:35Z", "type": "commit"}, {"oid": "13fbc1d83edc4b3c6194e101cb2f103929ee1d3e", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/13fbc1d83edc4b3c6194e101cb2f103929ee1d3e", "message": "PLFM-6158: Reconciliation logic moved to the manager and switch to provider", "committedDate": "2020-05-13T22:17:33Z", "type": "commit"}, {"oid": "e7bbc0cc3ec9d25722150970af9d56398cc0038d", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/e7bbc0cc3ec9d25722150970af9d56398cc0038d", "message": "PLFM-6158: Removed deprecated methods", "committedDate": "2020-05-13T22:23:47Z", "type": "commit"}, {"oid": "36bcd82636fe856711b237227b17ac7a85d758af", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/36bcd82636fe856711b237227b17ac7a85d758af", "message": "PLFM-6158: Use a bind variable for subtype filtering", "committedDate": "2020-05-13T23:06:19Z", "type": "commit"}, {"oid": "4c8641e57638418bbc3d5bf5629c835ee110ae41", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/4c8641e57638418bbc3d5bf5629c835ee110ae41", "message": "PLFM-6158: Query row level filtering benefactor type supplied by the provider", "committedDate": "2020-05-13T23:22:00Z", "type": "commit"}, {"oid": "4c8641e57638418bbc3d5bf5629c835ee110ae41", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/4c8641e57638418bbc3d5bf5629c835ee110ae41", "message": "PLFM-6158: Query row level filtering benefactor type supplied by the provider", "committedDate": "2020-05-13T23:22:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ5NjA1Nw==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4044#discussion_r425496057", "bodyText": "remove AuthorizationManger to break the cycle.", "author": "john-hill", "createdAt": "2020-05-15T00:08:43Z", "path": "services/repository-managers/src/main/java/org/sagebionetworks/repo/manager/table/metadata/MetadataIndexProviderFactoryImpl.java", "diffHunk": "@@ -15,9 +15,29 @@\n public class MetadataIndexProviderFactoryImpl implements MetadataIndexProviderFactory {\r\n \r\n \tprivate Map<ViewObjectType, MetadataIndexProvider> providersMap;\r\n-\r\n+\t\r\n+\t// We use setter injection here since we have a circular dependency:\r\n+\t//\r\n+\t// NodeManager -> AuthorizationManager -> FileHandleAssociationManager -> \r", "originalCommit": "4c8641e57638418bbc3d5bf5629c835ee110ae41", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTUwMzI3OA==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4044#discussion_r425503278", "bodyText": "Does this work? Maybe....Will write an integration test.", "author": "john-hill", "createdAt": "2020-05-15T00:35:01Z", "path": "services/repository/src/main/java/org/sagebionetworks/repo/web/controller/TableController.java", "diffHunk": "@@ -398,12 +399,13 @@ PaginatedColumnModels listColumnModels(\n \t@RequestMapping(value = UrlHelpers.COLUMN_TABLE_VIEW_DEFAULT_TYPE, method = RequestMethod.GET)\r\n \tpublic @ResponseBody\r\n \tListWrapper<ColumnModel> getDefaultColumnsForViewType(\r\n-\t\t\t@PathVariable String viewtype)\r\n+\t\t\t@PathVariable String viewtype,\r\n+\t\t\t@RequestParam(value = \"objectType\", required = false, defaultValue = \"ENTITY\") ViewObjectType objectType)\r", "originalCommit": "4c8641e57638418bbc3d5bf5629c835ee110ae41", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}