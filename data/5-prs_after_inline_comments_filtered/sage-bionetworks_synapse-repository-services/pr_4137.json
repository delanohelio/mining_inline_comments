{"pr_number": 4137, "pr_title": "exclude  from schemas in the definitions of validation schemas", "pr_createdAt": "2020-07-15T01:15:27Z", "pr_url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4137", "timeline": [{"oid": "8453ea70e57bfb9fc9496bb4dfa5a13646cccdcb", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/8453ea70e57bfb9fc9496bb4dfa5a13646cccdcb", "message": "exclude  from schemas in the definitions of validation schemas", "committedDate": "2020-07-15T01:11:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMzNDU2MQ==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4137#discussion_r455334561", "bodyText": "This test can be removed", "author": "marcomarasca", "createdAt": "2020-07-15T20:51:40Z", "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/schema/JsonSchemaManagerImplTest.java", "diffHunk": "@@ -873,24 +874,48 @@ public void testCreateJsonSchemaNullSchema() {\n \tpublic void testGetSchemaWithVersion() {\n \t\twhen(mockSchemaDao.getVersionId(any(), any(), any())).thenReturn(versionId);\n \t\twhen(mockSchemaDao.getSchema(any())).thenReturn(schema);\n-\t\tString $id = organizationName+\"-\"+schemaName+\"-\"+semanticVersionString;\n+\t\tString $id = organizationName + \"-\" + schemaName + \"-\" + semanticVersionString;\n \t\t// call under test\n \t\tJsonSchema result = manager.getSchema($id);\n \t\tassertEquals(schema, result);\n+\t\tassertEquals($id, result.get$id());\n \t\tverify(mockSchemaDao).getVersionId(organizationName, schemaName, semanticVersionString);\n \t\tverify(mockSchemaDao, never()).getLatestVersionId(any(), any());\n \t\tverify(mockSchemaDao).getSchema(versionId);\n \t}\n \n+\t@Test", "originalCommit": "8453ea70e57bfb9fc9496bb4dfa5a13646cccdcb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMzNTU0NA==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4137#discussion_r455335544", "bodyText": "We might want to remove the schema in each sub-schema in the validation.", "author": "marcomarasca", "createdAt": "2020-07-15T20:53:38Z", "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/schema/JsonSchemaManagerImplTest.java", "diffHunk": "@@ -1138,10 +1162,10 @@ public void testGetLatestVersionWithNullSchemaName() {\n \t\tverify(mockSchemaDao, never()).getVersionInfo(any());\n \t}\n \n-\n \t@Test\n \tpublic void testGetValidationSchema() throws JSONObjectAdapterException {\n \t\tJsonSchema one = createSchema(\"one\");\n+\t\tone.set$schema(\"http://json-schema.org/draft-07/schema\");", "originalCommit": "8453ea70e57bfb9fc9496bb4dfa5a13646cccdcb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMzNjI2NA==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4137#discussion_r455336264", "bodyText": "Can be removed..or not.", "author": "marcomarasca", "createdAt": "2020-07-15T20:54:53Z", "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/schema/JsonSchemaManagerImplTest.java", "diffHunk": "@@ -1397,4 +1425,17 @@ public JsonSchema cloneSchema(JsonSchema toClone) throws JSONObjectAdapterExcept\n \t\tString json = EntityFactory.createJSONStringForEntity(toClone);\n \t\treturn EntityFactory.createEntityFromJSONString(json, JsonSchema.class);\n \t}\n+\n+\t/**\n+\t * Convert a JsonSchema to json.\n+\t * \n+\t * @param schema\n+\t * @return\n+\t * @throws JSONObjectAdapterException\n+\t */\n+\tpublic static String toJson(JsonSchema schema) throws JSONObjectAdapterException {", "originalCommit": "8453ea70e57bfb9fc9496bb4dfa5a13646cccdcb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}