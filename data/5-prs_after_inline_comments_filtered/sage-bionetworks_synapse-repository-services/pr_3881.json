{"pr_number": 3881, "pr_title": "CR responses for PLFM-6004, add Jacoco code coverage tool", "pr_createdAt": "2020-01-07T01:57:33Z", "pr_url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881", "timeline": [{"oid": "0c9da264bfd08feed6f94326c51a16fe3278b064", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/0c9da264bfd08feed6f94326c51a16fe3278b064", "message": "CR responses for PLFM-6004, add Jacoco code coverage tool", "committedDate": "2019-12-24T02:04:04Z", "type": "commit"}, {"oid": "176767467eb2e7d1c478b5ed05d4bb98fe0ae49a", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/176767467eb2e7d1c478b5ed05d4bb98fe0ae49a", "message": "Merge branch 'develop' of https://github.com/Sage-Bionetworks/Synapse-Repository-Services into develop\n\nConflicts:\n\tservices/repository-managers/src/test/java/org/sagebionetworks/repo/manager/file/FileHandleManagerImplTest.java", "committedDate": "2020-01-07T01:10:06Z", "type": "commit"}, {"oid": "645b75dc351cd71d5f4749a281aa9cccb310d499", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/645b75dc351cd71d5f4749a281aa9cccb310d499", "message": "fix FileHandleManagerImplTest after merge", "committedDate": "2020-01-07T01:55:40Z", "type": "commit"}, {"oid": "703a5de491da2edf35c90231adca2f6ee24f2876", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/703a5de491da2edf35c90231adca2f6ee24f2876", "message": "fix build", "committedDate": "2020-01-07T02:27:28Z", "type": "commit"}, {"oid": "944dbadab0295cde1d94be256b14203a1e58aa69", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/944dbadab0295cde1d94be256b14203a1e58aa69", "message": "optimize SQL query for getProjectSettingForNode", "committedDate": "2020-01-08T05:07:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDUxNTI0Mg==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881#discussion_r364515242", "bodyText": "optimize isEmtpy() (constant time), then can keep order.", "author": "john-hill", "createdAt": "2020-01-09T00:51:19Z", "path": "services/repository-managers/src/main/java/org/sagebionetworks/repo/manager/ProjectSettingsManagerImpl.java", "diffHunk": "@@ -157,7 +158,7 @@ public ProjectSetting createProjectSetting(UserInfo userInfo, ProjectSetting pro\n \t\tvalidateProjectSetting(projectSetting, userInfo);\n \n \t\t// Can't add an StsStorageLocation to a non-empty entity.\n-\t\tif (isStsStorageLocationSetting(projectSetting) && !nodeManager.isEntityEmpty(parentId)) {\n+\t\tif (!nodeManager.isEntityEmpty(parentId) && isStsStorageLocationSetting(projectSetting)) {", "originalCommit": "703a5de491da2edf35c90231adca2f6ee24f2876", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDUxNzY4Mw==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881#discussion_r364517683", "bodyText": "false not illegal arg", "author": "john-hill", "createdAt": "2020-01-09T01:02:38Z", "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/ProjectSettingsManagerImplUnitTest.java", "diffHunk": "@@ -945,6 +1024,84 @@ public void testValidateProjectSetting_StsCannotBeEnabledWithOtherStorageLocatio\n \t\t\t\tuploadDestinationListSetting, userInfo), \"An STS-enabled folder cannot add other upload destinations\");\n \t}\n \n+\t@Test\n+\tpublic void testIsStsStorageLocation_NullProjectSetting() {\n+\t\t// Method under test.\n+\t\tboolean result = projectSettingsManagerImpl.isStsStorageLocationSetting(null);\n+\t\tassertFalse(result);\n+\t\tverifyZeroInteractions(mockStorageLocationDAO);\n+\t}\n+\n+\t@Test\n+\tpublic void testIsStsStorageLocation_ProjectSettingWrongSubclass() {\n+\t\t// Create a mock of ProjectSetting, so we can have a ProjectSetting instance that's not an\n+\t\t// UploadDestinationListSetting.\n+\t\tProjectSetting input = mock(ProjectSetting.class);\n+\n+\t\t// Method under test.\n+\t\tboolean result = projectSettingsManagerImpl.isStsStorageLocationSetting(input);\n+\t\tassertFalse(result);\n+\t\tverifyZeroInteractions(mockStorageLocationDAO);\n+\t}\n+\n+\t@Test\n+\tpublic void testIsStsStorageLocation_StorageLocationNotFound() {\n+\t\t// Mock dependencies.\n+\t\twhen(mockStorageLocationDAO.get(STORAGE_LOCATION_ID)).thenThrow(NotFoundException.class);\n+\n+\t\t// Method under test.\n+\t\tassertThrows(IllegalArgumentException.class, () -> projectSettingsManagerImpl.isStsStorageLocationSetting(", "originalCommit": "703a5de491da2edf35c90231adca2f6ee24f2876", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8bf73df837ffc1eb998da9309b77a5dc4174969d", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/8bf73df837ffc1eb998da9309b77a5dc4174969d", "message": "2nd CR responses for PLFM-6004", "committedDate": "2020-01-15T01:38:26Z", "type": "commit"}, {"oid": "be137cbf98d68bae47e7170d0f714ab95f822f29", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/be137cbf98d68bae47e7170d0f714ab95f822f29", "message": "Merge branch 'develop' of https://github.com/Sage-Bionetworks/Synapse-Repository-Services into develop", "committedDate": "2020-01-15T01:38:54Z", "type": "commit"}]}