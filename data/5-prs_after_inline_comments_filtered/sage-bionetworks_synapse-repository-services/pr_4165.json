{"pr_number": 4165, "pr_title": "test and fix to update benefactors on snapshots", "pr_createdAt": "2020-08-19T00:40:30Z", "pr_url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4165", "timeline": [{"oid": "e7700e909f15dc898c285d9019f10afa28e6add1", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/e7700e909f15dc898c285d9019f10afa28e6add1", "message": "test and fix to update benefactors on snapshots", "committedDate": "2020-08-18T23:38:57Z", "type": "commit"}, {"oid": "b9e69da8ef34ae73e11b73f835d7af1feb9690a0", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/b9e69da8ef34ae73e11b73f835d7af1feb9690a0", "message": "changed the integration test better match the original issue and ensure the view snapshot data is not lost.  Added the remaining unit tests", "committedDate": "2020-08-20T01:50:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIwMDMwNw==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4165#discussion_r474200307", "bodyText": "You probably can remove this as it's done in the before", "author": "marcomarasca", "createdAt": "2020-08-20T18:51:19Z", "path": "lib/lib-table-cluster/src/test/java/org/sagebionetworks/table/cluster/TableIndexDAOImplTest.java", "diffHunk": "@@ -4105,5 +4107,95 @@ public void testTempTableListColumnMaxLength(){\n \t\t//method under test\r\n \t\tassertEquals(2, tableIndexDAO.tempTableListColumnMaxLength(tableId,columnId));\r\n \t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testRefreshViewBenefactors() throws ParseException{\r\n+\t\ttableId = IdAndVersion.parse(\"syn123.45\");\r\n+\t\tisView = true;\r\n+\t\t// delete all data\r\n+\t\ttableIndexDAO.deleteObjectData(objectType, Lists.newArrayList(2L,3L));\r", "originalCommit": "b9e69da8ef34ae73e11b73f835d7af1feb9690a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIwMzYzNw==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4165#discussion_r474203637", "bodyText": "You might also want to renamed the associated test name to avoid confusion.", "author": "marcomarasca", "createdAt": "2020-08-20T18:57:33Z", "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/table/TableViewManagerImplTest.java", "diffHunk": "@@ -1366,7 +1386,7 @@ public void testApplyChangesToAvailableViewHoldingLock_MultiplePagesNoOverlap()\n \t\twhen(mockIndexManager.getOutOfDateRowsForView(idAndVersion, scopeType, allContainersInScope,\r\n \t\t\t\tTableViewManagerImpl.MAX_ROWS_PER_TRANSACTION)).thenReturn(pageOne, pageTwo);\r\n \t\t// call under test\r\n-\t\tmanager.applyChangesToAvailableViewHoldingLock(idAndVersion);\r\n+\t\tmanager.applyChangesToAvailableView(idAndVersion);\r", "originalCommit": "b9e69da8ef34ae73e11b73f835d7af1feb9690a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}