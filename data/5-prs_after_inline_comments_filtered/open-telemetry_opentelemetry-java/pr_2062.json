{"pr_number": 2062, "pr_title": "Some cleanup in span land.", "pr_createdAt": "2020-11-11T17:23:30Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/2062", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyODMzOA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2062#discussion_r521528338", "bodyText": "I think we currently still have enough other breaking changes that it is OK to completely remove this. It's just a renaming, right?", "author": "Oberon00", "createdAt": "2020-11-11T17:41:00Z", "path": "sdk/tracing/src/main/java/io/opentelemetry/sdk/trace/data/SpanData.java", "diffHunk": "@@ -340,12 +340,19 @@ static Status create(StatusCode code, @Nullable String description) {\n       return ImmutableStatus.create(code, description);\n     }\n \n+    /** Returns the status code. */\n+    StatusCode getStatusCode();\n+\n     /**\n-     * Returns the canonical status code.\n+     * Returns the status code.\n      *\n-     * @return the canonical status code.\n+     * @deprecated Please use {@link #getStatusCode()}. This method will be removed in the next\n+     *     release.\n      */\n-    StatusCode getCanonicalCode();\n+    @Deprecated", "originalCommit": "95a2a1a5092a6d9a2260a354ea06912330654433", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU3MDI2NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2062#discussion_r521570264", "bodyText": "I've started thinking that since we're moving to a 2-week release cycle, that it would be more friendly to end users to introduce deprecations that are then deleted in the following release. We discussed this at the SIG meeting this morning, and it was generally agreed to.  This seemed like a easy way to ease into the practice. :)", "author": "jkwatson", "createdAt": "2020-11-11T18:53:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyODMzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyNTYwOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2062#discussion_r521525609", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             *   private static final Tracer tracer = OpenTelemetry.get().getTracer(\"com.anyco.rpc\");\n          \n          \n            \n             *   private static final Tracer tracer = OpenTelemetry.get().getTracer(\"com.example.rpc\");\n          \n      \n    \n    \n  \n\nThis would be the reserved domain by IANA for such purposes.", "author": "arminru", "createdAt": "2020-11-11T17:36:54Z", "path": "api/src/main/java/io/opentelemetry/api/trace/SpanBuilder.java", "diffHunk": "@@ -44,20 +45,20 @@\n  *\n  * <pre>{@code\n  * class MyRpcServerInterceptorListener implements RpcServerInterceptor.Listener {\n- *   private static final Tracer tracer = OpenTelemetry.getTracer();\n+ *   private static final Tracer tracer = OpenTelemetry.get().getTracer(\"com.anyco.rpc\");", "originalCommit": "95a2a1a5092a6d9a2260a354ea06912330654433", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyODQ4MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2062#discussion_r521528481", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                assertThat(spans.get(0).getStatus().getStatusCode()).isEqualTo(StatusCode.ERROR);\n          \n          \n            \n                assertThat(spans.get(0).getStatus().getStatusCode()).isEqualTo(StatusCode.ERROR);\n          \n          \n            \n                assertThat(spans.get(0).getStatus().getCanonicalCode()).isEqualTo(StatusCode.ERROR);\n          \n      \n    \n    \n  \n\nI'd also add tests assuring that the deprecated method still works and doesn't throw until it's removed.", "author": "arminru", "createdAt": "2020-11-11T17:41:16Z", "path": "sdk/tracing/src/test/java/io/opentelemetry/sdk/trace/testbed/errorreporting/ErrorReportingTest.java", "diffHunk": "@@ -50,7 +50,7 @@ void testSimpleError() {\n \n     List<SpanData> spans = otelTesting.getSpans();\n     assertThat(spans).hasSize(1);\n-    assertThat(spans.get(0).getStatus().getCanonicalCode()).isEqualTo(StatusCode.ERROR);\n+    assertThat(spans.get(0).getStatus().getStatusCode()).isEqualTo(StatusCode.ERROR);", "originalCommit": "95a2a1a5092a6d9a2260a354ea06912330654433", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU3MjM5Ng==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2062#discussion_r521572396", "bodyText": "fair enough. will add.", "author": "jkwatson", "createdAt": "2020-11-11T18:57:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyODQ4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTYyMTI3MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2062#discussion_r521621271", "bodyText": "done!", "author": "jkwatson", "createdAt": "2020-11-11T20:32:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyODQ4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUzMTIzMw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2062#discussion_r521531233", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             *   private static final Tracer tracer = OpenTelemetry.get().getTracer(\"com.anyco.rpc\");\n          \n          \n            \n             *   private static final Tracer tracer = OpenTelemetry.get().getTracer(\"com.example.rpc\");", "author": "arminru", "createdAt": "2020-11-11T17:46:18Z", "path": "api/src/main/java/io/opentelemetry/api/trace/SpanBuilder.java", "diffHunk": "@@ -84,10 +85,12 @@\n  *\n  * <pre>{@code\n  * class MyClass {\n- *   private static final Tracer tracer = OpenTelemetry.getTracer();\n- *   void DoWork(Span parent) {\n+ *   private static final Tracer tracer = OpenTelemetry.get().getTracer(\"com.anyco.rpc\");", "originalCommit": "95a2a1a5092a6d9a2260a354ea06912330654433", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUzMTQ5NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2062#discussion_r521531495", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               *   private static final Tracer tracer = OpenTelemetry.get().getTracer(\"com.anyco.rpc\");\n          \n          \n            \n               *   private static final Tracer tracer = OpenTelemetry.get().getTracer(\"com.example.rpc\");", "author": "arminru", "createdAt": "2020-11-11T17:46:49Z", "path": "api/src/main/java/io/opentelemetry/api/trace/SpanBuilder.java", "diffHunk": "@@ -290,10 +292,11 @@ default SpanBuilder setStartTimestamp(Instant startTimestamp) {\n    *\n    * <pre>{@code\n    * class MyClass {\n-   *   private static final Tracer tracer = OpenTelemetry.getTracer();\n-   *   void DoWork(Span parent) {\n+   *   private static final Tracer tracer = OpenTelemetry.get().getTracer(\"com.anyco.rpc\");", "originalCommit": "95a2a1a5092a6d9a2260a354ea06912330654433", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "00a69b1fa70ab87fdbbc41155e89b378d233bba7", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/00a69b1fa70ab87fdbbc41155e89b378d233bba7", "message": "Some cleanup in span land.\n* Clean up the SpanBuilder javadoc to match the current APIs\n* Scrub mentions of canonical status code\n* Deprecate the getCanonicalCode method on SpanBuilder and replace with getStatusCode", "committedDate": "2020-11-12T00:11:33Z", "type": "commit"}, {"oid": "19db52c60458e4bebb52928863124d5b9703dd0a", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/19db52c60458e4bebb52928863124d5b9703dd0a", "message": "rename an internal method to make more sense", "committedDate": "2020-11-12T00:11:36Z", "type": "commit"}, {"oid": "4fe3cd713e80bb4d027b7efab190fa002cc49b60", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/4fe3cd713e80bb4d027b7efab190fa002cc49b60", "message": "Update api/src/main/java/io/opentelemetry/api/trace/SpanBuilder.java\n\nCo-authored-by: Armin Ruech <armin.ruech@dynatrace.com>", "committedDate": "2020-11-12T00:11:36Z", "type": "commit"}, {"oid": "60beb80e412c9a7476f7a29e3c86d85ea21b3a4a", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/60beb80e412c9a7476f7a29e3c86d85ea21b3a4a", "message": "Update api/src/main/java/io/opentelemetry/api/trace/SpanBuilder.java\n\nCo-authored-by: Armin Ruech <armin.ruech@dynatrace.com>", "committedDate": "2020-11-12T00:11:36Z", "type": "commit"}, {"oid": "3c7790be8615c34ffcbd92decd0e277e369e627e", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/3c7790be8615c34ffcbd92decd0e277e369e627e", "message": "Update api/src/main/java/io/opentelemetry/api/trace/SpanBuilder.java\n\nCo-authored-by: Armin Ruech <armin.ruech@dynatrace.com>", "committedDate": "2020-11-12T00:11:36Z", "type": "commit"}, {"oid": "3e10818516f018cedb401730749d4848bc7f76b1", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/3e10818516f018cedb401730749d4848bc7f76b1", "message": "add tests for the deprecated method", "committedDate": "2020-11-12T00:11:36Z", "type": "commit"}, {"oid": "3e10818516f018cedb401730749d4848bc7f76b1", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/3e10818516f018cedb401730749d4848bc7f76b1", "message": "add tests for the deprecated method", "committedDate": "2020-11-12T00:11:36Z", "type": "forcePushed"}]}