{"pr_number": 1168, "pr_title": "Add system/env vars and properties configuration for Metric classes", "pr_createdAt": "2020-05-04T14:06:22Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/1168", "timeline": [{"oid": "399fdc6794398848259f4ec4e269a0139f637bba", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/399fdc6794398848259f4ec4e269a0139f637bba", "message": "Add configuration to IntervalMetricReader", "committedDate": "2020-05-02T09:10:47Z", "type": "commit"}, {"oid": "8029a3cf67ae4b20f11f7d8f407c2a7a87a7945e", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/8029a3cf67ae4b20f11f7d8f407c2a7a87a7945e", "message": "Add configuration to OTLP", "committedDate": "2020-05-02T09:57:28Z", "type": "commit"}, {"oid": "71aa34761667908f14ac1ef8ab156e24568c4f19", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/71aa34761667908f14ac1ef8ab156e24568c4f19", "message": "Add documentation", "committedDate": "2020-05-04T14:02:42Z", "type": "commit"}, {"oid": "95f07918390b94eea8677b9224cd7195c951200a", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/95f07918390b94eea8677b9224cd7195c951200a", "message": "Fix year copyright", "committedDate": "2020-05-04T14:04:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTU5NjE4MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1168#discussion_r419596181", "bodyText": "Still says Jaeger in here, FYI.", "author": "jkwatson", "createdAt": "2020-05-04T17:18:07Z", "path": "exporters/otlp/src/main/java/io/opentelemetry/exporters/otlp/OtlpGrpcMetricExporter.java", "diffHunk": "@@ -40,8 +43,8 @@\n    * Creates a new Jaeger gRPC Metric Reporter with the given name, using the given channel.\n    *\n    * @param channel the channel to use when communicating with the Jaeger Collector.", "originalCommit": "95f07918390b94eea8677b9224cd7195c951200a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM2ODAxMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1168#discussion_r420368011", "bodyText": "do you want to update the javadoc while you're in here, updating other javadoc?  ;)", "author": "jkwatson", "createdAt": "2020-05-05T19:54:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTU5NjE4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU0ODYzMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1168#discussion_r420548631", "bodyText": "Better do it now before this slips through again ;) Done in d013f7b", "author": "thisthat", "createdAt": "2020-05-06T05:11:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTU5NjE4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYwMTAxOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1168#discussion_r419601019", "bodyText": "Is the purpose of these overrides just to provide a handle for documenting the properties? If so, could we do that just in the class javadoc, rather than introducing a ton of lines of code simply for repeating documentation?", "author": "jkwatson", "createdAt": "2020-05-04T17:26:00Z", "path": "exporters/otlp/src/main/java/io/opentelemetry/exporters/otlp/OtlpGrpcMetricExporter.java", "diffHunk": "@@ -146,5 +163,77 @@ public OtlpGrpcMetricExporter build() {\n     }\n \n     private Builder() {}\n+\n+    /**\n+     * Sets the configuration values from the given configuration map for only the available keys.\n+     * This method looks for the following keys:\n+     *\n+     * <ul>\n+     *   <li>{@code otel.otlp.metric.timeout}: to set the max waiting time for the collector to\n+     *       process each metric batch.\n+     * </ul>\n+     *\n+     * @param configMap {@link Map} holding the configuration values.\n+     * @return this.\n+     */\n+    @Override\n+    protected Builder fromConfigMap(\n+        Map<String, String> configMap, NamingConvention namingConvention) {\n+      configMap = namingConvention.normalize(configMap);\n+      Long value = getLongProperty(KEY_METRIC_TIMEOUT, configMap);\n+      if (value != null) {\n+        this.setDeadlineMs(value);\n+      }\n+      return this;\n+    }\n+\n+    /**\n+     * Sets the configuration values from the given properties object for only the available keys.\n+     * This method looks for the following keys:\n+     *\n+     * <ul>\n+     *   <li>{@code otel.otlp.metric.timeout}: to set the max waiting time for the collector to\n+     *       process each metric batch.\n+     * </ul>\n+     *\n+     * @param properties {@link Properties} holding the configuration values.\n+     * @return this.\n+     */\n+    @Override\n+    public Builder readProperties(Properties properties) {", "originalCommit": "95f07918390b94eea8677b9224cd7195c951200a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTg2ODMwNg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1168#discussion_r419868306", "bodyText": "As for now, all overrides have the function to provide better documentation w.r.t. the variables that they require.", "author": "thisthat", "createdAt": "2020-05-05T05:17:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYwMTAxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDE5MjMyOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1168#discussion_r420192329", "bodyText": "My preference would be to have the documentation not repeated, but have it just in the class-level javadoc and in the package-info.", "author": "jkwatson", "createdAt": "2020-05-05T15:19:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYwMTAxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM1NTQyMg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1168#discussion_r420355422", "bodyText": "I agree! I would, however, suggest doing this doc refactoring in a follow-up PR where I address this in all the different classes that use a configuration.", "author": "thisthat", "createdAt": "2020-05-05T19:31:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYwMTAxOQ=="}], "type": "inlineReview"}, {"oid": "d013f7b9adc05be5d7c2662c92506a2dcf589851", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/d013f7b9adc05be5d7c2662c92506a2dcf589851", "message": "Removing Jaeger from javadoc", "committedDate": "2020-05-06T05:10:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUzMjAzMg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1168#discussion_r421532032", "bodyText": "0.5?", "author": "bogdandrutu", "createdAt": "2020-05-07T14:07:06Z", "path": "exporters/otlp/src/main/java/io/opentelemetry/exporters/otlp/OtlpGrpcMetricExporter.java", "diffHunk": "@@ -96,6 +99,18 @@ public static Builder newBuilder() {\n     return new Builder();\n   }\n \n+  /**\n+   * Returns a new {@link OtlpGrpcMetricExporter} reading the configuration values from the\n+   * environment and from system properties. System properties override values defined in the\n+   * environment. If a configuration value is missing, it uses the default value.\n+   *\n+   * @return a new {@link OtlpGrpcMetricExporter} instance.\n+   * @since 0.4.0", "originalCommit": "d013f7b9adc05be5d7c2662c92506a2dcf589851", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "436af1c2599e35c5a12d13959140c360c9ace12c", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/436af1c2599e35c5a12d13959140c360c9ace12c", "message": "0.4.0 -> 0.5.0", "committedDate": "2020-05-08T05:48:28Z", "type": "commit"}, {"oid": "436af1c2599e35c5a12d13959140c360c9ace12c", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/436af1c2599e35c5a12d13959140c360c9ace12c", "message": "0.4.0 -> 0.5.0", "committedDate": "2020-05-08T05:48:28Z", "type": "forcePushed"}]}