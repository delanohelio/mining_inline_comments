{"pr_number": 1210, "pr_title": "Add API for UpDownCounter", "pr_createdAt": "2020-05-13T01:04:31Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/1210", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE4NTEwMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1210#discussion_r424185101", "bodyText": "Following open-telemetry/community#113 (comment), should we stop reporting the year?", "author": "thisthat", "createdAt": "2020-05-13T05:44:14Z", "path": "api/src/main/java/io/opentelemetry/metrics/DoubleUpDownCounter.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Copyright 2019, OpenTelemetry Authors", "originalCommit": "d30995119efead02328049a878574bb827dda756", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUwNzgyOA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1210#discussion_r424507828", "bodyText": "yes, can you create an issue for it?", "author": "jkwatson", "createdAt": "2020-05-13T15:00:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE4NTEwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUxMzg0Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1210#discussion_r424513843", "bodyText": "Note: we can also use a much more concise license header as suggested here:  open-telemetry/community#113 (comment)", "author": "jkwatson", "createdAt": "2020-05-13T15:08:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE4NTEwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUyMTY3OA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1210#discussion_r424521678", "bodyText": "Done in #1212", "author": "thisthat", "createdAt": "2020-05-13T15:18:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE4NTEwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU4MDkzMA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1210#discussion_r424580930", "bodyText": "Fixed the year, will fix other things when we fix the issue.", "author": "bogdandrutu", "createdAt": "2020-05-13T16:42:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE4NTEwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUxMDMxNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1210#discussion_r424510314", "bodyText": "This implementation is different from the one above. You could move it up out of the inner classes and put it one level higher so it doesn't need to be repeated.", "author": "jkwatson", "createdAt": "2020-05-13T15:03:49Z", "path": "api/src/main/java/io/opentelemetry/metrics/DefaultMeter.java", "diffHunk": "@@ -150,21 +174,31 @@ public DoubleCounter build() {\n     private NoopLongCounter() {}\n \n     @Override\n-    public void add(long increment, String... labelKeyValuePairs) {}\n+    public void add(long increment, String... labelKeyValuePairs) {\n+      Utils.validateLabelPairs(labelKeyValuePairs);\n+      verifyIncrement(increment);\n+    }\n \n     @Override\n     public NoopBoundLongCounter bind(String... labelKeyValuePairs) {\n       Utils.validateLabelPairs(labelKeyValuePairs);\n       return NoopBoundLongCounter.INSTANCE;\n     }\n \n+    // Similar to add but does not verify labels.\n+    private static void verifyIncrement(long increment) {\n+      Utils.checkArgument(increment >= 0, \"Counters can only increase\");", "originalCommit": "d30995119efead02328049a878574bb827dda756", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU0OTMyNw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1210#discussion_r424549327", "bodyText": "It is different, because one uses long the other uses double.", "author": "bogdandrutu", "createdAt": "2020-05-13T15:55:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUxMDMxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU2OTQxNg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1210#discussion_r424569416", "bodyText": "oh drat. stupid java.", "author": "jkwatson", "createdAt": "2020-05-13T16:24:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUxMDMxNA=="}], "type": "inlineReview"}, {"oid": "32e8fab3aa57ab378e36f2f4e7dd29db4a76b600", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/32e8fab3aa57ab378e36f2f4e7dd29db4a76b600", "message": "Add API for UpDownCounter\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-05-13T16:41:43Z", "type": "commit"}, {"oid": "32e8fab3aa57ab378e36f2f4e7dd29db4a76b600", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/32e8fab3aa57ab378e36f2f4e7dd29db4a76b600", "message": "Add API for UpDownCounter\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-05-13T16:41:43Z", "type": "forcePushed"}]}