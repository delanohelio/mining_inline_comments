{"pr_number": 2279, "pr_title": "Deprecate metrics from opentelemetry-api, add a global version in metrics api", "pr_createdAt": "2020-12-11T22:54:13Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/2279", "timeline": [{"oid": "91da3c7fa6a90fc425af82231c2b41525a775979", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/91da3c7fa6a90fc425af82231c2b41525a775979", "message": "Deprecate metrics from opentelemetry-api, add a global version in metrics api\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-11T22:55:40Z", "type": "forcePushed"}, {"oid": "1d536b4398745dbb2f53402a60228e9e11e09920", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/1d536b4398745dbb2f53402a60228e9e11e09920", "message": "Deprecate metrics from opentelemetry-api, add a global version in metrics api\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-11T22:58:14Z", "type": "forcePushed"}, {"oid": "a715516b2d569e12f2dea7c1fdda3e2b13f85368", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/a715516b2d569e12f2dea7c1fdda3e2b13f85368", "message": "Deprecate metrics from opentelemetry-api, add a global version in metrics api\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-11T23:23:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTgxMDAwNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2279#discussion_r541810004", "bodyText": "I thought we had already done this. Good catch!", "author": "jkwatson", "createdAt": "2020-12-13T00:29:00Z", "path": "exporters/otlp/src/main/java/io/opentelemetry/exporter/otlp/OtlpGrpcSpanExporter.java", "diffHunk": "@@ -105,6 +99,12 @@\n    *     or to a negative value, the exporter will wait indefinitely.\n    */\n   private OtlpGrpcSpanExporter(ManagedChannel channel, long deadlineMs) {\n+    Meter meter = GlobalMetricsProvider.getMeter(\"io.opentelemetry.exporters.otlp\");\n+    this.spansSeen =\n+        meter.longCounterBuilder(\"spansSeenByExporter\").build().bind(EXPORTER_NAME_LABELS);\n+    LongCounter spansExportedCounter = meter.longCounterBuilder(\"spansExportedByExporter\").build();\n+    this.spansExportedSuccess = spansExportedCounter.bind(EXPORT_SUCCESS_LABELS);\n+    this.spansExportedFailure = spansExportedCounter.bind(EXPORT_FAILURE_LABELS);", "originalCommit": "a715516b2d569e12f2dea7c1fdda3e2b13f85368", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUxNzQ0Nw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2279#discussion_r542517447", "bodyText": "I need to unbind them in shutdown.", "author": "bogdandrutu", "createdAt": "2020-12-14T16:22:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTgxMDAwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA0NzY1Mg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2279#discussion_r543047652", "bodyText": "Done.", "author": "bogdandrutu", "createdAt": "2020-12-15T05:00:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTgxMDAwNA=="}], "type": "inlineReview"}, {"oid": "c40b67328d1fda82261bd0a87f0e62679e057f3f", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/c40b67328d1fda82261bd0a87f0e62679e057f3f", "message": "Deprecate metrics from opentelemetry-api, add a global version in metrics api\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-15T04:59:57Z", "type": "forcePushed"}, {"oid": "908cf69309dcdf857b33865da6ff599a411eac77", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/908cf69309dcdf857b33865da6ff599a411eac77", "message": "Deprecate metrics from opentelemetry-api, add a global version in metrics api\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-15T21:18:17Z", "type": "forcePushed"}, {"oid": "f4d2592c8138b2043d5175521643a57ccdd2dcee", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/f4d2592c8138b2043d5175521643a57ccdd2dcee", "message": "Deprecate metrics from opentelemetry-api, add a global version in metrics api\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-15T22:19:39Z", "type": "commit"}, {"oid": "f4d2592c8138b2043d5175521643a57ccdd2dcee", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/f4d2592c8138b2043d5175521643a57ccdd2dcee", "message": "Deprecate metrics from opentelemetry-api, add a global version in metrics api\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-15T22:19:39Z", "type": "forcePushed"}]}