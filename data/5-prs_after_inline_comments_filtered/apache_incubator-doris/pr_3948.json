{"pr_number": 3948, "pr_title": "Support rpc_timeout property in stream load request to cancel request in fe in time when stream load request is timeout", "pr_createdAt": "2020-06-25T10:53:50Z", "pr_url": "https://github.com/apache/incubator-doris/pull/3948", "timeline": [{"oid": "07890ee495f7c769a8c871941cd10809d2b1d6c5", "url": "https://github.com/apache/incubator-doris/commit/07890ee495f7c769a8c871941cd10809d2b1d6c5", "message": "Support rpc_timeout property in stream load requet to cancel request in fe in time when stream load request is timeout", "committedDate": "2020-06-25T08:26:20Z", "type": "commit"}, {"oid": "a59b47c23ad07368d8db02ec32b8f074a3e26629", "url": "https://github.com/apache/incubator-doris/commit/a59b47c23ad07368d8db02ec32b8f074a3e26629", "message": "fix time unit", "committedDate": "2020-06-25T08:29:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjE0OTA5MQ==", "url": "https://github.com/apache/incubator-doris/pull/3948#discussion_r446149091", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        throw new UserException(\"get database read lock timeout, database=\" + db.getFullName());\n          \n          \n            \n                        throw new UserException(\"get database write lock timeout, database=\" + db.getFullName());", "author": "morningman", "createdAt": "2020-06-26T12:20:08Z", "path": "fe/src/main/java/org/apache/doris/transaction/GlobalTransactionMgr.java", "diffHunk": "@@ -185,7 +186,9 @@ public boolean commitAndPublishTransaction(Database db, long transactionId,\n             List<TabletCommitInfo> tabletCommitInfos, long timeoutMillis,\n             TxnCommitAttachment txnCommitAttachment)\n             throws UserException {\n-        db.writeLock();\n+        if (!db.tryWriteLock(timeoutMillis, TimeUnit.MILLISECONDS)) {\n+            throw new UserException(\"get database read lock timeout, database=\" + db.getFullName());", "originalCommit": "a59b47c23ad07368d8db02ec32b8f074a3e26629", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dfe9587065166927865d4d19f8ec1c2e656b6c70", "url": "https://github.com/apache/incubator-doris/commit/dfe9587065166927865d4d19f8ec1c2e656b6c70", "message": "Change from required to optional for thrift_prc_timeout_ms", "committedDate": "2020-06-26T14:01:55Z", "type": "commit"}]}