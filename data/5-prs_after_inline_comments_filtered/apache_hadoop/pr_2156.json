{"pr_number": 2156, "pr_title": "HDFS-15479. Ordered snapshot deletion: make it a configurable feature", "pr_createdAt": "2020-07-20T17:35:35Z", "pr_url": "https://github.com/apache/hadoop/pull/2156", "timeline": [{"oid": "4b7e888f459a44f2788ace497aae0863f74d9e68", "url": "https://github.com/apache/hadoop/commit/4b7e888f459a44f2788ace497aae0863f74d9e68", "message": "HDFS-15479", "committedDate": "2020-07-20T17:33:07Z", "type": "commit"}, {"oid": "641c3d5a93358a6f5cbf3dee412fbbb25713a048", "url": "https://github.com/apache/hadoop/commit/641c3d5a93358a6f5cbf3dee412fbbb25713a048", "message": "Fix checkstyle warnings.", "committedDate": "2020-07-20T21:23:08Z", "type": "commit"}, {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8", "url": "https://github.com/apache/hadoop/commit/ebf46aa2961da49ba106f30a659454f7b65061d8", "message": "Fix checkstyle again", "committedDate": "2020-07-21T01:25:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MTAzOA==", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457941038", "bodyText": "This check is not needed as all the other user of xattrs like encryption, erasure encoding calls\nFSDirXAttrOp.unprotectedSetXAttrs(fsd, srcIIP, xattrs, flag) directly without doing a feature check.", "author": "mukul1987", "createdAt": "2020-07-21T08:53:00Z", "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java", "diffHunk": "@@ -353,6 +354,20 @@ public int getListLimit() {\n         + \" hard limit \" + DFSConfigKeys.DFS_NAMENODE_MAX_XATTR_SIZE_HARD_LIMIT\n         + \": (%s).\", DFSConfigKeys.DFS_NAMENODE_MAX_XATTR_SIZE_KEY);\n \n+    this.snapshotDeletionOrdered =\n+        conf.getBoolean(DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED,\n+            DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED_DEFAULT);\n+    LOG.info(\"{} = {}\", DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED,\n+        snapshotDeletionOrdered);\n+    if (snapshotDeletionOrdered && !xattrsEnabled) {", "originalCommit": "ebf46aa2961da49ba106f30a659454f7b65061d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk3ODU1NA==", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457978554", "bodyText": "https://issues.apache.org/jira/browse/HDFS-15480", "author": "bshashikant", "createdAt": "2020-07-21T09:56:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MTAzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MzM2Mg==", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457943362", "bodyText": "Lets also add the value to hdfs-default.xml", "author": "mukul1987", "createdAt": "2020-07-21T08:56:39Z", "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java", "diffHunk": "@@ -500,8 +500,13 @@\n \n   public static final String DFS_NAMENODE_SNAPSHOT_MAX_LIMIT =\n       \"dfs.namenode.snapshot.max.limit\";\n-\n   public static final int DFS_NAMENODE_SNAPSHOT_MAX_LIMIT_DEFAULT = 65536;\n+\n+  public static final String DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED =\n+      \"dfs.namenode.snapshot.deletion.ordered\";\n+  public static final boolean DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED_DEFAULT\n+      = false;", "originalCommit": "ebf46aa2961da49ba106f30a659454f7b65061d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk3ODQ5Ng==", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457978496", "bodyText": "Addressed in https://issues.apache.org/jira/browse/HDFS-15480.", "author": "bshashikant", "createdAt": "2020-07-21T09:56:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MzM2Mg=="}], "type": "inlineReview"}]}