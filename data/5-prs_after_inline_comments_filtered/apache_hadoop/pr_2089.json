{"pr_number": 2089, "pr_title": "HADOOP-17081. MetricsSystem doesn't start the sink adapters on restart", "pr_createdAt": "2020-06-22T16:32:35Z", "pr_url": "https://github.com/apache/hadoop/pull/2089", "timeline": [{"oid": "d75902111a3ae078ecb9ca4353cc35fd9d58bfee", "url": "https://github.com/apache/hadoop/commit/d75902111a3ae078ecb9ca4353cc35fd9d58bfee", "message": "HADOOP-17081 : MetricsSystem doesn't start the sink adapters on restart\n\nWhat changed\n- The sink registration starts the adapter if it doesn't exists.", "committedDate": "2020-06-23T01:09:05Z", "type": "forcePushed"}, {"oid": "eeed85b765173cc463ae050c1668d5fbe1a5fb7f", "url": "https://github.com/apache/hadoop/commit/eeed85b765173cc463ae050c1668d5fbe1a5fb7f", "message": "HADOOP-17081 : MetricsSystem doesn't start the sink adapters on restart\n\nWhat changed\n- The sink registration starts the adapter if it doesn't exists.", "committedDate": "2020-06-23T01:10:18Z", "type": "forcePushed"}, {"oid": "e670b347f39d395b8b8c5bc056a8e6dfe358803a", "url": "https://github.com/apache/hadoop/commit/e670b347f39d395b8b8c5bc056a8e6dfe358803a", "message": "HADOOP-17081 : MetricsSystem doesn't start the sink adapters on restart\n\nWhat changed\n- The sink registration starts the adapter if it doesn't exists.", "committedDate": "2020-06-23T01:12:27Z", "type": "commit"}, {"oid": "e670b347f39d395b8b8c5bc056a8e6dfe358803a", "url": "https://github.com/apache/hadoop/commit/e670b347f39d395b8b8c5bc056a8e6dfe358803a", "message": "HADOOP-17081 : MetricsSystem doesn't start the sink adapters on restart\n\nWhat changed\n- The sink registration starts the adapter if it doesn't exists.", "committedDate": "2020-06-23T01:12:27Z", "type": "forcePushed"}, {"oid": "572df34eccb834daf8acd71fb352df9289380392", "url": "https://github.com/apache/hadoop/commit/572df34eccb834daf8acd71fb352df9289380392", "message": "Stop the metric system post testing", "committedDate": "2020-06-23T01:14:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTY3NDA1MQ==", "url": "https://github.com/apache/hadoop/pull/2089#discussion_r449674051", "bodyText": "we're generally still 80 chars wide, I'm afraid...put the actual probe on a new line.\nnice to see some text for the assertion tnough -appreciated", "author": "steveloughran", "createdAt": "2020-07-03T18:07:35Z", "path": "hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/metrics2/impl/TestMetricsSystemImpl.java", "diffHunk": "@@ -639,4 +639,23 @@ public Boolean get() {\n   private static String getPluginUrlsAsString() {\n     return \"file:metrics2-test-plugin.jar\";\n   }\n+\n+  @Test\n+  public void testMetricSystemRestart() {\n+    MetricsSystemImpl ms = new MetricsSystemImpl(\"msRestartTestSystem\");\n+    TestSink ts = new TestSink();\n+    String sinkName = \"restartTestSink\";\n+\n+    try {\n+      ms.start();\n+      ms.register(sinkName, \"\", ts);\n+      assertNotNull(\"an adapter should exist for each sink\", ms.getSinkAdapter(sinkName));", "originalCommit": "572df34eccb834daf8acd71fb352df9289380392", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc0OTI4Mg==", "url": "https://github.com/apache/hadoop/pull/2089#discussion_r449749282", "bodyText": "Fixed it, please review (added more info to the message)", "author": "mmpataki", "createdAt": "2020-07-04T07:36:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTY3NDA1MQ=="}], "type": "inlineReview"}, {"oid": "6dc79df0f6eb9db1aa38f4e4970c912921c1e35a", "url": "https://github.com/apache/hadoop/commit/6dc79df0f6eb9db1aa38f4e4970c912921c1e35a", "message": "Fixed the 80char checkstyle error", "committedDate": "2020-07-04T07:33:16Z", "type": "commit"}]}