{"pr_number": 899, "pr_title": "BXC-2526 - Generate content structure", "pr_createdAt": "2020-02-12T14:39:50Z", "pr_url": "https://github.com/UNC-Libraries/box-c/pull/899", "timeline": [{"oid": "dd296ca2967f8342877b58f6d6ba24d54e8bc694", "url": "https://github.com/UNC-Libraries/box-c/commit/dd296ca2967f8342877b58f6d6ba24d54e8bc694", "message": "Basic structure for content object migration transformer and deposit model", "committedDate": "2020-02-07T13:54:38Z", "type": "commit"}, {"oid": "ffd2701c0925f5a22d14a45a1e3b5dd5792be73e", "url": "https://github.com/UNC-Libraries/box-c/commit/ffd2701c0925f5a22d14a45a1e3b5dd5792be73e", "message": "Add helper utility for extract information from foxml documents, including datastream versions. Restore some of ContentModelHelper to provide constants for bxc3 constants during the migration.", "committedDate": "2020-02-10T20:03:17Z", "type": "commit"}, {"oid": "5b122ff91f96e619180321f6a29c064a4eea1cf8", "url": "https://github.com/UNC-Libraries/box-c/commit/5b122ff91f96e619180321f6a29c064a4eea1cf8", "message": "If multiple paths exist for a datastream on a pid, then return the one with the highest index. Add helper method to return all paths for versions of a datastream", "committedDate": "2020-02-10T20:31:18Z", "type": "commit"}, {"oid": "347a66efd8496d7fbeb1f88eacde188b14ed964e", "url": "https://github.com/UNC-Libraries/box-c/commit/347a66efd8496d7fbeb1f88eacde188b14ed964e", "message": "Implement content object transformer, which currently supports basic structure for most object types", "committedDate": "2020-02-11T19:13:35Z", "type": "commit"}, {"oid": "d7796c81215e29cfabe77026ed08ac7cb4c99b9e", "url": "https://github.com/UNC-Libraries/box-c/commit/d7796c81215e29cfabe77026ed08ac7cb4c99b9e", "message": "Add command for performing content transformation", "committedDate": "2020-02-11T21:30:30Z", "type": "commit"}, {"oid": "68d07e2cf82d29c0f755a02dcc2e382b7d919e10", "url": "https://github.com/UNC-Libraries/box-c/commit/68d07e2cf82d29c0f755a02dcc2e382b7d919e10", "message": "Add utility for rendering progress info to the cli, display progress for content transformation", "committedDate": "2020-02-12T14:19:03Z", "type": "commit"}, {"oid": "b9be9d9a1cbcc76de78be038d92df7fcbb3b33e4", "url": "https://github.com/UNC-Libraries/box-c/commit/b9be9d9a1cbcc76de78be038d92df7fcbb3b33e4", "message": "Add commands to help load test sets.\nAdded command to retrieve file paths for multiple objects.\nAdded command to retrieve a deposit model.\nMade tdb and path index db url parameters global.", "committedDate": "2020-02-12T14:19:24Z", "type": "commit"}, {"oid": "d261bf9a209f9695ea1aee12d15d84ab539cc5c0", "url": "https://github.com/UNC-Libraries/box-c/commit/d261bf9a209f9695ea1aee12d15d84ab539cc5c0", "message": "Remove catch", "committedDate": "2020-02-12T15:13:11Z", "type": "commit"}, {"oid": "d5a5e809880be7e3f192ccbbf7bd2f7fc3f6f047", "url": "https://github.com/UNC-Libraries/box-c/commit/d5a5e809880be7e3f192ccbbf7bd2f7fc3f6f047", "message": "Add readme about transform_content", "committedDate": "2020-02-13T14:41:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTU5MTc4Mw==", "url": "https://github.com/UNC-Libraries/box-c/pull/899#discussion_r379591783", "bodyText": "remove this", "author": "bbpennel", "createdAt": "2020-02-14T18:56:31Z", "path": "migration-util/src/main/java/edu/unc/lib/dcr/migration/ViewDepositModelCommand.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/**\n+ * Copyright 2008 The University of North Carolina at Chapel Hill\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *         http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package edu.unc.lib.dcr.migration;\n+\n+import static edu.unc.lib.dcr.migration.MigrationConstants.OUTPUT_LOGGER;\n+import static edu.unc.lib.dl.fcrepo4.RepositoryPathConstants.DEPOSIT_RECORD_BASE;\n+import static edu.unc.lib.dl.util.RDFModelUtil.streamModel;\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+import static org.apache.jena.riot.RDFFormat.NTRIPLES;\n+import static org.apache.jena.riot.RDFFormat.TURTLE;\n+import static org.slf4j.LoggerFactory.getLogger;\n+\n+import java.util.concurrent.Callable;\n+\n+import org.apache.commons.io.IOUtils;\n+import org.apache.jena.riot.RDFFormat;\n+import org.slf4j.Logger;\n+\n+import edu.unc.lib.dcr.migration.deposit.DepositModelManager;\n+import edu.unc.lib.dl.fcrepo4.PIDs;\n+import edu.unc.lib.dl.fedora.PID;\n+import picocli.CommandLine.Command;\n+import picocli.CommandLine.Option;\n+import picocli.CommandLine.Parameters;\n+import picocli.CommandLine.ParentCommand;\n+\n+/**\n+ * View deposit model command\n+ *\n+ * @author bbpennel\n+ */\n+@Command(name = \"view_deposit_model\", aliases = {\"vdm\"},\n+        description = \"Display the stored RDF for a deposit\")\n+public class ViewDepositModelCommand implements Callable<Integer> {\n+\n+    private static final Logger output = getLogger(OUTPUT_LOGGER);\n+\n+    @ParentCommand\n+    private MigrationCLI parentCommand;\n+\n+    @Parameters(index = \"0\",\n+            description = \"ID of the deposit to retrieve\")\n+    private String depositId;\n+\n+    @Option(names = {\"-t\", \"--turtle\"},\n+            description = \"Serialize the RDF as turtle instead of n-triples\")\n+    private boolean asTurtle;\n+\n+    @Override\n+    public Integer call() throws Exception {\n+        PID depositPid = PIDs.get(DEPOSIT_RECORD_BASE, depositId);\n+\n+        DepositModelManager depositModelManager = new DepositModelManager(depositPid, parentCommand.tdbDir);\n+\n+        depositModelManager.commit();", "originalCommit": "d5a5e809880be7e3f192ccbbf7bd2f7fc3f6f047", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "90977e3da5956cf78a96db65c4a0a4292798a8e0", "url": "https://github.com/UNC-Libraries/box-c/commit/90977e3da5956cf78a96db65c4a0a4292798a8e0", "message": "Update ViewDepositModelCommand.java", "committedDate": "2020-02-14T19:46:33Z", "type": "commit"}]}