{"pr_number": 1114, "pr_title": "Transform collections in collections into folders and set parentType destination", "pr_createdAt": "2020-10-30T12:33:45Z", "pr_url": "https://github.com/UNC-Libraries/box-c/pull/1114", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEwMTQxOA==", "url": "https://github.com/UNC-Libraries/box-c/pull/1114#discussion_r515101418", "bodyText": "I don't think this is quite going to work as expected. When we migrate the RLA the isTopLevelAsUnit flag is going to be false in practice, so I think the first if is always going to win for Collections at the moment. Swapping their order would probably work.\nAdditionally, the migration util doesn't seed the parentType parameter with the type of the bxc5 destination. This might be a problem if we end up migrating the RLA or other collections like it in multiple deposits, since it won't be aware the subcollections are going into a collection. It would be prudent to start doing this now, i'll create another ticket for that.", "author": "bbpennel", "createdAt": "2020-10-30T13:35:46Z", "path": "migration-util/src/main/java/edu/unc/lib/dcr/migration/content/ContentObjectTransformer.java", "diffHunk": "@@ -459,6 +459,8 @@ private Resource getResourceType(Resource bxc3Resc) {\n         if (contentModels.contains(COLLECTION.getResource())) {\n             if (Cdr.AdminUnit.equals(parentType) || !options.isTopLevelAsUnit()) {\n                 return Cdr.Collection;\n+            } else if (Cdr.Collection.equals(parentType)) {", "originalCommit": "6d10081830de91d7643aa1ec9554d4cafb73ba7d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEwMjk5MQ==", "url": "https://github.com/UNC-Libraries/box-c/pull/1114#discussion_r515102991", "bodyText": "Also, could you add a warn level log statement with the pid of the object being changed from a collection to a folder?", "author": "bbpennel", "createdAt": "2020-10-30T13:38:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEwMTQxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEwNDU1Mg==", "url": "https://github.com/UNC-Libraries/box-c/pull/1114#discussion_r515104552", "bodyText": "https://jira.lib.unc.edu/browse/BXC-2845", "author": "bbpennel", "createdAt": "2020-10-30T13:40:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEwMTQxOA=="}], "type": "inlineReview"}, {"oid": "85f20f2bbe5a50550e575d023a6ebccf2204af66", "url": "https://github.com/UNC-Libraries/box-c/commit/85f20f2bbe5a50550e575d023a6ebccf2204af66", "message": "Transform collections in collections into folders", "committedDate": "2020-10-30T17:08:30Z", "type": "commit"}, {"oid": "f9c162f787e48cd11047a9de18bec7b177a494fa", "url": "https://github.com/UNC-Libraries/box-c/commit/f9c162f787e48cd11047a9de18bec7b177a494fa", "message": "Switch conditional order and add log statement.", "committedDate": "2020-10-30T17:08:30Z", "type": "commit"}, {"oid": "f9c162f787e48cd11047a9de18bec7b177a494fa", "url": "https://github.com/UNC-Libraries/box-c/commit/f9c162f787e48cd11047a9de18bec7b177a494fa", "message": "Switch conditional order and add log statement.", "committedDate": "2020-10-30T17:08:30Z", "type": "forcePushed"}, {"oid": "2fb4d93ebfcf8f45e136c7b7c379ed49025fcf9c", "url": "https://github.com/UNC-Libraries/box-c/commit/2fb4d93ebfcf8f45e136c7b7c379ed49025fcf9c", "message": "Set parentType destination", "committedDate": "2020-10-30T20:28:58Z", "type": "commit"}, {"oid": "2fb4d93ebfcf8f45e136c7b7c379ed49025fcf9c", "url": "https://github.com/UNC-Libraries/box-c/commit/2fb4d93ebfcf8f45e136c7b7c379ed49025fcf9c", "message": "Set parentType destination", "committedDate": "2020-10-30T20:28:58Z", "type": "forcePushed"}, {"oid": "a285cad8327c36bdd8f6c165fcb131f4796f6bbd", "url": "https://github.com/UNC-Libraries/box-c/commit/a285cad8327c36bdd8f6c165fcb131f4796f6bbd", "message": "Move log statement", "committedDate": "2020-11-06T18:16:42Z", "type": "commit"}]}