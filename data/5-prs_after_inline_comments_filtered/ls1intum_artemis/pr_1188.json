{"pr_number": 1188, "pr_title": "Bugfix/text exercise/working example submissions", "pr_createdAt": "2020-01-14T17:50:44Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1188", "timeline": [{"oid": "5f344e75ad072daba0a4368aeadad5224a388218", "url": "https://github.com/ls1intum/Artemis/commit/5f344e75ad072daba0a4368aeadad5224a388218", "message": "Fix creation of new text example submissions including example result", "committedDate": "2020-01-14T17:37:50Z", "type": "commit"}, {"oid": "377e763f46f2614686e78d1baabfdd1be174ee03", "url": "https://github.com/ls1intum/Artemis/commit/377e763f46f2614686e78d1baabfdd1be174ee03", "message": "Fix update of example text submissions\n\nAlso add missing query in text exercise repo", "committedDate": "2020-01-14T17:38:40Z", "type": "commit"}, {"oid": "55b5028dc8d233967ab377bdbcfb421d3a71909a", "url": "https://github.com/ls1intum/Artemis/commit/55b5028dc8d233967ab377bdbcfb421d3a71909a", "message": "Add missing JavaDoc", "committedDate": "2020-01-14T17:41:53Z", "type": "commit"}, {"oid": "33844c9bb28cd21a81ddff29610895ee310d57d1", "url": "https://github.com/ls1intum/Artemis/commit/33844c9bb28cd21a81ddff29610895ee310d57d1", "message": "Add missing JavaDoc", "committedDate": "2020-01-14T17:51:59Z", "type": "commit"}, {"oid": "66a94abc7d39828b2e117b83c4aa112cd5101250", "url": "https://github.com/ls1intum/Artemis/commit/66a94abc7d39828b2e117b83c4aa112cd5101250", "message": "Add missing example boolean to result model", "committedDate": "2020-01-14T17:57:35Z", "type": "commit"}, {"oid": "adb3effe055f535b97d9b733843a72a6b8d67916", "url": "https://github.com/ls1intum/Artemis/commit/adb3effe055f535b97d9b733843a72a6b8d67916", "message": "Merge branch 'develop' into bugfix/text-exercise/working-example-submissions", "committedDate": "2020-01-14T17:58:28Z", "type": "commit"}, {"oid": "eb3eb008a45fe044133db9315d9c9d3d68fc4175", "url": "https://github.com/ls1intum/Artemis/commit/eb3eb008a45fe044133db9315d9c9d3d68fc4175", "message": "Run prettier on text-exercise-update.component.html", "committedDate": "2020-01-14T18:06:03Z", "type": "commit"}, {"oid": "39fa65912fb52d693b3d2a180eede175f58f44dc", "url": "https://github.com/ls1intum/Artemis/commit/39fa65912fb52d693b3d2a180eede175f58f44dc", "message": "Merge remote-tracking branch 'origin/bugfix/text-exercise/working-example-submissions' into bugfix/text-exercise/working-example-submissions", "committedDate": "2020-01-14T18:06:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUxMjc2Mw==", "url": "https://github.com/ls1intum/Artemis/pull/1188#discussion_r366512763", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        StudentParticipationRepository studentParticipationRepository, ResultService resultService, AuthorizationCheckService authCheckService, ResultService resultService1) {\n          \n          \n            \n                        StudentParticipationRepository studentParticipationRepository, ResultService resultService, AuthorizationCheckService authCheckService, ResultService resultService) {", "author": "krusche", "createdAt": "2020-01-14T18:52:48Z", "path": "src/main/java/de/tum/in/www1/artemis/service/TextAssessmentService.java", "diffHunk": "@@ -17,12 +18,15 @@\n \n     private final UserService userService;\n \n+    private final ResultService resultService;\n+\n     public TextAssessmentService(UserService userService, ComplaintResponseService complaintResponseService, ComplaintRepository complaintRepository,\n             FeedbackRepository feedbackRepository, ResultRepository resultRepository, TextSubmissionRepository textSubmissionRepository,\n-            StudentParticipationRepository studentParticipationRepository, ResultService resultService, AuthorizationCheckService authCheckService) {\n+            StudentParticipationRepository studentParticipationRepository, ResultService resultService, AuthorizationCheckService authCheckService, ResultService resultService1) {", "originalCommit": "39fa65912fb52d693b3d2a180eede175f58f44dc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUxMjg1NA==", "url": "https://github.com/ls1intum/Artemis/pull/1188#discussion_r366512854", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.resultService = resultService1;\n          \n          \n            \n                    this.resultService = resultService;", "author": "krusche", "createdAt": "2020-01-14T18:52:58Z", "path": "src/main/java/de/tum/in/www1/artemis/service/TextAssessmentService.java", "diffHunk": "@@ -17,12 +18,15 @@\n \n     private final UserService userService;\n \n+    private final ResultService resultService;\n+\n     public TextAssessmentService(UserService userService, ComplaintResponseService complaintResponseService, ComplaintRepository complaintRepository,\n             FeedbackRepository feedbackRepository, ResultRepository resultRepository, TextSubmissionRepository textSubmissionRepository,\n-            StudentParticipationRepository studentParticipationRepository, ResultService resultService, AuthorizationCheckService authCheckService) {\n+            StudentParticipationRepository studentParticipationRepository, ResultService resultService, AuthorizationCheckService authCheckService, ResultService resultService1) {\n         super(complaintResponseService, complaintRepository, feedbackRepository, resultRepository, studentParticipationRepository, resultService, authCheckService);\n         this.textSubmissionRepository = textSubmissionRepository;\n         this.userService = userService;\n+        this.resultService = resultService1;", "originalCommit": "39fa65912fb52d693b3d2a180eede175f58f44dc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "53ecc35115276ac9ed50d995e4afe3a71916da40", "url": "https://github.com/ls1intum/Artemis/commit/53ecc35115276ac9ed50d995e4afe3a71916da40", "message": "Apply suggestions from code review", "committedDate": "2020-01-14T18:53:04Z", "type": "commit"}, {"oid": "feba3c23a1032c4bfafd9edcb44ff36130c48bbd", "url": "https://github.com/ls1intum/Artemis/commit/feba3c23a1032c4bfafd9edcb44ff36130c48bbd", "message": "Apply suggestions from code review", "committedDate": "2020-01-14T18:53:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUxNDQxNg==", "url": "https://github.com/ls1intum/Artemis/pull/1188#discussion_r366514416", "bodyText": "can we move this method directly into the super class and use the submissionRepository instead?", "author": "krusche", "createdAt": "2020-01-14T18:56:07Z", "path": "src/main/java/de/tum/in/www1/artemis/service/TextAssessmentService.java", "diffHunk": "@@ -112,4 +116,15 @@ public Result saveAssessment(Long resultId, List<Feedback> textAssessment, TextE\n     private Double calculateTotalScore(List<Feedback> assessments) {\n         return assessments.stream().mapToDouble(Feedback::getCredits).sum();\n     }\n+\n+    /**\n+     * Finds the example result for the given submission ID. The submission has to be an example submission\n+     *\n+     * @param submissionId The ID of the submission for which the result should be fetched\n+     * @return The example result, which is linked to the submission\n+     */\n+    public Result getExampleResult(long submissionId) {", "originalCommit": "feba3c23a1032c4bfafd9edcb44ff36130c48bbd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUxNDY3Ng==", "url": "https://github.com/ls1intum/Artemis/pull/1188#discussion_r366514676", "bodyText": "can we move this into the submission repository?", "author": "krusche", "createdAt": "2020-01-14T18:56:41Z", "path": "src/main/java/de/tum/in/www1/artemis/repository/TextSubmissionRepository.java", "diffHunk": "@@ -54,4 +54,7 @@\n      */\n     @EntityGraph(attributePaths = { \"blocks\", \"result\", \"participation\" })\n     List<TextSubmission> findByParticipation_ExerciseIdAndResultIsNullAndSubmittedIsTrue(Long exerciseId);\n+\n+    @Query(\"select distinct submission from TextSubmission submission left join fetch submission.result r left join fetch r.feedbacks where submission.exampleSubmission = true and submission.id = :#{#submissionId}\")", "originalCommit": "feba3c23a1032c4bfafd9edcb44ff36130c48bbd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUxODc3MQ==", "url": "https://github.com/ls1intum/Artemis/pull/1188#discussion_r366518771", "bodyText": "I think you have reslutService twice here.", "author": "HanyaElhashemy", "createdAt": "2020-01-14T19:05:33Z", "path": "src/main/java/de/tum/in/www1/artemis/service/TextAssessmentService.java", "diffHunk": "@@ -17,12 +18,15 @@\n \n     private final UserService userService;\n \n+    private final ResultService resultService;\n+\n     public TextAssessmentService(UserService userService, ComplaintResponseService complaintResponseService, ComplaintRepository complaintRepository,\n             FeedbackRepository feedbackRepository, ResultRepository resultRepository, TextSubmissionRepository textSubmissionRepository,\n-            StudentParticipationRepository studentParticipationRepository, ResultService resultService, AuthorizationCheckService authCheckService) {\n+            StudentParticipationRepository studentParticipationRepository, ResultService resultService, AuthorizationCheckService authCheckService, ResultService resultService) {", "originalCommit": "feba3c23a1032c4bfafd9edcb44ff36130c48bbd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUyMzc0Mg==", "url": "https://github.com/ls1intum/Artemis/pull/1188#discussion_r366523742", "bodyText": "I fixed it, thanks!", "author": "krusche", "createdAt": "2020-01-14T19:16:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUxODc3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUyMDUxNQ==", "url": "https://github.com/ls1intum/Artemis/pull/1188#discussion_r366520515", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public ResponseEntity<Result> getExampleResultForTutor(@PathVariable Long exerciseId, @PathVariable Long submissionId) {\n          \n          \n            \n                public ResponseEntity<Result> getExampleResultForTutor(@PathVariable long exerciseId, @PathVariable long submissionId) {\n          \n      \n    \n    \n  \n\nhope I learned my lesson ;)", "author": "HanyaElhashemy", "createdAt": "2020-01-14T19:09:19Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/TextAssessmentResource.java", "diffHunk": "@@ -321,23 +317,17 @@ private void computeBlocks(Result result, TextExercise textExercise) {\n      * @param submissionId the id of the submission\n      * @return the result linked to the submission\n      */\n-    @GetMapping(\"/exercise/{exerciseId}/submission/{submissionId}/exampleAssessment\")\n+    @GetMapping(\"/exercise/{exerciseId}/submission/{submissionId}/example-result\")\n     @PreAuthorize(\"hasAnyRole('TA', 'INSTRUCTOR', 'ADMIN')\")\n-    public ResponseEntity<Result> getExampleAssessmentForTutor(@PathVariable Long exerciseId, @PathVariable Long submissionId) {\n+    public ResponseEntity<Result> getExampleResultForTutor(@PathVariable Long exerciseId, @PathVariable Long submissionId) {", "originalCommit": "feba3c23a1032c4bfafd9edcb44ff36130c48bbd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUyMTE0MA==", "url": "https://github.com/ls1intum/Artemis/pull/1188#discussion_r366521140", "bodyText": "The comment is a bit misleading. Is it the id of the submission or the id of the example submission?\nI guess it is the id of a submission that belongs to an example submission right?\nI guess we should also emphasize this in the comment at the top, that the submission must be connected to an example submission, otherwise this call throws an illegal argument exception. Otherwise another developer might be tempted to use this method.\nI even think you should rename the method to createNewExampleResultForSubmissionWithExampleSubmission or something similar", "author": "krusche", "createdAt": "2020-01-14T19:10:38Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ResultService.java", "diffHunk": "@@ -427,4 +427,24 @@ public void notifyUserAboutNewResult(Result result, Long participationId) {\n     private void notifyNewResult(Result result, Long participationId) {\n         websocketMessagingService.sendMessage(\"/topic/participation/\" + participationId + \"/newResults\", result);\n     }\n+\n+    /**\n+     * Create a new example result for the provided submission ID.\n+     *\n+     * @param submissionId The ID of the example submission for which a result should get created", "originalCommit": "feba3c23a1032c4bfafd9edcb44ff36130c48bbd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c1ab2facfbd58394156a3a210b0784db7028dc89", "url": "https://github.com/ls1intum/Artemis/commit/c1ab2facfbd58394156a3a210b0784db7028dc89", "message": "fix compile error after PR comments\n\nalso move method to super class and resolve TODO", "committedDate": "2020-01-14T19:16:57Z", "type": "commit"}, {"oid": "7f7910aee7aefb1cc4d91e27955b723e9cc93a2a", "url": "https://github.com/ls1intum/Artemis/commit/7f7910aee7aefb1cc4d91e27955b723e9cc93a2a", "message": "fix some logic errors for authentication and move method up to super class", "committedDate": "2020-01-14T19:36:59Z", "type": "commit"}, {"oid": "f1664673a085a81e55901f91784e72dc7787e83c", "url": "https://github.com/ls1intum/Artemis/commit/f1664673a085a81e55901f91784e72dc7787e83c", "message": "rename method and fix javadoc comment", "committedDate": "2020-01-14T19:39:12Z", "type": "commit"}, {"oid": "1d17104f888d566d60d733786d304429ddca74fb", "url": "https://github.com/ls1intum/Artemis/commit/1d17104f888d566d60d733786d304429ddca74fb", "message": "Update src/main/java/de/tum/in/www1/artemis/web/rest/TextAssessmentResource.java\n\nCo-Authored-By: Hanya Elhashemy <50635005+HanyaElhashemy@users.noreply.github.com>", "committedDate": "2020-01-14T19:39:59Z", "type": "commit"}, {"oid": "6975ce6714a425ec7c60dc1ed32eca5f209e5010", "url": "https://github.com/ls1intum/Artemis/commit/6975ce6714a425ec7c60dc1ed32eca5f209e5010", "message": "fix java code style", "committedDate": "2020-01-14T19:49:43Z", "type": "commit"}, {"oid": "3aa9c901aaae838b33784e020d6e691333b0d7b2", "url": "https://github.com/ls1intum/Artemis/commit/3aa9c901aaae838b33784e020d6e691333b0d7b2", "message": "Merge branch 'develop' into bugfix/text-exercise/working-example-submissions", "committedDate": "2020-01-14T19:58:47Z", "type": "commit"}, {"oid": "20ecd2020290157743347dd5484aa42f469045dd", "url": "https://github.com/ls1intum/Artemis/commit/20ecd2020290157743347dd5484aa42f469045dd", "message": "fix typo in method name", "committedDate": "2020-01-14T20:00:58Z", "type": "commit"}]}