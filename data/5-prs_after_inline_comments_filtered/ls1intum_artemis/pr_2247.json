{"pr_number": 2247, "pr_title": "Consistent use of DTOs in Jira/Bitbucket/BambooService and improved test coverage in BitbucketService", "pr_createdAt": "2020-10-21T06:52:20Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/2247", "timeline": [{"oid": "bd4f62ff0aad6285d3575bcc8d36db87cfd6b998", "url": "https://github.com/ls1intum/Artemis/commit/bd4f62ff0aad6285d3575bcc8d36db87cfd6b998", "message": "fix gitkraken display issue", "committedDate": "2020-10-18T07:36:11Z", "type": "commit"}, {"oid": "26b25818b571e0f5f9cbc7679d038eb2062b3586", "url": "https://github.com/ls1intum/Artemis/commit/26b25818b571e0f5f9cbc7679d038eb2062b3586", "message": "mock creating new lti user if needed", "committedDate": "2020-10-19T09:32:07Z", "type": "commit"}, {"oid": "80ec4a61ff077b0ed8e79b5eca59683064d33255", "url": "https://github.com/ls1intum/Artemis/commit/80ec4a61ff077b0ed8e79b5eca59683064d33255", "message": "Merge branch 'develop' into chore/improve-test-coverage/improve-bitbucket-service", "committedDate": "2020-10-19T09:33:20Z", "type": "commit"}, {"oid": "ecdd0a890a07932088f00719f9c8e7f58d999b96", "url": "https://github.com/ls1intum/Artemis/commit/ecdd0a890a07932088f00719f9c8e7f58d999b96", "message": "add testcase for fetchCommitInfo OnNotifyPush", "committedDate": "2020-10-19T11:18:44Z", "type": "commit"}, {"oid": "39624dae08a5ab4c185b7b17acad0c3b0a6da94c", "url": "https://github.com/ls1intum/Artemis/commit/39624dae08a5ab4c185b7b17acad0c3b0a6da94c", "message": "delete unused methods: deleteWebHook", "committedDate": "2020-10-19T13:55:52Z", "type": "commit"}, {"oid": "80599e814673fd983c323242d991f7861baa53b0", "url": "https://github.com/ls1intum/Artemis/commit/80599e814673fd983c323242d991f7861baa53b0", "message": "add testcases", "committedDate": "2020-10-19T15:11:38Z", "type": "commit"}, {"oid": "fee37851ba86ce01052e396a9e3b2ee391b51f90", "url": "https://github.com/ls1intum/Artemis/commit/fee37851ba86ce01052e396a9e3b2ee391b51f90", "message": "extract new UrlService to remove duplicated code\n\nalso add ProgrammingExerciseTestService based on delegation to align Bitbucket+Bamboo with Gitlab+Jenkins tests and to avoid duplicated code in those", "committedDate": "2020-10-19T23:28:39Z", "type": "commit"}, {"oid": "cbd19540ae573d73e9674f572547fc956d4627b5", "url": "https://github.com/ls1intum/Artemis/commit/cbd19540ae573d73e9674f572547fc956d4627b5", "message": "Merge branch 'develop' into chore/url-service-test-improvements", "committedDate": "2020-10-19T23:30:58Z", "type": "commit"}, {"oid": "18fc3563d804f873486f12cdb52f5aaabf30275e", "url": "https://github.com/ls1intum/Artemis/commit/18fc3563d804f873486f12cdb52f5aaabf30275e", "message": "Merge branch 'develop' into chore/url-service-test-improvements\n\n# Conflicts:\n#\tsrc/main/java/de/tum/in/www1/artemis/service/connectors/bamboo/BambooService.java", "committedDate": "2020-10-20T00:14:37Z", "type": "commit"}, {"oid": "d59f944e1fdbba7a5c22929a46a23bbb661c73cf", "url": "https://github.com/ls1intum/Artemis/commit/d59f944e1fdbba7a5c22929a46a23bbb661c73cf", "message": "Merge branch 'develop' into chore/url-service-test-improvements", "committedDate": "2020-10-20T00:19:06Z", "type": "commit"}, {"oid": "2e50ef9e61e981efa8557b20e941423a296608ec", "url": "https://github.com/ls1intum/Artemis/commit/2e50ef9e61e981efa8557b20e941423a296608ec", "message": "update kotlin version in pom.xml", "committedDate": "2020-10-20T00:23:44Z", "type": "commit"}, {"oid": "6c25a466d04728ee3f92f95c05ec048a66ff0303", "url": "https://github.com/ls1intum/Artemis/commit/6c25a466d04728ee3f92f95c05ec048a66ff0303", "message": "fix testing issues", "committedDate": "2020-10-20T00:38:59Z", "type": "commit"}, {"oid": "c3b202c2fc9b2028f1545ba01e36da3e97b1df19", "url": "https://github.com/ls1intum/Artemis/commit/c3b202c2fc9b2028f1545ba01e36da3e97b1df19", "message": "fix another test issue", "committedDate": "2020-10-20T00:47:37Z", "type": "commit"}, {"oid": "2551e13a2f95576995b120d70b67de4bcdb74391", "url": "https://github.com/ls1intum/Artemis/commit/2551e13a2f95576995b120d70b67de4bcdb74391", "message": "remove duplicated code for kotlin + java test by using parameterized tests", "committedDate": "2020-10-20T01:04:52Z", "type": "commit"}, {"oid": "4e51f74f59faa739f24bf9b54c75d65c88cdcb17", "url": "https://github.com/ls1intum/Artemis/commit/4e51f74f59faa739f24bf9b54c75d65c88cdcb17", "message": "add testcase for configurerepo", "committedDate": "2020-10-20T06:44:04Z", "type": "commit"}, {"oid": "5e612216dbe1fb6275562c58326403ad839c1102", "url": "https://github.com/ls1intum/Artemis/commit/5e612216dbe1fb6275562c58326403ad839c1102", "message": "Merge remote-tracking branch 'origin/develop' into chore/url-service-test-improvements\n\n# Conflicts:\n#\tsrc/test/java/de/tum/in/www1/artemis/programmingexercise/ProgrammingExerciseGitlabJenkinsIntegrationTest.java", "committedDate": "2020-10-20T10:51:52Z", "type": "commit"}, {"oid": "5274bdd28507ed0c467d10216e9a29ef6d13e4da", "url": "https://github.com/ls1intum/Artemis/commit/5274bdd28507ed0c467d10216e9a29ef6d13e4da", "message": "Create Service for testing of incoming programming exercise results", "committedDate": "2020-10-20T12:40:08Z", "type": "commit"}, {"oid": "4830dc0a18405a5d1273b6d4f58393acb06d7cf5", "url": "https://github.com/ls1intum/Artemis/commit/4830dc0a18405a5d1273b6d4f58393acb06d7cf5", "message": "fix warning", "committedDate": "2020-10-20T14:06:50Z", "type": "commit"}, {"oid": "4e4f06aaa5ee932c17233b0031357a8c4facc69e", "url": "https://github.com/ls1intum/Artemis/commit/4e4f06aaa5ee932c17233b0031357a8c4facc69e", "message": "Merge branch 'develop' into chore/url-service-test-improvements", "committedDate": "2020-10-20T14:08:41Z", "type": "commit"}, {"oid": "e70817b227ea3abf8dce4c499192b992258412a1", "url": "https://github.com/ls1intum/Artemis/commit/e70817b227ea3abf8dce4c499192b992258412a1", "message": "set min coverage for server tests to 80%", "committedDate": "2020-10-20T14:09:13Z", "type": "commit"}, {"oid": "45ec52f826dd38a9ff5017aaabe977f7b4ff4310", "url": "https://github.com/ls1intum/Artemis/commit/45ec52f826dd38a9ff5017aaabe977f7b4ff4310", "message": "Fix translation in programming ex detail view", "committedDate": "2020-10-20T14:48:05Z", "type": "commit"}, {"oid": "f946951c234f79f5edde5f294c2cae159b737190", "url": "https://github.com/ls1intum/Artemis/commit/f946951c234f79f5edde5f294c2cae159b737190", "message": "Merge branch 'chore/url-service-test-improvements' of https://github.com/ls1intum/Artemis into chore/url-service-test-improvements", "committedDate": "2020-10-20T14:48:21Z", "type": "commit"}, {"oid": "4afbf5d72d27834733872ab31695f6d4de5e3092", "url": "https://github.com/ls1intum/Artemis/commit/4afbf5d72d27834733872ab31695f6d4de5e3092", "message": "Merge remote-tracking branch 'origin/chore/url-service-test-improvements' into chore/improve-test-coverage/improve-bitbucket-service", "committedDate": "2020-10-20T15:57:01Z", "type": "commit"}, {"oid": "3f3b441f7e06a2d6f4fc7be72eaf1e753952526e", "url": "https://github.com/ls1intum/Artemis/commit/3f3b441f7e06a2d6f4fc7be72eaf1e753952526e", "message": "resolve merge conflicts", "committedDate": "2020-10-20T16:25:26Z", "type": "commit"}, {"oid": "bdb6bd4add0fbeb56d34bdbf31601a06e54480a3", "url": "https://github.com/ls1intum/Artemis/commit/bdb6bd4add0fbeb56d34bdbf31601a06e54480a3", "message": "Merge branch 'develop' into chore/improve-test-coverage/improve-bitbucket-service", "committedDate": "2020-10-21T06:47:35Z", "type": "commit"}, {"oid": "a19746f6aa60417e5aa427b32d681f639e05cf85", "url": "https://github.com/ls1intum/Artemis/commit/a19746f6aa60417e5aa427b32d681f639e05cf85", "message": "apply codacy changes", "committedDate": "2020-10-21T07:12:03Z", "type": "commit"}, {"oid": "c50145e664c747f8a48b9abf3cbee97dbdbde9f5", "url": "https://github.com/ls1intum/Artemis/commit/c50145e664c747f8a48b9abf3cbee97dbdbde9f5", "message": "add testcase for Conflict in copyRepository", "committedDate": "2020-10-21T08:50:40Z", "type": "commit"}, {"oid": "908360c2db88b00b42ea8408bf29a37d737c0ebc", "url": "https://github.com/ls1intum/Artemis/commit/908360c2db88b00b42ea8408bf29a37d737c0ebc", "message": "adapt JiraUserDto", "committedDate": "2020-10-21T11:59:52Z", "type": "commit"}, {"oid": "5ee24878d4af562d360535f6230868a74c6d33c9", "url": "https://github.com/ls1intum/Artemis/commit/5ee24878d4af562d360535f6230868a74c6d33c9", "message": "add new DTOs", "committedDate": "2020-10-21T14:37:56Z", "type": "commit"}, {"oid": "d7b4af520483072714e583f4e4542e0f1466d860", "url": "https://github.com/ls1intum/Artemis/commit/d7b4af520483072714e583f4e4542e0f1466d860", "message": "fix dtos", "committedDate": "2020-10-21T17:05:40Z", "type": "commit"}, {"oid": "24d534aaa110ea2968b3ad637a5552e89f7bfb13", "url": "https://github.com/ls1intum/Artemis/commit/24d534aaa110ea2968b3ad637a5552e89f7bfb13", "message": "remove parenthesis", "committedDate": "2020-10-21T17:07:21Z", "type": "commit"}, {"oid": "224d398090ed0105374cfb8ac0e06263d8e88a87", "url": "https://github.com/ls1intum/Artemis/commit/224d398090ed0105374cfb8ac0e06263d8e88a87", "message": "add javadoc", "committedDate": "2020-10-21T17:30:24Z", "type": "commit"}, {"oid": "de64e48e723b574f91fa530195c2408475aedfb5", "url": "https://github.com/ls1intum/Artemis/commit/de64e48e723b574f91fa530195c2408475aedfb5", "message": "fix Jira DTO issue", "committedDate": "2020-10-21T17:55:40Z", "type": "commit"}, {"oid": "3402b446644e577d357f76eda7a268789354e65d", "url": "https://github.com/ls1intum/Artemis/commit/3402b446644e577d357f76eda7a268789354e65d", "message": "refactor code", "committedDate": "2020-10-21T18:26:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTU3ODI0NQ==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r509578245", "bodyText": "we should return List<BitbucketWebHookDTO> here and simply return response.getBody().getSearchResults() or List.of()", "author": "krusche", "createdAt": "2020-10-21T18:51:45Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/bitbucket/BitbucketService.java", "diffHunk": "@@ -599,9 +583,10 @@ private void grantGroupPermissionToProject(String projectKey, String groupName,\n      */\n     private Map<Integer, String> getExistingWebHooks(String projectKey, String repositorySlug) throws BitbucketException {", "originalCommit": "3402b446644e577d357f76eda7a268789354e65d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYwMzE1MA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r509603150", "bodyText": "good idea. I've fixed that", "author": "derLalla", "createdAt": "2020-10-21T19:18:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTU3ODI0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTU3OTMxMA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r509579310", "bodyText": "please avoid String.format and use normal string concatenation", "author": "krusche", "createdAt": "2020-10-21T18:52:43Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/bitbucket/dto/BitbucketCloneDTO.java", "diffHunk": "@@ -30,6 +30,18 @@ public void setCloneDetails(CloneDetailsDTO cloneDetails) {\n         this.cloneDetails = cloneDetails;\n     }\n \n+    /**\n+     * Creating a description for the console log\n+     * @return description with name and project key\n+     */\n+    public String toString() {\n+        String description = String.format(\"name=%s\", name);", "originalCommit": "3402b446644e577d357f76eda7a268789354e65d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTU3OTg2NA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r509579864", "bodyText": "please avoid String.format and use normal string concatenation\ncheck out other toString() methods, you can actually generate those automatically in IntelliJ", "author": "krusche", "createdAt": "2020-10-21T18:53:09Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/bitbucket/dto/BitbucketCloneDTO.java", "diffHunk": "@@ -45,5 +57,9 @@ public String getKey() {\n         public void setKey(String key) {\n             this.key = key;\n         }\n+\n+        public String toString() {\n+            return String.format(\"project={key=%s}\", key);", "originalCommit": "3402b446644e577d357f76eda7a268789354e65d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYwNjQwMw==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r509606403", "bodyText": "thanks for the tip with IntelliJ", "author": "derLalla", "createdAt": "2020-10-21T19:24:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTU3OTg2NA=="}], "type": "inlineReview"}, {"oid": "a9711ce61339051a3870330eb0d5747b699cedde", "url": "https://github.com/ls1intum/Artemis/commit/a9711ce61339051a3870330eb0d5747b699cedde", "message": "apply changes", "committedDate": "2020-10-21T20:28:51Z", "type": "commit"}, {"oid": "71cee2248ac898f8f058947d14c113733507f5eb", "url": "https://github.com/ls1intum/Artemis/commit/71cee2248ac898f8f058947d14c113733507f5eb", "message": "convert to buildplan dto", "committedDate": "2020-10-22T09:41:18Z", "type": "commit"}, {"oid": "cd75bbdf64a34f22eda6ce079d497a6bc3924379", "url": "https://github.com/ls1intum/Artemis/commit/cd75bbdf64a34f22eda6ce079d497a6bc3924379", "message": "fix jackson parsing", "committedDate": "2020-10-22T12:21:24Z", "type": "commit"}, {"oid": "a8d5e2415661c669fe60c4d819897c1d6708ec93", "url": "https://github.com/ls1intum/Artemis/commit/a8d5e2415661c669fe60c4d819897c1d6708ec93", "message": "add BambooCommitDTO", "committedDate": "2020-10-22T12:23:03Z", "type": "commit"}, {"oid": "5dd8a00a8a0e9d8057c49976f8c83b92a3fcf81a", "url": "https://github.com/ls1intum/Artemis/commit/5dd8a00a8a0e9d8057c49976f8c83b92a3fcf81a", "message": "Merge branch 'develop' into chore/improve-test-coverage/improve-bitbucket-service", "committedDate": "2020-10-22T12:24:48Z", "type": "commit"}, {"oid": "fe8940b9bfc193896e413207eaf4981cdf2530fd", "url": "https://github.com/ls1intum/Artemis/commit/fe8940b9bfc193896e413207eaf4981cdf2530fd", "message": "Merge branch 'develop' into chore/improve-test-coverage/improve-bitbucket-service", "committedDate": "2020-10-26T14:01:30Z", "type": "commit"}, {"oid": "85566e67c5a8bf8ea99502cc3cbc804d7d157058", "url": "https://github.com/ls1intum/Artemis/commit/85566e67c5a8bf8ea99502cc3cbc804d7d157058", "message": "Merge branch 'develop' into chore/improve-test-coverage/improve-bitbucket-service", "committedDate": "2020-10-28T19:08:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5OTM4Nw==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r513699387", "bodyText": "Maybe add here also a constructor, like for BitbucketCloneDTO :)", "author": "fde312", "createdAt": "2020-10-28T19:15:58Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/bitbucket/dto/BitbucketCloneDTO.java", "diffHunk": "@@ -30,6 +36,15 @@ public void setCloneDetails(CloneDetailsDTO cloneDetails) {\n         this.cloneDetails = cloneDetails;\n     }\n \n+    /**\n+     * Creating a description for the console log\n+     * @return description with name and project key\n+     */\n+    @Override\n+    public String toString() {\n+        return \"BitbucketCloneDTO{\" + \"name='\" + name + '\\'' + \", cloneDetails=\" + cloneDetails.toString() + '}';\n+    }\n+\n     public static final class CloneDetailsDTO {\n ", "originalCommit": "fe8940b9bfc193896e413207eaf4981cdf2530fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcwNzQ2Mw==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r513707463", "bodyText": "yes thanks!", "author": "derLalla", "createdAt": "2020-10-28T19:30:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5OTM4Nw=="}], "type": "inlineReview"}, {"oid": "ac5c71762690554fe29a2886894ae66efb8541d5", "url": "https://github.com/ls1intum/Artemis/commit/ac5c71762690554fe29a2886894ae66efb8541d5", "message": "add empty constructors for DTOs", "committedDate": "2020-10-28T19:22:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg5MTM3Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r513891372", "bodyText": "This can be shortened to buildResult.getPlan().getKey().", "author": "kloessst", "createdAt": "2020-10-29T02:36:28Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/bamboo/BambooService.java", "diffHunk": "@@ -496,11 +496,10 @@ public void updatePlanRepository(String bambooProject, String buildPlanKey, Stri\n      */\n     @Override\n     public String getPlanKey(Object requestBody) throws BambooException {\n-        // TODO: convert into a proper DTO object to avoid unchecked Map casts\n         try {\n-            Map<String, Object> requestBodyMap = (Map<String, Object>) requestBody;\n-            Map<String, Object> planMap = (Map<String, Object>) requestBodyMap.get(\"plan\");\n-            return (String) planMap.get(\"key\");\n+            final var buildResult = mapper.convertValue(requestBody, BambooBuildResultNotificationDTO.class);\n+            var plan = buildResult.getPlan();", "originalCommit": "ac5c71762690554fe29a2886894ae66efb8541d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDA4ODUwMA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514088500", "bodyText": "well seen. I've changed it.", "author": "derLalla", "createdAt": "2020-10-29T08:41:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg5MTM3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDA4ODAyOA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514088028", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        var plan = buildResult.getPlan();\n          \n          \n            \n                        return plan.getKey();\n          \n          \n            \n                        return buildResult.getPlan().getKey();", "author": "derLalla", "createdAt": "2020-10-29T08:41:12Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/bamboo/BambooService.java", "diffHunk": "@@ -496,11 +496,10 @@ public void updatePlanRepository(String bambooProject, String buildPlanKey, Stri\n      */\n     @Override\n     public String getPlanKey(Object requestBody) throws BambooException {\n-        // TODO: convert into a proper DTO object to avoid unchecked Map casts\n         try {\n-            Map<String, Object> requestBodyMap = (Map<String, Object>) requestBody;\n-            Map<String, Object> planMap = (Map<String, Object>) requestBodyMap.get(\"plan\");\n-            return (String) planMap.get(\"key\");\n+            final var buildResult = mapper.convertValue(requestBody, BambooBuildResultNotificationDTO.class);\n+            var plan = buildResult.getPlan();\n+            return plan.getKey();", "originalCommit": "ac5c71762690554fe29a2886894ae66efb8541d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "10af0efb96c5b878db8ec77b655d353172905bcb", "url": "https://github.com/ls1intum/Artemis/commit/10af0efb96c5b878db8ec77b655d353172905bcb", "message": "Update src/main/java/de/tum/in/www1/artemis/service/connectors/bamboo/BambooService.java", "committedDate": "2020-10-29T08:41:26Z", "type": "commit"}, {"oid": "21aaac3147d9580b62e55ea7e694dfa507995b36", "url": "https://github.com/ls1intum/Artemis/commit/21aaac3147d9580b62e55ea7e694dfa507995b36", "message": "Merge branch 'develop' into chore/improve-test-coverage/improve-bitbucket-service", "committedDate": "2020-10-29T10:22:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1MzgxNg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153816", "bodyText": "Codacy found an issue: Avoid reassigning parameters such as 'sourceRepoName'", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:46Z", "path": "src/test/java/de/tum/in/www1/artemis/connector/bitbucket/BitbucketRequestMockProvider.java", "diffHunk": "@@ -118,24 +126,29 @@ public void mockAddWebHooks(ProgrammingExercise exercise) throws IOException {\n                 .andExpect(method(HttpMethod.POST)).andRespond(withStatus(HttpStatus.OK));\n     }\n \n-    public void mockCopyRepositoryForParticipation(ProgrammingExercise exercise, String username) throws URISyntaxException, IOException {\n+    public void mockCopyRepositoryForParticipation(ProgrammingExercise exercise, String username, HttpStatus status) throws URISyntaxException, IOException {\n         final var projectKey = exercise.getProjectKey();\n         final var templateRepoName = exercise.getProjectKey().toLowerCase() + \"-\" + RepositoryType.TEMPLATE.getName();\n         final var clonedRepoName = projectKey.toLowerCase() + \"-\" + username.toLowerCase();\n \n-        mockCopyRepository(projectKey, projectKey, templateRepoName, clonedRepoName);\n+        mockCopyRepository(projectKey, projectKey, templateRepoName, clonedRepoName, status);\n     }\n \n     public void mockCopyRepository(String sourceProjectKey, String targetProjectKey, String sourceRepoName, String targetRepoName)\n             throws JsonProcessingException, URISyntaxException {\n+        mockCopyRepository(sourceProjectKey, targetProjectKey, sourceRepoName, targetRepoName, HttpStatus.CREATED);\n+    }\n+\n+    public void mockCopyRepository(String sourceProjectKey, String targetProjectKey, String sourceRepoName, String targetRepoName, HttpStatus httpStatus)", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1MzgzNA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153834", "bodyText": "Codacy found an issue: Document empty constructor", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:47Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/bitbucket/dto/BitbucketBranchProtectionDTO.java", "diffHunk": "@@ -9,6 +9,12 @@\n \n     private MatcherDTO matcher;\n \n+    /**\n+     * needed for Jackson\n+     */\n+    public BitbucketBranchProtectionDTO() {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQzODM1NA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514438354", "bodyText": "@derLalla I believe you could prevent these warning if you put the documentation inside the (empty) constructor instead of above, in case you are interested in changing this.\nOtherwise just resolve it again.", "author": "sleiss", "createdAt": "2020-10-29T17:27:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1MzgzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzg0OQ==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153849", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:48Z", "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseTestService.java", "diffHunk": "@@ -585,6 +600,137 @@ public void repositoryAccessIsRemoved_whenStudentIsRemovedFromTeam() throws Exce\n         }\n     }\n \n+    // TEST\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // create a team for the user (necessary condition before starting an exercise)\n+        final String edxUsername = userPrefixEdx.get() + \"student\";\n+        User edxStudent = ModelFactory.generateActivatedUsers(edxUsername, new String[] { \"tumuser\", \"testgroup\" }, Set.of(new Authority(AuthoritiesConstants.USER)), 1).get(0);\n+        edxStudent.setPassword(userService.encryptor().encrypt(edxStudent.getPassword()));\n+        edxStudent = userRepo.save(edxStudent);\n+        Set<User> students = Set.of(edxStudent);\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Student was correctly added to team\").hasSize(1);\n+\n+        // Set up mock requests for start participation and that a lti user is not existent\n+        final boolean ltiUserExists = false;\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.CREATED);\n+        mockDelegate.mockConnectorRequestsForStartParticipation(exercise, team.getParticipantIdentifier(), team.getStudents(), ltiUserExists);\n+\n+        // Start participation with original team\n+        participationService.startExercise(exercise, team, false);\n+    }\n+\n+    // TEST\n+    public void copyRepository_testInternalServerError() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzg2MQ==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153861", "bodyText": "Codacy found an issue: Useless parentheses.", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:49Z", "path": "src/test/java/de/tum/in/www1/artemis/connector/bitbucket/BitbucketRequestMockProvider.java", "diffHunk": "@@ -146,24 +159,59 @@ public void mockGetBitbucketRepository(ProgrammingExercise exercise, String bitb\n                 .andRespond(withStatus(HttpStatus.OK).contentType(MediaType.APPLICATION_JSON).body(mapper.writeValueAsString(bitbucketRepository)));\n     }\n \n-    public void mockConfigureRepository(ProgrammingExercise exercise, String username, Set<User> users) throws URISyntaxException, IOException {\n+    public void mockConfigureRepository(ProgrammingExercise exercise, String username, Set<User> users, boolean ltiUserExists) throws URISyntaxException, IOException {\n         final var projectKey = exercise.getProjectKey();\n         final var repoName = projectKey.toLowerCase() + \"-\" + username.toLowerCase();\n         for (User user : users) {\n             if (exercise.hasCourse()) {\n-                mockGiveWritePermission(exercise, repoName, user.getLogin());\n+                // add mock for userExists() check, if the username contains edx_ or u4i_\n+                String loginName = user.getLogin();\n+                if (userPrefixEdx.isPresent() && loginName.startsWith(userPrefixEdx.get()) || userPrefixU4I.isPresent() && loginName.startsWith((userPrefixU4I.get()))) {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzg3OA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153878", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:50Z", "path": "src/test/java/de/tum/in/www1/artemis/connector/bitbucket/BitbucketRequestMockProvider.java", "diffHunk": "@@ -118,24 +126,29 @@ public void mockAddWebHooks(ProgrammingExercise exercise) throws IOException {\n                 .andExpect(method(HttpMethod.POST)).andRespond(withStatus(HttpStatus.OK));\n     }\n \n-    public void mockCopyRepositoryForParticipation(ProgrammingExercise exercise, String username) throws URISyntaxException, IOException {\n+    public void mockCopyRepositoryForParticipation(ProgrammingExercise exercise, String username, HttpStatus status) throws URISyntaxException, IOException {\n         final var projectKey = exercise.getProjectKey();\n         final var templateRepoName = exercise.getProjectKey().toLowerCase() + \"-\" + RepositoryType.TEMPLATE.getName();\n         final var clonedRepoName = projectKey.toLowerCase() + \"-\" + username.toLowerCase();\n \n-        mockCopyRepository(projectKey, projectKey, templateRepoName, clonedRepoName);\n+        mockCopyRepository(projectKey, projectKey, templateRepoName, clonedRepoName, status);\n     }\n \n     public void mockCopyRepository(String sourceProjectKey, String targetProjectKey, String sourceRepoName, String targetRepoName)\n             throws JsonProcessingException, URISyntaxException {\n+        mockCopyRepository(sourceProjectKey, targetProjectKey, sourceRepoName, targetRepoName, HttpStatus.CREATED);\n+    }\n+\n+    public void mockCopyRepository(String sourceProjectKey, String targetProjectKey, String sourceRepoName, String targetRepoName, HttpStatus httpStatus)", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzg5Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153892", "bodyText": "Codacy found an issue: An empty method in an abstract class should be abstract instead", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:51Z", "path": "src/test/java/de/tum/in/www1/artemis/AbstractSpringIntegrationJenkinsGitlabTest.java", "diffHunk": "@@ -89,7 +90,13 @@ public void mockConnectorRequestsForSetup(ProgrammingExercise exercise) throws E\n     }\n \n     @Override\n-    public List<Verifiable> mockConnectorRequestsForStartParticipation(ProgrammingExercise exercise, String username, Set<User> users) throws IOException, URISyntaxException {\n+    public void mockCopyRepositoryForParticipation(ProgrammingExercise exercise, String username, HttpStatus status) throws URISyntaxException, IOException {\n+        // TODO: implement\n+    }\n+\n+    @Override\n+    public List<Verifiable> mockConnectorRequestsForStartParticipation(ProgrammingExercise exercise, String username, Set<User> users, boolean ltiUserExists)", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzg5Nw==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153897", "bodyText": "Codacy found an issue: Avoid unused local variables such as 'repoName'.", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:52Z", "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseTestService.java", "diffHunk": "@@ -585,6 +600,137 @@ public void repositoryAccessIsRemoved_whenStudentIsRemovedFromTeam() throws Exce\n         }\n     }\n \n+    // TEST\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // create a team for the user (necessary condition before starting an exercise)\n+        final String edxUsername = userPrefixEdx.get() + \"student\";\n+        User edxStudent = ModelFactory.generateActivatedUsers(edxUsername, new String[] { \"tumuser\", \"testgroup\" }, Set.of(new Authority(AuthoritiesConstants.USER)), 1).get(0);\n+        edxStudent.setPassword(userService.encryptor().encrypt(edxStudent.getPassword()));\n+        edxStudent = userRepo.save(edxStudent);\n+        Set<User> students = Set.of(edxStudent);\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Student was correctly added to team\").hasSize(1);\n+\n+        // Set up mock requests for start participation and that a lti user is not existent\n+        final boolean ltiUserExists = false;\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.CREATED);\n+        mockDelegate.mockConnectorRequestsForStartParticipation(exercise, team.getParticipantIdentifier(), team.getStudents(), ltiUserExists);\n+\n+        // Start participation with original team\n+        participationService.startExercise(exercise, team, false);\n+    }\n+\n+    // TEST\n+    public void copyRepository_testInternalServerError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for internal server error\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.INTERNAL_SERVER_ERROR);\n+\n+        // Start participation\n+        try {\n+            participationService.startExercise(exercise, team, false);\n+        }\n+        catch (BitbucketException e) {\n+            assertThat(e.getMessage()).isEqualTo(\"Error while forking repository\");\n+        }\n+    }\n+\n+    // TEST\n+    public void copyRepository_testBadRequestError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for internal server error\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.BAD_REQUEST);\n+\n+        // Start participation\n+        try {\n+            participationService.startExercise(exercise, team, false);\n+        }\n+        catch (BitbucketException e) {\n+            assertThat(e.getMessage()).isEqualTo(\"Error while forking repository\");\n+        }\n+    }\n+\n+    // TEST\n+    public void copyRepository_testConflictError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for Conflict exception\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.CONFLICT);\n+        mockDelegate.mockConnectorRequestsForStartParticipation(exercise, team.getParticipantIdentifier(), team.getStudents(), true);\n+\n+        // Start participation\n+        participationService.startExercise(exercise, team, false);\n+    }\n+\n+    // TEST\n+    public void configureRepository_testBadRequestError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for internal server error\n+        final var username = team.getParticipantIdentifier();\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, username, HttpStatus.CREATED);\n+        final var projectKey = exercise.getProjectKey();\n+        final var repoName = projectKey.toLowerCase() + \"-\" + username.toLowerCase();", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1MzkwNw==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153907", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:53Z", "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseTestService.java", "diffHunk": "@@ -585,6 +600,137 @@ public void repositoryAccessIsRemoved_whenStudentIsRemovedFromTeam() throws Exce\n         }\n     }\n \n+    // TEST\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1MzkxMw==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153913", "bodyText": "Codacy found an issue: The instance method name 'copyRepository_testConflictError' doesn't match '[a-z][a-zA-Z0-9]*'", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:54Z", "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseTestService.java", "diffHunk": "@@ -585,6 +600,137 @@ public void repositoryAccessIsRemoved_whenStudentIsRemovedFromTeam() throws Exce\n         }\n     }\n \n+    // TEST\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // create a team for the user (necessary condition before starting an exercise)\n+        final String edxUsername = userPrefixEdx.get() + \"student\";\n+        User edxStudent = ModelFactory.generateActivatedUsers(edxUsername, new String[] { \"tumuser\", \"testgroup\" }, Set.of(new Authority(AuthoritiesConstants.USER)), 1).get(0);\n+        edxStudent.setPassword(userService.encryptor().encrypt(edxStudent.getPassword()));\n+        edxStudent = userRepo.save(edxStudent);\n+        Set<User> students = Set.of(edxStudent);\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Student was correctly added to team\").hasSize(1);\n+\n+        // Set up mock requests for start participation and that a lti user is not existent\n+        final boolean ltiUserExists = false;\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.CREATED);\n+        mockDelegate.mockConnectorRequestsForStartParticipation(exercise, team.getParticipantIdentifier(), team.getStudents(), ltiUserExists);\n+\n+        // Start participation with original team\n+        participationService.startExercise(exercise, team, false);\n+    }\n+\n+    // TEST\n+    public void copyRepository_testInternalServerError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for internal server error\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.INTERNAL_SERVER_ERROR);\n+\n+        // Start participation\n+        try {\n+            participationService.startExercise(exercise, team, false);\n+        }\n+        catch (BitbucketException e) {\n+            assertThat(e.getMessage()).isEqualTo(\"Error while forking repository\");\n+        }\n+    }\n+\n+    // TEST\n+    public void copyRepository_testBadRequestError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for internal server error\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.BAD_REQUEST);\n+\n+        // Start participation\n+        try {\n+            participationService.startExercise(exercise, team, false);\n+        }\n+        catch (BitbucketException e) {\n+            assertThat(e.getMessage()).isEqualTo(\"Error while forking repository\");\n+        }\n+    }\n+\n+    // TEST\n+    public void copyRepository_testConflictError() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1MzkyMg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153922", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:54Z", "path": "src/test/java/de/tum/in/www1/artemis/connector/bitbucket/BitbucketRequestMockProvider.java", "diffHunk": "@@ -146,24 +159,59 @@ public void mockGetBitbucketRepository(ProgrammingExercise exercise, String bitb\n                 .andRespond(withStatus(HttpStatus.OK).contentType(MediaType.APPLICATION_JSON).body(mapper.writeValueAsString(bitbucketRepository)));\n     }\n \n-    public void mockConfigureRepository(ProgrammingExercise exercise, String username, Set<User> users) throws URISyntaxException, IOException {\n+    public void mockConfigureRepository(ProgrammingExercise exercise, String username, Set<User> users, boolean ltiUserExists) throws URISyntaxException, IOException {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1MzkzNA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153934", "bodyText": "Codacy found an issue: Document empty constructor", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:55Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jira/dto/JiraUserDTO.java", "diffHunk": "@@ -16,6 +20,41 @@\n \n     private JiraUserGroupsDTO groups;\n \n+    private List<String> applicationKeys = new ArrayList<>();\n+\n+    /**\n+     * needed for Jackson\n+     */\n+    public JiraUserDTO() {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzk0OA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153948", "bodyText": "Codacy found an issue: The JUnit 5 test method name 'copyRepository_testInternalServerError' doesn't match '[a-z][a-zA-Z0-9]*'", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:56Z", "path": "src/test/java/de/tum/in/www1/artemis/programmingexercise/ProgrammingExerciseBitbucketBambooIntegrationTest.java", "diffHunk": "@@ -144,4 +144,34 @@ public void importProgrammingExercise_mode_changedToTeam() throws Exception {\n         programmingExerciseTestService.testImportProgrammingExercise_team_modeChange();\n     }\n \n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {\n+        programmingExerciseTestService.configureRepository_createTeamUserWhenLtiUserIsNotExistent();\n+    }\n+\n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void copyRepository_testInternalServerError() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzk2MA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153960", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:57Z", "path": "src/test/java/de/tum/in/www1/artemis/connector/bitbucket/BitbucketRequestMockProvider.java", "diffHunk": "@@ -287,4 +337,16 @@ public void mockHealth(String state, HttpStatus httpStatus) throws URISyntaxExce\n         mockServer.expect(requestTo(uri)).andExpect(method(HttpMethod.GET))\n                 .andRespond(withStatus(httpStatus).contentType(MediaType.APPLICATION_JSON).body(mapper.writeValueAsString(response)));\n     }\n+\n+    public void mockFetchCommitInfo(String projectKey, String slug, String hash) throws URISyntaxException, JsonProcessingException {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzk3MQ==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153971", "bodyText": "Codacy found an issue: The JUnit 5 test method name 'copyRepository_testConflictError' doesn't match '[a-z][a-zA-Z0-9]*'", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:58Z", "path": "src/test/java/de/tum/in/www1/artemis/programmingexercise/ProgrammingExerciseBitbucketBambooIntegrationTest.java", "diffHunk": "@@ -144,4 +144,34 @@ public void importProgrammingExercise_mode_changedToTeam() throws Exception {\n         programmingExerciseTestService.testImportProgrammingExercise_team_modeChange();\n     }\n \n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {\n+        programmingExerciseTestService.configureRepository_createTeamUserWhenLtiUserIsNotExistent();\n+    }\n+\n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void copyRepository_testInternalServerError() throws Exception {\n+        programmingExerciseTestService.copyRepository_testInternalServerError();\n+    }\n+\n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void copyRepository_testBadRequestError() throws Exception {\n+        programmingExerciseTestService.copyRepository_testBadRequestError();\n+    }\n+\n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void copyRepository_testConflictError() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzk3Ng==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153976", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "author": "artemis-bot", "createdAt": "2020-10-29T10:27:59Z", "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseTestService.java", "diffHunk": "@@ -585,6 +600,137 @@ public void repositoryAccessIsRemoved_whenStudentIsRemovedFromTeam() throws Exce\n         }\n     }\n \n+    // TEST\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // create a team for the user (necessary condition before starting an exercise)\n+        final String edxUsername = userPrefixEdx.get() + \"student\";\n+        User edxStudent = ModelFactory.generateActivatedUsers(edxUsername, new String[] { \"tumuser\", \"testgroup\" }, Set.of(new Authority(AuthoritiesConstants.USER)), 1).get(0);\n+        edxStudent.setPassword(userService.encryptor().encrypt(edxStudent.getPassword()));\n+        edxStudent = userRepo.save(edxStudent);\n+        Set<User> students = Set.of(edxStudent);\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Student was correctly added to team\").hasSize(1);\n+\n+        // Set up mock requests for start participation and that a lti user is not existent\n+        final boolean ltiUserExists = false;\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.CREATED);\n+        mockDelegate.mockConnectorRequestsForStartParticipation(exercise, team.getParticipantIdentifier(), team.getStudents(), ltiUserExists);\n+\n+        // Start participation with original team\n+        participationService.startExercise(exercise, team, false);\n+    }\n+\n+    // TEST\n+    public void copyRepository_testInternalServerError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for internal server error\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.INTERNAL_SERVER_ERROR);\n+\n+        // Start participation\n+        try {\n+            participationService.startExercise(exercise, team, false);\n+        }\n+        catch (BitbucketException e) {\n+            assertThat(e.getMessage()).isEqualTo(\"Error while forking repository\");\n+        }\n+    }\n+\n+    // TEST\n+    public void copyRepository_testBadRequestError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for internal server error\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.BAD_REQUEST);\n+\n+        // Start participation\n+        try {\n+            participationService.startExercise(exercise, team, false);\n+        }\n+        catch (BitbucketException e) {\n+            assertThat(e.getMessage()).isEqualTo(\"Error while forking repository\");\n+        }\n+    }\n+\n+    // TEST\n+    public void copyRepository_testConflictError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for Conflict exception\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.CONFLICT);\n+        mockDelegate.mockConnectorRequestsForStartParticipation(exercise, team.getParticipantIdentifier(), team.getStudents(), true);\n+\n+        // Start participation\n+        participationService.startExercise(exercise, team, false);\n+    }\n+\n+    // TEST\n+    public void configureRepository_testBadRequestError() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzk4Mw==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153983", "bodyText": "Codacy found an issue: An empty method in an abstract class should be abstract instead", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:00Z", "path": "src/test/java/de/tum/in/www1/artemis/AbstractSpringIntegrationJenkinsGitlabTest.java", "diffHunk": "@@ -89,7 +90,13 @@ public void mockConnectorRequestsForSetup(ProgrammingExercise exercise) throws E\n     }\n \n     @Override\n-    public List<Verifiable> mockConnectorRequestsForStartParticipation(ProgrammingExercise exercise, String username, Set<User> users) throws IOException, URISyntaxException {\n+    public void mockCopyRepositoryForParticipation(ProgrammingExercise exercise, String username, HttpStatus status) throws URISyntaxException, IOException {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1Mzk5NA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514153994", "bodyText": "Codacy found an issue: Document empty constructor", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:01Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/bitbucket/dto/BitbucketCloneDTO.java", "diffHunk": "@@ -9,6 +9,12 @@\n     @JsonProperty(\"project\")\n     private CloneDetailsDTO cloneDetails;\n \n+    /**\n+     * needed for Jackson\n+     */\n+    public BitbucketCloneDTO() {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDAwNg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514154006", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:02Z", "path": "src/test/java/de/tum/in/www1/artemis/connector/bitbucket/BitbucketRequestMockProvider.java", "diffHunk": "@@ -227,19 +275,21 @@ public void mockCheckIfProjectExists(final ProgrammingExercise exercise, final b\n                 .andRespond(withStatus(HttpStatus.OK).contentType(MediaType.APPLICATION_JSON).body(mapper.writeValueAsString(searchResults)));\n     }\n \n-    public void mockGetExistingWebhooks(String projectKey, String repositoryName) throws URISyntaxException {\n+    public void mockGetExistingWebhooks(String projectKey, String repositoryName) throws URISyntaxException, JsonProcessingException {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDAxMg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514154012", "bodyText": "Codacy found an issue: The JUnit 5 test method name 'configureRepository_createTeamUserWhenLtiUserIsNotExistent' doesn't match '[a-z][a-zA-Z0-9]*'", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:03Z", "path": "src/test/java/de/tum/in/www1/artemis/programmingexercise/ProgrammingExerciseBitbucketBambooIntegrationTest.java", "diffHunk": "@@ -144,4 +144,34 @@ public void importProgrammingExercise_mode_changedToTeam() throws Exception {\n         programmingExerciseTestService.testImportProgrammingExercise_team_modeChange();\n     }\n \n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDAyOA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514154028", "bodyText": "Codacy found an issue: Document empty constructor", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:04Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jira/dto/JiraUserDTO.java", "diffHunk": "@@ -79,6 +126,12 @@ public void setItems(Set<JiraUserGroupDTO> items) {\n \n         private URL self;\n \n+        /**\n+         * needed for Jackson\n+         */\n+        public JiraUserGroupDTO() {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDAzNw==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514154037", "bodyText": "Codacy found an issue: The instance method name 'copyRepository_testInternalServerError' doesn't match '[a-z][a-zA-Z0-9]*'", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:05Z", "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseTestService.java", "diffHunk": "@@ -585,6 +600,137 @@ public void repositoryAccessIsRemoved_whenStudentIsRemovedFromTeam() throws Exce\n         }\n     }\n \n+    // TEST\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // create a team for the user (necessary condition before starting an exercise)\n+        final String edxUsername = userPrefixEdx.get() + \"student\";\n+        User edxStudent = ModelFactory.generateActivatedUsers(edxUsername, new String[] { \"tumuser\", \"testgroup\" }, Set.of(new Authority(AuthoritiesConstants.USER)), 1).get(0);\n+        edxStudent.setPassword(userService.encryptor().encrypt(edxStudent.getPassword()));\n+        edxStudent = userRepo.save(edxStudent);\n+        Set<User> students = Set.of(edxStudent);\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Student was correctly added to team\").hasSize(1);\n+\n+        // Set up mock requests for start participation and that a lti user is not existent\n+        final boolean ltiUserExists = false;\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.CREATED);\n+        mockDelegate.mockConnectorRequestsForStartParticipation(exercise, team.getParticipantIdentifier(), team.getStudents(), ltiUserExists);\n+\n+        // Start participation with original team\n+        participationService.startExercise(exercise, team, false);\n+    }\n+\n+    // TEST\n+    public void copyRepository_testInternalServerError() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDA1MA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514154050", "bodyText": "Codacy found an issue: The instance method name 'copyRepository_testBadRequestError' doesn't match '[a-z][a-zA-Z0-9]*'", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:06Z", "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseTestService.java", "diffHunk": "@@ -585,6 +600,137 @@ public void repositoryAccessIsRemoved_whenStudentIsRemovedFromTeam() throws Exce\n         }\n     }\n \n+    // TEST\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // create a team for the user (necessary condition before starting an exercise)\n+        final String edxUsername = userPrefixEdx.get() + \"student\";\n+        User edxStudent = ModelFactory.generateActivatedUsers(edxUsername, new String[] { \"tumuser\", \"testgroup\" }, Set.of(new Authority(AuthoritiesConstants.USER)), 1).get(0);\n+        edxStudent.setPassword(userService.encryptor().encrypt(edxStudent.getPassword()));\n+        edxStudent = userRepo.save(edxStudent);\n+        Set<User> students = Set.of(edxStudent);\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Student was correctly added to team\").hasSize(1);\n+\n+        // Set up mock requests for start participation and that a lti user is not existent\n+        final boolean ltiUserExists = false;\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.CREATED);\n+        mockDelegate.mockConnectorRequestsForStartParticipation(exercise, team.getParticipantIdentifier(), team.getStudents(), ltiUserExists);\n+\n+        // Start participation with original team\n+        participationService.startExercise(exercise, team, false);\n+    }\n+\n+    // TEST\n+    public void copyRepository_testInternalServerError() throws Exception {\n+        exercise.setMode(ExerciseMode.TEAM);\n+        programmingExerciseRepository.save(exercise);\n+        database.addTemplateParticipationForProgrammingExercise(exercise);\n+        database.addSolutionParticipationForProgrammingExercise(exercise);\n+\n+        // Create a team with students\n+        Set<User> students = new HashSet<>(userRepo.findAllInGroup(\"tumuser\"));\n+        Team team = new Team().name(\"Team 1\").shortName(teamShortName).exercise(exercise).students(students);\n+        team = teamService.save(exercise, team);\n+\n+        assertThat(team.getStudents()).as(\"Students were correctly added to team\").hasSize(numberOfStudents);\n+\n+        // test for internal server error\n+        mockDelegate.mockCopyRepositoryForParticipation(exercise, team.getParticipantIdentifier(), HttpStatus.INTERNAL_SERVER_ERROR);\n+\n+        // Start participation\n+        try {\n+            participationService.startExercise(exercise, team, false);\n+        }\n+        catch (BitbucketException e) {\n+            assertThat(e.getMessage()).isEqualTo(\"Error while forking repository\");\n+        }\n+    }\n+\n+    // TEST\n+    public void copyRepository_testBadRequestError() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDA1NQ==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514154055", "bodyText": "Codacy found an issue: The instance method name 'configureRepository_createTeamUserWhenLtiUserIsNotExistent' doesn't match '[a-z][a-zA-Z0-9]*'", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:07Z", "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseTestService.java", "diffHunk": "@@ -585,6 +600,137 @@ public void repositoryAccessIsRemoved_whenStudentIsRemovedFromTeam() throws Exce\n         }\n     }\n \n+    // TEST\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDA2Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514154062", "bodyText": "Codacy found an issue: Avoid using implementation types like 'ArrayList'; use the interface instead", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:08Z", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/bitbucket/dto/BitbucketWebHookDTO.java", "diffHunk": "@@ -0,0 +1,61 @@\n+package de.tum.in.www1.artemis.service.connectors.bitbucket.dto;\n+\n+import java.util.ArrayList;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+public class BitbucketWebHookDTO {\n+\n+    private Integer id;\n+\n+    private String name;\n+\n+    private String url;\n+\n+    private ArrayList<String> events;\n+\n+    public Integer getId() {\n+        return id;\n+    }\n+\n+    public void setId(Integer id) {\n+        this.id = id;\n+    }\n+\n+    public String getName() {\n+        return name;\n+    }\n+\n+    public void setName(String name) {\n+        this.name = name;\n+    }\n+\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    public ArrayList<String> getEvents() {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQzNzAyNg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514437026", "bodyText": "@derLalla I actually found that warning useful - Can't we use List here?", "author": "sleiss", "createdAt": "2020-10-29T17:25:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDA2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ5NDMwOA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514494308", "bodyText": "Please use List here.", "author": "MaisiKoleni", "createdAt": "2020-10-29T18:56:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDA2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE1NDA3Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514154072", "bodyText": "Codacy found an issue: The JUnit 5 test method name 'configureRepository_testBadRequestError' doesn't match '[a-z][a-zA-Z0-9]*'", "author": "artemis-bot", "createdAt": "2020-10-29T10:28:09Z", "path": "src/test/java/de/tum/in/www1/artemis/programmingexercise/ProgrammingExerciseBitbucketBambooIntegrationTest.java", "diffHunk": "@@ -144,4 +144,34 @@ public void importProgrammingExercise_mode_changedToTeam() throws Exception {\n         programmingExerciseTestService.testImportProgrammingExercise_team_modeChange();\n     }\n \n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void configureRepository_createTeamUserWhenLtiUserIsNotExistent() throws Exception {\n+        programmingExerciseTestService.configureRepository_createTeamUserWhenLtiUserIsNotExistent();\n+    }\n+\n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void copyRepository_testInternalServerError() throws Exception {\n+        programmingExerciseTestService.copyRepository_testInternalServerError();\n+    }\n+\n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void copyRepository_testBadRequestError() throws Exception {\n+        programmingExerciseTestService.copyRepository_testBadRequestError();\n+    }\n+\n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void copyRepository_testConflictError() throws Exception {\n+        programmingExerciseTestService.copyRepository_testConflictError();\n+    }\n+\n+    @Test\n+    @WithMockUser(username = \"instructor1\", roles = \"INSTRUCTOR\")\n+    public void configureRepository_testBadRequestError() throws Exception {", "originalCommit": "21aaac3147d9580b62e55ea7e694dfa507995b36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "206ae9b6a9e0352ea4687424eb659caf25b4c029", "url": "https://github.com/ls1intum/Artemis/commit/206ae9b6a9e0352ea4687424eb659caf25b4c029", "message": "Merge branch 'develop' into chore/improve-test-coverage/improve-bitbucket-service", "committedDate": "2020-10-29T16:15:27Z", "type": "commit"}, {"oid": "d9b2ca1989c9fe059e1c2ee666eeb50105b77b4e", "url": "https://github.com/ls1intum/Artemis/commit/d9b2ca1989c9fe059e1c2ee666eeb50105b77b4e", "message": "Merge branch 'develop' into chore/improve-test-coverage/improve-bitbucket-service", "committedDate": "2020-10-29T19:09:02Z", "type": "commit"}, {"oid": "21ba63b9d1a794c2044375fc017ccc2bf09549bc", "url": "https://github.com/ls1intum/Artemis/commit/21ba63b9d1a794c2044375fc017ccc2bf09549bc", "message": "change to List", "committedDate": "2020-10-29T19:13:37Z", "type": "commit"}, {"oid": "e4e0d0ea7a90a405722bb0fe449bf64eb2a2d2a8", "url": "https://github.com/ls1intum/Artemis/commit/e4e0d0ea7a90a405722bb0fe449bf64eb2a2d2a8", "message": "change to List", "committedDate": "2020-10-29T19:16:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUwNjIwNg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514506206", "bodyText": "The codacy point here I believe is valid. If you make this method abstract you can ensure that it is not called accidentally while it is not implemented.", "author": "anditurdiu", "createdAt": "2020-10-29T19:17:14Z", "path": "src/test/java/de/tum/in/www1/artemis/AbstractSpringIntegrationJenkinsGitlabTest.java", "diffHunk": "@@ -89,7 +90,13 @@ public void mockConnectorRequestsForSetup(ProgrammingExercise exercise) throws E\n     }\n \n     @Override\n-    public List<Verifiable> mockConnectorRequestsForStartParticipation(ProgrammingExercise exercise, String username, Set<User> users) throws IOException, URISyntaxException {\n+    public void mockCopyRepositoryForParticipation(ProgrammingExercise exercise, String username, HttpStatus status) throws URISyntaxException, IOException {", "originalCommit": "d9b2ca1989c9fe059e1c2ee666eeb50105b77b4e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUxMDM4MA==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514510380", "bodyText": "This is intentional. This is a requirement by the interface that is implemented. This method has to be implemented later on, when we implement the tests for Jenkins", "author": "krusche", "createdAt": "2020-10-29T19:25:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUwNjIwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUwNjY2MQ==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514506661", "bodyText": "Same here: An empty method in an abstract class should be abstract instead", "author": "anditurdiu", "createdAt": "2020-10-29T19:18:10Z", "path": "src/test/java/de/tum/in/www1/artemis/AbstractSpringIntegrationJenkinsGitlabTest.java", "diffHunk": "@@ -89,7 +90,13 @@ public void mockConnectorRequestsForSetup(ProgrammingExercise exercise) throws E\n     }\n \n     @Override\n-    public List<Verifiable> mockConnectorRequestsForStartParticipation(ProgrammingExercise exercise, String username, Set<User> users) throws IOException, URISyntaxException {\n+    public void mockCopyRepositoryForParticipation(ProgrammingExercise exercise, String username, HttpStatus status) throws URISyntaxException, IOException {\n+        // TODO: implement\n+    }\n+\n+    @Override\n+    public List<Verifiable> mockConnectorRequestsForStartParticipation(ProgrammingExercise exercise, String username, Set<User> users, boolean ltiUserExists)\n+            throws IOException, URISyntaxException {", "originalCommit": "d9b2ca1989c9fe059e1c2ee666eeb50105b77b4e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUxMDQyOQ==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514510429", "bodyText": "This is intentional. This is a requirement by the interface that is implemented. This method has to be implemented later on, when we implement the tests for Jenkins", "author": "krusche", "createdAt": "2020-10-29T19:25:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUwNjY2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUwNzMzNg==", "url": "https://github.com/ls1intum/Artemis/pull/2247#discussion_r514507336", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (userPrefixEdx.isPresent() && loginName.startsWith(userPrefixEdx.get()) || userPrefixU4I.isPresent() && loginName.startsWith((userPrefixU4I.get()))) {\n          \n          \n            \n                            if (userPrefixEdx.isPresent() && loginName.startsWith(userPrefixEdx.get()) || userPrefixU4I.isPresent() && loginName.startsWith(userPrefixU4I.get())) {", "author": "anditurdiu", "createdAt": "2020-10-29T19:19:24Z", "path": "src/test/java/de/tum/in/www1/artemis/connector/bitbucket/BitbucketRequestMockProvider.java", "diffHunk": "@@ -146,24 +159,59 @@ public void mockGetBitbucketRepository(ProgrammingExercise exercise, String bitb\n                 .andRespond(withStatus(HttpStatus.OK).contentType(MediaType.APPLICATION_JSON).body(mapper.writeValueAsString(bitbucketRepository)));\n     }\n \n-    public void mockConfigureRepository(ProgrammingExercise exercise, String username, Set<User> users) throws URISyntaxException, IOException {\n+    public void mockConfigureRepository(ProgrammingExercise exercise, String username, Set<User> users, boolean ltiUserExists) throws URISyntaxException, IOException {\n         final var projectKey = exercise.getProjectKey();\n         final var repoName = projectKey.toLowerCase() + \"-\" + username.toLowerCase();\n         for (User user : users) {\n             if (exercise.hasCourse()) {\n-                mockGiveWritePermission(exercise, repoName, user.getLogin());\n+                // add mock for userExists() check, if the username contains edx_ or u4i_\n+                String loginName = user.getLogin();\n+                if (userPrefixEdx.isPresent() && loginName.startsWith(userPrefixEdx.get()) || userPrefixU4I.isPresent() && loginName.startsWith((userPrefixU4I.get()))) {", "originalCommit": "d9b2ca1989c9fe059e1c2ee666eeb50105b77b4e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fbf30cd87d737260b974631ecdda379b85773f2f", "url": "https://github.com/ls1intum/Artemis/commit/fbf30cd87d737260b974631ecdda379b85773f2f", "message": "remove unnecessary brackets", "committedDate": "2020-10-29T19:26:18Z", "type": "commit"}]}