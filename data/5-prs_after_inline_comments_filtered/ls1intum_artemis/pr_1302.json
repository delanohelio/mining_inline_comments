{"pr_number": 1302, "pr_title": "Import teams from source exercise", "pr_createdAt": "2020-04-08T23:05:29Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1302", "timeline": [{"oid": "e010dc9cb624f77e94d3d35e4393b6f33b6e36b4", "url": "https://github.com/ls1intum/Artemis/commit/e010dc9cb624f77e94d3d35e4393b6f33b6e36b4", "message": "Ease unique conditions for team short name (from globally unique to unique per exercise)", "committedDate": "2020-04-07T15:29:23Z", "type": "commit"}, {"oid": "1aefbe1b9c3c6bbbb6fe79862a817f6f02f8a0da", "url": "https://github.com/ls1intum/Artemis/commit/1aefbe1b9c3c6bbbb6fe79862a817f6f02f8a0da", "message": "Foundation for client side of importing teams from source exercise into destination exercise", "committedDate": "2020-04-07T17:06:32Z", "type": "commit"}, {"oid": "c687f3e6c990d036a6bb124f573227ccaa537bf3", "url": "https://github.com/ls1intum/Artemis/commit/c687f3e6c990d036a6bb124f573227ccaa537bf3", "message": "Don't offer current exercise as source exercise", "committedDate": "2020-04-07T18:19:58Z", "type": "commit"}, {"oid": "196e4ad56eb7e4b8a6f75f88cfeb0634c4d9536c", "url": "https://github.com/ls1intum/Artemis/commit/196e4ad56eb7e4b8a6f75f88cfeb0634c4d9536c", "message": "Polish client", "committedDate": "2020-04-07T20:17:29Z", "type": "commit"}, {"oid": "707fe6f1b19f0aa7a8b584385c82bf1b6dcb8aaa", "url": "https://github.com/ls1intum/Artemis/commit/707fe6f1b19f0aa7a8b584385c82bf1b6dcb8aaa", "message": "Merge remote-tracking branch 'origin/develop' into feature/import-teams-from-exercise", "committedDate": "2020-04-07T20:18:26Z", "type": "commit"}, {"oid": "7b96e367b3bcff73ab93f7d87663e4673fe2a6dc", "url": "https://github.com/ls1intum/Artemis/commit/7b96e367b3bcff73ab93f7d87663e4673fe2a6dc", "message": "Polish client", "committedDate": "2020-04-07T20:29:28Z", "type": "commit"}, {"oid": "a9d7a6185db9000ab3b06782a36e9bbc21ddfc94", "url": "https://github.com/ls1intum/Artemis/commit/a9d7a6185db9000ab3b06782a36e9bbc21ddfc94", "message": "Basic copy mechanism", "committedDate": "2020-04-07T21:19:17Z", "type": "commit"}, {"oid": "5d1dd9e022abbb24241c0eed2bf68d469faed938", "url": "https://github.com/ls1intum/Artemis/commit/5d1dd9e022abbb24241c0eed2bf68d469faed938", "message": "Return all teams of destination exercise", "committedDate": "2020-04-07T21:37:07Z", "type": "commit"}, {"oid": "be7c08778ef741ea88076c30baa8a5b790c58277", "url": "https://github.com/ls1intum/Artemis/commit/be7c08778ef741ea88076c30baa8a5b790c58277", "message": "Styling", "committedDate": "2020-04-08T09:56:02Z", "type": "commit"}, {"oid": "d92e3c41b071c7f5ebfc6f0b24f426c984fcd5a3", "url": "https://github.com/ls1intum/Artemis/commit/d92e3c41b071c7f5ebfc6f0b24f426c984fcd5a3", "message": "Conflict handling in client", "committedDate": "2020-04-08T15:55:55Z", "type": "commit"}, {"oid": "2520b7329087dcdbcee2c499a52ac78de80baa97", "url": "https://github.com/ls1intum/Artemis/commit/2520b7329087dcdbcee2c499a52ac78de80baa97", "message": "Delete confirmation modal", "committedDate": "2020-04-08T17:11:13Z", "type": "commit"}, {"oid": "a969b8f54a1b254f63b183b4da2af08f6467af74", "url": "https://github.com/ls1intum/Artemis/commit/a969b8f54a1b254f63b183b4da2af08f6467af74", "message": "Finish client side for now", "committedDate": "2020-04-08T17:35:40Z", "type": "commit"}, {"oid": "741642d39b1537da141091fb3de6587fc918a8bf", "url": "https://github.com/ls1intum/Artemis/commit/741642d39b1537da141091fb3de6587fc918a8bf", "message": "Team import server side", "committedDate": "2020-04-08T18:57:26Z", "type": "commit"}, {"oid": "6f699c43a1039d9e145d5aaf05362e60724a927c", "url": "https://github.com/ls1intum/Artemis/commit/6f699c43a1039d9e145d5aaf05362e60724a927c", "message": "Adapt client to import strategy request body", "committedDate": "2020-04-08T19:09:09Z", "type": "commit"}, {"oid": "ae22421afd654e4c66ccd579ef5184e9877533bb", "url": "https://github.com/ls1intum/Artemis/commit/ae22421afd654e4c66ccd579ef5184e9877533bb", "message": "Change dialog title", "committedDate": "2020-04-08T19:19:07Z", "type": "commit"}, {"oid": "56f38dd045fdd56a5df008f151c5345f5143c105", "url": "https://github.com/ls1intum/Artemis/commit/56f38dd045fdd56a5df008f151c5345f5143c105", "message": "Pass over import strategy correctly", "committedDate": "2020-04-08T19:58:31Z", "type": "commit"}, {"oid": "f6d9ae1b57d8e61deda3477802b8076fd2399a6b", "url": "https://github.com/ls1intum/Artemis/commit/f6d9ae1b57d8e61deda3477802b8076fd2399a6b", "message": "Database trigger that makes sure that no student is part of more than one team per exercise", "committedDate": "2020-04-08T21:56:06Z", "type": "commit"}, {"oid": "2111f2a318d7070993c66615c8bd4d36b5e212c5", "url": "https://github.com/ls1intum/Artemis/commit/2111f2a318d7070993c66615c8bd4d36b5e212c5", "message": "Merge branch 'develop' into feature/import-teams-from-exercise", "committedDate": "2020-04-08T23:41:06Z", "type": "commit"}, {"oid": "a481636ede4e6724a08b21a1c2c75736b0babf0c", "url": "https://github.com/ls1intum/Artemis/commit/a481636ede4e6724a08b21a1c2c75736b0babf0c", "message": "Merge branch 'develop' into feature/import-teams-from-exercise", "committedDate": "2020-04-12T10:33:05Z", "type": "commit"}, {"oid": "d899fc8f166e76a1cb21a315404c12b6864c36d0", "url": "https://github.com/ls1intum/Artemis/commit/d899fc8f166e76a1cb21a315404c12b6864c36d0", "message": "Legend", "committedDate": "2020-04-12T12:31:51Z", "type": "commit"}, {"oid": "17827f8c9d8a595222b0a2f5af4afe43882a304f", "url": "https://github.com/ls1intum/Artemis/commit/17827f8c9d8a595222b0a2f5af4afe43882a304f", "message": "Intro text", "committedDate": "2020-04-12T13:19:23Z", "type": "commit"}, {"oid": "4d2af9feb2f04602cd33821c0721a78ec669e5c8", "url": "https://github.com/ls1intum/Artemis/commit/4d2af9feb2f04602cd33821c0721a78ec669e5c8", "message": "More explicit into text", "committedDate": "2020-04-12T13:29:32Z", "type": "commit"}, {"oid": "8a7964950ac6283c22d10906a595589d3763762a", "url": "https://github.com/ls1intum/Artemis/commit/8a7964950ac6283c22d10906a595589d3763762a", "message": "Fix build", "committedDate": "2020-04-12T13:47:24Z", "type": "commit"}, {"oid": "b50e883a14410bbb19a64c6cb34fd1b114724a3e", "url": "https://github.com/ls1intum/Artemis/commit/b50e883a14410bbb19a64c6cb34fd1b114724a3e", "message": "Add client docs", "committedDate": "2020-04-12T15:30:21Z", "type": "commit"}, {"oid": "09f6626c20117500fe4b8055cc7bfe006eda31a0", "url": "https://github.com/ls1intum/Artemis/commit/09f6626c20117500fe4b8055cc7bfe006eda31a0", "message": "Add server docs", "committedDate": "2020-04-12T15:38:53Z", "type": "commit"}, {"oid": "b4f28ddee8fe7c09629105fa4a216b5ac3ab6982", "url": "https://github.com/ls1intum/Artemis/commit/b4f28ddee8fe7c09629105fa4a216b5ac3ab6982", "message": "Integration Test", "committedDate": "2020-04-12T17:24:49Z", "type": "commit"}, {"oid": "cee60404b9e205ecad1e91ddbc0a004c4baa61b4", "url": "https://github.com/ls1intum/Artemis/commit/cee60404b9e205ecad1e91ddbc0a004c4baa61b4", "message": "Integration Test", "committedDate": "2020-04-12T17:54:03Z", "type": "commit"}, {"oid": "1812aed1a51f0201de584ef9c181515e6a532c63", "url": "https://github.com/ls1intum/Artemis/commit/1812aed1a51f0201de584ef9c181515e6a532c63", "message": "Merge branch 'develop' into feature/import-teams-from-exercise", "committedDate": "2020-04-12T18:32:23Z", "type": "commit"}, {"oid": "224e776ff4b8e2036cb93d4d5992ac952957899a", "url": "https://github.com/ls1intum/Artemis/commit/224e776ff4b8e2036cb93d4d5992ac952957899a", "message": "Loading state display", "committedDate": "2020-04-12T18:46:08Z", "type": "commit"}, {"oid": "613165595e779b0912fdd66804e1a8f19d97bd39", "url": "https://github.com/ls1intum/Artemis/commit/613165595e779b0912fdd66804e1a8f19d97bd39", "message": "Handling when there are no other team-based exercises in the course", "committedDate": "2020-04-12T19:32:39Z", "type": "commit"}, {"oid": "1633447ba9bc81ec38772fb4d0b17841b62aeb86", "url": "https://github.com/ls1intum/Artemis/commit/1633447ba9bc81ec38772fb4d0b17841b62aeb86", "message": "Missing translation\n\nCo-Authored-By: Filip Gregurevic <51987021+filip-gregurevic@users.noreply.github.com>", "committedDate": "2020-04-13T09:32:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ3ODc3NQ==", "url": "https://github.com/ls1intum/Artemis/pull/1302#discussion_r407478775", "bodyText": "Small typo\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Imports all team of the source exercise into the destination exercise\n          \n          \n            \n                 * Imports all teams of the source exercise into the destination exercise", "author": "sleiss", "createdAt": "2020-04-13T13:30:31Z", "path": "src/main/java/de/tum/in/www1/artemis/service/team/strategies/PurgeExistingStrategy.java", "diffHunk": "@@ -0,0 +1,42 @@\n+package de.tum.in.www1.artemis.service.team.strategies;\n+\n+import java.util.List;\n+\n+import de.tum.in.www1.artemis.domain.Exercise;\n+import de.tum.in.www1.artemis.domain.Team;\n+import de.tum.in.www1.artemis.repository.TeamRepository;\n+import de.tum.in.www1.artemis.service.ParticipationService;\n+import de.tum.in.www1.artemis.service.team.TeamImportStrategy;\n+\n+public class PurgeExistingStrategy extends TeamImportStrategy {\n+\n+    private final ParticipationService participationService;\n+\n+    public PurgeExistingStrategy(TeamRepository teamRepository, ParticipationService participationService) {\n+        super(teamRepository);\n+\n+        this.participationService = participationService;\n+    }\n+\n+    /**\n+     * Imports all team of the source exercise into the destination exercise", "originalCommit": "1633447ba9bc81ec38772fb4d0b17841b62aeb86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ3OTc3MQ==", "url": "https://github.com/ls1intum/Artemis/pull/1302#discussion_r407479771", "bodyText": "There is no check in place here, that the TA/Instructor is TA/Instructor of that given course, right?\nE.g.\n        if (!authCheckService.isAtLeastInstructorForExercise(destinationExercise, user)) {\n            return forbidden();\n        }", "author": "sleiss", "createdAt": "2020-04-13T13:32:54Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/TeamResource.java", "diffHunk": "@@ -238,16 +239,17 @@ public TeamResource(TeamRepository teamRepository, TeamService teamService, Cour\n     }\n \n     /**\n-     * GET /teams?shortName={shortName} : get boolean flag whether team with shortName exists\n+     * GET /exercises/{exerciseId}/teams/exists?shortName={shortName} : get boolean flag whether team with shortName exists for exercise\n      *\n+     * @param exerciseId the id of the exercise for which to check teams\n      * @param shortName the shortName of the team to check for existence\n      * @return Response with status 200 (OK) and boolean flag in the body\n      */\n-    @GetMapping(\"/teams\") // this check is independent of the exercise (a team's shortName serves as a globally unique identifier)\n+    @GetMapping(\"/exercises/{exerciseId}/teams/exists\")\n     @PreAuthorize(\"hasAnyRole('TA', 'INSTRUCTOR', 'ADMIN')\")\n-    public ResponseEntity<Boolean> existsTeamByShortName(@RequestParam(\"shortName\") String shortName) {\n-        log.debug(\"REST request to check Team existence by shortName : {}\", shortName);\n-        return ResponseEntity.ok().body(teamRepository.findOneByShortName(shortName).isPresent());\n+    public ResponseEntity<Boolean> existsTeamByShortName(@PathVariable long exerciseId, @RequestParam(\"shortName\") String shortName) {", "originalCommit": "1633447ba9bc81ec38772fb4d0b17841b62aeb86", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzUyNzY3Ng==", "url": "https://github.com/ls1intum/Artemis/pull/1302#discussion_r407527676", "bodyText": "Good finding! The reason why this check was not there previously was that this was a global existence query that returned whether this team short name exists among all exercises. But now that we have eased the unique constraint and the check has become exercise-specific, we can indeed add the authority check you proposed (but use isAtLeastTeachingAssistantForExercise since TAs are also allowed to use it).", "author": "madwau", "createdAt": "2020-04-13T15:08:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ3OTc3MQ=="}], "type": "inlineReview"}, {"oid": "fb6b7ff1a03e7c468a5d17f94364acf1d3247cb3", "url": "https://github.com/ls1intum/Artemis/commit/fb6b7ff1a03e7c468a5d17f94364acf1d3247cb3", "message": "Typo\n\nCo-Authored-By: Simon Lei\u00df <5084100+sleiss@users.noreply.github.com>", "committedDate": "2020-04-13T15:03:36Z", "type": "commit"}, {"oid": "a9d1338f3312b6715b3ab0b523559823d3ff45b0", "url": "https://github.com/ls1intum/Artemis/commit/a9d1338f3312b6715b3ab0b523559823d3ff45b0", "message": "Add auth check", "committedDate": "2020-04-13T15:15:50Z", "type": "commit"}, {"oid": "1f57e9be5e1992f4607613e663e9296ac8fec0c9", "url": "https://github.com/ls1intum/Artemis/commit/1f57e9be5e1992f4607613e663e9296ac8fec0c9", "message": "Add \"of this course\"", "committedDate": "2020-04-13T15:18:21Z", "type": "commit"}, {"oid": "eaa087bda9fdffe46da5f72a7e7c0c76f837df8d", "url": "https://github.com/ls1intum/Artemis/commit/eaa087bda9fdffe46da5f72a7e7c0c76f837df8d", "message": "Merge remote-tracking branch 'origin/develop' into feature/import-teams-from-exercise\n\n# Conflicts:\n#\tsrc/main/resources/config/liquibase/master.xml", "committedDate": "2020-04-13T15:54:17Z", "type": "commit"}, {"oid": "2629a4d7300f9ec4647adee06445fbbc36ce1d30", "url": "https://github.com/ls1intum/Artemis/commit/2629a4d7300f9ec4647adee06445fbbc36ce1d30", "message": "Merge remote-tracking branch 'origin/develop' into feature/import-teams-from-exercise\n\n# Conflicts:\n#\tsrc/main/webapp/app/exercises/shared/team/team.module.ts", "committedDate": "2020-04-16T09:10:17Z", "type": "commit"}]}