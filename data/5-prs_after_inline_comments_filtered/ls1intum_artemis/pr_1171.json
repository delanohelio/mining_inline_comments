{"pr_number": 1171, "pr_title": "show number of open Complaints for Exercises in Tutor dashboard", "pr_createdAt": "2020-01-06T22:07:43Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1171", "timeline": [{"oid": "cab4614d23424a3f8df39d9ad4bbbd08c934f3c5", "url": "https://github.com/ls1intum/Artemis/commit/cab4614d23424a3f8df39d9ad4bbbd08c934f3c5", "message": "add numberOfOpenComplaints", "committedDate": "2020-01-06T22:01:50Z", "type": "commit"}, {"oid": "3e10b4693177335eb221d01f3c21703ce2b4c291", "url": "https://github.com/ls1intum/Artemis/commit/3e10b4693177335eb221d01f3c21703ce2b4c291", "message": "fix java code style", "committedDate": "2020-01-06T22:12:46Z", "type": "commit"}, {"oid": "42e4b28bce05b3cc9fd1113d51d55ddb40f41136", "url": "https://github.com/ls1intum/Artemis/commit/42e4b28bce05b3cc9fd1113d51d55ddb40f41136", "message": "Merge branch 'develop' into feature/tutor-dashboard/show-open-complaints", "committedDate": "2020-01-07T08:52:04Z", "type": "commit"}, {"oid": "db6c727eca4b9386c8ef7afee96cb555c68bde1e", "url": "https://github.com/ls1intum/Artemis/commit/db6c727eca4b9386c8ef7afee96cb555c68bde1e", "message": "comment out redundant assert as it is now allowed to show open complaints for tutors", "committedDate": "2020-01-07T09:22:08Z", "type": "commit"}, {"oid": "838dd5a67989cb3618e601333d678ce9a1741f91", "url": "https://github.com/ls1intum/Artemis/commit/838dd5a67989cb3618e601333d678ce9a1741f91", "message": "UI adjustments of the tutor-participation-graph and logic adjustments of the show finished exercises filter after discussions with Stephan", "committedDate": "2020-01-11T13:51:12Z", "type": "commit"}, {"oid": "f0025c183d8dce677ccc1cb3f48c9e8b673ca835", "url": "https://github.com/ls1intum/Artemis/commit/f0025c183d8dce677ccc1cb3f48c9e8b673ca835", "message": "adjust tooltip text", "committedDate": "2020-01-11T13:56:59Z", "type": "commit"}, {"oid": "f5fa6144b8941e404fb67b26ca5da5a31ddba3d8", "url": "https://github.com/ls1intum/Artemis/commit/f5fa6144b8941e404fb67b26ca5da5a31ddba3d8", "message": "merge develop and adjust test cases in ExerciseIntegrationTest", "committedDate": "2020-01-11T14:20:16Z", "type": "commit"}, {"oid": "da2a683b6eb8ed004e911364d66f4ee6a5098861", "url": "https://github.com/ls1intum/Artemis/commit/da2a683b6eb8ed004e911364d66f4ee6a5098861", "message": "code clean up", "committedDate": "2020-01-11T15:39:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5Mjc4Mw==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r365592783", "bodyText": "Magic \u2728", "author": "ungaralex", "createdAt": "2020-01-12T15:59:35Z", "path": "src/main/java/de/tum/in/www1/artemis/repository/ComplaintResponseRepository.java", "diffHunk": "@@ -25,6 +26,15 @@\n      */\n     long countByComplaint_Result_Participation_Exercise_Course_Id_AndComplaint_ComplaintType(Long courseId, ComplaintType complaintType);\n \n+    /**\n+     * This magic method counts the number of complaints responses by complaint type associated to a exercise id", "originalCommit": "da2a683b6eb8ed004e911364d66f4ee6a5098861", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5Mjc5OA==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r365592798", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                long countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(@Param(\"id\") Long exerciseId, ComplaintType complaintType);\n          \n          \n            \n                long countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(@Param(\"id\") long exerciseId, ComplaintType complaintType);", "author": "ungaralex", "createdAt": "2020-01-12T15:59:53Z", "path": "src/main/java/de/tum/in/www1/artemis/repository/ComplaintResponseRepository.java", "diffHunk": "@@ -25,6 +26,15 @@\n      */\n     long countByComplaint_Result_Participation_Exercise_Course_Id_AndComplaint_ComplaintType(Long courseId, ComplaintType complaintType);\n \n+    /**\n+     * This magic method counts the number of complaints responses by complaint type associated to a exercise id\n+     *\n+     * @param exerciseId      - the id of the exercise we want to filter by\n+     * @param complaintType - complaint type we want to filter by\n+     * @return number of complaints response associated to exercise exerciseId\n+     */\n+    long countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(@Param(\"id\") Long exerciseId, ComplaintType complaintType);", "originalCommit": "da2a683b6eb8ed004e911364d66f4ee6a5098861", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5Mjk2Ng==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r365592966", "bodyText": "This method already is too big imo. I also think we should move most of the code here into the CourseService, as logic like this should not be in a resource. Could you please start by just moving your code there? You also have some code duplication here, so you can just use the same method twice with a parameter ComplaintType complaintType.\nIn fact, I would move the complaint related requests to the complaint service", "author": "ungaralex", "createdAt": "2020-01-12T16:02:58Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/CourseResource.java", "diffHunk": "@@ -376,6 +376,20 @@ else if (exercise instanceof ProgrammingExercise) {\n \n             long numberOfAssessments = resultService.countNumberOfFinishedAssessmentsForExercise(exercise.getId());\n \n+            long numberOfComplaints = complaintRepository.countByResult_Participation_Exercise_IdAndComplaintType(exercise.getId(), ComplaintType.COMPLAINT);\n+            long numberOfComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exercise.getId(),\n+                    ComplaintType.COMPLAINT);\n+            // TODO: Hanya, maybe complaints about your own assessment (numberOfTutorComplaints) should be taken into consideration\n+            exercise.setNumberOfOpenComplaints(numberOfComplaints - numberOfComplaintResponses);\n+            exercise.setNumberOfComplaints(numberOfComplaints);\n+\n+            long numberOfMoreFeedbackRequests = complaintRepository.countByResult_Participation_Exercise_IdAndComplaintType(exercise.getId(), ComplaintType.MORE_FEEDBACK);\n+            long numberOfMoreFeedbackComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exercise.getId(),\n+                    ComplaintType.MORE_FEEDBACK);\n+            // TODO: Hanya, maybe feedback about your own assessment (numberOfTutorMoreFeedbackRequests) should be taken into consideration\n+            exercise.setNumberOfOpenMoreFeedbackRequests(numberOfMoreFeedbackRequests - numberOfMoreFeedbackComplaintResponses);\n+            exercise.setNumberOfMoreFeedbackRequests(numberOfMoreFeedbackRequests);\n+", "originalCommit": "da2a683b6eb8ed004e911364d66f4ee6a5098861", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMjg4Ng==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r365822886", "bodyText": "@maxr96 I just saw now that you are also refactoring CourseResource in #1149 . Is it ok if I apply these changes suggested by @ungaralex  here or would this be conflicting with the changes you had in mind for your PR?", "author": "HanyaElhashemy", "createdAt": "2020-01-13T14:10:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5Mjk2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE4MjIyMg==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r366182222", "bodyText": "@HanyaElhashemy no this will not conflict my changes. You can apply them here or we can also discuss this after developers meeting.", "author": "maxr96", "createdAt": "2020-01-14T07:21:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5Mjk2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5MzA5OQ==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r365593099", "bodyText": "I agree, we should ignore complaints related to the tutor's assessment and subtract them from the overall number", "author": "ungaralex", "createdAt": "2020-01-12T16:04:12Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/CourseResource.java", "diffHunk": "@@ -376,6 +376,20 @@ else if (exercise instanceof ProgrammingExercise) {\n \n             long numberOfAssessments = resultService.countNumberOfFinishedAssessmentsForExercise(exercise.getId());\n \n+            long numberOfComplaints = complaintRepository.countByResult_Participation_Exercise_IdAndComplaintType(exercise.getId(), ComplaintType.COMPLAINT);\n+            long numberOfComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exercise.getId(),\n+                    ComplaintType.COMPLAINT);\n+            // TODO: Hanya, maybe complaints about your own assessment (numberOfTutorComplaints) should be taken into consideration", "originalCommit": "da2a683b6eb8ed004e911364d66f4ee6a5098861", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY4NDIxOQ==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r365684219", "bodyText": "The only reason I did not add the property numberOfTutorComplaints to the subtraction in stats.setNumberOfOpenComplaints yet and left the comment in the code instead is because numberOfTutorComplaints is currently a bit buggy and will be fixed in #1143", "author": "HanyaElhashemy", "createdAt": "2020-01-13T08:30:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5MzA5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAyNDg1NQ==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r366024855", "bodyText": "Aren't you two contradicting each other? Alex wants to exclude the complaints of the tutor himself and Hanya wants to include it. Or am I misunderstanding something?\nI guess if the tutor should not know if there are any complaints about his assessments (or how many), it makes sense to exclude those.", "author": "madwau", "createdAt": "2020-01-13T20:59:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5MzA5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjMxODkzOA==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r366318938", "bodyText": "As discussed before the meeting, we both actually mean the same thing but I guess my Todo was a bit unclear, I will rephrase it. And I also suggest that the property numberOfTutorComplaints should be renamed to nrOfComplaintsAboutOwnAssessment in #1143 to avoid any misunderstanding", "author": "HanyaElhashemy", "createdAt": "2020-01-14T12:48:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5MzA5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5MzE2Mg==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r365593162", "bodyText": "Same comment as for the CourseResource", "author": "ungaralex", "createdAt": "2020-01-12T16:05:13Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ExerciseResource.java", "diffHunk": "@@ -213,6 +218,16 @@ else if (exercise instanceof ProgrammingExercise) {\n         Long numberOfComplaints = complaintRepository.countByResult_Participation_Exercise_IdAndComplaintType(exerciseId, ComplaintType.COMPLAINT);\n         stats.setNumberOfComplaints(numberOfComplaints);\n \n+        long numberOfComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exerciseId,\n+                ComplaintType.COMPLAINT);\n+        // TODO: Hanya, maybe complaints about your own assessment (numberOfTutorComplaints) should be taken into consideration\n+        stats.setNumberOfOpenComplaints(numberOfComplaints - numberOfComplaintResponses);\n+\n+        long numberOfMoreFeedbackComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exerciseId,\n+                ComplaintType.MORE_FEEDBACK);\n+        // TODO: Hanya, maybe feedback about your own assessment (numberOfTutorMoreFeedbackRequests) should be taken into consideration\n+        stats.setNumberOfOpenMoreFeedbackRequests(numberOfMoreFeedbackRequests - numberOfMoreFeedbackComplaintResponses);\n+", "originalCommit": "da2a683b6eb8ed004e911364d66f4ee6a5098861", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8d55332d7d75ffb07eb89449ef4cbc99074de0f2", "url": "https://github.com/ls1intum/Artemis/commit/8d55332d7d75ffb07eb89449ef4cbc99074de0f2", "message": "remove code duplications from tutor-participation-graph", "committedDate": "2020-01-13T09:02:24Z", "type": "commit"}, {"oid": "696a87e92493ffe96f3e217c8de23ee1f3d0d4b6", "url": "https://github.com/ls1intum/Artemis/commit/696a87e92493ffe96f3e217c8de23ee1f3d0d4b6", "message": "add new component: progress-bar to avoid code duplication", "committedDate": "2020-01-13T16:26:45Z", "type": "commit"}, {"oid": "11efbb22b8fc31a002bb3f30970c671ad6d07c46", "url": "https://github.com/ls1intum/Artemis/commit/11efbb22b8fc31a002bb3f30970c671ad6d07c46", "message": "fix client tests", "committedDate": "2020-01-13T18:01:37Z", "type": "commit"}, {"oid": "4f4b0c6d21a1a84afeb7a7d6235c5b260b1c3663", "url": "https://github.com/ls1intum/Artemis/commit/4f4b0c6d21a1a84afeb7a7d6235c5b260b1c3663", "message": "Merge branch 'develop' into feature/tutor-dashboard/show-open-complaints", "committedDate": "2020-01-13T19:27:52Z", "type": "commit"}, {"oid": "354c4048e1b71df68b54eb6319726850fca4827b", "url": "https://github.com/ls1intum/Artemis/commit/354c4048e1b71df68b54eb6319726850fca4827b", "message": "fix tooltip", "committedDate": "2020-01-13T22:15:30Z", "type": "commit"}, {"oid": "8c2cc68b8f26c4674c7e3a734107f2a427f10fdc", "url": "https://github.com/ls1intum/Artemis/commit/8c2cc68b8f26c4674c7e3a734107f2a427f10fdc", "message": "Merge branch 'develop' into feature/tutor-dashboard/show-open-complaints", "committedDate": "2020-01-14T12:51:22Z", "type": "commit"}, {"oid": "54cc819f7358aaa8d58cc5ece3b077d34d5b110d", "url": "https://github.com/ls1intum/Artemis/commit/54cc819f7358aaa8d58cc5ece3b077d34d5b110d", "message": "rephrase todo to avoid any misunderstanding", "committedDate": "2020-01-14T13:03:03Z", "type": "commit"}, {"oid": "9098c2753ae3807187d8cbf6100b72690a111267", "url": "https://github.com/ls1intum/Artemis/commit/9098c2753ae3807187d8cbf6100b72690a111267", "message": "refactor courseResource", "committedDate": "2020-01-14T13:45:23Z", "type": "commit"}, {"oid": "ec6adf662f934608184bc42d1eda5d903dffabdd", "url": "https://github.com/ls1intum/Artemis/commit/ec6adf662f934608184bc42d1eda5d903dffabdd", "message": "fix java code style", "committedDate": "2020-01-14T13:47:12Z", "type": "commit"}, {"oid": "42d0399c83fda5c8f1bf6a688bf3d539058f1a70", "url": "https://github.com/ls1intum/Artemis/commit/42d0399c83fda5c8f1bf6a688bf3d539058f1a70", "message": "server code refactorings", "committedDate": "2020-01-14T14:17:47Z", "type": "commit"}, {"oid": "e202da0766ac89ebb79a29b5906da04457b5ebc7", "url": "https://github.com/ls1intum/Artemis/commit/e202da0766ac89ebb79a29b5906da04457b5ebc7", "message": "Revert \"server code refactorings\"\n\nThis reverts commit 42d0399c", "committedDate": "2020-01-14T14:41:02Z", "type": "commit"}, {"oid": "99daa0685511371fb39dc5a707fe39cd6e2735c1", "url": "https://github.com/ls1intum/Artemis/commit/99daa0685511371fb39dc5a707fe39cd6e2735c1", "message": "fix refactorings server side", "committedDate": "2020-01-14T15:46:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzQ1NDA0Mg==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r367454042", "bodyText": "Do we need the ComplaintRepository and ComplaintResponseRepository here since it is not used?", "author": "lovaiible", "createdAt": "2020-01-16T14:40:39Z", "path": "src/main/java/de/tum/in/www1/artemis/service/CourseService.java", "diffHunk": "@@ -33,16 +35,22 @@\n \n     private final ExerciseService exerciseService;\n \n+    private final ComplaintRepository complaintRepository;\n+\n+    private final ComplaintResponseRepository complaintResponseRepository;\n+\n     private final AuthorizationCheckService authCheckService;\n \n     private final UserRepository userRepository;\n \n     private final LectureService lectureService;\n \n-    public CourseService(CourseRepository courseRepository, ExerciseService exerciseService, AuthorizationCheckService authCheckService, UserRepository userRepository,\n-            LectureService lectureService) {\n+    public CourseService(CourseRepository courseRepository, ExerciseService exerciseService, ComplaintRepository complaintRepository,\n+            ComplaintResponseRepository complaintResponseRepository, AuthorizationCheckService authCheckService, UserRepository userRepository, LectureService lectureService) {\n         this.courseRepository = courseRepository;\n         this.exerciseService = exerciseService;\n+        this.complaintRepository = complaintRepository;\n+        this.complaintResponseRepository = complaintResponseRepository;", "originalCommit": "99daa0685511371fb39dc5a707fe39cd6e2735c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzQ1NDkyMQ==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r367454921", "bodyText": "Can you add some JavaDoc for this method?", "author": "lovaiible", "createdAt": "2020-01-16T14:42:05Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ExerciseService.java", "diffHunk": "@@ -304,4 +314,21 @@ public void logDeletion(Exercise exercise, Course course, User user) {\n         auditEventRepository.add(auditEvent);\n         log.info(\"User \" + user.getLogin() + \" has requested to delete {} {} with id {}\", exercise.getClass().getSimpleName(), exercise.getTitle(), exercise.getId());\n     }\n+\n+    public void calculateNrOfOpenComplaints(Exercise exercise) {", "originalCommit": "99daa0685511371fb39dc5a707fe39cd6e2735c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0b8d0f303f4543fe62bb4e3d686f530eb11eee00", "url": "https://github.com/ls1intum/Artemis/commit/0b8d0f303f4543fe62bb4e3d686f530eb11eee00", "message": "Merge branch 'develop' into feature/tutor-dashboard/show-open-complaints", "committedDate": "2020-01-16T15:57:56Z", "type": "commit"}, {"oid": "95ea0983b25fef149c9fb5e5e4efcf18a393567a", "url": "https://github.com/ls1intum/Artemis/commit/95ea0983b25fef149c9fb5e5e4efcf18a393567a", "message": "code refactoring", "committedDate": "2020-01-16T16:10:00Z", "type": "commit"}, {"oid": "b0d95bf0600ed364ef3f8078c43ee13490d8f673", "url": "https://github.com/ls1intum/Artemis/commit/b0d95bf0600ed364ef3f8078c43ee13490d8f673", "message": "fix java code style", "committedDate": "2020-01-16T16:16:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTIxNzM4Mw==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r369217383", "bodyText": "as discussed, please remove the TODO", "author": "krusche", "createdAt": "2020-01-21T20:08:12Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ExerciseService.java", "diffHunk": "@@ -304,4 +314,26 @@ public void logDeletion(Exercise exercise, Course course, User user) {\n         auditEventRepository.add(auditEvent);\n         log.info(\"User \" + user.getLogin() + \" has requested to delete {} {} with id {}\", exercise.getClass().getSimpleName(), exercise.getTitle(), exercise.getId());\n     }\n+\n+    /**\n+     * Calculates the number of unevaluated complaints and feedback requests for tutor dashboard participation graph\n+     *\n+     * @param exercise the exercise for which the number of unevaluated complaints should be calculated\n+     */\n+    public void calculateNrOfOpenComplaints(Exercise exercise) {\n+\n+        long numberOfComplaints = complaintRepository.countByResult_Participation_Exercise_IdAndComplaintType(exercise.getId(), ComplaintType.COMPLAINT);\n+        long numberOfComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exercise.getId(),\n+                ComplaintType.COMPLAINT);\n+        // TODO: Hanya, subtract nr of open (unevaluated) complaints about your own assessment from nrOfOpenComplaints", "originalCommit": "b0d95bf0600ed364ef3f8078c43ee13490d8f673", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTIxNzQwMw==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r369217403", "bodyText": "as discussed, please remove the TODO", "author": "krusche", "createdAt": "2020-01-21T20:08:15Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ExerciseService.java", "diffHunk": "@@ -304,4 +314,26 @@ public void logDeletion(Exercise exercise, Course course, User user) {\n         auditEventRepository.add(auditEvent);\n         log.info(\"User \" + user.getLogin() + \" has requested to delete {} {} with id {}\", exercise.getClass().getSimpleName(), exercise.getTitle(), exercise.getId());\n     }\n+\n+    /**\n+     * Calculates the number of unevaluated complaints and feedback requests for tutor dashboard participation graph\n+     *\n+     * @param exercise the exercise for which the number of unevaluated complaints should be calculated\n+     */\n+    public void calculateNrOfOpenComplaints(Exercise exercise) {\n+\n+        long numberOfComplaints = complaintRepository.countByResult_Participation_Exercise_IdAndComplaintType(exercise.getId(), ComplaintType.COMPLAINT);\n+        long numberOfComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exercise.getId(),\n+                ComplaintType.COMPLAINT);\n+        // TODO: Hanya, subtract nr of open (unevaluated) complaints about your own assessment from nrOfOpenComplaints\n+        exercise.setNumberOfOpenComplaints(numberOfComplaints - numberOfComplaintResponses);\n+        exercise.setNumberOfComplaints(numberOfComplaints);\n+\n+        long numberOfMoreFeedbackRequests = complaintRepository.countByResult_Participation_Exercise_IdAndComplaintType(exercise.getId(), ComplaintType.MORE_FEEDBACK);\n+        long numberOfMoreFeedbackComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exercise.getId(),\n+                ComplaintType.MORE_FEEDBACK);\n+        // TODO: Hanya, subtract nr of open (unevaluated) feedback requests about your own assessment from nrOfOpenFeedbackRequests", "originalCommit": "b0d95bf0600ed364ef3f8078c43ee13490d8f673", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTIxNzUzMg==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r369217532", "bodyText": "as discussed, please remove the TODO", "author": "krusche", "createdAt": "2020-01-21T20:08:31Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ExerciseResource.java", "diffHunk": "@@ -213,6 +218,16 @@ else if (exercise instanceof ProgrammingExercise) {\n         Long numberOfComplaints = complaintRepository.countByResult_Participation_Exercise_IdAndComplaintType(exerciseId, ComplaintType.COMPLAINT);\n         stats.setNumberOfComplaints(numberOfComplaints);\n \n+        long numberOfComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exerciseId,\n+                ComplaintType.COMPLAINT);\n+        // TODO: Hanya, subtract nr of open (unevaluated) complaints about your own assessment from nrOfOpenComplaints", "originalCommit": "b0d95bf0600ed364ef3f8078c43ee13490d8f673", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTIxNzU3Mw==", "url": "https://github.com/ls1intum/Artemis/pull/1171#discussion_r369217573", "bodyText": "as discussed, please remove the TODO", "author": "krusche", "createdAt": "2020-01-21T20:08:36Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ExerciseResource.java", "diffHunk": "@@ -213,6 +218,16 @@ else if (exercise instanceof ProgrammingExercise) {\n         Long numberOfComplaints = complaintRepository.countByResult_Participation_Exercise_IdAndComplaintType(exerciseId, ComplaintType.COMPLAINT);\n         stats.setNumberOfComplaints(numberOfComplaints);\n \n+        long numberOfComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exerciseId,\n+                ComplaintType.COMPLAINT);\n+        // TODO: Hanya, subtract nr of open (unevaluated) complaints about your own assessment from nrOfOpenComplaints\n+        stats.setNumberOfOpenComplaints(numberOfComplaints - numberOfComplaintResponses);\n+\n+        long numberOfMoreFeedbackComplaintResponses = complaintResponseRepository.countByComplaint_Result_Participation_Exercise_Id_AndComplaint_ComplaintType(exerciseId,\n+                ComplaintType.MORE_FEEDBACK);\n+        // TODO: Hanya, subtract nr of open (unevaluated) feedback requests about your own assessment from nrOfOpenMoreFeedbackRequests", "originalCommit": "b0d95bf0600ed364ef3f8078c43ee13490d8f673", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "90137c03f178735b2bcbc04c7d91a1484d86446a", "url": "https://github.com/ls1intum/Artemis/commit/90137c03f178735b2bcbc04c7d91a1484d86446a", "message": "remove TODOs as discussed", "committedDate": "2020-01-21T20:49:36Z", "type": "commit"}, {"oid": "d1149c20ce104418e975851abfd9d70b42892477", "url": "https://github.com/ls1intum/Artemis/commit/d1149c20ce104418e975851abfd9d70b42892477", "message": "Merge branch 'develop' into feature/tutor-dashboard/show-open-complaints", "committedDate": "2020-01-21T20:53:24Z", "type": "commit"}, {"oid": "7142ec7e2223d4a2f6ab8ad270f70319f91ccffa", "url": "https://github.com/ls1intum/Artemis/commit/7142ec7e2223d4a2f6ab8ad270f70319f91ccffa", "message": "inform user why no complaints are displayed", "committedDate": "2020-01-21T22:05:22Z", "type": "commit"}, {"oid": "31cf9a0f45d88f53859d61d53a3f77ed32de36b9", "url": "https://github.com/ls1intum/Artemis/commit/31cf9a0f45d88f53859d61d53a3f77ed32de36b9", "message": "Update src/main/webapp/i18n/de/tutorExerciseDashboard.json\n\nCo-Authored-By: Stephan Krusche <krusche@in.tum.de>", "committedDate": "2020-01-21T22:28:32Z", "type": "commit"}, {"oid": "842e69fa0b5fec1096387c3dac07a42f9ed20dcb", "url": "https://github.com/ls1intum/Artemis/commit/842e69fa0b5fec1096387c3dac07a42f9ed20dcb", "message": "Update src/main/webapp/i18n/de/tutorExerciseDashboard.json\n\nCo-Authored-By: Stephan Krusche <krusche@in.tum.de>", "committedDate": "2020-01-21T22:29:01Z", "type": "commit"}, {"oid": "8236204ff141fb0eba15ba5a09d173224945de7e", "url": "https://github.com/ls1intum/Artemis/commit/8236204ff141fb0eba15ba5a09d173224945de7e", "message": "Update src/main/webapp/i18n/en/tutorExerciseDashboard.json\n\nCo-Authored-By: Stephan Krusche <krusche@in.tum.de>", "committedDate": "2020-01-21T22:29:23Z", "type": "commit"}, {"oid": "64a6978a39d832ea1347f2d68b6477579fdda7aa", "url": "https://github.com/ls1intum/Artemis/commit/64a6978a39d832ea1347f2d68b6477579fdda7aa", "message": "Update src/main/webapp/i18n/en/tutorExerciseDashboard.json\n\nCo-Authored-By: Stephan Krusche <krusche@in.tum.de>", "committedDate": "2020-01-21T22:29:47Z", "type": "commit"}, {"oid": "cd11517556892c1e909f7eeba8cd0c79b2a6c073", "url": "https://github.com/ls1intum/Artemis/commit/cd11517556892c1e909f7eeba8cd0c79b2a6c073", "message": "Update src/main/webapp/app/tutor-exercise-dashboard/tutor-exercise-dashboard.component.html\n\nCo-Authored-By: Stephan Krusche <krusche@in.tum.de>", "committedDate": "2020-01-21T22:33:58Z", "type": "commit"}, {"oid": "c5db7f251b19775b1c0e2293465bd5756194e9b8", "url": "https://github.com/ls1intum/Artemis/commit/c5db7f251b19775b1c0e2293465bd5756194e9b8", "message": "Update src/main/webapp/app/tutor-exercise-dashboard/tutor-exercise-dashboard.component.html\n\nCo-Authored-By: Stephan Krusche <krusche@in.tum.de>", "committedDate": "2020-01-21T22:35:01Z", "type": "commit"}]}