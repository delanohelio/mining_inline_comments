{"pr_number": 1699, "pr_title": "[Exam] Improve Generate Participation", "pr_createdAt": "2020-06-23T11:07:02Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1699", "timeline": [{"oid": "6a0b350a255b22f0ca752cda065e211daa71f670", "url": "https://github.com/ls1intum/Artemis/commit/6a0b350a255b22f0ca752cda065e211daa71f670", "message": "Removed Transactional by replacing with EntityGraph", "committedDate": "2020-06-23T11:05:43Z", "type": "commit"}, {"oid": "7fa19ed6507eed363ccc10102edc14643c55ae05", "url": "https://github.com/ls1intum/Artemis/commit/7fa19ed6507eed363ccc10102edc14643c55ae05", "message": "Fixed IntegrationTests by manually resolving bidirectional relationship", "committedDate": "2020-06-23T11:06:23Z", "type": "commit"}, {"oid": "f35ae4e8483c05ad2552e2b00a32ad1d35b200c9", "url": "https://github.com/ls1intum/Artemis/commit/f35ae4e8483c05ad2552e2b00a32ad1d35b200c9", "message": "Added correct success and error handling", "committedDate": "2020-06-23T19:43:25Z", "type": "commit"}, {"oid": "0c89d42e6f03cbefeb13304ce9c317d6a184b786", "url": "https://github.com/ls1intum/Artemis/commit/0c89d42e6f03cbefeb13304ce9c317d6a184b786", "message": "Implemented Loading Spinning functionality for buttons", "committedDate": "2020-06-24T15:57:06Z", "type": "commit"}, {"oid": "9902d89e45283ed601f9ab161b019230f53be279", "url": "https://github.com/ls1intum/Artemis/commit/9902d89e45283ed601f9ab161b019230f53be279", "message": "Merge branch 'develop' into exam/variants/remove-transactional", "committedDate": "2020-06-24T16:12:11Z", "type": "commit"}, {"oid": "74166a21bd7d2aad2ee4a765fe07d9d605ed5680", "url": "https://github.com/ls1intum/Artemis/commit/74166a21bd7d2aad2ee4a765fe07d9d605ed5680", "message": "Kind of Blue", "committedDate": "2020-06-24T16:17:02Z", "type": "commit"}, {"oid": "678599990fbbe93288c473b388fdd44449713ead", "url": "https://github.com/ls1intum/Artemis/commit/678599990fbbe93288c473b388fdd44449713ead", "message": "Made StartExercises return only the number of generated participations", "committedDate": "2020-06-24T16:24:49Z", "type": "commit"}, {"oid": "47d1ede79ad0cc2ee3de00ae66ac2e76ebc335ed", "url": "https://github.com/ls1intum/Artemis/commit/47d1ede79ad0cc2ee3de00ae66ac2e76ebc335ed", "message": "Deactivated Tests for the Moment", "committedDate": "2020-06-24T16:36:50Z", "type": "commit"}, {"oid": "77b6d35f7c78156e559da86f457198bb692ab867", "url": "https://github.com/ls1intum/Artemis/commit/77b6d35f7c78156e559da86f457198bb692ab867", "message": "Removed faulty test", "committedDate": "2020-06-24T20:43:30Z", "type": "commit"}, {"oid": "5b2a3c9c118293d662a50daef5a6869c2edf9297", "url": "https://github.com/ls1intum/Artemis/commit/5b2a3c9c118293d662a50daef5a6869c2edf9297", "message": "Removed unused import", "committedDate": "2020-06-24T20:58:08Z", "type": "commit"}, {"oid": "e827889c35643414e817df236b0abf1cd9de1b56", "url": "https://github.com/ls1intum/Artemis/commit/e827889c35643414e817df236b0abf1cd9de1b56", "message": "Rewrote tests", "committedDate": "2020-06-24T21:09:29Z", "type": "commit"}, {"oid": "e07c813444b8fb43f82ad1e0d304e0369bc1f5b1", "url": "https://github.com/ls1intum/Artemis/commit/e07c813444b8fb43f82ad1e0d304e0369bc1f5b1", "message": "Merge branch 'develop' into exam/variants/remove-transactional", "committedDate": "2020-06-24T21:11:00Z", "type": "commit"}, {"oid": "3d3991c3e7386413e5b37b6f7006fd1ca090f67e", "url": "https://github.com/ls1intum/Artemis/commit/3d3991c3e7386413e5b37b6f7006fd1ca090f67e", "message": "Fixed Merge Conflict", "committedDate": "2020-06-24T21:11:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYzMTYzMg==", "url": "https://github.com/ls1intum/Artemis/pull/1699#discussion_r445631632", "bodyText": "This should be deleted :D", "author": "anditurdiu", "createdAt": "2020-06-25T15:09:00Z", "path": "src/test/java/de/tum/in/www1/artemis/ExamIntegrationTest.java", "diffHunk": "@@ -190,33 +189,46 @@ public void testStartExercisesWithTextExercise() throws Exception {\n         exam2.setVisibleDate(ZonedDateTime.now().plusHours(1));\n \n         // creating exercise\n-        TextExercise textExercise = ModelFactory.generateTextExerciseForExam(exam2.getStartDate(), exam2.getEndDate(), exam2.getEndDate().plusWeeks(2),\n-                exam2.getExerciseGroups().get(0));\n-        exam2.getExerciseGroups().get(0).addExercise(textExercise);\n-        exerciseGroupRepository.save(exam2.getExerciseGroups().get(0));\n+        ExerciseGroup exerciseGroup = exam2.getExerciseGroups().get(0);\n+\n+        TextExercise textExercise = ModelFactory.generateTextExerciseForExam(exam2.getStartDate(), exam2.getEndDate(), exam2.getEndDate().plusWeeks(2), exerciseGroup);\n+        exerciseGroup.addExercise(textExercise);\n+        exerciseGroupRepository.save(exerciseGroup);\n         textExercise = exerciseRepo.save(textExercise);\n \n+        List<StudentExam> createdStudentExams = new ArrayList<>();\n+\n         // creating student exams\n         for (User user : registeredUsers) {\n             StudentExam studentExam = new StudentExam();\n             studentExam.addExercise(textExercise);\n             studentExam.setUser(user);\n             exam2.addStudentExam(studentExam);\n-            studentExamRepository.save(studentExam);\n+            createdStudentExams.add(studentExamRepository.save(studentExam));\n         }\n \n         exam2 = examRepository.save(exam2);\n \n         // invoke start exercises\n-        List<Participation> participations = request.postListWithResponseBody(\"/api/courses/\" + course1.getId() + \"/exams/\" + exam2.getId() + \"/student-exams/start-exercises\",\n-                Optional.empty(), Participation.class, HttpStatus.OK);\n-        assertThat(participations).hasSize(exam2.getStudentExams().size());\n-        for (Participation participation : participations) {\n+        Integer noGeneratedParticipations = request.postWithResponseBody(\"/api/courses/\" + course1.getId() + \"/exams/\" + exam2.getId() + \"/student-exams/start-exercises\",\n+                Optional.empty(), Integer.class, HttpStatus.OK);\n+        assertThat(noGeneratedParticipations).isEqualTo(exam2.getStudentExams().size());\n+        List<Participation> studentParticipations = participationRepository.findAll();\n+\n+        for (Participation participation : studentParticipations) {\n             assertThat(participation.getExercise().equals(textExercise));\n             assertThat(participation.getExercise().getCourseViaExerciseGroupOrCourseMember() == null);\n             assertThat(participation.getExercise().getExerciseGroup() == exam2.getExerciseGroups().get(0));\n             // TODO: check that submissions have been created to the participations of text exercises\n         }\n+        System.out.println(\"Test\");", "originalCommit": "3d3991c3e7386413e5b37b6f7006fd1ca090f67e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0eece8575c379e3a135695b05c9033abaaab5a5e", "url": "https://github.com/ls1intum/Artemis/commit/0eece8575c379e3a135695b05c9033abaaab5a5e", "message": "Merge branch 'develop' into exam/variants/remove-transactional", "committedDate": "2020-06-25T15:25:15Z", "type": "commit"}, {"oid": "f73cd4cad580c93f4f688d52052519c7b75cab5f", "url": "https://github.com/ls1intum/Artemis/commit/f73cd4cad580c93f4f688d52052519c7b75cab5f", "message": "Merge branch 'develop' into exam/variants/remove-transactional", "committedDate": "2020-06-25T17:29:43Z", "type": "commit"}, {"oid": "63fbad5b6e46853b20823ab47ea99f8be575447b", "url": "https://github.com/ls1intum/Artemis/commit/63fbad5b6e46853b20823ab47ea99f8be575447b", "message": "fix tests", "committedDate": "2020-06-25T22:49:10Z", "type": "commit"}, {"oid": "16b3dcd0bd55567247a5c8e8e5d1725cccfa512b", "url": "https://github.com/ls1intum/Artemis/commit/16b3dcd0bd55567247a5c8e8e5d1725cccfa512b", "message": "remove system out println", "committedDate": "2020-06-25T22:54:41Z", "type": "commit"}, {"oid": "30d2a27bec2d4dbb9168f38c8f80319500a5c817", "url": "https://github.com/ls1intum/Artemis/commit/30d2a27bec2d4dbb9168f38c8f80319500a5c817", "message": "fix test", "committedDate": "2020-06-25T23:20:14Z", "type": "commit"}, {"oid": "c882cd6cdb91248f66f7d541cee2d5ce47255383", "url": "https://github.com/ls1intum/Artemis/commit/c882cd6cdb91248f66f7d541cee2d5ce47255383", "message": "Merge branch 'develop' into exam/variants/remove-transactional", "committedDate": "2020-06-25T23:20:19Z", "type": "commit"}, {"oid": "d8d3168bfecc8b90c1729ad725c2bdc857ecc467", "url": "https://github.com/ls1intum/Artemis/commit/d8d3168bfecc8b90c1729ad725c2bdc857ecc467", "message": "fix test", "committedDate": "2020-06-25T23:28:54Z", "type": "commit"}, {"oid": "e34987363c5749179460ac246ed4628634371ce9", "url": "https://github.com/ls1intum/Artemis/commit/e34987363c5749179460ac246ed4628634371ce9", "message": "Merge branch 'develop' into exam/variants/remove-transactional", "committedDate": "2020-06-26T09:59:00Z", "type": "commit"}, {"oid": "5759094336b16e35cdfcb2d9f3953a62a3184464", "url": "https://github.com/ls1intum/Artemis/commit/5759094336b16e35cdfcb2d9f3953a62a3184464", "message": "Fixed error display", "committedDate": "2020-06-26T11:05:02Z", "type": "commit"}]}