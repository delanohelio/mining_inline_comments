{"pr_number": 1442, "pr_title": "Improve BehaviourTest in java template", "pr_createdAt": "2020-05-10T21:19:01Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1442", "timeline": [{"oid": "e554b3af81587de461afe446a1eb43c0d7abbe11", "url": "https://github.com/ls1intum/Artemis/commit/e554b3af81587de461afe446a1eb43c0d7abbe11", "message": "Improve BehaviourTest in java template", "committedDate": "2020-01-18T22:40:48Z", "type": "commit"}, {"oid": "872895fa349de124e41049edc37b6e4c55a5a199", "url": "https://github.com/ls1intum/Artemis/commit/872895fa349de124e41049edc37b6e4c55a5a199", "message": "Fix javadoc", "committedDate": "2020-01-18T22:53:12Z", "type": "commit"}, {"oid": "6f709df2459c0ffba522f26cdff0c8805e88a8fe", "url": "https://github.com/ls1intum/Artemis/commit/6f709df2459c0ffba522f26cdff0c8805e88a8fe", "message": "Merge branch 'develop' into develop", "committedDate": "2020-01-23T22:53:28Z", "type": "commit"}, {"oid": "534ce913a92d1e645fa65ad1ff82dc2d2c553626", "url": "https://github.com/ls1intum/Artemis/commit/534ce913a92d1e645fa65ad1ff82dc2d2c553626", "message": "Improve error message formatting", "committedDate": "2020-01-24T10:08:21Z", "type": "commit"}, {"oid": "192ee5cf031bc4d0b59e4bbabd56a5e3a0f6df00", "url": "https://github.com/ls1intum/Artemis/commit/192ee5cf031bc4d0b59e4bbabd56a5e3a0f6df00", "message": "Use simple class name again", "committedDate": "2020-05-08T14:45:13Z", "type": "commit"}, {"oid": "d3e5fc62a216006ffbfebf78765e4ebee2dc337c", "url": "https://github.com/ls1intum/Artemis/commit/d3e5fc62a216006ffbfebf78765e4ebee2dc337c", "message": "More places where simple names should be used", "committedDate": "2020-05-08T15:28:56Z", "type": "commit"}, {"oid": "431edcbc04e5b7153fc820abed1a8ed0811ad280", "url": "https://github.com/ls1intum/Artemis/commit/431edcbc04e5b7153fc820abed1a8ed0811ad280", "message": "Improve failure messages for NullPointerExceptions\n\nI would highly advise to change or remove the way methods are selected\njust using the run time types of the arguments in the future. Good error\nmessages are not possible if some objects are unexpectedly null.\nIt will also suddenly fail if the tester/student/... passes subclasses\ninstead.", "committedDate": "2020-05-08T15:53:39Z", "type": "commit"}, {"oid": "8de83d576ed9a6f2512f0048d5363ece2cbe30b5", "url": "https://github.com/ls1intum/Artemis/commit/8de83d576ed9a6f2512f0048d5363ece2cbe30b5", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-10T08:22:21Z", "type": "commit"}, {"oid": "a9bc30d81de2b309821d414f449170126a6b91ac", "url": "https://github.com/ls1intum/Artemis/commit/a9bc30d81de2b309821d414f449170126a6b91ac", "message": "Describe method limitations in the JavaDoc", "committedDate": "2020-05-10T14:51:26Z", "type": "commit"}, {"oid": "3c2fb00169e8f13826ab9cea6e79176d03aa9fb7", "url": "https://github.com/ls1intum/Artemis/commit/3c2fb00169e8f13826ab9cea6e79176d03aa9fb7", "message": "Remove TODO", "committedDate": "2020-05-10T14:51:46Z", "type": "commit"}, {"oid": "50c072b39d95c6f6dd4ff85345cc668f014c9198", "url": "https://github.com/ls1intum/Artemis/commit/50c072b39d95c6f6dd4ff85345cc668f014c9198", "message": "Update version of BehaviorTest class JavaDoc", "committedDate": "2020-05-10T19:52:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjkwOTEyMg==", "url": "https://github.com/ls1intum/Artemis/pull/1442#discussion_r422909122", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        + getParameterTypesAsString(parameterTypes) + \" from the \" + declaringClass.getSimpleName() + \" because\";\n          \n          \n            \n                        + getParameterTypesAsString(parameterTypes) + \" in the class \" + declaringClass.getSimpleName() + \" because\";", "author": "krusche", "createdAt": "2020-05-11T09:30:50Z", "path": "src/main/resources/templates/java/test/testFiles/behavior/BehaviorTest.java", "diffHunk": "@@ -125,7 +180,7 @@ protected Method getMethod(Object object, String methodName, Class<?>... paramet\n      */\n     protected Method getMethod(Class<?> declaringClass, String methodName, Class<?>... parameterTypes) {\n         String failMessage = \"Could not find the method '\" + methodName + \"' with the parameters: \"\n-            + getParameterTypesAsString(parameterTypes) + \" from the class \" + declaringClass.getSimpleName() + \" because\";\n+            + getParameterTypesAsString(parameterTypes) + \" from the \" + declaringClass.getSimpleName() + \" because\";", "originalCommit": "50c072b39d95c6f6dd4ff85345cc668f014c9198", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjkwOTU3MQ==", "url": "https://github.com/ls1intum/Artemis/pull/1442#discussion_r422909571", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            + \" from the class \" + declaringClass.getSimpleName() + \" because\";\n          \n          \n            \n                            + \" in the class \" + declaringClass.getSimpleName() + \" because\";", "author": "krusche", "createdAt": "2020-05-11T09:31:38Z", "path": "src/main/resources/templates/java/test/testFiles/behavior/BehaviorTest.java", "diffHunk": "@@ -167,39 +224,86 @@ protected Object invokeMethod(Object object, Method method, Object... params) {\n     }\n \n     /**\n-     * Invoke a given method name of a given object with instances of the parameters.\n+     * Invoke a given method of a given object with instances of the parameters,\n+     * and rethrow an exception if one occurs during the method execution.\n      * @param object: The instance of the class that should invoke the method.\n+     * @param method: The method that has to get invoked.\n+     * @param params: Parameter instances of the method. Do not include if the method has no parameters.\n+     * @return The return value of the method.\n+     */\n+    protected Object invokeMethodRethrowing(Object object, Method method, Object... params) throws Throwable {\n+        // NOTE: object can be null, if method is static\n+        String failMessage = \"Could not invoke the method '\" + method.getName()\n+                + \"' in the class \" + method.getDeclaringClass().getSimpleName() + \" because\";\n+        try {\n+            return method.invoke(object, params);\n+        } catch (IllegalAccessException iae) {\n+            fail(failMessage += \" access to the method was denied. Make sure to check the modifiers of the method.\");\n+        } catch (IllegalArgumentException iae) {\n+            fail(failMessage += \" the parameters are not implemented right. Make sure to check the parameters of the method\");\n+        } catch (InvocationTargetException e) {\n+            throw e.getCause();\n+        }\n+\n+        return null;\n+    }\n+\n+    /**\n+     * Invoke a given method name of a given object with instances of the parameters.\n+     * <p>\n+     * This method does not support invoking static methods and passing null, passing subclasses of the parameter types or invoking\n+     * methods with primitive parameters. Use {@link #invokeMethod(Object, Method, Object...)} for that.\n+     * @param object: The instance of the class that should invoke the method. Must not be null, even for static methods.\n      * @param methodName: The method name that has to get invoked.\n      * @param params: Parameter instances of the method. Do not include if the method has no parameters.\n      * @return The return value of the method.\n      */\n     protected Object invokeMethod(Object object, String methodName, Object... params) {\n-        Class<?>[] parameterTypes = getParameterTypes(params);\n+        String failMessage = \"Could not find the method '\" + methodName + \"' because\";\n+        Class<?>[] parameterTypes = getParameterTypes(failMessage, params);\n         Method method = getMethod(object, methodName, parameterTypes);\n         return invokeMethod(object, method, params);\n     }\n \n     /**\n-     * Retrieves the parameters types of a given collection of parameter instances.\n-     * @param params: The instances of the parameters.\n-     * @return The parameter types of the instances as an array.\n+     * Retrieve a constructor with arguments of a given class.\n+     * @param declaringClass: The class that declares this constructor.\n+     * @param parameterTypes: The parameter types of this method. Do not include if the method has no parameters.\n+     * @return The wanted method.\n      */\n-    private Class<?>[] getParameterTypes(Object... params) {\n-        Class<?>[] parameterTypes;\n+    protected Constructor<?> getConstructor(Class<?> declaringClass, Class<?>... parameterTypes) {\n+        String failMessage = \"Could not find the constructor with the parameters: \"\n+                + getParameterTypesAsString(parameterTypes)\n+                + \" from the class \" + declaringClass.getSimpleName() + \" because\";", "originalCommit": "50c072b39d95c6f6dd4ff85345cc668f014c9198", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1f7426a111e281ff46af1a6b30966ca3cd525a85", "url": "https://github.com/ls1intum/Artemis/commit/1f7426a111e281ff46af1a6b30966ca3cd525a85", "message": "Improve BehaviourTest failure message wording\n\nCo-authored-by: Stephan Krusche <krusche@in.tum.de>", "committedDate": "2020-05-11T09:38:34Z", "type": "commit"}, {"oid": "3654f33ddacd3180a685d4c50016143008037978", "url": "https://github.com/ls1intum/Artemis/commit/3654f33ddacd3180a685d4c50016143008037978", "message": "Merge branch 'develop' into enhancement/programming-exercise/behavior-test-improvements", "committedDate": "2020-05-12T13:55:27Z", "type": "commit"}]}