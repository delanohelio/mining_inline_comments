{"pr_number": 14322, "pr_title": "Adding more support for  Pinot types to Presto type conversion", "pr_createdAt": "2020-04-01T09:00:13Z", "pr_url": "https://github.com/prestodb/presto/pull/14322", "timeline": [{"oid": "ceaf2b48df4b7ddb951d0151259939ae7a97a618", "url": "https://github.com/prestodb/presto/commit/ceaf2b48df4b7ddb951d0151259939ae7a97a618", "message": "Adding support for Date and Timestamp data type support for Pinot", "committedDate": "2020-04-01T09:12:12Z", "type": "forcePushed"}, {"oid": "69dd97561f6c67f89d821e3f0f55e02eec69cf2f", "url": "https://github.com/prestodb/presto/commit/69dd97561f6c67f89d821e3f0f55e02eec69cf2f", "message": "Adding support for Date and Timestamp data type support for Pinot", "committedDate": "2020-04-01T09:17:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMTM4Mw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401831383", "bodyText": "Maybe this can go outside the switch block ?", "author": "agrawaldevesh", "createdAt": "2020-04-01T18:43:46Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotColumnUtils.java", "diffHunk": "@@ -39,14 +51,60 @@ private PinotColumnUtils()\n     {\n         return pinotTableSchema.getColumnNames().stream()\n                 .filter(columnName -> !columnName.startsWith(\"$\")) // Hidden columns starts with \"$\", ignore them as we can't use them in PQL\n-                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n+                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)), isNullableColumnFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)),\n+                        getCommentFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n                 .collect(toImmutableList());\n     }\n \n+    private static String getCommentFromPinotType(FieldSpec field)\n+    {\n+        return field.getFieldType().name();\n+    }\n+\n+    private static boolean isNullableColumnFromPinotType(FieldSpec field)\n+    {\n+        return DEFAULT_PINOT_COLUMN_IS_NULLABLE;\n+    }\n+\n     public static Type getPrestoTypeFromPinotType(FieldSpec field)\n     {\n         if (field.isSingleValueField()) {\n-            return getPrestoTypeFromPinotType(field.getDataType());\n+            switch (field.getFieldType()) {\n+                case TIME:\n+                    TimeFieldSpec timeFieldSpec = (TimeFieldSpec) field;\n+                    TimeGranularitySpec outSpec = timeFieldSpec.getOutgoingGranularitySpec();\n+                    if (outSpec != null) {\n+                        if (outSpec.getTimeFormat().equalsIgnoreCase(TimeGranularitySpec.TimeFormat.EPOCH.name())) {\n+                            if ((TimeUnit.DAYS == outSpec.getTimeType()) && (outSpec.getTimeUnitSize() == 1)) {\n+                                return DateType.DATE;\n+                            }\n+                            if ((TimeUnit.MILLISECONDS == outSpec.getTimeType()) && (outSpec.getTimeUnitSize() == 1)) {\n+                                return TimestampType.TIMESTAMP;\n+                            }\n+                        }\n+                    }\n+                    else {\n+                        TimeGranularitySpec inSpec = timeFieldSpec.getIncomingGranularitySpec();\n+                        if ((TimeUnit.DAYS == inSpec.getTimeType()) && (inSpec.getTimeUnitSize() == 1)) {\n+                            return DateType.DATE;\n+                        }\n+                        if ((TimeUnit.MILLISECONDS == inSpec.getTimeType()) && (inSpec.getTimeUnitSize() == 1)) {\n+                            return TimestampType.TIMESTAMP;\n+                        }\n+                    }\n+                    return getPrestoTypeFromPinotType(field.getDataType());\n+                case DATE_TIME:\n+                    DateTimeFieldSpec dateTimeFieldSpec = (DateTimeFieldSpec) field;\n+                    if (dateTimeFieldSpec.getFormat().equalsIgnoreCase(DAYS_SINCE_EPOCH_TIME_FORMAT)) {\n+                        return DateType.DATE;\n+                    }\n+                    if (dateTimeFieldSpec.getFormat().equalsIgnoreCase(MILLISECONDS_SINCE_EPOCH_TIME_FORMAT)) {\n+                        return TimestampType.TIMESTAMP;\n+                    }\n+                case DIMENSION:\n+                case METRIC:\n+                    return getPrestoTypeFromPinotType(field.getDataType());", "originalCommit": "69dd97561f6c67f89d821e3f0f55e02eec69cf2f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzODA2Mw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401838063", "bodyText": "sure", "author": "xiangfu0", "createdAt": "2020-04-01T18:55:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMTM4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMjIzNw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401832237", "bodyText": "If we don't match the constraints above, should this be a bug ? Should we fail or should we continue to treat a time/date as an int ?", "author": "agrawaldevesh", "createdAt": "2020-04-01T18:45:12Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotColumnUtils.java", "diffHunk": "@@ -39,14 +51,60 @@ private PinotColumnUtils()\n     {\n         return pinotTableSchema.getColumnNames().stream()\n                 .filter(columnName -> !columnName.startsWith(\"$\")) // Hidden columns starts with \"$\", ignore them as we can't use them in PQL\n-                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n+                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)), isNullableColumnFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)),\n+                        getCommentFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n                 .collect(toImmutableList());\n     }\n \n+    private static String getCommentFromPinotType(FieldSpec field)\n+    {\n+        return field.getFieldType().name();\n+    }\n+\n+    private static boolean isNullableColumnFromPinotType(FieldSpec field)\n+    {\n+        return DEFAULT_PINOT_COLUMN_IS_NULLABLE;\n+    }\n+\n     public static Type getPrestoTypeFromPinotType(FieldSpec field)\n     {\n         if (field.isSingleValueField()) {\n-            return getPrestoTypeFromPinotType(field.getDataType());\n+            switch (field.getFieldType()) {\n+                case TIME:\n+                    TimeFieldSpec timeFieldSpec = (TimeFieldSpec) field;\n+                    TimeGranularitySpec outSpec = timeFieldSpec.getOutgoingGranularitySpec();\n+                    if (outSpec != null) {\n+                        if (outSpec.getTimeFormat().equalsIgnoreCase(TimeGranularitySpec.TimeFormat.EPOCH.name())) {\n+                            if ((TimeUnit.DAYS == outSpec.getTimeType()) && (outSpec.getTimeUnitSize() == 1)) {\n+                                return DateType.DATE;\n+                            }\n+                            if ((TimeUnit.MILLISECONDS == outSpec.getTimeType()) && (outSpec.getTimeUnitSize() == 1)) {\n+                                return TimestampType.TIMESTAMP;\n+                            }\n+                        }\n+                    }\n+                    else {\n+                        TimeGranularitySpec inSpec = timeFieldSpec.getIncomingGranularitySpec();\n+                        if ((TimeUnit.DAYS == inSpec.getTimeType()) && (inSpec.getTimeUnitSize() == 1)) {\n+                            return DateType.DATE;\n+                        }\n+                        if ((TimeUnit.MILLISECONDS == inSpec.getTimeType()) && (inSpec.getTimeUnitSize() == 1)) {\n+                            return TimestampType.TIMESTAMP;\n+                        }\n+                    }\n+                    return getPrestoTypeFromPinotType(field.getDataType());", "originalCommit": "69dd97561f6c67f89d821e3f0f55e02eec69cf2f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzNTU4NA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401835584", "bodyText": "yes, still treat it as int/long/string, as pinot support multiple timeformat like secondsSinceEpoch,hoursSinceEpoch, or just simpleDateFormat with custom udfs", "author": "xiangfu0", "createdAt": "2020-04-01T18:50:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMjIzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMzU2OA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401833568", "bodyText": "I am missing how the \"comment\" and \"nullable\" flag are being used eventually ? I didn't catch that.", "author": "agrawaldevesh", "createdAt": "2020-04-01T18:47:28Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotColumnUtils.java", "diffHunk": "@@ -39,14 +51,60 @@ private PinotColumnUtils()\n     {\n         return pinotTableSchema.getColumnNames().stream()\n                 .filter(columnName -> !columnName.startsWith(\"$\")) // Hidden columns starts with \"$\", ignore them as we can't use them in PQL\n-                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n+                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)), isNullableColumnFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)),\n+                        getCommentFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n                 .collect(toImmutableList());\n     }\n \n+    private static String getCommentFromPinotType(FieldSpec field)", "originalCommit": "69dd97561f6c67f89d821e3f0f55e02eec69cf2f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzNzM3OQ==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401837379", "bodyText": "nullable is used to simplify the applications(E.g. powerbi will generate a more complex query for count distinct, is this column is nullable).\nComment is more used as a reference for user to link Pinot schemas.", "author": "xiangfu0", "createdAt": "2020-04-01T18:54:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMzU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzODg2NA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401838864", "bodyText": "Below is a sample schema\npresto:default> select * from \"pinot\".\"information_schema\".\"columns\" WHERE table_schema LIKE 'default' AND table_name LIKE 'meetuprsvp' ESCAPE '\\';\n table_catalog | table_schema | table_name |  column_name  | ordinal_position | column_default | is_nullable | data_type |  comment  | extra_info\n---------------+--------------+------------+---------------+------------------+----------------+-------------+-----------+-----------+------------\n pinot         | default      | meetuprsvp | venue_name    |                1 | NULL           | YES         | varchar   | DIMENSION | NULL\n pinot         | default      | meetuprsvp | rsvp_count    |                2 | NULL           | YES         | integer   | METRIC    | NULL\n pinot         | default      | meetuprsvp | group_city    |                3 | NULL           | YES         | varchar   | DIMENSION | NULL\n pinot         | default      | meetuprsvp | event_id      |                4 | NULL           | YES         | varchar   | DIMENSION | NULL\n pinot         | default      | meetuprsvp | group_country |                5 | NULL           | YES         | varchar   | DIMENSION | NULL\n pinot         | default      | meetuprsvp | group_id      |                6 | NULL           | YES         | bigint    | DIMENSION | NULL\n pinot         | default      | meetuprsvp | group_name    |                7 | NULL           | YES         | varchar   | DIMENSION | NULL\n pinot         | default      | meetuprsvp | event_name    |                8 | NULL           | YES         | varchar   | DIMENSION | NULL\n pinot         | default      | meetuprsvp | mtime         |                9 | NULL           | YES         | timestamp | TIME      | NULL\n pinot         | default      | meetuprsvp | event_time    |               10 | NULL           | YES         | bigint    | DIMENSION | NULL\n(10 rows)", "author": "xiangfu0", "createdAt": "2020-04-01T18:56:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMzU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg0MTI3OA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401841278", "bodyText": "Ah, so who consumes this \"comment\" field ? Is there some UI tool that consumes that or is this just for better instrumentation ?", "author": "agrawaldevesh", "createdAt": "2020-04-01T19:00:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMzU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg0NDU5MA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401844590", "bodyText": "It's majorly consumed by users directly for now. UI could incorporate this, e.g. Superset, Thirdeye, just it requires changes also.", "author": "xiangfu0", "createdAt": "2020-04-01T19:06:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMzU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg3MjAxNQ==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401872015", "bodyText": "Got it !. I was missing the fact that all we are doing is populating the ColumnMetadata notions of nullable and comment.", "author": "agrawaldevesh", "createdAt": "2020-04-01T19:55:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMzU2OA=="}], "type": "inlineReview"}, {"oid": "8401f4f02911f32a907f5b9067035572d3937ee0", "url": "https://github.com/prestodb/presto/commit/8401f4f02911f32a907f5b9067035572d3937ee0", "message": "Adding support for Date and Timestamp data type support for Pinot", "committedDate": "2020-04-01T18:55:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg3MTM1MQ==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401871351", "bodyText": "I am wondering if there should be a config flag to guard this behavior ? It may break Uber's use case. I hate adding extra flags but I think it would help with the rollout: the schema perceived by a user would now change post a rollout of this diff.", "author": "agrawaldevesh", "createdAt": "2020-04-01T19:54:45Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotColumnUtils.java", "diffHunk": "@@ -39,13 +51,57 @@ private PinotColumnUtils()\n     {\n         return pinotTableSchema.getColumnNames().stream()\n                 .filter(columnName -> !columnName.startsWith(\"$\")) // Hidden columns starts with \"$\", ignore them as we can't use them in PQL\n-                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n+                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)), isNullableColumnFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)),\n+                        getCommentFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n                 .collect(toImmutableList());\n     }\n \n+    private static String getCommentFromPinotType(FieldSpec field)\n+    {\n+        return field.getFieldType().name();\n+    }\n+\n+    private static boolean isNullableColumnFromPinotType(FieldSpec field)\n+    {\n+        return DEFAULT_PINOT_COLUMN_IS_NULLABLE;\n+    }\n+\n     public static Type getPrestoTypeFromPinotType(FieldSpec field)\n     {\n         if (field.isSingleValueField()) {\n+            switch (field.getFieldType()) {\n+                case TIME:", "originalCommit": "8401f4f02911f32a907f5b9067035572d3937ee0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkxMDI3Mw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401910273", "bodyText": "Added two configs: pinot.infer-date-type-in-schema and pinot.infer-timestamp-type-in-schema  to switch on/off this type conversion.", "author": "xiangfu0", "createdAt": "2020-04-01T21:07:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg3MTM1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAzMjg2Mw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402032863", "bodyText": "all parameters in a single line, or each parameter in separate line", "author": "zhenxiao", "createdAt": "2020-04-02T03:33:16Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotColumnUtils.java", "diffHunk": "@@ -15,37 +15,91 @@\n \n import com.facebook.presto.spi.type.BigintType;\n import com.facebook.presto.spi.type.BooleanType;\n+import com.facebook.presto.spi.type.DateType;\n import com.facebook.presto.spi.type.DoubleType;\n import com.facebook.presto.spi.type.IntegerType;\n+import com.facebook.presto.spi.type.TimestampType;\n import com.facebook.presto.spi.type.Type;\n+import com.facebook.presto.spi.type.VarbinaryType;\n import com.facebook.presto.spi.type.VarcharType;\n+import org.apache.pinot.common.data.DateTimeFieldSpec;\n import org.apache.pinot.common.data.FieldSpec;\n import org.apache.pinot.common.data.FieldSpec.DataType;\n import org.apache.pinot.common.data.Schema;\n+import org.apache.pinot.common.data.TimeFieldSpec;\n+import org.apache.pinot.common.data.TimeGranularitySpec;\n \n import java.util.List;\n import java.util.Optional;\n+import java.util.concurrent.TimeUnit;\n \n import static com.facebook.presto.pinot.PinotErrorCode.PINOT_UNSUPPORTED_COLUMN_TYPE;\n import static com.google.common.collect.ImmutableList.toImmutableList;\n \n public class PinotColumnUtils\n {\n+    private static final String DAYS_SINCE_EPOCH_TIME_FORMAT = \"1:DAYS:EPOCH\";\n+    private static final String MILLISECONDS_SINCE_EPOCH_TIME_FORMAT = \"1:MILLISECONDS:EPOCH\";\n+\n     private PinotColumnUtils()\n     {\n     }\n \n-    public static List<PinotColumn> getPinotColumnsForPinotSchema(Schema pinotTableSchema)\n+    public static List<PinotColumn> getPinotColumnsForPinotSchema(Schema pinotTableSchema, boolean inferDateType, boolean inferTimestampType)\n     {\n         return pinotTableSchema.getColumnNames().stream()\n                 .filter(columnName -> !columnName.startsWith(\"$\")) // Hidden columns starts with \"$\", ignore them as we can't use them in PQL\n-                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n+                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName), inferDateType, inferTimestampType), isNullableColumnFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)),\n+                        getCommentFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))", "originalCommit": "4077b533c4cb2080460ca6aea19a2968eb2b2176", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5ODI3Mw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402098273", "bodyText": "done", "author": "xiangfu0", "createdAt": "2020-04-02T07:14:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAzMjg2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAzMzE3OQ==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402033179", "bodyText": "static import EPOCH", "author": "zhenxiao", "createdAt": "2020-04-02T03:34:26Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotColumnUtils.java", "diffHunk": "@@ -15,37 +15,91 @@\n \n import com.facebook.presto.spi.type.BigintType;\n import com.facebook.presto.spi.type.BooleanType;\n+import com.facebook.presto.spi.type.DateType;\n import com.facebook.presto.spi.type.DoubleType;\n import com.facebook.presto.spi.type.IntegerType;\n+import com.facebook.presto.spi.type.TimestampType;\n import com.facebook.presto.spi.type.Type;\n+import com.facebook.presto.spi.type.VarbinaryType;\n import com.facebook.presto.spi.type.VarcharType;\n+import org.apache.pinot.common.data.DateTimeFieldSpec;\n import org.apache.pinot.common.data.FieldSpec;\n import org.apache.pinot.common.data.FieldSpec.DataType;\n import org.apache.pinot.common.data.Schema;\n+import org.apache.pinot.common.data.TimeFieldSpec;\n+import org.apache.pinot.common.data.TimeGranularitySpec;\n \n import java.util.List;\n import java.util.Optional;\n+import java.util.concurrent.TimeUnit;\n \n import static com.facebook.presto.pinot.PinotErrorCode.PINOT_UNSUPPORTED_COLUMN_TYPE;\n import static com.google.common.collect.ImmutableList.toImmutableList;\n \n public class PinotColumnUtils\n {\n+    private static final String DAYS_SINCE_EPOCH_TIME_FORMAT = \"1:DAYS:EPOCH\";\n+    private static final String MILLISECONDS_SINCE_EPOCH_TIME_FORMAT = \"1:MILLISECONDS:EPOCH\";\n+\n     private PinotColumnUtils()\n     {\n     }\n \n-    public static List<PinotColumn> getPinotColumnsForPinotSchema(Schema pinotTableSchema)\n+    public static List<PinotColumn> getPinotColumnsForPinotSchema(Schema pinotTableSchema, boolean inferDateType, boolean inferTimestampType)\n     {\n         return pinotTableSchema.getColumnNames().stream()\n                 .filter(columnName -> !columnName.startsWith(\"$\")) // Hidden columns starts with \"$\", ignore them as we can't use them in PQL\n-                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n+                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName), inferDateType, inferTimestampType), isNullableColumnFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)),\n+                        getCommentFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n                 .collect(toImmutableList());\n     }\n \n-    public static Type getPrestoTypeFromPinotType(FieldSpec field)\n+    private static String getCommentFromPinotType(FieldSpec field)\n+    {\n+        return field.getFieldType().name();\n+    }\n+\n+    private static boolean isNullableColumnFromPinotType(FieldSpec field)\n+    {\n+        return false;\n+    }\n+\n+    public static Type getPrestoTypeFromPinotType(FieldSpec field, boolean inferDateType, boolean inferTimestampType)\n     {\n         if (field.isSingleValueField()) {\n+            switch (field.getFieldType()) {\n+                case TIME:\n+                    TimeFieldSpec timeFieldSpec = (TimeFieldSpec) field;\n+                    TimeGranularitySpec outSpec = timeFieldSpec.getOutgoingGranularitySpec();\n+                    if (outSpec != null) {\n+                        if (outSpec.getTimeFormat().equalsIgnoreCase(TimeGranularitySpec.TimeFormat.EPOCH.name())) {", "originalCommit": "4077b533c4cb2080460ca6aea19a2968eb2b2176", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5ODIyOA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402098228", "bodyText": "done", "author": "xiangfu0", "createdAt": "2020-04-02T07:14:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAzMzE3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAzMzI3Mw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402033273", "bodyText": "static import DAYS, MILLISECONDS", "author": "zhenxiao", "createdAt": "2020-04-02T03:34:47Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotColumnUtils.java", "diffHunk": "@@ -15,37 +15,91 @@\n \n import com.facebook.presto.spi.type.BigintType;\n import com.facebook.presto.spi.type.BooleanType;\n+import com.facebook.presto.spi.type.DateType;\n import com.facebook.presto.spi.type.DoubleType;\n import com.facebook.presto.spi.type.IntegerType;\n+import com.facebook.presto.spi.type.TimestampType;\n import com.facebook.presto.spi.type.Type;\n+import com.facebook.presto.spi.type.VarbinaryType;\n import com.facebook.presto.spi.type.VarcharType;\n+import org.apache.pinot.common.data.DateTimeFieldSpec;\n import org.apache.pinot.common.data.FieldSpec;\n import org.apache.pinot.common.data.FieldSpec.DataType;\n import org.apache.pinot.common.data.Schema;\n+import org.apache.pinot.common.data.TimeFieldSpec;\n+import org.apache.pinot.common.data.TimeGranularitySpec;\n \n import java.util.List;\n import java.util.Optional;\n+import java.util.concurrent.TimeUnit;\n \n import static com.facebook.presto.pinot.PinotErrorCode.PINOT_UNSUPPORTED_COLUMN_TYPE;\n import static com.google.common.collect.ImmutableList.toImmutableList;\n \n public class PinotColumnUtils\n {\n+    private static final String DAYS_SINCE_EPOCH_TIME_FORMAT = \"1:DAYS:EPOCH\";\n+    private static final String MILLISECONDS_SINCE_EPOCH_TIME_FORMAT = \"1:MILLISECONDS:EPOCH\";\n+\n     private PinotColumnUtils()\n     {\n     }\n \n-    public static List<PinotColumn> getPinotColumnsForPinotSchema(Schema pinotTableSchema)\n+    public static List<PinotColumn> getPinotColumnsForPinotSchema(Schema pinotTableSchema, boolean inferDateType, boolean inferTimestampType)\n     {\n         return pinotTableSchema.getColumnNames().stream()\n                 .filter(columnName -> !columnName.startsWith(\"$\")) // Hidden columns starts with \"$\", ignore them as we can't use them in PQL\n-                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n+                .map(columnName -> new PinotColumn(columnName, getPrestoTypeFromPinotType(pinotTableSchema.getFieldSpecFor(columnName), inferDateType, inferTimestampType), isNullableColumnFromPinotType(pinotTableSchema.getFieldSpecFor(columnName)),\n+                        getCommentFromPinotType(pinotTableSchema.getFieldSpecFor(columnName))))\n                 .collect(toImmutableList());\n     }\n \n-    public static Type getPrestoTypeFromPinotType(FieldSpec field)\n+    private static String getCommentFromPinotType(FieldSpec field)\n+    {\n+        return field.getFieldType().name();\n+    }\n+\n+    private static boolean isNullableColumnFromPinotType(FieldSpec field)\n+    {\n+        return false;\n+    }\n+\n+    public static Type getPrestoTypeFromPinotType(FieldSpec field, boolean inferDateType, boolean inferTimestampType)\n     {\n         if (field.isSingleValueField()) {\n+            switch (field.getFieldType()) {\n+                case TIME:\n+                    TimeFieldSpec timeFieldSpec = (TimeFieldSpec) field;\n+                    TimeGranularitySpec outSpec = timeFieldSpec.getOutgoingGranularitySpec();\n+                    if (outSpec != null) {\n+                        if (outSpec.getTimeFormat().equalsIgnoreCase(TimeGranularitySpec.TimeFormat.EPOCH.name())) {\n+                            if (inferDateType && (TimeUnit.DAYS == outSpec.getTimeType()) && (outSpec.getTimeUnitSize() == 1)) {", "originalCommit": "4077b533c4cb2080460ca6aea19a2968eb2b2176", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5ODE5Mw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402098193", "bodyText": "done", "author": "xiangfu0", "createdAt": "2020-04-02T07:14:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAzMzI3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAzMzcwNA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402033704", "bodyText": "shall we add documentation in:\n./presto-docs/src/main/sphinx/connector/pinot.rst", "author": "zhenxiao", "createdAt": "2020-04-02T03:36:46Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotConfig.java", "diffHunk": "@@ -416,4 +418,28 @@ public PinotConfig setNonAggregateLimitForBrokerQueries(int nonAggregateLimitFor\n         this.nonAggregateLimitForBrokerQueries = nonAggregateLimitForBrokerQueries;\n         return this;\n     }\n+\n+    public boolean isInferDateTypeInSchema()\n+    {\n+        return inferDateTypeInSchema;\n+    }\n+\n+    @Config(\"pinot.infer-date-type-in-schema\")", "originalCommit": "4077b533c4cb2080460ca6aea19a2968eb2b2176", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5ODE0NA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402098144", "bodyText": "Added docs", "author": "xiangfu0", "createdAt": "2020-04-02T07:14:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAzMzcwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1Njc5NA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r401956794", "bodyText": "Use ImmutableMap.of()", "author": "highker", "createdAt": "2020-04-01T22:54:16Z", "path": "presto-pinot-toolkit/src/main/java/com/facebook/presto/pinot/PinotColumnMetadata.java", "diffHunk": "@@ -27,9 +28,9 @@\n     // We need to preserve the case sensitivity of the column, store it here as the super class stores the value after lower-casing it\n     private final String name;\n \n-    public PinotColumnMetadata(String name, Type type)\n+    public PinotColumnMetadata(String name, Type type, boolean inNullable, String comment)\n     {\n-        super(requireNonNull(name, \"name is null\"), requireNonNull(type, \"type is null\"));\n+        super(requireNonNull(name, \"name is null\"), requireNonNull(type, \"type is null\"), inNullable, comment, null, false, emptyMap());", "originalCommit": "8401f4f02911f32a907f5b9067035572d3937ee0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5ODM4Mw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402098383", "bodyText": "done.", "author": "xiangfu0", "createdAt": "2020-04-02T07:14:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1Njc5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NjE5OQ==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402056199", "bodyText": "column", "author": "highker", "createdAt": "2020-04-02T05:16:09Z", "path": "presto-pinot-toolkit/src/test/java/com/facebook/presto/pinot/TestPinotColumnMetadata.java", "diffHunk": "@@ -0,0 +1,287 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.pinot;\n+\n+import com.facebook.presto.spi.type.DateType;\n+import com.facebook.presto.spi.type.DoubleType;\n+import com.facebook.presto.spi.type.TimestampType;\n+import com.facebook.presto.spi.type.Type;\n+import com.google.common.collect.ImmutableMap;\n+import org.apache.pinot.common.data.FieldSpec;\n+import org.apache.pinot.common.data.Schema;\n+import org.apache.pinot.common.data.TimeGranularitySpec;\n+import org.testng.annotations.Test;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.TimeUnit;\n+\n+import static com.facebook.presto.spi.type.BigintType.BIGINT;\n+import static com.facebook.presto.spi.type.IntegerType.INTEGER;\n+import static com.facebook.presto.spi.type.VarbinaryType.VARBINARY;\n+import static com.facebook.presto.spi.type.VarcharType.VARCHAR;\n+import static org.testng.Assert.assertEquals;\n+\n+public class TestPinotColumnMetadata\n+{\n+    @Test\n+    public void testParsePinotSchemaToPinotColumns()\n+    {\n+        PinotConfig pinotConfig = new PinotConfig();\n+        pinotConfig.setInferDateTypeInSchema(true);\n+        pinotConfig.setInferTimestampTypeInSchema(true);\n+\n+        Schema testPinotSchema = new Schema.SchemaBuilder()\n+                .addSingleValueDimension(\"singleValueIntDimension\", FieldSpec.DataType.INT)\n+                .addSingleValueDimension(\"singleValueLongDimension\", FieldSpec.DataType.LONG)\n+                .addSingleValueDimension(\"singleValueFloatDimension\", FieldSpec.DataType.FLOAT)\n+                .addSingleValueDimension(\"singleValueDoubleDimension\", FieldSpec.DataType.DOUBLE)\n+                .addSingleValueDimension(\"singleValueBytesDimension\", FieldSpec.DataType.BYTES)\n+                .addSingleValueDimension(\"singleValueBooleanDimension\", FieldSpec.DataType.BOOLEAN)\n+                .addSingleValueDimension(\"singleValueStringDimension\", FieldSpec.DataType.STRING)\n+                .addMultiValueDimension(\"multiValueIntDimension\", FieldSpec.DataType.INT)\n+                .addMultiValueDimension(\"multiValueLongDimension\", FieldSpec.DataType.LONG)\n+                .addMultiValueDimension(\"multiValueFloatDimension\", FieldSpec.DataType.FLOAT)\n+                .addMultiValueDimension(\"multiValueDoubleDimension\", FieldSpec.DataType.DOUBLE)\n+                .addMultiValueDimension(\"multiValueBytesDimension\", FieldSpec.DataType.BYTES)\n+                .addMultiValueDimension(\"multiValueBooleanDimension\", FieldSpec.DataType.BOOLEAN)\n+                .addMultiValueDimension(\"multiValueStringDimension\", FieldSpec.DataType.STRING)\n+                .addMetric(\"intMetric\", FieldSpec.DataType.INT)\n+                .addMetric(\"longMetric\", FieldSpec.DataType.LONG)\n+                .addMetric(\"floatMetric\", FieldSpec.DataType.FLOAT)\n+                .addMetric(\"doubleMetric\", FieldSpec.DataType.DOUBLE)\n+                .addMetric(\"bytesMetric\", FieldSpec.DataType.BYTES)\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, \"daysSinceEpoch\"))\n+                .addDateTime(\"epochDayDateTime\", FieldSpec.DataType.INT, \"1:DAYS:EPOCH\", \"1:DAYS\")\n+                .addDateTime(\"epochMillisDateTime\", FieldSpec.DataType.LONG, \"1:MILLISECONDS:EPOCH\", \"1:SECONDS\")\n+                .addDateTime(\"epochTenDayDateTime\", FieldSpec.DataType.INT, \"10:DAYS:EPOCH\", \"1:DAYS\")\n+                .addDateTime(\"epochSecondsDateTime\", FieldSpec.DataType.LONG, \"1:SECONDS:EPOCH\", \"1:SECONDS\")\n+                .build();\n+\n+        Map<String, Type> expectedTypeMap = new ImmutableMap.Builder<String, Type>()\n+                .put(\"singleValueIntDimension\", INTEGER)\n+                .put(\"singleValueLongDimension\", BIGINT)\n+                .put(\"singleValueFloatDimension\", DoubleType.DOUBLE)\n+                .put(\"singleValueDoubleDimension\", DoubleType.DOUBLE)\n+                .put(\"singleValueBytesDimension\", VARBINARY)\n+                .put(\"singleValueBooleanDimension\", VARCHAR)\n+                .put(\"singleValueStringDimension\", VARCHAR)\n+                .put(\"multiValueIntDimension\", VARCHAR)\n+                .put(\"multiValueLongDimension\", VARCHAR)\n+                .put(\"multiValueFloatDimension\", VARCHAR)\n+                .put(\"multiValueDoubleDimension\", VARCHAR)\n+                .put(\"multiValueBytesDimension\", VARCHAR)\n+                .put(\"multiValueBooleanDimension\", VARCHAR)\n+                .put(\"multiValueStringDimension\", VARCHAR)\n+                .put(\"intMetric\", INTEGER)\n+                .put(\"longMetric\", BIGINT)\n+                .put(\"floatMetric\", DoubleType.DOUBLE)\n+                .put(\"doubleMetric\", DoubleType.DOUBLE)\n+                .put(\"bytesMetric\", VARBINARY)\n+                .put(\"daysSinceEpoch\", DateType.DATE)\n+                .put(\"epochDayDateTime\", DateType.DATE)\n+                .put(\"epochMillisDateTime\", TimestampType.TIMESTAMP)\n+                .put(\"epochTenDayDateTime\", INTEGER)\n+                .put(\"epochSecondsDateTime\", BIGINT)\n+                .build();\n+        Map<String, String> expectedComment = new ImmutableMap.Builder<String, String>()\n+                .put(\"sd1\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueIntDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueLongDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueFloatDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueDoubleDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueBytesDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueBooleanDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueStringDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueIntDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueLongDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueFloatDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueDoubleDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueBytesDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueBooleanDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueStringDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"intMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"longMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"floatMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"doubleMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"bytesMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"daysSinceEpoch\", FieldSpec.FieldType.TIME.name())\n+                .put(\"epochDayDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .put(\"epochMillisDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .put(\"epochTenDayDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .put(\"epochSecondsDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .build();\n+\n+        List<PinotColumn> pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testPinotSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        for (PinotColumn col : pinotColumns) {", "originalCommit": "4077b533c4cb2080460ca6aea19a2968eb2b2176", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5OTc1NA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402099754", "bodyText": "done", "author": "xiangfu0", "createdAt": "2020-04-02T07:17:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NjE5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NjYzNw==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402056637", "bodyText": "column", "author": "highker", "createdAt": "2020-04-02T05:17:35Z", "path": "presto-pinot-toolkit/src/test/java/com/facebook/presto/pinot/TestPinotColumnMetadata.java", "diffHunk": "@@ -0,0 +1,287 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.pinot;\n+\n+import com.facebook.presto.spi.type.DateType;\n+import com.facebook.presto.spi.type.DoubleType;\n+import com.facebook.presto.spi.type.TimestampType;\n+import com.facebook.presto.spi.type.Type;\n+import com.google.common.collect.ImmutableMap;\n+import org.apache.pinot.common.data.FieldSpec;\n+import org.apache.pinot.common.data.Schema;\n+import org.apache.pinot.common.data.TimeGranularitySpec;\n+import org.testng.annotations.Test;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.TimeUnit;\n+\n+import static com.facebook.presto.spi.type.BigintType.BIGINT;\n+import static com.facebook.presto.spi.type.IntegerType.INTEGER;\n+import static com.facebook.presto.spi.type.VarbinaryType.VARBINARY;\n+import static com.facebook.presto.spi.type.VarcharType.VARCHAR;\n+import static org.testng.Assert.assertEquals;\n+\n+public class TestPinotColumnMetadata\n+{\n+    @Test\n+    public void testParsePinotSchemaToPinotColumns()\n+    {\n+        PinotConfig pinotConfig = new PinotConfig();\n+        pinotConfig.setInferDateTypeInSchema(true);\n+        pinotConfig.setInferTimestampTypeInSchema(true);\n+\n+        Schema testPinotSchema = new Schema.SchemaBuilder()\n+                .addSingleValueDimension(\"singleValueIntDimension\", FieldSpec.DataType.INT)\n+                .addSingleValueDimension(\"singleValueLongDimension\", FieldSpec.DataType.LONG)\n+                .addSingleValueDimension(\"singleValueFloatDimension\", FieldSpec.DataType.FLOAT)\n+                .addSingleValueDimension(\"singleValueDoubleDimension\", FieldSpec.DataType.DOUBLE)\n+                .addSingleValueDimension(\"singleValueBytesDimension\", FieldSpec.DataType.BYTES)\n+                .addSingleValueDimension(\"singleValueBooleanDimension\", FieldSpec.DataType.BOOLEAN)\n+                .addSingleValueDimension(\"singleValueStringDimension\", FieldSpec.DataType.STRING)\n+                .addMultiValueDimension(\"multiValueIntDimension\", FieldSpec.DataType.INT)\n+                .addMultiValueDimension(\"multiValueLongDimension\", FieldSpec.DataType.LONG)\n+                .addMultiValueDimension(\"multiValueFloatDimension\", FieldSpec.DataType.FLOAT)\n+                .addMultiValueDimension(\"multiValueDoubleDimension\", FieldSpec.DataType.DOUBLE)\n+                .addMultiValueDimension(\"multiValueBytesDimension\", FieldSpec.DataType.BYTES)\n+                .addMultiValueDimension(\"multiValueBooleanDimension\", FieldSpec.DataType.BOOLEAN)\n+                .addMultiValueDimension(\"multiValueStringDimension\", FieldSpec.DataType.STRING)\n+                .addMetric(\"intMetric\", FieldSpec.DataType.INT)\n+                .addMetric(\"longMetric\", FieldSpec.DataType.LONG)\n+                .addMetric(\"floatMetric\", FieldSpec.DataType.FLOAT)\n+                .addMetric(\"doubleMetric\", FieldSpec.DataType.DOUBLE)\n+                .addMetric(\"bytesMetric\", FieldSpec.DataType.BYTES)\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, \"daysSinceEpoch\"))\n+                .addDateTime(\"epochDayDateTime\", FieldSpec.DataType.INT, \"1:DAYS:EPOCH\", \"1:DAYS\")\n+                .addDateTime(\"epochMillisDateTime\", FieldSpec.DataType.LONG, \"1:MILLISECONDS:EPOCH\", \"1:SECONDS\")\n+                .addDateTime(\"epochTenDayDateTime\", FieldSpec.DataType.INT, \"10:DAYS:EPOCH\", \"1:DAYS\")\n+                .addDateTime(\"epochSecondsDateTime\", FieldSpec.DataType.LONG, \"1:SECONDS:EPOCH\", \"1:SECONDS\")\n+                .build();\n+\n+        Map<String, Type> expectedTypeMap = new ImmutableMap.Builder<String, Type>()\n+                .put(\"singleValueIntDimension\", INTEGER)\n+                .put(\"singleValueLongDimension\", BIGINT)\n+                .put(\"singleValueFloatDimension\", DoubleType.DOUBLE)\n+                .put(\"singleValueDoubleDimension\", DoubleType.DOUBLE)\n+                .put(\"singleValueBytesDimension\", VARBINARY)\n+                .put(\"singleValueBooleanDimension\", VARCHAR)\n+                .put(\"singleValueStringDimension\", VARCHAR)\n+                .put(\"multiValueIntDimension\", VARCHAR)\n+                .put(\"multiValueLongDimension\", VARCHAR)\n+                .put(\"multiValueFloatDimension\", VARCHAR)\n+                .put(\"multiValueDoubleDimension\", VARCHAR)\n+                .put(\"multiValueBytesDimension\", VARCHAR)\n+                .put(\"multiValueBooleanDimension\", VARCHAR)\n+                .put(\"multiValueStringDimension\", VARCHAR)\n+                .put(\"intMetric\", INTEGER)\n+                .put(\"longMetric\", BIGINT)\n+                .put(\"floatMetric\", DoubleType.DOUBLE)\n+                .put(\"doubleMetric\", DoubleType.DOUBLE)\n+                .put(\"bytesMetric\", VARBINARY)\n+                .put(\"daysSinceEpoch\", DateType.DATE)\n+                .put(\"epochDayDateTime\", DateType.DATE)\n+                .put(\"epochMillisDateTime\", TimestampType.TIMESTAMP)\n+                .put(\"epochTenDayDateTime\", INTEGER)\n+                .put(\"epochSecondsDateTime\", BIGINT)\n+                .build();\n+        Map<String, String> expectedComment = new ImmutableMap.Builder<String, String>()\n+                .put(\"sd1\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueIntDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueLongDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueFloatDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueDoubleDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueBytesDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueBooleanDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueStringDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueIntDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueLongDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueFloatDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueDoubleDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueBytesDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueBooleanDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueStringDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"intMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"longMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"floatMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"doubleMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"bytesMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"daysSinceEpoch\", FieldSpec.FieldType.TIME.name())\n+                .put(\"epochDayDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .put(\"epochMillisDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .put(\"epochTenDayDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .put(\"epochSecondsDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .build();\n+\n+        List<PinotColumn> pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testPinotSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        for (PinotColumn col : pinotColumns) {\n+            assertEquals(col.getType(), expectedTypeMap.get(col.getName()), \"Failed to compare column type for field - \" + col.getName());\n+            assertEquals(col.getComment(), expectedComment.get(col.getName()), \"Failed to compare column comment for field - \" + col.getName());\n+            assertEquals(col.isNullable(), false);\n+        }\n+    }\n+\n+    @Test\n+    public void testTimeFieldInPinotSchemaToPinotColumns()\n+    {\n+        PinotConfig pinotConfig = new PinotConfig();\n+        pinotConfig.setInferDateTypeInSchema(true);\n+        pinotConfig.setInferTimestampTypeInSchema(true);\n+\n+        // Test Date\n+        Schema testSchema = new Schema.SchemaBuilder()\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, \"daysSinceEpoch\"))\n+                .build();\n+        List<PinotColumn> pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        PinotColumn col = pinotColumns.get(0);", "originalCommit": "4077b533c4cb2080460ca6aea19a2968eb2b2176", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5ODQzMg==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402098432", "bodyText": "done", "author": "xiangfu0", "createdAt": "2020-04-02T07:14:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NjYzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1Njc1Mg==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402056752", "bodyText": "same", "author": "highker", "createdAt": "2020-04-02T05:18:02Z", "path": "presto-pinot-toolkit/src/test/java/com/facebook/presto/pinot/TestPinotColumnMetadata.java", "diffHunk": "@@ -0,0 +1,287 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.pinot;\n+\n+import com.facebook.presto.spi.type.DateType;\n+import com.facebook.presto.spi.type.DoubleType;\n+import com.facebook.presto.spi.type.TimestampType;\n+import com.facebook.presto.spi.type.Type;\n+import com.google.common.collect.ImmutableMap;\n+import org.apache.pinot.common.data.FieldSpec;\n+import org.apache.pinot.common.data.Schema;\n+import org.apache.pinot.common.data.TimeGranularitySpec;\n+import org.testng.annotations.Test;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.TimeUnit;\n+\n+import static com.facebook.presto.spi.type.BigintType.BIGINT;\n+import static com.facebook.presto.spi.type.IntegerType.INTEGER;\n+import static com.facebook.presto.spi.type.VarbinaryType.VARBINARY;\n+import static com.facebook.presto.spi.type.VarcharType.VARCHAR;\n+import static org.testng.Assert.assertEquals;\n+\n+public class TestPinotColumnMetadata\n+{\n+    @Test\n+    public void testParsePinotSchemaToPinotColumns()\n+    {\n+        PinotConfig pinotConfig = new PinotConfig();\n+        pinotConfig.setInferDateTypeInSchema(true);\n+        pinotConfig.setInferTimestampTypeInSchema(true);\n+\n+        Schema testPinotSchema = new Schema.SchemaBuilder()\n+                .addSingleValueDimension(\"singleValueIntDimension\", FieldSpec.DataType.INT)\n+                .addSingleValueDimension(\"singleValueLongDimension\", FieldSpec.DataType.LONG)\n+                .addSingleValueDimension(\"singleValueFloatDimension\", FieldSpec.DataType.FLOAT)\n+                .addSingleValueDimension(\"singleValueDoubleDimension\", FieldSpec.DataType.DOUBLE)\n+                .addSingleValueDimension(\"singleValueBytesDimension\", FieldSpec.DataType.BYTES)\n+                .addSingleValueDimension(\"singleValueBooleanDimension\", FieldSpec.DataType.BOOLEAN)\n+                .addSingleValueDimension(\"singleValueStringDimension\", FieldSpec.DataType.STRING)\n+                .addMultiValueDimension(\"multiValueIntDimension\", FieldSpec.DataType.INT)\n+                .addMultiValueDimension(\"multiValueLongDimension\", FieldSpec.DataType.LONG)\n+                .addMultiValueDimension(\"multiValueFloatDimension\", FieldSpec.DataType.FLOAT)\n+                .addMultiValueDimension(\"multiValueDoubleDimension\", FieldSpec.DataType.DOUBLE)\n+                .addMultiValueDimension(\"multiValueBytesDimension\", FieldSpec.DataType.BYTES)\n+                .addMultiValueDimension(\"multiValueBooleanDimension\", FieldSpec.DataType.BOOLEAN)\n+                .addMultiValueDimension(\"multiValueStringDimension\", FieldSpec.DataType.STRING)\n+                .addMetric(\"intMetric\", FieldSpec.DataType.INT)\n+                .addMetric(\"longMetric\", FieldSpec.DataType.LONG)\n+                .addMetric(\"floatMetric\", FieldSpec.DataType.FLOAT)\n+                .addMetric(\"doubleMetric\", FieldSpec.DataType.DOUBLE)\n+                .addMetric(\"bytesMetric\", FieldSpec.DataType.BYTES)\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, \"daysSinceEpoch\"))\n+                .addDateTime(\"epochDayDateTime\", FieldSpec.DataType.INT, \"1:DAYS:EPOCH\", \"1:DAYS\")\n+                .addDateTime(\"epochMillisDateTime\", FieldSpec.DataType.LONG, \"1:MILLISECONDS:EPOCH\", \"1:SECONDS\")\n+                .addDateTime(\"epochTenDayDateTime\", FieldSpec.DataType.INT, \"10:DAYS:EPOCH\", \"1:DAYS\")\n+                .addDateTime(\"epochSecondsDateTime\", FieldSpec.DataType.LONG, \"1:SECONDS:EPOCH\", \"1:SECONDS\")\n+                .build();\n+\n+        Map<String, Type> expectedTypeMap = new ImmutableMap.Builder<String, Type>()\n+                .put(\"singleValueIntDimension\", INTEGER)\n+                .put(\"singleValueLongDimension\", BIGINT)\n+                .put(\"singleValueFloatDimension\", DoubleType.DOUBLE)\n+                .put(\"singleValueDoubleDimension\", DoubleType.DOUBLE)\n+                .put(\"singleValueBytesDimension\", VARBINARY)\n+                .put(\"singleValueBooleanDimension\", VARCHAR)\n+                .put(\"singleValueStringDimension\", VARCHAR)\n+                .put(\"multiValueIntDimension\", VARCHAR)\n+                .put(\"multiValueLongDimension\", VARCHAR)\n+                .put(\"multiValueFloatDimension\", VARCHAR)\n+                .put(\"multiValueDoubleDimension\", VARCHAR)\n+                .put(\"multiValueBytesDimension\", VARCHAR)\n+                .put(\"multiValueBooleanDimension\", VARCHAR)\n+                .put(\"multiValueStringDimension\", VARCHAR)\n+                .put(\"intMetric\", INTEGER)\n+                .put(\"longMetric\", BIGINT)\n+                .put(\"floatMetric\", DoubleType.DOUBLE)\n+                .put(\"doubleMetric\", DoubleType.DOUBLE)\n+                .put(\"bytesMetric\", VARBINARY)\n+                .put(\"daysSinceEpoch\", DateType.DATE)\n+                .put(\"epochDayDateTime\", DateType.DATE)\n+                .put(\"epochMillisDateTime\", TimestampType.TIMESTAMP)\n+                .put(\"epochTenDayDateTime\", INTEGER)\n+                .put(\"epochSecondsDateTime\", BIGINT)\n+                .build();\n+        Map<String, String> expectedComment = new ImmutableMap.Builder<String, String>()\n+                .put(\"sd1\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueIntDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueLongDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueFloatDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueDoubleDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueBytesDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueBooleanDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"singleValueStringDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueIntDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueLongDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueFloatDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueDoubleDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueBytesDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueBooleanDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"multiValueStringDimension\", FieldSpec.FieldType.DIMENSION.name())\n+                .put(\"intMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"longMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"floatMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"doubleMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"bytesMetric\", FieldSpec.FieldType.METRIC.name())\n+                .put(\"daysSinceEpoch\", FieldSpec.FieldType.TIME.name())\n+                .put(\"epochDayDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .put(\"epochMillisDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .put(\"epochTenDayDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .put(\"epochSecondsDateTime\", FieldSpec.FieldType.DATE_TIME.name())\n+                .build();\n+\n+        List<PinotColumn> pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testPinotSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        for (PinotColumn col : pinotColumns) {\n+            assertEquals(col.getType(), expectedTypeMap.get(col.getName()), \"Failed to compare column type for field - \" + col.getName());\n+            assertEquals(col.getComment(), expectedComment.get(col.getName()), \"Failed to compare column comment for field - \" + col.getName());\n+            assertEquals(col.isNullable(), false);\n+        }\n+    }\n+\n+    @Test\n+    public void testTimeFieldInPinotSchemaToPinotColumns()\n+    {\n+        PinotConfig pinotConfig = new PinotConfig();\n+        pinotConfig.setInferDateTypeInSchema(true);\n+        pinotConfig.setInferTimestampTypeInSchema(true);\n+\n+        // Test Date\n+        Schema testSchema = new Schema.SchemaBuilder()\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, \"daysSinceEpoch\"))\n+                .build();\n+        List<PinotColumn> pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        PinotColumn col = pinotColumns.get(0);\n+        assertEquals(col.getName(), \"daysSinceEpoch\");\n+        assertEquals(col.getType(), DateType.DATE);\n+        assertEquals(col.getComment(), FieldSpec.FieldType.TIME.name());\n+\n+        testSchema = new Schema.SchemaBuilder()\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.LONG, TimeUnit.MILLISECONDS, \"millisSinceEpoch\"),\n+                        new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, \"daysSinceEpoch\"))\n+                .build();\n+        pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        col = pinotColumns.get(0);\n+        assertEquals(col.getName(), \"daysSinceEpoch\");\n+        assertEquals(col.getType(), DateType.DATE);\n+        assertEquals(col.getComment(), FieldSpec.FieldType.TIME.name());\n+\n+        // Test Timestamp\n+        testSchema = new Schema.SchemaBuilder()\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.LONG, TimeUnit.MILLISECONDS, \"millisSinceEpoch\"))\n+                .build();\n+        pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        col = pinotColumns.get(0);\n+        assertEquals(col.getName(), \"millisSinceEpoch\");\n+        assertEquals(col.getType(), TimestampType.TIMESTAMP);\n+        assertEquals(col.getComment(), FieldSpec.FieldType.TIME.name());\n+\n+        testSchema = new Schema.SchemaBuilder()\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, \"daysSinceEpoch\"),\n+                        new TimeGranularitySpec(FieldSpec.DataType.LONG, TimeUnit.MILLISECONDS, \"millisSinceEpoch\"))\n+                .build();\n+        pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        col = pinotColumns.get(0);\n+        assertEquals(col.getName(), \"millisSinceEpoch\");\n+        assertEquals(col.getType(), TimestampType.TIMESTAMP);\n+        assertEquals(col.getComment(), FieldSpec.FieldType.TIME.name());\n+\n+        // Test fallback to BIGINT\n+        testSchema = new Schema.SchemaBuilder()\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.LONG, TimeUnit.SECONDS, \"secondsSinceEpoch\"))\n+                .build();\n+        pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        col = pinotColumns.get(0);\n+        assertEquals(col.getName(), \"secondsSinceEpoch\");\n+        assertEquals(col.getType(), BIGINT);\n+        assertEquals(col.getComment(), FieldSpec.FieldType.TIME.name());\n+\n+        testSchema = new Schema.SchemaBuilder()\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.LONG, TimeUnit.MILLISECONDS, \"millisSinceEpoch\"),\n+                        new TimeGranularitySpec(FieldSpec.DataType.LONG, TimeUnit.SECONDS, \"secondsSinceEpoch\"))\n+                .build();\n+        pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        col = pinotColumns.get(0);\n+        assertEquals(col.getName(), \"secondsSinceEpoch\");\n+        assertEquals(col.getType(), BIGINT);\n+        assertEquals(col.getComment(), FieldSpec.FieldType.TIME.name());\n+\n+        testSchema = new Schema.SchemaBuilder()\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, \"daysSinceEpoch\"),\n+                        new TimeGranularitySpec(FieldSpec.DataType.LONG, TimeUnit.SECONDS, \"secondsSinceEpoch\"))\n+                .build();\n+        pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        col = pinotColumns.get(0);\n+        assertEquals(col.getName(), \"secondsSinceEpoch\");\n+        assertEquals(col.getType(), BIGINT);\n+        assertEquals(col.getComment(), FieldSpec.FieldType.TIME.name());\n+    }\n+\n+    @Test\n+    public void testConversionWithoutConfigSwitchOn()\n+    {\n+        PinotConfig pinotConfig = new PinotConfig();\n+\n+        // Test Date\n+        Schema testSchema = new Schema.SchemaBuilder()\n+                .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, \"daysSinceEpoch\"))\n+                .build();\n+        List<PinotColumn> pinotColumns = PinotColumnUtils.getPinotColumnsForPinotSchema(testSchema, pinotConfig.isInferDateTypeInSchema(), pinotConfig.isInferTimestampTypeInSchema());\n+        PinotColumn col = pinotColumns.get(0);", "originalCommit": "4077b533c4cb2080460ca6aea19a2968eb2b2176", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5ODQ5MA==", "url": "https://github.com/prestodb/presto/pull/14322#discussion_r402098490", "bodyText": "done", "author": "xiangfu0", "createdAt": "2020-04-02T07:14:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1Njc1Mg=="}], "type": "inlineReview"}, {"oid": "bac6f1ed80f66d95c01c1ab2d2dc1d281475f19b", "url": "https://github.com/prestodb/presto/commit/bac6f1ed80f66d95c01c1ab2d2dc1d281475f19b", "message": "Adding support for Date and Timestamp data type support for Pinot", "committedDate": "2020-04-03T01:39:46Z", "type": "commit"}, {"oid": "70829cdf89a1abe6457dba22608db87f9ed55328", "url": "https://github.com/prestodb/presto/commit/70829cdf89a1abe6457dba22608db87f9ed55328", "message": "Adding config to swtich on/off date type and timestamp type inferral", "committedDate": "2020-04-03T01:39:46Z", "type": "commit"}, {"oid": "f741aab57047d2333782b0ee308473f966ada0cc", "url": "https://github.com/prestodb/presto/commit/f741aab57047d2333782b0ee308473f966ada0cc", "message": "Address comments", "committedDate": "2020-04-03T01:39:46Z", "type": "commit"}, {"oid": "748fac5e23b4cc75eb36e9cadf228d101a60e513", "url": "https://github.com/prestodb/presto/commit/748fac5e23b4cc75eb36e9cadf228d101a60e513", "message": "Update Presto schema example in pinot connector doc", "committedDate": "2020-04-03T01:39:46Z", "type": "commit"}, {"oid": "748fac5e23b4cc75eb36e9cadf228d101a60e513", "url": "https://github.com/prestodb/presto/commit/748fac5e23b4cc75eb36e9cadf228d101a60e513", "message": "Update Presto schema example in pinot connector doc", "committedDate": "2020-04-03T01:39:46Z", "type": "forcePushed"}]}