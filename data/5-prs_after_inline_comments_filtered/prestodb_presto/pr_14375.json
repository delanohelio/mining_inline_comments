{"pr_number": 14375, "pr_title": "Drop presto-orc's dependency on ConnectorSession", "pr_createdAt": "2020-04-10T23:41:51Z", "pr_url": "https://github.com/prestodb/presto/pull/14375", "timeline": [{"oid": "b321854f156e5bbfc55caceeda98f6b589611fa6", "url": "https://github.com/prestodb/presto/commit/b321854f156e5bbfc55caceeda98f6b589611fa6", "message": "Drop presto-orc dependency on ConnectorSession", "committedDate": "2020-04-11T01:17:55Z", "type": "forcePushed"}, {"oid": "39e9722a344d3017d09b2d68553ed16501bac6cc", "url": "https://github.com/prestodb/presto/commit/39e9722a344d3017d09b2d68553ed16501bac6cc", "message": "Drop presto-orc dependency on ConnectorSession", "committedDate": "2020-04-11T03:29:42Z", "type": "forcePushed"}, {"oid": "78ca36727c6d6b08976149bb590fa5f1e3d31a2d", "url": "https://github.com/prestodb/presto/commit/78ca36727c6d6b08976149bb590fa5f1e3d31a2d", "message": "Send SqlFunctionProperties to operators", "committedDate": "2020-04-16T01:31:42Z", "type": "forcePushed"}, {"oid": "4b789a4a9cc342438b00b3547180e31fe4101c34", "url": "https://github.com/prestodb/presto/commit/4b789a4a9cc342438b00b3547180e31fe4101c34", "message": "Drop presto-orc dependency on ConnectorSession", "committedDate": "2020-04-16T09:14:07Z", "type": "forcePushed"}, {"oid": "48710953ee8d5ca0665516b27e7a27db02728ca1", "url": "https://github.com/prestodb/presto/commit/48710953ee8d5ca0665516b27e7a27db02728ca1", "message": "Drop presto-orc dependency on ConnectorSession", "committedDate": "2020-04-16T19:31:57Z", "type": "forcePushed"}, {"oid": "f9c2afc5633e5e64a173b18ca931b7167e62eb3b", "url": "https://github.com/prestodb/presto/commit/f9c2afc5633e5e64a173b18ca931b7167e62eb3b", "message": "Drop presto-orc dependency on ConnectorSession", "committedDate": "2020-04-16T20:59:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwODEwMQ==", "url": "https://github.com/prestodb/presto/pull/14375#discussion_r409908101", "bodyText": "move session.getSqlFunctionProperties() to its own line", "author": "highker", "createdAt": "2020-04-16T23:34:12Z", "path": "presto-hive/src/main/java/com/facebook/presto/hive/FilteringPageSource.java", "diffHunk": "@@ -119,7 +119,7 @@ public FilteringPageSource(\n         }\n         else {\n             RowExpression expression = replaceExpression(optimizedRemainingPredicate, variableToInput);\n-            this.filterFunction = new FilterFunction(session,\n+            this.filterFunction = new FilterFunction(session.getSqlFunctionProperties(),", "originalCommit": "f9c2afc5633e5e64a173b18ca931b7167e62eb3b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwOTU4Ng==", "url": "https://github.com/prestodb/presto/pull/14375#discussion_r409909586", "bodyText": "hasProperties; same for the stack var", "author": "highker", "createdAt": "2020-04-16T23:38:56Z", "path": "presto-main/src/main/java/com/facebook/presto/operator/scalar/BuiltInScalarFunctionImplementation.java", "diffHunk": "@@ -131,13 +131,13 @@ public ScalarImplementationChoice(\n \n             List<Class<?>> parameterList = methodHandle.type().parameterList();\n             boolean hasSession = false;", "originalCommit": "f9c2afc5633e5e64a173b18ca931b7167e62eb3b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkxMjI5MA==", "url": "https://github.com/prestodb/presto/pull/14375#discussion_r409912290", "bodyText": "requireNonNull", "author": "highker", "createdAt": "2020-04-16T23:47:48Z", "path": "presto-spi/src/main/java/com/facebook/presto/spi/function/SqlFunctionProperties.java", "diffHunk": "@@ -26,19 +27,28 @@\n     private final TimeZoneKey timeZoneKey;\n     private final boolean legacyTimestamp;\n     private final boolean legacyMapSubscript;\n+    private final long sessionStartTime;\n+    private final Locale sessionLocale;\n+    private String sessionUser;\n \n     private SqlFunctionProperties(\n             boolean parseDecimalLiteralAsDouble,\n             boolean legacyRowFieldOrdinalAccessEnabled,\n             TimeZoneKey timeZoneKey,\n             boolean legacyTimestamp,\n-            boolean legacyMapSubscript)\n+            boolean legacyMapSubscript,\n+            long sessionStartTime,\n+            Locale sessionLocale,\n+            String sessionUser)\n     {\n         this.parseDecimalLiteralAsDouble = parseDecimalLiteralAsDouble;\n         this.legacyRowFieldOrdinalAccessEnabled = legacyRowFieldOrdinalAccessEnabled;\n         this.timeZoneKey = requireNonNull(timeZoneKey, \"timeZoneKey is null\");\n         this.legacyTimestamp = legacyTimestamp;\n         this.legacyMapSubscript = legacyMapSubscript;\n+        this.sessionStartTime = sessionStartTime;\n+        this.sessionLocale = sessionLocale;\n+        this.sessionUser = sessionUser;", "originalCommit": "6c29b9cd85e4729b1106daabbf29654e644bfd3e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "eecfa8710f672933ee695acf5536be21425bceb7", "url": "https://github.com/prestodb/presto/commit/eecfa8710f672933ee695acf5536be21425bceb7", "message": "Drop presto-orc dependency on ConnectorSession", "committedDate": "2020-04-17T00:10:04Z", "type": "forcePushed"}, {"oid": "449640936f153283113c2a5520f5deca258c21de", "url": "https://github.com/prestodb/presto/commit/449640936f153283113c2a5520f5deca258c21de", "message": "Add sessionStartTime,sessionLocale,sessionUser to SqlFunctionProperties", "committedDate": "2020-04-17T01:43:03Z", "type": "commit"}, {"oid": "1b7711ab964cfb192869c45be1d828a665656ac9", "url": "https://github.com/prestodb/presto/commit/1b7711ab964cfb192869c45be1d828a665656ac9", "message": "Send SqlFunctionProperties to operators", "committedDate": "2020-04-17T01:43:13Z", "type": "commit"}, {"oid": "e2e00f2415a551cbd5eee90699d78e55ee5f654c", "url": "https://github.com/prestodb/presto/commit/e2e00f2415a551cbd5eee90699d78e55ee5f654c", "message": "Drop presto-orc dependency on ConnectorSession", "committedDate": "2020-04-17T01:43:14Z", "type": "commit"}, {"oid": "e2e00f2415a551cbd5eee90699d78e55ee5f654c", "url": "https://github.com/prestodb/presto/commit/e2e00f2415a551cbd5eee90699d78e55ee5f654c", "message": "Drop presto-orc dependency on ConnectorSession", "committedDate": "2020-04-17T01:43:14Z", "type": "forcePushed"}]}