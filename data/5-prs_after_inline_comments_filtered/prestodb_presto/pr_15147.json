{"pr_number": 15147, "pr_title": "Support smallint, tinyint, date type of Cassandra", "pr_createdAt": "2020-09-09T10:00:47Z", "pr_url": "https://github.com/prestodb/presto/pull/15147", "timeline": [{"oid": "f069ba457f112a6f0abef6045153bc6abab04786", "url": "https://github.com/prestodb/presto/commit/f069ba457f112a6f0abef6045153bc6abab04786", "message": "Support smallint, tinyint, date type of Cassandra", "committedDate": "2020-09-09T19:16:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTIzMzA3Ng==", "url": "https://github.com/prestodb/presto/pull/15147#discussion_r489233076", "bodyText": "better to document these types support in cassandra.rst", "author": "fgwang7w", "createdAt": "2020-09-16T07:48:01Z", "path": "presto-cassandra/src/main/java/com/facebook/presto/cassandra/CassandraType.java", "diffHunk": "@@ -127,6 +134,8 @@ public static CassandraType getCassandraType(DataType.Name name)\n                 return COUNTER;\n             case CUSTOM:\n                 return CUSTOM;\n+            case DATE:", "originalCommit": "f069ba457f112a6f0abef6045153bc6abab04786", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "30e6cf73e09518320feb7a590c69cb504a351f23", "url": "https://github.com/prestodb/presto/commit/30e6cf73e09518320feb7a590c69cb504a351f23", "message": "Support smallint, tinyint, date type of Cassandra", "committedDate": "2020-09-16T13:17:20Z", "type": "forcePushed"}, {"oid": "e5d59c47ccfecde9e87b6962f9ef4d5319fd378b", "url": "https://github.com/prestodb/presto/commit/e5d59c47ccfecde9e87b6962f9ef4d5319fd378b", "message": "Support smallint, tinyint, date type of Cassandra", "committedDate": "2020-09-16T13:17:51Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU4NTMxNw==", "url": "https://github.com/prestodb/presto/pull/15147#discussion_r489585317", "bodyText": "remove this", "author": "highker", "createdAt": "2020-09-16T16:56:15Z", "path": "presto-cassandra/src/main/java/com/facebook/presto/cassandra/CassandraPageSink.java", "diffHunk": "@@ -77,6 +84,13 @@ public CassandraPageSink(\n         this.columnTypes = ImmutableList.copyOf(requireNonNull(columnTypes, \"columnTypes is null\"));\n         this.generateUUID = generateUUID;\n \n+        if (protocolVersion.toInt() <= ProtocolVersion.V3.toInt()) {\n+            this.toCassandraDate = value -> DATE_FORMATTER.print(TimeUnit.DAYS.toMillis(value));\n+        }\n+        else {\n+            this.toCassandraDate = value -> LocalDate.fromDaysSinceEpoch(toIntExact(value));", "originalCommit": "e5d59c47ccfecde9e87b6962f9ef4d5319fd378b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "03becae5b830656a7cb1257a580040d9487d6da2", "url": "https://github.com/prestodb/presto/commit/03becae5b830656a7cb1257a580040d9487d6da2", "message": "Support smallint, tinyint, date type of Cassandra", "committedDate": "2020-09-16T18:24:43Z", "type": "commit"}, {"oid": "03becae5b830656a7cb1257a580040d9487d6da2", "url": "https://github.com/prestodb/presto/commit/03becae5b830656a7cb1257a580040d9487d6da2", "message": "Support smallint, tinyint, date type of Cassandra", "committedDate": "2020-09-16T18:24:43Z", "type": "forcePushed"}]}