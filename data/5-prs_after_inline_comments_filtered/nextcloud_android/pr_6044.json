{"pr_number": 6044, "pr_title": "New design (UI) - Round thumbnails", "pr_createdAt": "2020-05-11T10:37:51Z", "pr_url": "https://github.com/nextcloud/android/pull/6044", "timeline": [{"oid": "8779f633abd852a9bef9be622d095fe16914a365", "url": "https://github.com/nextcloud/android/commit/8779f633abd852a9bef9be622d095fe16914a365", "message": "add thumbnail corners on grid and list mode fix to 8dp\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-07T13:39:40Z", "type": "commit"}, {"oid": "09cc29b5e5e5ec2b3154c5343aee9927b90963f0", "url": "https://github.com/nextcloud/android/commit/09cc29b5e5e5ec2b3154c5343aee9927b90963f0", "message": "Add corners in shimmer effect for all modes\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-07T14:09:11Z", "type": "commit"}, {"oid": "ffcfdf9fdbcc6dafcbf9d70d90b912cefb4af91e", "url": "https://github.com/nextcloud/android/commit/ffcfdf9fdbcc6dafcbf9d70d90b912cefb4af91e", "message": "add margin in grid mode\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-08T09:03:14Z", "type": "commit"}, {"oid": "6f5e7027f46fb496ef1cc696e9fdeaa4891c2e6b", "url": "https://github.com/nextcloud/android/commit/6f5e7027f46fb496ef1cc696e9fdeaa4891c2e6b", "message": "3 Columns on grid mode\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-08T10:50:32Z", "type": "commit"}, {"oid": "89b20d61ede87772fef514869538472e24ca0cea", "url": "https://github.com/nextcloud/android/commit/89b20d61ede87772fef514869538472e24ca0cea", "message": "custom different radius for icons on the grid view and the list view\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-08T11:35:09Z", "type": "commit"}, {"oid": "f612f81fc081abd89d4caf2fcfd4e76d1c81de96", "url": "https://github.com/nextcloud/android/commit/f612f81fc081abd89d4caf2fcfd4e76d1c81de96", "message": "set new margin for icons in grid view\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-08T11:51:19Z", "type": "commit"}, {"oid": "dcb4f117ea4109520ac6b73fe74c9a07c09811dc", "url": "https://github.com/nextcloud/android/commit/dcb4f117ea4109520ac6b73fe74c9a07c09811dc", "message": "Set thumbnail shimmer height same as the thumbnail\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-08T19:03:34Z", "type": "commit"}, {"oid": "e88da96a283cc3854cc31b111f7934f491495857", "url": "https://github.com/nextcloud/android/commit/e88da96a283cc3854cc31b111f7934f491495857", "message": "remove unused imports\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-08T19:04:36Z", "type": "commit"}, {"oid": "4157a120fe1e43367f59ded60e69eebe6b9ae1ce", "url": "https://github.com/nextcloud/android/commit/4157a120fe1e43367f59ded60e69eebe6b9ae1ce", "message": "Set shimmer corner same as the thumbnail\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-08T19:07:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1Njg5Mw==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423156893", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    private Boolean isGridView = false;\n          \n          \n            \n                    private Boolean gridView = false;", "author": "AndyScherzinger", "createdAt": "2020-05-11T16:16:33Z", "path": "src/main/java/com/owncloud/android/datamodel/ThumbnailsCacheManager.java", "diffHunk": "@@ -427,24 +427,14 @@ private String getImageKey() {\n         private String mImageKey;\n         private FileDataStorageManager mStorageManager;\n         private GetMethod getMethod;\n-        private boolean roundedCorners = false;\n         private Listener mListener;\n+        private Boolean isGridView = false;", "originalCommit": "4157a120fe1e43367f59ded60e69eebe6b9ae1ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU1ODExNA==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423558114", "bodyText": "@AndyScherzinger why?\nWe think it's gridview and not a boolean. There's confusion\ngridViewEnabled, hasGridView or isGridView is better", "author": "JorisBodin", "createdAt": "2020-05-12T08:33:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1Njg5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU2NzkwNw==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423567907", "bodyText": "gridViewEnabled sounds good, hasGridView or isGridView is rather bad regarding naming conventions for accessor methods e.g. getHasGridView or isHasGridView? ;)", "author": "AndyScherzinger", "createdAt": "2020-05-12T08:47:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1Njg5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzYxMjQ4NQ==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423612485", "bodyText": "field should be gridViewEnabled and getter: isGridViewEnabled().", "author": "tobiasKaminsky", "createdAt": "2020-05-12T09:58:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1Njg5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk1NDczMA==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423954730", "bodyText": "I fixed it with gridViewEnabled", "author": "sirambd", "createdAt": "2020-05-12T18:44:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1Njg5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1NzA3MA==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423157070", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        this.isGridView = isGridView;\n          \n          \n            \n                        this.gridView = gridView;", "author": "AndyScherzinger", "createdAt": "2020-05-11T16:16:53Z", "path": "src/main/java/com/owncloud/android/datamodel/ThumbnailsCacheManager.java", "diffHunk": "@@ -458,6 +448,13 @@ public ThumbnailGenerationTask(ImageView imageView, FileDataStorageManager stora\n             mAsyncTasks = asyncTasks;\n         }\n \n+        public ThumbnailGenerationTask(ImageView imageView, FileDataStorageManager storageManager,\n+                                       Account account, List<ThumbnailGenerationTask> asyncTasks, Boolean isGridView)\n+            throws IllegalArgumentException {\n+            this(imageView, storageManager, account, asyncTasks);\n+            this.isGridView = isGridView;", "originalCommit": "4157a120fe1e43367f59ded60e69eebe6b9ae1ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1NzE4Ng==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423157186", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                                   Account account, List<ThumbnailGenerationTask> asyncTasks, Boolean isGridView)\n          \n          \n            \n                                                   Account account, List<ThumbnailGenerationTask> asyncTasks, Boolean gridView)", "author": "AndyScherzinger", "createdAt": "2020-05-11T16:17:02Z", "path": "src/main/java/com/owncloud/android/datamodel/ThumbnailsCacheManager.java", "diffHunk": "@@ -458,6 +448,13 @@ public ThumbnailGenerationTask(ImageView imageView, FileDataStorageManager stora\n             mAsyncTasks = asyncTasks;\n         }\n \n+        public ThumbnailGenerationTask(ImageView imageView, FileDataStorageManager storageManager,\n+                                       Account account, List<ThumbnailGenerationTask> asyncTasks, Boolean isGridView)", "originalCommit": "4157a120fe1e43367f59ded60e69eebe6b9ae1ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1NzMzMA==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423157330", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    if (isGridView){\n          \n          \n            \n                                    if (gridView) {", "author": "AndyScherzinger", "createdAt": "2020-05-11T16:17:15Z", "path": "src/main/java/com/owncloud/android/datamodel/ThumbnailsCacheManager.java", "diffHunk": "@@ -543,10 +540,10 @@ protected void onPostExecute(Bitmap bitmap) {\n                         tagId = String.valueOf(((TrashbinFile) mFile).getRemoteId());\n                     }\n                     if (String.valueOf(imageView.getTag()).equals(tagId)) {\n-                        if (roundedCorners) {\n-                            BitmapUtils.setRoundedBitmap(bitmap, imageView);\n+                        if (isGridView){", "originalCommit": "4157a120fe1e43367f59ded60e69eebe6b9ae1ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1OTY3NA==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423159674", "bodyText": "is the size also in the then called API a pixel or a DP value? If it is a Pixel value then the magic number \"8\" used some lines below might be read as Pixel, so to be sure it is pixel-perfect it would have to be read from a dimsvalue why Android would convert to the correct pixel value at runtime.", "author": "AndyScherzinger", "createdAt": "2020-05-11T16:20:49Z", "path": "src/main/java/com/owncloud/android/ui/adapter/OCFileListAdapter.java", "diffHunk": "@@ -721,6 +721,16 @@ public void onViewAttachedToWindow(@NonNull RecyclerView.ViewHolder holder) {\n         }\n     }\n \n+    private static void configShimmerGridImageSize(LoaderImageView thumbnailShimmer, int size){", "originalCommit": "4157a120fe1e43367f59ded60e69eebe6b9ae1ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk0NzMyMg==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423947322", "bodyText": "I replaced it with dynamically calculated values for each scale. Watch the next commit", "author": "sirambd", "createdAt": "2020-05-12T18:31:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE1OTY3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE2MDQxMQ==", "url": "https://github.com/nextcloud/android/pull/6044#discussion_r423160411", "bodyText": "This is what I meant in the dims comment above", "author": "AndyScherzinger", "createdAt": "2020-05-11T16:22:02Z", "path": "src/main/java/com/owncloud/android/utils/BitmapUtils.java", "diffHunk": "@@ -430,11 +430,20 @@ public static Bitmap drawableToBitmap(Drawable drawable) {\n     }\n \n     public static void setRoundedBitmap(Bitmap thumbnail, ImageView imageView) {\n-        Resources resources = MainApp.getAppContext().getResources();\n+        BitmapUtils.setRoundedBitmap(getResources(),\n+                                     thumbnail,\n+                                     getResources().getDimension(R.dimen.file_icon_rounded_corner_radius),\n+                                     imageView);\n+    }\n \n-        BitmapUtils.setRoundedBitmap(resources,\n+    public static void setRoundedBitmapForGridMode(Bitmap thumbnail, ImageView imageView){\n+        BitmapUtils.setRoundedBitmap(getResources(),\n                                      thumbnail,\n-                                     resources.getDimension(R.dimen.file_icon_rounded_corner_radius),\n+                                     getResources().getDimension(R.dimen.file_icon_rounded_corner_radius_for_grid_mode),", "originalCommit": "4157a120fe1e43367f59ded60e69eebe6b9ae1ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "898975b822ef12ce35a24b5b9aad865cc25d97bb", "url": "https://github.com/nextcloud/android/commit/898975b822ef12ce35a24b5b9aad865cc25d97bb", "message": "fix thumbnail dynamic size\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-12T17:09:08Z", "type": "commit"}, {"oid": "df107cc34efe8f46d8f435161e840d8c2a6859fe", "url": "https://github.com/nextcloud/android/commit/df107cc34efe8f46d8f435161e840d8c2a6859fe", "message": "remove some warnings\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-12T18:19:06Z", "type": "commit"}, {"oid": "186ce62bdbf307977e8e04397e51a10cea946c11", "url": "https://github.com/nextcloud/android/commit/186ce62bdbf307977e8e04397e51a10cea946c11", "message": "Fix grid image padding dimension name\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-12T18:23:21Z", "type": "commit"}, {"oid": "a725bbbc479c5932eac6c3657ed8621d231469b7", "url": "https://github.com/nextcloud/android/commit/a725bbbc479c5932eac6c3657ed8621d231469b7", "message": "Fix gridview enabled name\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-12T18:43:28Z", "type": "commit"}, {"oid": "cd5406b7e0cf0cc281a0b52a712b916e2d428796", "url": "https://github.com/nextcloud/android/commit/cd5406b7e0cf0cc281a0b52a712b916e2d428796", "message": "spotbugs. needless boxing of a boolean constant\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-05-12T20:44:15Z", "type": "commit"}, {"oid": "cd5406b7e0cf0cc281a0b52a712b916e2d428796", "url": "https://github.com/nextcloud/android/commit/cd5406b7e0cf0cc281a0b52a712b916e2d428796", "message": "spotbugs. needless boxing of a boolean constant\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-05-12T20:44:15Z", "type": "forcePushed"}, {"oid": "d8dace97c446677d05c55446b118a1125acccedb", "url": "https://github.com/nextcloud/android/commit/d8dace97c446677d05c55446b118a1125acccedb", "message": "Merge commit 'cd5406b7e0cf0cc281a0b52a712b916e2d428796'", "committedDate": "2020-05-12T20:44:46Z", "type": "commit"}, {"oid": "14f841300a430dcdb2bbb20ec2548e50360c15ac", "url": "https://github.com/nextcloud/android/commit/14f841300a430dcdb2bbb20ec2548e50360c15ac", "message": "Drone: update FindBugs results to reflect reduced error/warning count [skip ci]\n\nSigned-off-by: nextcloud-android-bot <android@nextcloud.com>", "committedDate": "2020-05-12T20:56:44Z", "type": "commit"}, {"oid": "fec01b6db5eca907572a7ea4d327499781d5838d", "url": "https://github.com/nextcloud/android/commit/fec01b6db5eca907572a7ea4d327499781d5838d", "message": "Fix the shimmer that had been accidentally hidden on master\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-13T11:34:26Z", "type": "commit"}, {"oid": "f5dfefc560f5ea3bfe15cb588aabd46414569a31", "url": "https://github.com/nextcloud/android/commit/f5dfefc560f5ea3bfe15cb588aabd46414569a31", "message": "Fix the star for favorite for shimmers\n\nSigned-off-by: Abdourahamane BOINAIDI <abdourahamane.boinaidi@infomaniak.com>", "committedDate": "2020-05-14T05:16:40Z", "type": "commit"}]}