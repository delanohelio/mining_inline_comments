{"pr_number": 7149, "pr_title": "Set status", "pr_createdAt": "2020-10-27T09:30:44Z", "pr_url": "https://github.com/nextcloud/android/pull/7149", "timeline": [{"oid": "a1f61ba5a432140ede42a649d3b07a534605ff86", "url": "https://github.com/nextcloud/android/commit/a1f61ba5a432140ede42a649d3b07a534605ff86", "message": "reformat!\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-27T12:35:10Z", "type": "forcePushed"}, {"oid": "adba8f04c9515659270b92200225317d0eac969f", "url": "https://github.com/nextcloud/android/commit/adba8f04c9515659270b92200225317d0eac969f", "message": "reformat!\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-27T12:36:58Z", "type": "forcePushed"}, {"oid": "45ad179e5b74d65dfbfb59e970d20c7e57e74375", "url": "https://github.com/nextcloud/android/commit/45ad179e5b74d65dfbfb59e970d20c7e57e74375", "message": "reformat!\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-27T12:42:02Z", "type": "forcePushed"}, {"oid": "f3522a8cbef67239615bc9c5ff2dbaa58cb54498", "url": "https://github.com/nextcloud/android/commit/f3522a8cbef67239615bc9c5ff2dbaa58cb54498", "message": "fix lint\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-28T12:27:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5NzgwOQ==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197809", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'com.owncloud.android.lib.resources.users.Status' due to existing import 'com.owncloud.android.lib.resources.users.Status'", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:12Z", "path": "src/main/java/com/owncloud/android/ui/asynctasks/RetrieveStatusAsyncTask.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui.asynctasks;\n+\n+import android.os.AsyncTask;\n+\n+import com.nextcloud.client.account.User;\n+import com.nextcloud.client.network.ClientFactory;\n+import com.nextcloud.common.NextcloudClient;\n+import com.nextcloud.ui.ChooseAccountDialogFragment;\n+import com.owncloud.android.lib.common.operations.RemoteOperationResult;\n+import com.owncloud.android.lib.resources.users.GetStatusRemoteOperation;\n+import com.owncloud.android.lib.resources.users.Status;\n+import com.owncloud.android.lib.resources.users.StatusType;\n+\n+import java.lang.ref.WeakReference;\n+\n+public class RetrieveStatusAsyncTask extends AsyncTask<Void, Void, Status> {\n+    private final User user;\n+    private final WeakReference<ChooseAccountDialogFragment> chooseAccountDialogFragment;\n+    private final ClientFactory clientFactory;\n+\n+    public RetrieveStatusAsyncTask(User user,\n+                                   ChooseAccountDialogFragment chooseAccountDialogFragment,\n+                                   ClientFactory clientFactory) {\n+        this.user = user;\n+        this.chooseAccountDialogFragment = new WeakReference<>(chooseAccountDialogFragment);\n+        this.clientFactory = clientFactory;\n+    }\n+\n+    @Override\n+    protected com.owncloud.android.lib.resources.users.Status doInBackground(Void... voids) {\n+        try {\n+            NextcloudClient client = clientFactory.createNextcloudClient(user);\n+            RemoteOperationResult result = new GetStatusRemoteOperation().execute(client);\n+\n+            return (com.owncloud.android.lib.resources.users.Status) result.getSingleData();", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5NzgyNA==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197824", "bodyText": "Codacy found an issue: Assigning an Object to null is a code smell.  Consider refactoring.", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:13Z", "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui;\n+\n+import android.content.Context;\n+import android.graphics.Canvas;\n+import android.graphics.Color;\n+import android.graphics.ColorFilter;\n+import android.graphics.Paint;\n+import android.graphics.PixelFormat;\n+import android.graphics.drawable.Drawable;\n+import android.text.TextUtils;\n+\n+import com.owncloud.android.R;\n+import com.owncloud.android.lib.resources.users.Status;\n+\n+import androidx.annotation.DrawableRes;\n+import androidx.annotation.NonNull;\n+import androidx.core.content.res.ResourcesCompat;\n+import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;\n+\n+/**\n+ * A Drawable object that draws a status\n+ */\n+@SuppressFBWarnings(\"PME_POOR_MANS_ENUM\")\n+public class StatusDrawable extends Drawable {\n+    private String text;\n+    private @DrawableRes int icon = -1;\n+    private Paint textPaint;\n+    private Paint backgroundPaint;\n+    private final float radius;\n+    private Context context;\n+    private final static int whiteBackground = Color.argb(200, 255, 255, 255);\n+    private final static int onlineStatus = Color.argb(255, 73, 179, 130);\n+\n+    public StatusDrawable(Status status, float statusSize, Context context) {\n+        backgroundPaint = new Paint();\n+        backgroundPaint.setStyle(Paint.Style.FILL);\n+        backgroundPaint.setAntiAlias(true);\n+\n+        radius = statusSize;\n+\n+        if (TextUtils.isEmpty(status.getIcon())) {\n+            switch (status.getStatus()) {\n+                case DND:\n+                    icon = R.drawable.ic_user_status_dnd;\n+                    backgroundPaint.setColor(whiteBackground);\n+                    this.context = context;\n+                    break;\n+\n+                case ONLINE:\n+                    backgroundPaint.setColor(onlineStatus);\n+                    break;\n+\n+                case AWAY:\n+                    icon = R.drawable.ic_user_status_away;\n+                    backgroundPaint.setColor(whiteBackground);\n+                    this.context = context;\n+                    break;\n+\n+                default:\n+                    // do not show\n+                    backgroundPaint = null;", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5NzgzMw==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197833", "bodyText": "Codacy found an issue: Avoid instantiating new objects inside loops", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:14Z", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -229,21 +243,35 @@ private Cursor searchForUsersOrGroups(Uri uri) {\n                 Iterator<JSONObject> namesIt = names.iterator();\n                 JSONObject item;\n                 String displayName;\n-                int icon = 0;\n+                String subline = null;\n+                Object icon = 0;\n                 Uri dataUri;\n                 int count = 0;\n                 while (namesIt.hasNext()) {\n                     item = namesIt.next();\n                     dataUri = null;\n                     displayName = null;\n                     String userName = item.getString(GetShareesRemoteOperation.PROPERTY_LABEL);\n+                    String name = item.isNull(\"name\") ? \"\" : item.getString(\"name\");\n                     JSONObject value = item.getJSONObject(GetShareesRemoteOperation.NODE_VALUE);\n                     ShareType type = ShareType.fromValue(value.getInt(GetShareesRemoteOperation.PROPERTY_SHARE_TYPE));\n                     String shareWith = value.getString(GetShareesRemoteOperation.PROPERTY_SHARE_WITH);\n \n+                    Status status;\n+                    JSONObject statusObject = item.optJSONObject(\"status\");\n+\n+                    if (statusObject != null) {\n+                        status = new Status(StatusType.valueOf(statusObject.getString(\"status\")),\n+                                            statusObject.isNull(\"message\") ? \"\" : statusObject.getString(\"message\"),\n+                                            statusObject.isNull(\"icon\") ? \"\" : statusObject.getString(\"icon\"),\n+                                            statusObject.isNull(\"clearAt\") ? -1 : statusObject.getLong(\"clearAt\"));\n+                    } else {\n+                        status = new Status(StatusType.OFFLINE, \"\", \"\", -1);", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5Nzg0Mg==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197842", "bodyText": "Codacy found an issue: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:15Z", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -324,6 +370,59 @@ public int update(@NonNull Uri uri, ContentValues values, String selection, Stri\n         return 0;\n     }\n \n+    @Nullable\n+    @Override\n+    @SuppressFBWarnings(\"IOI_USE_OF_FILE_STREAM_CONSTRUCTORS\") // TODO remove with API26\n+    public ParcelFileDescriptor openFile(@NonNull Uri uri, @NonNull String mode) throws FileNotFoundException {\n+        ArbitraryDataProvider arbitraryDataProvider = new ArbitraryDataProvider(getContext().getContentResolver());\n+\n+        String userId = uri.getQueryParameter(\"shareWith\");\n+        String displayName = uri.getQueryParameter(\"displayName\");\n+        String accountName = accountManager.getUser().getAccountName();\n+        String serverName = accountName.substring(accountName.lastIndexOf('@') + 1);\n+\n+        String eTag = arbitraryDataProvider.getValue(userId + \"@\" + serverName, ThumbnailsCacheManager.AVATAR);\n+        String avatarKey = \"a_\" + userId + \"_\" + serverName + \"_\" + eTag;\n+\n+        StatusType status = StatusType.valueOf(uri.getQueryParameter(\"status\"));\n+        String icon = uri.getQueryParameter(\"icon\");\n+\n+        Bitmap avatarBitmap = ThumbnailsCacheManager.getBitmapFromDiskCache(avatarKey);\n+\n+        if (avatarBitmap == null) {\n+            float avatarRadius = getContext().getResources().getDimension(R.dimen.list_item_avatar_icon_radius);\n+            avatarBitmap = BitmapUtils.drawableToBitmap(TextDrawable.createNamedAvatar(displayName, avatarRadius));\n+        }\n+\n+        Bitmap avatar = BitmapUtils.createAvatarWithStatus(avatarBitmap, status, icon, getContext());\n+\n+        // create a file to write bitmap data\n+        File f = new File(getContext().getCacheDir(), \"test\");\n+        try {\n+            if (!f.createNewFile()) {\n+                throw new IllegalStateException(\"File could not be created!\");\n+            }\n+\n+            //Convert bitmap to byte array\n+            ByteArrayOutputStream bos = new ByteArrayOutputStream();\n+\n+            avatar.compress(Bitmap.CompressFormat.PNG, 90, bos);\n+            byte[] bitmapData = bos.toByteArray();\n+\n+            //write the bytes in file\n+            try (FileOutputStream fos = new FileOutputStream(f)) {", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5Nzg1Mw==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197853", "bodyText": "Codacy found an issue: Assigning an Object to null is a code smell.  Consider refactoring.", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:16Z", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -254,30 +282,47 @@ private Cursor searchForUsersOrGroups(Uri uri) {\n                                 dataUri = Uri.withAppendedPath(remoteBaseUri, shareWith);\n \n                                 if (userName.equals(shareWith)) {\n-                                    displayName = getContext().getString(R.string.share_remote_clarification, userName);\n+                                    displayName = name;\n+                                    subline = getContext().getString(R.string.remote);\n                                 } else {\n                                     String[] uriSplitted = shareWith.split(\"@\");\n-                                    displayName = getContext().getString(R.string.share_known_remote_clarification,\n-                                                                         userName, uriSplitted[uriSplitted.length - 1]);\n+                                    displayName = name;\n+                                    subline = getContext().getString(R.string.share_known_remote_on_clarification,\n+                                                                     uriSplitted[uriSplitted.length - 1]);\n                                 }\n                             }\n                             break;\n \n                         case USER:\n                             displayName = userName;\n-                            icon = R.drawable.ic_user;\n+                            subline = status.getMessage().isEmpty() ? null : status.getMessage();", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5Nzg2NQ==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197865", "bodyText": "Codacy found an issue: Avoid using redundant field initializer for 'bigText'", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:17Z", "path": "src/main/java/com/owncloud/android/ui/TextDrawable.java", "diffHunk": "@@ -65,6 +64,8 @@\n      */\n     private float mRadius;\n \n+    private boolean bigText = false;", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5Nzg3MA==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197870", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'com.owncloud.android.lib.resources.users.Status' due to existing import 'com.owncloud.android.lib.resources.users.Status'", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:18Z", "path": "src/main/java/com/owncloud/android/ui/asynctasks/RetrieveStatusAsyncTask.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui.asynctasks;\n+\n+import android.os.AsyncTask;\n+\n+import com.nextcloud.client.account.User;\n+import com.nextcloud.client.network.ClientFactory;\n+import com.nextcloud.common.NextcloudClient;\n+import com.nextcloud.ui.ChooseAccountDialogFragment;\n+import com.owncloud.android.lib.common.operations.RemoteOperationResult;\n+import com.owncloud.android.lib.resources.users.GetStatusRemoteOperation;\n+import com.owncloud.android.lib.resources.users.Status;\n+import com.owncloud.android.lib.resources.users.StatusType;\n+\n+import java.lang.ref.WeakReference;\n+\n+public class RetrieveStatusAsyncTask extends AsyncTask<Void, Void, Status> {\n+    private final User user;\n+    private final WeakReference<ChooseAccountDialogFragment> chooseAccountDialogFragment;\n+    private final ClientFactory clientFactory;\n+\n+    public RetrieveStatusAsyncTask(User user,\n+                                   ChooseAccountDialogFragment chooseAccountDialogFragment,\n+                                   ClientFactory clientFactory) {\n+        this.user = user;\n+        this.chooseAccountDialogFragment = new WeakReference<>(chooseAccountDialogFragment);\n+        this.clientFactory = clientFactory;\n+    }\n+\n+    @Override\n+    protected com.owncloud.android.lib.resources.users.Status doInBackground(Void... voids) {\n+        try {\n+            NextcloudClient client = clientFactory.createNextcloudClient(user);\n+            RemoteOperationResult result = new GetStatusRemoteOperation().execute(client);\n+\n+            return (com.owncloud.android.lib.resources.users.Status) result.getSingleData();\n+\n+        } catch (ClientFactory.CreationException e) {\n+            return new com.owncloud.android.lib.resources.users.Status(StatusType.OFFLINE, \"\", \"\", -1);\n+        }\n+    }\n+\n+    @Override\n+    protected void onPostExecute(com.owncloud.android.lib.resources.users.Status status) {", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5Nzg3Ng==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197876", "bodyText": "Codacy found an issue: Avoid instantiating new objects inside loops", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:19Z", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -229,21 +243,35 @@ private Cursor searchForUsersOrGroups(Uri uri) {\n                 Iterator<JSONObject> namesIt = names.iterator();\n                 JSONObject item;\n                 String displayName;\n-                int icon = 0;\n+                String subline = null;\n+                Object icon = 0;\n                 Uri dataUri;\n                 int count = 0;\n                 while (namesIt.hasNext()) {\n                     item = namesIt.next();\n                     dataUri = null;\n                     displayName = null;\n                     String userName = item.getString(GetShareesRemoteOperation.PROPERTY_LABEL);\n+                    String name = item.isNull(\"name\") ? \"\" : item.getString(\"name\");\n                     JSONObject value = item.getJSONObject(GetShareesRemoteOperation.NODE_VALUE);\n                     ShareType type = ShareType.fromValue(value.getInt(GetShareesRemoteOperation.PROPERTY_SHARE_TYPE));\n                     String shareWith = value.getString(GetShareesRemoteOperation.PROPERTY_SHARE_WITH);\n \n+                    Status status;\n+                    JSONObject statusObject = item.optJSONObject(\"status\");\n+\n+                    if (statusObject != null) {\n+                        status = new Status(StatusType.valueOf(statusObject.getString(\"status\")),", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5Nzg4MQ==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197881", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'com.owncloud.android.lib.resources.users.Status' due to existing import 'com.owncloud.android.lib.resources.users.Status'", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:20Z", "path": "src/main/java/com/owncloud/android/ui/asynctasks/RetrieveStatusAsyncTask.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui.asynctasks;\n+\n+import android.os.AsyncTask;\n+\n+import com.nextcloud.client.account.User;\n+import com.nextcloud.client.network.ClientFactory;\n+import com.nextcloud.common.NextcloudClient;\n+import com.nextcloud.ui.ChooseAccountDialogFragment;\n+import com.owncloud.android.lib.common.operations.RemoteOperationResult;\n+import com.owncloud.android.lib.resources.users.GetStatusRemoteOperation;\n+import com.owncloud.android.lib.resources.users.Status;\n+import com.owncloud.android.lib.resources.users.StatusType;\n+\n+import java.lang.ref.WeakReference;\n+\n+public class RetrieveStatusAsyncTask extends AsyncTask<Void, Void, Status> {\n+    private final User user;\n+    private final WeakReference<ChooseAccountDialogFragment> chooseAccountDialogFragment;\n+    private final ClientFactory clientFactory;\n+\n+    public RetrieveStatusAsyncTask(User user,\n+                                   ChooseAccountDialogFragment chooseAccountDialogFragment,\n+                                   ClientFactory clientFactory) {\n+        this.user = user;\n+        this.chooseAccountDialogFragment = new WeakReference<>(chooseAccountDialogFragment);\n+        this.clientFactory = clientFactory;\n+    }\n+\n+    @Override\n+    protected com.owncloud.android.lib.resources.users.Status doInBackground(Void... voids) {", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE5Nzg5MA==", "url": "https://github.com/nextcloud/android/pull/7149#discussion_r514197890", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'com.owncloud.android.lib.resources.users.Status' due to existing import 'com.owncloud.android.lib.resources.users.Status'", "author": "nextcloud-android-bot", "createdAt": "2020-10-29T11:48:21Z", "path": "src/main/java/com/owncloud/android/ui/asynctasks/RetrieveStatusAsyncTask.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui.asynctasks;\n+\n+import android.os.AsyncTask;\n+\n+import com.nextcloud.client.account.User;\n+import com.nextcloud.client.network.ClientFactory;\n+import com.nextcloud.common.NextcloudClient;\n+import com.nextcloud.ui.ChooseAccountDialogFragment;\n+import com.owncloud.android.lib.common.operations.RemoteOperationResult;\n+import com.owncloud.android.lib.resources.users.GetStatusRemoteOperation;\n+import com.owncloud.android.lib.resources.users.Status;\n+import com.owncloud.android.lib.resources.users.StatusType;\n+\n+import java.lang.ref.WeakReference;\n+\n+public class RetrieveStatusAsyncTask extends AsyncTask<Void, Void, Status> {\n+    private final User user;\n+    private final WeakReference<ChooseAccountDialogFragment> chooseAccountDialogFragment;\n+    private final ClientFactory clientFactory;\n+\n+    public RetrieveStatusAsyncTask(User user,\n+                                   ChooseAccountDialogFragment chooseAccountDialogFragment,\n+                                   ClientFactory clientFactory) {\n+        this.user = user;\n+        this.chooseAccountDialogFragment = new WeakReference<>(chooseAccountDialogFragment);\n+        this.clientFactory = clientFactory;\n+    }\n+\n+    @Override\n+    protected com.owncloud.android.lib.resources.users.Status doInBackground(Void... voids) {\n+        try {\n+            NextcloudClient client = clientFactory.createNextcloudClient(user);\n+            RemoteOperationResult result = new GetStatusRemoteOperation().execute(client);\n+\n+            return (com.owncloud.android.lib.resources.users.Status) result.getSingleData();\n+\n+        } catch (ClientFactory.CreationException e) {\n+            return new com.owncloud.android.lib.resources.users.Status(StatusType.OFFLINE, \"\", \"\", -1);", "originalCommit": "75d71b46d39548b3865c987dcd1498ea0e8ef4eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dbd9e6fe9b0738c31763931100e59c47ad2d0350", "url": "https://github.com/nextcloud/android/commit/dbd9e6fe9b0738c31763931100e59c47ad2d0350", "message": "Add status to sharee\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:01Z", "type": "commit"}, {"oid": "d642da450f83aad026a93bd9f89845f2ab672b6d", "url": "https://github.com/nextcloud/android/commit/d642da450f83aad026a93bd9f89845f2ab672b6d", "message": "Remove unneeded empty lines\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T19:27:02Z", "type": "commit"}, {"oid": "4d5eb127f80b0b86b738994c442366a9f6e55d16", "url": "https://github.com/nextcloud/android/commit/4d5eb127f80b0b86b738994c442366a9f6e55d16", "message": "user proper license header format\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T19:27:03Z", "type": "commit"}, {"oid": "96680fdeca0f586977532d1e144557d73dcd644f", "url": "https://github.com/nextcloud/android/commit/96680fdeca0f586977532d1e144557d73dcd644f", "message": "proper kotlin enum naming pattern\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T19:27:03Z", "type": "commit"}, {"oid": "711b2334b053ea825b3b85e7ed70edcd5d09eb57", "url": "https://github.com/nextcloud/android/commit/711b2334b053ea825b3b85e7ed70edcd5d09eb57", "message": "remove var prefixes\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T19:27:04Z", "type": "commit"}, {"oid": "9741cf21c97c75a928415baea88768f860872616", "url": "https://github.com/nextcloud/android/commit/9741cf21c97c75a928415baea88768f860872616", "message": "improve detekt score\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T19:27:05Z", "type": "commit"}, {"oid": "4fed61d3f33cefa1054a2f463fea1bda58540006", "url": "https://github.com/nextcloud/android/commit/4fed61d3f33cefa1054a2f463fea1bda58540006", "message": "proper comment formatting\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T19:27:05Z", "type": "commit"}, {"oid": "dcc246fd58bda5a4c0df55dbfeaa1dca9077f01d", "url": "https://github.com/nextcloud/android/commit/dcc246fd58bda5a4c0df55dbfeaa1dca9077f01d", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:06Z", "type": "commit"}, {"oid": "0709076e54f706cd300268430cf0111baabd123d", "url": "https://github.com/nextcloud/android/commit/0709076e54f706cd300268430cf0111baabd123d", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:07Z", "type": "commit"}, {"oid": "c09fa8c94459da824fd212db398b1574f38e081e", "url": "https://github.com/nextcloud/android/commit/c09fa8c94459da824fd212db398b1574f38e081e", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:08Z", "type": "commit"}, {"oid": "0bb5ad643f03310bff5a996224ce8f17620414bd", "url": "https://github.com/nextcloud/android/commit/0bb5ad643f03310bff5a996224ce8f17620414bd", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:09Z", "type": "commit"}, {"oid": "bff08bbc1786a4250b366cac650c49930f720e96", "url": "https://github.com/nextcloud/android/commit/bff08bbc1786a4250b366cac650c49930f720e96", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:09Z", "type": "commit"}, {"oid": "ad5ca22e23d803679a2bec89d8fc64b64b895720", "url": "https://github.com/nextcloud/android/commit/ad5ca22e23d803679a2bec89d8fc64b64b895720", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:10Z", "type": "commit"}, {"oid": "fcb0147d71ba8206b1bd9597d1de94c0870aa796", "url": "https://github.com/nextcloud/android/commit/fcb0147d71ba8206b1bd9597d1de94c0870aa796", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:11Z", "type": "commit"}, {"oid": "f802cb3122c92fc5e1962499304296922e887e42", "url": "https://github.com/nextcloud/android/commit/f802cb3122c92fc5e1962499304296922e887e42", "message": "improved layouting\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T19:27:12Z", "type": "commit"}, {"oid": "4244a50c52595e3278256783943412a1417ca2ca", "url": "https://github.com/nextcloud/android/commit/4244a50c52595e3278256783943412a1417ca2ca", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:13Z", "type": "commit"}, {"oid": "21fbb68a2b170da40b26ca39b222b7291d14a6a2", "url": "https://github.com/nextcloud/android/commit/21fbb68a2b170da40b26ca39b222b7291d14a6a2", "message": "emoji\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:13Z", "type": "commit"}, {"oid": "e8cfaaf22f2eccfe86e85ae6900a0c405fd5552d", "url": "https://github.com/nextcloud/android/commit/e8cfaaf22f2eccfe86e85ae6900a0c405fd5552d", "message": "Spotbugs\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:27:18Z", "type": "forcePushed"}, {"oid": "fba718ad84cc399f7b056aa67464d94efadfa870", "url": "https://github.com/nextcloud/android/commit/fba718ad84cc399f7b056aa67464d94efadfa870", "message": "set texts and move to view binding\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T19:28:44Z", "type": "commit"}, {"oid": "8369e4c413ccafb5366f3f3f50f087b9e447890e", "url": "https://github.com/nextcloud/android/commit/8369e4c413ccafb5366f3f3f50f087b9e447890e", "message": "optimize status dialog layout, add status active visual\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T19:28:45Z", "type": "commit"}, {"oid": "7d7a80af347f0dca822cce87adbe5eeba470aaaa", "url": "https://github.com/nextcloud/android/commit/7d7a80af347f0dca822cce87adbe5eeba470aaaa", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:28:46Z", "type": "commit"}, {"oid": "0b8cf615e668d8b42599d5f1a7ad4f1cbdc264fa", "url": "https://github.com/nextcloud/android/commit/0b8cf615e668d8b42599d5f1a7ad4f1cbdc264fa", "message": "fix lint\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:28:47Z", "type": "commit"}, {"oid": "6d1d4a732d510bc553521daba3b3d670ad5e552f", "url": "https://github.com/nextcloud/android/commit/6d1d4a732d510bc553521daba3b3d670ad5e552f", "message": "Spotbugs\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:28:48Z", "type": "commit"}, {"oid": "6d1d4a732d510bc553521daba3b3d670ad5e552f", "url": "https://github.com/nextcloud/android/commit/6d1d4a732d510bc553521daba3b3d670ad5e552f", "message": "Spotbugs\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-10-29T19:28:48Z", "type": "forcePushed"}, {"oid": "a542bee93fc146b3de677c13738b598a11a59f9f", "url": "https://github.com/nextcloud/android/commit/a542bee93fc146b3de677c13738b598a11a59f9f", "message": "add dark screenshots\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-29T21:55:24Z", "type": "commit"}]}