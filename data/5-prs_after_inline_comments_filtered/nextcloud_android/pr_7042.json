{"pr_number": 7042, "pr_title": "Auto Upload: Ignore folders that have no-images or seem to be music albums", "pr_createdAt": "2020-10-02T08:35:22Z", "pr_url": "https://github.com/nextcloud/android/pull/7042", "timeline": [{"oid": "70c96b3993b5d12946e2ddfd57d86856c5b06793", "url": "https://github.com/nextcloud/android/commit/70c96b3993b5d12946e2ddfd57d86856c5b06793", "message": "ignore image-media folders that have no-images _or_ seem to be music albums (just a single cover art image)\nblock detection notification and hide in lists\n\nrelated to #3239\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-02T08:51:55Z", "type": "forcePushed"}, {"oid": "4db62933d5d2813c4a87fb15409cb251246b784e", "url": "https://github.com/nextcloud/android/commit/4db62933d5d2813c4a87fb15409cb251246b784e", "message": "ignore image-media folders that have no-images _or_ seem to be music albums (just a single cover art image)\nblock detection notification and hide in lists\n\nrelated to #3239\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-02T08:54:33Z", "type": "forcePushed"}, {"oid": "d4bcba2c0c005dff8a318690020bd5769e862e6b", "url": "https://github.com/nextcloud/android/commit/d4bcba2c0c005dff8a318690020bd5769e862e6b", "message": "ignore image-media folders that have no-images _or_ seem to be music albums (just a single cover art image)\nblock detection notification and hide in lists\n\nrelated to #3239\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-02T09:25:17Z", "type": "forcePushed"}, {"oid": "413477e03c3d48bed84bce8ab3f235130f5e667c", "url": "https://github.com/nextcloud/android/commit/413477e03c3d48bed84bce8ab3f235130f5e667c", "message": "ignore image-media folders that have no-images _or_ seem to be music albums (just a single cover art image)\nblock detection notification and hide in lists\n\nrelated to #3239\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-02T10:07:29Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc1MDI0NQ==", "url": "https://github.com/nextcloud/android/pull/7042#discussion_r498750245", "bodyText": "I am unsure if this handles all special cases correctly.\nnew File(path).getName() will work, though I have no idea if needed or if there is a performance drawback", "author": "tobiasKaminsky", "createdAt": "2020-10-02T10:49:04Z", "path": "src/main/java/com/owncloud/android/utils/FileUtil.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Nextcloud Android client application\n+ *\n+ * @author Andy Scherzinger\n+ * Copyright (C) 2020 Andy Scherzinger\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.utils;\n+\n+import com.owncloud.android.lib.resources.files.FileUtils;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+public final class FileUtil {\n+\n+    private FileUtil() {\n+        // utility class -> private constructor\n+    }\n+\n+    public static @NonNull String getFilenameFromPathString(@Nullable String filePath) {\n+        if (filePath != null) {\n+            return filePath.substring(filePath.lastIndexOf(FileUtils.PATH_SEPARATOR) + 1);", "originalCommit": "413477e03c3d48bed84bce8ab3f235130f5e667c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc2MzE5Nw==", "url": "https://github.com/nextcloud/android/pull/7042#discussion_r498763197", "bodyText": "yeah, also not sure, so let's try new file variant", "author": "AndyScherzinger", "createdAt": "2020-10-02T11:23:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc1MDI0NQ=="}], "type": "inlineReview"}, {"oid": "f2505b9253267ba8a51422f1a5e82a6b48aae491", "url": "https://github.com/nextcloud/android/commit/f2505b9253267ba8a51422f1a5e82a6b48aae491", "message": "ignore image-media folders that have no-images _or_ seem to be music albums (just a single cover art image)\nblock detection notification and hide in lists\n\nrelated to #3239\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-02T11:18:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg5NDIyMg==", "url": "https://github.com/nextcloud/android/pull/7042#discussion_r498894222", "bodyText": "Can you add \"in case of null or path is a a folder it returns \"\" \"", "author": "tobiasKaminsky", "createdAt": "2020-10-02T15:30:20Z", "path": "src/main/java/com/owncloud/android/utils/FileUtil.java", "diffHunk": "@@ -34,7 +34,12 @@ private FileUtil() {\n \n     public static @NonNull String getFilenameFromPathString(@Nullable String filePath) {", "originalCommit": "9e9d16f627d6c2b356d3939b9eaf19867efe0d74", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODkxMTQxMw==", "url": "https://github.com/nextcloud/android/pull/7042#discussion_r498911413", "bodyText": "sure thing!", "author": "AndyScherzinger", "createdAt": "2020-10-02T16:01:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg5NDIyMg=="}], "type": "inlineReview"}, {"oid": "dfc82fef63c56591332cadeb36dd3b3842cb6b64", "url": "https://github.com/nextcloud/android/commit/dfc82fef63c56591332cadeb36dd3b3842cb6b64", "message": "shorten tests and adding javadoc for public method\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-02T16:19:27Z", "type": "forcePushed"}, {"oid": "c9fded2b17cd5c09954753edb98b33311a444ce9", "url": "https://github.com/nextcloud/android/commit/c9fded2b17cd5c09954753edb98b33311a444ce9", "message": "shorten tests and adding javadoc for public method\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-02T17:42:48Z", "type": "forcePushed"}, {"oid": "d8b3509e3d6f36f07e7551949bb08bdfbefeba63", "url": "https://github.com/nextcloud/android/commit/d8b3509e3d6f36f07e7551949bb08bdfbefeba63", "message": "shorten tests and adding javadoc for public method\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-02T20:49:37Z", "type": "forcePushed"}, {"oid": "875aa1caa5c4e9ab5661e3fcba74539f489208b1", "url": "https://github.com/nextcloud/android/commit/875aa1caa5c4e9ab5661e3fcba74539f489208b1", "message": "shorten tests and adding javadoc for public method\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-02T20:54:20Z", "type": "forcePushed"}, {"oid": "b27a2e37624a87f397dd6094f4f2639deb56f609", "url": "https://github.com/nextcloud/android/commit/b27a2e37624a87f397dd6094f4f2639deb56f609", "message": "shorten tests and adding javadoc for public method\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-06T09:35:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI5MDk5Nw==", "url": "https://github.com/nextcloud/android/pull/7042#discussion_r500290997", "bodyText": "Can we have also tests for this class? \ud83d\udc99\ud83d\udc99\ud83d\udc99", "author": "tobiasKaminsky", "createdAt": "2020-10-06T13:45:08Z", "path": "src/main/java/com/owncloud/android/utils/SyncedFolderUtils.java", "diffHunk": "@@ -0,0 +1,202 @@\n+/*\n+ * Nextcloud Android client application\n+ *\n+ * @author Andy Scherzinger\n+ * Copyright (C) 2020 Andy Scherzinger\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package com.owncloud.android.utils;\n+\n+import com.owncloud.android.datamodel.MediaFolder;\n+import com.owncloud.android.datamodel.MediaFolderType;\n+import com.owncloud.android.datamodel.SyncedFolder;\n+\n+import java.io.File;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Locale;\n+import java.util.Set;\n+\n+import androidx.annotation.Nullable;\n+\n+/**\n+ * Utility class with methods for processing synced folders.\n+ */\n+public final class SyncedFolderUtils {", "originalCommit": "b27a2e37624a87f397dd6094f4f2639deb56f609", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk3MDQ2MQ==", "url": "https://github.com/nextcloud/android/pull/7042#discussion_r500970461", "bodyText": "DONE \ud83d\udc4d", "author": "AndyScherzinger", "createdAt": "2020-10-07T12:27:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI5MDk5Nw=="}], "type": "inlineReview"}, {"oid": "8a5504bcb0032088bd0a74d1170962a73df92b41", "url": "https://github.com/nextcloud/android/commit/8a5504bcb0032088bd0a74d1170962a73df92b41", "message": "add tests\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-07T12:26:32Z", "type": "forcePushed"}, {"oid": "d0f4445c7915d63deab17962d0838a2e10d8cd3e", "url": "https://github.com/nextcloud/android/commit/d0f4445c7915d63deab17962d0838a2e10d8cd3e", "message": "add tests\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-07T12:29:40Z", "type": "forcePushed"}, {"oid": "00ec8ed8793ff25a7e53c6d4e025b16ba7066956", "url": "https://github.com/nextcloud/android/commit/00ec8ed8793ff25a7e53c6d4e025b16ba7066956", "message": "add tests\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-13T16:00:56Z", "type": "forcePushed"}, {"oid": "2466367a8728e954780435dec85f35b3a46a350f", "url": "https://github.com/nextcloud/android/commit/2466367a8728e954780435dec85f35b3a46a350f", "message": "ignore thumbnauil folders for detection/display - related to #7085\nignore thumbdata files for detection - related to #3177\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-14T13:15:56Z", "type": "forcePushed"}, {"oid": "e10c68395d0358fc470cbfa5c1c08ee04635f452", "url": "https://github.com/nextcloud/android/commit/e10c68395d0358fc470cbfa5c1c08ee04635f452", "message": "ignore thumbnail-related data on auto upload\n\nResolves #7085\nResolves #4350\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-14T13:48:31Z", "type": "forcePushed"}, {"oid": "75997d74b7dce648e91b5b48d1cc9406994e3e8a", "url": "https://github.com/nextcloud/android/commit/75997d74b7dce648e91b5b48d1cc9406994e3e8a", "message": "ignore thumbnail-related data on auto upload\n\nResolves #7085\nResolves #4350\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-14T13:51:13Z", "type": "forcePushed"}, {"oid": "24b7b5e18f3191613f07ce759b6cd98ea1f59c2d", "url": "https://github.com/nextcloud/android/commit/24b7b5e18f3191613f07ce759b6cd98ea1f59c2d", "message": "ignore thumbnail-related data on auto upload\n\nResolves #7085\nResolves #4350\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-14T13:57:18Z", "type": "forcePushed"}, {"oid": "f5f1b5d28d43c0515ca5f82602be0434635dbc7c", "url": "https://github.com/nextcloud/android/commit/f5f1b5d28d43c0515ca5f82602be0434635dbc7c", "message": "ignore thumbnail-related data on auto upload\n\nResolves #7085\nResolves #4350\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-14T14:05:08Z", "type": "forcePushed"}, {"oid": "b665bc6aad5354ca4c0513aa136c0723a9ba48ff", "url": "https://github.com/nextcloud/android/commit/b665bc6aad5354ca4c0513aa136c0723a9ba48ff", "message": "invert folder name filter check, move to standard Android view binding\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T06:24:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3Njg3Ng==", "url": "https://github.com/nextcloud/android/pull/7042#discussion_r505276876", "bodyText": "You can use TextUtils.isEmpty(), which checks for null and empty\n(it requires then tests to be run in androidTest )", "author": "tobiasKaminsky", "createdAt": "2020-10-15T07:39:13Z", "path": "src/main/java/com/owncloud/android/utils/FileUtil.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/*\n+ * Nextcloud Android client application\n+ *\n+ * @author Andy Scherzinger\n+ * Copyright (C) 2020 Andy Scherzinger\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.utils;\n+\n+import java.io.File;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+public final class FileUtil {\n+    private static final int EMPTY_LENGTH = 0;\n+\n+    private FileUtil() {\n+        // utility class -> private constructor\n+    }\n+\n+    /**\n+     * returns the file name of a given path.\n+     *\n+     * @param filePath (absolute) file path\n+     * @return the filename including its file extension, <code>empty String</code> for invalid input values\n+     */\n+    public static @NonNull\n+    String getFilenameFromPathString(@Nullable String filePath) {\n+        if (filePath != null && filePath.length() > EMPTY_LENGTH) {", "originalCommit": "ba7d61a0d83d18edf15274ab7dfdb3c7d0898d71", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTMyMzE2NQ==", "url": "https://github.com/nextcloud/android/pull/7042#discussion_r505323165", "bodyText": "Changed it, the tests already run in androidTest \ud83d\udc4d", "author": "AndyScherzinger", "createdAt": "2020-10-15T08:17:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3Njg3Ng=="}], "type": "inlineReview"}, {"oid": "cbf63b9c2bd7765ea7b1487a24aa206e1d36b0e4", "url": "https://github.com/nextcloud/android/commit/cbf63b9c2bd7765ea7b1487a24aa206e1d36b0e4", "message": "utilze TextUtils, remove unused code\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T08:17:00Z", "type": "forcePushed"}, {"oid": "2c5f5e43a7d86472c61e7c9f02bcb0cc1720e1c7", "url": "https://github.com/nextcloud/android/commit/2c5f5e43a7d86472c61e7c9f02bcb0cc1720e1c7", "message": "ignore image-media folders that have no-images _or_ seem to be music albums (just a single cover art image)\nblock detection notification and hide in lists\n\nrelated to #3239\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T09:35:51Z", "type": "commit"}, {"oid": "2fe33692107146e21baddfae39aa2c8eba831084", "url": "https://github.com/nextcloud/android/commit/2fe33692107146e21baddfae39aa2c8eba831084", "message": "add tests\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T09:35:55Z", "type": "commit"}, {"oid": "608dbd998fa47711e8e8c072d5ffacff9952ac60", "url": "https://github.com/nextcloud/android/commit/608dbd998fa47711e8e8c072d5ffacff9952ac60", "message": "ignore thumbnauil folders for detection/display - related to #7085\nignore thumbdata files for detection - related to #3177\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T09:35:56Z", "type": "commit"}, {"oid": "2113ea26f27cc2f9f83d2181b8427f987f1f56a4", "url": "https://github.com/nextcloud/android/commit/2113ea26f27cc2f9f83d2181b8427f987f1f56a4", "message": "ignore thumbnail-related data on auto upload\n\nResolves #7085\nResolves #4350\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T09:35:56Z", "type": "commit"}, {"oid": "57c3f3cf2f9bfeb44b01fdff66beb743713d5e29", "url": "https://github.com/nextcloud/android/commit/57c3f3cf2f9bfeb44b01fdff66beb743713d5e29", "message": "remove unused import\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T09:35:57Z", "type": "commit"}, {"oid": "219ca5fb93d930dc3dc83c78121cacfc94ef2009", "url": "https://github.com/nextcloud/android/commit/219ca5fb93d930dc3dc83c78121cacfc94ef2009", "message": "invert folder name filter check, move to standard Android view binding\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T09:35:58Z", "type": "commit"}, {"oid": "e20e0dbf927926be8024b208b28edf3e2e30596a", "url": "https://github.com/nextcloud/android/commit/e20e0dbf927926be8024b208b28edf3e2e30596a", "message": "utilze TextUtils, remove unused code\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T09:35:58Z", "type": "commit"}, {"oid": "0f94eefe33ae97afbebbdf5b442adf9ac4056a42", "url": "https://github.com/nextcloud/android/commit/0f94eefe33ae97afbebbdf5b442adf9ac4056a42", "message": "codacy: remove unused variable\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T09:35:59Z", "type": "commit"}, {"oid": "0f94eefe33ae97afbebbdf5b442adf9ac4056a42", "url": "https://github.com/nextcloud/android/commit/0f94eefe33ae97afbebbdf5b442adf9ac4056a42", "message": "codacy: remove unused variable\n\nSigned-off-by: Andy Scherzinger <info@andy-scherzinger.de>", "committedDate": "2020-10-15T09:35:59Z", "type": "forcePushed"}, {"oid": "0bba77ded8b5bba9022483c7493c16120a444bfa", "url": "https://github.com/nextcloud/android/commit/0bba77ded8b5bba9022483c7493c16120a444bfa", "message": "Drone: update Lint results to reflect reduced error/warning count [skip ci]\n\nSigned-off-by: nextcloud-android-bot <android@nextcloud.com>", "committedDate": "2020-10-15T10:03:28Z", "type": "commit"}]}