{"pr_number": 5996, "pr_title": "INV IMPROVEMENTS", "pr_createdAt": "2020-10-27T18:51:52Z", "pr_url": "https://github.com/ldtteam/minecolonies/pull/5996", "timeline": [{"oid": "fa26c53f4eb2a6abe05d3b4b38af13ed119b5d5e", "url": "https://github.com/ldtteam/minecolonies/commit/fa26c53f4eb2a6abe05d3b4b38af13ed119b5d5e", "message": "INV IMPROVEMENTS", "committedDate": "2020-10-27T18:25:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjk1MDgyNw==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r512950827", "bodyText": "There are several places that assume they will always get count from this, the MAXINT variant return being rare.\nSpecifically, the AbstractBuildingWorker and the Dyer both use this function to figure out which ingredient is in largest supply.  Do we actually need the MAXINT result?", "author": "Mekle001", "createdAt": "2020-10-27T18:58:17Z", "path": "src/api/java/com/minecolonies/api/util/InventoryUtils.java", "diffHunk": "@@ -720,19 +720,9 @@ public static int getItemCountInProvider(@NotNull final ICapabilityProvider prov\n     public static int hasBuildingEnoughElseCount(@NotNull final IBuilding provider, @NotNull final ItemStorage stack, final int count)", "originalCommit": "fa26c53f4eb2a6abe05d3b4b38af13ed119b5d5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjk1MzAwNg==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r512953006", "bodyText": "This method is kinda greedy, meaning that the moment we found enough we return. Thus, the returned count != the actually available count but just > the input count. Thus, if return is maxInt we know we got enough, else we know we got just as much as the return value specifies.", "author": "Raycoms", "createdAt": "2020-10-27T19:02:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjk1MDgyNw=="}], "type": "inlineReview"}, {"oid": "3099d16bc8c322baf3a9b957cd631b508a2187b4", "url": "https://github.com/ldtteam/minecolonies/commit/3099d16bc8c322baf3a9b957cd631b508a2187b4", "message": "add a good itemCount method for buildings", "committedDate": "2020-10-27T19:13:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA3MDQ3OA==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r513070478", "bodyText": "I'm wondering if we maybe want to sort by creative tab first and then by tag?", "author": "someaddons", "createdAt": "2020-10-27T22:27:52Z", "path": "src/api/java/com/minecolonies/api/tileentities/TileEntityRack.java", "diffHunk": "@@ -125,6 +126,29 @@ public boolean hasItemStack(@NotNull final Predicate<ItemStack> itemStackSelecti\n         return false;\n     }\n \n+    @Override\n+    public boolean hasSimilarStack(@NotNull final ItemStack stack)\n+    {\n+        final ItemStorage checkItem = new ItemStorage(stack, true);\n+        if (content.containsKey(checkItem))\n+        {\n+            return true;\n+        }\n+\n+        for (final ItemStorage storage : content.keySet())", "originalCommit": "3099d16bc8c322baf3a9b957cd631b508a2187b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA3ODM0NQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r513078345", "bodyText": "I wanted to get rid of the creative tab searching because a lot of that info is client-side only and not \"very\" reliable.", "author": "Raycoms", "createdAt": "2020-10-27T22:49:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA3MDQ3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA3MzAxNg==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r513073016", "bodyText": "function name and doc don't match up", "author": "someaddons", "createdAt": "2020-10-27T22:34:29Z", "path": "src/api/java/com/minecolonies/api/util/InventoryUtils.java", "diffHunk": "@@ -1594,6 +1601,36 @@ public static boolean transferItemStackIntoNextBestSlotInItemHandler(\n         return false;\n     }\n \n+    /**\n+     * Method to swap the ItemStacks from the given source {@link IItemHandler} to the given target {@link IItemHandler}. Trying to merge existing itemStacks if possible.\n+     *\n+     * @param sourceHandler The {@link IItemHandler} that works as Source.\n+     * @param predicate  the matching stack.\n+     * @param targetHandler The {@link IItemHandler} that works as Target.\n+     * @return True when the swap was successful, false when not.\n+     */\n+    public static boolean transferItemStackIntoNextBestSlotInItemHandler(", "originalCommit": "3099d16bc8c322baf3a9b957cd631b508a2187b4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA3NTMzNg==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r513075336", "bodyText": "think you need to exclude the warehouse hutblock here?", "author": "someaddons", "createdAt": "2020-10-27T22:40:48Z", "path": "src/main/java/com/minecolonies/coremod/tileentities/TileEntityWareHouse.java", "diffHunk": "@@ -219,7 +210,7 @@ private TileEntity searchMostEmptySlot()\n     {\n         int freeSlots = 0;\n         TileEntity emptiestChest = null;\n-        for (@NotNull final BlockPos pos : getBuilding().getAdditionalCountainers())\n+        for (@NotNull final BlockPos pos : getBuilding().getContainers())", "originalCommit": "3099d16bc8c322baf3a9b957cd631b508a2187b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI0MjQxOQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r513242419", "bodyText": "why?", "author": "Raycoms", "createdAt": "2020-10-28T07:59:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA3NTMzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI0MjUyNw==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r513242527", "bodyText": "The warehouse block is also a valid chest to drop off", "author": "Raycoms", "createdAt": "2020-10-28T07:59:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA3NTMzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM1NDIzOA==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r513354238", "bodyText": "thought we are not using it, but ok", "author": "someaddons", "createdAt": "2020-10-28T11:01:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA3NTMzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM1NzAyNQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5996#discussion_r513357025", "bodyText": "We're using it, but it was broken in some cases. I fixed this in a recent PR", "author": "Raycoms", "createdAt": "2020-10-28T11:06:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA3NTMzNg=="}], "type": "inlineReview"}, {"oid": "644b5d401b0f3ccfa729803e63a6d33ff1a136e6", "url": "https://github.com/ldtteam/minecolonies/commit/644b5d401b0f3ccfa729803e63a6d33ff1a136e6", "message": "fix doc", "committedDate": "2020-10-28T08:00:49Z", "type": "commit"}, {"oid": "392a8f547f67eade710580143305167f4a183487", "url": "https://github.com/ldtteam/minecolonies/commit/392a8f547f67eade710580143305167f4a183487", "message": "Merge branch 'version/1.15' into inv-fixes", "committedDate": "2020-10-28T16:00:36Z", "type": "commit"}]}