{"pr_number": 4615, "pr_title": "Colony creation gui", "pr_createdAt": "2020-04-11T19:32:40Z", "pr_url": "https://github.com/ldtteam/minecolonies/pull/4615", "timeline": [{"oid": "567510f012b44ee170b8bfd1c446d8bcc089eec1", "url": "https://github.com/ldtteam/minecolonies/commit/567510f012b44ee170b8bfd1c446d8bcc089eec1", "message": "Colony creation via townhall gui", "committedDate": "2020-04-11T18:46:53Z", "type": "commit"}, {"oid": "96e1b71c4b5d3444207f1f4e8007a0ee782afb71", "url": "https://github.com/ldtteam/minecolonies/commit/96e1b71c4b5d3444207f1f4e8007a0ee782afb71", "message": "Merge remote-tracking branch 'remotes/origin/version/1.15' into TownhallBlock", "committedDate": "2020-04-11T18:57:14Z", "type": "commit"}, {"oid": "41d7d9af93e054a2d4d8d1b0650c7c7c3618ad9b", "url": "https://github.com/ldtteam/minecolonies/commit/41d7d9af93e054a2d4d8d1b0650c7c7c3618ad9b", "message": "javadoc", "committedDate": "2020-04-11T19:33:06Z", "type": "commit"}, {"oid": "47de74104c93dae322bafea26b96b91414005bfb", "url": "https://github.com/ldtteam/minecolonies/commit/47de74104c93dae322bafea26b96b91414005bfb", "message": "Merge branch 'version/1.15' into ColonyCreationGUI", "committedDate": "2020-04-11T22:54:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMTY3MA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407121670", "bodyText": "Why not register them as button handlers?", "author": "Raycoms", "createdAt": "2020-04-11T23:15:53Z", "path": "src/main/java/com/minecolonies/coremod/client/gui/WindowTownHallColonyManage.java", "diffHunk": "@@ -0,0 +1,192 @@\n+package com.minecolonies.coremod.client.gui;\n+\n+import com.ldtteam.blockout.controls.Button;\n+import com.ldtteam.blockout.controls.ButtonImage;\n+import com.ldtteam.blockout.controls.Text;\n+import com.ldtteam.structurize.util.LanguageHandler;\n+import com.minecolonies.api.colony.IColony;\n+import com.minecolonies.api.colony.IColonyManager;\n+import com.minecolonies.api.colony.IColonyTagCapability;\n+import com.minecolonies.api.util.BlockPosUtil;\n+import com.minecolonies.coremod.MineColonies;\n+import com.minecolonies.coremod.Network;\n+import com.minecolonies.coremod.network.messages.CreateColonyMessage;\n+import com.minecolonies.coremod.network.messages.VanillaParticleMessage;\n+import net.minecraft.client.Minecraft;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.particles.ParticleTypes;\n+import net.minecraft.util.SoundCategory;\n+import net.minecraft.util.SoundEvents;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+import net.minecraft.world.chunk.Chunk;\n+import org.jetbrains.annotations.NotNull;\n+\n+import static com.minecolonies.api.util.constant.Constants.MOD_ID;\n+import static com.minecolonies.api.util.constant.TranslationConstants.CANT_PLACE_COLONY_TOO_CLOSE_TO_SPAWN;\n+import static com.minecolonies.api.util.constant.TranslationConstants.CANT_PLACE_COLONY_TOO_FAR_FROM_SPAWN;\n+import static com.minecolonies.api.util.constant.WindowConstants.TOWNHALL_COLONY_MANAGEMENT_GUI;\n+import static com.minecolonies.coremod.MineColonies.CLOSE_COLONY_CAP;\n+\n+/**\n+ * TownhallGUI for managing colony creation/deletion\n+ */\n+public class WindowTownHallColonyManage extends AbstractWindowSkeleton\n+{\n+    private static final String BUTTON_CLOSE  = \"cancel\";\n+    private static final String BUTTON_DELETE = \"delete\";\n+    private static final String BUTTON_CREATE = \"create\";\n+    private static final String TEXT_NEARBY   = \"nearbycolony\";\n+    private static final String TEXT_OWN      = \"owncolony\";\n+    private static final String TEXT_FEEDBACK = \"creationpossible\";\n+\n+    /**\n+     * Townhall position\n+     */\n+    private final BlockPos pos;\n+\n+    public WindowTownHallColonyManage(final PlayerEntity player, final BlockPos pos, final World world)\n+    {\n+        super(MOD_ID + TOWNHALL_COLONY_MANAGEMENT_GUI);\n+\n+        this.pos = pos;\n+\n+        final IColony existingColony = IColonyManager.getInstance().getIColony(world, pos);\n+\n+        if (existingColony != null)\n+        {\n+            // Colony here\n+            findPaneOfTypeByID(TEXT_NEARBY, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.here\",\n+              existingColony.getName(),\n+              existingColony.getPermissions().getOwnerName()));\n+        }\n+        else\n+        {\n+            // Close colony\n+            int closeClonyID = findNextNearbyColony(world, pos, MineColonies.getConfig().getCommon().minTownHallPadding.get());\n+\n+            if (closeClonyID != 0)\n+            {\n+                findPaneOfTypeByID(TEXT_NEARBY, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.near\", closeClonyID));\n+            }\n+            else\n+            {\n+                // No close colony\n+                findPaneOfTypeByID(TEXT_NEARBY, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.nonenearby\"));\n+            }\n+        }\n+\n+        final IColony ownerColony = IColonyManager.getInstance().getIColonyByOwner(world, player);\n+        if (ownerColony != null)\n+        {\n+            findPaneOfTypeByID(BUTTON_DELETE, ButtonImage.class).enable();\n+            findPaneOfTypeByID(TEXT_OWN, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.own\", ownerColony.getCenter()));\n+\n+            if (MineColonies.getConfig().getCommon().allowInfiniteColonies.get())\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.denied.existingandabandon\"));\n+            }\n+            else\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.denied.existing\"));\n+            }\n+        }\n+        else\n+        {\n+            findPaneOfTypeByID(TEXT_OWN, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.none\"));\n+\n+            if (existingColony != null || IColonyManager.getInstance().isTooCloseToColony(world, pos))\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.denied.tooclose\"));\n+            }\n+        }\n+\n+        if (MineColonies.getConfig().getCommon().restrictColonyPlacement.get())\n+        {\n+            final double spawnDistance = Math.sqrt(BlockPosUtil.getDistanceSquared2D(pos, world.getSpawnPoint()));\n+            if (spawnDistance < MineColonies.getConfig().getCommon().minDistanceFromWorldSpawn.get())\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(CANT_PLACE_COLONY_TOO_CLOSE_TO_SPAWN,\n+                  MineColonies.getConfig().getCommon().minDistanceFromWorldSpawn.get()));\n+            }\n+            else if (spawnDistance > MineColonies.getConfig().getCommon().maxDistanceFromWorldSpawn.get())\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(CANT_PLACE_COLONY_TOO_FAR_FROM_SPAWN,\n+                  MineColonies.getConfig().getCommon().maxDistanceFromWorldSpawn.get()));\n+            }\n+        }\n+\n+        if (findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).getTextContent().isEmpty())\n+        {\n+            findPaneOfTypeByID(BUTTON_CREATE, ButtonImage.class).enable();\n+            findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.allowed.create\"));\n+        }\n+    }\n+\n+    @Override\n+    public void onButtonClicked(@NotNull final Button button)", "originalCommit": "47de74104c93dae322bafea26b96b91414005bfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE2NjAxMA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407166010", "bodyText": "fixed", "author": "someaddons", "createdAt": "2020-04-12T08:32:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMTY3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMTcxNw==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407121717", "bodyText": "On the client side?", "author": "Raycoms", "createdAt": "2020-04-11T23:16:50Z", "path": "src/main/java/com/minecolonies/coremod/client/gui/WindowTownHallColonyManage.java", "diffHunk": "@@ -0,0 +1,192 @@\n+package com.minecolonies.coremod.client.gui;\n+\n+import com.ldtteam.blockout.controls.Button;\n+import com.ldtteam.blockout.controls.ButtonImage;\n+import com.ldtteam.blockout.controls.Text;\n+import com.ldtteam.structurize.util.LanguageHandler;\n+import com.minecolonies.api.colony.IColony;\n+import com.minecolonies.api.colony.IColonyManager;\n+import com.minecolonies.api.colony.IColonyTagCapability;\n+import com.minecolonies.api.util.BlockPosUtil;\n+import com.minecolonies.coremod.MineColonies;\n+import com.minecolonies.coremod.Network;\n+import com.minecolonies.coremod.network.messages.CreateColonyMessage;\n+import com.minecolonies.coremod.network.messages.VanillaParticleMessage;\n+import net.minecraft.client.Minecraft;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.particles.ParticleTypes;\n+import net.minecraft.util.SoundCategory;\n+import net.minecraft.util.SoundEvents;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+import net.minecraft.world.chunk.Chunk;\n+import org.jetbrains.annotations.NotNull;\n+\n+import static com.minecolonies.api.util.constant.Constants.MOD_ID;\n+import static com.minecolonies.api.util.constant.TranslationConstants.CANT_PLACE_COLONY_TOO_CLOSE_TO_SPAWN;\n+import static com.minecolonies.api.util.constant.TranslationConstants.CANT_PLACE_COLONY_TOO_FAR_FROM_SPAWN;\n+import static com.minecolonies.api.util.constant.WindowConstants.TOWNHALL_COLONY_MANAGEMENT_GUI;\n+import static com.minecolonies.coremod.MineColonies.CLOSE_COLONY_CAP;\n+\n+/**\n+ * TownhallGUI for managing colony creation/deletion\n+ */\n+public class WindowTownHallColonyManage extends AbstractWindowSkeleton\n+{\n+    private static final String BUTTON_CLOSE  = \"cancel\";\n+    private static final String BUTTON_DELETE = \"delete\";\n+    private static final String BUTTON_CREATE = \"create\";\n+    private static final String TEXT_NEARBY   = \"nearbycolony\";\n+    private static final String TEXT_OWN      = \"owncolony\";\n+    private static final String TEXT_FEEDBACK = \"creationpossible\";\n+\n+    /**\n+     * Townhall position\n+     */\n+    private final BlockPos pos;\n+\n+    public WindowTownHallColonyManage(final PlayerEntity player, final BlockPos pos, final World world)\n+    {\n+        super(MOD_ID + TOWNHALL_COLONY_MANAGEMENT_GUI);\n+\n+        this.pos = pos;\n+\n+        final IColony existingColony = IColonyManager.getInstance().getIColony(world, pos);\n+\n+        if (existingColony != null)\n+        {\n+            // Colony here\n+            findPaneOfTypeByID(TEXT_NEARBY, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.here\",\n+              existingColony.getName(),\n+              existingColony.getPermissions().getOwnerName()));\n+        }\n+        else\n+        {\n+            // Close colony\n+            int closeClonyID = findNextNearbyColony(world, pos, MineColonies.getConfig().getCommon().minTownHallPadding.get());\n+\n+            if (closeClonyID != 0)\n+            {\n+                findPaneOfTypeByID(TEXT_NEARBY, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.near\", closeClonyID));\n+            }\n+            else\n+            {\n+                // No close colony\n+                findPaneOfTypeByID(TEXT_NEARBY, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.nonenearby\"));\n+            }\n+        }\n+\n+        final IColony ownerColony = IColonyManager.getInstance().getIColonyByOwner(world, player);\n+        if (ownerColony != null)\n+        {\n+            findPaneOfTypeByID(BUTTON_DELETE, ButtonImage.class).enable();\n+            findPaneOfTypeByID(TEXT_OWN, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.own\", ownerColony.getCenter()));\n+\n+            if (MineColonies.getConfig().getCommon().allowInfiniteColonies.get())\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.denied.existingandabandon\"));\n+            }\n+            else\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.denied.existing\"));\n+            }\n+        }\n+        else\n+        {\n+            findPaneOfTypeByID(TEXT_OWN, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.none\"));\n+\n+            if (existingColony != null || IColonyManager.getInstance().isTooCloseToColony(world, pos))\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.denied.tooclose\"));\n+            }\n+        }\n+\n+        if (MineColonies.getConfig().getCommon().restrictColonyPlacement.get())\n+        {\n+            final double spawnDistance = Math.sqrt(BlockPosUtil.getDistanceSquared2D(pos, world.getSpawnPoint()));\n+            if (spawnDistance < MineColonies.getConfig().getCommon().minDistanceFromWorldSpawn.get())\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(CANT_PLACE_COLONY_TOO_CLOSE_TO_SPAWN,\n+                  MineColonies.getConfig().getCommon().minDistanceFromWorldSpawn.get()));\n+            }\n+            else if (spawnDistance > MineColonies.getConfig().getCommon().maxDistanceFromWorldSpawn.get())\n+            {\n+                findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(CANT_PLACE_COLONY_TOO_FAR_FROM_SPAWN,\n+                  MineColonies.getConfig().getCommon().maxDistanceFromWorldSpawn.get()));\n+            }\n+        }\n+\n+        if (findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).getTextContent().isEmpty())\n+        {\n+            findPaneOfTypeByID(BUTTON_CREATE, ButtonImage.class).enable();\n+            findPaneOfTypeByID(TEXT_FEEDBACK, Text.class).setTextContent(LanguageHandler.format(\"com.minecolonies.coremod.gui.colony.allowed.create\"));\n+        }\n+    }\n+\n+    @Override\n+    public void onButtonClicked(@NotNull final Button button)\n+    {\n+        switch (button.getID())\n+        {\n+            case BUTTON_CLOSE:\n+            {\n+                close();\n+                return;\n+            }\n+            case BUTTON_CREATE:\n+            {\n+                new VanillaParticleMessage(pos.getX(), pos.getY(), pos.getZ(), ParticleTypes.DRAGON_BREATH).onExecute(null, false);\n+                Minecraft.getInstance().world.playSound(Minecraft.getInstance().player, Minecraft.getInstance().player.getPosition(),\n+                  SoundEvents.BLOCK_CAMPFIRE_CRACKLE, SoundCategory.AMBIENT, 2.5f, 0.8f);\n+                Network.getNetwork().sendToServer(new CreateColonyMessage(pos));\n+                close();\n+\n+                return;\n+            }\n+            case BUTTON_DELETE:\n+            {\n+                new WindowTownHallColonyDelete().open();\n+            }\n+            default:\n+        }\n+    }\n+\n+    /**\n+     * Finds the first nearby colony claim in the range\n+     *\n+     * @param world world to use\n+     * @param start start position\n+     * @param range search range\n+     * @return\n+     */\n+    private static int findNextNearbyColony(final World world, final BlockPos start, final int range)", "originalCommit": "47de74104c93dae322bafea26b96b91414005bfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE2NjIzMw==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407166233", "bodyText": "ye its for displaying nearby colonies, and the client doesnt have a full list of colonies, but does get claim data", "author": "someaddons", "createdAt": "2020-04-12T08:34:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMTcxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMTczOA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407121738", "bodyText": "don't we need this?", "author": "Raycoms", "createdAt": "2020-04-11T23:17:11Z", "path": "src/main/java/com/minecolonies/coremod/colony/Colony.java", "diffHunk": "@@ -295,7 +295,6 @@ protected Colony(final int id, @Nullable final World world)\n         this.id = id;\n         if (world != null)\n         {\n-            this.dimensionId = world.getDimension().getType().getId();", "originalCommit": "47de74104c93dae322bafea26b96b91414005bfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMTg3Mw==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407121873", "bodyText": "if we don't se it here, in the next call it will always consider it to be 0", "author": "Raycoms", "createdAt": "2020-04-11T23:18:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMTczOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMjExNg==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407122116", "bodyText": "Why only for overworld?", "author": "Raycoms", "createdAt": "2020-04-11T23:22:04Z", "path": "src/main/java/com/minecolonies/coremod/event/EventHandler.java", "diffHunk": "@@ -785,11 +675,14 @@ public static void onWorldLoad(@NotNull final WorldEvent.Load event)\n     @SubscribeEvent\n     public static void onWorldUnload(@NotNull final WorldEvent.Unload event)\n     {\n-        Log.getLogger().warn(\"World unload\");\n-\n         if (event.getWorld() instanceof World)\n         {\n             IColonyManager.getInstance().onWorldUnload((World) event.getWorld());\n         }\n+        if (event.getWorld().isRemote() && event.getWorld().getDimension().getType() == DimensionType.OVERWORLD)", "originalCommit": "47de74104c93dae322bafea26b96b91414005bfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE2NjI3MA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407166270", "bodyText": "its for removing the colony views on client side once you leave a world, and thats when the overworld is unloaded", "author": "someaddons", "createdAt": "2020-04-12T08:35:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMjExNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE2NzUyMw==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407167523", "bodyText": "ok", "author": "Raycoms", "createdAt": "2020-04-12T08:47:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMjExNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMjE4Mg==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407122182", "bodyText": "I added this for when switching worlds in singlePlayer, don't we need this?", "author": "Raycoms", "createdAt": "2020-04-11T23:23:00Z", "path": "src/main/java/com/minecolonies/coremod/event/FMLEventHandler.java", "diffHunk": "@@ -52,10 +52,6 @@ public static void onPlayerLogin(@NotNull final PlayerEvent.PlayerLoggedInEvent\n             IColonyManager.getInstance().getIColonyByOwner(((ServerPlayerEntity) event.getPlayer()).getServerWorld(), event.getPlayer());\n             //ColonyManager.syncAllColoniesAchievements();\n         }\n-        else\n-        {\n-            IColonyManager.getInstance().resetColonyViews();\n-        }", "originalCommit": "47de74104c93dae322bafea26b96b91414005bfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE2NjMxOA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407166318", "bodyText": "moved it to world unload instead, to not interfere with us sending views on login", "author": "someaddons", "createdAt": "2020-04-12T08:35:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMjE4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE1NzU0Ng==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407157546", "bodyText": "This may break universe when previous version connects to this version. Always add new messages to the end of the list, or increase network proto version", "author": "Nightenom", "createdAt": "2020-04-12T07:10:24Z", "path": "src/main/java/com/minecolonies/coremod/network/NetworkChannel.java", "diffHunk": "@@ -93,6 +93,9 @@ public void registerCommonMessages()\n         registerMessage(++idx, LumberjackReplantSaplingToggleMessage.class, LumberjackReplantSaplingToggleMessage::new);\n         registerMessage(++idx, LumberjackRestrictionToggleMessage.class, LumberjackRestrictionToggleMessage::new);\n         registerMessage(++idx, LumberjackScepterMessage.class, LumberjackScepterMessage::new);\n+        registerMessage(++idx, CreateColonyMessage.class, CreateColonyMessage::new);\n+        registerMessage(++idx, ColonyDeleteOwnMessage.class, ColonyDeleteOwnMessage::new);\n+        registerMessage(++idx, ColonyViewRemoveMessage.class, ColonyViewRemoveMessage::new);", "originalCommit": "47de74104c93dae322bafea26b96b91414005bfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE2NjE3OQ==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407166179", "bodyText": "previous version never are allowed to connect to a newer version afaik", "author": "someaddons", "createdAt": "2020-04-12T08:34:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE1NzU0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE2NjMyMA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407166320", "bodyText": "We add this always next to matching messages and it never was a problem.", "author": "Raycoms", "createdAt": "2020-04-12T08:35:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE1NzU0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE3MDI3NA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407170274", "bodyText": "weird, i was able to connect against different version in non dev env while testing some small mods, might be their bug", "author": "Nightenom", "createdAt": "2020-04-12T09:13:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE1NzU0Ng=="}], "type": "inlineReview"}, {"oid": "12289312f79026a849270418c0bf25ce8af86f94", "url": "https://github.com/ldtteam/minecolonies/commit/12289312f79026a849270418c0bf25ce8af86f94", "message": "changes", "committedDate": "2020-04-12T08:32:36Z", "type": "commit"}, {"oid": "a962018feeb6fff691a1d9c092f1f35879eb754a", "url": "https://github.com/ldtteam/minecolonies/commit/a962018feeb6fff691a1d9c092f1f35879eb754a", "message": "Merge remote-tracking branch 'origin/version/1.15' into TownhallBlock", "committedDate": "2020-04-12T15:19:20Z", "type": "commit"}, {"oid": "cb3cbed9fab2bc98656d0a8af1b95a7ff6b53c77", "url": "https://github.com/ldtteam/minecolonies/commit/cb3cbed9fab2bc98656d0a8af1b95a7ff6b53c77", "message": "changes", "committedDate": "2020-04-12T19:43:34Z", "type": "commit"}, {"oid": "04a3e612a1ad945bdcc21da49b419e2937db331f", "url": "https://github.com/ldtteam/minecolonies/commit/04a3e612a1ad945bdcc21da49b419e2937db331f", "message": "Merge branch 'TownhallBlock' into ColonyCreationGUI", "committedDate": "2020-04-12T20:23:35Z", "type": "commit"}, {"oid": "a3141299039b47937e66fb7f22f766ff8eb0ee4a", "url": "https://github.com/ldtteam/minecolonies/commit/a3141299039b47937e66fb7f22f766ff8eb0ee4a", "message": "shutdown pathing earlier", "committedDate": "2020-04-12T20:36:47Z", "type": "commit"}, {"oid": "e160069b572b35f0dc017f1bae0d7effa80d6d1b", "url": "https://github.com/ldtteam/minecolonies/commit/e160069b572b35f0dc017f1bae0d7effa80d6d1b", "message": "change to super", "committedDate": "2020-04-13T07:53:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM3NzYxMw==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407377613", "bodyText": "Question:\nWhy remove the final here and make it so that we set the colonies (close colonies, should probably rename this field)\nI think it'd be better to use an add (to list) method and keep it final. Then you could also add close colonies later on (say a new colony is placed down later) without getting, modifying, and setting, or elsewise", "author": "Asherslab", "createdAt": "2020-04-13T08:32:43Z", "path": "src/api/java/com/minecolonies/api/colony/IColonyTagCapability.java", "diffHunk": "@@ -97,7 +104,7 @@\n         /**\n          * The set of all close colonies. Only relevant in non dynamic claiming.\n          */\n-        private final Set<Integer> colonies = new HashSet<>();\n+        private Set<Integer> colonies = new HashSet<>();", "originalCommit": "a3141299039b47937e66fb7f22f766ff8eb0ee4a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM4Mzg1MQ==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407383851", "bodyText": "it is so that we can override the client's chunk data with new data on receiving a message", "author": "someaddons", "createdAt": "2020-04-13T08:50:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM3NzYxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM3Nzc4OA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407377788", "bodyText": "Why is this changed in this PR?", "author": "Asherslab", "createdAt": "2020-04-13T08:33:14Z", "path": "src/api/java/com/minecolonies/api/util/constant/GuardConstants.java", "diffHunk": "@@ -110,7 +110,7 @@\n     /**\n      * Basic bonus hp for knights\n      */\n-    public static final int KNIGHT_HP_BONUS = 5;\n+    public static final int KNIGHT_HP_BONUS = 15;", "originalCommit": "a3141299039b47937e66fb7f22f766ff8eb0ee4a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM4NDE1OA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407384158", "bodyText": "didnt want to make a new PR for two lines :D", "author": "someaddons", "createdAt": "2020-04-13T08:51:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM3Nzc4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM3ODkxMA==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407378910", "bodyText": "Leave Bonus health private and call super.getBonusHealth() here instead", "author": "Asherslab", "createdAt": "2020-04-13T08:36:29Z", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingGuardTower.java", "diffHunk": "@@ -67,6 +67,12 @@ public int getClaimRadius(final int newLevel)\n         return Math.max(0, newLevel - 1);\n     }\n \n+    @Override\n+    protected int getBonusHealth()\n+    {\n+        return BONUS_HP_SINGLE_GUARD + getBuildingLevel() * BONUS_HEALTH_PER_LEVEL;", "originalCommit": "a3141299039b47937e66fb7f22f766ff8eb0ee4a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM4NDIyMQ==", "url": "https://github.com/ldtteam/minecolonies/pull/4615#discussion_r407384221", "bodyText": "ye", "author": "someaddons", "createdAt": "2020-04-13T08:51:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM3ODkxMA=="}], "type": "inlineReview"}, {"oid": "1ba0ba70ede2719dc5a86016bdee01c3488115af", "url": "https://github.com/ldtteam/minecolonies/commit/1ba0ba70ede2719dc5a86016bdee01c3488115af", "message": "make patrol default", "committedDate": "2020-04-13T09:19:19Z", "type": "commit"}, {"oid": "7c3413c2f5c73fdaf373030b2ff443cc8d09a4ae", "url": "https://github.com/ldtteam/minecolonies/commit/7c3413c2f5c73fdaf373030b2ff443cc8d09a4ae", "message": "Merge branch 'version/1.15' into ColonyCreationGUI", "committedDate": "2020-04-13T11:13:22Z", "type": "commit"}]}