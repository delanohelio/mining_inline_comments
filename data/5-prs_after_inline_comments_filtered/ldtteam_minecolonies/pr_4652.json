{"pr_number": 4652, "pr_title": "Fix #4181 Fisherman leaving line in water", "pr_createdAt": "2020-04-16T20:28:23Z", "pr_url": "https://github.com/ldtteam/minecolonies/pull/4652", "timeline": [{"oid": "98b2fc75e2ec11dc45435039567ccbdd8cf60434", "url": "https://github.com/ldtteam/minecolonies/commit/98b2fc75e2ec11dc45435039567ccbdd8cf60434", "message": "Fix for #4181\n\n- Checks when sending citizen home to sleep.\n- If Job is Fisherman, retrieveRod method is called.", "committedDate": "2020-04-16T20:22:02Z", "type": "commit"}, {"oid": "6e037b350ccd72b3f4d485a7cd08cdeeef551511", "url": "https://github.com/ldtteam/minecolonies/commit/6e037b350ccd72b3f4d485a7cd08cdeeef551511", "message": "Revert \"Fix for #4181\"\n\nThis reverts commit 98b2fc75e2ec11dc45435039567ccbdd8cf60434.", "committedDate": "2020-04-16T20:23:02Z", "type": "commit"}, {"oid": "535dd8a8e5a2811d795e2c7b1d6411fd5954f1d0", "url": "https://github.com/ldtteam/minecolonies/commit/535dd8a8e5a2811d795e2c7b1d6411fd5954f1d0", "message": "Fix for #4181\n\n- Checks when sending citizen home to sleep.\n- If Job is Fisherman, retrieveRod method is called.", "committedDate": "2020-04-16T20:24:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTgzNDYxMg==", "url": "https://github.com/ldtteam/minecolonies/pull/4652#discussion_r409834612", "bodyText": "probably better to make this an instanceof JobFisherman", "author": "Raycoms", "createdAt": "2020-04-16T20:39:43Z", "path": "src/main/java/com/minecolonies/coremod/entity/ai/minimal/EntityAISleep.java", "diffHunk": "@@ -160,6 +162,13 @@ public void tick()\n         // Go home\n         if (!citizen.getCitizenColonyHandler().isAtHome())\n         {\n+            AbstractJob job = (AbstractJob) citizen.getCitizenData().getJob();\n+            if(job.getName() != null) {\n+                if (job.getName().contains(\"Fisherman\")) {\n+                    EntityAIWorkFisherman fishJob = (EntityAIWorkFisherman) citizen.getCitizenData().getJob().getWorkerAI();\n+                    fishJob.retrieveRod();", "originalCommit": "535dd8a8e5a2811d795e2c7b1d6411fd5954f1d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTgzODg4Nw==", "url": "https://github.com/ldtteam/minecolonies/pull/4652#discussion_r409838887", "bodyText": "I couldn't quite get that to work because that was my first thing I tried. Let me go at it again and I'll update it! :D", "author": "iiEpic", "createdAt": "2020-04-16T20:48:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTgzNDYxMg=="}], "type": "inlineReview"}, {"oid": "d48691c0e06e694fa87070f9d579b9162945bbb8", "url": "https://github.com/ldtteam/minecolonies/commit/d48691c0e06e694fa87070f9d579b9162945bbb8", "message": "Update to #4181\n\nChanged to instanceOf JobFisherman upon Raycoms request. (Makes alot more sense)", "committedDate": "2020-04-16T20:51:36Z", "type": "commit"}, {"oid": "4b4f050cdc05cce2c85ede22e193fa4eb7894cf5", "url": "https://github.com/ldtteam/minecolonies/commit/4b4f050cdc05cce2c85ede22e193fa4eb7894cf5", "message": "Merge branch 'version/1.15' into version/1.15", "committedDate": "2020-04-16T21:19:51Z", "type": "commit"}, {"oid": "54904b299ed7d47c025fab18e48991648a9e3f09", "url": "https://github.com/ldtteam/minecolonies/commit/54904b299ed7d47c025fab18e48991648a9e3f09", "message": "Fix for #4181 and others\n\n- Made retrieveRod() back to private\n- Removed added code to EntityAISleep\n- Added int tickRemove\n- Every 100 ticks it will check if the angler's status is set to sleeping, if so it will remove the bobber.\n\n- Thanks to Asher for the code!", "committedDate": "2020-04-17T00:43:42Z", "type": "commit"}, {"oid": "f36d59e695117ac737ef70397ebe2f0773363771", "url": "https://github.com/ldtteam/minecolonies/commit/f36d59e695117ac737ef70397ebe2f0773363771", "message": "Merge branch 'version/1.15' of https://github.com/EpicUnknown/minecolonies into version/1.15", "committedDate": "2020-04-17T00:43:44Z", "type": "commit"}, {"oid": "72cc4ae17bbf3885593a7c801758dc04ef8b1c6a", "url": "https://github.com/ldtteam/minecolonies/commit/72cc4ae17bbf3885593a7c801758dc04ef8b1c6a", "message": "Fix #4181", "committedDate": "2020-04-17T17:59:52Z", "type": "commit"}, {"oid": "da25287814ab1abdb6680389f307178ac5548496", "url": "https://github.com/ldtteam/minecolonies/commit/da25287814ab1abdb6680389f307178ac5548496", "message": "Fix PathFinding of Fisherman\n\nFisherman now stops at the edge of the pond instead of trying to fish inside of the pond.", "committedDate": "2020-04-17T19:03:11Z", "type": "commit"}, {"oid": "b703118911373fc58903d1064f7b5dc9f09c1f5e", "url": "https://github.com/ldtteam/minecolonies/commit/b703118911373fc58903d1064f7b5dc9f09c1f5e", "message": "Formatting Changes", "committedDate": "2020-04-17T19:11:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQyMDAxNQ==", "url": "https://github.com/ldtteam/minecolonies/pull/4652#discussion_r410420015", "bodyText": "missing", "author": "Raycoms", "createdAt": "2020-04-17T19:13:13Z", "path": "src/main/java/com/minecolonies/coremod/entity/ai/citizen/fisherman/EntityAIWorkFisherman.java", "diffHunk": "@@ -649,11 +649,13 @@ private boolean caughtFish()\n      */\n     private void retrieveRod()\n     {\n-        worker.swingArm(worker.getActiveHand());\n-        final int i = entityFishHook.getDamage();\n-        entityFishHook.remove();\n-        worker.getCitizenItemHandler().damageItemInHand(Hand.MAIN_HAND, i);\n-        entityFishHook = null;\n+        if(entityFishHook != null) {", "originalCommit": "b703118911373fc58903d1064f7b5dc9f09c1f5e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQyMDE4Mg==", "url": "https://github.com/ldtteam/minecolonies/pull/4652#discussion_r410420182", "bodyText": "add javadoc and remove whitspace (also format)", "author": "Raycoms", "createdAt": "2020-04-17T19:13:33Z", "path": "src/main/java/com/minecolonies/coremod/entity/NewBobberEntity.java", "diffHunk": "@@ -573,6 +587,8 @@ public boolean isReadyToCatch()\n         return readyToCatch;\n     }\n \n+    public void setInUse() { this.tickRemove = 100; }\n+", "originalCommit": "b703118911373fc58903d1064f7b5dc9f09c1f5e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQyMDI3NA==", "url": "https://github.com/ldtteam/minecolonies/pull/4652#discussion_r410420274", "bodyText": "also remove extra whitespace around here", "author": "Raycoms", "createdAt": "2020-04-17T19:13:46Z", "path": "src/main/java/com/minecolonies/coremod/entity/NewBobberEntity.java", "diffHunk": "@@ -143,7 +145,18 @@ public void setPositionAndRotationDirect(double x, double y, double z, float yaw\n      */\n     public void tick()\n     {\n+\n         super.tick();\n+\n+        if(!this.world.isRemote())\n+        {\n+            if (--this.tickRemove <= 0)\n+            {\n+                this.remove();\n+                return;\n+            }\n+        }\n+", "originalCommit": "b703118911373fc58903d1064f7b5dc9f09c1f5e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "755a76198fdb7edff143aa4e0400d3562ee38c4f", "url": "https://github.com/ldtteam/minecolonies/commit/755a76198fdb7edff143aa4e0400d3562ee38c4f", "message": "Formatting Changes\n\nI believe I got them all.", "committedDate": "2020-04-17T19:25:00Z", "type": "commit"}, {"oid": "32f8687934f5221c602651fe601511eece62f358", "url": "https://github.com/ldtteam/minecolonies/commit/32f8687934f5221c602651fe601511eece62f358", "message": "Merge branch 'version/1.15' into version/1.15", "committedDate": "2020-04-17T19:30:24Z", "type": "commit"}]}