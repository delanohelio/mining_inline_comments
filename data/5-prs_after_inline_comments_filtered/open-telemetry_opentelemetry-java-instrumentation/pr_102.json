{"pr_number": 102, "pr_title": "Change netty-*, play-*, rabbitmq, ratpack, rmi, jms instrumentation to use OpenTelemetry API directly", "pr_createdAt": "2020-01-29T06:24:44Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/102", "timeline": [{"oid": "e2d83fe1b86996fe9237248df073afda2d1d0e58", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/e2d83fe1b86996fe9237248df073afda2d1d0e58", "message": "Fix gRPC conversion to OpenTelemetry API", "committedDate": "2020-01-28T23:21:44Z", "type": "commit"}, {"oid": "dc38d599094a9b4e57ad81b08d120f1409dba9ab", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/dc38d599094a9b4e57ad81b08d120f1409dba9ab", "message": "Fix Akka conversion to OpenTelemetry API", "committedDate": "2020-01-28T23:21:44Z", "type": "commit"}, {"oid": "801b5a289205b2fb00009fa0e46230eece03cac9", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/801b5a289205b2fb00009fa0e46230eece03cac9", "message": "Convert JMS to use OpenTelemetry API directly", "committedDate": "2020-01-28T23:21:44Z", "type": "commit"}, {"oid": "c1d0437b7171b56d1144713ffb6f66e15ffdd790", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/c1d0437b7171b56d1144713ffb6f66e15ffdd790", "message": "Convert Netty 4.0 to use OpenTelemetry API directly", "committedDate": "2020-01-29T04:04:50Z", "type": "commit"}, {"oid": "42ab5ec96a692c9e51dba816a41309723439ff2d", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/42ab5ec96a692c9e51dba816a41309723439ff2d", "message": "Convert Netty 4.1 to use OpenTelemetry API directly", "committedDate": "2020-01-29T04:17:00Z", "type": "commit"}, {"oid": "fcb6728901e467eec8509bc4edace8b340003b0e", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/fcb6728901e467eec8509bc4edace8b340003b0e", "message": "Convert Play 2.4 to use OpenTelemetry API directly", "committedDate": "2020-01-29T04:41:24Z", "type": "commit"}, {"oid": "f948ef0a6d45265074b0658ee0f19ce794e64b07", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/f948ef0a6d45265074b0658ee0f19ce794e64b07", "message": "Convert Play 2.6 to use OpenTelemetry API directly", "committedDate": "2020-01-29T04:41:37Z", "type": "commit"}, {"oid": "08413626fb37175e2706ce483dda180fc0b48874", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/08413626fb37175e2706ce483dda180fc0b48874", "message": "Convert Play WS 1 to use OpenTelemetry API directly", "committedDate": "2020-01-29T04:47:37Z", "type": "commit"}, {"oid": "2bc68d50d949cc664674b91ab65614d015e4fe0f", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/2bc68d50d949cc664674b91ab65614d015e4fe0f", "message": "Convert Play WS 2 to use OpenTelemetry API directly", "committedDate": "2020-01-29T04:47:53Z", "type": "commit"}, {"oid": "50eb0e5fa5774a12b177c4370ff3758f71140447", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/50eb0e5fa5774a12b177c4370ff3758f71140447", "message": "Convert Play WS 2.1 to use OpenTelemetry API directly", "committedDate": "2020-01-29T04:50:01Z", "type": "commit"}, {"oid": "6b00165861b5f33d6d393686ec1a06c23f328882", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/6b00165861b5f33d6d393686ec1a06c23f328882", "message": "Convert RabbitMQ to use OpenTelemetry API directly", "committedDate": "2020-01-29T05:23:59Z", "type": "commit"}, {"oid": "a231c882993b6b1de1c56627d271542ff68f230a", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a231c882993b6b1de1c56627d271542ff68f230a", "message": "Convert Ratpack to use OpenTelemetry API directly", "committedDate": "2020-01-29T06:06:46Z", "type": "commit"}, {"oid": "1afad22a9a072ea5ed75abd2ab98fcfb1fad7429", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/1afad22a9a072ea5ed75abd2ab98fcfb1fad7429", "message": "Convert RMI to use OpenTelemetry API directly", "committedDate": "2020-01-29T06:06:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU1MTcwNg==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/102#discussion_r372551706", "bodyText": "static import?", "author": "tylerbenson", "createdAt": "2020-01-29T18:22:13Z", "path": "instrumentation/netty-4.0/src/main/java/io/opentelemetry/auto/instrumentation/netty40/ChannelFutureListenerInstrumentation.java", "diffHunk": "@@ -84,25 +82,27 @@ public static AgentScope activateScope(@Advice.Argument(0) final ChannelFuture f\n       if (cause == null) {\n         return null;\n       }\n-      final AgentSpan parentSpan =\n+      final Span parentSpan =\n           future.channel().attr(AttributeKeys.PARENT_CONNECT_SPAN_ATTRIBUTE_KEY).getAndRemove();\n       if (parentSpan == null) {\n         return null;\n       }\n-      final AgentScope parentScope = activateSpan(parentSpan, false);\n+      final Scope parentScope = NettyHttpServerDecorator.TRACER.withSpan(parentSpan);", "originalCommit": "1afad22a9a072ea5ed75abd2ab98fcfb1fad7429", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU2NTYzNg==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/102#discussion_r372565636", "bodyText": "i was following similar import for DECORATE below, i was thinking maybe this was intentional here since it was not obvious in this file which would be used (NettyHttpServerDecorator or NettyHttpClientDecorator)", "author": "trask", "createdAt": "2020-01-29T18:49:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU1MTcwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU1MTg4NA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/102#discussion_r372551884", "bodyText": "Static import?", "author": "tylerbenson", "createdAt": "2020-01-29T18:22:32Z", "path": "instrumentation/netty-4.0/src/main/java/io/opentelemetry/auto/instrumentation/netty40/NettyChannelPipelineInstrumentation.java", "diffHunk": "@@ -148,9 +148,9 @@ public static void addHandler(\n   public static class ChannelPipelineConnectAdvice {\n     @Advice.OnMethodEnter\n     public static void addParentSpan(@Advice.This final ChannelPipeline pipeline) {\n-      final AgentSpan span = activeSpan();\n-      if (span != null) {\n-        final Attribute<AgentSpan> attribute =\n+      final Span span = NettyHttpServerDecorator.TRACER.getCurrentSpan();", "originalCommit": "1afad22a9a072ea5ed75abd2ab98fcfb1fad7429", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU2NjU5Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/102#discussion_r372566593", "bodyText": "same as above", "author": "trask", "createdAt": "2020-01-29T18:51:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU1MTg4NA=="}], "type": "inlineReview"}]}