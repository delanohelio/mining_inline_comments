{"pr_number": 1204, "pr_title": "Force flush after finishing lambda function.", "pr_createdAt": "2020-09-15T08:59:38Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1204", "timeline": [{"oid": "4fed308db39412e2ba6eb6b0e19a969d8c72a0be", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/4fed308db39412e2ba6eb6b0e19a969d8c72a0be", "message": "Force span flush after lambda invocation.", "committedDate": "2020-09-15T05:13:47Z", "type": "commit"}, {"oid": "4a8586654cd916502191d625cd7067c99cdb2ae8", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/4a8586654cd916502191d625cd7067c99cdb2ae8", "message": "Merge branch 'master' of github.com:open-telemetry/opentelemetry-auto-instr-java into lambda-forceflush", "committedDate": "2020-09-15T08:49:50Z", "type": "commit"}, {"oid": "5ecd8794219da0a0f6bfb24e196a50f2f59ef530", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/5ecd8794219da0a0f6bfb24e196a50f2f59ef530", "message": "Force flush after finishing lambda function.", "committedDate": "2020-09-15T08:53:52Z", "type": "commit"}, {"oid": "1651cb7e5520dea180cf305c32a5010e06ca8669", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/1651cb7e5520dea180cf305c32a5010e06ca8669", "message": "bleh", "committedDate": "2020-09-15T09:19:57Z", "type": "commit"}, {"oid": "8213e1f9f212aa11e2a6d3447cc693990025988f", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/8213e1f9f212aa11e2a6d3447cc693990025988f", "message": "Better revert", "committedDate": "2020-09-15T09:20:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTExMTY4OA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1204#discussion_r489111688", "bodyText": "The OpenTelemetry SDK is in the agent class loader, so won't be accessible directly from auto-instrumentation.\nUnless we want to shade and put it in the bootstrap class loader.\nI wonder if we will have other use cases like this.\nFor now(?), maybe add a forceFlush() method in auto-api (soon to be javaagent-instrumentation-api), and register the underlying implementation during agent startup (the implementation needs to live in the agent class loader so it can call the SDK directly).", "author": "trask", "createdAt": "2020-09-16T01:43:43Z", "path": "instrumentation/aws-lambda-1.0/library/src/main/java/io/opentelemetry/instrumentation/awslambda/v1_0/AwsLambdaTracer.java", "diffHunk": "@@ -53,4 +55,8 @@ public Scope startScope(Span span) {\n   protected String getInstrumentationName() {\n     return \"io.opentelemetry.aws-lambda-1.0\";\n   }\n+\n+  public void forceFlush() {\n+    OpenTelemetrySdk.getTracerProvider().forceFlush().join(1, TimeUnit.SECONDS);", "originalCommit": "8213e1f9f212aa11e2a6d3447cc693990025988f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a5499b2efec10b55ce06bb3258fbd565808a9829", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a5499b2efec10b55ce06bb3258fbd565808a9829", "message": "Accessor", "committedDate": "2020-09-16T04:55:13Z", "type": "commit"}, {"oid": "824bfcd46b19bd9c014915811efb9a22e2b967f7", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/824bfcd46b19bd9c014915811efb9a22e2b967f7", "message": "Merge branch 'master' of github.com:open-telemetry/opentelemetry-auto-instr-java into lambda-forceflush", "committedDate": "2020-09-16T04:55:16Z", "type": "commit"}, {"oid": "ecb0d79fa653c004152b98336492dba33cc9d17b", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/ecb0d79fa653c004152b98336492dba33cc9d17b", "message": "OpenTelemetrySdkAccess", "committedDate": "2020-09-16T05:59:13Z", "type": "commit"}, {"oid": "ecb0d79fa653c004152b98336492dba33cc9d17b", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/ecb0d79fa653c004152b98336492dba33cc9d17b", "message": "OpenTelemetrySdkAccess", "committedDate": "2020-09-16T05:59:13Z", "type": "forcePushed"}]}