{"pr_number": 1194, "pr_title": "Fix test logging", "pr_createdAt": "2020-09-12T00:25:40Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194", "timeline": [{"oid": "402b374548e4540fdc94ca8062302d86fae8bcdd", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/402b374548e4540fdc94ca8062302d86fae8bcdd", "message": "Fix test logging", "committedDate": "2020-09-12T00:24:56Z", "type": "commit"}, {"oid": "cd926026774d9607af2c76efeedb717876025dc3", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/cd926026774d9607af2c76efeedb717876025dc3", "message": "Only the problem test", "committedDate": "2020-09-12T01:14:20Z", "type": "commit"}, {"oid": "aa3ca231392ee231c1d7b363446565fc83389435", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/aa3ca231392ee231c1d7b363446565fc83389435", "message": "Revert \"Only the problem test\"\n\nThis reverts commit cd926026774d9607af2c76efeedb717876025dc3.", "committedDate": "2020-09-12T01:17:28Z", "type": "commit"}, {"oid": "f5ac8f9c37a7b3703129dd9a72ee77dd8caf340a", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/f5ac8f9c37a7b3703129dd9a72ee77dd8caf340a", "message": "Fix Cassandra ListenableFuture test", "committedDate": "2020-09-14T01:37:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487610230", "bodyText": "cc: @tylerbenson, I think this will fix that Cassandra test for you (DataDog/dd-trace-java#1802)", "author": "trask", "createdAt": "2020-09-14T01:40:21Z", "path": "javaagent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/AgentInstaller.java", "diffHunk": "@@ -125,6 +125,7 @@ public static ResettableClassFileTransformer installBytebuddyAgent(\n       agentBuilder =\n           agentBuilder\n               .with(AgentBuilder.RedefinitionStrategy.RETRANSFORMATION)\n+              .with(AgentBuilder.RedefinitionStrategy.DiscoveryStrategy.Reiterating.INSTANCE)", "originalCommit": "f5ac8f9c37a7b3703129dd9a72ee77dd8caf340a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY0NjE4Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487646183", "bodyText": "Can you add to the PR description what happened?", "author": "anuraaga", "createdAt": "2020-09-14T04:33:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY0ODE5MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487648191", "bodyText": "\ud83d\udc4d done, it's a weird one, i can add more details if it is unclear", "author": "trask", "createdAt": "2020-09-14T04:42:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY1MDYxNA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487650614", "bodyText": "Hmm - not too clear to me still but not sure if it ever would. Main question for me is why we didn't need that before all of our package renaming. Is it because instead of io.opentelemetry.javaagent we switched to the more generic io.opentelemetry?", "author": "anuraaga", "createdAt": "2020-09-14T04:53:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY1MTYyNw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487651627", "bodyText": "oh ya, scroll up just a bit, this code is inside of a conditional if (log.isDebugEnabled()) { which wasn't triggered until I fixed the debug logging in AgentTestRunner", "author": "trask", "createdAt": "2020-09-14T04:57:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY1MjUxMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487652511", "bodyText": "as far as why we didn't need RedefinitionStrategy.DiscoveryStrategy.Reiterating, it's probably still not needed in prod situations because there aren't many classes already loaded when we install the agent, but it's different in tests where we apply instrumentation to some already loaded classes. in particular we already load guava classes, which is what caused the test issue with the Cassandra ListenableFuture test", "author": "trask", "createdAt": "2020-09-14T05:01:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}], "type": "inlineReview"}, {"oid": "13a1d8c251ddc00dc40591e6f23674780218b9da", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/13a1d8c251ddc00dc40591e6f23674780218b9da", "message": "Add comment", "committedDate": "2020-09-14T01:50:56Z", "type": "commit"}]}