{"pr_number": 813, "pr_title": "Use Span.recordException for logging throwable", "pr_createdAt": "2020-07-27T10:10:44Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/813", "timeline": [{"oid": "b5ba3af43c98b601cc38e0d4d4fcc75e7a56f971", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/b5ba3af43c98b601cc38e0d4d4fcc75e7a56f971", "message": "Use Span.recordException", "committedDate": "2020-07-27T08:01:11Z", "type": "commit"}, {"oid": "20598318d7d336e4c68d032e38d93cedef0d796d", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/20598318d7d336e4c68d032e38d93cedef0d796d", "message": "Fix tests", "committedDate": "2020-07-27T10:11:37Z", "type": "commit"}, {"oid": "20598318d7d336e4c68d032e38d93cedef0d796d", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/20598318d7d336e4c68d032e38d93cedef0d796d", "message": "Fix tests", "committedDate": "2020-07-27T10:11:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgzNDI4Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/813#discussion_r460834283", "bodyText": "Why was this just removed?", "author": "iNikem", "createdAt": "2020-07-27T11:49:10Z", "path": "instrumentation/google-http-client-1.19/src/main/java/io/opentelemetry/auto/instrumentation/googlehttpclient/GoogleHttpClientInstrumentation.java", "diffHunk": "@@ -143,7 +142,6 @@ public static void methodExit(\n           // for a failed request.  Thus, check the response code\n           if (response != null && !response.isSuccessStatusCode()) {\n             span.setStatus(Status.UNKNOWN);\n-            span.setAttribute(MoreAttributes.ERROR_MSG, response.getStatusMessage());", "originalCommit": "20598318d7d336e4c68d032e38d93cedef0d796d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI5NzcxMA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/813#discussion_r461297710", "bodyText": "This is setting an HTTP response as an error tag, but our new convention is only about exceptions, not HTTP status line. Keeping this would be confusing wrt to our other tags.", "author": "anuraaga", "createdAt": "2020-07-28T03:37:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgzNDI4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI4OTUyMw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/813#discussion_r461289523", "bodyText": "\ud83c\udf89", "author": "trask", "createdAt": "2020-07-28T03:04:02Z", "path": "agent-bootstrap/src/main/java/io/opentelemetry/auto/bootstrap/instrumentation/decorator/BaseDecorator.java", "diffHunk": "@@ -114,12 +111,7 @@ public static void setPeer(final Span span, String peerName, String peerIp) {\n   }\n \n   public static void addThrowable(final Span span, final Throwable throwable) {\n-    span.setAttribute(MoreAttributes.ERROR_MSG, throwable.getMessage());\n-    span.setAttribute(MoreAttributes.ERROR_TYPE, throwable.getClass().getName());\n-\n-    StringWriter errorString = new StringWriter();\n-    throwable.printStackTrace(new PrintWriter(errorString));\n-    span.setAttribute(MoreAttributes.ERROR_STACK, errorString.toString());\n+    span.recordException(throwable);", "originalCommit": "20598318d7d336e4c68d032e38d93cedef0d796d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "bb53d5144150771cf87bb35e94f581a7b2c8df32", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/bb53d5144150771cf87bb35e94f581a7b2c8df32", "message": "Cleanup", "committedDate": "2020-07-28T04:47:47Z", "type": "commit"}, {"oid": "1da01baea851585aaec4749f7d453b7dfc2f0fa4", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/1da01baea851585aaec4749f7d453b7dfc2f0fa4", "message": "Merge branch 'master' of github.com:open-telemetry/opentelemetry-auto-instr-java into use-record-exception", "committedDate": "2020-07-28T04:49:48Z", "type": "commit"}, {"oid": "90c20e9443208930e30311bee09b388a1253beca", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/90c20e9443208930e30311bee09b388a1253beca", "message": "Update instrumentation/jsp-2.3/src/test/groovy/JSPInstrumentationBasicTests.groovy\n\nCo-authored-by: Trask Stalnaker <trask.stalnaker@gmail.com>", "committedDate": "2020-07-28T05:05:17Z", "type": "commit"}, {"oid": "fcf849d0d974ca4de8dd8648ff1b03a3fd0032f5", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/fcf849d0d974ca4de8dd8648ff1b03a3fd0032f5", "message": "Spotless (IntelliJ acts weird with groovy files for me :()", "committedDate": "2020-07-28T05:08:10Z", "type": "commit"}, {"oid": "a154bc62bdc3c14e43c97accad6c6dcfa93ccf77", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a154bc62bdc3c14e43c97accad6c6dcfa93ccf77", "message": "Merge branch 'use-record-exception' of github.com:anuraaga/opentelemetry-auto-instr-java into use-record-exception", "committedDate": "2020-07-28T05:09:09Z", "type": "commit"}, {"oid": "d8a96cc6301d1fad5d2a9e0799cb923543dd784a", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/d8a96cc6301d1fad5d2a9e0799cb923543dd784a", "message": "Update for merge", "committedDate": "2020-07-28T05:27:23Z", "type": "commit"}]}