{"pr_number": 260, "pr_title": "[MapRouletteUploadCommand] Fix custom challenge name bug", "pr_createdAt": "2020-02-18T00:49:45Z", "pr_url": "https://github.com/osmlab/atlas-checks/pull/260", "timeline": [{"oid": "046a08ceac05356ee07a4cc4ab9cf7a0c85bbec5", "url": "https://github.com/osmlab/atlas-checks/commit/046a08ceac05356ee07a4cc4ab9cf7a0c85bbec5", "message": "fix custom challenge name bug", "committedDate": "2020-02-17T23:33:15Z", "type": "commit"}, {"oid": "d954892df89e3172bd2fa76be99641dab0001444", "url": "https://github.com/osmlab/atlas-checks/commit/d954892df89e3172bd2fa76be99641dab0001444", "message": "More tests!", "committedDate": "2020-02-18T00:45:08Z", "type": "commit"}, {"oid": "b66dbac84f4e6d3cb4181069365913a978765014", "url": "https://github.com/osmlab/atlas-checks/commit/b66dbac84f4e6d3cb4181069365913a978765014", "message": "extra lines", "committedDate": "2020-02-18T00:48:13Z", "type": "commit"}, {"oid": "c068bde52daea513c01b2b1c33e03f87e0f45da8", "url": "https://github.com/osmlab/atlas-checks/commit/c068bde52daea513c01b2b1c33e03f87e0f45da8", "message": "Merge branch 'dev' into mr", "committedDate": "2020-02-18T00:49:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDk5NDc0Nw==", "url": "https://github.com/osmlab/atlas-checks/pull/260#discussion_r380994747", "bodyText": "runAndTest could call this method to cut down on some duplication", "author": "seancoulter", "createdAt": "2020-02-18T23:23:04Z", "path": "src/test/java/org/openstreetmap/atlas/checks/maproulette/MapRouletteUploadCommandTest.java", "diffHunk": "@@ -83,6 +116,30 @@ public void writeFiles()\n         }\n     }\n \n+    /**\n+     * Similar to runAndTest, however this function will return a {@link TestMapRouletteConnection}\n+     *\n+     * @param additionalArguments\n+     *            String[] of extra arguments for {@link MapRouletteUploadCommand}, to add to the\n+     *            data i/o locations and server config\n+     * @return TestMapRouletteConnection\n+     */\n+    private TestMapRouletteConnection run(final String[] additionalArguments)", "originalCommit": "c068bde52daea513c01b2b1c33e03f87e0f45da8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTA0MDk3NQ==", "url": "https://github.com/osmlab/atlas-checks/pull/260#discussion_r381040975", "bodyText": "Yup, good call. This was handled in the latest commit", "author": "danielduhh", "createdAt": "2020-02-19T02:07:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDk5NDc0Nw=="}], "type": "inlineReview"}, {"oid": "16944185e49ebfe35d8ca3672533f21630e27d6e", "url": "https://github.com/osmlab/atlas-checks/commit/16944185e49ebfe35d8ca3672533f21630e27d6e", "message": "fix tests", "committedDate": "2020-02-19T01:55:28Z", "type": "commit"}, {"oid": "bf3dd76f3a9614318fd0d768acb561e12c220d36", "url": "https://github.com/osmlab/atlas-checks/commit/bf3dd76f3a9614318fd0d768acb561e12c220d36", "message": "sonar", "committedDate": "2020-02-19T02:31:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTA2NTYxOQ==", "url": "https://github.com/osmlab/atlas-checks/pull/260#discussion_r381065619", "bodyText": "nice testing! cool to see it java and how I can try and create testing in python.", "author": "dcastrowa", "createdAt": "2020-02-19T03:59:00Z", "path": "src/test/java/org/openstreetmap/atlas/checks/maproulette/MapRouletteUploadCommandTest.java", "diffHunk": "@@ -57,7 +60,39 @@ public void testCountryFilter()\n     public void testExecute()\n     {\n         final String[] additionalArguments = {};\n-        this.runAndTest(additionalArguments, 1, 2, 2);\n+        this.runAndTest(additionalArguments, 1, 3, 3);\n+    }\n+\n+    @Test\n+    public void testGetCountryDisplayName()\n+    {\n+        final Optional<String> countries1 = Optional.of(\"CAN,MEX\");\n+        final Optional<String> countries2 = Optional.of(\"USA\");\n+        final MapRouletteUploadCommand command = new MapRouletteUploadCommand();\n+        final String displayCountryNames1 = command.getCountryDisplayName(countries1);\n+        final String displayCountryNames2 = command.getCountryDisplayName(countries2);\n+\n+        Assert.assertEquals(\"Canada, Mexico\", displayCountryNames1);\n+        Assert.assertEquals(\"United States\", displayCountryNames2);\n+    }\n+\n+    @Test\n+    public void testGetCustomChallengeName()\n+    {\n+        final String[] additionalArguments = { String.format(\"-config=%s\",\n+                MapRouletteUploadCommandTest.class.getResource(\"checksConfig.json\").getPath()) };\n+\n+        final TestMapRouletteConnection connection = this.run(additionalArguments);\n+        final Set<Project> projects = connection.uploadedProjects();\n+\n+        final List<String> challengeNames = projects.stream().flatMap(project -> connection\n+                .challengesForProject(project).stream().map(Challenge::getName))\n+                .collect(Collectors.toList());\n+        Collections.sort(challengeNames);\n+\n+        Assert.assertEquals(\"Canada - Spiky Buildings\", challengeNames.get(0));\n+        Assert.assertEquals(\"Mexico, Belize - Intersecting Lines\", challengeNames.get(1));\n+        Assert.assertEquals(\"United States - Address Point Match\", challengeNames.get(2));", "originalCommit": "bf3dd76f3a9614318fd0d768acb561e12c220d36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "17426d346cde930a4f7afd1138c09a6d66d5d6c8", "url": "https://github.com/osmlab/atlas-checks/commit/17426d346cde930a4f7afd1138c09a6d66d5d6c8", "message": "remove extra lines", "committedDate": "2020-02-19T05:59:09Z", "type": "commit"}]}