{"pr_number": 1729, "pr_title": "fix cpu request comparison issue in ItPodRestart", "pr_createdAt": "2020-06-12T05:38:02Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1729", "timeline": [{"oid": "aa02cbe095d0a39dbbf6d457345201f4b719dc9e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/aa02cbe095d0a39dbbf6d457345201f4b719dc9e", "message": "fix cpuRequest comparison", "committedDate": "2020-06-12T05:31:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTMzNTQ5NQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1729#discussion_r439335495", "bodyText": "Why do you keep switching between intValue() and doubleValue()? Alternatively, the test constants could also be BigDecimal and then you could just compare them without intValue() or doubleValue().", "author": "rjeberhard", "createdAt": "2020-06-12T10:22:04Z", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "diffHunk": "@@ -201,9 +201,9 @@ public void testServerPodsRestartByChangingResource() {\n     // verify the server pod resources limits got updated\n     logger.info(\"Checking that the server pod resources cpu limit was updated correctly\");\n     assertNotNull(limits.get(\"cpu\"), domain1 + \"/spec/serverPod/resources/limits/cpu is null\");\n-    assertEquals(limits.get(\"cpu\").getNumber().toString(), cpuLimit,\n+    assertEquals(limits.get(\"cpu\").getNumber().intValue(), cpuLimit,", "originalCommit": "aa02cbe095d0a39dbbf6d457345201f4b719dc9e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU2MDk1Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1729#discussion_r439560957", "bodyText": "From the BigDecimal java doc: https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#equals-java.lang.Object-\npublic boolean equals(Object x)\nCompares this BigDecimal with the specified Object for equality. Unlike compareTo, this method considers two BigDecimal objects equal only if they are equal in value and scale (thus 2.0 is not equal to 2.00 when compared by this method).\nWe will get the same issue if compare two BigDecimals.", "author": "xiancao", "createdAt": "2020-06-12T17:47:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTMzNTQ5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU2MzIyMw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1729#discussion_r439563223", "bodyText": "I can use this instead if you prefer:\nassertNotEquals(limits.get(\"cpu\").getNumber().compareTo(new BigDecimal(cpuLimit)), 0,\nString.format(\"server pod compute resources cpu limit is already set to %s, set cpu limit to \"\n+ \"a different value\", cpuLimit));", "author": "xiancao", "createdAt": "2020-06-12T17:52:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTMzNTQ5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU2NTYzMA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1729#discussion_r439565630", "bodyText": "Sure, that's fine. The cpuLimit could also just be a BigDecimal earlier as the above gets more complicated than it needs to be.", "author": "rjeberhard", "createdAt": "2020-06-12T17:57:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTMzNTQ5NQ=="}], "type": "inlineReview"}, {"oid": "ff76a56261dd8aae1a55d419018582e2e8bd907f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ff76a56261dd8aae1a55d419018582e2e8bd907f", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into xc-fixpodsrestart", "committedDate": "2020-06-12T17:41:17Z", "type": "commit"}, {"oid": "3a8814308f0a0a16be37061a6a3f3de3776ef385", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3a8814308f0a0a16be37061a6a3f3de3776ef385", "message": "use compareTo in BigDecimal to compare two values", "committedDate": "2020-06-12T18:18:59Z", "type": "commit"}, {"oid": "962d874c82f10de992258acaac5a7de584ad8eb5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/962d874c82f10de992258acaac5a7de584ad8eb5", "message": "use BigDecimal for cpuLimits and cpuRequests", "committedDate": "2020-06-12T21:44:11Z", "type": "commit"}]}