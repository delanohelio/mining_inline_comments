{"pr_number": 2107, "pr_title": "Adding test to add a cluster using dynamic update", "pr_createdAt": "2020-12-16T22:55:12Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2107", "timeline": [{"oid": "be006a198c8b4ec95224024a9ba6ad7917ea1798", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/be006a198c8b4ec95224024a9ba6ad7917ea1798", "message": "adding new test for add cluster", "committedDate": "2020-12-16T19:53:41Z", "type": "commit"}, {"oid": "c5c230b18d7c03e870f95d37a6cb9154b2bf04c7", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c5c230b18d7c03e870f95d37a6cb9154b2bf04c7", "message": "fixing merge conflict", "committedDate": "2020-12-16T22:41:02Z", "type": "commit"}, {"oid": "5d2f88f2ec33fa2673e53f2b2955d8fd168b5f8b", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5d2f88f2ec33fa2673e53f2b2955d8fd168b5f8b", "message": "enable test", "committedDate": "2020-12-16T23:00:57Z", "type": "commit"}, {"oid": "067eb9ea540ef0aa7d247458176dbb2a00e3efea", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/067eb9ea540ef0aa7d247458176dbb2a00e3efea", "message": "enable test", "committedDate": "2020-12-17T15:12:03Z", "type": "commit"}, {"oid": "5886aace97c0e5d136f77d3ff4e24076a81524ff", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5886aace97c0e5d136f77d3ff4e24076a81524ff", "message": "disable the failing test", "committedDate": "2020-12-17T18:02:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMxNzg4NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2107#discussion_r545317884", "bodyText": "Should the code in oracle.weblogic.kubernetes.actions.impl.Operator#patchReplicas() be updated to use this new method?", "author": "alai8", "createdAt": "2020-12-17T18:42:10Z", "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/CommonPatchTestUtils.java", "diffHunk": "@@ -198,4 +198,27 @@ public static boolean patchDomainResource(String domainUid, String domainNamespa\n     V1Patch patch = new V1Patch(new String(patchStr));\n     return patchDomainCustomResource(domainUid, domainNamespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n   }\n+\n+  /**\n+   * Patch replicas at spec level.\n+   *\n+   * @param domainUid unique domain identifier\n+   * @param domainNamespace the Kubernetes namespace where the domain is\n+   * @param replicaCount the replica count to patch with\n+   * @return true if successful, false otherwise\n+   */\n+  public static boolean patchReplicaCountAtSpecLevel(String domainUid, String domainNamespace, int replicaCount) {", "originalCommit": "5886aace97c0e5d136f77d3ff4e24076a81524ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTM2OTI5OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2107#discussion_r545369298", "bodyText": "Operator#patchReplicas() is for operator and the one here is for domain CR. I can change the method name to patchDomainResourceWithNewReplicaCountAtSpecLevel().", "author": "vanajamukkara", "createdAt": "2020-12-17T20:04:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMxNzg4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMxODIwNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2107#discussion_r545318205", "bodyText": "Consider using V1Patch.PATCH_FORMAT_JSON_PATCH constant", "author": "alai8", "createdAt": "2020-12-17T18:42:40Z", "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/CommonPatchTestUtils.java", "diffHunk": "@@ -198,4 +198,27 @@ public static boolean patchDomainResource(String domainUid, String domainNamespa\n     V1Patch patch = new V1Patch(new String(patchStr));\n     return patchDomainCustomResource(domainUid, domainNamespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n   }\n+\n+  /**\n+   * Patch replicas at spec level.\n+   *\n+   * @param domainUid unique domain identifier\n+   * @param domainNamespace the Kubernetes namespace where the domain is\n+   * @param replicaCount the replica count to patch with\n+   * @return true if successful, false otherwise\n+   */\n+  public static boolean patchReplicaCountAtSpecLevel(String domainUid, String domainNamespace, int replicaCount) {\n+    LoggingFacade logger = getLogger();\n+    StringBuffer patchStr = new StringBuffer(\"[{\");\n+    patchStr.append(\" \\\"op\\\": \\\"replace\\\",\")\n+        .append(\" \\\"path\\\": \\\"/spec/replicas\\\",\")\n+        .append(\" \\\"value\\\": \")\n+        .append(replicaCount)\n+        .append(\" }]\");\n+    logger.info(\"Replicas patch string: {0}\", patchStr);\n+\n+    V1Patch patch = new V1Patch(new String(patchStr));\n+    return patchDomainCustomResource(domainUid, domainNamespace, patch, \"application/json-patch+json\");", "originalCommit": "5886aace97c0e5d136f77d3ff4e24076a81524ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3872b7265657a26de6a08d3ca1a2092b1037edde", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3872b7265657a26de6a08d3ca1a2092b1037edde", "message": "address review comments", "committedDate": "2020-12-17T20:18:14Z", "type": "commit"}]}