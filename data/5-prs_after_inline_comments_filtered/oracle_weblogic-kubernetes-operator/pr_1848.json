{"pr_number": 1848, "pr_title": " Junit5: Convert two ELK Stack test cases  ( testLogLevelSearch and testOperatorLogSearch )", "pr_createdAt": "2020-08-05T02:20:34Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1848", "timeline": [{"oid": "93a5285aa2f4bdfbb180e1faa2c1da5c3abd2bfd", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/93a5285aa2f4bdfbb180e1faa2c1da5c3abd2bfd", "message": "JUnit5 Create Infrastructure for ELK stack jenkins-ignore", "committedDate": "2020-07-29T22:44:02Z", "type": "commit"}, {"oid": "7e7c28b69839925a001ecc3b2c1cd202290cf253", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7e7c28b69839925a001ecc3b2c1cd202290cf253", "message": "JUnit5 Create Infrastructure for ELK stack jenkins-ignore", "committedDate": "2020-07-29T23:20:41Z", "type": "commit"}, {"oid": "3eee42e343aeb89165c0f45c194b3b424be1b1b1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3eee42e343aeb89165c0f45c194b3b424be1b1b1", "message": "Changes based on comments jenkins-ignore", "committedDate": "2020-07-31T00:45:25Z", "type": "commit"}, {"oid": "80c8d92eb320d8552f80183832e07e932d1cc660", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/80c8d92eb320d8552f80183832e07e932d1cc660", "message": "Syncup with develop jenkins-ignore", "committedDate": "2020-08-01T22:07:17Z", "type": "commit"}, {"oid": "ca4442e376678d70cd4f12c4e0a395d83a1d6129", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ca4442e376678d70cd4f12c4e0a395d83a1d6129", "message": "Minor change in installAndVerifyOperator jenkins-ignore", "committedDate": "2020-08-03T20:21:51Z", "type": "commit"}, {"oid": "101af2032cdf14c28fa84e5223f68c271ca1fd21", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/101af2032cdf14c28fa84e5223f68c271ca1fd21", "message": "Converted two ELK Stack test cases to use JUnit5 jenkins-ignore", "committedDate": "2020-08-03T23:49:23Z", "type": "commit"}, {"oid": "89d0f2293f7aaef2546a7ffc3a4adf943cfe47eb", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/89d0f2293f7aaef2546a7ffc3a4adf943cfe47eb", "message": "Converted two ELK Stack test cases to use JUnit5 jenkins-ignore", "committedDate": "2020-08-04T00:46:10Z", "type": "commit"}, {"oid": "b6da81b512eca937173ab16115358bbb841c038d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b6da81b512eca937173ab16115358bbb841c038d", "message": "Syncup with develop jenkins-ignore", "committedDate": "2020-08-05T02:51:59Z", "type": "commit"}, {"oid": "e508f9509e35eb098334a4b03fa13fe297147e93", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e508f9509e35eb098334a4b03fa13fe297147e93", "message": "Changes based on the comments jenkins-ignore", "committedDate": "2020-08-05T03:21:41Z", "type": "commit"}, {"oid": "4acae9513b920a660ef1332376706b17c332201e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4acae9513b920a660ef1332376706b17c332201e", "message": "Added detaied test steps jenkins-ignore", "committedDate": "2020-08-06T18:17:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0Mjg1OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1848#discussion_r467342858", "bodyText": "typo", "author": "markxnelson", "createdAt": "2020-08-08T01:12:23Z", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItElasticLogging.java", "diffHunk": "@@ -0,0 +1,411 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+import io.kubernetes.client.openapi.models.V1EnvVar;\n+import io.kubernetes.client.openapi.models.V1LocalObjectReference;\n+import io.kubernetes.client.openapi.models.V1ObjectMeta;\n+import io.kubernetes.client.openapi.models.V1SecretReference;\n+import oracle.weblogic.domain.AdminServer;\n+import oracle.weblogic.domain.AdminService;\n+import oracle.weblogic.domain.Channel;\n+import oracle.weblogic.domain.Cluster;\n+import oracle.weblogic.domain.Configuration;\n+import oracle.weblogic.domain.Domain;\n+import oracle.weblogic.domain.DomainSpec;\n+import oracle.weblogic.domain.Model;\n+import oracle.weblogic.domain.ServerPod;\n+import oracle.weblogic.kubernetes.actions.impl.LoggingExporterParams;\n+import oracle.weblogic.kubernetes.annotations.IntegrationTest;\n+import oracle.weblogic.kubernetes.annotations.Namespaces;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import oracle.weblogic.kubernetes.utils.ExecResult;\n+import org.awaitility.core.ConditionFactory;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static java.util.concurrent.TimeUnit.MINUTES;\n+import static java.util.concurrent.TimeUnit.SECONDS;\n+import static oracle.weblogic.kubernetes.TestConstants.DOMAIN_API_VERSION;\n+import static oracle.weblogic.kubernetes.TestConstants.ELASTICSEARCH_HOST;\n+import static oracle.weblogic.kubernetes.TestConstants.ELASTICSEARCH_HTTP_PORT;\n+import static oracle.weblogic.kubernetes.TestConstants.KIBANA_INDEX_KEY;\n+import static oracle.weblogic.kubernetes.TestConstants.LOGSTASH_INDEX_KEY;\n+import static oracle.weblogic.kubernetes.TestConstants.MII_BASIC_IMAGE_NAME;\n+import static oracle.weblogic.kubernetes.TestConstants.MII_BASIC_IMAGE_TAG;\n+import static oracle.weblogic.kubernetes.TestConstants.OPERATOR_RELEASE_NAME;\n+import static oracle.weblogic.kubernetes.TestConstants.REPO_SECRET_NAME;\n+import static oracle.weblogic.kubernetes.TestConstants.WDT_BASIC_IMAGE_NAME;\n+import static oracle.weblogic.kubernetes.TestConstants.WDT_BASIC_IMAGE_TAG;\n+import static oracle.weblogic.kubernetes.actions.TestActions.deleteDomainCustomResource;\n+import static oracle.weblogic.kubernetes.actions.TestActions.execCommand;\n+import static oracle.weblogic.kubernetes.actions.TestActions.getOperatorPodName;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkPodReady;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkServiceExists;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDockerRegistrySecret;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDomainAndVerify;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createSecretWithUsernamePassword;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.dockerLoginAndPushImageToRegistry;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.installAndVerifyElasticsearch;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.installAndVerifyKibana;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.installAndVerifyOperator;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.uninstallAndVerifyElasticsearch;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.uninstallAndVerifyKibana;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.verifyLoggingExporterReady;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.awaitility.Awaitility.with;\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+import static org.junit.jupiter.api.Assertions.assertFalse;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * To test ELK Stack used in Operator env, this Elasticsearch test does\n+ * 1. Install Kibana/Elasticsearch \n+ * 2. Install and Start the operator with Elk Enabled", "originalCommit": "4acae9513b920a660ef1332376706b17c332201e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODIyMjg5OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1848#discussion_r468222898", "bodyText": "changed Elk to ELK Stack and the operator to Operator, if you meant those", "author": "hzhao-github", "createdAt": "2020-08-10T22:34:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0Mjg1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0MzIzOQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1848#discussion_r467343239", "bodyText": "seems like an old version of ES to test?", "author": "markxnelson", "createdAt": "2020-08-08T01:15:12Z", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/TestConstants.java", "diffHunk": "@@ -93,6 +93,23 @@\n   public static final String VOYAGER_CHART_NAME = \"voyager\";\n   public static final String VOYAGER_CHART_VERSION = \"12.0.0\";\n \n+  // ELK Stack and WebLogic logging exporter constants\n+  public static final String ELASTICSEARCH_NAME = \"elasticsearch\";\n+  public static final String ELASTICSEARCH_IMAGE = ELASTICSEARCH_NAME + \":6.8.0\";", "originalCommit": "4acae9513b920a660ef1332376706b17c332201e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY2ODcxOA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1848#discussion_r467668718", "bodyText": "let me try the latest version", "author": "hzhao-github", "createdAt": "2020-08-10T03:00:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0MzIzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcwOTQwNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1848#discussion_r468709405", "bodyText": "Hi Mark, I have upgraded the ELK Stack(Elasticsearch, Kibana and Logstash) version to 7.8.1, latest version", "author": "hzhao-github", "createdAt": "2020-08-11T16:27:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0MzIzOQ=="}], "type": "inlineReview"}, {"oid": "f24f434b6f1a1a7eb2d3307b54a818e96a2b6f78", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f24f434b6f1a1a7eb2d3307b54a818e96a2b6f78", "message": "Upgraded ELK Stack to version 7.8.1 and delete old test suites jenkins-ignore", "committedDate": "2020-08-11T16:25:13Z", "type": "commit"}, {"oid": "fd9ade5b8611d0c6128ba395aa08f222b1a9c078", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fd9ade5b8611d0c6128ba395aa08f222b1a9c078", "message": "Syncup with develop jenkins-ignore", "committedDate": "2020-08-11T22:23:37Z", "type": "commit"}]}