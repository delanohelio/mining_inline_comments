{"pr_number": 1951, "pr_title": "Adding flexibility to integration tests to pull the base images from OCIR or OCR and more", "pr_createdAt": "2020-09-24T21:49:30Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1951", "timeline": [{"oid": "5739f05075840b634b40b78d641c3fb14be46ea4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5739f05075840b634b40b78d641c3fb14be46ea4", "message": "use secret based on base images repo", "committedDate": "2020-09-21T17:37:00Z", "type": "commit"}, {"oid": "ed798cf93f82ca562cb9d2206297bea704eb3c27", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ed798cf93f82ca562cb9d2206297bea704eb3c27", "message": "fix secrets", "committedDate": "2020-09-22T16:25:18Z", "type": "commit"}, {"oid": "1704599b64cd79639edcbb9bf11bd7d323bcc889", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1704599b64cd79639edcbb9bf11bd7d323bcc889", "message": "fix secrets", "committedDate": "2020-09-22T16:26:16Z", "type": "commit"}, {"oid": "ad6fd809daf3f5930b030e3c02f8047497fc0733", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ad6fd809daf3f5930b030e3c02f8047497fc0733", "message": "fix more secrets", "committedDate": "2020-09-22T20:37:47Z", "type": "commit"}, {"oid": "f6f8368c6b7c8b87795623c49f8c2b3988688cf7", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f6f8368c6b7c8b87795623c49f8c2b3988688cf7", "message": "more secret fixes", "committedDate": "2020-09-22T21:52:40Z", "type": "commit"}, {"oid": "cddb92e0a66ac4a8026e183d420ca4f135c82044", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/cddb92e0a66ac4a8026e183d420ca4f135c82044", "message": "fixing image name", "committedDate": "2020-09-23T20:44:06Z", "type": "commit"}, {"oid": "cdcc75222d13af8c0490fcdaed64d5db54161a39", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/cdcc75222d13af8c0490fcdaed64d5db54161a39", "message": "sync to latest develop", "committedDate": "2020-09-24T02:43:50Z", "type": "commit"}, {"oid": "ca6ea99aad4ed71b665d7897f9ea8df7dc024ce7", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ca6ea99aad4ed71b665d7897f9ea8df7dc024ce7", "message": "fix compilation errors", "committedDate": "2020-09-24T02:59:58Z", "type": "commit"}, {"oid": "ff5871e34372936265d14ac95275edad113ff598", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ff5871e34372936265d14ac95275edad113ff598", "message": "fix condition for exec", "committedDate": "2020-09-24T17:00:47Z", "type": "commit"}, {"oid": "573208b616b1e966cb9c4fad8229ddc827c0cf63", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/573208b616b1e966cb9c4fad8229ddc827c0cf63", "message": "fix conflicts", "committedDate": "2020-09-24T17:06:48Z", "type": "commit"}, {"oid": "4cfba3bbfa5dccc5edee799aa1fdf19b1c9b6745", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4cfba3bbfa5dccc5edee799aa1fdf19b1c9b6745", "message": "fix merge conflict", "committedDate": "2020-09-24T17:30:38Z", "type": "commit"}, {"oid": "a2ace72eb0b0a40b7b4ef7c5f9d6097d83a0c213", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a2ace72eb0b0a40b7b4ef7c5f9d6097d83a0c213", "message": "fix log messages in ItServerStartPolicy", "committedDate": "2020-09-25T16:41:47Z", "type": "commit"}, {"oid": "d93b804facb3eb49c8d3bf05009b377fe1376fd3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d93b804facb3eb49c8d3bf05009b377fe1376fd3", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into owls65389", "committedDate": "2020-09-25T16:46:44Z", "type": "commit"}, {"oid": "07f78a8150c121b9f2db26ab59d0612f9cb2ecea", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/07f78a8150c121b9f2db26ab59d0612f9cb2ecea", "message": "some more refactoring", "committedDate": "2020-09-28T16:20:48Z", "type": "commit"}, {"oid": "088b6af5bc76d4cdbbb12bda269c123c4510d133", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/088b6af5bc76d4cdbbb12bda269c123c4510d133", "message": "refactoring -move useSecret and deriving base image name logic to TestConstants", "committedDate": "2020-09-28T20:28:46Z", "type": "commit"}, {"oid": "ce28cead05e1c3103713db8b6a09255c5e1a280d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ce28cead05e1c3103713db8b6a09255c5e1a280d", "message": "fix checkstyle", "committedDate": "2020-09-28T20:33:53Z", "type": "commit"}, {"oid": "fed199a1abb272904161dacf56293b14cfeaa0cf", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fed199a1abb272904161dacf56293b14cfeaa0cf", "message": "fix merge conflicts", "committedDate": "2020-09-29T16:36:58Z", "type": "commit"}, {"oid": "80d0835a3cff0e142162b07cda8a1fa7364b2286", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/80d0835a3cff0e142162b07cda8a1fa7364b2286", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into owls65389", "committedDate": "2020-09-29T16:37:21Z", "type": "commit"}, {"oid": "3c9e495c292a9c071d364e7927d12b2c4848fbf0", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3c9e495c292a9c071d364e7927d12b2c4848fbf0", "message": "fix domain images repo for multi node cluster", "committedDate": "2020-09-29T21:31:29Z", "type": "commit"}, {"oid": "f7b893cd1813a296716e9543a33b43ad80306c5c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f7b893cd1813a296716e9543a33b43ad80306c5c", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into owls65389", "committedDate": "2020-09-29T21:40:51Z", "type": "commit"}, {"oid": "bc92dd4eeac4e46b5303eb0fa6dbd26c28c069d4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/bc92dd4eeac4e46b5303eb0fa6dbd26c28c069d4", "message": "set image pull secret always", "committedDate": "2020-09-30T20:31:42Z", "type": "commit"}, {"oid": "c097350e0132301ab4bee48beefe0bae1d988c5e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c097350e0132301ab4bee48beefe0bae1d988c5e", "message": "fix domain images repo", "committedDate": "2020-09-30T20:55:50Z", "type": "commit"}, {"oid": "959fe8431ca73b7cc0bbb834569b951c100c5ef3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/959fe8431ca73b7cc0bbb834569b951c100c5ef3", "message": "fix indentation", "committedDate": "2020-09-30T21:08:36Z", "type": "commit"}, {"oid": "6e42ee99cacbca28139f298d1b0ab5016201bbbf", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6e42ee99cacbca28139f298d1b0ab5016201bbbf", "message": "change REPO env var to OCIR", "committedDate": "2020-09-30T21:57:33Z", "type": "commit"}, {"oid": "b06d74b61334be811a40f3e8ba8c75228b8e8622", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b06d74b61334be811a40f3e8ba8c75228b8e8622", "message": "sync to latest develop and resolve conflicts", "committedDate": "2020-10-01T16:45:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ2NzE5MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1951#discussion_r498467190", "bodyText": "Can you change this to WEBLOGIC_IMAGE_LOCAL as we discussed yesterday.", "author": "sankarpn", "createdAt": "2020-10-01T19:26:41Z", "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/TestConstants.java", "diffHunk": "@@ -58,6 +75,63 @@\n   public static final String OCR_EMAIL = Optional.ofNullable(System.getenv(\"OCR_EMAIL\"))\n       .orElse(REPO_DUMMY_VALUE);\n \n+  // OCR default image values, these values will be used while running locally\n+  public static final String OCR_WEBLOGIC_IMAGE_NAME = \"weblogick8s/weblogic\";\n+  public static final String OCR_WEBLOGIC_IMAGE_TAG = \"12.2.1.4\";\n+  public static final String OCR_FMWINFRA_IMAGE_NAME = \"weblogick8s/fmw-infrastructure\";\n+  public static final String OCR_FMWINFRA_IMAGE_TAG = \"12.2.1.4\";\n+  public static final String OCR_DB_IMAGE_NAME = \"database/enterprise\";\n+  public static final String OCR_DB_IMAGE_TAG = \"12.2.0.1-slim\";\n+\n+  // ----------------------------- base images constants ---------------------\n+  // Get BASE_IMAGES_REPO from env var, if its not provided use OCIR as default to pull base images\n+  public static final String BASE_IMAGES_REPO = Optional.ofNullable(System.getenv(\"BASE_IMAGES_REPO\"))\n+      .orElse(OCIR_DEFAULT);\n+  // Use OCR secret name if OCR is used for base images, if not use OCIR secret name\n+  public static final String BASE_IMAGES_REPO_SECRET =\n+      BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_SECRET_NAME : OCIR_SECRET_NAME;\n+\n+  // Get WEBLOGIC_IMAGE_NAME/WEBLOGIC_IMAGE_TAG from env var, if its not provided and\n+  // if base images repo is OCR use OCR default image values\n+  // or if base images repo is OCIR use OCIR default image values\n+  public static final String WEBLOGIC_IMAGE_NAME\n+          = BASE_IMAGES_REPO + \"/\" + Optional.ofNullable(System.getenv(\"WEBLOGIC_IMAGE_NAME\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_WEBLOGIC_IMAGE_NAME : OCIR_WEBLOGIC_IMAGE_NAME);\n+  public static final String WEBLOGIC_IMAGE_TAG = Optional.ofNullable(System.getenv(\"WEBLOGIC_IMAGE_TAG\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_WEBLOGIC_IMAGE_TAG : OCIR_WEBLOGIC_IMAGE_TAG);\n+  public static final String WLS_UPDATE_IMAGE_TAG = \"14.1.1.0-11\";\n+\n+  // Get FMWINFRA_IMAGE_NAME/FMWINFRA_IMAGE_TAG from env var, if its not provided and\n+  // if base images repo is OCR use OCR default image values\n+  // or if base images repo is OCIR use OCIR default image values\n+  public static final String FMWINFRA_IMAGE_NAME\n+      = BASE_IMAGES_REPO + \"/\" + Optional.ofNullable(System.getenv(\"FMWINFRA_IMAGE_NAME\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_FMWINFRA_IMAGE_NAME : OCIR_FMWINFRA_IMAGE_NAME);\n+  public static final String FMWINFRA_IMAGE_TAG = Optional.ofNullable(System.getenv(\"FMWINFRA_IMAGE_TAG\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_FMWINFRA_IMAGE_TAG : OCIR_FMWINFRA_IMAGE_TAG);\n+\n+  // Get DB_IMAGE_NAME/DB_IMAGE_TAG from env var, if its not provided and\n+  // if base images repo is OCR use OCR default image values\n+  // or if base images repo is OCIR use OCIR default image values\n+  public static final String DB_IMAGE_NAME\n+      = BASE_IMAGES_REPO + \"/\" + Optional.ofNullable(System.getenv(\"DB_IMAGE_NAME\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_DB_IMAGE_NAME : OCIR_DB_IMAGE_NAME);\n+  public static final String DB_IMAGE_TAG = Optional.ofNullable(System.getenv(\"DB_IMAGE_TAG\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_DB_IMAGE_TAG : OCIR_DB_IMAGE_TAG);\n+\n+  // For kind, replace repo name in image name with KIND_REPO, otherwise use the actual image name\n+  // For example, image container-registry.oracle.com/middleware/weblogic:12.2.1.4 will be pushed/used as\n+  // localhost:5000/middleware/weblogic:12.2.1.4 in kind and in non-kind cluster it will be used as is.\n+  public static final String WEBLOGIC_IMAGE_TO_USE_IN_SPEC = KIND_REPO != null ? KIND_REPO", "originalCommit": "b06d74b61334be811a40f3e8ba8c75228b8e8622", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ4MjM4Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1951#discussion_r498482386", "bodyText": "sure, I will change in next PR as I have to do the testing again.", "author": "vanajamukkara", "createdAt": "2020-10-01T19:59:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ2NzE5MA=="}], "type": "inlineReview"}]}