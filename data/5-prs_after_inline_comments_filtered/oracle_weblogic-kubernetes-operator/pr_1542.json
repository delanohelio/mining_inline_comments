{"pr_number": 1542, "pr_title": "Support SSL in the domain-home-in-image sample", "pr_createdAt": "2020-04-06T20:06:14Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542", "timeline": [{"oid": "15aa7f5f67171e42053c8869a9b19b3736e6e3a1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/15aa7f5f67171e42053c8869a9b19b3736e6e3a1", "message": "update the common utility & domain-home-in-image to support ssl", "committedDate": "2020-03-20T01:05:09Z", "type": "commit"}, {"oid": "4ed267976eceb910e3fe58c4e81f35ab9302bd4a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4ed267976eceb910e3fe58c4e81f35ab9302bd4a", "message": "update the docs", "committedDate": "2020-03-23T01:53:15Z", "type": "commit"}, {"oid": "efc5dd69a10deb1e57b02128ce74388e65112cf5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/efc5dd69a10deb1e57b02128ce74388e65112cf5", "message": "Merge branch 'develop' into develop_ssl_OWLS-76552", "committedDate": "2020-03-23T01:54:52Z", "type": "commit"}, {"oid": "1a126e276d872cfa0a650ea38cca392ef2ab8ffc", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1a126e276d872cfa0a650ea38cca392ef2ab8ffc", "message": "Merge branch 'develop' into develop_ssl_OWLS-76552", "committedDate": "2020-03-23T23:26:04Z", "type": "commit"}, {"oid": "d90c74831431caa3d565fea7c25fb94695686ff3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d90c74831431caa3d565fea7c25fb94695686ff3", "message": "Merge branch 'develop' into develop_ssl_OWLS-76552", "committedDate": "2020-03-28T17:15:29Z", "type": "commit"}, {"oid": "f89ded73168a55f74eb1493bc28bb28d293dd34a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f89ded73168a55f74eb1493bc28bb28d293dd34a", "message": "add ssl tests for 12213-domain-home-in-image", "committedDate": "2020-04-02T00:18:45Z", "type": "commit"}, {"oid": "9beb05845bdd0350cc54840bbe9497c2fa83fb42", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/9beb05845bdd0350cc54840bbe9497c2fa83fb42", "message": "Merge branch 'develop' into develop_ssl_OWLS-76552", "committedDate": "2020-04-02T00:18:54Z", "type": "commit"}, {"oid": "b1e9129ec777ebfd293a5b3e8a46f5e95d3f068e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b1e9129ec777ebfd293a5b3e8a46f5e95d3f068e", "message": "Separate the SSL test", "committedDate": "2020-04-03T17:32:59Z", "type": "commit"}, {"oid": "b45feeee6c7ec7b3ad56c9b76e2f9a6c98d5d219", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b45feeee6c7ec7b3ad56c9b76e2f9a6c98d5d219", "message": "Merge branch 'develop' into develop_ssl_OWLS-76552", "committedDate": "2020-04-03T17:34:00Z", "type": "commit"}, {"oid": "77f68b95323f177eb4f9b8f51f146e3e499dd95c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/77f68b95323f177eb4f9b8f51f146e3e499dd95c", "message": "updated param comments", "committedDate": "2020-04-06T19:44:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM3MDYwMg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r404370602", "bodyText": "fix javadoc.\nstopping review here. please resubmit when you are ready for a review", "author": "markxnelson", "createdAt": "2020-04-06T20:33:43Z", "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItDomainInImage.java", "diffHunk": "@@ -123,6 +123,51 @@ public void testDomainInImageUsingWlst() throws Exception {\n     LoggerHelper.getLocal().log(Level.INFO, \"SUCCESS - \" + testMethodName);\n   }\n \n+\n+  /**\n+   * Create a WLS domain using domain-in-image option. Verify the domain is started\n+   * successfully and the SSL listeners in the WLS servers are active.\n+   *\n+   * @throws Exception exception", "originalCommit": "77f68b95323f177eb4f9b8f51f146e3e499dd95c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM4MjYwOQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r404382609", "bodyText": "Fixing right now and will resubmit shortly.", "author": "qvdang", "createdAt": "2020-04-06T20:56:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM3MDYwMg=="}], "type": "inlineReview"}, {"oid": "6afff98cfc4fabc6bc321f9979bebfbae3ac03eb", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6afff98cfc4fabc6bc321f9979bebfbae3ac03eb", "message": "Update the test's javadoc comments", "committedDate": "2020-04-07T15:59:04Z", "type": "commit"}, {"oid": "a8da611141e65035ddb5d51c6daa1b56b08d0f81", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a8da611141e65035ddb5d51c6daa1b56b08d0f81", "message": "Update domain-home-in-image sample's doc", "committedDate": "2020-04-07T16:23:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3ODU3NQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r405178575", "bodyText": "i would really like to see some assertions in here please", "author": "markxnelson", "createdAt": "2020-04-07T23:48:31Z", "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItDomainInImage.java", "diffHunk": "@@ -123,6 +123,51 @@ public void testDomainInImageUsingWlst() throws Exception {\n     LoggerHelper.getLocal().log(Level.INFO, \"SUCCESS - \" + testMethodName);\n   }\n \n+\n+  /**\n+   * Creates a WebLogic domain using domain-in-image option. Verifies the domain is started\n+   * successfully and the SSL listeners in the WebLogic servers are active.\n+   *\n+   * @throws Exception If an error occurred\n+   */\n+  @Test\n+  public void testDomainInImageUsingWlstWithSSLEnabled() throws Exception {\n+    Assumptions.assumeTrue(FULLTEST);\n+    String testMethodName = new Object() {\n+    }.getClass().getEnclosingMethod().getName();\n+    logTestBegin(testMethodName);\n+\n+    LoggerHelper.getLocal().log(Level.INFO, \"Creating Domain & verifying the domain creation\");\n+    // create domain\n+    Domain domain = null;\n+    boolean testCompletedSuccessfully = false;\n+    try {\n+      Map<String, Object> domainMap = createDomainInImageMap(\n+              getNewSuffixCount(), false, testClassName);\n+      domainMap.put(\"namespace\", domainNS1);\n+      domainMap.remove(\"clusterType\");\n+\n+      // domainMap key/value pairs are hard coded in the create domain method call above\n+      domainMap.put(\"sslEnabled\", Boolean.TRUE);\n+      domainMap.put(\"javaOptions\",\n+              \"-Dweblogic.StdoutDebugEnabled=false -Dweblogic.security.SSL.ignoreHostnameVerification=true\");\n+\n+      domain = TestUtils.createDomain(domainMap);\n+      domain.verifyDomainCreated();\n+      domain.verifySSLListeners();\n+      testCompletedSuccessfully = true;", "originalCommit": "a8da611141e65035ddb5d51c6daa1b56b08d0f81", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzMzE3OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r405533178", "bodyText": "@markxnelson I'm not sure what this comment implies? Are you talking JUnit assertions? JMockit style assertions? Or some other assertions? I may have missed something new here?", "author": "TheFrogPad", "createdAt": "2020-04-08T13:40:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3ODU3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY4MTcyMQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r405681721", "bodyText": "I don't know if there's any additional assurance to have assertions after line 157.  Any of those domain creation, domain verification, SSL listener verification steps throws an exception if it encounters an error.  I can refactor the code to obtain the exec result and do some kind of assertion here but that seems a bit redundant in my opinion.", "author": "qvdang", "createdAt": "2020-04-08T17:10:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3ODU3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc1NDYxNw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r406754617", "bodyText": "@rjeberhard @ddsharpe what do you think?\ni do not like the style of relying on an exception being thrown. if you think there may be one, i prefer to explicitly catch it and write an assertion about whether it was/was not thrown, its type, etc.\ni think the real issue is that someone could independently change any of these methods, and maybe they no longer throw an exception, and now this test would be broken, but we would not know.", "author": "markxnelson", "createdAt": "2020-04-10T13:21:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3ODU3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjgxMzA4Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r406813083", "bodyText": "@qvdang @TheFrogPad @markxnelson I would prefer NOT to rely on Exceptions in this way.  Yes, this is what we did in JUnit4, and it worked.  But, its a somewhat harder to read/debug.  If I come into a test that you wrote, I may not understand that you expected exception and thing its a bug in your test.  I would prefer that we were very explicit about when we expect an exception.  In JUnit4, I used code comments.  In JUnit5, there is no reason not to use the assertions.  It makes it very explicit as to what you intend/expect and others that follow you will have less chance of messing up your work.  One of the benefits of good tests is that YOU (the original author) don't have to be the one to go back and fix all the bugs.  You don't want to be the owner of something for all time.", "author": "ddsharpe", "createdAt": "2020-04-10T15:37:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3ODU3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjk0NzQyOA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r406947428", "bodyText": "Not a problem.  Assertions added.", "author": "qvdang", "createdAt": "2020-04-10T21:14:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3ODU3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3ODY1Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r405178656", "bodyText": "period at end of sentence please", "author": "markxnelson", "createdAt": "2020-04-07T23:48:47Z", "path": "integration-tests/src/test/java/oracle/kubernetes/operator/utils/Domain.java", "diffHunk": "@@ -221,6 +228,24 @@ public void verifyServicesCreated(boolean precreateService) throws Exception {\n     }\n   }\n \n+  /**\n+   * Verifies the SSL listeners in the domain are active by making an SSL connection to each one", "originalCommit": "a8da611141e65035ddb5d51c6daa1b56b08d0f81", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE4NzY1MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1542#discussion_r405187651", "bodyText": "It's clear that our Checkstyle rules are not running for this test code.  Let me follow-up.", "author": "rjeberhard", "createdAt": "2020-04-08T00:18:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3ODY1Ng=="}], "type": "inlineReview"}, {"oid": "6bd41dab08197c56fe0cedc3f6300ffb5a1392ca", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6bd41dab08197c56fe0cedc3f6300ffb5a1392ca", "message": "wording, spelling updates", "committedDate": "2020-04-08T17:15:22Z", "type": "commit"}, {"oid": "972f95a494183936f6fb0b720b5cac0948741d83", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/972f95a494183936f6fb0b720b5cac0948741d83", "message": "added test assertions", "committedDate": "2020-04-10T21:10:42Z", "type": "commit"}, {"oid": "13a0ba99ab7d2b3a3ce1a0f2750c193803edfc71", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/13a0ba99ab7d2b3a3ce1a0f2750c193803edfc71", "message": "Merge branch 'develop' into develop_ssl_OWLS-76552", "committedDate": "2020-04-15T12:46:11Z", "type": "commit"}]}