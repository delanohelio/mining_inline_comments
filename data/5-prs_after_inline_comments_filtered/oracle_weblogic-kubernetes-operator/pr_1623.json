{"pr_number": 1623, "pr_title": "Updated versions of Grafana, Prometheus, added extra debugging", "pr_createdAt": "2020-05-05T16:51:39Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623", "timeline": [{"oid": "3ea7854461320b7e31870820b6f6bba15a48f412", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3ea7854461320b7e31870820b6f6bba15a48f412", "message": "added more debug info", "committedDate": "2020-04-29T22:13:28Z", "type": "commit"}, {"oid": "8cdd8014310979dbe0ab61d1252f6a6ce279dce5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8cdd8014310979dbe0ab61d1252f6a6ce279dce5", "message": "added more debug info1", "committedDate": "2020-04-30T00:31:44Z", "type": "commit"}, {"oid": "f0d41cf5e99d478a020be1dcb37d8feae13dc6dc", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f0d41cf5e99d478a020be1dcb37d8feae13dc6dc", "message": " added debug to deploy app", "committedDate": "2020-04-30T16:59:38Z", "type": "commit"}, {"oid": "040f8fa2f180a7d15c0db1426aa54a38d6c87c09", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/040f8fa2f180a7d15c0db1426aa54a38d6c87c09", "message": "changed version prom", "committedDate": "2020-04-30T18:12:26Z", "type": "commit"}, {"oid": "7c292f89053d86690bb9c04e0f3ab57bf015bead", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7c292f89053d86690bb9c04e0f3ab57bf015bead", "message": " added debug", "committedDate": "2020-04-30T21:36:41Z", "type": "commit"}, {"oid": "fed6a51c0c256194ab4af9682caaaa0cb9c42ed1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fed6a51c0c256194ab4af9682caaaa0cb9c42ed1", "message": "fixstyle", "committedDate": "2020-04-30T21:54:06Z", "type": "commit"}, {"oid": "9bbd10ffd756bbfcb0eb238394f9a9b5e388abc4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/9bbd10ffd756bbfcb0eb238394f9a9b5e388abc4", "message": "added sed", "committedDate": "2020-04-30T23:04:22Z", "type": "commit"}, {"oid": "87c1829dbaee740c9600911c783df8f6b5e6b052", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/87c1829dbaee740c9600911c783df8f6b5e6b052", "message": "fixed typo", "committedDate": "2020-04-30T23:40:11Z", "type": "commit"}, {"oid": "2e9671d71255c0559a8e89b38c5c22f622d85d16", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/2e9671d71255c0559a8e89b38c5c22f622d85d16", "message": "fixed logic", "committedDate": "2020-05-01T00:10:04Z", "type": "commit"}, {"oid": "bba2e0c3b5f41b309d94a296d9b0fc763717ef78", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/bba2e0c3b5f41b309d94a296d9b0fc763717ef78", "message": "added debug for grafana", "committedDate": "2020-05-01T00:14:01Z", "type": "commit"}, {"oid": "c100a14d876a5cf19b2b7d12012d8ed15e6ea284", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c100a14d876a5cf19b2b7d12012d8ed15e6ea284", "message": "fixed bash", "committedDate": "2020-05-01T00:50:51Z", "type": "commit"}, {"oid": "f6ac186faa1c3fe6d99d60e54887595fab90b1ba", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f6ac186faa1c3fe6d99d60e54887595fab90b1ba", "message": "fixed order", "committedDate": "2020-05-01T01:36:22Z", "type": "commit"}, {"oid": "96e267e7fdc553056b1e6499948a3abf1af96d1b", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/96e267e7fdc553056b1e6499948a3abf1af96d1b", "message": "separated scripts", "committedDate": "2020-05-01T02:05:44Z", "type": "commit"}, {"oid": "7a11bb461b4cd2edee6b7289dec7326806637d3f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7a11bb461b4cd2edee6b7289dec7326806637d3f", "message": "updated grafana ver", "committedDate": "2020-05-01T16:25:25Z", "type": "commit"}, {"oid": "a6dea01fcdb8ae9e6fd57c3cf199681770e255cd", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a6dea01fcdb8ae9e6fd57c3cf199681770e255cd", "message": "updated grafana ver1", "committedDate": "2020-05-01T16:44:00Z", "type": "commit"}, {"oid": "0b2b7c67b86966ca41d9f377bac2eaeedc8f9264", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0b2b7c67b86966ca41d9f377bac2eaeedc8f9264", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into mondebug", "committedDate": "2020-05-01T16:44:12Z", "type": "commit"}, {"oid": "310a4c4c07cdd23b80b353b61fc31a40b6e47c44", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/310a4c4c07cdd23b80b353b61fc31a40b6e47c44", "message": "fixed redeploy", "committedDate": "2020-05-02T20:46:01Z", "type": "commit"}, {"oid": "bc98eff3ddf361a7a86ee2481910ff638f39a26c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/bc98eff3ddf361a7a86ee2481910ff638f39a26c", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into mondebug", "committedDate": "2020-05-02T20:46:09Z", "type": "commit"}, {"oid": "d1d7ee99eb61113c17b9f986adbf6a89d6fe3a4b", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d1d7ee99eb61113c17b9f986adbf6a89d6fe3a4b", "message": "corrected scripts", "committedDate": "2020-05-02T23:47:19Z", "type": "commit"}, {"oid": "21ca726343d761c798871ebd65b644a1cf715707", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/21ca726343d761c798871ebd65b644a1cf715707", "message": "added extra check", "committedDate": "2020-05-03T00:03:28Z", "type": "commit"}, {"oid": "86bed8ae394e439518638c746b2f1543a990e129", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/86bed8ae394e439518638c746b2f1543a990e129", "message": "added extra class just for Promdebug", "committedDate": "2020-05-03T15:17:07Z", "type": "commit"}, {"oid": "559e4eae51a9a764ef341991bb9d7d21cc3c19c4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/559e4eae51a9a764ef341991bb9d7d21cc3c19c4", "message": "added more debug", "committedDate": "2020-05-03T15:46:29Z", "type": "commit"}, {"oid": "95e2768c43431a9df47e5210e06e0f7a856c4e91", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/95e2768c43431a9df47e5210e06e0f7a856c4e91", "message": "added more debug1", "committedDate": "2020-05-03T16:16:33Z", "type": "commit"}, {"oid": "18df958f879849a301fa5c1268d0d82b7486c1fe", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/18df958f879849a301fa5c1268d0d82b7486c1fe", "message": "fixed typo", "committedDate": "2020-05-03T16:36:16Z", "type": "commit"}, {"oid": "0cce76be75f9c2e5a4de98f490767c6988bbc0c3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0cce76be75f9c2e5a4de98f490767c6988bbc0c3", "message": "TEMP cleanup", "committedDate": "2020-05-03T16:41:55Z", "type": "commit"}, {"oid": "4651f48761af4ccf8de216a5e32cac2b87cf1151", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4651f48761af4ccf8de216a5e32cac2b87cf1151", "message": "removed TEMP", "committedDate": "2020-05-03T16:50:04Z", "type": "commit"}, {"oid": "866eedd02e4c9e86747aa32e6ef5f6d1c05caef2", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/866eedd02e4c9e86747aa32e6ef5f6d1c05caef2", "message": "fixed typo", "committedDate": "2020-05-03T16:57:43Z", "type": "commit"}, {"oid": "ecd06be7680052b4b6eff8c25e19826314b9f926", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ecd06be7680052b4b6eff8c25e19826314b9f926", "message": "delete debug", "committedDate": "2020-05-03T17:04:18Z", "type": "commit"}, {"oid": "d96346ea5b9967d1ba6d8b77e1d6ee7915115212", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d96346ea5b9967d1ba6d8b77e1d6ee7915115212", "message": "more debug", "committedDate": "2020-05-03T17:23:50Z", "type": "commit"}, {"oid": "e0a52d1205ade770625d8c3e82d4e7c61e3ba03e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e0a52d1205ade770625d8c3e82d4e7c61e3ba03e", "message": "added view logs", "committedDate": "2020-05-03T17:36:12Z", "type": "commit"}, {"oid": "73e366d23a935ed216b6cb7d2ca81dcb3264c335", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/73e366d23a935ed216b6cb7d2ca81dcb3264c335", "message": " deleted testfile", "committedDate": "2020-05-03T19:56:48Z", "type": "commit"}, {"oid": "799aee289d10e9629cd38fd239aa179e2c004d51", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/799aee289d10e9629cd38fd239aa179e2c004d51", "message": "added log collection", "committedDate": "2020-05-04T16:33:24Z", "type": "commit"}, {"oid": "fdf93c068de3503d937cd3ece06db28bb80fe433", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fdf93c068de3503d937cd3ece06db28bb80fe433", "message": "added more debug info", "committedDate": "2020-05-04T21:59:18Z", "type": "commit"}, {"oid": "0a431986e49205786c953609999e736ab3cdefbf", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0a431986e49205786c953609999e736ab3cdefbf", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into mondebug", "committedDate": "2020-05-04T21:59:59Z", "type": "commit"}, {"oid": "65e5632eda54167249a4b995aa204691b396294e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/65e5632eda54167249a4b995aa204691b396294e", "message": "deleted commented out blocks", "committedDate": "2020-05-05T16:45:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI2NDIyOQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420264229", "bodyText": "FULLTEST or QUICKTEST ?", "author": "sankarpn", "createdAt": "2020-05-05T16:59:16Z", "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "diffHunk": "@@ -179,35 +173,35 @@ public void prepare() throws Exception {\n    */\n   @AfterAll\n   public static void staticUnPrepare() throws Exception {\n-    if (FULLTEST) {\n-      if (domain != null) {\n-        domain.destroy();\n-        TestUtils.deleteWeblogicDomainResources(domainNS1);\n-        if (BaseTest.SHARED_CLUSTER) {\n-\n-          String image = System.getenv(\"REPO_REGISTRY\")\n-              + \"/weblogick8s/\"\n-              + domainNS2\n-              + \"-image:\" + currentDateTime;\n-          String cmd = \"docker rmi -f \" + image;\n-          TestUtils.execOrAbortProcess(cmd, true);\n-        }\n-        String cmd = \"docker rmi -f \" + domainNS2 + \"-image:\" + currentDateTime;\n+    Assumptions.assumeTrue(QUICKTEST);", "originalCommit": "65e5632eda54167249a4b995aa204691b396294e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI2OTE3Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420269176", "bodyText": "fixed , thank you", "author": "marinakog", "createdAt": "2020-05-05T17:07:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI2NDIyOQ=="}], "type": "inlineReview"}, {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c7b589b1db902abe331f09326490a532e87fe3bb", "message": "fixed typo", "committedDate": "2020-05-05T17:04:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI4NDMzNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420284335", "bodyText": "If its a SHARED_CLUSTER both docker rmi -f commands get executed or line # 189 is supposed to be in a else block?", "author": "sankarpn", "createdAt": "2020-05-05T17:30:47Z", "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "diffHunk": "@@ -179,35 +173,35 @@ public void prepare() throws Exception {\n    */\n   @AfterAll\n   public static void staticUnPrepare() throws Exception {\n-    if (FULLTEST) {\n-      if (domain != null) {\n-        domain.destroy();\n-        TestUtils.deleteWeblogicDomainResources(domainNS1);\n-        if (BaseTest.SHARED_CLUSTER) {\n-\n-          String image = System.getenv(\"REPO_REGISTRY\")\n-              + \"/weblogick8s/\"\n-              + domainNS2\n-              + \"-image:\" + currentDateTime;\n-          String cmd = \"docker rmi -f \" + image;\n-          TestUtils.execOrAbortProcess(cmd, true);\n-        }\n-        String cmd = \"docker rmi -f \" + domainNS2 + \"-image:\" + currentDateTime;\n+    Assumptions.assumeTrue(FULLTEST);\n+    if (domain != null) {\n+      domain.destroy();\n+      TestUtils.deleteWeblogicDomainResources(domainNS1);\n+      if (BaseTest.SHARED_CLUSTER) {\n+\n+        String image = System.getenv(\"REPO_REGISTRY\")\n+            + \"/weblogick8s/\"\n+            + domainNS2\n+            + \"-image:\" + currentDateTime;\n+        String cmd = \"docker rmi -f \" + image;\n         TestUtils.execOrAbortProcess(cmd, true);\n       }\n-      if (operator != null) {\n-        operator.destroy();\n-      }\n-      try {\n-        uninstallWebHookPrometheusGrafanaMySql();\n-      } catch (Exception ex) {\n-        LoggerHelper.getLocal().log(Level.INFO,\n-            \"Exception caught while uninstalling webhook/prometheus/Grafana/Mysql \" + ex.getMessage());\n-      }\n-\n-      tearDown(new Object() {}.getClass().getEnclosingClass().getSimpleName(), namespaceList.toString());\n-      LoggerHelper.getLocal().log(Level.INFO,\"SUCCESS\");\n+      String cmd = \"docker rmi -f \" + domainNS2 + \"-image:\" + currentDateTime;\n+      TestUtils.execOrAbortProcess(cmd, true);", "originalCommit": "c7b589b1db902abe331f09326490a532e87fe3bb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI4Njk4MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420286980", "bodyText": "yes, if shared cluster it also tags image to [ocipath]/imagename as well, so need to delete both images [ocipath]/imagename in else block for shared cluster and \"imagename\" in general", "author": "marinakog", "createdAt": "2020-05-05T17:35:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI4NDMzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM2MzQ1OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420363458", "bodyText": "if the exit value was not zero, you will never get to this line.\nif you need the result, you have to use ExecCommand.exec() instead", "author": "markxnelson", "createdAt": "2020-05-05T19:46:23Z", "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "diffHunk": "@@ -260,12 +254,19 @@ private static void executeShelScript(String srcLoc, String destLoc, String file\n             + args\n             + \" | tee \"\n             + outLogFile;\n-    TestUtils.execOrAbortProcess(crdCmd, true);\n-    crdCmd = \" cat \" + destLoc + \"/\" + outLogFile;\n-    ExecResult result = ExecCommand.exec(crdCmd);\n-    assertFalse(\n-        result.stdout().contains(\"BUILD FAILURE\"), \"Shell script failed: \" + result.stdout());\n+    ExecResult result = TestUtils.execOrAbortProcess(crdCmd, true);\n+    if (result.exitValue() != 0) {", "originalCommit": "c7b589b1db902abe331f09326490a532e87fe3bb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTAwODgzMw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r421008833", "bodyText": "replaced with execCommand.exec()", "author": "marinakog", "createdAt": "2020-05-06T18:38:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM2MzQ1OA=="}], "type": "inlineReview"}, {"oid": "6908d1774f9d4ce313914c79dc7be9a4506d8249", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6908d1774f9d4ce313914c79dc7be9a4506d8249", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into mondebug", "committedDate": "2020-05-06T18:07:46Z", "type": "commit"}, {"oid": "db688775945384f0f15d1609ab6636bf1ef279ea", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/db688775945384f0f15d1609ab6636bf1ef279ea", "message": "reverted deploywebapp.py to dev version, needed only for extra debugging", "committedDate": "2020-05-06T18:09:24Z", "type": "commit"}, {"oid": "551da9491bb5604d42c28866416a8809ff28479f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/551da9491bb5604d42c28866416a8809ff28479f", "message": "replaced exec", "committedDate": "2020-05-06T18:34:37Z", "type": "commit"}]}