{"pr_number": 2042, "pr_title": "Remove deprecated methods from RC.", "pr_createdAt": "2020-10-06T16:45:58Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/2042", "timeline": [{"oid": "ca25e51bd762a792b83d428f0899a0d27f9c300d", "url": "https://github.com/firebase/firebase-android-sdk/commit/ca25e51bd762a792b83d428f0899a0d27f9c300d", "message": "Remove deprecated methods from RC.", "committedDate": "2020-10-06T16:43:56Z", "type": "commit"}, {"oid": "04a1bf1cfa11aebbfe260521ef0a82dd5d4b1143", "url": "https://github.com/firebase/firebase-android-sdk/commit/04a1bf1cfa11aebbfe260521ef0a82dd5d4b1143", "message": "Regenerate api.txt.", "committedDate": "2020-10-06T16:45:02Z", "type": "commit"}, {"oid": "a38122646a3a23359838908415240645c4526f8b", "url": "https://github.com/firebase/firebase-android-sdk/commit/a38122646a3a23359838908415240645c4526f8b", "message": "Put back deprecation on test.", "committedDate": "2020-10-06T16:45:19Z", "type": "commit"}, {"oid": "38699c0ae679d400bff374c567ca48a32b29eb89", "url": "https://github.com/firebase/firebase-android-sdk/commit/38699c0ae679d400bff374c567ca48a32b29eb89", "message": "Update Bandwagoner to use new APIs.", "committedDate": "2020-10-06T17:05:34Z", "type": "commit"}, {"oid": "32eb45a2943ea97b4b07b82871e13206b39592eb", "url": "https://github.com/firebase/firebase-android-sdk/commit/32eb45a2943ea97b4b07b82871e13206b39592eb", "message": "Use async method in tests.", "committedDate": "2020-10-06T22:41:39Z", "type": "commit"}, {"oid": "5fc3cbc34d2e11f24f8cf3b95adc3522ff17a944", "url": "https://github.com/firebase/firebase-android-sdk/commit/5fc3cbc34d2e11f24f8cf3b95adc3522ff17a944", "message": "googleJavaFormat", "committedDate": "2020-10-07T14:52:05Z", "type": "commit"}, {"oid": "69d06416aeeca3e4eb0a2a77bdfb5abac896d299", "url": "https://github.com/firebase/firebase-android-sdk/commit/69d06416aeeca3e4eb0a2a77bdfb5abac896d299", "message": "Fix up some tests.", "committedDate": "2020-10-07T15:47:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1MjQyNg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501252426", "bodyText": "Thinking (no action req'd): after we remove the sync methods, we'll be able to drop the \"async\" suffix and use the setConfigSettings signature for async \ud83d\udc4d", "author": "erikeldridge", "createdAt": "2020-10-07T19:18:23Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -517,17 +459,6 @@ public FirebaseRemoteConfigInfo getInfo() {\n     return frcMetadata.getInfo();\n   }\n \n-  /**\n-   * Changes the settings for this {@link FirebaseRemoteConfig} instance.\n-   *\n-   * @param settings The new settings to be applied.\n-   * @deprecated Use {@link #setConfigSettingsAsync(FirebaseRemoteConfigSettings)} instead.\n-   */", "originalCommit": "69d06416aeeca3e4eb0a2a77bdfb5abac896d299", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM2NzQxOA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501367418", "bodyText": "We could, but that'd be a breaking API change, too.", "author": "danasilver", "createdAt": "2020-10-07T23:31:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1MjQyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk4Nzc5OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501987798", "bodyText": "I wonder if, instead of deleting this one, we could change it's return type to Task and deprecate the setConfigSettingsAsync() method. And then at some point delete the \"Async\" method. wdyt?", "author": "vkryachko", "createdAt": "2020-10-08T20:17:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1MjQyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk5MDgzMA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501990830", "bodyText": "Would that be more confusing or error prone for developers on this update path? I'd figure many people use the deprecated sync methods and don't check the return type. Might create unexpected behavior to make them async with the existing name.", "author": "danasilver", "createdAt": "2020-10-08T20:24:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1MjQyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjAwMjI0Mw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r502002243", "bodyText": "This PR currently removes the setConfigSettings method, so anyone using it is going to have to change code. The same would be true if we retained the method and made it async. Ultimately, I think it's relatively minor, since naming is hard :)", "author": "erikeldridge", "createdAt": "2020-10-08T20:45:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1MjQyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjAxOTIzMQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r502019231", "bodyText": "Yeah, my thought is that requiring the new method with Async in the name will prevent users from blindly switching to a method that's now async (when they previously might have fired and forgot, expecting a sync call).", "author": "danasilver", "createdAt": "2020-10-08T21:20:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1MjQyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1NTIxMA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501255210", "bodyText": "Thinking (no action req'd): I wonder why a simple overload of setDefaults was insufficient and we needed to add the WithStringsMap qualifier", "author": "erikeldridge", "createdAt": "2020-10-07T19:23:34Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -693,20 +578,6 @@ private boolean processActivatePutTask(Task<ConfigContainer> putTask) {\n     return false;\n   }\n \n-  /**\n-   * Asynchronously sets the defaults cache to the given default values, and persists the values to\n-   * disk.\n-   */\n-  private void setDefaultsWithStringsMap(Map<String, String> defaultsStringMap) {", "originalCommit": "69d06416aeeca3e4eb0a2a77bdfb5abac896d299", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM2NzU4OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501367588", "bodyText": "\ud83d\ude04", "author": "danasilver", "createdAt": "2020-10-07T23:31:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1NTIxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1NzQ0OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501257449", "bodyText": "Given the deprecation guidance on FirebaseRemoteConfigFetchException is to use FirebaseRemoteConfigServerException or FirebaseRemoteConfigClientException, I wonder if we should be deprecating FirebaseRemoteConfigFetchThrottledException. If so, we could make that a tiny follow-up change just to keep this PR focused.", "author": "erikeldridge", "createdAt": "2020-10-07T19:27:44Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfigFetchThrottledException.java", "diffHunk": "@@ -15,8 +15,7 @@\n package com.google.firebase.remoteconfig;\n \n /** An exception thrown when a {@link FirebaseRemoteConfig#fetch()} call is throttled. */\n-public class FirebaseRemoteConfigFetchThrottledException\n-    extends FirebaseRemoteConfigFetchException {\n+public class FirebaseRemoteConfigFetchThrottledException extends FirebaseRemoteConfigException {", "originalCommit": "69d06416aeeca3e4eb0a2a77bdfb5abac896d299", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM2ODU1NQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501368555", "bodyText": "The throttled exception makes more sense to me to keep since it has info (throttleEndTimeMillis) the super class doesn't.", "author": "danasilver", "createdAt": "2020-10-07T23:34:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1NzQ0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjAwMjcxOQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r502002719", "bodyText": "Good point", "author": "erikeldridge", "createdAt": "2020-10-08T20:46:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1NzQ0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1ODg1OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501258858", "bodyText": "Thinking (no action req'd): I'm happy to see us reducing sources of ambiguity like this fire-and-forget async update", "author": "erikeldridge", "createdAt": "2020-10-07T19:30:26Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigCacheClient.java", "diffHunk": "@@ -78,17 +78,6 @@ private ConfigCacheClient(ExecutorService executorService, ConfigStorageClient s\n     cachedContainerTask = null;\n   }\n \n-  /**\n-   * Sets the in-memory {@link ConfigContainer} to {@code configContainer} and then starts the file\n-   * write to save the new config to disk.\n-   *\n-   * @return A {@link Task} representing the write to disk.\n-   */\n-  public Task<ConfigContainer> putWithoutWaitingForDiskWrite(ConfigContainer configContainer) {", "originalCommit": "69d06416aeeca3e4eb0a2a77bdfb5abac896d299", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4MDg1MQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501280851", "bodyText": "Dumb question: IIUC, this test app calls a live RC endpoint, in which case setting a timeout of 0s seems aggressive; any chance the intent is to bypass the cache (setMinimumFetchIntervalInSeconds ), which is closer to the functionality of developer mode, rather than setting a timeout?", "author": "erikeldridge", "createdAt": "2020-10-07T20:11:54Z", "path": "firebase-config/bandwagoner/src/main/java/com/googletest/firebase/remoteconfig/bandwagoner/ApiFragment.java", "diffHunk": "@@ -64,8 +64,8 @@ public void onCreate(Bundle savedInstanceState) {\n     super.onCreate(savedInstanceState);\n \n     frc = FirebaseRemoteConfig.getInstance();\n-    frc.setConfigSettings(\n-        new FirebaseRemoteConfigSettings.Builder().setDeveloperModeEnabled(true).build());\n+    frc.setConfigSettingsAsync(\n+        new FirebaseRemoteConfigSettings.Builder().setFetchTimeoutInSeconds(0L).build());", "originalCommit": "69d06416aeeca3e4eb0a2a77bdfb5abac896d299", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM2ODk2OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2042#discussion_r501368969", "bodyText": "Not a dumb question! That is actually what I intended to do, but I set the wrong setting! Thanks for questioning it. :P", "author": "danasilver", "createdAt": "2020-10-07T23:36:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4MDg1MQ=="}], "type": "inlineReview"}, {"oid": "102a838f96bdda9858d3c238072daea129f543fe", "url": "https://github.com/firebase/firebase-android-sdk/commit/102a838f96bdda9858d3c238072daea129f543fe", "message": "Set fetch interval instead of timeout in Bandwagoner.", "committedDate": "2020-10-07T23:40:08Z", "type": "commit"}]}