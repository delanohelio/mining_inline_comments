{"pr_number": 2646, "pr_title": "Workflow step definitions", "pr_createdAt": "2020-01-21T15:09:06Z", "pr_url": "https://github.com/DSpace/DSpace/pull/2646", "timeline": [{"oid": "58870b079d48047d54c3035facb3335085e1f505", "url": "https://github.com/DSpace/DSpace/commit/58870b079d48047d54c3035facb3335085e1f505", "message": "67694: new /api/config/workflowsdefintions endpoints:\n/api/config/workflowdefinitions/<:definition-name>\n/api/config/workflowdefinitions\n/api/config/workflowdefinitions/search/findByCollection?uuid=<:collection-uuid>\n/api/config/workflowdefinitions/<:definition-name>/collections\n\nSigned-off-by: Marie Verdonck <maria.verdonck@atmire.com>", "committedDate": "2019-12-11T12:58:24Z", "type": "commit"}, {"oid": "6084fae35797adcd778f6d5e832b421103f75137", "url": "https://github.com/DSpace/DSpace/commit/6084fae35797adcd778f6d5e832b421103f75137", "message": "67694: checkstyle and licenses", "committedDate": "2019-12-12T09:42:04Z", "type": "commit"}, {"oid": "8a3479e75349028a33b5659eebd5b78894bebadf", "url": "https://github.com/DSpace/DSpace/commit/8a3479e75349028a33b5659eebd5b78894bebadf", "message": "67694: Exception handling improvements and /search moved to repository", "committedDate": "2019-12-17T10:08:17Z", "type": "commit"}, {"oid": "943b3f13565cf2c0412d68388012ea80e4ad59a4", "url": "https://github.com/DSpace/DSpace/commit/943b3f13565cf2c0412d68388012ea80e4ad59a4", "message": "67694: isDefault fix, workflowdefinitions IT, exception handling", "committedDate": "2019-12-17T15:31:31Z", "type": "commit"}, {"oid": "39c727a8032e35f5a7ac9f41a908c65527eb93ca", "url": "https://github.com/DSpace/DSpace/commit/39c727a8032e35f5a7ac9f41a908c65527eb93ca", "message": "67694: forgot to log error stack itself", "committedDate": "2019-12-19T09:50:02Z", "type": "commit"}, {"oid": "7ef537507f30ce2ac7d18807322d482113ecad17", "url": "https://github.com/DSpace/DSpace/commit/7ef537507f30ce2ac7d18807322d482113ecad17", "message": "- Merged with KevinVdV/DSpace/DS-4239-migrate-workflow-xml-to-spring\n- Changed all implementations of XmlWorkflowFactoryImpl to work with new mapping\n- Moved their java doc to XmlWorkflowFactory\n- Removed/Changed exceptions\n- Altered tests in WorkflowDefinitionRestRepositoryIT to work with changes\n\nMerge remote-tracking branch 'github-kevin/DS-4239-migrate-workflow-xml-to-spring' into workflow-step-definitions\n\n# Conflicts:\n#\tdspace-api/src/main/java/org/dspace/xmlworkflow/XmlWorkflowFactoryImpl.java\n#\tdspace-api/src/main/java/org/dspace/xmlworkflow/factory/XmlWorkflowFactory.java", "committedDate": "2019-12-20T10:21:17Z", "type": "commit"}, {"oid": "59ef4ef0652c13a5c33b2ad55ced5f3f87c954b0", "url": "https://github.com/DSpace/DSpace/commit/59ef4ef0652c13a5c33b2ad55ced5f3f87c954b0", "message": "Merge branch 'w2p-67996-workflow-junit-tests' into workflow-step-definitions", "committedDate": "2019-12-20T10:22:59Z", "type": "commit"}, {"oid": "2521fa5107820a65a2e66e8fb8ef2b860cd521f4", "url": "https://github.com/DSpace/DSpace/commit/2521fa5107820a65a2e66e8fb8ef2b860cd521f4", "message": "67998: Merged in w2p-67996, altered XmlWorkflowFactoryTest to destroy created comcol", "committedDate": "2019-12-23T11:09:02Z", "type": "commit"}, {"oid": "414b82f9cb73853933ab20aa0df32ad2d27db767", "url": "https://github.com/DSpace/DSpace/commit/414b82f9cb73853933ab20aa0df32ad2d27db767", "message": "67998: feedback exceptions", "committedDate": "2020-01-02T16:05:19Z", "type": "commit"}, {"oid": "9dd433412ac41ae759f2d36c2dd846c9b9d25d71", "url": "https://github.com/DSpace/DSpace/commit/9dd433412ac41ae759f2d36c2dd846c9b9d25d71", "message": "67998: tested config handle moved, since other non-collection dso already create at that handle", "committedDate": "2020-01-02T16:40:18Z", "type": "commit"}, {"oid": "d8dc4f113c1bbaa8406b30f65ee21f7e412d7059", "url": "https://github.com/DSpace/DSpace/commit/d8dc4f113c1bbaa8406b30f65ee21f7e412d7059", "message": "67998: non-numbered handle config so can't accidentally be created", "committedDate": "2020-01-03T11:39:06Z", "type": "commit"}, {"oid": "7ed292e7542d5b9db8a051d85bca1d6b07d01b8b", "url": "https://github.com/DSpace/DSpace/commit/7ed292e7542d5b9db8a051d85bca1d6b07d01b8b", "message": "68150: fix and tests for pagination for api/config/workflowdefinitions", "committedDate": "2020-01-03T16:11:26Z", "type": "commit"}, {"oid": "a254ae31e29b3b19250144db995f4a4f6f8ebefe", "url": "https://github.com/DSpace/DSpace/commit/a254ae31e29b3b19250144db995f4a4f6f8ebefe", "message": "68150: /workflowdefinitions/defaultWorkflow/collections now returns all non-mapped collections and now returns paginated result + tests", "committedDate": "2020-01-06T11:50:52Z", "type": "commit"}, {"oid": "2c6c51752e98f8ebc5ed0d6730d1f54464817502", "url": "https://github.com/DSpace/DSpace/commit/2c6c51752e98f8ebc5ed0d6730d1f54464817502", "message": "68155: /api/config/workflowactions/<:action-name> endpoint + tests", "committedDate": "2020-01-06T15:50:02Z", "type": "commit"}, {"oid": "50eb5be31c888899160f37f8d2384ff193e16260", "url": "https://github.com/DSpace/DSpace/commit/50eb5be31c888899160f37f8d2384ff193e16260", "message": "68150: resolve collection handles to collection in XmlWorkflowFactory & forgotten exception", "committedDate": "2020-01-08T10:55:19Z", "type": "commit"}, {"oid": "4f0b48b4ffd13c23db0931eb120223653cd34171", "url": "https://github.com/DSpace/DSpace/commit/4f0b48b4ffd13c23db0931eb120223653cd34171", "message": "68155: SUBMIT_CANCEL option removed from SelectReviewerAction", "committedDate": "2020-01-08T13:13:40Z", "type": "commit"}, {"oid": "22b1f6231d4252a1031e68daad2556c0a5aed02b", "url": "https://github.com/DSpace/DSpace/commit/22b1f6231d4252a1031e68daad2556c0a5aed02b", "message": "68155: xmlWorkflowFactory autowired where possible & WorkflowAction.name > id", "committedDate": "2020-01-09T13:24:37Z", "type": "commit"}, {"oid": "766d021a1a56e32934e5a1fea6eda46a5fd96259", "url": "https://github.com/DSpace/DSpace/commit/766d021a1a56e32934e5a1fea6eda46a5fd96259", "message": "68253: GET /api/config/workflowsteps/<:step-name> endpoint", "committedDate": "2020-01-10T16:01:33Z", "type": "commit"}, {"oid": "2c5acf0cfb8a0b2b424c56c247d20ff000919b8c", "url": "https://github.com/DSpace/DSpace/commit/2c5acf0cfb8a0b2b424c56c247d20ff000919b8c", "message": "68253: GET /api/config/workflowsteps/<:step-name> IT", "committedDate": "2020-01-13T11:45:54Z", "type": "commit"}, {"oid": "b76933e7c122da7545b76cbc9587f9784d9c6914", "url": "https://github.com/DSpace/DSpace/commit/b76933e7c122da7545b76cbc9587f9784d9c6914", "message": "68274: /api/config/workflowdefinitions/<:definition-name>/steps endpoint and link", "committedDate": "2020-01-14T12:06:27Z", "type": "commit"}, {"oid": "c171140371efa605dd145178255af577e293a484", "url": "https://github.com/DSpace/DSpace/commit/c171140371efa605dd145178255af577e293a484", "message": "68274: /workflowdefinitions/<:definition-name>/steps endpoint as embedded resource and collections link", "committedDate": "2020-01-16T13:19:11Z", "type": "commit"}, {"oid": "25dd5162b0cb7b42974ca8de6ea911dd7bfe11ea", "url": "https://github.com/DSpace/DSpace/commit/25dd5162b0cb7b42974ca8de6ea911dd7bfe11ea", "message": "Merge branch 'DS-4239-migrate-workflow-xml-to-spring' into workflow-step-definitions", "committedDate": "2020-01-21T08:30:07Z", "type": "commit"}, {"oid": "20d9b330d097676fbf4c7890f90c9642b87246d2", "url": "https://github.com/DSpace/DSpace/commit/20d9b330d097676fbf4c7890f90c9642b87246d2", "message": "Fixing merge issue in the workflow-actions.xml file", "committedDate": "2020-01-21T11:49:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgyNzE3Mg==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r371827172", "bodyText": "Can you add JavaDocs here", "author": "benbosman", "createdAt": "2020-01-28T14:16:48Z", "path": "dspace-api/src/main/java/org/dspace/xmlworkflow/state/actions/WorkflowActionConfig.java", "diffHunk": "@@ -59,4 +61,8 @@ public Step getStep() {\n         return step;\n     }\n \n+    public List<String> getOptions() {", "originalCommit": "20d9b330d097676fbf4c7890f90c9642b87246d2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgyNzQ2MA==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r371827460", "bodyText": "Can you add JavaDocs here", "author": "benbosman", "createdAt": "2020-01-28T14:17:18Z", "path": "dspace-api/src/main/java/org/dspace/xmlworkflow/state/actions/Action.java", "diffHunk": "@@ -36,15 +36,16 @@\n public abstract class Action {\n \n     private WorkflowActionConfig parent;\n-    private static String ERROR_FIELDS_ATTRIBUTE = \"dspace.workflow.error_fields\";\n-\n+    private static final String ERROR_FIELDS_ATTRIBUTE = \"dspace.workflow.error_fields\";\n \n     public abstract void activate(Context c, XmlWorkflowItem wf)\n         throws SQLException, IOException, AuthorizeException, WorkflowException;\n \n     public abstract ActionResult execute(Context c, XmlWorkflowItem wfi, Step step, HttpServletRequest request)\n         throws SQLException, AuthorizeException, IOException, WorkflowException;\n \n+    public abstract List<String> getOptions();", "originalCommit": "20d9b330d097676fbf4c7890f90c9642b87246d2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgyOTIyMQ==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r371829221", "bodyText": "Since SUBMIT_EDIT_METADATA is a 'special' action, would it make sense to set it in the ProcessingAction for reuse?", "author": "benbosman", "createdAt": "2020-01-28T14:20:21Z", "path": "dspace-api/src/main/java/org/dspace/xmlworkflow/state/actions/processingaction/AcceptEditRejectAction.java", "diffHunk": "@@ -31,40 +33,50 @@\n  */\n public class AcceptEditRejectAction extends ProcessingAction {\n \n-    public static final int MAIN_PAGE = 0;\n-    public static final int REJECT_PAGE = 1;\n+    private static final String SUBMIT_APPROVE = \"submit_approve\";\n+    private static final String SUBMIT_REJECT = \"submit_reject\";\n+    private static final String SUBMIT_EDIT_METADATA = \"submit_edit_metadata\";", "originalCommit": "20d9b330d097676fbf4c7890f90c9642b87246d2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg1MDE2Nw==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r371850167", "bodyText": "I would expect a more generic 400 or 500 exception here since it exists but can't be retrieved", "author": "benbosman", "createdAt": "2020-01-28T14:53:20Z", "path": "dspace-server-webapp/src/main/java/org/dspace/app/rest/repository/WorkflowDefinitionRestRepository.java", "diffHunk": "@@ -0,0 +1,89 @@\n+/**\n+ * The contents of this file are subject to the license and copyright\n+ * detailed in the LICENSE and NOTICE files at the root of the source\n+ * tree and available online at\n+ *\n+ * http://www.dspace.org/license/\n+ */\n+package org.dspace.app.rest.repository;\n+\n+import java.sql.SQLException;\n+import java.util.List;\n+import java.util.UUID;\n+\n+import org.dspace.app.rest.Parameter;\n+import org.dspace.app.rest.SearchRestMethod;\n+import org.dspace.app.rest.model.WorkflowDefinitionRest;\n+import org.dspace.content.Collection;\n+import org.dspace.content.service.CollectionService;\n+import org.dspace.core.Context;\n+import org.dspace.xmlworkflow.WorkflowConfigurationException;\n+import org.dspace.xmlworkflow.factory.XmlWorkflowFactory;\n+import org.dspace.xmlworkflow.state.Workflow;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.data.domain.Page;\n+import org.springframework.data.domain.Pageable;\n+import org.springframework.data.rest.webmvc.ResourceNotFoundException;\n+import org.springframework.stereotype.Component;\n+\n+/**\n+ * This is the rest repository responsible for managing WorkflowDefinition Rest objects\n+ *\n+ * @author Maria Verdonck (Atmire) on 11/12/2019\n+ */\n+@Component(WorkflowDefinitionRest.CATEGORY + \".\" + WorkflowDefinitionRest.NAME)\n+public class WorkflowDefinitionRestRepository extends DSpaceRestRepository<WorkflowDefinitionRest, String> {\n+\n+    @Autowired\n+    protected XmlWorkflowFactory xmlWorkflowFactory;\n+\n+    @Autowired\n+    private CollectionService collectionService;\n+\n+    @Override\n+    public WorkflowDefinitionRest findOne(Context context, String workflowName) {\n+        if (xmlWorkflowFactory.workflowByThisNameExists(workflowName)) {\n+            try {\n+                return converter.toRest(xmlWorkflowFactory.getWorkflowByName(workflowName), utils.obtainProjection());\n+            } catch (WorkflowConfigurationException e) {\n+                throw new ResourceNotFoundException(\"No workflow with name \" + workflowName + \" is configured\");", "originalCommit": "20d9b330d097676fbf4c7890f90c9642b87246d2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg1NjU5MQ==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r371856591", "bodyText": "Shouldn't this also return the collection specifically linked to the default workflow (if any)?", "author": "benbosman", "createdAt": "2020-01-28T15:03:12Z", "path": "dspace-server-webapp/src/main/java/org/dspace/app/rest/WorkflowDefinitionController.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ * The contents of this file are subject to the license and copyright\n+ * detailed in the LICENSE and NOTICE files at the root of the source\n+ * tree and available online at\n+ *\n+ * http://www.dspace.org/license/\n+ */\n+package org.dspace.app.rest;\n+\n+import java.util.List;\n+import javax.servlet.http.HttpServletRequest;\n+\n+import org.dspace.app.rest.converter.ConverterService;\n+import org.dspace.app.rest.model.CollectionRest;\n+import org.dspace.app.rest.model.WorkflowDefinitionRest;\n+import org.dspace.app.rest.utils.ContextUtil;\n+import org.dspace.app.rest.utils.Utils;\n+import org.dspace.content.Collection;\n+import org.dspace.core.Context;\n+import org.dspace.xmlworkflow.factory.XmlWorkflowFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.data.domain.Page;\n+import org.springframework.data.domain.Pageable;\n+import org.springframework.data.rest.webmvc.ResourceNotFoundException;\n+import org.springframework.web.bind.annotation.PathVariable;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+/**\n+ * Rest controller that handles the config for workflow definitions\n+ *\n+ * @author Maria Verdonck (Atmire) on 11/12/2019\n+ */\n+@RestController\n+@RequestMapping(\"/api/\" + WorkflowDefinitionRest.CATEGORY + \"/\" + WorkflowDefinitionRest.NAME_PLURAL)\n+public class WorkflowDefinitionController {\n+\n+    @Autowired\n+    protected XmlWorkflowFactory xmlWorkflowFactory;\n+\n+    @Autowired\n+    protected ConverterService converter;\n+\n+    @Autowired\n+    protected Utils utils;\n+\n+    /**\n+     * GET endpoint that returns the list of collections that make an explicit use of the workflow-definition.\n+     * If a collection doesn't specify the workflow-definition to be used, the default mapping applies,\n+     * but this collection is not included in the list returned by this method.\n+     *\n+     * @param request      The request object\n+     * @param workflowName Name of workflow we want the collections of that are mapped to is\n+     * @return List of collections mapped to the requested workflow\n+     */\n+    @RequestMapping(method = RequestMethod.GET, value = \"/{workflowName}/collections\")\n+    public Page<CollectionRest> getCollections(HttpServletRequest request, @PathVariable String workflowName,\n+                                               Pageable pageable) {\n+        if (xmlWorkflowFactory.workflowByThisNameExists(workflowName)) {\n+            Context context = ContextUtil.obtainContext(request);\n+            List<Collection> collectionsMappedToWorkflow;\n+            if (xmlWorkflowFactory.isDefaultWorkflow(workflowName)) {\n+                collectionsMappedToWorkflow = xmlWorkflowFactory.getAllNonMappedCollectionsHandles(context);", "originalCommit": "20d9b330d097676fbf4c7890f90c9642b87246d2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8b51ba692d9546651eda19d6f87965dcaaba712f", "url": "https://github.com/DSpace/DSpace/commit/8b51ba692d9546651eda19d6f87965dcaaba712f", "message": "Merge remote-tracking branch 'dspace-origin/master' into workflow-step-definitions", "committedDate": "2020-01-31T10:55:48Z", "type": "commit"}, {"oid": "aaa9d5ed2977d6e081c4e468737227ff660ff1f9", "url": "https://github.com/DSpace/DSpace/commit/aaa9d5ed2977d6e081c4e468737227ff660ff1f9", "message": "[DS-2646]: javadoc & SUBMIT_EDIT_METADATA to ProcessingAction", "committedDate": "2020-01-31T12:10:42Z", "type": "commit"}, {"oid": "1820659a804e9c6ab43406b32fcc20e1b1d5bc6d", "url": "https://github.com/DSpace/DSpace/commit/1820659a804e9c6ab43406b32fcc20e1b1d5bc6d", "message": "[DS-2646]: api/config/workflowdefinitions/defaultWorkflow/collections :\nreturns all non-mapped collections & all collections specifically mapped to defaultWorkflow\n& Exception comment", "committedDate": "2020-01-31T12:11:40Z", "type": "commit"}, {"oid": "6680d233e26942aa80dc2c2370b5e885a4e52724", "url": "https://github.com/DSpace/DSpace/commit/6680d233e26942aa80dc2c2370b5e885a4e52724", "message": "[DS-2646]: checkstyle fix", "committedDate": "2020-01-31T15:03:36Z", "type": "commit"}, {"oid": "bda2e510415a29c27da5404c077ed44150b8d746", "url": "https://github.com/DSpace/DSpace/commit/bda2e510415a29c27da5404c077ed44150b8d746", "message": "Fixing configuration in the workflow-actions.xml test file", "committedDate": "2020-02-03T12:15:30Z", "type": "commit"}, {"oid": "f732577425e0305730f2ef9b33cba6d309bf066b", "url": "https://github.com/DSpace/DSpace/commit/f732577425e0305730f2ef9b33cba6d309bf066b", "message": "Merge branch 'master' into workflow-step-definitions", "committedDate": "2020-02-03T12:15:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM2NjE4Mw==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r375366183", "bodyText": "This controller is misnamed & seems to be mapping the same request path as WorkflowDefinitionRestRepository (and WorkflowDefinitionRest).   I'd recommend renaming this to WorkflowDefinitionCollectionController (or similar), as this controller is specifically managing the Collection relationship here.  We can also then add a more specific RequestMapping...along the lines of:\n@RequestMapping(\"/api/\" + WorkflowDefinitionRest.CATEGORY + \"/\" + WorkflowDefinitionRest.NAME_PLURAL + \"/{workflowName}/collections\")\npublic class WorkflowDefinitionCollectionsController {", "author": "tdonohue", "createdAt": "2020-02-05T16:30:42Z", "path": "dspace-server-webapp/src/main/java/org/dspace/app/rest/WorkflowDefinitionController.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/**\n+ * The contents of this file are subject to the license and copyright\n+ * detailed in the LICENSE and NOTICE files at the root of the source\n+ * tree and available online at\n+ *\n+ * http://www.dspace.org/license/\n+ */\n+package org.dspace.app.rest;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import javax.servlet.http.HttpServletRequest;\n+\n+import org.dspace.app.rest.converter.ConverterService;\n+import org.dspace.app.rest.model.CollectionRest;\n+import org.dspace.app.rest.model.WorkflowDefinitionRest;\n+import org.dspace.app.rest.utils.ContextUtil;\n+import org.dspace.app.rest.utils.Utils;\n+import org.dspace.content.Collection;\n+import org.dspace.core.Context;\n+import org.dspace.xmlworkflow.factory.XmlWorkflowFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.data.domain.Page;\n+import org.springframework.data.domain.Pageable;\n+import org.springframework.data.rest.webmvc.ResourceNotFoundException;\n+import org.springframework.web.bind.annotation.PathVariable;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+/**\n+ * Rest controller that handles the config for workflow definitions\n+ *\n+ * @author Maria Verdonck (Atmire) on 11/12/2019\n+ */\n+@RestController\n+@RequestMapping(\"/api/\" + WorkflowDefinitionRest.CATEGORY + \"/\" + WorkflowDefinitionRest.NAME_PLURAL)\n+public class WorkflowDefinitionController {", "originalCommit": "f732577425e0305730f2ef9b33cba6d309bf066b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA2OTU5MA==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r376069590", "bodyText": "Update: it's also worth considering whether this controller could be replaced with a LinkRepository to obtain the collections subresource.  That would better align this PR with the Projections work in #2625  (which has converted many similar Controller methods into LinkRepository classes)", "author": "tdonohue", "createdAt": "2020-02-06T20:39:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM2NjE4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM2OTc0Mw==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r375369743", "bodyText": "This class seems unnecessary to me, as it's just calling the setup() of AbstractControllerIntegrationTest.  Is there a reason why we don't just remove this class and use AbstractControllerIntegrationTest directly?", "author": "tdonohue", "createdAt": "2020-02-05T16:36:26Z", "path": "dspace-server-webapp/src/test/java/org/dspace/app/rest/test/AbstractWorkflowDefinitionIntegrationTest.java", "diffHunk": "@@ -0,0 +1,20 @@\n+/**\n+ * The contents of this file are subject to the license and copyright\n+ * detailed in the LICENSE and NOTICE files at the root of the source\n+ * tree and available online at\n+ *\n+ * http://www.dspace.org/license/\n+ */\n+package org.dspace.app.rest.test;\n+\n+/**\n+ * @author Maria Verdonck (Atmire) on 17/12/2019\n+ */\n+public class AbstractWorkflowDefinitionIntegrationTest extends AbstractControllerIntegrationTest {", "originalCommit": "f732577425e0305730f2ef9b33cba6d309bf066b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzE4NDkzNg==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r377184936", "bodyText": "Removed, wasn't used", "author": "MarieVerdonck", "createdAt": "2020-02-10T16:49:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM2OTc0Mw=="}], "type": "inlineReview"}, {"oid": "2fd967744c052b59eae9a84739cef61882bba7c7", "url": "https://github.com/DSpace/DSpace/commit/2fd967744c052b59eae9a84739cef61882bba7c7", "message": "[DS-2646]: Workflow Endpoints now need authenticated access + tests:\nWorkflowDefinition, WorkflowActions & WorkflowSteps Endpoints", "committedDate": "2020-02-10T10:05:52Z", "type": "commit"}, {"oid": "e35e5a6b3a80b22e95e61efe21002176ffbe9788", "url": "https://github.com/DSpace/DSpace/commit/e35e5a6b3a80b22e95e61efe21002176ffbe9788", "message": "[DS-2646]: /workflowdefinitions/<:name>/collections via @LinkRest (Controller to LinkRepository)\nand /steps set embedOptional to true\n> /workflowdefinitions/<:name> has links of subresources, but no embeds", "committedDate": "2020-02-10T13:27:49Z", "type": "commit"}, {"oid": "1f8e44079393a8c9f53c75e2cf7f74d84096976c", "url": "https://github.com/DSpace/DSpace/commit/1f8e44079393a8c9f53c75e2cf7f74d84096976c", "message": "[DS-2646]: checkstyle", "committedDate": "2020-02-10T14:18:58Z", "type": "commit"}, {"oid": "c1193c68904b9f9b1505c3b79006acb355dd95e8", "url": "https://github.com/DSpace/DSpace/commit/c1193c68904b9f9b1505c3b79006acb355dd95e8", "message": "[DS-2646]: test fix", "committedDate": "2020-02-10T15:25:26Z", "type": "commit"}, {"oid": "0c9e50ca721e856f967c28d6d8ca36b6600d0f24", "url": "https://github.com/DSpace/DSpace/commit/0c9e50ca721e856f967c28d6d8ca36b6600d0f24", "message": "[DS-2646]: /workflowdefintions/<:name>/steps fixed + new tests &\nendpoint result names changed to without Resource", "committedDate": "2020-02-12T15:46:14Z", "type": "commit"}, {"oid": "207f7455125e8ac51685add70a10ce8683cbd7c1", "url": "https://github.com/DSpace/DSpace/commit/207f7455125e8ac51685add70a10ce8683cbd7c1", "message": "[DS-2646]: test and checkstyle fixes", "committedDate": "2020-02-12T17:29:08Z", "type": "commit"}, {"oid": "c498838e3932d1afc76148dfd61569a4971f0229", "url": "https://github.com/DSpace/DSpace/commit/c498838e3932d1afc76148dfd61569a4971f0229", "message": "Merge remote-tracking branch 'upstream/master' into workflow-step-definitions", "committedDate": "2020-02-19T08:39:21Z", "type": "commit"}, {"oid": "570f77d1a629bfa6e0cf9f8ae69d17fbf030f457", "url": "https://github.com/DSpace/DSpace/commit/570f77d1a629bfa6e0cf9f8ae69d17fbf030f457", "message": "68860: test fixes after merging latest dspace-origin/master", "committedDate": "2020-02-19T14:28:35Z", "type": "commit"}, {"oid": "ff30538dadb72a48ac5bad94da43ae0a764fabd6", "url": "https://github.com/DSpace/DSpace/commit/ff30538dadb72a48ac5bad94da43ae0a764fabd6", "message": "Merge remote-tracking branch 'dspace-origin/master' into workflow-step-definitions\n\n# Conflicts:\n#\tdspace-api/src/test/java/org/dspace/xmlworkflow/XmlWorkflowFactoryTest.java", "committedDate": "2020-02-24T11:55:58Z", "type": "commit"}, {"oid": "d395be6a3e67a2082688b133d0cbdf641b836135", "url": "https://github.com/DSpace/DSpace/commit/d395be6a3e67a2082688b133d0cbdf641b836135", "message": "test fix after master merge", "committedDate": "2020-02-24T12:24:07Z", "type": "commit"}, {"oid": "e0acfbc6e44c0fcba2b1fe67014dd7bde6bd7646", "url": "https://github.com/DSpace/DSpace/commit/e0acfbc6e44c0fcba2b1fe67014dd7bde6bd7646", "message": "constant for expected http status", "committedDate": "2020-02-24T12:27:08Z", "type": "commit"}, {"oid": "ffc1505f010ef920392264b919b98b964c52221a", "url": "https://github.com/DSpace/DSpace/commit/ffc1505f010ef920392264b919b98b964c52221a", "message": "LinkRepositories so that subresources paths work without projection=full (for workflowdefinitions/defaultWorkflow/steps and /workflowsteps/editstep/actions)", "committedDate": "2020-02-24T13:29:04Z", "type": "commit"}, {"oid": "c4548d3c6115a0b0f223e5503d1ccdea91a2f1fa", "url": "https://github.com/DSpace/DSpace/commit/c4548d3c6115a0b0f223e5503d1ccdea91a2f1fa", "message": "missing licenses", "committedDate": "2020-02-24T14:10:46Z", "type": "commit"}, {"oid": "8a83d344f526e51ccbb1768250d5b511125e1c5e", "url": "https://github.com/DSpace/DSpace/commit/8a83d344f526e51ccbb1768250d5b511125e1c5e", "message": "checkstyle", "committedDate": "2020-02-24T14:52:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUzMTc5OQ==", "url": "https://github.com/DSpace/DSpace/pull/2646#discussion_r383531799", "bodyText": "@MarieVerdonck : This could be simplified by writing\n.andExpect(status().isBadRequest());   You'll see similar code in other ITs in our codebase.", "author": "tdonohue", "createdAt": "2020-02-24T21:42:38Z", "path": "dspace-server-webapp/src/test/java/org/dspace/app/rest/WorkflowDefinitionRestRepositoryIT.java", "diffHunk": "@@ -239,7 +240,7 @@ public void getWorkflowDefinitionByCollectionId_nonValidUUID() throws Exception\n         //When we call this facets endpoint\n         getClient(token).perform(get(WORKFLOW_DEFINITIONS_ENDPOINT + \"/search/findByCollection?uuid=\" + nonValidUUID))\n             //We expect a 400 Illegal Argument Exception cannot convert UUID\n-            .andExpect(status().is(400))\n+            .andExpect(status().is(HttpStatus.SC_BAD_REQUEST))", "originalCommit": "e0acfbc6e44c0fcba2b1fe67014dd7bde6bd7646", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ba6792a43cbce32272d01f624318f8f1cb388831", "url": "https://github.com/DSpace/DSpace/commit/ba6792a43cbce32272d01f624318f8f1cb388831", "message": "is(HttpStatus.SC_BAD_REQUEST) to isBadRequest()", "committedDate": "2020-02-25T09:40:16Z", "type": "commit"}, {"oid": "ba6792a43cbce32272d01f624318f8f1cb388831", "url": "https://github.com/DSpace/DSpace/commit/ba6792a43cbce32272d01f624318f8f1cb388831", "message": "is(HttpStatus.SC_BAD_REQUEST) to isBadRequest()", "committedDate": "2020-02-25T09:40:16Z", "type": "forcePushed"}]}