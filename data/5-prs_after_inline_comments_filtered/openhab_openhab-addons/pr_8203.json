{"pr_number": 8203, "pr_title": "[netatmo] Support for Welcome camera event categories", "pr_createdAt": "2020-07-26T12:37:11Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/8203", "timeline": [{"oid": "78699f923475262f714b186a4440d2a40edf1331", "url": "https://github.com/openhab/openhab-addons/commit/78699f923475262f714b186a4440d2a40edf1331", "message": "Merge pull request #1 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-06-10T17:50:55Z", "type": "commit"}, {"oid": "ae6b89156403811be49f80a0ad7831957f7e3ff3", "url": "https://github.com/openhab/openhab-addons/commit/ae6b89156403811be49f80a0ad7831957f7e3ff3", "message": "Merge pull request #2 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-06-12T18:12:18Z", "type": "commit"}, {"oid": "66abc11ea152aaa77d9bc64abe15f2dc94f65056", "url": "https://github.com/openhab/openhab-addons/commit/66abc11ea152aaa77d9bc64abe15f2dc94f65056", "message": "Merge pull request #3 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-06-13T20:20:47Z", "type": "commit"}, {"oid": "4f2cd511ce4312cde304741620c1765d56cd68c5", "url": "https://github.com/openhab/openhab-addons/commit/4f2cd511ce4312cde304741620c1765d56cd68c5", "message": "Merge pull request #4 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-06-16T16:31:06Z", "type": "commit"}, {"oid": "bd9cfc1d515b67147465297aabcfba123c8b0da2", "url": "https://github.com/openhab/openhab-addons/commit/bd9cfc1d515b67147465297aabcfba123c8b0da2", "message": "Merge pull request #5 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-06-18T18:57:15Z", "type": "commit"}, {"oid": "de620021e378cd1f0823075981f891007372f606", "url": "https://github.com/openhab/openhab-addons/commit/de620021e378cd1f0823075981f891007372f606", "message": "Merge pull request #6 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-06-20T20:31:41Z", "type": "commit"}, {"oid": "ad272b75fe2a8099893fcb90c57c70c3030dbc78", "url": "https://github.com/openhab/openhab-addons/commit/ad272b75fe2a8099893fcb90c57c70c3030dbc78", "message": "Merge pull request #7 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-06-20T22:24:01Z", "type": "commit"}, {"oid": "76c47b885b5ed65d8397451c2e5f6afee41e71a5", "url": "https://github.com/openhab/openhab-addons/commit/76c47b885b5ed65d8397451c2e5f6afee41e71a5", "message": "Merge pull request #8 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-06-21T08:57:04Z", "type": "commit"}, {"oid": "2ce668b656f52dd498baef0654be370687c42bcf", "url": "https://github.com/openhab/openhab-addons/commit/2ce668b656f52dd498baef0654be370687c42bcf", "message": "Merge pull request #9 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-07-06T17:43:22Z", "type": "commit"}, {"oid": "bcfbee2a19fec819cf7a7360594ca7a3fe0114d4", "url": "https://github.com/openhab/openhab-addons/commit/bcfbee2a19fec819cf7a7360594ca7a3fe0114d4", "message": "Merge pull request #10 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-07-10T09:39:03Z", "type": "commit"}, {"oid": "2d654b9963f163b6a9076eecc88b8770227c07e4", "url": "https://github.com/openhab/openhab-addons/commit/2d654b9963f163b6a9076eecc88b8770227c07e4", "message": "Merge pull request #11 from openhab/2.5.x\n\nUpdate", "committedDate": "2020-07-24T18:12:05Z", "type": "commit"}, {"oid": "d494fac5aefeaea3223f329677d9d8b9dd241cd6", "url": "https://github.com/openhab/openhab-addons/commit/d494fac5aefeaea3223f329677d9d8b9dd241cd6", "message": "Tests added\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-26T11:49:44Z", "type": "commit"}, {"oid": "c309e9e0c5f2449699eb615aef8dcb1c8c3d72a3", "url": "https://github.com/openhab/openhab-addons/commit/c309e9e0c5f2449699eb615aef8dcb1c8c3d72a3", "message": "Bug-fix: A detected person was reported as a human AND as a movement. It is sufficient to report it as a human, to additionally report a generic movement isn't required.\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-26T11:51:22Z", "type": "commit"}, {"oid": "b234651da04b98d056ecf8e2271a2691b621c781", "url": "https://github.com/openhab/openhab-addons/commit/b234651da04b98d056ecf8e2271a2691b621c781", "message": "Support for Welcome camera event categories (the Welcome indoor camera can now also detect animals and humans)\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-26T12:00:04Z", "type": "commit"}, {"oid": "2484e18d286978f701ed2f43f42d4f2783a23235", "url": "https://github.com/openhab/openhab-addons/commit/2484e18d286978f701ed2f43f42d4f2783a23235", "message": "Tests added\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-26T12:07:34Z", "type": "commit"}, {"oid": "7bd1be88eb50e27228d93da9a914554cc2488432", "url": "https://github.com/openhab/openhab-addons/commit/7bd1be88eb50e27228d93da9a914554cc2488432", "message": "Test code optimized\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-26T12:21:43Z", "type": "commit"}, {"oid": "793d8102bb0a833d682ccda5fc2f32a65258cd37", "url": "https://github.com/openhab/openhab-addons/commit/793d8102bb0a833d682ccda5fc2f32a65258cd37", "message": "Code optimization\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-26T12:27:25Z", "type": "commit"}, {"oid": "027e6878b9dcf77fcab2c0fd0131cb84d4bd74f0", "url": "https://github.com/openhab/openhab-addons/commit/027e6878b9dcf77fcab2c0fd0131cb84d4bd74f0", "message": "Code optimization\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-26T12:29:06Z", "type": "commit"}, {"oid": "ff874d70286ad88d3a0ec7d3f571832c69ba33ae", "url": "https://github.com/openhab/openhab-addons/commit/ff874d70286ad88d3a0ec7d3f571832c69ba33ae", "message": "Test code optimized\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-26T12:40:14Z", "type": "commit"}, {"oid": "4ae43e31b33c844cda6e3ec437f74f8fb1dfe0c6", "url": "https://github.com/openhab/openhab-addons/commit/4ae43e31b33c844cda6e3ec437f74f8fb1dfe0c6", "message": "Spotless applied\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-26T12:42:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r460844464", "bodyText": "Couldn't you use NAWelcomeSubEvent.TypeEnum.valueOf(catory.uppercase()) instead ?", "author": "clinique", "createdAt": "2020-07-27T12:10:20Z", "path": "bundles/org.openhab.binding.netatmo/src/main/java/org/openhab/binding/netatmo/internal/welcome/NAWelcomeHomeHandler.java", "diffHunk": "@@ -196,6 +201,19 @@ protected void triggerChannelIfRequired(String channelId) {\n         return detectedObjectTypes;\n     }\n \n+    private static Optional<NAWelcomeSubEvent.TypeEnum> findDetectedCategory(NAWelcomeEvent event) {\n+        String category = event.getCategory();\n+        if (category != null) {\n+            switch (category) {\n+                case \"human\":", "originalCommit": "4ae43e31b33c844cda6e3ec437f74f8fb1dfe0c6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA4MTk0MA==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r461081940", "bodyText": "Hm, that would result in an IllegalArgumentException when Netatmo returns a category which isn't existing within the enum.\nI could implement a utility function which does that for example like this static map example, but maybe it would be a little bit too complicated to check for 2 values, but I could do that :-) https://dzone.com/articles/java-enum-lookup-by-name-or-field-without-throwing", "author": "Novanic", "createdAt": "2020-07-27T18:21:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM2NzI4NQ==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r461367285", "bodyText": "According to documentation the set of values seems clearly defined, so, don't you think we could rely on it ? We'll face a potential IAE if the API evolves...", "author": "clinique", "createdAt": "2020-07-28T07:14:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM3MjgzMQ==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r461372831", "bodyText": "You have found a documentation of the possible values of the \"category\" element? :-) I haven't found any documentation regarding this element, so we don't know which value could be set.", "author": "Novanic", "createdAt": "2020-07-28T07:25:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM3Mzk1Ng==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r461373956", "bodyText": "Yes, take a look at 'event_list' on the referenced doc url.", "author": "clinique", "createdAt": "2020-07-28T07:27:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ4NzQxNw==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r461487417", "bodyText": "But the \"event_list\" structure or outdoor events have nothing to do with the undocumented \"category\" element.\nI saw the same values (\"human\" and \"animal\"), but there is no guarantuee that there are not more possible values, the element and it's possible values aren't documented...\nSo it is a risk to use the same enum and could also today lead to an IllegalArgumentException.\nIf you say \"yes\" I change it to use the enum. ;-) It is some time left since 2.5.8, so potential errors could occur before to be able to fix that again.", "author": "Novanic", "createdAt": "2020-07-28T10:43:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ4ODM3Ng==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r461488376", "bodyText": "Ah, it was answered by Netatmo yesterday, it should be safe to use the enum. :-)\nhttps://forum.netatmo.com/viewtopic.php?f=5&t=18506", "author": "Novanic", "createdAt": "2020-07-28T10:45:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTUwNjI4Mg==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r461506282", "bodyText": "So, I think it is safe to proceed with an enum !", "author": "clinique", "createdAt": "2020-07-28T11:21:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg0MjA4Ng==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r461842086", "bodyText": "An unexpected value in the API should not result in an unhandled exception. I'd go for the enum version, too. Although it's not nice, you could catch the IAE.", "author": "fwolter", "createdAt": "2020-07-28T20:00:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjQ5MjQ0Nw==", "url": "https://github.com/openhab/openhab-addons/pull/8203#discussion_r462492447", "bodyText": "It is now declared as an enum within the swagger spec, like the sub-event type.", "author": "Novanic", "createdAt": "2020-07-29T18:12:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg0NDQ2NA=="}], "type": "inlineReview"}, {"oid": "b698a3b7864343cef46bcdd4dccb1c83a2a03f5b", "url": "https://github.com/openhab/openhab-addons/commit/b698a3b7864343cef46bcdd4dccb1c83a2a03f5b", "message": "Enum used to check the category\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-28T17:40:34Z", "type": "commit"}, {"oid": "d84849d42921f5683f2990d800f5fbd913abd861", "url": "https://github.com/openhab/openhab-addons/commit/d84849d42921f5683f2990d800f5fbd913abd861", "message": "Enum for the new element \"category\" used, according to https://forum.netatmo.com/viewtopic.php?f=5&t=18506\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-28T20:03:54Z", "type": "commit"}, {"oid": "747fd2823409fcd3aac3e682f625e2b8955eabaf", "url": "https://github.com/openhab/openhab-addons/commit/747fd2823409fcd3aac3e682f625e2b8955eabaf", "message": "Enum for the new element \"category\" used, according to https://forum.netatmo.com/viewtopic.php?f=5&t=18506\n\nSigned-off-by: Sven Strohschein <sven.strohschein@gmail.com>", "committedDate": "2020-07-29T18:10:34Z", "type": "commit"}]}