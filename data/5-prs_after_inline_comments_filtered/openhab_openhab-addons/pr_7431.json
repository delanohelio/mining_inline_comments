{"pr_number": 7431, "pr_title": "[miio] Improve Yeelight Color channel", "pr_createdAt": "2020-04-20T18:40:10Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/7431", "timeline": [{"oid": "28135527d9b92b18a456a308f5826ce0e5ba463b", "url": "https://github.com/openhab/openhab-addons/commit/28135527d9b92b18a456a308f5826ce0e5ba463b", "message": "[miio] Improve Yeelight Color channel\n\n* fix yeelight delay channel\n* allow better control for Color item\n* Allow for google home  support without rules\n* make yeelight dimmer more intuitive\nhttps://community.openhab.org/t/xiaomi-robot-vacuum-binding/31317/1418\n\nSigned-off-by: Marcel Verpaalen <marcel@verpaalen.com>", "committedDate": "2020-04-20T18:36:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTY2MTY3NQ==", "url": "https://github.com/openhab/openhab-addons/pull/7431#discussion_r411661675", "bodyText": "The name of this method is inappropriate for what it returns.", "author": "cpmeister", "createdAt": "2020-04-20T20:15:15Z", "path": "bundles/org.openhab.binding.miio/src/main/java/org/openhab/binding/miio/internal/basic/ActionConditions.java", "diffHunk": "@@ -77,24 +77,43 @@\n     private static @Nullable JsonElement brightnessExists(@Nullable JsonElement value) {\n         if (value != null && value.isJsonPrimitive() && value.getAsJsonPrimitive().isNumber()) {\n             int intVal = value.getAsInt();\n-            if (intVal > 0 && intVal < 99) {\n+            if (intVal > 0 && intVal <= 100) {\n                 return value;\n             }\n+            return null;\n         } else {\n             LOGGER.debug(\"Could not parse brightness. Value '{}' is not an int\", value);\n         }\n+        return value;\n+    }\n+\n+    /**\n+     * Check if the value is a color which can be send to Color channel.\n+     * If not returns a null\n+     *\n+     * @param command\n+     *\n+     * @param value\n+     * @return\n+     */\n+    private static @Nullable JsonElement isHSV(Command command, @Nullable JsonElement value) {", "originalCommit": "28135527d9b92b18a456a308f5826ce0e5ba463b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczNTI3NA==", "url": "https://github.com/openhab/openhab-addons/pull/7431#discussion_r411735274", "bodyText": "this is fixed now", "author": "marcelrv", "createdAt": "2020-04-20T22:31:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTY2MTY3NQ=="}], "type": "inlineReview"}, {"oid": "b443baea2d5a3bbea401823925344a5d351f1462", "url": "https://github.com/openhab/openhab-addons/commit/b443baea2d5a3bbea401823925344a5d351f1462", "message": "[miio] rename condition & adding a test\n\n\nSigned-off-by: Marcel Verpaalen <marcel@verpaalen.com>", "committedDate": "2020-04-20T22:13:27Z", "type": "commit"}, {"oid": "fe87b1c158a7394e242db96348199cf063eb534a", "url": "https://github.com/openhab/openhab-addons/commit/fe87b1c158a7394e242db96348199cf063eb534a", "message": "[miio] add copyright\n\nSigned-off-by: Marcel Verpaalen <marcel@verpaalen.com>", "committedDate": "2020-04-20T22:29:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTc0MjMwOA==", "url": "https://github.com/openhab/openhab-addons/pull/7431#discussion_r411742308", "bodyText": "Please make method name camelcase.", "author": "cpmeister", "createdAt": "2020-04-20T22:47:04Z", "path": "bundles/org.openhab.binding.miio/src/main/java/org/openhab/binding/miio/internal/basic/ActionConditions.java", "diffHunk": "@@ -77,24 +77,45 @@\n     private static @Nullable JsonElement brightnessExists(@Nullable JsonElement value) {\n         if (value != null && value.isJsonPrimitive() && value.getAsJsonPrimitive().isNumber()) {\n             int intVal = value.getAsInt();\n-            if (intVal > 0 && intVal < 99) {\n+            if (intVal > 0 && intVal <= 100) {\n                 return value;\n+            } else if (intVal > 100) {\n+                return new JsonPrimitive(100);\n             }\n+            return null;\n         } else {\n             LOGGER.debug(\"Could not parse brightness. Value '{}' is not an int\", value);\n         }\n+        return value;\n+    }\n+\n+    /**\n+     * Check if the value is a color which can be send to Color channel.\n+     * If not returns a null\n+     *\n+     * @param command\n+     *\n+     * @param value\n+     * @return\n+     */\n+    private static @Nullable JsonElement HSBOnly(@Nullable Command command, @Nullable JsonElement value) {", "originalCommit": "fe87b1c158a7394e242db96348199cf063eb534a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6b1384c22eb9b35545d9f6faeadc91d349f52232", "url": "https://github.com/openhab/openhab-addons/commit/6b1384c22eb9b35545d9f6faeadc91d349f52232", "message": "[miio] rename hsbOnly\n\nSigned-off-by: Marcel Verpaalen <marcel@verpaalen.com>", "committedDate": "2020-04-20T23:03:42Z", "type": "commit"}]}