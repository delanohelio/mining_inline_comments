{"pr_number": 7486, "pr_title": "[opengarage] Add Contact & RollerShutter types for additional flexibility", "pr_createdAt": "2020-04-27T09:17:32Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/7486", "timeline": [{"oid": "8210b182089c7e787e4edb31452bb44810cb3fbe", "url": "https://github.com/openhab/openhab-addons/commit/8210b182089c7e787e4edb31452bb44810cb3fbe", "message": "Add Contact & RollerShutter types for addition flexibility\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-04-27T09:16:07Z", "type": "commit"}, {"oid": "e9e55d910d4a04bbeeb52796863f437266e48785", "url": "https://github.com/openhab/openhab-addons/commit/e9e55d910d4a04bbeeb52796863f437266e48785", "message": "Merge branch '2.5.x' into opengaragetypes", "committedDate": "2020-04-28T07:22:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk0MDk5NQ==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r416940995", "bodyText": "You should have kept the switch statement and allowed the logic to fall through", "author": "cpmeister", "createdAt": "2020-04-28T21:41:01Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -57,20 +60,15 @@ public OpenGarageHandler(Thing thing) {\n     @Override\n     public void handleCommand(ChannelUID channelUID, Command command) {\n         try {\n-            logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n-                    channelUID.getId());\n-            switch (channelUID.getId()) {\n-                case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n-                    if (command instanceof OnOffType) {\n-                        changeStatus(((OnOffType) command).equals(OnOffType.ON));\n-                        return;\n-                    }\n-                    break;\n-                default:\n+            if (channelUID.getId().equals(OpenGarageBindingConstants.CHANNEL_OG_STATUS) || channelUID.getId().equals(OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER)) {", "originalCommit": "e9e55d910d4a04bbeeb52796863f437266e48785", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzEzMjA5NA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r417132094", "bodyText": "fixed in pending commit", "author": "psmedley", "createdAt": "2020-04-29T07:57:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk0MDk5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk0MTEyOQ==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r416941129", "bodyText": "use a switch statement here", "author": "cpmeister", "createdAt": "2020-04-28T21:41:15Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageWebTargets.java", "diffHunk": "@@ -43,17 +43,21 @@ public ControllerVariables getControllerVariables() throws OpenGarageCommunicati\n         return ControllerVariables.parse(response);\n     }\n \n-    public void setControllerVariables(boolean request) throws OpenGarageCommunicationException {\n+    public void setControllerVariables(String request) throws OpenGarageCommunicationException {\n         logger.debug(\"Received request: {}\", request);\n-        if (request) {\n-            logger.debug(\"Received request to open door\");\n-            String queryParams = \"&open=1\";\n-            invoke(changeControllerVariablesUri, queryParams);\n-        } else {\n-            logger.debug(\"Received request to close door\");\n-            String queryParams = \"&close=1\";\n-            invoke(changeControllerVariablesUri, queryParams);\n-        }\n+          if (request.equals(\"open\")) {", "originalCommit": "e9e55d910d4a04bbeeb52796863f437266e48785", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzE0OTcyNA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r417149724", "bodyText": "done", "author": "psmedley", "createdAt": "2020-04-29T08:30:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk0MTEyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk0NzkwNg==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r416947906", "bodyText": "Shouldn't you be checking against the StopMoveType here?", "author": "cpmeister", "createdAt": "2020-04-28T21:55:56Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -57,20 +60,15 @@ public OpenGarageHandler(Thing thing) {\n     @Override\n     public void handleCommand(ChannelUID channelUID, Command command) {\n         try {\n-            logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n-                    channelUID.getId());\n-            switch (channelUID.getId()) {\n-                case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n-                    if (command instanceof OnOffType) {\n-                        changeStatus(((OnOffType) command).equals(OnOffType.ON));\n-                        return;\n-                    }\n-                    break;\n-                default:\n+            if (channelUID.getId().equals(OpenGarageBindingConstants.CHANNEL_OG_STATUS) || channelUID.getId().equals(OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER)) {\n+                if (command.equals(OnOffType.ON) || command.equals(UpDownType.UP)) {\n+                    changeStatus(\"open\");\n+                } else if (command.equals(OnOffType.OFF) || command.equals(UpDownType.DOWN)) {\n+                    changeStatus(\"close\");\n+                } else if (command.equals(\"STOP\")) {", "originalCommit": "e9e55d910d4a04bbeeb52796863f437266e48785", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzEyNzM2Nw==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r417127367", "bodyText": "Fixed in pending commit", "author": "psmedley", "createdAt": "2020-04-29T07:48:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk0NzkwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk1MTE4MA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r416951180", "bodyText": "Can you make these status values enums instead of strings?", "author": "cpmeister", "createdAt": "2020-04-28T22:03:03Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -57,20 +60,15 @@ public OpenGarageHandler(Thing thing) {\n     @Override\n     public void handleCommand(ChannelUID channelUID, Command command) {\n         try {\n-            logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n-                    channelUID.getId());\n-            switch (channelUID.getId()) {\n-                case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n-                    if (command instanceof OnOffType) {\n-                        changeStatus(((OnOffType) command).equals(OnOffType.ON));\n-                        return;\n-                    }\n-                    break;\n-                default:\n+            if (channelUID.getId().equals(OpenGarageBindingConstants.CHANNEL_OG_STATUS) || channelUID.getId().equals(OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER)) {\n+                if (command.equals(OnOffType.ON) || command.equals(UpDownType.UP)) {\n+                    changeStatus(\"open\");", "originalCommit": "e9e55d910d4a04bbeeb52796863f437266e48785", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzE0OTYxNw==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r417149617", "bodyText": "Done. Hopefully it's ok.", "author": "psmedley", "createdAt": "2020-04-29T08:29:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk1MTE4MA=="}], "type": "inlineReview"}, {"oid": "a74ebe957ccd4529beb857b11c346d69388e25ae", "url": "https://github.com/openhab/openhab-addons/commit/a74ebe957ccd4529beb857b11c346d69388e25ae", "message": "Fixes/tidyups\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-04-29T08:29:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwODAyOQ==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418308029", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void setControllerVariables(String request) throws OpenGarageCommunicationException {\n          \n          \n            \n                public void setControllerVariables(OpenGarageCommand request) throws OpenGarageCommunicationException {", "author": "cpmeister", "createdAt": "2020-04-30T21:47:35Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageWebTargets.java", "diffHunk": "@@ -45,19 +46,17 @@ public ControllerVariables getControllerVariables() throws OpenGarageCommunicati\n \n     public void setControllerVariables(String request) throws OpenGarageCommunicationException {", "originalCommit": "a74ebe957ccd4529beb857b11c346d69388e25ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ2NTUzMA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418465530", "bodyText": "Fixed in next commit", "author": "psmedley", "createdAt": "2020-05-01T08:46:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwODAyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwODY3OQ==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418308679", "bodyText": "Once the request is an enum, then you can do a switch statement on it like this:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (request.equals(OpenGarageCommand.OPEN.getValue())) {\n          \n          \n            \n                    switch(request){\n          \n          \n            \n                         case OPEN:\n          \n      \n    \n    \n  \n\nThis would eliminate the need for getValue on your enum.\nAnother approach that would utilize the getValue instead of using a switch statement would be to construct the queryParams directly.\nString queryParams = \"&\"+request.getValue()+\"=1\";", "author": "cpmeister", "createdAt": "2020-04-30T21:49:05Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageWebTargets.java", "diffHunk": "@@ -45,19 +46,17 @@ public ControllerVariables getControllerVariables() throws OpenGarageCommunicati\n \n     public void setControllerVariables(String request) throws OpenGarageCommunicationException {\n         logger.debug(\"Received request: {}\", request);\n-          if (request.equals(\"open\")) {\n-              logger.debug(\"Received request to open door\");\n-              String queryParams = \"&open=1\";\n-              invoke(changeControllerVariablesUri, queryParams);\n-          } else if (request.equals(\"close\")) {\n-              logger.debug(\"Received request to close door\");\n-              String queryParams = \"&close=1\";\n-              invoke(changeControllerVariablesUri, queryParams);\n-          } else if (request.equals(\"click\")) {\n-              logger.debug(\"Received request to click remote button\");\n-              String queryParams = \"&click=1\";\n-              invoke(changeControllerVariablesUri, queryParams);\n-          }\n+        String queryParams = null;\n+        if (request.equals(OpenGarageCommand.OPEN.getValue())) {", "originalCommit": "a74ebe957ccd4529beb857b11c346d69388e25ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ2NTU2Nw==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418465567", "bodyText": "Fixed in next commit", "author": "psmedley", "createdAt": "2020-05-01T08:46:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwODY3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwOTIyOQ==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418309229", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        changeStatus(OpenGarageCommand.OPEN.getValue());\n          \n          \n            \n                                        changeStatus(OpenGarageCommand.OPEN);", "author": "cpmeister", "createdAt": "2020-04-30T21:50:25Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -60,14 +62,23 @@ public OpenGarageHandler(Thing thing) {\n     @Override\n     public void handleCommand(ChannelUID channelUID, Command command) {\n         try {\n-            if (channelUID.getId().equals(OpenGarageBindingConstants.CHANNEL_OG_STATUS) || channelUID.getId().equals(OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER)) {\n-                if (command.equals(OnOffType.ON) || command.equals(UpDownType.UP)) {\n-                    changeStatus(\"open\");\n-                } else if (command.equals(OnOffType.OFF) || command.equals(UpDownType.DOWN)) {\n-                    changeStatus(\"close\");\n-                } else if (command.equals(\"STOP\")) {\n-                    changeStatus(\"click\");\n-                } \n+                logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n+                    channelUID.getId());\n+                switch (channelUID.getId()) {\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER:\n+                        if (command.equals(OnOffType.ON) || command.equals(UpDownType.UP)) {\n+                            changeStatus(OpenGarageCommand.OPEN.getValue());", "originalCommit": "a74ebe957ccd4529beb857b11c346d69388e25ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ2NTU5Nw==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418465597", "bodyText": "Fixed in next commit", "author": "psmedley", "createdAt": "2020-05-01T08:46:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwOTIyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwOTMzMA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418309330", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        changeStatus(OpenGarageCommand.OPEN.getValue());\n          \n          \n            \n                                        changeStatus(OpenGarageCommand.OPEN);", "author": "cpmeister", "createdAt": "2020-04-30T21:50:40Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -57,20 +62,24 @@ public OpenGarageHandler(Thing thing) {\n     @Override\n     public void handleCommand(ChannelUID channelUID, Command command) {\n         try {\n-            logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n+                logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n                     channelUID.getId());\n-            switch (channelUID.getId()) {\n-                case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n-                    if (command instanceof OnOffType) {\n-                        changeStatus(((OnOffType) command).equals(OnOffType.ON));\n-                        return;\n-                    }\n-                    break;\n-                default:\n+                switch (channelUID.getId()) {\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER:\n+                        if (command.equals(OnOffType.ON) || command.equals(UpDownType.UP)) {\n+                            changeStatus(OpenGarageCommand.OPEN.getValue());", "originalCommit": "a74ebe957ccd4529beb857b11c346d69388e25ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ2NTcxOA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418465718", "bodyText": "Fixed in next commit", "author": "psmedley", "createdAt": "2020-05-01T08:46:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwOTMzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwOTM5MA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418309390", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        changeStatus(OpenGarageCommand.CLOSE.getValue());\n          \n          \n            \n                                        changeStatus(OpenGarageCommand.CLOSE);", "author": "cpmeister", "createdAt": "2020-04-30T21:50:50Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -57,20 +62,24 @@ public OpenGarageHandler(Thing thing) {\n     @Override\n     public void handleCommand(ChannelUID channelUID, Command command) {\n         try {\n-            logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n+                logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n                     channelUID.getId());\n-            switch (channelUID.getId()) {\n-                case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n-                    if (command instanceof OnOffType) {\n-                        changeStatus(((OnOffType) command).equals(OnOffType.ON));\n-                        return;\n-                    }\n-                    break;\n-                default:\n+                switch (channelUID.getId()) {\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER:\n+                        if (command.equals(OnOffType.ON) || command.equals(UpDownType.UP)) {\n+                            changeStatus(OpenGarageCommand.OPEN.getValue());\n+                            return;\n+                        } else if (command.equals(OnOffType.OFF) || command.equals(UpDownType.DOWN)) {\n+                            changeStatus(OpenGarageCommand.CLOSE.getValue());", "originalCommit": "a74ebe957ccd4529beb857b11c346d69388e25ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ2NjAzNA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418466034", "bodyText": "Fixed in next commit", "author": "psmedley", "createdAt": "2020-05-01T08:48:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwOTM5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMxMTA4Mw==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418311083", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        changeStatus(OpenGarageCommand.CLICK.getValue());\n          \n          \n            \n                                        changeStatus(OpenGarageCommand.CLICK);", "author": "cpmeister", "createdAt": "2020-04-30T21:54:36Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -57,20 +62,24 @@ public OpenGarageHandler(Thing thing) {\n     @Override\n     public void handleCommand(ChannelUID channelUID, Command command) {\n         try {\n-            logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n+                logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n                     channelUID.getId());\n-            switch (channelUID.getId()) {\n-                case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n-                    if (command instanceof OnOffType) {\n-                        changeStatus(((OnOffType) command).equals(OnOffType.ON));\n-                        return;\n-                    }\n-                    break;\n-                default:\n+                switch (channelUID.getId()) {\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER:\n+                        if (command.equals(OnOffType.ON) || command.equals(UpDownType.UP)) {\n+                            changeStatus(OpenGarageCommand.OPEN.getValue());\n+                            return;\n+                        } else if (command.equals(OnOffType.OFF) || command.equals(UpDownType.DOWN)) {\n+                            changeStatus(OpenGarageCommand.CLOSE.getValue());\n+                            return;\n+                        } else if (command.equals(StopMoveType.STOP)) {\n+                            changeStatus(OpenGarageCommand.CLICK.getValue());", "originalCommit": "a74ebe957ccd4529beb857b11c346d69388e25ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ2NjA2MA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418466060", "bodyText": "Fixed in next commit", "author": "psmedley", "createdAt": "2020-05-01T08:48:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMxMTA4Mw=="}], "type": "inlineReview"}, {"oid": "b6d0e70c7f80f8a7e34ca75e7ee0c162a5f6243d", "url": "https://github.com/openhab/openhab-addons/commit/b6d0e70c7f80f8a7e34ca75e7ee0c162a5f6243d", "message": "Support \"MOVE\" command\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-05-01T08:03:37Z", "type": "commit"}, {"oid": "a79330dc6461b9bc391d32c0953d00df4d1b486e", "url": "https://github.com/openhab/openhab-addons/commit/a79330dc6461b9bc391d32c0953d00df4d1b486e", "message": "Incorporate latest suggest fixes\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-05-01T08:51:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcxOTYxMw==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418719613", "bodyText": "You forgot to add break statements.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                          queryParams = \"&open=1\";\n          \n          \n            \n                        case CLOSE:\n          \n          \n            \n                          queryParams = \"&close=1\";\n          \n          \n            \n                        case CLICK:\n          \n          \n            \n                          queryParams = \"&click=1\";\n          \n          \n            \n                          queryParams = \"&open=1\";\n          \n          \n            \n                          break;\n          \n          \n            \n                        case CLOSE:\n          \n          \n            \n                          queryParams = \"&close=1\";\n          \n          \n            \n                          break;\n          \n          \n            \n                        case CLICK:\n          \n          \n            \n                          queryParams = \"&click=1\";\n          \n          \n            \n                          break;", "author": "cpmeister", "createdAt": "2020-05-01T20:18:12Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageWebTargets.java", "diffHunk": "@@ -43,15 +44,18 @@ public ControllerVariables getControllerVariables() throws OpenGarageCommunicati\n         return ControllerVariables.parse(response);\n     }\n \n-    public void setControllerVariables(boolean request) throws OpenGarageCommunicationException {\n+    public void setControllerVariables(OpenGarageCommand request) throws OpenGarageCommunicationException {\n         logger.debug(\"Received request: {}\", request);\n-        if (request) {\n-            logger.debug(\"Received request to open door\");\n-            String queryParams = \"&open=1\";\n-            invoke(changeControllerVariablesUri, queryParams);\n-        } else {\n-            logger.debug(\"Received request to close door\");\n-            String queryParams = \"&close=1\";\n+        String queryParams = null;\n+        switch (request) {\n+            case OPEN:\n+              queryParams = \"&open=1\";\n+            case CLOSE:\n+              queryParams = \"&close=1\";\n+            case CLICK:\n+              queryParams = \"&click=1\";", "originalCommit": "a79330dc6461b9bc391d32c0953d00df4d1b486e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODc4Nzg4Ng==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418787886", "bodyText": "Fixed in last commit", "author": "psmedley", "createdAt": "2020-05-02T00:23:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcxOTYxMw=="}], "type": "inlineReview"}, {"oid": "bba2b26c31d900a21381ecde44596e0acf798057", "url": "https://github.com/openhab/openhab-addons/commit/bba2b26c31d900a21381ecde44596e0acf798057", "message": "Fixes\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-05-02T00:05:34Z", "type": "commit"}, {"oid": "a3d2a72d6b253cafd68df5f45a9ebf3e69157966", "url": "https://github.com/openhab/openhab-addons/commit/a3d2a72d6b253cafd68df5f45a9ebf3e69157966", "message": "Add new thing status-switch to clearly identify item types, deprecate old status\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-05-02T04:40:15Z", "type": "commit"}, {"oid": "f9660008bc58494726fbc24063c203c6ff3723aa", "url": "https://github.com/openhab/openhab-addons/commit/f9660008bc58494726fbc24063c203c6ff3723aa", "message": "Fix type\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-05-02T04:43:22Z", "type": "commit"}, {"oid": "148e1df92e8bb703c5cbead573de7688b563cf87", "url": "https://github.com/openhab/openhab-addons/commit/148e1df92e8bb703c5cbead573de7688b563cf87", "message": "Fix error for detection of 'unknown' vehicle state\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-05-02T05:27:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk2MDgyNw==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418960827", "bodyText": "Please change to debug", "author": "digitaldan", "createdAt": "2020-05-02T13:44:14Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -57,20 +62,25 @@ public OpenGarageHandler(Thing thing) {\n     @Override\n     public void handleCommand(ChannelUID channelUID, Command command) {\n         try {\n-            logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n+                logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),", "originalCommit": "148e1df92e8bb703c5cbead573de7688b563cf87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAxNzU3Mg==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r419017572", "bodyText": "Fixed in latest commmit", "author": "psmedley", "createdAt": "2020-05-02T22:47:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk2MDgyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk2MTM0NA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418961344", "bodyText": "This is a small nit, but do you need a switch statement at all? It only has one outcome.  i would think you could simply remove the switch statement and just jump straight to checking the command types.", "author": "digitaldan", "createdAt": "2020-05-02T13:49:25Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -57,20 +62,25 @@ public OpenGarageHandler(Thing thing) {\n     @Override\n     public void handleCommand(ChannelUID channelUID, Command command) {\n         try {\n-            logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n+                logger.warn(\"Received command {} for thing '{}' on channel {}\", command, thing.getUID().getAsString(),\n                     channelUID.getId());\n-            switch (channelUID.getId()) {\n-                case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n-                    if (command instanceof OnOffType) {\n-                        changeStatus(((OnOffType) command).equals(OnOffType.ON));\n-                        return;\n-                    }\n-                    break;\n-                default:\n+                switch (channelUID.getId()) {\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS:\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS_SWITCH:\n+                    case OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER:", "originalCommit": "148e1df92e8bb703c5cbead573de7688b563cf87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAxNzc1NA==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r419017754", "bodyText": "I guess we could do this, I think this is safer as we at least make sure the right channel is receiving the command?", "author": "psmedley", "createdAt": "2020-05-02T22:49:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk2MTM0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTA0NTgzOQ==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r419045839", "bodyText": "Sounds good to me.", "author": "digitaldan", "createdAt": "2020-05-03T04:34:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk2MTM0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk2Mjc2Ng==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r418962766", "bodyText": "small nit pick, would maybe  a switch statement be cleaner here?\nswitch(controllerVariables.door){\n    case 0:\n        updateState(OpenGarageBindingConstants.CHANNEL_OG_STATUS, OnOffType.OFF);\n        updateState(OpenGarageBindingConstants.CHANNEL_OG_STATUS_SWITCH, OnOffType.OFF);\n        updateState(OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER, UpDownType.DOWN);\n        updateState(OpenGarageBindingConstants.CHANNEL_OG_STATUS_CONTACT, OpenClosedType.CLOSED);\n        break;\n    case 1:\n        updateState(OpenGarageBindingConstants.CHANNEL_OG_STATUS, OnOffType.ON);\n        updateState(OpenGarageBindingConstants.CHANNEL_OG_STATUS_SWITCH, OnOffType.ON);\n        updateState(OpenGarageBindingConstants.CHANNEL_OG_STATUS_ROLLERSHUTTER, UpDownType.UP);\n        updateState(OpenGarageBindingConstants.CHANNEL_OG_STATUS_CONTACT, OpenClosedType.OPEN);\n        break;\n    default:\n        logger.warn(\"Received unknown door value: {}\", controllerVariables.door);\n}\nAnd of course the same for the vehicle state below.", "author": "digitaldan", "createdAt": "2020-05-02T14:03:16Z", "path": "bundles/org.openhab.binding.opengarage/src/main/java/org/openhab/binding/opengarage/internal/OpenGarageHandler.java", "diffHunk": "@@ -133,20 +143,26 @@ private void pollStatus() throws IOException {\n                     new QuantityType<>(controllerVariables.dist, MetricPrefix.CENTI(SIUnits.METRE)));\n             if (controllerVariables.door == 0) {\n                 updateState(OpenGarageBindingConstants.CHANNEL_OG_STATUS, OnOffType.OFF);", "originalCommit": "148e1df92e8bb703c5cbead573de7688b563cf87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAxNzc5Ng==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r419017796", "bodyText": "I was just looking at this and thinking the same thing :)", "author": "psmedley", "createdAt": "2020-05-02T22:50:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk2Mjc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAxOTA4NQ==", "url": "https://github.com/openhab/openhab-addons/pull/7486#discussion_r419019085", "bodyText": "Fixed in latest commit", "author": "psmedley", "createdAt": "2020-05-02T23:06:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk2Mjc2Ng=="}], "type": "inlineReview"}, {"oid": "a9ff9d4642c7cc06e03582d384f1e1d24b2f773e", "url": "https://github.com/openhab/openhab-addons/commit/a9ff9d4642c7cc06e03582d384f1e1d24b2f773e", "message": "Logging tweak\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-05-02T22:47:25Z", "type": "commit"}, {"oid": "0086b5bc2894f0dc9cd0173898d1bda196f337eb", "url": "https://github.com/openhab/openhab-addons/commit/0086b5bc2894f0dc9cd0173898d1bda196f337eb", "message": "Further improvements\n\nSigned-off-by: Paul Smedley <paul@smedley.id.au>", "committedDate": "2020-05-02T23:02:02Z", "type": "commit"}]}