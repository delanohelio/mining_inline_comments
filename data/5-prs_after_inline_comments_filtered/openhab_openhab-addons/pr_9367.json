{"pr_number": 9367, "pr_title": "[hue] Make sure the serial number will be in lowercase", "pr_createdAt": "2020-12-13T16:50:18Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/9367", "timeline": [{"oid": "f55189036f8a14199c6d1e5a26ec5f54e118fa93", "url": "https://github.com/openhab/openhab-addons/commit/f55189036f8a14199c6d1e5a26ec5f54e118fa93", "message": "[hue] Make sure the serial number will be in lowercase\n\nNecessary for the auto-ignore discovery feature with the representation property.\n\nFix #9364\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>", "committedDate": "2020-12-13T16:44:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMwMTA4Nw==", "url": "https://github.com/openhab/openhab-addons/pull/9367#discussion_r545301087", "bodyText": "Is it possible that serial number is null here?", "author": "cpmeister", "createdAt": "2020-12-17T18:16:02Z", "path": "bundles/org.openhab.binding.hue/src/main/java/org/openhab/binding/hue/internal/discovery/HueBridgeDiscoveryParticipant.java", "diffHunk": "@@ -57,7 +57,7 @@\n             properties.put(HOST, device.getDetails().getBaseURL().getHost());\n             properties.put(PORT, device.getDetails().getBaseURL().getPort());\n             properties.put(PROTOCOL, device.getDetails().getBaseURL().getProtocol());\n-            properties.put(PROPERTY_SERIAL_NUMBER, device.getDetails().getSerialNumber());\n+            properties.put(PROPERTY_SERIAL_NUMBER, device.getDetails().getSerialNumber().toLowerCase());", "originalCommit": "f55189036f8a14199c6d1e5a26ec5f54e118fa93", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMxMzUzNg==", "url": "https://github.com/openhab/openhab-addons/pull/9367#discussion_r545313536", "bodyText": "Probably not in practice but it would be safer to check. I will fix that.", "author": "lolodomo", "createdAt": "2020-12-17T18:35:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMwMTA4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYzNzU0Mg==", "url": "https://github.com/openhab/openhab-addons/pull/9367#discussion_r545637542", "bodyText": "Done", "author": "lolodomo", "createdAt": "2020-12-18T08:11:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMwMTA4Nw=="}], "type": "inlineReview"}, {"oid": "68de05908459bae45e19cb28f1708a24f3cd86b9", "url": "https://github.com/openhab/openhab-addons/commit/68de05908459bae45e19cb28f1708a24f3cd86b9", "message": "Check that the serial number is not null\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>", "committedDate": "2020-12-18T08:10:21Z", "type": "commit"}, {"oid": "f967286231155514aac11761864f3191284e6f93", "url": "https://github.com/openhab/openhab-addons/commit/f967286231155514aac11761864f3191284e6f93", "message": "Check that the serial number is not blank\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>", "committedDate": "2020-12-18T08:28:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA3ODUyNQ==", "url": "https://github.com/openhab/openhab-addons/pull/9367#discussion_r546078525", "bodyText": "Why shouldn't host, port and protocol be set, just because no serial number is available?", "author": "kaikreuzer", "createdAt": "2020-12-18T20:36:37Z", "path": "bundles/org.openhab.binding.hue/src/main/java/org/openhab/binding/hue/internal/discovery/HueBridgeDiscoveryParticipant.java", "diffHunk": "@@ -51,13 +51,14 @@\n \n     @Override\n     public @Nullable DiscoveryResult createResult(RemoteDevice device) {\n+        String serialNumber = device.getDetails().getSerialNumber();\n         ThingUID uid = getThingUID(device);\n-        if (uid != null) {\n+        if (uid != null && serialNumber != null && !serialNumber.isBlank()) {", "originalCommit": "f967286231155514aac11761864f3191284e6f93", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA4MzkwMA==", "url": "https://github.com/openhab/openhab-addons/pull/9367#discussion_r546083900", "bodyText": "Because the serial number is required to build the thing UID and is the representation property of the thinj.", "author": "lolodomo", "createdAt": "2020-12-18T20:49:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA3ODUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA4NTAyOQ==", "url": "https://github.com/openhab/openhab-addons/pull/9367#discussion_r546085029", "bodyText": "That is an assumption on how getThingUID, but that could potentially change at any time in future. Imho such implicit assumptions that are based on a current implementation should not be made.", "author": "kaikreuzer", "createdAt": "2020-12-18T20:52:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA3ODUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA4ODEzMA==", "url": "https://github.com/openhab/openhab-addons/pull/9367#discussion_r546088130", "bodyText": "Ok, I will change.", "author": "lolodomo", "createdAt": "2020-12-18T20:59:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA3ODUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA5MjE0OQ==", "url": "https://github.com/openhab/openhab-addons/pull/9367#discussion_r546092149", "bodyText": "Done", "author": "lolodomo", "createdAt": "2020-12-18T21:10:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA3ODUyNQ=="}], "type": "inlineReview"}, {"oid": "923f5f3f7b0b95ca1e13e231ab664a40add6d7d4", "url": "https://github.com/openhab/openhab-addons/commit/923f5f3f7b0b95ca1e13e231ab664a40add6d7d4", "message": "Build a discovery result even without a serial number\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>", "committedDate": "2020-12-18T21:07:35Z", "type": "commit"}]}