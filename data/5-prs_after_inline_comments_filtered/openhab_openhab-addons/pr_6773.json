{"pr_number": 6773, "pr_title": "[tplinksmarthome] Added support for KP303", "pr_createdAt": "2020-01-06T11:43:06Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/6773", "timeline": [{"oid": "1da59f2562dd6bfe7ac1ea5578e2e3ec826502e5", "url": "https://github.com/openhab/openhab-addons/commit/1da59f2562dd6bfe7ac1ea5578e2e3ec826502e5", "message": "[tplinksmarthome] Added support for KP303\n\nFixes also global On/Off state of power strip devices.\n\nCloses #6576\n\nSigned-off-by: Hilbrand Bouwkamp <hilbrand@h72.nl>", "committedDate": "2020-01-06T11:37:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzkxNDI0Ng==", "url": "https://github.com/openhab/openhab-addons/pull/6773#discussion_r363914246", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    for (int i = 0; i < childIds.size(); i++) {\n          \n          \n            \n                    return deviceState.getSysinfo().getChildren().stream().parallel().filter(e -> OnOffType.ON.equals(e.getState())).findAny().isPresent();", "author": "J-N-K", "createdAt": "2020-01-07T19:34:01Z", "path": "bundles/org.openhab.binding.tplinksmarthome/src/main/java/org/openhab/binding/tplinksmarthome/internal/device/PowerStripDevice.java", "diffHunk": "@@ -73,7 +68,18 @@ public void refreshedDeviceState(@Nullable DeviceState deviceState) {\n     }\n \n     @Override\n-    public State updateChannel(ChannelUID channelUid, DeviceState deviceState) {\n+    protected State getOnOffState(final DeviceState deviceState) {\n+        // Global On/Off state is determined by the combined state of all sockets. If 1 socket is on, the state is on.\n+        for (int i = 0; i < childIds.size(); i++) {", "originalCommit": "1da59f2562dd6bfe7ac1ea5578e2e3ec826502e5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDI1NzM2Mw==", "url": "https://github.com/openhab/openhab-addons/pull/6773#discussion_r364257363", "bodyText": "Ah, yes that can be done using streams. Added it with a slightly different variant as it requires a  State.", "author": "Hilbrand", "createdAt": "2020-01-08T14:28:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzkxNDI0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5MDY0Mw==", "url": "https://github.com/openhab/openhab-addons/pull/6773#discussion_r365390643", "bodyText": "Nice", "author": "J-N-K", "createdAt": "2020-01-10T19:18:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzkxNDI0Ng=="}], "type": "inlineReview"}, {"oid": "dc93b6d3505befe2d4937b600b430cc2c4407ca1", "url": "https://github.com/openhab/openhab-addons/commit/dc93b6d3505befe2d4937b600b430cc2c4407ca1", "message": "Review comment\n\nSigned-off-by: Hilbrand Bouwkamp <hilbrand@h72.nl>", "committedDate": "2020-01-08T14:26:15Z", "type": "commit"}]}