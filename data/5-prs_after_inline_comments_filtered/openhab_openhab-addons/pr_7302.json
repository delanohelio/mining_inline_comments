{"pr_number": 7302, "pr_title": "[lgwebos] Update the thing configuration only if the key is different", "pr_createdAt": "2020-04-05T12:03:07Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/7302", "timeline": [{"oid": "57f4d5742807fa4a36040ee9b5cf36da4af112e5", "url": "https://github.com/openhab/openhab-addons/commit/57f4d5742807fa4a36040ee9b5cf36da4af112e5", "message": "[lgwebos] Update the thing configuration only if the key is different\n\nAvoid concurrent edit of thing configuration/properties\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>", "committedDate": "2020-04-05T12:00:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzcwNjA0Mw==", "url": "https://github.com/openhab/openhab-addons/pull/7302#discussion_r403706043", "bodyText": "why synchronized?", "author": "cpmeister", "createdAt": "2020-04-05T14:01:13Z", "path": "bundles/org.openhab.binding.lgwebos/src/main/java/org/openhab/binding/lgwebos/internal/handler/LGWebOSHandler.java", "diffHunk": "@@ -236,18 +236,22 @@ public String getKey() {\n     }\n \n     @Override\n-    public void storeKey(@Nullable String key) {\n-        // store it current configuration and avoiding complete re-initialization via handleConfigurationUpdate\n-        getLGWebOSConfig().key = key;\n-\n-        // persist the configuration change\n-        Configuration configuration = editConfiguration();\n-        configuration.put(LGWebOSBindingConstants.CONFIG_KEY, key);\n-        updateConfiguration(configuration);\n+    public synchronized void storeKey(@Nullable String key) {\n+        if (!getKey().equals(key)) {\n+            logger.debug(\"store new key\");\n+            // store it current configuration and avoiding complete re-initialization via handleConfigurationUpdate\n+            getLGWebOSConfig().key = key;\n+\n+            // persist the configuration change\n+            Configuration configuration = editConfiguration();\n+            configuration.put(LGWebOSBindingConstants.CONFIG_KEY, key);\n+            updateConfiguration(configuration);\n+        }\n     }\n \n     @Override\n-    public void storeProperties(Map<String, String> properties) {\n+    public synchronized void storeProperties(Map<String, String> properties) {", "originalCommit": "57f4d5742807fa4a36040ee9b5cf36da4af112e5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzcxMzA4Mg==", "url": "https://github.com/openhab/openhab-addons/pull/7302#discussion_r403713082", "bodyText": "This is not the case with the current code but with another of my changes, you could have different threads calling storeProperties at the same time.\nBy the way, I see that there is an object synchronizetion inside updateProperties and updateConfiguration so this is very probably useless to add one at the binding level.", "author": "lolodomo", "createdAt": "2020-04-05T14:57:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzcwNjA0Mw=="}], "type": "inlineReview"}, {"oid": "f869e1156e2ebd1ecb45994199067364d7c71c74", "url": "https://github.com/openhab/openhab-addons/commit/f869e1156e2ebd1ecb45994199067364d7c71c74", "message": "Suppress useless added synchronized\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>", "committedDate": "2020-04-05T14:59:10Z", "type": "commit"}]}