{"pr_number": 9245, "pr_title": "[velux] fix bugs with Somfy devices, and switch devices", "pr_createdAt": "2020-12-05T14:04:20Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/9245", "timeline": [{"oid": "614900c9e86d9b6038ec1fb4a986352f3141c703", "url": "https://github.com/openhab/openhab-addons/commit/614900c9e86d9b6038ec1fb4a986352f3141c703", "message": "[velux] add data type to config params in readme\n\nSigned-off-by: Andrew Fiddian-Green <software@whitebear.ch>", "committedDate": "2020-12-04T16:36:37Z", "type": "commit"}, {"oid": "5787cc6b6cf00f6358aaf6d3a4aec0b3054464bc", "url": "https://github.com/openhab/openhab-addons/commit/5787cc6b6cf00f6358aaf6d3a4aec0b3054464bc", "message": "[velux] eliminate mvn warning\n\nSigned-off-by: Andrew Fiddian-Green <software@whitebear.ch>", "committedDate": "2020-12-04T16:39:20Z", "type": "commit"}, {"oid": "3532f4ee15a64506be131567e067b1ed29923b7c", "url": "https://github.com/openhab/openhab-addons/commit/3532f4ee15a64506be131567e067b1ed29923b7c", "message": "[velux] fix Somfy bugs: uniqueindex = serial number or name\n\nSigned-off-by: Andrew Fiddian-Green <software@whitebear.ch>", "committedDate": "2020-12-04T17:34:15Z", "type": "commit"}, {"oid": "96ccbb82e34ff1e4a79f4b63a60aee0565a11966", "url": "https://github.com/openhab/openhab-addons/commit/96ccbb82e34ff1e4a79f4b63a60aee0565a11966", "message": "[velux] fix inconsistent switch state logic\n\nSigned-off-by: Andrew Fiddian-Green <software@whitebear.ch>", "committedDate": "2020-12-04T18:54:00Z", "type": "commit"}, {"oid": "4668b4ed1fa6896c879bb3849c115be0eabe7d38", "url": "https://github.com/openhab/openhab-addons/commit/4668b4ed1fa6896c879bb3849c115be0eabe7d38", "message": "[velux] cosmetics on BRIDGE_THING_TYPE_UID\n\nSigned-off-by: Andrew Fiddian-Green <software@whitebear.ch>", "committedDate": "2020-12-05T13:42:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgxMTA4Nw==", "url": "https://github.com/openhab/openhab-addons/pull/9245#discussion_r537811087", "bodyText": "typeId isn't included here anymore?", "author": "cpmeister", "createdAt": "2020-12-07T20:30:24Z", "path": "bundles/org.openhab.binding.velux/src/main/java/org/openhab/binding/velux/internal/things/VeluxProduct.java", "diffHunk": "@@ -217,7 +217,10 @@ public String toString() {\n     // Class helper methods\n \n     public String getProductUniqueIndex() {\n-        return this.name.toString().concat(\"#\").concat(this.typeId.toString());\n+        if (!v2 || serialNumber.startsWith(VeluxProductSerialNo.UNKNOWN)) {\n+            return name.toString();", "originalCommit": "4668b4ed1fa6896c879bb3849c115be0eabe7d38", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODQ5ODE1Mg==", "url": "https://github.com/openhab/openhab-addons/pull/9245#discussion_r538498152", "bodyText": "Correct. This is explicitly intended.\n{ The uniqueIndex is an attribute that must explicitly identify the device in the hub. The hub knows nothing of OH type ids or other decorations that the binding or the user might apply. The bug in the previous code was precisely because the original coder lost track of the difference between attributes in the hub, and potentially decorated attributes in the binding. This bug fix takes it firmly back to the basics again. }", "author": "andrewfg", "createdAt": "2020-12-08T15:27:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgxMTA4Nw=="}], "type": "inlineReview"}]}