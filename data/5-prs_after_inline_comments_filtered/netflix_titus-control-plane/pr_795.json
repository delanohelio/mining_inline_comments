{"pr_number": 795, "pr_title": "Refactoring ConstraintValidators to sanitize violation message templates", "pr_createdAt": "2020-02-29T01:36:56Z", "pr_url": "https://github.com/Netflix/titus-control-plane/pull/795", "timeline": [{"oid": "977bddc7bfeaeacc33d15b82157aff95a6f9b48f", "url": "https://github.com/Netflix/titus-control-plane/commit/977bddc7bfeaeacc33d15b82157aff95a6f9b48f", "message": "Refactoring ConstraintValidators to sanitize violation message so it is not an EL expression", "committedDate": "2020-02-29T00:54:26Z", "type": "commit"}, {"oid": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "url": "https://github.com/Netflix/titus-control-plane/commit/59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "message": "Merge pull request #3 from joshi-keyur/VUL-1981/sanitize-violation-message\n\nRefactoring ConstraintValidators to sanitize violation message templates", "committedDate": "2020-02-29T01:35:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxNzAxNA==", "url": "https://github.com/Netflix/titus-control-plane/pull/795#discussion_r386517014", "bodyText": "protected? We want clients to call the original validator method?", "author": "tbak", "createdAt": "2020-03-02T16:52:26Z", "path": "titus-api/src/main/java/com/netflix/titus/api/jobmanager/model/job/sanitizer/SchedulingConstraintSetValidator.java", "diffHunk": "@@ -53,7 +54,7 @@ public void initialize(SchedulingConstraintSet constraintAnnotation) {\n     }\n \n     @Override\n-    public boolean isValid(Container container, ConstraintValidatorContext context) {\n+    public boolean isValid(Container container, ConstraintValidatorContextWrapper context) {", "originalCommit": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxNzgyNA==", "url": "https://github.com/Netflix/titus-control-plane/pull/795#discussion_r386517824", "bodyText": "protected?", "author": "tbak", "createdAt": "2020-03-02T16:53:41Z", "path": "titus-common/src/main/java/com/netflix/titus/common/model/sanitizer/internal/AbstractConstraintValidator.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright 2020 Netflix, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.netflix.titus.common.model.sanitizer.internal;\n+\n+import javax.validation.ConstraintValidator;\n+import javax.validation.ConstraintValidatorContext;\n+import java.lang.annotation.Annotation;\n+\n+public abstract class AbstractConstraintValidator<A extends Annotation, T> implements ConstraintValidator<A, T> {\n+\n+    @Override\n+    final public boolean isValid(T type, ConstraintValidatorContext context) {\n+        return this.isValid(type, new ConstraintValidatorContextWrapper(context));\n+    }\n+\n+    abstract public boolean isValid(T type, ConstraintValidatorContextWrapper wrapper);", "originalCommit": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUyMDMyMA==", "url": "https://github.com/Netflix/titus-control-plane/pull/795#discussion_r386520320", "bodyText": "Replace this class with Function< String, ConstraintViolationBuilder >, and the default implementation as here?", "author": "tbak", "createdAt": "2020-03-02T16:57:36Z", "path": "titus-common/src/main/java/com/netflix/titus/common/model/sanitizer/internal/ConstraintValidatorContextWrapper.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Copyright 2020 Netflix, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.netflix.titus.common.model.sanitizer.internal;\n+\n+import javax.validation.ConstraintValidatorContext;\n+\n+public class ConstraintValidatorContextWrapper {", "originalCommit": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjYzNTU4Mg==", "url": "https://github.com/Netflix/titus-control-plane/pull/795#discussion_r386635582", "bodyText": "Thank you for the feedback. Please review the updates.", "author": "joshi-keyur", "createdAt": "2020-03-02T20:36:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUyMDMyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU5NTE1NQ==", "url": "https://github.com/Netflix/titus-control-plane/pull/795#discussion_r386595155", "bodyText": "minor: weird indentation here", "author": "fabiokung", "createdAt": "2020-03-02T19:16:07Z", "path": "titus-api/src/main/java/com/netflix/titus/api/jobmanager/model/job/sanitizer/SchedulingConstraintValidator.java", "diffHunk": "@@ -66,17 +65,16 @@\n \n     @Override\n     public void initialize(SchedulingConstraint constraintAnnotation) {\n-    }\n+   }", "originalCommit": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b10fc85d64c5ae72663a0de03d3d48bf916af138", "url": "https://github.com/Netflix/titus-control-plane/commit/b10fc85d64c5ae72663a0de03d3d48bf916af138", "message": "Replacing the Wrapper class with a Function which sanitizes the string message", "committedDate": "2020-03-02T20:35:03Z", "type": "commit"}, {"oid": "9eb082394c84d191cc6de9318260b5866ae0ea3f", "url": "https://github.com/Netflix/titus-control-plane/commit/9eb082394c84d191cc6de9318260b5866ae0ea3f", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-03-03T19:24:20Z", "type": "commit"}]}