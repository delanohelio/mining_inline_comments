{"pr_number": 4707, "pr_title": "Executor quality of life and instrumentation", "pr_createdAt": "2020-04-14T16:59:17Z", "pr_url": "https://github.com/palantir/atlasdb/pull/4707", "timeline": [{"oid": "b8ad226b7c147ae2b7f4e2aec263a243f6e25450", "url": "https://github.com/palantir/atlasdb/commit/b8ad226b7c147ae2b7f4e2aec263a243f6e25450", "message": "PTExecutors improvements for cached executors\n\n1. PTExecutors use daemon threads by default to prevent tasks from\n   accidentally pinning up a JVM that wants to die.\n2. Added a new PTExecutors.newCachedThreadPool factory method which\n   takes a string base-name instead of an entire ThreadFactory.", "committedDate": "2020-04-14T16:33:31Z", "type": "commit"}, {"oid": "e7e298fc8c90483f76b2772a550843c080afad68", "url": "https://github.com/palantir/atlasdb/commit/e7e298fc8c90483f76b2772a550843c080afad68", "message": "ABI Break: PTExecutors.newCachedThreadPool returns ExecutorService\n\nThe interface type provide a more reasonable API surface than the\nconcrete implementation, and allows us to do more interesting things\nwithout resorting to terrible hacks that will come back to haunt us\nlater.", "committedDate": "2020-04-14T16:33:31Z", "type": "commit"}, {"oid": "1c5acf6061acdaf5067acd9fdaa11702c89be621", "url": "https://github.com/palantir/atlasdb/commit/1c5acf6061acdaf5067acd9fdaa11702c89be621", "message": "Instrument PTExecutors thread factory (NamedThreadFactory)", "committedDate": "2020-04-14T16:54:05Z", "type": "commit"}, {"oid": "dbe829d9ad427f8713b617658ce4e582cae91888", "url": "https://github.com/palantir/atlasdb/commit/dbe829d9ad427f8713b617658ce4e582cae91888", "message": "Add generated changelog entries", "committedDate": "2020-04-14T16:54:05Z", "type": "commit"}, {"oid": "a8a67696c7eb246eb991d12620b51bfa3ebb1a1c", "url": "https://github.com/palantir/atlasdb/commit/a8a67696c7eb246eb991d12620b51bfa3ebb1a1c", "message": "more instrumentation", "committedDate": "2020-04-14T18:27:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNDg4Ng==", "url": "https://github.com/palantir/atlasdb/pull/4707#discussion_r408334886", "bodyText": "nit: Don't feel strongly about which way this falls, but we should probably be consistent on whether we prefer the string literal or ThisClass.class.getName() for these executors.", "author": "jeremyk-91", "createdAt": "2020-04-14T18:07:10Z", "path": "lock-impl/src/test/java/com/palantir/lock/impl/ClientAwareLockTest.java", "diffHunk": "@@ -48,8 +47,7 @@\n @ShouldRetry\n public final class ClientAwareLockTest {\n \n-    private static final ExecutorService executor = PTExecutors.newCachedThreadPool(\n-            new NamedThreadFactory(ClientAwareLockTest.class.getName(), true));\n+    private static final ExecutorService executor = PTExecutors.newCachedThreadPool(\"ClientAwareLockTest\");", "originalCommit": "dbe829d9ad427f8713b617658ce4e582cae91888", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM1MDk2Mg==", "url": "https://github.com/palantir/atlasdb/pull/4707#discussion_r408350962", "bodyText": "that's fair, I'll revert these out to use class.getName(), no reason to churn on these in this change.", "author": "carterkozak", "createdAt": "2020-04-14T18:34:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNDg4Ng=="}], "type": "inlineReview"}, {"oid": "5370831c4bcb8dce5d2d3aab2c136ea3b5985bb5", "url": "https://github.com/palantir/atlasdb/commit/5370831c4bcb8dce5d2d3aab2c136ea3b5985bb5", "message": "CR", "committedDate": "2020-04-14T18:34:41Z", "type": "commit"}]}