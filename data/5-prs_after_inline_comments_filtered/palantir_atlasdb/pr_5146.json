{"pr_number": 5146, "pr_title": "[LW] [PDS-148088] Close your eyes", "pr_createdAt": "2020-12-04T14:17:31Z", "pr_url": "https://github.com/palantir/atlasdb/pull/5146", "timeline": [{"oid": "565bc61f6c41fe5861845d9739346ff24543f46c", "url": "https://github.com/palantir/atlasdb/commit/565bc61f6c41fe5861845d9739346ff24543f46c", "message": "fun fun fun and games", "committedDate": "2020-12-04T14:12:38Z", "type": "commit"}, {"oid": "90b151b6c0b764339bf3e3a6864bdc119df2ae5a", "url": "https://github.com/palantir/atlasdb/commit/90b151b6c0b764339bf3e3a6864bdc119df2ae5a", "message": "hahah", "committedDate": "2020-12-04T14:14:03Z", "type": "commit"}, {"oid": "91703b21c45509476995f4023198fd8a48f99554", "url": "https://github.com/palantir/atlasdb/commit/91703b21c45509476995f4023198fd8a48f99554", "message": "Add generated changelog entries", "committedDate": "2020-12-04T14:14:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEzNzgwNw==", "url": "https://github.com/palantir/atlasdb/pull/5146#discussion_r536137807", "bodyText": "the way this works in combination with the javadoc is strange (it seems like register should definitely be commutative and distributive over union based on its javadoc; that it's not is a bit weird and so needs calling out I think, at least internally). I'd suggest we either\n\nkeep this endpoint the way it is, and have a new endpoint called registerPreciselyWatches or something like that that makes it apparent that the client will no longer request previously registered things to be watched.\nor just rename this to registerPreciselyWatches, if the previous behaviour is not used anywhere", "author": "jeremyk-91", "createdAt": "2020-12-04T14:28:08Z", "path": "atlasdb-impl-shared/src/main/java/com/palantir/atlasdb/keyvalue/api/watch/LockWatchManagerImpl.java", "diffHunk": "@@ -70,6 +70,7 @@ public void close() {\n \n     @Override\n     public void registerWatches(Set<LockWatchReferences.LockWatchReference> newLockWatches) {\n+        lockWatchReferences.clear();", "originalCommit": "91703b21c45509476995f4023198fd8a48f99554", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "91def0dad097368b811e0e8998aa029aa76a91bc", "url": "https://github.com/palantir/atlasdb/commit/91def0dad097368b811e0e8998aa029aa76a91bc", "message": "address comments", "committedDate": "2020-12-04T14:39:38Z", "type": "commit"}, {"oid": "4a49646eb301cb0c49499bd0297bf75542fad8fb", "url": "https://github.com/palantir/atlasdb/commit/4a49646eb301cb0c49499bd0297bf75542fad8fb", "message": "Merge branch 'not-add-all' of github.com:palantir/atlasdb into not-add-all", "committedDate": "2020-12-04T14:39:51Z", "type": "commit"}, {"oid": "f7b67550606db8507975a769255815a1c1aedebb", "url": "https://github.com/palantir/atlasdb/commit/f7b67550606db8507975a769255815a1c1aedebb", "message": "Add generated changelog entries", "committedDate": "2020-12-04T14:39:51Z", "type": "commit"}]}