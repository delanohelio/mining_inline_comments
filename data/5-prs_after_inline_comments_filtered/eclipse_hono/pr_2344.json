{"pr_number": 2344, "pr_title": "Allow null contentType in Event/Telemetry Sender", "pr_createdAt": "2020-12-04T16:33:59Z", "pr_url": "https://github.com/eclipse/hono/pull/2344", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzMxMjkzOA==", "url": "https://github.com/eclipse/hono/pull/2344#discussion_r537312938", "bodyText": "how about adding a note to the contentType param that it will be set to the fallback content-type if a payload is given but no content-type is specified?", "author": "sophokles73", "createdAt": "2020-12-07T08:25:06Z", "path": "clients/adapter/src/main/java/org/eclipse/hono/adapter/client/telemetry/EventSender.java", "diffHunk": "@@ -47,7 +47,7 @@\n      *         The future will be failed with a {@code org.eclipse.hono.client.ServerErrorException} if the data\n      *         could not be sent. The error code contained in the exception indicates the\n      *         cause of the failure.\n-     * @throws NullPointerException if tenant ID, device ID or contentType are {@code null}.\n+     * @throws NullPointerException if tenant ID or device ID are {@code null}.", "originalCommit": "7d19d490e77851703456c4112d5ee4796a892d43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzM2NjU5Ng==", "url": "https://github.com/eclipse/hono/pull/2344#discussion_r537366596", "bodyText": "Yes. I'll do that in the next commit (see below), then aligned with the updated javadoc for MessageHelper#newMessage.", "author": "calohmn", "createdAt": "2020-12-07T09:47:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzMxMjkzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzMxNDY4NQ==", "url": "https://github.com/eclipse/hono/pull/2344#discussion_r537314685", "bodyText": "FMPOV we should not set the header at all if the device did not provide a content-type. Maybe the mapper wants to handle this case specifically?", "author": "sophokles73", "createdAt": "2020-12-07T08:27:57Z", "path": "adapters/mqtt-vertx-base/src/main/java/org/eclipse/hono/adapter/mqtt/impl/HttpBasedMessageMapping.java", "diffHunk": "@@ -120,7 +120,8 @@ private void mapMessageRequest(\n             }\n         });\n         headers.add(MessageHelper.APP_PROPERTY_ORIG_ADDRESS, ctx.message().topicName());\n-        headers.add(HttpHeaders.CONTENT_TYPE.toString(), ctx.contentType());\n+        headers.add(HttpHeaders.CONTENT_TYPE.toString(),", "originalCommit": "7d19d490e77851703456c4112d5ee4796a892d43", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c633c44a8df16d5f8559f2ae3d95a07f12312b39", "url": "https://github.com/eclipse/hono/commit/c633c44a8df16d5f8559f2ae3d95a07f12312b39", "message": "Allow null contentType in Event/Telemetry Sender.\n\nThis makes it possible that a content-type defined\nin the defaults of a tenant can be used as fallback.\nThis provides an alternative fix for #2338.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>", "committedDate": "2020-12-07T09:43:06Z", "type": "commit"}, {"oid": "c633c44a8df16d5f8559f2ae3d95a07f12312b39", "url": "https://github.com/eclipse/hono/commit/c633c44a8df16d5f8559f2ae3d95a07f12312b39", "message": "Allow null contentType in Event/Telemetry Sender.\n\nThis makes it possible that a content-type defined\nin the defaults of a tenant can be used as fallback.\nThis provides an alternative fix for #2338.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>", "committedDate": "2020-12-07T09:43:06Z", "type": "forcePushed"}]}