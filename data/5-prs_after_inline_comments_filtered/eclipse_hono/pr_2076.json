{"pr_number": 2076, "pr_title": "[#2075] Check adapter connection limit for unauthenticated devices", "pr_createdAt": "2020-07-08T07:21:05Z", "pr_url": "https://github.com/eclipse/hono/pull/2076", "timeline": [{"oid": "863cdbebed65665989a3c5b95ee644c0f0107c3d", "url": "https://github.com/eclipse/hono/commit/863cdbebed65665989a3c5b95ee644c0f0107c3d", "message": "[#2075] Check adapter connection limit for unauthenticated devices\n\nThe AMQP adapter now always checks the adapter's connection limit\nregardless of whether the device is authenticated or not.\n\nSigned-off-by: Kai Hudalla <kai.hudalla@bosch.io>", "committedDate": "2020-07-08T07:20:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ1NzU3Mw==", "url": "https://github.com/eclipse/hono/pull/2076#discussion_r451457573", "bodyText": "My first intuition here would have been to keep the order of the checks and do the (usually less expensive) tenant and device checks first. But, thinking more about it, I agree that doing the connection limit check first seems more intuitive and logical. In any case, that is also how it is done in the MQTT adapter.", "author": "calohmn", "createdAt": "2020-07-08T10:59:45Z", "path": "adapters/amqp-vertx/src/main/java/org/eclipse/hono/adapter/amqp/impl/VertxBasedAmqpProtocolAdapter.java", "diffHunk": "@@ -377,6 +377,36 @@ private void processRemoteOpen(final ProtonConnection con) {\n             TracingHelper.setDeviceTags(span, authenticatedDevice.getTenantId(), authenticatedDevice.getDeviceId());\n         }\n \n+        checkConnectionLimitForAdapter()", "originalCommit": "863cdbebed65665989a3c5b95ee644c0f0107c3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ2MDE5Ng==", "url": "https://github.com/eclipse/hono/pull/2076#discussion_r451460196", "bodyText": "actually, the adapter connection limit check is the cheapest one of all as it doesn't require any remote service invocation at all but simply checks an integer that is managed within the Metrics implementation class ...", "author": "sophokles73", "createdAt": "2020-07-08T11:04:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ1NzU3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUyNDI5Nw==", "url": "https://github.com/eclipse/hono/pull/2076#discussion_r451524297", "bodyText": "right, I confused it with the message limit check.", "author": "calohmn", "createdAt": "2020-07-08T12:58:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ1NzU3Mw=="}], "type": "inlineReview"}]}