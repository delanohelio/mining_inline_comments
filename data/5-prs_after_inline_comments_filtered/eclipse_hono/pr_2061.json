{"pr_number": 2061, "pr_title": "Do not enforce values to be returned from remote cache", "pr_createdAt": "2020-07-01T14:40:36Z", "pr_url": "https://github.com/eclipse/hono/pull/2061", "timeline": [{"oid": "217b61057160164676ef73dc4a8233ebb489b2d8", "url": "https://github.com/eclipse/hono/commit/217b61057160164676ef73dc4a8233ebb489b2d8", "message": "Do not enforce values to be returned from remote cache\n\nThe Hotrod client does no longer enforce (previous) values being\nreturned from the remote cache in the put and removeWithVersion methods\nas in the former case the returned value isn't used anyway and in the\nlatter case the flag should not have any impact at all.\nThe Hotrod client has been upgraded to 9.4.19.Final.\n\nSigned-off-by: Kai Hudalla <kai.hudalla@bosch.io>", "committedDate": "2020-07-01T14:13:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ1NTk3OQ==", "url": "https://github.com/eclipse/hono/pull/2061#discussion_r449455979", "bodyText": "When using that method in removeCommandHandlingAdapterInstance(), the return value is actually needed.\nThat means when removing the FORCE_RETURN_VALUE flag here, the removeCommandHandlingAdapterInstance() method also needs to be changed. I think we can do that here in 1.2.x - the information, whether removal succeeded or not is only logged here anyway.", "author": "calohmn", "createdAt": "2020-07-03T08:39:07Z", "path": "client-device-connection-infinispan/src/main/java/org/eclipse/hono/deviceconnection/infinispan/client/HotrodCache.java", "diffHunk": "@@ -227,11 +218,7 @@ public void addReconnectListener(final ReconnectListener<HotrodCache<K, V>> list\n \n         } else {\n \n-            return Futures.create(() -> {\n-                return cache\n-                    .withFlags(Flag.FORCE_RETURN_VALUE)\n-                    .removeWithVersionAsync(key, version);\n-            });\n+            return Futures.create(() -> cache.removeWithVersionAsync(key, version));", "originalCommit": "217b61057160164676ef73dc4a8233ebb489b2d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ2MTkwNQ==", "url": "https://github.com/eclipse/hono/pull/2061#discussion_r449461905", "bodyText": "You are suggesting that the FORCE_RETURN_VALUE flag determines whether we always get back a boolean as the result of removeWithVersionAsync, right? The only documentation I have found on this is https://infinispan.org/docs/9.4.x/user_guide/user_guide.html#return_values_2 which doesn't mention the removeWithVersionAsync method so I assume that the flag has no impact on that method. Or have you conducted any particular tests that would suggest otherwise?", "author": "sophokles73", "createdAt": "2020-07-03T08:50:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ1NTk3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTUyNDY4Mg==", "url": "https://github.com/eclipse/hono/pull/2061#discussion_r449524682", "bodyText": "I mixed it up with the removeAsync method here. So, you're right, I think the flag can be removed here without it affecting the return value.", "author": "calohmn", "createdAt": "2020-07-03T11:04:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ1NTk3OQ=="}], "type": "inlineReview"}]}