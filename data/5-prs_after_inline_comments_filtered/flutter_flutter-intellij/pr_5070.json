{"pr_number": 5070, "pr_title": "Add platforms to the new project wizard", "pr_createdAt": "2020-11-21T00:23:10Z", "pr_url": "https://github.com/flutter/flutter-intellij/pull/5070", "timeline": [{"oid": "b7d78b4bd9b2ab2ccff9fc36b505376d0d9b9814", "url": "https://github.com/flutter/flutter-intellij/commit/b7d78b4bd9b2ab2ccff9fc36b505376d0d9b9814", "message": "Add platforms to the new project wizard", "committedDate": "2020-12-07T17:22:08Z", "type": "commit"}, {"oid": "b58071487e1c734f372a5a2ece260020d83d9e4b", "url": "https://github.com/flutter/flutter-intellij/commit/b58071487e1c734f372a5a2ece260020d83d9e4b", "message": "Fix build", "committedDate": "2020-12-07T17:22:08Z", "type": "commit"}, {"oid": "250549af55e626180fa7b3b3255bac971fe99c13", "url": "https://github.com/flutter/flutter-intellij/commit/250549af55e626180fa7b3b3255bac971fe99c13", "message": "Wire up buttons", "committedDate": "2020-12-07T17:22:08Z", "type": "commit"}, {"oid": "f229e584c5fdf65edb05be52de2f7b93d36649b3", "url": "https://github.com/flutter/flutter-intellij/commit/f229e584c5fdf65edb05be52de2f7b93d36649b3", "message": "Fix logic errors, clean up", "committedDate": "2020-12-08T00:23:11Z", "type": "commit"}, {"oid": "f229e584c5fdf65edb05be52de2f7b93d36649b3", "url": "https://github.com/flutter/flutter-intellij/commit/f229e584c5fdf65edb05be52de2f7b93d36649b3", "message": "Fix logic errors, clean up", "committedDate": "2020-12-08T00:23:11Z", "type": "forcePushed"}, {"oid": "27d6b654790e048b757d2304dfcb4486c8a7ea33", "url": "https://github.com/flutter/flutter-intellij/commit/27d6b654790e048b757d2304dfcb4486c8a7ea33", "message": "Reimplement BoolValueProperty", "committedDate": "2020-12-08T18:38:13Z", "type": "commit"}, {"oid": "c1c1f79236d366acba617457cd6e3ad0a256d7e0", "url": "https://github.com/flutter/flutter-intellij/commit/c1c1f79236d366acba617457cd6e3ad0a256d7e0", "message": "Ensure platform nullity", "committedDate": "2020-12-09T17:23:23Z", "type": "commit"}, {"oid": "1f0fb97937474f25afc026647a0caa86f8926c61", "url": "https://github.com/flutter/flutter-intellij/commit/1f0fb97937474f25afc026647a0caa86f8926c61", "message": "Add settings when page two is displayed but not when Finish is clicked", "committedDate": "2020-12-09T21:41:38Z", "type": "commit"}, {"oid": "de84fd851548655ace454789848ade9d6f549249", "url": "https://github.com/flutter/flutter-intellij/commit/de84fd851548655ace454789848ade9d6f549249", "message": "Externalize strings and reformat", "committedDate": "2020-12-09T22:41:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDUyNTM0Mg==", "url": "https://github.com/flutter/flutter-intellij/pull/5070#discussion_r540525342", "bodyText": "I don't know if that's actually intended or if the flutter tool would pay attention to that.", "author": "devoncarew", "createdAt": "2020-12-10T21:55:44Z", "path": "src/io/flutter/sdk/FlutterSdk.java", "diffHunk": "@@ -474,12 +497,85 @@ public String getDartSdkPath() {\n   }\n \n   @Nullable\n-  public FlutterSdkChannel queryFlutterChannel() {\n-    String stdout = returnOutputOfQuery(flutterChannel());\n-    if (stdout == null) {\n-      return null;\n+  @NonNls\n+  public FlutterSdkChannel queryFlutterChannel(boolean useCachedValue) {\n+    if (useCachedValue) {\n+      String channel = cachedConfigValues.get(\"channel\");\n+      if (channel != null) {\n+        return FlutterSdkChannel.fromText(channel);\n+      }\n     }\n-    return FlutterSdkChannel.fromText(stdout);\n+\n+    VirtualFile dir = LocalFileSystem.getInstance().findFileByPath(getHomePath());\n+    assert dir != null;\n+    String branch;\n+    try {\n+      branch = git4idea.light.LightGitUtilKt.getLocation(dir, GitExecutableManager.getInstance().getExecutable((Project)null));\n+    }\n+    catch (VcsException e) {\n+      LOG.error(e);\n+      branch = \"unknown\";\n+    }\n+\n+    cachedConfigValues.put(\"channel\", branch);\n+    return FlutterSdkChannel.fromText(branch);\n+  }\n+\n+  @NonNls\n+  private static final String[] PLATFORMS =\n+    new String[]{\"enable-android\", \"enable-ios\", \"enable-web\", \"enable-linux-desktop\", \"enable-macos-desktop\", \"enable-windows-desktop\"};\n+\n+  @NotNull\n+  @NonNls\n+  public Set<String> queryConfiguredPlatforms(boolean useCachedValue) {\n+    Set<String> platforms = new HashSet<>();\n+    // Someone could do: flutter config --no-enable-ios --no-enable-android", "originalCommit": "de84fd851548655ace454789848ade9d6f549249", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDU4NzY5Mg==", "url": "https://github.com/flutter/flutter-intellij/pull/5070#discussion_r540587692", "bodyText": "It doesn't. But if someone went to that much trouble we should initialize the checkboxes to respect the setting, I think.", "author": "stevemessick", "createdAt": "2020-12-10T23:54:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDUyNTM0Mg=="}], "type": "inlineReview"}, {"oid": "c10e1de54ce75daed5c127b9af8490830bb52ef9", "url": "https://github.com/flutter/flutter-intellij/commit/c10e1de54ce75daed5c127b9af8490830bb52ef9", "message": "Rework state variables", "committedDate": "2020-12-11T23:47:17Z", "type": "commit"}, {"oid": "b2bbce79b8cdbe6cf25c3d26c2c220289b7b3940", "url": "https://github.com/flutter/flutter-intellij/commit/b2bbce79b8cdbe6cf25c3d26c2c220289b7b3940", "message": "Change to run flutter config", "committedDate": "2020-12-15T17:45:44Z", "type": "commit"}]}