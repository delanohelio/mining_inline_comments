{"pr_number": 4449, "pr_title": "data drive survey", "pr_createdAt": "2020-03-30T21:58:50Z", "pr_url": "https://github.com/flutter/flutter-intellij/pull/4449", "timeline": [{"oid": "dd1698a17558e459352c4dc4b415579bd6c29e1a", "url": "https://github.com/flutter/flutter-intellij/commit/dd1698a17558e459352c4dc4b415579bd6c29e1a", "message": "data drive survey", "committedDate": "2020-03-30T21:55:04Z", "type": "commit"}, {"oid": "3e87ebf9307e3ba0103d832e99e3c511baf55759", "url": "https://github.com/flutter/flutter-intellij/commit/3e87ebf9307e3ba0103d832e99e3c511baf55759", "message": "add URL reading", "committedDate": "2020-03-30T22:23:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU2MDQ1Nw==", "url": "https://github.com/flutter/flutter-intellij/pull/4449#discussion_r400560457", "bodyText": "I assume that the start date is inclusive, and the end date is exclusive? Or are they both inclusive?\nThis should likely read something like now.isEqualToOrAfter(startDate).", "author": "devoncarew", "createdAt": "2020-03-30T23:46:27Z", "path": "src/io/flutter/survey/FlutterSurvey.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Copyright 2020 The Chromium Authors. All rights reserved.\n+ * Use of this source code is governed by a BSD-style license that can be\n+ * found in the LICENSE file.\n+ */\n+package io.flutter.survey;\n+\n+import com.google.gson.JsonObject;\n+import org.jetbrains.annotations.NotNull;\n+\n+import java.time.LocalDate;\n+import java.time.format.DateTimeFormatter;\n+\n+public class FlutterSurvey {\n+  final String uniqueId;\n+  final LocalDate startDate;\n+  final LocalDate endDate;\n+\n+  final String title;\n+  final String urlPrefix;\n+\n+  FlutterSurvey(String uniqueId, String startDate, String endDate, String title, String urlPrefix) {\n+    this.uniqueId = uniqueId;\n+    this.startDate = parseDate(startDate);\n+    this.endDate = parseDate(endDate);\n+    this.title = title;\n+    this.urlPrefix = urlPrefix;\n+  }\n+\n+  private static LocalDate parseDate(String date) {\n+    return LocalDate.from(DateTimeFormatter.ISO_DATE_TIME.parse(date));\n+  }\n+\n+  public static FlutterSurvey fromJson(@NotNull JsonObject json) {\n+    return new FlutterSurvey(json.getAsJsonPrimitive(\"uniqueId\").getAsString(),\n+                             json.getAsJsonPrimitive(\"startDate\").getAsString(),\n+                             json.getAsJsonPrimitive(\"endDate\").getAsString(),\n+                             json.getAsJsonPrimitive(\"title\").getAsString(),\n+                             json.getAsJsonPrimitive(\"url\").getAsString()\n+    );\n+  }\n+\n+  boolean isSurveyOpen() {\n+    final LocalDate now = LocalDate.now();\n+    return now.isAfter(startDate) && now.isBefore(endDate);", "originalCommit": "3e87ebf9307e3ba0103d832e99e3c511baf55759", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU2NTQwNw==", "url": "https://github.com/flutter/flutter-intellij/pull/4449#discussion_r400565407", "bodyText": "I guess inclusive/exclusive won't matter that much, because both start date and end date actually specify the time, in addition to the date. So something consistent would work..?\n\"startDate\": \"2020-03-03T09:00:00-08:00\",\n\"endDate\": \"2020-03-10T09:00:00-07:00\"\n\nOr perhaps I should change the names of the objects to startDateAndTime and 'endDateAndTime` to avoid confusion?", "author": "jayoung-lee", "createdAt": "2020-03-31T00:02:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU2MDQ1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU5OTEwNw==", "url": "https://github.com/flutter/flutter-intellij/pull/4449#discussion_r400599107", "bodyText": "Ah, I'd written that thinking that it was for a day, not a date+time; agree that it doesn't matter if we're just talking about a second or millisecond.", "author": "devoncarew", "createdAt": "2020-03-31T02:02:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU2MDQ1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NjgyOQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4449#discussion_r400946829", "bodyText": "if we're just talking about a second or millisecond\n\nExactly my thinking.\n\nOr perhaps I should change the names of the objects to startDateAndTime and 'endDateAndTime` to avoid confusion?\n\nI don't  think it's necessary but  happy to go with the flow.", "author": "pq", "createdAt": "2020-03-31T14:13:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU2MDQ1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NzYzNg==", "url": "https://github.com/flutter/flutter-intellij/pull/4449#discussion_r400947636", "bodyText": "Updated to now.isEqual(startDate) || now.isAfter(startDate) ...", "author": "pq", "createdAt": "2020-03-31T14:14:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU2MDQ1Nw=="}], "type": "inlineReview"}, {"oid": "4f572edbe0184bfcf524340c11d9ecf54a92edc9", "url": "https://github.com/flutter/flutter-intellij/commit/4f572edbe0184bfcf524340c11d9ecf54a92edc9", "message": "equal or after", "committedDate": "2020-03-31T14:13:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg4MjI5Ng==", "url": "https://github.com/flutter/flutter-intellij/pull/4449#discussion_r404882296", "bodyText": "@pq - it looks like the following code happens synchronously on whatever thread we were called on (potentially the EDT)?\nYou may change this to working on a background thread (and if necessary, switching back the EDT at the very end).\nWe use a few different ways to execute in background threads - one is ApplicationManager.getApplication().executeOnPooledThread() (not sure if other's may be more appropriate).", "author": "devoncarew", "createdAt": "2020-04-07T15:04:31Z", "path": "src/io/flutter/survey/FlutterSurveyNotifications.java", "diffHunk": "@@ -94,26 +72,23 @@ private void check(@NotNull VirtualFile file) {\n     });\n   }\n \n-  @NotNull final Project myProject;\n-\n-  FlutterSurveyNotifications(@NotNull Project project) {\n-    this.myProject = project;\n-  }\n-\n   private void checkForDisplaySurvey() {", "originalCommit": "4f572edbe0184bfcf524340c11d9ecf54a92edc9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg4MzMwMQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4449#discussion_r404883301", "bodyText": "Yup. I'm looking at this very thing! Sorry I missed it first time through!", "author": "pq", "createdAt": "2020-04-07T15:05:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg4MjI5Ng=="}], "type": "inlineReview"}]}