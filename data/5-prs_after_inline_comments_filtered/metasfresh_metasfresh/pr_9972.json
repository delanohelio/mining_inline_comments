{"pr_number": 9972, "pr_title": "Allow `Issue`ing of `By-Product` and `Co-Product` created HUs in manufacturing", "pr_createdAt": "2020-09-18T09:45:55Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/9972", "timeline": [{"oid": "3a1139bbbb493cd64ab6cab5c6a5b152e4ca1aee", "url": "https://github.com/metasfresh/metasfresh/commit/3a1139bbbb493cd64ab6cab5c6a5b152e4ca1aee", "message": "Use HU.Status when checking if a HU is issued or not\n\nhttps://github.com/metasfresh/metasfresh/issues/9971", "committedDate": "2020-09-22T05:21:20Z", "type": "commit"}, {"oid": "c177fd37864c266e0e8febec49a51f4618b51318", "url": "https://github.com/metasfresh/metasfresh/commit/c177fd37864c266e0e8febec49a51f4618b51318", "message": "Bugfix: don't set virtual column\n\nhttps://github.com/metasfresh/metasfresh/issues/9971", "committedDate": "2020-09-22T05:22:03Z", "type": "commit"}, {"oid": "c177fd37864c266e0e8febec49a51f4618b51318", "url": "https://github.com/metasfresh/metasfresh/commit/c177fd37864c266e0e8febec49a51f4618b51318", "message": "Bugfix: don't set virtual column\n\nhttps://github.com/metasfresh/metasfresh/issues/9971", "committedDate": "2020-09-22T05:22:03Z", "type": "forcePushed"}, {"oid": "4e8c61bb6b5d39e743abc9fa284a9cc3aa8435ec", "url": "https://github.com/metasfresh/metasfresh/commit/4e8c61bb6b5d39e743abc9fa284a9cc3aa8435ec", "message": "Revert \"Create a WidgetWrapper component for fetching data (#9973)\" (#9985)\n\nThis reverts commit 58ee80b1b4e1e6c0a77304376aed7a4e25850c32.", "committedDate": "2020-09-22T09:32:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc3ODk4NQ==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r492778985", "bodyText": "pls always use IHandlingUnitsDAO.getById !", "author": "teosarca", "createdAt": "2020-09-22T14:26:45Z", "path": "backend/de.metas.handlingunits.base/src/main/java/de/metas/handlingunits/impl/HUStatusBL.java", "diffHunk": "@@ -237,6 +238,11 @@ public boolean isStatusIssued(@Nullable final I_M_HU huRecord)\n \t\treturn X_M_HU.HUSTATUS_Issued.equals(huRecord.getHUStatus());\n \t}\n \n+\t@Override\n+\tpublic boolean isStatusIssued(@NonNull final HuId huId){\n+\t\treturn isStatusIssued(InterfaceWrapperHelper.load(huId, I_M_HU.class));", "originalCommit": "c177fd37864c266e0e8febec49a51f4618b51318", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzQ0NTU3MA==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r493445570", "bodyText": "done", "author": "TheBestPessimist", "createdAt": "2020-09-23T10:52:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc3ODk4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4MTQ3Nw==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r492781477", "bodyText": "why removing this line?", "author": "teosarca", "createdAt": "2020-09-22T14:29:43Z", "path": "backend/de.metas.manufacturing/src/main/java/org/eevolution/api/impl/PPOrderBL.java", "diffHunk": "@@ -153,7 +155,6 @@ public void updateQtyBatchs(final I_PP_Order order, final boolean override)\n \n \t\t\tfinal I_AD_Workflow wf = order.getAD_Workflow();\n \t\t\tqtyBatchSize = wf.getQtyBatchSize().setScale(0, RoundingMode.UP);\n-\t\t\torder.setQtyBatchSize(qtyBatchSize);", "originalCommit": "c177fd37864c266e0e8febec49a51f4618b51318", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE5OTc0OA==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r493199748", "bodyText": "because the column is virtual, so setting it throws error.\nIt was made virtual in: #9894", "author": "TheBestPessimist", "createdAt": "2020-09-23T05:06:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4MTQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwMDkyOA==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r493200928", "bodyText": "Though, after another merge it is no longer marked as virtual. Something is weird here:\n\nf437974\n\n\nI'm trying to figure out with @metas-ts what's going on about that field.", "author": "TheBestPessimist", "createdAt": "2020-09-23T05:11:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4MTQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzQ1NTk4MA==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r493455980", "bodyText": "checked again locally, and now (after master rebase) QtyBatchSize is no longer virtual. \u00af\\_(\u30c4)_/\u00af", "author": "TheBestPessimist", "createdAt": "2020-09-23T11:04:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4MTQ3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4NzMyNQ==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r492787325", "bodyText": "instead of removing it, we shall introduce PP_Order_Qty.Type={I=Issue, R=Receipt}.\nisHuIdIssued shall also filter by Type=I.\nTo set the new field, check\nde.metas.handlingunits.pporder.api.impl.HUPPOrderQtyDAO.save(CreateIssueCandidateRequest)\nde.metas.handlingunits.pporder.api.impl.HUPPOrderQtyDAO.save(CreateReceiptCandidateRequest)\nAlso, don't forget to migrate the new column!", "author": "teosarca", "createdAt": "2020-09-22T14:36:56Z", "path": "backend/de.metas.handlingunits.base/src/main/java/de/metas/handlingunits/pporder/api/impl/HUPPOrderQtyDAO.java", "diffHunk": "@@ -161,16 +161,4 @@ public I_PP_Order_Qty retrieveOrderQtyForCostCollector(@NonNull final PPOrderId\n \t\t\t\t})\n \t\t\t\t.orElse(null);\n \t}\n-\n-\t@Override\n-\t@Cached(cacheName = I_PP_Order_Qty.Table_Name + \"#by#\" + I_PP_Order_Qty.COLUMNNAME_M_HU_ID)\n-\tpublic boolean isHuIdIssued(@NonNull final HuId huId)", "originalCommit": "c177fd37864c266e0e8febec49a51f4618b51318", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwMDAyMQ==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r493200021", "bodyText": "Q: why add 2 different ways of checking if a HU is issued or not?\nThis doesn't seem right to me, when we already have the HU.Status field.", "author": "TheBestPessimist", "createdAt": "2020-09-23T05:07:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4NzMyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI4MzQ3OA==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r493283478", "bodyText": "Confirmed with teo on skype: It's ok to use HU.Status instead of using PP_Order_Qty.", "author": "TheBestPessimist", "createdAt": "2020-09-23T08:03:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4NzMyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4NzgwOQ==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r492787809", "bodyText": "pls don't remove it", "author": "teosarca", "createdAt": "2020-09-22T14:37:32Z", "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/pporder/process/WEBUI_PP_Order_HUEditor_Launcher.java", "diffHunk": "@@ -173,7 +172,7 @@ private boolean isEligibleHuToIssue(final HuId huId)\n \t\t\treturn false;\n \t\t}\n \n-\t\tif (huOrderCandidatesRepo.isHuIdIssued(huId))", "originalCommit": "c177fd37864c266e0e8febec49a51f4618b51318", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwMTUwMg==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r493201502", "bodyText": "Same reply as previous one: i'm checking HU.Status via huStatusBL instead", "author": "TheBestPessimist", "createdAt": "2020-09-23T05:13:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4NzgwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI4MzU4MA==", "url": "https://github.com/metasfresh/metasfresh/pull/9972#discussion_r493283580", "bodyText": "Confirmed with teo on skype: It's ok to use HU.Status instead of using PP_Order_Qty.", "author": "TheBestPessimist", "createdAt": "2020-09-23T08:04:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjc4NzgwOQ=="}], "type": "inlineReview"}, {"oid": "3ca2b3a12a16d51fe8ffb4b008eda1dac237bfd0", "url": "https://github.com/metasfresh/metasfresh/commit/3ca2b3a12a16d51fe8ffb4b008eda1dac237bfd0", "message": "PPOrderCost: set `coProductCostDistributionPercent` to 0 instead of null\n\nhttps://github.com/metasfresh/metasfresh/issues/9971", "committedDate": "2020-09-23T10:11:49Z", "type": "commit"}, {"oid": "576b3b3564736bfcc7c1a803e8f8c23f594aad75", "url": "https://github.com/metasfresh/metasfresh/commit/576b3b3564736bfcc7c1a803e8f8c23f594aad75", "message": "Use HandlingUnitDao instead of InterfaceWrapperHelper\n\nhttps://github.com/metasfresh/metasfresh/issues/9971", "committedDate": "2020-09-23T10:52:45Z", "type": "commit"}, {"oid": "6b4875a14e13265fd9839fd0632ede0d5e20adcc", "url": "https://github.com/metasfresh/metasfresh/commit/6b4875a14e13265fd9839fd0632ede0d5e20adcc", "message": "Revert: \"Bugfix: don't set virtual column\"\n\nhttps://github.com/metasfresh/metasfresh/issues/9971", "committedDate": "2020-09-23T10:57:38Z", "type": "commit"}, {"oid": "5fbc2a144265c9e0e0de05458e5da2667286d542", "url": "https://github.com/metasfresh/metasfresh/commit/5fbc2a144265c9e0e0de05458e5da2667286d542", "message": "Merge remote-tracking branch 'origin/master' into gh9971-manufacturing-Issue", "committedDate": "2020-09-23T13:56:22Z", "type": "commit"}]}