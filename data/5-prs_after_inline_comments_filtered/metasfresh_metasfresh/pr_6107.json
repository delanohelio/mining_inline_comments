{"pr_number": 6107, "pr_title": "Gh6106 accounting fixes", "pr_createdAt": "2020-01-30T20:35:33Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/6107", "timeline": [{"oid": "4962042a178cbc06c0f49e1a08d2fc73b435c079", "url": "https://github.com/metasfresh/metasfresh/commit/4962042a178cbc06c0f49e1a08d2fc73b435c079", "message": "Create 5550750_cli_dont_use_currency_balancing.sql\n\nhttps://github.com/metasfresh/metasfresh/issues/6106", "committedDate": "2020-01-30T20:21:48Z", "type": "commit"}, {"oid": "1499089b5cfaaa2b30b56778be595c1933c34b56", "url": "https://github.com/metasfresh/metasfresh/commit/1499089b5cfaaa2b30b56778be595c1933c34b56", "message": "Doc_MatchInv: avoid balancing source currency when not needed\n\nhttps://github.com/metasfresh/metasfresh/issues/6106", "committedDate": "2020-01-30T20:22:56Z", "type": "commit"}, {"oid": "a0ff8498420d805f6d919591c270c04b473d7915", "url": "https://github.com/metasfresh/metasfresh/commit/a0ff8498420d805f6d919591c270c04b473d7915", "message": "Fact.checkAccounts: improve error reporting\n\nhttps://github.com/metasfresh/metasfresh/issues/6106", "committedDate": "2020-01-30T20:26:39Z", "type": "commit"}, {"oid": "991c5ea670aff8822dbeb64d3572fd767a5caf25", "url": "https://github.com/metasfresh/metasfresh/commit/991c5ea670aff8822dbeb64d3572fd767a5caf25", "message": "fix costing issues\n\nhttps://github.com/metasfresh/metasfresh/issues/6106", "committedDate": "2020-01-30T20:28:11Z", "type": "commit"}, {"oid": "ba95d6ccb11cc7bb0f7eabe21c40bef199530638", "url": "https://github.com/metasfresh/metasfresh/commit/ba95d6ccb11cc7bb0f7eabe21c40bef199530638", "message": "document\n\nhttps://github.com/metasfresh/metasfresh/issues/6106", "committedDate": "2020-01-30T20:33:08Z", "type": "commit"}, {"oid": "f404cc0aae8acbe53c21dc7d99009930fdb6ec62", "url": "https://github.com/metasfresh/metasfresh/commit/f404cc0aae8acbe53c21dc7d99009930fdb6ec62", "message": "introduce `async_disable` system property\n\nhttps://github.com/metasfresh/metasfresh/issues/6106", "committedDate": "2020-01-30T20:47:36Z", "type": "commit"}, {"oid": "cbaa599484847d21d5bbd15a095921233017ad67", "url": "https://github.com/metasfresh/metasfresh/commit/cbaa599484847d21d5bbd15a095921233017ad67", "message": "improve error message\n\nhttps://github.com/metasfresh/metasfresh/issues/6106", "committedDate": "2020-01-31T08:30:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQxMTEyNA==", "url": "https://github.com/metasfresh/metasfresh/pull/6107#discussion_r373411124", "bodyText": "wdyt about\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tCurrencyId currencyId = null;\n          \n          \n            \n            \t\tfor (final FactLine line : m_lines)\n          \n          \n            \n            \t\t{\n          \n          \n            \n            \t\t\tif (currencyId == null)\n          \n          \n            \n            \t\t\t{\n          \n          \n            \n            \t\t\t\tcurrencyId = line.getCurrencyId();\n          \n          \n            \n            \t\t\t}\n          \n          \n            \n            \t\t\telse if (!CurrencyId.equals(currencyId, line.getCurrencyId()))\n          \n          \n            \n            \t\t\t{\n          \n          \n            \n            \t\t\t\treturn false;\n          \n          \n            \n            \t\t\t}\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\treturn true;\n          \n          \n            \n            \t\tfinal boolean lessThanTwoCurrecies = CollectionUtils.extractDistinctElements(m_lines, FactLine::getCurrencyId) < 2\n          \n          \n            \n            \t\treturn lessThanTwoCurrecies;", "author": "metas-ts", "createdAt": "2020-01-31T10:27:42Z", "path": "de.metas.acct.base/src/main/java-legacy/org/compiere/acct/Fact.java", "diffHunk": "@@ -260,6 +261,24 @@ public PostingType getPostingType()\n \t\treturn postingType;\n \t}\n \n+\tpublic boolean isSingleCurrency()\n+\t{\n+\t\tCurrencyId currencyId = null;\n+\t\tfor (final FactLine line : m_lines)\n+\t\t{\n+\t\t\tif (currencyId == null)\n+\t\t\t{\n+\t\t\t\tcurrencyId = line.getCurrencyId();\n+\t\t\t}\n+\t\t\telse if (!CurrencyId.equals(currencyId, line.getCurrencyId()))\n+\t\t\t{\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t}\n+\n+\t\treturn true;", "originalCommit": "cbaa599484847d21d5bbd15a095921233017ad67", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQxNDc4MQ==", "url": "https://github.com/metasfresh/metasfresh/pull/6107#discussion_r373414781", "bodyText": "\ud83c\udf89", "author": "metas-ts", "createdAt": "2020-01-31T10:36:21Z", "path": "de.metas.business/src/main/java/de/metas/quantity/QuantityUOMConverter.java", "diffHunk": "@@ -0,0 +1,32 @@\n+package de.metas.quantity;\n+\n+import de.metas.product.ProductId;\n+import de.metas.uom.UomId;\n+\n+/*\n+ * #%L\n+ * de.metas.business\n+ * %%\n+ * Copyright (C) 2020 metas GmbH\n+ * %%\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as\n+ * published by the Free Software Foundation, either version 2 of the\n+ * License, or (at your option) any later version.\n+ * \n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ * \n+ * You should have received a copy of the GNU General Public\n+ * License along with this program. If not, see\n+ * <http://www.gnu.org/licenses/gpl-2.0.html>.\n+ * #L%\n+ */\n+\n+@FunctionalInterface\n+public interface QuantityUOMConverter", "originalCommit": "cbaa599484847d21d5bbd15a095921233017ad67", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "07bcfd12e58ed1926a65b70f00dfb218b0e7add9", "url": "https://github.com/metasfresh/metasfresh/commit/07bcfd12e58ed1926a65b70f00dfb218b0e7add9", "message": "minor improvement\n\nhttps://github.com/metasfresh/metasfresh/issues/6106", "committedDate": "2020-01-31T10:43:34Z", "type": "commit"}]}