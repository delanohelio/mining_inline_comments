{"pr_number": 6333, "pr_title": "#6331 Implement translating greeting", "pr_createdAt": "2020-03-10T16:49:26Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/6333", "timeline": [{"oid": "dd6c82fb27f082fbf595873cad915a4a3139e08e", "url": "https://github.com/metasfresh/metasfresh/commit/dd6c82fb27f082fbf595873cad915a4a3139e08e", "message": "#6331 Move greeting repo and all\n\n#6331 The Greeting of the contact is not translated in address block", "committedDate": "2020-03-10T15:16:41Z", "type": "commit"}, {"oid": "91cfd1da6569cb73eae9feb171af2c97386fefdc", "url": "https://github.com/metasfresh/metasfresh/commit/91cfd1da6569cb73eae9feb171af2c97386fefdc", "message": "#6331 Implement translating greeting\n\n#6331 The Greeting of the contact is not translated in address block", "committedDate": "2020-03-10T15:17:00Z", "type": "commit"}, {"oid": "a409db6d31e8e2dfe4e50f853e4652c4a41eed67", "url": "https://github.com/metasfresh/metasfresh/commit/a409db6d31e8e2dfe4e50f853e4652c4a41eed67", "message": "Merge branch 'master' into gh6331", "committedDate": "2020-03-10T15:17:21Z", "type": "commit"}, {"oid": "0b1a5efcf1fdc287694d5f55438e17ba119deef7", "url": "https://github.com/metasfresh/metasfresh/commit/0b1a5efcf1fdc287694d5f55438e17ba119deef7", "message": "#6331 Add spring ApplicationContext\n\n#6331 The Greeting of the contact is not translated in address block", "committedDate": "2020-03-10T15:26:42Z", "type": "commit"}, {"oid": "0e2d545b6ca299291fce8893e10267f383c089ab", "url": "https://github.com/metasfresh/metasfresh/commit/0e2d545b6ca299291fce8893e10267f383c089ab", "message": "#6331 Refactor and set the language\n\n#6331 The Greeting of the contact is not translated in address block", "committedDate": "2020-03-10T16:10:43Z", "type": "commit"}, {"oid": "a3e98c188263aee01af578f9c0aa189da3c2ce67", "url": "https://github.com/metasfresh/metasfresh/commit/a3e98c188263aee01af578f9c0aa189da3c2ce67", "message": "#6331 Do not set langugae in all tests\n\n#6331 The Greeting of the contact is not translated in address block", "committedDate": "2020-03-10T16:22:09Z", "type": "commit"}, {"oid": "f44b2812a007925d84a5c6c1f16259d5202c1012", "url": "https://github.com/metasfresh/metasfresh/commit/f44b2812a007925d84a5c6c1f16259d5202c1012", "message": "#6331 Use proper tag\n\n#6331 The Greeting of the contact is not translated in address block", "committedDate": "2020-03-10T16:24:37Z", "type": "commit"}, {"oid": "540eb9fdaf5404481e55673bcc1bb6696a44b540", "url": "https://github.com/metasfresh/metasfresh/commit/540eb9fdaf5404481e55673bcc1bb6696a44b540", "message": "#6331 Update display sequence\n\n#6331 The Greeting of the contact is not translated in address block", "committedDate": "2020-03-10T16:48:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ3MjE0Nw==", "url": "https://github.com/metasfresh/metasfresh/pull/6333#discussion_r390472147", "bodyText": "BP's language is not mandatory....", "author": "teosarca", "createdAt": "2020-03-10T17:06:49Z", "path": "de.metas.adempiere.adempiere/base/src/main/java/de/metas/location/impl/AddressBuilder.java", "diffHunk": "@@ -648,15 +655,19 @@ else if (\"CR\".equals(token))\n \t * @param trxName\n \t * @return\n \t */\n-\tprivate String buildUserBlock(final Properties ctx, final boolean isLocal, final I_AD_User user, final String bPartnerBlock, final boolean isPartnerCompany, final String trxName)\n+\tprivate String buildUserBlock(@NonNull final org.compiere.model.I_C_BPartner bPartner,  final boolean isLocal, final I_AD_User user, final String bPartnerBlock, final String trxName)\n \t{\n-\t\tString userGreeting = \"\";\n+\t\tfinal Properties ctx = InterfaceWrapperHelper.getCtx(bPartner);\n+\t\tfinal boolean isPartnerCompany = bPartner.isCompany();\n+\t\tfinal Language language = Language.asLanguage(bPartner.getAD_Language());", "originalCommit": "540eb9fdaf5404481e55673bcc1bb6696a44b540", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ3MzkxMg==", "url": "https://github.com/metasfresh/metasfresh/pull/6333#discussion_r390473912", "bodyText": "Yes! good point!", "author": "cristinamghita", "createdAt": "2020-03-10T17:09:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ3MjE0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ3NTEzMQ==", "url": "https://github.com/metasfresh/metasfresh/pull/6333#discussion_r390475131", "bodyText": "@teosarca actually no; is fine because  de.metas.i18n.Language.asLanguage(String) returns null if language is null; Just remembered that I checked that.", "author": "cristinamghita", "createdAt": "2020-03-10T17:11:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ3MjE0Nw=="}], "type": "inlineReview"}, {"oid": "12b5f28d6858cbebe3030fd596197f361e1d6ee2", "url": "https://github.com/metasfresh/metasfresh/commit/12b5f28d6858cbebe3030fd596197f361e1d6ee2", "message": "#6331 Use app spring context for testing\n\n#6331 The Greeting of the contact is not translated in address block", "committedDate": "2020-03-10T17:14:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUwMjc1NQ==", "url": "https://github.com/metasfresh/metasfresh/pull/6333#discussion_r390502755", "bodyText": "Don't use SpringRunner. Just use org.compiere.SpringContextHolder.registerJUnitBean(T) to register ur bean (in ur case, register the GreetingRepository).\nMore, when touching a junit4 test, pls convert it to junit5.", "author": "teosarca", "createdAt": "2020-03-10T17:53:37Z", "path": "de.metas.adempiere.adempiere/base/src/test/java/de/metas/location/impl/AddressBuilderTest.java", "diffHunk": "@@ -14,14 +14,23 @@\n import org.junit.Before;\n import org.junit.BeforeClass;\n import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.springframework.boot.test.context.SpringBootTest;\n+import org.springframework.test.context.junit4.SpringRunner;\n \n+import de.metas.ShutdownListener;\n+import de.metas.StartupListener;\n import de.metas.adempiere.model.I_AD_User;\n import de.metas.bpartner.service.IBPartnerBL;\n import de.metas.bpartner.service.impl.BPartnerBL;\n+import de.metas.greeting.GreetingRepository;\n import de.metas.interfaces.I_C_BPartner;\n import de.metas.organization.OrgId;\n import de.metas.user.UserRepository;\n+import lombok.Builder;\n \n+@RunWith(SpringRunner.class)\n+@SpringBootTest(classes = { StartupListener.class, ShutdownListener.class, GreetingRepository.class })", "originalCommit": "12b5f28d6858cbebe3030fd596197f361e1d6ee2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDgwNDU1NA==", "url": "https://github.com/metasfresh/metasfresh/pull/6333#discussion_r390804554", "bodyText": "@teosarca then, can we change the message from here?\norg.compiere.SpringContextHolder.throwExceptionIfNull(ApplicationContext)\nIt is not obsolete? I did changes reading that message.", "author": "cristinamghita", "createdAt": "2020-03-11T08:19:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUwMjc1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg0ODM5OA==", "url": "https://github.com/metasfresh/metasfresh/pull/6333#discussion_r390848398", "bodyText": "yes, he have to change the message. it's totally obsolete.", "author": "teosarca", "createdAt": "2020-03-11T09:41:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUwMjc1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUwMzQ2MQ==", "url": "https://github.com/metasfresh/metasfresh/pull/6333#discussion_r390503461", "bodyText": "same, avoid SpringRunner and SpringBootTest.", "author": "teosarca", "createdAt": "2020-03-10T17:54:31Z", "path": "de.metas.business.rest-api-impl/src/test/java/de/metas/rest_api/bpartner/impl/BpartnerRestControllerTest.java", "diffHunk": "@@ -121,6 +126,8 @@\n  * #L%\n  */\n \n+@RunWith(SpringRunner.class)\n+@SpringBootTest(classes = { StartupListener.class, ShutdownListener.class, GreetingRepository.class })", "originalCommit": "12b5f28d6858cbebe3030fd596197f361e1d6ee2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUwNDE3Mw==", "url": "https://github.com/metasfresh/metasfresh/pull/6333#discussion_r390504173", "bodyText": "in this case, it's highly advisable to set builderClassName=\"BPartnerBuilder\".", "author": "teosarca", "createdAt": "2020-03-10T17:55:40Z", "path": "de.metas.adempiere.adempiere/base/src/test/java/de/metas/location/impl/AddressBuilderTest.java", "diffHunk": "@@ -732,13 +793,15 @@ private I_C_BPartner_Location prepareBPLocation(final I_C_Location location)\n \t\treturn bpLoc;\n \t}\n \n-\tprivate I_C_BPartner prepareBPartner(final String name, final String name2, final boolean isCompany)\n+\t@Builder(builderMethodName = \"builderBPartner\")", "originalCommit": "12b5f28d6858cbebe3030fd596197f361e1d6ee2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6b6114784940d336c2fabccb3c6314c2edcf85ee", "url": "https://github.com/metasfresh/metasfresh/commit/6b6114784940d336c2fabccb3c6314c2edcf85ee", "message": "#6331 Use SpringContextHolder.registerJUnitBean\n\n#6331 The Greeting of the contact is not translated in the address block", "committedDate": "2020-03-11T08:00:54Z", "type": "commit"}, {"oid": "aed6cb1eba72a7828b3dd9a7d0e4a1168c7aae09", "url": "https://github.com/metasfresh/metasfresh/commit/aed6cb1eba72a7828b3dd9a7d0e4a1168c7aae09", "message": "#6331 Convert test to Junit 5\n\n#6331 The Greeting of the contact is not translated in the address block", "committedDate": "2020-03-11T10:40:50Z", "type": "commit"}, {"oid": "9d192c47536072f7c2b66ef30249e115a887d602", "url": "https://github.com/metasfresh/metasfresh/commit/9d192c47536072f7c2b66ef30249e115a887d602", "message": "#6331 Adjust text to adivse properly\n\n#6331 The Greeting of the contact is not translated in the address block", "committedDate": "2020-03-11T11:04:21Z", "type": "commit"}, {"oid": "c86266f40ae7eef96c74fa4475b31383051813a3", "url": "https://github.com/metasfresh/metasfresh/commit/c86266f40ae7eef96c74fa4475b31383051813a3", "message": "#6331 Avoid null greeting\n\n#6331 The Greeting of the contact is not translated in address block", "committedDate": "2020-03-11T11:21:08Z", "type": "commit"}]}