{"pr_number": 1688, "pr_title": "Feat(mongodb): add support for named client", "pr_createdAt": "2020-09-04T09:32:18Z", "pr_url": "https://github.com/apache/camel-quarkus/pull/1688", "timeline": [{"oid": "57144c5a8a2caa560c0f37550d833ff2bd1ebe07", "url": "https://github.com/apache/camel-quarkus/commit/57144c5a8a2caa560c0f37550d833ff2bd1ebe07", "message": "fix(mongodb): support for named clients\n\nAdding the possibility to use @MongoClientName to annotate and name a mongo client and use inside the route.\n\nCloses #1608", "committedDate": "2020-09-04T09:01:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUwNzAyMA==", "url": "https://github.com/apache/camel-quarkus/pull/1688#discussion_r483507020", "bodyText": "isn't quarkus already publishing the MongoClients to CDI ?", "author": "lburgazzoli", "createdAt": "2020-09-04T09:38:07Z", "path": "extensions-support/mongodb/deployment/src/main/java/org/apache/camel/quarkus/support/mongodb/deployment/SupportMongoDBProcessor.java", "diffHunk": "@@ -35,20 +35,23 @@ FeatureBuildItem feature() {\n     }\n \n     @BuildStep\n-    void registerCamelMongoClientProducer(\n+    void registerCamelMongoClientProducers(\n             List<MongoClientBuildItem> mongoClients,\n             BuildProducer<CamelRuntimeBeanBuildItem> runtimeBeans) {\n \n         for (MongoClientBuildItem mongoClient : mongoClients) {\n-            // If there is a default mongo client instance, then bind it to the camel registry\n-            // with the default mongo client name used by the camel-mongodb component\n-            if (MongoClientBeanUtil.isDefault(mongoClient.getName())) {\n-                runtimeBeans.produce(\n-                        new CamelRuntimeBeanBuildItem(\n-                                \"camelMongoClient\",\n-                                \"com.mongodb.client.MongoClient\",\n-                                mongoClient.getClient()));\n-            }\n+            String clientName = getMongoClientName(mongoClient.getName());", "originalCommit": "8d249404af28bfae228bd9a8c3159ce90dbcbcd5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f7f30422dd65ab222d61c6a2ae8a8d4349ecf4cc", "url": "https://github.com/apache/camel-quarkus/commit/f7f30422dd65ab222d61c6a2ae8a8d4349ecf4cc", "message": "doc(mongodb): adding named connection\n\nAdding documentation to explain how to configure a named MongoDB client connection\n\nRef #1608", "committedDate": "2020-09-10T13:43:24Z", "type": "commit"}, {"oid": "f7f30422dd65ab222d61c6a2ae8a8d4349ecf4cc", "url": "https://github.com/apache/camel-quarkus/commit/f7f30422dd65ab222d61c6a2ae8a8d4349ecf4cc", "message": "doc(mongodb): adding named connection\n\nAdding documentation to explain how to configure a named MongoDB client connection\n\nRef #1608", "committedDate": "2020-09-10T13:43:24Z", "type": "forcePushed"}, {"oid": "b2d98e901cfdae17f388794f399ee81a46b42722", "url": "https://github.com/apache/camel-quarkus/commit/b2d98e901cfdae17f388794f399ee81a46b42722", "message": "feat(mongodb): add test for named client connection\n\n* Included parameterized test to test with either a named or a default MongoDB client connection\n\nRef #1608", "committedDate": "2020-09-22T09:24:00Z", "type": "commit"}]}