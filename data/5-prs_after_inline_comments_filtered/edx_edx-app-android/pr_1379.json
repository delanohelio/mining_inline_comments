{"pr_number": 1379, "pr_title": "Resolve IllegalStateException crash initiated by YouTube Player", "pr_createdAt": "2020-03-03T12:07:39Z", "pr_url": "https://github.com/edx/edx-app-android/pull/1379", "timeline": [{"oid": "a0aa29776689d9dfed4dee5c6e229dfca6116842", "url": "https://github.com/edx/edx-app-android/commit/a0aa29776689d9dfed4dee5c6e229dfca6116842", "message": "Handle IllegalStateException crash reproduce by YouTube Player Fragment\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app.", "committedDate": "2020-03-03T12:09:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3NTQ5Mw==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388875493", "bodyText": "Apply try catch to this line only", "author": "farhan", "createdAt": "2020-03-06T12:28:18Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitYoutubePlayerFragment.java", "diffHunk": "@@ -114,8 +114,18 @@ protected long getPlayerCurrentPosition() {\n \n     @Override\n     protected void setFullScreen(boolean fullscreen) {\n-        if (youTubePlayer != null) {\n-            youTubePlayer.setFullscreen(fullscreen);\n+        /* Some times `YouTubePlayerSupportFragment` throws the `IllegalStateException` when user moves\n+         * back after forcefully kill the YouTube app so catch the exception and reinitialize the\n+         * YouTube Player to play the YouTube based video content\n+         */\n+        try {\n+            if (youTubePlayer != null) {\n+                youTubePlayer.setFullscreen(fullscreen);", "originalCommit": "a0aa29776689d9dfed4dee5c6e229dfca6116842", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwNTQ1Mg==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388905452", "bodyText": "Done.", "author": "farhan-arshad-dev", "createdAt": "2020-03-06T13:36:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3NTQ5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg5OTYzNg==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388899636", "bodyText": "/*\n         * If the youtube player is not in a proper state than it throws the  IllegalStateException.\n         * To avoid the crash and continue the flow we are reinitializing the player here.\n         * \n         * It may occur when the edX app was in background and user kills the device youtube app\n         */\n\n\nIt seems better comment.", "author": "farhan", "createdAt": "2020-03-06T13:24:13Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitYoutubePlayerFragment.java", "diffHunk": "@@ -114,8 +114,18 @@ protected long getPlayerCurrentPosition() {\n \n     @Override\n     protected void setFullScreen(boolean fullscreen) {\n-        if (youTubePlayer != null) {\n-            youTubePlayer.setFullscreen(fullscreen);\n+        /* Some times `YouTubePlayerSupportFragment` throws the `IllegalStateException` when user moves", "originalCommit": "a0aa29776689d9dfed4dee5c6e229dfca6116842", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwNTUzMQ==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388905531", "bodyText": "updated.", "author": "farhan-arshad-dev", "createdAt": "2020-03-06T13:36:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg5OTYzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwMjU1MA==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388902550", "bodyText": "Same comment", "author": "farhan", "createdAt": "2020-03-06T13:30:22Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -109,6 +109,18 @@ public void onPageScrollStateChanged(int state) {\n         mNextBtn.setOnClickListener(view -> navigateNextComponent());\n     }\n \n+    @Override\n+    public void onSaveInstanceState(Bundle outState) {\n+        /* Some times `YouTubePlayerSupportFragment` throws the `IllegalStateException` when user moves", "originalCommit": "a0aa29776689d9dfed4dee5c6e229dfca6116842", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwNTU3Mg==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388905572", "bodyText": "updated.", "author": "farhan-arshad-dev", "createdAt": "2020-03-06T13:36:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwMjU1MA=="}], "type": "inlineReview"}, {"oid": "2c8bd4d985ee51311329d84c84fce5a3850b800f", "url": "https://github.com/edx/edx-app-android/commit/2c8bd4d985ee51311329d84c84fce5a3850b800f", "message": "Handle IllegalStateException crash reproduce by YouTube Player Fragment\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app.", "committedDate": "2020-03-06T13:35:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwODcyNQ==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388908725", "bodyText": "2 nits:\n\nthen instead of than.\nremove extra space before IllegalStateException.", "author": "miankhalid", "createdAt": "2020-03-06T13:43:13Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -109,6 +109,21 @@ public void onPageScrollStateChanged(int state) {\n         mNextBtn.setOnClickListener(view -> navigateNextComponent());\n     }\n \n+    @Override\n+    public void onSaveInstanceState(Bundle outState) {\n+        /*\n+         * If the youtube player is not in a proper state than it throws the  IllegalStateException.", "originalCommit": "2c8bd4d985ee51311329d84c84fce5a3850b800f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkyNTQzNA==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388925434", "bodyText": "done.", "author": "farhan-arshad-dev", "createdAt": "2020-03-06T14:15:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwODcyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwODkyMQ==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388908921", "bodyText": "the on-device YouTube app.", "author": "miankhalid", "createdAt": "2020-03-06T13:43:35Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -109,6 +109,21 @@ public void onPageScrollStateChanged(int state) {\n         mNextBtn.setOnClickListener(view -> navigateNextComponent());\n     }\n \n+    @Override\n+    public void onSaveInstanceState(Bundle outState) {\n+        /*\n+         * If the youtube player is not in a proper state than it throws the  IllegalStateException.\n+         * To avoid the crash and continue the flow we are catching the exception.\n+         *\n+         * It may occur when the edX app was in background and user kills the device youtube app", "originalCommit": "2c8bd4d985ee51311329d84c84fce5a3850b800f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkyNTUwMw==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388925503", "bodyText": "updated.", "author": "farhan-arshad-dev", "createdAt": "2020-03-06T14:15:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwODkyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwOTAzNg==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388909036", "bodyText": "2 nits:\n\nthen instead of than.\nremove extra space before IllegalStateException.", "author": "miankhalid", "createdAt": "2020-03-06T13:43:49Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitYoutubePlayerFragment.java", "diffHunk": "@@ -114,8 +114,20 @@ protected long getPlayerCurrentPosition() {\n \n     @Override\n     protected void setFullScreen(boolean fullscreen) {\n+        /*\n+         * If the youtube player is not in a proper state than it throws the  IllegalStateException.", "originalCommit": "2c8bd4d985ee51311329d84c84fce5a3850b800f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkyNTU0NQ==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388925545", "bodyText": "updated.", "author": "farhan-arshad-dev", "createdAt": "2020-03-06T14:15:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwOTAzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwOTEyMw==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388909123", "bodyText": "the on-device YouTube app.", "author": "miankhalid", "createdAt": "2020-03-06T13:43:59Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitYoutubePlayerFragment.java", "diffHunk": "@@ -114,8 +114,20 @@ protected long getPlayerCurrentPosition() {\n \n     @Override\n     protected void setFullScreen(boolean fullscreen) {\n+        /*\n+         * If the youtube player is not in a proper state than it throws the  IllegalStateException.\n+         * To avoid the crash and continue the flow we are reinitializing the player here.\n+         *\n+         * It may occur when the edX app was in background and user kills the device youtube app", "originalCommit": "2c8bd4d985ee51311329d84c84fce5a3850b800f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkyNTU5NQ==", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388925595", "bodyText": "updated.", "author": "farhan-arshad-dev", "createdAt": "2020-03-06T14:15:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwOTEyMw=="}], "type": "inlineReview"}, {"oid": "7339376f075c670bacd12268f4e7dd38ea38c383", "url": "https://github.com/edx/edx-app-android/commit/7339376f075c670bacd12268f4e7dd38ea38c383", "message": "Resolve IllegalStateException crash initiated by YouTube Player\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app.", "committedDate": "2020-03-06T14:14:15Z", "type": "commit"}, {"oid": "7339376f075c670bacd12268f4e7dd38ea38c383", "url": "https://github.com/edx/edx-app-android/commit/7339376f075c670bacd12268f4e7dd38ea38c383", "message": "Resolve IllegalStateException crash initiated by YouTube Player\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app.", "committedDate": "2020-03-06T14:14:15Z", "type": "forcePushed"}]}