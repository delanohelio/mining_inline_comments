{"pr_number": 1434, "pr_title": "Migrate from ViewPager to ViewPager2", "pr_createdAt": "2020-07-07T10:31:31Z", "pr_url": "https://github.com/edx/edx-app-android/pull/1434", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3MzU3OA==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451573578", "bodyText": "Can u please auto-align only the changed code?", "author": "omerhabib26", "createdAt": "2020-07-08T14:08:21Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/profiles/UserProfileFragment.java", "diffHunk": "@@ -18,8 +10,17 @@\n import android.view.View;\n import android.view.ViewGroup;\n \n+import androidx.annotation.NonNull;", "originalCommit": "dc2ed547e4161b03eb747d433a9dc97493a51ba6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk4MjU2NQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451982565", "bodyText": "Done.", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T06:03:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3MzU3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3NDAyNA==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451574024", "bodyText": "Auto-Align issue", "author": "omerhabib26", "createdAt": "2020-07-08T14:08:58Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -15,6 +12,9 @@\n import android.widget.RelativeLayout;\n import android.widget.TextView;\n \n+import androidx.annotation.NonNull;", "originalCommit": "dc2ed547e4161b03eb747d433a9dc97493a51ba6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk5MTI2Ng==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451991266", "bodyText": "Done.", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T06:28:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3NDAyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3ODU2Ng==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451578566", "bodyText": "auto-align issue", "author": "omerhabib26", "createdAt": "2020-07-08T14:14:50Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MainTabsDashboardFragment.java", "diffHunk": "@@ -2,16 +2,15 @@\n \n import android.content.Context;\n import android.os.Bundle;\n-\n-import androidx.annotation.NonNull;\n-import androidx.annotation.Nullable;\n-\n import android.view.Menu;\n import android.view.MenuInflater;\n import android.view.MenuItem;\n import android.view.View;\n import android.widget.ImageView;\n \n+import androidx.annotation.NonNull;", "originalCommit": "dc2ed547e4161b03eb747d433a9dc97493a51ba6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk5MTI0Mg==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451991242", "bodyText": "Done.", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T06:28:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3ODU2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3OTQyMw==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451579423", "bodyText": "Can u please add some doc related to it? why we are calling super method?", "author": "omerhabib26", "createdAt": "2020-07-08T14:15:53Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/LoginActivity.java", "diffHunk": "@@ -62,6 +62,7 @@ public static Intent newIntent(@Nullable DeepLink deepLink) {\n \n     @Override\n     protected void onNewIntent(Intent intent) {\n+        super.onNewIntent(intent);", "originalCommit": "dc2ed547e4161b03eb747d433a9dc97493a51ba6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk5MTE3NQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451991175", "bodyText": "Now it's required by the FragmentActivity\nRef: https://developer.android.com/reference/kotlin/androidx/fragment/app/FragmentActivity?authuser=1#onnewintent", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T06:28:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3OTQyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU4MjQwMQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451582401", "bodyText": "why we are setting smoothScrolling=false here?", "author": "omerhabib26", "createdAt": "2020-07-08T14:19:45Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -240,7 +226,7 @@ private void updateDataModel() {\n \n         int index = unitList.indexOf(selectedUnit);\n         if (index >= 0) {\n-            pager.setCurrentItem(index);\n+            pager2.setCurrentItem(index, false);", "originalCommit": "dc2ed547e4161b03eb747d433a9dc97493a51ba6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjAwOTc4OA==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452009788", "bodyText": "if the user clicks on the middle one xBlock, then the system shows the moving transition, to remove this glitch we need to disable smoothScrolling.\n\n\n\nWith Smooth Scrolling\nWithout Smooth Scrolling", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T07:12:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU4MjQwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMyMzExOQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452323119", "bodyText": "ok", "author": "omerhabib26", "createdAt": "2020-07-09T15:57:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU4MjQwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU4NTE3MQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451585171", "bodyText": "IMO, by default, setCurrentItem take smoothScrolling as true so we can skip passing true.", "author": "omerhabib26", "createdAt": "2020-07-08T14:23:24Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MainTabsDashboardFragment.java", "diffHunk": "@@ -168,7 +167,7 @@ public void onEventMainThread(@NonNull MoveToDiscoveryTabEvent event) {\n             return;\n         }\n         if (binding != null) {\n-            binding.viewPager.setCurrentItem(binding.viewPager.getAdapter().getCount() - 1, true);\n+            binding.viewPager2.setCurrentItem(binding.viewPager2.getAdapter().getItemCount() - 1, true);", "originalCommit": "dc2ed547e4161b03eb747d433a9dc97493a51ba6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjAxMjMzMg==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452012332", "bodyText": "Done.", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T07:17:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU4NTE3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU4NTQ0NQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451585445", "bodyText": "auto-align issue", "author": "omerhabib26", "createdAt": "2020-07-08T14:23:46Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/TabsBaseFragment.java", "diffHunk": "@@ -1,19 +1,22 @@\n package org.edx.mobile.view;\n \n import android.content.Intent;\n-import androidx.databinding.DataBindingUtil;\n import android.os.Bundle;\n-import androidx.annotation.ColorRes;\n-import androidx.annotation.NonNull;\n-import androidx.annotation.Nullable;\n-import com.google.android.material.tabs.TabLayout;\n-import androidx.core.content.ContextCompat;\n import android.view.LayoutInflater;\n import android.view.View;\n import android.view.ViewGroup;\n import android.widget.ImageView;\n import android.widget.TextView;\n \n+import androidx.annotation.ColorRes;", "originalCommit": "dc2ed547e4161b03eb747d433a9dc97493a51ba6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjAxMzIzOA==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452013238", "bodyText": "done.", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T07:19:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU4NTQ0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQ5Njc0NQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r453496745", "bodyText": "auto-align issue again occurred", "author": "omerhabib26", "createdAt": "2020-07-13T08:55:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU4NTQ0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU5NzA0Mw==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451597043", "bodyText": "auto-align issue", "author": "omerhabib26", "createdAt": "2020-07-08T14:39:09Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/whatsnew/WhatsNewFragment.java", "diffHunk": "@@ -1,18 +1,18 @@\n package org.edx.mobile.whatsnew;\n \n-import androidx.databinding.DataBindingUtil;\n import android.os.Bundle;\n-import androidx.annotation.NonNull;\n-import androidx.annotation.Nullable;\n-import androidx.fragment.app.Fragment;\n-import androidx.fragment.app.FragmentManager;\n-import androidx.fragment.app.FragmentStatePagerAdapter;\n-import androidx.viewpager.widget.ViewPager;\n-\n import android.view.LayoutInflater;\n import android.view.View;\n import android.view.ViewGroup;\n \n+import androidx.annotation.NonNull;", "originalCommit": "dc2ed547e4161b03eb747d433a9dc97493a51ba6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTYzMzY2Nw==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r451633667", "bodyText": "this is mentioned as ignored, do we still need to update this one?\nalso, only tests are passing in this class", "author": "omerhabib26", "createdAt": "2020-07-08T15:29:02Z", "path": "OpenEdXMobile/src/test/java/org/edx/mobile/view/CourseUnitNavigationActivityTest.java", "diffHunk": "@@ -446,7 +443,10 @@ public void testUnitFragmentCreation() {\n         unitList.add(othersModel);\n         classesList.add(CourseUnitMobileNotSupportedFragment.class);\n \n-        CourseUnitPagerAdapter adapter = new CourseUnitPagerAdapter(fragmentManager, config,\n+        ActivityController<? extends CourseUnitNavigationActivity> controller =", "originalCommit": "dc2ed547e4161b03eb747d433a9dc97493a51ba6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE3MzI5OQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452173299", "bodyText": "we have o change the code cuz, the definition of the method/construct has been changed.", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T12:16:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTYzMzY2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM1MDQ2NQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452350465", "bodyText": "Please remove the unused parameter as well", "author": "omerhabib26", "createdAt": "2020-07-09T16:41:41Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -67,29 +66,16 @@ protected void onCreate(Bundle savedInstanceState) {\n         insertPoint.addView(v, 0,\n                 new ViewGroup.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT));\n \n-        pager = findViewById(R.id.pager);\n-        pagerAdapter = new CourseUnitPagerAdapter(getSupportFragmentManager(),\n-                environment.getConfig(), unitList, courseData, courseUpgradeData, this);\n-        pager.setAdapter(pagerAdapter);\n-        pager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {\n+        pager2 = findViewById(R.id.pager2);\n+        pagerAdapter = new CourseUnitPagerAdapter(this, environment.getConfig(),\n+                unitList, courseData, courseUpgradeData, this);\n+        pager2.setAdapter(pagerAdapter);\n+        pager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\n \n             private boolean firstPageLoad = true;", "originalCommit": "9609f4a7eee93405d055527266ad67987a871a89", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM1MDY3NQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452350675", "bodyText": "Please remove the unused code", "author": "omerhabib26", "createdAt": "2020-07-09T16:41:58Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -67,29 +66,16 @@ protected void onCreate(Bundle savedInstanceState) {\n         insertPoint.addView(v, 0,\n                 new ViewGroup.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT));\n \n-        pager = findViewById(R.id.pager);\n-        pagerAdapter = new CourseUnitPagerAdapter(getSupportFragmentManager(),\n-                environment.getConfig(), unitList, courseData, courseUpgradeData, this);\n-        pager.setAdapter(pagerAdapter);\n-        pager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {\n+        pager2 = findViewById(R.id.pager2);\n+        pagerAdapter = new CourseUnitPagerAdapter(this, environment.getConfig(),\n+                unitList, courseData, courseUpgradeData, this);\n+        pager2.setAdapter(pagerAdapter);\n+        pager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\n \n             private boolean firstPageLoad = true;", "originalCommit": "9609f4a7eee93405d055527266ad67987a871a89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ5ODA1MQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452498051", "bodyText": "Done.", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T21:23:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM1MDY3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM1MzUyMA==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452353520", "bodyText": "Can we use NonNull annotation instead of NotNull?", "author": "omerhabib26", "createdAt": "2020-07-09T16:46:49Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/whatsnew/WhatsNewFragment.java", "diffHunk": "@@ -28,6 +28,7 @@\n import org.edx.mobile.util.ResourceUtil;\n import org.edx.mobile.util.WhatsNewUtil;\n import org.edx.mobile.view.custom.IndicatorController;\n+import org.jetbrains.annotations.NotNull;", "originalCommit": "9609f4a7eee93405d055527266ad67987a871a89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ5ODQwOA==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452498408", "bodyText": "Done.", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T21:23:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM1MzUyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3MDk4OQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452370989", "bodyText": "IMO it doesn't seem to work properly on webview", "author": "omerhabib26", "createdAt": "2020-07-09T17:16:49Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/BaseWebViewFragment.java", "diffHunk": "@@ -82,6 +84,10 @@ public void onDestroy() {\n     }\n \n     private void initWebView() {\n+        // To make the smooth scrolling of view within viewpager2\n+        // Inspiration: https://stackoverflow.com/a/35198484\n+        ViewCompat.setNestedScrollingEnabled(webView, true);", "originalCommit": "9609f4a7eee93405d055527266ad67987a871a89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ5ODYzMg==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452498632", "bodyText": "Removed,  isn't effecting the behavior", "author": "farhan-arshad-dev", "createdAt": "2020-07-09T21:24:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3MDk4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY2NzcyNA==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452667724", "bodyText": "basically I meant to say this line isn't effecting the behavior", "author": "omerhabib26", "createdAt": "2020-07-10T07:20:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM3MDk4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc2NTE0NQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452765145", "bodyText": "remove unused import", "author": "omerhabib26", "createdAt": "2020-07-10T10:36:49Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/BaseWebViewFragment.java", "diffHunk": "@@ -4,6 +4,8 @@\n import android.os.Build;\n import android.os.Bundle;\n import androidx.annotation.NonNull;\n+import androidx.core.view.ViewCompat;", "originalCommit": "ea3ee8db57237ab3aea11f9d1179c837d8a19bb1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc4NTY3NQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452785675", "bodyText": "Done.", "author": "farhan-arshad-dev", "createdAt": "2020-07-10T11:26:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc2NTE0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc2ODIxMA==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452768210", "bodyText": "Remove unused imports", "author": "omerhabib26", "createdAt": "2020-07-10T10:43:58Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/adapters/StaticFragmentPagerAdapter.java", "diffHunk": "@@ -2,11 +2,13 @@\n \n import androidx.annotation.NonNull;\n import androidx.fragment.app.Fragment;\n+import androidx.fragment.app.FragmentActivity;\n import androidx.fragment.app.FragmentManager;\n import androidx.fragment.app.FragmentPagerAdapter;", "originalCommit": "ea3ee8db57237ab3aea11f9d1179c837d8a19bb1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc4NTg4Ng==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452785886", "bodyText": "Done.", "author": "farhan-arshad-dev", "createdAt": "2020-07-10T11:26:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc2ODIxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc2ODM0Nw==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452768347", "bodyText": "Can we use NonNull instead of NotNull?", "author": "omerhabib26", "createdAt": "2020-07-10T10:44:19Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/adapters/StaticFragmentPagerAdapter.java", "diffHunk": "@@ -2,11 +2,13 @@\n \n import androidx.annotation.NonNull;\n import androidx.fragment.app.Fragment;\n+import androidx.fragment.app.FragmentActivity;\n import androidx.fragment.app.FragmentManager;\n import androidx.fragment.app.FragmentPagerAdapter;\n-import android.view.ViewGroup;\n+import androidx.viewpager2.adapter.FragmentStateAdapter;\n \n import org.edx.mobile.model.FragmentItemModel;\n+import org.jetbrains.annotations.NotNull;", "originalCommit": "ea3ee8db57237ab3aea11f9d1179c837d8a19bb1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc4NjA2Mg==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452786062", "bodyText": "Updated.", "author": "farhan-arshad-dev", "createdAt": "2020-07-10T11:27:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc2ODM0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc2OTc4Nw==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452769787", "bodyText": "Can we use NonNull instead of NotNull ?", "author": "omerhabib26", "createdAt": "2020-07-10T10:47:42Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/adapters/FragmentItemPagerAdapter.java", "diffHunk": "@@ -2,30 +2,33 @@\n \n import androidx.annotation.NonNull;\n import androidx.fragment.app.Fragment;\n-import androidx.fragment.app.FragmentManager;\n-import androidx.fragment.app.FragmentStatePagerAdapter;\n+import androidx.fragment.app.FragmentActivity;\n+import androidx.viewpager2.adapter.FragmentStateAdapter;\n \n import org.edx.mobile.model.FragmentItemModel;\n+import org.jetbrains.annotations.NotNull;", "originalCommit": "ea3ee8db57237ab3aea11f9d1179c837d8a19bb1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc4NjMwNA==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452786304", "bodyText": "Updated.", "author": "farhan-arshad-dev", "createdAt": "2020-07-10T11:27:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc2OTc4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc3NDMxMQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452774311", "bodyText": "Can we add @nonnull annotation her", "author": "omerhabib26", "createdAt": "2020-07-10T10:58:26Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/TabsBaseFragment.java", "diffHunk": "@@ -166,34 +166,38 @@ public void onPageSelected(int position) {\n         };\n \n         // Init view pager\n-        final FragmentItemPagerAdapter adapter = new FragmentItemPagerAdapter(this.getActivity().getSupportFragmentManager(), fragmentItems);\n-        binding.viewPager.setAdapter(adapter);\n-        binding.viewPager.addOnPageChangeListener(pageChangeListener);\n+        final FragmentItemPagerAdapter adapter = new FragmentItemPagerAdapter(this.getActivity(), fragmentItems);\n+        binding.viewPager2.setAdapter(adapter);\n+        binding.viewPager2.registerOnPageChangeCallback(pageChangeListener);\n+\n+        // Attach Tab layout with viewpager2\n+        new TabLayoutMediator(tabLayout, binding.viewPager2, (tab, position) -> {\n+            createTab(tab, fragmentItems.get(position));\n+        }).attach();\n         /*\n          It will load all of the fragments on creation and will stay in memory till ViewPager's\n          life time, it will greatly improve our user experience as all fragments will be available\n          to view all the time. We can decrease the limit if it creates memory problems on low-end devices.\n          */\n-        binding.viewPager.setOffscreenPageLimit(fragmentItems.size() - 1);\n-\n+        if (fragmentItems.size() - 1 > 1) {\n+            binding.viewPager2.setOffscreenPageLimit(fragmentItems.size() - 1);\n+        }\n         /*\n          ViewPager doesn't call the onPageSelected for its first item, so we have to explicitly\n          call it ourselves.\n          Inspiration for this solution: https://stackoverflow.com/a/16074152/1402616\n          */\n-        binding.viewPager.post(new Runnable() {\n+        binding.viewPager2.post(new Runnable() {\n             @Override\n             public void run() {\n-                pageChangeListener.onPageSelected(binding.viewPager.getCurrentItem());\n+                pageChangeListener.onPageSelected(binding.viewPager2.getCurrentItem());\n             }\n         });\n     }\n \n-    protected TabLayout.Tab createTab(TabLayout tabLayout, FragmentItemModel fragmentItem) {\n+    protected void createTab(TabLayout.Tab tab, FragmentItemModel fragmentItem) {", "originalCommit": "ea3ee8db57237ab3aea11f9d1179c837d8a19bb1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc4NjUyNg==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r452786526", "bodyText": "Added", "author": "farhan-arshad-dev", "createdAt": "2020-07-10T11:28:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc3NDMxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQ5NTE2Mg==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r453495162", "bodyText": "Auto-Align Issue", "author": "omerhabib26", "createdAt": "2020-07-13T08:52:53Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/UiUtil.java", "diffHunk": "@@ -5,21 +5,24 @@\n import android.content.res.Resources;\n import android.graphics.drawable.Drawable;\n import android.os.Build;\n+import android.util.TypedValue;\n+import android.view.View;\n+import android.view.ViewGroup;\n+import android.widget.TextView;\n+", "originalCommit": "54f10a0b10b406331c204180cb4856130d388f8d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUxMDQ5MQ==", "url": "https://github.com/edx/edx-app-android/pull/1434#discussion_r453510491", "bodyText": "Resolved", "author": "farhan-arshad-dev", "createdAt": "2020-07-13T09:17:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQ5NTE2Mg=="}], "type": "inlineReview"}, {"oid": "4845623ff3224cb4b7eada5396db2d98119fe555", "url": "https://github.com/edx/edx-app-android/commit/4845623ff3224cb4b7eada5396db2d98119fe555", "message": "Migrate to viewpager2\n\n- LEARNER-7777\n- Fix issues and crashes after migration\n- Fix UI glitch\n\nRef: https://developer.android.com/training/animation/vp2-migration", "committedDate": "2020-07-13T09:37:11Z", "type": "commit"}, {"oid": "e036aed336316fa0d4335a6a32f4e177498a7cc3", "url": "https://github.com/edx/edx-app-android/commit/e036aed336316fa0d4335a6a32f4e177498a7cc3", "message": "Fix scrolling issue and RTL support in viewpager2\n\n- LEARNER-7777\n- Addes RTL support.\n- Enforce a ViewPager2 to intercept the only single direction scrolling.\nRef: https://medium.com/@BladeCoder/fixing-recyclerview-nested-scrolling-in-opposite-direction-f587be5c1a04", "committedDate": "2020-07-13T09:40:09Z", "type": "commit"}, {"oid": "e036aed336316fa0d4335a6a32f4e177498a7cc3", "url": "https://github.com/edx/edx-app-android/commit/e036aed336316fa0d4335a6a32f4e177498a7cc3", "message": "Fix scrolling issue and RTL support in viewpager2\n\n- LEARNER-7777\n- Addes RTL support.\n- Enforce a ViewPager2 to intercept the only single direction scrolling.\nRef: https://medium.com/@BladeCoder/fixing-recyclerview-nested-scrolling-in-opposite-direction-f587be5c1a04", "committedDate": "2020-07-13T09:40:09Z", "type": "forcePushed"}]}