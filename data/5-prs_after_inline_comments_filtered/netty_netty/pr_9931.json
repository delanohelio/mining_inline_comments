{"pr_number": 9931, "pr_title": "FlushConsolidationHandler may suppress flushes by mistake", "pr_createdAt": "2020-01-09T07:37:18Z", "pr_url": "https://github.com/netty/netty/pull/9931", "timeline": [{"oid": "fa8e0b1477d92b06af21fc09ff21e3463249a16b", "url": "https://github.com/netty/netty/commit/fa8e0b1477d92b06af21fc09ff21e3463249a16b", "message": "Fix resend problem.", "committedDate": "2020-01-09T07:28:45Z", "type": "commit"}, {"oid": "206efdfbbf9649df3341948b3a0a35d87bb3aeb6", "url": "https://github.com/netty/netty/commit/206efdfbbf9649df3341948b3a0a35d87bb3aeb6", "message": "Add unit test for resend problem.", "committedDate": "2020-01-09T08:10:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDYwNDc2NA==", "url": "https://github.com/netty/netty/pull/9931#discussion_r364604764", "bodyText": "nit: assertFalse(channel.finish);", "author": "normanmaurer", "createdAt": "2020-01-09T08:16:38Z", "path": "handler/src/test/java/io/netty/handler/flush/FlushConsolidationHandlerTest.java", "diffHunk": "@@ -152,6 +154,31 @@ public void testFlushViaRemoval() {\n         assertFalse(channel.finish());\n     }\n \n+    /**\n+     * See https://github.com/netty/netty/issues/9923\n+     */\n+    @Test\n+    public void testResend() throws Exception {\n+\n+        final AtomicInteger flushCount = new AtomicInteger();\n+        final EmbeddedChannel channel = newChannel(flushCount, true);\n+\n+        channel.writeAndFlush(1L).addListener(new GenericFutureListener<Future<? super Void>>() {\n+            @Override\n+            public void operationComplete(Future<? super Void> future) throws Exception {\n+                channel.writeAndFlush(1L);\n+            }\n+        });\n+\n+        channel.flushOutbound();\n+\n+        assertEquals(1L, channel.readOutbound());\n+        assertEquals(1L, channel.readOutbound());\n+        assertNull(channel.readOutbound());\n+\n+        channel.finish();", "originalCommit": "206efdfbbf9649df3341948b3a0a35d87bb3aeb6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDYwNDg0Nw==", "url": "https://github.com/netty/netty/pull/9931#discussion_r364604847", "bodyText": "nit: remove empty line", "author": "normanmaurer", "createdAt": "2020-01-09T08:16:52Z", "path": "handler/src/test/java/io/netty/handler/flush/FlushConsolidationHandlerTest.java", "diffHunk": "@@ -152,6 +154,31 @@ public void testFlushViaRemoval() {\n         assertFalse(channel.finish());\n     }\n \n+    /**\n+     * See https://github.com/netty/netty/issues/9923\n+     */\n+    @Test\n+    public void testResend() throws Exception {\n+", "originalCommit": "206efdfbbf9649df3341948b3a0a35d87bb3aeb6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "800140a909d6b1e6d0adcfda2395e110a8c8de01", "url": "https://github.com/netty/netty/commit/800140a909d6b1e6d0adcfda2395e110a8c8de01", "message": "polish unit test.", "committedDate": "2020-01-09T08:20:14Z", "type": "commit"}, {"oid": "b2441a087129ed73985b52dde6023432eb176ea4", "url": "https://github.com/netty/netty/commit/b2441a087129ed73985b52dde6023432eb176ea4", "message": "fix checkstyle", "committedDate": "2020-01-09T12:35:26Z", "type": "commit"}]}