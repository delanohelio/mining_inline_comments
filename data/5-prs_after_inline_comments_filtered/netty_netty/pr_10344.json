{"pr_number": 10344, "pr_title": "Consolidate HttpObjectDecoder default values into constants", "pr_createdAt": "2020-06-09T20:00:33Z", "pr_url": "https://github.com/netty/netty/pull/10344", "timeline": [{"oid": "d7b5bba4f8d2fb5a7b1b39feb6e5595dd28b1c20", "url": "https://github.com/netty/netty/commit/d7b5bba4f8d2fb5a7b1b39feb6e5595dd28b1c20", "message": "Consolidate HttpObjectDecoder default values into constants\n\nMotivation\n\nHttpObjectDecoder and its associated classes make frequent use of\ndefault values for maxInitialLineLength, maxHeaderSize, maxChunkSize,\netc. Today, these defaults are defined in-line in constructors and\nduplicated across many classes. This repetition is more prone to error\nand inconsistencies.\n\nFurthermore, due to the current lack of builder support, if a user wants\nto change just one of these values (e.g., maxHeaderSize), they are also\nrequired to know and repeat the other default values (e.g.,\nmaxInitialLineLength and maxChunkSize).\n\nThe primary motivation for this change is as we are considering adding\nanother constructor parameter (for multiple content length behavior),\nappending this parameter may require some users to have prior knowledge\nof the default initialBufferSize, and it would be cleaner to allow them\nto reference the default constant.\n\nModifications\n\n* Consolidate the HttpObjectDecoder default values into public constants\n* Reference these constants where possible\n\nResult\n\nNo functional change. Additional telescoping constructors will be easier\nand safer to write. Users may have an easier experience changing single\nparameters.", "committedDate": "2020-06-09T19:57:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc2NTQ5Ng==", "url": "https://github.com/netty/netty/pull/10344#discussion_r437765496", "bodyText": "Avoid removing public constants as it breaks the API.", "author": "NiteshKant", "createdAt": "2020-06-09T22:52:39Z", "path": "codec-http/src/main/java/io/netty/handler/codec/rtsp/RtspDecoder.java", "diffHunk": "@@ -71,16 +71,6 @@\n      */\n     private static final Pattern versionPattern = Pattern.compile(\"RTSP/\\\\d\\\\.\\\\d\");\n \n-    /**\n-     * Constant for default max initial line length.\n-     */\n-    public static final int DEFAULT_MAX_INITIAL_LINE_LENGTH = 4096;", "originalCommit": "d7b5bba4f8d2fb5a7b1b39feb6e5595dd28b1c20", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc3NDI1MA==", "url": "https://github.com/netty/netty/pull/10344#discussion_r437774250", "bodyText": "RtspDecoder extends HttpObjectDecoder so RtspDecoder.DEFAULT_MAX_INITIAL_LINE_LENGTH is still valid syntax and should not break the API (although your IDE may suggest that you should reference the parent class).", "author": "Bennett-Lynch", "createdAt": "2020-06-09T23:18:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc2NTQ5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkwMDY3NA==", "url": "https://github.com/netty/netty/pull/10344#discussion_r437900674", "bodyText": "yep this should be fine...", "author": "normanmaurer", "createdAt": "2020-06-10T07:00:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc2NTQ5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc3MDgwOA==", "url": "https://github.com/netty/netty/pull/10344#discussion_r437770808", "bodyText": "keep these fields pkg-private to reduce public API surface area?", "author": "NiteshKant", "createdAt": "2020-06-09T23:08:12Z", "path": "codec-http/src/main/java/io/netty/handler/codec/http/HttpObjectDecoder.java", "diffHunk": "@@ -102,6 +102,13 @@\n  * implement all abstract methods properly.\n  */\n public abstract class HttpObjectDecoder extends ByteToMessageDecoder {\n+    public static final int DEFAULT_MAX_INITIAL_LINE_LENGTH = 4096;", "originalCommit": "d7b5bba4f8d2fb5a7b1b39feb6e5595dd28b1c20", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc3NDI1NA==", "url": "https://github.com/netty/netty/pull/10344#discussion_r437774254", "bodyText": "I would recommend making them public (my reason being the 2nd point in my motivation).\nIf I am a user of Netty today, and I want to instantiate an HttpObjectDecoder using default values, except I want to change only one parameter, e.g., maxHeaderSize, I am forced to give values for 3 other parameters as well. This requires users to manually declare values for those parameters, and they will typically need to inspect the defaults and repeat them.\nShort of offering a more robust builder, exposing the defaults like this allows users to reference them accordingly and to only have to explicitly change the values they care about.", "author": "Bennett-Lynch", "createdAt": "2020-06-09T23:18:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc3MDgwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkwMDgxMw==", "url": "https://github.com/netty/netty/pull/10344#discussion_r437900813", "bodyText": "I think expose these as public is ok.", "author": "normanmaurer", "createdAt": "2020-06-10T07:00:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc3MDgwOA=="}], "type": "inlineReview"}]}