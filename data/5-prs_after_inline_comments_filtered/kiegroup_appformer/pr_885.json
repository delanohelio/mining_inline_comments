{"pr_number": 885, "pr_title": "RHDM-1016: [DMN Designer] Scroll Bars are not updated when keyboard is used for navigation", "pr_createdAt": "2020-01-31T13:16:21Z", "pr_url": "https://github.com/kiegroup/appformer/pull/885", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQ3NzY1Mw==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r373477653", "bodyText": "You can probably make this the interface GridLienzoScrollable instead of GridLienzoPanel?", "author": "manstis", "createdAt": "2020-01-31T13:26:55Z", "path": "uberfire-extensions/uberfire-wires/uberfire-wires-core/uberfire-wires-core-grids/src/main/java/org/uberfire/ext/wires/core/grids/client/widget/grid/impl/KeyboardOperationMove.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.uberfire.ext.wires.core.grids.client.widget.grid.impl;\n+\n+import java.util.Optional;\n+\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.GridWidget;\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.selections.SelectionExtension;\n+import org.uberfire.ext.wires.core.grids.client.widget.layer.GridLayer;\n+import org.uberfire.ext.wires.core.grids.client.widget.layer.impl.GridLienzoPanel;\n+\n+public abstract class KeyboardOperationMove extends BaseKeyboardOperation {\n+\n+    private final Optional<GridLienzoPanel> panel;\n+\n+    KeyboardOperationMove(final GridLayer gridLayer,\n+                          final GridLienzoPanel panel) {", "originalCommit": "7cbb85e254ebeb64f36ade25cda8d71572366137", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDYzMjQxNQ==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r374632415", "bodyText": "@danielzhe Just curious, why is this indirection required?", "author": "yesamer", "createdAt": "2020-02-04T12:07:35Z", "path": "uberfire-extensions/uberfire-wires/uberfire-wires-core/uberfire-wires-core-grids/src/main/java/org/uberfire/ext/wires/core/grids/client/widget/grid/impl/KeyboardOperationMove.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.uberfire.ext.wires.core.grids.client.widget.grid.impl;\n+\n+import java.util.Optional;\n+\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.GridWidget;\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.selections.SelectionExtension;\n+import org.uberfire.ext.wires.core.grids.client.widget.layer.GridLayer;\n+import org.uberfire.ext.wires.core.grids.client.widget.scrollbars.GridLienzoScrollable;\n+\n+public abstract class KeyboardOperationMove extends BaseKeyboardOperation {\n+\n+    private final Optional<GridLienzoScrollable> panel;\n+\n+    KeyboardOperationMove(final GridLayer gridLayer,\n+                          final GridLienzoScrollable panel) {\n+        super(gridLayer);\n+        this.panel = Optional.of(panel);\n+    }\n+\n+    @Override\n+    public boolean perform(final GridWidget gridWidget,\n+                           final boolean isShiftKeyDown,\n+                           final boolean isControlKeyDown) {\n+        final boolean redraw = gridWidget.adjustSelection(getSelectionExtension(),\n+                                                          isShiftKeyDown);\n+        baseScrollSelectedCellIntoView(gridWidget);\n+        panel.ifPresent(p -> p.refreshScrollPosition());\n+        return redraw;\n+    }\n+\n+    void baseScrollSelectedCellIntoView(final GridWidget gridWidget) {", "originalCommit": "2e9405833a2792dc10ae99cee7fd824dfd8e8040", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDYzNTg1NQ==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r374635855", "bodyText": "It seems to be mocked in a test (presumably to avoid more extensive mocking for the grid widget).", "author": "manstis", "createdAt": "2020-02-04T12:15:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDYzMjQxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDYzODkzMw==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r374638933", "bodyText": "@danielzhe Which is the scope of this new method? I don't see this SelectionExtension used previously.Thanks!", "author": "yesamer", "createdAt": "2020-02-04T12:22:31Z", "path": "uberfire-extensions/uberfire-wires/uberfire-wires-core/uberfire-wires-core-grids/src/main/java/org/uberfire/ext/wires/core/grids/client/widget/grid/impl/KeyboardOperationMove.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.uberfire.ext.wires.core.grids.client.widget.grid.impl;\n+\n+import java.util.Optional;\n+\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.GridWidget;\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.selections.SelectionExtension;\n+import org.uberfire.ext.wires.core.grids.client.widget.layer.GridLayer;\n+import org.uberfire.ext.wires.core.grids.client.widget.scrollbars.GridLienzoScrollable;\n+\n+public abstract class KeyboardOperationMove extends BaseKeyboardOperation {\n+\n+    private final Optional<GridLienzoScrollable> panel;\n+\n+    KeyboardOperationMove(final GridLayer gridLayer,\n+                          final GridLienzoScrollable panel) {\n+        super(gridLayer);\n+        this.panel = Optional.of(panel);\n+    }\n+\n+    @Override\n+    public boolean perform(final GridWidget gridWidget,\n+                           final boolean isShiftKeyDown,\n+                           final boolean isControlKeyDown) {\n+        final boolean redraw = gridWidget.adjustSelection(getSelectionExtension(),\n+                                                          isShiftKeyDown);\n+        baseScrollSelectedCellIntoView(gridWidget);\n+        panel.ifPresent(p -> p.refreshScrollPosition());\n+        return redraw;\n+    }\n+\n+    void baseScrollSelectedCellIntoView(final GridWidget gridWidget) {\n+        scrollSelectedCellIntoView(gridWidget);\n+    }\n+\n+    abstract SelectionExtension getSelectionExtension();", "originalCommit": "2e9405833a2792dc10ae99cee7fd824dfd8e8040", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDczMjkyMQ==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r374732921", "bodyText": "This is because I refactored KeyboardOperationMoveDown, KeyboardOperationMoveUp, KeyboardOperationMoveLeft and KeyboardOperationMoveRight introducing a new class in the inheritance between those classes and BaseKeyboardOperation\nPreviously all those classes have repeating code:\npublic boolean perform(final GridWidget gridWidget,\n                           final boolean isShiftKeyDown,\n                           final boolean isControlKeyDown) {\n        final boolean redraw = gridWidget.adjustSelection(SelectionExtension.DOWN,\n                                                          isShiftKeyDown);\n        scrollSelectedCellIntoView(gridWidget);\n        return redraw;\n\nThe only difference in each class was the SelectionExtension.DOWN (which was SelectionExtension.UP and so on, depending of the class that you was looking.\nSo I moved those logic to the new abstract class KeyboardOperationMove and added this new abstract method that you mentioned, which returns SelectionExtension.DOWN, SelectionExtension.UP and so on.", "author": "danielzhe", "createdAt": "2020-02-04T15:17:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDYzODkzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI2MTYzMQ==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r375261631", "bodyText": "Thank you @danielzhe!", "author": "yesamer", "createdAt": "2020-02-05T13:44:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDYzODkzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzUzNDAyMg==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r377534022", "bodyText": "I think also KeyboardOperationSelectTopLeftCell and KeyboardOperationSelectBottomRightCell should extend this, what do you think?", "author": "jomarko", "createdAt": "2020-02-11T09:57:01Z", "path": "uberfire-extensions/uberfire-wires/uberfire-wires-core/uberfire-wires-core-grids/src/main/java/org/uberfire/ext/wires/core/grids/client/widget/grid/impl/KeyboardOperationMove.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.uberfire.ext.wires.core.grids.client.widget.grid.impl;\n+\n+import java.util.Optional;\n+\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.GridWidget;\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.selections.SelectionExtension;\n+import org.uberfire.ext.wires.core.grids.client.widget.layer.GridLayer;\n+import org.uberfire.ext.wires.core.grids.client.widget.scrollbars.GridLienzoScrollable;\n+\n+public abstract class KeyboardOperationMove extends BaseKeyboardOperation {", "originalCommit": "2e9405833a2792dc10ae99cee7fd824dfd8e8040", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI3NDQ3Nw==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r378274477", "bodyText": "Makes sense.", "author": "danielzhe", "createdAt": "2020-02-12T14:12:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzUzNDAyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODMwNDg0NA==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r378304844", "bodyText": "Well, in fact the logic of the super classes are different. As you may notice, KeyboardOperationSelectTopLeftCell in the method perform calls selectTopLeftCell while the other classes derived from KeyboardOperationMove in the perform method has a common logic. @jomarko", "author": "danielzhe", "createdAt": "2020-02-12T14:59:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzUzNDAyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA3MDU2NA==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r378070564", "bodyText": "We need ofNullable. I am running FDB to demonstrate we need it. It will cause GuidedDecisionTableModellerPresenterTest to fail.", "author": "jomarko", "createdAt": "2020-02-12T07:05:08Z", "path": "uberfire-extensions/uberfire-wires/uberfire-wires-core/uberfire-wires-core-grids/src/main/java/org/uberfire/ext/wires/core/grids/client/widget/grid/impl/KeyboardOperationMove.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.uberfire.ext.wires.core.grids.client.widget.grid.impl;\n+\n+import java.util.Optional;\n+\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.GridWidget;\n+import org.uberfire.ext.wires.core.grids.client.widget.grid.selections.SelectionExtension;\n+import org.uberfire.ext.wires.core.grids.client.widget.layer.GridLayer;\n+import org.uberfire.ext.wires.core.grids.client.widget.scrollbars.GridLienzoScrollable;\n+\n+public abstract class KeyboardOperationMove extends BaseKeyboardOperation {\n+\n+    private final Optional<GridLienzoScrollable> panel;\n+\n+    KeyboardOperationMove(final GridLayer gridLayer,\n+                          final GridLienzoScrollable panel) {\n+        super(gridLayer);\n+        this.panel = Optional.of(panel);", "originalCommit": "2e9405833a2792dc10ae99cee7fd824dfd8e8040", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODM5OTYwNw==", "url": "https://github.com/kiegroup/appformer/pull/885#discussion_r378399607", "bodyText": "Change applied.", "author": "danielzhe", "createdAt": "2020-02-12T17:24:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA3MDU2NA=="}], "type": "inlineReview"}, {"oid": "7b28c2f5d54ab2fd2d71088e785606165dae6a8e", "url": "https://github.com/kiegroup/appformer/commit/7b28c2f5d54ab2fd2d71088e785606165dae6a8e", "message": "RHDM-1016: [DMN Designer] Scroll Bars are not updated when keyboard is used for navigation", "committedDate": "2020-02-12T14:01:03Z", "type": "commit"}, {"oid": "07e6a9700b72728dd88140dc285749e85e072f05", "url": "https://github.com/kiegroup/appformer/commit/07e6a9700b72728dd88140dc285749e85e072f05", "message": "code review", "committedDate": "2020-02-12T14:01:04Z", "type": "commit"}, {"oid": "82b8009a65340f8bff7693ab881c6e444bf83f97", "url": "https://github.com/kiegroup/appformer/commit/82b8009a65340f8bff7693ab881c6e444bf83f97", "message": "review", "committedDate": "2020-02-12T15:00:21Z", "type": "commit"}, {"oid": "82b8009a65340f8bff7693ab881c6e444bf83f97", "url": "https://github.com/kiegroup/appformer/commit/82b8009a65340f8bff7693ab881c6e444bf83f97", "message": "review", "committedDate": "2020-02-12T15:00:21Z", "type": "forcePushed"}, {"oid": "2e1cf0b3470ab5dd74ee38553862debb4ea858db", "url": "https://github.com/kiegroup/appformer/commit/2e1cf0b3470ab5dd74ee38553862debb4ea858db", "message": "SonarCloud smells", "committedDate": "2020-02-20T21:36:57Z", "type": "commit"}]}