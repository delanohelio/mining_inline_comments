{"pr_number": 893, "pr_title": "DROOLS-3276: [DMN Designer] All GRIDS: Add support for resizing columns using header", "pr_createdAt": "2020-02-12T11:58:49Z", "pr_url": "https://github.com/kiegroup/appformer/pull/893", "timeline": [{"oid": "91cef494adee7863d27cfc0f6316d96994638755", "url": "https://github.com/kiegroup/appformer/commit/91cef494adee7863d27cfc0f6316d96994638755", "message": "DROOLS-3276: [DMN Designer] All GRIDS: Add support for resizing columns using header", "committedDate": "2020-02-12T13:15:50Z", "type": "commit"}, {"oid": "91cef494adee7863d27cfc0f6316d96994638755", "url": "https://github.com/kiegroup/appformer/commit/91cef494adee7863d27cfc0f6316d96994638755", "message": "DROOLS-3276: [DMN Designer] All GRIDS: Add support for resizing columns using header", "committedDate": "2020-02-12T13:15:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY5NDk3Mg==", "url": "https://github.com/kiegroup/appformer/pull/893#discussion_r378694972", "bodyText": "Reading the javadoc. What we mean by Drag and Drop? My understanding was button pressed and moving mouse what would mean here we should have just constants with MOVE in name, not PENDING or INITIATED. So is Drag and Drop also not moving mouse but keeping the mouse button pressed?", "author": "jomarko", "createdAt": "2020-02-13T07:43:50Z", "path": "uberfire-extensions/uberfire-wires/uberfire-wires-core/uberfire-wires-core-grids/src/main/java/org/uberfire/ext/wires/core/grids/client/widget/grid/NodeMouseEventHandler.java", "diffHunk": "@@ -81,4 +83,28 @@ default boolean handleBodyCell(final GridWidget gridWidget,\n                                    final AbstractNodeMouseEvent event) {\n         return false;\n     }\n+\n+    /**\n+     * Returns whether the {@link AbstractNodeMouseEvent} occurred during a Drag and Drop operation.\n+     * @param gridWidget The {@link GridWidget} on which the event occurred.\n+     * @return true if the event occurred during a Drag and Drop operation.\n+     */\n+    default boolean isDNDOperationInProgress(final GridWidget gridWidget) {\n+        if (!(gridWidget.getLayer() instanceof GridLayer)) {\n+            return false;\n+        }\n+        final GridLayer gridLayer = (GridLayer) gridWidget.getLayer();\n+        final GridWidgetDnDHandlersState.GridWidgetHandlersOperation operation = gridLayer.getGridWidgetHandlersState().getOperation();\n+        switch (operation) {\n+            case NONE:\n+            case COLUMN_RESIZE_PENDING:\n+            case COLUMN_MOVE_PENDING:\n+            case COLUMN_MOVE_INITIATED:\n+            case ROW_MOVE_PENDING:\n+            case ROW_MOVE_INITIATED:\n+            case GRID_MOVE_PENDING:", "originalCommit": "91cef494adee7863d27cfc0f6316d96994638755", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODczOTQwOQ==", "url": "https://github.com/kiegroup/appformer/pull/893#discussion_r378739409", "bodyText": "Hi @jomarko a DnD operation is indeed any mousedown, mousemove, mouseup sequence of events. Furthermore a click event is a combination of mousedown, mouseup on the same HTML element (with or without a mousemove in between). Browsers detect the mousedown, mouseup and raise a separate click event in addition to the mousedown and mouseup events.\n_PENDING means the pointer is over a header cell (or \"resize hot spot\" etc) but a mousedown event has not happened (i.e. User is simply moving the pointer over a cell). _INITIATED means a previous _PENDING operation was detected and now a mousedown event has occurred and the DnD operation has been initiated (but may result in nothing happening, if the User does not actually move the column). When the column has actually been moved the DnD state is moved to _MOVE.\nTherefore, when single left clicking on a header (to edit it), mousedown, mouseup and click events are raised by the browser. This led to the \"edit header\" popup showing after moving a column to a new position which was undesirable. To prevent this from happening I added the COLUMN_MOVE_INITIATED state that means the cursor was over a movable column and a mousedown event was received BUT the column has NOT been moved to a new position.\nIn the isDNDOperationInProgress(..) code COLUMN_MOVE_INITIATED does not signal a DnD operation has actually happened (i.e. the column has not moved) and therefore both DefaultGridWidgetCellSelectorMouseEventHandler or DefaultGridWidgetEditCellMouseEventHandler respond to the click event to which they're bound. This is means when a user that a clicks on a header cell it is both selected and its editor is launched.\nHowever IF a column has actually been moved then a DnD operation has actually happened and both of the foregoing handlers do nothing, meaning the column is moved but it is neither selected nor its editor launched.\nI hope this explains the change (slightly!)", "author": "manstis", "createdAt": "2020-02-13T09:24:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY5NDk3Mg=="}], "type": "inlineReview"}]}