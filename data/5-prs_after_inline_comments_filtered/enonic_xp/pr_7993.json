{"pr_number": 7993, "pr_title": "Update language property on /content node when project is created/mod\u2026", "pr_createdAt": "2020-04-01T15:13:37Z", "pr_url": "https://github.com/enonic/xp/pull/7993", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc0MTUxNQ==", "url": "https://github.com/enonic/xp/pull/7993#discussion_r401741515", "bodyText": "requireNonNullElse is better", "author": "rymsha", "createdAt": "2020-04-01T16:19:27Z", "path": "modules/admin/admin-impl/src/main/java/com/enonic/xp/admin/impl/rest/resource/project/ApplyProjectLanguageCommand.java", "diffHunk": "@@ -0,0 +1,80 @@\n+package com.enonic.xp.admin.impl.rest.resource.project;\n+\n+import java.util.Locale;\n+\n+import com.enonic.xp.content.Content;\n+import com.enonic.xp.content.ContentPath;\n+import com.enonic.xp.content.UpdateContentParams;\n+import com.enonic.xp.context.Context;\n+import com.enonic.xp.context.ContextAccessor;\n+import com.enonic.xp.security.User;\n+\n+public final class ApplyProjectLanguageCommand\n+    extends AbstractProjectRootCommand\n+{\n+    private final Locale language;\n+\n+    private ApplyProjectLanguageCommand( final Builder builder )\n+    {\n+        super( builder );\n+        this.language = builder.language;\n+    }\n+\n+    public static Builder create()\n+    {\n+        return new Builder();\n+    }\n+\n+    public Locale execute()\n+    {\n+        return doUpdateLanguage();\n+    }\n+\n+    private Locale doUpdateLanguage()\n+    {\n+        return projectRepoContext.callWith( () -> {\n+            final Content root = this.contentService.getByPath( ContentPath.ROOT );\n+\n+            final UpdateContentParams params = new UpdateContentParams().\n+                contentId( root.getId() ).\n+                modifier( getCurrentUser().getKey() ).\n+                editor( edit -> edit.language = this.language );\n+\n+            return this.contentService.update( params ).\n+                getLanguage();\n+        } );\n+    }\n+\n+    private User getCurrentUser()\n+    {\n+        final Context context = ContextAccessor.current();\n+        return context.getAuthInfo().getUser() != null ? context.getAuthInfo().getUser() : User.ANONYMOUS;", "originalCommit": "46601fcb4100baf8832330df05b13743b7693912", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6", "url": "https://github.com/enonic/xp/commit/cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6", "message": "Update language property on /content node when project is created/modified #7975", "committedDate": "2020-04-01T17:57:22Z", "type": "commit"}, {"oid": "cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6", "url": "https://github.com/enonic/xp/commit/cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6", "message": "Update language property on /content node when project is created/modified #7975", "committedDate": "2020-04-01T17:57:22Z", "type": "forcePushed"}]}