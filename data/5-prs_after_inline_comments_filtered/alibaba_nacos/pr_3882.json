{"pr_number": 3882, "pr_title": "[ISSUE#3533] change cache dir with namespace -- part 2", "pr_createdAt": "2020-09-21T12:31:39Z", "pr_url": "https://github.com/alibaba/nacos/pull/3882", "timeline": [{"oid": "340b1ee77ba5498263785d2573dc8c49782a6e68", "url": "https://github.com/alibaba/nacos/commit/340b1ee77ba5498263785d2573dc8c49782a6e68", "message": "[ISSUE#3533] change cache dir with namespace -- part 2: unify the log dir", "committedDate": "2020-09-21T20:44:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjAxODMwMg==", "url": "https://github.com/alibaba/nacos/pull/3882#discussion_r492018302", "bodyText": "I think the nacos need keep, because in user.home/logs, there are many different app will print logs.", "author": "KomachiSion", "createdAt": "2020-09-21T12:50:23Z", "path": "client/src/main/java/com/alibaba/nacos/client/logging/AbstractNacosLogging.java", "diffHunk": "@@ -31,13 +33,13 @@\n     \n     private static final String NACOS_LOGGING_DEFAULT_CONFIG_ENABLED_PROPERTY = \"nacos.logging.default.config.enabled\";\n     \n-    private static final String NACOS_LOGGING_PATH_PROPERTY = \"nacos.logging.path\";\n+    private static final String NACOS_LOGGING_PATH_PROPERTY = \"JM.LOG.PATH\";\n     \n     static {\n         String loggingPath = System.getProperty(NACOS_LOGGING_PATH_PROPERTY);\n         if (StringUtils.isBlank(loggingPath)) {\n             String userHome = System.getProperty(\"user.home\");\n-            System.setProperty(NACOS_LOGGING_PATH_PROPERTY, userHome + \"/logs/nacos\");\n+            System.setProperty(NACOS_LOGGING_PATH_PROPERTY, userHome + File.separator + \"logs\");", "originalCommit": "340b1ee77ba5498263785d2573dc8c49782a6e68", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ5NDY2OA==", "url": "https://github.com/alibaba/nacos/pull/3882#discussion_r492494668", "bodyText": "I do kept the 'nacos' in nacos-log4j.xml, as is shown in the next comment.\nThe reason why I move 'nacos' dir into xml files is:\nIn 1.3.2, the ${nacos.logging.path} is directly the parent dir of log files:\nif ${nacos.logging.path} exists: \n    directly use ${nacos.log.path} as the log dir\nelse:\n    use ${nacos.log.path} = ${user.home}/logs/nacos as the log dir\n[code 1]\nbut in 1.4.0, the ${JM.LOG.PATH} is NOT the direct parent dir of log files. The direct dir should be ${JM.LOG.PATH}/nacos\nI can't direcly write this way:\nif ${JM.LOG.PATH} exists: \n    ${JM.LOG.PATH} = ${JM.LOG.PATH}/nacos\nelse:\n    use ${JM.LOG.PATH}= ${user.home}/logs/nacos as the log dir\n[code 2]\nthis code is wrong, because if ${JM.LOG.PATH} already exists, it should not be reassigned.\nso I write this way:\nif ${JM.LOG.PATH} exists: \n    do nothing\nelse:\n    ${JM.LOG.PATH}= ${user.home}/logs\nThen in the resource files:\nUse ${JM.LOG.PATH}/nacos instead of ${JM.LOG.PATH} as the logging parent dir.\nBut I see this process is not elegant.", "author": "realJackSun", "createdAt": "2020-09-22T06:16:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjAxODMwMg=="}], "type": "inlineReview"}, {"oid": "340b1ee77ba5498263785d2573dc8c49782a6e68", "url": "https://github.com/alibaba/nacos/commit/340b1ee77ba5498263785d2573dc8c49782a6e68", "message": "[ISSUE#3533] change cache dir with namespace -- part 2: unify the log dir", "committedDate": "2020-09-21T20:44:18Z", "type": "commit"}]}