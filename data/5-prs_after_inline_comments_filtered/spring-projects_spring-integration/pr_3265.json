{"pr_number": 3265, "pr_title": "Introduce a `ReceiveMessageAdvice`", "pr_createdAt": "2020-04-28T14:19:44Z", "pr_url": "https://github.com/spring-projects/spring-integration/pull/3265", "timeline": [{"oid": "c7abf6461abdb2c61acea61d7f249210ca766069", "url": "https://github.com/spring-projects/spring-integration/commit/c7abf6461abdb2c61acea61d7f249210ca766069", "message": "Introduce a `ReceiveMessageAdvice`\n\n* Deprecate an `AbstractMessageSourceAdvice` in favor of\n`default` method in the `MessageSourceMutator`\n* Move a `applyReceiveOnlyAdviceChain()` logic into the `AbstractPollingEndpoint`:\nnow both `PollingConsumer` and `SourcePollingChannelAdapter` can use\n`ReceiveMessageAdvice`\n* Introduce a `SimpleActiveIdleReceiveMessageAdvice` based already\non the `ReceiveMessageAdvice` and deprecate a `SimpleActiveIdleMessageSourceAdvice`\nwhich is fully replaceable with newly introduced `SimpleActiveIdleReceiveMessageAdvice`\n* Add `@SuppressWarnings(\"deprecation\")` for those out-of-the-box `ReceiveMessageAdvice`\nimplementation which still use an `AbstractMessageSourceAdvice` for\nbackward compatibility\n* Document a new feature and give the `MessageSourceMutator` a new meaning", "committedDate": "2020-04-28T14:19:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcwMTIxNg==", "url": "https://github.com/spring-projects/spring-integration/pull/3265#discussion_r416701216", "bodyText": "Wouldn't something like Advisable<T> be better than Object?", "author": "garyrussell", "createdAt": "2020-04-28T15:20:17Z", "path": "spring-integration-core/src/main/java/org/springframework/integration/aop/CompoundTriggerAdvice.java", "diffHunk": "@@ -47,8 +51,21 @@ public CompoundTriggerAdvice(CompoundTrigger compoundTrigger, Trigger overrideTr\n \t\tthis.override = overrideTrigger;\n \t}\n \n+\t/**\n+\t * @param result the received message.\n+\t * @param source the message source.\n+\t * @return the message or null\n+\t * @deprecated since 5.3 in favor of {@link #afterReceive(Message, Object)}\n+\t */\n \t@Override\n+\t@Deprecated\n \tpublic Message<?> afterReceive(Message<?> result, MessageSource<?> source) {\n+\t\treturn afterReceive(result, (Object) source);\n+\t}\n+\n+\t@Override\n+\t@Nullable\n+\tpublic Message<?> afterReceive(@Nullable Message<?> result, Object source) {", "originalCommit": "c7abf6461abdb2c61acea61d7f249210ca766069", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcwNDA5Nw==", "url": "https://github.com/spring-projects/spring-integration/pull/3265#discussion_r416704097", "bodyText": "Well, in most cases it is really about both MessageSource and PollableChannel, so even with generic argument it still going to be an Object \ud83d\ude04\nI thought about a Supplier for both those interfaces, but this is not what we are going to use with the receive(timeout).\nTherefore I'm OK to stick with an Object for a source argument.", "author": "artembilan", "createdAt": "2020-04-28T15:23:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcwMTIxNg=="}], "type": "inlineReview"}, {"oid": "880177cb5963a140dc2f02df8c6f655a431a58e9", "url": "https://github.com/spring-projects/spring-integration/commit/880177cb5963a140dc2f02df8c6f655a431a58e9", "message": "* Fix language in the `polling-consumer.adoc`", "committedDate": "2020-04-28T16:33:45Z", "type": "commit"}]}