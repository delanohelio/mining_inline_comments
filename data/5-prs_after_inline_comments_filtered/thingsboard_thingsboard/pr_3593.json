{"pr_number": 3593, "pr_title": "[3.3] Feature/attributes cache", "pr_createdAt": "2020-10-16T10:17:00Z", "pr_url": "https://github.com/thingsboard/thingsboard/pull/3593", "timeline": [{"oid": "f5e1391c3adf8557e3856705eabf31104cbd7afd", "url": "https://github.com/thingsboard/thingsboard/commit/f5e1391c3adf8557e3856705eabf31104cbd7afd", "message": "Use TenantCacheService interface in AttributesCache", "committedDate": "2020-10-13T11:58:01Z", "type": "commit"}, {"oid": "410ced7091ee657808cd924eb02105244d5f0ac3", "url": "https://github.com/thingsboard/thingsboard/commit/410ced7091ee657808cd924eb02105244d5f0ac3", "message": "Added Google cache with loader", "committedDate": "2020-10-13T13:07:53Z", "type": "commit"}, {"oid": "4d7e14f908343d141ef81ae5860062ea1717e88a", "url": "https://github.com/thingsboard/thingsboard/commit/4d7e14f908343d141ef81ae5860062ea1717e88a", "message": "Implemented cache for attributes", "committedDate": "2020-10-15T09:32:39Z", "type": "commit"}, {"oid": "6a5e359f3f9284c38d8454001cfddc978d242ad0", "url": "https://github.com/thingsboard/thingsboard/commit/6a5e359f3f9284c38d8454001cfddc978d242ad0", "message": "Merge branch 'master' into feature/attributes-cache", "committedDate": "2020-10-15T12:41:23Z", "type": "commit"}, {"oid": "ef9b80b34642bb05849f680ee69856f30b7763a6", "url": "https://github.com/thingsboard/thingsboard/commit/ef9b80b34642bb05849f680ee69856f30b7763a6", "message": "Moved cache logic to separate class", "committedDate": "2020-10-15T13:03:20Z", "type": "commit"}, {"oid": "4b096d4ac2e895758ee701d918398c3fe98a5d3d", "url": "https://github.com/thingsboard/thingsboard/commit/4b096d4ac2e895758ee701d918398c3fe98a5d3d", "message": "Updated AttributesCacheConfiguration", "committedDate": "2020-10-15T15:13:49Z", "type": "commit"}, {"oid": "c4d64df749efb114288fe252c0cf36ccde243e65", "url": "https://github.com/thingsboard/thingsboard/commit/c4d64df749efb114288fe252c0cf36ccde243e65", "message": "Added tests for AttributesCache with google-cache", "committedDate": "2020-10-15T15:16:25Z", "type": "commit"}, {"oid": "2ca5572636f563dae05b73b980273fa9ad789a23", "url": "https://github.com/thingsboard/thingsboard/commit/2ca5572636f563dae05b73b980273fa9ad789a23", "message": "Merge branch 'master' into feature/attributes-cache\n\n# Conflicts:\n#\tapplication/src/main/java/org/thingsboard/server/service/queue/TbClusterService.java", "committedDate": "2020-10-15T15:17:51Z", "type": "commit"}, {"oid": "57178a278dbdd5eb7dc8ae4d7188ae6502af3827", "url": "https://github.com/thingsboard/thingsboard/commit/57178a278dbdd5eb7dc8ae4d7188ae6502af3827", "message": "Update cache after save/remove", "committedDate": "2020-10-16T10:02:14Z", "type": "commit"}, {"oid": "f8bdf3a0a559542f27fa89d495d033b0418eea4d", "url": "https://github.com/thingsboard/thingsboard/commit/f8bdf3a0a559542f27fa89d495d033b0418eea4d", "message": "Added test for CachedAttributesService", "committedDate": "2020-10-16T10:15:34Z", "type": "commit"}, {"oid": "120466202c05686d035785a495da016339929eca", "url": "https://github.com/thingsboard/thingsboard/commit/120466202c05686d035785a495da016339929eca", "message": "Merge branch 'master' into feature/attributes-cache", "committedDate": "2020-10-16T11:00:23Z", "type": "commit"}, {"oid": "4caba3e6e1560aab2fb8ea29fed89a7c687cfeb5", "url": "https://github.com/thingsboard/thingsboard/commit/4caba3e6e1560aab2fb8ea29fed89a7c687cfeb5", "message": "Changed Optional to CacheEntry", "committedDate": "2020-10-16T16:03:50Z", "type": "commit"}, {"oid": "226ed6bd206cb70f454af48f1c8b4fa6cb3cca5d", "url": "https://github.com/thingsboard/thingsboard/commit/226ed6bd206cb70f454af48f1c8b4fa6cb3cca5d", "message": "Merge branch 'master' into feature/attributes-cache", "committedDate": "2020-10-19T08:34:47Z", "type": "commit"}, {"oid": "00230554b17632b737e552c7cc30cc952363a7c8", "url": "https://github.com/thingsboard/thingsboard/commit/00230554b17632b737e552c7cc30cc952363a7c8", "message": "Broadcast cache updated msg to RuleEngines too", "committedDate": "2020-10-19T09:05:00Z", "type": "commit"}, {"oid": "223315af6903b37c109879df6725cacde441e1b6", "url": "https://github.com/thingsboard/thingsboard/commit/223315af6903b37c109879df6725cacde441e1b6", "message": "Process cache update in RuleEngines", "committedDate": "2020-10-19T09:43:15Z", "type": "commit"}, {"oid": "ae5254b92a80a710f527ce0792e7546a93f10a8b", "url": "https://github.com/thingsboard/thingsboard/commit/ae5254b92a80a710f527ce0792e7546a93f10a8b", "message": "Made attributes cache optional", "committedDate": "2020-10-19T10:03:48Z", "type": "commit"}, {"oid": "5049fd6d8e5ed6ad7510abe40dc38bf930396a1d", "url": "https://github.com/thingsboard/thingsboard/commit/5049fd6d8e5ed6ad7510abe40dc38bf930396a1d", "message": "Added endpoint to invalidate attributes cache", "committedDate": "2020-10-19T10:42:26Z", "type": "commit"}, {"oid": "629497058d2dbc26da898a304267787fd6bea494", "url": "https://github.com/thingsboard/thingsboard/commit/629497058d2dbc26da898a304267787fd6bea494", "message": "Added stats for attributesCache", "committedDate": "2020-12-28T11:00:03Z", "type": "commit"}, {"oid": "d8248a12617121666f7fa86c3df87a315582e471", "url": "https://github.com/thingsboard/thingsboard/commit/d8248a12617121666f7fa86c3df87a315582e471", "message": "Fixed bug with SysAdmin working with Tenant's attributes", "committedDate": "2020-12-28T11:10:09Z", "type": "commit"}, {"oid": "fdbe508a8ac994b9233e9c9946529b8f2476d407", "url": "https://github.com/thingsboard/thingsboard/commit/fdbe508a8ac994b9233e9c9946529b8f2476d407", "message": "Merge remote-tracking branch 'upstream/develop/3.3' into feature/attributes-cache\n\n# Conflicts:\n#\tapplication/src/main/java/org/thingsboard/server/controller/AdminController.java\n#\tapplication/src/main/java/org/thingsboard/server/service/queue/DefaultTbClusterService.java\n#\tapplication/src/main/java/org/thingsboard/server/service/queue/DefaultTbCoreConsumerService.java\n#\tapplication/src/main/java/org/thingsboard/server/service/queue/DefaultTbRuleEngineConsumerService.java\n#\tapplication/src/main/java/org/thingsboard/server/service/queue/processing/AbstractConsumerService.java", "committedDate": "2020-12-28T11:30:12Z", "type": "commit"}, {"oid": "9904b1df50347521cdad101ed7d6c50141028a88", "url": "https://github.com/thingsboard/thingsboard/commit/9904b1df50347521cdad101ed7d6c50141028a88", "message": "Fixed merge", "committedDate": "2020-12-28T13:44:04Z", "type": "commit"}, {"oid": "fc06fb3a3766160e077800f5cb52c641b3f44203", "url": "https://github.com/thingsboard/thingsboard/commit/fc06fb3a3766160e077800f5cb52c641b3f44203", "message": "Refactored and fixed AttributeCacheTests", "committedDate": "2020-12-28T13:49:20Z", "type": "commit"}, {"oid": "3823723c2a5a4f050a3c2f4bc1b05fa47e01f0ac", "url": "https://github.com/thingsboard/thingsboard/commit/3823723c2a5a4f050a3c2f4bc1b05fa47e01f0ac", "message": "Removed .* imports for Attributes feature", "committedDate": "2021-01-22T16:23:50Z", "type": "commit"}, {"oid": "151db59f261f1ebf2d327da02b2627c0f23dedd4", "url": "https://github.com/thingsboard/thingsboard/commit/151db59f261f1ebf2d327da02b2627c0f23dedd4", "message": "Added Caffeine attr cache, updated caffeine version", "committedDate": "2021-01-26T14:29:15Z", "type": "commit"}, {"oid": "e33b7f63575e26aee3d78f948e69f40826ed02ea", "url": "https://github.com/thingsboard/thingsboard/commit/e33b7f63575e26aee3d78f948e69f40826ed02ea", "message": "Merge branch 'develop/3.3' into feature/attributes-cache", "committedDate": "2021-01-28T13:40:57Z", "type": "commit"}, {"oid": "1d354c7d8cbfcdbd7fe8d522d09bb5dee21f987a", "url": "https://github.com/thingsboard/thingsboard/commit/1d354c7d8cbfcdbd7fe8d522d09bb5dee21f987a", "message": "Fixed merge", "committedDate": "2021-01-28T14:44:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDEyMzk5Mg==", "url": "https://github.com/thingsboard/thingsboard/pull/3593#discussion_r580123992", "bodyText": "Code duplication.", "author": "ashvayka", "createdAt": "2021-02-22T10:06:59Z", "path": "application/src/main/java/org/thingsboard/server/service/queue/DefaultTbClusterService.java", "diffHunk": "@@ -306,6 +322,28 @@ private void broadcast(ComponentLifecycleMsg msg) {\n         }\n     }\n \n+    private void broadcast(AttributesCacheUpdatedMsg msg) {\n+        byte[] msgBytes = encodingService.encode(msg);", "originalCommit": "1d354c7d8cbfcdbd7fe8d522d09bb5dee21f987a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}