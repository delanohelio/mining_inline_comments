{"pr_number": 2381, "pr_title": "smtp tls version ", "pr_createdAt": "2020-01-31T10:08:53Z", "pr_url": "https://github.com/thingsboard/thingsboard/pull/2381", "timeline": [{"oid": "f0df4d3834b08523ee5e2ae6608b4d78aa3e4ffe", "url": "https://github.com/thingsboard/thingsboard/commit/f0df4d3834b08523ee5e2ae6608b4d78aa3e4ffe", "message": "added tlsVersion to TbSendEmailNode", "committedDate": "2020-01-31T10:08:12Z", "type": "commit"}, {"oid": "0a7f8af40313ac123c33f1d55d4432258eee5127", "url": "https://github.com/thingsboard/thingsboard/commit/0a7f8af40313ac123c33f1d55d4432258eee5127", "message": "added tlsVersion to DefaultMailService", "committedDate": "2020-01-31T14:36:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE4OTA3NA==", "url": "https://github.com/thingsboard/thingsboard/pull/2381#discussion_r374189074", "bodyText": "What if this is an old version of the configuration (without this parameter stored). We need to check for an empty string or null here.", "author": "ashvayka", "createdAt": "2020-02-03T16:03:45Z", "path": "rule-engine/rule-engine-components/src/main/java/org/thingsboard/rule/engine/mail/TbSendEmailNode.java", "diffHunk": "@@ -137,10 +141,13 @@ private Properties createJavaMailProperties() {\n         String protocol = this.config.getSmtpProtocol();\n         javaMailProperties.put(\"mail.transport.protocol\", protocol);\n         javaMailProperties.put(MAIL_PROP + protocol + \".host\", this.config.getSmtpHost());\n-        javaMailProperties.put(MAIL_PROP + protocol + \".port\", this.config.getSmtpPort()+\"\");\n-        javaMailProperties.put(MAIL_PROP + protocol + \".timeout\", this.config.getTimeout()+\"\");\n+        javaMailProperties.put(MAIL_PROP + protocol + \".port\", this.config.getSmtpPort() + \"\");\n+        javaMailProperties.put(MAIL_PROP + protocol + \".timeout\", this.config.getTimeout() + \"\");\n         javaMailProperties.put(MAIL_PROP + protocol + \".auth\", String.valueOf(StringUtils.isNotEmpty(this.config.getUsername())));\n         javaMailProperties.put(MAIL_PROP + protocol + \".starttls.enable\", Boolean.valueOf(this.config.isEnableTls()).toString());\n+        if (this.config.isEnableTls()) {\n+            javaMailProperties.put(MAIL_PROP + protocol + \".ssl.protocols\", this.config.getTlsVersion());", "originalCommit": "0a7f8af40313ac123c33f1d55d4432258eee5127", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8435df4422323b9c426719b851fd3c8d29a0ac37", "url": "https://github.com/thingsboard/thingsboard/commit/8435df4422323b9c426719b851fd3c8d29a0ac37", "message": "Merge branch 'master' of https://github.com/thingsboard/thingsboard into feature/smtp-tls", "committedDate": "2020-02-04T18:58:06Z", "type": "commit"}, {"oid": "5f747d54cd6e9b3c6278f39d2cedbfe7ade3ef3c", "url": "https://github.com/thingsboard/thingsboard/commit/5f747d54cd6e9b3c6278f39d2cedbfe7ade3ef3c", "message": "added check tlsVersion for old version", "committedDate": "2020-02-04T19:07:01Z", "type": "commit"}]}