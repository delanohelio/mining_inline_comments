{"pr_number": 697, "pr_title": "Project groups to ant design", "pr_createdAt": "2020-05-20T01:09:19Z", "pr_url": "https://github.com/phac-nml/irida/pull/697", "timeline": [{"oid": "7e0e790558a702c0a3fb3d264fa9dabee5fc614c", "url": "https://github.com/phac-nml/irida/commit/7e0e790558a702c0a3fb3d264fa9dabee5fc614c", "message": ":art: Code cleanup to have only one AddMemberButton\n\nIncluded refactoring of roles context to be more than just project roles.", "committedDate": "2020-05-15T13:43:18Z", "type": "commit"}, {"oid": "9a3c062edecab224c4089176372e0ceeef4c8a69", "url": "https://github.com/phac-nml/irida/commit/9a3c062edecab224c4089176372e0ceeef4c8a69", "message": ":construction: Initial code for project user groups", "committedDate": "2020-05-15T13:44:40Z", "type": "commit"}, {"oid": "5aa30439fc00ec26c588b2deff6a56395623c9cd", "url": "https://github.com/phac-nml/irida/commit/5aa30439fc00ec26c588b2deff6a56395623c9cd", "message": ":construction: work on removing a user group from project.", "committedDate": "2020-05-15T18:34:27Z", "type": "commit"}, {"oid": "dd0e5b7331159ec14020ed5aa0702b695fb9a58b", "url": "https://github.com/phac-nml/irida/commit/dd0e5b7331159ec14020ed5aa0702b695fb9a58b", "message": "Merge branch 'group-create-new' into project-groups", "committedDate": "2020-05-19T11:45:01Z", "type": "commit"}, {"oid": "8dfb2fc86ee980ff5bdeb1911cc790048e5bc63e", "url": "https://github.com/phac-nml/irida/commit/8dfb2fc86ee980ff5bdeb1911cc790048e5bc63e", "message": "Working on add group button", "committedDate": "2020-05-19T15:25:16Z", "type": "commit"}, {"oid": "bbdca43f7c01e2d0f802b8911f82dc71b111afea", "url": "https://github.com/phac-nml/irida/commit/bbdca43f7c01e2d0f802b8911f82dc71b111afea", "message": "Basic setup to get available user groups", "committedDate": "2020-05-19T16:11:56Z", "type": "commit"}, {"oid": "3d541ae2828a9bef611ff81906421b29fbf62532", "url": "https://github.com/phac-nml/irida/commit/3d541ae2828a9bef611ff81906421b29fbf62532", "message": "Merge branch '\u26d4\ufe0f-development' into project-groups", "committedDate": "2020-05-20T01:06:10Z", "type": "commit"}, {"oid": "b0033cee303866c38add7556e830aea33365a0f1", "url": "https://github.com/phac-nml/irida/commit/b0033cee303866c38add7556e830aea33365a0f1", "message": "Working user groups", "committedDate": "2020-05-20T16:49:53Z", "type": "commit"}, {"oid": "dd4a4ac68ff81fae1faa55cfa97585b2a55f546e", "url": "https://github.com/phac-nml/irida/commit/dd4a4ac68ff81fae1faa55cfa97585b2a55f546e", "message": "Cleaned up usage of remove button", "committedDate": "2020-05-20T17:40:13Z", "type": "commit"}, {"oid": "2f87fe9ba6346992e79ea3e6825226889d0d6dcf", "url": "https://github.com/phac-nml/irida/commit/2f87fe9ba6346992e79ea3e6825226889d0d6dcf", "message": "Updated JSDoc", "committedDate": "2020-05-20T18:32:20Z", "type": "commit"}, {"oid": "905296f47ae4ba143de97afb43f3b228b88d2824", "url": "https://github.com/phac-nml/irida/commit/905296f47ae4ba143de97afb43f3b228b88d2824", "message": "Updated JavaDoc", "committedDate": "2020-05-20T18:51:24Z", "type": "commit"}, {"oid": "6c6cfd51b93673d1acbc0d9db8ad05217b3f5895", "url": "https://github.com/phac-nml/irida/commit/6c6cfd51b93673d1acbc0d9db8ad05217b3f5895", "message": "Fixed broken test", "committedDate": "2020-05-21T11:18:26Z", "type": "commit"}, {"oid": "241f901a12d4516c35e0234c98449db9cf8546e7", "url": "https://github.com/phac-nml/irida/commit/241f901a12d4516c35e0234c98449db9cf8546e7", "message": "Fixed JavaDoc", "committedDate": "2020-05-21T11:20:18Z", "type": "commit"}, {"oid": "1c6b0f0de751d5d8160bcddd498d1a82bb6fc6d7", "url": "https://github.com/phac-nml/irida/commit/1c6b0f0de751d5d8160bcddd498d1a82bb6fc6d7", "message": "Unit testing for UIProjectUserGroupService", "committedDate": "2020-05-21T18:11:29Z", "type": "commit"}, {"oid": "5b55997cbd03fe33112f60afa242c57db86205e0", "url": "https://github.com/phac-nml/irida/commit/5b55997cbd03fe33112f60afa242c57db86205e0", "message": "Merge branch '\u26d4\ufe0f-development' into project-groups", "committedDate": "2020-05-21T18:21:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ4NDAxNg==", "url": "https://github.com/phac-nml/irida/pull/697#discussion_r430484016", "bodyText": "Just a general question. Even if there is an error deleting the usergroup would we still want it to return a ResponseEntity.ok? Or should we set the status as a bad request with the error message?", "author": "deepsidhu85", "createdAt": "2020-05-26T15:05:37Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/ajax/projects/ProjectUserGroupsAjaxController.java", "diffHunk": "@@ -0,0 +1,105 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.ajax.projects;\n+\n+import java.util.List;\n+import java.util.Locale;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.*;\n+\n+import ca.corefacility.bioinformatics.irida.exceptions.ProjectWithoutOwnerException;\n+import ca.corefacility.bioinformatics.irida.model.user.group.UserGroup;\n+import ca.corefacility.bioinformatics.irida.ria.web.ajax.dto.NewMemberRequest;\n+import ca.corefacility.bioinformatics.irida.ria.web.ajax.dto.ProjectUserGroupsTableModel;\n+import ca.corefacility.bioinformatics.irida.ria.web.models.tables.TableRequest;\n+import ca.corefacility.bioinformatics.irida.ria.web.models.tables.TableResponse;\n+import ca.corefacility.bioinformatics.irida.ria.web.services.UIProjectUserGroupsService;\n+\n+/**\n+ * UI Ajax Controller for handling project user groups\n+ */\n+@RestController\n+@RequestMapping(\"/ajax/projects/{projectId}/user-groups\")\n+public class ProjectUserGroupsAjaxController {\n+\tprivate final UIProjectUserGroupsService service;\n+\n+\t@Autowired\n+\tpublic ProjectUserGroupsAjaxController(UIProjectUserGroupsService service) {\n+\t\tthis.service = service;\n+\t}\n+\n+\t/**\n+\t * Get a table page of {@link ProjectUserGroupsTableModel}\n+\t *\n+\t * @param projectId Identifier for a project\n+\t * @param request   {@link TableRequest} details about the current page of the table\n+\t * @return {@link TableResponse}\n+\t */\n+\t@RequestMapping(\"\")\n+\tpublic ResponseEntity<TableResponse<ProjectUserGroupsTableModel>> getProjectUserGroups(@PathVariable Long projectId,\n+\t\t\t@RequestBody TableRequest request) {\n+\t\treturn ResponseEntity.ok(service.getUserGroupsForProject(projectId, request));\n+\t}\n+\n+\t/**\n+\t * Remove a user group from a project\n+\t *\n+\t * @param projectId Identifier for a project\n+\t * @param groupId   Identifier for an user group\n+\t * @param locale    current users locale\n+\t * @return message to user about the result of removing the user group\n+\t */\n+\t@RequestMapping(value = \"\", method = RequestMethod.DELETE)\n+\tpublic ResponseEntity<String> removeUserGroupFromProject(@PathVariable long projectId, @RequestParam long groupId,\n+\t\t\tLocale locale) {\n+\t\treturn ResponseEntity.ok(service.removeUserGroupFromProject(projectId, groupId, locale));", "originalCommit": "5b55997cbd03fe33112f60afa242c57db86205e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDUxOTcyNA==", "url": "https://github.com/phac-nml/irida/pull/697#discussion_r430519724", "bodyText": "No but it should throw it's own error at that point and not actually return here.", "author": "joshsadam", "createdAt": "2020-05-26T15:50:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ4NDAxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYyNTAxOQ==", "url": "https://github.com/phac-nml/irida/pull/697#discussion_r430625019", "bodyText": "Sounds good!", "author": "deepsidhu85", "createdAt": "2020-05-26T18:36:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ4NDAxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ4NTQ3OA==", "url": "https://github.com/phac-nml/irida/pull/697#discussion_r430485478", "bodyText": "We should probably set this as a bad request instead of an internal server error as this really isn't an internal server error", "author": "deepsidhu85", "createdAt": "2020-05-26T15:07:35Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/ajax/projects/ProjectUserGroupsAjaxController.java", "diffHunk": "@@ -0,0 +1,105 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.ajax.projects;\n+\n+import java.util.List;\n+import java.util.Locale;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.*;\n+\n+import ca.corefacility.bioinformatics.irida.exceptions.ProjectWithoutOwnerException;\n+import ca.corefacility.bioinformatics.irida.model.user.group.UserGroup;\n+import ca.corefacility.bioinformatics.irida.ria.web.ajax.dto.NewMemberRequest;\n+import ca.corefacility.bioinformatics.irida.ria.web.ajax.dto.ProjectUserGroupsTableModel;\n+import ca.corefacility.bioinformatics.irida.ria.web.models.tables.TableRequest;\n+import ca.corefacility.bioinformatics.irida.ria.web.models.tables.TableResponse;\n+import ca.corefacility.bioinformatics.irida.ria.web.services.UIProjectUserGroupsService;\n+\n+/**\n+ * UI Ajax Controller for handling project user groups\n+ */\n+@RestController\n+@RequestMapping(\"/ajax/projects/{projectId}/user-groups\")\n+public class ProjectUserGroupsAjaxController {\n+\tprivate final UIProjectUserGroupsService service;\n+\n+\t@Autowired\n+\tpublic ProjectUserGroupsAjaxController(UIProjectUserGroupsService service) {\n+\t\tthis.service = service;\n+\t}\n+\n+\t/**\n+\t * Get a table page of {@link ProjectUserGroupsTableModel}\n+\t *\n+\t * @param projectId Identifier for a project\n+\t * @param request   {@link TableRequest} details about the current page of the table\n+\t * @return {@link TableResponse}\n+\t */\n+\t@RequestMapping(\"\")\n+\tpublic ResponseEntity<TableResponse<ProjectUserGroupsTableModel>> getProjectUserGroups(@PathVariable Long projectId,\n+\t\t\t@RequestBody TableRequest request) {\n+\t\treturn ResponseEntity.ok(service.getUserGroupsForProject(projectId, request));\n+\t}\n+\n+\t/**\n+\t * Remove a user group from a project\n+\t *\n+\t * @param projectId Identifier for a project\n+\t * @param groupId   Identifier for an user group\n+\t * @param locale    current users locale\n+\t * @return message to user about the result of removing the user group\n+\t */\n+\t@RequestMapping(value = \"\", method = RequestMethod.DELETE)\n+\tpublic ResponseEntity<String> removeUserGroupFromProject(@PathVariable long projectId, @RequestParam long groupId,\n+\t\t\tLocale locale) {\n+\t\treturn ResponseEntity.ok(service.removeUserGroupFromProject(projectId, groupId, locale));\n+\t}\n+\n+\t/**\n+\t * Get a list of user groups that are not on the current project\n+\t *\n+\t * @param projectId Identifier for the current project\n+\t * @param query     Filter string to search the existing user groups by\n+\t * @return List of user groups\n+\t */\n+\t@RequestMapping(\"/available\")\n+\tpublic ResponseEntity<List<UserGroup>> getAvailableUserGroupsForProject(@PathVariable Long projectId,\n+\t\t\t@RequestParam String query) {\n+\t\treturn ResponseEntity.ok(service.getAvailableUserGroupsForProject(projectId, query));\n+\t}\n+\n+\t/**\n+\t * Add a user group to the current project\n+\t *\n+\t * @param projectId Identifier for a project\n+\t * @param request   Identifier for an user group\n+\t * @param locale    Current users locale\n+\t * @return message to user about the outcome of adding the user group to the project\n+\t */\n+\t@RequestMapping(value = \"/add\", method = RequestMethod.POST)\n+\tpublic ResponseEntity<String> addUserGroupToProject(@PathVariable Long projectId,\n+\t\t\t@RequestBody NewMemberRequest request, Locale locale) {\n+\t\treturn ResponseEntity.ok(service.addUserGroupToProject(projectId, request, locale));\n+\t}\n+\n+\t/**\n+\t * Update the project role of a user group on the current project\n+\t *\n+\t * @param projectId Identifier for a project\n+\t * @param id        Identifier for an user group\n+\t * @param role      Role to update the user group to\n+\t * @param locale    Current users locale\n+\t * @return message to user about the result of the update\n+\t */\n+\t@RequestMapping(value = \"/role\", method = RequestMethod.PUT)\n+\tpublic ResponseEntity<String> updateUserGroupRoleOnProject(@PathVariable Long projectId, @RequestParam Long id,\n+\t\t\t@RequestParam String role, Locale locale) {\n+\t\ttry {\n+\t\t\treturn ResponseEntity.ok(service.updateUserGroupRoleOnProject(projectId, id, role, locale));\n+\t\t} catch (ProjectWithoutOwnerException e) {\n+\t\t\treturn ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)", "originalCommit": "5b55997cbd03fe33112f60afa242c57db86205e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDUxOTI3Nw==", "url": "https://github.com/phac-nml/irida/pull/697#discussion_r430519277", "bodyText": "Updated in 8fc41cc", "author": "joshsadam", "createdAt": "2020-05-26T15:49:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ4NTQ3OA=="}], "type": "inlineReview"}, {"oid": "fef586d427479ab04e2a83352945df48bbdeed19", "url": "https://github.com/phac-nml/irida/commit/fef586d427479ab04e2a83352945df48bbdeed19", "message": "Merge branch '\u26d4\ufe0f-development' into project-groups", "committedDate": "2020-05-26T15:45:25Z", "type": "commit"}, {"oid": "8fc41cc5ddaee74e410d1a8d142311f8eace56c4", "url": "https://github.com/phac-nml/irida/commit/8fc41cc5ddaee74e410d1a8d142311f8eace56c4", "message": "Changed from server error to bad request", "committedDate": "2020-05-26T15:49:38Z", "type": "commit"}, {"oid": "d2184e556cdbb0070be1b52a06b03fe38dd037a2", "url": "https://github.com/phac-nml/irida/commit/d2184e556cdbb0070be1b52a06b03fe38dd037a2", "message": "Updated i18n", "committedDate": "2020-05-26T15:52:37Z", "type": "commit"}, {"oid": "3e455c10ee03b53ac55d8da92f596ff8ac5d35c0", "url": "https://github.com/phac-nml/irida/commit/3e455c10ee03b53ac55d8da92f596ff8ac5d35c0", "message": "Added JSDoc", "committedDate": "2020-05-26T15:55:17Z", "type": "commit"}, {"oid": "a86d8c74626e724e9e35d6764848d2d291b03159", "url": "https://github.com/phac-nml/irida/commit/a86d8c74626e724e9e35d6764848d2d291b03159", "message": "Fix for issue where modal was not closing on cancel", "committedDate": "2020-05-26T16:13:57Z", "type": "commit"}, {"oid": "144312ef6e7fdf3dc85b960e72768fd1975162c6", "url": "https://github.com/phac-nml/irida/commit/144312ef6e7fdf3dc85b960e72768fd1975162c6", "message": "Updated JSDoc", "committedDate": "2020-05-26T16:39:21Z", "type": "commit"}, {"oid": "3a15ed6181b02b682e78158fac2ea1c23b615d98", "url": "https://github.com/phac-nml/irida/commit/3a15ed6181b02b682e78158fac2ea1c23b615d98", "message": "Fixed issue where a user group could result in to owner", "committedDate": "2020-05-26T17:59:43Z", "type": "commit"}, {"oid": "812b50b51ec52318afbc0b6cd223f0380f96a898", "url": "https://github.com/phac-nml/irida/commit/812b50b51ec52318afbc0b6cd223f0380f96a898", "message": "\ud83d\udcda\ufe0f Updating user documentation", "committedDate": "2020-05-26T19:33:38Z", "type": "commit"}, {"oid": "b578fbb542bd7d24e497741d7057538436c2bea7", "url": "https://github.com/phac-nml/irida/commit/b578fbb542bd7d24e497741d7057538436c2bea7", "message": "Merge branch '\u26d4\ufe0f-development' into project-groups", "committedDate": "2020-05-27T11:10:33Z", "type": "commit"}, {"oid": "483fdd814f87497c9828e8e3bd77e364dd635a4d", "url": "https://github.com/phac-nml/irida/commit/483fdd814f87497c9828e8e3bd77e364dd635a4d", "message": "\ud83d\udcda\ufe0f Updated user doc images", "committedDate": "2020-05-27T12:11:01Z", "type": "commit"}, {"oid": "4de5cd229affbc39ee862859d043d8eaeff64989", "url": "https://github.com/phac-nml/irida/commit/4de5cd229affbc39ee862859d043d8eaeff64989", "message": "Merge branch 'development' into project-groups", "committedDate": "2020-05-29T18:37:15Z", "type": "commit"}, {"oid": "d6c2e4a64243ea0b807dfcd8178f1e25f5701cf8", "url": "https://github.com/phac-nml/irida/commit/d6c2e4a64243ea0b807dfcd8178f1e25f5701cf8", "message": ":memo: Updated CHANGELOG.md", "committedDate": "2020-05-29T18:38:49Z", "type": "commit"}]}