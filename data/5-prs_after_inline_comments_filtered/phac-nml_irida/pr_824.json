{"pr_number": 824, "pr_title": "Admin Stats UI", "pr_createdAt": "2020-10-08T18:02:41Z", "pr_url": "https://github.com/phac-nml/irida/pull/824", "timeline": [{"oid": "e96fa4e0b25402d3f12f750d03646601afa45f8d", "url": "https://github.com/phac-nml/irida/commit/e96fa4e0b25402d3f12f750d03646601afa45f8d", "message": "Added statistics page with test data for charts", "committedDate": "2020-09-25T17:10:44Z", "type": "commit"}, {"oid": "d78c9c24bd4d22c48011c1f6bb384f6aa3eae66b", "url": "https://github.com/phac-nml/irida/commit/d78c9c24bd4d22c48011c1f6bb384f6aa3eae66b", "message": "Setup the ui for basic statistics and advanced statistics. Added dtos which will be required to send stats data to the ui", "committedDate": "2020-09-30T20:55:59Z", "type": "commit"}, {"oid": "e33646faa7c998bea5e7b2d59b2353c7b8053eab", "url": "https://github.com/phac-nml/irida/commit/e33646faa7c998bea5e7b2d59b2353c7b8053eab", "message": "Refactored code and created constants for statisticTypes and chartTypes. Fixed bug with time period select not defaulting to default time period when a different stat type was viewer", "committedDate": "2020-10-01T16:54:58Z", "type": "commit"}, {"oid": "d50fd90cecace4821e13db39ff2e1d2c90e8fda2", "url": "https://github.com/phac-nml/irida/commit/d50fd90cecace4821e13db39ff2e1d2c90e8fda2", "message": "Merge branch 'admin-statistics/_base' into admin-panel-statistics", "committedDate": "2020-10-02T15:56:43Z", "type": "commit"}, {"oid": "48b9a69cc829a5590073d0a84460bf960ef25745", "url": "https://github.com/phac-nml/irida/commit/48b9a69cc829a5590073d0a84460bf960ef25745", "message": "Removed commented out code, fake data, and removed services from controller", "committedDate": "2020-10-08T14:27:31Z", "type": "commit"}, {"oid": "d0bb4e7accc672aaef6fd75c75d48b184ac5d379", "url": "https://github.com/phac-nml/irida/commit/d0bb4e7accc672aaef6fd75c75d48b184ac5d379", "message": "Merged dev into branch and fixed merge conflicts. Updated BasicStats react component to get basic stats from the adminstatisticscontext", "committedDate": "2020-10-08T15:07:45Z", "type": "commit"}, {"oid": "e5aad97784a388d339785b45facd822113f38db8", "url": "https://github.com/phac-nml/irida/commit/e5aad97784a388d339785b45facd822113f38db8", "message": "Removed Row and Cols and replaced with flex. Added Users Created Statististics", "committedDate": "2020-10-08T17:17:48Z", "type": "commit"}, {"oid": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "url": "https://github.com/phac-nml/irida/commit/4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "message": "Removed dtos not used. Added missing function to context", "committedDate": "2020-10-08T18:11:49Z", "type": "commit"}, {"oid": "d013a64c4bbff49f15a22e1b73cd95521b88a51b", "url": "https://github.com/phac-nml/irida/commit/d013a64c4bbff49f15a22e1b73cd95521b88a51b", "message": "Merge branch 'development' into admin-statistics/_ui", "committedDate": "2020-10-08T20:00:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyMTg2NA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r501921864", "bodyText": "Why scoping to the session?", "author": "joshsadam", "createdAt": "2020-10-08T18:17:54Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+\n+/**\n+ * Controller to handle ajax requests for the Admin Panel statistics page.\n+ */\n+\n+@RestController\n+@Scope(\"session\")", "originalCommit": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NTk0Mw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502465943", "bodyText": "Removed in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:27:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyMTg2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyMjc1Mw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r501922753", "bodyText": "Wouldn't a better URL scheme be top level /ajax/statistics and then every level below would be the specific one (e.g. /projects for /ajax/statistics/projects)?\n``", "author": "joshsadam", "createdAt": "2020-10-08T18:19:24Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+\n+/**\n+ * Controller to handle ajax requests for the Admin Panel statistics page.\n+ */\n+\n+@RestController\n+@Scope(\"session\")\n+@RequestMapping(\"/ajax/admin\")", "originalCommit": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjA0Nw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502466047", "bodyText": "Yup updated in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:27:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyMjc1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNDcxNw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r501924717", "bodyText": "This translation will be in the next PR?", "author": "joshsadam", "createdAt": "2020-10-08T18:22:43Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+\n+/**\n+ * Controller to handle ajax requests for the Admin Panel statistics page.\n+ */\n+\n+@RestController\n+@Scope(\"session\")\n+@RequestMapping(\"/ajax/admin\")\n+public class AdminStatisticsAjaxController {\n+\n+\t@Autowired\n+\tpublic AdminStatisticsAjaxController() {\n+\t}\n+\n+\t/**\n+\t * Get usage statistics for projects, samples, analyses, and users\n+\t * for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve usage stats for\n+\t * @return dto with usage stats\n+\t */\n+\t@RequestMapping(value = \"/statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved statistics on load\");\n+\t}\n+\n+\t/**\n+\t * Get updated usage statistics for projects for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve updated project usage stats for\n+\t * @return dto with updated project usage stats\n+\t */\n+\t@RequestMapping(value = \"/project-statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminProjectStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved stats for projects created in the last \" + timePeriod);\n+\t}\n+\n+\t/**\n+\t * Get updated usage statistics for users for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve updated user usage stats for\n+\t * @return dto with updated user usage stats\n+\t */\n+\t@RequestMapping(value = \"/user-statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminUserStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved stats for users logged in the last \" + timePeriod);\n+\t}\n+\n+\t/**\n+\t * Get updated usage statistics for analyses for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve updated analyses usage stats for\n+\t * @return dto with updated analyses usage stats\n+\t */\n+\t@RequestMapping(value = \"/analyses-statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminAnalysesStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved stats for analyses run in the last \" + timePeriod);\n+\t}\n+\n+\t/**\n+\t * Get updated usage statistics for samples for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve updated sample usage stats for\n+\t * @return dto with updated sample usage stats\n+\t */\n+\t@RequestMapping(value = \"/sample-statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminSampleStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved stats for samples created in the last \" + timePeriod);", "originalCommit": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjI2OA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502466268", "bodyText": "The translations will be added once all the branches are merged in for the statistics", "author": "deepsidhu85", "createdAt": "2020-10-09T14:27:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNDcxNw=="}], "type": "inlineReview"}, {"oid": "ff7ec157807d1b1bc99e6e65236ed77a1bcee291", "url": "https://github.com/phac-nml/irida/commit/ff7ec157807d1b1bc99e6e65236ed77a1bcee291", "message": "Changed api endpoints for statistics. Moved chart config into its own file rather than have it in the context. Refactored code", "committedDate": "2020-10-09T14:26:50Z", "type": "commit"}, {"oid": "a232353ca631dee6a88a033d3d350b33fc3d407b", "url": "https://github.com/phac-nml/irida/commit/a232353ca631dee6a88a033d3d350b33fc3d407b", "message": "Updated to use ant design charts 1.0.0. Refactored code in BasicStats component.", "committedDate": "2020-10-14T16:12:25Z", "type": "commit"}, {"oid": "aabc12d61cf03213a284be4781c734393b5c67a4", "url": "https://github.com/phac-nml/irida/commit/aabc12d61cf03213a284be4781c734393b5c67a4", "message": "Moved title from chart config into advancestatistics as new version of ant design charts no longer has a title field. Cleaned up chart config. Added a border to statistics card when hovered", "committedDate": "2020-10-14T19:16:59Z", "type": "commit"}, {"oid": "a82a9fd41e56400f006208d95d64b65927b17b8c", "url": "https://github.com/phac-nml/irida/commit/a82a9fd41e56400f006208d95d64b65927b17b8c", "message": "Added direct urls to stats for analyses, projects, samples, and users so a user can visit them via url", "committedDate": "2020-10-15T15:38:44Z", "type": "commit"}, {"oid": "f6ae5019dbec584463139ad561a5eda951e8d3e7", "url": "https://github.com/phac-nml/irida/commit/f6ae5019dbec584463139ad561a5eda951e8d3e7", "message": "Fixed logic to check which url the page is on", "committedDate": "2020-10-15T16:02:57Z", "type": "commit"}, {"oid": "e55597c169da58c3e48dcdb94c8b5c7e2eff8f08", "url": "https://github.com/phac-nml/irida/commit/e55597c169da58c3e48dcdb94c8b5c7e2eff8f08", "message": ":construction: Cleaned up routing and layout", "committedDate": "2020-10-15T17:42:18Z", "type": "commit"}, {"oid": "72d0ba92aff2b0bf3a50b1337602c938094c59e0", "url": "https://github.com/phac-nml/irida/commit/72d0ba92aff2b0bf3a50b1337602c938094c59e0", "message": "Merge pull request #828 from phac-nml/ui-stats-layout-tweaks\n\n Cleaned up routing and layout", "committedDate": "2020-10-15T20:12:02Z", "type": "commit"}, {"oid": "49131b6dd2cd47bfa40b1db41caff90046339d63", "url": "https://github.com/phac-nml/irida/commit/49131b6dd2cd47bfa40b1db41caff90046339d63", "message": "Removed files not required", "committedDate": "2020-10-15T20:24:30Z", "type": "commit"}, {"oid": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "url": "https://github.com/phac-nml/irida/commit/567cdb75bcedd68dc9d0811b02db3369cca719e4", "message": "Refactored code, renamed context file, moved constants into a constant file, changed select to radio group buttons for time period", "committedDate": "2020-10-16T13:48:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1ODE0NA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506458144", "bodyText": "Unused import", "author": "joshsadam", "createdAt": "2020-10-16T14:02:16Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,78 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;", "originalCommit": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ2OTEzMg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506469132", "bodyText": "This has been removed in the next PR", "author": "deepsidhu85", "createdAt": "2020-10-16T14:10:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1ODE0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1ODk3Ng==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506458976", "bodyText": "Your response entities should have a type associated e.g. ResponseEntity<String>", "author": "joshsadam", "createdAt": "2020-10-16T14:03:00Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,78 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+\n+/**\n+ * Controller to handle ajax requests for the Admin Panel statistics page.\n+ */\n+\n+@RestController\n+@RequestMapping(\"/ajax/statistics\")\n+public class AdminStatisticsAjaxController {\n+\n+\t@Autowired\n+\tpublic AdminStatisticsAjaxController() {\n+\t}\n+\n+\t/**\n+\t * Get usage statistics for projects, samples, analyses, and users\n+\t * for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve usage stats for\n+\t * @return dto with usage stats\n+\t */\n+\t@RequestMapping(value = \"/basic\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminStatistics(Long timePeriod) {", "originalCommit": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ2OTY0Mg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506469642", "bodyText": "This has been updated in the basic stats and advanced stats PRs that will come after this with the actual types", "author": "deepsidhu85", "createdAt": "2020-10-16T14:11:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1ODk3Ng=="}], "type": "inlineReview"}, {"oid": "6c0aba73217bab99d94702474de6064bf84e81c1", "url": "https://github.com/phac-nml/irida/commit/6c0aba73217bab99d94702474de6064bf84e81c1", "message": "Added comments, refactored logic in AdvancedStatistics component to get rid of ternary statements, updated logic for setting select menu item in admin panel, added a vertical layout to form, removed logging statement and unused import", "committedDate": "2020-10-16T16:22:41Z", "type": "commit"}, {"oid": "c1f8c5a368fc9635af43d8bbbdf5647db09ceec4", "url": "https://github.com/phac-nml/irida/commit/c1f8c5a368fc9635af43d8bbbdf5647db09ceec4", "message": "Added null check when returning a match to the regex for the url. Ignored test that is fixed in later branch", "committedDate": "2020-10-16T18:04:13Z", "type": "commit"}, {"oid": "65dc7cc5dd49918acabeaa255d74f849eeec9970", "url": "https://github.com/phac-nml/irida/commit/65dc7cc5dd49918acabeaa255d74f849eeec9970", "message": "Ignored test", "committedDate": "2020-10-16T19:19:07Z", "type": "commit"}]}