{"pr_number": 1767, "pr_title": "[JBPM-9405] Provide API method to signal process instance with correlation key", "pr_createdAt": "2020-10-05T08:03:55Z", "pr_url": "https://github.com/kiegroup/jbpm/pull/1767", "timeline": [{"oid": "d768639355ef2caac7d9ba9a36a868a53451bfbe", "url": "https://github.com/kiegroup/jbpm/commit/d768639355ef2caac7d9ba9a36a868a53451bfbe", "message": "[JBPM-9405] Provide API method to signal process instance with correlationKey", "committedDate": "2020-10-05T08:06:07Z", "type": "forcePushed"}, {"oid": "e4e776993540c438519afffa76bb686624b54224", "url": "https://github.com/kiegroup/jbpm/commit/e4e776993540c438519afffa76bb686624b54224", "message": "[JBPM-9405] Provide API method to signal process instance with correlationKey", "committedDate": "2020-10-13T07:06:13Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NjE2Mg==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r510696162", "bodyText": "Typo\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param correlationKey the process instance's unique correlation key\n          \n          \n            \n                 * @param correlationKey the process instance unique correlation key", "author": "afalhambra", "createdAt": "2020-10-23T07:44:39Z", "path": "jbpm-services/jbpm-services-api/src/main/java/org/jbpm/services/api/ProcessService.java", "diffHunk": "@@ -192,7 +192,54 @@\n      * @throws ProcessInstanceNotFoundException in case process instance with given id was not found\n      */\n     void signalProcessInstances(String deploymentId, List<Long> processInstanceIds, String signalName, Object event);\n-    \n+\n+    /**\n+     * Signal an event to a single process instance by correlation key\n+     * \n+     * @param correlationKey the process instance's unique correlation key", "originalCommit": "e4e776993540c438519afffa76bb686624b54224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI2MjE1MA==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r513262150", "bodyText": "ok", "author": "elguardian", "createdAt": "2020-10-28T08:35:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NjE2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NjUwMQ==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r510696501", "bodyText": "same typo\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param correlationKey the process instance's unique correlation key\n          \n          \n            \n                 * @param correlationKey the process instance unique correlation key", "author": "afalhambra", "createdAt": "2020-10-23T07:45:14Z", "path": "jbpm-services/jbpm-services-api/src/main/java/org/jbpm/services/api/ProcessService.java", "diffHunk": "@@ -192,7 +192,54 @@\n      * @throws ProcessInstanceNotFoundException in case process instance with given id was not found\n      */\n     void signalProcessInstances(String deploymentId, List<Long> processInstanceIds, String signalName, Object event);\n-    \n+\n+    /**\n+     * Signal an event to a single process instance by correlation key\n+     * \n+     * @param correlationKey the process instance's unique correlation key\n+     * @param signalName the signal's id in the process\n+     * @param event the event object to be passed in with the event\n+     * @throws DeploymentNotFoundException in case deployment unit was not found\n+     * @throws ProcessInstanceNotFoundException in case process instance with given id was not found\n+     */\n+    void signalProcessInstanceByCorrelationKey(CorrelationKey correlationKey, String signalName, Object event);\n+\n+    /**\n+     * Signal an event to a single process instance by correlation key\n+     * \n+     * @param deploymentId deployment that process instance belongs to\n+     * @param correlationKey the process instance's unique correlation key", "originalCommit": "e4e776993540c438519afffa76bb686624b54224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI2MjIzNw==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r513262237", "bodyText": "ok", "author": "elguardian", "createdAt": "2020-10-28T08:35:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NjUwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NzM1OQ==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r510697359", "bodyText": "deploymentId is not part of the expected arguments in the method, please remove.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param deploymentId deployment that process instance belongs to", "author": "afalhambra", "createdAt": "2020-10-23T07:46:44Z", "path": "jbpm-services/jbpm-services-api/src/main/java/org/jbpm/services/api/ProcessService.java", "diffHunk": "@@ -192,7 +192,54 @@\n      * @throws ProcessInstanceNotFoundException in case process instance with given id was not found\n      */\n     void signalProcessInstances(String deploymentId, List<Long> processInstanceIds, String signalName, Object event);\n-    \n+\n+    /**\n+     * Signal an event to a single process instance by correlation key\n+     * \n+     * @param correlationKey the process instance's unique correlation key\n+     * @param signalName the signal's id in the process\n+     * @param event the event object to be passed in with the event\n+     * @throws DeploymentNotFoundException in case deployment unit was not found\n+     * @throws ProcessInstanceNotFoundException in case process instance with given id was not found\n+     */\n+    void signalProcessInstanceByCorrelationKey(CorrelationKey correlationKey, String signalName, Object event);\n+\n+    /**\n+     * Signal an event to a single process instance by correlation key\n+     * \n+     * @param deploymentId deployment that process instance belongs to\n+     * @param correlationKey the process instance's unique correlation key\n+     * @param signalName the signal's id in the process\n+     * @param event the event object to be passed in with the event\n+     * @throws DeploymentNotFoundException in case deployment unit was not found\n+     * @throws ProcessInstanceNotFoundException in case process instance with given id was not found\n+     */\n+    void signalProcessInstanceByCorrelationKey(String deploymentId, CorrelationKey correlationKey, String signalName, Object event);\n+\n+    /**\n+     * Signal an event to given list of correlation keys\n+     * \n+     * @param deploymentId deployment that process instance belongs to", "originalCommit": "e4e776993540c438519afffa76bb686624b54224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI2MjQ1Mw==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r513262453", "bodyText": "removed", "author": "elguardian", "createdAt": "2020-10-28T08:36:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NzM1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcxNTU4OQ==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r510715589", "bodyText": "same as above", "author": "afalhambra", "createdAt": "2020-10-23T08:19:53Z", "path": "jbpm-services/jbpm-kie-services/src/main/java/org/jbpm/kie/services/impl/ProcessServiceImpl.java", "diffHunk": "@@ -295,6 +295,43 @@ public void signalProcessInstances(String deploymentId, List<Long> processInstan\n \n     }\n \n+    @Override\n+    public void signalProcessInstanceByCorrelationKey(CorrelationKey correlationKey, String signalName, Object event) {\n+        ProcessInstanceDesc pi = dataService.getProcessInstanceByCorrelationKey(correlationKey);\n+        if(pi == null) {\n+            throw new ProcessInstanceNotFoundException(\"Process with correlation key \" + correlationKey + \" not found\");\n+        }\n+        signalProcessInstance(pi.getId(), signalName, event);\n+        \n+    }\n+\n+    @Override\n+    public void signalProcessInstanceByCorrelationKey(String deploymentId,\n+                                                      CorrelationKey correlationKey,\n+                                                      String signalName,\n+                                                      Object event) {\n+        ProcessInstanceDesc pi = dataService.getProcessInstanceByCorrelationKey(correlationKey);\n+        if(pi == null) {\n+            throw new ProcessInstanceNotFoundException(\"Process with correlation key \" + correlationKey + \" not found\");\n+        }\n+        signalProcessInstance(deploymentId, pi.getId(), signalName, event);\n+    }\n+\n+    @Override\n+    public void signalProcessInstancesByCorrelationKeys(List<CorrelationKey> correlationKeys, String signalName, Object event) {\n+        correlationKeys.forEach(key -> signalProcessInstanceByCorrelationKey(key, signalName, event));\n+    }\n+\n+    @Override\n+    public void signalProcessInstancesByCorrelationKeys(String deploymentId,\n+                                                        List<CorrelationKey> correlationKeys,\n+                                                        String signalName,\n+                                                        Object event) {\n+\n+        correlationKeys.forEach(key -> signalProcessInstanceByCorrelationKey(deploymentId, key, signalName, event));", "originalCommit": "e4e776993540c438519afffa76bb686624b54224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI2NDA1MA==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r513264050", "bodyText": "ok", "author": "elguardian", "createdAt": "2020-10-28T08:39:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcxNTU4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcxNzEyOA==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r510717128", "bodyText": "correlationKeys might be null - maybe it's worth testing it before calling forEach", "author": "afalhambra", "createdAt": "2020-10-23T08:22:29Z", "path": "jbpm-services/jbpm-kie-services/src/main/java/org/jbpm/kie/services/impl/ProcessServiceImpl.java", "diffHunk": "@@ -295,6 +295,43 @@ public void signalProcessInstances(String deploymentId, List<Long> processInstan\n \n     }\n \n+    @Override\n+    public void signalProcessInstanceByCorrelationKey(CorrelationKey correlationKey, String signalName, Object event) {\n+        ProcessInstanceDesc pi = dataService.getProcessInstanceByCorrelationKey(correlationKey);\n+        if(pi == null) {\n+            throw new ProcessInstanceNotFoundException(\"Process with correlation key \" + correlationKey + \" not found\");\n+        }\n+        signalProcessInstance(pi.getId(), signalName, event);\n+        \n+    }\n+\n+    @Override\n+    public void signalProcessInstanceByCorrelationKey(String deploymentId,\n+                                                      CorrelationKey correlationKey,\n+                                                      String signalName,\n+                                                      Object event) {\n+        ProcessInstanceDesc pi = dataService.getProcessInstanceByCorrelationKey(correlationKey);\n+        if(pi == null) {\n+            throw new ProcessInstanceNotFoundException(\"Process with correlation key \" + correlationKey + \" not found\");\n+        }\n+        signalProcessInstance(deploymentId, pi.getId(), signalName, event);\n+    }\n+\n+    @Override\n+    public void signalProcessInstancesByCorrelationKeys(List<CorrelationKey> correlationKeys, String signalName, Object event) {\n+        correlationKeys.forEach(key -> signalProcessInstanceByCorrelationKey(key, signalName, event));", "originalCommit": "e4e776993540c438519afffa76bb686624b54224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI2Mzc4MA==", "url": "https://github.com/kiegroup/jbpm/pull/1767#discussion_r513263780", "bodyText": "ok", "author": "elguardian", "createdAt": "2020-10-28T08:38:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcxNzEyOA=="}], "type": "inlineReview"}, {"oid": "f19e35dccda87369446687330b14cb3536cbc877", "url": "https://github.com/kiegroup/jbpm/commit/f19e35dccda87369446687330b14cb3536cbc877", "message": "[JBPM-9405] Provide API method to signal process instance with correlationKey", "committedDate": "2020-10-28T10:09:15Z", "type": "commit"}, {"oid": "f19e35dccda87369446687330b14cb3536cbc877", "url": "https://github.com/kiegroup/jbpm/commit/f19e35dccda87369446687330b14cb3536cbc877", "message": "[JBPM-9405] Provide API method to signal process instance with correlationKey", "committedDate": "2020-10-28T10:09:15Z", "type": "forcePushed"}]}