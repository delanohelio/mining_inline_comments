{"pr_number": 1694, "pr_title": "[RHPAM-2796] Test for aborted type task when aborting process", "pr_createdAt": "2020-07-06T09:04:20Z", "pr_url": "https://github.com/kiegroup/jbpm/pull/1694", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NTI5MQ==", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r450695291", "bodyText": "I think below message is slightly clearer. I removed Active cause I understand that it might be in a different status other than Active? wdyt?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    assertEquals(\"Active task node instance when aborting process should be at ABORTED type -2-\", \n          \n          \n            \n                    assertEquals(\"Task node instance when aborting process should be in ABORTED status (2)\",", "author": "afalhambra", "createdAt": "2020-07-07T08:28:47Z", "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "diffHunk": "@@ -106,4 +108,23 @@ public void setAuditLogServiceForCommandTest() {\n         processInstances = setAuditLogServiceAndExecute(new FindProcessInstancesCommand(PROCESS_ID));\n         assertEquals(0, processInstances.size());\n     }\n+    \n+    @Test\n+    public void whenAbortingProcess_activeTaskShouldBeAtAbortedType() { \n+        String PROCESS_ID = \"com.sample.ruleflow4\";\n+        // start process instance\n+        long processInstanceId = ksession.startProcess(PROCESS_ID).getId();\n+        \n+        logger.info(\"Checking process instances for process '{}' before aborting\", PROCESS_ID);\n+       \n+        ksession.abortProcessInstance(processInstanceId);\n+        \n+        List<NodeInstanceLog> nodeInstances = auditLogService.findNodeInstances(processInstanceId);\n+        \n+        assertEquals(\"There should be 4 node instances\", 4, nodeInstances.size());\n+        assertEquals(\"Active task node instance when aborting process should be at ABORTED type -2-\", ", "originalCommit": "f5a762bedb3949f95a55ed07cdb12902423a48c5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE4OTg2OA==", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r451189868", "bodyText": "Done", "author": "gmunozfe", "createdAt": "2020-07-07T22:58:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NTI5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NzYxMQ==", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r450697611", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ksession.getWorkItemManager().registerWorkItemHandler(\"No completed task\", new DoNothingWorkItemHandler());\n          \n          \n            \n                    ksession.getWorkItemManager().registerWorkItemHandler(\"Not completed task\", new DoNothingWorkItemHandler());", "author": "afalhambra", "createdAt": "2020-07-07T08:32:29Z", "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "diffHunk": "@@ -59,7 +60,8 @@ public void setUp() throws Exception {\n         ksession = createKieSession(kbase, env);\n         new JPAWorkingMemoryDbLogger(ksession);\n         ksession.getWorkItemManager().registerWorkItemHandler(\"Human Task\", new SystemOutWorkItemHandler());\n-       \n+        //Register a workitem that does not complete it when executed\n+        ksession.getWorkItemManager().registerWorkItemHandler(\"No completed task\", new DoNothingWorkItemHandler());", "originalCommit": "f5a762bedb3949f95a55ed07cdb12902423a48c5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE5MDYyMQ==", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r451190621", "bodyText": "Done", "author": "gmunozfe", "createdAt": "2020-07-07T23:00:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NzYxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDcxNTAzNQ==", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r450715035", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void whenAbortingProcess_activeTaskShouldBeAtAbortedType() { \n          \n          \n            \n                public void whenAbortingProcessTaskShouldBeInAbortedStatus() {", "author": "afalhambra", "createdAt": "2020-07-07T09:00:42Z", "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "diffHunk": "@@ -106,4 +108,23 @@ public void setAuditLogServiceForCommandTest() {\n         processInstances = setAuditLogServiceAndExecute(new FindProcessInstancesCommand(PROCESS_ID));\n         assertEquals(0, processInstances.size());\n     }\n+    \n+    @Test\n+    public void whenAbortingProcess_activeTaskShouldBeAtAbortedType() { ", "originalCommit": "f5a762bedb3949f95a55ed07cdb12902423a48c5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE5MTU1Nw==", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r451191557", "bodyText": "Done", "author": "gmunozfe", "createdAt": "2020-07-07T23:04:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDcxNTAzNQ=="}], "type": "inlineReview"}, {"oid": "04bed3c3cb45f296a0844e86f7130e5bff7d24aa", "url": "https://github.com/kiegroup/jbpm/commit/04bed3c3cb45f296a0844e86f7130e5bff7d24aa", "message": "[RHPAM-2796] Test for aborted type task when aborting process", "committedDate": "2020-07-07T23:03:19Z", "type": "commit"}, {"oid": "04bed3c3cb45f296a0844e86f7130e5bff7d24aa", "url": "https://github.com/kiegroup/jbpm/commit/04bed3c3cb45f296a0844e86f7130e5bff7d24aa", "message": "[RHPAM-2796] Test for aborted type task when aborting process", "committedDate": "2020-07-07T23:03:19Z", "type": "forcePushed"}]}