{"pr_number": 3009, "pr_title": "Add Thrift example", "pr_createdAt": "2020-08-20T04:44:07Z", "pr_url": "https://github.com/line/armeria/pull/3009", "timeline": [{"oid": "3a49e4f8df9e18e4aaec89f8ddaee3dc94ad6001", "url": "https://github.com/line/armeria/commit/3a49e4f8df9e18e4aaec89f8ddaee3dc94ad6001", "message": "Add Thrift example\n\nMotivation:\n\nA Thrift example with `armeria-thrift*` is not offered officially.\n\nModifications:\n\n- Add Thrift example\n\nResult:\n\nClose #2978", "committedDate": "2020-08-20T04:43:25Z", "type": "commit"}, {"oid": "8f7adb202dbdbbc9f658bb31f06cb6499af8ffa9", "url": "https://github.com/line/armeria/commit/8f7adb202dbdbbc9f658bb31f06cb6499af8ffa9", "message": "Rename thrift-example to thrift", "committedDate": "2020-08-20T06:28:11Z", "type": "commit"}, {"oid": "8f7adb202dbdbbc9f658bb31f06cb6499af8ffa9", "url": "https://github.com/line/armeria/commit/8f7adb202dbdbbc9f658bb31f06cb6499af8ffa9", "message": "Rename thrift-example to thrift", "committedDate": "2020-08-20T06:28:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY5OTg1Ng==", "url": "https://github.com/line/armeria/pull/3009#discussion_r473699856", "bodyText": "You don't need to specify class and method name for Thrift examples. Can use ..._args.", "author": "trustin", "createdAt": "2020-08-20T07:35:15Z", "path": "examples/thrift/src/main/java/example/armeria/thrift/Main.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package example.armeria.thrift;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import com.linecorp.armeria.server.Server;\n+import com.linecorp.armeria.server.docs.DocService;\n+import com.linecorp.armeria.server.thrift.THttpService;\n+\n+public final class Main {\n+\n+    private static final Logger logger = LoggerFactory.getLogger(Main.class);\n+\n+    public static void main(String[] args) throws Exception {\n+        final Server server = newServer(8080, 8443);\n+\n+        Runtime.getRuntime().addShutdownHook(new Thread(() -> {\n+            server.stop().join();\n+            logger.info(\"Server has been stopped.\");\n+        }));\n+\n+        server.start().join();\n+\n+        logger.info(\"Server has been started. Serving DocService at http://127.0.0.1:{}/docs\",\n+                    server.activeLocalPort());\n+    }\n+\n+    static Server newServer(int httpPort, int httpsPort) throws Exception {\n+        final HelloRequest exampleRequest = new HelloRequest(\"Armeria\");\n+        final THttpService thriftService =\n+                THttpService.builder()\n+                            .addService(new HelloServiceImpl())\n+                            .build();\n+        return Server.builder()\n+                     .http(httpPort)\n+                     .https(httpsPort)\n+                     .tlsSelfSigned()\n+                     .service(\"/\", thriftService)\n+                     // You can access the documentation service at http://127.0.0.1:8080/docs.\n+                     // See https://armeria.dev/docs/server-docservice for more information.\n+                     .serviceUnder(\"/docs\",\n+                                   DocService.builder()\n+                                             .exampleRequests(HelloService.class, \"hello\", exampleRequest)\n+                                             .exampleRequests(HelloService.class, \"lazyHello\", exampleRequest)\n+                                             .exampleRequests(HelloService.class, \"blockingHello\",\n+                                                              exampleRequest)\n+                                             .build())", "originalCommit": "8f7adb202dbdbbc9f658bb31f06cb6499af8ffa9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM2NTY5Ng==", "url": "https://github.com/line/armeria/pull/3009#discussion_r474365696", "bodyText": "Oops...", "author": "ikhoon", "createdAt": "2020-08-21T01:59:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY5OTg1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM3MzA4OA==", "url": "https://github.com/line/armeria/pull/3009#discussion_r474373088", "bodyText": "Fixed.", "author": "ikhoon", "createdAt": "2020-08-21T02:28:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY5OTg1Ng=="}], "type": "inlineReview"}, {"oid": "9678cd883cc75828c998cb8346e9225e72cc4425", "url": "https://github.com/line/armeria/commit/9678cd883cc75828c998cb8346e9225e72cc4425", "message": "Address comments by @minwoox and @trustin", "committedDate": "2020-08-21T02:25:19Z", "type": "commit"}]}