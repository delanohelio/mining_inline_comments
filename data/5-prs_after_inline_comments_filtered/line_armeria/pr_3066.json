{"pr_number": 3066, "pr_title": "Fix bug where TimeoutScheduler is intialized more than once", "pr_createdAt": "2020-09-17T12:07:25Z", "pr_url": "https://github.com/line/armeria/pull/3066", "timeline": [{"oid": "855d88e2bb677b8d1a73e9fa33167a24872abc94", "url": "https://github.com/line/armeria/commit/855d88e2bb677b8d1a73e9fa33167a24872abc94", "message": "Fix bug where TimeoutScheduler is intialized more than once\n\nMotivation:\n\nA `TimeoutScheduler` could be intialized various points such as:\n- HttpResponseSubscriber.operationComplete()\n- Http1ResposneDecoder.channelRead() with `NEED_HEADERS` status\n\nWe need a guard to make sure that a TimeoutScheduler is initialized once.\n\nModifications:\n\n- Check state before initializing TimeoutScheduler.\n\nResult:\n\nA TimeoutScheduler is initialized exactly once event if it is called muliple times", "committedDate": "2020-09-17T11:55:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY5NTE0OQ==", "url": "https://github.com/line/armeria/pull/3066#discussion_r491695149", "bodyText": "initializeOnlyOnce()?", "author": "trustin", "createdAt": "2020-09-20T14:09:28Z", "path": "core/src/test/java/com/linecorp/armeria/internal/common/TimeoutSchedulerTest.java", "diffHunk": "@@ -340,6 +341,22 @@ void evaluatePendingTimeout() {\n         await().untilTrue(completed);\n     }\n \n+    @Test\n+    void initializeOnce() {", "originalCommit": "855d88e2bb677b8d1a73e9fa33167a24872abc94", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6d230721e033c01246d5e089c5735518f5b01284", "url": "https://github.com/line/armeria/commit/6d230721e033c01246d5e089c5735518f5b01284", "message": "Update TimeoutSchedulerTest.java", "committedDate": "2020-09-20T14:10:14Z", "type": "commit"}, {"oid": "cf34c7be84832afc29500864520bf038e4b05b3f", "url": "https://github.com/line/armeria/commit/cf34c7be84832afc29500864520bf038e4b05b3f", "message": "Fix ClientFatory leak in test", "committedDate": "2020-09-20T17:01:08Z", "type": "commit"}, {"oid": "84d88c96ac243da5b625ad78b0ef976b259c3ba9", "url": "https://github.com/line/armeria/commit/84d88c96ac243da5b625ad78b0ef976b259c3ba9", "message": "Address comments by @minwoox", "committedDate": "2020-09-21T06:05:17Z", "type": "commit"}]}