{"pr_number": 7306, "pr_title": "Change color chart from Map to List of Value Class ", "pr_createdAt": "2020-01-28T08:41:04Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/7306", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY3NjUxMQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/7306#discussion_r371676511", "bodyText": "IMO the previous naming (chartColors) was slightly better.", "author": "dennisoelkers", "createdAt": "2020-01-28T09:02:49Z", "path": "graylog2-server/src/main/java/org/graylog/plugins/views/search/views/widgets/aggregation/WidgetFormattingSettings.java", "diffHunk": "@@ -22,27 +22,27 @@\n import com.google.auto.value.AutoValue;\n \n import java.util.Collections;\n-import java.util.Map;\n+import java.util.List;\n \n @AutoValue\n @JsonDeserialize(builder = WidgetFormattingSettings.Builder.class)\n public abstract class WidgetFormattingSettings {\n     private static final String FIELD_CHART_COLORS = \"chart_colors\";\n \n     @JsonProperty(FIELD_CHART_COLORS)\n-    public abstract Map<String, ChartColor> chartColors();\n+    public abstract List<ChartColorSetting> chartColorSettings();", "originalCommit": "ba58a5fffa0488c9fd734e1b5fbbeceff343b8d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY3NjY5Mg==", "url": "https://github.com/Graylog2/graylog2-server/pull/7306#discussion_r371676692", "bodyText": "Maybe ChartColorMapping captures the purpose of this class better?", "author": "dennisoelkers", "createdAt": "2020-01-28T09:03:17Z", "path": "graylog2-server/src/main/java/org/graylog/plugins/views/search/views/widgets/aggregation/ChartColorSetting.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package org.graylog.plugins.views.search.views.widgets.aggregation;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.fasterxml.jackson.databind.annotation.JsonDeserialize;\n+import com.google.auto.value.AutoValue;\n+\n+@AutoValue\n+@JsonDeserialize(builder = ChartColorSetting.Builder.class)\n+public abstract class ChartColorSetting {", "originalCommit": "ba58a5fffa0488c9fd734e1b5fbbeceff343b8d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e89841b86f1ecce5b54011f6c5caf3d502bf3147", "url": "https://github.com/Graylog2/graylog2-server/commit/e89841b86f1ecce5b54011f6c5caf3d502bf3147", "message": "Change data structure in WidgetFormattingSetting\n\nPrior to this change, the data structure to store\nWidgetFormattingSettings did use the \"user input\" for storing a map.\nBut mongodb does not allow to store keys with dot in the map.\n\nThis change will change the data structure from a map to a list\nof objects. That way mongodb does not need to store the keys.", "committedDate": "2020-01-28T10:22:05Z", "type": "commit"}, {"oid": "6543da1b6cf704001461e7cf5dafdd9034044916", "url": "https://github.com/Graylog2/graylog2-server/commit/6543da1b6cf704001461e7cf5dafdd9034044916", "message": "Migrate existing data structures for color charts\n\nPrior to this change, we changed the data structure of color charts\nfrom a generic Map to auto value classes. This change prevents\nexisting installations to run.\n\nThis change will migrate the existing datastructures in the mongodb\nto the new auto value classes.", "committedDate": "2020-01-28T10:22:05Z", "type": "commit"}, {"oid": "f1846ae2412022fe66f71683760eff2143a426e4", "url": "https://github.com/Graylog2/graylog2-server/commit/f1846ae2412022fe66f71683760eff2143a426e4", "message": "Add missing licenses", "committedDate": "2020-01-28T10:22:05Z", "type": "commit"}, {"oid": "bf1209e9a256fe3be8c63fd5d34eac6ca171b98a", "url": "https://github.com/Graylog2/graylog2-server/commit/bf1209e9a256fe3be8c63fd5d34eac6ca171b98a", "message": "Fix annotations from @dennisoelkers", "committedDate": "2020-01-28T10:22:05Z", "type": "commit"}, {"oid": "297a7aa00e5498d25f92c0bb4a38878eb9aca785", "url": "https://github.com/Graylog2/graylog2-server/commit/297a7aa00e5498d25f92c0bb4a38878eb9aca785", "message": "Add more tests", "committedDate": "2020-01-28T10:22:05Z", "type": "commit"}, {"oid": "297a7aa00e5498d25f92c0bb4a38878eb9aca785", "url": "https://github.com/Graylog2/graylog2-server/commit/297a7aa00e5498d25f92c0bb4a38878eb9aca785", "message": "Add more tests", "committedDate": "2020-01-28T10:22:05Z", "type": "forcePushed"}]}