{"pr_number": 9469, "pr_title": "Track appearance", "pr_createdAt": "2020-07-17T08:39:42Z", "pr_url": "https://github.com/osmandapp/OsmAnd/pull/9469", "timeline": [{"oid": "d88bf79930c54355d1aa2824a4b559b302280f05", "url": "https://github.com/osmandapp/OsmAnd/commit/d88bf79930c54355d1aa2824a4b559b302280f05", "message": "Track appearance screen first part", "committedDate": "2020-07-13T16:17:34Z", "type": "commit"}, {"oid": "67d2166d0fb6cb8f6304b620a7c94d521f2bc0db", "url": "https://github.com/osmandapp/OsmAnd/commit/67d2166d0fb6cb8f6304b620a7c94d521f2bc0db", "message": "Move GpxSplitType and GradientScaleType to android module", "committedDate": "2020-07-14T08:49:44Z", "type": "commit"}, {"oid": "bd54b829efdfce06082ce330652ccfe4ab4b14a7", "url": "https://github.com/osmandapp/OsmAnd/commit/bd54b829efdfce06082ce330652ccfe4ab4b14a7", "message": "Add solid gradient scale type and track coloring card", "committedDate": "2020-07-14T12:00:34Z", "type": "commit"}, {"oid": "e5c61ddc8b91ba447fff7eac34ee63dcdccc4989", "url": "https://github.com/osmandapp/OsmAnd/commit/e5c61ddc8b91ba447fff7eac34ee63dcdccc4989", "message": "Remove track color setting from TrackActivityFragmentAdapter", "committedDate": "2020-07-14T14:31:21Z", "type": "commit"}, {"oid": "1eb20f7dfa3900d097b5e59227bfab50adedb341", "url": "https://github.com/osmandapp/OsmAnd/commit/1eb20f7dfa3900d097b5e59227bfab50adedb341", "message": "Add split interval card and bottom sheet", "committedDate": "2020-07-14T17:59:08Z", "type": "commit"}, {"oid": "620b8215127c5ceacf360c17dfe448ade1147eea", "url": "https://github.com/osmandapp/OsmAnd/commit/620b8215127c5ceacf360c17dfe448ade1147eea", "message": "Add radio group instead of simple buttons", "committedDate": "2020-07-15T06:24:52Z", "type": "commit"}, {"oid": "6773ef50310fa21e7363cd3067c2b1172a713cfd", "url": "https://github.com/osmandapp/OsmAnd/commit/6773ef50310fa21e7363cd3067c2b1172a713cfd", "message": "Move SaveGpxAsyncTask to separate file and remove duplicates", "committedDate": "2020-07-15T10:45:41Z", "type": "commit"}, {"oid": "fce394f3f7335ccb49e9e9976acdf4d625ed3554", "url": "https://github.com/osmandapp/OsmAnd/commit/fce394f3f7335ccb49e9e9976acdf4d625ed3554", "message": "Add trackDrawInfo for drawing unsaved gpx parameters", "committedDate": "2020-07-15T10:47:18Z", "type": "commit"}, {"oid": "debe7d19527e59aabf2f2c7137a3cf720fa36fad", "url": "https://github.com/osmandapp/OsmAnd/commit/debe7d19527e59aabf2f2c7137a3cf720fa36fad", "message": "Save gpx appearance changes to db", "committedDate": "2020-07-15T12:27:30Z", "type": "commit"}, {"oid": "ed1db1978ae8e96fb279f5e76651f66cbcd8da8b", "url": "https://github.com/osmandapp/OsmAnd/commit/ed1db1978ae8e96fb279f5e76651f66cbcd8da8b", "message": "Save track appearance params on orientation change", "committedDate": "2020-07-15T13:20:15Z", "type": "commit"}, {"oid": "0e69e7cadfb52326808ba55c59c1eb71580d8ae7", "url": "https://github.com/osmandapp/OsmAnd/commit/0e69e7cadfb52326808ba55c59c1eb71580d8ae7", "message": "Discard split track changes", "committedDate": "2020-07-16T08:52:49Z", "type": "commit"}, {"oid": "d8f7adc0232693ee4ca43f45fd2a3b3851f21af3", "url": "https://github.com/osmandapp/OsmAnd/commit/d8f7adc0232693ee4ca43f45fd2a3b3851f21af3", "message": "Show track appearance fragment from track activity", "committedDate": "2020-07-16T10:33:55Z", "type": "commit"}, {"oid": "4b4100cf0d8f9d2dae390428d25a74159b70940f", "url": "https://github.com/osmandapp/OsmAnd/commit/4b4100cf0d8f9d2dae390428d25a74159b70940f", "message": "Merge branch 'master' into track_appearance", "committedDate": "2020-07-16T10:50:13Z", "type": "commit"}, {"oid": "0df0d3894b9c126b8357a498897a227c5716a4e3", "url": "https://github.com/osmandapp/OsmAnd/commit/0df0d3894b9c126b8357a498897a227c5716a4e3", "message": "UI fixes first part", "committedDate": "2020-07-16T11:58:06Z", "type": "commit"}, {"oid": "13e959a6cdcba9b9e1d387e1654008f2e1fbf89d", "url": "https://github.com/osmandapp/OsmAnd/commit/13e959a6cdcba9b9e1d387e1654008f2e1fbf89d", "message": "UI fixes second part", "committedDate": "2020-07-16T13:37:46Z", "type": "commit"}, {"oid": "16e9c3f4af7d5460cb62a0748c7adc64ce33bc95", "url": "https://github.com/osmandapp/OsmAnd/commit/16e9c3f4af7d5460cb62a0748c7adc64ce33bc95", "message": "Add track direction arrows", "committedDate": "2020-07-17T08:37:37Z", "type": "commit"}, {"oid": "e47d638027e378fb3c1f93ecbff1fa223b23137a", "url": "https://github.com/osmandapp/OsmAnd/commit/e47d638027e378fb3c1f93ecbff1fa223b23137a", "message": "Fix track selection for appearance screen", "committedDate": "2020-07-17T09:13:09Z", "type": "commit"}, {"oid": "2008eaa9c18020a85448dbd4ad2aaf41df50ddc8", "url": "https://github.com/osmandapp/OsmAnd/commit/2008eaa9c18020a85448dbd4ad2aaf41df50ddc8", "message": "Fix remove unnecessary code and fix track color update", "committedDate": "2020-07-17T09:53:11Z", "type": "commit"}, {"oid": "a5b7caf716c144ca9cd7172d4c1396fb178b97c9", "url": "https://github.com/osmandapp/OsmAnd/commit/a5b7caf716c144ca9cd7172d4c1396fb178b97c9", "message": "Show start and finish icons for every track segment", "committedDate": "2020-07-17T14:02:30Z", "type": "commit"}, {"oid": "5be8902e029a5897e545adc78466ca04ad64856a", "url": "https://github.com/osmandapp/OsmAnd/commit/5be8902e029a5897e545adc78466ca04ad64856a", "message": "Merge branch 'master' into track_appearance\n\n# Conflicts:\n#\tOsmAnd/res/values-ru/strings.xml\n#\tOsmAnd/res/values/strings.xml\n#\tOsmAnd/src/net/osmand/plus/views/GPXLayer.java\n#\tOsmAnd/src/net/osmand/plus/views/RouteLayer.java", "committedDate": "2020-07-20T14:30:15Z", "type": "commit"}, {"oid": "de5e1610956fce35832f185f0ada9a84b7f58823", "url": "https://github.com/osmandapp/OsmAnd/commit/de5e1610956fce35832f185f0ada9a84b7f58823", "message": "Track appearance fixes", "committedDate": "2020-07-20T14:37:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzkxNDc0Mw==", "url": "https://github.com/osmandapp/OsmAnd/pull/9469#discussion_r457914743", "bodyText": "Methods for getting Type by name must be in enums!\nGradientScaleType\nGpxSplitType", "author": "max-klaus", "createdAt": "2020-07-21T08:08:56Z", "path": "OsmAnd/src/net/osmand/plus/GPXDatabase.java", "diffHunk": "@@ -201,17 +202,34 @@ public GpxDataItem(File file, int color) {\n \n \t\tpublic GpxDataItem(File file, @NonNull GPXFile gpxFile) {\n \t\t\tthis.file = file;\n+\t\t\treadGpxParams(gpxFile);\n+\t\t}\n+\n+\t\tprivate void readGpxParams(GPXFile gpxFile) {\n \t\t\tcolor = gpxFile.getColor(0);\n \t\t\twidth = gpxFile.getWidth(null);\n \t\t\tshowArrows = gpxFile.isShowArrows();\n \t\t\tshowStartFinish = gpxFile.isShowStartFinish();\n-\t\t\tgradientScaleType = gpxFile.getGradientScaleType();\n-\t\t\tgradientSpeedColor = gpxFile.getGradientScaleColor(GradientScaleType.SPEED, 0);\n-\t\t\tgradientSlopeColor = gpxFile.getGradientScaleColor(GradientScaleType.SLOPE, 0);\n-\t\t\tgradientAltitudeColor = gpxFile.getGradientScaleColor(GradientScaleType.ALTITUDE, 0);\n-\t\t\tif (gpxFile.getSplitType() != null && gpxFile.getSplitInterval() != 0) {\n-\t\t\t\tsplitType = gpxFile.getSplitType().getType();\n-\t\t\t\tsplitInterval = gpxFile.getSplitInterval();\n+\t\t\tgradientSpeedColor = gpxFile.getGradientScaleColor(GradientScaleType.SPEED.getTypeName(), 0);\n+\t\t\tgradientSlopeColor = gpxFile.getGradientScaleColor(GradientScaleType.SLOPE.getTypeName(), 0);\n+\t\t\tgradientAltitudeColor = gpxFile.getGradientScaleColor(GradientScaleType.ALTITUDE.getTypeName(), 0);\n+\n+\t\t\tif (!Algorithms.isEmpty(gpxFile.getSplitType()) && gpxFile.getSplitInterval() != 0) {\n+\t\t\t\tfor (GpxSplitType gpxSplitType : GpxSplitType.values()) {\n+\t\t\t\t\tif (gpxSplitType.name().equalsIgnoreCase(gpxFile.getSplitType())) {", "originalCommit": "de5e1610956fce35832f185f0ada9a84b7f58823", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk4NDgwMw==", "url": "https://github.com/osmandapp/OsmAnd/pull/9469#discussion_r457984803", "bodyText": "Methods added to enums.", "author": "Chumva", "createdAt": "2020-07-21T10:07:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzkxNDc0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzkxNTQ1Mw==", "url": "https://github.com/osmandapp/OsmAnd/pull/9469#discussion_r457915453", "bodyText": "Introduce typeName for GpxSplitType", "author": "max-klaus", "createdAt": "2020-07-21T08:10:11Z", "path": "OsmAnd/src/net/osmand/plus/GpxSelectionHelper.java", "diffHunk": "@@ -650,16 +645,16 @@ private SelectedGpxFile selectGpxFileImpl(GPXFile gpx, GpxDataItem dataItem, boo\n \t\t\t\t\t\tgpx.setColor(dataItem.getColor());\n \t\t\t\t\t}\n \t\t\t\t\tif (dataItem.getGradientSpeedColor() != 0) {\n-\t\t\t\t\t\tgpx.setGradientScaleColor(GradientScaleType.SPEED, dataItem.getGradientSpeedColor());\n+\t\t\t\t\t\tgpx.setGradientScaleColor(GradientScaleType.SPEED.getTypeName(), dataItem.getGradientSpeedColor());\n \t\t\t\t\t}\n \t\t\t\t\tif (dataItem.getGradientAltitudeColor() != 0) {\n-\t\t\t\t\t\tgpx.setGradientScaleColor(GradientScaleType.ALTITUDE, dataItem.getGradientAltitudeColor());\n+\t\t\t\t\t\tgpx.setGradientScaleColor(GradientScaleType.ALTITUDE.getTypeName(), dataItem.getGradientAltitudeColor());\n \t\t\t\t\t}\n \t\t\t\t\tif (dataItem.getGradientSlopeColor() != 0) {\n-\t\t\t\t\t\tgpx.setGradientScaleColor(GradientScaleType.SLOPE, dataItem.getGradientSlopeColor());\n+\t\t\t\t\t\tgpx.setGradientScaleColor(GradientScaleType.SLOPE.getTypeName(), dataItem.getGradientSlopeColor());\n \t\t\t\t\t}\n \t\t\t\t\tif (dataItem.getGradientScaleType() != null) {\n-\t\t\t\t\t\tgpx.setGradientScaleType(dataItem.getGradientScaleType());\n+\t\t\t\t\t\tgpx.setGradientScaleType(dataItem.getGradientScaleType().name());", "originalCommit": "de5e1610956fce35832f185f0ada9a84b7f58823", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3cab3ffa9164a7b984db4ecd5f3872976b5b3543", "url": "https://github.com/osmandapp/OsmAnd/commit/3cab3ffa9164a7b984db4ecd5f3872976b5b3543", "message": "Introduce typeName for GpxSplitType and add getters for GpxSplitType and GradientScaleType", "committedDate": "2020-07-21T08:52:43Z", "type": "commit"}]}