{"pr_number": 2331, "pr_title": "Add MekLocation tests", "pr_createdAt": "2020-12-28T20:27:42Z", "pr_url": "https://github.com/MegaMek/mekhq/pull/2331", "timeline": [{"oid": "2d1d11f0bae48ecaa69cf58a9eb7d957a3721798", "url": "https://github.com/MegaMek/mekhq/commit/2d1d11f0bae48ecaa69cf58a9eb7d957a3721798", "message": "Add basic MekLocation::updateConditionFromEntity test", "committedDate": "2020-12-29T19:44:21Z", "type": "forcePushed"}, {"oid": "ca6b6ac2cd1b7bce282865f0e18e52ee05b7c36d", "url": "https://github.com/MegaMek/mekhq/commit/ca6b6ac2cd1b7bce282865f0e18e52ee05b7c36d", "message": "Add some checkFixable and checkSalvagable tests", "committedDate": "2020-12-30T21:02:39Z", "type": "forcePushed"}, {"oid": "93b30ee17a69de53da16997665e990831c2dabd1", "url": "https://github.com/MegaMek/mekhq/commit/93b30ee17a69de53da16997665e990831c2dabd1", "message": "Move Part::findPartImage into GUI namespace", "committedDate": "2021-01-02T19:01:11Z", "type": "commit"}, {"oid": "271e65c6998b2bbfab63cf1922caa829510ccea5", "url": "https://github.com/MegaMek/mekhq/commit/271e65c6998b2bbfab63cf1922caa829510ccea5", "message": "Add basic MekLocation tests", "committedDate": "2021-01-02T19:01:11Z", "type": "commit"}, {"oid": "cb2bd0e37db6a537d43cc1c1df571cc990325c23", "url": "https://github.com/MegaMek/mekhq/commit/cb2bd0e37db6a537d43cc1c1df571cc990325c23", "message": "Fix test issue", "committedDate": "2021-01-02T19:01:11Z", "type": "commit"}, {"oid": "3b501d59d9a02157c595dbfe0832133fe39e59a7", "url": "https://github.com/MegaMek/mekhq/commit/3b501d59d9a02157c595dbfe0832133fe39e59a7", "message": "Add MekLocation::writeToXml test", "committedDate": "2021-01-02T19:01:12Z", "type": "commit"}, {"oid": "a4dc1f1b7eeae990cbe1ba2c667940dc4ab2eae9", "url": "https://github.com/MegaMek/mekhq/commit/a4dc1f1b7eeae990cbe1ba2c667940dc4ab2eae9", "message": "Remove duplicated code in MekLocation::loadFieldsFromXmlNode", "committedDate": "2021-01-02T19:01:12Z", "type": "commit"}, {"oid": "2b2916b9175bdd4e639d5de1c7fe5559e989a2a6", "url": "https://github.com/MegaMek/mekhq/commit/2b2916b9175bdd4e639d5de1c7fe5559e989a2a6", "message": "Add MekLocation::isSamePartType test", "committedDate": "2021-01-02T19:01:12Z", "type": "commit"}, {"oid": "2802536584bfd28a80056b85a7db2e13f53bd4ce", "url": "https://github.com/MegaMek/mekhq/commit/2802536584bfd28a80056b85a7db2e13f53bd4ce", "message": "Update MekLocation isSalvagingTest", "committedDate": "2021-01-02T19:01:13Z", "type": "commit"}, {"oid": "21516bfe82fcaa3de61751bbeb2cd1b74e91f826", "url": "https://github.com/MegaMek/mekhq/commit/21516bfe82fcaa3de61751bbeb2cd1b74e91f826", "message": "Add basic MekLocation::updateConditionFromEntity test", "committedDate": "2021-01-02T19:01:13Z", "type": "commit"}, {"oid": "0d8feb0b9c28c7cdd32b9e93bd4834003be53b74", "url": "https://github.com/MegaMek/mekhq/commit/0d8feb0b9c28c7cdd32b9e93bd4834003be53b74", "message": "Add some checkFixable and checkSalvagable tests", "committedDate": "2021-01-02T19:01:13Z", "type": "commit"}, {"oid": "34c8842f7bac27fb68a014efe4d0e0e0dc09184f", "url": "https://github.com/MegaMek/mekhq/commit/34c8842f7bac27fb68a014efe4d0e0e0dc09184f", "message": "Add checkScrappable with armor test", "committedDate": "2021-01-02T19:01:14Z", "type": "commit"}, {"oid": "0b9634d6bf7412399f476a844370286f8940e6d7", "url": "https://github.com/MegaMek/mekhq/commit/0b9634d6bf7412399f476a844370286f8940e6d7", "message": "Round out checkSalvagable/checkScrappable tests", "committedDate": "2021-01-02T19:36:43Z", "type": "commit"}, {"oid": "0b9634d6bf7412399f476a844370286f8940e6d7", "url": "https://github.com/MegaMek/mekhq/commit/0b9634d6bf7412399f476a844370286f8940e6d7", "message": "Round out checkSalvagable/checkScrappable tests", "committedDate": "2021-01-02T19:36:43Z", "type": "forcePushed"}, {"oid": "355b57e923484437a34fb4d2424c7896aa3a0a02", "url": "https://github.com/MegaMek/mekhq/commit/355b57e923484437a34fb4d2424c7896aa3a0a02", "message": "Simplify bad hip or shoulder in checkFixable", "committedDate": "2021-01-02T19:42:55Z", "type": "commit"}, {"oid": "139399331df7d4f94327740c9b13c700d62fc6e9", "url": "https://github.com/MegaMek/mekhq/commit/139399331df7d4f94327740c9b13c700d62fc6e9", "message": "Test MekLocation::updateConditionFromPart", "committedDate": "2021-01-02T19:59:02Z", "type": "commit"}, {"oid": "2f90757f8e111159005f85d1a871cbd8e6c95d1b", "url": "https://github.com/MegaMek/mekhq/commit/2f90757f8e111159005f85d1a871cbd8e6c95d1b", "message": "Add needsFixing tests", "committedDate": "2021-01-02T20:04:02Z", "type": "commit"}, {"oid": "6eeb8a9f8fca01c18fd29eef951f8e60b43ab92e", "url": "https://github.com/MegaMek/mekhq/commit/6eeb8a9f8fca01c18fd29eef951f8e60b43ab92e", "message": "Test MekLocation::doMaintenanceDamage", "committedDate": "2021-01-02T20:18:24Z", "type": "commit"}, {"oid": "be7bb5da1b7204173916c1e93f11c1b80874840d", "url": "https://github.com/MegaMek/mekhq/commit/be7bb5da1b7204173916c1e93f11c1b80874840d", "message": "Add basic MekLocation::remove tests", "committedDate": "2021-01-02T20:45:02Z", "type": "commit"}, {"oid": "87cc9375d6270d0e798d957bc4f977e4e011d556", "url": "https://github.com/MegaMek/mekhq/commit/87cc9375d6270d0e798d957bc4f977e4e011d556", "message": "Match armor to getInternalForReal calls", "committedDate": "2021-01-02T21:01:21Z", "type": "commit"}, {"oid": "c2970d1c5759fda7efff892f079f1f55a7034544", "url": "https://github.com/MegaMek/mekhq/commit/c2970d1c5759fda7efff892f079f1f55a7034544", "message": "Add missing updateConditionFromEntity test", "committedDate": "2021-01-02T21:11:01Z", "type": "commit"}, {"oid": "0af50a247e7783810f890ec70b02b8aea6cba7dd", "url": "https://github.com/MegaMek/mekhq/commit/0af50a247e7783810f890ec70b02b8aea6cba7dd", "message": "Add tiny tests", "committedDate": "2021-01-03T13:14:24Z", "type": "commit"}, {"oid": "c37ffa8a4033d3f5d03454ee576539f76302ebcd", "url": "https://github.com/MegaMek/mekhq/commit/c37ffa8a4033d3f5d03454ee576539f76302ebcd", "message": "Add MekLocation::getDifficulty test", "committedDate": "2021-01-03T13:22:38Z", "type": "commit"}, {"oid": "9c78420250057d774c23aeb8e5e032a3302a088d", "url": "https://github.com/MegaMek/mekhq/commit/9c78420250057d774c23aeb8e5e032a3302a088d", "message": "Test MekLocation::getBaseTime", "committedDate": "2021-01-03T15:36:53Z", "type": "commit"}, {"oid": "b13ff6470254b16bce1bf1e3bc22a46a8593cd6e", "url": "https://github.com/MegaMek/mekhq/commit/b13ff6470254b16bce1bf1e3bc22a46a8593cd6e", "message": "Add MekLocation::fix tests", "committedDate": "2021-01-03T15:54:35Z", "type": "commit"}, {"oid": "7c64fa90151ba5de48e4a151ee395dae8a0cfcf3", "url": "https://github.com/MegaMek/mekhq/commit/7c64fa90151ba5de48e4a151ee395dae8a0cfcf3", "message": "Improve getDetails to include hip/shoulder issues", "committedDate": "2021-01-03T18:36:50Z", "type": "commit"}, {"oid": "5fb955a7c88a4a6370626518d1c098ac2906771d", "url": "https://github.com/MegaMek/mekhq/commit/5fb955a7c88a4a6370626518d1c098ac2906771d", "message": "Test MekLocation::getDetails", "committedDate": "2021-01-03T18:40:53Z", "type": "commit"}, {"oid": "1e8735caccb59fa14e7bdcc75be5bad2c4427b45", "url": "https://github.com/MegaMek/mekhq/commit/1e8735caccb59fa14e7bdcc75be5bad2c4427b45", "message": "Remove unnecessary nags", "committedDate": "2021-01-03T18:44:32Z", "type": "commit"}, {"oid": "eb8e0b77b190d2f1da9e0f3a6836c9d2217db3a1", "url": "https://github.com/MegaMek/mekhq/commit/eb8e0b77b190d2f1da9e0f3a6836c9d2217db3a1", "message": "Fix getDetailsOnUnitTest conditions", "committedDate": "2021-01-03T18:45:09Z", "type": "commit"}, {"oid": "da762cafdf413c22b9b0a810b2f308a96826e4cb", "url": "https://github.com/MegaMek/mekhq/commit/da762cafdf413c22b9b0a810b2f308a96826e4cb", "message": "Add getAllMods tests", "committedDate": "2021-01-03T20:46:19Z", "type": "commit"}, {"oid": "422d432e98b88ff256a6da8a98bec454d70617f3", "url": "https://github.com/MegaMek/mekhq/commit/422d432e98b88ff256a6da8a98bec454d70617f3", "message": "Test MekLocation::getDesc", "committedDate": "2021-01-03T20:57:43Z", "type": "commit"}, {"oid": "c0d7e971732f60ac5dfada6e5c87683df63a1ee8", "url": "https://github.com/MegaMek/mekhq/commit/c0d7e971732f60ac5dfada6e5c87683df63a1ee8", "message": "Round out simple getDesc test", "committedDate": "2021-01-03T21:03:04Z", "type": "commit"}, {"oid": "9c2ee335b3a017fb67bedaa8fc7fa497aa4cb226", "url": "https://github.com/MegaMek/mekhq/commit/9c2ee335b3a017fb67bedaa8fc7fa497aa4cb226", "message": "Fix test failure", "committedDate": "2021-01-03T21:30:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDE5NzA1MA==", "url": "https://github.com/MegaMek/mekhq/pull/2331#discussion_r554197050", "bodyText": "Bit confusing here, especially as MekLocation extends Part", "author": "Windchild292", "createdAt": "2021-01-08T21:21:14Z", "path": "MekHQ/src/mekhq/campaign/parts/MekLocation.java", "diffHunk": "@@ -191,18 +192,27 @@ public boolean forQuad() {\n \n     @Override\n     public boolean isSamePartType(Part part) {\n-        return part instanceof MekLocation\n-                && getLoc() == ((MekLocation) part).getLoc()\n-                && getUnitTonnage() == part.getUnitTonnage()\n-                && isTsm() == ((MekLocation) part).isTsm()\n-                && getStructureType() == ((MekLocation) part).getStructureType()\n+        return (part instanceof MekLocation)\n+                && isSamePartType((MekLocation) part);\n+    }\n+\n+    /**\n+     * Gets a value indicating whether or not {@code other} is the same\n+     * type of {@code MekLocation}.\n+     * @param other A different {@code MekLocation}.\n+     */\n+    public boolean isSamePartType(MekLocation other) {", "originalCommit": "9c2ee335b3a017fb67bedaa8fc7fa497aa4cb226", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDE5OTI3NQ==", "url": "https://github.com/MegaMek/mekhq/pull/2331#discussion_r554199275", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        unit.getEntity().setInternal((int)Math.round(getPercent() * unit.getEntity().getOInternal(loc)), loc);\n          \n          \n            \n                        unit.getEntity().setInternal((int) Math.round(getPercent() * unit.getEntity().getOInternal(loc)), loc);", "author": "Windchild292", "createdAt": "2021-01-08T21:26:33Z", "path": "MekHQ/src/mekhq/campaign/parts/MekLocation.java", "diffHunk": "@@ -537,13 +579,33 @@ public String getDetails(boolean includeRepairDetails) {\n                 toReturn += \" [\" + components.toString() + \"]\";\n             }\n         }\n+\n+        return toReturn;\n+    }\n+\n+    private String getDetailsOnUnit(boolean includeRepairDetails) {\n+        assert(getUnit() != null);\n+\n+        String toReturn = getUnit().getEntity().getLocationName(loc);\n+        if (includeRepairDetails) {\n+            if (isBlownOff()) {\n+                toReturn += \" (Blown Off)\";\n+            } else if (isBreached()) {\n+                toReturn += \" (Breached)\";\n+            } else if (onBadHipOrShoulder()) {\n+                toReturn += \" (Bad Hip/Shoulder)\";\n+            } else {\n+                toReturn += \" (\" + Math.round(100 * getPercent()) + \"%)\";\n+            }\n+        }\n+\n         return toReturn;\n     }\n \n     @Override\n     public void updateConditionFromPart() {\n         if (null != unit) {\n-            unit.getEntity().setInternal((int)Math.round(percent * unit.getEntity().getOInternal(loc)), loc);\n+            unit.getEntity().setInternal((int)Math.round(getPercent() * unit.getEntity().getOInternal(loc)), loc);", "originalCommit": "9c2ee335b3a017fb67bedaa8fc7fa497aa4cb226", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDE5OTc0Mw==", "url": "https://github.com/MegaMek/mekhq/pull/2331#discussion_r554199743", "bodyText": "Ternary candidate", "author": "Windchild292", "createdAt": "2021-01-08T21:27:40Z", "path": "MekHQ/src/mekhq/campaign/parts/MekLocation.java", "diffHunk": "@@ -694,15 +745,19 @@ public String checkScrappable() {\n         //otherwise you will get weirdness where armor and actuators are\n         //still attached but everything else is scrapped\n         //cant salvage torsos until arms and legs are gone\n+        String limbName = \" arm \";\n+        if (forQuad) {\n+            limbName = \" front leg \";\n+        }", "originalCommit": "9c2ee335b3a017fb67bedaa8fc7fa497aa4cb226", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "491ba08f02d01bba60e6f72ebf248871156c0150", "url": "https://github.com/MegaMek/mekhq/commit/491ba08f02d01bba60e6f72ebf248871156c0150", "message": "Apply suggestions from code review\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>", "committedDate": "2021-04-09T12:22:11Z", "type": "commit"}, {"oid": "b4b10614336c9f86ea823baf8a2cf0a3127eb3ab", "url": "https://github.com/MegaMek/mekhq/commit/b4b10614336c9f86ea823baf8a2cf0a3127eb3ab", "message": "Merge remote-tracking branch 'upstream/master' into add-more-part-unit-tests", "committedDate": "2021-04-09T12:23:51Z", "type": "commit"}, {"oid": "fcb52f69ad44233b563697da90aedaae89d590dd", "url": "https://github.com/MegaMek/mekhq/commit/fcb52f69ad44233b563697da90aedaae89d590dd", "message": "Fix merge conflicts", "committedDate": "2021-04-09T12:34:49Z", "type": "commit"}, {"oid": "bc441678a4e2c857a2c5a33554b8724ed173608c", "url": "https://github.com/MegaMek/mekhq/commit/bc441678a4e2c857a2c5a33554b8724ed173608c", "message": "Address review comments", "committedDate": "2021-04-09T12:42:41Z", "type": "commit"}]}