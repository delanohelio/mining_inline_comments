{"pr_number": 1366, "pr_title": "Content type in JSON RPC response", "pr_createdAt": "2020-11-18T15:19:39Z", "pr_url": "https://github.com/rsksmart/rskj/pull/1366", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI5NjYzOA==", "url": "https://github.com/rsksmart/rskj/pull/1366#discussion_r526296638", "bodyText": "You can use:\nimport static io.netty.handler.codec.http.HttpHeaders.Names.CONTENT_TYPE;\nimport static io.netty.handler.codec.http.HttpHeaders.Values.APPLICATION_JSON;", "author": "patogallaiovlabs", "createdAt": "2020-11-18T17:46:04Z", "path": "rskj-core/src/main/java/co/rsk/rpc/netty/Web3ResultHttpResponseHandler.java", "diffHunk": "@@ -29,11 +29,15 @@\n \n     @Override\n     protected void channelRead0(ChannelHandlerContext ctx, Web3Result msg) {\n-        ctx.write(new DefaultFullHttpResponse(\n-            HttpVersion.HTTP_1_1,\n-            HttpResponseStatus.valueOf(DefaultHttpStatusCodeProvider.INSTANCE.getHttpStatusCode(msg.getCode())),\n-            msg.getContent()\n-        )).addListener(ChannelFutureListener.CLOSE);\n+        DefaultFullHttpResponse response = new DefaultFullHttpResponse(\n+                HttpVersion.HTTP_1_1,\n+                HttpResponseStatus.valueOf(DefaultHttpStatusCodeProvider.INSTANCE.getHttpStatusCode(msg.getCode())),\n+                msg.getContent()\n+        );\n+\n+        response.headers().add(\"Content-Type\", \"application/json\");", "originalCommit": "86730a66f302c1ad65bbb378094add9d1c5ed3bc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMwNjQ0Mw==", "url": "https://github.com/rsksmart/rskj/pull/1366#discussion_r526306443", "bodyText": "We could also remove unused import:\nimport io.netty.channel.ChannelFutureListener;", "author": "patogallaiovlabs", "createdAt": "2020-11-18T17:58:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI5NjYzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYzNTkyOQ==", "url": "https://github.com/rsksmart/rskj/pull/1366#discussion_r531635929", "bodyText": "Added constants. The ChannelFutureListener import is still in use", "author": "ajlopezrsk", "createdAt": "2020-11-27T14:35:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI5NjYzOA=="}], "type": "inlineReview"}, {"oid": "8a4d73ac49290663b4cca983d3eb92e361e783da", "url": "https://github.com/rsksmart/rskj/commit/8a4d73ac49290663b4cca983d3eb92e361e783da", "message": "Content type in JSON RPC response", "committedDate": "2020-11-18T19:09:55Z", "type": "forcePushed"}, {"oid": "03ce2ed2bdb2747a3a846774a9dbff9189c36b9e", "url": "https://github.com/rsksmart/rskj/commit/03ce2ed2bdb2747a3a846774a9dbff9189c36b9e", "message": "Using constants in Web3ResultHttpResponseHandler", "committedDate": "2020-11-27T19:03:26Z", "type": "forcePushed"}, {"oid": "b2dddb90b439ec86796ae50ba215b87338e6a050", "url": "https://github.com/rsksmart/rskj/commit/b2dddb90b439ec86796ae50ba215b87338e6a050", "message": "Using constants in Web3ResultHttpResponseHandler", "committedDate": "2020-11-30T21:02:55Z", "type": "forcePushed"}, {"oid": "b44f6c67aa0bf95dad337c0e304356714603e81b", "url": "https://github.com/rsksmart/rskj/commit/b44f6c67aa0bf95dad337c0e304356714603e81b", "message": "Using constants in Web3ResultHttpResponseHandler", "committedDate": "2020-12-10T10:57:33Z", "type": "forcePushed"}, {"oid": "34804c0bf5915b739b756dd92065d0c83de98afd", "url": "https://github.com/rsksmart/rskj/commit/34804c0bf5915b739b756dd92065d0c83de98afd", "message": "Using constants in Web3ResultHttpResponseHandler", "committedDate": "2020-12-17T18:00:17Z", "type": "forcePushed"}, {"oid": "2040b34fc73fcb0685d7674627f118ed1a5dd360", "url": "https://github.com/rsksmart/rskj/commit/2040b34fc73fcb0685d7674627f118ed1a5dd360", "message": "Content type in JSON RPC response", "committedDate": "2020-12-21T13:42:54Z", "type": "commit"}, {"oid": "6dec27e185f149a7b320fbb9bec8572f8211cb99", "url": "https://github.com/rsksmart/rskj/commit/6dec27e185f149a7b320fbb9bec8572f8211cb99", "message": "Using constants in Web3ResultHttpResponseHandler", "committedDate": "2020-12-21T13:42:54Z", "type": "commit"}, {"oid": "6dec27e185f149a7b320fbb9bec8572f8211cb99", "url": "https://github.com/rsksmart/rskj/commit/6dec27e185f149a7b320fbb9bec8572f8211cb99", "message": "Using constants in Web3ResultHttpResponseHandler", "committedDate": "2020-12-21T13:42:54Z", "type": "forcePushed"}]}