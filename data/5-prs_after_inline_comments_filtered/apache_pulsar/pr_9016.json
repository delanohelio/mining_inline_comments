{"pr_number": 9016, "pr_title": "Enable spotbugs check in the module pulsar-common", "pr_createdAt": "2020-12-21T09:59:51Z", "pr_url": "https://github.com/apache/pulsar/pull/9016", "timeline": [{"oid": "32b163be9b864e687cde173fe7f7eec7b8f025a1", "url": "https://github.com/apache/pulsar/commit/32b163be9b864e687cde173fe7f7eec7b8f025a1", "message": "Enable spotbugs check in the module pulsar-common\n---\n\n*Motivation*\n\nEnable spotbugs check in the module pulsar-common.", "committedDate": "2020-12-21T09:59:15Z", "type": "commit"}, {"oid": "6f10913188f021e941ee499edaf02101c084b4f6", "url": "https://github.com/apache/pulsar/commit/6f10913188f021e941ee499edaf02101c084b4f6", "message": "Address comments", "committedDate": "2020-12-24T06:46:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODQxODYyMA==", "url": "https://github.com/apache/pulsar/pull/9016#discussion_r548418620", "bodyText": "Is this right?", "author": "zymap", "createdAt": "2020-12-24T06:48:55Z", "path": "pulsar-common/src/main/java/org/apache/pulsar/common/nar/NarClassLoader.java", "diffHunk": "@@ -151,11 +158,13 @@ public static NarClassLoader getFromArchive(File narPath, Set<String> additional\n                                                 String narExtractionDirectory)\n         throws IOException {\n         File unpacked = NarUnpacker.unpackNar(narPath, getNarExtractionDirectory(narExtractionDirectory));\n-        try {\n-            return new NarClassLoader(unpacked, additionalJars, parent);\n-        } catch (ClassNotFoundException | NoClassDefFoundError e) {\n-            throw new IOException(e);\n-        }\n+        return AccessController.doPrivileged(new PrivilegedAction<NarClassLoader>() {", "originalCommit": "6f10913188f021e941ee499edaf02101c084b4f6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODQxOTA4OQ==", "url": "https://github.com/apache/pulsar/pull/9016#discussion_r548419089", "bodyText": "Please take a look at this change. I am not sure why we used the long value before.", "author": "zymap", "createdAt": "2020-12-24T06:50:51Z", "path": "pulsar-common/src/main/java/org/apache/pulsar/common/policies/data/Policies.java", "diffHunk": "@@ -241,18 +241,16 @@ public String toString() {\n     }\n \n \n-    private static final long MAX_BUNDLES = ((long) 1) << 32;\n-\n     public static BundlesData getBundles(int numBundles) {\n-        if (numBundles <= 0 || numBundles > MAX_BUNDLES) {\n+        if (numBundles <= 0) {", "originalCommit": "6f10913188f021e941ee499edaf02101c084b4f6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODQyMzczNg==", "url": "https://github.com/apache/pulsar/pull/9016#discussion_r548423736", "bodyText": "I don't think the change is correct. What was the findbugs error here?", "author": "sijie", "createdAt": "2020-12-24T07:09:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODQxOTA4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODUwMTc1MA==", "url": "https://github.com/apache/pulsar/pull/9016#discussion_r548501750", "bodyText": "The findbugs error is: INT_BAD_COMPARISON_WITH_INT_VALUE", "author": "zymap", "createdAt": "2020-12-24T11:30:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODQxOTA4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI1ODI5OQ==", "url": "https://github.com/apache/pulsar/pull/9016#discussion_r549258299", "bodyText": "It should be only affected by the comparison of the values. I remove the comparison between the int value and long value.\nBut I still wonder why we use a 'long' to represent the max size of the bundles?", "author": "zymap", "createdAt": "2020-12-28T08:25:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODQxOTA4OQ=="}], "type": "inlineReview"}, {"oid": "c63d0e4832b219202a99f44f78a3ee8aeb5e5e29", "url": "https://github.com/apache/pulsar/commit/c63d0e4832b219202a99f44f78a3ee8aeb5e5e29", "message": "Fix the issues in the pulsar-common module", "committedDate": "2020-12-25T15:15:13Z", "type": "commit"}, {"oid": "0b01786eae5125de347918e57b9f3bdce4c346ba", "url": "https://github.com/apache/pulsar/commit/0b01786eae5125de347918e57b9f3bdce4c346ba", "message": "Merge remote-tracking branch 'apache/master' into enable-spotbugs-pulsar-common", "committedDate": "2020-12-29T09:51:51Z", "type": "commit"}, {"oid": "5b2bb61d7bb3adba855d447bbf5e021beced8f38", "url": "https://github.com/apache/pulsar/commit/5b2bb61d7bb3adba855d447bbf5e021beced8f38", "message": "Fix the build issue", "committedDate": "2020-12-29T10:28:56Z", "type": "commit"}, {"oid": "2ac47adb59f0da27f8b5e42afbfd67eee393ea95", "url": "https://github.com/apache/pulsar/commit/2ac47adb59f0da27f8b5e42afbfd67eee393ea95", "message": "Merge remote-tracking branch 'apache/master' into enable-spotbugs-pulsar-common", "committedDate": "2021-01-03T08:47:04Z", "type": "commit"}, {"oid": "3576561507754e50feb2beca9c3bf66234e2081b", "url": "https://github.com/apache/pulsar/commit/3576561507754e50feb2beca9c3bf66234e2081b", "message": "Fix the failed tests", "committedDate": "2021-01-03T09:09:11Z", "type": "commit"}]}