{"pr_number": 7389, "pr_title": "[Issue 7347] Avoid the NPE occurs in method `ManagedLedgerImpl.isOffloadedNeedsDelete`", "pr_createdAt": "2020-06-30T03:24:05Z", "pr_url": "https://github.com/apache/pulsar/pull/7389", "timeline": [{"oid": "622595fd55f7b76f48047560da5d5069b6ca4d41", "url": "https://github.com/apache/pulsar/commit/622595fd55f7b76f48047560da5d5069b6ca4d41", "message": "set the default offload deletion lag value to -1", "committedDate": "2020-06-30T02:28:54Z", "type": "commit"}, {"oid": "f683f882114eabeca18bc8d3acb4b3accfe9e227", "url": "https://github.com/apache/pulsar/commit/f683f882114eabeca18bc8d3acb4b3accfe9e227", "message": "add unit test for method `ManagedLedgerImpl.isOffloadedNeedsDelete`", "committedDate": "2020-06-30T03:21:03Z", "type": "commit"}, {"oid": "55dda16ea335c4b420e39d1957ad0e3d4c8368e6", "url": "https://github.com/apache/pulsar/commit/55dda16ea335c4b420e39d1957ad0e3d4c8368e6", "message": "fix test", "committedDate": "2020-06-30T03:35:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzM5OTQzMA==", "url": "https://github.com/apache/pulsar/pull/7389#discussion_r447399430", "bodyText": "Should we also change managedLedgerOffloadDeletionLagInMillis to long?", "author": "merlimat", "createdAt": "2020-06-30T04:19:16Z", "path": "pulsar-common/src/main/java/org/apache/pulsar/common/policies/data/OffloadPolicies.java", "diffHunk": "@@ -41,7 +41,7 @@\n     public final static String[] DRIVER_NAMES = {\"S3\", \"aws-s3\", \"google-cloud-storage\", \"filesystem\"};\n     public final static String DEFAULT_OFFLOADER_DIRECTORY = \"./offloaders\";\n     public final static long DEFAULT_OFFLOAD_THRESHOLD_IN_BYTES = -1;\n-    public final static Long DEFAULT_OFFLOAD_DELETION_LAG_IN_MILLIS = null;\n+    public final static long DEFAULT_OFFLOAD_DELETION_LAG_IN_MILLIS = -1;", "originalCommit": "55dda16ea335c4b420e39d1957ad0e3d4c8368e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc5NzI4OQ==", "url": "https://github.com/apache/pulsar/pull/7389#discussion_r447797289", "bodyText": "This default is couldn't be Null, so I changed this field type to long.", "author": "gaoran10", "createdAt": "2020-06-30T15:59:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzM5OTQzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgyNTA1OA==", "url": "https://github.com/apache/pulsar/pull/7389#discussion_r447825058", "bodyText": "Yes, it's fine. I was just saying to also change the type for the managedLedgerOffloadDeletionLagInMillis field which is currently Long. If null is not a valid value, we should use long type instead.", "author": "merlimat", "createdAt": "2020-06-30T16:37:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzM5OTQzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3NTAxNw==", "url": "https://github.com/apache/pulsar/pull/7389#discussion_r448075017", "bodyText": "Yes, I changed it. Thanks.", "author": "gaoran10", "createdAt": "2020-07-01T02:04:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzM5OTQzMA=="}], "type": "inlineReview"}, {"oid": "45f44113a7c14126831a9eb38a5e6a1c9cd275d2", "url": "https://github.com/apache/pulsar/commit/45f44113a7c14126831a9eb38a5e6a1c9cd275d2", "message": "fix test", "committedDate": "2020-06-30T16:47:00Z", "type": "commit"}, {"oid": "7ae01ef4e22770e50317e1c304cfc25e251f4350", "url": "https://github.com/apache/pulsar/commit/7ae01ef4e22770e50317e1c304cfc25e251f4350", "message": "fix", "committedDate": "2020-07-05T09:43:59Z", "type": "commit"}, {"oid": "75e02953491bf715f6299cb5fbed449d11d46a9f", "url": "https://github.com/apache/pulsar/commit/75e02953491bf715f6299cb5fbed449d11d46a9f", "message": "fix", "committedDate": "2020-07-05T10:04:11Z", "type": "commit"}, {"oid": "89a44c964896888943e83c507112eb658dbb3216", "url": "https://github.com/apache/pulsar/commit/89a44c964896888943e83c507112eb658dbb3216", "message": "fix test", "committedDate": "2020-07-06T02:57:28Z", "type": "commit"}]}