{"pr_number": 1474, "pr_title": "Refactor and improve request object validation", "pr_createdAt": "2020-10-16T06:10:38Z", "pr_url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1474", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5MDI1Mg==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1474#discussion_r506090252", "bodyText": "The default implementation of validateClientIdAndResponseType won't send false but throws exceptions.\nSince validateClientIdAndResponseType is a protected method, we better honor the response of this method. If it returns false, we have to return false.", "author": "IsuraD", "createdAt": "2020-10-16T06:39:50Z", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/openidconnect/RequestObjectValidatorImpl.java", "diffHunk": "@@ -183,17 +183,30 @@ protected boolean isSignatureVerified(SignedJWT signedJWT, String jwksUri) throw\n     public boolean validateRequestObject(RequestObject requestObject, OAuth2Parameters oAuth2Parameters)\n             throws RequestObjectException {\n \n-        boolean isValid = validateClientIdAndResponseType(requestObject, oAuth2Parameters) && checkExpirationTime\n-                (requestObject);\n-        if (isParamPresent(requestObject, Constants.REQUEST_URI)) {\n-            isValid = false;\n-        } else if (isParamPresent(requestObject, Constants.REQUEST)) {\n-            isValid = false;\n-        } else if (requestObject.isSigned()) {\n-            isValid = isValidIssuer(requestObject, oAuth2Parameters) && isValidAudience(requestObject,\n-                    oAuth2Parameters);\n+        // Throws exception if invalid.\n+        validateClientIdAndResponseType(requestObject, oAuth2Parameters);", "originalCommit": "4c85a310b965f227b29c05729b8de1f507b11a70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjEyNjkxOA==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1474#discussion_r506126918", "bodyText": "fixed", "author": "janakamarasena", "createdAt": "2020-10-16T07:35:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5MDI1Mg=="}], "type": "inlineReview"}, {"oid": "037570879d16b9d23b749cfb78c327b9b8c6d348", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/037570879d16b9d23b749cfb78c327b9b8c6d348", "message": "Refactor and improve request object validation", "committedDate": "2020-10-16T06:50:06Z", "type": "commit"}, {"oid": "037570879d16b9d23b749cfb78c327b9b8c6d348", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/037570879d16b9d23b749cfb78c327b9b8c6d348", "message": "Refactor and improve request object validation", "committedDate": "2020-10-16T06:50:06Z", "type": "forcePushed"}]}