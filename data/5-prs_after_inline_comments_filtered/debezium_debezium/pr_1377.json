{"pr_number": 1377, "pr_title": "DBZ-1918 Initialize Metronome when needed", "pr_createdAt": "2020-04-01T04:59:54Z", "pr_url": "https://github.com/debezium/debezium/pull/1377", "timeline": [{"oid": "f983f7ed91d8fea0d0ff83728709b9ef9ab7b64c", "url": "https://github.com/debezium/debezium/commit/f983f7ed91d8fea0d0ff83728709b9ef9ab7b64c", "message": "DBZ-1918 Initialize Metronome when needed", "committedDate": "2020-04-01T04:59:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQxMzY5Ng==", "url": "https://github.com/debezium/debezium/pull/1377#discussion_r401413696", "bodyText": "That way we're creating a new metronome each time. Maybe it'd be better to initialize lazily if it's null originally?", "author": "gunnarmorling", "createdAt": "2020-04-01T07:39:02Z", "path": "debezium-core/src/main/java/io/debezium/connector/common/BaseSourceTask.java", "diffHunk": "@@ -126,7 +123,7 @@ public final void start(Map<String, String> props) {\n             // WorkerSourceTask calls us immediately after we return the empty list.\n             // This turns into a throttling so we need to make a pause before we return\n             // the control back.\n-            PAUSE_WHEN_NOT_STARTED.pause();\n+            Metronome.parker(Duration.of(2, ChronoUnit.SECONDS), Clock.SYSTEM).pause();", "originalCommit": "f983f7ed91d8fea0d0ff83728709b9ef9ab7b64c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQxNzAzNg==", "url": "https://github.com/debezium/debezium/pull/1377#discussion_r401417036", "bodyText": "In that case we would need to clear it when the connector successfully starts otherwise the next restart loop would exhibit the same problem. As this is only expcetion handling and one per-two seconds object creation I opted for the simplest solution.", "author": "jpechane", "createdAt": "2020-04-01T07:45:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQxMzY5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQxODY4Nw==", "url": "https://github.com/debezium/debezium/pull/1377#discussion_r401418687", "bodyText": "Ok, makes sense.", "author": "gunnarmorling", "createdAt": "2020-04-01T07:48:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQxMzY5Ng=="}], "type": "inlineReview"}]}