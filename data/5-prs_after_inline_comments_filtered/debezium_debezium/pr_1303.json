{"pr_number": 1303, "pr_title": " DBZ-1840 Fix pgoutput and wal2json", "pr_createdAt": "2020-03-03T14:41:55Z", "pr_url": "https://github.com/debezium/debezium/pull/1303", "timeline": [{"oid": "712bfb44765b1bd25e8a669855d4931e499e280f", "url": "https://github.com/debezium/debezium/commit/712bfb44765b1bd25e8a669855d4931e499e280f", "message": "DBZ-1840 No nulls to stream producer", "committedDate": "2020-03-03T14:41:08Z", "type": "commit"}, {"oid": "e897e6bbfcd448edef488427221e422890b23e6a", "url": "https://github.com/debezium/debezium/commit/e897e6bbfcd448edef488427221e422890b23e6a", "message": "DBZ-1840 Syntheitc message to replace messages dropped in decoder", "committedDate": "2020-03-04T04:57:37Z", "type": "commit"}, {"oid": "ae291a2443d1fedb6153771a77b53c7e2a95640d", "url": "https://github.com/debezium/debezium/commit/ae291a2443d1fedb6153771a77b53c7e2a95640d", "message": "DBZ-1840 Test logic was out of order", "committedDate": "2020-03-04T05:29:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ5MDAzNg==", "url": "https://github.com/debezium/debezium/pull/1303#discussion_r387490036", "bodyText": "Why not the NOOP message here?", "author": "gunnarmorling", "createdAt": "2020-03-04T07:33:07Z", "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/connection/wal2json/NonStreamingWal2JsonMessageDecoder.java", "diffHunk": "@@ -62,7 +62,8 @@ public void processNotEmptyMessage(ByteBuffer buffer, ReplicationMessageProcesso\n             // WAL2JSON may send empty changes that still have a txid. These events are from things like vacuum,\n             // materialized view, DDL, etc. They still need to be processed for the heartbeat to fire.\n             if (changes.isEmpty()) {\n-                processor.process(null);\n+                processor.process(new TransactionMessage(Operation.BEGIN, txId, commitTime));", "originalCommit": "ae291a2443d1fedb6153771a77b53c7e2a95640d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ5MTA4Nw==", "url": "https://github.com/debezium/debezium/pull/1303#discussion_r387491087", "bodyText": "@gunnarmorling Because it is different - NOOP is used in case of filtered event in TX. This is an empty TX is the valid logic is not emit NOOP but begin and end for the empty TX.", "author": "jpechane", "createdAt": "2020-03-04T07:36:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ5MDAzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ5MDE4Mg==", "url": "https://github.com/debezium/debezium/pull/1303#discussion_r387490182", "bodyText": "In which case would no table be found? Could you add a comment?", "author": "gunnarmorling", "createdAt": "2020-03-04T07:33:30Z", "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/connection/pgoutput/PgOutputMessageDecoder.java", "diffHunk": "@@ -393,7 +394,7 @@ private void decodeUpdate(ByteBuffer buffer, TypeRegistry typeRegistry, Replicat\n \n         Optional<Table> resolvedTable = resolveRelation(relationId);\n         if (!resolvedTable.isPresent()) {\n-            processor.process(null);\n+            processor.process(new NoopMessage(transactionId, commitTimestamp));", "originalCommit": "ae291a2443d1fedb6153771a77b53c7e2a95640d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ5NjY4Ng==", "url": "https://github.com/debezium/debezium/pull/1303#discussion_r387496686", "bodyText": "@gunnarmorling Javadoc added", "author": "jpechane", "createdAt": "2020-03-04T07:51:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ5MDE4Mg=="}], "type": "inlineReview"}, {"oid": "56d0776df2e3dabce4544d7f5c7398b1169b76ad", "url": "https://github.com/debezium/debezium/commit/56d0776df2e3dabce4544d7f5c7398b1169b76ad", "message": "DBZ-1840 Explanation for unresolvable tables", "committedDate": "2020-03-04T07:50:51Z", "type": "commit"}]}