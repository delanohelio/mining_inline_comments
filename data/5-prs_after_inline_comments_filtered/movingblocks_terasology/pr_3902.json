{"pr_number": 3902, "pr_title": "partial port of kinematicCharacterMover", "pr_createdAt": "2020-04-21T04:25:39Z", "pr_url": "https://github.com/MovingBlocks/Terasology/pull/3902", "timeline": [{"oid": "901f3b9aad6302c7ea242a43b05a23005612c3f8", "url": "https://github.com/MovingBlocks/Terasology/commit/901f3b9aad6302c7ea242a43b05a23005612c3f8", "message": "partial port of kinematicCharacterMover", "committedDate": "2020-04-21T04:23:42Z", "type": "commit"}, {"oid": "317f3a34298adacba2989f8f3144f7186d70f249", "url": "https://github.com/MovingBlocks/Terasology/commit/317f3a34298adacba2989f8f3144f7186d70f249", "message": "added rotationYXZ in-place of quat4f", "committedDate": "2020-04-21T16:06:22Z", "type": "commit"}, {"oid": "955713689cca131e211f1f55d226cd607cc691ac", "url": "https://github.com/MovingBlocks/Terasology/commit/955713689cca131e211f1f55d226cd607cc691ac", "message": "updated rotation", "committedDate": "2020-04-21T16:25:54Z", "type": "commit"}, {"oid": "d22fb1b41497ea0d966a6af7608f462774333451", "url": "https://github.com/MovingBlocks/Terasology/commit/d22fb1b41497ea0d966a6af7608f462774333451", "message": "removed Vector3fUtil usage from KinematicCharacterMover", "committedDate": "2020-04-21T17:11:28Z", "type": "commit"}, {"oid": "e0e7b1b3680e00d14eead5e1fcef94e9de3b318a", "url": "https://github.com/MovingBlocks/Terasology/commit/e0e7b1b3680e00d14eead5e1fcef94e9de3b318a", "message": "ported CharacterMovmentSystemUtility", "committedDate": "2020-04-21T17:51:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkxODAyNA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3902#discussion_r412918024", "bodyText": "I suggest using the following for simplification. There is another instance of this below.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            rotation.rotationYXZ(TeraMath.DEG_TO_RAD * state.getYaw(), 0, 0);\n          \n          \n            \n                            rotation.rotationY(TeraMath.DEG_TO_RAD * state.getYaw());", "author": "kBlaszczyk", "createdAt": "2020-04-22T11:58:47Z", "path": "engine/src/main/java/org/terasology/logic/characters/KinematicCharacterMover.java", "diffHunk": "@@ -773,30 +777,28 @@ private void climb(final CharacterStateEvent state, CharacterMoveInputEvent inpu\n             } else {\n                 float pitchAmount = state.isGrounded() ? 45f : 90f;\n                 float pitch = input.getPitch() > 30f ? pitchAmount : -pitchAmount;\n-                rotation = new Quat4f(TeraMath.DEG_TO_RAD * state.getYaw(), TeraMath.DEG_TO_RAD * pitch, 0);\n-                rotation.rotate(desiredVelocity, desiredVelocity);\n+                rotation.rotationYXZ(TeraMath.DEG_TO_RAD * state.getYaw(), TeraMath.DEG_TO_RAD * pitch, 0);\n+                desiredVelocity.rotate(rotation);\n             }\n \n             // looking sidewards from ladder\n         } else if (angleToClimbDirection < Math.PI * 3.0 / 4.0) {\n             float rollAmount = state.isGrounded() ? 45f : 90f;\n             tmp = new Vector3f();\n-            rotation.rotate(climbDir3f, tmp);\n+            climbDir3f.rotate(rotation,tmp);\n             float leftOrRight = tmp.x;\n             float plusOrMinus = (leftOrRight < 0f ? -1.0f : 1.0f) * (climbDir3i.x != 0 ? -1.0f : 1.0f);\n             if (jumpOrCrouchActive) {\n-                rotation = new Quat4f(TeraMath.DEG_TO_RAD * state.getYaw(), 0, 0);\n+                rotation.rotationYXZ(TeraMath.DEG_TO_RAD * state.getYaw(), 0, 0);", "originalCommit": "e0e7b1b3680e00d14eead5e1fcef94e9de3b318a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkyMDEzMA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3902#discussion_r412920130", "bodyText": "Could be simplified to:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Quaternionf rotation = new Quaternionf().rotationYXZ(0f, TeraMath.DEG_TO_RAD * state.getPitch(), 0f);\n          \n          \n            \n                    Quaternionf rotation = new Quaternionf().rotationX(TeraMath.DEG_TO_RAD * state.getPitch());", "author": "kBlaszczyk", "createdAt": "2020-04-22T12:01:57Z", "path": "engine/src/main/java/org/terasology/logic/characters/CharacterMovementSystemUtility.java", "diffHunk": "@@ -63,27 +62,27 @@ public void setToState(EntityRef entity, CharacterStateEvent state) {\n         movementComp.footstepDelta = state.getFootstepDelta();\n         entity.saveComponent(movementComp);\n \n-        setPhysicsLocation(entity, state.getPosition());\n+        setPhysicsLocation(entity, JomlUtil.from(state.getPosition()));\n \n         // set the pitch to the character's gaze entity\n-        Quat4f rotation = new Quat4f(0f, TeraMath.DEG_TO_RAD * state.getPitch(), 0f);\n+        Quaternionf rotation = new Quaternionf().rotationYXZ(0f, TeraMath.DEG_TO_RAD * state.getPitch(), 0f);", "originalCommit": "e0e7b1b3680e00d14eead5e1fcef94e9de3b318a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6309a39a8f40f56e0fd240939e604145c7e796b3", "url": "https://github.com/MovingBlocks/Terasology/commit/6309a39a8f40f56e0fd240939e604145c7e796b3", "message": "Update engine/src/main/java/org/terasology/logic/characters/CharacterMovementSystemUtility.java\n\nCo-Authored-By: Kevin Blaszczyk <kevin.blaszczyk@gmail.com>", "committedDate": "2020-04-22T15:40:57Z", "type": "commit"}, {"oid": "8ae609a5f97be4740eb663ac6baa29ec4875e20e", "url": "https://github.com/MovingBlocks/Terasology/commit/8ae609a5f97be4740eb663ac6baa29ec4875e20e", "message": "Update engine/src/main/java/org/terasology/logic/characters/KinematicCharacterMover.java\n\nCo-Authored-By: Kevin Blaszczyk <kevin.blaszczyk@gmail.com>", "committedDate": "2020-04-22T15:41:03Z", "type": "commit"}, {"oid": "74e86151d8126c830699cc03241f04f376724da8", "url": "https://github.com/MovingBlocks/Terasology/commit/74e86151d8126c830699cc03241f04f376724da8", "message": "Merge remote-tracking branch 'upstream/develop' into feature/joml-kinematic-character-mover", "committedDate": "2020-04-29T18:14:30Z", "type": "commit"}, {"oid": "d9bfa0c4da9039f05e3817e9ed454a01184c291a", "url": "https://github.com/MovingBlocks/Terasology/commit/d9bfa0c4da9039f05e3817e9ed454a01184c291a", "message": "Merge branch 'feature/joml-kinematic-character-mover' of github.com:pollend/Terasology into feature/joml-kinematic-character-mover", "committedDate": "2020-04-29T18:14:52Z", "type": "commit"}]}