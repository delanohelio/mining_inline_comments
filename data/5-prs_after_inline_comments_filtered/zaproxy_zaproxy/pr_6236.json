{"pr_number": 6236, "pr_title": "#5898 added import from file button to regular expression panels", "pr_createdAt": "2020-10-11T20:21:25Z", "pr_url": "https://github.com/zaproxy/zaproxy/pull/6236", "timeline": [{"oid": "a9e516543a73ad60793b0751a789ba1240240cf3", "url": "https://github.com/zaproxy/zaproxy/commit/a9e516543a73ad60793b0751a789ba1240240cf3", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-11T20:30:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk4OTY5MQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502989691", "bodyText": "There doesn't seem to be any need for this intermediate storage and it isn't a CONSTANT.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n          \n          \n            \n                    JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n          \n          \n            \n                    JButton importButton = new JButton(Constant.messages.getString(\"context.include.import.label\"));", "author": "kingthorin", "createdAt": "2020-10-12T00:44:07Z", "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);", "originalCommit": "a9e516543a73ad60793b0751a789ba1240240cf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUyOTE5MA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r503529190", "bodyText": "Right, changed.", "author": "ckoidl", "createdAt": "2020-10-12T20:59:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk4OTY5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDMyMA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502990320", "bodyText": "The ActionListener creation could be extracted to a new private method (getImportActionListener or something like that, create it if null, just return it if not). Then, the addition of the listener could be done with a lambda importButton.addActionListener(e -> getImportActionListener());.\nOr something like that, hopefully that gives you enough to work with. Feel free to ask questions if I haven't been clear enough.", "author": "kingthorin", "createdAt": "2020-10-12T00:48:17Z", "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n+        importButton.addActionListener(\n+                new ActionListener() {\n+                    @Override\n+                    public void actionPerformed(ActionEvent evt) {\n+                        File file = selectImportFile();\n+                        if (file != null) {\n+                            List<String> regexes = regexesPanel.getRegexes();\n+\n+                            String line = null;\n+                            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                                while ((line = br.readLine()) != null) {\n+                                    String trimmedRegex = line.trim();\n+                                    if (!regexes.contains(trimmedRegex)) {\n+                                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                                        regexes.add(trimmedRegex);\n+                                    }\n+                                }\n+                            } catch (IOException | PatternSyntaxException e) {\n+                                View.getSingleton()\n+                                        .showWarningDialog(\n+                                                Constant.messages.getString(\n+                                                        \"context.include.import.error\",\n+                                                        e.getLocalizedMessage()));\n+                                return;\n+                            }\n+                            regexesPanel.setRegexes(regexes);\n+                        }\n+                    }\n+                });", "originalCommit": "a9e516543a73ad60793b0751a789ba1240240cf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUxNzcwNw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r503517707", "bodyText": "While I am not a huge fan of lambdas I can certainly change the code to use it there. I do not fully get where there is a place for getImportActionListener when using a lambda for the ActionListener.\nI would extract the actionPerformed method to a new method and then use this as lambda, so no ActionListener object needs to be created. As far as I understand that is the essence of using lambdas.\nCould look like this:\npublic void importButtonClicked(ActionEvent event) {\n    File file = selectImportFile();\n    if (file != null) {\n        List<String> regexes = regexesPanel.getRegexes();\n\n        String line = null;\n        try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n            while ((line = br.readLine()) != null) {\n                String trimmedRegex = line.trim();\n                if (!regexes.contains(trimmedRegex)) {\n                    Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n                    regexes.add(trimmedRegex);\n                }\n            }\n        } catch (IOException | PatternSyntaxException e) {\n            View.getSingleton()\n                    .showWarningDialog(\n                            Constant.messages.getString(\n                                    \"context.include.import.error\",\n                                    e.getLocalizedMessage()));\n            return;\n        }\n        regexesPanel.setRegexes(regexes);\n    }\n}\n\n\nprivate void addImportButton() {\n    JButton importButton = new JButton(Constant.messages.getString(\"context.include.import.label\"));\n    importButton.addActionListener(e -> importButtonClicked(e));\n    regexesPanel.addButton(importButton);\n}", "author": "ckoidl", "createdAt": "2020-10-12T20:30:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDMyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU1MTQ0MA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r503551440", "bodyText": "Ya that\u2019s what I was envisioning even if I wasn\u2019t articulating it well \ud83e\udd2a", "author": "kingthorin", "createdAt": "2020-10-12T21:47:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDMyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjcxODY5NQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r506718695", "bodyText": "change to lambda (and moved all changes to MultipleRegexesOptionsPanel as per other discussion)", "author": "ckoidl", "createdAt": "2020-10-16T20:59:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDMyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDcyOQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502990729", "bodyText": "Hmmmm I'm not sure about assuming case insensitive. Users can always designate (?i) at the start of their pattern if they wish. Unless you've checked and this behavior is assumed elsewhere in context handling.", "author": "kingthorin", "createdAt": "2020-10-12T00:51:04Z", "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n+        importButton.addActionListener(\n+                new ActionListener() {\n+                    @Override\n+                    public void actionPerformed(ActionEvent evt) {\n+                        File file = selectImportFile();\n+                        if (file != null) {\n+                            List<String> regexes = regexesPanel.getRegexes();\n+\n+                            String line = null;\n+                            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                                while ((line = br.readLine()) != null) {\n+                                    String trimmedRegex = line.trim();\n+                                    if (!regexes.contains(trimmedRegex)) {\n+                                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);", "originalCommit": "a9e516543a73ad60793b0751a789ba1240240cf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUwNTExMg==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r503505112", "bodyText": "This is the same behavior as for the add button (MultipleRegexesOptionsPanel.validateFields) and I did the same validation for consistency", "author": "ckoidl", "createdAt": "2020-10-12T19:59:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDcyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDg1Nw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502990857", "bodyText": "This has bitten us before. I'd suggest including two substitutions. One that is specifically the failed pattern string, and one that's the message or localizedMessage.\nEdit: To be more specific, localizedMessage doesn't always exist, or can sometimes be null (I forget precisely if we hit null or simply empty in the past).", "author": "kingthorin", "createdAt": "2020-10-12T00:51:58Z", "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n+        importButton.addActionListener(\n+                new ActionListener() {\n+                    @Override\n+                    public void actionPerformed(ActionEvent evt) {\n+                        File file = selectImportFile();\n+                        if (file != null) {\n+                            List<String> regexes = regexesPanel.getRegexes();\n+\n+                            String line = null;\n+                            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                                while ((line = br.readLine()) != null) {\n+                                    String trimmedRegex = line.trim();\n+                                    if (!regexes.contains(trimmedRegex)) {\n+                                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                                        regexes.add(trimmedRegex);\n+                                    }\n+                                }\n+                            } catch (IOException | PatternSyntaxException e) {\n+                                View.getSingleton()\n+                                        .showWarningDialog(\n+                                                Constant.messages.getString(\n+                                                        \"context.include.import.error\",\n+                                                        e.getLocalizedMessage()));", "originalCommit": "a9e516543a73ad60793b0751a789ba1240240cf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUzMTkzMQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r503531931", "bodyText": "Thanks for the hint. Changed this to get the error detail (e.getLocalizedMessage) separately. Checking for null before passing it to string replacement to avoid failure. If the message is empty it is not a big deal, in this case just the main error message is displayed without any detail.", "author": "ckoidl", "createdAt": "2020-10-12T21:05:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDg1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MTE0Mw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502991143", "bodyText": "Note: I haven't tested.\nWon't this replace what is already specified? If the user has already set something or imported another file first.", "author": "kingthorin", "createdAt": "2020-10-12T00:54:17Z", "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n+        importButton.addActionListener(\n+                new ActionListener() {\n+                    @Override\n+                    public void actionPerformed(ActionEvent evt) {\n+                        File file = selectImportFile();\n+                        if (file != null) {\n+                            List<String> regexes = regexesPanel.getRegexes();\n+\n+                            String line = null;\n+                            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                                while ((line = br.readLine()) != null) {\n+                                    String trimmedRegex = line.trim();\n+                                    if (!regexes.contains(trimmedRegex)) {\n+                                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                                        regexes.add(trimmedRegex);\n+                                    }\n+                                }\n+                            } catch (IOException | PatternSyntaxException e) {\n+                                View.getSingleton()\n+                                        .showWarningDialog(\n+                                                Constant.messages.getString(\n+                                                        \"context.include.import.error\",\n+                                                        e.getLocalizedMessage()));\n+                                return;\n+                            }\n+                            regexesPanel.setRegexes(regexes);", "originalCommit": "a9e516543a73ad60793b0751a789ba1240240cf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUwNzE0OQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r503507149", "bodyText": "Existing regexes are loaded in :101 and new ones from file are added (excluding duplicates).", "author": "ckoidl", "createdAt": "2020-10-12T20:04:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MTE0Mw=="}], "type": "inlineReview"}, {"oid": "b7995aecad133be208a28ca596088d2229532af6", "url": "https://github.com/zaproxy/zaproxy/commit/b7995aecad133be208a28ca596088d2229532af6", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-12T20:58:03Z", "type": "forcePushed"}, {"oid": "7e258ebe240dda9e8c11e0659a24df1363ee39c9", "url": "https://github.com/zaproxy/zaproxy/commit/7e258ebe240dda9e8c11e0659a24df1363ee39c9", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-12T21:01:08Z", "type": "forcePushed"}, {"oid": "48659304c38aa9638022e8438c92a9921f6581dc", "url": "https://github.com/zaproxy/zaproxy/commit/48659304c38aa9638022e8438c92a9921f6581dc", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-12T21:12:46Z", "type": "forcePushed"}, {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "url": "https://github.com/zaproxy/zaproxy/commit/39ac49103748e03e66d5f0ac4a90e80c0a516a76", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-16T20:57:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjMyOA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602328", "bodyText": "Should be at most protected, the argument could be removed.", "author": "thc202", "createdAt": "2020-10-19T09:27:29Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {", "originalCommit": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAwNjMxMQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r508006311", "bodyText": "changed to private", "author": "ckoidl", "createdAt": "2020-10-19T19:23:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjMyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjQwMg==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602402", "bodyText": "This is not a copy, this will lead to partial imports in case of failure (which causes other issues as the changes to the model are not notified to the view).", "author": "thc202", "createdAt": "2020-10-19T09:27:38Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();", "originalCommit": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAwNjU3Mw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r508006573", "bodyText": "created local copy to allow duplication checking", "author": "ckoidl", "createdAt": "2020-10-19T19:23:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjQwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjUwMA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602500", "bodyText": "Can be declared later.", "author": "thc202", "createdAt": "2020-10-19T09:27:47Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;", "originalCommit": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAwNjc3MQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r508006771", "bodyText": "done", "author": "ckoidl", "createdAt": "2020-10-19T19:24:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjUwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU0MA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602540", "bodyText": "Should use a specific charset (e.g. UTF-8).", "author": "thc202", "createdAt": "2020-10-19T09:27:51Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {", "originalCommit": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk2OTg3MA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507969870", "bodyText": "If no charset is given, then the system default is used which should be the most appropriate one.", "author": "ckoidl", "createdAt": "2020-10-19T18:22:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODMwNDk1NA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r508304954", "bodyText": "On a second thought, while the system default might be the best guess for the file encoding it would still be undefined behavior. So I changed it to use UTF-8.", "author": "ckoidl", "createdAt": "2020-10-20T08:23:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3MTAzNg==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r510871036", "bodyText": "FileReader with charset is not availble in java 8, but java 8 build is required by the autobuild. I could go with InputStreamReader which is available in both, Java 8 and Java 11, but I checked the zap code for other places where files are read while I found a couple of places where FileReader is used without giving a charset, there was no InputStreamReader solution, so I decided to revert the changes and at least be consistent with th other code.", "author": "ckoidl", "createdAt": "2020-10-23T13:08:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0MzEwNw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r510943107", "bodyText": "Can use NIO, e.g. Files.newBufferedReader(file.toPath(), StandardCharsets.UTF_8).", "author": "thc202", "createdAt": "2020-10-23T14:57:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTEzNzk0MQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r511137941", "bodyText": "changed to NIO", "author": "ckoidl", "createdAt": "2020-10-23T20:22:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU5MA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602590", "bodyText": "This should be extracted to use when importing and adding.", "author": "thc202", "createdAt": "2020-10-19T09:27:57Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedRegex = line.trim();\n+                    if (!regexes.contains(trimmedRegex)) {\n+                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);", "originalCommit": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAxMzE4NA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r508013184", "bodyText": "Extracted duplicate checking and valid pattern checking. Using extracted function for adding and importing of regexes.", "author": "ckoidl", "createdAt": "2020-10-19T19:35:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMzAyNw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507603027", "bodyText": "Can be declared later.", "author": "thc202", "createdAt": "2020-10-19T09:28:35Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedRegex = line.trim();\n+                    if (!regexes.contains(trimmedRegex)) {\n+                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                        regexes.add(trimmedRegex);\n+                    }\n+                }\n+            } catch (IOException | PatternSyntaxException e) {\n+                View.getSingleton()\n+                        .showWarningDialog(\n+                                Constant.messages.getString(\n+                                        \"context.include.import.error\", e.getLocalizedMessage()));\n+                return;\n+            }\n+            setRegexes(regexes);\n+        }\n+    }\n+\n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;", "originalCommit": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAxMzI1NA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r508013254", "bodyText": "done", "author": "ckoidl", "createdAt": "2020-10-19T19:36:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMzAyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMzM0Ng==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507603346", "bodyText": "Should use owner as parent.", "author": "thc202", "createdAt": "2020-10-19T09:29:04Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedRegex = line.trim();\n+                    if (!regexes.contains(trimmedRegex)) {\n+                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                        regexes.add(trimmedRegex);\n+                    }\n+                }\n+            } catch (IOException | PatternSyntaxException e) {\n+                View.getSingleton()\n+                        .showWarningDialog(\n+                                Constant.messages.getString(\n+                                        \"context.include.import.error\", e.getLocalizedMessage()));\n+                return;\n+            }\n+            setRegexes(regexes);\n+        }\n+    }\n+\n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());", "originalCommit": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAxMzQ4Nw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r508013487", "bodyText": "changed parnet to owner", "author": "ckoidl", "createdAt": "2020-10-19T19:36:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMzM0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwNDU4Mg==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507604582", "bodyText": "Not sure the contexts dir is the most appropriate, that's used for the whole contexts. Don't specify any?", "author": "thc202", "createdAt": "2020-10-19T09:30:59Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedRegex = line.trim();\n+                    if (!regexes.contains(trimmedRegex)) {\n+                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                        regexes.add(trimmedRegex);\n+                    }\n+                }\n+            } catch (IOException | PatternSyntaxException e) {\n+                View.getSingleton()\n+                        .showWarningDialog(\n+                                Constant.messages.getString(\n+                                        \"context.include.import.error\", e.getLocalizedMessage()));\n+                return;\n+            }\n+            setRegexes(regexes);\n+        }\n+    }\n+\n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());", "originalCommit": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAxNDAxOA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r508014018", "bodyText": "Removed path.", "author": "ckoidl", "createdAt": "2020-10-19T19:37:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwNDU4Mg=="}], "type": "inlineReview"}, {"oid": "7f7b505a889965c734f7a08aaf86f281c6671f00", "url": "https://github.com/zaproxy/zaproxy/commit/7f7b505a889965c734f7a08aaf86f281c6671f00", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-19T19:21:14Z", "type": "forcePushed"}, {"oid": "c8649801cfdb8b39700d4ed4d1c6029afe116b14", "url": "https://github.com/zaproxy/zaproxy/commit/c8649801cfdb8b39700d4ed4d1c6029afe116b14", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-19T19:34:25Z", "type": "forcePushed"}, {"oid": "479fa05df8845ab24665f437953993d90f07758d", "url": "https://github.com/zaproxy/zaproxy/commit/479fa05df8845ab24665f437953993d90f07758d", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-19T20:05:06Z", "type": "forcePushed"}, {"oid": "a53c05b6db0969b0d94d89e914a4866a5e0566c8", "url": "https://github.com/zaproxy/zaproxy/commit/a53c05b6db0969b0d94d89e914a4866a5e0566c8", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-20T08:22:06Z", "type": "forcePushed"}, {"oid": "f1ccd09d846c0beae90f8f212461e093f81c9dcf", "url": "https://github.com/zaproxy/zaproxy/commit/f1ccd09d846c0beae90f8f212461e093f81c9dcf", "message": "Update MultipleRegexesOptionsPanel.java\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-23T13:08:51Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0Nzk4NA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r510947984", "bodyText": "regex \u2192 trimmedRegex, or rename the parameter to regex (which has more occurrences).", "author": "thc202", "createdAt": "2020-10-23T15:04:06Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +82,67 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked());\n+        addButton(importButton);\n+    }\n+\n+    /**\n+     * Checks if {@code regex} is contained in {@code regexes} and if it is a valid regex pattern.\n+     * If {@code regexes} is null, then the duplication check is omitted\n+     *\n+     * @param regex A regex as string", "originalCommit": "f1ccd09d846c0beae90f8f212461e093f81c9dcf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTEzNjMwNg==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r511136306", "bodyText": "fixed documentation", "author": "ckoidl", "createdAt": "2020-10-23T20:18:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0Nzk4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODI1OQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r510948259", "bodyText": "The call does not need to be qualified with the class name.\nIt would be better to add the braces to the if statement, for consistency.", "author": "thc202", "createdAt": "2020-10-23T15:04:33Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +82,67 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked());\n+        addButton(importButton);\n+    }\n+\n+    /**\n+     * Checks if {@code regex} is contained in {@code regexes} and if it is a valid regex pattern.\n+     * If {@code regexes} is null, then the duplication check is omitted\n+     *\n+     * @param regex A regex as string\n+     * @param regexes List of regex strings\n+     * @return True if {@code regex} is not a duplicate and the pattern is valid.\n+     * @throws PatternSyntaxException If {@code regex} is not a valid regex pattern\n+     */\n+    private static boolean validateRegexAndCheckForDuplicates(\n+            String trimmedRegex, List<String> regexes) throws PatternSyntaxException {\n+        if (trimmedRegex == null\n+                || trimmedRegex.isEmpty()\n+                || regexes != null && regexes.contains(trimmedRegex)) {\n+            return false;\n+        }\n+        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+        return true;\n+    }\n+\n+    private void importButtonClicked() {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = new ArrayList<String>(getRegexes());\n+\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                String line = null;\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedLine = line.trim();\n+                    if (MultipleRegexesOptionsPanel.validateRegexAndCheckForDuplicates(", "originalCommit": "f1ccd09d846c0beae90f8f212461e093f81c9dcf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTEzNTQxOQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r511135419", "bodyText": "Isn't it best practice to call static methods in a static way, i.e. by calling it via the class name?\nAdded braces to if.", "author": "ckoidl", "createdAt": "2020-10-23T20:16:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg2NzkyMw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r511867923", "bodyText": "I'm not aware of a best practice that requires qualifying the static method calls in the same class (they are called statically regardless).", "author": "thc202", "createdAt": "2020-10-26T10:45:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjIwNjA2Nw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r512206067", "bodyText": "You are right, in the same class it is not required, Changed it.", "author": "ckoidl", "createdAt": "2020-10-26T19:13:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU4MTQ3OA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r512581478", "bodyText": "The call in validateFields can be changed as well, same reason.", "author": "thc202", "createdAt": "2020-10-27T10:40:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjk5OTE4Mg==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r512999182", "bodyText": "done", "author": "ckoidl", "createdAt": "2020-10-27T20:10:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODI1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODMzNA==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r510948334", "bodyText": "The else is not necessary.", "author": "thc202", "createdAt": "2020-10-23T15:04:39Z", "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -224,17 +291,19 @@ protected void init() {\n         @Override\n         protected boolean validateFields() {\n             String trimmedRegex = getRegexTextField().getText().trim();\n-            if (regexes != null && regexes.contains(trimmedRegex)) {\n-                JOptionPane.showMessageDialog(\n-                        this,\n-                        TEXT_ALREADY_EXIST_INVALID_REGEX_DIALOG,\n-                        TITLE_ALREADY_EXIST_INVALID_REGEX_DIALOG,\n-                        JOptionPane.INFORMATION_MESSAGE);\n-                getRegexTextField().requestFocusInWindow();\n-                return false;\n-            }\n             try {\n-                Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                if (MultipleRegexesOptionsPanel.validateRegexAndCheckForDuplicates(\n+                        trimmedRegex, regexes)) {\n+                    return true;\n+                } else {", "originalCommit": "f1ccd09d846c0beae90f8f212461e093f81c9dcf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTEzNjExNw==", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r511136117", "bodyText": "removed else", "author": "ckoidl", "createdAt": "2020-10-23T20:18:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODMzNA=="}], "type": "inlineReview"}, {"oid": "2e4ef6d163cb417ba00c47f7e23e1ea3c5580c21", "url": "https://github.com/zaproxy/zaproxy/commit/2e4ef6d163cb417ba00c47f7e23e1ea3c5580c21", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-23T20:29:41Z", "type": "forcePushed"}, {"oid": "b276f1652ec951d6ca29783cefd84dee4e008c03", "url": "https://github.com/zaproxy/zaproxy/commit/b276f1652ec951d6ca29783cefd84dee4e008c03", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-26T19:11:01Z", "type": "forcePushed"}, {"oid": "8ac5ae194f2f54874d66e731dac949213f15d704", "url": "https://github.com/zaproxy/zaproxy/commit/8ac5ae194f2f54874d66e731dac949213f15d704", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-27T20:10:21Z", "type": "commit"}, {"oid": "8ac5ae194f2f54874d66e731dac949213f15d704", "url": "https://github.com/zaproxy/zaproxy/commit/8ac5ae194f2f54874d66e731dac949213f15d704", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>", "committedDate": "2020-10-27T20:10:21Z", "type": "forcePushed"}]}