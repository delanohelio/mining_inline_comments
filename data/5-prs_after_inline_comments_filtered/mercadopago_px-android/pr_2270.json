{"pr_number": 2270, "pr_title": "PaymentCongrats update amount model", "pr_createdAt": "2020-08-05T20:15:09Z", "pr_url": "https://github.com/mercadopago/px-android/pull/2270", "timeline": [{"oid": "ed38d4fe6a204d5e4c3479e53c8185f94ad3d966", "url": "https://github.com/mercadopago/px-android/commit/ed38d4fe6a204d5e4c3479e53c8185f94ad3d966", "message": "- BusinessPaymentResultMapper now uses PCM\n- adding missing getters in PCM\n- adding new attributes to PaymentInfo\n- modifying PaymentResultAmount Model\n- adapting PaymentResultMethod to new PRA Model and PCM", "committedDate": "2020-07-31T21:28:02Z", "type": "commit"}, {"oid": "4eca4ab0d0b1cc3c6e176326261615f47db97132", "url": "https://github.com/mercadopago/px-android/commit/4eca4ab0d0b1cc3c6e176326261615f47db97132", "message": "PaymentResultInfo added!", "committedDate": "2020-08-03T14:16:06Z", "type": "commit"}, {"oid": "0c40be2d8254c5326fc5d01d5ab1d98eac8a3598", "url": "https://github.com/mercadopago/px-android/commit/0c40be2d8254c5326fc5d01d5ab1d98eac8a3598", "message": "PaymentCongratsText added!", "committedDate": "2020-08-03T14:21:47Z", "type": "commit"}, {"oid": "53702f23eca92a86e59ae4f168a46a2696e1dfa8", "url": "https://github.com/mercadopago/px-android/commit/53702f23eca92a86e59ae4f168a46a2696e1dfa8", "message": "PaymentCongratsResponse.Text deleted!", "committedDate": "2020-08-03T14:24:55Z", "type": "commit"}, {"oid": "dd8409e6fe055f7784a54b19a848f840e0704e32", "url": "https://github.com/mercadopago/px-android/commit/dd8409e6fe055f7784a54b19a848f840e0704e32", "message": "* Added keep rule to keep constructors of renderer classes\n\n(cherry picked from commit 6f794ef4f154aae7db4a0e9b6da6aff9f52eff5a)", "committedDate": "2020-08-03T19:10:13Z", "type": "commit"}, {"oid": "c72707e182f7b7bf1a93200919307cfb9edeef46", "url": "https://github.com/mercadopago/px-android/commit/c72707e182f7b7bf1a93200919307cfb9edeef46", "message": "* enabled r8 full mode in test app\n\n(cherry picked from commit fee4e653116b04f58f314e4f9f8cc8896fd3d53c)", "committedDate": "2020-08-03T19:10:21Z", "type": "commit"}, {"oid": "24dd6ac737eb9ef5eceeccca5d0ba7a9fabd5298", "url": "https://github.com/mercadopago/px-android/commit/24dd6ac737eb9ef5eceeccca5d0ba7a9fabd5298", "message": "* Changelog and version bump", "committedDate": "2020-08-03T19:13:17Z", "type": "commit"}, {"oid": "16ec2c8ab3b782e8e368b919d57bd24ba98c980b", "url": "https://github.com/mercadopago/px-android/commit/16ec2c8ab3b782e8e368b919d57bd24ba98c980b", "message": "[ci deploy]", "committedDate": "2020-08-03T19:28:06Z", "type": "commit"}, {"oid": "180ab96c1c5fc082399b10b3426e420511a361b3", "url": "https://github.com/mercadopago/px-android/commit/180ab96c1c5fc082399b10b3426e420511a361b3", "message": "wip", "committedDate": "2020-08-03T20:13:16Z", "type": "commit"}, {"oid": "e29119f6b2805454fc5e264aecf7e83667570b52", "url": "https://github.com/mercadopago/px-android/commit/e29119f6b2805454fc5e264aecf7e83667570b52", "message": "Merge pull request #2267 from mercadopago/release/4.53.1\n\nRelease/4.53.1", "committedDate": "2020-08-04T12:58:55Z", "type": "commit"}, {"oid": "2b813279cddf9269766e5fa1f6699d1621105c91", "url": "https://github.com/mercadopago/px-android/commit/2b813279cddf9269766e5fa1f6699d1621105c91", "message": "paymentInfo, paymentResultAmount and paymentResultMethod done", "committedDate": "2020-08-04T17:50:48Z", "type": "commit"}, {"oid": "78df2377fd05fbe8fa5564bd105c952a62a0f5eb", "url": "https://github.com/mercadopago/px-android/commit/78df2377fd05fbe8fa5564bd105c952a62a0f5eb", "message": "PaymentCongratsCurrency deleted", "committedDate": "2020-08-04T17:55:09Z", "type": "commit"}, {"oid": "212d178968c7e190fb2160bea3ccea942c5c3445", "url": "https://github.com/mercadopago/px-android/commit/212d178968c7e190fb2160bea3ccea942c5c3445", "message": "generic flow fixed", "committedDate": "2020-08-04T18:33:12Z", "type": "commit"}, {"oid": "856e332d4b1413e46dcd2864e624f5be2efbdae0", "url": "https://github.com/mercadopago/px-android/commit/856e332d4b1413e46dcd2864e624f5be2efbdae0", "message": "basic PaymentCongrats with data form businessPayment", "committedDate": "2020-08-05T18:13:55Z", "type": "commit"}, {"oid": "1d7bed1133d78f8335684cbc56105f997b667350", "url": "https://github.com/mercadopago/px-android/commit/1d7bed1133d78f8335684cbc56105f997b667350", "message": "implemented parcelable and CongratsType", "committedDate": "2020-08-05T18:13:55Z", "type": "commit"}, {"oid": "6a12e600e15480721ed7d57f9ce9003f8a2bf56e", "url": "https://github.com/mercadopago/px-android/commit/6a12e600e15480721ed7d57f9ce9003f8a2bf56e", "message": "javaDoc added!", "committedDate": "2020-08-05T18:13:55Z", "type": "commit"}, {"oid": "b3125e8ac507976587384b12a51829e3252361b6", "url": "https://github.com/mercadopago/px-android/commit/b3125e8ac507976587384b12a51829e3252361b6", "message": "fixes on javaDoc", "committedDate": "2020-08-05T18:13:55Z", "type": "commit"}, {"oid": "0c70f785356474ac2b907579bdc20508dee76f16", "url": "https://github.com/mercadopago/px-android/commit/0c70f785356474ac2b907579bdc20508dee76f16", "message": "javaDoc fixes", "committedDate": "2020-08-05T18:13:55Z", "type": "commit"}, {"oid": "347e9bff3556692d344672d647735c9fffb4aae2", "url": "https://github.com/mercadopago/px-android/commit/347e9bff3556692d344672d647735c9fffb4aae2", "message": "fix enum congratsType", "committedDate": "2020-08-05T18:13:55Z", "type": "commit"}, {"oid": "4457e15dfdbb046b2d420d1329bb85a050c86e41", "url": "https://github.com/mercadopago/px-android/commit/4457e15dfdbb046b2d420d1329bb85a050c86e41", "message": "add PaymentCongratsCurrency", "committedDate": "2020-08-05T18:13:55Z", "type": "commit"}, {"oid": "0650e10d7ff13bce97cd7230d56c2ad7cd23ea72", "url": "https://github.com/mercadopago/px-android/commit/0650e10d7ff13bce97cd7230d56c2ad7cd23ea72", "message": "fix CongratsType", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "fe170ed44a914f9b00c8301bc4269c597ab5493a", "url": "https://github.com/mercadopago/px-android/commit/fe170ed44a914f9b00c8301bc4269c597ab5493a", "message": "receiptIdList removed", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "a9360ca1cfbbab3e19fc3f50c9698d9202b88369", "url": "https://github.com/mercadopago/px-android/commit/a9360ca1cfbbab3e19fc3f50c9698d9202b88369", "message": "removed unused import", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "0a68a0160cc2b877157095d2bf16b46a7978a558", "url": "https://github.com/mercadopago/px-android/commit/0a68a0160cc2b877157095d2bf16b46a7978a558", "message": "Create PaymentInfo for PaymentCongrats (#2240)\n\n* adding dto with the payment info with a builder\r\n* adding nonnull and nullable annotations", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "0a7b55c8cccbb0535163606644bb7ddea22e3c5c", "url": "https://github.com/mercadopago/px-android/commit/0a7b55c8cccbb0535163606644bb7ddea22e3c5c", "message": "Adding CongratsResponse data to PaymentCongrats (#2246)\n\n* adding PaymentCongratsResponse\r\n* adding paymentCongratsResponse tu PaymentCongrats\r\n* added builders for PaymentCongratsResponse needed data\r\n* added classes needed to instantiate PaymentCongratsResponse as inner classes\r\n* added logic to create PaymentCongratsResponse in PaymentCongrats when building it\r\n* removing unneeded attributes", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "e5f9323d5f9a71741b9f3672390a5c3a157c710d", "url": "https://github.com/mercadopago/px-android/commit/e5f9323d5f9a71741b9f3672390a5c3a157c710d", "message": "Add Show method to PaymentCongrats (#2245)\n\n* show method added\r\n* javadoc added!\r\n* PaymentCongrats changed for PaymentCongratsModel", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "dc027980aea09bf794c1c6468e1bc90410d51ad3", "url": "https://github.com/mercadopago/px-android/commit/dc027980aea09bf794c1c6468e1bc90410d51ad3", "message": "Adding payment info to PaymentCongratsModel (#2248)\n\n* moving paymentInfo to paymentCongrats package\r\n* adding PaymentInfo to PaymentCongrats\r\n* no need for this. (pun intended)\r\n* deleted testing code\r\n* changed paymentInfo into a List of paymentsInfo", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "63a7104d6293bda3168cce1c47489e1f7b0971d5", "url": "https://github.com/mercadopago/px-android/commit/63a7104d6293bda3168cce1c47489e1f7b0971d5", "message": "Adding PaymentCongratsResponse mapper (#2255)\n\n* mapper added with nullChecks\r\n* fix responsibility", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "7116b13e3a8c9f3c42ac2a0e5a96595f191f46cf", "url": "https://github.com/mercadopago/px-android/commit/7116b13e3a8c9f3c42ac2a0e5a96595f191f46cf", "message": "- added PaymentMethodType attribute to PaymentInfo as an Enum of PaymentTypes", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "c2d4598dc79c821932d35ee2b4657dc938dda63b", "url": "https://github.com/mercadopago/px-android/commit/c2d4598dc79c821932d35ee2b4657dc938dda63b", "message": "- BusinessPaymentResultMapper now uses PCM\n- adding missing getters in PCM\n- adding new attributes to PaymentInfo\n- modifying PaymentResultAmount Model\n- adapting PaymentResultMethod to new PRA Model and PCM", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "6e6071b5dd87cc92f3da081d39462d603ef2bf5a", "url": "https://github.com/mercadopago/px-android/commit/6e6071b5dd87cc92f3da081d39462d603ef2bf5a", "message": "PaymentResultInfo added!", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "d7ea1432e8f491854c4c22a9a7bc8af438e1986e", "url": "https://github.com/mercadopago/px-android/commit/d7ea1432e8f491854c4c22a9a7bc8af438e1986e", "message": "PaymentCongratsText added!", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "942e68e4ed4adb22aaae5ba2f62bd30dfeac8ffd", "url": "https://github.com/mercadopago/px-android/commit/942e68e4ed4adb22aaae5ba2f62bd30dfeac8ffd", "message": "PaymentCongratsResponse.Text deleted!", "committedDate": "2020-08-05T18:13:56Z", "type": "commit"}, {"oid": "39a4addeda7f824a2d159280406990b7c9445684", "url": "https://github.com/mercadopago/px-android/commit/39a4addeda7f824a2d159280406990b7c9445684", "message": "wip", "committedDate": "2020-08-05T18:15:31Z", "type": "commit"}, {"oid": "5adb023d34fb7899c1a733b4f1917fa3de12c213", "url": "https://github.com/mercadopago/px-android/commit/5adb023d34fb7899c1a733b4f1917fa3de12c213", "message": "paymentInfo, paymentResultAmount and paymentResultMethod done", "committedDate": "2020-08-05T18:15:31Z", "type": "commit"}, {"oid": "8e7f0d3b8ea617183846580116706570f26a3b91", "url": "https://github.com/mercadopago/px-android/commit/8e7f0d3b8ea617183846580116706570f26a3b91", "message": "PaymentCongratsCurrency deleted", "committedDate": "2020-08-05T18:15:32Z", "type": "commit"}, {"oid": "23b5090884d05d41a8a02c4fd811775ffa3bbd05", "url": "https://github.com/mercadopago/px-android/commit/23b5090884d05d41a8a02c4fd811775ffa3bbd05", "message": "generic flow fixed", "committedDate": "2020-08-05T18:15:32Z", "type": "commit"}, {"oid": "b737c232a74ce2fb5972f7efb272dc5c9d13ca21", "url": "https://github.com/mercadopago/px-android/commit/b737c232a74ce2fb5972f7efb272dc5c9d13ca21", "message": "[Feature] Improvement tracking (#2254)\n\n* improvement comfirm data extra info\r\n\r\n* extra info data added for result tracking\r\n\r\n* update service gradle\r\n\r\n* review changes\r\n\r\n* update confirm test", "committedDate": "2020-08-05T18:46:52Z", "type": "commit"}, {"oid": "9d1d2bd6e79976eba130ad698142bf70100fbe64", "url": "https://github.com/mercadopago/px-android/commit/9d1d2bd6e79976eba130ad698142bf70100fbe64", "message": "Merge remote-tracking branch 'origin/feature/payment-congrats-amount-model' into feature/payment-congrats-amount-model\n\n# Conflicts:\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/view/MPTextView.java", "committedDate": "2020-08-05T20:09:46Z", "type": "commit"}, {"oid": "395097981fc381a1023a8485ac29bab20c73fbd2", "url": "https://github.com/mercadopago/px-android/commit/395097981fc381a1023a8485ac29bab20c73fbd2", "message": "Merge branch 'feature/payment-congrats' into feature/payment-congrats-amount-model", "committedDate": "2020-08-05T20:16:17Z", "type": "commit"}, {"oid": "7be9fc371a42fdc3d21c3d37726a5330e25850e4", "url": "https://github.com/mercadopago/px-android/commit/7be9fc371a42fdc3d21c3d37726a5330e25850e4", "message": "Merge pull request #1 from mercadopago/feature/payment-congrats\n\nupdate branch payment congrats", "committedDate": "2020-08-05T20:29:39Z", "type": "commit"}, {"oid": "5796be15870fd57deca49c45e5a61df5866d3abf", "url": "https://github.com/mercadopago/px-android/commit/5796be15870fd57deca49c45e5a61df5866d3abf", "message": "Merge branch 'feature/payment-congrats' into feature/payment-congrats-amount-model", "committedDate": "2020-08-05T20:30:13Z", "type": "commit"}, {"oid": "2e293e83ac08599bbab9d13a93124d99328c8b2b", "url": "https://github.com/mercadopago/px-android/commit/2e293e83ac08599bbab9d13a93124d99328c8b2b", "message": "TODOs added", "committedDate": "2020-08-05T20:33:08Z", "type": "commit"}, {"oid": "1d722296cd7436458318cf881f14183e0ed0b311", "url": "https://github.com/mercadopago/px-android/commit/1d722296cd7436458318cf881f14183e0ed0b311", "message": "fixes", "committedDate": "2020-08-05T20:49:20Z", "type": "commit"}, {"oid": "9a9d0bef5a042228c633a18bc83d635873b9e893", "url": "https://github.com/mercadopago/px-android/commit/9a9d0bef5a042228c633a18bc83d635873b9e893", "message": "remove unused imports", "committedDate": "2020-08-06T13:11:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQ1NDkxNw==", "url": "https://github.com/mercadopago/px-android/pull/2270#discussion_r466454917", "bodyText": "esto quedo asi con todos estos espacios en el medio o es pedo de github?", "author": "nmanuelidesML", "createdAt": "2020-08-06T14:29:47Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/view/PaymentResultMethod.java", "diffHunk": "@@ -139,18 +116,88 @@ public static Model with(@NonNull final PaymentData paymentData, @NonNull final\n             info = builder.info;\n         }\n \n+        public static Model with(@NonNull final PaymentData paymentData, @NonNull final Currency currency) {\n+", "originalCommit": "9a9d0bef5a042228c633a18bc83d635873b9e893", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQ3NTIwOQ==", "url": "https://github.com/mercadopago/px-android/pull/2270#discussion_r466475209", "bodyText": "ah\u00ed lo arregl\u00e9 :D", "author": "mmunozpatinomeli", "createdAt": "2020-08-06T14:58:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQ1NDkxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQ1NjQxOA==", "url": "https://github.com/mercadopago/px-android/pull/2270#discussion_r466456418", "bodyText": "tiene usos este despues de nuestras modificaciones?", "author": "nmanuelidesML", "createdAt": "2020-08-06T14:31:41Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/view/PaymentResultMethod.java", "diffHunk": "@@ -139,18 +116,88 @@ public static Model with(@NonNull final PaymentData paymentData, @NonNull final\n             info = builder.info;\n         }\n \n+        public static Model with(@NonNull final PaymentData paymentData, @NonNull final Currency currency) {\n+\n+\n+\n+\n+            final PaymentInfo.Builder paymentInfoBuilder = new PaymentInfo.Builder()\n+                .withLastFourDigits(paymentData.getToken() != null ? paymentData.getToken().getLastFourDigits() : null)\n+                .withPaymentMethodId(paymentData.getPaymentMethod().getId())\n+                .withPaymentMethodName(paymentData.getPaymentMethod().getName())\n+                .withPaymentMethodType(\n+                    PaymentInfo.PaymentMethodType.fromName(paymentData.getPaymentMethod().getPaymentTypeId()))\n+                .withAmountPaid(getPrettyAmount(currency,\n+                    PaymentDataHelper.getPrettyAmountToPay(paymentData)));\n+\n+            if (paymentData.getPaymentMethod().getDisplayInfo() != null) {\n+                final PaymentResultInfo paymentResultInfo = new PaymentResultInfo(\n+                    paymentData.getPaymentMethod().getDisplayInfo().getResultInfo().getTitle()\n+                    , paymentData.getPaymentMethod().getDisplayInfo().getResultInfo().getSubtitle());\n+\n+                final PaymentCongratsText description = new PaymentCongratsText(\n+                    paymentData.getPaymentMethod().getDisplayInfo().getDescription().getMessage(),\n+                    paymentData.getPaymentMethod().getDisplayInfo().getDescription().getBackgroundColor(),\n+                    paymentData.getPaymentMethod().getDisplayInfo().getDescription().getTextColor(),\n+                    paymentData.getPaymentMethod().getDisplayInfo().getDescription().getWeight()\n+                );\n+\n+                paymentInfoBuilder.withConsumerCreditsInfo(paymentResultInfo)\n+                    .withDescription(description);\n+            }\n+            if (paymentData.getDiscount() != null) {\n+                paymentInfoBuilder\n+                    .withDiscountData(paymentData.getDiscount().getName(), getPrettyAmount(currency,paymentData.getRawAmount()));\n+            }\n+\n+            if (paymentData.getPayerCost() != null) {\n+                paymentInfoBuilder.withInstallmentsData(paymentData.getPayerCost().getInstallments(),\n+                    getPrettyAmount(currency,paymentData.getPayerCost().getInstallmentAmount()),\n+                    getPrettyAmount(currency,paymentData.getPayerCost().getTotalAmount()),\n+                    paymentData.getPayerCost().getInstallmentRate());\n+            }\n+            return with(paymentInfoBuilder.build(), null);\n+        }\n+\n+        private static String getPrettyAmount(@NonNull final Currency currency, @NonNull final BigDecimal amount) {", "originalCommit": "9a9d0bef5a042228c633a18bc83d635873b9e893", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwMzIyNA==", "url": "https://github.com/mercadopago/px-android/pull/2270#discussion_r466503224", "bodyText": "si, lo uso para pasar de un PaymenData (que tiene los montos c\u00f3mo BigDecimal) a un PaymentInfo (que espera el String listo, tipo \"$4.000,25\")", "author": "mmunozpatinomeli", "createdAt": "2020-08-06T15:38:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQ1NjQxOA=="}], "type": "inlineReview"}, {"oid": "ba60e9d830dd155c5d7c1c120d4e4cde1cb81263", "url": "https://github.com/mercadopago/px-android/commit/ba60e9d830dd155c5d7c1c120d4e4cde1cb81263", "message": "fixes", "committedDate": "2020-08-06T14:55:45Z", "type": "commit"}]}