{"pr_number": 1999, "pr_title": "[feature] Off methods fragment selection", "pr_createdAt": "2020-01-08T17:56:35Z", "pr_url": "https://github.com/mercadopago/px-android/pull/1999", "timeline": [{"oid": "2a5b9a0fc0e6ed8ff205f37651ec9e96e10b53ab", "url": "https://github.com/mercadopago/px-android/commit/2a5b9a0fc0e6ed8ff205f37651ec9e96e10b53ab", "message": "added new offline methods model", "committedDate": "2019-12-10T17:38:33Z", "type": "commit"}, {"oid": "6c15ab66c72b49bf6ad9d09eed884e7dc419142b", "url": "https://github.com/mercadopago/px-android/commit/6c15ab66c72b49bf6ad9d09eed884e7dc419142b", "message": "merged to model branch", "committedDate": "2019-12-10T18:42:24Z", "type": "commit"}, {"oid": "c5c03f3f59d1c7105213f141a17382562001b9d5", "url": "https://github.com/mercadopago/px-android/commit/c5c03f3f59d1c7105213f141a17382562001b9d5", "message": "add other methods card view", "committedDate": "2019-12-11T17:29:13Z", "type": "commit"}, {"oid": "961a37144ad93d06a469165164529b21ad8afee7", "url": "https://github.com/mercadopago/px-android/commit/961a37144ad93d06a469165164529b21ad8afee7", "message": "added visibility gone to other methods card view", "committedDate": "2019-12-11T19:30:08Z", "type": "commit"}, {"oid": "a6004369e94c33afc6459843dd9581d9a8cb317d", "url": "https://github.com/mercadopago/px-android/commit/a6004369e94c33afc6459843dd9581d9a8cb317d", "message": "created new offline methods fragment", "committedDate": "2019-12-16T14:40:30Z", "type": "commit"}, {"oid": "87e0b351aa7382169a3f1ac2f7534fa45239c858", "url": "https://github.com/mercadopago/px-android/commit/87e0b351aa7382169a3f1ac2f7534fa45239c858", "message": "Merge branch 'feature/model' into feature/pay-with-other-method-view", "committedDate": "2019-12-16T18:34:31Z", "type": "commit"}, {"oid": "6556c2675265cddf81b95c3d807d1e38ffa67695", "url": "https://github.com/mercadopago/px-android/commit/6556c2675265cddf81b95c3d807d1e38ffa67695", "message": "Merge branch 'feature/one-tap-off-methods' into feature/pay-with-other-method-view", "committedDate": "2019-12-18T16:55:49Z", "type": "commit"}, {"oid": "33939747a691c8303acbdc7e5ae8ab9faf906ae9", "url": "https://github.com/mercadopago/px-android/commit/33939747a691c8303acbdc7e5ae8ab9faf906ae9", "message": "added offline methods fragment", "committedDate": "2019-12-23T20:53:41Z", "type": "commit"}, {"oid": "7c1d9ad6c4df2c0c0d8964fed03dbd267594ef4a", "url": "https://github.com/mercadopago/px-android/commit/7c1d9ad6c4df2c0c0d8964fed03dbd267594ef4a", "message": "fixed start fragment", "committedDate": "2019-12-26T18:32:18Z", "type": "commit"}, {"oid": "2f2a627b36e82b1d1eaffb76dd883bf3fc2d5754", "url": "https://github.com/mercadopago/px-android/commit/2f2a627b36e82b1d1eaffb76dd883bf3fc2d5754", "message": "added radio button asset", "committedDate": "2019-12-26T20:58:44Z", "type": "commit"}, {"oid": "d26a8be69fef24e75a77b589b156d4db8de4d06c", "url": "https://github.com/mercadopago/px-android/commit/d26a8be69fef24e75a77b589b156d4db8de4d06c", "message": "Merge branch 'feature/one-tap-off-methods' into feature/pay-with-other-method-view\n\n# Conflicts:\n#\tpx-services/src/main/java/com/mercadopago/android/px/model/OfflinePaymentTypesMetadata.java", "committedDate": "2019-12-27T15:04:31Z", "type": "commit"}, {"oid": "b3226ea9a8c984b8a1503ad7fd03d8f3a7ad5241", "url": "https://github.com/mercadopago/px-android/commit/b3226ea9a8c984b8a1503ad7fd03d8f3a7ad5241", "message": "Merge branch 'feature/one-tap-off-methods' into feature/pay-with-other-method-view\n\n# Conflicts:\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentPresenter.java\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/viewmodel/drawables/AddNewCardFragmentDrawableFragmentItem.java\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/viewmodel/drawables/DrawableFragmentItem.java\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/viewmodel/mappers/PaymentMethodDrawableItemMapper.java", "committedDate": "2019-12-27T17:38:46Z", "type": "commit"}, {"oid": "d788e0560f52a076a54d4315fa08260f8a092088", "url": "https://github.com/mercadopago/px-android/commit/d788e0560f52a076a54d4315fa08260f8a092088", "message": "* Redesign of add new card and off methods cards in one tap", "committedDate": "2019-12-31T18:56:45Z", "type": "commit"}, {"oid": "584fc76cfdbabe71142615c049298db7d32ed1ef", "url": "https://github.com/mercadopago/px-android/commit/584fc76cfdbabe71142615c049298db7d32ed1ef", "message": "added offline methods mapper", "committedDate": "2020-01-06T20:56:38Z", "type": "commit"}, {"oid": "f1922fc4100950ebb2efb18a1bfa84f12d17f4c8", "url": "https://github.com/mercadopago/px-android/commit/f1922fc4100950ebb2efb18a1bfa84f12d17f4c8", "message": "merged to feature/pay-with-other-method-view", "committedDate": "2020-01-07T12:43:20Z", "type": "commit"}, {"oid": "1a0c6c00ca98ba0ba4052ba489cfd0a84202cfac", "url": "https://github.com/mercadopago/px-android/commit/1a0c6c00ca98ba0ba4052ba489cfd0a84202cfac", "message": "added offline items", "committedDate": "2020-01-07T17:37:07Z", "type": "commit"}, {"oid": "c0968cd601d63649ce10f6cace463eaba9a6ba68", "url": "https://github.com/mercadopago/px-android/commit/c0968cd601d63649ce10f6cace463eaba9a6ba68", "message": "added radio button", "committedDate": "2020-01-07T21:09:26Z", "type": "commit"}, {"oid": "7fbd54df0055fdab1cbf4e63b3f550af67be4844", "url": "https://github.com/mercadopago/px-android/commit/7fbd54df0055fdab1cbf4e63b3f550af67be4844", "message": "disabled pay button", "committedDate": "2020-01-08T14:44:24Z", "type": "commit"}, {"oid": "8f45a92b193e2e7a6744795af3059522df4a2f30", "url": "https://github.com/mercadopago/px-android/commit/8f45a92b193e2e7a6744795af3059522df4a2f30", "message": "removed radio button asset", "committedDate": "2020-01-08T18:02:45Z", "type": "forcePushed"}, {"oid": "aca92fb803f91411ec411f2a962f763dee93c3f8", "url": "https://github.com/mercadopago/px-android/commit/aca92fb803f91411ec411f2a962f763dee93c3f8", "message": "removed radio button asset", "committedDate": "2020-01-08T18:03:48Z", "type": "commit"}, {"oid": "aca92fb803f91411ec411f2a962f763dee93c3f8", "url": "https://github.com/mercadopago/px-android/commit/aca92fb803f91411ec411f2a962f763dee93c3f8", "message": "removed radio button asset", "committedDate": "2020-01-08T18:03:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2MTU2Mw==", "url": "https://github.com/mercadopago/px-android/pull/1999#discussion_r364961563", "bodyText": "poner el comment de default y final", "author": "cgaggino", "createdAt": "2020-01-09T21:11:45Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/FromOfflinePaymentTypesMetadataToOfflineItems.java", "diffHunk": "@@ -0,0 +1,46 @@\n+package com.mercadopago.android.px.internal.features.express.add_new_card;\n+\n+import android.content.Context;\n+import android.support.annotation.NonNull;\n+import com.mercadopago.android.px.internal.util.ResourceUtil;\n+import com.mercadopago.android.px.model.OfflinePaymentMethod;\n+import com.mercadopago.android.px.model.OfflinePaymentType;\n+import com.mercadopago.android.px.model.OfflinePaymentTypesMetadata;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import static com.mercadopago.android.px.internal.util.TextUtil.isEmpty;\n+\n+class FromOfflinePaymentTypesMetadataToOfflineItems {", "originalCommit": "aca92fb803f91411ec411f2a962f763dee93c3f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2MjAwMw==", "url": "https://github.com/mercadopago/px-android/pull/1999#discussion_r364962003", "bodyText": "hay un m\u00e9todo que es isNotEmpty, que es m\u00e1s verbose que !isEmpty", "author": "cgaggino", "createdAt": "2020-01-09T21:12:54Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/FromOfflinePaymentTypesMetadataToOfflineItems.java", "diffHunk": "@@ -0,0 +1,46 @@\n+package com.mercadopago.android.px.internal.features.express.add_new_card;\n+\n+import android.content.Context;\n+import android.support.annotation.NonNull;\n+import com.mercadopago.android.px.internal.util.ResourceUtil;\n+import com.mercadopago.android.px.model.OfflinePaymentMethod;\n+import com.mercadopago.android.px.model.OfflinePaymentType;\n+import com.mercadopago.android.px.model.OfflinePaymentTypesMetadata;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import static com.mercadopago.android.px.internal.util.TextUtil.isEmpty;\n+\n+class FromOfflinePaymentTypesMetadataToOfflineItems {\n+\n+    private final Context context;\n+\n+    public FromOfflinePaymentTypesMetadataToOfflineItems(final Context context) {\n+        this.context = context;\n+    }\n+\n+    @NonNull\n+    public List<OfflineMethodItem> map(@NonNull final OfflinePaymentTypesMetadata metadata) {\n+        final List<OfflineMethodItem> offlineMethodItems = new ArrayList<>();\n+\n+        for (final OfflinePaymentType offlinePaymentType : metadata.getPaymentTypes()) {\n+            offlineMethodItems.add(new OfflineMethodItem(offlinePaymentType.getName()));\n+\n+            for (final OfflinePaymentMethod offlinePaymentMethod : offlinePaymentType.getPaymentMethods()) {\n+                offlineMethodItems.add(\n+                    new OfflineMethodItem(offlinePaymentMethod.getName(), offlinePaymentMethod.getDescription(),\n+                        getIconResourceId(offlinePaymentMethod.getId())));\n+            }\n+        }\n+\n+        return offlineMethodItems;\n+    }\n+\n+    private int getIconResourceId(@NonNull final String methodId) {\n+        if (!isEmpty(methodId)) {", "originalCommit": "aca92fb803f91411ec411f2a962f763dee93c3f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2MjQyNw==", "url": "https://github.com/mercadopago/px-android/pull/1999#discussion_r364962427", "bodyText": "agregar comment de default y final", "author": "cgaggino", "createdAt": "2020-01-09T21:14:06Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodItem.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package com.mercadopago.android.px.internal.features.express.add_new_card;\n+\n+import android.support.annotation.NonNull;\n+import android.support.annotation.Nullable;\n+import com.mercadopago.android.px.model.internal.Text;\n+\n+class OfflineMethodItem {", "originalCommit": "aca92fb803f91411ec411f2a962f763dee93c3f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2MjcxNQ==", "url": "https://github.com/mercadopago/px-android/pull/1999#discussion_r364962715", "bodyText": "idem anteriores", "author": "cgaggino", "createdAt": "2020-01-09T21:14:51Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsAdapter.java", "diffHunk": "@@ -6,32 +6,53 @@\n import android.view.View;\n import android.view.ViewGroup;\n import com.mercadopago.android.px.R;\n-import com.mercadopago.android.px.model.OfflinePaymentType;\n import java.util.List;\n \n class OfflineMethodsAdapter extends RecyclerView.Adapter<OfflineMethodsRowHolder> {", "originalCommit": "aca92fb803f91411ec411f2a962f763dee93c3f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2OTk5Mw==", "url": "https://github.com/mercadopago/px-android/pull/1999#discussion_r364969993", "bodyText": "para que usamos el frame este?", "author": "cgaggino", "createdAt": "2020-01-09T21:33:06Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsRowHolder.java", "diffHunk": "@@ -1,12 +1,54 @@\n package com.mercadopago.android.px.internal.features.express.add_new_card;\n \n import android.support.annotation.NonNull;\n+import android.support.constraint.ConstraintLayout;\n import android.support.v7.widget.RecyclerView;\n import android.view.View;\n+import android.widget.FrameLayout;\n+import android.widget.ImageView;\n+import android.widget.RadioButton;\n+import com.mercadopago.android.px.R;\n+import com.mercadopago.android.px.internal.util.ViewUtils;\n+import com.mercadopago.android.px.internal.view.MPTextView;\n \n class OfflineMethodsRowHolder extends RecyclerView.ViewHolder {\n \n-    public OfflineMethodsRowHolder(@NonNull final View itemView) {\n+    private final MPTextView paymentTypeName;\n+    private final MPTextView paymentMethodName;\n+    private final MPTextView description;\n+    private final FrameLayout methodImageFrame;", "originalCommit": "aca92fb803f91411ec411f2a962f763dee93c3f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk3MTM5NA==", "url": "https://github.com/mercadopago/px-android/pull/1999#discussion_r364971394", "bodyText": "isChecked no deberia ser setChecked?", "author": "cgaggino", "createdAt": "2020-01-09T21:36:41Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsRowHolder.java", "diffHunk": "@@ -1,12 +1,54 @@\n package com.mercadopago.android.px.internal.features.express.add_new_card;\n \n import android.support.annotation.NonNull;\n+import android.support.constraint.ConstraintLayout;\n import android.support.v7.widget.RecyclerView;\n import android.view.View;\n+import android.widget.FrameLayout;\n+import android.widget.ImageView;\n+import android.widget.RadioButton;\n+import com.mercadopago.android.px.R;\n+import com.mercadopago.android.px.internal.util.ViewUtils;\n+import com.mercadopago.android.px.internal.view.MPTextView;\n \n class OfflineMethodsRowHolder extends RecyclerView.ViewHolder {\n \n-    public OfflineMethodsRowHolder(@NonNull final View itemView) {\n+    private final MPTextView paymentTypeName;\n+    private final MPTextView paymentMethodName;\n+    private final MPTextView description;\n+    private final FrameLayout methodImageFrame;\n+    private final ImageView methodImageView;\n+    private final RadioButton radioButton;\n+    private final ConstraintLayout container;\n+\n+    /* default */ OfflineMethodsRowHolder(@NonNull final View itemView) {\n         super(itemView);\n+        container = itemView.findViewById(R.id.offline_item_container);\n+        paymentTypeName = itemView.findViewById(R.id.payment_type_name);\n+        paymentMethodName = itemView.findViewById(R.id.payment_method_name);\n+        description = itemView.findViewById(R.id.description);\n+        methodImageFrame = itemView.findViewById(R.id.method_image);\n+        methodImageView = itemView.findViewById(R.id.method_image_view);\n+        radioButton = itemView.findViewById(R.id.radio_button);\n+    }\n+\n+    public void populate(final OfflineMethodItem offlineItem,\n+        final OfflineMethodsAdapter.OnItemClicked onItemClicked) {\n+        if (offlineItem.isOfflinePaymentTypeItem()) {\n+            ViewUtils.loadOrHide(View.GONE, offlineItem.getName(), paymentTypeName);\n+            paymentMethodName.setVisibility(View.GONE);\n+            description.setVisibility(View.GONE);\n+            methodImageFrame.setVisibility(View.GONE);\n+            radioButton.setVisibility(View.GONE);\n+        } else {\n+            container.setOnClickListener(v -> onItemClicked.onClick());\n+            ViewUtils.loadOrHide(View.GONE, offlineItem.getName(), paymentMethodName);\n+            ViewUtils.loadOrHide(View.GONE, offlineItem.getDescription(), description);\n+            ViewUtils.loadOrGone(offlineItem.getIconId(), methodImageView);\n+        }\n+    }\n+\n+    public void isChecked(final boolean checked) {", "originalCommit": "aca92fb803f91411ec411f2a962f763dee93c3f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6241a6fb7adf4337a2a247db4c2d64451eb6a10b", "url": "https://github.com/mercadopago/px-android/commit/6241a6fb7adf4337a2a247db4c2d64451eb6a10b", "message": "enhancements", "committedDate": "2020-01-10T14:09:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTI2OTQ5Mw==", "url": "https://github.com/mercadopago/px-android/pull/1999#discussion_r365269493", "bodyText": "agregar comment de default y final", "author": "cgaggino", "createdAt": "2020-01-10T14:50:20Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsRowHolder.java", "diffHunk": "@@ -1,12 +1,51 @@\n package com.mercadopago.android.px.internal.features.express.add_new_card;\n \n import android.support.annotation.NonNull;\n+import android.support.constraint.ConstraintLayout;\n import android.support.v7.widget.RecyclerView;\n import android.view.View;\n+import android.widget.ImageView;\n+import android.widget.RadioButton;\n+import com.mercadopago.android.px.R;\n+import com.mercadopago.android.px.internal.util.ViewUtils;\n+import com.mercadopago.android.px.internal.view.MPTextView;\n \n class OfflineMethodsRowHolder extends RecyclerView.ViewHolder {", "originalCommit": "6241a6fb7adf4337a2a247db4c2d64451eb6a10b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4b466c7a267006ed046be13b64f3a620ee545598", "url": "https://github.com/mercadopago/px-android/commit/4b466c7a267006ed046be13b64f3a620ee545598", "message": "code enhancements", "committedDate": "2020-01-10T15:08:17Z", "type": "commit"}, {"oid": "4e4cc840dc69365ce778250ca207da4d26368ec1", "url": "https://github.com/mercadopago/px-android/commit/4e4cc840dc69365ce778250ca207da4d26368ec1", "message": "added suppress lint annotation", "committedDate": "2020-01-13T13:12:57Z", "type": "commit"}, {"oid": "eb9596e4c24179ec5769891b9c07aecd71c30954", "url": "https://github.com/mercadopago/px-android/commit/eb9596e4c24179ec5769891b9c07aecd71c30954", "message": "Merge branch 'feature/one-tap-off-methods' into feature/off-methods-fragment\n\n# Conflicts:\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsAdapter.java\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsFragment.java\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsRowHolder.java\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodFragment.java\n#\tpx-checkout/src/main/java/com/mercadopago/android/px/internal/view/PaymentResultHeader.java\n#\tpx-checkout/src/main/res/layout/px_other_payment_method_card_view_large.xml\n#\tpx-checkout/src/main/res/layout/px_other_payment_method_card_view_small.xml\n#\tpx-checkout/src/main/res/layout/px_payment_result_header.xml", "committedDate": "2020-01-13T18:28:22Z", "type": "commit"}]}