{"pr_number": 2020, "pr_title": "[feature] KYC flow", "pr_createdAt": "2020-01-22T21:20:02Z", "pr_url": "https://github.com/mercadopago/px-android/pull/2020", "timeline": [{"oid": "bc0eca2bc05ba8b82002f0fee21f4c140631d9b2", "url": "https://github.com/mercadopago/px-android/commit/bc0eca2bc05ba8b82002f0fee21f4c140631d9b2", "message": "added KYC flow", "committedDate": "2020-01-21T21:07:37Z", "type": "commit"}, {"oid": "670fe1131c4e036e9a85d413a3ae817f72a784e7", "url": "https://github.com/mercadopago/px-android/commit/670fe1131c4e036e9a85d413a3ae817f72a784e7", "message": "added payment method status", "committedDate": "2020-01-22T15:02:01Z", "type": "commit"}, {"oid": "04d3f34e280ce75dfbe57425dc3b4aed169d5a71", "url": "https://github.com/mercadopago/px-android/commit/04d3f34e280ce75dfbe57425dc3b4aed169d5a71", "message": "refactor", "committedDate": "2020-01-23T12:02:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDA4Mjc4Nw==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370082787", "bodyText": "Creo que el updateModel habr\u00eda que hacerlo solo una vez cuando las vistas ya estan cargadas, es decir, en el onViewCreated del fragment", "author": "cgaggino", "createdAt": "2020-01-23T12:12:53Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsPresenter.java", "diffHunk": "@@ -76,7 +95,7 @@ public void loadViewModel() {\n         updateModel();", "originalCommit": "04d3f34e280ce75dfbe57425dc3b4aed169d5a71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDA4NDg4MA==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370084880", "bodyText": "default?", "author": "cgaggino", "createdAt": "2020-01-23T12:17:44Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/tracking/internal/views/OfflineMethodsData.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package com.mercadopago.android.px.tracking.internal.views;\n+\n+import android.support.annotation.NonNull;\n+import com.mercadopago.android.px.model.OfflinePaymentMethod;\n+import com.mercadopago.android.px.model.OfflinePaymentType;\n+import com.mercadopago.android.px.model.OfflinePaymentTypesMetadata;\n+import com.mercadopago.android.px.tracking.internal.model.AvailableOfflineMethod;\n+import com.mercadopago.android.px.tracking.internal.model.TrackingMapModel;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+\n+class OfflineMethodsData extends TrackingMapModel {\n+\n+    final Collection<AvailableOfflineMethod> availableMethods = new ArrayList<>();", "originalCommit": "04d3f34e280ce75dfbe57425dc3b4aed169d5a71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDA4NTA1OQ==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370085059", "bodyText": "default y final?", "author": "cgaggino", "createdAt": "2020-01-23T12:18:08Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/tracking/internal/views/OfflineMethodsData.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package com.mercadopago.android.px.tracking.internal.views;\n+\n+import android.support.annotation.NonNull;\n+import com.mercadopago.android.px.model.OfflinePaymentMethod;\n+import com.mercadopago.android.px.model.OfflinePaymentType;\n+import com.mercadopago.android.px.model.OfflinePaymentTypesMetadata;\n+import com.mercadopago.android.px.tracking.internal.model.AvailableOfflineMethod;\n+import com.mercadopago.android.px.tracking.internal.model.TrackingMapModel;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+\n+class OfflineMethodsData extends TrackingMapModel {", "originalCommit": "04d3f34e280ce75dfbe57425dc3b4aed169d5a71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDA4NTIzOQ==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370085239", "bodyText": "final", "author": "cgaggino", "createdAt": "2020-01-23T12:18:28Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/tracking/internal/views/OfflineMethodsViewTracker.java", "diffHunk": "@@ -0,0 +1,28 @@\n+package com.mercadopago.android.px.tracking.internal.views;\n+\n+import android.support.annotation.NonNull;\n+import com.mercadopago.android.px.model.OfflinePaymentTypesMetadata;\n+import java.util.Map;\n+\n+public class OfflineMethodsViewTracker extends ViewTracker {", "originalCommit": "04d3f34e280ce75dfbe57425dc3b4aed169d5a71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDA4NzE4OQ==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370087189", "bodyText": "esto no se usa mas, no?", "author": "cgaggino", "createdAt": "2020-01-23T12:23:20Z", "path": "px-services/src/main/java/com/mercadopago/android/px/model/OfflinePaymentTypesMetadata.java", "diffHunk": "@@ -57,4 +57,19 @@ public void writeToParcel(final Parcel dest, final int flags) {\n         dest.writeParcelable(description, flags);\n         dest.writeTypedList(paymentTypes);\n     }\n+\n+    @Nullable\n+    public OfflinePaymentMethod getPaymentMethodById(@NonNull final String paymentTypeId,", "originalCommit": "04d3f34e280ce75dfbe57425dc3b4aed169d5a71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDA4NzMzMw==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370087333", "bodyText": "falta el start activity, no?", "author": "cgaggino", "createdAt": "2020-01-23T12:23:42Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsFragment.java", "diffHunk": "@@ -306,6 +310,12 @@ public void startSecurityValidation(final SecurityValidationData data) {\n         BehaviourProvider.getSecurityBehaviour().startValidation(this, data, REQ_CODE_BIOMETRICS);\n     }\n \n+    @Override\n+    public void startKnowYourCustomerFlow(@NonNull final String flowLink) {\n+        final Intent intent = new Intent(Intent.ACTION_VIEW);\n+        intent.setData(Uri.parse(flowLink));", "originalCommit": "04d3f34e280ce75dfbe57425dc3b4aed169d5a71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ab5b393eb84c89efc5f081cc98e2a0148e0b6de9", "url": "https://github.com/mercadopago/px-android/commit/ab5b393eb84c89efc5f081cc98e2a0148e0b6de9", "message": "enhancements", "committedDate": "2020-01-23T12:31:03Z", "type": "commit"}, {"oid": "eb860e5f71996f58ff7164931cc98cc613b66772", "url": "https://github.com/mercadopago/px-android/commit/eb860e5f71996f58ff7164931cc98cc613b66772", "message": "removed method updateModel", "committedDate": "2020-01-23T12:42:22Z", "type": "commit"}, {"oid": "a09147952cfd311a38822ef47015358565e7c7df", "url": "https://github.com/mercadopago/px-android/commit/a09147952cfd311a38822ef47015358565e7c7df", "message": "added confirm event track", "committedDate": "2020-01-23T15:29:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDYzNjA2Nw==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370636067", "bodyText": "Mover a una interface separada", "author": "cgaggino", "createdAt": "2020-01-24T13:36:33Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/checkout/CheckoutActivity.java", "diffHunk": "@@ -77,6 +77,10 @@ public static Intent getIntent(@NonNull final Context context) {\n         return new Intent(context, CheckoutActivity.class).setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);\n     }\n \n+    public interface BackHandler {", "originalCommit": "1d18672e0cad97de9af673042bf5dabd4f2cc62f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDYzNzY4NA==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370637684", "bodyText": "por que qued\u00f3 publico?", "author": "cgaggino", "createdAt": "2020-01-24T13:40:11Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java", "diffHunk": "@@ -101,7 +101,7 @@\n     OtherPaymentMethodFragment.OnOtherPaymentMethodClickListener {\n \n     private static final String TAG_EXPLODING_FRAGMENT = \"TAG_EXPLODING_FRAGMENT\";\n-    private static final String TAG_OFFLINE_METHODS_FRAGMENT = \"TAG_OFFLINE_METHODS_FRAGMENT\";\n+    public static final String TAG_OFFLINE_METHODS_FRAGMENT = \"TAG_OFFLINE_METHODS_FRAGMENT\";", "originalCommit": "1d18672e0cad97de9af673042bf5dabd4f2cc62f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDYzODIzMA==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370638230", "bodyText": "No Overridea nada?", "author": "cgaggino", "createdAt": "2020-01-24T13:41:29Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentPresenter.java", "diffHunk": "@@ -282,10 +282,14 @@ private void refreshExplodingState() {\n \n     @Override\n     public void cancel() {\n-        tracker.trackAbort();\n+        trackAbort();\n         getView().cancel();\n     }\n \n+    public void trackAbort(){", "originalCommit": "1d18672e0cad97de9af673042bf5dabd4f2cc62f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDYzODM1OQ==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370638359", "bodyText": "Recordar revertir esto", "author": "cgaggino", "createdAt": "2020-01-24T13:41:48Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodItem.java", "diffHunk": "@@ -49,6 +53,11 @@ public int getIconId() {\n         return iconId;\n     }\n \n+    public boolean isAdditionalInfoNeeded() {\n+        //TODO remove\n+        return Session.getInstance().getConfigurationModule().getPaymentSettings().getSite().getId().equals(\"MLB\") ? true : additionalInfoNeeded;", "originalCommit": "1d18672e0cad97de9af673042bf5dabd4f2cc62f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDY0MTMwNQ==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370641305", "bodyText": "No pareciera ser necesario", "author": "cgaggino", "createdAt": "2020-01-24T13:48:26Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsFragment.java", "diffHunk": "@@ -265,6 +267,14 @@ public void showPaymentProcessor() {\n         PaymentProcessorActivity.start(this, REQ_CODE_PAYMENT_PROCESSOR);\n     }\n \n+    @Override\n+    public void onBackPressed() {\n+        if (getFragmentManager() != null) {\n+            presenter.trackAbort();\n+            getFragmentManager().popBackStack();", "originalCommit": "1d18672e0cad97de9af673042bf5dabd4f2cc62f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDY0MTcyOA==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370641728", "bodyText": "Lo haria p\u00fablico y que overridee la interface, como reemplazo de loadViewModel", "author": "cgaggino", "createdAt": "2020-01-24T13:49:21Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsPresenter.java", "diffHunk": "@@ -71,12 +91,7 @@ public void onViewPaused() {\n         paymentRepository.detach(this);\n     }\n \n-    @Override\n-    public void loadViewModel() {\n-        updateModel();\n-    }\n-\n-    private void updateModel() {\n+    /* default */ void updateModel() {", "originalCommit": "1d18672e0cad97de9af673042bf5dabd4f2cc62f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "126caf77494f0d148d9d6cf97b4bfc4df4817c32", "url": "https://github.com/mercadopago/px-android/commit/126caf77494f0d148d9d6cf97b4bfc4df4817c32", "message": "added track abort", "committedDate": "2020-01-24T13:49:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDY0Mjc0NA==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370642744", "bodyText": "por que sacamos esto? creo que forma parte de la l\u00f3gica de todos los explodings que no te deja hacer back si est\u00e1 explotando, habr\u00eda que revisarlo", "author": "cgaggino", "createdAt": "2020-01-24T13:51:36Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsPresenter.java", "diffHunk": "@@ -119,7 +181,6 @@ public void trackSecurityFriction() {\n     private void refreshExplodingState() {\n         if (paymentRepository.isExplodingAnimationCompatible()) {\n             getView().startLoadingButton(paymentRepository.getPaymentTimeout(), payButtonViewModel);\n-            getView().disableCloseButton();", "originalCommit": "126caf77494f0d148d9d6cf97b4bfc4df4817c32", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "727fb6f409de4096e43b8781c53319b089589215", "url": "https://github.com/mercadopago/px-android/commit/727fb6f409de4096e43b8781c53319b089589215", "message": "added track abort", "committedDate": "2020-01-24T14:53:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc0MjY0Mg==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370742642", "bodyText": "si est\u00e1 explotando tampoco deberiamos trackear el abort? no?", "author": "cgaggino", "createdAt": "2020-01-24T17:06:48Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OfflineMethodsFragment.java", "diffHunk": "@@ -265,6 +267,19 @@ public void showPaymentProcessor() {\n         PaymentProcessorActivity.start(this, REQ_CODE_PAYMENT_PROCESSOR);\n     }\n \n+    @Override\n+    public boolean handleBack() {\n+        if (getFragmentManager() != null) {\n+            presenter.trackAbort();\n+        }\n+        return !isExploding();", "originalCommit": "727fb6f409de4096e43b8781c53319b089589215", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc0MzYyOA==", "url": "https://github.com/mercadopago/px-android/pull/2020#discussion_r370743628", "bodyText": "se puede ocultar mientras est\u00e1 explotando?", "author": "cgaggino", "createdAt": "2020-01-24T17:09:05Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java", "diffHunk": "@@ -300,6 +302,7 @@ public void onStateChanged(@NonNull final View view, final int state) {\n                         OfflineMethodsFragment.class);\n                 switch (state) {\n                 case BottomSheetBehavior.STATE_HIDDEN:", "originalCommit": "727fb6f409de4096e43b8781c53319b089589215", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b3b92e7227aeea6d4c51d19d546eaf21d0f9972d", "url": "https://github.com/mercadopago/px-android/commit/b3b92e7227aeea6d4c51d19d546eaf21d0f9972d", "message": "added track abort", "committedDate": "2020-01-24T17:36:30Z", "type": "forcePushed"}, {"oid": "77bfe87965ba1cde2dc177184427570fa503c2d6", "url": "https://github.com/mercadopago/px-android/commit/77bfe87965ba1cde2dc177184427570fa503c2d6", "message": "added track abort", "committedDate": "2020-01-24T20:01:25Z", "type": "commit"}, {"oid": "77bfe87965ba1cde2dc177184427570fa503c2d6", "url": "https://github.com/mercadopago/px-android/commit/77bfe87965ba1cde2dc177184427570fa503c2d6", "message": "added track abort", "committedDate": "2020-01-24T20:01:25Z", "type": "forcePushed"}]}