{"pr_number": 193, "pr_title": "Apply fixes to the CORS REST API", "pr_createdAt": "2020-08-07T22:30:25Z", "pr_url": "https://github.com/wso2/identity-api-server/pull/193", "timeline": [{"oid": "6f628ccb02bd888cf159ff6742dc5c414732b356", "url": "https://github.com/wso2/identity-api-server/commit/6f628ccb02bd888cf159ff6742dc5c414732b356", "message": "Implement CORS origin cleanup", "committedDate": "2020-08-07T21:14:47Z", "type": "commit"}, {"oid": "de6822a45e37eede172bf0ec8abc469324c57170", "url": "https://github.com/wso2/identity-api-server/commit/de6822a45e37eede172bf0ec8abc469324c57170", "message": "Remove tagRequests option in CORS Configurations", "committedDate": "2020-08-07T22:23:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MDI3NA==", "url": "https://github.com/wso2/identity-api-server/pull/193#discussion_r467690274", "bodyText": "Can we remove this additional line?", "author": "mevan-karu", "createdAt": "2020-08-10T05:10:39Z", "path": "components/org.wso2.carbon.identity.api.server.application.management/org.wso2.carbon.identity.api.server.application.management.v1/src/main/java/org/wso2/carbon/identity/api/server/application/management/v1/core/ServerApplicationManagementService.java", "diffHunk": "@@ -812,6 +804,34 @@ private void deleteInbound(String applicationId, String inboundType) {\n             appToUpdate.getInboundAuthenticationConfig().setInboundAuthenticationRequestConfigs(filteredInbounds);\n             updateServiceProvider(applicationId, appToUpdate);\n         }\n+\n+        // Delete the associated CORS origins if the inboundType is oauth2.\n+        if (inboundType.equals(OAUTH2)) {\n+            String tenantDomain = PrivilegedCarbonContext.getThreadLocalCarbonContext().getTenantDomain();\n+            int tenantId = IdentityTenantUtil.getTenantId(tenantDomain);\n+            CORSOriginDAO corsOriginDAO = new CORSOriginDAOImpl();\n+            List<CORSOrigin> existingCORSOrigins = null;\n+            ApplicationBasicInfo applicationBasicInfo = null;\n+            try {\n+                applicationBasicInfo = ApplicationManagementService.getInstance()\n+                        .getApplicationBasicInfoByResourceId(applicationId, tenantDomain);\n+                existingCORSOrigins = corsOriginDAO.getCORSOriginsByApplicationId(\n+                        applicationBasicInfo.getApplicationId(), tenantId);\n+", "originalCommit": "de6822a45e37eede172bf0ec8abc469324c57170", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "df6828dbadeca0cab87d81f8334b02d8556b5697", "url": "https://github.com/wso2/identity-api-server/commit/df6828dbadeca0cab87d81f8334b02d8556b5697", "message": "Rename CORS factory bean\n\n- Bump the framework version", "committedDate": "2020-08-10T08:42:16Z", "type": "commit"}, {"oid": "df6828dbadeca0cab87d81f8334b02d8556b5697", "url": "https://github.com/wso2/identity-api-server/commit/df6828dbadeca0cab87d81f8334b02d8556b5697", "message": "Rename CORS factory bean\n\n- Bump the framework version", "committedDate": "2020-08-10T08:42:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQzNDEwMA==", "url": "https://github.com/wso2/identity-api-server/pull/193#discussion_r488434100", "bodyText": "Fix character length", "author": "jeradrutnam", "createdAt": "2020-09-15T07:05:54Z", "path": "components/org.wso2.carbon.identity.api.server.configs/org.wso2.carbon.identity.api.server.configs.v1/src/gen/java/org/wso2/carbon/identity/api/server/configs/v1/model/CORSConfig.java", "diffHunk": "@@ -239,13 +219,12 @@ public boolean equals(java.lang.Object o) {\n             Objects.equals(this.supportedHeaders, coRSConfig.supportedHeaders) &&\n             Objects.equals(this.exposedHeaders, coRSConfig.exposedHeaders) &&\n             Objects.equals(this.supportsCredentials, coRSConfig.supportsCredentials) &&\n-            Objects.equals(this.maxAge, coRSConfig.maxAge) &&\n-            Objects.equals(this.tagRequests, coRSConfig.tagRequests);\n+            Objects.equals(this.maxAge, coRSConfig.maxAge);\n     }\n \n     @Override\n     public int hashCode() {\n-        return Objects.hash(allowGenericHttpRequests, allowSubdomains, supportedMethods, supportedHeaders, exposedHeaders, supportsCredentials, maxAge, tagRequests);\n+        return Objects.hash(allowGenericHttpRequests, allowSubdomains, supportedMethods, supportedHeaders, exposedHeaders, supportsCredentials, maxAge);", "originalCommit": "df6828dbadeca0cab87d81f8334b02d8556b5697", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE3MzU3Mw==", "url": "https://github.com/wso2/identity-api-server/pull/193#discussion_r493173573", "bodyText": "This is a generated class.", "author": "ivantha", "createdAt": "2020-09-23T03:21:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQzNDEwMA=="}], "type": "inlineReview"}]}