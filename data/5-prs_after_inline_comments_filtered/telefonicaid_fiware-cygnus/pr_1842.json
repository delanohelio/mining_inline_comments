{"pr_number": 1842, "pr_title": "Task/generic sql backend", "pr_createdAt": "2020-03-23T11:23:55Z", "pr_url": "https://github.com/telefonicaid/fiware-cygnus/pull/1842", "timeline": [{"oid": "cb73ed79cb7a3981c99961835b0ea911dde6d047", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/cb73ed79cb7a3981c99961835b0ea911dde6d047", "message": "add generic SQLBackend", "committedDate": "2020-03-19T17:52:51Z", "type": "commit"}, {"oid": "e7ff5ee27bfdaa92d0b373a370658abef3ad716c", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/e7ff5ee27bfdaa92d0b373a370658abef3ad716c", "message": "add generic SQLBackend tests", "committedDate": "2020-03-19T18:01:49Z", "type": "commit"}, {"oid": "a05cec76b6c26e7ae6c5090a3019d5d544882847", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/a05cec76b6c26e7ae6c5090a3019d5d544882847", "message": "add generic sql backend to MySQL sink", "committedDate": "2020-03-19T18:02:42Z", "type": "commit"}, {"oid": "df076f2d6ea3c05317ecd4b0ff6ddf262944f81c", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/df076f2d6ea3c05317ecd4b0ff6ddf262944f81c", "message": "add lazy singleton implementation for mysql backend", "committedDate": "2020-03-20T11:08:42Z", "type": "commit"}, {"oid": "0923c5c5e587f29edf04e7ddc1744cfef73d8261", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/0923c5c5e587f29edf04e7ddc1744cfef73d8261", "message": "edit sql backend to match postgresql", "committedDate": "2020-03-20T12:09:36Z", "type": "commit"}, {"oid": "56b793557ab600e2916d9a6889237a6f48daec38", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/56b793557ab600e2916d9a6889237a6f48daec38", "message": "add generic sql backend for posgresql sink", "committedDate": "2020-03-20T12:09:59Z", "type": "commit"}, {"oid": "8c6c2b887755e6dc968f6d63f1d12a671d05edb3", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/8c6c2b887755e6dc968f6d63f1d12a671d05edb3", "message": "add generic sql backend for posgis sink", "committedDate": "2020-03-20T12:15:49Z", "type": "commit"}, {"oid": "e187a041f7c9e5bee4edaab6abcaaf2fe6f19316", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/e187a041f7c9e5bee4edaab6abcaaf2fe6f19316", "message": "code cleanning", "committedDate": "2020-03-20T12:21:48Z", "type": "commit"}, {"oid": "28f68e35a74c96ed88a29fc77e809035a361bbc3", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/28f68e35a74c96ed88a29fc77e809035a361bbc3", "message": "docs update and remove classes and files from previous backends", "committedDate": "2020-03-20T12:50:53Z", "type": "commit"}, {"oid": "a8e37d178ca22cb91e272da27fcef067c7e5f36f", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/a8e37d178ca22cb91e272da27fcef067c7e5f36f", "message": "fix on default postgres database on generic sql backend", "committedDate": "2020-03-23T09:31:23Z", "type": "commit"}, {"oid": "7c4888e56c26be86326505a85e1a652b708952f0", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/7c4888e56c26be86326505a85e1a652b708952f0", "message": "Update CHANGES_NEXT_RELEASE\n\nCo-Authored-By: Ferm\u00edn Gal\u00e1n M\u00e1rquez <fgalan@users.noreply.github.com>", "committedDate": "2020-03-23T11:29:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM4NTk5MA==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1842#discussion_r396385990", "bodyText": "I guess all logs in SQLBackend should include instance name", "author": "AlvaroVega", "createdAt": "2020-03-23T11:34:47Z", "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/sql/SQLBackend.java", "diffHunk": "@@ -75,196 +67,207 @@ public void close(){\n     } // close\n \n     /**\n-     * Sets the MySQL driver. It is protected since it is only used by the\n+     * Sets the SQL driver. It is protected since it is only used by the\n      * tests.\n-     * \n-     * @param driver\n-     *            The MySQL driver to be set.\n+     *\n+     * @param driver The SQL driver to be set.\n      */\n-    protected void setDriver(MySQLDriver driver) {\n+    public void setDriver(SQLBackend.SQLDriver driver) {\n         this.driver = driver;\n     } // setDriver\n \n-    protected MySQLDriver getDriver() {\n+    public SQLBackend.SQLDriver getDriver() {\n         return driver;\n     } // getDriver\n \n-    @Override\n-    public void createDatabase(String dbName) throws CygnusRuntimeError, CygnusPersistenceError {\n-        if (cache.isCachedDb(dbName)) {\n-            LOGGER.debug(\"'\" + dbName + \"' is cached, thus it is not created\");\n+    public void createDestination(String destination) throws CygnusRuntimeError, CygnusPersistenceError {\n+        if (cache.isCachedDestination(destination)) {\n+            LOGGER.debug(\"'\" + destination + \"' is cached, thus it is not created\");", "originalCommit": "a8e37d178ca22cb91e272da27fcef067c7e5f36f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQwNzg4NA==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1842#discussion_r396407884", "bodyText": "Ok. The class has a generic name so it shouldn't be changed. Is it ok if I add the instance as a sufix of the class name? For instance:\ncom.telefonica.iot.cygnus.sql.sqlBackend.mysql\nWould that be ok?", "author": "IvanHdzC", "createdAt": "2020-03-23T12:17:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM4NTk5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUyNDQ1NQ==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1842#discussion_r396524455", "bodyText": "It would be ok, something know what instance (mysql or postgresql/postgis)", "author": "AlvaroVega", "createdAt": "2020-03-23T15:11:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM4NTk5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyNDI4NA==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1842#discussion_r397024284", "bodyText": "Maybe include self.sqlInstance value in SQLBackendImpl logs would be enough", "author": "AlvaroVega", "createdAt": "2020-03-24T09:50:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM4NTk5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzA2NDkyMg==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1842#discussion_r397064922", "bodyText": "great idea! Thanks @AlvaroVega.\nFixed in 73fcd16", "author": "IvanHdzC", "createdAt": "2020-03-24T10:57:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM4NTk5MA=="}], "type": "inlineReview"}, {"oid": "63fc1b6f12965957ccaa23266a3e282beba68613", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/63fc1b6f12965957ccaa23266a3e282beba68613", "message": "update mkdocs", "committedDate": "2020-03-23T14:03:09Z", "type": "forcePushed"}, {"oid": "f880887ecdb4c3d54ae9b1bcc0e3fd2037202cbb", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/f880887ecdb4c3d54ae9b1bcc0e3fd2037202cbb", "message": "update mkdocs", "committedDate": "2020-03-23T14:05:23Z", "type": "commit"}, {"oid": "f880887ecdb4c3d54ae9b1bcc0e3fd2037202cbb", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/f880887ecdb4c3d54ae9b1bcc0e3fd2037202cbb", "message": "update mkdocs", "committedDate": "2020-03-23T14:05:23Z", "type": "forcePushed"}, {"oid": "adb4518e1f1d47ec28b72bd74b6374771d821b7e", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/adb4518e1f1d47ec28b72bd74b6374771d821b7e", "message": "add SQLBackend interface", "committedDate": "2020-03-23T14:16:45Z", "type": "commit"}, {"oid": "73fcd169075d36e70b889d53fbf82c37dbb1bcba", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/73fcd169075d36e70b889d53fbf82c37dbb1bcba", "message": "add sql instance name to logs", "committedDate": "2020-03-24T10:56:26Z", "type": "commit"}, {"oid": "060383356b7fb0ef07be9e868c0bae69d3a883f9", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/060383356b7fb0ef07be9e868c0bae69d3a883f9", "message": "Merge branch 'master' into task/generic_SQL_backend", "committedDate": "2020-03-24T11:16:41Z", "type": "commit"}]}