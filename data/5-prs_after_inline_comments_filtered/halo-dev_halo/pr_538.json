{"pr_number": 538, "pr_title": "feat: change themes assets base path", "pr_createdAt": "2020-02-01T12:20:15Z", "pr_url": "https://github.com/halo-dev/halo/pull/538", "timeline": [{"oid": "4279e6a17f0b0f3b8d574320225829860cd9ad61", "url": "https://github.com/halo-dev/halo/commit/4279e6a17f0b0f3b8d574320225829860cd9ad61", "message": "feat: change theme resources base path.", "committedDate": "2020-02-01T12:08:48Z", "type": "commit"}, {"oid": "f85a849d41695efda288ccaeb85edc4851c51935", "url": "https://github.com/halo-dev/halo/commit/f85a849d41695efda288ccaeb85edc4851c51935", "message": "feat: add new variable about theme base path.", "committedDate": "2020-02-01T12:16:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzIwMA==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373777200", "bodyText": "\u8fd9\u4e2a\u53d8\u91cf\u540d\u53ef\u4ee5\u518d\u5546\u91cf\u4e0b\u3002", "author": "ruibaby", "createdAt": "2020-02-01T12:21:10Z", "path": "src/main/java/run/halo/app/listener/freemarker/FreemarkerConfigAwareListener.java", "diffHunk": "@@ -103,8 +103,15 @@ private void loadThemeConfig() throws TemplateModelException {\n \n         Boolean enabledAbsolutePath = optionService.getByPropertyOrDefault(OtherProperties.GLOBAL_ABSOLUTE_PATH_ENABLED, Boolean.class, true);\n \n+        String themeBasePath = (enabledAbsolutePath ? optionService.getBlogBaseUrl() : \"\") + \"/themes/\" + activatedTheme.getFolderName();\n+\n         configuration.setSharedVariable(\"theme\", activatedTheme);\n-        configuration.setSharedVariable(\"static\", (enabledAbsolutePath ? optionService.getBlogBaseUrl() : \"\") + \"/\" + activatedTheme.getFolderName());\n+\n+        // TODO: It will be removed in future versions\n+        configuration.setSharedVariable(\"static\", themeBasePath);\n+\n+        configuration.setSharedVariable(\"theme_base\", themeBasePath);", "originalCommit": "f85a849d41695efda288ccaeb85edc4851c51935", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzQ1Ng==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373777456", "bodyText": "\u54ea\u4e2a\u53d8\u91cf\u540d", "author": "guqing", "createdAt": "2020-02-01T12:27:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzIwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzQ4OQ==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373777489", "bodyText": "theme_base", "author": "ruibaby", "createdAt": "2020-02-01T12:27:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzIwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzY4Nw==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373777687", "bodyText": "\u6211\u89c9\u5f97theme_base_path\u901a\u4fd7\u70b9", "author": "guqing", "createdAt": "2020-02-01T12:31:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzIwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3Nzg2OQ==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373777869", "bodyText": "\u592a\u957f\u4e86\uff0c\u5bf9\u4e3b\u9898\u5f00\u53d1\u8005\u4e0d\u53cb\u597d", "author": "ruibaby", "createdAt": "2020-02-01T12:36:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzIwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3Nzk4MA==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373777980", "bodyText": "\u4e5f\u6709\u9053\u7406\ud83d\ude02", "author": "guqing", "createdAt": "2020-02-01T12:38:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzIwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3ODM2MQ==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373778361", "bodyText": "\u6211\u8ba4\u4e3a\u8bed\u4e49\u66f4\u52a0\u91cd\u8981\u3002", "author": "JohnNiang", "createdAt": "2020-02-01T12:47:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzIwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgxNzMwMg==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373817302", "bodyText": "\u55ef\uff0c\u73b0\u5728\u5f88\u591a\u53d8\u91cf\u540d\u5df2\u7ecf\u5f88\u6a21\u68f1\u4e24\u53ef\u4e86\u3002", "author": "ruibaby", "createdAt": "2020-02-02T03:56:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NzIwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3Nzc5OA==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373777798", "bodyText": "\u8fd9\u91cc\u82e5\u662f\u53bb\u6389\u4e86\uff0c\u662f\u5426\u4f1a\u9020\u6210\u4e0d\u517c\u5bb9\u5462\uff1f", "author": "JohnNiang", "createdAt": "2020-02-01T12:35:15Z", "path": "src/main/java/run/halo/app/config/WebMvcAutoConfiguration.java", "diffHunk": "@@ -90,12 +90,17 @@ public void addArgumentResolvers(List<HandlerMethodArgumentResolver> resolvers)\n     @Override\n     public void addResourceHandlers(ResourceHandlerRegistry registry) {\n         String workDir = FILE_PROTOCOL + ensureSuffix(haloProperties.getWorkDir(), FILE_SEPARATOR);\n+\n+        // register /** resource handler.\n         registry.addResourceHandler(\"/**\")\n-                .addResourceLocations(workDir + \"templates/themes/\")", "originalCommit": "4279e6a17f0b0f3b8d574320225829860cd9ad61", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3ODM2Ng==", "url": "https://github.com/halo-dev/halo/pull/538#discussion_r373778366", "bodyText": "\u4e0d\u4f1a\uff0c\u76ee\u524d\u4e3b\u9898\u5168\u662f\u7528\u7684 static \u53d8\u91cf\uff0c\u540c\u65f6\u4fee\u6539 static \u53d8\u91cf\u7684\u503c\u5c31\u884c\u4e86\u3002", "author": "ruibaby", "createdAt": "2020-02-01T12:47:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3Nzc5OA=="}], "type": "inlineReview"}]}