{"pr_number": 6654, "pr_title": "[C++]Enable forward declaration for C++", "pr_createdAt": "2020-06-14T15:45:00Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/6654", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk4NjgyMQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6654#discussion_r439986821", "bodyText": "I don't do much Java, but this loop looks odd, too much indentation levels IMO.\nHalf-assed attempt at fixing this a little - but I went down to 4 indentation levels.\nI simply inverted the if statements, so they could probably be written in a smarter way.\nfor (CodegenProperty property : model.vars) {\n\tif (!(property.isContainer && property.mostInnerItems.isModel) && !(property.isModel))\n\t\tcontinue;\n\t\n\tString innerPropertyType = property.isContainer ? property.mostInnerItems.baseType : property.baseType;\n\tfor (final Entry<String, Object> mo : objs.entrySet()) {\n\t\tCodegenModel innerModel = ModelUtils.getModelByName(mo.getKey(), objs);\n\t\tif (!(innerPropertyType.equals(innerModel.classname) && !innerPropertyType.equals(model.classname) && innerModel.hasVars))\n\t\t\tcontinue;\n\t\tfor (CodegenProperty p : innerModel.vars) {\n\t\t\tif (!((p.isModel && p.dataType.equals(model.classname)) || (p.isContainer && p.mostInnerItems.baseType.equals(model.classname))))\n\t\t\t\tcontinue;\n\t\t\tString forwardDecl = \"class \" + innerModel.classname + \";\";\n\t\t\tif (!forwardDeclarations.contains(forwardDecl)) {\n\t\t\t\tforwardDeclarations.add(forwardDecl);\n\t\t\t}\n\t\t}\n\t}\n}", "author": "muttleyxd", "createdAt": "2020-06-15T07:43:49Z", "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/AbstractCppCodegen.java", "diffHunk": "@@ -353,4 +357,47 @@ public void preprocessOpenAPI(OpenAPI openAPI) {\n         }\n         return postProcessModelsEnum(objs);\n     }\n+\n+    @Override\n+    public Map<String, Object> postProcessAllModels(Map<String, Object> objs){\n+        Map<String, Object> models = super.postProcessAllModels(objs);\n+        for (final Entry<String, Object> model : models.entrySet()) {\n+            CodegenModel mo = ModelUtils.getModelByName(model.getKey(), models);\n+            addForwardDeclarations(mo, models);\n+        }\n+        return models;\n+    }\n+\n+    private void addForwardDeclarations(CodegenModel model, Map<String, Object> objs) {\n+        List<String> forwardDeclarations = new ArrayList<String>();\n+        if(!model.hasVars) {\n+            return;\n+        }\n+        for(CodegenProperty property : model.vars){", "originalCommit": "2467aa068c160b2a256e9d52458119be498a5bba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDA1MDIwNw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6654#discussion_r440050207", "bodyText": "I refactored it a bit.", "author": "etherealjoy", "createdAt": "2020-06-15T09:34:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk4NjgyMQ=="}], "type": "inlineReview"}, {"oid": "825c53ece38328df0d60198b559ce3b25847c032", "url": "https://github.com/OpenAPITools/openapi-generator/commit/825c53ece38328df0d60198b559ce3b25847c032", "message": "Enable forward declaration for C++", "committedDate": "2020-06-15T09:32:58Z", "type": "commit"}, {"oid": "bfbc6f4b56a814d48ba532ab85372021f9bef035", "url": "https://github.com/OpenAPITools/openapi-generator/commit/bfbc6f4b56a814d48ba532ab85372021f9bef035", "message": "Change local var name for readability and remove newline char", "committedDate": "2020-06-15T09:32:58Z", "type": "commit"}, {"oid": "823275616ab6aef51e5d26a122823ba811c5d1a2", "url": "https://github.com/OpenAPITools/openapi-generator/commit/823275616ab6aef51e5d26a122823ba811c5d1a2", "message": "Rename variables and refactor if statements", "committedDate": "2020-06-15T09:32:59Z", "type": "commit"}, {"oid": "823275616ab6aef51e5d26a122823ba811c5d1a2", "url": "https://github.com/OpenAPITools/openapi-generator/commit/823275616ab6aef51e5d26a122823ba811c5d1a2", "message": "Rename variables and refactor if statements", "committedDate": "2020-06-15T09:32:59Z", "type": "forcePushed"}]}