{"pr_number": 6112, "pr_title": "[csharp-netcore] Fixed handling of nullable enum values", "pr_createdAt": "2020-04-29T19:36:45Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/6112", "timeline": [{"oid": "ddd3b5abd2a08cedd3e8ad687e8f4479cbf023d2", "url": "https://github.com/OpenAPITools/openapi-generator/commit/ddd3b5abd2a08cedd3e8ad687e8f4479cbf023d2", "message": "[csharp-netcore] Fixed handling of nullable enum values", "committedDate": "2020-04-29T19:22:47Z", "type": "commit"}, {"oid": "03be724169e145280fe0f2bb08c7762ae8bfd13b", "url": "https://github.com/OpenAPITools/openapi-generator/commit/03be724169e145280fe0f2bb08c7762ae8bfd13b", "message": "Update sample code", "committedDate": "2020-04-29T19:23:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU2MzIxNA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6112#discussion_r417563214", "bodyText": "Only at this timing isEnum is set to the correct value", "author": "shibayan", "createdAt": "2020-04-29T19:37:41Z", "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/AbstractCSharpCodegen.java", "diffHunk": "@@ -603,6 +604,25 @@ protected void updateValueTypeProperty(Map<String, Object> models) {\n         }\n     }\n \n+    /**\n+     * Update property if it is a C# nullable type\n+     *\n+     * @param models list of all models\n+     */\n+    protected void updateNullableTypeProperty(Map<String, Object> models) {\n+        for (Map.Entry<String, Object> entry : models.entrySet()) {\n+            String openAPIName = entry.getKey();\n+            CodegenModel model = ModelUtils.getModelByName(openAPIName, models);\n+            if (model != null) {\n+                for (CodegenProperty var : model.vars) {\n+                    if (!var.isContainer && (nullableType.contains(var.dataType) || var.isEnum)) {\n+                        var.vendorExtensions.put(\"x-csharp-value-type\", true);", "originalCommit": "03be724169e145280fe0f2bb08c7762ae8bfd13b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU2NDIxNQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6112#discussion_r417564215", "bodyText": "Only an enum with type generation can be determined here.", "author": "shibayan", "createdAt": "2020-04-29T19:39:35Z", "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/AbstractCSharpCodegen.java", "diffHunk": "@@ -692,6 +719,37 @@ protected void processOperation(CodegenOperation operation) {\n         // default noop\n     }\n \n+    private void updateCodegenParametersEnum(List<CodegenParameter> parameters, List<Object> allModels) {\n+        for (CodegenParameter parameter : parameters) {\n+            CodegenModel model = null;\n+            for (Object modelHashMap : allModels) {\n+                CodegenModel codegenModel = ((HashMap<String, CodegenModel>) modelHashMap).get(\"model\");\n+                if (codegenModel.getClassname().equals(parameter.dataType)) {\n+                    model = codegenModel;\n+                    break;\n+                }\n+            }\n+\n+            if (model != null) {\n+                // Effectively mark enum models as enums and non-nullable\n+                if (model.isEnum) {\n+                    parameter.isEnum = true;\n+                    parameter.allowableValues = model.allowableValues;\n+                    parameter.isPrimitiveType = true;\n+                    parameter.vendorExtensions.put(\"x-csharp-value-type\", true);", "originalCommit": "03be724169e145280fe0f2bb08c7762ae8bfd13b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU2NDU4MA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6112#discussion_r417564580", "bodyText": "isEnum is always false at this timing", "author": "shibayan", "createdAt": "2020-04-29T19:40:14Z", "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/CSharpNetCoreClientCodegen.java", "diffHunk": "@@ -423,10 +423,6 @@ public void postProcessModelProperty(CodegenModel model, CodegenProperty propert\n         postProcessEmitDefaultValue(property.vendorExtensions);\n \n         super.postProcessModelProperty(model, property);\n-\n-        if (!property.isContainer && (nullableType.contains(property.dataType) || property.isEnum)) {\n-            property.vendorExtensions.put(\"x-csharp-value-type\", true);", "originalCommit": "03be724169e145280fe0f2bb08c7762ae8bfd13b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6945da4490d26e932a4400e0ad85434b068c6daf", "url": "https://github.com/OpenAPITools/openapi-generator/commit/6945da4490d26e932a4400e0ad85434b068c6daf", "message": "Remove unnecessary method calls", "committedDate": "2020-04-29T19:47:01Z", "type": "commit"}]}