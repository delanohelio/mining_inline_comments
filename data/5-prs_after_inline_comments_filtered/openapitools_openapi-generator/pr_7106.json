{"pr_number": 7106, "pr_title": "[bug][core] Copy all attributes (not properties) on composed schemas when flattening models", "pr_createdAt": "2020-08-01T23:17:41Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/7106", "timeline": [{"oid": "fa69a7f4af5ff3de68310281f8ccfb653c8c8332", "url": "https://github.com/OpenAPITools/openapi-generator/commit/fa69a7f4af5ff3de68310281f8ccfb653c8c8332", "message": "[bug] Copy all validations on composed schemas when flattening models", "committedDate": "2020-08-01T23:05:12Z", "type": "commit"}, {"oid": "f7f578851d9853ae9503d5325825d240a25cfe13", "url": "https://github.com/OpenAPITools/openapi-generator/commit/f7f578851d9853ae9503d5325825d240a25cfe13", "message": "Regenerate samples", "committedDate": "2020-08-01T23:08:52Z", "type": "commit"}, {"oid": "eb85d809ec486d0beed60ef903a1a59be204d244", "url": "https://github.com/OpenAPITools/openapi-generator/commit/eb85d809ec486d0beed60ef903a1a59be204d244", "message": "Add regression test for attribute copy of flattened composed schemas", "committedDate": "2020-08-02T02:04:15Z", "type": "commit"}, {"oid": "3770a2b7b4d05ab454f82bb8112a4eea70697f37", "url": "https://github.com/OpenAPITools/openapi-generator/commit/3770a2b7b4d05ab454f82bb8112a4eea70697f37", "message": "Ensure consistent model structure keying with sorted properties in Jackson JSON writer", "committedDate": "2020-08-02T02:04:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA5ODIwMg==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7106#discussion_r464098202", "bodyText": "So I have some questions about how our code works here. Can you help answer them?\n\nThis copies the property from the inline schema into the extracted schema that we put into openapi component schemas, right?\nSo it sets the discriminator on this schema:\n\n      - type: object\n        discriminator: party_type\n        required:\n          - party_type\n        properties:\n          party_type:\n            readOnly: true\n            $ref: '#/definitions/PartyType'\n          tax_id_number:\n            type: string\n\nWhich is extracted and used to create the schema with the key Party_allOf, correct?\n2. Is only one Party_allOf class made for each composed schema or is each inline schema extracted out into its own Party_allOf1, Party_allOf2 etc?\n3. How about adding a javadoc to this method so one can understand this by reading the doc in the future?", "author": "spacether", "createdAt": "2020-08-02T16:41:08Z", "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/InlineModelResolver.java", "diffHunk": "@@ -627,6 +653,30 @@ private Schema modelFromProperty(OpenAPI openAPI, Schema object, String path) {\n         model.setXml(xml);\n         model.setRequired(object.getRequired());\n         model.setNullable(object.getNullable());\n+        model.setDiscriminator(object.getDiscriminator());", "originalCommit": "3770a2b7b4d05ab454f82bb8112a4eea70697f37", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEzNTU0Mg==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7106#discussion_r464135542", "bodyText": "Party_allOf will be created once, then any properties it references will be flattened. Later, we \"lookup\" the transient Party_allOf by serializing and deserializing the structure as the key of a map, and the value as a name. This is how we basically deduplicate those dynamic structures and associate them all with a generated name. See structureMapper in this PR which I've updated to have determinate property order. As it was, Jackson would probably serialize in the same way maybe 99% of the time, but without explicitly sorting it'll follow the same rules as JSON where map properties are technically unordered.", "author": "jimschubert", "createdAt": "2020-08-02T23:20:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA5ODIwMg=="}], "type": "inlineReview"}, {"oid": "410ec31636b934a932a18e1170b4cf9eb913a078", "url": "https://github.com/OpenAPITools/openapi-generator/commit/410ec31636b934a932a18e1170b4cf9eb913a078", "message": "Merge branch 'master' into jersey-inheritance\n\n* master:\n  [core] Add type and format properties to model of inline response (#6153)\n  [PowerShell] better publishing workflow (#7114)\n  [aspnetcore] Typo issues in docs and generated code (#7094)\n  fix http signaure auth in build.sbt (#7110)\n  fix for the issue facing spec invlolving arrayschema structure with ref (#6310)\n  [csharp-netcore] added cancellation tokens to async calls (#7077)\n  [PS] Allow CI to publish the module (#7091)\n  [Dart] Treat float as double (#6924)\n  [Java][jersey2]Fix gradle HttpSignatureAuth dependencies (#7096)\n  move maven,gradle tests to shipppable ci (#7108)", "committedDate": "2020-08-03T23:53:13Z", "type": "commit"}, {"oid": "a034b52fedf0db0562a0c03665ea58f251662d16", "url": "https://github.com/OpenAPITools/openapi-generator/commit/a034b52fedf0db0562a0c03665ea58f251662d16", "message": "Remove unnecessary null checks and duplicate setters in InlineModelResolver", "committedDate": "2020-08-04T01:12:54Z", "type": "commit"}]}