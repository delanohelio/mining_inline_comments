{"pr_number": 108, "pr_title": "RsFull: Add support for building response with all components: status code, headers and body", "pr_createdAt": "2020-04-07T16:22:25Z", "pr_url": "https://github.com/artipie/http/pull/108", "timeline": [{"oid": "cf7329174be5eb2224fa3910e53365b5a4439be6", "url": "https://github.com/artipie/http/commit/cf7329174be5eb2224fa3910e53365b5a4439be6", "message": "RsFull", "committedDate": "2020-04-07T16:21:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA1OTY3Nw==", "url": "https://github.com/artipie/http/pull/108#discussion_r405059677", "bodyText": "@Guseyn expand the description", "author": "Vatavuk", "createdAt": "2020-04-07T19:30:17Z", "path": "src/main/java/com/artipie/http/rs/RsFull.java", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.rs;\n+\n+import com.artipie.http.Connection;\n+import com.artipie.http.Response;\n+import java.nio.ByteBuffer;\n+import java.util.Map;\n+import java.util.concurrent.CompletionStage;\n+import org.reactivestreams.Publisher;\n+\n+/**\n+ * RsFull.", "originalCommit": "cf7329174be5eb2224fa3910e53365b5a4439be6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4NDY2NA==", "url": "https://github.com/artipie/http/pull/108#discussion_r405084664", "bodyText": "@victornoel done", "author": "Guseyn", "createdAt": "2020-04-07T20:15:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA1OTY3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDc4Ng==", "url": "https://github.com/artipie/http/pull/108#discussion_r405064786", "bodyText": "@Guseyn this object composition is unnecessary. We already have origin which will do all this wrapping in its RsWith classes. It should be just this.origin.send(connection)", "author": "Vatavuk", "createdAt": "2020-04-07T19:39:49Z", "path": "src/main/java/com/artipie/http/rs/RsFull.java", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.rs;\n+\n+import com.artipie.http.Connection;\n+import com.artipie.http.Response;\n+import java.nio.ByteBuffer;\n+import java.util.Map;\n+import java.util.concurrent.CompletionStage;\n+import org.reactivestreams.Publisher;\n+\n+/**\n+ * RsFull.\n+ *\n+ * @since 0.8\n+ * @checkstyle ParameterNumberCheck (500 lines)\n+ */\n+public final class RsFull implements Response {\n+\n+    /**\n+     * Origin response.\n+     */\n+    private final Response origin;\n+\n+    /**\n+     * Status code.\n+     */\n+    private final RsStatus status;\n+\n+    /**\n+     * Headers.\n+     */\n+    private final Iterable<Map.Entry<String, String>> headers;\n+\n+    /**\n+     * Body publisher.\n+     */\n+    private final Publisher<ByteBuffer> body;\n+\n+    /**\n+     * Ctor.\n+     * @param origin Origin response\n+     * @param status Status code\n+     * @param headers Headers\n+     * @param body Response body\n+     */\n+    public RsFull(\n+        final Response origin,\n+        final RsStatus status,\n+        final Iterable<Map.Entry<String, String>> headers,\n+        final Publisher<ByteBuffer> body) {\n+        this.origin = new RsWithStatus(\n+            new RsWithHeaders(\n+                new RsWithBody(\n+                    origin, body\n+                ), headers\n+            ), status\n+        );\n+        this.status = status;\n+        this.headers = headers;\n+        this.body = body;\n+    }\n+\n+    @Override\n+    public CompletionStage<Void> send(final Connection connection) {\n+        return this.origin.send(", "originalCommit": "cf7329174be5eb2224fa3910e53365b5a4439be6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4MTY2Mw==", "url": "https://github.com/artipie/http/pull/108#discussion_r405081663", "bodyText": "@victornoel thanks, fixed.", "author": "Guseyn", "createdAt": "2020-04-07T20:10:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDc4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4Mzc1NQ==", "url": "https://github.com/artipie/http/pull/108#discussion_r405083755", "bodyText": "@Guseyn I suppose you meant @Vatavuk ;)", "author": "victornoel", "createdAt": "2020-04-07T20:14:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDc4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4NDg5NA==", "url": "https://github.com/artipie/http/pull/108#discussion_r405084894", "bodyText": "@Vatavuk fixed, thanks.", "author": "Guseyn", "createdAt": "2020-04-07T20:16:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDc4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4NTAxMQ==", "url": "https://github.com/artipie/http/pull/108#discussion_r405085011", "bodyText": "@Guseyn I suppose you meant @Vatavuk ;)\n\nYeah, sorry:)", "author": "Guseyn", "createdAt": "2020-04-07T20:16:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDc4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDkzOQ==", "url": "https://github.com/artipie/http/pull/108#discussion_r405064939", "bodyText": "@Guseyn leave this private", "author": "Vatavuk", "createdAt": "2020-04-07T19:40:08Z", "path": "src/main/java/com/artipie/http/rs/RsWithHeaders.java", "diffHunk": "@@ -87,7 +87,7 @@ public RsWithHeaders(\n      * Connection with additional headers.\n      * @since 0.3\n      */\n-    private static final class ConWithHeaders implements Connection {\n+    public static final class ConWithHeaders implements Connection {", "originalCommit": "cf7329174be5eb2224fa3910e53365b5a4439be6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4NTM5OQ==", "url": "https://github.com/artipie/http/pull/108#discussion_r405085399", "bodyText": "@Vatavuk fixed", "author": "Guseyn", "createdAt": "2020-04-07T20:17:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDkzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTMxNjg4NQ==", "url": "https://github.com/artipie/http/pull/108#discussion_r405316885", "bodyText": "@Guseyn it seems to be not fixed - I can see it in PR diff", "author": "g4s8", "createdAt": "2020-04-08T07:35:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDkzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDk2NA==", "url": "https://github.com/artipie/http/pull/108#discussion_r405064964", "bodyText": "@Guseyn leave this private", "author": "Vatavuk", "createdAt": "2020-04-07T19:40:11Z", "path": "src/main/java/com/artipie/http/rs/RsWithBody.java", "diffHunk": "@@ -116,7 +116,7 @@ public RsWithBody(final Response origin, final Publisher<ByteBuffer> body) {\n      * Connection with body publisher.\n      * @since 0.3\n      */\n-    private static final class ConWithBody implements Connection {\n+    public static final class ConWithBody implements Connection {", "originalCommit": "cf7329174be5eb2224fa3910e53365b5a4439be6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4NTQ3Ng==", "url": "https://github.com/artipie/http/pull/108#discussion_r405085476", "bodyText": "@Vatavuk fixed.", "author": "Guseyn", "createdAt": "2020-04-07T20:17:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NDk2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NTE1Mg==", "url": "https://github.com/artipie/http/pull/108#discussion_r405065152", "bodyText": "@Guseyn leave this private", "author": "Vatavuk", "createdAt": "2020-04-07T19:40:31Z", "path": "src/main/java/com/artipie/http/rs/RsWithHeaders.java", "diffHunk": "@@ -105,7 +105,7 @@ public RsWithHeaders(\n          * @param origin Connection\n          * @param headers Headers\n          */\n-        private ConWithHeaders(\n+        public ConWithHeaders(", "originalCommit": "cf7329174be5eb2224fa3910e53365b5a4439be6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4NTU5Nw==", "url": "https://github.com/artipie/http/pull/108#discussion_r405085597", "bodyText": "@Vatavuk fixed.", "author": "Guseyn", "createdAt": "2020-04-07T20:17:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NTE1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NTE4Mg==", "url": "https://github.com/artipie/http/pull/108#discussion_r405065182", "bodyText": "@Guseyn leave this private", "author": "Vatavuk", "createdAt": "2020-04-07T19:40:34Z", "path": "src/main/java/com/artipie/http/rs/RsWithStatus.java", "diffHunk": "@@ -79,7 +79,7 @@ public String toString() {\n      * Connection with overridden status code.\n      * @since 0.1\n      */\n-    private static final class ConWithStatus implements Connection {\n+    public static final class ConWithStatus implements Connection {", "originalCommit": "cf7329174be5eb2224fa3910e53365b5a4439be6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4NTcwMw==", "url": "https://github.com/artipie/http/pull/108#discussion_r405085703", "bodyText": "@Vatavuk fixed", "author": "Guseyn", "createdAt": "2020-04-07T20:17:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2NTE4Mg=="}], "type": "inlineReview"}, {"oid": "8e25ed4995008cf972c6c142ed198533b4ba1665", "url": "https://github.com/artipie/http/commit/8e25ed4995008cf972c6c142ed198533b4ba1665", "message": "simplify", "committedDate": "2020-04-07T20:09:28Z", "type": "commit"}, {"oid": "5e8b585836c7458645ef0fcbcf01a592b4bf2baa", "url": "https://github.com/artipie/http/commit/5e8b585836c7458645ef0fcbcf01a592b4bf2baa", "message": "fix linkt", "committedDate": "2020-04-07T20:11:22Z", "type": "commit"}, {"oid": "3d31a518e4dacf49df4af28a1b300fe082a8ac66", "url": "https://github.com/artipie/http/commit/3d31a518e4dacf49df4af28a1b300fe082a8ac66", "message": "expand description", "committedDate": "2020-04-07T20:16:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTMxNTY1Ng==", "url": "https://github.com/artipie/http/pull/108#discussion_r405315656", "bodyText": "@Guseyn we don't need this parameter, since this constructor is complete: it includes status, headers and body - so nothing to override for origin", "author": "g4s8", "createdAt": "2020-04-08T07:33:00Z", "path": "src/main/java/com/artipie/http/rs/RsFull.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.rs;\n+\n+import com.artipie.http.Connection;\n+import com.artipie.http.Response;\n+import java.nio.ByteBuffer;\n+import java.util.Map;\n+import java.util.concurrent.CompletionStage;\n+import org.reactivestreams.Publisher;\n+\n+/**\n+ * RsFull, response with status code, headers and body.\n+ *\n+ * @since 0.8\n+ * @checkstyle ParameterNumberCheck (500 lines)\n+ */\n+public final class RsFull implements Response {\n+\n+    /**\n+     * Origin response.\n+     */\n+    private final Response origin;\n+\n+    /**\n+     * Ctor.\n+     * @param origin Origin response\n+     * @param status Status code\n+     * @param headers Headers\n+     * @param body Response body\n+     */\n+    public RsFull(\n+        final Response origin,", "originalCommit": "3d31a518e4dacf49df4af28a1b300fe082a8ac66", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTMxNjI5OA==", "url": "https://github.com/artipie/http/pull/108#discussion_r405316298", "bodyText": "@Guseyn this suppression is not needed, if you remove origin constructor param", "author": "g4s8", "createdAt": "2020-04-08T07:34:10Z", "path": "src/main/java/com/artipie/http/rs/RsFull.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.rs;\n+\n+import com.artipie.http.Connection;\n+import com.artipie.http.Response;\n+import java.nio.ByteBuffer;\n+import java.util.Map;\n+import java.util.concurrent.CompletionStage;\n+import org.reactivestreams.Publisher;\n+\n+/**\n+ * RsFull, response with status code, headers and body.\n+ *\n+ * @since 0.8\n+ * @checkstyle ParameterNumberCheck (500 lines)", "originalCommit": "3d31a518e4dacf49df4af28a1b300fe082a8ac66", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fec14fbc4b9c18d151692d89edc525207dca1fe3", "url": "https://github.com/artipie/http/commit/fec14fbc4b9c18d151692d89edc525207dca1fe3", "message": "fix peivate", "committedDate": "2020-04-08T10:52:30Z", "type": "commit"}, {"oid": "19e3f270c120c1138f7c82a2ce87b25e181a0605", "url": "https://github.com/artipie/http/commit/19e3f270c120c1138f7c82a2ce87b25e181a0605", "message": "simplify", "committedDate": "2020-04-08T10:56:50Z", "type": "commit"}, {"oid": "5e12eebae1a68d83a4de786400344d607690f8cd", "url": "https://github.com/artipie/http/commit/5e12eebae1a68d83a4de786400344d607690f8cd", "message": "rename", "committedDate": "2020-04-08T10:58:38Z", "type": "commit"}]}