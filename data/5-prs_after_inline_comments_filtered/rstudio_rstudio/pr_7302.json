{"pr_number": 7302, "pr_title": "navigate to bookdown xrefs in omni-search", "pr_createdAt": "2020-07-08T18:38:48Z", "pr_url": "https://github.com/rstudio/rstudio/pull/7302", "timeline": [{"oid": "fc8f15f3a94711c53e9c829cc358f93ce2805b2e", "url": "https://github.com/rstudio/rstudio/commit/fc8f15f3a94711c53e9c829cc358f93ce2805b2e", "message": "tweaks", "committedDate": "2020-07-08T21:47:14Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU2MjIxNA==", "url": "https://github.com/rstudio/rstudio/pull/7302#discussion_r452562214", "bodyText": "Perhaps it's accounted for elsewhere, but do we want to have fig:, tab:, etc. filter on xref type?", "author": "jjallaire", "createdAt": "2020-07-10T00:36:30Z", "path": "src/gwt/src/org/rstudio/studio/client/workbench/codesearch/CodeSearchOracle.java", "diffHunk": "@@ -192,51 +192,41 @@ public void requestSuggestions(final Request request,\n       // failed to short-circuit via the cache, hit the server\n       codeSearch_.enqueRequest(request, callback); \n    }\n-     \n+   \n+   // this method converts queries of the form 'foo:<line>:<col>' to\n+   // an appropriate navigation target, transforming the query and\n+   // file position as appropriate\n    public CodeNavigationTarget navigationTarget(String query,\n                                                 Suggestion suggestion)\n    {\n       CodeSearchSuggestion codeSearchSuggestion = (CodeSearchSuggestion) suggestion;\n+      CodeNavigationTarget target = codeSearchSuggestion.getNavigationTarget();\n       \n-      // Allow queries of the form e.g. 'foo:15' to go to line '15' of a file.\n-      // We parse the integer following the ':' if possible.\n-      FilePosition filePos = codeSearchSuggestion.getNavigationTarget().getPosition();\n-      if (codeSearchSuggestion.isFileTarget())\n-      {\n-         int colonIndex = query.indexOf(\":\");\n-         if (colonIndex > 0)\n-         {\n-            String[] splat = query.split(\":\");\n-            if (splat.length > 1)\n-            {\n-               int rowToNavigateTo = 0;\n-               try\n-               {\n-                  rowToNavigateTo = Integer.parseInt(splat[1]);\n-               }\n-               catch (Exception e)\n-               {}\n-               \n-               int colToNavigateTo = 0;\n-               if (splat.length > 2)\n-               {\n-                  try\n-                  {\n-                     colToNavigateTo = Integer.parseInt(splat[2]);\n-                  }\n-                  catch (Exception e)\n-                  {}\n-               }\n-               filePos = FilePosition.create(rowToNavigateTo, colToNavigateTo);\n-            }\n-            \n-         }\n-      }\n+      // nothing to do for non-file targets\n+      if (!codeSearchSuggestion.isFileTarget())\n+         return target;\n+      \n+      // nothing to do if the query doesn't have ':'\n+      int colonIndex = query.indexOf(\":\");", "originalCommit": "fc8f15f3a94711c53e9c829cc358f93ce2805b2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc5Njk2OA==", "url": "https://github.com/rstudio/rstudio/pull/7302#discussion_r452796968", "bodyText": "That would be nice but it's not very discoverable, so hard to know if people would ever use it.", "author": "hadley", "createdAt": "2020-07-10T11:54:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU2MjIxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgwODI3NQ==", "url": "https://github.com/rstudio/rstudio/pull/7302#discussion_r452808275", "bodyText": "That's true. Probably not worth it then.", "author": "jjallaire", "createdAt": "2020-07-10T12:20:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU2MjIxNA=="}], "type": "inlineReview"}, {"oid": "92b4710fcd5ae1eb5c4b86395e7a53b09535e957", "url": "https://github.com/rstudio/rstudio/commit/92b4710fcd5ae1eb5c4b86395e7a53b09535e957", "message": "navigate to bookdown xrefs in omni-search", "committedDate": "2020-07-10T21:42:42Z", "type": "commit"}, {"oid": "13e0052a74f179b2faf08dc0c5a5a9635b2a88fd", "url": "https://github.com/rstudio/rstudio/commit/13e0052a74f179b2faf08dc0c5a5a9635b2a88fd", "message": "navigate to xrefs in text editor", "committedDate": "2020-07-10T21:42:42Z", "type": "commit"}, {"oid": "b77fe754906bb4bf91577ea9b0dd0890fead550a", "url": "https://github.com/rstudio/rstudio/commit/b77fe754906bb4bf91577ea9b0dd0890fead550a", "message": "remove debug print", "committedDate": "2020-07-10T21:42:42Z", "type": "commit"}, {"oid": "94b5580ab47dbe7607be4a84369bb13e2fa14101", "url": "https://github.com/rstudio/rstudio/commit/94b5580ab47dbe7607be4a84369bb13e2fa14101", "message": "consistent XRef capitalization", "committedDate": "2020-07-10T21:42:42Z", "type": "commit"}, {"oid": "e640536fa877e7ea2a16262cadba8061bfa8d588", "url": "https://github.com/rstudio/rstudio/commit/e640536fa877e7ea2a16262cadba8061bfa8d588", "message": "tweaks", "committedDate": "2020-07-10T21:42:42Z", "type": "commit"}, {"oid": "b2a0357a50972c111cd3c8c067dd978cc47df47e", "url": "https://github.com/rstudio/rstudio/commit/b2a0357a50972c111cd3c8c067dd978cc47df47e", "message": "use different icons for different headers", "committedDate": "2020-07-10T21:42:43Z", "type": "commit"}, {"oid": "b2a0357a50972c111cd3c8c067dd978cc47df47e", "url": "https://github.com/rstudio/rstudio/commit/b2a0357a50972c111cd3c8c067dd978cc47df47e", "message": "use different icons for different headers", "committedDate": "2020-07-10T21:42:43Z", "type": "forcePushed"}, {"oid": "de0b176a6afd48792c74109032f13a15586fbdf8", "url": "https://github.com/rstudio/rstudio/commit/de0b176a6afd48792c74109032f13a15586fbdf8", "message": "tweak display for id-containing items", "committedDate": "2020-07-13T16:21:30Z", "type": "commit"}, {"oid": "34d2d7becff53b577ebf68a8eb784f0e52a1f008", "url": "https://github.com/rstudio/rstudio/commit/34d2d7becff53b577ebf68a8eb784f0e52a1f008", "message": "Merge remote-tracking branch 'origin/master' into feature/bookdown-omni-search", "committedDate": "2020-07-20T23:04:32Z", "type": "commit"}]}