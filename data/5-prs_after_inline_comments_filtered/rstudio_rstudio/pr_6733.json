{"pr_number": 6733, "pr_title": "fix ensure visible behavior", "pr_createdAt": "2020-04-24T22:26:32Z", "pr_url": "https://github.com/rstudio/rstudio/pull/6733", "timeline": [{"oid": "1b609493dc8de4fb72351c84d178a7cd462fbcd4", "url": "https://github.com/rstudio/rstudio/commit/1b609493dc8de4fb72351c84d178a7cd462fbcd4", "message": "refine ensure cursor visible behavior", "committedDate": "2020-04-24T22:02:41Z", "type": "commit"}, {"oid": "c78f45e2c0a5adc4e11a45b88a57a45919afe4fc", "url": "https://github.com/rstudio/rstudio/commit/c78f45e2c0a5adc4e11a45b88a57a45919afe4fc", "message": "fix for IE11 tab style", "committedDate": "2020-04-24T22:10:45Z", "type": "commit"}, {"oid": "0db8b1c4f56bca5308b45185eb6011ab01e8cc56", "url": "https://github.com/rstudio/rstudio/commit/0db8b1c4f56bca5308b45185eb6011ab01e8cc56", "message": "guard against attempts to render with no cursor available", "committedDate": "2020-04-24T22:25:46Z", "type": "commit"}, {"oid": "4cef373b7b10f0aab64103078d10b20a3cf0523e", "url": "https://github.com/rstudio/rstudio/commit/4cef373b7b10f0aab64103078d10b20a3cf0523e", "message": "force check for pending scroll after failed scroll attempt", "committedDate": "2020-04-24T22:37:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDkwOTUyNw==", "url": "https://github.com/rstudio/rstudio/pull/6733#discussion_r414909527", "bodyText": "Should we skip doing this if scrollIntoViewPending_ is already true so there's no way for requests to stack up?", "author": "jmcphers", "createdAt": "2020-04-24T23:03:43Z", "path": "src/gwt/src/org/rstudio/studio/client/common/shell/ShellWidget.java", "diffHunk": "@@ -433,7 +435,15 @@ public void consolePrompt(String prompt, boolean showInput)\n    @Override\n    public void ensureInputVisible()\n    {\n-      scrollIntoView();\n+      // NOTE: we don't scroll immediately as this is normally called\n+      // in response to mutations of the console input buffer, and so\n+      // we need to wait until Ace has finished rendering in response\n+      // to that change.\n+      scrollIntoViewPending_ = true;\n+      \n+      // In case there wasn't an Ace render in-flight, force a check\n+      // for pending scroll (which will then force the cursor into view)\n+      Scheduler.get().scheduleDeferred(() -> checkForPendingScroll());", "originalCommit": "4cef373b7b10f0aab64103078d10b20a3cf0523e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDkxNzYwNQ==", "url": "https://github.com/rstudio/rstudio/pull/6733#discussion_r414917605", "bodyText": "Good idea!", "author": "kevinushey", "createdAt": "2020-04-24T23:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDkwOTUyNw=="}], "type": "inlineReview"}, {"oid": "73350c251d4e7dd62e0e58e89d94d5735cf9ef9f", "url": "https://github.com/rstudio/rstudio/commit/73350c251d4e7dd62e0e58e89d94d5735cf9ef9f", "message": "defend against repeated calls to scroll into view", "committedDate": "2020-04-24T23:29:53Z", "type": "commit"}]}