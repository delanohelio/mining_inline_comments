{"pr_number": 7339, "pr_title": "Add new UI for additional source columns and remove feature flag", "pr_createdAt": "2020-07-13T20:44:21Z", "pr_url": "https://github.com/rstudio/rstudio/pull/7339", "timeline": [{"oid": "bca2acfdb3c2a01370fa4ccdc6725a634f765dfc", "url": "https://github.com/rstudio/rstudio/commit/bca2acfdb3c2a01370fa4ccdc6725a634f765dfc", "message": "remove enable additional columns user pref and update add columns UI", "committedDate": "2020-07-13T17:48:38Z", "type": "commit"}, {"oid": "9c87f32a9a709360b1186dc908dcb85946463fdf", "url": "https://github.com/rstudio/rstudio/commit/9c87f32a9a709360b1186dc908dcb85946463fdf", "message": "remove unused function", "committedDate": "2020-07-13T17:51:00Z", "type": "commit"}, {"oid": "5e46fa8b7f1a698cb950bc680f6eb7bcbcdb561a", "url": "https://github.com/rstudio/rstudio/commit/5e46fa8b7f1a698cb950bc680f6eb7bcbcdb561a", "message": "Merge branch 'master' of https://github.com/rstudio/rstudio into feature/columns-options", "committedDate": "2020-07-13T19:14:03Z", "type": "commit"}, {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab", "url": "https://github.com/rstudio/rstudio/commit/3dcba1f6abec568cca78e145bae54e7f9e5d48ab", "message": "clean up consolidate function", "committedDate": "2020-07-13T20:32:06Z", "type": "commit"}, {"oid": "e15244bd5db875a184694f20b0b35d8e38230826", "url": "https://github.com/rstudio/rstudio/commit/e15244bd5db875a184694f20b0b35d8e38230826", "message": "add Allow Source Columns user pref so adding source columns can be disabled", "committedDate": "2020-07-13T23:41:52Z", "type": "commit"}, {"oid": "eb7ae4c3c46a09246ce1d868d36cbfb8d9b8b32c", "url": "https://github.com/rstudio/rstudio/commit/eb7ae4c3c46a09246ce1d868d36cbfb8d9b8b32c", "message": "tone down borders", "committedDate": "2020-07-13T23:48:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAzMzA4Ng==", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r454033086", "bodyText": "Recommend giving this table an accessible name; this is a cheap but effective accessibility improvement for screen reader users.\n     Roles.getGridRole().setAriaLabelProperty(grid_.getElement(), \"Columns and Panes Layout\");", "author": "gtritchie", "createdAt": "2020-07-14T00:53:05Z", "path": "src/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PaneLayoutPreferencesPane.java", "diffHunk": "@@ -320,13 +331,121 @@ else if (!otherIndices.get(i))\n       updateTabSetLabels();\n    }\n \n+   private String updateTable(int newCount)\n+   {\n+      // nothing has changed since the last update\n+      if (grid_ != null && displayColumnCount_ == newCount)\n+         return \"\";\n+\n+      // cells will be twice a wide as columns to preserve space\n+      double columnCount = newCount + (2 * GRID_PANE_COUNT);\n+      double columnWidthValue = (double)TABLE_WIDTH / columnCount;\n+      double cellWidthValue = columnWidthValue * GRID_PANE_COUNT;\n+\n+      // If the column width is bigger than MAX_COLUMN_WIDTH, give space back to the panes\n+      if (newCount > 0 && Math.min(columnWidthValue, MAX_COLUMN_WIDTH) != columnWidthValue)\n+      {\n+         double extra = (newCount * (columnWidthValue - MAX_COLUMN_WIDTH)) / GRID_PANE_COUNT;\n+         cellWidthValue += extra;\n+         columnWidthValue = MAX_COLUMN_WIDTH;\n+      }\n+      cellWidthValue -= (GRID_CELL_SPACING + GRID_CELL_PADDING);\n+      columnWidthValue -= (GRID_CELL_SPACING + GRID_CELL_PADDING);\n+\n+      final String columnWidth = columnWidthValue + \"px\";\n+      final String cellWidth = cellWidthValue + \"px\";\n+      leftTop_.setWidth(cellWidth);\n+      leftBottom_.setWidth(cellWidth);\n+      rightTop_.setWidth(cellWidth);\n+      rightBottom_.setWidth(cellWidth);\n+\n+      // create grid\n+      if (grid_ == null)\n+      {\n+         grid_ = new FlexTable();\n+         grid_.addStyleName(res_.styles().paneLayoutTable());\n+         grid_.setCellSpacing(GRID_CELL_SPACING);\n+         grid_.setCellPadding(GRID_CELL_PADDING);\n+", "originalCommit": "eb7ae4c3c46a09246ce1d868d36cbfb8d9b8b32c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "144eb6fee2105f5a7fb4526a0877a0a8e4b7d764", "url": "https://github.com/rstudio/rstudio/commit/144eb6fee2105f5a7fb4526a0877a0a8e4b7d764", "message": "add accessibility name to grid", "committedDate": "2020-07-14T03:26:36Z", "type": "commit"}, {"oid": "f2ddbf9906d05360650c24da899f5662781c414a", "url": "https://github.com/rstudio/rstudio/commit/f2ddbf9906d05360650c24da899f5662781c414a", "message": "move 'Source' label to top of column, increase padding around drop downs,\ndisable/enable column buttons depending on the current display", "committedDate": "2020-07-14T18:29:02Z", "type": "commit"}, {"oid": "a3d282e4c104e20dced8b4e4207d8d2e6dca2a92", "url": "https://github.com/rstudio/rstudio/commit/a3d282e4c104e20dced8b4e4207d8d2e6dca2a92", "message": "Merge branches 'feature/columns-options' and 'master' of https://github.com/rstudio/rstudio into feature/columns-options\n\n\u0001 Conflicts:\n\u0001\tsrc/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PaneLayoutPreferencesPane.java", "committedDate": "2020-07-15T23:35:23Z", "type": "commit"}]}