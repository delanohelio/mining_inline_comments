{"pr_number": 7822, "pr_title": "ISPN-11275 expose local site name", "pr_createdAt": "2020-02-04T17:07:53Z", "pr_url": "https://github.com/infinispan/infinispan/pull/7822", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgwOTUwNw==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r374809507", "bodyText": "IMO, you should get the site name from RELAY2. the site-name in global configuration isn't mandatory to set and it may be different.", "author": "pruivo", "createdAt": "2020-02-04T17:18:53Z", "path": "core/src/main/java/org/infinispan/manager/CacheManagerInfo.java", "diffHunk": "@@ -107,6 +108,11 @@ public String getClusterName() {\n       return configurationManager.getGlobalConfiguration().transport().clusterName();\n    }\n \n+   public String getLocalSite() {\n+      SiteConfiguration sites = configurationManager.getGlobalConfiguration().sites();", "originalCommit": "78e50099c6b6c8995f7136c76c03ad0d86d80a08", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgxMTQ3OQ==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r374811479", "bodyText": "+1, this seems a random arbitrary property someone left behind :)\nAlso the infinispan-xsite.xml sample config shipped with the server does not use it either", "author": "gustavonalle", "createdAt": "2020-02-04T17:22:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgwOTUwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0ODE4Ng==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r374848186", "bodyText": "created:https://issues.redhat.com/browse/ISPN-11278", "author": "pruivo", "createdAt": "2020-02-04T18:34:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgwOTUwNw=="}], "type": "inlineReview"}, {"oid": "3b6645102712ccb78794209dead42553d451f2d8", "url": "https://github.com/infinispan/infinispan/commit/3b6645102712ccb78794209dead42553d451f2d8", "message": "ISPN-11275 expose local site name", "committedDate": "2020-02-06T16:21:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk4MjM1Ng==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r375982356", "bodyText": "I'm not sure how useful this test is :)", "author": "pruivo", "createdAt": "2020-02-06T17:39:39Z", "path": "server/rest/src/test/java/org/infinispan/rest/resources/CacheManagerResourceTest.java", "diffHunk": "@@ -213,6 +212,7 @@ public void testInfo() throws Exception {\n       assertFalse(cmInfo.get(\"version\").asText().isEmpty());\n       assertEquals(2, cmInfo.get(\"cluster_members\").size());\n       assertEquals(2, cmInfo.get(\"cluster_members_physical_addresses\").size());\n+      assertTrue(cmInfo.get(\"local_site\").isNull());", "originalCommit": "3b6645102712ccb78794209dead42553d451f2d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjIxMzkxOQ==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r376213919", "bodyText": "Test that the property is there with than name. Rest api contract", "author": "karesti", "createdAt": "2020-02-07T04:53:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk4MjM1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjMxNTA3OQ==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r376315079", "bodyText": "well, it doesn't test if it returns the correct name... I'll close my eyes :)", "author": "pruivo", "createdAt": "2020-02-07T10:18:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk4MjM1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA3MTUwMA==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r377071500", "bodyText": "is there an easy way to configure the local site name for the test?", "author": "karesti", "createdAt": "2020-02-10T13:47:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk4MjM1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA5MDkzNQ==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r377090935", "bodyText": "use the method that accepts the TransportFlags when instantiating the CacheManager and  use TransportFlags.minimalXsiteFlags()\nThe local site name will be LON-1", "author": "pruivo", "createdAt": "2020-02-10T14:21:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk4MjM1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjMxNDgxMg==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r376314812", "bodyText": "revert the changes in the imports", "author": "pruivo", "createdAt": "2020-02-07T10:17:38Z", "path": "server/rest/src/test/java/org/infinispan/rest/resources/CacheManagerResourceTest.java", "diffHunk": "@@ -1,20 +1,8 @@\n package org.infinispan.rest.resources;\n \n-import static org.infinispan.commons.dataconversion.MediaType.TEXT_PLAIN_TYPE;\n-import static org.infinispan.configuration.cache.CacheMode.DIST_SYNC;\n-import static org.infinispan.configuration.cache.CacheMode.LOCAL;\n-import static org.infinispan.partitionhandling.PartitionHandling.DENY_READ_WRITES;\n-import static org.testng.Assert.assertNotNull;\n-import static org.testng.Assert.assertTrue;\n-import static org.testng.AssertJUnit.assertEquals;\n-import static org.testng.AssertJUnit.assertFalse;\n-\n-import java.util.ArrayList;\n-import java.util.HashMap;\n-import java.util.List;\n-import java.util.Map;\n-import java.util.stream.Collectors;\n-\n+import com.fasterxml.jackson.databind.JsonNode;", "originalCommit": "3b6645102712ccb78794209dead42553d451f2d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA3MDk0NQ==", "url": "https://github.com/infinispan/infinispan/pull/7822#discussion_r377070945", "bodyText": "reverted", "author": "karesti", "createdAt": "2020-02-10T13:46:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjMxNDgxMg=="}], "type": "inlineReview"}, {"oid": "74130519c5be206579d6a5e0d4c774214082f190", "url": "https://github.com/infinispan/infinispan/commit/74130519c5be206579d6a5e0d4c774214082f190", "message": "ISPN-11275 expose local site name", "committedDate": "2020-02-10T13:45:59Z", "type": "forcePushed"}, {"oid": "a484e0836cbacfb9e96184ed348a9cfdebbb19bd", "url": "https://github.com/infinispan/infinispan/commit/a484e0836cbacfb9e96184ed348a9cfdebbb19bd", "message": "ISPN-11275 expose local site name", "committedDate": "2020-02-10T15:08:42Z", "type": "commit"}, {"oid": "a484e0836cbacfb9e96184ed348a9cfdebbb19bd", "url": "https://github.com/infinispan/infinispan/commit/a484e0836cbacfb9e96184ed348a9cfdebbb19bd", "message": "ISPN-11275 expose local site name", "committedDate": "2020-02-10T15:08:42Z", "type": "forcePushed"}]}