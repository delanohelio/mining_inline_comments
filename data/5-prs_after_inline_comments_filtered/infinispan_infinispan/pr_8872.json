{"pr_number": 8872, "pr_title": "ISPN-12464 Update to Hibernate Search 6.0.0.CR1", "pr_createdAt": "2020-11-18T17:13:13Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8872", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODUyOTkyNg==", "url": "https://github.com/infinispan/infinispan/pull/8872#discussion_r528529926", "bodyText": "Are you sure about this? I think we discussed this at some point and the Search 6 defaults weren't acceptable for Infinispan. I.e. for each index 10 indexing queues, and for each cache about as many threads as the number of processor cores available to the JVM on startup.\nNote that having more indexing queues than threads is not useful.", "author": "yrodiere", "createdAt": "2020-11-23T08:21:30Z", "path": "query/src/main/java/org/infinispan/search/mapper/mapping/impl/IndexProperties.java", "diffHunk": "@@ -31,25 +28,21 @@ public void setProperty(String key, Object value) {\n    }\n \n    public void setProperties(Map<String, Object> properties) {\n-      properties.entrySet().stream()\n-            .forEach(property -> setProperty(property.getKey(), property.getValue()) );\n+      properties.forEach(this::setProperty);\n    }\n \n    public ConfigurationPropertySource createPropertySource(ConfigurationPropertyChecker propertyChecker) {\n       ConfigurationPropertySource basePropertySource =\n             propertyChecker.wrap(ConfigurationPropertySource.fromMap(backendProperties))\n-                  .withPrefix(BACKEND_PROPERTIES_PREFIX);\n+                  .withPrefix(EngineSettings.BACKEND);\n       ConfigurationPropertySource propertySource =\n             basePropertySource.withOverride(ConfigurationPropertySource.fromMap(engineProperties));\n       defaultProperties();\n       return propertySource;\n    }\n \n    private void defaultProperties() {\n-      engineProperties.put(\"hibernate.search.default_backend\", INFINISPAN_BACKEND_NAME);\n       backendProperties.put(\"type\", \"lucene\");\n       backendProperties.put(\"analysis.configurer\", new DefaultAnalysisConfigurer());\n-      backendProperties.put(\"thread_pool.size\", \"1\");\n-      backendProperties.put(\"index_defaults.indexing.queue_count\", \"1\");", "originalCommit": "ae952d808f48bc929bc1d5d06fef34b99bb2ab79", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODY2OTI2NA==", "url": "https://github.com/infinispan/infinispan/pull/8872#discussion_r528669264", "bodyText": "Noted, I revamped the config in #8815, and those will become Infinispan level properties. I was planning handling the defaults there.", "author": "gustavonalle", "createdAt": "2020-11-23T12:30:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODUyOTkyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTM1MDYwMw==", "url": "https://github.com/infinispan/infinispan/pull/8872#discussion_r529350603", "bodyText": "I have moved the defaults to the new config PR at #8815, thanks @yrodiere", "author": "gustavonalle", "createdAt": "2020-11-24T09:33:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODUyOTkyNg=="}], "type": "inlineReview"}, {"oid": "25c3d431e1428bbe363aa641a3b81b5670e98bc8", "url": "https://github.com/infinispan/infinispan/commit/25c3d431e1428bbe363aa641a3b81b5670e98bc8", "message": "ISPN-12464 Update to Hibernate Search 6.0.0.CR1", "committedDate": "2020-11-24T07:32:08Z", "type": "commit"}, {"oid": "47d4dae95b61e399277b7777a02ebc6bbfc07ab9", "url": "https://github.com/infinispan/infinispan/commit/47d4dae95b61e399277b7777a02ebc6bbfc07ab9", "message": "ISPN-12464 Fix timeout test failure and clarify javadoc", "committedDate": "2020-11-24T07:32:08Z", "type": "forcePushed"}, {"oid": "dce7ac83e424d37a2fd4135689a17e78e2e936a3", "url": "https://github.com/infinispan/infinispan/commit/dce7ac83e424d37a2fd4135689a17e78e2e936a3", "message": "ISPN-12464 Fix timeout test failure and clarify javadoc", "committedDate": "2020-11-24T13:42:01Z", "type": "commit"}, {"oid": "dce7ac83e424d37a2fd4135689a17e78e2e936a3", "url": "https://github.com/infinispan/infinispan/commit/dce7ac83e424d37a2fd4135689a17e78e2e936a3", "message": "ISPN-12464 Fix timeout test failure and clarify javadoc", "committedDate": "2020-11-24T13:42:01Z", "type": "forcePushed"}]}