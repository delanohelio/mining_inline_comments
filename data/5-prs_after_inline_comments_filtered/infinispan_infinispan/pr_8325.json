{"pr_number": 8325, "pr_title": "ISPN-11839 Create a test to check licenses in distributions", "pr_createdAt": "2020-05-15T12:59:37Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8325", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwNjQ0NQ==", "url": "https://github.com/infinispan/infinispan/pull/8325#discussion_r426906445", "bodyText": "comment ?", "author": "karesti", "createdAt": "2020-05-18T21:36:33Z", "path": "server/runtime/src/test/java/org/infinispan/server/license/LicenseTest.java", "diffHunk": "@@ -0,0 +1,70 @@\n+package org.infinispan.server.license;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+public class LicenseTest {\n+\n+   private static final Pattern TR_REGEX = Pattern.compile(\"<tr>(.+?)</tr>\", Pattern.DOTALL);\n+   private static final Pattern TD_VALUE_REGEX = Pattern.compile(\"<td>(.+?)</td>\", Pattern.DOTALL);\n+   private static final String SERVER_OUTPUT_PATH = System.getProperty(\"server.output.dir\");\n+\n+   @Test\n+   public void testLicense() throws IOException {\n+\n+      List<String> libs = new ArrayList<>();\n+      Files.list(getLibDir())\n+            .filter(Files::isRegularFile).collect(Collectors.toList())\n+            .forEach(jar -> libs.add(jar.getFileName().toString()));\n+\n+      String html = new String(Files.readAllBytes(getDependencyHtmlFile()));\n+      Matcher trMatcher = TR_REGEX.matcher(html);\n+      List<String> htmlDependencies = new ArrayList<>();\n+      while (trMatcher.find()) {\n+         String trValue = trMatcher.group(1);\n+         Matcher tdMatcher = TD_VALUE_REGEX.matcher(trValue);\n+         if (tdMatcher.find()) {\n+            //String group = tdMatcher.group(1);", "originalCommit": "cef5f792556b09d12b57dfe81d496bd771d62432", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIzODI2NA==", "url": "https://github.com/infinispan/infinispan/pull/8325#discussion_r427238264", "bodyText": "I would like to keep it because if we need the group who will know where is ?", "author": "diegolovison", "createdAt": "2020-05-19T11:46:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwNjQ0NQ=="}], "type": "inlineReview"}, {"oid": "2462fce6fe37d30c86d9b8c44472ab8204b7c559", "url": "https://github.com/infinispan/infinispan/commit/2462fce6fe37d30c86d9b8c44472ab8204b7c559", "message": "ISPN-11839 Create a test to check licenses in distributions", "committedDate": "2020-05-22T13:11:34Z", "type": "commit"}, {"oid": "2462fce6fe37d30c86d9b8c44472ab8204b7c559", "url": "https://github.com/infinispan/infinispan/commit/2462fce6fe37d30c86d9b8c44472ab8204b7c559", "message": "ISPN-11839 Create a test to check licenses in distributions", "committedDate": "2020-05-22T13:11:34Z", "type": "forcePushed"}]}