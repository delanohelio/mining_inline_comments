{"pr_number": 8757, "pr_title": "Upgrade to Hibernate Search 6.0.0.Beta11", "pr_createdAt": "2020-10-09T10:19:34Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8757", "timeline": [{"oid": "7555e8e57145c5e188d58c6b7321bbdb3b8f5219", "url": "https://github.com/infinispan/infinispan/commit/7555e8e57145c5e188d58c6b7321bbdb3b8f5219", "message": "ISPN-12406 Upgrade to Hibernate Search's next version", "committedDate": "2020-10-09T09:07:42Z", "type": "commit"}, {"oid": "82c92732de54280080e4b52d8a1ec1ebab86f3fb", "url": "https://github.com/infinispan/infinispan/commit/82c92732de54280080e4b52d8a1ec1ebab86f3fb", "message": "ISPN-12406 Remove an unnecessary cast", "committedDate": "2020-10-09T09:07:42Z", "type": "commit"}, {"oid": "3731e633a6929ee0d5ba007e09b3c03ab93f6fb4", "url": "https://github.com/infinispan/infinispan/commit/3731e633a6929ee0d5ba007e09b3c03ab93f6fb4", "message": "ISPN-12406 Handle TopFieldDocs more reliably\n\nThis is necessary because of\nhttps://hibernate.atlassian.net/browse/HSEARCH-3917: the type of TopDocs\nno longer depends on whether the sort is null or not; Hibernate Search\nmay return basic TopDocs (not instanceof TopFieldDocs) when a sort if\ndefined explicitly, if that sort is a sort by descending score.", "committedDate": "2020-10-09T09:07:45Z", "type": "commit"}, {"oid": "8ce13ee781bf105f2dc7fcfb4b9f9828d858c642", "url": "https://github.com/infinispan/infinispan/commit/8ce13ee781bf105f2dc7fcfb4b9f9828d858c642", "message": "ISPN-12406 Simplify the configuration key for the Hibernate Search backend\n\nWe no longer need to assign a name to the backend, since at least Beta10\n(maybe Beta9?).\n\nSigned-off-by: Yoann Rodi\u00e8re <yoann@hibernate.org>", "committedDate": "2020-10-09T09:19:17Z", "type": "commit"}, {"oid": "18932df0130259d75e1609031b4c607dcbd14b25", "url": "https://github.com/infinispan/infinispan/commit/18932df0130259d75e1609031b4c607dcbd14b25", "message": "ISPN-12408 Remove uses of DEFAULT_NULL_TOKEN\n\nIt no longer exists in Search 6, even in the compatibility layer.", "committedDate": "2020-10-09T09:19:17Z", "type": "commit"}, {"oid": "ba6a3b8c602282d984e559334e5d073c04b088b9", "url": "https://github.com/infinispan/infinispan/commit/ba6a3b8c602282d984e559334e5d073c04b088b9", "message": "ISPN-12408 Remove deprecated and unused DEFAULT_NULL_TOKEN constant in IndexingMetadata", "committedDate": "2020-10-09T09:19:17Z", "type": "commit"}, {"oid": "9b9e2da5fce36d34baf29662d0f908c0749580cd", "url": "https://github.com/infinispan/infinispan/commit/9b9e2da5fce36d34baf29662d0f908c0749580cd", "message": "ISPN-12407 Remove support for index-time boost\n\nIt isn't supported in Hibernate Search 6 anymore.", "committedDate": "2020-10-09T09:19:17Z", "type": "commit"}, {"oid": "efa99276ab720da26807bd0bfceb30d792f611b5", "url": "https://github.com/infinispan/infinispan/commit/efa99276ab720da26807bd0bfceb30d792f611b5", "message": "ISPN-12275 + ISPN-12278 + ISPN-12279 Replace copy-pasted HSearch 5 annotations with an additional dependency to an HSearch artifact", "committedDate": "2020-10-09T09:19:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM1Mzc4Ng==", "url": "https://github.com/infinispan/infinispan/pull/8757#discussion_r502353786", "bodyText": "This change is only necessary because the previous parsing of @Field was buggy and ignored the analyzer.\nNow that we correctly detect the analyzer, we create a full-text-field as we should, thus Hibernate Search knows any field with a value has norms, and it can use this more efficient way of detecting the presence of a field.", "author": "yrodiere", "createdAt": "2020-10-09T11:06:41Z", "path": "query/src/test/java/org/infinispan/query/dsl/embedded/impl/LuceneTransformationTest.java", "diffHunk": "@@ -539,21 +539,21 @@ public void testNotLikeQuery() {\n    public void testIsNullQuery() {\n       assertGeneratedLuceneQuery(\n             \"select e from org.infinispan.query.dsl.embedded.impl.model.Employee e where e.name IS null\",\n-            \"+(-ConstantScore(__HSEARCH_field_names:name) #*:*)\");\n+            \"+(-ConstantScore(NormsFieldExistsQuery [field=name]) #*:*)\");", "originalCommit": "efa99276ab720da26807bd0bfceb30d792f611b5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM1NDI4NQ==", "url": "https://github.com/infinispan/infinispan/pull/8757#discussion_r502354285", "bodyText": "This change is only necessary because the previous parsing of @SortableField was buggy.\nIf you look at the git history, we actually used to set the forField attribute in Infinispan 11 (because it was necessary), so we're back to normal.", "author": "yrodiere", "createdAt": "2020-10-09T11:07:49Z", "path": "query/src/test/java/org/infinispan/query/dsl/embedded/impl/model/TheEntity.java", "diffHunk": "@@ -26,7 +26,7 @@ public TheEntity(String fieldX, TheEmbeddedEntity embeddedEntity) {\n       this.embeddedEntity = embeddedEntity;\n    }\n \n-   @SortableField\n+   @SortableField(forField = \"theField\")", "originalCommit": "efa99276ab720da26807bd0bfceb30d792f611b5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}