{"pr_number": 8331, "pr_title": "IGNITE-13551 .NET: Enable ClientServerCompatibilityTest on Linux", "pr_createdAt": "2020-10-08T12:17:59Z", "pr_url": "https://github.com/apache/ignite/pull/8331", "timeline": [{"oid": "d3b8d768077703c980c0564e6ddf54277f778b9a", "url": "https://github.com/apache/ignite/commit/d3b8d768077703c980c0564e6ddf54277f778b9a", "message": "Uncomment ClientServerCompatibilityTest", "committedDate": "2020-10-08T06:47:06Z", "type": "commit"}, {"oid": "49e2abcc9328d317d12038d4e8c30816bb396076", "url": "https://github.com/apache/ignite/commit/49e2abcc9328d317d12038d4e8c30816bb396076", "message": "Add TestUtilsJni", "committedDate": "2020-10-08T07:18:08Z", "type": "commit"}, {"oid": "399c66256b022b3933b9b9032d95e90adda0aaf3", "url": "https://github.com/apache/ignite/commit/399c66256b022b3933b9b9032d95e90adda0aaf3", "message": "Adding PlatformProcessUtils", "committedDate": "2020-10-08T07:22:09Z", "type": "commit"}, {"oid": "eff956aa2551206ca709d44bf59e41ce43c5d113", "url": "https://github.com/apache/ignite/commit/eff956aa2551206ca709d44bf59e41ce43c5d113", "message": "Adding PlatformProcessUtils", "committedDate": "2020-10-08T08:15:31Z", "type": "commit"}, {"oid": "c81890ee5885ba38e3e9bd5fe99ed9948b3edf93", "url": "https://github.com/apache/ignite/commit/c81890ee5885ba38e3e9bd5fe99ed9948b3edf93", "message": "Adding TestUtilsJni - start/stop process", "committedDate": "2020-10-08T08:34:48Z", "type": "commit"}, {"oid": "eedc11833b1bf1f189acabe36b67d49e33263790", "url": "https://github.com/apache/ignite/commit/eedc11833b1bf1f189acabe36b67d49e33263790", "message": "Adding TestUtilsJni - start/stop process", "committedDate": "2020-10-08T08:40:15Z", "type": "commit"}, {"oid": "704efcfe29a2187c3ed511b33b359de5fa8d701f", "url": "https://github.com/apache/ignite/commit/704efcfe29a2187c3ed511b33b359de5fa8d701f", "message": "Adding TestUtilsJni - start/stop process", "committedDate": "2020-10-08T11:15:10Z", "type": "commit"}, {"oid": "b727f89586f413ff4fd0fb158c7474545abe4fe9", "url": "https://github.com/apache/ignite/commit/b727f89586f413ff4fd0fb158c7474545abe4fe9", "message": "Use TestUtilsJni to start/stop process", "committedDate": "2020-10-08T11:25:21Z", "type": "commit"}, {"oid": "780542c4d7464bea7b6bce0093d6e64668435c59", "url": "https://github.com/apache/ignite/commit/780542c4d7464bea7b6bce0093d6e64668435c59", "message": "Adding PlatformProcessUtils", "committedDate": "2020-10-08T11:26:05Z", "type": "commit"}, {"oid": "32f0996ea75dae423d6069855195e602e956f4c5", "url": "https://github.com/apache/ignite/commit/32f0996ea75dae423d6069855195e602e956f4c5", "message": "Fix missing JVM error", "committedDate": "2020-10-08T11:36:06Z", "type": "commit"}, {"oid": "03868597973d3ec087fa5c05e5975a73e4dc386c", "url": "https://github.com/apache/ignite/commit/03868597973d3ec087fa5c05e5975a73e4dc386c", "message": "Fix PlatformProcessUtils timeout handling", "committedDate": "2020-10-08T11:47:12Z", "type": "commit"}, {"oid": "f26191fb92fb070ed8b9118f8c8e9106d8ed34c8", "url": "https://github.com/apache/ignite/commit/f26191fb92fb070ed8b9118f8c8e9106d8ed34c8", "message": "Fix PlatformProcessUtils timeout handling", "committedDate": "2020-10-08T11:53:37Z", "type": "commit"}, {"oid": "c8a4c8686ad873695499f5ed3a83031409e65bbb", "url": "https://github.com/apache/ignite/commit/c8a4c8686ad873695499f5ed3a83031409e65bbb", "message": "Fix PlatformProcessUtils timeout handling", "committedDate": "2020-10-08T11:59:55Z", "type": "commit"}, {"oid": "e51aeec60637fb45acfad97b35960aabc05a9383", "url": "https://github.com/apache/ignite/commit/e51aeec60637fb45acfad97b35960aabc05a9383", "message": "Fixing JNI call", "committedDate": "2020-10-08T12:11:51Z", "type": "commit"}, {"oid": "d095908fd6127d782312aecea17461cfe794c563", "url": "https://github.com/apache/ignite/commit/d095908fd6127d782312aecea17461cfe794c563", "message": "Fixing JNI call", "committedDate": "2020-10-08T12:14:04Z", "type": "commit"}, {"oid": "d8140cfdece089172f602c0bb7cea6fa3d66acda", "url": "https://github.com/apache/ignite/commit/d8140cfdece089172f602c0bb7cea6fa3d66acda", "message": "Fixing JNI call", "committedDate": "2020-10-08T12:16:28Z", "type": "commit"}, {"oid": "513edf7a2f419573aba1787aa8f3c7640a387a0b", "url": "https://github.com/apache/ignite/commit/513edf7a2f419573aba1787aa8f3c7640a387a0b", "message": "Cleanup", "committedDate": "2020-10-08T12:17:29Z", "type": "commit"}, {"oid": "e1d87319f2186057cfc4fafde655b58c3c758074", "url": "https://github.com/apache/ignite/commit/e1d87319f2186057cfc4fafde655b58c3c758074", "message": "Cleanup - remove unused code", "committedDate": "2020-10-08T12:23:15Z", "type": "commit"}, {"oid": "9ab96e3e2fe9ad317c0bc7264d4ddf75d1d43402", "url": "https://github.com/apache/ignite/commit/9ab96e3e2fe9ad317c0bc7264d4ddf75d1d43402", "message": "Fix import style", "committedDate": "2020-10-08T13:26:12Z", "type": "commit"}, {"oid": "f3432abc62b22b0a7521edc0157a28b0d83ae218", "url": "https://github.com/apache/ignite/commit/f3432abc62b22b0a7521edc0157a28b0d83ae218", "message": "Fix style", "committedDate": "2020-10-08T13:33:31Z", "type": "commit"}, {"oid": "e08b08812d258bb2663a4a4f5ddbf93b9de71491", "url": "https://github.com/apache/ignite/commit/e08b08812d258bb2663a4a4f5ddbf93b9de71491", "message": "Fix build on old .NET", "committedDate": "2020-10-08T13:43:18Z", "type": "commit"}, {"oid": "a07bb81ee70adb3f50d12c12c51bb11ca2dbfd34", "url": "https://github.com/apache/ignite/commit/a07bb81ee70adb3f50d12c12c51bb11ca2dbfd34", "message": "Fix hang on windows caused by not reading from stdout", "committedDate": "2020-10-08T16:56:57Z", "type": "commit"}, {"oid": "f60ed925a62b69c81eca18fb3819c3aa74c212c6", "url": "https://github.com/apache/ignite/commit/f60ed925a62b69c81eca18fb3819c3aa74c212c6", "message": "Fix process kill on Windows", "committedDate": "2020-10-08T17:35:30Z", "type": "commit"}, {"oid": "5484f2283ed4db99f56c675757a9c0f37ea773be", "url": "https://github.com/apache/ignite/commit/5484f2283ed4db99f56c675757a9c0f37ea773be", "message": "Skip dealing with process trees on non-Windows OS", "committedDate": "2020-10-08T18:08:37Z", "type": "commit"}, {"oid": "e93b3dc5b6b174c05bf8e7d95a9399f07cf67c5f", "url": "https://github.com/apache/ignite/commit/e93b3dc5b6b174c05bf8e7d95a9399f07cf67c5f", "message": "Skip dealing with process trees on non-Windows OS", "committedDate": "2020-10-08T18:09:36Z", "type": "commit"}, {"oid": "d3b55d1a80bd7c0658b4affca5006c01992fa83a", "url": "https://github.com/apache/ignite/commit/d3b55d1a80bd7c0658b4affca5006c01992fa83a", "message": "Merge remote-tracking branch 'origin/master' into ignite-13551", "committedDate": "2020-10-09T06:46:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjI4NTI0OA==", "url": "https://github.com/apache/ignite/pull/8331#discussion_r502285248", "bodyText": "Is this a limitation, or do we just not need several processes right now and this was the simpliest implementation?", "author": "isapego", "createdAt": "2020-10-09T08:54:10Z", "path": "modules/core/src/test/java/org/apache/ignite/platform/PlatformProcessUtils.java", "diffHunk": "@@ -0,0 +1,111 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.ignite.platform;\n+\n+import java.io.BufferedReader;\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.InputStreamReader;\n+import java.util.concurrent.ForkJoinPool;\n+import java.util.concurrent.Future;\n+import java.util.concurrent.TimeUnit;\n+\n+import org.apache.ignite.IgniteException;\n+\n+/**\n+ * Platform process utils for tests.\n+ */\n+@SuppressWarnings(\"unused\") // Called from Platform.\n+public class PlatformProcessUtils {\n+    /** */\n+    private static volatile Process process;\n+\n+    /**\n+     * Starts a new process.\n+     *\n+     * @param file Executable name.\n+     * @param arg1 Argument.\n+     * @param arg2 Argument.\n+     * @param workDir Work directory.\n+     * @param waitForOutput A string to look for in the output.\n+     */\n+    public static void startProcess(String file, String arg1, String arg2, String workDir, String waitForOutput)\n+            throws Exception {\n+        if (process != null)\n+            throw new Exception(\"PlatformProcessUtils can't start more than one process at a time.\");", "originalCommit": "d3b55d1a80bd7c0658b4affca5006c01992fa83a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjI5ODY1Nw==", "url": "https://github.com/apache/ignite/pull/8331#discussion_r502298657", "bodyText": "It would be great to return PID and then use it to kill the process. Unfortunately, Process.pid() was only added in Java 9, and we have to be able to run on Java 8.\nSo yes, this is a simplification - good enough for tests.", "author": "ptupitsyn", "createdAt": "2020-10-09T09:17:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjI4NTI0OA=="}], "type": "inlineReview"}]}