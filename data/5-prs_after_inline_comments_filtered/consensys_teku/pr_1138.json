{"pr_number": 1138, "pr_title": "Remove usage of grpc for validator signing", "pr_createdAt": "2020-02-06T00:08:08Z", "pr_url": "https://github.com/ConsenSys/teku/pull/1138", "timeline": [{"oid": "3e54f6685a8ebb5b8cbd54e924bdc795abbfb554", "url": "https://github.com/ConsenSys/teku/commit/3e54f6685a8ebb5b8cbd54e924bdc795abbfb554", "message": "Remove usage of grpc for validator signing.\nAvoids creating insecure open ports that expose the signing key\nAvoids port conflicts when running multiple instances on the same host", "committedDate": "2020-02-06T00:05:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NTI0Mg==", "url": "https://github.com/ConsenSys/teku/pull/1138#discussion_r375585242", "bodyText": "Unrelated but, it might be a good idea to move the naughtyValidator functionality to the test environment.", "author": "cemozerr", "createdAt": "2020-02-06T00:34:45Z", "path": "validator/coordinator/src/main/java/tech/pegasys/artemis/validator/coordinator/ValidatorLoader.java", "diffHunk": "@@ -47,14 +44,11 @@\n     // Validators map\n     for (int i = 0; i < keypairs.size(); i++) {\n       BLSKeyPair keypair = keypairs.get(i);\n-      int port =\n-          Constants.VALIDATOR_CLIENT_PORT_BASE + i + keyProvider.getValidatorPortStartIndex();\n-      new ValidatorClient(keypair, port);\n-      ManagedChannel channel =\n-          ManagedChannelBuilder.forAddress(\"localhost\", port).usePlaintext().build();\n+      final LocalMessageSignerService signerService = new LocalMessageSignerService(keypair);\n       STDOUT.log(Level.DEBUG, \"Validator \" + i + \": \" + keypair.getPublicKey().toString());\n \n-      validators.put(keypair.getPublicKey(), new ValidatorInfo(numNaughtyValidators > 0, channel));\n+      validators.put(\n+          keypair.getPublicKey(), new ValidatorInfo(numNaughtyValidators > 0, signerService));", "originalCommit": "3e54f6685a8ebb5b8cbd54e924bdc795abbfb554", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTYwNzY1Nw==", "url": "https://github.com/ConsenSys/teku/pull/1138#discussion_r375607657", "bodyText": "Yeah I think that should just be removed - having the production code be capable of bad behaviour is a bad idea.", "author": "ajsutton", "createdAt": "2020-02-06T02:05:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NTI0Mg=="}], "type": "inlineReview"}]}