{"pr_number": 2659, "pr_title": "Support reading withdrawal public key from keystore", "pr_createdAt": "2020-08-26T14:30:45Z", "pr_url": "https://github.com/ConsenSys/teku/pull/2659", "timeline": [{"oid": "0b20b44b336ae25614ad164e12436a7abae2dfe5", "url": "https://github.com/ConsenSys/teku/commit/0b20b44b336ae25614ad164e12436a7abae2dfe5", "message": "Support reading withdrawal public key from keystore", "committedDate": "2020-08-26T14:29:24Z", "type": "commit"}, {"oid": "72040916170ea7769269a8d66d429c7f195bf935", "url": "https://github.com/ConsenSys/teku/commit/72040916170ea7769269a8d66d429c7f195bf935", "message": "Run spotless", "committedDate": "2020-08-26T14:36:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzU3MTIwOQ==", "url": "https://github.com/ConsenSys/teku/pull/2659#discussion_r477571209", "bodyText": "We shouldn't need the withdrawal keystore password because the public key is recorded in the JSON (it gets parsed as KeystoreData.pubkey).  There's a chance it might differ from the actual key but seems reasonable to assume it's correct (and it's at least as accurate as taking the public key directly on the command line).", "author": "ajsutton", "createdAt": "2020-08-26T20:31:29Z", "path": "teku/src/main/java/tech/pegasys/teku/cli/deposit/WithdrawalPublicKeyOptions.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.cli.deposit;\n+\n+import java.io.File;\n+import picocli.CommandLine.ArgGroup;\n+import picocli.CommandLine.Option;\n+\n+class WithdrawalPublicKeyOptions {\n+  @Option(\n+      names = {\"--withdrawal-public-key\"},\n+      paramLabel = \"<PUBLIC_KEY>\",\n+      required = true,\n+      description = \"Public withdrawal key for the validator\")\n+  String withdrawalKey;\n+\n+  @ArgGroup(exclusive = false, multiplicity = \"1\")\n+  WithdrawalEncryptedKeystoreOptions keystoreOptions;\n+\n+  static class WithdrawalEncryptedKeystoreOptions {\n+    @Option(\n+        names = {\"--withdrawal-keystore-file\"},\n+        required = true,\n+        paramLabel = \"<FILE>\",\n+        description = \"Path to encrypted (V3) keystore containing withdrawal key for the validator\")\n+    File withdrawalKeystoreFile;\n+\n+    @Option(\n+        names = {\"--withdrawal-keystore-password-file\"},\n+        required = true,\n+        paramLabel = \"<FILE>\",\n+        description =\n+            \"Path to file containing password to decrypt validator withdrawal key keystore\")\n+    File withdrawalKeystorePasswordFile;\n+  }", "originalCommit": "72040916170ea7769269a8d66d429c7f195bf935", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODI4NTU3MQ==", "url": "https://github.com/ConsenSys/teku/pull/2659#discussion_r478285571", "bodyText": "Done.", "author": "cemozerr", "createdAt": "2020-08-27T09:33:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzU3MTIwOQ=="}], "type": "inlineReview"}, {"oid": "e745667c4e90c01db153407d0ec97a918beac5e5", "url": "https://github.com/ConsenSys/teku/commit/e745667c4e90c01db153407d0ec97a918beac5e5", "message": "Remove the need for password file when taking in withdrawal keystore", "committedDate": "2020-08-27T09:22:45Z", "type": "commit"}, {"oid": "3b7a17925fb14e4921506a7cd31336d81ee1a095", "url": "https://github.com/ConsenSys/teku/commit/3b7a17925fb14e4921506a7cd31336d81ee1a095", "message": "Run spotless", "committedDate": "2020-08-27T09:23:03Z", "type": "commit"}, {"oid": "ed566b538d2bdd442b053bd69f9bac3afc2a3f4c", "url": "https://github.com/ConsenSys/teku/commit/ed566b538d2bdd442b053bd69f9bac3afc2a3f4c", "message": "Fix tests", "committedDate": "2020-08-27T09:30:20Z", "type": "commit"}, {"oid": "d72ca2c4b11802d4f2a44496f2f5f22efac5c603", "url": "https://github.com/ConsenSys/teku/commit/d72ca2c4b11802d4f2a44496f2f5f22efac5c603", "message": "Use generated withdrawal keys for generate-and-register", "committedDate": "2020-08-27T11:42:27Z", "type": "commit"}, {"oid": "14329810932d3801a12ee1dbba9f0955e581eac9", "url": "https://github.com/ConsenSys/teku/commit/14329810932d3801a12ee1dbba9f0955e581eac9", "message": "Fix tests", "committedDate": "2020-08-27T11:58:29Z", "type": "commit"}, {"oid": "a45776ddeeedbdc0ff90d005508a99ad39cb1213", "url": "https://github.com/ConsenSys/teku/commit/a45776ddeeedbdc0ff90d005508a99ad39cb1213", "message": "Run spotless", "committedDate": "2020-08-27T12:09:37Z", "type": "commit"}, {"oid": "3d0bfb508e0cd11ece2d2ef25cb0bc48a84d7ed5", "url": "https://github.com/ConsenSys/teku/commit/3d0bfb508e0cd11ece2d2ef25cb0bc48a84d7ed5", "message": "Fix test", "committedDate": "2020-08-27T12:35:12Z", "type": "commit"}, {"oid": "36227e121d8588d1ef570cc44da7fda903a68c2c", "url": "https://github.com/ConsenSys/teku/commit/36227e121d8588d1ef570cc44da7fda903a68c2c", "message": "Merge branch 'master' into readWithdrawalKeyFromKeystore", "committedDate": "2020-08-27T13:44:03Z", "type": "commit"}, {"oid": "589048a2aeb9190eaa3f89ca05543fea48109e12", "url": "https://github.com/ConsenSys/teku/commit/589048a2aeb9190eaa3f89ca05543fea48109e12", "message": "Merge branch 'master' into readWithdrawalKeyFromKeystore", "committedDate": "2020-08-28T10:51:22Z", "type": "commit"}]}