{"pr_number": 2900, "pr_title": "Add Head events to the ChainHeadChannel", "pr_createdAt": "2020-10-06T23:34:45Z", "pr_url": "https://github.com/ConsenSys/teku/pull/2900", "timeline": [{"oid": "4bab417ff7049c881e9e1d5d4963a873b8bcc212", "url": "https://github.com/ConsenSys/teku/commit/4bab417ff7049c881e9e1d5d4963a873b8bcc212", "message": "Add Head events to the ChainHeadChannel\n\n - added head events to the http event subscriptions\n\n - added a test case to show reorgs coming prior to the head event if both are subscribed\n\n - RecentChainData now returns the fork choice slot rather than slot from head\n\n - updateChainHead will now exit if the original chain head equals the new chain head\n\n fixes #2885\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-10-06T23:20:18Z", "type": "commit"}, {"oid": "fae202c24d8a98433f90abafe6212cde6445282c", "url": "https://github.com/ConsenSys/teku/commit/fae202c24d8a98433f90abafe6212cde6445282c", "message": "missed file from patch set\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-10-06T23:39:58Z", "type": "commit"}, {"oid": "b3d6f1204707b8e5998fe3570f48ba9ef90bbbe9", "url": "https://github.com/ConsenSys/teku/commit/b3d6f1204707b8e5998fe3570f48ba9ef90bbbe9", "message": "Merge remote-tracking branch 'upstream/master' into 2885-chainHead", "committedDate": "2020-10-06T23:53:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3Mzg3Mg==", "url": "https://github.com/ConsenSys/teku/pull/2900#discussion_r500673872", "bodyText": "nit: Probably need to make this message clearer:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    LOG.trace(\"Not updating chain head\");\n          \n          \n            \n                    LOG.trace(\"Skippping head update because new head is same as previous head\");", "author": "ajsutton", "createdAt": "2020-10-07T00:44:35Z", "path": "storage/src/main/java/tech/pegasys/teku/storage/client/RecentChainData.java", "diffHunk": "@@ -242,7 +242,12 @@ private void updateChainHead(\n         LOG.info(\"Skipping head block update to avoid potential rollback of the chain head.\");\n         return;\n       }\n+      if (originalHead.isPresent() && originalHead.get().equals(newChainHead)) {\n+        LOG.trace(\"Not updating chain head\");", "originalCommit": "b3d6f1204707b8e5998fe3570f48ba9ef90bbbe9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "65692a33dbde22904315caaf14b916f1ccdd9390", "url": "https://github.com/ConsenSys/teku/commit/65692a33dbde22904315caaf14b916f1ccdd9390", "message": "Update storage/src/main/java/tech/pegasys/teku/storage/client/RecentChainData.java\n\nCo-authored-by: Adrian Sutton <adrian@symphonious.net>", "committedDate": "2020-10-07T00:45:28Z", "type": "commit"}, {"oid": "e21823ea34adeca06c433633c776860d9b86387e", "url": "https://github.com/ConsenSys/teku/commit/e21823ea34adeca06c433633c776860d9b86387e", "message": "Merge remote-tracking branch 'upstream/master' into 2885-chainHead", "committedDate": "2020-10-07T00:46:46Z", "type": "commit"}, {"oid": "0d5f75b8c5ec2151728cae4edca844deb4e92f38", "url": "https://github.com/ConsenSys/teku/commit/0d5f75b8c5ec2151728cae4edca844deb4e92f38", "message": "Merge branch '2885-chainHead' of https://github.com/rolfyone/artemis into 2885-chainHead", "committedDate": "2020-10-07T00:46:55Z", "type": "commit"}]}