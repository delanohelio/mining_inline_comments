{"pr_number": 3056, "pr_title": "Delete v3 database", "pr_createdAt": "2020-10-22T20:54:48Z", "pr_url": "https://github.com/ConsenSys/teku/pull/3056", "timeline": [{"oid": "381338f647549532c8735e63efd6ce0de3a934d9", "url": "https://github.com/ConsenSys/teku/commit/381338f647549532c8735e63efd6ce0de3a934d9", "message": "Delete v3 database handling", "committedDate": "2020-10-22T20:52:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ1MTg4NQ==", "url": "https://github.com/ConsenSys/teku/pull/3056#discussion_r510451885", "bodyText": "Upgraded this to an error because we should no longer be persisting hot blocks that do not descend from the latest finalized block.  This will help us catch regressions more easily with tests.", "author": "mbaxter", "createdAt": "2020-10-22T20:56:29Z", "path": "storage/src/main/java/tech/pegasys/teku/storage/store/Store.java", "diffHunk": "@@ -170,11 +170,10 @@ public static UpdatableStore create(\n     childToParentRoot.forEach(treeBuilder::childAndParentRoots);\n     final BlockTree blockTree = BlockTree.create(treeBuilder.build(), rootToSlotMap);\n     if (blockTree.size() < childToParentRoot.size()) {\n-      // This should be an error, but keeping this as a warning now for backwards-compatibility\n-      // reasons.  Some existing databases may have unpruned fork blocks, and could become\n-      // unusable\n-      // if we throw here.  In the future, we should convert this to an error.\n-      LOG.warn(\"Ignoring {} non-canonical blocks\", childToParentRoot.size() - blockTree.size());", "originalCommit": "381338f647549532c8735e63efd6ce0de3a934d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c153ee12ef0d5c59a1d96b8857298a3bc9ef43e7", "url": "https://github.com/ConsenSys/teku/commit/c153ee12ef0d5c59a1d96b8857298a3bc9ef43e7", "message": "Migrate remaining v3 tests", "committedDate": "2020-10-22T21:00:53Z", "type": "commit"}, {"oid": "b2b9129e2b07f8fbf4c2245f00cdbdaef05af8fe", "url": "https://github.com/ConsenSys/teku/commit/b2b9129e2b07f8fbf4c2245f00cdbdaef05af8fe", "message": "Merge branch 'master' into minor/delete-v3-db", "committedDate": "2020-10-22T21:18:17Z", "type": "commit"}]}