{"pr_number": 2976, "pr_title": "Added Junit Tests for ResourceUtils", "pr_createdAt": "2020-05-15T08:57:05Z", "pr_url": "https://github.com/eclipse/kapua/pull/2976", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUwMzU3Ng==", "url": "https://github.com/eclipse/kapua/pull/2976#discussion_r426503576", "bodyText": "If they are not intended to match please use assertNotEquals.\nIf ResourceUtils.getResource(...) is meant to throw an Exception catch the Exception and do asserts on the type of Exception expected.", "author": "Coduz", "createdAt": "2020-05-18T09:48:50Z", "path": "commons/src/test/java/org/eclipse/kapua/commons/util/ResourceUtilsTest.java", "diffHunk": "@@ -13,48 +13,112 @@\n \n import java.io.IOException;\n import java.io.Reader;\n+import java.lang.reflect.Constructor;\n import java.net.URL;\n+import java.nio.charset.Charset;\n import java.nio.charset.StandardCharsets;\n \n import org.eclipse.kapua.qa.markers.junit.JUnitTests;\n import org.junit.Assert;\n+import org.junit.ComparisonFailure;\n import org.junit.Test;\n \n import com.google.common.io.CharStreams;\n import org.junit.experimental.categories.Category;\n \n @Category(JUnitTests.class)\n-public class ResourceUtilsTest {\n+public class ResourceUtilsTest extends Assert {\n \n-    /**\n-     * Test a successful resource resolve call and a successful read\n-     */\n     @Test\n-    public void testRead1() throws IOException {\n-        final URL url = ResourceUtils.getResource(\"test.properties\");\n-        Assert.assertNotNull(url);\n+    public void testConstructor() throws Exception {\n+        Constructor<ResourceUtils> resourceUtils = ResourceUtils.class.getDeclaredConstructor();\n+        resourceUtils.setAccessible(true);\n+        resourceUtils.newInstance();\n+    }\n \n-        try (final Reader reader = ResourceUtils.openAsReader(url, StandardCharsets.UTF_8)) {\n-            final String string = CharStreams.toString(reader);\n-            Assert.assertNotNull(string);\n-            Assert.assertFalse(string.isEmpty());\n+    @Test\n+    public void getResourceTest() {\n+        String resource = \"test.properties\";\n+        String noResource = \"file:/does-not-exist\";\n+\n+        ClassLoader classloaderTest = Thread.currentThread().getContextClassLoader();\n+        URL url = classloaderTest.getResource(resource);\n+\n+        //Positive test\n+        try {\n+            assertEquals(url, ResourceUtils.getResource(resource));\n+        } catch (AssertionError ex) {\n+            fail(\"AssertionError not expected\");\n+        }\n+\n+        //Negative test\n+        try {\n+            assertEquals(url, ResourceUtils.getResource(noResource));", "originalCommit": "a26ffcf70068c5ea95214ca687e53e3393796c9e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUwMzYxMw==", "url": "https://github.com/eclipse/kapua/pull/2976#discussion_r426503613", "bodyText": "assertEquals has an overload method that accepts a message as a first argument. So fail invoked in the catch exception is not the correct usage of Assert stuff.\nPlease change this and also other similar usages", "author": "Coduz", "createdAt": "2020-05-18T09:48:54Z", "path": "commons/src/test/java/org/eclipse/kapua/commons/util/ResourceUtilsTest.java", "diffHunk": "@@ -13,48 +13,112 @@\n \n import java.io.IOException;\n import java.io.Reader;\n+import java.lang.reflect.Constructor;\n import java.net.URL;\n+import java.nio.charset.Charset;\n import java.nio.charset.StandardCharsets;\n \n import org.eclipse.kapua.qa.markers.junit.JUnitTests;\n import org.junit.Assert;\n+import org.junit.ComparisonFailure;\n import org.junit.Test;\n \n import com.google.common.io.CharStreams;\n import org.junit.experimental.categories.Category;\n \n @Category(JUnitTests.class)\n-public class ResourceUtilsTest {\n+public class ResourceUtilsTest extends Assert {\n \n-    /**\n-     * Test a successful resource resolve call and a successful read\n-     */\n     @Test\n-    public void testRead1() throws IOException {\n-        final URL url = ResourceUtils.getResource(\"test.properties\");\n-        Assert.assertNotNull(url);\n+    public void testConstructor() throws Exception {\n+        Constructor<ResourceUtils> resourceUtils = ResourceUtils.class.getDeclaredConstructor();\n+        resourceUtils.setAccessible(true);\n+        resourceUtils.newInstance();\n+    }\n \n-        try (final Reader reader = ResourceUtils.openAsReader(url, StandardCharsets.UTF_8)) {\n-            final String string = CharStreams.toString(reader);\n-            Assert.assertNotNull(string);\n-            Assert.assertFalse(string.isEmpty());\n+    @Test\n+    public void getResourceTest() {\n+        String resource = \"test.properties\";\n+        String noResource = \"file:/does-not-exist\";\n+\n+        ClassLoader classloaderTest = Thread.currentThread().getContextClassLoader();\n+        URL url = classloaderTest.getResource(resource);\n+\n+        //Positive test\n+        try {\n+            assertEquals(url, ResourceUtils.getResource(resource));", "originalCommit": "a26ffcf70068c5ea95214ca687e53e3393796c9e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA4NTcyMw==", "url": "https://github.com/eclipse/kapua/pull/2976#discussion_r427085723", "bodyText": "Hi @Coduz I have made all changes that you mentioned above. If something is not ok please let me know so I can fix it. Thanks", "author": "sonja-ct", "createdAt": "2020-05-19T07:27:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUwMzYxMw=="}], "type": "inlineReview"}, {"oid": "4c01826b2634c71fa58d7505692b2ea428b002c1", "url": "https://github.com/eclipse/kapua/commit/4c01826b2634c71fa58d7505692b2ea428b002c1", "message": "Added Junit Tests for ResourceUtils\n\nSigned-off-by: Sonja <sonja.matic@comtrade.com>", "committedDate": "2020-05-18T13:28:39Z", "type": "commit"}, {"oid": "4c01826b2634c71fa58d7505692b2ea428b002c1", "url": "https://github.com/eclipse/kapua/commit/4c01826b2634c71fa58d7505692b2ea428b002c1", "message": "Added Junit Tests for ResourceUtils\n\nSigned-off-by: Sonja <sonja.matic@comtrade.com>", "committedDate": "2020-05-18T13:28:39Z", "type": "forcePushed"}]}