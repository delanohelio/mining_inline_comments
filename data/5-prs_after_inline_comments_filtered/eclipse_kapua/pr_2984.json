{"pr_number": 2984, "pr_title": "Fixed and added new cucumber unit tests for Device", "pr_createdAt": "2020-05-21T10:09:47Z", "pr_url": "https://github.com/eclipse/kapua/pull/2984", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc3MzIzNg==", "url": "https://github.com/eclipse/kapua/pull/2984#discussion_r429773236", "bodyText": "Please change the method name to: \"iUpdateTheDeviceClientIDToNewClientId\"", "author": "LeoNerdoG", "createdAt": "2020-05-25T07:26:12Z", "path": "service/device/registry/test-steps/src/main/java/org/eclipse/kapua/service/device/registry/steps/DeviceRegistrySteps.java", "diffHunk": "@@ -2983,4 +2983,68 @@ public void iFilterDevices(List<CucDevice> parameters) throws Exception {\n             stepData.put(\"DeviceList\", devices);\n         }\n     }\n+\n+    @When(\"^I search for a device with name \\\"([^\\\"]*)\\\"$\")\n+    public void iSearchForADeviceWithName(String clientID) throws Throwable {\n+        try {\n+            stepData.remove(\"Device\");\n+            primeException();\n+            DeviceQuery query = deviceFactory.newQuery(SYS_SCOPE_ID);\n+            query.setPredicate(query.attributePredicate(DeviceAttributes.CLIENT_ID, clientID, AttributePredicate.Operator.EQUAL));\n+            DeviceListResult queryResult = deviceRegistryService.query(query);\n+            Device foundDevice = queryResult.getFirstItem();\n+            stepData.put(\"Device\", foundDevice);\n+            stepData.put(\"queryResult\", queryResult);\n+        } catch (KapuaException ex) {\n+            verifyException(ex);\n+        }\n+    }\n+\n+    @Given(\"^I create device with null clientID$\")\n+    public void iCreateDeviceWithNullClientID() throws Throwable{\n+        DeviceCreator deviceCreator = deviceFactory.newCreator(getCurrentScopeId());\n+        deviceCreator.setClientId(null);\n+        stepData.put(\"DeviceCreator\", deviceCreator);\n+\n+        try {\n+            primeException();\n+            stepData.remove(\"Device\");\n+            Device device = deviceRegistryService.create(deviceCreator);\n+            stepData.put(\"Device\", device);\n+        } catch (Exception ex) {\n+            verifyException(ex);\n+        }\n+    }\n+\n+    @Given(\"^I try to create devices with invalid symbols \\\"([^\\\"]*)\\\" in name$\")\n+    public void iTryToCreateDevicesWithInvalidSymbolsInName(String invalidCharacters) throws Exception {\n+        DeviceCreator deviceCreator = deviceFactory.newCreator(getCurrentScopeId());\n+        for (int i = 0; i < invalidCharacters.length(); i++) {\n+            String deviceName = \"deviceName\" + invalidCharacters.charAt(i);\n+            deviceCreator.setClientId(deviceName);\n+            primeException();\n+            try {\n+                Device device = deviceRegistryService.create(deviceCreator);\n+                stepData.put(\"Device\", device);\n+                stepData.put(\"CurrentDeviceId\", device.getId());\n+            } catch (KapuaException ex) {\n+                verifyException(ex);\n+            }\n+        }\n+    }\n+\n+    @When(\"^I update the device clientID from \\\"([^\\\"]*)\\\" to \\\"([^\\\"]*)\\\"$\")\n+    public void iUpdateTheDeviceClientIDFromToNewClientId(String oldClientId, String newClientId) throws Exception {", "originalCommit": "a3a37b2d3d959648d490c9033a2a9c95aeea8006", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc3MzY2NQ==", "url": "https://github.com/eclipse/kapua/pull/2984#discussion_r429773665", "bodyText": "Please change step name to: \"@given(\"^I create a device with null clientID$\")\"", "author": "LeoNerdoG", "createdAt": "2020-05-25T07:27:07Z", "path": "service/device/registry/test-steps/src/main/java/org/eclipse/kapua/service/device/registry/steps/DeviceRegistrySteps.java", "diffHunk": "@@ -2983,4 +2983,68 @@ public void iFilterDevices(List<CucDevice> parameters) throws Exception {\n             stepData.put(\"DeviceList\", devices);\n         }\n     }\n+\n+    @When(\"^I search for a device with name \\\"([^\\\"]*)\\\"$\")\n+    public void iSearchForADeviceWithName(String clientID) throws Throwable {\n+        try {\n+            stepData.remove(\"Device\");\n+            primeException();\n+            DeviceQuery query = deviceFactory.newQuery(SYS_SCOPE_ID);\n+            query.setPredicate(query.attributePredicate(DeviceAttributes.CLIENT_ID, clientID, AttributePredicate.Operator.EQUAL));\n+            DeviceListResult queryResult = deviceRegistryService.query(query);\n+            Device foundDevice = queryResult.getFirstItem();\n+            stepData.put(\"Device\", foundDevice);\n+            stepData.put(\"queryResult\", queryResult);\n+        } catch (KapuaException ex) {\n+            verifyException(ex);\n+        }\n+    }\n+\n+    @Given(\"^I create device with null clientID$\")", "originalCommit": "a3a37b2d3d959648d490c9033a2a9c95aeea8006", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc3Mzc4NQ==", "url": "https://github.com/eclipse/kapua/pull/2984#discussion_r429773785", "bodyText": "Please change the method name to: \"iCreateADeviceWithNullClientID\"", "author": "LeoNerdoG", "createdAt": "2020-05-25T07:27:20Z", "path": "service/device/registry/test-steps/src/main/java/org/eclipse/kapua/service/device/registry/steps/DeviceRegistrySteps.java", "diffHunk": "@@ -2983,4 +2983,68 @@ public void iFilterDevices(List<CucDevice> parameters) throws Exception {\n             stepData.put(\"DeviceList\", devices);\n         }\n     }\n+\n+    @When(\"^I search for a device with name \\\"([^\\\"]*)\\\"$\")\n+    public void iSearchForADeviceWithName(String clientID) throws Throwable {\n+        try {\n+            stepData.remove(\"Device\");\n+            primeException();\n+            DeviceQuery query = deviceFactory.newQuery(SYS_SCOPE_ID);\n+            query.setPredicate(query.attributePredicate(DeviceAttributes.CLIENT_ID, clientID, AttributePredicate.Operator.EQUAL));\n+            DeviceListResult queryResult = deviceRegistryService.query(query);\n+            Device foundDevice = queryResult.getFirstItem();\n+            stepData.put(\"Device\", foundDevice);\n+            stepData.put(\"queryResult\", queryResult);\n+        } catch (KapuaException ex) {\n+            verifyException(ex);\n+        }\n+    }\n+\n+    @Given(\"^I create device with null clientID$\")\n+    public void iCreateDeviceWithNullClientID() throws Throwable{", "originalCommit": "a3a37b2d3d959648d490c9033a2a9c95aeea8006", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc3NDIxNQ==", "url": "https://github.com/eclipse/kapua/pull/2984#discussion_r429774215", "bodyText": "Please delete this empty line.", "author": "LeoNerdoG", "createdAt": "2020-05-25T07:28:14Z", "path": "service/device/registry/test/src/test/java/org/eclipse/kapua/service/device/registry/test/CucumberWithPropertiesForDeviceRegistry.java", "diffHunk": "@@ -88,6 +90,8 @@ protected void configure() {\n \n                 bind(DeviceEventService.class).toInstance(new DeviceEventServiceImpl());\n                 bind(DeviceEventFactory.class).toInstance(new DeviceEventFactoryImpl());\n+", "originalCommit": "a3a37b2d3d959648d490c9033a2a9c95aeea8006", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "693068e395b18c6fe72b493386e3695fbcd57c60", "url": "https://github.com/eclipse/kapua/commit/693068e395b18c6fe72b493386e3695fbcd57c60", "message": "Fixed cucumber unit tests for Device\n\nSigned-off-by: code-incubus <nemanja.milutinovic@comtrade.com>", "committedDate": "2020-05-25T11:12:02Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg4MTM3MQ==", "url": "https://github.com/eclipse/kapua/pull/2984#discussion_r429881371", "bodyText": "I see this only now - please change header to \" * Copyright (c) 2019, 2020 Eurotech and/or its affiliates and others\"", "author": "LeoNerdoG", "createdAt": "2020-05-25T11:21:01Z", "path": "service/device/registry/test/src/test/java/org/eclipse/kapua/service/device/registry/test/CucumberWithPropertiesForDeviceRegistry.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*******************************************************************************\n- * Copyright (c) 2019 Eurotech and/or its affiliates and others\n+ * Copyright (c) 2020 Eurotech and/or its affiliates and others", "originalCommit": "693068e395b18c6fe72b493386e3695fbcd57c60", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg4MTQwNw==", "url": "https://github.com/eclipse/kapua/pull/2984#discussion_r429881407", "bodyText": "I see this only now - please change header to \" * Copyright (c) 2019, 2020 Eurotech and/or its affiliates and others\"", "author": "LeoNerdoG", "createdAt": "2020-05-25T11:21:06Z", "path": "service/device/registry/test/src/test/java/org/eclipse/kapua/service/device/registry/test/RunDeviceRegistryUnitTest.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*******************************************************************************\n- * Copyright (c) 2019 Eurotech and/or its affiliates and others\n+ * Copyright (c) 2020 Eurotech and/or its affiliates and others", "originalCommit": "693068e395b18c6fe72b493386e3695fbcd57c60", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4fc58d2f4b37bbaf106765be9db15f19fa539a8e", "url": "https://github.com/eclipse/kapua/commit/4fc58d2f4b37bbaf106765be9db15f19fa539a8e", "message": "Fixed cucumber unit tests for Device\n\nSigned-off-by: code-incubus <nemanja.milutinovic@comtrade.com>", "committedDate": "2020-05-25T11:31:37Z", "type": "forcePushed"}, {"oid": "f2b766ac0adceb2be1eed64fa94786e902557967", "url": "https://github.com/eclipse/kapua/commit/f2b766ac0adceb2be1eed64fa94786e902557967", "message": "Fixed cucumber unit tests for Device\n\nSigned-off-by: code-incubus <nemanja.milutinovic@comtrade.com>", "committedDate": "2020-05-25T11:58:12Z", "type": "commit"}, {"oid": "f2b766ac0adceb2be1eed64fa94786e902557967", "url": "https://github.com/eclipse/kapua/commit/f2b766ac0adceb2be1eed64fa94786e902557967", "message": "Fixed cucumber unit tests for Device\n\nSigned-off-by: code-incubus <nemanja.milutinovic@comtrade.com>", "committedDate": "2020-05-25T11:58:12Z", "type": "forcePushed"}]}