{"pr_number": 1445, "pr_title": "Added links support to entity resource. ", "pr_createdAt": "2020-07-17T16:18:23Z", "pr_url": "https://github.com/yahoo/elide/pull/1445", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYwOTE3OA==", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r456609178", "bodyText": "Can we make an interface for this - and use that for ElideSettings?", "author": "aklish", "createdAt": "2020-07-17T18:33:18Z", "path": "elide-core/src/main/java/com/yahoo/elide/core/DefaultJSONApiLinks.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2015, Yahoo Inc.\n+ * Licensed under the Apache License, Version 2.0\n+ * See LICENSE file in project root for terms.\n+ */\n+package com.yahoo.elide.core;\n+\n+import com.google.common.collect.ImmutableMap;\n+\n+import java.util.Map;\n+\n+/***\n+ * Default API links populate provide 'self' and 'related' links.\n+ * To add custom links, Override `getResourceLevelLinks` and `getRelationshipLinks`.\n+ * Ad the subclass object in ElideAutoConfiguration.\n+ */\n+public class DefaultJSONApiLinks {", "originalCommit": "9493fd1840c56b071c010457867519b29781e7f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYwOTI4Nw==", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r456609287", "bodyText": "Copyright dates are off.", "author": "aklish", "createdAt": "2020-07-17T18:33:31Z", "path": "elide-core/src/main/java/com/yahoo/elide/core/DefaultJSONApiLinks.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2015, Yahoo Inc.", "originalCommit": "9493fd1840c56b071c010457867519b29781e7f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYxMDY2Mw==", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r456610663", "bodyText": "We need an option to make an absolute URL with a hostname, port, etc (https://www.example.com).", "author": "aklish", "createdAt": "2020-07-17T18:36:26Z", "path": "elide-core/src/main/java/com/yahoo/elide/core/DefaultJSONApiLinks.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2015, Yahoo Inc.\n+ * Licensed under the Apache License, Version 2.0\n+ * See LICENSE file in project root for terms.\n+ */\n+package com.yahoo.elide.core;\n+\n+import com.google.common.collect.ImmutableMap;\n+\n+import java.util.Map;\n+\n+/***\n+ * Default API links populate provide 'self' and 'related' links.\n+ * To add custom links, Override `getResourceLevelLinks` and `getRelationshipLinks`.\n+ * Ad the subclass object in ElideAutoConfiguration.\n+ */\n+public class DefaultJSONApiLinks {\n+    /**\n+     * Links to be used in EntityProjection\n+     * @param resource\n+     * @return\n+     */\n+    public Map<String, String> getResourceLevelLinks(PersistentResource resource) {\n+        return ImmutableMap.of(\"self\", getResourceUrl(resource));\n+    }\n+\n+    /**\n+     * Links to be used in Relationships of EntityProjection\n+     * @param resource\n+     * @return\n+     */\n+    public Map<String, String> getRelationshipLinks(PersistentResource resource, String field) {\n+        String resourceUrl = getResourceUrl(resource);\n+        return ImmutableMap.of(\n+                \"self\", String.join(\"/\", resourceUrl, \"relationships\", field),\n+                \"related\", String.join(\"/\", resourceUrl, field));\n+    }\n+\n+    /**\n+     * Creates the link from resources path\n+     * @param resource\n+     * @return\n+     */\n+    protected String getResourceUrl(PersistentResource resource) {\n+        StringBuilder result = new StringBuilder();", "originalCommit": "9493fd1840c56b071c010457867519b29781e7f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYxMjI2Mw==", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r456612263", "bodyText": "This should be disabled by default in Elide 4.  However, turn it on for testing so the tests below work.", "author": "aklish", "createdAt": "2020-07-17T18:39:51Z", "path": "elide-spring/elide-spring-boot-autoconfigure/src/main/java/com/yahoo/elide/spring/config/ElideAutoConfiguration.java", "diffHunk": "@@ -53,6 +54,7 @@ public Elide initializeElide(EntityDictionary dictionary,\n                 .withEntityDictionary(dictionary)\n                 .withDefaultMaxPageSize(settings.getMaxPageSize())\n                 .withDefaultPageSize(settings.getPageSize())\n+                .withJSONApiLinks(new DefaultJSONApiLinks())", "originalCommit": "9493fd1840c56b071c010457867519b29781e7f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg2MzU2Mw==", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r461863563", "bodyText": "this.baseUrlEndPoint = outerRequestScope.baseUrlEndpoint", "author": "aklish", "createdAt": "2020-07-28T20:38:15Z", "path": "elide-core/src/main/java/com/yahoo/elide/core/RequestScope.java", "diffHunk": "@@ -193,6 +204,7 @@ public RequestScope(String path,\n      */\n     protected RequestScope(String path, JsonApiDocument jsonApiDocument, RequestScope outerRequestScope) {\n         this.jsonApiDocument = jsonApiDocument;\n+        this.baseUrlEndPoint = null;", "originalCommit": "494853fb707b28583b7fa9588022737202fa8b85", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8925b1eb23acf80a7d680b225a9c73e41693d3c0", "url": "https://github.com/yahoo/elide/commit/8925b1eb23acf80a7d680b225a9c73e41693d3c0", "message": "Added links support to entity resource. Links can be customized based on usecase", "committedDate": "2020-07-30T22:54:47Z", "type": "commit"}, {"oid": "542183136d5fb122249665321d78d50dde6fb527", "url": "https://github.com/yahoo/elide/commit/542183136d5fb122249665321d78d50dde6fb527", "message": "remove commented code", "committedDate": "2020-07-30T22:54:47Z", "type": "commit"}, {"oid": "bf3cc34ada26cf188b8a03466d0f1c056453b7b1", "url": "https://github.com/yahoo/elide/commit/bf3cc34ada26cf188b8a03466d0f1c056453b7b1", "message": "remove unused variable", "committedDate": "2020-07-30T22:54:47Z", "type": "commit"}, {"oid": "6dae1dd70513aaeb2f3986665ec93df44d035d3b", "url": "https://github.com/yahoo/elide/commit/6dae1dd70513aaeb2f3986665ec93df44d035d3b", "message": "comments fix", "committedDate": "2020-07-30T22:54:47Z", "type": "commit"}, {"oid": "07fb4807160fb0a0d5581d9fa4970f5efac70617", "url": "https://github.com/yahoo/elide/commit/07fb4807160fb0a0d5581d9fa4970f5efac70617", "message": "Use fully qualified URL in links", "committedDate": "2020-07-30T22:54:47Z", "type": "commit"}, {"oid": "1953caca7288cb260626dc9db29fd1b40652f57e", "url": "https://github.com/yahoo/elide/commit/1953caca7288cb260626dc9db29fd1b40652f57e", "message": "remove unused imports", "committedDate": "2020-07-30T22:54:47Z", "type": "commit"}, {"oid": "80df92394161c14bdf277591468045bc533df5bb", "url": "https://github.com/yahoo/elide/commit/80df92394161c14bdf277591468045bc533df5bb", "message": "include baseURL in all rest method for jsonApi", "committedDate": "2020-07-30T22:54:47Z", "type": "commit"}, {"oid": "d792eb35323742608bdccf5bf0f56311c6893790", "url": "https://github.com/yahoo/elide/commit/d792eb35323742608bdccf5bf0f56311c6893790", "message": "Added baseUrl support for GraphQl Request Scope", "committedDate": "2020-07-30T22:54:47Z", "type": "commit"}, {"oid": "9a837aae944317cb7e80eb67c3e5a90dfd5f814e", "url": "https://github.com/yahoo/elide/commit/9a837aae944317cb7e80eb67c3e5a90dfd5f814e", "message": "codacy fix", "committedDate": "2020-07-30T22:58:53Z", "type": "commit"}, {"oid": "9a837aae944317cb7e80eb67c3e5a90dfd5f814e", "url": "https://github.com/yahoo/elide/commit/9a837aae944317cb7e80eb67c3e5a90dfd5f814e", "message": "codacy fix", "committedDate": "2020-07-30T22:58:53Z", "type": "forcePushed"}, {"oid": "eabbd91e71000c5b37c55526031c4f5112a75a17", "url": "https://github.com/yahoo/elide/commit/eabbd91e71000c5b37c55526031c4f5112a75a17", "message": "typo fix", "committedDate": "2020-07-30T23:29:21Z", "type": "commit"}, {"oid": "ae58ce35b3c42ceb2e603e94fc6f37cdd783a209", "url": "https://github.com/yahoo/elide/commit/ae58ce35b3c42ceb2e603e94fc6f37cdd783a209", "message": "remove default scope attributes", "committedDate": "2020-07-31T03:39:42Z", "type": "commit"}, {"oid": "f57ded01dd0f2bd84eb01c32aaa97ea7edcbbc6f", "url": "https://github.com/yahoo/elide/commit/f57ded01dd0f2bd84eb01c32aaa97ea7edcbbc6f", "message": "unittest for JsonApiDSL", "committedDate": "2020-07-31T16:37:32Z", "type": "commit"}, {"oid": "e1f305b31fd3d6e62f0cc0184a6ab3db958a6612", "url": "https://github.com/yahoo/elide/commit/e1f305b31fd3d6e62f0cc0184a6ab3db958a6612", "message": "add relation test on JSONDSL", "committedDate": "2020-07-31T17:11:26Z", "type": "commit"}]}