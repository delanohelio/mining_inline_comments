{"pr_number": 4409, "pr_title": "Enhance UpdateDiskOfferingCmd", "pr_createdAt": "2020-10-16T06:50:35Z", "pr_url": "https://github.com/apache/cloudstack/pull/4409", "timeline": [{"oid": "b984042e88984bbdea19bc9d647fad2e88ca026b", "url": "https://github.com/apache/cloudstack/commit/b984042e88984bbdea19bc9d647fad2e88ca026b", "message": "Enhance update disk offering\n\n- cache-mode\n- IOPS (Read/Write) Rate, IOPS (Read/Write) Rate Max, IOPS (Read/Write) Rate Max Length\n  Bytes (Read/Write) Rate,\n- Bytes (Read/Write) Rate Max, Bytes (Read/Write) Rate Max Length", "committedDate": "2020-10-16T15:20:57Z", "type": "forcePushed"}, {"oid": "3efd00d4bbb67bd2e9a487c1fe3e8f7bbcd7362b", "url": "https://github.com/apache/cloudstack/commit/3efd00d4bbb67bd2e9a487c1fe3e8f7bbcd7362b", "message": "Enhance update disk offering\n\n- cache-mode\n- IOPS (Read/Write) Rate, IOPS (Read/Write) Rate Max, IOPS (Read/Write) Rate Max Length\n  Bytes (Read/Write) Rate,\n- Bytes (Read/Write) Rate Max, Bytes (Read/Write) Rate Max Length", "committedDate": "2020-10-16T15:24:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjYyMjQzOA==", "url": "https://github.com/apache/cloudstack/pull/4409#discussion_r506622438", "bodyText": "I believe your test is incorrect.\nYou need an assertion here.", "author": "RodrigoDLopez", "createdAt": "2020-10-16T17:33:03Z", "path": "server/src/test/java/com/cloud/configuration/ConfigurationManagerTest.java", "diffHunk": "@@ -946,17 +946,32 @@ public void validateMaximumIopsAndBytesLengthTestDefaultLengthConfigs() {\n \n     @Test\n     public void shouldUpdateDiskOfferingTests(){\n-        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(Mockito.anyString(), Mockito.anyString(), Mockito.anyInt(), Mockito.anyBoolean(), Mockito.anyString()));\n-        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(Mockito.anyString(), nullable(String.class), nullable(Integer.class), nullable(Boolean.class), nullable(String.class)));\n-        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(nullable(String.class), Mockito.anyString(), nullable(Integer.class), nullable(Boolean.class), nullable(String.class)));\n-        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(nullable(String.class), nullable(String.class), Mockito.anyInt(), nullable(Boolean.class), nullable(String.class)));\n-        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(nullable(String.class), nullable(String.class), nullable(int.class), Mockito.anyBoolean(), nullable(String.class)));\n-        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(nullable(String.class), nullable(String.class), nullable(int.class), nullable(Boolean.class), Mockito.anyString()));\n+        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(Mockito.anyString(), Mockito.anyString(), Mockito.anyInt(), Mockito.anyBoolean(), Mockito.anyString(), Mockito.anyString()));\n+        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(Mockito.anyString(), nullable(String.class), nullable(Integer.class), nullable(Boolean.class), nullable(String.class), nullable(String.class)));\n+        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(nullable(String.class), Mockito.anyString(), nullable(Integer.class), nullable(Boolean.class), nullable(String.class), nullable(String.class)));\n+        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(nullable(String.class), nullable(String.class), Mockito.anyInt(), nullable(Boolean.class), nullable(String.class), nullable(String.class)));\n+        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(nullable(String.class), nullable(String.class), nullable(int.class), Mockito.anyBoolean(), nullable(String.class), nullable(String.class)));\n+        Assert.assertTrue(configurationMgr.shouldUpdateDiskOffering(nullable(String.class), nullable(String.class), nullable(int.class), nullable(Boolean.class), Mockito.anyString(), Mockito.anyString()));\n     }\n \n     @Test\n     public void shouldUpdateDiskOfferingTestFalse(){\n-        Assert.assertFalse(configurationMgr.shouldUpdateDiskOffering(null, null, null, null, null));\n+        Assert.assertFalse(configurationMgr.shouldUpdateDiskOffering(null, null, null, null, null, null));\n+    }\n+\n+    @Test\n+    public void shouldUpdateIopsRateParametersTestFalse() {\n+        configurationMgr.shouldUpdateIopsRateParameters(null, null, null, null, null, null);", "originalCommit": "3efd00d4bbb67bd2e9a487c1fe3e8f7bbcd7362b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjY4NDM5Ng==", "url": "https://github.com/apache/cloudstack/pull/4409#discussion_r506684396", "bodyText": "Thanks, updated!", "author": "GabrielBrascher", "createdAt": "2020-10-16T19:38:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjYyMjQzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjYyMzA2NQ==", "url": "https://github.com/apache/cloudstack/pull/4409#discussion_r506623065", "bodyText": "those change will not impact into edit diskoffering tags", "author": "RodrigoDLopez", "createdAt": "2020-10-16T17:33:55Z", "path": "server/src/main/java/com/cloud/configuration/ConfigurationManagerImpl.java", "diffHunk": "@@ -3273,8 +3280,17 @@ protected void updateDiskOfferingTagsIfIsNotNull(String tags, DiskOfferingVO dis\n      * Check if it needs to update any parameter when updateDiskoffering is called\n      * Verify if name or displayText are not blank, tags is not null, sortkey and displayDiskOffering is not null\n      */\n-    protected boolean shouldUpdateDiskOffering(String name, String displayText, Integer sortKey, Boolean displayDiskOffering, String tags) {\n-        return StringUtils.isNotBlank(name) || StringUtils.isNotBlank(displayText) || tags != null || sortKey != null || displayDiskOffering != null;\n+    protected boolean shouldUpdateDiskOffering(String name, String displayText, Integer sortKey, Boolean displayDiskOffering, String tags, String cacheMode) {", "originalCommit": "3efd00d4bbb67bd2e9a487c1fe3e8f7bbcd7362b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "65322095f5e4d91ac8967e7c248675b98d5439e6", "url": "https://github.com/apache/cloudstack/commit/65322095f5e4d91ac8967e7c248675b98d5439e6", "message": "Enhance update disk offering\n\n- cache-mode\n- IOPS (Read/Write) Rate, IOPS (Read/Write) Rate Max, IOPS (Read/Write) Rate Max Length\n  Bytes (Read/Write) Rate,\n- Bytes (Read/Write) Rate Max, Bytes (Read/Write) Rate Max Length", "committedDate": "2020-10-16T19:35:28Z", "type": "commit"}, {"oid": "65322095f5e4d91ac8967e7c248675b98d5439e6", "url": "https://github.com/apache/cloudstack/commit/65322095f5e4d91ac8967e7c248675b98d5439e6", "message": "Enhance update disk offering\n\n- cache-mode\n- IOPS (Read/Write) Rate, IOPS (Read/Write) Rate Max, IOPS (Read/Write) Rate Max Length\n  Bytes (Read/Write) Rate,\n- Bytes (Read/Write) Rate Max, Bytes (Read/Write) Rate Max Length", "committedDate": "2020-10-16T19:35:28Z", "type": "forcePushed"}, {"oid": "92ae54fa7bd81a755a8dc971ed9ef6f76253dfc6", "url": "https://github.com/apache/cloudstack/commit/92ae54fa7bd81a755a8dc971ed9ef6f76253dfc6", "message": "Add shouldUpdateBytesRate Tests", "committedDate": "2020-10-19T13:26:27Z", "type": "commit"}]}