{"pr_number": 4316, "pr_title": "Handle listProjects API to list projects with user as members when listAll=true", "pr_createdAt": "2020-09-10T07:06:54Z", "pr_url": "https://github.com/apache/cloudstack/pull/4316", "timeline": [{"oid": "61f2dc29f77e4f9120666ba032b20d07eb6a60e3", "url": "https://github.com/apache/cloudstack/commit/61f2dc29f77e4f9120666ba032b20d07eb6a60e3", "message": "added defensive checks for avoiding NPE and list projects API fix", "committedDate": "2020-09-10T06:26:58Z", "type": "commit"}, {"oid": "b9443fdc11245073bfbe5bf6dc598d39409701e0", "url": "https://github.com/apache/cloudstack/commit/b9443fdc11245073bfbe5bf6dc598d39409701e0", "message": "Merge branch 'master' of https://github.com/apache/cloudstack into list_project_users_filter", "committedDate": "2020-09-10T06:27:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjExOTIxNA==", "url": "https://github.com/apache/cloudstack/pull/4316#discussion_r486119214", "bodyText": "Are there usage of this method where throwing an exception would break flow? (or, are we expecting all usages of this method to be project related?)", "author": "rhtyd", "createdAt": "2020-09-10T07:20:23Z", "path": "server/src/main/java/com/cloud/acl/DomainChecker.java", "diffHunk": "@@ -199,6 +200,9 @@ public boolean checkAccess(Account caller, ControlledEntity entity, AccessType a\n     private boolean checkOperationPermitted(Account caller, ControlledEntity entity) {\n         User user = CallContext.current().getCallingUser();\n         Project project = projectDao.findByProjectAccountId(entity.getAccountId());\n+        if (project == null) {", "originalCommit": "b9443fdc11245073bfbe5bf6dc598d39409701e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjEyMjA3Nw==", "url": "https://github.com/apache/cloudstack/pull/4316#discussion_r486122077", "bodyText": "this method is called only if the entity is owned by a project - which would mean that ideally project should be present if the entity's account is of Project type", "author": "Pearl1594", "createdAt": "2020-09-10T07:25:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjExOTIxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjExOTQxNQ==", "url": "https://github.com/apache/cloudstack/pull/4316#discussion_r486119415", "bodyText": "Same as previous comment", "author": "rhtyd", "createdAt": "2020-09-10T07:20:42Z", "path": "server/src/main/java/com/cloud/network/NetworkModelImpl.java", "diffHunk": "@@ -1658,6 +1658,9 @@ public void checkNetworkPermissions(Account owner, Network network) {\n             if (owner.getType() != Account.ACCOUNT_TYPE_PROJECT && networkOwner.getType() == Account.ACCOUNT_TYPE_PROJECT) {\n                 User user = CallContext.current().getCallingUser();\n                 Project project = projectDao.findByProjectAccountId(network.getAccountId());\n+                if (project == null) {", "originalCommit": "b9443fdc11245073bfbe5bf6dc598d39409701e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjEyMjM1Mw==", "url": "https://github.com/apache/cloudstack/pull/4316#discussion_r486122353", "bodyText": "here too, the check is explicitly for networks owned by a project", "author": "Pearl1594", "createdAt": "2020-09-10T07:26:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjExOTQxNQ=="}], "type": "inlineReview"}, {"oid": "63c516afda6ef602ea7a754f92750a39beaf1086", "url": "https://github.com/apache/cloudstack/commit/63c516afda6ef602ea7a754f92750a39beaf1086", "message": "list projects with account name provided to not include users in the account in response", "committedDate": "2020-09-11T03:49:34Z", "type": "commit"}]}