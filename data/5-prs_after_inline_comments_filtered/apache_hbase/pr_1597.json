{"pr_number": 1597, "pr_title": "HBASE-24271 Set values in `conf/hbase-site.xml` that enable running on `LocalFileSystem` out of the box", "pr_createdAt": "2020-04-27T20:38:03Z", "pr_url": "https://github.com/apache/hbase/pull/1597", "timeline": [{"oid": "5f7bd7713cbbe205cefe537b477b3ab95db036ff", "url": "https://github.com/apache/hbase/commit/5f7bd7713cbbe205cefe537b477b3ab95db036ff", "message": "HBASE-24271 Set values in `conf/hbase-site.xml` that enable running on `LocalFileSystem` out of the box\n\nSimplify the new user experience shipping a configuration that enables\na fresh checkout or tarball distribution to run in standalone mode\nwithout direct user configuration. This change restores the behavior\nwe had when running on Hadoop 2.8 and earlier.\n\nPatch for master includes an update to the book. This change will be\nomitted when backporting to earlier branches.", "committedDate": "2020-04-27T20:35:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0ODY2Nw==", "url": "https://github.com/apache/hbase/pull/1597#discussion_r416148667", "bodyText": "This was actually correct the first time :)", "author": "joshelser", "createdAt": "2020-04-27T21:06:14Z", "path": "hbase-common/src/main/java/org/apache/hadoop/hbase/util/CommonFSUtils.java", "diffHunk": "@@ -348,19 +350,11 @@ public static void setWALRootDir(final Configuration c, final Path root) {\n   public static FileSystem getWALFileSystem(final Configuration c) throws IOException {\n     Path p = getWALRootDir(c);\n     FileSystem fs = p.getFileSystem(c);\n-    // hadoop-core does fs caching, so need to propagate this if set\n+    // hadoop-core does fs caching, so need to propogate this if set", "originalCommit": "5f7bd7713cbbe205cefe537b477b3ab95db036ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE1ODEzMA==", "url": "https://github.com/apache/hbase/pull/1597#discussion_r416158130", "bodyText": "Just reverting the previous patches @joshelser . Spelling fixes will have to come in through a different avenue.", "author": "ndimiduk", "createdAt": "2020-04-27T21:22:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0ODY2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE1NDQ2Ng==", "url": "https://github.com/apache/hbase/pull/1597#discussion_r416154466", "bodyText": "Old spelling is correct.", "author": "saintstack", "createdAt": "2020-04-27T21:16:16Z", "path": "hbase-common/src/main/java/org/apache/hadoop/hbase/util/CommonFSUtils.java", "diffHunk": "@@ -348,19 +350,11 @@ public static void setWALRootDir(final Configuration c, final Path root) {\n   public static FileSystem getWALFileSystem(final Configuration c) throws IOException {\n     Path p = getWALRootDir(c);\n     FileSystem fs = p.getFileSystem(c);\n-    // hadoop-core does fs caching, so need to propagate this if set\n+    // hadoop-core does fs caching, so need to propogate this if set", "originalCommit": "5f7bd7713cbbe205cefe537b477b3ab95db036ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE1OTYxNw==", "url": "https://github.com/apache/hbase/pull/1597#discussion_r416159617", "bodyText": "Okay, I'll retain the spelling fixes from the reverted commits. Man you guys want your cake and to eat it as well!", "author": "ndimiduk", "createdAt": "2020-04-27T21:25:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE1NDQ2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE1NDYyMg==", "url": "https://github.com/apache/hbase/pull/1597#discussion_r416154622", "bodyText": "Hurray", "author": "saintstack", "createdAt": "2020-04-27T21:16:30Z", "path": "hbase-common/src/main/java/org/apache/hadoop/hbase/util/CommonFSUtils.java", "diffHunk": "@@ -348,19 +350,11 @@ public static void setWALRootDir(final Configuration c, final Path root) {\n   public static FileSystem getWALFileSystem(final Configuration c) throws IOException {\n     Path p = getWALRootDir(c);\n     FileSystem fs = p.getFileSystem(c);\n-    // hadoop-core does fs caching, so need to propagate this if set\n+    // hadoop-core does fs caching, so need to propogate this if set\n     String enforceStreamCapability = c.get(UNSAFE_STREAM_CAPABILITY_ENFORCE);\n     if (enforceStreamCapability != null) {\n       fs.getConf().set(UNSAFE_STREAM_CAPABILITY_ENFORCE, enforceStreamCapability);\n     }\n-    if (fs instanceof LocalFileSystem) {\n-      // running on LocalFileSystem, which does not support the required capabilities `HSYNC`\n-      // and `HFLUSH`. disable enforcement.\n-      final boolean value = false;\n-      LOG.warn(\"Cannot enforce durability guarantees while running on {}. Setting {}={} for\"\n-        + \" this FileSystem.\", fs.getUri(), UNSAFE_STREAM_CAPABILITY_ENFORCE, value);\n-      fs.getConf().setBoolean(UNSAFE_STREAM_CAPABILITY_ENFORCE, value);", "originalCommit": "5f7bd7713cbbe205cefe537b477b3ab95db036ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjI3MjA5OQ==", "url": "https://github.com/apache/hbase/pull/1597#discussion_r416272099", "bodyText": "Why in the above xml we change ** to * and here we change * to **...", "author": "Apache9", "createdAt": "2020-04-28T02:01:54Z", "path": "hbase-common/src/main/java/org/apache/hadoop/hbase/util/CommonFSUtils.java", "diffHunk": "@@ -1,4 +1,4 @@\n-/*\n+/**", "originalCommit": "5f7bd7713cbbe205cefe537b477b3ab95db036ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg5MjcyMw==", "url": "https://github.com/apache/hbase/pull/1597#discussion_r416892723", "bodyText": "Why in the above xml we change ** to * and here we change * to **...\n\nThis reverts the two existing commits. I have not retained the minor improvements they provided.", "author": "ndimiduk", "createdAt": "2020-04-28T20:13:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjI3MjA5OQ=="}], "type": "inlineReview"}, {"oid": "69a9386dcf1ecc67675ff850d9e61047c57dd27b", "url": "https://github.com/apache/hbase/commit/69a9386dcf1ecc67675ff850d9e61047c57dd27b", "message": "HBASE-24271 Set values in `conf/hbase-site.xml` that enable running on `LocalFileSystem` out of the box\n\nSimplify the new user experience shipping a configuration that enables\na fresh checkout or tarball distribution to run in standalone mode\nwithout direct user configuration. This change restores the behavior\nwe had when running on Hadoop 2.8 and earlier.\n\nPatch for master includes an update to the book. This change will be\nomitted when backporting to earlier branches.", "committedDate": "2020-04-29T19:37:55Z", "type": "forcePushed"}, {"oid": "6f7a566cd3ecdc9afa5832ee937ed5ac5112547f", "url": "https://github.com/apache/hbase/commit/6f7a566cd3ecdc9afa5832ee937ed5ac5112547f", "message": "Revert \"HBASE-24106 Update getting started documentation after HBASE-24086\"\n\nThis reverts commit 7de861bb839e05dfbf5709c55387c3be6dd7344b.", "committedDate": "2020-05-14T20:12:02Z", "type": "commit"}, {"oid": "b428a5b4a4ca7c8f75f302b09a0881a0d83c3a2a", "url": "https://github.com/apache/hbase/commit/b428a5b4a4ca7c8f75f302b09a0881a0d83c3a2a", "message": "Revert \"HBASE-24086 Disable output stream capability enforcement when running on LocalFileSystem\"\n\nThis reverts commit 10cbb3fb7310e88de3814396bd7766303c2e65aa.", "committedDate": "2020-05-14T20:12:02Z", "type": "commit"}, {"oid": "f825b914c921e52bd36f7c71a7a6d1b0199b85e9", "url": "https://github.com/apache/hbase/commit/f825b914c921e52bd36f7c71a7a6d1b0199b85e9", "message": "HBASE-24271 Set values in `conf/hbase-site.xml` that enable running on `LocalFileSystem` out of the box\n\nSimplify the new user experience shipping a configuration that enables\na fresh checkout or tarball distribution to run in standalone mode\nwithout direct user configuration. This change restores the behavior\nwe had when running on Hadoop 2.8 and earlier.\n\nPatch for master includes an update to the book. This change will be\nomitted when backporting to earlier branches.", "committedDate": "2020-05-14T20:12:34Z", "type": "forcePushed"}, {"oid": "9e8107b33ed5c7c06ac0a1e07ae937c2e3c19d2a", "url": "https://github.com/apache/hbase/commit/9e8107b33ed5c7c06ac0a1e07ae937c2e3c19d2a", "message": "HBASE-24271 Set values in `conf/hbase-site.xml` that enable running on `LocalFileSystem` out of the box\n\nSimplify the new user experience shipping a configuration that enables\na fresh checkout or tarball distribution to run in standalone mode\nwithout direct user configuration. This change restores the behavior\nwe had when running on Hadoop 2.8 and earlier.\n\nPatch for master includes an update to the book. This change will be\nomitted when backporting to earlier branches.\n\nSigned-off-by: stack <stack@apache.org>\nSigned-off-by: Josh Elser <elserj@apache.org>\nSigned-off-by: Duo Zhang <zhangduo@apache.org>", "committedDate": "2020-05-14T20:15:45Z", "type": "commit"}, {"oid": "9e8107b33ed5c7c06ac0a1e07ae937c2e3c19d2a", "url": "https://github.com/apache/hbase/commit/9e8107b33ed5c7c06ac0a1e07ae937c2e3c19d2a", "message": "HBASE-24271 Set values in `conf/hbase-site.xml` that enable running on `LocalFileSystem` out of the box\n\nSimplify the new user experience shipping a configuration that enables\na fresh checkout or tarball distribution to run in standalone mode\nwithout direct user configuration. This change restores the behavior\nwe had when running on Hadoop 2.8 and earlier.\n\nPatch for master includes an update to the book. This change will be\nomitted when backporting to earlier branches.\n\nSigned-off-by: stack <stack@apache.org>\nSigned-off-by: Josh Elser <elserj@apache.org>\nSigned-off-by: Duo Zhang <zhangduo@apache.org>", "committedDate": "2020-05-14T20:15:45Z", "type": "forcePushed"}]}