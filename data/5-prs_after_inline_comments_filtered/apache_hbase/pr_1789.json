{"pr_number": 1789, "pr_title": "HBASE-22738 Fallback to default group to choose RS when there are no \u2026", "pr_createdAt": "2020-05-27T11:49:37Z", "pr_url": "https://github.com/apache/hbase/pull/1789", "timeline": [{"oid": "74613b1c25cf96069b6f20510a62ba8e66e6641d", "url": "https://github.com/apache/hbase/commit/74613b1c25cf96069b6f20510a62ba8e66e6641d", "message": "HBASE-22738 Fallback to default group to choose RS when there are no RS in current group", "committedDate": "2020-05-28T03:09:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU3MTI5NA==", "url": "https://github.com/apache/hbase/pull/1789#discussion_r431571294", "bodyText": "groups? Allow fallback to more than one group?", "author": "infraio", "createdAt": "2020-05-28T04:13:16Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupBasedLoadBalancer.java", "diffHunk": "@@ -77,6 +81,23 @@\n   private volatile RSGroupInfoManager rsGroupInfoManager;\n   private LoadBalancer internalBalancer;\n \n+  /** Define the config key of if fallback group is enabled */\n+  public static final String FALLBACK_GROUP_ENABLED_KEY = \"hbase.rsgroup.fallback.groups.enable\";\n+  public static final boolean FALLBACK_GROUP_ENABLED_DEFAULT = false;\n+\n+  /** Define the config key of fallback groups */\n+  public static final String FALLBACK_GROUPS_KEY = \"hbase.rsgroup.fallback.groups\";", "originalCommit": "74613b1c25cf96069b6f20510a62ba8e66e6641d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTYzNjQxOA==", "url": "https://github.com/apache/hbase/pull/1789#discussion_r431636418", "bodyText": "Yes, we can config multiple comma-separated group.", "author": "ddupg", "createdAt": "2020-05-28T07:31:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU3MTI5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU3MTQ4MA==", "url": "https://github.com/apache/hbase/pull/1789#discussion_r431571480", "bodyText": "This config doesn't need be introduced? Enable this when config FALLBACK_GROUPS_KEY.", "author": "infraio", "createdAt": "2020-05-28T04:14:05Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupBasedLoadBalancer.java", "diffHunk": "@@ -77,6 +81,23 @@\n   private volatile RSGroupInfoManager rsGroupInfoManager;\n   private LoadBalancer internalBalancer;\n \n+  /** Define the config key of if fallback group is enabled */\n+  public static final String FALLBACK_GROUP_ENABLED_KEY = \"hbase.rsgroup.fallback.groups.enable\";", "originalCommit": "74613b1c25cf96069b6f20510a62ba8e66e6641d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTYzNzc0Mw==", "url": "https://github.com/apache/hbase/pull/1789#discussion_r431637743", "bodyText": "OK, I keep only FALLBACK_GROUPS_KEY and remove FALLBACK_GROUP_ENABLED_KEY.", "author": "ddupg", "createdAt": "2020-05-28T07:34:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU3MTQ4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU3MTc1MA==", "url": "https://github.com/apache/hbase/pull/1789#discussion_r431571750", "bodyText": "Do we need this chore? This should be work of RSGroupBalancer?", "author": "infraio", "createdAt": "2020-05-28T04:15:14Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupBasedLoadBalancer.java", "diffHunk": "@@ -77,6 +81,23 @@\n   private volatile RSGroupInfoManager rsGroupInfoManager;\n   private LoadBalancer internalBalancer;\n \n+  /** Define the config key of if fallback group is enabled */\n+  public static final String FALLBACK_GROUP_ENABLED_KEY = \"hbase.rsgroup.fallback.groups.enable\";\n+  public static final boolean FALLBACK_GROUP_ENABLED_DEFAULT = false;\n+\n+  /** Define the config key of fallback groups */\n+  public static final String FALLBACK_GROUPS_KEY = \"hbase.rsgroup.fallback.groups\";\n+  public static final String FALLBACK_GROUPS_DEFAULT = RSGroupInfo.DEFAULT_GROUP;\n+\n+  /** Define the config key of interval to correct fallback regions */\n+  static final String FALLBACK_CORRECT_INTERVAL_KEY = \"hbase.rsgroup.fallback.correct.interval\";\n+  static final int FALLBACK_CORRECT_INTERVAL_DEFAULT = 10 * 60 * 1000; // 10min\n+\n+  private boolean fallbackEnabled;\n+  private List<String> fallbackGroups;\n+  @VisibleForTesting\n+  FallbackCorrector fallbackCorrector;", "originalCommit": "74613b1c25cf96069b6f20510a62ba8e66e6641d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY0MDYxNw==", "url": "https://github.com/apache/hbase/pull/1789#discussion_r431640617", "bodyText": "I tried and make sure that RSGroupBalancer works for this when the balancer switch is on. Let me remove the code about the chore.", "author": "ddupg", "createdAt": "2020-05-28T07:39:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU3MTc1MA=="}], "type": "inlineReview"}, {"oid": "29ecbd54e20dc71da877d2fe3f4f6c470da4ccae", "url": "https://github.com/apache/hbase/commit/29ecbd54e20dc71da877d2fe3f4f6c470da4ccae", "message": "HBASE-22738 Fallback to default group to choose RS when there are no RS in current group", "committedDate": "2020-05-28T07:28:06Z", "type": "commit"}, {"oid": "29ecbd54e20dc71da877d2fe3f4f6c470da4ccae", "url": "https://github.com/apache/hbase/commit/29ecbd54e20dc71da877d2fe3f4f6c470da4ccae", "message": "HBASE-22738 Fallback to default group to choose RS when there are no RS in current group", "committedDate": "2020-05-28T07:28:06Z", "type": "forcePushed"}]}