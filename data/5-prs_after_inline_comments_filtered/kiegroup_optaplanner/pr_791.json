{"pr_number": 791, "pr_title": "Externalize quarkus OptaPlanner", "pr_createdAt": "2020-05-27T17:52:54Z", "pr_url": "https://github.com/kiegroup/optaplanner/pull/791", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY2NjMyNQ==", "url": "https://github.com/kiegroup/optaplanner/pull/791#discussion_r431666325", "bodyText": "Personally, I think that this code belongs in optaplanner-core. The reason it's not there, is that the annotations used prevent that. Simple solution: put the impl in core, but leave the annotating bells and whistles here.", "author": "triceo", "createdAt": "2020-05-28T08:26:17Z", "path": "optaplanner-quarkus-integration/optaplanner-quarkus/runtime/src/main/java/org/optaplanner/quarkus/nativeimage/Substitute_MemberAccessorFactory.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.optaplanner.quarkus.nativeimage;\n+\n+import java.lang.annotation.Annotation;\n+import java.lang.reflect.Field;\n+import java.lang.reflect.Member;\n+import java.lang.reflect.Method;\n+\n+import org.optaplanner.core.impl.domain.common.ReflectionHelper;\n+import org.optaplanner.core.impl.domain.common.accessor.MemberAccessor;\n+import org.optaplanner.core.impl.domain.common.accessor.MemberAccessorFactory;\n+import org.optaplanner.core.impl.domain.common.accessor.ReflectionBeanPropertyMemberAccessor;\n+import org.optaplanner.core.impl.domain.common.accessor.ReflectionFieldMemberAccessor;\n+import org.optaplanner.core.impl.domain.common.accessor.ReflectionMethodMemberAccessor;\n+\n+import com.oracle.svm.core.annotate.Substitute;\n+import com.oracle.svm.core.annotate.TargetClass;\n+\n+@TargetClass(className = \"org.optaplanner.core.impl.domain.common.accessor.MemberAccessorFactory\")\n+public final class Substitute_MemberAccessorFactory {", "originalCommit": "ae34dbcdd47ff0c499cca2c470a8bebfe1f07df2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY2Njc2Mw==", "url": "https://github.com/kiegroup/optaplanner/pull/791#discussion_r431666763", "bodyText": "Also, I don't know why this class exists. Why substitute one part of code that does reflection, with another one that still does reflection?", "author": "triceo", "createdAt": "2020-05-28T08:27:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY2NjMyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM2NzA4OQ==", "url": "https://github.com/kiegroup/optaplanner/pull/791#discussion_r432367089", "bodyText": "This is for Graal: it can't handle MethodHandles, but it can handle old-fashioned reflection.\nOnce our gizmo work starts, we can probably ditch MethodHandles alltogether (they are faster than old-fasioned reflection, but slower than gizmo code generation)", "author": "ge0ffrey", "createdAt": "2020-05-29T09:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY2NjMyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MzcxOQ==", "url": "https://github.com/kiegroup/optaplanner/pull/791#discussion_r433963719", "bodyText": "This is definitely an open issue to clean this up better, indeed. I 've created a jira to track:\nhttps://issues.redhat.com/browse/PLANNER-2002", "author": "ge0ffrey", "createdAt": "2020-06-02T15:27:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY2NjMyNQ=="}], "type": "inlineReview"}, {"oid": "6bc2ff12afef48836f5d75fba62cb2449fcb8521", "url": "https://github.com/kiegroup/optaplanner/commit/6bc2ff12afef48836f5d75fba62cb2449fcb8521", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner", "committedDate": "2020-06-02T15:33:29Z", "type": "commit"}, {"oid": "a255205f2501c7f0160aa0d0885ce03268d247dc", "url": "https://github.com/kiegroup/optaplanner/commit/a255205f2501c7f0160aa0d0885ce03268d247dc", "message": "Refactor package optaplanner-quarkus to org.optaplanner.quarkus", "committedDate": "2020-06-02T15:33:29Z", "type": "commit"}, {"oid": "5ee0f8465559248c5e597248788aa58c3cedbb73", "url": "https://github.com/kiegroup/optaplanner/commit/5ee0f8465559248c5e597248788aa58c3cedbb73", "message": "Refactor package optaplanner-quarkus* to org.optaplanner.quarkus*", "committedDate": "2020-06-02T15:33:29Z", "type": "commit"}, {"oid": "296110cf94e5fad5094907ecfa47f98c79e2a82f", "url": "https://github.com/kiegroup/optaplanner/commit/296110cf94e5fad5094907ecfa47f98c79e2a82f", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: fix tests", "committedDate": "2020-06-02T15:33:29Z", "type": "commit"}, {"oid": "363c871e535c72c6e7831eddcf6f41f25a8643a3", "url": "https://github.com/kiegroup/optaplanner/commit/363c871e535c72c6e7831eddcf6f41f25a8643a3", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: fix kie-parent versions", "committedDate": "2020-06-02T15:33:30Z", "type": "commit"}, {"oid": "7337485f576a6a2c2973d7b8a415fdac0d2343fb", "url": "https://github.com/kiegroup/optaplanner/commit/7337485f576a6a2c2973d7b8a415fdac0d2343fb", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: don't skip native tests", "committedDate": "2020-06-02T15:33:30Z", "type": "commit"}, {"oid": "2d5a4ce5c8705462a2f67a44a16f4fa7606170ec", "url": "https://github.com/kiegroup/optaplanner/commit/2d5a4ce5c8705462a2f67a44a16f4fa7606170ec", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: indentation", "committedDate": "2020-06-02T15:33:30Z", "type": "commit"}, {"oid": "bdf638346d919f3b6f86743c2ca8c9afa6b20c10", "url": "https://github.com/kiegroup/optaplanner/commit/bdf638346d919f3b6f86743c2ca8c9afa6b20c10", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: add descriptions in pom", "committedDate": "2020-06-02T15:33:30Z", "type": "commit"}, {"oid": "4919ff5bbf4effb52ded45176de0671d6b3c3652", "url": "https://github.com/kiegroup/optaplanner/commit/4919ff5bbf4effb52ded45176de0671d6b3c3652", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: parent pom workarounds (enforcer)", "committedDate": "2020-06-04T19:38:28Z", "type": "commit"}, {"oid": "4919ff5bbf4effb52ded45176de0671d6b3c3652", "url": "https://github.com/kiegroup/optaplanner/commit/4919ff5bbf4effb52ded45176de0671d6b3c3652", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: parent pom workarounds (enforcer)", "committedDate": "2020-06-04T19:38:28Z", "type": "forcePushed"}, {"oid": "60bd7f2fe756f6ddf4eecb4aff13c791e081c133", "url": "https://github.com/kiegroup/optaplanner/commit/60bd7f2fe756f6ddf4eecb4aff13c791e081c133", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: upgrade to quarkus 1.5.0", "committedDate": "2020-06-05T19:37:44Z", "type": "commit"}, {"oid": "e21f4d67978548b6d854e20f0e5cb861d26e0f1f", "url": "https://github.com/kiegroup/optaplanner/commit/e21f4d67978548b6d854e20f0e5cb861d26e0f1f", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: Fix duplicate classes", "committedDate": "2020-06-06T12:14:57Z", "type": "commit"}, {"oid": "49b8e23b9592c84a1b11e1fef1648d7f7a6a54a0", "url": "https://github.com/kiegroup/optaplanner/commit/49b8e23b9592c84a1b11e1fef1648d7f7a6a54a0", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: Disable enforcing no duplicate classes", "committedDate": "2020-06-06T14:56:12Z", "type": "commit"}, {"oid": "ec6c660f12fdc2e4fbbe3a2ed27bddc4a7a7ecf5", "url": "https://github.com/kiegroup/optaplanner/commit/ec6c660f12fdc2e4fbbe3a2ed27bddc4a7a7ecf5", "message": "PLANNER-1973 Externalize Quarkus OptaPlanner: github actions do clean install", "committedDate": "2020-06-08T08:01:04Z", "type": "commit"}]}