{"pr_number": 640, "pr_title": "[Code health] Fix unchecked instances of Optional.get()", "pr_createdAt": "2020-11-25T14:58:25Z", "pr_url": "https://github.com/google/ground-android/pull/640", "timeline": [{"oid": "7b75caa8c677ce6472edbb0ce4d88a464b0c2caf", "url": "https://github.com/google/ground-android/commit/7b75caa8c677ce6472edbb0ce4d88a464b0c2caf", "message": "Skip and log invalid Observations", "committedDate": "2020-11-25T14:53:58Z", "type": "commit"}, {"oid": "22da5ef7e8c401cd83625e77b5fdec92b3db49b4", "url": "https://github.com/google/ground-android/commit/22da5ef7e8c401cd83625e77b5fdec92b3db49b4", "message": "Skip and log invalid Features", "committedDate": "2020-11-25T14:56:41Z", "type": "commit"}, {"oid": "9a7ad6cc47abf0f3ed508d86cab888b65a71512a", "url": "https://github.com/google/ground-android/commit/9a7ad6cc47abf0f3ed508d86cab888b65a71512a", "message": "Handle missing formId", "committedDate": "2020-11-25T14:56:42Z", "type": "commit"}, {"oid": "116a13822526b3ce33c0f9993e8557aabe935089", "url": "https://github.com/google/ground-android/commit/116a13822526b3ce33c0f9993e8557aabe935089", "message": "Handle missing user", "committedDate": "2020-11-25T14:56:43Z", "type": "commit"}, {"oid": "964e7284ea6a97c5f0a1f8c5352e2715976fcfa5", "url": "https://github.com/google/ground-android/commit/964e7284ea6a97c5f0a1f8c5352e2715976fcfa5", "message": "Check for form in same context its used", "committedDate": "2020-11-25T15:02:52Z", "type": "commit"}, {"oid": "a9c02c3c6eb0cc5b4b2623a7c4c462ee73ae3f06", "url": "https://github.com/google/ground-android/commit/a9c02c3c6eb0cc5b4b2623a7c4c462ee73ae3f06", "message": "Merge branch 'master' into fix-optional-get", "committedDate": "2020-11-25T15:04:41Z", "type": "commit"}, {"oid": "309f294892265de8cbcf45cfab577f3575492e9a", "url": "https://github.com/google/ground-android/commit/309f294892265de8cbcf45cfab577f3575492e9a", "message": "Extend RuntimeException instead of Error", "committedDate": "2020-11-25T17:55:50Z", "type": "commit"}, {"oid": "52eba0a83f9016beffd50289cae8b9990bb7fa03", "url": "https://github.com/google/ground-android/commit/52eba0a83f9016beffd50289cae8b9990bb7fa03", "message": "Merge remote-tracking branch 'origin/fix-optional-get' into fix-optional-get", "committedDate": "2020-11-25T17:56:12Z", "type": "commit"}, {"oid": "f0b1afe216d868f8bd33fbfe342ab529a60972bf", "url": "https://github.com/google/ground-android/commit/f0b1afe216d868f8bd33fbfe342ab529a60972bf", "message": "Merge branch 'master' into fix-optional-get", "committedDate": "2020-11-25T18:31:41Z", "type": "commit"}, {"oid": "383436e17044a739edc4361367e7dc3a6a05f43e", "url": "https://github.com/google/ground-android/commit/383436e17044a739edc4361367e7dc3a6a05f43e", "message": "Merge branch 'master' into fix-optional-get", "committedDate": "2020-12-08T16:17:50Z", "type": "commit"}, {"oid": "80774f1aa6d51675cb3f34a2221426d92b387f4a", "url": "https://github.com/google/ground-android/commit/80774f1aa6d51675cb3f34a2221426d92b387f4a", "message": "Merge branch 'master' of https://github.com/google/ground-android into fix-optional-get\n\n\u0001 Conflicts:\n\u0001\tgnd/src/main/java/com/google/android/gnd/persistence/local/room/entity/FeatureEntity.java\n\u0001\tgnd/src/main/java/com/google/android/gnd/persistence/local/room/entity/ObservationEntity.java\n\u0001\tgnd/src/main/java/com/google/android/gnd/repository/ObservationRepository.java", "committedDate": "2020-12-08T17:02:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxMzAxOA==", "url": "https://github.com/google/ground-android/pull/640#discussion_r538613018", "bodyText": "Timber.e", "author": "shobhitagarwal1612", "createdAt": "2020-12-08T17:08:39Z", "path": "gnd/src/main/java/com/google/android/gnd/util/StreamUtil.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.util;\n+\n+import static java8.util.stream.StreamSupport.stream;\n+\n+import java.util.Collections;\n+import java8.util.function.Supplier;\n+import java8.util.stream.Stream;\n+import timber.log.Timber;\n+\n+/** Methods for working with and manipulating {@link java8.util.stream.Stream}s. */\n+public class StreamUtil {\n+\n+  /**\n+   * Executes the specified Supplier, writing throw Error exceptions to debug logs. If an error\n+   * occurs, an empty Stream is returned, otherwise a Stream with only the result of the Supplier is\n+   * returned.\n+   */\n+  public static <R> Stream<R> logErrorsAndSkip(Supplier<R> supplier) {\n+    try {\n+      return stream(Collections.singleton(supplier.get()));\n+    } catch (RuntimeException e) {\n+      Timber.d(e);", "originalCommit": "80774f1aa6d51675cb3f34a2221426d92b387f4a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYyMTQ2Ng==", "url": "https://github.com/google/ground-android/pull/640#discussion_r538621466", "bodyText": "Not sure at what level these should actually be logged, but will change to e() to err [:))] on the side of caution.", "author": "gino-m", "createdAt": "2020-12-08T17:16:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxMzAxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYyNDE1Mg==", "url": "https://github.com/google/ground-android/pull/640#discussion_r538624152", "bodyText": "All error type logs are uploaded to crashlytics. So it would be a nice thing for us to keep track of.", "author": "shobhitagarwal1612", "createdAt": "2020-12-08T17:18:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxMzAxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxMzk1Nw==", "url": "https://github.com/google/ground-android/pull/640#discussion_r538613957", "bodyText": "Timber.e", "author": "shobhitagarwal1612", "createdAt": "2020-12-08T17:09:28Z", "path": "gnd/src/main/java/com/google/android/gnd/persistence/local/room/RoomLocalDataStore.java", "diffHunk": "@@ -268,8 +266,8 @@ public Completable applyAndEnqueue(FeatureMutation mutation) {\n     return featureDao\n         .findById(featureId)\n         .map(f -> FeatureEntity.toFeature(f, project))\n-        .filter(Optional::isPresent)\n-        .map(Optional::get)\n+        .doOnError(e -> Timber.d(e))", "originalCommit": "80774f1aa6d51675cb3f34a2221426d92b387f4a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYyNDYzMA==", "url": "https://github.com/google/ground-android/pull/640#discussion_r538624630", "bodyText": "This one is left.", "author": "shobhitagarwal1612", "createdAt": "2020-12-08T17:19:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxMzk1Nw=="}], "type": "inlineReview"}, {"oid": "1d2d7d2fd1c29fe41c1d2c6274cb84b64abe3c8c", "url": "https://github.com/google/ground-android/commit/1d2d7d2fd1c29fe41c1d2c6274cb84b64abe3c8c", "message": "Log error instead of debug", "committedDate": "2020-12-08T17:16:43Z", "type": "commit"}, {"oid": "3c78bee97b32f7cbd21a3a174afe877483818374", "url": "https://github.com/google/ground-android/commit/3c78bee97b32f7cbd21a3a174afe877483818374", "message": "Timber.d -> Timber.e", "committedDate": "2020-12-08T17:23:42Z", "type": "commit"}]}