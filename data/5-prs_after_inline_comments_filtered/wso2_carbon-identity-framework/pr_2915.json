{"pr_number": 2915, "pr_title": "Implement deletion of all consents of a tenant on tenant deletion", "pr_createdAt": "2020-04-30T10:59:47Z", "pr_url": "https://github.com/wso2/carbon-identity-framework/pull/2915", "timeline": [{"oid": "b320a216f972fb2c511824844604352d24e30778", "url": "https://github.com/wso2/carbon-identity-framework/commit/b320a216f972fb2c511824844604352d24e30778", "message": "Implement consents deletion on tenant deletion", "committedDate": "2020-05-21T11:36:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc2MzA1OA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2915#discussion_r440763058", "bodyText": "Shall we add the method comment here?", "author": "ShanChathusanda93", "createdAt": "2020-06-16T10:55:20Z", "path": "components/consent-mgt/org.wso2.carbon.identity.consent.mgt/src/main/java/org/wso2/carbon/identity/consent/mgt/listener/TenantConsentMgtListener.java", "diffHunk": "@@ -44,6 +45,35 @@ public void onTenantCreate(TenantInfoBean tenantInfoBean) throws StratosExceptio\n         }\n     }\n \n+    @Override\n+    public void onPreDelete(int tenantId) throws StratosException {", "originalCommit": "b320a216f972fb2c511824844604352d24e30778", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7bd18c58ffbcfa3dcc96b48c40f3c9a3e0263595", "url": "https://github.com/wso2/carbon-identity-framework/commit/7bd18c58ffbcfa3dcc96b48c40f3c9a3e0263595", "message": "Implement consents deletion on tenant deletion", "committedDate": "2020-06-16T19:51:46Z", "type": "commit"}, {"oid": "7bd18c58ffbcfa3dcc96b48c40f3c9a3e0263595", "url": "https://github.com/wso2/carbon-identity-framework/commit/7bd18c58ffbcfa3dcc96b48c40f3c9a3e0263595", "message": "Implement consents deletion on tenant deletion", "committedDate": "2020-06-16T19:51:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTExODEwOA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2915#discussion_r551118108", "bodyText": "Complete the javadoc comments. Add the specific Exception type. and also the param descriptions should start with a capital letter and end with a full stop.", "author": "sachiniWettasinghe", "createdAt": "2021-01-04T04:57:41Z", "path": "components/consent-mgt/org.wso2.carbon.identity.consent.mgt/src/main/java/org/wso2/carbon/identity/consent/mgt/listener/TenantConsentMgtListener.java", "diffHunk": "@@ -44,6 +45,41 @@ public void onTenantCreate(TenantInfoBean tenantInfoBean) throws StratosExceptio\n         }\n     }\n \n+    /**\n+     * Delete all consents belongs to a given tenant before deleting the tenant.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws StratosException", "originalCommit": "7bd18c58ffbcfa3dcc96b48c40f3c9a3e0263595", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mjk5NjMzOA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2915#discussion_r552996338", "bodyText": "Fixed in #3312", "author": "sumedhe", "createdAt": "2021-01-06T22:28:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTExODEwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTExODEyNA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2915#discussion_r551118124", "bodyText": "Complete the javadoc comments.", "author": "sachiniWettasinghe", "createdAt": "2021-01-04T04:57:50Z", "path": "components/consent-mgt/org.wso2.carbon.identity.consent.mgt/src/main/java/org/wso2/carbon/identity/consent/mgt/listener/TenantConsentMgtListener.java", "diffHunk": "@@ -44,6 +45,41 @@ public void onTenantCreate(TenantInfoBean tenantInfoBean) throws StratosExceptio\n         }\n     }\n \n+    /**\n+     * Delete all consents belongs to a given tenant before deleting the tenant.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws StratosException\n+     */\n+    @Override\n+    public void onPreDelete(int tenantId) throws StratosException {\n+\n+        if (log.isDebugEnabled()) {\n+            log.info(\"Deleting all consents of the tenant: \" + tenantId);\n+        }\n+        deleteAllConsents(tenantId);\n+    }\n+\n+    /**\n+     * Delete all consents belongs to a given tenant id.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws StratosException", "originalCommit": "7bd18c58ffbcfa3dcc96b48c40f3c9a3e0263595", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mjk5NjQ2MQ==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2915#discussion_r552996461", "bodyText": "Fixed in #3312", "author": "sumedhe", "createdAt": "2021-01-06T22:28:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTExODEyNA=="}], "type": "inlineReview"}]}