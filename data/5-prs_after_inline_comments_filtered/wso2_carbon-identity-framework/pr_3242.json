{"pr_number": 3242, "pr_title": "Adding cache clearing to application template delete scenario", "pr_createdAt": "2020-11-11T11:12:49Z", "pr_url": "https://github.com/wso2/carbon-identity-framework/pull/3242", "timeline": [{"oid": "0819170f7c9f974bf6fce4261b78d7682b152b77", "url": "https://github.com/wso2/carbon-identity-framework/commit/0819170f7c9f974bf6fce4261b78d7682b152b77", "message": "Adding cache clearing to application template delete scenario", "committedDate": "2020-11-11T11:12:13Z", "type": "commit"}, {"oid": "d19e982f12ae189c00b3ed8c64e1e79487140e22", "url": "https://github.com/wso2/carbon-identity-framework/commit/d19e982f12ae189c00b3ed8c64e1e79487140e22", "message": "Improve cache clearing on resource update and delete", "committedDate": "2020-11-11T15:43:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ4MTgzOA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/3242#discussion_r521481838", "bodyText": "formatting issues", "author": "IsuraD", "createdAt": "2020-11-11T16:31:15Z", "path": "components/configuration-mgt/org.wso2.carbon.identity.configuration.mgt.core/src/main/java/org/wso2/carbon/identity/configuration/mgt/core/dao/impl/CachedBackedConfigurationDAO.java", "diffHunk": "@@ -299,67 +302,31 @@ private Resource getResourceFromCacheByName(String resourceName, int tenantId)\n     private Resource getResourceFromCacheById(String resourceId, String tenantDomain)\n             throws ConfigurationManagementException {\n \n-        int tenantId;\n-        try {\n-            tenantId = ConfigurationManagerComponentDataHolder.getInstance().getRealmService()\n-                    .getTenantManager().getTenantId(MultitenantConstants.SUPER_TENANT_DOMAIN_NAME);\n-        } catch (UserStoreException e) {\n-            throw new ConfigurationManagementException(\"Error when setting tenant domain. \",\n-                    ConfigurationConstants.ErrorMessages.ERROR_CODE_UNEXPECTED.getCode(), e);\n-        }\n-\n-        try {\n-            PrivilegedCarbonContext.startTenantFlow();\n-            PrivilegedCarbonContext.getThreadLocalCarbonContext()\n-                    .setTenantDomain(MultitenantConstants.SUPER_TENANT_DOMAIN_NAME);\n-            PrivilegedCarbonContext.getThreadLocalCarbonContext().setTenantId(tenantId);\n-\n-            ResourceByIdCacheKey resourceByIdCacheKey = new ResourceByIdCacheKey(resourceId, tenantDomain);\n-            ResourceCacheEntry resourceCacheEntry = resourceByIdCache.getValueFromCache(resourceByIdCacheKey);\n-            if (resourceCacheEntry != null) {\n-                if (log.isDebugEnabled()) {\n-                    String message = String.format(\"Entry found from Resource by id cache. Resource id: %s., Tenant \" +\n-                            \"domain %s\", resourceId, tenantDomain);\n-                    log.debug(message);\n-                }\n-                return resourceCacheEntry.getResource();\n+       ResourceByIdCacheKey resourceByIdCacheKey = new ResourceByIdCacheKey(resourceId, tenantDomain);", "originalCommit": "d19e982f12ae189c00b3ed8c64e1e79487140e22", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ4NDQ5OA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/3242#discussion_r521484498", "bodyText": "Fixed: 7618b17", "author": "somindatommy", "createdAt": "2020-11-11T16:33:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ4MTgzOA=="}], "type": "inlineReview"}, {"oid": "7618b179bb89b5d3b1354d4734a7136fad1637b5", "url": "https://github.com/wso2/carbon-identity-framework/commit/7618b179bb89b5d3b1354d4734a7136fad1637b5", "message": "Fix formatting error", "committedDate": "2020-11-11T16:32:23Z", "type": "commit"}]}