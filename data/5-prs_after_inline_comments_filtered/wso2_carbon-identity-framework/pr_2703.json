{"pr_number": 2703, "pr_title": "WantAuthnRequestsSigned IDPSSODescriptor is not configurable in resident IDP. #7323 ", "pr_createdAt": "2020-01-27T14:29:19Z", "pr_url": "https://github.com/wso2/carbon-identity-framework/pull/2703", "timeline": [{"oid": "fd3017b9c5d1fe9bd129f7bfae47a69b529f3b20", "url": "https://github.com/wso2/carbon-identity-framework/commit/fd3017b9c5d1fe9bd129f7bfae47a69b529f3b20", "message": "WantAuthnRequestsSigned, NameIDFormat & more elements in IDPSSODescriptor is not configurable in resident IDP. #7323", "committedDate": "2020-01-27T14:25:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkyNDQ5OQ==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2703#discussion_r371924499", "bodyText": "limit the length to 120.", "author": "thanujalk", "createdAt": "2020-01-28T16:47:04Z", "path": "components/identity-core/org.wso2.carbon.identity.base/src/main/java/org/wso2/carbon/identity/base/IdentityConstants.java", "diffHunk": "@@ -249,6 +249,10 @@ private IdentityConstants() {\n         public static final String SAML_SESSION_NOT_ON_OR_AFTER_PERIOD = \"SSOService.SAMLSessionNotOnOrAfterPeriod\";\n         public static final String SAML_METADATA_SIGNING_ENABLED = \"SSOService.SAMLMetadataSigningEnabled\";\n         public static final String SAML_ECP_URL = \"SSOService.SAMLECPEndpoint\";\n+        public static final String SAML_METADATA_WANT_AUTHN_REQUESTS_SIGNED_ENABLED=\"SSOService.WantAuthnRequestsSigned\";", "originalCommit": "fd3017b9c5d1fe9bd129f7bfae47a69b529f3b20", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkyODAzMA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2703#discussion_r371928030", "bodyText": "limit the length to 120.", "author": "thanujalk", "createdAt": "2020-01-28T16:52:51Z", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -180,6 +183,15 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             samlECPUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n         }\n \n+        WantAuthnRequestsSigned = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAML_METADATA_WANT_AUTHN_REQUESTS_SIGNED_ENABLED, true, true)", "originalCommit": "fd3017b9c5d1fe9bd129f7bfae47a69b529f3b20", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkyODMzNQ==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2703#discussion_r371928335", "bodyText": "limit the length to 120.", "author": "thanujalk", "createdAt": "2020-01-28T16:53:16Z", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -180,6 +183,15 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             samlECPUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n         }\n \n+        WantAuthnRequestsSigned = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAML_METADATA_WANT_AUTHN_REQUESTS_SIGNED_ENABLED, true, true)\n+                + IdPManagementUtil.getTenantParameter();\n+\n+        samlNameIDFormat=IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAML_METADATA_NAME_ID_FORMAT, true, true)\n+                + IdPManagementUtil.getTenantParameter();\n+\n+        attributeProfile=IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAML_METADATA_ATTRIBUTE_PROFILE, true, true)", "originalCommit": "fd3017b9c5d1fe9bd129f7bfae47a69b529f3b20", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjE4NzAxOQ==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2703#discussion_r372187019", "bodyText": "formatting issue. address this in every other instance of this PR", "author": "sachiniWettasinghe", "createdAt": "2020-01-29T04:47:27Z", "path": "components/application-mgt/org.wso2.carbon.identity.application.common/src/main/java/org/wso2/carbon/identity/application/common/util/IdentityApplicationConstants.java", "diffHunk": "@@ -174,6 +174,10 @@ private OpenID() {\n             public static final String SAML_METADATA_VALIDITY_PERIOD_DEFAULT = \"60\";\n             public static final String SAML_METADATA_SIGNING_ENABLED = \"SAMLMetadataSigningEnabled\";\n             public static final String SAML_METADATA_SIGNING_ENABLED_DEFAULT = \"false\";\n+            public static final String SAML_METADATA_WANT_AUTHN_REQUESTS_SIGNED_ENABLED=\"WantAuthnRequestsSigned\";\n+            public static final String SAML_METADATA_WANT_AUTHN_REQUESTS_SIGNED_DEFAULT=\"false\";\n+            public static final String SAML_METADATA_NAME_ID_FORMAT=\"NameIDFormat\";\n+            public static final String SAML_METADATA_ATTRIBUTE_PROFILE=\"AttributeProfile\";", "originalCommit": "fd3017b9c5d1fe9bd129f7bfae47a69b529f3b20", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjE4OTIyNA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2703#discussion_r372189224", "bodyText": "remove redundant lines", "author": "sachiniWettasinghe", "createdAt": "2020-01-29T04:59:56Z", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -470,6 +482,37 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n         }\n         propertiesList.add(samlMetadataSigningEnabledProperty);\n \n+        Property samlWantAuthnRequestSigninProperty = IdentityApplicationManagementUtil.getProperty(saml2SSOFedAuthn.\n+                getProperties(), IdentityApplicationConstants.Authenticator.SAML2SSO.\n+                SAML_METADATA_WANT_AUTHN_REQUESTS_SIGNED_ENABLED);\n+        if (samlWantAuthnRequestSigninProperty == null) {\n+            samlWantAuthnRequestSigninProperty = new Property();\n+            samlWantAuthnRequestSigninProperty.setName(IdentityApplicationConstants.Authenticator.SAML2SSO.\n+                    SAML_METADATA_WANT_AUTHN_REQUESTS_SIGNED_ENABLED);\n+            samlWantAuthnRequestSigninProperty.setValue(WantAuthnRequestsSigned);\n+        }\n+        propertiesList.add(samlWantAuthnRequestSigninProperty);\n+\n+        Property samlNameIDFormatProperty = IdentityApplicationManagementUtil.getProperty(saml2SSOFedAuthn.getProperties(),\n+                IdentityApplicationConstants.Authenticator.SAML2SSO.SAML_METADATA_NAME_ID_FORMAT);\n+        if (samlNameIDFormatProperty == null) {\n+            samlNameIDFormatProperty = new Property();\n+            samlNameIDFormatProperty.setName(IdentityApplicationConstants.Authenticator.SAML2SSO.SAML_METADATA_NAME_ID_FORMAT);\n+            samlSSOUrlProperty.setValue(samlNameIDFormat);\n+        }\n+        propertiesList.add(samlNameIDFormatProperty);\n+\n+        Property samlAttributeProfileProperty = IdentityApplicationManagementUtil.getProperty(saml2SSOFedAuthn.getProperties(),\n+                IdentityApplicationConstants.Authenticator.SAML2SSO.SAML_METADATA_ATTRIBUTE_PROFILE);\n+        if (samlAttributeProfileProperty == null) {\n+            samlAttributeProfileProperty = new Property();\n+            samlAttributeProfileProperty.setName(IdentityApplicationConstants.Authenticator.SAML2SSO.SAML_METADATA_ATTRIBUTE_PROFILE);\n+            samlSSOUrlProperty.setValue(attributeProfile);\n+        }\n+        propertiesList.add(samlAttributeProfileProperty);\n+\n+\n+", "originalCommit": "fd3017b9c5d1fe9bd129f7bfae47a69b529f3b20", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a206536f7d5d7f555eea3295ae27f310273a8b78", "url": "https://github.com/wso2/carbon-identity-framework/commit/a206536f7d5d7f555eea3295ae27f310273a8b78", "message": "Fixing formating issues and Removing NameIDFormat and AttrinutePRofile implementation", "committedDate": "2020-01-30T07:01:27Z", "type": "commit"}, {"oid": "e50be8c3d24e268c9975c2b1692e32c00b353fee", "url": "https://github.com/wso2/carbon-identity-framework/commit/e50be8c3d24e268c9975c2b1692e32c00b353fee", "message": "Fix formatting issues", "committedDate": "2020-01-30T09:09:48Z", "type": "commit"}, {"oid": "9609a5ccc4704aa5385952a357dbe2c6927b7097", "url": "https://github.com/wso2/carbon-identity-framework/commit/9609a5ccc4704aa5385952a357dbe2c6927b7097", "message": "Fixing formatting issues", "committedDate": "2020-01-31T04:33:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzMxOTA2OQ==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2703#discussion_r373319069", "bodyText": "formatting issue", "author": "emswbandara", "createdAt": "2020-01-31T05:15:50Z", "path": "components/application-mgt/org.wso2.carbon.identity.application.common/src/main/java/org/wso2/carbon/identity/application/common/util/IdentityApplicationConstants.java", "diffHunk": "@@ -174,7 +174,8 @@ private OpenID() {\n             public static final String SAML_METADATA_VALIDITY_PERIOD_DEFAULT = \"60\";\n             public static final String SAML_METADATA_SIGNING_ENABLED = \"SAMLMetadataSigningEnabled\";\n             public static final String SAML_METADATA_SIGNING_ENABLED_DEFAULT = \"false\";\n-\n+            public static final String SAML_METADATA_AUTHN_REQUESTS_SIGNING_ENABLED =\"samlAuthnRequestsSigningEnabled\";", "originalCommit": "9609a5ccc4704aa5385952a357dbe2c6927b7097", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzMxOTEwNQ==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2703#discussion_r373319105", "bodyText": "formatting issue", "author": "emswbandara", "createdAt": "2020-01-31T05:16:00Z", "path": "components/application-mgt/org.wso2.carbon.identity.application.common/src/main/java/org/wso2/carbon/identity/application/common/util/IdentityApplicationConstants.java", "diffHunk": "@@ -174,7 +174,8 @@ private OpenID() {\n             public static final String SAML_METADATA_VALIDITY_PERIOD_DEFAULT = \"60\";\n             public static final String SAML_METADATA_SIGNING_ENABLED = \"SAMLMetadataSigningEnabled\";\n             public static final String SAML_METADATA_SIGNING_ENABLED_DEFAULT = \"false\";\n-\n+            public static final String SAML_METADATA_AUTHN_REQUESTS_SIGNING_ENABLED =\"samlAuthnRequestsSigningEnabled\";\n+            public static final String SAML_METADATA_AUTHN_REQUESTS_SIGNING_DEFAULT =\"false\";", "originalCommit": "9609a5ccc4704aa5385952a357dbe2c6927b7097", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzMxOTM0Mg==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2703#discussion_r373319342", "bodyText": "formatting issue", "author": "emswbandara", "createdAt": "2020-01-31T05:17:25Z", "path": "components/identity-core/org.wso2.carbon.identity.base/src/main/java/org/wso2/carbon/identity/base/IdentityConstants.java", "diffHunk": "@@ -249,6 +249,8 @@ private IdentityConstants() {\n         public static final String SAML_SESSION_NOT_ON_OR_AFTER_PERIOD = \"SSOService.SAMLSessionNotOnOrAfterPeriod\";\n         public static final String SAML_METADATA_SIGNING_ENABLED = \"SSOService.SAMLMetadataSigningEnabled\";\n         public static final String SAML_ECP_URL = \"SSOService.SAMLECPEndpoint\";\n+        public static final String SAML_METADATA_AUTHN_REQUESTS_SIGNING_ENABLED =\"SSOService\" +", "originalCommit": "9609a5ccc4704aa5385952a357dbe2c6927b7097", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzMxOTg0NA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2703#discussion_r373319844", "bodyText": "this change seems unnecessary. Let's revert it", "author": "emswbandara", "createdAt": "2020-01-31T05:20:27Z", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -1107,8 +1139,7 @@ private void setExpressionNodeList(Node node, List<ExpressionNode> expression)\n                                         message);\n                     }\n                 }\n-            }\n-            expression.add((ExpressionNode) node);\n+            }expression.add((ExpressionNode) node);", "originalCommit": "9609a5ccc4704aa5385952a357dbe2c6927b7097", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "64286afc86b9467b7c94daa1915814657ca45836", "url": "https://github.com/wso2/carbon-identity-framework/commit/64286afc86b9467b7c94daa1915814657ca45836", "message": "Fixing formatting issues", "committedDate": "2020-01-31T05:34:29Z", "type": "commit"}, {"oid": "dd60e6ecf03c8a18443e426d0eb3e34a0aa31546", "url": "https://github.com/wso2/carbon-identity-framework/commit/dd60e6ecf03c8a18443e426d0eb3e34a0aa31546", "message": "Fixing formatting issues", "committedDate": "2020-01-31T09:28:17Z", "type": "commit"}]}