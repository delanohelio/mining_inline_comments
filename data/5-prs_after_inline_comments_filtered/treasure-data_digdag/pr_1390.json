{"pr_number": 1390, "pr_title": "Add validation for sla operator", "pr_createdAt": "2020-04-08T06:59:29Z", "pr_url": "https://github.com/treasure-data/digdag/pull/1390", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTkzMzM4NQ==", "url": "https://github.com/treasure-data/digdag/pull/1390#discussion_r405933385", "bodyText": "Just in case, if validation fail, updateSchedules() has been cancelled ?\nIf this method is only called in transaction and updateSchedules() has no side effect except Pg, I guess it is OK.", "author": "yoyama", "createdAt": "2020-04-09T03:18:39Z", "path": "digdag-core/src/main/java/io/digdag/core/repository/ProjectControl.java", "diffHunk": "@@ -69,6 +71,7 @@ public void insertRevisionArchiveData(int revId, byte[] data)\n     {\n         List<StoredWorkflowDefinition> list = insertWorkflowDefinitionsWithoutSchedules(revision, defs);\n         updateSchedules(revision, list, srm, currentTime);\n+        validateSla(defs);", "originalCommit": "b7679b19f29ad528b4925b4c5d9fcfe4529e19d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5NTM2OQ==", "url": "https://github.com/treasure-data/digdag/pull/1390#discussion_r405995369", "bodyText": "Thank you for checking, I think I should move this before inserting actually, so I fixed it.\na1ea9c6", "author": "naritta", "createdAt": "2020-04-09T07:01:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTkzMzM4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAxMzE4MA==", "url": "https://github.com/treasure-data/digdag/pull/1390#discussion_r406013180", "bodyText": "This exception is defined as package private.\nI am not sure how and where this exception is handled.\nIf it is only processed in same package, it is ok.", "author": "yoyama", "createdAt": "2020-04-09T07:38:51Z", "path": "digdag-core/src/main/java/io/digdag/core/workflow/SlaCalculator.java", "diffHunk": "@@ -13,22 +17,53 @@\n import com.google.inject.Inject;\n import io.digdag.client.config.Config;\n import io.digdag.client.config.ConfigException;\n+import io.digdag.core.agent.CheckedConfig;\n+import io.digdag.core.agent.EditDistance;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n import static java.util.Locale.ENGLISH;\n \n+class UnusedConfigException extends ConfigException", "originalCommit": "a1ea9c6584d5e08776adb5056851eaec415f0dc0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "863bf67131c258af80eaac49a46250dc77460170", "url": "https://github.com/treasure-data/digdag/commit/863bf67131c258af80eaac49a46250dc77460170", "message": "Add validation for sla operator", "committedDate": "2020-04-13T05:37:42Z", "type": "commit"}, {"oid": "863bf67131c258af80eaac49a46250dc77460170", "url": "https://github.com/treasure-data/digdag/commit/863bf67131c258af80eaac49a46250dc77460170", "message": "Add validation for sla operator", "committedDate": "2020-04-13T05:37:42Z", "type": "forcePushed"}]}