{"pr_number": 2283, "pr_title": "Add possibility to register post-discovery filters via SPI", "pr_createdAt": "2020-05-01T11:13:13Z", "pr_url": "https://github.com/junit-team/junit5/pull/2283", "timeline": [{"oid": "cb24d1cf515c9ce6e41ea59cbe6f703918aa9c56", "url": "https://github.com/junit-team/junit5/commit/cb24d1cf515c9ce6e41ea59cbe6f703918aa9c56", "message": "introduce post discovery filters configuration properties", "committedDate": "2020-05-01T10:05:05Z", "type": "commit"}, {"oid": "9623ff6d94296b033cb0e13acb56dc72d21f195f", "url": "https://github.com/junit-team/junit5/commit/9623ff6d94296b033cb0e13acb56dc72d21f195f", "message": "add additional post discovery filters to engine discovery orchestrator", "committedDate": "2020-05-01T11:11:12Z", "type": "commit"}, {"oid": "059975404539eb05b2b0833b64a906171ef356aa", "url": "https://github.com/junit-team/junit5/commit/059975404539eb05b2b0833b64a906171ef356aa", "message": "fix test", "committedDate": "2020-05-01T12:01:24Z", "type": "commit"}, {"oid": "b424bb5abef5b7dcac375dde28f910dcc2d9e790", "url": "https://github.com/junit-team/junit5/commit/b424bb5abef5b7dcac375dde28f910dcc2d9e790", "message": "review fixes", "committedDate": "2020-05-01T12:27:34Z", "type": "commit"}, {"oid": "b424bb5abef5b7dcac375dde28f910dcc2d9e790", "url": "https://github.com/junit-team/junit5/commit/b424bb5abef5b7dcac375dde28f910dcc2d9e790", "message": "review fixes", "committedDate": "2020-05-01T12:27:34Z", "type": "forcePushed"}, {"oid": "32311177f3aabadc91e3d0fd2308708706dad926", "url": "https://github.com/junit-team/junit5/commit/32311177f3aabadc91e3d0fd2308708706dad926", "message": "add new service to module info", "committedDate": "2020-05-01T12:46:39Z", "type": "commit"}, {"oid": "a43108cf915c196e28706b9b0d6ea2b2186cec46", "url": "https://github.com/junit-team/junit5/commit/a43108cf915c196e28706b9b0d6ea2b2186cec46", "message": "add spi tests", "committedDate": "2020-05-01T13:14:04Z", "type": "commit"}, {"oid": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "url": "https://github.com/junit-team/junit5/commit/67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "message": "fix tooling tests", "committedDate": "2020-05-01T13:26:41Z", "type": "commit"}, {"oid": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "url": "https://github.com/junit-team/junit5/commit/67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "message": "fix tooling tests", "committedDate": "2020-05-01T13:26:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2Mzg2OQ==", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418563869", "bodyText": "nit: we don't use final for local variables.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tfinal List<PostDiscoveryFilter> filters = new LinkedList<>(postDiscoveryFilters);\n          \n          \n            \n            \t\tList<PostDiscoveryFilter> filters = new LinkedList<>(postDiscoveryFilters);", "author": "marcphilipp", "createdAt": "2020-05-01T14:25:19Z", "path": "junit-platform-launcher/src/main/java/org/junit/platform/launcher/core/EngineDiscoveryOrchestrator.java", "diffHunk": "@@ -82,7 +86,10 @@ public LauncherDiscoveryResult discover(LauncherDiscoveryRequest request, String\n \t\t\ttestEngineDescriptors.put(testEngine, rootDescriptor);\n \t\t}\n \n-\t\tapplyPostDiscoveryFilters(testEngineDescriptors, request.getPostDiscoveryFilters());\n+\t\tfinal List<PostDiscoveryFilter> filters = new LinkedList<>(postDiscoveryFilters);", "originalCommit": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2NDg5NQ==", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418564895", "bodyText": "\u2753 I'm not sure we should be using a Set here but then again it's consistent with engines above. Thoughts?", "author": "marcphilipp", "createdAt": "2020-05-01T14:27:32Z", "path": "junit-platform-launcher/src/main/java/org/junit/platform/launcher/core/LauncherFactory.java", "diffHunk": "@@ -93,7 +94,13 @@ public static Launcher create(LauncherConfig config) throws PreconditionViolatio\n \t\t}\n \t\tengines.addAll(config.getAdditionalTestEngines());\n \n-\t\tLauncher launcher = new DefaultLauncher(engines);\n+\t\tSet<PostDiscoveryFilter> filters = new LinkedHashSet<>();", "originalCommit": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU3ODgyOA==", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418578828", "bodyText": "Agree. Totally makes no sense to use set, only for consistency reasons.\nBy having a list instead of set we can kinda keep the order of filters. At some point having possibility to control the orders can give users some advantages", "author": "baev", "createdAt": "2020-05-01T14:58:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2NDg5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU5ODc1NQ==", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418598755", "bodyText": "replaced with list for now", "author": "baev", "createdAt": "2020-05-01T15:42:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2NDg5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2NTI1Mw==", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418565253", "bodyText": "Ditto.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tfinal boolean include = object.getTags().stream().map(TestTag::getName).anyMatch(\"test-post-discovery\"::equals);\n          \n          \n            \n            \t\tboolean include = object.getTags().stream().map(TestTag::getName).anyMatch(\"test-post-discovery\"::equals);", "author": "marcphilipp", "createdAt": "2020-05-01T14:28:18Z", "path": "platform-tests/src/test/java/org/junit/platform/launcher/TestPostDiscoveryFilter.java", "diffHunk": "@@ -0,0 +1,23 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junit.platform.launcher;\n+\n+import org.junit.platform.engine.FilterResult;\n+import org.junit.platform.engine.TestDescriptor;\n+import org.junit.platform.engine.TestTag;\n+\n+public class TestPostDiscoveryFilter implements PostDiscoveryFilter {\n+\t@Override\n+\tpublic FilterResult apply(final TestDescriptor object) {\n+\t\tfinal boolean include = object.getTags().stream().map(TestTag::getName).anyMatch(\"test-post-discovery\"::equals);", "originalCommit": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2NjUzMg==", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418566532", "bodyText": "How about TestPostDiscoveryTagFilter?", "author": "marcphilipp", "createdAt": "2020-05-01T14:31:01Z", "path": "platform-tests/src/test/java/org/junit/platform/launcher/TestPostDiscoveryFilter.java", "diffHunk": "@@ -0,0 +1,23 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junit.platform.launcher;\n+\n+import org.junit.platform.engine.FilterResult;\n+import org.junit.platform.engine.TestDescriptor;\n+import org.junit.platform.engine.TestTag;\n+\n+public class TestPostDiscoveryFilter implements PostDiscoveryFilter {", "originalCommit": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "689fcf17021e45f33e4221f03381ff6bef47a6de", "url": "https://github.com/junit-team/junit5/commit/689fcf17021e45f33e4221f03381ff6bef47a6de", "message": "get rid of final modifier\n\nCo-authored-by: Marc Philipp <marc@gradle.com>", "committedDate": "2020-05-01T14:58:55Z", "type": "commit"}, {"oid": "c92a9f9f6338e961de48443a80656fda7cf76483", "url": "https://github.com/junit-team/junit5/commit/c92a9f9f6338e961de48443a80656fda7cf76483", "message": "get rid of final modifier 2\n\nCo-authored-by: Marc Philipp <marc@gradle.com>", "committedDate": "2020-05-01T14:59:23Z", "type": "commit"}, {"oid": "5d2bcf760cc42763191e7569e3d5345acd382ef1", "url": "https://github.com/junit-team/junit5/commit/5d2bcf760cc42763191e7569e3d5345acd382ef1", "message": "review fixes 2", "committedDate": "2020-05-01T15:41:53Z", "type": "commit"}, {"oid": "4a4b3cf93d1f55ed6114793b4682ab2e2a2f9b21", "url": "https://github.com/junit-team/junit5/commit/4a4b3cf93d1f55ed6114793b4682ab2e2a2f9b21", "message": "Document SPI support for PostDiscoveryFilter", "committedDate": "2020-05-31T19:11:02Z", "type": "commit"}, {"oid": "d8ae6d8ee2bab799427a4df6a06a23d2abac1e56", "url": "https://github.com/junit-team/junit5/commit/d8ae6d8ee2bab799427a4df6a06a23d2abac1e56", "message": "Add missing API annotations", "committedDate": "2020-05-31T19:18:15Z", "type": "commit"}, {"oid": "67c2c59f9a1a2918088a247b6be37dd551397a7a", "url": "https://github.com/junit-team/junit5/commit/67c2c59f9a1a2918088a247b6be37dd551397a7a", "message": "Merge branch 'master' into 1997-spi-post-discovery-filter", "committedDate": "2020-05-31T19:19:22Z", "type": "commit"}]}