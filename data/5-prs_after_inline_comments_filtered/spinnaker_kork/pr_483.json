{"pr_number": 483, "pr_title": "fix(plugins): Fixes for SpinnakerPluginInfo, front50 update repository, and other minor issues", "pr_createdAt": "2020-01-21T23:23:11Z", "pr_url": "https://github.com/spinnaker/kork/pull/483", "timeline": [{"oid": "7d0d28383fb8f2663efd77825599132cc176f511", "url": "https://github.com/spinnaker/kork/commit/7d0d28383fb8f2663efd77825599132cc176f511", "message": "fix(plugins): Fixes for reading remote SpinnakerPluginInfo and other minor issues", "committedDate": "2020-01-21T23:44:48Z", "type": "commit"}, {"oid": "7d0d28383fb8f2663efd77825599132cc176f511", "url": "https://github.com/spinnaker/kork/commit/7d0d28383fb8f2663efd77825599132cc176f511", "message": "fix(plugins): Fixes for reading remote SpinnakerPluginInfo and other minor issues", "committedDate": "2020-01-21T23:44:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTMwODI2MA==", "url": "https://github.com/spinnaker/kork/pull/483#discussion_r369308260", "bodyText": "This basically ensures we have a decent configuration process such that if front50.baseUrl is already defined in the config the operator does not need to add the url to spinnaker.extensibility.repositories.front50.url.", "author": "jonsie", "createdAt": "2020-01-21T23:59:47Z", "path": "kork-plugins/src/main/java/com/netflix/spinnaker/config/Front50UpdateRepositoryConfiguration.java", "diffHunk": "@@ -60,6 +61,21 @@ public static UpdateRepository pluginFront50UpdateRepository(\n                         \"Unable to bind ok-http-client property to \"\n                             + OkHttpClientConfigurationProperties.class.getSimpleName()));\n \n+    URL defaultFront50Url =\n+        Binder.get(environment)\n+            .bind(\"front50.base-url\", Bindable.of(URL.class))\n+            .orElseThrow(\n+                () ->\n+                    new BeanCreationException(\n+                        \"Unable to bind front50.base-url property to \"\n+                            + URL.class.getSimpleName()));\n+\n+    PluginRepositoryProperties front50RepositoryProps =\n+        pluginRepositoriesConfig.get(PluginsConfigurationProperties.FRONT5O_REPOSITORY);\n+\n+    URL front50Url =\n+        defaultFront50Url != null ? defaultFront50Url : front50RepositoryProps.getUrl();\n+", "originalCommit": "7d0d28383fb8f2663efd77825599132cc176f511", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f06ba484f75766484b4f28f2d002743b0985ce3e", "url": "https://github.com/spinnaker/kork/commit/f06ba484f75766484b4f28f2d002743b0985ce3e", "message": "fix(plugins): Minor refactor to disable UpdateManager installPlugin and updatePlugin usage", "committedDate": "2020-01-22T19:25:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTc2MDQ3Ng==", "url": "https://github.com/spinnaker/kork/pull/483#discussion_r369760476", "bodyText": "applicationContext.getApplicationName() was returning null.  It didn't seem to be reading spring.application.name, this approach works though.", "author": "jonsie", "createdAt": "2020-01-22T19:32:49Z", "path": "kork-plugins/src/main/java/com/netflix/spinnaker/config/Front50UpdateRepositoryConfiguration.java", "diffHunk": "@@ -73,21 +87,18 @@ public static UpdateRepository pluginFront50UpdateRepository(\n             .configure(SerializationFeature.INDENT_OUTPUT, true)\n             .setSerializationInclusion(JsonInclude.Include.NON_NULL);\n \n-    PluginRepositoryProperties front50RepositoryProps =\n-        pluginRepositoriesConfig.get(PluginsConfigurationProperties.FRONT5O_REPOSITORY);\n-\n     Front50Service front50Service =\n         new Retrofit.Builder()\n             .addConverterFactory(JacksonConverterFactory.create(objectMapper))\n-            .baseUrl(front50RepositoryProps.getUrl())\n+            .baseUrl(front50Url)\n             .client(okHttpClient)\n             .build()\n             .create(Front50Service.class);\n \n     return new Front50UpdateRepository(\n         PluginsConfigurationProperties.FRONT5O_REPOSITORY,\n-        applicationContext.getApplicationName(),\n-        front50RepositoryProps.getUrl(),\n+        Objects.requireNonNull(environment.getProperty(\"spring.application.name\")),", "originalCommit": "f06ba484f75766484b4f28f2d002743b0985ce3e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "76c9f22e37688a2c3708ffc4e644bf83b58ea62b", "url": "https://github.com/spinnaker/kork/commit/76c9f22e37688a2c3708ffc4e644bf83b58ea62b", "message": "fix(plugins): Update PluginUpdateServiceTest and remove obsolete comment", "committedDate": "2020-01-22T20:57:45Z", "type": "commit"}, {"oid": "51435c76dfe43f4ab57fb2a22ed3936a1c75e33c", "url": "https://github.com/spinnaker/kork/commit/51435c76dfe43f4ab57fb2a22ed3936a1c75e33c", "message": "fix(plugins): spotless", "committedDate": "2020-01-22T21:04:24Z", "type": "commit"}, {"oid": "15c949f16d20d563a65c72c05dd6a5d8c542ba19", "url": "https://github.com/spinnaker/kork/commit/15c949f16d20d563a65c72c05dd6a5d8c542ba19", "message": "fix(plugins): spotless prt 2", "committedDate": "2020-01-22T21:09:26Z", "type": "commit"}, {"oid": "8d49577575ad85e589d7d7215e5fff8c9df3c4ee", "url": "https://github.com/spinnaker/kork/commit/8d49577575ad85e589d7d7215e5fff8c9df3c4ee", "message": "Merge branch 'master' into misc-kork-front50", "committedDate": "2020-01-22T21:23:25Z", "type": "commit"}]}