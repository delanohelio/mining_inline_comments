{"pr_number": 1728, "pr_title": "LocalOnly sharding strategy for dyno queues", "pr_createdAt": "2020-06-05T08:59:14Z", "pr_url": "https://github.com/Netflix/conductor/pull/1728", "timeline": [{"oid": "a40b042cecec528909497dbd2e2e64b1486039df", "url": "https://github.com/Netflix/conductor/commit/a40b042cecec528909497dbd2e2e64b1486039df", "message": "Introduce LocalOnly locking provider\n\nThis implementation provides sufficient locking for a single\nnode deployment.\n\nImplemented inside JVM only (locks are not persisted).\n\nCan be used in a cluster deployment but only when localOnly sharding\nstrategy is used for dyno queues.\n\nSigned-off-by: Maros Marsalek <mmarsalek@frinx.io>", "committedDate": "2020-06-09T12:54:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDUyNDU5OA==", "url": "https://github.com/Netflix/conductor/pull/1728#discussion_r440524598", "bodyText": "Nit: Please use the latest copyright.", "author": "kishorebanala", "createdAt": "2020-06-16T00:50:53Z", "path": "core/src/main/java/com/netflix/conductor/core/utils/LocalOnlyLock.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Copyright (c) 2019 Netflix, Inc.", "originalCommit": "a40b042cecec528909497dbd2e2e64b1486039df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDcwMzQ3OQ==", "url": "https://github.com/Netflix/conductor/pull/1728#discussion_r440703479", "bodyText": "Used the latest 2020 copyright header I found", "author": "marosmars", "createdAt": "2020-06-16T09:10:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDUyNDU5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDUzMDk4Mw==", "url": "https://github.com/Netflix/conductor/pull/1728#discussion_r440530983", "bodyText": "Unused imports?", "author": "kishorebanala", "createdAt": "2020-06-16T01:14:41Z", "path": "redis-persistence/src/main/java/com/netflix/conductor/dao/dynomite/queue/DynoQueueDAO.java", "diffHunk": "@@ -24,6 +24,8 @@\n import com.netflix.dyno.queues.ShardSupplier;\n import com.netflix.dyno.queues.redis.RedisDynoQueue;\n import com.netflix.dyno.queues.redis.RedisQueues;\n+import com.netflix.dyno.queues.redis.sharding.RoundRobinStrategy;", "originalCommit": "a40b042cecec528909497dbd2e2e64b1486039df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDcwMzUwNg==", "url": "https://github.com/Netflix/conductor/pull/1728#discussion_r440703506", "bodyText": "Done", "author": "marosmars", "createdAt": "2020-06-16T09:10:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDUzMDk4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDUzMjE4NQ==", "url": "https://github.com/Netflix/conductor/pull/1728#discussion_r440532185", "bodyText": "Nit: Please use the latest copyright.", "author": "kishorebanala", "createdAt": "2020-06-16T01:19:15Z", "path": "redis-persistence/src/main/java/com/netflix/conductor/dyno/RedisQueuesShardingStrategyProvider.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/*\n+ * Copyright 2016 Netflix, Inc.", "originalCommit": "a40b042cecec528909497dbd2e2e64b1486039df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDcwMzUzMg==", "url": "https://github.com/Netflix/conductor/pull/1728#discussion_r440703532", "bodyText": "Used the latest 2020 copyright header I found", "author": "marosmars", "createdAt": "2020-06-16T09:10:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDUzMjE4NQ=="}], "type": "inlineReview"}, {"oid": "71f86fef47cdab180ea5ec8d96df496a569dea81", "url": "https://github.com/Netflix/conductor/commit/71f86fef47cdab180ea5ec8d96df496a569dea81", "message": "LocalOnly sharding strategy for dyno queues\n\nAllow no distribution of workload in dyno queues.\nBy default tasks are distributed across all conductor instances using\ndyno queue shards.\nNow it is possible to only queue workfload for conductor-server that\nstarted the workflow.\n\nMore in docs.", "committedDate": "2020-06-16T08:46:17Z", "type": "commit"}, {"oid": "1b184888dac090d40963eb1d7332c897c79b1403", "url": "https://github.com/Netflix/conductor/commit/1b184888dac090d40963eb1d7332c897c79b1403", "message": "Add unit test for sharding strategy provider\n\nSigned-off-by: Maros Marsalek <mmarsalek@frinx.io>", "committedDate": "2020-06-16T08:46:17Z", "type": "commit"}, {"oid": "e93ef8a1a2d84d793eb92593376511049bed5dcf", "url": "https://github.com/Netflix/conductor/commit/e93ef8a1a2d84d793eb92593376511049bed5dcf", "message": "Introduce LocalOnly locking provider\n\nThis implementation provides sufficient locking for a single\nnode deployment.\n\nImplemented inside JVM only (locks are not persisted).\n\nCan be used in a cluster deployment but only when localOnly sharding\nstrategy is used for dyno queues.\n\nSigned-off-by: Maros Marsalek <mmarsalek@frinx.io>", "committedDate": "2020-06-16T08:46:17Z", "type": "commit"}, {"oid": "2308ba92dc5b7a979353ae94c5395df72c7fb98f", "url": "https://github.com/Netflix/conductor/commit/2308ba92dc5b7a979353ae94c5395df72c7fb98f", "message": "Fix headers and unused imports for localOnly sharding\n\nSigned-off-by: Maros Marsalek <mmarsalek@frinx.io>", "committedDate": "2020-06-16T09:03:07Z", "type": "commit"}, {"oid": "2308ba92dc5b7a979353ae94c5395df72c7fb98f", "url": "https://github.com/Netflix/conductor/commit/2308ba92dc5b7a979353ae94c5395df72c7fb98f", "message": "Fix headers and unused imports for localOnly sharding\n\nSigned-off-by: Maros Marsalek <mmarsalek@frinx.io>", "committedDate": "2020-06-16T09:03:07Z", "type": "forcePushed"}]}