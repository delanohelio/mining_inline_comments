{"pr_number": 237, "pr_title": "Fix the issue introduced when trim whitespace started clobbering newlines between elements.", "pr_createdAt": "2020-03-26T06:19:22Z", "pr_url": "https://github.com/linkedin/rest.li/pull/237", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM0NDE3Mw==", "url": "https://github.com/linkedin/rest.li/pull/237#discussion_r398344173", "bodyText": "should we make this optional to run? or we run this default whenever we make a change to the format if this is the case are you planning to remove it later?", "author": "aman1309", "createdAt": "2020-03-26T06:35:09Z", "path": "gradle-plugins/src/main/java/com/linkedin/pegasus/gradle/PegasusPlugin.java", "diffHunk": "@@ -1446,6 +1446,21 @@ protected void configureConversionUtilities(Project project, SourceSet sourceSet\n         project.getLogger().lifecycle(\"You can use '-PconvertToPdl.reverse=true|false' to change the direction of conversion.\");\n       }));\n     });\n+\n+    project.getTasks().create(sourceSet.getTaskName(\"reformat\", \"Pdl\"), TranslateSchemasTask.class, task ->", "originalCommit": "4e8061ab720c910b41408bf05d52c039f7c0d1a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM0NTkwNA==", "url": "https://github.com/linkedin/rest.li/pull/237#discussion_r398345904", "bodyText": "This task is already optional, it is not linked to any build task.\nIt can be run by running ligradle reformatPdl, we don't have to remove it later. One way this can be used is to auto format PDL files. MP owners can use this to keep the formatting consistent.", "author": "karthikbalasub", "createdAt": "2020-03-26T06:40:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM0NDE3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM0NjgwMA==", "url": "https://github.com/linkedin/rest.li/pull/237#discussion_r398346800", "bodyText": "I am sorry that my last suggestion introduced an error. I misunderstood \"MULTILINE\" mode. This mode actually match \"$\" to \"any arbitrary\" line's ending. (not current or each line)\nUnder MULTILINE mode, the correct regular expression should be \\s+?$ so that '\\s' is not greedily matching consecutive empty line.\nsee example: https://regex101.com/r/TfmGhW/1", "author": "junchuanwang", "createdAt": "2020-03-26T06:43:40Z", "path": "restli-tools/src/main/java/com/linkedin/restli/tools/data/SchemaFormatTranslator.java", "diffHunk": "@@ -60,7 +60,7 @@\n {\n   private static final Logger LOGGER = LoggerFactory.getLogger(SchemaFormatTranslator.class);\n \n-  private static final Pattern LINE_END_SPACES = Pattern.compile(\"\\\\s+$\", Pattern.MULTILINE);\n+  private static final Pattern LINE_END_SPACES = Pattern.compile(\" +$\", Pattern.MULTILINE);", "originalCommit": "4e8061ab720c910b41408bf05d52c039f7c0d1a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM1MDc0Mg==", "url": "https://github.com/linkedin/rest.li/pull/237#discussion_r398350742", "bodyText": "Junchuan, np, and thanks for digging into the issue.\nIn this case, I prefer to keep it simple and not change it. Since we are generating the PDL output, we control the whitespaces that needs trimming. And since we use only spaces, this is good.", "author": "karthikbalasub", "createdAt": "2020-03-26T06:55:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM0NjgwMA=="}], "type": "inlineReview"}, {"oid": "cfaabdd1f2a37bb46c8287f4a9758eaa38abe932", "url": "https://github.com/linkedin/rest.li/commit/cfaabdd1f2a37bb46c8287f4a9758eaa38abe932", "message": "Fix the issue introduced when trim whitespace started clobbering newlines between elements.\nAlso adds a gradle task for re-formatting PDL, so MP owners can get improvements we make to PDL formatting.", "committedDate": "2020-03-26T19:04:52Z", "type": "commit"}, {"oid": "e52035a47f2471e8022bb4ce43794a779abd3e4e", "url": "https://github.com/linkedin/rest.li/commit/e52035a47f2471e8022bb4ce43794a779abd3e4e", "message": "Release 28.1.36", "committedDate": "2020-03-26T19:05:15Z", "type": "commit"}, {"oid": "e52035a47f2471e8022bb4ce43794a779abd3e4e", "url": "https://github.com/linkedin/rest.li/commit/e52035a47f2471e8022bb4ce43794a779abd3e4e", "message": "Release 28.1.36", "committedDate": "2020-03-26T19:05:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg5ODc1MQ==", "url": "https://github.com/linkedin/rest.li/pull/237#discussion_r398898751", "bodyText": "Maybe add a comment here explaining the purpose of this task, similar to the comment corresponding to the above task. Other than that, LGTM", "author": "evanw555", "createdAt": "2020-03-26T21:18:15Z", "path": "gradle-plugins/src/main/java/com/linkedin/pegasus/gradle/PegasusPlugin.java", "diffHunk": "@@ -1446,6 +1446,21 @@ protected void configureConversionUtilities(Project project, SourceSet sourceSet\n         project.getLogger().lifecycle(\"You can use '-PconvertToPdl.reverse=true|false' to change the direction of conversion.\");\n       }));\n     });\n+", "originalCommit": "e52035a47f2471e8022bb4ce43794a779abd3e4e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d6bd5de12b440ca9eb6d32800bd1bc7b1451ebc5", "url": "https://github.com/linkedin/rest.li/commit/d6bd5de12b440ca9eb6d32800bd1bc7b1451ebc5", "message": "Address review comments", "committedDate": "2020-03-26T21:52:54Z", "type": "commit"}, {"oid": "b449ad1a1d0d63b5c378cc8803149d88e6b1944f", "url": "https://github.com/linkedin/rest.li/commit/b449ad1a1d0d63b5c378cc8803149d88e6b1944f", "message": "Merge branch 'master' into feature/pdl_format", "committedDate": "2020-03-30T03:28:15Z", "type": "commit"}]}