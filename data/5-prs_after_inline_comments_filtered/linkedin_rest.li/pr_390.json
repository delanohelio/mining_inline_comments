{"pr_number": 390, "pr_title": "Enable DataSchemaParser to take extension schema resolver from the Jar", "pr_createdAt": "2020-08-20T06:29:18Z", "pr_url": "https://github.com/linkedin/rest.li/pull/390", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEzODU4OA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474138588", "bodyText": "nit: the brace should be in next line", "author": "nickibi", "createdAt": "2020-08-20T16:58:42Z", "path": "generator/src/main/java/com/linkedin/pegasus/generator/DataSchemaParser.java", "diffHunk": "@@ -191,6 +209,19 @@ private static ParseResult combine(Collection<ParseResult> parseResults)\n       return _schemaAndLocations;\n     }\n \n+    public Map<DataSchema, DataSchemaLocation> getExtensionDataSchemaAndLocations()\n+    {\n+      return _schemaAndLocations.entrySet().stream().filter(entry -> {", "originalCommit": "4ff61c9e600635357283ce52cf8f9b7d51e82e87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIxMDE1Nw==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474210157", "bodyText": "ok", "author": "BrianPin", "createdAt": "2020-08-20T19:10:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEzODU4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3MzU1OA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474173558", "bodyText": "Shall we use MultiFormatDataSchemaResolver type here", "author": "nickibi", "createdAt": "2020-08-20T18:02:20Z", "path": "generator/src/main/java/com/linkedin/pegasus/generator/DataSchemaParser.java", "diffHunk": "@@ -47,31 +50,46 @@\n {\n   private final String _resolverPath;\n   private final Map<String, FileFormatDataSchemaParser> _parserByFileExtension;\n-  private final MultiFormatDataSchemaResolver _resolver;\n+  private final AbstractMultiFormatDataSchemaResolver _resolver;\n \n   /**\n    * @param resolverPath provides the search paths separated by the system file separator, or null for no search paths.\n    */\n-  public DataSchemaParser(String resolverPath) {\n-    this(resolverPath, MultiFormatDataSchemaResolver.BUILTIN_FORMAT_PARSER_FACTORIES);\n+  public DataSchemaParser(String resolverPath)\n+  {\n+    this(resolverPath, AbstractMultiFormatDataSchemaResolver.BUILTIN_FORMAT_PARSER_FACTORIES);\n   }\n \n   public DataSchemaParser(\n       String resolverPath,\n       List<DataSchemaParserFactory> parserFactoriesForFromats)\n   {\n+    _parserByFileExtension = new HashMap<>();\n     _resolverPath = resolverPath;\n-\n-    MultiFormatDataSchemaResolver resolver =\n+    AbstractMultiFormatDataSchemaResolver resolver =", "originalCommit": "4ff61c9e600635357283ce52cf8f9b7d51e82e87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM1MzQ4MA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474353480", "bodyText": "yeah", "author": "BrianPin", "createdAt": "2020-08-21T01:12:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3MzU1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3NTMxNg==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474175316", "bodyText": "First of all, it is \"extensions\". Second of all, can we make it as constant? or just use SchemaDirectoryName.EXTENSIONS.getName().", "author": "nickibi", "createdAt": "2020-08-20T18:05:39Z", "path": "generator/src/main/java/com/linkedin/pegasus/generator/DataSchemaParser.java", "diffHunk": "@@ -191,6 +209,19 @@ private static ParseResult combine(Collection<ParseResult> parseResults)\n       return _schemaAndLocations;\n     }\n \n+    public Map<DataSchema, DataSchemaLocation> getExtensionDataSchemaAndLocations()\n+    {\n+      return _schemaAndLocations.entrySet().stream().filter(entry -> {\n+        DataSchemaLocation dataSchemaLocation = entry.getValue();\n+        if (dataSchemaLocation instanceof InJarFileDataSchemaLocation)\n+        {\n+          InJarFileDataSchemaLocation inJarFileDataSchemaLocation = (InJarFileDataSchemaLocation) dataSchemaLocation;\n+          return inJarFileDataSchemaLocation.getPathInJar().startsWith(\"extension\");", "originalCommit": "4ff61c9e600635357283ce52cf8f9b7d51e82e87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM1NDYzOA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474354638", "bodyText": "good suggestion", "author": "BrianPin", "createdAt": "2020-08-21T01:16:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3NTMxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3ODk5MA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474178990", "bodyText": "nit: private methods should be after public methods, also it might be useful to add a java doc to explain the logic here.", "author": "nickibi", "createdAt": "2020-08-20T18:12:29Z", "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -60,6 +62,15 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n     _schemaParserFactory = schemaParserFactory;\n   }\n \n+  private boolean isExtensionEntry(JarEntry entry)", "originalCommit": "4ff61c9e600635357283ce52cf8f9b7d51e82e87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM1NTkyNw==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474355927", "bodyText": "moved", "author": "BrianPin", "createdAt": "2020-08-21T01:21:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3ODk5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3OTczNA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474179734", "bodyText": "nit: move private method to the bottom.", "author": "nickibi", "createdAt": "2020-08-20T18:13:57Z", "path": "generator/src/main/java/com/linkedin/pegasus/generator/DataSchemaParser.java", "diffHunk": "@@ -47,31 +50,46 @@\n {\n   private final String _resolverPath;\n   private final Map<String, FileFormatDataSchemaParser> _parserByFileExtension;\n-  private final MultiFormatDataSchemaResolver _resolver;\n+  private final AbstractMultiFormatDataSchemaResolver _resolver;\n \n   /**\n    * @param resolverPath provides the search paths separated by the system file separator, or null for no search paths.\n    */\n-  public DataSchemaParser(String resolverPath) {\n-    this(resolverPath, MultiFormatDataSchemaResolver.BUILTIN_FORMAT_PARSER_FACTORIES);\n+  public DataSchemaParser(String resolverPath)\n+  {\n+    this(resolverPath, AbstractMultiFormatDataSchemaResolver.BUILTIN_FORMAT_PARSER_FACTORIES);\n   }\n \n   public DataSchemaParser(\n       String resolverPath,\n       List<DataSchemaParserFactory> parserFactoriesForFromats)\n   {\n+    _parserByFileExtension = new HashMap<>();\n     _resolverPath = resolverPath;\n-\n-    MultiFormatDataSchemaResolver resolver =\n+    AbstractMultiFormatDataSchemaResolver resolver =\n       new MultiFormatDataSchemaResolver(resolverPath, parserFactoriesForFromats);\n+    this._resolver = resolver;\n+    init(resolver, resolverPath, parserFactoriesForFromats);\n+  }\n+\n+  public DataSchemaParser(String resolverPath, AbstractMultiFormatDataSchemaResolver resolver)\n+  {\n     _parserByFileExtension = new HashMap<>();\n+    _resolverPath = resolverPath;\n+    this._resolver = resolver;\n+    init(resolver, resolverPath, MultiFormatDataSchemaResolver.BUILTIN_FORMAT_PARSER_FACTORIES);\n+  }\n+\n+  private void init(AbstractMultiFormatDataSchemaResolver resolver,", "originalCommit": "4ff61c9e600635357283ce52cf8f9b7d51e82e87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM1NDQzMw==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474354433", "bodyText": "moved", "author": "BrianPin", "createdAt": "2020-08-21T01:15:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3OTczNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3OTk4Nw==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474179987", "bodyText": "Add java doc for this constructor.", "author": "nickibi", "createdAt": "2020-08-20T18:14:22Z", "path": "generator/src/main/java/com/linkedin/pegasus/generator/DataSchemaParser.java", "diffHunk": "@@ -47,31 +50,46 @@\n {\n   private final String _resolverPath;\n   private final Map<String, FileFormatDataSchemaParser> _parserByFileExtension;\n-  private final MultiFormatDataSchemaResolver _resolver;\n+  private final AbstractMultiFormatDataSchemaResolver _resolver;\n \n   /**\n    * @param resolverPath provides the search paths separated by the system file separator, or null for no search paths.\n    */\n-  public DataSchemaParser(String resolverPath) {\n-    this(resolverPath, MultiFormatDataSchemaResolver.BUILTIN_FORMAT_PARSER_FACTORIES);\n+  public DataSchemaParser(String resolverPath)\n+  {\n+    this(resolverPath, AbstractMultiFormatDataSchemaResolver.BUILTIN_FORMAT_PARSER_FACTORIES);\n   }\n \n   public DataSchemaParser(\n       String resolverPath,\n       List<DataSchemaParserFactory> parserFactoriesForFromats)\n   {\n+    _parserByFileExtension = new HashMap<>();\n     _resolverPath = resolverPath;\n-\n-    MultiFormatDataSchemaResolver resolver =\n+    AbstractMultiFormatDataSchemaResolver resolver =\n       new MultiFormatDataSchemaResolver(resolverPath, parserFactoriesForFromats);\n+    this._resolver = resolver;\n+    init(resolver, resolverPath, parserFactoriesForFromats);\n+  }\n+\n+  public DataSchemaParser(String resolverPath, AbstractMultiFormatDataSchemaResolver resolver)", "originalCommit": "4ff61c9e600635357283ce52cf8f9b7d51e82e87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM1NDQwMg==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474354402", "bodyText": "added", "author": "BrianPin", "createdAt": "2020-08-21T01:15:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3OTk4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4MjIyMQ==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474182221", "bodyText": "Do you think we should also add another test case, a schema under a third path: like \"legacyPegasusSchema\". The schema under that directory will not be resolved.", "author": "nickibi", "createdAt": "2020-08-20T18:18:38Z", "path": "generator/src/test/java/com/linkedin/pegasus/generator/TestDataSchemaParser.java", "diffHunk": "@@ -92,6 +102,57 @@ public void testParseFromJarFile(String pegasusFilename, String[] expectedSchema\n     parseResult.getSchemaAndLocations().values().forEach(loc -> assertEquals(loc.getSourceFile().getAbsolutePath(), jarFile));\n   }\n \n+  @DataProvider(name = \"entityRelationshipInputFiles\")\n+  private Object[][] createResolverWithExtensionDirs()\n+  {\n+    return new Object[][]\n+        {\n+            {\n+                new String[]{\n+                    \"extensions/Bar.pdl\",\n+                    \"extensions/FooExtension.pdl\",\n+                    \"pegasus/Foo.pdl\"", "originalCommit": "4ff61c9e600635357283ce52cf8f9b7d51e82e87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIxMDU2MA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474210560", "bodyText": "sure", "author": "BrianPin", "createdAt": "2020-08-20T19:11:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4MjIyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4Njc5MQ==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474186791", "bodyText": "shall we make the file path as camelcase? Also update the test files path.", "author": "nickibi", "createdAt": "2020-08-20T18:26:52Z", "path": "generator/src/test/java/com/linkedin/pegasus/generator/TestDataSchemaParser.java", "diffHunk": "@@ -92,6 +102,57 @@ public void testParseFromJarFile(String pegasusFilename, String[] expectedSchema\n     parseResult.getSchemaAndLocations().values().forEach(loc -> assertEquals(loc.getSourceFile().getAbsolutePath(), jarFile));\n   }\n \n+  @DataProvider(name = \"entityRelationshipInputFiles\")\n+  private Object[][] createResolverWithExtensionDirs()\n+  {\n+    return new Object[][]\n+        {\n+            {\n+                new String[]{\n+                    \"extensions/Bar.pdl\",\n+                    \"extensions/FooExtension.pdl\",\n+                    \"pegasus/Foo.pdl\"\n+                },\n+                new String[]{\n+                    \"FooExtension\",\n+                    \"Bar\"\n+                }\n+            },\n+        };\n+  }\n+\n+  @Test(dataProvider = \"entityRelationshipInputFiles\")\n+  public void testSchemaFilesInExtensionPath(String[] files, String[] expectedExtensions) throws Exception\n+  {\n+    String tempDirectoryPath = _tempDir.getAbsolutePath();\n+    String jarFile = tempDirectoryPath + FS + \"test.jar\";\n+    String schemaDir = pegasusDir + FS + \"entity-relationship\";", "originalCommit": "4ff61c9e600635357283ce52cf8f9b7d51e82e87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM4ODEwMg==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474388102", "bodyText": "done", "author": "BrianPin", "createdAt": "2020-08-21T03:28:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4Njc5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE5NDc5Mw==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474194793", "bodyText": "use DataSchemaResolver::getSchemasDirectoryName == EXtensions", "author": "aman1309", "createdAt": "2020-08-20T18:41:11Z", "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -60,6 +62,15 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n     _schemaParserFactory = schemaParserFactory;\n   }\n \n+  private boolean isExtensionEntry(JarEntry entry)\n+  {\n+    if (_schemaResolver instanceof ExtensionsDataSchemaResolver)", "originalCommit": "4ff61c9e600635357283ce52cf8f9b7d51e82e87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDM1NjA2NQ==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474356065", "bodyText": "ok", "author": "BrianPin", "createdAt": "2020-08-21T01:22:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE5NDc5Mw=="}], "type": "inlineReview"}, {"oid": "76524f949a1fbbccae74950f74d094d47d1d9d76", "url": "https://github.com/linkedin/rest.li/commit/76524f949a1fbbccae74950f74d094d47d1d9d76", "message": "Initial commit for DataSchemaParser change", "committedDate": "2020-08-21T01:07:53Z", "type": "commit"}, {"oid": "316dda1ec5cfd20d1cb5356e1a10e85f2cc410f4", "url": "https://github.com/linkedin/rest.li/commit/316dda1ec5cfd20d1cb5356e1a10e85f2cc410f4", "message": "Address review comments", "committedDate": "2020-08-21T03:29:57Z", "type": "commit"}, {"oid": "316dda1ec5cfd20d1cb5356e1a10e85f2cc410f4", "url": "https://github.com/linkedin/rest.li/commit/316dda1ec5cfd20d1cb5356e1a10e85f2cc410f4", "message": "Address review comments", "committedDate": "2020-08-21T03:29:57Z", "type": "forcePushed"}, {"oid": "1cf77034c815e26fe79865275a9f7e2403a323e6", "url": "https://github.com/linkedin/rest.li/commit/1cf77034c815e26fe79865275a9f7e2403a323e6", "message": "Address comment about cases", "committedDate": "2020-08-21T04:03:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY0ODIzOA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474648238", "bodyText": "What about FileDataSchemaLocation?", "author": "karthikbalasub", "createdAt": "2020-08-21T11:50:17Z", "path": "generator/src/main/java/com/linkedin/pegasus/generator/DataSchemaParser.java", "diffHunk": "@@ -191,6 +218,20 @@ private static ParseResult combine(Collection<ParseResult> parseResults)\n       return _schemaAndLocations;\n     }\n \n+    public Map<DataSchema, DataSchemaLocation> getExtensionDataSchemaAndLocations()\n+    {\n+      return _schemaAndLocations.entrySet().stream().filter(entry ->\n+      {\n+        DataSchemaLocation dataSchemaLocation = entry.getValue();\n+        if (dataSchemaLocation instanceof InJarFileDataSchemaLocation)", "originalCommit": "1cf77034c815e26fe79865275a9f7e2403a323e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg2ODczMQ==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474868731", "bodyText": "Schemas coming from the jar have entry start with extensions, schemas not coming from the jar do not have this feature to identify which schema is an extension.\nif the application for extension is applied to normal file system dir, then I will need to do some change to make it work, but from our design do we have that use case where extensions coming from normal folders?", "author": "BrianPin", "createdAt": "2020-08-21T18:49:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY0ODIzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDkzMjY2Mg==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474932662", "bodyText": "I think it is reasonable to expect extensions schemas in a local directory being loaded as we allow local dirs in the resolver path.\nAlso as a feature, it makes sense to have a consistent behavior across all types of locations.", "author": "karthikbalasub", "createdAt": "2020-08-21T20:18:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY0ODIzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAxMDU4MA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r475010580", "bodyText": "I add the case by using a heuristic rule, the file has to end with \"Extension.pdl\" and the path should contain \"extensions\" in the dir path", "author": "BrianPin", "createdAt": "2020-08-21T23:34:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY0ODIzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY1MDUyNw==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474650527", "bodyText": "Can we remove the SCHEMA_PATH_PREFIX check and just use the path configured in resolver?", "author": "karthikbalasub", "createdAt": "2020-08-21T11:55:40Z", "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -91,7 +93,7 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               {\n                 final JarEntry entry = entries.nextElement();\n                 if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    entry.getName().startsWith(SCHEMA_PATH_PREFIX))\n+                    (entry.getName().startsWith(SCHEMA_PATH_PREFIX) || isExtensionEntry(entry)))", "originalCommit": "1cf77034c815e26fe79865275a9f7e2403a323e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAxMTk3OA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r475011978", "bodyText": "done", "author": "BrianPin", "createdAt": "2020-08-21T23:40:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY1MDUyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY1MTI4Ng==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474651286", "bodyText": "Also add a test that parses files from directory.\nWhen we are running the build on a module that contains the PDL files, they are loaded as files directly, not through jars.", "author": "karthikbalasub", "createdAt": "2020-08-21T11:57:35Z", "path": "generator/src/test/java/com/linkedin/pegasus/generator/TestDataSchemaParser.java", "diffHunk": "@@ -92,6 +97,71 @@ public void testParseFromJarFile(String pegasusFilename, String[] expectedSchema\n     parseResult.getSchemaAndLocations().values().forEach(loc -> assertEquals(loc.getSourceFile().getAbsolutePath(), jarFile));\n   }\n \n+  @DataProvider(name = \"entityRelationshipInputFiles\")\n+  private Object[][] createResolverWithExtensionDirs()\n+  {\n+    return new Object[][]\n+        {\n+            {\n+                new String[]{\n+                    \"extensions/BarExtension.pdl\",\n+                    \"extensions/FooExtension.pdl\",\n+                    \"pegasus/Foo.pdl\",\n+                    \"pegasus/Bar.pdl\"\n+                },\n+                new String[]{\n+                    \"FooExtension\",\n+                    \"BarExtension\"\n+                }\n+            },\n+            {\n+                new String[]{\n+                    \"extensions/BarExtension.pdl\",\n+                    \"extensions/FooExtension.pdl\",\n+                    \"pegasus/Bar.pdl\",\n+                    \"pegasus/Foo.pdl\",\n+                    \"others/FooBar.pdl\"\n+                },\n+                new String[]{\n+                    \"FooExtension\",\n+                    \"BarExtension\"\n+                }\n+            },\n+        };\n+  }\n+\n+  @Test(dataProvider = \"entityRelationshipInputFiles\")\n+  public void testSchemaFilesInExtensionPath(String[] files, String[] expectedExtensions) throws Exception", "originalCommit": "1cf77034c815e26fe79865275a9f7e2403a323e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg2NzQwNA==", "url": "https://github.com/linkedin/rest.li/pull/390#discussion_r474867404", "bodyText": "yea, will add it", "author": "BrianPin", "createdAt": "2020-08-21T18:46:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY1MTI4Ng=="}], "type": "inlineReview"}, {"oid": "ba5d0baa66df5d2c8d3e51699e30ad20906da405", "url": "https://github.com/linkedin/rest.li/commit/ba5d0baa66df5d2c8d3e51699e30ad20906da405", "message": "Address comment for file base extension schema", "committedDate": "2020-08-21T23:40:38Z", "type": "commit"}, {"oid": "ba5d0baa66df5d2c8d3e51699e30ad20906da405", "url": "https://github.com/linkedin/rest.li/commit/ba5d0baa66df5d2c8d3e51699e30ad20906da405", "message": "Address comment for file base extension schema", "committedDate": "2020-08-21T23:40:38Z", "type": "forcePushed"}, {"oid": "d07b3fda0bd33c65bc31ddc1f87c6f134d39af30", "url": "https://github.com/linkedin/rest.li/commit/d07b3fda0bd33c65bc31ddc1f87c6f134d39af30", "message": "update change log", "committedDate": "2020-08-22T00:31:28Z", "type": "commit"}, {"oid": "b9b25ca69a146cbab5ebe2a6155bf8970e2d8a2f", "url": "https://github.com/linkedin/rest.li/commit/b9b25ca69a146cbab5ebe2a6155bf8970e2d8a2f", "message": "Fix hardcoded test path", "committedDate": "2020-08-22T00:36:09Z", "type": "commit"}]}