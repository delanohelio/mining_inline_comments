{"pr_number": 2546, "pr_title": "GH-2538 Standalone Model API", "pr_createdAt": "2020-09-28T12:17:19Z", "pr_url": "https://github.com/eclipse/rdf4j/pull/2546", "timeline": [{"oid": "70d0ceebcd40649840b1e68a31eb7ad742473410", "url": "https://github.com/eclipse/rdf4j/commit/70d0ceebcd40649840b1e68a31eb7ad742473410", "message": "GH-2538 Create model-api module\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T07:02:23Z", "type": "commit"}, {"oid": "c450acb237598c7efaf7a07c0fb71351e52e9d0b", "url": "https://github.com/eclipse/rdf4j/commit/c450acb237598c7efaf7a07c0fb71351e52e9d0b", "message": "GH-2538 Remove references to `model` classes from `org.eclipse.rdf4.model` javadocs\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T07:04:43Z", "type": "commit"}, {"oid": "175b9f32859cc1c49db588ab13ecbf41cba3c965", "url": "https://github.com/eclipse/rdf4j/commit/175b9f32859cc1c49db588ab13ecbf41cba3c965", "message": "GH-2538 Migrate org.eclipse.rdf4.model tests to .model.impl\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T07:31:01Z", "type": "commit"}, {"oid": "a70ce96a80bb7a57dd5b6f1e55ece792fa235062", "url": "https://github.com/eclipse/rdf4j/commit/a70ce96a80bb7a57dd5b6f1e55ece792fa235062", "message": "GH-2538 Fix typos in javadocs\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T08:28:36Z", "type": "commit"}, {"oid": "9bddd2e0c9858d84b23d65e21d9fe4b052f0363a", "url": "https://github.com/eclipse/rdf4j/commit/9bddd2e0c9858d84b23d65e21d9fe4b052f0363a", "message": "GH-2538 Add default implementation for Namespace.compareTo()\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T08:32:25Z", "type": "commit"}, {"oid": "2e2ab2ec40fe1f7a130ccad359a2f165451e43b5", "url": "https://github.com/eclipse/rdf4j/commit/2e2ab2ec40fe1f7a130ccad359a2f165451e43b5", "message": "GH-2538 Remove Model dependency from SimpleNamespace\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T08:38:53Z", "type": "commit"}, {"oid": "9b5f0794a99af9d9d695b0072180a723f9eaa83c", "url": "https://github.com/eclipse/rdf4j/commit/9b5f0794a99af9d9d695b0072180a723f9eaa83c", "message": "GH-2538 Migrate org.eclipse.rdf4j.common.annotation package to model-api module\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T08:50:16Z", "type": "commit"}, {"oid": "e1257c21051409bc47e937a484cc7be333055e5b", "url": "https://github.com/eclipse/rdf4j/commit/e1257c21051409bc47e937a484cc7be333055e5b", "message": "GH-2538 Remove references to `model` classes from `org.eclipse.rdf4.model` javadocs\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T08:55:56Z", "type": "commit"}, {"oid": "be498dc9a5e210b6eba445e30cb2b6773b79ee65", "url": "https://github.com/eclipse/rdf4j/commit/be498dc9a5e210b6eba445e30cb2b6773b79ee65", "message": "GH-2538 Migrate org.eclipse.rdf4j.model package to rdf4j-model-api module\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T09:02:05Z", "type": "commit"}, {"oid": "0cb9984b39d0ad1fff11e94c136e65c0f92fbd46", "url": "https://github.com/eclipse/rdf4j/commit/0cb9984b39d0ad1fff11e94c136e65c0f92fbd46", "message": "GH-2538 Remove leftover imports\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T10:39:21Z", "type": "commit"}, {"oid": "69b062b08c5aab8b8edb01167eee4a5c243f7ec2", "url": "https://github.com/eclipse/rdf4j/commit/69b062b08c5aab8b8edb01167eee4a5c243f7ec2", "message": "GH-2538 Hide default namespace comparator\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T11:58:37Z", "type": "commit"}, {"oid": "60f5870dd100f534af0dd2a16b36c9b640b5d1fd", "url": "https://github.com/eclipse/rdf4j/commit/60f5870dd100f534af0dd2a16b36c9b640b5d1fd", "message": "GH-2538 Apply code formatting\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T11:58:51Z", "type": "commit"}, {"oid": "fd01c27f264082b98c09f94b8aaee381f45339cd", "url": "https://github.com/eclipse/rdf4j/commit/fd01c27f264082b98c09f94b8aaee381f45339cd", "message": "GH-2538 Fix broken BasicNamespace test\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-28T12:25:07Z", "type": "commit"}, {"oid": "f64da0dd976e3dffe83ec1eecdb36de045b2d01a", "url": "https://github.com/eclipse/rdf4j/commit/f64da0dd976e3dffe83ec1eecdb36de045b2d01a", "message": "GH-2538 configured API comparison to deal with module split", "committedDate": "2020-09-29T01:12:46Z", "type": "commit"}, {"oid": "d32085697035929bfcf3227511ce979402bd8a78", "url": "https://github.com/eclipse/rdf4j/commit/d32085697035929bfcf3227511ce979402bd8a78", "message": "empty commit to force CI clean rebuild", "committedDate": "2020-09-29T01:32:41Z", "type": "commit"}, {"oid": "0ce558160de727efa8697656f1881a1c7a73707d", "url": "https://github.com/eclipse/rdf4j/commit/0ce558160de727efa8697656f1881a1c7a73707d", "message": "Merge branch 'develop' into GH-2538-model-api", "committedDate": "2020-09-29T01:41:13Z", "type": "commit"}, {"oid": "83921e6240220af226660c00506c735496d05b5a", "url": "https://github.com/eclipse/rdf4j/commit/83921e6240220af226660c00506c735496d05b5a", "message": "GH-2538 fix parent pom version after rebase on develop", "committedDate": "2020-09-29T01:44:34Z", "type": "commit"}, {"oid": "a40f79fcab116933856999bca8199fdb77639d27", "url": "https://github.com/eclipse/rdf4j/commit/a40f79fcab116933856999bca8199fdb77639d27", "message": "GH-2538 Create oer.model.base package\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T06:49:22Z", "type": "commit"}, {"oid": "5cb9d09016060a4f1b9b4ff89c8693f051135de0", "url": "https://github.com/eclipse/rdf4j/commit/5cb9d09016060a4f1b9b4ff89c8693f051135de0", "message": "GH-2538 Create abstract value test suites\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T14:20:26Z", "type": "commit"}, {"oid": "7f65c4e8d524bda2d77a1d41cd5d2bc7e0faff19", "url": "https://github.com/eclipse/rdf4j/commit/7f65c4e8d524bda2d77a1d41cd5d2bc7e0faff19", "message": "GH-2538 Create abstract value classes in oer.model.base\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T14:21:30Z", "type": "commit"}, {"oid": "0c0608a325af9a98f4a87f72c44947ec236cf144", "url": "https://github.com/eclipse/rdf4j/commit/0c0608a325af9a98f4a87f72c44947ec236cf144", "message": "GH-2538 Migrate Model.setNamespace() default implementation to AbstractNamespace\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T14:28:01Z", "type": "commit"}, {"oid": "f7bf82f595a50a3129ebd67d223f3a9aad4bd6c2", "url": "https://github.com/eclipse/rdf4j/commit/f7bf82f595a50a3129ebd67d223f3a9aad4bd6c2", "message": "GH-2538 Review javadocs and method ordering\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T14:29:00Z", "type": "commit"}, {"oid": "9c21e1be5249f207362666530c44acbadb6d558c", "url": "https://github.com/eclipse/rdf4j/commit/9c21e1be5249f207362666530c44acbadb6d558c", "message": "GH-2538 Derive Simple* value classes from Abstract* companions\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T14:33:29Z", "type": "commit"}, {"oid": "09be7285210f3cef828560684ccb51252d2f7574", "url": "https://github.com/eclipse/rdf4j/commit/09be7285210f3cef828560684ccb51252d2f7574", "message": "GH-2538 Add Simple* test classes  based on abstract value test suites\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T14:34:31Z", "type": "commit"}, {"oid": "891ca565c42e11452225c5ce9e9f1b38ca07abd6", "url": "https://github.com/eclipse/rdf4j/commit/891ca565c42e11452225c5ce9e9f1b38ca07abd6", "message": "GH-2538 Apply code formatting\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T14:38:37Z", "type": "commit"}, {"oid": "157136adacbf8ab5d5dd8ce1746ba18db4fbd1fb", "url": "https://github.com/eclipse/rdf4j/commit/157136adacbf8ab5d5dd8ce1746ba18db4fbd1fb", "message": "GH-2538 Fix AbstractLiteral.toString(): now includes language tag verbatim\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T15:35:30Z", "type": "commit"}, {"oid": "50691fb6ccd26a71c2a246bb132dc583a3e78e55", "url": "https://github.com/eclipse/rdf4j/commit/50691fb6ccd26a71c2a246bb132dc583a3e78e55", "message": "GH-2538 Add missing serialVersionUIDs\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-29T15:35:46Z", "type": "commit"}, {"oid": "07b810c860468e029d1a746bb750cafead7bc4fb", "url": "https://github.com/eclipse/rdf4j/commit/07b810c860468e029d1a746bb750cafead7bc4fb", "message": "GH-2538 fixed code formatting", "committedDate": "2020-09-30T00:04:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE2NTM5MA==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r497165390", "bodyText": "Your IDE forgot to substitute the number here. Also: I don't think we should replace the license header on this just because we moved the file.", "author": "jeenbroekstra", "createdAt": "2020-09-30T00:08:11Z", "path": "core/model-api/src/main/java/org/eclipse/rdf4j/model/ValueFactory.java", "diffHunk": "@@ -1,10 +1,10 @@\n /*******************************************************************************\n- * Copyright (c) 2015 Eclipse RDF4J contributors, Aduna, and others.\n+ * Copyright (c) ${year} Eclipse RDF4J contributors.", "originalCommit": "07b810c860468e029d1a746bb750cafead7bc4fb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE2NTU2Nw==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r497165567", "bodyText": "good catch. I had to look several times before I even realized what you had changed.", "author": "jeenbroekstra", "createdAt": "2020-09-30T00:08:26Z", "path": "core/model-api/src/main/java/org/eclipse/rdf4j/model/ValueFactory.java", "diffHunk": "@@ -30,7 +27,7 @@\n \t *\n \t * @param iri A string-representation of a IRI.\n \t * @return An object representing the IRI.\n-\t * @throws IlllegalArgumentException If the supplied string does not resolve to a legal (absolute) IRI.\n+\t * @throws IllegalArgumentException If the supplied string does not resolve to a legal (absolute) IRI.", "originalCommit": "07b810c860468e029d1a746bb750cafead7bc4fb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE2OTM1Mg==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r497169352", "bodyText": "This is a new file I think? If so this is the wrong header.", "author": "jeenbroekstra", "createdAt": "2020-09-30T00:14:06Z", "path": "core/model/src/test/java/org/eclipse/rdf4j/model/impl/SimpleBNodeTest.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*******************************************************************************\n+ * Copyright (c) 2015 Eclipse RDF4J contributors, Aduna, and others.\n+ * All rights reserved. This program and the accompanying materials", "originalCommit": "07b810c860468e029d1a746bb750cafead7bc4fb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE3MjkwNQ==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r497172905", "bodyText": "Wildcard import needs to be expanded.", "author": "jeenbroekstra", "createdAt": "2020-09-30T00:19:14Z", "path": "core/model/src/test/java/org/eclipse/rdf4j/model/impl/SimpleTripleTest.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*******************************************************************************\n+ * Copyright (c) 2015 Eclipse RDF4J contributors, Aduna, and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Distribution License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/org/documents/edl-v10.php.\n+ *******************************************************************************/\n+package org.eclipse.rdf4j.model.impl;\n+\n+import org.eclipse.rdf4j.model.*;", "originalCommit": "07b810c860468e029d1a746bb750cafead7bc4fb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE4MDExMg==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r497180112", "bodyText": "This class, and the other new abstract classes, could use a minimal bit of Javadoc. All it really needs:\n\nBase class for {@link BNode}, offering common functionality.\n\nand preferable an author tag, and a @since 3.5.0 tag as well.", "author": "jeenbroekstra", "createdAt": "2020-09-30T00:34:41Z", "path": "core/model-api/src/main/java/org/eclipse/rdf4j/model/base/AbstractBNode.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Eclipse RDF4J contributors.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Distribution License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/org/documents/edl-v10.php.\n+ ******************************************************************************/\n+\n+package org.eclipse.rdf4j.model.base;\n+\n+import java.util.Objects;\n+\n+import org.eclipse.rdf4j.model.BNode;\n+\n+public abstract class AbstractBNode implements BNode {", "originalCommit": "07b810c860468e029d1a746bb750cafead7bc4fb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "feba9f524bc673a69702caf95200b96d46304994", "url": "https://github.com/eclipse/rdf4j/commit/feba9f524bc673a69702caf95200b96d46304994", "message": "GH-2538 Fix misattributed copyright headers\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-30T06:24:29Z", "type": "commit"}, {"oid": "bfe9bfce83f697f8cfb1b87547596dd07053657b", "url": "https://github.com/eclipse/rdf4j/commit/bfe9bfce83f697f8cfb1b87547596dd07053657b", "message": "GH-2538 Fix wildcard and unused imports\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-30T06:51:21Z", "type": "commit"}, {"oid": "b74686d6d1c72b40ba61186b9668784b1b22f25f", "url": "https://github.com/eclipse/rdf4j/commit/b74686d6d1c72b40ba61186b9668784b1b22f25f", "message": "GH-2538 Add missing javadocs to new classes\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-30T06:52:44Z", "type": "commit"}, {"oid": "8bfd15647f21d13c7f5beed4233065620ae57302", "url": "https://github.com/eclipse/rdf4j/commit/8bfd15647f21d13c7f5beed4233065620ae57302", "message": "GH-2538 Improve float/double parsing in AbstractLiteral\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-30T08:38:07Z", "type": "commit"}, {"oid": "5f667213c6d68f226749906fe2a7f59625bd9eab", "url": "https://github.com/eclipse/rdf4j/commit/5f667213c6d68f226749906fe2a7f59625bd9eab", "message": "GH-2538 Complete calendar coverage in LiteralTest\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-30T08:46:22Z", "type": "commit"}, {"oid": "483acc1e0ab7fe745283b05ad1c345d85f8b426c", "url": "https://github.com/eclipse/rdf4j/commit/483acc1e0ab7fe745283b05ad1c345d85f8b426c", "message": "GH-2538 Abstract ValueFactoryTest test suite\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-30T09:21:44Z", "type": "commit"}, {"oid": "c14493f9047a7a1736ea0dd6962e10e767103bea", "url": "https://github.com/eclipse/rdf4j/commit/c14493f9047a7a1736ea0dd6962e10e767103bea", "message": "GH-2538 Apply code formatting\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-30T11:57:11Z", "type": "commit"}, {"oid": "00dab8912b8621a299d4ac06299d2cf518b5502d", "url": "https://github.com/eclipse/rdf4j/commit/00dab8912b8621a299d4ac06299d2cf518b5502d", "message": "GH-2538 Patch regression at oer.sail.memory.MemoryRDFStarSupportTest\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-30T13:50:01Z", "type": "commit"}, {"oid": "3df950911fec5d57761cc5e9690d35601b39fe4e", "url": "https://github.com/eclipse/rdf4j/commit/3df950911fec5d57761cc5e9690d35601b39fe4e", "message": "GH-2538 Patch regression at oer.sail.shacl.UniqueTest\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-09-30T13:50:25Z", "type": "commit"}, {"oid": "4eee4dac7360d92fdf13287898fad45e7554bad2", "url": "https://github.com/eclipse/rdf4j/commit/4eee4dac7360d92fdf13287898fad45e7554bad2", "message": "GH-2538 produce test jar for model-api abstract unit tests", "committedDate": "2020-10-01T04:15:04Z", "type": "commit"}, {"oid": "20c9ac72614787ab26dbb4ce4c476318b8168b45", "url": "https://github.com/eclipse/rdf4j/commit/20c9ac72614787ab26dbb4ce4c476318b8168b45", "message": "Merge branch 'develop' into GH-2538-model-api", "committedDate": "2020-10-01T07:08:04Z", "type": "commit"}, {"oid": "5d610b0e1bbe591750ca76b58b1c7b530ce09059", "url": "https://github.com/eclipse/rdf4j/commit/5d610b0e1bbe591750ca76b58b1c7b530ce09059", "message": "GH-2538 remove use of javax.xml.bind to avoid Java 15 compile issues", "committedDate": "2020-10-01T07:32:45Z", "type": "commit"}, {"oid": "af8c679114225de7f52dc14da17ba251a9cfa94e", "url": "https://github.com/eclipse/rdf4j/commit/af8c679114225de7f52dc14da17ba251a9cfa94e", "message": "GH-2538 Document model .equals()/.hashCode() contracts\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-10-01T08:59:22Z", "type": "commit"}, {"oid": "b60289e7acde5ada55d4ee4428ad0a89f12bd6b2", "url": "https://github.com/eclipse/rdf4j/commit/b60289e7acde5ada55d4ee4428ad0a89f12bd6b2", "message": "GH-2538 Fix incompatible .hashCode() methods\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-10-01T09:09:23Z", "type": "commit"}, {"oid": "f1867f973276ed616e105adde4ea102c18a59629", "url": "https://github.com/eclipse/rdf4j/commit/f1867f973276ed616e105adde4ea102c18a59629", "message": "GH-2538 Apply code formatting\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-10-01T09:18:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEyNzU5NA==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498127594", "bodyText": "Can we move this back into the Literal interface. There is no need to introduce another instanceof call for every Literal again!", "author": "hmottestad", "createdAt": "2020-10-01T10:01:56Z", "path": "core/model/src/main/java/org/eclipse/rdf4j/model/util/Literals.java", "diffHunk": "@@ -57,6 +58,22 @@ public static String getLabel(Optional v, String fallback) {\n \t\treturn v != null ? getLabel((Value) v.orElseGet(null), fallback) : fallback;\n \t}\n \n+\t/**\n+\t * Retrieves the {@link XSD.Datatype} value for the supplied Literal, if it has one.\n+\t *\n+\t * @param a Literal\n+\t * @return an Optional {@link XSD.Datatype} enum, if one is available. Note that the absence of this enum does\n+\t *         <i>not</i> indicate that the literal has no datatype, merely that it has no cached enum representation of\n+\t *         that datatype.\n+\t * @since 3.5.0\n+\t */\n+\tpublic static Optional<XSD.Datatype> getXsdDatatype(Literal l) {\n+\t\tif (l instanceof SimpleLiteral) {\n+\t\t\treturn ((SimpleLiteral) l).getXsdDatatype();\n+\t\t}\n+\t\treturn Optional.empty();\n+\t}", "originalCommit": "5d610b0e1bbe591750ca76b58b1c7b530ce09059", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEzOTg1NQ==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498139855", "bodyText": "I'll run some benchmarks now to see the effects, but I understand that's it's hard to move back since it makes the Literal class dependent on the XSD class.", "author": "hmottestad", "createdAt": "2020-10-01T10:23:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEyNzU5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1NDc2OQ==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498154769", "bodyText": "This branch:\nBenchmark                                       Mode  Cnt    Score   Error  Units\nValueComparatorBenchmark.sortManyDeepEquals     avgt   10  330.260 \u00b1 2.762  ms/op\nValueComparatorBenchmark.sortManyPointerEquals  avgt   10   19.662 \u00b1 0.335  ms/op\nValueComparatorBenchmark.sortObjects            avgt   10   26.762 \u00b1 0.800  ms/op\nValueComparatorBenchmark.sortPredicates         avgt   10    0.049 \u00b1 0.016  ms/op\nValueComparatorBenchmark.sortSubjects           avgt   10   24.441 \u00b1 0.448  ms/op\n\nDevelop:\nBenchmark                                       Mode  Cnt    Score   Error  Units\nValueComparatorBenchmark.sortManyDeepEquals     avgt   10  341.620 \u00b1 3.551  ms/op\nValueComparatorBenchmark.sortManyPointerEquals  avgt   10   19.915 \u00b1 0.697  ms/op\nValueComparatorBenchmark.sortObjects            avgt   10   27.737 \u00b1 1.054  ms/op\nValueComparatorBenchmark.sortPredicates         avgt   10    0.059 \u00b1 0.009  ms/op\nValueComparatorBenchmark.sortSubjects           avgt   10   24.673 \u00b1 0.624  ms/op", "author": "hmottestad", "createdAt": "2020-10-01T10:52:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEyNzU5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE2MDgwOA==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498160808", "bodyText": "No, we can't, because it uses a class from the model module, which introduces a cyclic dependency.", "author": "jeenbroekstra", "createdAt": "2020-10-01T11:04:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEyNzU5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE2NjA2Nw==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498166067", "bodyText": "Unless we can interface/abstract that out as well, somehow.", "author": "jeenbroekstra", "createdAt": "2020-10-01T11:15:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEyNzU5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE3NjMwOA==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498176308", "bodyText": "Actually might not be a bad idea. It's late and I'm in the middle of a whisky tasting but I'll have a look tomorrow unless you best me to it.", "author": "jeenbroekstra", "createdAt": "2020-10-01T11:35:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEyNzU5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE3ODM3OQ==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498178379", "bodyText": "Enjoy your whisky tasting! No need to worry about this. I checked the performance, and using instanceof against a class seems to have no impact compared to how slow we were seeing instanceof be against an interface.", "author": "hmottestad", "createdAt": "2020-10-01T11:39:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEyNzU5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEyODE2Mw==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498128163", "bodyText": "This is probably what is causing the test failures. Notice both methods call on leftLit", "author": "hmottestad", "createdAt": "2020-10-01T10:02:55Z", "path": "core/queryalgebra/evaluation/src/main/java/org/eclipse/rdf4j/query/algebra/evaluation/util/QueryEvaluationUtil.java", "diffHunk": "@@ -152,8 +152,8 @@ public static boolean compareLiterals(Literal leftLit, Literal rightLit, Compare\n \t\tIRI leftDatatype = leftLit.getDatatype();\n \t\tIRI rightDatatype = rightLit.getDatatype();\n \n-\t\tXSD.Datatype leftXsdDatatype = leftLit.getXsdDatatype().orElse(null);\n-\t\tXSD.Datatype rightXsdDatatype = rightLit.getXsdDatatype().orElse(null);\n+\t\tXSD.Datatype leftXsdDatatype = Literals.getXsdDatatype(leftLit).orElse(null);\n+\t\tXSD.Datatype rightXsdDatatype = Literals.getXsdDatatype(leftLit).orElse(null);", "originalCommit": "5d610b0e1bbe591750ca76b58b1c7b530ce09059", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ca6caf415db26b61fd25def006beed5e03d20b94", "url": "https://github.com/eclipse/rdf4j/commit/ca6caf415db26b61fd25def006beed5e03d20b94", "message": "GH-2538 fix bug introduced by merge resolution", "committedDate": "2020-10-01T20:56:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODUwNzgyNQ==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498507825", "bodyText": "Adding new methods to an existing public interface (without a default implementation) is not backwards compatible. It's also out of scope for this issue.", "author": "jeenbroekstra", "createdAt": "2020-10-01T20:54:50Z", "path": "core/model-api/src/main/java/org/eclipse/rdf4j/model/Namespace.java", "diffHunk": "@@ -11,9 +11,20 @@\n \n /**\n  * A namespace, consisting of a namespace name and a prefix that has been assigned to it.\n+ * <p>\n+ * <strong>Warning</strong> / In order to ensure interoperability of concrete classes implementing this interface,\n+ * {@link #equals(Object)} and {@link #hashCode()} methods must be implemented exactly as described in their specs.\n+ * \n  */\n public interface Namespace extends Serializable, Comparable<Namespace> {\n \n+\t/**\n+\t * Gets the prefix of the current namespace. The default namespace is represented by an empty prefix string.\n+\t *\n+\t * @return prefix of namespace, or an empty string in case of the default namespace.\n+\t */\n+\tpublic String getPrefix();", "originalCommit": "f1867f973276ed616e105adde4ea102c18a59629", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU0ODAzOQ==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498548039", "bodyText": "Er, forget I said that, this is obviously not a new method. It was early, before coffee.", "author": "jeenbroekstra", "createdAt": "2020-10-01T22:45:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODUwNzgyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODUwODMxMg==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498508312", "bodyText": "This, also, is not backwards compatible. I don't think we need to declare these at the interface level right now to get this to work.", "author": "jeenbroekstra", "createdAt": "2020-10-01T20:55:50Z", "path": "core/model-api/src/main/java/org/eclipse/rdf4j/model/Namespace.java", "diffHunk": "@@ -22,9 +33,23 @@\n \tpublic String getName();\n \n \t/**\n-\t * Gets the prefix of the current namespace. The default namespace is represented by an empty prefix string.\n+\t * Compares this namespace to another object.\n \t *\n-\t * @return prefix of namespace, or an empty string in case of the default namespace.\n+\t * @param o The object to compare this namespace to\n+\t *\n+\t * @return {@code true} if the other object is an instance of {@code Namespace} and their {@linkplain #getPrefix()\n+\t *         prefixes} and {@linkplain #getName() names} are equal, {@code false} otherwise.\n \t */\n-\tpublic String getPrefix();\n+\t@Override\n+\tboolean equals(Object o);\n+\n+\t/**\n+\t * Computes the hash code of this namespace.\n+\t *\n+\t * @return a hash code for this namespace computed as {@link java.util.Objects#hash Objects.hash}(\n+\t *         {@link #getPrefix()}, {@link #getName()})\n+\t */\n+\t@Override\n+\tint hashCode();", "originalCommit": "f1867f973276ed616e105adde4ea102c18a59629", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU1NDUyMg==", "url": "https://github.com/eclipse/rdf4j/pull/2546#discussion_r498554522", "bodyText": "I had a closer look at this and I think that in fact you are correct to specify this, and we should treat this not as a backward-incompatible change, but as a bug fix. Namespace extends Comparable, which requires that we have properly defined contract for equals / hashCode. It also shouldn't be a problem for existing implementations that don't have a correct equals/hashCode methods yet: they'll still compile and run, they'll just break the contract (but they already did that implicitly).\nI'll add the necessary exceptions to the api comparison check.", "author": "jeenbroekstra", "createdAt": "2020-10-01T23:09:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODUwODMxMg=="}], "type": "inlineReview"}, {"oid": "0ce616de01993ee771891acc750b2ed70c3f553e", "url": "https://github.com/eclipse/rdf4j/commit/0ce616de01993ee771891acc750b2ed70c3f553e", "message": "GH-2538 add exception for equals/hashCode methods in API comparison", "committedDate": "2020-10-01T23:20:36Z", "type": "commit"}, {"oid": "ab68f1bf91eacd61c6d92115aabe2cb7938d58c1", "url": "https://github.com/eclipse/rdf4j/commit/ab68f1bf91eacd61c6d92115aabe2cb7938d58c1", "message": "GH-2538 Add implementation note for Literal.hashCode()\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-10-02T06:43:11Z", "type": "commit"}, {"oid": "2839267dae7c88a6876e38f9dc4ac74ffde24194", "url": "https://github.com/eclipse/rdf4j/commit/2839267dae7c88a6876e38f9dc4ac74ffde24194", "message": "GH-2538 Revert interface-level equals/hashCode contract for Triple\n\nSigned-off-by: Alessandro Bollini <22@metreeca.com>", "committedDate": "2020-10-02T06:48:46Z", "type": "commit"}]}