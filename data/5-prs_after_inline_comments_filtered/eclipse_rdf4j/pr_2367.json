{"pr_number": 2367, "pr_title": "GH-2362 pass TripleSource through to function evaluation", "pr_createdAt": "2020-07-17T09:33:49Z", "pr_url": "https://github.com/eclipse/rdf4j/pull/2367", "timeline": [{"oid": "418481a5cd26ef8c77d2d57741c135264207af69", "url": "https://github.com/eclipse/rdf4j/commit/418481a5cd26ef8c77d2d57741c135264207af69", "message": "GH-2362 pass TripleSource through to function evaluation", "committedDate": "2020-07-17T09:22:11Z", "type": "commit"}, {"oid": "9cdb3992fe1d60db19ab99aa715c756b793a4784", "url": "https://github.com/eclipse/rdf4j/commit/9cdb3992fe1d60db19ab99aa715c756b793a4784", "message": "GH-2362 javadoc editorial", "committedDate": "2020-07-18T01:25:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjczODA3OQ==", "url": "https://github.com/eclipse/rdf4j/pull/2367#discussion_r456738079", "bodyText": "We should probably note in #2115 that this default might be removed in 4.0.", "author": "jeenbroekstra", "createdAt": "2020-07-18T02:31:28Z", "path": "core/queryalgebra/evaluation/src/main/java/org/eclipse/rdf4j/query/algebra/evaluation/function/Function.java", "diffHunk": "@@ -9,14 +9,45 @@\n \n import org.eclipse.rdf4j.model.Value;\n import org.eclipse.rdf4j.model.ValueFactory;\n+import org.eclipse.rdf4j.query.algebra.evaluation.TripleSource;\n import org.eclipse.rdf4j.query.algebra.evaluation.ValueExprEvaluationException;\n \n /**\n+ * A query function, which can be a built-in function in the query language, or a custom function as documented in the\n+ * <a href=\"https://www.w3.org/TR/sparql11-query/\">SPARQL 1.1 Query Language Recommendation</a>.\n+ *\n  * @author Arjohn Kampman\n+ * @author Jeen Broekstra\n+ * @see FunctionRegistry\n  */\n public interface Function {\n \n-\tpublic String getURI();\n+\tString getURI();\n \n-\tpublic Value evaluate(ValueFactory valueFactory, Value... args) throws ValueExprEvaluationException;\n+\t/**\n+\t * Evaluate the function over the supplied input arguments, using the supplied {@link ValueFactory} to produce the\n+\t * result.\n+\t *\n+\t * @param valueFactory a {@link ValueFactory} to use for producing the function result.\n+\t * @param args         the function input arguments.\n+\t * @return the function result value.\n+\t * @throws ValueExprEvaluationException\n+\t * @deprecated since 3.3.0. Use {@link #evaluate(TripleSource, Value...)} instead.\n+\t */\n+\t@Deprecated\n+\tValue evaluate(ValueFactory valueFactory, Value... args) throws ValueExprEvaluationException;\n+\n+\t/**\n+\t * Evaluate the function over the supplied input arguments.\n+\t *\n+\t * @param tripleSource the {@link TripleSource} used in the query evaluation. This can be used to access the current\n+\t *                     state of the store.\n+\t * @param args         the function input arguments.\n+\t * @return the function result value.\n+\t * @throws ValueExprEvaluationException\n+\t * @since 3.3.0\n+\t */\n+\tdefault Value evaluate(TripleSource tripleSource, Value... args) throws ValueExprEvaluationException {", "originalCommit": "f388f377afb0f71d2d234e00cacd986fb34194ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "53471e58956c6aa2cb07fa54f412602ac2d95bc7", "url": "https://github.com/eclipse/rdf4j/commit/53471e58956c6aa2cb07fa54f412602ac2d95bc7", "message": "GH-2362 integration test for function evaluation using TripleSource", "committedDate": "2020-07-18T02:33:41Z", "type": "forcePushed"}, {"oid": "8a597ca5af6b7f438c90534f111da65544d4ef00", "url": "https://github.com/eclipse/rdf4j/commit/8a597ca5af6b7f438c90534f111da65544d4ef00", "message": "GH-2362 integration test for function evaluation using TripleSource", "committedDate": "2020-07-18T02:36:38Z", "type": "commit"}, {"oid": "8a597ca5af6b7f438c90534f111da65544d4ef00", "url": "https://github.com/eclipse/rdf4j/commit/8a597ca5af6b7f438c90534f111da65544d4ef00", "message": "GH-2362 integration test for function evaluation using TripleSource", "committedDate": "2020-07-18T02:36:38Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEyMzczOA==", "url": "https://github.com/eclipse/rdf4j/pull/2367#discussion_r457123738", "bodyText": "Could you add to the deprecation warning that the value factory can be retrieved from the triple source?", "author": "hmottestad", "createdAt": "2020-07-20T07:19:13Z", "path": "core/queryalgebra/evaluation/src/main/java/org/eclipse/rdf4j/query/algebra/evaluation/function/Function.java", "diffHunk": "@@ -9,14 +9,45 @@\n \n import org.eclipse.rdf4j.model.Value;\n import org.eclipse.rdf4j.model.ValueFactory;\n+import org.eclipse.rdf4j.query.algebra.evaluation.TripleSource;\n import org.eclipse.rdf4j.query.algebra.evaluation.ValueExprEvaluationException;\n \n /**\n+ * A query function, which can be a built-in function in the query language, or a custom function as documented in the\n+ * <a href=\"https://www.w3.org/TR/sparql11-query/\">SPARQL 1.1 Query Language Recommendation</a>.\n+ *\n  * @author Arjohn Kampman\n+ * @author Jeen Broekstra\n+ * @see FunctionRegistry\n  */\n public interface Function {\n \n-\tpublic String getURI();\n+\tString getURI();\n \n-\tpublic Value evaluate(ValueFactory valueFactory, Value... args) throws ValueExprEvaluationException;\n+\t/**\n+\t * Evaluate the function over the supplied input arguments, using the supplied {@link ValueFactory} to produce the\n+\t * result.\n+\t *\n+\t * @param valueFactory a {@link ValueFactory} to use for producing the function result.\n+\t * @param args         the function input arguments.\n+\t * @return the function result value.\n+\t * @throws ValueExprEvaluationException\n+\t * @deprecated since 3.3.0. Use {@link #evaluate(TripleSource, Value...)} instead.", "originalCommit": "8a597ca5af6b7f438c90534f111da65544d4ef00", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a70db9791b94b9b84c8a85edc639202ac07c1428", "url": "https://github.com/eclipse/rdf4j/commit/a70db9791b94b9b84c8a85edc639202ac07c1428", "message": "GH-2362 minor addition to javadoc deprecation notice", "committedDate": "2020-07-21T05:17:22Z", "type": "commit"}]}