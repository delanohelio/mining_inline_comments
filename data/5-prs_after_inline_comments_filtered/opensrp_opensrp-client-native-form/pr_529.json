{"pr_number": 529, "pr_title": "Add project level support for MLS", "pr_createdAt": "2020-12-03T07:43:14Z", "pr_url": "https://github.com/opensrp/opensrp-client-native-form/pull/529", "timeline": [{"oid": "516c9f2df656d0570d03a56acd6162dfd06b0198", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/516c9f2df656d0570d03a56acd6162dfd06b0198", "message": "Add project level support for mls", "committedDate": "2020-12-03T07:42:31Z", "type": "commit"}, {"oid": "dd41e784a2bfead7aa85d42c023d0c3dd0fbd9a9", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/dd41e784a2bfead7aa85d42c023d0c3dd0fbd9a9", "message": "Update NativeFormLibrary.java", "committedDate": "2020-12-03T09:36:27Z", "type": "commit"}, {"oid": "f11289359d933c6ad2ec5f302f67b137d74b540f", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/f11289359d933c6ad2ec5f302f67b137d74b540f", "message": "Add unit tests for NativeFormLibrary class", "committedDate": "2020-12-03T09:49:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIwNjI3Nw==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535206277", "bodyText": "this shouldn't be static", "author": "githengi", "createdAt": "2020-12-03T12:58:37Z", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/NativeFormLibrary.java", "diffHunk": "@@ -12,6 +12,7 @@\n \n     private ClientFormContract.Dao clientFormDao;\n     private static NativeFormLibrary instance;\n+    private static boolean performFormsTranslation = false;", "originalCommit": "f11289359d933c6ad2ec5f302f67b137d74b540f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIwNzk1OQ==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535207959", "bodyText": "also refactor to singular performFormTranslation", "author": "githengi", "createdAt": "2020-12-03T13:01:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIwNjI3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTg3Mjc1Ng==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535872756", "bodyText": "Done", "author": "zzainulabidin", "createdAt": "2020-12-04T06:45:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIwNjI3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIwNzI0MA==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535207240", "bodyText": "the check for  activityIntent == null has been removed, is that intentional?", "author": "githengi", "createdAt": "2020-12-03T13:00:07Z", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/customviews/GenericPopupDialog.java", "diffHunk": "@@ -90,8 +91,9 @@ public void onCreate(Bundle savedInstanceState) {\n \n         // support translation of sub-forms\n         Intent activityIntent = getActivity().getIntent();\n-        translateSubForm =  activityIntent == null ? translateSubForm\n-                : activityIntent.getBooleanExtra(JsonFormConstants.PERFORM_FORM_TRANSLATION, false);\n+        translateSubForm = activityIntent.hasExtra(JsonFormConstants.PERFORM_FORM_TRANSLATION) ?", "originalCommit": "f11289359d933c6ad2ec5f302f67b137d74b540f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIyMDU5MA==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535220590", "bodyText": "https://github.com/OpenSRP/opensrp-client-native-form/pull/529/files#r535217012", "author": "vincent-karuri", "createdAt": "2020-12-03T13:20:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIwNzI0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQzODE5OA==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535438198", "bodyText": "Check Added", "author": "zzainulabidin", "createdAt": "2020-12-03T17:30:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIwNzI0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxNzAxMg==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535217012", "bodyText": "This can be simplified to getIntent().getBooleanExtra(JsonFormConstants.PERFORM_FORM_TRANSLATION, false) || NativeFormLibrary.getInstance().isPerformFormsTranslation();", "author": "vincent-karuri", "createdAt": "2020-12-03T13:15:53Z", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/activities/JsonFormBaseActivity.java", "diffHunk": "@@ -90,7 +91,10 @@ protected void onCreate(Bundle savedInstanceState) {\n         onActivityRequestPermissionResultListeners = new HashMap<>();\n         lifeCycleListeners = new ArrayList<>();\n         isFormFragmentInitialized = false;\n-        translateForm = getIntent().getBooleanExtra(JsonFormConstants.PERFORM_FORM_TRANSLATION, false);\n+        translateForm = getIntent().hasExtra(JsonFormConstants.PERFORM_FORM_TRANSLATION) ?\n+                getIntent().getBooleanExtra(JsonFormConstants.PERFORM_FORM_TRANSLATION, false) :\n+                NativeFormLibrary.getInstance().isPerformFormsTranslation();", "originalCommit": "f11289359d933c6ad2ec5f302f67b137d74b540f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIyNDk0NQ==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535224945", "bodyText": "Unless the idea is to allow JsonFormConstants.PERFORM_FORM_TRANSLATION to override the global config per form.", "author": "vincent-karuri", "createdAt": "2020-12-03T13:25:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxNzAxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTMwMDE2NA==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535300164", "bodyText": "Yes exactly, I plan to override the global config-if any single form needs to be un-translated.", "author": "zzainulabidin", "createdAt": "2020-12-03T14:53:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxNzAxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxOTgxNQ==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535219815", "bodyText": "Could you add assertions to verify that a sample form is actually translated when the value is set to true and that it is left untranslated when the value is false?", "author": "vincent-karuri", "createdAt": "2020-12-03T13:20:06Z", "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/utils/NativeFormLangUtilsTest.java", "diffHunk": "@@ -118,4 +119,12 @@ public void testResourceBundleWithPropertiesFromDbIsEmptyWhenClientFormDoesntExi\n         ResourceBundle mlsResourceBundle = NativeFormLangUtils.getResourceBundleFromRepository(RuntimeEnvironment.application, interpolatedJsonForm);\n         assertFalse(mlsResourceBundle.getKeys().hasMoreElements());\n     }\n+\n+    @Test\n+    public void testPerformFormsTranslationShouldReturnCorrectValue() {\n+        NativeFormLibrary.getInstance().setPerformFormsTranslation(true);\n+        assertTrue(NativeFormLibrary.getInstance().isPerformFormsTranslation());\n+        NativeFormLibrary.getInstance().setPerformFormsTranslation(false);\n+        assertFalse(NativeFormLibrary.getInstance().isPerformFormsTranslation());", "originalCommit": "f11289359d933c6ad2ec5f302f67b137d74b540f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk3NzQ1Mw==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535977453", "bodyText": "Test cases added", "author": "zzainulabidin", "createdAt": "2020-12-04T09:58:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxOTgxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk3OTQ1NA==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r535979454", "bodyText": "Refer JsonFormActivityTest.java", "author": "zzainulabidin", "createdAt": "2020-12-04T10:01:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxOTgxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAzNDU5Mw==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r536034593", "bodyText": "Also test that the intent value can override the global value per form i.e.\n\nset global to true and set intent to false -> should not translate form\nset global to false and set intent to true -> should translate form", "author": "vincent-karuri", "createdAt": "2020-12-04T11:33:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxOTgxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MDg5NQ==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r536090895", "bodyText": "Required test cases added.", "author": "zzainulabidin", "createdAt": "2020-12-04T13:14:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxOTgxNQ=="}], "type": "inlineReview"}, {"oid": "e0a84e61f5f1f6ce74d72597f95dcb0466800bdf", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/e0a84e61f5f1f6ce74d72597f95dcb0466800bdf", "message": "Improvements for global config mls integration", "committedDate": "2020-12-04T09:58:34Z", "type": "commit"}, {"oid": "a2c17fa74f9c21924a2598f1eddb7be2edef1f03", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/a2c17fa74f9c21924a2598f1eddb7be2edef1f03", "message": "Add test cases for mls global config translation", "committedDate": "2020-12-04T09:59:35Z", "type": "commit"}, {"oid": "9a9f24d36d8b4034c17adf46e1fc0bd359a91b06", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/9a9f24d36d8b4034c17adf46e1fc0bd359a91b06", "message": "Update build.gradle to resolve import error", "committedDate": "2020-12-04T10:00:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAzNjYxMA==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r536036610", "bodyText": "This test is not too relevant now, it can be removed.", "author": "vincent-karuri", "createdAt": "2020-12-04T11:36:52Z", "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/utils/NativeFormLangUtilsTest.java", "diffHunk": "@@ -118,4 +120,12 @@ public void testResourceBundleWithPropertiesFromDbIsEmptyWhenClientFormDoesntExi\n         ResourceBundle mlsResourceBundle = NativeFormLangUtils.getResourceBundleFromRepository(RuntimeEnvironment.application, interpolatedJsonForm);\n         assertFalse(mlsResourceBundle.getKeys().hasMoreElements());\n     }\n+\n+    @Test\n+    public void testPerformFormsTranslationShouldReturnCorrectValue() {\n+        NativeFormLibrary.getInstance().setPerformFormTranslation(true);\n+        assertTrue(NativeFormLibrary.getInstance().isPerformFormTranslation());\n+        NativeFormLibrary.getInstance().setPerformFormTranslation(false);\n+        assertFalse(NativeFormLibrary.getInstance().isPerformFormTranslation());\n+    }", "originalCommit": "9a9f24d36d8b4034c17adf46e1fc0bd359a91b06", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MDcyNA==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/529#discussion_r536090724", "bodyText": "Test cases removed", "author": "zzainulabidin", "createdAt": "2020-12-04T13:14:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAzNjYxMA=="}], "type": "inlineReview"}, {"oid": "e52fc0daed74d78f8ef2b82be54472ce17f35b7c", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/e52fc0daed74d78f8ef2b82be54472ce17f35b7c", "message": "Unit tests added for mls global config", "committedDate": "2020-12-04T13:14:11Z", "type": "commit"}, {"oid": "e44575861eb92f48ca48ae6740c9a613bf6c44d5", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/e44575861eb92f48ca48ae6740c9a613bf6c44d5", "message": "Remove un-used imports", "committedDate": "2020-12-04T13:15:58Z", "type": "commit"}, {"oid": "8a61af90a6f3c41fe0944a4ccf747965bc3993d7", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/8a61af90a6f3c41fe0944a4ccf747965bc3993d7", "message": "Update gradle.properties", "committedDate": "2020-12-04T13:29:09Z", "type": "commit"}, {"oid": "18b111478fc2f5a64f3eb09727db1dc5cd8e58fd", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/18b111478fc2f5a64f3eb09727db1dc5cd8e58fd", "message": "Remove un-used import", "committedDate": "2020-12-04T13:36:46Z", "type": "commit"}, {"oid": "1ca88da2859f7a213084cb568de52938ea8fcb3e", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/1ca88da2859f7a213084cb568de52938ea8fcb3e", "message": "Remove used import from JsonFormActivityTest.java", "committedDate": "2020-12-04T13:45:10Z", "type": "commit"}, {"oid": "ec0780a24be6cbfcb51938e67dee45034ac007bf", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/ec0780a24be6cbfcb51938e67dee45034ac007bf", "message": "Merge branch 'master' into Add-project-level-support-for-mls", "committedDate": "2020-12-07T06:59:01Z", "type": "commit"}]}