{"pr_number": 657, "pr_title": "Created new dummfiier for RC environment.", "pr_createdAt": "2020-09-23T05:59:00Z", "pr_url": "https://github.com/RIPE-NCC/whois/pull/657", "timeline": [{"oid": "c79c56788b6ee3173c16710a8c33da33eb89a6cf", "url": "https://github.com/RIPE-NCC/whois/commit/c79c56788b6ee3173c16710a8c33da33eb89a6cf", "message": "Created new dummfiier for RC environment.", "committedDate": "2020-09-22T20:15:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYzMDM0NA==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r493630344", "bodyText": "Minor: the logger is not being used to log anything though. Consider using it, or removing", "author": "dadepo", "createdAt": "2020-09-23T14:17:36Z", "path": "whois-commons/src/main/java/net/ripe/db/whois/common/rpsl/DummifierRC.java", "diffHunk": "@@ -0,0 +1,75 @@\n+package net.ripe.db.whois.common.rpsl;\n+\n+import com.google.common.collect.Lists;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.stereotype.Component;\n+\n+import java.util.List;\n+\n+@Component\n+public class DummifierRC extends DummifierCurrent {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(DummifierRC.class);", "originalCommit": "c79c56788b6ee3173c16710a8c33da33eb89a6cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYzOTI1MQ==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r493639251", "bodyText": "I removed it", "author": "eshryane", "createdAt": "2020-09-23T14:28:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYzMDM0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYzNDU5NA==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r493634594", "bodyText": "the rpslObject is also not used by the dummifyDescr method...consider removing/using it somehow?", "author": "dadepo", "createdAt": "2020-09-23T14:22:55Z", "path": "whois-commons/src/main/java/net/ripe/db/whois/common/rpsl/DummifierRC.java", "diffHunk": "@@ -0,0 +1,75 @@\n+package net.ripe.db.whois.common.rpsl;\n+\n+import com.google.common.collect.Lists;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.stereotype.Component;\n+\n+import java.util.List;\n+\n+@Component\n+public class DummifierRC extends DummifierCurrent {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(DummifierRC.class);\n+\n+    @Override\n+    public RpslObject dummify(final int version, final RpslObject rpslObject) {\n+        final List<RpslAttribute> attributes = Lists.newArrayList(rpslObject.getAttributes());\n+\n+        for (int i = 0; i < attributes.size(); i++) {\n+            RpslAttribute replacement = attributes.get(i);\n+\n+            replacement = dummifyOrgName(rpslObject, replacement);\n+            replacement = dummifyDescr(rpslObject, replacement);", "originalCommit": "c79c56788b6ee3173c16710a8c33da33eb89a6cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYzNjE5OA==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r493636198", "bodyText": "same observation applies to dummifyRemarks, dummifyAsName and dummifyOwner methods...", "author": "dadepo", "createdAt": "2020-09-23T14:24:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYzNDU5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY0MDI3MQ==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r493640271", "bodyText": "I wanted a consistent method signature so I could extract those methods to sub-classes, but the class is very simple as-is, I removed the unused method arguments.", "author": "eshryane", "createdAt": "2020-09-23T14:29:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYzNDU5NA=="}], "type": "inlineReview"}, {"oid": "00f3f0517d219323f5314750698ab29e1b8a3118", "url": "https://github.com/RIPE-NCC/whois/commit/00f3f0517d219323f5314750698ab29e1b8a3118", "message": "Removed unused logger and method arguments", "committedDate": "2020-09-23T14:28:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY0MDI4NA==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r493640284", "bodyText": "Looks like this test named wrongly...it seems to be checking the dummification of description and remarks and not role", "author": "dadepo", "createdAt": "2020-09-23T14:29:55Z", "path": "whois-commons/src/test/java/net/ripe/db/whois/common/rpsl/DummifierRCTest.java", "diffHunk": "@@ -0,0 +1,151 @@\n+package net.ripe.db.whois.common.rpsl;\n+\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+import static org.hamcrest.Matchers.is;\n+import static org.junit.Assert.assertThat;\n+\n+public class DummifierRCTest {\n+\n+    private DummifierRC subject;\n+\n+    @Before\n+    public void setup() {\n+        subject = new DummifierRC();\n+    }\n+\n+    @Test\n+    public void dummify_organisation() {\n+        final RpslObject before = RpslObject.parse(\n+            \"organisation:   ORG-RIEN1-TEST\\n\" +\n+            \"org-name:       Reseaux IP Europeens Network Coordination Centre (RIPE NCC)\\n\" +\n+            \"org-type:       LIR\\n\" +\n+            \"descr:          RIPE NCC Operations\\n\" +\n+            \"address:        Singel 256\\n\" +\n+            \"address:        Amsterdam\\n\" +\n+            \"address:        Netherlands\\n\" +\n+            \"phone:          +31205552222\\n\" +\n+            \"fax-no:         +31205552266\\n\" +\n+            \"admin-c:        AC1-TEST\\n\" +\n+            \"admin-c:        AC2-TEST\\n\" +\n+            \"abuse-c:        AR1-TEST\\n\" +\n+            \"mnt-ref:        TEST-MNT\\n\" +\n+            \"mnt-by:         TEST-MNT\\n\" +\n+            \"created:        1970-01-01T00:00:00Z\\n\" +\n+            \"last-modified:  2020-09-22T09:00:00Z\\n\" +\n+            \"source:         TEST\");\n+\n+        final RpslObject after = subject.dummify(3, before);\n+\n+        assertThat(after.toString(), is(\n+            \"organisation:   ORG-RIEN1-TEST\\n\" +\n+            \"org-name:       Dummy org-name for ORG-RIEN1-TEST\\n\" +\n+            \"org-type:       LIR\\n\" +\n+            \"descr:          ***\\n\" +\n+            \"address:        ***\\n\" +\n+            \"address:        ***\\n\" +\n+            \"address:        Netherlands\\n\" +\n+            \"phone:          +31205......\\n\" +\n+            \"fax-no:         +31205......\\n\" +\n+            \"admin-c:        AC1-TEST\\n\" +\n+            \"admin-c:        AC2-TEST\\n\" +\n+            \"abuse-c:        AR1-TEST\\n\" +\n+            \"mnt-ref:        TEST-MNT\\n\" +\n+            \"mnt-by:         TEST-MNT\\n\" +\n+            \"created:        1970-01-01T00:00:00Z\\n\" +\n+            \"last-modified:  2020-09-22T09:00:00Z\\n\" +\n+            \"source:         TEST\\n\"));\n+    }\n+\n+    @Test\n+    public void dummify_role() {\n+        final RpslObject before = RpslObject.parse(\n+            \"role:           Abuse Contact\\n\" +\n+            \"descr:          RIPE NCC Operations\\n\" +\n+            \"address:        Singel 256\\n\" +\n+            \"address:        Amsterdam\\n\" +\n+            \"address:        Netherlands\\n\" +\n+            \"e-mail:         abuse@ripe.net\\n\" +\n+            \"nic-hdl:        AC1-TEST\\n\" +\n+            \"remarks:        Abuse\\n\" +\n+            \"+Contact\\n\" +\n+            \"\\tRole\\n\" +\n+            \"abuse-mailbox:  abuse@ripe.net\\n\" +\n+            \"mnt-by:         TEST-MNT\\n\" +\n+            \"created:        1970-01-01T00:00:00Z\\n\" +\n+            \"last-modified:  2020-09-22T09:00:00Z\\n\" +\n+            \"source:         TEST\");\n+\n+        final RpslObject after = subject.dummify(3, before);\n+\n+        assertThat(after.toString(), is(", "originalCommit": "00f3f0517d219323f5314750698ab29e1b8a3118", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY0MjU0NQ==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r493642545", "bodyText": "The description and remarks attributes can appear in any object type. I didn't want to repeat the same object with variations on description and remarks, but rather test a different object type in each test case.", "author": "eshryane", "createdAt": "2020-09-23T14:32:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY0MDI4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY0NjgxNw==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r493646817", "bodyText": "same observation applies to dummify_aut_num test method", "author": "dadepo", "createdAt": "2020-09-23T14:38:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY0MDI4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY0NjIyMw==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r493646223", "bodyText": "question: shouldn't mnt-by also be dummified?...looks like it can be used to retrieve the role object/email details in production", "author": "dadepo", "createdAt": "2020-09-23T14:37:16Z", "path": "whois-commons/src/main/java/net/ripe/db/whois/common/rpsl/DummifierRC.java", "diffHunk": "@@ -0,0 +1,70 @@\n+package net.ripe.db.whois.common.rpsl;\n+\n+import com.google.common.collect.Lists;\n+import org.springframework.stereotype.Component;\n+\n+import java.util.List;\n+\n+@Component\n+public class DummifierRC extends DummifierCurrent {", "originalCommit": "00f3f0517d219323f5314750698ab29e1b8a3118", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA1NTUxMw==", "url": "https://github.com/RIPE-NCC/whois/pull/657#discussion_r500055513", "bodyText": "Mnt-by refers to a maintainer, and is not personal data in itself. We preserve keys to allow testing (so users can find their data).\nWe only remove personal data during dummification, and there are limits in production on querying for personal data).", "author": "eshryane", "createdAt": "2020-10-06T07:18:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY0NjIyMw=="}], "type": "inlineReview"}]}