{"pr_number": 715, "pr_title": "Handle rfc3986 IPv6 address provided by Jetty by getRemoteAddress() s\u2026", "pr_createdAt": "2020-12-09T19:51:27Z", "pr_url": "https://github.com/RIPE-NCC/whois/pull/715", "timeline": [{"oid": "ed91ac098b409bf8b44c4dc9d1984545cc6291e1", "url": "https://github.com/RIPE-NCC/whois/commit/ed91ac098b409bf8b44c4dc9d1984545cc6291e1", "message": "Handle rfc3986 IPv6 address provided by Jetty by getRemoteAddress() since v9.4.32.", "committedDate": "2020-12-09T19:43:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDAwNDM0NQ==", "url": "https://github.com/RIPE-NCC/whois/pull/715#discussion_r540004345", "bodyText": "Maybe use InetAddresses.forUriString instead?\nInspired from this fix here\nEdit\nUsed it myself and saw the class is taged with @beta annotation. So maybe differ using it.", "author": "dadepo", "createdAt": "2020-12-10T09:21:44Z", "path": "whois-api/src/main/java/net/ripe/db/whois/api/httpserver/RemoteAddressFilter.java", "diffHunk": "@@ -58,7 +58,11 @@ public String getRemoteAddr() {\n         private static String getRemoteAddress(final HttpServletRequest request) {\n             final String forwardedAddress = getForwardedAddress(request);\n             if (forwardedAddress == null) {\n-                return request.getRemoteAddr();\n+                final String address = request.getRemoteAddr();", "originalCommit": "ed91ac098b409bf8b44c4dc9d1984545cc6291e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDgyOTU1OQ==", "url": "https://github.com/RIPE-NCC/whois/pull/715#discussion_r540829559", "bodyText": "I had yet to reply, I actually started with littering that everywhere where we use InetAddresses.forString() and run into the IPv6 parsing issue but realised the methods are not compatible, the forUriString() genuinely expects IPv6 addresses to always be contained within brackets so it would then result in a try catch with assuming it to be IPv4 in the catch clause.. not great and also a somewhat expensive operation.\nThe bracket check that has been implemented now was inspired by the forUriString() implementation though :)", "author": "sbusk", "createdAt": "2020-12-11T10:01:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDAwNDM0NQ=="}], "type": "inlineReview"}, {"oid": "4858461e319348bc3be277ba2619ec7da0ae64c7", "url": "https://github.com/RIPE-NCC/whois/commit/4858461e319348bc3be277ba2619ec7da0ae64c7", "message": "Merge branch 'master' into handle-rfc3986-ipv6", "committedDate": "2020-12-18T09:58:39Z", "type": "commit"}, {"oid": "ef8ac7b08035bffc040b1c1c03ca9bea35d5b7c1", "url": "https://github.com/RIPE-NCC/whois/commit/ef8ac7b08035bffc040b1c1c03ca9bea35d5b7c1", "message": "Merge branch 'master' into handle-rfc3986-ipv6", "committedDate": "2021-01-05T12:21:45Z", "type": "commit"}]}