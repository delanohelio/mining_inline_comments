{"pr_number": 2994, "pr_title": "ARTEMIS-2637 Making UDP client discovery resilient", "pr_createdAt": "2020-02-28T14:43:07Z", "pr_url": "https://github.com/apache/activemq-artemis/pull/2994", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTczNzgwNw==", "url": "https://github.com/apache/activemq-artemis/pull/2994#discussion_r385737807", "bodyText": "There are no assertions in this test?", "author": "jbertram", "createdAt": "2020-02-28T14:52:43Z", "path": "tests/integration-tests/src/test/java/org/apache/activemq/artemis/tests/integration/cluster/topology/NettyHAClientTopologyWithDiscoveryTest.java", "diffHunk": "@@ -16,11 +16,146 @@\n  */\n package org.apache.activemq.artemis.tests.integration.cluster.topology;\n \n+import org.apache.activemq.artemis.api.core.DiscoveryGroupConfiguration;\n+import org.apache.activemq.artemis.api.core.UDPBroadcastEndpointFactory;\n+import org.apache.activemq.artemis.api.core.client.ActiveMQClient;\n+import org.apache.activemq.artemis.api.core.client.ClientSession;\n+import org.apache.activemq.artemis.api.core.client.ClientSessionFactory;\n+import org.apache.activemq.artemis.core.client.impl.ServerLocatorImpl;\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CyclicBarrier;\n+import java.util.concurrent.atomic.AtomicInteger;\n+\n public class NettyHAClientTopologyWithDiscoveryTest extends HAClientTopologyWithDiscoveryTest {\n \n    @Override\n    protected boolean isNetty() {\n       return true;\n    }\n \n+\n+\n+   @Test\n+   public void testRecoveryBadUDPWithRetry() throws Exception {", "originalCommit": "ca7144d28eaf9e23fa1bf76fdd9849374f33449c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NDE1MQ==", "url": "https://github.com/apache/activemq-artemis/pull/2994#discussion_r385754151", "bodyText": "no. the retry should fix it and it should succeed.\nThe assertion is no failures.", "author": "clebertsuconic", "createdAt": "2020-02-28T15:20:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTczNzgwNw=="}], "type": "inlineReview"}, {"oid": "a773178b72272bd5c9c7c3188e33a4478d9b5d74", "url": "https://github.com/apache/activemq-artemis/commit/a773178b72272bd5c9c7c3188e33a4478d9b5d74", "message": "review: use serialization", "committedDate": "2020-02-28T15:31:15Z", "type": "forcePushed"}, {"oid": "5270be9b874ea4c2d2a840662272e823bff89f8d", "url": "https://github.com/apache/activemq-artemis/commit/5270be9b874ea4c2d2a840662272e823bff89f8d", "message": "ARTEMIS-2637 Making UDP client discovery resilient\n\nIn case there is a hardware, firewal or any other thing making the UDP connection to go deaf\nwe will now reopen the connection in an attempt to go over possible issues.\n\nThis is also improving locking around DiscoveryGroup initial connection.", "committedDate": "2020-02-28T15:38:03Z", "type": "forcePushed"}, {"oid": "51a4d03d5739ee547c4af5909f67e9e7201239f2", "url": "https://github.com/apache/activemq-artemis/commit/51a4d03d5739ee547c4af5909f67e9e7201239f2", "message": "ARTEMIS-2637 Making UDP client discovery resilient\n\nIn case there is a hardware, firewal or any other thing making the UDP connection to go deaf\nwe will now reopen the connection in an attempt to go over possible issues.\n\nThis is also improving locking around DiscoveryGroup initial connection.", "committedDate": "2020-02-28T15:41:24Z", "type": "forcePushed"}, {"oid": "ab6a9578ae16e8f505fcc3581a5074bc3b5f2787", "url": "https://github.com/apache/activemq-artemis/commit/ab6a9578ae16e8f505fcc3581a5074bc3b5f2787", "message": "ARTEMIS-2637 Making UDP client discovery resilient\n\nIn case there is a hardware, firewal or any other thing making the UDP connection to go deaf\nwe will now reopen the connection in an attempt to go over possible issues.\n\nThis is also improving locking around DiscoveryGroup initial connection.", "committedDate": "2020-02-28T15:46:47Z", "type": "forcePushed"}, {"oid": "2cbdde38f8bd0be59f45ef8a072225c1dfa8e38d", "url": "https://github.com/apache/activemq-artemis/commit/2cbdde38f8bd0be59f45ef8a072225c1dfa8e38d", "message": "ARTEMIS-2637 Making UDP client discovery resilient\n\nIn case there is a hardware, firewal or any other thing making the UDP connection to go deaf\nwe will now reopen the connection in an attempt to go over possible issues.\n\nThis is also improving locking around DiscoveryGroup initial connection.", "committedDate": "2020-02-28T16:51:40Z", "type": "forcePushed"}, {"oid": "0cac669840d22ed6b9b89b5bdecc91f0c9d53126", "url": "https://github.com/apache/activemq-artemis/commit/0cac669840d22ed6b9b89b5bdecc91f0c9d53126", "message": "ARTEMIS-2637 Making UDP client discovery resilient\n\nIn case there is a hardware, firewal or any other thing making the UDP connection to go deaf\nwe will now reopen the connection in an attempt to go over possible issues.\n\nThis is also improving locking around DiscoveryGroup initial connection.", "committedDate": "2020-02-28T16:54:27Z", "type": "commit"}, {"oid": "0cac669840d22ed6b9b89b5bdecc91f0c9d53126", "url": "https://github.com/apache/activemq-artemis/commit/0cac669840d22ed6b9b89b5bdecc91f0c9d53126", "message": "ARTEMIS-2637 Making UDP client discovery resilient\n\nIn case there is a hardware, firewal or any other thing making the UDP connection to go deaf\nwe will now reopen the connection in an attempt to go over possible issues.\n\nThis is also improving locking around DiscoveryGroup initial connection.", "committedDate": "2020-02-28T16:54:27Z", "type": "forcePushed"}]}