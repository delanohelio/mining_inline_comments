{"pr_number": 3933, "pr_title": "Accept old trade statistic object", "pr_createdAt": "2020-02-03T09:23:11Z", "pr_url": "https://github.com/bisq-network/bisq/pull/3933", "timeline": [{"oid": "2ad279f99e77ff73e61b73dd1db10c8ec176912e", "url": "https://github.com/bisq-network/bisq/commit/2ad279f99e77ff73e61b73dd1db10c8ec176912e", "message": "Accept old trade statistic object\n\nThe code didn't handle before the use case of new trade statistic objects\ncreated by two old clients. This change make it independent of the cut off date\nand allows us at a later point to update all trade statistics objects with\ndepositTxId value of null.", "committedDate": "2020-02-03T10:37:56Z", "type": "commit"}, {"oid": "2ad279f99e77ff73e61b73dd1db10c8ec176912e", "url": "https://github.com/bisq-network/bisq/commit/2ad279f99e77ff73e61b73dd1db10c8ec176912e", "message": "Accept old trade statistic object\n\nThe code didn't handle before the use case of new trade statistic objects\ncreated by two old clients. This change make it independent of the cut off date\nand allows us at a later point to update all trade statistics objects with\ndepositTxId value of null.", "committedDate": "2020-02-03T10:37:56Z", "type": "forcePushed"}, {"oid": "112aaf99105b3f80eb8442a44f88e9a3cfd008c3", "url": "https://github.com/bisq-network/bisq/commit/112aaf99105b3f80eb8442a44f88e9a3cfd008c3", "message": "Not set depositTxId to null by default\n\nThis prevents unnecessary load on the seednodes from old clients\nloading all trade statistic objects on startup as they interpret\nthe null value as empty string", "committedDate": "2020-02-03T14:46:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDI2MjQxOQ==", "url": "https://github.com/bisq-network/bisq/pull/3933#discussion_r374262419", "bodyText": "This would leave all new trades from older clients still exposed. That's perhaps the safest way to do it. Was hoping it would be possible to keep setting it to null for new version and just not serve the old version anything. Not sure if that would break things though.", "author": "sqrrm", "createdAt": "2020-02-03T18:22:48Z", "path": "core/src/main/java/bisq/core/trade/statistics/TradeStatistics2.java", "diffHunk": "@@ -217,7 +218,7 @@ public static TradeStatistics2 fromProto(protobuf.TradeStatistics2 proto) {\n                 proto.getTradePrice(),\n                 proto.getTradeAmount(),\n                 proto.getTradeDate(),\n-                null, // We don't want to expose this anymore\n+                ProtoUtil.stringOrNullFromProto(proto.getDepositTxId()),", "originalCommit": "112aaf99105b3f80eb8442a44f88e9a3cfd008c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDU3MDIzNg==", "url": "https://github.com/bisq-network/bisq/pull/3933#discussion_r374570236", "bodyText": "Yes, you only get the additionally privacy if you update or if you trade with a peer that has already updated. I had to do it like that to prevent the unnecessary load from old clients.", "author": "ripcurlx", "createdAt": "2020-02-04T09:51:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDI2MjQxOQ=="}], "type": "inlineReview"}]}