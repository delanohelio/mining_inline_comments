{"pr_number": 4539, "pr_title": "Refactor API & add registerdisputeagent method to CLI", "pr_createdAt": "2020-09-18T14:40:16Z", "pr_url": "https://github.com/bisq-network/bisq/pull/4539", "timeline": [{"oid": "e2bd89f39a891c8b24364153a204177f37d0ccc4", "url": "https://github.com/bisq-network/bisq/commit/e2bd89f39a891c8b24364153a204177f37d0ccc4", "message": "Refactor API & add registerdisputeagent method to CLI\n\nThis commit contains most of the changes suggested by @chimp1984 in\nhis api-suggestions branch.  See\nhttps://github.com/bisq-network/bisq/commit/961703ecea62df62946ab001ec28205662688ccd\n\nA new 'registerdisputeagent' method was also added to MainCli, finishing\nthe work to support registration of mediators and refund agents on\narbitration daemons running in regtest mode.  This method cannot be\nused to register dispute agents on mainnet;  users will see an error\nmsg if they try.", "committedDate": "2020-09-18T14:33:16Z", "type": "commit"}, {"oid": "da78465fe4167f9d1b168bf15c13eb12cf4b50e4", "url": "https://github.com/bisq-network/bisq/commit/da78465fe4167f9d1b168bf15c13eb12cf4b50e4", "message": "Make grpc boilerplate classes pkg protected", "committedDate": "2020-09-18T14:46:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI3ODE2Mw==", "url": "https://github.com/bisq-network/bisq/pull/4539#discussion_r492278163", "bodyText": "Yes there is lots of extra stuff, mainly the many different payment methods with their custom requirements. Input validation, currency selection, country selection, etc...", "author": "chimp1984", "createdAt": "2020-09-21T18:56:25Z", "path": "core/src/main/java/bisq/core/api/CorePaymentAccountsService.java", "diffHunk": "@@ -49,17 +52,19 @@ public CorePaymentAccountsService(Config config,\n         this.user = user;\n     }\n \n-    public void createPaymentAccount(String accountName, String accountNumber, String fiatCurrencyCode) {\n-        // Create and persist a PerfectMoney dummy payment account.  There is no guard\n-        // against creating accounts with duplicate names & numbers, only the uuid and\n-        // creation date are unique.\n-        PaymentMethod dummyPaymentMethod = PaymentMethod.getDummyPaymentMethod(PaymentMethod.PERFECT_MONEY_ID);\n-        PaymentAccount paymentAccount = PaymentAccountFactory.getPaymentAccount(dummyPaymentMethod);\n-        paymentAccount.init();\n-        paymentAccount.setAccountName(accountName);\n-        ((PerfectMoneyAccount) paymentAccount).setAccountNr(accountNumber);\n-        paymentAccount.setSingleTradeCurrency(new FiatCurrency(fiatCurrencyCode.toUpperCase()));\n-        user.addPaymentAccount(paymentAccount);\n+    void createPaymentAccount(String paymentMethodId,\n+                              String accountName,\n+                              String accountNumber,\n+                              String currencyCode) {\n+\n+        PaymentAccount paymentAccount = getNewPaymentAccount(paymentMethodId,\n+                accountName,\n+                accountNumber,\n+                currencyCode);\n+\n+        // TODO not sure if there is more to do at account creation.", "originalCommit": "e2bd89f39a891c8b24364153a204177f37d0ccc4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}