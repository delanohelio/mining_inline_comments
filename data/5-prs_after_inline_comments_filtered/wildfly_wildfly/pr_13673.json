{"pr_number": 13673, "pr_title": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "pr_createdAt": "2020-10-23T18:41:48Z", "pr_url": "https://github.com/wildfly/wildfly/pull/13673", "timeline": [{"oid": "eb5e9f9f3a73fc7e466405febb1834c4bd3bccfc", "url": "https://github.com/wildfly/wildfly/commit/eb5e9f9f3a73fc7e466405febb1834c4bd3bccfc", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-27T14:22:50Z", "type": "forcePushed"}, {"oid": "42f425cff7e4f37c090bc4cbfc224518655611ae", "url": "https://github.com/wildfly/wildfly/commit/42f425cff7e4f37c090bc4cbfc224518655611ae", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-27T14:24:27Z", "type": "forcePushed"}, {"oid": "84d02347f8c1ab26a97697ebcb72c7bec97082f2", "url": "https://github.com/wildfly/wildfly/commit/84d02347f8c1ab26a97697ebcb72c7bec97082f2", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-29T14:33:58Z", "type": "forcePushed"}, {"oid": "d6239fca9f72eba4d268701f18380f5bb32d14b2", "url": "https://github.com/wildfly/wildfly/commit/d6239fca9f72eba4d268701f18380f5bb32d14b2", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-29T14:42:54Z", "type": "forcePushed"}, {"oid": "b9c4114ac3f18abb6af91884e635622424df2efa", "url": "https://github.com/wildfly/wildfly/commit/b9c4114ac3f18abb6af91884e635622424df2efa", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-29T14:48:58Z", "type": "forcePushed"}, {"oid": "299288f9fa42d99b853e802243b7bf20b7fc34c1", "url": "https://github.com/wildfly/wildfly/commit/299288f9fa42d99b853e802243b7bf20b7fc34c1", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-29T19:49:36Z", "type": "forcePushed"}, {"oid": "ece54777760cbd2ae80ef94c3713179546a50b40", "url": "https://github.com/wildfly/wildfly/commit/ece54777760cbd2ae80ef94c3713179546a50b40", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-30T14:43:06Z", "type": "forcePushed"}, {"oid": "10101f9b2b81ea1c7ef39956ffaa18493baafc5b", "url": "https://github.com/wildfly/wildfly/commit/10101f9b2b81ea1c7ef39956ffaa18493baafc5b", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-30T15:24:07Z", "type": "forcePushed"}, {"oid": "ed4877e4cf5e6a58d3b0f3249f73bf80548354e8", "url": "https://github.com/wildfly/wildfly/commit/ed4877e4cf5e6a58d3b0f3249f73bf80548354e8", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-11-26T20:12:16Z", "type": "forcePushed"}, {"oid": "832f5af88b82bc7c9b6c3aacb241a2cc48cec284", "url": "https://github.com/wildfly/wildfly/commit/832f5af88b82bc7c9b6c3aacb241a2cc48cec284", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-01-11T15:26:12Z", "type": "forcePushed"}, {"oid": "8f0cfbfc6102d66500d3e3caad61dc463da63f66", "url": "https://github.com/wildfly/wildfly/commit/8f0cfbfc6102d66500d3e3caad61dc463da63f66", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-02-01T15:20:50Z", "type": "forcePushed"}, {"oid": "cb35eabbb3571186854b404504edd941c8804571", "url": "https://github.com/wildfly/wildfly/commit/cb35eabbb3571186854b404504edd941c8804571", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-02-02T21:00:01Z", "type": "forcePushed"}, {"oid": "d5be418673590b46e936848fe51dbf8d9b1b2449", "url": "https://github.com/wildfly/wildfly/commit/d5be418673590b46e936848fe51dbf8d9b1b2449", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-02-04T18:58:27Z", "type": "forcePushed"}, {"oid": "a661f06bc60d00c6ded567f579e89c5fb52f9904", "url": "https://github.com/wildfly/wildfly/commit/a661f06bc60d00c6ded567f579e89c5fb52f9904", "message": "[WFLY-14835] Add @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-03T17:19:27Z", "type": "forcePushed"}, {"oid": "b101ce56b7b6a518c250d24caf85b9e5a01a1c95", "url": "https://github.com/wildfly/wildfly/commit/b101ce56b7b6a518c250d24caf85b9e5a01a1c95", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-07T19:04:50Z", "type": "forcePushed"}, {"oid": "3dc8ba615b66712954719ae3047ef68270cd25e8", "url": "https://github.com/wildfly/wildfly/commit/3dc8ba615b66712954719ae3047ef68270cd25e8", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T14:09:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzUwMDQ3MA==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r647500470", "bodyText": "This is not critical at all, but there is a TestSuiteEnvironment.isIbmJvm() or TestSuiteEvronment.isJ9Jvm() is case this is supported on OpenJ9.", "author": "jamezp", "createdAt": "2021-06-08T14:30:42Z", "path": "testsuite/integration/elytron/src/test/java/org/wildfly/test/integration/elytron/ssl/UndertowSSLv2HelloTestCase.java", "diffHunk": "@@ -0,0 +1,373 @@\n+/*\n+ * JBoss, Home of Professional Open Source.\n+ * Copyright 2020, Red Hat, Inc., and individual contributors\n+ * as indicated by the @author tags. See the copyright.txt file in the\n+ * distribution for a full listing of individual contributors.\n+ *\n+ * This is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU Lesser General Public License as\n+ * published by the Free Software Foundation; either version 2.1 of\n+ * the License, or (at your option) any later version.\n+ *\n+ * This software is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this software; if not, write to the Free\n+ * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n+ * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n+ */\n+\n+package org.wildfly.test.integration.elytron.ssl;\n+\n+import static java.security.AccessController.doPrivileged;\n+import static org.jboss.as.test.integration.security.common.SSLTruststoreUtil.HTTPS_PORT;\n+\n+import java.io.File;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.security.PrivilegedAction;\n+import java.security.Security;\n+\n+import javax.ws.rs.ProcessingException;\n+import javax.ws.rs.client.Client;\n+import javax.ws.rs.client.ClientBuilder;\n+import javax.ws.rs.core.Response;\n+\n+import org.codehaus.plexus.util.FileUtils;\n+import org.jboss.arquillian.container.test.api.Deployment;\n+import org.jboss.arquillian.container.test.api.RunAsClient;\n+import org.jboss.arquillian.junit.Arquillian;\n+import org.jboss.as.arquillian.api.ServerSetup;\n+import org.jboss.as.controller.client.ModelControllerClient;\n+import org.jboss.as.test.integration.management.util.CLIWrapper;\n+import org.jboss.as.test.integration.security.common.CoreUtils;\n+import org.jboss.as.test.integration.security.common.SecurityTestConstants;\n+import org.jboss.as.test.shared.TestSuiteEnvironment;\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.asset.StringAsset;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.junit.AfterClass;\n+import org.junit.Assert;\n+import org.junit.AssumptionViolatedException;\n+import org.junit.BeforeClass;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.rules.TestRule;\n+import org.junit.runner.Description;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.model.Statement;\n+import org.wildfly.security.auth.client.AuthenticationContext;\n+import org.wildfly.security.auth.client.ElytronXmlParser;\n+import org.wildfly.security.auth.client.InvalidAuthenticationConfigurationException;\n+import org.wildfly.test.integration.elytron.util.WelcomeContent;\n+import org.wildfly.test.security.common.AbstractElytronSetupTask;\n+import org.wildfly.test.security.common.elytron.ConfigurableElement;\n+import org.wildfly.test.security.common.elytron.CredentialReference;\n+import org.wildfly.test.security.common.elytron.Path;\n+import org.wildfly.test.security.common.elytron.SimpleKeyManager;\n+import org.wildfly.test.security.common.elytron.SimpleKeyStore;\n+import org.wildfly.test.security.common.elytron.SimpleServerSslContext;\n+import org.wildfly.test.security.common.elytron.SimpleTrustManager;\n+\n+/**\n+ * Smoke test for two way SSL connection with Undertow HTTPS listener backed by Elytron\n+ * server-ssl-context\n+ * with need-client-auth=true (client certificate is required) using SSLv2Hello.\n+ *\n+ * In case the client certificate is not trusted or present, the SSL handshake should fail.\n+ *\n+ * Additionally, smoke test for one way SSL connection with Undertow HTTPS listener\n+ * backed by Elytron server-ssl-context.\n+ *\n+ * @author Ondrej Kotek\n+ * @author Sonia Zaldana\n+ */\n+@RunWith(Arquillian.class)\n+@ServerSetup({ UndertowSSLv2HelloTestCase.ElytronSslContextInUndertowSetupTask.class, WelcomeContent.SetupTask.class})\n+@RunAsClient\n+public class UndertowSSLv2HelloTestCase {\n+\n+    private static final String NAME = UndertowTwoWaySslNeedClientAuthTestCase.class.getSimpleName();\n+    private static final File WORK_DIR = new File(\"target\" + File.separatorChar +  NAME);\n+    private static final File SERVER_KEYSTORE_FILE = new File(WORK_DIR, SecurityTestConstants.SERVER_KEYSTORE);\n+    private static final File SERVER_TRUSTSTORE_FILE = new File(WORK_DIR, SecurityTestConstants.SERVER_TRUSTSTORE);\n+    private static final String PASSWORD = SecurityTestConstants.KEYSTORE_PASSWORD;\n+    private static final String SSLV2HELLO_CONTEXT = \"SSLv2HelloContext\";\n+    private static final String DEFAULT_CONTEXT = \"DefaultContext\";\n+    private static final String SSLV2HELLO_CONTEXT_ONE_WAY = \"SSLv2HelloContextOneWay\";\n+    private static final String HTTPS = \"https\";\n+    private static URL securedRootUrl;\n+    public static String disabledAlgorithms;\n+\n+    @ClassRule\n+    public static IbmVerification ibmVerification =\n+            new IbmVerification(System.getProperty(\"java.vendor\").contains(\"IBM\"));", "originalCommit": "3dc8ba615b66712954719ae3047ef68270cd25e8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzUzNTc3Mw==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r647535773", "bodyText": "Added TestSuiteEnvironment.isIbmJvm() instead.", "author": "SoniaZaldana", "createdAt": "2021-06-08T15:07:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzUwMDQ3MA=="}], "type": "inlineReview"}, {"oid": "96352b3629834af0e8e3d4d5e3f839a4e403ce12", "url": "https://github.com/wildfly/wildfly/commit/96352b3629834af0e8e3d4d5e3f839a4e403ce12", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T15:05:11Z", "type": "forcePushed"}, {"oid": "3712cefcf4a43c2790f8cb2a0baa6d1ca028b473", "url": "https://github.com/wildfly/wildfly/commit/3712cefcf4a43c2790f8cb2a0baa6d1ca028b473", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T15:21:11Z", "type": "forcePushed"}, {"oid": "6f3d9419851a2a080cff21a136e477713b93f848", "url": "https://github.com/wildfly/wildfly/commit/6f3d9419851a2a080cff21a136e477713b93f848", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-06-08T17:41:29Z", "type": "commit"}, {"oid": "c59687d53c9aa5ccc390af612c102ff611488e55", "url": "https://github.com/wildfly/wildfly/commit/c59687d53c9aa5ccc390af612c102ff611488e55", "message": "[WFLY-14835] Add @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T17:41:29Z", "type": "commit"}, {"oid": "50f7d747183edb662647a975fac69dd63dd823f1", "url": "https://github.com/wildfly/wildfly/commit/50f7d747183edb662647a975fac69dd63dd823f1", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T17:41:29Z", "type": "forcePushed"}, {"oid": "d23461e57917395f730b8fd84ca5a8f4da322d64", "url": "https://github.com/wildfly/wildfly/commit/d23461e57917395f730b8fd84ca5a8f4da322d64", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-11T14:13:54Z", "type": "commit"}, {"oid": "d23461e57917395f730b8fd84ca5a8f4da322d64", "url": "https://github.com/wildfly/wildfly/commit/d23461e57917395f730b8fd84ca5a8f4da322d64", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-11T14:13:54Z", "type": "forcePushed"}]}