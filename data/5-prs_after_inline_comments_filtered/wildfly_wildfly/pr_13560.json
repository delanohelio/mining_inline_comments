{"pr_number": 13560, "pr_title": "WFLY-13854 WildFly cannot connect to an infinispan-server cluster req\u2026", "pr_createdAt": "2020-09-12T00:36:55Z", "pr_url": "https://github.com/wildfly/wildfly/pull/13560", "timeline": [{"oid": "384613555d9eb92c234b0b0f7323674349751175", "url": "https://github.com/wildfly/wildfly/commit/384613555d9eb92c234b0b0f7323674349751175", "message": "WFLY-13854 WildFly cannot connect to an infinispan-server cluster requiring authentication using properties", "committedDate": "2020-09-12T09:48:20Z", "type": "forcePushed"}, {"oid": "ad7bcc6b1a60f15d588153c71c6169fe0c6b3cda", "url": "https://github.com/wildfly/wildfly/commit/ad7bcc6b1a60f15d588153c71c6169fe0c6b3cda", "message": "WFLY-13854 WildFly cannot connect to an infinispan-server cluster requiring authentication using properties\n\nApply adhoc properties after formal security configuration, but before everything else. (#8)", "committedDate": "2020-09-14T19:43:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODIwOTk1MA==", "url": "https://github.com/wildfly/wildfly/pull/13560#discussion_r488209950", "bodyText": "Given that this is a map attribute, when is this value ever FALSE?\nWhy not use DiscarcAttributeChecker.UNDEFINED?", "author": "pferraro", "createdAt": "2020-09-14T20:46:36Z", "path": "clustering/infinispan/extension/src/main/java/org/jboss/as/clustering/infinispan/subsystem/remote/RemoteCacheContainerResourceDefinition.java", "diffHunk": "@@ -147,6 +156,12 @@ public static void buildTransformation(ModelVersion version, ResourceTransformat\n         } else {\n             ResourceTransformationDescriptionBuilder builder = parent.addChildResource(RemoteCacheContainerResourceDefinition.WILDCARD_PATH);\n \n+            if (InfinispanModel.VERSION_13_0_0.requiresTransformation(version)) {\n+                builder.getAttributeBuilder()\n+                        .setDiscard(new DiscardAttributeValueChecker(false, true, ModelNode.FALSE), Attribute.PROPERTIES.getDefinition())", "originalCommit": "ad7bcc6b1a60f15d588153c71c6169fe0c6b3cda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI3OTgyMA==", "url": "https://github.com/wildfly/wildfly/pull/13560#discussion_r488279820", "bodyText": "Thanks for spotting this, fixed + fixed the corresponding rejection test.", "author": "rhusar", "createdAt": "2020-09-14T22:46:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODIwOTk1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODIxMjMzMQ==", "url": "https://github.com/wildfly/wildfly/pull/13560#discussion_r488212331", "bodyText": "N.B. Once we upgrade to jboss-dmr 1.6.x, we can replace this with:\nfor (Property property : Attribute.PROPERTIES.resolveModelAttribute(context, model).asPropertyListOrEmpty())", "author": "pferraro", "createdAt": "2020-09-14T20:51:20Z", "path": "clustering/infinispan/extension/src/main/java/org/jboss/as/clustering/infinispan/subsystem/remote/RemoteCacheContainerConfigurationServiceConfigurator.java", "diffHunk": "@@ -135,6 +140,11 @@ public ServiceConfigurator configure(OperationContext context, ModelNode model)\n \n         this.server = context.hasOptionalCapability(CommonRequirement.MBEAN_SERVER.getName(), null, null) ? new ServiceSupplierDependency<>(CommonRequirement.MBEAN_SERVER.getServiceName(context)) : null;\n \n+        this.properties.clear();\n+        for (Property property : ModelNodes.optionalPropertyList(Attribute.PROPERTIES.resolveModelAttribute(context, model)).orElse(Collections.emptyList())) {", "originalCommit": "ad7bcc6b1a60f15d588153c71c6169fe0c6b3cda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI3OTk0Mw==", "url": "https://github.com/wildfly/wildfly/pull/13560#discussion_r488279943", "bodyText": "Thanks - noted and put on a list.", "author": "rhusar", "createdAt": "2020-09-14T22:46:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODIxMjMzMQ=="}], "type": "inlineReview"}, {"oid": "69cdb4acdd42e8c43414d94acf21d5e601d46358", "url": "https://github.com/wildfly/wildfly/commit/69cdb4acdd42e8c43414d94acf21d5e601d46358", "message": "WFLY-13854 WildFly cannot connect to an infinispan-server cluster requiring authentication using properties\n\nApply adhoc properties after formal security configuration, but before everything else. (#8)", "committedDate": "2020-09-14T22:45:52Z", "type": "commit"}, {"oid": "69cdb4acdd42e8c43414d94acf21d5e601d46358", "url": "https://github.com/wildfly/wildfly/commit/69cdb4acdd42e8c43414d94acf21d5e601d46358", "message": "WFLY-13854 WildFly cannot connect to an infinispan-server cluster requiring authentication using properties\n\nApply adhoc properties after formal security configuration, but before everything else. (#8)", "committedDate": "2020-09-14T22:45:52Z", "type": "forcePushed"}]}