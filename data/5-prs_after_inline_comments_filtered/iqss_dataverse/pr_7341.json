{"pr_number": 7341, "pr_title": "#7097 move dv indexing to on success in Finalize Dataset Publication Command", "pr_createdAt": "2020-10-20T18:17:16Z", "pr_url": "https://github.com/IQSS/dataverse/pull/7341", "timeline": [{"oid": "8f8ff854754831296c6656f5332e56c3f034a215", "url": "https://github.com/IQSS/dataverse/commit/8f8ff854754831296c6656f5332e56c3f034a215", "message": "#7097 move dv indexing to on success", "committedDate": "2020-10-20T17:58:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc3MDA0Nw==", "url": "https://github.com/IQSS/dataverse/pull/7341#discussion_r508770047", "bodyText": "Maybe a stupid question - but is it wrong to just \"catch (Exception e)\" in a situation like this - where we don't care why it failed/what kind of an exception it was? Does catching any exception make it more reliable potentially... or are there reasons why it should be avoided?", "author": "landreev", "createdAt": "2020-10-20T19:02:06Z", "path": "src/main/java/edu/harvard/iq/dataverse/engine/command/impl/FinalizeDatasetPublicationCommand.java", "diffHunk": "@@ -224,6 +227,20 @@ public boolean onSuccess(CommandContext ctxt, Object r) {\n             LoggingUtil.writeOnSuccessFailureLog(this, failureLogText,  dataset);\n             retVal = false;\n         }\n+        \n+        //re-indexing dataverses that have additional subjects\n+        if (!dataversesToIndex.isEmpty()){\n+            for (Dataverse dv : dataversesToIndex) {\n+                try {\n+                    Future<String> indexString = ctxt.index().indexDataverse(dv);\n+                } catch (IOException | SolrServerException e) {", "originalCommit": "8f8ff854754831296c6656f5332e56c3f034a215", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc3MzUyMg==", "url": "https://github.com/IQSS/dataverse/pull/7341#discussion_r508773522", "bodyText": "In general, but maybe not in this case, if we get an exception that is unexpected we want it to fail loudly so that we can address it in another way if necessary.", "author": "sekmiller", "createdAt": "2020-10-20T19:08:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc3MDA0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc3ODg0MA==", "url": "https://github.com/IQSS/dataverse/pull/7341#discussion_r508778840", "bodyText": "OK, makes sense.", "author": "landreev", "createdAt": "2020-10-20T19:18:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc3MDA0Nw=="}], "type": "inlineReview"}]}