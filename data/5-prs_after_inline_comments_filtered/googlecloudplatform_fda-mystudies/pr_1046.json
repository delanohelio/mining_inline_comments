{"pr_number": 1046, "pr_title": "Study Builder - Audit log Implementation for StudyQuestionnaireController with Test Cases ", "pr_createdAt": "2020-09-26T13:37:03Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046", "timeline": [{"oid": "55fa96e101d05b9b6d794128f33f6110d813fa91", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/55fa96e101d05b9b6d794128f33f6110d813fa91", "message": "audit log event implementation for StudyQuestionnaireController\n\naudit log event implementation for StudyQuestionnaireController", "committedDate": "2020-09-26T13:35:08Z", "type": "commit"}, {"oid": "1af0298c8b43f585bba90e21b1e8fe03aad6d2e3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1af0298c8b43f585bba90e21b1e8fe03aad6d2e3", "message": "Merge branch 'develop' into study-builder-audit-log-study-questionnarie-controller", "committedDate": "2020-09-28T14:06:30Z", "type": "commit"}, {"oid": "11d1c50a70c0ce3e01dc7de2d87bb05cc454d666", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/11d1c50a70c0ce3e01dc7de2d87bb05cc454d666", "message": "Merge branch 'develop' into study-builder-audit-log-study-questionnarie-controller", "committedDate": "2020-09-28T16:46:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE1NDQ0Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046#discussion_r496154447", "bodyText": "I have seen different PRs today adding and not adding an empty line between static imports. Please make sure to keep it consistent", "author": "saminguyen", "createdAt": "2020-09-28T18:35:25Z", "path": "WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyQuestionnaireController.java", "diffHunk": "@@ -1,28 +1,23 @@\n /*\n- * Copyright \u00a9 2017-2018 Harvard Pilgrim Health Care Institute (HPHCI) and its Contributors.\n- * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and\n- * associated documentation files (the \"Software\"), to deal in the Software without restriction, including\n- * without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\n- * of the Software, and to permit persons to whom the Software is furnished to do so, subject to the\n- * following conditions:\n+ * Copyright 2020 Google LLC\n  *\n- * The above copyright notice and this permission notice shall be included in all copies or substantial\n- * portions of the Software.\n- *\n- * Funding Source: Food and Drug Administration (\"Funding Agency\") effective 18 September 2014 as Contract no.\n- * HHSF22320140030I/HHSF22301006T (the \"Prime Contract\").\n- *\n- * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n- * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n- * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL\n- * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR\n- * OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n- * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n- * OTHER DEALINGS IN THE SOFTWARE.\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n  */\n \n package com.fdahpstudydesigner.controller;\n \n+import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_ACTIVE_TASK_SECTION_MARKED_COMPLETE;\n+import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_NEW_ACTIVE_TASK_CREATED;\n+import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_QUESTIONNAIRE_DELETED;\n+import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_QUESTIONNAIRE_SAVED_OR_UPDATED;\n+import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_QUESTION_STEP_IN_FORM_DELETED;\n+import static com.fdahpstudydesigner.common.StudyBuilderConstants.FORM_ID;\n+import static com.fdahpstudydesigner.common.StudyBuilderConstants.QUESTION_ID;\n+import static com.fdahpstudydesigner.common.StudyBuilderConstants.STEP_ID;\n+", "originalCommit": "11d1c50a70c0ce3e01dc7de2d87bb05cc454d666", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjYyNjQ2MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046#discussion_r496626460", "bodyText": "we are adding empty line after static imports, this is maintained in other services as well", "author": "Kantharajut-btc", "createdAt": "2020-09-29T10:58:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE1NDQ0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcwODkxOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046#discussion_r496708919", "bodyText": "Thank you.", "author": "saminguyen", "createdAt": "2020-09-29T13:18:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE1NDQ0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE2NjY3NA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046#discussion_r496166674", "bodyText": "remove commented line", "author": "saminguyen", "createdAt": "2020-09-28T18:57:54Z", "path": "WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyQuestionnaireController.java", "diffHunk": "@@ -2126,6 +2162,7 @@ public ModelAndView saveorUpdateQuestionnaireSchedule(\n           }\n         }\n       }\n+      // auditLogEventHelper.logEvent(eventEnum, auditRequest, values);", "originalCommit": "11d1c50a70c0ce3e01dc7de2d87bb05cc454d666", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjYyNTI5Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046#discussion_r496625297", "bodyText": "removed", "author": "Kantharajut-btc", "createdAt": "2020-09-29T10:56:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE2NjY3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE2NzA5Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046#discussion_r496167097", "bodyText": "remove if not needed", "author": "saminguyen", "createdAt": "2020-09-28T18:58:43Z", "path": "WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyQuestionnaireDAOImpl.java", "diffHunk": "@@ -1034,15 +1040,20 @@ public String deleteFromStepQuestion(\n         }\n         message = FdahpStudyDesignerConstants.SUCCESS;\n       }\n-      activity = \"Question of form step was deleted.\";\n+\n+      values.put(QUESTION_ID, questionId.toString());\n+      values.put(STEP_ID, formId.toString());\n+      auditLogEventHelper.logEvent(STUDY_QUESTION_STEP_DELETED, auditRequest, values);\n+\n+      /*activity = \"Question of form step was deleted.\";\n       activitydetails = \"Question of form step was deleted. (Study ID = \" + customStudyId + \")\";\n       auditLogDAO.saveToAuditLog(\n           session,\n           transaction,\n           sessionObject,\n           activity,\n           activitydetails,\n-          \"StudyQuestionnaireDAOImpl - deleteFromStepQuestion\");\n+          \"StudyQuestionnaireDAOImpl - deleteFromStepQuestion\");*/", "originalCommit": "11d1c50a70c0ce3e01dc7de2d87bb05cc454d666", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjYyNTE1OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046#discussion_r496625159", "bodyText": "removed", "author": "Kantharajut-btc", "createdAt": "2020-09-29T10:56:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE2NzA5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE2NzM4MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046#discussion_r496167380", "bodyText": "remove commented code if not needed", "author": "saminguyen", "createdAt": "2020-09-28T18:59:15Z", "path": "WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyQuestionnaireDAOImpl.java", "diffHunk": "@@ -1284,30 +1303,31 @@ public String deleteQuestionnaireStep(\n           String deleteQuery = \"delete InstructionsBo IBO where IBO.id=\" + stepId;\n           query = session.createQuery(deleteQuery);\n           query.executeUpdate();\n-          activity = FdahpStudyDesignerConstants.INSTRUCTION_ACTIVITY + \" was deleted.\";\n-          ;\n+          auditLogEventHelper.logEvent(STUDY_INSTRUCTION_STEP_DELETED, auditRequest, values);\n+          /*activity = FdahpStudyDesignerConstants.INSTRUCTION_ACTIVITY + \" was deleted.\";", "originalCommit": "11d1c50a70c0ce3e01dc7de2d87bb05cc454d666", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjYyNTA1Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1046#discussion_r496625056", "bodyText": "removed commented code", "author": "Kantharajut-btc", "createdAt": "2020-09-29T10:56:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE2NzM4MA=="}], "type": "inlineReview"}, {"oid": "4d685493b30b00797be19cc959d73de640723db9", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/4d685493b30b00797be19cc959d73de640723db9", "message": "Fixed PR comments\n\nFixed PR comments", "committedDate": "2020-09-29T06:22:13Z", "type": "commit"}, {"oid": "421b63bcef44b06ebf429efe1409413ea8b53edc", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/421b63bcef44b06ebf429efe1409413ea8b53edc", "message": "replaced event code\n\nreplaced event code", "committedDate": "2020-09-29T10:31:03Z", "type": "commit"}, {"oid": "bf16ff3bc17c386073e2b52d8f4438cb8ad5670d", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/bf16ff3bc17c386073e2b52d8f4438cb8ad5670d", "message": "Merge branch 'develop' into study-builder-audit-log-study-questionnarie-controller", "committedDate": "2020-09-29T10:47:08Z", "type": "commit"}, {"oid": "81971d22b1ae7f1cb2a19634effa5bccdd5b8a0a", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/81971d22b1ae7f1cb2a19634effa5bccdd5b8a0a", "message": "fixed test failure\n\nfixed test failure", "committedDate": "2020-09-29T10:55:14Z", "type": "commit"}]}