{"pr_number": 369, "pr_title": "Implement getPersonalizedResources controller.", "pr_createdAt": "2020-05-10T08:20:02Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/369", "timeline": [{"oid": "e5bf3117a6672427664022804acc389561ff4a93", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e5bf3117a6672427664022804acc389561ff4a93", "message": "Implement getPersonalizedResources controller.\n\nCurrently it only calls the service for getting personalized resources.\n\nSome other miscellaneous changes to support unit testing.", "committedDate": "2020-05-10T08:19:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjY2MDg0OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/369#discussion_r422660848", "bodyText": "We'll need to convert the response to the JSON format here: https://docs.google.com/document/d/1vXAktlfCCO_H3jSgYcWFUn7ANpU4YpqDUQYq4S5dr_w/edit#heading=h.o5nmdvkhhqby\nI'm fine with doing this on StudyMetaData server, but we need one more field to identify user report vs institution resources.", "author": "kuoyuchi", "createdAt": "2020-05-10T15:32:24Z", "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/UserResourceBean.java", "diffHunk": "@@ -9,10 +9,12 @@\n \n import lombok.AllArgsConstructor;\n import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n import lombok.ToString;\n \n @AllArgsConstructor\n @EqualsAndHashCode\n+@Getter\n @ToString\n public class UserResourceBean {", "originalCommit": "e5bf3117a6672427664022804acc389561ff4a93", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcwMzI1Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/369#discussion_r422703256", "bodyText": "@RestController automatically converts the returned object to JSON. It's working in my tests but we can double check on the actual server as well.\nWith respect to the resourceType field, I'm planning on checking this in now and adding the field later once we add the call to the institution resources service.", "author": "karepker", "createdAt": "2020-05-10T21:31:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjY2MDg0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjY2NzY2OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/369#discussion_r422667668", "bodyText": "Does this work for you? I was consistently getting nullptr exceptions when trying to wire into this class: https://stackoverflow.com/questions/32494398/unable-to-autowire-the-service-inside-my-authentication-filter-in-spring\nI see that you changed the AuthenticationFilter to be Autowired in the BeanConfig class so that may have been what I was missing. Can you still double check when running the actual service that we don't crash in the filter?", "author": "wamills", "createdAt": "2020-05-10T16:30:25Z", "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/util/AuthenticationFilter.java", "diffHunk": "@@ -32,6 +33,9 @@\n \n   private static Logger logger = LoggerFactory.getLogger(AuthenticationFilter.class);\n \n+  @Autowired private ApplicationPropertyConfiguration applicationConfiguration;", "originalCommit": "e5bf3117a6672427664022804acc389561ff4a93", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjY2OTY0Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/369#discussion_r422669646", "bodyText": "https://amber-external-review.googlesource.com/c/fda-mystudies/+/3520/2/user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/util/AuthenticationFilter.java\nJust a pointer for how I set it up on some stuff we didn't need to submit yet. I think if what you have works that your setup is better though.", "author": "wamills", "createdAt": "2020-05-10T16:47:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjY2NzY2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcwNDMxNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/369#discussion_r422704316", "bodyText": "I ran into NullPtrException issues in unit tests. @Autowired fixed them and I think is the right way to do things in general.\nI haven't checked on an actual server, but I'll do that before I check this in.", "author": "karepker", "createdAt": "2020-05-10T21:41:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjY2NzY2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxMDgwNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/369#discussion_r422710804", "bodyText": "I brought up a local user mgmt server and sent a query against /getPersonalizedResources and got back unauthorized, so I'm relatively sure that AuthenticationFilter is working correctly with my changes.", "author": "karepker", "createdAt": "2020-05-10T22:41:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjY2NzY2OA=="}], "type": "inlineReview"}, {"oid": "f62ba4dacc1def404ef92e9c8e0a06d5225909e5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f62ba4dacc1def404ef92e9c8e0a06d5225909e5", "message": "Merge branch 'early-access' into karepker-resources-controller", "committedDate": "2020-05-10T22:42:12Z", "type": "commit"}, {"oid": "03ff135507cf5e22d405625b6e1d9b6e4be528e3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/03ff135507cf5e22d405625b6e1d9b6e4be528e3", "message": "Get rid of (now-)duplicated @Getter annotation.", "committedDate": "2020-05-10T22:52:06Z", "type": "commit"}]}