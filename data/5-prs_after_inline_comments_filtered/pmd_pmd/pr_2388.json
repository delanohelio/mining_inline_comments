{"pr_number": 2388, "pr_title": "[lang-test] Use tree dumps for regression tests", "pr_createdAt": "2020-03-28T17:01:58Z", "pr_url": "https://github.com/pmd/pmd/pull/2388", "timeline": [{"oid": "bb92044a1569c6744257927ff3bd27d79ee2ae2b", "url": "https://github.com/pmd/pmd/commit/bb92044a1569c6744257927ff3bd27d79ee2ae2b", "message": "Add ability to test an AST dump as cheap regression test", "committedDate": "2020-03-28T16:46:32Z", "type": "commit"}, {"oid": "c83790fab5473eae7bc0521f41afd6524984e921", "url": "https://github.com/pmd/pmd/commit/c83790fab5473eae7bc0521f41afd6524984e921", "message": "Recycle tree printer from the designer", "committedDate": "2020-03-28T16:46:33Z", "type": "commit"}, {"oid": "09ddc628cdc3435586294fec39ed5716be7e321f", "url": "https://github.com/pmd/pmd/commit/09ddc628cdc3435586294fec39ed5716be7e321f", "message": "Fix reference files", "committedDate": "2020-03-28T16:46:33Z", "type": "commit"}, {"oid": "89cddd8aa8991d15b61f1e9d904656be8b1f2d94", "url": "https://github.com/pmd/pmd/commit/89cddd8aa8991d15b61f1e9d904656be8b1f2d94", "message": "Use parsing helper", "committedDate": "2020-03-28T16:46:33Z", "type": "commit"}, {"oid": "f36835638fd3fa17dc15d196f785524f5f6ac211", "url": "https://github.com/pmd/pmd/commit/f36835638fd3fa17dc15d196f785524f5f6ac211", "message": "Add some scala tests", "committedDate": "2020-03-28T16:46:33Z", "type": "commit"}, {"oid": "e89c54fcf9df1e2730e6dde608975889d9e8bc2f", "url": "https://github.com/pmd/pmd/commit/e89c54fcf9df1e2730e6dde608975889d9e8bc2f", "message": "Cleanup", "committedDate": "2020-03-28T17:01:32Z", "type": "commit"}, {"oid": "e84349531b2c8cd0d5614036ba7e05bed0b77804", "url": "https://github.com/pmd/pmd/commit/e84349531b2c8cd0d5614036ba7e05bed0b77804", "message": "Normalize line endings", "committedDate": "2020-03-29T07:17:49Z", "type": "commit"}, {"oid": "5cbfdfdd9904b688511585614a18f8b319ff9365", "url": "https://github.com/pmd/pmd/commit/5cbfdfdd9904b688511585614a18f8b319ff9365", "message": "Use ascii printer for tree dumps\n\nSome environments may not display\nthe structure correctly otherwise. See\neg https://travis-ci.org/github/pmd/pmd/jobs/668122788#L9312-L9322", "committedDate": "2020-03-29T07:21:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA2MTA2NQ==", "url": "https://github.com/pmd/pmd/pull/2388#discussion_r407061065", "bodyText": "I think, now that this class is in pmd-core, we can remove it from pmd-designer, don't we?", "author": "adangel", "createdAt": "2020-04-11T12:57:44Z", "path": "pmd-core/src/main/java/net/sourceforge/pmd/util/treeexport/TextTreeRenderer.java", "diffHunk": "@@ -0,0 +1,210 @@\n+/*\n+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html\n+ */\n+\n+package net.sourceforge.pmd.util.treeexport;\n+\n+import java.io.IOException;\n+\n+import net.sourceforge.pmd.annotation.Experimental;\n+import net.sourceforge.pmd.lang.ast.Node;\n+import net.sourceforge.pmd.properties.AbstractPropertySource;\n+import net.sourceforge.pmd.properties.PropertyDescriptor;\n+import net.sourceforge.pmd.properties.PropertyFactory;\n+import net.sourceforge.pmd.properties.PropertySource;\n+\n+/**\n+ * A simple recursive printer. Output looks like so:\n+ *\n+ * <pre>\n+ *\n+ * +- LocalVariableDeclaration\n+ *    +- Type\n+ *    |  +- PrimitiveType\n+ *    +- VariableDeclarator\n+ *       +- VariableDeclaratorId\n+ *       +- VariableInitializer\n+ *          +- 1 child not shown\n+ *\n+ * </pre>\n+ *\n+ * or\n+ *\n+ * <pre>\n+ *\n+ * \u2514\u2500 LocalVariableDeclaration\n+ *    \u251c\u2500 Type\n+ *    \u2502  \u2514\u2500 PrimitiveType\n+ *    \u2514\u2500 VariableDeclarator\n+ *       \u251c\u2500 VariableDeclaratorId\n+ *       \u2514\u2500 VariableInitializer\n+ *          \u2514\u2500 1 child not shown\n+ *\n+ * </pre>\n+ *\n+ *\n+ * By default just prints the structure, like shown above. You can\n+ * configure it to render nodes differently by overriding {@link #appendNodeInfoLn(Appendable, Node)}.\n+ */\n+@Experimental\n+public class TextTreeRenderer implements TreeRenderer {", "originalCommit": "5cbfdfdd9904b688511585614a18f8b319ff9365", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEwMjU4MA==", "url": "https://github.com/pmd/pmd/pull/2388#discussion_r407102580", "bodyText": "Yes, but we can only do this for the designer release that will depend on this pmd-core. Maybe we should already start a development branch of the designer that depends on the snapshot version, which will also be useful with #2363", "author": "oowekyala", "createdAt": "2020-04-11T19:38:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA2MTA2NQ=="}], "type": "inlineReview"}]}