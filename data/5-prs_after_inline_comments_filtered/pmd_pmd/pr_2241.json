{"pr_number": 2241, "pr_title": "[core] Simplify metrics framework", "pr_createdAt": "2020-01-19T11:58:17Z", "pr_url": "https://github.com/pmd/pmd/pull/2241", "timeline": [{"oid": "84b59c335058766d41b2b2f6cc05e265124cf97f", "url": "https://github.com/pmd/pmd/commit/84b59c335058766d41b2b2f6cc05e265124cf97f", "message": "Add DataMap on Node", "committedDate": "2020-01-19T09:54:50Z", "type": "commit"}, {"oid": "2123ab3d5d7dcfc867ada3af119c3d3e9cb6183e", "url": "https://github.com/pmd/pmd/commit/2123ab3d5d7dcfc867ada3af119c3d3e9cb6183e", "message": "Simplify metrics framework", "committedDate": "2020-01-19T11:35:55Z", "type": "commit"}, {"oid": "f282a3ad5c8da5fb37a1a9d9cecb3bd164b79980", "url": "https://github.com/pmd/pmd/commit/f282a3ad5c8da5fb37a1a9d9cecb3bd164b79980", "message": "Move metric providers back into language handlers\n\nReverts part of #2231", "committedDate": "2020-01-19T11:47:47Z", "type": "commit"}, {"oid": "b707e6e9ffe3d86f60d0448aa7883548b1437566", "url": "https://github.com/pmd/pmd/commit/b707e6e9ffe3d86f60d0448aa7883548b1437566", "message": "Fix caching\n\nNon supported nodes produce NaN which is\nconverted to zero when converting to int", "committedDate": "2020-01-19T12:04:22Z", "type": "commit"}, {"oid": "f87fc16ed3ec18ae4f31fb181258e95f134ceab9", "url": "https://github.com/pmd/pmd/commit/f87fc16ed3ec18ae4f31fb181258e95f134ceab9", "message": "Fix tests\n\nThe tests were wrong, so this changeset\nactually fixes a bug in metrics", "committedDate": "2020-01-19T14:10:30Z", "type": "commit"}, {"oid": "f576bc561a0b553f860494a1fabdcd7a8c2ee54c", "url": "https://github.com/pmd/pmd/commit/f576bc561a0b553f860494a1fabdcd7a8c2ee54c", "message": "checkstyle", "committedDate": "2020-01-19T15:13:02Z", "type": "commit"}, {"oid": "055ae4abf0aa4d87437c58b692ddd06204556f59", "url": "https://github.com/pmd/pmd/commit/055ae4abf0aa4d87437c58b692ddd06204556f59", "message": "Checkstyle", "committedDate": "2020-01-19T23:57:45Z", "type": "commit"}, {"oid": "8fe0fe8bc7dd166f5ca894ea36642376aae83a10", "url": "https://github.com/pmd/pmd/commit/8fe0fe8bc7dd166f5ca894ea36642376aae83a10", "message": "Update documentation", "committedDate": "2020-01-20T20:25:04Z", "type": "commit"}, {"oid": "08544a7539624689f235042892ee7e17105deb1e", "url": "https://github.com/pmd/pmd/commit/08544a7539624689f235042892ee7e17105deb1e", "message": "Throw on metric not supported", "committedDate": "2020-01-20T20:54:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg4ODMyNQ==", "url": "https://github.com/pmd/pmd/pull/2241#discussion_r379888325", "bodyText": "I think, POOL needs to be a concurrent map, otherwise there might be a chance, that we create two instances for the same... I'll change that before merging", "author": "adangel", "createdAt": "2020-02-16T09:23:36Z", "path": "pmd-core/src/main/java/net/sourceforge/pmd/lang/metrics/ParameterizedMetricKey.java", "diffHunk": "@@ -65,6 +70,7 @@ public int hashCode() {\n      */\n     @SuppressWarnings(\"PMD.SingletonClassReturningNewInstance\")\n     public static <N extends Node> ParameterizedMetricKey<N> getInstance(MetricKey<N> key, MetricOptions options) {\n+        // sharing instances allows using DataMap, which uses reference identity", "originalCommit": "08544a7539624689f235042892ee7e17105deb1e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}