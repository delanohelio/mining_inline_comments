{"pr_number": 2601, "pr_title": "[java] Rewrite symbol table", "pr_createdAt": "2020-06-18T15:01:00Z", "pr_url": "https://github.com/pmd/pmd/pull/2601", "timeline": [{"oid": "0b7b397c8adb5ff49fb905e940e4c00f802701e6", "url": "https://github.com/pmd/pmd/commit/0b7b397c8adb5ff49fb905e940e4c00f802701e6", "message": "Make PMultimap type", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "480ee17847bef09f7e93a84ed3b8cb18f489267c", "url": "https://github.com/pmd/pmd/commit/480ee17847bef09f7e93a84ed3b8cb18f489267c", "message": "Make shadowGroup", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "4de86bd9a4db15fec00ea7301fd7f8293864368c", "url": "https://github.com/pmd/pmd/commit/4de86bd9a4db15fec00ea7301fd7f8293864368c", "message": "Make a few utilities to replace import tables", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "3d2899005f85c431714dcf03ec9caa678405b011", "url": "https://github.com/pmd/pmd/commit/3d2899005f85c431714dcf03ec9caa678405b011", "message": "Replace other tables", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "eaecefe404627dd800b10d852f93985307d3768b", "url": "https://github.com/pmd/pmd/commit/eaecefe404627dd800b10d852f93985307d3768b", "message": "Cleanup", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "1db3537fa34bdf8c4c459c8e074295e09ea404c3", "url": "https://github.com/pmd/pmd/commit/1db3537fa34bdf8c4c459c8e074295e09ea404c3", "message": "Compat with old impl", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "691fced420bfef100765995c3060b1b960f45694", "url": "https://github.com/pmd/pmd/commit/691fced420bfef100765995c3060b1b960f45694", "message": "Fix rebase", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "c32dba700463f19b54c3e24e7e87e3b81a7a1983", "url": "https://github.com/pmd/pmd/commit/c32dba700463f19b54c3e24e7e87e3b81a7a1983", "message": "Checkout newer sym table from typeres branch", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "672718c752a66cd85760a997a4f6e3d2f79f6dbb", "url": "https://github.com/pmd/pmd/commit/672718c752a66cd85760a997a4f6e3d2f79f6dbb", "message": "Port", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "fcb2bf6ae58df7b561a72ecfe2429aab32767271", "url": "https://github.com/pmd/pmd/commit/fcb2bf6ae58df7b561a72ecfe2429aab32767271", "message": "Checkout tests", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "0cd4469746328bb094eebcb8819eb50fe5d9ec5c", "url": "https://github.com/pmd/pmd/commit/0cd4469746328bb094eebcb8819eb50fe5d9ec5c", "message": "Port tests, remove old impl", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "41b0713a72d674de68da8e3766508c237397171e", "url": "https://github.com/pmd/pmd/commit/41b0713a72d674de68da8e3766508c237397171e", "message": "Extract augment function", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "536eab300c3ef6ac09fc56bf3ac480c4e2cd7cc7", "url": "https://github.com/pmd/pmd/commit/536eab300c3ef6ac09fc56bf3ac480c4e2cd7cc7", "message": "Move classes back into internal package", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "57ab1e4933325088f99759f1a139b976e121ea26", "url": "https://github.com/pmd/pmd/commit/57ab1e4933325088f99759f1a139b976e121ea26", "message": "Abstract stuff away for pmd-core", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "c4ffa795f4d52c1e0d782ace19cc3e22dfed3eea", "url": "https://github.com/pmd/pmd/commit/c4ffa795f4d52c1e0d782ace19cc3e22dfed3eea", "message": "Optimise singular map case even more", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "849d6dd91f6ecc7c0a280dc5309985584e2eba71", "url": "https://github.com/pmd/pmd/commit/849d6dd91f6ecc7c0a280dc5309985584e2eba71", "message": "Fix nextShadowGroup WIP", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "5606d387a7d55479b19763a896d8da16baabd45f", "url": "https://github.com/pmd/pmd/commit/5606d387a7d55479b19763a896d8da16baabd45f", "message": "Make ShadowIterator to replace getNextGroup", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "7bf9554570610c4f602c9b50771c1e8bdf9791d7", "url": "https://github.com/pmd/pmd/commit/7bf9554570610c4f602c9b50771c1e8bdf9791d7", "message": "Use chain iterator", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "bac76fc16ce2648ab94c5ea5e257043a82530d32", "url": "https://github.com/pmd/pmd/commit/bac76fc16ce2648ab94c5ea5e257043a82530d32", "message": "Add tests", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "46da94c9150460440498d3fea89e854986292457", "url": "https://github.com/pmd/pmd/commit/46da94c9150460440498d3fea89e854986292457", "message": "Specify tests for ambiguity\n\nTODO implement", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "eb976a1de2a12515c35c08b03053e81eec1dafbe", "url": "https://github.com/pmd/pmd/commit/eb976a1de2a12515c35c08b03053e81eec1dafbe", "message": "Finish impl", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "563037275002b7c6d2639c6df0b45544fcda34fb", "url": "https://github.com/pmd/pmd/commit/563037275002b7c6d2639c6df0b45544fcda34fb", "message": "Add tests for supertype enumerator", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "841fd6b1ba04659d504735003611977c93d797f8", "url": "https://github.com/pmd/pmd/commit/841fd6b1ba04659d504735003611977c93d797f8", "message": "Add tests for method shadowing in imports", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "5134a33d21baaff1e9771f1c35b3893705f3f2cc", "url": "https://github.com/pmd/pmd/commit/5134a33d21baaff1e9771f1c35b3893705f3f2cc", "message": "Object methods should be in scope in interfaces", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "1b48125eb3941db5e4ae232775c760c5bf74a7c6", "url": "https://github.com/pmd/pmd/commit/1b48125eb3941db5e4ae232775c760c5bf74a7c6", "message": "Doc", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "ab9ec47aafe1da50302be8f89019e278ae21f3d7", "url": "https://github.com/pmd/pmd/commit/ab9ec47aafe1da50302be8f89019e278ae21f3d7", "message": "Change the name", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "a5856e75a4f9c8185e51ba9c3d998c7b3f9c5e44", "url": "https://github.com/pmd/pmd/commit/a5856e75a4f9c8185e51ba9c3d998c7b3f9c5e44", "message": "Doc", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "134c760e28ebe32571826f80faae448f4d999ce4", "url": "https://github.com/pmd/pmd/commit/134c760e28ebe32571826f80faae448f4d999ce4", "message": "Split API", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "e43eeeaa2ef43895780e7672dd70af16a49b1f40", "url": "https://github.com/pmd/pmd/commit/e43eeeaa2ef43895780e7672dd70af16a49b1f40", "message": "Remove recursion guard", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "54c0b994a500f3cb3a34e45f8b2b96d56ede43e7", "url": "https://github.com/pmd/pmd/commit/54c0b994a500f3cb3a34e45f8b2b96d56ede43e7", "message": "Move ConsList into pmd-core", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "4d75f64a8eef9aa1e4018dc2abaf129661bce483", "url": "https://github.com/pmd/pmd/commit/4d75f64a8eef9aa1e4018dc2abaf129661bce483", "message": "Prune more empty nodes", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "43a60c0f8913057154ae757d57995b8a26e17466", "url": "https://github.com/pmd/pmd/commit/43a60c0f8913057154ae757d57995b8a26e17466", "message": "Fix bug with shadow iterator", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "a520d1df3fc702ff43798aec3fc18250f63bfb06", "url": "https://github.com/pmd/pmd/commit/a520d1df3fc702ff43798aec3fc18250f63bfb06", "message": "Move ScopeInfo into published package", "committedDate": "2020-06-18T14:53:34Z", "type": "commit"}, {"oid": "36c9e97cde89b457a0732e015b9058243a6b4e3e", "url": "https://github.com/pmd/pmd/commit/36c9e97cde89b457a0732e015b9058243a6b4e3e", "message": "Fix socping", "committedDate": "2020-06-18T14:53:35Z", "type": "commit"}, {"oid": "2deef0bc287ae828cacc9ddd3a4898fe3649b4a9", "url": "https://github.com/pmd/pmd/commit/2deef0bc287ae828cacc9ddd3a4898fe3649b4a9", "message": "Make disambiguation handle inherited types", "committedDate": "2020-06-18T14:53:35Z", "type": "commit"}, {"oid": "a7db7824cd920ccb60cd41022503606aa9008cd2", "url": "https://github.com/pmd/pmd/commit/a7db7824cd920ccb60cd41022503606aa9008cd2", "message": "Fix context accessibility", "committedDate": "2020-06-18T14:53:35Z", "type": "commit"}, {"oid": "a7051c4e37a1bc0540121b3f5f5f3aabf6c0f844", "url": "https://github.com/pmd/pmd/commit/a7051c4e37a1bc0540121b3f5f5f3aabf6c0f844", "message": "Report ambiguity errors", "committedDate": "2020-06-18T14:53:35Z", "type": "commit"}, {"oid": "268a3e45295089b10992fdeb57371870362136a4", "url": "https://github.com/pmd/pmd/commit/268a3e45295089b10992fdeb57371870362136a4", "message": "PMD violation", "committedDate": "2020-06-18T14:53:35Z", "type": "commit"}, {"oid": "8f0b62f46d6fb5119026ce465772ac76e5bdb017", "url": "https://github.com/pmd/pmd/commit/8f0b62f46d6fb5119026ce465772ac76e5bdb017", "message": "Cleanup pcollections dependency", "committedDate": "2020-06-18T14:53:35Z", "type": "commit"}, {"oid": "9054303b4b7ae1a6a5cf0a1321b200abcbab49d5", "url": "https://github.com/pmd/pmd/commit/9054303b4b7ae1a6a5cf0a1321b200abcbab49d5", "message": "doc", "committedDate": "2020-06-18T14:53:35Z", "type": "commit"}, {"oid": "ad6c976898880506bad73e3f9464f26436adf2ff", "url": "https://github.com/pmd/pmd/commit/ad6c976898880506bad73e3f9464f26436adf2ff", "message": "Merge branch 'java-grammar' into sym-optimize-symtables", "committedDate": "2020-07-06T11:41:45Z", "type": "commit"}, {"oid": "c4c9ef37a196999ccfc80686a86a268e3c2057dd", "url": "https://github.com/pmd/pmd/commit/c4c9ef37a196999ccfc80686a86a268e3c2057dd", "message": "Remove duplicate pcollection dep", "committedDate": "2020-07-06T11:47:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkyNzczNA==", "url": "https://github.com/pmd/pmd/pull/2601#discussion_r456927734", "bodyText": "Should this be public? It sounds like an implementation helper....\nHm... seems to be used in the shadow chain API. Any reason, why you didn't use Optional<Boolean> instead?", "author": "adangel", "createdAt": "2020-07-19T16:24:51Z", "path": "pmd-core/src/main/java/net/sourceforge/pmd/util/OptionalBool.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html\n+ */\n+\n+package net.sourceforge.pmd.util;\n+\n+/** Represents a boolean that may not be present. Use as a non-null type. */\n+public enum OptionalBool {", "originalCommit": "c4c9ef37a196999ccfc80686a86a268e3c2057dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkzNjYzMQ==", "url": "https://github.com/pmd/pmd/pull/2601#discussion_r456936631", "bodyText": "Hm... seems to be used in the shadow chain API.\n\nIt's also used in some parts of the upcoming typeres API too. It's a common pattern I think, one that is sometimes replaced with a nullable boxed Boolean, which I think is... meh\n\nAny reason, why you didn't use Optional instead?\n\nAll three values are known and there's no need to create a new optional every time", "author": "oowekyala", "createdAt": "2020-07-19T17:56:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkyNzczNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkyODM1OA==", "url": "https://github.com/pmd/pmd/pull/2601#discussion_r456928358", "bodyText": "the package name \"coreimpl\" sounds a bit unusual. That's the part, you made independent of pmd-java and could potentially be moved to core, right?\nMaybe we should rename the sub-package with something like \"shadow\" or \"nameshadow\" or so... or maybe something with \"hierarchy\" in it?", "author": "adangel", "createdAt": "2020-07-19T16:30:55Z", "path": "pmd-java/src/main/java/net/sourceforge/pmd/lang/java/symbols/table/coreimpl/CachingShadowChainNode.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html\n+ */\n+\n+package net.sourceforge.pmd.lang.java.symbols.table.coreimpl;", "originalCommit": "c4c9ef37a196999ccfc80686a86a268e3c2057dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkzNjg0Ng==", "url": "https://github.com/pmd/pmd/pull/2601#discussion_r456936846", "bodyText": "That's the part, you made independent of pmd-java and could potentially be moved to core, right?\n\nIndeed, which is why the packaging is a bit awkward... Maybe chain would be a better name?\nShadowChain is a bit awkward, but I wanted to avoid the name clash with the current Scope classes we have. I think in a world where Scope doesn't exist, ShadowChain could be renamed to ScopeChain, and placed eg in the package nspmd.symbols.scopes?", "author": "oowekyala", "createdAt": "2020-07-19T17:58:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkyODM1OA=="}], "type": "inlineReview"}]}