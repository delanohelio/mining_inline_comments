{"pr_number": 1025, "pr_title": "feat(rest/ui): Project vulnerability endpoint update & added new project rating in UI", "pr_createdAt": "2020-10-22T07:13:12Z", "pr_url": "https://github.com/eclipse/sw360/pull/1025", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA0NDgzNQ==", "url": "https://github.com/eclipse/sw360/pull/1025#discussion_r510044835", "bodyText": "Remove unused inport", "author": "JaideepPalit", "createdAt": "2020-10-22T10:15:01Z", "path": "rest/resource-server/src/main/java/org/eclipse/sw360/rest/resourceserver/project/ProjectController.java", "diffHunk": "@@ -14,6 +14,7 @@\n import lombok.NonNull;\n import lombok.RequiredArgsConstructor;\n import org.apache.commons.lang.StringUtils;\n+import org.apache.http.HttpEntity;", "originalCommit": "bc2c1a70e0d6a1800f204f5b3ac7adb0805d54fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcwNTUwNA==", "url": "https://github.com/eclipse/sw360/pull/1025#discussion_r510705504", "bodyText": "Removed it", "author": "smrutis1", "createdAt": "2020-10-23T08:01:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA0NDgzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEwOTYzMA==", "url": "https://github.com/eclipse/sw360/pull/1025#discussion_r510109630", "bodyText": "Maybe CommonUtils.isNullOrEmptyCollection() can be used", "author": "JaideepPalit", "createdAt": "2020-10-22T12:11:56Z", "path": "rest/resource-server/src/main/java/org/eclipse/sw360/rest/resourceserver/vulnerability/Sw360VulnerabilityService.java", "diffHunk": "@@ -88,4 +95,52 @@ public Vulnerability getVulnerabilityWithReleaseRelationsByExternalId(String ext\n         TProtocol protocol = new TCompactProtocol(thriftClient);\n         return new VulnerabilityService.Client(protocol);\n     }\n+\n+    public RequestStatus updateProjectVulnerabilityRating(ProjectVulnerabilityRating projVulRatings, User sw360User) {\n+        try {\n+            VulnerabilityService.Iface sw360VulnerabilityClient = getThriftVulnerabilityClient();\n+            return sw360VulnerabilityClient.updateProjectVulnerabilityRating(projVulRatings, sw360User);\n+        } catch (TException e) {\n+            throw new RuntimeException(e);\n+        }\n+    }\n+\n+    public List<ProjectVulnerabilityRating> getProjectVulnerabilityRatingByProjectId(String projectId, User sw360User) {\n+        try {\n+            VulnerabilityService.Iface sw360VulnerabilityClient = getThriftVulnerabilityClient();\n+            return sw360VulnerabilityClient.getProjectVulnerabilityRatingByProjectId(projectId, sw360User);\n+        } catch (TException e) {\n+            throw new RuntimeException(e);\n+        }\n+    }\n+\n+    public Map<String, Map<String, VulnerabilityRatingForProject>> fillVulnerabilityMetadata(VulnerabilityDTO vulnDto,\n+            Optional<ProjectVulnerabilityRating> projectVulnerabilityRating) {\n+        Map<String, Map<String, List<VulnerabilityCheckStatus>>> vulnerabilityIdToStatusHistory = projectVulnerabilityRating\n+                .map(ProjectVulnerabilityRating::getVulnerabilityIdToReleaseIdToStatus).orElseGet(HashMap::new);\n+\n+        Map<String, Map<String, VulnerabilityRatingForProject>> vulnerabilityRatings = new HashMap<>();\n+\n+        String vulnerabilityId = vulnDto.getExternalId();\n+        String releaseId = vulnDto.getIntReleaseId();\n+        if (!vulnerabilityRatings.containsKey(vulnerabilityId)) {\n+            vulnerabilityRatings.put(vulnerabilityId, new HashMap<>());\n+        }\n+        List<VulnerabilityCheckStatus> vulnerabilityCheckStatusHistory = null;\n+        if (vulnerabilityIdToStatusHistory.containsKey(vulnerabilityId)\n+                && vulnerabilityIdToStatusHistory.get(vulnerabilityId).containsKey(releaseId)) {\n+            vulnerabilityCheckStatusHistory = vulnerabilityIdToStatusHistory.get(vulnerabilityId).get(releaseId);\n+        }\n+        if (vulnerabilityCheckStatusHistory != null && vulnerabilityCheckStatusHistory.size() > 0) {", "originalCommit": "bc2c1a70e0d6a1800f204f5b3ac7adb0805d54fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcwNTg5MQ==", "url": "https://github.com/eclipse/sw360/pull/1025#discussion_r510705891", "bodyText": "Used isNotEmpty(_) one", "author": "smrutis1", "createdAt": "2020-10-23T08:02:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEwOTYzMA=="}], "type": "inlineReview"}, {"oid": "7e80d6a55db536701247b117f61289f49d72e1c9", "url": "https://github.com/eclipse/sw360/commit/7e80d6a55db536701247b117f61289f49d72e1c9", "message": "feat(rest/ui): Project vulnerability enpoint update & added new projectrating in UI\n\nSigned-off-by: Smruti Prakash Sahoo <smruti.sahoo@siemens.com>", "committedDate": "2020-10-23T07:58:01Z", "type": "forcePushed"}, {"oid": "a2577cf07395f3d455eb3fb9115664b5a9cd912c", "url": "https://github.com/eclipse/sw360/commit/a2577cf07395f3d455eb3fb9115664b5a9cd912c", "message": "feat(rest/ui): Project vulnerability enpoint update & added new projectrating in UI\n\nSigned-off-by: Smruti Prakash Sahoo <smruti.sahoo@siemens.com>", "committedDate": "2020-10-23T10:55:27Z", "type": "commit"}, {"oid": "a2577cf07395f3d455eb3fb9115664b5a9cd912c", "url": "https://github.com/eclipse/sw360/commit/a2577cf07395f3d455eb3fb9115664b5a9cd912c", "message": "feat(rest/ui): Project vulnerability enpoint update & added new projectrating in UI\n\nSigned-off-by: Smruti Prakash Sahoo <smruti.sahoo@siemens.com>", "committedDate": "2020-10-23T10:55:27Z", "type": "forcePushed"}]}