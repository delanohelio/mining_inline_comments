{"pr_number": 1849, "pr_title": "Expose read function", "pr_createdAt": "2020-01-10T13:27:34Z", "pr_url": "https://github.com/hazelcast/hazelcast-jet/pull/1849", "timeline": [{"oid": "0d6945282ba37c97dfb516bb28e51cab9c0108b2", "url": "https://github.com/hazelcast/hazelcast-jet/commit/0d6945282ba37c97dfb516bb28e51cab9c0108b2", "message": "#1772 Expose readFileFn from SourcesProcessors", "committedDate": "2020-01-09T15:50:15Z", "type": "commit"}, {"oid": "07297045404a1311ed56220ee3fdeba72c474d6c", "url": "https://github.com/hazelcast/hazelcast-jet/commit/07297045404a1311ed56220ee3fdeba72c474d6c", "message": "#1772 Expose readFileFn from S3 Source", "committedDate": "2020-01-10T13:27:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTI0NzA3NA==", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1849#discussion_r365247074", "bodyText": "does it make sense that if you want to provide a mapping, you also have to implement reading the files?", "author": "cangencer", "createdAt": "2020-01-10T14:02:50Z", "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/pipeline/FileSourceBuilder.java", "diffHunk": "@@ -107,13 +111,17 @@ public FileSourceBuilder charset(@Nonnull Charset charset) {\n      * The default local parallelism for this processor is 2 (or 1 if just 1\n      * CPU is available).\n      *\n+     * @param readFileFn the function which reads line and emits immediate items from it.\n+     *                   Gets file {@code Path} as parameter and returns Stream of immediate items.\n      * @param mapOutputFn the function which creates output object from each\n      *                    line. Gets the filename and line as parameters\n+     * @param <I> the type of immediate items returned from file reading\n      * @param <T> the type of the items the source emits\n      */\n-    public <T> BatchSource<T> build(BiFunctionEx<String, String, ? extends T> mapOutputFn) {\n+    public <I, T> BatchSource<T> build(@Nonnull FunctionEx<? super Path, ? extends Stream<I>> readFileFn,", "originalCommit": "07297045404a1311ed56220ee3fdeba72c474d6c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTI1NTg3OQ==", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1849#discussion_r365255879", "bodyText": "I've left it for consistency with other methods. I don't see any specific benefit except user having some generic enrichment functions (which can be used inside readFileFn, so that's not a super-important argument)", "author": "TomaszGaweda", "createdAt": "2020-01-10T14:22:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTI0NzA3NA=="}], "type": "inlineReview"}, {"oid": "75129a615fe6bf60c57e4cfb850c178c03b38af2", "url": "https://github.com/hazelcast/hazelcast-jet/commit/75129a615fe6bf60c57e4cfb850c178c03b38af2", "message": "#1772 Expose readFileFn from SourcesProcessors", "committedDate": "2020-01-10T14:17:11Z", "type": "commit"}, {"oid": "e3593016274088734e0ae1f21984a6c5e76cee88", "url": "https://github.com/hazelcast/hazelcast-jet/commit/e3593016274088734e0ae1f21984a6c5e76cee88", "message": "#1772 Expose readFileFn from S3 Source", "committedDate": "2020-01-10T14:17:11Z", "type": "commit"}, {"oid": "a25e0f78f3db78ee395cebbd820368b801e6c7fe", "url": "https://github.com/hazelcast/hazelcast-jet/commit/a25e0f78f3db78ee395cebbd820368b801e6c7fe", "message": "Merge branch 'expose-read-function' of https://github.com/TomaszGaweda/hazelcast-jet into expose-read-function", "committedDate": "2020-01-10T14:18:13Z", "type": "commit"}, {"oid": "e405ccc9d4ca70e1dbd80aeb4d2620547a66ade6", "url": "https://github.com/hazelcast/hazelcast-jet/commit/e405ccc9d4ca70e1dbd80aeb4d2620547a66ade6", "message": "Fix unserializable error\n\nSpotBugs upgraded to allow testing on JDK 13", "committedDate": "2020-01-10T16:39:31Z", "type": "commit"}, {"oid": "f50954f0f3342754032084f6b8bf8ec97f02492a", "url": "https://github.com/hazelcast/hazelcast-jet/commit/f50954f0f3342754032084f6b8bf8ec97f02492a", "message": "Improve, simplify, make bw-compatible", "committedDate": "2020-01-14T13:40:08Z", "type": "commit"}]}