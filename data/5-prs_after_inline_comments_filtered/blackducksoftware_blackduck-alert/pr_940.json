{"pr_number": 940, "pr_title": " environment changes", "pr_createdAt": "2020-04-02T19:59:32Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/940", "timeline": [{"oid": "ad3d0883247c514aee57a3d9875ceadcf628d842", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/ad3d0883247c514aee57a3d9875ceadcf628d842", "message": "feat: Make environment variables only initialize new config.", "committedDate": "2020-04-01T17:52:50Z", "type": "commit"}, {"oid": "3dddc95935f5418284b96a442172fae1b38f4e48", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/3dddc95935f5418284b96a442172fae1b38f4e48", "message": "feat: Add environment variables for resetting defaults.", "committedDate": "2020-04-01T19:32:56Z", "type": "commit"}, {"oid": "9fe53938de1a6b194e2a8ee568dc8f052176efcf", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/9fe53938de1a6b194e2a8ee568dc8f052176efcf", "message": "feat: Initial implementation of component to override config.", "committedDate": "2020-04-01T20:39:00Z", "type": "commit"}, {"oid": "bbf7eb7c457f2fe46c4645b1d9188ad99e07a93b", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/bbf7eb7c457f2fe46c4645b1d9188ad99e07a93b", "message": "feat: Implement changes to reset LDAP, SAML, and admin password.", "committedDate": "2020-04-02T15:51:37Z", "type": "commit"}, {"oid": "f8653ce225eed84b87f0d368c2d119774575ae81", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f8653ce225eed84b87f0d368c2d119774575ae81", "message": "test: Add unit tests for config utility.", "committedDate": "2020-04-02T19:38:12Z", "type": "commit"}, {"oid": "d1177e939acb81bcf890618225079a7e1cd82fd1", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/d1177e939acb81bcf890618225079a7e1cd82fd1", "message": "Merge remote-tracking branch 'origin/master' into ps_environment_changes", "committedDate": "2020-04-02T19:38:54Z", "type": "commit"}, {"oid": "2a568440dd86441bd1bc4540e4ac997e61e83b51", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/2a568440dd86441bd1bc4540e4ac997e61e83b51", "message": "refactor: Update headers and make a class serializable.", "committedDate": "2020-04-02T19:51:09Z", "type": "commit"}, {"oid": "58897fb4ee33e0b6d7d288dface435e4073cd8c6", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/58897fb4ee33e0b6d7d288dface435e4073cd8c6", "message": "build: Add environment variable for docker swarm.", "committedDate": "2020-04-02T19:56:59Z", "type": "commit"}, {"oid": "83d9c32ae80b4cd598acd364a0f9708bbdc770c9", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/83d9c32ae80b4cd598acd364a0f9708bbdc770c9", "message": "feat: Add missing environment variables.", "committedDate": "2020-04-03T13:30:28Z", "type": "commit"}, {"oid": "ce3a1951bbccb4305ffa99c745a50a35c0f542e2", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/ce3a1951bbccb4305ffa99c745a50a35c0f542e2", "message": "feat: Swarm deployment check if database exists.", "committedDate": "2020-04-03T13:33:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzA4NDMyOA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/940#discussion_r403084328", "bodyText": "I was initially confused because I thought this returned an Optional. Let's change the method name from getConfigurationByDescriptorKeyAndContext to getConfigurationsByDescriptorKeyAndContext (making configuration plural).", "author": "gkillough", "createdAt": "2020-04-03T15:24:57Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/descriptor/accessor/DescriptorGlobalConfigUtility.java", "diffHunk": "@@ -0,0 +1,104 @@\n+/**\n+ * alert-common\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.common.descriptor.accessor;\n+\n+import java.util.Collection;\n+import java.util.Optional;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import com.synopsys.integration.alert.common.action.ApiAction;\n+import com.synopsys.integration.alert.common.descriptor.DescriptorKey;\n+import com.synopsys.integration.alert.common.enumeration.ConfigContextEnum;\n+import com.synopsys.integration.alert.common.exception.AlertException;\n+import com.synopsys.integration.alert.common.persistence.accessor.ConfigurationAccessor;\n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationFieldModel;\n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationModel;\n+import com.synopsys.integration.alert.common.persistence.util.ConfigurationFieldModelConverter;\n+import com.synopsys.integration.alert.common.rest.model.FieldModel;\n+\n+public class DescriptorGlobalConfigUtility {\n+    private final Logger logger = LoggerFactory.getLogger(getClass());\n+    private final ConfigurationAccessor configurationAccessor;\n+    private final ApiAction apiAction;\n+    private final ConfigurationFieldModelConverter configurationFieldModelConverter;\n+    private DescriptorKey key;\n+    private ConfigContextEnum context;\n+\n+    public DescriptorGlobalConfigUtility(DescriptorKey descriptorKey, ConfigurationAccessor configurationAccessor, ApiAction apiAction,\n+        ConfigurationFieldModelConverter configurationFieldModelConverter) {\n+        this.key = descriptorKey;\n+        this.context = ConfigContextEnum.GLOBAL;\n+        this.configurationAccessor = configurationAccessor;\n+        this.apiAction = apiAction;\n+        this.configurationFieldModelConverter = configurationFieldModelConverter;\n+    }\n+\n+    public DescriptorKey getKey() {\n+        return key;\n+    }\n+\n+    public boolean doesConfigurationExist() {\n+        try {\n+            return !configurationAccessor.getConfigurationByDescriptorKeyAndContext(key, context).isEmpty();", "originalCommit": "ce3a1951bbccb4305ffa99c745a50a35c0f542e2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzA4OTk4Ng==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/940#discussion_r403089986", "bodyText": "You access key and context by referencing the fields directly but in other places in this class you use the getKey() method. Can we make this more consistent? Either access the fields or use the get methods.", "author": "jamesrichard91", "createdAt": "2020-04-03T15:33:16Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/descriptor/accessor/DescriptorGlobalConfigUtility.java", "diffHunk": "@@ -0,0 +1,104 @@\n+/**\n+ * alert-common\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.common.descriptor.accessor;\n+\n+import java.util.Collection;\n+import java.util.Optional;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import com.synopsys.integration.alert.common.action.ApiAction;\n+import com.synopsys.integration.alert.common.descriptor.DescriptorKey;\n+import com.synopsys.integration.alert.common.enumeration.ConfigContextEnum;\n+import com.synopsys.integration.alert.common.exception.AlertException;\n+import com.synopsys.integration.alert.common.persistence.accessor.ConfigurationAccessor;\n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationFieldModel;\n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationModel;\n+import com.synopsys.integration.alert.common.persistence.util.ConfigurationFieldModelConverter;\n+import com.synopsys.integration.alert.common.rest.model.FieldModel;\n+\n+public class DescriptorGlobalConfigUtility {\n+    private final Logger logger = LoggerFactory.getLogger(getClass());\n+    private final ConfigurationAccessor configurationAccessor;\n+    private final ApiAction apiAction;\n+    private final ConfigurationFieldModelConverter configurationFieldModelConverter;\n+    private DescriptorKey key;\n+    private ConfigContextEnum context;\n+\n+    public DescriptorGlobalConfigUtility(DescriptorKey descriptorKey, ConfigurationAccessor configurationAccessor, ApiAction apiAction,\n+        ConfigurationFieldModelConverter configurationFieldModelConverter) {\n+        this.key = descriptorKey;\n+        this.context = ConfigContextEnum.GLOBAL;\n+        this.configurationAccessor = configurationAccessor;\n+        this.apiAction = apiAction;\n+        this.configurationFieldModelConverter = configurationFieldModelConverter;\n+    }\n+\n+    public DescriptorKey getKey() {\n+        return key;\n+    }\n+\n+    public boolean doesConfigurationExist() {\n+        try {\n+            return !configurationAccessor.getConfigurationByDescriptorKeyAndContext(key, context).isEmpty();", "originalCommit": "ce3a1951bbccb4305ffa99c745a50a35c0f542e2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b4c59ab2a43ff3f6ecb48a63f6c101fb5ec9b5bf", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/b4c59ab2a43ff3f6ecb48a63f6c101fb5ec9b5bf", "message": "fix: Update the descritpor key for LDAP and SAML fields.", "committedDate": "2020-04-03T15:41:09Z", "type": "commit"}, {"oid": "bc14defd2edae07707a137fadc433ccced3ce785", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/bc14defd2edae07707a137fadc433ccced3ce785", "message": "feat: Implement PR feedback.", "committedDate": "2020-04-03T17:30:33Z", "type": "commit"}]}