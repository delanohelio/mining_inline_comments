{"pr_number": 1243, "pr_title": "Refactoring of AuthorizationManager", "pr_createdAt": "2020-11-05T21:11:11Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243", "timeline": [{"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/fc39a353bac50f73bed1518ae6720987d7f936ea", "message": "refactor(AuthorizationManager): Refactored AuthorizationManager to accept DescriptorKey and a ConfigContextEnum objects.", "committedDate": "2020-11-05T20:59:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM2ODAxNg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#discussion_r518368016", "bodyText": "We cannot use Mockito .any() here because it clashes with the deprecated String version of the method.", "author": "JakeMathews", "createdAt": "2020-11-05T21:14:00Z", "path": "component/src/test/java/com/synopsys/integration/alert/component/authentication/web/SamlMetadataFileUploadTest.java", "diffHunk": "@@ -51,7 +53,7 @@ public void cleanResource() throws Exception {\n     @Test\n     public void performUpload() {\n         SamlMetaDataFileUpload action = new SamlMetaDataFileUpload(descriptorKey, authorizationManager, filePersistenceUtil);\n-        Mockito.when(authorizationManager.hasUploadWritePermission(Mockito.anyString(), Mockito.anyString())).thenReturn(Boolean.TRUE);\n+        Mockito.when(authorizationManager.hasUploadWritePermission(Mockito.any(ConfigContextEnum.class), Mockito.any(DescriptorKey.class))).thenReturn(Boolean.TRUE);", "originalCommit": "fc39a353bac50f73bed1518ae6720987d7f936ea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM2OTU4Nw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#discussion_r518369587", "bodyText": "I added mocks for both methods here since the class being tested could call the deprecated methods. I was thinking of changing the mock to throw an exception when the deprecated methods are called. Thoughts?", "author": "JakeMathews", "createdAt": "2020-11-05T21:15:36Z", "path": "src/test/java/com/synopsys/integration/alert/component/users/web/role/RoleActionsTest.java", "diffHunk": "@@ -44,11 +45,17 @@ public void init() {\n         roleAccessor = Mockito.mock(RoleAccessor.class);\n         descriptorKey = createDescriptorKey(\"descriptorKey-test\");\n \n-        Mockito.when(authorizationManager.hasCreatePermission(Mockito.any(), Mockito.any())).thenReturn(true);\n-        Mockito.when(authorizationManager.hasReadPermission(Mockito.any(), Mockito.any())).thenReturn(true);\n-        Mockito.when(authorizationManager.hasDeletePermission(Mockito.any(), Mockito.any())).thenReturn(true);\n-        Mockito.when(authorizationManager.hasExecutePermission(Mockito.any(), Mockito.any())).thenReturn(true);\n-        Mockito.when(authorizationManager.hasWritePermission(Mockito.any(), Mockito.any())).thenReturn(true);\n+        Mockito.when(authorizationManager.hasCreatePermission(Mockito.any(ConfigContextEnum.class), Mockito.any(DescriptorKey.class))).thenReturn(true);", "originalCommit": "fc39a353bac50f73bed1518ae6720987d7f936ea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM3NTMwMA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#discussion_r518375300", "bodyText": "Some FieldModels are built using the ConfigContextEnum and DescriptorKey classes, but other FieldModel instantiations are from String sources. I can go through and attempt to convert most FieldModel instantiations to use ConfigContextEnum and DescriptorKey classes, but would need some help in the tricky spots.", "author": "JakeMathews", "createdAt": "2020-11-05T21:20:45Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/rest/model/FieldModel.java", "diffHunk": "@@ -30,6 +30,7 @@\n \n public class FieldModel extends Config {\n     private Map<String, FieldValueModel> keyToValues;\n+    // TODO DescriptorKey and a ConfigContextEnum should be available instead of Strings", "originalCommit": "fc39a353bac50f73bed1518ae6720987d7f936ea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a0e266505ad5f958d748aadd0d95dbd884a5174a", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a0e266505ad5f958d748aadd0d95dbd884a5174a", "message": "Merge branch 'master' into authorization-manager-refactor", "committedDate": "2020-11-06T19:26:01Z", "type": "commit"}, {"oid": "912e166c788b4f00a9f23f5401a8a9cd4fe3d9f0", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/912e166c788b4f00a9f23f5401a8a9cd4fe3d9f0", "message": "refactor(deprecations): Removed more usages of deprecated methods.", "committedDate": "2020-11-09T17:37:31Z", "type": "commit"}, {"oid": "60909d2bf01c0b6dabe651753246feac59fd9f6c", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/60909d2bf01c0b6dabe651753246feac59fd9f6c", "message": "test-fix(deprecations): Fixed broken tests from refactor.", "committedDate": "2020-11-09T17:38:00Z", "type": "commit"}, {"oid": "7f8558e77cbba2bd0d4ca4329cbe2afea96a2054", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/7f8558e77cbba2bd0d4ca4329cbe2afea96a2054", "message": "Merge branch 'master' into authorization-manager-refactor", "committedDate": "2020-11-09T17:38:15Z", "type": "commit"}, {"oid": "82a375b55fe7f8135563c390e2b2ef5dcb740fe0", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/82a375b55fe7f8135563c390e2b2ef5dcb740fe0", "message": "fix(imports): Fixed broken imports from merge with master.", "committedDate": "2020-11-09T17:46:38Z", "type": "commit"}]}