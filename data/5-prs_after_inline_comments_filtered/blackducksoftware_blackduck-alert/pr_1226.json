{"pr_number": 1226, "pr_title": "removing read...WithoutChecks", "pr_createdAt": "2020-10-15T17:16:38Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226", "timeline": [{"oid": "f1d106f46b1215d83874fdb2593e5a46dbdadb63", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f1d106f46b1215d83874fdb2593e5a46dbdadb63", "message": "refactor: Remove readWithoutChecks (IALERT-1982)", "committedDate": "2020-10-15T16:19:13Z", "type": "commit"}, {"oid": "f98bc7493073bff97f42789059836ef677907a64", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f98bc7493073bff97f42789059836ef677907a64", "message": "Merge branch 'master' of https://github.com/blackducksoftware/blackduck-alert into ek-without-checks", "committedDate": "2020-10-15T16:19:21Z", "type": "commit"}, {"oid": "ae69590f2de70f3b9dc8cb1c2787181663fe4d49", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/ae69590f2de70f3b9dc8cb1c2787181663fe4d49", "message": "fix: update tests to manage loss of without checks (IALERT-1982)", "committedDate": "2020-10-15T17:12:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc2OTQ0Mw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r505769443", "bodyText": "FWIW, this controller will not have a \"read all\" type action when I'm done with implementing paging, so these changes will be instantly reverted. I'm thinking that CompositeResourceActions should not include readAll, because more and more things will soon incorporate paging.", "author": "gkillough", "createdAt": "2020-10-15T18:54:26Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/api/AbstractJobResourceActions.java", "diffHunk": "@@ -41,13 +41,14 @@\n import com.synopsys.integration.alert.common.exception.AlertDatabaseConstraintException;\n import com.synopsys.integration.alert.common.persistence.accessor.DescriptorAccessor;\n import com.synopsys.integration.alert.common.persistence.model.RegisteredDescriptorModel;\n+import com.synopsys.integration.alert.common.rest.model.AlertSerializableModel;\n import com.synopsys.integration.alert.common.rest.model.FieldModel;\n import com.synopsys.integration.alert.common.rest.model.JobFieldModel;\n import com.synopsys.integration.alert.common.rest.model.MultiJobFieldModel;\n import com.synopsys.integration.alert.common.rest.model.ValidationResponseModel;\n import com.synopsys.integration.alert.common.security.authorization.AuthorizationManager;\n \n-public abstract class AbstractJobResourceActions implements JobResourceActions, ReadAllAction<MultiJobFieldModel>, ValidateAction<JobFieldModel>, TestAction<JobFieldModel> {\n+public abstract class AbstractJobResourceActions implements CompositeResourceActions<JobFieldModel, UUID> {", "originalCommit": "ae69590f2de70f3b9dc8cb1c2787181663fe4d49", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3MDc0Mg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r505770742", "bodyText": "I'm shocked to see a final here.", "author": "gkillough", "createdAt": "2020-10-15T18:56:43Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/rest/model/MultiFieldModel.java", "diffHunk": "@@ -24,14 +24,13 @@\n \n import java.util.List;\n \n-public class MultiFieldModel extends AlertSerializableModel {\n-    private List<FieldModel> fieldModels;\n-\n-    public MultiFieldModel(List<FieldModel> fieldModels) {\n-        this.fieldModels = fieldModels;\n+public class MultiFieldModel extends MultiResponseModel<FieldModel> {\n+    public MultiFieldModel(final List<FieldModel> models) {", "originalCommit": "ae69590f2de70f3b9dc8cb1c2787181663fe4d49", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3MTM0Mw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r505771343", "bodyText": "Why constructors, but not elsewhere? That seems inconsistent with the libraries which definitely modify things like headers and requestBodies in constructors.", "author": "gkillough", "createdAt": "2020-10-15T18:57:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3MDc0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDgzNDA4OQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r510834089", "bodyText": "I can address the final, but I don't understand the comment about the constructors, I'll follow up with you.", "author": "ekerwin", "createdAt": "2020-10-23T12:01:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3MDc0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3NDAxMQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r505774011", "bodyText": "I think it would be more clear if the method name included the result. e.g. convertDatabaseModelToRestModel or something along those lines.", "author": "gkillough", "createdAt": "2020-10-15T19:02:41Z", "path": "component/src/main/java/com/synopsys/integration/alert/component/users/web/role/RoleActions.java", "diffHunk": "@@ -113,21 +112,21 @@ public RoleActions(UserManagementDescriptorKey userManagementDescriptorKey, Role\n     }\n \n     @Override\n-    protected ActionResponse<MultiRolePermissionModel> readAllWithoutChecks() {\n-        List<RolePermissionModel> roles = roleAccessor.getRoles().stream()\n-                                              .map(this::convertUserRoleModel)\n-                                              .collect(Collectors.toList());\n-        return new ActionResponse<>(HttpStatus.OK, new MultiRolePermissionModel(roles));\n+    protected List<UserRoleModel> getDatabaseModels() {\n+        return new ArrayList<>(roleAccessor.getRoles());\n     }\n \n     @Override\n-    protected ActionResponse<RolePermissionModel> readWithoutChecks(Long id) {\n-        Optional<RolePermissionModel> role = findExisting(id);\n-        if (role.isPresent()) {\n-            return new ActionResponse<>(HttpStatus.OK, role.get());\n-        }\n-        //This is covered by the findExistingCheck in AbstractResourceActions. TODO for 6.4.0\n-        return new ActionResponse<>(HttpStatus.NOT_FOUND, String.format(\"Role with id:%d not found.\", id));\n+    protected MultiRolePermissionModel createMultiResponseModel(final List<RolePermissionModel> roles) {\n+        return new MultiRolePermissionModel(roles);\n+    }\n+\n+    @Override\n+    protected RolePermissionModel convertDatabaseModel(UserRoleModel userRoleModel) {", "originalCommit": "ae69590f2de70f3b9dc8cb1c2787181663fe4d49", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDgzNDkyNA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r510834924", "bodyText": "Righto.", "author": "ekerwin", "createdAt": "2020-10-23T12:03:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3NDAxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3NzQzOA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r505777438", "bodyText": "Again, I feel like this method name only chooses to tell one half of the story. Why not convertToRestModel? It's also true, but incomplete.", "author": "gkillough", "createdAt": "2020-10-15T19:09:12Z", "path": "component/src/main/java/com/synopsys/integration/alert/component/certificates/web/CertificateActions.java", "diffHunk": "@@ -69,25 +69,23 @@ public CertificateActions(CertificatesDescriptorKey descriptorKey, Authorization\n     @Override\n     protected Optional<CertificateModel> findExisting(Long id) {\n         return certificateAccessor.getCertificate(id)\n-                   .map(this::convertFromDatabaseModel);\n+                   .map(this::convertDatabaseModel);\n     }\n \n     @Override\n-    public ActionResponse<MultiCertificateModel> readAllWithoutChecks() {\n-        List<CertificateModel> certificates = certificateAccessor.getCertificates().stream()\n-                                                  .map(this::convertFromDatabaseModel)\n-                                                  .collect(Collectors.toList());\n-        return new ActionResponse<>(HttpStatus.OK, new MultiCertificateModel(certificates));\n+    protected List<CustomCertificateModel> getDatabaseModels() {\n+        return certificateAccessor.getCertificates();\n     }\n \n     @Override\n-    protected ActionResponse<CertificateModel> readWithoutChecks(Long id) {\n-        Optional<CertificateModel> model = findExisting(id);\n-        if (model.isPresent()) {\n-            return new ActionResponse<>(HttpStatus.OK, model.get());\n-        }\n+    protected MultiCertificateModel createMultiResponseModel(final List<CertificateModel> certificates) {\n+        return new MultiCertificateModel(certificates);\n+    }\n \n-        return new ActionResponse<>(HttpStatus.NOT_FOUND, String.format(\"Certificate with id:%d not found.\", id));\n+    @Override\n+    protected CertificateModel convertDatabaseModel(CustomCertificateModel databaseCertificateModel) {", "originalCommit": "ae69590f2de70f3b9dc8cb1c2787181663fe4d49", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDgzNTQ3OQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r510835479", "bodyText": "It might have been easier to critique the method name in the base class so you only had to do it once.", "author": "ekerwin", "createdAt": "2020-10-23T12:04:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3NzQzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg1MDM1Ng==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r510850356", "bodyText": "My mistake.", "author": "gkillough", "createdAt": "2020-10-23T12:31:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3NzQzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3OTcwOA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r505779708", "bodyText": "Can we use the word \"retrieve\" or \"read\" rather than \"get\"? The \"get\" method-prefix in Java is a ubiquitous convention for accessing fields of a class, so it's nice to make a distinction.", "author": "gkillough", "createdAt": "2020-10-15T19:13:25Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/api/AbstractResourceActions.java", "diffHunk": "@@ -49,16 +54,17 @@ public AbstractResourceActions(DescriptorKey descriptorKey, ConfigContextEnum co\n         this.context = context;\n         // to do change the authorization manager to use the context enum and the descriptor key\n         this.authorizationManager = authorizationManager;\n-\n     }\n \n     protected abstract ActionResponse<T> createWithoutChecks(T resource);\n \n     protected abstract ActionResponse<T> deleteWithoutChecks(Long id);\n \n-    protected abstract ActionResponse<M> readAllWithoutChecks();\n+    protected abstract List<D> getDatabaseModels();", "originalCommit": "ae69590f2de70f3b9dc8cb1c2787181663fe4d49", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDgzNjI2OQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r510836269", "bodyText": "Do you want to apply the same level of precision to the accessors? I went off of their method convention of using 'get'.", "author": "ekerwin", "createdAt": "2020-10-23T12:05:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3OTcwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDgzNjc4Mg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r510836782", "bodyText": "I'd argue that consistency is the better part of valor here - so if you object to 'get' as a prefix for non-trivial methods, we should alter the api of the accessors, or just leave the 'get' prefix alone.", "author": "ekerwin", "createdAt": "2020-10-23T12:06:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3OTcwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg0OTg1Mw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r510849853", "bodyText": "I was thinking about this with the accessors while modifying them recently and I agree that their prefixes should also change. We can lay one good brick with the actions right now and when the accessors aren't in such a high state of flux, we can refactor those as well.", "author": "gkillough", "createdAt": "2020-10-23T12:30:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3OTcwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjk3NzE0Ng==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1226#discussion_r512977146", "bodyText": "Well phrased. :)", "author": "ekerwin", "createdAt": "2020-10-27T19:37:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc3OTcwOA=="}], "type": "inlineReview"}, {"oid": "4dec6020bac1d3770ff834b4f51e74c130d2750a", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/4dec6020bac1d3770ff834b4f51e74c130d2750a", "message": "cleaning up builds", "committedDate": "2020-10-19T13:25:21Z", "type": "commit"}, {"oid": "7402405b380080dda96687e70dcc17234436db26", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/7402405b380080dda96687e70dcc17234436db26", "message": "resolve conflicts", "committedDate": "2020-10-22T18:07:42Z", "type": "commit"}, {"oid": "a779d9308a39f20a793763dc7897a41d6a056616", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a779d9308a39f20a793763dc7897a41d6a056616", "message": "trying to resolve", "committedDate": "2020-10-22T18:34:47Z", "type": "commit"}, {"oid": "302309a0749724b525a4f9dbb22532c36600d847", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/302309a0749724b525a4f9dbb22532c36600d847", "message": "refactor: remove outdated interface", "committedDate": "2020-10-23T14:23:09Z", "type": "commit"}, {"oid": "edf29ff08f9a0e19b5e146a63b185fec40f1ff40", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/edf29ff08f9a0e19b5e146a63b185fec40f1ff40", "message": "refactor: removing last pieces of the interface", "committedDate": "2020-10-23T17:05:40Z", "type": "commit"}, {"oid": "5d61697b5a95a8c6cfc9345726bdb6fd4c7307bb", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/5d61697b5a95a8c6cfc9345726bdb6fd4c7307bb", "message": "Merge branch 'master' of https://github.com/blackducksoftware/blackduck-alert into ek-without-checks", "committedDate": "2020-10-26T17:41:48Z", "type": "commit"}, {"oid": "77fe7a4260364ca00330847adb746be107674af7", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/77fe7a4260364ca00330847adb746be107674af7", "message": "Merge branch 'master' of https://github.com/blackducksoftware/blackduck-alert into ek-without-checks", "committedDate": "2020-10-27T19:23:12Z", "type": "commit"}, {"oid": "d4aa3989d3f1ea570adb9040a10b630e2d4010c4", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/d4aa3989d3f1ea570adb9040a10b630e2d4010c4", "message": "refactor: use 'retrieve' as a prefix instead of the over-used 'get'", "committedDate": "2020-10-27T19:41:54Z", "type": "commit"}]}