{"pr_number": 862, "pr_title": "Fix after save and task names", "pr_createdAt": "2020-02-19T17:46:54Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/862", "timeline": [{"oid": "f96241e737602d6c134c382cb542c7dcb5fa94e8", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f96241e737602d6c134c382cb542c7dcb5fa94e8", "message": "Fix(Java): Use a field model in after save and compute task names", "committedDate": "2020-02-19T17:38:35Z", "type": "commit"}, {"oid": "f23c58bfad3f8887d093a4eb2fb5fcde2e24dbf3", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f23c58bfad3f8887d093a4eb2fb5fcde2e24dbf3", "message": "Merge branch 'feat_provider_lifecycle_management' into gk_fix_after_save_and_task_names", "committedDate": "2020-02-19T17:39:56Z", "type": "commit"}, {"oid": "511690ec1e19d3435b0d82b1813680879f228c67", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/511690ec1e19d3435b0d82b1813680879f228c67", "message": "Fix(Test): Update test compile errors and add FIXMEs to BlackDuckAccumulator", "committedDate": "2020-02-19T19:41:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTUzODQxNw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/862#discussion_r381538417", "bodyText": "Actual change.", "author": "gkillough", "createdAt": "2020-02-19T20:54:56Z", "path": "src/main/java/com/synopsys/integration/alert/web/config/FieldModelProcessor.java", "diffHunk": "@@ -50,122 +50,122 @@\n     private final DescriptorProcessor descriptorProcessor;\n \n     @Autowired\n-    public FieldModelProcessor(final ConfigurationFieldModelConverter fieldModelConverter, final FieldValidationAction fieldValidationAction, final DescriptorProcessor descriptorProcessor) {\n+    public FieldModelProcessor(ConfigurationFieldModelConverter fieldModelConverter, FieldValidationAction fieldValidationAction, DescriptorProcessor descriptorProcessor) {\n         this.fieldModelConverter = fieldModelConverter;\n         this.fieldValidationAction = fieldValidationAction;\n         this.descriptorProcessor = descriptorProcessor;\n     }\n \n-    public FieldModel performAfterReadAction(final FieldModel fieldModel) throws AlertException {\n-        final Optional<ApiAction> optionalApiAction = descriptorProcessor.retrieveApiAction(fieldModel);\n+    public FieldModel performAfterReadAction(FieldModel fieldModel) throws AlertException {\n+        Optional<ApiAction> optionalApiAction = descriptorProcessor.retrieveApiAction(fieldModel);\n         if (optionalApiAction.isPresent()) {\n-            final ApiAction apiAction = optionalApiAction.get();\n+            ApiAction apiAction = optionalApiAction.get();\n             return apiAction.afterGetAction(fieldModel);\n         }\n         return fieldModel;\n     }\n \n-    public FieldModel performBeforeDeleteAction(final FieldModel fieldModel) throws AlertException {\n-        final Optional<ApiAction> optionalApiAction = descriptorProcessor.retrieveApiAction(fieldModel);\n+    public FieldModel performBeforeDeleteAction(FieldModel fieldModel) throws AlertException {\n+        Optional<ApiAction> optionalApiAction = descriptorProcessor.retrieveApiAction(fieldModel);\n         if (optionalApiAction.isPresent()) {\n-            final ApiAction apiAction = optionalApiAction.get();\n+            ApiAction apiAction = optionalApiAction.get();\n             return apiAction.beforeDeleteAction(fieldModel);\n         }\n         return fieldModel;\n     }\n \n-    public void performAfterDeleteAction(final String descriptorName, final String context) throws AlertException {\n-        final Optional<ApiAction> optionalApiAction = descriptorProcessor.retrieveApiAction(descriptorName, context);\n+    public void performAfterDeleteAction(FieldModel fieldModel) throws AlertException {\n+        Optional<ApiAction> optionalApiAction = descriptorProcessor.retrieveApiAction(fieldModel.getDescriptorName(), fieldModel.getContext());\n         if (optionalApiAction.isPresent()) {\n-            final ApiAction apiAction = optionalApiAction.get();\n-            apiAction.afterDeleteAction(descriptorName, context);\n+            ApiAction apiAction = optionalApiAction.get();\n+            apiAction.afterDeleteAction(fieldModel);", "originalCommit": "511690ec1e19d3435b0d82b1813680879f228c67", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAxNjExNw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/862#discussion_r382016117", "bodyText": "Is this used by any other class should this be private", "author": "psantos1113", "createdAt": "2020-02-20T14:01:57Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/workflow/task/ScheduledTask.java", "diffHunk": "@@ -46,36 +46,41 @@\n     private final Logger logger = LoggerFactory.getLogger(getClass());\n \n     private final TaskScheduler taskScheduler;\n-    private final String taskName;\n     private ScheduledFuture<?> future;\n \n-    public ScheduledTask(final TaskScheduler taskScheduler, final String taskName) {\n+    public static String computeTaskName(Class<? extends ScheduledTask> clazz) {", "originalCommit": "511690ec1e19d3435b0d82b1813680879f228c67", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAyMTk2Mg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/862#discussion_r382021962", "bodyText": "It is used in the static method computeProviderTaskName() which is currently only called by the SchedulingGlobalApiAction.", "author": "gkillough", "createdAt": "2020-02-20T14:11:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAxNjExNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAxOTY3Mg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/862#discussion_r382019672", "bodyText": "Couldn't we keep getTaskName() and in the constructor of Scheduled task do the following:\ntaskName = computeTaskName();", "author": "psantos1113", "createdAt": "2020-02-20T14:07:42Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/workflow/task/ScheduledTask.java", "diffHunk": "@@ -46,36 +46,41 @@\n     private final Logger logger = LoggerFactory.getLogger(getClass());\n \n     private final TaskScheduler taskScheduler;\n-    private final String taskName;\n     private ScheduledFuture<?> future;\n \n-    public ScheduledTask(final TaskScheduler taskScheduler, final String taskName) {\n+    public static String computeTaskName(Class<? extends ScheduledTask> clazz) {\n+        String packageName = clazz.getPackageName();\n+        String simpleClassName = clazz.getSimpleName();\n+\n+        return String.format(\"Task::Class[%s.%s]\", packageName, simpleClassName);\n+    }\n+\n+    public ScheduledTask(TaskScheduler taskScheduler) {\n         this.taskScheduler = taskScheduler;\n-        this.taskName = taskName;\n     }\n \n-    public String getTaskName() {\n-        return taskName;\n+    public String computeTaskName() {\n+        return ScheduledTask.computeTaskName(getClass());", "originalCommit": "511690ec1e19d3435b0d82b1813680879f228c67", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAyODM1Nw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/862#discussion_r382028357", "bodyText": "We can do this for ScheduledTask, but not for ProviderTask which extends it. This is because ProviderTask would need ProviderProperties passed to its constructor which is currently part of a different ticket.", "author": "gkillough", "createdAt": "2020-02-20T14:21:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAxOTY3Mg=="}], "type": "inlineReview"}, {"oid": "0a4894fb6ff73354891197335e334359d4389f2f", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/0a4894fb6ff73354891197335e334359d4389f2f", "message": "Fix(Java): Compute ScheduledTask's taskName in its constructor", "committedDate": "2020-02-20T14:26:02Z", "type": "commit"}]}