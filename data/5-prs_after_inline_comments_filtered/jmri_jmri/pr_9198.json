{"pr_number": 9198, "pr_title": "Bug fix & new jynstrument", "pr_createdAt": "2020-12-03T10:04:52Z", "pr_url": "https://github.com/JMRI/JMRI/pull/9198", "timeline": [{"oid": "661be92e56347e658e60a15f8525f2db2bb13f65", "url": "https://github.com/JMRI/JMRI/commit/661be92e56347e658e60a15f8525f2db2bb13f65", "message": "New jysntrument for throttle frame to hide (or show) the throttle window toolbar and menubar, will also switch off (on) edit mode, all this will produce a really reduced throttle window.", "committedDate": "2020-09-03T16:36:50Z", "type": "commit"}, {"oid": "d7a52d39b128c93a6269e31d948e1f22174ab1a3", "url": "https://github.com/JMRI/JMRI/commit/d7a52d39b128c93a6269e31d948e1f22174ab1a3", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-12-03T08:04:44Z", "type": "commit"}, {"oid": "81000b1cde0abfbfeb70efc25fd03014ba15b273", "url": "https://github.com/JMRI/JMRI/commit/81000b1cde0abfbfeb70efc25fd03014ba15b273", "message": "Fixing new issue where path separator is last character of a folder path.\nMeaningfull error messages.", "committedDate": "2020-12-03T09:51:50Z", "type": "commit"}, {"oid": "ca3854a9ed96c142755277a61aa4f2dc6f50a61c", "url": "https://github.com/JMRI/JMRI/commit/ca3854a9ed96c142755277a61aa4f2dc6f50a61c", "message": "Updated release note", "committedDate": "2020-12-03T12:24:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE3MTIyNA==", "url": "https://github.com/JMRI/JMRI/pull/9198#discussion_r536171224", "bodyText": "Shouln't this be:\nif (! path.toLowerCase().endsWith(\".jyn\")) {\ninstead?", "author": "danielb987", "createdAt": "2020-12-04T15:15:37Z", "path": "java/src/jmri/jmrit/jython/JynstrumentFactory.java", "diffHunk": "@@ -66,21 +67,25 @@ public static Jynstrument createInstrument(String path, Object context) {\n     // validate Jynstrument path, return className\n     private static String validate(String path) {\n         if (path == null) {\n+            log.error(\"Path is null\");\n             return null;\n         }\n         if (path.length() - 4 < 0) {\n-            log.error(\"File name too short\");\n+            log.error(\"File name too short (should at least end with .jyn) (got {})\", path);\n             return null;\n         }\n+        if (path.endsWith(File.separator)) {\n+            path = path.substring(0, path.length()-File.separator.length());\n+        }\n         File f = new File(path);\n \n         // Path must be a folder named xyz.jin\n         if (!f.isDirectory()) {\n             log.debug(\"Not a directory, trying parent\");\n             return null;\n         }\n-        if (path.substring(path.length() - 4).compareToIgnoreCase(\".jyn\") != 0) {\n-            log.debug(\"Not an instrument\");\n+        if (! path.toLowerCase().startsWith(\".jyn\", path.length() - 4)) {", "originalCommit": "ca3854a9ed96c142755277a61aa4f2dc6f50a61c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIyMTYxNQ==", "url": "https://github.com/JMRI/JMRI/pull/9198#discussion_r536221615", "bodyText": "yes, definitively, pushing a correction.", "author": "Lionel642", "createdAt": "2020-12-04T16:27:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE3MTIyNA=="}], "type": "inlineReview"}, {"oid": "e3bcfb31e33ef1528769d2a2f5da2ea9b16e9d0c", "url": "https://github.com/JMRI/JMRI/commit/e3bcfb31e33ef1528769d2a2f5da2ea9b16e9d0c", "message": "Code simplification.", "committedDate": "2020-12-04T16:30:32Z", "type": "commit"}]}