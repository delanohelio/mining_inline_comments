{"pr_number": 8534, "pr_title": "Fix: use AbstractPowerManager as base for concrete PowerManagers", "pr_createdAt": "2020-05-15T11:46:39Z", "pr_url": "https://github.com/JMRI/JMRI/pull/8534", "timeline": [{"oid": "7b95cc5db6a50577d50f2a646c74814ae2eba779", "url": "https://github.com/JMRI/JMRI/commit/7b95cc5db6a50577d50f2a646c74814ae2eba779", "message": "Merge remote-tracking branch 'upstream/master' into propertychangesupport", "committedDate": "2020-04-11T15:58:13Z", "type": "commit"}, {"oid": "3a78903ae351377771633b91d13b20b7f96c30fd", "url": "https://github.com/JMRI/JMRI/commit/3a78903ae351377771633b91d13b20b7f96c30fd", "message": "chore: Add missing library to NetBeans classpath", "committedDate": "2020-04-11T17:42:37Z", "type": "commit"}, {"oid": "c2b0794ade868cfcb80a12d4d4e6b9be56c1b527", "url": "https://github.com/JMRI/JMRI/commit/c2b0794ade868cfcb80a12d4d4e6b9be56c1b527", "message": "Merge remote-tracking branch 'upstream/master' into propertychangesupport", "committedDate": "2020-04-11T20:43:43Z", "type": "commit"}, {"oid": "84debf9d28dd546df524f285db6c88fb1f34acf7", "url": "https://github.com/JMRI/JMRI/commit/84debf9d28dd546df524f285db6c88fb1f34acf7", "message": "fix: Extend use of VetoableChangeSupport\n\nMake the core subclasses of Manager implement VetoableChangeSupport. (AbstractProxyManager overrides the some methods to ensure the managers that are proxied have the same listeners as it does.)\nDeprecate unused functionally duplicative code - PropertyChangeListeners get the same data ManagerDataListeners (in theory) would, and there are PropertyChangeListeners listening for the correct events, and nothing implements ManagerDataListener, so removing it would be a net win for reducing needless code complexity.", "committedDate": "2020-04-11T21:12:37Z", "type": "commit"}, {"oid": "ceaa17098bab4116b07500fe6775fffac7dfe34d", "url": "https://github.com/JMRI/JMRI/commit/ceaa17098bab4116b07500fe6775fffac7dfe34d", "message": "chore: Do not use deprecated methods", "committedDate": "2020-04-11T22:18:04Z", "type": "commit"}, {"oid": "768a7d69a819be2f64b6a98b0e03895cab5958c1", "url": "https://github.com/JMRI/JMRI/commit/768a7d69a819be2f64b6a98b0e03895cab5958c1", "message": "test: fix a test", "committedDate": "2020-04-11T23:40:30Z", "type": "commit"}, {"oid": "7b2d24dd7f452a235010ae7226f84d0f6687aa86", "url": "https://github.com/JMRI/JMRI/commit/7b2d24dd7f452a235010ae7226f84d0f6687aa86", "message": "chore: suppress deprecation warnings", "committedDate": "2020-04-11T23:46:13Z", "type": "commit"}, {"oid": "ffbfd4d5d311c81d54409bb7a10a603c5b8a18f9", "url": "https://github.com/JMRI/JMRI/commit/ffbfd4d5d311c81d54409bb7a10a603c5b8a18f9", "message": "feat: Use the AbstractPowerManager as the parent of PowerManagers", "committedDate": "2020-05-14T11:14:45Z", "type": "commit"}, {"oid": "389977b2e09622b5cb4ebd23e04fb94d978e5fc8", "url": "https://github.com/JMRI/JMRI/commit/389977b2e09622b5cb4ebd23e04fb94d978e5fc8", "message": "Merge remote-tracking branch 'upstream/master' into propertychangesupport", "committedDate": "2020-05-14T11:18:12Z", "type": "commit"}, {"oid": "e90c38e4952831670fc62d4c109195f2aaacd4a0", "url": "https://github.com/JMRI/JMRI/commit/e90c38e4952831670fc62d4c109195f2aaacd4a0", "message": "feat: Additional PowerManagers extend AbstractPowerManager\n\nNote that AbstractPowerManager now needs generics for SystemConnectionMemo to allow subclasses to use the subclass-specific SystemConnectionMemo class without requiring casting.", "committedDate": "2020-05-14T12:28:18Z", "type": "commit"}, {"oid": "357ebfdca9e74cc76ffd8057d5d6e72d0e657b8e", "url": "https://github.com/JMRI/JMRI/commit/357ebfdca9e74cc76ffd8057d5d6e72d0e657b8e", "message": "fix: getting power state does not throw an exception", "committedDate": "2020-05-14T14:51:46Z", "type": "commit"}, {"oid": "e4078f023596d165ca5ca5fd998775a00816fb46", "url": "https://github.com/JMRI/JMRI/commit/e4078f023596d165ca5ca5fd998775a00816fb46", "message": "fix: Address static analysis errors", "committedDate": "2020-05-14T22:28:07Z", "type": "commit"}, {"oid": "7fca997bea26b686f4ca34c3ca3bb283f451cc0f", "url": "https://github.com/JMRI/JMRI/commit/7fca997bea26b686f4ca34c3ca3bb283f451cc0f", "message": "test: adjust to reality of getting power state not throwing JmriException", "committedDate": "2020-05-14T23:49:07Z", "type": "commit"}, {"oid": "131b58d749024d0a52b8448d882bbac2a9a73c2e", "url": "https://github.com/JMRI/JMRI/commit/131b58d749024d0a52b8448d882bbac2a9a73c2e", "message": "fix: fire \"power\" property changes", "committedDate": "2020-05-14T23:58:18Z", "type": "commit"}, {"oid": "2bc90fd2307f462f555558ad09c048ca33a9871f", "url": "https://github.com/JMRI/JMRI/commit/2bc90fd2307f462f555558ad09c048ca33a9871f", "message": "fix: Unmask fields", "committedDate": "2020-05-15T00:30:47Z", "type": "commit"}, {"oid": "7caa0f7d7a974717a26197c2a1ca6db4677971d5", "url": "https://github.com/JMRI/JMRI/commit/7caa0f7d7a974717a26197c2a1ca6db4677971d5", "message": "Merge remote-tracking branch 'upstream/master' into propertychangesupport", "committedDate": "2020-05-15T09:30:45Z", "type": "commit"}, {"oid": "2a447b422a7b9e77ec8593c07a45911a05e0a293", "url": "https://github.com/JMRI/JMRI/commit/2a447b422a7b9e77ec8593c07a45911a05e0a293", "message": "fix: Listen to the \"power\" property, not all properties", "committedDate": "2020-05-15T10:18:20Z", "type": "commit"}, {"oid": "95744a1a3cef2cc82350996faa5a84622f06800a", "url": "https://github.com/JMRI/JMRI/commit/95744a1a3cef2cc82350996faa5a84622f06800a", "message": "chore: formatting and comments", "committedDate": "2020-05-15T10:18:38Z", "type": "commit"}, {"oid": "a6fd33a111152ab042a67a03c3ea451fed423126", "url": "https://github.com/JMRI/JMRI/commit/a6fd33a111152ab042a67a03c3ea451fed423126", "message": "give up on trying to make Cbus behave nicely with others", "committedDate": "2020-05-15T11:02:48Z", "type": "commit"}, {"oid": "ecf538abc41bfcc6f855f1fc88f484f8c4f18f4c", "url": "https://github.com/JMRI/JMRI/commit/ecf538abc41bfcc6f855f1fc88f484f8c4f18f4c", "message": "doc: fix deprecation version", "committedDate": "2020-05-15T11:39:02Z", "type": "commit"}, {"oid": "3d6567bc71f585a16a8f4f548a7abf709391154c", "url": "https://github.com/JMRI/JMRI/commit/3d6567bc71f585a16a8f4f548a7abf709391154c", "message": "chore: move from 4.21.1 release to 4.19.7 release", "committedDate": "2020-05-15T11:51:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI2MjkwNA==", "url": "https://github.com/JMRI/JMRI/pull/8534#discussion_r426262904", "bodyText": "IIRC, this listener mute/unmute and the similar one in SectionManagerXml loading was inserted about 2 years ago to resolve O(N^2) loading performance.  I think @petecressman was (starting to?) work with some configurations that were big enough that it was starting to matter.  I don't have any more detail than that; the PR doesn't mention this, and my notes on the topic are pretty sparse. @petecressman do you remember this?  Do you have a file(s) that can test if this has a performance impact?  Thanks.", "author": "bobjacobsen", "createdAt": "2020-05-17T13:39:35Z", "path": "java/src/jmri/configurexml/TransitManagerXml.java", "diffHunk": "@@ -150,7 +150,6 @@ public void loadTransits(Element sharedTransits, Element perNodeTransits) {\n         List<Element> transitList = sharedTransits.getChildren(\"transit\");\n         log.debug(\"Found {} transits\", transitList.size());\n         TransitManager tm = InstanceManager.getDefault(jmri.TransitManager.class);\n-        tm.setDataListenerMute(true);", "originalCommit": "3d6567bc71f585a16a8f4f548a7abf709391154c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI3NjU1MA==", "url": "https://github.com/JMRI/JMRI/pull/8534#discussion_r426276550", "bodyText": "Prior to this PR, the only ManagerDataListener I could find is the AbstractProxyManager. Everything else, including all GUI listeners, listened to the \"length\" or \"beans\" properties of the Managers, which were never muted, so I don't think muting this had the performance effects you are anticipating.", "author": "rhwood", "createdAt": "2020-05-17T15:57:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI2MjkwNA=="}], "type": "inlineReview"}]}