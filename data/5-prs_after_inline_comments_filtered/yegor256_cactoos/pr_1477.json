{"pr_number": 1477, "pr_title": "For #1169: Use wild-card type parameters in ctor", "pr_createdAt": "2020-09-29T23:36:52Z", "pr_url": "https://github.com/yegor256/cactoos/pull/1477", "timeline": [{"oid": "8a507aaccff7a9783d6f97faf1c2ba73aef4b493", "url": "https://github.com/yegor256/cactoos/commit/8a507aaccff7a9783d6f97faf1c2ba73aef4b493", "message": "(#1169) Wild-card as ctor parameter", "committedDate": "2020-09-29T23:33:10Z", "type": "commit"}, {"oid": "22b6ed16a33b5f5b530bdf9792d61a2101212d89", "url": "https://github.com/yegor256/cactoos/commit/22b6ed16a33b5f5b530bdf9792d61a2101212d89", "message": "(#1169) Wild-card as ctor parameter", "committedDate": "2020-09-29T23:33:36Z", "type": "commit"}, {"oid": "48f35c0500a7c079c23defaee2730e22bb765117", "url": "https://github.com/yegor256/cactoos/commit/48f35c0500a7c079c23defaee2730e22bb765117", "message": "(#1169) Remove explicit type parameters", "committedDate": "2020-09-29T23:33:56Z", "type": "commit"}, {"oid": "5e7d43da20f2d7298da1b9f38d8129b0cfdde824", "url": "https://github.com/yegor256/cactoos/commit/5e7d43da20f2d7298da1b9f38d8129b0cfdde824", "message": "(#1169) Wild-cards for parameters", "committedDate": "2020-09-29T23:34:29Z", "type": "commit"}, {"oid": "3be51d98851388ae0a651024e21c83977863485b", "url": "https://github.com/yegor256/cactoos/commit/3be51d98851388ae0a651024e21c83977863485b", "message": "(#1169) Wild-cards for parameters", "committedDate": "2020-09-29T23:34:57Z", "type": "commit"}, {"oid": "f52b99151e51885faba4566cfe6f6821d4bd6630", "url": "https://github.com/yegor256/cactoos/commit/f52b99151e51885faba4566cfe6f6821d4bd6630", "message": "(#1169) Undo wild-cards for varargs", "committedDate": "2020-09-29T23:53:47Z", "type": "commit"}, {"oid": "855be0f463b26d5c6812cf244931eded6c97d57a", "url": "https://github.com/yegor256/cactoos/commit/855be0f463b26d5c6812cf244931eded6c97d57a", "message": "(#1169) Add test", "committedDate": "2020-09-29T23:54:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NDkwMQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r498584901", "bodyText": "@andreoss Has been needed put a Mapped here? Why? An IteratorOf can be used instead?", "author": "fabriciofx", "createdAt": "2020-10-02T01:32:18Z", "path": "src/main/java/org/cactoos/iterable/IterableOf.java", "diffHunk": "@@ -76,21 +77,21 @@ public IterableOf(final List<X> list) {\n      * @param list The list\n      * @since 0.21\n      */\n-    public IterableOf(final Iterator<X> list) {\n+    public IterableOf(final Iterator<? extends X> list) {\n         this(() -> list);\n     }\n \n     /**\n      * Ctor.\n      * @param sclr The encapsulated iterator of x\n      */\n-    public IterableOf(final Scalar<Iterator<X>> sclr) {\n+    public IterableOf(final Scalar<Iterator<? extends X>> sclr) {\n         this.itr = sclr;\n     }\n \n     @Override\n     public Iterator<X> iterator() {\n-        return new Unchecked<>(this.itr).value();\n+        return new Mapped<>(x -> x, new Unchecked<>(this.itr).value());", "originalCommit": "855be0f463b26d5c6812cf244931eded6c97d57a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODY3Njc1MA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r498676750", "bodyText": "@fabriciofx Mapped is used in order to coerce ? extends X to X. IteratorOf wouldn't be enough for that", "author": "andreoss", "createdAt": "2020-10-02T08:13:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NDkwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUzMjg0MQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507532841", "bodyText": "@andreoss please add a todo so that this can be investigated and the code simplified, there must be some way to do something simpler.", "author": "victornoel", "createdAt": "2020-10-19T07:36:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NDkwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NTIxNg==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r498585216", "bodyText": "@andreoss Please, break the line here, putting one parameter for line.", "author": "fabriciofx", "createdAt": "2020-10-02T01:33:59Z", "path": "src/main/java/org/cactoos/iterable/Matched.java", "diffHunk": "@@ -54,7 +54,9 @@\n      * @param fst The first part of duplex iterator.\n      * @param snd The second part of duplex iterator.\n      */\n-    public Matched(final Iterable<X> fst, final Iterable<X> snd) {\n+    public Matched(\n+        final Iterable<? extends X> fst, final Iterable<? extends X> snd", "originalCommit": "855be0f463b26d5c6812cf244931eded6c97d57a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTYzOQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r499171639", "bodyText": "@fabriciofx fixed", "author": "andreoss", "createdAt": "2020-10-03T18:39:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NTIxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NTI1MA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r498585250", "bodyText": "@andreoss the same above.", "author": "fabriciofx", "createdAt": "2020-10-02T01:34:12Z", "path": "src/main/java/org/cactoos/iterable/Matched.java", "diffHunk": "@@ -66,12 +68,12 @@ public Matched(final Iterable<X> fst, final Iterable<X> snd) {\n      */\n     public Matched(\n         final BiFunc<X, X, Boolean> fnc,\n-        final Iterable<X> fst, final Iterable<X> snd\n+        final Iterable<? extends X> fst, final Iterable<? extends X> snd", "originalCommit": "855be0f463b26d5c6812cf244931eded6c97d57a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NTM4Ng==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r498585386", "bodyText": "@andreoss the same above: why Mapped?", "author": "fabriciofx", "createdAt": "2020-10-02T01:34:55Z", "path": "src/main/java/org/cactoos/iterable/Solid.java", "diffHunk": "@@ -46,8 +46,8 @@ public Solid(final X... src) {\n      * Ctor.\n      * @param iterable The iterable\n      */\n-    public Solid(final Iterable<X> iterable) {\n-        super(new Synced<>(new Sticky<>(iterable)));\n+    public Solid(final Iterable<? extends X> iterable) {\n+        super(new Synced<>(new Sticky<>(new Mapped<>(x -> x, iterable))));", "originalCommit": "855be0f463b26d5c6812cf244931eded6c97d57a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NTQyNA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r498585424", "bodyText": "@andreoss the same above.", "author": "fabriciofx", "createdAt": "2020-10-02T01:35:11Z", "path": "src/main/java/org/cactoos/iterator/Filtered.java", "diffHunk": "@@ -75,7 +75,9 @@\n      * @param fnc Predicate\n      * @param src Source iterable\n      */\n-    public Filtered(final Func<X, Boolean> fnc, final Iterator<X> src) {\n+    public Filtered(\n+        final Func<X, Boolean> fnc, final Iterator<? extends X> src", "originalCommit": "855be0f463b26d5c6812cf244931eded6c97d57a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTYyOQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r499171629", "bodyText": "@fabriciofx Fixed", "author": "andreoss", "createdAt": "2020-10-03T18:38:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NTQyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NTc1MQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r498585751", "bodyText": "@andreoss the same above.", "author": "fabriciofx", "createdAt": "2020-10-02T01:37:03Z", "path": "src/main/java/org/cactoos/iterator/TailOf.java", "diffHunk": "@@ -41,16 +41,19 @@\n      * @param num Number of tail elements\n      * @param iterator Decorated iterator\n      */\n-    public TailOf(final int num, final Iterator<T> iterator) {\n+    public TailOf(final int num, final Iterator<? extends T> iterator) {\n         super(\n-            new Reversed<>(\n-                new HeadOf<>(\n-                    num,\n-                    new Reversed<>(\n-                        new IterableOf<>(iterator)\n+            new Mapped<>(", "originalCommit": "855be0f463b26d5c6812cf244931eded6c97d57a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NjI3Nw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r498586277", "bodyText": "@andreoss the same above.", "author": "fabriciofx", "createdAt": "2020-10-02T01:39:52Z", "path": "src/main/java/org/cactoos/map/Synced.java", "diffHunk": "@@ -121,16 +125,18 @@ public Synced(final Map<X, Y> map, final Map.Entry<X, Y>... list) {\n      * @param list List of items\n      * @param <Z> Type of items in the list\n      */\n-    public <Z> Synced(final Func<Z, Map.Entry<X, Y>> entry,\n-        final Map<X, Y> map, final Iterable<Z> list) {\n+    public <Z> Synced(\n+        final Func<Z, Map.Entry<? extends X, ? extends Y>> entry,\n+        final Map<X, Y> map, final Iterable<Z> list", "originalCommit": "855be0f463b26d5c6812cf244931eded6c97d57a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTY1Mw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r499171653", "bodyText": "@fabriciofx Fixed", "author": "andreoss", "createdAt": "2020-10-03T18:39:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NjI3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU4NjYzMw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r498586633", "bodyText": "@andreoss please, add more tests, for a map and the decorators where were changed.", "author": "fabriciofx", "createdAt": "2020-10-02T01:41:56Z", "path": "src/test/java/org/cactoos/list/JoinedTest.java", "diffHunk": "@@ -435,4 +439,25 @@ public void itemAndList() {\n             )\n         ).affirm();\n     }\n+\n+    @Test\n+    public void infersCorrectly() {", "originalCommit": "855be0f463b26d5c6812cf244931eded6c97d57a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4ac132dcebcfab9506c3394dc754ada6c31d015d", "url": "https://github.com/yegor256/cactoos/commit/4ac132dcebcfab9506c3394dc754ada6c31d015d", "message": "(#1169) Fix indentation", "committedDate": "2020-10-03T18:38:16Z", "type": "commit"}, {"oid": "0b26d57970423634c806b44b961bb763b9ef13e2", "url": "https://github.com/yegor256/cactoos/commit/0b26d57970423634c806b44b961bb763b9ef13e2", "message": "(#1169) Fix indentation", "committedDate": "2020-10-03T18:38:30Z", "type": "commit"}, {"oid": "f33dbc3eb9356a63210a1333e3530e2245abf6d5", "url": "https://github.com/yegor256/cactoos/commit/f33dbc3eb9356a63210a1333e3530e2245abf6d5", "message": "(#1169) Fix indentation", "committedDate": "2020-10-03T18:38:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzEyNzg4MQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507127881", "bodyText": "@andreoss to be complete, we need Func<? super X, Boolean>, so that we can write for example:\n Iterable<Double> res = new Filtered<Double>((Number d) -> d.doubleValue() > 0, new IterableOf<Double>(4.1));\nThat's why I guess we need a few tests..", "author": "victornoel", "createdAt": "2020-10-18T12:31:25Z", "path": "src/main/java/org/cactoos/iterable/Filtered.java", "diffHunk": "@@ -65,7 +65,7 @@ public Filtered(final Func<X, Boolean> fnc, final X... src) {\n      * @param fnc Predicate\n      * @param src Source iterable\n      */\n-    public Filtered(final Func<X, Boolean> fnc, final Iterable<X> src) {\n+    public Filtered(final Func<X, Boolean> fnc, final Iterable<? extends X> src) {", "originalCommit": "f33dbc3eb9356a63210a1333e3530e2245abf6d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzg4NzgwNg==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507887806", "bodyText": "@victornoel Added a test", "author": "andreoss", "createdAt": "2020-10-19T16:26:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzEyNzg4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzEzMDE2Nw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507130167", "bodyText": "@andreoss here I think we need:\n\nto move the the X argument at the constructor level, it's not needed at the class level IMHO\nhave Func<? super X, ? extends Y> to be able to express more things", "author": "victornoel", "createdAt": "2020-10-18T12:38:17Z", "path": "src/main/java/org/cactoos/iterable/Mapped.java", "diffHunk": "@@ -51,7 +51,7 @@ public Mapped(final Func<X, Y> fnc, final X... src) {\n      * @param fnc Func\n      * @param src Source iterable\n      */\n-    public Mapped(final Func<X, Y> fnc, final Iterable<X> src) {\n+    public Mapped(final Func<X, Y> fnc, final Iterable<? extends X> src) {", "originalCommit": "f33dbc3eb9356a63210a1333e3530e2245abf6d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzI1NjkyNg==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507256926", "bodyText": "@victornoel Added todo for removing X as a class level type parameter", "author": "andreoss", "createdAt": "2020-10-18T23:39:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzEzMDE2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzg4ODE0NQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507888145", "bodyText": "@victornoel Actually, I've done it in this PR.", "author": "andreoss", "createdAt": "2020-10-19T16:26:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzEzMDE2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzEzMDM2OQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507130369", "bodyText": "@andreoss here I think it should be BiFunc<? super X, ? super X, Boolean>", "author": "victornoel", "createdAt": "2020-10-18T12:38:54Z", "path": "src/main/java/org/cactoos/iterable/Matched.java", "diffHunk": "@@ -66,12 +69,13 @@ public Matched(final Iterable<X> fst, final Iterable<X> snd) {\n      */\n     public Matched(\n         final BiFunc<X, X, Boolean> fnc,", "originalCommit": "f33dbc3eb9356a63210a1333e3530e2245abf6d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzI1Njk3Ng==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507256976", "bodyText": "@victornoel Fixed", "author": "andreoss", "createdAt": "2020-10-18T23:39:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzEzMDM2OQ=="}], "type": "inlineReview"}, {"oid": "5a15d47d7156e88587621189b65ce17e5fcd5bd7", "url": "https://github.com/yegor256/cactoos/commit/5a15d47d7156e88587621189b65ce17e5fcd5bd7", "message": "(#1169) Add a todo", "committedDate": "2020-10-18T23:07:48Z", "type": "commit"}, {"oid": "8f742e5cddd453478a58d674aa4e94857b5c10e7", "url": "https://github.com/yegor256/cactoos/commit/8f742e5cddd453478a58d674aa4e94857b5c10e7", "message": "(#1169) Correct types", "committedDate": "2020-10-18T23:12:12Z", "type": "commit"}, {"oid": "7e23d8861c13d8a523c79e5e57470cbe7e8c25a5", "url": "https://github.com/yegor256/cactoos/commit/7e23d8861c13d8a523c79e5e57470cbe7e8c25a5", "message": "(#1169) Correct types according to PECS", "committedDate": "2020-10-18T23:19:13Z", "type": "commit"}, {"oid": "5dc6445b13e97146e3a006d8c4ca78454afbdf47", "url": "https://github.com/yegor256/cactoos/commit/5dc6445b13e97146e3a006d8c4ca78454afbdf47", "message": "(#1169) Correct types according to PECS", "committedDate": "2020-10-18T23:25:21Z", "type": "commit"}, {"oid": "8c7b0539b862e9964a9f07ff8827a24a35e7c610", "url": "https://github.com/yegor256/cactoos/commit/8c7b0539b862e9964a9f07ff8827a24a35e7c610", "message": "(#1169) Qulice compliance", "committedDate": "2020-10-18T23:36:46Z", "type": "commit"}, {"oid": "c2a268d917eb02720ee62cb9d48881f9d4b1aacd", "url": "https://github.com/yegor256/cactoos/commit/c2a268d917eb02720ee62cb9d48881f9d4b1aacd", "message": "(#1169) PDD compliance", "committedDate": "2020-10-18T23:40:52Z", "type": "commit"}, {"oid": "6b685467845798223193b2ff1f21e5c1388f91ef", "url": "https://github.com/yegor256/cactoos/commit/6b685467845798223193b2ff1f21e5c1388f91ef", "message": "(#1169) PDD compliance", "committedDate": "2020-10-19T00:12:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUyNjkyNw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507526927", "bodyText": "@andreoss not possibly, this should be done too :) also IMHO there is no reason for those two tasks to be done as once, just say in the todo what is to be done, and then the assignee will decide if everything can be done at once.", "author": "victornoel", "createdAt": "2020-10-19T07:25:31Z", "path": "src/main/java/org/cactoos/iterable/Mapped.java", "diffHunk": "@@ -33,6 +33,10 @@\n  * @param <X> Type of source item\n  * @param <Y> Type of target item\n  * @since 0.1\n+ * @todo #1169:30m Remove type parameter X from this\n+ *  class definition, and put extra type parameter on each ctor.\n+ *  Possibly, the same change is possible in iterator.Mapped,", "originalCommit": "6b685467845798223193b2ff1f21e5c1388f91ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUyNzIzMg==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507527232", "bodyText": "@andreoss it's missing the ? extend Y in the second func type parameter.", "author": "victornoel", "createdAt": "2020-10-19T07:26:11Z", "path": "src/main/java/org/cactoos/iterable/Mapped.java", "diffHunk": "@@ -42,7 +46,7 @@\n      * @param src Source iterable\n      */\n     @SafeVarargs\n-    public Mapped(final Func<X, Y> fnc, final X... src) {\n+    public Mapped(final Func<? super X, Y> fnc, final X... src) {", "originalCommit": "6b685467845798223193b2ff1f21e5c1388f91ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxNDk0MQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507914941", "bodyText": "@victornoel Done", "author": "andreoss", "createdAt": "2020-10-19T17:08:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUyNzIzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUyODUwMA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507528500", "bodyText": "@andreoss we are missing the ? extends X on the src parameter here", "author": "victornoel", "createdAt": "2020-10-19T07:28:37Z", "path": "src/main/java/org/cactoos/iterable/Filtered.java", "diffHunk": "@@ -78,7 +78,7 @@ public Filtered(final Func<X, Boolean> fnc, final Iterable<X> src) {\n      * @param src Source iterable\n      * @param fnc Predicate\n      */\n-    public Filtered(final Iterable<X> src, final Func<X, Scalar<Boolean>> fnc) {\n+    public Filtered(final Iterable<X> src, final Func<? super X, Scalar<Boolean>> fnc) {", "originalCommit": "6b685467845798223193b2ff1f21e5c1388f91ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxMTUwNg==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507911506", "bodyText": "@victornoel Done", "author": "andreoss", "createdAt": "2020-10-19T17:02:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUyODUwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUyOTc3OQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507529779", "bodyText": "@andreoss let's replace the type of snd with Iterable<? extends Y> with Y\u00a0being a type declared at the constructor level (or you can just add a todo). There is no need for this second parameter to be so constrained in types.", "author": "victornoel", "createdAt": "2020-10-19T07:31:01Z", "path": "src/main/java/org/cactoos/iterable/Matched.java", "diffHunk": "@@ -65,13 +68,14 @@ public Matched(final Iterable<X> fst, final Iterable<X> snd) {\n      * @param snd The second part of duplex iterator.\n      */\n     public Matched(\n-        final BiFunc<X, X, Boolean> fnc,\n-        final Iterable<X> fst, final Iterable<X> snd\n+        final BiFunc<? super X, ? super X, Boolean> fnc,\n+        final Iterable<? extends X> fst,\n+        final Iterable<? extends X> snd", "originalCommit": "6b685467845798223193b2ff1f21e5c1388f91ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxMTQwNA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507911404", "bodyText": "@victornoel Done", "author": "andreoss", "createdAt": "2020-10-19T17:02:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUyOTc3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUzMDA5Ng==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507530096", "bodyText": "@andreoss here too let's apply the same thing with super and extends on the func", "author": "victornoel", "createdAt": "2020-10-19T07:31:43Z", "path": "src/main/java/org/cactoos/iterator/Mapped.java", "diffHunk": "@@ -53,7 +53,7 @@\n      * @param func Func\n      * @param iterator Source iterator\n      */\n-    public Mapped(final Func<X, Y> func, final Iterator<X> iterator) {\n+    public Mapped(final Func<X, Y> func, final Iterator<? extends X> iterator) {", "originalCommit": "6b685467845798223193b2ff1f21e5c1388f91ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxNTA4Nw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507915087", "bodyText": "@victornoel Done", "author": "andreoss", "createdAt": "2020-10-19T17:08:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUzMDA5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUzMDg1Nw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507530857", "bodyText": "@andreoss I believe the func should be taking a ? super Z no?", "author": "victornoel", "createdAt": "2020-10-19T07:33:18Z", "path": "src/main/java/org/cactoos/map/MapOf.java", "diffHunk": "@@ -106,8 +104,10 @@ public MapOf(final Map<X, Y> src, final Map.Entry<X, Y>... list) {\n      * @param <Z> Type of items in the list\n      * @since 0.11\n      */\n-    public <Z> MapOf(final Func<Z, Map.Entry<X, Y>> entry,\n-        final Iterable<Z> list) {\n+    public <Z> MapOf(\n+        final Func<Z, Map.Entry<? extends X, ? extends Y>> entry,", "originalCommit": "6b685467845798223193b2ff1f21e5c1388f91ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkwNTIwNA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507905204", "bodyText": "@victornoel Done.", "author": "andreoss", "createdAt": "2020-10-19T16:53:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUzMDg1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUzMTExNw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507531117", "bodyText": "@andreoss here too let's apply the same concepts", "author": "victornoel", "createdAt": "2020-10-19T07:33:46Z", "path": "src/main/java/org/cactoos/map/Synced.java", "diffHunk": "@@ -70,9 +70,12 @@ public Synced(final Map<X, Y> map, final Map.Entry<X, Y>... list) {\n      * @param <Z> Type of items in the list\n      * @checkstyle ParameterNumberCheck (5 lines)\n      */\n-    public <Z> Synced(final Func<Z, X> key,\n-        final Func<Z, Y> value, final Map<X, Y> map,\n-        final Iterable<Z> list) {\n+    public <Z> Synced(\n+        final Func<Z, X> key,\n+        final Func<Z, Y> value,", "originalCommit": "6b685467845798223193b2ff1f21e5c1388f91ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkwNTEwMA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507905100", "bodyText": "@victornoel Done", "author": "andreoss", "createdAt": "2020-10-19T16:53:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUzMTExNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUzMTUxOQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507531519", "bodyText": "@andreoss I believe the comparator should take a ? super T here too (a comparator is basically a func from T,T to bool :)", "author": "victornoel", "createdAt": "2020-10-19T07:34:37Z", "path": "src/main/java/org/cactoos/set/Sorted.java", "diffHunk": "@@ -54,7 +54,10 @@ public Sorted(final Comparator<T> cmp, final T... array) {\n      * @param src An {@link Iterable}\n      */\n     @SuppressWarnings(\"PMD.ConstructorOnlyInitializesOrCallOtherConstructors\")\n-    public Sorted(final Comparator<T> cmp, final Iterable<T> src) {\n+    public Sorted(\n+        final Comparator<T> cmp,", "originalCommit": "6b685467845798223193b2ff1f21e5c1388f91ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzg4ODU2Mw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r507888563", "bodyText": "@victornoel Changed that", "author": "andreoss", "createdAt": "2020-10-19T16:27:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUzMTUxOQ=="}], "type": "inlineReview"}, {"oid": "eb7293873d2a6eb9d74a57ef20312a05af37c511", "url": "https://github.com/yegor256/cactoos/commit/eb7293873d2a6eb9d74a57ef20312a05af37c511", "message": "(#1169) Apply PECS to Mapped", "committedDate": "2020-10-19T15:59:24Z", "type": "commit"}, {"oid": "eac9b3794df23ff9b648d10e9099b0d7d2730f3b", "url": "https://github.com/yegor256/cactoos/commit/eac9b3794df23ff9b648d10e9099b0d7d2730f3b", "message": "(#1169) Reuse `scalar.Mapped'", "committedDate": "2020-10-19T15:59:49Z", "type": "commit"}, {"oid": "a09e16c5d23139009f4f1f80aa3edf98aa53ad35", "url": "https://github.com/yegor256/cactoos/commit/a09e16c5d23139009f4f1f80aa3edf98aa53ad35", "message": "(#1169) Move type parameter to ctor", "committedDate": "2020-10-19T16:00:27Z", "type": "commit"}, {"oid": "749b19a5b56e2443e5dc43fb7fe63dad726a84fb", "url": "https://github.com/yegor256/cactoos/commit/749b19a5b56e2443e5dc43fb7fe63dad726a84fb", "message": "(#1169) Use inferred type", "committedDate": "2020-10-19T16:01:00Z", "type": "commit"}, {"oid": "0135a3726297f1f7b5aeceacf665ef2829b034d3", "url": "https://github.com/yegor256/cactoos/commit/0135a3726297f1f7b5aeceacf665ef2829b034d3", "message": "(#1169) Apply PECS in `iterable.Synced'", "committedDate": "2020-10-19T16:01:19Z", "type": "commit"}, {"oid": "c0a9e1fee11d1a35e888c9ef61ee7eaeeb98be0f", "url": "https://github.com/yegor256/cactoos/commit/c0a9e1fee11d1a35e888c9ef61ee7eaeeb98be0f", "message": "(#1169) Apply PECS in `iterator.Sorted'", "committedDate": "2020-10-19T16:01:48Z", "type": "commit"}, {"oid": "4d795aa606200ea886e51befb9c1235591c388be", "url": "https://github.com/yegor256/cactoos/commit/4d795aa606200ea886e51befb9c1235591c388be", "message": "(#1169) Fix types", "committedDate": "2020-10-19T16:02:05Z", "type": "commit"}, {"oid": "690a9b08a3c6fde6eadb72dc7c64c9c92b7eb75e", "url": "https://github.com/yegor256/cactoos/commit/690a9b08a3c6fde6eadb72dc7c64c9c92b7eb75e", "message": "(#1169) Fix indentation", "committedDate": "2020-10-19T16:02:29Z", "type": "commit"}, {"oid": "867b61b7ab7c4f98f0febba4baf234a07bc6e64a", "url": "https://github.com/yegor256/cactoos/commit/867b61b7ab7c4f98f0febba4baf234a07bc6e64a", "message": "(#1169) Fix indentation", "committedDate": "2020-10-19T16:10:20Z", "type": "commit"}, {"oid": "984f880496fc95f38e75b9b416f640cdf919868a", "url": "https://github.com/yegor256/cactoos/commit/984f880496fc95f38e75b9b416f640cdf919868a", "message": "(#1169) Remove unused import", "committedDate": "2020-10-19T16:10:31Z", "type": "commit"}, {"oid": "100a03c78d96f0035f9ce161308ef117f58b100d", "url": "https://github.com/yegor256/cactoos/commit/100a03c78d96f0035f9ce161308ef117f58b100d", "message": "(#1169) Fix FindBugs complain", "committedDate": "2020-10-19T16:10:58Z", "type": "commit"}, {"oid": "83f419854ad05d195d20cecb26ab1516caad57f5", "url": "https://github.com/yegor256/cactoos/commit/83f419854ad05d195d20cecb26ab1516caad57f5", "message": "(#1169) Removed `Mapped'", "committedDate": "2020-10-19T16:23:21Z", "type": "commit"}, {"oid": "86b8dbabee297c08707f602e202b8bcbd1dba4a6", "url": "https://github.com/yegor256/cactoos/commit/86b8dbabee297c08707f602e202b8bcbd1dba4a6", "message": "(#1169) Replace `iterator.Mapped' with casting", "committedDate": "2020-10-19T16:23:34Z", "type": "commit"}, {"oid": "97856927ef47a651fad3a39a232b8de4551c35ce", "url": "https://github.com/yegor256/cactoos/commit/97856927ef47a651fad3a39a232b8de4551c35ce", "message": "(#1169) Apply PECS to MapOf", "committedDate": "2020-10-19T16:45:48Z", "type": "commit"}, {"oid": "05655404b739ca708d9f261041292315cac9baa2", "url": "https://github.com/yegor256/cactoos/commit/05655404b739ca708d9f261041292315cac9baa2", "message": "(#1169) Apply PECS to `map.Synced'", "committedDate": "2020-10-19T16:46:37Z", "type": "commit"}, {"oid": "8b9dbef3ca2c55025a5d803202c82f4713b5f954", "url": "https://github.com/yegor256/cactoos/commit/8b9dbef3ca2c55025a5d803202c82f4713b5f954", "message": "(#1169) Add second type parameter for second duplex operator", "committedDate": "2020-10-19T17:01:59Z", "type": "commit"}, {"oid": "dbe3931f8c6d17ce42ea9cd27804ed1b002b5ed7", "url": "https://github.com/yegor256/cactoos/commit/dbe3931f8c6d17ce42ea9cd27804ed1b002b5ed7", "message": "(#1169) Use wild-card type", "committedDate": "2020-10-19T17:03:31Z", "type": "commit"}, {"oid": "2ee1b5d5aabf239d91c03e61828e8a6b052f4958", "url": "https://github.com/yegor256/cactoos/commit/2ee1b5d5aabf239d91c03e61828e8a6b052f4958", "message": "(#1169) Apply PECS", "committedDate": "2020-10-19T17:17:22Z", "type": "commit"}, {"oid": "9cc60e869113ca0044ff5b9c6094c6ff5b7a2529", "url": "https://github.com/yegor256/cactoos/commit/9cc60e869113ca0044ff5b9c6094c6ff5b7a2529", "message": "(#1169) Apply PECS", "committedDate": "2020-10-19T17:22:13Z", "type": "commit"}, {"oid": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "url": "https://github.com/yegor256/cactoos/commit/09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "message": "(#1169) Fix indentation", "committedDate": "2020-10-19T17:23:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1MTcwNg==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508651706", "bodyText": "@andreoss I see you replaced the usage of Mapped with a cast, so this todo should be updated I think. Actually, I'm wondering if casting is not simply acceptable here\u2026 WDYT?", "author": "victornoel", "createdAt": "2020-10-20T16:04:47Z", "path": "src/main/java/org/cactoos/iterable/IterableOf.java", "diffHunk": "@@ -45,14 +45,16 @@\n  * @param <X> Type of item\n  * @since 0.12\n  * @checkstyle ClassDataAbstractionCouplingCheck (550 lines)\n+ * @todo #1169:30m This class uses Mapped in order to coerce wild-card type.\n+ *  Research a more eloquent solution and remove usage of Mapped.", "originalCommit": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc2MzUwNQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508763505", "bodyText": "@victornoel Removed. It seems there is no a better solution than casting for that (which could be put in a decorator)", "author": "andreoss", "createdAt": "2020-10-20T18:50:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1MTcwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1NDI1NQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508654255", "bodyText": "@andreoss here we have mapped, we could either do casting as discussed above or add a todo to find a better solution. But I\u00a0would prefer that if we choose one way, we apply the same everywhere though.", "author": "victornoel", "createdAt": "2020-10-20T16:07:20Z", "path": "src/main/java/org/cactoos/iterable/Solid.java", "diffHunk": "@@ -46,8 +46,8 @@ public Solid(final X... src) {\n      * Ctor.\n      * @param iterable The iterable\n      */\n-    public Solid(final Iterable<X> iterable) {\n-        super(new Synced<>(new Sticky<>(iterable)));\n+    public Solid(final Iterable<? extends X> iterable) {\n+        super(new Synced<>(new Sticky<>(new Mapped<>(x -> x, iterable))));", "originalCommit": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc2MjU3Mg==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508762572", "bodyText": "@victornoel Here it was unnecessary. Removed it", "author": "andreoss", "createdAt": "2020-10-20T18:49:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1NDI1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1NTAzOA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508655038", "bodyText": "@andreoss same here about cast vs mapped, and also about the todo", "author": "victornoel", "createdAt": "2020-10-20T16:07:59Z", "path": "src/main/java/org/cactoos/iterable/Synced.java", "diffHunk": "@@ -73,15 +77,15 @@ public Synced(final Iterable<X> iterable) {\n      * @param lck The lock to synchronize with.\n      * @param iterable The iterable synchronize access to.\n      */\n-    public Synced(final Object lck, final Iterable<X> iterable) {\n+    public Synced(final Object lck, final Iterable<? extends X> iterable) {\n         this.origin = iterable;\n         this.lock = lck;\n     }\n \n     @Override\n     public Iterator<X> iterator() {\n         synchronized (this.lock) {\n-            return this.origin.iterator();\n+            return new Mapped<>(x -> x, this.origin.iterator());", "originalCommit": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc2MjQyMQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508762421", "bodyText": "@victornoel Replaced with casting.", "author": "andreoss", "createdAt": "2020-10-20T18:49:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1NTAzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1Nzc3Ng==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508657776", "bodyText": "@andreoss why change the implementation of next()? Wasn't the previous one correct?", "author": "victornoel", "createdAt": "2020-10-20T16:10:39Z", "path": "src/main/java/org/cactoos/iterator/Mapped.java", "diffHunk": "@@ -24,53 +24,59 @@\n package org.cactoos.iterator;\n \n import java.util.Iterator;\n+import java.util.NoSuchElementException;\n import org.cactoos.Func;\n-import org.cactoos.func.UncheckedFunc;\n+import org.cactoos.scalar.Unchecked;\n \n /**\n  * Mapped iterator.\n  *\n- * <p>There is no thread-safety guarantee.\n+ * <p>\n+ * There is no thread-safety guarantee.\n  *\n- * @param <X> Type of source item\n  * @param <Y> Type of target item\n  * @since 0.1\n  */\n-public final class Mapped<X, Y> implements Iterator<Y> {\n-\n-    /**\n-     * Iterator.\n-     */\n-    private final Iterator<X> origin;\n-\n-    /**\n-     * Function.\n-     */\n-    private final Func<X, Y> fnc;\n+public final class Mapped<Y> extends IteratorEnvelope<Y> {\n \n     /**\n      * Ctor.\n      * @param func Func\n      * @param iterator Source iterator\n+     * @param <X> Type of item\n+     * @checkstyle AnonInnerLengthCheck (60 lines)\n      */\n-    public Mapped(final Func<X, Y> func, final Iterator<X> iterator) {\n-        this.origin = iterator;\n-        this.fnc = func;\n-    }\n+    public <X> Mapped(\n+        final Func<? super X, ? extends Y> func,\n+        final Iterator<? extends X> iterator\n+    ) {\n+        super(\n+            new Iterator<Y>() {\n \n-    @Override\n-    public boolean hasNext() {\n-        return this.origin.hasNext();\n-    }\n+                @Override\n+                public boolean hasNext() {\n+                    return iterator.hasNext();\n+                }\n \n-    @Override\n-    public Y next() {\n-        return new UncheckedFunc<>(this.fnc).apply(this.origin.next());\n-    }\n+                @Override\n+                public Y next() {\n+                    if (this.hasNext()) {\n+                        return new Unchecked<>(\n+                            new org.cactoos.scalar.Mapped<>(\n+                                func, iterator::next\n+                            )\n+                        ).value();\n+                    }\n+                    throw new NoSuchElementException();", "originalCommit": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY3Mjk3OA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508672978", "bodyText": "@victornoel I wanted to reuse scalar.Mapped here, to be consistent between different Mapped implementations.\nFindBugs was triggered by the lack of a hasNext check, not sure why it used to accept  the old code", "author": "andreoss", "createdAt": "2020-10-20T16:29:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1Nzc3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyNzk5MA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r509127990", "bodyText": "@andreoss I see, personally I find that scalar.Mapped makes things harder to read but it is correct anyway, let's keep it like you wrote it :)", "author": "victornoel", "createdAt": "2020-10-21T09:26:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1Nzc3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MDc2Nw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508660767", "bodyText": "@andreoss here we cannot use MapOf because it would create a new map instead of making the wrapped one synchronized.", "author": "victornoel", "createdAt": "2020-10-20T16:13:41Z", "path": "src/main/java/org/cactoos/map/Synced.java", "diffHunk": "@@ -139,16 +156,19 @@ public Synced(final Iterable<Map.Entry<X, Y>> list) {\n      * @param map Pre-existing map we want to extend\n      * @param list Entries for the entries\n      */\n-    public Synced(final Map<X, Y> map,\n-        final Iterable<Map.Entry<X, Y>> list) {\n+    public Synced(\n+        final Map<? extends X, ? extends Y> map,\n+        final Iterable<Map.Entry<? extends X, ? extends Y>> list\n+    ) {\n         this(new MapOf<>(map, list));\n     }\n \n     /**\n      * Ctor.\n      * @param map The map\n      */\n-    public Synced(final Map<X, Y> map) {\n-        super(Collections.synchronizedMap(map));\n+    @SuppressWarnings(\"unchecked\")\n+    public Synced(final Map<? extends X, ? extends Y> map) {\n+        super(Collections.synchronizedMap(new MapOf<>(map)));", "originalCommit": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc2MjA0Mw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508762043", "bodyText": "@victornoel Done.", "author": "andreoss", "createdAt": "2020-10-20T18:48:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MDc2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MTg5Mg==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508661892", "bodyText": "@andreoss here there is still one comparator without the ? super T", "author": "victornoel", "createdAt": "2020-10-20T16:14:44Z", "path": "src/main/java/org/cactoos/set/Sorted.java", "diffHunk": "@@ -54,7 +54,10 @@ public Sorted(final Comparator<T> cmp, final T... array) {\n      * @param src An {@link Iterable}\n      */\n     @SuppressWarnings(\"PMD.ConstructorOnlyInitializesOrCallOtherConstructors\")\n-    public Sorted(final Comparator<T> cmp, final Iterable<T> src) {\n+    public Sorted(\n+        final Comparator<T> cmp,", "originalCommit": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY4ODEzNg==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508688136", "bodyText": "@victornoel Done", "author": "andreoss", "createdAt": "2020-10-20T16:53:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MTg5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyOTgxMQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r509129811", "bodyText": "@andreoss I still don't see it in the PR's diff...", "author": "victornoel", "createdAt": "2020-10-21T09:28:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MTg5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MjM4NA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508662384", "bodyText": "@andreoss why is this needed?", "author": "victornoel", "createdAt": "2020-10-20T16:15:09Z", "path": "src/test/java/org/cactoos/iterable/MappedTest.java", "diffHunk": "@@ -43,10 +42,11 @@\n final class MappedTest {\n \n     @Test\n+    @SuppressWarnings(\"unchecked\")", "originalCommit": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY3Nzc0NQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508677745", "bodyText": "@victornoel It's not. Removed", "author": "andreoss", "createdAt": "2020-10-20T16:37:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MjM4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MzYyMw==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508663623", "bodyText": "@andreoss let's use Assertion here instead of static method MatcherAssert.assertThat", "author": "victornoel", "createdAt": "2020-10-20T16:16:13Z", "path": "src/test/java/org/cactoos/map/GroupedTest.java", "diffHunk": "@@ -83,4 +83,22 @@ void groupedByOneHasEntries() throws Exception {\n             )\n         );\n     }\n+\n+    @Test\n+    void groupedBySuperType() throws Exception {\n+        MatcherAssert.assertThat(", "originalCommit": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY4ODIxOA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508688218", "bodyText": "@victornoel Done", "author": "andreoss", "createdAt": "2020-10-20T16:53:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MzYyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MzkyOA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508663928", "bodyText": "@andreoss while we are at it, let's put an upper case at the beginning of the sentence", "author": "victornoel", "createdAt": "2020-10-20T16:16:40Z", "path": "src/test/java/org/cactoos/list/JoinedTest.java", "diffHunk": "@@ -435,4 +439,25 @@ public void itemAndList() {\n             )\n         ).affirm();\n     }\n+\n+    @Test\n+    public void infersCorrectly() {\n+        new Assertion<>(\n+            \"must be able to infer type of elements\",", "originalCommit": "09a4c60635dabe89cca1b76eef0ba40a3c2e566a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY4ODI2Ng==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r508688266", "bodyText": "@victornoel Done", "author": "andreoss", "createdAt": "2020-10-20T16:53:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MzkyOA=="}], "type": "inlineReview"}, {"oid": "582e8a4cc1b1327304c06bb55078e8d2e109f83d", "url": "https://github.com/yegor256/cactoos/commit/582e8a4cc1b1327304c06bb55078e8d2e109f83d", "message": "(#1169) Remove todo", "committedDate": "2020-10-20T16:22:47Z", "type": "commit"}, {"oid": "cd6b6ede796bc00f45b79a875b2ed587390a4bdc", "url": "https://github.com/yegor256/cactoos/commit/cd6b6ede796bc00f45b79a875b2ed587390a4bdc", "message": "(#1169) Use `Assertion'", "committedDate": "2020-10-20T16:35:23Z", "type": "commit"}, {"oid": "b148b158a2df9e0ccb1301803cf37acd392e0a74", "url": "https://github.com/yegor256/cactoos/commit/b148b158a2df9e0ccb1301803cf37acd392e0a74", "message": "(#1169) Start sentence with upper case letter", "committedDate": "2020-10-20T16:35:40Z", "type": "commit"}, {"oid": "cb2bc717fffc30007f4aa636f621731e4e678e0d", "url": "https://github.com/yegor256/cactoos/commit/cb2bc717fffc30007f4aa636f621731e4e678e0d", "message": "(#1169) Remove unnecessary suppression", "committedDate": "2020-10-20T16:36:02Z", "type": "commit"}, {"oid": "35e6023fb7a9ebe0676654638ef43739cc5591fe", "url": "https://github.com/yegor256/cactoos/commit/35e6023fb7a9ebe0676654638ef43739cc5591fe", "message": "(#1169) Remove unnecessary `Mapped'", "committedDate": "2020-10-20T16:36:30Z", "type": "commit"}, {"oid": "9d3b0216baf360e87dc37a785d00b6f23f691124", "url": "https://github.com/yegor256/cactoos/commit/9d3b0216baf360e87dc37a785d00b6f23f691124", "message": "(#1169) Use casting instead of `Mapped'", "committedDate": "2020-10-20T16:36:52Z", "type": "commit"}, {"oid": "da8dcbeae1400d42be868ba2e57ddfb97c0a5e11", "url": "https://github.com/yegor256/cactoos/commit/da8dcbeae1400d42be868ba2e57ddfb97c0a5e11", "message": "(#1169) Apply PECS for `iterable.Sorted'", "committedDate": "2020-10-20T16:52:44Z", "type": "commit"}, {"oid": "2bc13e5b5f098ce6674dacc41db48d0e79bbc826", "url": "https://github.com/yegor256/cactoos/commit/2bc13e5b5f098ce6674dacc41db48d0e79bbc826", "message": "(#1169) Do not copy map", "committedDate": "2020-10-20T18:47:28Z", "type": "commit"}, {"oid": "5a691d546b170c0257157bb488649e7d65c582d4", "url": "https://github.com/yegor256/cactoos/commit/5a691d546b170c0257157bb488649e7d65c582d4", "message": "(#1169) Use `Assertion'", "committedDate": "2020-10-20T23:49:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyOTQ4NA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r509129484", "bodyText": "@andreoss  seeing this change, I wonder if the next step wouldn't be to do the same thing with covariance with scalars? Do you have an opinion on this?", "author": "victornoel", "createdAt": "2020-10-21T09:28:29Z", "path": "src/main/java/org/cactoos/scalar/Mapped.java", "diffHunk": "@@ -28,45 +28,34 @@\n import org.cactoos.Scalar;\n \n /**\n- * {@link Scalar} that apply a {@link Func} to the result\n- * of another {@link Scalar}.\n+ * {@link Scalar} that apply a {@link Func} to the result of another\n+ * {@link Scalar}.\n  *\n- * <p>There is no thread-safety guarantee.\n+ * <p>\n+ * There is no thread-safety guarantee.\n  *\n- * <p>This class implements {@link Scalar}, which throws a checked\n- * {@link IOException}. This may not be convenient in many cases. To make\n- * it more convenient and get rid of the checked exception you can\n- * use the {@link Unchecked} decorator.</p>\n+ * <p>\n+ * This class implements {@link Scalar}, which throws a checked\n+ * {@link IOException}. This may not be convenient in many cases. To make it\n+ * more convenient and get rid of the checked exception you can use the\n+ * {@link Unchecked} decorator.\n+ * </p>\n  *\n- * @param <T> Type of wrapped scalar result\n  * @param <U> Type of result\n  * @since 1.0.0\n  */\n-public final class Mapped<T, U> implements Scalar<U> {\n-\n-    /**\n-     * Original scalar.\n-     */\n-    private final Scalar<T> origin;\n-\n-    /**\n-     * Func.\n-     */\n-    private final Func<T, U> func;\n-\n+public final class Mapped<U> extends ScalarEnvelope<U> {\n     /**\n      * Ctor.\n-     * @param mapping Fun to apply\n-     * @param scalar Encapsulated scalar\n+     * @param func Map function.\n+     * @param scalar Scalar.\n+     * @param <T> Type of input.\n      */\n-    public Mapped(final Func<T, U> mapping, final Scalar<T> scalar) {\n-        this.origin = scalar;\n-        this.func = mapping;\n-    }\n-\n-    @Override\n-    public U value() throws Exception {\n-        return this.func.apply(this.origin.value());\n+    public <T> Mapped(\n+        final Func<? super T, ? extends U> func,\n+        final Scalar<? extends T> scalar", "originalCommit": "5a691d546b170c0257157bb488649e7d65c582d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE2NTI5OA==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r509165298", "bodyText": "@victornoel Yes, func and proc packages as well", "author": "andreoss", "createdAt": "2020-10-21T10:25:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyOTQ4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE2ODg1OQ==", "url": "https://github.com/yegor256/cactoos/pull/1477#discussion_r509168859", "bodyText": "@andreoss thx, I will create a new ticket in the future, because I have to think about it a bit before :)", "author": "victornoel", "createdAt": "2020-10-21T10:31:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyOTQ4NA=="}], "type": "inlineReview"}, {"oid": "ce9cadc0d37faafac4f1590a90f8a699b802b198", "url": "https://github.com/yegor256/cactoos/commit/ce9cadc0d37faafac4f1590a90f8a699b802b198", "message": "(#1169) Use PECS in `set.Sorted'", "committedDate": "2020-10-21T11:16:49Z", "type": "commit"}, {"oid": "08038b33c27ce7db2b3b1f9b745eb9e17a69c462", "url": "https://github.com/yegor256/cactoos/commit/08038b33c27ce7db2b3b1f9b745eb9e17a69c462", "message": "(#1169) Improve coverage", "committedDate": "2020-10-21T14:05:32Z", "type": "commit"}]}