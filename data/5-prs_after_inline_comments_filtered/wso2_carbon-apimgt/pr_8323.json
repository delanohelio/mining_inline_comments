{"pr_number": 8323, "pr_title": "Sample/Mock Payload Generation with Inline Script Reset Functionality", "pr_createdAt": "2020-03-06T12:12:47Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8323", "timeline": [{"oid": "3d32fbfab93e35e1566b23f0483fe45fd70ea8db", "url": "https://github.com/wso2/carbon-apimgt/commit/3d32fbfab93e35e1566b23f0483fe45fd70ea8db", "message": "Changes made to OAS2Parser and OAS3Parser and OAS3Reader implementation added to APIserviceIMPL", "committedDate": "2020-03-05T11:54:15Z", "type": "commit"}, {"oid": "39d147f5c9c01ee52fc43df9953dabbd6db6a5fa", "url": "https://github.com/wso2/carbon-apimgt/commit/39d147f5c9c01ee52fc43df9953dabbd6db6a5fa", "message": "Merge branch 'master' of https://github.com/wso2/carbon-apimgt", "committedDate": "2020-03-05T11:57:07Z", "type": "commit"}, {"oid": "9bd47f0d9a28796cdbf522001e8507d4200a95a2", "url": "https://github.com/wso2/carbon-apimgt/commit/9bd47f0d9a28796cdbf522001e8507d4200a95a2", "message": "Removing comments", "committedDate": "2020-03-06T04:41:01Z", "type": "commit"}, {"oid": "e1d5d2c12bb8a247d002563fcec9288ac2343d76", "url": "https://github.com/wso2/carbon-apimgt/commit/e1d5d2c12bb8a247d002563fcec9288ac2343d76", "message": "fixed empty scope issue for OAS3Parser", "committedDate": "2020-03-06T11:20:02Z", "type": "commit"}, {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "url": "https://github.com/wso2/carbon-apimgt/commit/1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "message": "commented code lines removed", "committedDate": "2020-03-06T12:01:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDEyMA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870120", "bodyText": "Add class comment", "author": "malinthaprasan", "createdAt": "2020-03-06T12:14:26Z", "path": "components/apimgt/org.wso2.carbon.apimgt.api/src/main/java/org/wso2/carbon/apimgt/api/model/APIResourceMediationPolicy.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.wso2.carbon.apimgt.api.model;\n+\n+public class APIResourceMediationPolicy {", "originalCommit": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDE4NQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870185", "bodyText": "Add license header", "author": "malinthaprasan", "createdAt": "2020-03-06T12:14:36Z", "path": "components/apimgt/org.wso2.carbon.apimgt.api/src/main/java/org/wso2/carbon/apimgt/api/model/APIResourceMediationPolicy.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.wso2.carbon.apimgt.api.model;", "originalCommit": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDM1NA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870354", "bodyText": "Use single imports instead of wildcard imports", "author": "malinthaprasan", "createdAt": "2020-03-06T12:15:01Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/definitions/OAS3Parser.java", "diffHunk": "@@ -60,11 +59,7 @@\n import org.wso2.carbon.apimgt.api.APIManagementException;\n import org.wso2.carbon.apimgt.api.ErrorItem;\n import org.wso2.carbon.apimgt.api.ExceptionCodes;\n-import org.wso2.carbon.apimgt.api.model.API;\n-import org.wso2.carbon.apimgt.api.model.APIProduct;\n-import org.wso2.carbon.apimgt.api.model.Scope;\n-import org.wso2.carbon.apimgt.api.model.SwaggerData;\n-import org.wso2.carbon.apimgt.api.model.URITemplate;\n+import org.wso2.carbon.apimgt.api.model.*;", "originalCommit": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDU0MQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870541", "bodyText": "Define and use constants", "author": "malinthaprasan", "createdAt": "2020-03-06T12:15:30Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/definitions/OAS3Parser.java", "diffHunk": "@@ -149,14 +159,52 @@ public String generateExample(String apiDefinition) {\n                         }\n                         if (applicationJson == null && applicationXml == null) {\n                             setDefaultGeneratedResponse(genCode);\n+\n                         }\n                     }\n                 }\n                 genCode.append(responseSection);\n-                op.addExtension(\"x-mediation-script\", genCode);\n+                String finalGenCode = genCode.toString();\n+                apiResourceMediationPolicyObject.setContent(finalGenCode);\n+                op.addExtension(APIConstants.SWAGGER_X_MEDIATION_SCRIPT, genCode);\n+                apiResourceMediationPolicyList.add(apiResourceMediationPolicyObject);\n             }\n+\n+            checkAndSetEmptyScope(swagger);\n+            returnMap.put(\"SWAGGER\", Json.pretty(swagger));\n+            returnMap.put(\"policyList\", apiResourceMediationPolicyList);", "originalCommit": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDgxNQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870815", "bodyText": "Use single imports", "author": "malinthaprasan", "createdAt": "2020-03-06T12:16:08Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/utils/mappings/APIMappingUtil.java", "diffHunk": "@@ -32,21 +32,7 @@\n import org.wso2.carbon.apimgt.api.ErrorHandler;\n import org.wso2.carbon.apimgt.api.ExceptionCodes;\n import org.wso2.carbon.apimgt.api.WorkflowStatus;\n-import org.wso2.carbon.apimgt.api.model.API;\n-import org.wso2.carbon.apimgt.api.model.APICategory;\n-import org.wso2.carbon.apimgt.api.model.APIIdentifier;\n-import org.wso2.carbon.apimgt.api.model.APIProduct;\n-import org.wso2.carbon.apimgt.api.model.APIProductIdentifier;\n-import org.wso2.carbon.apimgt.api.model.APIProductResource;\n-import org.wso2.carbon.apimgt.api.model.APIStatus;\n-import org.wso2.carbon.apimgt.api.model.APIStateChangeResponse;\n-import org.wso2.carbon.apimgt.api.model.CORSConfiguration;\n-import org.wso2.carbon.apimgt.api.model.Label;\n-import org.wso2.carbon.apimgt.api.model.LifeCycleEvent;\n-import org.wso2.carbon.apimgt.api.model.ResourcePath;\n-import org.wso2.carbon.apimgt.api.model.Scope;\n-import org.wso2.carbon.apimgt.api.model.Tier;\n-import org.wso2.carbon.apimgt.api.model.URITemplate;\n+import org.wso2.carbon.apimgt.api.model.*;", "originalCommit": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDkxOQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870919", "bodyText": "Method comments", "author": "malinthaprasan", "createdAt": "2020-03-06T12:16:23Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/utils/mappings/APIMappingUtil.java", "diffHunk": "@@ -268,6 +254,39 @@ public static API fromDTOtoAPI(APIDTO dto, String provider) throws APIManagement\n         return model;\n     }\n \n+    /**\n+     *\n+     *\n+     * @param mockPayloads\n+     * @return\n+     * @throws APIManagementException\n+     */", "originalCommit": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MTAxNw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388871017", "bodyText": "Add proper method comments", "author": "malinthaprasan", "createdAt": "2020-03-06T12:16:35Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/utils/mappings/APIMappingUtil.java", "diffHunk": "@@ -268,6 +254,39 @@ public static API fromDTOtoAPI(APIDTO dto, String provider) throws APIManagement\n         return model;\n     }\n \n+    /**\n+     *\n+     *\n+     * @param mockPayloads\n+     * @return\n+     * @throws APIManagementException\n+     */\n+    public static MockResponsePayloadListDTO fromMockPayloadsToListDTO (List<APIResourceMediationPolicy> mockPayloads)\n+            throws APIManagementException {\n+\n+        MockResponsePayloadListDTO mockResponsePayloadListDTO = new MockResponsePayloadListDTO();\n+        List<MockResponsePayloadInfoDTO> mockResponsePayloadInfoDTOS = mockResponsePayloadListDTO.getList();\n+        for (APIResourceMediationPolicy apiResourceMediationPolicy : mockPayloads){\n+            mockResponsePayloadInfoDTOS.add(fromMockPayloadToDTO(apiResourceMediationPolicy));\n+        }\n+        return mockResponsePayloadListDTO;\n+    }\n+\n+    /**\n+     *\n+     *\n+     * @param model\n+     * @return\n+     */", "originalCommit": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2433e78cac66f999ecd97606ef0266e73f964d91", "url": "https://github.com/wso2/carbon-apimgt/commit/2433e78cac66f999ecd97606ef0266e73f964d91", "message": "edited method comments, class comments, licence headers and constants", "committedDate": "2020-03-10T05:59:47Z", "type": "commit"}, {"oid": "16a5b55e586e5a87b5fa6dad7943de0a1fe2d7cd", "url": "https://github.com/wso2/carbon-apimgt/commit/16a5b55e586e5a87b5fa6dad7943de0a1fe2d7cd", "message": "removing mistake in publisher-api.yaml (ThreatProtectionPolicy)", "committedDate": "2020-03-10T06:43:26Z", "type": "commit"}, {"oid": "1babf667de9c64d14062c75b6431ce9eaa5a8c2e", "url": "https://github.com/wso2/carbon-apimgt/commit/1babf667de9c64d14062c75b6431ce9eaa5a8c2e", "message": "wildcard import in OAS2Parser fixed to single imports", "committedDate": "2020-03-10T06:50:06Z", "type": "commit"}]}