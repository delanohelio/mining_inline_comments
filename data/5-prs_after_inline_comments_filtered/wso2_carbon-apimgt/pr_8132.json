{"pr_number": 8132, "pr_title": "Button from the Publisher UI to Download APIs", "pr_createdAt": "2020-01-30T09:50:10Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8132", "timeline": [{"oid": "f51e7cb6aaa2e176ab79ddd6251dd370f7bcabdc", "url": "https://github.com/wso2/carbon-apimgt/commit/f51e7cb6aaa2e176ab79ddd6251dd370f7bcabdc", "message": "Adding ExportApi to publisher v1", "committedDate": "2020-01-21T05:45:18Z", "type": "commit"}, {"oid": "de22e91edd44456047b4307ef8096fc1c9547134", "url": "https://github.com/wso2/carbon-apimgt/commit/de22e91edd44456047b4307ef8096fc1c9547134", "message": "Creatinng a button in the Frontend", "committedDate": "2020-01-22T09:24:43Z", "type": "commit"}, {"oid": "94f8a4293cb60efbaaa4a070dd5921e5cace2750", "url": "https://github.com/wso2/carbon-apimgt/commit/94f8a4293cb60efbaaa4a070dd5921e5cace2750", "message": "Exporting an API as a zip file", "committedDate": "2020-01-22T09:27:58Z", "type": "commit"}, {"oid": "3b4c6d43fdb49d0ad2fcbc328a1d113e7e92eec4", "url": "https://github.com/wso2/carbon-apimgt/commit/3b4c6d43fdb49d0ad2fcbc328a1d113e7e92eec4", "message": "Adding apim:create to scopes", "committedDate": "2020-01-23T03:51:12Z", "type": "commit"}, {"oid": "7b34ad77796e10b243dabaf3487ee7956d078935", "url": "https://github.com/wso2/carbon-apimgt/commit/7b34ad77796e10b243dabaf3487ee7956d078935", "message": "Minor Changes", "committedDate": "2020-01-23T09:51:36Z", "type": "commit"}, {"oid": "280893e6b20485a00ffd0e821794a6a330d04094", "url": "https://github.com/wso2/carbon-apimgt/commit/280893e6b20485a00ffd0e821794a6a330d04094", "message": "Merge branch 'master' of https://github.com/wso2/carbon-apimgt into importApi", "committedDate": "2020-01-23T09:53:39Z", "type": "commit"}, {"oid": "ccdaeae0de3d81b375aa6b3f0cc8d1e7d475cd04", "url": "https://github.com/wso2/carbon-apimgt/commit/ccdaeae0de3d81b375aa6b3f0cc8d1e7d475cd04", "message": "Merge branch 'master' of https://github.com/wso2/carbon-apimgt into importApi", "committedDate": "2020-01-24T04:23:06Z", "type": "commit"}, {"oid": "5a77185d7026b6c1f86660017d583a37e4539543", "url": "https://github.com/wso2/carbon-apimgt/commit/5a77185d7026b6c1f86660017d583a37e4539543", "message": "Minor Changes", "committedDate": "2020-01-24T08:38:58Z", "type": "commit"}, {"oid": "831cd479295c7ae2da33f3871f0d71a32ac4f4c0", "url": "https://github.com/wso2/carbon-apimgt/commit/831cd479295c7ae2da33f3871f0d71a32ac4f4c0", "message": "Adding jsdocs", "committedDate": "2020-01-24T09:14:24Z", "type": "commit"}, {"oid": "68d50777e10b7ef6b01c48ef154beb530fd74fd3", "url": "https://github.com/wso2/carbon-apimgt/commit/68d50777e10b7ef6b01c48ef154beb530fd74fd3", "message": "Merge branch 'master' of https://github.com/wso2/carbon-apimgt into importApi", "committedDate": "2020-01-27T11:06:34Z", "type": "commit"}, {"oid": "a9482205d79076942380e95bee375481c3c0d9cc", "url": "https://github.com/wso2/carbon-apimgt/commit/a9482205d79076942380e95bee375481c3c0d9cc", "message": "minor changes", "committedDate": "2020-01-28T04:02:35Z", "type": "commit"}, {"oid": "796daa34486d7c42d5f35aaa58ffa14ce978724c", "url": "https://github.com/wso2/carbon-apimgt/commit/796daa34486d7c42d5f35aaa58ffa14ce978724c", "message": "Creating ExportApi class", "committedDate": "2020-01-28T09:11:49Z", "type": "commit"}, {"oid": "25aeff6969605965642599a79e16497e11d3ddbe", "url": "https://github.com/wso2/carbon-apimgt/commit/25aeff6969605965642599a79e16497e11d3ddbe", "message": "Changing Visibility", "committedDate": "2020-01-29T06:58:16Z", "type": "commit"}, {"oid": "75b8a1f40693be10d2671f1d1c2a894de2fe836a", "url": "https://github.com/wso2/carbon-apimgt/commit/75b8a1f40693be10d2671f1d1c2a894de2fe836a", "message": "Moving Busiines logic to the impl layer", "committedDate": "2020-01-30T08:02:54Z", "type": "commit"}, {"oid": "ce943f787a9b92e3a7c1e071b5d05c6506e67bc0", "url": "https://github.com/wso2/carbon-apimgt/commit/ce943f787a9b92e3a7c1e071b5d05c6506e67bc0", "message": "Merge branch 'master' of https://github.com/wso2/carbon-apimgt into importApi", "committedDate": "2020-01-30T08:08:35Z", "type": "commit"}, {"oid": "9b472dc1a182571cd0ef21a8476233930c09edec", "url": "https://github.com/wso2/carbon-apimgt/commit/9b472dc1a182571cd0ef21a8476233930c09edec", "message": "Intorducing UUID as a query parameter", "committedDate": "2020-01-30T14:13:45Z", "type": "commit"}, {"oid": "63faf060efce6da3b561a01303ae85c64405c4fa", "url": "https://github.com/wso2/carbon-apimgt/commit/63faf060efce6da3b561a01303ae85c64405c4fa", "message": "Merge branch 'master' of https://github.com/wso2/carbon-apimgt into importApi", "committedDate": "2020-01-30T14:14:53Z", "type": "commit"}, {"oid": "4fb20e797e7609a20d534bad0fc7ba1212869ead", "url": "https://github.com/wso2/carbon-apimgt/commit/4fb20e797e7609a20d534bad0fc7ba1212869ead", "message": "Removing UUID as query param", "committedDate": "2020-01-30T16:04:17Z", "type": "commit"}, {"oid": "758a2291ec69d8747e52941f8e14026d7616a4e2", "url": "https://github.com/wso2/carbon-apimgt/commit/758a2291ec69d8747e52941f8e14026d7616a4e2", "message": "minor changes", "committedDate": "2020-01-31T01:05:05Z", "type": "commit"}, {"oid": "1e17a61c7f1df1c5cbeb2f17879eafc76f9be5e1", "url": "https://github.com/wso2/carbon-apimgt/commit/1e17a61c7f1df1c5cbeb2f17879eafc76f9be5e1", "message": "Introdusing UUID as a query param", "committedDate": "2020-01-31T05:29:02Z", "type": "commit"}, {"oid": "9c9be698787feb125a4ea5faf797ddc9c0f52d59", "url": "https://github.com/wso2/carbon-apimgt/commit/9c9be698787feb125a4ea5faf797ddc9c0f52d59", "message": "Code formating", "committedDate": "2020-01-31T06:22:28Z", "type": "commit"}, {"oid": "36415195e605fd76c5c7f886b4af158a3fa0be9f", "url": "https://github.com/wso2/carbon-apimgt/commit/36415195e605fd76c5c7f886b4af158a3fa0be9f", "message": "Merge branch 'master' of https://github.com/wso2/carbon-apimgt into importApi", "committedDate": "2020-01-31T06:23:45Z", "type": "commit"}, {"oid": "27ddf2a5412106d415666878af1f98a805ba40c8", "url": "https://github.com/wso2/carbon-apimgt/commit/27ddf2a5412106d415666878af1f98a805ba40c8", "message": "Merge branch 'master' of https://github.com/wso2/carbon-apimgt into importApi", "committedDate": "2020-01-31T07:59:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM3NDk4Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8132#discussion_r373374987", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        RestApiUtil.handleBadRequest(\"None of 'name', 'version' or 'provider' should not be null\", log);\n          \n          \n            \n                        RestApiUtil.handleBadRequest(\"'name', 'version' or 'provider' should not be null\", log);", "author": "malinthaprasan", "createdAt": "2020-01-31T09:02:04Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.util/src/main/java/org/wso2/carbon/apimgt/rest/api/util/impl/ExportApiUtil.java", "diffHunk": "@@ -0,0 +1,136 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.carbon.apimgt.rest.api.util.impl;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.apimgt.api.APIManagementException;\n+import org.wso2.carbon.apimgt.api.APIProvider;\n+import org.wso2.carbon.apimgt.api.model.APIIdentifier;\n+import org.wso2.carbon.apimgt.impl.importexport.APIImportExportException;\n+import org.wso2.carbon.apimgt.impl.importexport.ExportFormat;\n+import org.wso2.carbon.apimgt.impl.importexport.utils.APIExportUtil;\n+import org.wso2.carbon.apimgt.impl.utils.APIUtil;\n+import org.wso2.carbon.apimgt.rest.api.util.RestApiConstants;\n+import org.wso2.carbon.apimgt.rest.api.util.utils.RestApiUtil;\n+import org.wso2.carbon.utils.multitenancy.MultitenantUtils;\n+\n+import javax.ws.rs.core.Response;\n+import java.io.File;\n+\n+public class ExportApiUtil {\n+    private static final Log log = LogFactory.getLog(ExportApiUtil.class);\n+    private static final String APPLICATION_EXPORT_DIR_PREFIX = \"exported-app-archives-\";\n+    private static final String DEFAULT_APPLICATION_EXPORT_DIR = \"exported-application\";\n+    private static final String PRODUCTION = \"PRODUCTION\";\n+    private static final String SANDBOX = \"SANDBOX\";\n+\n+    /**\n+     * Exports an API from API Manager for a given API ID. Meta information, API icon, documentation, WSDL\n+     * and sequences are exported. This service generates a zipped archive which contains all the above mentioned\n+     * resources for a given API.\n+     *\n+     * @param name           Name of the API that needs to be exported\n+     * @param version        Version of the API that needs to be exported\n+     * @param providerName   Provider name of the API that needs to be exported\n+     * @param format         Format of output documents. Can be YAML or JSON\n+     * @param preserveStatus Preserve API status on export\n+     * @return Zipped file containing exported API\n+     */\n+\n+    public Response exportApiByParams(String name, String version, String providerName, String format, Boolean preserveStatus) {\n+        ExportFormat exportFormat;\n+        String userName;\n+        APIIdentifier apiIdentifier;\n+        APIProvider apiProvider;\n+        String apiDomain;\n+        String apiRequesterDomain;\n+        File file;\n+        //If not specified status is preserved by default\n+        boolean isStatusPreserved = preserveStatus == null || preserveStatus;\n+\n+        if (name == null || version == null || providerName == null) {\n+            RestApiUtil.handleBadRequest(\"None of 'name', 'version' or 'provider' should not be null\", log);", "originalCommit": "27ddf2a5412106d415666878af1f98a805ba40c8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM3ODM2Ng==", "url": "https://github.com/wso2/carbon-apimgt/pull/8132#discussion_r373378366", "bodyText": "Done", "author": "VimukthiMayadunne", "createdAt": "2020-01-31T09:10:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM3NDk4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM3NTM0MA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8132#discussion_r373375340", "bodyText": "Remove unused constants", "author": "malinthaprasan", "createdAt": "2020-01-31T09:03:04Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.util/src/main/java/org/wso2/carbon/apimgt/rest/api/util/impl/ExportApiUtil.java", "diffHunk": "@@ -0,0 +1,136 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.carbon.apimgt.rest.api.util.impl;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.apimgt.api.APIManagementException;\n+import org.wso2.carbon.apimgt.api.APIProvider;\n+import org.wso2.carbon.apimgt.api.model.APIIdentifier;\n+import org.wso2.carbon.apimgt.impl.importexport.APIImportExportException;\n+import org.wso2.carbon.apimgt.impl.importexport.ExportFormat;\n+import org.wso2.carbon.apimgt.impl.importexport.utils.APIExportUtil;\n+import org.wso2.carbon.apimgt.impl.utils.APIUtil;\n+import org.wso2.carbon.apimgt.rest.api.util.RestApiConstants;\n+import org.wso2.carbon.apimgt.rest.api.util.utils.RestApiUtil;\n+import org.wso2.carbon.utils.multitenancy.MultitenantUtils;\n+\n+import javax.ws.rs.core.Response;\n+import java.io.File;\n+\n+public class ExportApiUtil {\n+    private static final Log log = LogFactory.getLog(ExportApiUtil.class);\n+    private static final String APPLICATION_EXPORT_DIR_PREFIX = \"exported-app-archives-\";\n+    private static final String DEFAULT_APPLICATION_EXPORT_DIR = \"exported-application\";\n+    private static final String PRODUCTION = \"PRODUCTION\";\n+    private static final String SANDBOX = \"SANDBOX\";", "originalCommit": "27ddf2a5412106d415666878af1f98a805ba40c8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM3ODMyOA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8132#discussion_r373378328", "bodyText": "Done", "author": "VimukthiMayadunne", "createdAt": "2020-01-31T09:10:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM3NTM0MA=="}], "type": "inlineReview"}, {"oid": "b2cfcc1cdb910a92d88d3327deb11fc369a990a9", "url": "https://github.com/wso2/carbon-apimgt/commit/b2cfcc1cdb910a92d88d3327deb11fc369a990a9", "message": "Minor Changes", "committedDate": "2020-01-31T09:33:02Z", "type": "commit"}, {"oid": "f4cf3893d9090895e23a637f7f4f085bda6d955b", "url": "https://github.com/wso2/carbon-apimgt/commit/f4cf3893d9090895e23a637f7f4f085bda6d955b", "message": "Removing Async function", "committedDate": "2020-01-31T09:45:31Z", "type": "commit"}, {"oid": "7e2ac466360ae7603cb0f3e62ba00406b4fc6e3d", "url": "https://github.com/wso2/carbon-apimgt/commit/7e2ac466360ae7603cb0f3e62ba00406b4fc6e3d", "message": "UI code formating", "committedDate": "2020-01-31T10:49:35Z", "type": "commit"}, {"oid": "8ee8c394667cf612e844aec8a8c840a7afbf86ce", "url": "https://github.com/wso2/carbon-apimgt/commit/8ee8c394667cf612e844aec8a8c840a7afbf86ce", "message": "UI code formating", "committedDate": "2020-01-31T10:59:45Z", "type": "commit"}, {"oid": "4ed96f90d5c0df86aac74f426c80e1477006ac3e", "url": "https://github.com/wso2/carbon-apimgt/commit/4ed96f90d5c0df86aac74f426c80e1477006ac3e", "message": "UI code formating", "committedDate": "2020-01-31T11:01:12Z", "type": "commit"}]}