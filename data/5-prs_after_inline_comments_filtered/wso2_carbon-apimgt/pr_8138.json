{"pr_number": 8138, "pr_title": "Fix issue when updating resources in REST APIs created from WSDL", "pr_createdAt": "2020-02-03T03:26:08Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8138", "timeline": [{"oid": "db966455138a0c30093f71fb5c8ed358ce90b5ed", "url": "https://github.com/wso2/carbon-apimgt/commit/db966455138a0c30093f71fb5c8ed358ce90b5ed", "message": "Update sequences of APIs created from WSDL when swagger is updated", "committedDate": "2020-01-30T09:16:01Z", "type": "commit"}, {"oid": "2ad1340572553fb7e744a6eaa8fe671c816aad16", "url": "https://github.com/wso2/carbon-apimgt/commit/2ad1340572553fb7e744a6eaa8fe671c816aad16", "message": "Fix issue when adding new resources to SOAP to REST APIs", "committedDate": "2020-02-03T03:10:26Z", "type": "commit"}, {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc", "url": "https://github.com/wso2/carbon-apimgt/commit/46350c1e3bfc5ec65235aa8d1a906f09100e05bc", "message": "Fix issue when modifying WSDL resources with path parameters", "committedDate": "2020-02-03T03:13:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMDk0OA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r373920948", "bodyText": "What does this flag does? Hope if someone update the sequence it won't get affected.", "author": "harsha89", "createdAt": "2020-02-03T04:48:01Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/impl/ApisApiServiceImpl.java", "diffHunk": "@@ -2828,6 +2832,9 @@ public Response apisApiIdSwaggerPut(String apiId, String apiDefinition, String u\n                 apiDefinition = validationResponse.getJsonContent();\n             }\n             String updatedSwagger = updateSwagger(apiId, apiDefinition);\n+            if (isSoapToRestConvertedAPI) {", "originalCommit": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMjg3OQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r373922879", "bodyText": "When updating swagger definition, for REST APIs created from SOAP back-end, we need to update the the generated sequences. This flag is used to differentiate the APIs created from WSDL.\nYes, if someone updates the sequence directly, that won't get affected as it uses a different API - [1]\n[1] https://github.com/wso2/carbon-apimgt/blob/master/components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/impl/ApisApiServiceImpl.java#L2695", "author": "vithu30", "createdAt": "2020-02-03T05:01:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMDk0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMTYwMQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r373921601", "bodyText": "Is this split correct? \"[{]\" or should it be \"[{\"", "author": "tharikaGitHub", "createdAt": "2020-02-03T04:52:33Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/SequenceGenerator.java", "diffHunk": "@@ -187,8 +191,23 @@ public static void generateSequencesFromSwagger(String swaggerStr, APIIdentifier\n                     String inSequence = template.getMappingInSequence(sequenceMap, operationId, soapAction,\n                             namespace, soapNamespace, arraySequenceElements);\n                     String outSequence = template.getMappingOutSequence();\n-                    saveApiSequences(apiIdentifier, inSequence, outSequence, httpMethod.toString().toLowerCase(),\n-                            pathName);\n+                    if (isResourceFromWSDL) {\n+                        Pattern pattern = Pattern.compile(\"[{}]\");\n+                        Matcher hasSpecialCharacters = pattern.matcher(pathName);\n+                        if (hasSpecialCharacters.find()) {\n+                            String resourcePathName = pathName.split(\"[{]\")[0];", "originalCommit": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTc4ODQyNA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r375788424", "bodyText": "yes, it is added to escape the special character \"{\"", "author": "vithu30", "createdAt": "2020-02-06T11:44:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMTYwMQ=="}], "type": "inlineReview"}, {"oid": "5569049ecdc9aab4ffd3fc43f027b327c8d20608", "url": "https://github.com/wso2/carbon-apimgt/commit/5569049ecdc9aab4ffd3fc43f027b327c8d20608", "message": "Fix review comments", "committedDate": "2020-02-06T12:48:46Z", "type": "commit"}, {"oid": "5569049ecdc9aab4ffd3fc43f027b327c8d20608", "url": "https://github.com/wso2/carbon-apimgt/commit/5569049ecdc9aab4ffd3fc43f027b327c8d20608", "message": "Fix review comments", "committedDate": "2020-02-06T12:48:46Z", "type": "forcePushed"}, {"oid": "6cf75cd2c0a9bb73aaa06266fa188d1b985af574", "url": "https://github.com/wso2/carbon-apimgt/commit/6cf75cd2c0a9bb73aaa06266fa188d1b985af574", "message": "Update fork", "committedDate": "2020-02-06T12:55:00Z", "type": "commit"}, {"oid": "f59645f66ce9edd779f405246a3e753740434bf4", "url": "https://github.com/wso2/carbon-apimgt/commit/f59645f66ce9edd779f405246a3e753740434bf4", "message": "Add registry property to sequences to handle path parameter case", "committedDate": "2020-02-07T08:18:51Z", "type": "forcePushed"}, {"oid": "f8f44889ffcb8100ef2bce232d2e30bbb292521a", "url": "https://github.com/wso2/carbon-apimgt/commit/f8f44889ffcb8100ef2bce232d2e30bbb292521a", "message": "Add registry property to sequences to handle path parameter case", "committedDate": "2020-02-07T08:59:44Z", "type": "forcePushed"}, {"oid": "e8b2998788dbed5b71e2fc08852a4586b8ccaa2a", "url": "https://github.com/wso2/carbon-apimgt/commit/e8b2998788dbed5b71e2fc08852a4586b8ccaa2a", "message": "Add registry property to sequences to handle path parameter case", "committedDate": "2020-02-07T09:04:00Z", "type": "forcePushed"}, {"oid": "a38ba95f35e84b2d9b4d3f45a72c0bb1a0407ae8", "url": "https://github.com/wso2/carbon-apimgt/commit/a38ba95f35e84b2d9b4d3f45a72c0bb1a0407ae8", "message": "Add registry property to sequences to handle path parameter case", "committedDate": "2020-02-07T09:15:21Z", "type": "commit"}, {"oid": "a38ba95f35e84b2d9b4d3f45a72c0bb1a0407ae8", "url": "https://github.com/wso2/carbon-apimgt/commit/a38ba95f35e84b2d9b4d3f45a72c0bb1a0407ae8", "message": "Add registry property to sequences to handle path parameter case", "committedDate": "2020-02-07T09:15:21Z", "type": "forcePushed"}]}