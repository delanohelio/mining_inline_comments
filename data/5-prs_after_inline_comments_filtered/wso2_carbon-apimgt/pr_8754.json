{"pr_number": 8754, "pr_title": "Fix missing notification events issue", "pr_createdAt": "2020-06-15T13:02:29Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8754", "timeline": [{"oid": "9889290a078c42797f72abc243ed1077a77d43c0", "url": "https://github.com/wso2/carbon-apimgt/commit/9889290a078c42797f72abc243ed1077a77d43c0", "message": "fix missing notification events", "committedDate": "2020-06-15T13:10:19Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI0MzA3MQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8754#discussion_r441243071", "bodyText": "don't we hv to send subscription related events?", "author": "chamilaadhi", "createdAt": "2020-06-17T02:21:21Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIProviderImpl.java", "diffHunk": "@@ -2291,6 +2292,12 @@ public void makeAPIKeysForwardCompatible(API api) throws APIManagementException\n             apiMgtDAO.makeKeysForwardCompatible(new ApiTypeWrapper(api), oldVersion\n             );\n         }\n+        int apiId = apiMgtDAO.getAPIID(api.getId(), null);\n+        APIEvent apiEvent = new APIEvent(UUID.randomUUID().toString(), System.currentTimeMillis(),", "originalCommit": "9889290a078c42797f72abc243ed1077a77d43c0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM1MDkyNA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8754#discussion_r441350924", "bodyText": "resolved", "author": "CrowleyRajapakse", "createdAt": "2020-06-17T07:51:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI0MzA3MQ=="}], "type": "inlineReview"}, {"oid": "ed68d7667612da32d17f63eff571869f1bd9cb7d", "url": "https://github.com/wso2/carbon-apimgt/commit/ed68d7667612da32d17f63eff571869f1bd9cb7d", "message": "fix missing notification events", "committedDate": "2020-06-17T05:34:38Z", "type": "forcePushed"}, {"oid": "af98df696fced642eda0ae0bcfc045c008cfeebe", "url": "https://github.com/wso2/carbon-apimgt/commit/af98df696fced642eda0ae0bcfc045c008cfeebe", "message": "fix missing notification events", "committedDate": "2020-06-17T05:38:31Z", "type": "commit"}, {"oid": "af98df696fced642eda0ae0bcfc045c008cfeebe", "url": "https://github.com/wso2/carbon-apimgt/commit/af98df696fced642eda0ae0bcfc045c008cfeebe", "message": "fix missing notification events", "committedDate": "2020-06-17T05:38:31Z", "type": "forcePushed"}, {"oid": "c2642272efaca3507463a56717724c061565ef25", "url": "https://github.com/wso2/carbon-apimgt/commit/c2642272efaca3507463a56717724c061565ef25", "message": "adding missing multi-dc changes", "committedDate": "2020-06-17T06:33:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM2NzcxNQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8754#discussion_r441367715", "bodyText": "I don't think you have to pass the tenant Id , you could get the tenant id from the API provider using APIUtil.getTenantId(APIUtil.replaceEmailDomainBack(api.getId().getProviderName())", "author": "chamilaadhi", "createdAt": "2020-06-17T08:19:48Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIProviderImpl.java", "diffHunk": "@@ -2288,8 +2289,7 @@ public void makeAPIKeysForwardCompatible(API api) throws APIManagementException\n         Collections.sort(sortedAPIs, comparator);\n         for (int i = sortedAPIs.size() - 1; i >= 0; i--) {\n             String oldVersion = sortedAPIs.get(i).getId().getVersion();\n-            apiMgtDAO.makeKeysForwardCompatible(new ApiTypeWrapper(api), oldVersion\n-            );\n+            apiMgtDAO.makeKeysForwardCompatible(new ApiTypeWrapper(api), oldVersion, tenantId);\n         }", "originalCommit": "c2642272efaca3507463a56717724c061565ef25", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5NDU3NA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8754#discussion_r441394574", "bodyText": "resolved", "author": "CrowleyRajapakse", "createdAt": "2020-06-17T09:02:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM2NzcxNQ=="}], "type": "inlineReview"}, {"oid": "394d1f883e536c2a20ea790593ffd2dedb00f0f3", "url": "https://github.com/wso2/carbon-apimgt/commit/394d1f883e536c2a20ea790593ffd2dedb00f0f3", "message": "requested changes", "committedDate": "2020-06-17T08:57:43Z", "type": "commit"}]}