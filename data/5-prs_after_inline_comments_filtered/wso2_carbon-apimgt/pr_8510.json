{"pr_number": 8510, "pr_title": "Add validation for existing registry name", "pr_createdAt": "2020-05-15T06:41:57Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8510", "timeline": [{"oid": "a83899f911b7cb36d32e88ee348338a2c27c5d57", "url": "https://github.com/wso2/carbon-apimgt/commit/a83899f911b7cb36d32e88ee348338a2c27c5d57", "message": "Add validation for existing registry name", "committedDate": "2020-05-15T06:41:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTYzODQ3Mg==", "url": "https://github.com/wso2/carbon-apimgt/pull/8510#discussion_r425638472", "bodyText": "I think when the registry name already exists in DB, it will throw 500, internal server error response. If so we need to change it to 409 Resource already exists", "author": "vithu30", "createdAt": "2020-05-15T08:13:20Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/EndpointRegistryImpl.java", "diffHunk": "@@ -191,10 +191,29 @@ public void deleteEndpointRegistryEntry(String entryId) throws APIManagementExce\n     /**\n      * {@inheritDoc}\n      */\n-    public void updateEndpointRegistry(String registryId, EndpointRegistryInfo endpointRegistryInfo) throws\n-            APIManagementException {\n+    public void updateEndpointRegistry(String registryId, String registryName, EndpointRegistryInfo\n+            endpointRegistryInfo) throws APIManagementException {\n+\n+        String tenantDomain = MultitenantUtils\n+                .getTenantDomain(APIUtil.replaceEmailDomainBack(endpointRegistryInfo.getOwner()));\n+        int tenantId;\n+        try {\n+            tenantId = ServiceReferenceHolder.getInstance().getRealmService().getTenantManager()\n+                    .getTenantId(tenantDomain);\n+            // if another registry with the updated name already exists, fail the operation.\n+            if (!registryName.equals(endpointRegistryInfo.getName()) &&", "originalCommit": "a83899f911b7cb36d32e88ee348338a2c27c5d57", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e1567b27623e42b41ccff89175c890d9c6ee2c22", "url": "https://github.com/wso2/carbon-apimgt/commit/e1567b27623e42b41ccff89175c890d9c6ee2c22", "message": "Catch resource already exists exception", "committedDate": "2020-05-15T08:50:00Z", "type": "commit"}]}