{"pr_number": 239, "pr_title": "Add Null Check to Command Validation", "pr_createdAt": "2020-08-13T19:31:37Z", "pr_url": "https://github.com/cryostatio/cryostat/pull/239", "timeline": [{"oid": "274dc2c51ad55eccf6722f6685d6a69c89d3a855", "url": "https://github.com/cryostatio/cryostat/commit/274dc2c51ad55eccf6722f6685d6a69c89d3a855", "message": "Add null check for command validation", "committedDate": "2020-08-13T18:41:31Z", "type": "commit"}, {"oid": "26a8da3e1dc73837ef46c16a15645cfc3aa9b9e9", "url": "https://github.com/cryostatio/cryostat/commit/26a8da3e1dc73837ef46c16a15645cfc3aa9b9e9", "message": "Fix small typo", "committedDate": "2020-08-13T18:44:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIxNDQ3MQ==", "url": "https://github.com/cryostatio/cryostat/pull/239#discussion_r470214471", "bodyText": "This snippet looks like it's worth extracting to a utility method somewhere, rather than copy-pasting the implementation around.", "author": "andrewazores", "createdAt": "2020-08-13T20:02:14Z", "path": "src/main/java/com/redhat/rhjmc/containerjfr/commands/internal/DeleteCommand.java", "diffHunk": "@@ -135,6 +135,14 @@ public void validate(String[] args) throws FailedValidationException {\n             throw new FailedValidationException(errorMessage);\n         }\n \n+        for (String arg : args) {\n+            if (arg == null) {\n+                String errorMessage = \"One or more arguments were null\";\n+                cw.println(errorMessage);\n+                throw new FailedValidationException(errorMessage);\n+            }\n+        }\n+", "originalCommit": "26a8da3e1dc73837ef46c16a15645cfc3aa9b9e9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIxNTAwNg==", "url": "https://github.com/cryostatio/cryostat/pull/239#discussion_r470215006", "bodyText": "For commands which expect 0 arguments, does it still make sense to make assertions about the contents of an empty array? They (should have) already validated that the array has length 0 at this point.", "author": "andrewazores", "createdAt": "2020-08-13T20:03:09Z", "path": "src/main/java/com/redhat/rhjmc/containerjfr/commands/internal/ExitCommand.java", "diffHunk": "@@ -69,6 +69,13 @@ public void validate(String[] args) throws FailedValidationException {\n             cw.println(errorMessage);\n             throw new FailedValidationException(errorMessage);\n         }\n+        for (String arg : args) {\n+            if (arg == null) {\n+                String errorMessage = \"One or more arguments were null\";\n+                cw.println(errorMessage);\n+                throw new FailedValidationException(errorMessage);\n+            }\n+        }", "originalCommit": "26a8da3e1dc73837ef46c16a15645cfc3aa9b9e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIyMzQ5Ng==", "url": "https://github.com/cryostatio/cryostat/pull/239#discussion_r470223496", "bodyText": "My thinking was that since the code would be dead anyway in those cases, we could just put the check in every validate() method, to make it uniform and to guard against possible additions of parameters. I guess the tests would need to be added anyway in that case though, and unnecessary code is probably bad, so I'll get rid of it.", "author": "vic-ma", "createdAt": "2020-08-13T20:18:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIxNTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIzMjY5Mw==", "url": "https://github.com/cryostatio/cryostat/pull/239#discussion_r470232693", "bodyText": "That's a fair enough idea, although in that case it would make sense to do something like put the null validation into a superclass and then ensure that all validations call through it. ex. (rough pseudojava):\nabstract class SuperClass {\n  void validate(String[] args) {\n    doNullValidation(args);\n    extraValidations(args);\n  }\n  void extraValidations(String[] args);\n}\n\nclass SubClass {\n  void extraValidations(String[] args) {\n    doNumArgsValidation();\n    doOtherValidations();\n  }\n}\n\nA similar pattern can be found with the AbstractAuthenticatedRequestHandler, might be a good read to see how that handles everything.", "author": "andrewazores", "createdAt": "2020-08-13T20:36:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIxNTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI0NTc1NA==", "url": "https://github.com/cryostatio/cryostat/pull/239#discussion_r470245754", "bodyText": "I ended up just getting rid of it since I think that's a little cleaner and since there won't be many commands eventually, so it's probably fine to just keep the validation simple.", "author": "vic-ma", "createdAt": "2020-08-13T21:00:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIxNTAwNg=="}], "type": "inlineReview"}, {"oid": "cae98e20cbae0f7ab7c468ab07010c2578491d6a", "url": "https://github.com/cryostatio/cryostat/commit/cae98e20cbae0f7ab7c468ab07010c2578491d6a", "message": "Move null check to interface; remove check in 0-args", "committedDate": "2020-08-13T20:52:02Z", "type": "commit"}]}