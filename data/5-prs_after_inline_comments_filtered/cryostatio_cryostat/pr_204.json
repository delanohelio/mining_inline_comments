{"pr_number": 204, "pr_title": "Make CORS origin configurable ", "pr_createdAt": "2020-07-13T20:12:49Z", "pr_url": "https://github.com/cryostatio/cryostat/pull/204", "timeline": [{"oid": "c5157387bb2a3789a618ddf05468b8a8dff84e1c", "url": "https://github.com/cryostatio/cryostat/commit/c5157387bb2a3789a618ddf05468b8a8dff84e1c", "message": "use address specified in cors var", "committedDate": "2020-07-13T20:11:31Z", "type": "commit"}, {"oid": "755d60cb12b788f1d126337cebe918ddaf0c48e5", "url": "https://github.com/cryostatio/cryostat/commit/755d60cb12b788f1d126337cebe918ddaf0c48e5", "message": "modify tests with configurable origin", "committedDate": "2020-07-15T19:50:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMwNzQ4OA==", "url": "https://github.com/cryostatio/cryostat/pull/204#discussion_r455307488", "bodyText": "This just tests that the utility method getOrigin returns the expected value, but not that the CORS origin header is actually set. If you look at the HandlingTests lower down in this same file, ex. shouldAddHeadersToCORS, you could copy how that test works and assert that the CORS origin header is actually added to the HTTP response with the expected origin.", "author": "andrewazores", "createdAt": "2020-07-15T20:00:18Z", "path": "src/test/java/com/redhat/rhjmc/containerjfr/net/web/handlers/CorsEnablingHandlerTest.java", "diffHunk": "@@ -93,6 +98,16 @@ void availabilityShouldDependOnEnvVar(boolean available) {\n         MatcherAssert.assertThat(handler.isAvailable(), Matchers.equalTo(available));\n     }\n \n+    @Test\n+    void shouldSetCustomOrigin() {\n+        Mockito.when(\n+                        env.getEnv(\n+                                CorsEnablingHandler.ENABLE_CORS_ENV,\n+                                CorsEnablingHandler.DEV_ORIGIN))\n+                .thenReturn(\"http://localhost:9065\");\n+        MatcherAssert.assertThat(handler.getOrigin(), Matchers.equalTo(\"http://localhost:9065\"));", "originalCommit": "755d60cb12b788f1d126337cebe918ddaf0c48e5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2dfca0526f9f7a5fd359764e42852848b7d61bbd", "url": "https://github.com/cryostatio/cryostat/commit/2dfca0526f9f7a5fd359764e42852848b7d61bbd", "message": "modify tests, change env var to CONTAINER_JFR_CORS_ORIGIN", "committedDate": "2020-07-15T21:09:33Z", "type": "commit"}, {"oid": "6fd942f9c2e403c2d54c93773033313d35c6cbca", "url": "https://github.com/cryostatio/cryostat/commit/6fd942f9c2e403c2d54c93773033313d35c6cbca", "message": "fix test issue", "committedDate": "2020-07-15T21:49:36Z", "type": "commit"}, {"oid": "35b2338452b6bd196e376cbd362f8ea523b1566f", "url": "https://github.com/cryostatio/cryostat/commit/35b2338452b6bd196e376cbd362f8ea523b1566f", "message": "add cors env var to README", "committedDate": "2020-07-16T14:20:03Z", "type": "commit"}, {"oid": "b0c21a1aabdf4d737b7f07df54d781c5d70b1c7d", "url": "https://github.com/cryostatio/cryostat/commit/b0c21a1aabdf4d737b7f07df54d781c5d70b1c7d", "message": "update run.sh with new env var", "committedDate": "2020-07-16T15:24:57Z", "type": "commit"}]}