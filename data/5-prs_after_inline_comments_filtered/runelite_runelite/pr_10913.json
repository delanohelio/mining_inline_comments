{"pr_number": 10913, "pr_title": "Add an option to show the average amount for a loot source in the loot tracker", "pr_createdAt": "2020-02-29T11:44:14Z", "pr_url": "https://github.com/runelite/runelite/pull/10913", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgzMzEwMw==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r386833103", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tdescription = \"Whether to show the total value or the average\"\n          \n          \n            \n            \t\tdescription = \"Show the average value of each loot instead of the sum total value\"", "author": "Nightfirecat", "createdAt": "2020-03-03T07:12:33Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerConfig.java", "diffHunk": "@@ -69,6 +69,16 @@ default boolean showPriceType()\n \t\treturn false;\n \t}\n \n+\t@ConfigItem(\n+\t\tkeyName = \"showAverage\",\n+\t\tname = \"Show Average Price\",\n+\t\tdescription = \"Whether to show the total value or the average\"", "originalCommit": "e1d0726d0fda238209d3afd496a921970969aed6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgzNDc4Mw==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r386834783", "bodyText": "Why does this change add the average string to the tooltip even when the configuration option is disabled?", "author": "Nightfirecat", "createdAt": "2020-03-03T07:17:58Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerBox.java", "diffHunk": "@@ -215,13 +218,24 @@ void rebuild()\n \t\t\tpriceTypeString = priceType == LootTrackerPriceType.HIGH_ALCHEMY ? \"HA: \" : \"GE: \";\n \t\t}\n \n-\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice) + \" gp\");\n-\t\tpriceLabel.setToolTipText(QuantityFormatter.formatNumber(totalPrice) + \" gp\");\n+\t\tString averageString = kills > 1 ? QuantityFormatter.formatNumber(totalPrice / kills) + \" gp\" : \"0\";\n+\t\tString totalString = priceTypeString + QuantityFormatter.formatNumber(totalPrice) + \" gp\";\n+\t\tif (showAverage)\n+\t\t{\n+\t\t\tpriceLabel.setText(averageString);\n+\t\t\tpriceLabel.setToolTipText(totalString + \" (total)\");\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice));\n+\t\t\tpriceLabel.setToolTipText(\"<html>\" + QuantityFormatter.formatNumber(totalPrice) + \" gp<br>\" + averageString + \" (average)</html>\");\t\t\t\n+\t\t}\t\t", "originalCommit": "e1d0726d0fda238209d3afd496a921970969aed6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzI3NDQ5MA==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r387274490", "bodyText": "@Nightfirecat  - I saw the setting as the displayed value, and the tooltip as a means to show the opposite.  2 reasons for doing that:\n\nI assume it won't be the option that people will want displayed by default.  The number of kills / values (i.e. \"x 135\") currently doesn't display anything.  So even though it's disabled, I think it's reasonable to add that as a hover item.\nBoth figures are valuable to know - and I think there'd be interest from many in seeing both.  The hover text is simply the one you don't normally want to see.", "author": "mikesena", "createdAt": "2020-03-03T20:27:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgzNDc4Mw=="}], "type": "inlineReview"}, {"oid": "7171069e133c361f12803c5924460990d1c079dd", "url": "https://github.com/runelite/runelite/commit/7171069e133c361f12803c5924460990d1c079dd", "message": "Add an option to show the average amount for a loot source in the loot tracker", "committedDate": "2020-03-03T20:30:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODA3NjkzMA==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r388076930", "bodyText": "Compared to the price label text prior to this change, this is missing the + \" gp\" suffix. totalString should be used instead\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice));\n          \n          \n            \n            \t\t\tpriceLabel.setText(totalString);", "author": "Nightfirecat", "createdAt": "2020-03-05T04:50:24Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerBox.java", "diffHunk": "@@ -215,13 +218,24 @@ void rebuild()\n \t\t\tpriceTypeString = priceType == LootTrackerPriceType.HIGH_ALCHEMY ? \"HA: \" : \"GE: \";\n \t\t}\n \n-\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice) + \" gp\");\n-\t\tpriceLabel.setToolTipText(QuantityFormatter.formatNumber(totalPrice) + \" gp\");\n+\t\tString averageString = kills > 1 ? QuantityFormatter.formatNumber(totalPrice / kills) + \" gp\" : \"0\";\n+\t\tString totalString = priceTypeString + QuantityFormatter.formatNumber(totalPrice) + \" gp\";\n+\t\tif (showAverage)\n+\t\t{\n+\t\t\tpriceLabel.setText(averageString);\n+\t\t\tpriceLabel.setToolTipText(totalString + \" (total)\");\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice));", "originalCommit": "7171069e133c361f12803c5924460990d1c079dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODA5ODg4NQ==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r388098885", "bodyText": "I can't believe I missed that sorry.  I've pushed up a change that removes the totalString, in favour of making it exactly the same as before.", "author": "mikesena", "createdAt": "2020-03-05T06:26:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODA3NjkzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODEwMTMxOA==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r388101318", "bodyText": "@Nightfirecat  - I think this conversation can be resolved", "author": "mikesena", "createdAt": "2020-03-05T06:35:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODA3NjkzMA=="}], "type": "inlineReview"}, {"oid": "7f02eaf3245ba5a94070f3b5fab00ba395b80b2a", "url": "https://github.com/runelite/runelite/commit/7f02eaf3245ba5a94070f3b5fab00ba395b80b2a", "message": "Add an option to show the average amount for a loot source in the loot tracker", "committedDate": "2020-03-05T06:25:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODEyMzA5MA==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r388123090", "bodyText": "There's loads of trailing space here\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tpriceLabel.setToolTipText(\"<html>\" + QuantityFormatter.formatNumber(totalPrice) + \" gp<br>\" + averageString + \" (average)</html>\");\t\t\t\n          \n          \n            \n            \t\t\tpriceLabel.setToolTipText(\"<html>\" + QuantityFormatter.formatNumber(totalPrice) + \" gp<br>\" + averageString + \" (average)</html>\");", "author": "Nightfirecat", "createdAt": "2020-03-05T07:45:35Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerBox.java", "diffHunk": "@@ -215,13 +218,23 @@ void rebuild()\n \t\t\tpriceTypeString = priceType == LootTrackerPriceType.HIGH_ALCHEMY ? \"HA: \" : \"GE: \";\n \t\t}\n \n-\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice) + \" gp\");\n-\t\tpriceLabel.setToolTipText(QuantityFormatter.formatNumber(totalPrice) + \" gp\");\n+\t\tString averageString = kills > 1 ? QuantityFormatter.formatNumber(totalPrice / kills) + \" gp\" : \"0\";\n+\t\tif (showAverage)\n+\t\t{\n+\t\t\tpriceLabel.setText(averageString);\n+\t\t\tpriceLabel.setToolTipText(priceTypeString + QuantityFormatter.formatNumber(totalPrice) + \" gp (total)\");\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice) + \" gp\");\n+\t\t\tpriceLabel.setToolTipText(\"<html>\" + QuantityFormatter.formatNumber(totalPrice) + \" gp<br>\" + averageString + \" (average)</html>\");\t\t\t", "originalCommit": "7f02eaf3245ba5a94070f3b5fab00ba395b80b2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE4NDUwNg==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r388184506", "bodyText": "Sigh, sorry @Nightfirecat  - missed that too.  Fixed.", "author": "mikesena", "createdAt": "2020-03-05T09:52:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODEyMzA5MA=="}], "type": "inlineReview"}, {"oid": "4a64382c0199631bcf3e9379110231446dc0a2b5", "url": "https://github.com/runelite/runelite/commit/4a64382c0199631bcf3e9379110231446dc0a2b5", "message": "Add an option to show the average amount for a loot source in the loot tracker", "committedDate": "2020-03-05T09:51:36Z", "type": "forcePushed"}, {"oid": "21e7224990635c03027723b5b510ca4ed384c92b", "url": "https://github.com/runelite/runelite/commit/21e7224990635c03027723b5b510ca4ed384c92b", "message": "Toggle average prices from the panel instead of the config page", "committedDate": "2020-03-07T12:13:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyNTEyMg==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r389325122", "bodyText": "Remove this eof line addition now that there are no other config changes", "author": "Nightfirecat", "createdAt": "2020-03-08T01:10:04Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerConfig.java", "diffHunk": "@@ -90,4 +90,4 @@ default boolean syncPanel()\n \t{\n \t\treturn true;\n \t}\n-}\n\\ No newline at end of file\n+}", "originalCommit": "21e7224990635c03027723b5b510ca4ed384c92b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM1MjYyMQ==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r389352621", "bodyText": "Done.  I squashed my 2 commits together - assuming that the visual button is a better approach.", "author": "mikesena", "createdAt": "2020-03-08T09:44:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyNTEyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyNjQ2Mw==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r389326463", "bodyText": "This makes the average value of a single kill 0, which is not correct.", "author": "Nightfirecat", "createdAt": "2020-03-08T01:37:25Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerBox.java", "diffHunk": "@@ -215,13 +218,23 @@ void rebuild()\n \t\t\tpriceTypeString = priceType == LootTrackerPriceType.HIGH_ALCHEMY ? \"HA: \" : \"GE: \";\n \t\t}\n \n-\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice) + \" gp\");\n-\t\tpriceLabel.setToolTipText(QuantityFormatter.formatNumber(totalPrice) + \" gp\");\n+\t\tString averageString = kills > 1 ? QuantityFormatter.formatNumber(totalPrice / kills) + \" gp\" : \"0\";", "originalCommit": "21e7224990635c03027723b5b510ca4ed384c92b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM1MjY0Ng==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r389352646", "bodyText": "Correct, great pick-up.  Fixed.", "author": "mikesena", "createdAt": "2020-03-08T09:45:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyNjQ2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyNjU1MA==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r389326550", "bodyText": "Why is this tooltip added here? Given that this is price information, it should only be handled with the price data on the right, which is already covered in the code above.", "author": "Nightfirecat", "createdAt": "2020-03-08T01:39:45Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerBox.java", "diffHunk": "@@ -215,13 +218,23 @@ void rebuild()\n \t\t\tpriceTypeString = priceType == LootTrackerPriceType.HIGH_ALCHEMY ? \"HA: \" : \"GE: \";\n \t\t}\n \n-\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice) + \" gp\");\n-\t\tpriceLabel.setToolTipText(QuantityFormatter.formatNumber(totalPrice) + \" gp\");\n+\t\tString averageString = kills > 1 ? QuantityFormatter.formatNumber(totalPrice / kills) + \" gp\" : \"0\";\n+\t\tif (showAverage)\n+\t\t{\n+\t\t\tpriceLabel.setText(averageString);\n+\t\t\tpriceLabel.setToolTipText(priceTypeString + QuantityFormatter.formatNumber(totalPrice) + \" gp (total)\");\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\tpriceLabel.setText(priceTypeString + QuantityFormatter.quantityToStackSize(totalPrice) + \" gp\");\n+\t\t\tpriceLabel.setToolTipText(\"<html>\" + QuantityFormatter.formatNumber(totalPrice) + \" gp<br>\" + averageString + \" (average)</html>\");\n+\t\t}\n \n \t\tfinal long kills = getTotalKills();\n \t\tif (kills > 1)\n \t\t{\n \t\t\tsubTitleLabel.setText(\"x \" + kills);\n+\t\t\tsubTitleLabel.setToolTipText(averageString + \" (average)\");", "originalCommit": "21e7224990635c03027723b5b510ca4ed384c92b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM1MjgxMQ==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r389352811", "bodyText": "This was my original way of doing it.  I hovered over the kill count, hoping it would show me the average.  Maybe others have the same approach.\nIf you're okay for it to be left it, I think it's a good location to always be able to see the average, without clicking the button.  I can remove it if you'd prefer though.", "author": "mikesena", "createdAt": "2020-03-08T09:47:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyNjU1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTgwMjg3Mw==", "url": "https://github.com/runelite/runelite/pull/10913#discussion_r391802873", "bodyText": "I don't think it belongs here, but I'll let others comment with their feelings on this.", "author": "Nightfirecat", "createdAt": "2020-03-12T18:09:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyNjU1MA=="}], "type": "inlineReview"}, {"oid": "37738b3989f70a4d509799f0591ac64fb89ad7c5", "url": "https://github.com/runelite/runelite/commit/37738b3989f70a4d509799f0591ac64fb89ad7c5", "message": "Add an option to show the average amount for a loot source in the loot tracker", "committedDate": "2020-03-08T09:43:39Z", "type": "forcePushed"}, {"oid": "f5e3b6df15c2e64179fcf6b640d17f3e6f8ec2de", "url": "https://github.com/runelite/runelite/commit/f5e3b6df15c2e64179fcf6b640d17f3e6f8ec2de", "message": "Show the average per kill as a tooltip in the loot tracker box", "committedDate": "2020-03-14T11:31:31Z", "type": "commit"}, {"oid": "f5e3b6df15c2e64179fcf6b640d17f3e6f8ec2de", "url": "https://github.com/runelite/runelite/commit/f5e3b6df15c2e64179fcf6b640d17f3e6f8ec2de", "message": "Show the average per kill as a tooltip in the loot tracker box", "committedDate": "2020-03-14T11:31:31Z", "type": "forcePushed"}]}