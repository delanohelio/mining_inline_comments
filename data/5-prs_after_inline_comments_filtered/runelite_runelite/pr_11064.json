{"pr_number": 11064, "pr_title": "Add option to take a screenshot when kicking a user from clan chat", "pr_createdAt": "2020-03-24T23:22:29Z", "pr_url": "https://github.com/runelite/runelite/pull/11064", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MDI5NA==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r397590294", "bodyText": "Remove this extra newline\n\n  \n    \n      \n        Suggested change", "author": "Nightfirecat", "createdAt": "2020-03-25T03:29:17Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotConfig.java", "diffHunk": "@@ -198,11 +198,23 @@ default boolean screenshotUntradeableDrop()\n \t\treturn false;\n \t}\n \n+", "originalCommit": "b2db6adf474081706e07ffa4f6dc10bddcefb8e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MDM3OQ==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r397590379", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tdescription = \"Configures whether or not screenshots are automatically taken when you kick a user from a clan chat.\",\n          \n          \n            \n            \t\tdescription = \"Take a screenshot when you kick a user from a clan chat.\",", "author": "Nightfirecat", "createdAt": "2020-03-25T03:29:42Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotConfig.java", "diffHunk": "@@ -198,11 +198,23 @@ default boolean screenshotUntradeableDrop()\n \t\treturn false;\n \t}\n \n+\n+\t@ConfigItem(\n+\t\tkeyName = \"kick\",\n+\t\tname = \"Screenshot Kicks from CC\",\n+\t\tdescription = \"Configures whether or not screenshots are automatically taken when you kick a user from a clan chat.\",", "originalCommit": "b2db6adf474081706e07ffa4f6dc10bddcefb8e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MDQ2MQ==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r397590461", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tkeyName = \"kick\",\n          \n          \n            \n            \t\tkeyName = \"ccKick\",", "author": "Nightfirecat", "createdAt": "2020-03-25T03:30:04Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotConfig.java", "diffHunk": "@@ -198,11 +198,23 @@ default boolean screenshotUntradeableDrop()\n \t\treturn false;\n \t}\n \n+\n+\t@ConfigItem(\n+\t\tkeyName = \"kick\",", "originalCommit": "b2db6adf474081706e07ffa4f6dc10bddcefb8e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MDQ5MA==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r397590490", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tdefault boolean screenshotKick()\n          \n          \n            \n            \tdefault boolean screenshotCcKick()", "author": "Nightfirecat", "createdAt": "2020-03-25T03:30:14Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotConfig.java", "diffHunk": "@@ -198,11 +198,23 @@ default boolean screenshotUntradeableDrop()\n \t\treturn false;\n \t}\n \n+\n+\t@ConfigItem(\n+\t\tkeyName = \"kick\",\n+\t\tname = \"Screenshot Kicks from CC\",\n+\t\tdescription = \"Configures whether or not screenshots are automatically taken when you kick a user from a clan chat.\",\n+\t\tposition = 15\n+\t)\n+\tdefault boolean screenshotKick()", "originalCommit": "b2db6adf474081706e07ffa4f6dc10bddcefb8e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MDczNA==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r397590734", "bodyText": "This is over 200 cols long now... Let's break it onto new lines per condition.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (event.getType() != ChatMessageType.GAMEMESSAGE && event.getType() != ChatMessageType.SPAM && event.getType() != ChatMessageType.TRADE && event.getType() != ChatMessageType.FRIENDSCHATNOTIFICATION)\n          \n          \n            \n            \t\tif (event.getType() != ChatMessageType.GAMEMESSAGE\n          \n          \n            \n            \t\t\t&& event.getType() != ChatMessageType.SPAM\n          \n          \n            \n            \t\t\t&& event.getType() != ChatMessageType.TRADE\n          \n          \n            \n            \t\t\t&& event.getType() != ChatMessageType.FRIENDSCHATNOTIFICATION)", "author": "Nightfirecat", "createdAt": "2020-03-25T03:31:16Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -267,10 +270,24 @@ public void onPlayerLootReceived(final PlayerLootReceived playerLootReceived)\n \t\t}\n \t}\n \n+\t@Subscribe\n+\tpublic void onScriptCallbackEvent(ScriptCallbackEvent e)\n+\t{\n+\t\tif (!\"confirmClanKick\".equals(e.getEventName()))\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tfinal String[] stringStack = client.getStringStack();\n+\t\tfinal int stringSize = client.getStringStackSize();\n+\t\tkickPlayerName = stringStack[stringSize - 1];\n+\t}\n+\n+\n \t@Subscribe\n \tpublic void onChatMessage(ChatMessage event)\n \t{\n-\t\tif (event.getType() != ChatMessageType.GAMEMESSAGE && event.getType() != ChatMessageType.SPAM && event.getType() != ChatMessageType.TRADE)\n+\t\tif (event.getType() != ChatMessageType.GAMEMESSAGE && event.getType() != ChatMessageType.SPAM && event.getType() != ChatMessageType.TRADE && event.getType() != ChatMessageType.FRIENDSCHATNOTIFICATION)", "originalCommit": "b2db6adf474081706e07ffa4f6dc10bddcefb8e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MTIyMw==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r397591223", "bodyText": "Combine these conditions\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (config.screenshotKick())\n          \n          \n            \n            \t\t{\n          \n          \n            \n            \t\t\tif (chatMessage.startsWith(\"Your request to kick\"))\n          \n          \n            \n            \t\tif (config.screenshotKick() && chatMessage.startsWith(\"Your request to kick\"))", "author": "Nightfirecat", "createdAt": "2020-03-25T03:33:22Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -328,13 +345,23 @@ public void onChatMessage(ChatMessage event)\n \t\t\t}\n \t\t}\n \n+\t\tif (config.screenshotKick())\n+\t\t{\n+\t\t\tif (chatMessage.startsWith(\"Your request to kick\"))", "originalCommit": "b2db6adf474081706e07ffa4f6dc10bddcefb8e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MTQ3Ng==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r397591476", "bodyText": "This should be nulled on plugin shutDown", "author": "Nightfirecat", "createdAt": "2020-03-25T03:34:17Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -154,6 +155,8 @@\n \n \tprivate NavigationButton titleBarButton;\n \n+\tprivate String kickPlayerName;", "originalCommit": "b2db6adf474081706e07ffa4f6dc10bddcefb8e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MTUyNQ==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r397591525", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\ttakeScreenshot(fileName, \"Kicks\");\n          \n          \n            \n            \t\t\t\ttakeScreenshot(fileName, \"Clan Chat Kicks\");", "author": "Nightfirecat", "createdAt": "2020-03-25T03:34:32Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -328,13 +345,23 @@ public void onChatMessage(ChatMessage event)\n \t\t\t}\n \t\t}\n \n+\t\tif (config.screenshotKick())\n+\t\t{\n+\t\t\tif (chatMessage.startsWith(\"Your request to kick\"))\n+\t\t\t{\n+\t\t\t\tfinal String nameText = kickPlayerName == null ? \"\" : kickPlayerName + \" \";\n+\t\t\t\tString fileName = \"Kick \" + nameText + LocalDate.now();\n+\t\t\t\ttakeScreenshot(fileName, \"Kicks\");", "originalCommit": "b2db6adf474081706e07ffa4f6dc10bddcefb8e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI1NzMzMw==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r398257333", "bodyText": "A date is added to the screenshot by default in ImageCapture, don't add an extra date.", "author": "Nightfirecat", "createdAt": "2020-03-26T00:54:18Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -328,13 +347,21 @@ public void onChatMessage(ChatMessage event)\n \t\t\t}\n \t\t}\n \n+\t\tif (config.screenshotCcKick() && chatMessage.startsWith(\"Your request to kick\"))\n+\t\t{\n+\t\t\tfinal String nameText = kickPlayerName == null ? \"\" : kickPlayerName + \" \";\n+\t\t\tString fileName = \"Kick \" + nameText + LocalDate.now();", "originalCommit": "e01a50e7625072583d854f3c906a1494f0244fc4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI1Nzc4OQ==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r398257789", "bodyText": "A space is added after the given filename in ImageCapture. Don't add one here.", "author": "Nightfirecat", "createdAt": "2020-03-26T00:56:15Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -328,13 +347,21 @@ public void onChatMessage(ChatMessage event)\n \t\t\t}\n \t\t}\n \n+\t\tif (config.screenshotCcKick() && chatMessage.startsWith(\"Your request to kick\"))\n+\t\t{\n+\t\t\tfinal String nameText = kickPlayerName == null ? \"\" : kickPlayerName + \" \";", "originalCommit": "e01a50e7625072583d854f3c906a1494f0244fc4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI1ODA0MQ==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r398258041", "bodyText": "Use the full chat message that's given:\nYour request to kick/ban this user was successful.", "author": "Nightfirecat", "createdAt": "2020-03-26T00:57:14Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -328,13 +347,21 @@ public void onChatMessage(ChatMessage event)\n \t\t\t}\n \t\t}\n \n+\t\tif (config.screenshotCcKick() && chatMessage.startsWith(\"Your request to kick\"))", "originalCommit": "e01a50e7625072583d854f3c906a1494f0244fc4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkzNDA5Mg==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r401934092", "bodyText": "Not sure if it matters here the filename will be Kick  if there is no name.", "author": "Adam-", "createdAt": "2020-04-01T21:57:02Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -328,13 +347,21 @@ public void onChatMessage(ChatMessage event)\n \t\t\t}\n \t\t}\n \n+\t\tif (config.screenshotCcKick() && chatMessage.startsWith(\"Your request to kick/ban this user was successful.\"))\n+\t\t{\n+\t\t\tfinal String nameText = kickPlayerName == null ? \"\" : kickPlayerName;\n+\t\t\tString fileName = \"Kick \" + nameText;", "originalCommit": "d16a4bac908cfa5256107a436e44437ebd52ee09", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1NTc2MA==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r401955760", "bodyText": "There should always be a name since we\u2019re grabbing the kicked player\u2019s name in a callback immediately following the kick event", "author": "jamesmtexas", "createdAt": "2020-04-01T22:51:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkzNDA5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1NjM1MQ==", "url": "https://github.com/runelite/runelite/pull/11064#discussion_r401956351", "bodyText": "There probably should, but the line above this has logic to handle if there isn't, so it should be consistent one way or the other (maybe early return if kicked name is null?)", "author": "Adam-", "createdAt": "2020-04-01T22:53:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkzNDA5Mg=="}], "type": "inlineReview"}, {"oid": "0314345f6adb4e3c2c33e2b87253eea596be28b2", "url": "https://github.com/runelite/runelite/commit/0314345f6adb4e3c2c33e2b87253eea596be28b2", "message": "screenshot: Add option to take screenshot on clan chat kick", "committedDate": "2020-05-13T02:14:36Z", "type": "forcePushed"}, {"oid": "f89c888582c5b4f51822888f461822cf3f652dc5", "url": "https://github.com/runelite/runelite/commit/f89c888582c5b4f51822888f461822cf3f652dc5", "message": "screenshot: Add option to take screenshot on clan chat kick", "committedDate": "2020-05-13T02:28:24Z", "type": "forcePushed"}, {"oid": "3f48614ddc47886b2b596cec19459c40ec20f754", "url": "https://github.com/runelite/runelite/commit/3f48614ddc47886b2b596cec19459c40ec20f754", "message": "screenshot: Add option to take screenshot on clan chat kick", "committedDate": "2020-05-13T02:36:57Z", "type": "commit"}, {"oid": "3f48614ddc47886b2b596cec19459c40ec20f754", "url": "https://github.com/runelite/runelite/commit/3f48614ddc47886b2b596cec19459c40ec20f754", "message": "screenshot: Add option to take screenshot on clan chat kick", "committedDate": "2020-05-13T02:36:57Z", "type": "forcePushed"}]}