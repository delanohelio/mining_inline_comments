{"pr_number": 528, "pr_title": "HDDS-2979. Implement ofs://: Fix getFileStatus for mkdir volume", "pr_createdAt": "2020-02-04T21:03:21Z", "pr_url": "https://github.com/apache/ozone/pull/528", "timeline": [{"oid": "dfe44c8a1eb2f822642dc1acf8a15417e2e40ff8", "url": "https://github.com/apache/ozone/commit/dfe44c8a1eb2f822642dc1acf8a15417e2e40ff8", "message": "HDDS-2979. Implement ofs://: Fix getFileStatus for mkdir volume", "committedDate": "2020-02-04T21:11:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA1NTQyNg==", "url": "https://github.com/apache/ozone/pull/528#discussion_r375055426", "bodyText": "should we make this static final?", "author": "xiaoyuyao", "createdAt": "2020-02-05T04:36:08Z", "path": "hadoop-ozone/ozonefs/src/main/java/org/apache/hadoop/fs/ozone/BasicRootedOzoneClientAdapterImpl.java", "diffHunk": "@@ -648,4 +663,20 @@ private FileStatusAdapter toFileStatusAdapter(OzoneFileStatus status) {\n         status.getPath()\n     );\n   }\n+\n+  private FileStatusAdapter rootFileStatusAdapter() {\n+    return new FileStatusAdapter(", "originalCommit": "4677eefba096ae3d926c03234210137b6ab620d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTUyNDQ5MQ==", "url": "https://github.com/apache/ozone/pull/528#discussion_r375524491", "bodyText": "Good point. We should.\nMade it static. As it's private we won't need final.", "author": "smengcl", "createdAt": "2020-02-05T21:42:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA1NTQyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0OTk2NQ==", "url": "https://github.com/apache/ozone/pull/528#discussion_r375549965", "bodyText": "Try 755", "author": "smengcl", "createdAt": "2020-02-05T22:43:38Z", "path": "hadoop-ozone/ozonefs/src/main/java/org/apache/hadoop/fs/ozone/BasicRootedOzoneClientAdapterImpl.java", "diffHunk": "@@ -648,4 +663,27 @@ private FileStatusAdapter toFileStatusAdapter(OzoneFileStatus status) {\n         status.getPath()\n     );\n   }\n+\n+  /**\n+   * Generate a FileStatusAdapter for OFS root.\n+   * @return FileStatusAdapter for root.\n+   */\n+  private static FileStatusAdapter rootFileStatusAdapter() {\n+    // Note that most fields are mimicked from HDFS FileStatus for root,\n+    //  except modification time, permission, owner and group.\n+    // TODO: Revisit the return value.\n+    return new FileStatusAdapter(\n+        0L,\n+        null,\n+        true,\n+        (short)0,\n+        0L,\n+        0L,\n+        0L,\n+        (short)0,", "originalCommit": "c7e4ab28d4734807352c0678d87be5a7029e0459", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU1MDA2OA==", "url": "https://github.com/apache/ozone/pull/528#discussion_r375550068", "bodyText": "use ozone admin", "author": "smengcl", "createdAt": "2020-02-05T22:43:51Z", "path": "hadoop-ozone/ozonefs/src/main/java/org/apache/hadoop/fs/ozone/BasicRootedOzoneClientAdapterImpl.java", "diffHunk": "@@ -648,4 +663,27 @@ private FileStatusAdapter toFileStatusAdapter(OzoneFileStatus status) {\n         status.getPath()\n     );\n   }\n+\n+  /**\n+   * Generate a FileStatusAdapter for OFS root.\n+   * @return FileStatusAdapter for root.\n+   */\n+  private static FileStatusAdapter rootFileStatusAdapter() {\n+    // Note that most fields are mimicked from HDFS FileStatus for root,\n+    //  except modification time, permission, owner and group.\n+    // TODO: Revisit the return value.\n+    return new FileStatusAdapter(\n+        0L,\n+        null,\n+        true,\n+        (short)0,\n+        0L,\n+        0L,\n+        0L,\n+        (short)0,\n+        null,", "originalCommit": "c7e4ab28d4734807352c0678d87be5a7029e0459", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk1NzgxOQ==", "url": "https://github.com/apache/ozone/pull/528#discussion_r375957819", "bodyText": "But for now we are leaving this field as null since we didn't have an API to retrieve such info from OM yet.", "author": "smengcl", "createdAt": "2020-02-06T16:55:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU1MDA2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU1MDE0OA==", "url": "https://github.com/apache/ozone/pull/528#discussion_r375550148", "bodyText": "ozone admin group?", "author": "smengcl", "createdAt": "2020-02-05T22:44:06Z", "path": "hadoop-ozone/ozonefs/src/main/java/org/apache/hadoop/fs/ozone/BasicRootedOzoneClientAdapterImpl.java", "diffHunk": "@@ -648,4 +663,27 @@ private FileStatusAdapter toFileStatusAdapter(OzoneFileStatus status) {\n         status.getPath()\n     );\n   }\n+\n+  /**\n+   * Generate a FileStatusAdapter for OFS root.\n+   * @return FileStatusAdapter for root.\n+   */\n+  private static FileStatusAdapter rootFileStatusAdapter() {\n+    // Note that most fields are mimicked from HDFS FileStatus for root,\n+    //  except modification time, permission, owner and group.\n+    // TODO: Revisit the return value.\n+    return new FileStatusAdapter(\n+        0L,\n+        null,\n+        true,\n+        (short)0,\n+        0L,\n+        0L,\n+        0L,\n+        (short)0,\n+        null,\n+        null,", "originalCommit": "c7e4ab28d4734807352c0678d87be5a7029e0459", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4349060c0dccbc89da37225091971b49b84e3864", "url": "https://github.com/apache/ozone/commit/4349060c0dccbc89da37225091971b49b84e3864", "message": "HDDS-2979. Implement ofs://: Fix getFileStatus for mkdir volume", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "46f5a90be635077fb04278c120e94022b39f2bc9", "url": "https://github.com/apache/ozone/commit/46f5a90be635077fb04278c120e94022b39f2bc9", "message": "Clean up code; create flag check unnecessary in getBucket", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "2df43bd7880e2f5004c1c5c39c621554a679c811", "url": "https://github.com/apache/ozone/commit/2df43bd7880e2f5004c1c5c39c621554a679c811", "message": "Handle the case where getFileStatus is called for root. mkdir without -p should work for volume creation now.", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "dd33c8a73cf5f7c9989848518f954251508dc078", "url": "https://github.com/apache/ozone/commit/dd33c8a73cf5f7c9989848518f954251508dc078", "message": "Fix checkstyle", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "26d096c72e2001aa5e60f0a36deef1d49dd53ff2", "url": "https://github.com/apache/ozone/commit/26d096c72e2001aa5e60f0a36deef1d49dd53ff2", "message": "Add testGetListStatusRoot; minor comment tweaks.", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "c03d7177b11f5c8d463d1944c55ef41b83ac6bd5", "url": "https://github.com/apache/ozone/commit/c03d7177b11f5c8d463d1944c55ef41b83ac6bd5", "message": "Clean up test code.", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "e580893ab38684067683805ed3ad9a91cfae93c9", "url": "https://github.com/apache/ozone/commit/e580893ab38684067683805ed3ad9a91cfae93c9", "message": "Fix typo in test name", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "a4cb0798b9e0db83a99069ab3fafe3950ec3c5b2", "url": "https://github.com/apache/ozone/commit/a4cb0798b9e0db83a99069ab3fafe3950ec3c5b2", "message": "Fix typo in comment.", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "29819181553b46329955ba504fc01e2207801093", "url": "https://github.com/apache/ozone/commit/29819181553b46329955ba504fc01e2207801093", "message": "Make rootFileStatusAdapter static.", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "70f2e799ff1fe8969c21a57b69203962649c61ed", "url": "https://github.com/apache/ozone/commit/70f2e799ff1fe8969c21a57b69203962649c61ed", "message": "Set OFS root FileStatus return permission to 00755.", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "eee681b2e3cb3050694e48baf0cd78c32833a7d9", "url": "https://github.com/apache/ozone/commit/eee681b2e3cb3050694e48baf0cd78c32833a7d9", "message": "Cosmetic: Tweak class-wide global variable order, as ozoneClient <- proxy <- objectStore", "committedDate": "2020-02-06T23:50:33Z", "type": "commit"}, {"oid": "eee681b2e3cb3050694e48baf0cd78c32833a7d9", "url": "https://github.com/apache/ozone/commit/eee681b2e3cb3050694e48baf0cd78c32833a7d9", "message": "Cosmetic: Tweak class-wide global variable order, as ozoneClient <- proxy <- objectStore", "committedDate": "2020-02-06T23:50:33Z", "type": "forcePushed"}]}