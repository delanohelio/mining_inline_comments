{"pr_number": 502, "pr_title": "HDDS-2955. Unnecessary log messages in DBStoreBuilder", "pr_createdAt": "2020-01-29T18:42:42Z", "pr_url": "https://github.com/apache/ozone/pull/502", "timeline": [{"oid": "fc000418269857452c824935ddf4b61e65f56a3d", "url": "https://github.com/apache/ozone/commit/fc000418269857452c824935ddf4b61e65f56a3d", "message": "HDDS-2955. Unnecessary log messages in DBStoreBuilder", "committedDate": "2020-01-29T16:26:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE2NTAwNg==", "url": "https://github.com/apache/ozone/pull/502#discussion_r376165006", "bodyText": "Can we pass the dbProfile's name to addTable so that we can LOG the profile name inside addTable?", "author": "xiaoyuyao", "createdAt": "2020-02-07T00:57:18Z", "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/utils/db/DBStoreBuilder.java", "diffHunk": "@@ -174,21 +184,16 @@ private void processDBProfile() {\n       dbProfile = this.configuration.getEnum(HDDS_DB_PROFILE,\n           HDDS_DEFAULT_DB_PROFILE);\n     }\n+    LOG.debug(\"default profile:{}\", dbProfile);\n   }\n \n   private void processTables() throws IOException {\n-    if (tableNames.size() > 0) {\n-      for (String name : tableNames) {\n-        addTable(name, dbProfile.getColumnFamilyOptions());\n-        LOG.info(\"Using default column profile:{} for Table:{}\",\n-            dbProfile.toString(), name);\n-      }\n+    List<String> list = new ArrayList<>(tableNames);\n+    list.add(DEFAULT_COLUMN_FAMILY_NAME);\n+    for (String name : list) {\n+      LOG.debug(\"using default profile for table:{}\", name);\n+      addTableDefinition(name, dbProfile.getColumnFamilyOptions());\n     }\n-    addTable(StringUtils.bytes2String(RocksDB.DEFAULT_COLUMN_FAMILY),", "originalCommit": "fc000418269857452c824935ddf4b61e65f56a3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA4NDA3NA==", "url": "https://github.com/apache/ozone/pull/502#discussion_r377084074", "bodyText": "Thanks @xiaoyuyao for the review.\nBoth previously and with this patch only the default profile name is logged, no custom profile names.  (I guess the reason for that is that it's only a ColumnFamilyOptions object being passed to addTable, not a DBProfile, and only the latter has meaningful name).  The patch changes logging of the default profile to happen only once instead of for all tables using it, to avoid repetition.", "author": "adoroszlai", "createdAt": "2020-02-10T14:10:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE2NTAwNg=="}], "type": "inlineReview"}]}