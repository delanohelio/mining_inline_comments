{"pr_number": 1034, "pr_title": "HDDS-3749. Improve OM performance with 3.7% by avoid stream.collect", "pr_createdAt": "2020-06-08T07:21:40Z", "pr_url": "https://github.com/apache/ozone/pull/1034", "timeline": [{"oid": "be8be6e2c150e5af4052c0c423e9e7a6a8a761cc", "url": "https://github.com/apache/ozone/commit/be8be6e2c150e5af4052c0c423e9e7a6a8a761cc", "message": "HDDS-3749. Improve OM performance with 3% by avoid stream.collect", "committedDate": "2020-06-08T07:29:07Z", "type": "forcePushed"}, {"oid": "be8be6e2c150e5af4052c0c423e9e7a6a8a761cc", "url": "https://github.com/apache/ozone/commit/be8be6e2c150e5af4052c0c423e9e7a6a8a761cc", "message": "HDDS-3749. Improve OM performance with 3% by avoid stream.collect", "committedDate": "2020-06-08T07:29:07Z", "type": "commit"}, {"oid": "d6cf7b12420c38bbb64f587e087fc55b8853196d", "url": "https://github.com/apache/ozone/commit/d6cf7b12420c38bbb64f587e087fc55b8853196d", "message": "triger ci", "committedDate": "2020-06-08T08:37:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI5MDI3Nw==", "url": "https://github.com/apache/ozone/pull/1034#discussion_r437290277", "bodyText": "We don't need the temporary variable memberList.\nIt can be replaced with\nfor (DatanodeDetailsProto member : pipeline.getMembersList())", "author": "nandakumar131", "createdAt": "2020-06-09T09:59:06Z", "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/scm/pipeline/Pipeline.java", "diffHunk": "@@ -289,14 +290,20 @@ public boolean isEmpty() {\n   public static Pipeline getFromProtobuf(HddsProtos.Pipeline pipeline)\n       throws UnknownPipelineStateException {\n     Preconditions.checkNotNull(pipeline, \"Pipeline is null\");\n+\n+    List<DatanodeDetails> nodes = new ArrayList<>();\n+    List<DatanodeDetailsProto> membersList = pipeline.getMembersList();\n+    for (DatanodeDetailsProto member : membersList) {", "originalCommit": "d6cf7b12420c38bbb64f587e087fc55b8853196d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI5MTA0NA==", "url": "https://github.com/apache/ozone/pull/1034#discussion_r437291044", "bodyText": "Temporary variable keyLocationLists can be removed.", "author": "nandakumar131", "createdAt": "2020-06-09T10:00:23Z", "path": "hadoop-ozone/common/src/main/java/org/apache/hadoop/ozone/om/helpers/OmKeyInfo.java", "diffHunk": "@@ -411,13 +415,19 @@ public static OmKeyInfo getFromProtobuf(KeyInfo keyInfo) {\n     if (keyInfo == null) {\n       return null;\n     }\n+\n+    List<OmKeyLocationInfoGroup> omKeyLocationInfos = new ArrayList<>();\n+    List<KeyLocationList> keyLocationLists = keyInfo.getKeyLocationListList();\n+    for (KeyLocationList keyLocationList : keyLocationLists) {", "originalCommit": "d6cf7b12420c38bbb64f587e087fc55b8853196d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzI5MTMyMA==", "url": "https://github.com/apache/ozone/pull/1034#discussion_r437291320", "bodyText": "The temporary variable keyLocations  can be removed.", "author": "nandakumar131", "createdAt": "2020-06-09T10:00:50Z", "path": "hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/request/key/OMKeyCommitRequest.java", "diffHunk": "@@ -132,10 +134,13 @@ public OMClientResponse validateAndUpdateCache(OzoneManager ozoneManager,\n           keyName, IAccessAuthorizer.ACLType.WRITE,\n           commitKeyRequest.getClientID());\n \n-      List<OmKeyLocationInfo> locationInfoList = commitKeyArgs\n-          .getKeyLocationsList().stream()\n-          .map(OmKeyLocationInfo::getFromProtobuf)\n-          .collect(Collectors.toList());\n+      List<OmKeyLocationInfo> locationInfoList = new ArrayList<>();\n+      List<KeyLocation> keyLocations = commitKeyArgs\n+          .getKeyLocationsList();\n+\n+      for (KeyLocation keyLocation : keyLocations) {", "originalCommit": "d6cf7b12420c38bbb64f587e087fc55b8853196d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "99d4971a827f5c533058e05fbe534c42a6852448", "url": "https://github.com/apache/ozone/commit/99d4971a827f5c533058e05fbe534c42a6852448", "message": "fix code review", "committedDate": "2020-06-10T01:49:10Z", "type": "forcePushed"}, {"oid": "99d4971a827f5c533058e05fbe534c42a6852448", "url": "https://github.com/apache/ozone/commit/99d4971a827f5c533058e05fbe534c42a6852448", "message": "fix code review", "committedDate": "2020-06-10T01:49:10Z", "type": "commit"}]}