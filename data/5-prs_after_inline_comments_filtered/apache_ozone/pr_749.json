{"pr_number": 749, "pr_title": "HDDS-3322. StandAlone Pipelines are created in an infinite loop", "pr_createdAt": "2020-04-01T19:26:12Z", "pr_url": "https://github.com/apache/ozone/pull/749", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI1NTQyOQ==", "url": "https://github.com/apache/ozone/pull/749#discussion_r405255429", "bodyText": "And also for Simple Pipeline Provider, we should not create pipeline with factor 3.\nThis is an existing issue, but when looking into this patch found it.", "author": "bharatviswa504", "createdAt": "2020-04-08T04:46:01Z", "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/pipeline/SimplePipelineProvider.java", "diffHunk": "@@ -32,18 +31,18 @@\n /**\n  * Implements Api for creating stand alone pipelines.\n  */\n-public class SimplePipelineProvider implements PipelineProvider {\n+public class SimplePipelineProvider extends PipelineProvider {\n \n-  private final NodeManager nodeManager;\n-\n-  public SimplePipelineProvider(NodeManager nodeManager) {\n-    this.nodeManager = nodeManager;\n+  public SimplePipelineProvider(NodeManager nodeManager,\n+      PipelineStateManager stateManager) {\n+    super(nodeManager, stateManager);\n   }\n \n   @Override\n   public Pipeline create(ReplicationFactor factor) throws IOException {\n-    List<DatanodeDetails> dns =\n-        nodeManager.getNodes(NodeState.HEALTHY);\n+    List<DatanodeDetails> dns = pickNodesNeverUsed(ReplicationType.STAND_ALONE,", "originalCommit": "d1ec432554f6050dd34d126133e76ee251a65422", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY3MjUyMQ==", "url": "https://github.com/apache/ozone/pull/749#discussion_r409672521", "bodyText": "Updated to create only factor ONE pipelines for StandAlone type.", "author": "hanishakoneru", "createdAt": "2020-04-16T16:02:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI1NTQyOQ=="}], "type": "inlineReview"}, {"oid": "983013f74a4ac07e2411e9b22ac6031ede3828ad", "url": "https://github.com/apache/ozone/commit/983013f74a4ac07e2411e9b22ac6031ede3828ad", "message": "Avoid creation of StandAlone pipeline with factor THREE", "committedDate": "2020-04-13T20:16:22Z", "type": "forcePushed"}, {"oid": "755cd11aeae2b3dbf499679564871fe6bd21a8a2", "url": "https://github.com/apache/ozone/commit/755cd11aeae2b3dbf499679564871fe6bd21a8a2", "message": "HDDS-3322. StandAlone Pipelines are created in an infinite loop", "committedDate": "2020-04-16T15:52:39Z", "type": "commit"}, {"oid": "f7e739d713655ab62b2a131ca5b539463e2d6205", "url": "https://github.com/apache/ozone/commit/f7e739d713655ab62b2a131ca5b539463e2d6205", "message": "Avoid creation of StandAlone pipeline with factor THREE", "committedDate": "2020-04-16T15:52:39Z", "type": "commit"}, {"oid": "e2b1c5a41fd6301364b9a2c850f79cf5c3caebd7", "url": "https://github.com/apache/ozone/commit/e2b1c5a41fd6301364b9a2c850f79cf5c3caebd7", "message": "checkstyle fixes", "committedDate": "2020-04-16T16:01:42Z", "type": "commit"}, {"oid": "e2b1c5a41fd6301364b9a2c850f79cf5c3caebd7", "url": "https://github.com/apache/ozone/commit/e2b1c5a41fd6301364b9a2c850f79cf5c3caebd7", "message": "checkstyle fixes", "committedDate": "2020-04-16T16:01:42Z", "type": "forcePushed"}]}