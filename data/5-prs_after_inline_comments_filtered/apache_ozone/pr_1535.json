{"pr_number": 1535, "pr_title": "HDDS-4346.Ozone specific Trash Policy", "pr_createdAt": "2020-10-30T13:12:00Z", "pr_url": "https://github.com/apache/ozone/pull/1535", "timeline": [{"oid": "e52ba2155a86b1df02ab54448b7a71d64ef0a19f", "url": "https://github.com/apache/ozone/commit/e52ba2155a86b1df02ab54448b7a71d64ef0a19f", "message": "HDDS-4346.Ozone specific Trash Policy", "committedDate": "2020-11-13T16:19:58Z", "type": "commit"}, {"oid": "fbad42e5de5504a687081e61ab2b7cf0cfbe6b39", "url": "https://github.com/apache/ozone/commit/fbad42e5de5504a687081e61ab2b7cf0cfbe6b39", "message": "fix failing test", "committedDate": "2020-11-13T16:19:58Z", "type": "commit"}, {"oid": "89bea7623f5ad95dc139a31d2229ea7ca99c3bef", "url": "https://github.com/apache/ozone/commit/89bea7623f5ad95dc139a31d2229ea7ca99c3bef", "message": "Addressed review comment", "committedDate": "2020-11-13T16:19:58Z", "type": "commit"}, {"oid": "b27a06322e820a8767cb04ff098a0c2e3a28eead", "url": "https://github.com/apache/ozone/commit/b27a06322e820a8767cb04ff098a0c2e3a28eead", "message": "remove initialise method as it uses the parent implementation", "committedDate": "2020-11-13T16:19:58Z", "type": "commit"}, {"oid": "a39e1a6667388a1d0650c46159fb1bcfaf907c63", "url": "https://github.com/apache/ozone/commit/a39e1a6667388a1d0650c46159fb1bcfaf907c63", "message": "call ozone trash emptier from OM", "committedDate": "2020-11-13T16:31:23Z", "type": "commit"}, {"oid": "a39e1a6667388a1d0650c46159fb1bcfaf907c63", "url": "https://github.com/apache/ozone/commit/a39e1a6667388a1d0650c46159fb1bcfaf907c63", "message": "call ozone trash emptier from OM", "committedDate": "2020-11-13T16:31:23Z", "type": "forcePushed"}, {"oid": "d7c30ee900bd0b0a7ed78effd4f494d4a607f8bc", "url": "https://github.com/apache/ozone/commit/d7c30ee900bd0b0a7ed78effd4f494d4a607f8bc", "message": "trigger new CI check", "committedDate": "2020-11-16T10:57:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI3MDM5Nw==", "url": "https://github.com/apache/ozone/pull/1535#discussion_r525270397", "bodyText": "This should be\ntrash.getConf().getClass(\n\"fs.trash.classname\", TrashPolicyOzone.class, TrashPolicy.class) ?", "author": "mukul1987", "createdAt": "2020-11-17T15:50:36Z", "path": "hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/fs/ozone/TestRootedOzoneFileSystem.java", "diffHunk": "@@ -1184,6 +1189,10 @@ public void testTrash() throws Exception {\n     try (FSDataOutputStream stream = fs.create(path)) {\n       stream.write(1);\n     }\n+    Assert.assertTrue(trash.getConf().getClass(\n+        \"fs.trash.classname\", TrashPolicyDefault.class).", "originalCommit": "d7c30ee900bd0b0a7ed78effd4f494d4a607f8bc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI3MTM3Ng==", "url": "https://github.com/apache/ozone/pull/1535#discussion_r525271376", "bodyText": "Referring to the following lines of code\nhttps://github.com/apache/hadoop/blob/6f5a36c13c4d2eb24e207aa99a9781c0be11660b/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestTrash.java#L643-L642", "author": "mukul1987", "createdAt": "2020-11-17T15:51:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI3MDM5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTgxNjA1MA==", "url": "https://github.com/apache/ozone/pull/1535#discussion_r525816050", "bodyText": "done", "author": "sadanand48", "createdAt": "2020-11-18T05:00:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI3MDM5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI3MTkxNQ==", "url": "https://github.com/apache/ozone/pull/1535#discussion_r525271915", "bodyText": "The first word should start from the next line.", "author": "mukul1987", "createdAt": "2020-11-17T15:52:30Z", "path": "hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/TrashPolicyOzone.java", "diffHunk": "@@ -0,0 +1,234 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.ozone.om;\n+\n+import java.io.FileNotFoundException;\n+import java.io.IOException;\n+import java.text.DateFormat;\n+import java.text.ParseException;\n+import java.text.SimpleDateFormat;\n+import java.util.Collection;\n+import java.util.Date;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.fs.FileStatus;\n+import org.apache.hadoop.fs.FileSystem;\n+import org.apache.hadoop.fs.Path;\n+import org.apache.hadoop.fs.TrashPolicyDefault;\n+import org.apache.hadoop.fs.permission.FsAction;\n+import org.apache.hadoop.fs.permission.FsPermission;\n+import org.apache.hadoop.fs.FileAlreadyExistsException;\n+import org.apache.hadoop.util.Time;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/** TrashPolicy for Ozone Specific Trash Operations.Through this implementation", "originalCommit": "d7c30ee900bd0b0a7ed78effd4f494d4a607f8bc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTgxNjA4Mg==", "url": "https://github.com/apache/ozone/pull/1535#discussion_r525816082", "bodyText": "done", "author": "sadanand48", "createdAt": "2020-11-18T05:00:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI3MTkxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI3MjcyNQ==", "url": "https://github.com/apache/ozone/pull/1535#discussion_r525272725", "bodyText": "Is this import needed ?", "author": "mukul1987", "createdAt": "2020-11-17T15:53:36Z", "path": "hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/fs/ozone/TestRootedOzoneFileSystem.java", "diffHunk": "@@ -27,6 +27,8 @@\n import org.apache.hadoop.fs.Path;\n import org.apache.hadoop.fs.PathIsNotEmptyDirectoryException;\n import org.apache.hadoop.fs.Trash;\n+import org.apache.hadoop.fs.TrashPolicy;\n+import org.apache.hadoop.fs.TrashPolicyDefault;", "originalCommit": "d7c30ee900bd0b0a7ed78effd4f494d4a607f8bc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "080eed0407ccea949e1e683bcc0c4cbf1b733d4d", "url": "https://github.com/apache/ozone/commit/080eed0407ccea949e1e683bcc0c4cbf1b733d4d", "message": "addressed review comments", "committedDate": "2020-11-18T05:00:05Z", "type": "commit"}, {"oid": "b2297c20cfef9a094bb82ec17f006ad3204bedbf", "url": "https://github.com/apache/ozone/commit/b2297c20cfef9a094bb82ec17f006ad3204bedbf", "message": "trigger new CI check", "committedDate": "2020-11-18T06:40:49Z", "type": "commit"}, {"oid": "560b64487973e450a55c0b7f5a2e2efedc9a5588", "url": "https://github.com/apache/ozone/commit/560b64487973e450a55c0b7f5a2e2efedc9a5588", "message": "trigger new CI check", "committedDate": "2020-11-18T08:00:32Z", "type": "commit"}]}