{"pr_number": 478, "pr_title": "Fix fast forward/rewind not working on Fire Stick", "pr_createdAt": "2020-05-19T16:30:58Z", "pr_url": "https://github.com/jellyfin/jellyfin-androidtv/pull/478", "timeline": [{"oid": "d6feb0007d986ba38a607ba64a0c2e0f65588692", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/d6feb0007d986ba38a607ba64a0c2e0f65588692", "message": "Add new logic to playback overlay for ff/rewind\n\nThis adds in some nrew logic to intercept the fast forward and rewind\nkeys presses if the popup panel is not in view.\n\nIf the media playing is not live TV, it will skip forwards or backwards\nthe appropriate amount of seconds. It will show the overlay as expected]\nand then iniatite the fadeout timer.", "committedDate": "2020-05-19T16:09:45Z", "type": "commit"}, {"oid": "8e10f4e375a155647db8ce1694a50426766dace5", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/8e10f4e375a155647db8ce1694a50426766dace5", "message": "Add filter to only invoke once on key press", "committedDate": "2020-05-19T16:26:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1MzUwMA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/478#discussion_r427453500", "bodyText": "The formatting inside this if statement is wrong. Please indent it or change the code to return false when the action is not ACTION_DOWN", "author": "nielsvanvelzen", "createdAt": "2020-05-19T16:54:13Z", "path": "app/src/main/java/org/jellyfin/androidtv/playback/CustomPlaybackOverlayFragment.java", "diffHunk": "@@ -432,6 +432,7 @@ public void onItemClicked(Presenter.ViewHolder itemViewHolder, Object item,\n     private View.OnKeyListener keyListener = new View.OnKeyListener() {\n         @Override\n         public boolean onKey(View v, int keyCode, KeyEvent event) {\n+            if (event.getAction() == KeyEvent.ACTION_DOWN) {", "originalCommit": "8e10f4e375a155647db8ce1694a50426766dace5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ3NDUyMg==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/478#discussion_r427474522", "bodyText": "What are the current indent preferences for java files?", "author": "MrLemur", "createdAt": "2020-05-19T17:27:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1MzUwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ4NTA5Ng==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/478#discussion_r427485096", "bodyText": "It's 4 spaces currently", "author": "nielsvanvelzen", "createdAt": "2020-05-19T17:44:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1MzUwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ5MDA3MQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/478#discussion_r427490071", "bodyText": "Should be fixed with the most recent commit", "author": "MrLemur", "createdAt": "2020-05-19T17:51:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1MzUwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1NTY1OQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/478#discussion_r427455659", "bodyText": "I expect everything inside this statement to probably trigger twice on non-firetv devices", "author": "nielsvanvelzen", "createdAt": "2020-05-19T16:57:32Z", "path": "app/src/main/java/org/jellyfin/androidtv/playback/CustomPlaybackOverlayFragment.java", "diffHunk": "@@ -501,6 +502,23 @@ public boolean onKey(View v, int keyCode, KeyEvent event) {\n                     }\n                 }\n \n+                // Control fast forward and rewind if overlay hidden and not showing live TV\n+                if (!mPlaybackController.isLiveTv()) {\n+                    if (keyCode == KeyEvent.KEYCODE_MEDIA_FAST_FORWARD || keyCode == KeyEvent.KEYCODE_BUTTON_R1 || keyCode ==KeyEvent.KEYCODE_BUTTON_R2) {\n+                        mPlaybackController.skip(30000);\n+                        if (!mIsVisible) show();\n+                        setFadingEnabled(true);\n+                        return true;\n+                    }\n+\n+                    if (keyCode == KeyEvent.KEYCODE_MEDIA_REWIND || keyCode == KeyEvent.KEYCODE_BUTTON_L1 || keyCode == KeyEvent.KEYCODE_BUTTON_L2) {\n+                        mPlaybackController.skip(-11000);\n+                        if (!mIsVisible) show();\n+                        setFadingEnabled(true);\n+                        return true;\n+                    }\n+                }\n+\n                 if (!mIsVisible) {", "originalCommit": "8e10f4e375a155647db8ce1694a50426766dace5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ3Nzg3Mg==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/478#discussion_r427477872", "bodyText": "Will be good to get a test to see, and if so I can add in the fire TV check.", "author": "MrLemur", "createdAt": "2020-05-19T17:32:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1NTY1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ4Njc1MA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/478#discussion_r427486750", "bodyText": "Testing in Android TV emulator in AVD has the expected behaviour using the emulated d-pad fast forward and rewind controls.", "author": "MrLemur", "createdAt": "2020-05-19T17:46:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1NTY1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1MDgzNQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/478#discussion_r427550835", "bodyText": "I did some testing and it, indeed, works as expected! \ud83c\udf89", "author": "nielsvanvelzen", "createdAt": "2020-05-19T19:34:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1NTY1OQ=="}], "type": "inlineReview"}, {"oid": "c65e22320edcde64b35b5236fe107ca92bb0b1cc", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/c65e22320edcde64b35b5236fe107ca92bb0b1cc", "message": "Fix indext", "committedDate": "2020-05-19T17:25:11Z", "type": "commit"}]}