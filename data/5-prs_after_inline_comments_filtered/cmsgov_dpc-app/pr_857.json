{"pr_number": 857, "pr_title": "Dpc 354 swagger", "pr_createdAt": "2020-06-15T22:00:39Z", "pr_url": "https://github.com/CMSgov/dpc-app/pull/857", "timeline": [{"oid": "60d148e8a7c072a0713a113bdc95ccb83e4d76bd", "url": "https://github.com/CMSgov/dpc-app/commit/60d148e8a7c072a0713a113bdc95ccb83e4d76bd", "message": "in swagger.json:\nsecurity:\napiKey: []\n\u00a0\nis incorrect. \u00a0Swagger validation throws error:\u00a0Security requirements must match a security definition\n\u00a0\nOur security definition is as follows (see swagger.json line 1538:\u00a0\nsecurityDefinitions:\naccess_token:\nswagger.json should read:\nsecurity:\naccess_token: []\n\u00a0\nrequired changes in Java:\n\u00a0\nall annotations containing apiKey must be changes to access_token\nExample:\n@Api(value = \"Patient\", authorizations = @Authorization(value = \"apiKey\"))\nshould be changed to\n@Api(value = \"Patient\", authorizations = @Authorization(value = \"access_token\"))", "committedDate": "2020-06-12T01:04:19Z", "type": "commit"}, {"oid": "3b28b8d39d6e7b04e63fcc6adb4ed8a96e6460f0", "url": "https://github.com/CMSgov/dpc-app/commit/3b28b8d39d6e7b04e63fcc6adb4ed8a96e6460f0", "message": "Swagger validation complains that several API operations have multiple body parameters because Parametsr are not annotated correctly\n\nlooking at the Group Resource Update Roster Method, we se:e that none of the Parameters to the method was annotated with @ApiParam\n\npublic Group updateRoster(@ApiParam(value = \"Attribution roster ID\") @PathParam(\"rosterID\") UUID rosterID,\n@Valid @Profiled(profile = AttestationProfile.PROFILE_URI)\n@ProvenanceHeader Provenance rosterAttestation,\nGroup rosterUpdate) {....\n\nso we can change like this\n\npublic Group updateRoster(@ApiParam(value = \"Attribution roster ID\") @PathParam(\"rosterID\") UUID rosterID,\n@Valid @Profiled(profile = AttestationProfile.PROFILE_URI)\n@ProvenanceHeader Provenance rosterAttestation,\n@ApiParam Group rosterUpdate) {....\n\nThis may require additional annotations on the Provenance rosterAttestation parameters, but we should try the minimal additions first.", "committedDate": "2020-06-12T03:31:40Z", "type": "commit"}, {"oid": "4368ff897fca3dcc6a168c022912940d267d0d48", "url": "https://github.com/CMSgov/dpc-app/commit/4368ff897fca3dcc6a168c022912940d267d0d48", "message": "updated pom.xml to latest version of dropwizard", "committedDate": "2020-06-12T03:38:18Z", "type": "commit"}, {"oid": "b4b17f6ead9f96d557081f12372e01b4d2288d9d", "url": "https://github.com/CMSgov/dpc-app/commit/b4b17f6ead9f96d557081f12372e01b4d2288d9d", "message": "found a few more places where the auth method was wrong, previous commit eliminated errors", "committedDate": "2020-06-12T23:19:03Z", "type": "commit"}, {"oid": "dac9c45c4b38af62c9b10b76e7f8d4518ef27d0a", "url": "https://github.com/CMSgov/dpc-app/commit/dac9c45c4b38af62c9b10b76e7f8d4518ef27d0a", "message": "these annotations produce valid swagger outout for all resources except Endpoint which still has some swagger syntax errors on the parameters to create and update.", "committedDate": "2020-06-15T21:44:01Z", "type": "commit"}, {"oid": "ab3041cacf827b50f949b7edf3ffe5bdcd960f3d", "url": "https://github.com/CMSgov/dpc-app/commit/ab3041cacf827b50f949b7edf3ffe5bdcd960f3d", "message": "experimental config of maven swagger plugin", "committedDate": "2020-06-15T22:56:42Z", "type": "commit"}, {"oid": "c29e3fe6fef83919eb4476ad38140bddaf86ef6b", "url": "https://github.com/CMSgov/dpc-app/commit/c29e3fe6fef83919eb4476ad38140bddaf86ef6b", "message": "removed mistaken comment", "committedDate": "2020-06-22T13:06:05Z", "type": "commit"}, {"oid": "7711f571507c0db765db7420becdff471b198fc6", "url": "https://github.com/CMSgov/dpc-app/commit/7711f571507c0db765db7420becdff471b198fc6", "message": "Merge branch 'master' into DPC-354-Swagger", "committedDate": "2020-06-22T13:17:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzgyNDk4OQ==", "url": "https://github.com/CMSgov/dpc-app/pull/857#discussion_r443824989", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public Response createEndpoint(@ApiParam(hidden=true) @Auth OrganizationPrincipal organizationPrincipal,\n          \n          \n            \n                public Response createEndpoint(@ApiParam(hidden = true) @Auth OrganizationPrincipal organizationPrincipal,\n          \n      \n    \n    \n  \n\nFor readability, we've tried to be consistent with annotation format. Can we keep spaces around the = in all the changes in this PR?", "author": "em1", "createdAt": "2020-06-22T21:03:43Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/resources/v1/EndpointResource.java", "diffHunk": "@@ -46,7 +46,8 @@\n             @ApiResponse(code = 422, message = \"Endpoint not valid\")\n     })\n     @Override\n-    public Response createEndpoint(@ApiParam(hidden = true) @Auth OrganizationPrincipal organizationPrincipal, @Valid @Profiled(profile = EndpointProfile.PROFILE_URI) Endpoint endpoint) {\n+    public Response createEndpoint(@ApiParam(hidden=true) @Auth OrganizationPrincipal organizationPrincipal,", "originalCommit": "7711f571507c0db765db7420becdff471b198fc6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg4MDk4Mg==", "url": "https://github.com/CMSgov/dpc-app/pull/857#discussion_r443880982", "bodyText": "add space around = for readability", "author": "richbraman", "createdAt": "2020-06-22T23:36:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzgyNDk4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg3NjAyOQ==", "url": "https://github.com/CMSgov/dpc-app/pull/857#discussion_r443876029", "bodyText": "Not sure if it was intentional, but if endpointID is a path param should it not remain with the @NotNull constraint?\nThis branch also seems to be failing due to the missing @NotNull on this particular operation, not including the annotation causes all the tests under EndpointResourceTest.java to fail. (Not sure why, maybe some sort of validation is causing this entire resource not to be loaded.)\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public Endpoint updateEndpoint(@ApiParam(value = \"Your Organization's FHIR Endpoint ID\") @PathParam(\"endpointID\") UUID endpointID,\n          \n          \n            \n                public Endpoint updateEndpoint(@ApiParam(value = \"Your Organization's FHIR Endpoint ID\") @NotNull @PathParam(\"endpointID\") UUID endpointID,", "author": "MrMorie", "createdAt": "2020-06-22T23:19:10Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/resources/v1/EndpointResource.java", "diffHunk": "@@ -102,14 +103,15 @@ public Endpoint fetchEndpoint(@NotNull @PathParam(\"endpointID\") UUID endpointID)\n     @FHIR\n     @Timed\n     @ExceptionMetered\n-    @ApiOperation(value = \"Update an Endpoint\", notes = \"Update an Endpoint resource\")\n+    @ApiOperation(value = \"Update an Organization's FHIR Server Endpoint\", notes = \"Update an Endpoint resource\")\n     @ApiResponses(value = {\n             @ApiResponse(code = 200, message = \"Endpoint updated\"),\n             @ApiResponse(code = 404, message = \"Endpoint not found\"),\n             @ApiResponse(code = 422, message = \"Endpoint not valid\")\n     })\n     @Override\n-    public Endpoint updateEndpoint(@NotNull @PathParam(\"endpointID\") UUID endpointID, @Valid @Profiled(profile = EndpointProfile.PROFILE_URI) Endpoint endpoint) {\n+    public Endpoint updateEndpoint(@ApiParam(value = \"Your Organization's FHIR Endpoint ID\") @PathParam(\"endpointID\") UUID endpointID,", "originalCommit": "7711f571507c0db765db7420becdff471b198fc6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg3ODE2Mg==", "url": "https://github.com/CMSgov/dpc-app/pull/857#discussion_r443878162", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        @ApiImplicitParam(name = \"X-Provenance\", value = \"Provenance Resource attesting to Group attribution\",  required = true, paramType = \"header\", type=\"string\", dataTypeClass = Provenance.class)//,\n          \n          \n            \n                        @ApiImplicitParam(name = \"X-Provenance\", value = \"Provenance Resource attesting to Group attribution\",  required = true, paramType = \"header\", type=\"string\", dataTypeClass = Provenance.class)\n          \n      \n    \n    \n  \n\nTiny stray comment.", "author": "em1", "createdAt": "2020-06-22T23:26:39Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/resources/v1/GroupResource.java", "diffHunk": "@@ -158,15 +157,17 @@ public Group getRoster(@ApiParam(value = \"Attribution roster ID\") @PathParam(\"ro\n     @FHIR\n     @Timed\n     @ExceptionMetered\n-    @ApiOperation(value = \"Update Attribution Roster\", notes = \"Update specific Attribution roster.\" +\n-            \"<p>Updates allow for adding or removing patients from the roster.\")\n+    @ApiOperation(value = \"Update Attribution Group\", notes = \"Update specific Attribution Group.\" +\n+            \"<p>Updates allow for adding or removing patients as members of an Attribution Group.\")\n     @ApiImplicitParams(\n-            @ApiImplicitParam(name = \"X-Provenance\", required = true, paramType = \"header\", dataTypeClass = Provenance.class))\n+            @ApiImplicitParam(name = \"X-Provenance\", value = \"Provenance Resource attesting to Group attribution\",  required = true, paramType = \"header\", type=\"string\", dataTypeClass = Provenance.class)//,", "originalCommit": "7711f571507c0db765db7420becdff471b198fc6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "386d5d534604c425e295ff924ecc39f43015b127", "url": "https://github.com/CMSgov/dpc-app/commit/386d5d534604c425e295ff924ecc39f43015b127", "message": "Update dpc-api/src/main/java/gov/cms/dpc/api/resources/v1/GroupResource.java\r\n\r\nremoved errant comment\n\nCo-authored-by: Emily Hart <1923441+embh@users.noreply.github.com>", "committedDate": "2020-06-22T23:34:06Z", "type": "commit"}, {"oid": "617aeb4d78ab6509fb75ac37003cbb9d4d4dad4d", "url": "https://github.com/CMSgov/dpc-app/commit/617aeb4d78ab6509fb75ac37003cbb9d4d4dad4d", "message": "Update dpc-api/src/main/java/gov/cms/dpc/api/resources/v1/EndpointResource.java\r\n\r\nadd @notnull back in.  seems to be a relic of local testing of why endpoint notation does NOT produce valid swagger because it has two body params\n\nCo-authored-by: SalGutierrez <43150956+SalGutierrez@users.noreply.github.com>", "committedDate": "2020-06-22T23:35:20Z", "type": "commit"}, {"oid": "a909f8220812948c0b6bb9ea5059db28a7df4964", "url": "https://github.com/CMSgov/dpc-app/commit/a909f8220812948c0b6bb9ea5059db28a7df4964", "message": "Update dpc-api/src/main/java/gov/cms/dpc/api/resources/v1/EndpointResource.java\n\nCo-authored-by: Emily Hart <1923441+embh@users.noreply.github.com>", "committedDate": "2020-06-22T23:37:00Z", "type": "commit"}, {"oid": "ad3e5483c559103e20b0cf6b60a9d45cb30f9723", "url": "https://github.com/CMSgov/dpc-app/commit/ad3e5483c559103e20b0cf6b60a9d45cb30f9723", "message": "Merge branch 'master' into DPC-354-Swagger", "committedDate": "2020-06-23T00:09:28Z", "type": "commit"}]}