{"pr_number": 986, "pr_title": "DPC-389 adding more logs", "pr_createdAt": "2020-08-18T16:59:41Z", "pr_url": "https://github.com/CMSgov/dpc-app/pull/986", "timeline": [{"oid": "7d0191e16856a374fdd2fe7a2721da20c1f0f315", "url": "https://github.com/CMSgov/dpc-app/commit/7d0191e16856a374fdd2fe7a2721da20c1f0f315", "message": "adding more logs", "committedDate": "2020-08-18T16:59:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1MDE3Mw==", "url": "https://github.com/CMSgov/dpc-app/pull/986#discussion_r472350173", "bodyText": "Should this be careTeam?", "author": "em1", "createdAt": "2020-08-18T17:08:02Z", "path": "dpc-aggregation/src/main/java/gov/cms/dpc/aggregation/service/LookBackServiceImpl.java", "diffHunk": "@@ -75,34 +88,50 @@ public boolean hasClaimWithin(ExplanationOfBenefit explanationOfBenefit, UUID or\n                 && eobContainsProvider\n                 && eobRelatedToOrganization;\n \n-        LOGGER.info(\"LookBack stats eobWithinLookBackLimit {}, eobContainsProvider {}, eobRelatedToOrganization {}, eobMonthsDifference {}, hasClaim {}\",\n+        LOGGER.info(\"LookBack stats eobWithinLookBackLimit={}, eobContainsProvider={}, eobRelatedToOrganization={}, eobMonthsDifference={}, hasClaim={}\",\n                 eobWithinLookBackLimit, eobContainsProvider, eobRelatedToOrganization, lookBackMonthsDifference, hasClaim);\n \n         return hasClaim;\n     }\n \n     private Set<String> extractPractionerNPIs(ExplanationOfBenefit explanationOfBenefit) {\n         Set<String> eobProviderNPIs = new HashSet<>();\n-        Optional.ofNullable(explanationOfBenefit)\n+        Optional<String> providerNPI = Optional.ofNullable(explanationOfBenefit)\n                 .map(ExplanationOfBenefit::getProvider)\n                 .map(Reference::getIdentifier)\n                 .filter(i -> DPCIdentifierSystem.NPPES.getSystem().equals(i.getSystem()))\n                 .map(Identifier::getValue)\n-                .filter(StringUtils::isNotBlank)\n-                .ifPresent(eobProviderNPIs::add);\n+                .filter(StringUtils::isNotBlank);\n+\n+        if (providerNPI.isEmpty()) {\n+            LOGGER.info(\"providerNPI=empty\");\n+        } else {\n+            LOGGER.info(\"providerNPI={}\", providerNPI.get());\n+            eobProviderNPIs.add(providerNPI.get());\n+        }\n \n-        Optional.ofNullable(explanationOfBenefit)\n-                .map(ExplanationOfBenefit::getCareTeam)\n+        Optional<List<ExplanationOfBenefit.CareTeamComponent>> careTeam = Optional.ofNullable(explanationOfBenefit)\n+                .map(ExplanationOfBenefit::getCareTeam);\n+\n+        if (providerNPI.isEmpty()) {", "originalCommit": "7d0191e16856a374fdd2fe7a2721da20c1f0f315", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1OTg0MQ==", "url": "https://github.com/CMSgov/dpc-app/pull/986#discussion_r472359841", "bodyText": "Call \"eobOrganizationID.isPresent()\" before accessing the value.", "author": "codeclimate", "createdAt": "2020-08-18T17:22:50Z", "path": "dpc-aggregation/src/main/java/gov/cms/dpc/aggregation/service/LookBackServiceImpl.java", "diffHunk": "@@ -61,6 +62,18 @@ public boolean hasClaimWithin(ExplanationOfBenefit explanationOfBenefit, UUID or\n \n         Set<String> eobProviderNPIs = extractPractionerNPIs(explanationOfBenefit);\n \n+        if (billingPeriod.isEmpty()) {\n+            LOGGER.info(\"billingPeriod=empty\");\n+        } else {\n+            LOGGER.info(\"billingPeriod={}\", billingPeriod.get());\n+        }\n+\n+        if (eobOrganizationID.isEmpty()) {\n+            LOGGER.info(\"eobOrganizationID=empty\");\n+        } else {\n+            LOGGER.info(\"eobOrganizationID={}\", eobOrganizationID.get());", "originalCommit": "7d0191e16856a374fdd2fe7a2721da20c1f0f315", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1OTg0Mg==", "url": "https://github.com/CMSgov/dpc-app/pull/986#discussion_r472359842", "bodyText": "Call \"providerNPI.isPresent()\" before accessing the value.", "author": "codeclimate", "createdAt": "2020-08-18T17:22:50Z", "path": "dpc-aggregation/src/main/java/gov/cms/dpc/aggregation/service/LookBackServiceImpl.java", "diffHunk": "@@ -75,34 +88,50 @@ public boolean hasClaimWithin(ExplanationOfBenefit explanationOfBenefit, UUID or\n                 && eobContainsProvider\n                 && eobRelatedToOrganization;\n \n-        LOGGER.info(\"LookBack stats eobWithinLookBackLimit {}, eobContainsProvider {}, eobRelatedToOrganization {}, eobMonthsDifference {}, hasClaim {}\",\n+        LOGGER.info(\"LookBack stats eobWithinLookBackLimit={}, eobContainsProvider={}, eobRelatedToOrganization={}, eobMonthsDifference={}, hasClaim={}\",\n                 eobWithinLookBackLimit, eobContainsProvider, eobRelatedToOrganization, lookBackMonthsDifference, hasClaim);\n \n         return hasClaim;\n     }\n \n     private Set<String> extractPractionerNPIs(ExplanationOfBenefit explanationOfBenefit) {\n         Set<String> eobProviderNPIs = new HashSet<>();\n-        Optional.ofNullable(explanationOfBenefit)\n+        Optional<String> providerNPI = Optional.ofNullable(explanationOfBenefit)\n                 .map(ExplanationOfBenefit::getProvider)\n                 .map(Reference::getIdentifier)\n                 .filter(i -> DPCIdentifierSystem.NPPES.getSystem().equals(i.getSystem()))\n                 .map(Identifier::getValue)\n-                .filter(StringUtils::isNotBlank)\n-                .ifPresent(eobProviderNPIs::add);\n+                .filter(StringUtils::isNotBlank);\n+\n+        if (providerNPI.isEmpty()) {\n+            LOGGER.info(\"providerNPI=empty\");\n+        } else {\n+            LOGGER.info(\"providerNPI={}\", providerNPI.get());", "originalCommit": "7d0191e16856a374fdd2fe7a2721da20c1f0f315", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1OTg0Mw==", "url": "https://github.com/CMSgov/dpc-app/pull/986#discussion_r472359843", "bodyText": "Call \"billingPeriod.isPresent()\" before accessing the value.", "author": "codeclimate", "createdAt": "2020-08-18T17:22:50Z", "path": "dpc-aggregation/src/main/java/gov/cms/dpc/aggregation/service/LookBackServiceImpl.java", "diffHunk": "@@ -61,6 +62,18 @@ public boolean hasClaimWithin(ExplanationOfBenefit explanationOfBenefit, UUID or\n \n         Set<String> eobProviderNPIs = extractPractionerNPIs(explanationOfBenefit);\n \n+        if (billingPeriod.isEmpty()) {\n+            LOGGER.info(\"billingPeriod=empty\");\n+        } else {\n+            LOGGER.info(\"billingPeriod={}\", billingPeriod.get());", "originalCommit": "7d0191e16856a374fdd2fe7a2721da20c1f0f315", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ffbb74410f2d207d29be9afa42c26d1f0f85bc3a", "url": "https://github.com/CMSgov/dpc-app/commit/ffbb74410f2d207d29be9afa42c26d1f0f85bc3a", "message": "fix field to look at", "committedDate": "2020-08-18T17:41:56Z", "type": "commit"}, {"oid": "7fdac1ce7edfcea3aa14146d520ad37a20598269", "url": "https://github.com/CMSgov/dpc-app/commit/7fdac1ce7edfcea3aa14146d520ad37a20598269", "message": "simplify optionals logic", "committedDate": "2020-08-18T18:10:10Z", "type": "commit"}, {"oid": "aea77c3fef996d95b603516150d7d69904bcf07d", "url": "https://github.com/CMSgov/dpc-app/commit/aea77c3fef996d95b603516150d7d69904bcf07d", "message": "Merge branch 'master' into DPC-389-add-more-logging", "committedDate": "2020-08-18T18:29:02Z", "type": "commit"}, {"oid": "2a35b6e0d1657fb2e4fc18fc2b02befb018c4d6e", "url": "https://github.com/CMSgov/dpc-app/commit/2a35b6e0d1657fb2e4fc18fc2b02befb018c4d6e", "message": "add more logs", "committedDate": "2020-08-18T19:45:06Z", "type": "commit"}, {"oid": "8a0a6889f2927d1be80bf3f374da47780017de5f", "url": "https://github.com/CMSgov/dpc-app/commit/8a0a6889f2927d1be80bf3f374da47780017de5f", "message": "fix travis?", "committedDate": "2020-08-18T20:18:42Z", "type": "commit"}, {"oid": "b5ad7a6472685015e145d7e88c27f3b755e37418", "url": "https://github.com/CMSgov/dpc-app/commit/b5ad7a6472685015e145d7e88c27f3b755e37418", "message": "that didn't fix travis", "committedDate": "2020-08-18T20:53:45Z", "type": "commit"}, {"oid": "39da84b5f5d04db72a90389a8a12d9def030fee0", "url": "https://github.com/CMSgov/dpc-app/commit/39da84b5f5d04db72a90389a8a12d9def030fee0", "message": "Merge branch 'master' into DPC-389-add-more-logging", "committedDate": "2020-08-18T23:27:27Z", "type": "commit"}]}