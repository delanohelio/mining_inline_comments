{"pr_number": 3165, "pr_title": "Mute button", "pr_createdAt": "2020-03-01T12:23:01Z", "pr_url": "https://github.com/TeamNewPipe/NewPipe/pull/3165", "timeline": [{"oid": "dc6a0e3eec32d21eddd10fe4bdd4147140d7f79a", "url": "https://github.com/TeamNewPipe/NewPipe/commit/dc6a0e3eec32d21eddd10fe4bdd4147140d7f79a", "message": "mute-button added to activity_main_player.xml's", "committedDate": "2020-02-23T20:28:40Z", "type": "commit"}, {"oid": "4415888324285e741c2f3bf8303dd08303150245", "url": "https://github.com/TeamNewPipe/NewPipe/commit/4415888324285e741c2f3bf8303dd08303150245", "message": "mute-button implementation in main player", "committedDate": "2020-02-23T21:32:23Z", "type": "commit"}, {"oid": "cc559dc9ce181fef19946667bfe4a9b5e827ee8d", "url": "https://github.com/TeamNewPipe/NewPipe/commit/cc559dc9ce181fef19946667bfe4a9b5e827ee8d", "message": "isMuted() added", "committedDate": "2020-02-23T21:55:34Z", "type": "commit"}, {"oid": "2a63f2a3a633b18d87f4874f11d6961ad2e5a907", "url": "https://github.com/TeamNewPipe/NewPipe/commit/2a63f2a3a633b18d87f4874f11d6961ad2e5a907", "message": "mute-buton in queue layout and logic, but no icon change", "committedDate": "2020-02-23T22:31:30Z", "type": "commit"}, {"oid": "c4d5886059a782595232e6fd56041777a305c871", "url": "https://github.com/TeamNewPipe/NewPipe/commit/c4d5886059a782595232e6fd56041777a305c871", "message": "icon change implemented in queque", "committedDate": "2020-02-23T22:44:16Z", "type": "commit"}, {"oid": "40f54aea5353cdcfc52a533665a5d495364c3a91", "url": "https://github.com/TeamNewPipe/NewPipe/commit/40f54aea5353cdcfc52a533665a5d495364c3a91", "message": "mute intent send between main-bckgrnd-popup players", "committedDate": "2020-02-27T21:30:18Z", "type": "commit"}, {"oid": "0400fcb10609950c4b79b97ac104e0388c2aae8c", "url": "https://github.com/TeamNewPipe/NewPipe/commit/0400fcb10609950c4b79b97ac104e0388c2aae8c", "message": "mute icon in main refactored", "committedDate": "2020-02-27T22:30:17Z", "type": "commit"}, {"oid": "ee75909c80d399d03d548127ecc2454740ae5b51", "url": "https://github.com/TeamNewPipe/NewPipe/commit/ee75909c80d399d03d548127ecc2454740ae5b51", "message": "set mute button in main player from other player", "committedDate": "2020-03-01T12:02:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjEwODg5MQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r386108891", "bodyText": "Rename this here and in other players\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void onMuteUnmuteButtonClicled() {\n          \n          \n            \n                public void onMuteUnmuteButtonClicked() {", "author": "B0pol", "createdAt": "2020-03-01T13:36:40Z", "path": "app/src/main/java/org/schabi/newpipe/player/BasePlayer.java", "diffHunk": "@@ -532,6 +538,18 @@ public void onShuffleClicked() {\n         if (simpleExoPlayer == null) return;\n         simpleExoPlayer.setShuffleModeEnabled(!simpleExoPlayer.getShuffleModeEnabled());\n     }\n+    /*//////////////////////////////////////////////////////////////////////////\n+    // Mute / Unmute\n+    //////////////////////////////////////////////////////////////////////////*/\n+\n+    public void onMuteUnmuteButtonClicled() {", "originalCommit": "ee75909c80d399d03d548127ecc2454740ae5b51", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a6fcb70d1275e8a1fbc3f712b9152233b1fe8bb1", "url": "https://github.com/TeamNewPipe/NewPipe/commit/a6fcb70d1275e8a1fbc3f712b9152233b1fe8bb1", "message": "fix typo", "committedDate": "2020-03-01T15:42:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQwODk3Mg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r386408972", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (isMuted) {\n          \n          \n            \n                        muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), R.color.white));\n          \n          \n            \n                    } else {\n          \n          \n            \n                        muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), R.color.gray));\n          \n          \n            \n            \n          \n          \n            \n                    }\n          \n          \n            \n                    muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), isMuted ? R.color.white : R.color.gray));", "author": "Stypox", "createdAt": "2020-03-02T14:01:59Z", "path": "app/src/main/java/org/schabi/newpipe/player/MainVideoPlayer.java", "diffHunk": "@@ -394,6 +400,16 @@ protected void setShuffleButton(final ImageButton shuffleButton, final boolean s\n         shuffleButton.setImageAlpha(shuffleAlpha);\n     }\n \n+    protected void setMuteButton(final ImageButton muteButton, final boolean isMuted) {\n+        if (isMuted) {\n+            muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), R.color.white));\n+        } else {\n+            muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), R.color.gray));\n+\n+        }", "originalCommit": "a6fcb70d1275e8a1fbc3f712b9152233b1fe8bb1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQwOTkxNg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r386409916", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (player.isMuted()) {\n          \n          \n            \n                        muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), R.color.white));\n          \n          \n            \n                    }\n          \n          \n            \n                    else {\n          \n          \n            \n                        muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), R.color.gray));\n          \n          \n            \n                    }\n          \n          \n            \n                }\n          \n          \n            \n                    muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), isMuted ? R.color.white : R.color.gray));\n          \n          \n            \n                }", "author": "Stypox", "createdAt": "2020-03-02T14:03:51Z", "path": "app/src/main/java/org/schabi/newpipe/player/ServicePlayerActivity.java", "diffHunk": "@@ -676,4 +685,13 @@ private void onMaybePlaybackAdapterChanged() {\n             itemsList.setAdapter(maybeNewAdapter);\n         }\n     }\n+\n+    private void onMaybeMuteChanged(){\n+        if (player.isMuted()) {\n+            muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), R.color.white));\n+        }\n+        else {\n+            muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), R.color.gray));\n+        }\n+    }", "originalCommit": "a6fcb70d1275e8a1fbc3f712b9152233b1fe8bb1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQxMzExOA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r386413118", "bodyText": "Just to make sure the volume is at maximum, since you removed this line: https://github.com/TeamNewPipe/NewPipe/pull/3165/files#diff-0b87dfa694cf6a7720aee912b16ab32dL392\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (isMuted) simpleExoPlayer.setVolume(0);\n          \n          \n            \n                    simpleExoPlayer.setVolume(isMuted ? 0 : 1);", "author": "Stypox", "createdAt": "2020-03-02T14:09:46Z", "path": "app/src/main/java/org/schabi/newpipe/player/BasePlayer.java", "diffHunk": "@@ -327,6 +331,8 @@ protected void initPlayback(@NonNull final PlayQueue queue,\n \n         if (playQueueAdapter != null) playQueueAdapter.dispose();\n         playQueueAdapter = new PlayQueueAdapter(context, playQueue);\n+\n+        if (isMuted) simpleExoPlayer.setVolume(0);", "originalCommit": "a6fcb70d1275e8a1fbc3f712b9152233b1fe8bb1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQxNzYxMA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r386417610", "bodyText": "Readd this newline", "author": "Stypox", "createdAt": "2020-03-02T14:17:51Z", "path": "app/src/main/java/org/schabi/newpipe/player/BackgroundPlayer.java", "diffHunk": "@@ -341,7 +341,6 @@ public void initPlayer(boolean playOnReady) {\n         @Override\n         public void handleIntent(final Intent intent) {\n             super.handleIntent(intent);\n-", "originalCommit": "a6fcb70d1275e8a1fbc3f712b9152233b1fe8bb1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "92ee51b8db64b4ba6d4dfb22a925af2b4a37dd02", "url": "https://github.com/TeamNewPipe/NewPipe/commit/92ee51b8db64b4ba6d4dfb22a925af2b4a37dd02", "message": "resolved issues", "committedDate": "2020-03-02T20:12:02Z", "type": "commit"}, {"oid": "c79f09c119f156cddc574850f79b97a1d9eb9fb0", "url": "https://github.com/TeamNewPipe/NewPipe/commit/c79f09c119f156cddc574850f79b97a1d9eb9fb0", "message": "mute button in actionbar, no color change", "committedDate": "2020-03-02T21:52:58Z", "type": "commit"}, {"oid": "840bb29c542c797123eede58c15b3482a7e47bb6", "url": "https://github.com/TeamNewPipe/NewPipe/commit/840bb29c542c797123eede58c15b3482a7e47bb6", "message": "icon color change in action bar", "committedDate": "2020-03-02T23:01:19Z", "type": "commit"}, {"oid": "1ae8a72ba6d222b6fbf8977f8932f4835dbe85cc", "url": "https://github.com/TeamNewPipe/NewPipe/commit/1ae8a72ba6d222b6fbf8977f8932f4835dbe85cc", "message": "mute icon change in action bar", "committedDate": "2020-03-04T17:37:04Z", "type": "commit"}, {"oid": "83c7c4a68e795d22e2e84bc0e541b68af82c42e1", "url": "https://github.com/TeamNewPipe/NewPipe/commit/83c7c4a68e795d22e2e84bc0e541b68af82c42e1", "message": "mute/unmute text change in action bar", "committedDate": "2020-03-04T17:53:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NTA1NA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r387985054", "bodyText": "Are you sure it is ok to call isMuted() here? What if simpleExoPlayer is null, and the call to getVolume() fails?", "author": "Stypox", "createdAt": "2020-03-04T22:58:13Z", "path": "app/src/main/java/org/schabi/newpipe/player/BasePlayer.java", "diffHunk": "@@ -275,6 +277,7 @@ public void handleIntent(Intent intent) {\n         final float playbackPitch = intent.getFloatExtra(PLAYBACK_PITCH, getPlaybackPitch());\n         final boolean playbackSkipSilence = intent.getBooleanExtra(PLAYBACK_SKIP_SILENCE,\n                 getPlaybackSkipSilence());\n+        final boolean isMuted = intent.getBooleanExtra(IS_MUTED, isMuted());", "originalCommit": "83c7c4a68e795d22e2e84bc0e541b68af82c42e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQ1NjM5MQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r388456391", "bodyText": "To be honest I haven't thought about that risk while writting it. And now I think there is no \"null risk\"... I think so because handleIntent() is only called when intent is received -> which happens only while switching between base/popup/bckgrnd player -> which have to be != null ass Intent comes from other player :) But maybe I am missing something. Please correct me if I am wrong.", "author": "karkaminski", "createdAt": "2020-03-05T17:44:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NTA1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQ1Nzk1Ng==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r388457956", "bodyText": "No, that's reasonable, you are right. But I'd put a null check anyway just to be sure, something like\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    final boolean isMuted = intent.getBooleanExtra(IS_MUTED, isMuted());\n          \n          \n            \n                    final boolean isMuted = intent.getBooleanExtra(IS_MUTED, simpleExoPlayer == null ? false : isMuted());", "author": "Stypox", "createdAt": "2020-03-05T17:47:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NTA1NA=="}], "type": "inlineReview"}, {"oid": "55d7be0b2fb9e08402e28a560cdc63fe787d3afb", "url": "https://github.com/TeamNewPipe/NewPipe/commit/55d7be0b2fb9e08402e28a560cdc63fe787d3afb", "message": "null risk issue", "committedDate": "2020-03-05T18:07:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwNjQ2MA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r388506460", "bodyText": "What if the theme is white theme? The active button color should be black in that case. I'd suggest adding two attributes in attrs.xml named something along the lines of button_active and button_inactive and giving them different color values in the themes.xml file, so that they are themed.", "author": "Stypox", "createdAt": "2020-03-05T19:16:33Z", "path": "app/src/main/java/org/schabi/newpipe/player/MainVideoPlayer.java", "diffHunk": "@@ -394,6 +400,11 @@ protected void setShuffleButton(final ImageButton shuffleButton, final boolean s\n         shuffleButton.setImageAlpha(shuffleAlpha);\n     }\n \n+    protected void setMuteButton(final ImageButton muteButton, final boolean isMuted) {\n+        muteButton.setColorFilter(ContextCompat.getColor(getApplicationContext(), isMuted ? R.color.white : R.color.gray));", "originalCommit": "55d7be0b2fb9e08402e28a560cdc63fe787d3afb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUxNjUxNg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r388516516", "bodyText": "White theme does not affect background color for Main video player. Background is always black for this player. So if icon would turn black in WhiteTheme, then it would become invisible ;)", "author": "karkaminski", "createdAt": "2020-03-05T19:34:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwNjQ2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUzNDAwNw==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r388534007", "bodyText": "Oh you are right, nevermind \ud83e\udd26\u200d\u2642\ufe0f\nThen there should be different code for every player, at this point", "author": "Stypox", "createdAt": "2020-03-05T20:06:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwNjQ2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODU0MTExNQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3165#discussion_r388541115", "bodyText": "For MainVideoPlayer icon change happens in setMuteButton (place you've mentioned above).\nFor PopUp and Background, icon change happens for queue in ServicePlayerActivity in onMaybeMuteChanged. I did it similarly to other buttons, (e.g onPlayModeChanged also in ServicePlayerActivity)", "author": "karkaminski", "createdAt": "2020-03-05T20:20:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwNjQ2MA=="}], "type": "inlineReview"}]}