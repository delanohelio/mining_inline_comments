{"pr_number": 2340, "pr_title": "Only set the virtpoller beacon if the minion is a virtualhost", "pr_createdAt": "2020-06-19T13:07:57Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2340", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjgzNDAwOA==", "url": "https://github.com/uyuni-project/uyuni/pull/2340#discussion_r442834008", "bodyText": "Looks good. I would change the generatePillarData function to return an Optional, something like this\nthis.minionPillarGenerator.generatePillarData(minion).ifPresent(() -> this.saveFileToDisk(pillar, this.minionPillarGenerator.getFilename(minion.getMinionId())));", "author": "chiaradiamarcelo", "createdAt": "2020-06-19T13:16:04Z", "path": "java/code/src/com/suse/manager/webui/services/pillar/MinionPillarFileManager.java", "diffHunk": "@@ -54,7 +54,12 @@ public MinionPillarFileManager(MinionPillarGenerator minionPillarGeneratorIn) {\n      */\n     public void generatePillarFile(MinionServer minion) {\n         SaltPillar pillar = this.minionPillarGenerator.generatePillarData(minion);\n-        this.saveFileToDisk(pillar, this.minionPillarGenerator.getFilename(minion.getMinionId()));\n+        if (!pillar.isEmpty()) {", "originalCommit": "74815c4cc990e58901cdb7f7d9365100d3668a85", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3e4dd3bed12050f5ebfe1ff4862cef70857684e5", "url": "https://github.com/uyuni-project/uyuni/commit/3e4dd3bed12050f5ebfe1ff4862cef70857684e5", "message": "Only set the virtpoller beacon if the minion is a virtualhost\n\nThe MinionPillarManager need not to write the virtualization pillar if\nthe minion doesn't have virtualization entitlement. However we still\nneed it to clear the virtualization pillar when deleting a virtual host.", "committedDate": "2020-06-19T14:06:22Z", "type": "forcePushed"}, {"oid": "06d6ccd61dfdc9050de9174365f89dba0e89f6da", "url": "https://github.com/uyuni-project/uyuni/commit/06d6ccd61dfdc9050de9174365f89dba0e89f6da", "message": "Only set the virtpoller beacon if the minion is a virtualhost\n\nThe MinionPillarManager need not to write the virtualization pillar if\nthe minion doesn't have virtualization entitlement. However we still\nneed it to clear the virtualization pillar when deleting a virtual host.", "committedDate": "2020-06-19T14:13:06Z", "type": "forcePushed"}, {"oid": "34dfece3c79aab1b41b0411fce6d9a5d415f3b49", "url": "https://github.com/uyuni-project/uyuni/commit/34dfece3c79aab1b41b0411fce6d9a5d415f3b49", "message": "Only set the virtpoller beacon if the minion is a virtualhost\n\nThe MinionPillarManager need not to write the virtualization pillar if\nthe minion doesn't have virtualization entitlement. However we still\nneed it to clear the virtualization pillar when deleting a virtual host.", "committedDate": "2020-06-19T14:16:34Z", "type": "forcePushed"}, {"oid": "262f1bdce1097dd7292d32111743eb4767b04015", "url": "https://github.com/uyuni-project/uyuni/commit/262f1bdce1097dd7292d32111743eb4767b04015", "message": "Only set the virtpoller beacon if the minion is a virtualhost\n\nThe MinionPillarManager need not to write the virtualization pillar if\nthe minion doesn't have virtualization entitlement. However we still\nneed it to clear the virtualization pillar when deleting a virtual host.", "committedDate": "2020-06-19T15:57:37Z", "type": "commit"}, {"oid": "8562303d58b7f00b48243f5ab45b8e9c70c61c2c", "url": "https://github.com/uyuni-project/uyuni/commit/8562303d58b7f00b48243f5ab45b8e9c70c61c2c", "message": "Fix VirtualGuestsControllerTest flakyness", "committedDate": "2020-06-19T15:57:39Z", "type": "commit"}, {"oid": "8562303d58b7f00b48243f5ab45b8e9c70c61c2c", "url": "https://github.com/uyuni-project/uyuni/commit/8562303d58b7f00b48243f5ab45b8e9c70c61c2c", "message": "Fix VirtualGuestsControllerTest flakyness", "committedDate": "2020-06-19T15:57:39Z", "type": "forcePushed"}]}