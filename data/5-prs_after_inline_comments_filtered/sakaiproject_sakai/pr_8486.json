{"pr_number": 8486, "pr_title": "SAK-44171 Lessons tool does not display Resource folder displayname", "pr_createdAt": "2020-08-28T02:23:28Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8486", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE3MTkwOQ==", "url": "https://github.com/sakaiproject/sakai/pull/8486#discussion_r480171909", "bodyText": "Why not just use ResourceProperties.PROP_DISPLAY_NAME?\nAlso, you could use StringUtils.isBlank  on the displayName test.", "author": "adrianfish", "createdAt": "2020-08-31T14:33:42Z", "path": "lessonbuilder/tool/src/java/org/sakaiproject/lessonbuildertool/tool/producers/ShowPageProducer.java", "diffHunk": "@@ -3096,6 +3097,19 @@ public int compare(SimpleStudentPage o1, SimpleStudentPage o2) {\n \t\t\t\t\t\tString folderName = folderPath[folderPath.length-1];\n \t\t\t\t\t\tif (dataDirectory.endsWith(\"//\")){\n \t\t\t\t\t\t\tfolderName = simplePageBean.getCurrentSite().getTitle();\n+\t\t\t\t\t\t} else {\n+\t\t\t\t\t\t\ttry {\n+\t\t\t\t\t\t\t\tContentHostingService contentHostingService = (ContentHostingService) ComponentManager.get(\"org.sakaiproject.content.api.ContentHostingService\");\n+\t\t\t\t\t\t\t\tContentCollection collection = contentHostingService.getCollection(dataDirectory.replace(\"//\", \"/\"));\n+\t\t\t\t\t\t\t\tif (collection != null) {\n+\t\t\t\t\t\t\t\t\tString displayName = collection.getProperties().getProperty(collection.getProperties().getNamePropDisplayName());\n+\t\t\t\t\t\t\t\t\tif (displayName != null && displayName != \"\") {", "originalCommit": "96c0ed520676f628f54b829ed46ed118ceef2918", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDMzMDk0MA==", "url": "https://github.com/sakaiproject/sakai/pull/8486#discussion_r480330940", "bodyText": "fixed", "author": "austin48", "createdAt": "2020-08-31T19:07:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE3MTkwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE3MzIyOA==", "url": "https://github.com/sakaiproject/sakai/pull/8486#discussion_r480173228", "bodyText": "You should probably use log.error(\"error message\", e) here.", "author": "adrianfish", "createdAt": "2020-08-31T14:35:39Z", "path": "lessonbuilder/tool/src/java/org/sakaiproject/lessonbuildertool/tool/producers/ShowPageProducer.java", "diffHunk": "@@ -3096,6 +3097,19 @@ public int compare(SimpleStudentPage o1, SimpleStudentPage o2) {\n \t\t\t\t\t\tString folderName = folderPath[folderPath.length-1];\n \t\t\t\t\t\tif (dataDirectory.endsWith(\"//\")){\n \t\t\t\t\t\t\tfolderName = simplePageBean.getCurrentSite().getTitle();\n+\t\t\t\t\t\t} else {\n+\t\t\t\t\t\t\ttry {\n+\t\t\t\t\t\t\t\tContentHostingService contentHostingService = (ContentHostingService) ComponentManager.get(\"org.sakaiproject.content.api.ContentHostingService\");\n+\t\t\t\t\t\t\t\tContentCollection collection = contentHostingService.getCollection(dataDirectory.replace(\"//\", \"/\"));\n+\t\t\t\t\t\t\t\tif (collection != null) {\n+\t\t\t\t\t\t\t\t\tString displayName = collection.getProperties().getProperty(collection.getProperties().getNamePropDisplayName());\n+\t\t\t\t\t\t\t\t\tif (displayName != null && displayName != \"\") {\n+\t\t\t\t\t\t\t\t\t\tfolderName = displayName;\n+\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t} catch (Exception e) {\n+\t\t\t\t\t\t\t\tlog.error(\"Error getting content resource\" + e);", "originalCommit": "96c0ed520676f628f54b829ed46ed118ceef2918", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDMzMTA3OQ==", "url": "https://github.com/sakaiproject/sakai/pull/8486#discussion_r480331079", "bodyText": "fixed.  thanks for the suggestions", "author": "austin48", "createdAt": "2020-08-31T19:07:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE3MzIyOA=="}], "type": "inlineReview"}, {"oid": "ab0181586757048b8be85192cd9995989fa7744a", "url": "https://github.com/sakaiproject/sakai/commit/ab0181586757048b8be85192cd9995989fa7744a", "message": "SAK-44171 Lessons tool does not display Resource folder displayname", "committedDate": "2020-09-04T14:29:57Z", "type": "commit"}, {"oid": "4531998d65815e654de3dcd1280d590943162c29", "url": "https://github.com/sakaiproject/sakai/commit/4531998d65815e654de3dcd1280d590943162c29", "message": "SAK-44171 Lessons tool does not display Resource folder displayname\n\nadd improvements suggested in github comments", "committedDate": "2020-09-04T14:29:58Z", "type": "commit"}, {"oid": "8197092f04a18ad9208ec135ee46ea9fd14dda90", "url": "https://github.com/sakaiproject/sakai/commit/8197092f04a18ad9208ec135ee46ea9fd14dda90", "message": "SAK-44171 Lessons tool does not display Resource folder displayname\n\nexception displays the collection id so we don't need to include it.", "committedDate": "2020-09-04T14:29:58Z", "type": "commit"}, {"oid": "48929efce5216eca913933a7fd660f9e53254ded", "url": "https://github.com/sakaiproject/sakai/commit/48929efce5216eca913933a7fd660f9e53254ded", "message": "Refactor of original PR", "committedDate": "2020-09-04T14:29:58Z", "type": "forcePushed"}, {"oid": "1a07a0f1e0ae31d73e84ce369f1619b66359ceb7", "url": "https://github.com/sakaiproject/sakai/commit/1a07a0f1e0ae31d73e84ce369f1619b66359ceb7", "message": "Refactor of original PR", "committedDate": "2020-09-04T15:16:07Z", "type": "forcePushed"}, {"oid": "028c9f55812a217bde9965d64da2350813ed0ec2", "url": "https://github.com/sakaiproject/sakai/commit/028c9f55812a217bde9965d64da2350813ed0ec2", "message": "Refactor of original PR", "committedDate": "2020-09-04T15:16:56Z", "type": "commit"}, {"oid": "028c9f55812a217bde9965d64da2350813ed0ec2", "url": "https://github.com/sakaiproject/sakai/commit/028c9f55812a217bde9965d64da2350813ed0ec2", "message": "Refactor of original PR", "committedDate": "2020-09-04T15:16:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY5NDA1MA==", "url": "https://github.com/sakaiproject/sakai/pull/8486#discussion_r483694050", "bodyText": "Can you outdent these two lines?", "author": "adrianfish", "createdAt": "2020-09-04T15:32:50Z", "path": "lessonbuilder/tool/src/java/org/sakaiproject/lessonbuildertool/tool/producers/ShowPageProducer.java", "diffHunk": "@@ -4289,18 +4286,9 @@ private void createToolBar(UIContainer tofill, SimplePage currentPage) {\n \n \t\t    // add website.\n \t\t    // Are we running a kernel with KNL-273?\n-\t\t    Class contentHostingInterface = ContentHostingService.class;\n-\t\t    try {\n-\t\t\tMethod expandMethod = contentHostingInterface.getMethod(\"expandZippedResource\", new Class[] { String.class });\n-\t\t\t\n \t\t\tUIOutput.make(tofill, \"addwebsite-li\");", "originalCommit": "028c9f55812a217bde9965d64da2350813ed0ec2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcwNjk1Mw==", "url": "https://github.com/sakaiproject/sakai/pull/8486#discussion_r483706953", "bodyText": "yeah the indentation is mixed here, lines are using 2 tabs and 4 spaces so decided not to update it to keep history", "author": "ern", "createdAt": "2020-09-04T15:48:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY5NDA1MA=="}], "type": "inlineReview"}]}