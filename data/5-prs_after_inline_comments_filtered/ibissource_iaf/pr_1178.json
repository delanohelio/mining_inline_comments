{"pr_number": 1178, "pr_title": "Frank!Doc: Add element type and config child to the model", "pr_createdAt": "2020-10-21T11:54:57Z", "pr_url": "https://github.com/ibissource/iaf/pull/1178", "timeline": [{"oid": "65b315f2d6435191a4a051d6ee4d829a1a90274e", "url": "https://github.com/ibissource/iaf/commit/65b315f2d6435191a4a051d6ee4d829a1a90274e", "message": "Work in progress - fixing the IbisDoc tests", "committedDate": "2020-10-15T13:48:06Z", "type": "commit"}, {"oid": "40c29efcc360da6d1d7b29a2d4b4efc6e75f8c31", "url": "https://github.com/ibissource/iaf/commit/40c29efcc360da6d1d7b29a2d4b4efc6e75f8c31", "message": "Finish fixing the IbisDoc Larva tests", "committedDate": "2020-10-15T17:27:40Z", "type": "commit"}, {"oid": "f085b18612869c967d79a04b16fd22f0c6d00f51", "url": "https://github.com/ibissource/iaf/commit/f085b18612869c967d79a04b16fd22f0c6d00f51", "message": "Undo unwanted changes and add more excludes to avoid Ifsa in docs", "committedDate": "2020-10-16T13:24:35Z", "type": "commit"}, {"oid": "2b0022d9721ac3e44e66ad2d011606e88597c4ff", "url": "https://github.com/ibissource/iaf/commit/2b0022d9721ac3e44e66ad2d011606e88597c4ff", "message": "Undo changes of .project", "committedDate": "2020-10-16T13:25:55Z", "type": "commit"}, {"oid": "b8550782686dc82d4a3d13264ccb5851e0dc41c2", "url": "https://github.com/ibissource/iaf/commit/b8550782686dc82d4a3d13264ccb5851e0dc41c2", "message": "Undo change of test/.project", "committedDate": "2020-10-16T13:29:56Z", "type": "commit"}, {"oid": "45ee0ad7abee6f7dd5f32b36b8e28f137aa5a59c", "url": "https://github.com/ibissource/iaf/commit/45ee0ad7abee6f7dd5f32b36b8e28f137aa5a59c", "message": "Add backwards compatible deprecated setProxyUserName()", "committedDate": "2020-10-16T13:54:05Z", "type": "commit"}, {"oid": "e1218f43e0da85a7a22a0a9f76e53abdc59caec3", "url": "https://github.com/ibissource/iaf/commit/e1218f43e0da85a7a22a0a9f76e53abdc59caec3", "message": "Accept FrankDoc results as they are now", "committedDate": "2020-10-16T15:33:50Z", "type": "commit"}, {"oid": "4b05ccd9656ad5a6950ac693ca5a484c182aed3b", "url": "https://github.com/ibissource/iaf/commit/4b05ccd9656ad5a6950ac693ca5a484c182aed3b", "message": "Follow-up review comments, not yet tested", "committedDate": "2020-10-19T08:00:06Z", "type": "commit"}, {"oid": "e7db6f596837c0e5c99f3efd2d2765267714db37", "url": "https://github.com/ibissource/iaf/commit/e7db6f596837c0e5c99f3efd2d2765267714db37", "message": "Forgot a local variable username instead of userName", "committedDate": "2020-10-19T08:19:04Z", "type": "commit"}, {"oid": "cc294b1bd0fad9c8c60d768ee84d93f93107524d", "url": "https://github.com/ibissource/iaf/commit/cc294b1bd0fad9c8c60d768ee84d93f93107524d", "message": "Fix expected ibisdoc.xsd", "committedDate": "2020-10-19T08:28:46Z", "type": "commit"}, {"oid": "b37f049c151609e1d9ff14d82ea0975060f0d1f7", "url": "https://github.com/ibissource/iaf/commit/b37f049c151609e1d9ff14d82ea0975060f0d1f7", "message": "Follow Niels' review comments", "committedDate": "2020-10-20T08:27:12Z", "type": "commit"}, {"oid": "61d07acc47547b04bf2a1721499c9eee4ac119a8", "url": "https://github.com/ibissource/iaf/commit/61d07acc47547b04bf2a1721499c9eee4ac119a8", "message": "Add @IbisDoc for config children and then fix IbisDoc tests", "committedDate": "2020-10-20T13:23:43Z", "type": "commit"}, {"oid": "69fa631b228dbdaf0e2b94b08baf88530528e290", "url": "https://github.com/ibissource/iaf/commit/69fa631b228dbdaf0e2b94b08baf88530528e290", "message": "Create ElementType", "committedDate": "2020-10-20T15:28:55Z", "type": "commit"}, {"oid": "78220e7ae46c4809d4392882e0c0bbde81594c1d", "url": "https://github.com/ibissource/iaf/commit/78220e7ae46c4809d4392882e0c0bbde81594c1d", "message": "Test that elements added to the type and all elements", "committedDate": "2020-10-20T17:44:02Z", "type": "commit"}, {"oid": "9f04a0930c086c4c0078d62fc0436aabe0b68a5f", "url": "https://github.com/ibissource/iaf/commit/9f04a0930c086c4c0078d62fc0436aabe0b68a5f", "message": "Clean up", "committedDate": "2020-10-20T17:48:56Z", "type": "commit"}, {"oid": "e3bf8675cc2656ac3d3c3df4fd0bc3b300dd3b15", "url": "https://github.com/ibissource/iaf/commit/e3bf8675cc2656ac3d3c3df4fd0bc3b300dd3b15", "message": "ChildConfigDictionary", "committedDate": "2020-10-21T08:18:36Z", "type": "commit"}, {"oid": "3d37d40fcd18a59367c755da5d45eabedc6747f2", "url": "https://github.com/ibissource/iaf/commit/3d37d40fcd18a59367c755da5d45eabedc6747f2", "message": "Finish config children", "committedDate": "2020-10-21T11:39:42Z", "type": "commit"}, {"oid": "1b9702de09c2504d2e228bbadf0cf89e646b8649", "url": "https://github.com/ibissource/iaf/commit/1b9702de09c2504d2e228bbadf0cf89e646b8649", "message": "Merge branch 'master' into fillDataModel3", "committedDate": "2020-10-21T11:51:44Z", "type": "commit"}, {"oid": "f554fb40206ea75785a969b6048929dc661b52c1", "url": "https://github.com/ibissource/iaf/commit/f554fb40206ea75785a969b6048929dc661b52c1", "message": "Make FrankElement and ElementType creation recursion-proof\n\nNot covered yet by unit tests, if ever", "committedDate": "2020-10-21T14:20:09Z", "type": "commit"}, {"oid": "47ea7d3b9165a20002eda39ed8c589a4be6686c1", "url": "https://github.com/ibissource/iaf/commit/47ea7d3b9165a20002eda39ed8c589a4be6686c1", "message": "Rename and comment", "committedDate": "2020-10-21T15:19:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI4NjY4Ng==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509286686", "bodyText": "Ik wil graag de volgende volgorde voorstellen:\n10 InputValidator\n20 OutputValidator\n30 InputWrapper\n40 OutputWrapper\n50 Exit\n60 Locker\n70 Cache\n80 Pipe", "author": "gvanbrakel", "createdAt": "2020-10-21T13:33:23Z", "path": "core/src/main/java/nl/nn/adapterframework/core/PipeLine.java", "diffHunk": "@@ -161,6 +161,7 @@\n \t * to prevail.\n \t * @see AbstractPipe\n \t **/\n+\t@IbisDoc(\"60\")", "originalCommit": "1b9702de09c2504d2e228bbadf0cf89e646b8649", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQwMTE4Mg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509401182", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-21T15:48:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI4NjY4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI5NTUzMg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509295532", "bodyText": "Voor Receiver:\n10 listener\n20 sender\n30 errorSender\n40 messageLog\n50 errorStorage", "author": "gvanbrakel", "createdAt": "2020-10-21T13:44:38Z", "path": "core/src/main/java/nl/nn/adapterframework/receivers/ReceiverBase.java", "diffHunk": "@@ -1724,6 +1724,7 @@ public ISender getSender() {\n \t\treturn sender;\n \t}\n \t\n+\t@IbisDoc(\"60\")", "originalCommit": "1b9702de09c2504d2e228bbadf0cf89e646b8649", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMzkwOA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509413908", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-21T16:05:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI5NTUzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM0NzEzNw==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509347137", "bodyText": "Je moet niet zomaar RuntimeExceptions gooien, maar altijd checked exceptions.\nOok moet je niet het path als parameter meegeven, alleen maar om in de foutmelding te kunnen gebruiken.\nAls je hier een SaxParseException gooit, dan kan je op regel 94 daar het pad aan toevoegen, en hoef je het hier niet te hebben.", "author": "gvanbrakel", "createdAt": "2020-10-21T14:40:59Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/ConfigChildDictionary.java", "diffHunk": "@@ -0,0 +1,122 @@\n+package nl.nn.adapterframework.doc.model;\n+\n+import java.io.IOException;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.StringTokenizer;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.logging.log4j.Logger;\n+import org.xml.sax.SAXException;\n+\n+import lombok.Getter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n+import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n+\n+class ConfigChildDictionary {\n+\tprivate static Logger log = LogUtil.getLogger(ConfigChildDictionary.class);\n+\n+\tpublic static final ConfigChildDictionary EMPTY = new ConfigChildDictionary();\n+\n+\tclass Item {\n+\t\tprivate @Getter String methodName;\n+\t\tprivate @Getter boolean mandatory;\n+\t\tprivate @Getter boolean allowMultiple;\n+\t\tprivate @Getter String syntax1Name;\n+\t\tprivate @Getter Integer defaultOrder;\n+\n+\t\tItem(String methodName, String syntax1Name, String path) {\n+\t\t\tthis.methodName = methodName;\n+\t\t\tthis.syntax1Name = syntax1Name;\n+\t\t\tmandatory = false;\n+\t\t\tif(methodName.startsWith(\"set\")) {\n+\t\t\t\tallowMultiple = false;\n+\t\t\t} else if((methodName.startsWith(\"add\")) || methodName.startsWith(\"register\")) {\n+\t\t\t\tallowMultiple = true;\n+\t\t\t} else {\n+\t\t\t\tthrow new RuntimeException(String.format(\n+\t\t\t\t\t\t\"Do not know how many elements go in method [%s], digester rules from [%s]\", methodName, path));", "originalCommit": "f554fb40206ea75785a969b6048929dc661b52c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQyNjEwMg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509426102", "bodyText": "Voordat ik het zo kan maken, moet ik meer code aanpassen. Deze RuntimeException wordt gegooid in ConfigChildDictionary.Handler.handle(). Deze method vervangt DigesterRulesHandler.handle(), maar die method gooit geen SAXException. Ik kan de SAXException dus niet door het call stack laten reizen tot ik bij de constructor van ConfigChildDictionary ben.\nWil je dat ik DigesterRulesHandler.handle() een SAXException laat gooien en dat ik de andere derived classes van DigesterRulesHandler aanpas?", "author": "mhdirkse", "createdAt": "2020-10-21T16:22:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM0NzEzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTk2MDgyMA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509960820", "bodyText": "Ja, dat lijkt me in dit geval het beste", "author": "gvanbrakel", "createdAt": "2020-10-22T08:06:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM0NzEzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTk5MjAxOQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509992019", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-22T08:53:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM0NzEzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1Mjg5MA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509352890", "bodyText": "Is het nodig om hier ConfigChildDictionary.Item te introduceren? Kan je niet meteen een ConfigChild maken/gebruiken?", "author": "gvanbrakel", "createdAt": "2020-10-21T14:47:37Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/ConfigChildDictionary.java", "diffHunk": "@@ -0,0 +1,122 @@\n+package nl.nn.adapterframework.doc.model;\n+\n+import java.io.IOException;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.StringTokenizer;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.logging.log4j.Logger;\n+import org.xml.sax.SAXException;\n+\n+import lombok.Getter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n+import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n+\n+class ConfigChildDictionary {\n+\tprivate static Logger log = LogUtil.getLogger(ConfigChildDictionary.class);\n+\n+\tpublic static final ConfigChildDictionary EMPTY = new ConfigChildDictionary();\n+\n+\tclass Item {\n+\t\tprivate @Getter String methodName;\n+\t\tprivate @Getter boolean mandatory;\n+\t\tprivate @Getter boolean allowMultiple;\n+\t\tprivate @Getter String syntax1Name;\n+\t\tprivate @Getter Integer defaultOrder;", "originalCommit": "f554fb40206ea75785a969b6048929dc661b52c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM4NzUwOA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509387508", "bodyText": "Hier hebben we het over de telefoon over gehad. Ik heb inmiddels een comment gemaakt waarin ik uitleg waarom deze class wordt ge\u00efntroduceerd.", "author": "mhdirkse", "createdAt": "2020-10-21T15:30:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1Mjg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTk2NzIwMA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509967200", "bodyText": "Ik stel voor dat je deze class 'ConfigChildSetter' noemt, en dat je er niet een inner class van maakt, maar een gewone.\nConfigChildDictionary is vervolgens (volgens mij) alleen maar een Map<String,ConfigChildSetter>, waarbij de string de methodname is. Hij kan dat zijn (extenden), hij hoeft niet zo'n map te hebben.", "author": "gvanbrakel", "createdAt": "2020-10-22T08:16:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1Mjg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDAwOTk1Mw==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510009953", "bodyText": "ConfigChildDictionary is iets meer dan een Map, want hij heeft method setMethodNameOrder(). Deze method kunnen we straks gebruiken om de default volgorde te configureren op de ConfigChildDictionary. De method heeft een check dat je alleen volgordes kan zetten voor methods die in digester-rules.xml voorkomen. Het configureren van de default volgordes gaat straks zo: dictionary.setMethodNameOrder(\"registerX\", 100). Met jouw voorstel wordt dit omslachtiger en minder robuust. Je krijgt iets als dictionary.get(\"registerX\").setDefaultSequenceInConfig(100)). Dit maakt een NullPointerException als je naar een method vraagt die niet in digester-rules.xml staat, in plaats van een duidelijke foutmelding.\nAls ConfigChildDictionary een subclass van Map wordt, dan hebben we minder controle over wat er met dit object gebeurt. Het is een object dat je configureert voordat je de rest van het model maakt, en dat na creatie niet meer verandert. Als we compositie met Map gebruiken in plaats van inheritance, dan kunnen we dat beter afdwingen, denk ik.\nIk begrijp de naam ConfigChildSetter niet goed, want deze class heeft geen method copyTo(ConfigChild target) of zo. Na creatie zit er alleen data in die gekopi\u00eberd wordt om ConfigChild te vullen. Wat vind je van de naam ConfigChildSeed?", "author": "mhdirkse", "createdAt": "2020-10-22T09:20:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1Mjg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMwNTA2MA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510305060", "bodyText": "t.a.v. Item / ConfigChildSetter:\nIk begrijp je punt dat wat ik een ConfigChildSetter wil noemen niet een setter van ConfigChilds is. Maar het beschrijft wel methods die ConfigChildSetters zijn. Dus nieuw voorstel: ConfigChildSetterDescriptor.\nDit kan ook een publieke class in een eigen file zijn, in plaats van een inner class\nt.a.v. structuur ConfigChildDictionary:\nIk vind eigenlijk niet dat die setMethodNameOrder() zo belangrijk is dat hij de structuur van de class moet bepalen. Ik denk eigenlijk ook dat we die defaultOrders niet gaan gebruiken. Het is net zo makkelijk en overzichtelijk om bij de bewuste methods een IbisDoc annotatie te zetten, om de volgorde aan te geven, maar uiteindelijk ook om het subelement te documenteren.\nIk denk dus dat\n\nwe het veld defaultOrder uit Item / ConfigChildSetterDescriptor weg moeten halen;\nde method setMethodNameOrder() uit ConfigChildDictionary weg moeten halen;\nEn dan blijft er over dat ConfigChildDictionary een Map van Items / ConfigChildSetterDescriptors is.", "author": "gvanbrakel", "createdAt": "2020-10-22T16:38:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1Mjg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDc4MTIyMA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510781220", "bodyText": "De structuur is aangepast zoals je voorstelt. Dan lijkt het me wel goed om in deze pull request alle @IbisDoc annotaties goed te zetten, ook degenen waarvan we eerst een default wilden doen. Kan je me vertellen welke volgordes we gaan doen?", "author": "mhdirkse", "createdAt": "2020-10-23T10:12:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1Mjg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg0Njc0Mw==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510846743", "bodyText": "Akkoord dat we de extra benodigde @IbisDoc annotaties uitstellen. Misschien vinden we nog een andere structuur voor ibisdoc.xsd, waardoor we in ibisdoc.xsd geen volgorde hoeven vast te leggen. In dit geval hoeft de volgorde ook niet in de Java code.", "author": "mhdirkse", "createdAt": "2020-10-23T12:25:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1Mjg5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM3NzM4NQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509377385", "bodyText": "Deze verandering hoeft niet. ClassLoaderManager is bij de imports opgenomen.", "author": "gvanbrakel", "createdAt": "2020-10-21T15:17:29Z", "path": "core/src/main/java/nl/nn/adapterframework/pipes/AbstractPipe.java", "diffHunk": "@@ -403,7 +403,7 @@ public IAdapter getAdapter() {\n \n \t/**\n \t * This ClassLoader is set upon creation of the pipe, used to retrieve resources configured by the Ibis application.\n-\t * @return returns the ClassLoader created by the {@link ClassLoaderManager ClassLoaderManager}.\n+\t * @return returns the ClassLoader created by the {@link nl.nn.adapterframework.configuration.ClassLoaderManager ClassLoaderManager}.", "originalCommit": "f554fb40206ea75785a969b6048929dc661b52c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQzMDIzMg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509430232", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-21T16:28:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM3NzM4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM3ODgyOA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509378828", "bodyText": "Dit lijkt me te kort door de bocht. Je kan de documenatie-tekst hier gebruiken om het subelement te documenteren.", "author": "gvanbrakel", "createdAt": "2020-10-21T15:19:17Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/InfoBuilder.java", "diffHunk": "@@ -231,6 +231,9 @@ private void enrichPropertyOfIbisBean(BeanProperty beanProperty, IbisBean ibisBe\n \t}\n \n \tprivate static FromAnnotations parseIbisDocAndIbisDocRef(Method method, boolean isJson) {\n+\t\tif(!InfoBuilderSource.isGetterOrSetter(method)) {\n+\t\t\treturn null;", "originalCommit": "f554fb40206ea75785a969b6048929dc661b52c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQzMzUxOA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509433518", "bodyText": "Het documenteren van het subelement komt denk ik pas als we het nieuwe model gebruiken. Deze wijziging is alleen om de code zonder het nieuwe model te fixen. Die oude code mag niet in de war raken van onzen nieuwe @IbisDoc annotaties. Dat  regel ik met deze regels code.", "author": "mhdirkse", "createdAt": "2020-10-21T16:33:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM3ODgyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTk2MTM1NA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509961354", "bodyText": "OK", "author": "gvanbrakel", "createdAt": "2020-10-22T08:07:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM3ODgyOA=="}], "type": "inlineReview"}, {"oid": "8a35e40eb86ea300e5708ba39a38f9af2600347a", "url": "https://github.com/ibissource/iaf/commit/8a35e40eb86ea300e5708ba39a38f9af2600347a", "message": "Change sort order config childrein of pipeline", "committedDate": "2020-10-21T15:46:48Z", "type": "commit"}, {"oid": "f24ad7d7bffa60d6510ca49b36b6d293cb85bed6", "url": "https://github.com/ibissource/iaf/commit/f24ad7d7bffa60d6510ca49b36b6d293cb85bed6", "message": "Change config children order ReceiverBase", "committedDate": "2020-10-21T16:03:57Z", "type": "commit"}, {"oid": "a0a96e75342ed79b634bccad8ef368937eb4572d", "url": "https://github.com/ibissource/iaf/commit/a0a96e75342ed79b634bccad8ef368937eb4572d", "message": "In JavaDoc comment ClassLoaderManager zonder pad", "committedDate": "2020-10-21T16:27:50Z", "type": "commit"}, {"oid": "111ceaf5aac7430de3e3124fa6a9983364e3c5e3", "url": "https://github.com/ibissource/iaf/commit/111ceaf5aac7430de3e3124fa6a9983364e3c5e3", "message": "Rename ModelBuilderTest to UtilsTest and improve coverage", "committedDate": "2020-10-21T17:06:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTk3MDU3Mw==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r509970573", "bodyText": "Ik stel voor dat ConfigChildDictionary een veld wordt van FrankDocModel, dat je meegeeft bij het aanroepen van de constructor, zodat je zeker weet dat er er voordat je het model gaat maken.\nJe moet het niet steeds doorgeven als parameter, want hij verandert nooit.", "author": "gvanbrakel", "createdAt": "2020-10-22T08:21:46Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -17,33 +17,64 @@\n import lombok.Setter;\n import nl.nn.adapterframework.doc.IbisDoc;\n import nl.nn.adapterframework.doc.IbisDocRef;\n+import nl.nn.adapterframework.doc.Utils;\n import nl.nn.adapterframework.util.LogUtil;\n \n public class FrankDocModel {\n-\tprivate static final String JAVA_STRING = \"java.lang.String\";\n-\n \tprivate static Logger log = LogUtil.getLogger(FrankDocModel.class);\n \n \tprivate @Getter List<FrankDocGroup> groups;\n \tprivate @Getter Map<String, FrankElement> allElements = new HashMap<>();\n+\tprivate @Getter Map<String, ElementType> allTypes = new HashMap<>();\n \n \tpublic FrankDocModel() {\n \t\tgroups = new ArrayList<>();\n \t}\n \n-\tpublic FrankElement findOrCreateFrankElement(Class<?> clazz) {\n+\tpublic ElementType findOrCreateElementType(Class<?> clazz, ConfigChildDictionary dictionary) {", "originalCommit": "111ceaf5aac7430de3e3124fa6a9983364e3c5e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDAxMjU4OA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510012588", "bodyText": "Akkoord. Ik kan dit doen als ik antwoord heb op mijn nieuwe vragen over ConfigChildDictionary.", "author": "mhdirkse", "createdAt": "2020-10-22T09:24:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTk3MDU3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDc3OTgzOA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510779838", "bodyText": "Het model bevat nu een Map<String, ConfigChildSetterDescriptor>. De constructor van het model maakt een lege Map. Die is handig bij het unit testen. Er is een method om deze map te vullen op basis van een (fake) digester-rules.xml file.", "author": "mhdirkse", "createdAt": "2020-10-23T10:10:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTk3MDU3Mw=="}], "type": "inlineReview"}, {"oid": "82040e8ca668807c2df5964c1da65e8ec254101c", "url": "https://github.com/ibissource/iaf/commit/82040e8ca668807c2df5964c1da65e8ec254101c", "message": "Constructor of Item should not throw RuntimeException", "committedDate": "2020-10-22T08:52:42Z", "type": "commit"}, {"oid": "939ecf3dda1109fe63d57ea5f5f369fc3ca25118", "url": "https://github.com/ibissource/iaf/commit/939ecf3dda1109fe63d57ea5f5f369fc3ca25118", "message": "Reorganize to have ConfigChildSetterDescriptor", "committedDate": "2020-10-23T09:49:26Z", "type": "commit"}, {"oid": "bbd714124c28c1b5d672a85d766b081874b13cde", "url": "https://github.com/ibissource/iaf/commit/bbd714124c28c1b5d672a85d766b081874b13cde", "message": "Styling", "committedDate": "2020-10-23T09:56:44Z", "type": "commit"}, {"oid": "d44856a89488de45ba37b90c976c4c6a9667a0eb", "url": "https://github.com/ibissource/iaf/commit/d44856a89488de45ba37b90c976c4c6a9667a0eb", "message": "Styling", "committedDate": "2020-10-23T09:58:48Z", "type": "commit"}, {"oid": "9fdb9e75e1c34eac8544409150a0b05dd12b2596", "url": "https://github.com/ibissource/iaf/commit/9fdb9e75e1c34eac8544409150a0b05dd12b2596", "message": "Styling", "committedDate": "2020-10-23T10:01:49Z", "type": "commit"}, {"oid": "879ecf8d995f2253124cf28c5b2a715bcc46b0d6", "url": "https://github.com/ibissource/iaf/commit/879ecf8d995f2253124cf28c5b2a715bcc46b0d6", "message": "Clean up and styling", "committedDate": "2020-10-23T10:07:13Z", "type": "commit"}, {"oid": "09b4df8274ce90789cd8bb039a145879b6cc39b1", "url": "https://github.com/ibissource/iaf/commit/09b4df8274ce90789cd8bb039a145879b6cc39b1", "message": "Make digester-rules.xml method names unique", "committedDate": "2020-10-23T10:18:49Z", "type": "commit"}, {"oid": "226be78dda946daf37efe36b2994c49d1fc89206", "url": "https://github.com/ibissource/iaf/commit/226be78dda946daf37efe36b2994c49d1fc89206", "message": "Fix unit tests", "committedDate": "2020-10-23T11:58:37Z", "type": "commit"}, {"oid": "3fb47d48f30e60c052aa732b3b5d98a4b262b6bd", "url": "https://github.com/ibissource/iaf/commit/3fb47d48f30e60c052aa732b3b5d98a4b262b6bd", "message": "Test that @IbisDoc of derived has precedence", "committedDate": "2020-10-23T12:14:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg2OTQ5OQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510869499", "bodyText": "Ik denk dat je deze javadoc het beste kan beginnen met wat het is, bijvoorbeeld:\nThis class describes a method that a child element can call to register itself at its parent.\nIf such a method exists for a class, that class can have ConfigChildren of the type of the parameter of the method.", "author": "gvanbrakel", "createdAt": "2020-10-23T13:05:27Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/ConfigChildSetterDescriptor.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package nl.nn.adapterframework.doc.model;\n+\n+import org.xml.sax.SAXException;\n+\n+import lombok.Getter;\n+\n+/**\n+ * This class is similar to {@link ConfigChild}, but it is not the same. As an example,", "originalCommit": "3fb47d48f30e60c052aa732b3b5d98a4b262b6bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAwNTUwMg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511005502", "bodyText": "Akkoord, ga ik verbeteren.", "author": "mhdirkse", "createdAt": "2020-10-23T16:36:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg2OTQ5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg5NTQ1Nw==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511895457", "bodyText": "Ik heb de Javadoc veranderd, maar er zit nog iets niet lekker. Ik vermoed dat ik altijd een ander idee heb gehad dan jij over wat ConfigChildSetterDescriptor is. Ik ben benieuwd wat je van de Javadoc vindt die ik gemaakt heb. Is de naam ConfigChildSetterDescriptor nu nog goed? Of zal ik je suggestie over de Javadoc tekst overnemen zoals je die gegeven hebt?", "author": "mhdirkse", "createdAt": "2020-10-26T11:36:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg2OTQ5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3MjkzMg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510872932", "bodyText": "Met 'this can happen' bedoel je denk ik: dat dit FrankElement al aangemaakt is als gevolg van het aanmaken van de parent class. Als dat zo is, dan moet je dat concreter zeggen.", "author": "gvanbrakel", "createdAt": "2020-10-23T13:11:17Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -1,46 +1,136 @@\n package nl.nn.adapterframework.doc.model;\n \n+import java.io.IOException;\n import java.lang.reflect.Method;\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.HashMap;\n import java.util.LinkedHashMap;\n import java.util.List;\n import java.util.Map;\n+import java.util.StringTokenizer;\n import java.util.Map.Entry;\n import java.util.stream.Collectors;\n \n+import org.apache.commons.lang3.StringUtils;\n import org.apache.logging.log4j.Logger;\n import org.springframework.core.annotation.AnnotationUtils;\n+import org.xml.sax.SAXException;\n \n import lombok.Getter;\n import lombok.Setter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.doc.IbisDoc;\n import nl.nn.adapterframework.doc.IbisDocRef;\n+import nl.nn.adapterframework.doc.Utils;\n import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n \n public class FrankDocModel {\n-\tprivate static final String JAVA_STRING = \"java.lang.String\";\n-\n \tprivate static Logger log = LogUtil.getLogger(FrankDocModel.class);\n \n+\tprivate @Getter Map<String, ConfigChildSetterDescriptor> configChildDescriptors;\n \tprivate @Getter List<FrankDocGroup> groups;\n \tprivate @Getter Map<String, FrankElement> allElements = new HashMap<>();\n+\tprivate @Getter Map<String, ElementType> allTypes = new HashMap<>();\n \n \tpublic FrankDocModel() {\n+\t\tconfigChildDescriptors = new HashMap<>();\n \t\tgroups = new ArrayList<>();\n \t}\n \n+\tpublic void createConfigChildDescriptorsFrom(String path) {\n+\t\tResource resource = Resource.getResource(path);\n+\t\tif(resource == null) {\n+\t\t\tthrow new RuntimeException(String.format(\"Cannot find resource on the classpath: [%s]\", path));\n+\t\t}\n+\t\ttry {\n+\t\t\tXmlUtils.parseXml(resource.asInputSource(), new Handler(path));\n+\t\t}\n+\t\tcatch(IOException e) {\n+\t\t\tthrow new RuntimeException(String.format(\"An IOException occurred while parsing XML from [%s]\", path), e);\n+\t\t}\n+\t\tcatch(SAXException e) {\n+\t\t\tthrow new RuntimeException(String.format(\"A SAXException occurred while parsing XML from [%s]\", path), e);\n+\t\t}\n+\t}\n+\n+\tprivate class Handler extends DigesterRulesHandler {\n+\t\tprivate final String path;\n+\n+\t\tHandler(String path) {\n+\t\t\tthis.path = path;\n+\t\t}\n+\n+\t\t@Override\n+\t\tprotected void handle(DigesterRule rule) throws SAXException {\n+\t\t\tString pattern = rule.getPattern();\n+\t\t\tStringTokenizer tokenizer = new StringTokenizer(pattern, \"/\");\n+\t\t\tString syntax1Name = null;\n+\t\t\twhile(tokenizer.hasMoreElements()) {\n+\t\t\t\tString token = tokenizer.nextToken();\n+\t\t\t\tif(!\"*\".equals(token)) {\n+\t\t\t\t\tsyntax1Name = token;\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\tif(StringUtils.isNotEmpty(rule.getRegisterMethod())) {\n+\t\t\t\tadd(rule.getRegisterMethod(), syntax1Name);\n+\t\t\t}\t\t\t\n+\t\t}\n+\n+\t\tprivate void add(String registerMethod, String syntax1Name) throws SAXException {\n+\t\t\tConfigChildSetterDescriptor item = new ConfigChildSetterDescriptor(registerMethod, syntax1Name);\n+\t\t\tif(configChildDescriptors.containsKey(item.getMethodName())) {\n+\t\t\t\tlog.warn(String.format(\"In digester rules [%s], duplicate method name [%s]\", path, registerMethod));\n+\t\t\t} else {\n+\t\t\t\tconfigChildDescriptors.put(item.getMethodName(), item);\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tpublic ElementType findOrCreateElementType(Class<?> clazz) {\n+\t\tif(allTypes.containsKey(clazz.getName())) {\n+\t\t\treturn allTypes.get(clazz.getName());\n+\t\t}\n+\t\tfinal ElementType result = new ElementType(clazz);\n+\t\t// If a containing FrankElement contains the type being created, we do not\n+\t\t// want recursion.\n+\t\tallTypes.put(result.getFullName(), result);\n+\t\tif(clazz.isInterface()) {\n+\t\t\tUtils.getSpringBeans(clazz.getName()).stream()\n+\t\t\t\t\t.map(b -> b.getClazz())\n+\t\t\t\t\t.map(cl -> findOrCreateFrankElement(cl))\n+\t\t\t\t\t.forEach(result::addMember);\n+\t\t} else {\n+\t\t\tresult.addMember(findOrCreateFrankElement(clazz));\n+\t\t}\n+\t\treturn result;\n+\t}\n+\n+\tpublic boolean hasType(String typeName) {\n+\t\treturn allTypes.containsKey(typeName);\n+\t}\n+\n \tpublic FrankElement findOrCreateFrankElement(Class<?> clazz) {\n \t\tif(allElements.containsKey(clazz.getName())) {\n \t\t\treturn allElements.get(clazz.getName());\n \t\t}\n \t\tClass<?> superClass = clazz.getSuperclass();\n \t\tFrankElement parent = superClass == null ? null : findOrCreateFrankElement(superClass);\n-\t\tFrankElement current = new FrankElement(clazz, parent);\n-\t\tcurrent.setAttributes(createAttributes(clazz.getDeclaredMethods(), current));\n-\t\tallElements.put(current.getFullName(), current);\n-\t\treturn current;\n+\t\tif(allElements.containsKey(clazz.getName())) {\n+\t\t\t// This can happen when element C inherits from element P, while P can have\n+\t\t\t// C as a configuration child.", "originalCommit": "3fb47d48f30e60c052aa732b3b5d98a4b262b6bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAwNTM2OA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511005368", "bodyText": "Akkoord, ga ik verbeteren.", "author": "mhdirkse", "createdAt": "2020-10-23T16:35:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3MjkzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTc0MjY4OQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511742689", "bodyText": "Ook over deze if():\nAls je problemen met circular references wil voorkomen (bijvoorbeeld door een IbisDocRef van een class naar een child), dan moet je niet deze if doen, maar het element al aanmaken en in de lijst opnemen v\u00f3\u00f3r dat je findOrCreateFrankElement(superClass) aanroept.\nDe if() die je nu hebt gaat je er niet bij helpen, die komt te laat. Ik denk dus dat hij weg kan.", "author": "gvanbrakel", "createdAt": "2020-10-26T06:35:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3MjkzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTkwNTI1Ng==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511905256", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-26T11:55:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3MjkzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3NjM0MA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510876340", "bodyText": "Kan createConfigChildren() (en ook createAttributes()) niet een method van FrankElement zijn?", "author": "gvanbrakel", "createdAt": "2020-10-23T13:17:00Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -201,9 +277,43 @@ private static Method getParentMethod(String className, String methodName) {\n \t\t}\n \t}\n \n-\tpublic FrankDocGroup addGroup(String name) {\n-\t\tFrankDocGroup group = new FrankDocGroup(name);\n-\t\tgroups.add(group);\n-\t\treturn group;\n+\tprivate List<ConfigChild> createConfigChildren(\tMethod[] methods, FrankElement parent) {", "originalCommit": "3fb47d48f30e60c052aa732b3b5d98a4b262b6bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAwNTIwMQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511005201", "bodyText": "Hier hebben we het daarnet over gehad door de telefoon. Om attributes te cre\u00ebren moet je @IbisDocRef annotaties parsen en de betreffende FrankElement objecten cre\u00ebren. Dat zit weer in het model. Je voorstel zou betekenen dat FrankDocModel de class FrankAttribute moet importeren en ook omgekeerd. Dat lukt niet.\nHetzelfde geldt voor configuration children. Om een ConfigChild te maken moet je het ElementType cre\u00ebren dat erin gaat.", "author": "mhdirkse", "createdAt": "2020-10-23T16:35:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3NjM0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3NzkwMw==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510877903", "bodyText": "Deze parseIbisDocAnnotation() is er alleen voor ConfigChildren. Kan hij dan niet daar een method van zijn?", "author": "gvanbrakel", "createdAt": "2020-10-23T13:19:33Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -201,9 +277,43 @@ private static Method getParentMethod(String className, String methodName) {\n \t\t}\n \t}\n \n-\tpublic FrankDocGroup addGroup(String name) {\n-\t\tFrankDocGroup group = new FrankDocGroup(name);\n-\t\tgroups.add(group);\n-\t\treturn group;\n+\tprivate List<ConfigChild> createConfigChildren(\tMethod[] methods, FrankElement parent) {\n+\t\tList<Method> configChildSetters = Arrays.asList(methods).stream()\n+\t\t\t\t.filter(Utils::isConfigChildSetter)\n+\t\t\t\t.filter(m -> configChildDescriptors.get(m.getName()) != null)\n+\t\t\t\t.collect(Collectors.toList());\n+\t\tList<ConfigChild> result = new ArrayList<>();\n+\t\tfor(Method m: configChildSetters) {\n+\t\t\tConfigChild configChild = new ConfigChild(parent);\n+\t\t\tConfigChildSetterDescriptor configChildDescriptor = configChildDescriptors.get(m.getName());\n+\t\t\tIbisDoc ibisDoc = AnnotationUtils.findAnnotation(m, IbisDoc.class);\n+\t\t\tInteger optionalOrder = parseIbisDocAnnotation(ibisDoc);\n+\t\t\tif(optionalOrder != null) {\n+\t\t\t\tconfigChild.setSequenceInConfig(optionalOrder);\n+\t\t\t} else {\n+\t\t\t\tlog.warn(String.format(\"No config child order for method [%s] of Frank element [%s]\",\n+\t\t\t\t\t\tm.getName(), parent.getSimpleName()));\n+\t\t\t\tconfigChild.setSequenceInConfig(Integer.MAX_VALUE);\n+\t\t\t}\n+\t\t\tClass<?> elementClass = m.getParameterTypes()[0];\n+\t\t\tconfigChild.setElementType(findOrCreateElementType(elementClass));\n+\t\t\tconfigChild.setAllowMultiple(configChildDescriptor.isAllowMultiple());\n+\t\t\tconfigChild.setMandatory(configChildDescriptor.isMandatory());\n+\t\t\tconfigChild.setSyntax1Name(configChildDescriptor.getSyntax1Name());\n+\t\t\tresult.add(configChild);\n+\t\t}\n+\t\treturn result;\n+\t}\n+\n+\tprivate static Integer parseIbisDocAnnotation(IbisDoc ibisDoc) {", "originalCommit": "3fb47d48f30e60c052aa732b3b5d98a4b262b6bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAwNDU4NQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511004585", "bodyText": "Hier hebben we het daarnet over gehad door de telefoon. Om attributes te cre\u00ebren moet je @IbisDocRef annotaties parsen en de betreffende FrankElement objecten cre\u00ebren. Dat zit weer in het model. Je voorstel zou betekenen dat FrankDocModel de class FrankAttribute moet importeren en ook omgekeerd. Dat lukt niet.\nHetzelfde geldt voor configuration children. Om een ConfigChild te maken moet je het ElementType cre\u00ebren dat erin gaat.", "author": "mhdirkse", "createdAt": "2020-10-23T16:34:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3NzkwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAwNTAxOA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511005018", "bodyText": "Oh sorry, verkeerd gekeken. Dit punt kan ik w\u00e8l meenemen.", "author": "mhdirkse", "createdAt": "2020-10-23T16:35:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3NzkwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg4NDgzOA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511884838", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-26T11:16:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3NzkwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4MjEwMw==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510882103", "bodyText": "Kunnen deze niet het beste ook naar Utils verhuizen?", "author": "gvanbrakel", "createdAt": "2020-10-23T13:26:15Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/InfoBuilderSource.java", "diffHunk": "@@ -386,4 +397,25 @@ private static void getBeanProperties(Class<?> clazz, String verb, Map<String, M\n \t\t}\n \t}\n \n+\tpublic static boolean isGetterOrSetter(Method method) {\n+\t\tboolean isSetter = method.getReturnType().isPrimitive()\n+\t\t\t\t&& method.getReturnType().getName().equals(\"void\")\n+\t\t\t\t&& (method.getParameterTypes().length == 1)\n+\t\t\t\t&& (method.getParameterTypes()[0].isPrimitive()\n+\t\t\t\t\t\t|| JAVA_BOXED.contains(method.getParameterTypes()[0].getName()));\n+\t\tboolean isGetter = (\n+\t\t\t\t\t(method.getReturnType().isPrimitive()\n+\t\t\t\t\t\t\t&& !method.getReturnType().getName().equals(\"void\"))\n+\t\t\t\t\t|| JAVA_BOXED.contains(method.getReturnType().getName())\n+\t\t\t\t) && (method.getParameterTypes().length == 0);\n+\t\treturn isSetter || isGetter;\n+\t}\n+\n+\tpublic static boolean isConfigChildSetter(Method method) {\n+\t\treturn (method.getParameterTypes().length == 1)\n+\t\t\t\t&& (! method.getParameterTypes()[0].isPrimitive())\n+\t\t\t\t&& (! JAVA_BOXED.contains(method.getParameterTypes()[0].getName()))\n+\t\t\t\t&& (method.getReturnType().isPrimitive())\n+\t\t\t\t&& (method.getReturnType().getName().equals(\"void\"));\n+\t}", "originalCommit": "3fb47d48f30e60c052aa732b3b5d98a4b262b6bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk4MDM4NA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510980384", "bodyText": "Op termijn moeten ze daar komen, maar nu is dat nog lastig. In de oude code ben ik isGetterOrSetter gaan gebruiken, om te zorgen dat de nieuwe @IbisDoc annotaties de Frank!Doc niet stuk maken. Die implementatie gebruikt de static variabele JAVA_BOXED. Alle methods die JAVA_BOXED ook gebruiken heb ik er hier maar bij gezet. In Utils zijn al methods die de methods uit InfoBuilderSource aanroepen. In de code die we hier ontwikkelen roep ik de methods uit Utils aan.", "author": "mhdirkse", "createdAt": "2020-10-23T15:52:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4MjEwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4NTc0MA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r510885740", "bodyText": "Het lijkt me goed als je ook nog een  method maakt zoals 'populateModel()', die het model vult in de volgorde waarin dat hoort. Als ik het goed heb is dat:\n\nconfigChildDescriptors bepalen uit digesterRules\nelementTypes creeren uit configChildDescriptors\nSpringBeans ophalen voor alle elementTypes\nFrankElements en Attributes creeren uit SpringBeans", "author": "gvanbrakel", "createdAt": "2020-10-23T13:32:07Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -1,46 +1,136 @@\n package nl.nn.adapterframework.doc.model;\n \n+import java.io.IOException;\n import java.lang.reflect.Method;\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.HashMap;\n import java.util.LinkedHashMap;\n import java.util.List;\n import java.util.Map;\n+import java.util.StringTokenizer;\n import java.util.Map.Entry;\n import java.util.stream.Collectors;\n \n+import org.apache.commons.lang3.StringUtils;\n import org.apache.logging.log4j.Logger;\n import org.springframework.core.annotation.AnnotationUtils;\n+import org.xml.sax.SAXException;\n \n import lombok.Getter;\n import lombok.Setter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.doc.IbisDoc;\n import nl.nn.adapterframework.doc.IbisDocRef;\n+import nl.nn.adapterframework.doc.Utils;\n import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n \n public class FrankDocModel {\n-\tprivate static final String JAVA_STRING = \"java.lang.String\";\n-\n \tprivate static Logger log = LogUtil.getLogger(FrankDocModel.class);\n \n+\tprivate @Getter Map<String, ConfigChildSetterDescriptor> configChildDescriptors;\n \tprivate @Getter List<FrankDocGroup> groups;\n \tprivate @Getter Map<String, FrankElement> allElements = new HashMap<>();\n+\tprivate @Getter Map<String, ElementType> allTypes = new HashMap<>();\n \n \tpublic FrankDocModel() {\n+\t\tconfigChildDescriptors = new HashMap<>();\n \t\tgroups = new ArrayList<>();\n \t}\n ", "originalCommit": "3fb47d48f30e60c052aa732b3b5d98a4b262b6bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAwMzA3NQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r511003075", "bodyText": "Ik snap het na ons telefoongesprek van daarnet. Als ik een FrankElement maak voor bijvoorbeeld <Module>, dan ontstaan alle relevante types vanzelf vanwege hierarchie van config children. Dat kan ik inderdaad nu al toevoegen.", "author": "mhdirkse", "createdAt": "2020-10-23T16:31:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4NTc0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjI0MTA2OA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512241068", "bodyText": "Gedaan. Ik heb de code voor het parsen van @IbisDocRef en @IbisDoc voor attributes wel lelijker moeten maken. Soms wijzen @IbisDocRef annotaties naar methods die er niet zijn. Daarvoor heb ik warnings toegevoegd. Ik stel voor dat we voor een volgende pull request naar alle warnings gaan kijken om te zien waar annotaties missen.", "author": "mhdirkse", "createdAt": "2020-10-26T20:16:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4NTc0MA=="}], "type": "inlineReview"}, {"oid": "732e1e398c1422469d3614186e13d3d9afbd08bf", "url": "https://github.com/ibissource/iaf/commit/732e1e398c1422469d3614186e13d3d9afbd08bf", "message": "Merge branch 'master' into fillDataModel3", "committedDate": "2020-10-26T10:33:46Z", "type": "commit"}, {"oid": "887a6798b7be2cfb821e1689b2391f066c9f1cf6", "url": "https://github.com/ibissource/iaf/commit/887a6798b7be2cfb821e1689b2391f066c9f1cf6", "message": "Move parsing @IbisDoc to ConfigChild", "committedDate": "2020-10-26T11:12:58Z", "type": "commit"}, {"oid": "5e4295c49526be2006181beabf00ba4886653648", "url": "https://github.com/ibissource/iaf/commit/5e4295c49526be2006181beabf00ba4886653648", "message": "Improve Javadoc of ConfigChildSetterDescriptor", "committedDate": "2020-10-26T11:31:58Z", "type": "commit"}, {"oid": "f871993244c7b9eb082a797b10174cc5fb600f71", "url": "https://github.com/ibissource/iaf/commit/f871993244c7b9eb082a797b10174cc5fb600f71", "message": "Correct invalid solution for FrankElement creation recursion", "committedDate": "2020-10-26T11:52:51Z", "type": "commit"}, {"oid": "94c570724f745508e089434619ce1a80b2047c8f", "url": "https://github.com/ibissource/iaf/commit/94c570724f745508e089434619ce1a80b2047c8f", "message": "Exercise the FrankDocModel", "committedDate": "2020-10-26T20:13:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzNTExMg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512535112", "bodyText": "Ik wil graag de IbisDoc annotatie bij childElementSetters gaan gebruiken om de functie van de children te gaan documenteren. Daarop moet deze method niet stuk gaan; hij moet er dus tegen kunnen dat er meer dan \u00e9\u00e9n argument is. Hij moet dus:\n\nals er minimaal \u00e9\u00e9n argument is\nchecken of dat argument een integer is\nals dat zo is, dan dat als de order teruggeven.", "author": "gvanbrakel", "createdAt": "2020-10-27T09:29:12Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/ConfigChild.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package nl.nn.adapterframework.doc.model;\n+\n+import java.text.ParseException;\n+import java.util.Arrays;\n+import java.util.stream.Collectors;\n+\n+import org.apache.logging.log4j.Logger;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import nl.nn.adapterframework.doc.IbisDoc;\n+import nl.nn.adapterframework.util.LogUtil;\n+\n+public class ConfigChild {\n+\tprivate static Logger log = LogUtil.getLogger(ConfigChild.class);\n+\n+\tprivate @Getter FrankElement configParent;\n+\tprivate @Getter @Setter ElementType elementType;\n+\tprivate @Getter int sequenceInConfig;\n+\tprivate @Getter @Setter boolean mandatory;\n+\tprivate @Getter @Setter boolean allowMultiple;\n+\tprivate @Getter @Setter String syntax1Name;\n+\n+\tConfigChild(FrankElement configParent) {\n+\t\tthis.configParent = configParent;\n+\t}\n+\n+\tpublic void setSequenceInConfigFromIbisDocAnnotation(IbisDoc ibisDoc) throws ParseException {\n+\t\tsequenceInConfig = Integer.MAX_VALUE;\n+\t\tif(ibisDoc == null) {\n+\t\t\tthrow new ParseException(\"No @IbisDoc available\", 0);\n+\t\t}\n+\t\tInteger optionalOrder = parseIbisDocAnnotation(ibisDoc);\n+\t\tif(optionalOrder != null) {\n+\t\t\tsequenceInConfig = optionalOrder;\n+\t\t} else {\n+\t\t\tthrow new ParseException(String.format(\"Could not get order from @IbisDoc annotation with value [%s]\",\n+\t\t\t\t\tArrays.asList(ibisDoc.value()).stream().collect(Collectors.joining(\", \"))), 0);\n+\t\t}\n+\t}\n+\n+\tprivate static Integer parseIbisDocAnnotation(IbisDoc ibisDoc) {\n+\t\tInteger result = null;\n+\t\tif((ibisDoc != null) && (ibisDoc.value().length == 1)) {", "originalCommit": "94c570724f745508e089434619ce1a80b2047c8f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc4OTg2Ng==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512789866", "bodyText": "Gedaan", "author": "mhdirkse", "createdAt": "2020-10-27T15:26:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzNTExMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0MTMwNA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512541304", "bodyText": "Ik denk dat je hier het beste kan beginnen met nl.nn.adapterframework.configuration.Configuration", "author": "gvanbrakel", "createdAt": "2020-10-27T09:38:49Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -1,45 +1,143 @@\n package nl.nn.adapterframework.doc.model;\n \n+import java.io.IOException;\n import java.lang.reflect.Method;\n+import java.text.ParseException;\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.HashMap;\n import java.util.LinkedHashMap;\n import java.util.List;\n import java.util.Map;\n import java.util.Map.Entry;\n+import java.util.StringTokenizer;\n import java.util.stream.Collectors;\n \n+import org.apache.commons.lang3.StringUtils;\n import org.apache.logging.log4j.Logger;\n import org.springframework.core.annotation.AnnotationUtils;\n+import org.xml.sax.SAXException;\n \n import lombok.Getter;\n import lombok.Setter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.doc.IbisDoc;\n import nl.nn.adapterframework.doc.IbisDocRef;\n+import nl.nn.adapterframework.doc.Utils;\n import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n \n public class FrankDocModel {\n-\tprivate static final String JAVA_STRING = \"java.lang.String\";\n-\n \tprivate static Logger log = LogUtil.getLogger(FrankDocModel.class);\n-\n+\tprivate static final String DIGESTER_RULES = \"digester-rules.xml\";\n+\t\n+\tprivate @Getter Map<String, ConfigChildSetterDescriptor> configChildDescriptors;\n \tprivate @Getter List<FrankDocGroup> groups;\n \tprivate @Getter Map<String, FrankElement> allElements = new HashMap<>();\n+\tprivate @Getter Map<String, ElementType> allTypes = new HashMap<>();\n+\n+\t/**\n+\t * Get the FrankDocModel needed in production. This is just a first draft. The\n+\t * present version does not have groups yet. It will be improved in future\n+\t * pull requests. \n+\t */\n+\tpublic static FrankDocModel populate() {\n+\t\tFrankDocModel result = new FrankDocModel();\n+\t\tresult.createConfigChildDescriptorsFrom(DIGESTER_RULES);\n+\t\tresult.findOrCreateElementType(Utils.getClass(\"nl.nn.adapterframework.core.IAdapter\"));", "originalCommit": "94c570724f745508e089434619ce1a80b2047c8f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc1NjM0OQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512756349", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-27T14:47:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0MTMwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0NDUxOQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512544519", "bodyText": "Je moet hier, en op andere plekken, niet zomaar RuntimeExceptions gooien, maar 'normale' (checked) exceptions, die je vangt en afhandelt op een plek waar je er wat mee kan.", "author": "gvanbrakel", "createdAt": "2020-10-27T09:43:49Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -1,45 +1,143 @@\n package nl.nn.adapterframework.doc.model;\n \n+import java.io.IOException;\n import java.lang.reflect.Method;\n+import java.text.ParseException;\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.HashMap;\n import java.util.LinkedHashMap;\n import java.util.List;\n import java.util.Map;\n import java.util.Map.Entry;\n+import java.util.StringTokenizer;\n import java.util.stream.Collectors;\n \n+import org.apache.commons.lang3.StringUtils;\n import org.apache.logging.log4j.Logger;\n import org.springframework.core.annotation.AnnotationUtils;\n+import org.xml.sax.SAXException;\n \n import lombok.Getter;\n import lombok.Setter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.doc.IbisDoc;\n import nl.nn.adapterframework.doc.IbisDocRef;\n+import nl.nn.adapterframework.doc.Utils;\n import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n \n public class FrankDocModel {\n-\tprivate static final String JAVA_STRING = \"java.lang.String\";\n-\n \tprivate static Logger log = LogUtil.getLogger(FrankDocModel.class);\n-\n+\tprivate static final String DIGESTER_RULES = \"digester-rules.xml\";\n+\t\n+\tprivate @Getter Map<String, ConfigChildSetterDescriptor> configChildDescriptors;\n \tprivate @Getter List<FrankDocGroup> groups;\n \tprivate @Getter Map<String, FrankElement> allElements = new HashMap<>();\n+\tprivate @Getter Map<String, ElementType> allTypes = new HashMap<>();\n+\n+\t/**\n+\t * Get the FrankDocModel needed in production. This is just a first draft. The\n+\t * present version does not have groups yet. It will be improved in future\n+\t * pull requests. \n+\t */\n+\tpublic static FrankDocModel populate() {\n+\t\tFrankDocModel result = new FrankDocModel();\n+\t\tresult.createConfigChildDescriptorsFrom(DIGESTER_RULES);\n+\t\tresult.findOrCreateElementType(Utils.getClass(\"nl.nn.adapterframework.core.IAdapter\"));\n+\t\treturn result;\n+\t}\n \n \tpublic FrankDocModel() {\n+\t\tconfigChildDescriptors = new HashMap<>();\n \t\tgroups = new ArrayList<>();\n \t}\n \n+\tpublic void createConfigChildDescriptorsFrom(String path) {\n+\t\tResource resource = Resource.getResource(path);\n+\t\tif(resource == null) {\n+\t\t\tthrow new RuntimeException(String.format(\"Cannot find resource on the classpath: [%s]\", path));\n+\t\t}\n+\t\ttry {\n+\t\t\tXmlUtils.parseXml(resource.asInputSource(), new Handler(path));\n+\t\t}\n+\t\tcatch(IOException e) {\n+\t\t\tthrow new RuntimeException(String.format(\"An IOException occurred while parsing XML from [%s]\", path), e);", "originalCommit": "94c570724f745508e089434619ce1a80b2047c8f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjcyNTU2OQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512725569", "bodyText": "Ik heb alle runtime exceptions uit de \"nieuwe\" code weggehaald. In de oude Frank!Doc code kwamen al runtime exceptions voor. Die heb ik laten staan. In test code heb ik de runtime exceptions ook laten staan.", "author": "mhdirkse", "createdAt": "2020-10-27T14:11:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0NDUxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0NjYyNg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512546626", "bodyText": "Ik denk dat het ook handig is om de waarde van clazz.isInterface() te bewaren in ElementType result. Die gaat nog van pas komen denk ik.", "author": "gvanbrakel", "createdAt": "2020-10-27T09:47:02Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -1,45 +1,143 @@\n package nl.nn.adapterframework.doc.model;\n \n+import java.io.IOException;\n import java.lang.reflect.Method;\n+import java.text.ParseException;\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.HashMap;\n import java.util.LinkedHashMap;\n import java.util.List;\n import java.util.Map;\n import java.util.Map.Entry;\n+import java.util.StringTokenizer;\n import java.util.stream.Collectors;\n \n+import org.apache.commons.lang3.StringUtils;\n import org.apache.logging.log4j.Logger;\n import org.springframework.core.annotation.AnnotationUtils;\n+import org.xml.sax.SAXException;\n \n import lombok.Getter;\n import lombok.Setter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.doc.IbisDoc;\n import nl.nn.adapterframework.doc.IbisDocRef;\n+import nl.nn.adapterframework.doc.Utils;\n import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n \n public class FrankDocModel {\n-\tprivate static final String JAVA_STRING = \"java.lang.String\";\n-\n \tprivate static Logger log = LogUtil.getLogger(FrankDocModel.class);\n-\n+\tprivate static final String DIGESTER_RULES = \"digester-rules.xml\";\n+\t\n+\tprivate @Getter Map<String, ConfigChildSetterDescriptor> configChildDescriptors;\n \tprivate @Getter List<FrankDocGroup> groups;\n \tprivate @Getter Map<String, FrankElement> allElements = new HashMap<>();\n+\tprivate @Getter Map<String, ElementType> allTypes = new HashMap<>();\n+\n+\t/**\n+\t * Get the FrankDocModel needed in production. This is just a first draft. The\n+\t * present version does not have groups yet. It will be improved in future\n+\t * pull requests. \n+\t */\n+\tpublic static FrankDocModel populate() {\n+\t\tFrankDocModel result = new FrankDocModel();\n+\t\tresult.createConfigChildDescriptorsFrom(DIGESTER_RULES);\n+\t\tresult.findOrCreateElementType(Utils.getClass(\"nl.nn.adapterframework.core.IAdapter\"));\n+\t\treturn result;\n+\t}\n \n \tpublic FrankDocModel() {\n+\t\tconfigChildDescriptors = new HashMap<>();\n \t\tgroups = new ArrayList<>();\n \t}\n \n+\tpublic void createConfigChildDescriptorsFrom(String path) {\n+\t\tResource resource = Resource.getResource(path);\n+\t\tif(resource == null) {\n+\t\t\tthrow new RuntimeException(String.format(\"Cannot find resource on the classpath: [%s]\", path));\n+\t\t}\n+\t\ttry {\n+\t\t\tXmlUtils.parseXml(resource.asInputSource(), new Handler(path));\n+\t\t}\n+\t\tcatch(IOException e) {\n+\t\t\tthrow new RuntimeException(String.format(\"An IOException occurred while parsing XML from [%s]\", path), e);\n+\t\t}\n+\t\tcatch(SAXException e) {\n+\t\t\tthrow new RuntimeException(String.format(\"A SAXException occurred while parsing XML from [%s]\", path), e);\n+\t\t}\n+\t}\n+\n+\tprivate class Handler extends DigesterRulesHandler {\n+\t\tprivate final String path;\n+\n+\t\tHandler(String path) {\n+\t\t\tthis.path = path;\n+\t\t}\n+\n+\t\t@Override\n+\t\tprotected void handle(DigesterRule rule) throws SAXException {\n+\t\t\tString pattern = rule.getPattern();\n+\t\t\tStringTokenizer tokenizer = new StringTokenizer(pattern, \"/\");\n+\t\t\tString syntax1Name = null;\n+\t\t\twhile(tokenizer.hasMoreElements()) {\n+\t\t\t\tString token = tokenizer.nextToken();\n+\t\t\t\tif(!\"*\".equals(token)) {\n+\t\t\t\t\tsyntax1Name = token;\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\tif(StringUtils.isNotEmpty(rule.getRegisterMethod())) {\n+\t\t\t\tadd(rule.getRegisterMethod(), syntax1Name);\n+\t\t\t}\t\t\t\n+\t\t}\n+\n+\t\tprivate void add(String registerMethod, String syntax1Name) throws SAXException {\n+\t\t\tConfigChildSetterDescriptor item = new ConfigChildSetterDescriptor(registerMethod, syntax1Name);\n+\t\t\tif(configChildDescriptors.containsKey(item.getMethodName())) {\n+\t\t\t\tlog.warn(String.format(\"In digester rules [%s], duplicate method name [%s]\", path, registerMethod));\n+\t\t\t} else {\n+\t\t\t\tconfigChildDescriptors.put(item.getMethodName(), item);\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tpublic ElementType findOrCreateElementType(Class<?> clazz) {\n+\t\tif(allTypes.containsKey(clazz.getName())) {\n+\t\t\treturn allTypes.get(clazz.getName());\n+\t\t}\n+\t\tfinal ElementType result = new ElementType(clazz);\n+\t\t// If a containing FrankElement contains the type being created, we do not\n+\t\t// want recursion.\n+\t\tallTypes.put(result.getFullName(), result);\n+\t\tif(clazz.isInterface()) {", "originalCommit": "94c570724f745508e089434619ce1a80b2047c8f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY4MDUwMQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512680501", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-27T13:15:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0NjYyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0ODAyMQ==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512548021", "bodyText": "Ik zou hier voor de duidelijkheid allElements.put(clazz.getName(), current) zetten. Dat je dezelfde key gebruikt voor je put als dat je voor containsKey() hebt gebruikt", "author": "gvanbrakel", "createdAt": "2020-10-27T09:49:10Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -1,45 +1,143 @@\n package nl.nn.adapterframework.doc.model;\n \n+import java.io.IOException;\n import java.lang.reflect.Method;\n+import java.text.ParseException;\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.HashMap;\n import java.util.LinkedHashMap;\n import java.util.List;\n import java.util.Map;\n import java.util.Map.Entry;\n+import java.util.StringTokenizer;\n import java.util.stream.Collectors;\n \n+import org.apache.commons.lang3.StringUtils;\n import org.apache.logging.log4j.Logger;\n import org.springframework.core.annotation.AnnotationUtils;\n+import org.xml.sax.SAXException;\n \n import lombok.Getter;\n import lombok.Setter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.doc.IbisDoc;\n import nl.nn.adapterframework.doc.IbisDocRef;\n+import nl.nn.adapterframework.doc.Utils;\n import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n \n public class FrankDocModel {\n-\tprivate static final String JAVA_STRING = \"java.lang.String\";\n-\n \tprivate static Logger log = LogUtil.getLogger(FrankDocModel.class);\n-\n+\tprivate static final String DIGESTER_RULES = \"digester-rules.xml\";\n+\t\n+\tprivate @Getter Map<String, ConfigChildSetterDescriptor> configChildDescriptors;\n \tprivate @Getter List<FrankDocGroup> groups;\n \tprivate @Getter Map<String, FrankElement> allElements = new HashMap<>();\n+\tprivate @Getter Map<String, ElementType> allTypes = new HashMap<>();\n+\n+\t/**\n+\t * Get the FrankDocModel needed in production. This is just a first draft. The\n+\t * present version does not have groups yet. It will be improved in future\n+\t * pull requests. \n+\t */\n+\tpublic static FrankDocModel populate() {\n+\t\tFrankDocModel result = new FrankDocModel();\n+\t\tresult.createConfigChildDescriptorsFrom(DIGESTER_RULES);\n+\t\tresult.findOrCreateElementType(Utils.getClass(\"nl.nn.adapterframework.core.IAdapter\"));\n+\t\treturn result;\n+\t}\n \n \tpublic FrankDocModel() {\n+\t\tconfigChildDescriptors = new HashMap<>();\n \t\tgroups = new ArrayList<>();\n \t}\n \n+\tpublic void createConfigChildDescriptorsFrom(String path) {\n+\t\tResource resource = Resource.getResource(path);\n+\t\tif(resource == null) {\n+\t\t\tthrow new RuntimeException(String.format(\"Cannot find resource on the classpath: [%s]\", path));\n+\t\t}\n+\t\ttry {\n+\t\t\tXmlUtils.parseXml(resource.asInputSource(), new Handler(path));\n+\t\t}\n+\t\tcatch(IOException e) {\n+\t\t\tthrow new RuntimeException(String.format(\"An IOException occurred while parsing XML from [%s]\", path), e);\n+\t\t}\n+\t\tcatch(SAXException e) {\n+\t\t\tthrow new RuntimeException(String.format(\"A SAXException occurred while parsing XML from [%s]\", path), e);\n+\t\t}\n+\t}\n+\n+\tprivate class Handler extends DigesterRulesHandler {\n+\t\tprivate final String path;\n+\n+\t\tHandler(String path) {\n+\t\t\tthis.path = path;\n+\t\t}\n+\n+\t\t@Override\n+\t\tprotected void handle(DigesterRule rule) throws SAXException {\n+\t\t\tString pattern = rule.getPattern();\n+\t\t\tStringTokenizer tokenizer = new StringTokenizer(pattern, \"/\");\n+\t\t\tString syntax1Name = null;\n+\t\t\twhile(tokenizer.hasMoreElements()) {\n+\t\t\t\tString token = tokenizer.nextToken();\n+\t\t\t\tif(!\"*\".equals(token)) {\n+\t\t\t\t\tsyntax1Name = token;\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\tif(StringUtils.isNotEmpty(rule.getRegisterMethod())) {\n+\t\t\t\tadd(rule.getRegisterMethod(), syntax1Name);\n+\t\t\t}\t\t\t\n+\t\t}\n+\n+\t\tprivate void add(String registerMethod, String syntax1Name) throws SAXException {\n+\t\t\tConfigChildSetterDescriptor item = new ConfigChildSetterDescriptor(registerMethod, syntax1Name);\n+\t\t\tif(configChildDescriptors.containsKey(item.getMethodName())) {\n+\t\t\t\tlog.warn(String.format(\"In digester rules [%s], duplicate method name [%s]\", path, registerMethod));\n+\t\t\t} else {\n+\t\t\t\tconfigChildDescriptors.put(item.getMethodName(), item);\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tpublic ElementType findOrCreateElementType(Class<?> clazz) {\n+\t\tif(allTypes.containsKey(clazz.getName())) {\n+\t\t\treturn allTypes.get(clazz.getName());\n+\t\t}\n+\t\tfinal ElementType result = new ElementType(clazz);\n+\t\t// If a containing FrankElement contains the type being created, we do not\n+\t\t// want recursion.\n+\t\tallTypes.put(result.getFullName(), result);\n+\t\tif(clazz.isInterface()) {\n+\t\t\tUtils.getSpringBeans(clazz.getName()).stream()\n+\t\t\t\t\t.map(b -> b.getClazz())\n+\t\t\t\t\t.map(cl -> findOrCreateFrankElement(cl))\n+\t\t\t\t\t.forEach(result::addMember);\n+\t\t} else {\n+\t\t\tresult.addMember(findOrCreateFrankElement(clazz));\n+\t\t}\n+\t\treturn result;\n+\t}\n+\n+\tpublic boolean hasType(String typeName) {\n+\t\treturn allTypes.containsKey(typeName);\n+\t}\n+\n \tpublic FrankElement findOrCreateFrankElement(Class<?> clazz) {\n \t\tif(allElements.containsKey(clazz.getName())) {\n \t\t\treturn allElements.get(clazz.getName());\n \t\t}\n+\t\tFrankElement current = new FrankElement(clazz);\n+\t\tallElements.put(current.getFullName(), current);", "originalCommit": "94c570724f745508e089434619ce1a80b2047c8f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY3NDczOA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512674738", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-27T13:06:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0ODAyMQ=="}], "type": "inlineReview"}, {"oid": "b44657fc7871014ef7e258680d67cf89f35d1370", "url": "https://github.com/ibissource/iaf/commit/b44657fc7871014ef7e258680d67cf89f35d1370", "message": "Correct that unwanted attributes were created", "committedDate": "2020-10-27T12:58:39Z", "type": "commit"}, {"oid": "2b2740585a7a2c4f6e0961152380ea16a6d698b7", "url": "https://github.com/ibissource/iaf/commit/2b2740585a7a2c4f6e0961152380ea16a6d698b7", "message": "Small improvement", "committedDate": "2020-10-27T13:05:46Z", "type": "commit"}, {"oid": "7dbbe72132764cb99477f5c874b9bb641995ff55", "url": "https://github.com/ibissource/iaf/commit/7dbbe72132764cb99477f5c874b9bb641995ff55", "message": "Save whether a type comes from a Java interface", "committedDate": "2020-10-27T13:14:23Z", "type": "commit"}, {"oid": "11831a69543b4cbe6179ccff50533aea0c34c620", "url": "https://github.com/ibissource/iaf/commit/11831a69543b4cbe6179ccff50533aea0c34c620", "message": "Dont throw RuntimeException - most cases", "committedDate": "2020-10-27T13:31:56Z", "type": "commit"}, {"oid": "3f23bee10069b671337677eee339a5053503f698", "url": "https://github.com/ibissource/iaf/commit/3f23bee10069b671337677eee339a5053503f698", "message": "Eliminate throwing subclasses of RuntimeException", "committedDate": "2020-10-27T13:58:36Z", "type": "commit"}, {"oid": "cd74219137218b85e004da734ab757333b46ea2d", "url": "https://github.com/ibissource/iaf/commit/cd74219137218b85e004da734ab757333b46ea2d", "message": "Populate model from Configuration instead of IAdapter", "committedDate": "2020-10-27T14:45:59Z", "type": "commit"}, {"oid": "6761950fec4d6d43846999dbb38fea865effb48b", "url": "https://github.com/ibissource/iaf/commit/6761950fec4d6d43846999dbb38fea865effb48b", "message": "setSequenceNumberInConfigFromIbisDocAnnotation should not throw", "committedDate": "2020-10-27T15:24:13Z", "type": "commit"}, {"oid": "97028cc28e555914ecf05b4e5a88a96fdb24689c", "url": "https://github.com/ibissource/iaf/commit/97028cc28e555914ecf05b4e5a88a96fdb24689c", "message": "Save the results from the IbisDoc tests, to be reviewed", "committedDate": "2020-10-27T15:48:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg0MjI0Mw==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512842243", "bodyText": "Ik denk dat groups een Map<Class, List> moet zijn, waarbij de key de interface van het child element is, of 'null' voor de elementTypes die niet een interface representeren, maar een class. De group met class null wordt dan de group 'overig'", "author": "gvanbrakel", "createdAt": "2020-10-27T16:27:35Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -8,42 +9,145 @@\n import java.util.List;\n import java.util.Map;\n import java.util.Map.Entry;\n+import java.util.StringTokenizer;\n import java.util.stream.Collectors;\n \n+import org.apache.commons.lang3.StringUtils;\n import org.apache.logging.log4j.Logger;\n import org.springframework.core.annotation.AnnotationUtils;\n+import org.xml.sax.SAXException;\n \n import lombok.Getter;\n import lombok.Setter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.doc.IbisDoc;\n import nl.nn.adapterframework.doc.IbisDocRef;\n+import nl.nn.adapterframework.doc.Utils;\n+import nl.nn.adapterframework.doc.objects.SpringBean;\n import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n \n public class FrankDocModel {\n-\tprivate static final String JAVA_STRING = \"java.lang.String\";\n-\n \tprivate static Logger log = LogUtil.getLogger(FrankDocModel.class);\n-\n+\tprivate static final String DIGESTER_RULES = \"digester-rules.xml\";\n+\t\n+\tprivate @Getter Map<String, ConfigChildSetterDescriptor> configChildDescriptors;\n \tprivate @Getter List<FrankDocGroup> groups;", "originalCommit": "97028cc28e555914ecf05b4e5a88a96fdb24689c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg5NTYwNg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512895606", "bodyText": "Gedaan.", "author": "mhdirkse", "createdAt": "2020-10-27T17:38:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg0MjI0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg5NjQzNg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r512896436", "bodyText": "Maar ik heb niet Class als key gebruikt. Die mogen we niet in het model stoppen omdat het dan niet meer voor compile-time Frank!Doc gebruikt kan worden.", "author": "mhdirkse", "createdAt": "2020-10-27T17:39:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg0MjI0Mw=="}], "type": "inlineReview"}, {"oid": "e659d52fa7574a6f04a725fd35c9b2b93958b234", "url": "https://github.com/ibissource/iaf/commit/e659d52fa7574a6f04a725fd35c9b2b93958b234", "message": "Change type of groups in the model.", "committedDate": "2020-10-27T17:35:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzMxNDQ3OA==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r513314478", "bodyText": "Handige tip, de HashSet kan ook als volgt geschreven worden:\nnew HashSet<>(Arrays.asList(JAVA_STRING, JAVA_INTEGER, JAVA_BOOLEAN, JAVA_LONG, JAVA_BYTE, JAVA_SHORT));", "author": "nielsm5", "createdAt": "2020-10-28T09:57:28Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/InfoBuilderSource.java", "diffHunk": "@@ -51,6 +52,16 @@\n import nl.nn.adapterframework.util.XmlUtils;\n \n class InfoBuilderSource {\n+\tprivate static final String JAVA_STRING = \"java.lang.String\";\n+\tprivate static final String JAVA_INTEGER = \"java.lang.Integer\";\n+\tprivate static final String JAVA_BOOLEAN = \"java.lang.Boolean\";\n+\tprivate static final String JAVA_LONG = \"java.lang.Long\";\n+\tprivate static final String JAVA_BYTE = \"java.lang.Byte\";\n+\tprivate static final String JAVA_SHORT = \"java.lang.Short\";\n+\n+\tprivate static final Set<String> JAVA_BOXED = new HashSet<String>(Arrays.asList(new String[] {\n+\t\t\tJAVA_STRING, JAVA_INTEGER, JAVA_BOOLEAN, JAVA_LONG, JAVA_BYTE, JAVA_SHORT}));", "originalCommit": "e659d52fa7574a6f04a725fd35c9b2b93958b234", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzMyMjE2Mg==", "url": "https://github.com/ibissource/iaf/pull/1178#discussion_r513322162", "bodyText": "Een kleine kanttekening betreft excepties, soms zie ik je message: %s en soms zie ik je message [%s] gebruiken. Hier staat nu een combinatie van de twee message: [%s]. Binnen de framework meldingen gebruiken wij [%s] omdat je dan een 'postfix' hebt waar de melding ophoudt.", "author": "nielsm5", "createdAt": "2020-10-28T10:09:21Z", "path": "core/src/main/java/nl/nn/adapterframework/doc/model/FrankDocModel.java", "diffHunk": "@@ -8,42 +9,145 @@\n import java.util.List;\n import java.util.Map;\n import java.util.Map.Entry;\n+import java.util.StringTokenizer;\n import java.util.stream.Collectors;\n \n+import org.apache.commons.lang3.StringUtils;\n import org.apache.logging.log4j.Logger;\n import org.springframework.core.annotation.AnnotationUtils;\n+import org.xml.sax.SAXException;\n \n import lombok.Getter;\n import lombok.Setter;\n+import nl.nn.adapterframework.configuration.digester.DigesterRule;\n+import nl.nn.adapterframework.configuration.digester.DigesterRulesHandler;\n+import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.doc.IbisDoc;\n import nl.nn.adapterframework.doc.IbisDocRef;\n+import nl.nn.adapterframework.doc.Utils;\n+import nl.nn.adapterframework.doc.objects.SpringBean;\n import nl.nn.adapterframework.util.LogUtil;\n+import nl.nn.adapterframework.util.XmlUtils;\n \n public class FrankDocModel {\n-\tprivate static final String JAVA_STRING = \"java.lang.String\";\n-\n \tprivate static Logger log = LogUtil.getLogger(FrankDocModel.class);\n-\n-\tprivate @Getter List<FrankDocGroup> groups;\n+\tprivate static final String DIGESTER_RULES = \"digester-rules.xml\";\n+\t\n+\tprivate @Getter Map<String, ConfigChildSetterDescriptor> configChildDescriptors;\n+\tprivate @Getter Map<String, FrankDocGroup> groups;\n \tprivate @Getter Map<String, FrankElement> allElements = new HashMap<>();\n+\tprivate @Getter Map<String, ElementType> allTypes = new HashMap<>();\n+\n+\t/**\n+\t * Get the FrankDocModel needed in production. This is just a first draft. The\n+\t * present version does not have groups yet. It will be improved in future\n+\t * pull requests. \n+\t */\n+\tpublic static FrankDocModel populate() {\n+\t\tFrankDocModel result = new FrankDocModel();\n+\t\ttry {\n+\t\t\tresult.createConfigChildDescriptorsFrom(DIGESTER_RULES);\n+\t\t\tresult.findOrCreateElementType(Utils.getClass(\"nl.nn.adapterframework.configuration.Configuration\"));\n+\t\t} catch(Exception e) {\n+\t\t\tlog.fatal(\"Could not populate FrankDocModel\", e);\n+\t\t\treturn null;\n+\t\t}\n+\t\treturn result;\n+\t}\n \n \tpublic FrankDocModel() {\n-\t\tgroups = new ArrayList<>();\n+\t\tconfigChildDescriptors = new HashMap<>();\n+\t\tgroups = new HashMap<>();\n+\t}\n+\n+\tpublic void createConfigChildDescriptorsFrom(String path) throws IOException, SAXException {\n+\t\tResource resource = Resource.getResource(path);\n+\t\tif(resource == null) {\n+\t\t\tthrow new IOException(String.format(\"Cannot find resource on the classpath: [%s]\", path));", "originalCommit": "e659d52fa7574a6f04a725fd35c9b2b93958b234", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}