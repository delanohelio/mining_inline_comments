{"pr_number": 1108, "pr_title": "Fix #1103 Modern authentication for ExchangeFileSystem", "pr_createdAt": "2020-09-30T12:22:51Z", "pr_url": "https://github.com/ibissource/iaf/pull/1108", "timeline": [{"oid": "4ad644ecd21735475913310f85d1cc7446df9db3", "url": "https://github.com/ibissource/iaf/commit/4ad644ecd21735475913310f85d1cc7446df9db3", "message": "Fix #1103 Modern authentication for ExchangeFileSystem", "committedDate": "2020-09-30T12:22:24Z", "type": "commit"}, {"oid": "db6dfd41dc8efa2f07af0a24a880f593baa6b5d1", "url": "https://github.com/ibissource/iaf/commit/db6dfd41dc8efa2f07af0a24a880f593baa6b5d1", "message": "Fix issues", "committedDate": "2020-09-30T12:26:48Z", "type": "commit"}, {"oid": "3a5d578162d16a6ed13ca1a547a3645865af4729", "url": "https://github.com/ibissource/iaf/commit/3a5d578162d16a6ed13ca1a547a3645865af4729", "message": "More issues", "committedDate": "2020-09-30T12:31:50Z", "type": "commit"}, {"oid": "9258458018cdd930f60587fc57775c3bb3710056", "url": "https://github.com/ibissource/iaf/commit/9258458018cdd930f60587fc57775c3bb3710056", "message": "changed ExchangeMail.properties", "committedDate": "2020-09-30T13:01:40Z", "type": "commit"}, {"oid": "0fe45815897982d5da15ea1d13c6ab173574f13c", "url": "https://github.com/ibissource/iaf/commit/0fe45815897982d5da15ea1d13c6ab173574f13c", "message": "ignore changes in Exchange properties", "committedDate": "2020-09-30T13:02:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ5NzQ5NA==", "url": "https://github.com/ibissource/iaf/pull/1108#discussion_r497497494", "bodyText": "Ik moet zeggen dat ik het niet de mooiste oplossing vind maar zie dat er weinig alternatieven zijn", "author": "nielsm5", "createdAt": "2020-09-30T13:12:20Z", "path": "core/src/main/java/nl/nn/adapterframework/filesystem/ExchangeFileSystem.java", "diffHunk": "@@ -127,15 +132,12 @@ public void configure() throws ConfigurationException {\n \t\t}\n \t}\n \t\n-\t\n \t@Override\n \tpublic void open() throws FileSystemException {\n \t\ttry {\n \t\t\texchangeService = new ExchangeService(ExchangeVersion.Exchange2010_SP2);\n-\t\t\tString usernameToUse=StringUtils.isNotEmpty(getUsername())?getUsername():getMailAddress();\n-\t\t\tCredentialFactory cf = new CredentialFactory(getAuthAlias(), usernameToUse, getPassword());\n-\t\t\tExchangeCredentials credentials = new WebCredentials(cf.getUsername(), cf.getPassword());\n-\t\t\texchangeService.setCredentials(credentials);\n+\t\t\tCredentialFactory cf = new CredentialFactory(getAuthAlias(), null, getAccessToken());\n+\t\t\texchangeService.getHttpHeaders().put(\"Authorization\", \"Bearer \"+cf.getPassword());", "originalCommit": "0fe45815897982d5da15ea1d13c6ab173574f13c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}