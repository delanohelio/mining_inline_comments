{"pr_number": 962, "pr_title": "Add ability to log out of the GUI 3.0", "pr_createdAt": "2020-07-21T15:00:20Z", "pr_url": "https://github.com/ibissource/iaf/pull/962", "timeline": [{"oid": "11eb6139581b28fe13fe7182b133f1dfef61021b", "url": "https://github.com/ibissource/iaf/commit/11eb6139581b28fe13fe7182b133f1dfef61021b", "message": "Add ability to log out of the GUI 3.0", "committedDate": "2020-07-21T14:59:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODU1MjczOA==", "url": "https://github.com/ibissource/iaf/pull/962#discussion_r458552738", "bodyText": "Ik denk dat 204 No Content hier meer op z'n plaats is.", "author": "gvanbrakel", "createdAt": "2020-07-22T05:59:32Z", "path": "core/src/main/java/nl/nn/adapterframework/webcontrol/api/Authentication.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+Copyright 2020 WeAreFrank!\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+*/\n+package nl.nn.adapterframework.webcontrol.api;\n+\n+import javax.annotation.security.PermitAll;\n+import javax.servlet.ServletException;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import javax.ws.rs.GET;\n+import javax.ws.rs.Path;\n+import javax.ws.rs.Produces;\n+import javax.ws.rs.core.Context;\n+import javax.ws.rs.core.MediaType;\n+import javax.ws.rs.core.Response;\n+import javax.ws.rs.core.Response.Status;\n+\n+import org.apache.logging.log4j.Logger;\n+\n+import nl.nn.adapterframework.util.LogUtil;\n+\n+@Path(\"/\")\n+public class Authentication {\n+\t@Context HttpServletRequest httpServletRequest;\n+\t@Context HttpServletResponse httpServletResponse;\n+\n+\tprotected Logger log = LogUtil.getLogger(this);\n+\n+\t@GET\n+\t@PermitAll\n+\t@Path(\"/logout\")\n+\t@Produces(MediaType.APPLICATION_JSON)\n+\tpublic Response logout() {\n+\n+\t\tif(httpServletRequest.getUserPrincipal() != null) {\n+\t\t\tString user = httpServletRequest.getUserPrincipal().getName();\n+\t\t\ttry {\n+\t\t\t\thttpServletRequest.logout();\n+\t\t\t\tlog.debug(\"successfully logged out user [\"+user+\"]\");\n+\t\t\t} catch (ServletException e) {\n+\t\t\t\tthrow new ApiException(e);\n+\t\t\t}\n+\t\t} else {\n+\t\t\tlog.debug(\"unable to log out user, not logged in\");\n+\t\t}\n+\n+\t\thttpServletResponse.setHeader(\"Refresh\", \"5\");\n+\t\treturn Response.status(Status.UNAUTHORIZED).build();", "originalCommit": "11eb6139581b28fe13fe7182b133f1dfef61021b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}