{"pr_number": 772, "pr_title": "Make encoding of QueryParameters optional", "pr_createdAt": "2020-05-29T10:08:56Z", "pr_url": "https://github.com/ibissource/iaf/pull/772", "timeline": [{"oid": "af8a3b32e85f3d009e1f9b78bccea95140324bab", "url": "https://github.com/ibissource/iaf/commit/af8a3b32e85f3d009e1f9b78bccea95140324bab", "message": "Make encoding of QueryParameters optional", "committedDate": "2020-05-29T10:08:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQyNzUyOQ==", "url": "https://github.com/ibissource/iaf/pull/772#discussion_r432427529", "bodyText": "Ik denk dat dit de verkeerde plek is om parameters te URLEncoden. Volgens mij moet je het hier niet doen, en wel in HttpSender.getMethod(). Dan hoef je er ook geen switch voor te maken.", "author": "gvanbrakel", "createdAt": "2020-05-29T11:40:03Z", "path": "core/src/main/java/nl/nn/adapterframework/http/HttpSenderBase.java", "diffHunk": "@@ -259,18 +271,20 @@ protected URI getURI(String url) throws URISyntaxException, UnsupportedEncodingE\n \t\t\turi.setPath(\"/\");\n \t\t}\n \n-\t\t// Encode query param values.\n-\t\tArrayList<NameValuePair> pairs = new ArrayList<>(uri.getQueryParams().size());\n-\t\tfor(NameValuePair pair : uri.getQueryParams()) {\n-\t\t\tString paramValue = pair.getValue(); //May be NULL\n-\t\t\tif(StringUtils.isNotEmpty(paramValue)) {\n-\t\t\t\tparamValue = URLEncoder.encode(paramValue, getCharSet()); //Only encode if the value is not null\n+\t\tif(encodeQueryParameters) {\n+\t\t\t// Encode query param values.\n+\t\t\tArrayList<NameValuePair> pairs = new ArrayList<>(uri.getQueryParams().size());\n+\t\t\tfor(NameValuePair pair : uri.getQueryParams()) {\n+\t\t\t\tString paramValue = pair.getValue(); //May be NULL\n+\t\t\t\tif(StringUtils.isNotEmpty(paramValue)) {\n+\t\t\t\t\tparamValue = URLEncoder.encode(paramValue, getCharSet()); //Only encode if the value is not null\n+\t\t\t\t}\n+\t\t\t\tpairs.add(new BasicNameValuePair(pair.getName(), paramValue));\n+\t\t\t}\n+\t\t\tif(pairs.size() > 0) {\n+\t\t\t\turi.clearParameters();\n+\t\t\t\turi.addParameters(pairs);", "originalCommit": "af8a3b32e85f3d009e1f9b78bccea95140324bab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "55fbb1707ec851eac8c1fb9e03a6751d3f96d2cc", "url": "https://github.com/ibissource/iaf/commit/55fbb1707ec851eac8c1fb9e03a6751d3f96d2cc", "message": "Move encode block around", "committedDate": "2020-05-29T12:58:56Z", "type": "commit"}, {"oid": "a00b6bd4fa8a808b782365b0d56f9138718e23ff", "url": "https://github.com/ibissource/iaf/commit/a00b6bd4fa8a808b782365b0d56f9138718e23ff", "message": "remove final modifier", "committedDate": "2020-05-29T13:04:30Z", "type": "commit"}]}