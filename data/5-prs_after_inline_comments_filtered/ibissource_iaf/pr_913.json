{"pr_number": 913, "pr_title": "Allow AppConstants properties in Ant scripts", "pr_createdAt": "2020-07-07T11:02:54Z", "pr_url": "https://github.com/ibissource/iaf/pull/913", "timeline": [{"oid": "c42d7de56d66adfab1efbf9733879b45a74912c7", "url": "https://github.com/ibissource/iaf/commit/c42d7de56d66adfab1efbf9733879b45a74912c7", "message": "Allow AppConstants properties in Ant scripts, prefixed with ac.", "committedDate": "2020-07-07T11:00:35Z", "type": "commit"}, {"oid": "f99d16d198bfdcf0e04f1a641d349de0c36686e2", "url": "https://github.com/ibissource/iaf/commit/f99d16d198bfdcf0e04f1a641d349de0c36686e2", "message": "Larva, properties in Ant scripts; no prefix ac.", "committedDate": "2020-07-07T12:22:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg0NzM0OQ==", "url": "https://github.com/ibissource/iaf/pull/913#discussion_r450847349", "bodyText": "Je voegt nu deze AppConstants-properties toe aan de FileSender. Ligt het niet meer voor de hand om ze op een hoger niveau toe te voegen, zodat je de AppConstants ook op andere plekken in Larva kunt gebruiken?", "author": "gvanbrakel", "createdAt": "2020-07-07T13:04:13Z", "path": "larva/src/main/java/nl/nn/adapterframework/testtool/FileSender.java", "diffHunk": "@@ -97,6 +99,16 @@ private void runAntScript() {\n \t\tconsoleLogger.setOutputPrintStream(System.out);\n \t\tconsoleLogger.setMessageOutputLevel(Project.MSG_INFO);\n \t\tant.addBuildListener(consoleLogger);\n+\t\t\n+\t\t// iterate over appConstants and add them as properties\n+\t\tAppConstants appConstants = AppConstants.getInstance();\n+\t\t@SuppressWarnings(\"unchecked\")\n+\t\tEnumeration<String> enums = (Enumeration<String>) appConstants.propertyNames();\n+\t\twhile (enums.hasMoreElements()) {\n+\t\t\tString key = enums.nextElement();\n+\t\t\tant.setProperty(key, appConstants.getResolvedProperty(key));\n+\t\t}\n+", "originalCommit": "f99d16d198bfdcf0e04f1a641d349de0c36686e2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM2NjQ0OA==", "url": "https://github.com/ibissource/iaf/pull/913#discussion_r451366448", "bodyText": "Without this pull request, Larva allows you already to use AppConstants properties in scenario files, include files and input files. Niels has decided that properties should not be supported in output files; I have forgotten the reason. Only the option to use AppConstants properties in Ant scripts is missing. Adding this is the purpose of this pull request.", "author": "mhdirkse", "createdAt": "2020-07-08T08:18:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg0NzM0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjcyNzc5MA==", "url": "https://github.com/ibissource/iaf/pull/913#discussion_r452727790", "bodyText": "See this PR which enabled resolving properties in input files #730\nThe reason Niels decided not to resolve properties in output files is that it will break the save result feature, since it will save the resolved property instead of the unresolved one.\nAnother reason that in output files it shouldn't be necessary, you can accomplish the same result with applying ignores to your scenario.", "author": "Laurens-makel", "createdAt": "2020-07-10T09:20:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg0NzM0OQ=="}], "type": "inlineReview"}]}