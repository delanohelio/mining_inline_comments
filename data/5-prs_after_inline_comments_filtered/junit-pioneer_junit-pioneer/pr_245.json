{"pr_number": 245, "pr_title": "Create assertions for Pioneer (#232)", "pr_createdAt": "2020-04-28T15:59:06Z", "pr_url": "https://github.com/junit-pioneer/junit-pioneer/pull/245", "timeline": [{"oid": "1f3293e22746b1c2a8bd9b192d8b306463070f80", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/1f3293e22746b1c2a8bd9b192d8b306463070f80", "message": "Created PioneerAssert in a container class (fluent API is hard). Rewrote tests using the new assertions.", "committedDate": "2020-04-28T15:56:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5MzYwMA==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r416793600", "bodyText": "i am not sure if the and is really needed, and it is not really common in assertJ. i think hasException should be fine, or maybe withException.\nnot 100% sure but i think we should align this with https://joel-costigliola.github.io/assertj/assertj-core-features-highlight.html#exception-assertion . so it is really concise and easy to understand, when you know assertj already", "author": "aepfli", "createdAt": "2020-04-28T17:27:43Z", "path": "src/test/java/org/junitpioneer/testkit/PioneerAssertContainer.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * http://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junitpioneer.testkit;\n+\n+import java.util.AbstractMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import org.assertj.core.api.AbstractAssert;\n+import org.assertj.core.api.Assertions;\n+import org.junit.platform.engine.TestExecutionResult;\n+\n+public class PioneerAssertContainer {\n+\n+\tpublic static class PioneerAssert extends AbstractAssert<PioneerAssert, ExecutionResults>\n+\t\t\timplements SingleReportEntryAssert, FailureAssert, ExceptionAssert {\n+\n+\t\tpublic PioneerAssert(ExecutionResults actual) {\n+\t\t\tsuper(actual, PioneerAssert.class);\n+\t\t}\n+\n+\t\tpublic static PioneerAssert assertThat(ExecutionResults actual) {\n+\t\t\treturn new PioneerAssert(actual);\n+\t\t}\n+\n+\t\tpublic SingleReportEntryAssert hasSingleReportEntry() {\n+\t\t\tisNotNull();\n+\n+\t\t\tList<Map<String, String>> reportEntries = actual.reportEntries();\n+\t\t\tAssertions.assertThat(reportEntries).hasSize(1);\n+\t\t\tMap<String, String> reportEntry = reportEntries.get(0);\n+\t\t\tAssertions.assertThat(reportEntry).hasSize(1);\n+\n+\t\t\treturn this;\n+\t\t}\n+\n+\t\tpublic FailureAssert hasSingleFailedTest() {\n+\t\t\tisNotNull();\n+\t\t\tAssertions.assertThat(actual.numberOfFailedTests()).isEqualTo(1);\n+\n+\t\t\treturn this;\n+\t\t}\n+\n+\t\tpublic FailureAssert hasSingleFailedContainer() {\n+\t\t\tisNotNull();\n+\t\t\tAssertions.assertThat(actual.numberOfFailedContainers()).isEqualTo(1);\n+\n+\t\t\treturn this;\n+\t\t}\n+\n+\t\t@Override\n+\t\tpublic void withKeyAndValue(String key, String value) {\n+\t\t\tAssertions\n+\t\t\t\t\t.assertThat(actual.reportEntries().get(0).entrySet().iterator().next())\n+\t\t\t\t\t.isEqualTo(new AbstractMap.SimpleEntry<>(key, value));\n+\t\t}\n+\n+\t\t/**\n+\t\t * This method should only be called from methods belonging to {@code FailureAssert}.\n+\t\t */\n+\t\tprivate Optional<Throwable> firstFailureThrowable() {\n+\t\t\treturn actual\n+\t\t\t\t\t.allEvents()\n+\t\t\t\t\t.failed()\n+\t\t\t\t\t.stream()\n+\t\t\t\t\t.findFirst()\n+\t\t\t\t\t.flatMap(first -> first.getPayload(TestExecutionResult.class))\n+\t\t\t\t\t.flatMap(TestExecutionResult::getThrowable);\n+\n+\t\t}\n+\n+\t\t@Override\n+\t\tpublic ExceptionAssert andHasException(Class<? extends Throwable> exceptionType) {", "originalCommit": "1f3293e22746b1c2a8bd9b192d8b306463070f80", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzE1NDIyMw==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r417154223", "bodyText": "My reasoning behind andHasException is that you can only get there if you already called a method that returns with the FailureAssert interface.\nSo it always looks like this:\nassertThat(results).hasXY(...).andHasException();\n\nIn a purely grammatical context the and makes sense(?).", "author": "Michael1993", "createdAt": "2020-04-29T08:38:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5MzYwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzIzNTY3Ng==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r417235676", "bodyText": "To put an example to the discussion:\nassertThat(results).hasSingleFailedTest().andHasException().withMessageContaining(\"ne...\")\nMy first thought about naming was: We always compare results which is plural, so I asked myself if the methods should align with plural too. But I don't think so, because the default AssertJ lib claims only a single result, independent if its a single value or a list or whatever. So we should go for singular method names too.\nWhat I really like at @Michael1993 names is that he always has something in mind when choosing the names. Was the same at the publish condition of the @ReportEntry extension. And I can totally understand his thoughts here to. On the other hand I can see @aepfli point to align with the default AssertJ which uses withException\" and I could imagine that this helps others people to use the API. While I see the use of andfrom grammatical context, I don't think we need it as there is always the.` of the fluent API which says exactly this.", "author": "Bukama", "createdAt": "2020-04-29T11:09:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5MzYwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1MTk2MA==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r416851960", "bodyText": "i might suggest to have one basic method like hasNumberOfFailedTests(int number) and than just use that within this method. as i think this assert might be usable for other cases in the future too.", "author": "aepfli", "createdAt": "2020-04-28T19:01:42Z", "path": "src/test/java/org/junitpioneer/testkit/PioneerAssertContainer.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * http://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junitpioneer.testkit;\n+\n+import java.util.AbstractMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import org.assertj.core.api.AbstractAssert;\n+import org.assertj.core.api.Assertions;\n+import org.junit.platform.engine.TestExecutionResult;\n+\n+public class PioneerAssertContainer {\n+\n+\tpublic static class PioneerAssert extends AbstractAssert<PioneerAssert, ExecutionResults>\n+\t\t\timplements SingleReportEntryAssert, FailureAssert, ExceptionAssert {\n+\n+\t\tpublic PioneerAssert(ExecutionResults actual) {\n+\t\t\tsuper(actual, PioneerAssert.class);\n+\t\t}\n+\n+\t\tpublic static PioneerAssert assertThat(ExecutionResults actual) {\n+\t\t\treturn new PioneerAssert(actual);\n+\t\t}\n+\n+\t\tpublic SingleReportEntryAssert hasSingleReportEntry() {\n+\t\t\tisNotNull();\n+\n+\t\t\tList<Map<String, String>> reportEntries = actual.reportEntries();\n+\t\t\tAssertions.assertThat(reportEntries).hasSize(1);\n+\t\t\tMap<String, String> reportEntry = reportEntries.get(0);\n+\t\t\tAssertions.assertThat(reportEntry).hasSize(1);\n+\n+\t\t\treturn this;\n+\t\t}\n+\n+\t\tpublic FailureAssert hasSingleFailedTest() {", "originalCommit": "1f3293e22746b1c2a8bd9b192d8b306463070f80", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzIzMDQ5NQ==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r417230495", "bodyText": "I would like to keep the single methods and offer additional methods where you can pass the number, because we have plenty of tests where we expect exactly one. So why force the writer to pass magic numbers and make it less readable in those cases? Don't get me wrong. We need the basic methods for dynamic parameters, but this PR shows that the single ones makes sense too.", "author": "Bukama", "createdAt": "2020-04-29T10:59:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1MTk2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzI0MjI4MA==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r417242280", "bodyText": "i never said to skip that method, i said we should extract its functionality into an generic one, which we use within this method", "author": "aepfli", "createdAt": "2020-04-29T11:23:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1MTk2MA=="}], "type": "inlineReview"}, {"oid": "b20525c1de8db600faa017e9697c70e1818b9904", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/b20525c1de8db600faa017e9697c70e1818b9904", "message": "WIP commit. Moved assertion class to separate package.", "committedDate": "2020-04-29T13:36:56Z", "type": "commit"}, {"oid": "acb0f85ca9440a95243a02a29aece9702fb70c48", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/acb0f85ca9440a95243a02a29aece9702fb70c48", "message": "Merge branch 'master' of https://github.com/junit-pioneer/junit-pioneer into issue/232-pioneer-assert\n\n\u0001 Conflicts:\n\u0001\tsrc/test/java/org/junitpioneer/jupiter/ReportEntryExtensionTest.java", "committedDate": "2020-04-29T19:32:08Z", "type": "commit"}, {"oid": "0dd7f2f17282cb88660c97110d7be42e28686478", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/0dd7f2f17282cb88660c97110d7be42e28686478", "message": "Implementation of an experimental approach to asserting Pioneer assertions.", "committedDate": "2020-04-30T12:08:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI4ODUwMg==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r418288502", "bodyText": "could we actually use https://github.com/joel-costigliola/assertj-core/blob/master/src/main/java/org/assertj/core/api/AbstractThrowableAssert.java instead of that assert - it does have already a lot of functionality and we would stick to the default", "author": "aepfli", "createdAt": "2020-04-30T21:05:00Z", "path": "src/test/java/org/junitpioneer/testkit/assertion/ExceptionAssert.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * http://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junitpioneer.testkit.assertion;\n+\n+/**\n+ * Used to assert exceptions thrown by failed tests/containers.\n+ */\n+public interface ExceptionAssert {", "originalCommit": "0dd7f2f17282cb88660c97110d7be42e28686478", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwMDUzMQ==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r418300531", "bodyText": "We could use it but it would look kind of broken:\nassertThat(results)\n    .hasSingleTest()\n    .thatFailed()\n    .withException()\n    .hasMessageContainingAll(/* ... */);\n\nThen again, this interface does not really do anything besides adding the word that in front of the methods in AbstractThrowableAssert", "author": "Michael1993", "createdAt": "2020-04-30T21:30:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI4ODUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODMwMzI1Mw==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r418303253", "bodyText": "but it would also provide additional methods, like message containing with varargs, etc.", "author": "aepfli", "createdAt": "2020-04-30T21:36:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI4ODUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY2MTkwNg==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/245#discussion_r418661906", "bodyText": "No need to reinvent the wheel, you are right.", "author": "Michael1993", "createdAt": "2020-05-01T18:01:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI4ODUwMg=="}], "type": "inlineReview"}, {"oid": "6e946fc5aebb8d0ed576a65833ada8490adee781", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/6e946fc5aebb8d0ed576a65833ada8490adee781", "message": "Changed ExceptionAssert into AbstractThrowableAssert", "committedDate": "2020-05-01T12:59:46Z", "type": "commit"}, {"oid": "6640c728dee37893ddadac8d469feaa634dae717", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/6640c728dee37893ddadac8d469feaa634dae717", "message": "WIP commit", "committedDate": "2020-05-06T16:35:56Z", "type": "commit"}, {"oid": "f726aff4dba1fecabf418524737bfdb8ac46c44a", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/f726aff4dba1fecabf418524737bfdb8ac46c44a", "message": "Added some more paths to the assertions for better readability.", "committedDate": "2020-05-06T18:02:27Z", "type": "commit"}, {"oid": "d942f9dc7ba5c25239a2dc385da186c01c3e74ea", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/d942f9dc7ba5c25239a2dc385da186c01c3e74ea", "message": "WIP - documentation.", "committedDate": "2020-05-10T13:47:20Z", "type": "commit"}, {"oid": "5a401c4c7d5d0192ef250536ac6d8a00eb310da5", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/5a401c4c7d5d0192ef250536ac6d8a00eb310da5", "message": "Added EntryPoint for both generic and Pioneer specific assertions.", "committedDate": "2020-05-26T16:59:06Z", "type": "commit"}, {"oid": "03aa9144738ce60800c60a82faef32910ae75465", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/03aa9144738ce60800c60a82faef32910ae75465", "message": "Added static import for `assertThat` in PioneerAssert", "committedDate": "2020-05-26T17:55:25Z", "type": "commit"}, {"oid": "ee304345f36ef4915a273d2d5edf2023fedcdf2a", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/ee304345f36ef4915a273d2d5edf2023fedcdf2a", "message": "Spotless. Again.\nI dedicate this commit to Set, the ancient Egyptian god of rage.", "committedDate": "2020-05-26T20:00:57Z", "type": "commit"}, {"oid": "9558c2608bcdcae77ca3435140f5f67b2c9194be", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/9558c2608bcdcae77ca3435140f5f67b2c9194be", "message": "This commit is basically a guess.", "committedDate": "2020-05-27T10:24:51Z", "type": "commit"}, {"oid": "95f94e9cc57659dbccecf7caba0f4496eca30ae9", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/95f94e9cc57659dbccecf7caba0f4496eca30ae9", "message": "Reverting previous commit.", "committedDate": "2020-05-27T10:27:15Z", "type": "commit"}, {"oid": "0b1ffb9a6853d15b5e054a82951f753867b088d0", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/0b1ffb9a6853d15b5e054a82951f753867b088d0", "message": "Rollback breaking changes.", "committedDate": "2020-05-27T10:28:07Z", "type": "commit"}, {"oid": "f1f557b66b7eb0e5efe84ee0dbef4948f63bdabf", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/f1f557b66b7eb0e5efe84ee0dbef4948f63bdabf", "message": "Merge branch 'master' into issue/232-pioneer-assert\n\n# Conflicts:\n#\tsrc/test/java/org/junitpioneer/jupiter/RepeatFailedTestTests.java", "committedDate": "2020-06-25T11:51:36Z", "type": "commit"}, {"oid": "6c201c2fec58dfe4d186946e2553547b925c29cc", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/6c201c2fec58dfe4d186946e2553547b925c29cc", "message": "WIP\n\nSigned-off-by: Mihaly Verhas <misi.verhas@gmail.com>", "committedDate": "2020-06-25T12:33:11Z", "type": "commit"}, {"oid": "3bd4d56eb61243efc9d8f9a3560ec9b8ad939fc0", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/3bd4d56eb61243efc9d8f9a3560ec9b8ad939fc0", "message": "Refactored Pioneer assertions to be simpler, easier to use.\n\nSigned-off-by: Mihaly Verhas <misi.verhas@gmail.com>", "committedDate": "2020-06-25T14:50:57Z", "type": "commit"}, {"oid": "34ddce734142a21c21134053bbb7cc624318afe7", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/34ddce734142a21c21134053bbb7cc624318afe7", "message": "Documentation update.\n\nSigned-off-by: Mihaly Verhas <misi.verhas@gmail.com>", "committedDate": "2020-06-25T15:25:42Z", "type": "commit"}, {"oid": "64b68644649745fa2cbec8a30f3ab76874ec25ac", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/64b68644649745fa2cbec8a30f3ab76874ec25ac", "message": "Merge branch 'master' into issue/232-pioneer-assert", "committedDate": "2020-07-03T17:48:50Z", "type": "commit"}, {"oid": "0903920b85fd95d82639fa0323f5070cf92cb41f", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/0903920b85fd95d82639fa0323f5070cf92cb41f", "message": "Small changes", "committedDate": "2020-07-14T17:55:34Z", "type": "commit"}, {"oid": "6bc61b58eb74a7d8c10a3301eaefb5d38da360f6", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/6bc61b58eb74a7d8c10a3301eaefb5d38da360f6", "message": "Merge branch 'master' of https://github.com/junit-pioneer/junit-pioneer into issue/232-pioneer-assert", "committedDate": "2020-07-14T19:16:51Z", "type": "commit"}, {"oid": "87c93b09df990f63ed75ddec39f12af947bd8f48", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/87c93b09df990f63ed75ddec39f12af947bd8f48", "message": "Merge fix.", "committedDate": "2020-07-14T19:19:05Z", "type": "commit"}]}