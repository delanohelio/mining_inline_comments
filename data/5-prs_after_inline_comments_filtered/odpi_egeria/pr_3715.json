{"pr_number": 3715, "pr_title": "Adds registration constructor to Integraton and Solution View Service\u2026", "pr_createdAt": "2020-09-30T11:30:43Z", "pr_url": "https://github.com/odpi/egeria/pull/3715", "timeline": [{"oid": "f4821a83b038dd98d04233a8b29589b94c0e7411", "url": "https://github.com/odpi/egeria/commit/f4821a83b038dd98d04233a8b29589b94c0e7411", "message": "Adds registration constructor to Integraton and Solution View Service Config classes and modifies createViewServiceConfig to create subclasses\n\nSigned-off-by: Graham Wallis <graham_wallis@uk.ibm.com>", "committedDate": "2020-09-30T11:28:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NDkxMA==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497464910", "bodyText": "registration not description", "author": "davidradl", "createdAt": "2020-09-30T12:22:02Z", "path": "open-metadata-implementation/admin-services/admin-services-api/src/main/java/org/odpi/openmetadata/adminservices/configuration/properties/IntegrationViewServiceConfig.java", "diffHunk": "@@ -49,6 +50,17 @@ public IntegrationViewServiceConfig(IntegrationViewServiceConfig template)\n         }\n     }\n \n+    /**\n+     * Call the superclass to set up the default values for a view service using a view service description.", "originalCommit": "f4821a83b038dd98d04233a8b29589b94c0e7411", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3MjA0NA==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497472044", "bodyText": "I used the same comment (almost) as in the ViewServiceConfig. Happy to change it if important but I thought it made sense anyway", "author": "grahamwallis", "createdAt": "2020-09-30T12:34:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NDkxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NTE2MA==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497465160", "bodyText": "registration", "author": "davidradl", "createdAt": "2020-09-30T12:22:31Z", "path": "open-metadata-implementation/admin-services/admin-services-api/src/main/java/org/odpi/openmetadata/adminservices/configuration/properties/SolutionViewServiceConfig.java", "diffHunk": "@@ -29,6 +31,17 @@ public SolutionViewServiceConfig(SolutionViewServiceConfig template)\n         /* There is nothing else to copy yet... */\n     }\n \n+    /**\n+     * Call the superclass to set up the default values for a view service using a view service description.", "originalCommit": "f4821a83b038dd98d04233a8b29589b94c0e7411", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3NDM3MA==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497474370", "bodyText": "As previous comment", "author": "grahamwallis", "createdAt": "2020-09-30T12:37:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NTE2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NjYyMA==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497466620", "bodyText": "I suggested in #3662 that we could have a type of the view service - that we could interrogate rather than using reflection.", "author": "davidradl", "createdAt": "2020-09-30T12:25:01Z", "path": "open-metadata-implementation/admin-services/admin-services-server/src/main/java/org/odpi/openmetadata/adminservices/OMAGServerAdminForViewServices.java", "diffHunk": "@@ -313,11 +315,44 @@ public VoidResponse configureAllViewServices(String userId,\n     private ViewServiceConfig createViewServiceConfig(ViewServiceRegistration     registration,\n                                                       ViewServiceConfig           requestedViewServiceConfig)\n     {\n-        ViewServiceConfig viewServiceConfig = new ViewServiceConfig(registration);\n+\n+        ViewServiceConfig viewServiceConfig = null;\n+\n+        if (requestedViewServiceConfig instanceof IntegrationViewServiceConfig) {", "originalCommit": "f4821a83b038dd98d04233a8b29589b94c0e7411", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3NDI2NQ==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497474265", "bodyText": "Perhaps - but it's another thing that the user has to set - I think I prefer it with just the class in the JSON", "author": "grahamwallis", "createdAt": "2020-09-30T12:37:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NjYyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3ODc4NQ==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497478785", "bodyText": "I would not expect the user to set it - we use the name of the view service to get the registration details -where I would expect this flag to reside, most of the registration document does not need to sent in .", "author": "davidradl", "createdAt": "2020-09-30T12:44:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NjYyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NzcyMQ==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497467721", "bodyText": "this line and next line could be moved out of the ifs -as these fields exist in ViewServiceConfig. They can be removed from the integration service code as well.", "author": "davidradl", "createdAt": "2020-09-30T12:26:45Z", "path": "open-metadata-implementation/admin-services/admin-services-server/src/main/java/org/odpi/openmetadata/adminservices/OMAGServerAdminForViewServices.java", "diffHunk": "@@ -313,11 +315,44 @@ public VoidResponse configureAllViewServices(String userId,\n     private ViewServiceConfig createViewServiceConfig(ViewServiceRegistration     registration,\n                                                       ViewServiceConfig           requestedViewServiceConfig)\n     {\n-        ViewServiceConfig viewServiceConfig = new ViewServiceConfig(registration);\n+\n+        ViewServiceConfig viewServiceConfig = null;\n+\n+        if (requestedViewServiceConfig instanceof IntegrationViewServiceConfig) {\n+            /*\n+             * The requested configuration is for an Integration View Service\n+             */\n+            IntegrationViewServiceConfig requestedIntegrationViewServiceConfig = (IntegrationViewServiceConfig)requestedViewServiceConfig;\n+            IntegrationViewServiceConfig createdViewServiceConfig = new IntegrationViewServiceConfig(registration);\n+            createdViewServiceConfig.setResourceEndpoints(requestedIntegrationViewServiceConfig.getResourceEndpoints());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else if (requestedViewServiceConfig instanceof SolutionViewServiceConfig) {\n+            /*\n+             * The requested configuration is for a Solution View Service\n+             */\n+            SolutionViewServiceConfig requestedSolutionViewServiceConfig = (SolutionViewServiceConfig)requestedViewServiceConfig;\n+            SolutionViewServiceConfig createdViewServiceConfig = new SolutionViewServiceConfig(registration);\n+            createdViewServiceConfig.setOMAGServerPlatformRootURL(requestedSolutionViewServiceConfig.getOMAGServerPlatformRootURL());", "originalCommit": "f4821a83b038dd98d04233a8b29589b94c0e7411", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3MzkxNw==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497473917", "bodyText": "Do you mean the omagServerName ad omagServerPlatformRootURL? They are only relevant on Solution and Vanilla configs; they are bot used at all in an Integration view service", "author": "grahamwallis", "createdAt": "2020-09-30T12:36:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NzcyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2Nzk0NA==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497467944", "bodyText": "I suggest we fail the request if we do not recognise the view service as one of the 2 types we support", "author": "davidradl", "createdAt": "2020-09-30T12:27:08Z", "path": "open-metadata-implementation/admin-services/admin-services-server/src/main/java/org/odpi/openmetadata/adminservices/OMAGServerAdminForViewServices.java", "diffHunk": "@@ -313,11 +315,44 @@ public VoidResponse configureAllViewServices(String userId,\n     private ViewServiceConfig createViewServiceConfig(ViewServiceRegistration     registration,\n                                                       ViewServiceConfig           requestedViewServiceConfig)\n     {\n-        ViewServiceConfig viewServiceConfig = new ViewServiceConfig(registration);\n+\n+        ViewServiceConfig viewServiceConfig = null;\n+\n+        if (requestedViewServiceConfig instanceof IntegrationViewServiceConfig) {\n+            /*\n+             * The requested configuration is for an Integration View Service\n+             */\n+            IntegrationViewServiceConfig requestedIntegrationViewServiceConfig = (IntegrationViewServiceConfig)requestedViewServiceConfig;\n+            IntegrationViewServiceConfig createdViewServiceConfig = new IntegrationViewServiceConfig(registration);\n+            createdViewServiceConfig.setResourceEndpoints(requestedIntegrationViewServiceConfig.getResourceEndpoints());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else if (requestedViewServiceConfig instanceof SolutionViewServiceConfig) {\n+            /*\n+             * The requested configuration is for a Solution View Service\n+             */\n+            SolutionViewServiceConfig requestedSolutionViewServiceConfig = (SolutionViewServiceConfig)requestedViewServiceConfig;\n+            SolutionViewServiceConfig createdViewServiceConfig = new SolutionViewServiceConfig(registration);\n+            createdViewServiceConfig.setOMAGServerPlatformRootURL(requestedSolutionViewServiceConfig.getOMAGServerPlatformRootURL());\n+            createdViewServiceConfig.setOMAGServerName(requestedSolutionViewServiceConfig.getOMAGServerName());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else {\n+            /*\n+             * Assume that the requested configuration is a vanilla view service configuration", "originalCommit": "f4821a83b038dd98d04233a8b29589b94c0e7411", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3MjYyMg==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497472622", "bodyText": "We support all 3 types", "author": "grahamwallis", "createdAt": "2020-09-30T12:35:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2Nzk0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3OTg4MA==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497479880", "bodyText": "I thought we only support the integration type and the governance solution one, I am suggesting if it is not one of them we should fail the request as it is meaningless.", "author": "davidradl", "createdAt": "2020-09-30T12:45:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2Nzk0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3MDAwMg==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497470002", "bodyText": "why do we need to delete these lines - they should work where they are; unless I am missing something", "author": "davidradl", "createdAt": "2020-09-30T12:30:33Z", "path": "open-metadata-implementation/admin-services/admin-services-server/src/main/java/org/odpi/openmetadata/adminservices/OMAGServerAdminForViewServices.java", "diffHunk": "@@ -313,11 +315,44 @@ public VoidResponse configureAllViewServices(String userId,\n     private ViewServiceConfig createViewServiceConfig(ViewServiceRegistration     registration,\n                                                       ViewServiceConfig           requestedViewServiceConfig)\n     {\n-        ViewServiceConfig viewServiceConfig = new ViewServiceConfig(registration);\n+\n+        ViewServiceConfig viewServiceConfig = null;\n+\n+        if (requestedViewServiceConfig instanceof IntegrationViewServiceConfig) {\n+            /*\n+             * The requested configuration is for an Integration View Service\n+             */\n+            IntegrationViewServiceConfig requestedIntegrationViewServiceConfig = (IntegrationViewServiceConfig)requestedViewServiceConfig;\n+            IntegrationViewServiceConfig createdViewServiceConfig = new IntegrationViewServiceConfig(registration);\n+            createdViewServiceConfig.setResourceEndpoints(requestedIntegrationViewServiceConfig.getResourceEndpoints());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else if (requestedViewServiceConfig instanceof SolutionViewServiceConfig) {\n+            /*\n+             * The requested configuration is for a Solution View Service\n+             */\n+            SolutionViewServiceConfig requestedSolutionViewServiceConfig = (SolutionViewServiceConfig)requestedViewServiceConfig;\n+            SolutionViewServiceConfig createdViewServiceConfig = new SolutionViewServiceConfig(registration);\n+            createdViewServiceConfig.setOMAGServerPlatformRootURL(requestedSolutionViewServiceConfig.getOMAGServerPlatformRootURL());\n+            createdViewServiceConfig.setOMAGServerName(requestedSolutionViewServiceConfig.getOMAGServerName());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else {\n+            /*\n+             * Assume that the requested configuration is a vanilla view service configuration\n+             */\n+            ViewServiceConfig createdViewServiceConfig = new ViewServiceConfig(registration);\n+            createdViewServiceConfig.setOMAGServerPlatformRootURL(requestedViewServiceConfig.getOMAGServerPlatformRootURL());\n+            createdViewServiceConfig.setOMAGServerName(requestedViewServiceConfig.getOMAGServerName());\n+            viewServiceConfig = createdViewServiceConfig;\n+        }\n+\n+        /*\n+         * Always copy the view service options if any are present\n+         */\n         Map<String, Object> viewOptions = requestedViewServiceConfig.getViewServiceOptions();\n         viewServiceConfig.setViewServiceOptions(viewOptions);\n-        viewServiceConfig.setOMAGServerPlatformRootURL(requestedViewServiceConfig.getOMAGServerPlatformRootURL());\n-        viewServiceConfig.setOMAGServerName(requestedViewServiceConfig.getOMAGServerName());", "originalCommit": "f4821a83b038dd98d04233a8b29589b94c0e7411", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3NDcxMQ==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497474711", "bodyText": "As above - they are not used on an Integration view service", "author": "grahamwallis", "createdAt": "2020-09-30T12:38:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3MDAwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ4MDI2MQ==", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497480261", "bodyText": "ok makes sense.", "author": "davidradl", "createdAt": "2020-09-30T12:46:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3MDAwMg=="}], "type": "inlineReview"}]}