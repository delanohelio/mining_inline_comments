{"pr_number": 4065, "pr_title": "[risk=low] Group workspaces in copy-to by CDR version", "pr_createdAt": "2020-09-25T14:10:30Z", "pr_url": "https://github.com/all-of-us/workbench/pull/4065", "timeline": [{"oid": "7a4b9d02a84875d1b6096bd686c7b07263aa01cc", "url": "https://github.com/all-of-us/workbench/commit/7a4b9d02a84875d1b6096bd686c7b07263aa01cc", "message": "Add cdrVersionId to WorkspaceResource", "committedDate": "2020-09-24T23:25:23Z", "type": "commit"}, {"oid": "bfc32601c70d4aa09c3ad9e6adb117a42786191c", "url": "https://github.com/all-of-us/workbench/commit/bfc32601c70d4aa09c3ad9e6adb117a42786191c", "message": "Prereqs for RW-5560 RW-5561\n- groupWorkspacesByCdrVersion\n- Use CDR names in Workspace selector\n- Current workspace's CDR versions first\n- setCopyError/copyErrorMsg\n- fixes for unit test", "committedDate": "2020-09-25T13:28:14Z", "type": "commit"}, {"oid": "a266382031988e5c4458b079ad9f67fbdbb90c22", "url": "https://github.com/all-of-us/workbench/commit/a266382031988e5c4458b079ad9f67fbdbb90c22", "message": "add ordering note", "committedDate": "2020-09-25T13:46:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTA2Mzg3Mw==", "url": "https://github.com/all-of-us/workbench/pull/4065#discussion_r495063873", "bodyText": "this line is the only actual change here", "author": "jmthibault79", "createdAt": "2020-09-25T15:25:55Z", "path": "api/src/main/java/org/pmiops/workbench/api/UserMetricsController.java", "diffHunk": "@@ -260,24 +261,37 @@ public boolean hasValidBlobIdIfNotebookNamePresent(DbUserRecentResource dbUserRe\n         .orElse(true);\n   }\n \n+  // TODO RW-5638 reimplement all this in MapStruct\n   private WorkspaceResource buildRecentResource(\n       Map<Long, DbWorkspace> idToDbWorkspace,\n       Map<Long, FirecloudWorkspaceResponse> idToFcWorkspaceResponse,\n       DbUserRecentResource dbUserRecentResource) {\n+\n     WorkspaceResource resource = TO_CLIENT.apply(dbUserRecentResource);\n-    FirecloudWorkspaceResponse workspaceDetails =\n-        idToFcWorkspaceResponse.get(dbUserRecentResource.getWorkspaceId());\n+    final long workspaceId = dbUserRecentResource.getWorkspaceId();\n+\n+    buildFromDbWorkspace(resource, idToDbWorkspace.get(workspaceId));\n+    buildFromFcWorkspace(resource, idToFcWorkspaceResponse.get(workspaceId));\n+\n+    return resource;\n+  }\n+\n+  private void buildFromDbWorkspace(WorkspaceResource resource, DbWorkspace dbWorkspace) {\n+    resource.setCdrVersionId(commonMappers.cdrVersionToId(dbWorkspace.getCdrVersion()));", "originalCommit": "bfc32601c70d4aa09c3ad9e6adb117a42786191c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e53ce56a9ae5fd5ded53879cb7556ced4e9046f7", "url": "https://github.com/all-of-us/workbench/commit/e53ce56a9ae5fd5ded53879cb7556ced4e9046f7", "message": "add a WorkspaceOptions type", "committedDate": "2020-09-25T15:35:21Z", "type": "commit"}, {"oid": "6d2b368f50126b2824270afd528db1895c4c80b3", "url": "https://github.com/all-of-us/workbench/commit/6d2b368f50126b2824270afd528db1895c4c80b3", "message": "fromWorkspaceFirecloudName", "committedDate": "2020-09-25T16:16:13Z", "type": "commit"}, {"oid": "901953f7894e25eeb91e9e1dcba164bf1e312585", "url": "https://github.com/all-of-us/workbench/commit/901953f7894e25eeb91e9e1dcba164bf1e312585", "message": "[CDR version not found]", "committedDate": "2020-09-25T16:28:32Z", "type": "commit"}, {"oid": "e9fb710b8dae39c8edf87bbdd97e3d71f73300b0", "url": "https://github.com/all-of-us/workbench/commit/e9fb710b8dae39c8edf87bbdd97e3d71f73300b0", "message": "lint", "committedDate": "2020-09-25T16:42:00Z", "type": "commit"}]}