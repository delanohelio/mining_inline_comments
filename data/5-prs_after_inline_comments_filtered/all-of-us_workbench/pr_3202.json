{"pr_number": 3202, "pr_title": "[RW-3861][risk=no] Allow graphs to use sex at birth and different age types", "pr_createdAt": "2020-02-28T17:56:41Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3202", "timeline": [{"oid": "322503fe8ac18ca277938b3fd811b10c85188c6d", "url": "https://github.com/all-of-us/workbench/commit/322503fe8ac18ca277938b3fd811b10c85188c6d", "message": "RW-3861 adding column to cb_search_person", "committedDate": "2020-02-28T17:37:19Z", "type": "commit"}, {"oid": "6cf2c89c50856dea65d1559f500c38c6edb89501", "url": "https://github.com/all-of-us/workbench/commit/6cf2c89c50856dea65d1559f500c38c6edb89501", "message": "RW-3861 adding check for snyth dataset.", "committedDate": "2020-02-28T17:37:19Z", "type": "commit"}, {"oid": "9325e64a11329a24860d63965e6bfac5cbd832de", "url": "https://github.com/all-of-us/workbench/commit/9325e64a11329a24860d63965e6bfac5cbd832de", "message": "RW-3861 fixing sh file.", "committedDate": "2020-02-28T17:37:19Z", "type": "commit"}, {"oid": "77a0166125966a71c4c73ac02ea2f229bd971e36", "url": "https://github.com/all-of-us/workbench/commit/77a0166125966a71c4c73ac02ea2f229bd971e36", "message": "RW-3861 adding implementation for graphs using sex at birth and age types.", "committedDate": "2020-02-28T17:43:02Z", "type": "commit"}, {"oid": "306564a7c5024d7a00d8f732c7662d861e68216e", "url": "https://github.com/all-of-us/workbench/commit/306564a7c5024d7a00d8f732c7662d861e68216e", "message": "RW-3861 adding ui change to call updated endpoint.", "committedDate": "2020-02-28T17:43:02Z", "type": "commit"}, {"oid": "6c4fdcdd14f6cc1d1d0b77600f02858fc46cb67b", "url": "https://github.com/all-of-us/workbench/commit/6c4fdcdd14f6cc1d1d0b77600f02858fc46cb67b", "message": "RW-3861\nfixing test", "committedDate": "2020-02-28T18:24:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg1MzcyNQ==", "url": "https://github.com/all-of-us/workbench/pull/3202#discussion_r385853725", "bodyText": "Updated this property to name, which will hold gender or sex at birth.", "author": "freemabd", "createdAt": "2020-02-28T18:30:24Z", "path": "api/src/bigquerytest/java/org/pmiops/workbench/api/CohortBuilderControllerBQTest.java", "diffHunk": "@@ -1923,13 +1925,67 @@ public void getDemoChartInfo() {\n             DomainType.PHYSICAL_MEASUREMENT.toString(), ImmutableList.of(pm), new ArrayList<>());\n \n     DemoChartInfoListResponse response =\n-        controller.getDemoChartInfo(cdrVersion.getCdrVersionId(), searchRequest).getBody();\n+        controller\n+            .getDemoChartInfo(\n+                cdrVersion.getCdrVersionId(),\n+                GenderOrSexType.GENDER.toString(),\n+                AgeType.AGE.toString(),\n+                searchRequest)\n+            .getBody();\n     assertEquals(2, response.getItems().size());\n     assertEquals(\n-        new DemoChartInfo().gender(\"MALE\").race(\"Asian\").ageRange(\"45-64\").count(1L),\n+        new DemoChartInfo().name(\"MALE\").race(\"Asian\").ageRange(\"45-64\").count(1L),", "originalCommit": "6c4fdcdd14f6cc1d1d0b77600f02858fc46cb67b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg1NDMyNQ==", "url": "https://github.com/all-of-us/workbench/pull/3202#discussion_r385854325", "bodyText": "No reason to dynamically set the table when it was always the same and it improves readability", "author": "freemabd", "createdAt": "2020-02-28T18:31:36Z", "path": "api/src/main/java/org/pmiops/workbench/cohortbuilder/CohortQueryBuilder.java", "diffHunk": "@@ -23,38 +24,31 @@\n @Service\n public class CohortQueryBuilder {\n   private static final String REVIEW_TABLE = \"cb_review_all_events\";\n+  private static final String SEARCH_PERSON_TABLE = \"cb_search_person\";\n+  private static final String PERSON_TABLE = \"person\";\n+\n   private static final String COUNT_SQL_TEMPLATE =\n       \"select count(*) as count\\n\"\n-          + \"from `${projectId}.${dataSetId}.${table}` ${table}\\n\"\n+          + \"from `${projectId}.${dataSetId}.cb_search_person` cb_search_person\\n\"", "originalCommit": "6c4fdcdd14f6cc1d1d0b77600f02858fc46cb67b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "12d50dd8e1cafb710430dfba045e8054a56e72f5", "url": "https://github.com/all-of-us/workbench/commit/12d50dd8e1cafb710430dfba045e8054a56e72f5", "message": "RW-3861 update charts to match new response objects", "committedDate": "2020-02-28T21:54:10Z", "type": "commit"}]}