{"pr_number": 2977, "pr_title": "[RW-4163][Risk=low] Add new fields to demographics survey", "pr_createdAt": "2020-01-07T15:39:11Z", "pr_url": "https://github.com/all-of-us/workbench/pull/2977", "timeline": [{"oid": "fcf8d66b50efebadef93f7c1ab9e747ea58a01b5", "url": "https://github.com/all-of-us/workbench/commit/fcf8d66b50efebadef93f7c1ab9e747ea58a01b5", "message": "Add new fields to demographics survey", "committedDate": "2020-01-07T15:31:24Z", "type": "commit"}, {"oid": "de2f463e66d4041595e38972ea962a90a7e1e5f7", "url": "https://github.com/all-of-us/workbench/commit/de2f463e66d4041595e38972ea962a90a7e1e5f7", "message": "Fix some stylistic things", "committedDate": "2020-01-07T15:36:02Z", "type": "commit"}, {"oid": "abeee3097a91fd7bf626f921e058c2396a6921b6", "url": "https://github.com/all-of-us/workbench/commit/abeee3097a91fd7bf626f921e058c2396a6921b6", "message": "Fix test compilation", "committedDate": "2020-01-07T15:41:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM1ODcxMQ==", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364358711", "bodyText": "why reorder these?  I would expect the order to match the accessors below", "author": "jmthibault79", "createdAt": "2020-01-08T17:44:26Z", "path": "api/src/main/java/org/pmiops/workbench/db/model/DbDemographicSurvey.java", "diffHunk": "@@ -19,18 +19,22 @@\n import org.pmiops.workbench.model.Ethnicity;\n import org.pmiops.workbench.model.Gender;\n import org.pmiops.workbench.model.Race;\n+import org.pmiops.workbench.model.SexAtBirth;\n+import org.pmiops.workbench.model.SexualOrientation;\n \n @Entity\n @Table(name = \"demographic_survey\")\n public class DbDemographicSurvey {\n-  private long id;\n-  private List<Short> race;\n+  private Short disability;", "originalCommit": "abeee3097a91fd7bf626f921e058c2396a6921b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQwMjcyMg==", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364402722", "bodyText": "I made them alphabetical. I can update the accessors to follow, but I think that will make things easier to find.", "author": "s-rubenstein", "createdAt": "2020-01-08T19:25:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM1ODcxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM1OTExMg==", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364359112", "bodyText": "Can replace with .map(DemographicSurveyEnum::sexualOrientationFromStorage)", "author": "jmthibault79", "createdAt": "2020-01-08T17:45:23Z", "path": "api/src/main/java/org/pmiops/workbench/db/model/DbDemographicSurvey.java", "diffHunk": "@@ -94,6 +98,74 @@ public void setRaceEnum(List<Race> raceList) {\n             .collect(Collectors.toList());\n   }\n \n+  @ElementCollection(fetch = FetchType.LAZY)\n+  @CollectionTable(\n+      name = \"demographic_survey_sexual_orientation\",\n+      joinColumns = @JoinColumn(name = \"demographic_survey_id\"))\n+  @Column(name = \"sexual_orientation\")\n+  public List<Short> getSexualOrientation() {\n+    return sexualOrientation;\n+  }\n+\n+  public void setSexualOrientation(List<Short> sexualOrientation) {\n+    this.sexualOrientation = sexualOrientation;\n+  }\n+\n+  @Transient\n+  public List<SexualOrientation> getSexualOrientationEnum() {\n+    if (sexualOrientation == null) return null;\n+    return this.sexualOrientation.stream()\n+        .map(", "originalCommit": "abeee3097a91fd7bf626f921e058c2396a6921b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM2MjEwNg==", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364362106", "bodyText": "same comments for sexAtBirth", "author": "jmthibault79", "createdAt": "2020-01-08T17:52:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM1OTExMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM1OTI2Mg==", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364359262", "bodyText": "Can replace with .map(DemographicSurveyEnum::sexualOrientationToStorage)", "author": "jmthibault79", "createdAt": "2020-01-08T17:45:41Z", "path": "api/src/main/java/org/pmiops/workbench/db/model/DbDemographicSurvey.java", "diffHunk": "@@ -94,6 +98,74 @@ public void setRaceEnum(List<Race> raceList) {\n             .collect(Collectors.toList());\n   }\n \n+  @ElementCollection(fetch = FetchType.LAZY)\n+  @CollectionTable(\n+      name = \"demographic_survey_sexual_orientation\",\n+      joinColumns = @JoinColumn(name = \"demographic_survey_id\"))\n+  @Column(name = \"sexual_orientation\")\n+  public List<Short> getSexualOrientation() {\n+    return sexualOrientation;\n+  }\n+\n+  public void setSexualOrientation(List<Short> sexualOrientation) {\n+    this.sexualOrientation = sexualOrientation;\n+  }\n+\n+  @Transient\n+  public List<SexualOrientation> getSexualOrientationEnum() {\n+    if (sexualOrientation == null) return null;\n+    return this.sexualOrientation.stream()\n+        .map(\n+            (sexualOrientationObject) -> {\n+              return DemographicSurveyEnum.sexualOrientationFromStorage(sexualOrientationObject);\n+            })\n+        .collect(Collectors.toList());\n+  }\n+\n+  public void setSexualOrientationEnum(List<SexualOrientation> sexualOrientationList) {\n+    this.sexualOrientation =\n+        sexualOrientationList.stream()\n+            .map(", "originalCommit": "abeee3097a91fd7bf626f921e058c2396a6921b6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cc2c78ee790899523a643c277cb1c9aa7e1e3f19", "url": "https://github.com/all-of-us/workbench/commit/cc2c78ee790899523a643c277cb1c9aa7e1e3f19", "message": "PR feedback", "committedDate": "2020-01-08T22:33:53Z", "type": "commit"}, {"oid": "ea659c5759b8563f0660df0d744c282833cca3f2", "url": "https://github.com/all-of-us/workbench/commit/ea659c5759b8563f0660df0d744c282833cca3f2", "message": "Fix linting", "committedDate": "2020-01-09T16:11:33Z", "type": "commit"}]}