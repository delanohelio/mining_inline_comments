{"pr_number": 3923, "pr_title": "Migrate to `androidx` Library for Implementing Preferences in Collect", "pr_createdAt": "2020-06-14T21:14:45Z", "pr_url": "https://github.com/getodk/collect/pull/3923", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTEwODY3Mg==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r441108672", "bodyText": "Hi @seadowg! I was not able to create PreferenceFragmentCompat using Robolectric, and could not think of any other method to test it. I made BasePreferenceFragment extract PreferenceFragmentCompat, as androidx.PreferenceFragment is also deprecated.", "author": "SaumiaSinghal", "createdAt": "2020-06-16T20:01:35Z", "path": "collect_app/src/test/java/org/odk/collect/android/preferences/AggregatePreferencesAdderTest.java", "diffHunk": "@@ -3,24 +3,27 @@\n import android.preference.PreferenceFragment;\n import android.preference.PreferenceManager;\n \n+import androidx.preference.PreferenceFragmentCompat;\n+import androidx.test.core.app.ApplicationProvider;\n+\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.odk.collect.android.R;\n import org.robolectric.Robolectric;\n import org.robolectric.RobolectricTestRunner;\n-import org.robolectric.RuntimeEnvironment;\n import org.robolectric.shadows.ShadowToast;\n \n import static junit.framework.Assert.assertFalse;\n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertTrue;\n+import static org.mockito.Mockito.mock;\n \n @RunWith(RobolectricTestRunner.class)\n public class AggregatePreferencesAdderTest {\n \n     @Test\n     public void whenPreferencesAreAdded_returnsTrue() {\n-        PreferenceFragment fragment = Robolectric.buildFragment(TestPreferenceFragment.class).create().resume().visible().get();\n+        PreferenceFragmentCompat fragment = mock(PreferenceFragmentCompat.class);\n         AggregatePreferencesAdder loader = new AggregatePreferencesAdder(fragment);", "originalCommit": "60111976f2a5d2b4310a237ba6c6b06ca53de550", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTU0MjkxNQ==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r441542915", "bodyText": "Mocking is fine here I think! You can make the call to addPreferencesFromResource throw a ClassCastException using Mockito's thenThrow.", "author": "seadowg", "createdAt": "2020-06-17T13:26:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTEwODY3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTU0NDM5NA==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r441544394", "bodyText": "Oh okay Thanks @seadowg!", "author": "SaumiaSinghal", "createdAt": "2020-06-17T13:28:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTEwODY3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDEyNzcwMw==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r444127703", "bodyText": "Now we're doing this I think we should be able to get rid of the AndroidXPreferencesActivity and just start those fragments like everything else. Could you make that happen please?", "author": "seadowg", "createdAt": "2020-06-23T10:36:49Z", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/GeneralPreferencesFragment.java", "diffHunk": "@@ -79,7 +80,7 @@ public boolean onPreferenceClick(Preference preference) {\n                     break;\n             }\n             if (basePreferenceFragment != null) {\n-                getActivity().getFragmentManager()\n+                getActivity().getSupportFragmentManager()", "originalCommit": "cc30c89f1acc9fee3854c5bedd080ba5d81961af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDEyODY3Ng==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r444128676", "bodyText": "Did you need this?", "author": "seadowg", "createdAt": "2020-06-23T10:38:33Z", "path": "collect_app/src/test/java/org/odk/collect/android/activities/FormMapActivityTest.java", "diffHunk": "@@ -148,13 +148,15 @@ public MapProvider providesMapProvider() {\n         assertThat(map.wasLatestZoomCallAnimated(), is(false));\n     }\n \n+    @LooperMode(PAUSED)\n     @Test public void tappingOnLayerMenu_opensLayerDialog() {\n-        List<Fragment> fragments = activity.getFragmentManager().getFragments();\n+        List<Fragment> fragments = activity.getSupportFragmentManager().getFragments();\n         assertThat(fragments, not(hasItem(isA(MapsPreferences.class))));\n \n         activity.findViewById(R.id.layer_menu).performClick();\n \n-        fragments = activity.getFragmentManager().getFragments();\n+        activity.getSupportFragmentManager().executePendingTransactions();", "originalCommit": "cc30c89f1acc9fee3854c5bedd080ba5d81961af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU2NDQ2OQ==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r444564469", "bodyText": "Yes, the test is failing without it. :/", "author": "SaumiaSinghal", "createdAt": "2020-06-23T23:34:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDEyODY3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc3ODkzMA==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r444778930", "bodyText": "Why do you need to do this?", "author": "seadowg", "createdAt": "2020-06-24T09:51:42Z", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/FormMetadataFragment.java", "diffHunk": "@@ -91,6 +91,17 @@ public void denied() {\n         }\n     }\n \n+    @Override\n+    public void onDestroyView() {\n+        emailPreference = null;", "originalCommit": "71225c8889d49e9410bd4536c3c2b712a9134c3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc5MTg0MA==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r444791840", "bodyText": "I added this just to avoid memory leaks. I'll check once whether it has really some effects or not.", "author": "SaumiaSinghal", "createdAt": "2020-06-24T10:15:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc3ODkzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc4MjQ2NA==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r444782464", "bodyText": "Not sure why you have to create your own dialogs for these preferences (and not just use EditTextPreference)? Have you looked through the docs at https://developer.android.com/guide/topics/ui/settings/ to see if there are other ways of implementing the features there is code for in the dialogs?", "author": "seadowg", "createdAt": "2020-06-24T09:58:02Z", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/ServerPreferencesFragment.java", "diffHunk": "@@ -99,10 +94,46 @@ public static ServerPreferencesFragment newInstance(boolean adminMode) {\n     public void onCreate(Bundle savedInstanceState) {\n         super.onCreate(savedInstanceState);\n         addPreferencesFromResource(R.xml.server_preferences);\n-\n         initProtocolPrefs();\n     }\n \n+    @Override\n+    public void onDisplayPreferenceDialog(Preference preference) {\n+        if (preference instanceof CustomEditTextPreference) {\n+            switch (preference.getKey()) {\n+                case \"server_url\":\n+                    dialogFragment = ServerUrlEditTextPreferenceDialog.newInstance(preference.getKey());", "originalCommit": "71225c8889d49e9410bd4536c3c2b712a9134c3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NTY1Ng==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r444845656", "bodyText": "EditTextPreference.getEditText() method was removed in androidx.preference as discussed here. That's why I used CustomEditTextPreference. I do see that now that there's an easy way of doing so. I will review my code once again and then will ask for re-review.", "author": "SaumiaSinghal", "createdAt": "2020-06-24T12:06:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc4MjQ2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg2NDU5Ng==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r444864596", "bodyText": "Sorry for the redundant code. I removed the CustomEditTextPreference class. I followed this article for creating Reference layer dialog and Reset dialog. I didn't find any better explanation in the docs :(", "author": "SaumiaSinghal", "createdAt": "2020-06-24T12:42:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc4MjQ2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc4MjgxNA==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r444782814", "bodyText": "What is the code in this method doing?", "author": "seadowg", "createdAt": "2020-06-24T09:58:40Z", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/PasswordEditTextPreferenceDialog.java", "diffHunk": "@@ -0,0 +1,54 @@\n+package org.odk.collect.android.preferences;\n+\n+import android.os.Bundle;\n+import android.text.InputFilter;\n+import android.view.MotionEvent;\n+import android.view.View;\n+import android.widget.EditText;\n+\n+import androidx.preference.EditTextPreferenceDialogFragmentCompat;\n+\n+import org.odk.collect.android.preferences.filters.ControlCharacterFilter;\n+import org.odk.collect.android.utilities.SoftKeyboardUtils;\n+\n+public class PasswordEditTextPreferenceDialog extends EditTextPreferenceDialogFragmentCompat implements View.OnTouchListener {\n+\n+    public static PasswordEditTextPreferenceDialog newInstance(String key) {\n+        PasswordEditTextPreferenceDialog fragment = new PasswordEditTextPreferenceDialog();\n+        Bundle b = new Bundle(1);\n+        b.putString(ARG_KEY, key);\n+        fragment.setArguments(b);\n+        return fragment;\n+    }\n+\n+    @Override\n+    protected void onBindDialogView(View view) {\n+        CustomEditTextPreference passwordEditTextPreference = null;\n+        if (getPreference() instanceof CustomEditTextPreference) {\n+            passwordEditTextPreference = (CustomEditTextPreference) getPreference();\n+        }\n+        EditText editText = (EditText) view.findViewById(android.R.id.edit);\n+        editText.setFilters(new InputFilter[]{new ControlCharacterFilter()});\n+\n+        if (passwordEditTextPreference != null) {\n+            passwordEditTextPreference.setOnPreferenceClickListener(preference -> {\n+                editText.requestFocus();\n+                return true;\n+            });\n+        }\n+        super.onBindDialogView(view);\n+    }\n+\n+    @Override\n+    public boolean onTouch(View v, MotionEvent event) {", "originalCommit": "71225c8889d49e9410bd4536c3c2b712a9134c3d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "21626f8456972351a5448680b770528719ad1c7a", "url": "https://github.com/getodk/collect/commit/21626f8456972351a5448680b770528719ad1c7a", "message": "remove customEditTextPreference feild", "committedDate": "2020-06-24T12:10:47Z", "type": "forcePushed"}, {"oid": "ad38ad65782dba6a92e19dcb99b3390d770e380d", "url": "https://github.com/getodk/collect/commit/ad38ad65782dba6a92e19dcb99b3390d770e380d", "message": "code refactor", "committedDate": "2020-06-30T05:36:51Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODkxMzkwNw==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r448913907", "bodyText": "Not sure why you need this. If you're getting a leak here lets try to work out what's causing and see if there is a better way to solve it!", "author": "seadowg", "createdAt": "2020-07-02T10:45:24Z", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/ServerPreferencesFragment.java", "diffHunk": "@@ -99,10 +102,20 @@ public static ServerPreferencesFragment newInstance(boolean adminMode) {\n     public void onCreate(Bundle savedInstanceState) {\n         super.onCreate(savedInstanceState);\n         addPreferencesFromResource(R.xml.server_preferences);\n-\n         initProtocolPrefs();\n     }\n \n+    @Override\n+    public void onDestroyView() {\n+        serverUrlPreference = null;", "originalCommit": "6a66ba4b4efd5eba7f4e2f976c5a72754ac39b97", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1ec01c594c25439c0fada356fb8af71b924d26f1", "url": "https://github.com/getodk/collect/commit/1ec01c594c25439c0fada356fb8af71b924d26f1", "message": "fix pmd", "committedDate": "2020-07-12T10:15:53Z", "type": "forcePushed"}, {"oid": "eef3d9b3838d1cac232ff1e77e6199b11b1aa5d8", "url": "https://github.com/getodk/collect/commit/eef3d9b3838d1cac232ff1e77e6199b11b1aa5d8", "message": "code refactor", "committedDate": "2020-07-15T09:04:24Z", "type": "forcePushed"}, {"oid": "0d8fac9300962508178b7deb8858a752c2cd2f04", "url": "https://github.com/getodk/collect/commit/0d8fac9300962508178b7deb8858a752c2cd2f04", "message": "initial commit", "committedDate": "2020-07-21T10:32:35Z", "type": "commit"}, {"oid": "bd01b824f2f8ad5539e6a4bcc416e3240b35ba2f", "url": "https://github.com/getodk/collect/commit/bd01b824f2f8ad5539e6a4bcc416e3240b35ba2f", "message": "resolve conflict in MApConfigurator", "committedDate": "2020-07-21T10:34:35Z", "type": "commit"}, {"oid": "525121cb596a7377b8fa9af01f2534f15fe4f7f8", "url": "https://github.com/getodk/collect/commit/525121cb596a7377b8fa9af01f2534f15fe4f7f8", "message": "migrate to androidx library in ResetDialogPreference", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "88fd3b2261307294f27f706123425abdb4f61c30", "url": "https://github.com/getodk/collect/commit/88fd3b2261307294f27f706123425abdb4f61c30", "message": "create ResetDialogPreferenceFragmentCompat", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "99e7dc4173846ea4426a1fe51e9ad0caaba64842", "url": "https://github.com/getodk/collect/commit/99e7dc4173846ea4426a1fe51e9ad0caaba64842", "message": "fixed conflict in general_preferences.xml", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "54aea9276f422e65483f7cca45bd37abe7b9fa0e", "url": "https://github.com/getodk/collect/commit/54aea9276f422e65483f7cca45bd37abe7b9fa0e", "message": "fix reset application text size in admin_preferences.xml", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "429203e5ae83e157f9a8b5ee4d6e70e08b98586f", "url": "https://github.com/getodk/collect/commit/429203e5ae83e157f9a8b5ee4d6e70e08b98586f", "message": "update CaptionedListPreference", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "f9569b5598ec8975aecfc5fbe05512ed3bd1e003", "url": "https://github.com/getodk/collect/commit/f9569b5598ec8975aecfc5fbe05512ed3bd1e003", "message": "fix conflict in ServerPreferencesFragment", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "a9f1515ea8730d9303345898f45e241a828ae762", "url": "https://github.com/getodk/collect/commit/a9f1515ea8730d9303345898f45e241a828ae762", "message": "create ReferenceLayerPreferenceDialog.", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "18452d67c70ad22671877119d19a1d2a81423372", "url": "https://github.com/getodk/collect/commit/18452d67c70ad22671877119d19a1d2a81423372", "message": "update ReferenceLayerPreferenceDialog to avoid crash", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "076d18a3ae57a63dd6a9364d28ee3bb4ef224b5e", "url": "https://github.com/getodk/collect/commit/076d18a3ae57a63dd6a9364d28ee3bb4ef224b5e", "message": "update ReferenceLayerPreferenceDailog to avoid memory leak", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "608755a36f88ff88459e42fb43b18c6a0ca4e8a2", "url": "https://github.com/getodk/collect/commit/608755a36f88ff88459e42fb43b18c6a0ca4e8a2", "message": "make prefernce a local variavle to avoid memory leak", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "6a812400b44807177a3bd0733536b18bea5cf390", "url": "https://github.com/getodk/collect/commit/6a812400b44807177a3bd0733536b18bea5cf390", "message": "refactor code to avoid memory leak", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "09047d49e0472b26d802a8587a034dbfd136017e", "url": "https://github.com/getodk/collect/commit/09047d49e0472b26d802a8587a034dbfd136017e", "message": "refactor code to make tappingOnLayerMenu_opensLayerDialog() test green", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "f5e1ad749f8bc5b937bf8ac51eba5b404ac4ede3", "url": "https://github.com/getodk/collect/commit/f5e1ad749f8bc5b937bf8ac51eba5b404ac4ede3", "message": "update unit tests", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "32b0e018470087b1eb9dd44437a4ec094dec3816", "url": "https://github.com/getodk/collect/commit/32b0e018470087b1eb9dd44437a4ec094dec3816", "message": "code refactor", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "003e12474aa03299e38a6cfc230f3ea75f1e751a", "url": "https://github.com/getodk/collect/commit/003e12474aa03299e38a6cfc230f3ea75f1e751a", "message": "fix reference layer dialog showing on top of other preference dialogs", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "c7f6e7c623e911e3edaab974797d3a5f7414e07b", "url": "https://github.com/getodk/collect/commit/c7f6e7c623e911e3edaab974797d3a5f7414e07b", "message": "use mock instead of Robolectric.buildFragment()", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "b166a343c1b9667a4a1d1aa2d5a206ad6599f0fc", "url": "https://github.com/getodk/collect/commit/b166a343c1b9667a4a1d1aa2d5a206ad6599f0fc", "message": "delete AndroidXPreferencesActivity", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "bc9c7afadd5c5dba111d1c6f9649a3491dc5c69d", "url": "https://github.com/getodk/collect/commit/bc9c7afadd5c5dba111d1c6f9649a3491dc5c69d", "message": "resolve conflict in GeneralSettingsPage", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "00ef85492969a233e15310bfca563d55e49a7b92", "url": "https://github.com/getodk/collect/commit/00ef85492969a233e15310bfca563d55e49a7b92", "message": "fix pmd", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "c6d7b8e6dec010b67a819ea8e1f7623872f2b119", "url": "https://github.com/getodk/collect/commit/c6d7b8e6dec010b67a819ea8e1f7623872f2b119", "message": "fix conflict", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "393b4ea8ecf23af236c96251f8c5cf32b113fb32", "url": "https://github.com/getodk/collect/commit/393b4ea8ecf23af236c96251f8c5cf32b113fb32", "message": "fix conflict in ServerPreferencesFragment", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "ef38cc4da2f09dcba197e40d8ed83775101cf679", "url": "https://github.com/getodk/collect/commit/ef38cc4da2f09dcba197e40d8ed83775101cf679", "message": "code refactor", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "72866ca7d3793fdb88e16157e98b166198b30e9f", "url": "https://github.com/getodk/collect/commit/72866ca7d3793fdb88e16157e98b166198b30e9f", "message": "fix AggregatePreferencesAdderTest", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "32b1b02124682000be012aeff078f042c550818c", "url": "https://github.com/getodk/collect/commit/32b1b02124682000be012aeff078f042c550818c", "message": "rename openServerSettings() to clickServerSettings()", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "f042f4a3e0e7469fa8d1cc0db4378992abdb4999", "url": "https://github.com/getodk/collect/commit/f042f4a3e0e7469fa8d1cc0db4378992abdb4999", "message": "remove onDestroyView() in FormMetadataFragment", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "d5b826f23c3a32e06ef710a290038e848ea20589", "url": "https://github.com/getodk/collect/commit/d5b826f23c3a32e06ef710a290038e848ea20589", "message": "fix pmd", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "0642f7ec3c2a84a84a8da1d6dbc779cb3304120e", "url": "https://github.com/getodk/collect/commit/0642f7ec3c2a84a84a8da1d6dbc779cb3304120e", "message": "code refactor", "committedDate": "2020-07-21T10:34:41Z", "type": "commit"}, {"oid": "0642f7ec3c2a84a84a8da1d6dbc779cb3304120e", "url": "https://github.com/getodk/collect/commit/0642f7ec3c2a84a84a8da1d6dbc779cb3304120e", "message": "code refactor", "committedDate": "2020-07-21T10:34:41Z", "type": "forcePushed"}, {"oid": "3e9d323aa8078924c3fe8e0cbafcdce34e5c937d", "url": "https://github.com/getodk/collect/commit/3e9d323aa8078924c3fe8e0cbafcdce34e5c937d", "message": "fix divider and icon space issue", "committedDate": "2020-07-22T15:01:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk0ODAwNQ==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r458948005", "bodyText": "We should absolutely avoid suppressing lint warnings if they get in our way unless we really need to. Here it's telling us that we should be using this API as they might change it which would mean our code could end up breaking down the line.\nNot sure why we need to do this here and not use the XML attributes like on other preferences screens?", "author": "seadowg", "createdAt": "2020-07-22T17:05:58Z", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/MapsPreferences.java", "diffHunk": "@@ -57,6 +64,23 @@ public static MapsPreferences newInstance(boolean adminMode) {\n         return prefs;\n     }\n \n+    @SuppressLint(\"RestrictedApi\")", "originalCommit": "3e9d323aa8078924c3fe8e0cbafcdce34e5c937d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk5NzMyNg==", "url": "https://github.com/getodk/collect/pull/3923#discussion_r458997326", "bodyText": "Correct @seadowg! I fixed it. I set the iconSpaceReserved to false in the MapPreference class.", "author": "SaumiaSinghal", "createdAt": "2020-07-22T18:28:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk0ODAwNQ=="}], "type": "inlineReview"}, {"oid": "79d07c3a962740032b501a99b7f1157f65ee76a1", "url": "https://github.com/getodk/collect/commit/79d07c3a962740032b501a99b7f1157f65ee76a1", "message": "remove SuppressLint annotation", "committedDate": "2020-07-22T18:00:45Z", "type": "commit"}, {"oid": "736eeb8203a753b48a9b291b019847a5fa7a66d2", "url": "https://github.com/getodk/collect/commit/736eeb8203a753b48a9b291b019847a5fa7a66d2", "message": "set iconSpaceReserved to false in MapPreferences", "committedDate": "2020-07-22T18:27:13Z", "type": "commit"}, {"oid": "671d8a72fb289bd2b5b5a07fc33729f39b01bc51", "url": "https://github.com/getodk/collect/commit/671d8a72fb289bd2b5b5a07fc33729f39b01bc51", "message": "Merge branch 'master' into fix_settings_preference", "committedDate": "2020-07-24T08:57:20Z", "type": "commit"}]}