{"pr_number": 4309, "pr_title": "Removed redundant ChangingDatabasesByForksTest", "pr_createdAt": "2020-12-15T12:11:23Z", "pr_url": "https://github.com/getodk/collect/pull/4309", "timeline": [{"oid": "4c68df4fd9e59038b36fa2a17bae10f37d94001a", "url": "https://github.com/getodk/collect/commit/4c68df4fd9e59038b36fa2a17bae10f37d94001a", "message": "Removed redundant ChangingDatabasesByForksTest", "committedDate": "2020-12-17T12:59:41Z", "type": "commit"}, {"oid": "1962aed20a5e7115b4d909f92f600aa17d7fedb3", "url": "https://github.com/getodk/collect/commit/1962aed20a5e7115b4d909f92f600aa17d7fedb3", "message": "Removed the extra check if form db should be upgraded", "committedDate": "2020-12-17T13:45:13Z", "type": "commit"}, {"oid": "69214bc9770f8058d325618169231108e1edf4bd", "url": "https://github.com/getodk/collect/commit/69214bc9770f8058d325618169231108e1edf4bd", "message": "Removed the extra check if instances db should be upgraded", "committedDate": "2020-12-17T13:45:31Z", "type": "commit"}, {"oid": "0c34f5c752173c5e8a862e83630ca47a9419fe3e", "url": "https://github.com/getodk/collect/commit/0c34f5c752173c5e8a862e83630ca47a9419fe3e", "message": "Code improvements", "committedDate": "2020-12-17T14:06:35Z", "type": "commit"}, {"oid": "d1a5ebbc5d42506bf3ff3dd759ea7f824ed39a70", "url": "https://github.com/getodk/collect/commit/d1a5ebbc5d42506bf3ff3dd759ea7f824ed39a70", "message": "Factored out InstanceDatabaseMigrator to follow the same structre of classes we have in acase of forms db", "committedDate": "2020-12-17T14:25:40Z", "type": "commit"}, {"oid": "20c41f7b75c01868d51659b98c878c4284350d08", "url": "https://github.com/getodk/collect/commit/20c41f7b75c01868d51659b98c878c4284350d08", "message": "Implemented interface for database migrators", "committedDate": "2020-12-17T14:37:53Z", "type": "commit"}, {"oid": "9448aaf3a270b7c0b498b2d419a5c9e6d771c6e7", "url": "https://github.com/getodk/collect/commit/9448aaf3a270b7c0b498b2d419a5c9e6d771c6e7", "message": "Moved constants to DatabaseConstants class", "committedDate": "2020-12-17T14:49:05Z", "type": "commit"}, {"oid": "fb4bbc80721db888432d735808143d76f0c51895", "url": "https://github.com/getodk/collect/commit/fb4bbc80721db888432d735808143d76f0c51895", "message": "Pass StoragePathProvider to database helpers", "committedDate": "2020-12-17T14:52:05Z", "type": "commit"}, {"oid": "33d1dd38a12fe8c3f093c836acd92f7c3c81bf8d", "url": "https://github.com/getodk/collect/commit/33d1dd38a12fe8c3f093c836acd92f7c3c81bf8d", "message": "Added missing log", "committedDate": "2020-12-17T14:56:08Z", "type": "commit"}, {"oid": "33d1dd38a12fe8c3f093c836acd92f7c3c81bf8d", "url": "https://github.com/getodk/collect/commit/33d1dd38a12fe8c3f093c836acd92f7c3c81bf8d", "message": "Added missing log", "committedDate": "2020-12-17T14:56:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTMxNDkzNA==", "url": "https://github.com/getodk/collect/pull/4309#discussion_r551314934", "bodyText": "It looks like these tests all fail. Should we rework or delete (if we don't need them) as part of this?", "author": "seadowg", "createdAt": "2021-01-04T13:25:59Z", "path": "collect_app/src/androidTest/java/org/odk/collect/android/instrumented/database/helpers/InstancesDatabaseHelperTest.java", "diffHunk": "@@ -29,7 +31,7 @@\n @RunWith(Parameterized.class)\n @Ignore(\"`Parameterized` causes problems for Firebase sharding. Probably need to replace this at JUnit level\")\n public class InstancesDatabaseHelperTest extends SqlLiteHelperTest {", "originalCommit": "0c34f5c752173c5e8a862e83630ca47a9419fe3e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTkxMzUzNg==", "url": "https://github.com/getodk/collect/pull/4309#discussion_r551913536", "bodyText": "I think it would be good to have such tests that confirm that upgrading/downgrading databases work well so I would keep it.", "author": "grzesiek2010", "createdAt": "2021-01-05T12:53:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTMxNDkzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTkzMzE5OQ==", "url": "https://github.com/getodk/collect/pull/4309#discussion_r551933199", "bodyText": "Totally agree that we want that coverage. With forms, it seems we have that covered in FormDatabaseMigratorTest so we could add a similar test for instances and remove this one (so replace the instrumented test with a Robolectric test). That said this PR definitely offers a bunch of good stuff, so we could just create an issue for that?", "author": "seadowg", "createdAt": "2021-01-05T13:32:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTMxNDkzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjAxODY0OQ==", "url": "https://github.com/getodk/collect/pull/4309#discussion_r552018649", "bodyText": "Yeah I agree.", "author": "grzesiek2010", "createdAt": "2021-01-05T15:50:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTMxNDkzNA=="}], "type": "inlineReview"}]}