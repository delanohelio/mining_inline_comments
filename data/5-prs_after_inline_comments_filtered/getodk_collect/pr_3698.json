{"pr_number": 3698, "pr_title": "Rebuild the mappable instance list when the map view is shown to reflect deleted geopoint", "pr_createdAt": "2020-03-09T16:58:48Z", "pr_url": "https://github.com/getodk/collect/pull/3698", "timeline": [{"oid": "364527937a4b8f6386c81fdec4f4f44f416b19ea", "url": "https://github.com/getodk/collect/commit/364527937a4b8f6386c81fdec4f4f44f416b19ea", "message": "Add test that fails when geometry is cleared", "committedDate": "2020-03-09T16:57:28Z", "type": "commit"}, {"oid": "1fe1622dfa254194478bf0c1dca38fc89b0212f5", "url": "https://github.com/getodk/collect/commit/1fe1622dfa254194478bf0c1dca38fc89b0212f5", "message": "Build mappable instance list every time", "committedDate": "2020-03-09T16:57:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg0NDk3Mg==", "url": "https://github.com/getodk/collect/pull/3698#discussion_r389844972", "bodyText": "I'm wondering if this test could be made a little simpler if it was just getMappableFormInstances_alwaysReturnsUpToDateInstances(). If the TestInstancesRepository had a method that let you switch out the list of instances you could change instances in the repo that way and then check getMappableFormInstances", "author": "seadowg", "createdAt": "2020-03-09T17:27:54Z", "path": "collect_app/src/test/java/org/odk/collect/android/activities/FormMapViewModelTest.java", "diffHunk": "@@ -133,6 +133,30 @@\n         assertThat(instances.get(6).getClickAction(), is(FormMapViewModel.ClickAction.OPEN_EDIT));\n     }\n \n+    @Test public void clearingInstanceGeometry_isReflectedInInstanceCountsAndList() {", "originalCommit": "1fe1622dfa254194478bf0c1dca38fc89b0212f5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDA4MDMyNQ==", "url": "https://github.com/getodk/collect/pull/3698#discussion_r390080325", "bodyText": "Ah yes, I am far from mastering the art of writing as narrow of a test as possible. I tend to go with what matches the user experience where possible. I unfortunately won\u2019t get a chance to come back to this in the next couple of days but if someone wants to push that change to my branch they are welcome to.", "author": "lognaturel", "createdAt": "2020-03-10T03:45:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg0NDk3Mg=="}], "type": "inlineReview"}]}