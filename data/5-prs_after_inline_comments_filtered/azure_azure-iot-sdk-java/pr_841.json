{"pr_number": 841, "pr_title": "feat(samples): Updating and adding samples for pnp summer refresh", "pr_createdAt": "2020-07-06T23:54:55Z", "pr_url": "https://github.com/Azure/azure-iot-sdk-java/pull/841", "timeline": [{"oid": "4ba9a31e1c79dc563aceeddf50162f3b90412ef0", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/4ba9a31e1c79dc563aceeddf50162f3b90412ef0", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T00:07:24Z", "type": "forcePushed"}, {"oid": "dd62370873bf38400b380b8f1aaff18e9c1bc85e", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/dd62370873bf38400b380b8f1aaff18e9c1bc85e", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T00:19:48Z", "type": "forcePushed"}, {"oid": "44d2343ec5695a951a46922aadc5a422f6aabba3", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/44d2343ec5695a951a46922aadc5a422f6aabba3", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T00:24:44Z", "type": "forcePushed"}, {"oid": "9238951d14854658271888e220a85cf9300f4cad", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/9238951d14854658271888e220a85cf9300f4cad", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T00:25:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU0ODY0MQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r450548641", "bodyText": "I was not very clear if helper meant helper class or method. Will move it to a class if that is what it means.", "author": "vinagesh", "createdAt": "2020-07-07T00:36:06Z", "path": "service/iot-service-samples/pnp-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/TemperatureController.java", "diffHunk": "@@ -0,0 +1,143 @@\n+package samples.com.microsoft.azure.sdk.iot;\n+\n+import com.google.gson.JsonElement;\n+import com.google.gson.JsonObject;\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+import com.microsoft.azure.sdk.iot.service.exceptions.IotHubException;\n+\n+import javax.json.Json;\n+import java.io.IOException;\n+import java.time.ZoneOffset;\n+import java.time.ZonedDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.util.*;\n+import java.util.concurrent.TimeUnit;\n+\n+// This sample uses the model - https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/samples/TemperatureController.json\n+public class TemperatureController {\n+    // Get connection string and device id inputs\n+    private static final String hubConnectionString  = \"HostName=summerrelease-test-04.private.azure-devices-int.net;SharedAccessKeyName=iothubowner;SharedAccessKey=lkm4Gvm5gN9nWDgK4Cwwwgj47q/8w1qxgF5bRbi6yNM=\";\n+    private static final String deviceId = \"vinageshpnpdevice1\";\n+\n+    private static DeviceTwin twinClient;\n+    private static DeviceMethod methodClient;\n+\n+    public static void main(String[] args) throws Exception {\n+        RunSample();\n+    }\n+\n+    private static void RunSample() throws IOException, IotHubException {\n+        System.out.println(\"Initialize the service client.\");\n+        InitializeServiceClient();\n+\n+        System.out.println(\"Get Twin model Id and Update Twin\");\n+        GetAndUpdateTwin();\n+\n+        System.out.println(\"Invoke a method on component\");\n+        InvokeMethodOnComponent();\n+\n+        System.out.println(\"Invoke a method on root level\");\n+        InvokeMethodOnRootLevel();\n+    }\n+\n+    private static void InitializeServiceClient() throws IOException {\n+        twinClient = DeviceTwin.createFromConnectionString(hubConnectionString);\n+        methodClient = DeviceMethod.createFromConnectionString(hubConnectionString);\n+    }\n+\n+    private static void GetAndUpdateTwin() throws IOException, IotHubException {\n+        // Get a Twin and retrieves model Id set by Device client\n+        DeviceTwinDevice twin = new DeviceTwinDevice(deviceId);\n+        twinClient.getTwin(twin);\n+        System.out.println(\"Model Id of this Twin is: \" + twin.getModelId());\n+\n+        // Update the twin - Update the thermostat1 component\n+        twin.setDesiredProperties(CreatePropertyPatch());\n+        System.out.println(\"Updating Device twin property\");\n+        twinClient.updateTwin(twin);\n+\n+        twinClient.getTwin(twin);\n+        System.out.println(\"The updated desired properties: \" + twin.getDesiredProperties().iterator().next().getValue());\n+    }\n+\n+    private static Set<Pair> CreatePropertyPatch()", "originalCommit": "9238951d14854658271888e220a85cf9300f4cad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU0ODkxMg==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r450548912", "bodyText": "Based on discussion, these need to be in a helper class so I will move them.", "author": "vinagesh", "createdAt": "2020-07-07T00:37:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU0ODY0MQ=="}], "type": "inlineReview"}, {"oid": "6cf554f3d8a187ab1b4fab44f5bc2c64188abd26", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/6cf554f3d8a187ab1b4fab44f5bc2c64188abd26", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T04:18:45Z", "type": "forcePushed"}, {"oid": "050ff763f171434c4c5dcedf5cd2ddfe1525ae8e", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/050ff763f171434c4c5dcedf5cd2ddfe1525ae8e", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T04:21:34Z", "type": "forcePushed"}, {"oid": "952a50df9925165c507a7c1c603be60c7047453b", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/952a50df9925165c507a7c1c603be60c7047453b", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T04:34:55Z", "type": "forcePushed"}, {"oid": "16d10631d7b72ba1749830505b4e97ba0f193563", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/16d10631d7b72ba1749830505b4e97ba0f193563", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T04:35:13Z", "type": "forcePushed"}, {"oid": "fc954c6abad94f033f091d8f67dde3dd770b7ee1", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/fc954c6abad94f033f091d8f67dde3dd770b7ee1", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T04:36:39Z", "type": "forcePushed"}, {"oid": "0ff65e4c3ec563484d4ef11bf4a1059380bb434d", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/0ff65e4c3ec563484d4ef11bf4a1059380bb434d", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T04:42:40Z", "type": "forcePushed"}, {"oid": "93a4d39192526f7219c5d4595506fdc0d732b10f", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/93a4d39192526f7219c5d4595506fdc0d732b10f", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T04:43:44Z", "type": "forcePushed"}, {"oid": "e64fed3858c542aa3f80aed1117da27df72da933", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/e64fed3858c542aa3f80aed1117da27df72da933", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T04:45:11Z", "type": "forcePushed"}, {"oid": "e7594692868ffedc7340aceb7a986078f95c52d0", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/e7594692868ffedc7340aceb7a986078f95c52d0", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T04:45:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAwNDE3MQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451004171", "bodyText": "I have plaved the helper under the package com.microsoft.azure.sdk.iot.pnphelpers: https://github.com/Azure/azure-iot-sdk-java/blob/abmisr/thermostat/pnp/src/main/java/com/microsoft/azure/sdk/iot/pnphelpers/PnpHelper.java\nWhat do you think of this as the folder/ package structure?\nI would rather not have the word \"samples\" in the package and folder path.", "author": "abhipsaMisra", "createdAt": "2020-07-07T16:47:21Z", "path": "pnp-helper/src/main/java/samples/com/microsoft/azure/sdk/iot/helper/PnpHelper.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package samples.com.microsoft.azure.sdk.iot.helper;", "originalCommit": "e7594692868ffedc7340aceb7a986078f95c52d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyNjk5Nw==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451026997", "bodyText": "Don't forget to include the log4j.properties file for this new sample so that users who run it can easily get logs from the SDK. The other other samples each have a resources folder that you can copy to do that\n\nLet me take a look at that. Thanks. Will reach out if I have any questions.", "author": "vinagesh", "createdAt": "2020-07-07T17:26:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAwNDE3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyOTg2Nw==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451029867", "bodyText": "I have plaved the helper under the package com.microsoft.azure.sdk.iot.pnphelpers: https://github.com/Azure/azure-iot-sdk-java/blob/abmisr/thermostat/pnp/src/main/java/com/microsoft/azure/sdk/iot/pnphelpers/PnpHelper.java\nWhat do you think of this as the folder/ package structure?\nI would rather not have the word \"samples\" in the package and folder path.\n\nI think it is a good idea to get rid of the samples as we discussed that this might be released separately. And we can use the pnp-helper for the module name. I believe your change will go in first so make those changes and I can rebase. I'll just add my helper functions to that.", "author": "vinagesh", "createdAt": "2020-07-07T17:31:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAwNDE3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAwNzc3MQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451007771", "bodyText": "nit: this can also be done in a single statement:\nreturn Collections.singleton(new Pair(properyName, propertyValue));", "author": "abhipsaMisra", "createdAt": "2020-07-07T16:53:29Z", "path": "pnp-helper/src/main/java/samples/com/microsoft/azure/sdk/iot/helper/PnpHelper.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package samples.com.microsoft.azure.sdk.iot.helper;\n+\n+import com.google.gson.JsonObject;\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+\n+public class PnpHelper {\n+    public static Set<Pair> CreatePropertyPatch(String propertyName, String propertyValue)\n+    {\n+        // The update patch for a property on the root level or a device without component should be in the format:\n+        // \"desired\": {\n+        //    \"propertyName\": {\n+        //      \"value\": \"hello\"\n+        //  }\n+        Set<Pair> desiredProperties = new HashSet<Pair>();\n+        desiredProperties.add(new Pair(propertyName, propertyValue));\n+        return desiredProperties;", "originalCommit": "e7594692868ffedc7340aceb7a986078f95c52d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyMjY0Ng==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451022646", "bodyText": "Cool! Good to know :)", "author": "vinagesh", "createdAt": "2020-07-07T17:18:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAwNzc3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAwODEyNA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451008124", "bodyText": "nice!", "author": "abhipsaMisra", "createdAt": "2020-07-07T16:54:10Z", "path": "pnp-helper/src/main/java/samples/com/microsoft/azure/sdk/iot/helper/PnpHelper.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package samples.com.microsoft.azure.sdk.iot.helper;\n+\n+import com.google.gson.JsonObject;\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+\n+public class PnpHelper {\n+    public static Set<Pair> CreatePropertyPatch(String propertyName, String propertyValue)\n+    {\n+        // The update patch for a property on the root level or a device without component should be in the format:\n+        // \"desired\": {", "originalCommit": "e7594692868ffedc7340aceb7a986078f95c52d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAwODQzOA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451008438", "bodyText": "I've added doc comments for these public helpers: https://github.com/Azure/azure-iot-sdk-java/blob/abmisr/thermostat/pnp/src/main/java/com/microsoft/azure/sdk/iot/pnphelpers/PnpHelper.java#L66-L76", "author": "abhipsaMisra", "createdAt": "2020-07-07T16:54:40Z", "path": "pnp-helper/src/main/java/samples/com/microsoft/azure/sdk/iot/helper/PnpHelper.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package samples.com.microsoft.azure.sdk.iot.helper;\n+\n+import com.google.gson.JsonObject;\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+\n+public class PnpHelper {\n+    public static Set<Pair> CreatePropertyPatch(String propertyName, String propertyValue)", "originalCommit": "e7594692868ffedc7340aceb7a986078f95c52d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0Mzg0MA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451043840", "bodyText": "I will anyway have to rebase so this is mostly a place holder.", "author": "vinagesh", "createdAt": "2020-07-07T17:55:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAwODQzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAwOTA3OA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451009078", "bodyText": "nit: same, can be replaced by returning Collections.singleton().", "author": "abhipsaMisra", "createdAt": "2020-07-07T16:55:45Z", "path": "pnp-helper/src/main/java/samples/com/microsoft/azure/sdk/iot/helper/PnpHelper.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package samples.com.microsoft.azure.sdk.iot.helper;\n+\n+import com.google.gson.JsonObject;\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+\n+public class PnpHelper {\n+    public static Set<Pair> CreatePropertyPatch(String propertyName, String propertyValue)\n+    {\n+        // The update patch for a property on the root level or a device without component should be in the format:\n+        // \"desired\": {\n+        //    \"propertyName\": {\n+        //      \"value\": \"hello\"\n+        //  }\n+        Set<Pair> desiredProperties = new HashSet<Pair>();\n+        desiredProperties.add(new Pair(propertyName, propertyValue));\n+        return desiredProperties;\n+    }\n+\n+    public static Set<Pair> CreatePropertyPatch(String propertyName, String propertyValue, String componentName)\n+    {\n+        // The update patch for a property of a component should be in the format:\n+        // \"desired\": {\n+        //    \"componentName\": {\n+        //      \"__t\": \"c\",\n+        //      \"propertyName\": {\n+        //        \"value\": \"hello\"\n+        //      }\n+        //  }\n+        JsonObject patchJson = new JsonObject();\n+        // The following property is required to specify that the update is for a component and not root level.\n+        patchJson.addProperty(\"__t\", \"c\");\n+        patchJson.addProperty(propertyName, propertyValue);\n+\n+        Set<Pair> desiredProperties = new HashSet<Pair>();\n+        Pair desiredProperty = new Pair(\n+                componentName,\n+                patchJson);\n+        desiredProperties.add(desiredProperty);\n+\n+        return desiredProperties;\n+    }\n+\n+    public static Map<String, Object> CreateMethodPayload(String methodValue)\n+    {\n+        // The method payload should be in the following format:\n+        // \"payload\": {\n+        //   \"commandRequest\": {\n+        //   \"value\": \"hello\"\n+        //  }\n+        JsonObject commandPayload = new JsonObject();\n+        commandPayload.addProperty(\"value\", methodValue);\n+        Map<String, Object> payload = new HashMap<String, Object>()", "originalCommit": "e7594692868ffedc7340aceb7a986078f95c52d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6766c1a29aad186a2bd0e74313f3d6b33b316989", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/6766c1a29aad186a2bd0e74313f3d6b33b316989", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T19:38:33Z", "type": "forcePushed"}, {"oid": "ff44191af8decfeb9db7e3be50d73f1cad548b50", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/ff44191af8decfeb9db7e3be50d73f1cad548b50", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T19:41:40Z", "type": "forcePushed"}, {"oid": "9ff8666c13ecea440252a043811f91c3369e9de0", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/9ff8666c13ecea440252a043811f91c3369e9de0", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-07T22:37:21Z", "type": "forcePushed"}, {"oid": "fa2010ae9634a9c42fbb454b4255e59b6fb737c8", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/fa2010ae9634a9c42fbb454b4255e59b6fb737c8", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T00:41:30Z", "type": "forcePushed"}, {"oid": "d57d2e67bf52dd6fc34ae097f1939e1bbf4a5a15", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/d57d2e67bf52dd6fc34ae097f1939e1bbf4a5a15", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T00:54:01Z", "type": "forcePushed"}, {"oid": "b9f61d7e2bc77a10762052cf57c0ebd1226341f6", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/b9f61d7e2bc77a10762052cf57c0ebd1226341f6", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T00:56:49Z", "type": "forcePushed"}, {"oid": "aff97a571b15490ea3d27aff8447c5ef7d221750", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/aff97a571b15490ea3d27aff8447c5ef7d221750", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T00:58:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIzNTIxMQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451235211", "bodyText": "is this code similar to line 16?", "author": "bikamani", "createdAt": "2020-07-08T01:45:09Z", "path": "pnp-helper/src/main/java/com/microsoft/azure/sdk/iot/PnpHelper.java", "diffHunk": "@@ -0,0 +1,63 @@\n+package com.microsoft.azure.sdk.iot;\n+\n+import com.google.gson.JsonObject;\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+\n+import java.util.*;\n+\n+public class PnpHelper {\n+    public static Set<Pair> CreatePropertyPatch(String propertyName, String propertyValue)\n+    {\n+        // The update patch for a property on the root level or a device without component should be in the format:\n+        // \"desired\": {\n+        //    \"propertyName\": {\n+        //      \"value\": \"hello\"\n+        //  }\n+        return Collections.singleton(new Pair(propertyName, propertyValue));\n+    }\n+\n+    public static Set<Pair> CreatePropertyPatch(String propertyName, String propertyValue, String componentName)\n+    {\n+        // The update patch for a property of a component should be in the format:\n+        // \"desired\": {\n+        //    \"componentName\": {\n+        //      \"__t\": \"c\",\n+        //      \"propertyName\": {\n+        //        \"value\": \"hello\"\n+        //      }\n+        //  }\n+        JsonObject patchJson = new JsonObject();\n+        // The following property is required to specify that the update is for a component and not root level.\n+        patchJson.addProperty(\"__t\", \"c\");\n+        patchJson.addProperty(propertyName, propertyValue);\n+\n+        Set<Pair> desiredProperties = new HashSet<Pair>()\n+        {\n+            {\n+                new Pair(componentName, patchJson);", "originalCommit": "aff97a571b15490ea3d27aff8447c5ef7d221750", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgyOTY0NQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451829645", "bodyText": "All this has changed due to most recent changes.", "author": "vinagesh", "createdAt": "2020-07-08T21:15:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIzNTIxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIzNjI5NA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451236294", "bodyText": "I was wondering if this should be on top. That's the approach I took in C#.\nDon't have a strong opinion though", "author": "bikamani", "createdAt": "2020-07-08T01:49:33Z", "path": "service/iot-service-samples/pnp-service-sample/TemperatureController/src/main/java/samples/com/microsoft/azure/sdk/iot/TemperatureController.java", "diffHunk": "@@ -0,0 +1,100 @@\n+package samples.com.microsoft.azure.sdk.iot;\n+\n+import com.microsoft.azure.sdk.iot.PnpHelper;\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+import com.microsoft.azure.sdk.iot.service.exceptions.IotHubException;\n+\n+import java.io.IOException;\n+import java.time.ZoneOffset;\n+import java.time.ZonedDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.util.concurrent.TimeUnit;\n+\n+// This sample uses the model - https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/samples/TemperatureController.json.\n+public class TemperatureController {\n+    // Get connection string and device id inputs.\n+    private static final String iotHubConnectionString  = System.getenv(\"IOTHUB_CONNECTION_STRING\");\n+    private static final String deviceId = System.getenv(\"DEVICE_ID\");\n+\n+    private static DeviceTwin twinClient;\n+    private static DeviceMethod methodClient;\n+\n+    public static void main(String[] args) throws Exception {\n+        RunSample();\n+    }\n+\n+    private static void RunSample() throws IOException, IotHubException {\n+        System.out.println(\"Initialize the service client.\");\n+        InitializeServiceClient();\n+\n+        System.out.println(\"Get Twin model Id and Update Twin\");\n+        GetAndUpdateTwin();\n+\n+        System.out.println(\"Invoke a method on component\");\n+        InvokeMethodOnComponent();\n+\n+        System.out.println(\"Invoke a method on root level\");\n+        InvokeMethodOnRootLevel();\n+    }\n+\n+    private static void InitializeServiceClient() throws IOException {\n+        twinClient = DeviceTwin.createFromConnectionString(iotHubConnectionString);\n+        methodClient = DeviceMethod.createFromConnectionString(iotHubConnectionString);\n+    }\n+\n+    private static void GetAndUpdateTwin() throws IOException, IotHubException {\n+        // Get the twin and retrieve model Id set by Device client.\n+        DeviceTwinDevice twin = new DeviceTwinDevice(deviceId);\n+        twinClient.getTwin(twin);\n+        System.out.println(\"Model Id of this Twin is: \" + twin.getModelId());\n+\n+        // Update the twin for thermostat1 component.\n+        System.out.println(\"Updating Device twin property\");\n+        String propertyName = \"targetTemperature\";\n+        String propertyValue = \"60\";", "originalCommit": "aff97a571b15490ea3d27aff8447c5ef7d221750", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgzMTM5OA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451831398", "bodyText": "I have kept it as is for now. We can see later which way to go.", "author": "vinagesh", "createdAt": "2020-07-08T21:19:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIzNjI5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIzNjY4NA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451236684", "bodyText": "This makes me think if we really need no component sample \ud83d\ude04", "author": "bikamani", "createdAt": "2020-07-08T01:51:03Z", "path": "service/iot-service-samples/pnp-service-sample/TemperatureController/src/main/java/samples/com/microsoft/azure/sdk/iot/TemperatureController.java", "diffHunk": "@@ -0,0 +1,100 @@\n+package samples.com.microsoft.azure.sdk.iot;\n+\n+import com.microsoft.azure.sdk.iot.PnpHelper;\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+import com.microsoft.azure.sdk.iot.service.exceptions.IotHubException;\n+\n+import java.io.IOException;\n+import java.time.ZoneOffset;\n+import java.time.ZonedDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.util.concurrent.TimeUnit;\n+\n+// This sample uses the model - https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/samples/TemperatureController.json.\n+public class TemperatureController {\n+    // Get connection string and device id inputs.\n+    private static final String iotHubConnectionString  = System.getenv(\"IOTHUB_CONNECTION_STRING\");\n+    private static final String deviceId = System.getenv(\"DEVICE_ID\");\n+\n+    private static DeviceTwin twinClient;\n+    private static DeviceMethod methodClient;\n+\n+    public static void main(String[] args) throws Exception {\n+        RunSample();\n+    }\n+\n+    private static void RunSample() throws IOException, IotHubException {\n+        System.out.println(\"Initialize the service client.\");\n+        InitializeServiceClient();\n+\n+        System.out.println(\"Get Twin model Id and Update Twin\");\n+        GetAndUpdateTwin();\n+\n+        System.out.println(\"Invoke a method on component\");\n+        InvokeMethodOnComponent();\n+\n+        System.out.println(\"Invoke a method on root level\");\n+        InvokeMethodOnRootLevel();\n+    }\n+\n+    private static void InitializeServiceClient() throws IOException {\n+        twinClient = DeviceTwin.createFromConnectionString(iotHubConnectionString);\n+        methodClient = DeviceMethod.createFromConnectionString(iotHubConnectionString);\n+    }\n+\n+    private static void GetAndUpdateTwin() throws IOException, IotHubException {\n+        // Get the twin and retrieve model Id set by Device client.\n+        DeviceTwinDevice twin = new DeviceTwinDevice(deviceId);\n+        twinClient.getTwin(twin);\n+        System.out.println(\"Model Id of this Twin is: \" + twin.getModelId());\n+\n+        // Update the twin for thermostat1 component.\n+        System.out.println(\"Updating Device twin property\");\n+        String propertyName = \"targetTemperature\";\n+        String propertyValue = \"60\";\n+        String componentName = \"thermostat1\";\n+        twin.setDesiredProperties(PnpHelper.CreatePropertyPatch(propertyName, propertyValue, componentName));\n+        twinClient.updateTwin(twin);\n+\n+        // Get the updated twin properties.\n+        twinClient.getTwin(twin);\n+        System.out.println(\"The updated desired properties: \" + twin.getDesiredProperties().iterator().next().getValue());\n+    }\n+\n+    private static void InvokeMethodOnRootLevel() throws IOException, IotHubException {", "originalCommit": "aff97a571b15490ea3d27aff8447c5ef7d221750", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgyOTcxNw==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/841#discussion_r451829717", "bodyText": "ha ha :)", "author": "vinagesh", "createdAt": "2020-07-08T21:15:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIzNjY4NA=="}], "type": "inlineReview"}, {"oid": "49e95db7e68e888fed75bf8d7efe24bec5dfb5e9", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/49e95db7e68e888fed75bf8d7efe24bec5dfb5e9", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T05:35:02Z", "type": "forcePushed"}, {"oid": "862be06470742e96f430e35021514986463f61a9", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/862be06470742e96f430e35021514986463f61a9", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T05:42:19Z", "type": "forcePushed"}, {"oid": "cfff0ea1c8767802611f17d102dd646e5758d249", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/cfff0ea1c8767802611f17d102dd646e5758d249", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T05:45:19Z", "type": "forcePushed"}, {"oid": "0f2c336421682cad40d60c5118ed817ce733964c", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/0f2c336421682cad40d60c5118ed817ce733964c", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T19:04:39Z", "type": "forcePushed"}, {"oid": "33110d7dd3b495f3086d33f7aee1469d9a7b053d", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/33110d7dd3b495f3086d33f7aee1469d9a7b053d", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T20:52:14Z", "type": "forcePushed"}, {"oid": "e1cb8385041b8638554530695473f025b645f85e", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/e1cb8385041b8638554530695473f025b645f85e", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T20:53:11Z", "type": "forcePushed"}, {"oid": "29b7aac75cbc8aebd0ca02e4d48ac435c10b33ca", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/29b7aac75cbc8aebd0ca02e4d48ac435c10b33ca", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T21:14:37Z", "type": "forcePushed"}, {"oid": "d31fa16021325d1204dd8674aba90a32d155a3b2", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/d31fa16021325d1204dd8674aba90a32d155a3b2", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T21:18:36Z", "type": "forcePushed"}, {"oid": "1f1bc25383ff9921b8557662dc84d7de9ddc20b2", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/1f1bc25383ff9921b8557662dc84d7de9ddc20b2", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T21:22:24Z", "type": "forcePushed"}, {"oid": "bbc489c885c11f93ef0aa1bb2c35e569497b2d16", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/bbc489c885c11f93ef0aa1bb2c35e569497b2d16", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T21:25:19Z", "type": "commit"}, {"oid": "bbc489c885c11f93ef0aa1bb2c35e569497b2d16", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/bbc489c885c11f93ef0aa1bb2c35e569497b2d16", "message": "feat(samples): Updating and adding samples for pnp summer refresh", "committedDate": "2020-07-08T21:25:19Z", "type": "forcePushed"}]}