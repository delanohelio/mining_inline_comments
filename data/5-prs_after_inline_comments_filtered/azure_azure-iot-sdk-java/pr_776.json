{"pr_number": 776, "pr_title": "doc(iot-dev): Add clarification to startDeviceTwin() API docs", "pr_createdAt": "2020-05-12T19:37:11Z", "pr_url": "https://github.com/Azure/azure-iot-sdk-java/pull/776", "timeline": [{"oid": "6099e9a181ad03d21da77ec8402a57133521722d", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/6099e9a181ad03d21da77ec8402a57133521722d", "message": "doc(iot-dev): Add clarification to startDeviceTwin() API docs", "committedDate": "2020-05-12T19:35:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwMzA5OA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/776#discussion_r424003098", "bodyText": "Shouldn't PATCH return only the patched update?", "author": "abhipsaMisra", "createdAt": "2020-05-12T20:09:26Z", "path": "device/iot-device-client/src/main/java/com/microsoft/azure/sdk/iot/device/DeviceClient.java", "diffHunk": "@@ -463,7 +463,16 @@ public void getDeviceTwin() throws IOException\n     }\n \n     /**\n-     * Starts the device twin.\n+     * Starts the device twin. This device client will receive a callback with the current state of the full twin, including\n+     * reported properties and desired properties. After that callback, this device client will receive a callback\n+     * each time a desired property is updated. That callback will either contain the full desired properties set, or\n+     * only the updated desired property depending on how the desired property was changed. IoT Hub supports a PUT and a PATCH\n+     * on the twin, and the PATCH will cause this device client to receive the full desired properties set. Similarly, the version", "originalCommit": "6099e9a181ad03d21da77ec8402a57133521722d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwNTMyNg==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/776#discussion_r424005326", "bodyText": "From the github issue:\nInitial desired state:\n{ \u201ca\u201d : 1, \u201cb\u201d : 2 }\n\nIf customer sends PATCH { \u201ca\u201d : -1} device will receive { \u201ca\u201d : -1 }. If customer sends PATCH { \u201ca\u201d: 1, \u201cb\u201d: 2 } device will receive { \u201ca\u201d: 1, \u201cb\u201d: 2 }\n\nHaving said that, if customer sends PUT { \u201ca\u201d : 1, \u201cc\u201d : 100 }, device will get { \u201ca\u201d: 1, \u201cb\u201d: null, \u201cc\u201d : 100 }", "author": "abhipsaMisra", "createdAt": "2020-05-12T20:13:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwMzA5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA0MjA3NA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/776#discussion_r424042074", "bodyText": "Interesting, that is what the service team said. I double checked to see how our SDK does desired property updates, and it is a PATCH that causes the device side to get the full desired property update. However, it looks like our service SDK sends the full desired properties set even when patching just one property. That's why our SDK's PATCH behaved like the PUT.\nI'll update the javadoc here and the issue accordingly", "author": "timtay-microsoft", "createdAt": "2020-05-12T21:23:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwMzA5OA=="}], "type": "inlineReview"}, {"oid": "f7d0b213bc23a768ee45561fad7a15b950e8bebc", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/f7d0b213bc23a768ee45561fad7a15b950e8bebc", "message": "got it backwards", "committedDate": "2020-05-12T21:26:17Z", "type": "commit"}, {"oid": "8782b04f09a84089a503ad1cf15dbc1004de2c6d", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/8782b04f09a84089a503ad1cf15dbc1004de2c6d", "message": "extra caveats about how the java service client works", "committedDate": "2020-05-19T22:33:45Z", "type": "commit"}, {"oid": "da1db232b11642f84d164d604f3d2d4928aa4572", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/da1db232b11642f84d164d604f3d2d4928aa4572", "message": "Merge branch 'master' into timtay/twinDoc", "committedDate": "2020-05-19T22:35:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY0NDU5NQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/776#discussion_r427644595", "bodyText": "nit: After that callback is received ...", "author": "abhipsaMisra", "createdAt": "2020-05-19T22:52:04Z", "path": "device/iot-device-client/src/main/java/com/microsoft/azure/sdk/iot/device/DeviceClient.java", "diffHunk": "@@ -463,7 +463,19 @@ public void getDeviceTwin() throws IOException\n     }\n \n     /**\n-     * Starts the device twin.\n+     * Starts the device twin. This device client will receive a callback with the current state of the full twin, including\n+     * reported properties and desired properties. After that callback, this device client will receive a callback", "originalCommit": "da1db232b11642f84d164d604f3d2d4928aa4572", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1f256d6d3aedc3e97ba7c7877eb1a226c8b16109", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/1f256d6d3aedc3e97ba7c7877eb1a226c8b16109", "message": "cr comments", "committedDate": "2020-05-19T22:55:25Z", "type": "commit"}, {"oid": "34e6a0995df01abf04ad5676527a203d5aee5d82", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/34e6a0995df01abf04ad5676527a203d5aee5d82", "message": "more cr comments", "committedDate": "2020-05-19T23:13:02Z", "type": "commit"}]}