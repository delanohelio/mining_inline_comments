{"pr_number": 3120, "pr_title": "optimize: optimize `Configuration` and add unit tests", "pr_createdAt": "2020-09-16T08:27:42Z", "pr_url": "https://github.com/seata/seata/pull/3120", "timeline": [{"oid": "0fe4ee3729dea9638a57bb77ac3b8a1cd3343ecd", "url": "https://github.com/seata/seata/commit/0fe4ee3729dea9638a57bb77ac3b8a1cd3343ecd", "message": "feature: Configuration support getArray and getList", "committedDate": "2020-09-16T08:23:28Z", "type": "commit"}, {"oid": "9c997837fd5d356e1ef0ee3d23563fd3be2ca012", "url": "https://github.com/seata/seata/commit/9c997837fd5d356e1ef0ee3d23563fd3be2ca012", "message": "add unit test `ConfigurationTest`", "committedDate": "2020-09-16T09:57:44Z", "type": "commit"}, {"oid": "516ba0d7b2f872b31d909476f8e2122951de702d", "url": "https://github.com/seata/seata/commit/516ba0d7b2f872b31d909476f8e2122951de702d", "message": "optimize code", "committedDate": "2020-09-16T10:00:40Z", "type": "commit"}, {"oid": "bb3e91ded95120bad3af18b447e87793ad3980ad", "url": "https://github.com/seata/seata/commit/bb3e91ded95120bad3af18b447e87793ad3980ad", "message": "\u8c03\u6574\u6d4b\u8bd5\u7528\u4f8b\u3002", "committedDate": "2020-09-16T10:16:31Z", "type": "commit"}, {"oid": "e4fe5dee635c12155619510c0c0ad74081c76bda", "url": "https://github.com/seata/seata/commit/e4fe5dee635c12155619510c0c0ad74081c76bda", "message": "fix unit test", "committedDate": "2020-09-16T10:26:31Z", "type": "commit"}, {"oid": "f4b601e0dc04e83b60206d0fb27c94883b7e5a4a", "url": "https://github.com/seata/seata/commit/f4b601e0dc04e83b60206d0fb27c94883b7e5a4a", "message": "fix unit test", "committedDate": "2020-09-16T11:20:18Z", "type": "commit"}, {"oid": "aec43efcb371dc9145ca67f92e6465dc7792316e", "url": "https://github.com/seata/seata/commit/aec43efcb371dc9145ca67f92e6465dc7792316e", "message": "fix unit test", "committedDate": "2020-09-16T11:31:43Z", "type": "commit"}, {"oid": "4b2f2883b8ac33ea34986e697b5a922ade3a8a68", "url": "https://github.com/seata/seata/commit/4b2f2883b8ac33ea34986e697b5a922ade3a8a68", "message": "fix unit test", "committedDate": "2020-09-16T11:53:23Z", "type": "commit"}, {"oid": "d070ebb8ba103e6472dd88174cc20119d4244ec4", "url": "https://github.com/seata/seata/commit/d070ebb8ba103e6472dd88174cc20119d4244ec4", "message": "Merge branch 'develop' into optimize-Configuration", "committedDate": "2020-09-17T07:32:09Z", "type": "commit"}, {"oid": "3ade79bf231e044e2506ad79f173dfbe177f4e1f", "url": "https://github.com/seata/seata/commit/3ade79bf231e044e2506ad79f173dfbe177f4e1f", "message": "Merge remote-tracking branch 'remotes/upstream/develop' into optimize-Configuration", "committedDate": "2020-09-25T09:51:30Z", "type": "commit"}, {"oid": "1a28e27761e3cfc40f5ecefa6f0bd5a5d14c5622", "url": "https://github.com/seata/seata/commit/1a28e27761e3cfc40f5ecefa6f0bd5a5d14c5622", "message": "add new method Configuration.getEnum()", "committedDate": "2020-09-25T11:13:35Z", "type": "commit"}, {"oid": "70d0aedd7ec081b7047b01f1c7937a1579751c2a", "url": "https://github.com/seata/seata/commit/70d0aedd7ec081b7047b01f1c7937a1579751c2a", "message": "fix unit test", "committedDate": "2020-09-25T11:23:18Z", "type": "commit"}, {"oid": "f22c7a377aa3a1f3e3a550934a73c8363139d369", "url": "https://github.com/seata/seata/commit/f22c7a377aa3a1f3e3a550934a73c8363139d369", "message": "fix unit test", "committedDate": "2020-09-25T11:26:55Z", "type": "commit"}, {"oid": "17e1f743cc2752d0779c33ea85b3e0179f106ddb", "url": "https://github.com/seata/seata/commit/17e1f743cc2752d0779c33ea85b3e0179f106ddb", "message": "fix unit test", "committedDate": "2020-09-27T04:26:24Z", "type": "commit"}, {"oid": "f32ea8f677c60414a048e3d597cd5b43912a7b6e", "url": "https://github.com/seata/seata/commit/f32ea8f677c60414a048e3d597cd5b43912a7b6e", "message": "fix bug for SpringBootConfigurationProvider", "committedDate": "2020-09-27T10:37:55Z", "type": "commit"}, {"oid": "d2083f56f56ef4b7277e275d4810df4464454f1c", "url": "https://github.com/seata/seata/commit/d2083f56f56ef4b7277e275d4810df4464454f1c", "message": "\u5c0f\u8c03\u6574\u3002", "committedDate": "2020-09-27T10:55:32Z", "type": "commit"}, {"oid": "6eaf2de84d4618a778de18f9d678ac0eb8da250f", "url": "https://github.com/seata/seata/commit/6eaf2de84d4618a778de18f9d678ac0eb8da250f", "message": "Merge branch 'develop' into optimize-Configuration", "committedDate": "2020-10-21T02:08:05Z", "type": "commit"}, {"oid": "ff0a04e823af92ae969098fc1bf09492d1154a9f", "url": "https://github.com/seata/seata/commit/ff0a04e823af92ae969098fc1bf09492d1154a9f", "message": "fix style", "committedDate": "2020-10-21T07:49:20Z", "type": "commit"}, {"oid": "c742129dfed3a2ba1034fb3e0cc2a68d13feab43", "url": "https://github.com/seata/seata/commit/c742129dfed3a2ba1034fb3e0cc2a68d13feab43", "message": "Merge remote-tracking branch 'remotes/upstream/develop' into optimize-Configuration\n\n# Conflicts:\n#\tconfig/seata-config-custom/src/test/resources/custom_for_test.properties\n#\tcore/src/main/java/io/seata/core/store/db/AbstractDataSourceProvider.java\n#\tseata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/provider/SpringBootConfigurationProvider.java", "committedDate": "2021-05-13T01:43:45Z", "type": "commit"}, {"oid": "59cca078d2e35c9a27f078c11261ba12a056edd5", "url": "https://github.com/seata/seata/commit/59cca078d2e35c9a27f078c11261ba12a056edd5", "message": "\u6b64PR\u5148\u6539\u4e3a\u4f18\u5316\u7684PR\uff0c\u540e\u7eed\u518d\u63d0\u914d\u7f6e\u4e2d\u5fc3\u6539\u9020\u7684PR\u3002", "committedDate": "2021-05-13T02:13:46Z", "type": "commit"}, {"oid": "3b73d4fcbe107c5c327ec22478d9a24b86c407d0", "url": "https://github.com/seata/seata/commit/3b73d4fcbe107c5c327ec22478d9a24b86c407d0", "message": "modify 1.5.0.md", "committedDate": "2021-05-13T02:18:51Z", "type": "commit"}, {"oid": "e01e846fac9aba5228493794981c53747c70396a", "url": "https://github.com/seata/seata/commit/e01e846fac9aba5228493794981c53747c70396a", "message": "revert code", "committedDate": "2021-05-13T02:26:10Z", "type": "commit"}, {"oid": "a8f4a2f4eb118f2724abb3708a9145c1c9731f76", "url": "https://github.com/seata/seata/commit/a8f4a2f4eb118f2724abb3708a9145c1c9731f76", "message": "modify 1.5.0.md", "committedDate": "2021-05-13T02:32:33Z", "type": "commit"}, {"oid": "13e54f5fb94f645e0478d6e6afc607efe4dd92b1", "url": "https://github.com/seata/seata/commit/13e54f5fb94f645e0478d6e6afc607efe4dd92b1", "message": "\u79fb\u9664\u591a\u4f59\u7684\u6d4b\u8bd5\u7528\u4f8b", "committedDate": "2021-05-13T03:14:03Z", "type": "commit"}, {"oid": "3eb714af6bb27e7e6ade352644a1df1a5eef65e9", "url": "https://github.com/seata/seata/commit/3eb714af6bb27e7e6ade352644a1df1a5eef65e9", "message": "Merge branch 'develop' into optimize-Configuration", "committedDate": "2021-05-14T14:28:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMzA1MDY1MQ==", "url": "https://github.com/seata/seata/pull/3120#discussion_r633050651", "bodyText": "\u7528Optional\u4f1a\u4e0d\u4f1a\u597d\u70b9?", "author": "a364176773", "createdAt": "2021-05-16T06:38:50Z", "path": "config/seata-config-core/src/main/java/io/seata/config/AbstractConfiguration.java", "diffHunk": "@@ -43,13 +55,13 @@ public short getShort(String dataId, short defaultValue) {\n \n     @Override\n     public short getShort(String dataId) {\n-        return getShort(dataId, (short) 0);\n+        return getShort(dataId, DEFAULT_SHORT);\n     }\n \n     @Override\n     public int getInt(String dataId, int defaultValue, long timeoutMills) {\n-        String result = getConfig(dataId, String.valueOf(defaultValue), timeoutMills);\n-        return Integer.parseInt(result);\n+        String result = getConfig(dataId, timeoutMills);\n+        return StringUtils.isBlank(result) ? defaultValue : Integer.parseInt(result);", "originalCommit": "3eb714af6bb27e7e6ade352644a1df1a5eef65e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMzEwODk1OA==", "url": "https://github.com/seata/seata/pull/3120#discussion_r633108958", "bodyText": "Optional\u53ea\u6709ofNullable\u65b9\u6cd5\uff0c\u6ca1\u6709ofBlankable\u65b9\u6cd5\u5440\u3002", "author": "wangliang181230", "createdAt": "2021-05-16T16:16:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMzA1MDY1MQ=="}], "type": "inlineReview"}, {"oid": "f9f55658325d9fae5c173e1b18721a99bfd23679", "url": "https://github.com/seata/seata/commit/f9f55658325d9fae5c173e1b18721a99bfd23679", "message": "Merge branch 'develop' into optimize-Configuration", "committedDate": "2021-05-20T03:42:38Z", "type": "commit"}, {"oid": "f9c272cd18b9342fd707094096b0033d122466bb", "url": "https://github.com/seata/seata/commit/f9c272cd18b9342fd707094096b0033d122466bb", "message": "optimize code", "committedDate": "2021-05-20T04:00:56Z", "type": "commit"}, {"oid": "e667f3e82a0830ce44169b2330fd911285f2f95c", "url": "https://github.com/seata/seata/commit/e667f3e82a0830ce44169b2330fd911285f2f95c", "message": "Merge branch 'develop' into optimize-Configuration", "committedDate": "2021-05-21T07:10:46Z", "type": "commit"}, {"oid": "d944dec3a08e310bf31884e9edbea4308633f9a8", "url": "https://github.com/seata/seata/commit/d944dec3a08e310bf31884e9edbea4308633f9a8", "message": "Merge branch 'develop' into optimize-Configuration", "committedDate": "2021-05-25T03:02:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzODQxOTY3Nw==", "url": "https://github.com/seata/seata/pull/3120#discussion_r638419677", "bodyText": "(short)1->(short) 1", "author": "xingfudeshi", "createdAt": "2021-05-25T03:04:30Z", "path": "config/seata-config-custom/src/test/java/io/seata/config/ConfigurationTest.java", "diffHunk": "@@ -0,0 +1,87 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.config;\n+\n+import java.time.Duration;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+/**\n+ * @author wang.liang\n+ */\n+class ConfigurationTest {\n+\n+    private static final String NULL_POSTFIX = \"_null\";\n+    private static final String DEFAULT_POSTFIX = \"_default\";\n+\n+    private static final String STRING_VALUE = \"aaaa\";\n+    private static final short SHORT_VALUE = (short)1;", "originalCommit": "d944dec3a08e310bf31884e9edbea4308633f9a8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzODQxOTc3Mg==", "url": "https://github.com/seata/seata/pull/3120#discussion_r638419772", "bodyText": "(short)2->(short) 2", "author": "xingfudeshi", "createdAt": "2021-05-25T03:04:54Z", "path": "config/seata-config-custom/src/test/java/io/seata/config/ConfigurationTest.java", "diffHunk": "@@ -0,0 +1,87 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.config;\n+\n+import java.time.Duration;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+/**\n+ * @author wang.liang\n+ */\n+class ConfigurationTest {\n+\n+    private static final String NULL_POSTFIX = \"_null\";\n+    private static final String DEFAULT_POSTFIX = \"_default\";\n+\n+    private static final String STRING_VALUE = \"aaaa\";\n+    private static final short SHORT_VALUE = (short)1;\n+    private static final int INT_VALUE = 2;\n+    private static final long LONG_VALUE = 3L;\n+    private static final Duration DURATION_VALUE = Duration.ofSeconds(4);\n+    private static final boolean BOOLEAN_VALUE = true;\n+\n+    private static final String DEFAULT_STRING_VALUE = \"BBBB\";\n+    private static final short DEFAULT_SHORT_VALUE = (short)2;", "originalCommit": "d944dec3a08e310bf31884e9edbea4308633f9a8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzODQxOTg2OA==", "url": "https://github.com/seata/seata/pull/3120#discussion_r638419868", "bodyText": "(short)0->(short) 0", "author": "xingfudeshi", "createdAt": "2021-05-25T03:05:21Z", "path": "config/seata-config-core/src/main/java/io/seata/config/AbstractConfiguration.java", "diffHunk": "@@ -30,10 +32,20 @@\n      */\n     protected static final long DEFAULT_CONFIG_TIMEOUT = 5 * 1000;\n \n+    /**\n+     * The constant DEFAULT_XXX.\n+     */\n+    public static final short DEFAULT_SHORT = (short)0;", "originalCommit": "d944dec3a08e310bf31884e9edbea4308633f9a8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a106f33c048c99acc13e6d56c7555fcbbcf39b33", "url": "https://github.com/seata/seata/commit/a106f33c048c99acc13e6d56c7555fcbbcf39b33", "message": "Merge branch 'develop' into optimize-Configuration", "committedDate": "2021-05-27T10:43:04Z", "type": "commit"}, {"oid": "6e8cb17a514dfc9a913276a2f0775c079ceeb478", "url": "https://github.com/seata/seata/commit/6e8cb17a514dfc9a913276a2f0775c079ceeb478", "message": "Merge branch 'develop' into optimize-Configuration", "committedDate": "2021-06-04T05:39:54Z", "type": "commit"}, {"oid": "ffe9702649cf6b33dfa51bbacf872b71f1d70257", "url": "https://github.com/seata/seata/commit/ffe9702649cf6b33dfa51bbacf872b71f1d70257", "message": "Merge branch 'develop' into optimize-Configuration", "committedDate": "2021-06-27T16:01:49Z", "type": "commit"}]}