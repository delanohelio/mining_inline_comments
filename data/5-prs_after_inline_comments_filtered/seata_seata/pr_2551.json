{"pr_number": 2551, "pr_title": "bugfix: Saga can't be used when the dataSource is AT's dataSourceProxy", "pr_createdAt": "2020-04-14T11:39:51Z", "pr_url": "https://github.com/seata/seata/pull/2551", "timeline": [{"oid": "78dfbad7c4b9808fa6b52f0a858a161969282d24", "url": "https://github.com/seata/seata/commit/78dfbad7c4b9808fa6b52f0a858a161969282d24", "message": "Merge branch 'develop' into develop", "committedDate": "2020-09-09T07:33:03Z", "type": "commit"}, {"oid": "72931c9f8fc93cb534808f0920f69f6dd730fe24", "url": "https://github.com/seata/seata/commit/72931c9f8fc93cb534808f0920f69f6dd730fe24", "message": "\u6dfb\u52a0 InSagaBranchHandlerInterceptor \u7684\u6d4b\u8bd5\u7528\u4f8b\u3002", "committedDate": "2020-09-10T03:36:39Z", "type": "commit"}, {"oid": "58f1a2960289ced04b6cc554648568627660e218", "url": "https://github.com/seata/seata/commit/58f1a2960289ced04b6cc554648568627660e218", "message": "Merge remote-tracking branch 'origin/develop' into develop2", "committedDate": "2020-09-10T03:37:00Z", "type": "commit"}, {"oid": "6527c8d868c64cbcc8befadc92075b6e7093a0ae", "url": "https://github.com/seata/seata/commit/6527c8d868c64cbcc8befadc92075b6e7093a0ae", "message": "\u79fb\u9664\u6d4b\u8bd5\u7528\u4f8b", "committedDate": "2020-09-10T05:25:00Z", "type": "commit"}, {"oid": "a62004cbb456bbbeba08f75ea24a5307e3362177", "url": "https://github.com/seata/seata/commit/a62004cbb456bbbeba08f75ea24a5307e3362177", "message": "Merge remote-tracking branch 'remotes/upstream/develop' into develop2\n\n# Conflicts:\n#\tcore/src/main/java/io/seata/core/context/RootContext.java\n#\tspring/src/main/java/io/seata/spring/tcc/TccActionInterceptor.java", "committedDate": "2020-09-15T02:52:38Z", "type": "commit"}, {"oid": "47095eabb751d51ca49450ca604bcb77c246cf27", "url": "https://github.com/seata/seata/commit/47095eabb751d51ca49450ca604bcb77c246cf27", "message": "\u5c0f\u8c03\u6574\u3002", "committedDate": "2020-09-15T02:53:29Z", "type": "commit"}, {"oid": "a58e6784462bcce9d5c8b45ea6354f8aa7349959", "url": "https://github.com/seata/seata/commit/a58e6784462bcce9d5c8b45ea6354f8aa7349959", "message": "Merge branch 'develop' into develop", "committedDate": "2020-09-23T03:54:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE4MjY3OQ==", "url": "https://github.com/seata/seata/pull/2551#discussion_r493182679", "bodyText": "finally", "author": "slievrly", "createdAt": "2020-09-23T03:59:15Z", "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/store/db/DbAndReportTcStateLogStore.java", "diffHunk": "@@ -177,6 +178,7 @@ public void recordStateMachineFinished(StateMachineInstance machineInstance, Pro\n                 }\n             }\n             RootContext.unbind();\n+            RootContext.unbindBranchType();", "originalCommit": "a58e6784462bcce9d5c8b45ea6354f8aa7349959", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwNjA2Ng==", "url": "https://github.com/seata/seata/pull/2551#discussion_r493206066", "bodyText": "done", "author": "wangliang181230", "createdAt": "2020-09-23T05:28:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE4MjY3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE4Mzc0NQ==", "url": "https://github.com/seata/seata/pull/2551#discussion_r493183745", "bodyText": "should be the first to execute?", "author": "slievrly", "createdAt": "2020-09-23T04:03:11Z", "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/pcext/interceptors/InSagaBranchHandlerInterceptor.java", "diffHunk": "@@ -0,0 +1,107 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.saga.engine.pcext.interceptors;\n+\n+import io.seata.common.loader.LoadLevel;\n+import io.seata.common.util.StringUtils;\n+import io.seata.core.context.RootContext;\n+import io.seata.core.model.BranchType;\n+import io.seata.saga.engine.exception.EngineExecutionException;\n+import io.seata.saga.engine.pcext.InterceptableStateHandler;\n+import io.seata.saga.engine.pcext.StateHandlerInterceptor;\n+import io.seata.saga.proctrl.ProcessContext;\n+import io.seata.saga.statelang.domain.DomainConstants;\n+import io.seata.saga.statelang.domain.StateMachineInstance;\n+import io.seata.tm.api.GlobalTransaction;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import java.util.Map;\n+\n+/**\n+ * InSagaBranchHandler Interceptor\n+ *\n+ * @author wang.liang\n+ */\n+@LoadLevel(name = \"InSagaBranch\", order = 50)", "originalCommit": "a58e6784462bcce9d5c8b45ea6354f8aa7349959", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwNjQyMg==", "url": "https://github.com/seata/seata/pull/2551#discussion_r493206422", "bodyText": "The first is the smallest order.", "author": "wangliang181230", "createdAt": "2020-09-23T05:29:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE4Mzc0NQ=="}], "type": "inlineReview"}, {"oid": "0551ce11a35f9c083df0faa7a0ef23f85035a8ac", "url": "https://github.com/seata/seata/commit/0551ce11a35f9c083df0faa7a0ef23f85035a8ac", "message": "move the unbind to finally", "committedDate": "2020-09-23T04:20:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwOTE4MA==", "url": "https://github.com/seata/seata/pull/2551#discussion_r493209180", "bodyText": "Why was it placed in  engine-store instead of engine", "author": "slievrly", "createdAt": "2020-09-23T05:39:00Z", "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/pcext/interceptors/InSagaBranchHandlerInterceptor.java", "diffHunk": "@@ -0,0 +1,107 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.saga.engine.pcext.interceptors;", "originalCommit": "0551ce11a35f9c083df0faa7a0ef23f85035a8ac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5cc83de3bbe1f592ad7465dad64571946944c924", "url": "https://github.com/seata/seata/commit/5cc83de3bbe1f592ad7465dad64571946944c924", "message": "\u5141\u8bb8SAGA\u6a21\u5f0f\u4e0eAT\u6a21\u5f0f\u5728\u540c\u4e00\u9879\u76ee\u4e2d\u542f\u7528\u3002", "committedDate": "2020-04-14T09:21:00Z", "type": "commit"}, {"oid": "aa3880ca73bc78bc0a37c553a931cedd02e46f15", "url": "https://github.com/seata/seata/commit/aa3880ca73bc78bc0a37c553a931cedd02e46f15", "message": "\u5141\u8bb8SAGA\u6a21\u5f0f\u4e0eAT\u6a21\u5f0f\u5728\u540c\u4e00\u9879\u76ee\u4e2d\u542f\u7528\u3002", "committedDate": "2020-04-14T10:19:24Z", "type": "commit"}, {"oid": "66527821a4265c3c15a67c2c8839fa11669bfb41", "url": "https://github.com/seata/seata/commit/66527821a4265c3c15a67c2c8839fa11669bfb41", "message": "\u5141\u8bb8SAGA\u6a21\u5f0f\u4e0eAT\u6a21\u5f0f\u5728\u540c\u4e00\u9879\u76ee\u4e2d\u542f\u7528\u3002", "committedDate": "2020-04-14T10:56:42Z", "type": "commit"}, {"oid": "3937ce0b32c80945f89c9bd3d0f8582508a61cea", "url": "https://github.com/seata/seata/commit/3937ce0b32c80945f89c9bd3d0f8582508a61cea", "message": "\u5141\u8bb8SAGA\u6a21\u5f0f\u4e0eAT\u6a21\u5f0f\u5728\u540c\u4e00\u9879\u76ee\u4e2d\u542f\u7528\u3002", "committedDate": "2020-04-14T11:55:40Z", "type": "commit"}, {"oid": "2b941e12c4535558f745572339c9830688657494", "url": "https://github.com/seata/seata/commit/2b941e12c4535558f745572339c9830688657494", "message": "\u5141\u8bb8SAGA\u6a21\u5f0f\u4e0eAT\u6a21\u5f0f\u5728\u540c\u4e00\u9879\u76ee\u4e2d\u542f\u7528\u3002", "committedDate": "2020-04-14T12:03:06Z", "type": "commit"}, {"oid": "c045fa0df03ed0bb27ce37bec810cc895e35bace", "url": "https://github.com/seata/seata/commit/c045fa0df03ed0bb27ce37bec810cc895e35bace", "message": "\u8c03\u6574\u7f29\u8fdb\u3002", "committedDate": "2020-04-14T12:07:16Z", "type": "commit"}, {"oid": "1dad0e90a12cbb33bcb3ba08eaff1d15370a47cc", "url": "https://github.com/seata/seata/commit/1dad0e90a12cbb33bcb3ba08eaff1d15370a47cc", "message": "RootContext.java\uff1achinese to english.\nRootContextTest.java\uff1aadd test method testWithoutGlobalTransaction().", "committedDate": "2020-04-15T01:45:31Z", "type": "commit"}, {"oid": "9094aaa77b1c1d2e5c3c31ea4405399f336ea58b", "url": "https://github.com/seata/seata/commit/9094aaa77b1c1d2e5c3c31ea4405399f336ea58b", "message": "Add ProcessUtil.java description.", "committedDate": "2020-04-15T01:52:15Z", "type": "commit"}, {"oid": "b5e3677d7c4b2c418590979dfc930e1279c644db", "url": "https://github.com/seata/seata/commit/b5e3677d7c4b2c418590979dfc930e1279c644db", "message": "\u4ee3\u7801\u6309p3c\u89c4\u8303\u8c03\u6574\u3002", "committedDate": "2020-04-15T03:57:27Z", "type": "commit"}, {"oid": "988f81bcb74980414c9716bc22622fb378b60060", "url": "https://github.com/seata/seata/commit/988f81bcb74980414c9716bc22622fb378b60060", "message": "\u4ee3\u7801\u6309p3c\u89c4\u8303\u8c03\u6574\u3002", "committedDate": "2020-04-15T04:11:40Z", "type": "commit"}, {"oid": "57d5ec3e6aa5cd2722747819fc8c96ce4e7952fb", "url": "https://github.com/seata/seata/commit/57d5ec3e6aa5cd2722747819fc8c96ce4e7952fb", "message": "1.saga DefaultStateMachineConfig resources \u8d44\u6e90\u6587\u4ef6\u8bfb\u53d6\uff0c\u652f\u6301\u901a\u914d\u7b26\u914d\u7f6e.\n2.\u6dfb\u52a0SeataSagaAutoConfiguration\u7c7b\uff08\u9ed8\u8ba4\u7981\u7528\uff09.\n3.\u4ee3\u7801\u6309p3c\u89c4\u8303\u8c03\u6574.", "committedDate": "2020-04-15T10:42:31Z", "type": "commit"}, {"oid": "57b93652da6b2b78d1905b9c868d0cbc24a4f54d", "url": "https://github.com/seata/seata/commit/57b93652da6b2b78d1905b9c868d0cbc24a4f54d", "message": "\u5c06SeataSagaAutoConfiguration\u6dfb\u52a0\u5230spring.factories\u4e2d\u3002", "committedDate": "2020-04-15T10:48:12Z", "type": "commit"}, {"oid": "8a4b659dff2d765a3be3acedfdee94428f40580b", "url": "https://github.com/seata/seata/commit/8a4b659dff2d765a3be3acedfdee94428f40580b", "message": "seata.saga.state-machine.enable-async\u914d\u7f6e\u63d0\u793a\u4fe1\u606f\u4e2d\u7684\u9ed8\u8ba4\u503c\u53cd\u4e86\uff0c\u8c03\u6574\u8fc7\u6765\u3002", "committedDate": "2020-04-15T11:23:48Z", "type": "commit"}, {"oid": "7137342518a98067af4bb7b0cd1b7c6c8665b472", "url": "https://github.com/seata/seata/commit/7137342518a98067af4bb7b0cd1b7c6c8665b472", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-15T11:58:47Z", "type": "commit"}, {"oid": "a10db91b471165517a619acd3ccb9a5ca2beb017", "url": "https://github.com/seata/seata/commit/a10db91b471165517a619acd3ccb9a5ca2beb017", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-16T01:20:04Z", "type": "commit"}, {"oid": "fdc7dd7aa73c81952e9f44e9619b1c08d4eadd9c", "url": "https://github.com/seata/seata/commit/fdc7dd7aa73c81952e9f44e9619b1c08d4eadd9c", "message": "\u6dfb\u52a0\u66f4\u591a\u914d\u7f6e\u63d0\u793a\u4fe1\u606f", "committedDate": "2020-04-16T02:24:57Z", "type": "commit"}, {"oid": "b61efd1cde5f503c936eada8b9873c1a12667de0", "url": "https://github.com/seata/seata/commit/b61efd1cde5f503c936eada8b9873c1a12667de0", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-16T04:31:03Z", "type": "commit"}, {"oid": "d358e0d2a44488fbfe7eb3fa7fa929ade615894c", "url": "https://github.com/seata/seata/commit/d358e0d2a44488fbfe7eb3fa7fa929ade615894c", "message": "\u4fee\u590d\u95ee\u9898\uff1a\u5f53saga\u4e8b\u52a1\u6267\u884c\u5931\u8d25\u540e\uff0c\u65e0\u6cd5\u4eceStateMachineInstance\u4e2d\u83b7\u53d6\u5230Exception\u3002", "committedDate": "2020-04-16T07:17:26Z", "type": "commit"}, {"oid": "e18a01d71a24d68c8a0b59980cffa17b909b5d94", "url": "https://github.com/seata/seata/commit/e18a01d71a24d68c8a0b59980cffa17b909b5d94", "message": "Merge remote-tracking branch 'origin/develop' into develop", "committedDate": "2020-04-16T07:17:38Z", "type": "commit"}, {"oid": "57823b5bca4037ced5bbbcca610f14ffd8c175f4", "url": "https://github.com/seata/seata/commit/57823b5bca4037ced5bbbcca610f14ffd8c175f4", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-16T10:27:28Z", "type": "commit"}, {"oid": "63d743d149d454831881f58913c4b3355b455771", "url": "https://github.com/seata/seata/commit/63d743d149d454831881f58913c4b3355b455771", "message": "\u8ba9\u91cd\u5199\u66f4\u7b80\u5355", "committedDate": "2020-04-16T21:15:29Z", "type": "commit"}, {"oid": "ad1c2dd27fd166f0c9f83cd5585d7f62b8f4edd3", "url": "https://github.com/seata/seata/commit/ad1c2dd27fd166f0c9f83cd5585d7f62b8f4edd3", "message": "\u8ba9\u91cd\u5199\u66f4\u7b80\u5355", "committedDate": "2020-04-16T21:24:25Z", "type": "commit"}, {"oid": "55373cebd350f4f5c7471b8bff27659f9dd1db4e", "url": "https://github.com/seata/seata/commit/55373cebd350f4f5c7471b8bff27659f9dd1db4e", "message": "\u52a0\u8f7dstate-lang\u5b8c\u6210\u540e\uff0c\u6e05\u7406this.resources\u5c5e\u6027\u3002", "committedDate": "2020-04-17T02:41:37Z", "type": "commit"}, {"oid": "783d3fbc9c6e15ec01188a0f498010c4f57ecea4", "url": "https://github.com/seata/seata/commit/783d3fbc9c6e15ec01188a0f498010c4f57ecea4", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-17T13:55:53Z", "type": "commit"}, {"oid": "8a9831e00f709fa08467e5016b739253d484f258", "url": "https://github.com/seata/seata/commit/8a9831e00f709fa08467e5016b739253d484f258", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-20T06:47:32Z", "type": "commit"}, {"oid": "ebb53f32a97c6eb6718e7e61b18d45331e115327", "url": "https://github.com/seata/seata/commit/ebb53f32a97c6eb6718e7e61b18d45331e115327", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-21T07:02:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4NDk1Nw==", "url": "https://github.com/seata/seata/pull/2551#discussion_r411084957", "bodyText": "\u662f\u4e0d\u662f\u56e0\u4e3a\u589e\u52a0\u4e86autoconfiguration\u6240\u4ee5\u8fd9\u91cc\u589e\u52a0\u4e86\u89e3\u6790\u901a\u914d\u7b26\u7684\u4ee3\u7801\uff0c\u56e0\u4e3a\u539f\u6765\u7684demo\u662f\u7528\u7684spring xml\u914d\u7f6e\u7684\uff0c\u9ed8\u8ba4\u662f\u652f\u6301\u901a\u914d\u7b26\u7684\u3002", "author": "long187", "createdAt": "2020-04-20T04:28:33Z", "path": "saga/seata-saga-engine/src/main/java/io/seata/saga/engine/impl/DefaultStateMachineConfig.java", "diffHunk": "@@ -130,15 +132,18 @@ protected void init() throws Exception {\n             stateMachineRepository.setSeqGenerator(seqGenerator);\n             stateMachineRepository.setStateLangStore(stateLangStore);\n             stateMachineRepository.setDefaultTenantId(defaultTenantId);\n-            if (resources != null) {\n-                try {\n-                    stateMachineRepository.registryByResources(resources, defaultTenantId);\n-                } catch (IOException e) {\n-                    LOGGER.error(\"Load State Language Resources failed.\", e);\n-                }\n-            }\n             this.stateMachineRepository = stateMachineRepository;\n         }\n+        if (this.autoRegisterResources && this.resources != null && this.resources.length > 0) {\n+            try {\n+                Resource[] resources = ResourceUtil.getResources(this.resources);", "originalCommit": "783d3fbc9c6e15ec01188a0f498010c4f57ecea4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTk5NzMyMw==", "url": "https://github.com/seata/seata/pull/2551#discussion_r411997323", "bodyText": "\u662f\u7684\uff0cAutoConfiguration\u7684\u60c5\u51b5\u4e0b\uff0c\u65e0\u6cd5\u89e3\u6790\u901a\u914d\u7b26\u3002", "author": "wangliang181230", "createdAt": "2020-04-21T08:49:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4NDk1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc5Mzg5Mg==", "url": "https://github.com/seata/seata/pull/2551#discussion_r413793892", "bodyText": "OK", "author": "long187", "createdAt": "2020-04-23T12:58:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4NDk1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4NTMzMQ==", "url": "https://github.com/seata/seata/pull/2551#discussion_r411085331", "bodyText": "\u8fd9\u91cc\u628a\u5f02\u5e38\u8bbe\u7f6e\u5230StateMachineInstance\u91cc\uff0c\u4f3c\u4e4e\u548c\u672c\u6b21pr\u63cf\u8ff0\u76843\u4e2a\u4f18\u5316\u4e0d\u662f\u4e00\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u662f\u4e0d\u662f\u8981\u4fee\u590d\u53e6\u4e00\u4e2a\u95ee\u9898\uff1f", "author": "long187", "createdAt": "2020-04-20T04:29:53Z", "path": "saga/seata-saga-engine/src/main/java/io/seata/saga/engine/pcext/handlers/ServiceTaskStateHandler.java", "diffHunk": "@@ -181,6 +182,11 @@ public void process(ProcessContext context) throws EngineExecutionException {\n \n             ((HierarchicalProcessContext) context).setVariableLocally(DomainConstants.VAR_NAME_CURRENT_EXCEPTION, e);\n \n+            StateMachineInstance stateMachineInstance = ProcessUtil.getStateMachineInstanceFromProcessContext(context);", "originalCommit": "783d3fbc9c6e15ec01188a0f498010c4f57ecea4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTk5ODQ0OQ==", "url": "https://github.com/seata/seata/pull/2551#discussion_r411998449", "bodyText": "\u8fd9\u4e2a\u4e3b\u8981\u662f\u4e3a\u4e86\u5728saga\u4e8b\u52a1\u540c\u6b65\u65b9\u5f0f\u6267\u884c\u5f02\u5e38\u540e\uff0c\u80fd\u901a\u8fc7stateMachineInst.getException()\u83b7\u53d6\u5230\u5177\u4f53\u7684\u5f02\u5e38\u3002", "author": "wangliang181230", "createdAt": "2020-04-21T08:51:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4NTMzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAzMzU0NQ==", "url": "https://github.com/seata/seata/pull/2551#discussion_r412033545", "bodyText": "\u6211\u4e0d\u77e5\u9053\u539f\u6765saga\u6709\u6ca1\u6709\u65b9\u6cd5\u53ef\u4ee5\u83b7\u53d6\u5230\u5f02\u5e38\u4fe1\u606f\u3002", "author": "wangliang181230", "createdAt": "2020-04-21T09:39:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4NTMzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4Nzg4NA==", "url": "https://github.com/seata/seata/pull/2551#discussion_r411087884", "bodyText": "\u8fd9\u91cc\u628a\u5f02\u5e38\u53bb\u6389\uff0c\u4f3c\u4e4e\u548c\u672c\u6b21pr\u63cf\u8ff0\u76843\u4e2a\u4f18\u5316\u4e0d\u662f\u4e00\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u662f\u4e0d\u662f\u8981\u4fee\u590d\u53e6\u4e00\u4e2a\u95ee\u9898\uff1f", "author": "long187", "createdAt": "2020-04-20T04:39:14Z", "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/store/db/DbAndReportTcStateLogStore.java", "diffHunk": "@@ -155,6 +155,11 @@ public void recordStateMachineFinished(StateMachineInstance machineInstance, Pro\n                 endParams.remove(DomainConstants.VAR_NAME_GLOBAL_TX);\n             }\n \n+            // if success, clear exception", "originalCommit": "783d3fbc9c6e15ec01188a0f498010c4f57ecea4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcwNzMwMQ==", "url": "https://github.com/seata/seata/pull/2551#discussion_r412707301", "bodyText": "\u548cServiceTaskStateHandler.java\u8c03\u6574\u7684\u76ee\u7684\u662f\u4e00\u6837\u7684\u3002\n\u8fd9\u4e2a\u4e3b\u8981\u662f\u4e3a\u4e86\u5728saga\u4e8b\u52a1\u540c\u6b65\u65b9\u5f0f\u6267\u884c\u5f02\u5e38\u540e\uff0c\u80fd\u901a\u8fc7stateMachineInst.getException()\u83b7\u53d6\u5230\u5177\u4f53\u7684\u5f02\u5e38\u3002", "author": "wangliang181230", "createdAt": "2020-04-22T06:34:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4Nzg4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjc1MjY2Mg==", "url": "https://github.com/seata/seata/pull/2551#discussion_r412752662", "bodyText": "\u4f46\u662f\uff0c\u5e76\u4e0d\u662f\u8bf4\uff0c\u5f02\u5e38\u4e86\uff0csaga\u5168\u5c40\u4e8b\u52a1\u5c31\u5f02\u5e38\uff0c\u53ef\u4ee5\u901a\u8fc7\u72b6\u6001\u673a\u5bf9\u670d\u52a1\u7684\u7f16\u6392\uff0c\u5c06\u5f02\u5e38\u5904\u7406\u6389\uff0c\u6700\u7ec8\u8ba9\u5168\u5c40\u4e8b\u52a1\u6210\u529f\u3002\u8fd9\u65f6\u5019\uff0c\u5c31\u4e0d\u9700\u8981\u8fd9\u4e2a\u5f02\u5e38\u7684\u4fe1\u606f\u4e86\u3002\u6240\u4ee5\u5168\u5c40\u4e8b\u52a1\u6210\u529f\u65f6\uff0c\u9700\u8981\u6e05\u7406\u6389\u5f02\u5e38\u4fe1\u606f\u3002", "author": "wangliang181230", "createdAt": "2020-04-22T07:49:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4Nzg4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyMTMwNA==", "url": "https://github.com/seata/seata/pull/2551#discussion_r414421304", "bodyText": "\u5bf9\uff0c\u4f60\u8fd9\u4e2a\u7406\u89e3\u662f\u975e\u5e38\u6b63\u786e\u7684\u3002\u6240\u4ee5\u5728\u6846\u67b6\u8bbe\u8ba1\u65f6\u4e5f\u8003\u8651\u4e86\u8fd9\u79cd\u60c5\u51b5\uff0c\u5f53\u4e00\u4e2a\u670d\u52a1\u6267\u884c\u53d1\u751f\u4e86\u5f02\u5e38\uff0c\u4f46\u662f\u6709Catch\u628a\u5f02\u5e38\u5904\u7406\u6389\u4e86\uff0c\u8fd9\u65f6\u5c31\u4f1a\u6e05\u9664\u8fd9\u4e2a\u5f02\u5e38\uff0c\u4f60\u53ef\u4ee5\u770b\u4e00\u4e0b\u6e90\u4ee3\u7801ServiceTaskStateHandlerInterceptor\u3002\u6240\u4ee5\u8fd9\u4e5f\u662f\u5728\u4e0a\u9762\u90a3\u91ccServiceTaskStateHandler\u91cc\u6ca1\u6709\u53bbsetExeception\uff0c\u8fd8\u6709\u4e00\u4e2a\u539f\u56e0\u662f\u56e0\u4e3a\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a\u5f02\u5e38\uff0c\u6bd4\u5982\u8bf4\u4e00\u4e2a\u6b63\u5411\u670d\u52a1\u5f02\u5e38\u4e86\uff0c\u7136\u540e\u8fdb\u884c\u8865\u507f\uff0c\u8865\u507f\u670d\u52a1\u4e5f\u5f02\u5e38\uff0c\u8fd9\u65f6\u5c31\u6709\u4e24\u4e2a\u5f02\u5e38\uff0cstateMachineInstance\u5728\u7ed3\u675f\u65f6\u4f1aset\u6700\u540e\u4e00\u4e2a\u5f02\u5e38\u5230statemachineInstance\uff0c\u53ef\u4ee5\u770b\u4e00\u4e0bEngineUtils\u7684\u4e24\u4e2a\u65b9\u6cd5\u3002\u6240\u4ee5\u6211\u7406\u89e3\u8fd9\u4e24setException\u4e0d\u9700\u7684\u3002\u5982\u679c\u60f3\u83b7\u53d6\u670d\u52a1\u6267\u884c\u7684\u5f02\u5e38\uff0c\u53ef\u4ee5\u904d\u5386stateInstance\u5217\u8868,\u4ecestateInstance\u91cc\u53d6", "author": "long187", "createdAt": "2020-04-24T09:11:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4Nzg4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQzNDE3Ng==", "url": "https://github.com/seata/seata/pull/2551#discussion_r414434176", "bodyText": "\u90a3\u5c31\u662fCompensationTriggerStateHandler\u91cc\u7684\u7b2c63\u884c\u4ee3\u7801\uff0c\u628acontext\u91cc\u7684\u5f53\u524d\u5f02\u5e38\u7ed9\u6e05\u9664\u6389\u4e86\u3002\n\u4f46\u5b9e\u9645\u4e0a\uff0c\u8fd9\u65f6\u5019\u8fd8\u6ca1\u5f00\u59cb\u6267\u884c\u8865\u507f\uff0c\u4e5f\u4e0d\u77e5\u9053\u8865\u507f\u662f\u5426\u4f1a\u6210\u529f\u6216\u5931\u8d25\u3002\n\u6700\u7ec8\u5bfc\u81f4\u8865\u507f\u6210\u529f\u4e86\uff0c\u5f02\u5e38\u4fe1\u606f\u5374\u4e22\u5931\u4e86\u3002\n\u90a3\u65f6\u5019\uff0c\u4e3b\u8981\u6211\u8fd8\u4e0d\u662f\u5f88\u7406\u89e3\u8fd9\u4e00\u884c\u4ee3\u7801\u4e3a\u4ec0\u4e48\u8981\u6e05\u9664\u6389\u5f02\u5e38\u4fe1\u606f\u3002\u6240\u4ee5\u505a\u4e86\u4e24\u4e2asetException\u6765\u4fdd\u8bc1\u5f02\u5e38\u4fe1\u606f\u80fd\u591f\u5199\u5230stateMachineInstance\u4e2d\u3002", "author": "wangliang181230", "createdAt": "2020-04-24T09:31:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA4Nzg4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTk4OTQ1MQ==", "url": "https://github.com/seata/seata/pull/2551#discussion_r411989451", "bodyText": "\u4f7f\u7528StateHandlerInterceptor\u6269\u5c55\uff0c\u89c1pr: #2584", "author": "long187", "createdAt": "2020-04-21T08:39:26Z", "path": "saga/seata-saga-processctrl/src/main/java/io/seata/saga/proctrl/ProcessUtil.java", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.saga.proctrl;\n+\n+import io.seata.common.util.StringUtils;\n+import io.seata.core.context.RootContext;\n+import io.seata.core.model.BranchType;\n+import io.seata.saga.statelang.domain.DomainConstants;\n+import io.seata.saga.statelang.domain.StateMachineInstance;\n+import io.seata.tm.api.GlobalTransaction;\n+import java.util.Map;\n+\n+/**\n+ * Process Util\n+ *\n+ * @author wang.liang\n+ */\n+public class ProcessUtil {\n+\n+    private ProcessUtil() {\n+    }\n+\n+    /**\n+     * Get state machine instance from process context.\n+     * @param context\n+     * @return the stateMachineInstance\n+     */\n+    public static StateMachineInstance getStateMachineInstanceFromProcessContext(ProcessContext context) {\n+        return (StateMachineInstance) context.getVariable(DomainConstants.VAR_NAME_STATEMACHINE_INST);\n+    }\n+\n+    /**\n+     * Gets xid from saga process context.\n+     *\n+     * @return the xid\n+     */\n+    public static String getXidFromProcessContext(ProcessContext context) {\n+        String xid = null;\n+        Map<String, Object> contextVariable = (Map<String, Object>) context.getVariable(DomainConstants.VAR_NAME_STATEMACHINE_CONTEXT);\n+        if (contextVariable != null && contextVariable.containsKey(DomainConstants.VAR_NAME_GLOBAL_TX)) {\n+            GlobalTransaction globalTransaction = (GlobalTransaction) contextVariable.get(DomainConstants.VAR_NAME_GLOBAL_TX);\n+            xid = globalTransaction.getXid();\n+        } else {\n+            StateMachineInstance smi = (StateMachineInstance) context.getVariable(DomainConstants.VAR_NAME_STATEMACHINE_INST);\n+            if (smi != null) {\n+                xid = smi.getId();\n+            }\n+        }\n+        return xid;\n+    }\n+\n+    /**\n+     * Run in the saga branch.\n+     *\n+     * @param context\n+     * @param runnable\n+     */\n+    public static void runInSagaBranch(ProcessContext context, Runnable runnable) {", "originalCommit": "ebb53f32a97c6eb6718e7e61b18d45331e115327", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcwNjc3NQ==", "url": "https://github.com/seata/seata/pull/2551#discussion_r412706775", "bodyText": "\u6536\u5230\u3002", "author": "wangliang181230", "createdAt": "2020-04-22T06:33:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTk4OTQ1MQ=="}], "type": "inlineReview"}, {"oid": "446618788329503757a97f0519975382f613ae52", "url": "https://github.com/seata/seata/commit/446618788329503757a97f0519975382f613ae52", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-21T20:59:09Z", "type": "commit"}, {"oid": "a03d69c38faf4e6c06b7b1854892da8aba89636a", "url": "https://github.com/seata/seata/commit/a03d69c38faf4e6c06b7b1854892da8aba89636a", "message": "\u4f18\u5316SeataSagaAutoConfiguration", "committedDate": "2020-04-22T04:13:39Z", "type": "commit"}, {"oid": "3a4d1eaa10b12ce144f6bd51409f86f1872ecd96", "url": "https://github.com/seata/seata/commit/3a4d1eaa10b12ce144f6bd51409f86f1872ecd96", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-22T06:27:49Z", "type": "commit"}, {"oid": "fc4e94c8ed76723a70a54dd72d92b88cac3448d1", "url": "https://github.com/seata/seata/commit/fc4e94c8ed76723a70a54dd72d92b88cac3448d1", "message": "\u6dfb\u52a0 InSagaBranchHandlerInterceptor\uff0c\u66ff\u6362\u539f\u6765\u7684ProcessUtil.runInSagaBranch()\u3002\u5e76\u6dfb\u52a0META-INF/services", "committedDate": "2020-04-22T06:52:05Z", "type": "commit"}, {"oid": "6f1e843d83033c3c2beb7c2a48ae2b3aab64e694", "url": "https://github.com/seata/seata/commit/6f1e843d83033c3c2beb7c2a48ae2b3aab64e694", "message": "Merge remote-tracking branch 'origin/develop' into develop", "committedDate": "2020-04-22T06:52:17Z", "type": "commit"}, {"oid": "c52b5b1189952a3da5113bddf957dd77f42f5409", "url": "https://github.com/seata/seata/commit/c52b5b1189952a3da5113bddf957dd77f42f5409", "message": "\u907f\u514dSAGA\u4e8b\u52a1\u5728\u521b\u5efastateMachineInstance\u6570\u636e\u65f6\uff0c\u521b\u5efa\u4e86AT\u5206\u652f\u4e8b\u52a1\u7684\u95ee\u9898\u3002", "committedDate": "2020-04-22T09:48:35Z", "type": "commit"}, {"oid": "9188326641a170ae26e42739de104a3cc2d16212", "url": "https://github.com/seata/seata/commit/9188326641a170ae26e42739de104a3cc2d16212", "message": "AT\u4e8b\u52a1\u4e0e\u5176\u4ed6\u90e8\u5206\u4e8b\u52a1\u9694\u79bb\u7684\u4ee3\u7801\u5df2\u5728\u53e6\u4e00\u4e2aPR\u4e2d\u5b9e\u73b0\u3002\u73b0\u5728\u6062\u590d\u90e8\u5206\u4ee3\u7801\u3002\n\u89c1\uff1ahttps://github.com/seata/seata/pull/2415", "committedDate": "2020-04-22T10:01:25Z", "type": "commit"}, {"oid": "77ae3fe3d19d86ac09f451ac064de3a83535e449", "url": "https://github.com/seata/seata/commit/77ae3fe3d19d86ac09f451ac064de3a83535e449", "message": "\u64a4\u6d88\u4e00\u4e9b\u6587\u4ef6\u7684\u53d8\u66f4\u3002", "committedDate": "2020-04-22T13:53:37Z", "type": "commit"}, {"oid": "c543ecb7e3999f3ba8c8f889239a3eaa7f3dd6ba", "url": "https://github.com/seata/seata/commit/c543ecb7e3999f3ba8c8f889239a3eaa7f3dd6ba", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-23T01:35:00Z", "type": "commit"}, {"oid": "8598593bc6ef2360f5fc2ae8dab5ac2d22067e25", "url": "https://github.com/seata/seata/commit/8598593bc6ef2360f5fc2ae8dab5ac2d22067e25", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-23T01:48:20Z", "type": "commit"}, {"oid": "96497605b0e0d64fde1dc05db463e3f73b4fe60f", "url": "https://github.com/seata/seata/commit/96497605b0e0d64fde1dc05db463e3f73b4fe60f", "message": "\u89e3\u51b3\u6d4b\u8bd5\u7528\u4f8b\u6267\u884c\u5931\u8d25\u3002", "committedDate": "2020-04-23T06:57:26Z", "type": "commit"}, {"oid": "359903c3e346fccad32685b18f635835a5e66f91", "url": "https://github.com/seata/seata/commit/359903c3e346fccad32685b18f635835a5e66f91", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-23T06:58:13Z", "type": "commit"}, {"oid": "aebb2d95f7153aec668cd41e568ca84137027f3e", "url": "https://github.com/seata/seata/commit/aebb2d95f7153aec668cd41e568ca84137027f3e", "message": "\u6dfb\u52a0seata.registry.type\u548cseata.config.type\u5728yml\u4e2d\u7684\u63d0\u793a\u4fe1\u606f\uff1a\u5305\u62ec\u53ef\u9009\u503c\u53ca\u5404\u503c\u7684\u8bf4\u660e\u3002", "committedDate": "2020-04-23T07:43:52Z", "type": "commit"}, {"oid": "1ddbc003c6222fd12cfd2e69086fd3eb71c2c9fe", "url": "https://github.com/seata/seata/commit/1ddbc003c6222fd12cfd2e69086fd3eb71c2c9fe", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-24T09:33:29Z", "type": "commit"}, {"oid": "c0ce11fa9e7301697b20ddabc45e9cbf9a277009", "url": "https://github.com/seata/seata/commit/c0ce11fa9e7301697b20ddabc45e9cbf9a277009", "message": "\u6d4b\u8bd5\u7528\u4f8b\u6bd4\u8f83\u65b9\u5f0f\u8c03\u6574\u3002", "committedDate": "2020-04-24T14:38:18Z", "type": "commit"}, {"oid": "fcd5b7212e1c0a41510b5561b0d93e8f3357b3e8", "url": "https://github.com/seata/seata/commit/fcd5b7212e1c0a41510b5561b0d93e8f3357b3e8", "message": "\u5728script\u91cc\uff0c\u6dfb\u52a0saga\u76f8\u5173\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u65b9\u4fbf\u5927\u5bb6\u590d\u5236\u5e76\u8c03\u6574\u914d\u7f6e\u3002", "committedDate": "2020-04-26T04:01:15Z", "type": "commit"}, {"oid": "1907f4230db5036253d19e818e6500b10309c4d7", "url": "https://github.com/seata/seata/commit/1907f4230db5036253d19e818e6500b10309c4d7", "message": "1\u3001\u4f18\u5316\u8bbe\u7f6estateMachineInstance\u7684\u5f02\u5e38\u6570\u636e\u76f8\u5173\u4ee3\u7801\u3002\n2\u3001\u4fee\u590d\u4e00\u4e2a\u5e38\u91cf\u4f7f\u7528\u9519\u8bef\u7684BUG\u3002", "committedDate": "2020-04-26T05:55:20Z", "type": "commit"}, {"oid": "bf73392d7269ef16d5e78080a4cda0afbc7c5e8c", "url": "https://github.com/seata/seata/commit/bf73392d7269ef16d5e78080a4cda0afbc7c5e8c", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-26T05:57:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTIyNjAzNA==", "url": "https://github.com/seata/seata/pull/2551#discussion_r415226034", "bodyText": "remove date tag", "author": "jsbxyyx", "createdAt": "2020-04-26T06:01:20Z", "path": "saga/seata-saga-statelang/src/main/java/io/seata/saga/statelang/parser/utils/ResourceUtil.java", "diffHunk": "@@ -0,0 +1,49 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.saga.statelang.parser.utils;\n+\n+import java.io.IOException;\n+import java.util.Optional;\n+import java.util.stream.Stream;\n+import org.springframework.core.io.Resource;\n+import org.springframework.core.io.support.PathMatchingResourcePatternResolver;\n+import org.springframework.core.io.support.ResourcePatternResolver;\n+\n+/**\n+ * State lang resource util.\n+ *\n+ * @author wang.liang\n+ * @date 2020/4/15", "originalCommit": "bf73392d7269ef16d5e78080a4cda0afbc7c5e8c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI2MjU2OA==", "url": "https://github.com/seata/seata/pull/2551#discussion_r415262568", "bodyText": "OK", "author": "wangliang181230", "createdAt": "2020-04-26T09:17:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTIyNjAzNA=="}], "type": "inlineReview"}, {"oid": "96ff16e53668df0a471b20deed258c614ca78e9c", "url": "https://github.com/seata/seata/commit/96ff16e53668df0a471b20deed258c614ca78e9c", "message": "1\u3001\u79fb\u9664@date\u3002 2\u3001\u6dfb\u52a0saga\u914d\u7f6e\u5230script\u4e2d\u7684file.conf\u4e2d\u3002", "committedDate": "2020-04-26T09:22:58Z", "type": "commit"}, {"oid": "b7d72f78910592c1a89f9273080da967c5288ce5", "url": "https://github.com/seata/seata/commit/b7d72f78910592c1a89f9273080da967c5288ce5", "message": "\u7f3a\u5c11\u53cc\u5f15\u53f7\u3002", "committedDate": "2020-04-26T09:23:52Z", "type": "commit"}, {"oid": "2082b75ab18e588d69bfa0965e95cacb55d851a0", "url": "https://github.com/seata/seata/commit/2082b75ab18e588d69bfa0965e95cacb55d851a0", "message": "\u8c03\u6574saga\u5f02\u6b65\u7ebf\u7a0b\u6c60\u7684\u914d\u7f6e\u3002", "committedDate": "2020-04-26T09:31:58Z", "type": "commit"}, {"oid": "11b7f40a5d0a82cd23f61963e1a774e5dfa86ac8", "url": "https://github.com/seata/seata/commit/11b7f40a5d0a82cd23f61963e1a774e5dfa86ac8", "message": "\u6dfb\u52a0saga\u90e8\u5206\u914d\u7f6e\u9879\u7684\u9ed8\u8ba4\u503c\uff0c\u53ca\u914d\u7f6e\u63d0\u793a\u4fe1\u606f\u3002", "committedDate": "2020-04-26T10:35:57Z", "type": "commit"}, {"oid": "86af0d2e45d04b48fb166383a20704e8e70ce6a9", "url": "https://github.com/seata/seata/commit/86af0d2e45d04b48fb166383a20704e8e70ce6a9", "message": "ProcessContext\u7684removeVariable\u65b9\u6cd5\u8fd4\u56de\u7c7b\u578b\u7531void\u6539\u4e3aObject.", "committedDate": "2020-04-27T01:35:54Z", "type": "commit"}, {"oid": "ec9cd4bf6eeab7641d425ff49032b158488515fa", "url": "https://github.com/seata/seata/commit/ec9cd4bf6eeab7641d425ff49032b158488515fa", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-27T02:04:51Z", "type": "commit"}, {"oid": "bafbfc53243c6491dbbcb7e90b43a292b141f37e", "url": "https://github.com/seata/seata/commit/bafbfc53243c6491dbbcb7e90b43a292b141f37e", "message": "\u6839\u636e\u65b0\u5408\u5e76\u7684PR\u8c03\u6574\u4ee3\u7801\u3002", "committedDate": "2020-04-27T03:42:08Z", "type": "commit"}, {"oid": "e63f395f5dfaf5756ad9f4b015ff1ce3837de6c1", "url": "https://github.com/seata/seata/commit/e63f395f5dfaf5756ad9f4b015ff1ce3837de6c1", "message": "\u90e8\u5206\u65e5\u5fd7\u7684\u7ea7\u522b\u8c03\u6574\u3002", "committedDate": "2020-04-27T05:20:46Z", "type": "commit"}, {"oid": "4040a9cf367e9948e12b169deb410cf0f013eaed", "url": "https://github.com/seata/seata/commit/4040a9cf367e9948e12b169deb410cf0f013eaed", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-27T08:44:45Z", "type": "commit"}, {"oid": "a8f93f8b84b56dddf9e0290d2d7f903b46004f60", "url": "https://github.com/seata/seata/commit/a8f93f8b84b56dddf9e0290d2d7f903b46004f60", "message": "\u72b6\u6001\u673a\u90e8\u5206\u914d\u7f6e\u503c\u6dfb\u52a0\u9ed8\u8ba4\u503c\u3002", "committedDate": "2020-04-30T01:31:16Z", "type": "commit"}, {"oid": "6896766cb2c3037d00b552a8795491c9b430b965", "url": "https://github.com/seata/seata/commit/6896766cb2c3037d00b552a8795491c9b430b965", "message": "RootContext\u6dfb\u52a0\u65b9\u4fbf\u5224\u65ad\u5f53\u524d\u6240\u5728\u5206\u652f\u4e8b\u52a1\u7684\u9759\u6001\u65b9\u6cd5\u3002", "committedDate": "2020-04-30T01:39:09Z", "type": "commit"}, {"oid": "dbf6485f65498676dd6f95ac67bc09ca9fb7b4de", "url": "https://github.com/seata/seata/commit/dbf6485f65498676dd6f95ac67bc09ca9fb7b4de", "message": "\u907f\u514d\u5728SAGA\u4e8b\u52a1\u4e2d\u521b\u5efaTCC\u5206\u652f\u4e8b\u52a1\uff08\u867d\u7136\u5e76\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u56e0\u4e3a\u4e00\u822c\u6ca1\u4eba\u4f1a\u5728SAGA\u4e8b\u52a1\u4e2d\u4f7f\u7528TCC\u63a5\u53e3\uff09", "committedDate": "2020-04-30T01:45:14Z", "type": "commit"}, {"oid": "4de079cc72c7e9d84e8fccc5deb99a882c9eb7b7", "url": "https://github.com/seata/seata/commit/4de079cc72c7e9d84e8fccc5deb99a882c9eb7b7", "message": "Merge branch 'develop' into develop", "committedDate": "2020-04-30T02:26:17Z", "type": "commit"}, {"oid": "bd1f933b21b687879711c187c1a089bb59b8c7f4", "url": "https://github.com/seata/seata/commit/bd1f933b21b687879711c187c1a089bb59b8c7f4", "message": "SpringBoot\u9879\u76ee\u4e2d\uff0c\u81ea\u52a8\u521b\u5efaAT\u548cSAGA\u6240\u9700\u7684\u8868\u3002", "committedDate": "2020-04-30T06:29:50Z", "type": "commit"}, {"oid": "35cc451e99a3d7f5300a35fa6695be0c8ee1138f", "url": "https://github.com/seata/seata/commit/35cc451e99a3d7f5300a35fa6695be0c8ee1138f", "message": "\u79fb\u9664\u81ea\u52a8\u5efa\u8868\u529f\u80fd\u3002", "committedDate": "2020-05-01T02:06:32Z", "type": "commit"}, {"oid": "3a96993f20f79b59da0a71cc8235c3426dab36d8", "url": "https://github.com/seata/seata/commit/3a96993f20f79b59da0a71cc8235c3426dab36d8", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-04T06:01:28Z", "type": "commit"}, {"oid": "d722c7f1758c283e26e3a1d7d9bc22589dae2f94", "url": "https://github.com/seata/seata/commit/d722c7f1758c283e26e3a1d7d9bc22589dae2f94", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-04T08:17:58Z", "type": "commit"}, {"oid": "8f22d3717b1fee760a1dca2ff9b6195052ea698a", "url": "https://github.com/seata/seata/commit/8f22d3717b1fee760a1dca2ff9b6195052ea698a", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-09T15:39:58Z", "type": "commit"}, {"oid": "805150eba854732091d15c80d8362a93e580f7c1", "url": "https://github.com/seata/seata/commit/805150eba854732091d15c80d8362a93e580f7c1", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-11T08:26:57Z", "type": "commit"}, {"oid": "fa51c73b6923c483514ec9df944c145717715c11", "url": "https://github.com/seata/seata/commit/fa51c73b6923c483514ec9df944c145717715c11", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-12T10:22:20Z", "type": "commit"}, {"oid": "3dc27a15556e8695d52abc979075a4be5d4d94dd", "url": "https://github.com/seata/seata/commit/3dc27a15556e8695d52abc979075a4be5d4d94dd", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-19T17:01:55Z", "type": "commit"}, {"oid": "ef7c55da8945612f83f2d16bda233e56750ec842", "url": "https://github.com/seata/seata/commit/ef7c55da8945612f83f2d16bda233e56750ec842", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-20T06:27:12Z", "type": "commit"}, {"oid": "5744d7724c370c4f016278409181a907e72b3dd8", "url": "https://github.com/seata/seata/commit/5744d7724c370c4f016278409181a907e72b3dd8", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-25T11:48:46Z", "type": "commit"}, {"oid": "d58bf9457680af1e7cc0426e631ca03198a5d702", "url": "https://github.com/seata/seata/commit/d58bf9457680af1e7cc0426e631ca03198a5d702", "message": "Merge branch 'develop' into develop", "committedDate": "2020-05-27T07:16:16Z", "type": "commit"}, {"oid": "cb57670a1816e0c67d0b805313cb002869c466da", "url": "https://github.com/seata/seata/commit/cb57670a1816e0c67d0b805313cb002869c466da", "message": "Merge branch 'develop' into develop", "committedDate": "2020-06-09T09:25:46Z", "type": "commit"}, {"oid": "de1367481f8355143b457a5f22a97203815142f0", "url": "https://github.com/seata/seata/commit/de1367481f8355143b457a5f22a97203815142f0", "message": "\u4e00\u4e2aimport\u7684\u4f4d\u7f6e\u8c03\u6574\u3002", "committedDate": "2020-06-12T06:19:23Z", "type": "commit"}, {"oid": "33020d8f9b4bd4142b69ede6b1d6603b9a3b90be", "url": "https://github.com/seata/seata/commit/33020d8f9b4bd4142b69ede6b1d6603b9a3b90be", "message": "\u5c0f\u8c03\u6574", "committedDate": "2020-06-17T15:29:44Z", "type": "commit"}, {"oid": "e93cc27c46da364e2fbb12d4ff3f9cae03626802", "url": "https://github.com/seata/seata/commit/e93cc27c46da364e2fbb12d4ff3f9cae03626802", "message": "Merge branch 'develop' into develop", "committedDate": "2020-06-17T15:52:25Z", "type": "commit"}, {"oid": "17cfb846ed2849a02d496adbd6c04644dcbbae59", "url": "https://github.com/seata/seata/commit/17cfb846ed2849a02d496adbd6c04644dcbbae59", "message": "InSagaBranchHandlerInterceptor\u5b9e\u73b0\u63a5\u53e3\u7684\u65b9\u6cd5\u3002\u5e76\u8c03\u6574@LoadLevel\u6392\u5e8f\u503c\u4e3a50", "committedDate": "2020-06-17T15:55:35Z", "type": "commit"}, {"oid": "e7c25b29f50b886b815f7e820dff9bc14986db14", "url": "https://github.com/seata/seata/commit/e7c25b29f50b886b815f7e820dff9bc14986db14", "message": "Merge branch 'develop' into develop", "committedDate": "2020-06-19T07:05:39Z", "type": "commit"}, {"oid": "50e6861e38603a6237c3dabf4399c3edecee1318", "url": "https://github.com/seata/seata/commit/50e6861e38603a6237c3dabf4399c3edecee1318", "message": "Merge branch 'develop' into develop", "committedDate": "2020-06-24T07:26:53Z", "type": "commit"}, {"oid": "bb7c2661508dd5305f5625fec8ed0a6d21ca4855", "url": "https://github.com/seata/seata/commit/bb7c2661508dd5305f5625fec8ed0a6d21ca4855", "message": "Merge branch 'develop' into develop", "committedDate": "2020-06-28T06:12:50Z", "type": "commit"}, {"oid": "379f8ce8c06e9c636cc70ae70901149462a47e05", "url": "https://github.com/seata/seata/commit/379f8ce8c06e9c636cc70ae70901149462a47e05", "message": "\u64a4\u9500\u90e8\u5206\u4ee3\u7801\u3002", "committedDate": "2020-06-28T07:47:52Z", "type": "commit"}, {"oid": "cdfa4f46dac6721ab8a5898c8e4208c961ec0ac4", "url": "https://github.com/seata/seata/commit/cdfa4f46dac6721ab8a5898c8e4208c961ec0ac4", "message": "\u5c06\u62c6\u5206\u51fa\u53bb\u7684PR\u7684\u4ee3\u7801\u79fb\u9664\u6389\u3002", "committedDate": "2020-06-28T08:13:11Z", "type": "commit"}, {"oid": "9197a1b854f0c41b6d71c9d5ec13519631c96895", "url": "https://github.com/seata/seata/commit/9197a1b854f0c41b6d71c9d5ec13519631c96895", "message": "\u6dfb\u52a0\u6ce8\u91ca", "committedDate": "2020-06-29T01:13:27Z", "type": "commit"}, {"oid": "1856d849d1a5e2b1ca836385104d40a3d43fe94c", "url": "https://github.com/seata/seata/commit/1856d849d1a5e2b1ca836385104d40a3d43fe94c", "message": "Merge branch 'develop' into develop", "committedDate": "2020-06-30T04:48:48Z", "type": "commit"}, {"oid": "2b53c10829bed9c416cad3212b305cfa798f8806", "url": "https://github.com/seata/seata/commit/2b53c10829bed9c416cad3212b305cfa798f8806", "message": "\u6dfb\u52a0inTccBranch\u3001inSagaBranch\u65b9\u6cd5\u7684\u6d4b\u8bd5\u7528\u4f8b\u3002", "committedDate": "2020-06-30T05:06:13Z", "type": "commit"}, {"oid": "d005bb5851654fbde4ce5b2d661d99e789cd6d80", "url": "https://github.com/seata/seata/commit/d005bb5851654fbde4ce5b2d661d99e789cd6d80", "message": "Merge branch 'develop' into develop", "committedDate": "2020-07-02T03:22:57Z", "type": "commit"}, {"oid": "4a0244c8aafd8940ea04b1bf3672f0c6b7b33bcc", "url": "https://github.com/seata/seata/commit/4a0244c8aafd8940ea04b1bf3672f0c6b7b33bcc", "message": "\u79fb\u9664\u591a\u4f59\u7684import", "committedDate": "2020-07-02T04:17:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY3NDI1NA==", "url": "https://github.com/seata/seata/pull/2551#discussion_r452674254", "bodyText": "\u867d\u7136\u5728SAGA\u4e2d\u4e00\u822c\u4e0d\u4f1a\u4f7f\u7528TCC\uff0c\u4e0d\u8fc7\u8fd8\u662f\u4ee5\u9632\u4e07\u4e00\u6dfb\u52a0\u4e00\u4e0b\u5224\u65ad\u3002", "author": "wangliang181230", "createdAt": "2020-07-10T07:35:11Z", "path": "spring/src/main/java/io/seata/spring/tcc/TccActionInterceptor.java", "diffHunk": "@@ -65,7 +65,7 @@ public TccActionInterceptor(RemotingDesc remotingDesc) {\n \n     @Override\n     public Object invoke(final MethodInvocation invocation) throws Throwable {\n-        if (!RootContext.inGlobalTransaction()) {\n+        if (!RootContext.inGlobalTransaction() || RootContext.inSagaBranch()) {", "originalCommit": "4a0244c8aafd8940ea04b1bf3672f0c6b7b33bcc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d465246488e7652af8e31e5de65f38c01b4ead65", "url": "https://github.com/seata/seata/commit/d465246488e7652af8e31e5de65f38c01b4ead65", "message": "Merge branch 'develop' into develop", "committedDate": "2020-07-13T05:00:45Z", "type": "commit"}, {"oid": "4894459f2b86ca49972614f50c07616c9e7accf7", "url": "https://github.com/seata/seata/commit/4894459f2b86ca49972614f50c07616c9e7accf7", "message": "Merge branch 'develop' into develop", "committedDate": "2020-07-13T09:57:09Z", "type": "commit"}, {"oid": "252404d2ca5794eb6ce6e20fcbd0a402c85d8e78", "url": "https://github.com/seata/seata/commit/252404d2ca5794eb6ce6e20fcbd0a402c85d8e78", "message": "Merge branch 'develop' into develop", "committedDate": "2020-07-16T01:39:45Z", "type": "commit"}, {"oid": "dd5ce11666bfad407ea0ac0e499903a1a2d91f79", "url": "https://github.com/seata/seata/commit/dd5ce11666bfad407ea0ac0e499903a1a2d91f79", "message": "Merge branch 'develop' into develop", "committedDate": "2020-07-16T09:59:26Z", "type": "commit"}, {"oid": "1e0908f9f75c86a3f271dfb814e80acf34ff0b3b", "url": "https://github.com/seata/seata/commit/1e0908f9f75c86a3f271dfb814e80acf34ff0b3b", "message": "Merge branch 'develop' into develop", "committedDate": "2020-07-23T01:02:34Z", "type": "commit"}, {"oid": "443943227d3b85aae1f58446825854f3817dd611", "url": "https://github.com/seata/seata/commit/443943227d3b85aae1f58446825854f3817dd611", "message": "Merge branch 'develop' into develop", "committedDate": "2020-07-31T02:23:51Z", "type": "commit"}, {"oid": "29f18aa7bdc2a3c670df653a0ff52b8c1581655c", "url": "https://github.com/seata/seata/commit/29f18aa7bdc2a3c670df653a0ff52b8c1581655c", "message": "Merge branch 'develop' into develop", "committedDate": "2020-07-31T07:13:53Z", "type": "commit"}, {"oid": "e0e8c04ca0ae263e79edc6f3d8a138fb7bd0d34a", "url": "https://github.com/seata/seata/commit/e0e8c04ca0ae263e79edc6f3d8a138fb7bd0d34a", "message": "Merge branch 'develop' into develop", "committedDate": "2020-08-05T10:34:45Z", "type": "commit"}, {"oid": "09c11174410c884c4ed6ff6c6c6752b5eb4dfc1c", "url": "https://github.com/seata/seata/commit/09c11174410c884c4ed6ff6c6c6752b5eb4dfc1c", "message": "Merge branch 'develop' into develop", "committedDate": "2020-08-11T08:16:29Z", "type": "commit"}, {"oid": "0fa35cc16df06fed210227e10e8dd99e25f0002b", "url": "https://github.com/seata/seata/commit/0fa35cc16df06fed210227e10e8dd99e25f0002b", "message": "Merge branch 'develop' into develop", "committedDate": "2020-08-13T01:33:48Z", "type": "commit"}, {"oid": "861f8fa68c393e709bdc0b00f4f18f2c15a617ae", "url": "https://github.com/seata/seata/commit/861f8fa68c393e709bdc0b00f4f18f2c15a617ae", "message": "Merge branch 'develop' into develop", "committedDate": "2020-08-18T07:17:37Z", "type": "commit"}, {"oid": "83380f1949c9a24925bbc5e70281e37391a03198", "url": "https://github.com/seata/seata/commit/83380f1949c9a24925bbc5e70281e37391a03198", "message": "Merge branch 'develop' into develop", "committedDate": "2020-08-21T01:10:06Z", "type": "commit"}, {"oid": "4978de2b219806f9c8efcead69c0a437634f81c6", "url": "https://github.com/seata/seata/commit/4978de2b219806f9c8efcead69c0a437634f81c6", "message": "Merge branch 'develop' into develop", "committedDate": "2020-08-26T10:05:47Z", "type": "commit"}]}