{"pr_number": 2405, "pr_title": "Allow use of custom barcode scanner apps", "pr_createdAt": "2020-11-12T04:58:39Z", "pr_url": "https://github.com/dimagi/commcare-android/pull/2405", "timeline": [{"oid": "15993b0c3881b494d2dc2d69c99e74d50c0adf96", "url": "https://github.com/dimagi/commcare-android/commit/15993b0c3881b494d2dc2d69c99e74d50c0adf96", "message": "Allow use of custom barcode scanner apps", "committedDate": "2020-11-16T05:00:01Z", "type": "commit"}, {"oid": "82d36b787786d7ba6f0a7af184f1d93ceda3c9d8", "url": "https://github.com/dimagi/commcare-android/commit/82d36b787786d7ba6f0a7af184f1d93ceda3c9d8", "message": "Refractor all places where zxing library is used by default", "committedDate": "2020-11-16T05:54:48Z", "type": "commit"}, {"oid": "82d36b787786d7ba6f0a7af184f1d93ceda3c9d8", "url": "https://github.com/dimagi/commcare-android/commit/82d36b787786d7ba6f0a7af184f1d93ceda3c9d8", "message": "Refractor all places where zxing library is used by default", "committedDate": "2020-11-16T05:54:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDk5NjY3NA==", "url": "https://github.com/dimagi/commcare-android/pull/2405#discussion_r524996674", "bodyText": "can use String.join", "author": "shubham1g5", "createdAt": "2020-11-17T09:14:54Z", "path": "app/src/org/commcare/views/widgets/WidgetUtils.java", "diffHunk": "@@ -33,4 +40,42 @@ public static Button setupClearButton(Context context, ViewGroup root, String te\n         clearButton.setVisibility(visibility);\n         return clearButton;\n     }\n+\n+    /**\n+     * Works just like {@link #createScanIntent(Context, String...)} except the format is null.\n+     */\n+    public static Intent createScanIntent(Context context) {\n+        return createScanIntent(context, null);\n+    }\n+\n+    /**\n+     * A utility to create intent for barcode scan.\n+     *\n+     * If usage of 3rd party apps for scanning is enabled by the user, then this method will\n+     * create a generic intent for scanning barcodes and will fallback to zxing library if no\n+     * app exists to handle such intent.\n+     *\n+     * @param formats names of {@link com.google.zxing.BarcodeFormat}s to scan for. eg. {@link com.google.zxing.BarcodeFormat#QR_CODE}\n+     */\n+    public static Intent createScanIntent(Context context, String... formats) {\n+        if (MainConfigurablePreferences.useIntentCalloutForScanner()) {\n+            Intent scanIntent = new Intent(Intents.Scan.ACTION);\n+            if (scanIntent.resolveActivity(context.getPackageManager()) != null) {\n+                if (formats != null) {\n+                    StringBuilder joinedByComma = new StringBuilder();", "originalCommit": "82d36b787786d7ba6f0a7af184f1d93ceda3c9d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTAzNzkyNg==", "url": "https://github.com/dimagi/commcare-android/pull/2405#discussion_r525037926", "bodyText": "Made a change to use TextUtils since String.join is added in api 26", "author": "ShivamPokhriyal", "createdAt": "2020-11-17T10:15:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDk5NjY3NA=="}], "type": "inlineReview"}, {"oid": "060cf9e200884b3c84f321d609c4d2fbb23b3e62", "url": "https://github.com/dimagi/commcare-android/commit/060cf9e200884b3c84f321d609c4d2fbb23b3e62", "message": "Use TextUtils to join string", "committedDate": "2020-11-17T10:13:50Z", "type": "commit"}, {"oid": "3afcc96ca911bd3ecf81a17c53bb6835bde4bc6f", "url": "https://github.com/dimagi/commcare-android/commit/3afcc96ca911bd3ecf81a17c53bb6835bde4bc6f", "message": "Add missing semicolon and fix npe", "committedDate": "2020-11-24T14:19:12Z", "type": "commit"}, {"oid": "3afcc96ca911bd3ecf81a17c53bb6835bde4bc6f", "url": "https://github.com/dimagi/commcare-android/commit/3afcc96ca911bd3ecf81a17c53bb6835bde4bc6f", "message": "Add missing semicolon and fix npe", "committedDate": "2020-11-24T14:19:12Z", "type": "forcePushed"}]}