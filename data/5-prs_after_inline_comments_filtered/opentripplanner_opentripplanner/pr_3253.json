{"pr_number": 3253, "pr_title": "Make sure bug do not occour when AvgTimer is switched off.", "pr_createdAt": "2020-11-19T00:51:20Z", "pr_url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3253", "timeline": [{"oid": "c2f1c7c80d160320f8eaea758b5ed0b3fa35efa5", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/c2f1c7c80d160320f8eaea758b5ed0b3fa35efa5", "message": "Make sure bug do not occour when AvgTimer is switched off.", "committedDate": "2020-11-19T00:39:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjcxNTg1OQ==", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3253#discussion_r526715859", "bodyText": "Add comment on NOT THREAD-SAFE", "author": "t2gran", "createdAt": "2020-11-19T09:33:13Z", "path": "src/main/java/org/opentripplanner/transit/raptor/util/AvgTimer.java", "diffHunk": "@@ -186,17 +172,11 @@ public String totalTimeInSeconds() {\n \n     /* private methods */\n \n-    private boolean used() {\n-        return counterSuccess != 0 || counterFailed != 0;\n-    }\n-\n-    private String toString(int width) {\n-        return formatLine(\n-                method,\n-                width,\n-                formatResultAvg(totalTimeSuccess, counterSuccess),\n-                formatResult(totalTimeFailed, counterFailed)\n-        );\n+    private static AvgTimer timer(final String method, final Function<String, ? extends AvgTimer> factory) {", "originalCommit": "c2f1c7c80d160320f8eaea758b5ed0b3fa35efa5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjcxODQ5OQ==", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3253#discussion_r526718499", "bodyText": "Synchrocronize this", "author": "t2gran", "createdAt": "2020-11-19T09:37:06Z", "path": "src/main/java/org/opentripplanner/transit/raptor/util/AvgTimer.java", "diffHunk": "@@ -51,13 +50,15 @@ private AvgTimer(String method) {\n      * @param method Use: <SimpleClassName>:<methodName>\n      */\n     public static AvgTimer timerMilliSec(final String method) {\n+        if(NOOP) { return NoopAvgTimer.INSTANCE; }", "originalCommit": "c2f1c7c80d160320f8eaea758b5ed0b3fa35efa5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "28c9dd0bca085e69f7394ecfec8fbc4f2216fc84", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/28c9dd0bca085e69f7394ecfec8fbc4f2216fc84", "message": "Merge remote-tracking branch 'otp/dev-2.x' into otp2_fix_ConcurrentModificationException_in_Avg_timer", "committedDate": "2020-11-19T10:23:54Z", "type": "commit"}, {"oid": "c718b1bc603ed925dcfe2a31f2be33216b842d78", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/c718b1bc603ed925dcfe2a31f2be33216b842d78", "message": "Review fixes, doc and small improvments using ConcurrentHashMap to increase thread-safty", "committedDate": "2020-11-19T11:22:18Z", "type": "commit"}, {"oid": "c03445174bdf38454d45f978f591bc42d880b361", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/c03445174bdf38454d45f978f591bc42d880b361", "message": "Merge branch 'dev-2.x' into otp2_fix_ConcurrentModificationException_in_Avg_timer", "committedDate": "2020-11-19T11:25:40Z", "type": "commit"}, {"oid": "b5afb93567d1e929dabacd7b17dbdb1b53f9e83a", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/b5afb93567d1e929dabacd7b17dbdb1b53f9e83a", "message": "Merge branch 'dev-2.x' into otp2_fix_ConcurrentModificationException_in_Avg_timer", "committedDate": "2020-11-22T23:02:04Z", "type": "commit"}]}