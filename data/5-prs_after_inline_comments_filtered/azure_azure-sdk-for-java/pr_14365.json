{"pr_number": 14365, "pr_title": "Mgmt Appplatform: update and change some API", "pr_createdAt": "2020-08-24T05:03:31Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/14365", "timeline": [{"oid": "d378f6ed644c71b1d1c1362e865f12cf0b624b4e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d378f6ed644c71b1d1c1362e865f12cf0b624b4e", "message": "update api-spec", "committedDate": "2020-08-17T08:11:36Z", "type": "commit"}, {"oid": "6c700c11645fe6c93218b07c9f3c48d73e103477", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6c700c11645fe6c93218b07c9f3c48d73e103477", "message": "generate app platform", "committedDate": "2020-08-17T08:12:09Z", "type": "commit"}, {"oid": "00f92ec050d8016bd8d10aedcf89714874fc89bb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/00f92ec050d8016bd8d10aedcf89714874fc89bb", "message": "fix compile error and update api", "committedDate": "2020-08-17T09:10:24Z", "type": "commit"}, {"oid": "3c3ce08d9a9f73d1609fcb726c0149958daed215", "url": "https://github.com/Azure/azure-sdk-for-java/commit/3c3ce08d9a9f73d1609fcb726c0149958daed215", "message": "update service when needed", "committedDate": "2020-08-18T06:50:49Z", "type": "commit"}, {"oid": "cd8b9023efb39581dbda71892e5a5b27cc9623df", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cd8b9023efb39581dbda71892e5a5b27cc9623df", "message": "add active deployment api", "committedDate": "2020-08-18T06:50:53Z", "type": "commit"}, {"oid": "b7584d188e150860befbcb04c90f8c7783ee1705", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b7584d188e150860befbcb04c90f8c7783ee1705", "message": "remove deploy from app", "committedDate": "2020-08-18T06:53:06Z", "type": "commit"}, {"oid": "f809cbcaaa1480932a041e0228afee9bb5bd3a89", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f809cbcaaa1480932a041e0228afee9bb5bd3a89", "message": "remove setting from other deployment", "committedDate": "2020-08-18T07:22:43Z", "type": "commit"}, {"oid": "1073cec0570cc7939079bca406e77c7731818001", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1073cec0570cc7939079bca406e77c7731818001", "message": "remove useless impl", "committedDate": "2020-08-18T07:23:09Z", "type": "commit"}, {"oid": "934abd47b7e84699702a9a5bd05b28ce8a19b488", "url": "https://github.com/Azure/azure-sdk-for-java/commit/934abd47b7e84699702a9a5bd05b28ce8a19b488", "message": "fix test", "committedDate": "2020-08-18T07:47:14Z", "type": "commit"}, {"oid": "4800b6147332cae1580e035be66fb7aa2f2b35dd", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4800b6147332cae1580e035be66fb7aa2f2b35dd", "message": "remove compression", "committedDate": "2020-08-24T01:56:25Z", "type": "commit"}, {"oid": "7c342d2bdb6e568a801c14f6bc3795f067002385", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7c342d2bdb6e568a801c14f6bc3795f067002385", "message": "compress to test", "committedDate": "2020-08-24T02:05:34Z", "type": "commit"}, {"oid": "a0c0b4097848f8a8cb095bb8c7ca9642ac2a1c5c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a0c0b4097848f8a8cb095bb8c7ca9642ac2a1c5c", "message": "fix test", "committedDate": "2020-08-24T02:23:24Z", "type": "commit"}, {"oid": "59f111d200c86a3489497ff30af4be1ac7d67398", "url": "https://github.com/Azure/azure-sdk-for-java/commit/59f111d200c86a3489497ff30af4be1ac7d67398", "message": "update test", "committedDate": "2020-08-24T03:32:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM1MDI1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14365#discussion_r475350258", "bodyText": "Better to have an object configured, and delay postRunDependency to e.g. beforeCreating", "author": "weidongxu-microsoft", "createdAt": "2020-08-24T05:27:08Z", "path": "sdk/resourcemanager/azure-resourcemanager-appplatform/src/main/java/com/azure/resourcemanager/appplatform/implementation/SpringServiceImpl.java", "diffHunk": "@@ -107,70 +121,80 @@ public SpringServiceImpl withSku(String skuName, int capacity) {\n \n     @Override\n     public SpringServiceImpl withSku(Sku sku) {\n+        needUpdate = true;\n         inner().withSku(sku);\n         return this;\n     }\n \n     @Override\n     public SpringServiceImpl withTracing(String appInsightInstrumentationKey) {\n-        if (inner().properties() == null) {\n-            inner().withProperties(new ClusterResourceProperties());\n-        }\n-        inner().properties().withTrace(\n-            new TraceProperties().withAppInsightInstrumentationKey(appInsightInstrumentationKey).withEnabled(true));\n+        this.addPostRunDependent(\n+            context -> manager().inner().getMonitoringSettings()\n+                .updatePatchAsync(resourceGroupName(), name(), new MonitoringSettingProperties()\n+                    .withAppInsightsInstrumentationKey(appInsightInstrumentationKey)\n+                    .withTraceEnabled(true))\n+                .then(context.voidMono())\n+        );", "originalCommit": "59f111d200c86a3489497ff30af4be1ac7d67398", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7deabea4334f1edbcc8ab9d9cb2d02e592e7ad0e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7deabea4334f1edbcc8ab9d9cb2d02e592e7ad0e", "message": "deployment with instance", "committedDate": "2020-08-24T06:19:18Z", "type": "commit"}, {"oid": "7171542ec40b1a091a819b10a221d2721527374e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7171542ec40b1a091a819b10a221d2721527374e", "message": "update test", "committedDate": "2020-08-24T06:19:53Z", "type": "commit"}, {"oid": "66b6e885ec226fc6bff3f1108245536c1dc8d602", "url": "https://github.com/Azure/azure-sdk-for-java/commit/66b6e885ec226fc6bff3f1108245536c1dc8d602", "message": "prepare for post run", "committedDate": "2020-08-24T08:49:17Z", "type": "commit"}, {"oid": "0f187bd763ea411e416dd605064c0a75b21e98d3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0f187bd763ea411e416dd605064c0a75b21e98d3", "message": "fix checkstyle", "committedDate": "2020-08-25T03:27:27Z", "type": "commit"}, {"oid": "182d111b3c9c556305521786dc551ec0a3676bfb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/182d111b3c9c556305521786dc551ec0a3676bfb", "message": "fix spotbug", "committedDate": "2020-08-25T04:02:20Z", "type": "commit"}]}