{"pr_number": 13687, "pr_title": "[TA] Adding support for PII endpoint", "pr_createdAt": "2020-07-31T15:57:19Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/13687", "timeline": [{"oid": "1666f3986cda9dd375c6042a27400cf9036fbf2a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1666f3986cda9dd375c6042a27400cf9036fbf2a", "message": "added pii endpoint support", "committedDate": "2020-07-31T00:48:45Z", "type": "commit"}, {"oid": "64a8e75070fb30c99cd5f654ddf38e5e8332f789", "url": "https://github.com/Azure/azure-sdk-for-java/commit/64a8e75070fb30c99cd5f654ddf38e5e8332f789", "message": "resolved conflict", "committedDate": "2020-07-31T15:51:27Z", "type": "commit"}, {"oid": "e82b0437b0aa9b1572b40a7c9b57c23ec68aca49", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e82b0437b0aa9b1572b40a7c9b57c23ec68aca49", "message": "added draft review fixes", "committedDate": "2020-07-31T22:00:38Z", "type": "commit"}, {"oid": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "message": "checkstyle", "committedDate": "2020-07-31T22:01:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU3NTc1Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464575756", "bodyText": "nit: since this code is used to get warnings, and there's code to getStatistics earlier on, would it be good to move those into a separate util function? i think this is slightly outside the scope of this PR, but was just wondering if this is something that would help clean up the flow", "author": "iscai-msft", "createdAt": "2020-08-03T18:02:03Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/RecognizePiiEntityAsyncClient.java", "diffHunk": "@@ -0,0 +1,215 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics;\n+\n+import com.azure.ai.textanalytics.implementation.TextAnalyticsClientImpl;\n+import com.azure.ai.textanalytics.implementation.models.EntitiesResult;\n+import com.azure.ai.textanalytics.implementation.models.MultiLanguageBatchInput;\n+import com.azure.ai.textanalytics.implementation.models.WarningCodeValue;\n+import com.azure.ai.textanalytics.models.EntityCategory;\n+import com.azure.ai.textanalytics.models.PiiEntity;\n+import com.azure.ai.textanalytics.models.PiiEntityCollection;\n+import com.azure.ai.textanalytics.models.RecognizePiiEntitiesResult;\n+import com.azure.ai.textanalytics.models.TextAnalyticsRequestOptions;\n+import com.azure.ai.textanalytics.models.TextAnalyticsWarning;\n+import com.azure.ai.textanalytics.models.TextDocumentInput;\n+import com.azure.ai.textanalytics.models.WarningCode;\n+import com.azure.ai.textanalytics.util.RecognizePiiEntitiesResultCollection;\n+import com.azure.core.exception.HttpResponseException;\n+import com.azure.core.http.rest.Response;\n+import com.azure.core.http.rest.SimpleResponse;\n+import com.azure.core.util.Context;\n+import com.azure.core.util.IterableStream;\n+import com.azure.core.util.logging.ClientLogger;\n+import reactor.core.publisher.Mono;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+\n+import static com.azure.ai.textanalytics.TextAnalyticsAsyncClient.COGNITIVE_TRACING_NAMESPACE_VALUE;\n+import static com.azure.ai.textanalytics.implementation.Utility.getEmptyErrorIdHttpResponse;\n+import static com.azure.ai.textanalytics.implementation.Utility.inputDocumentsValidation;\n+import static com.azure.ai.textanalytics.implementation.Utility.mapToHttpResponseExceptionIfExist;\n+import static com.azure.ai.textanalytics.implementation.Utility.toBatchStatistics;\n+import static com.azure.ai.textanalytics.implementation.Utility.toMultiLanguageInput;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsError;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsException;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextDocumentStatistics;\n+import static com.azure.core.util.FluxUtil.monoError;\n+import static com.azure.core.util.FluxUtil.withContext;\n+import static com.azure.core.util.tracing.Tracer.AZ_TRACING_NAMESPACE_KEY;\n+\n+/**\n+ * Helper class for managing recognize personally identifiable information entity endpoint.\n+ */\n+class RecognizePiiEntityAsyncClient {\n+    private final ClientLogger logger = new ClientLogger(RecognizePiiEntityAsyncClient.class);\n+    private final TextAnalyticsClientImpl service;\n+\n+    /**\n+     * Create a {@link RecognizePiiEntityAsyncClient} that sends requests to the Text Analytics services's\n+     * recognize personally identifiable information entity endpoint.\n+     *\n+     * @param service The proxy service used to perform REST calls.\n+     */\n+    RecognizePiiEntityAsyncClient(TextAnalyticsClientImpl service) {\n+        this.service = service;\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters that returns a {@link Mono}\n+     * which contains {@link PiiEntityCollection}.\n+     *\n+     * @param document A single document.\n+     * @param language The language code.\n+     *\n+     * @return The {@link Mono} of {@link PiiEntityCollection}.\n+     */\n+    Mono<PiiEntityCollection> recognizePiiEntities(String document, String language) {\n+        try {\n+            Objects.requireNonNull(document, \"'document' cannot be null.\");\n+            final TextDocumentInput textDocumentInput = new TextDocumentInput(\"0\", document).setLanguage(language);\n+            return recognizePiiEntitiesBatch(Collections.singletonList(textDocumentInput), null)\n+                .map(resultCollectionResponse -> {\n+                    PiiEntityCollection entityCollection = null;\n+                    // for each loop will have only one entry inside\n+                    for (RecognizePiiEntitiesResult entitiesResult : resultCollectionResponse.getValue()) {\n+                        if (entitiesResult.isError()) {\n+                            throw logger.logExceptionAsError(toTextAnalyticsException(entitiesResult.getError()));\n+                        }\n+                        entityCollection = new PiiEntityCollection(entitiesResult.getEntities(),\n+                            entitiesResult.getEntities().getWarnings());\n+                    }\n+                    return entityCollection;\n+                });\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters.\n+     *\n+     * @param documents The list of documents to recognize personally identifiable information entities for.\n+     * @param options The {@link TextAnalyticsRequestOptions} request options.\n+     *\n+     * @return A mono {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    Mono<Response<RecognizePiiEntitiesResultCollection>> recognizePiiEntitiesBatch(\n+        Iterable<TextDocumentInput> documents, TextAnalyticsRequestOptions options) {\n+        try {\n+            inputDocumentsValidation(documents);\n+            return withContext(context -> getRecognizePiiEntitiesResponse(documents, options, context));\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters with {@link Context} is given.\n+     *\n+     * @param documents The list of documents to recognize personally identifiable information entities for.\n+     * @param options The {@link TextAnalyticsRequestOptions} request options.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     *\n+     * @return A mono {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    Mono<Response<RecognizePiiEntitiesResultCollection>> recognizePiiEntitiesBatchWithContext(\n+        Iterable<TextDocumentInput> documents, TextAnalyticsRequestOptions options, Context context) {\n+        try {\n+            inputDocumentsValidation(documents);\n+            return getRecognizePiiEntitiesResponse(documents, options, context);\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Helper method to convert the service response of {@link EntitiesResult} to {@link Response} which contains\n+     * {@link RecognizePiiEntitiesResultCollection}.\n+     *\n+     * @param response the {@link Response} of {@link EntitiesResult} returned by the service.\n+     *\n+     * @return A {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    private Response<RecognizePiiEntitiesResultCollection> toRecognizePiiEntitiesResultCollectionResponse(\n+        final Response<EntitiesResult> response) {\n+        final EntitiesResult entitiesResult = response.getValue();\n+        // List of documents results\n+        final List<RecognizePiiEntitiesResult> recognizeEntitiesResults = new ArrayList<>();\n+        entitiesResult.getDocuments().forEach(documentEntities ->\n+            recognizeEntitiesResults.add(new RecognizePiiEntitiesResult(\n+                documentEntities.getId(),\n+                documentEntities.getStatistics() == null ? null\n+                    : toTextDocumentStatistics(documentEntities.getStatistics()),\n+                null,\n+                new PiiEntityCollection(\n+                    new IterableStream<>(documentEntities.getEntities().stream().map(entity ->\n+                        new PiiEntity(entity.getText(), EntityCategory.fromString(entity.getCategory()),\n+                            entity.getSubcategory(), entity.getOffset(), entity.getLength(),\n+                            entity.getConfidenceScore()))\n+                        .collect(Collectors.toList())),\n+                    new IterableStream<>(documentEntities.getWarnings().stream()", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MzAyNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464593027", "bodyText": "should link to https://aka.ms/tanerpii instead", "author": "iscai-msft", "createdAt": "2020-08-03T18:36:57Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClient.java", "diffHunk": "@@ -364,6 +369,132 @@ public String getDefaultLanguage() {\n         return recognizeEntityAsyncClient.recognizeEntitiesBatch(documents, options);\n     }\n \n+    // PII Entity\n+\n+    /**\n+     * Returns a list of general personally identifiable information entities in the provided document.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/taner\">this</a>.", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MzE3Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464593172", "bodyText": "nit: recognized PII entity details", "author": "iscai-msft", "createdAt": "2020-08-03T18:37:17Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClient.java", "diffHunk": "@@ -364,6 +369,132 @@ public String getDefaultLanguage() {\n         return recognizeEntityAsyncClient.recognizeEntitiesBatch(documents, options);\n     }\n \n+    // PII Entity\n+\n+    /**\n+     * Returns a list of general personally identifiable information entities in the provided document.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/taner\">this</a>.\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>.\n+     * This method will use the default language that sets up in\n+     * {@link TextAnalyticsClientBuilder#defaultLanguage(String)}. If none is specified, service will use 'en' as\n+     * the language.\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * <p>Recognize personally identifiable information entities in a document. Subscribes to the call asynchronously\n+     * and prints out the recognized entity details when a response is received.</p>", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDYwMjM2OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464602369", "bodyText": "i don't think this is something we're exposing yet, but i just asked the question in the scrum chat to see if i can get some clairification", "author": "iscai-msft", "createdAt": "2020-08-03T18:56:21Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/TextAnalyticsRequestOptions.java", "diffHunk": "@@ -54,4 +55,24 @@ public TextAnalyticsRequestOptions setIncludeStatistics(boolean includeStatistic\n         this.includeStatistics = includeStatistics;\n         return this;\n     }\n+\n+    /**\n+     * Get the value of {@code domain}.\n+     *\n+     * @return the value of domain.\n+     */\n+    public String getDomain() {\n+        return domain;\n+    }\n+\n+    /**\n+     * Set the value of {@code domain}.\n+     *\n+     * @param domain (Optional) if set to 'PHI', response will contain only PHI entities.\n+     * @return the {@link TextAnalyticsRequestOptions} object itself.\n+     */\n+    public TextAnalyticsRequestOptions setDomain(String domain) {", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MDA3MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464760071", "bodyText": "we can remove this now :) Azure/azure-sdk-for-net#11946", "author": "maririos", "createdAt": "2020-08-04T02:20:24Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/RecognizePiiEntityAsyncClient.java", "diffHunk": "@@ -0,0 +1,215 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics;\n+\n+import com.azure.ai.textanalytics.implementation.TextAnalyticsClientImpl;\n+import com.azure.ai.textanalytics.implementation.models.EntitiesResult;\n+import com.azure.ai.textanalytics.implementation.models.MultiLanguageBatchInput;\n+import com.azure.ai.textanalytics.implementation.models.WarningCodeValue;\n+import com.azure.ai.textanalytics.models.EntityCategory;\n+import com.azure.ai.textanalytics.models.PiiEntity;\n+import com.azure.ai.textanalytics.models.PiiEntityCollection;\n+import com.azure.ai.textanalytics.models.RecognizePiiEntitiesResult;\n+import com.azure.ai.textanalytics.models.TextAnalyticsRequestOptions;\n+import com.azure.ai.textanalytics.models.TextAnalyticsWarning;\n+import com.azure.ai.textanalytics.models.TextDocumentInput;\n+import com.azure.ai.textanalytics.models.WarningCode;\n+import com.azure.ai.textanalytics.util.RecognizePiiEntitiesResultCollection;\n+import com.azure.core.exception.HttpResponseException;\n+import com.azure.core.http.rest.Response;\n+import com.azure.core.http.rest.SimpleResponse;\n+import com.azure.core.util.Context;\n+import com.azure.core.util.IterableStream;\n+import com.azure.core.util.logging.ClientLogger;\n+import reactor.core.publisher.Mono;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+\n+import static com.azure.ai.textanalytics.TextAnalyticsAsyncClient.COGNITIVE_TRACING_NAMESPACE_VALUE;\n+import static com.azure.ai.textanalytics.implementation.Utility.getEmptyErrorIdHttpResponse;\n+import static com.azure.ai.textanalytics.implementation.Utility.inputDocumentsValidation;\n+import static com.azure.ai.textanalytics.implementation.Utility.mapToHttpResponseExceptionIfExist;\n+import static com.azure.ai.textanalytics.implementation.Utility.toBatchStatistics;\n+import static com.azure.ai.textanalytics.implementation.Utility.toMultiLanguageInput;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsError;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsException;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextDocumentStatistics;\n+import static com.azure.core.util.FluxUtil.monoError;\n+import static com.azure.core.util.FluxUtil.withContext;\n+import static com.azure.core.util.tracing.Tracer.AZ_TRACING_NAMESPACE_KEY;\n+\n+/**\n+ * Helper class for managing recognize personally identifiable information entity endpoint.\n+ */\n+class RecognizePiiEntityAsyncClient {\n+    private final ClientLogger logger = new ClientLogger(RecognizePiiEntityAsyncClient.class);\n+    private final TextAnalyticsClientImpl service;\n+\n+    /**\n+     * Create a {@link RecognizePiiEntityAsyncClient} that sends requests to the Text Analytics services's\n+     * recognize personally identifiable information entity endpoint.\n+     *\n+     * @param service The proxy service used to perform REST calls.\n+     */\n+    RecognizePiiEntityAsyncClient(TextAnalyticsClientImpl service) {\n+        this.service = service;\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters that returns a {@link Mono}\n+     * which contains {@link PiiEntityCollection}.\n+     *\n+     * @param document A single document.\n+     * @param language The language code.\n+     *\n+     * @return The {@link Mono} of {@link PiiEntityCollection}.\n+     */\n+    Mono<PiiEntityCollection> recognizePiiEntities(String document, String language) {\n+        try {\n+            Objects.requireNonNull(document, \"'document' cannot be null.\");\n+            final TextDocumentInput textDocumentInput = new TextDocumentInput(\"0\", document).setLanguage(language);\n+            return recognizePiiEntitiesBatch(Collections.singletonList(textDocumentInput), null)\n+                .map(resultCollectionResponse -> {\n+                    PiiEntityCollection entityCollection = null;\n+                    // for each loop will have only one entry inside\n+                    for (RecognizePiiEntitiesResult entitiesResult : resultCollectionResponse.getValue()) {\n+                        if (entitiesResult.isError()) {\n+                            throw logger.logExceptionAsError(toTextAnalyticsException(entitiesResult.getError()));\n+                        }\n+                        entityCollection = new PiiEntityCollection(entitiesResult.getEntities(),\n+                            entitiesResult.getEntities().getWarnings());\n+                    }\n+                    return entityCollection;\n+                });\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters.\n+     *\n+     * @param documents The list of documents to recognize personally identifiable information entities for.\n+     * @param options The {@link TextAnalyticsRequestOptions} request options.\n+     *\n+     * @return A mono {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    Mono<Response<RecognizePiiEntitiesResultCollection>> recognizePiiEntitiesBatch(\n+        Iterable<TextDocumentInput> documents, TextAnalyticsRequestOptions options) {\n+        try {\n+            inputDocumentsValidation(documents);\n+            return withContext(context -> getRecognizePiiEntitiesResponse(documents, options, context));\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters with {@link Context} is given.\n+     *\n+     * @param documents The list of documents to recognize personally identifiable information entities for.\n+     * @param options The {@link TextAnalyticsRequestOptions} request options.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     *\n+     * @return A mono {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    Mono<Response<RecognizePiiEntitiesResultCollection>> recognizePiiEntitiesBatchWithContext(\n+        Iterable<TextDocumentInput> documents, TextAnalyticsRequestOptions options, Context context) {\n+        try {\n+            inputDocumentsValidation(documents);\n+            return getRecognizePiiEntitiesResponse(documents, options, context);\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Helper method to convert the service response of {@link EntitiesResult} to {@link Response} which contains\n+     * {@link RecognizePiiEntitiesResultCollection}.\n+     *\n+     * @param response the {@link Response} of {@link EntitiesResult} returned by the service.\n+     *\n+     * @return A {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    private Response<RecognizePiiEntitiesResultCollection> toRecognizePiiEntitiesResultCollectionResponse(\n+        final Response<EntitiesResult> response) {\n+        final EntitiesResult entitiesResult = response.getValue();\n+        // List of documents results\n+        final List<RecognizePiiEntitiesResult> recognizeEntitiesResults = new ArrayList<>();\n+        entitiesResult.getDocuments().forEach(documentEntities ->\n+            recognizeEntitiesResults.add(new RecognizePiiEntitiesResult(\n+                documentEntities.getId(),\n+                documentEntities.getStatistics() == null ? null\n+                    : toTextDocumentStatistics(documentEntities.getStatistics()),\n+                null,\n+                new PiiEntityCollection(\n+                    new IterableStream<>(documentEntities.getEntities().stream().map(entity ->\n+                        new PiiEntity(entity.getText(), EntityCategory.fromString(entity.getCategory()),\n+                            entity.getSubcategory(), entity.getOffset(), entity.getLength(),\n+                            entity.getConfidenceScore()))\n+                        .collect(Collectors.toList())),\n+                    new IterableStream<>(documentEntities.getWarnings().stream()\n+                        .map(warning -> {\n+                            final WarningCodeValue warningCodeValue = warning.getCode();\n+                            return new TextAnalyticsWarning(\n+                                WarningCode.fromString(warningCodeValue == null ? null : warningCodeValue.toString()),\n+                                warning.getMessage());\n+                        }).collect(Collectors.toList())))\n+            )));\n+        // Document errors\n+        entitiesResult.getErrors().forEach(documentError -> {\n+            /*\n+             *  TODO: Remove this after service update to throw exception.", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MDU0Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464760542", "bodyText": "not sure the word \"general\" provides value here... consider removing", "author": "maririos", "createdAt": "2020-08-04T02:22:17Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClient.java", "diffHunk": "@@ -364,6 +369,132 @@ public String getDefaultLanguage() {\n         return recognizeEntityAsyncClient.recognizeEntitiesBatch(documents, options);\n     }\n \n+    // PII Entity\n+\n+    /**\n+     * Returns a list of general personally identifiable information entities in the provided document.", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MTI4MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464761280", "bodyText": "same here and other places", "author": "maririos", "createdAt": "2020-08-04T02:25:20Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClient.java", "diffHunk": "@@ -364,6 +369,132 @@ public String getDefaultLanguage() {\n         return recognizeEntityAsyncClient.recognizeEntitiesBatch(documents, options);\n     }\n \n+    // PII Entity\n+\n+    /**\n+     * Returns a list of general personally identifiable information entities in the provided document.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/taner\">this</a>.\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>.\n+     * This method will use the default language that sets up in\n+     * {@link TextAnalyticsClientBuilder#defaultLanguage(String)}. If none is specified, service will use 'en' as\n+     * the language.\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * <p>Recognize personally identifiable information entities in a document. Subscribes to the call asynchronously\n+     * and prints out the recognized entity details when a response is received.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsAsyncClient.recognizePiiEntities#string}\n+     *\n+     * @param document The document to recognize personally identifiable information entities for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     *\n+     * @return A {@link Mono} contains a\n+     * {@link PiiEntityCollection recognized personally identifiable information entities collection}.\n+     *\n+     * @throws NullPointerException if {@code document} is null.\n+     * @throws TextAnalyticsException if the response returned with an {@link TextAnalyticsError error}.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<PiiEntityCollection> recognizePiiEntities(String document) {\n+        return recognizePiiEntities(document, defaultLanguage);\n+    }\n+\n+    /**\n+     * Returns a list of general personally identifiable information entities in the provided document.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/taner\">this</a>.\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>.\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * <p>Recognize personally identifiable information entities in a document with provided language code. Subscribes\n+     * to the call asynchronously and prints out the entity details when a response is received.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsAsyncClient.recognizePiiEntities#string-string}\n+     *\n+     * @param document the text to recognize personally identifiable information entities for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     * @param language The 2 letter ISO 639-1 representation of language. If not set, uses \"en\" for English as\n+     * default.\n+     *\n+     * @return A {@link Mono} contains a\n+     * {@link PiiEntityCollection recognized personally identifiable information entities collection}.\n+     *\n+     * @throws NullPointerException if {@code document} is null.\n+     * @throws TextAnalyticsException if the response returned with an {@link TextAnalyticsError error}.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<PiiEntityCollection> recognizePiiEntities(String document, String language) {\n+        return recognizePiiEntityAsyncClient.recognizePiiEntities(document, language);\n+    }\n+\n+    /**\n+     * Returns a list of general personally identifiable information entities for the provided list of documents with", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MTg3OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464761878", "bodyText": "Do you think we should have a specific enum for PII entity categories?", "author": "maririos", "createdAt": "2020-08-04T02:27:52Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/PiiEntity.java", "diffHunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics.models;\n+\n+import com.azure.core.annotation.Immutable;\n+\n+/**\n+ * The {@link PiiEntity} model.\n+ */\n+@Immutable\n+public final class PiiEntity {\n+    /*\n+     * PiiEntity text as appears in the request.\n+     */\n+    private final String text;\n+\n+    /*\n+     * PiiEntity category, such as Person/Location/Org/SSN etc\n+     */\n+    private final EntityCategory category;", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE1MzE2OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r467153168", "bodyText": "Agreed. We could have a PiiEntityCatogry type since the category type varies. Also we could add HealthEntityCategory for the health endpoint as well in the future.\nhttps://docs.microsoft.com/en-us/azure/cognitive-services/text-analytics/named-entity-types?tabs=personal", "author": "mssfang", "createdAt": "2020-08-07T16:46:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MTg3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIwMDQ3Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r467200473", "bodyText": "hmmm I like it... my worry is if endpoints start mixing what type of entities they return.\nFor example, if PPI returns HealthCareEntity then this approach won't work...\nWhen in PII we set domain... are those protected health information entities different than the ones in HealthCareEntity?", "author": "maririos", "createdAt": "2020-08-07T18:23:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MTg3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY5OTM1MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469699351", "bodyText": "deleted all domain related.", "author": "mssfang", "createdAt": "2020-08-13T05:07:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MTg3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MTk1NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464761954", "bodyText": "not sure this subcategories are actually for PII", "author": "maririos", "createdAt": "2020-08-04T02:28:14Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/PiiEntity.java", "diffHunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics.models;\n+\n+import com.azure.core.annotation.Immutable;\n+\n+/**\n+ * The {@link PiiEntity} model.\n+ */\n+@Immutable\n+public final class PiiEntity {\n+    /*\n+     * PiiEntity text as appears in the request.\n+     */\n+    private final String text;\n+\n+    /*\n+     * PiiEntity category, such as Person/Location/Org/SSN etc\n+     */\n+    private final EntityCategory category;\n+\n+    /*\n+     * PiiEntity sub category, such as Age/Year/TimeRange etc", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MjE0Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464762146", "bodyText": "same here", "author": "maririos", "createdAt": "2020-08-04T02:29:05Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/PiiEntity.java", "diffHunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics.models;\n+\n+import com.azure.core.annotation.Immutable;\n+\n+/**\n+ * The {@link PiiEntity} model.\n+ */\n+@Immutable\n+public final class PiiEntity {\n+    /*\n+     * PiiEntity text as appears in the request.\n+     */\n+    private final String text;\n+\n+    /*\n+     * PiiEntity category, such as Person/Location/Org/SSN etc\n+     */\n+    private final EntityCategory category;\n+\n+    /*\n+     * PiiEntity sub category, such as Age/Year/TimeRange etc\n+     */\n+    private final String subcategory;\n+\n+    /*\n+     * Start position for the entity text.\n+     */\n+    private final int offset;\n+\n+    /*\n+     * The length for the entity text.\n+     */\n+    private final int length;\n+\n+    /*\n+     * Confidence score between 0 and 1 of the extracted entity.\n+     */\n+    private final double confidenceScore;\n+\n+    /**\n+     * Creates a {@link PiiEntity} model that describes entity.\n+     *\n+     * @param text The entity text as appears in the request.\n+     * @param category The entity category, such as Person/Location/Org/SSN etc.\n+     * @param subcategory The entity subcategory, such as Age/Year/TimeRange etc.", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MjIwNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464762205", "bodyText": "and other places", "author": "maririos", "createdAt": "2020-08-04T02:29:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MjE0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MjUzMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464762533", "bodyText": "also, the way it is presented here, it seems like other endpoints could use the domain property too. I'm still unclear of the scope of this property so better leave it out until we fully understand it", "author": "maririos", "createdAt": "2020-08-04T02:30:34Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/TextAnalyticsRequestOptions.java", "diffHunk": "@@ -54,4 +55,24 @@ public TextAnalyticsRequestOptions setIncludeStatistics(boolean includeStatistic\n         this.includeStatistics = includeStatistics;\n         return this;\n     }\n+\n+    /**\n+     * Get the value of {@code domain}.\n+     *\n+     * @return the value of domain.\n+     */\n+    public String getDomain() {\n+        return domain;\n+    }\n+\n+    /**\n+     * Set the value of {@code domain}.\n+     *\n+     * @param domain (Optional) if set to 'PHI', response will contain only PHI entities.\n+     * @return the {@link TextAnalyticsRequestOptions} object itself.\n+     */\n+    public TextAnalyticsRequestOptions setDomain(String domain) {", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE4MTA2Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r467181063", "bodyText": "yup. Will leave it out for now.", "author": "mssfang", "createdAt": "2020-08-07T17:43:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MjUzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MzcwOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464763709", "bodyText": "as we are including offset and length again. should we print that too?", "author": "maririos", "createdAt": "2020-08-04T02:35:11Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/samples/java/com/azure/ai/textanalytics/ReadmeSamples.java", "diffHunk": "@@ -150,4 +150,14 @@ public void extractKeyPhrases() {\n         System.out.println(\"Extracted phrases:\");\n         textAnalyticsClient.extractKeyPhrases(document).forEach(keyPhrase -> System.out.printf(\"%s.%n\", keyPhrase));\n     }\n+\n+    /**\n+     * Code snippet for recognizing Personally Identifiable Information entity in a document.\n+     */\n+    public void recognizePiiEntity() {\n+        String document = \"My SSN is 555-55-5555\";\n+        textAnalyticsClient.recognizePiiEntities(document).forEach(piiEntity ->\n+            System.out.printf(\"Recognized Personally Identifiable Information entity: %s, category: %s, subCategory: %s, score: %f.%n\",", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQxNDE1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r470414158", "bodyText": "offset and length will be include in samples but not on codesnippet and reamde samples", "author": "mssfang", "createdAt": "2020-08-14T05:14:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MzcwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2NDI5Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464764297", "bodyText": "consider using 859-98-0987. Same for other places", "author": "maririos", "createdAt": "2020-08-04T02:37:30Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/samples/java/com/azure/ai/textanalytics/RecognizePiiEntities.java", "diffHunk": "@@ -0,0 +1,34 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics;\n+\n+\n+import com.azure.core.credential.AzureKeyCredential;\n+import com.azure.core.util.Configuration;\n+\n+/**\n+ * Sample demonstrates how to recognize the Personally Identifiable Information entities of document.\n+ */\n+public class RecognizePiiEntities {\n+    /**\n+     * Main method to invoke this demo about how to recognize the Personally Identifiable Information entities of\n+     * document.\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {\n+        // Instantiate a client that will be used to call the service.\n+        TextAnalyticsClient client = new TextAnalyticsClientBuilder()\n+            .credential(new AzureKeyCredential(Configuration.getGlobalConfiguration().get(\"AZURE_TEXT_ANALYTICS_API_KEY\")))\n+            .endpoint(Configuration.getGlobalConfiguration().get(\"AZURE_TEXT_ANALYTICS_ENDPOINT\"))\n+            .buildClient();\n+\n+        // The document that needs be analyzed.\n+        String document = \"My SSN is 555-55-5555\";", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE1NTIzMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r467155231", "bodyText": "why this SSN number, it seems like a more real SSN number that 55555555.", "author": "mssfang", "createdAt": "2020-08-07T16:50:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2NDI5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIwMjM0MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r467202341", "bodyText": "is the one the service recommended us to use. You have a combination of that and 55555555 so I guess for consistency just choose one for all your test", "author": "maririos", "createdAt": "2020-08-07T18:27:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2NDI5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2NDU3Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r464764576", "bodyText": "Some places say \"Recognized Personally Identifiable Information entity\" I prefer this one too, but whichever you pick, better to have consistency in the samples", "author": "maririos", "createdAt": "2020-08-04T02:38:42Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/samples/java/com/azure/ai/textanalytics/RecognizePiiEntitiesAsync.java", "diffHunk": "@@ -0,0 +1,46 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics;\n+\n+import com.azure.core.credential.AzureKeyCredential;\n+import com.azure.core.util.Configuration;\n+\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * Sample demonstrates how to recognize the Personally Identifiable Information entities of document.\n+ */\n+public class RecognizePiiEntitiesAsync {\n+    /**\n+     * Main method to invoke this demo about how to recognize the Personally Identifiable Information entities of document.\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {\n+        // Instantiate a client that will be used to call the service.\n+        TextAnalyticsAsyncClient client = new TextAnalyticsClientBuilder()\n+            .credential(new AzureKeyCredential(Configuration.getGlobalConfiguration().get(\"AZURE_TEXT_ANALYTICS_API_KEY\")))\n+            .endpoint(Configuration.getGlobalConfiguration().get(\"AZURE_TEXT_ANALYTICS_ENDPOINT\"))\n+            .buildAsyncClient();\n+\n+        // The document that needs be analyzed.\n+        String document = \"Microsoft employee with ssn 859-98-0987 is using our awesome API's.\";\n+\n+        client.recognizePiiEntities(document).subscribe(\n+            entityCollection -> entityCollection.forEach(entity -> System.out.printf(\n+                \"Recognized personal identifiable information entity: %s, entity category: %s, entity sub-category: %s, score: %f.%n\",", "originalCommit": "a6e0c5c4e979daad1d854ee42f1a55fcb3583dc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "09b425ae0c48b79bf884fb06ad3625e1ed82bc28", "url": "https://github.com/Azure/azure-sdk-for-java/commit/09b425ae0c48b79bf884fb06ad3625e1ed82bc28", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into TA-PII", "committedDate": "2020-08-07T14:13:05Z", "type": "commit"}, {"oid": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6cf6e707c9d0f5339d289d1f981c166d3233c58e", "message": "address feedbacks round 1", "committedDate": "2020-08-07T18:04:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIwNjY2NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r467206665", "bodyText": "instead of comment out I prefer deleting... better to introduce than to leave dead code in case the service changes the parameter", "author": "maririos", "createdAt": "2020-08-07T18:37:07Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/test/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClientTest.java", "diffHunk": "@@ -455,16 +454,16 @@ public void recognizePiiEntitiesTooManyDocuments(HttpClient httpClient, TextAnal\n                 }));\n     }\n \n-    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n-    @MethodSource(\"com.azure.ai.textanalytics.TestUtils#getTestParameters\")\n-    public void recognizePiiEntitiesWithDomain(HttpClient httpClient, TextAnalyticsServiceVersion serviceVersion) {\n-        client = getTextAnalyticsAsyncClient(httpClient, serviceVersion);\n-        recognizePiiEntitiesWithDomainRunner((inputs, options) ->\n-            StepVerifier.create(client.recognizePiiEntitiesBatch(inputs, null, options))\n-                .assertNext(response -> validatePiiEntitiesResultCollection(true,\n-                    getExpectedBatchPiiEntitiesWithDomainSpecified(), response))\n-                .verifyComplete());\n-    }\n+//    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1Mjk3MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469452970", "bodyText": "You don't need the service version info here?", "author": "samvaity", "createdAt": "2020-08-12T18:19:58Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/RecognizePiiEntityAsyncClient.java", "diffHunk": "@@ -0,0 +1,205 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics;\n+\n+import com.azure.ai.textanalytics.implementation.TextAnalyticsClientImpl;\n+import com.azure.ai.textanalytics.implementation.models.EntitiesResult;\n+import com.azure.ai.textanalytics.implementation.models.MultiLanguageBatchInput;\n+import com.azure.ai.textanalytics.implementation.models.WarningCodeValue;\n+import com.azure.ai.textanalytics.models.EntityCategory;\n+import com.azure.ai.textanalytics.models.PiiEntity;\n+import com.azure.ai.textanalytics.models.PiiEntityCollection;\n+import com.azure.ai.textanalytics.models.RecognizePiiEntitiesResult;\n+import com.azure.ai.textanalytics.models.TextAnalyticsRequestOptions;\n+import com.azure.ai.textanalytics.models.TextAnalyticsWarning;\n+import com.azure.ai.textanalytics.models.TextDocumentInput;\n+import com.azure.ai.textanalytics.models.WarningCode;\n+import com.azure.ai.textanalytics.util.RecognizePiiEntitiesResultCollection;\n+import com.azure.core.http.rest.Response;\n+import com.azure.core.http.rest.SimpleResponse;\n+import com.azure.core.util.Context;\n+import com.azure.core.util.IterableStream;\n+import com.azure.core.util.logging.ClientLogger;\n+import reactor.core.publisher.Mono;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+\n+import static com.azure.ai.textanalytics.TextAnalyticsAsyncClient.COGNITIVE_TRACING_NAMESPACE_VALUE;\n+import static com.azure.ai.textanalytics.implementation.Utility.inputDocumentsValidation;\n+import static com.azure.ai.textanalytics.implementation.Utility.mapToHttpResponseExceptionIfExist;\n+import static com.azure.ai.textanalytics.implementation.Utility.toBatchStatistics;\n+import static com.azure.ai.textanalytics.implementation.Utility.toMultiLanguageInput;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsError;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsException;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextDocumentStatistics;\n+import static com.azure.core.util.FluxUtil.monoError;\n+import static com.azure.core.util.FluxUtil.withContext;\n+import static com.azure.core.util.tracing.Tracer.AZ_TRACING_NAMESPACE_KEY;\n+\n+/**\n+ * Helper class for managing recognize Personally Identifiable Information entity endpoint.\n+ */\n+class RecognizePiiEntityAsyncClient {\n+    private final ClientLogger logger = new ClientLogger(RecognizePiiEntityAsyncClient.class);\n+    private final TextAnalyticsClientImpl service;\n+\n+    /**\n+     * Create a {@link RecognizePiiEntityAsyncClient} that sends requests to the Text Analytics services's\n+     * recognize Personally Identifiable Information entity endpoint.\n+     *\n+     * @param service The proxy service used to perform REST calls.\n+     */\n+    RecognizePiiEntityAsyncClient(TextAnalyticsClientImpl service) {", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY5NDU3Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469694572", "bodyText": "for supporting multiple service API version? If it is the case, it will be need to be addressed in this issue: #14050", "author": "mssfang", "createdAt": "2020-08-13T04:49:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1Mjk3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1MzY0NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469453645", "bodyText": "nit: no need for extra variable creation here.", "author": "samvaity", "createdAt": "2020-08-12T18:21:06Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/RecognizePiiEntityAsyncClient.java", "diffHunk": "@@ -0,0 +1,205 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics;\n+\n+import com.azure.ai.textanalytics.implementation.TextAnalyticsClientImpl;\n+import com.azure.ai.textanalytics.implementation.models.EntitiesResult;\n+import com.azure.ai.textanalytics.implementation.models.MultiLanguageBatchInput;\n+import com.azure.ai.textanalytics.implementation.models.WarningCodeValue;\n+import com.azure.ai.textanalytics.models.EntityCategory;\n+import com.azure.ai.textanalytics.models.PiiEntity;\n+import com.azure.ai.textanalytics.models.PiiEntityCollection;\n+import com.azure.ai.textanalytics.models.RecognizePiiEntitiesResult;\n+import com.azure.ai.textanalytics.models.TextAnalyticsRequestOptions;\n+import com.azure.ai.textanalytics.models.TextAnalyticsWarning;\n+import com.azure.ai.textanalytics.models.TextDocumentInput;\n+import com.azure.ai.textanalytics.models.WarningCode;\n+import com.azure.ai.textanalytics.util.RecognizePiiEntitiesResultCollection;\n+import com.azure.core.http.rest.Response;\n+import com.azure.core.http.rest.SimpleResponse;\n+import com.azure.core.util.Context;\n+import com.azure.core.util.IterableStream;\n+import com.azure.core.util.logging.ClientLogger;\n+import reactor.core.publisher.Mono;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+\n+import static com.azure.ai.textanalytics.TextAnalyticsAsyncClient.COGNITIVE_TRACING_NAMESPACE_VALUE;\n+import static com.azure.ai.textanalytics.implementation.Utility.inputDocumentsValidation;\n+import static com.azure.ai.textanalytics.implementation.Utility.mapToHttpResponseExceptionIfExist;\n+import static com.azure.ai.textanalytics.implementation.Utility.toBatchStatistics;\n+import static com.azure.ai.textanalytics.implementation.Utility.toMultiLanguageInput;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsError;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsException;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextDocumentStatistics;\n+import static com.azure.core.util.FluxUtil.monoError;\n+import static com.azure.core.util.FluxUtil.withContext;\n+import static com.azure.core.util.tracing.Tracer.AZ_TRACING_NAMESPACE_KEY;\n+\n+/**\n+ * Helper class for managing recognize Personally Identifiable Information entity endpoint.\n+ */\n+class RecognizePiiEntityAsyncClient {\n+    private final ClientLogger logger = new ClientLogger(RecognizePiiEntityAsyncClient.class);\n+    private final TextAnalyticsClientImpl service;\n+\n+    /**\n+     * Create a {@link RecognizePiiEntityAsyncClient} that sends requests to the Text Analytics services's\n+     * recognize Personally Identifiable Information entity endpoint.\n+     *\n+     * @param service The proxy service used to perform REST calls.\n+     */\n+    RecognizePiiEntityAsyncClient(TextAnalyticsClientImpl service) {\n+        this.service = service;\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters that returns a {@link Mono}\n+     * which contains {@link PiiEntityCollection}.\n+     *\n+     * @param document A single document.\n+     * @param language The language code.\n+     *\n+     * @return The {@link Mono} of {@link PiiEntityCollection}.\n+     */\n+    Mono<PiiEntityCollection> recognizePiiEntities(String document, String language) {\n+        try {\n+            Objects.requireNonNull(document, \"'document' cannot be null.\");\n+            final TextDocumentInput textDocumentInput = new TextDocumentInput(\"0\", document).setLanguage(language);", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1NDI2Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469454266", "bodyText": "Should it be fine to log PII information here?", "author": "samvaity", "createdAt": "2020-08-12T18:22:16Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/RecognizePiiEntityAsyncClient.java", "diffHunk": "@@ -0,0 +1,205 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics;\n+\n+import com.azure.ai.textanalytics.implementation.TextAnalyticsClientImpl;\n+import com.azure.ai.textanalytics.implementation.models.EntitiesResult;\n+import com.azure.ai.textanalytics.implementation.models.MultiLanguageBatchInput;\n+import com.azure.ai.textanalytics.implementation.models.WarningCodeValue;\n+import com.azure.ai.textanalytics.models.EntityCategory;\n+import com.azure.ai.textanalytics.models.PiiEntity;\n+import com.azure.ai.textanalytics.models.PiiEntityCollection;\n+import com.azure.ai.textanalytics.models.RecognizePiiEntitiesResult;\n+import com.azure.ai.textanalytics.models.TextAnalyticsRequestOptions;\n+import com.azure.ai.textanalytics.models.TextAnalyticsWarning;\n+import com.azure.ai.textanalytics.models.TextDocumentInput;\n+import com.azure.ai.textanalytics.models.WarningCode;\n+import com.azure.ai.textanalytics.util.RecognizePiiEntitiesResultCollection;\n+import com.azure.core.http.rest.Response;\n+import com.azure.core.http.rest.SimpleResponse;\n+import com.azure.core.util.Context;\n+import com.azure.core.util.IterableStream;\n+import com.azure.core.util.logging.ClientLogger;\n+import reactor.core.publisher.Mono;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+\n+import static com.azure.ai.textanalytics.TextAnalyticsAsyncClient.COGNITIVE_TRACING_NAMESPACE_VALUE;\n+import static com.azure.ai.textanalytics.implementation.Utility.inputDocumentsValidation;\n+import static com.azure.ai.textanalytics.implementation.Utility.mapToHttpResponseExceptionIfExist;\n+import static com.azure.ai.textanalytics.implementation.Utility.toBatchStatistics;\n+import static com.azure.ai.textanalytics.implementation.Utility.toMultiLanguageInput;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsError;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextAnalyticsException;\n+import static com.azure.ai.textanalytics.implementation.Utility.toTextDocumentStatistics;\n+import static com.azure.core.util.FluxUtil.monoError;\n+import static com.azure.core.util.FluxUtil.withContext;\n+import static com.azure.core.util.tracing.Tracer.AZ_TRACING_NAMESPACE_KEY;\n+\n+/**\n+ * Helper class for managing recognize Personally Identifiable Information entity endpoint.\n+ */\n+class RecognizePiiEntityAsyncClient {\n+    private final ClientLogger logger = new ClientLogger(RecognizePiiEntityAsyncClient.class);\n+    private final TextAnalyticsClientImpl service;\n+\n+    /**\n+     * Create a {@link RecognizePiiEntityAsyncClient} that sends requests to the Text Analytics services's\n+     * recognize Personally Identifiable Information entity endpoint.\n+     *\n+     * @param service The proxy service used to perform REST calls.\n+     */\n+    RecognizePiiEntityAsyncClient(TextAnalyticsClientImpl service) {\n+        this.service = service;\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters that returns a {@link Mono}\n+     * which contains {@link PiiEntityCollection}.\n+     *\n+     * @param document A single document.\n+     * @param language The language code.\n+     *\n+     * @return The {@link Mono} of {@link PiiEntityCollection}.\n+     */\n+    Mono<PiiEntityCollection> recognizePiiEntities(String document, String language) {\n+        try {\n+            Objects.requireNonNull(document, \"'document' cannot be null.\");\n+            final TextDocumentInput textDocumentInput = new TextDocumentInput(\"0\", document).setLanguage(language);\n+            return recognizePiiEntitiesBatch(Collections.singletonList(textDocumentInput), null)\n+                .map(resultCollectionResponse -> {\n+                    PiiEntityCollection entityCollection = null;\n+                    // for each loop will have only one entry inside\n+                    for (RecognizePiiEntitiesResult entitiesResult : resultCollectionResponse.getValue()) {\n+                        if (entitiesResult.isError()) {\n+                            throw logger.logExceptionAsError(toTextAnalyticsException(entitiesResult.getError()));\n+                        }\n+                        entityCollection = new PiiEntityCollection(entitiesResult.getEntities(),\n+                            entitiesResult.getEntities().getWarnings());\n+                    }\n+                    return entityCollection;\n+                });\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters.\n+     *\n+     * @param documents The list of documents to recognize Personally Identifiable Information entities for.\n+     * @param options The {@link TextAnalyticsRequestOptions} request options.\n+     *\n+     * @return A mono {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    Mono<Response<RecognizePiiEntitiesResultCollection>> recognizePiiEntitiesBatch(\n+        Iterable<TextDocumentInput> documents, TextAnalyticsRequestOptions options) {\n+        try {\n+            inputDocumentsValidation(documents);\n+            return withContext(context -> getRecognizePiiEntitiesResponse(documents, options, context));\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Helper function for calling service with max overloaded parameters with {@link Context} is given.\n+     *\n+     * @param documents The list of documents to recognize Personally Identifiable Information entities for.\n+     * @param options The {@link TextAnalyticsRequestOptions} request options.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     *\n+     * @return A mono {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    Mono<Response<RecognizePiiEntitiesResultCollection>> recognizePiiEntitiesBatchWithContext(\n+        Iterable<TextDocumentInput> documents, TextAnalyticsRequestOptions options, Context context) {\n+        try {\n+            inputDocumentsValidation(documents);\n+            return getRecognizePiiEntitiesResponse(documents, options, context);\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Helper method to convert the service response of {@link EntitiesResult} to {@link Response} which contains\n+     * {@link RecognizePiiEntitiesResultCollection}.\n+     *\n+     * @param response the {@link Response} of {@link EntitiesResult} returned by the service.\n+     *\n+     * @return A {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    private Response<RecognizePiiEntitiesResultCollection> toRecognizePiiEntitiesResultCollectionResponse(\n+        final Response<EntitiesResult> response) {\n+        final EntitiesResult entitiesResult = response.getValue();\n+        // List of documents results\n+        final List<RecognizePiiEntitiesResult> recognizeEntitiesResults = new ArrayList<>();\n+        entitiesResult.getDocuments().forEach(documentEntities -> {\n+            // Pii entities list\n+            final List<PiiEntity> piiEntities = documentEntities.getEntities().stream().map(entity ->\n+                new PiiEntity(entity.getText(), EntityCategory.fromString(entity.getCategory()),\n+                    entity.getSubcategory(), entity.getOffset(), entity.getLength(),\n+                    entity.getConfidenceScore()))\n+                .collect(Collectors.toList());\n+            // Warnings\n+            final List<TextAnalyticsWarning> warnings = documentEntities.getWarnings().stream()\n+                .map(warning -> {\n+                    final WarningCodeValue warningCodeValue = warning.getCode();\n+                    return new TextAnalyticsWarning(\n+                        WarningCode.fromString(warningCodeValue == null ? null : warningCodeValue.toString()),\n+                        warning.getMessage());\n+                }).collect(Collectors.toList());\n+\n+            recognizeEntitiesResults.add(new RecognizePiiEntitiesResult(\n+                documentEntities.getId(),\n+                documentEntities.getStatistics() == null ? null\n+                    : toTextDocumentStatistics(documentEntities.getStatistics()),\n+                null,\n+                new PiiEntityCollection(new IterableStream<>(piiEntities), new IterableStream<>(warnings))\n+            ));\n+        });\n+        // Document errors\n+        entitiesResult.getErrors().forEach(documentError -> {\n+            recognizeEntitiesResults.add(\n+                new RecognizePiiEntitiesResult(documentError.getId(), null,\n+                    toTextAnalyticsError(documentError.getError()), null));\n+        });\n+\n+        return new SimpleResponse<>(response,\n+            new RecognizePiiEntitiesResultCollection(recognizeEntitiesResults, entitiesResult.getModelVersion(),\n+                entitiesResult.getStatistics() == null ? null : toBatchStatistics(entitiesResult.getStatistics())));\n+    }\n+\n+    /**\n+     * Call the service with REST response, convert to a {@link Mono} of {@link Response} that contains\n+     * {@link RecognizePiiEntitiesResultCollection} from a {@link SimpleResponse} of {@link EntitiesResult}.\n+     *\n+     * @param documents The list of documents to recognize Personally Identifiable Information entities for.\n+     * @param options The {@link TextAnalyticsRequestOptions} request options.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     *\n+     * @return A mono {@link Response} that contains {@link RecognizePiiEntitiesResultCollection}.\n+     */\n+    private Mono<Response<RecognizePiiEntitiesResultCollection>> getRecognizePiiEntitiesResponse(\n+        Iterable<TextDocumentInput> documents, TextAnalyticsRequestOptions options, Context context) {\n+        return service.entitiesRecognitionPiiWithResponseAsync(\n+            new MultiLanguageBatchInput().setDocuments(toMultiLanguageInput(documents)),\n+            options == null ? null : options.getModelVersion(),\n+            options == null ? null : options.isIncludeStatistics(),\n+            null,\n+            context.addData(AZ_TRACING_NAMESPACE_KEY, COGNITIVE_TRACING_NAMESPACE_VALUE))\n+            .doOnSubscribe(ignoredValue -> logger.info(\"A batch of documents - {}\", documents.toString()))\n+            .doOnSuccess(response ->\n+                logger.info(\"Recognized Personally Identifiable Information entities for a batch of documents- {}\",\n+                response.getValue()))", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNzU5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r470207594", "bodyText": "Good point, i can hide them.", "author": "mssfang", "createdAt": "2020-08-13T19:49:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1NDI2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1NTg3Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469455876", "bodyText": "that is set using", "author": "samvaity", "createdAt": "2020-08-12T18:25:05Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClient.java", "diffHunk": "@@ -364,7 +369,132 @@ public String getDefaultLanguage() {\n         return recognizeEntityAsyncClient.recognizeEntitiesBatch(documents, options);\n     }\n \n-    // Linked Entity\n+    // PII Entity\n+\n+    /**\n+     * Returns a list of Personally Identifiable Information(PII) entities in the provided document.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/tanerpii\">this</a>.\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>. This method will use the\n+     * default language that sets up in {@link TextAnalyticsClientBuilder#defaultLanguage(String)}. If none is", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1ODI1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469458258", "bodyText": "What happens here if the document is empty?", "author": "samvaity", "createdAt": "2020-08-12T18:29:19Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClient.java", "diffHunk": "@@ -364,7 +369,132 @@ public String getDefaultLanguage() {\n         return recognizeEntityAsyncClient.recognizeEntitiesBatch(documents, options);\n     }\n \n-    // Linked Entity\n+    // PII Entity\n+\n+    /**\n+     * Returns a list of Personally Identifiable Information(PII) entities in the provided document.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/tanerpii\">this</a>.\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>. This method will use the\n+     * default language that sets up in {@link TextAnalyticsClientBuilder#defaultLanguage(String)}. If none is\n+     * specified, service will use 'en' as the language.\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * <p>Recognize the PII entities details in a document.\n+     * Subscribes to the call asynchronously and prints out the recognized entity details when a response is\n+     * received.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsAsyncClient.recognizePiiEntities#string}\n+     *\n+     * @param document The document to recognize PII entities details for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     *\n+     * @return A {@link Mono} contains a {@link PiiEntityCollection recognized PII entities collection}.\n+     *\n+     * @throws NullPointerException if {@code document} is null.\n+     * @throws TextAnalyticsException if the response returned with an {@link TextAnalyticsError error}.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<PiiEntityCollection> recognizePiiEntities(String document) {", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQwNDIwNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r470404207", "bodyText": "api will make a TextDocumentInput with text = empty string, and call service. Service will return an batch with error result:\n if (entitiesResult.isError()) {\n        throw logger.logExceptionAsError(toTextAnalyticsException(entitiesResult.getError()));\n  }\n\nIt is the same behavior as other existing APIs", "author": "mssfang", "createdAt": "2020-08-14T04:31:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1ODI1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzYwMzYzOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r473603638", "bodyText": "hmm wondering if we know we already know its going to error, should we consider validating this at client side?\ncc: @iscai-msft @maririos", "author": "samvaity", "createdAt": "2020-08-20T05:24:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1ODI1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEyNDkwOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r474124908", "bodyText": "for single documents, in .NET we always validate that document is not null or empty. As an example: https://github.com/Azure/azure-sdk-for-net/blob/master/sdk/textanalytics/Azure.AI.TextAnalytics/src/TextAnalyticsClient.cs#L138\nNot sure if Java is doing this for other endpoints, but worth checking and do the same we did in GA", "author": "maririos", "createdAt": "2020-08-20T16:41:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1ODI1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEyNzE2Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r474127166", "bodyText": "To be fair, for batch we check that documents is not null or empty, but the whole list not every element on it\nhttps://github.com/Azure/azure-sdk-for-net/blob/master/sdk/textanalytics/Azure.AI.TextAnalytics/src/TextAnalyticsClient.cs#L248", "author": "maririos", "createdAt": "2020-08-20T16:43:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1ODI1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDMwODYwMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r474308600", "bodyText": "@maririos  I remember we don't check for empty document for user in single document but check for empty list for user.", "author": "mssfang", "createdAt": "2020-08-20T22:34:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1ODI1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1ODY5Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469458692", "bodyText": "Do we need this check here too?", "author": "samvaity", "createdAt": "2020-08-12T18:30:04Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsClient.java", "diffHunk": "@@ -289,6 +291,119 @@ public RecognizeEntitiesResultCollection recognizeEntitiesBatch(\n         return client.recognizeEntityAsyncClient.recognizeEntitiesBatchWithContext(documents, options, context).block();\n     }\n \n+    // PII Entity\n+    /**\n+     * Returns a list of Personally Identifiable Information(PII) entities in the provided document.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/tanerpii\">this</a>\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>. This method will use the\n+     * default language that sets up in {@link TextAnalyticsClientBuilder#defaultLanguage(String)}. If none is\n+     * specified, service will use 'en' as the language.\n+     *\n+     * <p><strong>Code Sample</strong></p>\n+     * <p>Recognize the PII entities details in a document.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsClient.recognizePiiEntities#String}\n+     *\n+     * @param document The document to recognize PII entities details for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     *\n+     * @return A {@link PiiEntityCollection recognized PII entities collection}.\n+     *\n+     * @throws NullPointerException if {@code document} is null.\n+     * @throws TextAnalyticsException if the response returned with an {@link TextAnalyticsError error}.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PiiEntityCollection recognizePiiEntities(String document) {\n+        return recognizePiiEntities(document, client.getDefaultLanguage());\n+    }\n+\n+    /**\n+     * Returns a list of Personally Identifiable Information(PII) entities in the provided document\n+     * with provided language code.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/tanerpii\">this</a>\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>\n+     *\n+     * <p><strong>Code Sample</strong></p>\n+     * <p>Recognizes the PII entities details in a document with a provided language code.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsClient.recognizePiiEntities#String-String}\n+     *\n+     * @param document The document to recognize PII entities details for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     * @param language The 2 letter ISO 639-1 representation of language. If not set, uses \"en\" for English as default.\n+     *\n+     * @return The {@link PiiEntityCollection recognized PII entities collection}.\n+     *\n+     * @throws NullPointerException if {@code document} is null.\n+     * @throws TextAnalyticsException if the response returned with an {@link TextAnalyticsError error}.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PiiEntityCollection recognizePiiEntities(String document, String language) {\n+        Objects.requireNonNull(document, \"'document' cannot be null.\");", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQxNDc3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r470414775", "bodyText": "it check for atomic single document. For atomic single operation, document can't be null but can be empty.\nFor batch operation, documents can not be null and empty list.", "author": "mssfang", "createdAt": "2020-08-14T05:17:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1ODY5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1OTM5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469459394", "bodyText": "recognized", "author": "samvaity", "createdAt": "2020-08-12T18:31:17Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/PiiEntity.java", "diffHunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics.models;\n+\n+import com.azure.core.annotation.Immutable;\n+\n+/**\n+ * The {@link PiiEntity} model.\n+ */\n+@Immutable\n+public final class PiiEntity {\n+    /*\n+     * PiiEntity text as appears in the request.\n+     */\n+    private final String text;\n+\n+    /*\n+     * PiiEntity category, such as Person/Location/Org/SSN etc\n+     */\n+    private final EntityCategory category;\n+\n+    /*\n+     * PiiEntity sub category, such as Medical/Stock exchange/Sports etc\n+     */\n+    private final String subcategory;\n+\n+    /*\n+     * Start position for the entity text.\n+     */\n+    private final int offset;\n+\n+    /*\n+     * The length for the entity text.\n+     */\n+    private final int length;\n+\n+    /*\n+     * Confidence score between 0 and 1 of the extracted entity.\n+     */\n+    private final double confidenceScore;\n+\n+    /**\n+     * Creates a {@link PiiEntity} model that describes entity.\n+     *\n+     * @param text The entity text as appears in the request.\n+     * @param category The entity category, such as Person/Location/Org/SSN etc.\n+     * @param subcategory The entity subcategory, such as Medical/Stock exchange/Sports etc.\n+     * @param offset The start position for the entity text\n+     * @param length The length for the entity text\n+     * @param confidenceScore A confidence score between 0 and 1 of the extracted entity.", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ1OTY1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469459658", "bodyText": "recognized", "author": "samvaity", "createdAt": "2020-08-12T18:31:44Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/PiiEntity.java", "diffHunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics.models;\n+\n+import com.azure.core.annotation.Immutable;\n+\n+/**\n+ * The {@link PiiEntity} model.\n+ */\n+@Immutable\n+public final class PiiEntity {\n+    /*\n+     * PiiEntity text as appears in the request.\n+     */\n+    private final String text;\n+\n+    /*\n+     * PiiEntity category, such as Person/Location/Org/SSN etc\n+     */\n+    private final EntityCategory category;\n+\n+    /*\n+     * PiiEntity sub category, such as Medical/Stock exchange/Sports etc\n+     */\n+    private final String subcategory;\n+\n+    /*\n+     * Start position for the entity text.\n+     */\n+    private final int offset;\n+\n+    /*\n+     * The length for the entity text.\n+     */\n+    private final int length;\n+\n+    /*\n+     * Confidence score between 0 and 1 of the extracted entity.\n+     */\n+    private final double confidenceScore;\n+\n+    /**\n+     * Creates a {@link PiiEntity} model that describes entity.\n+     *\n+     * @param text The entity text as appears in the request.\n+     * @param category The entity category, such as Person/Location/Org/SSN etc.\n+     * @param subcategory The entity subcategory, such as Medical/Stock exchange/Sports etc.\n+     * @param offset The start position for the entity text\n+     * @param length The length for the entity text\n+     * @param confidenceScore A confidence score between 0 and 1 of the extracted entity.\n+     */\n+    public PiiEntity(String text, EntityCategory category, String subcategory, int offset, int length,\n+        double confidenceScore) {\n+        this.text = text;\n+        this.category = category;\n+        this.subcategory = subcategory;\n+        this.offset = offset;\n+        this.length = length;\n+        this.confidenceScore = confidenceScore;\n+    }\n+\n+    /**\n+     * Get the text property: PII entity text as appears in the request.\n+     *\n+     * @return The text value.\n+     */\n+    public String getText() {\n+        return this.text;\n+    }\n+\n+    /**\n+     * Get the category property: Categorized entity category, such as Person/Location/Org/SSN etc.\n+     *\n+     * @return The category value.\n+     */\n+    public EntityCategory getCategory() {\n+        return this.category;\n+    }\n+\n+    /**\n+     * Get the subcategory property: Categorized entity sub category, such as Medical/Stock exchange/Sports etc.\n+     *\n+     * @return The subcategory value.\n+     */\n+    public String getSubcategory() {\n+        return this.subcategory;\n+    }\n+\n+    /**\n+     * Get the offset property: the start position for the entity text.\n+     *\n+     * @return The offset value.\n+     */\n+    public int getOffset() {\n+        return this.offset;\n+    }\n+\n+    /**\n+     * Get the length property: the length for the entity text.\n+     *\n+     * @return The length value.\n+     */\n+    public int getLength() {\n+        return this.length;\n+    }\n+\n+    /**\n+     * Get the score property: Confidence score between 0 and 1 of the extracted entity.", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ2MDAwMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469460001", "bodyText": "For the return statements either include the {@code} value or a complete sentence.", "author": "samvaity", "createdAt": "2020-08-12T18:32:24Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/PiiEntity.java", "diffHunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics.models;\n+\n+import com.azure.core.annotation.Immutable;\n+\n+/**\n+ * The {@link PiiEntity} model.\n+ */\n+@Immutable\n+public final class PiiEntity {\n+    /*\n+     * PiiEntity text as appears in the request.\n+     */\n+    private final String text;\n+\n+    /*\n+     * PiiEntity category, such as Person/Location/Org/SSN etc\n+     */\n+    private final EntityCategory category;\n+\n+    /*\n+     * PiiEntity sub category, such as Medical/Stock exchange/Sports etc\n+     */\n+    private final String subcategory;\n+\n+    /*\n+     * Start position for the entity text.\n+     */\n+    private final int offset;\n+\n+    /*\n+     * The length for the entity text.\n+     */\n+    private final int length;\n+\n+    /*\n+     * Confidence score between 0 and 1 of the extracted entity.\n+     */\n+    private final double confidenceScore;\n+\n+    /**\n+     * Creates a {@link PiiEntity} model that describes entity.\n+     *\n+     * @param text The entity text as appears in the request.\n+     * @param category The entity category, such as Person/Location/Org/SSN etc.\n+     * @param subcategory The entity subcategory, such as Medical/Stock exchange/Sports etc.\n+     * @param offset The start position for the entity text\n+     * @param length The length for the entity text\n+     * @param confidenceScore A confidence score between 0 and 1 of the extracted entity.\n+     */\n+    public PiiEntity(String text, EntityCategory category, String subcategory, int offset, int length,\n+        double confidenceScore) {\n+        this.text = text;\n+        this.category = category;\n+        this.subcategory = subcategory;\n+        this.offset = offset;\n+        this.length = length;\n+        this.confidenceScore = confidenceScore;\n+    }\n+\n+    /**\n+     * Get the text property: PII entity text as appears in the request.\n+     *\n+     * @return The text value.\n+     */\n+    public String getText() {\n+        return this.text;\n+    }\n+\n+    /**\n+     * Get the category property: Categorized entity category, such as Person/Location/Org/SSN etc.\n+     *\n+     * @return The category value.\n+     */\n+    public EntityCategory getCategory() {\n+        return this.category;\n+    }\n+\n+    /**\n+     * Get the subcategory property: Categorized entity sub category, such as Medical/Stock exchange/Sports etc.\n+     *\n+     * @return The subcategory value.\n+     */\n+    public String getSubcategory() {\n+        return this.subcategory;\n+    }\n+\n+    /**\n+     * Get the offset property: the start position for the entity text.\n+     *\n+     * @return The offset value.\n+     */\n+    public int getOffset() {\n+        return this.offset;\n+    }\n+\n+    /**\n+     * Get the length property: the length for the entity text.\n+     *\n+     * @return The length value.\n+     */\n+    public int getLength() {\n+        return this.length;\n+    }\n+\n+    /**\n+     * Get the score property: Confidence score between 0 and 1 of the extracted entity.\n+     *\n+     * @return The score value.", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ2MDUyNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469460526", "bodyText": "Should add a throws here if the underlying method could potentially throw an exception.", "author": "samvaity", "createdAt": "2020-08-12T18:33:18Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/RecognizePiiEntitiesResult.java", "diffHunk": "@@ -0,0 +1,39 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.textanalytics.models;\n+\n+import com.azure.core.annotation.Immutable;\n+import com.azure.core.util.IterableStream;\n+\n+/**\n+ * The {@link RecognizePiiEntitiesResult} model.\n+ */\n+@Immutable\n+public final class RecognizePiiEntitiesResult extends TextAnalyticsResult {\n+    private final PiiEntityCollection entities;\n+\n+    /**\n+     * Creates a {@link RecognizePiiEntitiesResult} model that describes recognized PII entities result.\n+     *\n+     * @param id Unique, non-empty document identifier.\n+     * @param textDocumentStatistics The text document statistics.\n+     * @param error The document error.\n+     * @param entities A {@link PiiEntityCollection} contains entities and warnings.\n+     */\n+    public RecognizePiiEntitiesResult(String id, TextDocumentStatistics textDocumentStatistics,\n+        TextAnalyticsError error, PiiEntityCollection entities) {\n+        super(id, textDocumentStatistics, error);\n+        this.entities = entities;\n+    }\n+\n+    /**\n+     * Get an {@link IterableStream} of {@link PiiEntity}.\n+     *\n+     * @return An {@link IterableStream} of {@link PiiEntity}.", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ2MTcyNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r469461727", "bodyText": "make sure to keep this concise as this gets added in between the java docs and could make the docs really verbose!", "author": "samvaity", "createdAt": "2020-08-12T18:35:22Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/samples/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClientJavaDocCodeSnippets.java", "diffHunk": "@@ -234,6 +235,102 @@ public void recognizeBatchEntitiesMaxOverload() {\n         // END: com.azure.ai.textanalytics.TextAnalyticsAsyncClient.recognizeCategorizedEntitiesBatch#Iterable-TextAnalyticsRequestOptions\n     }\n \n+    // Personally Identifiable Information Entity\n+\n+    /**\n+     * Code snippet for {@link TextAnalyticsAsyncClient#recognizePiiEntities(String)}\n+     */\n+    public void recognizePiiEntities() {\n+        // BEGIN: com.azure.ai.textanalytics.TextAnalyticsAsyncClient.recognizePiiEntities#string\n+        String document = \"My SSN is 555-55-5555\";\n+        textAnalyticsAsyncClient.recognizePiiEntities(document).subscribe(piiEntityCollection ->\n+            piiEntityCollection.forEach(entity -> System.out.printf(\n+                \"Recognized Personally Identifiable Information entity: %s, entity category: %s,\"\n+                    + \" entity subcategory: %s, offset: %s, length: %s, confidence score: %f.%n\",\n+                entity.getText(), entity.getCategory(), entity.getSubcategory(), entity.getOffset(),\n+                entity.getLength(), entity.getConfidenceScore())));\n+        // END: com.azure.ai.textanalytics.TextAnalyticsAsyncClient.recognizePiiEntities#string\n+    }\n+\n+    /**\n+     * Code snippet for {@link TextAnalyticsAsyncClient#recognizePiiEntities(String, String)}\n+     */\n+    public void recognizePiiEntitiesWithLanguage() {\n+\n+        // BEGIN: com.azure.ai.textanalytics.TextAnalyticsAsyncClient.recognizePiiEntities#string-string\n+        String document = \"My SSN is 555-55-5555\";\n+        textAnalyticsAsyncClient.recognizePiiEntities(document, \"en\")\n+            .subscribe(piiEntityCollection -> piiEntityCollection.forEach(entity -> System.out.printf(\n+                \"Recognized Personally Identifiable Information entity: %s, entity category: %s,\"\n+                    + \" entity subcategory: %s, offset: %s, length: %s, confidence score: %f.%n\",\n+                entity.getText(), entity.getCategory(), entity.getSubcategory(), entity.getOffset(),\n+                entity.getLength(), entity.getConfidenceScore())));\n+        // END: com.azure.ai.textanalytics.TextAnalyticsAsyncClient.recognizePiiEntities#string-string\n+    }\n+\n+    /**\n+     * Code snippet for {@link TextAnalyticsAsyncClient#recognizePiiEntitiesBatch(Iterable, String, TextAnalyticsRequestOptions)}\n+     */\n+    public void recognizePiiEntitiesStringListWithOptions() {\n+        // BEGIN: com.azure.ai.textanalytics.TextAnalyticsAsyncClient.recognizePiiEntitiesBatch#Iterable-String-TextAnalyticsRequestOptions\n+        List<String> documents = Arrays.asList(\n+            \"My SSN is 555-55-5555.\",\n+            \"Visa card 0111 1111 1111 1111.\"\n+        );\n+\n+        // Request options: show statistics and model version\n+        TextAnalyticsRequestOptions requestOptions = new TextAnalyticsRequestOptions().setIncludeStatistics(true)\n+            .setModelVersion(\"latest\");\n+\n+        textAnalyticsAsyncClient.recognizePiiEntitiesBatch(documents, \"en\", requestOptions)\n+            .subscribe(piiEntitiesResults -> {\n+                // Batch statistics\n+                TextDocumentBatchStatistics batchStatistics = piiEntitiesResults.getStatistics();\n+                System.out.printf(\"Batch statistics, transaction count: %s, valid document count: %s.%n\",\n+                    batchStatistics.getTransactionCount(), batchStatistics.getValidDocumentCount());\n+\n+                piiEntitiesResults.forEach(recognizePiiEntitiesResult ->\n+                    recognizePiiEntitiesResult.getEntities().forEach(entity -> System.out.printf(\n+                        \"Recognized Personally Identifiable Information entity: %s, entity category: %s,\"\n+                            + \" entity subcategory: %s, offset: %s, length: %s, confidence score: %f.%n\",", "originalCommit": "6cf6e707c9d0f5339d289d1f981c166d3233c58e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f8f57718660ca16c016395c900986db12fcc6d53", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f8f57718660ca16c016395c900986db12fcc6d53", "message": "resolve conflict", "committedDate": "2020-08-13T04:11:20Z", "type": "commit"}, {"oid": "17092a5ab3adccc1d8cbb0a96c74bfa0a436893b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/17092a5ab3adccc1d8cbb0a96c74bfa0a436893b", "message": "address feedbacks", "committedDate": "2020-08-14T06:29:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc0MDczMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r470740733", "bodyText": "that is set using .... is not clear what you mean. consider rewording", "author": "maririos", "createdAt": "2020-08-14T16:52:37Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClient.java", "diffHunk": "@@ -254,7 +254,7 @@ public String getDefaultLanguage() {\n      *\n      * For a list of supported entity types, check: <a href=\"https://aka.ms/taner\">this</a>.\n      * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>.\n-     * This method will use the default language that sets up in\n+     * This method will use the default language that is set using", "originalCommit": "17092a5ab3adccc1d8cbb0a96c74bfa0a436893b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzA5MzA4OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r473093089", "bodyText": "updated.", "author": "mssfang", "createdAt": "2020-08-19T14:55:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc0MDczMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc0MDk0OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r470740948", "bodyText": "was this true before and we just forgot to add it in the docstring?", "author": "maririos", "createdAt": "2020-08-14T16:53:09Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/AnalyzeSentimentResult.java", "diffHunk": "@@ -30,6 +30,9 @@ public AnalyzeSentimentResult(String id, TextDocumentStatistics textDocumentStat\n      * Get the document sentiment.\n      *\n      * @return The document sentiment.\n+     *\n+     * @throws TextAnalyticsException if result has {@code isError} equals to true and when a non-error property", "originalCommit": "17092a5ab3adccc1d8cbb0a96c74bfa0a436893b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDg0NDY0OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r470844649", "bodyText": "throwExceptionIfError() throws TextAnalyticsException . we forget to add it in the docstring", "author": "mssfang", "createdAt": "2020-08-14T20:13:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc0MDk0OA=="}], "type": "inlineReview"}, {"oid": "ff4f2ad2bb7cda67c903ebdd9c01a2338282c6cb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ff4f2ad2bb7cda67c903ebdd9c01a2338282c6cb", "message": "rewording", "committedDate": "2020-08-19T14:56:20Z", "type": "commit"}, {"oid": "cc113911021dca590e350350d7ee1ec9cf16ce30", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cc113911021dca590e350350d7ee1ec9cf16ce30", "message": "remove uneixit link and will add them back in another pR", "committedDate": "2020-08-19T15:38:25Z", "type": "commit"}, {"oid": "008d594bb630e92699be72cc07b3564db8382424", "url": "https://github.com/Azure/azure-sdk-for-java/commit/008d594bb630e92699be72cc07b3564db8382424", "message": "one more broken link in README", "committedDate": "2020-08-19T16:53:48Z", "type": "commit"}, {"oid": "bda0f947808708dcbde090336a89e3b9e66fbd60", "url": "https://github.com/Azure/azure-sdk-for-java/commit/bda0f947808708dcbde090336a89e3b9e66fbd60", "message": "rerun npx to update the reamde sample", "committedDate": "2020-08-19T17:12:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzYwNjI0NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r473606244", "bodyText": "This can call the method on L403.", "author": "samvaity", "createdAt": "2020-08-20T05:28:14Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsClient.java", "diffHunk": "@@ -289,20 +291,133 @@ public RecognizeEntitiesResultCollection recognizeEntitiesBatch(\n         return client.recognizeEntityAsyncClient.recognizeEntitiesBatchWithContext(documents, options, context).block();\n     }\n \n+    // PII Entity\n+    /**\n+     * Returns a list of Personally Identifiable Information(PII) entities in the provided document.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/tanerpii\">this</a>\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>. This method will use the\n+     * default language that is set using {@link TextAnalyticsClientBuilder#defaultLanguage(String)}. If none is\n+     * specified, service will use 'en' as the language.\n+     *\n+     * <p><strong>Code Sample</strong></p>\n+     * <p>Recognize the PII entities details in a document.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsClient.recognizePiiEntities#String}\n+     *\n+     * @param document The document to recognize PII entities details for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     *\n+     * @return A {@link PiiEntityCollection recognized PII entities collection}.\n+     *\n+     * @throws NullPointerException if {@code document} is null.\n+     * @throws TextAnalyticsException if the response returned with an {@link TextAnalyticsError error}.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PiiEntityCollection recognizePiiEntities(String document) {\n+        return recognizePiiEntities(document, client.getDefaultLanguage());\n+    }\n+\n+    /**\n+     * Returns a list of Personally Identifiable Information(PII) entities in the provided document\n+     * with provided language code.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/tanerpii\">this</a>\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>\n+     *\n+     * <p><strong>Code Sample</strong></p>\n+     * <p>Recognizes the PII entities details in a document with a provided language code.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsClient.recognizePiiEntities#String-String}\n+     *\n+     * @param document The document to recognize PII entities details for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     * @param language The 2 letter ISO 639-1 representation of language. If not set, uses \"en\" for English as default.\n+     *\n+     * @return The {@link PiiEntityCollection recognized PII entities collection}.\n+     *\n+     * @throws NullPointerException if {@code document} is null.\n+     * @throws TextAnalyticsException if the response returned with an {@link TextAnalyticsError error}.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PiiEntityCollection recognizePiiEntities(String document, String language) {\n+        Objects.requireNonNull(document, \"'document' cannot be null.\");\n+        return client.recognizePiiEntities(document, language).block();\n+    }\n+\n+    /**\n+     * Returns a list of Personally Identifiable Information(PII) entities for the provided list of documents with\n+     * provided language code and request options.\n+     *\n+     * <p><strong>Code Sample</strong></p>\n+     * <p>Recognizes the PII entities details in a list of documents with a provided language code\n+     * and request options.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsClient.recognizePiiEntitiesBatch#Iterable-String-TextAnalyticsRequestOptions}\n+     *\n+     * @param documents A list of documents to recognize PII entities for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     * @param language The 2 letter ISO 639-1 representation of language. If not set, uses \"en\" for English as default.\n+     * @param options The {@link TextAnalyticsRequestOptions options} to configure the scoring model for documents\n+     * and show statistics.\n+     *\n+     * @return A {@link RecognizePiiEntitiesResultCollection}.\n+     *\n+     * @throws NullPointerException if {@code documents} is null.\n+     * @throws IllegalArgumentException if {@code documents} is empty.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public RecognizePiiEntitiesResultCollection recognizePiiEntitiesBatch(\n+        Iterable<String> documents, String language, TextAnalyticsRequestOptions options) {\n+        return client.recognizePiiEntitiesBatch(documents, language, options).block();", "originalCommit": "bda0f947808708dcbde090336a89e3b9e66fbd60", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE2ODY1OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r474168659", "bodyText": "it is better to link to call async version of it rather than depends on other sync overload.", "author": "mssfang", "createdAt": "2020-08-20T17:53:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzYwNjI0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzYwNjU5Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r473606593", "bodyText": "Can this call the method on L373", "author": "samvaity", "createdAt": "2020-08-20T05:28:45Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsClient.java", "diffHunk": "@@ -289,20 +291,133 @@ public RecognizeEntitiesResultCollection recognizeEntitiesBatch(\n         return client.recognizeEntityAsyncClient.recognizeEntitiesBatchWithContext(documents, options, context).block();\n     }\n \n+    // PII Entity\n+    /**\n+     * Returns a list of Personally Identifiable Information(PII) entities in the provided document.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/tanerpii\">this</a>\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>. This method will use the\n+     * default language that is set using {@link TextAnalyticsClientBuilder#defaultLanguage(String)}. If none is\n+     * specified, service will use 'en' as the language.\n+     *\n+     * <p><strong>Code Sample</strong></p>\n+     * <p>Recognize the PII entities details in a document.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsClient.recognizePiiEntities#String}\n+     *\n+     * @param document The document to recognize PII entities details for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     *\n+     * @return A {@link PiiEntityCollection recognized PII entities collection}.\n+     *\n+     * @throws NullPointerException if {@code document} is null.\n+     * @throws TextAnalyticsException if the response returned with an {@link TextAnalyticsError error}.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PiiEntityCollection recognizePiiEntities(String document) {\n+        return recognizePiiEntities(document, client.getDefaultLanguage());\n+    }\n+\n+    /**\n+     * Returns a list of Personally Identifiable Information(PII) entities in the provided document\n+     * with provided language code.\n+     *\n+     * For a list of supported entity types, check: <a href=\"https://aka.ms/tanerpii\">this</a>\n+     * For a list of enabled languages, check: <a href=\"https://aka.ms/talangs\">this</a>\n+     *\n+     * <p><strong>Code Sample</strong></p>\n+     * <p>Recognizes the PII entities details in a document with a provided language code.</p>\n+     *\n+     * {@codesnippet com.azure.ai.textanalytics.TextAnalyticsClient.recognizePiiEntities#String-String}\n+     *\n+     * @param document The document to recognize PII entities details for.\n+     * For text length limits, maximum batch size, and supported text encoding, see\n+     * <a href=\"https://docs.microsoft.com/azure/cognitive-services/text-analytics/overview#data-limits\">data limits</a>.\n+     * @param language The 2 letter ISO 639-1 representation of language. If not set, uses \"en\" for English as default.\n+     *\n+     * @return The {@link PiiEntityCollection recognized PII entities collection}.\n+     *\n+     * @throws NullPointerException if {@code document} is null.\n+     * @throws TextAnalyticsException if the response returned with an {@link TextAnalyticsError error}.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PiiEntityCollection recognizePiiEntities(String document, String language) {\n+        Objects.requireNonNull(document, \"'document' cannot be null.\");\n+        return client.recognizePiiEntities(document, language).block();", "originalCommit": "bda0f947808708dcbde090336a89e3b9e66fbd60", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4NTE2MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r474185161", "bodyText": "same reason as in #13687 (comment)", "author": "mssfang", "createdAt": "2020-08-20T18:24:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzYwNjU5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzYxMjAyNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r473612024", "bodyText": "Does this still need to be commented, could you add a corresponding TODO here?", "author": "samvaity", "createdAt": "2020-08-20T05:37:41Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/test/java/com/azure/ai/textanalytics/TextAnalyticsClientTestBase.java", "diffHunk": "@@ -268,6 +296,57 @@ void recognizeEntitiesTooManyDocumentsRunner(\n             Arrays.asList(documentInput, documentInput, documentInput, documentInput, documentInput, documentInput));\n     }\n \n+    // Personally Identifiable Information Entity runner\n+    void recognizePiiSingleDocumentRunner(Consumer<String> testRunner) {\n+        testRunner.accept(PII_ENTITY_INPUTS.get(0));\n+    }\n+\n+    void recognizePiiLanguageHintRunner(BiConsumer<List<String>, String> testRunner) {\n+        testRunner.accept(PII_ENTITY_INPUTS, \"en\");\n+    }\n+\n+    void recognizeBatchPiiEntityDuplicateIdRunner(Consumer<List<TextDocumentInput>> testRunner) {\n+        testRunner.accept(getDuplicateTextDocumentInputs());\n+    }\n+\n+    void recognizePiiEntitiesLanguageHintRunner(BiConsumer<List<String>, String> testRunner) {\n+        testRunner.accept(PII_ENTITY_INPUTS, \"en\");\n+    }\n+\n+    void recognizeBatchPiiEntitySingleErrorRunner(Consumer<List<TextDocumentInput>> testRunner) {\n+        List<TextDocumentInput> inputs = Collections.singletonList(new TextDocumentInput(\"2\", \" \"));\n+        testRunner.accept(inputs);\n+    }\n+\n+    void recognizeBatchPiiEntitiesRunner(Consumer<List<TextDocumentInput>> testRunner) {\n+        testRunner.accept(TestUtils.getTextDocumentInputs(PII_ENTITY_INPUTS));\n+    }\n+\n+    void recognizeBatchPiiEntitiesShowStatsRunner(\n+        BiConsumer<List<TextDocumentInput>, TextAnalyticsRequestOptions> testRunner) {\n+        final List<TextDocumentInput> textDocumentInputs = TestUtils.getTextDocumentInputs(PII_ENTITY_INPUTS);\n+        TextAnalyticsRequestOptions options = new TextAnalyticsRequestOptions().setIncludeStatistics(true);\n+\n+        testRunner.accept(textDocumentInputs, options);\n+    }\n+\n+    void recognizeStringBatchPiiEntitiesShowStatsRunner(\n+        BiConsumer<List<String>, TextAnalyticsRequestOptions> testRunner) {\n+        testRunner.accept(PII_ENTITY_INPUTS, new TextAnalyticsRequestOptions().setIncludeStatistics(true));\n+    }\n+\n+    void recognizePiiEntitiesTooManyDocumentsRunner(Consumer<List<String>> testRunner) {\n+        final String documentInput = PII_ENTITY_INPUTS.get(0);\n+        // max num of document size is 5\n+        testRunner.accept(\n+            Arrays.asList(documentInput, documentInput, documentInput, documentInput, documentInput, documentInput));\n+    }\n+\n+//    void recognizePiiEntitiesWithDomainRunner(BiConsumer<List<String>, TextAnalyticsRequestOptions> testRunner) {", "originalCommit": "bda0f947808708dcbde090336a89e3b9e66fbd60", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4MzU0Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13687#discussion_r474183546", "bodyText": "this should be removed as well. We can add it back later when domain feature is on. Forget to delete it.", "author": "mssfang", "createdAt": "2020-08-20T18:20:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzYxMjAyNA=="}], "type": "inlineReview"}, {"oid": "9b30ede40f8491617e100a87bb53c547e5593e88", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9b30ede40f8491617e100a87bb53c547e5593e88", "message": "remove unused test", "committedDate": "2020-08-20T19:04:59Z", "type": "commit"}]}