{"pr_number": 14636, "pr_title": "Support java modules for azure-spring-data-cosmos", "pr_createdAt": "2020-08-31T05:52:04Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/14636", "timeline": [{"oid": "77b9d286f700887bdb217ba73785cfa454d9a2fb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/77b9d286f700887bdb217ba73785cfa454d9a2fb", "message": "add module info", "committedDate": "2020-08-28T13:19:25Z", "type": "commit"}, {"oid": "dee60bba128bc39cd1409315cb160a8e91606d68", "url": "https://github.com/Azure/azure-sdk-for-java/commit/dee60bba128bc39cd1409315cb160a8e91606d68", "message": "fix split packages and runtime exceptions", "committedDate": "2020-08-31T04:55:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkxMjA5OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14636#discussion_r479912099", "bodyText": "Why do we need this?", "author": "kushagraThapar", "createdAt": "2020-08-31T06:05:38Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/module-info.java", "diffHunk": "@@ -32,7 +32,7 @@\n     exports com.azure.cosmos.util;\n \n     // exporting some packages specifically for Jackson\n-    opens com.azure.cosmos to com.fasterxml.jackson.databind;\n+    opens com.azure.cosmos to com.fasterxml.jackson.databind, org.apache.commons.lang3;", "originalCommit": "dee60bba128bc39cd1409315cb160a8e91606d68", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkzMzc3NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14636#discussion_r479933774", "bodyText": "We use reflection to retrieve userAgentSuffix field of cosmosClient: https://github.com/Azure/azure-sdk-for-java/blob/master/sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/CosmosFactory.java#L87", "author": "saragluna", "createdAt": "2020-08-31T06:59:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkxMjA5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI2MDAwNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14636#discussion_r480260007", "bodyText": "But that code piece is in spring-data-cosmos-core and here we are exporting apache commons lang 3 to azure-cosmos module, which doesn't use this dependency at all. Let's discuss this offline today.", "author": "kushagraThapar", "createdAt": "2020-08-31T16:54:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkxMjA5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI5MTQ3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14636#discussion_r480291475", "bodyText": "Yes, cosmos package should have no dependency or reference to org.apache.commons.lang3.", "author": "srnagar", "createdAt": "2020-08-31T17:53:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkxMjA5OQ=="}], "type": "inlineReview"}, {"oid": "1428014b4cc5e029aceba3e6b57de9955ae4678c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1428014b4cc5e029aceba3e6b57de9955ae4678c", "message": "fix compilation error", "committedDate": "2020-08-31T06:55:19Z", "type": "commit"}, {"oid": "df6f3b9c1b297055f325f7dca2fea3ca7e5d6882", "url": "https://github.com/Azure/azure-sdk-for-java/commit/df6f3b9c1b297055f325f7dca2fea3ca7e5d6882", "message": "fix tests failure", "committedDate": "2020-08-31T11:33:46Z", "type": "commit"}, {"oid": "e3c8fe33c4a7f968769fbc6e478b1fa1fce5f5ff", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e3c8fe33c4a7f968769fbc6e478b1fa1fce5f5ff", "message": "Merge branch 'master' into feature/spring-data-cosmos-modular", "committedDate": "2020-08-31T14:12:17Z", "type": "commit"}, {"oid": "e5017648bdcdb573acd480dbdcae25ea754bbad5", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e5017648bdcdb573acd480dbdcae25ea754bbad5", "message": "fix checkstyle", "committedDate": "2020-08-31T14:19:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MjM2NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14636#discussion_r480372365", "bodyText": "nit: missing trailing empty line.", "author": "conniey", "createdAt": "2020-08-31T20:11:20Z", "path": "sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/module-info.java", "diffHunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+module com.azure.spring.data.cosmos {\n+\n+    requires transitive com.azure.cosmos;\n+    requires com.fasterxml.jackson.datatype.jdk8;\n+    requires com.fasterxml.jackson.module.paramnames;\n+    requires java.desktop;\n+    requires org.apache.commons.lang3;\n+    requires org.slf4j;\n+    requires spring.beans;\n+    requires spring.context;\n+    requires spring.core;\n+    requires spring.data.commons;\n+    requires spring.expression;\n+    requires spring.tx;\n+\n+    exports com.azure.spring.data.cosmos;\n+    exports com.azure.spring.data.cosmos.common;\n+    exports com.azure.spring.data.cosmos.config;\n+    exports com.azure.spring.data.cosmos.core.convert;\n+    exports com.azure.spring.data.cosmos.core;\n+    exports com.azure.spring.data.cosmos.core.mapping;\n+    exports com.azure.spring.data.cosmos.exception;\n+    exports com.azure.spring.data.cosmos.repository;\n+    exports com.azure.spring.data.cosmos.repository.config;\n+    exports com.azure.spring.data.cosmos.repository.support;\n+\n+    opens com.azure.spring.data.cosmos.config to spring.core;\n+    opens com.azure.spring.data.cosmos.repository.support to spring.beans;\n+}", "originalCommit": "e5017648bdcdb573acd480dbdcae25ea754bbad5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDgzNTU4Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14636#discussion_r480835583", "bodyText": "added", "author": "saragluna", "createdAt": "2020-09-01T05:34:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MjM2NQ=="}], "type": "inlineReview"}, {"oid": "01f6fa6ac3e499be502ba7a3d32bc8a6f2c9e99a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/01f6fa6ac3e499be502ba7a3d32bc8a6f2c9e99a", "message": "extend surefire plugin in spring-data-cosmos", "committedDate": "2020-09-01T05:28:30Z", "type": "commit"}, {"oid": "77898d0073960fd4329f56310d2bcc5180ff362a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/77898d0073960fd4329f56310d2bcc5180ff362a", "message": "inherit plugin from profile", "committedDate": "2020-09-01T07:13:08Z", "type": "commit"}, {"oid": "7a8e82dfc5926c1e11751a52314120b770259aa2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7a8e82dfc5926c1e11751a52314120b770259aa2", "message": "fix broken link caused by changing samples package name", "committedDate": "2020-09-01T07:28:29Z", "type": "commit"}, {"oid": "2602c4a18290c86f59be20ba136928f30b5d7ad4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2602c4a18290c86f59be20ba136928f30b5d7ad4", "message": "Merge branch 'master' into feature/spring-data-cosmos-modular", "committedDate": "2020-09-03T03:26:10Z", "type": "commit"}, {"oid": "258aa1e75487c4f14277e12019a0d9f8692219f3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/258aa1e75487c4f14277e12019a0d9f8692219f3", "message": "use plain Java reflection instead of commons.lang3, hence opens to spring module", "committedDate": "2020-09-03T10:35:50Z", "type": "commit"}]}