{"pr_number": 16499, "pr_title": "Mgmt: GA azure, remove non-GA packages", "pr_createdAt": "2020-10-19T04:38:24Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/16499", "timeline": [{"oid": "3c896cfaedc88c086b3e8cb08f93efdcca552f85", "url": "https://github.com/Azure/azure-sdk-for-java/commit/3c896cfaedc88c086b3e8cb08f93efdcca552f85", "message": "Remove non GA package in azure", "committedDate": "2020-10-19T02:44:57Z", "type": "commit"}, {"oid": "0f3e3ac54e24b722b7289f607f54a85dbcbecebc", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0f3e3ac54e24b722b7289f607f54a85dbcbecebc", "message": "update module-info", "committedDate": "2020-10-19T02:46:32Z", "type": "commit"}, {"oid": "366120ec1fd21e9f3b75f2c61b0cbdc44e62cd25", "url": "https://github.com/Azure/azure-sdk-for-java/commit/366120ec1fd21e9f3b75f2c61b0cbdc44e62cd25", "message": "remove test", "committedDate": "2020-10-19T02:48:55Z", "type": "commit"}, {"oid": "cf93d2ccd815b4c86955ac2ec0b42cf1fbf33983", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cf93d2ccd815b4c86955ac2ec0b42cf1fbf33983", "message": "Remove samples", "committedDate": "2020-10-19T03:02:22Z", "type": "commit"}, {"oid": "7ea733ed9b62298b6f159a120fad5417b4c8042f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7ea733ed9b62298b6f159a120fad5417b4c8042f", "message": "GA azure", "committedDate": "2020-10-19T04:28:40Z", "type": "commit"}, {"oid": "f327341def7084102e9411f8702da2b03c0b8f81", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f327341def7084102e9411f8702da2b03c0b8f81", "message": "update pom version", "committedDate": "2020-10-19T04:29:45Z", "type": "commit"}, {"oid": "2491a7548ffc938bb6415fcd6769b7ded4edac9e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2491a7548ffc938bb6415fcd6769b7ded4edac9e", "message": "update README", "committedDate": "2020-10-19T04:30:32Z", "type": "commit"}, {"oid": "d36b86b54c95bfe66bcfecf8cd4cbdffd140f702", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d36b86b54c95bfe66bcfecf8cd4cbdffd140f702", "message": "add change log", "committedDate": "2020-10-19T04:31:37Z", "type": "commit"}, {"oid": "96b2695a6b2586b7bb6d1c1010401277b3b481d1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/96b2695a6b2586b7bb6d1c1010401277b3b481d1", "message": "Merge branch 'master' into azure-ga", "committedDate": "2020-10-19T06:11:12Z", "type": "commit"}, {"oid": "905c5029d5ab6eb7bea819e8765449f943937445", "url": "https://github.com/Azure/azure-sdk-for-java/commit/905c5029d5ab6eb7bea819e8765449f943937445", "message": "add dns", "committedDate": "2020-10-19T06:11:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3MDg3OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16499#discussion_r507970879", "bodyText": "Do we have upcoming cleanup PR's to delete these files rather than commenting out, especially since we are heading out for GA?\ncc: @JonathanGiles @srnagar @weidongxu-microsoft", "author": "samvaity", "createdAt": "2020-10-19T18:23:56Z", "path": "sdk/resourcemanager/azure-resourcemanager-samples/src/main/java/com/azure/resourcemanager/appservice/samples/ManageLinuxWebAppSqlConnection.java", "diffHunk": "@@ -1,161 +1,161 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n-\n-package com.azure.resourcemanager.appservice.samples;\n-\n-import com.azure.core.credential.TokenCredential;\n-import com.azure.core.management.AzureEnvironment;\n-import com.azure.identity.DefaultAzureCredentialBuilder;\n-import com.azure.resourcemanager.AzureResourceManager;\n-import com.azure.resourcemanager.appservice.models.PricingTier;\n-import com.azure.resourcemanager.appservice.models.RuntimeStack;\n-import com.azure.resourcemanager.appservice.models.WebApp;\n-import com.azure.core.management.Region;\n-import com.azure.core.management.profile.AzureProfile;\n-import com.azure.resourcemanager.samples.Utils;\n-import com.azure.resourcemanager.sql.models.SqlDatabase;\n-import com.azure.resourcemanager.sql.models.SqlServer;\n-import com.azure.core.http.policy.HttpLogDetailLevel;\n-\n-import java.io.IOException;\n-\n-/**\n- * Azure App Service basic sample for managing web apps.\n- *  - Create a SQL database in a new SQL server\n- *  - Create a web app deployed with Project Nami (WordPress's SQL Server variant)\n- *      that contains the app settings to connect to the SQL database\n- *  - Update the SQL server's firewall rules to allow the web app to access\n- *  - Clean up\n- */\n-public final class ManageLinuxWebAppSqlConnection {\n-\n-    /**\n-     * Main function which runs the actual sample.\n-     *\n-     * @param azureResourceManager instance of the azure client\n-     * @return true if sample runs successfully\n-     */\n-    public static boolean runSample(AzureResourceManager azureResourceManager) throws IOException {\n-        // New resources\n-        final String suffix = \".azurewebsites.net\";\n-        final String appName = Utils.randomResourceName(azureResourceManager, \"webapp1-\", 20);\n-        final String appUrl = appName + suffix;\n-        final String sqlServerName = Utils.randomResourceName(azureResourceManager, \"jsdkserver\", 20);\n-        final String sqlDbName = Utils.randomResourceName(azureResourceManager, \"jsdkdb\", 20);\n-        final String admin = \"jsdkadmin\";\n-        final String password = Utils.password();\n-        final String rgName = Utils.randomResourceName(azureResourceManager, \"rg1NEMV_\", 24);\n-\n-        try {\n-\n-\n-            //============================================================\n-            // Create a sql server\n-\n-            System.out.println(\"Creating SQL server \" + sqlServerName + \"...\");\n-\n-            SqlServer server = azureResourceManager.sqlServers().define(sqlServerName)\n-                    .withRegion(Region.US_WEST)\n-                    .withNewResourceGroup(rgName)\n-                    .withAdministratorLogin(admin)\n-                    .withAdministratorPassword(password)\n-                    .create();\n-\n-            System.out.println(\"Created SQL server \" + server.name());\n-\n-            //============================================================\n-            // Create a sql database for the web app to use\n-\n-            System.out.println(\"Creating SQL database \" + sqlDbName + \"...\");\n-\n-            SqlDatabase db = server.databases().define(sqlDbName).create();\n-\n-            System.out.println(\"Created SQL database \" + db.name());\n-\n-            //============================================================\n-            // Create a web app with a new app service plan\n-\n-            System.out.println(\"Creating web app \" + appName + \"...\");\n-\n-            WebApp app = azureResourceManager.webApps().define(appName)\n-                    .withRegion(Region.US_WEST)\n-                    .withExistingResourceGroup(rgName)\n-                    .withNewLinuxPlan(PricingTier.STANDARD_S1)\n-                    .withBuiltInImage(RuntimeStack.PHP_7_2)\n-                    .defineSourceControl()\n-                    .withPublicGitRepository(\"https://github.com/ProjectNami/projectnami\")\n-                    .withBranch(\"master\")\n-                    .attach()\n-                    .withAppSetting(\"ProjectNami.DBHost\", server.fullyQualifiedDomainName())\n-                    .withAppSetting(\"ProjectNami.DBName\", db.name())\n-                    .withAppSetting(\"ProjectNami.DBUser\", admin)\n-                    .withAppSetting(\"ProjectNami.DBPass\", password)\n-                    .create();\n-\n-            System.out.println(\"Created web app \" + app.name());\n-            Utils.print(app);\n-\n-            //============================================================\n-            // Allow web app to access the SQL server\n-\n-            System.out.println(\"Allowing web app \" + appName + \" to access SQL server...\");\n-\n-            SqlServer.Update update = server.update();\n-            for (String ip : app.outboundIPAddresses()) {\n-                update = update.defineFirewallRule(\"filewallRule1\").withIpAddress(ip).attach();\n-            }\n-            server = update.apply();\n-\n-            System.out.println(\"Firewall rules added for web app \" + appName);\n-            Utils.print(server);\n-\n-            System.out.println(\"Your WordPress app is ready.\");\n-            System.out.println(\"Please navigate to http://\" + appUrl + \" to finish the GUI setup. Press enter to exit.\");\n-            System.in.read();\n-\n-            return true;\n-        } finally {\n-            try {\n-                System.out.println(\"Deleting Resource Group: \" + rgName);\n-                azureResourceManager.resourceGroups().beginDeleteByName(rgName);\n-                System.out.println(\"Deleted Resource Group: \" + rgName);\n-            } catch (NullPointerException npe) {\n-                System.out.println(\"Did not create any resources in Azure. No clean up is necessary\");\n-            } catch (Exception g) {\n-                g.printStackTrace();\n-            }\n-        }\n-    }\n-\n-    /**\n-     * Main entry point.\n-     *\n-     * @param args the parameters\n-     */\n-    public static void main(String[] args) {\n-        try {\n-\n-            //=============================================================\n-            // Authenticate\n-\n-            final AzureProfile profile = new AzureProfile(AzureEnvironment.AZURE);\n-            final TokenCredential credential = new DefaultAzureCredentialBuilder()\n-                .authorityHost(profile.getEnvironment().getActiveDirectoryEndpoint())\n-                .build();\n-\n-            AzureResourceManager azureResourceManager = AzureResourceManager\n-                .configure()\n-                .withLogLevel(HttpLogDetailLevel.BASIC)\n-                .authenticate(credential, profile)\n-                .withDefaultSubscription();\n-\n-            // Print selected subscription\n-            System.out.println(\"Selected subscription: \" + azureResourceManager.subscriptionId());\n-\n-            runSample(azureResourceManager);\n-        } catch (Exception e) {\n-            System.out.println(e.getMessage());\n-            e.printStackTrace();\n-        }\n-    }\n-}\n+//", "originalCommit": "905c5029d5ab6eb7bea819e8765449f943937445", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODEyMTE5Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16499#discussion_r508121196", "bodyText": "The reason is that about 10 package get GAed, but the preview version of AzureResourceManager got about 20 packages.\nHence for a GA version of AzureResourceManager, the samples that using the non-GA package is commented out (e.g. ManageLinuxWebAppSqlConnection.java get commented out because sql package is non-GA, and it will not get published to Azure-Sample until sql package get GAed).\nAll of the commented-out sample would be put back when corresponding package get GAed (personally I hope it will be reverted sooner).\nsample package will not be published to maven. It is for publish to repos on Azure-Sample.", "author": "weidongxu-microsoft", "createdAt": "2020-10-19T23:33:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3MDg3OQ=="}], "type": "inlineReview"}]}