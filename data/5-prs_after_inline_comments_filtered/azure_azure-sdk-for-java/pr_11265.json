{"pr_number": 11265, "pr_title": "Users/xinlian/included path and exclude path update", "pr_createdAt": "2020-05-18T21:32:48Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/11265", "timeline": [{"oid": "a724348647225ab3a5763f2a33ea024270e1b9ad", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a724348647225ab3a5763f2a33ea024270e1b9ad", "message": "IncludedPath/ExcludedPath update", "committedDate": "2020-05-18T21:26:44Z", "type": "commit"}, {"oid": "1b1a924b9cf0a964855419719d3952ff1602ef66", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1b1a924b9cf0a964855419719d3952ff1602ef66", "message": "revert some change", "committedDate": "2020-05-18T21:31:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwNjcyMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426906723", "bodyText": "can this be updated to use the public apis for setting precision.", "author": "moderakh", "createdAt": "2020-05-18T21:37:16Z", "path": "sdk/cosmos/azure-cosmos-benchmark/src/test/java/com/azure/cosmos/benchmark/ReadMyWritesConsistencyTest.java", "diffHunk": "@@ -168,7 +168,7 @@ DocumentCollection getCollectionDefinitionWithRangeRangeIndex() {\n         List<IncludedPath> includedPaths = new ArrayList<>();\n         IncludedPath includedPath = new IncludedPath();\n         includedPath.setPath(\"/*\");\n-        Collection<Index> indexes = new ArrayList<>();\n+        List<Index> indexes = new ArrayList<>();\n         Index stringIndex = Index.range(DataType.STRING);\n         BridgeInternal.setProperty(ModelBridgeInternal.getJsonSerializable(stringIndex), \"precision\", -1);", "originalCommit": "1b1a924b9cf0a964855419719d3952ff1602ef66", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkyMDkzNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426920935", "bodyText": "Sure can, has changed across all the places.", "author": "xinlian12", "createdAt": "2020-05-18T22:13:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwNjcyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwNzAzOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426907038", "bodyText": "now that custructor for parsing json is removed, could you please add a test which sets different fields using setter api invocation? (basically equivalent of this test using setters)", "author": "moderakh", "createdAt": "2020-05-18T21:37:57Z", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/models/IncludedPathTest.java", "diffHunk": "@@ -1,40 +0,0 @@\n-// Copyright (c) Microsoft Corporation. All rights reserved.\n-// Licensed under the MIT License.\n-package com.azure.cosmos.models;\n-\n-import org.assertj.core.api.Assertions;\n-import org.testng.annotations.Test;\n-\n-import java.util.ArrayList;\n-import java.util.List;\n-\n-import static org.assertj.core.api.Assertions.assertThat;\n-\n-public class IncludedPathTest {\n-\n-    @Test(groups = {\"unit\"})\n-    public void deserialize() {", "originalCommit": "1b1a924b9cf0a964855419719d3952ff1602ef66", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkyMDk5Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426920993", "bodyText": "added", "author": "xinlian12", "createdAt": "2020-05-18T22:13:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwNzAzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkxMzYxMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426913610", "bodyText": "Now we have this constructor , what is the benefit of having default constructor and setPath() method explicitly .", "author": "simplynaveen20", "createdAt": "2020-05-18T21:53:48Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/ExcludedPath.java", "diffHunk": "@@ -23,10 +23,11 @@ public ExcludedPath() {\n     /**\n      * Constructor.\n      *\n-     * @param jsonString the json string that represents the excluded path.\n+     * @param path the excluded path.\n      */\n-    ExcludedPath(String jsonString) {\n-        this.jsonSerializable = new JsonSerializable(jsonString);\n+    public ExcludedPath(String path) {", "originalCommit": "1b1a924b9cf0a964855419719d3952ff1602ef66", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkyMTg2Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426921863", "bodyText": "Good question, I am not so sure.\nI think if path is required for includedPath, and we do not have any default path value, then should remove the default constructor.  (I guess same question for excludedPath).\n@moderakh @kushagraThapar Any thoughts for this one?", "author": "xinlian12", "createdAt": "2020-05-18T22:15:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkxMzYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkyOTk4OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426929988", "bodyText": "Good point, I say we remove default constructor, and just keep the constructor which takes String path", "author": "kushagraThapar", "createdAt": "2020-05-18T22:39:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkxMzYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk0MTQ5Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426941492", "bodyText": "what about setPath()? probably that shouldn't be public anymore now as path is set in the constructor.", "author": "moderakh", "createdAt": "2020-05-18T23:13:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkxMzYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk1NDM4MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426954380", "bodyText": "We can leave the setPath() API as it is, doesn't harm to have the API - and will be in sync with setIndexes() API.", "author": "kushagraThapar", "createdAt": "2020-05-18T23:56:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkxMzYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwMzc5Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r427003797", "bodyText": "Removed default constructor from includedPath and excludedPath", "author": "xinlian12", "createdAt": "2020-05-19T03:06:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkxMzYxMA=="}], "type": "inlineReview"}, {"oid": "354e42d868632b6c91c90366b50cf58bcdfebd64", "url": "https://github.com/Azure/azure-sdk-for-java/commit/354e42d868632b6c91c90366b50cf58bcdfebd64", "message": "resolve comments", "committedDate": "2020-05-18T22:12:51Z", "type": "commit"}, {"oid": "2881ae778758d02057ad42bfe784dbdf9738b9a2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2881ae778758d02057ad42bfe784dbdf9738b9a2", "message": "fix", "committedDate": "2020-05-18T22:26:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk0MDkyNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426940926", "bodyText": "please add back static import so we don't repeat Assertions.", "author": "moderakh", "createdAt": "2020-05-18T23:11:15Z", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/models/IncludedPathTest.java", "diffHunk": "@@ -8,33 +8,25 @@\n import java.util.ArrayList;\n import java.util.List;\n \n-import static org.assertj.core.api.Assertions.assertThat;", "originalCommit": "2881ae778758d02057ad42bfe784dbdf9738b9a2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk0MDkzNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r426940935", "bodyText": "please have static import so we don't repeat Assertions.", "author": "moderakh", "createdAt": "2020-05-18T23:11:18Z", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/models/IncludedPathTest.java", "diffHunk": "@@ -8,33 +8,25 @@\n import java.util.ArrayList;\n import java.util.List;\n \n-import static org.assertj.core.api.Assertions.assertThat;\n-\n public class IncludedPathTest {\n \n     @Test(groups = {\"unit\"})\n-    public void deserialize() {\n-        String json = \"{\" +\n-                \"  'path': '\\\\/*',\" +\n-                \"  'indexes': [\" +\n-                \"    {\" +\n-                \"      'kind': 'Range',\" +\n-                \"      'dataType': 'String',\" +\n-                \"      'precision': -1\" +\n-                \"    },\" +\n-                \"    {\" +\n-                \"      'kind': 'Range',\" +\n-                \"      'dataType': 'Number',\" +\n-                \"      'precision': -1\" +\n-                \"    }\" +\n-                \"  ]\" +\n-                \"}\";\n-        IncludedPath path = new IncludedPath(json);\n-        List<Index> indexes = new ArrayList<>(path.getIndexes());\n-        Assertions.assertThat(indexes).hasSize(2);\n-        Assertions.assertThat(((RangeIndex) indexes.get(0)).getDataType()).isEqualTo(DataType.STRING);\n-        Assertions.assertThat(((RangeIndex) indexes.get(0)).getPrecision()).isEqualTo(-1);\n-        Assertions.assertThat(((RangeIndex) indexes.get(1)).getDataType()).isEqualTo(DataType.NUMBER);\n-        Assertions.assertThat(((RangeIndex) indexes.get(1)).getPrecision()).isEqualTo(-1);\n+    public void setAndGetIncludedPath() {\n+        String path = \"/*\";\n+        IncludedPath includedPath = new IncludedPath(path);\n+\n+        List<Index> indexes = new ArrayList<>();\n+        indexes.add(Index.range(DataType.STRING, -1));\n+        indexes.add(Index.range(DataType.NUMBER, -1));\n+        includedPath.setIndexes(indexes);\n+\n+        List<Index> includedPathIndexes = new ArrayList<>(includedPath.getIndexes());\n+        Assertions.assertThat(includedPathIndexes).hasSize(2);", "originalCommit": "2881ae778758d02057ad42bfe784dbdf9738b9a2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwMzg3Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11265#discussion_r427003876", "bodyText": "added static import", "author": "xinlian12", "createdAt": "2020-05-19T03:07:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk0MDkzNQ=="}], "type": "inlineReview"}, {"oid": "21b6db63739e4d17eed7cccfc4021c53ce463ecb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/21b6db63739e4d17eed7cccfc4021c53ce463ecb", "message": "resolve comments", "committedDate": "2020-05-19T03:02:06Z", "type": "commit"}]}