{"pr_number": 8273, "pr_title": "Make facet object strongly typed", "pr_createdAt": "2020-02-18T18:51:37Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/8273", "timeline": [{"oid": "b6d8c63ab2c44fadc4d927fa35e468af6c3ffb52", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b6d8c63ab2c44fadc4d927fa35e468af6c3ffb52", "message": "Remove live tests changes", "committedDate": "2020-02-18T19:11:00Z", "type": "commit"}, {"oid": "b6d8c63ab2c44fadc4d927fa35e468af6c3ffb52", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b6d8c63ab2c44fadc4d927fa35e468af6c3ffb52", "message": "Remove live tests changes", "committedDate": "2020-02-18T19:11:00Z", "type": "forcePushed"}, {"oid": "f21245ab4e05605dcee19669f39cea8aec048e9c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f21245ab4e05605dcee19669f39cea8aec048e9c", "message": "Cast to double", "committedDate": "2020-02-18T19:42:10Z", "type": "commit"}, {"oid": "65386598faeff6c4c7aa0a103acd8a0fe42d86a3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/65386598faeff6c4c7aa0a103acd8a0fe42d86a3", "message": "Remove illegal access parameter", "committedDate": "2020-02-18T20:27:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3NzE4MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8273#discussion_r381477180", "bodyText": "The accessor methods getFrom and getTo should return type T as well.", "author": "brjohnstmsft", "createdAt": "2020-02-19T18:55:21Z", "path": "sdk/search/azure-search/src/main/java/com/azure/search/models/RangeFacetResult.java", "diffHunk": "@@ -10,20 +10,22 @@\n  * with a field value falling within a particular range.\n  */\n @Immutable\n-public class RangeFacetResult {\n+public class RangeFacetResult<T> {\n     private final Long count;\n-    private final Object from;\n-    private final Object to;\n+    private final T from;\n+    private final T to;\n \n     /**\n-     * Constructor\n+     * Constructor of RangeFacetResult.\n      *\n-     * @param facetResult facet result object\n+     * @param count The count of the result.\n+     * @param from Value indicates the lower bound of facet's range\n+     * @param to Value indicates the upper bound of facet's range\n      */\n-    public RangeFacetResult(FacetResult facetResult) {\n-        count = facetResult.getCount();\n-        from = facetResult.getDocument().get(\"from\");\n-        to = facetResult.getDocument().get(\"to\");\n+    public RangeFacetResult(Long count, T from, T to) {\n+        this.count = count;\n+        this.from = from;\n+        this.to = to;", "originalCommit": "65386598faeff6c4c7aa0a103acd8a0fe42d86a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3NzYzMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8273#discussion_r381477632", "bodyText": "The accessor method getValue should return type T as well.", "author": "brjohnstmsft", "createdAt": "2020-02-19T18:56:12Z", "path": "sdk/search/azure-search/src/main/java/com/azure/search/models/ValueFacetResult.java", "diffHunk": "@@ -11,27 +11,17 @@\n  * falling within a particular interval or having a specific value.\n  */\n @Immutable\n-public class ValueFacetResult {\n+public class ValueFacetResult<T> {\n     private final Long count;\n-    private final Object value;\n+    private final T value;\n \n     /**\n      * Constructor\n      *\n-     * @param facetResult facet result object\n+     * @param count The approximate count of documents.\n+     * @param value The value of the facet.\n      */\n-    public ValueFacetResult(FacetResult facetResult) {\n-        this.count = facetResult.getCount();\n-        this.value = facetResult.getDocument().get(\"value\");\n-    }\n-\n-    /**\n-     * Constructor\n-     *\n-     * @param count count\n-     * @param value value\n-     */\n-    public ValueFacetResult(Long count, Object value) {\n+    public ValueFacetResult(Long count, T value) {\n         this.count = count;\n         this.value = value;\n     }", "originalCommit": "65386598faeff6c4c7aa0a103acd8a0fe42d86a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3ODYwNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8273#discussion_r381478604", "bodyText": "The logic to create RangeFacetResult and ValueFacetResult from a FacetResult should be part of the SDK, not just the tests. Every customer that uses facets will need to do this, so we might as well make it easy.", "author": "brjohnstmsft", "createdAt": "2020-02-19T18:57:59Z", "path": "sdk/search/azure-search/src/test/java/com/azure/search/SearchTestBase.java", "diffHunk": "@@ -121,17 +124,21 @@ void assertRangeFacets(List<RangeFacetResult> baseRateFacets, List<RangeFacetRes\n         Assert.assertEquals(2, lastRenovationDateFacets.get(1).getCount().intValue());\n     }\n \n-    List<RangeFacetResult> getRangeFacetsForField(\n+    @SuppressWarnings(\"unchecked\")\n+    <T> List<RangeFacetResult<T>> getRangeFacetsForField(\n         Map<String, List<FacetResult>> facets, String expectedField, int expectedCount) {\n         List<FacetResult> facetCollection = getFacetsForField(facets, expectedField, expectedCount);\n-        return facetCollection.stream().map(RangeFacetResult::new)\n+        return facetCollection.stream().map(facetResult -> new RangeFacetResult<T>(facetResult.getCount(),", "originalCommit": "65386598faeff6c4c7aa0a103acd8a0fe42d86a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjE1NzAzNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8273#discussion_r382157036", "bodyText": "FacetResult is auto-gen code. For the effort of getting RangeFacetResult/ValueFacetResult from FacetResult, we have to change the swagger definition which make FacetResult to non-final. Then we can have a subclass extend FacetResult.", "author": "sima-zhu", "createdAt": "2020-02-20T17:45:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3ODYwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjE4ODE5Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8273#discussion_r382188196", "bodyText": "By \"change the swagger definition\" I assume you mean use an AutoRest transform directive? Because there's no way to express local language-specific methods on a Swagger type. I'm assuming you will handle that, and our team will own the actual Swagger definition of the REST API.", "author": "brjohnstmsft", "createdAt": "2020-02-20T18:46:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3ODYwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTg1MTY5Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8273#discussion_r391851693", "bodyText": "I might misunderstand your statement before.\nI currently added back the constructor of taking FacetResult inside of RangeFacetResult/ValueFacetResult.\nLet me know if furthermore functionalities needed here.", "author": "sima-zhu", "createdAt": "2020-03-12T19:45:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3ODYwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4OTcxNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8273#discussion_r391989717", "bodyText": "It's definitely a step in the right direction. I'm not sure what more we can do to make this more discoverable. @tg-msft had similar concerns about this pattern for the new .NET SDK. Maybe we can find a common solution for Preview 2.", "author": "brjohnstmsft", "createdAt": "2020-03-13T01:48:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3ODYwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI0MDE5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8273#discussion_r393240194", "bodyText": "Tracking with Azure/azure-sdk-for-net#10613", "author": "tg-msft", "createdAt": "2020-03-16T18:46:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3ODYwNA=="}], "type": "inlineReview"}, {"oid": "5cb6d85e6449136b977fe529b44ff4459f352b38", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5cb6d85e6449136b977fe529b44ff4459f352b38", "message": "Make changes on get API", "committedDate": "2020-02-20T17:52:09Z", "type": "commit"}, {"oid": "8fdb78a79560879d8cacc64f8e8cf13e66442ec7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8fdb78a79560879d8cacc64f8e8cf13e66442ec7", "message": "Added the constructor back and change the core version.", "committedDate": "2020-03-12T19:06:33Z", "type": "commit"}, {"oid": "569f0d53be4ea478d5e2616c5a0b43f452314578", "url": "https://github.com/Azure/azure-sdk-for-java/commit/569f0d53be4ea478d5e2616c5a0b43f452314578", "message": "Merge from master", "committedDate": "2020-03-12T19:07:39Z", "type": "commit"}, {"oid": "7b948fefdc9551448572a8df7d39772f022ac4ec", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7b948fefdc9551448572a8df7d39772f022ac4ec", "message": "Fixed compilation issues", "committedDate": "2020-03-12T19:37:04Z", "type": "commit"}, {"oid": "7b948fefdc9551448572a8df7d39772f022ac4ec", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7b948fefdc9551448572a8df7d39772f022ac4ec", "message": "Fixed compilation issues", "committedDate": "2020-03-12T19:37:04Z", "type": "forcePushed"}, {"oid": "b6b23f2ffc409335ff751cd0cad41714c6d147d8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b6b23f2ffc409335ff751cd0cad41714c6d147d8", "message": "Remove Assert imports", "committedDate": "2020-03-12T19:40:31Z", "type": "commit"}, {"oid": "f1ec46c3a154fe8c799d4a5eeecc6eff93a74591", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f1ec46c3a154fe8c799d4a5eeecc6eff93a74591", "message": "Remove impoorts", "committedDate": "2020-03-12T19:41:42Z", "type": "commit"}]}