{"pr_number": 15539, "pr_title": "mgmt disallow user pass SdkContext into Manager class", "pr_createdAt": "2020-09-23T07:59:01Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/15539", "timeline": [{"oid": "540d651ab55bd25683c812d8bf997f61d1d86e6e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/540d651ab55bd25683c812d8bf997f61d1d86e6e", "message": "remove SdkContext from user input", "committedDate": "2020-09-23T07:53:07Z", "type": "commit"}, {"oid": "1b8b2979ce44932b2ad183179e10db60083f1ebc", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1b8b2979ce44932b2ad183179e10db60083f1ebc", "message": "update msi for sdk context change", "committedDate": "2020-09-23T07:53:45Z", "type": "commit"}, {"oid": "2a523e6b1b7649f33215a34adcc268c442e69673", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2a523e6b1b7649f33215a34adcc268c442e69673", "message": "update storage", "committedDate": "2020-09-23T08:47:26Z", "type": "commit"}, {"oid": "7d3ead2a25a3d3fb77eeea7d282226fefa7a63e6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7d3ead2a25a3d3fb77eeea7d282226fefa7a63e6", "message": "Merge branch 'master' into update-sdkcontext", "committedDate": "2020-09-23T10:33:02Z", "type": "commit"}, {"oid": "35ebca5d3de109344ca90e10299386f7f3e79054", "url": "https://github.com/Azure/azure-sdk-for-java/commit/35ebca5d3de109344ca90e10299386f7f3e79054", "message": "add method setSdkContext", "committedDate": "2020-09-23T15:30:41Z", "type": "commit"}, {"oid": "b5f41f48779dfc5ad8b31c74f67d2d8c5ff18fdb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b5f41f48779dfc5ad8b31c74f67d2d8c5ff18fdb", "message": "update after adding new method to set SdkContext", "committedDate": "2020-09-23T15:31:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAxOTU2Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15539#discussion_r494019567", "bodyText": "randomResourceName in samples is quite a mess. Maybe not now, but need to find a better way.", "author": "weidongxu-microsoft", "createdAt": "2020-09-24T03:41:20Z", "path": "sdk/resourcemanager/azure-resourcemanager-samples/src/main/java/com/azure/resourcemanager/appplatform/samples/ManageSpringCloud.java", "diffHunk": "@@ -72,13 +72,13 @@\n      * @throws IllegalStateException unexcepted state\n      */\n     public static boolean runSample(AzureResourceManager azureResourceManager, String clientId) throws IOException, KeyStoreException, CertificateException, NoSuchAlgorithmException {\n-        final String rgName = azureResourceManager.sdkContext().randomResourceName(\"rg\", 24);\n-        final String serviceName  = azureResourceManager.sdkContext().randomResourceName(\"service\", 24);\n+        final String rgName = azureResourceManager.resourceGroups().manager().sdkContext().randomResourceName(\"rg\", 24);", "originalCommit": "b5f41f48779dfc5ad8b31c74f67d2d8c5ff18fdb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA0NjUwMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15539#discussion_r494046503", "bodyText": "so no change to SdkContext itself right? I believe we all agree that SdkContext is confusing, need a better name, maybe test specific.", "author": "yungezz", "createdAt": "2020-09-24T05:26:50Z", "path": "sdk/resourcemanager/azure-resourcemanager-test/src/main/java/com/azure/resourcemanager/test/ResourceManagerTestBase.java", "diffHunk": "@@ -273,6 +276,49 @@ private void addTextReplacementRules(Map<String, String> rules) {\n         }\n     }\n \n+    /**\n+     * Sets sdk context when running the tests\n+     *\n+     * @param sdkContext the sdkContext\n+     * @param objects the manager classes to change sdkContext\n+     * @param <SdkContext> the type of sdk context\n+     * @throws RuntimeException when field cannot be found or set.\n+     */\n+    protected <SdkContext> void setSdkContext(SdkContext sdkContext, Object... objects) {", "originalCommit": "35ebca5d3de109344ca90e10299386f7f3e79054", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA0OTA1Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15539#discussion_r494049052", "bodyText": "I think the confusing part was because it was existing in authenticate(httpPipeline, profile, sdkContext). It made users confused why it's required when creating the managers. After this change, now SdkContext is not settable for users. And we make it more difficult to find by moving from Manager(the base) to only ResourceManager/AuthorizationManager.", "author": "xseeseesee", "createdAt": "2020-09-24T05:35:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA0NjUwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA1MTcxOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15539#discussion_r494051718", "bodyText": "BTW, why <SdkContext> as generic type?", "author": "weidongxu-microsoft", "createdAt": "2020-09-24T05:44:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA0NjUwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA1NTg0Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15539#discussion_r494055842", "bodyText": "@weidongxu-microsoft We are adding this method in azure-resourcemanager-test. While SdkContext is existing in azure-resourcemanager-resources. Hence I have to use generic type here.", "author": "xseeseesee", "createdAt": "2020-09-24T05:57:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA0NjUwMw=="}], "type": "inlineReview"}, {"oid": "898ae32c69f931b3a351fc5478e878ee2f183b01", "url": "https://github.com/Azure/azure-sdk-for-java/commit/898ae32c69f931b3a351fc5478e878ee2f183b01", "message": "update pom for -add-opens", "committedDate": "2020-09-24T05:29:24Z", "type": "commit"}]}