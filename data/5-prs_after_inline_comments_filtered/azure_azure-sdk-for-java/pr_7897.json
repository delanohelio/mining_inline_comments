{"pr_number": 7897, "pr_title": "UX study feedback update part 1", "pr_createdAt": "2020-02-01T00:52:36Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/7897", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNzM2MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374217360", "bodyText": "I know we talked about this, but could you remind me why we decided on creating a new Pii type?\nSo far, it looks like a lot of duplication code, only for the name. No new property, functionality, or anything\n@kristapratico", "author": "maririos", "createdAt": "2020-02-03T16:52:11Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/test/java/com/azure/ai/textanalytics/TextAnalyticsClientTestBase.java", "diffHunk": "@@ -505,29 +523,48 @@ static void validateKeyPhrases(List<String> expectedKeyPhrases, List<String> act\n     }\n \n     /**\n-     * Helper method to validate the list of named entities.\n+     * Helper method to validate the list of categorized entities.\n+     *\n+     *  @param expectedCategorizedEntityList categorizedEntities returned by the service.\n+     * @param actualCategorizedEntityList categorizedEntities returned by the API.\n+     */\n+    static void validateCategorizedEntities(List<CategorizedEntity> expectedCategorizedEntityList,\n+        List<CategorizedEntity> actualCategorizedEntityList) {\n+        assertEquals(expectedCategorizedEntityList.size(), actualCategorizedEntityList.size());\n+        expectedCategorizedEntityList.sort(Comparator.comparing(CategorizedEntity::getText));\n+        actualCategorizedEntityList.sort(Comparator.comparing(CategorizedEntity::getText));\n+\n+        for (int i = 0; i < expectedCategorizedEntityList.size(); i++) {\n+            CategorizedEntity expectedCategorizedEntity = expectedCategorizedEntityList.get(i);\n+            CategorizedEntity actualCategorizedEntity = actualCategorizedEntityList.get(i);\n+            validateCategorizedEntity(expectedCategorizedEntity, actualCategorizedEntity);\n+        }\n+    }\n+\n+    /**\n+     * Helper method to validate the list of PII entities.\n      *\n-     * @param expectedNamedEntityList namedEntities returned by the service.\n-     * @param actualNamedEntityList namedEntities returned by the API.\n+     * @param expectedPiiEntityList piiEntities returned by the service.\n+     * @param actualPiiEntityList piiEntities returned by the API.\n      */\n-    static void validateNamedEntities(List<NamedEntity> expectedNamedEntityList,\n-        List<NamedEntity> actualNamedEntityList) {\n-        assertEquals(expectedNamedEntityList.size(), actualNamedEntityList.size());\n-        expectedNamedEntityList.sort(Comparator.comparing(NamedEntity::getText));\n-        actualNamedEntityList.sort(Comparator.comparing(NamedEntity::getText));\n-\n-        for (int i = 0; i < expectedNamedEntityList.size(); i++) {\n-            NamedEntity expectedNamedEntity = expectedNamedEntityList.get(i);\n-            NamedEntity actualNamedEntity = actualNamedEntityList.get(i);\n-            validateNamedEntity(expectedNamedEntity, actualNamedEntity);\n+    static void validatePiiEntities(List<PiiEntity> expectedPiiEntityList,", "originalCommit": "bab617fcd904f23c1f5138f4d3ac9287eb021e18", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIyNzgzNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374227834", "bodyText": "My context on this comes from the discussion on Teams:\n\n...that reminds me that users in our study were a little confused that RecognizePiiEntities returned a NamedEntity.  It's worth considering adding a new PiiEntity (or other name) type.  When the healthcare endpoint is up, the shape of the return type will be different for healthcare entities. It's also possible that PiiEntity will evolve differently from NamedEntity", "author": "kristapratico", "createdAt": "2020-02-03T17:11:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNzM2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDI0NDU0MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374244540", "bodyText": "Thanks!\nIt makes me wonder if we should change it now, instead of waiting/asking for more information to the service team.\nAlso, if we end up going this route, implementation wise, .. should we then just create an Entity base class and then CategoryEntity and PiiEntity inherit from it? and whatever other future Entities? That way we can add new content to it, but the core is the same and for now it will save all the duplicated code", "author": "maririos", "createdAt": "2020-02-03T17:45:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNzM2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDI0ODQ3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374248475", "bodyText": "I think we are making the change now (at least it seems Java/Python did at this moment). Entity base class makes sense to me.", "author": "kristapratico", "createdAt": "2020-02-03T17:53:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNzM2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMwMTk2MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374301960", "bodyText": "Although, we would have to come up with a better name as Entity would be too generic?\nHow about calling it NamedEntity as that is how even the service derives CategorizedEntity and PiiEntity from?", "author": "samvaity", "createdAt": "2020-02-03T19:43:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNzM2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM0OTYzOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374349639", "bodyText": "NamedEntity sounds good to me :)\n@annelo-msft what do you think?", "author": "maririos", "createdAt": "2020-02-03T21:26:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNzM2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM1NTMzOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374355338", "bodyText": "The concern with NamedEntity is that it's confusing to have this type without a Name property on it.  I'd ask what we gain by having a base class here.  Is it in the public API?  I feel like I remember Krzysztof pushing back on my introducing type hierarchies where there isn't a strong need for customers to learn the base type.  We don't know what other entities for other domains will necessarily look like yet, and is it possible that they wouldn't need Category and Subcategory?  If they don't, should they not derive from Entity?  (Do we need Subcategory for PiiEntity, for example?)  Would adding a base class be a breaking change here?  I think it's not (please correct me if I'm wrong!), and if not, we could add it later when we've seen more examples that would derive from it.", "author": "annelo-msft", "createdAt": "2020-02-03T21:37:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNzM2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM3NTM3Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374375377", "bodyText": "I wouldn't see the base class as a public API, more an internal to the API to avoid redundancy.", "author": "maririos", "createdAt": "2020-02-03T22:22:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNzM2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc0MzY5Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374743696", "bodyText": "to close here, yeah we can always do this later.", "author": "maririos", "createdAt": "2020-02-04T15:32:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNzM2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIzMjgxNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374232814", "bodyText": "Categorized", "author": "maririos", "createdAt": "2020-02-03T17:21:37Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClient.java", "diffHunk": "@@ -275,7 +275,7 @@ public TextAnalyticsServiceVersion getServiceVersion() {\n \n     // Named Entity", "originalCommit": "bab617fcd904f23c1f5138f4d3ac9287eb021e18", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIzMzAxNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374233017", "bodyText": "or Entity Category... not sure what this comment is though", "author": "maririos", "createdAt": "2020-02-03T17:21:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIzMjgxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDI0MTg4OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374241888", "bodyText": "same here", "author": "maririos", "createdAt": "2020-02-03T17:39:52Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/TextAnalyticsClient.java", "diffHunk": "@@ -166,7 +166,7 @@ public DetectLanguageResult detectLanguage(String text) {\n \n     // Named Entity", "originalCommit": "bab617fcd904f23c1f5138f4d3ac9287eb021e18", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDI0MjUwNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374242505", "bodyText": "Named", "author": "maririos", "createdAt": "2020-02-03T17:41:10Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/test/java/com/azure/ai/textanalytics/TextAnalyticsClientTestBase.java", "diffHunk": "@@ -286,20 +287,20 @@ void detectLanguageRunner(Consumer<List<DetectLanguageInput>> testRunner) {\n     }\n \n     // Named Entity runner", "originalCommit": "bab617fcd904f23c1f5138f4d3ac9287eb021e18", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDI0MjU1NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374242555", "bodyText": "Named", "author": "maririos", "createdAt": "2020-02-03T17:41:16Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/test/java/com/azure/ai/textanalytics/TextAnalyticsClientTestBase.java", "diffHunk": "@@ -286,20 +287,20 @@ void detectLanguageRunner(Consumer<List<DetectLanguageInput>> testRunner) {\n     }\n \n     // Named Entity runner\n-    void recognizeNamedEntityStringInputRunner(Consumer<List<String>> testRunner) {\n+    void recognizeCategorizedEntityStringInputRunner(Consumer<List<String>> testRunner) {\n         testRunner.accept(NAMED_ENTITY_INPUTS);\n     }\n \n     void recognizeNamedEntitiesLanguageHintRunner(BiConsumer<List<String>, String> testRunner) {", "originalCommit": "bab617fcd904f23c1f5138f4d3ac9287eb021e18", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0MTk5OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374841999", "bodyText": "Should these be entity.getCategory() and entity.getSubCategory()?", "author": "kristapratico", "createdAt": "2020-02-04T18:22:23Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/RecognizeEntityAsyncClient.java", "diffHunk": "@@ -97,7 +98,7 @@\n                 documentEntities.getStatistics() == null ? null\n                     : toTextDocumentStatistics(documentEntities.getStatistics()),\n                 null, documentEntities.getEntities().stream().map(entity ->\n-                new NamedEntity(entity.getText(), entity.getType(), entity.getSubtype(), entity.getOffset(),\n+                new CategorizedEntity(entity.getText(), entity.getType(), entity.getSubtype(), entity.getOffset(),", "originalCommit": "9c05d00ab14ae50ccfc12563a17b22834ac76555", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0NjgwOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374846809", "bodyText": "So this the service entity (generated code) model class that we are converting to CategorizedEntity, hence the getType()", "author": "samvaity", "createdAt": "2020-02-04T18:31:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0MTk5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0NzIwNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374847205", "bodyText": "Got it, figured it was fine, but just wanted to make sure", "author": "kristapratico", "createdAt": "2020-02-04T18:32:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0MTk5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0MjU4Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7897#discussion_r374842583", "bodyText": "same question here", "author": "kristapratico", "createdAt": "2020-02-04T18:23:26Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/RecognizePiiEntityAsyncClient.java", "diffHunk": "@@ -96,7 +96,7 @@\n                 documentEntities.getStatistics() == null ? null\n                     : toTextDocumentStatistics(documentEntities.getStatistics()),\n                 null, documentEntities.getEntities().stream().map(entity ->\n-                new NamedEntity(entity.getText(), entity.getType(), entity.getSubtype(), entity.getOffset(),\n+                new PiiEntity(entity.getText(), entity.getType(), entity.getSubtype(), entity.getOffset(),", "originalCommit": "9c05d00ab14ae50ccfc12563a17b22834ac76555", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1a3ff8305dc5602421b45152305633fb2c065f7b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1a3ff8305dc5602421b45152305633fb2c065f7b", "message": "readme conflicts", "committedDate": "2020-02-04T20:21:50Z", "type": "forcePushed"}, {"oid": "ca3cea5f6e4090156800c86eef36574dc4b8d724", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ca3cea5f6e4090156800c86eef36574dc4b8d724", "message": "UX study feedback update", "committedDate": "2020-02-04T21:38:42Z", "type": "commit"}, {"oid": "9901b0df185f0010955c2f00ac43e771f854aef6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9901b0df185f0010955c2f00ac43e771f854aef6", "message": "update readme", "committedDate": "2020-02-04T21:38:42Z", "type": "commit"}, {"oid": "55a74d1c07882c42219ddf8795669d526a6cdaf2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/55a74d1c07882c42219ddf8795669d526a6cdaf2", "message": "Named -> Categorized", "committedDate": "2020-02-04T21:38:42Z", "type": "commit"}, {"oid": "6c8178b88f2d3a60c766976661562e62dda324a7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6c8178b88f2d3a60c766976661562e62dda324a7", "message": "rename to entities", "committedDate": "2020-02-04T21:38:42Z", "type": "commit"}, {"oid": "5e259be6324c4e2134685369e3155b4e49decd18", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5e259be6324c4e2134685369e3155b4e49decd18", "message": "readme conflicts", "committedDate": "2020-02-04T21:38:43Z", "type": "forcePushed"}, {"oid": "f8388003086f3a1c18c13ed659416237cd5e95d3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f8388003086f3a1c18c13ed659416237cd5e95d3", "message": "readme conflicts", "committedDate": "2020-02-04T21:40:41Z", "type": "commit"}, {"oid": "f8388003086f3a1c18c13ed659416237cd5e95d3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f8388003086f3a1c18c13ed659416237cd5e95d3", "message": "readme conflicts", "committedDate": "2020-02-04T21:40:41Z", "type": "forcePushed"}]}