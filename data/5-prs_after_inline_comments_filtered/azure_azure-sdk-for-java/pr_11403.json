{"pr_number": 11403, "pr_title": "Support Copy API Form recognizer", "pr_createdAt": "2020-05-23T00:45:08Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/11403", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ5ODQ3Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r429498476", "bodyText": "All files under implementation/ are auto-generated and can be skipped for review.", "author": "samvaity", "createdAt": "2020-05-23T00:49:07Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/implementation/FormRecognizerClientImplBuilder.java", "diffHunk": "@@ -11,39 +11,37 @@\n import com.azure.core.http.policy.RetryPolicy;\n import com.azure.core.http.policy.UserAgentPolicy;\n \n-/**", "originalCommit": "4cdb6a613203f91714a143be53707f9f4688ead5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "34601d0f71f9ecf62d883655fd79a02351470e83", "url": "https://github.com/Azure/azure-sdk-for-java/commit/34601d0f71f9ecf62d883655fd79a02351470e83", "message": "Update tests", "committedDate": "2020-05-26T17:35:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzODg5MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430638891", "bodyText": "I would link this to getCopyAuthorization and say it's its output, since users aren't expected to build their own CopyAuthorization class. Python ex here", "author": "iscai-msft", "createdAt": "2020-05-26T19:00:20Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/training/FormTrainingAsyncClient.java", "diffHunk": "@@ -324,6 +329,117 @@ public FormRecognizerServiceVersion getServiceVersion() {\n             continuationToken -> listNextPageModelInfo(continuationToken, context));\n     }\n \n+    /**\n+     * Copy a custom model stored in this resource (the source) to the user specified target Form Recognizer resource.\n+     *\n+     * <p>This should be called with the source Form Recognizer resource (with the model that is intended to be copied).\n+     * The target parameter should be supplied from the target resource's output from\n+     * {@link FormTrainingAsyncClient#getCopyAuthorization(String, String)} method.\n+     * </p>\n+     *\n+     * <p>The service does not support cancellation of the long running operation and returns with an\n+     * error message indicating absence of cancellation support.</p>\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization}\n+     *\n+     * @param modelId Model identifier of the model to copy to the target Form Recognizer resource\n+     * @param target the copy authorization to the target Form Recognizer resource", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5NTMyMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430695320", "bodyText": "not necessarily. Someone outside of the running app could have shared the copy authorization, so not in all cases we need to call getCopyAuthorization", "author": "maririos", "createdAt": "2020-05-26T20:40:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzODg5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzOTY1Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430639657", "bodyText": "Mention that this is passed to beginCopyModel. Link for python example here", "author": "iscai-msft", "createdAt": "2020-05-26T19:01:44Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/training/FormTrainingAsyncClient.java", "diffHunk": "@@ -324,6 +329,117 @@ public FormRecognizerServiceVersion getServiceVersion() {\n             continuationToken -> listNextPageModelInfo(continuationToken, context));\n     }\n \n+    /**\n+     * Copy a custom model stored in this resource (the source) to the user specified target Form Recognizer resource.\n+     *\n+     * <p>This should be called with the source Form Recognizer resource (with the model that is intended to be copied).\n+     * The target parameter should be supplied from the target resource's output from\n+     * {@link FormTrainingAsyncClient#getCopyAuthorization(String, String)} method.\n+     * </p>\n+     *\n+     * <p>The service does not support cancellation of the long running operation and returns with an\n+     * error message indicating absence of cancellation support.</p>\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization}\n+     *\n+     * @param modelId Model identifier of the model to copy to the target Form Recognizer resource\n+     * @param target the copy authorization to the target Form Recognizer resource\n+     *\n+     * @return A {@link PollerFlux} that polls the copy model operation until it has completed, has failed,\n+     * or has been cancelled.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PollerFlux<OperationResult, CustomFormModelInfo> beginCopyModel(String modelId,\n+        CopyAuthorization target) {\n+        return beginCopyModel(modelId, target, null);\n+    }\n+\n+    /**\n+     * Copy a custom model stored in this resource (the source) to the user specified target Form Recognizer resource.\n+     *\n+     * <p>This should be called with the source Form Recognizer resource (with the model that is intended to be copied).\n+     * The target parameter should be supplied from the target resource's output from\n+     * {@link FormTrainingAsyncClient#getCopyAuthorization(String, String)} method.\n+     * </p>\n+     *\n+     * <p>The service does not support cancellation of the long running operation and returns with an\n+     * error message indicating absence of cancellation support.</p>\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization-Duration}\n+     *\n+     * @param modelId Model identifier of the model to copy to the target Form Recognizer resource\n+     * @param target the copy authorization to the target Form Recognizer resource\n+     * @param pollInterval Duration between each poll for the operation status. If none is specified, a default of\n+     * 5 seconds is used.\n+     *\n+     * @return A {@link PollerFlux} that polls the copy model operation until it has completed, has failed,\n+     * or has been cancelled.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PollerFlux<OperationResult, CustomFormModelInfo> beginCopyModel(String modelId,\n+        CopyAuthorization target, Duration pollInterval) {\n+        final Duration interval = pollInterval != null ? pollInterval : DEFAULT_DURATION;\n+        return new PollerFlux<OperationResult, CustomFormModelInfo>(\n+            interval,\n+            getCopyActivationOperation(modelId, target),\n+            createCopyPollOperation(modelId),\n+            (activationResponse, context) -> Mono.error(new RuntimeException(\"Cancellation is not supported\")),\n+            fetchCopyModelResultOperation(modelId));\n+    }\n+\n+    /**\n+     * Generate authorization for copying a custom model into the target Form Recognizer resource.\n+     *\n+     * @param resourceId Azure Resource Id of the target Form Recognizer resource where the model will be copied to.\n+     * @param resourceRegion Location of the target Form Recognizer resource. A valid Azure  region name supported\n+     * by Cognitive Services.\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.getCopyAuthorization#string-string}\n+     *\n+     * @return The {@link CopyAuthorization}", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5NjAzMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430696031", "bodyText": "it could be ...", "author": "maririos", "createdAt": "2020-05-26T20:42:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzOTY1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0MjExNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430642114", "bodyText": "I think this is validation the parameters to beginCopyModel. If so, I think you should say \"target\" cannot be null", "author": "iscai-msft", "createdAt": "2020-05-26T19:06:13Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/training/FormTrainingAsyncClient.java", "diffHunk": "@@ -356,6 +472,88 @@ public FormRecognizerServiceVersion getServiceVersion() {\n                 null));\n     }\n \n+    private Function<PollingContext<OperationResult>, Mono<CustomFormModelInfo>> fetchCopyModelResultOperation(\n+        String modelId) {\n+        return (pollingContext) -> {\n+            try {\n+                final UUID resultUid = UUID.fromString(pollingContext.getLatestResponse().getValue().getResultId());\n+                Objects.requireNonNull(modelId, \"'modelId' cannot be null.\");\n+                return service.getCustomModelCopyResultWithResponseAsync(UUID.fromString(modelId), resultUid)\n+                    .map(modelSimpleResponse -> {\n+                        CopyOperationResult copyOperationResult = modelSimpleResponse.getValue();\n+                        return new CustomFormModelInfo(modelId,\n+                            CustomFormModelStatus.fromString(copyOperationResult.getStatus().toString()),\n+                            copyOperationResult.getCreatedDateTime(),\n+                            copyOperationResult.getLastUpdatedDateTime());\n+                    });\n+            } catch (RuntimeException ex) {\n+                return monoError(logger, ex);\n+            }\n+        };\n+    }\n+\n+    private Function<PollingContext<OperationResult>, Mono<PollResponse<OperationResult>>>\n+        createCopyPollOperation(String modelId) {\n+        return (pollingContext) -> {\n+            try {\n+                PollResponse<OperationResult> operationResultPollResponse = pollingContext.getLatestResponse();\n+                UUID targetId = UUID.fromString(operationResultPollResponse.getValue().getResultId());\n+                return service.getCustomModelCopyResultAsync(UUID.fromString(modelId), targetId)\n+                    .flatMap(modelSimpleResponse ->\n+                        processCopyModelResponse(modelSimpleResponse, operationResultPollResponse));\n+            } catch (HttpResponseException e) {\n+                logger.logExceptionAsError(e);\n+                return Mono.just(new PollResponse<>(LongRunningOperationStatus.FAILED, null));\n+            }\n+        };\n+    }\n+\n+    private Function<PollingContext<OperationResult>, Mono<OperationResult>> getCopyActivationOperation(\n+        String modelId, CopyAuthorization copyAuthorization) {\n+        return (pollingContext) -> {\n+            try {\n+                Objects.requireNonNull(modelId, \"'modelId' cannot be null.\");\n+                Objects.requireNonNull(copyAuthorization, \"'copyAuthorization' cannot be null.\");", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0MjI3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430642275", "bodyText": "why is there an empty case", "author": "iscai-msft", "createdAt": "2020-05-26T19:06:31Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/training/FormTrainingAsyncClient.java", "diffHunk": "@@ -356,6 +472,88 @@ public FormRecognizerServiceVersion getServiceVersion() {\n                 null));\n     }\n \n+    private Function<PollingContext<OperationResult>, Mono<CustomFormModelInfo>> fetchCopyModelResultOperation(\n+        String modelId) {\n+        return (pollingContext) -> {\n+            try {\n+                final UUID resultUid = UUID.fromString(pollingContext.getLatestResponse().getValue().getResultId());\n+                Objects.requireNonNull(modelId, \"'modelId' cannot be null.\");\n+                return service.getCustomModelCopyResultWithResponseAsync(UUID.fromString(modelId), resultUid)\n+                    .map(modelSimpleResponse -> {\n+                        CopyOperationResult copyOperationResult = modelSimpleResponse.getValue();\n+                        return new CustomFormModelInfo(modelId,\n+                            CustomFormModelStatus.fromString(copyOperationResult.getStatus().toString()),\n+                            copyOperationResult.getCreatedDateTime(),\n+                            copyOperationResult.getLastUpdatedDateTime());\n+                    });\n+            } catch (RuntimeException ex) {\n+                return monoError(logger, ex);\n+            }\n+        };\n+    }\n+\n+    private Function<PollingContext<OperationResult>, Mono<PollResponse<OperationResult>>>\n+        createCopyPollOperation(String modelId) {\n+        return (pollingContext) -> {\n+            try {\n+                PollResponse<OperationResult> operationResultPollResponse = pollingContext.getLatestResponse();\n+                UUID targetId = UUID.fromString(operationResultPollResponse.getValue().getResultId());\n+                return service.getCustomModelCopyResultAsync(UUID.fromString(modelId), targetId)\n+                    .flatMap(modelSimpleResponse ->\n+                        processCopyModelResponse(modelSimpleResponse, operationResultPollResponse));\n+            } catch (HttpResponseException e) {\n+                logger.logExceptionAsError(e);\n+                return Mono.just(new PollResponse<>(LongRunningOperationStatus.FAILED, null));\n+            }\n+        };\n+    }\n+\n+    private Function<PollingContext<OperationResult>, Mono<OperationResult>> getCopyActivationOperation(\n+        String modelId, CopyAuthorization copyAuthorization) {\n+        return (pollingContext) -> {\n+            try {\n+                Objects.requireNonNull(modelId, \"'modelId' cannot be null.\");\n+                Objects.requireNonNull(copyAuthorization, \"'copyAuthorization' cannot be null.\");\n+                CopyRequest copyRequest = new CopyRequest()\n+                    .setTargetResourceId(copyAuthorization.getResourceId())\n+                    .setTargetResourceRegion(copyAuthorization.getResourceRegion())\n+                    .setCopyAuthorization(new CopyAuthorizationResult()\n+                        .setModelId(copyAuthorization.getModelId())\n+                        .setAccessToken(copyAuthorization.getAccessToken())\n+                        .setExpirationDateTimeTicks(copyAuthorization.getExpirationDateTimeTicks()));\n+                return service.copyCustomModelWithResponseAsync(UUID.fromString(modelId), copyRequest)\n+                    .map(response ->\n+                        new OperationResult(parseModelId(response.getDeserializedHeaders().getOperationLocation())));\n+            } catch (RuntimeException ex) {\n+                return monoError(logger, ex);\n+            }\n+        };\n+    }\n+\n+    private static Mono<PollResponse<OperationResult>> processCopyModelResponse(\n+        CopyOperationResult copyModel,\n+        PollResponse<OperationResult> copyModelOperationResponse) {\n+        LongRunningOperationStatus status;\n+        switch (copyModel.getStatus()) {\n+            case NOT_STARTED:", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY4MTEyMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430681122", "bodyText": "It is kind of a fall-through, so it will behave similarly as the next case.", "author": "samvaity", "createdAt": "2020-05-26T20:13:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0MjI3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0MzI2Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430643263", "bodyText": "why is this final and the rest are not", "author": "iscai-msft", "createdAt": "2020-05-26T19:08:20Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/CopyModel.java", "diffHunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.formrecognizer;\n+\n+import com.azure.ai.formrecognizer.models.CopyAuthorization;\n+import com.azure.ai.formrecognizer.models.CustomFormModelInfo;\n+import com.azure.ai.formrecognizer.models.OperationResult;\n+import com.azure.ai.formrecognizer.training.FormTrainingClient;\n+import com.azure.ai.formrecognizer.training.FormTrainingClientBuilder;\n+import com.azure.core.credential.AzureKeyCredential;\n+import com.azure.core.util.polling.SyncPoller;\n+\n+/**\n+ * Sample for copying a custom model from a source Form Recognizer resource to a target Form Recognizer resource.\n+ */\n+public class CopyModel {\n+\n+    /**\n+     * Main method to invoke this demo.\n+     *\n+     * @param args Unused. Arguments to the program.\n+     */\n+    public static void main(final String[] args) {\n+        // Instantiate a client that will be used to call the service.\n+\n+        FormTrainingClient client = new FormTrainingClientBuilder()\n+            .credential(new AzureKeyCredential(\"{key}\"))\n+            .endpoint(\"https://{endpoint}.cognitiveservices.azure.com/\")\n+            .buildClient();\n+\n+        String targetResourceId = \"target-resource-Id\";\n+        String targetResourceRegion = \"target-resource-region\";\n+        final String copyModelId = \"copy-model-Id\";", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY4MjIwNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430682204", "bodyText": "I will update this to not be final, it doesn't add a lot and will avoid too much of code in the user-samples.", "author": "samvaity", "createdAt": "2020-05-26T20:15:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0MzI2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0NDQ3Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430644472", "bodyText": "Why are these final, but the above variables in the code snippet not", "author": "iscai-msft", "createdAt": "2020-05-26T19:10:40Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormTrainingAsyncClientJavaDocCodeSnippets.java", "diffHunk": "@@ -194,4 +195,88 @@ public void getModelInfos() {\n                 customModel.getLastUpdatedOn()));\n         // END: com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.getModelInfos\n     }\n+\n+    /**\n+     * Code snippet for {@link FormTrainingAsyncClient#beginCopyModel(String, CopyAuthorization)}\n+     */\n+    public void beginCopy() {\n+        // BEGIN: com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization\n+        String resourceId = \"target-resource-Id\";\n+        String resourceRegion = \"target-resource-region\";\n+        String copyModelId = \"copy-model-Id\";\n+        formTrainingAsyncClient.getCopyAuthorization(resourceId, resourceRegion)\n+            .subscribe(copyAuthorization -> formTrainingAsyncClient.beginCopyModel(copyModelId, copyAuthorization)\n+                .subscribe(copyPoller -> copyPoller.getFinalResult().subscribe(customFormModelInfo -> {\n+                    System.out.printf(\"Copied model has model Id: %s, model status: %s, was created on: %s,\"\n+                            + \" last updated on: %s.%n\",\n+                        customFormModelInfo.getModelId(),\n+                        customFormModelInfo.getStatus(),\n+                        customFormModelInfo.getCreatedOn(),\n+                        customFormModelInfo.getLastUpdatedOn());\n+                })));\n+        // END: com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization\n+    }\n+\n+    /**\n+     * Code snippet for {@link FormTrainingAsyncClient#beginCopyModel(String, CopyAuthorization, Duration)}\n+     */\n+    public void beginCopyOverload() {\n+        // BEGIN: com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization-Duration\n+        String resourceId = \"target-resource-Id\";\n+        String resourceRegion = \"target-resource-region\";\n+        String copyModelId = \"copy-model-Id\";\n+        formTrainingAsyncClient.getCopyAuthorization(resourceId, resourceRegion)\n+            .subscribe(copyAuthorization -> formTrainingAsyncClient.beginCopyModel(copyModelId, copyAuthorization,\n+                Duration.ofSeconds(5)).subscribe(copyPoller ->\n+                copyPoller.getFinalResult().subscribe(customFormModelInfo -> {\n+                    System.out.printf(\"Copied model has model Id: %s, model status: %s, was created on: %s,\"\n+                            + \" last updated on: %s.%n\",\n+                        customFormModelInfo.getModelId(),\n+                        customFormModelInfo.getStatus(),\n+                        customFormModelInfo.getCreatedOn(),\n+                        customFormModelInfo.getLastUpdatedOn());\n+                })));\n+        // END: com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization-Duration\n+    }\n+\n+    /**\n+     * Code snippet for {@link FormTrainingAsyncClient#getCopyAuthorization(String, String)}\n+     */\n+    public void getCopyAuthorization() {\n+        // BEGIN: com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.getCopyAuthorization#string-string\n+        final String resourceId = \"target-resource-Id\";", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY1NjE5NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430656195", "bodyText": "Same question I had for Jeremy: Azure/azure-sdk-for-js#9068 (comment)", "author": "kristapratico", "createdAt": "2020-05-26T19:32:32Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/training/FormTrainingAsyncClient.java", "diffHunk": "@@ -324,6 +329,117 @@ public FormRecognizerServiceVersion getServiceVersion() {\n             continuationToken -> listNextPageModelInfo(continuationToken, context));\n     }\n \n+    /**\n+     * Copy a custom model stored in this resource (the source) to the user specified target Form Recognizer resource.\n+     *\n+     * <p>This should be called with the source Form Recognizer resource (with the model that is intended to be copied).\n+     * The target parameter should be supplied from the target resource's output from\n+     * {@link FormTrainingAsyncClient#getCopyAuthorization(String, String)} method.\n+     * </p>\n+     *\n+     * <p>The service does not support cancellation of the long running operation and returns with an\n+     * error message indicating absence of cancellation support.</p>\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization}\n+     *\n+     * @param modelId Model identifier of the model to copy to the target Form Recognizer resource\n+     * @param target the copy authorization to the target Form Recognizer resource\n+     *\n+     * @return A {@link PollerFlux} that polls the copy model operation until it has completed, has failed,\n+     * or has been cancelled.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PollerFlux<OperationResult, CustomFormModelInfo> beginCopyModel(String modelId,\n+        CopyAuthorization target) {\n+        return beginCopyModel(modelId, target, null);\n+    }\n+\n+    /**\n+     * Copy a custom model stored in this resource (the source) to the user specified target Form Recognizer resource.\n+     *\n+     * <p>This should be called with the source Form Recognizer resource (with the model that is intended to be copied).\n+     * The target parameter should be supplied from the target resource's output from\n+     * {@link FormTrainingAsyncClient#getCopyAuthorization(String, String)} method.\n+     * </p>\n+     *\n+     * <p>The service does not support cancellation of the long running operation and returns with an\n+     * error message indicating absence of cancellation support.</p>\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization-Duration}\n+     *\n+     * @param modelId Model identifier of the model to copy to the target Form Recognizer resource\n+     * @param target the copy authorization to the target Form Recognizer resource\n+     * @param pollInterval Duration between each poll for the operation status. If none is specified, a default of\n+     * 5 seconds is used.\n+     *\n+     * @return A {@link PollerFlux} that polls the copy model operation until it has completed, has failed,\n+     * or has been cancelled.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PollerFlux<OperationResult, CustomFormModelInfo> beginCopyModel(String modelId,\n+        CopyAuthorization target, Duration pollInterval) {\n+        final Duration interval = pollInterval != null ? pollInterval : DEFAULT_DURATION;\n+        return new PollerFlux<OperationResult, CustomFormModelInfo>(\n+            interval,\n+            getCopyActivationOperation(modelId, target),\n+            createCopyPollOperation(modelId),\n+            (activationResponse, context) -> Mono.error(new RuntimeException(\"Cancellation is not supported\")),\n+            fetchCopyModelResultOperation(modelId));\n+    }\n+\n+    /**\n+     * Generate authorization for copying a custom model into the target Form Recognizer resource.\n+     *\n+     * @param resourceId Azure Resource Id of the target Form Recognizer resource where the model will be copied to.\n+     * @param resourceRegion Location of the target Form Recognizer resource. A valid Azure  region name supported\n+     * by Cognitive Services.\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.getCopyAuthorization#string-string}\n+     *\n+     * @return The {@link CopyAuthorization}\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<CopyAuthorization> getCopyAuthorization(String resourceId, String resourceRegion) {", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjMxOTkwNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r432319904", "bodyText": "Added fromJson and toJson in the CopyAuthorization model similar to .NET", "author": "samvaity", "createdAt": "2020-05-29T08:01:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY1NjE5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MDcwNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430690706", "bodyText": "out of curiosity, why all these formatting changes?", "author": "maririos", "createdAt": "2020-05-26T20:32:02Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/implementation/models/TrainRequest.java", "diffHunk": "@@ -7,9 +7,7 @@\n import com.azure.core.annotation.Fluent;\n import com.fasterxml.jackson.annotation.JsonProperty;\n \n-/**\n- * The TrainRequest model.\n- */\n+/** The TrainRequest model. */", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MjE5MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430692190", "bodyText": "Yeah, I think autorest for Java underwent some major changes. Talking with them separately on this.", "author": "samvaity", "createdAt": "2020-05-26T20:34:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MDcwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MzEzMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430693131", "bodyText": "in .NET we are only exposing the ModelId and the expiration date, as for now, there is no evidence user will like to see/manipulate the rest of the information.\nAll the other information is only used by the service and it is available to be shared with the convenience method Krista pointed out in a previous comment", "author": "maririos", "createdAt": "2020-05-26T20:36:07Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/CopyAuthorization.java", "diffHunk": "@@ -0,0 +1,106 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+// Code generated by Microsoft (R) AutoRest Code Generator.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+import com.azure.core.annotation.Immutable;\n+\n+/**\n+ * The CopyAuthorization model.\n+ */\n+@Immutable\n+public final class CopyAuthorization {\n+\n+    /*\n+     * Model identifier.\n+     */\n+    private final String modelId;\n+\n+    /*\n+     * Token claim used to authorize the request.\n+     */\n+    private final String accessToken;\n+\n+    /*\n+     * Resource Identifier.\n+     */\n+    private final String resourceId;\n+\n+    /*\n+     * Region of the resource.\n+     */\n+    private final String resourceRegion;\n+\n+    /*\n+     * The time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     */\n+    private final long expirationDateTimeTicks;\n+\n+    /**\n+     * Create a CopyAuthorization object\n+     *\n+     * @param modelId The model identifier\n+     * @param accessToken The token used to authorize the request\n+     * @param resourceId The resource identifier\n+     * @param resourceRegion The region of the resource\n+     * @param expirationDateTimeTicks The expiry time of the token\n+     */\n+    public CopyAuthorization(final String modelId, final String accessToken, final String resourceId,\n+        final String resourceRegion,\n+        final long expirationDateTimeTicks) {\n+        this.modelId = modelId;\n+        this.accessToken = accessToken;\n+        this.resourceId = resourceId;\n+        this.resourceRegion = resourceRegion;\n+        this.expirationDateTimeTicks = expirationDateTimeTicks;\n+    }\n+\n+    /**\n+     * Get the modelId property.\n+     *\n+     * @return the modelId value.", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MzY5MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430693691", "bodyText": "https://github.com/Azure/azure-sdk-for-net/blob/master/sdk/formrecognizer/Azure.AI.FormRecognizer/src/CopyAuthorization.cs#L14", "author": "maririos", "createdAt": "2020-05-26T20:37:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MzEzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk5NTM0OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r431995348", "bodyText": "In Java currently, we don't have an efficient way of keeping fields private as they have to be shared across the package to be accessed in the respective client classes.\nMore discussion on this - #10346 (comment)\nMight investigate this in a separate issue - #11476", "author": "samvaity", "createdAt": "2020-05-28T17:13:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MzEzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MzU0MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430693541", "bodyText": "in .NET we are exposing the date itself and not the ticks. Consider changing the format too so it is more useful for the user.", "author": "maririos", "createdAt": "2020-05-26T20:36:52Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/CopyAuthorization.java", "diffHunk": "@@ -0,0 +1,106 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+// Code generated by Microsoft (R) AutoRest Code Generator.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+import com.azure.core.annotation.Immutable;\n+\n+/**\n+ * The CopyAuthorization model.\n+ */\n+@Immutable\n+public final class CopyAuthorization {\n+\n+    /*\n+     * Model identifier.\n+     */\n+    private final String modelId;\n+\n+    /*\n+     * Token claim used to authorize the request.\n+     */\n+    private final String accessToken;\n+\n+    /*\n+     * Resource Identifier.\n+     */\n+    private final String resourceId;\n+\n+    /*\n+     * Region of the resource.\n+     */\n+    private final String resourceRegion;\n+\n+    /*\n+     * The time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     */\n+    private final long expirationDateTimeTicks;\n+\n+    /**\n+     * Create a CopyAuthorization object\n+     *\n+     * @param modelId The model identifier\n+     * @param accessToken The token used to authorize the request\n+     * @param resourceId The resource identifier\n+     * @param resourceRegion The region of the resource\n+     * @param expirationDateTimeTicks The expiry time of the token\n+     */\n+    public CopyAuthorization(final String modelId, final String accessToken, final String resourceId,\n+        final String resourceRegion,\n+        final long expirationDateTimeTicks) {\n+        this.modelId = modelId;\n+        this.accessToken = accessToken;\n+        this.resourceId = resourceId;\n+        this.resourceRegion = resourceRegion;\n+        this.expirationDateTimeTicks = expirationDateTimeTicks;\n+    }\n+\n+    /**\n+     * Get the modelId property.\n+     *\n+     * @return the modelId value.\n+     */\n+    public String getModelId() {\n+        return this.modelId;\n+    }\n+\n+    /**\n+     * Get the token claim used to authorize the request.\n+     *\n+     * @return the accessToken value.\n+     */\n+    public String getAccessToken() {\n+        return this.accessToken;\n+    }\n+\n+    /**\n+     * Get the time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     *\n+     * @return the expirationDateTimeTicks value.\n+     */\n+    public long getExpirationDateTimeTicks() {", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MzcxNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430693716", "bodyText": "Also, the name we use is ExpiresOn see https://github.com/Azure/azure-sdk-for-net/blob/master/sdk/formrecognizer/Azure.AI.FormRecognizer/src/CopyAuthorization.cs#L14", "author": "maririos", "createdAt": "2020-05-26T20:37:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MzU0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk5NTUyOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r431995528", "bodyText": "Updated", "author": "samvaity", "createdAt": "2020-05-28T17:13:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5MzU0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5NDE3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430694175", "bodyText": "we call this region as this class contains the information of the Resource, so we thought better eliminate that from the name", "author": "maririos", "createdAt": "2020-05-26T20:38:06Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/CopyAuthorization.java", "diffHunk": "@@ -0,0 +1,106 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+// Code generated by Microsoft (R) AutoRest Code Generator.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+import com.azure.core.annotation.Immutable;\n+\n+/**\n+ * The CopyAuthorization model.\n+ */\n+@Immutable\n+public final class CopyAuthorization {\n+\n+    /*\n+     * Model identifier.\n+     */\n+    private final String modelId;\n+\n+    /*\n+     * Token claim used to authorize the request.\n+     */\n+    private final String accessToken;\n+\n+    /*\n+     * Resource Identifier.\n+     */\n+    private final String resourceId;\n+\n+    /*\n+     * Region of the resource.\n+     */\n+    private final String resourceRegion;\n+\n+    /*\n+     * The time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     */\n+    private final long expirationDateTimeTicks;\n+\n+    /**\n+     * Create a CopyAuthorization object\n+     *\n+     * @param modelId The model identifier\n+     * @param accessToken The token used to authorize the request\n+     * @param resourceId The resource identifier\n+     * @param resourceRegion The region of the resource\n+     * @param expirationDateTimeTicks The expiry time of the token\n+     */\n+    public CopyAuthorization(final String modelId, final String accessToken, final String resourceId,\n+        final String resourceRegion,\n+        final long expirationDateTimeTicks) {\n+        this.modelId = modelId;\n+        this.accessToken = accessToken;\n+        this.resourceId = resourceId;\n+        this.resourceRegion = resourceRegion;\n+        this.expirationDateTimeTicks = expirationDateTimeTicks;\n+    }\n+\n+    /**\n+     * Get the modelId property.\n+     *\n+     * @return the modelId value.\n+     */\n+    public String getModelId() {\n+        return this.modelId;\n+    }\n+\n+    /**\n+     * Get the token claim used to authorize the request.\n+     *\n+     * @return the accessToken value.\n+     */\n+    public String getAccessToken() {\n+        return this.accessToken;\n+    }\n+\n+    /**\n+     * Get the time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     *\n+     * @return the expirationDateTimeTicks value.\n+     */\n+    public long getExpirationDateTimeTicks() {\n+        return this.expirationDateTimeTicks;\n+    }\n+\n+    /**\n+     * Get the Azure Resource Id of the target Form Recognizer resource\n+     * where the model will be copied to.\n+     *\n+     * @return the resourceId value.\n+     */\n+    public String getResourceId() {\n+        return resourceId;\n+    }\n+\n+    /**\n+     * Get the location of the target Form Recognizer resource.\n+     *\n+     * @return the resourceRegion value.\n+     */\n+    public String getResourceRegion() {", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5NjY3OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430696679", "bodyText": "I imagine this a Java thing, so apologies here, but why would we need in some cases the response and not others?", "author": "maririos", "createdAt": "2020-05-26T20:43:37Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/training/FormTrainingAsyncClient.java", "diffHunk": "@@ -324,6 +329,117 @@ public FormRecognizerServiceVersion getServiceVersion() {\n             continuationToken -> listNextPageModelInfo(continuationToken, context));\n     }\n \n+    /**\n+     * Copy a custom model stored in this resource (the source) to the user specified target Form Recognizer resource.\n+     *\n+     * <p>This should be called with the source Form Recognizer resource (with the model that is intended to be copied).\n+     * The target parameter should be supplied from the target resource's output from\n+     * {@link FormTrainingAsyncClient#getCopyAuthorization(String, String)} method.\n+     * </p>\n+     *\n+     * <p>The service does not support cancellation of the long running operation and returns with an\n+     * error message indicating absence of cancellation support.</p>\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization}\n+     *\n+     * @param modelId Model identifier of the model to copy to the target Form Recognizer resource\n+     * @param target the copy authorization to the target Form Recognizer resource\n+     *\n+     * @return A {@link PollerFlux} that polls the copy model operation until it has completed, has failed,\n+     * or has been cancelled.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PollerFlux<OperationResult, CustomFormModelInfo> beginCopyModel(String modelId,\n+        CopyAuthorization target) {\n+        return beginCopyModel(modelId, target, null);\n+    }\n+\n+    /**\n+     * Copy a custom model stored in this resource (the source) to the user specified target Form Recognizer resource.\n+     *\n+     * <p>This should be called with the source Form Recognizer resource (with the model that is intended to be copied).\n+     * The target parameter should be supplied from the target resource's output from\n+     * {@link FormTrainingAsyncClient#getCopyAuthorization(String, String)} method.\n+     * </p>\n+     *\n+     * <p>The service does not support cancellation of the long running operation and returns with an\n+     * error message indicating absence of cancellation support.</p>\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.beginCopyModel#string-copyAuthorization-Duration}\n+     *\n+     * @param modelId Model identifier of the model to copy to the target Form Recognizer resource\n+     * @param target the copy authorization to the target Form Recognizer resource\n+     * @param pollInterval Duration between each poll for the operation status. If none is specified, a default of\n+     * 5 seconds is used.\n+     *\n+     * @return A {@link PollerFlux} that polls the copy model operation until it has completed, has failed,\n+     * or has been cancelled.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public PollerFlux<OperationResult, CustomFormModelInfo> beginCopyModel(String modelId,\n+        CopyAuthorization target, Duration pollInterval) {\n+        final Duration interval = pollInterval != null ? pollInterval : DEFAULT_DURATION;\n+        return new PollerFlux<OperationResult, CustomFormModelInfo>(\n+            interval,\n+            getCopyActivationOperation(modelId, target),\n+            createCopyPollOperation(modelId),\n+            (activationResponse, context) -> Mono.error(new RuntimeException(\"Cancellation is not supported\")),\n+            fetchCopyModelResultOperation(modelId));\n+    }\n+\n+    /**\n+     * Generate authorization for copying a custom model into the target Form Recognizer resource.\n+     *\n+     * @param resourceId Azure Resource Id of the target Form Recognizer resource where the model will be copied to.\n+     * @param resourceRegion Location of the target Form Recognizer resource. A valid Azure  region name supported\n+     * by Cognitive Services.\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.getCopyAuthorization#string-string}\n+     *\n+     * @return The {@link CopyAuthorization}\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<CopyAuthorization> getCopyAuthorization(String resourceId, String resourceRegion) {\n+        return getCopyAuthorizationWithResponse(resourceId, resourceRegion).flatMap(FluxUtil::toMono);\n+    }\n+\n+    /**\n+     * Generate authorization for copying a custom model into the target Form Recognizer resource.\n+     * This should be called by the target resource (where the model will be copied to) and the output can be passed as\n+     * the target parameter into {@link FormTrainingAsyncClient#beginCopyModel(String, CopyAuthorization)}.\n+     *\n+     * @param resourceId Azure Resource Id of the target Form Recognizer resource where the model will be copied to.\n+     * @param resourceRegion Location of the target Form Recognizer resource. A valid Azure  region name supported by\n+     * Cognitive Services.\n+     *\n+     * <p><strong>Code sample</strong></p>\n+     * {@codesnippet com.azure.ai.formrecognizer.training.FormTrainingAsyncClient.getCopyAuthorizationWithResponse#string-string}\n+     *\n+     * @return A {@link Response} containing the {@link CopyAuthorization}\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Response<CopyAuthorization>> getCopyAuthorizationWithResponse(String resourceId,", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5ODMzMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430698330", "bodyText": "The withResponse suffixed methods in Java are considered as the advanced scenarios where the user might be interested in getting back the HttpResponse and also have the ability to pass in Context (diagnostics/tracing).  So every API should have the ability to get the response via at least a single method.\nIn Java, we don't want to send back the response on all methods to keep the return type simpler and easier to use.", "author": "samvaity", "createdAt": "2020-05-26T20:47:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5NjY3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcyMTUwMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430721502", "bodyText": "ohh cool. Thank you for the explanation", "author": "maririos", "createdAt": "2020-05-26T21:36:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5NjY3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5ODYzNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430698634", "bodyText": "it will be good to clarify that this is the client that contains the model we want to copy", "author": "maririos", "createdAt": "2020-05-26T20:47:37Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/CopyModel.java", "diffHunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.formrecognizer;\n+\n+import com.azure.ai.formrecognizer.models.CopyAuthorization;\n+import com.azure.ai.formrecognizer.models.CustomFormModelInfo;\n+import com.azure.ai.formrecognizer.models.OperationResult;\n+import com.azure.ai.formrecognizer.training.FormTrainingClient;\n+import com.azure.ai.formrecognizer.training.FormTrainingClientBuilder;\n+import com.azure.core.credential.AzureKeyCredential;\n+import com.azure.core.util.polling.SyncPoller;\n+\n+/**\n+ * Sample for copying a custom model from a source Form Recognizer resource to a target Form Recognizer resource.\n+ */\n+public class CopyModel {\n+\n+    /**\n+     * Main method to invoke this demo.\n+     *\n+     * @param args Unused. Arguments to the program.\n+     */\n+    public static void main(final String[] args) {\n+        // Instantiate a client that will be used to call the service.", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY5OTQ5Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430699497", "bodyText": "actually, looking at this sample, we are copying a model from a source to the same source (which is a valid scenario).\nit will be good to add that clarification, and/or add a sample that copies a model from a resource to another resource.", "author": "maririos", "createdAt": "2020-05-26T20:49:25Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/CopyModel.java", "diffHunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.formrecognizer;\n+\n+import com.azure.ai.formrecognizer.models.CopyAuthorization;\n+import com.azure.ai.formrecognizer.models.CustomFormModelInfo;\n+import com.azure.ai.formrecognizer.models.OperationResult;\n+import com.azure.ai.formrecognizer.training.FormTrainingClient;\n+import com.azure.ai.formrecognizer.training.FormTrainingClientBuilder;\n+import com.azure.core.credential.AzureKeyCredential;\n+import com.azure.core.util.polling.SyncPoller;\n+\n+/**\n+ * Sample for copying a custom model from a source Form Recognizer resource to a target Form Recognizer resource.", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcwMDE4Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430700183", "bodyText": "good to add a comment saying this is the id of the model we want to copy", "author": "maririos", "createdAt": "2020-05-26T20:50:49Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/CopyModel.java", "diffHunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.formrecognizer;\n+\n+import com.azure.ai.formrecognizer.models.CopyAuthorization;\n+import com.azure.ai.formrecognizer.models.CustomFormModelInfo;\n+import com.azure.ai.formrecognizer.models.OperationResult;\n+import com.azure.ai.formrecognizer.training.FormTrainingClient;\n+import com.azure.ai.formrecognizer.training.FormTrainingClientBuilder;\n+import com.azure.core.credential.AzureKeyCredential;\n+import com.azure.core.util.polling.SyncPoller;\n+\n+/**\n+ * Sample for copying a custom model from a source Form Recognizer resource to a target Form Recognizer resource.\n+ */\n+public class CopyModel {\n+\n+    /**\n+     * Main method to invoke this demo.\n+     *\n+     * @param args Unused. Arguments to the program.\n+     */\n+    public static void main(final String[] args) {\n+        // Instantiate a client that will be used to call the service.\n+\n+        FormTrainingClient client = new FormTrainingClientBuilder()\n+            .credential(new AzureKeyCredential(\"{key}\"))\n+            .endpoint(\"https://{endpoint}.cognitiveservices.azure.com/\")\n+            .buildClient();\n+\n+        String targetResourceId = \"target-resource-Id\";\n+        String targetResourceRegion = \"target-resource-region\";\n+        final String copyModelId = \"copy-model-Id\";", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcwMTc4MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430701781", "bodyText": "This shouldn't work. modelId's should be different", "author": "maririos", "createdAt": "2020-05-26T20:53:57Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormTrainingAsyncClientTest.java", "diffHunk": "@@ -255,4 +263,78 @@ public void beginTrainingUnlabeledResult(HttpClient httpClient, FormRecognizerSe\n             validateCustomModelData(syncPoller.getFinalResult(), false);\n         });\n     }\n+\n+    /**\n+     * Verifies the result of the copy operation for valid parameters.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    void beginCopy(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingAsyncClient(httpClient, serviceVersion);\n+        beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> syncPoller =\n+                client.beginTraining(trainingFilesUrl, useTrainingLabels).getSyncPoller();\n+            syncPoller.waitForCompletion();\n+            final CustomFormModel actualModel = syncPoller.getFinalResult();\n+\n+            beginCopyRunner((resourceId, resourceRegion) -> {\n+                final Mono<CopyAuthorization> target =\n+                    client.getCopyAuthorization(resourceId, resourceRegion);\n+                final PollerFlux<OperationResult,\n+                    CustomFormModelInfo> copyPoller = client.beginCopyModel(actualModel.getModelId(), target.block());\n+                final CustomFormModelInfo copyModel = copyPoller.getSyncPoller().getFinalResult();\n+                assertEquals(actualModel.getModelId(), copyModel.getModelId());", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcxMDU1Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r430710552", "bodyText": "when this is enabled, this shouldn't work either", "author": "maririos", "createdAt": "2020-05-26T21:12:08Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormTrainingAsyncClientTest.java", "diffHunk": "@@ -255,4 +263,78 @@ public void beginTrainingUnlabeledResult(HttpClient httpClient, FormRecognizerSe\n             validateCustomModelData(syncPoller.getFinalResult(), false);\n         });\n     }\n+\n+    /**\n+     * Verifies the result of the copy operation for valid parameters.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    void beginCopy(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingAsyncClient(httpClient, serviceVersion);\n+        beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> syncPoller =\n+                client.beginTraining(trainingFilesUrl, useTrainingLabels).getSyncPoller();\n+            syncPoller.waitForCompletion();\n+            final CustomFormModel actualModel = syncPoller.getFinalResult();\n+\n+            beginCopyRunner((resourceId, resourceRegion) -> {\n+                final Mono<CopyAuthorization> target =\n+                    client.getCopyAuthorization(resourceId, resourceRegion);\n+                final PollerFlux<OperationResult,\n+                    CustomFormModelInfo> copyPoller = client.beginCopyModel(actualModel.getModelId(), target.block());\n+                final CustomFormModelInfo copyModel = copyPoller.getSyncPoller().getFinalResult();\n+                assertEquals(actualModel.getModelId(), copyModel.getModelId());\n+                assertNotNull(actualModel.getCreatedOn());\n+                // assertEquals(actualModel.getCreatedOn(), copyModel.getCreatedOn());", "originalCommit": "34601d0f71f9ecf62d883655fd79a02351470e83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b2c8b4f86ce1953c24ed3a219d8a14cd4a279e53", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b2c8b4f86ce1953c24ed3a219d8a14cd4a279e53", "message": "update review comments", "committedDate": "2020-05-29T02:50:05Z", "type": "forcePushed"}, {"oid": "c7cca774fce3e5987208c4a3f3f60b5cffd8b3bd", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c7cca774fce3e5987208c4a3f3f60b5cffd8b3bd", "message": "update test", "committedDate": "2020-05-29T06:49:55Z", "type": "forcePushed"}, {"oid": "9cce4bbb6a0e3fc85dfa25380966c941dcc53feb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9cce4bbb6a0e3fc85dfa25380966c941dcc53feb", "message": "update test", "committedDate": "2020-05-29T07:25:48Z", "type": "forcePushed"}, {"oid": "a92269bad9fac4ac3b50c61dce70a2bb3568b341", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a92269bad9fac4ac3b50c61dce70a2bb3568b341", "message": "update test", "committedDate": "2020-05-29T07:27:21Z", "type": "forcePushed"}, {"oid": "a95b9fbfe6a69a21a9e3987d31ec5a443887a99c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a95b9fbfe6a69a21a9e3987d31ec5a443887a99c", "message": "code generation", "committedDate": "2020-05-29T07:42:41Z", "type": "commit"}, {"oid": "0148e88ed44f9218f1612405f0cba6d0d7d8e353", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0148e88ed44f9218f1612405f0cba6d0d7d8e353", "message": "update training clients", "committedDate": "2020-05-29T07:43:13Z", "type": "commit"}, {"oid": "eecc799d14f7162f57e116b40ed2c0d6884a0842", "url": "https://github.com/Azure/azure-sdk-for-java/commit/eecc799d14f7162f57e116b40ed2c0d6884a0842", "message": "ustomFormModelStatus.fromString(\"succeeded\")", "committedDate": "2020-05-29T07:47:29Z", "type": "commit"}, {"oid": "65d16bf5cefad07177117f8348dc56220e5a6c74", "url": "https://github.com/Azure/azure-sdk-for-java/commit/65d16bf5cefad07177117f8348dc56220e5a6c74", "message": "update samples", "committedDate": "2020-05-29T07:47:48Z", "type": "commit"}, {"oid": "719ea252fc9a4c0067615bedb7c15195ec285656", "url": "https://github.com/Azure/azure-sdk-for-java/commit/719ea252fc9a4c0067615bedb7c15195ec285656", "message": "Update tests", "committedDate": "2020-05-29T07:47:49Z", "type": "commit"}, {"oid": "981497853641ac223d25e3145edb3c075076d171", "url": "https://github.com/Azure/azure-sdk-for-java/commit/981497853641ac223d25e3145edb3c075076d171", "message": "some review comments", "committedDate": "2020-05-29T07:47:50Z", "type": "commit"}, {"oid": "99a2717e0335371dc7086986f4ca52e002eab6d3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/99a2717e0335371dc7086986f4ca52e002eab6d3", "message": "update review comments", "committedDate": "2020-05-29T07:50:37Z", "type": "commit"}, {"oid": "80eb00ea29d2b5ef3612e1771a35f8246146f809", "url": "https://github.com/Azure/azure-sdk-for-java/commit/80eb00ea29d2b5ef3612e1771a35f8246146f809", "message": "update test", "committedDate": "2020-05-29T07:51:07Z", "type": "commit"}, {"oid": "fb8f100ddefc172e9acc16c04a98a2bad44b8c2e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/fb8f100ddefc172e9acc16c04a98a2bad44b8c2e", "message": "Rebase changes", "committedDate": "2020-05-29T07:57:16Z", "type": "commit"}, {"oid": "fb8f100ddefc172e9acc16c04a98a2bad44b8c2e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/fb8f100ddefc172e9acc16c04a98a2bad44b8c2e", "message": "Rebase changes", "committedDate": "2020-05-29T07:57:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU0NTM0Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r432545347", "bodyText": "Here you say resourceRegion but below shows region. Is that right?", "author": "kristapratico", "createdAt": "2020-05-29T14:59:27Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/CopyAuthorization.java", "diffHunk": "@@ -0,0 +1,197 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+// Code generated by Microsoft (R) AutoRest Code Generator.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+import com.azure.core.annotation.Fluent;\n+import com.azure.core.util.serializer.JacksonAdapter;\n+import com.azure.core.util.serializer.SerializerAdapter;\n+import com.azure.core.util.serializer.SerializerEncoding;\n+\n+import java.io.IOException;\n+\n+/**\n+ * The CopyAuthorization model.\n+ */\n+@Fluent\n+public final class CopyAuthorization {\n+    private static final SerializerAdapter SERIALIZER = new JacksonAdapter();\n+\n+    CopyAuthorization() {\n+        super();\n+    }\n+\n+    /*\n+     * Model identifier.\n+     */\n+    private String modelId;\n+\n+    /*\n+     * Token claim used to authorize the request.\n+     */\n+    private String accessToken;\n+\n+    /*\n+     * Resource Identifier.\n+     */\n+    private String resourceId;\n+\n+    /*\n+     * Region of the resource.\n+     */\n+    private String region;\n+\n+    /*\n+     * The time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     */\n+    private long expiresOn;\n+\n+    /**\n+     * Create a CopyAuthorization object\n+     *\n+     * @param modelId The model identifier\n+     * @param accessToken The token used to authorize the request\n+     * @param resourceId The resource identifier\n+     * @param region The region of the resource\n+     * @param expiresOn The expiry time of the token\n+     */\n+    public CopyAuthorization(final String modelId, final String accessToken, final String resourceId,\n+        final String region, final long expiresOn) {\n+        this.modelId = modelId;\n+        this.accessToken = accessToken;\n+        this.resourceId = resourceId;\n+        this.region = region;\n+        this.expiresOn = expiresOn;\n+    }\n+\n+    /**\n+     * Get the modelId property.\n+     *\n+     * @return the modelId value.\n+     */\n+    public String getModelId() {\n+        return this.modelId;\n+    }\n+\n+    /**\n+     * Get the token claim used to authorize the request.\n+     *\n+     * @return the accessToken value.\n+     */\n+    public String getAccessToken() {\n+        return this.accessToken;\n+    }\n+\n+    /**\n+     * Get the time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     *\n+     * @return the expirationDateTimeTicks value.\n+     */\n+    public long getExpiresOn() {\n+        return this.expiresOn;\n+    }\n+\n+    /**\n+     * Get the Azure Resource Id of the target Form Recognizer resource\n+     * where the model will be copied to.\n+     *\n+     * @return the resourceId value.\n+     */\n+    public String getResourceId() {\n+        return resourceId;\n+    }\n+\n+    /**\n+     * Get the location of the target Form Recognizer resource.\n+     *\n+     * @return the resourceRegion value.", "originalCommit": "fb8f100ddefc172e9acc16c04a98a2bad44b8c2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3NjEyNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r432576127", "bodyText": "Because we pass a dict, we can't alter the names (hence we use the service names). it needs to work if I call get_copy_authorization() and then pass the dict into the REST service. The user should not have to do any renames.\nSince Java/.NET have a toJSON() convenience method they can do the renames for the user there.", "author": "kristapratico", "createdAt": "2020-05-29T15:49:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU0NTM0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYwMzEzMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r432603130", "bodyText": "sorry @kristapratico I deleted the previous comment before realizing you replied to it since it was wrong. Feel free to ignore", "author": "iscai-msft", "createdAt": "2020-05-29T16:35:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU0NTM0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU4NTU5MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r432585590", "bodyText": "Semi-related to @kristapratico comment:\n@maririos and @samvaity : I notice that you guys both have region as the name in CopyAuthorization, but getCopyAuthorization takes resourceRegion (java ex here)\nShould region and resourceRegion be standardized?", "author": "iscai-msft", "createdAt": "2020-05-29T16:03:43Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/CopyAuthorization.java", "diffHunk": "@@ -0,0 +1,197 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+// Code generated by Microsoft (R) AutoRest Code Generator.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+import com.azure.core.annotation.Fluent;\n+import com.azure.core.util.serializer.JacksonAdapter;\n+import com.azure.core.util.serializer.SerializerAdapter;\n+import com.azure.core.util.serializer.SerializerEncoding;\n+\n+import java.io.IOException;\n+\n+/**\n+ * The CopyAuthorization model.\n+ */\n+@Fluent\n+public final class CopyAuthorization {\n+    private static final SerializerAdapter SERIALIZER = new JacksonAdapter();\n+\n+    CopyAuthorization() {\n+        super();\n+    }\n+\n+    /*\n+     * Model identifier.\n+     */\n+    private String modelId;\n+\n+    /*\n+     * Token claim used to authorize the request.\n+     */\n+    private String accessToken;\n+\n+    /*\n+     * Resource Identifier.\n+     */\n+    private String resourceId;\n+\n+    /*\n+     * Region of the resource.\n+     */\n+    private String region;\n+\n+    /*\n+     * The time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     */\n+    private long expiresOn;\n+\n+    /**\n+     * Create a CopyAuthorization object\n+     *\n+     * @param modelId The model identifier\n+     * @param accessToken The token used to authorize the request\n+     * @param resourceId The resource identifier\n+     * @param region The region of the resource\n+     * @param expiresOn The expiry time of the token\n+     */\n+    public CopyAuthorization(final String modelId, final String accessToken, final String resourceId,\n+        final String region, final long expiresOn) {\n+        this.modelId = modelId;\n+        this.accessToken = accessToken;\n+        this.resourceId = resourceId;\n+        this.region = region;\n+        this.expiresOn = expiresOn;\n+    }\n+\n+    /**\n+     * Get the modelId property.\n+     *\n+     * @return the modelId value.\n+     */\n+    public String getModelId() {\n+        return this.modelId;\n+    }\n+\n+    /**\n+     * Get the token claim used to authorize the request.\n+     *\n+     * @return the accessToken value.\n+     */\n+    public String getAccessToken() {\n+        return this.accessToken;\n+    }\n+\n+    /**\n+     * Get the time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     *\n+     * @return the expirationDateTimeTicks value.\n+     */\n+    public long getExpiresOn() {\n+        return this.expiresOn;\n+    }\n+\n+    /**\n+     * Get the Azure Resource Id of the target Form Recognizer resource\n+     * where the model will be copied to.\n+     *\n+     * @return the resourceId value.\n+     */\n+    public String getResourceId() {\n+        return resourceId;\n+    }\n+\n+    /**\n+     * Get the location of the target Form Recognizer resource.\n+     *\n+     * @return the resourceRegion value.\n+     */", "originalCommit": "fb8f100ddefc172e9acc16c04a98a2bad44b8c2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ1Nzg5NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r433457895", "bodyText": "I think so too that we should standardize on this. I see that python calls its resource_region (here).\n@maririos Do you think we can call it resourceRegion on the CopyAuthorization model too?", "author": "samvaity", "createdAt": "2020-06-01T20:00:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU4NTU5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE1OTY2NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r434159664", "bodyText": "we decided to leave the method signatures constant across languages, (resourceRegion) but for the types in CopyAuthorization object, that only exists in Java and .NET, .NET team was more inclined to leave it as Region, as it is already understood that the information here is about a resource.\nOther point is that this property is not available for the public in .NET so the name could always change.\n@samvaity could u remind me again, why is it that we don't hide this properties in Java?", "author": "maririos", "createdAt": "2020-06-02T20:34:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU4NTU5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE2NjcwNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r434166704", "bodyText": "@maririos #11403 (comment)\nI will update this field to be called resourceRegion as in Java we are exposing it and will help maintain consistency.", "author": "samvaity", "createdAt": "2020-06-02T20:48:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU4NTU5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYxNDU2OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r432614568", "bodyText": "we should verify that the properties were serialized correctly too", "author": "maririos", "createdAt": "2020-05-29T16:56:47Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/CopyAuthorizationSerializerTest.java", "diffHunk": "@@ -0,0 +1,41 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+// Code generated by Microsoft (R) AutoRest Code Generator.\n+package com.azure.ai.formrecognizer;\n+\n+import com.azure.ai.formrecognizer.models.CopyAuthorization;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.IOException;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+public class CopyAuthorizationSerializerTest {\n+\n+    private static final String MODEL_ID = \"97bf97bc-3210-4c84-a0ef-9472dec711a0\";\n+    private static final String ACCESS_TOKEN = \"769cd41c-9602-4373-ba38-a2531643e041\";\n+    private static final String RESOURCE_ID = \"97bf97bc-3210-4c84-a0ef-9472dec711a0\";\n+    private static final String REGION = \"westus2\";\n+    private static final long EXPIRATION_DATE_TIME = 637258696186131476L;\n+\n+    /**\n+     * Test for {@link CopyAuthorization#toJson()} and {@link CopyAuthorization#fromJson(String)}.\n+     */\n+    @Test\n+    public void toJsonTest() throws IOException {\n+        CopyAuthorization copyAuthorization = new CopyAuthorization(MODEL_ID, ACCESS_TOKEN, RESOURCE_ID, REGION,", "originalCommit": "fb8f100ddefc172e9acc16c04a98a2bad44b8c2e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYyMzAzNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r432623037", "bodyText": "I don't see where we are making the changes so that when we create the json string, we transform the property names to what the REST API is expecting. i.e. the string should look something like:\n{\"modelId\": \"26f7c09b-3e1d-4348-b98d-18187afcbf17\", \"accessToken\": \"82ea8d63-1eaa-498c-bd8b-xxxxxxxx\", \"expirationDateTimeTicks\": 637251564427472980, \"resourceId\": \"xxxxx\", \"resourceRegion\": \"westus2\"}", "author": "maririos", "createdAt": "2020-05-29T17:09:15Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/CopyAuthorization.java", "diffHunk": "@@ -0,0 +1,197 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+// Code generated by Microsoft (R) AutoRest Code Generator.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+import com.azure.core.annotation.Fluent;\n+import com.azure.core.util.serializer.JacksonAdapter;\n+import com.azure.core.util.serializer.SerializerAdapter;\n+import com.azure.core.util.serializer.SerializerEncoding;\n+\n+import java.io.IOException;\n+\n+/**\n+ * The CopyAuthorization model.\n+ */\n+@Fluent\n+public final class CopyAuthorization {\n+    private static final SerializerAdapter SERIALIZER = new JacksonAdapter();\n+\n+    CopyAuthorization() {\n+        super();\n+    }\n+\n+    /*\n+     * Model identifier.\n+     */\n+    private String modelId;\n+\n+    /*\n+     * Token claim used to authorize the request.\n+     */\n+    private String accessToken;\n+\n+    /*\n+     * Resource Identifier.\n+     */\n+    private String resourceId;\n+\n+    /*\n+     * Region of the resource.\n+     */\n+    private String region;\n+\n+    /*\n+     * The time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     */\n+    private long expiresOn;\n+\n+    /**\n+     * Create a CopyAuthorization object\n+     *\n+     * @param modelId The model identifier\n+     * @param accessToken The token used to authorize the request\n+     * @param resourceId The resource identifier\n+     * @param region The region of the resource\n+     * @param expiresOn The expiry time of the token\n+     */\n+    public CopyAuthorization(final String modelId, final String accessToken, final String resourceId,\n+        final String region, final long expiresOn) {\n+        this.modelId = modelId;\n+        this.accessToken = accessToken;\n+        this.resourceId = resourceId;\n+        this.region = region;\n+        this.expiresOn = expiresOn;\n+    }\n+\n+    /**\n+     * Get the modelId property.\n+     *\n+     * @return the modelId value.\n+     */\n+    public String getModelId() {\n+        return this.modelId;\n+    }\n+\n+    /**\n+     * Get the token claim used to authorize the request.\n+     *\n+     * @return the accessToken value.\n+     */\n+    public String getAccessToken() {\n+        return this.accessToken;\n+    }\n+\n+    /**\n+     * Get the time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     *\n+     * @return the expirationDateTimeTicks value.\n+     */\n+    public long getExpiresOn() {\n+        return this.expiresOn;\n+    }\n+\n+    /**\n+     * Get the Azure Resource Id of the target Form Recognizer resource\n+     * where the model will be copied to.\n+     *\n+     * @return the resourceId value.\n+     */\n+    public String getResourceId() {\n+        return resourceId;\n+    }\n+\n+    /**\n+     * Get the location of the target Form Recognizer resource.\n+     *\n+     * @return the resourceRegion value.\n+     */\n+    public String getRegion() {\n+        return region;\n+    }\n+\n+    /**\n+     * Converts the CopyAuthorization object to its equivalent json string representation.\n+     *\n+     * @return the json string representation of the CopyAuthorization object.\n+     * @throws IOException exception from serialization\n+     */\n+    public String toJson() throws IOException {\n+        return SERIALIZER.serialize(this, SerializerEncoding.JSON);", "originalCommit": "fb8f100ddefc172e9acc16c04a98a2bad44b8c2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYyMzE4Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r432623186", "bodyText": "without xxx :P", "author": "maririos", "createdAt": "2020-05-29T17:09:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYyMzAzNw=="}], "type": "inlineReview"}, {"oid": "1b97d9f42b684aa49ebafdbb20eb0c0adb373b7e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1b97d9f42b684aa49ebafdbb20eb0c0adb373b7e", "message": "update copy auth properties", "committedDate": "2020-06-01T05:31:55Z", "type": "commit"}, {"oid": "1b45a315f1efd0bdd0a3105ba9661e3b70d7fefa", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1b45a315f1efd0bdd0a3105ba9661e3b70d7fefa", "message": "remove tests", "committedDate": "2020-06-01T06:36:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMzMDk0OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r433330948", "bodyText": "we should have this 2, otherwise the BeginCopyMethod will fail with missing properties", "author": "maririos", "createdAt": "2020-06-01T15:57:50Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/CopyAuthorization.java", "diffHunk": "@@ -35,17 +37,20 @@\n     /*\n      * Resource Identifier.\n      */\n+    @JsonIgnore", "originalCommit": "1b97d9f42b684aa49ebafdbb20eb0c0adb373b7e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQxNjM3NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r433416374", "bodyText": "We still return these values in the object creation. They are just ignored when we jsonify the object.", "author": "samvaity", "createdAt": "2020-06-01T18:37:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMzMDk0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk4NjIxMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r433986213", "bodyText": "We still need them when we create the json string. If I ask you for an uth token so I cam copy my model into your account and you give me a string with only modelid, access token, and expiration date, my StartCopyModel in .NET will fail.", "author": "maririos", "createdAt": "2020-06-02T15:53:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMzMDk0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk5MTI1Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r433991256", "bodyText": "See the string I mentioned before:\n{\"modelId\": \"26f7c09b-3e1d-4348-b98d-18187afcbf17\", \"accessToken\": \"82ea8d63-1eaa-498c-bd8b-xxxxxxxx\", \"expirationDateTimeTicks\": 637251564427472980, \"resourceId\": \"xxxxx\", \"resourceRegion\": \"westus2\"}", "author": "maririos", "createdAt": "2020-06-02T15:58:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMzMDk0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQwMDUxMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r433400511", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (copyResult.getStatus().equals(OperationStatus.FAILED)) {\n          \n          \n            \n                    if (OperationStatus.FAILED.equals(copyResult.getStatus())) {", "author": "mssfang", "createdAt": "2020-06-01T18:07:02Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/training/FormTrainingAsyncClient.java", "diffHunk": "@@ -423,4 +621,21 @@ public FormRecognizerServiceVersion getServiceVersion() {\n         }\n         return Mono.just(new PollResponse<>(status, trainingModelOperationResponse.getValue()));\n     }\n+\n+    /**\n+     * Helper method that throws a {@link HttpResponseException} if {@link CopyOperationResult#getStatus()} is\n+     * {@link OperationStatus#FAILED}.\n+     *\n+     * @param copyResult The copy operation response returned from the service.\n+     */\n+    private void throwIfCopyOperationStatusInvalid(CopyOperationResult copyResult) {\n+        if (copyResult.getStatus().equals(OperationStatus.FAILED)) {", "originalCommit": "1b45a315f1efd0bdd0a3105ba9661e3b70d7fefa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQzNjUzMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r433436530", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            final UUID resultUid = UUID.fromString(pollingContext.getLatestResponse().getValue().getResultId());\n          \n          \n            \n                            Objects.requireNonNull(modelId, \"'modelId' cannot be null.\");\n          \n          \n            \n                            Objects.requireNonNull(modelId, \"'modelId' cannot be null.\");\n          \n          \n            \n                            final UUID resultUid = UUID.fromString(pollingContext.getLatestResponse().getValue().getResultId());", "author": "mssfang", "createdAt": "2020-06-01T19:17:38Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/training/FormTrainingAsyncClient.java", "diffHunk": "@@ -356,6 +472,88 @@ public FormRecognizerServiceVersion getServiceVersion() {\n                 null));\n     }\n \n+    private Function<PollingContext<OperationResult>, Mono<CustomFormModelInfo>> fetchCopyModelResultOperation(\n+        String modelId, String copyModelId) {\n+        return (pollingContext) -> {\n+            try {\n+                final UUID resultUid = UUID.fromString(pollingContext.getLatestResponse().getValue().getResultId());\n+                Objects.requireNonNull(modelId, \"'modelId' cannot be null.\");", "originalCommit": "1b45a315f1efd0bdd0a3105ba9661e3b70d7fefa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ0OTE2Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r433449166", "bodyText": "nit: we don't need this keyword here.", "author": "mssfang", "createdAt": "2020-06-01T19:42:37Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/CopyAuthorization.java", "diffHunk": "@@ -0,0 +1,202 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+// Code generated by Microsoft (R) AutoRest Code Generator.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+import com.azure.core.annotation.Fluent;\n+import com.azure.core.util.serializer.JacksonAdapter;\n+import com.azure.core.util.serializer.SerializerAdapter;\n+import com.azure.core.util.serializer.SerializerEncoding;\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+import java.io.IOException;\n+\n+/**\n+ * The CopyAuthorization model.\n+ */\n+@Fluent\n+public final class CopyAuthorization {\n+    private static final SerializerAdapter SERIALIZER = new JacksonAdapter();\n+\n+    CopyAuthorization() {\n+        super();\n+    }\n+\n+    /*\n+     * Model identifier.\n+     */\n+    private String modelId;\n+\n+    /*\n+     * Token claim used to authorize the request.\n+     */\n+    private String accessToken;\n+\n+    /*\n+     * Resource Identifier.\n+     */\n+    @JsonIgnore\n+    private String resourceId;\n+\n+    /*\n+     * Region of the resource.\n+     */\n+    @JsonIgnore\n+    private String region;\n+\n+    /*\n+     * The time when the access token expires. The date is represented as the\n+     * number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.\n+     */\n+    @JsonProperty(\"expirationDateTimeTicks\")\n+    private long expiresOn;\n+\n+    /**\n+     * Create a CopyAuthorization object\n+     *\n+     * @param modelId The model identifier\n+     * @param accessToken The token used to authorize the request\n+     * @param resourceId The resource identifier\n+     * @param region The region of the resource\n+     * @param expiresOn The expiry time of the token\n+     */\n+    public CopyAuthorization(final String modelId, final String accessToken, final String resourceId,\n+        final String region, final long expiresOn) {\n+        this.modelId = modelId;\n+        this.accessToken = accessToken;\n+        this.resourceId = resourceId;\n+        this.region = region;\n+        this.expiresOn = expiresOn;\n+    }\n+\n+    /**\n+     * Get the modelId property.\n+     *\n+     * @return the {@code modelId} value.\n+     */\n+    public String getModelId() {\n+        return this.modelId;", "originalCommit": "1b45a315f1efd0bdd0a3105ba9661e3b70d7fefa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ec57b0f453f5717963b25d3d664e26852ec845c6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ec57b0f453f5717963b25d3d664e26852ec845c6", "message": "rename region to resourceRegion", "committedDate": "2020-06-02T21:23:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE4ODY3MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r434188671", "bodyText": "is this a fake value? just making sure we are not exposing a real access token", "author": "maririos", "createdAt": "2020-06-02T21:34:36Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/CopyAuthorizationSerializerTest.java", "diffHunk": "@@ -9,19 +9,19 @@\n import java.io.IOException;\n \n import static org.junit.jupiter.api.Assertions.assertEquals;\n-import static org.junit.jupiter.api.Assertions.assertFalse;\n-import static org.junit.jupiter.api.Assertions.assertNull;\n import static org.junit.jupiter.api.Assertions.assertTrue;\n \n public class CopyAuthorizationSerializerTest {\n \n     private static final String MODEL_ID = \"97bf97bc-3210-4c84-a0ef-9472dec711a0\";\n     private static final String ACCESS_TOKEN = \"769cd41c-9602-4373-ba38-a2531643e041\";\n-    private static final String RESOURCE_ID = \"77bf97bc-3210-4c84-a0ef-9472dec712a0\";\n+    private static final String RESOURCE_ID = \"77bf97bc-3210-4c84-a0ef-9462dec712a0\";\n     private static final String REGION = \"westus2\";\n     private static final long EXPIRES_ON = 637258696186131476L;\n     private static final String EXPECTED_JSON_STRING = \"{\\\"modelId\\\":\\\"97bf97bc-3210-4c84-a0ef-9472dec711a0\\\",\"\n-        + \"\\\"accessToken\\\":\\\"769cd41c-9602-4373-ba38-a2531643e041\\\",\\\"expirationDateTimeTicks\\\":637258696186131476}\";\n+        + \"\\\"accessToken\\\":\\\"769cd41c-9602-4373-ba38-a2531643e041\\\",\"", "originalCommit": "ec57b0f453f5717963b25d3d664e26852ec845c6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE5MDMzNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11403#discussion_r434190334", "bodyText": "Yup, it's fake. Randomly generated, just wanted to use the correct format.", "author": "samvaity", "createdAt": "2020-06-02T21:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE4ODY3MQ=="}], "type": "inlineReview"}]}