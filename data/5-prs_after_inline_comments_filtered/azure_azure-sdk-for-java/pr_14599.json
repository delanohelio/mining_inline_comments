{"pr_number": 14599, "pr_title": "Add offset and length to SentenceSentiment", "pr_createdAt": "2020-08-28T23:57:47Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/14599", "timeline": [{"oid": "6476f73d5f8355c63169cbcc12c64a934818bb9f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6476f73d5f8355c63169cbcc12c64a934818bb9f", "message": "add offset and length for sentimentSentiment", "committedDate": "2020-08-28T23:52:54Z", "type": "commit"}, {"oid": "8f914029e29ac9d387803cc94f8db120ed7fcaba", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8f914029e29ac9d387803cc94f8db120ed7fcaba", "message": "review javadoc and make them consistency", "committedDate": "2020-08-31T04:17:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE5OTk1OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480199959", "bodyText": "nit: was just wondering why the comments disappeared from here", "author": "iscai-msft", "createdAt": "2020-08-31T15:17:10Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/CategorizedEntity.java", "diffHunk": "@@ -10,43 +10,21 @@\n  */\n @Immutable\n public final class CategorizedEntity {\n-    /*\n-     * CategorizedEntity text as appears in the request.\n-     */\n     private final String text;\n-\n-    /*\n-     * CategorizedEntity category, such as Person/Location/Org/SSN etc.\n-     */\n     private final EntityCategory category;\n-\n-    /*\n-     * CategorizedEntity sub category, such as Age/Year/TimeRange etc.\n-     */\n     private final String subcategory;\n-\n-    /*\n-     * Start position for the entity text.\n-     */\n+    private final double confidenceScore;", "originalCommit": "8f914029e29ac9d387803cc94f8db120ed7fcaba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI0NDU0NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480244545", "bodyText": "Trying to make the model consistency that don't have comments on the private properties.", "author": "mssfang", "createdAt": "2020-08-31T16:27:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE5OTk1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMTUyMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480201522", "bodyText": "I'm a little confused, since it appears that offset and length seemed to be already exposed for CategorizedEntity and LinkedEntityMatch, but not for SentenceSentiment. Could be reading this wrong, but I expected offset and length not to be exposed here before this PR", "author": "iscai-msft", "createdAt": "2020-08-31T15:19:49Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/CategorizedEntity.java", "diffHunk": "@@ -104,7 +84,17 @@ public String getSubcategory() {\n     }\n \n     /**\n-     * Get the offset of entity text.\n+     * Get the score property: If a well-known item is recognized, a decimal\n+     * number denoting the confidence level between 0 and 1 will be returned.\n+     *\n+     * @return The score value.\n+     */\n+    public double getConfidenceScore() {\n+        return this.confidenceScore;\n+    }\n+\n+    /**\n+     * Get the offset of entity text. The start position for the entity text in a document.", "originalCommit": "8f914029e29ac9d387803cc94f8db120ed7fcaba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI0Nzk1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480247958", "bodyText": "The PRs for adding CategorizedEntity and LinkedEntityMatch has merged in preview PR. But since the Opinion Mining PR hasn't merged in that point and trying to have less code conflicting, I wasn't done the offset and length at the same time of CategorizedEntity and LinkedEntityMatch. You can see what changes in CHANGELOG.  It should be fine and Sorry for the confusion.", "author": "mssfang", "createdAt": "2020-08-31T16:33:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMTUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI0ODM4NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480248385", "bodyText": "No problem, thanks for the clarification!", "author": "iscai-msft", "createdAt": "2020-08-31T16:34:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMTUyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMjE5Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480202197", "bodyText": "Can you add tests for the new offset and length properties?", "author": "iscai-msft", "createdAt": "2020-08-31T15:20:56Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/SentenceSentiment.java", "diffHunk": "@@ -77,12 +97,20 @@ public TextSentiment getSentiment() {\n     }\n \n     /**\n-     * Get the confidence score of the sentiment label. All score values sum up to 1, the higher the score, the\n-     * higher the confidence in the sentiment.\n+     * Get the offset of sentence. The start position for the sentence in a document.\n      *\n-     * @return The {@link SentimentConfidenceScores}.\n+     * @return The offset of sentence.\n      */\n-    public SentimentConfidenceScores getConfidenceScores() {\n-        return confidenceScores;\n+    public int getOffset() {\n+        return offset;\n+    }\n+\n+    /**\n+     * Get the length of sentence.\n+     *\n+     * @return The length of sentence.\n+     */\n+    public int getLength() {\n+        return length;", "originalCommit": "8f914029e29ac9d387803cc94f8db120ed7fcaba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI0ODkzMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480248933", "bodyText": "All tests that verifying the SentenceSentiment has verifying the offset and length. See https://github.com/Azure/azure-sdk-for-java/pull/14599/files/8f914029e29ac9d387803cc94f8db120ed7fcaba#diff-6152e7741d610810c960c85cfc56fbc2R361", "author": "mssfang", "createdAt": "2020-08-31T16:35:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMjE5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI1MTkwNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480251906", "bodyText": "Oh I'm so sorry I don't know how I totally missed those tests", "author": "iscai-msft", "createdAt": "2020-08-31T16:40:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMjE5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI1NDQzNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480254436", "bodyText": "No worries. Thank you for reviewing the PR.", "author": "mssfang", "createdAt": "2020-08-31T16:45:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMjE5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDMyNjc4NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480326784", "bodyText": "nit: Consider updating to start position for the sentence in a document.", "author": "samvaity", "createdAt": "2020-08-31T18:59:30Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/SentenceSentiment.java", "diffHunk": "@@ -77,12 +97,20 @@ public TextSentiment getSentiment() {\n     }\n \n     /**\n-     * Get the confidence score of the sentiment label. All score values sum up to 1, the higher the score, the\n-     * higher the confidence in the sentiment.\n+     * Get the offset of sentence. The start position for the sentence in a document.\n      *\n-     * @return The {@link SentimentConfidenceScores}.\n+     * @return The offset of sentence.", "originalCommit": "8f914029e29ac9d387803cc94f8db120ed7fcaba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQxMTA0OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480411048", "bodyText": "I feel it is too redundant for having it both in the method description and the return value.", "author": "mssfang", "createdAt": "2020-08-31T21:32:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDMyNjc4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDMzNDIxMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480334213", "bodyText": "These initializations are only on SentenceSentiment and not on LinkedEntityMatch or CategorizedEntity ?", "author": "samvaity", "createdAt": "2020-08-31T19:12:18Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/SentenceSentiment.java", "diffHunk": "@@ -7,51 +7,61 @@\n import com.azure.core.util.IterableStream;\n \n /**\n- * The {@link SentenceSentiment} model that contains a sentiment label of a sentence, confidence score of the\n- * sentiment label, length of the sentence and offset of the sentence within a document.\n+ * The {@link SentenceSentiment} model that contains a sentiment label of a sentence, confidence scores of the\n+ * sentiment label, mined opinions, offset of sentence, and length of sentence within a document.\n  */\n @Immutable\n public final class SentenceSentiment {\n     private final String text;\n-    private final SentimentConfidenceScores confidenceScores;\n     private final TextSentiment sentiment;\n+    private final SentimentConfidenceScores confidenceScores;\n     private final IterableStream<MinedOpinion> minedOpinions;\n+    private final int offset;\n+    private final int length;\n \n     /**\n      * Creates a {@link SentenceSentiment} model that describes the sentiment analysis of sentence.\n+     *\n      * @param text The sentence text.\n      * @param sentiment The sentiment label of the sentence.\n      * @param confidenceScores The sentiment confidence score (Softmax score) between 0 and 1, for each sentiment label.\n-     *   Higher values signify higher confidence.\n+     * Higher values signify higher confidence.\n      */\n     public SentenceSentiment(String text, TextSentiment sentiment, SentimentConfidenceScores confidenceScores) {\n         this.text = text;\n         this.sentiment = sentiment;\n-        this.minedOpinions = null;\n         this.confidenceScores = confidenceScores;\n+        this.minedOpinions = null;\n+        this.offset = 0;\n+        this.length = 0;", "originalCommit": "8f914029e29ac9d387803cc94f8db120ed7fcaba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQwNjYzMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14599#discussion_r480406630", "bodyText": "we do have in LinkedEntityMatch: https://github.com/Azure/azure-sdk-for-java/blob/master/sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/LinkedEntityMatch.java#L44\nand CategorizedEntity: https://github.com/Azure/azure-sdk-for-java/blob/master/sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/CategorizedEntity.java#L56", "author": "mssfang", "createdAt": "2020-08-31T21:22:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDMzNDIxMw=="}], "type": "inlineReview"}]}