{"pr_number": 14671, "pr_title": "Add implementation of DT Apis", "pr_createdAt": "2020-09-01T00:24:15Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/14671", "timeline": [{"oid": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/411b1a5b5a2989022ea5191880e40a2fda4f288f", "message": "add crud api cl for DT", "committedDate": "2020-09-01T00:21:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTYwMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481339601", "bodyText": "How about \"The deserialized application/json object representing the digital twin\"?", "author": "timtay-microsoft", "createdAt": "2020-09-01T18:16:01Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -112,8 +131,31 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n-    // TODO: This is a temporary implementation for sample purposes. This should be spruced up/replaced once this API is actually designed.\n-    // Input is Object and output is Response<T>.\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return The application/json digital twin created.", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MDMzMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481340333", "bodyText": "Here and everywhere for this comment and below. We need to avoid using the phrase \"convert\" when we should be saying \"deserialize\"", "author": "timtay-microsoft", "createdAt": "2020-09-01T18:17:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTYwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MTc2MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481351760", "bodyText": "a string representation of a json object isn't deserialized though, right? If anything, it is serialized from a class to this string.", "author": "drwill-ms", "createdAt": "2020-09-01T18:38:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTYwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM4ODMyMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481388321", "bodyText": "correct, that would be string representation", "author": "bikamani", "createdAt": "2020-09-01T19:42:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTYwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTc3OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481339779", "bodyText": "\"The generic type to serialize and deserialize the digital twin with\"", "author": "timtay-microsoft", "createdAt": "2020-09-01T18:16:22Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -112,8 +131,31 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n-    // TODO: This is a temporary implementation for sample purposes. This should be spruced up/replaced once this API is actually designed.\n-    // Input is Object and output is Response<T>.\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM4ODU0Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481388546", "bodyText": "just deserialize right?", "author": "bikamani", "createdAt": "2020-09-01T19:43:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTc3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTkxNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481339914", "bodyText": "\"The model class to serialize and deserialize the digital twin with\"", "author": "timtay-microsoft", "createdAt": "2020-09-01T18:16:39Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -112,8 +131,31 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n-    // TODO: This is a temporary implementation for sample purposes. This should be spruced up/replaced once this API is actually designed.\n-    // Input is Object and output is Response<T>.\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param clazz The model class to convert the response to.", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MzM5MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481343390", "bodyText": "I think we should create a task on the board to go through all doc comments and ensure they are in sync.", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:22:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MjUwOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481352508", "bodyText": "If that is an attempt to not try to do it right now, I'd advise not to do that. You'll create a monster and unpleasant work item for someone later.\nTry to get it as right as possible now. A task later would be to sanity check it and all ensure consistency.", "author": "drwill-ms", "createdAt": "2020-09-01T18:39:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1NDUzNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481354534", "bodyText": "@timtay-microsoft this method isn't doing both serialization and deserialization, so why mention both?", "author": "drwill-ms", "createdAt": "2020-09-01T18:43:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1NDc4Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481354782", "bodyText": "Yes, I meant the 2nd option, since we already have a bunch of implementations (with javadoc comments) merged in, which used a different wording.", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:44:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM2ODYyMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481368623", "bodyText": "Sure. I don't want to lower the bar for initial commits for comments. They should be held to the same standard as the code, at least. Agreed?", "author": "drwill-ms", "createdAt": "2020-09-01T19:04:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM2OTAxMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481369011", "bodyText": "In the create method, we serialize their parameter to send it over the wire, and then we deserialize the http response payload into the same type. But yeah, we can circle back on documentation consistency later", "author": "timtay-microsoft", "createdAt": "2020-09-01T19:05:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM3ODE5Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481378196", "bodyText": "@timtay-microsoft you are right. I'm on board.", "author": "drwill-ms", "createdAt": "2020-09-01T19:23:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM5Njg5OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481396898", "bodyText": "We only desiralize the response as per the \"clazz\". digital Twin input is Object. Am I missing something?", "author": "bikamani", "createdAt": "2020-09-01T19:59:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzOTkxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MDYyNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481340625", "bodyText": "An", "author": "drwill-ms", "createdAt": "2020-09-01T18:17:49Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a relationship: \", e);\n+                    return Mono.error(e);\n+                }\n+            });\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return A Http response containing the application/json digital twin", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MDc2OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481340768", "bodyText": "Capital An?", "author": "drwill-ms", "createdAt": "2020-09-01T18:18:05Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a relationship: \", e);\n+                    return Mono.error(e);\n+                }\n+            });\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, clazz, context));\n+    }\n+\n+    <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .map(response -> {\n+                T genericResponse = mapper.convertValue(response.getValue(), clazz);\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), genericResponse, twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @return an empty Mono", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MDk2Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481340962", "bodyText": "Aren't these return values supposed to be void with a lowercase 'v'?", "author": "drwill-ms", "createdAt": "2020-09-01T18:18:26Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a relationship: \", e);\n+                    return Mono.error(e);\n+                }\n+            });\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, clazz, context));\n+    }\n+\n+    <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .map(response -> {\n+                T genericResponse = mapper.convertValue(response.getValue(), clazz);\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), genericResponse, twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @return an empty Mono\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> updateDigitalTwin(String digitalTwinId, List<Object> digitalTwinUpdateOperations)\n+    {\n+        return updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, new RequestOptions())\n+            .flatMap(voidResponse -> Mono.empty());\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @param options The optional settings for this request\n+     * @return A Http response\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, RequestOptions options)\n+    {\n+        return withContext(context -> updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, options, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, RequestOptions options, Context context) {", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0Nzc1Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481347756", "bodyText": "Not in this case, no.\nHere we want the <T> in Response<T> to be the class representation of the lower case void, which is upper case Void.\nThis would be similar to the async API returning Mono<Integer>, which the sync version returns an int.", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:30:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MDk2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM3MDc0Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481370746", "bodyText": "I guess I don't get it then.\nhttps://stackoverflow.com/questions/15538219/java-lang-void-vs-void-vs-null#:~:text=void%20is%20a%20return%20type%20signifying%20no%20return.,rare%20instance%20where%20you%20need%20it%20for%20reflection.", "author": "drwill-ms", "createdAt": "2020-09-01T19:08:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MDk2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM3MTU4Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481371582", "bodyText": "Seems every response in that stackoverflow thread had a different take on it.", "author": "drwill-ms", "createdAt": "2020-09-01T19:10:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MDk2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM3OTg4MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481379881", "bodyText": "The void keyword signifies that there is nothing returned from this method call. The type Void is the class representation of that -> it cannot be instantiated, so it cannot have any values.\nIn scenarios where we have to represent the class representation of void, we use Void. This is useful in scenarios where the method definition defines the return type to be a generic class <T>, and we cannot modify it to return nothing -> void. (eg: when implementing methods from interfaces that we do not control/ own, etc).", "author": "abhipsaMisra", "createdAt": "2020-09-01T19:26:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MDk2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MTM0OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481341348", "bodyText": "Sometimes you have \"an http response\" and sometimes \"the http response\". Let's be consistent.", "author": "drwill-ms", "createdAt": "2020-09-01T18:19:08Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a relationship: \", e);\n+                    return Mono.error(e);\n+                }\n+            });\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, clazz, context));\n+    }\n+\n+    <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .map(response -> {\n+                T genericResponse = mapper.convertValue(response.getValue(), clazz);\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), genericResponse, twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @return an empty Mono\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> updateDigitalTwin(String digitalTwinId, List<Object> digitalTwinUpdateOperations)\n+    {\n+        return updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, new RequestOptions())\n+            .flatMap(voidResponse -> Mono.empty());\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @param options The optional settings for this request\n+     * @return A Http response\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, RequestOptions options)\n+    {\n+        return withContext(context -> updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, options, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, RequestOptions options, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .updateWithResponseAsync(digitalTwinId, digitalTwinUpdateOperations, options.getIfMatch(), context)\n+            .map(response -> {\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), response.getValue(), twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Deletes a digital twin. All relationships referencing the digital twin must already be deleted.\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return an empty Mono\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> deleteDigitalTwin(String digitalTwinId)\n+    {\n+        return deleteDigitalTwinWithResponse(digitalTwinId, new RequestOptions())\n+            .flatMap(voidResponse -> Mono.empty());\n+    }\n+\n+    /**\n+     * Deletes a digital twin. All relationships referencing the digital twin must already be deleted.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param options The optional settings for this request\n+     * @return The Http response", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM3NjA1NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481376055", "bodyText": "I am changing it to A {@link DigitalTwinsResponse} here and elsewhere :)", "author": "bikamani", "createdAt": "2020-09-01T19:19:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0MTM0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0Mzg4OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481343888", "bodyText": "the log statement says \"relationship\"", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:23:48Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a relationship: \", e);", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0NTkyMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481345923", "bodyText": "Shouldn't Object digitalTwin be T digitalTwin in the parameter list?", "author": "timtay-microsoft", "createdAt": "2020-09-01T18:27:34Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -112,8 +131,31 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n-    // TODO: This is a temporary implementation for sample purposes. This should be spruced up/replaced once this API is actually designed.\n-    // Input is Object and output is Response<T>.\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return The application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> createDigitalTwin(String digitalTwinId, Object digitalTwin, Class<T> clazz)\n+    {\n+        return createDigitalTwinWithResponse(digitalTwinId, digitalTwin, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return A Http response containing application/json digital twin created.\n+     */\n     @ServiceMethod(returns = ReturnType.SINGLE)\n     public <T> Mono<DigitalTwinsResponse<T>> createDigitalTwinWithResponse(String digitalTwinId, Object digitalTwin, Class<T> clazz) {", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1NjE4MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481356180", "bodyText": "The input digital twin object isn't being serialized or deserialized to any type, to the <T> type information doesn't lend any value. So we can take it in as an Object directly, just that it needs to be json serializable.", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:46:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0NTkyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM2OTM4Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481369386", "bodyText": "I'd say that taking in T rather than Object forces the user to understand that they will be receiving the same type that they are providing though, right?", "author": "timtay-microsoft", "createdAt": "2020-09-01T19:06:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0NTkyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM2OTg0Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481369846", "bodyText": "It would be a confusing error to the user if they provided a non-T object as an input parameter here", "author": "timtay-microsoft", "createdAt": "2020-09-01T19:07:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0NTkyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0NjA4MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481346081", "bodyText": "FYI: using a map here would have given us:\n.map(voidDigitalTwinsResponse -> null)\nEven though Mono<Void> is the same as an empty Mono -> Mono that doesn't return anything, I feel Mono.empty() is a better representation of the transformation we are doing here.\nHowever, I want to point out that the end result from both would still be the same.", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:27:52Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a relationship: \", e);\n+                    return Mono.error(e);\n+                }\n+            });\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, clazz, context));\n+    }\n+\n+    <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .map(response -> {\n+                T genericResponse = mapper.convertValue(response.getValue(), clazz);\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), genericResponse, twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @return an empty Mono\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> updateDigitalTwin(String digitalTwinId, List<Object> digitalTwinUpdateOperations)\n+    {\n+        return updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, new RequestOptions())\n+            .flatMap(voidResponse -> Mono.empty());", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0NjcxMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481346710", "bodyText": "copy paste error here. This API isn't retrieving a relationship. Make this more descriptive, too. Something like \"Failed to serialize retrieved digital twin to a string\"", "author": "timtay-microsoft", "createdAt": "2020-09-01T18:29:03Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a relationship: \", e);", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0ODExNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481348115", "bodyText": "Don't use the RequestOptions type directly. Each set of client side APIs should have their own request options implementation like \"UpdateDigitalTwinRequestOptions\" instead. That way we can add options to this API later without worrying about adding the same options to other APIs that share the same options type", "author": "timtay-microsoft", "createdAt": "2020-09-01T18:31:31Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a relationship: \", e);\n+                    return Mono.error(e);\n+                }\n+            });\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, clazz, context));\n+    }\n+\n+    <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .map(response -> {\n+                T genericResponse = mapper.convertValue(response.getValue(), clazz);\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), genericResponse, twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @return an empty Mono\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> updateDigitalTwin(String digitalTwinId, List<Object> digitalTwinUpdateOperations)\n+    {\n+        return updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, new RequestOptions())\n+            .flatMap(voidResponse -> Mono.empty());\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @param options The optional settings for this request\n+     * @return A Http response\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, RequestOptions options)", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1NjUyMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481356522", "bodyText": "I would start a thread with Srikanta to get some guidance here as we discussed", "author": "bikamani", "createdAt": "2020-09-01T18:47:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0ODExNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM3MDczNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481370734", "bodyText": "Feel free to start that thread then. My understanding is that they already document this style of optional parameter grouping here", "author": "timtay-microsoft", "createdAt": "2020-09-01T19:08:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0ODExNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM5NzcwNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481397707", "bodyText": "I did chat with Abhipsa later and have better understanding. I'm working on adding optional param classes for update and delete.", "author": "bikamani", "createdAt": "2020-09-01T20:01:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM0ODExNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MDc2OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481350768", "bodyText": "I don't like referring to the Response as just an \"Http response\". How about \"A {@link DigitalTwinsResponse} containing the application/json digital twin created.\"?", "author": "timtay-microsoft", "createdAt": "2020-09-01T18:36:20Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -89,8 +89,27 @@ public HttpPipeline getHttpPipeline() {\n         return this.protocolLayer.getHttpPipeline();\n     }\n \n-    // TODO: This is a temporary implementation for sample purposes. This should be spruced up/replaced once this API is actually designed.\n-    // Input is String and output is Response<String>.\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @return The application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> createDigitalTwin(String digitalTwinId, String digitalTwin)\n+    {\n+        return createDigitalTwinWithResponse(digitalTwinId, digitalTwin)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @return A Http response containing application/json digital twin created.", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MTM4MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481351381", "bodyText": "The DigitalTwinsResponse class has more info than just the http response, after all. It also has the http request", "author": "timtay-microsoft", "createdAt": "2020-09-01T18:37:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MDc2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1NjcwMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481356703", "bodyText": "Yes, I agree. I like \"A {@link DigitalTwinsResponse} containing the application/json digital twin created.\"", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:47:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MDc2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1Njc4Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481356782", "bodyText": "yeah definitely sounds better, I'll make that change", "author": "bikamani", "createdAt": "2020-09-01T18:47:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MDc2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MTkzNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481351935", "bodyText": "We are now creating subclasses for request options for these update APIs. That way you can add a new request option tomorrow for the update digital twin API, without having to wonder if and how that would affect the update relationship API.\nWe will also avoid adding more optional param combinations to our API surface.\nYou can refer to #14666 for an example.", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:38:28Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a relationship: \", e);\n+                    return Mono.error(e);\n+                }\n+            });\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param <T> The generic type to convert the response to.\n+     * @return A Http response containing the application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, clazz, context));\n+    }\n+\n+    <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .map(response -> {\n+                T genericResponse = mapper.convertValue(response.getValue(), clazz);\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), genericResponse, twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @return an empty Mono\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> updateDigitalTwin(String digitalTwinId, List<Object> digitalTwinUpdateOperations)\n+    {\n+        return updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, new RequestOptions())\n+            .flatMap(voidResponse -> Mono.empty());\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @param options The optional settings for this request\n+     * @return A Http response\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, RequestOptions options)", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1NzExMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481357112", "bodyText": "Let's sync on this offline.", "author": "bikamani", "createdAt": "2020-09-01T18:48:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MTkzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1Mjg4Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481352883", "bodyText": "This needs the <T> param description in javadoc comments", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:40:26Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java", "diffHunk": "@@ -59,6 +59,165 @@ public DigitalTwinsServiceVersion getServiceVersion() {\n         return this.digitalTwinsAsyncClient.getServiceVersion();\n     }\n \n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @return The application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public String createDigitalTwin(String digitalTwinId, String digitalTwin)\n+    {\n+        return createDigitalTwinWithResponse(digitalTwinId, digitalTwin, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Response<String> createDigitalTwinWithResponse(String digitalTwinId, String digitalTwin, Context context)\n+    {\n+        return digitalTwinsAsyncClient.createDigitalTwinWithResponse(digitalTwinId, digitalTwin, context).block();\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param clazz The model class to convert the response to.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @return The application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> T createDigitalTwin(String digitalTwinId, Object digitalTwin, Class<T> clazz)\n+    {\n+        return createDigitalTwinWithResponse(digitalTwinId, digitalTwin, clazz, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param clazz The model class to convert the response to.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Response<T> createDigitalTwinWithResponse(String digitalTwinId, Object digitalTwin, Class<T> clazz, Context context)\n+    {\n+        return digitalTwinsAsyncClient.createDigitalTwinWithResponse(digitalTwinId, digitalTwin, clazz, context).block();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public String getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Response<String> getDigitalTwinWithResponse(String digitalTwinId, Context context)\n+    {\n+        return digitalTwinsAsyncClient.getDigitalTwinWithResponse(digitalTwinId, context).block();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> T getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MzU3MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481353571", "bodyText": "You don't need to call .getValue() here, since the method neither does anything with the value, nor does it return it.\nYou can invoke the API and leave it at that.", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:41:47Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java", "diffHunk": "@@ -59,6 +59,165 @@ public DigitalTwinsServiceVersion getServiceVersion() {\n         return this.digitalTwinsAsyncClient.getServiceVersion();\n     }\n \n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @return The application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public String createDigitalTwin(String digitalTwinId, String digitalTwin)\n+    {\n+        return createDigitalTwinWithResponse(digitalTwinId, digitalTwin, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Response<String> createDigitalTwinWithResponse(String digitalTwinId, String digitalTwin, Context context)\n+    {\n+        return digitalTwinsAsyncClient.createDigitalTwinWithResponse(digitalTwinId, digitalTwin, context).block();\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param clazz The model class to convert the response to.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @return The application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> T createDigitalTwin(String digitalTwinId, Object digitalTwin, Class<T> clazz)\n+    {\n+        return createDigitalTwinWithResponse(digitalTwinId, digitalTwin, clazz, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param clazz The model class to convert the response to.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Response<T> createDigitalTwinWithResponse(String digitalTwinId, Object digitalTwin, Class<T> clazz, Context context)\n+    {\n+        return digitalTwinsAsyncClient.createDigitalTwinWithResponse(digitalTwinId, digitalTwin, clazz, context).block();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public String getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Response<String> getDigitalTwinWithResponse(String digitalTwinId, Context context)\n+    {\n+        return digitalTwinsAsyncClient.getDigitalTwinWithResponse(digitalTwinId, context).block();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> T getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Response<T> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context)\n+    {\n+        return digitalTwinsAsyncClient.getDigitalTwinWithResponse(digitalTwinId, clazz, context).block();\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public void updateDigitalTwin(String digitalTwinId, List<Object> digitalTwinUpdateOperations)\n+    {\n+        updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, new RequestOptions(), Context.NONE).getValue();", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1NzMxMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481357311", "bodyText": "Good point", "author": "bikamani", "createdAt": "2020-09-01T18:48:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MzU3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM3MTM0OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481371349", "bodyText": "Interestingly, the build pipelines will fail if you were to leave this calling .getValue() since the bug detector thinks we are ignoring a return type when we use it like this. I ran into this on the component APIs as well.", "author": "timtay-microsoft", "createdAt": "2020-09-01T19:09:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MzU3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM3NDU2NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481374565", "bodyText": "They have very thorough checks at the gate!", "author": "abhipsaMisra", "createdAt": "2020-09-01T19:16:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MzU3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MzkwOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481353908", "bodyText": "same here as well, no need to call .getValue() here.", "author": "abhipsaMisra", "createdAt": "2020-09-01T18:42:33Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java", "diffHunk": "@@ -59,6 +59,165 @@ public DigitalTwinsServiceVersion getServiceVersion() {\n         return this.digitalTwinsAsyncClient.getServiceVersion();\n     }\n \n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @return The application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public String createDigitalTwin(String digitalTwinId, String digitalTwin)\n+    {\n+        return createDigitalTwinWithResponse(digitalTwinId, digitalTwin, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Response<String> createDigitalTwinWithResponse(String digitalTwinId, String digitalTwin, Context context)\n+    {\n+        return digitalTwinsAsyncClient.createDigitalTwinWithResponse(digitalTwinId, digitalTwin, context).block();\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param clazz The model class to convert the response to.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @return The application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> T createDigitalTwin(String digitalTwinId, Object digitalTwin, Class<T> clazz)\n+    {\n+        return createDigitalTwinWithResponse(digitalTwinId, digitalTwin, clazz, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @param clazz The model class to convert the response to.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin created.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Response<T> createDigitalTwinWithResponse(String digitalTwinId, Object digitalTwin, Class<T> clazz, Context context)\n+    {\n+        return digitalTwinsAsyncClient.createDigitalTwinWithResponse(digitalTwinId, digitalTwin, clazz, context).block();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public String getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Response<String> getDigitalTwinWithResponse(String digitalTwinId, Context context)\n+    {\n+        return digitalTwinsAsyncClient.getDigitalTwinWithResponse(digitalTwinId, context).block();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @return The application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> T getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz, Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to convert the response to.\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response containing application/json digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Response<T> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context)\n+    {\n+        return digitalTwinsAsyncClient.getDigitalTwinWithResponse(digitalTwinId, clazz, context).block();\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public void updateDigitalTwin(String digitalTwinId, List<Object> digitalTwinUpdateOperations)\n+    {\n+        updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, new RequestOptions(), Context.NONE).getValue();\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @param options The optional settings for this request\n+     * @param context Additional context that is passed through the Http pipeline during the service call.\n+     * @return A Http response\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public DigitalTwinsResponse<Void> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, RequestOptions options, Context context)\n+    {\n+        return digitalTwinsAsyncClient.updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, options, context).block();\n+    }\n+\n+    /**\n+     * Deletes a digital twin. All relationships referencing the digital twin must already be deleted.\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public void deleteDigitalTwin(String digitalTwinId)\n+    {\n+        deleteDigitalTwinWithResponse(digitalTwinId, new RequestOptions(), Context.NONE).getValue();", "originalCommit": "411b1a5b5a2989022ea5191880e40a2fda4f288f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "403f4aeb27fb60a678bee9c15b3a111029b1d73a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/403f4aeb27fb60a678bee9c15b3a111029b1d73a", "message": "adding req options and addressing comments", "committedDate": "2020-09-01T20:17:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQwNzAxOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481407018", "bodyText": "typo: \"The\" is used twice", "author": "abhipsaMisra", "createdAt": "2020-09-01T20:19:22Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -89,8 +89,27 @@ public HttpPipeline getHttpPipeline() {\n         return this.protocolLayer.getHttpPipeline();\n     }\n \n-    // TODO: This is a temporary implementation for sample purposes. This should be spruced up/replaced once this API is actually designed.\n-    // Input is String and output is Response<String>.\n+    /**\n+     * Creates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwin The application/json digital twin to create.\n+     * @return The the application/json string representing the digital twin created.", "originalCommit": "403f4aeb27fb60a678bee9c15b3a111029b1d73a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQwODA1Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481408053", "bodyText": "How about we specify that the json processing exception occurred while serializing the response to string?", "author": "abhipsaMisra", "createdAt": "2020-09-01T20:21:18Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json string representing the digital twin.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A {@link DigitalTwinsResponse} containing the application/json string representing the digital twin.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a digital twin: \", e);", "originalCommit": "403f4aeb27fb60a678bee9c15b3a111029b1d73a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQwODM3MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481408370", "bodyText": "Copy/paste error in this comment. this is not used by the deleteDigitalTwin API", "author": "timtay-microsoft", "createdAt": "2020-09-01T20:21:50Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/UpdateDigitalTwinRequestOptions.java", "diffHunk": "@@ -0,0 +1,20 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.digitaltwins.core;\n+\n+import java.util.List;\n+\n+/**\n+ * Optional settings that are specific to calls to {@link DigitalTwinsClient#updateDigitalTwin(String, List)} and its overloads.\n+ */\n+public class UpdateDigitalTwinRequestOptions extends RequestOptions {\n+    // This class exists to be added to later if the deleteDigitalTwin APIs get a new optional parameter in later service", "originalCommit": "403f4aeb27fb60a678bee9c15b3a111029b1d73a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQxNDAzNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481414035", "bodyText": "done done", "author": "bikamani", "createdAt": "2020-09-01T20:32:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQwODM3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQwODg5NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481408895", "bodyText": "do add a null check for options before invoking the getter for ifMatch.", "author": "abhipsaMisra", "createdAt": "2020-09-01T20:22:53Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json string representing the digital twin.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A {@link DigitalTwinsResponse} containing the application/json string representing the digital twin.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a digital twin: \", e);\n+                    return Mono.error(e);\n+                }\n+            });\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to deserialize the response with.\n+     * @param <T> The generic type to deserialize the digital twin with.\n+     * @return The deserialized application/json object representing the digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to deserialize the response with.\n+     * @param <T> The generic type to deserialize the digital twin with.\n+     * @return A {@link DigitalTwinsResponse} containing the deserialized application/json object representing the digital twin.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, clazz, context));\n+    }\n+\n+    <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .map(response -> {\n+                T genericResponse = mapper.convertValue(response.getValue(), clazz);\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), genericResponse, twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @return An empty Mono\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> updateDigitalTwin(String digitalTwinId, List<Object> digitalTwinUpdateOperations)\n+    {\n+        return updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, new UpdateDigitalTwinRequestOptions())\n+            .flatMap(voidResponse -> Mono.empty());\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @param options The optional settings for this request\n+     * @return A {@link DigitalTwinsResponse}\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, UpdateDigitalTwinRequestOptions options)\n+    {\n+        return withContext(context -> updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, options, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, UpdateDigitalTwinRequestOptions options, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .updateWithResponseAsync(digitalTwinId, digitalTwinUpdateOperations, options.getIfMatch(), context)", "originalCommit": "403f4aeb27fb60a678bee9c15b3a111029b1d73a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQwOTA1Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481409053", "bodyText": "same here as well, null check for options", "author": "abhipsaMisra", "createdAt": "2020-09-01T20:23:15Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -130,6 +172,156 @@ public HttpPipeline getHttpPipeline() {\n             });\n     }\n \n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return The application/json string representing the digital twin.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<String> getDigitalTwin(String digitalTwinId)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return A {@link DigitalTwinsResponse} containing the application/json string representing the digital twin.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<String>> getDigitalTwinWithResponse(String digitalTwinId, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .flatMap(response -> {\n+                try {\n+                    String jsonResponse = mapper.writeValueAsString(response.getValue());\n+                    DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                    return Mono.justOrEmpty(new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), jsonResponse, twinHeaders));\n+                } catch (JsonProcessingException e) {\n+                    logger.error(\"JsonProcessingException occurred while retrieving a digital twin: \", e);\n+                    return Mono.error(e);\n+                }\n+            });\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to deserialize the response with.\n+     * @param <T> The generic type to deserialize the digital twin with.\n+     * @return The deserialized application/json object representing the digital twin\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<T> getDigitalTwin(String digitalTwinId, Class<T> clazz)\n+    {\n+        return getDigitalTwinWithResponse(digitalTwinId, clazz)\n+            .map(DigitalTwinsResponse::getValue);\n+    }\n+\n+    /**\n+     * Gets a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param clazz The model class to deserialize the response with.\n+     * @param <T> The generic type to deserialize the digital twin with.\n+     * @return A {@link DigitalTwinsResponse} containing the deserialized application/json object representing the digital twin.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz)\n+    {\n+        return withContext(context -> getDigitalTwinWithResponse(digitalTwinId, clazz, context));\n+    }\n+\n+    <T> Mono<DigitalTwinsResponse<T>> getDigitalTwinWithResponse(String digitalTwinId, Class<T> clazz, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .getByIdWithResponseAsync(digitalTwinId, context)\n+            .map(response -> {\n+                T genericResponse = mapper.convertValue(response.getValue(), clazz);\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), genericResponse, twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @return An empty Mono\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> updateDigitalTwin(String digitalTwinId, List<Object> digitalTwinUpdateOperations)\n+    {\n+        return updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, new UpdateDigitalTwinRequestOptions())\n+            .flatMap(voidResponse -> Mono.empty());\n+    }\n+\n+    /**\n+     * Updates a digital twin.\n+     *\n+     * @param digitalTwinId The Id of the digital twin.\n+     * @param digitalTwinUpdateOperations The application/json-patch+json operations to be performed on the specified digital twin\n+     * @param options The optional settings for this request\n+     * @return A {@link DigitalTwinsResponse}\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, UpdateDigitalTwinRequestOptions options)\n+    {\n+        return withContext(context -> updateDigitalTwinWithResponse(digitalTwinId, digitalTwinUpdateOperations, options, context));\n+    }\n+\n+    Mono<DigitalTwinsResponse<Void>> updateDigitalTwinWithResponse(String digitalTwinId, List<Object> digitalTwinUpdateOperations, UpdateDigitalTwinRequestOptions options, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .updateWithResponseAsync(digitalTwinId, digitalTwinUpdateOperations, options.getIfMatch(), context)\n+            .map(response -> {\n+                DigitalTwinsResponseHeaders twinHeaders = mapper.convertValue(response.getDeserializedHeaders(), DigitalTwinsResponseHeaders.class);\n+                return new DigitalTwinsResponse<>(response.getRequest(), response.getStatusCode(), response.getHeaders(), response.getValue(), twinHeaders);\n+            });\n+    }\n+\n+    /**\n+     * Deletes a digital twin. All relationships referencing the digital twin must already be deleted.\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @return An empty Mono\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> deleteDigitalTwin(String digitalTwinId)\n+    {\n+        return deleteDigitalTwinWithResponse(digitalTwinId, new DeleteDigitalTwinRequestOptions())\n+            .flatMap(voidResponse -> Mono.empty());\n+    }\n+\n+    /**\n+     * Deletes a digital twin. All relationships referencing the digital twin must already be deleted.\n+     *\n+     * @param digitalTwinId The Id of the digital twin. The Id is unique within the service and case sensitive.\n+     * @param options The optional settings for this request\n+     * @return The Http response\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Response<Void>> deleteDigitalTwinWithResponse(String digitalTwinId, DeleteDigitalTwinRequestOptions options)\n+    {\n+        return withContext(context -> deleteDigitalTwinWithResponse(digitalTwinId, options, context));\n+    }\n+\n+    Mono<Response<Void>> deleteDigitalTwinWithResponse(String digitalTwinId, DeleteDigitalTwinRequestOptions options, Context context) {\n+        return protocolLayer\n+            .getDigitalTwins()\n+            .deleteWithResponseAsync(digitalTwinId, options.getIfMatch(), context);", "originalCommit": "403f4aeb27fb60a678bee9c15b3a111029b1d73a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQwOTY1OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14671#discussion_r481409659", "bodyText": "this comment references the delete API, it needs to be updated.", "author": "abhipsaMisra", "createdAt": "2020-09-01T20:24:22Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/UpdateDigitalTwinRequestOptions.java", "diffHunk": "@@ -0,0 +1,20 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.digitaltwins.core;\n+\n+import java.util.List;\n+\n+/**\n+ * Optional settings that are specific to calls to {@link DigitalTwinsClient#updateDigitalTwin(String, List)} and its overloads.\n+ */\n+public class UpdateDigitalTwinRequestOptions extends RequestOptions {\n+    // This class exists to be added to later if the deleteDigitalTwin APIs get a new optional parameter in later service", "originalCommit": "403f4aeb27fb60a678bee9c15b3a111029b1d73a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "04de3ef8b110c5c593a25c78196c7a89e5cc9816", "url": "https://github.com/Azure/azure-sdk-for-java/commit/04de3ef8b110c5c593a25c78196c7a89e5cc9816", "message": "addressing more comments", "committedDate": "2020-09-01T20:42:58Z", "type": "commit"}, {"oid": "513581feed3fdd1767570b10da11e177bdb5c23c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/513581feed3fdd1767570b10da11e177bdb5c23c", "message": "document for T", "committedDate": "2020-09-01T20:45:21Z", "type": "commit"}]}