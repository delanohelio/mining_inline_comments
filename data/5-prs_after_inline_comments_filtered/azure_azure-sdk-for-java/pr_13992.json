{"pr_number": 13992, "pr_title": "Update FieldBuilder and MemberNameConverter", "pr_createdAt": "2020-08-11T22:21:19Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/13992", "timeline": [{"oid": "2e7af51f97de9f22c929ff088cd0609cbfea1312", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2e7af51f97de9f22c929ff088cd0609cbfea1312", "message": "Update JacksonJsonSerializer's MemberNameConverter implementation", "committedDate": "2020-08-10T22:36:12Z", "type": "commit"}, {"oid": "4a47c0576602193a9d6187fc70de5c1c0a83b42b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4a47c0576602193a9d6187fc70de5c1c0a83b42b", "message": "Update FieldBuilderOptions to take JsonSerializer instead of MemberNameConverter", "committedDate": "2020-08-10T23:53:13Z", "type": "commit"}, {"oid": "7f737b1585f965fa9a2fafce39f3c72b14392564", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7f737b1585f965fa9a2fafce39f3c72b14392564", "message": "Merge branch 'master' into AzCore_FinalizeMemberNameConverter", "committedDate": "2020-08-11T18:42:25Z", "type": "commit"}, {"oid": "5f9438bac3c4d736cb41ac4eeef53e0e1b844c83", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5f9438bac3c4d736cb41ac4eeef53e0e1b844c83", "message": "Update FieldBuilder to check both Fields and Methods", "committedDate": "2020-08-11T22:19:04Z", "type": "commit"}, {"oid": "23a35540a142efd2576a7ed7830a17f3747b6524", "url": "https://github.com/Azure/azure-sdk-for-java/commit/23a35540a142efd2576a7ed7830a17f3747b6524", "message": "Resolve conflict", "committedDate": "2020-08-11T22:36:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkwNzE5Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13992#discussion_r468907192", "bodyText": "It would be useful log a warning if the method has any annotation but is non-public. It will let the users know that the visibility of the method is the reason for ignoring it. Same for field too.", "author": "srnagar", "createdAt": "2020-08-11T22:48:41Z", "path": "sdk/core/azure-core-serializer-json-jackson/src/main/java/com/azure/core/serializer/json/jackson/JacksonJsonSerializer.java", "diffHunk": "@@ -82,36 +84,70 @@ public String convertMemberName(Member member) {\n         if (Modifier.isTransient(member.getModifiers())) {\n             return null;\n         }\n+\n+        VisibilityChecker<?> visibilityChecker = mapper.getVisibilityChecker();\n         if (member instanceof Field) {\n             Field f = (Field) member;\n-            if (f.isAnnotationPresent(JsonIgnore.class)) {\n+\n+            if (f.isAnnotationPresent(JsonIgnore.class) || !visibilityChecker.isFieldVisible(f)) {\n                 return null;\n             }\n+\n             if (f.isAnnotationPresent(JsonProperty.class)) {\n                 String propertyName = f.getDeclaredAnnotation(JsonProperty.class).value();\n                 return CoreUtils.isNullOrEmpty(propertyName) ? f.getName() : propertyName;\n             }\n+\n             return f.getName();\n         }\n \n         if (member instanceof Method) {\n             Method m = (Method) member;\n-            String methodNameWithoutJavaBeans = removePrefix(m);\n-            if (m.isAnnotationPresent(JsonIgnore.class)) {\n+\n+            /*\n+             * If the method isn't a getter, is annotated with JsonIgnore, or isn't visible to the ObjectMapper ignore\n+             * it.\n+             */\n+            if (!verifyGetter(m)\n+                || m.isAnnotationPresent(JsonIgnore.class)\n+                || !visibilityChecker.isGetterVisible(m)) {", "originalCommit": "23a35540a142efd2576a7ed7830a17f3747b6524", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkxMjEwMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13992#discussion_r468912102", "bodyText": "Only log in the instance of the method/field being ignored due to visibility and not due to annotations?", "author": "alzimmermsft", "createdAt": "2020-08-11T23:03:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkwNzE5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkwNzc4Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13992#discussion_r468907787", "bodyText": "Was this intended? Seems like random string in the javadoc.", "author": "srnagar", "createdAt": "2020-08-11T22:50:19Z", "path": "sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/SearchClient.java", "diffHunk": "@@ -39,7 +39,7 @@\n \n     /**\n      * Package private constructor to be used by {@link SearchClientBuilder}\n-     *\n+     *classWithGettersWithAnnotations", "originalCommit": "23a35540a142efd2576a7ed7830a17f3747b6524", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkxMTU3MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13992#discussion_r468911571", "bodyText": "Likely an accidental paste, will remove it.", "author": "alzimmermsft", "createdAt": "2020-08-11T23:01:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkwNzc4Nw=="}], "type": "inlineReview"}, {"oid": "4fa5795c546eab60ae46fe762b037a93a1655f2c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4fa5795c546eab60ae46fe762b037a93a1655f2c", "message": "Merge branch 'master' into AzCore_FinalizeMemberNameConverter", "committedDate": "2020-08-12T00:37:37Z", "type": "commit"}, {"oid": "e86ababe7f9abacc840772284cb20aef0d391fe1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e86ababe7f9abacc840772284cb20aef0d391fe1", "message": "Add logging when the Field or Method isn't accessible to the MemberNameConverter but has annotations to serialize it", "committedDate": "2020-08-12T00:41:14Z", "type": "commit"}, {"oid": "9cb7f1e593932ea2a9fba1f0871e7c463fba7b4e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9cb7f1e593932ea2a9fba1f0871e7c463fba7b4e", "message": "Update Field logger message", "committedDate": "2020-08-12T00:48:12Z", "type": "commit"}]}