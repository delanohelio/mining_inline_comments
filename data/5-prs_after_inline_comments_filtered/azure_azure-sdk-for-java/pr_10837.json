{"pr_number": 10837, "pr_title": "Update README and samples", "pr_createdAt": "2020-05-06T17:19:54Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/10837", "timeline": [{"oid": "de668adee7127d9421688278d1c87192b3ca258a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/de668adee7127d9421688278d1c87192b3ca258a", "message": "Fixing checkstyles", "committedDate": "2020-05-06T17:23:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTEwMjgyNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10837#discussion_r421102824", "bodyText": "might be true? :) I mean, it's unnamed so it's whatever the next available session is.\nNot sure if this is a copy/paste error or not but it might warrant some explanatory text either way.", "author": "richardpark-msft", "createdAt": "2020-05-06T21:27:00Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java", "diffHunk": "@@ -55,19 +59,118 @@ public void createAsynchronousServiceBusReceiverWithAzureIdentity() {\n     }\n \n     /**\n-     * Code sample for creating an asynchronous Service Bus receiver using Aad.\n+     * Sends messages to a queue.\n      */\n-    public void createAsynchronousServiceBusReceiverWithAad() {\n-        ClientSecretCredential credential = new ClientSecretCredentialBuilder()\n-            .clientId(\"<< APPLICATION (CLIENT) ID >>\")\n-            .clientSecret(\"<< APPLICATION SECRET >>\")\n-            .tenantId(\"<< TENANT ID >>\")\n-            .build();\n+    public void sendMessage() {\n+        ServiceBusSenderClient sender = new ServiceBusClientBuilder()\n+            .connectionString(\"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\")\n+            .sender()\n+            .queueName(\"<< QUEUE NAME >>\")\n+            .buildClient();\n+        List<ServiceBusMessage> messages = Arrays.asList(\n+            new ServiceBusMessage(\"Hello world\".getBytes()).setMessageId(\"1\"),\n+            new ServiceBusMessage(\"Bonjour\".getBytes()).setMessageId(\"2\"));\n+\n+        sender.send(messages);\n+    }\n+\n+    /**\n+     * Receives messages from a topic and subscription.\n+     */\n+    public void receiveMessages() {\n+        ServiceBusReceiverClient receiver = new ServiceBusClientBuilder()\n+            .connectionString(\"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\")\n+            .receiver()\n+            .topicName(\"<< TOPIC NAME >>\")\n+            .subscriptionName(\"<< SUBSCRIPTION NAME >>\")\n+            .receiveMode(ReceiveMode.PEEK_LOCK)\n+            .buildClient();\n \n+        IterableStream<ServiceBusReceivedMessageContext> messages = receiver.receive(10, Duration.ofSeconds(30));\n+        messages.forEach(context -> {\n+            ServiceBusReceivedMessage message = context.getMessage();\n+            System.out.printf(\"Id: %s. Contents: %s%n\", message.getMessageId(),\n+                new String(message.getBody(), StandardCharsets.UTF_8));\n+        });\n+    }\n+\n+    /**\n+     * Receives messages asynchronously.\n+     */\n+    public void receiveMessagesAsync() {\n         ServiceBusReceiverAsyncClient receiver = new ServiceBusClientBuilder()\n-            .credential(\"<<fully-qualified-namespace>>\", credential)\n+            .connectionString(\"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\")\n             .receiver()\n-            .queueName(\"<<queue-name>>\")\n+            .queueName(\"<< QUEUE NAME >>\")\n+            .buildAsyncClient();\n+\n+        Disposable subscription = receiver.receive().subscribe(context -> {\n+            ServiceBusReceivedMessage message = context.getMessage();\n+            System.out.printf(\"Id: %s%n\", message.getMessageId());\n+            System.out.printf(\"Contents: %s%n\", new String(message.getBody(), StandardCharsets.UTF_8));\n+        }, error -> {\n+                System.err.println(\"Error occurred while receiving messages: \" + error);\n+            }, () -> {\n+                System.out.println(\"Finished receiving messages.\");\n+            });\n+    }\n+\n+    /**\n+     * Complete a message.\n+     */\n+    public void completeMessage() {\n+        ServiceBusReceiverClient receiver = new ServiceBusClientBuilder()\n+            .connectionString(\"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\")\n+            .receiver()\n+            .topicName(\"<< TOPIC NAME >>\")\n+            .subscriptionName(\"<< SUBSCRIPTION NAME >>\")\n+            .receiveMode(ReceiveMode.PEEK_LOCK)\n+            .buildClient();\n+\n+        receiver.receive(10).forEach(context -> {\n+            ServiceBusReceivedMessage message = context.getMessage();\n+\n+            // Process message and then complete it.\n+            receiver.complete(message);\n+        });\n+    }\n+\n+    /**\n+     * Create a session message.\n+     */\n+    public void createSessionMessage() {\n+        ServiceBusSenderClient sender = new ServiceBusClientBuilder()\n+            .connectionString(\"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\")\n+            .sender()\n+            .queueName(\"<< QUEUE NAME >>\")\n+            .buildClient();\n+\n+        ServiceBusMessage message = new ServiceBusMessage(\"Hello world\".getBytes())\n+            .setSessionId(\"greetings\");\n+\n+        sender.send(message);\n+    }\n+\n+    /**\n+     * Create session receiver for \"greetings\"\n+     */\n+    public void namedSessionReceiver() {\n+        ServiceBusReceiverAsyncClient receiver = new ServiceBusClientBuilder()\n+            .connectionString(\"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\")\n+            .sessionReceiver()\n+            .queueName(\"<< QUEUE NAME >>\")\n+            .sessionId(\"greetings\")\n+            .buildAsyncClient();\n+    }\n+\n+    /**\n+     * Create session receiver for \"greetings\"", "originalCommit": "8218e52b76f3aee91ed1ca56017289904b96c715", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "27b91560d20d994b8abf2d3a9e91e9bb2d1d0f0d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/27b91560d20d994b8abf2d3a9e91e9bb2d1d0f0d", "message": "Adding README samples and update README.md", "committedDate": "2020-05-07T02:23:23Z", "type": "commit"}, {"oid": "034728686326f9c0e4ae107831f49b5a4a648f1c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/034728686326f9c0e4ae107831f49b5a4a648f1c", "message": "Remove unmaintained CONTRIBUTING and link to one in master.", "committedDate": "2020-05-07T02:23:23Z", "type": "commit"}, {"oid": "5e566e0434aa2548931959d10859e7999a8869be", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5e566e0434aa2548931959d10859e7999a8869be", "message": "Fixing samples and fixing them.", "committedDate": "2020-05-07T02:23:23Z", "type": "commit"}, {"oid": "6738033234ba6007a4438d1feda80d51f3952a77", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6738033234ba6007a4438d1feda80d51f3952a77", "message": "Fixing checkstyles", "committedDate": "2020-05-07T02:23:23Z", "type": "commit"}, {"oid": "f134e2217ba0d1f4792a42ebfb2bc8379e44fea3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f134e2217ba0d1f4792a42ebfb2bc8379e44fea3", "message": "Update header", "committedDate": "2020-05-07T02:23:24Z", "type": "commit"}, {"oid": "5bff8cd661890d9ccf6128a9e9e006f22c8b2a91", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5bff8cd661890d9ccf6128a9e9e006f22c8b2a91", "message": "README fixes.", "committedDate": "2020-05-07T02:23:24Z", "type": "commit"}, {"oid": "4202045cba41529e9c64d9adb86e6d258d2055ea", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4202045cba41529e9c64d9adb86e6d258d2055ea", "message": "Fix readmes", "committedDate": "2020-05-07T02:23:24Z", "type": "commit"}, {"oid": "a8020c49fbc2ea5da16544f87df42c2894af3ca2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a8020c49fbc2ea5da16544f87df42c2894af3ca2", "message": "Fix tests.", "committedDate": "2020-05-07T02:23:24Z", "type": "commit"}, {"oid": "8b81d9665a9c252d2bfb16ef23c68d4d1a659676", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8b81d9665a9c252d2bfb16ef23c68d4d1a659676", "message": "Add informational logging.", "committedDate": "2020-05-07T02:23:25Z", "type": "commit"}, {"oid": "e33e132541a83ffc826e6d6d40ba91a506911d69", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e33e132541a83ffc826e6d6d40ba91a506911d69", "message": "Fixing README.md", "committedDate": "2020-05-07T02:23:25Z", "type": "commit"}, {"oid": "e33e132541a83ffc826e6d6d40ba91a506911d69", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e33e132541a83ffc826e6d6d40ba91a506911d69", "message": "Fixing README.md", "committedDate": "2020-05-07T02:23:25Z", "type": "forcePushed"}, {"oid": "7686853a9b38e6c3093008e03cf7068ed582a46f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7686853a9b38e6c3093008e03cf7068ed582a46f", "message": "README feedback", "committedDate": "2020-05-07T03:50:17Z", "type": "commit"}]}