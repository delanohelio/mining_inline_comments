{"pr_number": 12400, "pr_title": "Test coverage for Form Recognizer client, Part 1", "pr_createdAt": "2020-06-22T21:45:16Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/12400", "timeline": [{"oid": "2aa7a2b7679e8d4619a35cc101cf0ccca93efd13", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2aa7a2b7679e8d4619a35cc101cf0ccca93efd13", "message": "test coverage for Form Recognizer clients", "committedDate": "2020-06-22T19:55:52Z", "type": "commit"}, {"oid": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "message": "add record json files", "committedDate": "2020-06-23T07:06:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5NDAxMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r444494013", "bodyText": "Update this to using the public beginRecognizeContent API", "author": "samvaity", "createdAt": "2020-06-23T20:41:30Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -210,6 +300,55 @@ public void recognizeContentResultWithContentTypeAutoDetection(HttpClient httpCl\n         });\n     }\n \n+    /**\n+     * Verifies blank form file is still a valid file to process\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeContentResultWithBlankPdf(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        SyncPoller<OperationResult, List<FormPage>> syncPoller =\n+            client.beginRecognizeContent(getReplayableBufferData(BLANK_FORM_LOCAL_URL), BLANK_FORM_FILE_LENGTH,", "originalCommit": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk3MTE2Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445971163", "bodyText": "not sure what it means.\nclient.beginRecognizeContent()\n\nis already a public API", "author": "mssfang", "createdAt": "2020-06-26T05:14:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5NDAxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5NDUwNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r444494506", "bodyText": "bad as in incorrect or not supported?", "author": "samvaity", "createdAt": "2020-06-23T20:42:26Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -210,6 +300,55 @@ public void recognizeContentResultWithContentTypeAutoDetection(HttpClient httpCl\n         });\n     }\n \n+    /**\n+     * Verifies blank form file is still a valid file to process\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeContentResultWithBlankPdf(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        SyncPoller<OperationResult, List<FormPage>> syncPoller =\n+            client.beginRecognizeContent(getReplayableBufferData(BLANK_FORM_LOCAL_URL), BLANK_FORM_FILE_LENGTH,\n+                FormContentType.APPLICATION_PDF, null).getSyncPoller();\n+        syncPoller.waitForCompletion();\n+        validateContentResultData(syncPoller.getFinalResult(), false);\n+    }\n+\n+    /**\n+     * Verifies throwing exception when using bad content type argument\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeBadContentTypeArgument(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+//        Exception ex = assertThrows(RuntimeException.class, () -> client.beginRecognizeContent(", "originalCommit": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5NDY5Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r444494697", "bodyText": "Need to fix something here?", "author": "samvaity", "createdAt": "2020-06-23T20:42:45Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -210,6 +300,55 @@ public void recognizeContentResultWithContentTypeAutoDetection(HttpClient httpCl\n         });\n     }\n \n+    /**\n+     * Verifies blank form file is still a valid file to process\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeContentResultWithBlankPdf(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        SyncPoller<OperationResult, List<FormPage>> syncPoller =\n+            client.beginRecognizeContent(getReplayableBufferData(BLANK_FORM_LOCAL_URL), BLANK_FORM_FILE_LENGTH,\n+                FormContentType.APPLICATION_PDF, null).getSyncPoller();\n+        syncPoller.waitForCompletion();\n+        validateContentResultData(syncPoller.getFinalResult(), false);\n+    }\n+\n+    /**\n+     * Verifies throwing exception when using bad content type argument\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeBadContentTypeArgument(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+//        Exception ex = assertThrows(RuntimeException.class, () -> client.beginRecognizeContent(\n+//            getReplayableBufferData(BLANK_FORM_LOCAL_URL), BLANK_FORM_FILE_LENGTH,\n+//            FormContentType.APPLICATION_PDF, null).getSyncPoller());\n+        // TODO: this should throw exception, probably we don't have the pre-check for the FormContentType", "originalCommit": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5NTQ1Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r444495453", "bodyText": "Can this supplier give both jpg form data and length?", "author": "samvaity", "createdAt": "2020-06-23T20:44:13Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -277,11 +445,78 @@ public void recognizeCustomFormLabeledData(HttpClient httpClient, FormRecognizer\n     }\n \n     /**\n-     * Verifies an exception thrown for a document using null data value or null model id.\n+     * Verifies custom form data for a JPG content type with labeled data\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormLabeledDataWithJpgContentType(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormJpgDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {", "originalCommit": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5NjIyMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r444496223", "bodyText": "No need to train if test is to check for null model Id?", "author": "samvaity", "createdAt": "2020-06-23T20:45:42Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -293,12 +528,72 @@ public void recognizeCustomFormLabeledDataWithNullValues(HttpClient httpClient,\n             assertThrows(RuntimeException.class, () -> client.beginRecognizeCustomForms(null,\n                 syncPoller.getFinalResult().getModelId(), CUSTOM_FORM_FILE_LENGTH, FormContentType.APPLICATION_PDF,\n                 true, null).getSyncPoller());\n+        }));\n+    }\n+\n+    /**\n+     * Verifies an exception thrown for a document using null model id.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormLabeledDataWithNullModelId(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> syncPoller =", "originalCommit": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5NjUwOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r444496508", "bodyText": "Same here. No need to train, if we are not going to use the training result.", "author": "samvaity", "createdAt": "2020-06-23T20:46:18Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -293,12 +528,72 @@ public void recognizeCustomFormLabeledDataWithNullValues(HttpClient httpClient,\n             assertThrows(RuntimeException.class, () -> client.beginRecognizeCustomForms(null,\n                 syncPoller.getFinalResult().getModelId(), CUSTOM_FORM_FILE_LENGTH, FormContentType.APPLICATION_PDF,\n                 true, null).getSyncPoller());\n+        }));\n+    }\n+\n+    /**\n+     * Verifies an exception thrown for a document using null model id.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormLabeledDataWithNullModelId(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> syncPoller =\n+                getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n+                    useTrainingLabels).getSyncPoller();\n+            syncPoller.waitForCompletion();\n+\n+            Exception ex = assertThrows(RuntimeException.class, () ->\n+                client.beginRecognizeCustomForms(toFluxByteBuffer(data), null,\n+                CUSTOM_FORM_FILE_LENGTH, FormContentType.APPLICATION_PDF, true, null)\n+                    .getSyncPoller());\n+            assertEquals(EXPECTED_MODEL_ID_IS_REQUIRED_EXCEPTION_MESSAGE, ex.getMessage());\n+        }));\n+    }\n+\n+    /**\n+     * Verifies an exception thrown for an empty model id when recognizing custom form from URL.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormLabeledDataWithEmptyModelId(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> syncPoller =", "originalCommit": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5ODAyOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r444498028", "bodyText": "updatethese  to use the public API's in the tests and not the package private APIs.\nApplies to all test methods.", "author": "samvaity", "createdAt": "2020-06-23T20:49:02Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -316,12 +611,37 @@ public void recognizeCustomFormLabeledDataWithContentTypeAutoDetection(HttpClien\n \n             SyncPoller<OperationResult, List<RecognizedForm>> syncPoller =\n                 client.beginRecognizeCustomForms(getReplayableBufferData(FORM_LOCAL_URL),\n-                    trainingPoller.getFinalResult().getModelId(), CUSTOM_FORM_FILE_LENGTH, null, true, null).getSyncPoller();\n+                    trainingPoller.getFinalResult().getModelId(), CUSTOM_FORM_FILE_LENGTH, null,", "originalCommit": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUwNDAwNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r444504006", "bodyText": "recognizeReceiptDataTextDetailsWithNullData -> recognizeReceiptDataNullData\n?", "author": "samvaity", "createdAt": "2020-06-23T20:57:20Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerClientTestBase.java", "diffHunk": "@@ -274,29 +284,58 @@ private static void validatePageRangeData(int expectedPageInfo, FormPageRange ac\n         assertEquals(expectedPageInfo, actualPageInfo.getLastPageNumber());\n     }\n \n+    // Receipt recognition\n+\n     @Test\n-    abstract void recognizeReceiptSourceUrl(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion);\n+    abstract void recognizeReceiptData(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion);\n \n     @Test\n-    abstract void recognizeReceiptSourceUrlTextDetails(HttpClient httpClient,\n+    abstract void recognizeReceiptDataTextDetailsWithNullData(HttpClient httpClient,", "originalCommit": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUwNDU4OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r444504588", "bodyText": "recognizeReceiptSourceUrlTextDetails -> recognizeReceiptFromUrlTextContent", "author": "samvaity", "createdAt": "2020-06-23T20:58:28Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerClientTestBase.java", "diffHunk": "@@ -274,29 +284,58 @@ private static void validatePageRangeData(int expectedPageInfo, FormPageRange ac\n         assertEquals(expectedPageInfo, actualPageInfo.getLastPageNumber());\n     }\n \n+    // Receipt recognition\n+\n     @Test\n-    abstract void recognizeReceiptSourceUrl(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion);\n+    abstract void recognizeReceiptData(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion);\n \n     @Test\n-    abstract void recognizeReceiptSourceUrlTextDetails(HttpClient httpClient,\n+    abstract void recognizeReceiptDataTextDetailsWithNullData(HttpClient httpClient,\n         FormRecognizerServiceVersion serviceVersion);\n \n     @Test\n-    abstract void recognizeReceiptData(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion);\n+    abstract void recognizeReceiptDataWithContentTypeAutoDetection(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion);\n \n     // Turn off the tests as there is service regression on the media type.\n     // Issue link: https://github.com/Azure/azure-sdk-for-java/issues/11036\n     // @Test\n     // abstract void recognizeReceiptDataTextDetails(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion);\n \n     @Test\n-    abstract void recognizeReceiptDataTextDetailsWithNullData(HttpClient httpClient,\n+    abstract void recognizeReceiptDataWithPngFile(HttpClient httpClient,\n         FormRecognizerServiceVersion serviceVersion);\n \n     @Test\n-    abstract void recognizeReceiptDataWithContentTypeAutoDetection(HttpClient httpClient,\n+    abstract void recognizeReceiptDataWithBlankPdf(HttpClient httpClient,\n         FormRecognizerServiceVersion serviceVersion);\n \n+    @Test\n+    abstract void recognizeReceiptFromDataMultiPage(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion);\n+\n+    // Receipt - URL\n+\n+    @Test\n+    abstract void recognizeReceiptSourceUrl(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion);\n+\n+    @Test\n+    abstract void recognizeReceiptInvalidSourceUrl(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion);\n+\n+    @Test\n+    abstract void recognizeReceiptSourceUrlTextDetails(HttpClient httpClient,", "originalCommit": "d24722074a1e4cbb8d3f43219e07a9f96ff7a02a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ba7bfaf1cd602c7f1752009cd5074a6362fbacb8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ba7bfaf1cd602c7f1752009cd5074a6362fbacb8", "message": "resolve conflict", "committedDate": "2020-06-24T04:23:57Z", "type": "commit"}, {"oid": "68e6f992363dfe4af6ad7740e4524d9f9e51b519", "url": "https://github.com/Azure/azure-sdk-for-java/commit/68e6f992363dfe4af6ad7740e4524d9f9e51b519", "message": "added training client tests", "committedDate": "2020-06-26T03:48:35Z", "type": "commit"}, {"oid": "cf7ed015d52389a567aeb1949a1bb12a2c1cdb35", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cf7ed015d52389a567aeb1949a1bb12a2c1cdb35", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into FR-TestCoverage", "committedDate": "2020-06-26T03:48:44Z", "type": "commit"}, {"oid": "99c8d57ce5aedbef36b1ad833b197bfb25826405", "url": "https://github.com/Azure/azure-sdk-for-java/commit/99c8d57ce5aedbef36b1ad833b197bfb25826405", "message": "address sameeksha's feedbacks", "committedDate": "2020-06-26T04:42:34Z", "type": "commit"}, {"oid": "1732307526903c46516af3347cf395cc5ed67db8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1732307526903c46516af3347cf395cc5ed67db8", "message": "checkstyle fixes", "committedDate": "2020-06-26T05:12:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk4NjQwNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445986406", "bodyText": "let's update all the includeTextDetails references to includeTextContent", "author": "samvaity", "createdAt": "2020-06-26T06:11:18Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -171,17 +208,66 @@ public void recognizeReceiptInvalidSourceUrl(HttpClient httpClient, FormRecogniz\n             () -> client.beginRecognizeReceiptsFromUrl(sourceUrl).getSyncPoller()));\n     }\n \n+    /**\n+     * Verifies receipt data for a document using source as file url and include content when includeTextDetails is\n+     * true.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeReceiptFromUrlTextContent(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        receiptSourceUrlRunnerTextDetails((sourceUrl, includeTextDetails) -> {\n+            SyncPoller<OperationResult, List<RecognizedReceipt>> syncPoller = client.beginRecognizeReceiptsFromUrl(\n+                new RecognizeOptions(sourceUrl).setIncludeTextContent(includeTextDetails)).getSyncPoller();\n+            syncPoller.waitForCompletion();\n+            validateReceiptResultData(syncPoller.getFinalResult(), includeTextDetails);\n+        });\n+    }\n+\n+    /**\n+     * Verifies receipt data for a document using source as PNG file url and include content when includeTextDetails is\n+     * true.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeReceiptSourceUrlWithPngFile(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        receiptPngSourceUrlRunnerTextDetails((sourceUrl, includeTextDetails) -> {", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk4NzAzNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445987035", "bodyText": "nit: this would by default be false so no need to set.", "author": "samvaity", "createdAt": "2020-06-26T06:13:19Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -241,73 +368,189 @@ public void recognizeContentInvalidSourceUrl(HttpClient httpClient, FormRecogniz\n             () -> client.beginRecognizeContentFromUrl(invalidSourceUrl).getSyncPoller()));\n     }\n \n-    /**\n-     * Verifies that an exception is thrown for invalid status model Id.\n-     */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n-    public void recognizeCustomFormInvalidSourceUrl(HttpClient httpClient,\n-        FormRecognizerServiceVersion serviceVersion) {\n+    public void recognizeContentFromUrlMultiPage(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n-            SyncPoller<OperationResult, CustomFormModel> syncPoller =\n-                getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n-                    useTrainingLabels).getSyncPoller();\n+        multipageFromUrlRunner((fileUrl) -> {\n+            SyncPoller<OperationResult, List<FormPage>> syncPoller =\n+                client.beginRecognizeContentFromUrl(fileUrl).getSyncPoller();\n             syncPoller.waitForCompletion();\n-            CustomFormModel createdModel = syncPoller.getFinalResult();\n-            StepVerifier.create(client.beginRecognizeCustomFormsFromUrl(INVALID_URL, createdModel.getModelId()))\n-                .verifyErrorSatisfies(throwable -> assertEquals(throwable.getMessage(), INVALID_SOURCE_URL_ERROR));\n+            validateContentResultData(syncPoller.getFinalResult(), false);\n         });\n     }\n \n+    // Custom form recognition\n+\n+    // Custom form - non-URL - labeled data\n+\n     /**\n      * Verifies custom form data for a document using source as input stream data and valid labeled model Id.\n      */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n     public void recognizeCustomFormLabeledData(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        customFormDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+        customFormDataRunner((data, dataLength) -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n             SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n                 getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n                     useTrainingLabels).getSyncPoller();\n             trainingPoller.waitForCompletion();\n \n             SyncPoller<OperationResult, List<RecognizedForm>> syncPoller =\n                 client.beginRecognizeCustomForms(new RecognizeCustomFormsOptions(toFluxByteBuffer(data),\n-                    CUSTOM_FORM_FILE_LENGTH, trainingPoller.getFinalResult().getModelId())\n+                    dataLength, trainingPoller.getFinalResult().getModelId())\n                     .setFormContentType(FormContentType.APPLICATION_PDF).setIncludeTextContent(true)).getSyncPoller();\n             syncPoller.waitForCompletion();\n             validateRecognizedResult(syncPoller.getFinalResult(), true, true);\n         }));\n     }\n \n     /**\n-     * Verifies an exception thrown for a document using null data value or null model id.\n+     * Verifies custom form data for a JPG content type with labeled data\n      */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n-    public void recognizeCustomFormLabeledDataWithNullValues(HttpClient httpClient,\n+    public void recognizeCustomFormLabeledDataWithJpgContentType(HttpClient httpClient,\n         FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        customFormDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n-            SyncPoller<OperationResult, CustomFormModel> syncPoller =\n+        customFormJpgDataRunner((data, dataLength) ->\n+            beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+                SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                    getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n+                        useTrainingLabels).getSyncPoller();\n+                trainingPoller.waitForCompletion();\n+\n+                SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                    new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n+                        trainingPoller.getFinalResult().getModelId()).setFormContentType(FormContentType.IMAGE_JPEG)\n+                        .setIncludeTextContent(false)).getSyncPoller();", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk4Nzk1Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445987953", "bodyText": "@maririos @kristapratico Wanted to confirm the exception we are throwing when an empty model Id is passed in respective languages", "author": "samvaity", "createdAt": "2020-06-26T06:16:14Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -241,73 +368,189 @@ public void recognizeContentInvalidSourceUrl(HttpClient httpClient, FormRecogniz\n             () -> client.beginRecognizeContentFromUrl(invalidSourceUrl).getSyncPoller()));\n     }\n \n-    /**\n-     * Verifies that an exception is thrown for invalid status model Id.\n-     */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n-    public void recognizeCustomFormInvalidSourceUrl(HttpClient httpClient,\n-        FormRecognizerServiceVersion serviceVersion) {\n+    public void recognizeContentFromUrlMultiPage(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n-            SyncPoller<OperationResult, CustomFormModel> syncPoller =\n-                getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n-                    useTrainingLabels).getSyncPoller();\n+        multipageFromUrlRunner((fileUrl) -> {\n+            SyncPoller<OperationResult, List<FormPage>> syncPoller =\n+                client.beginRecognizeContentFromUrl(fileUrl).getSyncPoller();\n             syncPoller.waitForCompletion();\n-            CustomFormModel createdModel = syncPoller.getFinalResult();\n-            StepVerifier.create(client.beginRecognizeCustomFormsFromUrl(INVALID_URL, createdModel.getModelId()))\n-                .verifyErrorSatisfies(throwable -> assertEquals(throwable.getMessage(), INVALID_SOURCE_URL_ERROR));\n+            validateContentResultData(syncPoller.getFinalResult(), false);\n         });\n     }\n \n+    // Custom form recognition\n+\n+    // Custom form - non-URL - labeled data\n+\n     /**\n      * Verifies custom form data for a document using source as input stream data and valid labeled model Id.\n      */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n     public void recognizeCustomFormLabeledData(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        customFormDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+        customFormDataRunner((data, dataLength) -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n             SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n                 getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n                     useTrainingLabels).getSyncPoller();\n             trainingPoller.waitForCompletion();\n \n             SyncPoller<OperationResult, List<RecognizedForm>> syncPoller =\n                 client.beginRecognizeCustomForms(new RecognizeCustomFormsOptions(toFluxByteBuffer(data),\n-                    CUSTOM_FORM_FILE_LENGTH, trainingPoller.getFinalResult().getModelId())\n+                    dataLength, trainingPoller.getFinalResult().getModelId())\n                     .setFormContentType(FormContentType.APPLICATION_PDF).setIncludeTextContent(true)).getSyncPoller();\n             syncPoller.waitForCompletion();\n             validateRecognizedResult(syncPoller.getFinalResult(), true, true);\n         }));\n     }\n \n     /**\n-     * Verifies an exception thrown for a document using null data value or null model id.\n+     * Verifies custom form data for a JPG content type with labeled data\n      */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n-    public void recognizeCustomFormLabeledDataWithNullValues(HttpClient httpClient,\n+    public void recognizeCustomFormLabeledDataWithJpgContentType(HttpClient httpClient,\n         FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        customFormDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n-            SyncPoller<OperationResult, CustomFormModel> syncPoller =\n+        customFormJpgDataRunner((data, dataLength) ->\n+            beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+                SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                    getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n+                        useTrainingLabels).getSyncPoller();\n+                trainingPoller.waitForCompletion();\n+\n+                SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                    new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n+                        trainingPoller.getFinalResult().getModelId()).setFormContentType(FormContentType.IMAGE_JPEG)\n+                        .setIncludeTextContent(false)).getSyncPoller();\n+                syncPoller.waitForCompletion();\n+                validateRecognizedResult(syncPoller.getFinalResult(), false, true);\n+            }));\n+    }\n+\n+    /**\n+     * Verifies custom form data for a blank PDF content type with labeled data\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormLabeledDataWithBlankPdfContentType(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        blankPdfDataRunner((data, dataLength) -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n                 getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n                     useTrainingLabels).getSyncPoller();\n+            trainingPoller.waitForCompletion();\n+\n+            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n+                    trainingPoller.getFinalResult().getModelId()).setFormContentType(FormContentType.APPLICATION_PDF)\n+                    .setIncludeTextContent(false)).getSyncPoller();\n             syncPoller.waitForCompletion();\n+            validateRecognizedResult(syncPoller.getFinalResult(), false, true);\n+        }));\n+    }\n \n-            assertThrows(RuntimeException.class, () -> client.beginRecognizeCustomForms(\n-                new RecognizeCustomFormsOptions((InputStream) null, CUSTOM_FORM_FILE_LENGTH,\n-                    syncPoller.getFinalResult().getModelId()).setFormContentType(FormContentType.APPLICATION_PDF)\n-                    .setIncludeTextContent(true)).getSyncPoller());\n+    /**\n+     * Verifies custom form data for a document using source as input stream data and valid labeled model Id,\n+     * excluding text content.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormLabeledDataExcludeTextContent(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormDataRunner((data, dataLength) -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n+                    useTrainingLabels).getSyncPoller();\n+            trainingPoller.waitForCompletion();\n+\n+            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n+                    trainingPoller.getFinalResult().getModelId()).setFormContentType(FormContentType.APPLICATION_PDF)\n+                    .setIncludeTextContent(false)).getSyncPoller();\n+            syncPoller.waitForCompletion();\n+            validateRecognizedResult(syncPoller.getFinalResult(), false, true);\n+        }));\n+    }\n+\n+    /**\n+     * Verifies an exception thrown for a document using null data value.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormLabeledDataWithNullFormData(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormDataRunner((data, dataLength) -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> syncPoller =\n+                getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n+                    useTrainingLabels).getSyncPoller();\n+            syncPoller.waitForCompletion();\n \n             assertThrows(RuntimeException.class, () -> client.beginRecognizeCustomForms(\n-                new RecognizeCustomFormsOptions(toFluxByteBuffer(data), CUSTOM_FORM_FILE_LENGTH,\n-                    null).setFormContentType(FormContentType.APPLICATION_PDF)\n-                    .setIncludeTextContent(true)).getSyncPoller());\n+                new RecognizeCustomFormsOptions((InputStream) null, dataLength,\n+                syncPoller.getFinalResult().getModelId()).setFormContentType(FormContentType.APPLICATION_PDF)\n+                .setIncludeTextContent(true)).getSyncPoller());\n         }));\n     }\n \n+    /**\n+     * Verifies an exception thrown for a document using null model id.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormLabeledDataWithNullModelId(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormDataRunner((data, dataLength) -> {\n+            Exception ex = assertThrows(RuntimeException.class, () -> client.beginRecognizeCustomForms(\n+                new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n+                    null).setFormContentType(FormContentType.APPLICATION_PDF).setIncludeTextContent(true))\n+                .getSyncPoller());\n+            assertEquals(EXPECTED_MODEL_ID_IS_REQUIRED_EXCEPTION_MESSAGE, ex.getMessage());\n+        });\n+    }\n+\n+    /**\n+     * Verifies an exception thrown for an empty model id when recognizing custom form from URL.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormLabeledDataWithEmptyModelId(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormDataRunner((data, dataLength) -> {\n+            Exception ex = assertThrows(RuntimeException.class, () -> client.beginRecognizeCustomForms(\n+                new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength, \"\")\n+                    .setFormContentType(FormContentType.APPLICATION_PDF).setIncludeTextContent(true)).getSyncPoller());\n+            assertEquals(EXPECTED_INVALID_UUID_EXCEPTION_MESSAGE, ex.getMessage());", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI2ODQ1MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r446268450", "bodyText": "For .NET, if modelId is null we throw ArgumentNullException if it is empty, we throw ArgumentException.", "author": "maririos", "createdAt": "2020-06-26T15:54:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk4Nzk1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI3MDA0NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r446270044", "bodyText": "For Python, this is a built-in exception - ValueError", "author": "kristapratico", "createdAt": "2020-06-26T15:57:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk4Nzk1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk4ODExNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445988115", "bodyText": "This should be default if you don't set?", "author": "samvaity", "createdAt": "2020-06-26T06:16:50Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -317,145 +560,346 @@ public void recognizeCustomFormLabeledDataWithNullValues(HttpClient httpClient,\n     public void recognizeCustomFormLabeledDataWithContentTypeAutoDetection(HttpClient httpClient,\n         FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        customFormDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+        customFormDataRunner((data, dataLength) -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n             SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n                 getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n                     useTrainingLabels).getSyncPoller();\n             trainingPoller.waitForCompletion();\n \n-            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller =\n-                client.beginRecognizeCustomForms(new RecognizeCustomFormsOptions(getReplayableBufferData(FORM_LOCAL_URL),\n-                    CUSTOM_FORM_FILE_LENGTH, trainingPoller.getFinalResult().getModelId()).setFormContentType(null)\n-                    .setIncludeTextContent(true)).getSyncPoller();\n+            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                new RecognizeCustomFormsOptions(getReplayableBufferData(FORM_LOCAL_URL), dataLength,\n+                    trainingPoller.getFinalResult().getModelId())\n+                    .setFormContentType(null).setIncludeTextContent(true)).getSyncPoller();", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk4ODUyNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445988526", "bodyText": "same here, don't need to set it to false. Would be false by default.", "author": "samvaity", "createdAt": "2020-06-26T06:18:09Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -317,145 +560,346 @@ public void recognizeCustomFormLabeledDataWithNullValues(HttpClient httpClient,\n     public void recognizeCustomFormLabeledDataWithContentTypeAutoDetection(HttpClient httpClient,\n         FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        customFormDataRunner(data -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+        customFormDataRunner((data, dataLength) -> beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n             SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n                 getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n                     useTrainingLabels).getSyncPoller();\n             trainingPoller.waitForCompletion();\n \n-            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller =\n-                client.beginRecognizeCustomForms(new RecognizeCustomFormsOptions(getReplayableBufferData(FORM_LOCAL_URL),\n-                    CUSTOM_FORM_FILE_LENGTH, trainingPoller.getFinalResult().getModelId()).setFormContentType(null)\n-                    .setIncludeTextContent(true)).getSyncPoller();\n+            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                new RecognizeCustomFormsOptions(getReplayableBufferData(FORM_LOCAL_URL), dataLength,\n+                    trainingPoller.getFinalResult().getModelId())\n+                    .setFormContentType(null).setIncludeTextContent(true)).getSyncPoller();\n             syncPoller.waitForCompletion();\n             validateRecognizedResult(syncPoller.getFinalResult(), true, true);\n         }));\n     }\n \n+    /**\n+     * Verify custom form for a data stream of multi-page labeled data\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormMultiPageLabeled(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        multipageFromDataRunner((data, dataLength) -> beginTrainingMultipageRunner((trainingFilesUrl) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                getFormTrainingAsyncClient(httpClient, serviceVersion)\n+                    .beginTraining(trainingFilesUrl, true).getSyncPoller();\n+            trainingPoller.waitForCompletion();\n+\n+            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n+                    trainingPoller.getFinalResult().getModelId()).setFormContentType(FormContentType.APPLICATION_PDF))\n+                .getSyncPoller();\n+            syncPoller.waitForCompletion();\n+            validateMultiPageDataLabeled(syncPoller.getFinalResult());\n+        }));\n+    }\n+\n+    // Custom form - non-URL - unlabeled data\n+\n     /**\n      * Verifies custom form data for a document using source as input stream data and valid labeled model Id.\n      */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n     public void recognizeCustomFormUnlabeledData(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        customFormDataRunner(data -> beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+        customFormDataRunner((data, dataLength) ->\n+            beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+                SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                    getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n+                        useTrainingLabels).getSyncPoller();\n+                trainingPoller.waitForCompletion();\n+\n+                SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                    new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n+                        trainingPoller.getFinalResult().getModelId())\n+                        .setFormContentType(FormContentType.APPLICATION_PDF)\n+                        .setIncludeTextContent(false)).getSyncPoller();\n+                syncPoller.waitForCompletion();\n+                validateRecognizedResult(syncPoller.getFinalResult(), false, false);\n+            }));\n+    }\n+\n+    /**\n+     * Verifies custom form data for a document using source as input stream data and valid include text content\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormUnlabeledDataIncludeTextContent(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormDataRunner((data, dataLength) ->\n+            beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+                SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                    getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n+                        useTrainingLabels).getSyncPoller();\n+                trainingPoller.waitForCompletion();\n+\n+                SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                    new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n+                        trainingPoller.getFinalResult().getModelId())\n+                        .setFormContentType(FormContentType.APPLICATION_PDF)\n+                        .setIncludeTextContent(true)).getSyncPoller();\n+                syncPoller.waitForCompletion();\n+                validateRecognizedResult(syncPoller.getFinalResult(), true, false);\n+            }));\n+    }\n+\n+    /**\n+     * Verify custom form for a data stream of multi-page unlabeled data\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormMultiPageUnlabeled(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        multipageFromDataRunner((data, dataLength) -> beginTrainingMultipageRunner((trainingFilesUrl) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                getFormTrainingAsyncClient(httpClient, serviceVersion)\n+                    .beginTraining(trainingFilesUrl, false).getSyncPoller();\n+            trainingPoller.waitForCompletion();\n+\n+            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                toFluxByteBuffer(data), dataLength, trainingPoller.getFinalResult().getModelId(),\n+                FormContentType.APPLICATION_PDF).getSyncPoller();\n+            syncPoller.waitForCompletion();\n+            validateMultiPageDataUnlabeled(syncPoller.getFinalResult());\n+        }));\n+    }\n+\n+    /**\n+     * Verifies custom form data for a JPG content type with unlabeled data\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormUnlabeledDataWithJpgContentType(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        customFormJpgDataRunner((data, dataLength) ->\n+            beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+                SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                    getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n+                        useTrainingLabels).getSyncPoller();\n+                trainingPoller.waitForCompletion();\n+\n+                SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                    new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n+                        trainingPoller.getFinalResult().getModelId()).setFormContentType(FormContentType.IMAGE_JPEG)\n+                        .setIncludeTextContent(false)).getSyncPoller();\n+                syncPoller.waitForCompletion();\n+                validateRecognizedResult(syncPoller.getFinalResult(), false, false);\n+            }));\n+    }\n+\n+    /**\n+     * Verifies custom form data for a blank PDF content type with unlabeled data\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeCustomFormUnlabeledDataWithBlankPdfContentType(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n+        blankPdfDataRunner((data, dataLength) -> beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n             SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n                 getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n                     useTrainingLabels).getSyncPoller();\n             trainingPoller.waitForCompletion();\n \n-            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller =\n-                client.beginRecognizeCustomForms(new RecognizeCustomFormsOptions(toFluxByteBuffer(data), CUSTOM_FORM_FILE_LENGTH,\n+            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                new RecognizeCustomFormsOptions(toFluxByteBuffer(data), dataLength,\n                     trainingPoller.getFinalResult().getModelId()).setFormContentType(FormContentType.APPLICATION_PDF)\n                     .setIncludeTextContent(false)).getSyncPoller();\n             syncPoller.waitForCompletion();\n             validateRecognizedResult(syncPoller.getFinalResult(), false, false);\n         }));\n     }\n \n+    // Custom form - URL - unlabeled data\n+\n+    /**\n+     * Verifies custom form data for an URL document data without labeled data\n+     */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n-    public void recognizeCustomFormMultiPageUnlabeled(HttpClient httpClient,\n+    public void recognizeCustomFormUrlUnlabeledData(HttpClient httpClient,\n         FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerAsyncClient(httpClient, serviceVersion);\n-        multipageFromDataRunner(data -> beginTrainingMultipageRunner((trainingFilesUrl) -> {\n+\n+        urlDataRunner(fileUrl -> beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n             SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n-                getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl, false).getSyncPoller();\n+                getFormTrainingAsyncClient(httpClient, serviceVersion).beginTraining(trainingFilesUrl,\n+                    useTrainingLabels).getSyncPoller();\n             trainingPoller.waitForCompletion();\n \n-            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller =\n-                client.beginRecognizeCustomForms(toFluxByteBuffer(data), MULTIPAGE_INVOICE_FILE_LENGTH, trainingPoller.getFinalResult().getModelId(),\n-                        FormContentType.APPLICATION_PDF).getSyncPoller();\n+            SyncPoller<OperationResult, List<RecognizedForm>> syncPoller = client.beginRecognizeCustomForms(\n+                new RecognizeCustomFormsOptions(fileUrl, trainingPoller.getFinalResult().getModelId())\n+                    .setIncludeTextContent(false)).getSyncPoller();", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk4OTUyMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445989522", "bodyText": "Can you uncomment this, I think I missed updating this when I updated the FormRcognizerAsyncClientTests file?", "author": "samvaity", "createdAt": "2020-06-26T06:21:33Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerClientTest.java", "diffHunk": "@@ -51,109 +54,205 @@ private FormTrainingClient getFormTrainingClient(HttpClient httpClient,\n         return getFormTrainingClientBuilder(httpClient, serviceVersion).buildClient();\n     }\n \n+    // Receipt recognition\n+\n+    // Receipt - non-URL\n+\n     /**\n-     * Verifies receipt data for a document using source as file url.\n+     * Verifies receipt data for a document using source as input stream data.\n      */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n-    public void recognizeReceiptSourceUrl(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+    public void recognizeReceiptData(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerClient(httpClient, serviceVersion);\n-        receiptSourceUrlRunner((sourceUrl) -> {\n+        receiptDataRunner((data, dataLength) -> {\n             SyncPoller<OperationResult, List<RecognizedReceipt>> syncPoller =\n-                client.beginRecognizeReceiptsFromUrl(sourceUrl);\n+                client.beginRecognizeReceipts(data, dataLength, FormContentType.IMAGE_JPEG);\n             syncPoller.waitForCompletion();\n             validateReceiptResultData(syncPoller.getFinalResult(), false);\n         });\n     }\n \n     /**\n-     * Verifies receipt data for a document using source as file url and include content when includeTextContent is\n-     * true.\n+     * Verifies an exception thrown for a document using null data value.\n      */\n     @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n     @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n-    public void recognizeReceiptSourceUrlTextDetails(HttpClient httpClient,\n+    public void recognizeReceiptDataNullData(HttpClient httpClient,\n         FormRecognizerServiceVersion serviceVersion) {\n         client = getFormRecognizerClient(httpClient, serviceVersion);\n-        receiptSourceUrlRunnerTextDetails((sourceUrl, includeTextContent) -> {\n+        assertThrows(RuntimeException.class, () ->\n+            client.beginRecognizeReceipts(null, RECEIPT_FILE_LENGTH, FormContentType.IMAGE_JPEG));\n+    }\n+\n+    /**\n+     * Verifies content type will be auto detected when using receipt API with input stream data overload.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void recognizeReceiptDataWithContentTypeAutoDetection(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormRecognizerClient(httpClient, serviceVersion);\n+        SyncPoller<OperationResult, List<RecognizedReceipt>> syncPoller =\n+            client.beginRecognizeReceipts(getContentDetectionFileData(RECEIPT_LOCAL_URL), RECEIPT_FILE_LENGTH,\n+                null);\n+        syncPoller.waitForCompletion();\n+        validateReceiptResultData(syncPoller.getFinalResult(), false);\n+    }\n+\n+    /**\n+     * Verifies receipt data for a document using source as as input stream data and text content when\n+     * includeTextDetails is true.\n+     */\n+    // Turn off the tests as there is service regression on the media type.", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5MTU2Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445991567", "bodyText": "Names seems to be misleading. Is this a urlRunner or a dataRunner?", "author": "samvaity", "createdAt": "2020-06-26T06:27:54Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerClientTestBase.java", "diffHunk": "@@ -481,11 +623,35 @@ void contentFromUrlRunner(Consumer<String> testRunner) {\n         testRunner.accept(getStorageTestingFileUrl(FORM_JPG));\n     }\n \n-    void customFormDataRunner(Consumer<InputStream> testRunner) {\n+    void pdfContentFromUrlRunner(Consumer<String> testRunner) {\n+        testRunner.accept(getStorageTestingFileUrl(INVOICE_1_PDF));\n+    }\n+\n+    void customFormDataRunner(BiConsumer<InputStream, Long> testRunner) {\n+        if (interceptorManager.isPlaybackMode()) {\n+            testRunner.accept(new ByteArrayInputStream(\"testData.png\".getBytes()), CUSTOM_FORM_FILE_LENGTH);\n+        } else {\n+            testRunner.accept(getFileData(getStorageTestingFileUrl(INVOICE_PDF)), CUSTOM_FORM_FILE_LENGTH);\n+        }\n+    }\n+\n+    void customFormJpgDataRunner(BiConsumer<InputStream, Long> testRunner) {\n+        if (interceptorManager.isPlaybackMode()) {\n+            testRunner.accept(new ByteArrayInputStream(\"testData.png\".getBytes()), FORM_1_JPG_FILE_LENGTH);\n+        } else {\n+            testRunner.accept(getFileData(getStorageTestingFileUrl(FORM_JPG)), FORM_1_JPG_FILE_LENGTH);\n+        }\n+    }\n+\n+    void urlDataRunner(Consumer<String> testRunner, String formData) {", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU5NjAzMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r446596030", "bodyText": "urlRunner", "author": "mssfang", "createdAt": "2020-06-28T03:46:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5MTU2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5MTk1Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445991952", "bodyText": "validateBlankPdfResultData() is this method is only specific to Receipt result lets update it to validateBlankReceiptResult() ?", "author": "samvaity", "createdAt": "2020-06-26T06:29:03Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormTrainingAsyncClientTest.java", "diffHunk": "@@ -54,6 +61,25 @@ private FormTrainingAsyncClient getFormTrainingAsyncClient(HttpClient httpClient\n         return getFormTrainingClientBuilder(httpClient, serviceVersion).buildAsyncClient();\n     }\n \n+    /**\n+     * Verifies the form recognizer async client is valid.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    void getFormRecognizerClientAndValidate(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+        FormRecognizerAsyncClient formRecognizerClient = getFormTrainingAsyncClient(httpClient, serviceVersion)\n+            .getFormRecognizerAsyncClient();\n+        blankPdfDataRunner(data -> {\n+            SyncPoller<OperationResult, List<RecognizedReceipt>> syncPoller =\n+                formRecognizerClient.beginRecognizeReceipts(\n+                    new RecognizeOptions(toFluxByteBuffer(data), BLANK_FORM_FILE_LENGTH)\n+                        .setFormContentType(FormContentType.APPLICATION_PDF).setIncludeTextContent(false))\n+                    .getSyncPoller();\n+            syncPoller.waitForCompletion();\n+            validateBlankPdfResultData(syncPoller.getFinalResult());", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU5NjM4NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r446596384", "bodyText": "Receipt and Custom both have the Blank PDF test. So I think we should be restricted to Receipt", "author": "mssfang", "createdAt": "2020-06-28T03:51:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5MTk1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5MjM0MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445992341", "bodyText": "Is this just a rename change?", "author": "samvaity", "createdAt": "2020-06-26T06:30:18Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormTrainingAsyncClientTest.java", "diffHunk": "@@ -357,4 +353,103 @@ public void beginTrainingInvalidModelStatus(HttpClient httpClient, FormRecognize\n             assertTrue(formRecognizerException.getMessage().contains(EXPECTED_INVALID_STATUS_EXCEPTION_MESSAGE));\n         });\n     }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid labeled model Id and JPG training set Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithTrainingLabelsForJPGTrainingSet(HttpClient httpClient,", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5NzgyNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r446297825", "bodyText": "Yes. A rename change", "author": "mssfang", "createdAt": "2020-06-26T16:50:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5MjM0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5Mjc4Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445992787", "bodyText": ".setPrefix(SUBFOLDER) -> .setPrefix(PREFIX_SUBFOLDER) ?", "author": "samvaity", "createdAt": "2020-06-26T06:31:21Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormTrainingAsyncClientTest.java", "diffHunk": "@@ -357,4 +353,103 @@ public void beginTrainingInvalidModelStatus(HttpClient httpClient, FormRecognize\n             assertTrue(formRecognizerException.getMessage().contains(EXPECTED_INVALID_STATUS_EXCEPTION_MESSAGE));\n         });\n     }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid labeled model Id and JPG training set Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithTrainingLabelsForJPGTrainingSet(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingAsyncClient(httpClient, serviceVersion);\n+        beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                client.beginTraining(trainingFilesUrl, useTrainingLabels).getSyncPoller();\n+            trainingPoller.waitForCompletion();\n+            validateCustomModelData(trainingPoller.getFinalResult(), true);\n+        });\n+    }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid unlabeled model Id and JPG training set Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithoutTrainingLabelsForJPGTrainingSet(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingAsyncClient(httpClient, serviceVersion);\n+        beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                client.beginTraining(trainingFilesUrl, useTrainingLabels).getSyncPoller();\n+            trainingPoller.waitForCompletion();\n+            validateCustomModelData(trainingPoller.getFinalResult(), false);\n+        });\n+    }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid labeled model Id and multi-page PDF training set Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithTrainingLabelsForMultiPagePDFTrainingSet(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingAsyncClient(httpClient, serviceVersion);\n+        beginTrainingMultipageRunner(trainingFilesUrl -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                client.beginTraining(trainingFilesUrl, true).getSyncPoller();\n+            trainingPoller.waitForCompletion();\n+            validateCustomModelData(trainingPoller.getFinalResult(), true);\n+        });\n+    }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid unlabeled model Id and multi-page PDF training set Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithoutTrainingLabelsForMultiPagePDFTrainingSet(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingAsyncClient(httpClient, serviceVersion);\n+        beginTrainingMultipageRunner(trainingFilesUrl -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                client.beginTraining(trainingFilesUrl, false).getSyncPoller();\n+            trainingPoller.waitForCompletion();\n+            validateCustomModelData(trainingPoller.getFinalResult(), false);\n+        });\n+    }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid labeled model Id and include subfolder training set\n+     * Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithoutTrainingLabelsIncludeSubfolder(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingAsyncClient(httpClient, serviceVersion);\n+        beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller = client.beginTraining(trainingFilesUrl,\n+                useTrainingLabels, new TrainingFileFilter().setIncludeSubFolders(true).setPrefix(SUBFOLDER), null).getSyncPoller();", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5MzQyOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445993428", "bodyText": "not  sure, if the test name is clear.", "author": "samvaity", "createdAt": "2020-06-26T06:33:26Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormTrainingClientBuilderTest.java", "diffHunk": "@@ -84,6 +89,37 @@ public void trainingClientBuilderDefaultPipeline(HttpClient httpClient, FormReco\n             assertNotNull(clientBuilder.buildClient().getFormRecognizerClient().beginRecognizeContentFromUrl(input).getFinalResult()));\n     }\n \n+    /**\n+     * Test for invalid endpoint.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void trainingClientBuilderInvalidEndpoint(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+        clientBuilderWithDefaultPipelineRunner(httpClient, serviceVersion, clientBuilder -> (input) -> {\n+            Exception exception =  assertThrows(RuntimeException.class, () ->\n+                clientBuilder.endpoint(INVALID_ENDPOINT).buildClient().getFormRecognizerClient()\n+                    .beginRecognizeContentFromUrl(input).getFinalResult());\n+            // \"Max retries 3 times exceeded. Error Details: Connection refused: no further information:\n+            // notreal.azure.com/23.217.138.110:443\"\n+            // Recording mode has Error Details: null\n+            assertTrue(exception.getMessage().contains(\"Max retries 3 times exceeded. Error Details:\"));\n+        });\n+    }\n+\n+    /**\n+     * Test for http endpoint, which throws HTTPS requirement exception message.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void trainingClientBuilderHttpEndpoint(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njc1NTE0Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r446755146", "bodyText": "this test renamed to httpsProtocolRequiredException and moved to TrainingClientBuilderUniteTest", "author": "mssfang", "createdAt": "2020-06-29T03:41:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5MzQyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5Mzc4MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445993781", "bodyText": "Is there a separate test for when only the prefix is set?", "author": "samvaity", "createdAt": "2020-06-26T06:34:31Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormTrainingClientTest.java", "diffHunk": "@@ -332,4 +326,103 @@ public void beginTrainingInvalidModelStatus(HttpClient httpClient, FormRecognize\n             assertTrue(formRecognizerException.getMessage().contains(EXPECTED_INVALID_STATUS_EXCEPTION_MESSAGE));\n         });\n     }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid labeled model Id and JPG training set Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithTrainingLabelsForJPGTrainingSet(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingClient(httpClient, serviceVersion);\n+        beginTrainingLabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                client.beginTraining(trainingFilesUrl, useTrainingLabels);\n+            trainingPoller.waitForCompletion();\n+            validateCustomModelData(trainingPoller.getFinalResult(), true);\n+        });\n+    }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid unlabeled model Id and JPG training set Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithoutTrainingLabelsForJPGTrainingSet(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingClient(httpClient, serviceVersion);\n+        beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                client.beginTraining(trainingFilesUrl, useTrainingLabels);\n+            trainingPoller.waitForCompletion();\n+            validateCustomModelData(trainingPoller.getFinalResult(), false);\n+        });\n+    }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid labeled model Id and multi-page PDF training set Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithTrainingLabelsForMultiPagePDFTrainingSet(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingClient(httpClient, serviceVersion);\n+        beginTrainingMultipageRunner(trainingFilesUrl -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                client.beginTraining(trainingFilesUrl, true);\n+            trainingPoller.waitForCompletion();\n+            validateCustomModelData(trainingPoller.getFinalResult(), true);\n+        });\n+    }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid unlabeled model Id and multi-page PDF training set Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithoutTrainingLabelsForMultiPagePDFTrainingSet(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingClient(httpClient, serviceVersion);\n+        beginTrainingMultipageRunner(trainingFilesUrl -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller =\n+                client.beginTraining(trainingFilesUrl, false);\n+            trainingPoller.waitForCompletion();\n+            validateCustomModelData(trainingPoller.getFinalResult(), false);\n+        });\n+    }\n+\n+    /**\n+     * Verifies the result of the training operation for a valid labeled model Id and include subfolder training set\n+     * Url.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void beginTrainingWithoutTrainingLabelsIncludeSubfolder(HttpClient httpClient,\n+        FormRecognizerServiceVersion serviceVersion) {\n+        client = getFormTrainingClient(httpClient, serviceVersion);\n+        beginTrainingUnlabeledRunner((trainingFilesUrl, useTrainingLabels) -> {\n+            SyncPoller<OperationResult, CustomFormModel> trainingPoller = client.beginTraining(trainingFilesUrl,\n+                useTrainingLabels, new TrainingFileFilter().setIncludeSubFolders(true).setPrefix(SUBFOLDER), null);", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjcwOTA5NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r446709095", "bodyText": "added", "author": "mssfang", "createdAt": "2020-06-28T22:59:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5Mzc4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5NjAyOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r445996028", "bodyText": "Are you covering this as part of a different PR?\nUpdate to use default  5 seconds polling only in Live mode?", "author": "samvaity", "createdAt": "2020-06-26T06:40:53Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerClientBuilderTest.java", "diffHunk": "@@ -81,6 +85,33 @@ public void clientBuilderWithDefaultPipeline(HttpClient httpClient, FormRecogniz\n             assertNotNull(clientBuilder.buildClient().beginRecognizeContentFromUrl(input).getFinalResult()));\n     }\n \n+    /**\n+     * Test for invalid endpoint, which throws connection refused exception message.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void clientBuilderWithInvalidEndpoint(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {", "originalCommit": "1732307526903c46516af3347cf395cc5ed67db8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODU1MjIyOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r448552229", "bodyText": "yes. covered in this PR. Speed up to around 3mins now", "author": "mssfang", "createdAt": "2020-07-01T18:46:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5NjAyOA=="}], "type": "inlineReview"}, {"oid": "f6b096499e8fa19c0fa5eeb9d7d0517475b4a83e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f6b096499e8fa19c0fa5eeb9d7d0517475b4a83e", "message": "address feedbacks", "committedDate": "2020-06-29T00:56:36Z", "type": "commit"}, {"oid": "921b3047891e1ac566ee6c372e04bfb324916f9f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/921b3047891e1ac566ee6c372e04bfb324916f9f", "message": "resolve conflict", "committedDate": "2020-06-29T18:17:39Z", "type": "commit"}, {"oid": "cd6a3fb40d3c3f1d609cd3d4b5693ebdbff77af0", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cd6a3fb40d3c3f1d609cd3d4b5693ebdbff77af0", "message": "speed up playback mode", "committedDate": "2020-06-30T05:23:18Z", "type": "commit"}, {"oid": "56aac2b602d15e4a4cd8a52b4e833c19276f1c66", "url": "https://github.com/Azure/azure-sdk-for-java/commit/56aac2b602d15e4a4cd8a52b4e833c19276f1c66", "message": "resolve conflict", "committedDate": "2020-07-01T04:26:25Z", "type": "commit"}, {"oid": "371fcb8f4632ac21870495a6204e29aefe6d8e09", "url": "https://github.com/Azure/azure-sdk-for-java/commit/371fcb8f4632ac21870495a6204e29aefe6d8e09", "message": "test and sample spotbugs", "committedDate": "2020-07-01T05:46:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODU1MzQ5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r448553494", "bodyText": "Is the comment still true??", "author": "samvaity", "createdAt": "2020-07-01T18:48:45Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormTrainingClientBuilderTest.java", "diffHunk": "@@ -84,6 +86,23 @@ public void trainingClientBuilderDefaultPipeline(HttpClient httpClient, FormReco\n             assertNotNull(clientBuilder.buildClient().getFormRecognizerClient().beginRecognizeContentFromUrl(input).getFinalResult()));\n     }\n \n+    /**\n+     * Test for invalid endpoint.\n+     */\n+    @ParameterizedTest(name = DISPLAY_NAME_WITH_ARGUMENTS)\n+    @MethodSource(\"com.azure.ai.formrecognizer.TestUtils#getTestParameters\")\n+    public void trainingClientBuilderInvalidEndpoint(HttpClient httpClient, FormRecognizerServiceVersion serviceVersion) {\n+        clientBuilderWithDefaultPipelineRunner(httpClient, serviceVersion, clientBuilder -> (input) -> {\n+            Exception exception =  assertThrows(RuntimeException.class, () ->\n+                clientBuilder.endpoint(INVALID_ENDPOINT).buildClient().getFormRecognizerClient()\n+                    .beginRecognizeContentFromUrl(input).getFinalResult());\n+            // RECORD mode has \"Max retries 3 times exceeded. Error Details: Connection refused: no further information:", "originalCommit": "371fcb8f4632ac21870495a6204e29aefe6d8e09", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODU1NDc3Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12400#discussion_r448554777", "bodyText": "Yes", "author": "mssfang", "createdAt": "2020-07-01T18:51:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODU1MzQ5NA=="}], "type": "inlineReview"}]}