{"pr_number": 7904, "pr_title": "fixed Mono -> Flux -> Mono back and forth conversion", "pr_createdAt": "2020-02-03T01:09:47Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/7904", "timeline": [{"oid": "4e271ae14e0ae0b952910442b6353a25b1bb48e6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4e271ae14e0ae0b952910442b6353a25b1bb48e6", "message": "fixed Mono -> Flux -> Mono back and forth conversion", "committedDate": "2020-02-03T01:03:15Z", "type": "commit"}, {"oid": "9a231fa7a51a0be83361d265b960a5a8e5d19034", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9a231fa7a51a0be83361d265b960a5a8e5d19034", "message": "fixed a test", "committedDate": "2020-02-03T03:34:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMxNDE1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7904#discussion_r374314158", "bodyText": "We don't need this .single() anymore, right ?\nHere and every other method in this class.", "author": "kushagraThapar", "createdAt": "2020-02-03T20:07:52Z", "path": "sdk/cosmos/azure-cosmos-examples/src/main/java/com/azure/cosmos/rx/examples/multimaster/Helpers.java", "diffHunk": "@@ -38,7 +38,7 @@ static public String createDatabaseUri(String databaseName) {\n                                 }\n                             }\n \n-                            return Flux.error(e);\n+                            return Mono.error(e);\n                         }\n                 ).map(ResourceResponse::getResource).single();", "originalCommit": "9a231fa7a51a0be83361d265b960a5a8e5d19034", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQxMzUwNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7904#discussion_r374413505", "bodyText": "as discussed offline. they are intentionally kept as they will do correctness validation to ensure Mono is not empty.", "author": "moderakh", "createdAt": "2020-02-04T00:14:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMxNDE1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMxNDczNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7904#discussion_r374314736", "bodyText": "Same here, unnecessary conversion to .single()", "author": "kushagraThapar", "createdAt": "2020-02-03T20:09:06Z", "path": "sdk/cosmos/azure-cosmos-examples/src/test/java/com/azure/cosmos/rx/examples/CollectionCRUDAsyncAPITest.java", "diffHunk": "@@ -242,7 +243,7 @@ public void createCollection_toBlocking_CollectionAlreadyExists_Fails() {\n      */\n     @Test(groups = \"samples\", timeOut = TIMEOUT)\n     public void transformObservableToCompletableFuture() throws Exception {\n-        Flux<ResourceResponse<DocumentCollection>> createCollectionObservable = client\n+        Mono<ResourceResponse<DocumentCollection>> createCollectionObservable = client\n                 .createCollection(getDatabaseLink(), collectionDefinition, null);\n         CompletableFuture<ResourceResponse<DocumentCollection>> future = createCollectionObservable.single().toFuture();", "originalCommit": "9a231fa7a51a0be83361d265b960a5a8e5d19034", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMxNjk1MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7904#discussion_r374316951", "bodyText": "Please remove unnecessary .single()", "author": "kushagraThapar", "createdAt": "2020-02-03T20:13:39Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/caches/RxClientCollectionCache.java", "diffHunk": "@@ -94,7 +94,7 @@ public RxClientCollectionCache(ISessionContainer sessionContainer,\n             retryPolicyInstance.onBeforeSendRequest(request);\n         }\n \n-        Flux<RxDocumentServiceResponse> responseObs = this.storeModel.processMessage(request);\n+        Mono<RxDocumentServiceResponse> responseObs = this.storeModel.processMessage(request);\n         return responseObs.map(response -> BridgeInternal.toResourceResponse(response, DocumentCollection.class)\n                 .getResource()).single();", "originalCommit": "9a231fa7a51a0be83361d265b960a5a8e5d19034", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQxMzU0Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7904#discussion_r374413542", "bodyText": "as discussed offline. they are intentionally kept as they will do correctness validation to ensure Mono is not empty.", "author": "moderakh", "createdAt": "2020-02-04T00:14:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMxNjk1MQ=="}], "type": "inlineReview"}, {"oid": "85771a2457d5a25bf7860c29950f4beb7bedd631", "url": "https://github.com/Azure/azure-sdk-for-java/commit/85771a2457d5a25bf7860c29950f4beb7bedd631", "message": "Merge branch 'feature/cosmos/v4' into users/moderakh/flux-mono-conversion", "committedDate": "2020-02-04T07:21:59Z", "type": "commit"}]}