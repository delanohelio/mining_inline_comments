{"pr_number": 4353, "pr_title": "WIP: Dynamical navigation drawer size", "pr_createdAt": "2020-08-07T12:37:25Z", "pr_url": "https://github.com/AntennaPod/AntennaPod/pull/4353", "timeline": [{"oid": "db35ec9507c9e478e1f8159cd3e5db263e74a084", "url": "https://github.com/AntennaPod/AntennaPod/commit/db35ec9507c9e478e1f8159cd3e5db263e74a084", "message": "Add basic resize functionality", "committedDate": "2020-08-03T10:56:49Z", "type": "commit"}, {"oid": "509b695b008b0e478c1b8d25edb039bc90998d15", "url": "https://github.com/AntennaPod/AntennaPod/commit/509b695b008b0e478c1b8d25edb039bc90998d15", "message": "resize navigation drawer dynamically", "committedDate": "2020-08-06T16:22:37Z", "type": "commit"}, {"oid": "1e9417168e3415afe014c6a7755590f03eb740f7", "url": "https://github.com/AntennaPod/AntennaPod/commit/1e9417168e3415afe014c6a7755590f03eb740f7", "message": "Revert \"Add basic resize functionality\"\n\nThis reverts commit db35ec95", "committedDate": "2020-08-07T12:33:06Z", "type": "commit"}, {"oid": "e0609f5658da950b580d96304a4be6d4913a66a5", "url": "https://github.com/AntennaPod/AntennaPod/commit/e0609f5658da950b580d96304a4be6d4913a66a5", "message": "Add a maxwidth to nav drawer size", "committedDate": "2020-08-07T12:54:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2MzQzNw==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4353#discussion_r467463437", "bodyText": "You can store this in R.dimens to prevent having to convert between dp and px.", "author": "ByteHamster", "createdAt": "2020-08-08T13:08:12Z", "path": "app/src/main/java/de/danoeh/antennapod/activity/MainActivity.java", "diffHunk": "@@ -323,6 +327,34 @@ public void onConfigurationChanged(Configuration newConfig) {\n         if (drawerToggle != null) { // Tablet layout does not have a drawer\n             drawerToggle.onConfigurationChanged(newConfig);\n         }\n+        setNavDrawerSize();\n+    }\n+\n+    private void setNavDrawerSize() {\n+        float screenPercent = getResources().getInteger(R.integer.nav_drawer_screen_size_percent) * 0.01f;\n+        int width = (int) (getScreenWidth() * screenPercent);\n+        int maxWidth = (int) dpInPx(getResources().getInteger(R.integer.nav_drawer_max_screen_size_dp));", "originalCommit": "e0609f5658da950b580d96304a4be6d4913a66a5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2MzQ4Mg==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4353#discussion_r467463482", "bodyText": "Android Lint does not like manual min calculation. Something like Math.min() would be more clear.", "author": "ByteHamster", "createdAt": "2020-08-08T13:08:52Z", "path": "app/src/main/java/de/danoeh/antennapod/activity/MainActivity.java", "diffHunk": "@@ -323,6 +327,34 @@ public void onConfigurationChanged(Configuration newConfig) {\n         if (drawerToggle != null) { // Tablet layout does not have a drawer\n             drawerToggle.onConfigurationChanged(newConfig);\n         }\n+        setNavDrawerSize();\n+    }\n+\n+    private void setNavDrawerSize() {\n+        float screenPercent = getResources().getInteger(R.integer.nav_drawer_screen_size_percent) * 0.01f;\n+        int width = (int) (getScreenWidth() * screenPercent);\n+        int maxWidth = (int) dpInPx(getResources().getInteger(R.integer.nav_drawer_max_screen_size_dp));\n+\n+        if (width > maxWidth) {\n+            width = maxWidth;", "originalCommit": "e0609f5658da950b580d96304a4be6d4913a66a5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "660c6d2795ee624c61c809169c0c58a8c99d7c3d", "url": "https://github.com/AntennaPod/AntennaPod/commit/660c6d2795ee624c61c809169c0c58a8c99d7c3d", "message": "add is tablet check", "committedDate": "2020-08-08T14:04:53Z", "type": "commit"}, {"oid": "1a5627dd23ebd4e1e59433ffefa126b5dd62f215", "url": "https://github.com/AntennaPod/AntennaPod/commit/1a5627dd23ebd4e1e59433ffefa126b5dd62f215", "message": "add if braces", "committedDate": "2020-08-08T14:08:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2OTQ1OQ==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4353#discussion_r467469459", "bodyText": "It would be more reliable to check if drawerToggle == null to detect if we are using the tablet layout.", "author": "ByteHamster", "createdAt": "2020-08-08T14:19:03Z", "path": "app/src/main/java/de/danoeh/antennapod/activity/MainActivity.java", "diffHunk": "@@ -323,6 +327,30 @@ public void onConfigurationChanged(Configuration newConfig) {\n         if (drawerToggle != null) { // Tablet layout does not have a drawer\n             drawerToggle.onConfigurationChanged(newConfig);\n         }\n+        setNavDrawerSize();\n+    }\n+\n+    private void setNavDrawerSize() {\n+        if (isTablet()) {\n+            return;\n+        }\n+        float screenPercent = getResources().getInteger(R.integer.nav_drawer_screen_size_percent) * 0.01f;\n+        int width = (int) (getScreenWidth() * screenPercent);\n+        int maxWidth = (int) getResources().getDimension(R.dimen.nav_drawer_max_screen_size);\n+\n+        navDrawer.getLayoutParams().width = Math.min(width, maxWidth);\n+    }\n+\n+    private int getScreenWidth() {\n+        DisplayMetrics displayMetrics = new DisplayMetrics();\n+        getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);\n+        return displayMetrics.widthPixels;\n+    }\n+\n+    private boolean isTablet() {\n+        return (getResources().getConfiguration().screenLayout\n+                & Configuration.SCREENLAYOUT_SIZE_MASK)\n+                >= Configuration.SCREENLAYOUT_SIZE_LARGE;", "originalCommit": "1a5627dd23ebd4e1e59433ffefa126b5dd62f215", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b22f740273fbcdacba39b96568ad759bc2f21dc4", "url": "https://github.com/AntennaPod/AntennaPod/commit/b22f740273fbcdacba39b96568ad759bc2f21dc4", "message": "change tablet check to drawerToggle", "committedDate": "2020-08-08T14:24:27Z", "type": "commit"}]}