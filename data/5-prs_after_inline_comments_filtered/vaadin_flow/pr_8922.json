{"pr_number": 8922, "pr_title": "Add HasHelper interface", "pr_createdAt": "2020-08-31T09:35:53Z", "pr_url": "https://github.com/vaadin/flow/pull/8922", "timeline": [{"oid": "978c29a8ddbc1dab11579a26f890e6c3ba57fb7f", "url": "https://github.com/vaadin/flow/commit/978c29a8ddbc1dab11579a26f890e6c3ba57fb7f", "message": "Add HasHelper interface (#8532)", "committedDate": "2020-08-31T09:15:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDAyMjU0NQ==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r480022545", "bodyText": "Empty @since tag please", "author": "pleku", "createdAt": "2020-08-31T09:58:42Z", "path": "flow-server/src/main/java/com/vaadin/flow/component/HasHelper.java", "diffHunk": "@@ -0,0 +1,95 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component;\n+\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+\n+import com.vaadin.flow.dom.Element;\n+\n+/**\n+ * Mixin interface for field components that have helper text as property and\n+ * slots for inserting components.\n+ *\n+ * @author Vaadin Ltd", "originalCommit": "978c29a8ddbc1dab11579a26f890e6c3ba57fb7f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE0NzU2Ng==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r481147566", "bodyText": "Added.I wasn't sure which version to add, since it's for 2.4, but it won't be in 3.0.", "author": "DiegoCardoso", "createdAt": "2020-09-01T13:43:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDAyMjU0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTcyOTU2Mg==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r481729562", "bodyText": "That is why we prefer to just add the tags as empty @since - those can be then later on fixed at any point", "author": "pleku", "createdAt": "2020-09-02T05:35:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDAyMjU0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4MDAwMw==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r480080003", "bodyText": "One might wonder, \"what is helper text\" as it is not that universal concept (yet?) compared to e.g. placeholder. At least could be unfamiliar for Java developers. So I think it would be good to add a clarification on \"how/when it might be shown on the component\"", "author": "pleku", "createdAt": "2020-08-31T11:54:39Z", "path": "flow-server/src/main/java/com/vaadin/flow/component/HasHelper.java", "diffHunk": "@@ -0,0 +1,95 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component;\n+\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+\n+import com.vaadin.flow.dom.Element;\n+\n+/**\n+ * Mixin interface for field components that have helper text as property and\n+ * slots for inserting components.\n+ *\n+ * @author Vaadin Ltd\n+ */\n+public interface HasHelper extends HasElement {\n+  /**\n+   * String used for the helper text.\n+   *\n+   * @return the {@code helperText} property from the web component\n+   */\n+  default String getHelperText() {\n+    return getElement().getProperty(\"helperText\");\n+  }\n+\n+  /**\n+   * <p>\n+   * String used for the helper text.", "originalCommit": "978c29a8ddbc1dab11579a26f890e6c3ba57fb7f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4MDEwNw==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r480080107", "bodyText": "And same for setHelperComponent", "author": "pleku", "createdAt": "2020-08-31T11:54:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4MDAwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1Mjg2NA==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r481152864", "bodyText": "Added text describing the feature more for both setters.", "author": "DiegoCardoso", "createdAt": "2020-09-01T13:51:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4MDAwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4OTIwNg==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r480089206", "bodyText": "Unnecessary collecting to a list since it seems like there can only ever be one child with the slot=helper, so could go with findAny().ifPresent(...) instead", "author": "pleku", "createdAt": "2020-08-31T12:14:25Z", "path": "flow-server/src/main/java/com/vaadin/flow/component/HasHelper.java", "diffHunk": "@@ -0,0 +1,95 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component;\n+\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+\n+import com.vaadin.flow.dom.Element;\n+\n+/**\n+ * Mixin interface for field components that have helper text as property and\n+ * slots for inserting components.\n+ *\n+ * @author Vaadin Ltd\n+ */\n+public interface HasHelper extends HasElement {\n+  /**\n+   * String used for the helper text.\n+   *\n+   * @return the {@code helperText} property from the web component\n+   */\n+  default String getHelperText() {\n+    return getElement().getProperty(\"helperText\");\n+  }\n+\n+  /**\n+   * <p>\n+   * String used for the helper text.\n+   * </p>\n+   * \n+   * <p>\n+   * In case both {@link #setHelperText(String)} and\n+   * {@link #setHelperComponent(Component)} are used, only the element defined\n+   * by {@link #setHelperComponent(Component)} will be visible, regardless of\n+   * the order on which they are defined.\n+   * </p>\n+   *\n+   * @param helperText\n+   *            the String value to set\n+   */\n+  default void setHelperText(String helperText) {\n+    getElement().setProperty(\"helperText\", helperText);\n+  }\n+  /**\n+   * Adds the given component into helper slot of component, replacing any\n+   * existing helper component.\n+   * \n+   * @param component\n+   *            the component to set, can be {@code null} to remove existing\n+   *            helper component\n+   * \n+   * @see #setHelperText(String)\n+   */\n+  default void setHelperComponent(Component component) {\n+    getElement().getChildren()\n+      .filter(child -> \"helper\".equals(child.getAttribute(\"slot\")))\n+      .collect(Collectors.toList())", "originalCommit": "978c29a8ddbc1dab11579a26f890e6c3ba57fb7f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE0OTI3NA==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r481149274", "bodyText": "Changed.", "author": "DiegoCardoso", "createdAt": "2020-09-01T13:45:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4OTIwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA5NTQ4NA==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r480095484", "bodyText": "I don't think this is necessary for readability as it adds more lines, could just use mapping to the Stream with map(Element::get) before findFirst() and then return component.orElse(null);.", "author": "pleku", "createdAt": "2020-08-31T12:26:45Z", "path": "flow-server/src/main/java/com/vaadin/flow/component/HasHelper.java", "diffHunk": "@@ -0,0 +1,95 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component;\n+\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+\n+import com.vaadin.flow.dom.Element;\n+\n+/**\n+ * Mixin interface for field components that have helper text as property and\n+ * slots for inserting components.\n+ *\n+ * @author Vaadin Ltd\n+ */\n+public interface HasHelper extends HasElement {\n+  /**\n+   * String used for the helper text.\n+   *\n+   * @return the {@code helperText} property from the web component\n+   */\n+  default String getHelperText() {\n+    return getElement().getProperty(\"helperText\");\n+  }\n+\n+  /**\n+   * <p>\n+   * String used for the helper text.\n+   * </p>\n+   * \n+   * <p>\n+   * In case both {@link #setHelperText(String)} and\n+   * {@link #setHelperComponent(Component)} are used, only the element defined\n+   * by {@link #setHelperComponent(Component)} will be visible, regardless of\n+   * the order on which they are defined.\n+   * </p>\n+   *\n+   * @param helperText\n+   *            the String value to set\n+   */\n+  default void setHelperText(String helperText) {\n+    getElement().setProperty(\"helperText\", helperText);\n+  }\n+  /**\n+   * Adds the given component into helper slot of component, replacing any\n+   * existing helper component.\n+   * \n+   * @param component\n+   *            the component to set, can be {@code null} to remove existing\n+   *            helper component\n+   * \n+   * @see #setHelperText(String)\n+   */\n+  default void setHelperComponent(Component component) {\n+    getElement().getChildren()\n+      .filter(child -> \"helper\".equals(child.getAttribute(\"slot\")))\n+      .collect(Collectors.toList())\n+      .forEach(getElement()::removeChild);\n+\n+    if (component != null) {\n+        component.getElement().setAttribute(\"slot\", \"helper\");\n+        getElement().appendChild(component.getElement());\n+    }\n+  }\n+\n+  /**\n+   * Gets the component in the helper slot of this field.\n+   * \n+   * @return the helper component of this field, or {@code null} if no helper\n+   *         component has been set\n+   * @see #setHelperComponent(Component)\n+   */\n+  default Component getHelperComponent() {\n+    Optional<Element> element = getElement().getChildren()\n+      .filter(child -> \"helper\".equals(child.getAttribute(\"slot\")))\n+      .findFirst();\n+    if (element.isPresent()) {", "originalCommit": "978c29a8ddbc1dab11579a26f890e6c3ba57fb7f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE0OTk1NA==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r481149954", "bodyText": "I changed as suggested, but then findFirst() returns an Optional<Optional<Component>> object, so I had to add a .orElse(Optional.empty()).", "author": "DiegoCardoso", "createdAt": "2020-09-01T13:46:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA5NTQ4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA5NjYyMg==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r480096622", "bodyText": "Slightly nit-picking, but could validate the default values too so that those are not accidentally changed", "author": "pleku", "createdAt": "2020-08-31T12:28:45Z", "path": "flow-server/src/test/java/com/vaadin/flow/component/HasHelperTest.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+public class HasHelperTest {\n+\n+    @Tag(\"div\")\n+    public static class HasHelperComponent extends Component implements HasHelper {\n+    }\n+", "originalCommit": "978c29a8ddbc1dab11579a26f890e6c3ba57fb7f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1MDE0MQ==", "url": "https://github.com/vaadin/flow/pull/8922#discussion_r481150141", "bodyText": "Added.", "author": "DiegoCardoso", "createdAt": "2020-09-01T13:47:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA5NjYyMg=="}], "type": "inlineReview"}, {"oid": "641e0403cc22a9da0f55c612aa529a9000f88ad8", "url": "https://github.com/vaadin/flow/commit/641e0403cc22a9da0f55c612aa529a9000f88ad8", "message": "test: add tests for default values", "committedDate": "2020-09-01T13:34:01Z", "type": "commit"}, {"oid": "f3bfbcf40fa4025dc924e17aad18d07ed248a76b", "url": "https://github.com/vaadin/flow/commit/f3bfbcf40fa4025dc924e17aad18d07ed248a76b", "message": "refactor: adjust code as suggested by reviewer", "committedDate": "2020-09-01T13:42:58Z", "type": "commit"}, {"oid": "203a27b39720df29a350800ffbe79b176f1f4652", "url": "https://github.com/vaadin/flow/commit/203a27b39720df29a350800ffbe79b176f1f4652", "message": "doc: add more details for HasHelper#setHelperComponent", "committedDate": "2020-09-01T13:49:50Z", "type": "commit"}, {"oid": "2b28f88eb4d67ec3ba7d96df639bbe9d2123c585", "url": "https://github.com/vaadin/flow/commit/2b28f88eb4d67ec3ba7d96df639bbe9d2123c585", "message": "refactor: remove unused import", "committedDate": "2020-09-01T14:29:00Z", "type": "commit"}]}