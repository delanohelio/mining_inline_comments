{"pr_number": 9502, "pr_title": "fix: reconnect dialog settings to vaadin-connection-indicator", "pr_createdAt": "2020-11-26T07:52:39Z", "pr_url": "https://github.com/vaadin/flow/pull/9502", "timeline": [{"oid": "deeb53d7a9867a88d0514b97405efc4be786a35a", "url": "https://github.com/vaadin/flow/commit/deeb53d7a9867a88d0514b97405efc4be786a35a", "message": "fix: reconnect dialog settings via Java API to vaadin-connection-indicator", "committedDate": "2020-11-26T08:23:11Z", "type": "commit"}, {"oid": "9a1510fd97d8e79e27ea474cfa41f57fa5bb3668", "url": "https://github.com/vaadin/flow/commit/9a1510fd97d8e79e27ea474cfa41f57fa5bb3668", "message": "chore: removed reconnect-dialog modality and grace time properties.\n\nReplaces server-side methods with deprecated no-ops.", "committedDate": "2020-11-26T11:37:08Z", "type": "commit"}, {"oid": "fba1a52369a894f7d46a1a3be6da954a216f71c5", "url": "https://github.com/vaadin/flow/commit/fba1a52369a894f7d46a1a3be6da954a216f71c5", "message": "chore: ITs", "committedDate": "2020-11-26T11:38:05Z", "type": "commit"}, {"oid": "fba1a52369a894f7d46a1a3be6da954a216f71c5", "url": "https://github.com/vaadin/flow/commit/fba1a52369a894f7d46a1a3be6da954a216f71c5", "message": "chore: ITs", "committedDate": "2020-11-26T11:38:05Z", "type": "forcePushed"}, {"oid": "7c7be593ab66023ce6a00f04fe255b6ed7711d4b", "url": "https://github.com/vaadin/flow/commit/7c7be593ab66023ce6a00f04fe255b6ed7711d4b", "message": "chore: remove outdated test", "committedDate": "2020-11-26T12:36:08Z", "type": "commit"}, {"oid": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "url": "https://github.com/vaadin/flow/commit/86025aad8fb2f65368cc9f2809bf6c5b52f54586", "message": "chore: updated test", "committedDate": "2020-11-26T13:09:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2OTk0OA==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531069948", "bodyText": "Do not forget to remove this deprecated code someday.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:36Z", "path": "flow-client/src/main/java/com/vaadin/client/communication/ReconnectConfiguration.java", "diffHunk": "@@ -95,12 +85,14 @@ public String getDialogText() {\n      *\n      * @return the text to show in the reconnect dialog when no longer trying to\n      *         reconnect\n+     *\n+     * @deprecated The API for configuring the connection indicator has changed.\n      */\n+    @Deprecated\n     public String getDialogTextGaveUp() {", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2OTk1OA==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531069958", "bodyText": "Do not forget to remove this deprecated code someday.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:37Z", "path": "flow-client/src/main/java/com/vaadin/client/communication/ReconnectConfiguration.java", "diffHunk": "@@ -66,27 +66,17 @@ private MapProperty getProperty(String key) {\n         return configurationMap.getProperty(key);\n     }\n \n-    /**\n-     * Checks whether the reconnect dialog should be modal, i.e. prevent\n-     * application usage while being shown.\n-     *\n-     * @return true if the dialog is modal, false otherwise\n-     */\n-    public boolean isDialogModal() {\n-        return getProperty(ReconnectDialogConfigurationMap.DIALOG_MODAL_KEY)\n-                .getValueOrDefault(\n-                        ReconnectDialogConfigurationMap.DIALOG_MODAL_DEFAULT);\n-    }\n-\n     /**\n      * Gets the text to show in the reconnect dialog.\n      *\n      * @return the text to show in the reconnect dialog.\n+     *\n+     * @deprecated The API for configuring the connection indicator has changed.\n      */\n+    @Deprecated\n     public String getDialogText() {", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2OTk2NQ==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531069965", "bodyText": "Remove this use of \"getDialogTextGaveUp\"; it is deprecated.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:38Z", "path": "flow-client/src/main/java/com/vaadin/client/communication/DefaultConnectionStateHandler.java", "diffHunk": "@@ -312,10 +312,18 @@ protected String getDialogText(int reconnectAttempt) {\n     @Override\n     public void configurationUpdated() {\n         // All other properties are fetched directly from the state when needed\n+        if (getConfiguration().getDialogText() != null) {\n+            ConnectionIndicator.setProperty(\"reconnectingText\",\n+                    getConfiguration().getDialogText());\n+        }\n+        if (getConfiguration().getDialogTextGaveUp() != null) {\n+        ConnectionIndicator.setProperty(\"offlineText\",\n+                getConfiguration().getDialogTextGaveUp());", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2OTk3MQ==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531069971", "bodyText": "Remove this use of \"getDialogText\"; it is deprecated.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:39Z", "path": "flow-client/src/main/java/com/vaadin/client/communication/DefaultConnectionStateHandler.java", "diffHunk": "@@ -312,10 +312,18 @@ protected String getDialogText(int reconnectAttempt) {\n     @Override\n     public void configurationUpdated() {\n         // All other properties are fetched directly from the state when needed\n+        if (getConfiguration().getDialogText() != null) {", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2OTk4Mg==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531069982", "bodyText": "Remove this use of \"getDialogText\"; it is deprecated.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:40Z", "path": "flow-client/src/main/java/com/vaadin/client/communication/DefaultConnectionStateHandler.java", "diffHunk": "@@ -312,10 +312,18 @@ protected String getDialogText(int reconnectAttempt) {\n     @Override\n     public void configurationUpdated() {\n         // All other properties are fetched directly from the state when needed\n+        if (getConfiguration().getDialogText() != null) {\n+            ConnectionIndicator.setProperty(\"reconnectingText\",\n+                    getConfiguration().getDialogText());", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2OTk5Mg==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531069992", "bodyText": "Remove this use of \"getDialogTextGaveUp\"; it is deprecated.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:41Z", "path": "flow-client/src/main/java/com/vaadin/client/communication/DefaultConnectionStateHandler.java", "diffHunk": "@@ -312,10 +312,18 @@ protected String getDialogText(int reconnectAttempt) {\n     @Override\n     public void configurationUpdated() {\n         // All other properties are fetched directly from the state when needed\n+        if (getConfiguration().getDialogText() != null) {\n+            ConnectionIndicator.setProperty(\"reconnectingText\",\n+                    getConfiguration().getDialogText());\n+        }\n+        if (getConfiguration().getDialogTextGaveUp() != null) {", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA3MDAwMw==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531070003", "bodyText": "Do not forget to remove this deprecated code someday.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:42Z", "path": "flow-server/src/main/java/com/vaadin/flow/component/ReconnectDialogConfiguration.java", "diffHunk": "@@ -135,17 +141,23 @@\n      *\n      * @param dialogModal\n      *            true to make the dialog modal, false otherwise\n+     *\n+     * @deprecated this method is a no-op. The connection indicator is now never\n+     *             modal. This method will be removed in Vaadin 20.\n      */\n+    @Deprecated\n     void setDialogModal(boolean dialogModal);\n \n     /**\n      * Checks the modality of the dialog.\n      * <p>\n-     * The default is\n-     * {@value ReconnectDialogConfigurationMap#DIALOG_MODAL_DEFAULT}\n      *\n      * @see #setDialogModal(boolean)\n      * @return true if the dialog is modal, false otherwise\n+     *\n+     * @deprecated this method is a no-op. The connection indicator is now never\n+     *             modal.\n      */\n+    @Deprecated\n     boolean isDialogModal();", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA3MDAxMA==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531070010", "bodyText": "Do not forget to remove this deprecated code someday.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:42Z", "path": "flow-server/src/main/java/com/vaadin/flow/component/ReconnectDialogConfiguration.java", "diffHunk": "@@ -122,7 +124,11 @@\n      *\n      * @param dialogGracePeriod\n      *            the time to wait before showing a dialog\n+     *\n+     * @deprecated this method is a no-op. The connection indicator no longer\n+     *             has a grace period.\n      */\n+    @Deprecated\n     void setDialogGracePeriod(int dialogGracePeriod);", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA3MDAxNg==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531070016", "bodyText": "Do not forget to remove this deprecated code someday.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:43Z", "path": "flow-server/src/main/java/com/vaadin/flow/component/ReconnectDialogConfiguration.java", "diffHunk": "@@ -135,17 +141,23 @@\n      *\n      * @param dialogModal\n      *            true to make the dialog modal, false otherwise\n+     *\n+     * @deprecated this method is a no-op. The connection indicator is now never\n+     *             modal. This method will be removed in Vaadin 20.\n      */\n+    @Deprecated\n     void setDialogModal(boolean dialogModal);", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA3MDAyNQ==", "url": "https://github.com/vaadin/flow/pull/9502#discussion_r531070025", "bodyText": "Do not forget to remove this deprecated code someday.", "author": "vaadin-bot", "createdAt": "2020-11-26T14:35:44Z", "path": "flow-server/src/main/java/com/vaadin/flow/component/ReconnectDialogConfiguration.java", "diffHunk": "@@ -109,11 +109,13 @@\n      * Gets the timeout (in milliseconds) between noticing a loss of connection\n      * and showing the dialog.\n      * <p>\n-     * The default is\n-     * {@value ReconnectDialogConfigurationMap#DIALOG_GRACE_PERIOD_DEFAULT}\n      *\n      * @return the time to wait before showing a dialog\n+     *\n+     * @deprecated this method is a no-op. The connection indicator has\n+     * changed, and there is no longer a grace period.\n      */\n+    @Deprecated\n     int getDialogGracePeriod();", "originalCommit": "86025aad8fb2f65368cc9f2809bf6c5b52f54586", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}