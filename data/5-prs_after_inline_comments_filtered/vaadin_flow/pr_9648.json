{"pr_number": 9648, "pr_title": "Feat: enable having a parent theme", "pr_createdAt": "2020-12-14T13:37:44Z", "pr_url": "https://github.com/vaadin/flow/pull/9648", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQwODc4OA==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r542408788", "bodyText": "How about a third test that css from the parent theme can be overwritten by the child? (e.g. having Lumo as parent and customizing a specific color)\nEdit: Looks like there is a typo in test above as well; you probably mean 'Margin from theme should be applied.'", "author": "knoobie", "createdAt": "2020-12-14T14:05:32Z", "path": "flow-tests/test-themes/src/test/java/com/vaadin/flow/uitest/ui/theme/ThemeIT.java", "diffHunk": "@@ -105,6 +105,22 @@ public void applicationTheme_importCSS_isUsed() {\n                 driver.getPageSource().contains(\"HTTP ERROR 404 Not Found\"));\n     }\n \n+    @Test\n+    public void parentTheme_isApplied() {\n+        open();\n+        checkLogsForErrors();\n+\n+        Assert.assertEquals(\n+            \"Color from parent theme should be applied.\",\n+            \"rgba(0, 255, 255, 1)\", $(SpanElement.class).id(FONTAWESOME_ID)\n+                .getCssValue(\"color\"));\n+\n+        Assert.assertEquals(\n+            \"Color from parent theme should be applied.\",\n+            \"5px\", $(SpanElement.class).id(FONTAWESOME_ID)\n+                .getCssValue(\"margin\"));\n+", "originalCommit": "6f807f1191a81584f0302616789c82d4e329c69b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA3MTMzNg==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r543071336", "bodyText": "Yes I noted also that I forgot to change the message. But this will wait for the reusable theme test to be done first and I will need to move the functionality test to another module at that point.", "author": "caalador", "createdAt": "2020-12-15T06:06:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQwODc4OA=="}], "type": "inlineReview"}, {"oid": "80b5e6be7a98024dd4fb1be8609051e773900430", "url": "https://github.com/vaadin/flow/commit/80b5e6be7a98024dd4fb1be8609051e773900430", "message": "Feat: enable having a parent theme\n\nIt is now possible to extend a parent application\ntheme. This means adding the key \"parent\" with\nthe value of the target theme and then this will\nbe used with the current theme.\n\nFixes #9587", "committedDate": "2020-12-18T13:01:11Z", "type": "commit"}, {"oid": "80b5e6be7a98024dd4fb1be8609051e773900430", "url": "https://github.com/vaadin/flow/commit/80b5e6be7a98024dd4fb1be8609051e773900430", "message": "Feat: enable having a parent theme\n\nIt is now possible to extend a parent application\ntheme. This means adding the key \"parent\" with\nthe value of the target theme and then this will\nbe used with the current theme.\n\nFixes #9587", "committedDate": "2020-12-18T13:01:11Z", "type": "forcePushed"}, {"oid": "5a2d361d38da37c8fb3ba959404524124bf26d8f", "url": "https://github.com/vaadin/flow/commit/5a2d361d38da37c8fb3ba959404524124bf26d8f", "message": "Add test for parent theme child overrides.\n\nAdd test for using reusable theme as parent theme.", "committedDate": "2020-12-21T10:26:45Z", "type": "commit"}, {"oid": "e7b8ed9ff279039e4d4e86ef07e319a090850cff", "url": "https://github.com/vaadin/flow/commit/e7b8ed9ff279039e4d4e86ef07e319a090850cff", "message": "Merge branch 'master' into issues/9587_parent_theme", "committedDate": "2020-12-21T11:33:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE1Nzg2NA==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547157864", "bodyText": "Nit: this is not background ...", "author": "pleku", "createdAt": "2020-12-22T09:11:56Z", "path": "flow-tests/test-application-theme/test-reusable-as-parent/src/test/java/com/vaadin/flow/uitest/ui/theme/ParentThemeIT.java", "diffHunk": "@@ -0,0 +1,84 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.uitest.ui.theme;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.openqa.selenium.By;\n+import org.openqa.selenium.JavascriptExecutor;\n+import org.openqa.selenium.WebElement;\n+\n+import com.vaadin.flow.component.html.testbench.ImageElement;\n+import com.vaadin.flow.component.html.testbench.SpanElement;\n+import com.vaadin.flow.testutil.ChromeBrowserTest;\n+import com.vaadin.testbench.TestBenchElement;\n+\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.BUTTERFLY_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.FONTAWESOME_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.MY_POLYMER_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.SNOWFLAKE_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.OCTOPUSS_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.SUB_COMPONENT_ID;\n+\n+public class ParentThemeIT extends ChromeBrowserTest {\n+\n+    @Test\n+    public void childTheme_overridesParentTheme() {\n+        open();\n+        // No exception for bg-image should exist\n+        checkLogsForErrors();\n+\n+        final WebElement body = findElement(By.tagName(\"body\"));\n+        // Note themes/reusable-theme gets VAADIN/static from the file-loader\n+        Assert.assertEquals(\n+            \"url(\\\"\" + getRootURL() + \"/VAADIN/static/themes/child-theme/bg.jpg\\\")\",\n+            body.getCssValue(\"background-image\"));\n+\n+        Assert.assertEquals(\"\\\"IBM Plex Mono\\\"\", body.getCssValue(\"font-family\"));\n+\n+        Assert.assertEquals(\"Child should override parent external.\",\n+            \"url(\\\"\" + getRootURL()\n+                + \"/VAADIN/static/themes/child-theme/img/gobo.png\\\")\",\n+            $(SpanElement.class).id(BUTTERFLY_ID)\n+                .getCssValue(\"background-image\"));\n+\n+        Assert.assertEquals(\"Child img selector should be used\",\n+            \"url(\\\"\" + getRootURL() + \"/VAADIN/static/themes/child-theme/img/viking.png\\\")\",\n+            $(SpanElement.class).id(OCTOPUSS_ID)\n+                .getCssValue(\"background-image\"));\n+    }\n+\n+    @Test\n+    public void componentThemeIsApplied_childThemeTextColorIsApplied() {\n+        open();\n+        TestBenchElement myField = $(TestBenchElement.class).id(MY_POLYMER_ID);\n+        TestBenchElement input = myField.$(TestBenchElement.class)\n+            .id(\"vaadin-text-field-input-0\");\n+        Assert.assertEquals(\"Polymer text field should have red background\",\n+            \"rgba(255, 0, 0, 1)\", input.getCssValue(\"background-color\"));\n+\n+        Assert.assertEquals(\"Polymer text field should have red background\",", "originalCommit": "e7b8ed9ff279039e4d4e86ef07e319a090850cff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE3ODI5OQ==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547178299", "bodyText": "CopyPaste do something else problem. fixed", "author": "caalador", "createdAt": "2020-12-22T09:52:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE1Nzg2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MTYzNA==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547161634", "bodyText": "Is this really ParentThemeIT as it is mostly testing overriding parent theme things ? At least individual test names appear so... maybe the parts that check that something from the parent theme is still applied could be moved inside one test, I think there is not many checks for that, maybe two ?", "author": "pleku", "createdAt": "2020-12-22T09:19:16Z", "path": "flow-tests/test-application-theme/test-reusable-as-parent/src/test/java/com/vaadin/flow/uitest/ui/theme/ParentThemeIT.java", "diffHunk": "@@ -0,0 +1,84 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.uitest.ui.theme;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.openqa.selenium.By;\n+import org.openqa.selenium.JavascriptExecutor;\n+import org.openqa.selenium.WebElement;\n+\n+import com.vaadin.flow.component.html.testbench.ImageElement;\n+import com.vaadin.flow.component.html.testbench.SpanElement;\n+import com.vaadin.flow.testutil.ChromeBrowserTest;\n+import com.vaadin.testbench.TestBenchElement;\n+\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.BUTTERFLY_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.FONTAWESOME_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.MY_POLYMER_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.SNOWFLAKE_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.OCTOPUSS_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.SUB_COMPONENT_ID;\n+\n+public class ParentThemeIT extends ChromeBrowserTest {", "originalCommit": "e7b8ed9ff279039e4d4e86ef07e319a090850cff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE4MDM5MA==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547180390", "bodyText": "Well as this is for testing the reusable theme as parent most parent theme specifics are already tested there. This is testing the reusable theme as parent so I feel the important is here to be able to override parent parts as the reusable is fully tested in another module.", "author": "caalador", "createdAt": "2020-12-22T09:56:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MTYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzIxOTkxNw==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547219917", "bodyText": "Yeah, but my point was that to me this is mostly about \"Overriding Parent Theme\".", "author": "pleku", "createdAt": "2020-12-22T11:17:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MTYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzIyMDU3NQ==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547220575", "bodyText": "CustomiseParentThemeIT?", "author": "caalador", "createdAt": "2020-12-22T11:19:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MTYzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MjI2Mg==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547162262", "bodyText": "Is this actually valid comment ? As the path is for child-theme", "author": "pleku", "createdAt": "2020-12-22T09:20:33Z", "path": "flow-tests/test-application-theme/test-reusable-as-parent/src/test/java/com/vaadin/flow/uitest/ui/theme/ParentThemeIT.java", "diffHunk": "@@ -0,0 +1,84 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.uitest.ui.theme;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.openqa.selenium.By;\n+import org.openqa.selenium.JavascriptExecutor;\n+import org.openqa.selenium.WebElement;\n+\n+import com.vaadin.flow.component.html.testbench.ImageElement;\n+import com.vaadin.flow.component.html.testbench.SpanElement;\n+import com.vaadin.flow.testutil.ChromeBrowserTest;\n+import com.vaadin.testbench.TestBenchElement;\n+\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.BUTTERFLY_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.FONTAWESOME_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.MY_POLYMER_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.SNOWFLAKE_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.OCTOPUSS_ID;\n+import static com.vaadin.flow.uitest.ui.theme.ParentThemeView.SUB_COMPONENT_ID;\n+\n+public class ParentThemeIT extends ChromeBrowserTest {\n+\n+    @Test\n+    public void childTheme_overridesParentTheme() {\n+        open();\n+        // No exception for bg-image should exist\n+        checkLogsForErrors();\n+\n+        final WebElement body = findElement(By.tagName(\"body\"));\n+        // Note themes/reusable-theme gets VAADIN/static from the file-loader", "originalCommit": "e7b8ed9ff279039e4d4e86ef07e319a090850cff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE3NzMyMQ==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547177321", "bodyText": "Unecessay note. removed", "author": "caalador", "createdAt": "2020-12-22T09:50:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MjI2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MjQyNQ==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547162425", "bodyText": "This has nothing to do with border radius", "author": "pleku", "createdAt": "2020-12-22T09:20:56Z", "path": "flow-tests/test-themes/src/test/java/com/vaadin/flow/uitest/ui/theme/ThemeIT.java", "diffHunk": "@@ -105,6 +105,36 @@ public void applicationTheme_importCSS_isUsed() {\n                 driver.getPageSource().contains(\"HTTP ERROR 404 Not Found\"));\n     }\n \n+    @Test\n+    public void parentTheme_isApplied() {\n+        open();\n+        checkLogsForErrors();\n+\n+        Assert.assertEquals(\n+            \"Color from parent theme should be applied.\",\n+            \"rgba(0, 255, 255, 1)\", $(SpanElement.class).id(FONTAWESOME_ID)\n+                .getCssValue(\"color\"));\n+\n+        Assert.assertEquals(\n+            \"Child theme should override parent theme values\",\n+            \"5px\", $(SpanElement.class).id(FONTAWESOME_ID)\n+                .getCssValue(\"margin\"));\n+\n+        Assert.assertEquals(\n+            \"Child theme values should be applied\",\n+            \"5px\", $(SpanElement.class).id(FONTAWESOME_ID)\n+                .getCssValue(\"padding\"));\n+\n+        TestBenchElement myField = $(TestBenchElement.class).id(MY_POLYMER_ID);\n+        TestBenchElement input = myField.$(TestBenchElement.class)\n+            .id(\"vaadin-text-field-input-0\");\n+        Assert.assertEquals(\"Polymer text field should get parent border radius\",\n+            \"0px\", input.getCssValue(\"border-radius\"));\n+\n+        Assert.assertEquals(\"Polymer text field should get parent border radius\",", "originalCommit": "e7b8ed9ff279039e4d4e86ef07e319a090850cff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE3OTg5MA==", "url": "https://github.com/vaadin/flow/pull/9648#discussion_r547179890", "bodyText": "CP. fixed", "author": "caalador", "createdAt": "2020-12-22T09:55:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MjQyNQ=="}], "type": "inlineReview"}, {"oid": "8e03f86dd1c25ef6eb52e5a2be4cce6e478e24e0", "url": "https://github.com/vaadin/flow/commit/8e03f86dd1c25ef6eb52e5a2be4cce6e478e24e0", "message": "Update css to use rgba colors.\n\nFix assert messages.", "committedDate": "2020-12-22T09:58:23Z", "type": "commit"}]}