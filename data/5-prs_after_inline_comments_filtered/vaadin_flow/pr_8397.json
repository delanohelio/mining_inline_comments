{"pr_number": 8397, "pr_title": "Add target constants for Anchor to use with alternate setTarget method (#8346)", "pr_createdAt": "2020-05-20T17:42:55Z", "pr_url": "https://github.com/vaadin/flow/pull/8397", "timeline": [{"oid": "27b9420efb43c85b2b2233459f5c2d88270ca279", "url": "https://github.com/vaadin/flow/commit/27b9420efb43c85b2b2233459f5c2d88270ca279", "message": "Add target constants for Anchor to use with alternate setTarget method", "committedDate": "2020-06-27T22:59:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM1NzgzNw==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r499357837", "bodyText": "I would rename this API to setTarget and have it as overloaded method name. This is what we have done in other places too. The getter can then have the more specific name.", "author": "pleku", "createdAt": "2020-10-05T05:52:15Z", "path": "flow-html-components/src/main/java/com/vaadin/flow/component/html/Anchor.java", "diffHunk": "@@ -183,4 +205,47 @@ public void setTarget(String target) {\n         return get(targetDescriptor);\n     }\n \n+    /**\n+     * Sets the target window, tab or frame for this anchor. The target is one of these\n+     * special values:\n+     * <ul>\n+     * <li><code>AnchorTarget.DEFAULT</code>: Removes the target value. This has the same effect as setting the target to <code>AnchorTarget.SELF</code>.\n+     * <li><code>AnchorTarget.SELF</code>: Opens the link in the current context.\n+     * <li><code>AnchorTarget.BLANK</code>: Opens the link in a new unnamed context.\n+     * <li><code>AnchorTarget.PARENT</code>: Opens the link in the parent context, or the\n+     * current context if there is no parent context.\n+     * <li><code>AnchorTarget.TOP</code>: Opens the link in the top most grandparent\n+     * context, or the current context if there is no parent context.\n+     * </ul>\n+     *\n+     * @param target\n+     *            the target value, not null\n+     */\n+    public void setTargetEnum(AnchorTarget target) {", "originalCommit": "27b9420efb43c85b2b2233459f5c2d88270ca279", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ0NzE1OA==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r500447158", "bodyText": "@pleku,\nIf I use setTarget and keep getTargetEnum, I get this error (from HtmlComponentSmokeTest):\n[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 0.259 s <<< FAILURE! - in com.vaadin.flow.component.html.HtmlComponentSmokeTest\n[ERROR] testAllHtmlComponents(com.vaadin.flow.component.html.HtmlComponentSmokeTest)  Time elapsed: 0.226 s  <<< FAILURE!\njava.lang.AssertionError: public void com.vaadin.flow.component.html.Anchor.setTarget(com.vaadin.flow.component.html.AnchorTarget) should have the same type as its getter expected:<class com.vaadin.flow.component.html.AnchorTarget> but was:<class java.lang.String>\n\tat org.junit.Assert.fail(Assert.java:88)\n\tat org.junit.Assert.failNotEquals(Assert.java:834)\n\tat org.junit.Assert.assertEquals(Assert.java:118)\n\tat com.vaadin.flow.component.html.HtmlComponentSmokeTest.testSetter(HtmlComponentSmokeTest.java:200)\n\tat com.vaadin.flow.component.html.HtmlComponentSmokeTest.lambda$testSetters$3(HtmlComponentSmokeTest.java:145)\n\tat com.vaadin.flow.component.html.HtmlComponentSmokeTest$$Lambda$150/000000002006F0E0.accept(Unknown Source)\n\tat java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)\n\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:177)\n\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:177)\n\tat java.base/java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)\n\tat java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:497)\n\tat java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:487)\n\tat java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)\n\tat java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)\n\tat java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:239)\n\tat java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)\n\tat com.vaadin.flow.component.html.HtmlComponentSmokeTest.testSetters(HtmlComponentSmokeTest.java:145)\n\tat com.vaadin.flow.component.html.HtmlComponentSmokeTest.smokeTestComponent(HtmlComponentSmokeTest.java:107)\n\tat com.vaadin.flow.component.html.HtmlComponentSmokeTest$$Lambda$71/0000000020029460.accept(Unknown Source)\n\tat java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)\n\tat java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)\n\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:177)\n\tat java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)\n\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:177)\n\tat java.base/java.util.Iterator.forEachRemaining(Iterator.java:133)\n\tat java.base/java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)\n\tat java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:497)\n\tat java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:487)\n\tat java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)\n\tat java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)\n\tat java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:239)\n\tat java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)\n\tat com.vaadin.flow.component.html.HtmlComponentSmokeTest.testAllHtmlComponents(HtmlComponentSmokeTest.java:87)\n\nAny suggestions on how to rectify?", "author": "jhult", "createdAt": "2020-10-06T16:47:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM1NzgzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjMzNzY5OQ==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r502337699", "bodyText": "I think it just about adding an exception to the check, as a property ignoredMethodNames or such which would have this included and then ignored in the test", "author": "pleku", "createdAt": "2020-10-09T10:32:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM1NzgzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDA1NTExNQ==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r530055115", "bodyText": "I didn't see the exact way to ignore this. So, I followed the example for Label.setFor.", "author": "jhult", "createdAt": "2020-11-25T01:47:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM1NzgzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM1ODE3NA==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r499358174", "bodyText": "Since tags should be kept empty, we'll fix those once we know what release the enhancement lands into first.", "author": "pleku", "createdAt": "2020-10-05T05:53:38Z", "path": "flow-html-components/src/main/java/com/vaadin/flow/component/html/AnchorTarget.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.html;\n+\n+/**\n+ * Enum representing <code>target</code> attribute values for an <code>&lt;a&gt;</code> element.\n+ *\n+ * @author Vaadin Ltd\n+ * @since 3.2", "originalCommit": "27b9420efb43c85b2b2233459f5c2d88270ca279", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ0ODYyNw==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r500448627", "bodyText": "Rebased on master and emptied @since.", "author": "jhult", "createdAt": "2020-10-06T16:49:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM1ODE3NA=="}], "type": "inlineReview"}, {"oid": "7b09c40e6a4d60e6f45c6569d31f1034c510f24b", "url": "https://github.com/vaadin/flow/commit/7b09c40e6a4d60e6f45c6569d31f1034c510f24b", "message": "Add target constants for Anchor to use with alternate setTarget method", "committedDate": "2020-10-06T16:48:36Z", "type": "forcePushed"}, {"oid": "4714525e866aa603ee90f6e655c2ee5111b34efc", "url": "https://github.com/vaadin/flow/commit/4714525e866aa603ee90f6e655c2ee5111b34efc", "message": "Add target constants for Anchor to use with alternate setTarget method", "committedDate": "2020-11-25T01:46:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI3OTA1MA==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r530279050", "bodyText": "Should this just return AnchorTarget.DEFAULT when the actual string value is null instead of an optional ? I understood from the javadocs that it is semantically the same thing ?", "author": "pleku", "createdAt": "2020-11-25T10:49:32Z", "path": "flow-html-components/src/main/java/com/vaadin/flow/component/html/Anchor.java", "diffHunk": "@@ -183,4 +205,47 @@ public void setTarget(String target) {\n         return get(targetDescriptor);\n     }\n \n+    /**\n+     * Sets the target window, tab or frame for this anchor. The target is one of these\n+     * special values:\n+     * <ul>\n+     * <li><code>AnchorTarget.DEFAULT</code>: Removes the target value. This has the same effect as setting the target to <code>AnchorTarget.SELF</code>.\n+     * <li><code>AnchorTarget.SELF</code>: Opens the link in the current context.\n+     * <li><code>AnchorTarget.BLANK</code>: Opens the link in a new unnamed context.\n+     * <li><code>AnchorTarget.PARENT</code>: Opens the link in the parent context, or the\n+     * current context if there is no parent context.\n+     * <li><code>AnchorTarget.TOP</code>: Opens the link in the top most grandparent\n+     * context, or the current context if there is no parent context.\n+     * </ul>\n+     *\n+     * @param target\n+     *            the target value, not null\n+     */\n+    public void setTarget(AnchorTarget target) {\n+        Objects.requireNonNull(target, \"target cannot be null.\");\n+        setTarget(target.getValue());\n+    }\n+\n+    /**\n+     * Gets the target window, tab or frame value for this anchor.\n+     *\n+     * @see #setTarget(AnchorTarget)\n+     *\n+     * @return an optional target, or an empty optional if no target has been\n+     *         set\n+     */\n+    public Optional<AnchorTarget> getTargetEnum() {", "originalCommit": "4714525e866aa603ee90f6e655c2ee5111b34efc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTc3OTI2MA==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r531779260", "bodyText": "This now returns AnchorTarget.DEFAULT if no target has been set.", "author": "jhult", "createdAt": "2020-11-27T20:32:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI3OTA1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjM5MjIxNQ==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r532392215", "bodyText": "Sorry, not done, reopening the discussion as I'm not sure if I was clear enough - I meant that instead of returning an empty optional, it would return AnchorTarget.DEFAULT so the return type would not be Optional for getTargetEnum(). Is there any other issue for this than if they user uses setTarget(\"foobar\") which cannot be parsed to the enum ? I'm not sure if returning null would be just fine then, as wrapping the enum in Optional just feels unnecessary complication.\nNow that I'm thinking this, it might make sense to even deprecate the String version of setTarget(String) and recommend using the enum one instead to avoid errors.", "author": "pleku", "createdAt": "2020-11-30T07:31:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI3OTA1MA=="}], "type": "inlineReview"}, {"oid": "ecbcd998a4eaaf32cca942acf6960f73780d5620", "url": "https://github.com/vaadin/flow/commit/ecbcd998a4eaaf32cca942acf6960f73780d5620", "message": "Add target constants for Anchor to use with alternate setTarget method", "committedDate": "2020-11-27T20:29:56Z", "type": "commit"}, {"oid": "ecbcd998a4eaaf32cca942acf6960f73780d5620", "url": "https://github.com/vaadin/flow/commit/ecbcd998a4eaaf32cca942acf6960f73780d5620", "message": "Add target constants for Anchor to use with alternate setTarget method", "committedDate": "2020-11-27T20:29:56Z", "type": "forcePushed"}, {"oid": "891f87856182dfb18ffbf12bd0e27d12dc5b75de", "url": "https://github.com/vaadin/flow/commit/891f87856182dfb18ffbf12bd0e27d12dc5b75de", "message": "test", "committedDate": "2021-05-04T09:44:59Z", "type": "commit"}, {"oid": "59498f288ccaaf8d43f579a49f8315ab6d2b29f4", "url": "https://github.com/vaadin/flow/commit/59498f288ccaaf8d43f579a49f8315ab6d2b29f4", "message": "revert test commit", "committedDate": "2021-05-04T09:45:31Z", "type": "commit"}, {"oid": "5e73864df70659111b9b5c1a34073e479870443c", "url": "https://github.com/vaadin/flow/commit/5e73864df70659111b9b5c1a34073e479870443c", "message": "chore: use common interface for enum and string wrapper", "committedDate": "2021-05-05T05:48:43Z", "type": "commit"}, {"oid": "5e73864df70659111b9b5c1a34073e479870443c", "url": "https://github.com/vaadin/flow/commit/5e73864df70659111b9b5c1a34073e479870443c", "message": "chore: use common interface for enum and string wrapper", "committedDate": "2021-05-05T05:48:43Z", "type": "forcePushed"}, {"oid": "ab5b86064794a1e53ae4bb66b85a47c376324b8f", "url": "https://github.com/vaadin/flow/commit/ab5b86064794a1e53ae4bb66b85a47c376324b8f", "message": "Merge branch 'master' into #8346", "committedDate": "2021-05-05T05:57:58Z", "type": "commit"}, {"oid": "20194fa6b37e4c38a20fc9410a07b95724caea14", "url": "https://github.com/vaadin/flow/commit/20194fa6b37e4c38a20fc9410a07b95724caea14", "message": "chore: fix javadocs", "committedDate": "2021-05-05T06:28:33Z", "type": "commit"}, {"oid": "63d6c8244337817fd498e8aa6c29cca7276cf704", "url": "https://github.com/vaadin/flow/commit/63d6c8244337817fd498e8aa6c29cca7276cf704", "message": "fix formatting", "committedDate": "2021-05-05T06:30:28Z", "type": "commit"}, {"oid": "de760d9fc4d2afc83a1fd2bd2e1fd6a064c9ac71", "url": "https://github.com/vaadin/flow/commit/de760d9fc4d2afc83a1fd2bd2e1fd6a064c9ac71", "message": "fix serializability", "committedDate": "2021-05-05T06:44:29Z", "type": "commit"}, {"oid": "5801c5d4c44b769019ab64acf2a83be0592d5f80", "url": "https://github.com/vaadin/flow/commit/5801c5d4c44b769019ab64acf2a83be0592d5f80", "message": "yet another change to test to support setter for target object", "committedDate": "2021-05-05T07:24:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNjU3NDA2Nw==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r626574067", "bodyText": "Non-blocking: I wonder why this is an anonymous class instead of private class here but I don't think it makes any difference", "author": "pleku", "createdAt": "2021-05-05T13:39:42Z", "path": "flow-html-components/src/main/java/com/vaadin/flow/component/html/AnchorTargetValue.java", "diffHunk": "@@ -0,0 +1,84 @@\n+/*\n+ * Copyright 2000-2021 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.html;\n+\n+import java.io.Serializable;\n+import java.util.Objects;\n+import java.util.Optional;\n+import java.util.stream.Stream;\n+\n+/**\n+ * Represents <code>target</code> attribute values for an <code>&lt;a&gt;</code>\n+ * element.\n+ * \n+ * @author Vaadin Ltd\n+ * @since\n+ * \n+ * @see AnchorTarget\n+ *\n+ */\n+@FunctionalInterface\n+public interface AnchorTargetValue extends Serializable {\n+\n+    /**\n+     * Gets the string value representation.\n+     * \n+     * @return string value representation\n+     */\n+    String getValue();\n+\n+    /**\n+     * Gets an object instance wrapping the {@code value} string representation.\n+     * \n+     * @param value\n+     *            the string value representation, not {@code null}\n+     * @return an object wrapping the string value\n+     */\n+    public static AnchorTargetValue forString(String value) {\n+        Optional<AnchorTarget> target = Stream.of(AnchorTarget.values()).filter(\n+                type -> type.getValue().equals(Objects.requireNonNull(value)))\n+                .findFirst();\n+        if (target.isPresent()) {\n+            return target.get();\n+        }\n+        return new AnchorTargetValue() {", "originalCommit": "5801c5d4c44b769019ab64acf2a83be0592d5f80", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNjU4MzQ1Ng==", "url": "https://github.com/vaadin/flow/pull/8397#discussion_r626583456", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 *\n          \n          \n            \n                 * For targeting an {@code <iframe>}, browser window or tab by its name, use\n          \n          \n            \n                 * {@link #setTarget(String)} instead.\n          \n          \n            \n                 *", "author": "pleku", "createdAt": "2021-05-05T13:50:02Z", "path": "flow-html-components/src/main/java/com/vaadin/flow/component/html/Anchor.java", "diffHunk": "@@ -183,4 +205,47 @@ public void setTarget(String target) {\n         return get(targetDescriptor);\n     }\n \n+    /**\n+     * Sets the target window, tab or frame for this anchor. The target may be\n+     * the one of these special values:\n+     * <ul>\n+     * <li><code>AnchorTarget.DEFAULT</code>: Removes the target value. This has\n+     * the same effect as setting the target to <code>AnchorTarget.SELF</code>.\n+     * <li><code>AnchorTarget.SELF</code>: Opens the link in the current\n+     * context.\n+     * <li><code>AnchorTarget.BLANK</code>: Opens the link in a new unnamed\n+     * context.\n+     * <li><code>AnchorTarget.PARENT</code>: Opens the link in the parent\n+     * context, or the current context if there is no parent context.\n+     * <li><code>AnchorTarget.TOP</code>: Opens the link in the top most\n+     * grandparent context, or the current context if there is no parent\n+     * context.\n+     * </ul>\n+     *", "originalCommit": "5801c5d4c44b769019ab64acf2a83be0592d5f80", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}