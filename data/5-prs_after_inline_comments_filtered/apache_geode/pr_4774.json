{"pr_number": 4774, "pr_title": "Geode 7850: Implement Redis Rename Command", "pr_createdAt": "2020-03-05T16:16:58Z", "pr_url": "https://github.com/apache/geode/pull/4774", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQxMTY2OQ==", "url": "https://github.com/apache/geode/pull/4774#discussion_r388411669", "bodyText": "Please don't use single (or double) character variable names", "author": "kohlmu-pivotal", "createdAt": "2020-03-05T16:31:45Z", "path": "geode-redis/src/integrationTest/java/org/apache/geode/redis/RenameTest.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package org.apache.geode.redis;\n+\n+import static org.apache.geode.distributed.ConfigurationProperties.LOCATORS;\n+import static org.apache.geode.distributed.ConfigurationProperties.LOG_LEVEL;\n+import static org.apache.geode.distributed.ConfigurationProperties.MCAST_PORT;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+\n+import java.util.HashSet;\n+import java.util.Random;\n+import java.util.Set;\n+import java.util.concurrent.Callable;\n+import java.util.concurrent.ExecutionException;\n+import java.util.concurrent.ExecutorService;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.Future;\n+\n+import org.junit.After;\n+import org.junit.AfterClass;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+import redis.clients.jedis.Jedis;\n+\n+import org.apache.geode.cache.CacheFactory;\n+import org.apache.geode.cache.GemFireCache;\n+import org.apache.geode.internal.AvailablePortHelper;\n+import org.apache.geode.management.internal.cli.util.ThreePhraseGenerator;\n+import org.apache.geode.test.junit.categories.RedisTest;\n+\n+@Category({RedisTest.class})\n+public class RenameTest {\n+  private static GeodeRedisServer server;\n+  private static GemFireCache cache;\n+  private static Random rand;\n+  private static Jedis client;\n+  private static int port = 6379;\n+  private static ThreePhraseGenerator generator = new ThreePhraseGenerator();\n+\n+  @BeforeClass\n+  public static void setUp() {\n+    rand = new Random();\n+    CacheFactory cf = new CacheFactory();\n+    cf.set(LOG_LEVEL, \"info\");\n+    cf.set(MCAST_PORT, \"0\");\n+    cf.set(LOCATORS, \"\");\n+    cache = cf.create();", "originalCommit": "77a694cccd83785d478718824e6040cc31948f48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwMjY0MA==", "url": "https://github.com/apache/geode/pull/4774#discussion_r388502640", "bodyText": "done. thx", "author": "prettyClouds", "createdAt": "2020-03-05T19:10:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQxMTY2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQxMjQ4Mg==", "url": "https://github.com/apache/geode/pull/4774#discussion_r388412482", "bodyText": "what is pwd?", "author": "kohlmu-pivotal", "createdAt": "2020-03-05T16:33:02Z", "path": "geode-redis/src/main/java/org/apache/geode/redis/internal/ExecutionHandlerContext.java", "diffHunk": "@@ -101,13 +100,10 @@ public PubSub getPubSub() {\n    * @param pwd Authentication password for each context, can be null\n    */\n   public ExecutionHandlerContext(Channel ch, Cache cache, RegionProvider regionProvider,\n-      GeodeRedisServer server, byte[] pwd, KeyRegistrar keyRegistrar,\n-      PubSub pubSub,\n-      RedisLockService hashLockService,\n-      RedisLockService setLockService) {\n+      GeodeRedisServer server, byte[] pwd, KeyRegistrar keyRegistrar, PubSub pubSub,", "originalCommit": "77a694cccd83785d478718824e6040cc31948f48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwMjY2Nw==", "url": "https://github.com/apache/geode/pull/4774#discussion_r388502667", "bodyText": "done. thx", "author": "prettyClouds", "createdAt": "2020-03-05T19:10:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQxMjQ4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQxMzM0Ng==", "url": "https://github.com/apache/geode/pull/4774#discussion_r388413346", "bodyText": "ch is bad parameter/variable name. Please correct to something a little more descriptive. Like channel... makes it easier to read when one gets past 15 lines of code where it was initially defined", "author": "kohlmu-pivotal", "createdAt": "2020-03-05T16:34:25Z", "path": "geode-redis/src/main/java/org/apache/geode/redis/internal/ExecutionHandlerContext.java", "diffHunk": "@@ -101,13 +100,10 @@ public PubSub getPubSub() {\n    * @param pwd Authentication password for each context, can be null\n    */\n   public ExecutionHandlerContext(Channel ch, Cache cache, RegionProvider regionProvider,\n-      GeodeRedisServer server, byte[] pwd, KeyRegistrar keyRegistrar,\n-      PubSub pubSub,\n-      RedisLockService hashLockService,\n-      RedisLockService setLockService) {\n+      GeodeRedisServer server, byte[] pwd, KeyRegistrar keyRegistrar, PubSub pubSub,\n+      RedisLockService lockService) {\n     this.keyRegistrar = keyRegistrar;\n-    this.hashLockService = hashLockService;\n-    this.setLockService = setLockService;\n+    this.lockService = lockService;\n     this.pubSub = pubSub;\n     if (ch == null || cache == null || regionProvider == null || server == null) {", "originalCommit": "77a694cccd83785d478718824e6040cc31948f48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwMjcwNA==", "url": "https://github.com/apache/geode/pull/4774#discussion_r388502704", "bodyText": "done. thx", "author": "prettyClouds", "createdAt": "2020-03-05T19:10:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQxMzM0Ng=="}], "type": "inlineReview"}, {"oid": "64fadb14f50d9d5b5ec3e5b02f6f4b403f237bf3", "url": "https://github.com/apache/geode/commit/64fadb14f50d9d5b5ec3e5b02f6f4b403f237bf3", "message": "Implements Redis Rename Command", "committedDate": "2020-03-10T15:10:06Z", "type": "commit"}, {"oid": "64fadb14f50d9d5b5ec3e5b02f6f4b403f237bf3", "url": "https://github.com/apache/geode/commit/64fadb14f50d9d5b5ec3e5b02f6f4b403f237bf3", "message": "Implements Redis Rename Command", "committedDate": "2020-03-10T15:10:06Z", "type": "forcePushed"}, {"oid": "64d9dbd7f54377d8351da213366123ea6e6449a9", "url": "https://github.com/apache/geode/commit/64d9dbd7f54377d8351da213366123ea6e6449a9", "message": "trigger pipeline", "committedDate": "2020-03-10T20:16:28Z", "type": "commit"}, {"oid": "453c56f55d0642634f3ec9f0bcb74247f0d6ad11", "url": "https://github.com/apache/geode/commit/453c56f55d0642634f3ec9f0bcb74247f0d6ad11", "message": "Trigger CI. Again.", "committedDate": "2020-03-10T22:24:39Z", "type": "commit"}, {"oid": "a61318b0ad8276e19eb319844e1762b4f987cbfd", "url": "https://github.com/apache/geode/commit/a61318b0ad8276e19eb319844e1762b4f987cbfd", "message": "Thinking green thoughts.", "committedDate": "2020-03-11T03:58:06Z", "type": "commit"}, {"oid": "b93e271a234ca6acc6bded2e4e936ea5f37ae4c4", "url": "https://github.com/apache/geode/commit/b93e271a234ca6acc6bded2e4e936ea5f37ae4c4", "message": "Sigh.", "committedDate": "2020-03-11T12:30:05Z", "type": "commit"}, {"oid": "40d91e71af4108250988e8171f093c7904a9355f", "url": "https://github.com/apache/geode/commit/40d91e71af4108250988e8171f093c7904a9355f", "message": "Refactor: naming", "committedDate": "2020-03-11T20:40:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTI4MDAwOQ==", "url": "https://github.com/apache/geode/pull/4774#discussion_r391280009", "bodyText": "r?", "author": "kohlmu-pivotal", "createdAt": "2020-03-11T21:31:27Z", "path": "geode-redis/src/main/java/org/apache/geode/redis/internal/executor/string/GetExecutor.java", "diffHunk": "@@ -36,6 +35,8 @@ public void executeCommand(Command command, ExecutionHandlerContext context) {\n \n     ByteArrayWrapper key = command.getKey();\n     checkDataType(key, RedisDataType.REDIS_STRING, context);\n+\n+    Region<ByteArrayWrapper, ByteArrayWrapper> r = context.getRegionProvider().getStringsRegion();", "originalCommit": "40d91e71af4108250988e8171f093c7904a9355f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d4fff59c99cd4507d3cf7de534a135356796a752", "url": "https://github.com/apache/geode/commit/d4fff59c99cd4507d3cf7de534a135356796a752", "message": "Review updates", "committedDate": "2020-03-11T23:17:36Z", "type": "commit"}]}