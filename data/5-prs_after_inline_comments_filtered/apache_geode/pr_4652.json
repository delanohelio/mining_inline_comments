{"pr_number": 4652, "pr_title": "GEODE-7742: move membership unit tests to geode-membership", "pr_createdAt": "2020-01-30T23:33:50Z", "pr_url": "https://github.com/apache/geode/pull/4652", "timeline": [{"oid": "ecdbffa9680b79cd28bebf026c8afcc1a568fa1e", "url": "https://github.com/apache/geode/commit/ecdbffa9680b79cd28bebf026c8afcc1a568fa1e", "message": "GEODE-7742: move membership unit tests to geode-membership\n\nMoving health monitor test to geode-membership", "committedDate": "2020-02-01T00:00:31Z", "type": "commit"}, {"oid": "c116ae05f8bc2df1b4adc7721592315bc2881af1", "url": "https://github.com/apache/geode/commit/c116ae05f8bc2df1b4adc7721592315bc2881af1", "message": "move JGroupsMessengerJUnitTest", "committedDate": "2020-02-01T00:02:12Z", "type": "commit"}, {"oid": "95497337eeb21b6ffd0f91ea643e385588977607", "url": "https://github.com/apache/geode/commit/95497337eeb21b6ffd0f91ea643e385588977607", "message": "move GMSJoinLeaveJUnitTest to geode-membership", "committedDate": "2020-02-01T00:02:13Z", "type": "commit"}, {"oid": "f46b16f2a32ae95679f220392a7898e418c9f004", "url": "https://github.com/apache/geode/commit/f46b16f2a32ae95679f220392a7898e418c9f004", "message": "move GMSLocatorRecoveryIntegrationTest to geode-membership", "committedDate": "2020-02-01T00:02:13Z", "type": "commit"}, {"oid": "62bc1253a1c22b31159ab682ebc3f2528760285c", "url": "https://github.com/apache/geode/commit/62bc1253a1c22b31159ab682ebc3f2528760285c", "message": "added address of locator providing FindCoordinatorResponses", "committedDate": "2020-02-01T00:02:49Z", "type": "commit"}, {"oid": "62bc1253a1c22b31159ab682ebc3f2528760285c", "url": "https://github.com/apache/geode/commit/62bc1253a1c22b31159ab682ebc3f2528760285c", "message": "added address of locator providing FindCoordinatorResponses", "committedDate": "2020-02-01T00:02:49Z", "type": "forcePushed"}, {"oid": "270537eede99476104c21b143ca98214c4b3ba56", "url": "https://github.com/apache/geode/commit/270537eede99476104c21b143ca98214c4b3ba56", "message": "resolving compilation errors from rebase", "committedDate": "2020-02-01T00:12:32Z", "type": "commit"}, {"oid": "d00f2035ecd8265439d4cd5b90c85115a3e0b33b", "url": "https://github.com/apache/geode/commit/d00f2035ecd8265439d4cd5b90c85115a3e0b33b", "message": "removing the use of reset and removing threads from test failing stress-testing", "committedDate": "2020-02-03T16:01:29Z", "type": "commit"}, {"oid": "db323935d6e0eeff3a56b385f472b6a422d28897", "url": "https://github.com/apache/geode/commit/db323935d6e0eeff3a56b385f472b6a422d28897", "message": "empty commit", "committedDate": "2020-02-03T20:18:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5MTA5Nw==", "url": "https://github.com/apache/geode/pull/4652#discussion_r374391097", "bodyText": "Where are these stats being used? Is it ok that they are not thread-safe?", "author": "Bill", "createdAt": "2020-02-03T23:02:13Z", "path": "geode-membership/src/main/java/org/apache/geode/distributed/internal/membership/gms/DefaultMembershipStatistics.java", "diffHunk": "@@ -17,10 +17,35 @@\n import org.apache.geode.distributed.internal.membership.api.MembershipStatistics;\n \n /**\n- * MembeshipStatisticsNoOp is the default implementation of MembershipStatistics. Create\n+ * DefaultMembeshipStatistics is the default implementation of MembershipStatistics. Create\n  * and install your own if you want to record membership stats.\n  */\n-public class MembershipStatisticsNoOp implements MembershipStatistics {\n+public class DefaultMembershipStatistics implements MembershipStatistics {\n+  private long sentBytes;\n+  private long ucastWriteBytes;\n+  private long ucastReadBytes;\n+  private long mcastWriteBytes;\n+  private long mcastReadBytes;\n+  private long ucastRetransmits;\n+  private long mcastRetransmits;\n+  private long mcastRetransmitRequests;\n+  private long heartbeatRequestsSent;\n+  private long heartbeatRequestsReceived;\n+  private long heartbeatsSent;\n+  private long heartbeatsReceived;\n+  private long suspectsSent;\n+  private long suspectsReceived;\n+  private long finalCheckRequestsSent;\n+  private long finalCheckRequestsReceived;\n+  private long finalCheckResponsesSent;\n+  private long finalCheckResponsesReceived;\n+  private long tcpFinalCheckRequestsSent;\n+  private long tcpFinalCheckRequestsReceived;\n+  private long tcpFinalCheckResponsesSent;\n+  private long tcpFinalCheckResponsesReceived;\n+  private long udpFinalCheckRequestsSent;\n+  private long udpFinalCheckResponsesReceived;", "originalCommit": "db323935d6e0eeff3a56b385f472b6a422d28897", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5MjE1MQ==", "url": "https://github.com/apache/geode/pull/4652#discussion_r374392151", "bodyText": "@Bill The stats are being used in unit tests", "author": "bschuchardt", "createdAt": "2020-02-03T23:05:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5MTA5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQwMjI4Mg==", "url": "https://github.com/apache/geode/pull/4652#discussion_r374402282", "bodyText": "Am I wrong to be concerned about (lack of) synchronization on these fields?\nI understand the stakes are low on test code\u2014but I wonder if the uncoordinated access could lead to test flakiness. Happy to be talked out of this position :)", "author": "Bill", "createdAt": "2020-02-03T23:35:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5MTA5Nw=="}], "type": "inlineReview"}]}