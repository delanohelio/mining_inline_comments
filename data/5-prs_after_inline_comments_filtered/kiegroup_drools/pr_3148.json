{"pr_number": 3148, "pr_title": "Removing vulnerabilities, code smells in test-scenario module", "pr_createdAt": "2020-10-08T11:45:18Z", "pr_url": "https://github.com/kiegroup/drools/pull/3148", "timeline": [{"oid": "08850792d8e17cb2b98650c0e93fc19ec7222e22", "url": "https://github.com/kiegroup/drools/commit/08850792d8e17cb2b98650c0e93fc19ec7222e22", "message": "Removing vulnerabilities, code smells in test-scenario module", "committedDate": "2020-10-08T08:51:47Z", "type": "commit"}, {"oid": "3d37e0496271c3598d781ed7de8c5e158d810b7a", "url": "https://github.com/kiegroup/drools/commit/3d37e0496271c3598d781ed7de8c5e158d810b7a", "message": "Removing vulnerabilities, code smells in test-scenario module", "committedDate": "2020-10-08T11:43:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY3MTk5Ng==", "url": "https://github.com/kiegroup/drools/pull/3148#discussion_r501671996", "bodyText": "It is not related to the PR but why don't make internalFilter returns Stream<FactMapping> (and update getFactMappingsByFactName accordingly)?\nThis should prevent useless iteration", "author": "danielezonca", "createdAt": "2020-10-08T12:14:20Z", "path": "drools-scenario-simulation/drools-scenario-simulation-api/src/main/java/org/drools/scenariosimulation/api/model/ScesimModelDescriptor.java", "diffHunk": "@@ -89,9 +89,9 @@ public int getIndexByIdentifier(FactIdentifier factIdentifier, ExpressionIdentif\n     }\n \n     public Optional<FactMapping> getFactMapping(FactIdentifier factIdentifier, ExpressionIdentifier ei) {\n-        List<FactMapping> factMappings = internalFilter(e -> Objects.equals(e.getExpressionIdentifier(), ei) &&\n+        List<FactMapping> filteredFactMappings = internalFilter(e -> Objects.equals(e.getExpressionIdentifier(), ei) &&", "originalCommit": "3d37e0496271c3598d781ed7de8c5e158d810b7a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTc4MDQwNw==", "url": "https://github.com/kiegroup/drools/pull/3148#discussion_r501780407", "bodyText": "@danielezonca Very nice, the only downside is we need to create a PR for drools-wb accordingly to that change (the API changes). Please wait for that PR before proceed.", "author": "yesamer", "createdAt": "2020-10-08T14:46:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY3MTk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg2NTEyOQ==", "url": "https://github.com/kiegroup/drools/pull/3148#discussion_r501865129", "bodyText": "Actually I was proposing a more simple and limited change: make internalFilter returns a stream, then update getFactMapping as\n    public Optional<FactMapping> getFactMapping(FactIdentifier factIdentifier, ExpressionIdentifier ei) {\n        return internalFilter(e -> Objects.equals(e.getExpressionIdentifier(), ei) &&\n                Objects.equals(e.getFactIdentifier(), factIdentifier)).findFirst();\n    }\nAnd change\n    public List<FactMapping> getFactMappingsByFactName(String factName) {\n        return internalFilter(e -> e.getFactIdentifier().getName().equalsIgnoreCase(factName)).collect(Collectors.toList());\n    }\nSo in this case no impact on other repo :)", "author": "danielezonca", "createdAt": "2020-10-08T16:46:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY3MTk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjI4OTQ0NQ==", "url": "https://github.com/kiegroup/drools/pull/3148#discussion_r502289445", "bodyText": "@danielezonca ok, in any case I think returning a Stream in  getFactMappingsByFactName works very well in this case, in client side the only case where that list is used is converted as a Stream and operation are used.", "author": "yesamer", "createdAt": "2020-10-09T09:01:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY3MTk5Ng=="}], "type": "inlineReview"}, {"oid": "ee72a36b31df89c31a10fb048b5e2b6b346a20dd", "url": "https://github.com/kiegroup/drools/commit/ee72a36b31df89c31a10fb048b5e2b6b346a20dd", "message": "Removing vulnerabilities, code smells in test-scenario module - Changes required during CR", "committedDate": "2020-10-08T12:57:51Z", "type": "commit"}, {"oid": "6925d1c0acdeb7a607fe4b7834b874856a677b60", "url": "https://github.com/kiegroup/drools/commit/6925d1c0acdeb7a607fe4b7834b874856a677b60", "message": "Merge remote-tracking branch 'origin/master' into no-vulnerabilities-test-scenario", "committedDate": "2020-10-09T08:48:53Z", "type": "commit"}, {"oid": "1df86f3dcd1c013ef77570121e49e228844fb7df", "url": "https://github.com/kiegroup/drools/commit/1df86f3dcd1c013ef77570121e49e228844fb7df", "message": "Removing vulnerabilities, code smells in test-scenario module - Tests", "committedDate": "2020-10-09T08:52:43Z", "type": "commit"}]}