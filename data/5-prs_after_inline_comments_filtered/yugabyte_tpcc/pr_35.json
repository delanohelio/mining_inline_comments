{"pr_number": 35, "pr_title": "Limit the number of connections to 200 per node.", "pr_createdAt": "2020-07-08T00:34:48Z", "pr_url": "https://github.com/yugabyte/tpcc/pull/35", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI5MTY0OA==", "url": "https://github.com/yugabyte/tpcc/pull/35#discussion_r451291648", "bodyText": "We should make this a parameter, say something like maxConnectionsPerNode, so that it becomes easy to change this on the fly. Similar for connectionTimeoutMillis below.", "author": "rkarthik007", "createdAt": "2020-07-08T05:29:10Z", "path": "src/com/oltpbenchmark/DBWorkload.java", "diffHunk": "@@ -264,7 +266,8 @@ public static void main(String[] args) throws Exception {\n             if (xmlConfig.containsKey(\"numDBConnections\")) {\n                 wrkld.setNumDBConnections(xmlConfig.getInt(\"numDBConnections\"));\n             } else {\n-                wrkld.setNumDBConnections(numWarehouses);\n+                // We use a max of 200 connections per node so as to not overwhelm the DB cluster.\n+                wrkld.setNumDBConnections(min(numWarehouses, wrkld.getNodes().size() * 200));", "originalCommit": "1d7435f4b525adffca431043a76636fc1dd2d1e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcyNjc4MQ==", "url": "https://github.com/yugabyte/tpcc/pull/35#discussion_r451726781", "bodyText": "This is already something that is controlled using the xml config.\nI don't think people would need to change it often and hence can reside in the xml.\nSimilarly connectionTimeoutMillis can be an xml config.", "author": "psudheer21", "createdAt": "2020-07-08T17:56:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI5MTY0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgyNjA3Ng==", "url": "https://github.com/yugabyte/tpcc/pull/35#discussion_r451826076", "bodyText": "I was referring to making the 200 value a param in the following expression:\nwrkld.setNumDBConnections(min(numWarehouses, wrkld.getNodes().size() * 200));\n\nWorried that we would not be able to ask anyone to change this if needed. Should we introduce the param as maxConnectionsPerTserver so that its clear what it does, and set the default value to 200?\nWhat do you think @ndeodhar ?", "author": "rkarthik007", "createdAt": "2020-07-08T21:07:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI5MTY0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ5MzU5NA==", "url": "https://github.com/yugabyte/tpcc/pull/35#discussion_r452493594", "bodyText": "Agree, the max should be configurable instead of being hardcoded.", "author": "ndeodhar", "createdAt": "2020-07-09T21:13:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI5MTY0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjUwMzA0MA==", "url": "https://github.com/yugabyte/tpcc/pull/35#discussion_r452503040", "bodyText": "Sync'd offline with Sudheer. Since we already have a param to control numDBConnections, we don't need another one for maxConnectionsPerNode", "author": "ndeodhar", "createdAt": "2020-07-09T21:34:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI5MTY0OA=="}], "type": "inlineReview"}, {"oid": "cf978b65c502cbd3338d426d5175e0f9421b8c7e", "url": "https://github.com/yugabyte/tpcc/commit/cf978b65c502cbd3338d426d5175e0f9421b8c7e", "message": "Limit the number of connections to 200 per node.\n\nReviewers:\nNeha, Karthik", "committedDate": "2020-07-08T18:04:40Z", "type": "commit"}, {"oid": "cf978b65c502cbd3338d426d5175e0f9421b8c7e", "url": "https://github.com/yugabyte/tpcc/commit/cf978b65c502cbd3338d426d5175e0f9421b8c7e", "message": "Limit the number of connections to 200 per node.\n\nReviewers:\nNeha, Karthik", "committedDate": "2020-07-08T18:04:40Z", "type": "forcePushed"}]}