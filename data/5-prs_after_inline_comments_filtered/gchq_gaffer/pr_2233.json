{"pr_number": 2233, "pr_title": "Gh 2226 fedated change graph access", "pr_createdAt": "2020-01-22T15:02:47Z", "pr_url": "https://github.com/gchq/Gaffer/pull/2233", "timeline": [{"oid": "3e187ef4c4ca284cf7f2bf95ec76516c23fe23b3", "url": "https://github.com/gchq/Gaffer/commit/3e187ef4c4ca284cf7f2bf95ec76516c23fe23b3", "message": "Typo", "committedDate": "2019-12-20T17:51:09Z", "type": "commit"}, {"oid": "69e26a38fabb70bd1fab37798d277f13e7c856db", "url": "https://github.com/gchq/Gaffer/commit/69e26a38fabb70bd1fab37798d277f13e7c856db", "message": "gh-2223 FederatedAdminIT tests", "committedDate": "2020-01-17T15:49:13Z", "type": "commit"}, {"oid": "dd0052afdb2944a048393344cc97f80a29784e0d", "url": "https://github.com/gchq/Gaffer/commit/dd0052afdb2944a048393344cc97f80a29784e0d", "message": "gh-2223 Admin Override for RemoveGraph and GetAllGraphIds", "committedDate": "2020-01-17T15:49:30Z", "type": "commit"}, {"oid": "336425581173a62997f9efb0dc169619b33266dd", "url": "https://github.com/gchq/Gaffer/commit/336425581173a62997f9efb0dc169619b33266dd", "message": "gh-2223 Admin override for RemoveGraph uses predicate", "committedDate": "2020-01-17T15:50:26Z", "type": "commit"}, {"oid": "15f7ad1d0730f65d33533bb1f590d2b740e126e1", "url": "https://github.com/gchq/Gaffer/commit/15f7ad1d0730f65d33533bb1f590d2b740e126e1", "message": "gh-2223 FederatedAdminIT tests for a NonAdmin user requesting admin override.", "committedDate": "2020-01-17T15:50:37Z", "type": "commit"}, {"oid": "7f9e65937dd4ba645439f874ce0894e3e5161906", "url": "https://github.com/gchq/Gaffer/commit/7f9e65937dd4ba645439f874ce0894e3e5161906", "message": "gh-2223 change to gaffer.store.admin.auth and renaming", "committedDate": "2020-01-17T17:11:03Z", "type": "commit"}, {"oid": "66d769ac1d19ebc1ea22025917485e28c1794087", "url": "https://github.com/gchq/Gaffer/commit/66d769ac1d19ebc1ea22025917485e28c1794087", "message": "gh-2225 Federated GetAllGraphInfo", "committedDate": "2020-01-17T17:17:10Z", "type": "commit"}, {"oid": "c447901ad7573340ae01578203d9f5011370adfa", "url": "https://github.com/gchq/Gaffer/commit/c447901ad7573340ae01578203d9f5011370adfa", "message": "gh-2225 FederatedGetAllGraphInfoHandler has AdminAll and User usage.", "committedDate": "2020-01-17T17:17:33Z", "type": "commit"}, {"oid": "5891ac0d1fa3c535f20b988f8cff13529a6aea14", "url": "https://github.com/gchq/Gaffer/commit/5891ac0d1fa3c535f20b988f8cff13529a6aea14", "message": "gh-2223 checkstyle", "committedDate": "2020-01-17T17:33:10Z", "type": "commit"}, {"oid": "fd5055e26296fab04a7d69d23cd3e53aa4fabd97", "url": "https://github.com/gchq/Gaffer/commit/fd5055e26296fab04a7d69d23cd3e53aa4fabd97", "message": "gh-2225 checkstyle", "committedDate": "2020-01-17T17:33:29Z", "type": "commit"}, {"oid": "6699a0a362fb7bb298cf7819d92686b46ab51462", "url": "https://github.com/gchq/Gaffer/commit/6699a0a362fb7bb298cf7819d92686b46ab51462", "message": "gh-2225 GetGraphInfo can be filtered by graphIds", "committedDate": "2020-01-18T18:02:05Z", "type": "commit"}, {"oid": "2d4d7104042eebff93f876761d4a567a216a11bd", "url": "https://github.com/gchq/Gaffer/commit/2d4d7104042eebff93f876761d4a567a216a11bd", "message": "gh-2223 remove graph admin param added.", "committedDate": "2020-01-20T20:07:05Z", "type": "commit"}, {"oid": "d4a69281b1220337e7c78efa016d5883408ce93a", "url": "https://github.com/gchq/Gaffer/commit/d4a69281b1220337e7c78efa016d5883408ce93a", "message": "gh-2225 getAllGraphsAndAuths isAdmin param", "committedDate": "2020-01-20T20:08:49Z", "type": "commit"}, {"oid": "7577c8814a6eef1f7bc2fa3117250bc1617b2a43", "url": "https://github.com/gchq/Gaffer/commit/7577c8814a6eef1f7bc2fa3117250bc1617b2a43", "message": "gh-2226 Federated ChangeGraphAccess", "committedDate": "2020-01-21T14:19:15Z", "type": "commit"}, {"oid": "be4b64e033b63e85a954d2cb3e495f236d451d31", "url": "https://github.com/gchq/Gaffer/commit/be4b64e033b63e85a954d2cb3e495f236d451d31", "message": "Merge branch 'develop' into gh-2223-Federated-Admin-override", "committedDate": "2020-01-21T15:04:25Z", "type": "commit"}, {"oid": "b893e9d87aef924765afba8c7affd533c71d9fdd", "url": "https://github.com/gchq/Gaffer/commit/b893e9d87aef924765afba8c7affd533c71d9fdd", "message": "Merge branch 'develop' into gh-2225-federated-getAllGraphInfo", "committedDate": "2020-01-21T15:04:48Z", "type": "commit"}, {"oid": "a5229a23451bbfe2eeaf23bfb771150759e5cef0", "url": "https://github.com/gchq/Gaffer/commit/a5229a23451bbfe2eeaf23bfb771150759e5cef0", "message": "Merge branch 'develop' into gh-2226-Fedated-ChangeGraphAccess", "committedDate": "2020-01-21T15:05:02Z", "type": "commit"}, {"oid": "f54bc80d150c59ba87bcc18ea08d0ef1f038980d", "url": "https://github.com/gchq/Gaffer/commit/f54bc80d150c59ba87bcc18ea08d0ef1f038980d", "message": "gh-2223 refinements and package protected methods in FederatedGraphStorage", "committedDate": "2020-01-21T18:04:16Z", "type": "commit"}, {"oid": "68e6a108c0b59216e257c05dd0522ddf6dc7b062", "url": "https://github.com/gchq/Gaffer/commit/68e6a108c0b59216e257c05dd0522ddf6dc7b062", "message": "gh-2225 refinements and package protected methods in FederatedGraphStorage", "committedDate": "2020-01-21T18:19:00Z", "type": "commit"}, {"oid": "f09f7b9b869416e7243b7138eb76316223e98004", "url": "https://github.com/gchq/Gaffer/commit/f09f7b9b869416e7243b7138eb76316223e98004", "message": "gh-2226 refinements and package protected methods in FederatedGraphStorage", "committedDate": "2020-01-21T18:30:26Z", "type": "commit"}, {"oid": "f292a9346528e09ee0e12b93ce438b6d0c7053cf", "url": "https://github.com/gchq/Gaffer/commit/f292a9346528e09ee0e12b93ce438b6d0c7053cf", "message": "Merge branch 'gh-2223-Federated-Admin-override' into gh-2225-federated-getAllGraphInfo\n\n# Conflicts:\n#\tstore-implementation/federated-store/src/main/java/uk/gov/gchq/gaffer/federatedstore/FederatedGraphStorage.java\n#\tstore-implementation/federated-store/src/test/java/uk/gov/gchq/gaffer/federatedstore/integration/FederatedAdminIT.java", "committedDate": "2020-01-22T15:14:52Z", "type": "commit"}, {"oid": "c6299cae442c20acab44fc033f543e2363efba8d", "url": "https://github.com/gchq/Gaffer/commit/c6299cae442c20acab44fc033f543e2363efba8d", "message": "Merge branch 'gh-2225-federated-getAllGraphInfo' into gh-2226-Fedated-ChangeGraphAccess\n\n# Conflicts:\n#\tstore-implementation/federated-store/src/main/java/uk/gov/gchq/gaffer/federatedstore/FederatedGraphStorage.java\n#\tstore-implementation/federated-store/src/main/java/uk/gov/gchq/gaffer/federatedstore/FederatedStore.java\n#\tstore-implementation/federated-store/src/test/java/uk/gov/gchq/gaffer/federatedstore/integration/FederatedAdminIT.java", "committedDate": "2020-01-22T15:20:51Z", "type": "commit"}, {"oid": "2a9065ea0d479997e8f5ea215063ce47afaa921b", "url": "https://github.com/gchq/Gaffer/commit/2a9065ea0d479997e8f5ea215063ce47afaa921b", "message": "Merge branch 'federated-admin-changes' into gh-2225-federated-getAllGraphInfo", "committedDate": "2020-01-22T15:50:47Z", "type": "commit"}, {"oid": "3c299ea38d4d4e179814c8bc5353216c2edc10db", "url": "https://github.com/gchq/Gaffer/commit/3c299ea38d4d4e179814c8bc5353216c2edc10db", "message": "Apply suggestions from code review\n\nCo-Authored-By: d47853 <d47853@users.noreply.github.com>", "committedDate": "2020-01-22T16:56:25Z", "type": "commit"}, {"oid": "b3244a4ba2a4d7d7a191edbd33465b42916b990c", "url": "https://github.com/gchq/Gaffer/commit/b3244a4ba2a4d7d7a191edbd33465b42916b990c", "message": "gh-2225 PR changes GetGraphInfo returns FederatedAccess not string.", "committedDate": "2020-01-22T17:54:12Z", "type": "commit"}, {"oid": "7f432eda3c5e926fafb6330dbb78a766ffeaeaa0", "url": "https://github.com/gchq/Gaffer/commit/7f432eda3c5e926fafb6330dbb78a766ffeaeaa0", "message": "Merge branch 'gh-2225-federated-getAllGraphInfo' into gh-2226-Fedated-ChangeGraphAccess", "committedDate": "2020-01-22T17:55:03Z", "type": "commit"}, {"oid": "fa44598d37d6a08273bc64c818dbf4eb5e1cf463", "url": "https://github.com/gchq/Gaffer/commit/fa44598d37d6a08273bc64c818dbf4eb5e1cf463", "message": "Merge branch 'federated-admin-changes' into gh-2226-Fedated-ChangeGraphAccess", "committedDate": "2020-01-23T10:16:58Z", "type": "commit"}, {"oid": "512699d749cf943d7189232acce64856634aa3f6", "url": "https://github.com/gchq/Gaffer/commit/512699d749cf943d7189232acce64856634aa3f6", "message": "gh-2226 comments", "committedDate": "2020-01-23T15:47:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDU2NTcyOA==", "url": "https://github.com/gchq/Gaffer/pull/2233#discussion_r370565728", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Copyright 2017-2019 Crown Copyright\n          \n          \n            \n             * Copyright 2020 Crown Copyright", "author": "d47853", "createdAt": "2020-01-24T10:28:32Z", "path": "store-implementation/federated-store/src/main/java/uk/gov/gchq/gaffer/federatedstore/operation/ChangeGraphAccess.java", "diffHunk": "@@ -0,0 +1,172 @@\n+/*\n+ * Copyright 2017-2019 Crown Copyright", "originalCommit": "fa44598d37d6a08273bc64c818dbf4eb5e1cf463", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDU2NjI0NA==", "url": "https://github.com/gchq/Gaffer/pull/2233#discussion_r370566244", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            @Since(\"1.10.5\")\n          \n          \n            \n            @Since(\"1.10.6\")", "author": "d47853", "createdAt": "2020-01-24T10:29:43Z", "path": "store-implementation/federated-store/src/main/java/uk/gov/gchq/gaffer/federatedstore/operation/ChangeGraphAccess.java", "diffHunk": "@@ -0,0 +1,172 @@\n+/*\n+ * Copyright 2017-2019 Crown Copyright\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package uk.gov.gchq.gaffer.federatedstore.operation;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonInclude.Include;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import com.google.common.collect.Sets;\n+import org.apache.commons.lang3.exception.CloneFailedException;\n+\n+import uk.gov.gchq.gaffer.commonutil.Required;\n+import uk.gov.gchq.gaffer.federatedstore.FederatedGraphStorage;\n+import uk.gov.gchq.gaffer.operation.io.Output;\n+import uk.gov.gchq.gaffer.operation.serialisation.TypeReferenceImpl;\n+import uk.gov.gchq.koryphe.Since;\n+import uk.gov.gchq.koryphe.Summary;\n+\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import static uk.gov.gchq.gaffer.federatedstore.FederatedStoreConstants.KEY_OPERATION_OPTIONS_GRAPH_IDS;\n+\n+\n+@JsonPropertyOrder(value = {\"class\", \"graphId\"}, alphabetic = true)\n+@Since(\"1.10.5\")", "originalCommit": "fa44598d37d6a08273bc64c818dbf4eb5e1cf463", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDU2ODQwNA==", "url": "https://github.com/gchq/Gaffer/pull/2233#discussion_r370568404", "bodyText": "Why the abstract class if theres only going to be one implementation?", "author": "d47853", "createdAt": "2020-01-24T10:34:50Z", "path": "store-implementation/federated-store/src/main/java/uk/gov/gchq/gaffer/federatedstore/operation/ChangeGraphAccess.java", "diffHunk": "@@ -0,0 +1,172 @@\n+/*\n+ * Copyright 2017-2019 Crown Copyright\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package uk.gov.gchq.gaffer.federatedstore.operation;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonInclude.Include;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import com.google.common.collect.Sets;\n+import org.apache.commons.lang3.exception.CloneFailedException;\n+\n+import uk.gov.gchq.gaffer.commonutil.Required;\n+import uk.gov.gchq.gaffer.federatedstore.FederatedGraphStorage;\n+import uk.gov.gchq.gaffer.operation.io.Output;\n+import uk.gov.gchq.gaffer.operation.serialisation.TypeReferenceImpl;\n+import uk.gov.gchq.koryphe.Since;\n+import uk.gov.gchq.koryphe.Summary;\n+\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import static uk.gov.gchq.gaffer.federatedstore.FederatedStoreConstants.KEY_OPERATION_OPTIONS_GRAPH_IDS;\n+\n+\n+@JsonPropertyOrder(value = {\"class\", \"graphId\"}, alphabetic = true)\n+@Since(\"1.10.5\")\n+@Summary(\"Changes the protection used for accessing graphs\")\n+@JsonInclude(Include.NON_DEFAULT)\n+public class ChangeGraphAccess implements Output<Boolean> {\n+    @Required\n+    private String graphId;\n+    private Set<String> graphAuths = new HashSet<>();\n+    private Map<String, String> options = new HashMap<>();\n+    private boolean isPublic = false;\n+    private boolean disabledByDefault = FederatedGraphStorage.DEFAULT_DISABLED_BY_DEFAULT;\n+\n+    private String ownerUserId;\n+\n+    public ChangeGraphAccess() {\n+        addOption(KEY_OPERATION_OPTIONS_GRAPH_IDS, \"\");\n+    }\n+\n+    public String getGraphId() {\n+        return graphId;\n+    }\n+\n+    public void setGraphId(final String graphId) {\n+        this.graphId = graphId;\n+    }\n+\n+    @Override\n+    public ChangeGraphAccess shallowClone() throws CloneFailedException {\n+        final Builder builder = new Builder()\n+                .graphId(graphId)\n+                .disabledByDefault(disabledByDefault)\n+                .options(this.options)\n+                .isPublic(this.isPublic)\n+                .ownerUserId(this.ownerUserId);\n+\n+        if (null != graphAuths) {\n+            builder.graphAuths(graphAuths.toArray(new String[graphAuths.size()]));\n+        }\n+\n+        return builder.build();\n+    }\n+\n+    public boolean isDisabledByDefault() {\n+        return disabledByDefault;\n+    }\n+\n+    public void setDisabledByDefault(final boolean disabledByDefault) {\n+        this.disabledByDefault = disabledByDefault;\n+    }\n+\n+    @Override\n+    public Map<String, String> getOptions() {\n+        return options;\n+    }\n+\n+    @Override\n+    public void setOptions(final Map<String, String> options) {\n+        this.options = options;\n+    }\n+\n+    public Set<String> getGraphAuths() {\n+        return graphAuths;\n+    }\n+\n+    public void setGraphAuths(final Set<String> graphAuths) {\n+        this.graphAuths = graphAuths;\n+    }\n+\n+    public void setIsPublic(final boolean isPublic) {\n+        this.isPublic = isPublic;\n+    }\n+\n+    public boolean getIsPublic() {\n+        return isPublic;\n+    }\n+\n+    public void setOwnerUserId(final String ownerUserId) {\n+        this.ownerUserId = ownerUserId;\n+    }\n+\n+    public String getOwnerUserId() {\n+        return this.ownerUserId;\n+    }\n+\n+    @Override\n+    public TypeReference<Boolean> getOutputTypeReference() {\n+        return new TypeReferenceImpl.Boolean();\n+    }\n+\n+    public abstract static class GraphBuilder<OP extends ChangeGraphAccess, B extends GraphBuilder<OP, ?>> extends BaseBuilder<OP, B> {", "originalCommit": "fa44598d37d6a08273bc64c818dbf4eb5e1cf463", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDU2ODU0Mw==", "url": "https://github.com/gchq/Gaffer/pull/2233#discussion_r370568543", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Copyright 2017-2019 Crown Copyright\n          \n          \n            \n             * Copyright 2020 Crown Copyright", "author": "d47853", "createdAt": "2020-01-24T10:35:11Z", "path": "store-implementation/federated-store/src/main/java/uk/gov/gchq/gaffer/federatedstore/operation/handler/impl/FederatedChangeGraphAccessHandler.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2017-2019 Crown Copyright", "originalCommit": "fa44598d37d6a08273bc64c818dbf4eb5e1cf463", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "74a1469acf66b2e3fea046f823e91eb06a6ffb0b", "url": "https://github.com/gchq/Gaffer/commit/74a1469acf66b2e3fea046f823e91eb06a6ffb0b", "message": "Merge branch 'gh-2226-Fedated-ChangeGraphAccess' of github.com:gchq/Gaffer into gh-2226-Fedated-ChangeGraphAccess", "committedDate": "2020-01-24T11:12:03Z", "type": "commit"}, {"oid": "74a1469acf66b2e3fea046f823e91eb06a6ffb0b", "url": "https://github.com/gchq/Gaffer/commit/74a1469acf66b2e3fea046f823e91eb06a6ffb0b", "message": "Merge branch 'gh-2226-Fedated-ChangeGraphAccess' of github.com:gchq/Gaffer into gh-2226-Fedated-ChangeGraphAccess", "committedDate": "2020-01-24T11:12:03Z", "type": "forcePushed"}, {"oid": "131894471afbf1b6b4f702028a36833e151f303c", "url": "https://github.com/gchq/Gaffer/commit/131894471afbf1b6b4f702028a36833e151f303c", "message": "gh-2226 tidy up builder and PR change", "committedDate": "2020-01-24T12:01:11Z", "type": "forcePushed"}, {"oid": "d310b561fab1aa7a8592ce7694c23597d306ec0f", "url": "https://github.com/gchq/Gaffer/commit/d310b561fab1aa7a8592ce7694c23597d306ec0f", "message": "gh-2226 tidy up builder and PR change", "committedDate": "2020-01-24T12:02:25Z", "type": "forcePushed"}, {"oid": "458e7bab813d3e1f8aaf9256a48bf71f40e02f0b", "url": "https://github.com/gchq/Gaffer/commit/458e7bab813d3e1f8aaf9256a48bf71f40e02f0b", "message": "gh-2226 tidy up builder and PR change", "committedDate": "2020-01-24T12:02:57Z", "type": "commit"}, {"oid": "458e7bab813d3e1f8aaf9256a48bf71f40e02f0b", "url": "https://github.com/gchq/Gaffer/commit/458e7bab813d3e1f8aaf9256a48bf71f40e02f0b", "message": "gh-2226 tidy up builder and PR change", "committedDate": "2020-01-24T12:02:57Z", "type": "forcePushed"}]}