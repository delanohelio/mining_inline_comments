{"pr_number": 58462, "pr_title": "Add error logging when http test fails", "pr_createdAt": "2020-06-24T00:46:38Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/58462", "timeline": [{"oid": "de68d0c2b3e9474c9fe314baa67e1c9b2ff236d9", "url": "https://github.com/elastic/elasticsearch/commit/de68d0c2b3e9474c9fe314baa67e1c9b2ff236d9", "message": "Add error logging when http test fails\n\nNetty4HttpServerTransportTests has started to fail intermittently. It\nseems like unexpected successful responses are being received when the\ntest is simulating errors. This commit adds logging to the test to\nprovide additional information when there is an unexpected success. It\nalso adds the logging to the nio http test.", "committedDate": "2020-06-24T00:44:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDYzMTQ5OA==", "url": "https://github.com/elastic/elasticsearch/pull/58462#discussion_r444631498", "bodyText": "I think this can be static and moved to somewhere in the test framework module?", "author": "original-brownbear", "createdAt": "2020-06-24T04:01:06Z", "path": "plugins/transport-nio/src/test/java/org/elasticsearch/http/nio/NioHttpServerTransportTests.java", "diffHunk": "@@ -370,4 +377,8 @@ public void dispatchBadRequest(final RestChannel channel,\n             }\n         }\n     }\n+\n+    private String requestToString(RestRequest restRequest) {", "originalCommit": "de68d0c2b3e9474c9fe314baa67e1c9b2ff236d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDYzMTYyNA==", "url": "https://github.com/elastic/elasticsearch/pull/58462#discussion_r444631624", "bodyText": "Maybe prefix the messages -->  like we do for other test logging?", "author": "original-brownbear", "createdAt": "2020-06-24T04:01:36Z", "path": "modules/transport-netty4/src/test/java/org/elasticsearch/http/netty4/Netty4HttpServerTransportTests.java", "diffHunk": "@@ -161,6 +162,7 @@ public void dispatchRequest(RestRequest request, RestChannel channel, ThreadCont\n \n             @Override\n             public void dispatchBadRequest(RestChannel channel, ThreadContext threadContext, Throwable cause) {\n+                logger.error(new ParameterizedMessage(\"Unexpected bad request [{}]\", requestToString(channel.request())), cause);", "originalCommit": "de68d0c2b3e9474c9fe314baa67e1c9b2ff236d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e4e3520fce1cf2dff4220a1b5723554a35d53bbc", "url": "https://github.com/elastic/elasticsearch/commit/e4e3520fce1cf2dff4220a1b5723554a35d53bbc", "message": "Changes", "committedDate": "2020-06-24T14:21:40Z", "type": "commit"}]}