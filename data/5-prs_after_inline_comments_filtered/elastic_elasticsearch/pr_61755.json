{"pr_number": 61755, "pr_title": "Backport all Painless compiler extensibility changes", "pr_createdAt": "2020-08-31T18:53:33Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/61755", "timeline": [{"oid": "c07866879c3eac6a0e5bcd82fff22d65f52af057", "url": "https://github.com/elastic/elasticsearch/commit/c07866879c3eac6a0e5bcd82fff22d65f52af057", "message": "response to pr comments", "committedDate": "2020-09-03T16:35:15Z", "type": "forcePushed"}, {"oid": "4e601f5c9e2d21fcfb21d79f834d066c1f2c6860", "url": "https://github.com/elastic/elasticsearch/commit/4e601f5c9e2d21fcfb21d79f834d066c1f2c6860", "message": "backport all compiler extensibility changes", "committedDate": "2020-09-14T15:48:16Z", "type": "commit"}, {"oid": "9baf1d6483527d88e401712d9a9e3d44b8b4a67f", "url": "https://github.com/elastic/elasticsearch/commit/9baf1d6483527d88e401712d9a9e3d44b8b4a67f", "message": "fix node ordering for string concatenation in compound assignment", "committedDate": "2020-09-14T15:48:16Z", "type": "commit"}, {"oid": "ae614ddb40c90fb8cefd3c7a0a86c867bff66118", "url": "https://github.com/elastic/elasticsearch/commit/ae614ddb40c90fb8cefd3c7a0a86c867bff66118", "message": "fix string concatenation", "committedDate": "2020-09-14T15:48:17Z", "type": "commit"}, {"oid": "9242a62d4eaed403af95851a1de12db5de531694", "url": "https://github.com/elastic/elasticsearch/commit/9242a62d4eaed403af95851a1de12db5de531694", "message": "response to pr comments", "committedDate": "2020-09-14T15:48:17Z", "type": "commit"}, {"oid": "9242a62d4eaed403af95851a1de12db5de531694", "url": "https://github.com/elastic/elasticsearch/commit/9242a62d4eaed403af95851a1de12db5de531694", "message": "response to pr comments", "committedDate": "2020-09-14T15:48:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg1ODYxOQ==", "url": "https://github.com/elastic/elasticsearch/pull/61755#discussion_r488858619", "bodyText": "This is line.isBlank() in master, should master be updated?", "author": "stu-elastic", "createdAt": "2020-09-15T17:54:59Z", "path": "modules/lang-painless/spi/src/main/java/org/elasticsearch/painless/spi/WhitelistLoader.java", "diffHunk": "@@ -460,11 +460,11 @@ public static Whitelist loadFromResourceFiles(Class<?> resource, Map<String, Whi\n \n         List<Object> annotations;\n \n-        line = line.trim();\n-\n-        if (line.isEmpty()) {\n+        if (\"\".equals(line.replaceAll(\"\\\\s+\",\"\"))) {", "originalCommit": "9242a62d4eaed403af95851a1de12db5de531694", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2OTY1OQ==", "url": "https://github.com/elastic/elasticsearch/pull/61755#discussion_r488869659", "bodyText": "isBlank isn't available in 8", "author": "jdconrad", "createdAt": "2020-09-15T18:15:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg1ODYxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2OTY5Ng==", "url": "https://github.com/elastic/elasticsearch/pull/61755#discussion_r488869696", "bodyText": "No, doesn't exist in 8.", "author": "stu-elastic", "createdAt": "2020-09-15T18:15:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg1ODYxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2MzAyOQ==", "url": "https://github.com/elastic/elasticsearch/pull/61755#discussion_r488863029", "bodyText": "Do we need to keep the 6.4 back compat code here?", "author": "stu-elastic", "createdAt": "2020-09-15T18:02:53Z", "path": "modules/lang-painless/src/main/java/org/elasticsearch/painless/action/PainlessExecuteAction.java", "diffHunk": "@@ -284,15 +284,8 @@ static Request parse(XContentParser parser) throws IOException {\n         Request(StreamInput in) throws IOException {\n             super(in);\n             script = new Script(in);\n-            if (in.getVersion().before(Version.V_6_4_0)) {", "originalCommit": "9242a62d4eaed403af95851a1de12db5de531694", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2OTc4NQ==", "url": "https://github.com/elastic/elasticsearch/pull/61755#discussion_r488869785", "bodyText": "Good catch. Will change back.", "author": "jdconrad", "createdAt": "2020-09-15T18:15:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2MzAyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2MzQ5NA==", "url": "https://github.com/elastic/elasticsearch/pull/61755#discussion_r488863494", "bodyText": "Do we need to keep the 6.4 back compat code here?", "author": "stu-elastic", "createdAt": "2020-09-15T18:03:50Z", "path": "modules/lang-painless/src/main/java/org/elasticsearch/painless/action/PainlessExecuteAction.java", "diffHunk": "@@ -328,12 +321,8 @@ public ActionRequestValidationException validate() {\n         public void writeTo(StreamOutput out) throws IOException {\n             super.writeTo(out);\n             script.writeTo(out);\n-            if (out.getVersion().before(Version.V_6_4_0)) {", "originalCommit": "9242a62d4eaed403af95851a1de12db5de531694", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2OTg1NA==", "url": "https://github.com/elastic/elasticsearch/pull/61755#discussion_r488869854", "bodyText": "Same as above.", "author": "jdconrad", "createdAt": "2020-09-15T18:15:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2MzQ5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg3MDAwOQ==", "url": "https://github.com/elastic/elasticsearch/pull/61755#discussion_r488870009", "bodyText": "After we get this into 7.x, let's fix these up in master to cleanup future backport.", "author": "stu-elastic", "createdAt": "2020-09-15T18:15:45Z", "path": "modules/lang-painless/spi/src/main/java/org/elasticsearch/painless/spi/WhitelistLoader.java", "diffHunk": "@@ -502,20 +502,20 @@ public static Whitelist loadFromResourceFiles(Class<?> resource, Map<String, Whi\n                         if (argumentKeyValue.length != 2) {\n                             throw new IllegalArgumentException(\"invalid annotation: expected key=\\\"value\\\" [\" + line + \"]\");\n                         }\n-                        \n+", "originalCommit": "9242a62d4eaed403af95851a1de12db5de531694", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUxMDA2OA==", "url": "https://github.com/elastic/elasticsearch/pull/61755#discussion_r489510068", "bodyText": "Agreed, we should just do an entire whitespace PR.", "author": "jdconrad", "createdAt": "2020-09-16T15:04:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg3MDAwOQ=="}], "type": "inlineReview"}, {"oid": "e752dad6717f154602f821d5d890aec393337828", "url": "https://github.com/elastic/elasticsearch/commit/e752dad6717f154602f821d5d890aec393337828", "message": "fix some changes", "committedDate": "2020-09-16T15:32:23Z", "type": "commit"}]}