{"pr_number": 57629, "pr_title": "Add default composable templates for new indexing strategy", "pr_createdAt": "2020-06-03T21:59:46Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/57629", "timeline": [{"oid": "9f3af21d17bbcae7216e9d02789734f48b20283d", "url": "https://github.com/elastic/elasticsearch/commit/9f3af21d17bbcae7216e9d02789734f48b20283d", "message": "Add default composable templates for new indexing strategy\n\nThis commit adds the component and composable templates, as well as ILM policies, for the new\ndefault indexing strategy. It installs:\n\n- logs-default-mappings (component)\n- logs-default-settings (component)\n- logs-default-policy (ilm policy)\n- logs-default-template (composable template)\n- metrics-default-mappings (component)\n- metrics-default-settings (component)\n- metrics-default-policy (ilm policy)\n- metrics-default-template (composable template)\n\nThese templates and policies are managed by a new x-pack module, `stack`, and can be disabled by\nsetting `stack.templates.enabled` to `false`.\n\nThese ensure that patterns for the `logs-*-*` and `metrics-*-*` indices are set up to create data\nstreams with the proper mappings and settings.\n\nThis also makes changes to the `IndexTemplateRegistry` to support installing component and\ncomposable templates (previously it supported only legacy templates).\n\nResolves #56709", "committedDate": "2020-06-03T21:52:55Z", "type": "commit"}, {"oid": "87b836fd3d229e8a087c602f6e7879cb8d990909", "url": "https://github.com/elastic/elasticsearch/commit/87b836fd3d229e8a087c602f6e7879cb8d990909", "message": "Merge branch 'master' into itv2-bundle-templates", "committedDate": "2020-06-03T22:28:09Z", "type": "commit"}, {"oid": "099c782ced2c9619ffcc3a48f88b39c9ce1a8efc", "url": "https://github.com/elastic/elasticsearch/commit/099c782ced2c9619ffcc3a48f88b39c9ce1a8efc", "message": "Add logs and metrics policies to list of expected x-pack policies", "committedDate": "2020-06-03T22:43:06Z", "type": "commit"}, {"oid": "a74934a70f389a2de703307fa8bd1dd932ceb375", "url": "https://github.com/elastic/elasticsearch/commit/a74934a70f389a2de703307fa8bd1dd932ceb375", "message": "Fix docs check", "committedDate": "2020-06-04T16:38:33Z", "type": "commit"}, {"oid": "266acf5d29a6ec309c16cadd93d083fa6ef709ae", "url": "https://github.com/elastic/elasticsearch/commit/266acf5d29a6ec309c16cadd93d083fa6ef709ae", "message": "Merge branch 'master' into itv2-bundle-templates", "committedDate": "2020-06-04T16:38:54Z", "type": "commit"}, {"oid": "73101067d2c89891100fbc8da043e1e959028f46", "url": "https://github.com/elastic/elasticsearch/commit/73101067d2c89891100fbc8da043e1e959028f46", "message": "Rename stream.* -> dataset.*", "committedDate": "2020-06-04T17:13:25Z", "type": "commit"}, {"oid": "7e891126a5665a07cbe55a8b2adbd84cbf84451c", "url": "https://github.com/elastic/elasticsearch/commit/7e891126a5665a07cbe55a8b2adbd84cbf84451c", "message": "Rename dataset.dataset -> dataset.name", "committedDate": "2020-06-04T17:13:25Z", "type": "commit"}, {"oid": "f249d7059d1fd5d47fbee3235f4b644cd6221345", "url": "https://github.com/elastic/elasticsearch/commit/f249d7059d1fd5d47fbee3235f4b644cd6221345", "message": "Remove non-\"ip\" fields under \"host\"", "committedDate": "2020-06-04T17:13:25Z", "type": "commit"}, {"oid": "dcdaa033752704e7942c7be56980cdce2ef5e127", "url": "https://github.com/elastic/elasticsearch/commit/dcdaa033752704e7942c7be56980cdce2ef5e127", "message": "Use default refresh interval for logs/metrics", "committedDate": "2020-06-04T17:13:25Z", "type": "commit"}, {"oid": "42f9f8c8468f297dabbb5d825969b5fe207a6667", "url": "https://github.com/elastic/elasticsearch/commit/42f9f8c8468f297dabbb5d825969b5fe207a6667", "message": "Use default number_of_routing_shards", "committedDate": "2020-06-04T17:13:25Z", "type": "commit"}, {"oid": "3a478d00e9ed1e4c390cfc98c5ae17f21edf5590", "url": "https://github.com/elastic/elasticsearch/commit/3a478d00e9ed1e4c390cfc98c5ae17f21edf5590", "message": "Merge remote-tracking branch 'origin/master' into itv2-bundle-templates", "committedDate": "2020-06-17T22:09:05Z", "type": "commit"}, {"oid": "f2f074134371471fcb92158fed5ff5d133316181", "url": "https://github.com/elastic/elasticsearch/commit/f2f074134371471fcb92158fed5ff5d133316181", "message": "Update mappings after discussion", "committedDate": "2020-06-17T22:11:34Z", "type": "commit"}, {"oid": "a6eeb48dc7e8512baae2b6a730a0f3bd3cf1a4fc", "url": "https://github.com/elastic/elasticsearch/commit/a6eeb48dc7e8512baae2b6a730a0f3bd3cf1a4fc", "message": "Update version constant and comment", "committedDate": "2020-06-17T22:18:26Z", "type": "commit"}, {"oid": "53feca5a6a186900d08ce826f616ab143793ece6", "url": "https://github.com/elastic/elasticsearch/commit/53feca5a6a186900d08ce826f616ab143793ece6", "message": "Fix index name in yaml test for master merge", "committedDate": "2020-06-17T23:09:02Z", "type": "commit"}, {"oid": "30e48a4930e3f4aa85967e3e4c249e1075f44ac7", "url": "https://github.com/elastic/elasticsearch/commit/30e48a4930e3f4aa85967e3e4c249e1075f44ac7", "message": "Merge branch 'master' into itv2-bundle-templates", "committedDate": "2020-06-24T16:54:53Z", "type": "commit"}, {"oid": "2b1b0186220c062d050afb9f107a02166137133c", "url": "https://github.com/elastic/elasticsearch/commit/2b1b0186220c062d050afb9f107a02166137133c", "message": "Remove unnecessary min_age from policies", "committedDate": "2020-06-24T16:55:20Z", "type": "commit"}, {"oid": "ce81e39a5f6d20e452193a5cdfd21cbf7397df05", "url": "https://github.com/elastic/elasticsearch/commit/ce81e39a5f6d20e452193a5cdfd21cbf7397df05", "message": "Fix gradle for master merge", "committedDate": "2020-06-24T17:14:03Z", "type": "commit"}, {"oid": "455fdfb20853a913893d1c678ac650d082fc4ce6", "url": "https://github.com/elastic/elasticsearch/commit/455fdfb20853a913893d1c678ac650d082fc4ce6", "message": "Reference changed name in YML test", "committedDate": "2020-06-24T18:26:21Z", "type": "commit"}, {"oid": "fd0247646c45c325974f9276027e34ef0439d675", "url": "https://github.com/elastic/elasticsearch/commit/fd0247646c45c325974f9276027e34ef0439d675", "message": "Rename templates and files", "committedDate": "2020-06-24T19:10:48Z", "type": "commit"}, {"oid": "897c645a3d593a7939c872b249a9c8f8aaa5c8f0", "url": "https://github.com/elastic/elasticsearch/commit/897c645a3d593a7939c872b249a9c8f8aaa5c8f0", "message": "Ugh spotless :|", "committedDate": "2020-06-24T19:18:30Z", "type": "commit"}, {"oid": "68f7898c96927cb7fbec7758ed8ccac7d36102b0", "url": "https://github.com/elastic/elasticsearch/commit/68f7898c96927cb7fbec7758ed8ccac7d36102b0", "message": "Add managed: true to settings component templates", "committedDate": "2020-06-24T21:10:58Z", "type": "commit"}, {"oid": "7a555eaaaaf963135d0d3f8544a347baa8ce942c", "url": "https://github.com/elastic/elasticsearch/commit/7a555eaaaaf963135d0d3f8544a347baa8ce942c", "message": "Don't clean up stack-installed templates", "committedDate": "2020-06-24T21:24:48Z", "type": "commit"}, {"oid": "d3c884406e2e71ebe1fbd33dd3bec49980ea97b5", "url": "https://github.com/elastic/elasticsearch/commit/d3c884406e2e71ebe1fbd33dd3bec49980ea97b5", "message": "Merge branch 'master' into itv2-bundle-templates", "committedDate": "2020-06-26T21:08:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU0NDUxMg==", "url": "https://github.com/elastic/elasticsearch/pull/57629#discussion_r447544512", "bodyText": "is this used anywhere?", "author": "andreidan", "createdAt": "2020-06-30T09:28:05Z", "path": "client/rest-high-level/src/main/java/org/elasticsearch/client/indices/PutComponentTemplateRequest.java", "diffHunk": "@@ -78,6 +78,10 @@ public PutComponentTemplateRequest componentTemplate(ComponentTemplate component\n         return this;\n     }\n \n+    public ComponentTemplate componentTemplate() {", "originalCommit": "d3c884406e2e71ebe1fbd33dd3bec49980ea97b5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcxMjg3NQ==", "url": "https://github.com/elastic/elasticsearch/pull/57629#discussion_r447712875", "bodyText": "I think this is a leftover, I'll remove it", "author": "dakrone", "createdAt": "2020-06-30T14:09:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU0NDUxMg=="}], "type": "inlineReview"}, {"oid": "e975700b84be417f4dfeddb3c7e5b862f14216a2", "url": "https://github.com/elastic/elasticsearch/commit/e975700b84be417f4dfeddb3c7e5b862f14216a2", "message": "Merge remote-tracking branch 'origin/master' into itv2-bundle-templates", "committedDate": "2020-06-30T14:08:33Z", "type": "commit"}, {"oid": "9991bed6b418ea0e3a803dd8d0a7170c07370572", "url": "https://github.com/elastic/elasticsearch/commit/9991bed6b418ea0e3a803dd8d0a7170c07370572", "message": "Remove unused componentTemplate getter", "committedDate": "2020-06-30T14:10:29Z", "type": "commit"}, {"oid": "36285abb957bf18848d7efb07257d4c110a73c10", "url": "https://github.com/elastic/elasticsearch/commit/36285abb957bf18848d7efb07257d4c110a73c10", "message": "Enable sub project in gradle", "committedDate": "2020-06-30T14:12:26Z", "type": "commit"}]}