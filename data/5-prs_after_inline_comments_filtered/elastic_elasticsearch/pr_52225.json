{"pr_number": 52225, "pr_title": "Wire up Value Count", "pr_createdAt": "2020-02-11T18:18:44Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/52225", "timeline": [{"oid": "001cb820fcdbb0dc29d7705f723c00a113f6136c", "url": "https://github.com/elastic/elasticsearch/commit/001cb820fcdbb0dc29d7705f723c00a113f6136c", "message": "Wire up Value Count", "committedDate": "2020-02-11T18:15:50Z", "type": "commit"}, {"oid": "272c1896a54eb49f11684f46b90734dc8a7b32dc", "url": "https://github.com/elastic/elasticsearch/commit/272c1896a54eb49f11684f46b90734dc8a7b32dc", "message": "fix checkstyle", "committedDate": "2020-02-11T19:02:50Z", "type": "commit"}, {"oid": "dd2b71a34480201de9153755fc3b3a38e9a20599", "url": "https://github.com/elastic/elasticsearch/commit/dd2b71a34480201de9153755fc3b3a38e9a20599", "message": "Merge branch 'feature/extensible-values-source' into vs-refactor-wire-up-value-count", "committedDate": "2020-02-12T14:39:37Z", "type": "commit"}, {"oid": "f2a0aa06c0e573b18dd5fcf58caf95aeef36c244", "url": "https://github.com/elastic/elasticsearch/commit/f2a0aa06c0e573b18dd5fcf58caf95aeef36c244", "message": "Fix naming mistake", "committedDate": "2020-02-19T18:23:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ5MTI0OQ==", "url": "https://github.com/elastic/elasticsearch/pull/52225#discussion_r381491249", "bodyText": "Out of curiosity, what would happen if an agg registered \"any\" as well as a specific type?", "author": "polyfractal", "createdAt": "2020-02-19T19:21:34Z", "path": "server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceRegistry.java", "diffHunk": "@@ -103,6 +103,19 @@ public void register(String aggregationName, List<ValuesSourceType> valuesSource\n         }, aggregatorSupplier);\n     }\n \n+    /**\n+     * Register an aggregator that applies to any values source type.  This is a convenience method for aggregations that do not care at all\n+     * about the types of their inputs.  Aggregations using this version of registration should not make any other registrations, as the", "originalCommit": "f2a0aa06c0e573b18dd5fcf58caf95aeef36c244", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTUyNzU2Nw==", "url": "https://github.com/elastic/elasticsearch/pull/52225#discussion_r381527567", "bodyText": "It's ordered, so if the aggregation called registerAny first, that would always be used.  Otherwise, it would have both.  Also, plugins are always registered after core, so if an aggregation calls registerAny in core, whatever a plugin registers for it will never be reached.\nregisterAny is really only intended to be used for things that are totally values source agnostic, like ValueCount here.  We could add some defense to reject the any if there's something already registered, but it's harder to check in the other direction.  I suppose we could add a flag for it, but that seems way too special case.", "author": "not-napoleon", "createdAt": "2020-02-19T20:32:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ5MTI0OQ=="}], "type": "inlineReview"}, {"oid": "ad000e3f71548b2a7cf84ea3ab09524e87189135", "url": "https://github.com/elastic/elasticsearch/commit/ad000e3f71548b2a7cf84ea3ab09524e87189135", "message": "Merge branch 'feature/extensible-values-source' into vs-refactor-wire-up-value-count", "committedDate": "2020-02-19T21:08:47Z", "type": "commit"}, {"oid": "065e0d46b2e3d6eeafcc88d7fef1a0491f1bc1e0", "url": "https://github.com/elastic/elasticsearch/commit/065e0d46b2e3d6eeafcc88d7fef1a0491f1bc1e0", "message": "Merge branch 'feature/extensible-values-source' into vs-refactor-wire-up-value-count", "committedDate": "2020-02-24T17:15:29Z", "type": "commit"}]}