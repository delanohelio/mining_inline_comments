{"pr_number": 62096, "pr_title": "[ML] adding feature_name and node size validation for tree models", "pr_createdAt": "2020-09-08T13:30:47Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/62096", "timeline": [{"oid": "de6ffcab9a8225244841fa6be63d1f7cbeacaa0d", "url": "https://github.com/elastic/elasticsearch/commit/de6ffcab9a8225244841fa6be63d1f7cbeacaa0d", "message": "[ML] adding feature_name and node size validation for tree models\n\nWhen a tree model is provided, it is possible that it is a stump.\nMeaning, it only has one node with no splits\nThis implies that the tree has no features. In this case,\nhaving zero feature_names is appropriate. In any other case,\nthis should be considered a validation failure.\n\nThis commit adds the validation if there is more than 1 node,\nthat the feature_names in the model are non-empty.", "committedDate": "2020-09-08T13:30:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA1ODgyNQ==", "url": "https://github.com/elastic/elasticsearch/pull/62096#discussion_r485058825", "bodyText": "Should we make this debug message take a runnable? I think it's called for each doc so it might be worth avoiding running all this if logging is not debug.", "author": "dimitris-athanasiou", "createdAt": "2020-09-08T16:44:40Z", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/inference/EnsembleInferenceModel.java", "diffHunk": "@@ -142,9 +132,7 @@ private InferenceResults innerInfer(double[] features, InferenceConfig config, M\n         if (preparedForInference == false) {\n             throw ExceptionsHelper.serverError(\"model is not prepared for inference\");\n         }\n-        LOGGER.debug(\"Inference called with feature names [{}]\",\n-            featureNames == null ? \"<null>\" : Strings.arrayToCommaDelimitedString(featureNames));\n-        assert featureNames != null && featureNames.length > 0;\n+        LOGGER.debug(\"Inference called with feature names [{}]\", Strings.arrayToCommaDelimitedString(featureNames));", "originalCommit": "de6ffcab9a8225244841fa6be63d1f7cbeacaa0d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA2MTg3NA==", "url": "https://github.com/elastic/elasticsearch/pull/62096#discussion_r485061874", "bodyText": "DEFINITELY! It should be a runnable.", "author": "benwtrent", "createdAt": "2020-09-08T16:50:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA1ODgyNQ=="}], "type": "inlineReview"}, {"oid": "b40ab7fd2de9b09e483d46b405c24db5f80ee9ca", "url": "https://github.com/elastic/elasticsearch/commit/b40ab7fd2de9b09e483d46b405c24db5f80ee9ca", "message": "making debug logs use message supplier interface", "committedDate": "2020-09-08T18:08:45Z", "type": "commit"}]}