{"pr_number": 60870, "pr_title": "Improve error message in case of invalid dynamic templates", "pr_createdAt": "2020-08-10T08:08:56Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/60870", "timeline": [{"oid": "b3eb3c7efdd0fe513f3cdfe8155bc2ae6be31d12", "url": "https://github.com/elastic/elasticsearch/commit/b3eb3c7efdd0fe513f3cdfe8155bc2ae6be31d12", "message": "Improve error message in case of invalid dynamic templates\n\nInclude the attempted 'match_mapping_type' into the message,\nso that it is clearer that multiple validation attempts have occurred.\n\nDynamic template validation was recently added via #51233 and\nthere was some confusion over the deprecation message itself.\n(in 7.x only deprecation warning will be omitted and from 8.0\n an error will be returned)", "committedDate": "2020-08-10T08:07:32Z", "type": "commit"}, {"oid": "97fa14f359e400fcdce3f70c8ac3f7bfdfd56608", "url": "https://github.com/elastic/elasticsearch/commit/97fa14f359e400fcdce3f70c8ac3f7bfdfd56608", "message": "checkstyle", "committedDate": "2020-08-10T08:23:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIzMTg3OQ==", "url": "https://github.com/elastic/elasticsearch/pull/60870#discussion_r483231879", "bodyText": "Don't error messages usually use square brackets around values rather than names? In other words, should there be square brackets around match_mapping_type?", "author": "danhermann", "createdAt": "2020-09-03T20:20:18Z", "path": "server/src/main/java/org/elasticsearch/index/mapper/RootObjectMapper.java", "diffHunk": "@@ -408,14 +409,16 @@ private static void validateDynamicTemplate(Mapper.TypeParser.ParserContext pars\n \n         final boolean failInvalidDynamicTemplates = parserContext.indexVersionCreated().onOrAfter(Version.V_8_0_0);\n         if (dynamicTemplateInvalid) {\n-            String message = String.format(Locale.ROOT, \"dynamic template [%s] has invalid content [%s]\",\n-                dynamicTemplate.getName(), Strings.toString(dynamicTemplate));\n+            String format = \"dynamic template [%s] has invalid content [%s], \" +\n+                \"attempted to validate it with the following [match_mapping_type]: [%s]\";", "originalCommit": "97fa14f359e400fcdce3f70c8ac3f7bfdfd56608", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjA3Njc5MQ==", "url": "https://github.com/elastic/elasticsearch/pull/60870#discussion_r522076791", "bodyText": "You're right, I don't think so.", "author": "martijnvg", "createdAt": "2020-11-12T12:41:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIzMTg3OQ=="}], "type": "inlineReview"}, {"oid": "a44c854d2703685664bd1a8af2bf7923fcc81b2c", "url": "https://github.com/elastic/elasticsearch/commit/a44c854d2703685664bd1a8af2bf7923fcc81b2c", "message": "Update RootObjectMapper.java", "committedDate": "2020-11-12T12:40:05Z", "type": "commit"}, {"oid": "1543b3ba40aa9f480a8a8d4ec51e9c61bf1278d0", "url": "https://github.com/elastic/elasticsearch/commit/1543b3ba40aa9f480a8a8d4ec51e9c61bf1278d0", "message": "Update RootObjectMapperTests.java", "committedDate": "2020-11-12T12:40:43Z", "type": "commit"}, {"oid": "c4ece4047e034a4540fb38976f5b85cbe3d591ca", "url": "https://github.com/elastic/elasticsearch/commit/c4ece4047e034a4540fb38976f5b85cbe3d591ca", "message": "Update docs/reference/mapping/dynamic/templates.asciidoc\n\nCo-authored-by: Dan Hermann <danhermann@users.noreply.github.com>", "committedDate": "2020-11-12T12:40:59Z", "type": "commit"}, {"oid": "9a39b9965e3645506bed1ac38afde4ec67c57370", "url": "https://github.com/elastic/elasticsearch/commit/9a39b9965e3645506bed1ac38afde4ec67c57370", "message": "Merge branch 'master' into improve_invalid_dynamic_template_error_message", "committedDate": "2020-11-12T12:42:06Z", "type": "commit"}]}