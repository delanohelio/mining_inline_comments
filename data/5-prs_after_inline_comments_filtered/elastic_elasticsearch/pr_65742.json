{"pr_number": 65742, "pr_title": "[Transform] fix intermittent test_usage failure", "pr_createdAt": "2020-12-02T13:45:56Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/65742", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE4MDMyNg==", "url": "https://github.com/elastic/elasticsearch/pull/65742#discussion_r534180326", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            // the trigger count can be off: e.g. if the scheduler kicked before usage has been called,\n          \n          \n            \n                            // the trigger count can be off: e.g. if the scheduler kicked in before usage has been called,", "author": "przemekwitek", "createdAt": "2020-12-02T13:50:08Z", "path": "x-pack/plugin/transform/qa/single-node-tests/src/javaRestTest/java/org/elasticsearch/xpack/transform/integration/TransformUsageIT.java", "diffHunk": "@@ -107,12 +103,14 @@ public void testUsage() throws Exception {\n             assertEquals(2, XContentMapValues.extractValue(\"transform.transforms.stopped\", statsMap));\n             assertEquals(1, XContentMapValues.extractValue(\"transform.transforms.started\", statsMap));\n             for (String statName : PROVIDED_STATS) {\n-                // the trigger count can be higher if the scheduler kicked before usage has been called, therefore check for gte\n+                // the trigger count can be off: e.g. if the scheduler kicked before usage has been called,", "originalCommit": "88cfcee47324f292db35647fa3a9a1104805a087", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE4MDQ0MQ==", "url": "https://github.com/elastic/elasticsearch/pull/65742#discussion_r534180441", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            // or if the the scheduler triggered later, but state hasn't been persisted (by design)\n          \n          \n            \n                            // or if the scheduler triggered later, but state hasn't been persisted (by design)", "author": "przemekwitek", "createdAt": "2020-12-02T13:50:18Z", "path": "x-pack/plugin/transform/qa/single-node-tests/src/javaRestTest/java/org/elasticsearch/xpack/transform/integration/TransformUsageIT.java", "diffHunk": "@@ -107,12 +103,14 @@ public void testUsage() throws Exception {\n             assertEquals(2, XContentMapValues.extractValue(\"transform.transforms.stopped\", statsMap));\n             assertEquals(1, XContentMapValues.extractValue(\"transform.transforms.started\", statsMap));\n             for (String statName : PROVIDED_STATS) {\n-                // the trigger count can be higher if the scheduler kicked before usage has been called, therefore check for gte\n+                // the trigger count can be off: e.g. if the scheduler kicked before usage has been called,\n+                // or if the the scheduler triggered later, but state hasn't been persisted (by design)", "originalCommit": "88cfcee47324f292db35647fa3a9a1104805a087", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a52a7242fac4f2fbddb577e26587bed246b1f23a", "url": "https://github.com/elastic/elasticsearch/commit/a52a7242fac4f2fbddb577e26587bed246b1f23a", "message": "relax test for trigger count, it might have been incremented but not persisted\n\nfixes #52931", "committedDate": "2020-12-02T14:06:09Z", "type": "commit"}, {"oid": "a52a7242fac4f2fbddb577e26587bed246b1f23a", "url": "https://github.com/elastic/elasticsearch/commit/a52a7242fac4f2fbddb577e26587bed246b1f23a", "message": "relax test for trigger count, it might have been incremented but not persisted\n\nfixes #52931", "committedDate": "2020-12-02T14:06:09Z", "type": "forcePushed"}, {"oid": "4cf5cb60a347428d5417eac8b0b3cebc63c9f89a", "url": "https://github.com/elastic/elasticsearch/commit/4cf5cb60a347428d5417eac8b0b3cebc63c9f89a", "message": "Update x-pack/plugin/transform/qa/single-node-tests/src/javaRestTest/java/org/elasticsearch/xpack/transform/integration/TransformUsageIT.java\n\nCo-authored-by: Przemys\u0142aw Witek <przemyslaw.witek@elastic.co>", "committedDate": "2020-12-02T14:34:52Z", "type": "commit"}, {"oid": "6d900bc4cf1b747a59a825f43aeae26f3119e17b", "url": "https://github.com/elastic/elasticsearch/commit/6d900bc4cf1b747a59a825f43aeae26f3119e17b", "message": "Update x-pack/plugin/transform/qa/single-node-tests/src/javaRestTest/java/org/elasticsearch/xpack/transform/integration/TransformUsageIT.java\n\nCo-authored-by: Przemys\u0142aw Witek <przemyslaw.witek@elastic.co>", "committedDate": "2020-12-02T14:35:02Z", "type": "commit"}]}