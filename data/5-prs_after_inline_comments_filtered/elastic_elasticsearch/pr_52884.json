{"pr_number": 52884, "pr_title": "EQL: Disable field extraction for source return", "pr_createdAt": "2020-02-27T12:31:53Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/52884", "timeline": [{"oid": "f012304cb5fa6411317b3626c222cd6914815703", "url": "https://github.com/elastic/elasticsearch/commit/f012304cb5fa6411317b3626c222cd6914815703", "message": "EQL: Disable field extraction for source return", "committedDate": "2020-02-27T12:28:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU2MDQ1NQ==", "url": "https://github.com/elastic/elasticsearch/pull/52884#discussion_r385560455", "bodyText": "The sortBuilder is still defined above. Needs removal? Also, the two comments above are not needed anymore.", "author": "astefan", "createdAt": "2020-02-28T08:19:26Z", "path": "x-pack/plugin/eql/src/main/java/org/elasticsearch/xpack/eql/execution/search/SourceGenerator.java", "diffHunk": "@@ -45,10 +45,7 @@ public static SearchSourceBuilder sourceBuilder(QueryContainer container, QueryB\n         // Iterate through all the columns requested, collecting the fields that\n         // need to be retrieved from the result documents\n \n-        // NB: the sortBuilder takes care of eliminating duplicates\n-        container.fields().forEach(f -> f.v1().collectFields(sortBuilder));\n-        sortBuilder.build(source);", "originalCommit": "f012304cb5fa6411317b3626c222cd6914815703", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU2NDEzNQ==", "url": "https://github.com/elastic/elasticsearch/pull/52884#discussion_r385564135", "bodyText": "I would add a comment here explaining the reason for 250 value (that value larger than the 100 doc_values limit in ES). Maybe take the default limit in ES and use here a value made of that limit + 100 or something like that?", "author": "astefan", "createdAt": "2020-02-28T08:29:36Z", "path": "client/rest-high-level/src/test/java/org/elasticsearch/client/EqlIT.java", "diffHunk": "@@ -61,4 +63,31 @@ public void testBasicSearch() throws Exception {\n         assertNotNull(response.hits().events());\n         assertThat(response.hits().events().size(), equalTo(1));\n     }\n+\n+    public void testLargeMapping() throws Exception {\n+        Request doc1 = new Request(HttpPut.METHOD_NAME, \"/index/_doc/1\");\n+\n+        String now = DateUtils.nowWithMillisResolution().format(DateTimeFormatter.ISO_DATE_TIME);\n+        StringBuilder sb = new StringBuilder();\n+        sb.append(\"{\");\n+        for (int i = 0; i < 250; i++) {", "originalCommit": "f012304cb5fa6411317b3626c222cd6914815703", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ffb90b0ed708c6e31df4fa51ce1aeaf5b94f3b99", "url": "https://github.com/elastic/elasticsearch/commit/ffb90b0ed708c6e31df4fa51ce1aeaf5b94f3b99", "message": "Address feedback", "committedDate": "2020-02-28T09:45:21Z", "type": "commit"}, {"oid": "5445289902e15887dec6802f72bd3a9c3a9adffd", "url": "https://github.com/elastic/elasticsearch/commit/5445289902e15887dec6802f72bd3a9c3a9adffd", "message": "Add comments", "committedDate": "2020-02-28T10:02:46Z", "type": "commit"}, {"oid": "0eed63ff43cfe8993eb1f90abb1a00d66fb54d32", "url": "https://github.com/elastic/elasticsearch/commit/0eed63ff43cfe8993eb1f90abb1a00d66fb54d32", "message": "Merge remote-tracking branch 'remotes/upstream/master' into eql/source-only", "committedDate": "2020-02-28T10:40:17Z", "type": "commit"}]}