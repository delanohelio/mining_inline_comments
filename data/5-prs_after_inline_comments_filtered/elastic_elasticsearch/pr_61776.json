{"pr_number": 61776, "pr_title": "Add support for runtime fields", "pr_createdAt": "2020-09-01T11:04:05Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/61776", "timeline": [{"oid": "2356d7d759d14fe0dde23230be3442eebb809522", "url": "https://github.com/elastic/elasticsearch/commit/2356d7d759d14fe0dde23230be3442eebb809522", "message": "Support format on runtime numbers (#61787)\n\nThis adds support for the `format` parameter on `long` and `double`\r\nvalued long fields. It only adds support for it in the request - in the\r\nmapping it is not yet supported.", "committedDate": "2020-09-01T14:30:14Z", "type": "commit"}, {"oid": "1ea67d29f66999b0bfde4973bc37dc7d8b026c73", "url": "https://github.com/elastic/elasticsearch/commit/1ea67d29f66999b0bfde4973bc37dc7d8b026c73", "message": "Add API test dependency\n\nRuntime fields needs to see the point in time api for its tests.", "committedDate": "2020-09-01T15:09:54Z", "type": "commit"}, {"oid": "34e576fd04cdcfa08fea1ddef3a65f34a142917d", "url": "https://github.com/elastic/elasticsearch/commit/34e576fd04cdcfa08fea1ddef3a65f34a142917d", "message": "Drop security policy from runtime fields\n\nWe had it for testing early on and forgot to remove it.", "committedDate": "2020-09-01T15:24:46Z", "type": "commit"}, {"oid": "d027a71555017b4ab35be3fa1e67169648a76abe", "url": "https://github.com/elastic/elasticsearch/commit/d027a71555017b4ab35be3fa1e67169648a76abe", "message": "Explicit tests for nested fields (#61761)\n\nAdds explicit tests for nested fields to the runtime fields project.\r\nAnd skip all of the core tests for nested fields. They don't really have\r\na chance of resolving the right fields from the source.", "committedDate": "2020-09-01T16:10:53Z", "type": "commit"}, {"oid": "c0802bbdddb63bea086334df095700efd17c90b3", "url": "https://github.com/elastic/elasticsearch/commit/c0802bbdddb63bea086334df095700efd17c90b3", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-09-01T18:11:04Z", "type": "commit"}, {"oid": "c9160612856b6cd01f13e4e720b9648e64d6cda5", "url": "https://github.com/elastic/elasticsearch/commit/c9160612856b6cd01f13e4e720b9648e64d6cda5", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-09-02T06:50:53Z", "type": "commit"}, {"oid": "0040a593b2c43b351298c2c2cae569b1dafd5c90", "url": "https://github.com/elastic/elasticsearch/commit/0040a593b2c43b351298c2c2cae569b1dafd5c90", "message": "Runtime fields to expose _source and stored fields like existing scripts (#61775)\n\nThis commit exposes stored fields to runtime fields (through params._fields) and replaces the current way to access _source (source['field']) in favour of the documented way for all existing scripts: params._source .", "committedDate": "2020-09-02T07:58:36Z", "type": "commit"}, {"oid": "d9ca982bad74966ed81d9f1c131f139a0f47956f", "url": "https://github.com/elastic/elasticsearch/commit/d9ca982bad74966ed81d9f1c131f139a0f47956f", "message": "Test DLS and FLS against runtime fields (#61820)\n\nThis commit introduces integration tests for Document level security with queries against runtime fields, as well as field level security used in combination with runtime fields.\r\n\r\nRelates to #59332", "committedDate": "2020-09-02T08:06:58Z", "type": "commit"}, {"oid": "a8ae54a0d836dd9250979e18bdebb92f6039382c", "url": "https://github.com/elastic/elasticsearch/commit/a8ae54a0d836dd9250979e18bdebb92f6039382c", "message": "Expand testing for field_caps and search across multiple indices (#61836)\n\nThis commit adds tests around field_caps and search against multiple indices, where one index has some fields defined as runtime fields, while another index has the same fields defined as concrete fields. We want to make sure that as long as the data type matches, the two can integrate seamlessly.\r\n\r\nRelates to #59332", "committedDate": "2020-09-02T12:57:49Z", "type": "commit"}, {"oid": "8ffa4d99d705268df3af38b9efbc07bd05d08e05", "url": "https://github.com/elastic/elasticsearch/commit/8ffa4d99d705268df3af38b9efbc07bd05d08e05", "message": "Expand max chain depth testing (#61833)\n\nThis commit extends the coverage around max chain depth in runtime fields. We test that direct references are not counted, that 5 references are allowed while 6 are not, and we test that the same error is returned no matter where the runtime field is used.\r\n\r\nRelates to #59332", "committedDate": "2020-09-02T12:58:04Z", "type": "commit"}, {"oid": "a16b08026c43854c8f3dc51d3aa0f87f93003196", "url": "https://github.com/elastic/elasticsearch/commit/a16b08026c43854c8f3dc51d3aa0f87f93003196", "message": "Runtime field: test currentTimeMillis\n\nAdds a test for `runtime_script` who's script contains\n`currentTimeMillis`.", "committedDate": "2020-09-02T18:13:55Z", "type": "commit"}, {"oid": "ecbed2c2b868bb59f679f03530aa3f423dbadf2a", "url": "https://github.com/elastic/elasticsearch/commit/ecbed2c2b868bb59f679f03530aa3f423dbadf2a", "message": "Add runtime fields plugin under x-pack", "committedDate": "2020-06-17T14:10:15Z", "type": "commit"}, {"oid": "7ab427997fcc25ecb91d033a33d5206d1b094098", "url": "https://github.com/elastic/elasticsearch/commit/7ab427997fcc25ecb91d033a33d5206d1b094098", "message": "Hack together some script contexts\n\nPut together some example script contexts for scripted fields. This is\nalmost certainly wrong, but it gets us something to think about.", "committedDate": "2020-06-17T23:40:54Z", "type": "commit"}, {"oid": "c6472787964658940f3a2800e9b3f918531a706d", "url": "https://github.com/elastic/elasticsearch/commit/c6472787964658940f3a2800e9b3f918531a706d", "message": "Scripted fields: rework script contexts (#58342)\n\nThis reworks the script contexts to support multiple values for each\r\nhit. Just like before, these are almost certainly not the final\r\nimplementation, but they give us something to iterate on.", "committedDate": "2020-06-18T20:20:40Z", "type": "commit"}, {"oid": "7d3597b4f2b94852ec5f5d9f99dd74d06dd2c22f", "url": "https://github.com/elastic/elasticsearch/commit/7d3597b4f2b94852ec5f5d9f99dd74d06dd2c22f", "message": "Spotless and maybe tests?", "committedDate": "2020-06-18T20:22:53Z", "type": "commit"}, {"oid": "cac5f29cee7572a3695e2b8d17d0a0cb7ac473dd", "url": "https://github.com/elastic/elasticsearch/commit/cac5f29cee7572a3695e2b8d17d0a0cb7ac473dd", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-06-26T14:33:37Z", "type": "commit"}, {"oid": "741a30fb7e16a68de9eab59dbf4f2ce1d3c7891f", "url": "https://github.com/elastic/elasticsearch/commit/741a30fb7e16a68de9eab59dbf4f2ce1d3c7891f", "message": "Fixup test case after merge\n\nPainless extensions work differently now.", "committedDate": "2020-06-26T15:00:56Z", "type": "commit"}, {"oid": "5011a736bccfcb9adb418608ba0c88c1794616f8", "url": "https://github.com/elastic/elasticsearch/commit/5011a736bccfcb9adb418608ba0c88c1794616f8", "message": "Get runtime fields tests passing\n\nUses a temporary hack to allow us to use painless in unit tests.", "committedDate": "2020-06-26T20:26:26Z", "type": "commit"}, {"oid": "59fc3d74d58c390828267569022ac177e77ffbd1", "url": "https://github.com/elastic/elasticsearch/commit/59fc3d74d58c390828267569022ac177e77ffbd1", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-02T10:25:49Z", "type": "commit"}, {"oid": "e833e8e09e331a512a1528f246610b834fa70bd8", "url": "https://github.com/elastic/elasticsearch/commit/e833e8e09e331a512a1528f246610b834fa70bd8", "message": "Scripted keyword field (#58939)\n\nThis is the first draft implementation of scripted field of type keyword. Still lots of TODOs to address, this PR targets a feature branch.", "committedDate": "2020-07-02T18:36:37Z", "type": "commit"}, {"oid": "2ba8e2e98bf4b7c54929c0a19046deba61951817", "url": "https://github.com/elastic/elasticsearch/commit/2ba8e2e98bf4b7c54929c0a19046deba61951817", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-06T08:42:47Z", "type": "commit"}, {"oid": "366ca378a8644d6654417988820c67f4feb714fe", "url": "https://github.com/elastic/elasticsearch/commit/366ca378a8644d6654417988820c67f4feb714fe", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-10T13:44:56Z", "type": "commit"}, {"oid": "949d1de0be1eef3062c617673bc5437f04934012", "url": "https://github.com/elastic/elasticsearch/commit/949d1de0be1eef3062c617673bc5437f04934012", "message": "adapt to upstream changes", "committedDate": "2020-07-10T13:53:47Z", "type": "commit"}, {"oid": "fa48ccd15f145a96e9a988d422dac58fdfbd839e", "url": "https://github.com/elastic/elasticsearch/commit/fa48ccd15f145a96e9a988d422dac58fdfbd839e", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-13T12:09:56Z", "type": "commit"}, {"oid": "265964863fbb163e72d8f181887da227dbbd5d4e", "url": "https://github.com/elastic/elasticsearch/commit/265964863fbb163e72d8f181887da227dbbd5d4e", "message": "Add term query for keyword script fields (#59372)\n\nThis adds what I think is just about the simplest possible `term` query\r\nimplementation for `keyword` script fields and wires it into the field\r\nmapper that we build for them.", "committedDate": "2020-07-13T21:23:03Z", "type": "commit"}, {"oid": "f426916b01a3aea836dddd4a820f640ed322f94d", "url": "https://github.com/elastic/elasticsearch/commit/f426916b01a3aea836dddd4a820f640ed322f94d", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-14T12:47:57Z", "type": "commit"}, {"oid": "4eb18b28f0677dcd4a47415d9a05007baecf6129", "url": "https://github.com/elastic/elasticsearch/commit/4eb18b28f0677dcd4a47415d9a05007baecf6129", "message": "Make ScriptFieldMapper a parameterized mapper (#59391)\n\nRelates to #59332", "committedDate": "2020-07-14T14:57:31Z", "type": "commit"}, {"oid": "46fcc5805e07fb6a73d70eef90f8bfdcd6ed7d05", "url": "https://github.com/elastic/elasticsearch/commit/46fcc5805e07fb6a73d70eef90f8bfdcd6ed7d05", "message": "Add tests for keyword script field's fielddata (#59523)\n\nAdds tests for the `keyword` typed `script` field's fielddata\r\nimplementation. One unit test which runs quickly and an integretion test\r\nfor fetching and an integration test for the `terms` agg.", "committedDate": "2020-07-14T18:42:08Z", "type": "commit"}, {"oid": "c9b9b73306c7b6cb1e7059b880c817c24d0647e5", "url": "https://github.com/elastic/elasticsearch/commit/c9b9b73306c7b6cb1e7059b880c817c24d0647e5", "message": "Two queries for keyword script field (#59527)\n\nThis adds the `exits` and `terms` query for the `keyword` style of\r\nscripted field.", "committedDate": "2020-07-14T19:46:13Z", "type": "commit"}, {"oid": "719ef1fe2c839b39e4f33806bd32e94674218607", "url": "https://github.com/elastic/elasticsearch/commit/719ef1fe2c839b39e4f33806bd32e94674218607", "message": "Remaining queries for script keyword fields (#59630)\n\nAdds the remaining queries for scripted keyword fields and handles a few\r\nleftover TODOs, mostly around `hashCode` and `equals`.", "committedDate": "2020-07-15T15:58:11Z", "type": "commit"}, {"oid": "9dd56fd1ce479f8cd68654fb38941d754ce23684", "url": "https://github.com/elastic/elasticsearch/commit/9dd56fd1ce479f8cd68654fb38941d754ce23684", "message": "Allow runtime fields to depend on one another (#59636)\n\nThis updates a test so that runtime fields depend on one another and\r\nfixes support for it.", "committedDate": "2020-07-15T18:19:10Z", "type": "commit"}, {"oid": "b5e9352e34866f37ed55cfd1f42807e82a9d5f91", "url": "https://github.com/elastic/elasticsearch/commit/b5e9352e34866f37ed55cfd1f42807e82a9d5f91", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-15T18:58:10Z", "type": "commit"}, {"oid": "30861e6b8782e9f40ca993c3624ed4ccb887fb3a", "url": "https://github.com/elastic/elasticsearch/commit/30861e6b8782e9f40ca993c3624ed4ccb887fb3a", "message": "Runtime fields: rework script service injection (#59659)\n\nInstead of relying no createComponents to get the script service, we rely on the query shard context supplier that's available in the parser context, yet we only carry around as callback that allows us to compile the script", "committedDate": "2020-07-15T20:50:36Z", "type": "commit"}, {"oid": "4ba86b1cb77e1478e5e197f07fbe5dfbe143844b", "url": "https://github.com/elastic/elasticsearch/commit/4ba86b1cb77e1478e5e197f07fbe5dfbe143844b", "message": "Mark all scripted field queries as expensive (#59658)\n\nThis will cause them to fail if you don't have permission to execute\r\nexpensive queries.", "committedDate": "2020-07-16T14:18:57Z", "type": "commit"}, {"oid": "4b288e72ca9bdcdc1097cd911dfa6c9164665ec0", "url": "https://github.com/elastic/elasticsearch/commit/4b288e72ca9bdcdc1097cd911dfa6c9164665ec0", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-17T08:27:10Z", "type": "commit"}, {"oid": "d4a724c9a0cb1d05513d2b5b9014d0b2cb793076", "url": "https://github.com/elastic/elasticsearch/commit/d4a724c9a0cb1d05513d2b5b9014d0b2cb793076", "message": "Temporarily awaits fix failing script mapper unit tests\n\nThere seems to be no longer a way to require a field in mapper paramaters. This needs to be fixed upstream.", "committedDate": "2020-07-17T09:20:43Z", "type": "commit"}, {"oid": "9d2d91ce5168dddb05616bba489ab9d351a41b99", "url": "https://github.com/elastic/elasticsearch/commit/9d2d91ce5168dddb05616bba489ab9d351a41b99", "message": "remove leftover printStackTrace", "committedDate": "2020-07-17T09:41:21Z", "type": "commit"}, {"oid": "bd1b2aeaea3e856f6beaa02f4b6d2566c6b5f2fd", "url": "https://github.com/elastic/elasticsearch/commit/bd1b2aeaea3e856f6beaa02f4b6d2566c6b5f2fd", "message": "Fix parsing unsupported runtime types error\n\nThe error was calling toString on the parameter object. we need to instead print out the returned value by calling getValue", "committedDate": "2020-07-17T09:49:42Z", "type": "commit"}, {"oid": "390fa6570f3819c6502acda97b02cafd2c41b9b6", "url": "https://github.com/elastic/elasticsearch/commit/390fa6570f3819c6502acda97b02cafd2c41b9b6", "message": "Scripted keyword field type: update family type and test field caps output (#59672)\n\nRelates to #59332", "committedDate": "2020-07-17T13:52:22Z", "type": "commit"}, {"oid": "45d0dc54c5335436a284e573449537f3c8c0921a", "url": "https://github.com/elastic/elasticsearch/commit/45d0dc54c5335436a284e573449537f3c8c0921a", "message": "Pass script params through to fielddata impl (#59762)\n\nThis addresses a TODO around using the script params, which are now parsed from the mappings. It also expand existing tests to verify that params are carried around and accessible in script for both fielddata and queries.\r\n\r\nRelates to #59332", "committedDate": "2020-07-17T14:48:23Z", "type": "commit"}, {"oid": "c8b5af91fc227e945f30bb91d262278c00548ddb", "url": "https://github.com/elastic/elasticsearch/commit/c8b5af91fc227e945f30bb91d262278c00548ddb", "message": "Add long flavored script field (#59721)\n\nThis adds the `long` runtime type to `script` fields and implements doc\r\nvalues, field data, the `term` and `exists` query.", "committedDate": "2020-07-17T19:33:19Z", "type": "commit"}, {"oid": "bdc2b16fcb61722bc1599daac706d9ec3aeb3e63", "url": "https://github.com/elastic/elasticsearch/commit/bdc2b16fcb61722bc1599daac706d9ec3aeb3e63", "message": "Render script params in script field xcontent (#59813)\n\nThis fixes the rendering of the `script` field in the `script` field\r\ntype. Originally we weren't rendering the `params` and such because we\r\ncouldn't parse them. But we can parse them now so we should render them.\r\n\r\nThis updates the integration tests to include params and adds an\r\nintegration test that fetches the mapping.", "committedDate": "2020-07-20T13:04:46Z", "type": "commit"}, {"oid": "2c5c478875ee5e7534a13fe8c88368602a7ff437", "url": "https://github.com/elastic/elasticsearch/commit/2c5c478875ee5e7534a13fe8c88368602a7ff437", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-20T14:44:31Z", "type": "commit"}, {"oid": "89ebf20a3c4f428fe6fe561f68f9a72de3c06a14", "url": "https://github.com/elastic/elasticsearch/commit/89ebf20a3c4f428fe6fe561f68f9a72de3c06a14", "message": "adapt to upstream changes", "committedDate": "2020-07-20T15:13:20Z", "type": "commit"}, {"oid": "9f5f3145a17e9ba19225fda46791fe3dc91d7595", "url": "https://github.com/elastic/elasticsearch/commit/9f5f3145a17e9ba19225fda46791fe3dc91d7595", "message": "Fielddata implementations to not implement IndexComponent\n\nRelates to #59724", "committedDate": "2020-07-20T15:22:04Z", "type": "commit"}, {"oid": "0589d2e0070506def5f46c3593ae1c7f6689e64e", "url": "https://github.com/elastic/elasticsearch/commit/0589d2e0070506def5f46c3593ae1c7f6689e64e", "message": "Remaining queries for long script field (#59816)\n\nAdds the `terms` and `range` queries for `long` typed `script` fields.\r\nIt also fixes a bug in a few of `toString` tests for `keyword` typed\r\n`script` fields.", "committedDate": "2020-07-20T16:03:16Z", "type": "commit"}, {"oid": "a0ef1ea961a59e9d7e702ca0d788f534143d7cd9", "url": "https://github.com/elastic/elasticsearch/commit/a0ef1ea961a59e9d7e702ca0d788f534143d7cd9", "message": "ScriptLongFieldData to extend LeafLongFieldData (#59884)\n\nRelates to #59332", "committedDate": "2020-07-21T10:15:37Z", "type": "commit"}, {"oid": "be44fc71c978661e0b831ed3363534d34a402f85", "url": "https://github.com/elastic/elasticsearch/commit/be44fc71c978661e0b831ed3363534d34a402f85", "message": "Remove unused doXContentBody impl from ScriptFieldMapper (#59969)\n\nRelates to #59332", "committedDate": "2020-07-21T14:56:45Z", "type": "commit"}, {"oid": "b81db2a39f88e302e59c4c01c084de8334f31f7e", "url": "https://github.com/elastic/elasticsearch/commit/b81db2a39f88e302e59c4c01c084de8334f31f7e", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-21T18:00:06Z", "type": "commit"}, {"oid": "26506c47a972f196c84b06220dba3f5892ba698d", "url": "https://github.com/elastic/elasticsearch/commit/26506c47a972f196c84b06220dba3f5892ba698d", "message": "Update doc values after merge", "committedDate": "2020-07-21T18:07:24Z", "type": "commit"}, {"oid": "bc3267b582259a1ac1ca986a6bdddc3280fbb444", "url": "https://github.com/elastic/elasticsearch/commit/bc3267b582259a1ac1ca986a6bdddc3280fbb444", "message": "Make full text queries work against keyword scripted fields (#59990)\n\nThe keyword scripted field should apply the keyword analyzer at all times, by providing it as part of TextSearchInfo to the base mapped field type class. That is because the field does not support normalization, and if we don't force the keyword analyzer the default search analyzer will get picked up which will lowercase the query etc.\r\n\r\nRelates to #59332", "committedDate": "2020-07-21T18:56:01Z", "type": "commit"}, {"oid": "8bddd840fa3653e2c6fba4e666a63a9c2f7a1c66", "url": "https://github.com/elastic/elasticsearch/commit/8bddd840fa3653e2c6fba4e666a63a9c2f7a1c66", "message": "Add double script fields (#59933)\n\nThis adds support for `double` typed `script` fields.", "committedDate": "2020-07-21T20:53:19Z", "type": "commit"}, {"oid": "5fcef9a90090b170ef0e963f3e3e56b6fdeaf2d9", "url": "https://github.com/elastic/elasticsearch/commit/5fcef9a90090b170ef0e963f3e3e56b6fdeaf2d9", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-22T10:29:36Z", "type": "commit"}, {"oid": "82392d89707a38902f8aefbd56b38c81d0732f32", "url": "https://github.com/elastic/elasticsearch/commit/82392d89707a38902f8aefbd56b38c81d0732f32", "message": "Adapt to upstream changes", "committedDate": "2020-07-22T10:36:38Z", "type": "commit"}, {"oid": "9d72854e4914099f035f170cbe9bfadbac0ce338", "url": "https://github.com/elastic/elasticsearch/commit/9d72854e4914099f035f170cbe9bfadbac0ce338", "message": "Replace script unit tests with integration tests (#60027)\n\nThis replaces the fancy unit tests that we were doing to test our\r\npainless integration with an extension to our existing integration\r\ntests. The integration tests are \"more real\", shorter, and are a nice\r\nstep down the road of dropping our dependency on the painless plugin in\r\nfavor of a dependency only on it's SPI.", "committedDate": "2020-07-22T17:58:38Z", "type": "commit"}, {"oid": "9adf29c0e20b2294879d2e6910ccc2f2d469be7c", "url": "https://github.com/elastic/elasticsearch/commit/9adf29c0e20b2294879d2e6910ccc2f2d469be7c", "message": "Drop some yml tests for script fields (#60079)\n\nWe have unit tests for all of these things and the other yml tests offer\r\ngood proof that these things work.", "committedDate": "2020-07-22T18:43:57Z", "type": "commit"}, {"oid": "9a3fa4218984df30ff55f6272558aa811fceefae", "url": "https://github.com/elastic/elasticsearch/commit/9a3fa4218984df30ff55f6272558aa811fceefae", "message": "Standardize script field's rejection error (#60029)\n\nThis standardizes the exception type thrown when attempting to build a\r\nquery on a script field that it doesn't support. It also replaces the\r\nfield type `[script]` in the error message with whatever the runtime type\r\nis.", "committedDate": "2020-07-22T18:44:24Z", "type": "commit"}, {"oid": "9b8bf0220d54e880510cd84208c097a3b9432b6b", "url": "https://github.com/elastic/elasticsearch/commit/9b8bf0220d54e880510cd84208c097a3b9432b6b", "message": "Rename script field type to runtime_script (#60083)", "committedDate": "2020-07-22T19:42:21Z", "type": "commit"}, {"oid": "ad3fb94077b677f8874a6c99a2ac9ca8eaca532f", "url": "https://github.com/elastic/elasticsearch/commit/ad3fb94077b677f8874a6c99a2ac9ca8eaca532f", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-23T12:49:59Z", "type": "commit"}, {"oid": "37a14180f21d7bf61f4b61ac3435cdf20f5e2eab", "url": "https://github.com/elastic/elasticsearch/commit/37a14180f21d7bf61f4b61ac3435cdf20f5e2eab", "message": "Replace painless unit tests with mock scripts (#60094)\n\nNow that we have good yml tests for runtime_script fields we don't need\r\npainless in our unit tests at all. This replaces painless with a mock\r\nscript which runs more quickly and isolates us from painless's\r\ninternals.", "committedDate": "2020-07-23T20:22:53Z", "type": "commit"}, {"oid": "bceb41ac889a3e6abd3f6294c85c70737d44bdb1", "url": "https://github.com/elastic/elasticsearch/commit/bceb41ac889a3e6abd3f6294c85c70737d44bdb1", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-27T09:46:04Z", "type": "commit"}, {"oid": "bf04ea7f5af6e08dc4722e7f9ea45a0e2e5d8585", "url": "https://github.com/elastic/elasticsearch/commit/bf04ea7f5af6e08dc4722e7f9ea45a0e2e5d8585", "message": "adapt to upstream changes", "committedDate": "2020-07-27T10:00:49Z", "type": "commit"}, {"oid": "9026770f2fb90df2b7a67227205d9301a37cff91", "url": "https://github.com/elastic/elasticsearch/commit/9026770f2fb90df2b7a67227205d9301a37cff91", "message": "Pass a SearchLookup supplier through to fielddataBuilder (#60224)\n\nRuntime fields depend on SearchLookup to be able to look up other fields and manipulate them. With this change we add a SearchLookup argument to the existing MappedFieldType#fielddataBuilder method. Additionally the use of runtime fields in index sorting is disallowed.\r\n\r\nRelates to #59332", "committedDate": "2020-07-27T20:17:02Z", "type": "commit"}, {"oid": "e3bbb3bed4ed9430ab43eb4a3e8276ae503c13ab", "url": "https://github.com/elastic/elasticsearch/commit/e3bbb3bed4ed9430ab43eb4a3e8276ae503c13ab", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-28T17:42:59Z", "type": "commit"}, {"oid": "cec7c136cdce3d3fee06dd53662cfcda6e4a9faf", "url": "https://github.com/elastic/elasticsearch/commit/cec7c136cdce3d3fee06dd53662cfcda6e4a9faf", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-29T08:53:40Z", "type": "commit"}, {"oid": "35ca3804e7ac353729bb553a7feddbe3479ea1d3", "url": "https://github.com/elastic/elasticsearch/commit/35ca3804e7ac353729bb553a7feddbe3479ea1d3", "message": "Add runtime_script date field (#60092)\n\nAdds support for `runtime_script` fields with `runtime_type: date`.\r\nDoesn't add support for the `format` parameter to the mapper but *does*\r\nsupport it on aggregations and the like. Its a start!", "committedDate": "2020-07-29T20:03:29Z", "type": "commit"}, {"oid": "28f6fd0c65a90e98ba536049b05cf263907cb947", "url": "https://github.com/elastic/elasticsearch/commit/28f6fd0c65a90e98ba536049b05cf263907cb947", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-07-31T08:33:40Z", "type": "commit"}, {"oid": "af9b302a7d5192e96602861b74e87e07ac86bb6d", "url": "https://github.com/elastic/elasticsearch/commit/af9b302a7d5192e96602861b74e87e07ac86bb6d", "message": "adapt to upstream changes", "committedDate": "2020-07-31T10:13:59Z", "type": "commit"}, {"oid": "e1cb3614923e1522823d9d40e7c51bb6ea0d0bf0", "url": "https://github.com/elastic/elasticsearch/commit/e1cb3614923e1522823d9d40e7c51bb6ea0d0bf0", "message": "Error on bad shape relations in runtime fields (#60463)\n\nMost core types throw back an error if the `relation` on a `range` query\r\nis `disjoint`. This make runtime fields do the same.", "committedDate": "2020-07-31T16:28:41Z", "type": "commit"}, {"oid": "0438030733a2c96b5407b3aa96ea42089e48b07c", "url": "https://github.com/elastic/elasticsearch/commit/0438030733a2c96b5407b3aa96ea42089e48b07c", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-08-03T08:23:37Z", "type": "commit"}, {"oid": "0e91859bd9ff7345a8b668d6f18724c4812353a2", "url": "https://github.com/elastic/elasticsearch/commit/0e91859bd9ff7345a8b668d6f18724c4812353a2", "message": "Format support for script doc fields (#60465)\n\nAdds `format` and `locale` support to `runtime_script` fields,\r\nspecifically those with the `runtime_type` of `date`. Others\r\n`runtime_type`s will return an error if provided with those parameters.", "committedDate": "2020-08-03T12:18:19Z", "type": "commit"}, {"oid": "b6e060976a96efb9e5ff2d6b5d0116d838370479", "url": "https://github.com/elastic/elasticsearch/commit/b6e060976a96efb9e5ff2d6b5d0116d838370479", "message": "Runtime script field mapper to reject copy_to and fields (#60580)\n\nMulti fields and copy_to are not supported by the runtime script field mapper. They are now rejected when provided.", "committedDate": "2020-08-03T13:32:40Z", "type": "commit"}, {"oid": "ce583aacd3619844ed2d4ed7a1a51ea913bbde99", "url": "https://github.com/elastic/elasticsearch/commit/ce583aacd3619844ed2d4ed7a1a51ea913bbde99", "message": "Fix build\n\nLooks like we lost a method that I was using in a test when merging\nmaster. Oops! This fixes the build and lets us move forward.", "committedDate": "2020-08-03T13:59:23Z", "type": "commit"}, {"oid": "45402118936d96100445723a849c869627cf1dc2", "url": "https://github.com/elastic/elasticsearch/commit/45402118936d96100445723a849c869627cf1dc2", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-08-05T20:58:53Z", "type": "commit"}, {"oid": "e98dfcc889379fac83c3a881843d72f2dc3b3277", "url": "https://github.com/elastic/elasticsearch/commit/e98dfcc889379fac83c3a881843d72f2dc3b3277", "message": "Implement runtime script ips (#60533)\n\nThis implements the `ip` typed runtime fields. They share a fair bit\r\nwith `string` runtime fields but we represent them as a `BytesRef`\r\ncontaining 128 bits so that the comparisons all happen in the same way\r\nas Lucene's `InetAddressPoint`.", "committedDate": "2020-08-05T21:19:03Z", "type": "commit"}, {"oid": "5e3ea6eb11c68bdcc9adda51715a6e1fea9186d6", "url": "https://github.com/elastic/elasticsearch/commit/5e3ea6eb11c68bdcc9adda51715a6e1fea9186d6", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-08-06T21:14:20Z", "type": "commit"}, {"oid": "9b9aa5fa451a161377bd365e2285c4683bf9d771", "url": "https://github.com/elastic/elasticsearch/commit/9b9aa5fa451a161377bd365e2285c4683bf9d771", "message": "Add the ScriptService to the field parser config (#60933)\n\nThis makes parsing runtime fields much simpler.\r\n\r\nWe'd initially resisted doing this but all of our other integration options\r\nproved more troublesome.", "committedDate": "2020-08-11T13:30:56Z", "type": "commit"}, {"oid": "fd8b557935c58913805044a03de3453e45ab0318", "url": "https://github.com/elastic/elasticsearch/commit/fd8b557935c58913805044a03de3453e45ab0318", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-08-11T14:44:55Z", "type": "commit"}, {"oid": "eeb4afbf672dbb1d8060eb93b205c4c2338888ca", "url": "https://github.com/elastic/elasticsearch/commit/eeb4afbf672dbb1d8060eb93b205c4c2338888ca", "message": "Run core's integration tests with runtime fields (#60931)\n\nAdds the `x-pack/plugin/runtime-fields/qa/rest` project to run core's\r\nintegration tests against an index with `runtime_scipt` fields. This\r\nworks by modifying the test configuration on load to replace supported\r\nfield types with `runtime_script`.\r\n\r\nRelates to #59332", "committedDate": "2020-08-11T16:17:48Z", "type": "commit"}, {"oid": "4a5d31771f4b3e357254abcc503c2bb4dfe69539", "url": "https://github.com/elastic/elasticsearch/commit/4a5d31771f4b3e357254abcc503c2bb4dfe69539", "message": "Some progress on failing runtime fields tests (#61098)\n\nThis breaks apart the a test for the `terms` aggregation into one that\r\nwork for runtime fields and one that doesn't.", "committedDate": "2020-08-13T14:46:24Z", "type": "commit"}, {"oid": "f3b65eb32c2a3d95572913d478af2168e2f763fb", "url": "https://github.com/elastic/elasticsearch/commit/f3b65eb32c2a3d95572913d478af2168e2f763fb", "message": "Implement distance_feature for runtime dates (#60851)\n\nThis implements the distance_feature for `date` valued `runtime_script`s.\r\nThis produces the same numbers running against an indexed date, but it\r\ndoesn't have the same performance characteristics at all. Which is normal\r\nfor `runtime_script`s`. But `distance_feature` against an indexes fields\r\ndoes a lot of work to refine the query as it goes, limiting the number of\r\ndocuments that it has to visit. We can't do that because we don't have an\r\nindex. So we just spit out the same numbers and hope it is good enough.", "committedDate": "2020-08-17T14:14:49Z", "type": "commit"}, {"oid": "76eb16e55ff59388bf40983045d6e6a15d4e8de1", "url": "https://github.com/elastic/elasticsearch/commit/76eb16e55ff59388bf40983045d6e6a15d4e8de1", "message": "Borrow more tests for runtime fields (#61113)\n\nThis \"borrows\" 150 more tests from core for runtime fields, extending\r\nthe work done in #60931. More precisely, it adds a template to every\r\ntest that forces dynamic mapping updates to build runtime fields where\r\npossible. In particular, `long` and `double` field are created as\r\nruntime fields. `string`-typed fields are mimick the out of the box\r\nbehavior and create a top level `text` field with a `.keyword`\r\nmulti-field, but this `keyword` multi-field executes a script and loads\r\nfrom source.", "committedDate": "2020-08-17T14:40:12Z", "type": "commit"}, {"oid": "1e631260efb8621958078aa16f5c9455df38d025", "url": "https://github.com/elastic/elasticsearch/commit/1e631260efb8621958078aa16f5c9455df38d025", "message": "Include boost in `distance_feature` query equals\n\nAdd `boost` to a scripted-`date`'s `distance_feature` query's equals\nmethod.", "committedDate": "2020-08-17T14:56:23Z", "type": "commit"}, {"oid": "99c885e5dad18c791ff91d03542abf85ad983ad7", "url": "https://github.com/elastic/elasticsearch/commit/99c885e5dad18c791ff91d03542abf85ad983ad7", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-08-17T17:34:59Z", "type": "commit"}, {"oid": "07bfa51ac703341238ca06e03022daa5f01b0c9a", "url": "https://github.com/elastic/elasticsearch/commit/07bfa51ac703341238ca06e03022daa5f01b0c9a", "message": "Add boolean values script fields (#60830)\n\nThis adds `boolean` values `runtime_script` fields.", "committedDate": "2020-08-17T17:40:27Z", "type": "commit"}, {"oid": "3870b6f1c78a4d5c1c28e4928f1ffd1f34fa1fd0", "url": "https://github.com/elastic/elasticsearch/commit/3870b6f1c78a4d5c1c28e4928f1ffd1f34fa1fd0", "message": "Add a consistent way to parse dates (#61105)\n\nThis adds a `parse` method to `date` valued `runtime_script`s that\r\nconverts any `Object` into a `long` using the same mechanism that\r\nindexing a `date` uses.\r\n\r\nWe also use this new method to expand our test that run's core's\r\nintegration tests against runtime fields to `date` values fields.\r\nPreviously we couldn't do that because we didn't have a consistent way\r\nto parse the field.", "committedDate": "2020-08-17T18:49:39Z", "type": "commit"}, {"oid": "b5e852490d4e907d7f618204e0d6149c5e54030a", "url": "https://github.com/elastic/elasticsearch/commit/b5e852490d4e907d7f618204e0d6149c5e54030a", "message": "Fix `value` method on ip scripts  (#61230)\n\nFixes `doc['ip'].value` when `ip` is a script field. It didn't work\r\nproperly before because it wasn't whitelisted. We can't whitelist it\r\neasilly because it was over in a module rather than core. This fixes\r\nthat by sharing more code with core that *is* whitelisted.", "committedDate": "2020-08-18T14:00:03Z", "type": "commit"}, {"oid": "40e3aecdc8b49d64eb17342fa215845a70195a7d", "url": "https://github.com/elastic/elasticsearch/commit/40e3aecdc8b49d64eb17342fa215845a70195a7d", "message": "Opt date valued script fields out of rate limit (#61238)\n\nThis excuses script fields from the script compilation rate limiting.\r\nIt'd be fairly sad to prevent mapping updates because of the rate limit.\r\nAnd we don't expect folks to add a zillion fields. On the other hand,\r\nonce we allow these scripts on the `_search` request we might indeed\r\nwant them to be considered in the limit. But we don't support that yet\r\nand we can deal with that when we get there.", "committedDate": "2020-08-18T19:47:41Z", "type": "commit"}, {"oid": "51a56b3ca83db40b4c2ebd84b95ccaf07af09387", "url": "https://github.com/elastic/elasticsearch/commit/51a56b3ca83db40b4c2ebd84b95ccaf07af09387", "message": "Drop compile limit on runtime fields scripts (#61297)\n\nThis opts all of the script contexts used by `runtime_script` our of the\r\ncompilation rate limiting because it'd be lame to prevent a mapping\r\nupdate because we can't compile the script.", "committedDate": "2020-08-19T13:06:19Z", "type": "commit"}, {"oid": "aa3f29fd7015865468e2629592f538f03ccf3ce6", "url": "https://github.com/elastic/elasticsearch/commit/aa3f29fd7015865468e2629592f538f03ccf3ce6", "message": "Fix wrong pipeline name in debug log (#58817)", "committedDate": "2020-08-24T11:44:41Z", "type": "commit"}, {"oid": "c5d00be0be0dde1269ceb8846ee8863f2bc00c29", "url": "https://github.com/elastic/elasticsearch/commit/c5d00be0be0dde1269ceb8846ee8863f2bc00c29", "message": "[DOCS] Update CCR docs to focus on Kibana (#60555)\n\n* First crack at rewriting the CCR introduction.\r\n\r\n* Emphasizing Kibana in configuring CCR (part one).\r\n\r\n* Many more edits, plus new files.\r\n\r\n* Fixing test case.\r\n\r\n* Removing overview page and consolidating that information in the main page.\r\n\r\n* Adding redirects for moved and deleted pages.\r\n\r\n* Removing, consolidating, and adding redirects.\r\n\r\n* Fixing duplicate ID in redirects and removing outdated reference.\r\n\r\n* Adding test case and steps for recreating a follower index.\r\n\r\n* Adding steps for managing CCR tasks in Kibana.\r\n\r\n* Adding tasks for managing auto-follow patterns.\r\n\r\n* Fixing glossary link.\r\n\r\n* Fixing glossary link, again.\r\n\r\n* Updating the upgrade information and other stuff.\r\n\r\n* Apply suggestions from code review\r\n\r\n* Incorporating review feedback.\r\n\r\n* Adding more edits.\r\n\r\n* Fixing link reference.\r\n\r\n* Adding use cases for #59812.\r\n\r\n* Incorporating feedback from reviewers.\r\n\r\n* Apply suggestions from code review\r\n\r\n* Incorporating more review comments.\r\n\r\n* Condensing some of the steps for accessing Kibana.\r\n\r\n* Incorporating small changes from reviewers.\r\n\r\nCo-authored-by: debadair <debadair@elastic.co>\r\nCo-authored-by: Elastic Machine <elasticmachine@users.noreply.github.com>", "committedDate": "2020-08-24T11:44:41Z", "type": "commit"}, {"oid": "32580d852127816272786614f639eb40e86cec88", "url": "https://github.com/elastic/elasticsearch/commit/32580d852127816272786614f639eb40e86cec88", "message": "Fix testConcurrentSnapshotDeleteAndDeleteIndex (#61228)\n\nThere is a corner case here in which during partial snapshot the index is\r\ndeleted right between starting the snapshot in the CS and the data node getting to work\r\non it, causing the data node the fail that shard snapshot and making the snapshot `PARTIAL`.\r\n\r\nCloses #61208", "committedDate": "2020-08-24T11:44:41Z", "type": "commit"}, {"oid": "5026fc71947380d6eb1eab71a8d0126b1ff61b26", "url": "https://github.com/elastic/elasticsearch/commit/5026fc71947380d6eb1eab71a8d0126b1ff61b26", "message": "Remove Unused ByteBufferReference (#61116)\n\nWe only work with heap byte buffers at this point and those we can and do unwrap the\r\n`byte[]` ourselves and use `BytesArray` instead of a needless level of indirection via `ByteBuffer`.", "committedDate": "2020-08-24T11:44:41Z", "type": "commit"}, {"oid": "876d81ea948735c5ae1196e09bbe518aa5579b44", "url": "https://github.com/elastic/elasticsearch/commit/876d81ea948735c5ae1196e09bbe518aa5579b44", "message": "Introduce ordering in the constant_keyword test for better predictibility. (#61248)", "committedDate": "2020-08-24T11:44:41Z", "type": "commit"}, {"oid": "8bd95cd52f5ce6b5da0d7df57a4cbba4e10065df", "url": "https://github.com/elastic/elasticsearch/commit/8bd95cd52f5ce6b5da0d7df57a4cbba4e10065df", "message": "Add UBI docker builds (#60742)\n\nThis PR resurrects support for building Docker images based on one of Red Hat's UBI images. It also adds support for\r\nrunning the existing Docker tests against the image. The image is named `elasticsearch-ubi8:<version>`.\r\n\r\nI also changed the Docker build file uses enums instead strings in a lot of places, for added rigour.", "committedDate": "2020-08-24T11:44:41Z", "type": "commit"}, {"oid": "b903a8fea202a2711355fae9318b3eb04dce5665", "url": "https://github.com/elastic/elasticsearch/commit/b903a8fea202a2711355fae9318b3eb04dce5665", "message": "[DOCS] Replaces ml.node with node.roles: [ ml ] in ML settings (#61017)", "committedDate": "2020-08-24T11:44:41Z", "type": "commit"}, {"oid": "6a9dde599f5fc11205e3f71f339a37bac9a259dc", "url": "https://github.com/elastic/elasticsearch/commit/6a9dde599f5fc11205e3f71f339a37bac9a259dc", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-08-24T12:15:41Z", "type": "commit"}, {"oid": "63d6ab24dc22b0aee0f38335039f0bb1657ec101", "url": "https://github.com/elastic/elasticsearch/commit/63d6ab24dc22b0aee0f38335039f0bb1657ec101", "message": "Revert visibility change to DocLookup constructor\n\nThis can remain package private", "committedDate": "2020-08-24T12:30:51Z", "type": "commit"}, {"oid": "e2dd0bde26e6c1f9f1a5137a5bf432d348e4205e", "url": "https://github.com/elastic/elasticsearch/commit/e2dd0bde26e6c1f9f1a5137a5bf432d348e4205e", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-08-24T17:10:47Z", "type": "commit"}, {"oid": "5858dcca5e1dd243fc45c747da2a0e2ac12040ab", "url": "https://github.com/elastic/elasticsearch/commit/5858dcca5e1dd243fc45c747da2a0e2ac12040ab", "message": "Cleanup after merge to feature/runtime_fields", "committedDate": "2020-08-24T17:19:31Z", "type": "commit"}, {"oid": "8818156dcb6ae34426e819ee87580e8327b4284f", "url": "https://github.com/elastic/elasticsearch/commit/8818156dcb6ae34426e819ee87580e8327b4284f", "message": "Drop single node test case from runtime fields (#61241)\n\nThis replaces the `ESSingleNodeTestCase` with `ESTestCase` in runtime\r\nfields, proving that we can use `ESTestCase` to test field mappers.", "committedDate": "2020-08-24T19:39:41Z", "type": "commit"}, {"oid": "6d8170c6a45d07b2658fe37659afd5fb8793fd5a", "url": "https://github.com/elastic/elasticsearch/commit/6d8170c6a45d07b2658fe37659afd5fb8793fd5a", "message": "Convert double script to return array (#61504)\n\nThis replaces the value collection method in `double` valued runtime\r\nscript fields with simply returning a `double[]`. Painless has some\r\n\"convert\" features that allow us to define automatic conversions from\r\nthings like `double` and `Collection` into `double[]` so we use those.", "committedDate": "2020-08-25T18:42:03Z", "type": "commit"}, {"oid": "0a3d3919a141e6e3c9bbddc43d046a4c9211b6be", "url": "https://github.com/elastic/elasticsearch/commit/0a3d3919a141e6e3c9bbddc43d046a4c9211b6be", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-08-27T12:29:24Z", "type": "commit"}, {"oid": "4a67e761a26c102ed598f037117f0655470de0b1", "url": "https://github.com/elastic/elasticsearch/commit/4a67e761a26c102ed598f037117f0655470de0b1", "message": "remove test that was moved and re-added while merging by mistake", "committedDate": "2020-08-27T13:51:48Z", "type": "commit"}, {"oid": "c9bd8c84d9856949e8ad0c2b429d565dc77972d6", "url": "https://github.com/elastic/elasticsearch/commit/c9bd8c84d9856949e8ad0c2b429d565dc77972d6", "message": "Test async and graph against runtime fields (#61651)\n\nThis runs the async search and graph tests against runtime fields.", "committedDate": "2020-08-27T20:08:23Z", "type": "commit"}, {"oid": "95cdff754e36808b6f0df99025b486603939fc1c", "url": "https://github.com/elastic/elasticsearch/commit/95cdff754e36808b6f0df99025b486603939fc1c", "message": "Revert \"Convert double script to return array (#61504)\"\n\nThis reverts commit 6d8170c6a45d07b2658fe37659afd5fb8793fd5a. We've\ndecided to stick with the `value` style functions for runtime fields.", "committedDate": "2020-08-31T14:52:41Z", "type": "commit"}, {"oid": "0284f3d1cfd14a6d32b0f91d530b14d56fe81ded", "url": "https://github.com/elastic/elasticsearch/commit/0284f3d1cfd14a6d32b0f91d530b14d56fe81ded", "message": "Standardize runtime field emit methods (#61752)\n\nThis standardizes that name for all of the \"emit value\" methods used by\r\nruntime field scripts to `emitValue`. To make dates possible this adds a\r\na `toEpochMilli` method to convert from `TemporalAccessor` into millis\r\nsince epoch.", "committedDate": "2020-08-31T21:57:41Z", "type": "commit"}, {"oid": "acfaccb715f714ebe92b478f9dd3cdfbe7b40228", "url": "https://github.com/elastic/elasticsearch/commit/acfaccb715f714ebe92b478f9dd3cdfbe7b40228", "message": "Adapt to upstream changes\n\nPossilby after #61457, the priority we use for the index template that converts core yaml tests to use runtime fields is already taken, which causes an error as there ma be multiple matching templates with same priority.", "committedDate": "2020-09-01T12:12:50Z", "type": "commit"}, {"oid": "d47d450baff4951da9379234a1b04d417b7ec6af", "url": "https://github.com/elastic/elasticsearch/commit/d47d450baff4951da9379234a1b04d417b7ec6af", "message": "Merge branch 'master' into feature/runtime_fields", "committedDate": "2020-09-01T12:12:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA5NjE1OQ==", "url": "https://github.com/elastic/elasticsearch/pull/61776#discussion_r481096159", "bodyText": "@nik9000  this does the job but I am not super proud of it. I guess this is caused by our matching pattern * but we have no way to say \"all indices but the system ones\", and I am not even sure that would work either. Thoughts?", "author": "javanna", "createdAt": "2020-09-01T12:23:11Z", "path": "x-pack/plugin/runtime-fields/qa/rest/src/yamlRestTest/java/org/elasticsearch/xpack/runtimefields/rest/CoreTestsWithRuntimeFieldsIT.java", "diffHunk": "@@ -239,7 +239,7 @@ public void execute(ClientYamlTestExecutionContext executionContext) throws IOEx\n             List<Map<String, Object>> bodies = List.of(\n                 Map.ofEntries(\n                     Map.entry(\"index_patterns\", \"*\"),\n-                    Map.entry(\"priority\", Integer.MAX_VALUE),\n+                    Map.entry(\"priority\", Integer.MAX_VALUE - 1),", "originalCommit": "acfaccb715f714ebe92b478f9dd3cdfbe7b40228", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEzMTc0OA==", "url": "https://github.com/elastic/elasticsearch/pull/61776#discussion_r481131748", "bodyText": "What was wrong? The tests were passing for me without it. I don't mind it - I just don't understand it yet.", "author": "nik9000", "createdAt": "2020-09-01T13:20:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA5NjE1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEzOTM1NQ==", "url": "https://github.com/elastic/elasticsearch/pull/61776#discussion_r481139355", "bodyText": "yea this came from merging master in today.  see acfaccb", "author": "javanna", "createdAt": "2020-09-01T13:31:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA5NjE1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE0MjY1OA==", "url": "https://github.com/elastic/elasticsearch/pull/61776#discussion_r481142658", "bodyText": "Gotcha. It makes sense. It's kind of a shame we don't override the internal templates too to prove that all of those also work with runtime fields but its cool.", "author": "nik9000", "createdAt": "2020-09-01T13:36:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA5NjE1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEzNDkxOA==", "url": "https://github.com/elastic/elasticsearch/pull/61776#discussion_r481134918", "bodyText": "I think I forgot to run these down. I'll add it to my list. But I don't think it blocks merging. We may just never need these to be honest.", "author": "nik9000", "createdAt": "2020-09-01T13:25:16Z", "path": "server/src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionBuilder.java", "diffHunk": "@@ -210,6 +210,7 @@ private AbstractDistanceScoreFunction parseVariable(String fieldName, XContentPa\n \n         // dates and time and geo need special handling\n         parser.nextToken();\n+        // TODO these ain't gonna work with runtime fields", "originalCommit": "d47d450baff4951da9379234a1b04d417b7ec6af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE2MjA2NQ==", "url": "https://github.com/elastic/elasticsearch/pull/61776#discussion_r481162065", "bodyText": "I don't think it is worth the effort. I reviewed the leftover TODOs and I am fine with this one staying there.", "author": "javanna", "createdAt": "2020-09-01T14:04:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEzNDkxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE2Mjk2OQ==", "url": "https://github.com/elastic/elasticsearch/pull/61776#discussion_r481162969", "bodyText": "++", "author": "nik9000", "createdAt": "2020-09-01T14:05:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEzNDkxOA=="}], "type": "inlineReview"}]}