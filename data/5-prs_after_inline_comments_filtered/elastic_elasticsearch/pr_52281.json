{"pr_number": 52281, "pr_title": "QL: Extract common Failure class", "pr_createdAt": "2020-02-12T18:22:33Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/52281", "timeline": [{"oid": "73a33810a25f8c017ae47a512f994e5c881eb0d3", "url": "https://github.com/elastic/elasticsearch/commit/73a33810a25f8c017ae47a512f994e5c881eb0d3", "message": "QL: Extract common Failure class\n\nShared across SQL and EQL", "committedDate": "2020-02-12T18:01:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQzMDkyNQ==", "url": "https://github.com/elastic/elasticsearch/pull/52281#discussion_r378430925", "bodyText": "This is done on purpose so that Failures on the same node get collapsed:\nLine 1:15 ...\nLine 1:15...\nSo far all Failures are related and it's easier to just have one overall.", "author": "costin", "createdAt": "2020-02-12T18:24:03Z", "path": "x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/common/Failure.java", "diffHunk": "@@ -50,7 +50,7 @@ public boolean equals(Object obj) {\n         }\n \n         Failure other = (Failure) obj;\n-        return Objects.equals(message, other.message) && Objects.equals(node, other.node);\n+        return Objects.equals(node, other.node);", "originalCommit": "73a33810a25f8c017ae47a512f994e5c881eb0d3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODUwODE0Ng==", "url": "https://github.com/elastic/elasticsearch/pull/52281#discussion_r378508146", "bodyText": "Is this necessary?", "author": "matriv", "createdAt": "2020-02-12T20:57:19Z", "path": "x-pack/plugin/sql/src/test/java/org/elasticsearch/xpack/sql/execution/search/QuerierTests.java", "diffHunk": "@@ -87,7 +87,7 @@ public void testAggSorting_TwoFields_One_Presorted() {\n \n     @SuppressWarnings({\"rawtypes\", \"unchecked\"})\n     public void testAggSorting_FourFields() {\n-        List<Comparator> comparators = Arrays.asList(\n+        List<Comparator> comparators = Arrays.<Comparator> asList(", "originalCommit": "73a33810a25f8c017ae47a512f994e5c881eb0d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODgwMjgxNA==", "url": "https://github.com/elastic/elasticsearch/pull/52281#discussion_r378802814", "bodyText": "It is in Eclipse ...", "author": "costin", "createdAt": "2020-02-13T11:25:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODUwODE0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODUwOTIxNw==", "url": "https://github.com/elastic/elasticsearch/pull/52281#discussion_r378509217", "bodyText": "The hierarchy feels a bit unnatural: a verification exception in analysis phase is a subclass of SqlClientException.", "author": "matriv", "createdAt": "2020-02-12T20:59:40Z", "path": "x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/analysis/analyzer/VerificationException.java", "diffHunk": "@@ -5,31 +5,20 @@\n  */\n package org.elasticsearch.xpack.sql.analysis.analyzer;\n \n-import org.elasticsearch.xpack.ql.tree.Location;\n-import org.elasticsearch.xpack.ql.util.StringUtils;\n-import org.elasticsearch.xpack.sql.analysis.AnalysisException;\n-import org.elasticsearch.xpack.sql.analysis.analyzer.Verifier.Failure;\n+import org.elasticsearch.rest.RestStatus;\n+import org.elasticsearch.xpack.ql.common.Failure;\n+import org.elasticsearch.xpack.sql.SqlClientException;\n \n import java.util.Collection;\n-import java.util.stream.Collectors;\n \n-\n-public class VerificationException extends AnalysisException {\n-\n-    private final Collection<Failure> failures;\n+public class VerificationException extends SqlClientException {", "originalCommit": "73a33810a25f8c017ae47a512f994e5c881eb0d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODgwMzYwNA==", "url": "https://github.com/elastic/elasticsearch/pull/52281#discussion_r378803604", "bodyText": "AnalysisException, which was not used anywhere, was extending SqlClientException.\nWhich is what VerificationException does now...", "author": "costin", "createdAt": "2020-02-13T11:27:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODUwOTIxNw=="}], "type": "inlineReview"}]}