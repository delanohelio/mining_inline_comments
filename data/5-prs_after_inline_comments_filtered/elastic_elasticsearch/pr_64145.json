{"pr_number": 64145, "pr_title": "Expose the list of completed ranges in SparseFileTracker", "pr_createdAt": "2020-10-26T10:02:14Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/64145", "timeline": [{"oid": "3ba477d8e64ffc3461f2713a27d13a562a6325fa", "url": "https://github.com/elastic/elasticsearch/commit/3ba477d8e64ffc3461f2713a27d13a562a6325fa", "message": "Expose the list of completed ranges in SparseFileTracker", "committedDate": "2020-10-26T09:59:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg3MzE1MA==", "url": "https://github.com/elastic/elasticsearch/pull/64145#discussion_r511873150", "bodyText": "Random NIT/Question: why use a LinkedList for this, seems if we're actually worried about this running so often that it'll be tricky on the GC ArrayList would perform more predictably and is what we generally use for this type of spot?", "author": "original-brownbear", "createdAt": "2020-10-26T10:54:19Z", "path": "x-pack/plugin/searchable-snapshots/src/main/java/org/elasticsearch/index/store/cache/SparseFileTracker.java", "diffHunk": "@@ -49,6 +50,23 @@ public long getLength() {\n         return length;\n     }\n \n+    public List<Tuple<Long, Long>> getCompletedRanges() {\n+        List<Tuple<Long, Long>> completedRanges = null;\n+        synchronized (mutex) {\n+            assert invariant();\n+            for (Range range : ranges) {\n+                if (range.isPending()) {\n+                    continue;\n+                }\n+                if (completedRanges == null) {", "originalCommit": "3ba477d8e64ffc3461f2713a27d13a562a6325fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTkzMzA1MQ==", "url": "https://github.com/elastic/elasticsearch/pull/64145#discussion_r511933051", "bodyText": "Agreed, that's what we usually use, I changed that.", "author": "tlrx", "createdAt": "2020-10-26T12:47:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg3MzE1MA=="}], "type": "inlineReview"}, {"oid": "231f3b70981e11ec70962812e82c634ddc97e763", "url": "https://github.com/elastic/elasticsearch/commit/231f3b70981e11ec70962812e82c634ddc97e763", "message": "ArrayList", "committedDate": "2020-10-26T12:39:52Z", "type": "commit"}, {"oid": "ff90666df182f6460d24d1b4c1c1e1fb089cf8b1", "url": "https://github.com/elastic/elasticsearch/commit/ff90666df182f6460d24d1b4c1c1e1fb089cf8b1", "message": "Merge branch 'master' into expose-completed-ranges", "committedDate": "2020-10-26T12:40:14Z", "type": "commit"}]}