{"pr_number": 52179, "pr_title": "Fix delete enrich policy bug", "pr_createdAt": "2020-02-11T04:17:23Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/52179", "timeline": [{"oid": "34a68ca0edeecaf075f3991150afa21a4f8e8c86", "url": "https://github.com/elastic/elasticsearch/commit/34a68ca0edeecaf075f3991150afa21a4f8e8c86", "message": "Fix bug for deleting enrich policy", "committedDate": "2020-02-11T03:56:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTUxNjk0Mw==", "url": "https://github.com/elastic/elasticsearch/pull/52179#discussion_r379516943", "bodyText": "Maybe add a comment here why the delete enrich index api can't rely on just deleting all the enrich indices by a wildcard index expression?", "author": "martijnvg", "createdAt": "2020-02-14T16:13:05Z", "path": "x-pack/plugin/enrich/src/main/java/org/elasticsearch/xpack/enrich/action/TransportDeleteEnrichPolicyAction.java", "diffHunk": "@@ -128,7 +129,12 @@ protected void masterOperation(\n             return;\n         }\n \n-        deleteIndicesAndPolicy(request.getName(), ActionListener.wrap((response) -> {\n+        GetIndexRequest indices = new GetIndexRequest().indices(EnrichPolicy.getBaseName(request.getName()) + \"-*\")", "originalCommit": "34a68ca0edeecaf075f3991150afa21a4f8e8c86", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg4MTkzMg==", "url": "https://github.com/elastic/elasticsearch/pull/52179#discussion_r379881932", "bodyText": "OK, I have done that.", "author": "gaobinlong", "createdAt": "2020-02-16T07:37:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTUxNjk0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDAyNjgwOA==", "url": "https://github.com/elastic/elasticsearch/pull/52179#discussion_r380026808", "bodyText": "thank you!", "author": "martijnvg", "createdAt": "2020-02-17T07:55:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTUxNjk0Mw=="}], "type": "inlineReview"}, {"oid": "9c043f105af918aa38c05ccdf3da98037c3c8ed3", "url": "https://github.com/elastic/elasticsearch/commit/9c043f105af918aa38c05ccdf3da98037c3c8ed3", "message": "add a comment for deleting enrich index", "committedDate": "2020-02-16T07:34:31Z", "type": "commit"}, {"oid": "204a326da21a037191706cbf48e0fa76b4c3d639", "url": "https://github.com/elastic/elasticsearch/commit/204a326da21a037191706cbf48e0fa76b4c3d639", "message": "Merge remote-tracking branch 'origin/master' into patch#51228", "committedDate": "2020-02-16T07:35:18Z", "type": "commit"}, {"oid": "ea45f4706ebfc7b6bab0962d577d3930282f4781", "url": "https://github.com/elastic/elasticsearch/commit/ea45f4706ebfc7b6bab0962d577d3930282f4781", "message": "Merge remote-tracking branch 'origin/master' into patch#51228", "committedDate": "2020-02-17T12:31:19Z", "type": "commit"}, {"oid": "3a08a737c60aaea1444870b50e130ab7c626408e", "url": "https://github.com/elastic/elasticsearch/commit/3a08a737c60aaea1444870b50e130ab7c626408e", "message": "format code", "committedDate": "2020-02-17T12:52:21Z", "type": "commit"}]}