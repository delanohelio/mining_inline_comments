{"pr_number": 57721, "pr_title": "Change default backing index naming scheme", "pr_createdAt": "2020-06-05T12:31:02Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/57721", "timeline": [{"oid": "aae7975b52eb72ddea550a3dbdaa63c60cb0d730", "url": "https://github.com/elastic/elasticsearch/commit/aae7975b52eb72ddea550a3dbdaa63c60cb0d730", "message": "Change default backing index naming scheme", "committedDate": "2020-06-05T12:27:37Z", "type": "commit"}, {"oid": "8973e04ad0ba7f3a25777dd3ebe3f7c99bab96b7", "url": "https://github.com/elastic/elasticsearch/commit/8973e04ad0ba7f3a25777dd3ebe3f7c99bab96b7", "message": "Merge branch 'master' into change_backing_index_names", "committedDate": "2020-06-05T12:54:14Z", "type": "commit"}, {"oid": "94867871f7bc68ee7723ea4e66d593c965c97712", "url": "https://github.com/elastic/elasticsearch/commit/94867871f7bc68ee7723ea4e66d593c965c97712", "message": "fix ILM tests", "committedDate": "2020-06-05T13:15:29Z", "type": "commit"}, {"oid": "56fd4731d3505d97614459527a662930c6ea2bad", "url": "https://github.com/elastic/elasticsearch/commit/56fd4731d3505d97614459527a662930c6ea2bad", "message": "fix yaml tests", "committedDate": "2020-06-05T20:26:50Z", "type": "commit"}, {"oid": "54d9078e1134a8bfe1151c1a61164325c6870709", "url": "https://github.com/elastic/elasticsearch/commit/54d9078e1134a8bfe1151c1a61164325c6870709", "message": "more YAML test fixes", "committedDate": "2020-06-05T21:03:27Z", "type": "commit"}, {"oid": "e25893015e4eb46dabfa64ff0214d3749d761c2f", "url": "https://github.com/elastic/elasticsearch/commit/e25893015e4eb46dabfa64ff0214d3749d761c2f", "message": "more YAML test fixes", "committedDate": "2020-06-05T21:25:59Z", "type": "commit"}, {"oid": "3feebe4d59d1e00523bf08266057e48f0a43e6fe", "url": "https://github.com/elastic/elasticsearch/commit/3feebe4d59d1e00523bf08266057e48f0a43e6fe", "message": "another test fix", "committedDate": "2020-06-05T22:17:43Z", "type": "commit"}, {"oid": "07d8c787c4f65993bdc52929e989ceef8a7a0b94", "url": "https://github.com/elastic/elasticsearch/commit/07d8c787c4f65993bdc52929e989ceef8a7a0b94", "message": "more test fixes", "committedDate": "2020-06-06T14:59:03Z", "type": "commit"}, {"oid": "590b9cf34404222fe71a328b314a6c0f35ceb52d", "url": "https://github.com/elastic/elasticsearch/commit/590b9cf34404222fe71a328b314a6c0f35ceb52d", "message": "docs and test fixes", "committedDate": "2020-06-06T16:03:03Z", "type": "commit"}, {"oid": "9fddbf9305e529b21de85731ce594f7a68aefaa0", "url": "https://github.com/elastic/elasticsearch/commit/9fddbf9305e529b21de85731ce594f7a68aefaa0", "message": "more doc fixes", "committedDate": "2020-06-06T16:09:09Z", "type": "commit"}, {"oid": "d2ae87ed954383501001b699ec6768b9867d56b7", "url": "https://github.com/elastic/elasticsearch/commit/d2ae87ed954383501001b699ec6768b9867d56b7", "message": "yet more doc fixes", "committedDate": "2020-06-06T17:14:45Z", "type": "commit"}, {"oid": "0c803082b7a879324a26d64797d8160d89f092a9", "url": "https://github.com/elastic/elasticsearch/commit/0c803082b7a879324a26d64797d8160d89f092a9", "message": "Merge branch 'master' into change_backing_index_names", "committedDate": "2020-06-06T18:22:02Z", "type": "commit"}, {"oid": "9d979dc167b048151ec70783b8259742fe762b92", "url": "https://github.com/elastic/elasticsearch/commit/9d979dc167b048151ec70783b8259742fe762b92", "message": "fix new YAML test", "committedDate": "2020-06-06T18:37:35Z", "type": "commit"}, {"oid": "da2cc2b04b83822b0400cd7603ab14f29e23aec4", "url": "https://github.com/elastic/elasticsearch/commit/da2cc2b04b83822b0400cd7603ab14f29e23aec4", "message": "test fix", "committedDate": "2020-06-06T19:00:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM2NzYwMA==", "url": "https://github.com/elastic/elasticsearch/pull/57721#discussion_r436367600", "bodyText": "Maybe turn .ds- into a constant?", "author": "martijnvg", "createdAt": "2020-06-07T14:14:19Z", "path": "server/src/main/java/org/elasticsearch/cluster/metadata/DataStream.java", "diffHunk": "@@ -101,15 +101,15 @@ public DataStream removeBackingIndex(Index index) {\n     }\n \n     /**\n-     * Generates the name of the index that conforms to the naming convention for backing indices\n+     * Generates the name of the index that conforms to the default naming convention for backing indices\n      * on data streams given the specified data stream name and generation.\n      *\n      * @param dataStreamName name of the data stream\n      * @param generation generation of the data stream\n      * @return backing index name\n      */\n-    public static String getBackingIndexName(String dataStreamName, long generation) {\n-        return String.format(Locale.ROOT, \"%s-%06d\", dataStreamName, generation);\n+    public static String getDefaultBackingIndexName(String dataStreamName, long generation) {\n+        return String.format(Locale.ROOT, \".ds-%s-%06d\", dataStreamName, generation);", "originalCommit": "da2cc2b04b83822b0400cd7603ab14f29e23aec4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM2ODAyOA==", "url": "https://github.com/elastic/elasticsearch/pull/57721#discussion_r436368028", "bodyText": "Maybe also add a unit test just for this method? This method is used in many unit / integ tests to validate the naming of backing indices and these tests wouldn't fail if an unintended was made to this method. In later stage the rest or docs test would fail.", "author": "martijnvg", "createdAt": "2020-06-07T14:18:44Z", "path": "server/src/main/java/org/elasticsearch/cluster/metadata/DataStream.java", "diffHunk": "@@ -101,15 +101,15 @@ public DataStream removeBackingIndex(Index index) {\n     }\n \n     /**\n-     * Generates the name of the index that conforms to the naming convention for backing indices\n+     * Generates the name of the index that conforms to the default naming convention for backing indices\n      * on data streams given the specified data stream name and generation.\n      *\n      * @param dataStreamName name of the data stream\n      * @param generation generation of the data stream\n      * @return backing index name\n      */\n-    public static String getBackingIndexName(String dataStreamName, long generation) {\n-        return String.format(Locale.ROOT, \"%s-%06d\", dataStreamName, generation);\n+    public static String getDefaultBackingIndexName(String dataStreamName, long generation) {", "originalCommit": "da2cc2b04b83822b0400cd7603ab14f29e23aec4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQwNzkzMQ==", "url": "https://github.com/elastic/elasticsearch/pull/57721#discussion_r436407931", "bodyText": "@martijnvg, is the unit test in ec48a95 along the lines of what you were suggesting?", "author": "danhermann", "createdAt": "2020-06-07T22:30:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM2ODAyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ2MzQ3OQ==", "url": "https://github.com/elastic/elasticsearch/pull/57721#discussion_r436463479", "bodyText": "yes", "author": "martijnvg", "createdAt": "2020-06-08T05:27:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM2ODAyOA=="}], "type": "inlineReview"}, {"oid": "ec48a9532c979d88b90ffcd8d9f1b50a5175e096", "url": "https://github.com/elastic/elasticsearch/commit/ec48a9532c979d88b90ffcd8d9f1b50a5175e096", "message": "review comments", "committedDate": "2020-06-07T21:45:24Z", "type": "commit"}, {"oid": "7574e9a8c294cc7a187477206f4f5b90f7f3c65d", "url": "https://github.com/elastic/elasticsearch/commit/7574e9a8c294cc7a187477206f4f5b90f7f3c65d", "message": "Merge branch 'master' into change_backing_index_names", "committedDate": "2020-06-08T12:17:19Z", "type": "commit"}, {"oid": "b68a0c8289610ac2eeb8d11a0184e5d9c76fa48c", "url": "https://github.com/elastic/elasticsearch/commit/b68a0c8289610ac2eeb8d11a0184e5d9c76fa48c", "message": "fix compile error after merge", "committedDate": "2020-06-08T12:29:42Z", "type": "commit"}, {"oid": "24aed786030854f9b462cdb7af4450b6de200c54", "url": "https://github.com/elastic/elasticsearch/commit/24aed786030854f9b462cdb7af4450b6de200c54", "message": "update validation logic and corresponding tests", "committedDate": "2020-06-08T12:50:57Z", "type": "commit"}]}