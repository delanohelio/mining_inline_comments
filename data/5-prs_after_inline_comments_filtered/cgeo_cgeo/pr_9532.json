{"pr_number": 9532, "pr_title": "Add option to user-select one of the integrated translations instead of auto-select by system-default", "pr_createdAt": "2020-12-13T10:04:55Z", "pr_url": "https://github.com/cgeo/cgeo/pull/9532", "timeline": [{"oid": "3b25188aacf1e7e301f3d271be72672837fe3030", "url": "https://github.com/cgeo/cgeo/commit/3b25188aacf1e7e301f3d271be72672837fe3030", "message": "WIP: add language selector", "committedDate": "2020-12-13T10:02:10Z", "type": "commit"}, {"oid": "0aa86ded03e3d9e268021cef2c5c4a4140ceadcf", "url": "https://github.com/cgeo/cgeo/commit/0aa86ded03e3d9e268021cef2c5c4a4140ceadcf", "message": "use language selector with built-in languages", "committedDate": "2020-12-13T12:12:06Z", "type": "commit"}, {"oid": "f1a37902d65b787e0f282faefacc9ba4a7fd1905", "url": "https://github.com/cgeo/cgeo/commit/f1a37902d65b787e0f282faefacc9ba4a7fd1905", "message": "remove 'Use English' preference", "committedDate": "2020-12-13T15:38:06Z", "type": "commit"}, {"oid": "963013318e8c725e61b3ed719fd4846bcedf2caa", "url": "https://github.com/cgeo/cgeo/commit/963013318e8c725e61b3ed719fd4846bcedf2caa", "message": "remove unused methods / adapt OKAPI tests / adapt system information", "committedDate": "2020-12-13T16:06:41Z", "type": "commit"}, {"oid": "9f92694010e9702dfbdfc22750a247731a72566b", "url": "https://github.com/cgeo/cgeo/commit/9f92694010e9702dfbdfc22750a247731a72566b", "message": "display language name in language selector", "committedDate": "2020-12-13T16:14:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUxMDg5MQ==", "url": "https://github.com/cgeo/cgeo/pull/9532#discussion_r542510891", "bodyText": "As far as I have understood the code, this will not work as it will only be run if the settingsVersion is lower than 1. But on the other hand this feature isn't critical enough that it needs its own new settingsVersion...", "author": "fm-sys", "createdAt": "2020-12-14T16:14:20Z", "path": "main/src/cgeo/geocaching/settings/Settings.java", "diffHunk": "@@ -175,7 +175,7 @@ private static void migrateSettings() {\n             e.putInt(getKey(R.string.pref_version), prefsV0.getInt(getKey(R.string.pref_version), 0));\n             e.putBoolean(getKey(R.string.pref_ratingwanted), prefsV0.getBoolean(getKey(R.string.pref_ratingwanted), true));\n             e.putBoolean(getKey(R.string.pref_friendlogswanted), prefsV0.getBoolean(getKey(R.string.pref_friendlogswanted), true));\n-            e.putBoolean(getKey(R.string.pref_useenglish), prefsV0.getBoolean(getKey(R.string.pref_useenglish), false));\n+            e.putBoolean(getKey(R.string.old_pref_useenglish), prefsV0.getBoolean(getKey(R.string.old_pref_useenglish), false));", "originalCommit": "9f92694010e9702dfbdfc22750a247731a72566b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU2MzkwOQ==", "url": "https://github.com/cgeo/cgeo/pull/9532#discussion_r542563909", "bodyText": "This is some very old migration code, not directly related to the current PR.\nThe selected language is stored in a new string preference called \"selectedLanguage\" (whereas the old \"useenglish\" was a boolean preference). \"Migration\" is done in Settings.java:\npublic static String getUserLanguage() {\n    return getString(R.string.pref_selected_language, Settings.getBoolean(R.string.old_pref_useenglish, false) ? \"en\" : \"\");\n}", "author": "moving-bits", "createdAt": "2020-12-14T17:22:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUxMDg5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjYxOTc2OQ==", "url": "https://github.com/cgeo/cgeo/pull/9532#discussion_r542619769", "bodyText": "I always look at the code of others to learn something new, and this part had confused me a bit.Thanks for your explanation, now I got it and you're of course totally right!", "author": "fm-sys", "createdAt": "2020-12-14T18:33:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUxMDg5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjcyMTM5Mg==", "url": "https://github.com/cgeo/cgeo/pull/9532#discussion_r542721392", "bodyText": "One addition: The change in the lines above came from the fact that I renamed the string which holds the actual preference key \"useenglish\" from \"pref_useenglish\" to \"old_pref_useenglish\" to mark it as outdated.", "author": "moving-bits", "createdAt": "2020-12-14T20:04:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUxMDg5MQ=="}], "type": "inlineReview"}]}