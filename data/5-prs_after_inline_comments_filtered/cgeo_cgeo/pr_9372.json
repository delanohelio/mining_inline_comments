{"pr_number": 9372, "pr_title": "toggle supersize distances (fix #9367)", "pr_createdAt": "2020-11-12T20:06:35Z", "pr_url": "https://github.com/cgeo/cgeo/pull/9372", "timeline": [{"oid": "b07da191bf2ebaab231c6def672a817a4433b638", "url": "https://github.com/cgeo/cgeo/commit/b07da191bf2ebaab231c6def672a817a4433b638", "message": "toggle supersize distances (fix #9367)", "committedDate": "2020-11-12T20:04:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjgyOTEzNA==", "url": "https://github.com/cgeo/cgeo/pull/9372#discussion_r522829134", "bodyText": "I have a bit of a bad feeling with these \"magic\" supersize numbers (0, 1 and 2). Is it an option to use an enum instead?\nAlso, the code seems like it would be vulnerable if \"bothViewsNeeded\" is switched from true to false and vice versa in consective calls. I think this is actually not the case since a previously stored supersize value of 2 would be reduced to 0 in case bothViewsNeeded=false, which as far as I understand the code triggers the \"correct\" behaviour of not displaying a supersize. But there is some hidden magic in there which is not obvious imho.", "author": "eddiemuc", "createdAt": "2020-11-13T09:29:18Z", "path": "main/src/cgeo/geocaching/maps/MapDistanceDrawerCommons.java", "diffHunk": "@@ -28,27 +31,34 @@ public MapDistanceDrawerCommons(final View root) {\n \n         distance1InfoView.setOnClickListener(v -> swap());\n         distance1View.setOnClickListener(v -> swap());\n+        distance2InfoView.setOnClickListener(v -> swap());\n+        distance2View.setOnClickListener(v -> swap());\n+        routeDistanceView.setOnClickListener(v -> swap());\n         distanceSupersizeView.setOnClickListener(v -> swap());\n     }\n \n     public void drawDistance(final boolean showBothDistances, final float distance, final float realDistance) {\n-        final boolean bothViewsNeeded = showBothDistances && realDistance != 0.0f && distance != realDistance;\n-        final boolean supersize = Settings.getSupersizeDistance();\n-        final TextView d = supersize ? distanceSupersizeView : distance1View;\n+        bothViewsNeeded = showBothDistances && realDistance != 0.0f && distance != realDistance;\n+        final int supersize = Settings.getSupersizeDistance() % (bothViewsNeeded ? 3 : 2);", "originalCommit": "b07da191bf2ebaab231c6def672a817a4433b638", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzAwMzkzMw==", "url": "https://github.com/cgeo/cgeo/pull/9372#discussion_r523003933", "bodyText": "Thanks for cross-checking. Those \"magic numbers\" are actually nothing more than a plain counter - first (1), second (2) or no (0) distance window being super-sized. \"Second\" only being possible if \"bothViews\" setting is activated and a calculated distance is available (resulting in bothViewsNeeded == true). And, exactly, fallback is intended as you've described. - Ok for you, or shall I change this to either using named constants or an enum class?", "author": "moving-bits", "createdAt": "2020-11-13T14:58:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjgyOTEzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzAyODA4OQ==", "url": "https://github.com/cgeo/cgeo/pull/9372#discussion_r523028089", "bodyText": "ok for me, leave as is", "author": "eddiemuc", "createdAt": "2020-11-13T15:35:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjgyOTEzNA=="}], "type": "inlineReview"}]}