{"pr_number": 361, "pr_title": "Support ES 7.7.0", "pr_createdAt": "2020-04-07T14:21:33Z", "pr_url": "https://github.com/opensearch-project/security/pull/361", "timeline": [{"oid": "0e8bae006f35a5b774b0728f4e0c3e6d7b97465d", "url": "https://github.com/opensearch-project/security/commit/0e8bae006f35a5b774b0728f4e0c3e6d7b97465d", "message": "Test 7.7.0 SNAPSHOT changes", "committedDate": "2020-05-13T19:11:52Z", "type": "commit"}, {"oid": "e38cccabfd8324421df0caafcad75714af4b8508", "url": "https://github.com/opensearch-project/security/commit/e38cccabfd8324421df0caafcad75714af4b8508", "message": "Update ci.yml", "committedDate": "2020-05-13T19:11:52Z", "type": "commit"}, {"oid": "aa9794d53a93f5f5d1d4b0a19b5f8434b192a733", "url": "https://github.com/opensearch-project/security/commit/aa9794d53a93f5f5d1d4b0a19b5f8434b192a733", "message": "Drop SNAPSHOT from plugin descriptor", "committedDate": "2020-05-13T19:11:52Z", "type": "commit"}, {"oid": "abac2793327f477402704c68c93a58f4816b1996", "url": "https://github.com/opensearch-project/security/commit/abac2793327f477402704c68c93a58f4816b1996", "message": "Use Java 14", "committedDate": "2020-05-13T19:11:52Z", "type": "commit"}, {"oid": "ecac36d939d73a285f56bdca90a95f7587b7320d", "url": "https://github.com/opensearch-project/security/commit/ecac36d939d73a285f56bdca90a95f7587b7320d", "message": "Code review", "committedDate": "2020-05-13T19:11:52Z", "type": "commit"}, {"oid": "d0c909e9928c9252a04968d7a1b00312b1050b4c", "url": "https://github.com/opensearch-project/security/commit/d0c909e9928c9252a04968d7a1b00312b1050b4c", "message": "Update node dn api action", "committedDate": "2020-05-13T19:11:52Z", "type": "commit"}, {"oid": "e98523fce19375977c1c3cd97ef972d7564974b7", "url": "https://github.com/opensearch-project/security/commit/e98523fce19375977c1c3cd97ef972d7564974b7", "message": "Try building with rest high level client", "committedDate": "2020-05-13T19:11:52Z", "type": "commit"}, {"oid": "258bb238b65c8b5b3949f479369c20f058dd76aa", "url": "https://github.com/opensearch-project/security/commit/258bb238b65c8b5b3949f479369c20f058dd76aa", "message": "Fix value char", "committedDate": "2020-05-13T19:11:52Z", "type": "commit"}, {"oid": "e2a122dcdc34fa63d844a24b01ae74c43fa3e45e", "url": "https://github.com/opensearch-project/security/commit/e2a122dcdc34fa63d844a24b01ae74c43fa3e45e", "message": "ES 7.7.0 changes", "committedDate": "2020-05-13T19:23:54Z", "type": "commit"}, {"oid": "a125ba9f00bfe3e80d2e2450178b55879fbc7441", "url": "https://github.com/opensearch-project/security/commit/a125ba9f00bfe3e80d2e2450178b55879fbc7441", "message": "Formatting and fix test", "committedDate": "2020-05-13T21:06:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczMzczMQ==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424733731", "bodyText": "nit: unused import.", "author": "vrozov", "createdAt": "2020-05-13T21:11:55Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/ActionGroupsApiAction.java", "diffHunk": "@@ -16,6 +16,8 @@\n package com.amazon.opendistroforelasticsearch.security.dlic.rest.api;\n \n import java.nio.file.Path;\n+import java.util.Arrays;", "originalCommit": "e2a122dcdc34fa63d844a24b01ae74c43fa3e45e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczMzk2MQ==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424733961", "bodyText": "nit: extra empty line.", "author": "vrozov", "createdAt": "2020-05-13T21:12:26Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/ActionGroupsApiAction.java", "diffHunk": "@@ -36,8 +38,28 @@\n import com.amazon.opendistroforelasticsearch.security.securityconf.impl.CType;\n import com.amazon.opendistroforelasticsearch.security.ssl.transport.PrincipalExtractor;\n \n+import com.google.common.collect.ImmutableList;\n+\n+", "originalCommit": "e2a122dcdc34fa63d844a24b01ae74c43fa3e45e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczNTM4OA==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424735388", "bodyText": "nit: extra empty line.", "author": "vrozov", "createdAt": "2020-05-13T21:15:15Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/FlushCacheApiAction.java", "diffHunk": "@@ -44,7 +44,16 @@\n import com.amazon.opendistroforelasticsearch.security.securityconf.impl.CType;\n import com.amazon.opendistroforelasticsearch.security.ssl.transport.PrincipalExtractor;\n \n+import com.google.common.collect.ImmutableList;\n+\n+", "originalCommit": "a125ba9f00bfe3e80d2e2450178b55879fbc7441", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczNTY3MA==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424735670", "bodyText": "nit: add <LF>.", "author": "vrozov", "createdAt": "2020-05-13T21:15:46Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/FlushCacheApiAction.java", "diffHunk": "@@ -134,5 +140,4 @@ protected CType getConfigName() {\n \tprotected void consumeParameters(final RestRequest request) {\n \t\t// not needed\n \t}\n-\n }", "originalCommit": "a125ba9f00bfe3e80d2e2450178b55879fbc7441", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczNzM5OQ==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424737399", "bodyText": "nit: delete extra empty line.", "author": "vrozov", "createdAt": "2020-05-13T21:19:19Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/InternalUsersApiAction.java", "diffHunk": "@@ -45,10 +45,28 @@\n \n import java.io.IOException;\n import java.nio.file.Path;\n+import java.util.List;\n+\n+import com.google.common.collect.ImmutableList;\n+", "originalCommit": "a125ba9f00bfe3e80d2e2450178b55879fbc7441", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc0NzQyMg==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424747422", "bodyText": "Can static routes be used as there is already allowPutOrPatch flag that filters not implemented requests.", "author": "vrozov", "createdAt": "2020-05-13T21:41:05Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/OpenDistroSecurityConfigAction.java", "diffHunk": "@@ -58,21 +63,18 @@ public OpenDistroSecurityConfigAction(final Settings settings, final Path config\n     }\n \n     @Override\n-    protected void registerHandlers(RestController controller, Settings settings) {\n-        controller.registerHandler(Method.GET, \"/_opendistro/_security/api/securityconfig/\", this);\n-\n-        //controller.registerHandler(Method.GET, \"/_opendistro/_security/api/config/\", this);\n+    public List<Route> routes() {\n+        List<Route> routes = new ArrayList<>();", "originalCommit": "a125ba9f00bfe3e80d2e2450178b55879fbc7441", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc0ODkzOA==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424748938", "bodyText": "nit: delete extra empty line", "author": "vrozov", "createdAt": "2020-05-13T21:44:32Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/PermissionsInfoAction.java", "diffHunk": "@@ -45,10 +46,14 @@\n import com.amazon.opendistroforelasticsearch.security.support.ConfigConstants;\n import com.amazon.opendistroforelasticsearch.security.user.User;\n \n+", "originalCommit": "a125ba9f00bfe3e80d2e2450178b55879fbc7441", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc0OTMwOQ==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424749309", "bodyText": "nit: unused import.", "author": "vrozov", "createdAt": "2020-05-13T21:45:17Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/RolesApiAction.java", "diffHunk": "@@ -16,6 +16,8 @@\n package com.amazon.opendistroforelasticsearch.security.dlic.rest.api;\n \n import java.nio.file.Path;\n+import java.util.Arrays;", "originalCommit": "a125ba9f00bfe3e80d2e2450178b55879fbc7441", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc1MDMwMQ==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424750301", "bodyText": "nit: avoid import reorder.", "author": "vrozov", "createdAt": "2020-05-13T21:47:28Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/RolesMappingApiAction.java", "diffHunk": "@@ -15,8 +15,14 @@\n \n package com.amazon.opendistroforelasticsearch.security.dlic.rest.api;\n \n-import java.nio.file.Path;\n-\n+import com.amazon.opendistroforelasticsearch.security.auditlog.AuditLog;", "originalCommit": "a125ba9f00bfe3e80d2e2450178b55879fbc7441", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc1MDUzOA==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424750538", "bodyText": "nit: unused import.", "author": "vrozov", "createdAt": "2020-05-13T21:47:58Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/TenantsApiAction.java", "diffHunk": "@@ -1,6 +1,8 @@\n package com.amazon.opendistroforelasticsearch.security.dlic.rest.api;\n \n import java.nio.file.Path;\n+import java.util.Arrays;", "originalCommit": "a125ba9f00bfe3e80d2e2450178b55879fbc7441", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "80970fff8ff6fcd3cf622e694f3167d9149922a2", "url": "https://github.com/opensearch-project/security/commit/80970fff8ff6fcd3cf622e694f3167d9149922a2", "message": "code review", "committedDate": "2020-05-13T22:48:25Z", "type": "commit"}, {"oid": "3465d7d376a2e092eb3dd315562c457b2b0503e1", "url": "https://github.com/opensearch-project/security/commit/3465d7d376a2e092eb3dd315562c457b2b0503e1", "message": "remove extra line", "committedDate": "2020-05-13T22:49:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgyMDI2Nw==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424820267", "bodyText": "use allowPutOrPatch", "author": "vrozov", "createdAt": "2020-05-14T01:26:51Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/OpenDistroSecurityConfigAction.java", "diffHunk": "@@ -58,21 +70,14 @@ public OpenDistroSecurityConfigAction(final Settings settings, final Path config\n     }\n \n     @Override\n-    protected void registerHandlers(RestController controller, Settings settings) {\n-        controller.registerHandler(Method.GET, \"/_opendistro/_security/api/securityconfig/\", this);\n-\n-        //controller.registerHandler(Method.GET, \"/_opendistro/_security/api/config/\", this);\n-\n+    public List<Route> routes() {\n         boolean enablePutOrPatch = settings.getAsBoolean(ConfigConstants.OPENDISTRO_SECURITY_UNSUPPORTED_RESTAPI_ALLOW_SECURITYCONFIG_MODIFICATION, false);\n         if (enablePutOrPatch) {", "originalCommit": "3465d7d376a2e092eb3dd315562c457b2b0503e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgyMjU2OA==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424822568", "bodyText": "Hmm. Wondering how that got there", "author": "sujithvm", "createdAt": "2020-05-14T01:36:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgyMDI2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgyMDgxMw==", "url": "https://github.com/opensearch-project/security/pull/361#discussion_r424820813", "bodyText": "Create new List using Collections.singletonList().", "author": "vrozov", "createdAt": "2020-05-14T01:29:06Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/OpenDistroSecurityConfigAction.java", "diffHunk": "@@ -58,21 +70,14 @@ public OpenDistroSecurityConfigAction(final Settings settings, final Path config\n     }\n \n     @Override\n-    protected void registerHandlers(RestController controller, Settings settings) {\n-        controller.registerHandler(Method.GET, \"/_opendistro/_security/api/securityconfig/\", this);\n-\n-        //controller.registerHandler(Method.GET, \"/_opendistro/_security/api/config/\", this);\n-\n+    public List<Route> routes() {\n         boolean enablePutOrPatch = settings.getAsBoolean(ConfigConstants.OPENDISTRO_SECURITY_UNSUPPORTED_RESTAPI_ALLOW_SECURITYCONFIG_MODIFICATION, false);\n         if (enablePutOrPatch) {\n-\n-            //deprecated, will be removed with ODFE 8, use opendistro_security_config instead of config\n-            controller.registerHandler(Method.PUT, \"/_opendistro/_security/api/securityconfig/{name}\", this);\n-            controller.registerHandler(Method.PATCH, \"/_opendistro/_security/api/securityconfig/\", this);\n+            return routes;\n         }\n+        return routes.stream().filter(route -> route.getMethod() == Method.GET).collect(Collectors.toList());", "originalCommit": "3465d7d376a2e092eb3dd315562c457b2b0503e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5425a0499da583942a6435607ce7fb68a1833092", "url": "https://github.com/opensearch-project/security/commit/5425a0499da583942a6435607ce7fb68a1833092", "message": "code review", "committedDate": "2020-05-14T02:16:27Z", "type": "commit"}, {"oid": "a8bf6a3665e1c09db2ecde56694ccb2d67e1ed31", "url": "https://github.com/opensearch-project/security/commit/a8bf6a3665e1c09db2ecde56694ccb2d67e1ed31", "message": "remove unneeded imports", "committedDate": "2020-05-14T02:17:23Z", "type": "commit"}, {"oid": "b05a2614c5b3fb78bde8936d29a70de30eb132f0", "url": "https://github.com/opensearch-project/security/commit/b05a2614c5b3fb78bde8936d29a70de30eb132f0", "message": "Version bump to 1.8.0.0", "committedDate": "2020-05-14T18:06:30Z", "type": "commit"}]}