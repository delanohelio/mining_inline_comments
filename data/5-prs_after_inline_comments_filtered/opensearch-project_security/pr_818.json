{"pr_number": 818, "pr_title": "Reject empty password in internal user creation", "pr_createdAt": "2020-10-30T19:37:20Z", "pr_url": "https://github.com/opensearch-project/security/pull/818", "timeline": [{"oid": "2ae06246984a48a0981e0f109b5d3e0486a6bbad", "url": "https://github.com/opensearch-project/security/commit/2ae06246984a48a0981e0f109b5d3e0486a6bbad", "message": "Reject empty password in internal user creation", "committedDate": "2020-11-30T19:42:25Z", "type": "commit"}, {"oid": "2ae06246984a48a0981e0f109b5d3e0486a6bbad", "url": "https://github.com/opensearch-project/security/commit/2ae06246984a48a0981e0f109b5d3e0486a6bbad", "message": "Reject empty password in internal user creation", "committedDate": "2020-11-30T19:42:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjkxNjEyNQ==", "url": "https://github.com/opensearch-project/security/pull/818#discussion_r532916125", "bodyText": "nit: use final same as original final String password = (String) contentAsMap.get(\"password\");", "author": "sujithvm", "createdAt": "2020-11-30T21:30:25Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/validation/CredentialsValidator.java", "diffHunk": "@@ -53,39 +54,44 @@ public boolean validate() {\n         final String regex = this.esSettings.get(ConfigConstants.OPENDISTRO_SECURITY_RESTAPI_PASSWORD_VALIDATION_REGEX, null);\n \n         if ((request.method() == RestRequest.Method.PUT || request.method() == RestRequest.Method.PATCH)\n-                && regex != null\n-                && !regex.isEmpty()\n                 && this.content != null\n                 && this.content.length() > 1) {\n             try {\n                 final Map<String, Object> contentAsMap = XContentHelper.convertToMap(this.content, false, XContentType.JSON).v2();\n-                if (contentAsMap != null && contentAsMap.containsKey(\"password\")) {\n-                    final String password = (String) contentAsMap.get(\"password\");\n-\n-                    // Password can be null/empty for an existing user. Regex will validate password if present\n-                    if (password != null && !password.isEmpty() && !regex.isEmpty() && !Pattern.compile(\"^\"+regex+\"$\").matcher(password).matches()) {\n-                        if(log.isDebugEnabled()) {\n-                            log.debug(\"Regex does not match password\");\n-                        }\n+                String password = (String) contentAsMap.get(\"password\");", "originalCommit": "2ae06246984a48a0981e0f109b5d3e0486a6bbad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjkxNjM2MA==", "url": "https://github.com/opensearch-project/security/pull/818#discussion_r532916360", "bodyText": "Can contentAsMap be null? I see the null check is removed", "author": "sujithvm", "createdAt": "2020-11-30T21:30:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjkxNjEyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjkyNDU0OQ==", "url": "https://github.com/opensearch-project/security/pull/818#discussion_r532924549", "bodyText": "final Map<String, Object> contentAsMap = XContentHelper.convertToMap(this.content, false, XContentType.JSON).v2(); prevents null contentAsMap.", "author": "cliu123", "createdAt": "2020-11-30T21:47:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjkxNjEyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjkyNjA0Nw==", "url": "https://github.com/opensearch-project/security/pull/818#discussion_r532926047", "bodyText": "Does prevents null mean it throws null pointer exception or returns empty map?", "author": "sujithvm", "createdAt": "2020-11-30T21:50:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjkxNjEyNQ=="}], "type": "inlineReview"}]}