{"pr_number": 2421, "pr_title": "[test] Polish tests that use nano durations to avoid flakkyness", "pr_createdAt": "2020-10-07T13:43:54Z", "pr_url": "https://github.com/reactor/reactor-core/pull/2421", "timeline": [{"oid": "8f9a905f2128f012e0f051b03fccb47408f87951", "url": "https://github.com/reactor/reactor-core/commit/8f9a905f2128f012e0f051b03fccb47408f87951", "message": "[test] Polish tests that use nano durations to avoid flakkyness", "committedDate": "2020-10-07T13:43:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTAzMTI3OQ==", "url": "https://github.com/reactor/reactor-core/pull/2421#discussion_r501031279", "bodyText": "This one particular change seems weird to me. The rest is ok.", "author": "ericbottard", "createdAt": "2020-10-07T13:53:51Z", "path": "reactor-core/src/test/java/reactor/core/publisher/BlockingTests.java", "diffHunk": "@@ -111,7 +111,7 @@ public void blockingLastEarlyComplete() {\n \t@Test\n \tpublic void blockingLastTimeout() {\n \t\tassertThatIllegalStateException().isThrownBy(() ->\n-\t\t\t\tFlux.just(1).delayElements(Duration.ofNanos(100))\n+\t\t\t\tFlux.just(1).delayElements(Duration.ofMillis(100))", "originalCommit": "8f9a905f2128f012e0f051b03fccb47408f87951", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA0MDgzNg==", "url": "https://github.com/reactor/reactor-core/pull/2421#discussion_r501040836", "bodyText": "real time tests that use nanosecond precision for both scheduling (delays) and timeouts are prone to become flakky at the smallest of host hiccups (OS is busy when the timeout is scheduled, for instance). Having two different orders of magnitude ensures that such a hiccup during block wouldn't result in a test failure.", "author": "simonbasle", "createdAt": "2020-10-07T14:05:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTAzMTI3OQ=="}], "type": "inlineReview"}]}