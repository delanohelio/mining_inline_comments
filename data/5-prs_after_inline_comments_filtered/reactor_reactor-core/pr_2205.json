{"pr_number": 2205, "pr_title": "fix #1431 #2176 Avoid throwing in onErrorDropped & subscribe w/lambdas", "pr_createdAt": "2020-06-19T14:19:42Z", "pr_url": "https://github.com/reactor/reactor-core/pull/2205", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4MTA4MQ==", "url": "https://github.com/reactor/reactor-core/pull/2205#discussion_r449481081", "bodyText": "why would this case silently drop the error ?", "author": "simonbasle", "createdAt": "2020-07-03T09:27:51Z", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxTakeUntil.java", "diffHunk": "@@ -88,13 +93,16 @@ public void onNext(T t) {\n \n \t\t\tif (b) {\n \t\t\t\ts.cancel();\n-\n-\t\t\t\tonComplete();\n+\t\t\t\ttook = true;\n+\t\t\t\tactual.onComplete();\n \t\t\t}\n \t\t}\n \n \t\t@Override\n \t\tpublic void onError(Throwable t) {\n+\t\t\tif (took) {\n+\t\t\t\treturn;", "originalCommit": "6820cd6ea112a4f3894ad6824a27df616c1e1c48", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4MTMzNQ==", "url": "https://github.com/reactor/reactor-core/pull/2205#discussion_r449481335", "bodyText": "same here, I don't think the throwable should be silently ignored", "author": "simonbasle", "createdAt": "2020-07-03T09:28:23Z", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxTakeWhile.java", "diffHunk": "@@ -96,6 +100,9 @@ public void onNext(T t) {\n \n \t\t@Override\n \t\tpublic void onError(Throwable t) {\n+\t\t\tif (took) {\n+\t\t\t\treturn;", "originalCommit": "6820cd6ea112a4f3894ad6824a27df616c1e1c48", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ4MTk0Ng==", "url": "https://github.com/reactor/reactor-core/pull/2205#discussion_r449481946", "bodyText": "the introduction of took and discarding sound like an orthogonal issue", "author": "simonbasle", "createdAt": "2020-07-03T09:29:41Z", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxTake.java", "diffHunk": "@@ -102,6 +103,10 @@ public void onSubscribe(Subscription s) {\n \n \t\t@Override\n \t\tpublic void onNext(T t) {\n+\t\t\tif (took) {", "originalCommit": "6820cd6ea112a4f3894ad6824a27df616c1e1c48", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3fe2ac4da844211ebe21ca449e0c67e168d84752", "url": "https://github.com/reactor/reactor-core/commit/3fe2ac4da844211ebe21ca449e0c67e168d84752", "message": "removes error bubling in case of onErrorDrop\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T07:53:49Z", "type": "forcePushed"}, {"oid": "aaf2784784352634d1a79c922c4e3e4b5f3b8c5e", "url": "https://github.com/reactor/reactor-core/commit/aaf2784784352634d1a79c922c4e3e4b5f3b8c5e", "message": "removes error bubling in case of onErrorDrop\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T07:55:32Z", "type": "forcePushed"}, {"oid": "5f6cccd25643de51140a831cf328b5b5de9de31c", "url": "https://github.com/reactor/reactor-core/commit/5f6cccd25643de51140a831cf328b5b5de9de31c", "message": "removes error bubling in case of onErrorDrop\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T07:56:57Z", "type": "forcePushed"}, {"oid": "e9b0254ec0cc8c5046628b1d4ec078588ef2d7c5", "url": "https://github.com/reactor/reactor-core/commit/e9b0254ec0cc8c5046628b1d4ec078588ef2d7c5", "message": "removes error bubling in case of onErrorDrop\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T08:00:16Z", "type": "forcePushed"}, {"oid": "14b38be75160b1a6f02b783071b84efe2c543221", "url": "https://github.com/reactor/reactor-core/commit/14b38be75160b1a6f02b783071b84efe2c543221", "message": "removes error bubling in case of onErrorDrop\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T08:01:18Z", "type": "forcePushed"}, {"oid": "48d3945b6cccce7993c61410fae85c60e48974b7", "url": "https://github.com/reactor/reactor-core/commit/48d3945b6cccce7993c61410fae85c60e48974b7", "message": "removes error bubling in case of onErrorDrop\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T08:26:16Z", "type": "commit"}, {"oid": "48d3945b6cccce7993c61410fae85c60e48974b7", "url": "https://github.com/reactor/reactor-core/commit/48d3945b6cccce7993c61410fae85c60e48974b7", "message": "removes error bubling in case of onErrorDrop\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T08:26:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg3ODcxMA==", "url": "https://github.com/reactor/reactor-core/pull/2205#discussion_r454878710", "bodyText": "there is a TestLogger for that purpose that can be activated with Loggers.useCustomLoggers(ignored -> tl); instead of dealing with the PrintWriters yourself", "author": "simonbasle", "createdAt": "2020-07-15T08:23:44Z", "path": "reactor-core/src/test/java/reactor/core/publisher/BaseSubscriberTest.java", "diffHunk": "@@ -79,10 +84,16 @@ protected void hookFinally(SignalType type) {\n \t}\n \n \t@Test\n-\tpublic void onErrorCallbackNotImplemented() {\n-\t\tFlux<String> flux = Flux.error(new IllegalStateException());\n-\n+\tpublic void onErrorCallbackNotImplemented() throws UnsupportedEncodingException {\n+\t\tPrintStream err = System.err;\n+\t\tPrintStream out = System.out;\n \t\ttry {\n+\t\t\tByteArrayOutputStream outputStream = new ByteArrayOutputStream();\n+\t\t\tSystem.setErr(new PrintStream(outputStream));\n+\t\t\tSystem.setOut(new PrintStream(outputStream));\n+\t\t\tLoggers.useVerboseConsoleLoggers();", "originalCommit": "14b38be75160b1a6f02b783071b84efe2c543221", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg5NjY2MQ==", "url": "https://github.com/reactor/reactor-core/pull/2205#discussion_r454896661", "bodyText": "fixed", "author": "OlegDokuka", "createdAt": "2020-07-15T08:53:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg3ODcxMA=="}], "type": "inlineReview"}, {"oid": "2f62c18b114239ccc30debf72f16c69a6028977a", "url": "https://github.com/reactor/reactor-core/commit/2f62c18b114239ccc30debf72f16c69a6028977a", "message": "polishes tests\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T10:55:03Z", "type": "commit"}, {"oid": "2f62c18b114239ccc30debf72f16c69a6028977a", "url": "https://github.com/reactor/reactor-core/commit/2f62c18b114239ccc30debf72f16c69a6028977a", "message": "polishes tests\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T10:55:03Z", "type": "forcePushed"}, {"oid": "e7f74d15d03091d2a39b2da78a2ae36de7902723", "url": "https://github.com/reactor/reactor-core/commit/e7f74d15d03091d2a39b2da78a2ae36de7902723", "message": "fixes failing test\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T12:42:27Z", "type": "commit"}, {"oid": "e7f74d15d03091d2a39b2da78a2ae36de7902723", "url": "https://github.com/reactor/reactor-core/commit/e7f74d15d03091d2a39b2da78a2ae36de7902723", "message": "fixes failing test\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-07-15T12:42:27Z", "type": "forcePushed"}]}