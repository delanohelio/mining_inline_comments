{"pr_number": 1857, "pr_title": "MVP EMPI implementation ", "pr_createdAt": "2020-05-20T23:15:31Z", "pr_url": "https://github.com/hapifhir/hapi-fhir/pull/1857", "timeline": [{"oid": "96bf065b5f7d55b1a12745ebb3939e11f82c35c4", "url": "https://github.com/hapifhir/hapi-fhir/commit/96bf065b5f7d55b1a12745ebb3939e11f82c35c4", "message": "Add test case, fix logic", "committedDate": "2020-05-19T18:27:24Z", "type": "commit"}, {"oid": "d64ccf0bebaa464687e16a8d3a4cee69c8298b15", "url": "https://github.com/hapifhir/hapi-fhir/commit/d64ccf0bebaa464687e16a8d3a4cee69c8298b15", "message": "Add ProducerChannelSettings", "committedDate": "2020-05-19T19:15:05Z", "type": "commit"}, {"oid": "a98d51ca665e97c8fca7259150daeb466a7d4512", "url": "https://github.com/hapifhir/hapi-fhir/commit/a98d51ca665e97c8fca7259150daeb466a7d4512", "message": "Merge remote-tracking branch 'origin/ks-20200312-empi1' into ks-20200312-empi1", "committedDate": "2020-05-19T19:15:22Z", "type": "commit"}, {"oid": "865010bc1b7bb5fc68afb6de0508879f2eb71428", "url": "https://github.com/hapifhir/hapi-fhir/commit/865010bc1b7bb5fc68afb6de0508879f2eb71428", "message": "fix empi ProducerChannelSettings", "committedDate": "2020-05-19T20:57:02Z", "type": "commit"}, {"oid": "894c358147156011c3a0d14d7815dbddb21d3507", "url": "https://github.com/hapifhir/hapi-fhir/commit/894c358147156011c3a0d14d7815dbddb21d3507", "message": "Make test more lenient for checking TxLog messages", "committedDate": "2020-05-19T23:01:09Z", "type": "commit"}, {"oid": "cae4a4c0c5acf11f4d696c5e4d1d8fc6c472e84d", "url": "https://github.com/hapifhir/hapi-fhir/commit/cae4a4c0c5acf11f4d696c5e4d1d8fc6c472e84d", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-19T23:01:44Z", "type": "commit"}, {"oid": "90b91b661e8412709c63a5895735fc0fae8f48fa", "url": "https://github.com/hapifhir/hapi-fhir/commit/90b91b661e8412709c63a5895735fc0fae8f48fa", "message": "Add more test cases, tidy logic", "committedDate": "2020-05-20T01:24:57Z", "type": "commit"}, {"oid": "64fbadbbdfa4c16c1b01d57695339cb7ea27c72d", "url": "https://github.com/hapifhir/hapi-fhir/commit/64fbadbbdfa4c16c1b01d57695339cb7ea27c72d", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-20T12:59:09Z", "type": "commit"}, {"oid": "4cc309945ad6ef5f3392d209535bdc0244101386", "url": "https://github.com/hapifhir/hapi-fhir/commit/4cc309945ad6ef5f3392d209535bdc0244101386", "message": "FIXME", "committedDate": "2020-05-20T13:34:15Z", "type": "commit"}, {"oid": "d053c022a96f1ab6153e8ff3cf48a2c19aee81a2", "url": "https://github.com/hapifhir/hapi-fhir/commit/d053c022a96f1ab6153e8ff3cf48a2c19aee81a2", "message": "optimize imports", "committedDate": "2020-05-20T13:39:58Z", "type": "commit"}, {"oid": "39fa721daa68ccd6438c970ce4d5e024f44c8891", "url": "https://github.com/hapifhir/hapi-fhir/commit/39fa721daa68ccd6438c970ce4d5e024f44c8891", "message": "added some accessors", "committedDate": "2020-05-20T14:53:03Z", "type": "commit"}, {"oid": "7217d686d1ff4e2091a22e31bd0c2991566959f0", "url": "https://github.com/hapifhir/hapi-fhir/commit/7217d686d1ff4e2091a22e31bd0c2991566959f0", "message": "Swap from IBaseResource to IAnyResource where possible", "committedDate": "2020-05-20T16:06:55Z", "type": "commit"}, {"oid": "a21d60b773de086e60b0c61e39f4a095f86d0af2", "url": "https://github.com/hapifhir/hapi-fhir/commit/a21d60b773de086e60b0c61e39f4a095f86d0af2", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-20T16:06:59Z", "type": "commit"}, {"oid": "07951d5ce09c0efacdff191a3f68d9f9e6160d6f", "url": "https://github.com/hapifhir/hapi-fhir/commit/07951d5ce09c0efacdff191a3f68d9f9e6160d6f", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-20T16:11:46Z", "type": "commit"}, {"oid": "6f983fe044cc8c5b9f6b3cb61a441ce64aee9ca8", "url": "https://github.com/hapifhir/hapi-fhir/commit/6f983fe044cc8c5b9f6b3cb61a441ce64aee9ca8", "message": "added more merge validation", "committedDate": "2020-05-20T16:46:13Z", "type": "commit"}, {"oid": "418aa6f9d1a66669305be669cc60166a55e58333", "url": "https://github.com/hapifhir/hapi-fhir/commit/418aa6f9d1a66669305be669cc60166a55e58333", "message": "fix invalid changelog", "committedDate": "2020-05-20T16:58:11Z", "type": "commit"}, {"oid": "8539a5f7009de923277ff5a774a2e9c4bdaf1bd8", "url": "https://github.com/hapifhir/hapi-fhir/commit/8539a5f7009de923277ff5a774a2e9c4bdaf1bd8", "message": "clean up documentation", "committedDate": "2020-05-20T19:13:58Z", "type": "commit"}, {"oid": "63a49a744e8bf583acf28f0677a7d73780a3f04a", "url": "https://github.com/hapifhir/hapi-fhir/commit/63a49a744e8bf583acf28f0677a7d73780a3f04a", "message": "update link handle case where link does not exist", "committedDate": "2020-05-20T22:00:01Z", "type": "commit"}, {"oid": "f9ff61f7c2cd50d8dc8d3c019dc543084a6e6cd1", "url": "https://github.com/hapifhir/hapi-fhir/commit/f9ff61f7c2cd50d8dc8d3c019dc543084a6e6cd1", "message": "Refactor updates into update service. Add data class to contain EmpiUpdateContext", "committedDate": "2020-05-20T22:49:32Z", "type": "commit"}, {"oid": "753919852f058ed873538d8e2512320ea128e74c", "url": "https://github.com/hapifhir/hapi-fhir/commit/753919852f058ed873538d8e2512320ea128e74c", "message": "migrate a method to PersonHelper", "committedDate": "2020-05-20T22:51:07Z", "type": "commit"}, {"oid": "e6a1f15d261dad2f8822f2586f8c83d30dfaa487", "url": "https://github.com/hapifhir/hapi-fhir/commit/e6a1f15d261dad2f8822f2586f8c83d30dfaa487", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-20T22:51:13Z", "type": "commit"}, {"oid": "1ecacea4f9bb693d896ed190e506c821e71cb735", "url": "https://github.com/hapifhir/hapi-fhir/commit/1ecacea4f9bb693d896ed190e506c821e71cb735", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-20T22:52:11Z", "type": "commit"}, {"oid": "9c32a450d0936aacdc2e93fd5eaeeafad7396b5e", "url": "https://github.com/hapifhir/hapi-fhir/commit/9c32a450d0936aacdc2e93fd5eaeeafad7396b5e", "message": "Merge remote-tracking branch 'origin/ks-20200312-empi1' into ks-20200312-empi1", "committedDate": "2020-05-20T22:52:54Z", "type": "commit"}, {"oid": "ec16add802fbf306dfed85616fe59b6d225ff92c", "url": "https://github.com/hapifhir/hapi-fhir/commit/ec16add802fbf306dfed85616fe59b6d225ff92c", "message": "Update docs", "committedDate": "2020-05-20T23:09:20Z", "type": "commit"}, {"oid": "f39dca75b7d942a6493c32cfe65bd16f7c3a9658", "url": "https://github.com/hapifhir/hapi-fhir/commit/f39dca75b7d942a6493c32cfe65bd16f7c3a9658", "message": "improve robustness of initial empi subscription loading", "committedDate": "2020-05-21T01:52:53Z", "type": "commit"}, {"oid": "8a3e0f61aa6f7f5d6fcfe12540c49f3de9b13eb7", "url": "https://github.com/hapifhir/hapi-fhir/commit/8a3e0f61aa6f7f5d6fcfe12540c49f3de9b13eb7", "message": "Merge remote-tracking branch 'origin/ks-20200312-empi1' into ks-20200312-empi1", "committedDate": "2020-05-21T01:53:03Z", "type": "commit"}, {"oid": "b0880587f7f2776e4e2ff806fd37b7d4e63ac834", "url": "https://github.com/hapifhir/hapi-fhir/commit/b0880587f7f2776e4e2ff806fd37b7d4e63ac834", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-base/src/main/java/ca/uhn/fhir/util/ParametersUtil.java\n#\thapi-fhir-cli/hapi-fhir-cli-jpaserver/src/main/java/ca/uhn/fhir/jpa/demo/JpaServerDemo.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/BaseTransactionProcessor.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/r4/BaseJpaR4Test.java\n#\thapi-fhir-jpaserver-uhnfhirtest/src/main/java/ca/uhn/fhirtest/TestRestfulServer.java\n#\thapi-fhir-jpaserver-uhnfhirtest/src/main/java/ca/uhn/fhirtest/config/CommonConfig.java\n#\thapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/provider/ProviderConstants.java\n#\thapi-fhir-structures-r4/src/test/java/ca/uhn/fhir/rest/server/interceptor/ResponseSizeCapturingInterceptorTest.java", "committedDate": "2020-05-21T02:08:58Z", "type": "commit"}, {"oid": "3e28220920660b664bdb3d89c6811b6db439a5b8", "url": "https://github.com/hapifhir/hapi-fhir/commit/3e28220920660b664bdb3d89c6811b6db439a5b8", "message": "merge", "committedDate": "2020-05-21T02:39:14Z", "type": "commit"}, {"oid": "e092fe58f7ab320e220318f068d7caf1332cbf29", "url": "https://github.com/hapifhir/hapi-fhir/commit/e092fe58f7ab320e220318f068d7caf1332cbf29", "message": "Fix potential NPE", "committedDate": "2020-05-21T02:57:57Z", "type": "commit"}, {"oid": "aca4f5d4af65c612684954b6a3669586fed7d3c0", "url": "https://github.com/hapifhir/hapi-fhir/commit/aca4f5d4af65c612684954b6a3669586fed7d3c0", "message": "test compile", "committedDate": "2020-05-21T02:58:35Z", "type": "commit"}, {"oid": "daaf057b8d2cb6e06ad38c4f022ec05405afbf05", "url": "https://github.com/hapifhir/hapi-fhir/commit/daaf057b8d2cb6e06ad38c4f022ec05405afbf05", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-21T03:00:05Z", "type": "commit"}, {"oid": "15798eb18bb943d437ef45d3f2f0e44260d1dfb7", "url": "https://github.com/hapifhir/hapi-fhir/commit/15798eb18bb943d437ef45d3f2f0e44260d1dfb7", "message": "Fix potential NPE", "committedDate": "2020-05-21T03:22:39Z", "type": "commit"}, {"oid": "5a2f48c58e5df833a5db3f713d2d33c50c753ede", "url": "https://github.com/hapifhir/hapi-fhir/commit/5a2f48c58e5df833a5db3f713d2d33c50c753ede", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-21T03:22:50Z", "type": "commit"}, {"oid": "2f2a46932f5e56b6c29acc27e3fd6a6d02021c39", "url": "https://github.com/hapifhir/hapi-fhir/commit/2f2a46932f5e56b6c29acc27e3fd6a6d02021c39", "message": "fix org hl7 dependency", "committedDate": "2020-05-21T14:21:13Z", "type": "commit"}, {"oid": "eb36fd8061eab8057ad5c4d1a256edafc9bed7c9", "url": "https://github.com/hapifhir/hapi-fhir/commit/eb36fd8061eab8057ad5c4d1a256edafc9bed7c9", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-21T14:36:37Z", "type": "commit"}, {"oid": "279c6b7515af603e24f8d4325dbbe077fff90f22", "url": "https://github.com/hapifhir/hapi-fhir/commit/279c6b7515af603e24f8d4325dbbe077fff90f22", "message": "superficial change", "committedDate": "2020-05-21T15:50:07Z", "type": "commit"}, {"oid": "733eba64fa45253f04cd8f70b4af6d1fceb0a39c", "url": "https://github.com/hapifhir/hapi-fhir/commit/733eba64fa45253f04cd8f70b4af6d1fceb0a39c", "message": "Revert \"improve robustness of initial empi subscription loading\"\n\nThis reverts commit f39dca75", "committedDate": "2020-05-21T16:54:06Z", "type": "commit"}, {"oid": "7fb1d4049e6ee3ef9d4c2f5099389eac4e3a4292", "url": "https://github.com/hapifhir/hapi-fhir/commit/7fb1d4049e6ee3ef9d4c2f5099389eac4e3a4292", "message": "Attempt #3 to fix parallel test contention", "committedDate": "2020-05-21T17:20:44Z", "type": "commit"}, {"oid": "ca80c73e3b39000324ff3cba701cd9108cdd280c", "url": "https://github.com/hapifhir/hapi-fhir/commit/ca80c73e3b39000324ff3cba701cd9108cdd280c", "message": "don't run interceptor tests in parallel", "committedDate": "2020-05-21T17:33:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM3MTMyNw==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428371327", "bodyText": "This is a breaking API change. I think it's ok, but it should have an entry in changes.yaml (see the equivalent file in the 5_0_0 changelog directory) and a JavaDoc saying @since 5.1.0", "author": "jamesagnew", "createdAt": "2020-05-20T23:52:35Z", "path": "hapi-fhir-base/src/main/java/ca/uhn/fhir/context/FhirContext.java", "diffHunk": "@@ -502,7 +547,7 @@ public RuntimeResourceDefinition getResourceDefinitionById(final String theId) {\n \t * Returns an unmodifiable set containing all resource names known to this\n \t * context\n \t */\n-\tpublic Set<String> getResourceNames() {\n+\tpublic Set<String> getResourceTypes() {", "originalCommit": "ec16add802fbf306dfed85616fe59b6d225ff92c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg2NTA0Nw==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428865047", "bodyText": "Resolved in 82b3756", "author": "tadgh", "createdAt": "2020-05-21T19:27:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM3MTMyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5MjIzNA==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428392234", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * An IBaseResource that has a FHIR version of DSTU3 or higher\n          \n          \n            \n             * An IBaseResource that is using an <code>org.hl7.fhir.*</code> structure, as opposed to the <code>ca.uhn.fhir.model.*</code> structures that are used for DSTU2 and below in HAPI FHIR.", "author": "jamesagnew", "createdAt": "2020-05-21T01:11:00Z", "path": "hapi-fhir-base/src/main/java/org/hl7/fhir/instance/model/api/IAnyResource.java", "diffHunk": "@@ -23,6 +23,9 @@\n  * #L%\n  */\n \n+/**\n+ * An IBaseResource that has a FHIR version of DSTU3 or higher", "originalCommit": "ec16add802fbf306dfed85616fe59b6d225ff92c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5MjYwNg==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428392606", "bodyText": "Heh, this is a lot of these to review, but what a great change!", "author": "jamesagnew", "createdAt": "2020-05-21T01:12:44Z", "path": "hapi-fhir-client/src/main/java/ca/uhn/fhir/rest/client/impl/GenericClient.java", "diffHunk": "@@ -361,7 +361,7 @@ public IUntypedQuery search() {\n \t}\n \n \tprivate String toResourceName(Class<? extends IBaseResource> theType) {\n-\t\treturn myContext.getResourceDefinition(theType).getName();\n+\t\treturn myContext.getResourceType(theType);", "originalCommit": "ec16add802fbf306dfed85616fe59b6d225ff92c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NDc4Mg==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428394782", "bodyText": "Are there really enough beans that we need this? Can we just explicitly declare them? Maybe in a dedicated context file in the EMPI project that gets imported here?", "author": "jamesagnew", "createdAt": "2020-05-21T01:21:35Z", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/config/BaseConfig.java", "diffHunk": "@@ -102,7 +102,8 @@\n \t@ComponentScan.Filter(type = FilterType.REGEX, pattern = \".*\\\\.test\\\\..*\"),\n \t@ComponentScan.Filter(type = FilterType.REGEX, pattern = \".*Test.*\"),\n \t@ComponentScan.Filter(type = FilterType.REGEX, pattern = \"ca.uhn.fhir.jpa.subscription.*\"),\n-\t@ComponentScan.Filter(type = FilterType.REGEX, pattern = \"ca.uhn.fhir.jpa.searchparam.*\")\n+\t@ComponentScan.Filter(type = FilterType.REGEX, pattern = \"ca.uhn.fhir.jpa.searchparam.*\"),\n+\t@ComponentScan.Filter(type = FilterType.REGEX, pattern = \"ca.uhn.fhir.jpa.empi.*\")", "originalCommit": "ec16add802fbf306dfed85616fe59b6d225ff92c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg3MDY4Ng==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428870686", "bodyText": "This is an exclude.  Empi does not @ComponentScan.", "author": "fil512", "createdAt": "2020-05-21T19:38:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NDc4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwNTE4Ng==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428905186", "bodyText": "Sorry, missed that fact. Resolving this.", "author": "jamesagnew", "createdAt": "2020-05-21T20:47:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NDc4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NjIxNQ==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428396215", "bodyText": "I have never seen this query-by-Example thing before. Strangely named, but kinda neat.\nIt does kind of give me pause if I'm honest though:\n\nThis is a different query pattern to how we do everything else, and\nIt really obscures which columns are used for SELECTs which makes it hard to tell if the indexes added to the tables are appropriate, when compared to just putting standard @Query methods on the repository interface\n\nI'm not necessarily saying to do anything about this comment, but I don't know that this is a query pattern we want to propagate without considering the consequences..", "author": "jamesagnew", "createdAt": "2020-05-21T01:27:13Z", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/EmpiLinkDaoSvc.java", "diffHunk": "@@ -0,0 +1,195 @@\n+package ca.uhn.fhir.jpa.dao;\n+\n+/*-\n+ * #%L\n+ * HAPI FHIR JPA Server\n+ * %%\n+ * Copyright (C) 2014 - 2020 University Health Network\n+ * %%\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ * #L%\n+ */\n+\n+import ca.uhn.fhir.empi.api.EmpiLinkSourceEnum;\n+import ca.uhn.fhir.empi.api.EmpiMatchResultEnum;\n+import ca.uhn.fhir.empi.log.Logs;\n+import ca.uhn.fhir.empi.model.EmpiTransactionContext;\n+import ca.uhn.fhir.jpa.dao.data.IEmpiLinkDao;\n+import ca.uhn.fhir.jpa.dao.index.IdHelperService;\n+import ca.uhn.fhir.jpa.entity.EmpiLink;\n+import org.hl7.fhir.instance.model.api.IBaseResource;\n+import org.slf4j.Logger;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.data.domain.Example;\n+import org.springframework.stereotype.Service;\n+import org.springframework.transaction.annotation.Propagation;\n+import org.springframework.transaction.annotation.Transactional;\n+\n+import javax.annotation.Nonnull;\n+import javax.annotation.Nullable;\n+import java.util.Collections;\n+import java.util.Date;\n+import java.util.List;\n+import java.util.Optional;\n+\n+@Service\n+public class EmpiLinkDaoSvc {\n+\tprivate static final Logger ourLog = Logs.getEmpiTroubleshootingLog();\n+\n+\t@Autowired\n+\tprivate IEmpiLinkDao myEmpiLinkDao;\n+\t@Autowired\n+\tprivate IdHelperService myIdHelperService;\n+\n+\tpublic EmpiLink createOrUpdateLinkEntity(IBaseResource thePerson, IBaseResource theTarget, EmpiMatchResultEnum theMatchResult, EmpiLinkSourceEnum theLinkSource, @Nullable EmpiTransactionContext theEmpiTransactionContext) {\n+\t\tLong personPid = myIdHelperService.getPidOrNull(thePerson);\n+\t\tLong resourcePid = myIdHelperService.getPidOrNull(theTarget);\n+\n+\t\tEmpiLink empiLink = getOrCreateEmpiLinkByPersonPidAndTargetPid(personPid, resourcePid);\n+\t\tempiLink.setLinkSource(theLinkSource);\n+\t\tempiLink.setMatchResult(theMatchResult);\n+\n+\t\tString message = String.format(\"Creating EmpiLink from %s to %s -> %s\", thePerson.getIdElement().toUnqualifiedVersionless(), theTarget.getIdElement().toUnqualifiedVersionless(), theMatchResult);\n+\t\ttheEmpiTransactionContext.addTransactionLogMessage(message);\n+\t\tourLog.debug(message);\n+\t\tsave(empiLink);\n+\t\treturn empiLink;\n+\t}\n+\n+\n+\t@Nonnull\n+\tpublic EmpiLink getOrCreateEmpiLinkByPersonPidAndTargetPid(Long thePersonPid, Long theResourcePid) {\n+\t\tOptional<EmpiLink> oExisting = getLinkByPersonPidAndTargetPid(thePersonPid, theResourcePid);\n+\t\tif (oExisting.isPresent()) {\n+\t\t\treturn oExisting.get();\n+\t\t} else {\n+\t\t\tEmpiLink empiLink = new EmpiLink();\n+\t\t\tempiLink.setPersonPid(thePersonPid);\n+\t\t\tempiLink.setTargetPid(theResourcePid);\n+\t\t\treturn empiLink;\n+\t\t}\n+\t}\n+\n+\tpublic Optional<EmpiLink> getLinkByPersonPidAndTargetPid(Long thePersonPid, Long theTargetPid) {\n+\n+\t\tif (theTargetPid == null || thePersonPid == null) {\n+\t\t\treturn Optional.empty();\n+\t\t}\n+\t\tEmpiLink link = new EmpiLink();\n+\t\tlink.setTargetPid(theTargetPid);\n+\t\tlink.setPersonPid(thePersonPid);\n+\t\tExample<EmpiLink> example = Example.of(link);", "originalCommit": "ec16add802fbf306dfed85616fe59b6d225ff92c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg3MTY4OQ==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428871689", "bodyText": "It becomes particularly useful in the $empi-query-links operation where there are 4 parameters that are all nullable and you want to be able to query by all 4 of them.  Beats 16 @Query methods.", "author": "fil512", "createdAt": "2020-05-21T19:40:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NjIxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwNTU5OA==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428905598", "bodyText": "Fair enough. I guess I'll restate this comment to just be:\nMake sure you have appropriate indexes for any columns being searched on :)", "author": "jamesagnew", "createdAt": "2020-05-21T20:47:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NjIxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkxNTgwNA==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428915804", "bodyText": "Following the rule of thumb \"If you are reading more than 5% of the records from a table, then a full table scan will be faster than an indexed lookup.\" We'll index the two id columns but leave the two enum columns unindexed.", "author": "fil512", "createdAt": "2020-05-21T21:09:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NjIxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkyMzk3MQ==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428923971", "bodyText": "Resolved in 6a6111a", "author": "tadgh", "createdAt": "2020-05-21T21:26:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NjIxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NzgwNA==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428397804", "bodyText": "If we're promoting this class to the core library, I think I'd recommend renaming the normalizeString method to normalizeStringforSearchIndexing or something along those lines, since it's a pretty arbitrary definition of normalizing (but also one that is specifically mandated by the spec)", "author": "jamesagnew", "createdAt": "2020-05-21T01:33:59Z", "path": "hapi-fhir-base/src/main/java/ca/uhn/fhir/util/StringNormalizer.java", "diffHunk": "@@ -1,8 +1,8 @@\n-package ca.uhn.fhir.jpa.model.util;\n+package ca.uhn.fhir.util;\n \n /*-\n  * #%L\n- * HAPI FHIR Model\n+ * HAPI FHIR - Core Library", "originalCommit": "ec16add802fbf306dfed85616fe59b6d225ff92c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg5NzE5Nw==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428897197", "bodyText": "Resolved in ec2b169", "author": "tadgh", "createdAt": "2020-05-21T20:30:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NzgwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgyOTU4OA==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428829588", "bodyText": "I'm curious about these optimisticlock annotations.. I don't see any @Version column so I don't think they do anything. Is this deliberate?", "author": "jamesagnew", "createdAt": "2020-05-21T18:18:51Z", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/entity/EmpiLink.java", "diffHunk": "@@ -0,0 +1,209 @@\n+package ca.uhn.fhir.jpa.entity;\n+\n+/*-\n+ * #%L\n+ * HAPI FHIR JPA Server\n+ * %%\n+ * Copyright (C) 2014 - 2020 University Health Network\n+ * %%\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ * #L%\n+ */\n+\n+import ca.uhn.fhir.empi.api.EmpiLinkSourceEnum;\n+import ca.uhn.fhir.empi.api.EmpiMatchResultEnum;\n+import ca.uhn.fhir.jpa.model.entity.ResourceTable;\n+import org.apache.commons.lang3.builder.ToStringBuilder;\n+import org.apache.commons.lang3.builder.ToStringStyle;\n+import org.hibernate.annotations.OptimisticLock;\n+\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.EnumType;\n+import javax.persistence.Enumerated;\n+import javax.persistence.FetchType;\n+import javax.persistence.ForeignKey;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.GenerationType;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.SequenceGenerator;\n+import javax.persistence.Table;\n+import javax.persistence.Temporal;\n+import javax.persistence.TemporalType;\n+import javax.persistence.UniqueConstraint;\n+import java.util.Date;\n+\n+@Entity\n+@Table(name = \"MPI_LINK\", uniqueConstraints = {\n+\t@UniqueConstraint(name = \"IDX_EMPI_PERSON_TGT\", columnNames = {\"PERSON_PID\", \"TARGET_PID\"}),\n+})\n+public class EmpiLink {\n+\tprivate static final int MATCH_RESULT_LENGTH = 16;\n+\tprivate static final int LINK_SOURCE_LENGTH = 16;\n+\n+\t@SequenceGenerator(name = \"SEQ_EMPI_LINK_ID\", sequenceName = \"SEQ_EMPI_LINK_ID\")\n+\t@GeneratedValue(strategy = GenerationType.AUTO, generator = \"SEQ_EMPI_LINK_ID\")\n+\t@Id\n+\t@Column(name = \"PID\")\n+\tprivate Long myId;\n+\n+\t@ManyToOne(optional = false, fetch = FetchType.LAZY, cascade = {})\n+\t@JoinColumn(name = \"PERSON_PID\", referencedColumnName = \"RES_ID\", foreignKey = @ForeignKey(name = \"FK_EMPI_LINK_PERSON\"), insertable=false, updatable=false, nullable=false)\n+\tprivate ResourceTable myPerson;\n+\n+\t@Column(name = \"PERSON_PID\", nullable=false)\n+\tprivate Long myPersonPid;\n+\n+\t@ManyToOne(optional = false, fetch = FetchType.LAZY, cascade = {})\n+\t@JoinColumn(name = \"TARGET_PID\", referencedColumnName = \"RES_ID\", foreignKey = @ForeignKey(name = \"FK_EMPI_LINK_TARGET\"), insertable=false, updatable=false, nullable=false)\n+\tprivate ResourceTable myTarget;\n+\n+\t@Column(name = \"TARGET_PID\", updatable=false, nullable=false)\n+\tprivate Long myTargetPid;\n+\n+\t@Column(name = \"MATCH_RESULT\", nullable = false)\n+\t@Enumerated(EnumType.ORDINAL)\n+\t@OptimisticLock(excluded = true)\n+\tprivate EmpiMatchResultEnum myMatchResult;\n+\n+\t@Column(name = \"LINK_SOURCE\", nullable = false)\n+\t@Enumerated(EnumType.ORDINAL)\n+\t@OptimisticLock(excluded = true)\n+\tprivate EmpiLinkSourceEnum myLinkSource;\n+\n+\t@Temporal(TemporalType.TIMESTAMP)\n+\t@Column(name = \"CREATED\", nullable = false)\n+\t@OptimisticLock(excluded = true)\n+\tprivate Date myCreated;\n+\n+\t@Temporal(TemporalType.TIMESTAMP)\n+\t@Column(name = \"UPDATED\", nullable = false)\n+\t@OptimisticLock(excluded = true)", "originalCommit": "ca80c73e3b39000324ff3cba701cd9108cdd280c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg3MjQ1Nw==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428872457", "bodyText": "I just copy/pasted those from elsewhere.  Gary asked me what it did and I had no idea.  Gary wondered if there was a way to automatically maintain these columns.  If that's what @Version does then we should do this properly", "author": "fil512", "createdAt": "2020-05-21T19:41:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgyOTU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwMDM0Nw==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428900347", "bodyText": "We took another look and decided to just delete these annotations", "author": "fil512", "createdAt": "2020-05-21T20:37:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgyOTU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwMDM3Ng==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428900376", "bodyText": "Removed in 8ce96f7", "author": "tadgh", "createdAt": "2020-05-21T20:37:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgyOTU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwMjgwNw==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428902807", "bodyText": "@Version creates an optimistic lock column, which is useful if you think that both:\n\nthere is a chance for two threads to update a row with different values at the same time\nthis happening would be a bad thing\n\n...or....\n\nyou want to make sure that two threads are never touching the same row at the same time\n\nFor system processing like this I'd say it's less common for that to be the case. Not unheard of at all though. We have an @Version on BulkExportJobEntity for the second reason for example", "author": "jamesagnew", "createdAt": "2020-05-21T20:42:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgyOTU4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MDIyNQ==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428850225", "bodyText": "Instead of String.join here you should use ParameterUtil.escapeAndJoinOrList - That method also escapes reserved characters in the strings such as | and ,\n..unless you are manually creating strings for token SPs such as system|value in which case that method will hurt you since you don't want the | escaped. If that's the case, at least make sure you're using ParameterUtil.escape on the left and right sides of that statement.. otherwise someone will eventually try to match on a value with a comma and have a horribly hard to diagnose bug", "author": "jamesagnew", "createdAt": "2020-05-21T18:57:49Z", "path": "hapi-fhir-jpaserver-empi/src/main/java/ca/uhn/fhir/jpa/empi/svc/EmpiCandidateSearchSvc.java", "diffHunk": "@@ -0,0 +1,175 @@\n+package ca.uhn.fhir.jpa.empi.svc;\n+\n+/*-\n+ * #%L\n+ * HAPI FHIR JPA Server - Enterprise Master Patient Index\n+ * %%\n+ * Copyright (C) 2014 - 2020 University Health Network\n+ * %%\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ * #L%\n+ */\n+\n+import ca.uhn.fhir.empi.api.IEmpiSettings;\n+import ca.uhn.fhir.empi.log.Logs;\n+import ca.uhn.fhir.empi.rules.json.EmpiFilterSearchParamJson;\n+import ca.uhn.fhir.empi.rules.json.EmpiResourceSearchParamJson;\n+import ca.uhn.fhir.jpa.api.dao.DaoRegistry;\n+import ca.uhn.fhir.jpa.api.dao.IFhirResourceDao;\n+import ca.uhn.fhir.jpa.dao.index.IdHelperService;\n+import ca.uhn.fhir.jpa.searchparam.SearchParameterMap;\n+import ca.uhn.fhir.rest.api.server.IBundleProvider;\n+import org.hl7.fhir.instance.model.api.IAnyResource;\n+import org.hl7.fhir.instance.model.api.IBaseResource;\n+import org.slf4j.Logger;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Service;\n+\n+import javax.annotation.Nonnull;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.stream.Collectors;\n+\n+import static ca.uhn.fhir.empi.api.EmpiConstants.ALL_RESOURCE_SEARCH_PARAM_TYPE;\n+\n+@Service\n+public class EmpiCandidateSearchSvc {\n+\tprivate static final Logger ourLog = Logs.getEmpiTroubleshootingLog();\n+\n+\t@Autowired\n+\tprivate IEmpiSettings myEmpiConfig;\n+\t@Autowired\n+\tprivate EmpiSearchParamSvc myEmpiSearchParamSvc;\n+\t@Autowired\n+\tprivate DaoRegistry myDaoRegistry;\n+\t@Autowired\n+\tprivate IdHelperService myIdHelperService;\n+\n+\t/**\n+\t * Given a target resource, search for all resources that are considered an EMPI match based on defined EMPI rules.\n+\t *\n+\t *\n+\t * @param theResourceType\n+\t * @param theResource the target {@link IBaseResource} we are attempting to match.\n+\t *\n+\t * @return the list of candidate {@link IBaseResource} which could be matches to theResource\n+\t */\n+\tpublic Collection<IAnyResource> findCandidates(String theResourceType, IAnyResource theResource) {\n+\t\tMap<Long, IAnyResource> matchedPidsToResources = new HashMap<>();\n+\n+\t\tList<EmpiFilterSearchParamJson> filterSearchParams = myEmpiConfig.getEmpiRules().getFilterSearchParams();\n+\n+\t\tList<String> filterCriteria = buildFilterQuery(filterSearchParams, theResourceType);\n+\n+\t\tfor (EmpiResourceSearchParamJson resourceSearchParam : myEmpiConfig.getEmpiRules().getResourceSearchParams()) {\n+\n+\t\t\tif (!isSearchParamForResource(theResourceType, resourceSearchParam)) {\n+\t\t\t\tcontinue;\n+\t\t\t}\n+\n+\t\t\t//to compare it to all known PERSON objects, using the overlapping search parameters that they have.\n+\t\t\tList<String> valuesFromResourceForSearchParam = myEmpiSearchParamSvc.getValueFromResourceForSearchParam(theResource, resourceSearchParam);\n+\t\t\tif (valuesFromResourceForSearchParam.isEmpty()) {\n+\t\t\t\tcontinue;\n+\t\t\t}\n+\n+\t\t\tsearchForIdsAndAddToMap(theResourceType, matchedPidsToResources, filterCriteria, resourceSearchParam, valuesFromResourceForSearchParam);\n+\t\t}\n+\t\t//Obviously we don't want to consider the freshly added resource as a potential candidate.\n+\t\t//Sometimes, we are running this function on a resource that has not yet been persisted,\n+\t\t//so it may not have an ID yet, precluding the need to remove it.\n+\t\tif (theResource.getIdElement().getIdPart() != null) {\n+\t\t\tmatchedPidsToResources.remove(myIdHelperService.getPidOrNull(theResource));\n+\t\t}\n+\t\treturn matchedPidsToResources.values();\n+\t}\n+\n+\tprivate boolean isSearchParamForResource(String theResourceType, EmpiResourceSearchParamJson resourceSearchParam) {\n+\t\tString resourceType = resourceSearchParam.getResourceType();\n+\t\treturn resourceType.equals(theResourceType) || resourceType.equalsIgnoreCase(ALL_RESOURCE_SEARCH_PARAM_TYPE);\n+\t}\n+\n+\t/*\n+\t * Helper method which performs too much work currently.\n+\t * 1. Build a full query string for the given filter and resource criteria.\n+\t * 2. Convert that URL to a SearchParameterMap.\n+\t * 3. Execute a Synchronous search on the DAO using that parameter map.\n+\t * 4. Store all results in `theMatchedPidsToResources`\n+\t */\n+\t@SuppressWarnings(\"rawtypes\")\n+\tprivate void searchForIdsAndAddToMap(String theResourceType, Map<Long, IAnyResource> theMatchedPidsToResources, List<String> theFilterCriteria, EmpiResourceSearchParamJson resourceSearchParam, List<String> theValuesFromResourceForSearchParam) {\n+\t\t//1.\n+\t\tString resourceCriteria = buildResourceQueryString(theResourceType, theFilterCriteria, resourceSearchParam, theValuesFromResourceForSearchParam);\n+\t\tourLog.debug(\"Searching for {} candidates with {}\", theResourceType, resourceCriteria);\n+\n+\t\t//2.\n+\t\tSearchParameterMap searchParameterMap = myEmpiSearchParamSvc.mapFromCriteria(theResourceType, resourceCriteria);\n+\n+\t\tsearchParameterMap.setLoadSynchronous(true);\n+\n+\t\t//TODO EMPI this will blow up under large scale i think.\n+\t\t//3.\n+\t\tIFhirResourceDao<?> resourceDao = myDaoRegistry.getResourceDao(theResourceType);\n+\t\tIBundleProvider search = resourceDao.search(searchParameterMap);\n+\t\tList<IBaseResource> resources = search.getResources(0, search.size());\n+\n+\t\tint initialSize = theMatchedPidsToResources.size();\n+\n+\t\t//4.\n+\t\tresources.forEach(resource -> theMatchedPidsToResources.put(myIdHelperService.getPidOrNull(resource), (IAnyResource) resource));\n+\n+\t\tint newSize = theMatchedPidsToResources.size();\n+\n+\t\tif (ourLog.isDebugEnabled()) {\n+\t\t\tourLog.debug(\"Candidate search added {} {}s\", newSize - initialSize, theResourceType);\n+\t\t}\n+\t}\n+\n+\t/*\n+\t * Given a list of criteria upon which to block, a resource search parameter, and a list of values for that given search parameter,\n+\t * build a query url. e.g.\n+\t *\n+\t * Patient?active=true&name.given=Gary,Grant\n+\t */\n+\t@Nonnull\n+\tprivate String buildResourceQueryString(String theResourceType, List<String> theFilterCriteria, EmpiResourceSearchParamJson resourceSearchParam, List<String> theValuesFromResourceForSearchParam) {\n+\t\tList<String> criteria = new ArrayList<>(theFilterCriteria);\n+\t\tcriteria.add(buildResourceMatchQuery(resourceSearchParam.getSearchParam(), theValuesFromResourceForSearchParam));\n+\n+\t\treturn theResourceType + \"?\" +  String.join(\"&\", criteria);\n+\t}\n+\n+\tprivate String buildResourceMatchQuery(String theSearchParamName, List<String> theResourceValues) {\n+\t\treturn theSearchParamName + \"=\" + String.join(\",\", theResourceValues);", "originalCommit": "ca80c73e3b39000324ff3cba701cd9108cdd280c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwMzI5OQ==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428903299", "bodyText": "Good catch!  Fixed", "author": "fil512", "createdAt": "2020-05-21T20:43:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MDIyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MjE4Mw==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428852183", "bodyText": "Ooh two spaces after the period. So uhhhhhhhhhhhhhhhhhhhhhhhhhhh the AP style guide doesn't recommend two spaces after a period so clearly like we can't have that geez", "author": "jamesagnew", "createdAt": "2020-05-21T19:01:27Z", "path": "hapi-fhir-jpaserver-empi/src/main/java/ca/uhn/fhir/jpa/empi/svc/EmpiPersonFindingSvc.java", "diffHunk": "@@ -0,0 +1,182 @@\n+package ca.uhn.fhir.jpa.empi.svc;\n+\n+/*-\n+ * #%L\n+ * HAPI FHIR JPA Server - Enterprise Master Patient Index\n+ * %%\n+ * Copyright (C) 2014 - 2020 University Health Network\n+ * %%\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ * #L%\n+ */\n+\n+import ca.uhn.fhir.context.FhirContext;\n+import ca.uhn.fhir.empi.api.EmpiMatchResultEnum;\n+import ca.uhn.fhir.empi.api.IEmpiMatchFinderSvc;\n+import ca.uhn.fhir.empi.api.MatchedTarget;\n+import ca.uhn.fhir.empi.log.Logs;\n+import ca.uhn.fhir.empi.model.CanonicalEID;\n+import ca.uhn.fhir.empi.util.EIDHelper;\n+import ca.uhn.fhir.jpa.dao.EmpiLinkDaoSvc;\n+import ca.uhn.fhir.jpa.dao.index.IdHelperService;\n+import ca.uhn.fhir.jpa.entity.EmpiLink;\n+import ca.uhn.fhir.rest.api.server.storage.ResourcePersistentId;\n+import org.hl7.fhir.instance.model.api.IAnyResource;\n+import org.hl7.fhir.instance.model.api.IBaseResource;\n+import org.slf4j.Logger;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Service;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+\n+@Service\n+public class EmpiPersonFindingSvc {\n+\tprivate static final Logger ourLog = Logs.getEmpiTroubleshootingLog();\n+\n+\t@Autowired\n+\tprivate FhirContext myFhirContext;\n+\t@Autowired\n+\tIdHelperService myIdHelperService;\n+\t@Autowired\n+\tprivate EmpiLinkDaoSvc myEmpiLinkDaoSvc;\n+\t@Autowired\n+\tprivate EmpiResourceDaoSvc myEmpiResourceDaoSvc;\n+\t@Autowired\n+\tprivate IEmpiMatchFinderSvc myEmpiMatchFinderSvc;\n+\t@Autowired\n+\tprivate EIDHelper myEIDHelper;\n+\n+\t/**\n+\t * Given an incoming IBaseResource, limited to Patient/Practitioner, return a list of {@link MatchedPersonCandidate}\n+\t * indicating possible candidates for a matching Person. Uses several separate methods for finding candidates:\n+\t * <p>\n+\t * 0. First, check the incoming Resource for an EID. If it is present, and we can find a Person with this EID, it automatically matches.\n+\t * 1. First, check link table for any entries where this baseresource is the target of a person. If found, return.\n+\t * 2. If none are found, attempt to find Person Resources which link to this theResource.\n+\t * 3. If none are found, attempt to find Persons similar to our incoming resource based on the EMPI rules and similarity metrics.\n+\t * 4. If none are found, attempt to find Persons that are linked to Patients/Practitioners that are similar to our incoming resource based on the EMPI rules and\n+\t * similarity metrics.\n+\t *\n+\t * @param theResource the {@link IBaseResource} we are attempting to find matching candidate Persons for.\n+\t * @return A list of {@link MatchedPersonCandidate} indicating all potential Person matches.\n+\t */\n+\tpublic List<MatchedPersonCandidate> findPersonCandidates(IAnyResource theResource) {\n+\t\tList<MatchedPersonCandidate> matchedPersonCandidates = attemptToFindPersonCandidateFromIncomingEID(theResource);\n+\t\tif (matchedPersonCandidates.isEmpty()) {\n+\t\t\tmatchedPersonCandidates = attemptToFindPersonCandidateFromEmpiLinkTable(theResource);\n+\t\t}\n+\t\tif (matchedPersonCandidates.isEmpty()) {\n+\t\t\t//OK, so we have not found any links in the EmpiLink table with us as a target. Next, let's find possible Patient/Practitioner\n+\t\t\t//matches by following EMPI rules.\n+\n+\t\t\tmatchedPersonCandidates = attemptToFindPersonCandidateFromSimilarTargetResource(theResource);\n+\t\t}\n+\t\treturn matchedPersonCandidates;\n+\t}\n+\n+\tprivate List<MatchedPersonCandidate> attemptToFindPersonCandidateFromIncomingEID(IAnyResource theBaseResource) {\n+\t\tList<MatchedPersonCandidate> retval = new ArrayList<>();\n+\n+\t\tList<CanonicalEID> eidFromResource = myEIDHelper.getExternalEid(theBaseResource);\n+\t\tif (!eidFromResource.isEmpty()) {\n+\t\t\tfor (CanonicalEID eid : eidFromResource) {\n+\t\t\t\tIBaseResource foundPerson = myEmpiResourceDaoSvc.searchPersonByEid(eid.getValue());\n+\t\t\t\tif (foundPerson != null) {\n+\t\t\t\t\tLong pidOrNull = myIdHelperService.getPidOrNull(foundPerson);\n+\t\t\t\t\tMatchedPersonCandidate mpc = new MatchedPersonCandidate(new ResourcePersistentId(pidOrNull), EmpiMatchResultEnum.MATCH);\n+\t\t\t\t\tourLog.debug(\"Matched {} by EID {}\", foundPerson.getIdElement(), eid);\n+\t\t\t\t\tretval.add(mpc);\n+\t\t\t\t}\n+\t\t\t}\n+\t\t}\n+\t\treturn retval;\n+\t}\n+\n+\t/**\n+\t * Attempt to find a currently matching Person, based on the presence of an {@link EmpiLink} entity.\n+\t *\n+\t * @param theBaseResource the {@link IAnyResource} that we want to find candidate Persons for.\n+\t * @return an Optional list of {@link MatchedPersonCandidate} indicating matches.\n+\t */\n+\tprivate List<MatchedPersonCandidate> attemptToFindPersonCandidateFromEmpiLinkTable(IAnyResource theBaseResource) {\n+\t\tList<MatchedPersonCandidate> retval = new ArrayList<>();\n+\n+\t\tLong targetPid = myIdHelperService.getPidOrNull(theBaseResource);\n+\t\tif (targetPid != null) {\n+\t\t\tOptional<EmpiLink> oLink = myEmpiLinkDaoSvc.getMatchedLinkForTargetPid(targetPid);\n+\t\t\tif (oLink.isPresent()) {\n+\t\t\t\tResourcePersistentId personPid = new ResourcePersistentId(oLink.get().getPersonPid());\n+\t\t\t\tourLog.debug(\"Resource previously linked.  Using existing link.\");", "originalCommit": "ca80c73e3b39000324ff3cba701cd9108cdd280c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg2OTYwMw==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428869603", "bodyText": "I learned to type in 1979 on a manual typewriter and had two spaces DRILLED into my soul.  I have tried.  I cannot change this.  It is too deeply engrained.", "author": "fil512", "createdAt": "2020-05-21T19:36:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MjE4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg3OTA4Mw==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428879083", "bodyText": "", "author": "tadgh", "createdAt": "2020-05-21T19:54:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MjE4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg3OTM2OA==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428879368", "bodyText": "resolved in 78babeb", "author": "tadgh", "createdAt": "2020-05-21T19:55:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MjE4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg5ODg2Ng==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428898866", "bodyText": "hahahaha", "author": "jamesagnew", "createdAt": "2020-05-21T20:34:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MjE4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1NTA0NA==", "url": "https://github.com/hapifhir/hapi-fhir/pull/1857#discussion_r428855044", "bodyText": "These typesafematchers are really cool!", "author": "jamesagnew", "createdAt": "2020-05-21T19:07:02Z", "path": "hapi-fhir-jpaserver-empi/src/test/java/ca/uhn/fhir/jpa/empi/matcher/BasePersonMatcher.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package ca.uhn.fhir.jpa.empi.matcher;\n+\n+import ca.uhn.fhir.empi.api.EmpiMatchResultEnum;\n+import ca.uhn.fhir.jpa.dao.EmpiLinkDaoSvc;\n+import ca.uhn.fhir.jpa.dao.index.IdHelperService;\n+import ca.uhn.fhir.jpa.entity.EmpiLink;\n+import org.hamcrest.TypeSafeMatcher;\n+import org.hl7.fhir.instance.model.api.IAnyResource;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import javax.annotation.Nullable;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+public abstract class BasePersonMatcher extends TypeSafeMatcher<IAnyResource> {", "originalCommit": "ca80c73e3b39000324ff3cba701cd9108cdd280c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "82b3756ffd9db6b48dac4acfd1caa841536e69dd", "url": "https://github.com/hapifhir/hapi-fhir/commit/82b3756ffd9db6b48dac4acfd1caa841536e69dd", "message": "Add change information for method rename in FhirContext", "committedDate": "2020-05-21T19:28:51Z", "type": "commit"}, {"oid": "71ddec04a6e99b6140f17bb237f022743b2d8f72", "url": "https://github.com/hapifhir/hapi-fhir/commit/71ddec04a6e99b6140f17bb237f022743b2d8f72", "message": "Update hapi-fhir-docs/src/main/resources/ca/uhn/hapi/fhir/docs/server_jpa_empi/empi.md\n\nCo-authored-by: James Agnew <jamesagnew@gmail.com>", "committedDate": "2020-05-21T19:31:09Z", "type": "commit"}, {"oid": "78babeb104e176af843a903bf1d5c98cdb472cf7", "url": "https://github.com/hapifhir/hapi-fhir/commit/78babeb104e176af843a903bf1d5c98cdb472cf7", "message": "Subscribe to AP guidelines", "committedDate": "2020-05-21T19:57:06Z", "type": "commit"}, {"oid": "eba4ec1ec347b23813cb6c31425d3a11f21d0e87", "url": "https://github.com/hapifhir/hapi-fhir/commit/eba4ec1ec347b23813cb6c31425d3a11f21d0e87", "message": "Rename normalizeString to normalizeStringForSearchIndexing", "committedDate": "2020-05-21T20:32:16Z", "type": "commit"}, {"oid": "ec2b169b7e75644bd1e85cb314bb7dd87cfc786e", "url": "https://github.com/hapifhir/hapi-fhir/commit/ec2b169b7e75644bd1e85cb314bb7dd87cfc786e", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-21T20:32:21Z", "type": "commit"}, {"oid": "8ce96f755697ac4b799c34962ac7b3495be10805", "url": "https://github.com/hapifhir/hapi-fhir/commit/8ce96f755697ac4b799c34962ac7b3495be10805", "message": "Remove OptimisticLock", "committedDate": "2020-05-21T20:39:01Z", "type": "commit"}, {"oid": "6a6111ab6a178c79306a0224e5d648660bd7ac09", "url": "https://github.com/hapifhir/hapi-fhir/commit/6a6111ab6a178c79306a0224e5d648660bd7ac09", "message": "add indexes to empilink. Add indexes to HapiFhirJpaMigrationTasks in new 5.1.0 section", "committedDate": "2020-05-21T21:20:22Z", "type": "commit"}, {"oid": "b3a0d8adda261ed17b9b7c78e237b83ef4201a6f", "url": "https://github.com/hapifhir/hapi-fhir/commit/b3a0d8adda261ed17b9b7c78e237b83ef4201a6f", "message": "Copy-paste error in migration", "committedDate": "2020-05-21T21:58:19Z", "type": "commit"}, {"oid": "c5e66289f336b177e8adb732e04fdedbd392c9c9", "url": "https://github.com/hapifhir/hapi-fhir/commit/c5e66289f336b177e8adb732e04fdedbd392c9c9", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/interceptor/auth/OperationRule.java", "committedDate": "2020-05-22T12:50:17Z", "type": "commit"}, {"oid": "38cb95d6e4bf9a6a052dda668a50bda56793d7a2", "url": "https://github.com/hapifhir/hapi-fhir/commit/38cb95d6e4bf9a6a052dda668a50bda56793d7a2", "message": "fix compile", "committedDate": "2020-05-22T14:56:05Z", "type": "commit"}, {"oid": "ff1633d511accf389392ad935e64dbf80656c7da", "url": "https://github.com/hapifhir/hapi-fhir/commit/ff1633d511accf389392ad935e64dbf80656c7da", "message": "Revert \"add indexes to empilink. Add indexes to HapiFhirJpaMigrationTasks in new 5.1.0 section\"\n\nThis reverts commit 6a6111ab6a178c79306a0224e5d648660bd7ac09.", "committedDate": "2020-05-22T17:59:17Z", "type": "commit"}, {"oid": "bccd7bdbaa6d6ae94163ba0eba550dd2a020facb", "url": "https://github.com/hapifhir/hapi-fhir/commit/bccd7bdbaa6d6ae94163ba0eba550dd2a020facb", "message": "Finished expunge interceptor", "committedDate": "2020-05-04T13:40:22Z", "type": "commit"}, {"oid": "677618271fd1c49c62f2d7a9967c00fd29b75e30", "url": "https://github.com/hapifhir/hapi-fhir/commit/677618271fd1c49c62f2d7a9967c00fd29b75e30", "message": "FIXME", "committedDate": "2020-05-04T14:13:10Z", "type": "commit"}, {"oid": "1739dfec516e60bf1f9a50240df34b9fedb629c9", "url": "https://github.com/hapifhir/hapi-fhir/commit/1739dfec516e60bf1f9a50240df34b9fedb629c9", "message": "FIXME", "committedDate": "2020-05-04T14:18:51Z", "type": "commit"}, {"oid": "948a09cb313c1061ffaf84f4cb9787eedcf79ae2", "url": "https://github.com/hapifhir/hapi-fhir/commit/948a09cb313c1061ffaf84f4cb9787eedcf79ae2", "message": "TODO cleanup", "committedDate": "2020-05-04T14:21:31Z", "type": "commit"}, {"oid": "57bf26d5512c99d047015f291a3a34cc48b0d0f6", "url": "https://github.com/hapifhir/hapi-fhir/commit/57bf26d5512c99d047015f291a3a34cc48b0d0f6", "message": "move expunge empi link call one level down so persistence doesn't need to pull in all the other empi services", "committedDate": "2020-05-04T22:01:38Z", "type": "commit"}, {"oid": "f9fa959062bdd5ecf3f417d79c59e344ed0906b6", "url": "https://github.com/hapifhir/hapi-fhir/commit/f9fa959062bdd5ecf3f417d79c59e344ed0906b6", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-05T15:11:32Z", "type": "commit"}, {"oid": "719ca6176dc58409bb6fb52826b4b4c0a708f8d0", "url": "https://github.com/hapifhir/hapi-fhir/commit/719ca6176dc58409bb6fb52826b4b4c0a708f8d0", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-jpaserver-model/src/main/java/ca/uhn/fhir/jpa/model/entity/ResourceIndexedSearchParamString.java\n#\thapi-fhir-jpaserver-model/src/main/java/ca/uhn/fhir/jpa/model/entity/ResourceIndexedSearchParamToken.java", "committedDate": "2020-05-05T15:13:27Z", "type": "commit"}, {"oid": "aa028a1894e8738e15c2a12b8208d5d006bfdc3e", "url": "https://github.com/hapifhir/hapi-fhir/commit/aa028a1894e8738e15c2a12b8208d5d006bfdc3e", "message": "started coding mergePerson().  Failing test", "committedDate": "2020-05-05T16:16:44Z", "type": "commit"}, {"oid": "49620500c9bd36d5bf73cf08b86a89bc61cc8139", "url": "https://github.com/hapifhir/hapi-fhir/commit/49620500c9bd36d5bf73cf08b86a89bc61cc8139", "message": "field merging works", "committedDate": "2020-05-05T17:17:46Z", "type": "commit"}, {"oid": "69c594c863f3b4111f1788307e9fbffb2c8bec55", "url": "https://github.com/hapifhir/hapi-fhir/commit/69c594c863f3b4111f1788307e9fbffb2c8bec55", "message": "Add strict eid mode to empi settings. Add test to ensure in strict mode we can't modify an EID on update", "committedDate": "2020-05-05T18:07:43Z", "type": "commit"}, {"oid": "852a3d3ee57a99fc892218b34eec3a87536b8bdc", "url": "https://github.com/hapifhir/hapi-fhir/commit/852a3d3ee57a99fc892218b34eec3a87536b8bdc", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-05T18:07:48Z", "type": "commit"}, {"oid": "cbae29eba9890ba6a3fa7a063137a9eca2eaef96", "url": "https://github.com/hapifhir/hapi-fhir/commit/cbae29eba9890ba6a3fa7a063137a9eca2eaef96", "message": "first merge link test done", "committedDate": "2020-05-05T19:09:10Z", "type": "commit"}, {"oid": "bce2c16a0f267a56ec05025c7b4f0ee44e3b7add", "url": "https://github.com/hapifhir/hapi-fhir/commit/bce2c16a0f267a56ec05025c7b4f0ee44e3b7add", "message": "Add test for non-strict mode", "committedDate": "2020-05-05T19:12:56Z", "type": "commit"}, {"oid": "6b11c5d9570ba53cda5687ff5033753dd6f45b2e", "url": "https://github.com/hapifhir/hapi-fhir/commit/6b11c5d9570ba53cda5687ff5033753dd6f45b2e", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-05T19:12:59Z", "type": "commit"}, {"oid": "d190e80a9759f4d4a758d007607682be0c4b61ff", "url": "https://github.com/hapifhir/hapi-fhir/commit/d190e80a9759f4d4a758d007607682be0c4b61ff", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-jpaserver-searchparam/src/main/java/ca/uhn/fhir/jpa/searchparam/extractor/BaseSearchParamExtractor.java", "committedDate": "2020-05-05T19:12:49Z", "type": "commit"}, {"oid": "a465de0799bb0d2ac4ccb15214c907de44d9e5b1", "url": "https://github.com/hapifhir/hapi-fhir/commit/a465de0799bb0d2ac4ccb15214c907de44d9e5b1", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-base/src/main/java/ca/uhn/fhir/interceptor/api/Pointcut.java\n#\thapi-fhir-docs/src/main/resources/ca/uhn/hapi/fhir/docs/files.properties\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/index/IdHelperService.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/partition/RequestPartitionHelperSvc.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/search/SearchCoordinatorSvcImpl.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/term/TermCodeSystemStorageSvcImpl.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/BaseJpaTest.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/dstu2/FhirResourceDaoDstu2Test.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/r4/BaseJpaR4Test.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoR4SearchNoFtTest.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/partition/PartitionManagementProviderTest.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/provider/r4/MultitenantServerR4Test.java", "committedDate": "2020-05-05T20:31:14Z", "type": "commit"}, {"oid": "90f7164ae72fff8099458d91db2041666ff2bc18", "url": "https://github.com/hapifhir/hapi-fhir/commit/90f7164ae72fff8099458d91db2041666ff2bc18", "message": "fix compile", "committedDate": "2020-05-05T20:45:24Z", "type": "commit"}, {"oid": "10a61d24fcc776ec0c132d9cca9596c764bab84b", "url": "https://github.com/hapifhir/hapi-fhir/commit/10a61d24fcc776ec0c132d9cca9596c764bab84b", "message": "Fix typo", "committedDate": "2020-05-05T22:29:43Z", "type": "commit"}, {"oid": "031b42eb4bf4e38e8fb497a872571baba94b16c5", "url": "https://github.com/hapifhir/hapi-fhir/commit/031b42eb4bf4e38e8fb497a872571baba94b16c5", "message": "fix compile", "committedDate": "2020-05-05T22:31:30Z", "type": "commit"}, {"oid": "009b0959cac1105c211cd84687427f513c600840", "url": "https://github.com/hapifhir/hapi-fhir/commit/009b0959cac1105c211cd84687427f513c600840", "message": "Merge remote-tracking branch 'origin/ks-20200312-empi1' into ks-20200312-empi1", "committedDate": "2020-05-05T22:31:42Z", "type": "commit"}, {"oid": "2ee1de88ad4395083b60c1661b514c59e3d09fb0", "url": "https://github.com/hapifhir/hapi-fhir/commit/2ee1de88ad4395083b60c1661b514c59e3d09fb0", "message": "moar person merge tests", "committedDate": "2020-05-05T22:37:03Z", "type": "commit"}, {"oid": "9e609518234266cf4b7888c03aee1f9218b74992", "url": "https://github.com/hapifhir/hapi-fhir/commit/9e609518234266cf4b7888c03aee1f9218b74992", "message": "Minor refactor. Support overwriting EID on update", "committedDate": "2020-05-06T03:28:52Z", "type": "commit"}, {"oid": "617e33d2dd9a8dd6545b7c67f5800d6ea1dbfa40", "url": "https://github.com/hapifhir/hapi-fhir/commit/617e33d2dd9a8dd6545b7c67f5800d6ea1dbfa40", "message": "wip", "committedDate": "2020-05-06T03:39:50Z", "type": "commit"}, {"oid": "d6026a315692b65b5685a636ea0a09d7d83a980b", "url": "https://github.com/hapifhir/hapi-fhir/commit/d6026a315692b65b5685a636ea0a09d7d83a980b", "message": "wip fixing up some logic and naming", "committedDate": "2020-05-06T05:06:00Z", "type": "commit"}, {"oid": "05fb460aac0012ff3b1f0a7f9173176c019fbfcd", "url": "https://github.com/hapifhir/hapi-fhir/commit/05fb460aac0012ff3b1f0a7f9173176c019fbfcd", "message": "Fixing a bug in duplicate finding. CWT", "committedDate": "2020-05-06T05:07:52Z", "type": "commit"}, {"oid": "fe1da96ab8b20bc0af7e2622e654f90fd3299d03", "url": "https://github.com/hapifhir/hapi-fhir/commit/fe1da96ab8b20bc0af7e2622e654f90fd3299d03", "message": "initial link merge working", "committedDate": "2020-05-06T15:15:32Z", "type": "commit"}, {"oid": "7812c12835e10cd84b1c737d6cd153b78f31621d", "url": "https://github.com/hapifhir/hapi-fhir/commit/7812c12835e10cd84b1c737d6cd153b78f31621d", "message": "initial link merge working", "committedDate": "2020-05-06T15:34:43Z", "type": "commit"}, {"oid": "353c415f0a8474de1ef1ec036d06af3bb0c79781", "url": "https://github.com/hapifhir/hapi-fhir/commit/353c415f0a8474de1ef1ec036d06af3bb0c79781", "message": "Add EmpiTransactionContext object, refactor for context object", "committedDate": "2020-05-06T17:49:27Z", "type": "commit"}, {"oid": "53c9de13eae7a0ee92710334b2f98088c85fd095", "url": "https://github.com/hapifhir/hapi-fhir/commit/53c9de13eae7a0ee92710334b2f98088c85fd095", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-06T17:49:32Z", "type": "commit"}, {"oid": "ca4ca1d777c88ca35f7d3ec82bc1216747f39e95", "url": "https://github.com/hapifhir/hapi-fhir/commit/ca4ca1d777c88ca35f7d3ec82bc1216747f39e95", "message": "rename strict mode to prevent_eid_updates", "committedDate": "2020-05-06T18:42:45Z", "type": "commit"}, {"oid": "81cf0a4325da2714499d7a8b96e0e0c558e25651", "url": "https://github.com/hapifhir/hapi-fhir/commit/81cf0a4325da2714499d7a8b96e0e0c558e25651", "message": "added more link scenarios, added delete and person.link merging", "committedDate": "2020-05-06T20:33:25Z", "type": "commit"}, {"oid": "a201ee4f790bba93bdec176c2eba09d06adf51b6", "url": "https://github.com/hapifhir/hapi-fhir/commit/a201ee4f790bba93bdec176c2eba09d06adf51b6", "message": "Merge remote-tracking branch 'origin/ks-20200312-empi1' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-jpaserver-empi/src/test/java/ca/uhn/fhir/jpa/empi/svc/EmpiPersonMergerSvcTest.java\n#\thapi-fhir-server-empi/src/main/java/ca/uhn/fhir/empi/api/IEmpiLinkSvc.java\n#\thapi-fhir-server-empi/src/main/java/ca/uhn/fhir/empi/util/PersonHelper.java", "committedDate": "2020-05-06T20:36:32Z", "type": "commit"}, {"oid": "8b466f516fe2c5c86fabfef04e834714c64dfdac", "url": "https://github.com/hapifhir/hapi-fhir/commit/8b466f516fe2c5c86fabfef04e834714c64dfdac", "message": "rename", "committedDate": "2020-05-06T20:48:05Z", "type": "commit"}, {"oid": "54473dc7171574949d3c2f3a230ea9ecb33aaa08", "url": "https://github.com/hapifhir/hapi-fhir/commit/54473dc7171574949d3c2f3a230ea9ecb33aaa08", "message": "Fix regressions caused by no longer allowing null contexts", "committedDate": "2020-05-06T21:03:58Z", "type": "commit"}, {"oid": "529c9464332f0a1730360462e97d9e4dd203561e", "url": "https://github.com/hapifhir/hapi-fhir/commit/529c9464332f0a1730360462e97d9e4dd203561e", "message": "Partially done adding tests for multiple eid mode", "committedDate": "2020-05-07T00:13:11Z", "type": "commit"}, {"oid": "1f08d26067139f130b7e086235fbb2b9f8aad51e", "url": "https://github.com/hapifhir/hapi-fhir/commit/1f08d26067139f130b7e086235fbb2b9f8aad51e", "message": "added mergePersons to providers and added providers test", "committedDate": "2020-05-07T14:05:46Z", "type": "commit"}, {"oid": "5cd6d540066143b4f87a35620171280ca91f1850", "url": "https://github.com/hapifhir/hapi-fhir/commit/5cd6d540066143b4f87a35620171280ca91f1850", "message": "added test for provider match", "committedDate": "2020-05-07T14:10:27Z", "type": "commit"}, {"oid": "c1e292e7aee424435733536d9432535309879d5c", "url": "https://github.com/hapifhir/hapi-fhir/commit/c1e292e7aee424435733536d9432535309879d5c", "message": "constant param names", "committedDate": "2020-05-07T14:22:57Z", "type": "commit"}, {"oid": "32f81d64f17664e54b7c017701578d966cfe2d26", "url": "https://github.com/hapifhir/hapi-fhir/commit/32f81d64f17664e54b7c017701578d966cfe2d26", "message": "move test back into interceptortest file", "committedDate": "2020-05-07T16:53:27Z", "type": "commit"}, {"oid": "4c2c124d24e4c8278356ed93e3eec073a4097b89", "url": "https://github.com/hapifhir/hapi-fhir/commit/4c2c124d24e4c8278356ed93e3eec073a4097b89", "message": "fix possible duplicate link copy bug", "committedDate": "2020-05-07T17:58:53Z", "type": "commit"}, {"oid": "d940778009e56679ef6b6388439a0b2d40fc5a89", "url": "https://github.com/hapifhir/hapi-fhir/commit/d940778009e56679ef6b6388439a0b2d40fc5a89", "message": "rework allow to prevent for consistency", "committedDate": "2020-05-07T18:14:02Z", "type": "commit"}, {"oid": "f41729d2abbdb380f57e0f0391192e0951f8b2e4", "url": "https://github.com/hapifhir/hapi-fhir/commit/f41729d2abbdb380f57e0f0391192e0951f8b2e4", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-07T18:14:06Z", "type": "commit"}, {"oid": "878aa9c8d686379722ddf6a499350624b67ba21f", "url": "https://github.com/hapifhir/hapi-fhir/commit/878aa9c8d686379722ddf6a499350624b67ba21f", "message": "fix npe", "committedDate": "2020-05-07T18:18:04Z", "type": "commit"}, {"oid": "e8d348541f582f40a402ece9696b91cfa845a706", "url": "https://github.com/hapifhir/hapi-fhir/commit/e8d348541f582f40a402ece9696b91cfa845a706", "message": "#2 Person merge MANUAL links override AUTO links", "committedDate": "2020-05-07T19:41:48Z", "type": "commit"}, {"oid": "e13db32d9cff0819070cd701aa2de4a680887b56", "url": "https://github.com/hapifhir/hapi-fhir/commit/e13db32d9cff0819070cd701aa2de4a680887b56", "message": "Wip adding update tests", "committedDate": "2020-05-07T20:24:24Z", "type": "commit"}, {"oid": "0e08eb4852610084b9f08ee6b50b82fe7718af05", "url": "https://github.com/hapifhir/hapi-fhir/commit/0e08eb4852610084b9f08ee6b50b82fe7718af05", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-07T20:24:26Z", "type": "commit"}, {"oid": "dc1ccde2ae25807f6c6be53f29827c5f035000e5", "url": "https://github.com/hapifhir/hapi-fhir/commit/dc1ccde2ae25807f6c6be53f29827c5f035000e5", "message": "Unignore test for update", "committedDate": "2020-05-07T21:17:36Z", "type": "commit"}, {"oid": "6c47c7f9fee444edaffa767aa8cd1e00fb8fdd68", "url": "https://github.com/hapifhir/hapi-fhir/commit/6c47c7f9fee444edaffa767aa8cd1e00fb8fdd68", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/delete/DeleteConflictService.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/term/BaseTermReadSvcImpl.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/dstu2/FhirResourceDaoDstu2Test.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/dstu3/FhirResourceDaoDstu3Test.java\n#\thapi-fhir-jpaserver-searchparam/src/main/java/ca/uhn/fhir/jpa/searchparam/extractor/SearchParamExtractorService.java\n#\thapi-fhir-jpaserver-searchparam/src/main/java/ca/uhn/fhir/jpa/searchparam/matcher/IndexedSearchParamExtractor.java", "committedDate": "2020-05-08T12:35:11Z", "type": "commit"}, {"oid": "ef05ff2ca1a2f2c2c0be981cfc4bc4273113f0a8", "url": "https://github.com/hapifhir/hapi-fhir/commit/ef05ff2ca1a2f2c2c0be981cfc4bc4273113f0a8", "message": "small constant cleanup", "committedDate": "2020-05-08T12:36:17Z", "type": "commit"}, {"oid": "d18a7771efc729e9d5e758f30e2c4889bdc37805", "url": "https://github.com/hapifhir/hapi-fhir/commit/d18a7771efc729e9d5e758f30e2c4889bdc37805", "message": "compile fixes", "committedDate": "2020-05-08T12:54:55Z", "type": "commit"}, {"oid": "8065ca6f74f77ac4f6fe9390c364da9bc7ac0170", "url": "https://github.com/hapifhir/hapi-fhir/commit/8065ca6f74f77ac4f6fe9390c364da9bc7ac0170", "message": "add sync test", "committedDate": "2020-05-08T13:39:08Z", "type": "commit"}, {"oid": "f0c759ca07324ba2d56ddf0a6a0158576bca720e", "url": "https://github.com/hapifhir/hapi-fhir/commit/f0c759ca07324ba2d56ddf0a6a0158576bca720e", "message": "replace enum checks with accessors", "committedDate": "2020-05-08T14:15:23Z", "type": "commit"}, {"oid": "f9e0e9da6159c2d816c7cdc3113b160f033b1b50", "url": "https://github.com/hapifhir/hapi-fhir/commit/f9e0e9da6159c2d816c7cdc3113b160f033b1b50", "message": "improve test", "committedDate": "2020-05-08T14:23:53Z", "type": "commit"}, {"oid": "f3a23b2d36a12cd3a4cc339118859a84e47c8b36", "url": "https://github.com/hapifhir/hapi-fhir/commit/f3a23b2d36a12cd3a4cc339118859a84e47c8b36", "message": "changed api to IAnyResource", "committedDate": "2020-05-08T15:01:39Z", "type": "commit"}, {"oid": "ac92274656a39fa0f5327d3ba7f3ab903c3f452d", "url": "https://github.com/hapifhir/hapi-fhir/commit/ac92274656a39fa0f5327d3ba7f3ab903c3f452d", "message": "Move Interceptor bean definitions to ConsumerConfigCtx. Add Iface for interceptor", "committedDate": "2020-05-08T19:15:23Z", "type": "commit"}, {"oid": "2a86e0effd10f440115a405d8284559ba6bb8061", "url": "https://github.com/hapifhir/hapi-fhir/commit/2a86e0effd10f440115a405d8284559ba6bb8061", "message": "added transaction log for merge persons", "committedDate": "2020-05-08T20:21:55Z", "type": "commit"}, {"oid": "f98b2b3de42f96af6c26f63d81d48d8d4b6ff2da", "url": "https://github.com/hapifhir/hapi-fhir/commit/f98b2b3de42f96af6c26f63d81d48d8d4b6ff2da", "message": "removed unused field in EmpiTransactionContext", "committedDate": "2020-05-08T20:46:26Z", "type": "commit"}, {"oid": "0f9e9ffba4b67d8a8d2512441b2e74d956013674", "url": "https://github.com/hapifhir/hapi-fhir/commit/0f9e9ffba4b67d8a8d2512441b2e74d956013674", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-09T19:09:15Z", "type": "commit"}, {"oid": "a8937e03dfed05c82e71071050a1c7b789b35305", "url": "https://github.com/hapifhir/hapi-fhir/commit/a8937e03dfed05c82e71071050a1c7b789b35305", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-11T13:00:41Z", "type": "commit"}, {"oid": "64d9b4cc771983ed3e07a5b9ea433047eb408e2f", "url": "https://github.com/hapifhir/hapi-fhir/commit/64d9b4cc771983ed3e07a5b9ea433047eb408e2f", "message": "First pass at empi possible match query", "committedDate": "2020-05-11T14:13:26Z", "type": "commit"}, {"oid": "4fd952ae62da98c7ca5f527de57aa8de20be91ce", "url": "https://github.com/hapifhir/hapi-fhir/commit/4fd952ae62da98c7ca5f527de57aa8de20be91ce", "message": "added tests", "committedDate": "2020-05-11T14:39:42Z", "type": "commit"}, {"oid": "6a7b24456cd9088405f9d4c3c0050ac7f83a1dcc", "url": "https://github.com/hapifhir/hapi-fhir/commit/6a7b24456cd9088405f9d4c3c0050ac7f83a1dcc", "message": "update empilink service happy path", "committedDate": "2020-05-11T18:59:00Z", "type": "commit"}, {"oid": "f00a3c1e1ea15bb538bad76de7f40839e8301455", "url": "https://github.com/hapifhir/hapi-fhir/commit/f00a3c1e1ea15bb538bad76de7f40839e8301455", "message": "all errors covered", "committedDate": "2020-05-11T19:18:36Z", "type": "commit"}, {"oid": "1efa05b1f8584b1fe9543b204f0fe1bfc9e3a8f7", "url": "https://github.com/hapifhir/hapi-fhir/commit/1efa05b1f8584b1fe9543b204f0fe1bfc9e3a8f7", "message": "added update link provider methods", "committedDate": "2020-05-11T22:05:04Z", "type": "commit"}, {"oid": "94d3fd6400b574d546f7677387b7902bfe906e47", "url": "https://github.com/hapifhir/hapi-fhir/commit/94d3fd6400b574d546f7677387b7902bfe906e47", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-11T22:05:32Z", "type": "commit"}, {"oid": "ee4ad478b40b8dfd2cf29a1571c842839918c8ac", "url": "https://github.com/hapifhir/hapi-fhir/commit/ee4ad478b40b8dfd2cf29a1571c842839918c8ac", "message": "Add flags for the ability to override attributes. Write tests to ensure logic is correct", "committedDate": "2020-05-11T22:36:18Z", "type": "commit"}, {"oid": "ab90d98896254d66bba7a322b26d66369818ca0f", "url": "https://github.com/hapifhir/hapi-fhir/commit/ab90d98896254d66bba7a322b26d66369818ca0f", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-11T22:36:21Z", "type": "commit"}, {"oid": "b2d96b269db23b5aa27d441ab82ea184eeb3792d", "url": "https://github.com/hapifhir/hapi-fhir/commit/b2d96b269db23b5aa27d441ab82ea184eeb3792d", "message": "Fix bug in update logic", "committedDate": "2020-05-11T23:27:05Z", "type": "commit"}, {"oid": "dcd7de6f9df06263195a54984ff0876134fed6a4", "url": "https://github.com/hapifhir/hapi-fhir/commit/dcd7de6f9df06263195a54984ff0876134fed6a4", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\tpom.xml", "committedDate": "2020-05-12T16:53:38Z", "type": "commit"}, {"oid": "0a5e9ae154f0b95455768c332c8d8bfcb2ba67af", "url": "https://github.com/hapifhir/hapi-fhir/commit/0a5e9ae154f0b95455768c332c8d8bfcb2ba67af", "message": "hapi-fhir builds now", "committedDate": "2020-05-12T17:27:51Z", "type": "commit"}, {"oid": "65dd5f84a746592cb7452d64b1e3fea6e5d60d0b", "url": "https://github.com/hapifhir/hapi-fhir/commit/65dd5f84a746592cb7452d64b1e3fea6e5d60d0b", "message": "added empi_operations documentation", "committedDate": "2020-05-12T18:51:01Z", "type": "commit"}, {"oid": "2ff4fef67b797b03afdcfba58818ce8db23fe7c3", "url": "https://github.com/hapifhir/hapi-fhir/commit/2ff4fef67b797b03afdcfba58818ce8db23fe7c3", "message": "added first draft of operations documentation", "committedDate": "2020-05-12T18:54:27Z", "type": "commit"}, {"oid": "e9c7fa9eacf9647a23d003593392936ad9cd50a2", "url": "https://github.com/hapifhir/hapi-fhir/commit/e9c7fa9eacf9647a23d003593392936ad9cd50a2", "message": "added first draft of operations documentation", "committedDate": "2020-05-12T18:55:13Z", "type": "commit"}, {"oid": "cdb8bdc8348a62dac7f0dc2489a420fdbb1ac15e", "url": "https://github.com/hapifhir/hapi-fhir/commit/cdb8bdc8348a62dac7f0dc2489a420fdbb1ac15e", "message": "fix docs", "committedDate": "2020-05-12T21:45:19Z", "type": "commit"}, {"oid": "df801486dffca10fb92888f41e7902214250816a", "url": "https://github.com/hapifhir/hapi-fhir/commit/df801486dffca10fb92888f41e7902214250816a", "message": "fix docs", "committedDate": "2020-05-12T22:02:49Z", "type": "commit"}, {"oid": "ab0521e4acb96df36874a9414eea16585a1a9cd6", "url": "https://github.com/hapifhir/hapi-fhir/commit/ab0521e4acb96df36874a9414eea16585a1a9cd6", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-13T14:09:09Z", "type": "commit"}, {"oid": "a2e140dcc8049e7a2b9292fb1396b4cf189d7d65", "url": "https://github.com/hapifhir/hapi-fhir/commit/a2e140dcc8049e7a2b9292fb1396b4cf189d7d65", "message": "5.1.0-SNAPSHOT", "committedDate": "2020-05-13T14:15:58Z", "type": "commit"}, {"oid": "c6292fe124bddc8a12c76f241738c504ba119292", "url": "https://github.com/hapifhir/hapi-fhir/commit/c6292fe124bddc8a12c76f241738c504ba119292", "message": "licences", "committedDate": "2020-05-13T18:07:40Z", "type": "commit"}, {"oid": "4262b5428bb83e17654a1d6319d7b809a0339981", "url": "https://github.com/hapifhir/hapi-fhir/commit/4262b5428bb83e17654a1d6319d7b809a0339981", "message": "remove resource check on forbidding based on EMPI-MANAGED tag", "committedDate": "2020-05-13T19:19:44Z", "type": "commit"}, {"oid": "7d7f94327c27f61ea4461f7f5ce0c1d45edbf68a", "url": "https://github.com/hapifhir/hapi-fhir/commit/7d7f94327c27f61ea4461f7f5ce0c1d45edbf68a", "message": "added queryLinks provider operation", "committedDate": "2020-05-13T22:26:27Z", "type": "commit"}, {"oid": "885999fac1d73a7162959ee9dec800b8d3dcd2e9", "url": "https://github.com/hapifhir/hapi-fhir/commit/885999fac1d73a7162959ee9dec800b8d3dcd2e9", "message": "fix tests", "committedDate": "2020-05-13T22:46:21Z", "type": "commit"}, {"oid": "5179f14f261cc3fbb6e47f79f464d961e6271ccd", "url": "https://github.com/hapifhir/hapi-fhir/commit/5179f14f261cc3fbb6e47f79f464d961e6271ccd", "message": "add duplicate persons operation", "committedDate": "2020-05-13T23:23:33Z", "type": "commit"}, {"oid": "d23e27d0f4ccea2688eab6e273935d05648e7cf4", "url": "https://github.com/hapifhir/hapi-fhir/commit/d23e27d0f4ccea2688eab6e273935d05648e7cf4", "message": "update docs for new operations", "committedDate": "2020-05-14T20:54:39Z", "type": "commit"}, {"oid": "7ade1e943163f2dacd71a0b2f843b1a4382280af", "url": "https://github.com/hapifhir/hapi-fhir/commit/7ade1e943163f2dacd71a0b2f843b1a4382280af", "message": "added empi link created and updated columns", "committedDate": "2020-05-14T22:36:05Z", "type": "commit"}, {"oid": "885d22d615f70771502dd09400f6097191465acf", "url": "https://github.com/hapifhir/hapi-fhir/commit/885d22d615f70771502dd09400f6097191465acf", "message": "added EmpiLink created and updated columns", "committedDate": "2020-05-14T22:36:27Z", "type": "commit"}, {"oid": "c6c9ba8eb009551c63ca27a8bb055788bde49656", "url": "https://github.com/hapifhir/hapi-fhir/commit/c6c9ba8eb009551c63ca27a8bb055788bde49656", "message": "remove IResourceTableDao dependency", "committedDate": "2020-05-14T22:48:52Z", "type": "commit"}, {"oid": "8326503e406938421f32ff95685eec90b18ac6f6", "url": "https://github.com/hapifhir/hapi-fhir/commit/8326503e406938421f32ff95685eec90b18ac6f6", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/predicate/PredicateBuilderString.java", "committedDate": "2020-05-15T13:01:36Z", "type": "commit"}, {"oid": "c523f4de7a8c84c24258da05698e2a0762d8e127", "url": "https://github.com/hapifhir/hapi-fhir/commit/c523f4de7a8c84c24258da05698e2a0762d8e127", "message": "updated docs", "committedDate": "2020-05-15T13:02:03Z", "type": "commit"}, {"oid": "37918fe53ff4c622cb369637f51e561b493cfdfc", "url": "https://github.com/hapifhir/hapi-fhir/commit/37918fe53ff4c622cb369637f51e561b493cfdfc", "message": "merge conflict", "committedDate": "2020-05-15T13:06:36Z", "type": "commit"}, {"oid": "53d3885da4aaff14e7da35dddf69afde4566de1a", "url": "https://github.com/hapifhir/hapi-fhir/commit/53d3885da4aaff14e7da35dddf69afde4566de1a", "message": "prevent changes to HAPI-EMPI tags on any resources", "committedDate": "2020-05-15T15:02:51Z", "type": "commit"}, {"oid": "a7e4c1babe02c4553109c0c0ac5d80e4625069a3", "url": "https://github.com/hapifhir/hapi-fhir/commit/a7e4c1babe02c4553109c0c0ac5d80e4625069a3", "message": "dstu 3 tests", "committedDate": "2020-05-15T21:37:50Z", "type": "commit"}, {"oid": "4bc83b48b73b9585a0b1126123c7eeca52bca40b", "url": "https://github.com/hapifhir/hapi-fhir/commit/4bc83b48b73b9585a0b1126123c7eeca52bca40b", "message": "fix test", "committedDate": "2020-05-16T00:16:15Z", "type": "commit"}, {"oid": "77dae49922e6e20034caa8d12fe57083e7e51466", "url": "https://github.com/hapifhir/hapi-fhir/commit/77dae49922e6e20034caa8d12fe57083e7e51466", "message": "fix test", "committedDate": "2020-05-16T01:00:49Z", "type": "commit"}, {"oid": "d465a25ee7c9a7b6251235c866af423357beaef3", "url": "https://github.com/hapifhir/hapi-fhir/commit/d465a25ee7c9a7b6251235c866af423357beaef3", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-16T02:06:07Z", "type": "commit"}, {"oid": "efe428ef19b56ada24494ca42f8bdb41ee071608", "url": "https://github.com/hapifhir/hapi-fhir/commit/efe428ef19b56ada24494ca42f8bdb41ee071608", "message": "fix links", "committedDate": "2020-05-16T21:24:40Z", "type": "commit"}, {"oid": "bb5f42f5da5a4f334152490f409544946cec2569", "url": "https://github.com/hapifhir/hapi-fhir/commit/bb5f42f5da5a4f334152490f409544946cec2569", "message": "fix javadoc and documentation links", "committedDate": "2020-05-17T18:04:04Z", "type": "commit"}, {"oid": "75ef78f778801f16ae524fe12f2ebab601c89b79", "url": "https://github.com/hapifhir/hapi-fhir/commit/75ef78f778801f16ae524fe12f2ebab601c89b79", "message": "fix migration", "committedDate": "2020-05-17T22:28:47Z", "type": "commit"}, {"oid": "dd420c70d4a286fe18abdeecd88f077c014293e8", "url": "https://github.com/hapifhir/hapi-fhir/commit/dd420c70d4a286fe18abdeecd88f077c014293e8", "message": "fix migration", "committedDate": "2020-05-17T22:33:51Z", "type": "commit"}, {"oid": "7329d9a25849ff19a10fa9af22d17d3d66de0560", "url": "https://github.com/hapifhir/hapi-fhir/commit/7329d9a25849ff19a10fa9af22d17d3d66de0560", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-19T01:28:35Z", "type": "commit"}, {"oid": "46965aa795c49c1d6bc809ef3744f0155875c8ee", "url": "https://github.com/hapifhir/hapi-fhir/commit/46965aa795c49c1d6bc809ef3744f0155875c8ee", "message": "Test name updates", "committedDate": "2020-05-19T15:46:01Z", "type": "commit"}, {"oid": "308de0a3ddc636a585e9f8853fa6dcad3a0e9277", "url": "https://github.com/hapifhir/hapi-fhir/commit/308de0a3ddc636a585e9f8853fa6dcad3a0e9277", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-17T22:58:41Z", "type": "commit"}, {"oid": "d6012d293e6deef312d2ee32f7351e5bafd02445", "url": "https://github.com/hapifhir/hapi-fhir/commit/d6012d293e6deef312d2ee32f7351e5bafd02445", "message": "Fix compile error", "committedDate": "2020-04-17T23:04:11Z", "type": "commit"}, {"oid": "e7db588f5f9b1950e4046599fcd732bdea0910ef", "url": "https://github.com/hapifhir/hapi-fhir/commit/e7db588f5f9b1950e4046599fcd732bdea0910ef", "message": "add more link tests", "committedDate": "2020-04-18T00:15:22Z", "type": "commit"}, {"oid": "719965be5ddaf58bf4fc9199aea09425aefbcbbf", "url": "https://github.com/hapifhir/hapi-fhir/commit/719965be5ddaf58bf4fc9199aea09425aefbcbbf", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoR4InterceptorTest.java", "committedDate": "2020-04-20T13:23:48Z", "type": "commit"}, {"oid": "49d75c0be3b11a035cacce9a0ad9c2bd34451591", "url": "https://github.com/hapifhir/hapi-fhir/commit/49d75c0be3b11a035cacce9a0ad9c2bd34451591", "message": "remove obsolete subscription abstraction", "committedDate": "2020-04-20T14:20:32Z", "type": "commit"}, {"oid": "da769cd3d8fe92bfc2af6cf6ee49f7fc0a737b48", "url": "https://github.com/hapifhir/hapi-fhir/commit/da769cd3d8fe92bfc2af6cf6ee49f7fc0a737b48", "message": "moved queue naming down one level so empi can use the channel factory instead of the subscription channel factory", "committedDate": "2020-04-20T18:39:27Z", "type": "commit"}, {"oid": "9b06ff0400b0c219e3b213eac02da14b30ca6217", "url": "https://github.com/hapifhir/hapi-fhir/commit/9b06ff0400b0c219e3b213eac02da14b30ca6217", "message": "Refactor test to new package", "committedDate": "2020-04-20T19:13:54Z", "type": "commit"}, {"oid": "551c6a98cf48ac7106acd0a977e5c53fe4591504", "url": "https://github.com/hapifhir/hapi-fhir/commit/551c6a98cf48ac7106acd0a977e5c53fe4591504", "message": "Tidy imports", "committedDate": "2020-04-20T19:53:44Z", "type": "commit"}, {"oid": "6fef7453a02313027d8974b73a232792d144c0eb", "url": "https://github.com/hapifhir/hapi-fhir/commit/6fef7453a02313027d8974b73a232792d144c0eb", "message": "final FIXME KHS: message subscription cleanup", "committedDate": "2020-04-22T13:54:41Z", "type": "commit"}, {"oid": "36e7b561c98abe2ecd8239a1ef3fcfcbc702036d", "url": "https://github.com/hapifhir/hapi-fhir/commit/36e7b561c98abe2ecd8239a1ef3fcfcbc702036d", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-structures-r4/src/test/java/ca/uhn/fhir/rest/client/GenericClientR4Test.java", "committedDate": "2020-04-22T14:06:44Z", "type": "commit"}, {"oid": "76d35bd79b8aa7a386d710d64ae93f88c3263ea9", "url": "https://github.com/hapifhir/hapi-fhir/commit/76d35bd79b8aa7a386d710d64ae93f88c3263ea9", "message": "add channel settings option to indicate channel name is already qualified", "committedDate": "2020-04-22T16:01:10Z", "type": "commit"}, {"oid": "0354a2978200b05fc5aade3e8e638a5d37ecdfa1", "url": "https://github.com/hapifhir/hapi-fhir/commit/0354a2978200b05fc5aade3e8e638a5d37ecdfa1", "message": "removed dependency of subscription on empi", "committedDate": "2020-04-22T16:53:24Z", "type": "commit"}, {"oid": "354ab0d8cb7fee9a2d47fc9062c6e2362ef3bd2c", "url": "https://github.com/hapifhir/hapi-fhir/commit/354ab0d8cb7fee9a2d47fc9062c6e2362ef3bd2c", "message": "fix npe", "committedDate": "2020-04-22T19:57:11Z", "type": "commit"}, {"oid": "57b494ddd1e815e491fbcf4528d199d97142899e", "url": "https://github.com/hapifhir/hapi-fhir/commit/57b494ddd1e815e491fbcf4528d199d97142899e", "message": "First passthrough of adding messages to the pointcut", "committedDate": "2020-04-22T20:21:48Z", "type": "commit"}, {"oid": "f506944f99fa5f873b664a64a8d7dcee8352b05b", "url": "https://github.com/hapifhir/hapi-fhir/commit/f506944f99fa5f873b664a64a8d7dcee8352b05b", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-22T20:21:52Z", "type": "commit"}, {"oid": "17a19a7bcf7473e65601229fa25aa88fa6530b51", "url": "https://github.com/hapifhir/hapi-fhir/commit/17a19a7bcf7473e65601229fa25aa88fa6530b51", "message": "Add static helper to allow nulling out the empi messages in all necessary functions", "committedDate": "2020-04-22T20:47:12Z", "type": "commit"}, {"oid": "7f1fa441a1dd33363a6bac3da739825a2f43fd72", "url": "https://github.com/hapifhir/hapi-fhir/commit/7f1fa441a1dd33363a6bac3da739825a2f43fd72", "message": "Fix regression", "committedDate": "2020-04-22T21:50:00Z", "type": "commit"}, {"oid": "63371e2b6962c1489e23434927ae7d9094d65869", "url": "https://github.com/hapifhir/hapi-fhir/commit/63371e2b6962c1489e23434927ae7d9094d65869", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-empi/src/main/java/ca/uhn/fhir/empi/api/IEmpiCandidateSearchSvc.java\n#\thapi-fhir-jpaserver-subscription/src/main/java/ca/uhn/fhir/jpa/subscription/match/registry/SubscriptionLoader.java\n#\thapi-fhir-jpaserver-subscription/src/test/java/ca/uhn/fhir/jpa/subscription/module/cache/SubscriptionLoaderTest.java\n#\thapi-fhir-jpaserver-subscription/src/test/java/ca/uhn/fhir/jpa/subscription/module/standalone/BaseBlockingQueueSubscribableChannelDstu3Test.java", "committedDate": "2020-04-23T13:10:52Z", "type": "commit"}, {"oid": "88a5fc3bd15a0a7bfd018702848c4ef6c491f7a1", "url": "https://github.com/hapifhir/hapi-fhir/commit/88a5fc3bd15a0a7bfd018702848c4ef6c491f7a1", "message": "update ResourceModifiedMessage to support parent request ID", "committedDate": "2020-04-23T21:37:35Z", "type": "commit"}, {"oid": "75752408276e9b06360f6219172a81f9cfddc741", "url": "https://github.com/hapifhir/hapi-fhir/commit/75752408276e9b06360f6219172a81f9cfddc741", "message": "consolidate dependencies on persistence", "committedDate": "2020-04-23T22:51:47Z", "type": "commit"}, {"oid": "109bf2ffaed53da009ecdfc2ccd520dfab02faaf", "url": "https://github.com/hapifhir/hapi-fhir/commit/109bf2ffaed53da009ecdfc2ccd520dfab02faaf", "message": "Merge remote-tracking branch 'origin/ks-20200312-empi1' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/EmpiLinkDaoSvc.java\n#\thapi-fhir-jpaserver-empi/src/main/java/ca/uhn/fhir/jpa/empi/svc/EmpiLinkSvcImpl.java", "committedDate": "2020-04-23T22:53:09Z", "type": "commit"}, {"oid": "2f31fb23c1bee7caf9fd93d0e368c6a938adf74c", "url": "https://github.com/hapifhir/hapi-fhir/commit/2f31fb23c1bee7caf9fd93d0e368c6a938adf74c", "message": "merge KHS GGG changes", "committedDate": "2020-04-23T22:55:00Z", "type": "commit"}, {"oid": "2c7e02acc4f3b5c0671e02e8f72c9963f3a04bff", "url": "https://github.com/hapifhir/hapi-fhir/commit/2c7e02acc4f3b5c0671e02e8f72c9963f3a04bff", "message": "optimize imports", "committedDate": "2020-04-23T23:01:51Z", "type": "commit"}, {"oid": "fbd56aa73365a39cd461fdcd4e820d61c90151a3", "url": "https://github.com/hapifhir/hapi-fhir/commit/fbd56aa73365a39cd461fdcd4e820d61c90151a3", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-base/src/main/java/ca/uhn/fhir/interceptor/api/Pointcut.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/BaseHapiFhirResourceDao.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/index/DaoResourceLinkResolver.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/index/IdHelperService.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/predicate/PredicateBuilderReference.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoSearchParameterR4.java\n#\thapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/interceptor/CascadingDeleteInterceptor.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/BaseJpaTest.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/dstu3/FhirSystemDaoDstu3Test.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/expunge/ExpungeHookTest.java\n#\thapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoR4SearchNoFtTest.java\n#\thapi-fhir-jpaserver-migrate/src/main/java/ca/uhn/fhir/jpa/migrate/tasks/HapiFhirJpaMigrationTasks.java\n#\thapi-fhir-jpaserver-model/src/main/java/ca/uhn/fhir/jpa/model/entity/ResourceIndexedSearchParamString.java\n#\thapi-fhir-jpaserver-searchparam/src/main/java/ca/uhn/fhir/jpa/searchparam/extractor/BaseSearchParamExtractor.java\n#\thapi-fhir-jpaserver-searchparam/src/test/java/ca/uhn/fhir/jpa/searchparam/extractor/SearchParamExtractorDstu3Test.java\n#\thapi-fhir-spring-boot/hapi-fhir-spring-boot-autoconfigure/src/main/java/ca/uhn/fhir/spring/boot/autoconfigure/FhirAutoConfiguration.java", "committedDate": "2020-04-24T14:25:10Z", "type": "commit"}, {"oid": "7c2a34b6368e80d8599001e771a992f957397414", "url": "https://github.com/hapifhir/hapi-fhir/commit/7c2a34b6368e80d8599001e771a992f957397414", "message": "merge fix", "committedDate": "2020-04-24T14:50:43Z", "type": "commit"}, {"oid": "143f27986fddefd3017d467710baf74ce3d6ec25", "url": "https://github.com/hapifhir/hapi-fhir/commit/143f27986fddefd3017d467710baf74ce3d6ec25", "message": "wip", "committedDate": "2020-04-24T15:34:24Z", "type": "commit"}, {"oid": "4b54950e124f6c85cde6e8271c66f905d56d7767", "url": "https://github.com/hapifhir/hapi-fhir/commit/4b54950e124f6c85cde6e8271c66f905d56d7767", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-24T15:34:25Z", "type": "commit"}, {"oid": "2eb91af7648baa3ad8feb8d3f408e2dc19a5bf6d", "url": "https://github.com/hapifhir/hapi-fhir/commit/2eb91af7648baa3ad8feb8d3f408e2dc19a5bf6d", "message": "Rework request ID to transaction ID in the various messages", "committedDate": "2020-04-24T17:56:38Z", "type": "commit"}, {"oid": "9537d9e16a6e23b94b614be10011d5d128661572", "url": "https://github.com/hapifhir/hapi-fhir/commit/9537d9e16a6e23b94b614be10011d5d128661572", "message": "merge fix", "committedDate": "2020-04-24T18:21:27Z", "type": "commit"}, {"oid": "4378caf3a48ecd5e42ab60677b9ad3018fef2b9f", "url": "https://github.com/hapifhir/hapi-fhir/commit/4378caf3a48ecd5e42ab60677b9ad3018fef2b9f", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-24T18:26:12Z", "type": "commit"}, {"oid": "b231bae2392b6705ec56f699bc8c097938efe310", "url": "https://github.com/hapifhir/hapi-fhir/commit/b231bae2392b6705ec56f699bc8c097938efe310", "message": "fix test", "committedDate": "2020-04-24T19:13:35Z", "type": "commit"}, {"oid": "80029f20ebcf550b313656943d7d1fbc9b5d5e0e", "url": "https://github.com/hapifhir/hapi-fhir/commit/80029f20ebcf550b313656943d7d1fbc9b5d5e0e", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-24T19:16:07Z", "type": "commit"}, {"oid": "de0328dc32ea6f680cca88e9b262cd99bab6581a", "url": "https://github.com/hapifhir/hapi-fhir/commit/de0328dc32ea6f680cca88e9b262cd99bab6581a", "message": "Fix test", "committedDate": "2020-04-24T19:23:12Z", "type": "commit"}, {"oid": "e204904225d085a16b0a129f7e582390c78f2dfd", "url": "https://github.com/hapifhir/hapi-fhir/commit/e204904225d085a16b0a129f7e582390c78f2dfd", "message": "Add test skeleton", "committedDate": "2020-04-27T16:06:02Z", "type": "commit"}, {"oid": "d2184248b0e46a4293c88f23b953cbd1c273a412", "url": "https://github.com/hapifhir/hapi-fhir/commit/d2184248b0e46a4293c88f23b953cbd1c273a412", "message": "Wip handle deletion of link during update", "committedDate": "2020-04-27T19:58:00Z", "type": "commit"}, {"oid": "c4d49e489da8aef11b494c44f4a8ef505f0fc2df", "url": "https://github.com/hapifhir/hapi-fhir/commit/c4d49e489da8aef11b494c44f4a8ef505f0fc2df", "message": "documentation first pass", "committedDate": "2020-04-27T21:05:18Z", "type": "commit"}, {"oid": "e4e98f7d52710a2cd3160325df8e0b85e156c614", "url": "https://github.com/hapifhir/hapi-fhir/commit/e4e98f7d52710a2cd3160325df8e0b85e156c614", "message": "documentation first pass", "committedDate": "2020-04-27T21:15:57Z", "type": "commit"}, {"oid": "55af44cb6a080b65a59c535ee90deefa60095c74", "url": "https://github.com/hapifhir/hapi-fhir/commit/55af44cb6a080b65a59c535ee90deefa60095c74", "message": "Merge remote-tracking branch 'origin/ks-20200312-empi1' into ks-20200312-empi1", "committedDate": "2020-04-27T21:16:10Z", "type": "commit"}, {"oid": "ac65d68d379118aee731d2d3485b273a080c9584", "url": "https://github.com/hapifhir/hapi-fhir/commit/ac65d68d379118aee731d2d3485b273a080c9584", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-27T21:34:50Z", "type": "commit"}, {"oid": "78e7827758c0ff77f15a0f68b2d719c65097d3e8", "url": "https://github.com/hapifhir/hapi-fhir/commit/78e7827758c0ff77f15a0f68b2d719c65097d3e8", "message": "optimize import with 999 settings", "committedDate": "2020-04-28T13:00:56Z", "type": "commit"}, {"oid": "b07a49c2fc60ebd014c9d96b1d37916a9b794279", "url": "https://github.com/hapifhir/hapi-fhir/commit/b07a49c2fc60ebd014c9d96b1d37916a9b794279", "message": "move ProviderConstants to hapi-fhir-server", "committedDate": "2020-04-28T13:08:39Z", "type": "commit"}, {"oid": "380b2b772173f1e73adc7ee7a6dd8651fc79d93a", "url": "https://github.com/hapifhir/hapi-fhir/commit/380b2b772173f1e73adc7ee7a6dd8651fc79d93a", "message": "removed hapi-fhir-broker module", "committedDate": "2020-04-28T13:12:23Z", "type": "commit"}, {"oid": "bf3c07e2e41beac75ac60035975da085a731a1bf", "url": "https://github.com/hapifhir/hapi-fhir/commit/bf3c07e2e41beac75ac60035975da085a731a1bf", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-28T14:38:55Z", "type": "commit"}, {"oid": "fcc7c6f9f02409a6da09d49fa27e940f4c1011dc", "url": "https://github.com/hapifhir/hapi-fhir/commit/fcc7c6f9f02409a6da09d49fa27e940f4c1011dc", "message": "pre-review cleanup", "committedDate": "2020-04-28T15:22:47Z", "type": "commit"}, {"oid": "d491013306dee7b42f2b9f21247f61f39d2e040e", "url": "https://github.com/hapifhir/hapi-fhir/commit/d491013306dee7b42f2b9f21247f61f39d2e040e", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-28T16:10:43Z", "type": "commit"}, {"oid": "9bc8561b7181fccd7e46a457350d848d0f38faaf", "url": "https://github.com/hapifhir/hapi-fhir/commit/9bc8561b7181fccd7e46a457350d848d0f38faaf", "message": "pre-review cleanup", "committedDate": "2020-04-28T17:49:58Z", "type": "commit"}, {"oid": "5566354d77137d76f1d26a1a662eb91a0980c7b8", "url": "https://github.com/hapifhir/hapi-fhir/commit/5566354d77137d76f1d26a1a662eb91a0980c7b8", "message": "Add STU3 test for personhelper. Add test cases", "committedDate": "2020-04-28T17:53:07Z", "type": "commit"}, {"oid": "36a9f0e1d951619663ccca9d14b295a390a6792d", "url": "https://github.com/hapifhir/hapi-fhir/commit/36a9f0e1d951619663ccca9d14b295a390a6792d", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-28T17:53:09Z", "type": "commit"}, {"oid": "1fc301b160e621a5e037c567de155769fdd428ba", "url": "https://github.com/hapifhir/hapi-fhir/commit/1fc301b160e621a5e037c567de155769fdd428ba", "message": "fix test error", "committedDate": "2020-04-28T18:58:19Z", "type": "commit"}, {"oid": "e0f641b81d7ba0ad18e09989856c0ba4bdabb9eb", "url": "https://github.com/hapifhir/hapi-fhir/commit/e0f641b81d7ba0ad18e09989856c0ba4bdabb9eb", "message": "Add DSTU3 and R4 tests for NameUtil", "committedDate": "2020-04-28T21:27:46Z", "type": "commit"}, {"oid": "cccb1d1524fe4bc4d48a26982b554f0068356b87", "url": "https://github.com/hapifhir/hapi-fhir/commit/cccb1d1524fe4bc4d48a26982b554f0068356b87", "message": "Suport MOAR versions", "committedDate": "2020-04-28T21:46:22Z", "type": "commit"}, {"oid": "533f4208bae6e6df954ab4ec8eba061992f58e75", "url": "https://github.com/hapifhir/hapi-fhir/commit/533f4208bae6e6df954ab4ec8eba061992f58e75", "message": "MOAR versions for PersonHelper", "committedDate": "2020-04-28T21:58:51Z", "type": "commit"}, {"oid": "55aab83eba98fc9409947aa45eaf80a3888ed485", "url": "https://github.com/hapifhir/hapi-fhir/commit/55aab83eba98fc9409947aa45eaf80a3888ed485", "message": "pre-review cleanup", "committedDate": "2020-04-29T01:29:18Z", "type": "commit"}, {"oid": "0aa3869a11f5651e9b4f800c4ce4be81e7db8d6b", "url": "https://github.com/hapifhir/hapi-fhir/commit/0aa3869a11f5651e9b4f800c4ce4be81e7db8d6b", "message": "Add Enterprise Identifier section", "committedDate": "2020-04-29T05:26:01Z", "type": "commit"}, {"oid": "ef6e0fb18e4b8d573c680c25263106c985a38d4d", "url": "https://github.com/hapifhir/hapi-fhir/commit/ef6e0fb18e4b8d573c680c25263106c985a38d4d", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-29T05:26:52Z", "type": "commit"}, {"oid": "04d767be7eb8b28ece6e4c446a8189fa4301ace3", "url": "https://github.com/hapifhir/hapi-fhir/commit/04d767be7eb8b28ece6e4c446a8189fa4301ace3", "message": "Add a bit more flavour", "committedDate": "2020-04-29T05:37:31Z", "type": "commit"}, {"oid": "77149d66b908202264fe56e3458c2b614fd61e4c", "url": "https://github.com/hapifhir/hapi-fhir/commit/77149d66b908202264fe56e3458c2b614fd61e4c", "message": "Initial pass of su pporting multiple EIDs", "committedDate": "2020-04-29T16:50:33Z", "type": "commit"}, {"oid": "e537d81a0650af89c6df45a9077ec8be1a548950", "url": "https://github.com/hapifhir/hapi-fhir/commit/e537d81a0650af89c6df45a9077ec8be1a548950", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-04-29T19:12:30Z", "type": "commit"}, {"oid": "16def82a5b1cdf620db362f0bd326f7f04680b0f", "url": "https://github.com/hapifhir/hapi-fhir/commit/16def82a5b1cdf620db362f0bd326f7f04680b0f", "message": "Got Multiple EIDS working with simple assumptions", "committedDate": "2020-04-29T19:24:45Z", "type": "commit"}, {"oid": "31be977eb75f512a8b5de35b91f83cb3c6740227", "url": "https://github.com/hapifhir/hapi-fhir/commit/31be977eb75f512a8b5de35b91f83cb3c6740227", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-29T19:24:49Z", "type": "commit"}, {"oid": "bfb81bfc041819b1e25d430d34969c928e20682b", "url": "https://github.com/hapifhir/hapi-fhir/commit/bfb81bfc041819b1e25d430d34969c928e20682b", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-04-29T19:25:06Z", "type": "commit"}, {"oid": "c21ed4e2a77bd96fc14ec6ab32a9d519348482a4", "url": "https://github.com/hapifhir/hapi-fhir/commit/c21ed4e2a77bd96fc14ec6ab32a9d519348482a4", "message": "Merge remote-tracking branch 'origin/ks-20200312-empi1' into ks-20200312-empi1", "committedDate": "2020-04-29T19:25:21Z", "type": "commit"}, {"oid": "bd9c07bbd4dfd60e2e8316dfc557534fec983b4a", "url": "https://github.com/hapifhir/hapi-fhir/commit/bd9c07bbd4dfd60e2e8316dfc557534fec983b4a", "message": "renamed hapi-fhir-empi to hapi-fhir-server-empi", "committedDate": "2020-04-30T13:05:30Z", "type": "commit"}, {"oid": "64a9a9789b13a4d419ca3897fe5330d1132b8ccd", "url": "https://github.com/hapifhir/hapi-fhir/commit/64a9a9789b13a4d419ca3897fe5330d1132b8ccd", "message": "rename HFJ_EMPI_LINK to MPI_LINK", "committedDate": "2020-04-30T13:07:02Z", "type": "commit"}, {"oid": "33a6c2283541709dd7ab825e13af22cd85609f97", "url": "https://github.com/hapifhir/hapi-fhir/commit/33a6c2283541709dd7ab825e13af22cd85609f97", "message": "change jms:queue: to channel:", "committedDate": "2020-04-30T13:21:11Z", "type": "commit"}, {"oid": "b0b950f69637b39c97d12678241faacfad66e8ec", "url": "https://github.com/hapifhir/hapi-fhir/commit/b0b950f69637b39c97d12678241faacfad66e8ec", "message": "renamed weightMap to matchResultMap", "committedDate": "2020-04-30T13:33:56Z", "type": "commit"}, {"oid": "46acf4fe86bdf098096c3e78cc00e851915fe399", "url": "https://github.com/hapifhir/hapi-fhir/commit/46acf4fe86bdf098096c3e78cc00e851915fe399", "message": "resourceType \"All\" changed to resourceType \"*\"", "committedDate": "2020-04-30T13:43:00Z", "type": "commit"}, {"oid": "0aec492430fcea17c0b2f8bbcb3332339e632ce8", "url": "https://github.com/hapifhir/hapi-fhir/commit/0aec492430fcea17c0b2f8bbcb3332339e632ce8", "message": "Move ResourceTablePidHelper work to IdHelperService", "committedDate": "2020-04-30T18:55:32Z", "type": "commit"}, {"oid": "ffb3fb9eba4446df582e76dd2b8a9725e4e69848", "url": "https://github.com/hapifhir/hapi-fhir/commit/ffb3fb9eba4446df582e76dd2b8a9725e4e69848", "message": "check that we validate bad field names (we do)", "committedDate": "2020-04-30T19:40:31Z", "type": "commit"}, {"oid": "6251f74a6b8db4633ef06ad01169fe7e37021e8a", "url": "https://github.com/hapifhir/hapi-fhir/commit/6251f74a6b8db4633ef06ad01169fe7e37021e8a", "message": "add helper methods to FhirContext for extracting names", "committedDate": "2020-04-30T20:13:05Z", "type": "commit"}, {"oid": "a26b7771f34a9d89b11fad8c4d1b0f524e96138c", "url": "https://github.com/hapifhir/hapi-fhir/commit/a26b7771f34a9d89b11fad8c4d1b0f524e96138c", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-04-30T20:13:12Z", "type": "commit"}, {"oid": "eba404cf3dffa29fe5f6f9f17e8176e12694b88d", "url": "https://github.com/hapifhir/hapi-fhir/commit/eba404cf3dffa29fe5f6f9f17e8176e12694b88d", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-jpaserver-migrate/src/main/java/ca/uhn/fhir/jpa/migrate/SchemaMigrator.java", "committedDate": "2020-04-30T20:20:36Z", "type": "commit"}, {"oid": "5cf68e974277c8e5a96675ca411de2476c5d9dd7", "url": "https://github.com/hapifhir/hapi-fhir/commit/5cf68e974277c8e5a96675ca411de2476c5d9dd7", "message": "Compilation error fix", "committedDate": "2020-04-30T20:36:15Z", "type": "commit"}, {"oid": "36048ef6fccea720a7a91166763c3513a8f90744", "url": "https://github.com/hapifhir/hapi-fhir/commit/36048ef6fccea720a7a91166763c3513a8f90744", "message": "Add migration", "committedDate": "2020-04-30T21:23:13Z", "type": "commit"}, {"oid": "134cc13467c6954415086857cf72d17db63a8c82", "url": "https://github.com/hapifhir/hapi-fhir/commit/134cc13467c6954415086857cf72d17db63a8c82", "message": "Rename Name to Type", "committedDate": "2020-04-30T22:08:28Z", "type": "commit"}, {"oid": "885d27a671ebc4ccd987ac0d4de4bf3a444b2171", "url": "https://github.com/hapifhir/hapi-fhir/commit/885d27a671ebc4ccd987ac0d4de4bf3a444b2171", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-04-30T22:34:16Z", "type": "commit"}, {"oid": "1d88814fcae932272651e4b1d5f240eda73b3096", "url": "https://github.com/hapifhir/hapi-fhir/commit/1d88814fcae932272651e4b1d5f240eda73b3096", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-01T13:12:49Z", "type": "commit"}, {"oid": "b6645697c22087ddc2935eead48ccf1edfa60ca8", "url": "https://github.com/hapifhir/hapi-fhir/commit/b6645697c22087ddc2935eead48ccf1edfa60ca8", "message": "first pass at troubleshooting log", "committedDate": "2020-05-01T15:43:11Z", "type": "commit"}, {"oid": "2b1d981b62899f96ed1e3a2ed1e12a9d5165e385", "url": "https://github.com/hapifhir/hapi-fhir/commit/2b1d981b62899f96ed1e3a2ed1e12a9d5165e385", "message": "first pass at troubleshooting log", "committedDate": "2020-05-01T15:43:50Z", "type": "commit"}, {"oid": "b12aa8db29e95394154f82b8dafa5e064e5d7089", "url": "https://github.com/hapifhir/hapi-fhir/commit/b12aa8db29e95394154f82b8dafa5e064e5d7089", "message": "first pass at troubleshooting log", "committedDate": "2020-05-01T15:55:44Z", "type": "commit"}, {"oid": "f4a80e74ea918a5155d960f32c6cdf32cedbbf25", "url": "https://github.com/hapifhir/hapi-fhir/commit/f4a80e74ea918a5155d960f32c6cdf32cedbbf25", "message": "Add the ability to search on reference parameters during candidate search", "committedDate": "2020-05-01T16:37:46Z", "type": "commit"}, {"oid": "63190ea173a1c6caefe2c1423c5a6ac48b3c8975", "url": "https://github.com/hapifhir/hapi-fhir/commit/63190ea173a1c6caefe2c1423c5a6ac48b3c8975", "message": "Merge branch 'ks-20200312-empi1' of github.com:jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-01T16:38:37Z", "type": "commit"}, {"oid": "d20ed3feb1547469551db6295ea3f72498095a80", "url": "https://github.com/hapifhir/hapi-fhir/commit/d20ed3feb1547469551db6295ea3f72498095a80", "message": "remove fixme", "committedDate": "2020-05-01T16:50:21Z", "type": "commit"}, {"oid": "2778ee7ecf1abcced74f6b4c4d6ddf3c90159ad3", "url": "https://github.com/hapifhir/hapi-fhir/commit/2778ee7ecf1abcced74f6b4c4d6ddf3c90159ad3", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1\n\n# Conflicts:\n#\thapi-fhir-docs/src/main/resources/ca/uhn/hapi/fhir/changelog/4_3_0/1499-dont-touch-timezones-on-date-search.yaml", "committedDate": "2020-05-01T20:38:35Z", "type": "commit"}, {"oid": "39456568a6c05cef8354a912492a86e1f35cf2a1", "url": "https://github.com/hapifhir/hapi-fhir/commit/39456568a6c05cef8354a912492a86e1f35cf2a1", "message": "Merge branch 'ks-20200312-empi1' of https://github.com/jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-01T21:26:31Z", "type": "commit"}, {"oid": "32ea660680d3033eb1e0993e446a7de6a1042a0b", "url": "https://github.com/hapifhir/hapi-fhir/commit/32ea660680d3033eb1e0993e446a7de6a1042a0b", "message": "Fix method references. Remove dead code paths", "committedDate": "2020-05-01T21:27:51Z", "type": "commit"}, {"oid": "d92aaffb77b3ff17d4e9443f729867580b96d73f", "url": "https://github.com/hapifhir/hapi-fhir/commit/d92aaffb77b3ff17d4e9443f729867580b96d73f", "message": "Fix switch bug", "committedDate": "2020-05-01T21:33:23Z", "type": "commit"}, {"oid": "c2f98f71780f843b7012ade78c5f6e66dd770abd", "url": "https://github.com/hapifhir/hapi-fhir/commit/c2f98f71780f843b7012ade78c5f6e66dd770abd", "message": "staticify some consts", "committedDate": "2020-05-01T21:35:32Z", "type": "commit"}, {"oid": "936d0332dc2271c6361651ead3b26bcf956314a3", "url": "https://github.com/hapifhir/hapi-fhir/commit/936d0332dc2271c6361651ead3b26bcf956314a3", "message": "Comment on why there is an empty construcor", "committedDate": "2020-05-01T21:37:00Z", "type": "commit"}, {"oid": "38b7c7bb68d9fc1368cb2f3c9439c3a69eac217f", "url": "https://github.com/hapifhir/hapi-fhir/commit/38b7c7bb68d9fc1368cb2f3c9439c3a69eac217f", "message": "Merge branch 'ks-20200312-empi1' of https://github.com/jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-01T21:41:06Z", "type": "commit"}, {"oid": "1d7b2a939358c128cc48764a07f00394e4ec6443", "url": "https://github.com/hapifhir/hapi-fhir/commit/1d7b2a939358c128cc48764a07f00394e4ec6443", "message": "Fix sonar code smells", "committedDate": "2020-05-01T21:42:40Z", "type": "commit"}, {"oid": "cf73200be9b2e40d29f6a16d756316ac5c3abfb4", "url": "https://github.com/hapifhir/hapi-fhir/commit/cf73200be9b2e40d29f6a16d756316ac5c3abfb4", "message": "added logging for find candidates", "committedDate": "2020-05-01T21:50:05Z", "type": "commit"}, {"oid": "366c8a246b3b2eb2e8213ec9e0af27a7f24c6f7e", "url": "https://github.com/hapifhir/hapi-fhir/commit/366c8a246b3b2eb2e8213ec9e0af27a7f24c6f7e", "message": "Address sonar code smells", "committedDate": "2020-05-01T21:50:53Z", "type": "commit"}, {"oid": "96e84a04953f041b7a73b99eda8ac51da6d07d0a", "url": "https://github.com/hapifhir/hapi-fhir/commit/96e84a04953f041b7a73b99eda8ac51da6d07d0a", "message": "Merge branch 'ks-20200312-empi1' of https://github.com/jamesagnew/hapi-fhir into ks-20200312-empi1", "committedDate": "2020-05-01T21:50:12Z", "type": "commit"}, {"oid": "845d0cae0afa85cc12425921c92fd7c60e947d7e", "url": "https://github.com/hapifhir/hapi-fhir/commit/845d0cae0afa85cc12425921c92fd7c60e947d7e", "message": "fix compile", "committedDate": "2020-05-01T21:57:26Z", "type": "commit"}, {"oid": "98cfeb3fbc160fea913998e486c4db0aa2861283", "url": "https://github.com/hapifhir/hapi-fhir/commit/98cfeb3fbc160fea913998e486c4db0aa2861283", "message": "Fix migration ordering causing failure", "committedDate": "2020-05-01T23:18:09Z", "type": "commit"}, {"oid": "8bb0979597ef519a844f71b7e9a51e1c43ce55c7", "url": "https://github.com/hapifhir/hapi-fhir/commit/8bb0979597ef519a844f71b7e9a51e1c43ce55c7", "message": "added troubleshooting logs", "committedDate": "2020-05-02T18:04:24Z", "type": "commit"}, {"oid": "cbb69fee7231baa98220c15e9bd8ca37eb40771f", "url": "https://github.com/hapifhir/hapi-fhir/commit/cbb69fee7231baa98220c15e9bd8ca37eb40771f", "message": "oops. search/replace failure.  surprised a test didn't trigger this infinite recursion...", "committedDate": "2020-05-02T18:06:47Z", "type": "commit"}, {"oid": "0313fa04c4205b8af75c3add2a0b5e88f9210ae1", "url": "https://github.com/hapifhir/hapi-fhir/commit/0313fa04c4205b8af75c3add2a0b5e88f9210ae1", "message": "FIXME dup", "committedDate": "2020-05-02T18:14:37Z", "type": "commit"}, {"oid": "a79a550e75f494db5bc562d9de0ff57fd439dc1a", "url": "https://github.com/hapifhir/hapi-fhir/commit/a79a550e75f494db5bc562d9de0ff57fd439dc1a", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200312-empi1", "committedDate": "2020-05-04T12:47:42Z", "type": "commit"}]}