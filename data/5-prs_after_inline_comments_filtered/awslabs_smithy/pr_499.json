{"pr_number": 499, "pr_title": "Disallow problematic identifiers", "pr_createdAt": "2020-07-16T00:24:49Z", "pr_url": "https://github.com/awslabs/smithy/pull/499", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg4MjU2OA==", "url": "https://github.com/awslabs/smithy/pull/499#discussion_r455882568", "bodyText": "s/e..g/e.g.", "author": "kstich", "createdAt": "2020-07-16T15:39:43Z", "path": "smithy-model/src/main/java/software/amazon/smithy/model/shapes/ShapeId.java", "diffHunk": "@@ -117,21 +117,40 @@ public static boolean isValidNamespace(CharSequence namespace) {\n      * @return Returns true if this is a valid identifier.\n      */\n     public static boolean isValidIdentifier(CharSequence identifier) {\n-        if (identifier == null || identifier.length() == 0) {\n-            return false;\n+        return parseIdentifier(identifier, 0) == identifier.length();\n+    }\n+\n+    private static int parseIdentifier(CharSequence identifier, int offset) {\n+        if (identifier == null || identifier.length() <= offset) {\n+            return -1;\n         }\n \n-        if (!ParserUtils.isIdentifierStart(identifier.charAt(0))) {\n-            return false;\n+        // Parse the required identifier_start production.\n+        char startingChar = identifier.charAt(offset);\n+        if (startingChar == '_') {\n+            while (identifier.charAt(offset) == '_') {\n+                offset++;\n+            }\n+            if (!ParserUtils.isValidIdentifierCharacter(identifier.charAt(offset))) {\n+                return -1;\n+            }\n+            offset++;\n+        } else if (!ParserUtils.isAlphabetic(startingChar)) {\n+            return -1;\n         }\n \n-        for (int i = 1; i < identifier.length(); i++) {\n-            if (!ParserUtils.isValidIdentifierCharacter(identifier.charAt(i))) {\n-                return false;\n+        // Parse the optional identifier_chars production.\n+        while (offset < identifier.length()) {\n+            if (!ParserUtils.isValidIdentifierCharacter(identifier.charAt(offset))) {\n+                // Return the position of the character that stops the identifier.\n+                // This is either an invalid case (e..g, isValidIdentifier), or", "originalCommit": "b0f98d57bced5e318ced8324bc808ee72936ee49", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3ca1ce2190b928e76939345e89b5880bca40b970", "url": "https://github.com/awslabs/smithy/commit/3ca1ce2190b928e76939345e89b5880bca40b970", "message": "Disallow problematic identifiers\n\nThese newly disallowed identifiers were never actually supported in\npractice and are problematic on multiple levels:\n\n1. An identifier like `_` or `__` are bad names that don't help users\n   understand an API.\n2. Identifiers like `_` are problematic for languages like Rust that use\n   this character for pattern matching.", "committedDate": "2020-07-16T16:01:37Z", "type": "commit"}, {"oid": "3ca1ce2190b928e76939345e89b5880bca40b970", "url": "https://github.com/awslabs/smithy/commit/3ca1ce2190b928e76939345e89b5880bca40b970", "message": "Disallow problematic identifiers\n\nThese newly disallowed identifiers were never actually supported in\npractice and are problematic on multiple levels:\n\n1. An identifier like `_` or `__` are bad names that don't help users\n   understand an API.\n2. Identifiers like `_` are problematic for languages like Rust that use\n   this character for pattern matching.", "committedDate": "2020-07-16T16:01:37Z", "type": "forcePushed"}]}