{"pr_number": 1424, "pr_title": "SAMZA-2584: Refactor ClusterBasedJobCoordinator", "pr_createdAt": "2020-08-27T21:27:15Z", "pr_url": "https://github.com/apache/samza/pull/1424", "timeline": [{"oid": "bcec4731bd1c8460ec234d003926ef7927f3c135", "url": "https://github.com/apache/samza/commit/bcec4731bd1c8460ec234d003926ef7927f3c135", "message": "SAMZA-2584: Refactor ClusterBasedJobCoordinator\n\nIssues: In the deployment flow of a beam job, we will have a complicate flow: ClusterBasedJobCoordinator#main -> Beam main class -> JobCoordinatorLaunchUtil -> ClusterBasedJobCoordinator.\nChanges:\n  1. Move ClusterBasedJobCoordinator#main to ClusterBasedJobCoordinatorRunner#main\n  2. Update run-jc.sh to invoke ClusterBasedJobCoordinatorRunner\nTests:\n  1. unit tests\n  2. Deployed hello samza job successfully with the change following instructions on http://samza.apache.org/startup/hello-samza/latest/\nAPI Changes: None\nUpgrade Instructions: None\nUsage Instructions: None", "committedDate": "2020-08-27T21:25:48Z", "type": "commit"}, {"oid": "0e6b07b4c37a2e8fddfe1410c77bf29c65b04754", "url": "https://github.com/apache/samza/commit/0e6b07b4c37a2e8fddfe1410c77bf29c65b04754", "message": "Add a new line", "committedDate": "2020-08-27T21:27:28Z", "type": "commit"}, {"oid": "0eddc43ce8a3fb88fcead602bb61d3a8b7d6e3e8", "url": "https://github.com/apache/samza/commit/0eddc43ce8a3fb88fcead602bb61d3a8b7d6e3e8", "message": "Remove unused import", "committedDate": "2020-08-31T17:09:36Z", "type": "commit"}, {"oid": "3fc3b15c374249a1f2c501881a4f71da2e9c323e", "url": "https://github.com/apache/samza/commit/3fc3b15c374249a1f2c501881a4f71da2e9c323e", "message": "Update run-jc.sh to use ClusterBasedJobCoordinatorRunner", "committedDate": "2020-09-02T16:27:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjIyMTYzOQ==", "url": "https://github.com/apache/samza/pull/1424#discussion_r482221639", "bodyText": "I'd suggest to keep the old name as is since it is indeed testing the functionality of ClusterBasedJobCoordinator like startpoint fanout, partition monitor.\nIf you can create a new test class for ClusterBasedJobCoordinatorRunner and then add test for runClusterBasedJobCoordinator (rest of the methods are mostly helpers to construct dependencies) that will be great.", "author": "mynameborat", "createdAt": "2020-09-02T16:57:20Z", "path": "samza-core/src/test/java/org/apache/samza/clustermanager/TestClusterBasedJobCoordinatorRunner.java", "diffHunk": "@@ -64,15 +64,15 @@\n \n \n /**\n- * Tests for {@link ClusterBasedJobCoordinator}\n+ * Tests for {@link TestClusterBasedJobCoordinatorRunner}\n  */\n @RunWith(PowerMockRunner.class)\n @PrepareForTest({\n     CoordinatorStreamUtil.class,\n-    ClusterBasedJobCoordinator.class,\n+    ClusterBasedJobCoordinatorRunner.class,\n     CoordinatorStreamStore.class,\n     RemoteJobPlanner.class})\n-public class TestClusterBasedJobCoordinator {", "originalCommit": "3fc3b15c374249a1f2c501881a4f71da2e9c323e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8cd70450fe305f8bbc706df2f04fef17e12183bd", "url": "https://github.com/apache/samza/commit/8cd70450fe305f8bbc706df2f04fef17e12183bd", "message": "Rename TestClusterBasedJobCoordinatorRunner back to TestClusterBasedJobCoordinator\nAdd TestClusterBasedJobCoordinatorRunner to test runClusterBasedJobCoordinator() in ClusterBasedJobCoordinatorRunner", "committedDate": "2020-09-02T18:47:37Z", "type": "commit"}, {"oid": "4a7ce75786b3f9d48a511ec7807e6557b82cecad", "url": "https://github.com/apache/samza/commit/4a7ce75786b3f9d48a511ec7807e6557b82cecad", "message": "Add license info", "committedDate": "2020-09-02T19:46:57Z", "type": "commit"}, {"oid": "c409a0c9bcfc81411c40163d05b2a58e03039aff", "url": "https://github.com/apache/samza/commit/c409a0c9bcfc81411c40163d05b2a58e03039aff", "message": "Fix checkstyle", "committedDate": "2020-09-02T21:05:56Z", "type": "commit"}]}