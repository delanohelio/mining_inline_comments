{"pr_number": 1267, "pr_title": "[CDAP-17447] Emit bytes written metric for database sinks", "pr_createdAt": "2020-12-11T06:51:32Z", "pr_url": "https://github.com/cdapio/hydrator-plugins/pull/1267", "timeline": [{"oid": "603cfa28bb52df752a2bbfccae605b3b392741ae", "url": "https://github.com/cdapio/hydrator-plugins/commit/603cfa28bb52df752a2bbfccae605b3b392741ae", "message": "[CDAP-17447] Emit bytes written metric for database sinks", "committedDate": "2020-12-11T19:09:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTE5MzE3OQ==", "url": "https://github.com/cdapio/hydrator-plugins/pull/1267#discussion_r541193179", "bodyText": "No need. Default value of long field is already 0L.", "author": "chtyim", "createdAt": "2020-12-11T19:25:31Z", "path": "database-plugins/src/main/java/io/cdap/plugin/DBRecord.java", "diffHunk": "@@ -72,6 +73,7 @@\n   public DBRecord(StructuredRecord record, int [] columnTypes) {\n     this.record = record;\n     this.columnTypes = columnTypes;\n+    this.bytesWritten = 0;", "originalCommit": "603cfa28bb52df752a2bbfccae605b3b392741ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTIwODAxMg==", "url": "https://github.com/cdapio/hydrator-plugins/pull/1267#discussion_r541208012", "bodyText": "removed.", "author": "rmstar", "createdAt": "2020-12-11T19:40:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTE5MzE3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTE5Mzg4OQ==", "url": "https://github.com/cdapio/hydrator-plugins/pull/1267#discussion_r541193889", "bodyText": "Long.BYTES is a static constant, shouldn't be accessing it via instance.", "author": "chtyim", "createdAt": "2020-12-11T19:26:16Z", "path": "database-plugins/src/main/java/io/cdap/plugin/DBRecord.java", "diffHunk": "@@ -240,14 +249,20 @@ private void writeToDB(PreparedStatement stmt, Schema.Field field, int fieldInde\n       switch (fieldLogicalType) {\n         case DATE:\n           stmt.setDate(sqlIndex, Date.valueOf(record.getDate(fieldName)));\n+          bytesWritten += ((Long) record.get(fieldName)).BYTES;", "originalCommit": "603cfa28bb52df752a2bbfccae605b3b392741ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTIwODA5Mg==", "url": "https://github.com/cdapio/hydrator-plugins/pull/1267#discussion_r541208092", "bodyText": "fixed", "author": "rmstar", "createdAt": "2020-12-11T19:41:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTE5Mzg4OQ=="}], "type": "inlineReview"}, {"oid": "a5ad881273bb2c35bbb44ee5ff44f7f7944ea8cf", "url": "https://github.com/cdapio/hydrator-plugins/commit/a5ad881273bb2c35bbb44ee5ff44f7f7944ea8cf", "message": "[CDAP-17447] Emit bytes written metric for database sinks", "committedDate": "2020-12-11T21:34:08Z", "type": "commit"}, {"oid": "a5ad881273bb2c35bbb44ee5ff44f7f7944ea8cf", "url": "https://github.com/cdapio/hydrator-plugins/commit/a5ad881273bb2c35bbb44ee5ff44f7f7944ea8cf", "message": "[CDAP-17447] Emit bytes written metric for database sinks", "committedDate": "2020-12-11T21:34:08Z", "type": "forcePushed"}]}