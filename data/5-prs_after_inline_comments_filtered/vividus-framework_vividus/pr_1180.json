{"pr_number": 1180, "pr_title": "[plugin-mobile-app] Add steps to work with web views", "pr_createdAt": "2020-11-27T09:52:30Z", "pr_url": "https://github.com/vividus-framework/vividus/pull/1180", "timeline": [{"oid": "badbb090c026fab2639357beb8e5b36424c88327", "url": "https://github.com/vividus-framework/vividus/commit/badbb090c026fab2639357beb8e5b36424c88327", "message": "[plugin-mobile-app] Add steps to work with web views", "committedDate": "2020-11-27T10:51:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTU1MjE5OA==", "url": "https://github.com/vividus-framework/vividus/pull/1180#discussion_r531552198", "bodyText": "\"Switching to '{}' web view found by the index {}\"", "author": "valfirst", "createdAt": "2020-11-27T11:42:45Z", "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/bdd/mobileapp/steps/SetContextSteps.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Copyright 2019-2020 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.vividus.bdd.mobileapp.steps;\n+\n+import static java.util.function.Predicate.not;\n+\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.jbehave.core.annotations.When;\n+import org.openqa.selenium.ContextAware;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.vividus.selenium.IWebDriverProvider;\n+import org.vividus.selenium.manager.IGenericWebDriverManager;\n+import org.vividus.softassert.ISoftAssert;\n+\n+public class SetContextSteps\n+{\n+    private static final Logger LOGGER = LoggerFactory.getLogger(SetContextSteps.class);\n+\n+    private final IWebDriverProvider webDriverProvider;\n+    private final ISoftAssert softAssert;\n+\n+    public SetContextSteps(IWebDriverProvider webDriverProvider, ISoftAssert softAssert)\n+    {\n+        this.webDriverProvider = webDriverProvider;\n+        this.softAssert = softAssert;\n+    }\n+\n+    /**\n+     * Switches context to a mobile application context\n+     */\n+    @When(\"I switch to native context\")\n+    public void switchToNativeContext()\n+    {\n+        getContextAware().context(IGenericWebDriverManager.NATIVE_APP_CONTEXT);\n+    }\n+\n+    /**\n+     * Switches context to a web view with the <b>index</b>, index number starts from 1.\n+     * @param index index of web view\n+     */\n+    @When(\"I switch to web view with index `$index`\")\n+    public void switchToWebView(int index)\n+    {\n+        List<String> webViews = getWebViews();\n+        if (webViews.isEmpty())\n+        {\n+            softAssert.recordFailedAssertion(\"No web views found\");\n+            return;\n+        }\n+\n+        LOGGER.atInfo().addArgument(webViews::toString).log(\"Web views found: {}\");\n+\n+        int webViewIndex = index - 1;\n+        int size = webViews.size();\n+        if (webViewIndex >= 0 && webViewIndex < size)\n+        {\n+            String webview = webViews.get(webViewIndex);\n+            LOGGER.atInfo().addArgument(webview::toString)\n+                           .addArgument(index)\n+                           .log(\"Switching to '{}' web view by index {}\");", "originalCommit": "badbb090c026fab2639357beb8e5b36424c88327", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "de51f8d748f59e292b64d7ba5158614e3a90006a", "url": "https://github.com/vividus-framework/vividus/commit/de51f8d748f59e292b64d7ba5158614e3a90006a", "message": "[plugin-mobile-app] Add steps to work with web views", "committedDate": "2020-11-27T12:17:15Z", "type": "commit"}, {"oid": "de51f8d748f59e292b64d7ba5158614e3a90006a", "url": "https://github.com/vividus-framework/vividus/commit/de51f8d748f59e292b64d7ba5158614e3a90006a", "message": "[plugin-mobile-app] Add steps to work with web views", "committedDate": "2020-11-27T12:17:15Z", "type": "forcePushed"}]}