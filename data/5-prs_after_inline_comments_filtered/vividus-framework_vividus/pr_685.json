{"pr_number": 685, "pr_title": "[plugin-web-app] Supply meaningful message in case when context eleme\u2026", "pr_createdAt": "2020-06-18T16:05:16Z", "pr_url": "https://github.com/vividus-framework/vividus/pull/685", "timeline": [{"oid": "1aeacdabe6d0baac9fca4c19d6388b21eed2212c", "url": "https://github.com/vividus-framework/vividus/commit/1aeacdabe6d0baac9fca4c19d6388b21eed2212c", "message": "[plugin-web-app] Supply meaningful message in case when context element becomes stale", "committedDate": "2020-06-18T16:05:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQyNzc2Mw==", "url": "https://github.com/vividus-framework/vividus/pull/685#discussion_r442427763", "bodyText": "would not line breaks make the message readable?", "author": "uarlouski", "createdAt": "2020-06-18T18:40:09Z", "path": "vividus-plugin-web-app/src/main/java/org/vividus/ui/web/action/ExpectedSearchContextConditions.java", "diffHunk": "@@ -17,28 +17,56 @@\n package org.vividus.ui.web.action;\n \n import java.util.List;\n+import java.util.function.Supplier;\n \n import org.openqa.selenium.By;\n import org.openqa.selenium.SearchContext;\n+import org.openqa.selenium.StaleElementReferenceException;\n import org.openqa.selenium.WebElement;\n \n public final class ExpectedSearchContextConditions extends AbstractExpectedConditions<By>\n {\n     @Override\n     protected List<WebElement> findElements(SearchContext searchContext, By by)\n     {\n-        return searchContext.findElements(by);\n+        return searchInforming(() -> searchContext.findElements(by));\n     }\n \n     @Override\n     protected WebElement findElement(SearchContext searchContext, By by)\n     {\n-        return searchContext.findElement(by);\n+        return searchInforming(() -> searchContext.findElement(by));\n+    }\n+\n+    private <E> E searchInforming(Supplier<E> search)\n+    {\n+        try\n+        {\n+            return search.get();\n+        }\n+        catch (StaleElementReferenceException toWrap)\n+        {\n+            throw new StaleContextException(toWrap);\n+        }\n     }\n \n     @Override\n     protected String toStringParameters(By locator)\n     {\n         return \"located by \" + locator;\n     }\n+\n+    public static class StaleContextException extends StaleElementReferenceException\n+    {\n+        private static final long serialVersionUID = 2449857900556530700L;\n+\n+        private StaleContextException(Throwable throwable)\n+        {\n+            super(\"Search context used for search is stale. \"\n+                + \"Please double check the tests. \"\n+                + \"You have a few options: \"\n+                + \"1. reset context; \"\n+                + \"2. Synchronize the tests to wait for context's stabilization;\", throwable);", "originalCommit": "1aeacdabe6d0baac9fca4c19d6388b21eed2212c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjY2MTQyMg==", "url": "https://github.com/vividus-framework/vividus/pull/685#discussion_r442661422", "bodyText": "vs\n\nLooks better with linebreaks for me", "author": "ikalinin1", "createdAt": "2020-06-19T06:48:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQyNzc2Mw=="}], "type": "inlineReview"}, {"oid": "b54fced859b54d10f8028f0cc5d0587acf6c6d40", "url": "https://github.com/vividus-framework/vividus/commit/b54fced859b54d10f8028f0cc5d0587acf6c6d40", "message": "[plugin-web-app] Supply meaningful message in case when context element becomes stale", "committedDate": "2020-06-19T06:51:41Z", "type": "commit"}, {"oid": "b54fced859b54d10f8028f0cc5d0587acf6c6d40", "url": "https://github.com/vividus-framework/vividus/commit/b54fced859b54d10f8028f0cc5d0587acf6c6d40", "message": "[plugin-web-app] Supply meaningful message in case when context element becomes stale", "committedDate": "2020-06-19T06:51:41Z", "type": "forcePushed"}]}