{"pr_number": 2526, "pr_title": "(3.13) Adding support for running test suite against bootable JAR", "pr_createdAt": "2020-09-15T17:40:40Z", "pr_url": "https://github.com/resteasy/resteasy/pull/2526", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492044836", "bodyText": "Is it possible to use standalone-full for bootable-jar testing here?", "author": "marekkopecky", "createdAt": "2020-09-21T13:29:42Z", "path": "testsuite/integration-tests/src/test/java/org/jboss/resteasy/test/cdi/injection/InjectionTest.java", "diffHunk": "@@ -74,7 +75,8 @@\n @RunWith(Arquillian.class)\n @RunAsClient\n @Category({\n-    ExpectedFailingWithStandaloneMicroprofileConfiguration.class // MP is missing jboss.naming.context.java.jboss.exported.jms.RemoteConnectionFactory\n+    ExpectedFailingWithStandaloneMicroprofileConfiguration.class, // MP is missing jboss.naming.context.java.jboss.exported.jms.RemoteConnectionFactory\n+    NotForBootableJar.class // needs ejb + standalone-full", "originalCommit": "c233fed6f4f5338d9be3fcba8286f0913fcfc402", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE4NTQyOA==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492185428", "bodyText": "I don't think so. The supported layers combinations never bring up a standalone-full. I discussed this with @jfdenise who could add more input, in case it is needed.", "author": "fabiobrz", "createdAt": "2020-09-21T16:17:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ4OTE3Mw==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492489173", "bodyText": "Right, sorry, standalone profiles probably doesn't make sense in this context. So what layer is missing for correct execution of this test (from standalone-full)? Messaging?", "author": "marekkopecky", "createdAt": "2020-09-22T05:58:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjUxMjgyMg==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492512822", "bodyText": "IIRC was messaging but there were several more things missing. In fact I tried and added the new messaging layer but it didin't work.", "author": "fabiobrz", "createdAt": "2020-09-22T07:01:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjUxOTQzOA==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492519438", "bodyText": "It would be great to describe more details about reason for ignoring this testcase to java comment ...", "author": "marekkopecky", "createdAt": "2020-09-22T07:16:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjY2MzIyMA==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492663220", "bodyText": "Ok, adding more detail about the fact that a 250 MB bootable JAR is basically useless.", "author": "fabiobrz", "createdAt": "2020-09-22T11:34:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwODkyNw==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r493208927", "bodyText": "which is useless\n\nHmm, ok, but what is missing in bootable jar to have this working?", "author": "marekkopecky", "createdAt": "2020-09-23T05:38:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIyNDE1MQ==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r493224151", "bodyText": "Messaging was missing for sure, and I added it. Then it failed again, and I discussed the thing with the feature developer, who made his experiments as well and he got to the conclusion that a full server was needed to make this work.\nMaybe @jfdenise can elaborate a bit if what you need to know is the full list of subsystems that should in place.", "author": "fabiobrz", "createdAt": "2020-09-23T06:21:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIzOTQ0Nw==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r493239447", "bodyText": "I don't think that this blocks this PR. But I'm wondering whether this is some issue that could affects users. @jfdenise can you please provide more details on this?", "author": "marekkopecky", "createdAt": "2020-09-23T06:55:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI0OTM1Mg==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r493249352", "bodyText": "I don't have the list of needed subsystems, I realized that a standalone-full.xml was used in the test (embedded broker for example). I made the bootable JAR to provision a full config and the test passed. BTW, I also noticed that I had to remove one of the 2 executions in the arquilian-bootable.xml. We are starting 2 server that unzip there content in the same location (install-dir). This breaks messaging journal that doesn't seem to like the WildFly directory to be re-written.", "author": "jfdenise", "createdAt": "2020-09-23T07:15:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI2MTQ5OA==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r493261498", "bodyText": "We are starting 2 server that unzip there content in the same location (install-dir)\n\n+1, this looks like a TS bug. @fabiobrz we can for example add some suffix to the second arquillian container", "author": "marekkopecky", "createdAt": "2020-09-23T07:35:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY0NzM0Nw==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r493647347", "bodyText": "Thanks @marekkopecky and @jfdenise, done.", "author": "fabiobrz", "createdAt": "2020-09-23T14:38:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NDgzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0NTYyMw==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492045623", "bodyText": "Some description with reason would be useful (eg add // no log check support for bootable-jar in RESTEasy TS so far)", "author": "marekkopecky", "createdAt": "2020-09-21T13:30:47Z", "path": "testsuite/integration-tests/src/test/java/org/jboss/resteasy/test/core/basic/DuplicateDeploymentTest.java", "diffHunk": "@@ -27,6 +28,7 @@\n  */\n @RunWith(Arquillian.class)\n @RunAsClient\n+@Category(NotForBootableJar.class)", "originalCommit": "c233fed6f4f5338d9be3fcba8286f0913fcfc402", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0Njk3OA==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492046978", "bodyText": "no RX layer so far\n\nWhere is RX classes used here?", "author": "marekkopecky", "createdAt": "2020-09-21T13:32:33Z", "path": "testsuite/integration-tests/src/test/java/org/jboss/resteasy/test/microprofile/restclient/RestClientProviderPriorityTest.java", "diffHunk": "@@ -31,6 +33,7 @@\n \n @RunWith(Arquillian.class)\n @RunAsClient\n+@Category(NotForBootableJar.class) // no RX layer so far", "originalCommit": "c233fed6f4f5338d9be3fcba8286f0913fcfc402", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE4MzU1NA==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492183554", "bodyText": "You're right. There's no use of rx classes, but I added the annotation because I noticed a rx related error. Maybe I was too quick, I am pushing changes that remove it and we'll see what happens, although this should not be considered at all when running ts.bootable profile since I noticed that you always used -Dts.disable.microprofile... right?", "author": "fabiobrz", "createdAt": "2020-09-21T16:14:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0Njk3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ4ODI5OQ==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492488299", "bodyText": "this should not be considered at all when running ts.bootable profile since I noticed that you always used -Dts.disable.microprofile... right?\n\nThere is no ts.disable.microprofile. There is disable.microprofile.tests, but it affects tests with MicroProfileDependent. But this RestClientProviderPriorityTest class is not annotated by MicroProfileDependent, so it's not related.", "author": "marekkopecky", "createdAt": "2020-09-22T05:55:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0Njk3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjUxMzYzMw==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492513633", "bodyText": "There is no ts.disable.microprofile. There is disable.microprofile.tests\n\nYeah, I was typing quickly and didn't go look for the name but I see you got it.\n\nBut this RestClientProviderPriorityTest class is not annotated by MicroProfileDependent, so it's not related.\n\nGood to know. Annotations were removed, let's see what CI checks say.", "author": "fabiobrz", "createdAt": "2020-09-22T07:03:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0Njk3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY4MTU1OQ==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r493681559", "bodyText": "@marekkopecky this test is passing now, can we resolve this conversation?", "author": "fabiobrz", "createdAt": "2020-09-23T15:21:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0Njk3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0OTE4NA==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492049184", "bodyText": "Why is this annotation added here?", "author": "marekkopecky", "createdAt": "2020-09-21T13:35:28Z", "path": "testsuite/integration-tests/src/test/java/org/jboss/resteasy/test/microprofile/restclient/RestClientProxyTest.java", "diffHunk": "@@ -63,6 +64,7 @@\n       war.addClass(PortProviderUtil.class);\n       war.addClass(Category.class);\n       war.addClass(MicroProfileDependent.class);\n+      war.addClass(NotForBootableJar.class);", "originalCommit": "c233fed6f4f5338d9be3fcba8286f0913fcfc402", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE4MjE2Mw==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492182163", "bodyText": "@ronsigal added this. I don't have it in my branch. I think it was because he noticed failures in different profiles execution (e.g.: MicroProfile). I am pushing a version that does not have the annotation, so we can see what the CI checks will report.", "author": "fabiobrz", "createdAt": "2020-09-21T16:11:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0OTE4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY4MjAwNA==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r493682004", "bodyText": "@marekkopecky this test is passing now, can we resolve this conversation?", "author": "fabiobrz", "createdAt": "2020-09-23T15:22:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0OTE4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0OTYyMQ==", "url": "https://github.com/resteasy/resteasy/pull/2526#discussion_r492049621", "bodyText": "typo, s/fa/far/g", "author": "marekkopecky", "createdAt": "2020-09-21T13:36:04Z", "path": "testsuite/integration-tests/src/test/java/org/jboss/resteasy/test/providers/jsonb/basic/JsonBindingDebugLoggingTest.java", "diffHunk": "@@ -48,6 +50,7 @@\n  */\r\n @RunWith(Arquillian.class)\r\n @ServerSetup({DebugLoggingServerSetup.class}) // TBD: remove debug logging activation?\r\n+@Category(NotForBootableJar.class) // no log check support for bootable-jar in RESTEasy TS so fa\r", "originalCommit": "c233fed6f4f5338d9be3fcba8286f0913fcfc402", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "84dfa0f44b23771d6522fcf720046952b30e2eff", "url": "https://github.com/resteasy/resteasy/commit/84dfa0f44b23771d6522fcf720046952b30e2eff", "message": "(3.13) Adding support for running test suite against bootable JAR", "committedDate": "2020-09-21T16:21:23Z", "type": "forcePushed"}, {"oid": "dd9f2eab7751484bc7b98f919be00f17845ce2b1", "url": "https://github.com/resteasy/resteasy/commit/dd9f2eab7751484bc7b98f919be00f17845ce2b1", "message": "(3.13) Adding support for running test suite against bootable JAR", "committedDate": "2020-09-22T11:36:20Z", "type": "forcePushed"}, {"oid": "13bdae64b5344424598c2f00b7f2411f1c28ea2b", "url": "https://github.com/resteasy/resteasy/commit/13bdae64b5344424598c2f00b7f2411f1c28ea2b", "message": "(3.13) Adding support for running test suite against bootable JAR", "committedDate": "2020-09-23T14:37:42Z", "type": "forcePushed"}, {"oid": "f176fff6b1960ca45ad7321cfe3b641f6ceb980c", "url": "https://github.com/resteasy/resteasy/commit/f176fff6b1960ca45ad7321cfe3b641f6ceb980c", "message": "(3.13) Adding support for running test suite against bootable JAR", "committedDate": "2020-09-23T15:32:28Z", "type": "forcePushed"}, {"oid": "3923eb2813b21565ddeee092146b83d96301925a", "url": "https://github.com/resteasy/resteasy/commit/3923eb2813b21565ddeee092146b83d96301925a", "message": "(3.13) Adding support for running test suite against bootable JAR", "committedDate": "2020-09-23T15:40:34Z", "type": "forcePushed"}, {"oid": "33f8555e29e19fe65b8a2ba0412f7c54125cb4de", "url": "https://github.com/resteasy/resteasy/commit/33f8555e29e19fe65b8a2ba0412f7c54125cb4de", "message": "(3.13) Adding support for running test suite against bootable JAR", "committedDate": "2020-09-24T10:51:07Z", "type": "forcePushed"}, {"oid": "4221e0b99343cd9fdc49dd34c23b8ac6f52fa6f3", "url": "https://github.com/resteasy/resteasy/commit/4221e0b99343cd9fdc49dd34c23b8ac6f52fa6f3", "message": "(3.13) Adding support for running test suite against bootable JAR", "committedDate": "2020-09-28T08:32:56Z", "type": "forcePushed"}, {"oid": "baca2e50304d524fc612c3e63257598a2059c545", "url": "https://github.com/resteasy/resteasy/commit/baca2e50304d524fc612c3e63257598a2059c545", "message": "(3.13) Adding support for running test suite against bootable JAR", "committedDate": "2020-09-30T09:55:21Z", "type": "commit"}, {"oid": "baca2e50304d524fc612c3e63257598a2059c545", "url": "https://github.com/resteasy/resteasy/commit/baca2e50304d524fc612c3e63257598a2059c545", "message": "(3.13) Adding support for running test suite against bootable JAR", "committedDate": "2020-09-30T09:55:21Z", "type": "forcePushed"}]}