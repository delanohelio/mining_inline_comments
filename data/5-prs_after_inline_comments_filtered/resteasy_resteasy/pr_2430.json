{"pr_number": 2430, "pr_title": "[RESTEASY-2597] add methods and test to support setting", "pr_createdAt": "2020-06-02T12:51:58Z", "pr_url": "https://github.com/resteasy/resteasy/pull/2430", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4NDQ5NQ==", "url": "https://github.com/resteasy/resteasy/pull/2430#discussion_r435784495", "bodyText": "This should really be:\npublic abstract ResteasyClientBuilder automaticRetriesDisabled(boolean automaticRetriesDisabled);\nBasically, as this class is a builder, you should return the current instance. Moreover, a boolean parameter should be used so that the feature can be enabled and disabled.", "author": "asoldano", "createdAt": "2020-06-05T08:57:05Z", "path": "resteasy-client-api/src/main/java/org/jboss/resteasy/client/jaxrs/ResteasyClientBuilder.java", "diffHunk": "@@ -223,6 +223,12 @@\n \r\n    public abstract long getConnectionTimeout(TimeUnit unit);\r\n \r\n+   /**\r\n+    * boolean, notify apache to disable its automatic retries.\r\n+    */\r\n+   public abstract void disableAutomaticRetries();\r", "originalCommit": "9b5c1c216deec94010bd3d197f770339b42253f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDE2MzQ2Mg==", "url": "https://github.com/resteasy/resteasy/pull/2430#discussion_r440163462", "bodyText": "Apache's HttpClientBuilder does not offer on/off value switching.\nIn Apache there is a default value for automaticRetriesDisabled\nand one can call its class, HttpClientBuilder.disableAutomaticRetries()\nbut there is no parameter for switching on/off. Resteasy should reflect that.\nI do not believe boolean parameter should be added to this method.", "author": "rsearls", "createdAt": "2020-06-15T13:10:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4NDQ5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4NTYxMg==", "url": "https://github.com/resteasy/resteasy/pull/2430#discussion_r435785612", "bodyText": "Should you name the method above the way I suggested (basically appending \"disabled\"), this would have to be changed accordingly.", "author": "asoldano", "createdAt": "2020-06-05T08:59:00Z", "path": "resteasy-client-api/src/main/java/org/jboss/resteasy/client/jaxrs/ResteasyClientBuilder.java", "diffHunk": "@@ -223,6 +223,12 @@\n \r\n    public abstract long getConnectionTimeout(TimeUnit unit);\r\n \r\n+   /**\r\n+    * boolean, notify apache to disable its automatic retries.\r\n+    */\r\n+   public abstract void disableAutomaticRetries();\r\n+   public abstract boolean isDisableAutomaticRetries();\r", "originalCommit": "9b5c1c216deec94010bd3d197f770339b42253f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4Nzk3MA==", "url": "https://github.com/resteasy/resteasy/pull/2430#discussion_r435787970", "bodyText": "This looks like a unit test more than an integration test. If that's what you really meant to do, please move this to the resteasy-client module test directory. If a real integration test is not too hard to write, it should live here, instead.", "author": "asoldano", "createdAt": "2020-06-05T09:02:57Z", "path": "testsuite/integration-tests/src/test/java/org/jboss/resteasy/test/client/other/DisableAutomaticRetriesTest.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package org.jboss.resteasy.test.client.other;\n+\n+import org.jboss.arquillian.container.test.api.Deployment;\n+import org.jboss.arquillian.container.test.api.RunAsClient;\n+import org.jboss.arquillian.junit.Arquillian;\n+import org.jboss.resteasy.client.jaxrs.ResteasyClientBuilder;\n+import org.jboss.resteasy.utils.TestUtil;\n+import org.jboss.shrinkwrap.api.Archive;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+import javax.ws.rs.GET;\n+import javax.ws.rs.Path;\n+import javax.ws.rs.client.Client;\n+import javax.ws.rs.client.ClientBuilder;\n+\n+/**\n+ * Notify apache to disable its automatic retries.\n+ * @tpSince RESTEasy 4.6.0\n+ */\n+\n+@RunWith(Arquillian.class)\n+@RunAsClient\n+public class DisableAutomaticRetriesTest {\n+\n+    @Path(\"/test\")\n+    public static class  SimpleResource {\n+        @GET\n+        public String Hello() {\n+            return \"Hello\";\n+        }\n+    }\n+\n+    @Deployment\n+    public static Archive<?> deploy() {\n+        WebArchive war = TestUtil.prepareArchive(\n+                DisableAutomaticRetriesTest.class.getSimpleName());\n+        return TestUtil.finishContainerPrepare(war, null, SimpleResource.class);\n+    }\n+\n+    @Test\n+    public void testFlag() throws Exception {\n+        ResteasyClientBuilder builder = (ResteasyClientBuilder) ClientBuilder.newBuilder();\n+        Assert.assertFalse(builder.isDisableAutomaticRetries());\n+        builder.disableAutomaticRetries();\n+        Client client = builder.build();\n+        Assert.assertTrue(builder.isDisableAutomaticRetries());\n+        client.close();\n+    }", "originalCommit": "9b5c1c216deec94010bd3d197f770339b42253f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDg5ODc4Nw==", "url": "https://github.com/resteasy/resteasy/pull/2430#discussion_r440898787", "bodyText": "done", "author": "rsearls", "createdAt": "2020-06-16T14:33:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4Nzk3MA=="}], "type": "inlineReview"}, {"oid": "c24eae101038b3417132a4cddf7da3aa576a6e33", "url": "https://github.com/resteasy/resteasy/commit/c24eae101038b3417132a4cddf7da3aa576a6e33", "message": "[RESTEASY-2597] add methods and test to support setting", "committedDate": "2020-06-15T13:43:58Z", "type": "forcePushed"}, {"oid": "f5f99f13faaf09013f5bf4040f58b63217b398fb", "url": "https://github.com/resteasy/resteasy/commit/f5f99f13faaf09013f5bf4040f58b63217b398fb", "message": "[RESTEASY-2597] add methods and test to support setting", "committedDate": "2020-06-16T14:32:12Z", "type": "commit"}, {"oid": "f5f99f13faaf09013f5bf4040f58b63217b398fb", "url": "https://github.com/resteasy/resteasy/commit/f5f99f13faaf09013f5bf4040f58b63217b398fb", "message": "[RESTEASY-2597] add methods and test to support setting", "committedDate": "2020-06-16T14:32:12Z", "type": "forcePushed"}]}