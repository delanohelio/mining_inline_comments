{"pr_number": 9815, "pr_title": "BAEL-4431-jdbcmetadata: Article about extracting metadata using JDBC", "pr_createdAt": "2020-08-03T16:49:21Z", "pr_url": "https://github.com/eugenp/tutorials/pull/9815", "timeline": [{"oid": "ba683057faf3e09c5ec1cbc4145af3283c737467", "url": "https://github.com/eugenp/tutorials/commit/ba683057faf3e09c5ec1cbc4145af3283c737467", "message": "BAEL-4431-jdbcmetadata: Article about extracting metadata using JDBC", "committedDate": "2020-08-03T16:46:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1MDk5OQ==", "url": "https://github.com/eugenp/tutorials/pull/9815#discussion_r465450999", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    }catch (SQLException e){\n          \n          \n            \n                    } catch (SQLException e){", "author": "KevinGilmore", "createdAt": "2020-08-05T03:31:48Z", "path": "persistence-modules/core-java-persistence/src/main/java/com/baeldung/jdbcmetadata/JdbcMetadataApplication.java", "diffHunk": "@@ -0,0 +1,30 @@\n+package com.baeldung.jdbcmetadata;\n+\n+import org.apache.log4j.Logger;\n+\n+import java.sql.SQLException;\n+\n+public class JdbcMetadataApplication {\n+\n+    private static final Logger LOG = Logger.getLogger(JdbcMetadataApplication.class);\n+\n+    public static void main(String[] args) {\n+        DatabaseConfig databaseConfig = new DatabaseConfig();\n+        databaseConfig.init();\n+        try {\n+            MetadataExtractor metadataExtractor = new MetadataExtractor(databaseConfig.getConnection());\n+            metadataExtractor.extractTableInfo();\n+            metadataExtractor.extractSystemTables();\n+            metadataExtractor.extractViews();\n+            String tableName = \"CUSTOMER\";\n+            metadataExtractor.extractColumnInfo(tableName);\n+            metadataExtractor.extractPrimaryKeys(tableName);\n+            metadataExtractor.extractForeignKeys(\"CUST_ADDRESS\");\n+            metadataExtractor.extractDatabaseInfo();\n+            metadataExtractor.extractUserName();\n+            metadataExtractor.extractSupportedFeatures();\n+        }catch (SQLException e){", "originalCommit": "ba683057faf3e09c5ec1cbc4145af3283c737467", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM4MjE3Mg==", "url": "https://github.com/eugenp/tutorials/pull/9815#discussion_r467382172", "bodyText": "@KevinGilmore  Handled all the review comments by using the recommended formatter.", "author": "sahilsingla112", "createdAt": "2020-08-08T08:09:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1MDk5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1MTQyMw==", "url": "https://github.com/eugenp/tutorials/pull/9815#discussion_r465451423", "bodyText": "This line is using tabs. Be sure to use the standard code formatter (available in the tutorials repo, under eclipse or intelliJ foder, depending on which IDE you're using)", "author": "KevinGilmore", "createdAt": "2020-08-05T03:33:38Z", "path": "persistence-modules/core-java-persistence/src/main/java/com/baeldung/jdbcmetadata/MetadataExtractor.java", "diffHunk": "@@ -0,0 +1,118 @@\n+package com.baeldung.jdbcmetadata;\n+\n+import java.sql.Connection;\n+import java.sql.DatabaseMetaData;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+\n+public class MetadataExtractor {\n+\tprivate final DatabaseMetaData databaseMetaData;\n+\n+\tpublic MetadataExtractor(Connection connection) throws SQLException {\n+\t\tthis.databaseMetaData = connection.getMetaData();", "originalCommit": "ba683057faf3e09c5ec1cbc4145af3283c737467", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1MTcyNg==", "url": "https://github.com/eugenp/tutorials/pull/9815#discussion_r465451726", "bodyText": "Opening braces should be at the end of a line of code, not at the beginning of a line by itself. Several of the while statements are done like this.", "author": "KevinGilmore", "createdAt": "2020-08-05T03:34:57Z", "path": "persistence-modules/core-java-persistence/src/main/java/com/baeldung/jdbcmetadata/MetadataExtractor.java", "diffHunk": "@@ -0,0 +1,118 @@\n+package com.baeldung.jdbcmetadata;\n+\n+import java.sql.Connection;\n+import java.sql.DatabaseMetaData;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+\n+public class MetadataExtractor {\n+\tprivate final DatabaseMetaData databaseMetaData;\n+\n+\tpublic MetadataExtractor(Connection connection) throws SQLException {\n+\t\tthis.databaseMetaData = connection.getMetaData();\n+        DatabaseMetaData databaseMetaData = connection.getMetaData();\n+\t}\n+\t\n+\tpublic void extractTableInfo() throws SQLException {\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, \"CUST%\", new String[]{\"TABLE\"});\n+        while(resultSet.next())\n+        {", "originalCommit": "ba683057faf3e09c5ec1cbc4145af3283c737467", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1MTg1NA==", "url": "https://github.com/eugenp/tutorials/pull/9815#discussion_r465451854", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    while(primaryKeys.next()){\n          \n          \n            \n                    while(primaryKeys.next()) {", "author": "KevinGilmore", "createdAt": "2020-08-05T03:35:26Z", "path": "persistence-modules/core-java-persistence/src/main/java/com/baeldung/jdbcmetadata/MetadataExtractor.java", "diffHunk": "@@ -0,0 +1,118 @@\n+package com.baeldung.jdbcmetadata;\n+\n+import java.sql.Connection;\n+import java.sql.DatabaseMetaData;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+\n+public class MetadataExtractor {\n+\tprivate final DatabaseMetaData databaseMetaData;\n+\n+\tpublic MetadataExtractor(Connection connection) throws SQLException {\n+\t\tthis.databaseMetaData = connection.getMetaData();\n+        DatabaseMetaData databaseMetaData = connection.getMetaData();\n+\t}\n+\t\n+\tpublic void extractTableInfo() throws SQLException {\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, \"CUST%\", new String[]{\"TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+            System.out.println(resultSet.getString(\"REMARKS\"));\n+        }\n+    }\n+\t\n+    public void extractSystemTables() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"SYSTEM TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of system tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractViews() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"VIEW\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing views\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractColumnInfo(String tableName) throws SQLException{\n+        ResultSet columns = databaseMetaData.getColumns(null,null, tableName, null);\n+\n+        while(columns.next())\n+        {\n+            String columnName = columns.getString(\"COLUMN_NAME\");\n+            String columnSize = columns.getString(\"COLUMN_SIZE\");\n+            String datatype = columns.getString(\"DATA_TYPE\");\n+            String isNullable = columns.getString(\"IS_NULLABLE\");\n+            String isAutoIncrement = columns.getString(\"IS_AUTOINCREMENT\");\n+            System.out.println(String.format(\"ColumnName: %s, columnSize: %s, datatype: %s, isColumnNullable: %s, isAutoIncrementEnabled: %s\", columnName, columnSize, datatype, isNullable, isAutoIncrement));\n+        }\n+    }\n+\n+    public void extractPrimaryKeys(String tableName) throws SQLException{\n+\t    ResultSet primaryKeys = databaseMetaData.getPrimaryKeys(null, null, tableName);\n+        while(primaryKeys.next()){", "originalCommit": "ba683057faf3e09c5ec1cbc4145af3283c737467", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1MTkyNw==", "url": "https://github.com/eugenp/tutorials/pull/9815#discussion_r465451927", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    while(foreignKeys.next()){\n          \n          \n            \n                    while(foreignKeys.next()) {", "author": "KevinGilmore", "createdAt": "2020-08-05T03:35:40Z", "path": "persistence-modules/core-java-persistence/src/main/java/com/baeldung/jdbcmetadata/MetadataExtractor.java", "diffHunk": "@@ -0,0 +1,118 @@\n+package com.baeldung.jdbcmetadata;\n+\n+import java.sql.Connection;\n+import java.sql.DatabaseMetaData;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+\n+public class MetadataExtractor {\n+\tprivate final DatabaseMetaData databaseMetaData;\n+\n+\tpublic MetadataExtractor(Connection connection) throws SQLException {\n+\t\tthis.databaseMetaData = connection.getMetaData();\n+        DatabaseMetaData databaseMetaData = connection.getMetaData();\n+\t}\n+\t\n+\tpublic void extractTableInfo() throws SQLException {\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, \"CUST%\", new String[]{\"TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+            System.out.println(resultSet.getString(\"REMARKS\"));\n+        }\n+    }\n+\t\n+    public void extractSystemTables() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"SYSTEM TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of system tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractViews() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"VIEW\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing views\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractColumnInfo(String tableName) throws SQLException{\n+        ResultSet columns = databaseMetaData.getColumns(null,null, tableName, null);\n+\n+        while(columns.next())\n+        {\n+            String columnName = columns.getString(\"COLUMN_NAME\");\n+            String columnSize = columns.getString(\"COLUMN_SIZE\");\n+            String datatype = columns.getString(\"DATA_TYPE\");\n+            String isNullable = columns.getString(\"IS_NULLABLE\");\n+            String isAutoIncrement = columns.getString(\"IS_AUTOINCREMENT\");\n+            System.out.println(String.format(\"ColumnName: %s, columnSize: %s, datatype: %s, isColumnNullable: %s, isAutoIncrementEnabled: %s\", columnName, columnSize, datatype, isNullable, isAutoIncrement));\n+        }\n+    }\n+\n+    public void extractPrimaryKeys(String tableName) throws SQLException{\n+\t    ResultSet primaryKeys = databaseMetaData.getPrimaryKeys(null, null, tableName);\n+        while(primaryKeys.next()){\n+            String primaryKeyColumnName = primaryKeys.getString(\"COLUMN_NAME\");\n+            String primaryKeyName = primaryKeys.getString(\"PK_NAME\");\n+            System.out.println(String.format(\"columnName:%s, pkName:%s\", primaryKeyColumnName, primaryKeyName));\n+        }\n+    }\n+\n+    public void fun() throws SQLException{\n+\n+    }\n+\n+\n+    public void extractForeignKeys(String tableName) throws SQLException{\n+        ResultSet foreignKeys = databaseMetaData.getImportedKeys(null, null, tableName);\n+        while(foreignKeys.next()){", "originalCommit": "ba683057faf3e09c5ec1cbc4145af3283c737467", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1MjA1Mw==", "url": "https://github.com/eugenp/tutorials/pull/9815#discussion_r465452053", "bodyText": "avoid the extra spaces", "author": "KevinGilmore", "createdAt": "2020-08-05T03:36:14Z", "path": "persistence-modules/core-java-persistence/src/main/java/com/baeldung/jdbcmetadata/MetadataExtractor.java", "diffHunk": "@@ -0,0 +1,118 @@\n+package com.baeldung.jdbcmetadata;\n+\n+import java.sql.Connection;\n+import java.sql.DatabaseMetaData;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+\n+public class MetadataExtractor {\n+\tprivate final DatabaseMetaData databaseMetaData;\n+\n+\tpublic MetadataExtractor(Connection connection) throws SQLException {\n+\t\tthis.databaseMetaData = connection.getMetaData();\n+        DatabaseMetaData databaseMetaData = connection.getMetaData();\n+\t}\n+\t\n+\tpublic void extractTableInfo() throws SQLException {\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, \"CUST%\", new String[]{\"TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+            System.out.println(resultSet.getString(\"REMARKS\"));\n+        }\n+    }\n+\t\n+    public void extractSystemTables() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"SYSTEM TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of system tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractViews() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"VIEW\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing views\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractColumnInfo(String tableName) throws SQLException{\n+        ResultSet columns = databaseMetaData.getColumns(null,null, tableName, null);\n+\n+        while(columns.next())\n+        {\n+            String columnName = columns.getString(\"COLUMN_NAME\");\n+            String columnSize = columns.getString(\"COLUMN_SIZE\");\n+            String datatype = columns.getString(\"DATA_TYPE\");\n+            String isNullable = columns.getString(\"IS_NULLABLE\");\n+            String isAutoIncrement = columns.getString(\"IS_AUTOINCREMENT\");\n+            System.out.println(String.format(\"ColumnName: %s, columnSize: %s, datatype: %s, isColumnNullable: %s, isAutoIncrementEnabled: %s\", columnName, columnSize, datatype, isNullable, isAutoIncrement));\n+        }\n+    }\n+\n+    public void extractPrimaryKeys(String tableName) throws SQLException{\n+\t    ResultSet primaryKeys = databaseMetaData.getPrimaryKeys(null, null, tableName);\n+        while(primaryKeys.next()){\n+            String primaryKeyColumnName = primaryKeys.getString(\"COLUMN_NAME\");\n+            String primaryKeyName = primaryKeys.getString(\"PK_NAME\");\n+            System.out.println(String.format(\"columnName:%s, pkName:%s\", primaryKeyColumnName, primaryKeyName));\n+        }\n+    }\n+\n+    public void fun() throws SQLException{\n+\n+    }\n+\n+\n+    public void extractForeignKeys(String tableName) throws SQLException{\n+        ResultSet foreignKeys = databaseMetaData.getImportedKeys(null, null, tableName);\n+        while(foreignKeys.next()){\n+            String pkTableName = foreignKeys.getString(\"PKTABLE_NAME\");\n+            String fkTableName = foreignKeys.getString(\"FKTABLE_NAME\");\n+            String pkColumnName = foreignKeys.getString(\"PKCOLUMN_NAME\");\n+            String fkColumnName = foreignKeys.getString(\"FKCOLUMN_NAME\");\n+            System.out.println(String.format(\"pkTableName:%s, fkTableName:%s, pkColumnName:%s, fkColumnName:%s\", pkTableName, fkTableName, pkColumnName, fkColumnName));\n+        }\n+    }\n+\n+    public void extractDatabaseInfo() throws SQLException{\n+        String productName    = databaseMetaData.getDatabaseProductName();", "originalCommit": "ba683057faf3e09c5ec1cbc4145af3283c737467", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1MjA5OQ==", "url": "https://github.com/eugenp/tutorials/pull/9815#discussion_r465452099", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    while (schemas.next()){\n          \n          \n            \n                    while (schemas.next()) {", "author": "KevinGilmore", "createdAt": "2020-08-05T03:36:26Z", "path": "persistence-modules/core-java-persistence/src/main/java/com/baeldung/jdbcmetadata/MetadataExtractor.java", "diffHunk": "@@ -0,0 +1,118 @@\n+package com.baeldung.jdbcmetadata;\n+\n+import java.sql.Connection;\n+import java.sql.DatabaseMetaData;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+\n+public class MetadataExtractor {\n+\tprivate final DatabaseMetaData databaseMetaData;\n+\n+\tpublic MetadataExtractor(Connection connection) throws SQLException {\n+\t\tthis.databaseMetaData = connection.getMetaData();\n+        DatabaseMetaData databaseMetaData = connection.getMetaData();\n+\t}\n+\t\n+\tpublic void extractTableInfo() throws SQLException {\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, \"CUST%\", new String[]{\"TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+            System.out.println(resultSet.getString(\"REMARKS\"));\n+        }\n+    }\n+\t\n+    public void extractSystemTables() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"SYSTEM TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of system tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractViews() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"VIEW\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing views\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractColumnInfo(String tableName) throws SQLException{\n+        ResultSet columns = databaseMetaData.getColumns(null,null, tableName, null);\n+\n+        while(columns.next())\n+        {\n+            String columnName = columns.getString(\"COLUMN_NAME\");\n+            String columnSize = columns.getString(\"COLUMN_SIZE\");\n+            String datatype = columns.getString(\"DATA_TYPE\");\n+            String isNullable = columns.getString(\"IS_NULLABLE\");\n+            String isAutoIncrement = columns.getString(\"IS_AUTOINCREMENT\");\n+            System.out.println(String.format(\"ColumnName: %s, columnSize: %s, datatype: %s, isColumnNullable: %s, isAutoIncrementEnabled: %s\", columnName, columnSize, datatype, isNullable, isAutoIncrement));\n+        }\n+    }\n+\n+    public void extractPrimaryKeys(String tableName) throws SQLException{\n+\t    ResultSet primaryKeys = databaseMetaData.getPrimaryKeys(null, null, tableName);\n+        while(primaryKeys.next()){\n+            String primaryKeyColumnName = primaryKeys.getString(\"COLUMN_NAME\");\n+            String primaryKeyName = primaryKeys.getString(\"PK_NAME\");\n+            System.out.println(String.format(\"columnName:%s, pkName:%s\", primaryKeyColumnName, primaryKeyName));\n+        }\n+    }\n+\n+    public void fun() throws SQLException{\n+\n+    }\n+\n+\n+    public void extractForeignKeys(String tableName) throws SQLException{\n+        ResultSet foreignKeys = databaseMetaData.getImportedKeys(null, null, tableName);\n+        while(foreignKeys.next()){\n+            String pkTableName = foreignKeys.getString(\"PKTABLE_NAME\");\n+            String fkTableName = foreignKeys.getString(\"FKTABLE_NAME\");\n+            String pkColumnName = foreignKeys.getString(\"PKCOLUMN_NAME\");\n+            String fkColumnName = foreignKeys.getString(\"FKCOLUMN_NAME\");\n+            System.out.println(String.format(\"pkTableName:%s, fkTableName:%s, pkColumnName:%s, fkColumnName:%s\", pkTableName, fkTableName, pkColumnName, fkColumnName));\n+        }\n+    }\n+\n+    public void extractDatabaseInfo() throws SQLException{\n+        String productName    = databaseMetaData.getDatabaseProductName();\n+        String productVersion = databaseMetaData.getDatabaseProductVersion();\n+\n+        String driverName = databaseMetaData.getDriverName();\n+        String driverVersion = databaseMetaData.getDriverVersion();\n+\n+        System.out.println(String.format(\"Product name:%s, Product version:%s\", productName, productVersion));\n+        System.out.println(String.format(\"Driver name:%s, Driver Version:%s\", driverName, driverVersion));\n+    }\n+\n+    public void extractUserName() throws SQLException{\n+        String userName = databaseMetaData.getUserName();\n+        System.out.println(userName);\n+        ResultSet schemas = databaseMetaData.getSchemas();\n+        while (schemas.next()){", "originalCommit": "ba683057faf3e09c5ec1cbc4145af3283c737467", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1MjE1NA==", "url": "https://github.com/eugenp/tutorials/pull/9815#discussion_r465452154", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void extractSupportedFeatures() throws SQLException{\n          \n          \n            \n                public void extractSupportedFeatures() throws SQLException {", "author": "KevinGilmore", "createdAt": "2020-08-05T03:36:39Z", "path": "persistence-modules/core-java-persistence/src/main/java/com/baeldung/jdbcmetadata/MetadataExtractor.java", "diffHunk": "@@ -0,0 +1,118 @@\n+package com.baeldung.jdbcmetadata;\n+\n+import java.sql.Connection;\n+import java.sql.DatabaseMetaData;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+\n+public class MetadataExtractor {\n+\tprivate final DatabaseMetaData databaseMetaData;\n+\n+\tpublic MetadataExtractor(Connection connection) throws SQLException {\n+\t\tthis.databaseMetaData = connection.getMetaData();\n+        DatabaseMetaData databaseMetaData = connection.getMetaData();\n+\t}\n+\t\n+\tpublic void extractTableInfo() throws SQLException {\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, \"CUST%\", new String[]{\"TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+            System.out.println(resultSet.getString(\"REMARKS\"));\n+        }\n+    }\n+\t\n+    public void extractSystemTables() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"SYSTEM TABLE\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of system tables\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractViews() throws SQLException{\n+        ResultSet resultSet = databaseMetaData.getTables(null, null, null, new String[]{\"VIEW\"});\n+        while(resultSet.next())\n+        {\n+            // Print the names of existing views\n+            System.out.println(resultSet.getString(\"TABLE_NAME\"));\n+        }\n+    }\n+\n+    public void extractColumnInfo(String tableName) throws SQLException{\n+        ResultSet columns = databaseMetaData.getColumns(null,null, tableName, null);\n+\n+        while(columns.next())\n+        {\n+            String columnName = columns.getString(\"COLUMN_NAME\");\n+            String columnSize = columns.getString(\"COLUMN_SIZE\");\n+            String datatype = columns.getString(\"DATA_TYPE\");\n+            String isNullable = columns.getString(\"IS_NULLABLE\");\n+            String isAutoIncrement = columns.getString(\"IS_AUTOINCREMENT\");\n+            System.out.println(String.format(\"ColumnName: %s, columnSize: %s, datatype: %s, isColumnNullable: %s, isAutoIncrementEnabled: %s\", columnName, columnSize, datatype, isNullable, isAutoIncrement));\n+        }\n+    }\n+\n+    public void extractPrimaryKeys(String tableName) throws SQLException{\n+\t    ResultSet primaryKeys = databaseMetaData.getPrimaryKeys(null, null, tableName);\n+        while(primaryKeys.next()){\n+            String primaryKeyColumnName = primaryKeys.getString(\"COLUMN_NAME\");\n+            String primaryKeyName = primaryKeys.getString(\"PK_NAME\");\n+            System.out.println(String.format(\"columnName:%s, pkName:%s\", primaryKeyColumnName, primaryKeyName));\n+        }\n+    }\n+\n+    public void fun() throws SQLException{\n+\n+    }\n+\n+\n+    public void extractForeignKeys(String tableName) throws SQLException{\n+        ResultSet foreignKeys = databaseMetaData.getImportedKeys(null, null, tableName);\n+        while(foreignKeys.next()){\n+            String pkTableName = foreignKeys.getString(\"PKTABLE_NAME\");\n+            String fkTableName = foreignKeys.getString(\"FKTABLE_NAME\");\n+            String pkColumnName = foreignKeys.getString(\"PKCOLUMN_NAME\");\n+            String fkColumnName = foreignKeys.getString(\"FKCOLUMN_NAME\");\n+            System.out.println(String.format(\"pkTableName:%s, fkTableName:%s, pkColumnName:%s, fkColumnName:%s\", pkTableName, fkTableName, pkColumnName, fkColumnName));\n+        }\n+    }\n+\n+    public void extractDatabaseInfo() throws SQLException{\n+        String productName    = databaseMetaData.getDatabaseProductName();\n+        String productVersion = databaseMetaData.getDatabaseProductVersion();\n+\n+        String driverName = databaseMetaData.getDriverName();\n+        String driverVersion = databaseMetaData.getDriverVersion();\n+\n+        System.out.println(String.format(\"Product name:%s, Product version:%s\", productName, productVersion));\n+        System.out.println(String.format(\"Driver name:%s, Driver Version:%s\", driverName, driverVersion));\n+    }\n+\n+    public void extractUserName() throws SQLException{\n+        String userName = databaseMetaData.getUserName();\n+        System.out.println(userName);\n+        ResultSet schemas = databaseMetaData.getSchemas();\n+        while (schemas.next()){\n+            String table_schem = schemas.getString(\"TABLE_SCHEM\");\n+            String table_catalog = schemas.getString(\"TABLE_CATALOG\");\n+            System.out.println(String.format(\"Table_schema:%s, Table_catalog:%s\", table_schem, table_catalog));\n+        }\n+    }\n+\n+    public void extractSupportedFeatures() throws SQLException{", "originalCommit": "ba683057faf3e09c5ec1cbc4145af3283c737467", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "409305d8179d14c0876a0918d8cfa233ad3833da", "url": "https://github.com/eugenp/tutorials/commit/409305d8179d14c0876a0918d8cfa233ad3833da", "message": "BAEL-4431-jdbcmetadata: Review comments, fixed formatting issues by using the recommended intelij formatter", "committedDate": "2020-08-08T08:04:52Z", "type": "commit"}]}