{"pr_number": 9604, "pr_title": "add excel formula", "pr_createdAt": "2020-06-28T18:34:04Z", "pr_url": "https://github.com/eugenp/tutorials/pull/9604", "timeline": [{"oid": "484a6bf2f8101cf70e26352743aa6f69d0a264b4", "url": "https://github.com/eugenp/tutorials/commit/484a6bf2f8101cf70e26352743aa6f69d0a264b4", "message": "add excel formula", "committedDate": "2020-06-28T18:33:10Z", "type": "commit"}, {"oid": "76786fc07849da6bf8a8814def79ff784a228fa8", "url": "https://github.com/eugenp/tutorials/commit/76786fc07849da6bf8a8814def79ff784a228fa8", "message": "create README.md file", "committedDate": "2020-06-28T19:12:09Z", "type": "commit"}, {"oid": "edb5ca529d1a9ae67349540d54fbd2590681dff5", "url": "https://github.com/eugenp/tutorials/commit/edb5ca529d1a9ae67349540d54fbd2590681dff5", "message": "remove and add file", "committedDate": "2020-06-29T12:07:18Z", "type": "commit"}, {"oid": "98ab3aa452841d40c54786e993150ca93c940ddc", "url": "https://github.com/eugenp/tutorials/commit/98ab3aa452841d40c54786e993150ca93c940ddc", "message": "Merge branch 'master' of github.com:SanazTavakoli/tutorials", "committedDate": "2020-06-29T12:08:30Z", "type": "commit"}, {"oid": "e33f8675f69965b8df70017cf87cbfdd49514a5e", "url": "https://github.com/eugenp/tutorials/commit/e33f8675f69965b8df70017cf87cbfdd49514a5e", "message": "change files location", "committedDate": "2020-07-03T21:56:52Z", "type": "commit"}, {"oid": "e33f8675f69965b8df70017cf87cbfdd49514a5e", "url": "https://github.com/eugenp/tutorials/commit/e33f8675f69965b8df70017cf87cbfdd49514a5e", "message": "change files location", "committedDate": "2020-07-03T21:56:52Z", "type": "forcePushed"}, {"oid": "c6a1041c40047ad05f70db129dd1063a1258ff31", "url": "https://github.com/eugenp/tutorials/commit/c6a1041c40047ad05f70db129dd1063a1258ff31", "message": "changes after adding excel file", "committedDate": "2020-07-11T08:31:02Z", "type": "commit"}, {"oid": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b", "url": "https://github.com/eugenp/tutorials/commit/e13f2c8e8b11c948fd6b5d8df0591aa65683272b", "message": "change excel file direcory", "committedDate": "2020-07-19T08:15:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NTM1MQ==", "url": "https://github.com/eugenp/tutorials/pull/9604#discussion_r460545351", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                void givenExcelData_whenSetAndEvaluateFormula() throws IOException {\n          \n          \n            \n                void givenExcelData_whenSetFormula_thenSuccess() throws IOException {", "author": "KevinGilmore", "createdAt": "2020-07-26T16:13:28Z", "path": "apache-poi/src/test/java/com/baeldung/poi/excel/setformula/ExcelFormulaUnitTest.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.baeldung.poi.excel.setformula;\n+\n+import org.apache.poi.ss.util.CellReference;\n+import org.apache.poi.xssf.usermodel.XSSFSheet;\n+import org.apache.poi.xssf.usermodel.XSSFWorkbook;\n+import org.junit.Assert;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.nio.file.Paths;\n+\n+class ExcelFormulaUnitTest {\n+    private static String FILE_NAME = \"com/bealdung/poi/excel/setformula/SetFormulaTest.xlsx\";\n+    private String fileLocation;\n+    private ExcelFormula excelFormula;\n+\n+    @BeforeEach\n+    public void setup() throws URISyntaxException {\n+        fileLocation = Paths.get(ClassLoader.getSystemResource(FILE_NAME).toURI()).toString();\n+        excelFormula = new ExcelFormula();\n+    }\n+\n+    @Test\n+    void givenExcelData_whenSetAndEvaluateFormula() throws IOException {", "originalCommit": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NTQxOQ==", "url": "https://github.com/eugenp/tutorials/pull/9604#discussion_r460545419", "bodyText": "Add a blank line before and after the call to setFormula", "author": "KevinGilmore", "createdAt": "2020-07-26T16:14:00Z", "path": "apache-poi/src/test/java/com/baeldung/poi/excel/setformula/ExcelFormulaUnitTest.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.baeldung.poi.excel.setformula;\n+\n+import org.apache.poi.ss.util.CellReference;\n+import org.apache.poi.xssf.usermodel.XSSFSheet;\n+import org.apache.poi.xssf.usermodel.XSSFWorkbook;\n+import org.junit.Assert;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.nio.file.Paths;\n+\n+class ExcelFormulaUnitTest {\n+    private static String FILE_NAME = \"com/bealdung/poi/excel/setformula/SetFormulaTest.xlsx\";\n+    private String fileLocation;\n+    private ExcelFormula excelFormula;\n+\n+    @BeforeEach\n+    public void setup() throws URISyntaxException {\n+        fileLocation = Paths.get(ClassLoader.getSystemResource(FILE_NAME).toURI()).toString();\n+        excelFormula = new ExcelFormula();\n+    }\n+\n+    @Test\n+    void givenExcelData_whenSetAndEvaluateFormula() throws IOException {\n+        FileInputStream inputStream = new FileInputStream(new File(fileLocation));\n+        XSSFWorkbook wb = new XSSFWorkbook(inputStream);\n+        XSSFSheet sheet = wb.getSheetAt(0);\n+        double resultColumnA = 0;\n+        double resultColumnB = 0;\n+        for (int row = 0; row <= sheet.getLastRowNum(); row++) {\n+            resultColumnA += sheet.getRow(row).getCell(0).getNumericCellValue();\n+            resultColumnB += sheet.getRow(row).getCell(1).getNumericCellValue();\n+        }\n+        String colNameA = CellReference.convertNumToColString(0);\n+        String colNameB = CellReference.convertNumToColString(1);\n+        String startCellA = colNameA + 1;\n+        String stopCellA = colNameA + (sheet.getLastRowNum() + 1);\n+        String sumFormulaForColumnA = String.format(\"SUM(%s:%s)\", startCellA, stopCellA);\n+        String startCellB = colNameB + 1;\n+        String stopCellB = colNameB + (sheet.getLastRowNum() + 1);\n+        String sumFormulaForColumnB = String.format(\"SUM(%s:%s)\", startCellB, stopCellB);\n+        double resultValue = excelFormula.setFormula(fileLocation, wb, sumFormulaForColumnA + \"-\" + sumFormulaForColumnB);", "originalCommit": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NTc5MQ==", "url": "https://github.com/eugenp/tutorials/pull/9604#discussion_r460545791", "bodyText": "Swap order of arguments to match the method signature: assertEquals(expected, actual)", "author": "KevinGilmore", "createdAt": "2020-07-26T16:17:39Z", "path": "apache-poi/src/test/java/com/baeldung/poi/excel/setformula/ExcelFormulaUnitTest.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.baeldung.poi.excel.setformula;\n+\n+import org.apache.poi.ss.util.CellReference;\n+import org.apache.poi.xssf.usermodel.XSSFSheet;\n+import org.apache.poi.xssf.usermodel.XSSFWorkbook;\n+import org.junit.Assert;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.nio.file.Paths;\n+\n+class ExcelFormulaUnitTest {\n+    private static String FILE_NAME = \"com/bealdung/poi/excel/setformula/SetFormulaTest.xlsx\";\n+    private String fileLocation;\n+    private ExcelFormula excelFormula;\n+\n+    @BeforeEach\n+    public void setup() throws URISyntaxException {\n+        fileLocation = Paths.get(ClassLoader.getSystemResource(FILE_NAME).toURI()).toString();\n+        excelFormula = new ExcelFormula();\n+    }\n+\n+    @Test\n+    void givenExcelData_whenSetAndEvaluateFormula() throws IOException {\n+        FileInputStream inputStream = new FileInputStream(new File(fileLocation));\n+        XSSFWorkbook wb = new XSSFWorkbook(inputStream);\n+        XSSFSheet sheet = wb.getSheetAt(0);\n+        double resultColumnA = 0;\n+        double resultColumnB = 0;\n+        for (int row = 0; row <= sheet.getLastRowNum(); row++) {\n+            resultColumnA += sheet.getRow(row).getCell(0).getNumericCellValue();\n+            resultColumnB += sheet.getRow(row).getCell(1).getNumericCellValue();\n+        }\n+        String colNameA = CellReference.convertNumToColString(0);\n+        String colNameB = CellReference.convertNumToColString(1);\n+        String startCellA = colNameA + 1;\n+        String stopCellA = colNameA + (sheet.getLastRowNum() + 1);\n+        String sumFormulaForColumnA = String.format(\"SUM(%s:%s)\", startCellA, stopCellA);\n+        String startCellB = colNameB + 1;\n+        String stopCellB = colNameB + (sheet.getLastRowNum() + 1);\n+        String sumFormulaForColumnB = String.format(\"SUM(%s:%s)\", startCellB, stopCellB);\n+        double resultValue = excelFormula.setFormula(fileLocation, wb, sumFormulaForColumnA + \"-\" + sumFormulaForColumnB);\n+        Assert.assertEquals(resultValue, resultColumnA - resultColumnB, 0d);", "originalCommit": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYyNjU3Ng==", "url": "https://github.com/eugenp/tutorials/pull/9604#discussion_r460626576", "bodyText": "This line still needs to be adjusted so that 0d is the \"expected\" and resultColumnA - resultColumnB is the \"actual\"", "author": "KevinGilmore", "createdAt": "2020-07-27T03:20:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NTc5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxNDQ4OQ==", "url": "https://github.com/eugenp/tutorials/pull/9604#discussion_r460714489", "bodyText": "the method signature is like this:\n\nthe \"resultValue\" is what I get from setFormula method and \"resultColumnA - resultColumnB\" is what is expected.\nAm I missing something?", "author": "SaTaSo", "createdAt": "2020-07-27T08:03:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NTc5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjYzMzUwNg==", "url": "https://github.com/eugenp/tutorials/pull/9604#discussion_r462633506", "bodyText": "No, you got it -- the latest change has what I was looking for. Thanks!", "author": "KevinGilmore", "createdAt": "2020-07-29T22:47:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NTc5MQ=="}], "type": "inlineReview"}, {"oid": "1700cbabd852cb67b62490b0c4c78d2aa83539fa", "url": "https://github.com/eugenp/tutorials/commit/1700cbabd852cb67b62490b0c4c78d2aa83539fa", "message": "change test class name, add blank line and swap assert method parameter", "committedDate": "2020-07-26T18:01:42Z", "type": "commit"}, {"oid": "dcf0ccdb308fc1e498e8c6a70ce59bea42c39eef", "url": "https://github.com/eugenp/tutorials/commit/dcf0ccdb308fc1e498e8c6a70ce59bea42c39eef", "message": "change baeldung spell", "committedDate": "2020-07-27T08:07:30Z", "type": "commit"}, {"oid": "e711f71303f2656cad422c7f198b9bc50e2c3b9d", "url": "https://github.com/eugenp/tutorials/commit/e711f71303f2656cad422c7f198b9bc50e2c3b9d", "message": "change address", "committedDate": "2020-07-28T12:23:08Z", "type": "commit"}, {"oid": "3aa53544e938468ffcf01e0509862bd26fa1c33e", "url": "https://github.com/eugenp/tutorials/commit/3aa53544e938468ffcf01e0509862bd26fa1c33e", "message": "Trigger Test", "committedDate": "2020-07-28T18:17:02Z", "type": "commit"}]}