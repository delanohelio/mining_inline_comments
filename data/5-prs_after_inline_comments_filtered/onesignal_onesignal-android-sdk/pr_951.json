{"pr_number": 951, "pr_title": "Remove IAM from db", "pr_createdAt": "2020-02-10T09:11:20Z", "pr_url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951", "timeline": [{"oid": "a6c9e4a208b7fbc3eee91b7d24462c9c09b44ad5", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/a6c9e4a208b7fbc3eee91b7d24462c9c09b44ad5", "message": "Remove IAM from db\n\n  * Update IAM with redisplay by backend", "committedDate": "2020-02-10T16:33:37Z", "type": "forcePushed"}, {"oid": "68ca0bdbd1b8e27cfbe3b65be395b9acaf399989", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/68ca0bdbd1b8e27cfbe3b65be395b9acaf399989", "message": "Remove IAM from db\n\n  * Update IAM with redisplay by backend", "committedDate": "2020-02-11T19:40:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ4OTcyOA==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r378489728", "bodyText": "The source of newMessages is driven directly by the results from the  on_session network call . However the results from on_session is drive by the backend and if the player fits into the Segments defined there. So this means the same IAM could fall in and out of Segment multiple times which would result in the on_session not always have it either.\nSo we don't reset the display stats noted above we should only delete these local records after a long period of time to be safe or not at all. Can we set this to 6 months to be safe?", "author": "jkasten2", "createdAt": "2020-02-12T20:17:33Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessageController.java", "diffHunk": "@@ -154,16 +155,26 @@ void receivedInAppMessageJson(@NonNull JSONArray json) throws JSONException {\n         // Cache copy for quick cold starts\n         OneSignalPrefs.saveString(OneSignalPrefs.PREFS_ONESIGNAL,\n            OneSignalPrefs.PREFS_OS_CACHED_IAMS, json.toString());\n-        processInAppMessageJson(json);\n+        ArrayList<OSInAppMessage> newMessages = processInAppMessageJson(json);\n+\n+        List<OSInAppMessage> updatedRedisplayMessages = inAppMessageRepository.updateInAppMessage(newMessages, redisplayInAppMessages);", "originalCommit": "4aa2fe125ccc2924111ca0caa4514aa2af7fe80e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTAyNTUxNQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r379025515", "bodyText": "oh ok, i will address this on here and iOS. 6 Months seems like a logic time period", "author": "Jeasmine", "createdAt": "2020-02-13T17:59:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ4OTcyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE5Mzg1MA==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r379193850", "bodyText": "Remove space before ArrayList", "author": "mikechoch", "createdAt": "2020-02-14T00:27:34Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessageController.java", "diffHunk": "@@ -154,16 +155,26 @@ void receivedInAppMessageJson(@NonNull JSONArray json) throws JSONException {\n         // Cache copy for quick cold starts\n         OneSignalPrefs.saveString(OneSignalPrefs.PREFS_ONESIGNAL,\n            OneSignalPrefs.PREFS_OS_CACHED_IAMS, json.toString());\n-        processInAppMessageJson(json);\n+        ArrayList<OSInAppMessage> newMessages = processInAppMessageJson(json);\n+\n+        List<OSInAppMessage> updatedRedisplayMessages = inAppMessageRepository.updateInAppMessage(newMessages, redisplayInAppMessages);\n+        if (redisplayInAppMessages.size() != updatedRedisplayMessages.size()) {\n+            redisplayInAppMessages = updatedRedisplayMessages;\n+        }\n+        setMessages(newMessages);\n     }\n \n-    private void processInAppMessageJson(@NonNull JSONArray json) throws JSONException {\n+    private ArrayList<OSInAppMessage>  processInAppMessageJson(@NonNull JSONArray json) throws JSONException {\n         ArrayList<OSInAppMessage> newMessages = new ArrayList<>();\n         for (int i = 0; i < json.length(); i++) {\n             JSONObject messageJson = json.getJSONObject(i);\n             OSInAppMessage message = new OSInAppMessage(messageJson);\n             newMessages.add(message);\n         }\n+        return newMessages;\n+    }\n+\n+    private void setMessages( ArrayList<OSInAppMessage> newMessages) {", "originalCommit": "4aa2fe125ccc2924111ca0caa4514aa2af7fe80e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE5MzkwNQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r379193905", "bodyText": "Add a space after //", "author": "mikechoch", "createdAt": "2020-02-14T00:27:46Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessageController.java", "diffHunk": "@@ -472,14 +483,14 @@ public void run() {\n \n         //Update the data to enable future re displays", "originalCommit": "4aa2fe125ccc2924111ca0caa4514aa2af7fe80e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE5MzkzNQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r379193935", "bodyText": "Add a space after //", "author": "mikechoch", "createdAt": "2020-02-14T00:27:52Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessageController.java", "diffHunk": "@@ -472,14 +483,14 @@ public void run() {\n \n         //Update the data to enable future re displays\n         //Avoid calling the repository data again", "originalCommit": "4aa2fe125ccc2924111ca0caa4514aa2af7fe80e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE5NDA3NQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r379194075", "bodyText": "* */ should just be */", "author": "mikechoch", "createdAt": "2020-02-14T00:28:23Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessageController.java", "diffHunk": "@@ -572,7 +583,7 @@ public void messageTriggerConditionChanged() {\n      * */", "originalCommit": "4aa2fe125ccc2924111ca0caa4514aa2af7fe80e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "17472cdc388c8da3f2c4ef3f6d035e8bdf8ca3fa", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/17472cdc388c8da3f2c4ef3f6d035e8bdf8ca3fa", "message": "Remove when lastDisplay is older than six month", "committedDate": "2020-02-18T18:25:37Z", "type": "forcePushed"}, {"oid": "459846dab026fb5b9276582b303c4a7a4ff90089", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/459846dab026fb5b9276582b303c4a7a4ff90089", "message": "Remove when lastDisplay is older than six month", "committedDate": "2020-02-18T18:29:35Z", "type": "forcePushed"}, {"oid": "8a96ebf33136b0f2dcc90430c0d77f2e5466c256", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/8a96ebf33136b0f2dcc90430c0d77f2e5466c256", "message": "Remove when lastDisplay is older than six month", "committedDate": "2020-02-18T18:31:03Z", "type": "forcePushed"}, {"oid": "bf1865bdf4c8f6973b7f9595f09690aafdea78e4", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/bf1865bdf4c8f6973b7f9595f09690aafdea78e4", "message": "Remove when lastDisplay is older than six month", "committedDate": "2020-02-18T18:55:27Z", "type": "forcePushed"}, {"oid": "98824eae01729546ae6d237220789b6e60128a25", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/98824eae01729546ae6d237220789b6e60128a25", "message": "Remove when lastDisplay is older than six month", "committedDate": "2020-02-18T21:33:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTAzMDY4Ng==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r381030686", "bodyText": "This is duplicated, it exists in com.onesignal.OSInAppMessageRepository as well. Also I don't see this being called in the tests so I think we can remove this deleteOldInAppMessages method here.", "author": "jkasten2", "createdAt": "2020-02-19T01:28:17Z", "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/TestHelpers.java", "diffHunk": "@@ -373,6 +398,49 @@ else if (type == Cursor.FIELD_TYPE_FLOAT)\n       return iams;\n    }\n \n+   @WorkerThread\n+   static void deleteOldInAppMessages() {", "originalCommit": "98824eae01729546ae6d237220789b6e60128a25", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTY5NzkxNw==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r381697917", "bodyText": "good catch, this was used before but I changed it. TY!", "author": "Jeasmine", "createdAt": "2020-02-20T03:02:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTAzMDY4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTAzMDc3Mw==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r381030773", "bodyText": "This is duplicated, it exists in com.onesignal.OSInAppMessageRepository as well. Also I don't see this being called in the tests so I think we can remove this deleteInAppMessage method here.", "author": "jkasten2", "createdAt": "2020-02-19T01:28:28Z", "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/TestHelpers.java", "diffHunk": "@@ -373,6 +398,49 @@ else if (type == Cursor.FIELD_TYPE_FLOAT)\n       return iams;\n    }\n \n+   @WorkerThread\n+   static void deleteOldInAppMessages() {\n+      SQLiteDatabase readableDb = OneSignalDbHelper.getInstance(RuntimeEnvironment.application).getReadableDatabase();\n+      Cursor cursor = readableDb.query(\n+              OneSignalPackagePrivateHelper.InAppMessageTable.TABLE_NAME,\n+              null,\n+              OneSignalPackagePrivateHelper.InAppMessageTable.COLUMN_NAME_LAST_DISPLAY + \">?\",\n+              new String[]{String.valueOf(SIX_MONTHS_TIME_SECONDS)},\n+              null,\n+              null,\n+              null\n+      );\n+\n+      if (cursor.moveToFirst()) {\n+         do {\n+            String idToRemove = cursor.getString(cursor.getColumnIndex(OneSignalPackagePrivateHelper.InAppMessageTable.COLUMN_NAME_MESSAGE_ID));\n+            deleteInAppMessage(idToRemove);\n+         } while (cursor.moveToNext());\n+      }\n+\n+      if (!cursor.isClosed())\n+         cursor.close();\n+   }\n+\n+   static void deleteInAppMessage(String messageId) {", "originalCommit": "98824eae01729546ae6d237220789b6e60128a25", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTAzMTI2OA==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r381031268", "bodyText": "We could use a writable db here and performance a single write. Instead getting a list of ids then doing a delete on each record one at a time.", "author": "jkasten2", "createdAt": "2020-02-19T01:30:19Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessageRepository.java", "diffHunk": "@@ -15,12 +16,40 @@\n \n class OSInAppMessageRepository {\n \n+    private static final long SIX_MONTHS_TIME_SECONDS = 6 * 30 * 24 * 60 * 60;\n     private final OneSignalDbHelper dbHelper;\n \n     OSInAppMessageRepository(OneSignalDbHelper dbHelper) {\n         this.dbHelper = dbHelper;\n     }\n \n+    /**\n+     * Remove IAMs that the last display time was six month ago\n+     */\n+    @WorkerThread\n+    void deleteOldInAppMessages(long dateInSeconds) {\n+        SQLiteDatabase readableDb = dbHelper.getReadableDbWithRetries();", "originalCommit": "98824eae01729546ae6d237220789b6e60128a25", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTcwMjE5Mg==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r381702192", "bodyText": "Absolutely right", "author": "Jeasmine", "createdAt": "2020-02-20T03:10:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTAzMTI2OA=="}], "type": "inlineReview"}, {"oid": "c5e76a73c93e75796f907262c7f87343d72db6e6", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/c5e76a73c93e75796f907262c7f87343d72db6e6", "message": "Remove when lastDisplay is older than six month", "committedDate": "2020-02-20T03:11:48Z", "type": "forcePushed"}, {"oid": "4701cf871355b14ec66be8447acc53420738fb21", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/4701cf871355b14ec66be8447acc53420738fb21", "message": "Remove when lastDisplay is older than six month", "committedDate": "2020-02-20T03:13:10Z", "type": "forcePushed"}, {"oid": "0b3678514e22a9c4b1addc1651c3ca9b0c500927", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/0b3678514e22a9c4b1addc1651c3ca9b0c500927", "message": "Remove when lastDisplay is older than six month", "committedDate": "2020-02-20T03:18:23Z", "type": "forcePushed"}, {"oid": "d40fc3c0520de6e97b6ee7df15d58d6329ea2984", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/d40fc3c0520de6e97b6ee7df15d58d6329ea2984", "message": "Remove IAM from db\n\n  * Remove IAMs with redisplay from DB when lastdisplay is\n    older than six month", "committedDate": "2020-02-20T04:13:39Z", "type": "forcePushed"}, {"oid": "ba767d98db3e65e75154f33db84ff16da79e3d6c", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/ba767d98db3e65e75154f33db84ff16da79e3d6c", "message": "Remove IAM from db\n\n  * Remove IAMs with redisplay from DB when lastdisplay is\n    older than six month", "committedDate": "2020-02-20T04:15:16Z", "type": "forcePushed"}, {"oid": "7671e05c4565c8ff2558cefda8e6e7d2014f82f2", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/7671e05c4565c8ff2558cefda8e6e7d2014f82f2", "message": "Remove IAM from db\n\n  * Remove IAMs with redisplay from DB when lastDisplay is\n    older than six month", "committedDate": "2020-02-20T04:16:43Z", "type": "forcePushed"}, {"oid": "ce2b13b707ba361140c455aa915f868aa98a5cbf", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/ce2b13b707ba361140c455aa915f868aa98a5cbf", "message": "Remove IAM from db\n\n  * Remove IAMs with redisplay from DB when lastDisplay is\n    older than six month", "committedDate": "2020-02-20T16:41:56Z", "type": "forcePushed"}, {"oid": "fa4b08bf82ca12f0f98685a7e57c156af9aff9ed", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/fa4b08bf82ca12f0f98685a7e57c156af9aff9ed", "message": "Remove IAM from db\n\n  * Remove IAMs with redisplay from DB when lastDisplay is\n    older than six month", "committedDate": "2020-02-20T17:23:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDEyOTMwMQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r384129301", "bodyText": "Change the tag associated with the thread, this is not a save action is it?", "author": "mikechoch", "createdAt": "2020-02-25T21:13:35Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessageController.java", "diffHunk": "@@ -144,6 +145,15 @@ void receivedInAppMessageJson(@NonNull JSONArray json) throws JSONException {\n         OneSignalPrefs.saveString(OneSignalPrefs.PREFS_ONESIGNAL,\n            OneSignalPrefs.PREFS_OS_CACHED_IAMS, json.toString());\n         processInAppMessageJson(json);\n+\n+        // Remove cache redisplayed messages\n+        new Thread(new Runnable() {\n+            @Override\n+            public void run() {\n+                Thread.currentThread().setPriority(Process.THREAD_PRIORITY_BACKGROUND);\n+                inAppMessageRepository.deleteOldRedisplayedInAppMessages();\n+            }\n+        }, OS_SAVE_IN_APP_MESSAGE).start();", "originalCommit": "fa4b08bf82ca12f0f98685a7e57c156af9aff9ed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDEzMDA3NQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r384130075", "bodyText": "Space after //", "author": "mikechoch", "createdAt": "2020-02-25T21:15:07Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessageDisplayStats.java", "diffHunk": "@@ -87,13 +87,10 @@ boolean shouldDisplayAgain() {\n     }\n \n     boolean isDelayTimeSatisfied() {\n-        long currentTimeInSeconds = System.currentTimeMillis() / 1000;\n-\n         if (lastDisplayTime < 0) {\n-            lastDisplayTime = currentTimeInSeconds;\n             return true;\n         }\n-\n+        long currentTimeInSeconds = System.currentTimeMillis() / 1000;\n         //Calculate gap between display times", "originalCommit": "fa4b08bf82ca12f0f98685a7e57c156af9aff9ed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDEzMDUzOQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/951#discussion_r384130539", "bodyText": "Space between <? -> < ?", "author": "mikechoch", "createdAt": "2020-02-25T21:15:55Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessageRepository.java", "diffHunk": "@@ -15,32 +15,24 @@\n \n class OSInAppMessageRepository {\n \n+    private static final long SIX_MONTHS_TIME_SECONDS = 6 * 30 * 24 * 60 * 60;\n     private final OneSignalDbHelper dbHelper;\n \n     OSInAppMessageRepository(OneSignalDbHelper dbHelper) {\n         this.dbHelper = dbHelper;\n     }\n \n+    /**\n+     * Remove IAMs that the last display time was six month ago\n+     */\n     @WorkerThread\n-    synchronized void deleteInAppMessage(String messageId) {\n+    synchronized void deleteOldRedisplayedInAppMessages() {\n+        long sixMonthsAgo = System.currentTimeMillis() / 1000 - SIX_MONTHS_TIME_SECONDS;\n         SQLiteDatabase writableDb = dbHelper.getWritableDbWithRetries();\n-\n-        try {\n-            writableDb.beginTransaction();\n-            writableDb.delete(OneSignalDbContract.InAppMessageTable.TABLE_NAME,\n-                    OneSignalDbContract.InAppMessageTable.COLUMN_NAME_MESSAGE_ID + \" = ?\", new String[]{messageId});\n-            writableDb.setTransactionSuccessful();\n-        } catch (Throwable t) {\n-            OneSignal.Log(OneSignal.LOG_LEVEL.ERROR, \"Error deleting in app message! \", t);\n-        } finally {\n-            if (writableDb != null) {\n-                try {\n-                    writableDb.endTransaction(); // May throw if transaction was never opened or DB is full.\n-                } catch (Throwable t) {\n-                    OneSignal.Log(OneSignal.LOG_LEVEL.ERROR, \"Error closing transaction! \", t);\n-                }\n-            }\n-        }\n+        writableDb.delete(OneSignalDbContract.InAppMessageTable.TABLE_NAME,\n+                OneSignalDbContract.InAppMessageTable.COLUMN_NAME_LAST_DISPLAY + \"<?\",", "originalCommit": "fa4b08bf82ca12f0f98685a7e57c156af9aff9ed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8e8048b2aad4c5196428b02cc86093228694f39b", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/8e8048b2aad4c5196428b02cc86093228694f39b", "message": "Remove IAM from db\n\n  * Remove IAMs with redisplay from DB when lastDisplay is\n    older than six month", "committedDate": "2020-02-25T22:24:54Z", "type": "forcePushed"}, {"oid": "a8223e6257c89dc1214316896b5cdaaa58ab1798", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/a8223e6257c89dc1214316896b5cdaaa58ab1798", "message": "Remove IAM from db\n\n  * Remove IAMs with redisplay from DB when lastDisplay is\n    older than six month", "committedDate": "2020-02-25T22:29:51Z", "type": "forcePushed"}, {"oid": "31d9e240a74c0e681d0395e7c968ab18e841306c", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/31d9e240a74c0e681d0395e7c968ab18e841306c", "message": "Remove IAM from db\n\n  * Remove IAMs with redisplay from DB when lastDisplay is\n    older than six month", "committedDate": "2020-02-25T22:32:34Z", "type": "commit"}, {"oid": "31d9e240a74c0e681d0395e7c968ab18e841306c", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/31d9e240a74c0e681d0395e7c968ab18e841306c", "message": "Remove IAM from db\n\n  * Remove IAMs with redisplay from DB when lastDisplay is\n    older than six month", "committedDate": "2020-02-25T22:32:34Z", "type": "forcePushed"}, {"oid": "af5e301d3c9bc142dd15e8bb8e38789f8248a01c", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/af5e301d3c9bc142dd15e8bb8e38789f8248a01c", "message": "Display once per session IAM with redisplay\n\n   * Add no trigger check, display once per session\n   * Add displayed param to IAM\n   * Add test for cold start and init OneSignal", "committedDate": "2020-02-27T23:21:55Z", "type": "commit"}]}