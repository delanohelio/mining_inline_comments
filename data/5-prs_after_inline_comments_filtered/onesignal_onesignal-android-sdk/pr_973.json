{"pr_number": 973, "pr_title": "Turned catch Throwables into a specific exception", "pr_createdAt": "2020-03-19T19:55:27Z", "pr_url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973", "timeline": [{"oid": "2af9749dde6ed54adca756b8053f6db6b277f174", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/2af9749dde6ed54adca756b8053f6db6b277f174", "message": "Turned catch Throwables into a specific exception\n\n* Catching Throwable is hiding root case exceptions which is causing unrelated exceptions to throw\n  - Such as an NPE due to something not being set or a Thread trying to start twice.\n* Only first pass, many more we can clean up.", "committedDate": "2020-03-20T18:26:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkyNjc5OA==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395926798", "bodyText": "is it ok to remove the != null check?\nIn that case the ()  can be removed", "author": "Jeasmine", "createdAt": "2020-03-20T23:08:08Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/GooglePlayServicesUpgradePrompt.java", "diffHunk": "@@ -30,8 +30,10 @@ private static boolean isGooglePlayStoreInstalled() {\n          PackageManager pm = OneSignal.appContext.getPackageManager();\n          PackageInfo info = pm.getPackageInfo(GoogleApiAvailability.GOOGLE_PLAY_SERVICES_PACKAGE, PackageManager.GET_META_DATA);\n          String label = (String) info.applicationInfo.loadLabel(pm);\n-         return (label != null && !label.equals(\"Market\"));\n-      } catch (Throwable e) {}\n+         return (!label.equals(\"Market\"));", "originalCommit": "2af9749dde6ed54adca756b8053f6db6b277f174", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkzODk5NQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395938995", "bodyText": "@Jeasmine Good eye, however the return definition of PackageInfo.loadLabel() has a @NonNull.\npublic @NonNull CharSequence loadLabel(@NonNull PackageManager pm) {", "author": "jkasten2", "createdAt": "2020-03-21T00:11:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkyNjc5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkyOTA3Mg==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395929072", "bodyText": "what IAP stand for? \ud83d\ude33", "author": "Jeasmine", "createdAt": "2020-03-20T23:19:00Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/TrackAmazonPurchase.java", "diffHunk": "@@ -72,11 +74,25 @@\n \n          canTrack = true;\n          setListener();\n-      } catch (Throwable t) {\n-         OneSignal.Log(OneSignal.LOG_LEVEL.ERROR, \"Error adding Amazon IAP listener.\", t);\n+         // Can replace all catches with ReflectiveOperationException win min API is 19\n+      } catch (ClassNotFoundException e) {\n+         logAmazonIAPListenerError(e);\n+      } catch (IllegalAccessException e) {\n+         logAmazonIAPListenerError(e);\n+      } catch (InvocationTargetException e) {\n+         logAmazonIAPListenerError(e);\n+      } catch (NoSuchMethodException e) {\n+         logAmazonIAPListenerError(e);\n+      } catch (NoSuchFieldException e) {\n+         logAmazonIAPListenerError(e);\n       }\n    }\n \n+   private static void logAmazonIAPListenerError(Exception e) {", "originalCommit": "2af9749dde6ed54adca756b8053f6db6b277f174", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkzOTA2NA==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395939064", "bodyText": "In-App Purchase", "author": "jkasten2", "createdAt": "2020-03-21T00:11:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkyOTA3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MDkxNQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395940915", "bodyText": "Idk why I laughed at this", "author": "mikechoch", "createdAt": "2020-03-21T00:23:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkyOTA3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MDU1Ng==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395940556", "bodyText": "t should be e", "author": "mikechoch", "createdAt": "2020-03-21T00:21:29Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/TrackFirebaseAnalytics.java", "diffHunk": "@@ -56,7 +56,7 @@ static boolean CanTrack() {\n       try {\n          FirebaseAnalyticsClass = Class.forName(\"com.google.firebase.analytics.FirebaseAnalytics\");\n          return true;\n-      } catch (Throwable t) {\n+      } catch (ClassNotFoundException t) {", "originalCommit": "2af9749dde6ed54adca756b8053f6db6b277f174", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MjAzNA==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395942034", "bodyText": "Good catch!", "author": "jkasten2", "createdAt": "2020-03-21T00:32:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MDU1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MjA3Mw==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395942073", "bodyText": "Fixed", "author": "jkasten2", "createdAt": "2020-03-21T00:32:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MDU1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MDU5OQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395940599", "bodyText": "t should be e", "author": "mikechoch", "createdAt": "2020-03-21T00:21:47Z", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignalDbHelper.java", "diffHunk": "@@ -147,7 +148,7 @@ synchronized SQLiteDatabase getReadableDbWithRetries() {\n       while(true) {\n          try {\n             return getReadableDatabase();\n-         } catch (Throwable t) {\n+         } catch (SQLiteCantOpenDatabaseException t) {", "originalCommit": "2af9749dde6ed54adca756b8053f6db6b277f174", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MjA1NQ==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395942055", "bodyText": "Good catch!", "author": "jkasten2", "createdAt": "2020-03-21T00:32:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MDU5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MjA4MA==", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/973#discussion_r395942080", "bodyText": "Fixed", "author": "jkasten2", "createdAt": "2020-03-21T00:32:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk0MDU5OQ=="}], "type": "inlineReview"}, {"oid": "cfa8274b1922565f87eb8324798eac2c1ba94aea", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/cfa8274b1922565f87eb8324798eac2c1ba94aea", "message": "Turned catch Throwables into a specific exception\n\n* Catching Throwable is hiding root case exceptions which is causing unrelated exceptions to throw\n  - Such as an NPE due to something not being set or a Thread trying to start twice.\n* Only first pass, many more we can clean up.", "committedDate": "2020-03-21T00:31:30Z", "type": "commit"}, {"oid": "cfa8274b1922565f87eb8324798eac2c1ba94aea", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/cfa8274b1922565f87eb8324798eac2c1ba94aea", "message": "Turned catch Throwables into a specific exception\n\n* Catching Throwable is hiding root case exceptions which is causing unrelated exceptions to throw\n  - Such as an NPE due to something not being set or a Thread trying to start twice.\n* Only first pass, many more we can clean up.", "committedDate": "2020-03-21T00:31:30Z", "type": "forcePushed"}]}