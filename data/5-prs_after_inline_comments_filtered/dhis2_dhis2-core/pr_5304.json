{"pr_number": 5304, "pr_title": "fix: NPE when Chart.category() is null [DHIS2-8590]", "pr_createdAt": "2020-04-03T13:00:54Z", "pr_url": "https://github.com/dhis2/dhis2-core/pull/5304", "timeline": [{"oid": "66b83feda882aa824466a3857e1f14d9408b0b62", "url": "https://github.com/dhis2/dhis2-core/commit/66b83feda882aa824466a3857e1f14d9408b0b62", "message": "fix: NPE when Chart.category() is null [DHIS2-8590]\n\nBackporting the NPE work around to (2.32)", "committedDate": "2020-04-03T12:47:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk5MTY1Nw==", "url": "https://github.com/dhis2/dhis2-core/pull/5304#discussion_r402991657", "bodyText": "Do we know why this is null? I.e. in what circumstances is it null? I thought category should never be null.", "author": "larshelge", "createdAt": "2020-04-03T13:07:36Z", "path": "dhis-2/dhis-services/dhis-service-reporting/src/main/java/org/hisp/dhis/chart/impl/DefaultChartService.java", "diffHunk": "@@ -796,7 +798,9 @@ else if ( chart.isAnalyticsType( AnalyticsType.EVENT ) )\n         valueMap = DimensionalObjectUtils.getSortedKeysMap( valueMap );\r\n \r\n         List<NameableObject> seriez = new ArrayList<>( chart.series() );\r\n-        List<NameableObject> categories = new ArrayList<>( chart.category() );\r\n+\r\n+        List<DimensionalItemObject> dimensionalItemObjects = chart.category() != null ? chart.category() : emptyList();\r", "originalCommit": "66b83feda882aa824466a3857e1f14d9408b0b62", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAxODA0Mw==", "url": "https://github.com/dhis2/dhis2-core/pull/5304#discussion_r403018043", "bodyText": "Some Charts like Pie or Gauge have only series. This chart generation is not prepared to support some kind of charts...", "author": "maikelarabori", "createdAt": "2020-04-03T13:48:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk5MTY1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODQ2MDMwNQ==", "url": "https://github.com/dhis2/dhis2-core/pull/5304#discussion_r408460305", "bodyText": "Could we do this?\nList<NameableObject> categories = new ArrayList<>( ObjectUtils.firstNonNull( chart.category(), new ArrayList<>() ) );", "author": "larshelge", "createdAt": "2020-04-14T21:57:08Z", "path": "dhis-2/dhis-services/dhis-service-reporting/src/main/java/org/hisp/dhis/chart/impl/DefaultChartService.java", "diffHunk": "@@ -796,7 +798,9 @@ else if ( chart.isAnalyticsType( AnalyticsType.EVENT ) )\n         valueMap = DimensionalObjectUtils.getSortedKeysMap( valueMap );\r\n \r\n         List<NameableObject> seriez = new ArrayList<>( chart.series() );\r\n-        List<NameableObject> categories = new ArrayList<>( chart.category() );\r\n+\r\n+        List<DimensionalItemObject> dimensionalItemObjects = chart.category() != null ? chart.category() : emptyList();\r", "originalCommit": "66b83feda882aa824466a3857e1f14d9408b0b62", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODcwNDQxMg==", "url": "https://github.com/dhis2/dhis2-core/pull/5304#discussion_r408704412", "bodyText": "Thanks Lars. I applied the same code I applied for other branches just to keep them in sync. It's pretty much the same in the end.", "author": "maikelarabori", "createdAt": "2020-04-15T09:26:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODQ2MDMwNQ=="}], "type": "inlineReview"}, {"oid": "44c1b862384dd9676ef49e9eab874b9ce685ccce", "url": "https://github.com/dhis2/dhis2-core/commit/44c1b862384dd9676ef49e9eab874b9ce685ccce", "message": "fix: Using defaultIfNull to check/set the Categories list [DHIS2-8590]", "committedDate": "2020-04-15T09:22:00Z", "type": "commit"}, {"oid": "f4caf943309c7361729b19b97c1d120bd8f6430f", "url": "https://github.com/dhis2/dhis2-core/commit/f4caf943309c7361729b19b97c1d120bd8f6430f", "message": "Merge branch '2.32' of https://github.com/dhis2/dhis2-core into 2.32_DHIS2-8590", "committedDate": "2020-04-16T12:09:43Z", "type": "commit"}]}