{"pr_number": 6628, "pr_title": "fix: send message rule action when stage is part of registration [DHIS2-9935]", "pr_createdAt": "2020-11-11T11:57:00Z", "pr_url": "https://github.com/dhis2/dhis2-core/pull/6628", "timeline": [{"oid": "00dc2926d92f1419dde741873bda6d11deb780e2", "url": "https://github.com/dhis2/dhis2-core/commit/00dc2926d92f1419dde741873bda6d11deb780e2", "message": "fix: send message rule action when ps is part of registration [DHIS2-9935]", "committedDate": "2020-11-11T11:54:52Z", "type": "commit"}, {"oid": "8691c69af4d255fe64ae5e0699152b8163b12dfa", "url": "https://github.com/dhis2/dhis2-core/commit/8691c69af4d255fe64ae5e0699152b8163b12dfa", "message": "minor", "committedDate": "2020-11-11T11:56:29Z", "type": "commit"}, {"oid": "e5602b51c721051c40ae694c109a7d4991cc2960", "url": "https://github.com/dhis2/dhis2-core/commit/e5602b51c721051c40ae694c109a7d4991cc2960", "message": "refactor to avoid work context reload", "committedDate": "2020-11-11T13:07:27Z", "type": "commit"}, {"oid": "11953a57b2fdc0b6e9da6e65a4032e168950213b", "url": "https://github.com/dhis2/dhis2-core/commit/11953a57b2fdc0b6e9da6e65a4032e168950213b", "message": "Merge branch 'master' into DHIS2-9935", "committedDate": "2020-11-16T15:38:29Z", "type": "commit"}, {"oid": "b1f8dfdba4ad931a00cfec4b5dc9f267df031ef7", "url": "https://github.com/dhis2/dhis2-core/commit/b1f8dfdba4ad931a00cfec4b5dc9f267df031ef7", "message": "removed unused method", "committedDate": "2020-11-17T09:00:41Z", "type": "commit"}, {"oid": "fa466b7ceac35279c5714d5c4d2ead4ff93d8d20", "url": "https://github.com/dhis2/dhis2-core/commit/fa466b7ceac35279c5714d5c4d2ead4ff93d8d20", "message": "Merge branch 'master' into DHIS2-9935", "committedDate": "2020-11-17T09:00:52Z", "type": "commit"}, {"oid": "7a11da5c7bec3fe93908c72773323253a60b997e", "url": "https://github.com/dhis2/dhis2-core/commit/7a11da5c7bec3fe93908c72773323253a60b997e", "message": "Merge branch 'master' into DHIS2-9935", "committedDate": "2020-12-21T07:23:12Z", "type": "commit"}, {"oid": "b295a8b6a10b3016ce3f73bc9800517f08ad5993", "url": "https://github.com/dhis2/dhis2-core/commit/b295a8b6a10b3016ce3f73bc9800517f08ad5993", "message": "Add use EventListener instead of TransactionalEventListener", "committedDate": "2020-12-21T08:54:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njc1NjM5OA==", "url": "https://github.com/dhis2/dhis2-core/pull/6628#discussion_r546756398", "bodyText": "Is this dependency needed?\nIt is passed in the methods as a parameter", "author": "enricocolasante", "createdAt": "2020-12-21T15:05:26Z", "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/events/importer/EventManager.java", "diffHunk": "@@ -82,6 +85,9 @@\n     @NonNull\n     private final ProcessingManager processingManager;\n \n+    @Nonnull\n+    private final WorkContextLoader contextLoader;", "originalCommit": "b295a8b6a10b3016ce3f73bc9800517f08ad5993", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3028f46187c36833c609bafa8fd1f4a10a134cb5", "url": "https://github.com/dhis2/dhis2-core/commit/3028f46187c36833c609bafa8fd1f4a10a134cb5", "message": "code refactor", "committedDate": "2020-12-22T07:44:31Z", "type": "commit"}, {"oid": "a6b4cfd3f2056dee924d7b01ffc1121375829de6", "url": "https://github.com/dhis2/dhis2-core/commit/a6b4cfd3f2056dee924d7b01ffc1121375829de6", "message": "Use fallbackExecution flag to invoke event even if there is no transaction", "committedDate": "2020-12-22T14:27:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTY1MTAzNA==", "url": "https://github.com/dhis2/dhis2-core/pull/6628#discussion_r549651034", "bodyText": "@luciano-fiandesio I need your feedback on this change.", "author": "zubaira", "createdAt": "2020-12-29T10:23:23Z", "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/program/notification/ProgramNotificationListener.java", "diffHunk": "@@ -73,13 +68,13 @@ public void onEvent( ProgramStageCompletionNotificationEvent event )\n     }\n \n     // Published by rule engine\n-    @TransactionalEventListener\n+    @TransactionalEventListener( fallbackExecution = true )\n     public void onProgramRuleEnrollment( ProgramRuleEnrollmentEvent event )\n     {\n         programNotificationService.sendProgramRuleTriggeredNotifications( event.getTemplate(), event.getProgramInstance() );\n     }\n \n-    @TransactionalEventListener\n+    @TransactionalEventListener( fallbackExecution = true )", "originalCommit": "a6b4cfd3f2056dee924d7b01ffc1121375829de6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6e1f0d991061f2286379751993b95478cb527920", "url": "https://github.com/dhis2/dhis2-core/commit/6e1f0d991061f2286379751993b95478cb527920", "message": "Merge branch 'master' into DHIS2-9935", "committedDate": "2020-12-29T10:35:21Z", "type": "commit"}, {"oid": "398ea7dbe946289ea3672bba14af45ba9d2bbea9", "url": "https://github.com/dhis2/dhis2-core/commit/398ea7dbe946289ea3672bba14af45ba9d2bbea9", "message": "use fallbackExecution flag in notification and rule listeners", "committedDate": "2020-12-30T08:20:52Z", "type": "commit"}, {"oid": "fcb0671e6a4e55875e4fafcf9142a8f9354f0d1d", "url": "https://github.com/dhis2/dhis2-core/commit/fcb0671e6a4e55875e4fafcf9142a8f9354f0d1d", "message": "minor code style", "committedDate": "2021-01-04T14:11:14Z", "type": "commit"}, {"oid": "749bbe8bfeb8c193df5405b760c84a8992b5336f", "url": "https://github.com/dhis2/dhis2-core/commit/749bbe8bfeb8c193df5405b760c84a8992b5336f", "message": "Merge branch 'master' into DHIS2-9935", "committedDate": "2021-01-04T15:15:34Z", "type": "commit"}]}