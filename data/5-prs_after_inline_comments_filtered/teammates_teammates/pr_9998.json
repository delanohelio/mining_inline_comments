{"pr_number": 9998, "pr_title": "[#9946] Migration to new RESTful search endpoints - Admin search service", "pr_createdAt": "2020-03-27T02:51:27Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/9998", "timeline": [{"oid": "f389027229ad5f05eac54f61a0b29ca1e837e05d", "url": "https://github.com/TEAMMATES/teammates/commit/f389027229ad5f05eac54f61a0b29ca1e837e05d", "message": "Fix linter errors and instructor service bug", "committedDate": "2020-03-29T14:35:51Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMzNDQwNw==", "url": "https://github.com/TEAMMATES/teammates/pull/9998#discussion_r404334407", "bodyText": "Might be good to put the string literal in const.java since it is used in multiple places", "author": "tiuweehan", "createdAt": "2020-04-06T19:27:24Z", "path": "src/main/java/teammates/ui/webapi/action/SearchInstructorsAction.java", "diffHunk": "@@ -26,13 +28,30 @@ public void checkSpecificAccessControl() {\n         }\n     }\n \n+    private void addAdditionalSearchFields(InstructorsData instructorsData, List<InstructorAttributes> instructors) {\n+        instructorsData.getInstructors()\n+                .forEach((InstructorData instructor) -> {\n+                    if (instructor.getGoogleId() != null) {\n+                        AccountAttributes account = logic.getAccount(instructor.getGoogleId());\n+                        if (account != null) {\n+                            String institute = StringHelper.isEmpty(account.institute) ? \"None\" : account.institute;", "originalCommit": "22efc66a8641c5a510429e6c8a0cea2af6af9b85", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMzNDgwNA==", "url": "https://github.com/TEAMMATES/teammates/pull/9998#discussion_r404334804", "bodyText": "Same here", "author": "tiuweehan", "createdAt": "2020-04-06T19:28:07Z", "path": "src/main/java/teammates/ui/webapi/action/SearchStudentsAction.java", "diffHunk": "@@ -26,6 +36,44 @@ public void checkSpecificAccessControl() {\n         }\n     }\n \n+    private void populateCourseIdToInstituteMap() {\n+        for (String courseId : courseIds) {\n+            String instructorForCourseGoogleId = findAvailableInstructorGoogleIdForCourse(courseId);\n+            AccountAttributes account = logic.getAccount(instructorForCourseGoogleId);\n+            if (account == null) {\n+                continue;\n+            }\n+\n+            String institute = StringHelper.isEmpty(account.institute) ? \"None\" : account.institute;", "originalCommit": "22efc66a8641c5a510429e6c8a0cea2af6af9b85", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMzODQ3NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/9998#discussion_r404338475", "bodyText": "Probably not necessary but you can assert that the resulting list is not empty", "author": "tiuweehan", "createdAt": "2020-04-06T19:34:33Z", "path": "src/main/java/teammates/ui/webapi/output/InstructorData.java", "diffHunk": "@@ -85,6 +93,25 @@ public void setJoinState(JoinState joinState) {\n         this.joinState = joinState;\n     }\n \n+    public String getKey() {\n+        return key;\n+    }\n+\n+    public void setKey(List<InstructorAttributes> instructorAttributes) {\n+        this.key = StringHelper.encrypt(instructorAttributes.stream()\n+                .filter((InstructorAttributes instructorAttribute)\n+                        -> this.googleId.equals(instructorAttribute.getGoogleId()))\n+                .collect(Collectors.toList()).get(0).getKey());", "originalCommit": "22efc66a8641c5a510429e6c8a0cea2af6af9b85", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f987d4c4834a3d1b9091dfbef11517a2ca3b40c1", "url": "https://github.com/TEAMMATES/teammates/commit/f987d4c4834a3d1b9091dfbef11517a2ca3b40c1", "message": "Fix typos", "committedDate": "2020-04-07T11:54:08Z", "type": "forcePushed"}, {"oid": "5c7279f421fe128710b4944913de17ce13fc280b", "url": "https://github.com/TEAMMATES/teammates/commit/5c7279f421fe128710b4944913de17ce13fc280b", "message": "Fix Comments", "committedDate": "2020-04-07T13:15:13Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2MzY4MA==", "url": "https://github.com/TEAMMATES/teammates/pull/9998#discussion_r405063680", "bodyText": "You know the file will be auto-sync to the frontend right? Don't you think it is a bit weird for the backend to control what the frontend URL would be?", "author": "xpdavid", "createdAt": "2020-04-07T19:37:53Z", "path": "src/main/java/teammates/ui/webapi/endpoints/WebPageEndpoints.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package teammates.ui.webapi.endpoints;\n+\n+import com.fasterxml.jackson.annotation.JsonValue;\n+\n+import teammates.common.util.Const.WebPageURIs;\n+\n+/**\n+ * API endpoints for web pages.\n+ */\n+public enum WebPageEndpoints {", "originalCommit": "074208ffbb06b9c41fbe1a69a381aadb323660fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIzNDM3OA==", "url": "https://github.com/TEAMMATES/teammates/pull/9998#discussion_r405234378", "bodyText": "Actually could I ask what this auto-sync means? I was trying to follow Wee Han's ResourceEndpoints format because previously i was hardcoding the raw string which felt a little wrong", "author": "hcwong", "createdAt": "2020-04-08T03:15:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2MzY4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI0NDc1Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/9998#discussion_r405244757", "bodyText": "@tiuweehan You might want to explain?", "author": "xpdavid", "createdAt": "2020-04-08T03:59:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2MzY4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjcxNzA0Mg==", "url": "https://github.com/TEAMMATES/teammates/pull/9998#discussion_r406717042", "bodyText": "The URIs for navigation should stay in the frontend - only the URIs for API calls should be synced in both frontend and backend", "author": "tiuweehan", "createdAt": "2020-04-10T11:26:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2MzY4MA=="}], "type": "inlineReview"}, {"oid": "fe12a03d3a01dc976ab3147a88d2c4ae136b4545", "url": "https://github.com/TEAMMATES/teammates/commit/fe12a03d3a01dc976ab3147a88d2c4ae136b4545", "message": "Add institute and key to InstructorData", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "ee39420ad3b6cedabb692a8eaf922f91118c2a1f", "url": "https://github.com/TEAMMATES/teammates/commit/ee39420ad3b6cedabb692a8eaf922f91118c2a1f", "message": "Fix comments", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "9e3431d190fb9099090ef7ca4f3d0a9b7f71759c", "url": "https://github.com/TEAMMATES/teammates/commit/9e3431d190fb9099090ef7ca4f3d0a9b7f71759c", "message": "Implement search student endpoint", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "2de271ead1af745a4cd29f600ec763cfc56cf8f3", "url": "https://github.com/TEAMMATES/teammates/commit/2de271ead1af745a4cd29f600ec763cfc56cf8f3", "message": "Implement instructors search endpoint (#2)\n\n* Add instructor search endpoint\r\n\r\n* Add tests", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "5d121bb03dca52fd7fc10f52f46bcfcab87e4746", "url": "https://github.com/TEAMMATES/teammates/commit/5d121bb03dca52fd7fc10f52f46bcfcab87e4746", "message": "Switch from SearchInstructorsData to InstructorsData (#6)", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "8fba0f1536308fb40d630b0e73ddf2401130908d", "url": "https://github.com/TEAMMATES/teammates/commit/8fba0f1536308fb40d630b0e73ddf2401130908d", "message": "Switch from SearchStudentsData to StudentsData (#7)", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "7f6a5c7c3203516100f7136f8c3f8c05a87c35c9", "url": "https://github.com/TEAMMATES/teammates/commit/7f6a5c7c3203516100f7136f8c3f8c05a87c35c9", "message": "Allow travis to build search migration branch (#5)", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "cfb2cbc9f4711cd3ea6326009301918ba45c6f69", "url": "https://github.com/TEAMMATES/teammates/commit/cfb2cbc9f4711cd3ea6326009301918ba45c6f69", "message": "Implement sessions search endpoint (#3)\n\n* Add sessions search endpoint\r\n\r\n* Add tests\r\n\r\n* Fix lint errors", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "5c3f5969f0e675f3d9a64be83cb95d5e41cea3b5", "url": "https://github.com/TEAMMATES/teammates/commit/5c3f5969f0e675f3d9a64be83cb95d5e41cea3b5", "message": "Add course endpoint (#8)", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "f13e7bc2bcbe2bb32c97b3b9015af5b5170f4d5f", "url": "https://github.com/TEAMMATES/teammates/commit/f13e7bc2bcbe2bb32c97b3b9015af5b5170f4d5f", "message": "Implement Links Endpoint (#4)", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "cd5230f7780caf5a0aafa9e23c593698eb8db6ed", "url": "https://github.com/TEAMMATES/teammates/commit/cd5230f7780caf5a0aafa9e23c593698eb8db6ed", "message": "Add googleId  field to StudentData (#9)\n\n* Add googleid to studentdata\r\n\r\n* Add nullable to student data", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "93b52b6b559cb2bc2b7a6197e402381bfb4ec254", "url": "https://github.com/TEAMMATES/teammates/commit/93b52b6b559cb2bc2b7a6197e402381bfb4ec254", "message": "Improve search response classes (#12)\n\n* Improve students endpoint classes\r\n\r\n* Move joinState attribute from common to student\r\n\r\n* Improve instructors endpoint classes\r\n\r\n* Revert \"Add googleId  field to StudentData (#9)\"\r\n\r\nThis reverts commit b5d46cabc092bf3bedc429ae1c771515bf149606.\r\n\r\n* Revert unnecessary InstructorData changes\r\n\r\n* Fix typo\r\n\r\n* Make joinState common\r\n\r\n* Make names sane again\r\n\r\n* Remove unused setters", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "c057abbf193d69cb34c8b7bdddb21ec2981d919c", "url": "https://github.com/TEAMMATES/teammates/commit/c057abbf193d69cb34c8b7bdddb21ec2981d919c", "message": "Standardize search endpoints (#13)\n\n* Improve course endpoint class names\r\n\r\n* Improve links endpoint class names\r\n\r\n* Improve sessions endpoint class names\r\n\r\n* Standardize comments\r\n\r\n* Fix import order", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "920c23fa606e5b1279584ec86fe5658681fd228a", "url": "https://github.com/TEAMMATES/teammates/commit/920c23fa606e5b1279584ec86fe5658681fd228a", "message": "Revert travis config", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "8667beea151a0cc8cd6305a496fd8dd3e2222a5f", "url": "https://github.com/TEAMMATES/teammates/commit/8667beea151a0cc8cd6305a496fd8dd3e2222a5f", "message": "Split PR", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "d0f803709fec8c10942b73b7d38872aef29c5dae", "url": "https://github.com/TEAMMATES/teammates/commit/d0f803709fec8c10942b73b7d38872aef29c5dae", "message": "Revert to existing response classes", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "f15d7a377fa5d2fb656f0fdfa7b6d8995866a377", "url": "https://github.com/TEAMMATES/teammates/commit/f15d7a377fa5d2fb656f0fdfa7b6d8995866a377", "message": "Allow some attributes to be optional", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "d949a8f0687cd11c3c2cb862747c19139aa479af", "url": "https://github.com/TEAMMATES/teammates/commit/d949a8f0687cd11c3c2cb862747c19139aa479af", "message": "Improve information hiding logic", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "bc7b42b15aed582ca595aca74b03c36142456dba", "url": "https://github.com/TEAMMATES/teammates/commit/bc7b42b15aed582ca595aca74b03c36142456dba", "message": "Improve resource name", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "ead281077be2320a4ff70e5c10f2a01d8ad63eaa", "url": "https://github.com/TEAMMATES/teammates/commit/ead281077be2320a4ff70e5c10f2a01d8ad63eaa", "message": "Add key and institute field to students", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "bad0f2693826420c003ef861a053258a1a7fdb52", "url": "https://github.com/TEAMMATES/teammates/commit/bad0f2693826420c003ef861a053258a1a7fdb52", "message": "Fix rebase issues", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "09b72ec0b0c628b2a241f2024cad18ead18c4233", "url": "https://github.com/TEAMMATES/teammates/commit/09b72ec0b0c628b2a241f2024cad18ead18c4233", "message": "Add mapping for courseId to instructorId\n\nCo-authored-by: Daryl Chan <6095637+dvrylc@users.noreply.github.com>", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "60631701e988d38ea94c62590753d053fe1bb197", "url": "https://github.com/TEAMMATES/teammates/commit/60631701e988d38ea94c62590753d053fe1bb197", "message": "Fix some comments", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "57f0c97429ab39a235b5cb5690affee16e39a4e0", "url": "https://github.com/TEAMMATES/teammates/commit/57f0c97429ab39a235b5cb5690affee16e39a4e0", "message": "Move key generation logic to studentData", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "f2764b739e5045a11f7b814331469475f7084cfd", "url": "https://github.com/TEAMMATES/teammates/commit/f2764b739e5045a11f7b814331469475f7084cfd", "message": "Implement search endpoints", "committedDate": "2020-04-11T14:14:15Z", "type": "commit"}, {"oid": "55034c138b9f981af03a24abf2629e7adaabe688", "url": "https://github.com/TEAMMATES/teammates/commit/55034c138b9f981af03a24abf2629e7adaabe688", "message": "WIP", "committedDate": "2020-04-11T14:15:57Z", "type": "commit"}, {"oid": "ce3cb881a9d295f6a280888ad723cf7b97020b20", "url": "https://github.com/TEAMMATES/teammates/commit/ce3cb881a9d295f6a280888ad723cf7b97020b20", "message": "Fix linter", "committedDate": "2020-04-11T14:20:41Z", "type": "commit"}, {"oid": "915aa22377f0095f6fc0480a985178409e647c03", "url": "https://github.com/TEAMMATES/teammates/commit/915aa22377f0095f6fc0480a985178409e647c03", "message": "Fix lexical scoping", "committedDate": "2020-04-11T14:21:15Z", "type": "commit"}, {"oid": "a68aa28a74bee59dd3d1207b32eb80afcbb2579a", "url": "https://github.com/TEAMMATES/teammates/commit/a68aa28a74bee59dd3d1207b32eb80afcbb2579a", "message": "Make destructuring better", "committedDate": "2020-04-11T14:21:15Z", "type": "commit"}, {"oid": "e0d89a867ad84aa13685ad8258fd19121c232a43", "url": "https://github.com/TEAMMATES/teammates/commit/e0d89a867ad84aa13685ad8258fd19121c232a43", "message": "WIP", "committedDate": "2020-04-11T14:23:48Z", "type": "commit"}, {"oid": "1fdf4cad8e5f3645adcd9e4682a2fa1089764b18", "url": "https://github.com/TEAMMATES/teammates/commit/1fdf4cad8e5f3645adcd9e4682a2fa1089764b18", "message": "Add link generation functions", "committedDate": "2020-04-11T14:28:31Z", "type": "commit"}, {"oid": "fc83cdbe44ec0693218850f3696c97bb76f086c0", "url": "https://github.com/TEAMMATES/teammates/commit/fc83cdbe44ec0693218850f3696c97bb76f086c0", "message": "Add test for search service", "committedDate": "2020-04-11T14:29:57Z", "type": "commit"}, {"oid": "a4feb6db5e8e7dd60cf2ef7000a5373e28c1a04d", "url": "https://github.com/TEAMMATES/teammates/commit/a4feb6db5e8e7dd60cf2ef7000a5373e28c1a04d", "message": "Add more tests for link and feedback service", "committedDate": "2020-04-11T14:30:28Z", "type": "commit"}, {"oid": "e7b980b366211c6c777b87a25b25da2308bc6fe2", "url": "https://github.com/TEAMMATES/teammates/commit/e7b980b366211c6c777b87a25b25da2308bc6fe2", "message": "Fix typos", "committedDate": "2020-04-11T14:30:28Z", "type": "commit"}, {"oid": "8e014d22dbd835e9c4ecd5be6f5e387d55d2df38", "url": "https://github.com/TEAMMATES/teammates/commit/8e014d22dbd835e9c4ecd5be6f5e387d55d2df38", "message": "Fix rebase errors", "committedDate": "2020-04-11T14:30:28Z", "type": "commit"}, {"oid": "c64591adfdfd2d91b52d44b6c68b795f24a5fb44", "url": "https://github.com/TEAMMATES/teammates/commit/c64591adfdfd2d91b52d44b6c68b795f24a5fb44", "message": "Fix Comments", "committedDate": "2020-04-11T14:31:01Z", "type": "commit"}, {"oid": "1b217727b4b769eb7a792362b6a57c914c1b62ef", "url": "https://github.com/TEAMMATES/teammates/commit/1b217727b4b769eb7a792362b6a57c914c1b62ef", "message": "delete print code", "committedDate": "2020-04-11T14:31:01Z", "type": "commit"}, {"oid": "75078a88d4373db026a273b46d2f65aff8be1d86", "url": "https://github.com/TEAMMATES/teammates/commit/75078a88d4373db026a273b46d2f65aff8be1d86", "message": "Fix comments", "committedDate": "2020-04-11T14:33:05Z", "type": "commit"}, {"oid": "79ac3cf07581359ad262bb388bdb6468361c04aa", "url": "https://github.com/TEAMMATES/teammates/commit/79ac3cf07581359ad262bb388bdb6468361c04aa", "message": "remove redundant calls", "committedDate": "2020-04-11T14:34:05Z", "type": "commit"}, {"oid": "7be1a637b2f285c14a406afa3eb456bbd8f3d940", "url": "https://github.com/TEAMMATES/teammates/commit/7be1a637b2f285c14a406afa3eb456bbd8f3d940", "message": "Remove navigation links from backend", "committedDate": "2020-04-11T14:34:26Z", "type": "commit"}, {"oid": "d7a7bd962db44b8073b26ace98a79365bbc09a23", "url": "https://github.com/TEAMMATES/teammates/commit/d7a7bd962db44b8073b26ace98a79365bbc09a23", "message": "Fix rebase issues", "committedDate": "2020-04-11T14:53:02Z", "type": "commit"}, {"oid": "d7a7bd962db44b8073b26ace98a79365bbc09a23", "url": "https://github.com/TEAMMATES/teammates/commit/d7a7bd962db44b8073b26ace98a79365bbc09a23", "message": "Fix rebase issues", "committedDate": "2020-04-11T14:53:02Z", "type": "forcePushed"}, {"oid": "ab46a217da436f354f5e60b031dfcbf529a62875", "url": "https://github.com/TEAMMATES/teammates/commit/ab46a217da436f354f5e60b031dfcbf529a62875", "message": "Retrigger travis", "committedDate": "2020-04-11T15:18:52Z", "type": "commit"}, {"oid": "b94bf81ee4c524e4909264dd42642f1e57fe7c7b", "url": "https://github.com/TEAMMATES/teammates/commit/b94bf81ee4c524e4909264dd42642f1e57fe7c7b", "message": "Linter", "committedDate": "2020-04-12T13:53:57Z", "type": "commit"}]}