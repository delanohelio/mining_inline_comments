{"pr_number": 456, "pr_title": "Improve interfaces of excel io", "pr_createdAt": "2020-02-04T15:06:58Z", "pr_url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/456", "timeline": [{"oid": "ddbba7b4c428f0efa1c673c547bc9876ab4930fd", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/ddbba7b4c428f0efa1c673c547bc9876ab4930fd", "message": "Changed Storage of final variables of funcelectrical - (Task #412)\n\nExtract variables only used in funcelectrical from AExcello into\nAExcelFuncIO\n\n---\nTask #412: Improve interfaces of the export / import excel classes", "committedDate": "2020-01-30T08:18:53Z", "type": "commit"}, {"oid": "e2a7970ab551e527fe50fc8845442ae9280d7fc5", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/e2a7970ab551e527fe50fc8845442ae9280d7fc5", "message": "Resorted in funcelectrical plugin - (Task #412)\n\n---\nTask #412: Improve interfaces of the export / import excel classes", "committedDate": "2020-01-30T08:47:54Z", "type": "commit"}, {"oid": "5784f8758eafa07791ac084b2f829761ab72c6d0", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/5784f8758eafa07791ac084b2f829761ab72c6d0", "message": "Changes in test- (Task #412)\n\nPut your Message here.\n\n---\nTask #412: Improve interfaces of the export / import excel classes", "committedDate": "2020-01-30T08:48:49Z", "type": "commit"}, {"oid": "c0e72c1d38d329b95c1cfae4f6ea119fe933a46e", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/c0e72c1d38d329b95c1cfae4f6ea119fe933a46e", "message": "Changed Storage of final variables of statemaschine - (Task #412)\n\n---\nTask #412: Improve interfaces of the export / import excel classes", "committedDate": "2020-01-30T09:02:25Z", "type": "commit"}, {"oid": "4b612b38d58e665975f8cd4777622cdec1bdc7bd", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/4b612b38d58e665975f8cd4777622cdec1bdc7bd", "message": "Deleted unused methods in Fault - (Task #412)\n\n---\nTask #412: Improve interfaces of the export / import excel classes", "committedDate": "2020-01-31T07:56:49Z", "type": "commit"}, {"oid": "9d57299137cb1df324eb57bc402da04dfe584a20", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/9d57299137cb1df324eb57bc402da04dfe584a20", "message": "Changed Fault handling - (Task #412)\n\nsplit up enum with possible faults\n\n---\nTask #412: Improve interfaces of the export / import excel classes", "committedDate": "2020-01-31T13:07:45Z", "type": "commit"}, {"oid": "36542ab15723ee956e7ff94f046cc75c6c649a16", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/36542ab15723ee956e7ff94f046cc75c6c649a16", "message": "Statemaschine-exporter not extends on ExcelExportHelper - (Task #412)\n\n---\nTask #412: Improve interfaces of the export / import excel classes", "committedDate": "2020-01-31T14:31:56Z", "type": "commit"}, {"oid": "c1c0b1f9c214903fba0f9ad175d23c2dbc9c2dcf", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/c1c0b1f9c214903fba0f9ad175d23c2dbc9c2dcf", "message": "Merge remote-tracking branch 'origin/development' into feature/task_412-Improve_interfaces_of_excelIO", "committedDate": "2020-02-03T11:50:32Z", "type": "commit"}, {"oid": "338b0c067f7263e7c471977ec0896f19d8aea2f7", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/338b0c067f7263e7c471977ec0896f19d8aea2f7", "message": "Merge remote-tracking branch 'origin/feature/task_411-Improve_coding_style' into feature/task_412-Improve_interfaces_of_excelIO", "committedDate": "2020-02-04T14:47:50Z", "type": "commit"}, {"oid": "af2b6bba2a04dd38e1f05670a0f60edea77fa136", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/af2b6bba2a04dd38e1f05670a0f60edea77fa136", "message": "Changed all File ends - (Task #412)\n\n---\nTask #412: Improve interfaces of the export / import excel classes", "committedDate": "2020-02-05T14:35:28Z", "type": "commit"}, {"oid": "24249431d336ba58bdf047e3b3279d5ba5abb40d", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/24249431d336ba58bdf047e3b3279d5ba5abb40d", "message": "Deleted the warning - (Task #455)\n\n---\nTask #455: Exported excel contains outdated warning", "committedDate": "2020-02-05T15:24:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI1MjkzMQ==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/456#discussion_r375252931", "bodyText": "Let's stick to the newlines at the end of files", "author": "andriikovalov-dlr", "createdAt": "2020-02-05T13:27:26Z", "path": "de.dlr.sc.virsat.excel.test/src/de/dlr/sc/virsat/excel/ExcelExporterTest.java", "diffHunk": "@@ -80,12 +74,12 @@ public void testCanExport() throws CoreException {\n \t\tboolean canExportObject = exporter.canExport(new Object());\r\n \t\tassertFalse(\"String exporter cannot export an Object\", canExportObject);\r\n \t}\r\n-\t\r\n+\r\n \t@Test\r\n \tpublic void testExport() throws CoreException {\r\n \t\tExcelExporter exporter = new ExcelExporter(registry);\r\n \t\tassertFalse(executed);\r\n \t\texporter.export(null, null, false, null);\r\n \t\tassertTrue(executed);\r\n \t}\r\n-}\r\n+}", "originalCommit": "338b0c067f7263e7c471977ec0896f19d8aea2f7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM1ODE2Nw==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/456#discussion_r375358167", "bodyText": "Let's add a short comment explaining why this interface is empty", "author": "andriikovalov-dlr", "createdAt": "2020-02-05T16:18:21Z", "path": "de.dlr.sc.virsat.excel/src/de/dlr/sc/virsat/excel/fault/IFaultType.java", "diffHunk": "@@ -0,0 +1,17 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2019 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.excel.fault;\r\n+\r\n+/**\r\n+ * This interface is for all possible faults which can happen during import\r\n+ */\r\n+public interface IFaultType {\r\n+\t\r", "originalCommit": "338b0c067f7263e7c471977ec0896f19d8aea2f7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTc4ODA0MA==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/456#discussion_r375788040", "bodyText": "@andriikovalov-dlr I added something as an explanation, but I am not sure if it is oky. Could you please check it?", "author": "ALEhmerDLR", "createdAt": "2020-02-06T11:44:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM1ODE2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM2NjQ4NQ==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/456#discussion_r375366485", "bodyText": "Let's maybe rename it to seis?", "author": "andriikovalov-dlr", "createdAt": "2020-02-05T16:31:08Z", "path": "de.dlr.sc.virsat.model.extension.funcelectrical/src/de/dlr/sc/virsat/model/extension/funcelectrical/excel/exporter/FuncElecExporter.java", "diffHunk": "@@ -42,69 +43,60 @@\n import de.dlr.sc.virsat.model.extension.ps.model.ElementOccurence;\r\n import de.dlr.sc.virsat.model.extension.ps.model.ElementRealization;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Class for exporting excel\r\n- * @author bell_er\r\n- *\r\n  */\r\n public class FuncElecExporter implements IExport {\r\n \tprivate final String defaultTemplatePath = \"/resources/ExcelExportTemplate.xlsx\";\r\n \tprivate ExcelExportHelper helper;\r\n \r\n-\tpublic static final String[] EXPORTABLE_SEIS = { \r\n+\tpublic static final String[] EXPORTABLE_SEIS = {\r\n \t\t\tElementDefinition.class.getSimpleName(),\r\n-\t\t\tElementConfiguration.class.getSimpleName(), \r\n-\t\t\tInterfaceTypeCollection.class.getSimpleName(), \r\n+\t\t\tElementConfiguration.class.getSimpleName(),\r\n+\t\t\tInterfaceTypeCollection.class.getSimpleName(),\r\n \t\t\tElementRealization.class.getSimpleName(),\r\n \t\t\tElementOccurence.class.getSimpleName()\r\n \t};\r\n+\r\n \t@Override\r\n \tpublic void export(EObject eObject, String path, boolean useDefaultTemplate, String templatePath) {\r\n \t\tStructuralElementInstance parentSc = (StructuralElementInstance) eObject;\r\n-\t\tArrayList <StructuralElementInstance> allSei = new ArrayList<StructuralElementInstance>();\r\n-\t\tallSei.add(parentSc);\r\n-\t\tallSei.addAll(parentSc.getDeepChildren());\r\n-\t\tfor (StructuralElementInstance sc : allSei) {\r\n-\t\t\tString selectedSEIType = sc.getType().getName();\r\n+\t\tArrayList <StructuralElementInstance> seiList = new ArrayList<StructuralElementInstance>();\r", "originalCommit": "338b0c067f7263e7c471977ec0896f19d8aea2f7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM3MzExOQ==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/456#discussion_r375373119", "bodyText": "Let's use System.lineSeparator() instead of \\n", "author": "andriikovalov-dlr", "createdAt": "2020-02-05T16:41:58Z", "path": "de.dlr.sc.virsat.model.extension.funcelectrical/src/de/dlr/sc/virsat/model/extension/funcelectrical/excel/exporter/FuncElecExporter.java", "diffHunk": "@@ -42,69 +43,60 @@\n import de.dlr.sc.virsat.model.extension.ps.model.ElementOccurence;\r\n import de.dlr.sc.virsat.model.extension.ps.model.ElementRealization;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Class for exporting excel\r\n- * @author bell_er\r\n- *\r\n  */\r\n public class FuncElecExporter implements IExport {\r\n \tprivate final String defaultTemplatePath = \"/resources/ExcelExportTemplate.xlsx\";\r\n \tprivate ExcelExportHelper helper;\r\n \r\n-\tpublic static final String[] EXPORTABLE_SEIS = { \r\n+\tpublic static final String[] EXPORTABLE_SEIS = {\r\n \t\t\tElementDefinition.class.getSimpleName(),\r\n-\t\t\tElementConfiguration.class.getSimpleName(), \r\n-\t\t\tInterfaceTypeCollection.class.getSimpleName(), \r\n+\t\t\tElementConfiguration.class.getSimpleName(),\r\n+\t\t\tInterfaceTypeCollection.class.getSimpleName(),\r\n \t\t\tElementRealization.class.getSimpleName(),\r\n \t\t\tElementOccurence.class.getSimpleName()\r\n \t};\r\n+\r\n \t@Override\r\n \tpublic void export(EObject eObject, String path, boolean useDefaultTemplate, String templatePath) {\r\n \t\tStructuralElementInstance parentSc = (StructuralElementInstance) eObject;\r\n-\t\tArrayList <StructuralElementInstance> allSei = new ArrayList<StructuralElementInstance>();\r\n-\t\tallSei.add(parentSc);\r\n-\t\tallSei.addAll(parentSc.getDeepChildren());\r\n-\t\tfor (StructuralElementInstance sc : allSei) {\r\n-\t\t\tString selectedSEIType = sc.getType().getName();\r\n+\t\tArrayList <StructuralElementInstance> seiList = new ArrayList<StructuralElementInstance>();\r\n+\t\tseiList.add(parentSc);\r\n+\t\tseiList.addAll(parentSc.getDeepChildren());\r\n+\t\tfor (StructuralElementInstance sei : seiList) {\r\n+\t\t\tString selectedSEIType = sei.getType().getName();\r\n \t\t\tif (Stream.of(EXPORTABLE_SEIS).anyMatch(exportable -> exportable.equals(selectedSEIType))) {\r\n-\t\t\t\tInputStream is = null;\r\n+\t\t\t\tInputStream iStream = null;\r\n \t\t\t\ttry {\r\n \t\t\t\t\tif (useDefaultTemplate) {\r\n-\t\t\t\t\t\tis = Activator.getResourceContentAsString(defaultTemplatePath);\r\n+\t\t\t\t\t\tiStream = Activator.getResourceContentAsString(defaultTemplatePath);\r\n \t\t\t\t\t} else {\r\n-\t\t\t\t\t\tis = Activator.getResourceContentAsString(templatePath);\r\n+\t\t\t\t\t\tiStream = Activator.getResourceContentAsString(templatePath);\r\n \t\t\t\t\t}\r\n-\t\t\t\t} catch (IOException e) {\r\n-\t\t\t\t\tActivator.getDefault().getLog().log(new Status(Status.WARNING, Activator.getPluginId(), \"Could not locate the template file\"));\r\n-\t\t\t\t}\r\n-\t\t\t\texport(sc, is);\r\n-\r\n-\t\t\t\tFile file = new File(path + \"/\" + sc.getFullQualifiedInstanceName() + \".xlsx\");\r\n-\t\t\t\ttry {\r\n+\t\t\t\t\texport(sei, iStream);\r\n+\t\t\t\t\tFile file = new File(path + \"/\" + sei.getFullQualifiedInstanceName() + \".xlsx\");\r\n \t\t\t\t\tFileOutputStream out = new FileOutputStream(file);\r\n \t\t\t\t\thelper.getWb().write(out);\r\n \t\t\t\t} catch (IOException e) {\r\n-\t\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation! \", e);\r\n+\t\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation! \\n\" + e.getMessage(), e);\r", "originalCommit": "338b0c067f7263e7c471977ec0896f19d8aea2f7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM3NjU2Mg==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/456#discussion_r375376562", "bodyText": "Let's use System.lineSeparator() here", "author": "andriikovalov-dlr", "createdAt": "2020-02-05T16:47:41Z", "path": "de.dlr.sc.virsat.model.extension.statemachines/src/de/dlr/sc/virsat/model/extension/statemachines/excel/exporter/StateMachineExporter.java", "diffHunk": "@@ -23,78 +23,66 @@\n import org.eclipse.jface.dialogs.ErrorDialog;\r\n import org.eclipse.swt.widgets.Display;\r\n \r\n-import de.dlr.sc.virsat.excel.AExcelIo;\r\n import de.dlr.sc.virsat.excel.exporter.ExcelExportHelper;\r\n import de.dlr.sc.virsat.excel.exporter.IExport;\r\n import de.dlr.sc.virsat.model.concept.list.IBeanList;\r\n import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n import de.dlr.sc.virsat.model.extension.statemachines.Activator;\r\n+import de.dlr.sc.virsat.model.extension.statemachines.excel.AExcelStatIO;\r\n import de.dlr.sc.virsat.model.extension.statemachines.model.State;\r\n import de.dlr.sc.virsat.model.extension.statemachines.model.StateMachine;\r\n import de.dlr.sc.virsat.model.extension.statemachines.model.Transition;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Class for exporting excel\r\n- * @author bell_er\r\n- *\r\n  */\r\n-public class StateMachineExporter extends ExcelExportHelper implements IExport {\r\n-\t\r\n-\tCategoryAssignment exportCa;\r\n-\t\r\n+public class StateMachineExporter implements IExport {\r\n+\tExcelExportHelper helper = new ExcelExportHelper();\r\n+\tprivate CategoryAssignment exportCa;\r\n+\r\n \t@Override\r\n \tpublic void export(EObject eObject, String path, boolean useDefaultTemplate, String templatePath) {\r\n-\t\tif (eObject instanceof CategoryAssignment) {\t\t\r\n+\t\tif (eObject instanceof CategoryAssignment) {\r\n \t\t\tCategoryAssignment ca = (CategoryAssignment) eObject;\r\n \t\t\tfinal String defaultTemplatePath = \"/resources/StateMachineExportTemplate.xlsx\";\r\n \t\t\t// find the export template\r\n \t\t\ttry {\r\n-\t\t\t\tInputStream is = null;\r\n+\t\t\t\tInputStream iStream = null;\r\n \t\t\t\tif (useDefaultTemplate) {\r\n-\t\t\t\t\tis = Activator.getResourceContentAsString(defaultTemplatePath);\r\n+\t\t\t\t\tiStream = Activator.getResourceContentAsString(defaultTemplatePath);\r\n \t\t\t\t} else {\r\n-\t\t\t\t\tis = new FileInputStream(templatePath);\r\n+\t\t\t\t\tiStream = new FileInputStream(templatePath);\r\n \t\t\t\t}\r\n-\t\t\t\twb = new XSSFWorkbook(is);\r\n-\t\t\t} catch (IOException e) {\r\n-\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to find the Template!\", e);\r\n-\t\t\t\tActivator.getDefault().getLog().log(status);\r\n-\t\t\t}\r\n-\t\t\t\r\n-\t\t\texportData(ca);\r\n-\t\t\tString newPath = path + \"/\" + ca.getFullQualifiedInstanceName() + \".xlsx\";\r\n-\t\t\t// and write the results\t\r\n-\t\t\tFile file = new File(newPath);\r\n-\t\t\ttry {\r\n+\t\t\t\thelper.setWb(new XSSFWorkbook(iStream));\r\n+\t\t\t\texportData(ca);\r\n+\t\t\t\tString newPath = path + \"/\" + ca.getFullQualifiedInstanceName() + \".xlsx\";\r\n+\t\t\t\t// and write the results\r\n+\t\t\t\tFile file = new File(newPath);\r\n+\t\t\t\t// find the export destination\r\n \t\t\t\tFileOutputStream out = new FileOutputStream(file);\r\n-\t\t\t\twb.write(out);\r\n+\t\t\t\thelper.getWb().write(out);\r\n \t\t\t} catch (IOException e) {\r\n-\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation!\", e);\r\n+\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation! \\n\" + e.getMessage(), e);\r", "originalCommit": "338b0c067f7263e7c471977ec0896f19d8aea2f7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "626359fd885792893daa624cc0625fbc3e76ffd9", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/626359fd885792893daa624cc0625fbc3e76ffd9", "message": "Did requested Changes - (Task #412)\n\n---\nTask #412: Improve interfaces of the export / import excel classes", "committedDate": "2020-02-06T06:40:03Z", "type": "commit"}, {"oid": "39b009e867dd43f12962494c578a82e91497f6e1", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/39b009e867dd43f12962494c578a82e91497f6e1", "message": "Merge remote-tracking branch 'origin/development' into feature/task_412-Improve_interfaces_of_excelIO", "committedDate": "2020-02-06T07:09:05Z", "type": "commit"}, {"oid": "74852dbb95ce668c506988ba9ecf75fe81156ed6", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/74852dbb95ce668c506988ba9ecf75fe81156ed6", "message": "Merge branch 'development' into feature/task_412-Improve_interfaces_of_excelIO", "committedDate": "2020-02-06T13:22:25Z", "type": "commit"}, {"oid": "d80f13c6d4fe62a9f6eea9cb935fd0b5221d9a3a", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/d80f13c6d4fe62a9f6eea9cb935fd0b5221d9a3a", "message": "Merge branch 'development' into feature/task_412-Improve_interfaces_of_excelIO", "committedDate": "2020-02-10T14:40:18Z", "type": "commit"}]}