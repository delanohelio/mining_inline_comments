{"pr_number": 768, "pr_title": "SWTBot Test for Exporting and Importing .mat files", "pr_createdAt": "2020-10-07T13:15:26Z", "pr_url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/768", "timeline": [{"oid": "f9bf6c44e420cf7dd7418b34680c11b3a89e583d", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/f9bf6c44e420cf7dd7418b34680c11b3a89e583d", "message": "Fixed bug with entering destination via keyboard - (Task #762)\n\n- Fixed bug in the generic import export page to support entering the\ndestination via keyboard\n\n---\nTask #762: SWTBot Test Case for exporting and importing to .mat files", "committedDate": "2020-10-07T12:42:52Z", "type": "commit"}, {"oid": "84d6ca185a9f50a9f0ffe30beb0c54e60cfd5c09", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/84d6ca185a9f50a9f0ffe30beb0c54e60cfd5c09", "message": "Added test case for exporting and importing to .mat file - (Task #762)\n\n- Implemented test case performing an export to a .mat file and then\nre-importing the .mat file\n\n---\nTask #762: SWTBot Test Case for exporting and importing to .mat files", "committedDate": "2020-10-07T12:43:35Z", "type": "commit"}, {"oid": "57cb232e392f7ee63b6ae66d643ac80b2ef69964", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/57cb232e392f7ee63b6ae66d643ac80b2ef69964", "message": "Refactored redundant code for closing wizards - (Task #762)\n\n- Refactored tests to share common code for finishing wizards in a\ndedicated method\n\n---\nTask #762: SWTBot Test Case for exporting and importing to .mat files", "committedDate": "2020-10-07T12:51:50Z", "type": "commit"}, {"oid": "a810eda7261f27eed7ec4fa3e5ee16084b5286d4", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/a810eda7261f27eed7ec4fa3e5ee16084b5286d4", "message": "Minor refactorings - (Task #762)\n\n- Introduced some constants to reduce repition of hard coded strings\n- Better use of SWTBot API for navigating trees\n\n---\nTask #762: SWTBot Test Case for exporting and importing to .mat files", "committedDate": "2020-10-07T13:06:49Z", "type": "commit"}, {"oid": "fa78cb24126fb9d10fc7299210e835c4e2335577", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/fa78cb24126fb9d10fc7299210e835c4e2335577", "message": "Further minor refactorings - (Task #762)\n\n- Extracted common code for opening wizards into dedicated method\n- Some whitespaces optimizations\n\n---\nTask #762: SWTBot Test Case for exporting and importing to .mat files", "committedDate": "2020-10-07T13:13:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTQ5Mjg2MQ==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/768#discussion_r501492861", "bodyText": "Should we maybe load all the concepts we need in test in the base class? There is already FEA there.", "author": "andriikovalov-dlr", "createdAt": "2020-10-08T07:07:25Z", "path": "de.dlr.sc.virsat.swtbot.test/src/de/dlr/sc/virsat/swtbot/test/ExporterImporterWizardTest.java", "diffHunk": "@@ -108,28 +98,51 @@ public void testHTMLExportFEA() {\n \t\tassertTrue(\"Index file has been successfully created.\", htmlExportIndexFile.exists());\n \t\tassertTrue(\"ConfigurationTree file has been successfully created.\", htmlExportCTFile.exists());\n \t\tassertTrue(\"ElementConfiguration file has been successfully created.\", htmlExportECFile.exists());\n+\t}\n+\t\n+\t@Test\n+\tpublic void testMatExportImport() {\n+\t\tConcept conceptMass = ConceptXmiLoader.loadConceptFromPlugin(de.dlr.sc.virsat.model.extension.budget.mass.Activator.getPluginId() + \"/concept/concept.xmi\");\t", "originalCommit": "fa78cb24126fb9d10fc7299210e835c4e2335577", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY3MTg0Mg==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/768#discussion_r501671842", "bodyText": "We only use the mass concept in like 1-2 places. I think I would prefer it locally loaded so we dont create additional load times in all the test cases.", "author": "SaMuellerDLR", "createdAt": "2020-10-08T12:14:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTQ5Mjg2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTc2MzU5MA==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/768#discussion_r501763590", "bodyText": "Can we maybe use the String from the Wizard definition? Looks like \"magic text\" here :D", "author": "franzTobiasDLR", "createdAt": "2020-10-08T14:24:59Z", "path": "de.dlr.sc.virsat.swtbot.test/src/de/dlr/sc/virsat/swtbot/test/ExporterImporterWizardTest.java", "diffHunk": "@@ -108,28 +98,51 @@ public void testHTMLExportFEA() {\n \t\tassertTrue(\"Index file has been successfully created.\", htmlExportIndexFile.exists());\n \t\tassertTrue(\"ConfigurationTree file has been successfully created.\", htmlExportCTFile.exists());\n \t\tassertTrue(\"ElementConfiguration file has been successfully created.\", htmlExportECFile.exists());\n+\t}\n+\t\n+\t@Test\n+\tpublic void testMatExportImport() {\n+\t\tConcept conceptMass = ConceptXmiLoader.loadConceptFromPlugin(de.dlr.sc.virsat.model.extension.budget.mass.Activator.getPluginId() + \"/concept/concept.xmi\");\t\n+\t\tSWTBotTreeItem massEquipment = addElement(MassEquipment.class, conceptMass, ec);\n+\t\topenEditor(massEquipment);\n \t\t\n-\t\t// Workaround to shells sometimes not being valid anymore after closing a wizard\n-\t\t// See https://wiki.eclipse.org/SWTBot/Troubleshooting#WidgetNotFoundException_when_stepping_through_SWTBot_test_in_Eclipse_debugger for details\n-\t\tbot.shell().activate();\n+\t\tfinal String OLD_VALUE = \"45.0\";\n+\t\tfinal String NEW_VALUE = \"30.0\";\n+\t\t\n+\t\trenameField(MassEquipment.PROPERTY_MASS, OLD_VALUE);\n+\t\t\n+\t\topenVirSatExporter(\"Mat Export Wizard\");\n+\t\t\n+\t\t// Configure the export\n+\t\tbot.tree().expandNode(EC_PATH).select();\n+\t\tPath matExportFilePath = exportFolderPath.resolve(\"export.mat\");\n+\t\tbot.comboBox().setText(matExportFilePath.toString());\n+\t\tfinishWizard();\n+\t\t\n+\t\t// Assert that we correctly exported a file\n+\t\tassertTrue(\"A file has been successfully created.\", matExportFilePath.toFile().exists());\n+\t\t\n+\t\t// Cause a change\n+\t\trenameField(MassEquipment.PROPERTY_MASS, NEW_VALUE);\n \n+\t\topenVirSatImporter(\"Mat Import Wizard\");", "originalCommit": "fa78cb24126fb9d10fc7299210e835c4e2335577", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTc5ODE5OQ==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/768#discussion_r501798199", "bodyText": "That would be cool, but sadly the string is in the plugin.xml of the ui.engine plugin.\nI tried using our ResourceBuilder hoping that it would maybe produce a PluginXML.java where the String is written into but apparantly that doesnt happen.", "author": "SaMuellerDLR", "createdAt": "2020-10-08T15:08:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTc2MzU5MA=="}], "type": "inlineReview"}]}