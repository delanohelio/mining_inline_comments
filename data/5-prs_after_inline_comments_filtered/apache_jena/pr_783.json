{"pr_number": 783, "pr_title": "JENA-1944: RDF Thrift tidy-up", "pr_createdAt": "2020-08-17T15:23:26Z", "pr_url": "https://github.com/apache/jena/pull/783", "timeline": [{"oid": "9864f5319fa6d690ea6ea284db6f57a10e4fea24", "url": "https://github.com/apache/jena/commit/9864f5319fa6d690ea6ea284db6f57a10e4fea24", "message": "JENA-1944: RDF Thrift tidy-up.", "committedDate": "2020-08-17T15:21:49Z", "type": "commit"}, {"oid": "a017d3fe5fb78ff355b1c4dfe2bce53f2e702d46", "url": "https://github.com/apache/jena/commit/a017d3fe5fb78ff355b1c4dfe2bce53f2e702d46", "message": "Minor tidying.", "committedDate": "2020-08-17T15:21:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc1MDY2Nw==", "url": "https://github.com/apache/jena/pull/783#discussion_r471750667", "bodyText": "Should it go to a Logger instead? Or is it expected to be written to stderr?", "author": "kinow", "createdAt": "2020-08-17T20:15:32Z", "path": "jena-arq/src/main/java/org/apache/jena/riot/RDFParserRegistry.java", "diffHunk": "@@ -206,14 +206,24 @@ public ReaderRIOT create(Lang language, ParserProfile profile) {\n     private static class ReaderRIOTFactoryThrift implements ReaderRIOTFactory {\n         @Override\n         public ReaderRIOT create(Lang language, ParserProfile profile) {\n-            return new ReaderRDFThrift() ;\n+            return new ReaderRDFThrift(profile) ;\n         }\n     }\n \n     private static class ReaderRDFThrift implements ReaderRIOT {\n+        private final ParserProfile profile; \n+        public ReaderRDFThrift(ParserProfile profile) { this.profile = profile; }\n+\n         @Override\n         public void read(InputStream in, String baseURI, ContentType ct, StreamRDF output, Context context) {\n-            BinRDF.inputStreamToStream(in, output) ;\n+            try {\n+                BinRDF.inputStreamToStream(in, output);\n+            } catch (RiotException ex) {\n+                if ( profile != null && profile.getErrorHandler() != null )\n+                    profile.getErrorHandler().error(ex.getMessage(), -1, -1);\n+                else\n+                    System.err.println(ex.getMessage());", "originalCommit": "a017d3fe5fb78ff355b1c4dfe2bce53f2e702d46", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc3MTI3NA==", "url": "https://github.com/apache/jena/pull/783#discussion_r471771274", "bodyText": "Thanks for seeing that. Logger in some way would be better\nRDFThrift is a bit different because the parser does not signal errors or warnings like the other text-syntax parsers. Such raw binary is supposed to be \"right\" and errors are actually low level encoding problems that Thrift will catch and complain about. But each case must throw an exception regardless of the errorhandler.", "author": "afs", "createdAt": "2020-08-17T20:58:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc1MDY2Nw=="}], "type": "inlineReview"}, {"oid": "50bd51f44342973832dd7dcf8a52fd18952089fe", "url": "https://github.com/apache/jena/commit/50bd51f44342973832dd7dcf8a52fd18952089fe", "message": "JENA-1944: Log Thrift errors, always throw exception.", "committedDate": "2020-08-17T21:06:45Z", "type": "commit"}]}