{"pr_number": 885, "pr_title": "Several tickets: JENA-2011 : JENA-2013 :  JENA-2014", "pr_createdAt": "2020-12-11T16:11:14Z", "pr_url": "https://github.com/apache/jena/pull/885", "timeline": [{"oid": "1495ad88eb4fa6ab52f7e866d148cc6999a701e0", "url": "https://github.com/apache/jena/commit/1495ad88eb4fa6ab52f7e866d148cc6999a701e0", "message": "Remove inactive code", "committedDate": "2020-12-11T11:09:13Z", "type": "commit"}, {"oid": "04bae43e5f77778a218639c5d0eb0e6b6740567a", "url": "https://github.com/apache/jena/commit/04bae43e5f77778a218639c5d0eb0e6b6740567a", "message": "JENA-2014: Fix for comparing fractional seconds", "committedDate": "2020-12-11T15:26:14Z", "type": "commit"}, {"oid": "1967e174200af7a355d6ccd3c01a46f9e26f894c", "url": "https://github.com/apache/jena/commit/1967e174200af7a355d6ccd3c01a46f9e26f894c", "message": "JENA-2013: Treat xsd:dateTimeStamp as a derived type of xsd:dateTime", "committedDate": "2020-12-11T15:26:57Z", "type": "commit"}, {"oid": "a254043a14fe916edcfff7c15025f297d986a03f", "url": "https://github.com/apache/jena/commit/a254043a14fe916edcfff7c15025f297d986a03f", "message": "JENA-2011: Handle IPv6 localhost address for Jetty", "committedDate": "2020-12-11T16:33:10Z", "type": "commit"}, {"oid": "a254043a14fe916edcfff7c15025f297d986a03f", "url": "https://github.com/apache/jena/commit/a254043a14fe916edcfff7c15025f297d986a03f", "message": "JENA-2011: Handle IPv6 localhost address for Jetty", "committedDate": "2020-12-11T16:33:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTIyMDUzMQ==", "url": "https://github.com/apache/jena/pull/885#discussion_r541220531", "bodyText": "Extra spaces?", "author": "kinow", "createdAt": "2020-12-11T19:53:50Z", "path": "jena-core/src/main/java/org/apache/jena/ext/xerces/jaxp/datatype/DurationImpl.java", "diffHunk": "@@ -832,42 +832,45 @@ public int compare(Duration rhs) {\n \t\t\t\t\t);\n     \t}\n \n-    \t// turn this Duration into a GregorianCalendar\n-    \tGregorianCalendar lhsCalendar = new GregorianCalendar(\n-    \t\t\t1970,\n-\t\t\t\t1,\n-\t\t\t\t1,\n-\t\t\t\t0,\n-\t\t\t\t0,\n-\t\t\t\t0);\n-   \t\tlhsCalendar.add(GregorianCalendar.YEAR, getYears() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.MONTH, getMonths() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.DAY_OF_YEAR, getDays() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.HOUR_OF_DAY, getHours() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.MINUTE, getMinutes() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.SECOND, getSeconds() * getSign());\n-   \t\t\n-   \t\t// turn compare Duration into a GregorianCalendar\n-    \tGregorianCalendar rhsCalendar = new GregorianCalendar(\n-\t\t\t\t1970,\n-\t\t\t\t1,\n-\t\t\t\t1,\n-\t\t\t\t0,\n-\t\t\t\t0,\n-\t\t\t\t0);\n-   \t\trhsCalendar.add(GregorianCalendar.YEAR, rhs.getYears() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.MONTH, rhs.getMonths() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.DAY_OF_YEAR, rhs.getDays() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.HOUR_OF_DAY, rhs.getHours() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.MINUTE, rhs.getMinutes() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.SECOND, rhs.getSeconds() * rhs.getSign());\n-   \t\n-   \t\t\n-   \t\tif (lhsCalendar.equals(rhsCalendar)) {\n-   \t\t\treturn DatatypeConstants.EQUAL;\n-   \t\t}\n-\n-   \t\treturn compareDates(this, rhs);\n+    \tif ( rhsSecondsAsBigDecimal == null || seconds == null ) {\n+    \t    // Jena: change: this only works for durations with no fractional seconds.\n+    \t    // Fix is to only use if no seconds in LHS or RHS.\n+    \t    \n+    \t    // turn this Duration into a GregorianCalendar\n+    \t    GregorianCalendar lhsCalendar = new GregorianCalendar(\n+    \t        1970,\n+    \t        1,\n+    \t        1,\n+    \t        0,\n+    \t        0,\n+    \t        0);\n+    \t    lhsCalendar.add(GregorianCalendar.YEAR, getYears() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.MONTH, getMonths() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.DAY_OF_YEAR, getDays() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.HOUR_OF_DAY, getHours() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.MINUTE, getMinutes() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.SECOND, getSeconds() * getSign());\n+\n+    \t    // turn compare Duration into a GregorianCalendar\n+    \t    GregorianCalendar rhsCalendar = new GregorianCalendar(\n+    \t        1970,\n+    \t        1,\n+    \t        1,\n+    \t        0,\n+    \t        0,\n+    \t        0);\n+    \t    rhsCalendar.add(GregorianCalendar.YEAR, rhs.getYears() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.MONTH, rhs.getMonths() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.DAY_OF_YEAR, rhs.getDays() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.HOUR_OF_DAY, rhs.getHours() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.MINUTE, rhs.getMinutes() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.SECOND, rhs.getSeconds() * rhs.getSign());\n+\n+    \t    if (lhsCalendar.equals(rhsCalendar)) {\n+    \t        return DatatypeConstants.EQUAL;\n+    \t    }\n+    \t}\n+   \t\treturn compareDuration(this, rhs);", "originalCommit": "a254043a14fe916edcfff7c15025f297d986a03f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTU1NTA4OA==", "url": "https://github.com/apache/jena/pull/885#discussion_r541555088", "bodyText": "Worse than that - tabs!\nTurns out this file (taken from Xerces) is a mix of tabs and spaces.\nI'll reset to all spaces. Some methods (we have never touched) are tabs, some spaces.", "author": "afs", "createdAt": "2020-12-12T11:06:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTIyMDUzMQ=="}], "type": "inlineReview"}, {"oid": "ef67c34070169336544e37503decca6d59cff165", "url": "https://github.com/apache/jena/commit/ef67c34070169336544e37503decca6d59cff165", "message": "Fix up tabs/spaces", "committedDate": "2020-12-12T11:04:20Z", "type": "commit"}]}