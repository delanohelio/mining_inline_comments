{"pr_number": 3200, "pr_title": "all: grpc_service_config timeout settings", "pr_createdAt": "2020-05-19T21:08:36Z", "pr_url": "https://github.com/googleapis/gapic-generator/pull/3200", "timeline": [{"oid": "c8ea25177ee4ed8aa349d32f5eb4efef212c71da", "url": "https://github.com/googleapis/gapic-generator/commit/c8ea25177ee4ed8aa349d32f5eb4efef212c71da", "message": "restore messaging.proto", "committedDate": "2020-05-20T14:54:45Z", "type": "forcePushed"}, {"oid": "89ff070031a0cc0598ee4ed2d0464a30dcd6e287", "url": "https://github.com/googleapis/gapic-generator/commit/89ff070031a0cc0598ee4ed2d0464a30dcd6e287", "message": "restore messaging.proto", "committedDate": "2020-05-20T21:16:38Z", "type": "forcePushed"}, {"oid": "993cbf305a664678ea9f6ba0c132c8ec2a145404", "url": "https://github.com/googleapis/gapic-generator/commit/993cbf305a664678ea9f6ba0c132c8ec2a145404", "message": "all: set max & initial timeouts to total timeout\n\nWhen using grpc_service_config the max & initial rpc timeout\nshould be the same as the total timeout. This essentially\nrenders the hedging logic unused because the initial timeout\nis the limit. This means one RPC is made rather than several\nsmaller ones that are backed off until the total is reached.\n\n* switch showcase to gapic v2 & grpc_service_config\n* retry mapping: fix NPE when a Service is not present in protos\n* add blockTimeout showcase test\n* add valid block showcase test\n* update gapic-showcase image for java to v0.10.1\n* lengthen delay on flaky showcase java streaming tests", "committedDate": "2020-05-21T00:24:34Z", "type": "commit"}, {"oid": "993cbf305a664678ea9f6ba0c132c8ec2a145404", "url": "https://github.com/googleapis/gapic-generator/commit/993cbf305a664678ea9f6ba0c132c8ec2a145404", "message": "all: set max & initial timeouts to total timeout\n\nWhen using grpc_service_config the max & initial rpc timeout\nshould be the same as the total timeout. This essentially\nrenders the hedging logic unused because the initial timeout\nis the limit. This means one RPC is made rather than several\nsmaller ones that are backed off until the total is reached.\n\n* switch showcase to gapic v2 & grpc_service_config\n* retry mapping: fix NPE when a Service is not present in protos\n* add blockTimeout showcase test\n* add valid block showcase test\n* update gapic-showcase image for java to v0.10.1\n* lengthen delay on flaky showcase java streaming tests", "committedDate": "2020-05-21T00:24:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MTk3MQ==", "url": "https://github.com/googleapis/gapic-generator/pull/3200#discussion_r428471971", "bodyText": "Is it necessary to set them both to 0? My naive understanding of this suggests that if timeout is 0 it does not matter what the multiplier is, because it will be multiplied by 0, so the total result will always be 0 anyways (well, unless the multiplier is infinity, but it is not practically possible).", "author": "vam-google", "createdAt": "2020-05-21T06:35:44Z", "path": "src/main/java/com/google/api/codegen/config/GrpcGapicRetryMapping.java", "diffHunk": "@@ -151,11 +155,17 @@ private static void applyRetryPolicyToName(\n \n   private static RetryParamsDefinitionProto.Builder retryPolicyToParamsBuilder(\n       RetryPolicy retryPolicy, long timeout, String policyName) {\n+    // If the timeout is 0, make the timeout multiplier 0 as well, otherwise", "originalCommit": "993cbf305a664678ea9f6ba0c132c8ec2a145404", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDU1MTkwOA==", "url": "https://github.com/googleapis/gapic-generator/pull/3200#discussion_r430551908", "bodyText": "It was more of an aesthetic thing - if the timeout was 0, make the multiplier 0 too. I will revert this and have it just default to 1 regardless.", "author": "noahdietz", "createdAt": "2020-05-26T16:37:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MTk3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDU1OTc3OQ==", "url": "https://github.com/googleapis/gapic-generator/pull/3200#discussion_r430559779", "bodyText": "Done.", "author": "noahdietz", "createdAt": "2020-05-26T16:46:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MTk3MQ=="}], "type": "inlineReview"}, {"oid": "c009ceb3f5a9d6c0648b4ddc559d81c6547fb3cf", "url": "https://github.com/googleapis/gapic-generator/commit/c009ceb3f5a9d6c0648b4ddc559d81c6547fb3cf", "message": "always set timeout multiplier to 1", "committedDate": "2020-05-26T16:46:43Z", "type": "commit"}]}