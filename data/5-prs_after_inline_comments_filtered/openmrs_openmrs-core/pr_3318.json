{"pr_number": 3318, "pr_title": "TRUNK-5807, Exception thrown in console on saving Patient in PostgreSQL", "pr_createdAt": "2020-07-09T12:57:29Z", "pr_url": "https://github.com/openmrs/openmrs-core/pull/3318", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTMwNg==", "url": "https://github.com/openmrs/openmrs-core/pull/3318#discussion_r458381306", "bodyText": "Why use a hack?", "author": "dkayiwa", "createdAt": "2020-07-21T20:54:00Z", "path": "api/src/main/java/org/openmrs/api/db/hibernate/HibernateEncounterDAO.java", "diffHunk": "@@ -588,12 +590,26 @@ public Integer getEncountersByVisitsAndPatientCount(Patient patient, boolean inc\n \t\tCriteria criteria = sessionFactory.getCurrentSession().createCriteria(Visit.class);\n \t\taddEmptyVisitsByPatientCriteria(criteria, patient, includeVoided, query);\n \t\t\n+\t\t//A hack to remove the order_by clauses as they cause error in PostgreSQL\n+\t\tIterator<CriteriaImpl.OrderEntry> orderIter = ((CriteriaImpl) criteria).iterateOrderings();", "originalCommit": "383a6f26354a518fdece3dddc3c62560e8162bb6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODczNDAzMg==", "url": "https://github.com/openmrs/openmrs-core/pull/3318#discussion_r458734032", "bodyText": "There is no direct way to remove the order clause from criteria once it gets added( docs ).  I found this solution here.", "author": "Am-Coder", "createdAt": "2020-07-22T11:49:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTMwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDU4MTI3Mw==", "url": "https://github.com/openmrs/openmrs-core/pull/3318#discussion_r474581273", "bodyText": "@dkayiwa , your view on this ? Apparently, This is not an issue on Reference Application but comes up when visiting Patient Dashboard on LegacyUI.", "author": "Am-Coder", "createdAt": "2020-08-21T09:35:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTMwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2NTA0OQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3318#discussion_r474665049", "bodyText": "@Am-Coder I think the question is: why not just remove the order by stuff from the place where its being added instead of adding this hack? The order by stuff can then be added in where it's actually needed, e.g., getEncountersByVisitsAndPatient()", "author": "ibacher", "createdAt": "2020-08-21T12:28:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTMwNg=="}], "type": "inlineReview"}, {"oid": "10049323ef3ab59e49eebf1c05973d562381febe", "url": "https://github.com/openmrs/openmrs-core/commit/10049323ef3ab59e49eebf1c05973d562381febe", "message": "TRUNK-5807, Exception thrown in console on saving Patient in PostgreSQL", "committedDate": "2020-08-22T14:47:14Z", "type": "commit"}, {"oid": "4bb6f82d58227d8dda97f432f4bebc7f1a610df2", "url": "https://github.com/openmrs/openmrs-core/commit/4bb6f82d58227d8dda97f432f4bebc7f1a610df2", "message": "Revert \"TRUNK-5807, Exception thrown in console on saving Patient in PostgreSQL\"\n\nThis reverts commit 10049323ef3ab59e49eebf1c05973d562381febe.", "committedDate": "2020-08-22T14:50:20Z", "type": "commit"}, {"oid": "e4cce25a3579414e528d1ad3a28702fb52f729c3", "url": "https://github.com/openmrs/openmrs-core/commit/e4cce25a3579414e528d1ad3a28702fb52f729c3", "message": "TRUNK-5807, Exception thrown in console on saving Patient in PostgreSQL", "committedDate": "2020-08-22T15:03:26Z", "type": "commit"}]}