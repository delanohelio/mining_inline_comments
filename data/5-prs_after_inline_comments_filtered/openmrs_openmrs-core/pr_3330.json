{"pr_number": 3330, "pr_title": "TRUNK-5816: Migrate unit tests to Junit5", "pr_createdAt": "2020-07-12T00:54:35Z", "pr_url": "https://github.com/openmrs/openmrs-core/pull/3330", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI1MTQ4OA==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453251488", "bodyText": "the ide cancel  the static import .", "author": "achilep", "createdAt": "2020-07-12T00:56:36Z", "path": "api/src/test/java/org/openmrs/ObsTest.java", "diffHunk": "@@ -13,14 +13,7 @@\n import static org.hamcrest.core.Is.is;\n import static org.hamcrest.core.IsNot.not;\n import static org.hamcrest.core.IsNull.nullValue;\n-import static org.junit.Assert.assertEquals;\n-import static org.junit.Assert.assertFalse;\n-import static org.junit.Assert.assertNotEquals;\n-import static org.junit.Assert.assertNotNull;\n-import static org.junit.Assert.assertNull;\n-import static org.junit.Assert.assertThrows;\n-import static org.junit.Assert.assertTrue;", "originalCommit": "c216c441c0b09064ac041e7a0b9c81854abf4fed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI1MTU1Nw==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453251557", "bodyText": "it does not convert assertThrows automatically .", "author": "achilep", "createdAt": "2020-07-12T00:57:55Z", "path": "api/src/test/java/org/openmrs/ObsTest.java", "diffHunk": "@@ -13,14 +13,7 @@\n import static org.hamcrest.core.Is.is;\n import static org.hamcrest.core.IsNot.not;\n import static org.hamcrest.core.IsNull.nullValue;\n-import static org.junit.Assert.assertEquals;\n-import static org.junit.Assert.assertFalse;\n-import static org.junit.Assert.assertNotEquals;\n-import static org.junit.Assert.assertNotNull;\n-import static org.junit.Assert.assertNull;\n-import static org.junit.Assert.assertThrows;\n-import static org.junit.Assert.assertTrue;\n-import static org.junit.Assert.fail;\n+import static org.junit.jupiter.api.Assertions.assertThrows;", "originalCommit": "c216c441c0b09064ac041e7a0b9c81854abf4fed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI1MzI2Mg==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453253262", "bodyText": "i am suspecting the new live templates.", "author": "achilep", "createdAt": "2020-07-12T01:22:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI1MTU1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI2NzE3Nw==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453267177", "bodyText": "did you even use the live template in here?\nor do you mean the intellij junit 4 to 5 migration tool?\nWhat can help a bit is to exclude a few packages from import suggestions by IntelliJ. So when you let IntelliJ import a method for you it will automatically choose the one from the jupiter package\nYou need to exclude these\n\ngroovy.util.GroovyTestCase.*\njunit.framework.*\norg.junit.Assert.*\nsee\n\n\nand dont forget to set the * imports to a high number like 999\n\nwhen I now migrate using IntelliJ. I can then do a search & replace of Assertions. with ``. This of course leads to compile errors which I can then fix with letting IntelliJ fix the imports (one by one; not sure if there is a fix all). WIth the excluded packages setting at the top it chooses the correct static imports :)\nI can use <F2> to jump to the compile errors and then for me on a mac its alt+enter to autofix the missing import. So that is quite quick", "author": "teleivo", "createdAt": "2020-07-12T04:51:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI1MTU1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI2NTg2Ng==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453265866", "bodyText": "can you please use static imports for the assertions", "author": "teleivo", "createdAt": "2020-07-12T04:32:16Z", "path": "api/src/test/java/org/openmrs/LocationTest.java", "diffHunk": "@@ -36,8 +36,8 @@ public void isInHierarchy_shouldShouldFindLocationInHierarchy() {\n \t\tlocationGrandParent.addChildLocation(locationParent);\n \t\tlocationParent.addChildLocation(locationChild);\n \t\t\n-\t\tassertTrue(Location.isInHierarchy(locationChild, locationParent));\n-\t\tassertTrue(Location.isInHierarchy(locationChild, locationGrandParent));\n+\t\tAssertions.assertTrue(Location.isInHierarchy(locationChild, locationParent));", "originalCommit": "c216c441c0b09064ac041e7a0b9c81854abf4fed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI3NjgzNQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453276835", "bodyText": "Please try my settings using the Migrate to Junit 5 on the single class here. That for me gives a nice diff with static imports.", "author": "teleivo", "createdAt": "2020-07-12T06:53:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI2NTg2Ng=="}], "type": "inlineReview"}, {"oid": "87f24fe4faa5be5966d3d686b8f5d25d9f642eec", "url": "https://github.com/openmrs/openmrs-core/commit/87f24fe4faa5be5966d3d686b8f5d25d9f642eec", "message": "TRUNK-5816: Migrate unit tests to Junit5", "committedDate": "2020-07-12T14:34:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyNjQ1NQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453326455", "bodyText": "not sure why but the arguments should not be swapped here. the signature is https://junit.org/junit5/docs/5.0.1/api/org/junit/jupiter/api/Assertions.html#assertEquals-double-double-\nexpected, then actual. in this case we expect the size to be 1\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tassertEquals(obsGroup.getGroupMembers().size(), 1, \"Duplicate add should not increase the grouped obs size\");\n          \n          \n            \n            \t\tassertEquals(1, obsGroup.getGroupMembers().size(), \"Duplicate add should not increase the grouped obs size\");\n          \n      \n    \n    \n  \n\nthese things matter in case of error. otherwise we get a confusing message", "author": "teleivo", "createdAt": "2020-07-12T14:55:03Z", "path": "api/src/test/java/org/openmrs/ObsTest.java", "diffHunk": "@@ -165,14 +164,13 @@ public void shouldAddandRemoveObsToGroup() throws Exception {\n \t\t// check duplicate add. should only be one\n \t\tobsGroup.addGroupMember(obs);\n \t\tassertTrue(obsGroup.hasGroupMembers(false));\n-\t\tassertEquals(\"Duplicate add should not increase the grouped obs size\", 1, obsGroup.getGroupMembers().size());\n+\t\tassertEquals(obsGroup.getGroupMembers().size(), 1, \"Duplicate add should not increase the grouped obs size\");", "originalCommit": "87f24fe4faa5be5966d3d686b8f5d25d9f642eec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyNjUzNQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453326535", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tassertEquals(obsGroup.getGroupMembers().size(), 1, \"Removing a non existent obs should not decrease the number of grouped obs\");\n          \n          \n            \n            \t\tassertEquals(1, obsGroup.getGroupMembers().size(), \"Removing a non existent obs should not decrease the number of grouped obs\");", "author": "teleivo", "createdAt": "2020-07-12T14:55:37Z", "path": "api/src/test/java/org/openmrs/ObsTest.java", "diffHunk": "@@ -165,14 +164,13 @@ public void shouldAddandRemoveObsToGroup() throws Exception {\n \t\t// check duplicate add. should only be one\n \t\tobsGroup.addGroupMember(obs);\n \t\tassertTrue(obsGroup.hasGroupMembers(false));\n-\t\tassertEquals(\"Duplicate add should not increase the grouped obs size\", 1, obsGroup.getGroupMembers().size());\n+\t\tassertEquals(obsGroup.getGroupMembers().size(), 1, \"Duplicate add should not increase the grouped obs size\");\n \t\t\n \t\tObs obs2 = new Obs(2);\n \t\t\n \t\tobsGroup.removeGroupMember(obs2);\n \t\tassertTrue(obsGroup.hasGroupMembers(false));\n-\t\tassertEquals(\"Removing a non existent obs should not decrease the number of grouped obs\", 1, obsGroup\n-\t\t        .getGroupMembers().size());\n+\t\tassertEquals(obsGroup.getGroupMembers().size(), 1, \"Removing a non existent obs should not decrease the number of grouped obs\");", "originalCommit": "87f24fe4faa5be5966d3d686b8f5d25d9f642eec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyNjYxNg==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453326616", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tassertEquals(members.size(), 3, \"set of all members should have length of 3\");\n          \n          \n            \n            \t\tassertEquals(3, members.size(), \"set of all members should have length of 3\");", "author": "teleivo", "createdAt": "2020-07-12T14:56:15Z", "path": "api/src/test/java/org/openmrs/ObsTest.java", "diffHunk": "@@ -415,11 +413,11 @@ public void getGroupMembers_shouldGetAllGroupMembersIfPassedTrueAndNonvoidedIfPa\n \t\tmembers.add(voided);\n \t\tparent.setGroupMembers(members);\n \t\tmembers = parent.getGroupMembers(true);\n-\t\tassertEquals(\"set of all members should have length of 3\", 3, members.size());\n+\t\tassertEquals(members.size(), 3, \"set of all members should have length of 3\");", "originalCommit": "87f24fe4faa5be5966d3d686b8f5d25d9f642eec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyNjY0MQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453326641", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tassertEquals(members.size(), 2, \"set of non-voided should have length of 2\");\n          \n          \n            \n            \t\tassertEquals(2, members.size(), \"set of non-voided should have length of 2\");", "author": "teleivo", "createdAt": "2020-07-12T14:56:28Z", "path": "api/src/test/java/org/openmrs/ObsTest.java", "diffHunk": "@@ -415,11 +413,11 @@ public void getGroupMembers_shouldGetAllGroupMembersIfPassedTrueAndNonvoidedIfPa\n \t\tmembers.add(voided);\n \t\tparent.setGroupMembers(members);\n \t\tmembers = parent.getGroupMembers(true);\n-\t\tassertEquals(\"set of all members should have length of 3\", 3, members.size());\n+\t\tassertEquals(members.size(), 3, \"set of all members should have length of 3\");\n \t\tmembers = parent.getGroupMembers(false);\n-\t\tassertEquals(\"set of non-voided should have length of 2\", 2, members.size());\n+\t\tassertEquals(members.size(), 2, \"set of non-voided should have length of 2\");", "originalCommit": "87f24fe4faa5be5966d3d686b8f5d25d9f642eec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyNjY3NQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3330#discussion_r453326675", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tassertEquals(members.size(), 2, \"default should return non-voided with length of 2\");\n          \n          \n            \n            \t\tassertEquals(2, members.size(), \"default should return non-voided with length of 2\");", "author": "teleivo", "createdAt": "2020-07-12T14:56:48Z", "path": "api/src/test/java/org/openmrs/ObsTest.java", "diffHunk": "@@ -415,11 +413,11 @@ public void getGroupMembers_shouldGetAllGroupMembersIfPassedTrueAndNonvoidedIfPa\n \t\tmembers.add(voided);\n \t\tparent.setGroupMembers(members);\n \t\tmembers = parent.getGroupMembers(true);\n-\t\tassertEquals(\"set of all members should have length of 3\", 3, members.size());\n+\t\tassertEquals(members.size(), 3, \"set of all members should have length of 3\");\n \t\tmembers = parent.getGroupMembers(false);\n-\t\tassertEquals(\"set of non-voided should have length of 2\", 2, members.size());\n+\t\tassertEquals(members.size(), 2, \"set of non-voided should have length of 2\");\n \t\tmembers = parent.getGroupMembers(); // should be same as false\n-\t\tassertEquals(\"default should return non-voided with length of 2\", 2, members.size());\n+\t\tassertEquals(members.size(), 2, \"default should return non-voided with length of 2\");", "originalCommit": "87f24fe4faa5be5966d3d686b8f5d25d9f642eec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e8f2e88f024cf37d2f1783c353c4142518ba24a6", "url": "https://github.com/openmrs/openmrs-core/commit/e8f2e88f024cf37d2f1783c353c4142518ba24a6", "message": "TRUNK-5816: Migrate unit tests to Junit5", "committedDate": "2020-07-12T15:37:25Z", "type": "commit"}, {"oid": "e8f2e88f024cf37d2f1783c353c4142518ba24a6", "url": "https://github.com/openmrs/openmrs-core/commit/e8f2e88f024cf37d2f1783c353c4142518ba24a6", "message": "TRUNK-5816: Migrate unit tests to Junit5", "committedDate": "2020-07-12T15:37:25Z", "type": "forcePushed"}]}