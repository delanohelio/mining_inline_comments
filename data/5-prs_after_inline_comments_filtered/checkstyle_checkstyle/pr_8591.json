{"pr_number": 8591, "pr_title": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "pr_createdAt": "2020-08-02T04:03:22Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8591", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU5NTY0OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r467595649", "bodyText": "something like:\n    private boolean search(DetailAST root, String xpath, Stack<DetailAST> nodes) {\n       boolean result = false;\n        if(xpath.equals(XpathQueryGenerator.generateXpathQuery(root))) {\n                nodes.push(root);\n                result = false;\n        } else {\n        if(root.hasChildren()) {\n            DetailAST child = root.getFirstChild();    \n            while(child!=null)\n            {\n                if(search(child, xpath, nodes)) {\n                    nodes.push(root);\n                    result = true;\n                    break;\n                }\n                child = child.getNextSibling();\n            }\n        }\n\n        }\n\n        return result;\n    }", "author": "romani", "createdAt": "2020-08-09T15:16:07Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java", "diffHunk": "@@ -190,6 +191,63 @@ private void setColumnsInitialWidth() {\n         getColumn(\"Type\").setPreferredWidth(preferredTypeColumnWidth);\n     }\n \n+    /**\n+     * Search node by Xpath.\n+     * \n+     * @param root {@code DetailAST} root ast element\n+     * @param xpath {@code String} xpath query\n+     * @param nodes {@code Stack<DetailAST>} stack of nodes in selection path\n+     * @return {@code boolean} node found or not\n+     */\n+    private boolean search(DetailAST root, String xpath, Stack<DetailAST> nodes) {\n+        if(xpath.equals(XpathQueryGenerator.generateXpathQuery(root))) {\n+                nodes.push(root);\n+                return true;\n+        }\n+        \n+        if(root.hasChildren()) {\n+            DetailAST child = root.getFirstChild();    \n+            while(child!=null)\n+            {\n+                if(search(child, xpath, nodes)) {\n+                    nodes.push(root);\n+                    return true;\n+                }\n+                child = child.getNextSibling();\n+            }\n+        }\n+        return false;\n+    }", "originalCommit": "25d59aeab775a52b955bfcc2e7b714b67b87b7cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY4ODE3Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r467688173", "bodyText": "Done", "author": "developerhb", "createdAt": "2020-08-10T04:58:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU5NTY0OQ=="}], "type": "inlineReview"}, {"oid": "c89fa97ce40425c55c87e1ca9dbfab7b21afa97b", "url": "https://github.com/checkstyle/checkstyle/commit/c89fa97ce40425c55c87e1ca9dbfab7b21afa97b", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-08-10T03:56:12Z", "type": "forcePushed"}, {"oid": "99a86e816e60c8090c0754f4a80c218c77a10430", "url": "https://github.com/checkstyle/checkstyle/commit/99a86e816e60c8090c0754f4a80c218c77a10430", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-08-10T04:47:53Z", "type": "forcePushed"}, {"oid": "d46b3f8f07b61f54d92684cbbc0508d9b65c9ae4", "url": "https://github.com/checkstyle/checkstyle/commit/d46b3f8f07b61f54d92684cbbc0508d9b65c9ae4", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-08-10T04:54:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM0ODQ2Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r468348466", "bodyText": "\\n^ wrong xpath query", "author": "romani", "createdAt": "2020-08-11T06:12:56Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java", "diffHunk": "@@ -190,6 +192,64 @@ private void setColumnsInitialWidth() {\n         getColumn(\"Type\").setPreferredWidth(preferredTypeColumnWidth);\n     }\n \n+    /**\n+     * Search node by Xpath.\n+     *\n+     * @param root {@code DetailAST} root ast element\n+     * @param xpath {@code String} xpath query\n+     * @param nodes {@code Deque<DetailAST>} stack of nodes in selection path\n+     * @return {@code boolean} node found or not\n+     */\n+    private static boolean search(DetailAST root, String xpath, Deque<DetailAST> nodes) {\n+        boolean result = false;\n+        if (xpath.equals(XpathQueryGenerator.generateXpathQuery(root))) {\n+            nodes.push(root);\n+            result = true;\n+        }\n+        else {\n+            if (root.hasChildren()) {\n+                DetailAST child = root.getFirstChild();\n+                while (child != null) {\n+                    if (search(child, xpath, nodes)) {\n+                        nodes.push(root);\n+                        result = true;\n+                        break;\n+                    }\n+                    child = child.getNextSibling();\n+                }\n+            }\n+        }\n+        return result;\n+    }\n+\n+    /**\n+     * Select Node by Xpath.\n+     */\n+    public void selectNodeByXpath() {\n+        final DetailAST rootAST = (DetailAST) tree.getModel().getRoot();\n+        if (rootAST.hasChildren()) {\n+            final String xpath = \"/EOF\" + xpathEditor.getText();\n+            final Deque<DetailAST> nodes = new ArrayDeque<>();\n+            if (search(rootAST, xpath, nodes)) {\n+                TreePath path = new TreePath(nodes.pop());\n+                while (!nodes.isEmpty()) {\n+                    path = path.pathByAddingChild(nodes.pop());\n+                    if (!tree.isExpanded(path)) {\n+                        tree.expandPath(path);\n+                    }\n+                    tree.setSelectionPath(path);\n+                    makeCodeSelection();\n+                }\n+            }\n+            else {\n+                xpathEditor.setText(xpathEditor.getText() + \"- wrong xpath query\");", "originalCommit": "c4ddc5f8aaf7a5b6334979cc4f98fa748a8f011f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ0NzEyNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r468447126", "bodyText": "@romani done", "author": "developerhb", "createdAt": "2020-08-11T09:26:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM0ODQ2Ng=="}], "type": "inlineReview"}, {"oid": "db26401b58ed18f7082eee435a8fceb14c690766", "url": "https://github.com/checkstyle/checkstyle/commit/db26401b58ed18f7082eee435a8fceb14c690766", "message": "minor: remove unused allowed import from import-config.xml", "committedDate": "2020-08-11T09:20:13Z", "type": "commit"}, {"oid": "2c1db5c368a3a95a36f5a0f7166b00d672b813ad", "url": "https://github.com/checkstyle/checkstyle/commit/2c1db5c368a3a95a36f5a0f7166b00d672b813ad", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-08-11T09:25:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAyMjUzMg==", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r469022532", "bodyText": "This if is redundant. When the root has no children, root.getFirstChild() will return null and the entire loop will be skipped.", "author": "pbludov", "createdAt": "2020-08-12T06:00:05Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java", "diffHunk": "@@ -190,6 +192,64 @@ private void setColumnsInitialWidth() {\n         getColumn(\"Type\").setPreferredWidth(preferredTypeColumnWidth);\n     }\n \n+    /**\n+     * Search node by Xpath.\n+     *\n+     * @param root {@code DetailAST} root ast element\n+     * @param xpath {@code String} xpath query\n+     * @param nodes {@code Deque<DetailAST>} stack of nodes in selection path\n+     * @return {@code boolean} node found or not\n+     */\n+    private static boolean search(DetailAST root, String xpath, Deque<DetailAST> nodes) {\n+        boolean result = false;\n+        if (xpath.equals(XpathQueryGenerator.generateXpathQuery(root))) {\n+            nodes.push(root);\n+            result = true;\n+        }\n+        else {\n+            if (root.hasChildren()) {", "originalCommit": "2c1db5c368a3a95a36f5a0f7166b00d672b813ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI0MzcxNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r469243714", "bodyText": "@pbludov Done", "author": "developerhb", "createdAt": "2020-08-12T13:05:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAyMjUzMg=="}], "type": "inlineReview"}, {"oid": "0647c5c9a149ccb27a73f60a3ca9d0a1d472b9bc", "url": "https://github.com/checkstyle/checkstyle/commit/0647c5c9a149ccb27a73f60a3ca9d0a1d472b9bc", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-08-12T13:04:04Z", "type": "commit"}, {"oid": "0647c5c9a149ccb27a73f60a3ca9d0a1d472b9bc", "url": "https://github.com/checkstyle/checkstyle/commit/0647c5c9a149ccb27a73f60a3ca9d0a1d472b9bc", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-08-12T13:04:04Z", "type": "forcePushed"}]}