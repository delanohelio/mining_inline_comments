{"pr_number": 8420, "pr_title": "Issue #8394: extend InnerTypeLast to work with ctors and init blocks", "pr_createdAt": "2020-07-08T15:11:33Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8420", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjAyNDQ2Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8420#discussion_r452024462", "bodyText": "Once #8048 will be done, this tokens are good candidates for a helper method like TokenUtil.isClassMember or something like this.", "author": "pbludov", "createdAt": "2020-07-09T07:40:47Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/design/InnerTypeLastCheck.java", "diffHunk": "@@ -62,6 +72,15 @@\n      */\n     public static final String MSG_KEY = \"arrangement.members.before.inner\";\n \n+    /** List of class member tokens. */\n+    private static final List<Integer> CLASS_MEMBER_TOKENS = Arrays.asList(\n+            TokenTypes.VARIABLE_DEF,", "originalCommit": "a55055823025a7264857f0a8e56be137d5eeacad", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA1NzQxNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8420#discussion_r453057415", "bodyText": "@strkkk this can be !TokenUtil.isTypeDeclaration(nextSibling.getType()) after #8345\nAlso, if (!ScopeUtil.isInCodeBlock(ast) should be moved out of the loop.\nMoreover, the loop itself is redundant. Only the next sibling should be checked. If the next sibling is a type, it will be processed soon.", "author": "pbludov", "createdAt": "2020-07-10T20:14:51Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/design/InnerTypeLastCheck.java", "diffHunk": "@@ -95,8 +114,7 @@ public void visitToken(DetailAST ast) {\n             DetailAST nextSibling = ast.getNextSibling();\n             while (nextSibling != null) {\n                 if (!ScopeUtil.isInCodeBlock(ast)\n-                    && (nextSibling.getType() == TokenTypes.VARIABLE_DEF\n-                        || nextSibling.getType() == TokenTypes.METHOD_DEF)) {\n+                    && CLASS_MEMBER_TOKENS.contains(nextSibling.getType())) {", "originalCommit": "a55055823025a7264857f0a8e56be137d5eeacad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE3MDM4Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8420#discussion_r453170386", "bodyText": "Do you think this PR should wait until #8345?\nIf loop is removed, it will cause changes in amount of violation generated by check.\nI think violation should be raised on type declaration ast, but if it is raised on class members token, it should be all of them and loop is correct here.", "author": "strkkk", "createdAt": "2020-07-11T08:08:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA1NzQxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMzNzE2MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8420#discussion_r453337160", "bodyText": "I'm ok to merge this PR as is.", "author": "pbludov", "createdAt": "2020-07-12T16:32:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA1NzQxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkyMjg3OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8420#discussion_r456922879", "bodyText": "please rebase, there should be violation that * Config: is missed.\nIf no violation, please share details on why, we have Check on this now.", "author": "romani", "createdAt": "2020-07-19T15:36:15Z", "path": "src/test/resources/com/puppycrawl/tools/checkstyle/checks/design/innertypelast/InputInnerTypeLastClassCtorsInitBlocks.java", "diffHunk": "@@ -0,0 +1,26 @@\n+package com.puppycrawl.tools.checkstyle.checks.design.innertypelast;\n+\n+public class InputInnerTypeLastClassCtorsInitBlocks {", "originalCommit": "a55055823025a7264857f0a8e56be137d5eeacad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzMxODc5MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8420#discussion_r457318791", "bodyText": "rebased and config comment added\n\nplease share details on why, we have Check on this now.\n\nNot sure what you mean", "author": "strkkk", "createdAt": "2020-07-20T12:00:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkyMjg3OQ=="}], "type": "inlineReview"}, {"oid": "4680e3368a1a332e7cbb9eb96e9b0d65ae7c2e47", "url": "https://github.com/checkstyle/checkstyle/commit/4680e3368a1a332e7cbb9eb96e9b0d65ae7c2e47", "message": "Issue #8394: extend InnerTypeLast to work with ctors and init blocks", "committedDate": "2020-07-20T08:50:22Z", "type": "commit"}, {"oid": "4680e3368a1a332e7cbb9eb96e9b0d65ae7c2e47", "url": "https://github.com/checkstyle/checkstyle/commit/4680e3368a1a332e7cbb9eb96e9b0d65ae7c2e47", "message": "Issue #8394: extend InnerTypeLast to work with ctors and init blocks", "committedDate": "2020-07-20T08:50:22Z", "type": "forcePushed"}]}