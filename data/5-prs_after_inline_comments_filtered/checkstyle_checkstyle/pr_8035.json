{"pr_number": 8035, "pr_title": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "pr_createdAt": "2020-04-04T21:42:35Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8035", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY1OTUzNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403659535", "bodyText": "Note that you change %n with \\n in the test. Please use %n as the end-of-line marker to fix windows build.", "author": "pbludov", "createdAt": "2020-04-05T07:05:14Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/MainTest.java", "diffHunk": "@@ -78,60 +78,126 @@\n             + \"Try 'checkstyle --help' for more information.%n\");\n \n     private static final String USAGE = String.format(Locale.ROOT,\n-          \"Usage: checkstyle [-dEghjJtTV] [-b=<xpath>] [-c=<configurationFile>]\"\n-          + \" [-C=<checkerThreadsNumber>]%n\"\n-          + \"                  [-f=<format>] [-o=<outputPath>] [-p=<propertiesFile>]%n\"\n-          + \"                  [-s=<suppressionLineColumnNumber>] [-w=<tabWidth>]\"\n-          + \" [-W=<treeWalkerThreadsNumber>]%n\"\n-          + \"                  [-e=<exclude>]... [-x=<excludeRegex>]...\"\n-          + \" <files>...%n\"\n-          + \"Checkstyle verifies that the specified source code files adhere to the specified\"\n-          + \" rules. By default%n\"\n-          + \"violations are reported to standard out in plain format. Checkstyle requires a\"\n-          + \" configuration XML%n\"\n-          + \"file that configures the checks to apply.%n\"\n-          + \"      <files>...            One or more source files to verify%n\"\n-          + \"  -b, --branch-matching-xpath=<xpath>%n\"\n-          + \"                            Show Abstract Syntax Tree(AST) branches that match XPath%n\"\n-          + \"  -c=<configurationFile>    Sets the check configuration file to use.%n\"\n-          + \"  -C, --checker-threads-number=<checkerThreadsNumber>%n\"\n-          + \"                            (experimental) The number of Checker threads (must be\"\n-          + \" greater than zero)%n\"\n-          + \"  -d, --debug               Print all debug logging of CheckStyle utility%n\"\n-          + \"  -e, --exclude=<exclude>   Directory/File path to exclude from CheckStyle%n\"\n-          + \"  -E, --executeIgnoredModules%n\"\n-          + \"                            Allows ignored modules to be run.%n\"\n-          + \"  -f=<format>               Sets the output format. Valid values: xml, plain.\"\n-          + \" Defaults to plain%n\"\n-          + \"  -g, --generate-xpath-suppression%n\"\n-          + \"                            Generates to output a suppression xml to use to suppress\"\n-          + \" all violations%n\"\n-          + \"                              from user's config%n\"\n-          + \"  -h, --help                Show this help message and exit.%n\"\n-          + \"  -j, --javadocTree         Print Parse tree of the Javadoc comment%n\"\n-          + \"  -J, --treeWithJavadoc     Print full Abstract Syntax Tree of the file%n\"\n-          + \"  -o=<outputPath>           Sets the output file. Defaults to stdout%n\"\n-          + \"  -p=<propertiesFile>       Loads the properties file%n\"\n-          + \"  -s=<suppressionLineColumnNumber>%n\"\n-          + \"                            Print xpath suppressions at the file's line and column\"\n-          + \" position.%n\"\n-          + \"                              Argument is the line and column number (separated by\"\n-          + \" a : ) in the%n\"\n-          + \"                              file that the suppression should be generated for%n\"\n-          + \"  -t, --tree                Print Abstract Syntax Tree(AST) of the file%n\"\n-          + \"  -T, --treeWithComments    Print Abstract Syntax Tree(AST) of the file including\"\n-          + \" comments%n\"\n-          + \"  -V, --version             Print version information and exit.%n\"\n-          + \"  -w, --tabWidth=<tabWidth> Sets the length of the tab character. Used only with\"\n-          + \" \\\"-s\\\" option.%n\"\n-          + \"                              Default value is 8%n\"\n-          + \"  -W, --tree-walker-threads-number=<treeWalkerThreadsNumber>%n\"\n-          + \"                            (experimental) The number of TreeWalker threads (must be\"\n-          + \" greater than%n\"\n-          + \"                              zero)%n\"\n-          + \"  -x, --exclude-regexp=<excludeRegex>%n\"\n-          + \"                            Regular expression of directory/file to exclude from\"\n-          + \" CheckStyle%n\");\n+          \"Usage: checkstyle [-dEghjJtTV] [-b=<xpath>] [-c=<configurationFile>] \"", "originalCommit": "fc57b8fe6441208e9fd330f9f1cd1a793caea0e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY3MzMwNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403673305", "bodyText": "@pbludov Done", "author": "gaurabdg", "createdAt": "2020-04-05T09:17:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY1OTUzNQ=="}], "type": "inlineReview"}, {"oid": "4ba2131a6acfd754f06feda26d19da43b09ac4f3", "url": "https://github.com/checkstyle/checkstyle/commit/4ba2131a6acfd754f06feda26d19da43b09ac4f3", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-05T09:16:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NjYyOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403696629", "bodyText": "Please extract this block to a private static helper method.", "author": "pbludov", "createdAt": "2020-04-05T12:41:57Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/CliOptionsXdocsSyncTest.java", "diffHunk": "@@ -0,0 +1,102 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.internal;\n+\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+\n+import java.lang.reflect.Field;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import org.junit.jupiter.api.Test;\n+import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n+import org.w3c.dom.NodeList;\n+\n+import com.puppycrawl.tools.checkstyle.internal.utils.XmlUtil;\n+import picocli.CommandLine;\n+\n+public class CliOptionsXdocsSyncTest {\n+\n+    @Test\n+    public void validateCliDocSection() throws Exception {\n+        final Map<String, String> cmdDesc = new HashMap<>();\n+        final Set<String> ignoreXdocToMain = new HashSet<>();\n+        // used to ignore options present in xdocs but not in Main.java\n+        ignoreXdocToMain.add(\"-V\");\n+        ignoreXdocToMain.add(\"-h\");\n+\n+        final Path path = Paths.get(\"src/xdocs/cmdline.xml.vm\");\n+        final String input = new String(Files.readAllBytes(path), UTF_8);\n+\n+        final Document document = XmlUtil.getRawXml(path.getFileName().toString(), input, input);\n+        final NodeList sections = document.getElementsByTagName(\"section\");", "originalCommit": "4ba2131a6acfd754f06feda26d19da43b09ac4f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzcwMDc3MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403700770", "bodyText": "Done", "author": "gaurabdg", "createdAt": "2020-04-05T13:18:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NjYyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NzExNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403697117", "bodyText": "Please use com.google.common.truth.Truth.assertWithMessage method for all assertions.", "author": "pbludov", "createdAt": "2020-04-05T12:45:51Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/CliOptionsXdocsSyncTest.java", "diffHunk": "@@ -0,0 +1,102 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.internal;\n+\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+\n+import java.lang.reflect.Field;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import org.junit.jupiter.api.Test;\n+import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n+import org.w3c.dom.NodeList;\n+\n+import com.puppycrawl.tools.checkstyle.internal.utils.XmlUtil;\n+import picocli.CommandLine;\n+\n+public class CliOptionsXdocsSyncTest {\n+\n+    @Test\n+    public void validateCliDocSection() throws Exception {\n+        final Map<String, String> cmdDesc = new HashMap<>();\n+        final Set<String> ignoreXdocToMain = new HashSet<>();\n+        // used to ignore options present in xdocs but not in Main.java\n+        ignoreXdocToMain.add(\"-V\");\n+        ignoreXdocToMain.add(\"-h\");\n+\n+        final Path path = Paths.get(\"src/xdocs/cmdline.xml.vm\");\n+        final String input = new String(Files.readAllBytes(path), UTF_8);\n+\n+        final Document document = XmlUtil.getRawXml(path.getFileName().toString(), input, input);\n+        final NodeList sections = document.getElementsByTagName(\"section\");\n+        for (int i = 0; i < sections.getLength(); i++) {\n+            final Node subSection = sections.item(i);\n+            final Node name = subSection.getAttributes().getNamedItem(\"name\");\n+            if (\"Command line usage\".equals(name.getNodeValue())) {\n+                final List<Node> children =\n+                        new ArrayList<>(XmlUtil.getChildrenElements(subSection));\n+                for (Node node:children) {\n+                    if (\"ul\".equals(node.getNodeName())) {\n+                        final List<Node> listElements =\n+                                new ArrayList<>(XmlUtil.getChildrenElements(node));\n+                        for (Node element:listElements) {\n+                            final String txt = element.getTextContent()\n+                                    .trim().replaceAll(\"\\\\s+\", \" \");\n+                            cmdDesc.put(txt.substring(0, 2), txt.substring(3));\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+\n+        final Class<?> cliOptionsClazz = Class.forName(\"com.puppycrawl.tools.checkstyle\"\n+                + \".Main$CliOptions\");\n+        final Field[] fields = cliOptionsClazz.getDeclaredFields();\n+        for (Field field:fields) {\n+            final CommandLine.Option optionsAnnotation =\n+                  field.getAnnotation(CommandLine.Option.class);\n+            if (optionsAnnotation != null) {\n+                final String option = optionsAnnotation.names()[0];\n+                final String descXdoc = cmdDesc.get(option);\n+                assertNotNull(descXdoc, \"CLI Option\" + option + \"present in Main.java not \"", "originalCommit": "4ba2131a6acfd754f06feda26d19da43b09ac4f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzcwMDc1NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403700755", "bodyText": "Done", "author": "gaurabdg", "createdAt": "2020-04-05T13:18:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NzExNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NzI1MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403697251", "bodyText": "Please add spaces around :", "author": "pbludov", "createdAt": "2020-04-05T12:47:11Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/CliOptionsXdocsSyncTest.java", "diffHunk": "@@ -0,0 +1,102 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.internal;\n+\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+\n+import java.lang.reflect.Field;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import org.junit.jupiter.api.Test;\n+import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n+import org.w3c.dom.NodeList;\n+\n+import com.puppycrawl.tools.checkstyle.internal.utils.XmlUtil;\n+import picocli.CommandLine;\n+\n+public class CliOptionsXdocsSyncTest {\n+\n+    @Test\n+    public void validateCliDocSection() throws Exception {\n+        final Map<String, String> cmdDesc = new HashMap<>();\n+        final Set<String> ignoreXdocToMain = new HashSet<>();\n+        // used to ignore options present in xdocs but not in Main.java\n+        ignoreXdocToMain.add(\"-V\");\n+        ignoreXdocToMain.add(\"-h\");\n+\n+        final Path path = Paths.get(\"src/xdocs/cmdline.xml.vm\");\n+        final String input = new String(Files.readAllBytes(path), UTF_8);\n+\n+        final Document document = XmlUtil.getRawXml(path.getFileName().toString(), input, input);\n+        final NodeList sections = document.getElementsByTagName(\"section\");\n+        for (int i = 0; i < sections.getLength(); i++) {\n+            final Node subSection = sections.item(i);\n+            final Node name = subSection.getAttributes().getNamedItem(\"name\");\n+            if (\"Command line usage\".equals(name.getNodeValue())) {\n+                final List<Node> children =\n+                        new ArrayList<>(XmlUtil.getChildrenElements(subSection));\n+                for (Node node:children) {\n+                    if (\"ul\".equals(node.getNodeName())) {\n+                        final List<Node> listElements =\n+                                new ArrayList<>(XmlUtil.getChildrenElements(node));\n+                        for (Node element:listElements) {\n+                            final String txt = element.getTextContent()\n+                                    .trim().replaceAll(\"\\\\s+\", \" \");\n+                            cmdDesc.put(txt.substring(0, 2), txt.substring(3));\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+\n+        final Class<?> cliOptionsClazz = Class.forName(\"com.puppycrawl.tools.checkstyle\"\n+                + \".Main$CliOptions\");\n+        final Field[] fields = cliOptionsClazz.getDeclaredFields();\n+        for (Field field:fields) {", "originalCommit": "4ba2131a6acfd754f06feda26d19da43b09ac4f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzcwMDczNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403700736", "bodyText": "Done", "author": "gaurabdg", "createdAt": "2020-04-05T13:17:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NzI1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NzM4Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403697382", "bodyText": "There is a variable for optionsAnnotation.names()[0]", "author": "pbludov", "createdAt": "2020-04-05T12:48:27Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/CliOptionsXdocsSyncTest.java", "diffHunk": "@@ -0,0 +1,102 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.internal;\n+\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+\n+import java.lang.reflect.Field;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import org.junit.jupiter.api.Test;\n+import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n+import org.w3c.dom.NodeList;\n+\n+import com.puppycrawl.tools.checkstyle.internal.utils.XmlUtil;\n+import picocli.CommandLine;\n+\n+public class CliOptionsXdocsSyncTest {\n+\n+    @Test\n+    public void validateCliDocSection() throws Exception {\n+        final Map<String, String> cmdDesc = new HashMap<>();\n+        final Set<String> ignoreXdocToMain = new HashSet<>();\n+        // used to ignore options present in xdocs but not in Main.java\n+        ignoreXdocToMain.add(\"-V\");\n+        ignoreXdocToMain.add(\"-h\");\n+\n+        final Path path = Paths.get(\"src/xdocs/cmdline.xml.vm\");\n+        final String input = new String(Files.readAllBytes(path), UTF_8);\n+\n+        final Document document = XmlUtil.getRawXml(path.getFileName().toString(), input, input);\n+        final NodeList sections = document.getElementsByTagName(\"section\");\n+        for (int i = 0; i < sections.getLength(); i++) {\n+            final Node subSection = sections.item(i);\n+            final Node name = subSection.getAttributes().getNamedItem(\"name\");\n+            if (\"Command line usage\".equals(name.getNodeValue())) {\n+                final List<Node> children =\n+                        new ArrayList<>(XmlUtil.getChildrenElements(subSection));\n+                for (Node node:children) {\n+                    if (\"ul\".equals(node.getNodeName())) {\n+                        final List<Node> listElements =\n+                                new ArrayList<>(XmlUtil.getChildrenElements(node));\n+                        for (Node element:listElements) {\n+                            final String txt = element.getTextContent()\n+                                    .trim().replaceAll(\"\\\\s+\", \" \");\n+                            cmdDesc.put(txt.substring(0, 2), txt.substring(3));\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+\n+        final Class<?> cliOptionsClazz = Class.forName(\"com.puppycrawl.tools.checkstyle\"\n+                + \".Main$CliOptions\");\n+        final Field[] fields = cliOptionsClazz.getDeclaredFields();\n+        for (Field field:fields) {\n+            final CommandLine.Option optionsAnnotation =\n+                  field.getAnnotation(CommandLine.Option.class);\n+            if (optionsAnnotation != null) {\n+                final String option = optionsAnnotation.names()[0];\n+                final String descXdoc = cmdDesc.get(option);\n+                assertNotNull(descXdoc, \"CLI Option\" + option + \"present in Main.java not \"\n+                       + \"documented in cmdline.xml.vm\");\n+                assertEquals(descXdoc, optionsAnnotation.description()[0],\n+                        \"CLI options descriptions should match\");\n+                cmdDesc.remove(\n+                        optionsAnnotation.names()[0]);", "originalCommit": "4ba2131a6acfd754f06feda26d19da43b09ac4f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzcwMDcyNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403700726", "bodyText": "Done", "author": "gaurabdg", "createdAt": "2020-04-05T13:17:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NzM4Mg=="}], "type": "inlineReview"}, {"oid": "c3340488190ccc9a9bfd7aafa21cba2c9588be07", "url": "https://github.com/checkstyle/checkstyle/commit/c3340488190ccc9a9bfd7aafa21cba2c9588be07", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-05T13:42:16Z", "type": "forcePushed"}, {"oid": "a28f5f9958b660ca4fd1303b3f76f4f816528521", "url": "https://github.com/checkstyle/checkstyle/commit/a28f5f9958b660ca4fd1303b3f76f4f816528521", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-05T13:59:39Z", "type": "forcePushed"}, {"oid": "4b97f7468eb917f34ca1419aa757ba53cab3b2d7", "url": "https://github.com/checkstyle/checkstyle/commit/4b97f7468eb917f34ca1419aa757ba53cab3b2d7", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-05T15:05:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc3NDk3Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403774977", "bodyText": "Why did we add configurationFile to description?", "author": "rnveach", "createdAt": "2020-04-05T23:48:02Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -607,22 +607,31 @@ public boolean isLoggable(LogRecord record) {\n         private List<File> files;\n \n         /** Config file location. */\n-        @Option(names = \"-c\", description = \"Sets the check configuration file to use.\")\n+        @Option(names = \"-c\", description = \"configurationFile - specifies the location of the\"", "originalCommit": "4b97f7468eb917f34ca1419aa757ba53cab3b2d7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc3NTA5Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403775093", "bodyText": "same.", "author": "rnveach", "createdAt": "2020-04-05T23:48:48Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -631,14 +640,17 @@ public boolean isLoggable(LogRecord record) {\n          *\n          * @noinspection CanBeFinal\n          */\n-        @Option(names = {\"-w\", \"--tabWidth\"}, description = \"Sets the length of the tab character. \"\n-                + \"Used only with \\\"-s\\\" option. Default value is ${DEFAULT-VALUE}\")\n+        @Option(names = {\"-w\", \"--tabWidth\"}, description = \" --tabWidth length - set the length\"\n+                + \" of the tab character. Used only with -s and -gxs options. Default value is 8.\")\n         private int tabWidth = CommonUtil.DEFAULT_TAB_WIDTH;\n \n         /** Switch whether to generate suppressions file or not. */\n         @Option(names = {\"-g\", \"--generate-xpath-suppression\"},\n-                description = \"Generates to output a suppression xml to use to suppress all\"\n-                        + \" violations from user's config\")\n+                description = \"--generate-xpath-suppression - generate to output a suppression\"", "originalCommit": "4b97f7468eb917f34ca1419aa757ba53cab3b2d7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc3NTE0Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403775142", "bodyText": "same.", "author": "rnveach", "createdAt": "2020-04-05T23:49:02Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -647,33 +659,48 @@ public boolean isLoggable(LogRecord record) {\n          *\n          * @noinspection CanBeFinal\n          */\n-        @Option(names = \"-f\", description = \"Sets the output format. Valid values: \"\n-                + \"${COMPLETION-CANDIDATES}. Defaults to ${DEFAULT-VALUE}\")\n+        @Option(names = \"-f\", description = \"format - specify the output format. Options are\"", "originalCommit": "4b97f7468eb917f34ca1419aa757ba53cab3b2d7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc3NTE3MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r403775170", "bodyText": "same and so on.", "author": "rnveach", "createdAt": "2020-04-05T23:49:20Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -647,33 +659,48 @@ public boolean isLoggable(LogRecord record) {\n          *\n          * @noinspection CanBeFinal\n          */\n-        @Option(names = \"-f\", description = \"Sets the output format. Valid values: \"\n-                + \"${COMPLETION-CANDIDATES}. Defaults to ${DEFAULT-VALUE}\")\n+        @Option(names = \"-f\", description = \"format - specify the output format. Options are\"\n+                + \" \\\"plain\\\" for the DefaultLogger and \\\"xml\\\" for the XMLLogger. Defaults\"\n+                + \" to \\\"plain\\\".\")\n         private OutputFormat format = DEFAULT_OUTPUT_FORMAT;\n \n         /** Option that controls whether to print the AST of the file. */\n         @Option(names = {\"-t\", \"--tree\"},\n-                description = \"Print Abstract Syntax Tree(AST) of the file\")\n+                description = \" --tree - print Abstract Syntax Tree(AST) of the checked file.\"", "originalCommit": "4b97f7468eb917f34ca1419aa757ba53cab3b2d7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "86c2cb8c75899a8c117259e2308c8a0eee09bf34", "url": "https://github.com/checkstyle/checkstyle/commit/86c2cb8c75899a8c117259e2308c8a0eee09bf34", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-06T11:02:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1Mzk4NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404353985", "bodyText": "All descriptions should be proper sentences. Start with an uppercase letter and end with a period.\nPlease do the same for the rest.", "author": "rnveach", "createdAt": "2020-04-06T20:03:19Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -607,22 +607,31 @@ public boolean isLoggable(LogRecord record) {\n         private List<File> files;\n \n         /** Config file location. */\n-        @Option(names = \"-c\", description = \"Sets the check configuration file to use.\")\n+        @Option(names = \"-c\", description = \"specifies the location of the\"", "originalCommit": "86c2cb8c75899a8c117259e2308c8a0eee09bf34", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NTY5Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404355697", "bodyText": "Why did we lose the original description? It looks like it has more as it defines the default description.", "author": "rnveach", "createdAt": "2020-04-06T20:06:41Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -607,22 +607,31 @@ public boolean isLoggable(LogRecord record) {\n         private List<File> files;\n \n         /** Config file location. */\n-        @Option(names = \"-c\", description = \"Sets the check configuration file to use.\")\n+        @Option(names = \"-c\", description = \"specifies the location of the\"\n+                + \" file that defines the configuration modules. The location can either be a\"\n+                + \" filesystem location, or a name passed to the ClassLoader.getResource() method.\")\n         private String configurationFile;\n \n         /** Output file location. */\n-        @Option(names = \"-o\", description = \"Sets the output file. Defaults to stdout\")\n+        @Option(names = \"-o\", description = \"specify the file to output to.\")", "originalCommit": "86c2cb8c75899a8c117259e2308c8a0eee09bf34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2NTA0Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404365043", "bodyText": "@rnveach My code is reading the descriptions from xdoc, removing the parameters(-,--) and checking against the annotation descriptions for all options as @romani mentioned in #6216 (comment) that xdocs are better. Do you want me to update the xdoc desc for this option then?", "author": "gaurabdg", "createdAt": "2020-04-06T20:23:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NTY5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM3MDAzMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404370030", "bodyText": "Same as #8035 (comment) .\n@romani posted that in issue and probably did not look at each and every xdoc description. As stated in other one, I think we should merge the 2 and make 1 consistent message. I think we should include the default message.", "author": "rnveach", "createdAt": "2020-04-06T20:32:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NTY5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM3MzU4Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404373582", "bodyText": "Ok, I will try to take all the points mentioned and update both the sections along with starting the description with plural verbs", "author": "gaurabdg", "createdAt": "2020-04-06T20:39:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NTY5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NjE3Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404356173", "bodyText": "Why did we lose the ()s around (separated by a : )?", "author": "rnveach", "createdAt": "2020-04-06T20:07:34Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -607,22 +607,31 @@ public boolean isLoggable(LogRecord record) {\n         private List<File> files;\n \n         /** Config file location. */\n-        @Option(names = \"-c\", description = \"Sets the check configuration file to use.\")\n+        @Option(names = \"-c\", description = \"specifies the location of the\"\n+                + \" file that defines the configuration modules. The location can either be a\"\n+                + \" filesystem location, or a name passed to the ClassLoader.getResource() method.\")\n         private String configurationFile;\n \n         /** Output file location. */\n-        @Option(names = \"-o\", description = \"Sets the output file. Defaults to stdout\")\n+        @Option(names = \"-o\", description = \"specify the file to output to.\")\n         private Path outputPath;\n \n         /** Properties file location. */\n-        @Option(names = \"-p\", description = \"Loads the properties file\")\n+        @Option(names = \"-p\", description = \"specify a properties file to use.\")\n         private File propertiesFile;\n \n         /** LineNo and columnNo for the suppression. */\n         @Option(names = \"-s\",\n-                description = \"Print xpath suppressions at the file's line and column position. \"\n-                        + \"Argument is the line and column number (separated by a : ) in the file \"\n-                        + \"that the suppression should be generated for\")\n+                description = \"print xpath suppressions at the file's line and\"\n+                        + \" column position. Line and column numbers are integer values\"\n+                        + \" separated by a :, specify location in the file the suppression\"", "originalCommit": "86c2cb8c75899a8c117259e2308c8a0eee09bf34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2NzEwMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404367100", "bodyText": "Same reason.Since for the first run, I copied the desc written in xdocs. Do you want me to update them?", "author": "gaurabdg", "createdAt": "2020-04-06T20:27:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NjE3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM3MDYzNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404370636", "bodyText": "Same as #8035 (comment) .\nI will look over again if you determine the best approach is to stick with this.", "author": "rnveach", "createdAt": "2020-04-06T20:33:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NjE3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NjcyOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404356729", "bodyText": "There are a few places like this, why did we change \"Sets\" to \"Set\"?", "author": "rnveach", "createdAt": "2020-04-06T20:08:37Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -631,14 +640,17 @@ public boolean isLoggable(LogRecord record) {\n          *\n          * @noinspection CanBeFinal\n          */\n-        @Option(names = {\"-w\", \"--tabWidth\"}, description = \"Sets the length of the tab character. \"\n-                + \"Used only with \\\"-s\\\" option. Default value is ${DEFAULT-VALUE}\")\n+        @Option(names = {\"-w\", \"--tabWidth\"}, description = \"set the length\"", "originalCommit": "86c2cb8c75899a8c117259e2308c8a0eee09bf34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2NjI2Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404366266", "bodyText": "Because as I mentioned earlier, my code checks xdocs against annotation desc. For the first run I copied all the xdoc desc here in Main.java as mentioned here #6216 (comment)", "author": "gaurabdg", "createdAt": "2020-04-06T20:26:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NjcyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2ODcxOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404368719", "bodyText": "@gaurabdg These type of issues aren't about copying one over the other. It is about finding the differences and combining the best of both of them and creating a single unified description.\nMost of the descriptions start with a plural verb, so I believe that is how they should all be.", "author": "rnveach", "createdAt": "2020-04-06T20:30:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NjcyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NzA5MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404357091", "bodyText": "There is no way to keep the ${DEFAULT-VALUE} in the Java code and convert it to it's text form in the xdoc?", "author": "rnveach", "createdAt": "2020-04-06T20:09:12Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -631,14 +640,17 @@ public boolean isLoggable(LogRecord record) {\n          *\n          * @noinspection CanBeFinal\n          */\n-        @Option(names = {\"-w\", \"--tabWidth\"}, description = \"Sets the length of the tab character. \"\n-                + \"Used only with \\\"-s\\\" option. Default value is ${DEFAULT-VALUE}\")", "originalCommit": "86c2cb8c75899a8c117259e2308c8a0eee09bf34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ0MTY3OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404441679", "bodyText": "Yes, there is. option.description() returns the description string by renderning the values.\nBut there's a strange problem. Some variables like ${COMPLETION-CANDIDATES} are being rendered correctly but rest ${DEFAULT-VALUE} is being initialized incorrectly to 0/null.", "author": "gaurabdg", "createdAt": "2020-04-06T23:08:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NzA5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU5MDY5NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404590695", "bodyText": "It has been resolved, I'll resubmit as soon as I merge the descriptions", "author": "gaurabdg", "createdAt": "2020-04-07T07:23:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NzA5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NzM3OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404357379", "bodyText": "I don't see the purpose of this change. The original code was easier to read. Nothing else seems different.", "author": "rnveach", "createdAt": "2020-04-06T20:09:46Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/Main.java", "diffHunk": "@@ -693,12 +722,13 @@ public boolean isLoggable(LogRecord record) {\n          * @noinspection CanBeFinal\n          */\n         @Option(names = {\"-x\", \"--exclude-regexp\"},\n-                description = \"Regular expression of directory/file to exclude from CheckStyle\")\n+                description = \"Directory/file pattern to exclude from CheckStyle. \"\n+                        + \"Multiple excludes are allowed.\")\n         private List<Pattern> excludeRegex = new ArrayList<>();\n \n         /** Switch whether to execute ignored modules or not. */\n-        @Option(names = {\"-E\", \"--executeIgnoredModules\"},\n-                description = \"Allows ignored modules to be run.\")\n+        @Option(names = {\"-E\", \"--executeIgnoredModules\"}, description = \"Allows ignored modules\"\n+                + \" to be run.\")", "originalCommit": "86c2cb8c75899a8c117259e2308c8a0eee09bf34", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1OTY0Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404359647", "bodyText": "Why do we need to look at all sections when you have given the ul an exact ID? Why aren't we using document.getElementById?", "author": "rnveach", "createdAt": "2020-04-06T20:13:55Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/CliOptionsXdocsSyncTest.java", "diffHunk": "@@ -0,0 +1,111 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.internal;\n+\n+import static com.google.common.truth.Truth.assertWithMessage;\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+\n+import java.lang.reflect.Field;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import org.junit.jupiter.api.Test;\n+import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n+import org.w3c.dom.NodeList;\n+\n+import com.puppycrawl.tools.checkstyle.internal.utils.XmlUtil;\n+import picocli.CommandLine.Option;\n+\n+public class CliOptionsXdocsSyncTest {\n+\n+    @Test\n+    public void validateCliDocSection() throws Exception {\n+        final Map<String, String> cmdDesc = new HashMap<>();\n+        final Set<String> ignoreXdocToMain = new HashSet<>();\n+        // used to ignore options present in xdocs but not in Main.java\n+        ignoreXdocToMain.add(\"-V\");\n+        ignoreXdocToMain.add(\"-h\");\n+\n+        final NodeList sections = getSectionsFromXdoc(\"src/xdocs/cmdline.xml.vm\");\n+\n+        for (int i = 0; i < sections.getLength(); i++) {\n+            final Node subSection = sections.item(i);\n+            final Node name = subSection.getAttributes().getNamedItem(\"name\");\n+            if (\"Command line usage\".equals(name.getNodeValue())) {\n+                final Set<String> cmdOptions = getListById(subSection, \"CLI_Options\");\n+                for (String option : cmdOptions) {\n+                    final String text = option.trim().replaceAll(\"\\\\s+\", \" \");\n+                    cmdDesc.put(text.substring(0, 2), text.substring(text.indexOf(\" - \") + 3));\n+                }\n+            }\n+        }\n+\n+        final Class<?> cliOptionsClazz = Class.forName(\"com.puppycrawl.tools.checkstyle\"\n+                + \".Main$CliOptions\");\n+        final Field[] fields = cliOptionsClazz.getDeclaredFields();\n+        for (Field field : fields) {\n+            final Option optionsAnnotation = field.getAnnotation(Option.class);\n+            if (optionsAnnotation != null) {\n+                final String option = optionsAnnotation.names()[0];\n+                final String descXdoc = cmdDesc.get(option);\n+                final String descMain = optionsAnnotation.description()[0];\n+                assertWithMessage(\"CLI Option\" + option + \"present in \"\n+                        + \"Main.java not documented in cmdline.xml.vm\")\n+                        .that(descXdoc).isNotNull();\n+                assertWithMessage(\"CLI options descriptions in xdoc: \" + descXdoc\n+                        + \" should match that of in Main.java: \" + descMain)\n+                        .that(descXdoc.equals(descMain)).isTrue();\n+                cmdDesc.remove(option);\n+            }\n+        }\n+\n+        cmdDesc.entrySet().removeIf(entry -> ignoreXdocToMain.contains(entry.getKey()));\n+        assertWithMessage(\"CLI Options\" + cmdDesc + \"present in \"\n+                + \"cmdline.xml.vm not documented in Main.java\")\n+                .that(cmdDesc.isEmpty());\n+    }\n+\n+    private static NodeList getSectionsFromXdoc(String xdocPath) throws Exception {\n+        final Path path = Paths.get(xdocPath);\n+        final String input = new String(Files.readAllBytes(path), UTF_8);\n+\n+        final Document document = XmlUtil.getRawXml(path.getFileName().toString(), input, input);\n+        return document.getElementsByTagName(\"section\");", "originalCommit": "86c2cb8c75899a8c117259e2308c8a0eee09bf34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDU1MTQ2MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r414551460", "bodyText": "@gaurabdg This is still not done.", "author": "rnveach", "createdAt": "2020-04-24T12:51:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1OTY0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDU5OTM2MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r414599361", "bodyText": "@rnveach document.getElementById is returning null, since we have to define a separate DTD schema to specify which is actually the ID for this xml. https://stackoverflow.com/a/53044340", "author": "gaurabdg", "createdAt": "2020-04-24T14:01:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1OTY0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDczNzc1NA==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r414737754", "bodyText": "If we can't get the element by ID, then we don't need the ID in the XDOC.\n\n<ul id=\"CLI_Options\">", "author": "rnveach", "createdAt": "2020-04-24T17:20:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1OTY0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDc5ODk0MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r414798940", "bodyText": "@rnveach It is required for getListById method.", "author": "gaurabdg", "createdAt": "2020-04-24T19:03:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1OTY0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2MTcyMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404361720", "bodyText": "So we are specifically looking for options in our class and not what is being reported by picocli?", "author": "rnveach", "createdAt": "2020-04-06T20:17:50Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/CliOptionsXdocsSyncTest.java", "diffHunk": "@@ -0,0 +1,111 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.internal;\n+\n+import static com.google.common.truth.Truth.assertWithMessage;\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+\n+import java.lang.reflect.Field;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import org.junit.jupiter.api.Test;\n+import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n+import org.w3c.dom.NodeList;\n+\n+import com.puppycrawl.tools.checkstyle.internal.utils.XmlUtil;\n+import picocli.CommandLine.Option;\n+\n+public class CliOptionsXdocsSyncTest {\n+\n+    @Test\n+    public void validateCliDocSection() throws Exception {\n+        final Map<String, String> cmdDesc = new HashMap<>();\n+        final Set<String> ignoreXdocToMain = new HashSet<>();\n+        // used to ignore options present in xdocs but not in Main.java", "originalCommit": "86c2cb8c75899a8c117259e2308c8a0eee09bf34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM3MDA2NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404370065", "bodyText": "Yes, by getting all the fields we get all the options", "author": "gaurabdg", "createdAt": "2020-04-06T20:32:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2MTcyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM3MzUwMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404373500", "bodyText": "Not all by your comment. We are missing out on help and version. They are run-time added options and not in the CliOptions.\nThere is no other way given by picocli to get all the options for our purposes?", "author": "rnveach", "createdAt": "2020-04-06T20:38:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2MTcyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM5NTc0Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8035#discussion_r404395743", "bodyText": "Yes, it can be done by creating a mock and querying through given methods, I'll do it.", "author": "gaurabdg", "createdAt": "2020-04-06T21:21:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2MTcyMA=="}], "type": "inlineReview"}, {"oid": "72dbf994ae300649e17e11debe5aa6a70dd4d147", "url": "https://github.com/checkstyle/checkstyle/commit/72dbf994ae300649e17e11debe5aa6a70dd4d147", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-07T15:15:53Z", "type": "forcePushed"}, {"oid": "de27c6464d20fe459ca37c1174401bf8130428b7", "url": "https://github.com/checkstyle/checkstyle/commit/de27c6464d20fe459ca37c1174401bf8130428b7", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-08T11:09:16Z", "type": "forcePushed"}, {"oid": "7c5bd04491dc68cfe220443ce591d7f182ce5996", "url": "https://github.com/checkstyle/checkstyle/commit/7c5bd04491dc68cfe220443ce591d7f182ce5996", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-08T16:36:16Z", "type": "forcePushed"}, {"oid": "5699d3d542cce71587947d15dc9dccfd92fa32ea", "url": "https://github.com/checkstyle/checkstyle/commit/5699d3d542cce71587947d15dc9dccfd92fa32ea", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-08T16:56:02Z", "type": "forcePushed"}, {"oid": "91d50b4f407934fccece3a4cc2c0a0a56f981c4a", "url": "https://github.com/checkstyle/checkstyle/commit/91d50b4f407934fccece3a4cc2c0a0a56f981c4a", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-08T18:55:21Z", "type": "forcePushed"}, {"oid": "5772b6105a9ee0170da644535bdd80d811114a39", "url": "https://github.com/checkstyle/checkstyle/commit/5772b6105a9ee0170da644535bdd80d811114a39", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-08T22:33:15Z", "type": "forcePushed"}, {"oid": "4446b8a21600826ee7dba67e56c6f2455db832bd", "url": "https://github.com/checkstyle/checkstyle/commit/4446b8a21600826ee7dba67e56c6f2455db832bd", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-18T12:16:03Z", "type": "forcePushed"}, {"oid": "d4f10bc84c3e75fb793d110fe4e97ed84de45032", "url": "https://github.com/checkstyle/checkstyle/commit/d4f10bc84c3e75fb793d110fe4e97ed84de45032", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-25T16:42:13Z", "type": "forcePushed"}, {"oid": "7d3a01d617f36d6b4da330ddf4a1767661fe10a1", "url": "https://github.com/checkstyle/checkstyle/commit/7d3a01d617f36d6b4da330ddf4a1767661fe10a1", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-26T08:13:45Z", "type": "commit"}, {"oid": "7d3a01d617f36d6b4da330ddf4a1767661fe10a1", "url": "https://github.com/checkstyle/checkstyle/commit/7d3a01d617f36d6b4da330ddf4a1767661fe10a1", "message": "Issue #6216: sync content of cli tool in xdoc and cli tool help output", "committedDate": "2020-04-26T08:13:45Z", "type": "forcePushed"}]}