{"pr_number": 8917, "pr_title": "Issue #8916: use empty string for empty array values of token property", "pr_createdAt": "2020-10-22T14:36:09Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8917", "timeline": [{"oid": "375299f4d93b3f9bb5188c68976c3454f1fd636b", "url": "https://github.com/checkstyle/checkstyle/commit/375299f4d93b3f9bb5188c68976c3454f1fd636b", "message": "Issue #8916: use empty string for empty array values of token property", "committedDate": "2020-10-22T14:42:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5MzQzMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8917#discussion_r510693431", "bodyText": "if this is changed, how come metadata file didn't change?", "author": "strkkk", "createdAt": "2020-10-23T07:39:32Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/IllegalTokenTextCheck.java", "diffHunk": "@@ -54,7 +54,7 @@\n  * Property {@code tokens} - tokens to check\n  * Type is {@code java.lang.String[]}.\n  * Validation type is {@code tokenSet}.\n- * Default value is: empty.\n+ * Default value is: {@code \"\"}.", "originalCommit": "375299f4d93b3f9bb5188c68976c3454f1fd636b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDkxMzkxOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8917#discussion_r510913919", "bodyText": "because it was in right form (with \"\" already)\n\n  \n    \n      checkstyle/src/main/resources/com/puppycrawl/tools/checkstyle/meta/checks/coding/IllegalTokenTextCheck.xml\n    \n    \n        Lines 25 to 28\n      in\n      58bae0f\n    \n    \n    \n    \n\n        \n          \n           <property default-value=\"\" \n        \n\n        \n          \n                     name=\"tokens\" \n        \n\n        \n          \n                     type=\"java.lang.String[]\" \n        \n\n        \n          \n                     validation-type=\"tokenSet\"> \n        \n    \n  \n\n\nI am not sure where in code we have a bug that allow such unsync.", "author": "romani", "createdAt": "2020-10-23T14:14:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5MzQzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5Mzk4OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8917#discussion_r510693988", "bodyText": "{@code empty} above you removed the only occurrence of this in code, why it is added here?", "author": "strkkk", "createdAt": "2020-10-23T07:40:37Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/XdocsJavaDocsTest.java", "diffHunk": "@@ -393,10 +393,12 @@ else if (isPropertyTokenType) {\n         return result;\n     }\n \n-    private static String emptyStringArrayDefaultValue(Node defaultValueNode) {\n+    private static String emptyStringArrayDefaultValue(Node defaultValueNode,\n+                                                boolean isPropertyTokenType) {\n         String defaultValueText = getNodeText(defaultValueNode);\n         if (\"{@code {}}\".equals(defaultValueText)\n-            || \"{@code all files}\".equals(defaultValueText)) {\n+            || \"{@code all files}\".equals(defaultValueText)\n+            || isPropertyTokenType && \"{@code empty}\".equals(defaultValueText)) {", "originalCommit": "375299f4d93b3f9bb5188c68976c3454f1fd636b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDkxNTIzOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8917#discussion_r510915239", "bodyText": "this code do comparison of Xdoc (where we have \"empty\") with javadoc (where we have \"\").\nSo we need to keep xdco and javadoc in state as they are, so comparator code should be updated to treat them the same.", "author": "romani", "createdAt": "2020-10-23T14:16:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5Mzk4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NTMxNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8917#discussion_r510695317", "bodyText": "should have ',' & '.'\n\nProbably 'and' should be 'or'\narguably it is better to make it should have comma and dot ....  instead of chars", "author": "strkkk", "createdAt": "2020-10-23T07:43:01Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/XdocsPagesTest.java", "diffHunk": "@@ -896,14 +896,20 @@ private static void validatePropertySectionPropertyTokens(String fileName, Strin\n         final String defaultTokenText = columns.get(3).getTextContent().trim();\n         final String expectedDefaultTokenText = CheckUtil.getTokenText(check.getDefaultTokens(),\n                 check.getRequiredTokens());\n-        assertEquals(expectedDefaultTokenText, defaultTokenText\n-                        .replaceAll(\"\\\\s+\", \" \")\n-                        .replaceAll(\"\\\\s,\", \",\")\n-                        .replaceAll(\"\\\\s\\\\.\", \".\"),\n-                fileName + \" section '\" + sectionName + \"' should have all the default tokens\");\n-        assertFalse(isInvalidTokenPunctuation(defaultTokenText),\n-                fileName + \"'s default token section: \" + sectionName\n-                        + \"should have ',' & '.' at beginning of the next corresponding lines.\");\n+        if (expectedDefaultTokenText.isEmpty()) {\n+            assertEquals(\"empty\", defaultTokenText,\n+                    \"Empty tokens should have 'empty' string in xdoc\");\n+        }\n+        else {\n+            assertEquals(expectedDefaultTokenText, defaultTokenText\n+                            .replaceAll(\"\\\\s+\", \" \")\n+                            .replaceAll(\"\\\\s,\", \",\")\n+                            .replaceAll(\"\\\\s\\\\.\", \".\"),\n+                    fileName + \" section '\" + sectionName + \"' should have all the default tokens\");\n+            assertFalse(isInvalidTokenPunctuation(defaultTokenText),\n+                    fileName + \"'s default token section: \" + sectionName\n+                           + \"should have ',' & '.' at beginning of the next corresponding lines.\");", "originalCommit": "375299f4d93b3f9bb5188c68976c3454f1fd636b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDkyMTM4Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/8917#discussion_r510921387", "bodyText": "fixed.\n\n\n\n\n\nI would keep it exact.", "author": "romani", "createdAt": "2020-10-23T14:25:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NTMxNw=="}], "type": "inlineReview"}, {"oid": "8c2435f959953e219a81998f2042f9cc846ec52b", "url": "https://github.com/checkstyle/checkstyle/commit/8c2435f959953e219a81998f2042f9cc846ec52b", "message": "minor: fix wording in assert for leading comma and dot in tokens", "committedDate": "2020-10-23T14:27:49Z", "type": "commit"}]}