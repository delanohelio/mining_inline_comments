{"pr_number": 7843, "pr_title": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "pr_createdAt": "2020-03-13T13:48:05Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/7843", "timeline": [{"oid": "be85b6b02dc3d75552d4da7b6d647edef12007b3", "url": "https://github.com/checkstyle/checkstyle/commit/be85b6b02dc3d75552d4da7b6d647edef12007b3", "message": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "committedDate": "2020-03-13T13:58:08Z", "type": "forcePushed"}, {"oid": "faf5fe55f94cc9b2588236fda4c5eb4c3af54639", "url": "https://github.com/checkstyle/checkstyle/commit/faf5fe55f94cc9b2588236fda4c5eb4c3af54639", "message": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "committedDate": "2020-03-13T21:39:04Z", "type": "forcePushed"}, {"oid": "8150946e652885c438b26bd0322e1c8883112857", "url": "https://github.com/checkstyle/checkstyle/commit/8150946e652885c438b26bd0322e1c8883112857", "message": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "committedDate": "2020-03-15T09:23:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDc2Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7843#discussion_r392684767", "bodyText": "Please generate regression report with\nallowClassImports = true and  allowStaticMemberImports = false", "author": "pbludov", "createdAt": "2020-03-15T15:30:52Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/imports/AvoidStarImportCheck.java", "diffHunk": "@@ -220,8 +220,7 @@ public void visitToken(final DetailAST ast) {\n             final DetailAST startingDot = ast.getFirstChild();\n             logsStarredImportViolation(startingDot);\n         }\n-        else if (!allowStaticMemberImports\n-            && ast.getType() == TokenTypes.STATIC_IMPORT) {\n+        else if (!allowStaticMemberImports) {", "originalCommit": "8150946e652885c438b26bd0322e1c8883112857", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5Njk3Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7843#discussion_r392696977", "bodyText": "It's done already.\nThe default value for both variable is false.\nI have already generated a regression report for some configuration where allowClassImports was explicitly set to true, I didn't touch allowStaticMemberImports so its value was implicitly set to false.\nHere is the link to the corresponding diff report: https://wilcoln.github.io/checkstyle-reports/7799/mutation/conf2/diff/index.html", "author": "wilcoln", "createdAt": "2020-03-15T17:56:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDc2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcwNTI1Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7843#discussion_r392705257", "bodyText": "@pbludov We discussed the code change at #7799 (comment) and there is absolutely no way for regression to hit this. We did expand regression to be sure.", "author": "rnveach", "createdAt": "2020-03-15T19:39:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDc2Nw=="}], "type": "inlineReview"}, {"oid": "4304bc2e894d9f8a4ae45ef47ca7287a8ded507f", "url": "https://github.com/checkstyle/checkstyle/commit/4304bc2e894d9f8a4ae45ef47ca7287a8ded507f", "message": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "committedDate": "2020-03-15T16:32:28Z", "type": "forcePushed"}, {"oid": "d66b9b006d2b7ec59bd65d47124c3d54c3d79379", "url": "https://github.com/checkstyle/checkstyle/commit/d66b9b006d2b7ec59bd65d47124c3d54c3d79379", "message": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "committedDate": "2020-03-15T19:07:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcwNTYzNg==", "url": "https://github.com/checkstyle/checkstyle/pull/7843#discussion_r392705636", "bodyText": "@wilcoln Is there some other way to change the code to make more sense and not work with an invalid AST?\nThese 2 if conditions are very similar except for these lines from each:\n\nfinal DetailAST startingDot = ast.getFirstChild();\nfinal DetailAST startingDot = ast.getFirstChild().getNextSibling();\n\nMy current idea is the first if statement to change it to:\nif (ast.getType() == TokenTypes.IMPORT) {\n  if (!allowClassImports) {\n    ...\n  }\n} else if (!allowStaticMemberImports) {\n...\n}\n\nYou agree that there is no reason for non-static imports to go to the else if as it will never be a valid reason?\nMy second idea was merging the if and else if conditions somehow and only have getNextSibling apply to static imports.", "author": "rnveach", "createdAt": "2020-03-15T19:43:50Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/imports/AvoidStarImportCheck.java", "diffHunk": "@@ -220,8 +220,7 @@ public void visitToken(final DetailAST ast) {\n             final DetailAST startingDot = ast.getFirstChild();\n             logsStarredImportViolation(startingDot);\n         }\n-        else if (!allowStaticMemberImports\n-            && ast.getType() == TokenTypes.STATIC_IMPORT) {\n+        else if (!allowStaticMemberImports) {", "originalCommit": "d66b9b006d2b7ec59bd65d47124c3d54c3d79379", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcwNTk4NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7843#discussion_r392705985", "bodyText": "You agree that there is no reason for non-static imports to go to the else if as it will never be a valid reason?\n\nI agree. It doesn't make much sense indeed. It's like we're relying on some side effect to keep things straight.\n\nMy current idea is the first if statement to change it to:\n\nI like it, it solves the problem.\n\nMy second idea was merging the if and else if conditions somehow and only have getNextSibling apply to static imports.\n\n@rnveach, I think your first idea would be more readable, plus it has the advantage to check the ast type only once.", "author": "wilcoln", "createdAt": "2020-03-15T19:47:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcwNTYzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcwOTQwMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7843#discussion_r392709401", "bodyText": "@rnveach, I wrote this new code:\npublic void visitToken(final DetailAST ast) {\n        if (ast.getType() == TokenTypes.IMPORT) {\n            if (!allowClassImports) {\n                final DetailAST startingDot = ast.getFirstChild();\n                logsStarredImportViolation(startingDot);\n            }\n        }\n        else if (!allowStaticMemberImports) {\n            // must navigate past the static keyword\n            final DetailAST startingDot = ast.getFirstChild().getNextSibling();\n            logsStarredImportViolation(startingDot);\n        }\n    }\nand it works just fine.\nLink to the new pitest report: https://wilcoln.github.io/checkstyle-reports/pit-reports/new/com.puppycrawl.tools.checkstyle.checks.imports/AvoidStarImportCheck.java.html\nI have updated my PR accordingly.", "author": "wilcoln", "createdAt": "2020-03-15T20:27:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcwNTYzNg=="}], "type": "inlineReview"}, {"oid": "04d711d18f84b72294f664890cedb9c3f8e23b3e", "url": "https://github.com/checkstyle/checkstyle/commit/04d711d18f84b72294f664890cedb9c3f8e23b3e", "message": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "committedDate": "2020-03-15T20:33:02Z", "type": "forcePushed"}, {"oid": "5608481cca631f7b8d92f9233baa0aa69eba6728", "url": "https://github.com/checkstyle/checkstyle/commit/5608481cca631f7b8d92f9233baa0aa69eba6728", "message": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "committedDate": "2020-03-15T20:33:39Z", "type": "forcePushed"}, {"oid": "4efe3b1c398dcffeb969ba287c56ceb78667266a", "url": "https://github.com/checkstyle/checkstyle/commit/4efe3b1c398dcffeb969ba287c56ceb78667266a", "message": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "committedDate": "2020-03-15T20:41:08Z", "type": "commit"}, {"oid": "4efe3b1c398dcffeb969ba287c56ceb78667266a", "url": "https://github.com/checkstyle/checkstyle/commit/4efe3b1c398dcffeb969ba287c56ceb78667266a", "message": "Issue #7799: Resolve Pitest Issues - AvoidStarImportCheck (1)", "committedDate": "2020-03-15T20:41:08Z", "type": "forcePushed"}]}