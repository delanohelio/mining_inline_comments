{"pr_number": 9083, "pr_title": "Issue #9003: nondex tool found issue in token ordering at Indentation", "pr_createdAt": "2020-12-05T19:03:47Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/9083", "timeline": [{"oid": "e5fd4174b782b1679584cef534a5c1123d07c049", "url": "https://github.com/checkstyle/checkstyle/commit/e5fd4174b782b1679584cef534a5c1123d07c049", "message": "Issue #9003: nondex tool found issue in token ordering at Indentation", "committedDate": "2020-12-07T06:43:44Z", "type": "forcePushed"}, {"oid": "da6c5f0c3034f9d44b2542d4020a570deb36dae8", "url": "https://github.com/checkstyle/checkstyle/commit/da6c5f0c3034f9d44b2542d4020a570deb36dae8", "message": "Issue #9003: nondex tool found issue in token ordering at Indentation", "committedDate": "2020-12-15T05:33:54Z", "type": "forcePushed"}, {"oid": "2e7cafb505e5c8e8737dad18bd0a3772412afa14", "url": "https://github.com/checkstyle/checkstyle/commit/2e7cafb505e5c8e8737dad18bd0a3772412afa14", "message": "Issue #9003: nondex tool found issue in token ordering at Indentation", "committedDate": "2021-01-07T23:45:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzY2Mjg5MA==", "url": "https://github.com/checkstyle/checkstyle/pull/9083#discussion_r553662890", "bodyText": "resolves FileContentsTest.testHasIntersectionEarlyOut:285 \u00bb NullPointer", "author": "nmancus1", "createdAt": "2021-01-08T00:00:29Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/api/FileContentsTest.java", "diffHunk": "@@ -280,7 +280,7 @@ public void testHasIntersectionEarlyOut() throws Exception {\n                 \"clangComments\");\n         final TextBlock textBlock = new Comment(new String[] {\"\"}, 1, 1, 1);\n         clangComments.put(1, Collections.singletonList(textBlock));\n-        clangComments.put(2, null);\n+        clangComments.put(2, Collections.emptyList());", "originalCommit": "2e7cafb505e5c8e8737dad18bd0a3772412afa14", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzY5OTYxNA==", "url": "https://github.com/checkstyle/checkstyle/pull/9083#discussion_r553699614", "bodyText": "This now causes a pitest failure.\nhttps://app.circleci.com/pipelines/github/checkstyle/checkstyle/4214/workflows/227adf91-df2d-4285-8fda-f24cbd7c8afa/jobs/69854\n+FileContents.java.html:<td class='covered'><pre><span  class='survived'>            if (hasIntersection) {</span></pre></td></tr>", "author": "rnveach", "createdAt": "2021-01-08T02:06:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzY2Mjg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzcyMzMzMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/9083#discussion_r553723331", "bodyText": "Fixed.", "author": "nmancus1", "createdAt": "2021-01-08T03:36:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzY2Mjg5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzY2MzEyNA==", "url": "https://github.com/checkstyle/checkstyle/pull/9083#discussion_r553663124", "bodyText": "all changes in this file resolve AllChecksTest.testAllCheckTokensAreReferencedInGoogleConfigFile:394->validateAllCheckTokensAreReferencedInConfigFile:451->validateDefaultTokens:479 All default tokens should be used in config for Indentation", "author": "nmancus1", "createdAt": "2021-01-08T00:01:20Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/AllChecksTest.java", "diffHunk": "@@ -471,7 +473,16 @@ private static boolean isAllTokensAcceptable(AbstractCheck check) {\n \n     private static void validateDefaultTokens(Configuration checkConfig, AbstractCheck check,\n                                               Set<String> configTokens) {\n-        if (Arrays.equals(check.getDefaultTokens(), check.getRequiredTokens())) {\n+\n+        final Set<Integer> defaultTokensSet = IntStream.of(check.getDefaultTokens())\n+            .boxed()\n+            .collect(Collectors.toSet());\n+\n+        final Set<Integer> requiredTokensSet = IntStream.of(check.getRequiredTokens())\n+            .boxed()\n+            .collect(Collectors.toSet());\n+\n+        if (defaultTokensSet.equals(requiredTokensSet)) {", "originalCommit": "2e7cafb505e5c8e8737dad18bd0a3772412afa14", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzY5ODcwNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/9083#discussion_r553698705", "bodyText": "If the other changes resolve #9083 (comment) , then why are these changes needed?", "author": "rnveach", "createdAt": "2021-01-08T02:03:14Z", "path": "src/test/java/com/puppycrawl/tools/checkstyle/internal/AllChecksTest.java", "diffHunk": "@@ -78,9 +80,9 @@\n     };\n \n     private static final Map<String, Set<String>> CHECKSTYLE_TOKENS_IN_CONFIG_TO_IGNORE =\n-            new HashMap<>();\n+            new LinkedHashMap<>();\n     private static final Map<String, Set<String>> GOOGLE_TOKENS_IN_CONFIG_TO_IGNORE =\n-            new HashMap<>();\n+            new LinkedHashMap<>();", "originalCommit": "2e7cafb505e5c8e8737dad18bd0a3772412afa14", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzcyMjM4Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/9083#discussion_r553722387", "bodyText": "They are not, thanks for catching that. Fixed.", "author": "nmancus1", "createdAt": "2021-01-08T03:33:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzY5ODcwNQ=="}], "type": "inlineReview"}, {"oid": "38c6942b1351bef6a52b931e22e9e8eb60538b00", "url": "https://github.com/checkstyle/checkstyle/commit/38c6942b1351bef6a52b931e22e9e8eb60538b00", "message": "Issue #9003: nondex tool found issue in token ordering at Indentation", "committedDate": "2021-01-08T03:27:01Z", "type": "forcePushed"}, {"oid": "d6312787f3282ee5607560d97dfe914f6cfcdf31", "url": "https://github.com/checkstyle/checkstyle/commit/d6312787f3282ee5607560d97dfe914f6cfcdf31", "message": "Issue #9003: nondex tool found issue in token ordering at Indentation", "committedDate": "2021-01-08T03:36:31Z", "type": "commit"}, {"oid": "d6312787f3282ee5607560d97dfe914f6cfcdf31", "url": "https://github.com/checkstyle/checkstyle/commit/d6312787f3282ee5607560d97dfe914f6cfcdf31", "message": "Issue #9003: nondex tool found issue in token ordering at Indentation", "committedDate": "2021-01-08T03:36:31Z", "type": "forcePushed"}]}