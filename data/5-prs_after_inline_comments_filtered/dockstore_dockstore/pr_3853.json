{"pr_number": 3853, "pr_title": "fix githubWebhookDelete() for deleting default WorkflowVersion", "pr_createdAt": "2020-10-08T20:12:01Z", "pr_url": "https://github.com/dockstore/dockstore/pull/3853", "timeline": [{"oid": "f5b96f58a330727d544137885a30fef9b8adcebb", "url": "https://github.com/dockstore/dockstore/commit/f5b96f58a330727d544137885a30fef9b8adcebb", "message": "fix githubWebhookDelete() for deleting default WorkflowVersion", "committedDate": "2020-10-08T20:03:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjAxMDA4OQ==", "url": "https://github.com/dockstore/dockstore/pull/3853#discussion_r502010089", "bodyText": "This may depend on the resolution to Louise's comment, but you should probably make this a filter/findFirst so you don't keep looping through the versions even after you've found the default.", "author": "coverbeck", "createdAt": "2020-10-08T21:01:41Z", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/resources/AbstractWorkflowResource.java", "diffHunk": "@@ -282,6 +282,13 @@ private WorkflowVersion updateDBVersionSourceFilesWithRemoteVersionSourceFiles(W\n         List<Workflow> workflows = workflowDAO.findAllByPath(\"github.com/\" + repository, false).stream().filter(workflow -> Objects.equals(workflow.getMode(), DOCKSTORE_YML)).collect(\n                 Collectors.toList());\n \n+        // When the git reference is the default version, unset the default version\n+        workflows.forEach(workflow -> {", "originalCommit": "f5b96f58a330727d544137885a30fef9b8adcebb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjAxMjUzMQ==", "url": "https://github.com/dockstore/dockstore/pull/3853#discussion_r502012531", "bodyText": "This is looping over workflows, not versions, since a git repo can have more than 1 workflow.\nDifferent workflows can have different default versions.", "author": "GFJHogue", "createdAt": "2020-10-08T21:06:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjAxMDA4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjAxNjk1NQ==", "url": "https://github.com/dockstore/dockstore/pull/3853#discussion_r502016955", "bodyText": "D'oh!", "author": "coverbeck", "createdAt": "2020-10-08T21:15:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjAxMDA4OQ=="}], "type": "inlineReview"}, {"oid": "ee82dbfa0689a0d55e8283133ca18bdc50f47463", "url": "https://github.com/dockstore/dockstore/commit/ee82dbfa0689a0d55e8283133ca18bdc50f47463", "message": "reset default to next latest version when deleting the default version", "committedDate": "2020-10-09T14:39:43Z", "type": "commit"}, {"oid": "c1e5267c91ffcbff4045d3513d57f7cd6f4dd323", "url": "https://github.com/dockstore/dockstore/commit/c1e5267c91ffcbff4045d3513d57f7cd6f4dd323", "message": "Merge branch 'develop' into feature/3796/githubapp-delete-default-version", "committedDate": "2020-10-09T14:40:08Z", "type": "commit"}, {"oid": "612fd32d9a09e13a61bef592599f54bdbe94bc3f", "url": "https://github.com/dockstore/dockstore/commit/612fd32d9a09e13a61bef592599f54bdbe94bc3f", "message": "Merge branch 'develop' into feature/3796/githubapp-delete-default-version", "committedDate": "2020-10-09T19:53:03Z", "type": "commit"}]}