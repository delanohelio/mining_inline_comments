{"pr_number": 524, "pr_title": "remove test cache code for SM2Signer", "pr_createdAt": "2020-03-05T14:54:58Z", "pr_url": "https://github.com/FISCO-BCOS/web3sdk/pull/524", "timeline": [{"oid": "8682d3a1da20702042955c0d6d56c505f7d32c51", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/8682d3a1da20702042955c0d6d56c505f7d32c51", "message": "remove test cache code for SM2Signer", "committedDate": "2020-03-05T15:13:47Z", "type": "commit"}, {"oid": "8682d3a1da20702042955c0d6d56c505f7d32c51", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/8682d3a1da20702042955c0d6d56c505f7d32c51", "message": "remove test cache code for SM2Signer", "committedDate": "2020-03-05T15:13:47Z", "type": "forcePushed"}, {"oid": "08476ab2e960e31682d07f68fbf8701c8b0c527c", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/08476ab2e960e31682d07f68fbf8701c8b0c527c", "message": "close writer stream when PerformanceTest", "committedDate": "2020-03-05T16:05:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODM5NTM4Mg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/524#discussion_r388395382", "bodyText": "[PMD] Found 'DU'-anomaly for variable 'writer' (lines '561'-'684'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.21.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can mark this issue as closed if you should not tackle it. (see our document about issues)", "author": "sider", "createdAt": "2020-03-05T16:07:15Z", "path": "src/test/java/org/fisco/bcos/channel/test/parallel/precompile/PerformanceDTTest.java", "diffHunk": "@@ -386,53 +385,47 @@\n                         + \" ,sps = \"\n                         + (totalSignedTxCount.intValue() / elapsed));\n \n-        System.out.println(\"\");\n-\n-        if (SM2Sign.isOpenSM2SignerCache()) {\n-            System.out.println(\"SM2Signer Object Count => \" + SM2Sign.getsM2SignerCache().size());\n-        }\n-\n         System.exit(0);\n     }\n \n~    public void userTransferTest(BigInteger count, BigInteger qps, BigInteger deci) {\n~        System.out.println(\"Start UserTransfer test...\");\n~        System.out.println(\"===================================================================\");\n~\n~        String dirName = \"./.signed_transactions\";\n~        File dir = new File(dirName);\n~        if (dir.exists()) {\n~            File[] fileList = dir.listFiles();\n~            for (File file : fileList) {\n~                if (!file.delete()) {\n~                    System.out.printf(\"Can't clean %s%n\", dirName);\n~                    System.exit(0);\n~                }\n~            }\n~        } else {\n~            if (!dir.mkdir()) {\n~                System.out.printf(\"Can't create directory %s%n\", dirName);\n~                System.exit(0);\n~            }\n~        }\n~\n~        try {\n~            System.out.println(dateFormat.format(new Date()) + \" Querying account state...\");\n~", "originalCommit": "08476ab2e960e31682d07f68fbf8701c8b0c527c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODM5NTM5MA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/524#discussion_r388395390", "bodyText": "[PMD] Assigning an Object to null is a code smell.  Consider refactoring. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nNullAssignment\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.21.0/pmd_rules_java_errorprone.html#nullassignment\n\nYou can mark this issue as closed if you should not tackle it. (see our document about issues)", "author": "sider", "createdAt": "2020-03-05T16:07:16Z", "path": "src/test/java/org/fisco/bcos/channel/test/parallel/precompile/PerformanceDTTest.java", "diffHunk": "@@ -386,53 +385,47 @@\n                         + \" ,sps = \"\n                         + (totalSignedTxCount.intValue() / elapsed));\n \n-        System.out.println(\"\");\n-\n-        if (SM2Sign.isOpenSM2SignerCache()) {\n-            System.out.println(\"SM2Signer Object Count => \" + SM2Sign.getsM2SignerCache().size());\n-        }\n-\n         System.exit(0);\n     }\n \n~    public void userTransferTest(BigInteger count, BigInteger qps, BigInteger deci) {\n~        System.out.println(\"Start UserTransfer test...\");\n~        System.out.println(\"===================================================================\");\n~\n~        String dirName = \"./.signed_transactions\";\n~        File dir = new File(dirName);\n~        if (dir.exists()) {\n~            File[] fileList = dir.listFiles();\n~            for (File file : fileList) {\n~                if (!file.delete()) {\n~                    System.out.printf(\"Can't clean %s%n\", dirName);\n~                    System.exit(0);\n~                }\n~            }\n~        } else {\n~            if (!dir.mkdir()) {\n~                System.out.printf(\"Can't create directory %s%n\", dirName);\n~                System.exit(0);\n~            }\n~        }\n~\n~        try {\n~            System.out.println(dateFormat.format(new Date()) + \" Querying account state...\");\n~", "originalCommit": "08476ab2e960e31682d07f68fbf8701c8b0c527c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODM5NTQwMw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/524#discussion_r388395403", "bodyText": "[PMD] Avoid instantiating new objects inside loops (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidInstantiatingObjectsInLoops\nPerformance\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.21.0/pmd_rules_java_performance.html#avoidinstantiatingobjectsinloops\n\nYou can mark this issue as closed if you should not tackle it. (see our document about issues)", "author": "sider", "createdAt": "2020-03-05T16:07:17Z", "path": "src/test/java/org/fisco/bcos/channel/test/parallel/precompile/PerformanceDTTest.java", "diffHunk": "@@ -386,53 +385,47 @@\n                         + \" ,sps = \"\n                         + (totalSignedTxCount.intValue() / elapsed));\n \n-        System.out.println(\"\");\n-\n-        if (SM2Sign.isOpenSM2SignerCache()) {\n-            System.out.println(\"SM2Signer Object Count => \" + SM2Sign.getsM2SignerCache().size());\n-        }\n-\n         System.exit(0);\n     }\n \n~    public void userTransferTest(BigInteger count, BigInteger qps, BigInteger deci) {\n~        System.out.println(\"Start UserTransfer test...\");\n~        System.out.println(\"===================================================================\");\n~\n~        String dirName = \"./.signed_transactions\";\n~        File dir = new File(dirName);", "originalCommit": "08476ab2e960e31682d07f68fbf8701c8b0c527c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODM5NTQxNg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/524#discussion_r388395416", "bodyText": "[PMD] Found 'DD'-anomaly for variable 'writer' (lines '561'-'484'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.21.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can mark this issue as closed if you should not tackle it. (see our document about issues)", "author": "sider", "createdAt": "2020-03-05T16:07:18Z", "path": "src/test/java/org/fisco/bcos/channel/test/parallel/precompile/PerformanceDTTest.java", "diffHunk": "@@ -386,53 +385,47 @@\n                         + \" ,sps = \"\n                         + (totalSignedTxCount.intValue() / elapsed));\n \n-        System.out.println(\"\");\n-\n-        if (SM2Sign.isOpenSM2SignerCache()) {\n-            System.out.println(\"SM2Signer Object Count => \" + SM2Sign.getsM2SignerCache().size());\n-        }\n-\n         System.exit(0);\n     }\n \n~    public void userTransferTest(BigInteger count, BigInteger qps, BigInteger deci) {\n~        System.out.println(\"Start UserTransfer test...\");\n~        System.out.println(\"===================================================================\");\n~\n~        String dirName = \"./.signed_transactions\";\n~        File dir = new File(dirName);\n~        if (dir.exists()) {\n~            File[] fileList = dir.listFiles();\n~            for (File file : fileList) {\n~                if (!file.delete()) {\n~                    System.out.printf(\"Can't clean %s%n\", dirName);\n~                    System.exit(0);\n~                }\n~            }\n~        } else {\n~            if (!dir.mkdir()) {\n~                System.out.printf(\"Can't create directory %s%n\", dirName);\n~                System.exit(0);\n~            }\n~        }\n~\n~        try {\n~            System.out.println(dateFormat.format(new Date()) + \" Querying account state...\");\n~", "originalCommit": "08476ab2e960e31682d07f68fbf8701c8b0c527c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}