{"pr_number": 2683, "pr_title": "Add defaults to FilePropertiesStack", "pr_createdAt": "2020-08-08T13:05:19Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2683", "timeline": [{"oid": "6e6501d9f2168bfac6a254059db8d390842008aa", "url": "https://github.com/GoogleContainerTools/jib/commit/6e6501d9f2168bfac6a254059db8d390842008aa", "message": "Add defaults to FilePropertiesStack", "committedDate": "2020-08-10T19:01:06Z", "type": "commit"}, {"oid": "cbacfaf70c4de4fd71545cf964eacb903a6db508", "url": "https://github.com/GoogleContainerTools/jib/commit/cbacfaf70c4de4fd71545cf964eacb903a6db508", "message": "remove unnecessary nullable", "committedDate": "2020-08-10T19:01:06Z", "type": "commit"}, {"oid": "cbacfaf70c4de4fd71545cf964eacb903a6db508", "url": "https://github.com/GoogleContainerTools/jib/commit/cbacfaf70c4de4fd71545cf964eacb903a6db508", "message": "remove unnecessary nullable", "committedDate": "2020-08-10T19:01:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE1MjM5NA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2683#discussion_r468152394", "bodyText": "Now that ownership is not nullable, How about\n  ownership = (user != null ? user : \"\") + (group != null ? \":\" + group : \"\")?\nor\n  ownership = user != null ? user : \"\";\n  if (group != null) {\n    ownership += \":\" + group;\n  }\n? Your preference.", "author": "chanseokoh", "createdAt": "2020-08-10T20:08:28Z", "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/buildfile/FilePropertiesStack.java", "diffHunk": "@@ -76,7 +86,9 @@ private void updateProperties() {\n       group = properties.getGroup().orElse(group);\n     }\n     // ownership calculations\n-    if (group == null) {\n+    if (group == null && user == null) {", "originalCommit": "cbacfaf70c4de4fd71545cf964eacb903a6db508", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI1ODYzNA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2683#discussion_r468258634", "bodyText": "yeah these look better, lemme update", "author": "loosebazooka", "createdAt": "2020-08-11T00:30:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE1MjM5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5MDk1Mg==", "url": "https://github.com/GoogleContainerTools/jib/pull/2683#discussion_r468190952", "bodyText": "Do we need another release? 0.5.0? I don't recall new changes since 0.4.0.", "author": "chanseokoh", "createdAt": "2020-08-10T21:17:05Z", "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/buildfile/FilePropertiesStack.java", "diffHunk": "@@ -34,10 +34,23 @@\n   // TODO perhaps use a fixed size list here\n   private final List<FilePropertiesSpec> stack = new ArrayList<>(3);\n \n-  @Nullable private FilePermissions filePermissions;\n-  @Nullable private FilePermissions directoryPermissions;\n-  @Nullable private Instant modificationTime;\n-  @Nullable private String ownership;\n+  private FilePermissions filePermissions;\n+  private FilePermissions directoryPermissions;\n+  private Instant modificationTime;\n+  private String ownership;\n+\n+  /** Create new FilePropertiesStack with defaults. */\n+  public FilePropertiesStack() {\n+    setDefaults();\n+  }\n+\n+  private void setDefaults() {\n+    filePermissions = FilePermissions.DEFAULT_FILE_PERMISSIONS;\n+    directoryPermissions = FilePermissions.DEFAULT_FOLDER_PERMISSIONS;\n+    modificationTime = FileEntriesLayer.DEFAULT_MODIFICATION_TIME;\n+    // TODO: get default from FileEntriesLayer (requires buildplan release)", "originalCommit": "cbacfaf70c4de4fd71545cf964eacb903a6db508", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI1ODU3NA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2683#discussion_r468258574", "bodyText": "I mean if we were to define a default in the build plan, this would be required.", "author": "loosebazooka", "createdAt": "2020-08-11T00:29:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5MDk1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI1OTc4MA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2683#discussion_r468259780", "bodyText": "The thing is, I think there might be some other minor additions to the buildplan that might come up, so we can hold off on this.", "author": "loosebazooka", "createdAt": "2020-08-11T00:34:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5MDk1Mg=="}], "type": "inlineReview"}, {"oid": "055bb5ee788352bf959eed6a0a18c2009040dbf9", "url": "https://github.com/GoogleContainerTools/jib/commit/055bb5ee788352bf959eed6a0a18c2009040dbf9", "message": "reorganize ownership computation", "committedDate": "2020-08-11T00:33:13Z", "type": "commit"}]}