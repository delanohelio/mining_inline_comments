{"pr_number": 1099, "pr_title": "FINERACT-822 Enforce UndefinedEquals check", "pr_createdAt": "2020-06-21T08:28:31Z", "pr_url": "https://github.com/apache/fineract/pull/1099", "timeline": [{"oid": "8d4774f559a18b18722b9553fca715d3ec883a3c", "url": "https://github.com/apache/fineract/commit/8d4774f559a18b18722b9553fca715d3ec883a3c", "message": "FINERACT-822 Enforce UndefinedEquals check", "committedDate": "2020-06-21T07:59:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc0MTkyMw==", "url": "https://github.com/apache/fineract/pull/1099#discussion_r443741923", "bodyText": "Just curious about this:\nHow is other.entryDate.compareTo(entryDate) == 0 ? Boolean.TRUE: Boolean.FALSE\ndIfferent from just  other.entryDate.compareTo(entryDate) == 0   (In terms of end result) of the boolean?\nIs it because .equals returns Boolean.TRUE and not primitive data-type boolean?", "author": "thesmallstar", "createdAt": "2020-06-22T18:15:31Z", "path": "fineract-provider/src/main/java/org/apache/fineract/accounting/glaccount/domain/TrialBalance.java", "diffHunk": "@@ -100,8 +100,9 @@ public boolean equals(Object obj) {\n         }\n         TrialBalance other = (TrialBalance) obj;\n         return Objects.equals(other.officeId, officeId) && Objects.equals(other.glAccountId, glAccountId)\n-                && Objects.equals(other.amount, amount) && Objects.equals(other.entryDate, entryDate)\n-                && Objects.equals(other.transactionDate, transactionDate) && Objects.equals(other.closingBalance, closingBalance);\n+                && Objects.equals(other.amount, amount) && other.entryDate.compareTo(entryDate) == 0 ? Boolean.TRUE\n+                        : Boolean.FALSE && other.transactionDate.compareTo(transactionDate) == 0 ? Boolean.TRUE", "originalCommit": "8d4774f559a18b18722b9553fca715d3ec883a3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkzNzQ0OA==", "url": "https://github.com/apache/fineract/pull/1099#discussion_r443937448", "bodyText": "compareTo returns an int. If values to be compared are equal, the value returned is zero.", "author": "percyashu", "createdAt": "2020-06-23T03:14:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc0MTkyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDExNDczMw==", "url": "https://github.com/apache/fineract/pull/1099#discussion_r444114733", "bodyText": "Agreed, so if other.entryDate.compareTo(entryDate) == 0 is executed, then 0 == 0 returns true, which is boolean.\nSorry if I am confusing, I am not able to understand the need for the\n?Boolean.TRUE: Boolean.FALSE  part.", "author": "thesmallstar", "createdAt": "2020-06-23T10:12:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc0MTkyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE1MjIzMw==", "url": "https://github.com/apache/fineract/pull/1099#discussion_r444152233", "bodyText": "This is just like a Java If statement where other.entryDate.compareTo(entryDate) == 0 is the condition, the first value Boolean.TRUE is return if the condition is true and the second value Boolean.FALSE if it is false. Could have used an If statement but this is shorter. See this", "author": "percyashu", "createdAt": "2020-06-23T11:27:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc0MTkyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5MzgzOQ==", "url": "https://github.com/apache/fineract/pull/1099#discussion_r444493839", "bodyText": "@percyashu what @thesmallstar is pointing out here, and I agree with, is that ? Boolean.TRUE: Boolean.FALSE is not required - as he said, just other.entryDate.compareTo(entryDate) == 0 yields exactly the same value. The difference between primitive VS non-primitive is hidden by \"auto boxing\". Do you want to raise a follow-up PR to clean this up, or ignore this?", "author": "vorburger", "createdAt": "2020-06-23T20:41:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc0MTkyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc0NDI4Ng==", "url": "https://github.com/apache/fineract/pull/1099#discussion_r443744286", "bodyText": "very very minor suggestion, can we not keep it just !=0 (this makes it little confusing IMO).", "author": "thesmallstar", "createdAt": "2020-06-22T18:20:03Z", "path": "fineract-provider/src/main/java/org/apache/fineract/portfolio/shareaccounts/domain/ShareAccount.java", "diffHunk": "@@ -224,7 +224,7 @@ public boolean setSubmittedDate(final Date submittedDate) {\n \n     public boolean setApprovedDate(final Date approvedDate) {\n         boolean toReturn = false;\n-        if (!this.approvedDate.equals(approvedDate)) {\n+        if (this.approvedDate.compareTo(approvedDate) == 0 ? Boolean.FALSE : Boolean.TRUE) {\n             this.approvedDate = approvedDate;", "originalCommit": "8d4774f559a18b18722b9553fca715d3ec883a3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkzNzQ2MQ==", "url": "https://github.com/apache/fineract/pull/1099#discussion_r443937461", "bodyText": "Yeah, but I think this way is clearer.", "author": "percyashu", "createdAt": "2020-06-23T03:14:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc0NDI4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDAzNDExOA==", "url": "https://github.com/apache/fineract/pull/1099#discussion_r444034118", "bodyText": "@percyashu I don't understand this... given that entryDate and transactionDate are (both) java.util.Date, why is Objects.equals() not OK? That does not match what https://errorprone.info/bugpattern/UndefinedEquals seems to be about... what am I missing?", "author": "vorburger", "createdAt": "2020-06-23T07:57:48Z", "path": "fineract-provider/src/main/java/org/apache/fineract/accounting/glaccount/domain/TrialBalance.java", "diffHunk": "@@ -100,8 +100,9 @@ public boolean equals(Object obj) {\n         }\n         TrialBalance other = (TrialBalance) obj;\n         return Objects.equals(other.officeId, officeId) && Objects.equals(other.glAccountId, glAccountId)\n-                && Objects.equals(other.amount, amount) && Objects.equals(other.entryDate, entryDate)\n-                && Objects.equals(other.transactionDate, transactionDate) && Objects.equals(other.closingBalance, closingBalance);\n+                && Objects.equals(other.amount, amount) && other.entryDate.compareTo(entryDate) == 0 ? Boolean.TRUE", "originalCommit": "8d4774f559a18b18722b9553fca715d3ec883a3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE0NTg3Ng==", "url": "https://github.com/apache/fineract/pull/1099#discussion_r444145876", "bodyText": "Error Prone kept complaining java.util.Date equals() doesn't seem to work as expected. This is because from this two Date objects are equal if and only if the getTime method returns the same long value for both.", "author": "percyashu", "createdAt": "2020-06-23T11:13:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDAzNDExOA=="}], "type": "inlineReview"}, {"oid": "c1795825e18fa9c241068057806dcc0d547df4d5", "url": "https://github.com/apache/fineract/commit/c1795825e18fa9c241068057806dcc0d547df4d5", "message": "Merge branch 'develop' into UndefinedEquals", "committedDate": "2020-06-23T11:15:41Z", "type": "commit"}]}