{"pr_number": 579, "pr_title": "Add draggable graphics to Update Graphics sample", "pr_createdAt": "2020-10-27T17:18:19Z", "pr_url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579", "timeline": [{"oid": "5cebfbe9abf260dff1d76e20b6abfc08d441c9b2", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/5cebfbe9abf260dff1d76e20b6abfc08d441c9b2", "message": "Add draggable graphic", "committedDate": "2020-10-27T11:57:45Z", "type": "commit"}, {"oid": "c0641a547bfeb452d108633de3a6f853d06c4f6e", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/c0641a547bfeb452d108633de3a6f853d06c4f6e", "message": "Update readme, gif, screenshot", "committedDate": "2020-10-27T16:18:20Z", "type": "commit"}, {"oid": "7c54375734148212a412c81ed9046418e0bf521a", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/7c54375734148212a412c81ed9046418e0bf521a", "message": "Add Esc key action", "committedDate": "2020-10-27T16:24:10Z", "type": "commit"}, {"oid": "a6984626acd71156cc5d019042bd53e7f4a33591", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/a6984626acd71156cc5d019042bd53e7f4a33591", "message": "Remove unused boolean", "committedDate": "2020-10-27T16:24:29Z", "type": "commit"}, {"oid": "919f7daa5526c12159c970e1711fd7e78be5cb27", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/919f7daa5526c12159c970e1711fd7e78be5cb27", "message": "Reorder point", "committedDate": "2020-10-27T16:26:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI1NTQ2OA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r513255468", "bodyText": "While we're at it, lets make these comments plain English?\nPeraps // create the combo box for the UI?", "author": "JonLavi", "createdAt": "2020-10-28T08:24:02Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -90,18 +92,15 @@ public void start(Stage stage) {\n       controlsVBox.setBackground(new Background(new BackgroundFill(Paint.valueOf(\"rgba(0,0,0,0.3)\"), CornerRadii.EMPTY,\n               Insets.EMPTY)));\n       controlsVBox.setPadding(new Insets(10.0));\n-      controlsVBox.setMaxSize(180, 150);\n+      controlsVBox.setMaxSize(180, 100);\n       controlsVBox.getStyleClass().add(\"panel-region\");\n \n       // create buttons for user interaction\n-      updateLocationButton = new Button(\"Update Location\");\n       updateDescriptionButton = new Button(\"Update Description\");\n-      updateLocationButton.setMaxWidth(Double.MAX_VALUE);\n       updateDescriptionButton.setMaxWidth(Double.MAX_VALUE);\n-      updateLocationButton.setDisable(true);\n       updateDescriptionButton.setDisable(true);\n \n-      // create section for combo box\n+      // create combo box", "originalCommit": "919f7daa5526c12159c970e1711fd7e78be5cb27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI1NTY3NA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r513255674", "bodyText": "Another suggestion for plain english? Also, we only have one button now, by the looks of it? Would also be nice to order the items in the comment in the same order as they are in the code:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  // add label, combo box and buttons to the control panel\n          \n          \n            \n                  // add the button, label, and combo box to the control panel", "author": "JonLavi", "createdAt": "2020-10-28T08:24:23Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -117,8 +116,8 @@ public void start(Stage stage) {\n         }\n       });\n \n-      // add label, dropdown and buttons to the control panel\n-      controlsVBox.getChildren().addAll(updateLocationButton, updateDescriptionButton, symbolLabel, symbolBox);\n+      // add label, combo box and buttons to the control panel", "originalCommit": "919f7daa5526c12159c970e1711fd7e78be5cb27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI1NzA2MA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r513257060", "bodyText": "Good catch on renaming this, definitely makes more sense \ud83d\udc4d", "author": "JonLavi", "createdAt": "2020-10-28T08:26:49Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -260,10 +281,14 @@ private void createGraphics() {\n     }\n   }\n \n-  private void enableUI(boolean enable) {\n-    updateDescriptionButton.setDisable(enable);\n-    updateLocationButton.setDisable(enable);\n-    symbolBox.setDisable(enable);\n+  /**\n+   * Disables the visibility of the UI controls\n+   *\n+   * @param disable visibility of the UI\n+   */\n+  private void disableUI(boolean disable) {", "originalCommit": "919f7daa5526c12159c970e1711fd7e78be5cb27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI1ODM0OQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r513258349", "bodyText": "It looks like we need a null check here, to avoid a NullPointerException when no graphics is selected and we're dragging around:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (selectedGraphic.isSelected()) {\n          \n          \n            \n                    if (selectedGraphic != null && selectedGraphic.isSelected()) {", "author": "JonLavi", "createdAt": "2020-10-28T08:29:11Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -167,39 +159,68 @@ public void start(Stage stage) {\n \n       mapView.setOnMouseClicked(e -> {\n         if (e.getButton() == MouseButton.PRIMARY && e.isStillSincePress()) {\n+\n           // clear any selected graphic\n           graphicsOverlay.clearSelection();\n \n+          // set the cursor to default\n+          mapView.setCursor(Cursor.DEFAULT);\n+\n           // create a point from location clicked\n-          Point2D mapViewPoint = new Point2D(e.getX(), e.getY());\n-\n-          if (isUpdateLocationActive) {\n-            // add new location to selected graphic\n-            Point mapPoint = mapView.screenToLocation(mapViewPoint);\n-            selectedGraphic.setGeometry(mapPoint);\n-            isUpdateLocationActive = false;\n-          } else {\n-            // identify the graphic that was selected\n-            identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n-\n-            identifyGraphics.addDoneListener(() -> {\n-              try {\n-                if (!identifyGraphics.get().getGraphics().isEmpty()) {\n-                  // store the selected graphic\n-                  selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n-                  selectedGraphic.setSelected(true);\n-                  String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n-                  symbolBox.getSelectionModel().select(style);\n-\n-                  enableUI(false);\n-                } else {\n-                  enableUI(true);\n-                }\n-              } catch (Exception x) {\n-                new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+          mapViewPoint = new Point2D(e.getX(), e.getY());\n+\n+          // identify graphics on the graphics overlay\n+          identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n+\n+          identifyGraphics.addDoneListener(() -> {\n+            try {\n+              if (!identifyGraphics.get().getGraphics().isEmpty()) {\n+                // get the first identified graphic\n+                selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n+                // select the identified graphic\n+                selectedGraphic.setSelected(true);\n+                // update the drop down box with the identified graphic's current symbol\n+                String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n+                symbolBox.getSelectionModel().select(style);\n+                // show the UI\n+                disableUI(false);\n+              } else {\n+                disableUI(true);\n               }\n-            });\n-          }\n+            } catch (Exception x) {\n+              new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+            }\n+          });\n+        }\n+      });\n+\n+      mapView.setOnMouseDragged(e -> {\n+        if (selectedGraphic.isSelected()) {", "originalCommit": "919f7daa5526c12159c970e1711fd7e78be5cb27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI1OTY4MA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r513259680", "bodyText": "It would be really cool if we could identify any potential graphic at the clicked point, select it, and then allow to drag if the mouse pointer is held down. We might be able to do that by extracting a method e.g. identifyGraphicAtClickedPoint, and then allowing to select it. Could be a bit tricky to do it elegantly, so I would suggest don't spend too much time on it if the code starts growing arms and legs!", "author": "JonLavi", "createdAt": "2020-10-28T08:31:26Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -167,39 +159,68 @@ public void start(Stage stage) {\n \n       mapView.setOnMouseClicked(e -> {\n         if (e.getButton() == MouseButton.PRIMARY && e.isStillSincePress()) {\n+\n           // clear any selected graphic\n           graphicsOverlay.clearSelection();\n \n+          // set the cursor to default\n+          mapView.setCursor(Cursor.DEFAULT);\n+\n           // create a point from location clicked\n-          Point2D mapViewPoint = new Point2D(e.getX(), e.getY());\n-\n-          if (isUpdateLocationActive) {\n-            // add new location to selected graphic\n-            Point mapPoint = mapView.screenToLocation(mapViewPoint);\n-            selectedGraphic.setGeometry(mapPoint);\n-            isUpdateLocationActive = false;\n-          } else {\n-            // identify the graphic that was selected\n-            identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n-\n-            identifyGraphics.addDoneListener(() -> {\n-              try {\n-                if (!identifyGraphics.get().getGraphics().isEmpty()) {\n-                  // store the selected graphic\n-                  selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n-                  selectedGraphic.setSelected(true);\n-                  String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n-                  symbolBox.getSelectionModel().select(style);\n-\n-                  enableUI(false);\n-                } else {\n-                  enableUI(true);\n-                }\n-              } catch (Exception x) {\n-                new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+          mapViewPoint = new Point2D(e.getX(), e.getY());\n+\n+          // identify graphics on the graphics overlay\n+          identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n+\n+          identifyGraphics.addDoneListener(() -> {\n+            try {\n+              if (!identifyGraphics.get().getGraphics().isEmpty()) {\n+                // get the first identified graphic\n+                selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n+                // select the identified graphic\n+                selectedGraphic.setSelected(true);\n+                // update the drop down box with the identified graphic's current symbol\n+                String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n+                symbolBox.getSelectionModel().select(style);\n+                // show the UI\n+                disableUI(false);\n+              } else {\n+                disableUI(true);\n               }\n-            });\n-          }\n+            } catch (Exception x) {\n+              new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+            }\n+          });\n+        }\n+      });\n+\n+      mapView.setOnMouseDragged(e -> {", "originalCommit": "919f7daa5526c12159c970e1711fd7e78be5cb27", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI2MjczNA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r518262734", "bodyText": "@sclaridge perhaps Jon's suggestion combined with my attempt below might work? Like Jon says though, don't spend too long on it, we have a workable solution from the first suggestion I put up.", "author": "Rachael-E", "createdAt": "2020-11-05T18:13:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI1OTY4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI2NjA4Ng==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r513266086", "bodyText": "Ideally we should be enabling the UI again after we stop dragging, because the graphics is still selected and the user might want to update it's properties?\nStrictly speaking, we don't have to disable the UI while dragging at all, since we have to stop dragging anyway to interact with the UI properly? Might be worth a play around with it just to see which works best.", "author": "JonLavi", "createdAt": "2020-10-28T08:42:36Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -167,39 +159,68 @@ public void start(Stage stage) {\n \n       mapView.setOnMouseClicked(e -> {\n         if (e.getButton() == MouseButton.PRIMARY && e.isStillSincePress()) {\n+\n           // clear any selected graphic\n           graphicsOverlay.clearSelection();\n \n+          // set the cursor to default\n+          mapView.setCursor(Cursor.DEFAULT);\n+\n           // create a point from location clicked\n-          Point2D mapViewPoint = new Point2D(e.getX(), e.getY());\n-\n-          if (isUpdateLocationActive) {\n-            // add new location to selected graphic\n-            Point mapPoint = mapView.screenToLocation(mapViewPoint);\n-            selectedGraphic.setGeometry(mapPoint);\n-            isUpdateLocationActive = false;\n-          } else {\n-            // identify the graphic that was selected\n-            identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n-\n-            identifyGraphics.addDoneListener(() -> {\n-              try {\n-                if (!identifyGraphics.get().getGraphics().isEmpty()) {\n-                  // store the selected graphic\n-                  selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n-                  selectedGraphic.setSelected(true);\n-                  String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n-                  symbolBox.getSelectionModel().select(style);\n-\n-                  enableUI(false);\n-                } else {\n-                  enableUI(true);\n-                }\n-              } catch (Exception x) {\n-                new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+          mapViewPoint = new Point2D(e.getX(), e.getY());\n+\n+          // identify graphics on the graphics overlay\n+          identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n+\n+          identifyGraphics.addDoneListener(() -> {\n+            try {\n+              if (!identifyGraphics.get().getGraphics().isEmpty()) {\n+                // get the first identified graphic\n+                selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n+                // select the identified graphic\n+                selectedGraphic.setSelected(true);\n+                // update the drop down box with the identified graphic's current symbol\n+                String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n+                symbolBox.getSelectionModel().select(style);\n+                // show the UI\n+                disableUI(false);\n+              } else {\n+                disableUI(true);\n               }\n-            });\n-          }\n+            } catch (Exception x) {\n+              new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+            }\n+          });\n+        }\n+      });\n+\n+      mapView.setOnMouseDragged(e -> {\n+        if (selectedGraphic.isSelected()) {\n+          // set the cursor to the move\n+          mapView.setCursor(Cursor.MOVE);\n+\n+          // disable to UI while moving the graphic\n+          disableUI(true);", "originalCommit": "919f7daa5526c12159c970e1711fd7e78be5cb27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI3MTg0OA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r513271848", "bodyText": "@Rachael-E on the line below we have the comment regarding keeping map in scope to avoid garbage collection. I can't see any part of the code where this might happen here? The only async operation is on mapView:\nmapView.identifyGraphicsOverlayAsync\n\nWas it decided to leave these comments in as a standard, or can we remove this one and make map a local member?", "author": "JonLavi", "createdAt": "2020-10-28T08:52:06Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -51,9 +54,7 @@\n \n public class UpdateGraphicsSample extends Application {\n \n-  private boolean isUpdateLocationActive;\n   private List<SimpleMarkerSymbol> markers;\n-  private Button updateLocationButton;\n   private Button updateDescriptionButton;\n   private ComboBox<String> symbolBox;\n ", "originalCommit": "919f7daa5526c12159c970e1711fd7e78be5cb27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI4Njc2NQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r513286765", "bodyText": "I had to look this one up a bit. Not sure which element of the SV takes focus away from the map view, but I don't think we should include the code in the sample if it's just a workaround for the SV. Can't provide an alternative off the top of my head, but we might want to do a session to check what we can do to avoid adding it here.", "author": "JonLavi", "createdAt": "2020-10-28T09:16:04Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -167,39 +159,68 @@ public void start(Stage stage) {\n \n       mapView.setOnMouseClicked(e -> {\n         if (e.getButton() == MouseButton.PRIMARY && e.isStillSincePress()) {\n+\n           // clear any selected graphic\n           graphicsOverlay.clearSelection();\n \n+          // set the cursor to default\n+          mapView.setCursor(Cursor.DEFAULT);\n+\n           // create a point from location clicked\n-          Point2D mapViewPoint = new Point2D(e.getX(), e.getY());\n-\n-          if (isUpdateLocationActive) {\n-            // add new location to selected graphic\n-            Point mapPoint = mapView.screenToLocation(mapViewPoint);\n-            selectedGraphic.setGeometry(mapPoint);\n-            isUpdateLocationActive = false;\n-          } else {\n-            // identify the graphic that was selected\n-            identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n-\n-            identifyGraphics.addDoneListener(() -> {\n-              try {\n-                if (!identifyGraphics.get().getGraphics().isEmpty()) {\n-                  // store the selected graphic\n-                  selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n-                  selectedGraphic.setSelected(true);\n-                  String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n-                  symbolBox.getSelectionModel().select(style);\n-\n-                  enableUI(false);\n-                } else {\n-                  enableUI(true);\n-                }\n-              } catch (Exception x) {\n-                new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+          mapViewPoint = new Point2D(e.getX(), e.getY());\n+\n+          // identify graphics on the graphics overlay\n+          identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n+\n+          identifyGraphics.addDoneListener(() -> {\n+            try {\n+              if (!identifyGraphics.get().getGraphics().isEmpty()) {\n+                // get the first identified graphic\n+                selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n+                // select the identified graphic\n+                selectedGraphic.setSelected(true);\n+                // update the drop down box with the identified graphic's current symbol\n+                String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n+                symbolBox.getSelectionModel().select(style);\n+                // show the UI\n+                disableUI(false);\n+              } else {\n+                disableUI(true);\n               }\n-            });\n-          }\n+            } catch (Exception x) {\n+              new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+            }\n+          });\n+        }\n+      });\n+\n+      mapView.setOnMouseDragged(e -> {\n+        if (selectedGraphic.isSelected()) {\n+          // set the cursor to the move\n+          mapView.setCursor(Cursor.MOVE);\n+\n+          // disable to UI while moving the graphic\n+          disableUI(true);\n+\n+          // create a point from the dragged location\n+          mapViewPoint = new Point2D(e.getX(), e.getY());\n+          Point mapPoint = mapView.screenToLocation(mapViewPoint);\n+\n+          // update the location of the graphic to the dragged location\n+          selectedGraphic.setGeometry(mapPoint);\n+          mapView.requestFocus();", "originalCommit": "919f7daa5526c12159c970e1711fd7e78be5cb27", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ4OTQ5Nw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r514489497", "bodyText": "Based on this link, for key events the target is the node that has focus, but for mouse events the target is the node at the location of the cursor. I tried to use stackpane.onKeyPressed() like the Create and Save KML File sample, but I didn't have any luck.\nWould you recommended scrapping the ESC key functionality? A second click will de-select and stop moving the point.", "author": "sclaridge", "createdAt": "2020-10-29T18:48:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI4Njc2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDkzNzk4Nw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r514937987", "bodyText": "That's probably a good idea, considering the ESC functionality it an added bonus, but that extra line of code is a bit confusing!", "author": "JonLavi", "createdAt": "2020-10-30T08:28:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI4Njc2NQ=="}], "type": "inlineReview"}, {"oid": "05f74bfb173c7e23d9a095f21cddfb44226d886b", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/05f74bfb173c7e23d9a095f21cddfb44226d886b", "message": "Fix comments", "committedDate": "2020-10-29T11:09:25Z", "type": "commit"}, {"oid": "88614e6e740d7c107e1f907067dae59ce9a66a65", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/88614e6e740d7c107e1f907067dae59ce9a66a65", "message": "Update README.md", "committedDate": "2020-10-29T14:24:05Z", "type": "commit"}, {"oid": "b12fb6bcd8303c26d7177c69dc429f369802e3a1", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/b12fb6bcd8303c26d7177c69dc429f369802e3a1", "message": "Add changes from PR", "committedDate": "2020-10-30T12:33:25Z", "type": "commit"}, {"oid": "89dcbb6fb1cc1a51ef441a14b679c091109a9d01", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/89dcbb6fb1cc1a51ef441a14b679c091109a9d01", "message": "Update README.md", "committedDate": "2020-10-30T12:51:31Z", "type": "commit"}, {"oid": "98f9cec421138790200b1fb4560e90370b321986", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/98f9cec421138790200b1fb4560e90370b321986", "message": "Add back comments", "committedDate": "2020-10-30T12:55:09Z", "type": "commit"}, {"oid": "045dbcef294ac0a0ba2e5ccc4e31b7c198747e5b", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/045dbcef294ac0a0ba2e5ccc4e31b7c198747e5b", "message": "Update README.md", "committedDate": "2020-11-04T14:41:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODIzMTE4Nw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r518231187", "bodyText": "we don't have to assert it's null here, the compiler will auto set all member variables to a reasonable default, generally null in this case.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private Graphic identifiedGraphic = null;\n          \n          \n            \n              private Graphic identifiedGraphic;", "author": "Rachael-E", "createdAt": "2020-11-05T17:33:13Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -51,17 +53,14 @@\n \n public class UpdateGraphicsSample extends Application {\n \n-  private boolean isUpdateLocationActive;\n   private List<SimpleMarkerSymbol> markers;\n-  private Button updateLocationButton;\n   private Button updateDescriptionButton;\n   private ComboBox<String> symbolBox;\n \n-  private ArcGISMap map; // keep loadable in scope to avoid garbage collection\n   private MapView mapView;\n-  private Graphic selectedGraphic;\n+  private Graphic identifiedGraphic = null;", "originalCommit": "045dbcef294ac0a0ba2e5ccc4e31b7c198747e5b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI1ODU3OQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r518258579", "bodyText": "A few things in this suggestion.\n\nWhen the sample loads, and the user clicks and drags on the map view, a null pointer exception is thrown. This continues until a user clicks to select a graphic, and then it's not seen again. We could handle that by showing an error in the mapView.setOnMouseDragged listener, or, by simply moving that listener in the identifyGraphics.addDoneListener (see suggestion).\n\nThe benefit to this approach is that we know the identifiedGraphic should never be null (since it's already identified), and a null pointer shouldn't be able to be thrown. Also when the sample loads, a user could click and drag the map view if they wanted to before it gets locked when selecting a graphic.\n\nIf a user selects a graphic but clicks and drags on the other side of the screen, the point is dragged. I'd expect the graphic only to be dragged if the cursor was actually on the graphic. I think Jon has suggested something similar above to address this but might have too many code arms and legs to follow phrase! So to make it clear to the user that the graphic is still selected and in drag mode, I've suggested a simple Cursor.CLOSED_HAND here to make it visually obvious we're still dragging.\n\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            disableUI(false);\n          \n          \n            \n                            disableUI(false);\n          \n          \n            \n            \n          \n          \n            \n                            // enable dragging of the identified graphic to move its location\n          \n          \n            \n                            mapView.setOnMouseDragged(event -> {\n          \n          \n            \n            \n          \n          \n            \n                                if (identifiedGraphic.isSelected() && identifiedGraphic != null) {\n          \n          \n            \n                                  // set the cursor to closed hand to indicate graphic dragging is active\n          \n          \n            \n                                  mapView.setCursor(Cursor.CLOSED_HAND);\n          \n          \n            \n                                  // create a point from the dragged location\n          \n          \n            \n                                  mapViewPoint = new Point2D(event.getX(), event.getY());\n          \n          \n            \n                                  Point mapPoint = mapView.screenToLocation(mapViewPoint);\n          \n          \n            \n                                  // update the location of the graphic to the dragged location\n          \n          \n            \n                                  identifiedGraphic.setGeometry(mapPoint);\n          \n          \n            \n                                } else new Alert(Alert.AlertType.ERROR, \"Error selecting graphic\").show();\n          \n          \n            \n                            });", "author": "Rachael-E", "createdAt": "2020-11-05T18:06:38Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -167,39 +156,52 @@ public void start(Stage stage) {\n \n       mapView.setOnMouseClicked(e -> {\n         if (e.getButton() == MouseButton.PRIMARY && e.isStillSincePress()) {\n+          // set the cursor to default\n+          mapView.setCursor(Cursor.DEFAULT);\n+\n           // clear any selected graphic\n           graphicsOverlay.clearSelection();\n \n-          // create a point from location clicked\n-          Point2D mapViewPoint = new Point2D(e.getX(), e.getY());\n-\n-          if (isUpdateLocationActive) {\n-            // add new location to selected graphic\n-            Point mapPoint = mapView.screenToLocation(mapViewPoint);\n-            selectedGraphic.setGeometry(mapPoint);\n-            isUpdateLocationActive = false;\n-          } else {\n-            // identify the graphic that was selected\n-            identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n-\n-            identifyGraphics.addDoneListener(() -> {\n-              try {\n-                if (!identifyGraphics.get().getGraphics().isEmpty()) {\n-                  // store the selected graphic\n-                  selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n-                  selectedGraphic.setSelected(true);\n-                  String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n-                  symbolBox.getSelectionModel().select(style);\n-\n-                  enableUI(false);\n-                } else {\n-                  enableUI(true);\n-                }\n-              } catch (Exception x) {\n-                new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+          // create a point where the user clicked\n+          mapViewPoint = new Point2D(e.getX(), e.getY());\n+\n+          // identify graphics on the graphics overlay\n+          ListenableFuture<IdentifyGraphicsOverlayResult> identifyGraphics =\n+            mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n+\n+          identifyGraphics.addDoneListener(() -> {\n+            try {\n+              if (!identifyGraphics.get().getGraphics().isEmpty()) {\n+                // get the first identified graphic\n+                identifiedGraphic = identifyGraphics.get().getGraphics().get(0);\n+                // select the identified graphic\n+                identifiedGraphic.setSelected(true);\n+                // update the drop down box with the identified graphic's current symbol\n+                String style = ((SimpleMarkerSymbol) identifiedGraphic.getSymbol()).getStyle().toString();\n+                symbolBox.getSelectionModel().select(style);\n+                // show the UI\n+                disableUI(false);", "originalCommit": "045dbcef294ac0a0ba2e5ccc4e31b7c198747e5b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI2MDI5OQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r518260299", "bodyText": "Alternatively, it is possible to simultaneously click and drag the graphic with the following.\nHowever, I had to bump the tolerance up quite high since there is a bit of lag with the drag and if the mouse travels faster than the graphic, it leaves it behind. With this bigger tolerance though, more than one graphic can be selected and it results in a fun dance between the two graphics moving...if you'd like to take this code and work around it to avoid that behaviour, see what you think: it might take a fair bit of time, I've had to leave it for now. Otherwise the workflow I've suggested above is just fine!\n      mapView.setOnMouseDragged(e -> {\n        if (e.getButton() == MouseButton.PRIMARY) {\n//           create a point where the user clicked\n          mapViewPoint = new Point2D(e.getX(), e.getY());\n\n          // identify graphics on the graphics overlay\n          ListenableFuture<IdentifyGraphicsOverlayResult> identifyGraphics =\n            mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 50, false);\n\n          identifyGraphics.addDoneListener(() -> {\n            try {\n              if (!identifyGraphics.get().getGraphics().isEmpty()) {\n                // get the first identified graphic\n                identifiedGraphic = identifyGraphics.get().getGraphics().get(0);\n                // select the identified graphic\n                identifiedGraphic.setSelected(true);\n                // update the drop down box with the identified graphic's current symbol\n                String style = ((SimpleMarkerSymbol) identifiedGraphic.getSymbol()).getStyle().toString();\n                symbolBox.getSelectionModel().select(style);\n                // show the UI\n                disableUI(false);\n\n                // enable dragging of the identified graphic to move its location\n                if (identifiedGraphic.isSelected() && identifiedGraphic != null) {\n                  // set the cursor to closed hand to indicate graphic dragging is active\n//                      mapView.setCursor(Cursor.CLOSED_HAND);\n                  // create a point from the dragged location\n                  mapViewPoint = new Point2D(e.getX(), e.getY());\n                  Point mapPoint = mapView.screenToLocation(mapViewPoint);\n                  // update the location of the graphic to the dragged location\n                  identifiedGraphic.setGeometry(mapPoint);\n                } else new Alert(Alert.AlertType.ERROR, \"Error selecting graphic\").show();\n\n                // clear any selected graphic when clicking on the map view\n                mapView.setOnMouseClicked(mouseEvent -> {\n                  if (mouseEvent.isStillSincePress()) {\n                    graphicsOverlay.clearSelection();\n                  }\n                });\n\n              } else {\n                disableUI(true);\n              }\n            } catch (Exception x) {\n              new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n            }\n          });\n        }\n      });", "author": "Rachael-E", "createdAt": "2020-11-05T18:09:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI1ODU3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI2MTAzNw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r518261037", "bodyText": "Missing a period from this javadoc\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * Disables the visibility of the UI controls\n          \n          \n            \n               * Disables the visibility of the UI controls.", "author": "Rachael-E", "createdAt": "2020-11-05T18:10:43Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -260,10 +262,14 @@ private void createGraphics() {\n     }\n   }\n \n-  private void enableUI(boolean enable) {\n-    updateDescriptionButton.setDisable(enable);\n-    updateLocationButton.setDisable(enable);\n-    symbolBox.setDisable(enable);\n+  /**\n+   * Disables the visibility of the UI controls", "originalCommit": "045dbcef294ac0a0ba2e5ccc4e31b7c198747e5b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI2MjEzNA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r518262134", "bodyText": "let's give the boolean parameter a slightly more meaningful name\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private void disableUI(boolean disable) {\n          \n          \n            \n              private void disableUI(boolean isDisabled) {", "author": "Rachael-E", "createdAt": "2020-11-05T18:12:33Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -260,10 +262,14 @@ private void createGraphics() {\n     }\n   }\n \n-  private void enableUI(boolean enable) {\n-    updateDescriptionButton.setDisable(enable);\n-    updateLocationButton.setDisable(enable);\n-    symbolBox.setDisable(enable);\n+  /**\n+   * Disables the visibility of the UI controls\n+   *\n+   * @param disable visibility of the UI\n+   */\n+  private void disableUI(boolean disable) {", "originalCommit": "045dbcef294ac0a0ba2e5ccc4e31b7c198747e5b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI2MjgyNg==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/579#discussion_r518262826", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      // set the cursor to the move\n          \n          \n            \n                      // set the cursor to the move icon", "author": "Rachael-E", "createdAt": "2020-11-05T18:13:51Z", "path": "display_information/update-graphics/src/main/java/com/esri/samples/update_graphics/UpdateGraphicsSample.java", "diffHunk": "@@ -167,39 +156,52 @@ public void start(Stage stage) {\n \n       mapView.setOnMouseClicked(e -> {\n         if (e.getButton() == MouseButton.PRIMARY && e.isStillSincePress()) {\n+          // set the cursor to default\n+          mapView.setCursor(Cursor.DEFAULT);\n+\n           // clear any selected graphic\n           graphicsOverlay.clearSelection();\n \n-          // create a point from location clicked\n-          Point2D mapViewPoint = new Point2D(e.getX(), e.getY());\n-\n-          if (isUpdateLocationActive) {\n-            // add new location to selected graphic\n-            Point mapPoint = mapView.screenToLocation(mapViewPoint);\n-            selectedGraphic.setGeometry(mapPoint);\n-            isUpdateLocationActive = false;\n-          } else {\n-            // identify the graphic that was selected\n-            identifyGraphics = mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n-\n-            identifyGraphics.addDoneListener(() -> {\n-              try {\n-                if (!identifyGraphics.get().getGraphics().isEmpty()) {\n-                  // store the selected graphic\n-                  selectedGraphic = identifyGraphics.get().getGraphics().get(0);\n-                  selectedGraphic.setSelected(true);\n-                  String style = ((SimpleMarkerSymbol) selectedGraphic.getSymbol()).getStyle().toString();\n-                  symbolBox.getSelectionModel().select(style);\n-\n-                  enableUI(false);\n-                } else {\n-                  enableUI(true);\n-                }\n-              } catch (Exception x) {\n-                new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+          // create a point where the user clicked\n+          mapViewPoint = new Point2D(e.getX(), e.getY());\n+\n+          // identify graphics on the graphics overlay\n+          ListenableFuture<IdentifyGraphicsOverlayResult> identifyGraphics =\n+            mapView.identifyGraphicsOverlayAsync(graphicsOverlay, mapViewPoint, 10, false);\n+\n+          identifyGraphics.addDoneListener(() -> {\n+            try {\n+              if (!identifyGraphics.get().getGraphics().isEmpty()) {\n+                // get the first identified graphic\n+                identifiedGraphic = identifyGraphics.get().getGraphics().get(0);\n+                // select the identified graphic\n+                identifiedGraphic.setSelected(true);\n+                // update the drop down box with the identified graphic's current symbol\n+                String style = ((SimpleMarkerSymbol) identifiedGraphic.getSymbol()).getStyle().toString();\n+                symbolBox.getSelectionModel().select(style);\n+                // show the UI\n+                disableUI(false);\n+              } else {\n+                disableUI(true);\n               }\n-            });\n-          }\n+            } catch (Exception x) {\n+              new Alert(Alert.AlertType.ERROR, \"Error identifying clicked graphic\").show();\n+            }\n+          });\n+        }\n+      });\n+\n+      mapView.setOnMouseDragged(e -> {\n+        if (identifiedGraphic.isSelected() && identifiedGraphic != null) {\n+          // set the cursor to the move", "originalCommit": "045dbcef294ac0a0ba2e5ccc4e31b7c198747e5b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1394a8379d9e8ad7786e0ee4ff0ffc91194a29e2", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/1394a8379d9e8ad7786e0ee4ff0ffc91194a29e2", "message": "Update how to use", "committedDate": "2020-11-06T14:52:30Z", "type": "commit"}, {"oid": "812a872512f918e5176fe32b362123bf6ab91aef", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/812a872512f918e5176fe32b362123bf6ab91aef", "message": "Fix from PR", "committedDate": "2020-11-10T20:12:08Z", "type": "commit"}, {"oid": "daf328768e619ee423c6da6f24b268395a199316", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/daf328768e619ee423c6da6f24b268395a199316", "message": "Fix image size", "committedDate": "2020-11-12T10:56:08Z", "type": "commit"}]}