{"pr_number": 562, "pr_title": "Manage Operational Layers: UI not working as described", "pr_createdAt": "2020-10-02T14:27:02Z", "pr_url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562", "timeline": [{"oid": "8a0de018414d798277b6e6c219be217bafd20095", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/8a0de018414d798277b6e6c219be217bafd20095", "message": "alter the functionality for reordering layers", "committedDate": "2020-10-02T09:35:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2NTU5MA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500065590", "bodyText": "I like the change to plain english \ud83d\udc4d\nMight be worth creating an issue for a 'find-and-replace' effort to make all these uniform?", "author": "JonLavi", "createdAt": "2020-10-06T07:36:48Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,156 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n+  private LayerList mapLayers;\n \n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n   private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n   private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+  private static final String ELEVATION_LAYER =\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n \n   @Override\n   public void start(Stage stage) {\n \n     try {\n-      // create stack pane and application scene\n+      // create the stack pane and the application scene", "originalCommit": "8a0de018414d798277b6e6c219be217bafd20095", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE2MjY1MA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500162650", "bodyText": "Yeah there's heaps of these! Will do that \ud83d\udc4d", "author": "jenmerritt", "createdAt": "2020-10-06T10:16:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2NTU5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2NTc3Ng==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500065776", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  // create a view and added ArcGISMap to it\n          \n          \n            \n                  // create a view and add the ArcGISMap to it", "author": "JonLavi", "createdAt": "2020-10-06T07:37:08Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,156 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n+  private LayerList mapLayers;\n \n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n   private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n   private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+  private static final String ELEVATION_LAYER =\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n \n   @Override\n   public void start(Stage stage) {\n \n     try {\n-      // create stack pane and application scene\n+      // create the stack pane and the application scene\n       StackPane stackPane = new StackPane();\n       Scene scene = new Scene(stackPane);\n       scene.getStylesheets().add(getClass().getResource(\"/manage_operational_layers/style.css\").toExternalForm());\n \n-      // set title, size, and add scene to stage\n+      // set a title, size, and add the scene to the stage\n       stage.setTitle(\"Manage Operational Layers Sample\");\n       stage.setWidth(800);\n       stage.setHeight(700);\n       stage.setScene(scene);\n       stage.show();\n \n-      // create a control panel\n-      VBox controlsVBox = new VBox(6);\n-      controlsVBox.setBackground(new Background(new BackgroundFill(Paint.valueOf(\"rgba(0,0,0,0.3)\"), CornerRadii.EMPTY,\n-          Insets.EMPTY)));\n-      controlsVBox.setPadding(new Insets(10.0));\n-      controlsVBox.setMaxSize(200, 260);\n-      controlsVBox.getStyleClass().add(\"panel-region\");\n+      // create a ArcGISMap with the topographic basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createTopographic());\n \n-      // create labels for add/delete layers\n-      Label addLayersLabel = new Label(\"Layers on the ArcGISMap\");\n-      Label deleteLayersLabel = new Label(\"Deleted Layers\");\n-      addLayersLabel.getStyleClass().add(\"panel-label\");\n-      deleteLayersLabel.getStyleClass().add(\"panel-label\");\n+      // create a view and added ArcGISMap to it", "originalCommit": "8a0de018414d798277b6e6c219be217bafd20095", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2NjUyMg==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500066522", "bodyText": "In other samples where strings for services are only used once, we write these URLs directly in the constructor, and don't create a String variable for them. Just an observation regarding consistency. I don't mind either way", "author": "JonLavi", "createdAt": "2020-10-06T07:38:28Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,156 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n+  private LayerList mapLayers;\n \n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n   private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n   private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+  private static final String ELEVATION_LAYER =\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";", "originalCommit": "8a0de018414d798277b6e6c219be217bafd20095", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE4NTg4MQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500185881", "bodyText": "Refactored as per method below.", "author": "jenmerritt", "createdAt": "2020-10-06T11:00:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2NjUyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2ODE1Nw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500068157", "bodyText": "If it seems useful, you could create a method to refactor this a little (althoug I know methods aren't encouraged in samples):\nprivate void addMapLayer(String serviceUrl){\n\tArcGISMapImageLayer imageLayer =  new ArcGISMapImageLayer(serviceUrl);\n\tmapLayers.add(imaageLayer);\n}", "author": "JonLavi", "createdAt": "2020-10-06T07:41:17Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,156 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n+  private LayerList mapLayers;\n \n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n   private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n   private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+  private static final String ELEVATION_LAYER =\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n \n   @Override\n   public void start(Stage stage) {\n \n     try {\n-      // create stack pane and application scene\n+      // create the stack pane and the application scene\n       StackPane stackPane = new StackPane();\n       Scene scene = new Scene(stackPane);\n       scene.getStylesheets().add(getClass().getResource(\"/manage_operational_layers/style.css\").toExternalForm());\n \n-      // set title, size, and add scene to stage\n+      // set a title, size, and add the scene to the stage\n       stage.setTitle(\"Manage Operational Layers Sample\");\n       stage.setWidth(800);\n       stage.setHeight(700);\n       stage.setScene(scene);\n       stage.show();\n \n-      // create a control panel\n-      VBox controlsVBox = new VBox(6);\n-      controlsVBox.setBackground(new Background(new BackgroundFill(Paint.valueOf(\"rgba(0,0,0,0.3)\"), CornerRadii.EMPTY,\n-          Insets.EMPTY)));\n-      controlsVBox.setPadding(new Insets(10.0));\n-      controlsVBox.setMaxSize(200, 260);\n-      controlsVBox.getStyleClass().add(\"panel-region\");\n+      // create a ArcGISMap with the topographic basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createTopographic());\n \n-      // create labels for add/delete layers\n-      Label addLayersLabel = new Label(\"Layers on the ArcGISMap\");\n-      Label deleteLayersLabel = new Label(\"Deleted Layers\");\n-      addLayersLabel.getStyleClass().add(\"panel-label\");\n-      deleteLayersLabel.getStyleClass().add(\"panel-label\");\n+      // create a view and added ArcGISMap to it\n+      mapView = new MapView();\n+      mapView.setMap(map);\n \n-      // create list for deleted layers\n+      // set the initial viewpoint for the map view\n+      mapView.setViewpoint(new Viewpoint(34.056295, -117.195800, 100000));\n+\n+      // create the elevation, census, and damage image layers\n+      final ArcGISMapImageLayer censusImageLayer = new ArcGISMapImageLayer(CENSUS_LAYER);\n+      final ArcGISMapImageLayer damageImageLayer = new ArcGISMapImageLayer(DAMAGE_LAYER);\n+      final ArcGISMapImageLayer elevationImageLayer = new ArcGISMapImageLayer(ELEVATION_LAYER);\n+\n+      // add the image layers to the list of operational layers on the map\n+      mapLayers = map.getOperationalLayers();\n+      mapLayers.add(elevationImageLayer);\n+      mapLayers.add(damageImageLayer);\n+      mapLayers.add(censusImageLayer);", "originalCommit": "8a0de018414d798277b6e6c219be217bafd20095", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE4MDM5Mw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500180393", "bodyText": "Would make it more easily extendable to add more layers, especially now it's working for x number of layers that you put in. I'll refactor.", "author": "jenmerritt", "createdAt": "2020-10-06T10:50:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2ODE1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI4Mjk3OQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500282979", "bodyText": "You could also add a check for the loading here (add a doneLoadingListener and have it show a message).\nThere's an argument to be made for leaving all that out (since it's not the core of what the sample tries to do), or putting it in because it offers a better user experience! I'll leave that up to you and @Rachael-E to decide \ud83d\ude09", "author": "JonLavi", "createdAt": "2020-10-06T13:36:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2ODE1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA3MDIyNQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500070225", "bodyText": "I'm wondering if the selected index can ever be selectedIndex < 0?\nIf that's not a technically viable option, would it be possible to write selectedIndex != null? Just wondering if there's any implication in one expression or the other", "author": "JonLavi", "createdAt": "2020-10-06T07:44:54Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,156 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n+  private LayerList mapLayers;\n \n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n   private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n   private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+  private static final String ELEVATION_LAYER =\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n \n   @Override\n   public void start(Stage stage) {\n \n     try {\n-      // create stack pane and application scene\n+      // create the stack pane and the application scene\n       StackPane stackPane = new StackPane();\n       Scene scene = new Scene(stackPane);\n       scene.getStylesheets().add(getClass().getResource(\"/manage_operational_layers/style.css\").toExternalForm());\n \n-      // set title, size, and add scene to stage\n+      // set a title, size, and add the scene to the stage\n       stage.setTitle(\"Manage Operational Layers Sample\");\n       stage.setWidth(800);\n       stage.setHeight(700);\n       stage.setScene(scene);\n       stage.show();\n \n-      // create a control panel\n-      VBox controlsVBox = new VBox(6);\n-      controlsVBox.setBackground(new Background(new BackgroundFill(Paint.valueOf(\"rgba(0,0,0,0.3)\"), CornerRadii.EMPTY,\n-          Insets.EMPTY)));\n-      controlsVBox.setPadding(new Insets(10.0));\n-      controlsVBox.setMaxSize(200, 260);\n-      controlsVBox.getStyleClass().add(\"panel-region\");\n+      // create a ArcGISMap with the topographic basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createTopographic());\n \n-      // create labels for add/delete layers\n-      Label addLayersLabel = new Label(\"Layers on the ArcGISMap\");\n-      Label deleteLayersLabel = new Label(\"Deleted Layers\");\n-      addLayersLabel.getStyleClass().add(\"panel-label\");\n-      deleteLayersLabel.getStyleClass().add(\"panel-label\");\n+      // create a view and added ArcGISMap to it\n+      mapView = new MapView();\n+      mapView.setMap(map);\n \n-      // create list for deleted layers\n+      // set the initial viewpoint for the map view\n+      mapView.setViewpoint(new Viewpoint(34.056295, -117.195800, 100000));\n+\n+      // create the elevation, census, and damage image layers\n+      final ArcGISMapImageLayer censusImageLayer = new ArcGISMapImageLayer(CENSUS_LAYER);\n+      final ArcGISMapImageLayer damageImageLayer = new ArcGISMapImageLayer(DAMAGE_LAYER);\n+      final ArcGISMapImageLayer elevationImageLayer = new ArcGISMapImageLayer(ELEVATION_LAYER);\n+\n+      // add the image layers to the list of operational layers on the map\n+      mapLayers = map.getOperationalLayers();\n+      mapLayers.add(elevationImageLayer);\n+      mapLayers.add(damageImageLayer);\n+      mapLayers.add(censusImageLayer);\n+\n+      // create a list to hold deleted layers\n       ArrayList<Layer> deletedLayers = new ArrayList<>();\n \n-      // create a list view for names of layers added/deleted\n-      ListView<String> addedLayerNames = new ListView<>();\n-      ListView<String> deletedLayerNames = new ListView<>();\n-\n-      addedLayerNames.setOnMouseClicked(e -> {\n-        // index of selected item\n-        int selectedIndex = addedLayerNames.getSelectionModel().getSelectedIndex();\n-        if (e.getButton() == MouseButton.PRIMARY) {\n-\n-          // store selected layer\n-          ArcGISMapImageLayer temp = (ArcGISMapImageLayer) mapAddedLayers.get(selectedIndex);\n-          // remove selected layer\n-          mapAddedLayers.remove(selectedIndex);\n-          // add selected layer to front\n-          mapAddedLayers.add(temp);\n-\n-          // make names match added layers list\n-          String temp2 = addedLayerNames.getItems().get(selectedIndex);\n-          addedLayerNames.getItems().remove(selectedIndex);\n-          addedLayerNames.getItems().add(temp2);\n-        } else if (e.getButton() == MouseButton.SECONDARY) {\n-\n-          // append added layer to deleted list\n-          deletedLayers.add(mapAddedLayers.get(selectedIndex));\n-          // remove layer from added list\n-          mapAddedLayers.remove(selectedIndex);\n-\n-          // make names match corresponding list\n-          deletedLayerNames.getItems().add(addedLayerNames.getSelectionModel().getSelectedItem());\n-          addedLayerNames.getItems().remove(selectedIndex);\n-        }\n-      });\n+      // create a list view to display the list of added and deleted layers by name, and create labels for them\n+      ListView<String> addedLayerNamesList = new ListView<>();\n+      Label addedLayersLabel = new Label(\"Added layers\");\n+      ListView<String> deletedLayerNamesList = new ListView<>();\n+      Label deletedLayersLabel = new Label(\"Deleted layers\");\n+\n+      // add the names of the layers on the map to the list of added layers\n+      // note this should be the reverse order they were added to the map\n+      addedLayerNamesList.getItems().add(mapLayers.get(2).getName());\n+      addedLayerNamesList.getItems().add(mapLayers.get(1).getName());\n+      addedLayerNamesList.getItems().add(mapLayers.get(0).getName());\n+\n+      // create a listener for clicks on the list of added layers\n+      addedLayerNamesList.setOnMouseClicked(e -> {\n+\n+        // if there are added layers\n+        if (!mapLayers.isEmpty() && !addedLayerNamesList.getItems().isEmpty()) {\n+\n+          // get the index of the selected item\n+          int selectedIndex = addedLayerNamesList.getSelectionModel().getSelectedIndex();\n \n-      deletedLayerNames.setOnMouseClicked(e -> {\n-        // index of selected item\n-        int selectedIndex = deletedLayerNames.getSelectionModel().getSelectedIndex();\n-        if (e.getButton() == MouseButton.SECONDARY) {\n+          // if a valid index is selected\n+          if (selectedIndex >= 0) {", "originalCommit": "8a0de018414d798277b6e6c219be217bafd20095", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE2ODY5NQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500168695", "bodyText": "I originally implemented with != null but then if you click in any of the blank spots in the list it returns an index of -1 which was causing an out of range exception, so I'm avoiding that with this if statement.", "author": "jenmerritt", "createdAt": "2020-10-06T10:27:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA3MDIyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA3NTA3Mw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500075073", "bodyText": "Back when I noticed that this sample doesn't quite work as expected, I figured this would be the way to go. Unfortunately I still find it a bit clunky to have to keep two lists in sync manually. Tyler had pointed out that map.getOperationalLayers() should ideally be an ObservableList, which would solve this problem quite elegantly. @mbcoder not sure whether this is easy to pull off in hindsight, but maybe it could be added to the backlog.", "author": "JonLavi", "createdAt": "2020-10-06T07:53:28Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,156 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n+  private LayerList mapLayers;\n \n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n   private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n   private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+  private static final String ELEVATION_LAYER =\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n \n   @Override\n   public void start(Stage stage) {\n \n     try {\n-      // create stack pane and application scene\n+      // create the stack pane and the application scene\n       StackPane stackPane = new StackPane();\n       Scene scene = new Scene(stackPane);\n       scene.getStylesheets().add(getClass().getResource(\"/manage_operational_layers/style.css\").toExternalForm());\n \n-      // set title, size, and add scene to stage\n+      // set a title, size, and add the scene to the stage\n       stage.setTitle(\"Manage Operational Layers Sample\");\n       stage.setWidth(800);\n       stage.setHeight(700);\n       stage.setScene(scene);\n       stage.show();\n \n-      // create a control panel\n-      VBox controlsVBox = new VBox(6);\n-      controlsVBox.setBackground(new Background(new BackgroundFill(Paint.valueOf(\"rgba(0,0,0,0.3)\"), CornerRadii.EMPTY,\n-          Insets.EMPTY)));\n-      controlsVBox.setPadding(new Insets(10.0));\n-      controlsVBox.setMaxSize(200, 260);\n-      controlsVBox.getStyleClass().add(\"panel-region\");\n+      // create a ArcGISMap with the topographic basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createTopographic());\n \n-      // create labels for add/delete layers\n-      Label addLayersLabel = new Label(\"Layers on the ArcGISMap\");\n-      Label deleteLayersLabel = new Label(\"Deleted Layers\");\n-      addLayersLabel.getStyleClass().add(\"panel-label\");\n-      deleteLayersLabel.getStyleClass().add(\"panel-label\");\n+      // create a view and added ArcGISMap to it\n+      mapView = new MapView();\n+      mapView.setMap(map);\n \n-      // create list for deleted layers\n+      // set the initial viewpoint for the map view\n+      mapView.setViewpoint(new Viewpoint(34.056295, -117.195800, 100000));\n+\n+      // create the elevation, census, and damage image layers\n+      final ArcGISMapImageLayer censusImageLayer = new ArcGISMapImageLayer(CENSUS_LAYER);\n+      final ArcGISMapImageLayer damageImageLayer = new ArcGISMapImageLayer(DAMAGE_LAYER);\n+      final ArcGISMapImageLayer elevationImageLayer = new ArcGISMapImageLayer(ELEVATION_LAYER);\n+\n+      // add the image layers to the list of operational layers on the map\n+      mapLayers = map.getOperationalLayers();\n+      mapLayers.add(elevationImageLayer);\n+      mapLayers.add(damageImageLayer);\n+      mapLayers.add(censusImageLayer);\n+\n+      // create a list to hold deleted layers\n       ArrayList<Layer> deletedLayers = new ArrayList<>();\n \n-      // create a list view for names of layers added/deleted\n-      ListView<String> addedLayerNames = new ListView<>();\n-      ListView<String> deletedLayerNames = new ListView<>();\n-\n-      addedLayerNames.setOnMouseClicked(e -> {\n-        // index of selected item\n-        int selectedIndex = addedLayerNames.getSelectionModel().getSelectedIndex();\n-        if (e.getButton() == MouseButton.PRIMARY) {\n-\n-          // store selected layer\n-          ArcGISMapImageLayer temp = (ArcGISMapImageLayer) mapAddedLayers.get(selectedIndex);\n-          // remove selected layer\n-          mapAddedLayers.remove(selectedIndex);\n-          // add selected layer to front\n-          mapAddedLayers.add(temp);\n-\n-          // make names match added layers list\n-          String temp2 = addedLayerNames.getItems().get(selectedIndex);\n-          addedLayerNames.getItems().remove(selectedIndex);\n-          addedLayerNames.getItems().add(temp2);\n-        } else if (e.getButton() == MouseButton.SECONDARY) {\n-\n-          // append added layer to deleted list\n-          deletedLayers.add(mapAddedLayers.get(selectedIndex));\n-          // remove layer from added list\n-          mapAddedLayers.remove(selectedIndex);\n-\n-          // make names match corresponding list\n-          deletedLayerNames.getItems().add(addedLayerNames.getSelectionModel().getSelectedItem());\n-          addedLayerNames.getItems().remove(selectedIndex);\n-        }\n-      });\n+      // create a list view to display the list of added and deleted layers by name, and create labels for them\n+      ListView<String> addedLayerNamesList = new ListView<>();\n+      Label addedLayersLabel = new Label(\"Added layers\");\n+      ListView<String> deletedLayerNamesList = new ListView<>();\n+      Label deletedLayersLabel = new Label(\"Deleted layers\");\n+\n+      // add the names of the layers on the map to the list of added layers\n+      // note this should be the reverse order they were added to the map\n+      addedLayerNamesList.getItems().add(mapLayers.get(2).getName());\n+      addedLayerNamesList.getItems().add(mapLayers.get(1).getName());\n+      addedLayerNamesList.getItems().add(mapLayers.get(0).getName());\n+\n+      // create a listener for clicks on the list of added layers\n+      addedLayerNamesList.setOnMouseClicked(e -> {\n+\n+        // if there are added layers\n+        if (!mapLayers.isEmpty() && !addedLayerNamesList.getItems().isEmpty()) {\n+\n+          // get the index of the selected item\n+          int selectedIndex = addedLayerNamesList.getSelectionModel().getSelectedIndex();\n \n-      deletedLayerNames.setOnMouseClicked(e -> {\n-        // index of selected item\n-        int selectedIndex = deletedLayerNames.getSelectionModel().getSelectedIndex();\n-        if (e.getButton() == MouseButton.SECONDARY) {\n+          // if a valid index is selected\n+          if (selectedIndex >= 0) {\n \n-          // append deleted layer to added list\n-          mapAddedLayers.add(deletedLayers.get(selectedIndex));\n-          // remove delete layer from deleted list\n-          deletedLayers.remove(selectedIndex);\n+            // get the selected layer from the map and its index in the list of operational layers on the map\n+            ArcGISMapImageLayer selectedLayer = (ArcGISMapImageLayer) mapLayers.get(mapLayers.size() - selectedIndex - 1);\n+            int indexOfSelectedLayer = mapLayers.indexOf(selectedLayer);\n \n-          // make names match corresponding list\n-          addedLayerNames.getItems().add(deletedLayerNames.getSelectionModel().getSelectedItem());\n-          deletedLayerNames.getItems().remove(selectedIndex);\n+            if (e.getButton() == MouseButton.PRIMARY) {\n+\n+              // if the layer is not already at the top, move it to the top of the list and layers on the map\n+              if (selectedIndex != 0) {\n+\n+                // move the layer's name to the top of the added layers list. Note this is adding to index 0.\n+                addedLayerNamesList.getItems().remove(selectedIndex);\n+                addedLayerNamesList.getItems().add(0, selectedLayer.getName());\n+\n+                // move the layer to the top of the layers on the map. Note this is adding to the last index.\n+                mapLayers.remove(indexOfSelectedLayer);\n+                mapLayers.add(mapLayers.size(), selectedLayer);", "originalCommit": "8a0de018414d798277b6e6c219be217bafd20095", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA3NjMxNg==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500076316", "bodyText": "These lines are now repeated in style.css. I think what we have in the CSS generally works ok with the SV, so we should be able to delete these?", "author": "JonLavi", "createdAt": "2020-10-06T07:55:42Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,156 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n+  private LayerList mapLayers;\n \n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n   private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n   private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+  private static final String ELEVATION_LAYER =\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n \n   @Override\n   public void start(Stage stage) {\n \n     try {\n-      // create stack pane and application scene\n+      // create the stack pane and the application scene\n       StackPane stackPane = new StackPane();\n       Scene scene = new Scene(stackPane);\n       scene.getStylesheets().add(getClass().getResource(\"/manage_operational_layers/style.css\").toExternalForm());\n \n-      // set title, size, and add scene to stage\n+      // set a title, size, and add the scene to the stage\n       stage.setTitle(\"Manage Operational Layers Sample\");\n       stage.setWidth(800);\n       stage.setHeight(700);\n       stage.setScene(scene);\n       stage.show();\n \n-      // create a control panel\n-      VBox controlsVBox = new VBox(6);\n-      controlsVBox.setBackground(new Background(new BackgroundFill(Paint.valueOf(\"rgba(0,0,0,0.3)\"), CornerRadii.EMPTY,\n-          Insets.EMPTY)));\n-      controlsVBox.setPadding(new Insets(10.0));\n-      controlsVBox.setMaxSize(200, 260);\n-      controlsVBox.getStyleClass().add(\"panel-region\");\n+      // create a ArcGISMap with the topographic basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createTopographic());\n \n-      // create labels for add/delete layers\n-      Label addLayersLabel = new Label(\"Layers on the ArcGISMap\");\n-      Label deleteLayersLabel = new Label(\"Deleted Layers\");\n-      addLayersLabel.getStyleClass().add(\"panel-label\");\n-      deleteLayersLabel.getStyleClass().add(\"panel-label\");\n+      // create a view and added ArcGISMap to it\n+      mapView = new MapView();\n+      mapView.setMap(map);\n \n-      // create list for deleted layers\n+      // set the initial viewpoint for the map view\n+      mapView.setViewpoint(new Viewpoint(34.056295, -117.195800, 100000));\n+\n+      // create the elevation, census, and damage image layers\n+      final ArcGISMapImageLayer censusImageLayer = new ArcGISMapImageLayer(CENSUS_LAYER);\n+      final ArcGISMapImageLayer damageImageLayer = new ArcGISMapImageLayer(DAMAGE_LAYER);\n+      final ArcGISMapImageLayer elevationImageLayer = new ArcGISMapImageLayer(ELEVATION_LAYER);\n+\n+      // add the image layers to the list of operational layers on the map\n+      mapLayers = map.getOperationalLayers();\n+      mapLayers.add(elevationImageLayer);\n+      mapLayers.add(damageImageLayer);\n+      mapLayers.add(censusImageLayer);\n+\n+      // create a list to hold deleted layers\n       ArrayList<Layer> deletedLayers = new ArrayList<>();\n \n-      // create a list view for names of layers added/deleted\n-      ListView<String> addedLayerNames = new ListView<>();\n-      ListView<String> deletedLayerNames = new ListView<>();\n-\n-      addedLayerNames.setOnMouseClicked(e -> {\n-        // index of selected item\n-        int selectedIndex = addedLayerNames.getSelectionModel().getSelectedIndex();\n-        if (e.getButton() == MouseButton.PRIMARY) {\n-\n-          // store selected layer\n-          ArcGISMapImageLayer temp = (ArcGISMapImageLayer) mapAddedLayers.get(selectedIndex);\n-          // remove selected layer\n-          mapAddedLayers.remove(selectedIndex);\n-          // add selected layer to front\n-          mapAddedLayers.add(temp);\n-\n-          // make names match added layers list\n-          String temp2 = addedLayerNames.getItems().get(selectedIndex);\n-          addedLayerNames.getItems().remove(selectedIndex);\n-          addedLayerNames.getItems().add(temp2);\n-        } else if (e.getButton() == MouseButton.SECONDARY) {\n-\n-          // append added layer to deleted list\n-          deletedLayers.add(mapAddedLayers.get(selectedIndex));\n-          // remove layer from added list\n-          mapAddedLayers.remove(selectedIndex);\n-\n-          // make names match corresponding list\n-          deletedLayerNames.getItems().add(addedLayerNames.getSelectionModel().getSelectedItem());\n-          addedLayerNames.getItems().remove(selectedIndex);\n-        }\n-      });\n+      // create a list view to display the list of added and deleted layers by name, and create labels for them\n+      ListView<String> addedLayerNamesList = new ListView<>();\n+      Label addedLayersLabel = new Label(\"Added layers\");\n+      ListView<String> deletedLayerNamesList = new ListView<>();\n+      Label deletedLayersLabel = new Label(\"Deleted layers\");\n+\n+      // add the names of the layers on the map to the list of added layers\n+      // note this should be the reverse order they were added to the map\n+      addedLayerNamesList.getItems().add(mapLayers.get(2).getName());\n+      addedLayerNamesList.getItems().add(mapLayers.get(1).getName());\n+      addedLayerNamesList.getItems().add(mapLayers.get(0).getName());\n+\n+      // create a listener for clicks on the list of added layers\n+      addedLayerNamesList.setOnMouseClicked(e -> {\n+\n+        // if there are added layers\n+        if (!mapLayers.isEmpty() && !addedLayerNamesList.getItems().isEmpty()) {\n+\n+          // get the index of the selected item\n+          int selectedIndex = addedLayerNamesList.getSelectionModel().getSelectedIndex();\n \n-      deletedLayerNames.setOnMouseClicked(e -> {\n-        // index of selected item\n-        int selectedIndex = deletedLayerNames.getSelectionModel().getSelectedIndex();\n-        if (e.getButton() == MouseButton.SECONDARY) {\n+          // if a valid index is selected\n+          if (selectedIndex >= 0) {\n \n-          // append deleted layer to added list\n-          mapAddedLayers.add(deletedLayers.get(selectedIndex));\n-          // remove delete layer from deleted list\n-          deletedLayers.remove(selectedIndex);\n+            // get the selected layer from the map and its index in the list of operational layers on the map\n+            ArcGISMapImageLayer selectedLayer = (ArcGISMapImageLayer) mapLayers.get(mapLayers.size() - selectedIndex - 1);\n+            int indexOfSelectedLayer = mapLayers.indexOf(selectedLayer);\n \n-          // make names match corresponding list\n-          addedLayerNames.getItems().add(deletedLayerNames.getSelectionModel().getSelectedItem());\n-          deletedLayerNames.getItems().remove(selectedIndex);\n+            if (e.getButton() == MouseButton.PRIMARY) {\n+\n+              // if the layer is not already at the top, move it to the top of the list and layers on the map\n+              if (selectedIndex != 0) {\n+\n+                // move the layer's name to the top of the added layers list. Note this is adding to index 0.\n+                addedLayerNamesList.getItems().remove(selectedIndex);\n+                addedLayerNamesList.getItems().add(0, selectedLayer.getName());\n+\n+                // move the layer to the top of the layers on the map. Note this is adding to the last index.\n+                mapLayers.remove(indexOfSelectedLayer);\n+                mapLayers.add(mapLayers.size(), selectedLayer);\n+\n+                // update the UI to keep the current layer selected\n+                addedLayerNamesList.getSelectionModel().select(0);\n+              }\n+\n+            } else if (e.getButton() == MouseButton.SECONDARY) {\n+\n+              // remove the selected layer from the map and add it to the deleted layers\n+              mapLayers.remove(selectedLayer);\n+              deletedLayers.add(selectedLayer);\n+\n+              // remove the selected layer's name from the added layers list and add it to the deleted layers list\n+              addedLayerNamesList.getItems().remove(selectedIndex);\n+              deletedLayerNamesList.getItems().add(selectedLayer.getName());\n+            }\n+          }\n         }\n       });\n \n-      // add labels and lists to the control panel\n-      controlsVBox.getChildren().addAll(addLayersLabel, addedLayerNames, deleteLayersLabel, deletedLayerNames);\n+      // create a listener for clicks on the list of deleted layers\n+      deletedLayerNamesList.setOnMouseClicked(e -> {\n \n-      // create a ArcGISMap with the basemap Topographic\n-      final ArcGISMap map = new ArcGISMap(Basemap.Type.TOPOGRAPHIC, 34.056295, -117.195800, 14);\n+        // if there are deleted layers\n+        if (!deletedLayers.isEmpty() && !deletedLayerNamesList.getItems().isEmpty()) {\n \n-      // get the operational layers list from the ArcGISMap\n-      mapAddedLayers = map.getOperationalLayers();\n+          // get the index of the selected layer\n+          int selectedIndex = deletedLayerNamesList.getSelectionModel().getSelectedIndex();\n \n-      // create a view and added ArcGISMap to it\n-      mapView = new MapView();\n-      mapView.setMap(map);\n+          // if a valid index is selected\n+          if (selectedIndex >= 0) {\n \n-      // create the elevation, census, and damage default layers\n-      ArcGISMapImageLayer imageLayerElevation = new ArcGISMapImageLayer(ELEVATION_LAYER);\n-      ArcGISMapImageLayer imageLayerCensus = new ArcGISMapImageLayer(CENSUS_LAYER);\n-      ArcGISMapImageLayer imageLayerDamage = new ArcGISMapImageLayer(DAMAGE_LAYER);\n+            if (e.getButton() == MouseButton.SECONDARY) {\n \n-      // add default ArcGISMap image layers to the ArcGISMap\n-      mapAddedLayers.add(imageLayerElevation);\n-      mapAddedLayers.add(imageLayerCensus);\n-      mapAddedLayers.add(imageLayerDamage);\n+              // add the layer to the map and remove from the deleted layers\n+              mapLayers.add(0, deletedLayers.get(selectedIndex));\n+              deletedLayers.remove(selectedIndex);\n \n-      // add the default names to added list\n-      addedLayerNames.getItems().add(mapAddedLayers.get(0).getName());\n-      addedLayerNames.getItems().add(mapAddedLayers.get(1).getName());\n-      addedLayerNames.getItems().add(mapAddedLayers.get(2).getName());\n+              // add the selected layer's name to the added layers list and remove it from the deleted layers list\n+              addedLayerNamesList.getItems().add(deletedLayerNamesList.getSelectionModel().getSelectedItem());\n+              deletedLayerNamesList.getItems().remove(selectedIndex);\n+            }\n+          }\n+        }\n+      });\n+\n+      // create a control panel and add the label and list UI components\n+      VBox controlsVBox = new VBox(6);\n+      controlsVBox.setBackground(new Background(new BackgroundFill(Paint.valueOf(\"rgba(0,0,0,0.3)\"), CornerRadii.EMPTY,\n+        Insets.EMPTY)));\n+      controlsVBox.setPadding(new Insets(10.0));\n+      controlsVBox.setMaxSize(200, 260);", "originalCommit": "8a0de018414d798277b6e6c219be217bafd20095", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE3Nzc0Mw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500177743", "bodyText": "I added to CSS and forgot to remove from the sample - good spot!", "author": "jenmerritt", "createdAt": "2020-10-06T10:45:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA3NjMxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA4MjY5NA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500082694", "bodyText": "When testing the sample, I can't see this layer having any content. I had a look at the service, and it doesn't look like there are actually any interesting features in it:\n\nhttps://www.arcgis.com/home/webmap/viewer.html?featurecollection=https%3A%2F%2Fsampleserver5.arcgisonline.com%2Farcgis%2Frest%2Fservices%2FDamageAssessment%2FMapServer%3Ff%3Djson%26option%3Dfootprints&supportsProjection=true&supportsJSONP=true\nMight be worth mentioning to the team and seeing if there's more interesting data to put in there, so it's visually clearer. Unless there was a thought behind there being no data in one of the layers?", "author": "JonLavi", "createdAt": "2020-10-06T08:06:19Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,156 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n+  private LayerList mapLayers;\n \n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n   private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n   private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n+    \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";", "originalCommit": "8a0de018414d798277b6e6c219be217bafd20095", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE3OTgxNg==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500179816", "bodyText": "@JonLavi I might be misunderstanding but the damage assessment has some data when you zoom out, so gives another layer to play with with the controls?", "author": "jenmerritt", "createdAt": "2020-10-06T10:49:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA4MjY5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIxMDIxNA==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500210214", "bodyText": "I would be in favour of having a more zoomed out starting point for this sample: it's not instantly clear you have to zoom out to see the damage assessment layer and like Jon says, it doesn't look too interesting.\nIf the map was scaled to 10000000 in the constructor, you could see a few points: however, these points will move around over time so I'd be more in favour of centralising the viewpoint mid-North America (pretty much so it loads looking like the screenshot you have above: though if you do that, you might want to disable the UI until the world elevation layer has finished loading since it might be a little slow).", "author": "Rachael-E", "createdAt": "2020-10-06T11:46:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA4MjY5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIxMTE2Mw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500211163", "bodyText": "or we could manually add lots of points in around Redlands ;)", "author": "Rachael-E", "createdAt": "2020-10-06T11:48:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA4MjY5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI4MDg2NQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500280865", "bodyText": "My bad, I didn't realise you need to zoom out that far... I don't mind either way, but probably sensible to have some data there that shows at the initial viewpoint that we set in the code", "author": "JonLavi", "createdAt": "2020-10-06T13:34:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA4MjY5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5MjAyNw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500392027", "bodyText": "I've updated the initial viewpoint, think it works way better. As the user you're keen to use the functionality and get that damage layer to the top. Thanks both for the discussion! @Rachael-E @JonLavi", "author": "jenmerritt", "createdAt": "2020-10-06T15:30:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA4MjY5NA=="}], "type": "inlineReview"}, {"oid": "b80cf23959661d82f73cc78b2ed8056dfa0cdc7f", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/b80cf23959661d82f73cc78b2ed8056dfa0cdc7f", "message": "code review amends", "committedDate": "2020-10-06T11:02:18Z", "type": "commit"}, {"oid": "1ee7221aaa862d5e751a06358392b62eff9827ec", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/1ee7221aaa862d5e751a06358392b62eff9827ec", "message": "change initial viewpoint location", "committedDate": "2020-10-06T15:27:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk4OTczNg==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r500989736", "bodyText": "let's make this a local variable", "author": "Rachael-E", "createdAt": "2020-10-07T12:57:13Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,142 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n+  private LayerList mapLayers;", "originalCommit": "1ee7221aaa862d5e751a06358392b62eff9827ec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTAwNjE4Mw==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r501006183", "bodyText": "in reference to Jon's comment here, it's true that it's not really standard for Java samples to contain abstracted methods, such as here, for what is a pretty straightforward initialiser. Adding map image layers to the map's operational layers are a key part of this sample, so it's better to show the ArcGISMapImageLayers instantiated right up front.\nWe can shorthand it a little with the following:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  // add the image layers to the list of operational layers on the map\n          \n          \n            \n                  mapLayers = map.getOperationalLayers();\n          \n          \n            \n                  addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\");\n          \n          \n            \n                  addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\");\n          \n          \n            \n                  addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\");\n          \n          \n            \n                  // create and add new image layers to the map's operational layers\n          \n          \n            \n                  LayerList mapLayers = map.getOperationalLayers();\n          \n          \n            \n                  mapLayers.addAll(Arrays.asList(\n          \n          \n            \n                    (new ArcGISMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\")),\n          \n          \n            \n                    (new ArcGISMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\")),\n          \n          \n            \n                    (new ArcGISMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\"))));", "author": "Rachael-E", "createdAt": "2020-10-07T13:20:56Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,142 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n+  private LayerList mapLayers;\n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n-\n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n-  private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n-  private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n \n   @Override\n   public void start(Stage stage) {\n \n     try {\n-      // create stack pane and application scene\n+      // create the stack pane and the application scene\n       StackPane stackPane = new StackPane();\n       Scene scene = new Scene(stackPane);\n       scene.getStylesheets().add(getClass().getResource(\"/manage_operational_layers/style.css\").toExternalForm());\n \n-      // set title, size, and add scene to stage\n+      // set a title, size, and add the scene to the stage\n       stage.setTitle(\"Manage Operational Layers Sample\");\n       stage.setWidth(800);\n       stage.setHeight(700);\n       stage.setScene(scene);\n       stage.show();\n \n-      // create a control panel\n-      VBox controlsVBox = new VBox(6);\n-      controlsVBox.setBackground(new Background(new BackgroundFill(Paint.valueOf(\"rgba(0,0,0,0.3)\"), CornerRadii.EMPTY,\n-          Insets.EMPTY)));\n-      controlsVBox.setPadding(new Insets(10.0));\n-      controlsVBox.setMaxSize(200, 260);\n-      controlsVBox.getStyleClass().add(\"panel-region\");\n+      // create an ArcGISMap with the topographic basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createTopographic());\n \n-      // create labels for add/delete layers\n-      Label addLayersLabel = new Label(\"Layers on the ArcGISMap\");\n-      Label deleteLayersLabel = new Label(\"Deleted Layers\");\n-      addLayersLabel.getStyleClass().add(\"panel-label\");\n-      deleteLayersLabel.getStyleClass().add(\"panel-label\");\n+      // create a view and add the ArcGISMap to it\n+      mapView = new MapView();\n+      mapView.setMap(map);\n+\n+      // set the initial viewpoint for the map view\n+      mapView.setViewpoint(new Viewpoint(37.056295, -111.195800, 10000000));\n \n-      // create list for deleted layers\n+      // add the image layers to the list of operational layers on the map\n+      mapLayers = map.getOperationalLayers();\n+      addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\");\n+      addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\");\n+      addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\");", "originalCommit": "1ee7221aaa862d5e751a06358392b62eff9827ec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTAxMTcyNQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r501011725", "bodyText": "@jenmerritt, to follow up on your question about loading checks. After we instantiate and add the map image layers to the map's operational layers, we can check to ensure each layer has loaded correctly with the following:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            // check that the layer has loaded correctly and if not display an error message\n          \n          \n            \n                  mapLayers.forEach(layer ->\n          \n          \n            \n                    layer.addDoneLoadingListener(() -> {\n          \n          \n            \n                      if (layer.getLoadStatus() != LoadStatus.LOADED) {\n          \n          \n            \n                        new Alert(Alert.AlertType.ERROR, \"Map image layer failed to load: \" +\n          \n          \n            \n                          layer.getLoadError().getCause().getMessage()).show();}\n          \n          \n            \n                    })\n          \n          \n            \n                  );", "author": "Rachael-E", "createdAt": "2020-10-07T13:28:16Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -38,131 +38,142 @@\n import com.esri.arcgisruntime.mapping.ArcGISMap;\n import com.esri.arcgisruntime.mapping.Basemap;\n import com.esri.arcgisruntime.mapping.LayerList;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n import com.esri.arcgisruntime.mapping.view.MapView;\n \n public class ManageOperationalLayersSample extends Application {\n \n+  private LayerList mapLayers;\n   private MapView mapView;\n-  private LayerList mapAddedLayers;\n-\n-  private static final String ELEVATION_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\";\n-  private static final String CENSUS_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\";\n-  private static final String DAMAGE_LAYER =\n-      \"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\";\n \n   @Override\n   public void start(Stage stage) {\n \n     try {\n-      // create stack pane and application scene\n+      // create the stack pane and the application scene\n       StackPane stackPane = new StackPane();\n       Scene scene = new Scene(stackPane);\n       scene.getStylesheets().add(getClass().getResource(\"/manage_operational_layers/style.css\").toExternalForm());\n \n-      // set title, size, and add scene to stage\n+      // set a title, size, and add the scene to the stage\n       stage.setTitle(\"Manage Operational Layers Sample\");\n       stage.setWidth(800);\n       stage.setHeight(700);\n       stage.setScene(scene);\n       stage.show();\n \n-      // create a control panel\n-      VBox controlsVBox = new VBox(6);\n-      controlsVBox.setBackground(new Background(new BackgroundFill(Paint.valueOf(\"rgba(0,0,0,0.3)\"), CornerRadii.EMPTY,\n-          Insets.EMPTY)));\n-      controlsVBox.setPadding(new Insets(10.0));\n-      controlsVBox.setMaxSize(200, 260);\n-      controlsVBox.getStyleClass().add(\"panel-region\");\n+      // create an ArcGISMap with the topographic basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createTopographic());\n \n-      // create labels for add/delete layers\n-      Label addLayersLabel = new Label(\"Layers on the ArcGISMap\");\n-      Label deleteLayersLabel = new Label(\"Deleted Layers\");\n-      addLayersLabel.getStyleClass().add(\"panel-label\");\n-      deleteLayersLabel.getStyleClass().add(\"panel-label\");\n+      // create a view and add the ArcGISMap to it\n+      mapView = new MapView();\n+      mapView.setMap(map);\n+\n+      // set the initial viewpoint for the map view\n+      mapView.setViewpoint(new Viewpoint(37.056295, -111.195800, 10000000));\n \n-      // create list for deleted layers\n+      // add the image layers to the list of operational layers on the map\n+      mapLayers = map.getOperationalLayers();\n+      addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\");\n+      addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\");\n+      addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\");\n+", "originalCommit": "1ee7221aaa862d5e751a06358392b62eff9827ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcxMTYyNg==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r501711626", "bodyText": "Thanks @Rachael-E , this is ideal and works well, I've tested breaking the layers. Was trying to think the other way round and if they did load, rather than this pattern of if they didn't.", "author": "jenmerritt", "createdAt": "2020-10-08T13:16:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTAxMTcyNQ=="}], "type": "inlineReview"}, {"oid": "e179fc56fe0f2509adc5bf93510cf871dd25fe81", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/e179fc56fe0f2509adc5bf93510cf871dd25fe81", "message": "creation of image layers listener", "committedDate": "2020-10-08T13:16:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTgyMTU1NQ==", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/562#discussion_r501821555", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  // check that the layer has loaded correctly and if not display an error message\n          \n          \n            \n                  // check that each layer has loaded correctly and if not, display an error message", "author": "Rachael-E", "createdAt": "2020-10-08T15:41:02Z", "path": "map/manage-operational-layers/src/main/java/com/esri/samples/manage_operational_layers/ManageOperationalLayersSample.java", "diffHunk": "@@ -70,13 +72,24 @@ public void start(Stage stage) {\n       mapView.setMap(map);\n \n       // set the initial viewpoint for the map view\n-      mapView.setViewpoint(new Viewpoint(37.056295, -111.195800, 10000000));\n-\n-      // add the image layers to the list of operational layers on the map\n-      mapLayers = map.getOperationalLayers();\n-      addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\");\n-      addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\");\n-      addMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\");\n+      mapView.setViewpoint(new Viewpoint(41.056295, -106.195800, 20000000));\n+\n+      // create and add new image layers to the map's operational layers\n+      LayerList mapLayers = map.getOperationalLayers();\n+      mapLayers.addAll(Arrays.asList(\n+        (new ArcGISMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Elevation/WorldElevations/MapServer\")),\n+        (new ArcGISMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer\")),\n+        (new ArcGISMapImageLayer(\"https://sampleserver5.arcgisonline.com/arcgis/rest/services/Census/MapServer\"))\n+      ));\n+\n+      // check that the layer has loaded correctly and if not display an error message", "originalCommit": "e179fc56fe0f2509adc5bf93510cf871dd25fe81", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e55d2c891b858fac97dc0c9ae3474c56736bd2b9", "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/e55d2c891b858fac97dc0c9ae3474c56736bd2b9", "message": "comment correction", "committedDate": "2020-10-12T10:21:55Z", "type": "commit"}]}