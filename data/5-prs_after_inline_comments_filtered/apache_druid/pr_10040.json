{"pr_number": 10040, "pr_title": "Druid Avatica - Handle escaping of search characters correctly", "pr_createdAt": "2020-06-17T00:24:17Z", "pr_url": "https://github.com/apache/druid/pull/10040", "timeline": [{"oid": "b8b8dc39ccc2058dde0ea9dbdf7939a04c1e6933", "url": "https://github.com/apache/druid/commit/b8b8dc39ccc2058dde0ea9dbdf7939a04c1e6933", "message": "Fix Avatica based metadata queries by appending ESCAPE '\\' clause to the LIKE expressions", "committedDate": "2020-06-17T17:51:43Z", "type": "commit"}, {"oid": "b8b8dc39ccc2058dde0ea9dbdf7939a04c1e6933", "url": "https://github.com/apache/druid/commit/b8b8dc39ccc2058dde0ea9dbdf7939a04c1e6933", "message": "Fix Avatica based metadata queries by appending ESCAPE '\\' clause to the LIKE expressions", "committedDate": "2020-06-17T17:51:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTc4NjYwMg==", "url": "https://github.com/apache/druid/pull/10040#discussion_r441786602", "bodyText": "This looks like the right fix. Could you please make it to all of getSchemas, getTables, and getColumns? They have the same problem. It might be nice to create a private static helper function in this file to avoid all the boilerplate, too.", "author": "gianm", "createdAt": "2020-06-17T19:35:15Z", "path": "sql/src/main/java/org/apache/druid/sql/avatica/DruidMeta.java", "diffHunk": "@@ -446,15 +446,16 @@ public MetaResultSet getColumns(\n     }\n \n     if (schemaPattern.s != null) {\n-      whereBuilder.add(\"COLUMNS.TABLE_SCHEMA LIKE \" + Calcites.escapeStringLiteral(schemaPattern.s));", "originalCommit": "b8b8dc39ccc2058dde0ea9dbdf7939a04c1e6933", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTgyODkwNg==", "url": "https://github.com/apache/druid/pull/10040#discussion_r441828906", "bodyText": "Thanks for taking a look, @gianm . Pushed a commit to add the ESCAPE clause in the three methods along with tests.", "author": "samarthjain", "createdAt": "2020-06-17T20:55:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTc4NjYwMg=="}], "type": "inlineReview"}, {"oid": "72d8f2a9d6a97954e752caf54086ad454c6713a2", "url": "https://github.com/apache/druid/commit/72d8f2a9d6a97954e752caf54086ad454c6713a2", "message": "Add ESCAPE \\ clause to getSchemas() and getTables()", "committedDate": "2020-06-17T20:54:15Z", "type": "commit"}, {"oid": "72d8f2a9d6a97954e752caf54086ad454c6713a2", "url": "https://github.com/apache/druid/commit/72d8f2a9d6a97954e752caf54086ad454c6713a2", "message": "Add ESCAPE \\ clause to getSchemas() and getTables()", "committedDate": "2020-06-17T20:54:15Z", "type": "forcePushed"}, {"oid": "6b67acc2bd069ef7c1b80740df933ff6028bc9de", "url": "https://github.com/apache/druid/commit/6b67acc2bd069ef7c1b80740df933ff6028bc9de", "message": "Adjust test to incorporate new datasources", "committedDate": "2020-06-17T22:45:12Z", "type": "commit"}]}