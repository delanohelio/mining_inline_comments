{"pr_number": 10441, "pr_title": "vectorized group by support for nullable numeric columns", "pr_createdAt": "2020-09-27T10:45:15Z", "pr_url": "https://github.com/apache/druid/pull/10441", "timeline": [{"oid": "689903fac69145524a9f1dd42042b7c160c5c1e7", "url": "https://github.com/apache/druid/commit/689903fac69145524a9f1dd42042b7c160c5c1e7", "message": "vectorized group by support for numeric null columns", "committedDate": "2020-09-27T08:51:12Z", "type": "commit"}, {"oid": "311d744267fa8259ac6c30babfcd8a634860d570", "url": "https://github.com/apache/druid/commit/311d744267fa8259ac6c30babfcd8a634860d570", "message": "revert unintended change", "committedDate": "2020-09-27T10:37:12Z", "type": "commit"}, {"oid": "486b2f0b17783b075bdad713058e682b33dd47d4", "url": "https://github.com/apache/druid/commit/486b2f0b17783b075bdad713058e682b33dd47d4", "message": "adjust", "committedDate": "2020-09-28T06:17:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxMTUyNQ==", "url": "https://github.com/apache/druid/pull/10441#discussion_r499911525", "bodyText": "nit: an error message would help debugging if it really happened.", "author": "jihoonson", "createdAt": "2020-10-05T22:42:56Z", "path": "processing/src/main/java/org/apache/druid/query/groupby/epinephelinae/vector/GroupByVectorColumnProcessorFactory.java", "diffHunk": "@@ -39,32 +42,58 @@ public static GroupByVectorColumnProcessorFactory instance()\n   }\n \n   @Override\n-  public GroupByVectorColumnSelector makeSingleValueDimensionProcessor(final SingleValueDimensionVectorSelector selector)\n+  public GroupByVectorColumnSelector makeSingleValueDimensionProcessor(\n+      final ColumnCapabilities capabilities,\n+      final SingleValueDimensionVectorSelector selector\n+  )\n   {\n+    Preconditions.checkArgument(ValueType.STRING == capabilities.getType());", "originalCommit": "486b2f0b17783b075bdad713058e682b33dd47d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxNDY5Nw==", "url": "https://github.com/apache/druid/pull/10441#discussion_r499914697", "bodyText": "nit: Byte.BYTES", "author": "jihoonson", "createdAt": "2020-10-05T22:53:09Z", "path": "processing/src/main/java/org/apache/druid/query/groupby/epinephelinae/vector/NullableDoubleGroupByVectorColumnSelector.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.query.groupby.epinephelinae.vector;\n+\n+import org.apache.datasketches.memory.Memory;\n+import org.apache.datasketches.memory.WritableMemory;\n+import org.apache.druid.common.config.NullHandling;\n+import org.apache.druid.query.groupby.ResultRow;\n+import org.apache.druid.segment.vector.VectorValueSelector;\n+\n+public class NullableDoubleGroupByVectorColumnSelector implements GroupByVectorColumnSelector\n+{\n+  private final VectorValueSelector selector;\n+\n+  NullableDoubleGroupByVectorColumnSelector(final VectorValueSelector selector)\n+  {\n+    this.selector = selector;\n+  }\n+\n+  @Override\n+  public int getGroupingKeySize()\n+  {\n+    return 1 + Double.BYTES;", "originalCommit": "486b2f0b17783b075bdad713058e682b33dd47d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkyNzkyMQ==", "url": "https://github.com/apache/druid/pull/10441#discussion_r499927921", "bodyText": "i hope Byte.BYTES is always 1, I wouldn\u2019t know what to believe anymore \ud83d\ude05", "author": "clintropolis", "createdAt": "2020-10-05T23:36:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxNDY5Nw=="}], "type": "inlineReview"}, {"oid": "8773568cc0f9e0eb37cdc89a1857508c3fded26f", "url": "https://github.com/apache/druid/commit/8773568cc0f9e0eb37cdc89a1857508c3fded26f", "message": "review stuffs", "committedDate": "2020-10-05T23:45:23Z", "type": "commit"}, {"oid": "46c99cf40d64d40a12dfde67ce740daffe8acb33", "url": "https://github.com/apache/druid/commit/46c99cf40d64d40a12dfde67ce740daffe8acb33", "message": "Merge remote-tracking branch 'upstream/master' into vector-group-by-numeric-null", "committedDate": "2020-10-05T23:45:36Z", "type": "commit"}]}