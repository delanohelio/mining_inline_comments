{"pr_number": 1744, "pr_title": "fix(TBD-11597): Upgrade GCS and BigQuery connectors", "pr_createdAt": "2020-11-20T08:13:39Z", "pr_url": "https://github.com/Talend/tbd-studio-se/pull/1744", "timeline": [{"oid": "c7d728ff7316c0a9b48926ed4b8450d946021f86", "url": "https://github.com/Talend/tbd-studio-se/commit/c7d728ff7316c0a9b48926ed4b8450d946021f86", "message": "Add Hadoop3 flacor to CDH6x", "committedDate": "2020-11-20T08:12:33Z", "type": "commit"}, {"oid": "0baa9190a98b136227ecae3430f4536413b0b105", "url": "https://github.com/Talend/tbd-studio-se/commit/0baa9190a98b136227ecae3430f4536413b0b105", "message": "Merge branch 'maintenance/7.3' of github.com:Talend/tbd-studio-se into lbourgeois/tbd11597", "committedDate": "2020-11-26T08:15:27Z", "type": "commit"}, {"oid": "2064b89f1afc33fd14f7055c61c57276df6f5a3b", "url": "https://github.com/Talend/tbd-studio-se/commit/2064b89f1afc33fd14f7055c61c57276df6f5a3b", "message": "Add GCS module group to CDHxx", "committedDate": "2020-11-30T10:45:29Z", "type": "commit"}, {"oid": "e98828464a5b972318ca22a92bf1c4fdf26f28dc", "url": "https://github.com/Talend/tbd-studio-se/commit/e98828464a5b972318ca22a92bf1c4fdf26f28dc", "message": "Add GCS group to EMR", "committedDate": "2020-11-30T11:32:56Z", "type": "commit"}, {"oid": "e309bbf5101658f0dafb1d8252b1588c35c83fe3", "url": "https://github.com/Talend/tbd-studio-se/commit/e309bbf5101658f0dafb1d8252b1588c35c83fe3", "message": "Add GCS module group to DBR 3 & 5", "committedDate": "2020-11-30T14:03:38Z", "type": "commit"}, {"oid": "13def6f2922743c1a047caa6fe282a99aa179890", "url": "https://github.com/Talend/tbd-studio-se/commit/13def6f2922743c1a047caa6fe282a99aa179890", "message": "Add GCS module group to DBR 6", "committedDate": "2020-11-30T14:04:48Z", "type": "commit"}, {"oid": "bbd658fb716bc55837ad8f953d06a6af6ff90561", "url": "https://github.com/Talend/tbd-studio-se/commit/bbd658fb716bc55837ad8f953d06a6af6ff90561", "message": "fix cdhxx gcs module group", "committedDate": "2020-12-02T00:07:08Z", "type": "commit"}, {"oid": "bfc4cf5d68fdc0c9b6bbaabe48e1739a57e939c3", "url": "https://github.com/Talend/tbd-studio-se/commit/bfc4cf5d68fdc0c9b6bbaabe48e1739a57e939c3", "message": "Add GCS node module group for HDP", "committedDate": "2020-12-02T00:24:23Z", "type": "commit"}, {"oid": "a3becb483d8b76b29f3c3f1d12ea30aa57267791", "url": "https://github.com/Talend/tbd-studio-se/commit/a3becb483d8b76b29f3c3f1d12ea30aa57267791", "message": "Add GCS module group dor CDP", "committedDate": "2020-12-02T10:59:41Z", "type": "commit"}, {"oid": "66ab0364b40af5a4a8399c499baeb83286f43ad4", "url": "https://github.com/Talend/tbd-studio-se/commit/66ab0364b40af5a4a8399c499baeb83286f43ad4", "message": "Add GCS module group to HDI", "committedDate": "2020-12-02T13:33:32Z", "type": "commit"}, {"oid": "84a475dc56432c75be256d9570d637ec74356dce", "url": "https://github.com/Talend/tbd-studio-se/commit/84a475dc56432c75be256d9570d637ec74356dce", "message": "Merge branch 'maintenance/7.3' of github.com:Talend/tbd-studio-se into lbourgeois/tbd11597", "committedDate": "2020-12-02T14:07:48Z", "type": "commit"}, {"oid": "9fdcfe4373b19de3d4c65b96ac4d6b0c34c7542e", "url": "https://github.com/Talend/tbd-studio-se/commit/9fdcfe4373b19de3d4c65b96ac4d6b0c34c7542e", "message": "Add GCS group for MapR", "committedDate": "2020-12-02T15:43:11Z", "type": "commit"}, {"oid": "34dd8520625942cb350610c3729dcd0a702883c3", "url": "https://github.com/Talend/tbd-studio-se/commit/34dd8520625942cb350610c3729dcd0a702883c3", "message": "fix typo", "committedDate": "2020-12-02T15:47:02Z", "type": "commit"}, {"oid": "6bab729b379f335ea416d5bc7975496f290efc92", "url": "https://github.com/Talend/tbd-studio-se/commit/6bab729b379f335ea416d5bc7975496f290efc92", "message": "Define new node module group for BQ", "committedDate": "2020-12-02T17:13:15Z", "type": "commit"}, {"oid": "bea9f6fcd562380f543127d1b30b9bcbc3d3cfa0", "url": "https://github.com/Talend/tbd-studio-se/commit/bea9f6fcd562380f543127d1b30b9bcbc3d3cfa0", "message": "cdh6xx", "committedDate": "2020-12-02T17:25:54Z", "type": "commit"}, {"oid": "0abab80e3f3ba0ae490103cfda94b693293bcb74", "url": "https://github.com/Talend/tbd-studio-se/commit/0abab80e3f3ba0ae490103cfda94b693293bcb74", "message": "hdpxx", "committedDate": "2020-12-02T17:30:06Z", "type": "commit"}, {"oid": "1a2e871b67a264b69713e7b3d5104107f8b2b91c", "url": "https://github.com/Talend/tbd-studio-se/commit/1a2e871b67a264b69713e7b3d5104107f8b2b91c", "message": "BQ hdp", "committedDate": "2020-12-02T19:54:52Z", "type": "commit"}, {"oid": "215bbd826e8e8ef984415b746dc8c2c3c35b1b08", "url": "https://github.com/Talend/tbd-studio-se/commit/215bbd826e8e8ef984415b746dc8c2c3c35b1b08", "message": "BQ emr", "committedDate": "2020-12-03T01:03:38Z", "type": "commit"}, {"oid": "6972f5cd914d4e957a1980092e7ea73e378f34f7", "url": "https://github.com/Talend/tbd-studio-se/commit/6972f5cd914d4e957a1980092e7ea73e378f34f7", "message": "BQ DBR", "committedDate": "2020-12-03T01:16:31Z", "type": "commit"}, {"oid": "8a8f8a44d4d6274553d607e520f9fdfe1f04c3a0", "url": "https://github.com/Talend/tbd-studio-se/commit/8a8f8a44d4d6274553d607e520f9fdfe1f04c3a0", "message": "BQ CDPx", "committedDate": "2020-12-03T01:31:24Z", "type": "commit"}, {"oid": "57df74c20411544e204ab5dc1ee1a6f1f5955f08", "url": "https://github.com/Talend/tbd-studio-se/commit/57df74c20411544e204ab5dc1ee1a6f1f5955f08", "message": "BQ hdi", "committedDate": "2020-12-03T08:57:20Z", "type": "commit"}, {"oid": "19055d8788e198b61a28dff5dae2a2449eddc323", "url": "https://github.com/Talend/tbd-studio-se/commit/19055d8788e198b61a28dff5dae2a2449eddc323", "message": "BQ mapr", "committedDate": "2020-12-03T09:18:19Z", "type": "commit"}, {"oid": "9e7389fea5a414296b88dfb1fe4931e84a9f48bd", "url": "https://github.com/Talend/tbd-studio-se/commit/9e7389fea5a414296b88dfb1fe4931e84a9f48bd", "message": "BQ DTP", "committedDate": "2020-12-03T15:40:32Z", "type": "commit"}, {"oid": "2433d350a642a004877711659cca19a83958fdde", "url": "https://github.com/Talend/tbd-studio-se/commit/2433d350a642a004877711659cca19a83958fdde", "message": "Fix HDI4", "committedDate": "2020-12-04T00:30:10Z", "type": "commit"}, {"oid": "09fd6100e526e5063489e2074d3a6b25933c3576", "url": "https://github.com/Talend/tbd-studio-se/commit/09fd6100e526e5063489e2074d3a6b25933c3576", "message": "update cdh611 builtin", "committedDate": "2020-12-04T00:51:09Z", "type": "commit"}, {"oid": "ce21728f26ba350f8867107ee1ba4485ce702fea", "url": "https://github.com/Talend/tbd-studio-se/commit/ce21728f26ba350f8867107ee1ba4485ce702fea", "message": "update cdp711 builtin", "committedDate": "2020-12-04T00:51:29Z", "type": "commit"}, {"oid": "922cc910e75541a59104ef65a46a1ae996ff4e4d", "url": "https://github.com/Talend/tbd-studio-se/commit/922cc910e75541a59104ef65a46a1ae996ff4e4d", "message": "cdh513 builin", "committedDate": "2020-12-04T01:33:38Z", "type": "commit"}, {"oid": "7774ff4390a38f21df13b9394f53310ac9291e4a", "url": "https://github.com/Talend/tbd-studio-se/commit/7774ff4390a38f21df13b9394f53310ac9291e4a", "message": "hdp26 builtin", "committedDate": "2020-12-04T01:34:09Z", "type": "commit"}, {"oid": "cee23f736cebe80b73f34ef88bbbf0c4131badf3", "url": "https://github.com/Talend/tbd-studio-se/commit/cee23f736cebe80b73f34ef88bbbf0c4131badf3", "message": "hdp3 builtin", "committedDate": "2020-12-04T01:36:19Z", "type": "commit"}, {"oid": "d619a40b4bfadf7d6bec2ba6d3b0825564eefd97", "url": "https://github.com/Talend/tbd-studio-se/commit/d619a40b4bfadf7d6bec2ba6d3b0825564eefd97", "message": "update qubole and altus", "committedDate": "2020-12-04T10:08:58Z", "type": "commit"}, {"oid": "c0a29ba639f81e5a158cf29b76a867c137d5a7ef", "url": "https://github.com/Talend/tbd-studio-se/commit/c0a29ba639f81e5a158cf29b76a867c137d5a7ef", "message": "cdh statis distros", "committedDate": "2020-12-04T10:38:27Z", "type": "commit"}, {"oid": "d9c82a17e71ad64d209834b160b08c2a3c4e415d", "url": "https://github.com/Talend/tbd-studio-se/commit/d9c82a17e71ad64d209834b160b08c2a3c4e415d", "message": "fix var init issue", "committedDate": "2020-12-04T18:30:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU3NTkxNA==", "url": "https://github.com/Talend/tbd-studio-se/pull/1744#discussion_r537575914", "bodyText": "Collections.emptySet<>() return immutable collection, so if super.getModuleGroups().add(val) is called - then UnsupportedOperationExpcetion will be raised. I guess it should be just a new HashSet<>(); Agree?", "author": "amedvedenko", "createdAt": "2020-12-07T15:02:30Z", "path": "main/plugins/org.talend.hadoop.distribution/src/main/java/org/talend/hadoop/distribution/dynamic/template/modulegroup/node/spark/DynamicSparkNodeModuleGroup.java", "diffHunk": "@@ -0,0 +1,47 @@\n+// ============================================================================\n+//\n+// Copyright (C) 2006-2019 Talend Inc. - www.talend.com\n+//\n+// This source code is available under agreement available at\n+// %InstallDIR%\\features\\org.talend.rcp.branding.%PRODUCTNAME%\\%PRODUCTNAME%license.txt\n+//\n+// You should have received a copy of the agreement\n+// along with this program; if not, write to Talend SA\n+// 9 rue Pages 92150 Suresnes, France\n+//\n+// ============================================================================\n+package org.talend.hadoop.distribution.dynamic.template.modulegroup.node.spark;\n+\n+import java.util.Collections;\n+import java.util.Set;\n+\n+import org.apache.commons.lang.StringUtils;\n+import org.talend.hadoop.distribution.DistributionModuleGroup;\n+import org.talend.hadoop.distribution.dynamic.adapter.DynamicPluginAdapter;\n+import org.talend.hadoop.distribution.dynamic.template.modulegroup.DynamicModuleGroupConstant;\n+import org.talend.hadoop.distribution.dynamic.template.modulegroup.IDynamicModuleGroupConstant;\n+import org.talend.hadoop.distribution.dynamic.template.modulegroup.node.AbstractNodeModuleGroup;\n+import org.talend.hadoop.distribution.utils.ModuleGroupsUtils;\n+\n+public class DynamicSparkNodeModuleGroup extends AbstractNodeModuleGroup {\n+\n+    public DynamicSparkNodeModuleGroup(DynamicPluginAdapter pluginAdapter) {\n+        super(pluginAdapter);\n+    }\n+\n+    public Set<DistributionModuleGroup> getModuleGroups(String distribution, String version, IDynamicModuleGroupConstant moduleGroup, String condition) throws Exception {\n+        DynamicPluginAdapter pluginAdapter = getPluginAdapter();\n+\n+        String moduleGroupRuntimeId = pluginAdapter\n+                .getRuntimeModuleGroupIdByTemplateId(moduleGroup.getModuleName());\n+\n+        checkRuntimeId(moduleGroupRuntimeId);\n+\n+        if (StringUtils.isNotBlank(moduleGroupRuntimeId)) {\n+            return ModuleGroupsUtils.getModuleGroups(distribution, version, condition, moduleGroupRuntimeId, true);\n+        } else {\n+            return Collections.emptySet();\n+        }", "originalCommit": "d9c82a17e71ad64d209834b160b08c2a3c4e415d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU3NzMxMg==", "url": "https://github.com/Talend/tbd-studio-se/pull/1744#discussion_r537577312", "bodyText": "if UnsupportedOperationException is expected in case of add - then I agree with emptySet. But it seems it isn't expected", "author": "amedvedenko", "createdAt": "2020-12-07T15:04:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU3NTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzcwODg3NA==", "url": "https://github.com/Talend/tbd-studio-se/pull/1744#discussion_r537708874", "bodyText": "I honestly generalized what was done in DynamicSparkDynamoDBNodeModuleGroup so I guess immutability is not an issue here. I will try to clarify but thank you to go into such details", "author": "lbourgeois", "createdAt": "2020-12-07T17:55:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU3NTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzczNzM1Mw==", "url": "https://github.com/Talend/tbd-studio-se/pull/1744#discussion_r537737353", "bodyText": "ok, if immutability is ok then it's ok, LGTM", "author": "amedvedenko", "createdAt": "2020-12-07T18:38:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU3NTkxNA=="}], "type": "inlineReview"}, {"oid": "1fe5d5e0ce068f9bbfa1b7acb3b2e21e05a4aea7", "url": "https://github.com/Talend/tbd-studio-se/commit/1fe5d5e0ce068f9bbfa1b7acb3b2e21e05a4aea7", "message": "fix hdp2x template", "committedDate": "2020-12-08T10:34:09Z", "type": "commit"}, {"oid": "fe75edb55872a589eb7d0579878889b71381a22c", "url": "https://github.com/Talend/tbd-studio-se/commit/fe75edb55872a589eb7d0579878889b71381a22c", "message": "Merge branch 'maintenance/7.3' of github.com:Talend/tbd-studio-se into lbourgeois/tbd11597", "committedDate": "2020-12-10T11:08:06Z", "type": "commit"}, {"oid": "72dd912bc0511e43caf55afa817f25c289687454", "url": "https://github.com/Talend/tbd-studio-se/commit/72dd912bc0511e43caf55afa817f25c289687454", "message": "remove duplicate group in template", "committedDate": "2020-12-11T00:12:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDg3NjA2OQ==", "url": "https://github.com/Talend/tbd-studio-se/pull/1744#discussion_r540876069", "bodyText": "Were these imports missing in this class?\nI don't see you add their usage, maybe they are redundant?", "author": "hliashchuk", "createdAt": "2020-12-11T11:18:57Z", "path": "main/plugins/org.talend.hadoop.distribution.emr5290/src/main/java/org/talend/hadoop/distribution/emr5290/EMR5290Distribution.java", "diffHunk": "@@ -35,11 +36,15 @@\n import org.talend.hadoop.distribution.component.SparkStreamingComponent;\n import org.talend.hadoop.distribution.component.SqoopComponent;\n import org.talend.hadoop.distribution.condition.ComponentCondition;\n+import org.talend.hadoop.distribution.condition.common.SparkBatchLinkedNodeCondition;\n import org.talend.hadoop.distribution.constants.HDFSConstant;\n import org.talend.hadoop.distribution.constants.MRConstant;\n import org.talend.hadoop.distribution.constants.SparkBatchConstant;\n import org.talend.hadoop.distribution.constants.SparkStreamingConstant;\n import org.talend.hadoop.distribution.constants.emr.IAmazonEMRDistribution;\n+import org.talend.hadoop.distribution.dynamic.template.modulegroup.DynamicModuleGroupConstant;", "originalCommit": "72dd912bc0511e43caf55afa817f25c289687454", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDg5MjUzMg==", "url": "https://github.com/Talend/tbd-studio-se/pull/1744#discussion_r540892532", "bodyText": "You're right, some are not needed, good catch", "author": "lbourgeois", "createdAt": "2020-12-11T11:49:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDg3NjA2OQ=="}], "type": "inlineReview"}, {"oid": "01887080cc82e3c4d807686b3004084e3d6a7806", "url": "https://github.com/Talend/tbd-studio-se/commit/01887080cc82e3c4d807686b3004084e3d6a7806", "message": "Remove unused import", "committedDate": "2020-12-11T11:52:19Z", "type": "commit"}, {"oid": "2670060ef8eb71ed207b717cdbcc21cdd6697320", "url": "https://github.com/Talend/tbd-studio-se/commit/2670060ef8eb71ed207b717cdbcc21cdd6697320", "message": "Merge branch 'maintenance/7.3' of https://github.com/Talend/tbd-studio-se into lbourgeois/tbd11597", "committedDate": "2021-01-04T11:07:34Z", "type": "commit"}]}