{"pr_number": 16555, "pr_title": "Support bitmap indexes in client protocol", "pr_createdAt": "2020-01-24T12:43:21Z", "pr_url": "https://github.com/hazelcast/hazelcast/pull/16555", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDYzNjUwMg==", "url": "https://github.com/hazelcast/hazelcast/pull/16555#discussion_r370636502", "bodyText": "this should have default parameters set. aString for uniqueKey and anEnum equivalent for uniqueKeyTransformation fields", "author": "mdumandag", "createdAt": "2020-01-24T13:37:32Z", "path": "hazelcast/src/test/java/com/hazelcast/client/protocol/compatibility/ReferenceObjects.java", "diffHunk": "@@ -716,7 +717,8 @@ private static boolean isEqualStackTrace(StackTraceElement stackTraceElement1, S\n \n     public static ListenerConfigHolder aListenerConfigHolder = new ListenerConfigHolder(anInt, aData, aString, aBoolean, aBoolean);\n     public static AttributeConfig anAttributeConfig = new AttributeConfig(aString, aString);\n-    public static IndexConfig anIndexConfig = CustomTypeFactory.createIndexConfig(aString, anEnum, aListOfStrings);\n+    public static BitmapIndexOptions aBitmapIndexOptions = new BitmapIndexOptions();", "originalCommit": "0baaf4f577e22f1028e2e9d90773c17355142b89", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTEwMDc5Ng==", "url": "https://github.com/hazelcast/hazelcast/pull/16555#discussion_r371100796", "bodyText": "These two lines look dangerous to me because we mutate an object which was set earlier. Consider the following code:\nIndexConfig config = new IndexConfig();\nBitmapIndexOptions options = config1.getBitmapIndexOptions();\n// ...\nconfig.setBitmapIndexOptions(<new options>);\n// \"options\" object changed unexpectedly\n\nI would rather overwrite an object in the setter and perform a lazy initialization in getter as we do in other config classes (e.g. IndexConfig.getAttributes() copies this approach).", "author": "devozerov", "createdAt": "2020-01-27T08:03:22Z", "path": "hazelcast/src/main/java/com/hazelcast/config/IndexConfig.java", "diffHunk": "@@ -204,6 +204,18 @@ public BitmapIndexOptions getBitmapIndexOptions() {\n         return bitmapIndexOptions;\n     }\n \n+    /**\n+     * Sets bitmap index options of this index config to the given ones.\n+     *\n+     * @param bitmapIndexOptions the bitmap index options to set.\n+     * @return this index config instance.\n+     */\n+    public IndexConfig setBitmapIndexOptions(BitmapIndexOptions bitmapIndexOptions) {\n+        this.bitmapIndexOptions.setUniqueKey(bitmapIndexOptions.getUniqueKey());", "originalCommit": "47549ff3bd4e95725048393dc8fb111c586c51d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTEyNDE0Nw==", "url": "https://github.com/hazelcast/hazelcast/pull/16555#discussion_r371124147", "bodyText": "fixed in 656e856", "author": "taburet", "createdAt": "2020-01-27T09:07:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTEwMDc5Ng=="}], "type": "inlineReview"}, {"oid": "71fcb80046bfbe2322de61fc0f6cd1ea4abfc69f", "url": "https://github.com/hazelcast/hazelcast/commit/71fcb80046bfbe2322de61fc0f6cd1ea4abfc69f", "message": "Support bitmap indexes in client protocol", "committedDate": "2020-01-27T09:16:27Z", "type": "commit"}, {"oid": "5e9ff3bd509f36203289cd130201cc32b6ea9ba9", "url": "https://github.com/hazelcast/hazelcast/commit/5e9ff3bd509f36203289cd130201cc32b6ea9ba9", "message": "fix ReferenceObjects", "committedDate": "2020-01-27T09:16:27Z", "type": "commit"}, {"oid": "705e3bd5aeb89dab96ed74044d3b8954aae03011", "url": "https://github.com/hazelcast/hazelcast/commit/705e3bd5aeb89dab96ed74044d3b8954aae03011", "message": "update compatibility binaries", "committedDate": "2020-01-27T09:16:27Z", "type": "commit"}, {"oid": "b8a8ba58dc8689bb5fa150aff2229d076413c84d", "url": "https://github.com/hazelcast/hazelcast/commit/b8a8ba58dc8689bb5fa150aff2229d076413c84d", "message": "make options nullable", "committedDate": "2020-01-27T09:16:27Z", "type": "commit"}, {"oid": "d5b5fc648547f902b03f88917670be731e69fa78", "url": "https://github.com/hazelcast/hazelcast/commit/d5b5fc648547f902b03f88917670be731e69fa78", "message": "regenerate client protocol", "committedDate": "2020-01-27T09:16:27Z", "type": "commit"}, {"oid": "d5b5fc648547f902b03f88917670be731e69fa78", "url": "https://github.com/hazelcast/hazelcast/commit/d5b5fc648547f902b03f88917670be731e69fa78", "message": "regenerate client protocol", "committedDate": "2020-01-27T09:16:27Z", "type": "forcePushed"}]}