{"pr_number": 1118, "pr_title": "\u0424\u0443\u043d\u043a\u0446\u0438\u044f \u0432\u0441\u0435\u0433\u0434\u0430 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043e\u0434\u043d\u043e \u0438 \u0442\u043e \u0436\u0435 \u043f\u0440\u0438\u043c\u0438\u0442\u0438\u0432\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435", "pr_createdAt": "2020-04-25T18:42:43Z", "pr_url": "https://github.com/1c-syntax/bsl-language-server/pull/1118", "timeline": [{"oid": "02f3293074f2456b0f941591ba63a655ca4dd53a", "url": "https://github.com/1c-syntax/bsl-language-server/commit/02f3293074f2456b0f941591ba63a655ca4dd53a", "message": "\u041f\u0435\u0440\u0432\u043e\u0435 \u043f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u0438\u0435", "committedDate": "2020-04-25T16:29:52Z", "type": "commit"}, {"oid": "f687ef3626081d41c1d5444d2d6c337c1f373679", "url": "https://github.com/1c-syntax/bsl-language-server/commit/f687ef3626081d41c1d5444d2d6c337c1f373679", "message": "\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0435 \u043f\u0440\u0438\u043c\u0438\u0442\u0438\u0432\u043e\u0432, \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043d\u0430 ru, \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u043c\u0435\u043d\u0438 \u0444\u0430\u0439\u043b\u0430 \u043a\u0435\u0439\u0441\u0430 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0430", "committedDate": "2020-04-25T18:23:36Z", "type": "commit"}, {"oid": "4421d3b4737e0b330b7df794b8564ca8f967e801", "url": "https://github.com/1c-syntax/bsl-language-server/commit/4421d3b4737e0b330b7df794b8564ca8f967e801", "message": "\u0414\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f, \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043f\u0440\u0435\u043a\u043e\u043c\u043c\u0438\u0442, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u043d\u0430\u044f \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u044f \u0432 \u0444\u0430\u0439\u043b\u0435 \u0442\u0435\u0441\u0442\u0430.", "committedDate": "2020-04-25T18:38:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTEyMDM3NA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r415120374", "bodyText": "\u0410 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430 \u0440\u0430\u0437\u043c\u0435\u0440 \u0437\u0430\u0447\u0435\u043c?", "author": "asosnoviy", "createdAt": "2020-04-25T18:48:22Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/FunctionReturnsSamePrimitiveDiagnostic.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.diagnostics;\n+\n+import com.github._1c_syntax.bsl.languageserver.context.symbol.MethodSymbol;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticInfo;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticMetadata;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticSeverity;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticTag;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticType;\n+import com.github._1c_syntax.bsl.languageserver.utils.Ranges;\n+import com.github._1c_syntax.bsl.languageserver.utils.RelatedInformation;\n+import com.github._1c_syntax.bsl.languageserver.utils.Trees;\n+import com.github._1c_syntax.bsl.parser.BSLParser;\n+import org.antlr.v4.runtime.ParserRuleContext;\n+import org.antlr.v4.runtime.tree.ParseTree;\n+import org.eclipse.lsp4j.Range;\n+\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+@DiagnosticMetadata(\n+  type = DiagnosticType.ERROR,\n+  severity = DiagnosticSeverity.MAJOR,\n+  minutesToFix = 5,\n+  tags = {\n+    DiagnosticTag.DESIGN,\n+    DiagnosticTag.BADPRACTICE\n+  }\n+\n+)\n+public class FunctionReturnsSamePrimitiveDiagnostic extends AbstractVisitorDiagnostic {\n+\n+  private static final String KEY_MESSAGE = \"diagnosticMessageReturnStatement\";\n+\n+  public FunctionReturnsSamePrimitiveDiagnostic(DiagnosticInfo info) {\n+    super(info);\n+  }\n+\n+  @Override\n+  public ParseTree visitFunction(BSLParser.FunctionContext ctx) {\n+    var tree = Trees.findAllRuleNodes(ctx, BSLParser.RULE_returnStatement);\n+    if (tree.size() > 1) {\n+      var expressions = tree.stream()\n+        .map(BSLParser.ReturnStatementContext.class::cast)\n+        .map(BSLParser.ReturnStatementContext::expression)\n+        .flatMap(Stream::ofNullable)\n+        .collect(Collectors.toList());\n+\n+      expressions.stream()\n+        .map(expression -> Trees.findAllRuleNodes(expression, BSLParser.RULE_complexIdentifier))\n+        .filter(Collection::isEmpty)\n+        .findAny()\n+        .ifPresent(\n+          parseTrees -> checkPrimitiveValue(ctx, tree, expressions)\n+        );\n+    }\n+    return ctx;\n+  }\n+\n+  private void checkPrimitiveValue(\n+    BSLParser.FunctionContext ctx, Collection<ParseTree> tree, List<BSLParser.ExpressionContext> expressions) {\n+\n+    var set = expressions.stream().map(BSLParser.ExpressionContext::getText).collect(Collectors.toSet());\n+    if (set.size() == 1) {", "originalCommit": "4421d3b4737e0b330b7df794b8564ca8f967e801", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTEyMTI2Ng==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r415121266", "bodyText": "\u0435\u0441\u043b\u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u044b\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e.", "author": "otymko", "createdAt": "2020-04-25T18:53:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTEyMDM3NA=="}], "type": "inlineReview"}, {"oid": "d4e585a1e9c999c950d5c6b1971d84ce1f8678e8", "url": "https://github.com/1c-syntax/bsl-language-server/commit/d4e585a1e9c999c950d5c6b1971d84ce1f8678e8", "message": "\u041f\u0435\u0440\u0432\u043e\u0435 \u043f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u0438\u0435", "committedDate": "2020-04-25T19:11:20Z", "type": "commit"}, {"oid": "e40a786fef5f118b230bcc336ec0892a5cc3d6af", "url": "https://github.com/1c-syntax/bsl-language-server/commit/e40a786fef5f118b230bcc336ec0892a5cc3d6af", "message": "\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0435 \u043f\u0440\u0438\u043c\u0438\u0442\u0438\u0432\u043e\u0432, \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043d\u0430 ru, \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u043c\u0435\u043d\u0438 \u0444\u0430\u0439\u043b\u0430 \u043a\u0435\u0439\u0441\u0430 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0430", "committedDate": "2020-04-25T19:11:21Z", "type": "commit"}, {"oid": "c9a65c76b9e44a8eb71347890ffe7287598a1bb4", "url": "https://github.com/1c-syntax/bsl-language-server/commit/c9a65c76b9e44a8eb71347890ffe7287598a1bb4", "message": "\u0414\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f, \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043f\u0440\u0435\u043a\u043e\u043c\u043c\u0438\u0442, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u043d\u0430\u044f \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u044f \u0432 \u0444\u0430\u0439\u043b\u0435 \u0442\u0435\u0441\u0442\u0430.", "committedDate": "2020-04-25T19:12:05Z", "type": "commit"}, {"oid": "17fcd03e91d54dac680eff364a240876302c568b", "url": "https://github.com/1c-syntax/bsl-language-server/commit/17fcd03e91d54dac680eff364a240876302c568b", "message": "+ \u043f\u0440\u0435\u043a\u043e\u043c\u043c\u0438\u0442", "committedDate": "2020-04-25T19:14:16Z", "type": "commit"}, {"oid": "b217bf88e799d1ea58e100ccd3fedd4c82ac7b00", "url": "https://github.com/1c-syntax/bsl-language-server/commit/b217bf88e799d1ea58e100ccd3fedd4c82ac7b00", "message": "Merge branch 'feature/issue110' of https://github.com/1c-syntax/bsl-language-server into feature/issue110\n\n# Conflicts:\n#\tdocs/diagnostics/index.md\n#\tdocs/en/diagnostics/index.md\n#\tsrc/main/resources/com/github/_1c_syntax/bsl/languageserver/configuration/parameters-schema.json", "committedDate": "2020-04-25T19:15:12Z", "type": "commit"}, {"oid": "c8ca3ba1d16ac0e4a1e64c1c5b6953a9ff0c4ce4", "url": "https://github.com/1c-syntax/bsl-language-server/commit/c8ca3ba1d16ac0e4a1e64c1c5b6953a9ff0c4ce4", "message": "\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0438\u0437 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439", "committedDate": "2020-04-26T01:59:12Z", "type": "commit"}, {"oid": "4cef417ce48e4d7cb4a51bab5886da44ed343171", "url": "https://github.com/1c-syntax/bsl-language-server/commit/4cef417ce48e4d7cb4a51bab5886da44ed343171", "message": "\u0414\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438", "committedDate": "2020-04-26T01:59:21Z", "type": "commit"}, {"oid": "52da61470e6d024357b4cd274150456fc68b63cf", "url": "https://github.com/1c-syntax/bsl-language-server/commit/52da61470e6d024357b4cd274150456fc68b63cf", "message": "\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0432 \u0440\u0430\u0437\u043d\u044b\u0445 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0445 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 Null \u0438 NULL)", "committedDate": "2020-04-26T11:40:34Z", "type": "commit"}, {"oid": "b02973bae3543c65cf0a5805e3095d39aa77d721", "url": "https://github.com/1c-syntax/bsl-language-server/commit/b02973bae3543c65cf0a5805e3095d39aa77d721", "message": "\u041d\u0435 \u043f\u0440\u0435\u0432\u043e\u0434\u0438\u0442\u044c \u0421\u0442\u0440\u043e\u043a\u0438 \u043a \u0432\u0435\u0440\u0445\u043d\u0435\u043c\u0443 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0443", "committedDate": "2020-04-26T14:41:13Z", "type": "commit"}, {"oid": "8bf2479a9ab15de37f05a7067a91ce7f0b62a8cf", "url": "https://github.com/1c-syntax/bsl-language-server/commit/8bf2479a9ab15de37f05a7067a91ce7f0b62a8cf", "message": "Merge branch 'develop' into feature/issue110", "committedDate": "2020-04-26T14:54:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUxNTMxMw==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r415515313", "bodyText": "\u0412\u044b\u043d\u043e\u0441\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043d\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0435 \u0432 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440, \u043f\u0443\u0441\u0442\u044c \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u0442\u0438\u043d\u0430.", "author": "theshadowco", "createdAt": "2020-04-27T05:13:00Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/FunctionReturnsSamePrimitiveDiagnostic.java", "diffHunk": "@@ -0,0 +1,131 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.diagnostics;\n+\n+import com.github._1c_syntax.bsl.languageserver.context.symbol.MethodSymbol;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticInfo;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticMetadata;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticSeverity;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticTag;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticType;\n+import com.github._1c_syntax.bsl.languageserver.utils.Ranges;\n+import com.github._1c_syntax.bsl.languageserver.utils.RelatedInformation;\n+import com.github._1c_syntax.bsl.languageserver.utils.Trees;\n+import com.github._1c_syntax.bsl.parser.BSLParser;\n+import org.antlr.v4.runtime.ParserRuleContext;\n+import org.antlr.v4.runtime.tree.ParseTree;\n+import org.eclipse.lsp4j.Range;\n+\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Locale;\n+import java.util.Optional;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+@DiagnosticMetadata(\n+  type = DiagnosticType.ERROR,\n+  severity = DiagnosticSeverity.MAJOR,\n+  minutesToFix = 5,\n+  tags = {\n+    DiagnosticTag.DESIGN,\n+    DiagnosticTag.BADPRACTICE\n+  }\n+\n+)\n+public class FunctionReturnsSamePrimitiveDiagnostic extends AbstractVisitorDiagnostic {\n+\n+  private static final String KEY_MESSAGE = \"diagnosticMessageReturnStatement\";\n+  private static final Pattern pattern = Pattern.compile(\n+    \"^(\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0439|attachable)_\", Pattern.CASE_INSENSITIVE | Pattern.UNICODE_CASE);\n+\n+  public FunctionReturnsSamePrimitiveDiagnostic(DiagnosticInfo info) {\n+    super(info);\n+  }\n+\n+  @Override\n+  public ParseTree visitFunction(BSLParser.FunctionContext ctx) {\n+\n+    var abortCheck = Optional.ofNullable(ctx.funcDeclaration())", "originalCommit": "8bf2479a9ab15de37f05a7067a91ce7f0b62a8cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTYwMTg5Mw==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r415601893", "bodyText": "\u041d\u0443 \u0440\u0430\u0437 \u0442\u0435\u0431\u0435 \u043d\u0443\u0436\u043d\u0430 - \u0434\u0430\u0432\u0430\u0439 \u0441\u0434\u0435\u043b\u0430\u0435\u043c )", "author": "otymko", "createdAt": "2020-04-27T08:09:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUxNTMxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk4OTMzNQ==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r415989335", "bodyText": "", "author": "otymko", "createdAt": "2020-04-27T17:03:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUxNTMxMw=="}], "type": "inlineReview"}, {"oid": "bc14bb63f3fd7ad805c4a8ba8d737ee3cfce90fd", "url": "https://github.com/1c-syntax/bsl-language-server/commit/bc14bb63f3fd7ad805c4a8ba8d737ee3cfce90fd", "message": "CommonModuleNameClientServerDiagnostic \u0437\u0430\u0433\u043e\u0442\u043e\u0432\u043a\u0430", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "ba37830972f040080aa6242215d4fa1c3f6f1953", "url": "https://github.com/1c-syntax/bsl-language-server/commit/ba37830972f040080aa6242215d4fa1c3f6f1953", "message": "\u0443\u0437\u043e\u0440\u044b \u0432 \u0442\u0435\u0441\u0442\u0435", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "5fc6de251d1d1a677ac82369162280be025d5871", "url": "https://github.com/1c-syntax/bsl-language-server/commit/5fc6de251d1d1a677ac82369162280be025d5871", "message": "\u043f\u043e\u043c\u0435\u043d\u044f\u043b\u043e\u0441\u044c \u0432\u0441\u0435", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "5dbb27ed493451025f63e556e15525ebc7509a0b", "url": "https://github.com/1c-syntax/bsl-language-server/commit/5dbb27ed493451025f63e556e15525ebc7509a0b", "message": "test \u0438\u0437\u043c\u0435\u043d\u043d\u0435\u043d", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "0a250d97a58923c1b7bf2f41759e15a70d7ef2a8", "url": "https://github.com/1c-syntax/bsl-language-server/commit/0a250d97a58923c1b7bf2f41759e15a70d7ef2a8", "message": "\u0440\u0435\u0441\u0443\u0440\u0441\u044b", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "2a6cbe2ba211c5ec97ad9b8278817aa16c01766e", "url": "https://github.com/1c-syntax/bsl-language-server/commit/2a6cbe2ba211c5ec97ad9b8278817aa16c01766e", "message": "\u0434\u043e\u043a\u0430", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "a13d9285cc499acd096dca8b80e0fb66916fc625", "url": "https://github.com/1c-syntax/bsl-language-server/commit/a13d9285cc499acd096dca8b80e0fb66916fc625", "message": "license add", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "3b70c1b93f8492605e3b5557683639a303bc0afe", "url": "https://github.com/1c-syntax/bsl-language-server/commit/3b70c1b93f8492605e3b5557683639a303bc0afe", "message": "\u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043a\u0430 \u0438 \u0442\u0435\u0433\u0438", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "2aea4e10a00633623c0769218d1b6ba28600e0e8", "url": "https://github.com/1c-syntax/bsl-language-server/commit/2aea4e10a00633623c0769218d1b6ba28600e0e8", "message": "precommit", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "cc0b0ec7e9963417e0de286981ecbd0ebb83bf4f", "url": "https://github.com/1c-syntax/bsl-language-server/commit/cc0b0ec7e9963417e0de286981ecbd0ebb83bf4f", "message": "CommonModuleNameServerCallDiagnostic", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "5ca7c57febb10902da5d6e26da14aa286a620536", "url": "https://github.com/1c-syntax/bsl-language-server/commit/5ca7c57febb10902da5d6e26da14aa286a620536", "message": "abstract common module", "committedDate": "2020-04-27T06:30:51Z", "type": "commit"}, {"oid": "5279aaf1db75a7b4e2d6c42c4fe3b71f32d589aa", "url": "https://github.com/1c-syntax/bsl-language-server/commit/5279aaf1db75a7b4e2d6c42c4fe3b71f32d589aa", "message": "precommit", "committedDate": "2020-04-27T06:31:15Z", "type": "commit"}, {"oid": "1346289815e0f7760ff8bce1cee225ed58f25938", "url": "https://github.com/1c-syntax/bsl-language-server/commit/1346289815e0f7760ff8bce1cee225ed58f25938", "message": "CommonModuleNameClientDiagnstic", "committedDate": "2020-04-27T06:31:26Z", "type": "commit"}, {"oid": "1f3c710db7215babeaa58ae59ca6ca4598637199", "url": "https://github.com/1c-syntax/bsl-language-server/commit/1f3c710db7215babeaa58ae59ca6ca4598637199", "message": "CommonModuleNameGlobalDiagnostic", "committedDate": "2020-04-27T06:31:46Z", "type": "commit"}, {"oid": "f9fd96083924b6ff986fa82842009a730be89757", "url": "https://github.com/1c-syntax/bsl-language-server/commit/f9fd96083924b6ff986fa82842009a730be89757", "message": "CommonModuleNameFullAccessDiagnostic", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "2958098074abd213efdc02f2bcc426db14a902a4", "url": "https://github.com/1c-syntax/bsl-language-server/commit/2958098074abd213efdc02f2bcc426db14a902a4", "message": "CommonModuleNameCashedDiagnostic", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "85a0f9ba3148b0592c6f73d3bb726c78a34bfc46", "url": "https://github.com/1c-syntax/bsl-language-server/commit/85a0f9ba3148b0592c6f73d3bb726c78a34bfc46", "message": "CommonModuleGlobalClientDiagnostic", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "a4c9866724e012ba3d510d806c1c4a6ae8000a0b", "url": "https://github.com/1c-syntax/bsl-language-server/commit/a4c9866724e012ba3d510d806c1c4a6ae8000a0b", "message": "test empty file", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "d54c5a72df2c04a175ae1c19797d9353e2eb5a7e", "url": "https://github.com/1c-syntax/bsl-language-server/commit/d54c5a72df2c04a175ae1c19797d9353e2eb5a7e", "message": "regexp fix", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "8427d107835a78f5cba724057c4685fd56262574", "url": "https://github.com/1c-syntax/bsl-language-server/commit/8427d107835a78f5cba724057c4685fd56262574", "message": "precommit", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "3c66ea93ae264e6f9aaee7f9c198008935642bbc", "url": "https://github.com/1c-syntax/bsl-language-server/commit/3c66ea93ae264e6f9aaee7f9c198008935642bbc", "message": "patter \u0432 super", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "f0a71a1eaa649c15d8c26db6e49d32dd9af4c974", "url": "https://github.com/1c-syntax/bsl-language-server/commit/f0a71a1eaa649c15d8c26db6e49d32dd9af4c974", "message": "Metadata", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "1376750a4daa7f36e4e9b3ade52d84820761ceed", "url": "https://github.com/1c-syntax/bsl-language-server/commit/1376750a4daa7f36e4e9b3ade52d84820761ceed", "message": "docs", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "73635a7e3c67d28a68a8f39be2361923c1363223", "url": "https://github.com/1c-syntax/bsl-language-server/commit/73635a7e3c67d28a68a8f39be2361923c1363223", "message": "\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043c\u043d\u043e\u0433\u043e\u0442\u0435\u0433\u043e\u0432", "committedDate": "2020-04-27T06:32:09Z", "type": "commit"}, {"oid": "8cc345d1e3507b35b14f7c4496f6fee4a5fdb0c2", "url": "https://github.com/1c-syntax/bsl-language-server/commit/8cc345d1e3507b35b14f7c4496f6fee4a5fdb0c2", "message": "precommit", "committedDate": "2020-04-27T06:32:32Z", "type": "commit"}, {"oid": "10c966a642cd36ca1895e04de6fb10a50df4e83c", "url": "https://github.com/1c-syntax/bsl-language-server/commit/10c966a642cd36ca1895e04de6fb10a50df4e83c", "message": "matches -> find", "committedDate": "2020-04-27T06:32:32Z", "type": "commit"}, {"oid": "12563b0f45b62458e7623bfb427215855d827013", "url": "https://github.com/1c-syntax/bsl-language-server/commit/12563b0f45b62458e7623bfb427215855d827013", "message": "\u043d\u0430 \u043f\u0435\u0440\u0432\u044b\u0439 \u0442\u043e\u043a\u0435\u043d \u0434\u0435\u0444\u0430\u0443\u043b\u0442 \u0447\u0435\u043d\u043d\u0435\u043b\u0430", "committedDate": "2020-04-27T06:32:32Z", "type": "commit"}, {"oid": "3bd9829aacb3a0ae3a4fce32db7c1c58e2d638c3", "url": "https://github.com/1c-syntax/bsl-language-server/commit/3bd9829aacb3a0ae3a4fce32db7c1c58e2d638c3", "message": "Create StyleGuide.md", "committedDate": "2020-04-27T10:12:30Z", "type": "commit"}, {"oid": "63eb898b50cdd8f81491b776ec83a51548a4a723", "url": "https://github.com/1c-syntax/bsl-language-server/commit/63eb898b50cdd8f81491b776ec83a51548a4a723", "message": "Update index.md", "committedDate": "2020-04-27T10:12:55Z", "type": "commit"}, {"oid": "59844692c03891a3a09dde85c104e9c2d8008ed1", "url": "https://github.com/1c-syntax/bsl-language-server/commit/59844692c03891a3a09dde85c104e9c2d8008ed1", "message": "Update index.md", "committedDate": "2020-04-27T10:14:49Z", "type": "commit"}, {"oid": "742092b54eadac6e8185ef2dee66cd60149a9e04", "url": "https://github.com/1c-syntax/bsl-language-server/commit/742092b54eadac6e8185ef2dee66cd60149a9e04", "message": "\u0422\u0435\u0441\u0442 \u043d\u0430 \u0444\u043f \u041a\u043b\u0438\u0435\u043d\u0442\u0427\u0435\u0433\u043e\u0422\u043e\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0439", "committedDate": "2020-04-27T11:04:22Z", "type": "commit"}, {"oid": "3d936d8606464bf8ebbe0cde125fb3ffb7641cbd", "url": "https://github.com/1c-syntax/bsl-language-server/commit/3d936d8606464bf8ebbe0cde125fb3ffb7641cbd", "message": "fp fix", "committedDate": "2020-04-27T14:36:57Z", "type": "commit"}, {"oid": "4efa4334c03a40bbc4bf5dd8bfd51fa82284c0b9", "url": "https://github.com/1c-syntax/bsl-language-server/commit/4efa4334c03a40bbc4bf5dd8bfd51fa82284c0b9", "message": "utils.CaseInsentivitesPatern", "committedDate": "2020-04-27T14:37:35Z", "type": "commit"}, {"oid": "58cf2407aa5467f408d077e43a8df92f1854daea", "url": "https://github.com/1c-syntax/bsl-language-server/commit/58cf2407aa5467f408d077e43a8df92f1854daea", "message": "tests", "committedDate": "2020-04-27T14:37:52Z", "type": "commit"}, {"oid": "7aa3a3b9f354f0e75b00be014e2dcd9fd2b26b80", "url": "https://github.com/1c-syntax/bsl-language-server/commit/7aa3a3b9f354f0e75b00be014e2dcd9fd2b26b80", "message": "precommit", "committedDate": "2020-04-27T14:38:27Z", "type": "commit"}, {"oid": "af8af0c6798d3a4902d590b55c777a1da3fccf25", "url": "https://github.com/1c-syntax/bsl-language-server/commit/af8af0c6798d3a4902d590b55c777a1da3fccf25", "message": "\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \"\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b\" \u0438 \u0434\u043e\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0442\u0435\u0441\u0442\u043e\u0432", "committedDate": "2020-04-27T17:02:18Z", "type": "commit"}, {"oid": "406078f2faa521663e0bc245bd226ab56d355776", "url": "https://github.com/1c-syntax/bsl-language-server/commit/406078f2faa521663e0bc245bd226ab56d355776", "message": "\u041f\u0440\u0435\u043a\u043e\u043c\u043c\u0438\u0442", "committedDate": "2020-04-27T17:03:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk5NDU3MA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r415994570", "bodyText": "@otymko \u0430 \u0442\u0443\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442\u0441\u044f \u043d\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 \u043b\u0438 \u044d\u0442\u043e? \u0410 \u043d\u0435\u0442 \u0441\u043f\u043e\u0441\u043e\u0431\u0430 \u043f\u043e\u043f\u0440\u043e\u0449\u0435?", "author": "asosnoviy", "createdAt": "2020-04-27T17:11:02Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/FunctionReturnsSamePrimitiveDiagnostic.java", "diffHunk": "@@ -0,0 +1,141 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.diagnostics;\n+\n+import com.github._1c_syntax.bsl.languageserver.context.symbol.MethodSymbol;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticInfo;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticMetadata;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticParameter;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticSeverity;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticTag;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticType;\n+import com.github._1c_syntax.bsl.languageserver.utils.Ranges;\n+import com.github._1c_syntax.bsl.languageserver.utils.RelatedInformation;\n+import com.github._1c_syntax.bsl.languageserver.utils.Trees;\n+import com.github._1c_syntax.bsl.parser.BSLParser;\n+import org.antlr.v4.runtime.ParserRuleContext;\n+import org.antlr.v4.runtime.tree.ParseTree;\n+import org.eclipse.lsp4j.Range;\n+\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Locale;\n+import java.util.Optional;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+@DiagnosticMetadata(\n+  type = DiagnosticType.ERROR,\n+  severity = DiagnosticSeverity.MAJOR,\n+  minutesToFix = 5,\n+  tags = {\n+    DiagnosticTag.DESIGN,\n+    DiagnosticTag.BADPRACTICE\n+  }\n+\n+)\n+public class FunctionReturnsSamePrimitiveDiagnostic extends AbstractVisitorDiagnostic {\n+\n+  private static final String KEY_MESSAGE = \"diagnosticMessageReturnStatement\";\n+  private static final Pattern pattern = Pattern.compile(\n+    \"^(\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0439|attachable)_\", Pattern.CASE_INSENSITIVE | Pattern.UNICODE_CASE);\n+\n+  private static final boolean CHECK_ATTACHABLE_METHODS = true;\n+\n+  @DiagnosticParameter(\n+    type = Boolean.class,\n+    defaultValue = \"\" + CHECK_ATTACHABLE_METHODS\n+  )\n+  private boolean checkAttachableMethods = CHECK_ATTACHABLE_METHODS;\n+\n+  public FunctionReturnsSamePrimitiveDiagnostic(DiagnosticInfo info) {\n+    super(info);\n+  }\n+\n+  @Override\n+  public ParseTree visitFunction(BSLParser.FunctionContext ctx) {\n+\n+    if (checkAttachableMethods) {\n+      // \u0418\u0441\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b\n+      var abortCheck = Optional.ofNullable(ctx.funcDeclaration())\n+        .map(BSLParser.FuncDeclarationContext::subName)\n+        .filter(subNameContext -> pattern.matcher(subNameContext.getText()).find())\n+        .isPresent();\n+      if (abortCheck) {\n+        return ctx;\n+      }\n+    }\n+\n+    var tree = Trees.findAllRuleNodes(ctx, BSLParser.RULE_returnStatement);\n+    if (tree.size() > 1) {\n+      var expressions = tree.stream()\n+        .map(BSLParser.ReturnStatementContext.class::cast)\n+        .map(BSLParser.ReturnStatementContext::expression)\n+        .flatMap(Stream::ofNullable)\n+        .collect(Collectors.toList());\n+\n+      expressions.stream()\n+        .map(expression -> Trees.findAllRuleNodes(expression, BSLParser.RULE_complexIdentifier))\n+        .filter(Collection::isEmpty)\n+        .findAny()\n+        .ifPresent(\n+          parseTrees -> checkPrimitiveValue(ctx, tree, expressions)\n+        );\n+    }\n+    return ctx;\n+  }\n+\n+  private void checkPrimitiveValue(\n+    BSLParser.FunctionContext ctx, Collection<ParseTree> tree, List<BSLParser.ExpressionContext> expressions) {\n+\n+    var set = expressions.stream()\n+      .map((BSLParser.ExpressionContext expression) -> {\n+        var text = expression.getText();\n+        if (Trees.findAllRuleNodes(expression, BSLParser.RULE_string).isEmpty()) {", "originalCommit": "406078f2faa521663e0bc245bd226ab56d355776", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjAwMjE0Mw==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r416002143", "bodyText": "\u0422\u0443\u0442 \u0434\u0432\u0430 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u0430. \u041b\u0438\u0431\u043e \u0437\u0430\u0431\u0438\u0442\u044c \u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u0441\u0442\u0440\u043e\u043a (\u0442.\u043a. \u043a\u0435\u0439\u0441 \u043d\u0435 \u043f\u043e\u043d\u044f\u0442\u0435\u043d) \u0438\u043b\u0438 \u0438\u0441\u043a\u0430\u0442\u044c \u0432 \u0441\u0442\u0440\u043e\u043a\u0435 \"", "author": "otymko", "createdAt": "2020-04-27T17:21:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk5NDU3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjAxMjIwOQ==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r416012209", "bodyText": "\u041a\u0430\u043f\u0435\u043b\u044c\u043a\u0443 \u043f\u0440\u043e\u0449\u0435 !Trees.nodeContains(expression, BSLParser.RULE_string)", "author": "asosnoviy", "createdAt": "2020-04-27T17:35:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk5NDU3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjAxMzEwNA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r416013104", "bodyText": "\u0411\u0443\u0434\u0443 \u0437\u043d\u0430\u0442\u044c", "author": "otymko", "createdAt": "2020-04-27T17:36:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk5NDU3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjAxMjQ0Ng==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r416012446", "bodyText": "info.getMessage() \u043d\u0435 \u043d\u0443\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c", "author": "asosnoviy", "createdAt": "2020-04-27T17:35:37Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/FunctionReturnsSamePrimitiveDiagnostic.java", "diffHunk": "@@ -0,0 +1,141 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.diagnostics;\n+\n+import com.github._1c_syntax.bsl.languageserver.context.symbol.MethodSymbol;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticInfo;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticMetadata;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticParameter;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticSeverity;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticTag;\n+import com.github._1c_syntax.bsl.languageserver.diagnostics.metadata.DiagnosticType;\n+import com.github._1c_syntax.bsl.languageserver.utils.Ranges;\n+import com.github._1c_syntax.bsl.languageserver.utils.RelatedInformation;\n+import com.github._1c_syntax.bsl.languageserver.utils.Trees;\n+import com.github._1c_syntax.bsl.parser.BSLParser;\n+import org.antlr.v4.runtime.ParserRuleContext;\n+import org.antlr.v4.runtime.tree.ParseTree;\n+import org.eclipse.lsp4j.Range;\n+\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Locale;\n+import java.util.Optional;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+@DiagnosticMetadata(\n+  type = DiagnosticType.ERROR,\n+  severity = DiagnosticSeverity.MAJOR,\n+  minutesToFix = 5,\n+  tags = {\n+    DiagnosticTag.DESIGN,\n+    DiagnosticTag.BADPRACTICE\n+  }\n+\n+)\n+public class FunctionReturnsSamePrimitiveDiagnostic extends AbstractVisitorDiagnostic {\n+\n+  private static final String KEY_MESSAGE = \"diagnosticMessageReturnStatement\";\n+  private static final Pattern pattern = Pattern.compile(\n+    \"^(\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0439|attachable)_\", Pattern.CASE_INSENSITIVE | Pattern.UNICODE_CASE);\n+\n+  private static final boolean CHECK_ATTACHABLE_METHODS = true;\n+\n+  @DiagnosticParameter(\n+    type = Boolean.class,\n+    defaultValue = \"\" + CHECK_ATTACHABLE_METHODS\n+  )\n+  private boolean checkAttachableMethods = CHECK_ATTACHABLE_METHODS;\n+\n+  public FunctionReturnsSamePrimitiveDiagnostic(DiagnosticInfo info) {\n+    super(info);\n+  }\n+\n+  @Override\n+  public ParseTree visitFunction(BSLParser.FunctionContext ctx) {\n+\n+    if (checkAttachableMethods) {\n+      // \u0418\u0441\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b\n+      var abortCheck = Optional.ofNullable(ctx.funcDeclaration())\n+        .map(BSLParser.FuncDeclarationContext::subName)\n+        .filter(subNameContext -> pattern.matcher(subNameContext.getText()).find())\n+        .isPresent();\n+      if (abortCheck) {\n+        return ctx;\n+      }\n+    }\n+\n+    var tree = Trees.findAllRuleNodes(ctx, BSLParser.RULE_returnStatement);\n+    if (tree.size() > 1) {\n+      var expressions = tree.stream()\n+        .map(BSLParser.ReturnStatementContext.class::cast)\n+        .map(BSLParser.ReturnStatementContext::expression)\n+        .flatMap(Stream::ofNullable)\n+        .collect(Collectors.toList());\n+\n+      expressions.stream()\n+        .map(expression -> Trees.findAllRuleNodes(expression, BSLParser.RULE_complexIdentifier))\n+        .filter(Collection::isEmpty)\n+        .findAny()\n+        .ifPresent(\n+          parseTrees -> checkPrimitiveValue(ctx, tree, expressions)\n+        );\n+    }\n+    return ctx;\n+  }\n+\n+  private void checkPrimitiveValue(\n+    BSLParser.FunctionContext ctx, Collection<ParseTree> tree, List<BSLParser.ExpressionContext> expressions) {\n+\n+    var set = expressions.stream()\n+      .map((BSLParser.ExpressionContext expression) -> {\n+        var text = expression.getText();\n+        if (Trees.findAllRuleNodes(expression, BSLParser.RULE_string).isEmpty()) {\n+          text = text.toUpperCase(Locale.ENGLISH);\n+        }\n+        return text;\n+      })\n+      .collect(Collectors.toSet());\n+    if (set.size() == 1) {\n+      var relatedInformation = tree.stream()\n+        .map(BSLParser.ReturnStatementContext.class::cast)\n+        .map(statement -> RelatedInformation.create(\n+          documentContext.getUri(),\n+          Ranges.create(statement.getStart()),\n+          info.getResourceString(KEY_MESSAGE)))\n+        .collect(Collectors.toList());\n+      diagnosticStorage.addDiagnostic(getSubNameRange(ctx), info.getMessage(), relatedInformation);", "originalCommit": "406078f2faa521663e0bc245bd226ab56d355776", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjAxMzg5Mg==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1118#discussion_r416013892", "bodyText": "", "author": "otymko", "createdAt": "2020-04-27T17:37:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjAxMjQ0Ng=="}], "type": "inlineReview"}, {"oid": "ccbc9212c28de9a81e4c5c5319079e0cc9a87894", "url": "https://github.com/1c-syntax/bsl-language-server/commit/ccbc9212c28de9a81e4c5c5319079e0cc9a87894", "message": "\u043e\u043f\u0446\u0438\u044f \u043d\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440 \u0434\u043b\u044f \u0441\u0442\u0440\u043e\u043a, \u0440\u0435\u043d\u0435\u0439\u043c \u043e\u043f\u0446\u0438\u0438 \u043f\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u043c, \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u044b \u0442\u0435\u0441\u0442\u044b.", "committedDate": "2020-04-28T03:38:29Z", "type": "commit"}, {"oid": "9b596f3d90f711ed6ffdc3ed06fab530f8b9a231", "url": "https://github.com/1c-syntax/bsl-language-server/commit/9b596f3d90f711ed6ffdc3ed06fab530f8b9a231", "message": "Merge pull request #1087 from 1c-syntax/feature/commonModuleNameClientServer\n\nCommonModuleNameDiagnostics", "committedDate": "2020-04-28T06:03:21Z", "type": "commit"}, {"oid": "e78235cee50d99f5f0ab7bac98002239ff3fd5de", "url": "https://github.com/1c-syntax/bsl-language-server/commit/e78235cee50d99f5f0ab7bac98002239ff3fd5de", "message": "\u041f\u0435\u0440\u0432\u043e\u0435 \u043f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u0438\u0435", "committedDate": "2020-04-28T06:16:30Z", "type": "commit"}, {"oid": "3a8ad5cb8452122a925bd3ed985a6e3e3c025203", "url": "https://github.com/1c-syntax/bsl-language-server/commit/3a8ad5cb8452122a925bd3ed985a6e3e3c025203", "message": "\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0435 \u043f\u0440\u0438\u043c\u0438\u0442\u0438\u0432\u043e\u0432, \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043d\u0430 ru, \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u043c\u0435\u043d\u0438 \u0444\u0430\u0439\u043b\u0430 \u043a\u0435\u0439\u0441\u0430 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0430", "committedDate": "2020-04-28T06:16:30Z", "type": "commit"}, {"oid": "e2f0d2777eb05e17622e2369ff509b16e240555e", "url": "https://github.com/1c-syntax/bsl-language-server/commit/e2f0d2777eb05e17622e2369ff509b16e240555e", "message": "no message", "committedDate": "2020-04-28T06:21:12Z", "type": "commit"}, {"oid": "c666ebf83d77160d59ec3c4c31e559356d1a952b", "url": "https://github.com/1c-syntax/bsl-language-server/commit/c666ebf83d77160d59ec3c4c31e559356d1a952b", "message": "+ \u043f\u0440\u0435\u043a\u043e\u043c\u043c\u0438\u0442", "committedDate": "2020-04-28T06:21:17Z", "type": "commit"}, {"oid": "c5f53a5ce08e5aaa27d7edf843c73b9cc478e613", "url": "https://github.com/1c-syntax/bsl-language-server/commit/c5f53a5ce08e5aaa27d7edf843c73b9cc478e613", "message": "\u0414\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f, \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043f\u0440\u0435\u043a\u043e\u043c\u043c\u0438\u0442, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u043d\u0430\u044f \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u044f \u0432 \u0444\u0430\u0439\u043b\u0435 \u0442\u0435\u0441\u0442\u0430.", "committedDate": "2020-04-28T06:23:39Z", "type": "commit"}, {"oid": "49a71fc9f98dc5ef5100f28f06c41db5722ab952", "url": "https://github.com/1c-syntax/bsl-language-server/commit/49a71fc9f98dc5ef5100f28f06c41db5722ab952", "message": "\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0438\u0437 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439", "committedDate": "2020-04-28T06:23:40Z", "type": "commit"}, {"oid": "0b712d412880a7757d23eb9e6c303819fad5b28c", "url": "https://github.com/1c-syntax/bsl-language-server/commit/0b712d412880a7757d23eb9e6c303819fad5b28c", "message": "\u0414\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438", "committedDate": "2020-04-28T06:23:40Z", "type": "commit"}, {"oid": "5a099f8a6ae7e2aa98408a9e41f43da917ddc831", "url": "https://github.com/1c-syntax/bsl-language-server/commit/5a099f8a6ae7e2aa98408a9e41f43da917ddc831", "message": "\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0432 \u0440\u0430\u0437\u043d\u044b\u0445 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0445 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 Null \u0438 NULL)", "committedDate": "2020-04-28T06:23:41Z", "type": "commit"}, {"oid": "dd9ac1d343bb888e9d3400c6e7817da55512c9bc", "url": "https://github.com/1c-syntax/bsl-language-server/commit/dd9ac1d343bb888e9d3400c6e7817da55512c9bc", "message": "\u041d\u0435 \u043f\u0440\u0435\u0432\u043e\u0434\u0438\u0442\u044c \u0421\u0442\u0440\u043e\u043a\u0438 \u043a \u0432\u0435\u0440\u0445\u043d\u0435\u043c\u0443 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0443", "committedDate": "2020-04-28T06:23:41Z", "type": "commit"}, {"oid": "b8a72d89bd9de948f1a034ce7445824bc61620dd", "url": "https://github.com/1c-syntax/bsl-language-server/commit/b8a72d89bd9de948f1a034ce7445824bc61620dd", "message": "\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \"\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b\" \u0438 \u0434\u043e\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0442\u0435\u0441\u0442\u043e\u0432", "committedDate": "2020-04-28T06:23:42Z", "type": "commit"}, {"oid": "b958bba32910c74c2a195f7aebcb90be03c119d4", "url": "https://github.com/1c-syntax/bsl-language-server/commit/b958bba32910c74c2a195f7aebcb90be03c119d4", "message": "\u041f\u0440\u0435\u043a\u043e\u043c\u043c\u0438\u0442", "committedDate": "2020-04-28T06:23:42Z", "type": "commit"}, {"oid": "864f769df51150ef4fd28ec43c554f99ec5f8192", "url": "https://github.com/1c-syntax/bsl-language-server/commit/864f769df51150ef4fd28ec43c554f99ec5f8192", "message": "\u043e\u043f\u0446\u0438\u044f \u043d\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440 \u0434\u043b\u044f \u0441\u0442\u0440\u043e\u043a, \u0440\u0435\u043d\u0435\u0439\u043c \u043e\u043f\u0446\u0438\u0438 \u043f\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u043c, \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u044b \u0442\u0435\u0441\u0442\u044b.", "committedDate": "2020-04-28T06:23:44Z", "type": "commit"}, {"oid": "59b717d63d55fe8560007ceb857dd2805d8accef", "url": "https://github.com/1c-syntax/bsl-language-server/commit/59b717d63d55fe8560007ceb857dd2805d8accef", "message": "Merge branch 'feature/issue110' of https://github.com/1c-syntax/bsl-language-server into feature/issue110\n\n# Conflicts:\n#\tdocs/diagnostics/index.md\n#\tdocs/en/diagnostics/index.md\n#\tsrc/main/resources/com/github/_1c_syntax/bsl/languageserver/configuration/parameters-schema.json", "committedDate": "2020-04-28T06:24:23Z", "type": "commit"}, {"oid": "44b704ea4cbe07b7784cd36fa534f17ca753ed2b", "url": "https://github.com/1c-syntax/bsl-language-server/commit/44b704ea4cbe07b7784cd36fa534f17ca753ed2b", "message": "\u0430\u043a\u0442\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f precommit", "committedDate": "2020-04-28T06:31:09Z", "type": "commit"}]}