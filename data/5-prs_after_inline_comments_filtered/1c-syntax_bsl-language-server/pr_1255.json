{"pr_number": 1255, "pr_title": "Feature/generate regions code action", "pr_createdAt": "2020-06-13T15:49:46Z", "pr_url": "https://github.com/1c-syntax/bsl-language-server/pull/1255", "timeline": [{"oid": "fb220ce7cf9e2001246eb747fd3d5379895ace86", "url": "https://github.com/1c-syntax/bsl-language-server/commit/fb220ce7cf9e2001246eb747fd3d5379895ace86", "message": "\u0414\u0440\u0430\u0444\u0442 codeAction \u043d\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044e \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u0440\u0435\u0433\u0438\u043e\u043d\u043e\u0432. \u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u0441\u0442\u043e\u0432", "committedDate": "2020-06-11T17:30:23Z", "type": "commit"}, {"oid": "3c387b97430cc4f770d7ef13239e904921b28c07", "url": "https://github.com/1c-syntax/bsl-language-server/commit/3c387b97430cc4f770d7ef13239e904921b28c07", "message": "Merge branch 'develop' of https://github.com/1c-syntax/bsl-language-server into feature/generateRegionsCodeAction", "committedDate": "2020-06-11T17:30:47Z", "type": "commit"}, {"oid": "a3a5492a6ecaed4ed22c96259f3d95942e515c9f", "url": "https://github.com/1c-syntax/bsl-language-server/commit/a3a5492a6ecaed4ed22c96259f3d95942e515c9f", "message": "\u041f\u0440\u043e\u0441\u0442\u043e\u0439 \u0442\u0435\u0441\u0442", "committedDate": "2020-06-13T13:48:50Z", "type": "commit"}, {"oid": "f90dc4912c96e4cbef9a5692bbd080edc5e77c6a", "url": "https://github.com/1c-syntax/bsl-language-server/commit/f90dc4912c96e4cbef9a5692bbd080edc5e77c6a", "message": "Merge branch 'develop' of https://github.com/1c-syntax/bsl-language-server into feature/generateRegionsCodeAction\n\n\u0001 Conflicts:\n\u0001\tsrc/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/NonStandardRegionDiagnostic.java", "committedDate": "2020-06-13T13:58:19Z", "type": "commit"}, {"oid": "78d77a3c7031b2c67b374616e93e8b973f85d533", "url": "https://github.com/1c-syntax/bsl-language-server/commit/78d77a3c7031b2c67b374616e93e8b973f85d533", "message": "HTTP module case", "committedDate": "2020-06-13T14:00:14Z", "type": "commit"}, {"oid": "6ffe674729601a598377565614aee12d4436cc74", "url": "https://github.com/1c-syntax/bsl-language-server/commit/6ffe674729601a598377565614aee12d4436cc74", "message": "\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u043e\u0433\u043e \u044f\u0437\u044b\u043a\u0430, \u043f\u043e\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u0442\u0435\u0441\u0442\u044b", "committedDate": "2020-06-13T15:47:37Z", "type": "commit"}, {"oid": "f876770a0dd409f0c53b34b2dca82c70c311e388", "url": "https://github.com/1c-syntax/bsl-language-server/commit/f876770a0dd409f0c53b34b2dca82c70c311e388", "message": "\u0418\u043c\u043f\u043e\u0440\u0442\u044b", "committedDate": "2020-06-15T12:14:58Z", "type": "commit"}, {"oid": "c27838603d8dc3d798e00533aea1f75eda51b7ce", "url": "https://github.com/1c-syntax/bsl-language-server/commit/c27838603d8dc3d798e00533aea1f75eda51b7ce", "message": "\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d Javadoc", "committedDate": "2020-06-16T14:23:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1MTc2NQ==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447751765", "bodyText": "\u0432\u043e\u0442 \u044d\u0442\u0443 \u0434\u043e\u043a\u0443 \u0431\u044b \u043f\u0440\u044f\u043c\u043e \u0432 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 CodeActionSupplier. \u0442\u043e\u0433\u0434\u0430 \u0437\u0434\u0435\u0441\u044c \u043e\u043d\u0430 \u0431\u0443\u0434\u0435\u0442/\u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c inherited.", "author": "nixel2007", "createdAt": "2020-06-30T14:58:55Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/codeactions/GenerateStandardRegionsSupplier.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.codeactions;\n+\n+import com.github._1c_syntax.bsl.languageserver.context.DocumentContext;\n+import com.github._1c_syntax.bsl.languageserver.context.FileType;\n+import com.github._1c_syntax.bsl.languageserver.context.symbol.RegionSymbol;\n+import com.github._1c_syntax.bsl.languageserver.utils.Regions;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ModuleType;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ScriptVariant;\n+import org.eclipse.lsp4j.CodeAction;\n+import org.eclipse.lsp4j.CodeActionKind;\n+import org.eclipse.lsp4j.CodeActionParams;\n+import org.eclipse.lsp4j.TextEdit;\n+import org.eclipse.lsp4j.WorkspaceEdit;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * {@code Supplier} {@code codeAction} \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445\n+ * \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439\n+ */\n+public class GenerateStandardRegionsSupplier implements CodeActionSupplier{\n+\n+  /**", "originalCommit": "c27838603d8dc3d798e00533aea1f75eda51b7ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1MjI4Ng==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447752286", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * \u043f\u0443\u0441\u0442\u043e\u0439 {@code ArrayList} \u0435\u0441\u043b\u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f\n          \n          \n            \n               * \u043f\u0443\u0441\u0442\u043e\u0439 {@code List} \u0435\u0441\u043b\u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f", "author": "nixel2007", "createdAt": "2020-06-30T14:59:32Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/codeactions/GenerateStandardRegionsSupplier.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.codeactions;\n+\n+import com.github._1c_syntax.bsl.languageserver.context.DocumentContext;\n+import com.github._1c_syntax.bsl.languageserver.context.FileType;\n+import com.github._1c_syntax.bsl.languageserver.context.symbol.RegionSymbol;\n+import com.github._1c_syntax.bsl.languageserver.utils.Regions;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ModuleType;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ScriptVariant;\n+import org.eclipse.lsp4j.CodeAction;\n+import org.eclipse.lsp4j.CodeActionKind;\n+import org.eclipse.lsp4j.CodeActionParams;\n+import org.eclipse.lsp4j.TextEdit;\n+import org.eclipse.lsp4j.WorkspaceEdit;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * {@code Supplier} {@code codeAction} \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445\n+ * \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439\n+ */\n+public class GenerateStandardRegionsSupplier implements CodeActionSupplier{\n+\n+  /**\n+   * \u041f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 {@code CodeAction} \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445\n+   * \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 1\u0421\n+   * @param params \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0432\u044b\u0437\u043e\u0432\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 {@code codeAction}\n+   * @param documentContext \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u043e\u0433\u043e \u043c\u043e\u0434\u0443\u043b\u044f\n+   * @return {@code List<CodeAction>} \u0435\u0441\u043b\u0438 \u043c\u043e\u0434\u0443\u043b\u044c \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0432\u0441\u0435\u0445 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439,\n+   * \u043f\u0443\u0441\u0442\u043e\u0439 {@code ArrayList} \u0435\u0441\u043b\u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f", "originalCommit": "c27838603d8dc3d798e00533aea1f75eda51b7ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc4Mzc5Mg==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447783792", "bodyText": "done", "author": "EightM", "createdAt": "2020-06-30T15:41:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1MjI4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1NDE3Mw==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447754173", "bodyText": "\u043d\u0435 \u043d\u0443\u0436\u0435\u043d \u043b\u0438 \u043c\u0435\u0436\u0434\u0443 \u041e\u0431\u043b\u0430\u0441\u0442\u044c \u0438 \u041a\u043e\u043d\u0435\u0446\u041e\u0431\u043b\u0430\u0441\u0442\u0438 \u0435\u0449\u0435 \u043e\u0434\u0438\u043d %n?", "author": "nixel2007", "createdAt": "2020-06-30T15:01:55Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/codeactions/GenerateStandardRegionsSupplier.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.codeactions;\n+\n+import com.github._1c_syntax.bsl.languageserver.context.DocumentContext;\n+import com.github._1c_syntax.bsl.languageserver.context.FileType;\n+import com.github._1c_syntax.bsl.languageserver.context.symbol.RegionSymbol;\n+import com.github._1c_syntax.bsl.languageserver.utils.Regions;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ModuleType;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ScriptVariant;\n+import org.eclipse.lsp4j.CodeAction;\n+import org.eclipse.lsp4j.CodeActionKind;\n+import org.eclipse.lsp4j.CodeActionParams;\n+import org.eclipse.lsp4j.TextEdit;\n+import org.eclipse.lsp4j.WorkspaceEdit;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * {@code Supplier} {@code codeAction} \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445\n+ * \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439\n+ */\n+public class GenerateStandardRegionsSupplier implements CodeActionSupplier{\n+\n+  /**\n+   * \u041f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 {@code CodeAction} \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445\n+   * \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 1\u0421\n+   * @param params \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0432\u044b\u0437\u043e\u0432\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 {@code codeAction}\n+   * @param documentContext \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u043e\u0433\u043e \u043c\u043e\u0434\u0443\u043b\u044f\n+   * @return {@code List<CodeAction>} \u0435\u0441\u043b\u0438 \u043c\u043e\u0434\u0443\u043b\u044c \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0432\u0441\u0435\u0445 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439,\n+   * \u043f\u0443\u0441\u0442\u043e\u0439 {@code ArrayList} \u0435\u0441\u043b\u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f\n+   */\n+  @Override\n+  public List<CodeAction> getCodeActions(CodeActionParams params, DocumentContext documentContext) {\n+    List<CodeAction> codeActions = new ArrayList<>();\n+\n+    ModuleType moduleType = documentContext.getModuleType();\n+    ScriptVariant configurationLanguage = documentContext.getServerContext().getConfiguration().getScriptVariant();\n+    Set<String> neededStandardRegions = Regions.getStandardRegionsNamesByModuleType(moduleType, configurationLanguage);\n+    Set<String> documentRegionsNames = documentContext.getSymbolTree().getModuleLevelRegions().stream()\n+      .map(RegionSymbol::getName)\n+      .collect(Collectors.toSet());\n+    neededStandardRegions.removeAll(documentRegionsNames);\n+    FileType fileType = documentContext.getFileType();\n+\n+    if (neededStandardRegions.isEmpty() || fileType == FileType.OS) {\n+      return codeActions;\n+    }\n+\n+    String regionFormat =\n+      configurationLanguage == ScriptVariant.ENGLISH ? \"#Region %s%n#EndRegion%n\" : \"#\u041e\u0431\u043b\u0430\u0441\u0442\u044c %s%n#\u041a\u043e\u043d\u0435\u0446\u041e\u0431\u043b\u0430\u0441\u0442\u0438%n\";", "originalCommit": "c27838603d8dc3d798e00533aea1f75eda51b7ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc4MzkxNg==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447783916", "bodyText": "\u0414\u043e\u0431\u0430\u0432\u0438\u043b", "author": "EightM", "createdAt": "2020-06-30T15:41:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1NDE3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1OTM2OA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447759368", "bodyText": "\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u0447\u0442\u043e \u0441 Map.of \u043a\u043e\u0434 \u0431\u0443\u0434\u0435\u0442 \u0447\u0443\u0442\u044c \u043f\u043e\u0447\u0438\u0449\u0435.", "author": "nixel2007", "createdAt": "2020-06-30T15:08:49Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/codeactions/GenerateStandardRegionsSupplier.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.codeactions;\n+\n+import com.github._1c_syntax.bsl.languageserver.context.DocumentContext;\n+import com.github._1c_syntax.bsl.languageserver.context.FileType;\n+import com.github._1c_syntax.bsl.languageserver.context.symbol.RegionSymbol;\n+import com.github._1c_syntax.bsl.languageserver.utils.Regions;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ModuleType;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ScriptVariant;\n+import org.eclipse.lsp4j.CodeAction;\n+import org.eclipse.lsp4j.CodeActionKind;\n+import org.eclipse.lsp4j.CodeActionParams;\n+import org.eclipse.lsp4j.TextEdit;\n+import org.eclipse.lsp4j.WorkspaceEdit;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * {@code Supplier} {@code codeAction} \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445\n+ * \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439\n+ */\n+public class GenerateStandardRegionsSupplier implements CodeActionSupplier{\n+\n+  /**\n+   * \u041f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 {@code CodeAction} \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445\n+   * \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 1\u0421\n+   * @param params \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0432\u044b\u0437\u043e\u0432\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 {@code codeAction}\n+   * @param documentContext \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u043e\u0433\u043e \u043c\u043e\u0434\u0443\u043b\u044f\n+   * @return {@code List<CodeAction>} \u0435\u0441\u043b\u0438 \u043c\u043e\u0434\u0443\u043b\u044c \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0432\u0441\u0435\u0445 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439,\n+   * \u043f\u0443\u0441\u0442\u043e\u0439 {@code ArrayList} \u0435\u0441\u043b\u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f\n+   */\n+  @Override\n+  public List<CodeAction> getCodeActions(CodeActionParams params, DocumentContext documentContext) {\n+    List<CodeAction> codeActions = new ArrayList<>();\n+\n+    ModuleType moduleType = documentContext.getModuleType();\n+    ScriptVariant configurationLanguage = documentContext.getServerContext().getConfiguration().getScriptVariant();\n+    Set<String> neededStandardRegions = Regions.getStandardRegionsNamesByModuleType(moduleType, configurationLanguage);\n+    Set<String> documentRegionsNames = documentContext.getSymbolTree().getModuleLevelRegions().stream()\n+      .map(RegionSymbol::getName)\n+      .collect(Collectors.toSet());\n+    neededStandardRegions.removeAll(documentRegionsNames);\n+    FileType fileType = documentContext.getFileType();\n+\n+    if (neededStandardRegions.isEmpty() || fileType == FileType.OS) {\n+      return codeActions;\n+    }\n+\n+    String regionFormat =\n+      configurationLanguage == ScriptVariant.ENGLISH ? \"#Region %s%n#EndRegion%n\" : \"#\u041e\u0431\u043b\u0430\u0441\u0442\u044c %s%n#\u041a\u043e\u043d\u0435\u0446\u041e\u0431\u043b\u0430\u0441\u0442\u0438%n\";\n+\n+    String result = neededStandardRegions.stream()\n+      .map(s -> String .format(regionFormat, s))\n+      .collect(Collectors.joining(\"\\n\"));\n+    TextEdit textEdit = new TextEdit(params.getRange(), result);\n+\n+    WorkspaceEdit edit = new WorkspaceEdit();\n+    Map<String, List<TextEdit>> changes = new HashMap<>();", "originalCommit": "c27838603d8dc3d798e00533aea1f75eda51b7ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc4NjI4Nw==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447786287", "bodyText": "\u0418\u0441\u043f\u0440\u0430\u0432\u0438\u043b", "author": "EightM", "createdAt": "2020-06-30T15:45:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1OTM2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1OTkyNA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447759924", "bodyText": "\u0410\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e, \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0437\u0434\u0435\u0441\u044c \u043c\u043e\u0436\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u0434\u0435\u043b\u0430\u0442\u044c List.of(codeAction), \u0430 \u0432\u044b\u0448\u0435 (\u043d\u0430 \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u043c \u0440\u0435\u0442\u0443\u0440\u043d\u0435) \u0432\u044b\u0439\u0442\u0438 \u0441 Collections.emptyList", "author": "nixel2007", "createdAt": "2020-06-30T15:09:33Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/codeactions/GenerateStandardRegionsSupplier.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.codeactions;\n+\n+import com.github._1c_syntax.bsl.languageserver.context.DocumentContext;\n+import com.github._1c_syntax.bsl.languageserver.context.FileType;\n+import com.github._1c_syntax.bsl.languageserver.context.symbol.RegionSymbol;\n+import com.github._1c_syntax.bsl.languageserver.utils.Regions;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ModuleType;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ScriptVariant;\n+import org.eclipse.lsp4j.CodeAction;\n+import org.eclipse.lsp4j.CodeActionKind;\n+import org.eclipse.lsp4j.CodeActionParams;\n+import org.eclipse.lsp4j.TextEdit;\n+import org.eclipse.lsp4j.WorkspaceEdit;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * {@code Supplier} {@code codeAction} \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445\n+ * \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439\n+ */\n+public class GenerateStandardRegionsSupplier implements CodeActionSupplier{\n+\n+  /**\n+   * \u041f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 {@code CodeAction} \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445\n+   * \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 1\u0421\n+   * @param params \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0432\u044b\u0437\u043e\u0432\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 {@code codeAction}\n+   * @param documentContext \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u043e\u0433\u043e \u043c\u043e\u0434\u0443\u043b\u044f\n+   * @return {@code List<CodeAction>} \u0435\u0441\u043b\u0438 \u043c\u043e\u0434\u0443\u043b\u044c \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0432\u0441\u0435\u0445 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439,\n+   * \u043f\u0443\u0441\u0442\u043e\u0439 {@code ArrayList} \u0435\u0441\u043b\u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f\n+   */\n+  @Override\n+  public List<CodeAction> getCodeActions(CodeActionParams params, DocumentContext documentContext) {\n+    List<CodeAction> codeActions = new ArrayList<>();\n+\n+    ModuleType moduleType = documentContext.getModuleType();\n+    ScriptVariant configurationLanguage = documentContext.getServerContext().getConfiguration().getScriptVariant();\n+    Set<String> neededStandardRegions = Regions.getStandardRegionsNamesByModuleType(moduleType, configurationLanguage);\n+    Set<String> documentRegionsNames = documentContext.getSymbolTree().getModuleLevelRegions().stream()\n+      .map(RegionSymbol::getName)\n+      .collect(Collectors.toSet());\n+    neededStandardRegions.removeAll(documentRegionsNames);\n+    FileType fileType = documentContext.getFileType();\n+\n+    if (neededStandardRegions.isEmpty() || fileType == FileType.OS) {\n+      return codeActions;\n+    }\n+\n+    String regionFormat =\n+      configurationLanguage == ScriptVariant.ENGLISH ? \"#Region %s%n#EndRegion%n\" : \"#\u041e\u0431\u043b\u0430\u0441\u0442\u044c %s%n#\u041a\u043e\u043d\u0435\u0446\u041e\u0431\u043b\u0430\u0441\u0442\u0438%n\";\n+\n+    String result = neededStandardRegions.stream()\n+      .map(s -> String .format(regionFormat, s))\n+      .collect(Collectors.joining(\"\\n\"));\n+    TextEdit textEdit = new TextEdit(params.getRange(), result);\n+\n+    WorkspaceEdit edit = new WorkspaceEdit();\n+    Map<String, List<TextEdit>> changes = new HashMap<>();\n+    changes.put(documentContext.getUri().toString(), Collections.singletonList(textEdit));\n+    edit.setChanges(changes);\n+\n+    CodeAction codeAction = new CodeAction(\"Generate missing regions\");\n+    codeAction.setDiagnostics(new ArrayList<>());\n+    codeAction.setKind(CodeActionKind.Refactor);\n+    codeAction.setEdit(edit);\n+    codeActions.add(codeAction);\n+\n+    return codeActions;", "originalCommit": "c27838603d8dc3d798e00533aea1f75eda51b7ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc4NjM4MA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447786380", "bodyText": "\u0418\u0441\u043f\u0440\u0430\u0432\u0438\u043b", "author": "EightM", "createdAt": "2020-06-30T15:45:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc1OTkyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc2MDUxNA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1255#discussion_r447760514", "bodyText": "\ud83d\udc4d", "author": "nixel2007", "createdAt": "2020-06-30T15:10:19Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Regions.java", "diffHunk": "@@ -0,0 +1,322 @@\n+/*\n+ * This file is a part of BSL Language Server.\n+ *\n+ * Copyright \u00a9 2018-2020\n+ * Alexey Sosnoviy <labotamy@gmail.com>, Nikita Gryzlov <nixel2007@gmail.com> and contributors\n+ *\n+ * SPDX-License-Identifier: LGPL-3.0-or-later\n+ *\n+ * BSL Language Server is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3.0 of the License, or (at your option) any later version.\n+ *\n+ * BSL Language Server is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with BSL Language Server.\n+ */\n+package com.github._1c_syntax.bsl.languageserver.utils;\n+\n+import com.github._1c_syntax.mdclasses.metadata.additional.ModuleType;\n+import com.github._1c_syntax.mdclasses.metadata.additional.ScriptVariant;\n+import com.github._1c_syntax.utils.CaseInsensitivePattern;\n+import lombok.experimental.UtilityClass;\n+\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+\n+/**\n+ * \u0412\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0441, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0439 \u043c\u0435\u0442\u043e\u0434\u044b \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u044b\u043c\u0438 \u043e\u0431\u043b\u0430\u0441\u0442\u044f\u043c\u0438 1\u0421\n+ */\n+@UtilityClass\n+public class Regions {", "originalCommit": "c27838603d8dc3d798e00533aea1f75eda51b7ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ce3356be66e1ae470650b1816bee4406c6ff4916", "url": "https://github.com/1c-syntax/bsl-language-server/commit/ce3356be66e1ae470650b1816bee4406c6ff4916", "message": "Merge branch 'develop' of https://github.com/1c-syntax/bsl-language-server into feature/generateRegionsCodeAction", "committedDate": "2020-06-30T15:18:59Z", "type": "commit"}, {"oid": "7051aa3337cc33332316267bb147e274b74516ba", "url": "https://github.com/1c-syntax/bsl-language-server/commit/7051aa3337cc33332316267bb147e274b74516ba", "message": "Merge branch 'develop' of https://github.com/1c-syntax/bsl-language-server into feature/generateRegionsCodeAction", "committedDate": "2020-06-30T15:38:17Z", "type": "commit"}, {"oid": "76550fff019dfd2158e67ce1e8d989deee0e509f", "url": "https://github.com/1c-syntax/bsl-language-server/commit/76550fff019dfd2158e67ce1e8d989deee0e509f", "message": "\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043c\u0435\u0447\u0430\u043d\u0438\u0439", "committedDate": "2020-06-30T15:44:42Z", "type": "commit"}, {"oid": "7d925cfaa0149301ee9148917b955e50e2f05ece", "url": "https://github.com/1c-syntax/bsl-language-server/commit/7d925cfaa0149301ee9148917b955e50e2f05ece", "message": "\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 \u0434\u043b\u044f OS", "committedDate": "2020-07-03T11:28:17Z", "type": "commit"}]}