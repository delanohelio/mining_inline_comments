{"pr_number": 1022, "pr_title": "Cleanup ProxyContext logging OKAPI-910", "pr_createdAt": "2020-10-27T11:12:57Z", "pr_url": "https://github.com/folio-org/okapi/pull/1022", "timeline": [{"oid": "29bb9ae8f16f9f419de8407845fc97268cabc625", "url": "https://github.com/folio-org/okapi/commit/29bb9ae8f16f9f419de8407845fc97268cabc625", "message": "Cleanup ProxyContext logging OKAPI-910", "committedDate": "2020-10-27T11:12:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxNzgxNw==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512817817", "bodyText": "Missing Java doc for logger", "author": "hjiebsco", "createdAt": "2020-10-27T15:57:44Z", "path": "okapi-core/src/main/java/org/folio/okapi/bean/InterfaceDescriptor.java", "diffHunk": "@@ -197,11 +197,11 @@ public void setHandlers(RoutingEntry[] handlers) {\n    * @param section \"provides\" or \"requires\" - the rules differ\n    * @return \"\" if ok, or a simple error message\n    */\n-  public String validate(ProxyContext pc, String section, String mod) {\n+  public String validate(Logger logger, String section, String mod) {", "originalCommit": "29bb9ae8f16f9f419de8407845fc97268cabc625", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkyNTI5Ng==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512925296", "bodyText": "ok", "author": "adamdickmeiss", "createdAt": "2020-10-27T18:16:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxNzgxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxODA0MA==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512818040", "bodyText": "Would this work logger.debug(\"Loading permissions for {}\", mdTo.getName()?", "author": "hjiebsco", "createdAt": "2020-10-27T15:57:58Z", "path": "okapi-core/src/main/java/org/folio/okapi/managers/TenantManager.java", "diffHunk": "@@ -544,7 +545,7 @@ private void fireTimer(Tenant tenant, ModuleDescriptor md, RoutingEntry re, Stri\n   private Future<Void> invokePermissionsForModule(Tenant tenant, ModuleDescriptor mdTo,\n                                                   ModuleDescriptor permsModule, ProxyContext pc) {\n \n-    pc.debug(\"Loading permissions for \" + mdTo.getName()\n+    logger.debug(\"Loading permissions for {}\", () -> mdTo.getName()", "originalCommit": "29bb9ae8f16f9f419de8407845fc97268cabc625", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkyNTkxOA==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512925918", "bodyText": "Yes. The question is what is fastest. In this particular case, since the getName is a fast operation, using a lambda is probably overkill.", "author": "adamdickmeiss", "createdAt": "2020-10-27T18:17:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxODA0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkyNzQ3OA==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512927478", "bodyText": "I'll change it to normal.. By the way.. the following line is a mess.", "author": "adamdickmeiss", "createdAt": "2020-10-27T18:20:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxODA0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxODEyMg==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512818122", "bodyText": "Would this work logger.debug(\"tenantPerms Req: {}\", pljson);?", "author": "hjiebsco", "createdAt": "2020-10-27T15:58:03Z", "path": "okapi-core/src/main/java/org/folio/okapi/managers/TenantManager.java", "diffHunk": "@@ -555,7 +556,7 @@ private void fireTimer(Tenant tenant, ModuleDescriptor md, RoutingEntry re, Stri\n       pl = new PermissionList(moduleTo, mdTo.getExpandedPermissionSets());\n     }\n     String pljson = Json.encodePrettily(pl);\n-    pc.debug(\"tenantPerms Req: \" + pljson);\n+    logger.debug(\"tenantPerms Req: {}\", () -> pljson);", "originalCommit": "29bb9ae8f16f9f419de8407845fc97268cabc625", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkzMzU0NA==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512933544", "bodyText": "yes. Since it's a simple string - probably no need to.", "author": "adamdickmeiss", "createdAt": "2020-10-27T18:29:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxODEyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxODE3Mw==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512818173", "bodyText": "Would this work logger.debug(\"tenantPerms: {} and {}\", permsModule.getId(), permPath);?", "author": "hjiebsco", "createdAt": "2020-10-27T15:58:07Z", "path": "okapi-core/src/main/java/org/folio/okapi/managers/TenantManager.java", "diffHunk": "@@ -572,11 +573,11 @@ private void fireTimer(Tenant tenant, ModuleDescriptor md, RoutingEntry re, Stri\n           \"Bad _tenantPermissions interface in module \" + permsModule.getId()\n               + \". No path to POST to\"));\n     }\n-    pc.debug(\"tenantPerms: \" + permsModule.getId() + \" and \" + permPath);\n+    logger.debug(\"tenantPerms: {} and {}\", (Supplier<?>) () -> permsModule.getId(), permPath);", "originalCommit": "29bb9ae8f16f9f419de8407845fc97268cabc625", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkzNDIyMQ==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512934221", "bodyText": "yes.", "author": "adamdickmeiss", "createdAt": "2020-10-27T18:30:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxODE3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxODM0NA==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512818344", "bodyText": "Would this work logger.debug(\"tenantPerms request to {} succeeded for module {} and tenant {}\", permsModule.getId(), moduleTo, tenant.getId());?", "author": "hjiebsco", "createdAt": "2020-10-27T15:58:18Z", "path": "okapi-core/src/main/java/org/folio/okapi/managers/TenantManager.java", "diffHunk": "@@ -572,11 +573,11 @@ private void fireTimer(Tenant tenant, ModuleDescriptor md, RoutingEntry re, Stri\n           \"Bad _tenantPermissions interface in module \" + permsModule.getId()\n               + \". No path to POST to\"));\n     }\n-    pc.debug(\"tenantPerms: \" + permsModule.getId() + \" and \" + permPath);\n+    logger.debug(\"tenantPerms: {} and {}\", (Supplier<?>) () -> permsModule.getId(), permPath);\n     return proxyService.callSystemInterface(tenant, permInst, pljson, pc).compose(cres -> {\n       pc.passOkapiTraceHeaders(cres);\n-      pc.debug(\"tenantPerms request to \" + permsModule.getName()\n-          + \" succeeded for module \" + moduleTo + \" and tenant \" + tenant.getId());\n+      logger.debug(\"tenantPerms request to {} succeeded for module {} and tenant {}\",\n+          () -> permsModule.getId(), () -> moduleTo, () -> tenant.getId());", "originalCommit": "29bb9ae8f16f9f419de8407845fc97268cabc625", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkzNDc1Ng==", "url": "https://github.com/folio-org/okapi/pull/1022#discussion_r512934756", "bodyText": "yes", "author": "adamdickmeiss", "createdAt": "2020-10-27T18:31:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgxODM0NA=="}], "type": "inlineReview"}, {"oid": "e5637482c0890fb7011aa342ec05e687b117b028", "url": "https://github.com/folio-org/okapi/commit/e5637482c0890fb7011aa342ec05e687b117b028", "message": "Fix javadoc for public method", "committedDate": "2020-10-27T18:34:50Z", "type": "commit"}, {"oid": "1cc6862bdf94620e214a9257c28086ae9c1f2f25", "url": "https://github.com/folio-org/okapi/commit/1cc6862bdf94620e214a9257c28086ae9c1f2f25", "message": "Not using lambdas for a few calls that should have minimal overhead", "committedDate": "2020-10-27T18:35:57Z", "type": "commit"}]}