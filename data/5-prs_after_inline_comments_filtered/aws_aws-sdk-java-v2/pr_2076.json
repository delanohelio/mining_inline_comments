{"pr_number": 2076, "pr_title": "DynamoDB Enhanced Client: Added support for attribute level custom up\u2026", "pr_createdAt": "2020-10-01T02:41:55Z", "pr_url": "https://github.com/aws/aws-sdk-java-v2/pull/2076", "timeline": [{"oid": "b7be963907c97323da9be0cbb60079b41c18d0c3", "url": "https://github.com/aws/aws-sdk-java-v2/commit/b7be963907c97323da9be0cbb60079b41c18d0c3", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors", "committedDate": "2020-10-01T02:47:16Z", "type": "forcePushed"}, {"oid": "ae432b1c9531947bde0b32528c9f534ff8376eab", "url": "https://github.com/aws/aws-sdk-java-v2/commit/ae432b1c9531947bde0b32528c9f534ff8376eab", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors", "committedDate": "2020-10-01T02:48:37Z", "type": "forcePushed"}, {"oid": "78576238ea3469ddae74c57cf58fd6ce99701bed", "url": "https://github.com/aws/aws-sdk-java-v2/commit/78576238ea3469ddae74c57cf58fd6ce99701bed", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors", "committedDate": "2020-10-01T21:50:49Z", "type": "commit"}, {"oid": "78576238ea3469ddae74c57cf58fd6ce99701bed", "url": "https://github.com/aws/aws-sdk-java-v2/commit/78576238ea3469ddae74c57cf58fd6ce99701bed", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors", "committedDate": "2020-10-01T21:50:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1MjQ4Ng==", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2076#discussion_r499052486", "bodyText": "I'm confused about the use of this. Would you actually use it for \"created date\" if it doesn't work for putItem (only for updateItem)? Wouldn't this be firstUpdatedDate, which seems kind of useless?", "author": "millems", "createdAt": "2020-10-02T21:12:04Z", "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/enhanced/dynamodb/functionaltests/models/RecordWithUpdateBehaviors.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.enhanced.dynamodb.functionaltests.models;\n+\n+import java.time.Instant;\n+import software.amazon.awssdk.enhanced.dynamodb.extensions.annotations.DynamoDbVersionAttribute;\n+import software.amazon.awssdk.enhanced.dynamodb.mapper.annotations.DynamoDbBean;\n+import software.amazon.awssdk.enhanced.dynamodb.mapper.annotations.DynamoDbPartitionKey;\n+import software.amazon.awssdk.enhanced.dynamodb.mapper.annotations.DynamoDbUpdateBehavior;\n+\n+import static software.amazon.awssdk.enhanced.dynamodb.mapper.UpdateBehavior.WRITE_ALWAYS;\n+import static software.amazon.awssdk.enhanced.dynamodb.mapper.UpdateBehavior.WRITE_IF_NOT_EXISTS;\n+\n+@DynamoDbBean\n+public class RecordWithUpdateBehaviors {\n+    private String id;\n+    private Instant createdOn;\n+    private Instant lastUpdatedOn;\n+    private Long version;\n+\n+    @DynamoDbPartitionKey\n+    public String getId() {\n+        return id;\n+    }\n+\n+    public void setId(String id) {\n+        this.id = id;\n+    }\n+\n+    @DynamoDbUpdateBehavior(WRITE_IF_NOT_EXISTS)\n+    public Instant getCreatedOn() {\n+        return createdOn;\n+    }", "originalCommit": "78576238ea3469ddae74c57cf58fd6ce99701bed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA2OTQxNA==", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2076#discussion_r499069414", "bodyText": "The use-case, as it was put to me, was to avoid branching logic and always do a uniform update. It also allows schema evolution so they can update the record and write a value with a new attribute that didn't exist in the schema before only if it hadn't been set before in the database. I imagine it's the same rationale that lead to DDB implementing if_not_exists in their update expressions at all, this is really just a 'plumbing it through' exercise.", "author": "bmaizels", "createdAt": "2020-10-02T22:06:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1MjQ4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA3MDE3Mg==", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2076#discussion_r499070172", "bodyText": "I think it's probably more useful at the request level than the schema level, but that's a different feature request, I suppose.", "author": "millems", "createdAt": "2020-10-02T22:08:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1MjQ4Ng=="}], "type": "inlineReview"}, {"oid": "60de986d6e7405c1b6c7ae201c992cbb830f0c10", "url": "https://github.com/aws/aws-sdk-java-v2/commit/60de986d6e7405c1b6c7ae201c992cbb830f0c10", "message": "Merge branch 'master' into bmaizels/ddbenhanced-update-behaviors", "committedDate": "2020-10-02T22:17:41Z", "type": "commit"}]}