{"pr_number": 7931, "pr_title": "KAFKA-9420: Add flexible version support for converted protocols", "pr_createdAt": "2020-01-10T19:32:39Z", "pr_url": "https://github.com/apache/kafka/pull/7931", "timeline": [{"oid": "7017336c3e8af90c97e0e9b0512d5721e40953c0", "url": "https://github.com/apache/kafka/commit/7017336c3e8af90c97e0e9b0512d5721e40953c0", "message": "MINOR: Add flexible version support for converted protocols", "committedDate": "2020-01-10T19:29:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTYyNTg0Mw==", "url": "https://github.com/apache/kafka/pull/7931#discussion_r365625843", "bodyText": "Was this change triggered by a test failure?", "author": "ijuma", "createdAt": "2020-01-13T00:59:32Z", "path": "clients/src/main/java/org/apache/kafka/clients/NetworkClient.java", "diffHunk": "@@ -706,9 +708,13 @@ public Node leastLoadedNode(long now) {\n     }\n \n     public static AbstractResponse parseResponse(ByteBuffer responseBuffer, RequestHeader requestHeader) {\n-        Struct responseStruct = parseStructMaybeUpdateThrottleTimeMetrics(responseBuffer, requestHeader, null, 0);\n-        return AbstractResponse.parseResponse(requestHeader.apiKey(), responseStruct,\n-                requestHeader.apiVersion());\n+        try {\n+            Struct responseStruct = parseStructMaybeUpdateThrottleTimeMetrics(responseBuffer, requestHeader, null, 0);\n+            return AbstractResponse.parseResponse(requestHeader.apiKey(), responseStruct,\n+                    requestHeader.apiVersion());\n+        } catch (BufferUnderflowException e) {\n+            throw new SchemaException(\"Buffer underflow while parsing response for request with header \" + requestHeader, e);", "originalCommit": "7017336c3e8af90c97e0e9b0512d5721e40953c0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTkxNzQ5OQ==", "url": "https://github.com/apache/kafka/pull/7931#discussion_r365917499", "bodyText": "Yes. The new schema causes a BufferUnderflowException when in the  REAUTH_RECEIVE_HANDSHAKE_OR_OTHER_RESPONSE state in SaslClientAuthenticator. This class expects to be able to catch parsing errors in order to change the handling.", "author": "hachikuji", "createdAt": "2020-01-13T17:01:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTYyNTg0Mw=="}], "type": "inlineReview"}, {"oid": "fea862ff46a32ccb1da44de670e77ee979ded9a8", "url": "https://github.com/apache/kafka/commit/fea862ff46a32ccb1da44de670e77ee979ded9a8", "message": "Revert bump to TxnOffsetCommit", "committedDate": "2020-01-13T22:22:33Z", "type": "commit"}]}