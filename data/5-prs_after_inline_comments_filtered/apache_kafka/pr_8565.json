{"pr_number": 8565, "pr_title": "KAFKA-9798: Send one round synchronously before starting the async producer", "pr_createdAt": "2020-04-27T21:22:31Z", "pr_url": "https://github.com/apache/kafka/pull/8565", "timeline": [{"oid": "6f34ba84e5b6c6c5855df296998b4ac8809af242", "url": "https://github.com/apache/kafka/commit/6f34ba84e5b6c6c5855df296998b4ac8809af242", "message": "first commit", "committedDate": "2020-04-27T20:39:04Z", "type": "commit"}, {"oid": "afb19b25767dfacf9708b6729bafa3928bab6ec1", "url": "https://github.com/apache/kafka/commit/afb19b25767dfacf9708b6729bafa3928bab6ec1", "message": "minor fix", "committedDate": "2020-04-27T21:22:44Z", "type": "commit"}, {"oid": "ca635d2815ce25b439d57c1e526cc3c15df3d7e6", "url": "https://github.com/apache/kafka/commit/ca635d2815ce25b439d57c1e526cc3c15df3d7e6", "message": "Merge branch 'trunk' of https://github.com/apache/kafka into K9798-pre-send-one-record", "committedDate": "2020-04-28T00:05:05Z", "type": "commit"}, {"oid": "3f3aaa347de908446d2150606e64753b93be8883", "url": "https://github.com/apache/kafka/commit/3f3aaa347de908446d2150606e64753b93be8883", "message": "remove unused imports", "committedDate": "2020-04-28T00:06:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY3ODU1Ng==", "url": "https://github.com/apache/kafka/pull/8565#discussion_r418678556", "bodyText": "The producer is create using try-with-resource clause thus, the producer should be flushed on the implicit close() anyway? Thus, I don't think explicit flushing would help?", "author": "mjsax", "createdAt": "2020-05-01T18:39:14Z", "path": "streams/src/test/java/org/apache/kafka/streams/integration/QueryableStateIntegrationTest.java", "diffHunk": "@@ -1262,6 +1266,7 @@ public void run() {\n                     }\n                     incrementIteration();\n                 }\n+                producer.flush();", "originalCommit": "3f3aaa347de908446d2150606e64753b93be8883", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODc2ODY5Mg==", "url": "https://github.com/apache/kafka/pull/8565#discussion_r418768692", "bodyText": "Makes sense, will fix.", "author": "guozhangwang", "createdAt": "2020-05-01T22:47:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY3ODU1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY3OTE5NA==", "url": "https://github.com/apache/kafka/pull/8565#discussion_r418679194", "bodyText": "Should this be numIterations - 1", "author": "mjsax", "createdAt": "2020-05-01T18:40:37Z", "path": "streams/src/test/java/org/apache/kafka/streams/integration/QueryableStateIntegrationTest.java", "diffHunk": "@@ -631,7 +631,11 @@ public void shouldAllowConcurrentAccesses() throws Exception {\n         final String storeName = \"word-count-store\";\n         final String windowStoreName = \"windowed-word-count-store\";\n \n-        final ProducerRunnable producerRunnable = new ProducerRunnable(streamConcurrent, inputValues, numIterations);\n+        // send one round of records first to populate the stores\n+        ProducerRunnable producerRunnable = new ProducerRunnable(streamThree, inputValues, 1);\n+        producerRunnable.run();\n+\n+        producerRunnable = new ProducerRunnable(streamConcurrent, inputValues, numIterations);", "originalCommit": "3f3aaa347de908446d2150606e64753b93be8883", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5c20eed6fc0833a746417d059b62f572b57c51b6", "url": "https://github.com/apache/kafka/commit/5c20eed6fc0833a746417d059b62f572b57c51b6", "message": "address comments", "committedDate": "2020-05-01T22:49:22Z", "type": "commit"}]}