{"pr_number": 8918, "pr_title": "MINOR: Use debug level logging for noisy log messages in Connect", "pr_createdAt": "2020-06-23T18:48:01Z", "pr_url": "https://github.com/apache/kafka/pull/8918", "timeline": [{"oid": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e", "url": "https://github.com/apache/kafka/commit/18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e", "message": "Use debug level logging for noisy log messages in Connect", "committedDate": "2020-06-23T18:45:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1ODY0MQ==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r451258641", "bodyText": "these shouldn't be noisy. there is some dedup logic that should prevent the same message from being printed over and over again.", "author": "wicknicks", "createdAt": "2020-07-08T03:18:19Z", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java", "diffHunk": "@@ -343,7 +343,7 @@ private void doCommitSync(Map<TopicPartition, OffsetAndMetadata> offsets, int se\n     }\n \n     private void doCommitAsync(Map<TopicPartition, OffsetAndMetadata> offsets, final int seqno) {\n-        log.info(\"{} Committing offsets asynchronously using sequence number {}: {}\", this, seqno, offsets);\n+        log.debug(\"{} Committing offsets asynchronously using sequence number {}: {}\", this, seqno, offsets);", "originalCommit": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1ODczMA==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r451258730", "bodyText": "nit: since this is indicating entry into a method, I think it can be trace level.", "author": "wicknicks", "createdAt": "2020-07-08T03:18:45Z", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -475,7 +475,7 @@ private synchronized void recordSent(final ProducerRecord<byte[], byte[]> record\n     public boolean commitOffsets() {\n         long commitTimeoutMs = workerConfig.getLong(WorkerConfig.OFFSET_COMMIT_TIMEOUT_MS_CONFIG);\n \n-        log.info(\"{} Committing offsets\", this);\n+        log.debug(\"{} Committing offsets\", this);", "originalCommit": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1ODc5Mw==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r451258793", "bodyText": "nit: since this is mostly indicating exit from the method, I think it can be trace level too.", "author": "wicknicks", "createdAt": "2020-07-08T03:19:06Z", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -571,7 +571,7 @@ public boolean commitOffsets() {\n         finishSuccessfulFlush();\n         long durationMillis = time.milliseconds() - started;\n         recordCommitSuccess(durationMillis);\n-        log.info(\"{} Finished commitOffsets successfully in {} ms\",\n+        log.debug(\"{} Finished commitOffsets successfully in {} ms\",", "originalCommit": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI4MTQ2Ng==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r451281466", "bodyText": "I think you missed this one.", "author": "wicknicks", "createdAt": "2020-07-08T04:51:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1ODc5Mw=="}], "type": "inlineReview"}, {"oid": "751aeabd2ba0cd25c61ca336690617e3daf9e751", "url": "https://github.com/apache/kafka/commit/751aeabd2ba0cd25c61ca336690617e3daf9e751", "message": "Reduce to trace level", "committedDate": "2020-07-08T04:33:33Z", "type": "commit"}, {"oid": "a66de28dc046a5b4845b57605f8748cc857a084d", "url": "https://github.com/apache/kafka/commit/a66de28dc046a5b4845b57605f8748cc857a084d", "message": "Change levels", "committedDate": "2020-07-08T04:59:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTI1MTEzMw==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r481251133", "bodyText": "Why set this to trace rather than debug like the other changes? Isn't it useful to know that we've entered this method before we lock?", "author": "rhauch", "createdAt": "2020-09-01T15:57:22Z", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -475,7 +475,7 @@ private synchronized void recordSent(final ProducerRecord<byte[], byte[]> record\n     public boolean commitOffsets() {\n         long commitTimeoutMs = workerConfig.getLong(WorkerConfig.OFFSET_COMMIT_TIMEOUT_MS_CONFIG);\n \n-        log.info(\"{} Committing offsets\", this);\n+        log.trace(\"{} Committing offsets\", this);", "originalCommit": "a66de28dc046a5b4845b57605f8748cc857a084d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTI1MTUzMw==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r481251533", "bodyText": "Same question here about trace vs debug, as denoted above. With debug logs, isn't it useful to know how long it took to commit all offsets?", "author": "rhauch", "createdAt": "2020-09-01T15:57:47Z", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -571,7 +571,7 @@ public boolean commitOffsets() {\n         finishSuccessfulFlush();\n         long durationMillis = time.milliseconds() - started;\n         recordCommitSuccess(durationMillis);\n-        log.info(\"{} Finished commitOffsets successfully in {} ms\",\n+        log.trace(\"{} Finished commitOffsets successfully in {} ms\",", "originalCommit": "a66de28dc046a5b4845b57605f8748cc857a084d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE5NjA2MQ==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r483196061", "bodyText": "@rhauch, The duration is an interesting point. I was considering that this is tracing exit of a function which already has debug in it. I think the duration is an aspect I hadn't considered, so I'll be happy to make these all uniformly debug level", "author": "cyrusv", "createdAt": "2020-09-03T19:07:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTI1MTUzMw=="}], "type": "inlineReview"}, {"oid": "7efca0680a943d6accf625bd4d8544aec4244d95", "url": "https://github.com/apache/kafka/commit/7efca0680a943d6accf625bd4d8544aec4244d95", "message": "debug", "committedDate": "2020-09-03T19:28:49Z", "type": "commit"}, {"oid": "d8112f744c34ef4fbb7eacf54da07697444bee6d", "url": "https://github.com/apache/kafka/commit/d8112f744c34ef4fbb7eacf54da07697444bee6d", "message": "debug", "committedDate": "2020-09-03T19:29:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg5OTAxMQ==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r504899011", "bodyText": "I'm not convinced that changing this to DEBUG is worth it. The number of source records output in this log message can be instrumental in some cases.\nFor example, if the producer does not keep up with the source task (for whatever reason), this currently INFO-level message appears shortly before the following ERROR-level message:\n... ERROR WorkerSourceTask{id=...} Failed to commit offsets (org.apache.kafka.connect.runtime.SourceTaskOffsetCommitter)\n\nThe number of outstanding source records reported by this line is an important factor in determining how to tune the producer and offset.flush.timeout.ms value.", "author": "rhauch", "createdAt": "2020-10-14T18:50:22Z", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -492,7 +492,7 @@ public boolean commitOffsets() {\n             // to persistent storage\n \n             // Next we need to wait for all outstanding messages to finish sending\n-            log.info(\"{} flushing {} outstanding messages for offset commit\", this, outstandingMessages.size());\n+            log.debug(\"{} flushing {} outstanding messages for offset commit\", this, outstandingMessages.size());", "originalCommit": "d8112f744c34ef4fbb7eacf54da07697444bee6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDkxNjc1OA==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r504916758", "bodyText": "I do not feel strongly about this particular message -- it represents about 2% of the connect log volume in my deployment, so not too bad. Are you still onboard with the other log levels I've updated in the PR? In which case, I will revert this one?", "author": "cyrusv", "createdAt": "2020-10-14T19:22:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg5OTAxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDkyMDAwNQ==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r504920005", "bodyText": "Yeah, I think the log messages other than this one are fine as DEBUG.", "author": "rhauch", "createdAt": "2020-10-14T19:28:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg5OTAxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDk2MzkyMA==", "url": "https://github.com/apache/kafka/pull/8918#discussion_r504963920", "bodyText": "Sounds good, updated", "author": "cyrusv", "createdAt": "2020-10-14T20:50:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg5OTAxMQ=="}], "type": "inlineReview"}, {"oid": "3fe54aaa51319192de3efc6b8ee4fe5977e0cec3", "url": "https://github.com/apache/kafka/commit/3fe54aaa51319192de3efc6b8ee4fe5977e0cec3", "message": "Change back to info", "committedDate": "2020-10-14T20:46:07Z", "type": "commit"}]}