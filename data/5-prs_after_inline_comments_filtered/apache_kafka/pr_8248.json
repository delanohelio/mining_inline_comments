{"pr_number": 8248, "pr_title": "KAFKA-9501: convert between active and standby without closing stores", "pr_createdAt": "2020-03-07T05:47:44Z", "pr_url": "https://github.com/apache/kafka/pull/8248", "timeline": [{"oid": "25bac9ab42393c80e55bab751f64eb4cdf75a189", "url": "https://github.com/apache/kafka/commit/25bac9ab42393c80e55bab751f64eb4cdf75a189", "message": "Squashed for rebase", "committedDate": "2020-05-28T22:18:40Z", "type": "commit"}, {"oid": "36b372f2c68956fd914ad01e00ea7d8cb47ec4a8", "url": "https://github.com/apache/kafka/commit/36b372f2c68956fd914ad01e00ea7d8cb47ec4a8", "message": "fix checkstyle suppresion file merge", "committedDate": "2020-05-28T22:18:40Z", "type": "commit"}, {"oid": "d823a4f0c2af99328429b4d3967e5f018f5c185b", "url": "https://github.com/apache/kafka/commit/d823a4f0c2af99328429b4d3967e5f018f5c185b", "message": "remove moved code", "committedDate": "2020-05-28T22:18:40Z", "type": "commit"}, {"oid": "dc5f2eb11bde4e1c31eaaf0360f058e1e2960964", "url": "https://github.com/apache/kafka/commit/dc5f2eb11bde4e1c31eaaf0360f058e1e2960964", "message": "need to re-register flush listener with new cache", "committedDate": "2020-05-28T22:18:40Z", "type": "commit"}, {"oid": "1ac734054fb423d7407581a4062177a54d7d2a6c", "url": "https://github.com/apache/kafka/commit/1ac734054fb423d7407581a4062177a54d7d2a6c", "message": "fix mock", "committedDate": "2020-05-28T22:18:40Z", "type": "commit"}, {"oid": "84380330f12d93a116c6e3f5fc05a9efb17448e8", "url": "https://github.com/apache/kafka/commit/84380330f12d93a116c6e3f5fc05a9efb17448e8", "message": "fix suppression buffer record collector reference", "committedDate": "2020-05-28T22:18:40Z", "type": "commit"}, {"oid": "84380330f12d93a116c6e3f5fc05a9efb17448e8", "url": "https://github.com/apache/kafka/commit/84380330f12d93a116c6e3f5fc05a9efb17448e8", "message": "fix suppression buffer record collector reference", "committedDate": "2020-05-28T22:18:40Z", "type": "forcePushed"}, {"oid": "28ba380809d0b0d2a60c0381f4b74743bd9741bb", "url": "https://github.com/apache/kafka/commit/28ba380809d0b0d2a60c0381f4b74743bd9741bb", "message": "fix TrackingStateRestoreListener", "committedDate": "2020-05-28T23:13:06Z", "type": "commit"}, {"oid": "c491bfbff2805e78fd1c5f854b432e7b5954ceb0", "url": "https://github.com/apache/kafka/commit/c491bfbff2805e78fd1c5f854b432e7b5954ceb0", "message": "clean up RestoreIntegrationTest", "committedDate": "2020-05-28T23:39:57Z", "type": "commit"}, {"oid": "30ac7b3ccd47063497c17ac148d90f9b29683e82", "url": "https://github.com/apache/kafka/commit/30ac7b3ccd47063497c17ac148d90f9b29683e82", "message": "split test into separate close/recycle tests", "committedDate": "2020-05-28T23:49:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUyOTA2MA==", "url": "https://github.com/apache/kafka/pull/8248#discussion_r432529060", "bodyText": "Note for the future: it's not necessary to prefix the temp directory.", "author": "vvcephei", "createdAt": "2020-05-29T14:34:35Z", "path": "streams/src/test/java/org/apache/kafka/streams/integration/RestoreIntegrationTest.java", "diffHunk": "@@ -77,29 +89,30 @@\n public class RestoreIntegrationTest {\n     private static final int NUM_BROKERS = 1;\n \n-    private static final String APPID = \"restore-test\";\n-\n     @ClassRule\n-    public static final EmbeddedKafkaCluster CLUSTER =\n-            new EmbeddedKafkaCluster(NUM_BROKERS);\n-    private static final String INPUT_STREAM = \"input-stream\";\n-    private static final String INPUT_STREAM_2 = \"input-stream-2\";\n+    public static final EmbeddedKafkaCluster CLUSTER = new EmbeddedKafkaCluster(NUM_BROKERS);\n+\n+    @Rule\n+    public final TestName testName = new TestName();\n+    private String appId;\n+    private String inputStream;\n+\n     private final int numberOfKeys = 10000;\n     private KafkaStreams kafkaStreams;\n \n-    @BeforeClass\n-    public static void createTopics() throws InterruptedException {\n-        CLUSTER.createTopic(INPUT_STREAM, 2, 1);\n-        CLUSTER.createTopic(INPUT_STREAM_2, 2, 1);\n-        CLUSTER.createTopic(APPID + \"-store-changelog\", 2, 1);\n+    @Before\n+    public void createTopics() throws InterruptedException {\n+        appId = safeUniqueTestName(RestoreIntegrationTest.class, testName);\n+        inputStream = appId + \"-input-stream\";\n+        CLUSTER.createTopic(inputStream, 2, 1);\n     }\n \n-    private Properties props(final String applicationId) {\n+    private Properties props() {\n         final Properties streamsConfiguration = new Properties();\n-        streamsConfiguration.put(StreamsConfig.APPLICATION_ID_CONFIG, applicationId);\n+        streamsConfiguration.put(StreamsConfig.APPLICATION_ID_CONFIG, appId);\n         streamsConfiguration.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, CLUSTER.bootstrapServers());\n         streamsConfiguration.put(StreamsConfig.CACHE_MAX_BYTES_BUFFERING_CONFIG, 0);\n-        streamsConfiguration.put(StreamsConfig.STATE_DIR_CONFIG, TestUtils.tempDirectory(applicationId).getPath());\n+        streamsConfiguration.put(StreamsConfig.STATE_DIR_CONFIG, TestUtils.tempDirectory(appId).getPath());", "originalCommit": "30ac7b3ccd47063497c17ac148d90f9b29683e82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}