{"pr_number": 8413, "pr_title": "MINOR: Allow single struct to be a field in protocol spec", "pr_createdAt": "2020-04-03T03:38:31Z", "pr_url": "https://github.com/apache/kafka/pull/8413", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI2OTcyOA==", "url": "https://github.com/apache/kafka/pull/8413#discussion_r403269728", "bodyText": "I don't think we should get rid of this check entirely.  We should change it to check for either array or struct type, rather than just array type, right?\nIt wouldn't make sense to have an int32 with fields, for example.", "author": "cmccabe", "createdAt": "2020-04-03T19:36:42Z", "path": "generator/src/main/java/org/apache/kafka/message/FieldSpec.java", "diffHunk": "@@ -101,11 +101,7 @@ public FieldSpec(@JsonProperty(\"name\") String name,\n         this.entityType.verifyTypeMatches(name, this.type);\n \n         this.about = about == null ? \"\" : about;\n-        if (!this.fields().isEmpty()) {\n-            if (!this.type.isArray()) {\n-                throw new RuntimeException(\"Non-array field \" + name + \" cannot have fields\");\n-            }\n-        }\n+", "originalCommit": "95b142402c983088e6a34c394620507498d641af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ0MjA3NQ==", "url": "https://github.com/apache/kafka/pull/8413#discussion_r404442075", "bodyText": "Makes sense. Done.", "author": "soondenana", "createdAt": "2020-04-06T23:09:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI2OTcyOA=="}], "type": "inlineReview"}, {"oid": "28d3bf9a0d1610fccba2fa7519d6732bdab4ee23", "url": "https://github.com/apache/kafka/commit/28d3bf9a0d1610fccba2fa7519d6732bdab4ee23", "message": "MINOR: Allow single struct to be a field in protocol spec\n\nCurrently protocol generation code has this restriction that a structure\nfield need to be an array. There are however some case where fields need\nto be grouped but not be an array. This is for organizational purposes\nand mirrors program structure.\n\nThis change adds this capability to the protocol generation.", "committedDate": "2020-04-09T20:15:02Z", "type": "commit"}, {"oid": "fc6ea26ddf4a87a8bfb95b5f3c5f11887be65fa8", "url": "https://github.com/apache/kafka/commit/fc6ea26ddf4a87a8bfb95b5f3c5f11887be65fa8", "message": "Take care of review comments", "committedDate": "2020-04-09T20:15:02Z", "type": "commit"}, {"oid": "295295079de4f189eff0524084d0b1ecbde8f205", "url": "https://github.com/apache/kafka/commit/295295079de4f189eff0524084d0b1ecbde8f205", "message": "Remove Struct nullable\n\nMaking struct nullable is a bigger change, my previous attempt left a\nbunch of place where modificaiton is needed. Simpler to not support it\nas this is the current state.", "committedDate": "2020-04-09T20:15:02Z", "type": "commit"}, {"oid": "fead599e2658afef62235de40469bbd23aaef2bd", "url": "https://github.com/apache/kafka/commit/fead599e2658afef62235de40469bbd23aaef2bd", "message": "Add support for tagged structs", "committedDate": "2020-04-09T20:15:02Z", "type": "commit"}, {"oid": "7a5138d1bab4200d232e18600ba8217986946060", "url": "https://github.com/apache/kafka/commit/7a5138d1bab4200d232e18600ba8217986946060", "message": "Add roundtrip test for SimpleExampleMessage", "committedDate": "2020-04-09T22:34:43Z", "type": "commit"}, {"oid": "7a5138d1bab4200d232e18600ba8217986946060", "url": "https://github.com/apache/kafka/commit/7a5138d1bab4200d232e18600ba8217986946060", "message": "Add roundtrip test for SimpleExampleMessage", "committedDate": "2020-04-09T22:34:43Z", "type": "forcePushed"}]}