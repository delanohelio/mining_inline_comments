{"pr_number": 9120, "pr_title": "KAFKA-10316: Consider renaming getter method for Interactive Queries", "pr_createdAt": "2020-08-04T07:32:07Z", "pr_url": "https://github.com/apache/kafka/pull/9120", "timeline": [{"oid": "6efab44f57e300828bb7a198e88145ece7583ec5", "url": "https://github.com/apache/kafka/commit/6efab44f57e300828bb7a198e88145ece7583ec5", "message": "KAFKA-10316: Consider renaming getter method for Interactive Queries\n\n* Deprecated the existing getters and added new getters `activeHost()`, `standbyHosts()`, and `partition()` to KeyQueryMetadata.java.\n\n* Update the existing Tests to use the new getters of KeyQueryMetadata.java . Below are the Test classes that were updated with new getters.\n\n    OptimizedKTableIntegrationTest.java\n    QueryableStateIntegrationTest.java\n    StoreQueryIntegrationTest.java\n    StreamsMetadataStateTest.java", "committedDate": "2020-08-04T06:09:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNjY1Nw==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465106657", "bodyText": "Nit: [a]ctive (i understand that it's just c&p but it seem wrong in the original JavaDoc, too.\nstreams -> Kafka Streams\nAlso, missing . at the end of the sentence.", "author": "mjsax", "createdAt": "2020-08-04T14:46:28Z", "path": "streams/src/main/java/org/apache/kafka/streams/KeyQueryMetadata.java", "diffHunk": "@@ -71,11 +75,40 @@ public HostInfo getActiveHost() {\n      * Get the Store partition corresponding to the key.\n      *\n      * @return store partition number\n+     * @deprecated Use {@link #partition()} instead.\n      */\n+    @Deprecated\n     public int getPartition() {\n         return partition;\n     }\n \n+    /**\n+     * Get the Active streams instance for given key", "originalCommit": "6efab44f57e300828bb7a198e88145ece7583ec5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2Mzg0MQ==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465163841", "bodyText": "I'm with you, we should fix it, for the deprecated ones too.\nFixed.", "author": "johnthotekat", "createdAt": "2020-08-04T16:08:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNjY1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNzIzMA==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465107230", "bodyText": "nit: Streams -> Kafka Streams\nAlso, missing . at the end of the sentence.", "author": "mjsax", "createdAt": "2020-08-04T14:47:16Z", "path": "streams/src/main/java/org/apache/kafka/streams/KeyQueryMetadata.java", "diffHunk": "@@ -71,11 +75,40 @@ public HostInfo getActiveHost() {\n      * Get the Store partition corresponding to the key.\n      *\n      * @return store partition number\n+     * @deprecated Use {@link #partition()} instead.\n      */\n+    @Deprecated\n     public int getPartition() {\n         return partition;\n     }\n \n+    /**\n+     * Get the Active streams instance for given key\n+     *\n+     * @return active instance's {@link HostInfo}\n+     */\n+    public HostInfo activeHost() {\n+        return activeHost;\n+    }\n+\n+    /**\n+     * Get the Streams instances that host the key as standbys", "originalCommit": "6efab44f57e300828bb7a198e88145ece7583ec5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2NDI2Nw==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465164267", "bodyText": "Fixed.", "author": "johnthotekat", "createdAt": "2020-08-04T16:08:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNzIzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNzY2Mg==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465107662", "bodyText": "[s]tore", "author": "mjsax", "createdAt": "2020-08-04T14:47:47Z", "path": "streams/src/main/java/org/apache/kafka/streams/KeyQueryMetadata.java", "diffHunk": "@@ -71,11 +75,40 @@ public HostInfo getActiveHost() {\n      * Get the Store partition corresponding to the key.\n      *\n      * @return store partition number\n+     * @deprecated Use {@link #partition()} instead.\n      */\n+    @Deprecated\n     public int getPartition() {\n         return partition;\n     }\n \n+    /**\n+     * Get the Active streams instance for given key\n+     *\n+     * @return active instance's {@link HostInfo}\n+     */\n+    public HostInfo activeHost() {\n+        return activeHost;\n+    }\n+\n+    /**\n+     * Get the Streams instances that host the key as standbys\n+     *\n+     * @return set of standby {@link HostInfo} or a empty set, if no standbys are configured\n+     */\n+    public Set<HostInfo> standbyHosts() {\n+        return standbyHosts;\n+    }\n+\n+    /**\n+     * Get the Store partition corresponding to the key.", "originalCommit": "6efab44f57e300828bb7a198e88145ece7583ec5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2NDU4Ng==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465164586", "bodyText": "Fixed.", "author": "johnthotekat", "createdAt": "2020-08-04T16:09:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNzY2Mg=="}], "type": "inlineReview"}, {"oid": "7859c3ab7423797fc80a00d19e34292feb16818b", "url": "https://github.com/apache/kafka/commit/7859c3ab7423797fc80a00d19e34292feb16818b", "message": "KAFKA-10316: Consider renaming getter method for Interactive Queries\n\n* Deprecated the existing getters and added new getters `activeHost()`, `standbyHosts()`, and `partition()` to KeyQueryMetadata.java.\n\n* Update the existing Tests to use the new getters of KeyQueryMetadata.java . Below are the Test classes that were updated with new getters.\n\n    OptimizedKTableIntegrationTest.java\n    QueryableStateIntegrationTest.java\n    StoreQueryIntegrationTest.java\n    StreamsMetadataStateTest.java\n\n* Correcting some JavaDoc nits.", "committedDate": "2020-08-04T15:47:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3NTE1Mg==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465175152", "bodyText": "I feel it should be \"key partition number\" instead of store.", "author": "brary", "createdAt": "2020-08-04T16:25:10Z", "path": "streams/src/main/java/org/apache/kafka/streams/KeyQueryMetadata.java", "diffHunk": "@@ -50,32 +50,65 @@ public KeyQueryMetadata(final HostInfo activeHost, final Set<HostInfo> standbyHo\n     }\n \n     /**\n-     * Get the Active streams instance for given key\n+     * Get the active Kafka Streams instance for given key.\n      *\n      * @return active instance's {@link HostInfo}\n+     * @deprecated Use {@link #activeHost()} instead.\n      */\n+    @Deprecated\n     public HostInfo getActiveHost() {\n         return activeHost;\n     }\n \n     /**\n-     * Get the Streams instances that host the key as standbys\n+     * Get the Kafka Streams instances that host the key as standbys.\n      *\n      * @return set of standby {@link HostInfo} or a empty set, if no standbys are configured\n+     * @deprecated Use {@link #standbyHosts()} instead.\n      */\n+    @Deprecated\n     public Set<HostInfo> getStandbyHosts() {\n         return standbyHosts;\n     }\n \n     /**\n-     * Get the Store partition corresponding to the key.\n+     * Get the store partition corresponding to the key.\n      *\n      * @return store partition number\n+     * @deprecated Use {@link #partition()} instead.\n      */\n+    @Deprecated\n     public int getPartition() {\n         return partition;\n     }\n \n+    /**\n+     * Get the active Kafka Streams instance for given key.\n+     *\n+     * @return active instance's {@link HostInfo}\n+     */\n+    public HostInfo activeHost() {\n+        return activeHost;\n+    }\n+\n+    /**\n+     * Get the Kafka Streams instances that host the key as standbys.\n+     *\n+     * @return set of standby {@link HostInfo} or a empty set, if no standbys are configured\n+     */\n+    public Set<HostInfo> standbyHosts() {\n+        return standbyHosts;\n+    }\n+\n+    /**\n+     * Get the store partition corresponding to the key.\n+     *\n+     * @return store partition number", "originalCommit": "7859c3ab7423797fc80a00d19e34292feb16818b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE5MDUxMg==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465190512", "bodyText": "We are fetching the state store partition number corresponding to the key with this getter and hence that description I believe.\nMore over, this is a copy paste work, we copied existing getter's with a new name and deprecated the old getter's.\nAny specific reason why you feel that the description should be \"key partition number\" ?", "author": "johnthotekat", "createdAt": "2020-08-04T16:50:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3NTE1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE5MzIzMA==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465193230", "bodyText": "@mjsax Please correct me if I'm wrong.", "author": "johnthotekat", "createdAt": "2020-08-04T16:54:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3NTE1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTIwMTYwMA==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465201600", "bodyText": "I wrote the old getters & javadocs but now I feel that key partition number better conveys the meaning than store partition number.\nThe class KeyQueryMetadata contains the information for a key being requested via query. So, the partition number we are returning here is the partition to which the key belongs, it has no relation to any store yet. You will of course use this partition information to fetch the data corresponding to the key from any store but still that doesn't change the fact that this partition number is related to the key rather than the store.\nI am fine either way though.", "author": "brary", "createdAt": "2020-08-04T17:09:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3NTE1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM4MDc5OA==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465380798", "bodyText": "IMHO, \"key partition number\" sound like as if the key would be partitioned, and we get the partition number for the \"key partition\". But in fact, the store is partitioned and thus I think the current \"store partition number\" is ok as-is.", "author": "mjsax", "createdAt": "2020-08-04T23:13:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3NTE1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ2NDE4Mg==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465464182", "bodyText": "Sure, that's fine.", "author": "brary", "createdAt": "2020-08-05T04:25:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3NTE1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3NjEyMQ==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465176121", "bodyText": "Get the partition number corresponding to the key.", "author": "brary", "createdAt": "2020-08-04T16:26:38Z", "path": "streams/src/main/java/org/apache/kafka/streams/KeyQueryMetadata.java", "diffHunk": "@@ -50,32 +50,65 @@ public KeyQueryMetadata(final HostInfo activeHost, final Set<HostInfo> standbyHo\n     }\n \n     /**\n-     * Get the Active streams instance for given key\n+     * Get the active Kafka Streams instance for given key.\n      *\n      * @return active instance's {@link HostInfo}\n+     * @deprecated Use {@link #activeHost()} instead.\n      */\n+    @Deprecated\n     public HostInfo getActiveHost() {\n         return activeHost;\n     }\n \n     /**\n-     * Get the Streams instances that host the key as standbys\n+     * Get the Kafka Streams instances that host the key as standbys.\n      *\n      * @return set of standby {@link HostInfo} or a empty set, if no standbys are configured\n+     * @deprecated Use {@link #standbyHosts()} instead.\n      */\n+    @Deprecated\n     public Set<HostInfo> getStandbyHosts() {\n         return standbyHosts;\n     }\n \n     /**\n-     * Get the Store partition corresponding to the key.\n+     * Get the store partition corresponding to the key.\n      *\n      * @return store partition number\n+     * @deprecated Use {@link #partition()} instead.\n      */\n+    @Deprecated\n     public int getPartition() {\n         return partition;\n     }\n \n+    /**\n+     * Get the active Kafka Streams instance for given key.\n+     *\n+     * @return active instance's {@link HostInfo}\n+     */\n+    public HostInfo activeHost() {\n+        return activeHost;\n+    }\n+\n+    /**\n+     * Get the Kafka Streams instances that host the key as standbys.\n+     *\n+     * @return set of standby {@link HostInfo} or a empty set, if no standbys are configured\n+     */\n+    public Set<HostInfo> standbyHosts() {\n+        return standbyHosts;\n+    }\n+\n+    /**\n+     * Get the store partition corresponding to the key.", "originalCommit": "7859c3ab7423797fc80a00d19e34292feb16818b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE5MjM4MQ==", "url": "https://github.com/apache/kafka/pull/9120#discussion_r465192381", "bodyText": "Relatable to the comments from line 106 right ?", "author": "johnthotekat", "createdAt": "2020-08-04T16:53:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3NjEyMQ=="}], "type": "inlineReview"}, {"oid": "8279213e1cf2b921e7c153ff1586d32f75aa8719", "url": "https://github.com/apache/kafka/commit/8279213e1cf2b921e7c153ff1586d32f75aa8719", "message": "Merge pull request #1 from apache/trunk\n\nMerge apache/kafka to johnthotekat/kafka", "committedDate": "2020-08-05T13:02:59Z", "type": "commit"}, {"oid": "9d0b97f1daa066c91618230ebcc69d3150ae7208", "url": "https://github.com/apache/kafka/commit/9d0b97f1daa066c91618230ebcc69d3150ae7208", "message": "Merge branches 'KAFKA-10316-renaming-getter-method' and 'trunk' of https://github.com/johnthotekat/kafka into KAFKA-10316-renaming-getter-method", "committedDate": "2020-08-05T13:03:55Z", "type": "commit"}]}