{"pr_number": 6810, "pr_title": "KEYCLOAK-11155 split on first '=' instead of all", "pr_createdAt": "2020-02-20T08:56:03Z", "pr_url": "https://github.com/keycloak/keycloak/pull/6810", "timeline": [{"oid": "e0a3cf8ed269669c95f53dd921c769174d3bacfa", "url": "https://github.com/keycloak/keycloak/commit/e0a3cf8ed269669c95f53dd921c769174d3bacfa", "message": "KEYCLOAK-11155 split on first '=' instead of all", "committedDate": "2020-02-20T15:39:35Z", "type": "forcePushed"}, {"oid": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a", "url": "https://github.com/keycloak/keycloak/commit/303514c73fd5b8fafcb9602c73f4b6fdafc6774a", "message": "KEYCLOAK-11155 split on first '=' instead of all", "committedDate": "2020-02-21T09:29:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcxODA2Mw==", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383718063", "bodyText": "We shouldn't change testAppUrl. When this url is changed, other tests will use it as well. Could you please change the testAppUrl variable to final by using AuthServerTestEnricher.getAuthServerContextRoot method?", "author": "mhajas", "createdAt": "2020-02-25T08:19:13Z", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "diffHunk": "@@ -474,6 +474,23 @@ public void testLocationHeaderInResponse() {\n                         });\n     }\n \n+    @Test\n+    public void equalsSignInRedirectUrl() {\n+\n+        testAppUrl = authServerContextRootPage.toString().replace(\"localhost\", NIP_IO_URL) + JAVASCRIPT_URL + \"/index.html?test=bla=bla&super=man\";", "originalCommit": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg1NDU1Mg==", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383854552", "bodyText": "It's done here as well. How do I set the testAppUrl by using AuthServerTestEnricher.getAuthServerContextRoot method?", "author": "edewit", "createdAt": "2020-02-25T12:42:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcxODA2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg4OTI0OQ==", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383889249", "bodyText": "I see. It is working because testAppUrl is assigned in @Before method, so it is same for each test. However it is useless to reassign it before each method since for majority of methods it is same. We can have something like this\nprivate static final String TEST_APP_URL = AuthServerTestEnricher.getAuthServerContextRoot().replace(\"localhost\", NIP_IO_URL) + JAVASCRIPT_URL + \"/index.html\";\n\ninstead of\nprivate String testAppUrl;\n\nand then create a new variable based on TEST_APP_URL everywhere we need to change it.\nHowever this is little bit out of this issue and the test will be working even without it, so I won't insist on changing it :-). Feel free to ignore this comment.", "author": "mhajas", "createdAt": "2020-02-25T13:50:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcxODA2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg5MTgxNw==", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383891817", "bodyText": "Right, I feel like this is a separate issue", "author": "edewit", "createdAt": "2020-02-25T13:54:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcxODA2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcyMTE4OA==", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383721188", "bodyText": "This is always true. You need to use driver1.getCurrentUrl() in order to find out current url in browser.", "author": "mhajas", "createdAt": "2020-02-25T08:25:55Z", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "diffHunk": "@@ -474,6 +474,23 @@ public void testLocationHeaderInResponse() {\n                         });\n     }\n \n+    @Test\n+    public void equalsSignInRedirectUrl() {\n+\n+        testAppUrl = authServerContextRootPage.toString().replace(\"localhost\", NIP_IO_URL) + JAVASCRIPT_URL + \"/index.html?test=bla=bla&super=man\";\n+        jsDriver.navigate().to(testAppUrl);\n+\n+        JSObjectBuilder arguments = defaultArguments();\n+\n+        testExecutor.init(arguments, this::assertInitNotAuth)\n+                .login(this::assertOnLoginPage)\n+                .loginForm(testUser, this::assertOnTestAppUrl)\n+                .init(arguments, (driver1, output1, events2) -> {\n+                    assertTrue(testAppUrl.contains(\"bla=bla\"));", "originalCommit": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzgxMzcyNw==", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383813727", "bodyText": "Remove empty line", "author": "mhajas", "createdAt": "2020-02-25T11:11:57Z", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "diffHunk": "@@ -474,6 +474,23 @@ public void testLocationHeaderInResponse() {\n                         });\n     }\n \n+    @Test\n+    public void equalsSignInRedirectUrl() {\n+", "originalCommit": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ace90521b5884d2daef2bb68ce0caed3957c5a2c", "url": "https://github.com/keycloak/keycloak/commit/ace90521b5884d2daef2bb68ce0caed3957c5a2c", "message": "KEYCLOAK-11155 split on first '=' instead of all", "committedDate": "2020-02-25T12:43:09Z", "type": "commit"}, {"oid": "ace90521b5884d2daef2bb68ce0caed3957c5a2c", "url": "https://github.com/keycloak/keycloak/commit/ace90521b5884d2daef2bb68ce0caed3957c5a2c", "message": "KEYCLOAK-11155 split on first '=' instead of all", "committedDate": "2020-02-25T12:43:09Z", "type": "forcePushed"}]}