{"pr_number": 536, "pr_title": "Check that the ignoring SslContextFactory has empty keystore", "pr_createdAt": "2020-03-03T15:29:40Z", "pr_url": "https://github.com/zowe/api-layer/pull/536", "timeline": [{"oid": "c5d0e707c30091cb53747c96dd5eb0ba199b4149", "url": "https://github.com/zowe/api-layer/commit/c5d0e707c30091cb53747c96dd5eb0ba199b4149", "message": "Check that the ignoring SslContextFactory has empty keystore\n\nSigned-off-by: Petr Plavjanik <plavjanik@gmail.com>", "committedDate": "2020-03-03T15:24:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzEwNTQyNA==", "url": "https://github.com/zowe/api-layer/pull/536#discussion_r387105424", "bodyText": "Typo", "author": "JirkaAichler", "createdAt": "2020-03-03T15:39:48Z", "path": "common-service-core/src/main/java/org/zowe/apiml/security/HttpsFactory.java", "diffHunk": "@@ -169,7 +176,8 @@ private void loadKeystoreMaterial(SSLContextBuilder sslContextBuilder) throws Un\n                 config.getKeyPassword() == null ? null : config.getKeyPassword().toCharArray());\n     }\n \n-    private void loadKeyringMaterial(SSLContextBuilder sslContextBuilder) throws UnrecoverableKeyException,\n+    private void\n+    loadKeyringMaterial(SSLContextBuilder sslContextBuilder) throws UnrecoverableKeyException,", "originalCommit": "c5d0e707c30091cb53747c96dd5eb0ba199b4149", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzcyNTkxNA==", "url": "https://github.com/zowe/api-layer/pull/536#discussion_r387725914", "bodyText": "Thanks!", "author": "plavjanik", "createdAt": "2020-03-04T15:06:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzEwNTQyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzUwMzEyNw==", "url": "https://github.com/zowe/api-layer/pull/536#discussion_r387503127", "bodyText": "This method has default access modifier, but what about to be clear put here comment to known:\n\nmethod is only for testing purpose\nKeyStore is stored only in case of empty keystore (not if keystore is provided)", "author": "pj892031", "createdAt": "2020-03-04T08:08:43Z", "path": "common-service-core/src/main/java/org/zowe/apiml/security/HttpsFactory.java", "diffHunk": "@@ -76,6 +77,10 @@ public ConnectionSocketFactory createSslSocketFactory() {\n         }\n     }\n \n+    KeyStore getUsedStore() {", "originalCommit": "c5d0e707c30091cb53747c96dd5eb0ba199b4149", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzcyNjUwMA==", "url": "https://github.com/zowe/api-layer/pull/536#discussion_r387726500", "bodyText": "Good idea! I will add the comment.", "author": "plavjanik", "createdAt": "2020-03-04T15:07:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzUwMzEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc0NjU2Mg==", "url": "https://github.com/zowe/api-layer/pull/536#discussion_r387746562", "bodyText": "Makes sense. I have added the comment.", "author": "plavjanik", "createdAt": "2020-03-04T15:35:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzUwMzEyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzUwNTA0OQ==", "url": "https://github.com/zowe/api-layer/pull/536#discussion_r387505049", "bodyText": "What about the second case with ignoring=false for purpose of restTemplateWithoutKeystore etc. I think we don't have any tests for that.", "author": "pj892031", "createdAt": "2020-03-04T08:13:24Z", "path": "common-service-core/src/test/java/org/zowe/apiml/security/HttpsFactoryTest.java", "diffHunk": "@@ -44,11 +50,12 @@ public void shouldCreateSecureSslSocketFactory() {\n     }\n \n     @Test\n-    public void shouldCreateIgnoringSslSocketFactory() {\n+    public void shouldCreateIgnoringSslSocketFactory() throws KeyStoreException {\n         HttpsConfig httpsConfig = httpsConfigBuilder.verifySslCertificatesOfServices(false).build();\n         HttpsFactory httpsFactory = new HttpsFactory(httpsConfig);\n         ConnectionSocketFactory socketFactory = httpsFactory.createSslSocketFactory();\n         assertEquals(SSLConnectionSocketFactory.class, socketFactory.getClass());\n+        assertFalse(httpsFactory.getUsedKeyStore().aliases().hasMoreElements());", "originalCommit": "c5d0e707c30091cb53747c96dd5eb0ba199b4149", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc0NjQyNA==", "url": "https://github.com/zowe/api-layer/pull/536#discussion_r387746424", "bodyText": "It makes great sense. I have added the test case.", "author": "plavjanik", "createdAt": "2020-03-04T15:35:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzUwNTA0OQ=="}], "type": "inlineReview"}, {"oid": "fe7d6c9916033e57ebcccaab1866902250a4aca7", "url": "https://github.com/zowe/api-layer/commit/fe7d6c9916033e57ebcccaab1866902250a4aca7", "message": "Address review feedback\n\nSigned-off-by: Petr Plavjanik <plavjanik@gmail.com>", "committedDate": "2020-03-04T15:34:54Z", "type": "commit"}, {"oid": "4e47786f40b0b0ac0598c0cfb1bc119c74cab9f9", "url": "https://github.com/zowe/api-layer/commit/4e47786f40b0b0ac0598c0cfb1bc119c74cab9f9", "message": "Merge branch 'master' into test-for-empty-context", "committedDate": "2020-03-04T15:35:43Z", "type": "commit"}]}