{"pr_number": 7503, "pr_title": "Refactor: move method getNeighborsValidatingCanals to RouteFinder", "pr_createdAt": "2020-08-31T02:09:15Z", "pr_url": "https://github.com/triplea-game/triplea/pull/7503", "timeline": [{"oid": "51bcfde63d2fe1520ac96d5154cc232708ebf0d9", "url": "https://github.com/triplea-game/triplea/commit/51bcfde63d2fe1520ac96d5154cc232708ebf0d9", "message": "Refactor: move method getNeighborsValidatingCanals to RouteFinder\n\nReduces game-core dependencies in GameMap", "committedDate": "2020-08-31T02:06:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE2MTQ2NQ==", "url": "https://github.com/triplea-game/triplea/pull/7503#discussion_r480161465", "bodyText": "As far as I can tell this constructor is only used by this class, so it might as well be private, without the annotation.", "author": "RoiEXLab", "createdAt": "2020-08-31T14:17:30Z", "path": "game-core/src/main/java/games/strategy/engine/data/RouteFinder.java", "diffHunk": "@@ -16,27 +17,29 @@\n import java.util.Set;\n import java.util.function.Function;\n import java.util.function.Predicate;\n+import javax.annotation.Nullable;\n+import lombok.AccessLevel;\n+import lombok.RequiredArgsConstructor;\n \n+@RequiredArgsConstructor(access = AccessLevel.PACKAGE, onConstructor_ = @VisibleForTesting)", "originalCommit": "51bcfde63d2fe1520ac96d5154cc232708ebf0d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDU1MjM0OQ==", "url": "https://github.com/triplea-game/triplea/pull/7503#discussion_r480552349", "bodyText": "Yeah, this one went in circles. I was expecting to need to be able to control MoveValidator for test, though it appears it's not covered by the test cases and therefore injecting a mock is not necessary.", "author": "DanVanAtta", "createdAt": "2020-09-01T01:28:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE2MTQ2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE2MjgwMQ==", "url": "https://github.com/triplea-game/triplea/pull/7503#discussion_r480162801", "bodyText": "I'm not entirely convinced this field is really necessary.\nThe GameMap object is still there, so why not create this object on the fly inside of getNeighborsValidatingCanals?", "author": "RoiEXLab", "createdAt": "2020-08-31T14:19:43Z", "path": "game-core/src/main/java/games/strategy/engine/data/RouteFinder.java", "diffHunk": "@@ -16,27 +17,29 @@\n import java.util.Set;\n import java.util.function.Function;\n import java.util.function.Predicate;\n+import javax.annotation.Nullable;\n+import lombok.AccessLevel;\n+import lombok.RequiredArgsConstructor;\n \n+@RequiredArgsConstructor(access = AccessLevel.PACKAGE, onConstructor_ = @VisibleForTesting)\n class RouteFinder {\n \n+  private final MoveValidator moveValidator;", "originalCommit": "51bcfde63d2fe1520ac96d5154cc232708ebf0d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDU1OTc3Mw==", "url": "https://github.com/triplea-game/triplea/pull/7503#discussion_r480559773", "bodyText": "Creating an object on the fly is a violation of IOC. It would be equivalent to a static method call, which would be an example of static coupling. The intent was to get a mock in there so that this class could be tested, 'map' is already mocked and I pretty much assumed the move validator path was going to need the same.\nIn the short term, raising the dependency from a method where there is in effect a static dependency to a constructor injection can help us decouple this class from 'gameData' (which in turn comes from gameMap). This class is already very odd as the predicate member probably should not be a constructor arg..", "author": "DanVanAtta", "createdAt": "2020-09-01T01:35:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE2MjgwMQ=="}], "type": "inlineReview"}, {"oid": "8310bf6204a76eb6008fc72f449651ed84154215", "url": "https://github.com/triplea-game/triplea/commit/8310bf6204a76eb6008fc72f449651ed84154215", "message": "Remove @VisibleForTesting annoation and mark constructor as private for now.", "committedDate": "2020-09-01T01:33:19Z", "type": "commit"}]}