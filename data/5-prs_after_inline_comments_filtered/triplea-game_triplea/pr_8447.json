{"pr_number": 8447, "pr_title": "Pass GameMap instead of GameData for TerritoryAttachment methods", "pr_createdAt": "2020-12-17T05:27:42Z", "pr_url": "https://github.com/triplea-game/triplea/pull/8447", "timeline": [{"oid": "f6a5f498a77b42f38161d2030ee0ec79ba1e780c", "url": "https://github.com/triplea-game/triplea/commit/f6a5f498a77b42f38161d2030ee0ec79ba1e780c", "message": "Pass GameMap instead of GameData for TerritoryAttachment methods\n\nThe four static methods in TerritoryAttachment that are related with\ncapitals don't need the entire GameData. They only need the GameMap.", "committedDate": "2020-12-17T05:25:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDgyMjY4Ng==", "url": "https://github.com/triplea-game/triplea/pull/8447#discussion_r544822686", "bodyText": "These checks are redundant since setCapital doesn't allow unknown player names.  So ta.getCapital() will either return a null or will return a String that is a valid player name.", "author": "trevan", "createdAt": "2020-12-17T05:29:28Z", "path": "game-core/src/main/java/games/strategy/triplea/attachments/TerritoryAttachment.java", "diffHunk": "@@ -78,19 +80,15 @@ public static boolean doWeHaveEnoughCapitalsToProduce(\n    * we find that we don't own. If a capital has no neighbor connections, it will be sent last.\n    */\n   public static @Nullable Territory getFirstOwnedCapitalOrFirstUnownedCapital(\n-      final GamePlayer player, final GameData data) {\n+      final GamePlayer player, final GameMap gameMap) {\n     final List<Territory> capitals = new ArrayList<>();\n     final List<Territory> noNeighborCapitals = new ArrayList<>();\n-    for (final Territory current : data.getMap().getTerritories()) {\n+    for (final Territory current : gameMap.getTerritories()) {\n       final TerritoryAttachment ta = TerritoryAttachment.get(current);\n       if (ta != null && ta.getCapital() != null) {\n-        final GamePlayer whoseCapital = data.getPlayerList().getPlayerId(ta.getCapital());\n-        if (whoseCapital == null) {", "originalCommit": "f6a5f498a77b42f38161d2030ee0ec79ba1e780c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7e0d97039ca357cbd44759d0b5e44386d75a648a", "url": "https://github.com/triplea-game/triplea/commit/7e0d97039ca357cbd44759d0b5e44386d75a648a", "message": "Mark TerritoryAttachment#getCapital as nullable", "committedDate": "2020-12-17T05:31:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDg3MDM3NQ==", "url": "https://github.com/triplea-game/triplea/pull/8447#discussion_r544870375", "bodyText": "It's a bit amusing this is used almost 20 lines later.   : )\n\"Clean code\" was written in 2008, this code almost certainly predates it. Interesting to see the concept of 'good code' evolve.", "author": "DanVanAtta", "createdAt": "2020-12-17T07:35:41Z", "path": "game-core/src/main/java/games/strategy/triplea/TripleAPlayer.java", "diffHunk": "@@ -566,7 +566,6 @@ private void endTurn() {\n     if (getPlayerBridge().isGameOver()) {\n       return;\n     }\n-    final GameData data = getGameData();", "originalCommit": "7e0d97039ca357cbd44759d0b5e44386d75a648a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}