{"pr_number": 6017, "pr_title": "Use File array instead of constructing the file object", "pr_createdAt": "2020-03-07T20:16:30Z", "pr_url": "https://github.com/triplea-game/triplea/pull/6017", "timeline": [{"oid": "fffc1d05011b0f5cf617ecbf18b08f26dcaa2463", "url": "https://github.com/triplea-game/triplea/commit/fffc1d05011b0f5cf617ecbf18b08f26dcaa2463", "message": "Use File array instead of constructing the file object", "committedDate": "2020-03-07T20:14:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMxMDYwMQ==", "url": "https://github.com/triplea-game/triplea/pull/6017#discussion_r389310601", "bodyText": "I think this needs documentation to make explicit that we expect 'getFiles()' to have 0 or 1 elements. Second, did you test this out to be sure it works and you get 0 values back if you type in a file that DNE?", "author": "DanVanAtta", "createdAt": "2020-03-07T20:39:39Z", "path": "game-core/src/main/java/games/strategy/engine/framework/startup/ui/panels/main/game/selector/GameFileSelector.java", "diffHunk": "@@ -35,11 +36,7 @@\n       fileDialog.setDirectory(ClientSetting.saveGamesFolderPath.getValueOrThrow().toString());\n       fileDialog.setFilenameFilter((dir, name) -> GameDataFileUtils.isCandidateFileName(name));\n       fileDialog.setVisible(true);\n-      final String fileName = fileDialog.getFile();\n-      final String dirName = fileDialog.getDirectory();\n-      return Optional.ofNullable(fileName)\n-          .map(name -> new File(dirName, fileName))\n-          .map(this::mapFileResult);\n+      return Arrays.stream(fileDialog.getFiles()).findAny().map(this::mapFileResult);", "originalCommit": "fffc1d05011b0f5cf617ecbf18b08f26dcaa2463", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMxMDkyNQ==", "url": "https://github.com/triplea-game/triplea/pull/6017#discussion_r389310925", "bodyText": "I wonder if this is a case where it's worth having Mac OS specific code? The lack of mac skinning would not ideal, but I don't think we can readily test this otherwise. If we can guarantee that a selected file exists or none is chosen, then we can probably simplify the callback logic and remove the 'save-game-does-not-exist' warning message (that would be dead code otherwise, as-is in this update, it's conditionally dead-code depending on the OS (which is really not ideal)).", "author": "DanVanAtta", "createdAt": "2020-03-07T20:44:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMxMDYwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMxMjY5Ng==", "url": "https://github.com/triplea-game/triplea/pull/6017#discussion_r389312696", "bodyText": "I think this needs documentation to make explicit that we expect 'getFiles()' to have 0 or 1 elements.\n\nGood point.\n\nSecond, did you test this out to be sure it works and you get 0 values back if you type in a file that DNE?\n\nYes, no doubt there.\n\nI wonder if this is a case where it's worth having Mac OS specific code?\n\nIf you ask me it's silly using a different kind of dialog in the code for a specific OS just to get the skinning right.\nI'm not even sure if JFileDialog looks different with the MacOS L&F, I could check that some time next week or something.\nIn case it doesn't look different because the L&F improved: Great, we can remove the code in the whole codebase.\nIn case it does look different we can ask the mac folks in the community how they feel about it. In case they have strong feelings about keeping it, we could create our own wrapper class that provides a higher level API so we don't have double logic everywhere.\nBut those kind of questions are definitely out of scope for this PR.", "author": "RoiEXLab", "createdAt": "2020-03-07T21:16:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMxMDYwMQ=="}], "type": "inlineReview"}, {"oid": "a83e55b8f2bbad7ace1a0b1595af651d4778241e", "url": "https://github.com/triplea-game/triplea/commit/a83e55b8f2bbad7ace1a0b1595af651d4778241e", "message": "Add comment", "committedDate": "2020-03-07T21:18:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMxNDUwNw==", "url": "https://github.com/triplea-game/triplea/pull/6017#discussion_r389314507", "bodyText": "The comment does not explain why we expect this to be true, why force a maintainer do API research when we can just say \"this is the setting that makes this so\".", "author": "DanVanAtta", "createdAt": "2020-03-07T21:46:05Z", "path": "game-core/src/main/java/games/strategy/engine/framework/startup/ui/panels/main/game/selector/GameFileSelector.java", "diffHunk": "@@ -35,11 +36,10 @@\n       fileDialog.setDirectory(ClientSetting.saveGamesFolderPath.getValueOrThrow().toString());\n       fileDialog.setFilenameFilter((dir, name) -> GameDataFileUtils.isCandidateFileName(name));\n       fileDialog.setVisible(true);\n-      final String fileName = fileDialog.getFile();\n-      final String dirName = fileDialog.getDirectory();\n-      return Optional.ofNullable(fileName)\n-          .map(name -> new File(dirName, fileName))\n-          .map(this::mapFileResult);\n+\n+      // FileDialog.getFiles() always returns an array\n+      // of 1 or 0 items", "originalCommit": "a83e55b8f2bbad7ace1a0b1595af651d4778241e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "51b471a0631f14172302b9f993702432379e6af9", "url": "https://github.com/triplea-game/triplea/commit/51b471a0631f14172302b9f993702432379e6af9", "message": "Clarify comment", "committedDate": "2020-03-07T21:53:22Z", "type": "commit"}]}