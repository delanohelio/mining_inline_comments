{"pr_number": 7637, "pr_title": "Update: Allow unlimited default player colors & add a default for 'color.Impassable'", "pr_createdAt": "2020-09-13T04:28:30Z", "pr_url": "https://github.com/triplea-game/triplea/pull/7637", "timeline": [{"oid": "2ab58896ff192dc4ff1f15ad4b919d69601ae018", "url": "https://github.com/triplea-game/triplea/commit/2ab58896ff192dc4ff1f15ad4b919d69601ae018", "message": "Rename 'DefaultColors' -> 'PlayerColors'", "committedDate": "2020-09-13T01:49:15Z", "type": "commit"}, {"oid": "04b7551b3025a8139a70182f68f7be8db7ebb627", "url": "https://github.com/triplea-game/triplea/commit/04b7551b3025a8139a70182f68f7be8db7ebb627", "message": "Add a utility to construct colors 'ColorUtils'", "committedDate": "2020-09-13T04:19:05Z", "type": "commit"}, {"oid": "a1b3d0239352f61367c833c68004c9775eef0e12", "url": "https://github.com/triplea-game/triplea/commit/a1b3d0239352f61367c833c68004c9775eef0e12", "message": "Allow unlimited default player colors, default the impassable player color, and ensure stable colors\n\n- Cache playerColors such that default player colors are stable. Requesting the color\n  of a player will always return the same color.\n\n- Generate default player colors if we exhaust the default player color list. Once\n  we exceed the colors on the list, start to generate colors randomly.\n\n- Generate default (random) player colors in a stable manner, always generate\n  the same random default player color per player name (use a fixed random seed\n  based on player name).", "committedDate": "2020-09-13T04:19:45Z", "type": "commit"}, {"oid": "c4e1d366bedbda8169d0ac89edd7ab1ecbeca200", "url": "https://github.com/triplea-game/triplea/commit/c4e1d366bedbda8169d0ac89edd7ab1ecbeca200", "message": "Clean up  ColorUtils methods.", "committedDate": "2020-09-13T04:24:30Z", "type": "commit"}, {"oid": "ef2dd987d4e498e037884cf16fc44e8339912494", "url": "https://github.com/triplea-game/triplea/commit/ef2dd987d4e498e037884cf16fc44e8339912494", "message": "Preserve stack trace message in ColorUtils error handling", "committedDate": "2020-09-14T00:56:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMTg3NA==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488031874", "bodyText": "The name might be a bit misleading, it's more like an arbitrary number, also it doesn't look like this method is used at all.", "author": "RoiEXLab", "createdAt": "2020-09-14T15:38:33Z", "path": "java-extras/src/main/java/org/triplea/java/ColorUtils.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.triplea.java;\n+\n+import com.google.common.base.Preconditions;\n+import java.awt.Color;\n+import java.util.Random;\n+import lombok.experimental.UtilityClass;\n+\n+@UtilityClass\n+public class ColorUtils {\n+  /**\n+   * Returns a color parsed from the provided input hex string.\n+   *\n+   * @param colorString EG: 00FF00, FF00FF, 000000\n+   */\n+  public Color fromHexString(final String colorString) {\n+    Preconditions.checkArgument(\n+        colorString.length() == 6,\n+        \"Colors must be 6 digit hex numbers, eg FF0011, not: \" + colorString);\n+    try {\n+      return new Color(Integer.decode(\"0x\" + colorString));\n+    } catch (final NumberFormatException nfe) {\n+      throw new IllegalArgumentException(\n+          \"Colors must be 6 digit hex numbers, eg FF0011, not: \"\n+              + colorString\n+              + \", \"\n+              + nfe.getMessage(),\n+          nfe);\n+    }\n+  }\n+\n+  /** Returns a randomly generated color. */\n+  public Color randomColor() {", "originalCommit": "ef2dd987d4e498e037884cf16fc44e8339912494", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMwNzEwMw==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488307103", "bodyText": "It was used, then I thought it made sense to keep the colors \"sticky\" so that games would be consistent. At a library/API level, I wouldn't want someone to use the randomColor(long randomSeed) API unless that is really what they wanted. I'm concerned someone would see that and either send a random seed because they had to or not use this API. My hope is that if you have a no-arg API, that would fit what you need. I don't think this is enough code to quite fit YAGNI given the library context, so I'm leaning we clean it up later if it's not used after a few months.", "author": "DanVanAtta", "createdAt": "2020-09-15T00:15:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMTg3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMwNzI3Mw==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488307273", "bodyText": "In what sense is the name misleading, I'm not quite sure I see that. Could you help me understand that perspective?", "author": "DanVanAtta", "createdAt": "2020-09-15T00:16:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMTg3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0MDI2NQ==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488340265", "bodyText": "If I read \"random\" I expect a random result i.e. the result differs every time.\nI think you can't tell that this method always returns the same arbitrary color from the name and javadoc.", "author": "RoiEXLab", "createdAt": "2020-09-15T02:12:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMTg3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0MjQ1Nw==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488342457", "bodyText": "Ah, but be careful, the sequence of results will be the same if you restart the game, but that sequence will be random. If for example you request random colors in a different order for player names, the result would depend on the ordering of player names.\nThe other API is deterministic by player name because we use the player name hashcode for the random seed which will give us a fixed sequence for that player name (and we only grab the first element from that sequence).\nIs it still your opinion that the method name should change or be clarified?", "author": "DanVanAtta", "createdAt": "2020-09-15T02:20:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMTg3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0Mzg5OA==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488343898", "bodyText": "I could be missing something, but right now this method has \"123\" hardcoded as the seed, so if it were ever to be called the color would always be the exact same", "author": "RoiEXLab", "createdAt": "2020-09-15T02:25:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMTg3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM1OTE2Mg==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488359162", "bodyText": "Ah yeah, it would be exactly the same every time, that's a bug : )\nI was thinking that the random generator would be new'ed up once rather than each time.", "author": "DanVanAtta", "createdAt": "2020-09-15T03:21:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMTg3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM1OTQ4Ng==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488359486", "bodyText": "Removed in: dc9d6b0", "author": "DanVanAtta", "createdAt": "2020-09-15T03:22:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMTg3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMjAxMw==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488032013", "bodyText": "That's a really good idea \ud83d\udc4d", "author": "RoiEXLab", "createdAt": "2020-09-14T15:38:47Z", "path": "java-extras/src/main/java/org/triplea/java/ColorUtils.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.triplea.java;\n+\n+import com.google.common.base.Preconditions;\n+import java.awt.Color;\n+import java.util.Random;\n+import lombok.experimental.UtilityClass;\n+\n+@UtilityClass\n+public class ColorUtils {\n+  /**\n+   * Returns a color parsed from the provided input hex string.\n+   *\n+   * @param colorString EG: 00FF00, FF00FF, 000000\n+   */\n+  public Color fromHexString(final String colorString) {\n+    Preconditions.checkArgument(\n+        colorString.length() == 6,\n+        \"Colors must be 6 digit hex numbers, eg FF0011, not: \" + colorString);\n+    try {\n+      return new Color(Integer.decode(\"0x\" + colorString));\n+    } catch (final NumberFormatException nfe) {\n+      throw new IllegalArgumentException(\n+          \"Colors must be 6 digit hex numbers, eg FF0011, not: \"\n+              + colorString\n+              + \", \"\n+              + nfe.getMessage(),\n+          nfe);\n+    }\n+  }\n+\n+  /** Returns a randomly generated color. */\n+  public Color randomColor() {\n+    return randomColor(123L);\n+  }\n+\n+  /** Returns a randomly generated color using a fixed random seed. */\n+  public Color randomColor(final long randomSeed) {\n+    final Random random = new Random(randomSeed);\n+    return Color.getHSBColor(random.nextFloat(), random.nextFloat(), random.nextFloat());\n+  }", "originalCommit": "ef2dd987d4e498e037884cf16fc44e8339912494", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMwNzQzMw==", "url": "https://github.com/triplea-game/triplea/pull/7637#discussion_r488307433", "bodyText": "Thanks \ud83d\ude04", "author": "DanVanAtta", "createdAt": "2020-09-15T00:16:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMjAxMw=="}], "type": "inlineReview"}, {"oid": "dc9d6b0d9bef7a8f342894c4e9509bc4d389f0ba", "url": "https://github.com/triplea-game/triplea/commit/dc9d6b0d9bef7a8f342894c4e9509bc4d389f0ba", "message": "Remove unused (and buggy) ColorUtils#randomColor", "committedDate": "2020-09-15T03:22:26Z", "type": "commit"}]}