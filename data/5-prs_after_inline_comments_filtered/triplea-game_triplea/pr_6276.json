{"pr_number": 6276, "pr_title": "Casualty selector breakup", "pr_createdAt": "2020-04-17T08:06:36Z", "pr_url": "https://github.com/triplea-game/triplea/pull/6276", "timeline": [{"oid": "47822592cf92e4f48052ef696530663a4b2f91a1", "url": "https://github.com/triplea-game/triplea/commit/47822592cf92e4f48052ef696530663a4b2f91a1", "message": "Break up CasualtySelector.java, isolate functionalities (notably AA)", "committedDate": "2020-04-17T03:52:00Z", "type": "commit"}, {"oid": "0d7edf1f9847c83cd9677f1b5bca49924612da79", "url": "https://github.com/triplea-game/triplea/commit/0d7edf1f9847c83cd9677f1b5bca49924612da79", "message": "Move OrderOfLoss sorting to its own class", "committedDate": "2020-04-17T04:39:22Z", "type": "commit"}, {"oid": "067601e1d50d2e1c96d6216cdc37fb77bf8f653b", "url": "https://github.com/triplea-game/triplea/commit/067601e1d50d2e1c96d6216cdc37fb77bf8f653b", "message": "Simplify, inline constant value parameter", "committedDate": "2020-04-17T04:40:14Z", "type": "commit"}, {"oid": "6144be3addcb8f054a4cc430c83771034fcb1570", "url": "https://github.com/triplea-game/triplea/commit/6144be3addcb8f054a4cc430c83771034fcb1570", "message": "Introduce parameter object for OOL sorting", "committedDate": "2020-04-17T04:45:42Z", "type": "commit"}, {"oid": "bb85c6e0bb11b6dcbfeefdedcc5edc06c6bb5e0d", "url": "https://github.com/triplea-game/triplea/commit/bb85c6e0bb11b6dcbfeefdedcc5edc06c6bb5e0d", "message": "Use empty collection instead of nullable collection.", "committedDate": "2020-04-17T05:02:35Z", "type": "commit"}, {"oid": "04c1112d6da394804c40745233589e1a17f4a2b4", "url": "https://github.com/triplea-game/triplea/commit/04c1112d6da394804c40745233589e1a17f4a2b4", "message": "Add utility factory method to IntegerMap", "committedDate": "2020-04-17T08:01:20Z", "type": "commit"}, {"oid": "a6997d3ea38cab386aca4bdb9ba91baa81fb301b", "url": "https://github.com/triplea-game/triplea/commit/a6997d3ea38cab386aca4bdb9ba91baa81fb301b", "message": "Mark casualty selector classes as utility classes", "committedDate": "2020-04-17T08:01:56Z", "type": "commit"}, {"oid": "e43af27e84ff9ffa9f7b661adecd3323642ad457", "url": "https://github.com/triplea-game/triplea/commit/e43af27e84ff9ffa9f7b661adecd3323642ad457", "message": "Update method reference (fix) in test class", "committedDate": "2020-04-17T08:02:35Z", "type": "commit"}, {"oid": "f8254944a2030777ad7f36f3d1b8255c7b293644", "url": "https://github.com/triplea-game/triplea/commit/f8254944a2030777ad7f36f3d1b8255c7b293644", "message": "Add additional test cases for casualty selector, bring in new Napoleonic_Empires test xml", "committedDate": "2020-04-17T08:02:40Z", "type": "commit"}, {"oid": "d52db4428ff1ba659d66dddd51f2851ccca23cd8", "url": "https://github.com/triplea-game/triplea/commit/d52db4428ff1ba659d66dddd51f2851ccca23cd8", "message": "Remove stray comment", "committedDate": "2020-04-17T08:07:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE5NzY2Nw==", "url": "https://github.com/triplea-game/triplea/pull/6276#discussion_r410197667", "bodyText": "I'm seeing this code snippet an odd amount of times.\nThoughts about extracting this to a helper method?", "author": "RoiEXLab", "createdAt": "2020-04-17T12:45:28Z", "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/casualty/CasualtyOrderOfLosses.java", "diffHunk": "@@ -276,13 +297,13 @@ static void clearOolCache() {\n       }\n       amphibHashCode *= 31;\n       key =\n-          player.getName()\n+          parameters.player.getName()\n               + \"|\"\n-              + battlesite.getName()\n+              + parameters.battlesite.getName()\n               + \"|\"\n-              + defending\n+              + parameters.defending\n               + \"|\"\n-              + amphibious\n+              + parameters.amphibious\n               + \"|\"\n               + targetsHashCode\n               + \"|\"", "originalCommit": "6144be3addcb8f054a4cc430c83771034fcb1570", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUxNTE4Mw==", "url": "https://github.com/triplea-game/triplea/pull/6276#discussion_r410515183", "bodyText": "There are more areas of copy / paste than this too, code climate does a pretty decent job pointing them out.\nThis update is just preliminary, intentionally not modifying too much of the existing code yet. It needs to be done iteratively. I'm hoping as well that this hashing function can be removed as part of one those iterations.", "author": "DanVanAtta", "createdAt": "2020-04-17T23:35:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE5NzY2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE5OTE0MQ==", "url": "https://github.com/triplea-game/triplea/pull/6276#discussion_r410199141", "bodyText": "What is this method for and why isn't the constructor enough?", "author": "RoiEXLab", "createdAt": "2020-04-17T12:48:16Z", "path": "java-extras/src/main/java/org/triplea/java/collections/IntegerMap.java", "diffHunk": "@@ -30,6 +30,10 @@ public IntegerMap(final IntegerMap<T> integerMap) {\n     this(integerMap.mapValues);\n   }\n \n+  public static <X> IntegerMap<X> of(final Map<X, Integer> map) {\n+    return new IntegerMap<>(map);\n+  }\n+", "originalCommit": "04c1112d6da394804c40745233589e1a17f4a2b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUxNTYxMA==", "url": "https://github.com/triplea-game/triplea/pull/6276#discussion_r410515610", "bodyText": "Convenience and avoids the diamond notation:\neg:\nnew IntegerMap<>(Map.of(...));\n\nvs:\nIntegerMap.of(Map.of(...))\n\nGuava does that type of think all over the place, type inference in java is much smarter about static calls than it is about new\nUltimately I think IntegerMap is possibly a pre-Java 1.5 artifact from before there were even generics, we should consider replacing IntegerMap with Map<T, Integer>.", "author": "DanVanAtta", "createdAt": "2020-04-17T23:37:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE5OTE0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY2NDQyNw==", "url": "https://github.com/triplea-game/triplea/pull/6276#discussion_r410664427", "bodyText": "@DanVanAtta I should've clarified:\nI don't think I've seen this method being used inside of this PR.\nSo I suspect it's unused", "author": "RoiEXLab", "createdAt": "2020-04-18T07:52:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE5OTE0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY2NDk3NQ==", "url": "https://github.com/triplea-game/triplea/pull/6276#discussion_r410664975", "bodyText": "FWIW - test cases make use of it:\nhttps://github.com/triplea-game/triplea/pull/6276/files#diff-98b2c58d739b161b3aa5cc607fe5b6baR42", "author": "DanVanAtta", "createdAt": "2020-04-18T07:58:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE5OTE0MQ=="}], "type": "inlineReview"}]}