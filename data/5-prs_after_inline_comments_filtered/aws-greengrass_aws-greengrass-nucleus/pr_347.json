{"pr_number": 347, "pr_title": "Fix benchmark", "pr_createdAt": "2020-08-03T20:22:26Z", "pr_url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/347", "timeline": [{"oid": "6d4793561ec88fb83c117ca91cc84cd365a4d0a9", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6d4793561ec88fb83c117ca91cc84cd365a4d0a9", "message": "Fix benchmark", "committedDate": "2020-08-03T20:37:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjIwOA==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/347#discussion_r464702208", "bodyText": "Does this hide TES's issue with SDKClientException?", "author": "leaf94", "createdAt": "2020-08-03T22:50:34Z", "path": "src/main/java/com/aws/iot/evergreen/tes/LazyCredentialProvider.java", "diffHunk": "@@ -24,19 +26,28 @@ public LazyCredentialProvider(Context context) {\n         this.context = context;\n     }\n \n+    @SuppressWarnings(\"PMD.AvoidCatchingThrowable\")\n     @Override\n     public AwsCredentials resolveCredentials() {\n-        return context.get(TokenExchangeService.class).resolveCredentials();\n+        try {\n+            return context.get(TokenExchangeService.class).resolveCredentials();\n+        } catch (Throwable t) {\n+            throw SdkClientException.create(\"Failed to fetch credentials\", t);\n+        }", "originalCommit": "6d4793561ec88fb83c117ca91cc84cd365a4d0a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjk1OA==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/347#discussion_r464702958", "bodyText": "No, it still results in an exception being logged, except that it is an exception that we handle better", "author": "MikeDombo", "createdAt": "2020-08-03T22:52:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjIwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDczNDcxNw==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/347#discussion_r464734717", "bodyText": "I mean why we are converting all possible throwable from context.get(TokenExchangeService.class).resolveCredentials() to SdkClientException?", "author": "leaf94", "createdAt": "2020-08-04T00:41:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjIwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDczNjk4NQ==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/347#discussion_r464736985", "bodyText": "Because there are several different errors that can cause the credentials to not be resolved, so we want them all to be handled as a failure of the credential provider. This is really why: https://github.com/aws/aws-greengrass-kernel/blob/708b5de9daf62f941429a6131523aaae3c448380/src/main/java/com/aws/iot/evergreen/packagemanager/GreengrassPackageServiceHelper.java#L83", "author": "MikeDombo", "createdAt": "2020-08-04T00:51:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjIwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTIwMTIwNQ==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/347#discussion_r465201205", "bodyText": "Oh I see. That part also has a TODO on it's own... I feel we may want to differentiate btw a TES error (programming bug) vs a Credential not found error at certain point.", "author": "leaf94", "createdAt": "2020-08-04T17:08:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjIwOA=="}], "type": "inlineReview"}, {"oid": "460679373339aa991ab224af2240a6e72d574857", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/460679373339aa991ab224af2240a6e72d574857", "message": "Fix benchmark", "committedDate": "2020-08-04T03:14:28Z", "type": "forcePushed"}, {"oid": "30f98940f00876c51fa2cf28cd96c394bdcc7c9a", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/30f98940f00876c51fa2cf28cd96c394bdcc7c9a", "message": "Fix benchmark", "committedDate": "2020-08-04T05:55:36Z", "type": "commit"}, {"oid": "30f98940f00876c51fa2cf28cd96c394bdcc7c9a", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/30f98940f00876c51fa2cf28cd96c394bdcc7c9a", "message": "Fix benchmark", "committedDate": "2020-08-04T05:55:36Z", "type": "forcePushed"}]}