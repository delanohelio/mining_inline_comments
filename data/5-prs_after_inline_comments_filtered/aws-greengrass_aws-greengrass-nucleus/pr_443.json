{"pr_number": 443, "pr_title": "Updating IPCUtils to wait for multiple services to run", "pr_createdAt": "2020-09-16T19:44:40Z", "pr_url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/443", "timeline": [{"oid": "2032ea8c66f055651ac19fffc83857c69a2789df", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2032ea8c66f055651ac19fffc83857c69a2789df", "message": "Updating IPCUtils to wait for multiple services to run", "committedDate": "2020-09-16T19:47:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc0NDY0MQ==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/443#discussion_r489744641", "bodyText": "nit: break; afterwards?", "author": "hui-yang", "createdAt": "2020-09-16T20:47:31Z", "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCTestUtils.java", "diffHunk": "@@ -38,15 +38,19 @@ public static KernelIPCClientConfig getIPCConfigForService(String serviceName, K\n                         .getOnce())).build();\n     }\n \n-    public static Kernel prepareKernelFromConfigFile(String configFile, String serviceName, Class testClass) throws InterruptedException {\n+    public static Kernel prepareKernelFromConfigFile(String configFile, Class testClass, String... serviceNames) throws InterruptedException {\n         Kernel kernel = new Kernel();\n         kernel.parseArgs(\"-i\", testClass.getResource(configFile).toString());\n \n         // ensure awaitIpcServiceLatch starts\n-        CountDownLatch awaitIpcServiceLatch = new CountDownLatch(1);\n+        CountDownLatch awaitIpcServiceLatch = new CountDownLatch(serviceNames.length);\n         kernel.getContext().addGlobalStateChangeListener((service, oldState, newState) -> {\n-            if (service.getName().equals(serviceName) && newState.equals(State.RUNNING)) {\n-                awaitIpcServiceLatch.countDown();\n+            if (serviceNames != null && serviceNames.length != 0) {\n+                for (String serviceName:serviceNames) {\n+                    if (service.getName().equals(serviceName) && newState.equals(State.RUNNING)) {\n+                        awaitIpcServiceLatch.countDown();", "originalCommit": "2032ea8c66f055651ac19fffc83857c69a2789df", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8ff397158622cee010cd6631adbaa8a12a242216", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8ff397158622cee010cd6631adbaa8a12a242216", "message": "Updating IPCUtils to wait for multiple services to run. Updating IPCCliTests", "committedDate": "2020-09-16T22:09:13Z", "type": "commit"}, {"oid": "8ff397158622cee010cd6631adbaa8a12a242216", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8ff397158622cee010cd6631adbaa8a12a242216", "message": "Updating IPCUtils to wait for multiple services to run. Updating IPCCliTests", "committedDate": "2020-09-16T22:09:13Z", "type": "forcePushed"}]}