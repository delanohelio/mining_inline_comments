{"pr_number": 4463, "pr_title": "[JENKINS 60920] header breadcrumbs CSS update", "pr_createdAt": "2020-01-30T15:46:45Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4463", "timeline": [{"oid": "925e713a1b2239c21b809fb22841ed5acf6e05f8", "url": "https://github.com/jenkinsci/jenkins/commit/925e713a1b2239c21b809fb22841ed5acf6e05f8", "message": "Created new styles for the page header\n\n- Used the material icons svg sprites to deliver the icons\n- Icons are rendered using a <svg> tag", "committedDate": "2020-01-30T14:21:32Z", "type": "commit"}, {"oid": "6868cfffe73e5cdecd137edb2ed468e9b9708d4b", "url": "https://github.com/jenkinsci/jenkins/commit/6868cfffe73e5cdecd137edb2ed468e9b9708d4b", "message": "New styles for breadcrumbs and warnings monitor", "committedDate": "2020-01-30T14:21:32Z", "type": "commit"}, {"oid": "9d1fb59c547da21de23da4cca00bc1ee7af27b0b", "url": "https://github.com/jenkinsci/jenkins/commit/9d1fb59c547da21de23da4cca00bc1ee7af27b0b", "message": "Adds the svgxuse polyfill for svg sprites on IE 11", "committedDate": "2020-01-30T14:21:32Z", "type": "commit"}, {"oid": "7c40d96812d75db4b66a286b25a354cdf74b9ca7", "url": "https://github.com/jenkinsci/jenkins/commit/7c40d96812d75db4b66a286b25a354cdf74b9ca7", "message": "Create new base styles file and undo changes to the layout-common and style css files", "committedDate": "2020-01-30T14:28:45Z", "type": "commit"}, {"oid": "9441dc45c2473d41e16beb4aa196fde75533b140", "url": "https://github.com/jenkinsci/jenkins/commit/9441dc45c2473d41e16beb4aa196fde75533b140", "message": "Fixes and refactor for the new UI CSS code", "committedDate": "2020-01-30T14:28:49Z", "type": "commit"}, {"oid": "fcccd45074c123df34d9dae0916926932514b702", "url": "https://github.com/jenkinsci/jenkins/commit/fcccd45074c123df34d9dae0916926932514b702", "message": "Make the new header color and logo section opt-in\n\n- The new UI can be toggled with the -Dui.enableNewUi=true flag", "committedDate": "2020-01-30T14:28:49Z", "type": "commit"}, {"oid": "97bd6ffc9ff9204fb62bfb37a9ca0d9f7a094074", "url": "https://github.com/jenkinsci/jenkins/commit/97bd6ffc9ff9204fb62bfb37a9ca0d9f7a094074", "message": "Rename and refactor the page-header css\n\n- Rename the css class namespace from .main-header to .page-header\n- Page header CSS moved into a modules folder and now included on the new-base-styles.css. This is done to avoid loading a separate file everytime.\n- Extracted color variables to their own file", "committedDate": "2020-01-30T14:28:54Z", "type": "commit"}, {"oid": "090636b8507a397a3945daaddadc4c62144c1ae6", "url": "https://github.com/jenkinsci/jenkins/commit/090636b8507a397a3945daaddadc4c62144c1ae6", "message": "Updated localization for header and admin monitor\n\n- The pageHeader template receives localization strings as props\n- Missing translation for the admin monitor on the it, bg and pl locales", "committedDate": "2020-01-30T14:28:54Z", "type": "commit"}, {"oid": "a4856ff559687757a7d4a8b5dc9095e9d2f2a034", "url": "https://github.com/jenkinsci/jenkins/commit/a4856ff559687757a7d4a8b5dc9095e9d2f2a034", "message": "Update core/src/main/resources/lib/layout/layout.jelly\n\nCo-Authored-By: Tim Jacomb <t.jacomb@kainos.com>", "committedDate": "2020-02-03T15:53:16Z", "type": "commit"}, {"oid": "3fd2181412ebc565d3d3511390d124c089c25abb", "url": "https://github.com/jenkinsci/jenkins/commit/3fd2181412ebc565d3d3511390d124c089c25abb", "message": "Most measurements migrated to REMs", "committedDate": "2020-02-03T15:53:35Z", "type": "commit"}, {"oid": "8b1410cd0c6455b2d243de4713097757db081876", "url": "https://github.com/jenkinsci/jenkins/commit/8b1410cd0c6455b2d243de4713097757db081876", "message": "Code cleanup and apply new-ui toggle to the html.jelly file", "committedDate": "2020-02-03T16:24:58Z", "type": "commit"}, {"oid": "fa95c469a9792a5da9407d59b130dee764269260", "url": "https://github.com/jenkinsci/jenkins/commit/fa95c469a9792a5da9407d59b130dee764269260", "message": "Breadcrumb fixes\n\n- Reverts breadcrumb link styling to use nested selectors instead of the .breadcrumbs__link class. The reason is that several plugins would break.\n- Shifted margins so that breadcrumbs can be fullwidth in the absence of the auto refresh link", "committedDate": "2020-02-03T16:37:58Z", "type": "commit"}, {"oid": "be0860cb63994012acdb3fea989b7257792a9e42", "url": "https://github.com/jenkinsci/jenkins/commit/be0860cb63994012acdb3fea989b7257792a9e42", "message": "Implemented some fixes from the feedback received\n\n- Removed box shadow webkit prefix\n- Fixed formatting on the breadcrumbs.css and layout-commons.less files\n- Renamed the new UI toggle class from _new-ui_ to _ui-refresh_\n- Renamed references to the _new ui_ to _v2_", "committedDate": "2020-02-04T15:20:09Z", "type": "commit"}, {"oid": "7751b3489bb533db92cba577cc9175bece45b41b", "url": "https://github.com/jenkinsci/jenkins/commit/7751b3489bb533db92cba577cc9175bece45b41b", "message": "Created jelly helper to use svg icons", "committedDate": "2020-02-04T16:47:57Z", "type": "commit"}, {"oid": "42c93716b939f64227c2bb1abb09d0b8237d3722", "url": "https://github.com/jenkinsci/jenkins/commit/42c93716b939f64227c2bb1abb09d0b8237d3722", "message": "Fix: restore proper icon for the user on the header", "committedDate": "2020-02-04T17:04:16Z", "type": "commit"}, {"oid": "10a77e6ebff9f949ad305a3394d3df8853d9c34f", "url": "https://github.com/jenkinsci/jenkins/commit/10a77e6ebff9f949ad305a3394d3df8853d9c34f", "message": "Fixes for Edge, IE 11 and IE 10", "committedDate": "2020-02-05T11:05:41Z", "type": "commit"}, {"oid": "6e31a40cdc8431bfbf19f7fca811ddcf25f95ac3", "url": "https://github.com/jenkinsci/jenkins/commit/6e31a40cdc8431bfbf19f7fca811ddcf25f95ac3", "message": "Improvements on the header and breadcrumbs\n\n- Logo v2 changed and optimized using the svgo frontend https://jakearchibald.github.io/svgomg/\n- Refactored the ammonitor insertion code\n- Breadcrumbs are no longer capitalized\n- Classic logo link no longer stretches past the images\n- Fixed classic logo link on IE11\n- Updated color of the footer\n- Menu items background is also changed when hovering over the menu selector\n- Removed copyright notice on top of some files", "committedDate": "2020-02-06T14:46:51Z", "type": "commit"}, {"oid": "0a1a835472f099da96381b67957f5749da5d697e", "url": "https://github.com/jenkinsci/jenkins/commit/0a1a835472f099da96381b67957f5749da5d697e", "message": "Bumped JTH version with the SVG download fix", "committedDate": "2020-02-10T15:14:27Z", "type": "commit"}, {"oid": "58b04d2cb07048127a847435a024c017473bba23", "url": "https://github.com/jenkinsci/jenkins/commit/58b04d2cb07048127a847435a024c017473bba23", "message": "Update test/pom.xml\n\nCo-Authored-By: Tim Jacomb <t.jacomb@kainos.com>", "committedDate": "2020-02-12T16:07:41Z", "type": "commit"}, {"oid": "a1e45d3b429b038766397ac8557d09aaf66f7448", "url": "https://github.com/jenkinsci/jenkins/commit/a1e45d3b429b038766397ac8557d09aaf66f7448", "message": "Added a function to check boolean system properties from jelly", "committedDate": "2020-02-12T17:48:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQxNjAwMw==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r378416003", "bodyText": "Not sure about the name. Opinions?", "author": "fqueiruga", "createdAt": "2020-02-12T17:55:22Z", "path": "core/src/main/java/hudson/Functions.java", "diffHunk": "@@ -493,6 +493,16 @@ public static String getSystemProperty(String key) {\n         return SystemProperties.getString(key);\n     }\n \n+    /**\n+     * Gets the boolean system property indicated by the specific key.\n+     * \n+     * Delegates to {@link SystemProperties#getBoolean(java.lang.String)}\n+     */\n+    @Restricted(DoNotUse.class)\n+    public static boolean isSystemPropertyEnabled(String key) {", "originalCommit": "a1e45d3b429b038766397ac8557d09aaf66f7448", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQyMjYyNg==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r378422626", "bodyText": "sounds fine to me", "author": "timja", "createdAt": "2020-02-12T18:08:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQxNjAwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDczOTEzNA==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r380739134", "bodyText": "Doesn't really matter for private API.", "author": "daniel-beck", "createdAt": "2020-02-18T15:19:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQxNjAwMw=="}], "type": "inlineReview"}, {"oid": "b55389da5cafecc8ca7e588bf8dbb5d4eb77be89", "url": "https://github.com/jenkinsci/jenkins/commit/b55389da5cafecc8ca7e588bf8dbb5d4eb77be89", "message": "Fix header links and add svg styles for legacy layout", "committedDate": "2020-02-17T08:33:46Z", "type": "commit"}, {"oid": "fc1a10f595eef7ff8f109f8ea1f2d74e720a62c7", "url": "https://github.com/jenkinsci/jenkins/commit/fc1a10f595eef7ff8f109f8ea1f2d74e720a62c7", "message": " Some bug fixing for the new header\n\n- The ui-refresh changes were not properly being enabled with the boolean system property. Added explicit true check on the jelly templates.\n- Added an explicit width for the ui-refresh logo because it would mess with the layout", "committedDate": "2020-02-17T14:59:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDczODQ5MQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r380738491", "bodyText": "Oleg in #4463 (review):\n\nAlso keep in mind that SystemProperties API is rather designed for system properties which values are calculated once on restart. It involves calls like ServletContext checks, and I would not guarantee that it returns results immediately in all cases. Be careful when using the live switch in the frontend. If it is really needed, maybe using a private static boolean cache is preferable\n\nThis method does not address the concern expressed there.", "author": "daniel-beck", "createdAt": "2020-02-18T15:18:44Z", "path": "core/src/main/java/hudson/Functions.java", "diffHunk": "@@ -493,6 +493,16 @@ public static String getSystemProperty(String key) {\n         return SystemProperties.getString(key);\n     }\n \n+    /**\n+     * Gets the boolean system property indicated by the specific key.\n+     * \n+     * Delegates to {@link SystemProperties#getBoolean(java.lang.String)}\n+     */\n+    @Restricted(DoNotUse.class)\n+    public static boolean isSystemPropertyEnabled(String key) {\n+        return SystemProperties.getBoolean(key);", "originalCommit": "fc1a10f595eef7ff8f109f8ea1f2d74e720a62c7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc0MTUyMg==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r380741522", "bodyText": "This was done to address the concern that it was a boolean property. We understand this approach is not optimal for doing live switches. Of course, we will choose a technique that addresses these concerns once we start working on a UI-based toggle.", "author": "fqueiruga", "createdAt": "2020-02-18T15:23:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDczODQ5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc5ODkzNg==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r380798936", "bodyText": "Resolving this one, feel free to reopen it if you think it deserves further discussion", "author": "fqueiruga", "createdAt": "2020-02-18T16:47:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDczODQ5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDk2NjIzMQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r380966231", "bodyText": "@fqueiruga My point is that the toggle should be implemented via\n@Restricted(NoExternalUse.class)\npublic static /* non-final */ boolean UI_REFRESH = SystemProperties.getBoolean(\"jenkins.ui.refresh\");\n// and optionally a getter for it if accessing code can be made nicer\n\nThis way, you're not evaluating the potentially expensive operation on every page render but only once on startup, while retaining the ability to edit it at runtime (by setting the static var).", "author": "daniel-beck", "createdAt": "2020-02-18T22:11:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDczODQ5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE5MjI3Ng==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r381192276", "bodyText": "I understand now. If it's not a blocker I'd rather follow up on this on a future PR rather than change this again, as it's a risky one. Feel free to reopen this convo again if you think it's necessary.", "author": "fqueiruga", "createdAt": "2020-02-19T10:06:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDczODQ5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTI0MzkzOA==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r381243938", "bodyText": "@fqueiruga Addressed in 205fa3a\n(For which I got Felix's approval out of band)", "author": "daniel-beck", "createdAt": "2020-02-19T11:51:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDczODQ5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ2NTcyNA==", "url": "https://github.com/jenkinsci/jenkins/pull/4463#discussion_r379465724", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Delegates to {@link SystemProperties#getBoolean(java.lang.String)}\n          \n          \n            \n                 * Delegates to {@link SystemProperties#getBoolean(java.lang.String)}\n          \n          \n            \n                 *\n          \n          \n            \n                 * @since TODO", "author": "alecharp", "createdAt": "2020-02-14T14:41:55Z", "path": "core/src/main/java/hudson/Functions.java", "diffHunk": "@@ -493,6 +493,16 @@ public static String getSystemProperty(String key) {\n         return SystemProperties.getString(key);\n     }\n \n+    /**\n+     * Gets the boolean system property indicated by the specific key.\n+     * \n+     * Delegates to {@link SystemProperties#getBoolean(java.lang.String)}", "originalCommit": "a1e45d3b429b038766397ac8557d09aaf66f7448", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2d5420cf288fb895e9d56ac604c8ad98a1b331ab", "url": "https://github.com/jenkinsci/jenkins/commit/2d5420cf288fb895e9d56ac604c8ad98a1b331ab", "message": "Update core/src/main/java/hudson/Functions.java\n\nCo-Authored-By: Adrien Lecharpentier <adrien.lecharpentier@gmail.com>", "committedDate": "2020-02-18T17:43:25Z", "type": "commit"}, {"oid": "205fa3a7590439f63e8059fcee086614386f7b2e", "url": "https://github.com/jenkinsci/jenkins/commit/205fa3a7590439f63e8059fcee086614386f7b2e", "message": "Do not check the system property on every page render", "committedDate": "2020-02-19T11:44:06Z", "type": "commit"}]}