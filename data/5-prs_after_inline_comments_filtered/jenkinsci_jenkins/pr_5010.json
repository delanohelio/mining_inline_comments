{"pr_number": 5010, "pr_title": "[JENKINS-35452] A step towards removing more 'slave' terminology.", "pr_createdAt": "2020-10-16T22:12:39Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/5010", "timeline": [{"oid": "27a71f981bb6e82d5524547a51cf255cf25dffae", "url": "https://github.com/jenkinsci/jenkins/commit/27a71f981bb6e82d5524547a51cf255cf25dffae", "message": "A step towards removing more 'slave' terminology.\n\nOverload the mechanisms for obtaining the jenkins-agent.jnlp (formerly slave-agent.jnlp) file for launching inbound TCP agents.\nServe the file at either of the two locations.\nChange the UI (etc.) documentation to reference the correct term / file.", "committedDate": "2020-10-16T21:48:17Z", "type": "commit"}, {"oid": "fd06a653973bda3df1a2eeee5690af63523d72dd", "url": "https://github.com/jenkinsci/jenkins/commit/fd06a653973bda3df1a2eeee5690af63523d72dd", "message": "Convert test to correct terminology.", "committedDate": "2020-10-16T22:11:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc1NjcyNg==", "url": "https://github.com/jenkinsci/jenkins/pull/5010#discussion_r506756726", "bodyText": "https://github.com/search?q=org%3Ajenkinsci+%22slave-agent.jnlp%22&type=code looks like we could get away with just renaming the existing file instead of duplicating it.\nIf we need to keep the old file for some reason, would just have that st:include the new one if possible to cut down duplication.", "author": "daniel-beck", "createdAt": "2020-10-16T23:05:45Z", "path": "core/src/main/java/hudson/Functions.java", "diffHunk": "@@ -1874,7 +1874,7 @@ public static String toEmailSafeString(String projectName) {\n     /**\n      * Obtains the host name of the Hudson server that clients can use to talk back to.\n      * <p>\n-     * This is primarily used in {@code slave-agent.jnlp.jelly} to specify the destination\n+     * This is primarily used in {@code jenkins-agent.jnlp.jelly} to specify the destination", "originalCommit": "fd06a653973bda3df1a2eeee5690af63523d72dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc1OTE0NA==", "url": "https://github.com/jenkinsci/jenkins/pull/5010#discussion_r506759144", "bodyText": "Thanks for catching that. It was supposed to be removed but while I was getting things working it crept back in. Removing ....", "author": "jeffret-b", "createdAt": "2020-10-16T23:16:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc1NjcyNg=="}], "type": "inlineReview"}, {"oid": "70797bf48d67845fb388c0e045a67a63ed69d26e", "url": "https://github.com/jenkinsci/jenkins/commit/70797bf48d67845fb388c0e045a67a63ed69d26e", "message": "Remove old file.", "committedDate": "2020-10-16T23:17:13Z", "type": "commit"}, {"oid": "e0990b4b6c03210b344318015787d8cde645cb6a", "url": "https://github.com/jenkinsci/jenkins/commit/e0990b4b6c03210b344318015787d8cde645cb6a", "message": "Add tests for downloading JNLP file at new and obsoleted names.", "committedDate": "2020-10-19T20:47:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTkzODE4Ng==", "url": "https://github.com/jenkinsci/jenkins/pull/5010#discussion_r511938186", "bodyText": "Unnecessary code duplication as @WebMethod takes a list of names.\nIf this is the future preferable API for this (even if unseen), should mark the old one @deprecated.\nAlso missing @since or @Restricted.", "author": "daniel-beck", "createdAt": "2020-10-26T12:56:32Z", "path": "core/src/main/java/hudson/slaves/SlaveComputer.java", "diffHunk": "@@ -814,13 +814,23 @@ public void tryReconnect() {\n \n     @WebMethod(name=\"slave-agent.jnlp\")\n     public HttpResponse doSlaveAgentJnlp(StaplerRequest req, StaplerResponse res) {\n-        return new EncryptedSlaveAgentJnlpFile(this, \"slave-agent.jnlp.jelly\", getName(), CONNECT);\n+        return doJenkinsAgentJnlp(req, res);\n+    }\n+\n+    @WebMethod(name=\"jenkins-agent.jnlp\")\n+    public HttpResponse doJenkinsAgentJnlp(StaplerRequest req, StaplerResponse res) {", "originalCommit": "e0990b4b6c03210b344318015787d8cde645cb6a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTkzODI0Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/5010#discussion_r511938242", "bodyText": "As above.", "author": "daniel-beck", "createdAt": "2020-10-26T12:56:37Z", "path": "core/src/main/java/hudson/slaves/SlaveComputer.java", "diffHunk": "@@ -814,13 +814,23 @@ public void tryReconnect() {\n \n     @WebMethod(name=\"slave-agent.jnlp\")\n     public HttpResponse doSlaveAgentJnlp(StaplerRequest req, StaplerResponse res) {\n-        return new EncryptedSlaveAgentJnlpFile(this, \"slave-agent.jnlp.jelly\", getName(), CONNECT);\n+        return doJenkinsAgentJnlp(req, res);\n+    }\n+\n+    @WebMethod(name=\"jenkins-agent.jnlp\")\n+    public HttpResponse doJenkinsAgentJnlp(StaplerRequest req, StaplerResponse res) {\n+        return new EncryptedSlaveAgentJnlpFile(this, \"jenkins-agent.jnlp.jelly\", getName(), CONNECT);\n     }\n \n     class LowPermissionResponse {\n+        @WebMethod(name=\"jenkins-agent.jnlp\")\n+        public HttpResponse doJenkinsAgentJnlp(StaplerRequest req, StaplerResponse res) {", "originalCommit": "e0990b4b6c03210b344318015787d8cde645cb6a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}