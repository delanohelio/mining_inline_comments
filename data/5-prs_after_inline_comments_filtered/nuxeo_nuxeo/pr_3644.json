{"pr_number": 3644, "pr_title": "fix-NXP-28433-multi-complex-nullifying", "pr_createdAt": "2020-01-03T14:27:37Z", "pr_url": "https://github.com/nuxeo/nuxeo/pull/3644", "timeline": [{"oid": "7d9aa434b8728d7b6ef6a064621d0e1262b9e333", "url": "https://github.com/nuxeo/nuxeo/commit/7d9aa434b8728d7b6ef6a064621d0e1262b9e333", "message": "NXP-28433: Cleanup / Format", "committedDate": "2020-01-02T12:04:31Z", "type": "commit"}, {"oid": "af9578745bea905448b61b88cbaa899f9ba9818e", "url": "https://github.com/nuxeo/nuxeo/commit/af9578745bea905448b61b88cbaa899f9ba9818e", "message": "NXP-28433: Fix multi complex nullifying through REST", "committedDate": "2020-01-02T14:39:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzI1Mzg4NA==", "url": "https://github.com/nuxeo/nuxeo/pull/3644#discussion_r363253884", "bodyText": "Why not making it a facade that would call the specific setValue implementation rather than doing nothing ?", "author": "NourNuxeo", "createdAt": "2020-01-06T11:19:12Z", "path": "nuxeo-core/nuxeo-core-api/src/main/java/org/nuxeo/ecm/core/api/model/impl/ListProperty.java", "diffHunk": "@@ -48,22 +48,21 @@\n      */\n     protected final Field field;\n \n-    protected final List<Property> children;\n+    protected final List<Property> children = new ArrayList<>();\n \n     public ListProperty(Property parent, Field field) {\n         super(parent);\n         this.field = field;\n-        children = new ArrayList<>();\n     }\n \n     public ListProperty(Property parent, Field field, int flags) {\n         super(parent, flags);\n         this.field = field;\n-        children = new ArrayList<>();\n     }\n \n     @Override\n     public void internalSetValue(Serializable value) throws PropertyException {\n+        // ListProperty uses a specific setValue implementation", "originalCommit": "7d9aa434b8728d7b6ef6a064621d0e1262b9e333", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzY2MzkwNw==", "url": "https://github.com/nuxeo/nuxeo/pull/3644#discussion_r363663907", "bodyText": "I'm not changing the way it works here, I'm just adding a comment explaining why this method is empty.\nFurthermore, on the generic implementation, setValue calls internalSetValue so the opposite is not expected.", "author": "kevinleturc", "createdAt": "2020-01-07T09:39:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzI1Mzg4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzI1NzE0MA==", "url": "https://github.com/nuxeo/nuxeo/pull/3644#discussion_r363257140", "bodyText": "Since you are cleaning here, why not typing with   since it's used as such next line ?", "author": "NourNuxeo", "createdAt": "2020-01-06T11:30:10Z", "path": "nuxeo-core/nuxeo-core-api/src/main/java/org/nuxeo/ecm/core/api/model/impl/ListProperty.java", "diffHunk": "@@ -201,8 +198,7 @@ public Serializable getValueForWrite() throws PropertyException {\n         if (children.isEmpty()) {\n             return new ArrayList<String>();\n         }\n-        // noinspection CollectionDeclaredAsConcreteClass\n-        ArrayList<Object> list = new ArrayList<>(children.size());\n+        var list = new ArrayList<>(children.size());", "originalCommit": "7d9aa434b8728d7b6ef6a064621d0e1262b9e333", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzY2NjczOA==", "url": "https://github.com/nuxeo/nuxeo/pull/3644#discussion_r363666738", "bodyText": "Because it's not needed, we never read this list again, we are only interested on its Serializable aspect.", "author": "kevinleturc", "createdAt": "2020-01-07T09:46:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzI1NzE0MA=="}], "type": "inlineReview"}]}