{"pr_number": 7571, "pr_title": "Add internal pipeline structure api with suggestions", "pr_createdAt": "2020-01-10T11:17:15Z", "pr_url": "https://github.com/gocd/gocd/pull/7571", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTcxODMzMA==", "url": "https://github.com/gocd/gocd/pull/7571#discussion_r365718330", "bodyText": "should we also verifyContentType?", "author": "bdpiprava", "createdAt": "2020-01-13T09:58:01Z", "path": "api/api-internal-pipeline-structure-v1/src/main/java/com/thoughtworks/go/apiv1/internalpipelinestructure/InternalPipelineStructureControllerV1.java", "diffHunk": "@@ -61,31 +64,47 @@ public InternalPipelineStructureControllerV1(ApiAuthenticationHelper apiAuthenti\n                 .put(\"view\", () -> templateConfigService.templateConfigsThatCanBeViewedBy(currentUsername()))\n                 .put(\"administer\", () -> templateConfigService.templateConfigsThatCanBeEditedBy(currentUsername()))\n                 .build();\n+        this.userService = userService;\n     }\n \n     @Override\n     public String controllerBasePath() {\n-        return Routes.InternalPipelineStructure.BASE;\n+        return InternalPipelineStructure.BASE;\n     }\n \n     @Override\n     public void setupRoutes() {\n         path(controllerBasePath(), () -> {\n-            // uncomment the line below to set the content type on the base path\n             before(\"\", mimeType, this::setContentType);\n-            // uncomment the line below to set the content type on nested routes\n             before(\"/*\", mimeType, this::setContentType);\n \n-            // uncomment for the `index` action\n+            before(\"\", mimeType, this.apiAuthenticationHelper::checkUserAnd403);", "originalCommit": "cdce19818e842a7283c3a70498d0ed3572aa203c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4c436f6211626e3569cc850db09433b26c8214ce", "url": "https://github.com/gocd/gocd/commit/4c436f6211626e3569cc850db09433b26c8214ce", "message": "Add internal pipeline structure api with suggestions\n\n - added method and necessary routes", "committedDate": "2020-01-13T10:29:45Z", "type": "commit"}, {"oid": "68ef735f3da3ef088b31478e31c49ff819902290", "url": "https://github.com/gocd/gocd/commit/68ef735f3da3ef088b31478e31c49ff819902290", "message": "Updated the pipelines spa to use the internal api to fetch the accessible grps and envs along with suggestions", "committedDate": "2020-01-13T10:29:45Z", "type": "commit"}, {"oid": "c8e9baee54344c8f7b70c20a000e70c1d958a4aa", "url": "https://github.com/gocd/gocd/commit/c8e9baee54344c8f7b70c20a000e70c1d958a4aa", "message": "Wrapping up roles and users inside a suggestions object for better api to body mapping. Updated the spa fr the same.", "committedDate": "2020-01-13T10:29:46Z", "type": "commit"}, {"oid": "c8e9baee54344c8f7b70c20a000e70c1d958a4aa", "url": "https://github.com/gocd/gocd/commit/c8e9baee54344c8f7b70c20a000e70c1d958a4aa", "message": "Wrapping up roles and users inside a suggestions object for better api to body mapping. Updated the spa fr the same.", "committedDate": "2020-01-13T10:29:46Z", "type": "forcePushed"}]}