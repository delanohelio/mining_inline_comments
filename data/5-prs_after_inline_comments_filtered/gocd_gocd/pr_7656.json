{"pr_number": 7656, "pr_title": "Pipeline Grp Admin should receive a 403 on create if group doesnot exist", "pr_createdAt": "2020-01-24T05:26:32Z", "pr_url": "https://github.com/gocd/gocd/pull/7656", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDQ5MjU4OA==", "url": "https://github.com/gocd/gocd/pull/7656#discussion_r370492588", "bodyText": "indent?\nMay be extract into a variable?", "author": "GaneshSPatil", "createdAt": "2020-01-24T06:46:46Z", "path": "spark/spark-base/src/main/java/com/thoughtworks/go/spark/spring/AbstractAuthenticationHelper.java", "diffHunk": "@@ -181,7 +181,8 @@ public void checkPipelineCreationAuthorizationAnd403(Request request, Response r\n             throw new UnprocessableEntityException(\"Pipeline group must be specified for creating a pipeline.\");\n         } else {\n             String groupName = group.getAsString();\n-            if (StringUtils.isNotBlank(groupName) && !securityService.isUserAdminOfGroup(currentUsername(), groupName)) {\n+            if (StringUtils.isNotBlank(groupName) &&\n+                    (!goConfigService.groups().hasGroup(groupName) || !securityService.isUserAdminOfGroup(currentUsername(), groupName))) {", "originalCommit": "649c6e0ec0e167934891e45cdf9fb45065912d83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "20494e867af6d4ca8b97d52dc2649e0e6f1acc8a", "url": "https://github.com/gocd/gocd/commit/20494e867af6d4ca8b97d52dc2649e0e6f1acc8a", "message": "Pipeline Grp Admin should receive a 403 on create if group doesnot exist\n\n - the before filter on create pipeline config api - checks whether or not the current user is an admin of the given group (if user is not a system admin) - which throws RecordNotFoundException if the group does not exist.\n  Updated the check to include the group existence test before admin check", "committedDate": "2020-01-28T06:03:12Z", "type": "commit"}, {"oid": "20494e867af6d4ca8b97d52dc2649e0e6f1acc8a", "url": "https://github.com/gocd/gocd/commit/20494e867af6d4ca8b97d52dc2649e0e6f1acc8a", "message": "Pipeline Grp Admin should receive a 403 on create if group doesnot exist\n\n - the before filter on create pipeline config api - checks whether or not the current user is an admin of the given group (if user is not a system admin) - which throws RecordNotFoundException if the group does not exist.\n  Updated the check to include the group existence test before admin check", "committedDate": "2020-01-28T06:03:12Z", "type": "forcePushed"}]}