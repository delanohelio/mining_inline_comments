{"pr_number": 783, "pr_title": "Added More API's in MsalCPPoAuth2Cache", "pr_createdAt": "2020-01-17T02:22:51Z", "pr_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/783", "timeline": [{"oid": "112589da822c0c31f7f483146a64ad56ee135ba8", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/112589da822c0c31f7f483146a64ad56ee135ba8", "message": "Updates", "committedDate": "2019-12-16T18:16:04Z", "type": "commit"}, {"oid": "d7368cbffcc7bc3ea081e5e830beafb7eec69d56", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/d7368cbffcc7bc3ea081e5e830beafb7eec69d56", "message": "Merge commit '61ce5113cae09876a7dee4d6ceb4bdcbeb45fee3' into shoatman/androidSetup", "committedDate": "2020-01-14T00:31:21Z", "type": "commit"}, {"oid": "ad668512f048ea8cd07e2724eaaf89ed58919fef", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/ad668512f048ea8cd07e2724eaaf89ed58919fef", "message": "Merge commit 'd35bf0f78c0ba74bb673ff6d7eb573aecb0eb7cf' into kreedula/storage-implementation", "committedDate": "2020-01-15T19:00:36Z", "type": "commit"}, {"oid": "100bfc0ff3e86f12af829dcccba9dd5e8f2678e5", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/100bfc0ff3e86f12af829dcccba9dd5e8f2678e5", "message": "New API's in MsalCppCache", "committedDate": "2020-01-17T01:22:16Z", "type": "commit"}, {"oid": "0674b86c81e6c6b62f5f7d4b82674f0a34a6941a", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/0674b86c81e6c6b62f5f7d4b82674f0a34a6941a", "message": "Formatting updates", "committedDate": "2020-01-17T01:50:58Z", "type": "commit"}, {"oid": "edd36ab9c9a58c1d6c57b273306e76c150ab9775", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/edd36ab9c9a58c1d6c57b273306e76c150ab9775", "message": "Merge branch 'dev' into kreedula/more-storage-apis", "committedDate": "2020-01-17T04:05:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzc2MTAzMQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/783#discussion_r367761031", "bodyText": "is this intentional? (name not matching with method name)", "author": "rpdome", "createdAt": "2020-01-17T04:07:14Z", "path": "common/src/main/java/com/microsoft/identity/common/internal/cache/MsalOAuth2TokenCache.java", "diffHunk": "@@ -862,7 +862,7 @@ private void setToCacheRecord(@NonNull final CacheRecord target,\n     @Override\n     public List<AccountRecord> getAccounts(@Nullable final String environment,\n                                            @NonNull final String clientId) {\n-        final String methodName = \":getAccounts\";\n+        final String methodName = \":getAllAccounts\";", "originalCommit": "edd36ab9c9a58c1d6c57b273306e76c150ab9775", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODExODk4Nw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/783#discussion_r368118987", "bodyText": "good catch, Android Studio auto-rename might have refactored this, fixed", "author": "kreedula", "createdAt": "2020-01-17T20:18:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzc2MTAzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzc2MTM5MA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/783#discussion_r367761390", "bodyText": "nit: do we need validateNonNull here?", "author": "rpdome", "createdAt": "2020-01-17T04:09:36Z", "path": "common/src/main/java/com/microsoft/identity/common/internal/cache/MsalCppOAuth2TokenCache.java", "diffHunk": "@@ -148,4 +126,93 @@ public synchronized void saveCredentials(@NonNull final AccountRecord accountRec\n         saveCredentialsInternal(credentials);\n     }\n \n+    /**\n+     * API to save {@link AccountRecord}\n+     *\n+     * @param accountRecord : accountRecord to be saved.\n+     */\n+    public synchronized void saveAccountRecord(@NonNull AccountRecord accountRecord) {\n+        getAccountCredentialCache().saveAccount(accountRecord);\n+\n+    }\n+\n+    /**\n+     * API to clear all cache.\n+     * Note: This method is intended to be only used for testing purposes.\n+     */\n+    public synchronized void clearCache() {\n+        getAccountCredentialCache().clearAll();\n+    }\n+\n+    /**\n+     * Method to remove Account matched with homeAccountId, environment and realm\n+     *\n+     * @param homeAccountId : HomeAccountId of the Account\n+     * @param environment   : Environment of the Account\n+     * @param realm         : Realm of the Account\n+     * @return {@link AccountDeletionRecord}\n+     */\n+    public synchronized AccountDeletionRecord removeAccount(@NonNull final String homeAccountId,\n+                                                            @NonNull final String environment,\n+                                                            @NonNull final String realm) {\n+        final List<Credential> credentials = getAccountCredentialCache().getCredentialsFilteredBy(", "originalCommit": "edd36ab9c9a58c1d6c57b273306e76c150ab9775", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODExODU4NQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/783#discussion_r368118585", "bodyText": "done", "author": "kreedula", "createdAt": "2020-01-17T20:17:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzc2MTM5MA=="}], "type": "inlineReview"}, {"oid": "8b0927f522c91bfbdb66a292f0fe030e95820d66", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/8b0927f522c91bfbdb66a292f0fe030e95820d66", "message": "Update ApiCallback.java\n\nUpdating to remove Status code name changes", "committedDate": "2020-01-17T19:37:00Z", "type": "commit"}, {"oid": "a03ebc4ac84e532d628002f0e3045fc2cf4667fb", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a03ebc4ac84e532d628002f0e3045fc2cf4667fb", "message": "Removed un intentional method name change", "committedDate": "2020-01-17T19:38:21Z", "type": "commit"}, {"oid": "ff41b1c599c016e6c03b054eb771d5a4507d5211", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/ff41b1c599c016e6c03b054eb771d5a4507d5211", "message": "Errorstatus -> Status changes", "committedDate": "2020-01-17T19:39:10Z", "type": "commit"}, {"oid": "83b6db18f310019afc16bf18860bd06f3b38822f", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/83b6db18f310019afc16bf18860bd06f3b38822f", "message": "Errorstatus -> Status changes", "committedDate": "2020-01-17T19:40:28Z", "type": "commit"}, {"oid": "4512a109cd0bfe48a4cee910deb2670654775093", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/4512a109cd0bfe48a4cee910deb2670654775093", "message": "Merge commit 'c121594bb89e853f9e873bfe048360e68e875120' into kreedula/storage-implementation", "committedDate": "2020-01-17T19:54:05Z", "type": "commit"}, {"oid": "9ccd44f52430f502d46b644b3696fb485414ac1c", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/9ccd44f52430f502d46b644b3696fb485414ac1c", "message": "Addressing comments", "committedDate": "2020-01-17T20:14:03Z", "type": "commit"}, {"oid": "1f1429b38e0f2fec508bfeab94651c0db1daa5da", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/1f1429b38e0f2fec508bfeab94651c0db1daa5da", "message": "Addressing comments", "committedDate": "2020-01-17T20:23:09Z", "type": "commit"}, {"oid": "7f3ea605aea5ecf610922ed49f47c37f3d868693", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/7f3ea605aea5ecf610922ed49f47c37f3d868693", "message": "Change to Status", "committedDate": "2020-01-17T20:27:34Z", "type": "commit"}, {"oid": "c5c2db1167e1e22abd53080a4ad6fc6743d6770c", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/c5c2db1167e1e22abd53080a4ad6fc6743d6770c", "message": "Change to status", "committedDate": "2020-01-17T20:28:16Z", "type": "commit"}, {"oid": "0c84668b64966905824dedc98c662fc1d3387e17", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/0c84668b64966905824dedc98c662fc1d3387e17", "message": "Change to status", "committedDate": "2020-01-17T20:28:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODE3ODMyMQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/783#discussion_r368178321", "bodyText": "Minor formatting weirdness here", "author": "iambmelt", "createdAt": "2020-01-17T23:35:26Z", "path": "common/src/main/java/com/microsoft/identity/common/internal/cache/MsalCppOAuth2TokenCache.java", "diffHunk": "@@ -148,4 +126,95 @@ public synchronized void saveCredentials(@NonNull final AccountRecord accountRec\n         saveCredentialsInternal(credentials);\n     }\n \n+    /**\n+     * API to save {@link AccountRecord}\n+     *\n+     * @param accountRecord : accountRecord to be saved.\n+     */\n+    public synchronized void saveAccountRecord(@NonNull AccountRecord accountRecord) {\n+        getAccountCredentialCache().saveAccount(accountRecord);\n+\n+    }\n+\n+    /**\n+     * API to clear all cache.\n+     * Note: This method is intended to be only used for testing purposes.\n+     */\n+    public synchronized void clearCache() {\n+        getAccountCredentialCache().clearAll();\n+    }\n+\n+    /**\n+     * Method to remove Account matched with homeAccountId, environment and realm\n+     *\n+     * @param homeAccountId : HomeAccountId of the Account\n+     * @param environment   : Environment of the Account\n+     * @param realm         : Realm of the Account\n+     * @return {@link AccountDeletionRecord}\n+     */\n+    public synchronized AccountDeletionRecord removeAccount(@NonNull final String homeAccountId,\n+                                                            @Nullable final String environment,\n+                                                            @NonNull final String realm) throws ClientException {\n+        validateNonNull(homeAccountId, \"homeAccountId\");\n+        validateNonNull(realm, \"realm\");\n+        final List<Credential> credentials = getAccountCredentialCache().getCredentialsFilteredBy(\n+                homeAccountId,\n+                environment,\n+                CredentialType.RefreshToken,\n+                null, realm,", "originalCommit": "0c84668b64966905824dedc98c662fc1d3387e17", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b2589fce35be9fc03f556c44c2b20bc91154f213", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/b2589fce35be9fc03f556c44c2b20bc91154f213", "message": "Formatting fix", "committedDate": "2020-01-18T00:28:41Z", "type": "commit"}]}