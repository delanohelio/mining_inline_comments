{"pr_number": 3103, "pr_title": "Updates build to JDK 14 and addresses latest errorprone warnings", "pr_createdAt": "2020-06-03T08:01:38Z", "pr_url": "https://github.com/openzipkin/zipkin/pull/3103", "timeline": [{"oid": "4b4eeca6771ccaf74dd204524739967a79719daf", "url": "https://github.com/openzipkin/zipkin/commit/4b4eeca6771ccaf74dd204524739967a79719daf", "message": "Updates build to JDK 14 and addresses latest errorprone warnings", "committedDate": "2020-06-03T08:01:07Z", "type": "commit"}, {"oid": "1f805db87ffa8faf244a61c8ad5442cbb6505916", "url": "https://github.com/openzipkin/zipkin/commit/1f805db87ffa8faf244a61c8ad5442cbb6505916", "message": "license", "committedDate": "2020-06-03T08:07:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwNTM0NA==", "url": "https://github.com/openzipkin/zipkin/pull/3103#discussion_r434405344", "bodyText": "This is fine too though I think // Ignore in the catch block is fine too and probably what this check is intending, just making sure you didn't accidentally forget", "author": "anuraaga", "createdAt": "2020-06-03T08:42:40Z", "path": "zipkin-collector/activemq/src/main/java/zipkin2/collector/activemq/LazyInit.java", "diffHunk": "@@ -58,6 +58,7 @@ void close() {\n     if (maybe != null) result.close();\n   }\n \n+  @SuppressWarnings(\"EmptyCatch\")", "originalCommit": "1f805db87ffa8faf244a61c8ad5442cbb6505916", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQxNjkyMw==", "url": "https://github.com/openzipkin/zipkin/pull/3103#discussion_r434416923", "bodyText": "yeah generally I am just trying to get the hugely annoying errorprone messages to go away one way or another. if an empty comment or // ignore works that works for me.", "author": "codefromthecrypt", "createdAt": "2020-06-03T09:01:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwNTM0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwNjA3MQ==", "url": "https://github.com/openzipkin/zipkin/pull/3103#discussion_r434406071", "bodyText": "Guess you might have added this for the same check but consider a comment instead", "author": "anuraaga", "createdAt": "2020-06-03T08:43:52Z", "path": "zipkin-collector/rabbitmq/src/main/java/zipkin2/collector/rabbitmq/RabbitMQCollector.java", "diffHunk": "@@ -257,12 +257,13 @@ public void handleDelivery(String tag, Envelope envelope, BasicProperties props,\n     for (int i = 0; i < addresses.size(); i++) {\n       String[] splitAddress = addresses.get(i).split(\":\", 100);\n       String host = splitAddress[0];\n-      Integer port = null;\n+      int port = -1;\n       try {\n         if (splitAddress.length == 2) port = Integer.parseInt(splitAddress[1]);\n       } catch (NumberFormatException ignore) {\n+        port = 0;", "originalCommit": "1f805db87ffa8faf244a61c8ad5442cbb6505916", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwNzQyNA==", "url": "https://github.com/openzipkin/zipkin/pull/3103#discussion_r434407424", "bodyText": "Ah too bad this annoying pre-Java8 check is still around", "author": "anuraaga", "createdAt": "2020-06-03T08:46:06Z", "path": "zipkin-server/src/main/java/zipkin2/server/internal/health/ZipkinHealthController.java", "diffHunk": "@@ -48,6 +48,7 @@\n     return health(ctx, MediaType.JSON_UTF_8);\n   }\n \n+  @SuppressWarnings(\"FutureReturnValueIgnored\")", "originalCommit": "1f805db87ffa8faf244a61c8ad5442cbb6505916", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwNzkzOQ==", "url": "https://github.com/openzipkin/zipkin/pull/3103#discussion_r434407939", "bodyText": "Accidental box?", "author": "anuraaga", "createdAt": "2020-06-03T08:47:04Z", "path": "zipkin-storage/cassandra-v1/src/main/java/zipkin2/storage/cassandra/v1/CassandraUtil.java", "diffHunk": "@@ -142,4 +144,13 @@ public String toString() {\n       return \"SortTraceIdsByDescTimestamp\";\n     }\n   }\n+\n+  @SuppressWarnings(\"JdkObsolete\")\n+  static List<Date> getDays(long endTs, @Nullable Long lookback) {\n+    List<Date> result = new ArrayList<>();\n+    for (Long epochMillis : DateUtil.epochDays(endTs, lookback)) {", "originalCommit": "1f805db87ffa8faf244a61c8ad5442cbb6505916", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ0MjcwNw==", "url": "https://github.com/openzipkin/zipkin/pull/3103#discussion_r434442707", "bodyText": "well it is a List but sure no prob making it eagerly unboxed.", "author": "codefromthecrypt", "createdAt": "2020-06-03T09:43:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwNzkzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwOTAyOA==", "url": "https://github.com/openzipkin/zipkin/pull/3103#discussion_r434409028", "bodyText": "On phone so can't expand this file to see below but if it's duping the next line, commet instead is fine", "author": "anuraaga", "createdAt": "2020-06-03T08:48:56Z", "path": "zipkin-storage/elasticsearch/src/main/java/zipkin2/elasticsearch/ElasticsearchVersion.java", "diffHunk": "@@ -39,6 +39,8 @@ float get(HttpCall.Factory callFactory) throws IOException {\n     try {\n       if (enterPath(parser, \"version\", \"number\") != null) version = parser.getText();\n     } catch (RuntimeException | IOException possiblyParseException) {\n+      throw new IllegalArgumentException(", "originalCommit": "1f805db87ffa8faf244a61c8ad5442cbb6505916", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1d046a9f1594e8f53fe0be8d05cd258e1d930b6d", "url": "https://github.com/openzipkin/zipkin/commit/1d046a9f1594e8f53fe0be8d05cd258e1d930b6d", "message": "comment for EmptyCatch and eager unbox", "committedDate": "2020-06-03T09:44:56Z", "type": "commit"}]}