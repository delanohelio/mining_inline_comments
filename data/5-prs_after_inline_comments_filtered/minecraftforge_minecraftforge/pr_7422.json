{"pr_number": 7422, "pr_title": "Fix a few FluidUtil issues that were causing DispenseFluidContainer to not function properly", "pr_createdAt": "2020-10-18T19:33:34Z", "pr_url": "https://github.com/MinecraftForge/MinecraftForge/pull/7422", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzIwMzQ5NQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7422#discussion_r507203495", "bodyText": "I moved this handling from IFluidBlock (as it is not the proper handling for an IFluidBlock) to here in an else branch, but I am unsure if this branch should not just be removed instead as querying a tile for its fluid handler doesn't seem like it has to do with getting a fluid from in world.", "author": "pupnewfster", "createdAt": "2020-10-18T19:34:50Z", "path": "src/main/java/net/minecraftforge/fluids/FluidUtil.java", "diffHunk": "@@ -481,20 +488,29 @@ public static FluidActionResult tryPickUpFluid(@Nonnull ItemStack emptyContainer\n \n         BlockState state = worldIn.getBlockState(pos);\n         Block block = state.getBlock();\n-\n+        IFluidHandler targetFluidHandler;\n         if (block instanceof IFluidBlock)\n         {\n-            IFluidHandler targetFluidHandler = getFluidHandler(worldIn, pos, side).orElse(null);\n-            if (targetFluidHandler != null)\n+            targetFluidHandler = new FluidBlockWrapper((IFluidBlock) block, worldIn, pos);\n+        }\n+        else if (block instanceof IBucketPickupHandler)\n+        {\n+            targetFluidHandler = new BucketPickupHandlerWrapper((IBucketPickupHandler) block, worldIn, pos);\n+        }\n+        else\n+        {\n+            Optional<IFluidHandler> fluidHandler = getFluidHandler(worldIn, pos, side).resolve();\n+            if (!fluidHandler.isPresent())\n             {\n-                return tryFillContainer(emptyContainer, targetFluidHandler, Integer.MAX_VALUE, playerIn, true);\n+                return FluidActionResult.FAILURE;\n             }\n+            targetFluidHandler = fluidHandler.get();", "originalCommit": "c5eba911b9ab43c697fafa72908a83ab9bd19c20", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a1569479085213c4004a5126f99a31335b92cfb9", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/a1569479085213c4004a5126f99a31335b92cfb9", "message": "Rebase", "committedDate": "2020-10-29T00:45:36Z", "type": "forcePushed"}, {"oid": "682cbe37aa83835b922e044b82f3ed88d994a0fe", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/682cbe37aa83835b922e044b82f3ed88d994a0fe", "message": "Fix a few FluidUtil issues that were causing DispenseFluidContainer to not function properly", "committedDate": "2020-11-24T17:35:29Z", "type": "commit"}, {"oid": "0bc7547aabcbd485e06bff27f54ee113f674a600", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/0bc7547aabcbd485e06bff27f54ee113f674a600", "message": "Rebase", "committedDate": "2020-11-24T17:35:29Z", "type": "commit"}, {"oid": "0bc7547aabcbd485e06bff27f54ee113f674a600", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/0bc7547aabcbd485e06bff27f54ee113f674a600", "message": "Rebase", "committedDate": "2020-11-24T17:35:29Z", "type": "forcePushed"}]}