{"pr_number": 6416, "pr_title": "[1.15.x] Added entity nameplate rendering event hook", "pr_createdAt": "2020-01-06T22:12:48Z", "pr_url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416", "timeline": [{"oid": "0f2a54c102a24420fd48dde819e768d346942d51", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/0f2a54c102a24420fd48dde819e768d346942d51", "message": "- Added entity nameplate rendering event hook", "committedDate": "2020-01-05T14:44:32Z", "type": "commit"}, {"oid": "2cebe9d2e73a47af3a52a6129a02ac19b0af3811", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2cebe9d2e73a47af3a52a6129a02ac19b0af3811", "message": "- Added entity nameplate rendering event hook", "committedDate": "2020-01-06T22:09:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUwOTE1Mg==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r363509152", "bodyText": "Should be originalContent.", "author": "diesieben07", "createdAt": "2020-01-06T22:15:43Z", "path": "src/main/java/net/minecraftforge/client/event/RenderNameplateEvent.java", "diffHunk": "@@ -0,0 +1,67 @@\n+package net.minecraftforge.client.event;\n+\n+import com.google.common.base.Strings;\n+import net.minecraft.entity.Entity;\n+import net.minecraftforge.common.MinecraftForge;\n+import net.minecraftforge.eventbus.api.Event;\n+\n+/**\n+ * RenderNameplateEvent is fired whenever the entity renderer attempts to render a name plate/tag of an entity.\n+ * <br>\n+ * {@link #entity} contains the entity in which the plate is being rendered to. This cannot be changed by mods.<br>\n+ * {@link #nameplateContent} contains the content being rendered on the name plate/tag. This can be changed by mods.<br>\n+ * {@link #originalContent} contains the original content being rendered on the name plate/tag. This cannot be changed by mods.<br>\n+ * <br>\n+ * This event {@link HasResult}. <br>\n+ * This event has a result. ALLOW will force-render name plate/tag, & DENY will prevent name plate/tag from rendering<br>\n+ * <br>\n+ * This event is fired on the {@link MinecraftForge#EVENT_BUS}.\n+ **/\n+@Event.HasResult\n+public class RenderNameplateEvent extends Event\n+{\n+\n+    private final Entity entity;\n+    private String nameplateContent;\n+    private final String originalContent;\n+\n+    public RenderNameplateEvent(Entity entity, String content)\n+    {\n+        this.entity = entity;\n+        this.setContent(content);\n+        this.originalContent = Strings.nullToEmpty(content);\n+    }\n+\n+    /**\n+     * The entity in which the name plate/tag is being rendered to\n+     */\n+    public Entity getEntity()\n+    {\n+        return this.entity;\n+    }\n+\n+    /**\n+     * Sets the content that is to be rendered on the name plate/tag\n+     */\n+    public void setContent(String contents)\n+    {\n+        this.nameplateContent = Strings.nullToEmpty(contents);\n+    }\n+\n+    /**\n+     * The content being rendered on the name plate/tag\n+     */\n+    public String getContent()\n+    {\n+        return this.nameplateContent;\n+    }\n+\n+    /**\n+     * The original content being rendered on the name plate/tag\n+     */\n+    public String getOriginalContent()\n+    {\n+        return this.nameplateContent;", "originalCommit": "2cebe9d2e73a47af3a52a6129a02ac19b0af3811", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxNDQzMQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r363514431", "bodyText": "Now fixed. Thanks", "author": "LeScooter", "createdAt": "2020-01-06T22:30:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUwOTE1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUwOTM1OQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r363509359", "bodyText": "And what about DEFAULT?", "author": "diesieben07", "createdAt": "2020-01-06T22:16:15Z", "path": "src/main/java/net/minecraftforge/client/event/RenderNameplateEvent.java", "diffHunk": "@@ -0,0 +1,67 @@\n+package net.minecraftforge.client.event;\n+\n+import com.google.common.base.Strings;\n+import net.minecraft.entity.Entity;\n+import net.minecraftforge.common.MinecraftForge;\n+import net.minecraftforge.eventbus.api.Event;\n+\n+/**\n+ * RenderNameplateEvent is fired whenever the entity renderer attempts to render a name plate/tag of an entity.\n+ * <br>\n+ * {@link #entity} contains the entity in which the plate is being rendered to. This cannot be changed by mods.<br>\n+ * {@link #nameplateContent} contains the content being rendered on the name plate/tag. This can be changed by mods.<br>\n+ * {@link #originalContent} contains the original content being rendered on the name plate/tag. This cannot be changed by mods.<br>\n+ * <br>\n+ * This event {@link HasResult}. <br>\n+ * This event has a result. ALLOW will force-render name plate/tag, & DENY will prevent name plate/tag from rendering<br>", "originalCommit": "2cebe9d2e73a47af3a52a6129a02ac19b0af3811", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxNDYzNw==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r363514637", "bodyText": "Now added DEFAULT use to class doc", "author": "LeScooter", "createdAt": "2020-01-06T22:31:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUwOTM1OQ=="}], "type": "inlineReview"}, {"oid": "3279987ed591ea38b80dfafe9ef30943fba9469c", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/3279987ed591ea38b80dfafe9ef30943fba9469c", "message": "- Updated RenderNameplateEvent.java doc\n- Fixed getOriginalContent() not returning original content\n- Replaced .equals() with == operator", "committedDate": "2020-01-06T22:29:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxNTQ1NQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r363515455", "bodyText": "Why are we silently converting null to empty?", "author": "diesieben07", "createdAt": "2020-01-06T22:33:57Z", "path": "src/main/java/net/minecraftforge/client/event/RenderNameplateEvent.java", "diffHunk": "@@ -0,0 +1,68 @@\n+package net.minecraftforge.client.event;\n+\n+import com.google.common.base.Strings;\n+import net.minecraft.entity.Entity;\n+import net.minecraftforge.common.MinecraftForge;\n+import net.minecraftforge.eventbus.api.Event;\n+\n+/**\n+ * RenderNameplateEvent is fired whenever the entity renderer attempts to render a name plate/tag of an entity.\n+ * <br>\n+ * {@link #entity} contains the entity in which the plate is being rendered to. This cannot be changed by mods.<br>\n+ * {@link #nameplateContent} contains the content being rendered on the name plate/tag. This can be changed by mods.<br>\n+ * {@link #originalContent} contains the original content being rendered on the name plate/tag. This cannot be changed by mods.<br>\n+ * <br>\n+ * This event {@link HasResult}. <br>\n+ * This event has a result. ALLOW will force-render name plate/tag, DEFAULT will ignore the hook and continue using the vanilla check\n+ * & DENY will prevent name plate/tag from rendering<br>\n+ * <br>\n+ * This event is fired on the {@link MinecraftForge#EVENT_BUS}.\n+ **/\n+@Event.HasResult\n+public class RenderNameplateEvent extends Event\n+{\n+\n+    private final Entity entity;\n+    private String nameplateContent;\n+    private final String originalContent;\n+\n+    public RenderNameplateEvent(Entity entity, String content)\n+    {\n+        this.entity = entity;\n+        this.setContent(content);\n+        this.originalContent = Strings.nullToEmpty(content);", "originalCommit": "3279987ed591ea38b80dfafe9ef30943fba9469c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxNTUxMA==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r363515510", "bodyText": "Again, why nullToEmpty?", "author": "diesieben07", "createdAt": "2020-01-06T22:34:07Z", "path": "src/main/java/net/minecraftforge/client/event/RenderNameplateEvent.java", "diffHunk": "@@ -0,0 +1,68 @@\n+package net.minecraftforge.client.event;\n+\n+import com.google.common.base.Strings;\n+import net.minecraft.entity.Entity;\n+import net.minecraftforge.common.MinecraftForge;\n+import net.minecraftforge.eventbus.api.Event;\n+\n+/**\n+ * RenderNameplateEvent is fired whenever the entity renderer attempts to render a name plate/tag of an entity.\n+ * <br>\n+ * {@link #entity} contains the entity in which the plate is being rendered to. This cannot be changed by mods.<br>\n+ * {@link #nameplateContent} contains the content being rendered on the name plate/tag. This can be changed by mods.<br>\n+ * {@link #originalContent} contains the original content being rendered on the name plate/tag. This cannot be changed by mods.<br>\n+ * <br>\n+ * This event {@link HasResult}. <br>\n+ * This event has a result. ALLOW will force-render name plate/tag, DEFAULT will ignore the hook and continue using the vanilla check\n+ * & DENY will prevent name plate/tag from rendering<br>\n+ * <br>\n+ * This event is fired on the {@link MinecraftForge#EVENT_BUS}.\n+ **/\n+@Event.HasResult\n+public class RenderNameplateEvent extends Event\n+{\n+\n+    private final Entity entity;\n+    private String nameplateContent;\n+    private final String originalContent;\n+\n+    public RenderNameplateEvent(Entity entity, String content)\n+    {\n+        this.entity = entity;\n+        this.setContent(content);\n+        this.originalContent = Strings.nullToEmpty(content);\n+    }\n+\n+    /**\n+     * The entity in which the name plate/tag is being rendered to\n+     */\n+    public Entity getEntity()\n+    {\n+        return this.entity;\n+    }\n+\n+    /**\n+     * Sets the content that is to be rendered on the name plate/tag\n+     */\n+    public void setContent(String contents)\n+    {\n+        this.nameplateContent = Strings.nullToEmpty(contents);", "originalCommit": "3279987ed591ea38b80dfafe9ef30943fba9469c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxNTg0Nw==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r363515847", "bodyText": "This file doesn't follow the code formatting guidelines.", "author": "diesieben07", "createdAt": "2020-01-06T22:35:12Z", "path": "src/test/java/net/minecraftforge/debug/client/rendering/NameplateRenderingEventTest.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package net.minecraftforge.debug.client.rendering;\n+\n+import net.minecraft.entity.passive.CowEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.text.TextFormatting;\n+import net.minecraftforge.client.event.RenderNameplateEvent;\n+import net.minecraftforge.eventbus.api.Event;\n+import net.minecraftforge.eventbus.api.SubscribeEvent;\n+import net.minecraftforge.fml.common.Mod;\n+\n+@Mod(\"nameplate_render_test\")\n+@Mod.EventBusSubscriber\n+public class NameplateRenderingEventTest {\n+\n+    static final boolean ENABLED = false;\n+\n+    @SubscribeEvent\n+    public static void onNameplateRender(RenderNameplateEvent event) {\n+\n+        if(!ENABLED){\n+            return;\n+        }\n+\n+        if(event.getEntity() instanceof CowEntity) {\n+            event.setContent(TextFormatting.RED + \"Evil Cow\");\n+            event.setResult(Event.Result.ALLOW);\n+        }\n+\n+        if(event.getEntity() instanceof PlayerEntity){\n+            event.setContent(TextFormatting.GOLD + \"\" + (event.getEntity()).getDisplayName().getString());\n+        }\n+\n+    }\n+\n+}", "originalCommit": "3279987ed591ea38b80dfafe9ef30943fba9469c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "460e09ac7adfc87045455afcd57d26052e818051", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/460e09ac7adfc87045455afcd57d26052e818051", "message": "- Removed nullToEmpty\n- Fixed patch\n- Removed import from patch", "committedDate": "2020-01-06T22:49:29Z", "type": "commit"}, {"oid": "b7c4e6a6808a40062ad0255dcd1c50ca88633d92", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/b7c4e6a6808a40062ad0255dcd1c50ca88633d92", "message": "- Removed nullToEmpty\n- Fixed patch\n- removed", "committedDate": "2020-01-06T22:54:11Z", "type": "commit"}, {"oid": "56f876f1e4f5d95a747c2917ccda217d5d8b5265", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/56f876f1e4f5d95a747c2917ccda217d5d8b5265", "message": "- Removed unnecessary nullToEmpty", "committedDate": "2020-01-06T22:54:55Z", "type": "commit"}, {"oid": "f022069988b255e5a649a98303e6d47b34d152f4", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/f022069988b255e5a649a98303e6d47b34d152f4", "message": "- Fixed formatting to comply with guidelines", "committedDate": "2020-01-06T22:58:34Z", "type": "commit"}, {"oid": "da0e4c6583f89e92f36466d4c8e81234d2223537", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/da0e4c6583f89e92f36466d4c8e81234d2223537", "message": "- Fixed formatting issue in nameplate rendering event test class", "committedDate": "2020-01-06T23:00:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU0MzQxNg==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r365543416", "bodyText": "Should extend EntityEvent instead of the raw Event class", "author": "ichttt", "createdAt": "2020-01-11T21:36:28Z", "path": "src/main/java/net/minecraftforge/client/event/RenderNameplateEvent.java", "diffHunk": "@@ -0,0 +1,67 @@\n+package net.minecraftforge.client.event;\n+\n+import com.google.common.base.Strings;\n+import net.minecraft.entity.Entity;\n+import net.minecraftforge.common.MinecraftForge;\n+import net.minecraftforge.eventbus.api.Event;\n+\n+/**\n+ * RenderNameplateEvent is fired whenever the entity renderer attempts to render a name plate/tag of an entity.\n+ * <br>\n+ * {@link #entity} contains the entity in which the plate is being rendered to. This cannot be changed by mods.<br>\n+ * {@link #nameplateContent} contains the content being rendered on the name plate/tag. This can be changed by mods.<br>\n+ * {@link #originalContent} contains the original content being rendered on the name plate/tag. This cannot be changed by mods.<br>\n+ * <br>\n+ * This event {@link HasResult}. <br>\n+ * This event has a result. ALLOW will force-render name plate/tag, DEFAULT will ignore the hook and continue using the vanilla check\n+ * & DENY will prevent name plate/tag from rendering<br>\n+ * <br>\n+ * This event is fired on the {@link MinecraftForge#EVENT_BUS}.\n+ **/\n+@Event.HasResult\n+public class RenderNameplateEvent extends Event", "originalCommit": "da0e4c6583f89e92f36466d4c8e81234d2223537", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU0MzQ2NQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r365543465", "bodyText": "Not needed when extending EntityEvent", "author": "ichttt", "createdAt": "2020-01-11T21:38:07Z", "path": "src/main/java/net/minecraftforge/client/event/RenderNameplateEvent.java", "diffHunk": "@@ -0,0 +1,67 @@\n+package net.minecraftforge.client.event;\n+\n+import com.google.common.base.Strings;\n+import net.minecraft.entity.Entity;\n+import net.minecraftforge.common.MinecraftForge;\n+import net.minecraftforge.eventbus.api.Event;\n+\n+/**\n+ * RenderNameplateEvent is fired whenever the entity renderer attempts to render a name plate/tag of an entity.\n+ * <br>\n+ * {@link #entity} contains the entity in which the plate is being rendered to. This cannot be changed by mods.<br>\n+ * {@link #nameplateContent} contains the content being rendered on the name plate/tag. This can be changed by mods.<br>\n+ * {@link #originalContent} contains the original content being rendered on the name plate/tag. This cannot be changed by mods.<br>\n+ * <br>\n+ * This event {@link HasResult}. <br>\n+ * This event has a result. ALLOW will force-render name plate/tag, DEFAULT will ignore the hook and continue using the vanilla check\n+ * & DENY will prevent name plate/tag from rendering<br>\n+ * <br>\n+ * This event is fired on the {@link MinecraftForge#EVENT_BUS}.\n+ **/\n+@Event.HasResult\n+public class RenderNameplateEvent extends Event\n+{\n+\n+    private final Entity entity;\n+    private String nameplateContent;\n+    private final String originalContent;\n+\n+    public RenderNameplateEvent(Entity entity, String content)\n+    {\n+        this.entity = entity;\n+        this.originalContent = content;\n+        this.setContent(this.originalContent);\n+    }\n+\n+    /**\n+     * The entity in which the name plate/tag is being rendered to\n+     */\n+    public Entity getEntity()", "originalCommit": "da0e4c6583f89e92f36466d4c8e81234d2223537", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "23464f5c626a8b223cd7fb97677a5f8e0e07ae6d", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/23464f5c626a8b223cd7fb97677a5f8e0e07ae6d", "message": "- RenderNameplateEvent now extends EntityEvent\n- Removed unnecessary entity getter", "committedDate": "2020-01-11T22:27:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0ODU5Ng==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r367148596", "bodyText": "You should also pass in the MatrixStack and the IRenderTypeBuffer to the event, in case anyone wants to render something special on the nameplate", "author": "ichttt", "createdAt": "2020-01-15T22:49:09Z", "path": "src/main/java/net/minecraftforge/client/event/RenderNameplateEvent.java", "diffHunk": "@@ -0,0 +1,58 @@\n+package net.minecraftforge.client.event;\n+\n+import com.google.common.base.Strings;\n+import net.minecraft.entity.Entity;\n+import net.minecraftforge.common.MinecraftForge;\n+import net.minecraftforge.event.entity.EntityEvent;\n+import net.minecraftforge.eventbus.api.Event;\n+\n+/**\n+ * RenderNameplateEvent is fired whenever the entity renderer attempts to render a name plate/tag of an entity.\n+ * <br>\n+ * {@link #nameplateContent} contains the content being rendered on the name plate/tag. This can be changed by mods.<br>\n+ * {@link #originalContent} contains the original content being rendered on the name plate/tag. This cannot be changed by mods.<br>\n+ * <br>\n+ * This event has a result. {@link HasResult}. <br>\n+ * ALLOW will force-render name plate/tag, DEFAULT will ignore the hook and continue using the vanilla check\n+ * & DENY will prevent name plate/tag from rendering<br>\n+ * <br>\n+ * This event is fired on the {@link MinecraftForge#EVENT_BUS}.\n+ **/\n+@Event.HasResult\n+public class RenderNameplateEvent extends EntityEvent\n+{\n+\n+    private String nameplateContent;\n+    private final String originalContent;\n+\n+    public RenderNameplateEvent(Entity entity, String content)", "originalCommit": "23464f5c626a8b223cd7fb97677a5f8e0e07ae6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzIxODc2MQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6416#discussion_r367218761", "bodyText": "Added", "author": "LeScooter", "createdAt": "2020-01-16T03:47:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0ODU5Ng=="}], "type": "inlineReview"}, {"oid": "cd4d474103cbcea2a40505c5c067d8863d5e89f4", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/cd4d474103cbcea2a40505c5c067d8863d5e89f4", "message": "- Added MatrixStack and IRenderTypeBuffer to event", "committedDate": "2020-01-16T03:47:04Z", "type": "commit"}, {"oid": "a130a299943b1d4c55fc41968b3186537d9ba3fc", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/a130a299943b1d4c55fc41968b3186537d9ba3fc", "message": "- Removed unnecessary white space", "committedDate": "2020-01-16T03:51:59Z", "type": "commit"}]}