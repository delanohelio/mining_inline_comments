{"pr_number": 7228, "pr_title": "Improve performance and cleanup code for DelegatingResourcePack", "pr_createdAt": "2020-08-08T09:14:18Z", "pr_url": "https://github.com/MinecraftForge/MinecraftForge/pull/7228", "timeline": [{"oid": "7ff8c2fa37dbdaf66c61d21bfe5b642089c5cda2", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/7ff8c2fa37dbdaf66c61d21bfe5b642089c5cda2", "message": "Improve performance of DelegatingResourcePack and general cleanup", "committedDate": "2020-08-08T08:56:26Z", "type": "commit"}, {"oid": "c0683c7c3bfa618bd47674ea476a11bd17cae528", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/c0683c7c3bfa618bd47674ea476a11bd17cae528", "message": "Merge remote-tracking branch 'upstream/1.16.x' into delegating-resourcepack-cleanup", "committedDate": "2020-08-08T08:56:46Z", "type": "commit"}, {"oid": "40a15265e14522527535ba1b874c094e99f02726", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/40a15265e14522527535ba1b874c094e99f02726", "message": "Remove pointless comment", "committedDate": "2020-08-08T08:57:23Z", "type": "commit"}, {"oid": "291d31587214d7b3234581ed12eb2685f01f2aae", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/291d31587214d7b3234581ed12eb2685f01f2aae", "message": "Add note about volatile removal in 1.17", "committedDate": "2020-08-08T09:15:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ3MzY4Ng==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7228#discussion_r467473686", "bodyText": "Could this be changed to use namespaceAssets.keySet()/namespaceData.keyset()? IIRC ModFileResourcePack#getResourceNamespaces does file system operations, so it's relatively slow.", "author": "malte0811", "createdAt": "2020-08-08T15:08:40Z", "path": "src/main/java/net/minecraftforge/fml/packs/DelegatingResourcePack.java", "diffHunk": "@@ -84,69 +111,86 @@ public String getName()\n     @Override\n     public Collection<ResourceLocation> getAllResourceLocations(ResourcePackType type, String pathIn, String pathIn2, int maxDepth, Predicate<String> filter)\n     {\n-        synchronized(delegates)\n-        {\n-            return delegates.stream()\n-                    .flatMap(r -> r.getAllResourceLocations(type, pathIn, pathIn2, maxDepth, filter).stream())\n-                    .collect(Collectors.toList());\n-        }\n+        return delegates.stream()\n+                .flatMap(r -> r.getAllResourceLocations(type, pathIn, pathIn2, maxDepth, filter).stream())\n+                .collect(Collectors.toList());\n     }\n \n     @Override\n     public Set<String> getResourceNamespaces(ResourcePackType type)\n     {\n-        synchronized (delegates)\n-        {\n-            return delegates.stream()\n-                    .flatMap(r -> r.getResourceNamespaces(type).stream())\n-                    .collect(Collectors.toSet());\n-        }\n+        return delegates.stream()\n+                .flatMap(r -> r.getResourceNamespaces(type).stream())\n+                .collect(Collectors.toSet());", "originalCommit": "291d31587214d7b3234581ed12eb2685f01f2aae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ3Njk4NQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7228#discussion_r467476985", "bodyText": "You're right, changed that.", "author": "diesieben07", "createdAt": "2020-08-08T15:43:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ3MzY4Ng=="}], "type": "inlineReview"}, {"oid": "2b777418f013366e94de7cee2c299dd03657b648", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2b777418f013366e94de7cee2c299dd03657b648", "message": "Remove unnecessary stream in getResourceNamespaces", "committedDate": "2020-08-08T15:43:15Z", "type": "commit"}, {"oid": "7d6f95d8b03b59e8356eef3ef0bd57da1a6aa01d", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/7d6f95d8b03b59e8356eef3ef0bd57da1a6aa01d", "message": "update deprecation notes to 1.16.2", "committedDate": "2020-08-08T16:13:50Z", "type": "commit"}, {"oid": "2423574d9bb35c7ce72a4cf1c127ec151e5f5e80", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2423574d9bb35c7ce72a4cf1c127ec151e5f5e80", "message": "Merge branch '1.16.x' into delegating-resourcepack-cleanup\n\n# Conflicts:\n#\tsrc/main/java/net/minecraftforge/fml/client/ClientModLoader.java", "committedDate": "2020-08-16T10:09:35Z", "type": "commit"}, {"oid": "bcff52bf694f7470bbad2a94255cd2ebd1ec0315", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/bcff52bf694f7470bbad2a94255cd2ebd1ec0315", "message": "Update to 1.16.2", "committedDate": "2020-08-16T10:14:35Z", "type": "commit"}, {"oid": "c92f62ede83722478758418f62a48425ff1e668b", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/c92f62ede83722478758418f62a48425ff1e668b", "message": "Remove deprecated DelegatingResourcePack constructor", "committedDate": "2020-08-16T10:15:33Z", "type": "commit"}, {"oid": "7842f4322777c153cde1ed0a5230edfb68fcb7a9", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/7842f4322777c153cde1ed0a5230edfb68fcb7a9", "message": "Merge branch '1.16.x' into delegating-resourcepack-cleanup", "committedDate": "2020-08-21T17:34:58Z", "type": "commit"}, {"oid": "e9a4cde0edab596ce274a2814fa6b1de0add2c22", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/e9a4cde0edab596ce274a2814fa6b1de0add2c22", "message": "Update ModFileResourcePack.java", "committedDate": "2020-08-21T17:41:01Z", "type": "commit"}]}