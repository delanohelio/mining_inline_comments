{"pr_number": 6269, "pr_title": "Remove hook latex", "pr_createdAt": "2020-05-24T11:28:53Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/6269", "timeline": [{"oid": "8fca6de2d17b222d66c9b9d72a8d9cb342c2a4b7", "url": "https://github.com/ankidroid/Anki-Android/commit/8fca6de2d17b222d66c9b9d72a8d9cb342c2a4b7", "message": "NF: Latex munge directly called from Collection", "committedDate": "2020-05-24T11:24:12Z", "type": "forcePushed"}, {"oid": "ee40dc7fbe079121c5decdc01933dad591a48ba1", "url": "https://github.com/ankidroid/Anki-Android/commit/ee40dc7fbe079121c5decdc01933dad591a48ba1", "message": "NF: Latex munge directly called from Collection", "committedDate": "2020-05-24T11:46:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyODc1Mw==", "url": "https://github.com/ankidroid/Anki-Android/pull/6269#discussion_r429628753", "bodyText": "Is this line necessary?", "author": "david-allison-1", "createdAt": "2020-05-24T11:56:36Z", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -1057,7 +1057,9 @@ public void updateFieldCache(long[] nids) {\n             }\n             fields = (Map<String, String>) Hooks.runFilter(\"mungeFields\", fields, model, data, this);\n             String html = new Template(format, fields).render();\n-            d.put(type, (String) Hooks.runFilter(\"mungeQA\", html, type, fields, model, data, this));\n+            html = (String) Hooks.runFilter(\"mungeQA\", html, type, fields, model, data, this);", "originalCommit": "ee40dc7fbe079121c5decdc01933dad591a48ba1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyOTA3Mw==", "url": "https://github.com/ankidroid/Anki-Android/pull/6269#discussion_r429629073", "bodyText": "Ah, I see, presumably there are other filters (chess) which mungeQA still calls?", "author": "david-allison-1", "createdAt": "2020-05-24T12:00:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyODc1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyOTEyMg==", "url": "https://github.com/ankidroid/Anki-Android/pull/6269#discussion_r429629122", "bodyText": "I don't understand this question. What would you want to do instead ? Have a series of imbricated function call ?\nI could do\nd.put(type, (String) Hooks.runFilter(\"mungeQA\", LaTeX.mungeQA(html, this, model), type, fields, model, data, this));\n\nbut that would be horrible to read.\nI believe that storing the intermediate result in html is far more readable", "author": "Arthur-Milchior", "createdAt": "2020-05-24T12:01:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyODc1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYzMDIxOQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6269#discussion_r429630219", "bodyText": "Yeah. That's the kind of problem that I mentionned earlier. I can't make a clean code and remove hook if I only remove hooks one by one", "author": "Arthur-Milchior", "createdAt": "2020-05-24T12:13:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyODc1Mw=="}], "type": "inlineReview"}, {"oid": "9a9d2d5b9bbf8470d8d67f6543e24c9938c948e8", "url": "https://github.com/ankidroid/Anki-Android/commit/9a9d2d5b9bbf8470d8d67f6543e24c9938c948e8", "message": "NF: Latex munge directly called from Collection", "committedDate": "2020-06-02T05:52:03Z", "type": "commit"}, {"oid": "9a9d2d5b9bbf8470d8d67f6543e24c9938c948e8", "url": "https://github.com/ankidroid/Anki-Android/commit/9a9d2d5b9bbf8470d8d67f6543e24c9938c948e8", "message": "NF: Latex munge directly called from Collection", "committedDate": "2020-06-02T05:52:03Z", "type": "forcePushed"}]}