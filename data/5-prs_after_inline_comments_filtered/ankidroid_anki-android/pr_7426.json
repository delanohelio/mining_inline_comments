{"pr_number": 7426, "pr_title": "NoteEditor: Expand/Collapse Field Content", "pr_createdAt": "2020-10-20T01:43:10Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/7426", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUyMjM0Mw==", "url": "https://github.com/ankidroid/Anki-Android/pull/7426#discussion_r508522343", "bodyText": "is this in addition to the global animation / safe display setting?", "author": "mikehardy", "createdAt": "2020-10-20T13:51:48Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/FieldEditLine.java", "diffHunk": "@@ -111,6 +158,10 @@ public void setOrd(int i) {\n         mEditText.setOrd(i);\n     }\n \n+    public void setEnableAnimation(boolean value) {\n+        this.mEnableAnimation = value;", "originalCommit": "24971011599c979d25a600f35239615060328c60", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUzNzkwMQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/7426#discussion_r508537901", "bodyText": "This uses the global animation setting - I didn't feel a view component having a dependency on AnkiDroid's settings was a good idea, but I'm happy to change it", "author": "david-allison-1", "createdAt": "2020-10-20T14:06:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUyMjM0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY0OTY0MQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/7426#discussion_r508649641", "bodyText": "ok - so this is maintained separately but is derivative from that one? I'm okay with that - if that is correct feel free to mark resolved", "author": "mikehardy", "createdAt": "2020-10-20T16:02:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUyMjM0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUyMjU0MA==", "url": "https://github.com/ankidroid/Anki-Android/pull/7426#discussion_r508522540", "bodyText": "Activity restarts?", "author": "mikehardy", "createdAt": "2020-10-20T13:52:04Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/FieldEditLine.java", "diffHunk": "@@ -70,11 +79,49 @@ private void init() {\n         this.mEditText = findViewById(R.id.id_note_editText);\n         this.mLabel = findViewById(R.id.id_label);\n         this.mMediaButton = findViewById(R.id.id_media_button);\n+        this.mExpandButton = findViewById(R.id.id_expand_button);\n+\n+        this.mExpansionState = ExpansionState.EXPANDED;", "originalCommit": "24971011599c979d25a600f35239615060328c60", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODU3NDgwMQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/7426#discussion_r508574801", "bodyText": "You're right - I've taken a look at this and will need to do more research. I'd rather leave this one for the time being (and mark as an issue) as it'll mean a large scale refactoring of NoteEditor to do correctly.\nI've implemented onSaveInstanceState and onRestoreInstanceState\nBut: onRestoreInstanceState isn't called as the view is dynamically created - potentially after the activity is initialised due to onCollectionLoaded\nFieldEditText uses a hack - have the Activity set the variables, and use these to restore the field values, but this feels unsustainable and adds unnecessary complexity to NoteEditor\nUseful ref: https://www.netguru.com/codestories/how-to-correctly-save-the-state-of-a-custom-view-in-android", "author": "david-allison-1", "createdAt": "2020-10-20T14:48:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUyMjU0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODU3NzUyMA==", "url": "https://github.com/ankidroid/Anki-Android/pull/7426#discussion_r508577520", "bodyText": "Force pushed with my current (non-working) implementation - I'll have a think about this later on today, but I think I'd rather leave this as a future issue if acceptable.", "author": "david-allison-1", "createdAt": "2020-10-20T14:51:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUyMjU0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY0OTA0Nw==", "url": "https://github.com/ankidroid/Anki-Android/pull/7426#discussion_r508649047", "bodyText": "Yeah I think NoteEditor was one of the ones that didn't work fully on restart either, I'd be okay with peeling it out", "author": "mikehardy", "createdAt": "2020-10-20T16:01:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUyMjU0MA=="}], "type": "inlineReview"}, {"oid": "78453a3dee534bcec2a7c24805955db5d51b86cb", "url": "https://github.com/ankidroid/Anki-Android/commit/78453a3dee534bcec2a7c24805955db5d51b86cb", "message": "NoteEditor: Expand/Collapse Field Content\n\nIncludes animation, requested on Reddit - seemed sensible", "committedDate": "2020-10-20T14:50:26Z", "type": "forcePushed"}, {"oid": "b0ea2c0ed58bfd5e9aa8d6db2e265b0da539f2e7", "url": "https://github.com/ankidroid/Anki-Android/commit/b0ea2c0ed58bfd5e9aa8d6db2e265b0da539f2e7", "message": "NoteEditor: Expand/Collapse Field Content\n\nIncludes animation, requested on Reddit - seemed sensible", "committedDate": "2020-10-26T18:03:32Z", "type": "commit"}, {"oid": "b0ea2c0ed58bfd5e9aa8d6db2e265b0da539f2e7", "url": "https://github.com/ankidroid/Anki-Android/commit/b0ea2c0ed58bfd5e9aa8d6db2e265b0da539f2e7", "message": "NoteEditor: Expand/Collapse Field Content\n\nIncludes animation, requested on Reddit - seemed sensible", "committedDate": "2020-10-26T18:03:32Z", "type": "forcePushed"}]}