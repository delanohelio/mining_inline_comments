{"pr_number": 7820, "pr_title": "BugFix - Previewer: Display same card after edit", "pr_createdAt": "2020-12-03T08:47:49Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/7820", "timeline": [{"oid": "08910cce493a143a96e38ef91473f4ec6e64a064", "url": "https://github.com/ankidroid/Anki-Android/commit/08910cce493a143a96e38ef91473f4ec6e64a064", "message": "NF: Extract method: getPreviewIntent\n\nUseful for testing to keep a consistent method to create the intent\n\nFor testing 7801", "committedDate": "2020-12-03T07:17:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEzNzU1MA==", "url": "https://github.com/ankidroid/Anki-Android/pull/7820#discussion_r535137550", "bodyText": "@Nullable maybe?", "author": "mikehardy", "createdAt": "2020-12-03T11:32:46Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -1013,6 +1013,15 @@ public boolean onKeyDown(int keyCode, KeyEvent event) {\n     }\n \n \n+    @Override\n+    protected Long getCurrentCardId() {", "originalCommit": "0da228540989180497cc6e8e9bbcaa027773ab00", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM2MTgwNg==", "url": "https://github.com/ankidroid/Anki-Android/pull/7820#discussion_r535361806", "bodyText": "Also added to the overridden method", "author": "david-allison-1", "createdAt": "2020-12-03T15:58:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEzNzU1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEzOTA4NA==", "url": "https://github.com/ankidroid/Anki-Android/pull/7820#discussion_r535139084", "bodyText": "perhaps a quick note on the intent of this, what it controls, for future explorers?", "author": "mikehardy", "createdAt": "2020-12-03T11:34:18Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -1150,6 +1150,11 @@ protected void onActivityResult(int requestCode, int resultCode, Intent data) {\n     }\n \n \n+    protected boolean canAccessScheduler() {", "originalCommit": "d5dcb0b53703ddf8eb95e8a82201c21c7da87049", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2a7f0f215fd060cac70493a50491793f6017d1df", "url": "https://github.com/ankidroid/Anki-Android/commit/2a7f0f215fd060cac70493a50491793f6017d1df", "message": "CardViewer: Implement getCurrentCardId\n\nMethod in the base class - useful for testing\n\nRelated for testing 7801", "committedDate": "2020-12-03T15:58:10Z", "type": "commit"}, {"oid": "82c47dce4b6206f0dcd5a19bc43f1f50c212f9e8", "url": "https://github.com/ankidroid/Anki-Android/commit/82c47dce4b6206f0dcd5a19bc43f1f50c212f9e8", "message": "LOG: UPDATE_NOTE - Log if card changes\n\nThis was an unexpected behaviour as the reviewer flag was accidentally set\nin a non-reviewer class", "committedDate": "2020-12-03T15:58:12Z", "type": "commit"}, {"oid": "e36f6d1f0b058fd699cc0804eae63bbc18d34ca3", "url": "https://github.com/ankidroid/Anki-Android/commit/e36f6d1f0b058fd699cc0804eae63bbc18d34ca3", "message": "BugFix - Previewer: Display same card after edit\n\nEditing a note would call UPDATE_NOTE with parameter `isReviewer:true`.\n\nIf the card was not in the same deck as the 'currently active' deck, then\nthe next card was obtained from the scheduler\n\nThe UPDATE_NOTE callback gets this card and renders it, even though it's\nnot being previewed, showing the wrong card\n\nFix: Now, we pass a new boolean, which skips the scheduler when not reviewing\n\nThis means we still update the content, but without getting another CardId\n\nFixes 7801", "committedDate": "2020-12-03T16:11:50Z", "type": "commit"}, {"oid": "e36f6d1f0b058fd699cc0804eae63bbc18d34ca3", "url": "https://github.com/ankidroid/Anki-Android/commit/e36f6d1f0b058fd699cc0804eae63bbc18d34ca3", "message": "BugFix - Previewer: Display same card after edit\n\nEditing a note would call UPDATE_NOTE with parameter `isReviewer:true`.\n\nIf the card was not in the same deck as the 'currently active' deck, then\nthe next card was obtained from the scheduler\n\nThe UPDATE_NOTE callback gets this card and renders it, even though it's\nnot being previewed, showing the wrong card\n\nFix: Now, we pass a new boolean, which skips the scheduler when not reviewing\n\nThis means we still update the content, but without getting another CardId\n\nFixes 7801", "committedDate": "2020-12-03T16:11:50Z", "type": "forcePushed"}]}