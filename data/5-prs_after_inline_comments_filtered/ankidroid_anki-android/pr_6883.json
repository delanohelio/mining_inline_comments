{"pr_number": 6883, "pr_title": "Diff patch update", "pr_createdAt": "2020-08-11T17:58:13Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/6883", "timeline": [{"oid": "a9909935f290d1196b56d5514774c0d2fc7392b4", "url": "https://github.com/ankidroid/Anki-Android/commit/a9909935f290d1196b56d5514774c0d2fc7392b4", "message": "Alter annotations dependency, not just resolutionStrategy", "committedDate": "2020-08-11T17:55:54Z", "type": "commit"}, {"oid": "7c481806e01a8926b08c0443233a742f4d66c3f6", "url": "https://github.com/ankidroid/Anki-Android/commit/7c481806e01a8926b08c0443233a742f4d66c3f6", "message": "Bump java-diff-utils version\n\nI inadvertently ported to this library on an old version. Required\nforward-porting to a slightly new API (they removed a checked exception)", "committedDate": "2020-08-11T17:56:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODc2MzY4NA==", "url": "https://github.com/ankidroid/Anki-Android/pull/6883#discussion_r468763684", "bodyText": "They removed this checked exception from the generateDiffRows API", "author": "mikehardy", "createdAt": "2020-08-11T17:58:47Z", "path": "AnkiDroid/src/main/java/com/ichi2/utils/DiffEngine.java", "diffHunk": "@@ -51,16 +47,10 @@\n                 .reportLinesUnchanged(true)\n                 .build();\n \n-        List<DiffRow> diffRows = Collections.emptyList();\n-        try {\n-            diffRows = generator.generateDiffRows(\n-                    Arrays.asList(typed.split(\"\\\\s+\")),\n-                    Arrays.asList(correct.split(\"\\\\s+\")));\n-        } catch (DiffException e) {", "originalCommit": "7c481806e01a8926b08c0443233a742f4d66c3f6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODc4ODk3Nw==", "url": "https://github.com/ankidroid/Anki-Android/pull/6883#discussion_r468788977", "bodyText": "Have we changed the exception behavior? Should we catch a general IllegalStateException?\nIt seemed to only be thrown in one place which was commented that it shouldn't happen: java-diff-utils/java-diff-utils@9a39411#diff-7d3112010afa1e008d62f83e622f386aL135 so we might be fine\nIssue removing it: java-diff-utils/java-diff-utils#70 (comment)", "author": "david-allison-1", "createdAt": "2020-08-11T18:43:10Z", "path": "AnkiDroid/src/main/java/com/ichi2/utils/DiffEngine.java", "diffHunk": "@@ -51,16 +47,10 @@\n                 .reportLinesUnchanged(true)\n                 .build();\n \n-        List<DiffRow> diffRows = Collections.emptyList();\n-        try {\n-            diffRows = generator.generateDiffRows(\n-                    Arrays.asList(typed.split(\"\\\\s+\")),\n-                    Arrays.asList(correct.split(\"\\\\s+\")));\n-        } catch (DiffException e) {\n-            Timber.w(e, \"Unexpected diff exception\");\n-            // This will offer the users a chance to request specific help but should be impossible, no localization\n-            prettyTyped.append(wrapBad(\"Diff error, contact AnkiDroid support: \" + e.getLocalizedMessage()));\n-        }\n+        List<DiffRow> diffRows = generator.generateDiffRows(", "originalCommit": "7c481806e01a8926b08c0443233a742f4d66c3f6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgwODMxNA==", "url": "https://github.com/ankidroid/Anki-Android/pull/6883#discussion_r468808314", "bodyText": "I'm willing to take the word for it in that comment, and if I'm wrong it is a pretty widely used package and we certainly have the crash infra to know later (with no noise to pollute it at this point)", "author": "mikehardy", "createdAt": "2020-08-11T19:15:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODc4ODk3Nw=="}], "type": "inlineReview"}]}