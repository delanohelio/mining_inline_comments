{"pr_number": 6270, "pr_title": "NF: Remove hook chess", "pr_createdAt": "2020-05-24T11:51:57Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/6270", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyOTIzMQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6270#discussion_r429629231", "bodyText": "nit: unnecessary whitespace", "author": "david-allison-1", "createdAt": "2020-05-24T12:02:12Z", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/hooks/AdvancedStatistics.java", "diffHunk": "@@ -99,7 +99,7 @@\n @SuppressWarnings({\"PMD.AvoidThrowingRawExceptionTypes\",\"PMD.ExcessiveClassLength\",\"PMD.ExcessiveMethodLength\",\n                     \"PMD.AvoidReassigningParameters\",\"PMD.FieldDeclarationsShouldBeAtStartOfClass\",\"PMD.SwitchStatementsShouldHaveDefault\",\n                     \"PMD.NPathComplexity\",\"PMD.OneDeclarationPerLine\",\"PMD.SwitchStmtsShouldHaveDefault\"})\n-public class AdvancedStatistics extends Hook  {", "originalCommit": "55e40f2b484b0aaac3480568af70fb3a2bfda069", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyOTMxOA==", "url": "https://github.com/ankidroid/Anki-Android/pull/6270#discussion_r429629318", "bodyText": "From a design perspective, these would be better in ChessFilter. Is there a rationale for moving these to Collection?", "author": "david-allison-1", "createdAt": "2020-05-24T12:03:14Z", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -2243,4 +2246,71 @@ public boolean getFailed() {\n             return mFailed;\n         }\n     }\n+\n+    private static final Pattern fFenPattern = Pattern.compile(\"\\\\[fen ?([^\\\\]]*)\\\\]([^\\\\[]+)\\\\[/fen\\\\]\");", "originalCommit": "55e40f2b484b0aaac3480568af70fb3a2bfda069", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYzMDMzMQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6270#discussion_r429630331", "bodyText": "dealing with chess is a part of _renderQA.\nI should admit that I fail to see why rendering is in Collection. However, I believe that putting all of rendering together makes sens.", "author": "Arthur-Milchior", "createdAt": "2020-05-24T12:14:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyOTMxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYzNjAzNw==", "url": "https://github.com/ankidroid/Anki-Android/pull/6270#discussion_r429636037", "bodyText": "I'd rather we moved it back - Single Responsibility Principle and all.\nOur hands are tied with Anki Desktop compatibility in terms of splitting out Collection further, but we might as well make code intuitive for the next developers that come along", "author": "david-allison-1", "createdAt": "2020-05-24T13:20:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyOTMxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYzNjI4NA==", "url": "https://github.com/ankidroid/Anki-Android/pull/6270#discussion_r429636284", "bodyText": "I don't know whether you check Anki's update or not. But you may be interested in knowing that _renderQA is not in collection.py.\nIt's in rust back-end.\nSo by leaving _renderQA here, we are not following anki anymore", "author": "Arthur-Milchior", "createdAt": "2020-05-24T13:22:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyOTMxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYzODgyMA==", "url": "https://github.com/ankidroid/Anki-Android/pull/6270#discussion_r429638820", "bodyText": "I just removed the last commits", "author": "Arthur-Milchior", "createdAt": "2020-05-24T13:50:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyOTMxOA=="}], "type": "inlineReview"}, {"oid": "a328718e8ed89a8b5d603e71ff07ad0304e89d30", "url": "https://github.com/ankidroid/Anki-Android/commit/a328718e8ed89a8b5d603e71ff07ad0304e89d30", "message": "NF: Chess Filter in Collection", "committedDate": "2020-05-24T12:16:13Z", "type": "forcePushed"}, {"oid": "9f049f3895e17d3343f78347f77ac69a85ad33a2", "url": "https://github.com/ankidroid/Anki-Android/commit/9f049f3895e17d3343f78347f77ac69a85ad33a2", "message": "NF: Chess Filter in Collection", "committedDate": "2020-05-24T12:16:57Z", "type": "forcePushed"}, {"oid": "964f02ebe99530f518824ff1c4f0bebe721c87d0", "url": "https://github.com/ankidroid/Anki-Android/commit/964f02ebe99530f518824ff1c4f0bebe721c87d0", "message": "NF: remove unused runFilter", "committedDate": "2020-05-24T13:45:29Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg4NjMyMw==", "url": "https://github.com/ankidroid/Anki-Android/pull/6270#discussion_r429886323", "bodyText": "Also mentioned in the statistics PR, but I feel a static factory over static instance state would be a better option.", "author": "david-allison-1", "createdAt": "2020-05-25T11:32:51Z", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Storage.java", "diffHunk": "@@ -47,6 +50,11 @@ public static Collection Collection(Context context, String path, boolean server\n         assert path.endsWith(\".anki2\");\n         // Since this is the entry point into libanki, initialize the hooks here.\n         Hooks.getInstance(context);\n+        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(context.getApplicationContext());\n+        // Preferences activated hooks\n+        if (prefs.getBoolean(\"convertFenText\", false)) {", "originalCommit": "964f02ebe99530f518824ff1c4f0bebe721c87d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "01b3364e73d8444461ef5f639ebd1a75020bcf96", "url": "https://github.com/ankidroid/Anki-Android/commit/01b3364e73d8444461ef5f639ebd1a75020bcf96", "message": "NF: fenToChessboard static", "committedDate": "2020-05-31T14:39:55Z", "type": "commit"}, {"oid": "117891b767de2e556ccf54081ce4503eb4c7c6a0", "url": "https://github.com/ankidroid/Anki-Android/commit/117891b767de2e556ccf54081ce4503eb4c7c6a0", "message": "NF: html as separate variable", "committedDate": "2020-05-31T14:39:55Z", "type": "commit"}, {"oid": "4f15c9053f0e338c46615fc96dcb0eead0dba24b", "url": "https://github.com/ankidroid/Anki-Android/commit/4f15c9053f0e338c46615fc96dcb0eead0dba24b", "message": "NF: chess directly called from _renderQA", "committedDate": "2020-05-31T14:55:13Z", "type": "commit"}, {"oid": "4f15c9053f0e338c46615fc96dcb0eead0dba24b", "url": "https://github.com/ankidroid/Anki-Android/commit/4f15c9053f0e338c46615fc96dcb0eead0dba24b", "message": "NF: chess directly called from _renderQA", "committedDate": "2020-05-31T14:55:13Z", "type": "forcePushed"}]}