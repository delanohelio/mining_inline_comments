{"pr_number": 3265, "pr_title": "suppress raw type warning in IDEA", "pr_createdAt": "2020-10-06T11:41:37Z", "pr_url": "https://github.com/oracle/opengrok/pull/3265", "timeline": [{"oid": "5d539936858f8de2bb256db8674aa49a0aba0027", "url": "https://github.com/oracle/opengrok/commit/5d539936858f8de2bb256db8674aa49a0aba0027", "message": "suppress raw type warning in IDEA", "committedDate": "2020-10-06T11:39:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500209282", "bodyText": "I think this is a bogus from IDEA. We are building with -Werror -Xlint:all so if those do not report anything, then I'd not bother with it.", "author": "ahornace", "createdAt": "2020-10-06T11:44:39Z", "path": "suggester/src/main/java/org/opengrok/suggest/popular/impl/chronicle/BytesRefSizedReader.java", "diffHunk": "@@ -46,6 +46,7 @@ private BytesRefSizedReader() {\n \n     @NotNull\n     @Override\n+    @SuppressWarnings(\"rawtypes\")", "originalCommit": "5d539936858f8de2bb256db8674aa49a0aba0027", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI5MjUwMA==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500292500", "bodyText": "it just blocks the compilation in that environment. Overriding the options for each branch I work on is tedious.", "author": "vladak", "createdAt": "2020-10-06T13:46:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDMxMTg2Mw==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500311863", "bodyText": "Can you please be more specific what fails?\nIf I add any line which causes warning such as ArrayList<String> aa = new ArrayList(Arrays.asList(\"a\"));, then the compilation fails so -Werror -Xlint:all seem to work ok.\nI've tried compiling with JDK8 and JDK15 and there seems to be no difference.\nhttps://docs.oracle.com/javase/8/docs/api/java/lang/SuppressWarnings.html says that it should be used for compiler warnings.\nIf the compiler is not producing any warnings, then how come IDEA fails?", "author": "ahornace", "createdAt": "2020-10-06T14:06:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDMxNzMyNA==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500317324", "bodyText": "Also, I think the warning is legitimate - Bytes is a raw type after all.", "author": "vladak", "createdAt": "2020-10-06T14:12:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDMxOTM1MQ==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500319351", "bodyText": "Also, I think the warning is legitimate - Bytes is a raw type after all.\n\nWhat I'm concerned about is why javac is not reporting anything.", "author": "ahornace", "createdAt": "2020-10-06T14:14:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDMyNzEyMg==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500327122", "bodyText": "If I checkout master at efa341d and compile the project (Ctrl+F9) in IDEA Ultimate 2020.2, it results in the error:\n\nThe IDE is setup to use /usr/lib/jvm/default-java/bin/java which is currently:\n$ /usr/lib/jvm/default-java/bin/java -version\nopenjdk version \"11.0.7\" 2020-04-14\nOpenJDK Runtime Environment (build 11.0.7+10-post-Ubuntu-2ubuntu219.10)\nOpenJDK 64-Bit Server VM (build 11.0.7+10-post-Ubuntu-2ubuntu219.10, mixed mode, sharing)", "author": "vladak", "createdAt": "2020-10-06T14:22:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDMzMDAyNQ==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500330025", "bodyText": "Checking the 'Java compiler' settings it has these options for the 'suggester' module where this code resides:", "author": "vladak", "createdAt": "2020-10-06T14:25:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDMzMDYzNQ==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500330635", "bodyText": "If you run export JAVA_HOME=/usr/lib/jvm/default-java/ && ./mvnw clean compile, then it works fine?", "author": "ahornace", "createdAt": "2020-10-06T14:25:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDMzMzY5MQ==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500333691", "bodyText": "And yes, I don't see this in the builds done via Maven.", "author": "vladak", "createdAt": "2020-10-06T14:28:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDMzNDcyMg==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500334722", "bodyText": "Checking the output in the 'Build Output' tab it indeed uses Java 11.0.7:\nExecuting pre-compile tasks...\nLoading Ant Configuration...\nRunning Ant Tasks...\nRunning 'before' tasks\nChecking sources\nCopying resources... [suggester]\nCopying resources... [plugins]\nCopying resources... [opengrok-web]\nCopying resources... [opengrok]\nParsing java... [suggester]\njava: Errors occurred while compiling module 'suggester'\nChecking dependencies... [suggester]\nDependency analysis found 0 affected files\njavac 11.0.7 was used to compile java sources\nFinished, saving caches...\nModule \"opengrok-dist\" was fully rebuilt due to project configuration/dependencies changes\nCompilation failed: errors: 1; warnings: 1\nExecuting post-compile tasks...\nLoading Ant Configuration...\nRunning Ant Tasks...\nSynchronizing output directories...\n06.10.20 16:16 - Build completed with 1 error and 1 warning in 2 s 616 ms", "author": "vladak", "createdAt": "2020-10-06T14:29:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDMzNzAyOQ==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500337029", "bodyText": "Hmm, this is weird. I'd say that this is IDEA bug. IMHO it should not report warnings not found by the compiler.", "author": "ahornace", "createdAt": "2020-10-06T14:32:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM0NDM3Mw==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500344373", "bodyText": "Well, it is strange. I wonder how IDEA runs javac. Bug or not, it hampers my work :-)", "author": "vladak", "createdAt": "2020-10-06T14:40:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM1OTE4MQ==", "url": "https://github.com/oracle/opengrok/pull/3265#discussion_r500359181", "bodyText": "Changed the log4j configuration of IDEA per https://intellij-support.jetbrains.com/hc/en-us/articles/207241085-Locating-IDE-log-files and here's relevant excerpt from the build.log file:\n2020-10-06 16:49:17,295 [   1829]  DEBUG - s.incremental.java.JavaBuilder - Compiling chunk [suggester] with options: \"-g -deprecation -Xlint:all -Werror -Xlint:-auxiliaryclass -Xlint:-fallthrough -encoding UTF-\n8 --release 8 -s /home/vkotal/opengrok-git-vladak/suggester/target/generated-sources/annotations\", mode=in-process\n2020-10-06 16:49:17,785 [   2319]  DEBUG - s.incremental.java.JavaBuilder - java:WARNING:found raw type: net.openhft.chronicle.bytes.Bytes\n  missing type arguments for generic class net.openhft.chronicle.bytes.Bytes<Underlying>; file: /home/vkotal/opengrok-git-vladak/suggester/src/main/java/org/opengrok/suggest/popular/impl/chronicle/BytesRefSizedR\neader.java at (49:26)\n2020-10-06 16:49:17,819 [   2353]  DEBUG - s.incremental.java.JavaBuilder - java:ERROR:warnings found and -Werror specified; file: /home/vkotal/opengrok-git-vladak/suggester/src/main/java/org/opengrok/suggest/po\npular/impl/chronicle/BytesRefSizedReader.java\n2020-10-06 16:49:17,878 [   2412]  DEBUG - s.incremental.java.JavaBuilder - java:JPS_INFO:Errors occurred while compiling module 'suggester'\n2020-10-06 16:49:17,894 [   2428]  DEBUG - s.java.dependencyView.Mappings - Begin of Differentiate:\n2020-10-06 16:49:17,894 [   2428]  DEBUG - s.java.dependencyView.Mappings - Easy mode: false\n2020-10-06 16:49:17,894 [   2428]  DEBUG - s.java.dependencyView.Mappings - End of Differentiate.\n2020-10-06 16:49:17,894 [   2428]  DEBUG - brains.jps.incremental.Builder - Differentiate Results:\n2020-10-06 16:49:17,894 [   2428]  DEBUG - brains.jps.incremental.Builder -    Compiled Files:\n2020-10-06 16:49:17,894 [   2428]  DEBUG - brains.jps.incremental.Builder -    Affected Files:\n2020-10-06 16:49:17,894 [   2428]  DEBUG - brains.jps.incremental.Builder -       /home/vkotal/opengrok-git-vladak/suggester/src/main/java/org/opengrok/suggest/popular/impl/chronicle/BytesRefSizedReader.java\n2020-10-06 16:49:17,894 [   2428]  DEBUG - brains.jps.incremental.Builder - End Of Differentiate Results.", "author": "vladak", "createdAt": "2020-10-06T14:55:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDIwOTI4Mg=="}], "type": "inlineReview"}]}