{"pr_number": 1145, "pr_title": "HIVE-23722: Show the operation's drilldown link to client", "pr_createdAt": "2020-06-18T05:35:09Z", "pr_url": "https://github.com/apache/hive/pull/1145", "timeline": [{"oid": "3e2bdf53eba16bb88ed83620e8675b5e8acdbd6b", "url": "https://github.com/apache/hive/commit/3e2bdf53eba16bb88ed83620e8675b5e8acdbd6b", "message": "HIVE-23722: Show the operation's drilldown link to client", "committedDate": "2020-06-19T03:56:26Z", "type": "commit"}, {"oid": "3e2bdf53eba16bb88ed83620e8675b5e8acdbd6b", "url": "https://github.com/apache/hive/commit/3e2bdf53eba16bb88ed83620e8675b5e8acdbd6b", "message": "HIVE-23722: Show the operation's drilldown link to client", "committedDate": "2020-06-19T03:56:26Z", "type": "forcePushed"}, {"oid": "a5b5fa5b94b5a6cca2deb497343203a70c04094c", "url": "https://github.com/apache/hive/commit/a5b5fa5b94b5a6cca2deb497343203a70c04094c", "message": "ssl enabled", "committedDate": "2020-06-19T07:23:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjgzODc4OQ==", "url": "https://github.com/apache/hive/pull/1145#discussion_r442838789", "bodyText": "I don't feel that this method should be closely connected to this interface", "author": "kgyrtkirk", "createdAt": "2020-06-19T13:25:20Z", "path": "service/src/java/org/apache/hive/service/cli/operation/Operation.java", "diffHunk": "@@ -452,4 +452,8 @@ public String getQueryTag() {\n   public String getQueryId() {\n     return queryState.getQueryId();\n   }\n+\n+  public boolean showOperationDrilldownLink() {", "originalCommit": "a5b5fa5b94b5a6cca2deb497343203a70c04094c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg4MTE1Mg==", "url": "https://github.com/apache/hive/pull/1145#discussion_r442881152", "bodyText": "Nice find, perhaps I can move the check to the OperationManager.", "author": "dengzhhu653", "createdAt": "2020-06-19T14:43:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjgzODc4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg0MzM1MQ==", "url": "https://github.com/apache/hive/pull/1145#discussion_r442843351", "bodyText": "instead of giving access to the HiveServer2 object: how about a method like getWebServerUrl() ?", "author": "kgyrtkirk", "createdAt": "2020-06-19T13:34:01Z", "path": "service/src/java/org/apache/hive/service/cli/CLIService.java", "diffHunk": "@@ -149,6 +149,10 @@ public UserGroupInformation getHttpUGI() {\n     return this.httpUGI;\n   }\n \n+  public HiveServer2 getHiveServer2() {", "originalCommit": "a5b5fa5b94b5a6cca2deb497343203a70c04094c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg4MjYwMw==", "url": "https://github.com/apache/hive/pull/1145#discussion_r442882603", "bodyText": "yes, thank you for your good advice, @kgyrtkirk!", "author": "dengzhhu653", "createdAt": "2020-06-19T14:46:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg0MzM1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg0NjQ5OQ==", "url": "https://github.com/apache/hive/pull/1145#discussion_r442846499", "bodyText": "I think this should be moved to somewhere around CliService#executeStatement", "author": "kgyrtkirk", "createdAt": "2020-06-19T13:39:41Z", "path": "service/src/java/org/apache/hive/service/cli/thrift/ThriftCLIService.java", "diffHunk": "@@ -569,7 +569,19 @@ public TExecuteStatementResp ExecuteStatement(TExecuteStatementReq req) throws T\n               queryTimeout) : cliService.executeStatement(sessionHandle, statement, confOverlay,\n               queryTimeout);\n       resp.setOperationHandle(operationHandle.toTOperationHandle());\n-      resp.setStatus(OK_STATUS);\n+      Operation operation = cliService.getSessionManager().getOperationManager()\n+          .getOperation(operationHandle);\n+      if (operation.showOperationDrilldownLink() && cliService.getHiveServer2().getWebServerUrl() != null) {", "originalCommit": "a5b5fa5b94b5a6cca2deb497343203a70c04094c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg4NzQ3NA==", "url": "https://github.com/apache/hive/pull/1145#discussion_r442887474", "bodyText": "CliService defines the executeStatement returning OperationHandle, which has little relationship with thrift interface/definition. It's may not nice to wrap the thrift message here. Thanks for the review, @kgyrtkirk!", "author": "dengzhhu653", "createdAt": "2020-06-19T14:55:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg0NjQ5OQ=="}], "type": "inlineReview"}, {"oid": "1a34eba0f04ea4b4392974cbff5121a59e17ce25", "url": "https://github.com/apache/hive/commit/1a34eba0f04ea4b4392974cbff5121a59e17ce25", "message": "Refine codes and reduce class dependencies", "committedDate": "2020-06-20T00:46:24Z", "type": "commit"}, {"oid": "880b348cd5d67dc1ee0c12a27e80f867ad569d87", "url": "https://github.com/apache/hive/commit/880b348cd5d67dc1ee0c12a27e80f867ad569d87", "message": "remove HiveServer2 changes", "committedDate": "2020-06-22T03:54:08Z", "type": "commit"}, {"oid": "f6d63bdb752f3eb8cf1626a1d046e3e9b1015596", "url": "https://github.com/apache/hive/commit/f6d63bdb752f3eb8cf1626a1d046e3e9b1015596", "message": "refine codes", "committedDate": "2020-06-22T04:43:05Z", "type": "commit"}]}