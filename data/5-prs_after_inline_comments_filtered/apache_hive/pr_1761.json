{"pr_number": 1761, "pr_title": "HIVE-24514: UpdateMDatabaseURI does not update managed location URI", "pr_createdAt": "2020-12-10T09:14:56Z", "pr_url": "https://github.com/apache/hive/pull/1761", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTM0NjI5Mw==", "url": "https://github.com/apache/hive/pull/1761#discussion_r541346293", "bodyText": "Looks like we are setting the value of locationURI for managedLocation. dbLoc is based on mDB.getLocationURI(). Instead we should have similar logic where string substitutions are performed on DB's managedlocation as well.", "author": "nrg4878", "createdAt": "2020-12-11T22:07:25Z", "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/ObjectStore.java", "diffHunk": "@@ -8556,6 +8556,9 @@ public UpdateMDatabaseURIRetVal updateMDatabaseURI(URI oldLoc, URI newLoc, boole\n             updateLocations.put(locationURI.toString(), dbLoc);\n             if (!dryRun) {\n               mDB.setLocationUri(dbLoc);\n+              if (org.apache.commons.lang3.StringUtils.isNotBlank(mDB.getManagedLocationUri())) {\n+                mDB.setManagedLocationUri(dbLoc);", "originalCommit": "b4bb8e8cba20214dc01d082c1e2ff150fa58dc9a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8626009a6a1c4b977cdcb5facd9b3f37a99902da", "url": "https://github.com/apache/hive/commit/8626009a6a1c4b977cdcb5facd9b3f37a99902da", "message": "addressed Naveen's review comments", "committedDate": "2021-01-12T10:12:02Z", "type": "forcePushed"}, {"oid": "1ffbc9810403084df3a5c9e388c47c4d6fecf261", "url": "https://github.com/apache/hive/commit/1ffbc9810403084df3a5c9e388c47c4d6fecf261", "message": "addressed Naveen's review comments", "committedDate": "2021-01-13T11:42:48Z", "type": "forcePushed"}, {"oid": "e533d699e69dd2fb8c73955f6e24ed84d2c4e133", "url": "https://github.com/apache/hive/commit/e533d699e69dd2fb8c73955f6e24ed84d2c4e133", "message": "HIVE-24514: UpdateMDatabaseURI does not update managed location URI", "committedDate": "2021-01-15T07:55:17Z", "type": "commit"}, {"oid": "0ee4a5a6d4fd891978b2daa6c4618115d3803baa", "url": "https://github.com/apache/hive/commit/0ee4a5a6d4fd891978b2daa6c4618115d3803baa", "message": "addressed Naveen's review comments", "committedDate": "2021-01-15T07:55:17Z", "type": "commit"}, {"oid": "0ee4a5a6d4fd891978b2daa6c4618115d3803baa", "url": "https://github.com/apache/hive/commit/0ee4a5a6d4fd891978b2daa6c4618115d3803baa", "message": "addressed Naveen's review comments", "committedDate": "2021-01-15T07:55:17Z", "type": "forcePushed"}]}