{"pr_number": 1808, "pr_title": "HIVE-24561: Deflake TestCachedStoreUpdateUsingEvents test", "pr_createdAt": "2020-12-22T20:01:53Z", "pr_url": "https://github.com/apache/hive/pull/1808", "timeline": [{"oid": "786d305f3c7460135f34f3408ec771775e7180cb", "url": "https://github.com/apache/hive/commit/786d305f3c7460135f34f3408ec771775e7180cb", "message": "HIVE-24561: Deflake TestCachedStoreUpdateUsingEvents test", "committedDate": "2020-12-22T19:58:44Z", "type": "commit"}, {"oid": "942c6ea777e04ed2c6c9a74741f5dafefd75f7d1", "url": "https://github.com/apache/hive/commit/942c6ea777e04ed2c6c9a74741f5dafefd75f7d1", "message": "removed unused imports", "committedDate": "2020-12-22T20:02:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwMTYzOA==", "url": "https://github.com/apache/hive/pull/1808#discussion_r547501638", "bodyText": "Even the dbName can be same across multiple tests, which can get cleaned up. Would it be a good idea to use the current timestamp or generate a random number and prepend that to dbName and use that for the temporary directory ?", "author": "kishendas", "createdAt": "2020-12-22T20:51:01Z", "path": "itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStoreUpdateUsingEvents.java", "diffHunk": "@@ -82,9 +84,9 @@ public void setUp() throws Exception {\n     HiveMetaStore.HMSHandler.createDefaultCatalog(rawStore, new Warehouse(conf));\n   }\n \n-  private Database createTestDb(String dbName, String dbOwner) {\n+  private Database createTestDb(String dbName, String dbOwner) throws IOException {\n     String dbDescription = dbName;\n-    String dbLocation = \"file:/tmp\";\n+    String dbLocation = Files.createTempDirectory(dbName).toString();", "originalCommit": "942c6ea777e04ed2c6c9a74741f5dafefd75f7d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUxMzYyNA==", "url": "https://github.com/apache/hive/pull/1808#discussion_r547513624", "bodyText": "yeah, the Files.createTempDirectory creates a temp directory by appending the timestamp. DbName is just used as a prefix for the directory name.", "author": "vihangk1", "createdAt": "2020-12-22T21:23:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwMTYzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwMTc5OA==", "url": "https://github.com/apache/hive/pull/1808#discussion_r547501798", "bodyText": "Even the dbName and tblName can be same across multiple tests, which can get cleaned up. Would it be a good idea to use the current timestamp or generate a random number and prepend that to dbName and use that for the temporary directory ?", "author": "kishendas", "createdAt": "2020-12-22T20:51:23Z", "path": "itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStoreUpdateUsingEvents.java", "diffHunk": "@@ -94,8 +96,9 @@ private Database createTestDb(String dbName, String dbOwner) {\n   }\n \n   private Table createTestTblParam(String dbName, String tblName, String tblOwner,\n-                              List<FieldSchema> cols, List<FieldSchema> ptnCols, Map<String, String> tblParams) {\n-    String serdeLocation = \"file:/tmp\";\n+                              List<FieldSchema> cols, List<FieldSchema> ptnCols, Map<String, String> tblParams)\n+      throws IOException {\n+    String serdeLocation = Files.createTempDirectory(dbName + \"_\" + tblName).toString();", "originalCommit": "942c6ea777e04ed2c6c9a74741f5dafefd75f7d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUxNDE1Ng==", "url": "https://github.com/apache/hive/pull/1808#discussion_r547514156", "bodyText": "same comment as above. Based on the documentation of Files.createTempDirectory it returns \"the path to the newly created directory that did not exist before this method was invoked\"", "author": "vihangk1", "createdAt": "2020-12-22T21:24:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwMTc5OA=="}], "type": "inlineReview"}]}