{"pr_number": 1555, "pr_title": "HIVE-24233: Except subquery throws nullpointer", "pr_createdAt": "2020-10-06T07:17:22Z", "pr_url": "https://github.com/apache/hive/pull/1555", "timeline": [{"oid": "88aa81224efec6906f94b60be203c6652fb59dc9", "url": "https://github.com/apache/hive/commit/88aa81224efec6906f94b60be203c6652fb59dc9", "message": "HIVE-24233: Except subquery throws nullpointer", "committedDate": "2020-10-06T07:15:41Z", "type": "commit"}, {"oid": "be11c59a36c7040a846a55a6e1463d8396316281", "url": "https://github.com/apache/hive/commit/be11c59a36c7040a846a55a6e1463d8396316281", "message": "Merge remote-tracking branch 'origin/master' into HIVE-24233-except", "committedDate": "2020-11-03T09:17:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY0MDcwOA==", "url": "https://github.com/apache/hive/pull/1555#discussion_r516640708", "bodyText": "Could we say instead or something like this?\n\"EXCEPT and INTERSECT operations are only supported with Cost Based Optimizations enabled. Please set 'hive.cbo.enable' to true\"", "author": "pvary", "createdAt": "2020-11-03T12:47:41Z", "path": "ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java", "diffHunk": "@@ -11628,6 +11628,11 @@ private void setupStats(TableScanDesc tsDesc, QBParseInfo qbp, Table tab, String\n   }\n \n   private Operator genPlan(QB parent, QBExpr qbexpr) throws SemanticException {\n+    if (qbexpr.getOpcode() == QBExpr.Opcode.EXCEPT || qbexpr.getOpcode() == QBExpr.Opcode.EXCEPTALL\n+        || qbexpr.getOpcode() == QBExpr.Opcode.INTERSECT || qbexpr.getOpcode() == QBExpr.Opcode.INTERSECTALL) {\n+      throw new SemanticException(\n+          \"Except and intersect operations are only supported with Cost Based Optimizations enabled. Turn on hive.cbo.enable\");", "originalCommit": "be11c59a36c7040a846a55a6e1463d8396316281", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY4OTA3NA==", "url": "https://github.com/apache/hive/pull/1555#discussion_r516689074", "bodyText": "Fixed", "author": "pvargacl", "createdAt": "2020-11-03T14:04:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY0MDcwOA=="}], "type": "inlineReview"}, {"oid": "e0e78fb681ece6395217afc344eec2e0dfec7589", "url": "https://github.com/apache/hive/commit/e0e78fb681ece6395217afc344eec2e0dfec7589", "message": "Change exception message", "committedDate": "2020-11-03T14:02:16Z", "type": "commit"}, {"oid": "70831ef8ac879518c900189d9326529ad49cda52", "url": "https://github.com/apache/hive/commit/70831ef8ac879518c900189d9326529ad49cda52", "message": "fix q out", "committedDate": "2020-11-03T19:11:19Z", "type": "commit"}]}