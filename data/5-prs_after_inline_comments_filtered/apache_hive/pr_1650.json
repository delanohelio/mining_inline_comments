{"pr_number": 1650, "pr_title": "HIVE-24353: performance: do not throw exceptions when parsing timestamps", "pr_createdAt": "2020-11-03T19:32:46Z", "pr_url": "https://github.com/apache/hive/pull/1650", "timeline": [{"oid": "bd564a77128cf49bfbafa4a867baec98ca64e6e0", "url": "https://github.com/apache/hive/commit/bd564a77128cf49bfbafa4a867baec98ca64e6e0", "message": "performance: do not throw exceptions when parsing dates", "committedDate": "2020-11-03T19:28:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk1MDIyNQ==", "url": "https://github.com/apache/hive/pull/1650#discussion_r522950225", "bodyText": "First loop redundant?", "author": "pgaref", "createdAt": "2020-11-13T13:29:52Z", "path": "common/src/test/org/apache/hadoop/hive/common/type/TestTimestampTZ.java", "diffHunk": "@@ -84,6 +86,18 @@ public void testVariations() {\n     TimestampTZUtil.parse(\"2017-05-08 07:45:00-3:00\");\n   }\n \n+  @Test\n+  public void testPerformance() {\n+    for (int i = 0; i < 100; i++) {", "originalCommit": "bd564a77128cf49bfbafa4a867baec98ca64e6e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODE5ODIwOA==", "url": "https://github.com/apache/hive/pull/1650#discussion_r528198208", "bodyText": "This is to warm up the jvm before measuring; i added a clarifying comment.", "author": "VPriesnitz", "createdAt": "2020-11-21T13:45:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk1MDIyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODU5NjAwNQ==", "url": "https://github.com/apache/hive/pull/1650#discussion_r528596005", "bodyText": "I see -- usually we test the correctness with Junit tests and the performance sensitive parts with jmh tests (where you could for example test and compare the old behaviour with the new) -- check itests->hive-jmh package.\nNot critical for this change though", "author": "pgaref", "createdAt": "2020-11-23T10:17:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk1MDIyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NjMyMTYxMw==", "url": "https://github.com/apache/hive/pull/1650#discussion_r566321613", "bodyText": "Yes. Please remove.", "author": "belugabehr", "createdAt": "2021-01-28T18:37:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk1MDIyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk1MDYzMw==", "url": "https://github.com/apache/hive/pull/1650#discussion_r522950633", "bodyText": "Can we add some randomness on the parsed timestamp? Maybe use i as part of time?", "author": "pgaref", "createdAt": "2020-11-13T13:30:36Z", "path": "common/src/test/org/apache/hadoop/hive/common/type/TestTimestampTZ.java", "diffHunk": "@@ -84,6 +86,18 @@ public void testVariations() {\n     TimestampTZUtil.parse(\"2017-05-08 07:45:00-3:00\");\n   }\n \n+  @Test\n+  public void testPerformance() {\n+    for (int i = 0; i < 100; i++) {\n+      TimestampTZUtil.parse(\"2017-01-01 13:33:00\", ZoneId.of(\"UTC\"));\n+    }\n+    Stopwatch sw = Stopwatch.createStarted();\n+    for (int i = 0; i < 10000; i++) {\n+      TimestampTZUtil.parse(\"2017-01-01 13:33:00\", ZoneId.of(\"UTC\"));", "originalCommit": "bd564a77128cf49bfbafa4a867baec98ca64e6e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODE5ODMxMw==", "url": "https://github.com/apache/hive/pull/1650#discussion_r528198313", "bodyText": "Good point, i made the timestamp depending on i.", "author": "VPriesnitz", "createdAt": "2020-11-21T13:47:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk1MDYzMw=="}], "type": "inlineReview"}, {"oid": "955cae36f5117fc26edca2f22124b063c2c92e81", "url": "https://github.com/apache/hive/commit/955cae36f5117fc26edca2f22124b063c2c92e81", "message": "Address PR concerns.", "committedDate": "2020-11-21T13:44:27Z", "type": "commit"}, {"oid": "1fed99d8ceabf83792d31a30b4a88912cde874c0", "url": "https://github.com/apache/hive/commit/1fed99d8ceabf83792d31a30b4a88912cde874c0", "message": "removed performance test.", "committedDate": "2021-01-29T17:47:59Z", "type": "commit"}]}