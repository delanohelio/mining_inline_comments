{"pr_number": 6152, "pr_title": "Allow reordering of custom entry types fields", "pr_createdAt": "2020-03-21T20:04:54Z", "pr_url": "https://github.com/JabRef/jabref/pull/6152", "timeline": [{"oid": "4a2737f0c2d0db8cda253ca80433fa2e635e5dd7", "url": "https://github.com/JabRef/jabref/commit/4a2737f0c2d0db8cda253ca80433fa2e635e5dd7", "message": "[WIP] allow Reordering of custom entry types fields", "committedDate": "2020-03-21T20:04:05Z", "type": "commit"}, {"oid": "18800b96d33196df46605b404afe77eba7333a5d", "url": "https://github.com/JabRef/jabref/commit/18800b96d33196df46605b404afe77eba7333a5d", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master:\n  Fix image path\n  Check for secrets being present at GitHub workflows (#5973)\n  Add \"JabRef and Software Engineering\"\n  Make Java code acceptable for GitBook - and fix link to JUnit antipatterns\n  Let \"Contributing\" be displayed\n  Merge the reviewing steops of \"Code Quality\" to \"Development Strategy\"\n  Try to include CONTRIBUTING.md in devdocs.jabref.org\n  Minor improvments in CONTRIBUTING.md\n  Update Codecov yaml with proper indentation (#6156)\n  Complete refactor of LibraryProperties to mvvm (#6107)\n  Try comment:false\n  Remove duplicated line\n  Fix: Only if `.sav` file has changes a recovery dialog is shown (#6116)\n  Fix formatting for GitBook\n  Add hint to scroll down", "committedDate": "2020-03-23T07:53:54Z", "type": "commit"}, {"oid": "daeec26078d2bec3acd4b5ac8208fb49ce11e224", "url": "https://github.com/JabRef/jabref/commit/daeec26078d2bec3acd4b5ac8208fb49ce11e224", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master:\n  Refine teaching explanation\n  % include doesn't work on GitBook.io. Thus, add explicit text\n  Bump unirest-java from 3.6.01 to 3.7.00 (#6166)\n  Bump pdfbox from 2.0.18 to 2.0.19 (#6163)\n  Bump xmpbox from 2.0.18 to 2.0.19 (#6164)\n  Bump junit-vintage-engine from 5.6.0 to 5.6.1 (#6162)\n  Bump mariadb-java-client from 2.5.4 to 2.6.0 (#6160)\n  Bump fontbox from 2.0.18 to 2.0.19 (#6167)\n  Bump junit-jupiter from 5.6.0 to 5.6.1 (#6159)\n  Bump junit-platform-launcher from 1.6.0 to 1.6.1 (#6168)\n  Add link to teaching page\n  Refine teaching information\n  Replace donation link to directly point to PayPal", "committedDate": "2020-03-23T16:52:16Z", "type": "commit"}, {"oid": "d06d545b721c2361eaf7369b7dbf09d62ccf526a", "url": "https://github.com/JabRef/jabref/commit/d06d545b721c2361eaf7369b7dbf09d62ccf526a", "message": "change to linkedHashSet\n\nStill some differences in the custom entry type dlg", "committedDate": "2020-03-23T17:24:16Z", "type": "commit"}, {"oid": "5353a85ecec4c3b3dbb1dd14fc04fe2daed6682c", "url": "https://github.com/JabRef/jabref/commit/5353a85ecec4c3b3dbb1dd14fc04fe2daed6682c", "message": "Further changes\nseems to work now more or less\ntodo sorting is weird", "committedDate": "2020-03-23T17:40:51Z", "type": "commit"}, {"oid": "2a485882c23d43c02ad63f84286b1aadeac1299b", "url": "https://github.com/JabRef/jabref/commit/2a485882c23d43c02ad63f84286b1aadeac1299b", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master: (166 commits)\n  New Crowdin translations (#6382)\n  Update code-howtos.md (#6393)\n  Fix jstyle was invalid with default section at the start (#6386)\n  Correcting file name for groups.uml (#6373)\n  Fix underscore character being omitted from file name in Recent Libraries list (#6389)\n  Rework journal abbreviation caching (#6304)\n  Fix selecting custom export for copy to clipboard with uppercase file ext (#6290)\n  New Crowdin translations (#6375)\n  Squashed 'src/main/resources/csl-styles/' changes from 143464eff6..906cd6d43d\n  Fixes #6357: File directory (#6377)\n  Disable the generate button if the ID field is empty (#6371)\n  Fix Preferences style value too long (#6372)\n  Fix various Dark theme issues (#6368)\n  Correct label name in dependabot\n  Bump java-diff-utils from 4.5 to 4.7 (#6365)\n  Try with info.plist.template also (#6366)\n  Fix wrong button order (Apply and Cancel) in ManageProtectedTermsDialog. (#6358)\n  Bump flexmark-ext-gfm-strikethrough from 0.61.6 to 0.61.20 (#6361)\n  Bump checkstyle from 8.31 to 8.32 (#6360)\n  Bump flexmark-ext-gfm-tasklist from 0.61.16 to 0.61.20 (#6364)\n  ...", "committedDate": "2020-05-02T15:49:56Z", "type": "commit"}, {"oid": "13b2923e2f57155021b953dfb69318c4cab87459", "url": "https://github.com/JabRef/jabref/commit/13b2923e2f57155021b953dfb69318c4cab87459", "message": "iteratre prefs with chidlren recursively to show custom entry types\ncompare bibentry types because it takes fields into account", "committedDate": "2020-05-02T17:26:54Z", "type": "commit"}, {"oid": "1cbed25e511c35c30e5e2642bbf3f2b7eeb1de22", "url": "https://github.com/JabRef/jabref/commit/1cbed25e511c35c30e5e2642bbf3f2b7eeb1de22", "message": "try around with some more stuff\n\nstill not saved correct in order argh", "committedDate": "2020-05-02T18:08:57Z", "type": "commit"}, {"oid": "dcbe9386459777af499af643167f8f57500f6966", "url": "https://github.com/JabRef/jabref/commit/dcbe9386459777af499af643167f8f57500f6966", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master:\n  Fix action helper (#6122)", "committedDate": "2020-05-03T13:22:46Z", "type": "commit"}, {"oid": "c937601c45448e5f03439ea427597b8ae212eecc", "url": "https://github.com/JabRef/jabref/commit/c937601c45448e5f03439ea427597b8ae212eecc", "message": "show prefs path", "committedDate": "2020-05-03T14:09:40Z", "type": "commit"}, {"oid": "f49a83918fe009007b52334b0c6bf3f7d5ee7c38", "url": "https://github.com/JabRef/jabref/commit/f49a83918fe009007b52334b0c6bf3f7d5ee7c38", "message": "Fix action helper when no library is open", "committedDate": "2020-05-03T14:10:09Z", "type": "commit"}, {"oid": "791f4580227fb0e899ba1733c31c903bd5258705", "url": "https://github.com/JabRef/jabref/commit/791f4580227fb0e899ba1733c31c903bd5258705", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n# By dependabot-preview[bot] (18) and others\n# Via GitHub (17) and others\n* upstream/master: (77 commits)\n  Reenable caching of gradle\n  Refactor BibtexKeyPatternPreferences (#6489)\n  Update CHANGELOG.md\n  Add changelog entry and remove unnecessary code\n  EasyBind revision part two\n  Fix Drag and Drop on empty database\n  Truncates DOIs and URLs in the column \"Linked identifiers\" in main table, if too long (#6498)\n  Bump flexmark-ext-gfm-tasklist from 0.61.26 to 0.61.30\n  Bump flexmark from 0.61.26 to 0.61.30\n  Bump xmlunit-matchers from 2.6.4 to 2.7.0\n  Bump java-string-similarity from 1.2.1 to 2.0.0\n  Bump flexmark-ext-gfm-strikethrough from 0.61.26 to 0.61.30\n  Bump xmlunit-core from 2.6.4 to 2.7.0\n  Truncates the link and/or the link description in the column \"linked files\" in main table, if too long (#6179)\n  Keep group pane size when resizing window (#6180) (#6423)\n  Changelog: Fix missing citation for biblatex-mla\n  Update AUTHORS\n  Check duplicate DOI (#6333)\n  Fix missing citation for biblatex-mla\n  Change EasyBind dependency (#6480)\n  ...\n\n# Conflicts:\n#\tsrc/main/java/org/jabref/gui/actions/ActionHelper.java\n#\tsrc/main/java/org/jabref/gui/customentrytypes/CustomEntryTypeDialogViewModel.java\n#\tsrc/main/java/org/jabref/gui/customentrytypes/CustomizeEntryTypeDialogView.java\n#\tsrc/main/java/org/jabref/model/entry/field/FieldFactory.java", "committedDate": "2020-05-22T16:01:55Z", "type": "commit"}, {"oid": "0a010bfcceb99132d0a41fa3a4e0915d5ba55c52", "url": "https://github.com/JabRef/jabref/commit/0a010bfcceb99132d0a41fa3a4e0915d5ba55c52", "message": "fix checkstyle", "committedDate": "2020-05-22T16:51:21Z", "type": "commit"}, {"oid": "1d7832a216096a97d4ce6bff01aacd7bb0fc640e", "url": "https://github.com/JabRef/jabref/commit/1d7832a216096a97d4ce6bff01aacd7bb0fc640e", "message": "fix checkstyle", "committedDate": "2020-05-22T16:58:50Z", "type": "commit"}, {"oid": "dc51afda4b67fea78b54f433c1520624fdb88325", "url": "https://github.com/JabRef/jabref/commit/dc51afda4b67fea78b54f433c1520624fdb88325", "message": "try with Observable", "committedDate": "2020-05-22T17:27:44Z", "type": "commit"}, {"oid": "28aaa0cfc32c84345d817aec15e71b9a0a58ccac", "url": "https://github.com/JabRef/jabref/commit/28aaa0cfc32c84345d817aec15e71b9a0a58ccac", "message": "Create a new EntryTypeViewModel with observable types and fields", "committedDate": "2020-05-24T17:21:43Z", "type": "commit"}, {"oid": "815050f3b4aa6979b26ad16742608273f48c0fcb", "url": "https://github.com/JabRef/jabref/commit/815050f3b4aa6979b26ad16742608273f48c0fcb", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master: (110 commits)\n  Fix DOI import in RIS Importer\n  Rename bibtexkey (#6545)\n  check if fields are empty\n  fix comment checkstyle arght\n  Fix XMP Exctrator not returning empty optional\n  Fix Group hit counter calculation preferences (#6554)\n  add changelog entry\n  Make test concise\n  Add test for getXmpMetadata with no description\n  guidelines updated\n  lint and hint for JEE\n  Update eclipse setting\n  Bump checkstyle from 8.32 to 8.33\n  Bump classgraph from 4.8.78 to 4.8.80\n  Add more menu items to library context menu (#6551)\n  Squashed 'src/main/resources/csl-styles/' changes from 586e0b8408..c5f14e2c4d\n  Correct return description in javadoc\n  iterate to get all selected leaf nodes\n  check if metadata has start and end tag\n  Update RisImporterTest.java\n  ...", "committedDate": "2020-06-06T13:52:00Z", "type": "commit"}, {"oid": "ca23628467589f4e5b671a5664d33d269f6b3f01", "url": "https://github.com/JabRef/jabref/commit/ca23628467589f4e5b671a5664d33d269f6b3f01", "message": "simplify code\nadapt bindings\n\nTODO: add/remove", "committedDate": "2020-06-06T14:26:31Z", "type": "commit"}, {"oid": "5eb5bfc3b3cb68fd77a1a5c0c900ca455946e7b8", "url": "https://github.com/JabRef/jabref/commit/5eb5bfc3b3cb68fd77a1a5c0c900ca455946e7b8", "message": "add/remove handling", "committedDate": "2020-06-06T18:18:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI4OTQ2OQ==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436289469", "bodyText": "@tobiasdiez I followed your approach, however, sometimes the field list  on the right is not updated.\nI tried unbinding/binding again but doesn't help. Any idea  how to fix this?", "author": "Siedlerchr", "createdAt": "2020-06-06T18:20:33Z", "path": "src/main/java/org/jabref/gui/customentrytypes/CustomizeEntryTypeDialogView.java", "diffHunk": "@@ -141,6 +141,7 @@ private void setupTable() {\n         //Here we would need to select the\n         EasyBind.subscribe(viewModel.selectedEntryTypeProperty(), type -> {\n             if (type != null) {\n+                fields.itemsProperty().unbindBidirectional(type.fields());", "originalCommit": "5eb5bfc3b3cb68fd77a1a5c0c900ca455946e7b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI5NzkxNw==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436297917", "bodyText": "This should be fields.setItems(type.fields()) after converting all the above list properties to observable lists.\nMoreover, I would put this subscription thing in the viewModel and expose a new list viewModel.fieldsForSelectedType.", "author": "tobiasdiez", "createdAt": "2020-06-06T20:21:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI4OTQ2OQ=="}], "type": "inlineReview"}, {"oid": "2777455aa993194412f7301e62182548aad90833", "url": "https://github.com/JabRef/jabref/commit/2777455aa993194412f7301e62182548aad90833", "message": "check style", "committedDate": "2020-06-06T18:25:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI5NzA3NA==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436297074", "bodyText": "For this JabRef-intern drag&drops, the https://github.com/JabRef/jabref/blob/master/src/main/java/org/jabref/gui/util/CustomLocalDragboard.java is easier to use.", "author": "tobiasdiez", "createdAt": "2020-06-06T20:08:54Z", "path": "src/main/java/org/jabref/gui/DragAndDropDataFormats.java", "diffHunk": "@@ -11,6 +11,7 @@\n  */\n public class DragAndDropDataFormats {\n \n+    public static final DataFormat FIELD = new DataFormat(\"dnd/org.jabref.model.entry.field.Field\");", "originalCommit": "2777455aa993194412f7301e62182548aad90833", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI5NzE2OQ==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436297169", "bodyText": "Try to make this a simple ObservableList.", "author": "tobiasdiez", "createdAt": "2020-06-06T20:10:10Z", "path": "src/main/java/org/jabref/gui/customentrytypes/CustomEntryTypeDialogViewModel.java", "diffHunk": "@@ -55,19 +51,17 @@ public Field fromString(String string) {\n         }\n     };\n \n-    private final ListProperty<BibEntryType> entryTypes;\n-    private final ListProperty<Field> fields;\n-    private final ObjectProperty<BibEntryType> selectedEntryTypes = new SimpleObjectProperty<>();\n-    private final ListProperty<FieldViewModel> fieldsForType;\n+    private final ListProperty<Field> fieldsForAdding;\n+    private final ObjectProperty<CustomEntryTypeViewModel> selectedEntryTypes = new SimpleObjectProperty<>();\n     private final ObjectProperty<Field> selectedFieldToAdd = new SimpleObjectProperty<>();\n     private final StringProperty entryTypeToAdd = new SimpleStringProperty(\"\");\n     private final ObservableList<BibEntryType> allEntryTypes;\n-    private final ObservableList<FieldViewModel> allFieldsForType = FXCollections.observableArrayList(extractor -> new Observable[] {extractor.fieldName(), extractor.fieldType()});\n     private final ObjectProperty<Field> newFieldToAdd = new SimpleObjectProperty<>();\n     private final BibDatabaseMode mode;\n-    private final Map<BibEntryType, List<FieldViewModel>> typesWithFields = new HashMap<>();\n     private final List<BibEntryType> typesToRemove = new ArrayList<>();\n \n+    private final ListProperty<CustomEntryTypeViewModel> entryTypesWithFields = new SimpleListProperty<>(FXCollections.observableArrayList());", "originalCommit": "2777455aa993194412f7301e62182548aad90833", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI5NzIxMQ==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436297211", "bodyText": "Here too: simply use an ObservableList", "author": "tobiasdiez", "createdAt": "2020-06-06T20:10:57Z", "path": "src/main/java/org/jabref/gui/customentrytypes/CustomEntryTypeDialogViewModel.java", "diffHunk": "@@ -55,19 +51,17 @@ public Field fromString(String string) {\n         }\n     };\n \n-    private final ListProperty<BibEntryType> entryTypes;\n-    private final ListProperty<Field> fields;\n-    private final ObjectProperty<BibEntryType> selectedEntryTypes = new SimpleObjectProperty<>();\n-    private final ListProperty<FieldViewModel> fieldsForType;\n+    private final ListProperty<Field> fieldsForAdding;", "originalCommit": "2777455aa993194412f7301e62182548aad90833", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI5NzM4NQ==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436297385", "bodyText": "again, ObservableList should suffice", "author": "tobiasdiez", "createdAt": "2020-06-06T20:13:14Z", "path": "src/main/java/org/jabref/gui/customentrytypes/CustomEntryTypeViewModel.java", "diffHunk": "@@ -0,0 +1,58 @@\n+package org.jabref.gui.customentrytypes;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import javafx.beans.property.ListProperty;\n+import javafx.beans.property.ObjectProperty;\n+import javafx.beans.property.SimpleListProperty;\n+import javafx.beans.property.SimpleObjectProperty;\n+import javafx.collections.FXCollections;\n+import javafx.collections.ListChangeListener;\n+\n+import org.jabref.model.entry.BibEntryType;\n+\n+public class CustomEntryTypeViewModel {\n+\n+    private final ObjectProperty<BibEntryType> entryType = new SimpleObjectProperty<>();\n+    private final ListProperty<FieldViewModel> fields;", "originalCommit": "2777455aa993194412f7301e62182548aad90833", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI5NzUxNQ==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436297515", "bodyText": "This looks a bit complicated. Why not simply compare/overwrite on-save the old list of fields with the new one?", "author": "tobiasdiez", "createdAt": "2020-06-06T20:15:20Z", "path": "src/main/java/org/jabref/gui/customentrytypes/CustomEntryTypeViewModel.java", "diffHunk": "@@ -0,0 +1,58 @@\n+package org.jabref.gui.customentrytypes;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import javafx.beans.property.ListProperty;\n+import javafx.beans.property.ObjectProperty;\n+import javafx.beans.property.SimpleListProperty;\n+import javafx.beans.property.SimpleObjectProperty;\n+import javafx.collections.FXCollections;\n+import javafx.collections.ListChangeListener;\n+\n+import org.jabref.model.entry.BibEntryType;\n+\n+public class CustomEntryTypeViewModel {\n+\n+    private final ObjectProperty<BibEntryType> entryType = new SimpleObjectProperty<>();\n+    private final ListProperty<FieldViewModel> fields;\n+    private final List<FieldViewModel> fieldsToRemove = new ArrayList<>();\n+\n+    public CustomEntryTypeViewModel(BibEntryType entryType) {\n+        this.entryType.set(entryType);\n+\n+        List<FieldViewModel> allFieldsForType = entryType.getAllFields().stream().map(bibField -> new FieldViewModel(bibField.getField(), entryType.isRequired(bibField.getField()), bibField.getPriority(), entryType)).collect(Collectors.toList());\n+\n+        fields = new SimpleListProperty<>(FXCollections.observableArrayList(allFieldsForType));\n+\n+        fields.addListener((ListChangeListener<? super FieldViewModel>) change -> {", "originalCommit": "2777455aa993194412f7301e62182548aad90833", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c2754198025e77e5140988e3006ce7f4c50d1cf4", "url": "https://github.com/JabRef/jabref/commit/c2754198025e77e5140988e3006ce7f4c50d1cf4", "message": "simplify code and use observable list where possible", "committedDate": "2020-06-07T15:25:26Z", "type": "commit"}, {"oid": "eaf709957e2e2d36df8693e38805835ffce727a6", "url": "https://github.com/JabRef/jabref/commit/eaf709957e2e2d36df8693e38805835ffce727a6", "message": "fix checkstyle\n\ntodo serialiation fixes", "committedDate": "2020-06-07T15:57:36Z", "type": "commit"}, {"oid": "c04b2fc2d83a624fd187bdf4ecb05ea3ee4087a4", "url": "https://github.com/JabRef/jabref/commit/c04b2fc2d83a624fd187bdf4ecb05ea3ee4087a4", "message": "fix unit tests due to LinkedHashSet", "committedDate": "2020-06-07T16:52:08Z", "type": "commit"}, {"oid": "15ba840eafb9856d7413f6319ccb23c189f9e9bd", "url": "https://github.com/JabRef/jabref/commit/15ba840eafb9856d7413f6319ccb23c189f9e9bd", "message": "add extractor", "committedDate": "2020-06-07T17:11:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM4OTcyOQ==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436389729", "bodyText": "observable list should be sufficient here.", "author": "tobiasdiez", "createdAt": "2020-06-07T18:31:57Z", "path": "src/main/java/org/jabref/gui/customentrytypes/CustomEntryTypeDialogViewModel.java", "diffHunk": "@@ -55,18 +52,14 @@ public Field fromString(String string) {\n         }\n     };\n \n-    private final ListProperty<BibEntryType> entryTypes;\n-    private final ListProperty<Field> fields;\n-    private final ObjectProperty<BibEntryType> selectedEntryTypes = new SimpleObjectProperty<>();\n-    private final ListProperty<FieldViewModel> fieldsForType;\n+    private final ObservableList<Field> fieldsForAdding;\n+    private final ObjectProperty<CustomEntryTypeViewModel> selectedEntryTypes = new SimpleObjectProperty<>();\n     private final ObjectProperty<Field> selectedFieldToAdd = new SimpleObjectProperty<>();\n     private final StringProperty entryTypeToAdd = new SimpleStringProperty(\"\");\n     private final ObservableList<BibEntryType> allEntryTypes;\n-    private final ObservableList<FieldViewModel> allFieldsForType = FXCollections.observableArrayList(extractor -> new Observable[] {extractor.fieldName(), extractor.fieldType()});\n     private final ObjectProperty<Field> newFieldToAdd = new SimpleObjectProperty<>();\n     private final BibDatabaseMode mode;\n-    private final Map<BibEntryType, List<FieldViewModel>> typesWithFields = new HashMap<>();\n-    private final List<BibEntryType> typesToRemove = new ArrayList<>();\n+    private final ListProperty<CustomEntryTypeViewModel> entryTypesWithFields = new SimpleListProperty<>(FXCollections.observableArrayList(extractor -> new Observable[] {extractor.entryType(), extractor.fields()}));", "originalCommit": "15ba840eafb9856d7413f6319ccb23c189f9e9bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ4MTM3Nw==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436481377", "bodyText": "Nope, it's used in a binding and bind() only accepts a ListProperty", "author": "Siedlerchr", "createdAt": "2020-06-08T06:32:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM4OTcyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYwNTM0NA==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r436605344", "bodyText": "entryTypes.setItems(viewModel.entryTypes()); should work if entryTypes is an observable list. No need for the bind + property.", "author": "tobiasdiez", "createdAt": "2020-06-08T10:40:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM4OTcyOQ=="}], "type": "inlineReview"}, {"oid": "614470e2e45513c935bc196198af6394fea0537e", "url": "https://github.com/JabRef/jabref/commit/614470e2e45513c935bc196198af6394fea0537e", "message": "change to observablelist", "committedDate": "2020-06-08T14:50:16Z", "type": "commit"}, {"oid": "e16cbda7372d0974792eb0b9eed2bf8bdb192370", "url": "https://github.com/JabRef/jabref/commit/e16cbda7372d0974792eb0b9eed2bf8bdb192370", "message": "fix issue that items get cleared\nremove uncessary code", "committedDate": "2020-06-08T16:57:51Z", "type": "commit"}, {"oid": "7ddb6fa44650af89e28b8a93f969e076f967351c", "url": "https://github.com/JabRef/jabref/commit/7ddb6fa44650af89e28b8a93f969e076f967351c", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master:\n  Bump flexmark-ext-gfm-strikethrough from 0.62.0 to 0.62.2\n  Bump flexmark-ext-gfm-tasklist from 0.62.0 to 0.62.2\n  Bump flexmark from 0.62.0 to 0.62.2\n  Bump classgraph from 4.8.80 to 4.8.83\n  Bump jfoenix from 9.0.9 to 9.0.10\n  Bump byte-buddy-parent from 1.10.10 to 1.10.11", "committedDate": "2020-06-09T13:30:45Z", "type": "commit"}, {"oid": "42606fe6ff26efe3738c7034b401bd4ed378ce70", "url": "https://github.com/JabRef/jabref/commit/42606fe6ff26efe3738c7034b401bd4ed378ce70", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master:\n  Fixed an issue where entry preview tab has no name in drop down list. (#6591)", "committedDate": "2020-06-11T16:37:54Z", "type": "commit"}, {"oid": "70853bd80b30e39d5a6ce34cde5819f78a8387b8", "url": "https://github.com/JabRef/jabref/commit/70853bd80b30e39d5a6ce34cde5819f78a8387b8", "message": "Add option to remove custom entr types\nSelect newly added entrytype in list", "committedDate": "2020-06-11T17:20:37Z", "type": "commit"}, {"oid": "e38742bda5f023027d5f542ecb706deeaad5a928", "url": "https://github.com/JabRef/jabref/commit/e38742bda5f023027d5f542ecb706deeaad5a928", "message": "fix checkstyle", "committedDate": "2020-06-11T17:39:06Z", "type": "commit"}, {"oid": "230d8dd00560d5e92f6d6e96c784bd733d692a95", "url": "https://github.com/JabRef/jabref/commit/230d8dd00560d5e92f6d6e96c784bd733d692a95", "message": "Fix bug with empty ghost fields on empty field collection when parsing", "committedDate": "2020-06-12T14:32:21Z", "type": "commit"}, {"oid": "831eb500ea249819c7ed18c032b90e7a954500a9", "url": "https://github.com/JabRef/jabref/commit/831eb500ea249819c7ed18c032b90e7a954500a9", "message": "checkstyle", "committedDate": "2020-06-12T15:45:30Z", "type": "commit"}, {"oid": "73bd208964a0842832c42a52c5a3cd501d25429c", "url": "https://github.com/JabRef/jabref/commit/73bd208964a0842832c42a52c5a3cd501d25429c", "message": "add reset and fix tests", "committedDate": "2020-06-12T16:52:58Z", "type": "commit"}, {"oid": "ada2a879025ba4b658128720fb597e2831165aea", "url": "https://github.com/JabRef/jabref/commit/ada2a879025ba4b658128720fb597e2831165aea", "message": "fix fcking checkstyle again", "committedDate": "2020-06-12T16:56:33Z", "type": "commit"}, {"oid": "e2e6fbd3b48ff6e6c9650975571e13e5007414aa", "url": "https://github.com/JabRef/jabref/commit/e2e6fbd3b48ff6e6c9650975571e13e5007414aa", "message": "fix tests\ndisable control helper button for the moment", "committedDate": "2020-06-12T17:20:48Z", "type": "commit"}, {"oid": "c093a053d098ff85ef8d491424536c7761455840", "url": "https://github.com/JabRef/jabref/commit/c093a053d098ff85ef8d491424536c7761455840", "message": "reenable filter", "committedDate": "2020-06-12T17:44:02Z", "type": "commit"}, {"oid": "ffa35d460db72ae7345d975793c5ef03c3a8294b", "url": "https://github.com/JabRef/jabref/commit/ffa35d460db72ae7345d975793c5ef03c3a8294b", "message": "fix comma error", "committedDate": "2020-06-12T18:08:06Z", "type": "commit"}, {"oid": "46f01929d467d0797059347a3efdb31203e14d89", "url": "https://github.com/JabRef/jabref/commit/46f01929d467d0797059347a3efdb31203e14d89", "message": "add l10n", "committedDate": "2020-06-12T18:09:33Z", "type": "commit"}, {"oid": "66995a3a55332f9bacbeeb3e8677b9566b726fe8", "url": "https://github.com/JabRef/jabref/commit/66995a3a55332f9bacbeeb3e8677b9566b726fe8", "message": "l10n", "committedDate": "2020-06-12T18:10:48Z", "type": "commit"}, {"oid": "fbc3d4da33b31193ca211a13954aaece3f0f7bac", "url": "https://github.com/JabRef/jabref/commit/fbc3d4da33b31193ca211a13954aaece3f0f7bac", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master:\n  fix markdown lint\n  Fix library marked as changed when opening library properties\n  Fixed an issue where entry preview in preferences has white theme. (#5522)\n  Checkstyle\n  Fixed GrobidServiceTest\n  Remove senseless tests for getHelpPage and fixed some IDE warnings\n  Changed expected result of GrobidCitationFetcherTest, fixed some minor IDE suggestions\n  Moved IEEE api key to github secrets\n  Revert change in GrobidServiceTest\n  Moved ADS api key to github secrets\n  Fix INSPIREFetcherTest\n  Fix GrobidServiceTest\n  Fix more links\n  Fixed some broken links in fetcher tests", "committedDate": "2020-06-13T22:01:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTE3MDk5NQ==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r441170995", "bodyText": "I don't get this comment. --> I read it as \"We do not need to select the fields and do something different, because of some idea\" \ud83d\ude07\nIt seems that this is a necessary comment. Could you maybe rephrase it?", "author": "koppor", "createdAt": "2020-06-16T22:11:22Z", "path": "src/main/java/org/jabref/gui/customentrytypes/CustomizeEntryTypeDialogView.java", "diffHunk": "@@ -128,16 +149,88 @@ private void setupTable() {\n                 .install(fieldTypeActionColumn);\n \n         viewModel.newFieldToAddProperty().bindBidirectional(addNewField.valueProperty());\n-        fields.itemsProperty().bindBidirectional(viewModel.fieldsforTypesProperty());\n+\n+        // Here we would need to select the fields", "originalCommit": "fbc3d4da33b31193ca211a13954aaece3f0f7bac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE0MjU1MQ==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r443142551", "bodyText": "It was an obsolete comment I forgot to rmeove", "author": "Siedlerchr", "createdAt": "2020-06-20T16:23:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTE3MDk5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTE3MTQyMg==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r441171422", "bodyText": "Do we really need that comment? - Where is \"stop drag'n'drop\"?", "author": "koppor", "createdAt": "2020-06-16T22:12:14Z", "path": "src/main/java/org/jabref/gui/customentrytypes/CustomizeEntryTypeDialogView.java", "diffHunk": "@@ -128,16 +149,88 @@ private void setupTable() {\n                 .install(fieldTypeActionColumn);\n \n         viewModel.newFieldToAddProperty().bindBidirectional(addNewField.valueProperty());\n-        fields.itemsProperty().bindBidirectional(viewModel.fieldsforTypesProperty());\n+\n+        // Here we would need to select the fields\n+        EasyBind.subscribe(viewModel.selectedEntryTypeProperty(), type -> {\n+            if (type != null) {\n+                var items = type.fields();\n+                fields.setItems(items);\n+            }\n+        });\n+\n+        new ViewModelTableRowFactory<FieldViewModel>()\n+              .setOnDragDetected(this::handleOnDragDetected)\n+              .setOnDragDropped(this::handleOnDragDropped)\n+              .setOnDragOver(this::handleOnDragOver)\n+              .install(fields);\n+}\n+\n+    private void handleOnDragOver(FieldViewModel originalItem, DragEvent event) {\n+        if ((event.getGestureSource() != originalItem) && event.getDragboard().hasContent(DragAndDropDataFormats.FIELD)) {\n+            event.acceptTransferModes(TransferMode.MOVE);\n+        }\n+    }\n+\n+    private void handleOnDragDetected(TableRow<FieldViewModel> row, FieldViewModel fieldViewModel, MouseEvent event) {\n+        // Start drag'n'drop", "originalCommit": "fbc3d4da33b31193ca211a13954aaece3f0f7bac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTE3MTQ4Ng==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r441171486", "bodyText": "No empty line here.", "author": "koppor", "createdAt": "2020-06-16T22:12:25Z", "path": "src/main/java/org/jabref/gui/customentrytypes/CustomizeEntryTypeDialogView.java", "diffHunk": "@@ -128,16 +149,88 @@ private void setupTable() {\n                 .install(fieldTypeActionColumn);\n \n         viewModel.newFieldToAddProperty().bindBidirectional(addNewField.valueProperty());\n-        fields.itemsProperty().bindBidirectional(viewModel.fieldsforTypesProperty());\n+\n+        // Here we would need to select the fields\n+        EasyBind.subscribe(viewModel.selectedEntryTypeProperty(), type -> {\n+            if (type != null) {\n+                var items = type.fields();\n+                fields.setItems(items);\n+            }\n+        });\n+\n+        new ViewModelTableRowFactory<FieldViewModel>()\n+              .setOnDragDetected(this::handleOnDragDetected)\n+              .setOnDragDropped(this::handleOnDragDropped)\n+              .setOnDragOver(this::handleOnDragOver)\n+              .install(fields);\n+}\n+\n+    private void handleOnDragOver(FieldViewModel originalItem, DragEvent event) {\n+        if ((event.getGestureSource() != originalItem) && event.getDragboard().hasContent(DragAndDropDataFormats.FIELD)) {\n+            event.acceptTransferModes(TransferMode.MOVE);\n+        }\n+    }\n+\n+    private void handleOnDragDetected(TableRow<FieldViewModel> row, FieldViewModel fieldViewModel, MouseEvent event) {\n+        // Start drag'n'drop\n+        row.startFullDrag();\n+\n+        FieldViewModel field = fields.getSelectionModel().getSelectedItem();\n+\n+        ClipboardContent content = new ClipboardContent();\n+        Dragboard dragboard = fields.startDragAndDrop(TransferMode.MOVE);\n+        content.put(DragAndDropDataFormats.FIELD, \"\");\n+        localDragboard.putValue(FieldViewModel.class, field);\n+        dragboard.setContent(content);\n+        event.consume();\n+    }\n+\n+    private void handleOnDragDropped(TableRow<FieldViewModel> row, FieldViewModel originalItem, DragEvent event) {\n+        boolean success = false;\n+\n+        ObservableList<FieldViewModel> items = fields.itemsProperty().get();\n+\n+        if (localDragboard.hasType(FieldViewModel.class)) {\n+", "originalCommit": "fbc3d4da33b31193ca211a13954aaece3f0f7bac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTE3Mjc1MQ==", "url": "https://github.com/JabRef/jabref/pull/6152#discussion_r441172751", "bodyText": "This change is OK for me. Number really belongs to a journal. More than Note", "author": "koppor", "createdAt": "2020-06-16T22:15:38Z", "path": "src/test/java/org/jabref/logic/bibtex/BibEntryWriterTest.java", "diffHunk": "@@ -272,8 +273,8 @@ void roundTripWithCamelCasingInTheOriginalEntryAndResultInLowerCase() throws IOE\n         String bibtexEntry = OS.NEWLINE + \"@Article{test,\" + OS.NEWLINE +\n                 \"  Author                   = {Foo Bar},\" + OS.NEWLINE +\n                 \"  Journal                  = {International Journal of Something},\" + OS.NEWLINE +\n-                \"  Note                     = {some note},\" + OS.NEWLINE +", "originalCommit": "fbc3d4da33b31193ca211a13954aaece3f0f7bac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "716a78d382fde90382f5aafbbf1c99b405262120", "url": "https://github.com/JabRef/jabref/commit/716a78d382fde90382f5aafbbf1c99b405262120", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master:\n  Validates the file path of a TexGroup and fixes Texgroup's \"Library has been modified by another program\" (#6586)\n  Bump postgresql from 42.2.12 to 42.2.14 (#6610)\n  Add markdown-link-check (#6542)\n  Catch InaccessibleObjectException (#6519)\n  Fix author formatter for unchanged names (#6552)\n  Bump com.simonharrer.modernizer from 1.8.0-1 to 2.1.0-1\n  Bump org.beryx.jlink from 2.19.0 to 2.20.0\n  Bump classgraph from 4.8.83 to 4.8.86\n  Update FileUtilTest.java\n  Update FileUtilTest.java\n  Squashed 'src/main/resources/csl-styles/' changes from c5f14e2c4d..716f63557c\n  Update FileUtilTest.java\n  Update MoveFilesCleanupTest.java\n  checkstyle\n  Fix dowmloaded files moved to citaiton key dir", "committedDate": "2020-06-19T06:59:50Z", "type": "commit"}, {"oid": "e5dd9c69278456ad2e20b0c6d089807c664de76d", "url": "https://github.com/JabRef/jabref/commit/e5dd9c69278456ad2e20b0c6d089807c664de76d", "message": "revert booktitle order\nand pages order\nclean empty lines", "committedDate": "2020-06-20T16:11:40Z", "type": "commit"}, {"oid": "fe01050d50cfb584ca2cca1dce796f7dd160007e", "url": "https://github.com/JabRef/jabref/commit/fe01050d50cfb584ca2cca1dce796f7dd160007e", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master:\n  Bump fontbox from 2.0.19 to 2.0.20\n  Bump xmpbox from 2.0.19 to 2.0.20\n  Bump unirest-java from 3.7.02 to 3.7.04\n  Bump byte-buddy-parent from 1.10.11 to 1.10.12\n  Bump pdfbox from 2.0.19 to 2.0.20", "committedDate": "2020-06-22T11:58:27Z", "type": "commit"}, {"oid": "5a6fc22a772bd0bd7d10f55065c6d61d33793f9d", "url": "https://github.com/JabRef/jabref/commit/5a6fc22a772bd0bd7d10f55065c6d61d33793f9d", "message": "try to add test for use case", "committedDate": "2020-06-23T07:00:51Z", "type": "commit"}, {"oid": "6846297473df0518e307f00d93d2ff7e8dcacac7", "url": "https://github.com/JabRef/jabref/commit/6846297473df0518e307f00d93d2ff7e8dcacac7", "message": "pass entry types manager as parameter\nadd test", "committedDate": "2020-06-23T13:20:51Z", "type": "commit"}, {"oid": "df03c384316d32a9f5fc0ce90ffca774c4b13e00", "url": "https://github.com/JabRef/jabref/commit/df03c384316d32a9f5fc0ce90ffca774c4b13e00", "message": "Merge remote-tracking branch 'upstream/master' into allowReordering\n\n* upstream/master:\n  Update README.md\n  Link the most important page from the beginning\n  add removable-media info in snap description (#6619)\n  Set version of markdown-link-check to v1", "committedDate": "2020-06-27T19:16:33Z", "type": "commit"}, {"oid": "298a83271af5fed122e793898c3abce4043ab8d9", "url": "https://github.com/JabRef/jabref/commit/298a83271af5fed122e793898c3abce4043ab8d9", "message": "Fix issue with wrong order after using BibEntryType Builder\nChange EntryEditor to LInkedHashSet as well", "committedDate": "2020-06-27T20:24:22Z", "type": "commit"}, {"oid": "16b536633691dd5fd88006a79f6ccbca996b1c88", "url": "https://github.com/JabRef/jabref/commit/16b536633691dd5fd88006a79f6ccbca996b1c88", "message": "checkstyle", "committedDate": "2020-06-27T20:33:35Z", "type": "commit"}, {"oid": "0e8803a7e3ec6687bbbd5f48a71af9332a63fbce", "url": "https://github.com/JabRef/jabref/commit/0e8803a7e3ec6687bbbd5f48a71af9332a63fbce", "message": "implement reset", "committedDate": "2020-06-28T17:06:19Z", "type": "commit"}, {"oid": "07d598392b08f408661f57105b7f2247abee6085", "url": "https://github.com/JabRef/jabref/commit/07d598392b08f408661f57105b7f2247abee6085", "message": "make dialogmessage more specific", "committedDate": "2020-06-28T17:08:58Z", "type": "commit"}, {"oid": "d1f4d9969a4a4478b75a22c03a062eb7c1e7d6b8", "url": "https://github.com/JabRef/jabref/commit/d1f4d9969a4a4478b75a22c03a062eb7c1e7d6b8", "message": "checkstyle", "committedDate": "2020-06-28T18:14:38Z", "type": "commit"}]}