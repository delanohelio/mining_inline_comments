{"pr_number": 6871, "pr_title": "fixed 'copy key and link'", "pr_createdAt": "2020-09-04T11:19:36Z", "pr_url": "https://github.com/JabRef/jabref/pull/6871", "timeline": [{"oid": "865c8f28d6d3467e98f5f4034f4119776d3663b3", "url": "https://github.com/JabRef/jabref/commit/865c8f28d6d3467e98f5f4034f4119776d3663b3", "message": "'copy key and link' from right-click menu creates a string that is not a url. it includes the url, but it also includes the key... it works now", "committedDate": "2020-09-04T11:12:43Z", "type": "commit"}, {"oid": "04843f02cb3eedbcd08f1e283806c42a56903c4d", "url": "https://github.com/JabRef/jabref/commit/04843f02cb3eedbcd08f1e283806c42a56903c4d", "message": "updated authorlist", "committedDate": "2020-09-04T15:16:23Z", "type": "commit"}, {"oid": "e7e3a172694c75de918b95c50cbec59480d264c7", "url": "https://github.com/JabRef/jabref/commit/e7e3a172694c75de918b95c50cbec59480d264c7", "message": "added entry to change log", "committedDate": "2020-09-04T15:26:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483840399", "bodyText": "This really puts the html string into the clipboard, so if you paste it into say notepad you get <a href=\"url\">key</a>. Instead, its better to add the html, and in addition also a fallback string of the format key - url. In this way, you get the desired behavior also when you paste in applications that do understand html (e.g onenote).\nIn order for this to work, you probably need to add a second fallback argument to\n\n  \n    \n      jabref/src/main/java/org/jabref/gui/ClipBoardManager.java\n    \n    \n        Lines 140 to 145\n      in\n      3db4313\n    \n    \n    \n    \n\n        \n          \n           public void setHtmlContent(String html) { \n        \n\n        \n          \n               final ClipboardContent content = new ClipboardContent(); \n        \n\n        \n          \n               content.putHtml(html); \n        \n\n        \n          \n               clipboard.setContent(content); \n        \n\n        \n          \n               setPrimaryClipboardContent(content); \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nwhich is then added to the ClipboardContent via putString.", "author": "tobiasdiez", "createdAt": "2020-09-04T20:55:45Z", "path": "src/main/java/org/jabref/gui/edit/CopyMoreAction.java", "diffHunk": "@@ -224,7 +224,7 @@ private void copyKeyAndLink() {\n             keyAndLink.append(OS.NEWLINE);\n         }\n \n-        clipBoardManager.setHtmlContent(keyAndLink.toString());\n+        clipBoardManager.setContent(keyAndLink.toString());", "originalCommit": "e7e3a172694c75de918b95c50cbec59480d264c7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkyMTM1NA==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483921354", "bodyText": "Hi @tobiasdiez !\nAh ok that makes sense.. I guess I should have looked deeper into what setHtmlContent() actually does.. I assumed it would be applicable for url's on their own only. So that means, both, setContent() and setHtmlContent() should be called?\nSorry for my noobness! This was my first open-source contribution ever :D\nCan I fix the issue tonight (German time) and commit the changes?\nthanks,\nNiko", "author": "PremKolar", "createdAt": "2020-09-05T07:13:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkyMzU2OQ==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483923569", "bodyText": "No worries, you were on the right track. Calling setContent and setHtmlContent is the right idea, but I suspect that this will push two different clipboard items. Instead, the setHtmlContent should be modified as follows:\npublic void setHtmlContent(String html, String fallbackPlain) { \n     final ClipboardContent content = new ClipboardContent(); \n     content.putHtml(html);\n     content.putString(fallbackPlain);\n     clipboard.setContent(content); \n     setPrimaryClipboardContent(content); \n }\n\nThis should add one clipboard item, containing both the html as well as the normal string. (I hope)\nLet me know if you encounter any further questions. There is not such a thing as noobness. We all can learn more. And learning in a relaxed environment is one of the main points of open source, so don't worry. Happy coding!", "author": "tobiasdiez", "createdAt": "2020-09-05T07:41:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk4MDE4NA==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483980184", "bodyText": "but I suspect that this will push two different clipboard items.\n\nThat was exactly my next thought :)\nOk, I will try..\nThanks for the kind words!", "author": "PremKolar", "createdAt": "2020-09-05T19:24:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk4OTM4Nw==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483989387", "bodyText": "alright, i hope i did what you meant. I have to say, I still don't understand why copyKeyAndLink() creates html content for the clipboard, but e.g. copyKeyAndTitle() does not?\ncheers,\nNiko", "author": "PremKolar", "createdAt": "2020-09-05T20:58:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ=="}], "type": "inlineReview"}, {"oid": "77fed3145e408143ab76930aba5173ba46897436", "url": "https://github.com/JabRef/jabref/commit/77fed3145e408143ab76930aba5173ba46897436", "message": "'copy key and link' now sets html content again and also sets a fallback string", "committedDate": "2020-09-05T20:55:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzAzOQ==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r488423039", "bodyText": "Please remove the comment", "author": "koppor", "createdAt": "2020-09-15T06:43:19Z", "path": "src/main/java/org/jabref/gui/ClipBoardManager.java", "diffHunk": "@@ -144,6 +144,15 @@ public void setHtmlContent(String html) {\n         setPrimaryClipboardContent(content);\n     }\n \n+    //@overload", "originalCommit": "77fed3145e408143ab76930aba5173ba46897436", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc1ODU0Mw==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r490758543", "bodyText": "Can the old setHtmlContent method be removed? If it's still used by other code, it might be a good idea to provide a fallback string in these cases as well. What do you think?", "author": "tobiasdiez", "createdAt": "2020-09-18T07:35:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzAzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg5NzI2Mw==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r490897263", "bodyText": "Hi Tobias,\nIf I am not mistaken, there is no usage of setHtmlContent(String html) anywhere...\nOnly setHtmlContent(String html, String fallbackPlain) is used once on line 230 of CopyMoreAction.java.\nShould I remove the unused version?", "author": "PremKolar", "createdAt": "2020-09-18T11:52:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzAzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY1NzU5OQ==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r491657599", "bodyText": "Yes, just remove the the unused method.", "author": "koppor", "createdAt": "2020-09-20T06:10:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzAzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzQ4Mw==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r488423483", "bodyText": "Please fix checkstyle\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    clipBoardManager.setHtmlContent(keyAndLink.toString(),fallbackString.toString());\n          \n          \n            \n                    clipBoardManager.setHtmlContent(keyAndLink.toString(), fallbackString.toString());", "author": "koppor", "createdAt": "2020-09-15T06:44:18Z", "path": "src/main/java/org/jabref/gui/edit/CopyMoreAction.java", "diffHunk": "@@ -222,9 +223,11 @@ private void copyKeyAndLink() {\n             String url = entry.getField(StandardField.URL).orElse(\"\");\n             keyAndLink.append(url.isEmpty() ? key : String.format(\"<a href=\\\"%s\\\">%s</a>\", url, key));\n             keyAndLink.append(OS.NEWLINE);\n+            fallbackString.append(url.isEmpty() ? key : String.format(\"%s - %s\", key, url));\n+            fallbackString.append(OS.NEWLINE);\n         }\n \n-        clipBoardManager.setHtmlContent(keyAndLink.toString());\n+        clipBoardManager.setHtmlContent(keyAndLink.toString(),fallbackString.toString());", "originalCommit": "77fed3145e408143ab76930aba5173ba46897436", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDUwMDYzNg==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r490500636", "bodyText": "Hi Koppor,\nI implemented your change requests!\nOne question:\nHow can check the \"checkstyle\" myself?", "author": "PremKolar", "createdAt": "2020-09-17T19:23:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzQ4Mw=="}], "type": "inlineReview"}, {"oid": "409a4162c7189165d92886fc8d9b8e2c29fc0946", "url": "https://github.com/JabRef/jabref/commit/409a4162c7189165d92886fc8d9b8e2c29fc0946", "message": "Update src/main/java/org/jabref/gui/edit/CopyMoreAction.java\n\nCo-authored-by: Oliver Kopp <kopp.dev@gmail.com>", "committedDate": "2020-09-15T07:43:23Z", "type": "commit"}, {"oid": "d022875ba0e9e02e16722b73897126c8fd79946b", "url": "https://github.com/JabRef/jabref/commit/d022875ba0e9e02e16722b73897126c8fd79946b", "message": "Merge branch 'master' into #5835_copyKeyAndLink", "committedDate": "2020-09-17T19:25:29Z", "type": "commit"}, {"oid": "2449d2a56e73290a6465177f679301888b768315", "url": "https://github.com/JabRef/jabref/commit/2449d2a56e73290a6465177f679301888b768315", "message": "CHANGELOG.md", "committedDate": "2020-09-29T06:32:47Z", "type": "commit"}, {"oid": "ce505364e44b9e97bb894773c98cc100af862013", "url": "https://github.com/JabRef/jabref/commit/ce505364e44b9e97bb894773c98cc100af862013", "message": "Remove obsolete method\n\nRemove obsolete method", "committedDate": "2020-09-29T06:48:21Z", "type": "commit"}]}