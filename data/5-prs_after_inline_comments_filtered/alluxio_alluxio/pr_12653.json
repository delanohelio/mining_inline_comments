{"pr_number": 12653, "pr_title": "Add 'attachdb' option for mounting diff prefix partitions", "pr_createdAt": "2020-12-16T01:10:21Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/12653", "timeline": [{"oid": "9202125306b7cf76c5904069d3d30fa56d6971d7", "url": "https://github.com/Alluxio/alluxio/commit/9202125306b7cf76c5904069d3d30fa56d6971d7", "message": "Add option to allow mounting partitions with diff location prefix than table location", "committedDate": "2020-12-16T01:01:08Z", "type": "commit"}, {"oid": "990be09870d46a22d940250f47a29ad33bb73f2e", "url": "https://github.com/Alluxio/alluxio/commit/990be09870d46a22d940250f47a29ad33bb73f2e", "message": "Lint fix", "committedDate": "2020-12-16T01:06:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzgwMzMzNQ==", "url": "https://github.com/Alluxio/alluxio/pull/12653#discussion_r543803335", "bodyText": "This file is using the same code structure as alluxio/table/under/glue/Property.java", "author": "hycsam", "createdAt": "2020-12-16T01:11:54Z", "path": "table/server/underdb/hive/src/main/java/alluxio/table/under/hive/Property.java", "diffHunk": "@@ -11,12 +11,166 @@\n \n package alluxio.table.under.hive;", "originalCommit": "990be09870d46a22d940250f47a29ad33bb73f2e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMyNDc2Mg==", "url": "https://github.com/Alluxio/alluxio/pull/12653#discussion_r545324762", "bodyText": "Can this be a general property, since the glue integration also has a similar check: https://github.com/Alluxio/alluxio/blob/master/table/server/underdb/glue/src/main/java/alluxio/table/under/glue/GlueDatabase.java#L263", "author": "gpang", "createdAt": "2020-12-17T18:51:40Z", "path": "table/server/underdb/hive/src/main/java/alluxio/table/under/hive/HiveDatabase.java", "diffHunk": "@@ -162,8 +162,12 @@ private PathTranslator mountAlluxioPaths(Table table, List<Partition> partitions\n \n       for (Partition part : partitions) {\n         AlluxioURI partitionUri;\n-        if (part.getSd() != null && part.getSd().getLocation() != null\n-            && ufsUri.isAncestorOf(partitionUri = new AlluxioURI(part.getSd().getLocation()))) {\n+        if (part.getSd() != null && part.getSd().getLocation() != null) {\n+          partitionUri = new AlluxioURI(part.getSd().getLocation());\n+          if (!mConfiguration.getBoolean(Property.ALLOW_DIFF_PART_LOC_PREFIX)\n+              && !ufsUri.isAncestorOf(partitionUri)) {", "originalCommit": "990be09870d46a22d940250f47a29ad33bb73f2e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}