{"pr_number": 10816, "pr_title": "Add thread-safe annotation to evictor interface", "pr_createdAt": "2020-01-31T01:37:29Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/10816", "timeline": [{"oid": "4bb36773a941d775cc23210694a45a0bb1948b59", "url": "https://github.com/Alluxio/alluxio/commit/4bb36773a941d775cc23210694a45a0bb1948b59", "message": "Add thread-safe annotation to evictor interface", "committedDate": "2020-01-31T01:35:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM1Mzk5MA==", "url": "https://github.com/Alluxio/alluxio/pull/10816#discussion_r374353990", "bodyText": "Should we abstract this logic to another method?\n\nGrab metalock\nDo metastore operation\nRelease metalock\nNotify listeners", "author": "calvinjia", "createdAt": "2020-02-03T21:35:03Z", "path": "core/client/fs/src/main/java/alluxio/client/file/cache/LocalCacheManager.java", "diffHunk": "@@ -221,6 +223,7 @@ public void delete(PageId pageId) throws IOException, PageNotFoundException {\n       try (LockResource r1 = new LockResource(mMetaLock.writeLock())) {\n         mMetaStore.removePage(pageId);\n       }\n+      mEvictor.updateOnDelete(pageId);", "originalCommit": "4bb36773a941d775cc23210694a45a0bb1948b59", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTEwNDg4MQ==", "url": "https://github.com/Alluxio/alluxio/pull/10816#discussion_r375104881", "bodyText": "what's the benefit in this case?", "author": "apc999", "createdAt": "2020-02-05T08:00:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM1Mzk5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYyNTMzNg==", "url": "https://github.com/Alluxio/alluxio/pull/10816#discussion_r376625336", "bodyText": "Just makes sure that we do all the necessary steps, otherwise we might have cases where we forget to update listeners or grab locks\nWe can handle this in a separate PR if you think its useful", "author": "calvinjia", "createdAt": "2020-02-07T21:53:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM1Mzk5MA=="}], "type": "inlineReview"}]}