{"pr_number": 11814, "pr_title": "Enable the JVM pause monitor by default", "pr_createdAt": "2020-07-23T22:18:59Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/11814", "timeline": [{"oid": "ae16751805b66c040fb358bd8a148ced731de606", "url": "https://github.com/Alluxio/alluxio/commit/ae16751805b66c040fb358bd8a148ced731de606", "message": "Enable the JVM pause monitor by default\n\nIn addition to turning it on by default;\n- Many new tests were added. Code coverage is 82/90 (91%)\n- Minor tweaks and improvements to the class", "committedDate": "2020-08-03T18:14:17Z", "type": "commit"}, {"oid": "ae16751805b66c040fb358bd8a148ced731de606", "url": "https://github.com/Alluxio/alluxio/commit/ae16751805b66c040fb358bd8a148ced731de606", "message": "Enable the JVM pause monitor by default\n\nIn addition to turning it on by default;\n- Many new tests were added. Code coverage is 82/90 (91%)\n- Minor tweaks and improvements to the class", "committedDate": "2020-08-03T18:14:17Z", "type": "forcePushed"}, {"oid": "c8ae79c2ffcb33b0b525894f59b60cb5f21a33ea", "url": "https://github.com/Alluxio/alluxio/commit/c8ae79c2ffcb33b0b525894f59b60cb5f21a33ea", "message": "Fix hanging test", "committedDate": "2020-08-03T20:16:36Z", "type": "commit"}, {"oid": "8ff138469ac9a559a8b0b141241fcc1d8ff1adc2", "url": "https://github.com/Alluxio/alluxio/commit/8ff138469ac9a559a8b0b141241fcc1d8ff1adc2", "message": "Fix bug bug with flipped arguments", "committedDate": "2020-08-03T20:16:55Z", "type": "commit"}, {"oid": "94b7bfd6e9bb50762de3b241ad9907a413b3c15e", "url": "https://github.com/Alluxio/alluxio/commit/94b7bfd6e9bb50762de3b241ad9907a413b3c15e", "message": "Remove unnecessary test", "committedDate": "2020-08-03T22:47:11Z", "type": "commit"}, {"oid": "94b7bfd6e9bb50762de3b241ad9907a413b3c15e", "url": "https://github.com/Alluxio/alluxio/commit/94b7bfd6e9bb50762de3b241ad9907a413b3c15e", "message": "Remove unnecessary test", "committedDate": "2020-08-03T22:47:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTIxNDUyOQ==", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465214529", "bodyText": "Why is this also not final?", "author": "gpang", "createdAt": "2020-08-04T17:31:21Z", "path": "core/common/src/main/java/alluxio/util/JvmPauseMonitor.java", "diffHunk": "@@ -48,11 +50,11 @@\n   private final long mInfoThresholdMs;\n \n   /** Times extra sleep time exceed WARN. */\n-  private long mWarnTimeExceeded = 0;\n+  private final AtomicLong mWarnTimeExceeded = new AtomicLong();\n   /** Times extra sleep time exceed INFO. */\n-  private long mInfoTimeExceeded = 0;\n+  private final AtomicLong mInfoTimeExceeded = new AtomicLong();\n   /** Total extra sleep time. */\n-  private long mTotalExtraTimeMs = 0;\n+  private AtomicLong mTotalExtraTimeMs = new AtomicLong();", "originalCommit": "94b7bfd6e9bb50762de3b241ad9907a413b3c15e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI0NDcwOQ==", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465244709", "bodyText": "fixed", "author": "ZacBlanco", "createdAt": "2020-08-04T18:24:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTIxNDUyOQ=="}], "type": "inlineReview"}, {"oid": "03d3fcc55eba5ec7ca497b5c4b3000f77931c06d", "url": "https://github.com/Alluxio/alluxio/commit/03d3fcc55eba5ec7ca497b5c4b3000f77931c06d", "message": "Address comment", "committedDate": "2020-08-04T17:50:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNjMxMA==", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465326310", "bodyText": "what was this change for?", "author": "gpang", "createdAt": "2020-08-04T20:58:07Z", "path": "core/server/master/src/test/java/alluxio/master/AlluxioMasterProcessTest.java", "diffHunk": "@@ -156,7 +158,7 @@ private void waitForServing(ServiceType service) throws TimeoutException, Interr\n       } catch (IOException e) {\n         throw new RuntimeException(e);\n       }\n-    });\n+    }, WaitForOptions.defaults().setTimeoutMs(5 * Constants.MINUTE_MS));", "originalCommit": "03d3fcc55eba5ec7ca497b5c4b3000f77931c06d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMzODc1Nw==", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465338757", "bodyText": "Previously, this test would hang for multiple hours if the master/worker failed to come up. Now, it will time out.", "author": "ZacBlanco", "createdAt": "2020-08-04T21:24:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNjMxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM5NDYwOQ==", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465394609", "bodyText": "But, is this unrelated to jvm pause monitor tests? If so, I think this should be its own PR/commit.", "author": "gpang", "createdAt": "2020-08-04T23:58:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNjMxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQwNDU5NA==", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465404594", "bodyText": "This was kind-of related. A bug in the monitor usage caused this test to fail (hang) for 2+ hours. It was very hard to track down with jenkins because I couldn't tell which tests are running when jenkins aborts the job. It would have been easier to find had this test contained a timeout.", "author": "ZacBlanco", "createdAt": "2020-08-05T00:34:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNjMxMA=="}], "type": "inlineReview"}]}