{"pr_number": 1246, "pr_title": "[HUDI-552] Fix the schema mismatch in Row-to-Avro conversion", "pr_createdAt": "2020-01-18T09:36:09Z", "pr_url": "https://github.com/apache/hudi/pull/1246", "timeline": [{"oid": "b28af2ce52c08227b619426e205e1c2cf14bcc39", "url": "https://github.com/apache/hudi/commit/b28af2ce52c08227b619426e205e1c2cf14bcc39", "message": "[HUDI-552] Fix the schema mismatch in Row-to-Avro conversion", "committedDate": "2020-01-18T09:24:49Z", "type": "commit"}, {"oid": "9ce2019b716fc764373c51d21563c9b2a140638a", "url": "https://github.com/apache/hudi/commit/9ce2019b716fc764373c51d21563c9b2a140638a", "message": "Fix unit tests.", "committedDate": "2020-01-19T00:04:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODc3MjIwOQ==", "url": "https://github.com/apache/hudi/pull/1246#discussion_r368772209", "bodyText": "is the key to this property right? Isn't \".....target.schema.file\" ?", "author": "nsivabalan", "createdAt": "2020-01-21T01:05:29Z", "path": "hudi-utilities/src/test/java/org/apache/hudi/utilities/TestHoodieDeltaStreamer.java", "diffHunk": "@@ -620,6 +636,62 @@ public void testDistributedTestDataSource() {\n     Assert.assertEquals(1000, c);\n   }\n \n+  private static void prepareParquetDFSFiles(int numRecords) throws IOException {\n+    String path = PARQUET_SOURCE_ROOT + \"/1.parquet\";\n+    HoodieTestDataGenerator dataGenerator = new HoodieTestDataGenerator();\n+    Helpers.saveParquetToDFS(Helpers.toGenericRecords(\n+        dataGenerator.generateInserts(\"000\", numRecords), dataGenerator), new Path(path));\n+  }\n+\n+  private void prepareParquetDFSSource(boolean useSchemaProvider, boolean hasTransformer) throws IOException {\n+    // Properties used for testing delta-streamer with Parquet source\n+    TypedProperties parquetProps = new TypedProperties();\n+    parquetProps.setProperty(\"include\", \"base.properties\");\n+    parquetProps.setProperty(\"hoodie.datasource.write.recordkey.field\", \"_row_key\");\n+    parquetProps.setProperty(\"hoodie.datasource.write.partitionpath.field\", \"not_there\");\n+    if (useSchemaProvider) {\n+      parquetProps.setProperty(\"hoodie.deltastreamer.schemaprovider.source.schema.file\", dfsBasePath + \"/source.avsc\");\n+      if (hasTransformer) {\n+        parquetProps.setProperty(\"hoodie.deltastreamer.schemaprovider.source.schema.file\", dfsBasePath + \"/target.avsc\");", "originalCommit": "9ce2019b716fc764373c51d21563c9b2a140638a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODc4NTM2Mw==", "url": "https://github.com/apache/hudi/pull/1246#discussion_r368785363", "bodyText": "Good catch.  I've found and fixed that in #1165.", "author": "yihua", "createdAt": "2020-01-21T02:21:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODc3MjIwOQ=="}], "type": "inlineReview"}]}