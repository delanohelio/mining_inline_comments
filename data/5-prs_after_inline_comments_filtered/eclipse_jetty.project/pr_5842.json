{"pr_number": 5842, "pr_title": "Issue #5824 Durable ConstraintMappings.", "pr_createdAt": "2020-12-23T17:35:21Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/5842", "timeline": [{"oid": "7955ebcb3de5caa6d3351b524cb328743ea3bc6c", "url": "https://github.com/eclipse/jetty.project/commit/7955ebcb3de5caa6d3351b524cb328743ea3bc6c", "message": "Issue #5824 Durable ConstraintMappings.\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-12-23T17:32:54Z", "type": "commit"}, {"oid": "9d328ce78bad6f3e353ef5398b7acac6ad810d72", "url": "https://github.com/eclipse/jetty.project/commit/9d328ce78bad6f3e353ef5398b7acac6ad810d72", "message": "Issue #5824 Fix ConstraintTest\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-12-23T20:56:43Z", "type": "commit"}, {"oid": "39d7083b47052ab7cbaf671fe822b58b8a773018", "url": "https://github.com/eclipse/jetty.project/commit/39d7083b47052ab7cbaf671fe822b58b8a773018", "message": "Issue #5824 Return only durable mappings before ConstraintSecurityHandler start\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-12-24T14:27:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDEyMzM0MQ==", "url": "https://github.com/eclipse/jetty.project/pull/5842#discussion_r550123341", "bodyText": "Is this necessary?  The _durableConstraintMappings is a subset of _constraintMappings, so isn't it always OK to return _constraintMappings?", "author": "gregw", "createdAt": "2020-12-30T10:31:01Z", "path": "jetty-security/src/main/java/org/eclipse/jetty/security/ConstraintSecurityHandler.java", "diffHunk": "@@ -260,12 +262,19 @@ public static Constraint createConstraint(String name, String[] rolesAllowed, Em\n     }\n \n     /**\n-     * @return Returns the constraintMappings.\n+     * @return only the durable mappings if we are not yet started, otherwise\n+     * return both the durables and transients.\n      */\n     @Override\n     public List<ConstraintMapping> getConstraintMappings()\n     {\n-        return _constraintMappings;\n+        //if we've started, then we've processed both the durable and\n+        //transient constraint mappings\n+        if (isRunning())\n+            return _constraintMappings;\n+        else\n+            //otherwise, we only have durables\n+            return _durableConstraintMappings;", "originalCommit": "39d7083b47052ab7cbaf671fe822b58b8a773018", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDEyNjA5OA==", "url": "https://github.com/eclipse/jetty.project/pull/5842#discussion_r550126098", "bodyText": "Oh I see.... will comment more in request for change....", "author": "gregw", "createdAt": "2020-12-30T10:34:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDEyMzM0MQ=="}], "type": "inlineReview"}, {"oid": "60b350876c398bff3cac9b28c3a3cfac0e2ea762", "url": "https://github.com/eclipse/jetty.project/commit/60b350876c398bff3cac9b28c3a3cfac0e2ea762", "message": "Issue #5824 Change after review\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-12-30T10:51:03Z", "type": "commit"}, {"oid": "65e53aa0b196364321816c41cd9431070c65b4e2", "url": "https://github.com/eclipse/jetty.project/commit/65e53aa0b196364321816c41cd9431070c65b4e2", "message": "Issue #5824 Changes after review\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-12-30T16:42:06Z", "type": "commit"}]}