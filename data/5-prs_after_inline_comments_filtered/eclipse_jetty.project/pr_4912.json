{"pr_number": 4912, "pr_title": "Issue #4907 - close websocket suspendState if close frame is received", "pr_createdAt": "2020-05-27T00:19:07Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/4912", "timeline": [{"oid": "d8fb116e1250214b4863e30307ee4de8aca473ca", "url": "https://github.com/eclipse/jetty.project/commit/d8fb116e1250214b4863e30307ee4de8aca473ca", "message": "Issue #4907 - close suspendState if response close frame is received\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-05-26T07:13:16Z", "type": "commit"}, {"oid": "277561e48baba8d6867ad91a7d536dfea48f62d3", "url": "https://github.com/eclipse/jetty.project/commit/277561e48baba8d6867ad91a7d536dfea48f62d3", "message": "Issue #4907 - moved to close state if any close frame is received\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-05-27T00:10:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk0NDQzMA==", "url": "https://github.com/eclipse/jetty.project/pull/4912#discussion_r437944430", "bodyText": "We have just synchronized above, so can this check and change be done in that block?", "author": "gregw", "createdAt": "2020-06-10T08:17:23Z", "path": "jetty-websocket/websocket-jetty-common/src/main/java/org/eclipse/jetty/websocket/common/JettyWebSocketFrameHandler.java", "diffHunk": "@@ -206,6 +206,16 @@ public void onFrame(Frame frame, Callback callback)\n             }\n         }\n \n+        // If we have received a close frame, set state to closed to disallow suspends and resumes.\n+        byte opCode = frame.getOpCode();\n+        if (opCode == OpCode.CLOSE)\n+        {\n+            synchronized (this)", "originalCommit": "277561e48baba8d6867ad91a7d536dfea48f62d3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "50b62c3771bde9ef83c83345a68588f04f4401e8", "url": "https://github.com/eclipse/jetty.project/commit/50b62c3771bde9ef83c83345a68588f04f4401e8", "message": "Issue #4907 - merge synchronized blocks for suspendState\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-06-16T08:09:29Z", "type": "commit"}]}