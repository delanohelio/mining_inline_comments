{"pr_number": 5101, "pr_title": "Issue #5044 - Refactor of Jetty WebSocket Upgrade Request/Response", "pr_createdAt": "2020-07-30T09:54:35Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/5101", "timeline": [{"oid": "5ff0ce4142ec7a18f9f24fae65a62bac1971776c", "url": "https://github.com/eclipse/jetty.project/commit/5ff0ce4142ec7a18f9f24fae65a62bac1971776c", "message": "Issue #5044 - implement is secure on DelegatedJettyClientUpgradeRequest\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-07-29T12:22:14Z", "type": "commit"}, {"oid": "414a0f35f9ab14ae75756bb84bafd378e9aecd53", "url": "https://github.com/eclipse/jetty.project/commit/414a0f35f9ab14ae75756bb84bafd378e9aecd53", "message": "Issue #5044 - move all setter methods on the UpgradeRequest interface to ClientUpgradeRequest\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-07-29T12:44:42Z", "type": "commit"}, {"oid": "9027e170955d8cd975e6d4fae49428a7a0aea3c9", "url": "https://github.com/eclipse/jetty.project/commit/9027e170955d8cd975e6d4fae49428a7a0aea3c9", "message": "Issue #5044 - rename the ClientUpgradeRequest to CoreClientUpgradeRequest\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-07-30T02:51:42Z", "type": "commit"}, {"oid": "3074aa7fae3b637409bfafa9f23ee16f1481fe0e", "url": "https://github.com/eclipse/jetty.project/commit/3074aa7fae3b637409bfafa9f23ee16f1481fe0e", "message": "Issue #5044 - Jetty Server upgrade request/response now implement the API interfaces\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-07-30T03:28:39Z", "type": "commit"}, {"oid": "ce8cb063ead5398a5e8c0d8b11cc7924dd214239", "url": "https://github.com/eclipse/jetty.project/commit/ce8cb063ead5398a5e8c0d8b11cc7924dd214239", "message": "Issue #5044 - extend Jetty WS API Request/Response interfaces for jetty-websocket-server\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-07-30T07:34:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkyODQ0Ng==", "url": "https://github.com/eclipse/jetty.project/pull/5101#discussion_r462928446", "bodyText": "The changes in this file specifically bother me, but I cannot articulate why (yet).", "author": "joakime", "createdAt": "2020-07-30T11:22:36Z", "path": "jetty-websocket/websocket-jetty-api/src/main/java/org/eclipse/jetty/websocket/api/UpgradeRequest.java", "diffHunk": "@@ -31,26 +31,6 @@\n  */\n public interface UpgradeRequest\n {\n-    /**\n-     * Add WebSocket Extension Configuration(s) to Upgrade Request.\n-     * <p>\n-     * This is merely the list of requested Extensions to use, see {@link UpgradeResponse#getExtensions()} for what was\n-     * negotiated\n-     *\n-     * @param configs the configuration(s) to add\n-     */\n-    void addExtensions(ExtensionConfig... configs);\n-\n-    /**\n-     * Add WebSocket Extension Configuration(s) to request\n-     * <p>\n-     * This is merely the list of requested Extensions to use, see {@link UpgradeResponse#getExtensions()} for what was\n-     * negotiated\n-     *\n-     * @param configs the configuration(s) to add\n-     */\n-    void addExtensions(String... configs);\n-", "originalCommit": "ce8cb063ead5398a5e8c0d8b11cc7924dd214239", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkyODg1Nw==", "url": "https://github.com/eclipse/jetty.project/pull/5101#discussion_r462928857", "bodyText": "Yeah ... this api interface being this useless is also a point of concern for me.", "author": "joakime", "createdAt": "2020-07-30T11:23:23Z", "path": "jetty-websocket/websocket-jetty-api/src/main/java/org/eclipse/jetty/websocket/api/UpgradeResponse.java", "diffHunk": "@@ -88,57 +79,4 @@\n      * @return the status code\n      */\n     int getStatusCode();\n-\n-    /**\n-     * Issue a forbidden upgrade response.\n-     * <p>\n-     * This means that the websocket endpoint was valid, but the conditions to use a WebSocket resulted in a forbidden\n-     * access.\n-     * <p>\n-     * Use this when the origin or authentication is invalid.\n-     *\n-     * @param message the short 1 line detail message about the forbidden response\n-     * @throws IOException if unable to send the forbidden\n-     */\n-    void sendForbidden(String message) throws IOException;\n-\n-    /**\n-     * Set the accepted WebSocket Protocol.\n-     *\n-     * @param protocol the protocol to list as accepted\n-     */\n-    void setAcceptedSubProtocol(String protocol);\n-\n-    /**\n-     * Set the list of extensions that are approved for use with this websocket.\n-     * <p>\n-     * Notes:\n-     * <ul>\n-     * <li>Per the spec you cannot add extensions that have not been seen in the {@link UpgradeRequest}, just remove\n-     * entries you don't want to use</li>\n-     * <li>If this is unused, or a null is passed, then the list negotiation will follow default behavior and use the\n-     * complete list of extensions that are\n-     * available in this WebSocket server implementation.</li>\n-     * </ul>\n-     *\n-     * @param extensions the list of extensions to use.\n-     */\n-    void setExtensions(List<ExtensionConfig> extensions);\n-\n-    /**\n-     * Set a header\n-     * <p>\n-     * Overrides previous value of header (if set)\n-     *\n-     * @param name the header name\n-     * @param value the header value\n-     */\n-    void setHeader(String name, String value);\n-\n-    /**\n-     * Set the HTTP Response status code\n-     *\n-     * @param statusCode the status code\n-     */\n-    void setStatusCode(int statusCode);", "originalCommit": "ce8cb063ead5398a5e8c0d8b11cc7924dd214239", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk1MjgxNw==", "url": "https://github.com/eclipse/jetty.project/pull/5101#discussion_r462952817", "bodyText": "Why is it now useless? it still has all the getters.\nI could combine this interface with the Server extension of it, but all these methods on the client side would just be implemented with UnsupportedOperationException.\nThe same issue goes for the setters on the ClientUpgradeRequest which are not in the UpgradeRequest interface, as they would be unimplementable on the server side.", "author": "lachlan-roberts", "createdAt": "2020-07-30T12:14:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjkyODg1Nw=="}], "type": "inlineReview"}, {"oid": "fd5c07eceba5ad41b6172b0f2182e868b17284aa", "url": "https://github.com/eclipse/jetty.project/commit/fd5c07eceba5ad41b6172b0f2182e868b17284aa", "message": "removed dangling javadoc comment\n\nSigned-off-by: Lachlan Roberts <lachlan@webtide.com>", "committedDate": "2020-08-05T22:25:40Z", "type": "commit"}]}