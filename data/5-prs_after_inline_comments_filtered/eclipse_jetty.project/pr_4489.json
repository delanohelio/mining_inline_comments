{"pr_number": 4489, "pr_title": "Fixes #2643 - Switch SslContextFactory.keystoreType from JKS to PKCS12.", "pr_createdAt": "2020-01-17T08:50:18Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/4489", "timeline": [{"oid": "d60b4459bf16e710b66a74cebd1e4e8b7a48f515", "url": "https://github.com/eclipse/jetty.project/commit/d60b4459bf16e710b66a74cebd1e4e8b7a48f515", "message": "Fixes #2643 - Switch SslContextFactory.keystoreType from JKS to PKCS12.\n\nUpdated old keystores to new PKCS12 keystores.\nRemoved unused keystores and truststores.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>", "committedDate": "2020-01-17T08:48:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAyMTA3OQ==", "url": "https://github.com/eclipse/jetty.project/pull/4489#discussion_r373021079", "bodyText": "shall we not use obfuscation at all?", "author": "gregw", "createdAt": "2020-01-30T15:34:30Z", "path": "jetty-alpn/jetty-alpn-conscrypt-server/src/test/java/org/eclipse/jetty/alpn/conscrypt/server/ConscryptHTTP2ServerTest.java", "diffHunk": "@@ -79,11 +79,9 @@\n     private void configureSslContextFactory(SslContextFactory sslContextFactory)\n     {\n         Path path = Paths.get(\"src\", \"test\", \"resources\");\n-        File keys = path.resolve(\"keystore\").toFile();\n+        File keys = path.resolve(\"keystore.p12\").toFile();\n         sslContextFactory.setKeyStorePath(keys.getAbsolutePath());\n-        sslContextFactory.setKeyManagerPassword(\"OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4\");\n-        sslContextFactory.setTrustStorePath(keys.getAbsolutePath());\n-        sslContextFactory.setTrustStorePassword(\"OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4\");\n+        sslContextFactory.setKeyStorePassword(\"OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4\");", "originalCommit": "d60b4459bf16e710b66a74cebd1e4e8b7a48f515", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA1NTA3MA==", "url": "https://github.com/eclipse/jetty.project/pull/4489#discussion_r373055070", "bodyText": "No, it's just a test.", "author": "sbordet", "createdAt": "2020-01-30T16:29:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAyMTA3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA3NDI1Ng==", "url": "https://github.com/eclipse/jetty.project/pull/4489#discussion_r373074256", "bodyText": "but we use the password directly sometimes and obfuscate others.   We should just do one or the other everywhere.... but not really important.", "author": "gregw", "createdAt": "2020-01-30T17:01:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAyMTA3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA5NzA4Ng==", "url": "https://github.com/eclipse/jetty.project/pull/4489#discussion_r373097086", "bodyText": "I updated the tests to never use obfuscated passwords, which are now only used in specific tests and in configuration files (e.g. realm.properties, *.mod files, etc.).", "author": "sbordet", "createdAt": "2020-01-30T17:46:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAyMTA3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAyMjA5Nw==", "url": "https://github.com/eclipse/jetty.project/pull/4489#discussion_r373022097", "bodyText": "no obfuscation", "author": "gregw", "createdAt": "2020-01-30T15:36:15Z", "path": "jetty-osgi/test-jetty-osgi/src/test/java/org/eclipse/jetty/osgi/test/TestJettyOSGiBootHTTP2Conscrypt.java", "diffHunk": "@@ -135,13 +135,13 @@ public void testHTTP2() throws Exception\n             assertNotNull(port);\n \n             Path path = Paths.get(\"src\", \"test\", \"config\");\n-            File keys = path.resolve(\"etc\").resolve(\"keystore\").toFile();\n+            File keys = path.resolve(\"etc\").resolve(\"keystore.p12\").toFile();\n \n             ClientConnector clientConnector = new ClientConnector();\n             SslContextFactory.Client sslContextFactory = new SslContextFactory.Client();\n-            sslContextFactory.setKeyManagerPassword(\"OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4\");\n-            sslContextFactory.setTrustStorePath(keys.getAbsolutePath());\n             sslContextFactory.setKeyStorePath(keys.getAbsolutePath());\n+            sslContextFactory.setKeyStorePassword(\"OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4\");", "originalCommit": "d60b4459bf16e710b66a74cebd1e4e8b7a48f515", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAyNDYxNg==", "url": "https://github.com/eclipse/jetty.project/pull/4489#discussion_r373024616", "bodyText": "can we lose the ../../..?", "author": "gregw", "createdAt": "2020-01-30T15:40:18Z", "path": "tests/test-integration/src/test/java/org/eclipse/jetty/test/HttpInputIntegrationTest.java", "diffHunk": "@@ -104,9 +104,8 @@ public static void beforeClass() throws Exception\n         // SSL Context Factory for HTTPS and HTTP/2\n         String jettyDistro = System.getProperty(\"jetty.distro\", \"../../jetty-distribution/target/distribution\");\n         __sslContextFactory = new SslContextFactory.Server();\n-        __sslContextFactory.setKeyStorePath(jettyDistro + \"/../../../jetty-server/src/test/config/etc/keystore\");\n-        __sslContextFactory.setKeyStorePassword(\"OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4\");\n-        __sslContextFactory.setKeyManagerPassword(\"OBF:1u2u1wml1z7s1z7a1wnl1u2g\");\n+        __sslContextFactory.setKeyStorePath(jettyDistro + \"/../../../jetty-server/src/test/resources/keystore.p12\");", "originalCommit": "d60b4459bf16e710b66a74cebd1e4e8b7a48f515", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA2NTMyNg==", "url": "https://github.com/eclipse/jetty.project/pull/4489#discussion_r373065326", "bodyText": "Yes.", "author": "sbordet", "createdAt": "2020-01-30T16:46:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAyNDYxNg=="}], "type": "inlineReview"}, {"oid": "4b9fec0cf3588b055eb6b12e237383828453c304", "url": "https://github.com/eclipse/jetty.project/commit/4b9fec0cf3588b055eb6b12e237383828453c304", "message": "Updates after review.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>", "committedDate": "2020-01-30T16:53:41Z", "type": "commit"}, {"oid": "8bd1a7f5bc41e4480e5834095d966e086a976ead", "url": "https://github.com/eclipse/jetty.project/commit/8bd1a7f5bc41e4480e5834095d966e086a976ead", "message": "Using only non-obfuscated passwords in tests.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>", "committedDate": "2020-01-30T17:48:08Z", "type": "commit"}]}