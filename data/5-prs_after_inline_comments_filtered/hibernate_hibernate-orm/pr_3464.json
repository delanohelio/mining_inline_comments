{"pr_number": 3464, "pr_title": "HHH-14108 - PADDED and DYNAMIC Batch loading strategies not compatible with the Enhanced Proxy feature", "pr_createdAt": "2020-07-15T20:31:35Z", "pr_url": "https://github.com/hibernate/hibernate-orm/pull/3464", "timeline": [{"oid": "1fda9b0136cab2380c749f587dedbb692efe71b3", "url": "https://github.com/hibernate/hibernate-orm/commit/1fda9b0136cab2380c749f587dedbb692efe71b3", "message": "HHH-14108 Add test for issue", "committedDate": "2020-07-16T11:42:24Z", "type": "commit"}, {"oid": "3642fdcda8e7f4eec067648340c0e029713418c7", "url": "https://github.com/hibernate/hibernate-orm/commit/3642fdcda8e7f4eec067648340c0e029713418c7", "message": "HHH-14108 PADDED and DYNAMIC Batch loading strategies not compatible with the Enhanced Proxy feature", "committedDate": "2020-07-16T11:42:24Z", "type": "commit"}, {"oid": "3642fdcda8e7f4eec067648340c0e029713418c7", "url": "https://github.com/hibernate/hibernate-orm/commit/3642fdcda8e7f4eec067648340c0e029713418c7", "message": "HHH-14108 PADDED and DYNAMIC Batch loading strategies not compatible with the Enhanced Proxy feature", "committedDate": "2020-07-16T11:42:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc5MTI3Mg==", "url": "https://github.com/hibernate/hibernate-orm/pull/3464#discussion_r455791272", "bodyText": "This looks a bit puzzling. Do you know why it was limited to \"merge\" fetch profiles?\nNow you're expanding the set of operations to all, but the test just wants the load. I see we only use this for \"merge\" and \"refresh\" BTW... I suppose there's not  something special about \"refresh\" that we need to take into account during this load opertion?", "author": "Sanne", "createdAt": "2020-07-16T13:37:03Z", "path": "hibernate-core/src/main/java/org/hibernate/loader/Loader.java", "diffHunk": "@@ -1666,38 +1663,34 @@ protected void instanceAlreadyLoaded(\n \t\t\t);\n \t\t}\n \n-\t\tif ( persister.getBytecodeEnhancementMetadata().isEnhancedForLazyLoading() && enhancementAsProxyEnabled ) {\n-\t\t\tif ( \"merge\".equals( session.getLoadQueryInfluencers().getInternalFetchProfile() ) ) {", "originalCommit": "3642fdcda8e7f4eec067648340c0e029713418c7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg2MTY0Mg==", "url": "https://github.com/hibernate/hibernate-orm/pull/3464#discussion_r455861642", "bodyText": "I do not remember the reason why it was limited to the merge fetch profile, for the test case the fetch profile value is null but we need to hydrate the entity state and I think anything special is needed in case of \"refresh\". basically in such a case we just hydrate the entity state with the value retrieved from the db.", "author": "dreab8", "createdAt": "2020-07-16T15:10:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc5MTI3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg5MDg0NA==", "url": "https://github.com/hibernate/hibernate-orm/pull/3464#discussion_r455890844", "bodyText": "great, thanks", "author": "Sanne", "createdAt": "2020-07-16T15:51:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc5MTI3Mg=="}], "type": "inlineReview"}]}