{"pr_number": 4946, "pr_title": "Add trace logging to transport", "pr_createdAt": "2020-07-13T03:37:33Z", "pr_url": "https://github.com/camunda-cloud/zeebe/pull/4946", "timeline": [{"oid": "adf13189b82538d25e5401b6e8e42bb4546838c8", "url": "https://github.com/camunda-cloud/zeebe/commit/adf13189b82538d25e5401b6e8e42bb4546838c8", "message": "chore(transport): add new trace logging to transport", "committedDate": "2020-07-11T12:02:17Z", "type": "commit"}, {"oid": "6be707a2be67ce84867cee03fac32511a7755814", "url": "https://github.com/camunda-cloud/zeebe/commit/6be707a2be67ce84867cee03fac32511a7755814", "message": "chore(transport): add trace logging to server", "committedDate": "2020-07-13T03:32:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMDczNw==", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#discussion_r453530737", "bodyText": "Maybe wrap in isTraceEnabled()", "author": "pihme", "createdAt": "2020-07-13T09:50:12Z", "path": "transport/src/main/java/io/zeebe/transport/impl/AtomixClientTransportAdapter.java", "diffHunk": "@@ -111,6 +126,12 @@ private void tryToSend(final RequestContext requestContext) {\n       return;\n     }\n \n+    LOG.trace(", "originalCommit": "6be707a2be67ce84867cee03fac32511a7755814", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMTM0OQ==", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#discussion_r453531349", "bodyText": "Maybe wrap in isTraceEnabled(). Also at other places in this class", "author": "pihme", "createdAt": "2020-07-13T09:51:13Z", "path": "transport/src/main/java/io/zeebe/transport/impl/AtomixClientTransportAdapter.java", "diffHunk": "@@ -122,14 +143,21 @@ private void tryToSend(final RequestContext requestContext) {\n   private void handleResponse(\n       final RequestContext requestContext, final byte[] response, final Throwable errorOnRequest) {\n     if (requestContext.isDone()) {\n+      LOG.trace(\"Handle response, but request {} is already done\", requestContext.hashCode());", "originalCommit": "6be707a2be67ce84867cee03fac32511a7755814", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMTk2MQ==", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#discussion_r453531961", "bodyText": "Maybe wrp in \u00ecsTraceEnabled() also at other places in this class", "author": "pihme", "createdAt": "2020-07-13T09:52:10Z", "path": "transport/src/main/java/io/zeebe/transport/impl/AtomixServerTransport.java", "diffHunk": "@@ -68,9 +65,11 @@ public void close() {\n   public ActorFuture<Void> subscribe(final int partitionId, final RequestHandler requestHandler) {\n     return actor.call(\n         () -> {\n+          final var topicName = topicName(partitionId);\n+          LOG.trace(\"Subscribe for topic {}\", topicName);", "originalCommit": "6be707a2be67ce84867cee03fac32511a7755814", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzNDE2MA==", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#discussion_r453534160", "bodyText": "actually this is done by ZbLogger as far as I know", "author": "Zelldon", "createdAt": "2020-07-13T09:55:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMTk2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzNTk5Nw==", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#discussion_r453535997", "bodyText": "No, it is not. ZBLogger will prevent it from being logged (which ordinary loggers do anyways), but still the string will need to be composed, which can be expensive.\nIn newer logging implementation you often find lambdas:\nLOG.trace(() -> calculateLongString()) which circumvent this once and for all. But these methods aren't available in Logger", "author": "pihme", "createdAt": "2020-07-13T09:58:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMTk2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0MzI1OQ==", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#discussion_r453543259", "bodyText": "ok get what you mean thanks", "author": "Zelldon", "createdAt": "2020-07-13T10:11:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMTk2MQ=="}], "type": "inlineReview"}, {"oid": "daa7adcdc180a6a346b97e138c8538b91282f4dd", "url": "https://github.com/camunda-cloud/zeebe/commit/daa7adcdc180a6a346b97e138c8538b91282f4dd", "message": "chore(transport): check whether trace is enabled", "committedDate": "2020-07-15T04:55:31Z", "type": "commit"}, {"oid": "daa7adcdc180a6a346b97e138c8538b91282f4dd", "url": "https://github.com/camunda-cloud/zeebe/commit/daa7adcdc180a6a346b97e138c8538b91282f4dd", "message": "chore(transport): check whether trace is enabled", "committedDate": "2020-07-15T04:55:31Z", "type": "forcePushed"}]}