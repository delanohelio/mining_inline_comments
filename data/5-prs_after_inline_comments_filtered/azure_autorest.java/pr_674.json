{"pr_number": 674, "pr_title": "Create options model for optional parameters in client methods", "pr_createdAt": "2020-08-04T21:07:37Z", "pr_url": "https://github.com/Azure/autorest.java/pull/674", "timeline": [{"oid": "f7074f477534b16c46f0cef71f60ff32e33da557", "url": "https://github.com/Azure/autorest.java/commit/f7074f477534b16c46f0cef71f60ff32e33da557", "message": "collapse optional parameters in client method into an options model; generate options model", "committedDate": "2020-08-04T21:03:46Z", "type": "commit"}, {"oid": "28ca01dec1a44ab1a629c311b0a1c1e1e772dd76", "url": "https://github.com/Azure/autorest.java/commit/28ca01dec1a44ab1a629c311b0a1c1e1e772dd76", "message": "Remove import *", "committedDate": "2020-08-04T21:50:01Z", "type": "commit"}, {"oid": "685762ed2ae5262e0a00fb329fe9229f42aa28cc", "url": "https://github.com/Azure/autorest.java/commit/685762ed2ae5262e0a00fb329fe9229f42aa28cc", "message": "Handle more than one methods with optional parameters", "committedDate": "2020-08-04T22:59:55Z", "type": "commit"}, {"oid": "e79ead85bba05e53590053487b52f5dead912f42", "url": "https://github.com/Azure/autorest.java/commit/e79ead85bba05e53590053487b52f5dead912f42", "message": "Handle more than one methods with optional parameters in a better way", "committedDate": "2020-08-04T23:16:03Z", "type": "commit"}, {"oid": "0963a385ddb45b378fd497c52f7b50031a872071", "url": "https://github.com/Azure/autorest.java/commit/0963a385ddb45b378fd497c52f7b50031a872071", "message": "Add java doc for optional parameter in clients", "committedDate": "2020-08-04T23:32:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ0MDE5Nw==", "url": "https://github.com/Azure/autorest.java/pull/674#discussion_r465440197", "bodyText": "Seems better just have a getOptionsModels and return the List of ClientModels, easier to understand what it for, IMHO. Also please add javadoc.", "author": "weidongxu-microsoft", "createdAt": "2020-08-05T02:47:34Z", "path": "javagen/src/main/java/com/azure/autorest/mapper/ClientMethodMapper.java", "diffHunk": "@@ -42,13 +42,23 @@\n     private static ClientMethodMapper instance = new ClientMethodMapper();\n     private Map<Operation, List<ClientMethod>> parsed = new HashMap<>();\n \n-    private ClientMethodMapper() {\n+    protected ClientMethodMapper() {\n     }\n \n     public static ClientMethodMapper getInstance() {\n         return instance;\n     }\n \n+    public void addModelsTo(List<ClientModel> clientModels) {", "originalCommit": "0963a385ddb45b378fd497c52f7b50031a872071", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc1NDg5MA==", "url": "https://github.com/Azure/autorest.java/pull/674#discussion_r466754890", "bodyText": "I'm just trying to follow addImportsTo. :-) In fact, passing what existed already may give this class a chance to check for duplicates (as you suggested in other comment). If people want to be smarter in renaming the newly generated model, this is a chance for doing so.", "author": "JianpingChen", "createdAt": "2020-08-07T00:26:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ0MDE5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc4NjI2Ng==", "url": "https://github.com/Azure/autorest.java/pull/674#discussion_r466786266", "bodyText": "Sure. I've no strong opinion here.", "author": "weidongxu-microsoft", "createdAt": "2020-08-07T02:29:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ0MDE5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTY2OTgwNg==", "url": "https://github.com/Azure/autorest.java/pull/674#discussion_r465669806", "bodyText": "Will it happen that 2 method in different operation group get same name (likely for list etc.), which result in same model name for Options class?", "author": "weidongxu-microsoft", "createdAt": "2020-08-05T11:49:35Z", "path": "androidgen/src/main/java/com/azure/autorest/android/mapper/AndroidOptionalParameterMapper.java", "diffHunk": "@@ -0,0 +1,128 @@\n+package com.azure.autorest.android.mapper;\n+\n+import com.azure.autorest.extension.base.model.codemodel.Parameter;\n+import com.azure.autorest.mapper.Mappers;\n+import com.azure.autorest.model.clientmodel.ClientMethodParameter;\n+import com.azure.autorest.model.clientmodel.ClientModel;\n+import com.azure.autorest.model.clientmodel.ClientModelProperty;\n+import com.azure.autorest.model.clientmodel.IType;\n+import com.azure.autorest.util.CodeNamer;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+public class AndroidOptionalParameterMapper {\n+    private String packageName;\n+    private String methodName;\n+    private List<Parameter> parameters = new ArrayList<Parameter>();\n+\n+    public AndroidOptionalParameterMapper packageName(String packageName) {\n+        this.packageName = packageName;\n+        return this;\n+    }\n+    public AndroidOptionalParameterMapper methodName(String methodName) {\n+        this.methodName = methodName;\n+        return this;\n+    }\n+\n+    public AndroidOptionalParameterMapper parameters(List<Parameter> parameters) {\n+        this.parameters = parameters;\n+        return this;\n+    }\n+\n+    public boolean hasOptionalParameters() {\n+        return parameters.size() > 0;\n+    }\n+\n+    public String getModelTypeName() {\n+        return CodeNamer.toPascalCase(String.format(\"%1$sOptions\", methodName));", "originalCommit": "0963a385ddb45b378fd497c52f7b50031a872071", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk0NjAwOA==", "url": "https://github.com/Azure/autorest.java/pull/674#discussion_r465946008", "bodyText": "Valid concern but that's kind of the assumption we made above this level already. For example, if two operations at two different paths have the same \"operationId\", they will cause name clash in the client (even though may have different signatures). We can work around that by modifying the swagger file so that they have different operationId. Fixing this assumption in autorest requires a lot more effort than we can afford. I'll just take a note and investigate later.", "author": "JianpingChen", "createdAt": "2020-08-05T19:14:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTY2OTgwNg=="}], "type": "inlineReview"}, {"oid": "1b7bf4a81dfad2e71bee678a8e134254bd93229a", "url": "https://github.com/Azure/autorest.java/commit/1b7bf4a81dfad2e71bee678a8e134254bd93229a", "message": "Only generate options model when optional parameters are more than one", "committedDate": "2020-08-05T17:15:44Z", "type": "commit"}, {"oid": "7aebbf3a767c3e93496d3c1b27644e695e228eb8", "url": "https://github.com/Azure/autorest.java/commit/7aebbf3a767c3e93496d3c1b27644e695e228eb8", "message": "Add java doc for new methods introduced; remove an unused variable", "committedDate": "2020-08-05T19:15:30Z", "type": "commit"}]}