{"pr_number": 484, "pr_title": "support string constant", "pr_createdAt": "2020-01-15T08:02:51Z", "pr_url": "https://github.com/Azure/autorest.java/pull/484", "timeline": [{"oid": "31d8259de29931f54418981bca7ce8b2ab45e0b4", "url": "https://github.com/Azure/autorest.java/commit/31d8259de29931f54418981bca7ce8b2ab45e0b4", "message": "support string constant", "committedDate": "2020-01-15T08:02:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3OTc2Mw==", "url": "https://github.com/Azure/autorest.java/pull/484#discussion_r368379763", "bodyText": "Shouldn't isContant be true even is the valueType is not of type StringSchema? isConstant should be set to true if property.getSchema() instanceof ConstantSchema is true.", "author": "srnagar", "createdAt": "2020-01-20T05:58:41Z", "path": "javagen/src/main/java/com/azure/autorest/mapper/ModelPropertyMapper.java", "diffHunk": "@@ -87,6 +89,16 @@ public ClientModelProperty map(Property property) {\n             }\n         }\n \n+        boolean isConstant = false;\n+        String defaultValue = null;\n+        if (property.getSchema() instanceof ConstantSchema) {\n+            ConstantSchema constantSchema = (ConstantSchema) property.getSchema();\n+            if (constantSchema.getValueType() instanceof StringSchema) {\n+                isConstant = true;", "originalCommit": "31d8259de29931f54418981bca7ce8b2ab45e0b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM4MDc1Mw==", "url": "https://github.com/Azure/autorest.java/pull/484#discussion_r368380753", "bodyText": "Yes, it should be. The defaultValue would also be different in this non-string case, and also that ConstantSchema would probably get a Class of its own.\nThe problem here is that currently I do not have any case that have a constant which is not a string, Hence I only do for string (mostly to unblock our team converting on management-plane SDK to v2, like the one in commit).\nThat is reason I was asking\n\nDo we have any swagger test on constant model property?\n\nin #483\nIf you have any case (test, or real data-plane or management-plane swagger) that have a non-string constant, please do let me know. Thanks.", "author": "weidongxu-microsoft", "createdAt": "2020-01-20T06:04:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3OTc2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE4MTA3Nw==", "url": "https://github.com/Azure/autorest.java/pull/484#discussion_r369181077", "bodyText": "Well, I don't know of any swagger that has non-string constants but it should be fairly easy to create one. Take an existing swagger and replace one of the string constants with integer constants and update the schema for it.\nAlso, you can go ahead and merge this change as this can be tested and updated in a separate PR for non-string constants.", "author": "srnagar", "createdAt": "2020-01-21T18:52:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3OTc2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTMyNzUyMQ==", "url": "https://github.com/Azure/autorest.java/pull/484#discussion_r369327521", "bodyText": "Got it. I will try to test non-string constant a bit later (after holiday), maybe try stealing some test case from Garrett's repo :-).\nCurrently still busy converting fluent java to azure core.", "author": "weidongxu-microsoft", "createdAt": "2020-01-22T01:14:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3OTc2Mw=="}], "type": "inlineReview"}]}