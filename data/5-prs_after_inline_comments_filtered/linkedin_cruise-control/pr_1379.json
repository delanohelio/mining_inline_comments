{"pr_number": 1379, "pr_title": "Replace hardcoded millis value with the TimeUnit lib method", "pr_createdAt": "2020-11-04T20:15:28Z", "pr_url": "https://github.com/linkedin/cruise-control/pull/1379", "timeline": [{"oid": "80430d560f611be4b47876e135be9cf3caecc36d", "url": "https://github.com/linkedin/cruise-control/commit/80430d560f611be4b47876e135be9cf3caecc36d", "message": "Replace hardcoded millis value with the TimeUnit lib method", "committedDate": "2020-11-04T20:11:41Z", "type": "commit"}, {"oid": "5d02ad242a30a11f55493411a01bb98911101bf4", "url": "https://github.com/linkedin/cruise-control/commit/5d02ad242a30a11f55493411a01bb98911101bf4", "message": "Fix several missing places", "committedDate": "2020-11-04T22:07:46Z", "type": "commit"}, {"oid": "b33f936caf75edaa6f0f5807fadbdf439f5c76d9", "url": "https://github.com/linkedin/cruise-control/commit/b33f936caf75edaa6f0f5807fadbdf439f5c76d9", "message": "More places replaced", "committedDate": "2020-11-04T22:13:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzcwNzQ2MA==", "url": "https://github.com/linkedin/cruise-control/pull/1379#discussion_r517707460", "bodyText": "Nit (multiple occurrences in this class): Can we\n\nMove the hardcoded TimeUnit.SECONDS.toMillis(30) value to some static variable?\nUpdate the comments such as Check in 30 seconds to see... to avoid mentioning hardcoded times and refer to the static variable?", "author": "efeg", "createdAt": "2020-11-05T00:17:04Z", "path": "cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/analyzer/GoalOptimizer.java", "diffHunk": "@@ -143,11 +143,11 @@ public void run() {\n       if (loadMonitorTaskRunnerState == LOADING || loadMonitorTaskRunnerState == BOOTSTRAPPING) {\n         LOG.info(\"Skipping proposal precomputing because load monitor is in \" + loadMonitorTaskRunnerState + \" state.\");\n         // Check in 30 seconds to see if the load monitor state has changed.\n-        sleepTime = 30000L;\n+        sleepTime = TimeUnit.SECONDS.toMillis(30);\n       } else if (!_loadMonitor.meetCompletenessRequirements(_requirementsWithAvailableValidWindows)) {\n         LOG.info(\"Skipping proposal precomputing because load monitor does not have enough snapshots.\");\n         // Check in 30 seconds to see if the load monitor has sufficient number of snapshots.\n-        sleepTime = 30000L;\n+        sleepTime = TimeUnit.SECONDS.toMillis(30);\n       } else {\n         try {\n           if (!validCachedProposal()) {", "originalCommit": "b33f936caf75edaa6f0f5807fadbdf439f5c76d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM2MzQ4MQ==", "url": "https://github.com/linkedin/cruise-control/pull/1379#discussion_r518363481", "bodyText": "I used {@value HALF_MINUTE_IN_MS} to replace 30 seconds in comments", "author": "Lincong", "createdAt": "2020-11-05T21:04:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzcwNzQ2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzcxMzY5OA==", "url": "https://github.com/linkedin/cruise-control/pull/1379#discussion_r517713698", "bodyText": "Should we use hours?", "author": "efeg", "createdAt": "2020-11-05T00:38:15Z", "path": "cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/monitor/sampling/KafkaSampleStore.java", "diffHunk": "@@ -92,8 +92,8 @@\n   protected static final short DEFAULT_SAMPLE_STORE_TOPIC_REPLICATION_FACTOR = 2;\n   protected static final int DEFAULT_PARTITION_SAMPLE_STORE_TOPIC_PARTITION_COUNT = 32;\n   protected static final int DEFAULT_BROKER_SAMPLE_STORE_TOPIC_PARTITION_COUNT = 32;\n-  protected static final long DEFAULT_MIN_PARTITION_SAMPLE_STORE_TOPIC_RETENTION_TIME_MS = 3600000L;\n-  protected static final long DEFAULT_MIN_BROKER_SAMPLE_STORE_TOPIC_RETENTION_TIME_MS = 3600000L;\n+  protected static final long DEFAULT_MIN_PARTITION_SAMPLE_STORE_TOPIC_RETENTION_TIME_MS = TimeUnit.MINUTES.toMillis(60);\n+  protected static final long DEFAULT_MIN_BROKER_SAMPLE_STORE_TOPIC_RETENTION_TIME_MS = TimeUnit.MINUTES.toMillis(60);", "originalCommit": "b33f936caf75edaa6f0f5807fadbdf439f5c76d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM1ODgxMg==", "url": "https://github.com/linkedin/cruise-control/pull/1379#discussion_r518358812", "bodyText": "Yes", "author": "Lincong", "createdAt": "2020-11-05T20:55:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzcxMzY5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzcxNDQzNQ==", "url": "https://github.com/linkedin/cruise-control/pull/1379#discussion_r517714435", "bodyText": "(Not introduced in this patch): Can we rename this private variable to SAMPLING_INTERVAL_MS?", "author": "efeg", "createdAt": "2020-11-05T00:40:43Z", "path": "cruise-control/src/test/java/com/linkedin/kafka/cruisecontrol/monitor/task/LoadMonitorTaskRunnerTest.java", "diffHunk": "@@ -57,11 +57,11 @@\n  * The unit test for metric fetcher manager.\n  */\n public class LoadMonitorTaskRunnerTest extends CCKafkaIntegrationTestHarness {\n-  private static final long WINDOW_MS = 10000L;\n+  private static final long WINDOW_MS = TimeUnit.SECONDS.toMillis(10);\n   private static final int NUM_WINDOWS = 5;\n   private static final int NUM_TOPICS = 100;\n   private static final int NUM_PARTITIONS = 4;\n-  private static final long SAMPLING_INTERVAL = 100000L;\n+  private static final long SAMPLING_INTERVAL = TimeUnit.SECONDS.toMillis(100);", "originalCommit": "b33f936caf75edaa6f0f5807fadbdf439f5c76d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "093956e0d25674a19b90ef5b2313ac49f1da3f3a", "url": "https://github.com/linkedin/cruise-control/commit/093956e0d25674a19b90ef5b2313ac49f1da3f3a", "message": "Fixed several more", "committedDate": "2020-11-05T21:32:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQ0OTI4Nw==", "url": "https://github.com/linkedin/cruise-control/pull/1379#discussion_r518449287", "bodyText": "Nit: For variables in this package, we use the following naming convention:\n<config>_CONFIG\nDEAFULT_<config>\n<config>_DOC\n\nAdding this suffix only to the default value violates this convention.\nCan we either (1) apply the same suffix to the METADATA_MAX_AGE_CONFIG and METADATA_MAX_AGE_DOC or (2) rollback the name change?", "author": "efeg", "createdAt": "2020-11-06T00:18:49Z", "path": "cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/config/constants/MonitorConfig.java", "diffHunk": "@@ -44,7 +44,7 @@ private MonitorConfig() {\n    * <code>metadata.max.age.ms</code>\n    */\n   public static final String METADATA_MAX_AGE_CONFIG = CommonClientConfigs.METADATA_MAX_AGE_CONFIG;\n-  public static final long DEFAULT_METADATA_MAX_AGE = 55000L;", "originalCommit": "093956e0d25674a19b90ef5b2313ac49f1da3f3a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQ1MjgxNg==", "url": "https://github.com/linkedin/cruise-control/pull/1379#discussion_r518452816", "bodyText": "I changed METADATA_MAX_AGE_CONFIG to METADATA_MAX_AGE_MS_CONFIG and METADATA_MAX_AGE_DOC to METADATA_MAX_AGE_MS_DOC", "author": "Lincong", "createdAt": "2020-11-06T00:30:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQ0OTI4Nw=="}], "type": "inlineReview"}, {"oid": "e342bceb90fad7c4beb411ff4e74c798de388620", "url": "https://github.com/linkedin/cruise-control/commit/e342bceb90fad7c4beb411ff4e74c798de388620", "message": "Change metadata max age variable names", "committedDate": "2020-11-06T00:30:55Z", "type": "commit"}]}