{"pr_number": 2994, "pr_title": "CORE: Fixed possible null pointer", "pr_createdAt": "2020-11-23T09:45:13Z", "pr_url": "https://github.com/CESNET/perun/pull/2994", "timeline": [{"oid": "648575b48464642c80bcb8ae6b5784e7305e1e34", "url": "https://github.com/CESNET/perun/commit/648575b48464642c80bcb8ae6b5784e7305e1e34", "message": "CORE: Fixed possible null pointer\n\n- Make sure we return non-null string for stdout/stderr\n  when getting it from TaskExecutionException.\n- When creating TaskResult handle also null stderr.", "committedDate": "2020-11-23T09:41:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODY1ODgwNQ==", "url": "https://github.com/CESNET/perun/pull/2994#discussion_r528658805", "bodyText": "Not sure if empty string is correct result of \"getStd*\" methods.\nIMHO empty string feels like - \"There is an error but we don't get any text for it. Text is missing.\" What do you think @zlamalp ?", "author": "stavamichal", "createdAt": "2020-11-23T12:11:29Z", "path": "perun-engine/src/main/java/cz/metacentrum/perun/engine/exceptions/TaskExecutionException.java", "diffHunk": "@@ -82,15 +82,15 @@ public void setReturnCode(int returnCode) {\n \t}\n \n \tpublic String getStdout() {\n-\t\treturn stdout;\n+\t\treturn (this.stdout == null) ? \"\" : this.stdout;\n \t}\n \n \tpublic void setStdout(String stdout) {\n \t\tthis.stdout = stdout;\n \t}\n \n \tpublic String getStderr() {\n-\t\treturn stderr;\n+\t\treturn (this.stderr == null) ? \"\" : this.stderr;", "originalCommit": "648575b48464642c80bcb8ae6b5784e7305e1e34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODY2NjAxMw==", "url": "https://github.com/CESNET/perun/pull/2994#discussion_r528666013", "bodyText": "@stavamichal Generally, you are probably right.\nIn this case I followed original implementation. We already do this with the outputs in AbstractWorker, which is responsible for actually running the scripts and taking their output. I'm not sure, where the null value came from, but null pointer was thrown on the row where only possible place is null in stderr String. So I wanted to prevent this globally, since it shouldn't happen. That is why I modified also createTaskResult() to take either null or empty string as OK and non-empty as warning.", "author": "zlamalp", "createdAt": "2020-11-23T12:24:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODY1ODgwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODY2Nzc2Mg==", "url": "https://github.com/CESNET/perun/pull/2994#discussion_r528667762", "bodyText": "Ok.", "author": "stavamichal", "createdAt": "2020-11-23T12:27:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODY1ODgwNQ=="}], "type": "inlineReview"}]}