{"pr_number": 2985, "pr_title": "Fixed sql preparation for get admins", "pr_createdAt": "2020-11-13T08:36:59Z", "pr_url": "https://github.com/CESNET/perun/pull/2985", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjg5MDgxNQ==", "url": "https://github.com/CESNET/perun/pull/2985#discussion_r522890815", "bodyText": "Is there any reason for these empty lines?", "author": "stavamichal", "createdAt": "2020-11-13T11:24:44Z", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/AuthzResolverBlImpl.java", "diffHunk": "@@ -1243,6 +1243,8 @@ public static void makeUserPerunAdmin(PerunSession sess, User user) throws Alrea\n \t\t\tthrow new RoleCannotBeManagedException(role, complementaryObject);\n \t\t}\n \n+\n+", "originalCommit": "07f494c664afdf2a73299988f870e78c994c56a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjg5ODc0MQ==", "url": "https://github.com/CESNET/perun/pull/2985#discussion_r522898741", "bodyText": "Fixed", "author": "balcirakpeter", "createdAt": "2020-11-13T11:42:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjg5MDgxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjg5MTQ1OA==", "url": "https://github.com/CESNET/perun/pull/2985#discussion_r522891458", "bodyText": "This is not the correct way how to name variables in Java.", "author": "stavamichal", "createdAt": "2020-11-13T11:26:08Z", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/AuthzResolverBlImpl.java", "diffHunk": "@@ -2129,11 +2131,19 @@ private static boolean objectAndRoleManageableByEntity(String entityToManage, Pe\n \t\t\tthrow new InternalErrorException(\"Management rules not exist for the role \" + role, e);\n \t\t}\n \n-\t\treturn createMappingOfValues(complementaryObject, role, rules);\n+\t\t//For reading a role it is enough to know role and the primary object.\n+\t\t//No need to fetch all related objects\n+\t\tMap<String, Integer> mapping = new HashMap<>();\n+\t\tInteger role_id = authzResolverImpl.getRoleId(role);", "originalCommit": "07f494c664afdf2a73299988f870e78c994c56a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjg5ODc3OQ==", "url": "https://github.com/CESNET/perun/pull/2985#discussion_r522898779", "bodyText": "Fixed", "author": "balcirakpeter", "createdAt": "2020-11-13T11:42:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjg5MTQ1OA=="}], "type": "inlineReview"}, {"oid": "9a4e4d6c0b7a849d0a2e2e54aff28afe85634153", "url": "https://github.com/CESNET/perun/commit/9a4e4d6c0b7a849d0a2e2e54aff28afe85634153", "message": "Fixed sql preparation for get admins\n\n- Generic method for geting admins is creating an sql from the given\n  information. There was a missing table specification for the columns in the where clause.\n  Therefore, it was added.\n-There was also problem that methods for geAdmins receive only id and\n object name for that. Therefore they were not able to fetch related\n objects. However they are not needed for select so the mapping was\n simplified.", "committedDate": "2020-11-13T11:41:37Z", "type": "commit"}, {"oid": "9a4e4d6c0b7a849d0a2e2e54aff28afe85634153", "url": "https://github.com/CESNET/perun/commit/9a4e4d6c0b7a849d0a2e2e54aff28afe85634153", "message": "Fixed sql preparation for get admins\n\n- Generic method for geting admins is creating an sql from the given\n  information. There was a missing table specification for the columns in the where clause.\n  Therefore, it was added.\n-There was also problem that methods for geAdmins receive only id and\n object name for that. Therefore they were not able to fetch related\n objects. However they are not needed for select so the mapping was\n simplified.", "committedDate": "2020-11-13T11:41:37Z", "type": "forcePushed"}]}