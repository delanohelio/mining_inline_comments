{"pr_number": 9318, "pr_title": "CB-8979 - added tracing for salt api calls", "pr_createdAt": "2020-10-28T14:40:40Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9318", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxNTA5MA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9318#discussion_r513515090", "bodyText": "most salt calls happens using /saltapi/run. see SaltEndpoint#SALT_RUN\nthis way StringUtils.substringAfterLast will return an empty string", "author": "lacikaaa", "createdAt": "2020-10-28T14:59:22Z", "path": "orchestrator-salt/src/main/java/com/sequenceiq/cloudbreak/orchestrator/salt/client/TracingClientSpanDecorator.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.sequenceiq.cloudbreak.orchestrator.salt.client;\n+\n+import javax.ws.rs.client.ClientRequestContext;\n+import javax.ws.rs.client.ClientResponseContext;\n+\n+import org.apache.commons.lang3.StringUtils;\n+\n+import com.sequenceiq.cloudbreak.orchestrator.salt.domain.Pillar;\n+import com.sequenceiq.cloudbreak.tracing.TracingUtil;\n+\n+import io.opentracing.Span;\n+import io.opentracing.contrib.jaxrs2.client.ClientSpanDecorator;\n+\n+public class TracingClientSpanDecorator implements ClientSpanDecorator {\n+\n+    @Override\n+    public void decorateRequest(ClientRequestContext requestContext, Span span) {\n+        String uri = requestContext.getUri().toString();\n+        String saltPath = StringUtils.substringAfterLast(uri, \"/saltboot/\");", "originalCommit": "1ee5729ef857c1f5cbd1e771e55ce18e7c2d3b31", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUyNDE0Nw==", "url": "https://github.com/hortonworks/cloudbreak/pull/9318#discussion_r513524147", "bodyText": "this explains an anomaly I just saw in jaeger", "author": "attilapalfi92", "createdAt": "2020-10-28T15:10:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxNTA5MA=="}], "type": "inlineReview"}, {"oid": "07f2ba386574fd492034f95082b7da5841ec51e3", "url": "https://github.com/hortonworks/cloudbreak/commit/07f2ba386574fd492034f95082b7da5841ec51e3", "message": "CB-8979 - added tracing for salt api calls", "committedDate": "2020-10-28T17:15:47Z", "type": "forcePushed"}, {"oid": "428687aa9fb2349a0b695c1519b3b422c8abd44f", "url": "https://github.com/hortonworks/cloudbreak/commit/428687aa9fb2349a0b695c1519b3b422c8abd44f", "message": "CB-8979 - added tracing for salt api calls", "committedDate": "2020-10-28T17:41:28Z", "type": "forcePushed"}, {"oid": "6274b82c728ca6c4d78bcc984d5b68235e947497", "url": "https://github.com/hortonworks/cloudbreak/commit/6274b82c728ca6c4d78bcc984d5b68235e947497", "message": "CB-8979 - added tracing for salt api calls", "committedDate": "2020-10-28T17:52:33Z", "type": "forcePushed"}, {"oid": "05b846e7c7358b394203da44c04c36581d5644e5", "url": "https://github.com/hortonworks/cloudbreak/commit/05b846e7c7358b394203da44c04c36581d5644e5", "message": "CB-8979 - added tracing for salt api calls", "committedDate": "2020-10-28T19:46:59Z", "type": "forcePushed"}, {"oid": "7859efad55bae5e502c70e7dd729fba5ee7f02f3", "url": "https://github.com/hortonworks/cloudbreak/commit/7859efad55bae5e502c70e7dd729fba5ee7f02f3", "message": "CB-8979 - added tracing for salt api calls", "committedDate": "2020-10-29T08:57:51Z", "type": "forcePushed"}, {"oid": "e22870f877b16e4d27c4662688769687ca18813e", "url": "https://github.com/hortonworks/cloudbreak/commit/e22870f877b16e4d27c4662688769687ca18813e", "message": "CB-8979 - added tracing for salt api calls", "committedDate": "2020-10-29T10:04:08Z", "type": "commit"}, {"oid": "e22870f877b16e4d27c4662688769687ca18813e", "url": "https://github.com/hortonworks/cloudbreak/commit/e22870f877b16e4d27c4662688769687ca18813e", "message": "CB-8979 - added tracing for salt api calls", "committedDate": "2020-10-29T10:04:08Z", "type": "forcePushed"}]}