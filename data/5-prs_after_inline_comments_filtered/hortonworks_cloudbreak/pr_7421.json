{"pr_number": 7421, "pr_title": "Npe fix azure get network", "pr_createdAt": "2020-02-28T12:02:02Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/7421", "timeline": [{"oid": "f5caf5a51c83fac9c0601688094e5c1a64aef87b", "url": "https://github.com/hortonworks/cloudbreak/commit/f5caf5a51c83fac9c0601688094e5c1a64aef87b", "message": "CB-5832 handle null pointer in case of azure get network return null so the subnet does not exist on provide side", "committedDate": "2020-02-28T12:03:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY4Mzc3NQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#discussion_r385683775", "bodyText": "Minor: does in resource group, not sure what we're trying to say", "author": "keyki", "createdAt": "2020-02-28T13:04:27Z", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzurePlatformResources.java", "diffHunk": "@@ -96,8 +97,15 @@ public CloudNetworks networks(CloudCredential cloudCredential, Region region, Ma\n         String networkId = filters.get(\"networkId\");\n         String resourceGroupName = filters.get(\"resourceGroupName\");\n         if (!StringUtils.isEmpty(networkId) && !StringUtils.isEmpty(resourceGroupName)) {\n+            LOGGER.info(\"Query Network with id '{}' does in resource group {}\", networkId, resourceGroupName);", "originalCommit": "f5caf5a51c83fac9c0601688094e5c1a64aef87b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY4Mzk3Nw==", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#discussion_r385683977", "bodyText": "Same", "author": "keyki", "createdAt": "2020-02-28T13:05:00Z", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzurePlatformResources.java", "diffHunk": "@@ -96,8 +97,15 @@ public CloudNetworks networks(CloudCredential cloudCredential, Region region, Ma\n         String networkId = filters.get(\"networkId\");\n         String resourceGroupName = filters.get(\"resourceGroupName\");\n         if (!StringUtils.isEmpty(networkId) && !StringUtils.isEmpty(resourceGroupName)) {\n+            LOGGER.info(\"Query Network with id '{}' does in resource group {}\", networkId, resourceGroupName);\n             Network network = client.getNetworkByResourceGroup(resourceGroupName, networkId);\n-            addToResultIfRegionsAreMatch(region, result, network);\n+            if (network != null) {\n+                LOGGER.info(\"Network was successfully queried for  Network with id '{}' does in resource group {}: {}\",", "originalCommit": "f5caf5a51c83fac9c0601688094e5c1a64aef87b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY4NDMxNQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#discussion_r385684315", "bodyText": "%s does not work here.", "author": "keyki", "createdAt": "2020-02-28T13:05:51Z", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzurePlatformResources.java", "diffHunk": "@@ -110,13 +118,22 @@ public CloudNetworks networks(CloudCredential cloudCredential, Region region, Ma\n     }\n \n     private void addToResultIfRegionsAreMatch(Region region, Map<String, Set<CloudNetwork>> result, Network network) {\n-        String actualRegionLabel = network.region().label();\n-        String actualRegionName = network.region().name();\n-\n-        if (regionMatch(actualRegionLabel, region) || regionMatch(actualRegionName, region)) {\n-            CloudNetwork cloudNetwork = convertToCloudNetwork(network);\n-            result.computeIfAbsent(actualRegionLabel, s -> new HashSet<>()).add(cloudNetwork);\n-            result.computeIfAbsent(actualRegionName, s -> new HashSet<>()).add(cloudNetwork);\n+        if (network.region() != null) {\n+            String actualRegionLabel = network.region().label();\n+            String actualRegionName = network.region().name();\n+\n+            LOGGER.info(\"The region label '{}' and the region name '{}' are for Azure network id: {} name: {}\",\n+                    actualRegionLabel, actualRegionName, network.id(), network.name());\n+            if (regionMatch(actualRegionLabel, region) || regionMatch(actualRegionName, region)) {\n+                CloudNetwork cloudNetwork = convertToCloudNetwork(network);\n+                result.computeIfAbsent(actualRegionLabel, s -> new HashSet<>()).add(cloudNetwork);\n+                result.computeIfAbsent(actualRegionName, s -> new HashSet<>()).add(cloudNetwork);\n+            }\n+        } else {\n+            LOGGER.info(\"Network with id %s and name %s has no region which is not supported by CDP: {}\",", "originalCommit": "f5caf5a51c83fac9c0601688094e5c1a64aef87b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "87a1e69409f76603d534b24c93ca6f7c38931d38", "url": "https://github.com/hortonworks/cloudbreak/commit/87a1e69409f76603d534b24c93ca6f7c38931d38", "message": "CB-5832 handle null pointer in case of azure get network return null so the subnet does not exist on provide side", "committedDate": "2020-02-28T13:32:45Z", "type": "commit"}, {"oid": "87a1e69409f76603d534b24c93ca6f7c38931d38", "url": "https://github.com/hortonworks/cloudbreak/commit/87a1e69409f76603d534b24c93ca6f7c38931d38", "message": "CB-5832 handle null pointer in case of azure get network return null so the subnet does not exist on provide side", "committedDate": "2020-02-28T13:32:45Z", "type": "forcePushed"}]}