{"pr_number": 8965, "pr_title": "CB-8393: FreeIPA should provide more detailed log messages for cluster proxy errors", "pr_createdAt": "2020-09-09T18:13:50Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/8965", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgyNjI1MA==", "url": "https://github.com/hortonworks/cloudbreak/pull/8965#discussion_r485826250", "bodyText": "I think this should be an error level message rather than debug.", "author": "jamisonbennett", "createdAt": "2020-09-09T18:26:02Z", "path": "freeipa/src/main/java/com/sequenceiq/freeipa/service/polling/clusterproxy/ServiceEndpointHealthListenerTask.java", "diffHunk": "@@ -44,7 +44,16 @@ public boolean checkStatus(ServiceEndpointHealthPollerObject serviceEndpointHeal\n \n     @Override\n     public void handleTimeout(ServiceEndpointHealthPollerObject clusterProxyHealthPollerObject) {\n-        throw new CloudbreakServiceException(\"Operation timed out. Failed to check cluster proxy endpoint health.\");\n+        String clusterIdentifer = clusterProxyHealthPollerObject.getClusterIdentifier();\n+        String errorMessage;\n+        try {\n+            ClusterProxyRegistrationClient client = clusterProxyHealthPollerObject.getClient();\n+            errorMessage = client.readConfig(clusterIdentifer).toString();\n+        } catch (Exception e) {\n+            errorMessage = String.format(\"Failed to check cluster proxy endpoint health for %s, error: %s\", clusterIdentifer, e.getMessage());\n+            LOGGER.debug(errorMessage);", "originalCommit": "cdea85dc779f2695dec10b3ebdd22ceee3d48390", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgzMTA1OQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8965#discussion_r485831059", "bodyText": "Thank you! I've changed to LOGGER.error().", "author": "christmasferret", "createdAt": "2020-09-09T18:34:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgyNjI1MA=="}], "type": "inlineReview"}, {"oid": "b40af35f88e980e13c8339667bc8c0dec2f9e586", "url": "https://github.com/hortonworks/cloudbreak/commit/b40af35f88e980e13c8339667bc8c0dec2f9e586", "message": "CB-8393: FreeIPA should provide more detailed log messages for cluster proxy errors\n\nAdd FreeIPA instances' status details to log error messages as well as cloudera management console UI warnings when cluster proxy service errors out during FreeIPA provisioning. Currently, if FreeIPA creation fails, the error message (\"Operation timed out. Failed to check cluster proxy endpoint health.\") doesn't provide much information about the underlying instances from cloud provider. With this fix, the user will be able to see the actual status of failed instances.", "committedDate": "2020-09-09T18:32:15Z", "type": "commit"}, {"oid": "b40af35f88e980e13c8339667bc8c0dec2f9e586", "url": "https://github.com/hortonworks/cloudbreak/commit/b40af35f88e980e13c8339667bc8c0dec2f9e586", "message": "CB-8393: FreeIPA should provide more detailed log messages for cluster proxy errors\n\nAdd FreeIPA instances' status details to log error messages as well as cloudera management console UI warnings when cluster proxy service errors out during FreeIPA provisioning. Currently, if FreeIPA creation fails, the error message (\"Operation timed out. Failed to check cluster proxy endpoint health.\") doesn't provide much information about the underlying instances from cloud provider. With this fix, the user will be able to see the actual status of failed instances.", "committedDate": "2020-09-09T18:32:15Z", "type": "forcePushed"}]}