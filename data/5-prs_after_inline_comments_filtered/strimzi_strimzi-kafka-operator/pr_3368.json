{"pr_number": 3368, "pr_title": "Add option to select replica movement strategy for rebalances", "pr_createdAt": "2020-07-23T10:28:16Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTM5OTYzNg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r459399636", "bodyText": "do you think we could use a List<String> ? the order should be preserved when serialized/deserialized right? or am I wrong?", "author": "ppatierno", "createdAt": "2020-07-23T12:06:36Z", "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaRebalanceSpec.java", "diffHunk": "@@ -41,6 +41,7 @@\n     private int concurrentIntraBrokerPartitionMovements;\n     private int concurrentLeaderMovements;\n     private long replicationThrottle;\n+    private String replicaMovementStrategies;", "originalCommit": "b3cc8a836ff4d67c1a599ac980ca55aa295c70ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTQxMjMxNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r459412314", "bodyText": "The order should be preserved. This is like the goals list in the cruiseControl.spec.", "author": "tomncooper", "createdAt": "2020-07-23T12:30:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTM5OTYzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTQxMzc3Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r459413772", "bodyText": "So isn't it much better having a YAML array as we have for goals instead of a string with comma separated values? Just my 2 cents, but no need to change if you feel it's better in the current way. I just found YAML array a better fit for this field.", "author": "ppatierno", "createdAt": "2020-07-23T12:33:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTM5OTYzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTQxNTgzNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r459415837", "bodyText": "We don't have a YAML array for the goals config in the Kafka CR, we have a single comma separated string split over several lines:\ncruiseControl:\n    capacity:\n      networkIn: 10000KB/s\n      networkOut: 10000KB/s\n    config:\n      default.goals: >\n           com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n           com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal,\n           com.linkedin.kafka.cruisecontrol.analyzer.goals.DiskCapacityGoal", "author": "tomncooper", "createdAt": "2020-07-23T12:37:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTM5OTYzNg=="}], "type": "inlineReview"}, {"oid": "1878bb85d9927fe3d205c2d73480e6f0168d75d8", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1878bb85d9927fe3d205c2d73480e6f0168d75d8", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-07-23T16:11:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyMzc2NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r459623764", "bodyText": "Not a native speaker ... but totally random sounds very informal for documentation. I also doubt it is really random - i.e. randomizing the list of movements ... I guess it might be just as it is generated by some algo or something like that I guess. Wouldn't something like By default BaseReplicaMovementStrategy is used, which moves the replicas without any specific order. be a bit better?", "author": "scholzj", "createdAt": "2020-07-23T17:49:04Z", "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaRebalanceSpec.java", "diffHunk": "@@ -118,6 +119,15 @@ public void setReplicationThrottle(long bandwidth) {\n         this.replicationThrottle = bandwidth;\n     }\n \n+    @Description(\"A list of strategies used to determine the execution order for the generated optimization proposal. By default BaseReplicaMovementStrategy is used, which is totally random.\")", "originalCommit": "1878bb85d9927fe3d205c2d73480e6f0168d75d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTY5OTEwOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r459699109", "bodyText": "Agreed with Jakub here, his wording looks good to me, or if it is truly random (or atleast different with the same input) - then it might be worth saying it is non-deterministic", "author": "samuel-hawker", "createdAt": "2020-07-23T20:08:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyMzc2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkyODU4Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r459928583", "bodyText": "Sorry, this is copy of CC's wording, which I removed from other docstrings but didn't change here. I will change it.", "author": "tomncooper", "createdAt": "2020-07-24T08:49:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyMzc2NA=="}], "type": "inlineReview"}, {"oid": "a742c5e8dc84e50c5e8fd10ebbab66a2f16e3c12", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a742c5e8dc84e50c5e8fd10ebbab66a2f16e3c12", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-07-24T09:10:44Z", "type": "forcePushed"}, {"oid": "3f4b2da05024220ed30e64b3bb8ed0f6986046fd", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3f4b2da05024220ed30e64b3bb8ed0f6986046fd", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-07-24T09:41:59Z", "type": "forcePushed"}, {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/82635e5bcc77c670fb19b51e7864140be6dc1326", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-07-29T11:17:29Z", "type": "forcePushed"}, {"oid": "fa3dec825953413d4c55dfbedfde192dae8cb40a", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/fa3dec825953413d4c55dfbedfde192dae8cb40a", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-07-31T15:28:23Z", "type": "commit"}, {"oid": "fa3dec825953413d4c55dfbedfde192dae8cb40a", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/fa3dec825953413d4c55dfbedfde192dae8cb40a", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-07-31T15:28:23Z", "type": "forcePushed"}]}