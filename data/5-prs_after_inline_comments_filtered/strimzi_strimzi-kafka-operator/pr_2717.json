{"pr_number": 2717, "pr_title": "[MO] - [refactor] -> 2nd part of removing dependecy ", "pr_createdAt": "2020-03-19T12:40:07Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2717", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQ2NTM2NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2717#discussion_r395465365", "bodyText": "It's not \"always\" internal client right? It depends on the specific IKafkaClient instance.", "author": "ppatierno", "createdAt": "2020-03-20T07:09:28Z", "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/ClientUtils.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.utils;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.kafkaclients.IKafkaClient;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import java.io.IOException;\n+import java.util.Random;\n+\n+/**\n+ * ClientUtils class, which provides static methods for the all type clients\n+ * @see io.strimzi.systemtest.kafkaclients.externalClients.OauthKafkaClient\n+ * @see io.strimzi.systemtest.kafkaclients.externalClients.TracingKafkaClient\n+ * @see io.strimzi.systemtest.kafkaclients.externalClients.KafkaClient\n+ * @see io.strimzi.systemtest.kafkaclients.internalClients.InternalKafkaClient\n+ */\n+public class ClientUtils {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(ClientUtils.class);\n+\n+    // ensuring that object can not be created outside of class\n+    private ClientUtils() {}\n+\n+    // TODO: all topicName, namespace, clusterName, userName should be removed after -> https://github.com/strimzi/strimzi-kafka-operator/pull/2520\n+    public static void waitUntilClientReceivedMessagesTls(IKafkaClient<Integer> kafkaClient, String topicName, String namespace,\n+                                                       String clusterName, String userName, int exceptedMessages) {\n+        TestUtils.waitFor(\"Internal kafka client received messages\", Constants.GLOBAL_CLIENTS_POLL, Constants.GLOBAL_TIMEOUT,", "originalCommit": "4dcaea845e6e422841e0c630e3be290f70934f79", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQ5MzkwNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2717#discussion_r395493905", "bodyText": "Och well, good catch Paolo.", "author": "see-quick", "createdAt": "2020-03-20T08:31:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQ2NTM2NQ=="}], "type": "inlineReview"}, {"oid": "d746d17518e02ad1a3fb2663200c6479781a9116", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d746d17518e02ad1a3fb2663200c6479781a9116", "message": "[MO] - [refactor] -> finalf\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-20T08:39:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTgyOTYyMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2717#discussion_r395829623", "bodyText": "Just thinking...shouldn't be this in PodUtils ?", "author": "Frawless", "createdAt": "2020-03-20T18:49:02Z", "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/StUtils.java", "diffHunk": "@@ -48,14 +48,35 @@\n \n     private StUtils() { }\n \n-    public static void waitForReconciliation(String testClass, String testName, String namespace) {\n-        LOGGER.info(\"Waiting for reconciliation\");\n-        String reconciliation = timeMeasuringSystem.startOperation(Operation.NEXT_RECONCILIATION);\n-        TestUtils.waitFor(\"Wait till another rolling update starts\", Constants.CO_OPERATION_TIMEOUT_POLL, Constants.RECONCILIATION_INTERVAL + 30000,\n-            () -> !cmdKubeClient().searchInLog(\"deploy\", \"strimzi-cluster-operator\",\n-                timeMeasuringSystem.getCurrentDuration(testClass, testName, reconciliation),\n-                \"'Triggering periodic reconciliation for namespace \" + namespace + \"'\").isEmpty());\n-        timeMeasuringSystem.stopOperation(reconciliation);\n+    /**\n+     * Method waitForPodsStability ensuring for every pod listed for kafka or zookeeper statefulSet will be controlling\n+     * their status in Running phase. If the pod will be running for selected time #Constants.GLOBAL_RECONCILIATION_COUNT\n+     * pod is considered as a stable. Otherwise this procedure will be repeat.\n+     * @param pods all pods that will be verified\n+     */\n+    public static void waitUntilPodsStability(List<Pod> pods) {", "originalCommit": "7dd497a48b83c1bee1b75ec8ab4ece038b68d037", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzA3NzIxMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2717#discussion_r397077212", "bodyText": "fair point.. done )", "author": "see-quick", "createdAt": "2020-03-24T11:20:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTgyOTYyMw=="}], "type": "inlineReview"}, {"oid": "7bb7cecbbf4c40513145d0e26529bac45c3db42c", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7bb7cecbbf4c40513145d0e26529bac45c3db42c", "message": "[MO] - [refactor] -> 2st part of removing dependency of logs\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:36:52Z", "type": "commit"}, {"oid": "43e9396b3c2fedc4af5b50d8333226d4fed9ca89", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/43e9396b3c2fedc4af5b50d8333226d4fed9ca89", "message": "[MO] - [refactor] -> finished removal\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "3fd13e1a584920dd18ffb4d076c128c821b03cfa", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3fd13e1a584920dd18ffb4d076c128c821b03cfa", "message": "[MO] - [refactor] -> update\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "b8bb0dfb8195e7768a92789282ed40ccf30bf04f", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b8bb0dfb8195e7768a92789282ed40ccf30bf04f", "message": "[MO] - [refactor] -> final\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "2c68098d49f34d6752dc5b44190132ebee5db898", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2c68098d49f34d6752dc5b44190132ebee5db898", "message": "[MO] - [refactor] -> finalf\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "e821acb5409ab60c041830b606f7d8d03d4ccc3e", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e821acb5409ab60c041830b606f7d8d03d4ccc3e", "message": "[MO] - [rebase] -> conflicts\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "bdc7627471b57549ac67068fab5fabb07b53dd54", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/bdc7627471b57549ac67068fab5fabb07b53dd54", "message": "[MO] - [refactor] -> commends\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "f6ef08b2656090e47d95eec52d9097772f6f2a01", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f6ef08b2656090e47d95eec52d9097772f6f2a01", "message": "[MO] - [refactor] -> update\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "af6d2589cd39545e5c8c64241c3d447c7e737f04", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/af6d2589cd39545e5c8c64241c3d447c7e737f04", "message": "[MO] - [update] -> fix\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "5a9d1be9acd40f844a36b66c3ebe5725aa612905", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/5a9d1be9acd40f844a36b66c3ebe5725aa612905", "message": "[MO] - [update] -> race condition\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "911acbbe9248f09fb02804edd86bf620a51ca484", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/911acbbe9248f09fb02804edd86bf620a51ca484", "message": "[MO] - [commend] -> solve;\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:37:50Z", "type": "commit"}, {"oid": "27358870e7e9c0c4edbab9ce27b67f4ab03638c4", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/27358870e7e9c0c4edbab9ce27b67f4ab03638c4", "message": "[MO] - [rebase] -> done\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:41:28Z", "type": "commit"}, {"oid": "27358870e7e9c0c4edbab9ce27b67f4ab03638c4", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/27358870e7e9c0c4edbab9ce27b67f4ab03638c4", "message": "[MO] - [rebase] -> done\n\nSigned-off-by: morsak <xorsak02@stud.fit.vutbr.cz>", "committedDate": "2020-03-24T11:41:28Z", "type": "forcePushed"}]}