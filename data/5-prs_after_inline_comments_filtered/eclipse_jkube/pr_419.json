{"pr_number": 419, "pr_title": "RouteEnricher doesn't merge route fragment when it's the only fragment", "pr_createdAt": "2020-09-30T15:34:16Z", "pr_url": "https://github.com/eclipse/jkube/pull/419", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzYxODM4NA==", "url": "https://github.com/eclipse/jkube/pull/419#discussion_r497618384", "bodyText": "This is starting to look very confusing.\nTry to refactor into things that are more understandable.\nThe method name gives no clue of what you're doing (it made sense when it was a @Before clause and all methods depended on it, now it doesn't).\nIf you are adding something to the list builder, then add it in the tests where is applicable, or use a different KLB where it's not:\n// Option 1\n// Given\nsetUpThingiesWithEmptyKLB();\nklb.addToTiems(getMockServiceBuilder().build());\n\n// vs Option 2\n// Given\nsetupThingiesIncludingDefaultKLB();\nfinal KubernetesListBuilder specificKLB = new KubernetesListBuilder();\n...\n\nThe point of tests, besides verifying the code, is to understand what the code does with a quick glimpse.", "author": "manusa", "createdAt": "2020-09-30T15:50:42Z", "path": "jkube-kit/enricher/generic/src/test/java/org/eclipse/jkube/enricher/generic/openshift/RouteEnricherTest.java", "diffHunk": "@@ -44,24 +44,26 @@\n     private ProcessorConfig processorConfig;\n     private KubernetesListBuilder klb;\n \n-    public void setUpExpectations() {\n+    public void setUpExpectations(boolean shouldAddMockServiceToBuilder) {\n         properties = new Properties();\n         processorConfig = new ProcessorConfig();\n         klb = new KubernetesListBuilder();\n         // @formatter:off\n-        klb.addToItems(getMockServiceBuilder()\n-            .build());\n         new Expectations() {{\n             context.getProperties(); result = properties;\n             context.getConfiguration().getProcessorConfig(); result = processorConfig;\n         }};\n         // @formatter:on\n+        if (shouldAddMockServiceToBuilder) {\n+            klb.addToItems(getMockServiceBuilder()\n+                    .build());\n+        }", "originalCommit": "7d301a0e35f20fdf6ed50d8982c14dfa49f1aa16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f9b36b266e9947bd1186458186347358eba722de", "url": "https://github.com/eclipse/jkube/commit/f9b36b266e9947bd1186458186347358eba722de", "message": "RouteEnricher doesn't merge route fragment when it's the only fragment\n\nFix bug in merge fragment with opinionated route regarding array indexing, 0th\nindex wasn't considered while comparison", "committedDate": "2020-09-30T16:03:57Z", "type": "forcePushed"}, {"oid": "d4885c24a6adb018052004f32e7c4dd9ecbe26e7", "url": "https://github.com/eclipse/jkube/commit/d4885c24a6adb018052004f32e7c4dd9ecbe26e7", "message": "RouteEnricher doesn't merge route fragment when it's the only fragment\n\nFix bug in merge fragment with opinionated route regarding array indexing, 0th\nindex wasn't considered while comparison", "committedDate": "2020-10-01T14:37:58Z", "type": "forcePushed"}, {"oid": "a5db5a24b861a7b17199ccefed9c66d9973be2ef", "url": "https://github.com/eclipse/jkube/commit/a5db5a24b861a7b17199ccefed9c66d9973be2ef", "message": "RouteEnricher doesn't merge route fragment when it's the only fragment\n\nFix bug in merge fragment with opinionated route regarding array indexing, 0th\nindex wasn't considered while comparison", "committedDate": "2020-10-05T08:24:26Z", "type": "commit"}, {"oid": "a5db5a24b861a7b17199ccefed9c66d9973be2ef", "url": "https://github.com/eclipse/jkube/commit/a5db5a24b861a7b17199ccefed9c66d9973be2ef", "message": "RouteEnricher doesn't merge route fragment when it's the only fragment\n\nFix bug in merge fragment with opinionated route regarding array indexing, 0th\nindex wasn't considered while comparison", "committedDate": "2020-10-05T08:24:26Z", "type": "forcePushed"}]}