{"pr_number": 447, "pr_title": "fix: Removed misleading watch-postGoal warning + fixed rolling update in DockerImageWatcher", "pr_createdAt": "2020-10-22T13:41:02Z", "pr_url": "https://github.com/eclipse/jkube/pull/447", "timeline": [{"oid": "ecaaafd5e5e30b3026deffdf4c8709deea1ba06d", "url": "https://github.com/eclipse/jkube/commit/ecaaafd5e5e30b3026deffdf4c8709deea1ba06d", "message": "fix: Removed misleading watch-postGoal warning + fixed rolling update in DockerImageWatcher\n\nSigned-off-by: Marc Nuri <marc@marcnuri.com>", "committedDate": "2020-10-22T13:57:16Z", "type": "forcePushed"}, {"oid": "48f17267cbf2b3bbe6b209cf52b941bf49383b39", "url": "https://github.com/eclipse/jkube/commit/48f17267cbf2b3bbe6b209cf52b941bf49383b39", "message": "fix: Removed misleading watch-postGoal warning + fixed rolling update in DockerImageWatcher\n\nSigned-off-by: Marc Nuri <marc@marcnuri.com>", "committedDate": "2020-10-22T15:42:13Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNDUzNA==", "url": "https://github.com/eclipse/jkube/pull/447#discussion_r512434534", "bodyText": "Umm, why is this required? As far as I remember replace() also triggers rolling update", "author": "rohanKanojia", "createdAt": "2020-10-27T06:00:59Z", "path": "jkube-kit/watcher/standard/src/main/java/org/eclipse/jkube/watcher/standard/DockerImageWatcher.java", "diffHunk": "@@ -145,38 +145,33 @@ private void updateImageName(KubernetesClient kubernetes, String namespace, HasM\n         if (entity instanceof Deployment) {\n             Deployment resource = (Deployment) entity;\n             DeploymentSpec spec = resource.getSpec();\n-            if (spec != null) {\n-                if (updateImageName(entity, spec.getTemplate(), imagePrefix, imageName)) {\n-                    kubernetes.apps().deployments().inNamespace(namespace).withName(name).replace(resource);\n-                }\n+            if (spec != null && updateImageName(entity, spec.getTemplate(), imagePrefix, imageName)) {\n+                kubernetes.apps().deployments().inNamespace(namespace).withName(name).replace(resource);\n+                kubernetes.apps().deployments().inNamespace(namespace).withName(name).rolling().restart();", "originalCommit": "48f17267cbf2b3bbe6b209cf52b941bf49383b39", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNjE1OA==", "url": "https://github.com/eclipse/jkube/pull/447#discussion_r512436158", "bodyText": "It doesn't, at least in this version. Check the code, maybe I missed something.", "author": "manusa", "createdAt": "2020-10-27T06:06:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNDUzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTAwNTA5Nw==", "url": "https://github.com/eclipse/jkube/pull/447#discussion_r515005097", "bodyText": "ohk, I tested it and looks like image doesn't get updated with a single replace().", "author": "rohanKanojia", "createdAt": "2020-10-30T10:36:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNDUzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTAwNjU3Mw==", "url": "https://github.com/eclipse/jkube/pull/447#discussion_r515006573", "bodyText": "We should revisit this once we update Kubernetes Client. If it's still not working, maybe evaluate alternatives and improve Kubernetes Client for this scenario.", "author": "manusa", "createdAt": "2020-10-30T10:39:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNDUzNA=="}], "type": "inlineReview"}, {"oid": "6f926aa4e8d1ceba270102fdcef64d52050487bc", "url": "https://github.com/eclipse/jkube/commit/6f926aa4e8d1ceba270102fdcef64d52050487bc", "message": "fix: Removed misleading watch-postGoal warning + fixed rolling update in DockerImageWatcher\n\nSigned-off-by: Marc Nuri <marc@marcnuri.com>", "committedDate": "2020-10-27T14:06:29Z", "type": "commit"}, {"oid": "6f926aa4e8d1ceba270102fdcef64d52050487bc", "url": "https://github.com/eclipse/jkube/commit/6f926aa4e8d1ceba270102fdcef64d52050487bc", "message": "fix: Removed misleading watch-postGoal warning + fixed rolling update in DockerImageWatcher\n\nSigned-off-by: Marc Nuri <marc@marcnuri.com>", "committedDate": "2020-10-27T14:06:29Z", "type": "forcePushed"}]}