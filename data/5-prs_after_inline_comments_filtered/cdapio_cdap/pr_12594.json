{"pr_number": 12594, "pr_title": "CDAP-17078 consolidate multiple outputs from same sink", "pr_createdAt": "2020-08-07T20:52:57Z", "pr_url": "https://github.com/cdapio/cdap/pull/12594", "timeline": [{"oid": "25331ef1a1225504fbad780a801e92f7dbfcf022", "url": "https://github.com/cdapio/cdap/commit/25331ef1a1225504fbad780a801e92f7dbfcf022", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs\nwhen stage consolidation is enabled.", "committedDate": "2020-08-07T20:54:43Z", "type": "forcePushed"}, {"oid": "d966e1fc44eb47cf80be102bb429e2a9c2a6199a", "url": "https://github.com/cdapio/cdap/commit/d966e1fc44eb47cf80be102bb429e2a9c2a6199a", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs.", "committedDate": "2020-08-07T22:34:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMxNjA3Mg==", "url": "https://github.com/cdapio/cdap/pull/12594#discussion_r467316072", "bodyText": "Shouldn't we return after calling saveUsingOutputFormat?", "author": "MEseifan", "createdAt": "2020-08-07T22:42:53Z", "path": "cdap-app-templates/cdap-etl/hydrator-spark-core-base/src/main/java/io/cdap/cdap/etl/spark/batch/SparkBatchSinkFactory.java", "diffHunk": "@@ -173,9 +165,34 @@ private void addOutput(String stageName, String datasetName, String alias, Map<S\n         sec.saveAsDataset(rdd, datasetInfo.getDatasetName(), datasetInfo.getDatasetArgs());\n       }\n     }\n+\n+    if (outputFormats.size() == 1) {\n+      saveUsingOutputFormat(outputFormats.values().iterator().next(), rdd);\n+    }", "originalCommit": "d966e1fc44eb47cf80be102bb429e2a9c2a6199a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMxNjg4NQ==", "url": "https://github.com/cdapio/cdap/pull/12594#discussion_r467316885", "bodyText": "agh yes", "author": "albertshau", "createdAt": "2020-08-07T22:46:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMxNjA3Mg=="}], "type": "inlineReview"}, {"oid": "5fed793a72a0843ed2737edbe3f253f33d46e17a", "url": "https://github.com/cdapio/cdap/commit/5fed793a72a0843ed2737edbe3f253f33d46e17a", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs.", "committedDate": "2020-08-07T22:46:26Z", "type": "forcePushed"}, {"oid": "6626ba06890f49257a583f229a3789e619fc7f5a", "url": "https://github.com/cdapio/cdap/commit/6626ba06890f49257a583f229a3789e619fc7f5a", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs.", "committedDate": "2020-08-08T02:53:42Z", "type": "forcePushed"}, {"oid": "f709249a94795fe7b9e5bfcf4e0f74e8ba1bb55d", "url": "https://github.com/cdapio/cdap/commit/f709249a94795fe7b9e5bfcf4e0f74e8ba1bb55d", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs.", "committedDate": "2020-08-08T16:41:03Z", "type": "commit"}, {"oid": "f709249a94795fe7b9e5bfcf4e0f74e8ba1bb55d", "url": "https://github.com/cdapio/cdap/commit/f709249a94795fe7b9e5bfcf4e0f74e8ba1bb55d", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs.", "committedDate": "2020-08-08T16:41:03Z", "type": "forcePushed"}]}