{"pr_number": 82, "pr_title": "Goal state programming task for subnet/vpc", "pr_createdAt": "2020-01-08T03:33:49Z", "pr_url": "https://github.com/futurewei-cloud/alcor/pull/82", "timeline": [{"oid": "3c0108113b99f3fdf2a457aa07ea53275fea883a", "url": "https://github.com/futurewei-cloud/alcor/commit/3c0108113b99f3fdf2a457aa07ea53275fea883a", "message": "Goal state programming task for subnet/vpc", "committedDate": "2020-01-08T03:27:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM3NjI4NA==", "url": "https://github.com/futurewei-cloud/alcor/pull/82#discussion_r364376284", "bodyText": "Nit: the previous function name has good information, I suggest to use a better function than \"run\".", "author": "er1cthe0ne", "createdAt": "2020-01-08T18:26:00Z", "path": "src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/PortGoalStateProgrammer.java", "diffHunk": "@@ -29,27 +29,27 @@\n import lombok.Data;\n \n @Data\n-public class GoalStateWorker {\n+public class PortGoalStateProgrammer extends GoalStateProgrammer {\n \n     private PortProgramInfo portProgramInfo;\n-    private GoalStateProvisionerClient gRpcClientForEpHost;\n-    private MessageClient kafkaClient;\n \n-    public GoalStateWorker(PortProgramInfo portProgramInfo) {\n+    public PortGoalStateProgrammer(PortProgramInfo portProgramInfo) {\n         this.portProgramInfo = portProgramInfo;\n     }\n \n-    public long[] SendGoalStateToHosts() {\n+    @Override\n+    public long[] run() {", "originalCommit": "3c0108113b99f3fdf2a457aa07ea53275fea883a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM5MDY5Ng==", "url": "https://github.com/futurewei-cloud/alcor/pull/82#discussion_r364390696", "bodyText": "Thanks. Rename method back as suggested.", "author": "xieus", "createdAt": "2020-01-08T18:58:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM3NjI4NA=="}], "type": "inlineReview", "revised_code": {"commit": "bb8c9fbda583e5e284ac69f33035cdf4c34e02a4", "chunk": "diff --git a/src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/PortGoalStateProgrammer.java b/src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/PortGoalStateProgrammer.java\nindex 8103a0a37..03f9015ef 100644\n--- a/src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/PortGoalStateProgrammer.java\n+++ b/src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/PortGoalStateProgrammer.java\n\n@@ -38,7 +38,7 @@ public class PortGoalStateProgrammer extends GoalStateProgrammer {\n     }\n \n     @Override\n-    public long[] run() {\n+    public long[] SendGoalStateToHosts() {\n \n         long[] recordedTimeStamp = new long[3];\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM3NjkwNg==", "url": "https://github.com/futurewei-cloud/alcor/pull/82#discussion_r364376906", "bodyText": "I assume this.isFastPath will be configurable in the future right?", "author": "er1cthe0ne", "createdAt": "2020-01-08T18:27:28Z", "path": "src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/SubnetGoalStateProgrammer.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/*\n+Copyright 2019 The Alcor Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+        you may not use this file except in compliance with the License.\n+        You may obtain a copy of the License at\n+\n+        http://www.apache.org/licenses/LICENSE-2.0\n+\n+        Unless required by applicable law or agreed to in writing, software\n+        distributed under the License is distributed on an \"AS IS\" BASIS,\n+        WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+        See the License for the specific language governing permissions and\n+        limitations under the License.\n+*/\n+package com.futurewei.alcor.controller.resourcemgr.physical.goalstatemgmt;\n+\n+import com.futurewei.alcor.controller.comm.config.IKafkaConfiguration;\n+import com.futurewei.alcor.controller.comm.grpc.GoalStateProvisionerClient;\n+import com.futurewei.alcor.controller.comm.message.GoalStateMessageConsumerFactory;\n+import com.futurewei.alcor.controller.comm.message.GoalStateMessageProducerFactory;\n+import com.futurewei.alcor.controller.comm.message.MessageClient;\n+import com.futurewei.alcor.controller.model.HostInfo;\n+import com.futurewei.alcor.controller.model.SubnetState;\n+import com.futurewei.alcor.controller.model.VpcState;\n+import com.futurewei.alcor.controller.schema.Common;\n+import com.futurewei.alcor.controller.schema.Goalstate;\n+import com.futurewei.alcor.controller.utilities.GoalStateUtil;\n+\n+public class SubnetGoalStateProgrammer extends GoalStateProgrammer {\n+\n+    private SubnetProgramInfo subnetProgramInfo;\n+    private boolean isFastPath;\n+\n+    public SubnetGoalStateProgrammer(SubnetProgramInfo subnetProgramInfo) {\n+        this.subnetProgramInfo = subnetProgramInfo;\n+        this.isFastPath = true;", "originalCommit": "3c0108113b99f3fdf2a457aa07ea53275fea883a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM3OTMzNQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/82#discussion_r364379335", "bodyText": "One option is to always use fast path for switch/router setup.  We could think more on this.", "author": "xieus", "createdAt": "2020-01-08T18:33:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM3NjkwNg=="}], "type": "inlineReview", "revised_code": {"commit": "bb8c9fbda583e5e284ac69f33035cdf4c34e02a4", "chunk": "diff --git a/src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/SubnetGoalStateProgrammer.java b/src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/SubnetGoalStateProgrammer.java\nindex 641a141a5..41995a309 100644\n--- a/src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/SubnetGoalStateProgrammer.java\n+++ b/src/com/futurewei/alcor/controller/resourcemgr/physical/goalstatemgmt/SubnetGoalStateProgrammer.java\n\n@@ -38,7 +38,7 @@ public class SubnetGoalStateProgrammer extends GoalStateProgrammer {\n     }\n \n     @Override\n-    public long[] run() {\n+    public long[] SendGoalStateToHosts() {\n \n         long[] recordedTimeStamp = new long[3];\n         recordedTimeStamp[0] = System.nanoTime();\n"}}, {"oid": "bb8c9fbda583e5e284ac69f33035cdf4c34e02a4", "url": "https://github.com/futurewei-cloud/alcor/commit/bb8c9fbda583e5e284ac69f33035cdf4c34e02a4", "message": "Rename programmer method back to SendGoalStateToHosts", "committedDate": "2020-01-08T18:58:52Z", "type": "commit"}]}