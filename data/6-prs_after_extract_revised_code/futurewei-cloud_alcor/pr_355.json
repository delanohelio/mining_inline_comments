{"pr_number": 355, "pr_title": "[Data-Plane Mgr] Support DHCP Programming for Port Creation", "pr_createdAt": "2020-08-13T00:43:59Z", "pr_url": "https://github.com/futurewei-cloud/alcor/pull/355", "timeline": [{"oid": "ad7f8e437b0b007ab9b34bdf9e9a4f3dc8edb578", "url": "https://github.com/futurewei-cloud/alcor/commit/ad7f8e437b0b007ab9b34bdf9e9a4f3dc8edb578", "message": "add dhcp to goal state", "committedDate": "2020-08-13T00:42:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYzMjIzNw==", "url": "https://github.com/futurewei-cloud/alcor/pull/355#discussion_r469632237", "bodyText": "Let us use constant variables and collect them in one place so that we could easily change the value if needed.", "author": "xieus", "createdAt": "2020-08-13T00:55:55Z", "path": "services/data_plane_manager/src/main/java/com/futurewei/alcor/dataplane/utils/GoalStateManager.java", "diffHunk": "@@ -198,6 +201,17 @@ public boolean shouldSkipClass(Class<?> clazz) {\n                                   .setSubnetId(fixedIp.getSubnetId())\n                                   .build();\n                           fixedIps.add(fixedIp1);\n+                            DHCP.DHCPConfiguration dhcpConfiguration=DHCP.DHCPConfiguration.newBuilder()\n+                                    .setRevisionNumber(1)", "originalCommit": "ad7f8e437b0b007ab9b34bdf9e9a4f3dc8edb578", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY4MjAxMw==", "url": "https://github.com/futurewei-cloud/alcor/pull/355#discussion_r471682013", "bodyText": "Ping for this comment @haboy52581", "author": "xieus", "createdAt": "2020-08-17T18:27:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYzMjIzNw=="}], "type": "inlineReview", "revised_code": {"commit": "63b91136f5fe7cdae6009a532eb282db7d821f8d", "chunk": "diff --git a/services/data_plane_manager/src/main/java/com/futurewei/alcor/dataplane/utils/GoalStateManager.java b/services/data_plane_manager/src/main/java/com/futurewei/alcor/dataplane/utils/GoalStateManager.java\nindex 658b18f6b..a676c4d3f 100644\n--- a/services/data_plane_manager/src/main/java/com/futurewei/alcor/dataplane/utils/GoalStateManager.java\n+++ b/services/data_plane_manager/src/main/java/com/futurewei/alcor/dataplane/utils/GoalStateManager.java\n\n@@ -202,8 +203,8 @@ public class GoalStateManager {\n                                   .build();\n                           fixedIps.add(fixedIp1);\n                             DHCP.DHCPConfiguration dhcpConfiguration=DHCP.DHCPConfiguration.newBuilder()\n-                                    .setRevisionNumber(1)\n-                                    .setFormatVersion(1)\n+                                    .setRevisionNumber(FORMAT_REVISION_NUMBER)\n+                                    .setFormatVersion(FORMAT_REVISION_NUMBER)\n                                     .setSubnetId(fixedIp.getSubnetId())\n                                     .setMacAddress(portStateWithEverythingFilledNB.getMacAddress())\n                                     .setIpv4Address(fixedIp.getIpAddress())\n"}}, {"oid": "91da676db0f28a76614534744914215e697f07b6", "url": "https://github.com/futurewei-cloud/alcor/commit/91da676db0f28a76614534744914215e697f07b6", "message": "add dhcp unit test", "committedDate": "2020-08-17T17:56:07Z", "type": "commit"}, {"oid": "8acc164b3a30ac38f84bde074fdeca824f298f35", "url": "https://github.com/futurewei-cloud/alcor/commit/8acc164b3a30ac38f84bde074fdeca824f298f35", "message": "Merge branch 'master' into dev/354", "committedDate": "2020-08-17T17:57:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY3NjMxNA==", "url": "https://github.com/futurewei-cloud/alcor/pull/355#discussion_r471676314", "bodyText": "Good to have an extra test case.\nOne side suggestion: The GoalStateManagerTest.java file becomes a huge file as more test cases are being added. Could you plan to split the payload of each test case with separate conf file, and maintain the main test file in a relatively short manner?\nFor example,\npublic void dhcpTest()\n{\n\tString input = DHCPTestCase.INPUT;\n\tString output = DHCPTestCase.OUTPUT;\n\tcheck(input, output);\n}\n\n@haboy52581 We can do it in a follow-up PR if needed.", "author": "xieus", "createdAt": "2020-08-17T18:21:07Z", "path": "services/data_plane_manager/src/test/java/com/futurewei/alcor/dataplane/utils/GoalStateManagerTest.java", "diffHunk": "@@ -4602,6 +4602,343 @@ public void scenarioResourceRequestWithUpdatedAllfields()\n             + \"}\";\n     check(input,output);\n     }\n+\n+    @Test\n+    public void dhcpTest()\n+    {\n+    String input =", "originalCommit": "8acc164b3a30ac38f84bde074fdeca824f298f35", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyMTYyOQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/355#discussion_r472721629", "bodyText": "A tracking issue #360 has been created.", "author": "xieus", "createdAt": "2020-08-19T05:39:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY3NjMxNA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "5d17337d2f3423f52315aee34f943632e93ab21d", "url": "https://github.com/futurewei-cloud/alcor/commit/5d17337d2f3423f52315aee34f943632e93ab21d", "message": "Merge branch 'master' into dev/354", "committedDate": "2020-08-19T00:50:01Z", "type": "commit"}, {"oid": "63b91136f5fe7cdae6009a532eb282db7d821f8d", "url": "https://github.com/futurewei-cloud/alcor/commit/63b91136f5fe7cdae6009a532eb282db7d821f8d", "message": "dpm support dhcp now", "committedDate": "2020-08-19T00:53:14Z", "type": "commit"}]}