{"pr_number": 857, "pr_title": "Startup System Validation", "pr_createdAt": "2020-02-13T21:29:38Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/857", "timeline": [{"oid": "9bd6b37a492c8877951f8cdd66c37346d284432b", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/9bd6b37a492c8877951f8cdd66c37346d284432b", "message": "refactor(validator): Update Black Duck validator to read and validate ConfigurationModels.", "committedDate": "2020-02-13T20:53:53Z", "type": "commit"}, {"oid": "73a76ec9956e628ff0f246238cf238526067563b", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/73a76ec9956e628ff0f246238cf238526067563b", "message": "test: Fix tests for the validator and accumulator.", "committedDate": "2020-02-13T20:54:20Z", "type": "commit"}, {"oid": "da702c84ae45377a2aa374f7f2e170a090e071a1", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/da702c84ae45377a2aa374f7f2e170a090e071a1", "message": "Merge remote-tracking branch 'origin/feat_provider_lifecycle_management' into ps_system_status_startup", "committedDate": "2020-02-13T21:27:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQyNTc4OQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/857#discussion_r379425789", "bodyText": "Rather than this being a component, we could demand it as part of a Provider's contract by having a validate() method on the Provider itself. Then it could choose where/ how to implement it.\nThe Provider could pass its properties and a configurationModel to a different class if necessary. That way, it is guaranteed that a new Provider would have a validator.", "author": "gkillough", "createdAt": "2020-02-14T13:20:33Z", "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java", "diffHunk": "@@ -37,27 +37,32 @@\n import com.synopsys.integration.alert.common.enumeration.SystemMessageType;\n import com.synopsys.integration.alert.common.exception.AlertRuntimeException;\n import com.synopsys.integration.alert.common.persistence.accessor.SystemMessageUtility;\n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationModel;\n import com.synopsys.integration.alert.common.provider.ProviderValidator;\n import com.synopsys.integration.blackduck.configuration.BlackDuckServerConfig;\n import com.synopsys.integration.exception.IntegrationException;\n import com.synopsys.integration.log.IntLogger;\n import com.synopsys.integration.log.Slf4jIntLogger;\n \n @Component", "originalCommit": "da702c84ae45377a2aa374f7f2e170a090e071a1", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "acf3213bbe030705798ab7f323cdf8ac05973f36", "chunk": "diff --git a/src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java b/src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java\nindex e3037bf7f..3cb05f4bf 100644\n--- a/src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java\n+++ b/src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java\n\n@@ -26,43 +26,30 @@ import java.net.MalformedURLException;\n import java.net.URL;\n import java.util.Optional;\n \n-import org.apache.commons.lang3.BooleanUtils;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n-import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n \n-import com.synopsys.integration.alert.common.AlertProperties;\n import com.synopsys.integration.alert.common.enumeration.SystemMessageSeverity;\n import com.synopsys.integration.alert.common.enumeration.SystemMessageType;\n import com.synopsys.integration.alert.common.exception.AlertRuntimeException;\n import com.synopsys.integration.alert.common.persistence.accessor.SystemMessageUtility;\n-import com.synopsys.integration.alert.common.persistence.model.ConfigurationModel;\n-import com.synopsys.integration.alert.common.provider.ProviderValidator;\n import com.synopsys.integration.blackduck.configuration.BlackDuckServerConfig;\n import com.synopsys.integration.exception.IntegrationException;\n import com.synopsys.integration.log.IntLogger;\n import com.synopsys.integration.log.Slf4jIntLogger;\n \n @Component\n-public class BlackDuckValidator extends ProviderValidator {\n+public class BlackDuckValidator {\n     private static final Logger logger = LoggerFactory.getLogger(BlackDuckValidator.class);\n-\n-    private final BlackDuckProvider provider;\n-    private final AlertProperties alertProperties;\n     private final SystemMessageUtility systemMessageUtility;\n \n-    @Autowired\n-    public BlackDuckValidator(BlackDuckProvider provider, AlertProperties alertProperties, SystemMessageUtility systemMessageUtility) {\n-        super(provider.getKey());\n-        this.provider = provider;\n-        this.alertProperties = alertProperties;\n+    public BlackDuckValidator(SystemMessageUtility systemMessageUtility) {\n         this.systemMessageUtility = systemMessageUtility;\n     }\n \n-    @Override\n-    public boolean validate(ConfigurationModel configurationModel) {\n-        BlackDuckProperties blackDuckProperties = provider.createProperties(configurationModel);\n+    public boolean validate(BlackDuckProperties blackDuckProperties) {\n+        boolean valid = true;\n         logger.info(\"Validating Black Duck Provider...\");\n         systemMessageUtility.removeSystemMessagesByType(SystemMessageType.BLACKDUCK_PROVIDER_CONNECTIVITY);\n         systemMessageUtility.removeSystemMessagesByType(SystemMessageType.BLACKDUCK_PROVIDER_URL_MISSING);\n"}}, {"oid": "acf3213bbe030705798ab7f323cdf8ac05973f36", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/acf3213bbe030705798ab7f323cdf8ac05973f36", "message": "refactor(validator): Add a validation method to the provider.", "committedDate": "2020-02-14T15:04:20Z", "type": "commit"}, {"oid": "21f2b13511bf53c90adbfe895dbf7c0ebbfa9303", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/21f2b13511bf53c90adbfe895dbf7c0ebbfa9303", "message": "refactor(validator): Delete unused validator class.", "committedDate": "2020-02-14T15:05:35Z", "type": "commit"}]}