{"pr_number": 1166, "pr_title": "Hide Summary processing type when issue tracker channel is selected", "pr_createdAt": "2020-09-14T19:56:17Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/1166", "timeline": [{"oid": "2615c550c7f53e3a780ae9ee5d681226c9612388", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/2615c550c7f53e3a780ae9ee5d681226c9612388", "message": "Refactor (Java): Updating the processing type so it is not shown as an option in the UI when an issue tracker channel is selected.", "committedDate": "2020-09-14T19:54:42Z", "type": "commit"}, {"oid": "0bc1e004261425b738f66a520ec89ab1ccf903ea", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/0bc1e004261425b738f66a520ec89ab1ccf903ea", "message": "Merge branch '6.2.0' into jr_processing_type", "committedDate": "2020-09-14T19:54:59Z", "type": "commit"}, {"oid": "8bdcb1ae473e14651b9c4733bbfca62c133a0bad", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/8bdcb1ae473e14651b9c4733bbfca62c133a0bad", "message": "adjusting comment", "committedDate": "2020-09-14T19:57:20Z", "type": "commit"}, {"oid": "b37eacf8ea3bd14df30f004b4317b4a464618ad7", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/b37eacf8ea3bd14df30f004b4317b4a464618ad7", "message": "Updating field access", "committedDate": "2020-09-14T19:58:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE4ODU3MA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1166#discussion_r488188570", "bodyText": "Why not just make this condition the return statement?\nDIGEST doesn't really belong either IMO.", "author": "gkillough", "createdAt": "2020-09-14T20:04:18Z", "path": "src/main/java/com/synopsys/integration/alert/web/custom/ProcessingSelectCustomEndpoint.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * blackduck-alert\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.web.custom;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.google.gson.Gson;\n+import com.synopsys.integration.alert.common.action.CustomEndpointManager;\n+import com.synopsys.integration.alert.common.channel.issuetracker.IssueTrackerChannelKey;\n+import com.synopsys.integration.alert.common.descriptor.config.field.LabelValueSelectOption;\n+import com.synopsys.integration.alert.common.descriptor.config.field.endpoint.SelectCustomEndpoint;\n+import com.synopsys.integration.alert.common.descriptor.config.ui.ChannelDistributionUIConfig;\n+import com.synopsys.integration.alert.common.descriptor.config.ui.ProviderDistributionUIConfig;\n+import com.synopsys.integration.alert.common.enumeration.ProcessingType;\n+import com.synopsys.integration.alert.common.exception.AlertException;\n+import com.synopsys.integration.alert.common.rest.ResponseFactory;\n+import com.synopsys.integration.alert.common.rest.model.FieldModel;\n+\n+@Component\n+public class ProcessingSelectCustomEndpoint extends SelectCustomEndpoint {\n+    private final List<String> issueTrackerChannelKeys;\n+\n+    @Autowired\n+    public ProcessingSelectCustomEndpoint(CustomEndpointManager customEndpointManager, ResponseFactory responseFactory, Gson gson, List<IssueTrackerChannelKey> issueTrackerChannelKeys) throws AlertException {\n+        super(ProviderDistributionUIConfig.KEY_PROCESSING_TYPE, customEndpointManager, responseFactory, gson);\n+        this.issueTrackerChannelKeys = issueTrackerChannelKeys.stream()\n+                                           .map(IssueTrackerChannelKey::getUniversalKey)\n+                                           .collect(Collectors.toList());\n+    }\n+\n+    @Override\n+    protected List<LabelValueSelectOption> createData(FieldModel fieldModel) throws AlertException {\n+        String channelName = fieldModel.getFieldValue(ChannelDistributionUIConfig.KEY_CHANNEL_NAME).orElse(\"\");\n+        return Arrays.stream(ProcessingType.values())\n+                   .filter(processingType -> this.shouldInclude(processingType, channelName))\n+                   .map(processingType -> new LabelValueSelectOption(processingType.getLabel(), processingType.name()))\n+                   .collect(Collectors.toList());\n+    }\n+\n+    private boolean shouldInclude(ProcessingType processingType, String channelName) {\n+        if (issueTrackerChannelKeys.contains(channelName) && processingType == ProcessingType.SUMMARY) {", "originalCommit": "b37eacf8ea3bd14df30f004b4317b4a464618ad7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyMTIxNQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1166#discussion_r488821215", "bodyText": "I can change it to make the condition the return. I think DIGEST still fits. DEFAULT would let users have a full audit trail of the components reflected in Jira, while DIGEST would be the current items of concern (without opening issues and potentially closing them in the same batch)", "author": "jamesrichard91", "createdAt": "2020-09-15T16:59:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE4ODU3MA=="}], "type": "inlineReview", "revised_code": {"commit": "b0936c6d0c8f2377d361b6ac1a651eaf3f910288", "chunk": "diff --git a/src/main/java/com/synopsys/integration/alert/web/custom/ProcessingSelectCustomEndpoint.java b/src/main/java/com/synopsys/integration/alert/web/custom/ProcessingSelectCustomEndpoint.java\nindex 739fece11..70936d235 100644\n--- a/src/main/java/com/synopsys/integration/alert/web/custom/ProcessingSelectCustomEndpoint.java\n+++ b/src/main/java/com/synopsys/integration/alert/web/custom/ProcessingSelectCustomEndpoint.java\n\n@@ -63,10 +63,7 @@ public class ProcessingSelectCustomEndpoint extends SelectCustomEndpoint {\n     }\n \n     private boolean shouldInclude(ProcessingType processingType, String channelName) {\n-        if (issueTrackerChannelKeys.contains(channelName) && processingType == ProcessingType.SUMMARY) {\n-            // We do not want to expose the summary processing type as an option for issue tracker channels\n-            return false;\n-        }\n-        return true;\n+        // We do not want to expose the summary processing type as an option for issue tracker channels\n+        return !(issueTrackerChannelKeys.contains(channelName) && processingType == ProcessingType.SUMMARY);\n     }\n }\n"}}, {"oid": "b0936c6d0c8f2377d361b6ac1a651eaf3f910288", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/b0936c6d0c8f2377d361b6ac1a651eaf3f910288", "message": "Updating the processing type inclusion method", "committedDate": "2020-09-15T17:01:33Z", "type": "commit"}]}