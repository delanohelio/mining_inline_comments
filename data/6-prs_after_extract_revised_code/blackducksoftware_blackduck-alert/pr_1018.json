{"pr_number": 1018, "pr_title": "unknown config fix", "pr_createdAt": "2020-06-12T19:49:22Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/1018", "timeline": [{"oid": "2d3761b81820d3db9f66326db72cb042f9704068", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/2d3761b81820d3db9f66326db72cb042f9704068", "message": "fix: Ability to create messages by configuration.", "committedDate": "2020-06-11T18:11:01Z", "type": "commit"}, {"oid": "72f8611f4d9d7c8642328ea6e564ff90dbbcaa47", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/72f8611f4d9d7c8642328ea6e564ff90dbbcaa47", "message": "fix: Add a task to find missing configs and log system message.", "committedDate": "2020-06-12T14:43:18Z", "type": "commit"}, {"oid": "79009ff7fb20e67005c0ad3a1d360a39118c90a6", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/79009ff7fb20e67005c0ad3a1d360a39118c90a6", "message": "fix: Add system messages by provider config in order to remove correctly.", "committedDate": "2020-06-12T18:56:35Z", "type": "commit"}, {"oid": "f75281fcfc70dafb824c98a90b8e260ca149e13e", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f75281fcfc70dafb824c98a90b8e260ca149e13e", "message": "refactor: Remove an unnecessary method to remove configurations.", "committedDate": "2020-06-12T19:47:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTYxMzI1MA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1018#discussion_r439613250", "bodyText": "This class is the only class for determining if there are no providers configured at all.", "author": "psantos1113", "createdAt": "2020-06-12T19:49:55Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/provider/ProviderConfigMissingValidator.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/**\n+ * alert-common\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.common.provider;\n+\n+import java.util.List;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.synopsys.integration.alert.common.enumeration.ConfigContextEnum;\n+import com.synopsys.integration.alert.common.enumeration.SystemMessageSeverity;\n+import com.synopsys.integration.alert.common.enumeration.SystemMessageType;\n+import com.synopsys.integration.alert.common.exception.AlertDatabaseConstraintException;\n+import com.synopsys.integration.alert.common.persistence.accessor.ConfigurationAccessor;\n+import com.synopsys.integration.alert.common.persistence.accessor.SystemMessageUtility;\n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationModel;\n+import com.synopsys.integration.alert.common.provider.lifecycle.ProvidersMissingTask;\n+import com.synopsys.integration.alert.common.system.BaseSystemValidator;\n+\n+@Component\n+public class ProviderConfigMissingValidator extends BaseSystemValidator {", "originalCommit": "f75281fcfc70dafb824c98a90b8e260ca149e13e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTYxMzkxOQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1018#discussion_r439613919", "bodyText": "I will remove this line I shouldn't need it anymore.", "author": "psantos1113", "createdAt": "2020-06-12T19:51:32Z", "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java", "diffHunk": "@@ -61,17 +60,13 @@ public boolean validate(BlackDuckProperties blackDuckProperties) {\n         String configName = blackDuckProperties.getConfigName();\n         logger.info(\"Validating Black Duck configuration '{}'...\", configName);\n \n-        removeNoProviderConfigMessages();\n+        removeSystemMessagesByType(SystemMessageType.BLACKDUCK_PROVIDER_CONFIGURATION_MISSING);", "originalCommit": "f75281fcfc70dafb824c98a90b8e260ca149e13e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0543538bdc6d3527cee82b3f9e33c8875d75e363", "chunk": "diff --git a/src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java b/src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java\nindex 618fa61c4..256cecc02 100644\n--- a/src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java\n+++ b/src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java\n\n@@ -59,8 +59,7 @@ public class BlackDuckValidator extends BaseSystemValidator {\n         boolean valid = true;\n         String configName = blackDuckProperties.getConfigName();\n         logger.info(\"Validating Black Duck configuration '{}'...\", configName);\n-\n-        removeSystemMessagesByType(SystemMessageType.BLACKDUCK_PROVIDER_CONFIGURATION_MISSING);\n+        \n         try {\n             Optional<String> blackDuckUrlOptional = blackDuckProperties.getBlackDuckUrl();\n             removeOldConfigMessages(blackDuckProperties, SystemMessageType.BLACKDUCK_PROVIDER_CONNECTIVITY, SystemMessageType.BLACKDUCK_PROVIDER_LOCALHOST, SystemMessageType.BLACKDUCK_PROVIDER_URL_MISSING);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTYxNDQ1Mg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1018#discussion_r439614452", "bodyText": "This is a startup component that determines if the system is in a valid state or not.  On startup clear old messages and start clean.", "author": "psantos1113", "createdAt": "2020-06-12T19:52:48Z", "path": "src/main/java/com/synopsys/integration/alert/workflow/startup/component/SystemMessageInitializer.java", "diffHunk": "@@ -64,6 +68,7 @@ public boolean validate() {\n         logger.info(\"----------------------------------------\");\n         logger.info(\"Validating system configuration....\");\n \n+        clearOldMessages();", "originalCommit": "f75281fcfc70dafb824c98a90b8e260ca149e13e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "0543538bdc6d3527cee82b3f9e33c8875d75e363", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/0543538bdc6d3527cee82b3f9e33c8875d75e363", "message": "refactor: Remove an unneeded method.", "committedDate": "2020-06-12T20:01:08Z", "type": "commit"}, {"oid": "87b9333a869fcabf7316078f9c6d4acde0fdc34d", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/87b9333a869fcabf7316078f9c6d4acde0fdc34d", "message": "Merge remote-tracking branch 'origin/master' into ps_unknown_config_fix", "committedDate": "2020-06-15T10:47:06Z", "type": "commit"}]}