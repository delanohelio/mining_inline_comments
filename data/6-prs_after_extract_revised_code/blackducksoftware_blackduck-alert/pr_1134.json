{"pr_number": 1134, "pr_title": "Fix Azure Custom Fields", "pr_createdAt": "2020-08-25T17:37:32Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/1134", "timeline": [{"oid": "ace891d727d2d95f254ff33a9df9f6da9a8fb8d9", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/ace891d727d2d95f254ff33a9df9f6da9a8fb8d9", "message": "Fix(Azure): Separate provider-key in search properties", "committedDate": "2020-08-25T14:57:10Z", "type": "commit"}, {"oid": "435427062eb1e793ea68d42c6fb697806e3edb82", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/435427062eb1e793ea68d42c6fb697806e3edb82", "message": "Fix(Azure): Ensure a default link is provided if no UI link could be extracted from the work item response", "committedDate": "2020-08-25T15:05:50Z", "type": "commit"}, {"oid": "c41c19e6d5fb3d475030733faa3f8b7bb959d99d", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/c41c19e6d5fb3d475030733faa3f8b7bb959d99d", "message": "Fix(Azure): Separate tracking keys to minimize risk of hitting 255 char limit", "committedDate": "2020-08-25T17:13:56Z", "type": "commit"}, {"oid": "eaad0e08be89b676d44739e7096d96f2a68a62be", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/eaad0e08be89b676d44739e7096d96f2a68a62be", "message": "Fix(Azure): Remove commented code", "committedDate": "2020-08-25T17:33:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjYzMjYyOA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1134#discussion_r476632628", "bodyText": "Do these reference name need to be as unique as possible? If so, we might want to add synopsys or something to the name as well so that there are no conflicts.", "author": "bamandel", "createdAt": "2020-08-25T17:51:20Z", "path": "src/main/java/com/synopsys/integration/alert/channel/azure/boards/service/AzureCustomFieldManager.java", "diffHunk": "@@ -46,13 +49,43 @@\n import com.synopsys.integration.azure.boards.common.service.project.TeamProjectReferenceResponseModel;\n \n public class AzureCustomFieldManager {\n-    public static final String ALERT_TOP_LEVEL_KEY_FIELD_NAME = \"Alert Top Level Key\";\n-    public static final String ALERT_TOP_LEVEL_KEY_FIELD_REFERENCE_NAME = \"Custom.AlertTopLevelKey\";\n-    public static final String ALERT_TOP_LEVEL_KEY_FIELD_DESCRIPTION = \"A top-level tracking key for Alert\";\n-\n-    public static final String ALERT_COMPONENT_LEVEL_KEY_FIELD_NAME = \"Alert Component Level Key\";\n-    public static final String ALERT_COMPONENT_LEVEL_KEY_FIELD_REFERENCE_NAME = \"Custom.AlertComponentLevelKey\";\n-    public static final String ALERT_COMPONENT_LEVEL_KEY_FIELD_DESCRIPTION = \"A component-level tracking key for Alert\";\n+    public static final String ALERT_PROVIDER_KEY_FIELD_NAME = \"Alert Provider Key\";\n+    public static final String ALERT_PROVIDER_KEY_FIELD_REFERENCE_NAME = \"Custom.AlertProviderKey\";", "originalCommit": "eaad0e08be89b676d44739e7096d96f2a68a62be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY2MTgzMA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1134#discussion_r476661830", "bodyText": "Well yes, but actually no. This is a risk we run, but the reference name is just the context plus a dot prefixed to the name of the field without spaces.", "author": "gkillough", "createdAt": "2020-08-25T18:44:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjYzMjYyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY2MjUwMw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1134#discussion_r476662503", "bodyText": "@jamesrichard91 What are your thoughts? These are user-visible fields, so it will potentially make issues more verbose, but that could be a good thing so that customers aren't confused.", "author": "gkillough", "createdAt": "2020-08-25T18:45:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjYzMjYyOA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjYzNzUwOA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1134#discussion_r476637508", "bodyText": "Should we just remove the private method and put the contents in the public one?", "author": "bamandel", "createdAt": "2020-08-25T17:59:45Z", "path": "src/main/java/com/synopsys/integration/alert/channel/azure/boards/service/AzureCustomFieldManager.java", "diffHunk": "@@ -69,23 +102,31 @@ public AzureCustomFieldManager(String organizationName, AzureProjectService proj\n     }\n \n     public void installCustomFields(String projectName, String workItemTypeName) throws AlertException {\n-        Future<ProjectWorkItemFieldModel> topLevelKeyFieldCreationResultHolder =\n-            executorService.submit(() -> findOrCreateAlertCustomProjectField(projectName, ALERT_TOP_LEVEL_KEY_FIELD_NAME, ALERT_TOP_LEVEL_KEY_FIELD_REFERENCE_NAME, ALERT_TOP_LEVEL_KEY_FIELD_DESCRIPTION));\n-        Future<ProjectWorkItemFieldModel> componentLevelKeyFieldCreationResultHolder =\n-            executorService.submit(() -> findOrCreateAlertCustomProjectField(projectName, ALERT_COMPONENT_LEVEL_KEY_FIELD_NAME, ALERT_COMPONENT_LEVEL_KEY_FIELD_REFERENCE_NAME, ALERT_COMPONENT_LEVEL_KEY_FIELD_DESCRIPTION));\n+        installCustomFields(projectName, workItemTypeName, AZURE_CUSTOM_FIELDS);", "originalCommit": "eaad0e08be89b676d44739e7096d96f2a68a62be", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "02b8b5e090890b443f8fd9e090789242a296c3d8", "chunk": "diff --git a/src/main/java/com/synopsys/integration/alert/channel/azure/boards/service/AzureCustomFieldManager.java b/src/main/java/com/synopsys/integration/alert/channel/azure/boards/service/AzureCustomFieldManager.java\nindex 5c6753170..0aebcdde0 100644\n--- a/src/main/java/com/synopsys/integration/alert/channel/azure/boards/service/AzureCustomFieldManager.java\n+++ b/src/main/java/com/synopsys/integration/alert/channel/azure/boards/service/AzureCustomFieldManager.java\n\n@@ -102,12 +102,8 @@ public class AzureCustomFieldManager {\n     }\n \n     public void installCustomFields(String projectName, String workItemTypeName) throws AlertException {\n-        installCustomFields(projectName, workItemTypeName, AZURE_CUSTOM_FIELDS);\n-    }\n-\n-    private void installCustomFields(String projectName, String workItemTypeName, List<AzureCustomFieldDescriptor> customFieldDescriptors) throws AlertException {\n         List<Future<ProjectWorkItemFieldModel>> projectFieldFindOrCreateHolders = new ArrayList<>(7);\n-        for (AzureCustomFieldDescriptor fieldDesc : customFieldDescriptors) {\n+        for (AzureCustomFieldDescriptor fieldDesc : AZURE_CUSTOM_FIELDS) {\n             Future<ProjectWorkItemFieldModel> fieldFindOrCreateHolder =\n                 executorService.submit(() -> findOrCreateAlertCustomProjectField(projectName, fieldDesc.getFieldName(), fieldDesc.getFieldReferenceName(), fieldDesc.getFieldDescription()));\n             projectFieldFindOrCreateHolders.add(fieldFindOrCreateHolder);\n"}}, {"oid": "f54253039967b24a1d355430d1b30991b4e18c9c", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f54253039967b24a1d355430d1b30991b4e18c9c", "message": "Fix(Azure): Update query for existing work items and fix transition issue", "committedDate": "2020-08-25T18:02:33Z", "type": "commit"}, {"oid": "02b8b5e090890b443f8fd9e090789242a296c3d8", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/02b8b5e090890b443f8fd9e090789242a296c3d8", "message": "Refactor(Azure): Remove unnecessary nesting of private method always being called with a constant", "committedDate": "2020-08-25T18:47:32Z", "type": "commit"}, {"oid": "10e4381e7395f219b91b3275609aa6ff989f452a", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/10e4381e7395f219b91b3275609aa6ff989f452a", "message": "Merge branch '6.2.0' into gk_fix_azure_custom_fields", "committedDate": "2020-08-25T19:04:39Z", "type": "commit"}]}