{"pr_number": 1249, "pr_title": "Remove default value handling from DefaultNotificationAccessor", "pr_createdAt": "2020-11-09T20:15:55Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249", "timeline": [{"oid": "94e11bc7475bde31f3647dafad0f5e42d6154a20", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/94e11bc7475bde31f3647dafad0f5e42d6154a20", "message": "refactor(notifications): DefaultNotificationAccessor::getPageRequestForNotifications no longer accepts Nullable page number or page size.", "committedDate": "2020-11-09T20:08:52Z", "type": "commit"}, {"oid": "c57b997ad49a87d12e5e1ce4b1f472fe844f1903", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/c57b997ad49a87d12e5e1ce4b1f472fe844f1903", "message": "feat(notifications): Default page size is now 100 instead of Integer.MaxValue.", "committedDate": "2020-11-09T20:09:25Z", "type": "commit"}, {"oid": "c6cf2b5dcc4bb3bf1332ae7aab7db107eeb3cab4", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/c6cf2b5dcc4bb3bf1332ae7aab7db107eeb3cab4", "message": "refactor: Moved page and size checking below permissions check.", "committedDate": "2020-11-09T20:15:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDA5ODc0Ng==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249#discussion_r520098746", "bodyText": "I think the class that AuditEntryPageModel extends might have constants that could be used for the default values.", "author": "gkillough", "createdAt": "2020-11-09T20:26:16Z", "path": "component/src/main/java/com/synopsys/integration/alert/component/audit/web/AuditEntryActions.java", "diffHunk": "@@ -91,7 +92,9 @@ public AuditEntryActions(\n         if (!authorizationManager.hasReadPermission(ConfigContextEnum.GLOBAL, descriptorKey)) {\n             return new ActionResponse<>(HttpStatus.FORBIDDEN, ActionResponse.FORBIDDEN_MESSAGE);\n         }\n-        AuditEntryPageModel pagedRestModel = auditAccessor.getPageOfAuditEntries(pageNumber, pageSize, searchTerm, sortField, sortOrder, onlyShowSentNotifications, auditAccessor::convertToAuditEntryModelFromNotification);\n+        Integer page = ObjectUtils.defaultIfNull(pageNumber, 0);\n+        Integer size = ObjectUtils.defaultIfNull(pageSize, 100);", "originalCommit": "c6cf2b5dcc4bb3bf1332ae7aab7db107eeb3cab4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDE2MDk5Mw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249#discussion_r520160993", "bodyText": "If those constants don't exist we should at least make some in this class", "author": "bamandel", "createdAt": "2020-11-09T22:27:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDA5ODc0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgyOTU4Mg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249#discussion_r520829582", "bodyText": "I am now using the constants in AlertPagedModel. But that introduces a new issue #1249 (comment)", "author": "JakeMathews", "createdAt": "2020-11-10T19:44:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDA5ODc0Ng=="}], "type": "inlineReview", "revised_code": {"commit": "3893436e71b2defe054fd8b66b28fa014a5b170d", "chunk": "diff --git a/component/src/main/java/com/synopsys/integration/alert/component/audit/web/AuditEntryActions.java b/component/src/main/java/com/synopsys/integration/alert/component/audit/web/AuditEntryActions.java\nindex 1631feb7a..7698f5e9b 100644\n--- a/component/src/main/java/com/synopsys/integration/alert/component/audit/web/AuditEntryActions.java\n+++ b/component/src/main/java/com/synopsys/integration/alert/component/audit/web/AuditEntryActions.java\n\n@@ -92,8 +95,8 @@ public class AuditEntryActions {\n         if (!authorizationManager.hasReadPermission(ConfigContextEnum.GLOBAL, descriptorKey)) {\n             return new ActionResponse<>(HttpStatus.FORBIDDEN, ActionResponse.FORBIDDEN_MESSAGE);\n         }\n-        Integer page = ObjectUtils.defaultIfNull(pageNumber, 0);\n-        Integer size = ObjectUtils.defaultIfNull(pageSize, 100);\n+        Integer page = ObjectUtils.defaultIfNull(pageNumber, DEFAULT_PAGE_NUMBER);\n+        Integer size = ObjectUtils.defaultIfNull(pageSize, DEFAULT_PAGE_SIZE);\n         AuditEntryPageModel pagedRestModel = auditAccessor.getPageOfAuditEntries(page, size, searchTerm, sortField, sortOrder, onlyShowSentNotifications, auditAccessor::convertToAuditEntryModelFromNotification);\n         logger.debug(\"Paged Audit Entry Rest Model: {}\", pagedRestModel);\n         return new ActionResponse<>(HttpStatus.OK, pagedRestModel);\n"}}, {"oid": "06cd0adbbcb212d2ab042abd30593a4e08084d52", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/06cd0adbbcb212d2ab042abd30593a4e08084d52", "message": "Merge branch 'master' into jm-paged-notifications", "committedDate": "2020-11-10T17:27:03Z", "type": "commit"}, {"oid": "3893436e71b2defe054fd8b66b28fa014a5b170d", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/3893436e71b2defe054fd8b66b28fa014a5b170d", "message": "feat(paging): Changed default page size to use the constants in AlertPagedModel.", "committedDate": "2020-11-10T19:05:14Z", "type": "commit"}, {"oid": "dc0f34de45229396f61de6604086cd9f7ec5dfe5", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/dc0f34de45229396f61de6604086cd9f7ec5dfe5", "message": "Merge branch 'master' into jm-paged-notifications", "committedDate": "2020-11-10T19:05:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgyOTE0Mg==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249#discussion_r520829142", "bodyText": "Spring requires a String constant in ReadPageController. We want to use the same defaults, but as an Integer. Should we convert the String to an Integer at runtime? Do what I've done here? Something else?", "author": "JakeMathews", "createdAt": "2020-11-10T19:43:34Z", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/rest/model/AlertPagedModel.java", "diffHunk": "@@ -27,8 +27,10 @@\n import net.minidev.json.annotate.JsonIgnore;\n \n public class AlertPagedModel<M extends AlertSerializableModel> extends AlertSerializableModel {\n-    public static final String DEFAULT_PAGE_NUMBER = \"0\";\n-    public static final String DEFAULT_PAGE_SIZE = \"10\";\n+    public static final Integer DEFAULT_PAGE_NUMBER = 0;\n+    public static final Integer DEFAULT_PAGE_SIZE = 10;\n+    public static final String DEFAULT_PAGE_NUMBER_STRING = \"0\";\n+    public static final String DEFAULT_PAGE_SIZE_STRING = \"10\";", "originalCommit": "dc0f34de45229396f61de6604086cd9f7ec5dfe5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgzMzg5NA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249#discussion_r520833894", "bodyText": "public static final Integer DEFAULT_PAGE_NUMBER = 0;\n    public static final Integer DEFAULT_PAGE_SIZE = 10;\n    public static final String DEFAULT_PAGE_NUMBER_STRING = DEFAULT_PAGE_NUMBER.toString();\n    public static final String DEFAULT_PAGE_SIZE_STRING = DEFAULT_PAGE_SIZE.toString();\nbased on https://stackoverflow.com/a/654068/6921621", "author": "gkillough", "createdAt": "2020-11-10T19:51:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgyOTE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg0ODYxMw==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249#discussion_r520848613", "bodyText": "Then it is no longer a constant.", "author": "JakeMathews", "createdAt": "2020-11-10T20:18:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgyOTE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg1MDYwNQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249#discussion_r520850605", "bodyText": "Alright, in that case maybe move the string constants into that interface and leave them as literals. Leave the integers in the paged model.", "author": "gkillough", "createdAt": "2020-11-10T20:22:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgyOTE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2MTQ5OQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249#discussion_r520861499", "bodyText": "You could reverse it, leave the static Strings as literals and have the static integers based on those\npublic static final Integer DEFAULT_PAGE_NUMBER = Integer.valueOf(ReadPageController. DEFAULT_PAGE_NUMBER);\npublic static final Integer DEFAULT_PAGE_SIZE =  Integer.valueOf(ReadPageController. DEFAULT_PAGE_SIZE);", "author": "jamesrichard91", "createdAt": "2020-11-10T20:42:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgyOTE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTY0MQ==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1249#discussion_r520865641", "bodyText": "I was hesitant to do the String parsing at runtime, but I think that's better than declaring the constants twice.", "author": "JakeMathews", "createdAt": "2020-11-10T20:50:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgyOTE0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "b2ba5dbb53d93a4b77930bab95052ebf46cb16da", "chunk": "diff --git a/alert-common/src/main/java/com/synopsys/integration/alert/common/rest/model/AlertPagedModel.java b/alert-common/src/main/java/com/synopsys/integration/alert/common/rest/model/AlertPagedModel.java\nindex 6aad6cd09..6e75f8e80 100644\n--- a/alert-common/src/main/java/com/synopsys/integration/alert/common/rest/model/AlertPagedModel.java\n+++ b/alert-common/src/main/java/com/synopsys/integration/alert/common/rest/model/AlertPagedModel.java\n\n@@ -29,8 +29,6 @@ import net.minidev.json.annotate.JsonIgnore;\n public class AlertPagedModel<M extends AlertSerializableModel> extends AlertSerializableModel {\n     public static final Integer DEFAULT_PAGE_NUMBER = 0;\n     public static final Integer DEFAULT_PAGE_SIZE = 10;\n-    public static final String DEFAULT_PAGE_NUMBER_STRING = \"0\";\n-    public static final String DEFAULT_PAGE_SIZE_STRING = \"10\";\n \n     // FIXME we should use terminology based on \"offset\" and \"limit\" which are standard REST API paging terms\n     private final int totalPages;\n"}}, {"oid": "b2ba5dbb53d93a4b77930bab95052ebf46cb16da", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/b2ba5dbb53d93a4b77930bab95052ebf46cb16da", "message": "refactor(paging): Separated paging constants.", "committedDate": "2020-11-10T20:35:37Z", "type": "commit"}, {"oid": "ffbdc6c15ad6e0baf829c9ff701ff7709befe46a", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/ffbdc6c15ad6e0baf829c9ff701ff7709befe46a", "message": "refactor(paging): Based Integer constant off of String.", "committedDate": "2020-11-10T20:49:43Z", "type": "commit"}, {"oid": "23dc712930b264d25107dad5dc17f3c346e5c61b", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/23dc712930b264d25107dad5dc17f3c346e5c61b", "message": "Merge branch 'master' into jm-paged-notifications", "committedDate": "2020-11-10T20:49:56Z", "type": "commit"}]}