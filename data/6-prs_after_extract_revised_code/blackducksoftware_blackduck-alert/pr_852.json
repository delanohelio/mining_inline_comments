{"pr_number": 852, "pr_title": "refactor: Convert custom endpoints to use FieldModel.", "pr_createdAt": "2020-02-12T17:36:21Z", "pr_url": "https://github.com/blackducksoftware/blackduck-alert/pull/852", "timeline": [{"oid": "0e2f79b26065babbd016bf323f70f150770570ac", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/0e2f79b26065babbd016bf323f70f150770570ac", "message": "refactor: Convert custom endpoints to use FieldModel.", "committedDate": "2020-02-12T17:27:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQyNjc0MA==", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/852#discussion_r378426740", "bodyText": "Username and password are reversed here.", "author": "gkillough", "createdAt": "2020-02-12T18:16:10Z", "path": "src/main/java/com/synopsys/integration/alert/channel/jira/server/web/JiraServerCustomEndpoint.java", "diffHunk": "@@ -100,19 +100,16 @@ public JiraServerCustomEndpoint(JiraServerChannelKey jiraChannelKey, CustomEndpo\n     }\n \n     @Override\n-    protected String createData(Map<String, FieldValueModel> fieldValueModels) throws AlertException {\n+    protected String createData(FieldModel fieldModel) throws AlertException {\n         return \"Successfully created Alert plugin on Jira server.\";\n     }\n \n-    private JiraServerProperties createJiraProperties(Map<String, FieldValueModel> fieldValueModels) {\n-        FieldValueModel fieldUrl = fieldValueModels.get(JiraServerDescriptor.KEY_SERVER_URL);\n-        FieldValueModel fieldPassword = fieldValueModels.get(JiraServerDescriptor.KEY_SERVER_PASSWORD);\n-        FieldValueModel fieldUsername = fieldValueModels.get(JiraServerDescriptor.KEY_SERVER_USERNAME);\n-\n-        // for jira server the url should be\n-        String url = fieldUrl.getValue().orElse(\"\");\n-        String username = fieldUsername.getValue().orElse(\"\");\n-        String password = getAppropriateAccessToken(fieldPassword);\n+    private JiraServerProperties createJiraProperties(FieldModel fieldModel) {\n+        String url = fieldModel.getFieldValue(JiraServerDescriptor.KEY_SERVER_URL).orElse(\"\");\n+        String username = fieldModel.getFieldValue(JiraServerDescriptor.KEY_SERVER_PASSWORD).orElse(\"\");\n+        String password = fieldModel.getFieldValueModel(JiraServerDescriptor.KEY_SERVER_USERNAME)", "originalCommit": "0e2f79b26065babbd016bf323f70f150770570ac", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "26c051fafe3f1515deafaa4d5c84eea74c237cf1", "chunk": "diff --git a/src/main/java/com/synopsys/integration/alert/channel/jira/server/web/JiraServerCustomEndpoint.java b/src/main/java/com/synopsys/integration/alert/channel/jira/server/web/JiraServerCustomEndpoint.java\nindex 819df082a..dd92e3b17 100644\n--- a/src/main/java/com/synopsys/integration/alert/channel/jira/server/web/JiraServerCustomEndpoint.java\n+++ b/src/main/java/com/synopsys/integration/alert/channel/jira/server/web/JiraServerCustomEndpoint.java\n\n@@ -106,8 +106,8 @@ public class JiraServerCustomEndpoint extends ButtonCustomEndpoint {\n \n     private JiraServerProperties createJiraProperties(FieldModel fieldModel) {\n         String url = fieldModel.getFieldValue(JiraServerDescriptor.KEY_SERVER_URL).orElse(\"\");\n-        String username = fieldModel.getFieldValue(JiraServerDescriptor.KEY_SERVER_PASSWORD).orElse(\"\");\n-        String password = fieldModel.getFieldValueModel(JiraServerDescriptor.KEY_SERVER_USERNAME)\n+        String username = fieldModel.getFieldValue(JiraServerDescriptor.KEY_SERVER_USERNAME).orElse(\"\");\n+        String password = fieldModel.getFieldValueModel(JiraServerDescriptor.KEY_SERVER_PASSWORD)\n                               .map(this::getAppropriateAccessToken)\n                               .orElse(\"\");\n \n"}}, {"oid": "26c051fafe3f1515deafaa4d5c84eea74c237cf1", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/26c051fafe3f1515deafaa4d5c84eea74c237cf1", "message": "fix(jira): Fix the key used to get the username and password.", "committedDate": "2020-02-12T18:32:11Z", "type": "commit"}, {"oid": "6979222483fb174eb45af8bfca925248e6c91729", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/6979222483fb174eb45af8bfca925248e6c91729", "message": "Merge remote-tracking branch 'origin/feat_provider_lifecycle_management' into ps_field_model_conversion", "committedDate": "2020-02-12T18:44:50Z", "type": "commit"}, {"oid": "e6350930683a27b739e3fd8957e9f65ca174b4ba", "url": "https://github.com/blackducksoftware/blackduck-alert/commit/e6350930683a27b739e3fd8957e9f65ca174b4ba", "message": "test: fix the compile error with the test.", "committedDate": "2020-02-12T19:02:21Z", "type": "commit"}]}