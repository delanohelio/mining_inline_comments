{"pr_number": 3202, "pr_title": "STORM-3572 prevent NPEs when doing visualization with restarting exec\u2026", "pr_createdAt": "2020-01-31T22:32:09Z", "pr_url": "https://github.com/apache/storm/pull/3202", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE4MzI1OA==", "url": "https://github.com/apache/storm/pull/3202#discussion_r374183258", "bodyText": "why do we need this", "author": "Ethanlm", "createdAt": "2020-02-03T15:54:22Z", "path": "storm-webapp/src/main/java/org/apache/storm/daemon/ui/resources/StormApiResource.java", "diffHunk": "@@ -299,6 +299,9 @@ public Response getTopology(@PathParam(\"id\") String id,\n                     ),\n                     callback\n             );\n+        } catch (RuntimeException e) {", "originalCommit": "b30cb24b36e6cfef252b57e150120d528007da2b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE5MjU0OQ==", "url": "https://github.com/apache/storm/pull/3202#discussion_r374192549", "bodyText": "This provided the callstack that let me debug this.  If a different error occurs, I would like to be able to see the callstack.", "author": "agresch", "createdAt": "2020-02-03T16:09:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE4MzI1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE5NjExOQ==", "url": "https://github.com/apache/storm/pull/3202#discussion_r374196119", "bodyText": "Okay.\nYou might want to update the log message since this function is not only about getting visualization", "author": "Ethanlm", "createdAt": "2020-02-03T16:15:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE4MzI1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIxNjI1NQ==", "url": "https://github.com/apache/storm/pull/3202#discussion_r374216255", "bodyText": "Need to fix this file.  Thanks for catching", "author": "agresch", "createdAt": "2020-02-03T16:50:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE4MzI1OA=="}], "type": "inlineReview", "revised_code": {"commit": "5b89af3d4430483ef40f9fec7cdf960e3647059e", "chunk": "diff --git a/storm-webapp/src/main/java/org/apache/storm/daemon/ui/resources/StormApiResource.java b/storm-webapp/src/main/java/org/apache/storm/daemon/ui/resources/StormApiResource.java\nindex e88dbbf24..c13a4c30c 100644\n--- a/storm-webapp/src/main/java/org/apache/storm/daemon/ui/resources/StormApiResource.java\n+++ b/storm-webapp/src/main/java/org/apache/storm/daemon/ui/resources/StormApiResource.java\n\n@@ -299,9 +299,6 @@ public class StormApiResource {\n                     ),\n                     callback\n             );\n-        } catch (RuntimeException e) {\n-            LOG.error(\"Failure getting topology visualization\", e);\n-            throw e;\n         }\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE4MzUzNg==", "url": "https://github.com/apache/storm/pull/3202#discussion_r374183536", "bodyText": "this is not needed since expandAveragesSeq will not return null", "author": "Ethanlm", "createdAt": "2020-02-03T15:54:48Z", "path": "storm-server/src/main/java/org/apache/storm/stats/StatsUtil.java", "diffHunk": "@@ -830,6 +830,9 @@ private static TopologyPageInfo postAggregateTopoStats(Map task2comp, Map exec2n\n         Map<String, Map<K, Double>> ret = new HashMap<>();\n \n         Map<String, Map<K, List>> expands = expandAveragesSeq(avgSeq, countSeq);\n+        if (expands == null) {", "originalCommit": "b30cb24b36e6cfef252b57e150120d528007da2b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE5MzIxMw==", "url": "https://github.com/apache/storm/pull/3202#discussion_r374193213", "bodyText": "I can remove if desired. I would prefer to be safe.", "author": "agresch", "createdAt": "2020-02-03T16:10:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE4MzUzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE5NjY5Nw==", "url": "https://github.com/apache/storm/pull/3202#discussion_r374196697", "bodyText": "I am fine with it", "author": "Ethanlm", "createdAt": "2020-02-03T16:16:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE4MzUzNg=="}], "type": "inlineReview", "revised_code": null}, {"oid": "5b89af3d4430483ef40f9fec7cdf960e3647059e", "url": "https://github.com/apache/storm/commit/5b89af3d4430483ef40f9fec7cdf960e3647059e", "message": "STORM-3572 prevent NPEs when doing visualization with restarting executors", "committedDate": "2020-02-03T16:56:19Z", "type": "commit"}, {"oid": "5b89af3d4430483ef40f9fec7cdf960e3647059e", "url": "https://github.com/apache/storm/commit/5b89af3d4430483ef40f9fec7cdf960e3647059e", "message": "STORM-3572 prevent NPEs when doing visualization with restarting executors", "committedDate": "2020-02-03T16:56:19Z", "type": "forcePushed"}]}