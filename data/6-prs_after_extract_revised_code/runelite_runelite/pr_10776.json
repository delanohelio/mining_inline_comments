{"pr_number": 10776, "pr_title": "Add NamedObjectClueScroll interface, highlight broken Dorgesh-kaan lamps", "pr_createdAt": "2020-02-11T21:42:50Z", "pr_url": "https://github.com/runelite/runelite/pull/10776", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI3NzI3NA==", "url": "https://github.com/runelite/runelite/pull/10776#discussion_r382277274", "bodyText": "This is kind of a lot to be per tick (full scene scans of objects, with string comparisons...) maybe cache it?", "author": "Adam-", "createdAt": "2020-02-20T21:50:20Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/cluescrolls/ClueScrollPlugin.java", "diffHunk": "@@ -731,6 +737,39 @@ private void highlightObjectsForLocation(final WorldPoint location, final int...\n \t\t}\n \t}\n \n+\tprivate void highlightObjectsInRegion(final String[] objectNames, final int[] regionIds)", "originalCommit": "5240f5777ff630b929e231574699016cf5ba5bda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODczNDI1MQ==", "url": "https://github.com/runelite/runelite/pull/10776#discussion_r388734251", "bodyText": "I've changed this to only do a scene tile scan when the clue is read and on plane change. This interacts with some weird client behavior (see the added field comments/commit body) but seems to be working fine.", "author": "Nightfirecat", "createdAt": "2020-03-06T06:36:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI3NzI3NA=="}], "type": "inlineReview", "revised_code": {"commit": "c48d8db3a18ce14265eb6cba50304e666531580e", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/cluescrolls/ClueScrollPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/cluescrolls/ClueScrollPlugin.java\nindex 22678c39b..6087d683e 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/cluescrolls/ClueScrollPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/cluescrolls/ClueScrollPlugin.java\n\n@@ -737,39 +881,6 @@ public class ClueScrollPlugin extends Plugin\n \t\t}\n \t}\n \n-\tprivate void highlightObjectsInRegion(final String[] objectNames, final int[] regionIds)\n-\t{\n-\t\tfor (final Tile[] tiles : client.getScene().getTiles()[client.getPlane()])\n-\t\t{\n-\t\t\tfor (final Tile tile : tiles)\n-\t\t\t{\n-\t\t\t\tif (tile == null || regionIds != null && !ArrayUtils.contains(regionIds, tile.getWorldLocation().getRegionID()))\n-\t\t\t\t{\n-\t\t\t\t\tcontinue;\n-\t\t\t\t}\n-\n-\t\t\t\tfor (final GameObject object : tile.getGameObjects())\n-\t\t\t\t{\n-\t\t\t\t\tif (object == null)\n-\t\t\t\t\t{\n-\t\t\t\t\t\tcontinue;\n-\t\t\t\t\t}\n-\n-\t\t\t\t\tfinal ObjectComposition comp = client.getObjectDefinition(object.getId());\n-\t\t\t\t\tfinal ObjectComposition impostor = comp.getImpostorIds() != null ? comp.getImpostor() : comp;\n-\n-\t\t\t\t\tfor (final String name : objectNames)\n-\t\t\t\t\t{\n-\t\t\t\t\t\tif (comp.getName().equals(name) || impostor.getName().equals(name))\n-\t\t\t\t\t\t{\n-\t\t\t\t\t\t\tobjectsToMark.add(object);\n-\t\t\t\t\t\t}\n-\t\t\t\t\t}\n-\t\t\t\t}\n-\t\t\t}\n-\t\t}\n-\t}\n-\n \tprivate void checkClueNPCs(ClueScroll clue, final NPC... npcs)\n \t{\n \t\tif (!(clue instanceof NpcClueScroll))\n"}}, {"oid": "c48d8db3a18ce14265eb6cba50304e666531580e", "url": "https://github.com/runelite/runelite/commit/c48d8db3a18ce14265eb6cba50304e666531580e", "message": "clues: Create NamedObjectClueScroll interface\n\nThis commit adds a new clue type, NamedObjectClueScroll, which allows\nhighlighting of objects based on object name. (and optionally region\nID(s) where that object should reside)\n\nThis commit introduces two new fidlds to the ClueScrollPlugin class to\ntrack player plane changes to address some unusual client behavior.\nNamely, when a player travels up or down planes, multiloc objects only\nhave their varbit values updated on the tick after the plane change\noccurs. Since these objects must be in their desired state before\nchecking their name, these fields are used to track both the player's\nplane, and whether the plugin should wait an extra tick to process the\nnew plane's objects based on a plane change occurring.", "committedDate": "2020-03-06T06:26:09Z", "type": "commit"}, {"oid": "c2785628348effda93d675cb89e6d059fc163de2", "url": "https://github.com/runelite/runelite/commit/c2785628348effda93d675cb89e6d059fc163de2", "message": "SkillChallengeClue: Highlight broken Dorgesh-kaan lamps\n\nFor the skill challenge clue \"Fix a magical lamp in Dorgesh-Kaan.\",\nhighlight lamps in the area which are broken.\n\nFixes runelite/runelite#10069\nCloses runelite/runelite#10117", "committedDate": "2020-03-06T06:28:51Z", "type": "commit"}, {"oid": "c2785628348effda93d675cb89e6d059fc163de2", "url": "https://github.com/runelite/runelite/commit/c2785628348effda93d675cb89e6d059fc163de2", "message": "SkillChallengeClue: Highlight broken Dorgesh-kaan lamps\n\nFor the skill challenge clue \"Fix a magical lamp in Dorgesh-Kaan.\",\nhighlight lamps in the area which are broken.\n\nFixes runelite/runelite#10069\nCloses runelite/runelite#10117", "committedDate": "2020-03-06T06:28:51Z", "type": "forcePushed"}]}