{"pr_number": 12971, "pr_title": "discord: add main menu status option", "pr_createdAt": "2020-12-23T21:24:52Z", "pr_url": "https://github.com/runelite/runelite/pull/12971", "timeline": [{"oid": "6be6fabcb28ca3444b32439732349e17bab08554", "url": "https://github.com/runelite/runelite/commit/6be6fabcb28ca3444b32439732349e17bab08554", "message": "discord: add main menu status option", "committedDate": "2020-12-23T21:17:48Z", "type": "commit"}, {"oid": "ff958884852086a8ea12f5d59b59243e28b5327e", "url": "https://github.com/runelite/runelite/commit/ff958884852086a8ea12f5d59b59243e28b5327e", "message": "discord: fix issue when status is unintentionally shown on client startup", "committedDate": "2020-12-23T21:45:14Z", "type": "commit"}, {"oid": "ff958884852086a8ea12f5d59b59243e28b5327e", "url": "https://github.com/runelite/runelite/commit/ff958884852086a8ea12f5d59b59243e28b5327e", "message": "discord: fix issue when status is unintentionally shown on client startup", "committedDate": "2020-12-23T21:45:14Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTc3OTAyNw==", "url": "https://github.com/runelite/runelite/pull/12971#discussion_r569779027", "bodyText": "Just call client.getGameState() once and then use it here + also down below.", "author": "Adam-", "createdAt": "2021-02-03T21:57:58Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java", "diffHunk": "@@ -372,6 +372,12 @@ private void resetState()\n \n \tprivate void checkForGameStateUpdate()\n \t{\n+\t\tif (!config.showMainMenu() && client.getGameState() != GameState.LOGGED_IN)", "originalCommit": "ff958884852086a8ea12f5d59b59243e28b5327e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4ee63493da08ef87a886f6d98069e288e657a8f3", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\nindex b3f4ceab2..374c2df83 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\n\n@@ -372,15 +376,14 @@ public class DiscordPlugin extends Plugin\n \n \tprivate void checkForGameStateUpdate()\n \t{\n-\t\tif (!config.showMainMenu() && client.getGameState() != GameState.LOGGED_IN)\n+\t\tfinal boolean isLoggedIn = client.getGameState() == GameState.LOGGED_IN;\n+\n+\t\tif (config.showMainMenu() || isLoggedIn)\n \t\t{\n-\t\t\tresetState();\n-\t\t\treturn;\n+\t\t\tdiscordState.triggerEvent(isLoggedIn\n+\t\t\t\t\t? DiscordGameEventType.IN_GAME\n+\t\t\t\t\t: DiscordGameEventType.IN_MENU);\n \t\t}\n-\n-\t\tdiscordState.triggerEvent(client.getGameState() == GameState.LOGGED_IN\n-\t\t\t? DiscordGameEventType.IN_GAME\n-\t\t\t: DiscordGameEventType.IN_MENU);\n \t}\n \n \tprivate void checkForAreaUpdate()\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTc3OTE1NA==", "url": "https://github.com/runelite/runelite/pull/12971#discussion_r569779154", "bodyText": "Fix the indenting here.", "author": "Adam-", "createdAt": "2021-02-03T21:58:10Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordConfig.java", "diffHunk": "@@ -72,11 +72,22 @@ default int actionTimeout()\n \t\treturn 5;\n \t}\n \n+\t@ConfigItem(\n+\t\t\tkeyName = \"showMainMenu\",", "originalCommit": "ff958884852086a8ea12f5d59b59243e28b5327e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8c8986128db7b36e6cadce9fb0ef12bf46f320b0", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordConfig.java b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordConfig.java\nindex 6510c0cf3..f751cf05a 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordConfig.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordConfig.java\n\n@@ -73,10 +73,10 @@ public interface DiscordConfig extends Config\n \t}\n \n \t@ConfigItem(\n-\t\t\tkeyName = \"showMainMenu\",\n-\t\t\tname = \"Main Menu\",\n-\t\t\tdescription = \"Show status when in main menu\",\n-\t\t\tposition = 3\n+\t\tkeyName = \"showMainMenu\",\n+\t\tname = \"Main Menu\",\n+\t\tdescription = \"Show status when in main menu\",\n+\t\tposition = 3\n \t)\n \tdefault boolean showMainMenu()\n \t{\n"}}, {"oid": "022877505c5547a9a9098b0d1f0139632fbb50a6", "url": "https://github.com/runelite/runelite/commit/022877505c5547a9a9098b0d1f0139632fbb50a6", "message": "Merge branch 'master' of https://github.com/runelite/runelite into discordplugin-main-menu-config-option", "committedDate": "2021-02-03T22:40:25Z", "type": "commit"}, {"oid": "8c8986128db7b36e6cadce9fb0ef12bf46f320b0", "url": "https://github.com/runelite/runelite/commit/8c8986128db7b36e6cadce9fb0ef12bf46f320b0", "message": "discord: fix indentation in config", "committedDate": "2021-02-04T05:36:26Z", "type": "commit"}, {"oid": "4ee63493da08ef87a886f6d98069e288e657a8f3", "url": "https://github.com/runelite/runelite/commit/4ee63493da08ef87a886f6d98069e288e657a8f3", "message": "discord: remove duplicate call to reset game state if in main menu and option to show status is false", "committedDate": "2021-02-04T05:37:28Z", "type": "commit"}]}