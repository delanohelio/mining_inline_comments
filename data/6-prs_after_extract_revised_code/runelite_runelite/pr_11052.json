{"pr_number": 11052, "pr_title": "Nmz Plugin - Fix area check to exclude KBD lair", "pr_createdAt": "2020-03-22T05:35:28Z", "pr_url": "https://github.com/runelite/runelite/pull/11052", "timeline": [{"oid": "0c3d61430a7233ff6f9f47369126f3d0450e5148", "url": "https://github.com/runelite/runelite/commit/0c3d61430a7233ff6f9f47369126f3d0450e5148", "message": "Discord Plugin - Add KBD game event type\n\nKBD uses same region as NMZ but is always on plane 0", "committedDate": "2020-03-27T04:09:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTczMTIzOQ==", "url": "https://github.com/runelite/runelite/pull/11052#discussion_r399731239", "bodyText": "Given that we don't show players as being in the wilderness and players necessarily must travel through the wilderness to get to KBD, I think we shouldn't show this at all.", "author": "Nightfirecat", "createdAt": "2020-03-29T01:32:46Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordGameEventType.java", "diffHunk": "@@ -87,6 +87,8 @@\n \tBOSS_ZALCANO(\"Zalcano\", DiscordAreaType.BOSSES, 13250),\n \tBOSS_ZULRAH(\"Zulrah\", DiscordAreaType.BOSSES, 9007),\n \tBOSS_NIGHTMARE(\"Nightmare of Ashihama\", DiscordAreaType.BOSSES, 15515),\n+\t// KBD shares its region with NMZ and should be manually checked for and assigned by the plugin\n+\tBOSS_KING_BLACK_DRAGON(\"King black dragon\", DiscordAreaType.BOSSES),", "originalCommit": "0c3d61430a7233ff6f9f47369126f3d0450e5148", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "65a581d6072e2c1f25b5602d7a228929db25beff", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordGameEventType.java b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordGameEventType.java\nindex 8a46d45bf..d99f4217d 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordGameEventType.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordGameEventType.java\n\n@@ -87,8 +87,6 @@ enum DiscordGameEventType\n \tBOSS_ZALCANO(\"Zalcano\", DiscordAreaType.BOSSES, 13250),\n \tBOSS_ZULRAH(\"Zulrah\", DiscordAreaType.BOSSES, 9007),\n \tBOSS_NIGHTMARE(\"Nightmare of Ashihama\", DiscordAreaType.BOSSES, 15515),\n-\t// KBD shares its region with NMZ and should be manually checked for and assigned by the plugin\n-\tBOSS_KING_BLACK_DRAGON(\"King black dragon\", DiscordAreaType.BOSSES),\n \n \t// Cities\n \tCITY_AL_KHARID(\"Al Kharid\" , DiscordAreaType.CITIES, 13105, 13106),\n"}}, {"oid": "65a581d6072e2c1f25b5602d7a228929db25beff", "url": "https://github.com/runelite/runelite/commit/65a581d6072e2c1f25b5602d7a228929db25beff", "message": "Discord Plugin - Fix NMZ area check to exclude KBD lair\n\nNMZ reuses the KBD region ID but is always above plane 0", "committedDate": "2020-03-29T02:02:05Z", "type": "forcePushed"}, {"oid": "779769a4e7f8587c961c6894116dde5a4f9adefc", "url": "https://github.com/runelite/runelite/commit/779769a4e7f8587c961c6894116dde5a4f9adefc", "message": "Discord Plugin - Fix NMZ area check to exclude KBD lair\n\nNMZ reuses the KBD region ID but is always above plane 0", "committedDate": "2020-03-29T02:04:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTczNzYxNg==", "url": "https://github.com/runelite/runelite/pull/11052#discussion_r399737616", "bodyText": "Add a newline after this so it doesn't look like one big block.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tDiscordGameEventType discordGameEventType = DiscordGameEventType.fromRegion(playerRegionID);\n          \n          \n            \n            \t\tDiscordGameEventType discordGameEventType = DiscordGameEventType.fromRegion(playerRegionID);", "author": "Nightfirecat", "createdAt": "2020-03-29T03:05:56Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java", "diffHunk": "@@ -381,7 +381,14 @@ private void checkForAreaUpdate()\n \t\t\treturn;\n \t\t}\n \n-\t\tfinal DiscordGameEventType discordGameEventType = DiscordGameEventType.fromRegion(playerRegionID);\n+\t\tDiscordGameEventType discordGameEventType = DiscordGameEventType.fromRegion(playerRegionID);", "originalCommit": "779769a4e7f8587c961c6894116dde5a4f9adefc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5e99fae00e61abdcf94af4cf60092e893dc64cf9", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\nindex 3a491a89c..0c17f75a2 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\n\n@@ -382,12 +382,13 @@ public class DiscordPlugin extends Plugin\n \t\t}\n \n \t\tDiscordGameEventType discordGameEventType = DiscordGameEventType.fromRegion(playerRegionID);\n+\n \t\t// NMZ uses the same region ID as KBD. KBD is always on plane 0 and NMZ is always above plane 0\n \t\t// Since KBD requires going through the wilderness there is no EventType for it\n-\t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE.equals(discordGameEventType)\n+\t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE == discordGameEventType\n \t\t\t&& client.getLocalPlayer().getWorldLocation().getPlane() == 0)\n \t\t{\n-\t\t\t\tdiscordGameEventType = null;\n+\t\t\tdiscordGameEventType = null;\n \t\t}\n \n \t\tif (discordGameEventType == null)\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTI2MjI3OQ==", "url": "https://github.com/runelite/runelite/pull/11052#discussion_r401262279", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tdiscordGameEventType = null;\n          \n          \n            \n            \t\t\tdiscordGameEventType = null;", "author": "Adam-", "createdAt": "2020-03-31T22:55:25Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java", "diffHunk": "@@ -381,7 +381,15 @@ private void checkForAreaUpdate()\n \t\t\treturn;\n \t\t}\n \n-\t\tfinal DiscordGameEventType discordGameEventType = DiscordGameEventType.fromRegion(playerRegionID);\n+\t\tDiscordGameEventType discordGameEventType = DiscordGameEventType.fromRegion(playerRegionID);\n+\n+\t\t// NMZ uses the same region ID as KBD. KBD is always on plane 0 and NMZ is always above plane 0\n+\t\t// Since KBD requires going through the wilderness there is no EventType for it\n+\t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE.equals(discordGameEventType)\n+\t\t\t&& client.getLocalPlayer().getWorldLocation().getPlane() == 0)\n+\t\t{\n+\t\t\t\tdiscordGameEventType = null;", "originalCommit": "23e34bb1356b4c27143b3053b4161d83e30dd29a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5e99fae00e61abdcf94af4cf60092e893dc64cf9", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\nindex c3a13daca..0c17f75a2 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\n\n@@ -385,10 +385,10 @@ public class DiscordPlugin extends Plugin\n \n \t\t// NMZ uses the same region ID as KBD. KBD is always on plane 0 and NMZ is always above plane 0\n \t\t// Since KBD requires going through the wilderness there is no EventType for it\n-\t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE.equals(discordGameEventType)\n+\t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE == discordGameEventType\n \t\t\t&& client.getLocalPlayer().getWorldLocation().getPlane() == 0)\n \t\t{\n-\t\t\t\tdiscordGameEventType = null;\n+\t\t\tdiscordGameEventType = null;\n \t\t}\n \n \t\tif (discordGameEventType == null)\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTI2MjYwMg==", "url": "https://github.com/runelite/runelite/pull/11052#discussion_r401262602", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE.equals(discordGameEventType)\n          \n          \n            \n            \t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE == discordGameEventType", "author": "Adam-", "createdAt": "2020-03-31T22:56:19Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java", "diffHunk": "@@ -381,7 +381,15 @@ private void checkForAreaUpdate()\n \t\t\treturn;\n \t\t}\n \n-\t\tfinal DiscordGameEventType discordGameEventType = DiscordGameEventType.fromRegion(playerRegionID);\n+\t\tDiscordGameEventType discordGameEventType = DiscordGameEventType.fromRegion(playerRegionID);\n+\n+\t\t// NMZ uses the same region ID as KBD. KBD is always on plane 0 and NMZ is always above plane 0\n+\t\t// Since KBD requires going through the wilderness there is no EventType for it\n+\t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE.equals(discordGameEventType)", "originalCommit": "23e34bb1356b4c27143b3053b4161d83e30dd29a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5e99fae00e61abdcf94af4cf60092e893dc64cf9", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\nindex c3a13daca..0c17f75a2 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/discord/DiscordPlugin.java\n\n@@ -385,10 +385,10 @@ public class DiscordPlugin extends Plugin\n \n \t\t// NMZ uses the same region ID as KBD. KBD is always on plane 0 and NMZ is always above plane 0\n \t\t// Since KBD requires going through the wilderness there is no EventType for it\n-\t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE.equals(discordGameEventType)\n+\t\tif (DiscordGameEventType.MG_NIGHTMARE_ZONE == discordGameEventType\n \t\t\t&& client.getLocalPlayer().getWorldLocation().getPlane() == 0)\n \t\t{\n-\t\t\t\tdiscordGameEventType = null;\n+\t\t\tdiscordGameEventType = null;\n \t\t}\n \n \t\tif (discordGameEventType == null)\n"}}, {"oid": "5e99fae00e61abdcf94af4cf60092e893dc64cf9", "url": "https://github.com/runelite/runelite/commit/5e99fae00e61abdcf94af4cf60092e893dc64cf9", "message": "Discord Plugin - Fix NMZ area check to exclude KBD lair\n\nNMZ reuses the KBD region ID but is always above plane 0", "committedDate": "2020-04-01T01:28:44Z", "type": "forcePushed"}, {"oid": "0faf994f5467b07df2fead0841d3eb6915e79864", "url": "https://github.com/runelite/runelite/commit/0faf994f5467b07df2fead0841d3eb6915e79864", "message": "nightmarezone: Fix area check to exclude KBD lair\n\nFixes #3692", "committedDate": "2020-04-01T03:52:28Z", "type": "commit"}, {"oid": "7744056766e09aee1157a2014eb5d5092155a898", "url": "https://github.com/runelite/runelite/commit/7744056766e09aee1157a2014eb5d5092155a898", "message": "discord: Fix NMZ area check to exclude KBD lair\n\nNMZ reuses the KBD region ID but is always above plane 0", "committedDate": "2020-04-01T03:52:46Z", "type": "commit"}, {"oid": "7744056766e09aee1157a2014eb5d5092155a898", "url": "https://github.com/runelite/runelite/commit/7744056766e09aee1157a2014eb5d5092155a898", "message": "discord: Fix NMZ area check to exclude KBD lair\n\nNMZ reuses the KBD region ID but is always above plane 0", "committedDate": "2020-04-01T03:52:46Z", "type": "forcePushed"}]}