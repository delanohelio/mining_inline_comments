{"pr_number": 12130, "pr_title": "Check diseased and dead states on the Farming Contract Indicator", "pr_createdAt": "2020-07-13T20:56:03Z", "pr_url": "https://github.com/runelite/runelite/pull/12130", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ1MjAzOQ==", "url": "https://github.com/runelite/runelite/pull/12130#discussion_r473452039", "bodyText": "You should use the exact CropState color from enum instead of just defining it as Color.YELLOW. Same goes for L93.", "author": "melkypie", "createdAt": "2020-08-19T23:58:11Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/timetracking/farming/FarmingContractInfoBox.java", "diffHunk": "@@ -82,9 +82,23 @@ public String getTooltip()\n \t\t\t\tcontractColor = ColorScheme.PROGRESS_ERROR_COLOR;\n \t\t\t\tbreak;\n \t\t\tcase IN_PROGRESS:\n-\t\t\t\tcontractDescription = \"Ready \" + TabContentPanel.getFormattedEstimate(manager.getCompletionTime() - Instant.now().getEpochSecond(),\n-\t\t\t\t\tconfig.estimateRelative());\n-\t\t\t\tcontractColor = Color.GRAY;\n+\t\t\t\tswitch (manager.getContractCropState())\n+\t\t\t\t{\n+\t\t\t\t\tcase DISEASED:\n+\t\t\t\t\t\tcontractDescription = \"Diseased\";\n+\t\t\t\t\t\tcontractColor = Color.YELLOW;", "originalCommit": "26bee0ca5f27560b417a0eb43d12453c9b44c3f9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzUzNTM3Mg==", "url": "https://github.com/runelite/runelite/pull/12130#discussion_r473535372", "bodyText": "Ok, I have pushed the requested change.", "author": "Cyborger1", "createdAt": "2020-08-20T02:06:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ1MjAzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "c8d4264cadfe05ba0e6916aa53e614e560197f53", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/timetracking/farming/FarmingContractInfoBox.java b/runelite-client/src/main/java/net/runelite/client/plugins/timetracking/farming/FarmingContractInfoBox.java\nindex 2d42dead5..e60a13569 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/timetracking/farming/FarmingContractInfoBox.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/timetracking/farming/FarmingContractInfoBox.java\n\n@@ -82,20 +82,20 @@ class FarmingContractInfoBox extends InfoBox\n \t\t\t\tcontractColor = ColorScheme.PROGRESS_ERROR_COLOR;\n \t\t\t\tbreak;\n \t\t\tcase IN_PROGRESS:\n-\t\t\t\tswitch (manager.getContractCropState())\n+\t\t\t\tCropState cropState = manager.getContractCropState();\n+\t\t\t\tswitch (cropState)\n \t\t\t\t{\n \t\t\t\t\tcase DISEASED:\n \t\t\t\t\t\tcontractDescription = \"Diseased\";\n-\t\t\t\t\t\tcontractColor = Color.YELLOW;\n+\t\t\t\t\t\tcontractColor = cropState.getColor();\n \t\t\t\t\t\tbreak;\n \t\t\t\t\tcase DEAD:\n \t\t\t\t\t\tcontractDescription = \"Dead\";\n-\t\t\t\t\t\tcontractColor = ColorScheme.PROGRESS_ERROR_COLOR;\n+\t\t\t\t\t\tcontractColor = cropState.getColor();\n \t\t\t\t\t\tbreak;\n \t\t\t\t\tdefault:\n-\t\t\t\t\t\tcontractDescription = \"Ready \" + TabContentPanel.getFormattedEstimate(\n-\t\t\t\t\t\t\tmanager.getCompletionTime() - Instant.now().getEpochSecond(),\n-\t\t\t\t\t\t\tconfig.estimateRelative());\n+\t\t\t\t\t\tcontractDescription = \"Ready \" + TabContentPanel.getFormattedEstimate(manager.getCompletionTime() - Instant.now().getEpochSecond(),\n+\t\t\t\t\t\t\tconfig.timeFormatMode());\n \t\t\t\t\t\tcontractColor = Color.GRAY;\n \t\t\t\t\t\tbreak;\n \t\t\t\t}\n"}}, {"oid": "c8d4264cadfe05ba0e6916aa53e614e560197f53", "url": "https://github.com/runelite/runelite/commit/c8d4264cadfe05ba0e6916aa53e614e560197f53", "message": "Reintroduce Nightfirecat's style fixup lost in the squashing process", "committedDate": "2020-09-22T04:07:56Z", "type": "forcePushed"}, {"oid": "7a9033b08c8619a72bbea550b6d2ca3aad36e0c6", "url": "https://github.com/runelite/runelite/commit/7a9033b08c8619a72bbea550b6d2ca3aad36e0c6", "message": "Add tests and checking for diseased/dead states to FarmingContractManager", "committedDate": "2020-09-26T20:43:50Z", "type": "forcePushed"}, {"oid": "a3a647e206f92889bd7e7998a4c287987a06841e", "url": "https://github.com/runelite/runelite/commit/a3a647e206f92889bd7e7998a4c287987a06841e", "message": "farming: Fix harvestable health-check crops contract status\n\nThis commit fixes a bug which caused the farming contract manager to\nncorrectly report the status of a crop which had been health-checked as\nIN_PROGRESS for an active contract, instead of OCCUPIED.", "committedDate": "2020-10-09T02:36:47Z", "type": "commit"}, {"oid": "3af5dd16a0c836fe902b46407556d60c92f14de1", "url": "https://github.com/runelite/runelite/commit/3af5dd16a0c836fe902b46407556d60c92f14de1", "message": "farming: Fix contract status for plots with diseased/dead crops\n\nThis commit fixes the farming contract manager's behavior when\nencountering crops which have become diseased. Previously, it would not\ntake this into account and incorrectly report the crop as IN_PROGRESS or\nREADY.", "committedDate": "2020-10-09T02:39:18Z", "type": "forcePushed"}, {"oid": "6d78e6884dc2e3e8ff3a45e0e4877a908ae1321c", "url": "https://github.com/runelite/runelite/commit/6d78e6884dc2e3e8ff3a45e0e4877a908ae1321c", "message": "farming: Fix contract status for plots with diseased/dead crops\n\nThis commit fixes the farming contract manager's behavior when\nencountering crops which have become diseased. Previously, it would not\ntake this into account and incorrectly report the crop as IN_PROGRESS or\nREADY.", "committedDate": "2020-10-09T02:52:02Z", "type": "commit"}, {"oid": "6d78e6884dc2e3e8ff3a45e0e4877a908ae1321c", "url": "https://github.com/runelite/runelite/commit/6d78e6884dc2e3e8ff3a45e0e4877a908ae1321c", "message": "farming: Fix contract status for plots with diseased/dead crops\n\nThis commit fixes the farming contract manager's behavior when\nencountering crops which have become diseased. Previously, it would not\ntake this into account and incorrectly report the crop as IN_PROGRESS or\nREADY.", "committedDate": "2020-10-09T02:52:02Z", "type": "forcePushed"}]}