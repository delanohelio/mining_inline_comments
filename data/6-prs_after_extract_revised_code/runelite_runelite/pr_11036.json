{"pr_number": 11036, "pr_title": "Revert Shift Anti-Drag and Disable in PvP Scenarios", "pr_createdAt": "2020-03-18T04:13:14Z", "pr_url": "https://github.com/runelite/runelite/pull/11036", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTYwNg==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396201606", "bodyText": "This should be referenced from the ConfigGroup in AntiDragConfig", "author": "Adam-", "createdAt": "2020-03-23T03:53:08Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,44 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false\n )\n+@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n-\tprivate static final int DEFAULT_DELAY = 5;\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg3NzY5OA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396877698", "bodyText": "I'm sorry I am still trying to learn my way around github and understand the review process. Are you referring to line 55 - static final String CONFIG_GROUP = \"antiDrag\";? If so, are you suggesting referencing the ConfigGroup\nvia AntiDragConifg.class.getAnnotation(ConfigGroup.class).value()?", "author": "usa-usa-usa-usa", "createdAt": "2020-03-24T03:04:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTYwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg4MDM1NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396880355", "bodyText": "He means that AntiDragConfig should also have its @ConfigGroup definition updated to reference this constant. So it would read like this:\n@ConfigGroup(AntiDragPlugin.CONFIG_GROUP)", "author": "Nightfirecat", "createdAt": "2020-03-24T03:15:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTYwNg=="}], "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 8c0fa7dc9..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -24,37 +24,38 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import lombok.extern.slf4j.Slf4j;\n-import javax.inject.Inject;\n-import java.awt.event.KeyEvent;\n import com.google.inject.Provides;\n+import java.awt.event.KeyEvent;\n+import javax.inject.Inject;\n+import net.runelite.api.Client;\n import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.VarbitChanged;\n import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n import net.runelite.client.callback.ClientThread;\n-import net.runelite.client.eventbus.Subscribe;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.VarbitChanged;\n import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.eventbus.Subscribe;\n import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n-\n @PluginDescriptor(\n \tname = \"Anti Drag\",\n+\tdescription = \"Prevent dragging an item for a specified delay\",\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"},\n \tenabledByDefault = false\n )\n-@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n \tstatic final String CONFIG_GROUP = \"antiDrag\";\n \n-\tstatic final int DEFAULT_DELAY = 5;\n+\tprivate static final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTY2NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396201665", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\treturn client.getVarbitValue(8121) == 1;\n          \n          \n            \n            \t\treturn client.getVarbitValue(PVP_SPEC_ORB_DISABLED) == 1;", "author": "Adam-", "createdAt": "2020-03-23T03:53:23Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -125,4 +193,9 @@ private void setBankDragDelay(int delay)\n \t\t}\n \t}\n \n+\tpublic boolean inPvp()\n+\t{\n+\t\treturn client.getVarbitValue(8121) == 1;", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg4NjcxMA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396886710", "bodyText": "Can I keep the Varbits.java file change and make this client.getVar(Varbits.PVP_SPEC_ORB_DISABLED) or is it better practice to not modify the varbits and just use client.getVarbitValue(8121)?", "author": "usa-usa-usa-usa", "createdAt": "2020-03-24T03:43:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTY2NQ=="}], "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 8c0fa7dc9..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -193,9 +198,16 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t\t}\n \t}\n \n-\tpublic boolean inPvp()\n+\tprivate void setDragDelay()\n+\t{\n+\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\tsetBankDragDelay(config.dragDelay());\n+\t}\n+\n+\tprivate void resetDragDelay()\n \t{\n-\t\treturn client.getVarbitValue(8121) == 1;\n+\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\tsetBankDragDelay(DEFAULT_DELAY);\n \t}\n \n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTkzNw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396201937", "bodyText": "This should keep a stored value for isPvp and check isPvp() against that, and then only run this code if that changes", "author": "Adam-", "createdAt": "2020-03-23T03:55:05Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +110,74 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tclientThread.invoke(() ->\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n-\t\t}\n+\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT && !inPvp())\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t}\n+\t\t});\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tclientThread.invoke(() ->\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t}\n+\t\t});\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t\telse\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t\t}\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Subscribe\n-\tpublic void onFocusChanged(FocusChanged focusChanged)\n+\tpublic void onVarbitChanged(VarbitChanged varbitChanged)\n \t{\n-\t\tif (!focusChanged.isFocused())\n+\n+\t\tif (!inPvp() && !config.onShiftOnly())", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 8c0fa7dc9..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -110,27 +111,19 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tclientThread.invoke(() ->\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT && !inPvp())\n-\t\t\t{\n-\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n-\t\t\t\tsetBankDragDelay(config.dragDelay());\n-\t\t\t}\n-\t\t});\n+\t\t\tsetDragDelay();\n+\t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tclientThread.invoke(() ->\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n-\t\t\t{\n-\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n-\t\t\t}\n-\t\t});\n+\t\t\tresetDragDelay();\n+\t\t}\n \t}\n \n \t@Subscribe\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMjI3NA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396202274", "bodyText": "This should be 1) check shift 2) check config 3) thread 4) check pvp 5) change drags, as it prevents an unnecessary clientThread.invoke() per key. The config checks and keyevent checks are fine on this thread.\nThe previous behavior also allowed shift click in pvp, which would be nice to not lose, so maybe don't check that?", "author": "Adam-", "createdAt": "2020-03-23T03:56:58Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +110,74 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tclientThread.invoke(() ->\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n-\t\t}\n+\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT && !inPvp())", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 8c0fa7dc9..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -110,27 +111,19 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tclientThread.invoke(() ->\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT && !inPvp())\n-\t\t\t{\n-\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n-\t\t\t\tsetBankDragDelay(config.dragDelay());\n-\t\t\t}\n-\t\t});\n+\t\t\tsetDragDelay();\n+\t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tclientThread.invoke(() ->\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n-\t\t\t{\n-\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n-\t\t\t}\n-\t\t});\n+\t\t\tresetDragDelay();\n+\t\t}\n \t}\n \n \t@Subscribe\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMjk0MA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396202940", "bodyText": "This actually looks like a bug fix? I may take this independently/it should be in a separate commit.", "author": "Adam-", "createdAt": "2020-03-23T04:01:01Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -65,13 +77,27 @@ AntiDragConfig getConfig(ConfigManager configManager)\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t});\n+\t\t}\n+\n \t\tkeyManager.registerKeyListener(this);\n \t}\n \n \t@Override\n \tprotected void shutDown() throws Exception\n \t{\n \t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\tsetBankDragDelay(DEFAULT_DELAY);", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg4MjkyNA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396882924", "bodyText": "Referring to the shutdown behavior? This really is there because the original anti-drag plugin had it. I will test to validate. Also, sorry still trying to understand github and what the comments/suggestions are in reference to.", "author": "usa-usa-usa-usa", "createdAt": "2020-03-24T03:26:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMjk0MA=="}], "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 8c0fa7dc9..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -81,10 +84,10 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t\t{\n \t\t\tclientThread.invokeLater(() ->\n \t\t\t{\n-\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\tinPvp = client.getVar(Varbits.PVP_SPEC_ORB) == 1;\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp)\n \t\t\t\t{\n-\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n-\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t\tsetDragDelay();\n \t\t\t\t}\n \t\t\t});\n \t\t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396203424", "bodyText": "I can't figure out what this is here for. I don't think it's being used?", "author": "Adam-", "createdAt": "2020-03-23T04:03:34Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,24 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t}\n+\n+\t@ConfigItem(\n+\t\tkeyName = \"dragDelay\",\n+\t\tname = \"\",\n+\t\tdescription = \"\"\n+\t)\n+\tvoid dragDelay(int delay);", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MzAxMg==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397593012", "bodyText": "This was an accident. I have removed it.", "author": "usa-usa-usa-usa", "createdAt": "2020-03-25T03:40:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwNzM5Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398707397", "bodyText": "This still has not been removed. Why was this comment marked resolved?", "author": "Nightfirecat", "createdAt": "2020-03-26T16:22:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTYwMTAzNA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r399601034", "bodyText": "Sorry. I did remove this error, but someone accidentally re-pushed it back out.", "author": "usa-usa-usa-usa", "createdAt": "2020-03-28T01:22:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA=="}], "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java\nindex ed8b16c42..3e645547f 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java\n\n@@ -40,20 +40,13 @@ public interface AntiDragConfig extends Config\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n \t}\n \n-\t@ConfigItem(\n-\t\tkeyName = \"dragDelay\",\n-\t\tname = \"\",\n-\t\tdescription = \"\"\n-\t)\n-\tvoid dragDelay(int delay);\n-\n \t@ConfigItem(\n \t\tkeyName = \"onShiftOnly\",\n \t\tname = \"On Shift Only\",\n-\t\tdescription = \"Configures whether to only adjust the delay while holding shift\",\n+\t\tdescription = \"Configures whether to only adjust the delay while holding shift. Required for anti drag in PvP scenarios.\",\n \t\tposition = 2\n \t)\n \tdefault boolean onShiftOnly()\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTQ0Ng==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581446", "bodyText": "Why are the plugin description and tags removed?", "author": "Nightfirecat", "createdAt": "2020-03-25T02:55:03Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,45 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 3bd36b662..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -24,38 +24,38 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import lombok.extern.slf4j.Slf4j;\n-import javax.inject.Inject;\n-import java.awt.event.KeyEvent;\n import com.google.inject.Provides;\n+import java.awt.event.KeyEvent;\n+import javax.inject.Inject;\n+import net.runelite.api.Client;\n import net.runelite.api.GameState;\n import net.runelite.api.Varbits;\n+import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.VarbitChanged;\n import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n import net.runelite.client.callback.ClientThread;\n-import net.runelite.client.eventbus.Subscribe;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.VarbitChanged;\n import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.eventbus.Subscribe;\n import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n-\n @PluginDescriptor(\n \tname = \"Anti Drag\",\n+\tdescription = \"Prevent dragging an item for a specified delay\",\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"},\n \tenabledByDefault = false\n )\n-@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n \tstatic final String CONFIG_GROUP = \"antiDrag\";\n \n-\tstatic final int DEFAULT_DELAY = 5;\n+\tprivate static final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTQ5Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581497", "bodyText": "You're not using any log statements... Remove this.", "author": "Nightfirecat", "createdAt": "2020-03-25T02:55:15Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,45 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false\n )\n+@Slf4j", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 3bd36b662..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -24,38 +24,38 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import lombok.extern.slf4j.Slf4j;\n-import javax.inject.Inject;\n-import java.awt.event.KeyEvent;\n import com.google.inject.Provides;\n+import java.awt.event.KeyEvent;\n+import javax.inject.Inject;\n+import net.runelite.api.Client;\n import net.runelite.api.GameState;\n import net.runelite.api.Varbits;\n+import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.VarbitChanged;\n import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n import net.runelite.client.callback.ClientThread;\n-import net.runelite.client.eventbus.Subscribe;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.VarbitChanged;\n import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.eventbus.Subscribe;\n import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n-\n @PluginDescriptor(\n \tname = \"Anti Drag\",\n+\tdescription = \"Prevent dragging an item for a specified delay\",\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"},\n \tenabledByDefault = false\n )\n-@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n \tstatic final String CONFIG_GROUP = \"antiDrag\";\n \n-\tstatic final int DEFAULT_DELAY = 5;\n+\tprivate static final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTYzNg==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581636", "bodyText": "Is this being used outside the plugin? Seems like it can remain private.", "author": "Nightfirecat", "createdAt": "2020-03-25T02:55:45Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,45 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false\n )\n+@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n-\tprivate static final int DEFAULT_DELAY = 5;\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";\n+\n+\tstatic final int DEFAULT_DELAY = 5;", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 3bd36b662..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -24,38 +24,38 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import lombok.extern.slf4j.Slf4j;\n-import javax.inject.Inject;\n-import java.awt.event.KeyEvent;\n import com.google.inject.Provides;\n+import java.awt.event.KeyEvent;\n+import javax.inject.Inject;\n+import net.runelite.api.Client;\n import net.runelite.api.GameState;\n import net.runelite.api.Varbits;\n+import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.VarbitChanged;\n import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n import net.runelite.client.callback.ClientThread;\n-import net.runelite.client.eventbus.Subscribe;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.VarbitChanged;\n import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.eventbus.Subscribe;\n import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n-\n @PluginDescriptor(\n \tname = \"Anti Drag\",\n+\tdescription = \"Prevent dragging an item for a specified delay\",\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"},\n \tenabledByDefault = false\n )\n-@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n \tstatic final String CONFIG_GROUP = \"antiDrag\";\n \n-\tstatic final int DEFAULT_DELAY = 5;\n+\tprivate static final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTc4MQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581781", "bodyText": "Why is the FocusChanged handler removed?", "author": "Nightfirecat", "createdAt": "2020-03-25T02:56:23Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +111,76 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!inPvp()) {\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Subscribe\n-\tpublic void onFocusChanged(FocusChanged focusChanged)", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MzE4Mw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397593183", "bodyText": "I removed it at first because I didn't understand why it was important to turn off delay when the client left focus. I have added it back.", "author": "usa-usa-usa-usa", "createdAt": "2020-03-25T03:41:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTc4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 3bd36b662..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -111,28 +111,18 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tclientThread.invoke(() ->\n-\t\t\t{\n-\t\t\t\tif (!inPvp()) {\n-\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n-\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n-\t\t\t\t}\n-\t\t\t});\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tclientThread.invoke(() ->\n-\t\t\t{\n-\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n-\t\t\t});\n+\t\t\tresetDragDelay();\n \t\t}\n \t}\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTkxNw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581917", "bodyText": "These blocks are duplicated numerous times in this plugin now. Move them to helper methods.", "author": "Nightfirecat", "createdAt": "2020-03-25T02:56:51Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +111,76 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!inPvp()) {\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Subscribe\n-\tpublic void onFocusChanged(FocusChanged focusChanged)\n+\tpublic void onConfigChanged(ConfigChanged event)\n \t{\n-\t\tif (!focusChanged.isFocused())\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t\telse\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t\t}", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 3bd36b662..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -111,28 +111,18 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tclientThread.invoke(() ->\n-\t\t\t{\n-\t\t\t\tif (!inPvp()) {\n-\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n-\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n-\t\t\t\t}\n-\t\t\t});\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tclientThread.invoke(() ->\n-\t\t\t{\n-\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n-\t\t\t});\n+\t\t\tresetDragDelay();\n \t\t}\n \t}\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MjM2MA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397582360", "bodyText": "This should explain the expected function and values of this varbit, not just be a section header of sorts. (Not all other entries in this file are a good reference; I would expect this to look more like GE_OFFER_CREATION_TYPE on L542 than the sections above)", "author": "Nightfirecat", "createdAt": "2020-03-25T02:58:33Z", "path": "runelite-api/src/main/java/net/runelite/api/Varbits.java", "diffHunk": "@@ -563,7 +563,12 @@\n \tTWISTED_LEAGUE_RELIC_2(10050),\n \tTWISTED_LEAGUE_RELIC_3(10051),\n \tTWISTED_LEAGUE_RELIC_4(10052),\n-\tTWISTED_LEAGUE_RELIC_5(10053);\n+\tTWISTED_LEAGUE_RELIC_5(10053),\n+\n+\t/**\n+\t * PVP", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-api/src/main/java/net/runelite/api/Varbits.java b/runelite-api/src/main/java/net/runelite/api/Varbits.java\nindex 8d1ebf36d..9caeeb084 100644\n--- a/runelite-api/src/main/java/net/runelite/api/Varbits.java\n+++ b/runelite-api/src/main/java/net/runelite/api/Varbits.java\n\n@@ -566,9 +566,14 @@ public enum Varbits\n \tTWISTED_LEAGUE_RELIC_5(10053),\n \n \t/**\n-\t * PVP\n+\t * Whether the Special Attack orb is disabled due to being in a PvP area\n+\t *\n+\t * 0 = Enabled (player is not in PvP)\n+\t * 1 = Disabled (player in in PvP)\n+\t *\n+\t * @see <a href=\"https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\">The OSRS Wiki's Minimap page</a>\n \t */\n-\tPVP_SPEC_ORB_DISABLED(8121);\n+\tPVP_SPEC_ORB(8121);\n \n \t/**\n \t * The raw varbit ID.\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwMDY1Ng==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398700656", "bodyText": "This can remain static in addition to being private.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate final int DEFAULT_DELAY = 5;\n          \n          \n            \n            \tprivate static final int DEFAULT_DELAY = 5;", "author": "Nightfirecat", "createdAt": "2020-03-26T16:14:35Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -48,14 +48,15 @@\n \n @PluginDescriptor(\n \tname = \"Anti Drag\",\n-\tenabledByDefault = false\n+\tenabledByDefault = false,\n+\tdescription = \"Prevent dragging an item for a specified delay\",\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n )\n-@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n \tstatic final String CONFIG_GROUP = \"antiDrag\";\n \n-\tstatic final int DEFAULT_DELAY = 5;\n+\tprivate final int DEFAULT_DELAY = 5;", "originalCommit": "52cca8ef2db1d395bdf793b5dc4adf6891d3c9b3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 4e8dd3707..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -24,39 +24,38 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import javax.inject.Inject;\n-import java.awt.event.KeyEvent;\n import com.google.inject.Provides;\n+import java.awt.event.KeyEvent;\n+import javax.inject.Inject;\n+import net.runelite.api.Client;\n import net.runelite.api.GameState;\n import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.VarbitChanged;\n import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n import net.runelite.client.callback.ClientThread;\n-import net.runelite.client.eventbus.Subscribe;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.VarbitChanged;\n import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.eventbus.Subscribe;\n import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n-\n @PluginDescriptor(\n \tname = \"Anti Drag\",\n-\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"},\n+\tenabledByDefault = false\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n \tstatic final String CONFIG_GROUP = \"antiDrag\";\n \n-\tprivate final int DEFAULT_DELAY = 5;\n+\tprivate static final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwNjU4Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398706587", "bodyText": "This javadoc does not match the implementation of inPvp(). I would expect it to read more like the following:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Status of the PvP Spec Orb\n          \n          \n            \n            \t * 0 = Disabled\n          \n          \n            \n            \t * 1 = Enabled\n          \n          \n            \n            \t * Whether the Special Attack orb is disabled due to being in a PvP area\n          \n          \n            \n            \t *\n          \n          \n            \n            \t * 0 = Enabled (player is not in PvP)\n          \n          \n            \n            \t * 1 = Disabled (player in in PvP)\n          \n          \n            \n            \t *\n          \n          \n            \n            \t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb", "author": "Nightfirecat", "createdAt": "2020-03-26T16:21:52Z", "path": "runelite-api/src/main/java/net/runelite/api/Varbits.java", "diffHunk": "@@ -563,7 +563,14 @@\n \tTWISTED_LEAGUE_RELIC_2(10050),\n \tTWISTED_LEAGUE_RELIC_3(10051),\n \tTWISTED_LEAGUE_RELIC_4(10052),\n-\tTWISTED_LEAGUE_RELIC_5(10053);\n+\tTWISTED_LEAGUE_RELIC_5(10053),\n+\n+\t/**\n+\t * Status of the PvP Spec Orb\n+\t * 0 = Disabled\n+\t * 1 = Enabled", "originalCommit": "4dccb11c844ed5f3c7e7588c8ebd2c1177c409ca", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-api/src/main/java/net/runelite/api/Varbits.java b/runelite-api/src/main/java/net/runelite/api/Varbits.java\nindex a35a8a20e..9caeeb084 100644\n--- a/runelite-api/src/main/java/net/runelite/api/Varbits.java\n+++ b/runelite-api/src/main/java/net/runelite/api/Varbits.java\n\n@@ -566,9 +566,12 @@ public enum Varbits\n \tTWISTED_LEAGUE_RELIC_5(10053),\n \n \t/**\n-\t * Status of the PvP Spec Orb\n-\t * 0 = Disabled\n-\t * 1 = Enabled\n+\t * Whether the Special Attack orb is disabled due to being in a PvP area\n+\t *\n+\t * 0 = Enabled (player is not in PvP)\n+\t * 1 = Disabled (player in in PvP)\n+\t *\n+\t * @see <a href=\"https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\">The OSRS Wiki's Minimap page</a>\n \t */\n \tPVP_SPEC_ORB(8121);\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwODI4Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398708287", "bodyText": "lastInPvp would be a much better var name, which would completely remove the need for this added comment.", "author": "Nightfirecat", "createdAt": "2020-03-26T16:23:59Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n \ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n-\tprivate static final int DEFAULT_DELAY = 5;\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";\n+\n+\tprivate final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n \t@Inject\n \tprivate AntiDragConfig config;\n \n \t@Inject\n \tprivate KeyManager keyManager;\n \n+\tprivate boolean lastStatus; //true = was in PvP, false = was not in Pvp", "originalCommit": "4dccb11c844ed5f3c7e7588c8ebd2c1177c409ca", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 724e990db..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -24,39 +24,38 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import javax.inject.Inject;\n-import java.awt.event.KeyEvent;\n import com.google.inject.Provides;\n+import java.awt.event.KeyEvent;\n+import javax.inject.Inject;\n+import net.runelite.api.Client;\n import net.runelite.api.GameState;\n import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.VarbitChanged;\n import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n import net.runelite.client.callback.ClientThread;\n-import net.runelite.client.eventbus.Subscribe;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.VarbitChanged;\n import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.eventbus.Subscribe;\n import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n-\n @PluginDescriptor(\n \tname = \"Anti Drag\",\n-\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"},\n+\tenabledByDefault = false\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n \tstatic final String CONFIG_GROUP = \"antiDrag\";\n \n-\tprivate final int DEFAULT_DELAY = 5;\n+\tprivate static final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3ODU5NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400578595", "bodyText": "Don't remove the comment on this line", "author": "Nightfirecat", "createdAt": "2020-03-31T00:48:14Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,17 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java\nindex 76b3a0771..3e645547f 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java\n\n@@ -40,13 +40,13 @@ public interface AntiDragConfig extends Config\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n \t}\n \n \t@ConfigItem(\n \t\tkeyName = \"onShiftOnly\",\n \t\tname = \"On Shift Only\",\n-\t\tdescription = \"Configures whether to only adjust the delay while holding shift\",\n+\t\tdescription = \"Configures whether to only adjust the delay while holding shift. Required for anti drag in PvP scenarios.\",\n \t\tposition = 2\n \t)\n \tdefault boolean onShiftOnly()\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTEwNA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579104", "bodyText": "This needs some extra description to clarify that the plugin still requires the use of Shift in PVP.", "author": "Nightfirecat", "createdAt": "2020-03-31T00:49:49Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,17 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t}\n+\n+\t@ConfigItem(\n+\t\tkeyName = \"onShiftOnly\",\n+\t\tname = \"On Shift Only\",\n+\t\tdescription = \"Configures whether to only adjust the delay while holding shift\",", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java\nindex 76b3a0771..3e645547f 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java\n\n@@ -40,13 +40,13 @@ public interface AntiDragConfig extends Config\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n \t}\n \n \t@ConfigItem(\n \t\tkeyName = \"onShiftOnly\",\n \t\tname = \"On Shift Only\",\n-\t\tdescription = \"Configures whether to only adjust the delay while holding shift\",\n+\t\tdescription = \"Configures whether to only adjust the delay while holding shift. Required for anti drag in PvP scenarios.\",\n \t\tposition = 2\n \t)\n \tdefault boolean onShiftOnly()\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTI5OA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579298", "bodyText": "These imports need to be reordered, they should still be in alphabetical order.", "author": "Nightfirecat", "createdAt": "2020-03-31T00:50:33Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 77d238191..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -24,33 +24,32 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import javax.inject.Inject;\n-import java.awt.event.KeyEvent;\n import com.google.inject.Provides;\n+import java.awt.event.KeyEvent;\n+import javax.inject.Inject;\n+import net.runelite.api.Client;\n import net.runelite.api.GameState;\n import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.VarbitChanged;\n import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n import net.runelite.client.callback.ClientThread;\n-import net.runelite.client.eventbus.Subscribe;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.VarbitChanged;\n import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.eventbus.Subscribe;\n import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n-\n @PluginDescriptor(\n \tname = \"Anti Drag\",\n-\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"},\n+\tenabledByDefault = false\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTUxOA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579518", "bodyText": "This also should be moved back where it was originally to maintain import ordering.", "author": "Nightfirecat", "createdAt": "2020-03-31T00:51:24Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 77d238191..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -24,33 +24,32 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import javax.inject.Inject;\n-import java.awt.event.KeyEvent;\n import com.google.inject.Provides;\n+import java.awt.event.KeyEvent;\n+import javax.inject.Inject;\n+import net.runelite.api.Client;\n import net.runelite.api.GameState;\n import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.VarbitChanged;\n import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n import net.runelite.client.callback.ClientThread;\n-import net.runelite.client.eventbus.Subscribe;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.VarbitChanged;\n import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.eventbus.Subscribe;\n import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n-\n @PluginDescriptor(\n \tname = \"Anti Drag\",\n-\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"},\n+\tenabledByDefault = false\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTY3Ng==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579676", "bodyText": "Suggested change", "author": "Nightfirecat", "createdAt": "2020-03-31T00:52:01Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n \ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";\n+\n \tprivate static final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n \t@Inject\n \tprivate AntiDragConfig config;\n \n \t@Inject\n \tprivate KeyManager keyManager;\n \n+\tprivate boolean lastInPvp;\n+\n \t@Provides\n \tAntiDragConfig getConfig(ConfigManager configManager)\n \t{\n \t\treturn configManager.getConfig(AntiDragConfig.class);\n \t}\n \n+", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 77d238191..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -24,33 +24,32 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import javax.inject.Inject;\n-import java.awt.event.KeyEvent;\n import com.google.inject.Provides;\n+import java.awt.event.KeyEvent;\n+import javax.inject.Inject;\n+import net.runelite.api.Client;\n import net.runelite.api.GameState;\n import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.VarbitChanged;\n import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n import net.runelite.client.callback.ClientThread;\n-import net.runelite.client.eventbus.Subscribe;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.VarbitChanged;\n import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.eventbus.Subscribe;\n import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n-\n @PluginDescriptor(\n \tname = \"Anti Drag\",\n-\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"},\n+\tenabledByDefault = false\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU4MDM2Ng==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400580366", "bodyText": "This should be indented only one level further\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tsetDragDelay();\n          \n          \n            \n            \t\t\tsetDragDelay();", "author": "Nightfirecat", "createdAt": "2020-03-31T00:54:23Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +112,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\t\tsetDragDelay();", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 77d238191..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -112,18 +111,18 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\t\tsetDragDelay();\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tremoveDragDelay();\n+\t\t\tresetDragDelay();\n \t\t}\n \t}\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU4MDgwMw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400580803", "bodyText": "Use a non-inverted condition:\nif (config.onShiftOnly() || inPvp())\n{\n\tremoveDragDelay();\n}\nelse\n{\n\tsetDragDelay();\n}", "author": "Nightfirecat", "createdAt": "2020-03-31T00:56:05Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +112,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\t{\n+\t\t\tremoveDragDelay();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 77d238191..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -112,18 +111,18 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\t\tsetDragDelay();\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n-\t\t\tremoveDragDelay();\n+\t\t\tresetDragDelay();\n \t\t}\n \t}\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU4MDk0NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400580945", "bodyText": "This doesn't remove the drag delay, it only resets it to default values. resetDragDelay() would be a better name.", "author": "Nightfirecat", "createdAt": "2020-03-31T00:56:37Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -125,4 +208,21 @@ private void setBankDragDelay(int delay)\n \t\t}\n \t}\n \n+\tprivate boolean inPvp()\n+\t{\n+\t\treturn client.getVar(Varbits.PVP_SPEC_ORB) == 1;\n+\t}\n+\n+\tprivate void setDragDelay()\n+\t{\n+\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\tsetBankDragDelay(config.dragDelay());\n+\t}\n+\n+\tprivate void removeDragDelay()", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 77d238191..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -208,18 +198,13 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t\t}\n \t}\n \n-\tprivate boolean inPvp()\n-\t{\n-\t\treturn client.getVar(Varbits.PVP_SPEC_ORB) == 1;\n-\t}\n-\n \tprivate void setDragDelay()\n \t{\n \t\tclient.setInventoryDragDelay(config.dragDelay());\n \t\tsetBankDragDelay(config.dragDelay());\n \t}\n \n-\tprivate void removeDragDelay()\n+\tprivate void resetDragDelay()\n \t{\n \t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n \t\tsetBankDragDelay(DEFAULT_DELAY);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU5MTY4NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400591685", "bodyText": "Turns out my suggestion wasn't proper javadoc. This should be though.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\n          \n          \n            \n            \t * @see <a href=\"https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\">The OSRS Wiki's Minimap page</a>", "author": "Nightfirecat", "createdAt": "2020-03-31T01:34:37Z", "path": "runelite-api/src/main/java/net/runelite/api/Varbits.java", "diffHunk": "@@ -563,7 +563,17 @@\n \tTWISTED_LEAGUE_RELIC_2(10050),\n \tTWISTED_LEAGUE_RELIC_3(10051),\n \tTWISTED_LEAGUE_RELIC_4(10052),\n-\tTWISTED_LEAGUE_RELIC_5(10053);\n+\tTWISTED_LEAGUE_RELIC_5(10053),\n+\n+\t/**\n+\t * Whether the Special Attack orb is disabled due to being in a PvP area\n+\t *\n+\t * 0 = Enabled (player is not in PvP)\n+\t * 1 = Disabled (player in in PvP)\n+\t *\n+\t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-api/src/main/java/net/runelite/api/Varbits.java b/runelite-api/src/main/java/net/runelite/api/Varbits.java\nindex f7c81607d..9caeeb084 100644\n--- a/runelite-api/src/main/java/net/runelite/api/Varbits.java\n+++ b/runelite-api/src/main/java/net/runelite/api/Varbits.java\n\n@@ -571,7 +571,7 @@ public enum Varbits\n \t * 0 = Enabled (player is not in PvP)\n \t * 1 = Disabled (player in in PvP)\n \t *\n-\t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\n+\t * @see <a href=\"https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\">The OSRS Wiki's Minimap page</a>\n \t */\n \tPVP_SPEC_ORB(8121);\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0OTc2OQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r401949769", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n          \n          \n            \n            \t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())", "author": "Adam-", "createdAt": "2020-04-01T22:34:58Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +110,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)", "originalCommit": "a149fc69cbf5ae388d7c8c62492b1e140c5e500b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 40340a7ed..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -110,7 +111,7 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n \t\t\tsetDragDelay();\n \t\t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0OTkzMw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r401949933", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n          \n          \n            \n            \t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())", "author": "Adam-", "createdAt": "2020-04-01T22:35:25Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +110,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)", "originalCommit": "a149fc69cbf5ae388d7c8c62492b1e140c5e500b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 40340a7ed..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -110,7 +111,7 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n \t\t\tsetDragDelay();\n \t\t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc0NTEzOA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r403745138", "bodyText": "This should probably be on the client thread", "author": "Adam-", "createdAt": "2020-04-05T19:18:43Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -65,13 +80,24 @@ AntiDragConfig getConfig(ConfigManager configManager)\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tsetDragDelay();\n+\t\t\t\t}\n+\t\t\t});\n+\t\t}\n+\n \t\tkeyManager.registerKeyListener(this);\n \t}\n \n \t@Override\n \tprotected void shutDown() throws Exception\n \t{\n-\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\tresetDragDelay();", "originalCommit": "9b61d8823e1b86d3aef3b271042c1690d7506acb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 732751155..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -84,7 +84,8 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t\t{\n \t\t\tclientThread.invokeLater(() ->\n \t\t\t{\n-\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\tinPvp = client.getVar(Varbits.PVP_SPEC_ORB) == 1;\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp)\n \t\t\t\t{\n \t\t\t\t\tsetDragDelay();\n \t\t\t\t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc0NTcxNg==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r403745716", "bodyText": "Only the set (and probably the above resetDragDelay()) needs to be on client thread, the rest is fine off.", "author": "Adam-", "createdAt": "2020-04-05T19:23:56Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +110,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n+\t\t{\n+\t\t\tresetDragDelay();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (config.onShiftOnly() || inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tresetDragDelay();\n+\t\t\t\t}\n+\t\t\t\telse\n+\t\t\t\t{\n+\t\t\t\t\tsetDragDelay();\n+\t\t\t\t}\n+\t\t\t});\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onVarbitChanged(VarbitChanged varbitChanged)\n+\t{\n+\t\tboolean currentStatus = inPvp();\n+\n+\t\tif (currentStatus != lastInPvp)\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tif (!currentStatus && !config.onShiftOnly())\n+\t\t\t{\n+\t\t\t\tsetDragDelay();\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\tresetDragDelay();\n+\t\t\t}\n+\n+\t\t\tlastInPvp = currentStatus;\n \t\t}\n+\n \t}\n \n \t@Subscribe\n \tpublic void onFocusChanged(FocusChanged focusChanged)\n \t{\n \t\tif (!focusChanged.isFocused())\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tresetDragDelay();\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tsetDragDelay();", "originalCommit": "9b61d8823e1b86d3aef3b271042c1690d7506acb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 732751155..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -110,7 +111,7 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n \t\t{\n \t\t\tsetDragDelay();\n \t\t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc0NTc2Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r403745767", "bodyText": "This is just lastInPvp ?", "author": "Adam-", "createdAt": "2020-04-05T19:24:08Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -125,4 +206,21 @@ private void setBankDragDelay(int delay)\n \t\t}\n \t}\n \n+\tprivate boolean inPvp()\n+\t{\n+\t\treturn client.getVar(Varbits.PVP_SPEC_ORB) == 1;", "originalCommit": "9b61d8823e1b86d3aef3b271042c1690d7506acb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "chunk": "diff --git a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\nindex 732751155..e6c7c7f0b 100644\n--- a/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n+++ b/runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java\n\n@@ -206,11 +198,6 @@ public class AntiDragPlugin extends Plugin implements KeyListener\n \t\t}\n \t}\n \n-\tprivate boolean inPvp()\n-\t{\n-\t\treturn client.getVar(Varbits.PVP_SPEC_ORB) == 1;\n-\t}\n-\n \tprivate void setDragDelay()\n \t{\n \t\tclient.setInventoryDragDelay(config.dragDelay());\n"}}, {"oid": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "url": "https://github.com/runelite/runelite/commit/ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "message": "antidrag: add option to disable in pvp\n\nThis lifts the shift requirement by instead just disabling the feature\nin pvp\n\nCo-authored-by: jcwhisman <jcwhisman@gmail.com>", "committedDate": "2020-04-06T16:17:21Z", "type": "commit"}, {"oid": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "url": "https://github.com/runelite/runelite/commit/ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "message": "antidrag: add option to disable in pvp\n\nThis lifts the shift requirement by instead just disabling the feature\nin pvp\n\nCo-authored-by: jcwhisman <jcwhisman@gmail.com>", "committedDate": "2020-04-06T16:17:21Z", "type": "forcePushed"}]}