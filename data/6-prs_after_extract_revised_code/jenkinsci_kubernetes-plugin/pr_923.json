{"pr_number": 923, "pr_title": "[JENKINS-63847] Use line separator from agent OS instead of master OS", "pr_createdAt": "2020-12-23T13:33:52Z", "pr_url": "https://github.com/jenkinsci/kubernetes-plugin/pull/923", "timeline": [{"oid": "357847dc3ed61321ad1f72c44ab9481084a03303", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/357847dc3ed61321ad1f72c44ab9481084a03303", "message": "[JENKINS-63847] Use line separator from agent OS instead of master OS", "committedDate": "2020-12-23T13:33:16Z", "type": "commit"}, {"oid": "096e66f630546c039697f2804f30647d03efc95a", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/096e66f630546c039697f2804f30647d03efc95a", "message": "Revert \"[JENKINS-63847] Use line separator from agent OS instead of master OS\"\n\nThis reverts commit 357847dc3ed61321ad1f72c44ab9481084a03303.", "committedDate": "2020-12-23T13:50:53Z", "type": "commit"}, {"oid": "18d73fb7efd6d7702f53cd7d2f17b5d28c414f9c", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/18d73fb7efd6d7702f53cd7d2f17b5d28c414f9c", "message": "Use newline for agent OS", "committedDate": "2020-12-23T14:04:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTExNjU2Nw==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/923#discussion_r555116567", "bodyText": "IIUC from \n  \n    \n      kubernetes-plugin/src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java\n    \n    \n         Line 371\n      in\n      18d73fb\n    \n    \n    \n    \n\n        \n          \n           String sh = shell != null ? shell : launcher.isUnix() ? \"sh\" : \"cmd\"; \n        \n    \n  \n\n\nSeems a bit fragile, since shell could in principle be overridden on Windows, but OK. Maybe clearer to introduce a constant here.", "author": "jglick", "createdAt": "2021-01-11T15:14:18Z", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java", "diffHunk": "@@ -460,10 +460,12 @@ public void onClose(int i, String s) {\n                     toggleStdout.disable();\n                     OutputStream stdin = watch.getInput();\n                     PrintStream in = new PrintStream(stdin, true, StandardCharsets.UTF_8.name());\n+                    boolean windows = sh.equals(\"cmd\");", "originalCommit": "18d73fb7efd6d7702f53cd7d2f17b5d28c414f9c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "bf7407640f8442fb641399f09c0c3f989e0a31b5", "chunk": "diff --git a/src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java b/src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java\nindex e8b3bede..893e44a1 100755\n--- a/src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java\n+++ b/src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java\n\n@@ -460,12 +460,11 @@ public class ContainerExecDecorator extends LauncherDecorator implements Seriali\n                     toggleStdout.disable();\n                     OutputStream stdin = watch.getInput();\n                     PrintStream in = new PrintStream(stdin, true, StandardCharsets.UTF_8.name());\n-                    boolean windows = sh.equals(\"cmd\");\n                     if (pwd != null) {\n                         // We need to get into the project workspace.\n                         // The workspace is not known in advance, so we have to execute a cd command.\n                         in.print(String.format(\"cd \\\"%s\\\"\", pwd));\n-                        in.print(newLine(windows));\n+                        in.print(newLine(!launcher.isUnix()));\n                     }\n \n                     EnvVars envVars = new EnvVars();\n"}}, {"oid": "bf7407640f8442fb641399f09c0c3f989e0a31b5", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/bf7407640f8442fb641399f09c0c3f989e0a31b5", "message": "Remove fragile condition", "committedDate": "2021-01-11T16:14:16Z", "type": "commit"}, {"oid": "285ee36f6833bf1680cb8c4fe6484ce6dcac99b9", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/285ee36f6833bf1680cb8c4fe6484ce6dcac99b9", "message": "Merge branch 'master' into JENKINS-63847", "committedDate": "2021-01-14T13:24:29Z", "type": "commit"}]}