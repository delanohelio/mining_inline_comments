{"pr_number": 903, "pr_title": "Handle migration of `containerCap = 0`", "pr_createdAt": "2020-11-23T08:20:23Z", "pr_url": "https://github.com/jenkinsci/kubernetes-plugin/pull/903", "timeline": [{"oid": "0be227601eee1e281b87f7b59fcc98ed8b9e156c", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/0be227601eee1e281b87f7b59fcc98ed8b9e156c", "message": "Handle migration of containerCap = 0\n\nMeans unlimited", "committedDate": "2020-11-23T08:20:01Z", "type": "commit"}, {"oid": "5f55e363c0c1a6329022be2e2cfcb1f0a7ac093c", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/5f55e363c0c1a6329022be2e2cfcb1f0a7ac093c", "message": "Null check", "committedDate": "2020-11-23T08:42:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODcyMjU0Nw==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/903#discussion_r528722547", "bodyText": "There is a Matcher for this, FWIW.", "author": "jglick", "createdAt": "2020-11-23T14:00:37Z", "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java", "diffHunk": "@@ -372,6 +372,13 @@ public void emptyKubernetesCloudReadResolve() {\n         assertEquals(KubernetesCloud.DEFAULT_WAIT_FOR_POD_SEC, cloud.getWaitForPodSec());\n     }\n \n+    @Test\n+    @LocalData\n+    public void readResolveContainerCapZero() {\n+        KubernetesCloud cloud = j.jenkins.clouds.get(KubernetesCloud.class);\n+        assertTrue(cloud.getRemainingGlobalSlots(Collections.emptyList(), 1) > 0);", "originalCommit": "5f55e363c0c1a6329022be2e2cfcb1f0a7ac093c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "92fd127529b6f52973552eade7157d870154d51a", "chunk": "diff --git a/src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java b/src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java\nindex 273f1632..9bd4e4e1 100644\n--- a/src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java\n+++ b/src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java\n\n@@ -376,7 +383,8 @@ public class KubernetesCloudTest {\n     @LocalData\n     public void readResolveContainerCapZero() {\n         KubernetesCloud cloud = j.jenkins.clouds.get(KubernetesCloud.class);\n-        assertTrue(cloud.getRemainingGlobalSlots(Collections.emptyList(), 1) > 0);\n+        assertEquals(cloud.getContainerCap(), Integer.MAX_VALUE);\n+        assertThat(cloud.getRemainingGlobalSlots(Collections.emptyList(), 1), greaterThan(0));\n     }\n \n     public HtmlInput getInputByName(DomElement root, String name) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODcyMjcyMQ==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/903#discussion_r528722721", "bodyText": "Maybe start by checking getContainerCap?", "author": "jglick", "createdAt": "2020-11-23T14:00:56Z", "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java", "diffHunk": "@@ -372,6 +372,13 @@ public void emptyKubernetesCloudReadResolve() {\n         assertEquals(KubernetesCloud.DEFAULT_WAIT_FOR_POD_SEC, cloud.getWaitForPodSec());\n     }\n \n+    @Test\n+    @LocalData\n+    public void readResolveContainerCapZero() {\n+        KubernetesCloud cloud = j.jenkins.clouds.get(KubernetesCloud.class);", "originalCommit": "5f55e363c0c1a6329022be2e2cfcb1f0a7ac093c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "92fd127529b6f52973552eade7157d870154d51a", "chunk": "diff --git a/src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java b/src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java\nindex 273f1632..9bd4e4e1 100644\n--- a/src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java\n+++ b/src/test/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesCloudTest.java\n\n@@ -376,7 +383,8 @@ public class KubernetesCloudTest {\n     @LocalData\n     public void readResolveContainerCapZero() {\n         KubernetesCloud cloud = j.jenkins.clouds.get(KubernetesCloud.class);\n-        assertTrue(cloud.getRemainingGlobalSlots(Collections.emptyList(), 1) > 0);\n+        assertEquals(cloud.getContainerCap(), Integer.MAX_VALUE);\n+        assertThat(cloud.getRemainingGlobalSlots(Collections.emptyList(), 1), greaterThan(0));\n     }\n \n     public HtmlInput getInputByName(DomElement root, String name) {\n"}}, {"oid": "92fd127529b6f52973552eade7157d870154d51a", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/92fd127529b6f52973552eade7157d870154d51a", "message": "Improve assertions", "committedDate": "2020-11-23T14:05:12Z", "type": "commit"}]}