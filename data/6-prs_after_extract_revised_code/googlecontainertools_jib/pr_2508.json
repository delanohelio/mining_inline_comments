{"pr_number": 2508, "pr_title": "Inject Gradle project when creating extension-specific config object", "pr_createdAt": "2020-06-03T15:15:11Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2508", "timeline": [{"oid": "bb4e0b8f44193c6ecd7a8187a7e6be2381cb8f7f", "url": "https://github.com/GoogleContainerTools/jib/commit/bb4e0b8f44193c6ecd7a8187a7e6be2381cb8f7f", "message": "Inject Gradle project when creating custom-extension config object", "committedDate": "2020-06-03T15:12:49Z", "type": "commit"}, {"oid": "c4f2a2dd09cf3cf36f7a8417882b8713c7f3a9da", "url": "https://github.com/GoogleContainerTools/jib/commit/c4f2a2dd09cf3cf36f7a8417882b8713c7f3a9da", "message": "Fix test", "committedDate": "2020-06-03T15:34:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDc0ODk4MA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2508#discussion_r434748980", "bodyText": "I thought this was only if you wanted to inject the project into the extension block?", "author": "loosebazooka", "createdAt": "2020-06-03T17:51:11Z", "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/GradleProjectProperties.java", "diffHunk": "@@ -469,7 +469,7 @@ public JibContainerBuilder runPluginExtensions(\n         // config.getExtraConfiguration().get() is of type Action, so this cast always succeeds.\n         // (Note generic <T> is erased at runtime.)\n         Action<T> action = (Action<T>) config.getExtraConfiguration().get();\n-        extraConfig = project.getObjects().newInstance(extraConfigType.get());\n+        extraConfig = project.getObjects().newInstance(extraConfigType.get(), project);", "originalCommit": "c4f2a2dd09cf3cf36f7a8417882b8713c7f3a9da", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDc1NDkwOA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2508#discussion_r434754908", "bodyText": "That's true. Having this forces the extension developers to have a 1-arg constructor for its extension-specific configuration class (like this), if they wish to have its configuration.\nOtherwise, I think what we can do is to support both 0-arg and 1-arg constructors like this?\ntry {\n  extraConfig = project.getObjects().newInstance(extraConfigType.get());\n} catch (SomeExceptionFromNotBeingAbleToInstantiate ex) {\n  extraConfig = project.getObjects().newInstance(extraConfigType.get(), project);\n}", "author": "chanseokoh", "createdAt": "2020-06-03T18:01:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDc0ODk4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDc3OTI4Ng==", "url": "https://github.com/GoogleContainerTools/jib/pull/2508#discussion_r434779286", "bodyText": "I see, lets just keep the constructor with Project and document it. Having 2 options will probably confuse people?", "author": "loosebazooka", "createdAt": "2020-06-03T18:44:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDc0ODk4MA=="}], "type": "inlineReview", "revised_code": null}]}