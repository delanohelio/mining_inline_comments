{"pr_number": 2704, "pr_title": "Fix NullPointerException during preconditions validation for Java 9+", "pr_createdAt": "2020-08-17T20:49:03Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2704", "timeline": [{"oid": "be66315962796642b25763a5479ee39d12b0c157", "url": "https://github.com/GoogleContainerTools/jib/commit/be66315962796642b25763a5479ee39d12b0c157", "message": "Workaround for .contains(null) to prevent npe in java 9+", "committedDate": "2020-08-17T20:09:49Z", "type": "commit"}, {"oid": "a630655373ae4138b35a6516cec71b6227084fd4", "url": "https://github.com/GoogleContainerTools/jib/commit/a630655373ae4138b35a6516cec71b6227084fd4", "message": "formatting", "committedDate": "2020-08-17T20:18:37Z", "type": "commit"}, {"oid": "a63fe93f68f36685147ea4c1125230ac6b1ead25", "url": "https://github.com/GoogleContainerTools/jib/commit/a63fe93f68f36685147ea4c1125230ac6b1ead25", "message": "empty commit to trigger builds", "committedDate": "2020-08-17T22:38:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyOTExMQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2704#discussion_r472329111", "bodyText": "May the non negative form be clearer ?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        !programArguments.stream().anyMatch(Objects::isNull), \"program arguments list contains null elements\");\n          \n          \n            \n                        programArguments.stream().allMatch(Objects::nonNull), \"program arguments list contains null elements\");", "author": "vgalloy", "createdAt": "2020-08-18T16:34:12Z", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/configuration/ContainerConfiguration.java", "diffHunk": "@@ -122,7 +122,7 @@ public Builder setProgramArguments(@Nullable List<String> programArguments) {\n         this.programArguments = null;\n       } else {\n         Preconditions.checkArgument(\n-            !programArguments.contains(null), \"program arguments list contains null elements\");\n+            !programArguments.stream().anyMatch(Objects::isNull), \"program arguments list contains null elements\");", "originalCommit": "be66315962796642b25763a5479ee39d12b0c157", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM5MTI3NQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2704#discussion_r472391275", "bodyText": "Good point, I think both are readable, but maybe (1) matches the english (if the list contains null)? And we know (1) is generally faster from short circuiting, so I thinking keeping as is, is good.", "author": "loosebazooka", "createdAt": "2020-08-18T18:16:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyOTExMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxMjgzMg==", "url": "https://github.com/GoogleContainerTools/jib/pull/2704#discussion_r472412832", "bodyText": "oh I'm super mistaken, everything I said was wrong. You're right, both short circuit, and the precondition does make more sense. @mpeddada1 can you try this way out?", "author": "loosebazooka", "createdAt": "2020-08-18T18:56:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyOTExMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyMDk4MQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2704#discussion_r472420981", "bodyText": "Thanks for the suggestion! Applied the change.", "author": "mpeddada1", "createdAt": "2020-08-18T19:12:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyOTExMQ=="}], "type": "inlineReview", "revised_code": {"commit": "5639c3facb41501889d7f6ab6f317bc069efb82a", "chunk": "diff --git a/jib-core/src/main/java/com/google/cloud/tools/jib/configuration/ContainerConfiguration.java b/jib-core/src/main/java/com/google/cloud/tools/jib/configuration/ContainerConfiguration.java\nindex e040f3df..0dbdbc5d 100644\n--- a/jib-core/src/main/java/com/google/cloud/tools/jib/configuration/ContainerConfiguration.java\n+++ b/jib-core/src/main/java/com/google/cloud/tools/jib/configuration/ContainerConfiguration.java\n\n@@ -122,7 +122,8 @@ public class ContainerConfiguration {\n         this.programArguments = null;\n       } else {\n         Preconditions.checkArgument(\n-            !programArguments.stream().anyMatch(Objects::isNull), \"program arguments list contains null elements\");\n+            !programArguments.stream().anyMatch(Objects::isNull),\n+            \"program arguments list contains null elements\");\n         this.programArguments = ImmutableList.copyOf(programArguments);\n       }\n       return this;\n"}}, {"oid": "5639c3facb41501889d7f6ab6f317bc069efb82a", "url": "https://github.com/GoogleContainerTools/jib/commit/5639c3facb41501889d7f6ab6f317bc069efb82a", "message": "handle ports", "committedDate": "2020-08-18T18:28:57Z", "type": "commit"}, {"oid": "abe09cfec1e9b2f546193eaf550229249b84632e", "url": "https://github.com/GoogleContainerTools/jib/commit/abe09cfec1e9b2f546193eaf550229249b84632e", "message": "making preconditions more clear", "committedDate": "2020-08-18T19:06:11Z", "type": "commit"}, {"oid": "5949a933eee42a6ce732ad8135cf8f17069d4f89", "url": "https://github.com/GoogleContainerTools/jib/commit/5949a933eee42a6ce732ad8135cf8f17069d4f89", "message": "making preconditions more clear", "committedDate": "2020-08-18T19:08:55Z", "type": "commit"}]}