{"pr_number": 2235, "pr_title": "Import Cram as Jib CLI", "pr_createdAt": "2020-01-16T05:26:59Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2235", "timeline": [{"oid": "ab52d6af010bfca73fdc1b42e98a0de8fe997d5a", "url": "https://github.com/GoogleContainerTools/jib/commit/ab52d6af010bfca73fdc1b42e98a0de8fe997d5a", "message": "Import Cram as Jib CLI", "committedDate": "2020-01-16T05:03:37Z", "type": "commit"}, {"oid": "1fadfe1fe7a031339c8be01995e3e7eb639681b9", "url": "https://github.com/GoogleContainerTools/jib/commit/1fadfe1fe7a031339c8be01995e3e7eb639681b9", "message": "don't import classes in same package", "committedDate": "2020-01-16T05:30:13Z", "type": "commit"}, {"oid": "d45abc5cd926bef8662f01f15e7c5fd980f306e1", "url": "https://github.com/GoogleContainerTools/jib/commit/d45abc5cd926bef8662f01f15e7c5fd980f306e1", "message": "Add more tests", "committedDate": "2020-01-20T20:13:37Z", "type": "commit"}, {"oid": "3d852cba0a3d03840d22a88ae9499ade813615b8", "url": "https://github.com/GoogleContainerTools/jib/commit/3d852cba0a3d03840d22a88ae9499ade813615b8", "message": "Merge remote-tracking branch 'origin/master' into HEAD", "committedDate": "2020-01-20T20:13:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA3OTc0OA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2235#discussion_r369079748", "bodyText": "Is this used somewhere? I can't find it. I'm wary of people using this provider if it's going to be used for creating an image, because it greatly undermines reproducibility of a layer.", "author": "chanseokoh", "createdAt": "2020-01-21T15:46:00Z", "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/ActualTimestampProvider.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.cli;\n+\n+import com.google.cloud.tools.jib.api.AbsoluteUnixPath;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.time.Instant;\n+import java.util.function.BiFunction;\n+\n+/** A timetamp provider that uses the actual file last-modification time from the file-system. */\n+class ActualTimestampProvider implements BiFunction<Path, AbsoluteUnixPath, Instant> {", "originalCommit": "3d852cba0a3d03840d22a88ae9499ade813615b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEyMjM1MA==", "url": "https://github.com/GoogleContainerTools/jib/pull/2235#discussion_r369122350", "bodyText": "It's pulled in from LayerParserDefinition#parseTimestampsDirective().", "author": "briandealwis", "createdAt": "2020-01-21T16:55:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA3OTc0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTE0OTgyNQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2235#discussion_r395149825", "bodyText": "So the question is, should we drop support for ts=actual? Jib plugins don't support it (and will never after we build an extension framework). I find think this is very useful, especially when considering the negatives. If someone really wanted to set it to the last modification time of some file, I think they could get easily it in a shell script.\n              + \"  ts=timestamp  set last-modified timestamps:\\n\"\n              + \"    actual      use actual values in file-system\\n\"`\n\nHowever, this doesn't need to to addressed in this PR (in case you agree).", "author": "chanseokoh", "createdAt": "2020-03-19T16:17:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA3OTc0OA=="}], "type": "inlineReview", "revised_code": {"commit": "1f3501ea5218ae9a2e3b7ed7abaa9f550df740f1", "chunk": "diff --git a/jib-cli/src/main/java/com/google/cloud/tools/jib/cli/ActualTimestampProvider.java b/jib-cli/src/main/java/com/google/cloud/tools/jib/cli/ActualTimestampProvider.java\nindex 0f48f62c..87ad5c83 100644\n--- a/jib-cli/src/main/java/com/google/cloud/tools/jib/cli/ActualTimestampProvider.java\n+++ b/jib-cli/src/main/java/com/google/cloud/tools/jib/cli/ActualTimestampProvider.java\n\n@@ -16,7 +16,7 @@\n \n package com.google.cloud.tools.jib.cli;\n \n-import com.google.cloud.tools.jib.api.AbsoluteUnixPath;\n+import com.google.cloud.tools.jib.api.buildplan.AbsoluteUnixPath;\n import java.io.IOException;\n import java.nio.file.Files;\n import java.nio.file.Path;\n"}}, {"oid": "0f092e1e1f5460635cbf636a18aed384bf40178f", "url": "https://github.com/GoogleContainerTools/jib/commit/0f092e1e1f5460635cbf636a18aed384bf40178f", "message": "tweak text", "committedDate": "2020-01-21T21:35:50Z", "type": "commit"}, {"oid": "7f16a977aae395e6b4224a4c5bb01d1ecd573ba6", "url": "https://github.com/GoogleContainerTools/jib/commit/7f16a977aae395e6b4224a4c5bb01d1ecd573ba6", "message": "further tweaks", "committedDate": "2020-01-24T21:58:26Z", "type": "commit"}, {"oid": "820d03a16abbfc353e9674df9644418942bcec90", "url": "https://github.com/GoogleContainerTools/jib/commit/820d03a16abbfc353e9674df9644418942bcec90", "message": "cause tests to include pushmode", "committedDate": "2020-03-15T03:35:44Z", "type": "commit"}, {"oid": "2c9ccb9b5e1409a8a95f56f4822bad3c26ba3d12", "url": "https://github.com/GoogleContainerTools/jib/commit/2c9ccb9b5e1409a8a95f56f4822bad3c26ba3d12", "message": "update to picocli 4.2", "committedDate": "2020-03-15T03:36:43Z", "type": "commit"}, {"oid": "aaff8aee22cacae1a0f24d4a6fbc3aa9ecd73420", "url": "https://github.com/GoogleContainerTools/jib/commit/aaff8aee22cacae1a0f24d4a6fbc3aa9ecd73420", "message": "Add new Build command; refactor tests", "committedDate": "2020-03-18T03:38:48Z", "type": "commit"}, {"oid": "5b49873740c55bc1775a8d05f6772ba63b2ef18d", "url": "https://github.com/GoogleContainerTools/jib/commit/5b49873740c55bc1775a8d05f6772ba63b2ef18d", "message": "make gradle happy", "committedDate": "2020-03-19T13:30:02Z", "type": "commit"}, {"oid": "755df833969508f9da2634a986b73e262e5d5368", "url": "https://github.com/GoogleContainerTools/jib/commit/755df833969508f9da2634a986b73e262e5d5368", "message": "Merge remote-tracking branch 'origin/master' into HEAD", "committedDate": "2020-03-19T13:36:18Z", "type": "commit"}, {"oid": "1f3501ea5218ae9a2e3b7ed7abaa9f550df740f1", "url": "https://github.com/GoogleContainerTools/jib/commit/1f3501ea5218ae9a2e3b7ed7abaa9f550df740f1", "message": "Catchup", "committedDate": "2020-03-19T14:43:08Z", "type": "commit"}, {"oid": "0922b2bb857468734fab66d6724f63823df73e85", "url": "https://github.com/GoogleContainerTools/jib/commit/0922b2bb857468734fab66d6724f63823df73e85", "message": "nits", "committedDate": "2020-03-20T04:29:00Z", "type": "commit"}, {"oid": "4f7c59c13b5c004c6db571045d2c396027aaed75", "url": "https://github.com/GoogleContainerTools/jib/commit/4f7c59c13b5c004c6db571045d2c396027aaed75", "message": "capitalize", "committedDate": "2020-03-20T04:29:08Z", "type": "commit"}, {"oid": "1082a3838a4064a3dcaa3e6d41c0db23e9781b0e", "url": "https://github.com/GoogleContainerTools/jib/commit/1082a3838a4064a3dcaa3e6d41c0db23e9781b0e", "message": "drop unnecessary lines from build.gradle", "committedDate": "2020-03-20T19:25:21Z", "type": "commit"}]}