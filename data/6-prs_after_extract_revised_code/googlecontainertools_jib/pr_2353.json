{"pr_number": 2353, "pr_title": "Build plan adapter methods for JibContainerBuilder", "pr_createdAt": "2020-03-23T19:55:28Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2353", "timeline": [{"oid": "0d2941290462707fb0ade240479c0ca813d4729a", "url": "https://github.com/GoogleContainerTools/jib/commit/0d2941290462707fb0ade240479c0ca813d4729a", "message": "Adapters between JibContainerBuilder and ContainerBuildPlan", "committedDate": "2020-03-23T19:52:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg3Mzk5Ng==", "url": "https://github.com/GoogleContainerTools/jib/pull/2353#discussion_r398873996", "bodyText": "Could we mask it with an interface?", "author": "loosebazooka", "createdAt": "2020-03-26T20:34:58Z", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/api/JibContainerBuilder.java", "diffHunk": "@@ -542,12 +568,87 @@ public JibContainer containerize(Containerizer containerizer)\n    * Describes the container contents and configuration without actually physically building a\n    * container.\n    *\n+   * @deprecated use {@link #toContainerBuildPlan}.\n    * @return a description of the container being built\n    */\n+  @Deprecated\n   public JibContainerDescription describeContainer() {\n     return new JibContainerDescription(layerConfigurations);\n   }\n \n+  /**\n+   * Internal method. API end users should not use it.\n+   *\n+   * <p>Converts to {@link ContainerBuildPlan}. Note that not all values that this class holds can\n+   * be described by a build plan, such as {@link CredentialRetriever}s for {@link RegistryImage},\n+   * {@link DockerClient} for {@link DockerDaemonImage}, and output path for {@link TarImage}.\n+   *\n+   * @return {@link ContainerBuildPlan}\n+   */\n+  public ContainerBuildPlan toContainerBuildPlan() {", "originalCommit": "0d2941290462707fb0ade240479c0ca813d4729a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg3NDI3OQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2353#discussion_r398874279", "bodyText": "And have an internal impl (kinda like how gradle has ProjectInternal)", "author": "loosebazooka", "createdAt": "2020-03-26T20:35:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg3Mzk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk0NjEyMQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2353#discussion_r398946121", "bodyText": "hrmm.. so maybe this is okay for now", "author": "loosebazooka", "createdAt": "2020-03-26T23:12:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg3Mzk5Ng=="}], "type": "inlineReview", "revised_code": {"commit": "13b488d0cff5435a573a2bd44f706fc71312b6fe", "chunk": "diff --git a/jib-core/src/main/java/com/google/cloud/tools/jib/api/JibContainerBuilder.java b/jib-core/src/main/java/com/google/cloud/tools/jib/api/JibContainerBuilder.java\nindex 8810c329..ed975bc6 100644\n--- a/jib-core/src/main/java/com/google/cloud/tools/jib/api/JibContainerBuilder.java\n+++ b/jib-core/src/main/java/com/google/cloud/tools/jib/api/JibContainerBuilder.java\n\n@@ -644,6 +644,7 @@ public class JibContainerBuilder {\n     layerConfigurations = (List<FileEntriesLayer>) buildPlan.getLayers();\n \n     buildContextBuilder\n+        .setTargetFormat(buildPlan.getFormat())\n         .setBaseImageConfiguration(baseImageConfiguration)\n         .setLayerConfigurations(layerConfigurations);\n     return this;\n"}}, {"oid": "13b488d0cff5435a573a2bd44f706fc71312b6fe", "url": "https://github.com/GoogleContainerTools/jib/commit/13b488d0cff5435a573a2bd44f706fc71312b6fe", "message": "Add missing BuildContext.setFormat", "committedDate": "2020-03-27T13:48:43Z", "type": "commit"}]}