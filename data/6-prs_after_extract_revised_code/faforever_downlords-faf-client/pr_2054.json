{"pr_number": 2054, "pr_title": "Add mapGenerator log", "pr_createdAt": "2020-11-27T22:57:04Z", "pr_url": "https://github.com/FAForever/downlords-faf-client/pull/2054", "timeline": [{"oid": "59143b12aaed9e4edb2dbbe67336829af399cbc6", "url": "https://github.com/FAForever/downlords-faf-client/commit/59143b12aaed9e4edb2dbbe67336829af399cbc6", "message": "Add mapGenerator log", "committedDate": "2020-11-27T22:56:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjAwOTQ0NA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2054#discussion_r532009444", "bodyText": "It needs a better name if it's a special logger", "author": "Brutus5000", "createdAt": "2020-11-28T09:18:29Z", "path": "src/main/java/com/faforever/client/map/generator/GenerateMapTask.java", "diffHunk": "@@ -16,16 +18,15 @@\n \n import javax.inject.Inject;\n import java.io.IOException;\n-import java.lang.invoke.MethodHandles;\n import java.nio.file.Path;\n import java.util.Objects;\n import java.util.concurrent.TimeUnit;\n \n-\n+@Slf4j\n @Component\n @Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)\n public class GenerateMapTask extends CompletableTask<Void> {\n-  private static final Logger logger = LoggerFactory.getLogger(MethodHandles.lookup().lookupClass());\n+  private static final Logger logger = LoggerFactory.getLogger(\"faf-map-generator\");", "originalCommit": "59143b12aaed9e4edb2dbbe67336829af399cbc6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0026ea2c09ae669fa5c261c64fcb7e39290a4c5e", "chunk": "diff --git a/src/main/java/com/faforever/client/map/generator/GenerateMapTask.java b/src/main/java/com/faforever/client/map/generator/GenerateMapTask.java\nindex 85783b1a4..40fcac9d0 100644\n--- a/src/main/java/com/faforever/client/map/generator/GenerateMapTask.java\n+++ b/src/main/java/com/faforever/client/map/generator/GenerateMapTask.java\n\n@@ -26,7 +26,7 @@ import java.util.concurrent.TimeUnit;\n @Component\n @Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)\n public class GenerateMapTask extends CompletableTask<Void> {\n-  private static final Logger logger = LoggerFactory.getLogger(\"faf-map-generator\");\n+  private static final Logger generatorLogger = LoggerFactory.getLogger(\"faf-map-generator\");\n \n   private final PreferencesService preferencesService;\n   private final NotificationService notificationService;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjAwOTUxNg==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2054#discussion_r532009516", "bodyText": "Some linebreaks would improve readability", "author": "Brutus5000", "createdAt": "2020-11-28T09:19:22Z", "path": "src/main/java/com/faforever/client/map/generator/GenerateMapTask.java", "diffHunk": "@@ -60,23 +61,25 @@ protected Void call() throws Exception {\n     Path workingDirectory = preferencesService.getPreferences().getForgedAlliance().getCustomMapsDirectory();\n \n     ProcessBuilder processBuilder = new ProcessBuilder();\n-    processBuilder.inheritIO();\n     processBuilder.directory(workingDirectory.toFile());\n     processBuilder.command(\"java\", \"-jar\", generatorExecutableFile.toAbsolutePath().toString(), \".\", String.valueOf(seed), version, mapFilename);\n+    processBuilder.environment().put(\"LOG_DIR\", preferencesService.getFafLogDirectory().toAbsolutePath().toString());\n \n-    logger.info(\"Starting map generator in directory: {} with command: {}\", processBuilder.directory(), processBuilder.command().stream().reduce((l, r) -> l + \" \" + r).get());\n+    log.info(\"Starting map generator in directory: {} with command: {}\", processBuilder.directory(), processBuilder.command().stream().reduce((l, r) -> l + \" \" + r).get());", "originalCommit": "59143b12aaed9e4edb2dbbe67336829af399cbc6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0026ea2c09ae669fa5c261c64fcb7e39290a4c5e", "chunk": "diff --git a/src/main/java/com/faforever/client/map/generator/GenerateMapTask.java b/src/main/java/com/faforever/client/map/generator/GenerateMapTask.java\nindex 85783b1a4..40fcac9d0 100644\n--- a/src/main/java/com/faforever/client/map/generator/GenerateMapTask.java\n+++ b/src/main/java/com/faforever/client/map/generator/GenerateMapTask.java\n\n@@ -65,16 +65,18 @@ public class GenerateMapTask extends CompletableTask<Void> {\n     processBuilder.command(\"java\", \"-jar\", generatorExecutableFile.toAbsolutePath().toString(), \".\", String.valueOf(seed), version, mapFilename);\n     processBuilder.environment().put(\"LOG_DIR\", preferencesService.getFafLogDirectory().toAbsolutePath().toString());\n \n-    log.info(\"Starting map generator in directory: {} with command: {}\", processBuilder.directory(), processBuilder.command().stream().reduce((l, r) -> l + \" \" + r).get());\n+    log.info(\"Starting map generator in directory: {} with command: {}\",\n+        processBuilder.directory(), processBuilder.command().stream().reduce((l, r) -> l + \" \" + r).get());\n     try {\n       Process process = processBuilder.start();\n-      OsUtils.gobbleLines(process.getInputStream(), logger::info);\n-      OsUtils.gobbleLines(process.getErrorStream(), logger::error);\n+      OsUtils.gobbleLines(process.getInputStream(), generatorLogger::info);\n+      OsUtils.gobbleLines(process.getErrorStream(), generatorLogger::error);\n       process.waitFor(MapGeneratorService.GENERATION_TIMEOUT_SECONDS, TimeUnit.SECONDS);\n       if (process.isAlive()) {\n         log.warn(\"Map generation timed out, killing process...\");\n         process.destroyForcibly();\n-        notificationService.addNotification(new ImmediateNotification(i18n.get(\"game.mapGeneration.failed.title\"), i18n.get(\"game.mapGeneration.failed.message\"), Severity.ERROR));\n+        notificationService.addNotification(new ImmediateNotification(i18n.get(\"game.mapGeneration.failed.title\"),\n+            i18n.get(\"game.mapGeneration.failed.message\"), Severity.ERROR));\n       } else {\n         eventBus.post(new MapGeneratedEvent(mapFilename));\n       }\n"}}, {"oid": "0026ea2c09ae669fa5c261c64fcb7e39290a4c5e", "url": "https://github.com/FAForever/downlords-faf-client/commit/0026ea2c09ae669fa5c261c64fcb7e39290a4c5e", "message": "Add descriptive logger name", "committedDate": "2020-11-28T13:04:40Z", "type": "commit"}]}