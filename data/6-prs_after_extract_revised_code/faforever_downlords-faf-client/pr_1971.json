{"pr_number": 1971, "pr_title": "Randomize maps in top picks show room on load", "pr_createdAt": "2020-10-03T12:07:47Z", "pr_url": "https://github.com/FAForever/downlords-faf-client/pull/1971", "timeline": [{"oid": "f2237591eea6c39899355ec7eef31436d025e6bd", "url": "https://github.com/FAForever/downlords-faf-client/commit/f2237591eea6c39899355ec7eef31436d025e6bd", "message": "Randomize maps in top picks show room on load", "committedDate": "2020-10-03T12:06:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTI4OA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1971#discussion_r499171288", "bodyText": "init with 0", "author": "1-alex98", "createdAt": "2020-10-03T18:34:04Z", "path": "src/main/java/com/faforever/client/map/MapVaultController.java", "diffHunk": "@@ -41,6 +42,7 @@\n   private final EventBus eventBus;\n \n   private MapDetailController mapDetailController;\n+  private int recommendedShowRoomPageCount = 1;", "originalCommit": "f2237591eea6c39899355ec7eef31436d025e6bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTQ1OQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1971#discussion_r499171459", "bodyText": "no better make it an integer, so it can be null. Let's make it so the vault does not break if something is misconfigured in the remote preferences", "author": "1-alex98", "createdAt": "2020-10-03T18:36:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTI4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3NzQ4Nw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1971#discussion_r499177487", "bodyText": "Yeah I can make it null and add a null check but will still have to check for zero too since random.nextInt needs positive", "author": "Sheikah45", "createdAt": "2020-10-03T20:00:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTI4OA=="}], "type": "inlineReview", "revised_code": {"commit": "85402e48d9a88dcd060f9b443686a9f09c842cd4", "chunk": "diff --git a/src/main/java/com/faforever/client/map/MapVaultController.java b/src/main/java/com/faforever/client/map/MapVaultController.java\nindex 248cb988..ba1636fc 100644\n--- a/src/main/java/com/faforever/client/map/MapVaultController.java\n+++ b/src/main/java/com/faforever/client/map/MapVaultController.java\n\n@@ -42,7 +42,7 @@ public class MapVaultController extends VaultEntityController<MapBean> {\n   private final EventBus eventBus;\n \n   private MapDetailController mapDetailController;\n-  private int recommendedShowRoomPageCount = 1;\n+  private Integer recommendedShowRoomPageCount;\n \n   public MapVaultController(MapService mapService, I18n i18n, EventBus eventBus, PreferencesService preferencesService,\n                             UiService uiService, NotificationService notificationService, ReportingService reportingService) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTUzNg==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1971#discussion_r499171536", "bodyText": "null check if null just not set the showRoomCategory I would say", "author": "1-alex98", "createdAt": "2020-10-03T18:37:29Z", "path": "src/main/java/com/faforever/client/map/MapVaultController.java", "diffHunk": "@@ -104,8 +95,16 @@ protected Node getEntityCard(MapBean map) {\n \n   @Override\n   protected List<ShowRoomCategory> getShowRoomCategories() {\n+    Random random = new Random();\n+    int recommendedPage;\n+    if (recommendedShowRoomPageCount > 0) {", "originalCommit": "f2237591eea6c39899355ec7eef31436d025e6bd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "85402e48d9a88dcd060f9b443686a9f09c842cd4", "chunk": "diff --git a/src/main/java/com/faforever/client/map/MapVaultController.java b/src/main/java/com/faforever/client/map/MapVaultController.java\nindex 248cb988..ba1636fc 100644\n--- a/src/main/java/com/faforever/client/map/MapVaultController.java\n+++ b/src/main/java/com/faforever/client/map/MapVaultController.java\n\n@@ -97,7 +102,7 @@ public class MapVaultController extends VaultEntityController<MapBean> {\n   protected List<ShowRoomCategory> getShowRoomCategories() {\n     Random random = new Random();\n     int recommendedPage;\n-    if (recommendedShowRoomPageCount > 0) {\n+    if (recommendedShowRoomPageCount != null && recommendedShowRoomPageCount > 0) {\n       recommendedPage = random.nextInt(recommendedShowRoomPageCount) + 1;\n     } else {\n       recommendedPage = 1;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTY4Mw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1971#discussion_r499171683", "bodyText": "can u try test that? just have a look getRecommendedMapsWithPageCount is called with a valid page is called", "author": "1-alex98", "createdAt": "2020-10-03T18:39:21Z", "path": "src/main/java/com/faforever/client/map/MapVaultController.java", "diffHunk": "@@ -104,8 +95,16 @@ protected Node getEntityCard(MapBean map) {\n \n   @Override\n   protected List<ShowRoomCategory> getShowRoomCategories() {", "originalCommit": "f2237591eea6c39899355ec7eef31436d025e6bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3ODg4Mw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1971#discussion_r499178883", "bodyText": "It doesn't actually call the function unless the showroom is loaded but I will see if I can mock it and test", "author": "Sheikah45", "createdAt": "2020-10-03T20:20:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTY4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "85402e48d9a88dcd060f9b443686a9f09c842cd4", "chunk": "diff --git a/src/main/java/com/faforever/client/map/MapVaultController.java b/src/main/java/com/faforever/client/map/MapVaultController.java\nindex 248cb988..ba1636fc 100644\n--- a/src/main/java/com/faforever/client/map/MapVaultController.java\n+++ b/src/main/java/com/faforever/client/map/MapVaultController.java\n\n@@ -97,7 +102,7 @@ public class MapVaultController extends VaultEntityController<MapBean> {\n   protected List<ShowRoomCategory> getShowRoomCategories() {\n     Random random = new Random();\n     int recommendedPage;\n-    if (recommendedShowRoomPageCount > 0) {\n+    if (recommendedShowRoomPageCount != null && recommendedShowRoomPageCount > 0) {\n       recommendedPage = random.nextInt(recommendedShowRoomPageCount) + 1;\n     } else {\n       recommendedPage = 1;\n"}}, {"oid": "85402e48d9a88dcd060f9b443686a9f09c842cd4", "url": "https://github.com/FAForever/downlords-faf-client/commit/85402e48d9a88dcd060f9b443686a9f09c842cd4", "message": "Add null check and unit test", "committedDate": "2020-10-03T20:25:11Z", "type": "commit"}]}