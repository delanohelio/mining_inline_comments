{"pr_number": 2000, "pr_title": "Adding Advanced Logging", "pr_createdAt": "2020-10-19T19:02:28Z", "pr_url": "https://github.com/FAForever/downlords-faf-client/pull/2000", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAzMzYxOA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2000#discussion_r508033618", "bodyText": "Business logic should be in a service", "author": "1-alex98", "createdAt": "2020-10-19T20:12:32Z", "path": "src/main/java/com/faforever/client/preferences/ui/SettingsController.java", "diffHunk": "@@ -558,5 +562,16 @@ public void onAddAutoChannel() {\n     preferencesService.storeInBackground();\n     channelTextField.clear();\n   }\n+\n+  public void onDebugLogToggle() {\n+    Level logLevel = Level.DEBUG;\n+    final LoggerContext loggerContext = ((Logger) LoggerFactory.getLogger(MethodHandles.lookup().lookupClass())).getLoggerContext();\n+    loggerContext.getLoggerList()\n+        .stream()\n+        .filter(logger -> logger.getName().startsWith(\"com.faforever\"))\n+        .forEach(logger -> ((Logger) LoggerFactory.getLogger(logger.getName())).setLevel(logLevel));\n+\n+    log.info(\"Switching FA Forever logging configuration to {}\", logLevel.levelStr);\n+  }", "originalCommit": "da139f9e3c7557d93bfdf13c414bb191f9825640", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU2ODIzMg==", "url": "https://github.com/FAForever/downlords-faf-client/pull/2000#discussion_r513568232", "bodyText": "OK, I've moved this logic to the PreferencesService, which I think is the most suitable Service for logging configurations.", "author": "Atrocyte", "createdAt": "2020-10-28T16:04:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAzMzYxOA=="}], "type": "inlineReview", "revised_code": {"commit": "930fa83b1c3cf70c966431c475d6bd92613ee4f6", "chunk": "diff --git a/src/main/java/com/faforever/client/preferences/ui/SettingsController.java b/src/main/java/com/faforever/client/preferences/ui/SettingsController.java\nindex d5182bb46..aad8cabbb 100644\n--- a/src/main/java/com/faforever/client/preferences/ui/SettingsController.java\n+++ b/src/main/java/com/faforever/client/preferences/ui/SettingsController.java\n\n@@ -563,15 +611,19 @@ public class SettingsController implements Controller<Node> {\n     channelTextField.clear();\n   }\n \n-  public void onDebugLogToggle() {\n-    Level logLevel = Level.DEBUG;\n-    final LoggerContext loggerContext = ((Logger) LoggerFactory.getLogger(MethodHandles.lookup().lookupClass())).getLoggerContext();\n-    loggerContext.getLoggerList()\n-        .stream()\n-        .filter(logger -> logger.getName().startsWith(\"com.faforever\"))\n-        .forEach(logger -> ((Logger) LoggerFactory.getLogger(logger.getName())).setLevel(logLevel));\n-\n-    log.info(\"Switching FA Forever logging configuration to {}\", logLevel.levelStr);\n+  public void onPatchGamePrefsForMultipleInstances() {\n+    try {\n+      gameService.patchGamePrefsForMultiInstances()\n+          .thenRun(() -> Platform.runLater(() -> allowReplayWhileInGameButton.setDisable(true)))\n+          .exceptionally(throwable -> {\n+            log.error(\"Game.prefs patch failed\", throwable);\n+            notificationService.addImmediateErrorNotification(throwable, \"settings.fa.patchGamePrefsFailed\");\n+            return null;\n+          });\n+    } catch (Exception e) {\n+      log.error(\"Game.prefs patch failed\", e);\n+      notificationService.addImmediateErrorNotification(e, \"settings.fa.patchGamePrefsFailed\");\n+    }\n   }\n }\n \n"}}, {"oid": "930fa83b1c3cf70c966431c475d6bd92613ee4f6", "url": "https://github.com/FAForever/downlords-faf-client/commit/930fa83b1c3cf70c966431c475d6bd92613ee4f6", "message": "Add Debug Logging Toggle", "committedDate": "2021-01-06T00:57:42Z", "type": "commit"}, {"oid": "930fa83b1c3cf70c966431c475d6bd92613ee4f6", "url": "https://github.com/FAForever/downlords-faf-client/commit/930fa83b1c3cf70c966431c475d6bd92613ee4f6", "message": "Add Debug Logging Toggle", "committedDate": "2021-01-06T00:57:42Z", "type": "forcePushed"}]}