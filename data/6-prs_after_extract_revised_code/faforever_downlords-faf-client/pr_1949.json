{"pr_number": 1949, "pr_title": "Issue/#1770 use gametype for determining which games to show", "pr_createdAt": "2020-09-25T01:35:50Z", "pr_url": "https://github.com/FAForever/downlords-faf-client/pull/1949", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTI0Njg0MQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r495246841", "bodyText": "Just ladder not be excluded as well", "author": "1-alex98", "createdAt": "2020-09-25T21:32:17Z", "path": "src/main/java/com/faforever/client/chat/ChatUserContextMenuController.java", "diffHunk": "@@ -201,15 +201,12 @@ public void setChatUser(ChatChannelUser chatUser) {\n       removeFoeItem.visibleProperty().bind(newValue.socialStatusProperty().isEqualTo(FOE));\n       reportItem.visibleProperty().bind(newValue.socialStatusProperty().isNotEqualTo(SELF));\n \n-      // TODO: Make this ignore TMM games too and not just ladder\n-      // https://github.com/FAForever/downlords-faf-client/issues/1770\n       joinGameItem.visibleProperty().bind(newValue.socialStatusProperty().isNotEqualTo(SELF)\n           .and(newValue.statusProperty().isEqualTo(PlayerStatus.LOBBYING)\n               .or(newValue.statusProperty().isEqualTo(PlayerStatus.HOSTING)))\n           .and(Bindings.createBooleanBinding(() -> {\n                 return newValue.getGame() != null\n-                    && newValue.getGame().getFeaturedMod() != null\n-                    && !newValue.getGame().getFeaturedMod().equals(KnownFeaturedMod.LADDER_1V1.getTechnicalName());\n+                    && newValue.getGame().getGameType() != GameType.MATCHMAKER;", "originalCommit": "d609a5a470c09381094c5564258724b07fa3df5b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTI5ODUzNw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r495298537", "bodyText": "Ladder falls into the category of matchmaker games", "author": "Askaholic", "createdAt": "2020-09-25T22:55:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTI0Njg0MQ=="}], "type": "inlineReview", "revised_code": {"commit": "97742654ff6c7c01c0b9881b7749e9d00d439693", "chunk": "diff --git a/src/main/java/com/faforever/client/chat/ChatUserContextMenuController.java b/src/main/java/com/faforever/client/chat/ChatUserContextMenuController.java\nindex ea6797aea..dc7b86377 100644\n--- a/src/main/java/com/faforever/client/chat/ChatUserContextMenuController.java\n+++ b/src/main/java/com/faforever/client/chat/ChatUserContextMenuController.java\n\n@@ -201,12 +201,15 @@ public class ChatUserContextMenuController implements Controller<ContextMenu> {\n       removeFoeItem.visibleProperty().bind(newValue.socialStatusProperty().isEqualTo(FOE));\n       reportItem.visibleProperty().bind(newValue.socialStatusProperty().isNotEqualTo(SELF));\n \n+      // TODO: Make this ignore TMM games too and not just ladder\n+      // https://github.com/FAForever/downlords-faf-client/issues/1770\n       joinGameItem.visibleProperty().bind(newValue.socialStatusProperty().isNotEqualTo(SELF)\n           .and(newValue.statusProperty().isEqualTo(PlayerStatus.LOBBYING)\n               .or(newValue.statusProperty().isEqualTo(PlayerStatus.HOSTING)))\n           .and(Bindings.createBooleanBinding(() -> {\n                 return newValue.getGame() != null\n-                    && newValue.getGame().getGameType() != GameType.MATCHMAKER;\n+                    && newValue.getGame().getFeaturedMod() != null\n+                    && !newValue.getGame().getFeaturedMod().equals(KnownFeaturedMod.LADDER_1V1.getTechnicalName());\n               }, newValue.gameProperty())\n           ));\n       watchGameItem.visibleProperty().bind(newValue.statusProperty().isEqualTo(PlayerStatus.PLAYING));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTI0NzYyMA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r495247620", "bodyText": "@slf4j not working on enums?", "author": "1-alex98", "createdAt": "2020-09-25T21:33:22Z", "path": "src/main/java/com/faforever/client/remote/domain/GameType.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package com.faforever.client.remote.domain;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import java.lang.invoke.MethodHandles;\n+import java.util.HashMap;\n+import java.util.Locale;\n+import java.util.Map;\n+\n+public enum GameType {\n+\n+  UNKNOWN(\"unknown\"),\n+  CUSTOM(\"custom\"),\n+  MATCHMAKER(\"matchmaker\"),\n+  COOP(\"coop\"),\n+  TUTORIAL(\"tutorial\");\n+\n+  private static final Logger logger = LoggerFactory.getLogger(MethodHandles.lookup().lookupClass());", "originalCommit": "d609a5a470c09381094c5564258724b07fa3df5b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTI5ODkzNQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r495298935", "bodyText": "No idea I just copy and pasted from GameStatus", "author": "Askaholic", "createdAt": "2020-09-25T22:56:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTI0NzYyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQzOTQ0OQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r495439449", "bodyText": "Try use the annotation", "author": "1-alex98", "createdAt": "2020-09-26T09:47:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTI0NzYyMA=="}], "type": "inlineReview", "revised_code": {"commit": "482f570108b2edece7d1dbf6ca1c34e79c464afe", "chunk": "diff --git a/src/main/java/com/faforever/client/remote/domain/GameType.java b/src/main/java/com/faforever/client/remote/domain/GameType.java\nindex 45d7fe71b..3f2270ff6 100644\n--- a/src/main/java/com/faforever/client/remote/domain/GameType.java\n+++ b/src/main/java/com/faforever/client/remote/domain/GameType.java\n\n@@ -1,13 +1,12 @@\n package com.faforever.client.remote.domain;\n \n-import org.slf4j.Logger;\n-import org.slf4j.LoggerFactory;\n+import lombok.extern.slf4j.Slf4j;\n \n-import java.lang.invoke.MethodHandles;\n import java.util.HashMap;\n import java.util.Locale;\n import java.util.Map;\n \n+@Slf4j\n public enum GameType {\n \n   UNKNOWN(\"unknown\"),\n"}}, {"oid": "482f570108b2edece7d1dbf6ca1c34e79c464afe", "url": "https://github.com/FAForever/downlords-faf-client/commit/482f570108b2edece7d1dbf6ca1c34e79c464afe", "message": "Check game_type instead of featured mod everywhere", "committedDate": "2020-09-26T18:34:32Z", "type": "forcePushed"}, {"oid": "2d8442d4dad61a56bb75f8092b27907ba6d56fc9", "url": "https://github.com/FAForever/downlords-faf-client/commit/2d8442d4dad61a56bb75f8092b27907ba6d56fc9", "message": "Check game_type instead of featured mod everywhere", "committedDate": "2020-10-01T19:05:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgzOTg1Mw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r498839853", "bodyText": "This dupe a typo? The 800 will do nothing.  That a 'min' rating perhaps?", "author": "dev-nulled", "createdAt": "2020-10-02T14:00:04Z", "path": "src/test/java/com/faforever/client/game/GameBuilder.java", "diffHunk": "@@ -34,6 +35,7 @@ public GameBuilder defaultValues() {\n     game.setMaxRating(800);\n     game.setMaxRating(1300);", "originalCommit": "2d8442d4dad61a56bb75f8092b27907ba6d56fc9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTgwMw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r499171803", "bodyText": "This code is only used for testing. But yes this is probably a typo", "author": "1-alex98", "createdAt": "2020-10-03T18:41:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgzOTg1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTg2Ng==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r499171866", "bodyText": "Make a PR if you like XD @dev-nulled heard u get t-shirts for those", "author": "1-alex98", "createdAt": "2020-10-03T18:42:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgzOTg1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE3MTk3NQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r499171975", "bodyText": "Sadly this one was opened too early so it doesn\u2019t count :P", "author": "Askaholic", "createdAt": "2020-10-03T18:43:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgzOTg1Mw=="}], "type": "inlineReview", "revised_code": {"commit": "dac19a2896552d92e2001cb9cc855f081f44b74e", "chunk": "diff --git a/src/test/java/com/faforever/client/game/GameBuilder.java b/src/test/java/com/faforever/client/game/GameBuilder.java\nindex a5869a21e..403ea2d27 100644\n--- a/src/test/java/com/faforever/client/game/GameBuilder.java\n+++ b/src/test/java/com/faforever/client/game/GameBuilder.java\n\n@@ -32,7 +32,7 @@ public class GameBuilder {\n     game.setTitle(\"Title\");\n     game.setTeams(FXCollections.emptyObservableMap());\n     game.setId(1);\n-    game.setMaxRating(800);\n+    game.setMinRating(800);\n     game.setMaxRating(1300);\n     game.setStartTime(Instant.now());\n     game.setGameType(GameType.CUSTOM);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3ODQ3Mg==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r499278472", "bodyText": "I think it should be if(Matchmaker) right? This is needed though I think. Can u check this?", "author": "1-alex98", "createdAt": "2020-10-04T19:08:23Z", "path": "src/main/java/com/faforever/client/fa/relay/ice/IceAdapterImpl.java", "diffHunk": "@@ -297,6 +297,7 @@ private void updateLobbyModeFromGameInfo(GameLaunchMessage gameLaunchMessage) {\n       return;\n     }\n \n+    // TODO: Remove this?", "originalCommit": "2d8442d4dad61a56bb75f8092b27907ba6d56fc9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3OTM4NQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r499279385", "bodyText": "Yea that's what I'm thinking too. We could just get rid of the init mode entirely, and always use autolobby for matchmaker games", "author": "Askaholic", "createdAt": "2020-10-04T19:18:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3ODQ3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1OTg2Mg==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r502959862", "bodyText": "Yes can u do so @Askaholic and then I merge this...", "author": "1-alex98", "createdAt": "2020-10-11T20:06:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3ODQ3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk2MTc5Mw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r502961793", "bodyText": "Ok, will do", "author": "Askaholic", "createdAt": "2020-10-11T20:25:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3ODQ3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUxNDAyNQ==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1949#discussion_r511514025", "bodyText": "So I looked into this, the problem is we didn't add game_type to the game_launch message, so it's not available in this function. I think it's ok to have the extra check for ladder game mode since it would only apply if for some reason the server didn't send the init mode (shouldn't happen, but it doesn't really hurt to have the code in there).", "author": "Askaholic", "createdAt": "2020-10-24T21:02:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3ODQ3Mg=="}], "type": "inlineReview", "revised_code": {"commit": "97742654ff6c7c01c0b9881b7749e9d00d439693", "chunk": "diff --git a/src/main/java/com/faforever/client/fa/relay/ice/IceAdapterImpl.java b/src/main/java/com/faforever/client/fa/relay/ice/IceAdapterImpl.java\nindex 3300b792d..277fc178c 100644\n--- a/src/main/java/com/faforever/client/fa/relay/ice/IceAdapterImpl.java\n+++ b/src/main/java/com/faforever/client/fa/relay/ice/IceAdapterImpl.java\n\n@@ -297,7 +297,6 @@ public class IceAdapterImpl implements IceAdapter, InitializingBean, DisposableB\n       return;\n     }\n \n-    // TODO: Remove this?\n     if (KnownFeaturedMod.LADDER_1V1.getTechnicalName().equals(gameLaunchMessage.getMod())) {\n       lobbyInitMode = LobbyMode.AUTO_LOBBY;\n     } else {\n"}}, {"oid": "dac19a2896552d92e2001cb9cc855f081f44b74e", "url": "https://github.com/FAForever/downlords-faf-client/commit/dac19a2896552d92e2001cb9cc855f081f44b74e", "message": "Fix setting max rating twice", "committedDate": "2020-10-17T21:01:22Z", "type": "forcePushed"}, {"oid": "97742654ff6c7c01c0b9881b7749e9d00d439693", "url": "https://github.com/FAForever/downlords-faf-client/commit/97742654ff6c7c01c0b9881b7749e9d00d439693", "message": "Add enum for game_type", "committedDate": "2020-10-24T20:46:58Z", "type": "commit"}, {"oid": "91dcf64ded0a7ec25118f7b2af8125760e8ca02b", "url": "https://github.com/FAForever/downlords-faf-client/commit/91dcf64ded0a7ec25118f7b2af8125760e8ca02b", "message": "Check game_type instead of featured mod everywhere", "committedDate": "2020-10-24T20:47:02Z", "type": "commit"}, {"oid": "36fb24f4a08b05b2c0633d1efda93d1428b78cfb", "url": "https://github.com/FAForever/downlords-faf-client/commit/36fb24f4a08b05b2c0633d1efda93d1428b78cfb", "message": "Fix setting max rating twice", "committedDate": "2020-10-24T20:47:02Z", "type": "commit"}, {"oid": "36fb24f4a08b05b2c0633d1efda93d1428b78cfb", "url": "https://github.com/FAForever/downlords-faf-client/commit/36fb24f4a08b05b2c0633d1efda93d1428b78cfb", "message": "Fix setting max rating twice", "committedDate": "2020-10-24T20:47:02Z", "type": "forcePushed"}, {"oid": "53e79efa479468b60e78392c4abba70b477ebec0", "url": "https://github.com/FAForever/downlords-faf-client/commit/53e79efa479468b60e78392c4abba70b477ebec0", "message": "Add TODO for getting rid of init_mode in game_launch mesage", "committedDate": "2020-10-24T20:54:13Z", "type": "commit"}, {"oid": "e9c0dae6b22991db437223ae2e066cb7ac6cf36f", "url": "https://github.com/FAForever/downlords-faf-client/commit/e9c0dae6b22991db437223ae2e066cb7ac6cf36f", "message": "Merge branch 'develop' into issue/#1770-use-gametype-for-filtering", "committedDate": "2020-11-06T02:51:53Z", "type": "commit"}, {"oid": "7daa44a5c748f60c3ee359a94d0a94e94f004457", "url": "https://github.com/FAForever/downlords-faf-client/commit/7daa44a5c748f60c3ee359a94d0a94e94f004457", "message": "Merge branch 'develop' into issue/#1770-use-gametype-for-filtering", "committedDate": "2020-11-06T03:02:37Z", "type": "commit"}]}