{"pr_number": 2521, "pr_title": "GraphQL: Add Option For Separated Arguments ", "pr_createdAt": "2020-08-17T21:39:57Z", "pr_url": "https://github.com/zaproxy/zap-extensions/pull/2521", "timeline": [{"oid": "a6c4a9bd7ebf063c7d777f52fca7071062cbd862", "url": "https://github.com/zaproxy/zap-extensions/commit/a6c4a9bd7ebf063c7d777f52fca7071062cbd862", "message": "Add Option For Separated Arguments\n\n- Add option to provide arguments using variables (i.e. not inline)\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-18T15:18:07Z", "type": "forcePushed"}, {"oid": "6c3787379398d9005b3cca54d05e4d009e7abdba", "url": "https://github.com/zaproxy/zap-extensions/commit/6c3787379398d9005b3cca54d05e4d009e7abdba", "message": "Add Option For Separated Arguments\n\n- Add option to provide arguments using variables (i.e. not inline)\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-18T19:44:30Z", "type": "forcePushed"}, {"oid": "48e62038dc73ca3d3c0ce26999a2ff7babc60e4c", "url": "https://github.com/zaproxy/zap-extensions/commit/48e62038dc73ca3d3c0ce26999a2ff7babc60e4c", "message": "Add Option For Separated Arguments\n\n- Add option to provide arguments using variables (i.e. not inline)\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-19T17:40:07Z", "type": "forcePushed"}, {"oid": "8a329ecbc8b659b5a82c8842f5df61d377c8c8a6", "url": "https://github.com/zaproxy/zap-extensions/commit/8a329ecbc8b659b5a82c8842f5df61d377c8c8a6", "message": "Add Option For Separated Arguments\n\n- Add an option to provide arguments using variables.\n- Stop query generation when a new session is created.\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-23T05:51:45Z", "type": "forcePushed"}, {"oid": "25da89018ea23f5f232b14f873650e7ac42b8cf2", "url": "https://github.com/zaproxy/zap-extensions/commit/25da89018ea23f5f232b14f873650e7ac42b8cf2", "message": "Add Option For Separated Arguments\n\n- Add an option to provide arguments using variables.\n- Stop query generation when a new session is created.\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-23T09:33:09Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzA4MDc0Nw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2521#discussion_r477080747", "bodyText": "Just package accessibility?", "author": "thc202", "createdAt": "2020-08-26T07:08:15Z", "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java", "diffHunk": "@@ -141,6 +148,33 @@ protected GraphQlParam getParam() {\n         return param;\n     }\n \n+    public void addParserThread(ParserThread thread) {", "originalCommit": "25da89018ea23f5f232b14f873650e7ac42b8cf2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "456253021cac128e27c8077f5dad86ee3a6abae6", "chunk": "diff --git a/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java b/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java\nindex d8796b429..58077b463 100644\n--- a/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java\n+++ b/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java\n\n@@ -148,17 +149,20 @@ public class ExtensionGraphQl extends ExtensionAdaptor\n         return param;\n     }\n \n-    public void addParserThread(ParserThread thread) {\n+    protected void addParserThread(ParserThread thread) {\n         parserThreads.add(thread);\n     }\n \n     private void stopParserThreads() {\n-        for (ParserThread thread : parserThreads) {\n-            if (thread.isRunning()) {\n-                LOG.debug(\"Stopping Thread \" + thread.getName());\n-                thread.stopParser();\n+        synchronized (parserThreads) {\n+            for (ParserThread thread : parserThreads) {\n+                if (thread.isRunning()) {\n+                    LOG.debug(\"Stopping Thread \" + thread.getName());\n+                    thread.stopParser();\n+                }\n             }\n         }\n+        parserThreads.clear();\n     }\n \n     @Override\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzA4MDc2Ng==", "url": "https://github.com/zaproxy/zap-extensions/pull/2521#discussion_r477080766", "bodyText": "We should clear the list too, to not keep references to the threads longer than needed (ideally the thread/parser would remove itself once done too).", "author": "thc202", "createdAt": "2020-08-26T07:08:17Z", "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java", "diffHunk": "@@ -141,6 +148,33 @@ protected GraphQlParam getParam() {\n         return param;\n     }\n \n+    public void addParserThread(ParserThread thread) {\n+        parserThreads.add(thread);\n+    }\n+\n+    private void stopParserThreads() {", "originalCommit": "25da89018ea23f5f232b14f873650e7ac42b8cf2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "456253021cac128e27c8077f5dad86ee3a6abae6", "chunk": "diff --git a/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java b/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java\nindex d8796b429..58077b463 100644\n--- a/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java\n+++ b/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java\n\n@@ -148,17 +149,20 @@ public class ExtensionGraphQl extends ExtensionAdaptor\n         return param;\n     }\n \n-    public void addParserThread(ParserThread thread) {\n+    protected void addParserThread(ParserThread thread) {\n         parserThreads.add(thread);\n     }\n \n     private void stopParserThreads() {\n-        for (ParserThread thread : parserThreads) {\n-            if (thread.isRunning()) {\n-                LOG.debug(\"Stopping Thread \" + thread.getName());\n-                thread.stopParser();\n+        synchronized (parserThreads) {\n+            for (ParserThread thread : parserThreads) {\n+                if (thread.isRunning()) {\n+                    LOG.debug(\"Stopping Thread \" + thread.getName());\n+                    thread.stopParser();\n+                }\n             }\n         }\n+        parserThreads.clear();\n     }\n \n     @Override\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzA4NTM2MQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2521#discussion_r477085361", "bodyText": "This should be synchronised (e.g. wrap with Collections.synchronizedList), to not add while looping (which would lead to a ConcurrentModificationException).", "author": "thc202", "createdAt": "2020-08-26T07:18:01Z", "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java", "diffHunk": "@@ -49,6 +54,7 @@\n     private ParseFilter graphQlParseFilter;\n     private GraphQlOptionsPanel graphQlOptionsPanel;\n     private GraphQlParam param;\n+    private List<ParserThread> parserThreads = new ArrayList<>();", "originalCommit": "25da89018ea23f5f232b14f873650e7ac42b8cf2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "456253021cac128e27c8077f5dad86ee3a6abae6", "chunk": "diff --git a/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java b/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java\nindex d8796b429..58077b463 100644\n--- a/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java\n+++ b/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java\n\n@@ -54,7 +55,7 @@ public class ExtensionGraphQl extends ExtensionAdaptor\n     private ParseFilter graphQlParseFilter;\n     private GraphQlOptionsPanel graphQlOptionsPanel;\n     private GraphQlParam param;\n-    private List<ParserThread> parserThreads = new ArrayList<>();\n+    private List<ParserThread> parserThreads = Collections.synchronizedList(new ArrayList<>());\n \n     private static final int ARG_IMPORT_FILE_IDX = 0;\n     private static final int ARG_IMPORT_URL_IDX = 1;\n"}}, {"oid": "456253021cac128e27c8077f5dad86ee3a6abae6", "url": "https://github.com/zaproxy/zap-extensions/commit/456253021cac128e27c8077f5dad86ee3a6abae6", "message": "Add Option For Separated Arguments\n\n- Add an option to provide arguments using variables.\n- Stop query generation when a new session is created.\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-26T10:20:08Z", "type": "forcePushed"}, {"oid": "5c55b30fcf886e2cca093f3dab6ba53d25bbbacc", "url": "https://github.com/zaproxy/zap-extensions/commit/5c55b30fcf886e2cca093f3dab6ba53d25bbbacc", "message": "Add Option For Separated Arguments\n\n- Add an option to provide arguments using variables.\n- Stop query generation when a new session is created.\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-28T11:21:32Z", "type": "forcePushed"}, {"oid": "b0e0194a8b748affa23196ee4646079a086f3e23", "url": "https://github.com/zaproxy/zap-extensions/commit/b0e0194a8b748affa23196ee4646079a086f3e23", "message": "Add Option For Separated Arguments\n\n- Add an option to provide arguments using variables.\n- Stop query generation when a new session is created.\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-28T11:56:18Z", "type": "forcePushed"}, {"oid": "2864300d1c088a0f8ac9cefc6d618f6adf57bc04", "url": "https://github.com/zaproxy/zap-extensions/commit/2864300d1c088a0f8ac9cefc6d618f6adf57bc04", "message": "Add Option For Separated Arguments\n\n- Add an option to provide arguments using variables.\n- Stop query generation when a new session is created.\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-28T11:58:39Z", "type": "forcePushed"}, {"oid": "988caa62cbefdb02cf753cb452a3e78f87a26d4a", "url": "https://github.com/zaproxy/zap-extensions/commit/988caa62cbefdb02cf753cb452a3e78f87a26d4a", "message": "Add Option For Separated Arguments\n\n- Add an option to provide arguments using variables.\n- Stop query generation when a new session is created.\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-28T12:41:20Z", "type": "commit"}, {"oid": "988caa62cbefdb02cf753cb452a3e78f87a26d4a", "url": "https://github.com/zaproxy/zap-extensions/commit/988caa62cbefdb02cf753cb452a3e78f87a26d4a", "message": "Add Option For Separated Arguments\n\n- Add an option to provide arguments using variables.\n- Stop query generation when a new session is created.\n\nSigned-off-by: ricekot <ricekot@gmail.com>", "committedDate": "2020-08-28T12:41:20Z", "type": "forcePushed"}]}