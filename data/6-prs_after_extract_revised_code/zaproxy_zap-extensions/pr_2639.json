{"pr_number": 2639, "pr_title": "Update ascanrulesBeta to take advantage of 2.10 core", "pr_createdAt": "2020-12-02T23:25:38Z", "pr_url": "https://github.com/zaproxy/zap-extensions/pull/2639", "timeline": [{"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999", "url": "https://github.com/zaproxy/zap-extensions/commit/58e1536ce6cc3059cceb99fcd7afcf47ae44b999", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-12-02T23:42:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQxMg==", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539363412", "bodyText": "The 0 check can be removed, the base messages now have a response always.", "author": "thc202", "createdAt": "2020-12-09T14:43:04Z", "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/HttpsAsHttpScanRule.java", "diffHunk": "@@ -101,12 +101,14 @@ public void scan() {\n         }\n \n         int originalStatusCode = getBaseMsg().getResponseHeader().getStatusCode();\n-        if (originalStatusCode == HttpStatusCode.NOT_FOUND || originalStatusCode == 0) {\n+        boolean was404 = isPage404(getBaseMsg());\n+        if (was404 || originalStatusCode == 0) {", "originalCommit": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a5e8ce6b5362063ddde04d04e864af8dad3b6280", "chunk": "diff --git a/addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/HttpsAsHttpScanRule.java b/addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/HttpsAsHttpScanRule.java\nindex 886017c6b..4e2da1080 100644\n--- a/addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/HttpsAsHttpScanRule.java\n+++ b/addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/HttpsAsHttpScanRule.java\n\n@@ -102,7 +102,7 @@ public class HttpsAsHttpScanRule extends AbstractAppPlugin {\n \n         int originalStatusCode = getBaseMsg().getResponseHeader().getStatusCode();\n         boolean was404 = isPage404(getBaseMsg());\n-        if (was404 || originalStatusCode == 0) {\n+        if (was404) {\n             if (log.isDebugEnabled()) {\n                 log.debug(\n                         \"The original request was not successfuly completed (status = \"\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA==", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539363490", "bodyText": "Remove? It will be always false. (Same comment for following changes.)", "author": "thc202", "createdAt": "2020-12-09T14:43:10Z", "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java", "diffHunk": "@@ -388,6 +389,8 @@ public void scan() {\n                                             + \"] with param [\"\n                                             + currentHtmlParameter.getName()\n                                             + \"] = NULL (possibly somewhere in the redirects)\");\n+                            log.debug(\"isPage200 returned: \" + was200);", "originalCommit": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM3OTY1Mg==", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539379652", "bodyText": "I figured it was good to be consistent with the logging, since the existing message lists the status code?", "author": "kingthorin", "createdAt": "2020-12-09T15:01:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM4MjkyNQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539382925", "bodyText": "I can revert it, just want to be sure we're on the same page.\nAlso for \"following changes\" did you mean just the logging or the other isPage200s as well? (I assume logging, but again want to assure we're aligned.)", "author": "kingthorin", "createdAt": "2020-12-09T15:05:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM4Njk0NQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539386945", "bodyText": "Right, that might be confusing, drop the status code instead? Just say  \"Got a non-200 response when ....\"?\nYeah, it was for the logging.", "author": "thc202", "createdAt": "2020-12-09T15:10:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM4Nzc5OQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539387799", "bodyText": "Perfect  \ud83d\ude00", "author": "kingthorin", "createdAt": "2020-12-09T15:11:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA=="}], "type": "inlineReview", "revised_code": {"commit": "a5e8ce6b5362063ddde04d04e864af8dad3b6280", "chunk": "diff --git a/addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java b/addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java\nindex 448e249ee..6ebfbb124 100644\n--- a/addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java\n+++ b/addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java\n\n@@ -382,14 +382,11 @@ public class SessionFixationScanRule extends AbstractAppPlugin {\n                     if (!was200) {\n                         if (this.debugEnabled) {\n                             log.debug(\n-                                    \"Got a non-200 response code [\"\n-                                            + msg1Final.getResponseHeader().getStatusCode()\n-                                            + \"] when sending [\"\n+                                    \"Got a non-200 response code when sending [\"\n                                             + msg1Initial.getRequestHeader().getURI()\n                                             + \"] with param [\"\n                                             + currentHtmlParameter.getName()\n                                             + \"] = NULL (possibly somewhere in the redirects)\");\n-                            log.debug(\"isPage200 returned: \" + was200);\n                         }\n                         continue;\n                     }\n"}}, {"oid": "a5e8ce6b5362063ddde04d04e864af8dad3b6280", "url": "https://github.com/zaproxy/zap-extensions/commit/a5e8ce6b5362063ddde04d04e864af8dad3b6280", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-12-09T15:24:22Z", "type": "forcePushed"}, {"oid": "c3a161a27a7f01aaf04099831a5fc1215f72645e", "url": "https://github.com/zaproxy/zap-extensions/commit/c3a161a27a7f01aaf04099831a5fc1215f72645e", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-12-09T15:29:40Z", "type": "forcePushed"}, {"oid": "1a5601bb99898fce99cec4c1191bbac79037a7e2", "url": "https://github.com/zaproxy/zap-extensions/commit/1a5601bb99898fce99cec4c1191bbac79037a7e2", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-12-09T15:32:23Z", "type": "commit"}, {"oid": "1a5601bb99898fce99cec4c1191bbac79037a7e2", "url": "https://github.com/zaproxy/zap-extensions/commit/1a5601bb99898fce99cec4c1191bbac79037a7e2", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-12-09T15:32:23Z", "type": "forcePushed"}]}