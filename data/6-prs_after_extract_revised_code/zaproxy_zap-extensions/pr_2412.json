{"pr_number": 2412, "pr_title": "encoder: Implement Base64 options", "pr_createdAt": "2020-05-27T20:32:09Z", "pr_url": "https://github.com/zaproxy/zap-extensions/pull/2412", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQyNTgzNw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2412#discussion_r431425837", "bodyText": "I left this dated 2012. Since the only thing that changed was the key names and package declaration.\nI did re-date the Param class itself as it was essentially re-written.", "author": "kingthorin", "createdAt": "2020-05-27T20:35:22Z", "path": "addOns/encoder/src/main/java/org/zaproxy/addon/encoder/EncodeDecodeParamPanel.java", "diffHunk": "@@ -0,0 +1,151 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2012 The ZAP Development Team", "originalCommit": "b1d113600a9c9d6e8b8fc29cbfd24fbb4a4444b1", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b69b41b2e1940402bf81a8781f7ce54f01256e4f", "chunk": "diff --git a/addOns/encoder/src/main/java/org/zaproxy/addon/encoder/EncodeDecodeParamPanel.java b/addOns/encoder/src/main/java/org/zaproxy/addon/encoder/EncodeDecodeOptionsPanel.java\nsimilarity index 93%\nrename from addOns/encoder/src/main/java/org/zaproxy/addon/encoder/EncodeDecodeParamPanel.java\nrename to addOns/encoder/src/main/java/org/zaproxy/addon/encoder/EncodeDecodeOptionsPanel.java\nindex 4280ae72d..3333be6d8 100644\n--- a/addOns/encoder/src/main/java/org/zaproxy/addon/encoder/EncodeDecodeParamPanel.java\n+++ b/addOns/encoder/src/main/java/org/zaproxy/addon/encoder/EncodeDecodeOptionsPanel.java\n\n@@ -35,7 +35,7 @@ import org.parosproxy.paros.model.OptionsParam;\n import org.parosproxy.paros.view.AbstractParamPanel;\n import org.zaproxy.zap.utils.FontUtils;\n \n-public class EncodeDecodeParamPanel extends AbstractParamPanel {\n+public class EncodeDecodeOptionsPanel extends AbstractParamPanel {\n \n     private static final long serialVersionUID = -6357927982804314157L;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1MDU1OA==", "url": "https://github.com/zaproxy/zap-extensions/pull/2412#discussion_r431550558", "bodyText": "Per: https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html this wraps at 76, which is the same as: https://github.com/zaproxy/zaproxy/blob/baa415b72755cc5348de8a0259e780152d8e6345/zap/src/main/java/org/parosproxy/paros/extension/encoder/Base64.java#L212-L213", "author": "kingthorin", "createdAt": "2020-05-28T02:41:02Z", "path": "addOns/encoder/src/main/java/org/zaproxy/addon/encoder/processors/predefined/Base64Encoder.java", "diffHunk": "@@ -21,12 +21,26 @@\n \n import java.io.IOException;\n import java.util.Base64;\n+import org.parosproxy.paros.control.Control;\n+import org.zaproxy.addon.encoder.EncodeDecodeParam;\n+import org.zaproxy.addon.encoder.ExtensionEncoder;\n \n public class Base64Encoder extends DefaultEncodeDecodeProcessor {\n \n     @Override\n     protected String processInternal(String value) throws IOException {\n-        // Returns based on StandardCharsets.ISO_8859_1\n-        return Base64.getEncoder().encodeToString(value.getBytes());\n+        EncodeDecodeParam encDecParam =\n+                Control.getSingleton()\n+                        .getExtensionLoader()\n+                        .getExtension(ExtensionEncoder.class)\n+                        .getParams();\n+        if (encDecParam.isBase64DoBreakLines()) {\n+            return new String(\n+                    Base64.getMimeEncoder().encode(value.getBytes(encDecParam.getBase64Charset())),", "originalCommit": "b1d113600a9c9d6e8b8fc29cbfd24fbb4a4444b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1MTMxMQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2412#discussion_r431551311", "bodyText": "Could use: https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html#getMimeEncoder-int-byte:A- if for some reason \\n is preferred vs \\r\\n.", "author": "kingthorin", "createdAt": "2020-05-28T02:44:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1MDU1OA=="}], "type": "inlineReview", "revised_code": {"commit": "b69b41b2e1940402bf81a8781f7ce54f01256e4f", "chunk": "diff --git a/addOns/encoder/src/main/java/org/zaproxy/addon/encoder/processors/predefined/Base64Encoder.java b/addOns/encoder/src/main/java/org/zaproxy/addon/encoder/processors/predefined/Base64Encoder.java\nindex 1d8d7de97..8992511ac 100644\n--- a/addOns/encoder/src/main/java/org/zaproxy/addon/encoder/processors/predefined/Base64Encoder.java\n+++ b/addOns/encoder/src/main/java/org/zaproxy/addon/encoder/processors/predefined/Base64Encoder.java\n\n@@ -22,25 +22,25 @@ package org.zaproxy.addon.encoder.processors.predefined;\n import java.io.IOException;\n import java.util.Base64;\n import org.parosproxy.paros.control.Control;\n-import org.zaproxy.addon.encoder.EncodeDecodeParam;\n+import org.zaproxy.addon.encoder.EncodeDecodeOptions;\n import org.zaproxy.addon.encoder.ExtensionEncoder;\n \n public class Base64Encoder extends DefaultEncodeDecodeProcessor {\n \n     @Override\n     protected String processInternal(String value) throws IOException {\n-        EncodeDecodeParam encDecParam =\n+        EncodeDecodeOptions encDecOpts =\n                 Control.getSingleton()\n                         .getExtensionLoader()\n                         .getExtension(ExtensionEncoder.class)\n-                        .getParams();\n-        if (encDecParam.isBase64DoBreakLines()) {\n+                        .getOptions();\n+        if (encDecOpts.isBase64DoBreakLines()) {\n             return new String(\n-                    Base64.getMimeEncoder().encode(value.getBytes(encDecParam.getBase64Charset())),\n-                    encDecParam.getBase64Charset());\n+                    Base64.getMimeEncoder().encode(value.getBytes(encDecOpts.getBase64Charset())),\n+                    encDecOpts.getBase64Charset());\n         }\n         return new String(\n-                Base64.getEncoder().encode(value.getBytes(encDecParam.getBase64Charset())),\n-                encDecParam.getBase64Charset());\n+                Base64.getEncoder().encode(value.getBytes(encDecOpts.getBase64Charset())),\n+                encDecOpts.getBase64Charset());\n     }\n }\n"}}, {"oid": "b69b41b2e1940402bf81a8781f7ce54f01256e4f", "url": "https://github.com/zaproxy/zap-extensions/commit/b69b41b2e1940402bf81a8781f7ce54f01256e4f", "message": "encoder: Implement Base64 options\n\n- Base64Encoder/Decoder > Handle charset/line break options.\n- EncodeDecodeDialog > Add update call.\n- EncodeDecodeParam & Panel > Config handling & UI component.\n- ExtensionEncoder > Updated to hook the options panel, listen for\noptions changes, etc.\n- Messages.properties > Add new supporting keys/values & properly\nalphabetize.\n- CHANGELOG > Note the addition.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-05-29T10:58:05Z", "type": "forcePushed"}, {"oid": "dec9e911f28b8ef805eddaaf7352a4db8e35e078", "url": "https://github.com/zaproxy/zap-extensions/commit/dec9e911f28b8ef805eddaaf7352a4db8e35e078", "message": "encoder: Implement Base64 options\n\n- Base64Encoder/Decoder > Handle charset/line break options.\n- EncodeDecodeDialog > Add update call.\n- EncodeDecodeParam & Panel > Config handling & UI component.\n- ExtensionEncoder > Updated to hook the options panel, listen for\noptions changes, etc.\n- Messages.properties > Add new supporting keys/values & properly\nalphabetize.\n- CHANGELOG > Note the addition.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-05-29T11:38:47Z", "type": "forcePushed"}, {"oid": "9f8f2e89be8a47277753f024cfcc4bd819030b61", "url": "https://github.com/zaproxy/zap-extensions/commit/9f8f2e89be8a47277753f024cfcc4bd819030b61", "message": "encoder: Implement Base64 options\n\n- Base64Encoder/Decoder > Handle charset/line break options.\n- EncodeDecodeDialog > Add update call.\n- EncodeDecodeParam & Panel > Config handling & UI component.\n- ExtensionEncoder > Updated to hook the options panel, listen for\noptions changes, etc.\n- Messages.properties > Add new supporting keys/values & properly\nalphabetize.\n- CHANGELOG > Note the addition.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-05-29T11:41:26Z", "type": "forcePushed"}, {"oid": "768ebd53959f838ee84befc4a82f8d088fa67381", "url": "https://github.com/zaproxy/zap-extensions/commit/768ebd53959f838ee84befc4a82f8d088fa67381", "message": "encoder: Implement Base64 options\n\n- Base64Encoder/Decoder > Handle charset/line break options.\n- EncodeDecodeDialog > Add update call.\n- EncodeDecodeParam & Panel > Config handling & UI component.\n- ExtensionEncoder > Updated to hook the options panel, listen for\noptions changes, etc.\n- Messages.properties > Add new supporting keys/values & properly\nalphabetize.\n- CHANGELOG > Note the addition.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-05-29T12:01:03Z", "type": "commit"}, {"oid": "768ebd53959f838ee84befc4a82f8d088fa67381", "url": "https://github.com/zaproxy/zap-extensions/commit/768ebd53959f838ee84befc4a82f8d088fa67381", "message": "encoder: Implement Base64 options\n\n- Base64Encoder/Decoder > Handle charset/line break options.\n- EncodeDecodeDialog > Add update call.\n- EncodeDecodeParam & Panel > Config handling & UI component.\n- ExtensionEncoder > Updated to hook the options panel, listen for\noptions changes, etc.\n- Messages.properties > Add new supporting keys/values & properly\nalphabetize.\n- CHANGELOG > Note the addition.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-05-29T12:01:03Z", "type": "forcePushed"}]}