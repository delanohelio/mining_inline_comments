{"pr_number": 5961, "pr_title": "Add alarm tests in the e2e", "pr_createdAt": "2020-12-06T15:31:12Z", "pr_url": "https://github.com/apache/skywalking/pull/5961", "timeline": [{"oid": "ae14c8bc2e6524efb06bfd51c9ab5a65c32e94e1", "url": "https://github.com/apache/skywalking/commit/ae14c8bc2e6524efb06bfd51c9ab5a65c32e94e1", "message": "1. Add Alarm E2E\n2. Add rule name to AlarmRecord, fix multiple same scope alarm at same time", "committedDate": "2020-12-06T15:06:08Z", "type": "commit"}, {"oid": "1cea68ecc44925f1584ad4b12d50d0101bca4847", "url": "https://github.com/apache/skywalking/commit/1cea68ecc44925f1584ad4b12d50d0101bca4847", "message": "Fix checkstyle", "committedDate": "2020-12-06T15:12:54Z", "type": "commit"}, {"oid": "1daa0356426bad67c86cf04db3928a7eeaa43ddd", "url": "https://github.com/apache/skywalking/commit/1daa0356426bad67c86cf04db3928a7eeaa43ddd", "message": "Add changes", "committedDate": "2020-12-06T15:24:58Z", "type": "commit"}, {"oid": "2a549b444bfc05ecd9bfb938139152303a0e6620", "url": "https://github.com/apache/skywalking/commit/2a549b444bfc05ecd9bfb938139152303a0e6620", "message": "Merge branch 'master' into alarm-e2e", "committedDate": "2020-12-06T15:32:34Z", "type": "commit"}, {"oid": "95572f7cd6c793d32329055f40b8054b11c5fd09", "url": "https://github.com/apache/skywalking/commit/95572f7cd6c793d32329055f40b8054b11c5fd09", "message": "Add more description to the change log", "committedDate": "2020-12-06T15:55:19Z", "type": "commit"}, {"oid": "377e8d87d5e0a1ba9b0a8c9c2909963196376311", "url": "https://github.com/apache/skywalking/commit/377e8d87d5e0a1ba9b0a8c9c2909963196376311", "message": "Update CHANGES.md\n\nPolish changelog", "committedDate": "2020-12-06T23:32:20Z", "type": "commit"}, {"oid": "3ae073e7ecdf0ac953a0ee3bda2f9b058bb276cf", "url": "https://github.com/apache/skywalking/commit/3ae073e7ecdf0ac953a0ee3bda2f9b058bb276cf", "message": "Commit graphQL file", "committedDate": "2020-12-07T02:13:00Z", "type": "commit"}, {"oid": "6261d15f44c07e7e6aa31ef754594eaabb69b578", "url": "https://github.com/apache/skywalking/commit/6261d15f44c07e7e6aa31ef754594eaabb69b578", "message": "Adding meter receive log, trying to locate meter e2e error", "committedDate": "2020-12-07T05:17:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzM0NzE4MQ==", "url": "https://github.com/apache/skywalking/pull/5961#discussion_r537347181", "bodyText": "I think once you have the ruleName, scope is not necessary? RuleName matches the metrics name already, right?", "author": "wu-sheng", "createdAt": "2020-12-07T09:19:33Z", "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/alarm/AlarmRecord.java", "diffHunk": "@@ -46,10 +47,11 @@\n     public static final String ID1 = \"id1\";\n     public static final String START_TIME = \"start_time\";\n     public static final String ALARM_MESSAGE = \"alarm_message\";\n+    public static final String RULE_NAME = \"rule_name\";\n \n     @Override\n     public String id() {\n-        return getTimeBucket() + Const.ID_CONNECTOR + scope + Const.ID_CONNECTOR + id0 + Const.ID_CONNECTOR + id1;\n+        return getTimeBucket() + Const.ID_CONNECTOR + scope + Const.ID_CONNECTOR + ruleName + Const.ID_CONNECTOR + id0 + Const.ID_CONNECTOR + id1;", "originalCommit": "6261d15f44c07e7e6aa31ef754594eaabb69b578", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzQ1Nzc2OA==", "url": "https://github.com/apache/skywalking/pull/5961#discussion_r537457768", "bodyText": "That's true, deleted.", "author": "mrproliu", "createdAt": "2020-12-07T12:10:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzM0NzE4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "ebd4e7ee1949fc4d84c3e752a053180809147e94", "chunk": "diff --git a/oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/alarm/AlarmRecord.java b/oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/alarm/AlarmRecord.java\nindex f51fdd2bff..52a01ad7f7 100644\n--- a/oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/alarm/AlarmRecord.java\n+++ b/oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/alarm/AlarmRecord.java\n\n@@ -51,7 +51,7 @@ public class AlarmRecord extends Record {\n \n     @Override\n     public String id() {\n-        return getTimeBucket() + Const.ID_CONNECTOR + scope + Const.ID_CONNECTOR + ruleName + Const.ID_CONNECTOR + id0 + Const.ID_CONNECTOR + id1;\n+        return getTimeBucket() + Const.ID_CONNECTOR + ruleName + Const.ID_CONNECTOR + id0 + Const.ID_CONNECTOR + id1;\n     }\n \n     @Column(columnName = SCOPE)\n"}}, {"oid": "ebd4e7ee1949fc4d84c3e752a053180809147e94", "url": "https://github.com/apache/skywalking/commit/ebd4e7ee1949fc4d84c3e752a053180809147e94", "message": "1. remove logs\n2. remove scope part at alarm record", "committedDate": "2020-12-07T12:09:34Z", "type": "commit"}, {"oid": "ff5058751ea2852f14d80e6e0170f0f20e76ccff", "url": "https://github.com/apache/skywalking/commit/ff5058751ea2852f14d80e6e0170f0f20e76ccff", "message": "Merge branch 'master' into alarm-e2e", "committedDate": "2020-12-08T02:06:31Z", "type": "commit"}]}