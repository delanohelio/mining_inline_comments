{"pr_number": 5424, "pr_title": "Add superdataset replicas number config", "pr_createdAt": "2020-09-01T13:20:12Z", "pr_url": "https://github.com/apache/skywalking/pull/5424", "timeline": [{"oid": "19f9c1856569765467f5b56b8c0497fc1e265210", "url": "https://github.com/apache/skywalking/commit/19f9c1856569765467f5b56b8c0497fc1e265210", "message": "distinct the number of metrics or common record index with super dataset index.", "committedDate": "2020-09-01T13:14:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1MjM4Mw==", "url": "https://github.com/apache/skywalking/pull/5424#discussion_r481152383", "bodyText": "As you moved all superset config in one place in the doc and config file, please do the same thing for the config class", "author": "wu-sheng", "createdAt": "2020-09-01T13:50:18Z", "path": "oap-server/server-storage-plugin/storage-elasticsearch-plugin/src/main/java/org/apache/skywalking/oap/server/storage/plugin/elasticsearch/StorageModuleElasticsearchConfig.java", "diffHunk": "@@ -38,6 +39,12 @@\n     private int superDatasetIndexShardsFactor = 5;\n     @Setter\n     private int indexReplicasNumber = 0;\n+    /**\n+     * @since 8.2.0, the replicas number is for super size dataset record replicas number\n+     * @see SuperDataset\n+     */\n+    @Setter\n+    private int superDatasetIndexReplicasNumber = 0;", "originalCommit": "19f9c1856569765467f5b56b8c0497fc1e265210", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1OTQxMQ==", "url": "https://github.com/apache/skywalking/pull/5424#discussion_r481159411", "bodyText": "done", "author": "EvanLjp", "createdAt": "2020-09-01T14:00:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1MjM4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "c01a1fde99433a8ad01968080d1755cfa4b634bf", "chunk": "diff --git a/oap-server/server-storage-plugin/storage-elasticsearch-plugin/src/main/java/org/apache/skywalking/oap/server/storage/plugin/elasticsearch/StorageModuleElasticsearchConfig.java b/oap-server/server-storage-plugin/storage-elasticsearch-plugin/src/main/java/org/apache/skywalking/oap/server/storage/plugin/elasticsearch/StorageModuleElasticsearchConfig.java\nindex 8939c3fe3f..02cfc2fa01 100644\n--- a/oap-server/server-storage-plugin/storage-elasticsearch-plugin/src/main/java/org/apache/skywalking/oap/server/storage/plugin/elasticsearch/StorageModuleElasticsearchConfig.java\n+++ b/oap-server/server-storage-plugin/storage-elasticsearch-plugin/src/main/java/org/apache/skywalking/oap/server/storage/plugin/elasticsearch/StorageModuleElasticsearchConfig.java\n\n@@ -20,87 +20,60 @@ package org.apache.skywalking.oap.server.storage.plugin.elasticsearch;\n \n import lombok.Getter;\n import lombok.Setter;\n-\n import org.apache.skywalking.oap.server.core.storage.annotation.SuperDataset;\n import org.apache.skywalking.oap.server.library.module.ModuleConfig;\n \n @Getter\n+@Setter\n public class StorageModuleElasticsearchConfig extends ModuleConfig {\n-    @Setter\n     private String nameSpace;\n-    @Setter\n     private String clusterNodes;\n-    @Getter\n-    @Setter\n     String protocol = \"http\";\n-    @Setter\n-    private int indexShardsNumber = 1;\n-    @Setter\n-    private int superDatasetIndexShardsFactor = 5;\n-    @Setter\n+    /**\n+     * Since 6.4.0, the index of metrics and traces data in minute/hour/month precision are organized in days. ES\n+     * storage creates new indexes in every day.\n+     *\n+     * @since 7.0.0 dayStep represents how many days a single one index represents. Default is 1, meaning no difference\n+     * with previous versions. But if there isn't much traffic for single one day, user could set the step larger to\n+     * reduce the number of indexes, and keep the TTL longer.\n+     */\n+    private int dayStep = 1;\n     private int indexReplicasNumber = 0;\n+    private int indexShardsNumber = 1;\n+    /**\n+     * @since 8.2.0, the record day step is for super size dataset record index rolling when the value of it is greater than 0\n+     */\n+    private int superDatasetDayStep = -1;\n     /**\n-     * @since 8.2.0, the replicas number is for super size dataset record replicas number\n      * @see SuperDataset\n+     * @since 8.2.0, the replicas number is for super size dataset record replicas number\n      */\n-    @Setter\n     private int superDatasetIndexReplicasNumber = 0;\n-    @Setter\n+    private int superDatasetIndexShardsFactor = 5;\n     private int indexRefreshInterval = 2;\n-    @Setter\n     private int bulkActions = 2000;\n-    @Setter\n     private int flushInterval = 10;\n-    @Setter\n     private int concurrentRequests = 2;\n     /**\n      * @since 7.0.0 This could be managed inside {@link #secretsManagementFile}\n      */\n-    @Setter\n     private String user;\n     /**\n      * @since 7.0.0 This could be managed inside {@link #secretsManagementFile}\n      */\n-    @Setter\n     private String password;\n     /**\n      * Secrets management file includes the username, password, which are managed by 3rd party tool.\n      */\n-    @Getter\n     private String secretsManagementFile;\n-    @Getter\n-    @Setter\n     private String trustStorePath;\n     /**\n      * @since 7.0.0 This could be managed inside {@link #secretsManagementFile}\n      */\n-    @Getter\n-    @Setter\n     private String trustStorePass;\n-    /**\n-     * Since 6.4.0, the index of metrics and traces data in minute/hour/month precision are organized in days. ES\n-     * storage creates new indexes in every day.\n-     *\n-     * @since 7.0.0 dayStep represents how many days a single one index represents. Default is 1, meaning no difference\n-     * with previous versions. But if there isn't much traffic for single one day, user could set the step larger to\n-     * reduce the number of indexes, and keep the TTL longer.\n-     */\n-    @Getter\n-    private int dayStep = 1;\n-    /**\n-     * @since 8.2.0, the record day step is for super size dataset record index rolling when the value of it is greater than 0\n-     */\n-    @Getter\n-    private int superDatasetDayStep = -1;\n-    @Setter\n     private int resultWindowMaxSize = 10000;\n-    @Setter\n     private int metadataQueryMaxSize = 5000;\n-    @Setter\n     private int segmentQueryMaxSize = 200;\n-    @Setter\n     private int profileTaskQueryMaxSize = 200;\n-    @Setter\n     private String advanced;\n-\n }\n"}}, {"oid": "c01a1fde99433a8ad01968080d1755cfa4b634bf", "url": "https://github.com/apache/skywalking/commit/c01a1fde99433a8ad01968080d1755cfa4b634bf", "message": "clear up StorageModuleElasticsearchConfig", "committedDate": "2020-09-01T13:59:34Z", "type": "commit"}]}