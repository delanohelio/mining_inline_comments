{"pr_number": 5767, "pr_title": "Polish the context and optimize the tag analyze", "pr_createdAt": "2020-11-02T03:52:42Z", "pr_url": "https://github.com/apache/skywalking/pull/5767", "timeline": [{"oid": "e7e72ba176a14c0cfd5861f83fc775d7b8973b9d", "url": "https://github.com/apache/skywalking/commit/e7e72ba176a14c0cfd5861f83fc775d7b8973b9d", "message": "Polish the context and optimize the tag analyze", "committedDate": "2020-11-02T03:48:45Z", "type": "commit"}, {"oid": "dcda15db28e26bfac4cdd710b6c4fd98f5ddea18", "url": "https://github.com/apache/skywalking/commit/dcda15db28e26bfac4cdd710b6c4fd98f5ddea18", "message": "Fix bug of new context codes.", "committedDate": "2020-11-02T04:15:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTc1NzUyOA==", "url": "https://github.com/apache/skywalking/pull/5767#discussion_r515757528", "bodyText": "Seems to break the plugin tests\n\n@kezhenxu94 Yes, the current status of context is complex. this and tracingContext.getExtensionContext() are not the same thing.\nRight now, it should be good.", "author": "wu-sheng", "createdAt": "2020-11-02T06:12:36Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/ContextCarrier.java", "diffHunk": "@@ -90,18 +89,21 @@ public ExtensionInjector extensionInjector() {\n     }\n \n     /**\n-     * Extract the extension context to the given span\n+     * Extract the extension context to tracing context\n      */\n-    void extractExtensionTo(AbstractSpan span) {\n-        this.extensionContext.handle(span);\n-\n+    void extractExtensionTo(TracingContext tracingContext) {\n+        tracingContext.getExtensionContext().extract(this);\n+        // The extension context could have field not to propagate further, so, must use the this.* to process.\n+        this.extensionContext.handle(tracingContext.activeSpan());", "originalCommit": "dcda15db28e26bfac4cdd710b6c4fd98f5ddea18", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}