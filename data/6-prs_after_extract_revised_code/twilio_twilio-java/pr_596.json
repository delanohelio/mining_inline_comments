{"pr_number": 596, "pr_title": "fix: drop reflective access warnings to java.time.* classes", "pr_createdAt": "2020-10-12T11:39:03Z", "pr_url": "https://github.com/twilio/twilio-java/pull/596", "timeline": [{"oid": "e57b03ab48a8dde59db2d4577a0a121edebd1621", "url": "https://github.com/twilio/twilio-java/commit/e57b03ab48a8dde59db2d4577a0a121edebd1621", "message": "Fix for reflective access warnings to java.time.* classes\n\nJava module system gives warnings on reflective access to java.time.*\nprivate fields, which are performed by Jackson when using\nTwilioRestClient.\n\nJackson provides a `JavaTimeModule` which configures an ObjectMapper to\nuse public methods instead of reflective accesss to private fields in\nclasses in java.time.\n\nThis PR adds the dependency for `JavaTimeModule` and adds it to the\nObjectMapper created by `TwilioRestClient`, which removes all the\nwarnings that I have seen.", "committedDate": "2020-10-12T11:34:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzM0NDQ4Mg==", "url": "https://github.com/twilio/twilio-java/pull/596#discussion_r503344482", "bodyText": "Should add a comment as to why this is necessary. A test would be better if it's not too involved, but a comment would suffice for me.", "author": "childish-sambino", "createdAt": "2020-10-12T14:43:33Z", "path": "src/main/java/com/twilio/http/TwilioRestClient.java", "diffHunk": "@@ -27,6 +28,7 @@ private TwilioRestClient(Builder b) {\n         this.edge = b.edge;\n         this.httpClient = b.httpClient;\n         this.objectMapper = new ObjectMapper();\n+        objectMapper.registerModule(new JavaTimeModule());", "originalCommit": "e57b03ab48a8dde59db2d4577a0a121edebd1621", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzM1MTQ1Nw==", "url": "https://github.com/twilio/twilio-java/pull/596#discussion_r503351457", "bodyText": "I'll add a comment for sure. If there are other tests which make assertions about what goes to stdout/stderr then I can look at fitting this into them but I'm not sure it's worth adding that kind of testing just for this. What do you think? (Testing which redirects stdout/err streams is a pain, in my experience, and I can't see another way to do it because there's nothing in-code to hook into for asserting on this)", "author": "mjg123", "createdAt": "2020-10-12T14:54:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzM0NDQ4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzM2OTk2NQ==", "url": "https://github.com/twilio/twilio-java/pull/596#discussion_r503369965", "bodyText": "Agree it can be a pain. This looks good to me.", "author": "childish-sambino", "createdAt": "2020-10-12T15:24:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzM0NDQ4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "fd572c81ac11e9898676ba13ca32420e79c712f7", "chunk": "diff --git a/src/main/java/com/twilio/http/TwilioRestClient.java b/src/main/java/com/twilio/http/TwilioRestClient.java\nindex ab0941adc..61acfc667 100644\n--- a/src/main/java/com/twilio/http/TwilioRestClient.java\n+++ b/src/main/java/com/twilio/http/TwilioRestClient.java\n\n@@ -28,6 +28,11 @@ public class TwilioRestClient {\n         this.edge = b.edge;\n         this.httpClient = b.httpClient;\n         this.objectMapper = new ObjectMapper();\n+\n+        // This module configures the ObjectMapper to use\n+        // public API methods for manipulating java.time.*\n+        // classes. The alternative is to use reflection which\n+        // generates warnings from the module system on Java 9+\n         objectMapper.registerModule(new JavaTimeModule());\n     }\n \n"}}, {"oid": "fd572c81ac11e9898676ba13ca32420e79c712f7", "url": "https://github.com/twilio/twilio-java/commit/fd572c81ac11e9898676ba13ca32420e79c712f7", "message": "Comment the reason for adding the JavaTimeModule to Jackson", "committedDate": "2020-10-12T15:00:35Z", "type": "commit"}]}