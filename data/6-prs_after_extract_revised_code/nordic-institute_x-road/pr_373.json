{"pr_number": 373, "pr_title": "XRDDEV-873 Load internal tls key cert", "pr_createdAt": "2020-02-17T13:56:52Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/373", "timeline": [{"oid": "49f8b0f262a42011af1630a059207ec582e5e80b", "url": "https://github.com/nordic-institute/X-Road/commit/49f8b0f262a42011af1630a059207ec582e5e80b", "message": "XRDDEV-873 Internal key cache and get\n\n* adds InternalSSLKey caching in CachingServerConfImpl", "committedDate": "2020-02-14T12:36:29Z", "type": "commit"}, {"oid": "60adc50f438f17294ffdcb278c9a082492dbfd4d", "url": "https://github.com/nordic-institute/X-Road/commit/60adc50f438f17294ffdcb278c9a082492dbfd4d", "message": "XRDDEV-873 Internal key cache and get // lower default cache time", "committedDate": "2020-02-17T13:22:19Z", "type": "commit"}, {"oid": "c39186abd910755d10ad0c458752854da389a28f", "url": "https://github.com/nordic-institute/X-Road/commit/c39186abd910755d10ad0c458752854da389a28f", "message": "XRDDEV-873 Internal key cache and get // update docs", "committedDate": "2020-02-17T13:45:05Z", "type": "commit"}, {"oid": "94a6a75287e709e535b5b27a5e5fee5694489a6d", "url": "https://github.com/nordic-institute/X-Road/commit/94a6a75287e709e535b5b27a5e5fee5694489a6d", "message": "XRDDEV-873 Internal key cache and get // change constructor", "committedDate": "2020-02-17T13:55:07Z", "type": "commit"}, {"oid": "60f13c515a13f7df6cac47caa0f0efcc7469f91b", "url": "https://github.com/nordic-institute/X-Road/commit/60f13c515a13f7df6cac47caa0f0efcc7469f91b", "message": "XRDDEV-873 Internal key cache and get // update docs 2", "committedDate": "2020-02-24T07:44:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgyNjE2NA==", "url": "https://github.com/nordic-institute/X-Road/pull/373#discussion_r386826164", "bodyText": "This annotation is unnecessary (If a class contains no constructors, then a default no-args constructor is implicitly declared)", "author": "jhyoty", "createdAt": "2020-03-03T06:48:33Z", "path": "src/proxy/src/main/java/ee/ria/xroad/proxy/util/InternalKeyManager.java", "diffHunk": "@@ -41,16 +42,14 @@\n /**\n  * a KeyManager that holds the internal SSL Key\n  */\n-@RequiredArgsConstructor\n+@NoArgsConstructor", "originalCommit": "60f13c515a13f7df6cac47caa0f0efcc7469f91b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk2ODYzMg==", "url": "https://github.com/nordic-institute/X-Road/pull/373#discussion_r386968632", "bodyText": "Removed the annotation.", "author": "carohauta", "createdAt": "2020-03-03T11:49:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgyNjE2NA=="}], "type": "inlineReview", "revised_code": {"commit": "0cf63eecaf7cf7105983c6343d90af4c57f6a921", "chunk": "diff --git a/src/proxy/src/main/java/ee/ria/xroad/proxy/util/InternalKeyManager.java b/src/proxy/src/main/java/ee/ria/xroad/proxy/util/InternalKeyManager.java\nindex 09b868dd7..5bc3c4443 100644\n--- a/src/proxy/src/main/java/ee/ria/xroad/proxy/util/InternalKeyManager.java\n+++ b/src/proxy/src/main/java/ee/ria/xroad/proxy/util/InternalKeyManager.java\n\n@@ -42,7 +41,6 @@ import java.security.cert.X509Certificate;\n /**\n  * a KeyManager that holds the internal SSL Key\n  */\n-@NoArgsConstructor\n public class InternalKeyManager extends X509ExtendedKeyManager {\n \n     private static final Logger LOG =\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgzNzYxNg==", "url": "https://github.com/nordic-institute/X-Road/pull/373#discussion_r386837616", "bodyText": "Setting server-conf-cache-period to zero disables all serverconf caching, in which case this setting has no effect. Is it really necessary to have a separate cache period for the internal key?", "author": "jhyoty", "createdAt": "2020-03-03T07:26:41Z", "path": "src/common-util/src/main/java/ee/ria/xroad/common/SystemProperties.java", "diffHunk": "@@ -174,6 +174,9 @@ private SystemProperties() {\n     public static final String SERVER_CONF_CACHE_PERIOD =\n             PREFIX + \"proxy.server-conf-cache-period\";\n \n+    public static final String INTERNAL_KEY_CACHE_PERIOD =\n+            PREFIX + \"proxy.internal-key-cache-period\";", "originalCommit": "60f13c515a13f7df6cac47caa0f0efcc7469f91b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk2OTExOQ==", "url": "https://github.com/nordic-institute/X-Road/pull/373#discussion_r386969119", "bodyText": "These now use the same cache period: proxy.server-conf-cache-period which is 60 seconds by default. Also updated documentation accordingly", "author": "carohauta", "createdAt": "2020-03-03T11:50:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgzNzYxNg=="}], "type": "inlineReview", "revised_code": {"commit": "34b831ce8ab24e06d82c4f9738b939a1468698ee", "chunk": "diff --git a/src/common-util/src/main/java/ee/ria/xroad/common/SystemProperties.java b/src/common-util/src/main/java/ee/ria/xroad/common/SystemProperties.java\nindex 818564f66..8744200aa 100644\n--- a/src/common-util/src/main/java/ee/ria/xroad/common/SystemProperties.java\n+++ b/src/common-util/src/main/java/ee/ria/xroad/common/SystemProperties.java\n\n@@ -174,9 +174,6 @@ public final class SystemProperties {\n     public static final String SERVER_CONF_CACHE_PERIOD =\n             PREFIX + \"proxy.server-conf-cache-period\";\n \n-    public static final String INTERNAL_KEY_CACHE_PERIOD =\n-            PREFIX + \"proxy.internal-key-cache-period\";\n-\n     public static final String SERVER_CONF_CLIENT_CACHE_SIZE = PREFIX + \"proxy.server-conf-client-cache-size\";\n \n     public static final String SERVER_CONF_SERVICE_CACHE_SIZE = PREFIX + \"proxy.server-conf-service-cache-size\";\n"}}, {"oid": "a725998d6b782f8776361f6a49c192bf2343d5d9", "url": "https://github.com/nordic-institute/X-Road/commit/a725998d6b782f8776361f6a49c192bf2343d5d9", "message": "Merge branch 'develop' into XRDDEV-873-load-internal-tls-key-cert\n\n# Conflicts:\n#\tsrc/proxy-ui-api/src/main/java/org/niis/xroad/restapi/service/InternalTlsCertificateService.java", "committedDate": "2020-03-03T08:25:28Z", "type": "commit"}, {"oid": "0cf63eecaf7cf7105983c6343d90af4c57f6a921", "url": "https://github.com/nordic-institute/X-Road/commit/0cf63eecaf7cf7105983c6343d90af4c57f6a921", "message": "XRDDEV-873 Remove unnecessary annotation", "committedDate": "2020-03-03T08:34:51Z", "type": "commit"}, {"oid": "34b831ce8ab24e06d82c4f9738b939a1468698ee", "url": "https://github.com/nordic-institute/X-Road/commit/34b831ce8ab24e06d82c4f9738b939a1468698ee", "message": "XRDDEV-873 Remove separate cache period for Internal Key", "committedDate": "2020-03-03T10:41:41Z", "type": "commit"}]}