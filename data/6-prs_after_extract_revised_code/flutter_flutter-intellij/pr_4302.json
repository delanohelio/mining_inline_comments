{"pr_number": 4302, "pr_title": "Fix Inspector and WidgetRebuildIndicators for bazel projects.", "pr_createdAt": "2020-01-17T23:42:36Z", "pr_url": "https://github.com/flutter/flutter-intellij/pull/4302", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODE3OTkyNw==", "url": "https://github.com/flutter/flutter-intellij/pull/4302#discussion_r368179927", "bodyText": "with the other fixes, the timeout doesn't really need to be raised but raising it anyway just to be safe.", "author": "jacob314", "createdAt": "2020-01-17T23:43:23Z", "path": "src/io/flutter/inspector/EvalOnDartLibrary.java", "diffHunk": "@@ -44,7 +44,7 @@\n   CompletableFuture<LibraryRef> libraryRef;\n   private final Alarm myRequestsScheduler;\n \n-  static final int DEFAULT_REQUEST_TIMEOUT_SECONDS = 5;\n+  static final int DEFAULT_REQUEST_TIMEOUT_SECONDS = 10;", "originalCommit": "b60407f90ee480391a01455054d7d16590cedfe2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "1feb11ae4a57af13246ac0dc6bb73604e45fa37f", "url": "https://github.com/flutter/flutter-intellij/commit/1feb11ae4a57af13246ac0dc6bb73604e45fa37f", "message": "Fix Inspector and WidgetRebuildIndicators in Google3.", "committedDate": "2020-01-18T00:00:01Z", "type": "forcePushed"}, {"oid": "7664787db58023956f9617b8439fab41450c8d50", "url": "https://github.com/flutter/flutter-intellij/commit/7664787db58023956f9617b8439fab41450c8d50", "message": "Fix Inspector and WidgetRebuildIndicators in Google3.", "committedDate": "2020-01-18T00:28:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODE4ODg2Nw==", "url": "https://github.com/flutter/flutter-intellij/pull/4302#discussion_r368188867", "bodyText": "@jakemac53 please let me know if you clean this up and just make the scheme bazel://", "author": "jacob314", "createdAt": "2020-01-18T00:33:56Z", "path": "src/io/flutter/bazel/Workspace.java", "diffHunk": "@@ -33,6 +33,8 @@\n public class Workspace {\n   private static final String PLUGIN_CONFIG_PATH = \"dart/config/intellij-plugins/flutter.json\";\n \n+  public static final String BAZEL_URI_SCHEME = \"google3://\";", "originalCommit": "7664787db58023956f9617b8439fab41450c8d50", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTMzNjAzMw==", "url": "https://github.com/flutter/flutter-intellij/pull/4302#discussion_r371336033", "bodyText": "Perhaps add a todo here that we anticipate a future change to this url scheme?", "author": "devoncarew", "createdAt": "2020-01-27T16:14:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODE4ODg2Nw=="}], "type": "inlineReview", "revised_code": {"commit": "e3c5d93d818adbfd047be6feffc0be6b2f030dbb", "chunk": "diff --git a/src/io/flutter/bazel/Workspace.java b/src/io/flutter/bazel/Workspace.java\nindex b6eed5e7..8227018c 100644\n--- a/src/io/flutter/bazel/Workspace.java\n+++ b/src/io/flutter/bazel/Workspace.java\n\n@@ -33,6 +33,7 @@ import java.util.*;\n public class Workspace {\n   private static final String PLUGIN_CONFIG_PATH = \"dart/config/intellij-plugins/flutter.json\";\n \n+  // TODO(jacobr): find a way to load the bazel uri scheme rather than hard coding it.\n   public static final String BAZEL_URI_SCHEME = \"google3://\";\n \n   @NotNull private final VirtualFile root;\n"}}, {"oid": "11197aaa412ec270b9b54b29d656183e916dd7f0", "url": "https://github.com/flutter/flutter-intellij/commit/11197aaa412ec270b9b54b29d656183e916dd7f0", "message": "Fix Inspector and WidgetRebuildIndicators in Google3.", "committedDate": "2020-01-18T00:38:00Z", "type": "forcePushed"}, {"oid": "7953d65f8f88241f26b8bbb7f5a7f02c23f409e9", "url": "https://github.com/flutter/flutter-intellij/commit/7953d65f8f88241f26b8bbb7f5a7f02c23f409e9", "message": "Fix Inspector and WidgetRebuildIndicators in Google3.", "committedDate": "2020-01-26T16:09:33Z", "type": "commit"}, {"oid": "4c10783471deacd0420c39872271fa4db9adf7bc", "url": "https://github.com/flutter/flutter-intellij/commit/4c10783471deacd0420c39872271fa4db9adf7bc", "message": "Avoid reapply errors", "committedDate": "2020-01-26T16:31:57Z", "type": "commit"}, {"oid": "8a3a55e08ab30c5bfa923eeabca2783e43ccf8a9", "url": "https://github.com/flutter/flutter-intellij/commit/8a3a55e08ab30c5bfa923eeabca2783e43ccf8a9", "message": "Fix bugs to show rebuild indicators in code editors.", "committedDate": "2020-01-26T16:31:57Z", "type": "forcePushed"}, {"oid": "52b1ab93609e530a0085ae4ff95e341ca7fc48c7", "url": "https://github.com/flutter/flutter-intellij/commit/52b1ab93609e530a0085ae4ff95e341ca7fc48c7", "message": "Fix bugs to show rebuild indicators in code editors.", "committedDate": "2020-01-26T20:13:22Z", "type": "commit"}, {"oid": "52b1ab93609e530a0085ae4ff95e341ca7fc48c7", "url": "https://github.com/flutter/flutter-intellij/commit/52b1ab93609e530a0085ae4ff95e341ca7fc48c7", "message": "Fix bugs to show rebuild indicators in code editors.", "committedDate": "2020-01-26T20:13:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI5NDAzNQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4302#discussion_r371294035", "bodyText": "This class wasn't ever used and doesn't seem compatible with current implementations.", "author": "jacob314", "createdAt": "2020-01-27T15:07:52Z", "path": "src/io/flutter/sdk/FlutterSdk.java", "diffHunk": "@@ -548,92 +548,4 @@ public void onTextAvailable(@NotNull ProcessEvent event, @NotNull Key outputType\n \n     return null;\n   }\n-\n-  /**\n-   * A {@link FlutterSdk} that is compatible with the Bazel version of the Dart and Flutter SDK.\n-   */\n-  public static class BazelSdk extends FlutterSdk {", "originalCommit": "52b1ab93609e530a0085ae4ff95e341ca7fc48c7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI5NDYxMg==", "url": "https://github.com/flutter/flutter-intellij/pull/4302#discussion_r371294612", "bodyText": "The flutter sdk updated to just use paths. Updating the fake data to match the current DartVM version.", "author": "jacob314", "createdAt": "2020-01-27T15:08:51Z", "path": "testSrc/unit/io/flutter/perf/FlutterWidgetPerfTest.java", "diffHunk": "@@ -332,10 +351,10 @@ public void testFileStatsCalculation() throws InterruptedException, ExecutionExc\n         perfModels.put(textEditor.getName(), model);\n         return model;\n       },\n-      path -> new FakeFileLocationMapper()\n+      path -> new FakeFileLocationMapper(path)\n     );\n     widgetPerfProvider.simulateWidgetPerfEvent(PerfReportKind.rebuild,\n-                                               \"{\\\"startTime\\\":1000,\\\"events\\\":[1,1,2,1,3,1,4,1,6,1,10,4,11,4,12,4,13,1,14,1,95,1,96,1,97,6,100,6,102,6,104,6,105,1,106,1],\\\"newLocations\\\":{\\\"file:///sample/project/main.dart\\\":[1,11,14,2,18,16,3,23,17,4,40,16,6,46,16,10,69,9,11,70,9,12,71,18,13,41,19,14,42,20,95,51,58],\\\"file:///sample/project/clock.dart\\\":[96,33,12,97,52,12,100,53,16,102,54,14,104,55,17,105,34,15,106,35,16]}}\");\n+                                               \"{\\\"startTime\\\":1000,\\\"events\\\":[1,1,2,1,3,1,4,1,6,1,10,4,11,4,12,4,13,1,14,1,95,1,96,1,97,6,100,6,102,6,104,6,105,1,106,1],\\\"newLocations\\\":{\\\"/sample/project/main.dart\\\":[1,11,14,2,18,16,3,23,17,4,40,16,6,46,16,10,69,9,11,70,9,12,71,18,13,41,19,14,42,20,95,51,58],\\\"/sample/project/clock.dart\\\":[96,33,12,97,52,12,100,53,16,102,54,14,104,55,17,105,34,15,106,35,16]}}\");", "originalCommit": "52b1ab93609e530a0085ae4ff95e341ca7fc48c7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM0MDEzOQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4302#discussion_r371340139", "bodyText": "Is this change part of another modifying the settings page?", "author": "devoncarew", "createdAt": "2020-01-27T16:21:46Z", "path": "src/io/flutter/sdk/FlutterSettingsConfigurable.java", "diffHunk": "@@ -230,17 +230,19 @@ public boolean isModified() {\n \n   @Override\n   public void apply() throws ConfigurationException {\n-    final String errorMessage = FlutterSdkUtil.getErrorMessageIfWrongSdkRootPath(getSdkPathText());\n-    if (errorMessage != null) {\n-      throw new ConfigurationException(errorMessage);\n-    }\n+    if (!workspaceCache.isBazel()) {", "originalCommit": "52b1ab93609e530a0085ae4ff95e341ca7fc48c7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxMjE1MA==", "url": "https://github.com/flutter/flutter-intellij/pull/4302#discussion_r371612150", "bodyText": "This was a bug fix for my previous cl. Added a comment clarifying what it is doing.", "author": "jacob314", "createdAt": "2020-01-28T05:07:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM0MDEzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "21c3871dd5069d9e6ee3737c63d7ab67c171061a", "chunk": "diff --git a/src/io/flutter/sdk/FlutterSettingsConfigurable.java b/src/io/flutter/sdk/FlutterSettingsConfigurable.java\nindex 46dbf206..7d5631af 100644\n--- a/src/io/flutter/sdk/FlutterSettingsConfigurable.java\n+++ b/src/io/flutter/sdk/FlutterSettingsConfigurable.java\n\n@@ -230,6 +230,8 @@ public class FlutterSettingsConfigurable implements SearchableConfigurable {\n \n   @Override\n   public void apply() throws ConfigurationException {\n+    // Bazel workspaces do not specify a sdk path so we do not need to update the sdk path if using\n+    // a bazel workspace.\n     if (!workspaceCache.isBazel()) {\n       final String errorMessage = FlutterSdkUtil.getErrorMessageIfWrongSdkRootPath(getSdkPathText());\n       if (errorMessage != null) {\n"}}, {"oid": "21c3871dd5069d9e6ee3737c63d7ab67c171061a", "url": "https://github.com/flutter/flutter-intellij/commit/21c3871dd5069d9e6ee3737c63d7ab67c171061a", "message": "Update FlutterSettingsConfigurable.java", "committedDate": "2020-01-28T05:07:13Z", "type": "commit"}, {"oid": "e3c5d93d818adbfd047be6feffc0be6b2f030dbb", "url": "https://github.com/flutter/flutter-intellij/commit/e3c5d93d818adbfd047be6feffc0be6b2f030dbb", "message": "Update Workspace.java", "committedDate": "2020-01-28T05:09:47Z", "type": "commit"}, {"oid": "ffdaab0734d286b6647e730ab9b2b30163f53aaa", "url": "https://github.com/flutter/flutter-intellij/commit/ffdaab0734d286b6647e730ab9b2b30163f53aaa", "message": "Update Workspace.java", "committedDate": "2020-01-28T05:10:16Z", "type": "commit"}]}