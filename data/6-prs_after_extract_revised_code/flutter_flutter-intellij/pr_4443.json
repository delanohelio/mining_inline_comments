{"pr_number": 4443, "pr_title": "fix an issue with discovering hyperlinks in test consoles", "pr_createdAt": "2020-03-28T15:20:17Z", "pr_url": "https://github.com/flutter/flutter-intellij/pull/4443", "timeline": [{"oid": "cb562e208671a3d588156edacb62ce17441e6d05", "url": "https://github.com/flutter/flutter-intellij/commit/cb562e208671a3d588156edacb62ce17441e6d05", "message": "fix an issue with discovering hyperlinks in test consoles", "committedDate": "2020-03-28T15:14:27Z", "type": "commit"}, {"oid": "39c68a568df974acd2f28f986c733603e95d346a", "url": "https://github.com/flutter/flutter-intellij/commit/39c68a568df974acd2f28f986c733603e95d346a", "message": "add back in DartRelativePathsConsoleFilter", "committedDate": "2020-03-28T17:00:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxNzkxNw==", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399717917", "bodyText": "DartRelativePathsConsoleFilter is intended to be used in test environs. Are you sure deleting it is the right thing to do?", "author": "stevemessick", "createdAt": "2020-03-28T22:37:45Z", "path": "src/io/flutter/run/bazelTest/BazelTestLaunchState.java", "diffHunk": "@@ -106,8 +106,8 @@ protected ConsoleView createConsole(@NotNull Executor executor) throws Execution\n     final ConsoleProps props = ConsoleProps.forBazel(config, executor, resolver);\n     final BaseTestsOutputConsoleView console = SMTestRunnerConnectionUtil.createConsole(ConsoleProps.bazelFrameworkName, props);\n \n-    final String baseDir = workspace.getRoot().getPath();\n-    console.addMessageFilter(new DartRelativePathsConsoleFilter(project, baseDir));", "originalCommit": "39c68a568df974acd2f28f986c733603e95d346a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg1OTYyNw==", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399859627", "bodyText": "No, I'll add it back in, and add some brief docs about what the different filters do.", "author": "devoncarew", "createdAt": "2020-03-29T21:57:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxNzkxNw=="}], "type": "inlineReview", "revised_code": {"commit": "3dd4cee51be3f20ee1ea7590a9b9284d4cd3dce5", "chunk": "diff --git a/src/io/flutter/run/bazelTest/BazelTestLaunchState.java b/src/io/flutter/run/bazelTest/BazelTestLaunchState.java\nindex bf8358db..93465302 100644\n--- a/src/io/flutter/run/bazelTest/BazelTestLaunchState.java\n+++ b/src/io/flutter/run/bazelTest/BazelTestLaunchState.java\n\n@@ -108,6 +109,8 @@ public class BazelTestLaunchState extends CommandLineState {\n \n     // TODO(devoncarew): Will DartConsoleFilter work well in a Bazel context?\n     console.addMessageFilter(new DartConsoleFilter(project, testFile));\n+    final String baseDir = workspace.getRoot().getPath();\n+    console.addMessageFilter(new DartRelativePathsConsoleFilter(project, baseDir));\n     console.addMessageFilter(new UrlFilter());\n     return console;\n   }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODA3OA==", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399718078", "bodyText": "I think you want DartConsoleFilter here, too, but it may be getting added at a later stage. I forgot just how convoluted this is.", "author": "stevemessick", "createdAt": "2020-03-28T22:39:28Z", "path": "src/io/flutter/run/daemon/DaemonConsoleView.java", "diffHunk": "@@ -46,6 +46,7 @@ protected ConsoleView createConsole() {\n     };\n \n     // Set up basic console filters. (More may be added later.)\n+    // TODO(devoncarew): Do we need this filter? What about DartConsoleFilter (for package: uris)?", "originalCommit": "39c68a568df974acd2f28f986c733603e95d346a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MDIxMQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399860211", "bodyText": "We may just need the DartConsoleFilter in the SdkRunConfig.java (the run/debug console)? If you're certain I can add it, but would otherwise hold off.", "author": "devoncarew", "createdAt": "2020-03-29T22:02:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODA3OA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODM3NQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399718375", "bodyText": "Are you sure you want to remove this? It has some specialized logic for handling Flutter stuff, like plugins.", "author": "stevemessick", "createdAt": "2020-03-28T22:43:12Z", "path": "src/io/flutter/run/test/TestLaunchState.java", "diffHunk": "@@ -113,15 +113,15 @@ protected ConsoleView createConsole(@NotNull Executor executor) throws Execution\n     final DartUrlResolver resolver = DartUrlResolver.getInstance(project, testFileOrDir);\n     final ConsoleProps props = ConsoleProps.forPub(config, executor, resolver);\n     final BaseTestsOutputConsoleView console = SMTestRunnerConnectionUtil.createConsole(ConsoleProps.pubFrameworkName, props);\n+\n     final Module module = ModuleUtil.findModuleForFile(testFileOrDir, project);\n-    if (module != null) {\n-      console.addMessageFilter(new FlutterConsoleFilter(module));", "originalCommit": "39c68a568df974acd2f28f986c733603e95d346a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MDM3NQ==", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399860375", "bodyText": "I'll figure out what all the FlutterConsoleFilter is responsible for. I think it's more important for the run console (to link to lib.main.dart, and some flutter doctor output?). It may have several different concerns in that class.", "author": "devoncarew", "createdAt": "2020-03-29T22:04:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODM3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MTA2NA==", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399861064", "bodyText": "I added docs to FlutterConsoleFilter. I think we only want to use it for the run and debug consoles.", "author": "devoncarew", "createdAt": "2020-03-29T22:10:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODM3NQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "3dd4cee51be3f20ee1ea7590a9b9284d4cd3dce5", "url": "https://github.com/flutter/flutter-intellij/commit/3dd4cee51be3f20ee1ea7590a9b9284d4cd3dce5", "message": "add the DartRelativePathsConsoleFilter filter to the bazel test config; add docs", "committedDate": "2020-03-29T22:49:38Z", "type": "commit"}]}