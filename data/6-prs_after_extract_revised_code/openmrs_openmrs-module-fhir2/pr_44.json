{"pr_number": 44, "pr_title": "FM2-47 Update ServiceRequest.status mapping to reflect referenced\u2026", "pr_createdAt": "2020-01-26T05:45:01Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44", "timeline": [{"oid": "3317f7cb58eb9fa0cdcd2117a29490a5b838c689", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/3317f7cb58eb9fa0cdcd2117a29490a5b838c689", "message": "Updated ServiceRequest.status mapping to reflect referenced Task.status for FM2-47", "committedDate": "2020-01-26T06:11:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQwMTUwMw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371401503", "bodyText": "My opinion is that this belongs in the FhirTaskDao.", "author": "ibacher", "createdAt": "2020-01-27T18:16:37Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirServiceRequestDao.java", "diffHunk": "@@ -11,9 +11,15 @@\n \n import javax.validation.constraints.NotNull;\n \n+import java.util.Collection;\n+import java.util.List;\n+\n import org.openmrs.TestOrder;\n+import org.openmrs.module.fhir2.Task;\n \n public interface FhirServiceRequestDao {\n \t\n \tTestOrder getTestOrderByUuid(@NotNull String uuid);\n+\n+\tCollection<Task> getOrderTasksByOrderUUID(@NotNull String uuid);", "originalCommit": "3317f7cb58eb9fa0cdcd2117a29490a5b838c689", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "703d0e72ccd1c77f363e7c88ce2b3bc50f53e0ea", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirServiceRequestDao.java b/api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirServiceRequestDao.java\nindex 6dedec64..9b0535da 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirServiceRequestDao.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirServiceRequestDao.java\n\n@@ -10,16 +10,8 @@\n package org.openmrs.module.fhir2.api.dao;\n \n import javax.validation.constraints.NotNull;\n-\n-import java.util.Collection;\n-import java.util.List;\n-\n import org.openmrs.TestOrder;\n-import org.openmrs.module.fhir2.Task;\n \n public interface FhirServiceRequestDao {\n-\t\n \tTestOrder getTestOrderByUuid(@NotNull String uuid);\n-\n-\tCollection<Task> getOrderTasksByOrderUUID(@NotNull String uuid);\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQwMTU0Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371401546", "bodyText": "See above.", "author": "ibacher", "createdAt": "2020-01-27T18:16:44Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirServiceRequestDaoImpl.java", "diffHunk": "@@ -39,4 +43,10 @@ public TestOrder getTestOrderByUuid(String uuid) {\n \t\treturn (TestOrder) sessionFactory.getCurrentSession().createCriteria(TestOrder.class)\n \t\t        .add(Restrictions.eq(\"uuid\", uuid)).uniqueResult();\n \t}\n+\n+\t@Override\n+\tpublic Collection<Task> getOrderTasksByOrderUUID(String uuid) {", "originalCommit": "3317f7cb58eb9fa0cdcd2117a29490a5b838c689", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "703d0e72ccd1c77f363e7c88ce2b3bc50f53e0ea", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirServiceRequestDaoImpl.java b/api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirServiceRequestDaoImpl.java\nindex fddd553d..054333ab 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirServiceRequestDaoImpl.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirServiceRequestDaoImpl.java\n\n@@ -43,10 +43,4 @@ public class FhirServiceRequestDaoImpl implements FhirServiceRequestDao {\n \t\treturn (TestOrder) sessionFactory.getCurrentSession().createCriteria(TestOrder.class)\n \t\t        .add(Restrictions.eq(\"uuid\", uuid)).uniqueResult();\n \t}\n-\n-\t@Override\n-\tpublic Collection<Task> getOrderTasksByOrderUUID(String uuid) {\n-\t\treturn (Collection<Task>) sessionFactory.getCurrentSession().createCriteria(Task.class)\n-\t\t\t\t.add(Restrictions.eq(\"basedOn\", \"ServiceRequest/\"+uuid)).list();\n-\t}\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQwMTYwNA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371401604", "bodyText": "Please remove this", "author": "ibacher", "createdAt": "2020-01-27T18:16:52Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirServiceRequestServiceImpl.java", "diffHunk": "@@ -38,5 +38,6 @@ public ServiceRequest getServiceRequestByUuid(String uuid) {\n \t\t\n \t\treturn translator.toFhirResource(openmrsOrder);\n \t}\n-\t", "originalCommit": "3317f7cb58eb9fa0cdcd2117a29490a5b838c689", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "703d0e72ccd1c77f363e7c88ce2b3bc50f53e0ea", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirServiceRequestServiceImpl.java b/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirServiceRequestServiceImpl.java\nindex ea05c66c..1da608cd 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirServiceRequestServiceImpl.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirServiceRequestServiceImpl.java\n\n@@ -38,6 +38,4 @@ public class FhirServiceRequestServiceImpl implements FhirServiceRequestService\n \t\t\n \t\treturn translator.toFhirResource(openmrsOrder);\n \t}\n-\n-\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQwMjUyNQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371402525", "bodyText": "Preferably, should be taskService here.", "author": "ibacher", "createdAt": "2020-01-27T18:18:47Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java", "diffHunk": "@@ -9,33 +9,37 @@\n  */\n package org.openmrs.module.fhir2.api.translators.impl;\n \n+import javax.inject.Inject;\n import javax.validation.constraints.NotNull;\n \n+import java.util.Collection;\n+import java.util.List;\n+\n import lombok.AccessLevel;\n import lombok.Setter;\n import org.hl7.fhir.r4.model.ServiceRequest;\n import org.openmrs.TestOrder;\n+import org.openmrs.module.fhir2.Task;\n+import org.openmrs.module.fhir2.api.dao.FhirServiceRequestDao;\n import org.openmrs.module.fhir2.api.translators.ServiceRequestTranslator;\n import org.springframework.stereotype.Component;\n \n @Component\n @Setter(AccessLevel.PACKAGE)\n public class ServiceRequestTranslatorImpl implements ServiceRequestTranslator {\n-\t\n+\n+\t@Inject\n+\tFhirServiceRequestDao dao;", "originalCommit": "3317f7cb58eb9fa0cdcd2117a29490a5b838c689", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "703d0e72ccd1c77f363e7c88ce2b3bc50f53e0ea", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java b/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java\nindex 1dad3398..9445684b 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java\n\n@@ -13,14 +13,13 @@ import javax.inject.Inject;\n import javax.validation.constraints.NotNull;\n \n import java.util.Collection;\n-import java.util.List;\n \n import lombok.AccessLevel;\n import lombok.Setter;\n import org.hl7.fhir.r4.model.ServiceRequest;\n+import org.hl7.fhir.r4.model.Task;\n import org.openmrs.TestOrder;\n-import org.openmrs.module.fhir2.Task;\n-import org.openmrs.module.fhir2.api.dao.FhirServiceRequestDao;\n+import org.openmrs.module.fhir2.api.FhirTaskService;\n import org.openmrs.module.fhir2.api.translators.ServiceRequestTranslator;\n import org.springframework.stereotype.Component;\n \n"}}, {"oid": "703d0e72ccd1c77f363e7c88ce2b3bc50f53e0ea", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/703d0e72ccd1c77f363e7c88ce2b3bc50f53e0ea", "message": "Updated ServiceRequest.status mapping to reflect referenced Task.status for FM2-47", "committedDate": "2020-01-28T00:24:58Z", "type": "forcePushed"}, {"oid": "330654c6b9b10036964d88a7bd2f8baec24e3df1", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/330654c6b9b10036964d88a7bd2f8baec24e3df1", "message": "Updated ServiceRequest.status mapping to reflect referenced Task.status for FM2-47", "committedDate": "2020-01-28T00:32:27Z", "type": "forcePushed"}, {"oid": "a580202b0560b0d4bb160f2af84b37bcd08f9f48", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/a580202b0560b0d4bb160f2af84b37bcd08f9f48", "message": "Updated ServiceRequest.status mapping to reflect referenced Task.status for FM2-47", "committedDate": "2020-01-28T02:12:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgzMDk5OQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371830999", "bodyText": "This should probably be getTasksByBasedOnUuid() for consistency\norderUuid should probably just be uuid.", "author": "ibacher", "createdAt": "2020-01-28T14:23:13Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirTaskDaoImpl.java", "diffHunk": "@@ -45,4 +48,10 @@ public Task saveTask(Task task) throws DAOException {\n \tpublic Task getTaskByUuid(String uuid) {\n \t\treturn (Task) sessionFactory.getCurrentSession().createCriteria(Task.class).add(eq(\"uuid\", uuid)).uniqueResult();\n \t}\n+\n+\t@Override\n+\tpublic Collection<Task> getTasksByBasedOnUUID(String resourceType, String orderUuid) {", "originalCommit": "a580202b0560b0d4bb160f2af84b37bcd08f9f48", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "dfc0c93604c67b889ebe5a485d7255cbd83786b8", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirTaskDaoImpl.java b/api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirTaskDaoImpl.java\nindex a5935a81..44e8bdf2 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirTaskDaoImpl.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirTaskDaoImpl.java\n\n@@ -48,10 +48,10 @@ public class FhirTaskDaoImpl implements FhirTaskDao {\n \tpublic Task getTaskByUuid(String uuid) {\n \t\treturn (Task) sessionFactory.getCurrentSession().createCriteria(Task.class).add(eq(\"uuid\", uuid)).uniqueResult();\n \t}\n-\n+\t\n \t@Override\n \tpublic Collection<Task> getTasksByBasedOnUUID(String resourceType, String orderUuid) {\n \t\treturn (Collection<Task>) sessionFactory.getCurrentSession().createCriteria(Task.class)\n-\t\t\t\t.add(Restrictions.eq(\"basedOn\", resourceType+\"/\"+orderUuid)).list();\n+\t\t        .add(Restrictions.eq(\"basedOn\", resourceType + \"/\" + orderUuid)).list();\n \t}\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgzMjUzNA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371832534", "bodyText": "Do we need this explicit filtering here?", "author": "ibacher", "createdAt": "2020-01-28T14:25:46Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java", "diffHunk": "@@ -71,5 +78,17 @@ public Task updateTask(String uuid, Task task) {\n \t\t\n \t\treturn translator.toFhirResource(dao.saveTask(translator.toOpenmrsType(openmrsTask, task)));\n \t}\n-\t\n+\n+\t@Override\n+\tpublic Collection<Task> getTasksByBasedOn(Class<? extends DomainResource> obj, String uuid) {\n+\t\tCollection<Task> associatedTasks = new ArrayList<>();\n+\n+\t\tif(obj == ServiceRequest.class || obj == MedicationRequest.class || obj == CarePlan.class){", "originalCommit": "a580202b0560b0d4bb160f2af84b37bcd08f9f48", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "dfc0c93604c67b889ebe5a485d7255cbd83786b8", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java b/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java\nindex b95ae391..552ee14d 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java\n\n@@ -78,17 +78,18 @@ public class FhirTaskServiceImpl implements FhirTaskService {\n \t\t\n \t\treturn translator.toFhirResource(dao.saveTask(translator.toOpenmrsType(openmrsTask, task)));\n \t}\n-\n+\t\n \t@Override\n \tpublic Collection<Task> getTasksByBasedOn(Class<? extends DomainResource> obj, String uuid) {\n \t\tCollection<Task> associatedTasks = new ArrayList<>();\n-\n-\t\tif(obj == ServiceRequest.class || obj == MedicationRequest.class || obj == CarePlan.class){\n-\t\t\tfor(org.openmrs.module.fhir2.Task openmrsTask : dao.getTasksByBasedOnUUID(obj.getSimpleName(), uuid)){\n+\t\t\n+\t\tif (obj == ServiceRequest.class || obj == MedicationRequest.class || obj == CarePlan.class) {\n+\t\t\tfor (org.openmrs.module.fhir2.Task openmrsTask : dao.getTasksByBasedOnUUID(obj.getSimpleName(), uuid)) {\n \t\t\t\tassociatedTasks.add(translator.toFhirResource(openmrsTask));\n-\t\t\t};\n+\t\t\t}\n+\t\t\t;\n \t\t}\n-\n+\t\t\n \t\treturn associatedTasks;\n \t}\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgzMzgzMQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371833831", "bodyText": "This could also be:\ndao.getTaskByBasedOnUuid(obj.getSimpleName(), uuid).stream().map(translator::toFhirResource).collect(Collectors.toList())", "author": "ibacher", "createdAt": "2020-01-28T14:27:52Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java", "diffHunk": "@@ -71,5 +78,17 @@ public Task updateTask(String uuid, Task task) {\n \t\t\n \t\treturn translator.toFhirResource(dao.saveTask(translator.toOpenmrsType(openmrsTask, task)));\n \t}\n-\t\n+\n+\t@Override\n+\tpublic Collection<Task> getTasksByBasedOn(Class<? extends DomainResource> obj, String uuid) {\n+\t\tCollection<Task> associatedTasks = new ArrayList<>();\n+\n+\t\tif(obj == ServiceRequest.class || obj == MedicationRequest.class || obj == CarePlan.class){\n+\t\t\tfor(org.openmrs.module.fhir2.Task openmrsTask : dao.getTasksByBasedOnUUID(obj.getSimpleName(), uuid)){\n+\t\t\t\tassociatedTasks.add(translator.toFhirResource(openmrsTask));", "originalCommit": "a580202b0560b0d4bb160f2af84b37bcd08f9f48", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "dfc0c93604c67b889ebe5a485d7255cbd83786b8", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java b/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java\nindex b95ae391..552ee14d 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java\n\n@@ -78,17 +78,18 @@ public class FhirTaskServiceImpl implements FhirTaskService {\n \t\t\n \t\treturn translator.toFhirResource(dao.saveTask(translator.toOpenmrsType(openmrsTask, task)));\n \t}\n-\n+\t\n \t@Override\n \tpublic Collection<Task> getTasksByBasedOn(Class<? extends DomainResource> obj, String uuid) {\n \t\tCollection<Task> associatedTasks = new ArrayList<>();\n-\n-\t\tif(obj == ServiceRequest.class || obj == MedicationRequest.class || obj == CarePlan.class){\n-\t\t\tfor(org.openmrs.module.fhir2.Task openmrsTask : dao.getTasksByBasedOnUUID(obj.getSimpleName(), uuid)){\n+\t\t\n+\t\tif (obj == ServiceRequest.class || obj == MedicationRequest.class || obj == CarePlan.class) {\n+\t\t\tfor (org.openmrs.module.fhir2.Task openmrsTask : dao.getTasksByBasedOnUUID(obj.getSimpleName(), uuid)) {\n \t\t\t\tassociatedTasks.add(translator.toFhirResource(openmrsTask));\n-\t\t\t};\n+\t\t\t}\n+\t\t\t;\n \t\t}\n-\n+\t\t\n \t\treturn associatedTasks;\n \t}\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgzNDE0MA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371834140", "bodyText": "By convention, a Class object should be named clazz.", "author": "ibacher", "createdAt": "2020-01-28T14:28:21Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java", "diffHunk": "@@ -71,5 +78,17 @@ public Task updateTask(String uuid, Task task) {\n \t\t\n \t\treturn translator.toFhirResource(dao.saveTask(translator.toOpenmrsType(openmrsTask, task)));\n \t}\n-\t\n+\n+\t@Override\n+\tpublic Collection<Task> getTasksByBasedOn(Class<? extends DomainResource> obj, String uuid) {", "originalCommit": "a580202b0560b0d4bb160f2af84b37bcd08f9f48", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "dfc0c93604c67b889ebe5a485d7255cbd83786b8", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java b/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java\nindex b95ae391..552ee14d 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java\n\n@@ -78,17 +78,18 @@ public class FhirTaskServiceImpl implements FhirTaskService {\n \t\t\n \t\treturn translator.toFhirResource(dao.saveTask(translator.toOpenmrsType(openmrsTask, task)));\n \t}\n-\n+\t\n \t@Override\n \tpublic Collection<Task> getTasksByBasedOn(Class<? extends DomainResource> obj, String uuid) {\n \t\tCollection<Task> associatedTasks = new ArrayList<>();\n-\n-\t\tif(obj == ServiceRequest.class || obj == MedicationRequest.class || obj == CarePlan.class){\n-\t\t\tfor(org.openmrs.module.fhir2.Task openmrsTask : dao.getTasksByBasedOnUUID(obj.getSimpleName(), uuid)){\n+\t\t\n+\t\tif (obj == ServiceRequest.class || obj == MedicationRequest.class || obj == CarePlan.class) {\n+\t\t\tfor (org.openmrs.module.fhir2.Task openmrsTask : dao.getTasksByBasedOnUUID(obj.getSimpleName(), uuid)) {\n \t\t\t\tassociatedTasks.add(translator.toFhirResource(openmrsTask));\n-\t\t\t};\n+\t\t\t}\n+\t\t\t;\n \t\t}\n-\n+\t\t\n \t\treturn associatedTasks;\n \t}\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgzNDcyNw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371834727", "bodyText": "One new line rather than two", "author": "ibacher", "createdAt": "2020-01-28T14:29:13Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java", "diffHunk": "@@ -9,33 +9,36 @@\n  */\n package org.openmrs.module.fhir2.api.translators.impl;\n \n+import javax.inject.Inject;\n import javax.validation.constraints.NotNull;\n \n+import java.util.Collection;\n+\n import lombok.AccessLevel;\n import lombok.Setter;\n import org.hl7.fhir.r4.model.ServiceRequest;\n+import org.hl7.fhir.r4.model.Task;\n import org.openmrs.TestOrder;\n+import org.openmrs.module.fhir2.api.FhirTaskService;\n import org.openmrs.module.fhir2.api.translators.ServiceRequestTranslator;\n import org.springframework.stereotype.Component;\n \n @Component\n @Setter(AccessLevel.PACKAGE)\n public class ServiceRequestTranslatorImpl implements ServiceRequestTranslator {\n-\t\n+\n+\t@Inject\n+\tFhirTaskService taskService;\n+\n \t@Override\n \tpublic ServiceRequest toFhirResource(@NotNull TestOrder order) {\n \t\tServiceRequest serviceRequest = new ServiceRequest();\n-\t\t\n+", "originalCommit": "a580202b0560b0d4bb160f2af84b37bcd08f9f48", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "dfc0c93604c67b889ebe5a485d7255cbd83786b8", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java b/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java\nindex 9445684b..7d66fe95 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ServiceRequestTranslatorImpl.java\n\n@@ -20,25 +20,29 @@ import org.hl7.fhir.r4.model.ServiceRequest;\n import org.hl7.fhir.r4.model.Task;\n import org.openmrs.TestOrder;\n import org.openmrs.module.fhir2.api.FhirTaskService;\n+import org.openmrs.module.fhir2.api.translators.ConceptTranslator;\n import org.openmrs.module.fhir2.api.translators.ServiceRequestTranslator;\n import org.springframework.stereotype.Component;\n \n @Component\n @Setter(AccessLevel.PACKAGE)\n public class ServiceRequestTranslatorImpl implements ServiceRequestTranslator {\n-\n+\t\n+\t@Inject\n+\tConceptTranslator conceptTranslator;\n+\t\n \t@Inject\n \tFhirTaskService taskService;\n-\n+\t\n \t@Override\n \tpublic ServiceRequest toFhirResource(@NotNull TestOrder order) {\n \t\tServiceRequest serviceRequest = new ServiceRequest();\n-\n-\n+\t\t\n \t\tif (order != null) {\n \t\t\tserviceRequest.setId(order.getUuid());\n-\n+\t\t\t\n \t\t\tserviceRequest.setStatus(determineServiceRequestStatus(order.getUuid()));\n+\t\t\tserviceRequest.setCode(conceptTranslator.toFhirResource(order.getConcept()));\n \t\t\tserviceRequest.setIntent(ServiceRequest.ServiceRequestIntent.ORDER);\n \t\t}\n \t\t\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgzNTM0Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/44#discussion_r371835346", "bodyText": "This can probably just take a class object rather than a string.", "author": "ibacher", "createdAt": "2020-01-28T14:30:10Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirTaskDao.java", "diffHunk": "@@ -11,12 +11,15 @@\n \n import javax.validation.constraints.NotNull;\n \n+import java.util.Collection;\n+\n import org.openmrs.module.fhir2.Task;\n \n public interface FhirTaskDao {\n \t\n \tpublic Task saveTask(Task task);\n \t\n \tpublic Task getTaskByUuid(@NotNull String taskUUID);\n-\t\n+\n+\tpublic Collection<Task> getTasksByBasedOnUUID(String resourceType, String orderUuid);", "originalCommit": "a580202b0560b0d4bb160f2af84b37bcd08f9f48", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "dfc0c93604c67b889ebe5a485d7255cbd83786b8", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirTaskDao.java b/api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirTaskDao.java\nindex d26521c2..0fe371b0 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirTaskDao.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirTaskDao.java\n\n@@ -20,6 +20,6 @@ public interface FhirTaskDao {\n \tpublic Task saveTask(Task task);\n \t\n \tpublic Task getTaskByUuid(@NotNull String taskUUID);\n-\n+\t\n \tpublic Collection<Task> getTasksByBasedOnUUID(String resourceType, String orderUuid);\n }\n"}}, {"oid": "dfc0c93604c67b889ebe5a485d7255cbd83786b8", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/dfc0c93604c67b889ebe5a485d7255cbd83786b8", "message": "Updated ServiceRequest.status mapping to reflect referenced Task.status for FM2-47", "committedDate": "2020-01-30T06:08:43Z", "type": "forcePushed"}, {"oid": "8f496d215d9f7f0ba399311ba8a9ccc633f4f2f7", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/8f496d215d9f7f0ba399311ba8a9ccc633f4f2f7", "message": "Updated ServiceRequest.status mapping to reflect referenced Task.status for FM2-47", "committedDate": "2020-01-30T06:51:23Z", "type": "commit"}, {"oid": "8f496d215d9f7f0ba399311ba8a9ccc633f4f2f7", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/8f496d215d9f7f0ba399311ba8a9ccc633f4f2f7", "message": "Updated ServiceRequest.status mapping to reflect referenced Task.status for FM2-47", "committedDate": "2020-01-30T06:51:23Z", "type": "forcePushed"}, {"oid": "4533da8982285877e7c72dc5ef2f536117412198", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/4533da8982285877e7c72dc5ef2f536117412198", "message": "Update ServiceRequestTranslatorImpl.java", "committedDate": "2020-01-30T15:14:29Z", "type": "commit"}]}