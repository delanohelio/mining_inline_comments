{"pr_number": 293, "pr_title": "FM2-300: Add HAPI Client", "pr_createdAt": "2020-08-20T22:03:37Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/293", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3NTExOQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/293#discussion_r479475119", "bodyText": "I think I have a nicer solution than this merged into the code base. I.e., we can remove all of these checks.", "author": "ibacher", "createdAt": "2020-08-28T18:41:34Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/BaseReferenceHandlingTranslator.java", "diffHunk": "@@ -41,45 +41,35 @@\n \tpublic static final String TEST_ORDER_TYPE_UUID = \"52a447d3-a64a-11e3-9aeb-50e549534c5e\";\n \t\n \tprotected Reference createEncounterReference(@NotNull Encounter encounter) {\n-\t\tif (encounter instanceof HibernateProxy) {", "originalCommit": "1501f187643d0f3ffd66358179b06531527b8405", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9a67fd393ff9bcd48164823fc6d01a016f2d35b5", "chunk": "diff --git a/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/BaseReferenceHandlingTranslator.java b/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/BaseReferenceHandlingTranslator.java\nindex aa4adc29..fae96ab6 100644\n--- a/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/BaseReferenceHandlingTranslator.java\n+++ b/api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/BaseReferenceHandlingTranslator.java\n\n@@ -40,37 +38,27 @@ public abstract class BaseReferenceHandlingTranslator {\n \t\n \tpublic static final String TEST_ORDER_TYPE_UUID = \"52a447d3-a64a-11e3-9aeb-50e549534c5e\";\n \t\n-\tprotected Reference createEncounterReference(@NotNull Encounter encounter) {\n-\t\tencounter = (Encounter) getHibernateProxyObject(encounter);\n-\t\t\n+\tprotected Reference createEncounterReference(@NotNull OpenmrsObject encounter) {\n \t\treturn new Reference().setReference(FhirConstants.ENCOUNTER + \"/\" + encounter.getUuid())\n \t\t        .setType(FhirConstants.ENCOUNTER);\n \t}\n \t\n \tprotected Reference createMedicationReference(@NotNull Drug drug) {\n-\t\tdrug = (Drug) getHibernateProxyObject(drug);\n-\t\t\n \t\treturn new Reference().setReference(FhirConstants.MEDICATION + \"/\" + drug.getUuid())\n \t\t        .setType(FhirConstants.MEDICATION);\n \t}\n \t\n \tprotected Reference createObservationReference(@NotNull Obs obs) {\n-\t\tobs = (Obs) getHibernateProxyObject(obs);\n-\t\t\n \t\treturn new Reference().setReference(FhirConstants.OBSERVATION + \"/\" + obs.getUuid())\n \t\t        .setType(FhirConstants.OBSERVATION);\n \t}\n \t\n \tprotected Reference createLocationReference(@NotNull Location location) {\n-\t\tlocation = (Location) getHibernateProxyObject(location);\n-\t\t\n \t\treturn new Reference().setReference(FhirConstants.LOCATION + \"/\" + location.getUuid())\n \t\t        .setType(FhirConstants.LOCATION).setDisplay(location.getName());\n \t}\n \t\n \tprotected Reference createPatientReference(@NotNull Patient patient) {\n-\t\tpatient = (Patient) getHibernateProxyObject(patient);\n-\t\t\n \t\tReference reference = new Reference().setReference(FhirConstants.PATIENT + \"/\" + patient.getUuid())\n \t\t        .setType(FhirConstants.PATIENT);\n \t\t\n"}}, {"oid": "9a67fd393ff9bcd48164823fc6d01a016f2d35b5", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/9a67fd393ff9bcd48164823fc6d01a016f2d35b5", "message": "Adds HAPI client dependency and fixes Hibernate\ndependency in Reference translator layer", "committedDate": "2020-08-28T22:15:48Z", "type": "commit"}, {"oid": "9a67fd393ff9bcd48164823fc6d01a016f2d35b5", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/9a67fd393ff9bcd48164823fc6d01a016f2d35b5", "message": "Adds HAPI client dependency and fixes Hibernate\ndependency in Reference translator layer", "committedDate": "2020-08-28T22:15:48Z", "type": "forcePushed"}]}