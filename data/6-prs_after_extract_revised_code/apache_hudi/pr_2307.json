{"pr_number": 2307, "pr_title": "[MINOR] Throw an exception when keyGenerator initialization failed in\u2026", "pr_createdAt": "2020-12-08T08:35:12Z", "pr_url": "https://github.com/apache/hudi/pull/2307", "timeline": [{"oid": "e472ef4daceef5fd105c630f3ea29f09646dd955", "url": "https://github.com/apache/hudi/commit/e472ef4daceef5fd105c630f3ea29f09646dd955", "message": "[MINOR] Throw an exception when keyGenerator initialization failed\ninstead of logging it", "committedDate": "2020-12-08T08:44:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODI2NTcxNg==", "url": "https://github.com/apache/hudi/pull/2307#discussion_r538265716", "bodyText": "Should it be info level? What about debug level?", "author": "yanghua", "createdAt": "2020-12-08T11:36:18Z", "path": "hudi-flink/src/main/java/org/apache/hudi/source/JsonStringToHoodieRecordMapFunction.java", "diffHunk": "@@ -65,10 +67,12 @@ public HoodieRecord map(String value) throws Exception {\n   private void init() {\n     this.props = StreamerUtil.getProps(cfg);\n     avroConvertor = new AvroConvertor(new FilebasedSchemaProvider(props).getSourceSchema());\n+    String keyGeneratorClass = props.getString(\"hoodie.datasource.write.keygenerator.class\", SimpleAvroKeyGenerator.class.getName());\n     try {\n       keyGenerator = StreamerUtil.createKeyGenerator(props);\n+      LOG.info(\"KeyGenerator {} initialized successfully\", keyGeneratorClass);", "originalCommit": "e472ef4daceef5fd105c630f3ea29f09646dd955", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODM1NDAxNQ==", "url": "https://github.com/apache/hudi/pull/2307#discussion_r538354015", "bodyText": "Should it be info level? What about debug level?\n\nhow about remove this log ?", "author": "wangxianghu", "createdAt": "2020-12-08T13:14:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODI2NTcxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTAyMTk5OQ==", "url": "https://github.com/apache/hudi/pull/2307#discussion_r539021999", "bodyText": "+1", "author": "yanghua", "createdAt": "2020-12-09T05:42:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODI2NTcxNg=="}], "type": "inlineReview", "revised_code": {"commit": "7c903c46179c1bd63221d3924fd5edac180c6e04", "chunk": "diff --git a/hudi-flink/src/main/java/org/apache/hudi/source/JsonStringToHoodieRecordMapFunction.java b/hudi-flink/src/main/java/org/apache/hudi/source/JsonStringToHoodieRecordMapFunction.java\nindex d479556dd..a01a67dad 100644\n--- a/hudi-flink/src/main/java/org/apache/hudi/source/JsonStringToHoodieRecordMapFunction.java\n+++ b/hudi-flink/src/main/java/org/apache/hudi/source/JsonStringToHoodieRecordMapFunction.java\n\n@@ -65,14 +59,13 @@ public class JsonStringToHoodieRecordMapFunction implements MapFunction<String,\n   }\n \n   private void init() {\n-    this.props = StreamerUtil.getProps(cfg);\n+    TypedProperties props = StreamerUtil.getProps(cfg);\n     avroConvertor = new AvroConvertor(new FilebasedSchemaProvider(props).getSourceSchema());\n-    String keyGeneratorClass = props.getString(\"hoodie.datasource.write.keygenerator.class\", SimpleAvroKeyGenerator.class.getName());\n     try {\n       keyGenerator = StreamerUtil.createKeyGenerator(props);\n-      LOG.info(\"KeyGenerator {} initialized successfully\", keyGeneratorClass);\n     } catch (IOException e) {\n-      throw new HoodieFlinkStreamerException(String.format(\"KeyGenerator %s initialization failed\", keyGeneratorClass), e);\n+      throw new HoodieFlinkStreamerException(String.format(\"KeyGenerator %s initialization failed\",\n+          props.getString(\"hoodie.datasource.write.keygenerator.class\", SimpleAvroKeyGenerator.class.getName())), e);\n     }\n   }\n }\n"}}, {"oid": "7c903c46179c1bd63221d3924fd5edac180c6e04", "url": "https://github.com/apache/hudi/commit/7c903c46179c1bd63221d3924fd5edac180c6e04", "message": "[MINOR] Throw an exception when keyGenerator initialization failed\ninstead of logging it", "committedDate": "2020-12-09T06:39:37Z", "type": "forcePushed"}, {"oid": "7688de0d9eef4d33f4c3f1937aaa05070eac1256", "url": "https://github.com/apache/hudi/commit/7688de0d9eef4d33f4c3f1937aaa05070eac1256", "message": "[MINOR] Throw an exception when keyGenerator initialization failed\ninstead of logging", "committedDate": "2020-12-09T13:52:29Z", "type": "commit"}, {"oid": "7688de0d9eef4d33f4c3f1937aaa05070eac1256", "url": "https://github.com/apache/hudi/commit/7688de0d9eef4d33f4c3f1937aaa05070eac1256", "message": "[MINOR] Throw an exception when keyGenerator initialization failed\ninstead of logging", "committedDate": "2020-12-09T13:52:29Z", "type": "forcePushed"}]}