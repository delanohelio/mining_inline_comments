{"pr_number": 2085, "pr_title": "[HUDI-1209] Properties File must be optional when running deltastreamer", "pr_createdAt": "2020-09-11T09:55:15Z", "pr_url": "https://github.com/apache/hudi/pull/2085", "timeline": [{"oid": "5b63f0e816112bc0fdb598dfddfb3b7e7dbeb551", "url": "https://github.com/apache/hudi/commit/5b63f0e816112bc0fdb598dfddfb3b7e7dbeb551", "message": "[HUDI-1209] Properties File must be optional when running deltastreamer", "committedDate": "2020-09-12T01:15:59Z", "type": "forcePushed"}, {"oid": "0024d977e021cb5fd494aa0ddf2edfc92f932082", "url": "https://github.com/apache/hudi/commit/0024d977e021cb5fd494aa0ddf2edfc92f932082", "message": "[HUDI-1209] Properties File must be optional when running deltastreamer", "committedDate": "2020-09-12T07:45:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzk0MDIzNw==", "url": "https://github.com/apache/hudi/pull/2085#discussion_r493940237", "bodyText": "can this be written more readable? using if-elseif blocks?", "author": "vinothchandar", "createdAt": "2020-09-23T22:57:35Z", "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -112,9 +112,14 @@ public HoodieDeltaStreamer(Config cfg, JavaSparkContext jssc, FileSystem fs, Con\n   public HoodieDeltaStreamer(Config cfg, JavaSparkContext jssc, FileSystem fs, Configuration conf,\n                              TypedProperties props) throws IOException {\n     // Resolving the properties first in a consistent way\n-    this.properties = props != null ? props : UtilHelpers.readConfig(\n-        FSUtils.getFs(cfg.propsFilePath, jssc.hadoopConfiguration()),\n-        new Path(cfg.propsFilePath), cfg.configs).getConfig();\n+    if (props != null) {\n+      this.properties = props;\n+    } else {", "originalCommit": "0024d977e021cb5fd494aa0ddf2edfc92f932082", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ4MjI1Mg==", "url": "https://github.com/apache/hudi/pull/2085#discussion_r496482252", "bodyText": "Done.", "author": "shenh062326", "createdAt": "2020-09-29T07:39:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzk0MDIzNw=="}], "type": "inlineReview", "revised_code": {"commit": "81e21d9d7f45aab4f5bc3e4ba4517ac983e9a65c", "chunk": "diff --git a/hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java b/hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java\nindex 80322d178..6b6b80ce8 100644\n--- a/hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java\n+++ b/hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java\n\n@@ -114,11 +114,12 @@ public class HoodieDeltaStreamer implements Serializable {\n     // Resolving the properties first in a consistent way\n     if (props != null) {\n       this.properties = props;\n+    } else if (cfg.propsFilePath.equals(Config.DEFAULT_DFS_SOURCE_PROPERTIES)) {\n+      this.properties = UtilHelpers.getConfig(cfg.configs).getConfig();\n     } else {\n-      this.properties = cfg.propsFilePath.equals(Config.DEFAULT_DFS_SOURCE_PROPERTIES)\n-          ? UtilHelpers.getConfig(cfg.configs).getConfig() : UtilHelpers.readConfig(\n-              FSUtils.getFs(cfg.propsFilePath, jssc.hadoopConfiguration()),\n-              new Path(cfg.propsFilePath), cfg.configs).getConfig();\n+      this.properties = UtilHelpers.readConfig(\n+          FSUtils.getFs(cfg.propsFilePath, jssc.hadoopConfiguration()),\n+          new Path(cfg.propsFilePath), cfg.configs).getConfig();\n     }\n \n     if (cfg.initialCheckpointProvider != null && cfg.checkpoint == null) {\n"}}, {"oid": "81e21d9d7f45aab4f5bc3e4ba4517ac983e9a65c", "url": "https://github.com/apache/hudi/commit/81e21d9d7f45aab4f5bc3e4ba4517ac983e9a65c", "message": "[HUDI-1209] Properties File must be optional when running deltastreamer", "committedDate": "2020-09-24T12:03:01Z", "type": "forcePushed"}, {"oid": "9d6626dd089246c773e784567925264c9aaab435", "url": "https://github.com/apache/hudi/commit/9d6626dd089246c773e784567925264c9aaab435", "message": "[HUDI-1209] Properties File must be optional when running deltastreamer", "committedDate": "2020-10-21T06:27:52Z", "type": "commit"}, {"oid": "9d6626dd089246c773e784567925264c9aaab435", "url": "https://github.com/apache/hudi/commit/9d6626dd089246c773e784567925264c9aaab435", "message": "[HUDI-1209] Properties File must be optional when running deltastreamer", "committedDate": "2020-10-21T06:27:52Z", "type": "forcePushed"}]}