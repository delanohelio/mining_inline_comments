{"pr_number": 1212, "pr_title": "[HUDI-509] Renaming code in sync with cWiki restructuring", "pr_createdAt": "2020-01-12T09:52:44Z", "pr_url": "https://github.com/apache/hudi/pull/1212", "timeline": [{"oid": "426aeced1b819a610219e744a1b801bcf13c7402", "url": "https://github.com/apache/hudi/commit/426aeced1b819a610219e744a1b801bcf13c7402", "message": "[HUDI-509] Renaming code in sync with cWiki restructuring\n\n - Storage Type replaced with Table Type (remaining instances)\n - View types replaced with query types;\n - ReadOptimized view referred as Snapshot Query\n - TableFileSystemView sub interfaces renamed to BaseFileOnly and Slice Views\n - HoodieDataFile renamed to HoodieBaseFile\n - Hive Sync tool will register RO tables for MOR with a `_ro` suffix\n - Datasource/Deltastreamer options renamed accordingly\n\nTDB\n [ ] Support fallback to old config values as well, so migration is painless\n [ ] Config for controlling _ro suffix addition", "committedDate": "2020-01-16T18:13:39Z", "type": "commit"}, {"oid": "c4007e23f184f9fa9e9d19700eb5b30f6c1c51ba", "url": "https://github.com/apache/hudi/commit/c4007e23f184f9fa9e9d19700eb5b30f6c1c51ba", "message": "Fix issue with hive sync, by refactoring how table name is passed around", "committedDate": "2020-01-16T18:13:39Z", "type": "commit"}, {"oid": "2633bcb7e2715aa7debeef1c160c1e8496faf6ff", "url": "https://github.com/apache/hudi/commit/2633bcb7e2715aa7debeef1c160c1e8496faf6ff", "message": "Adding translation to new configs, in cases where user specifies the old configs still", "committedDate": "2020-01-16T18:14:20Z", "type": "commit"}, {"oid": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "url": "https://github.com/apache/hudi/commit/97d21b1bf3e301357ad35ced94f16bf075f25c22", "message": "Also fix HoodieJavaApp, update doap", "committedDate": "2020-01-16T18:14:21Z", "type": "commit"}, {"oid": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "url": "https://github.com/apache/hudi/commit/97d21b1bf3e301357ad35ced94f16bf075f25c22", "message": "Also fix HoodieJavaApp, update doap", "committedDate": "2020-01-16T18:14:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3ODA2OA==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367678068", "bodyText": "@vinothchandar Do we want to rename the method as well to 'toHoodieBaseFile' ?", "author": "bhasudha", "createdAt": "2020-01-16T22:14:20Z", "path": "hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java", "diffHunk": "@@ -36,22 +36,22 @@\n   @JsonProperty(\"fileLen\")\n   private long fileLen;\n \n-  public static HoodieDataFile toHoodieDataFile(DataFileDTO dto) {\n+  public static HoodieBaseFile toHoodieDataFile(DataFileDTO dto) {", "originalCommit": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY4NzA2MA==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367687060", "bodyText": "+1", "author": "n3nash", "createdAt": "2020-01-16T22:39:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3ODA2OA=="}], "type": "inlineReview", "revised_code": {"commit": "b12cd461484a70133445af8713378ede52f13de6", "chunk": "diff --git a/hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java b/hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/BaseFileDTO.java\nsimilarity index 80%\nrename from hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java\nrename to hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/BaseFileDTO.java\nindex d668a8154..408aafda9 100644\n--- a/hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java\n+++ b/hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/BaseFileDTO.java\n\n@@ -36,27 +36,27 @@ public class DataFileDTO {\n   @JsonProperty(\"fileLen\")\n   private long fileLen;\n \n-  public static HoodieBaseFile toHoodieDataFile(DataFileDTO dto) {\n+  public static HoodieBaseFile toHoodieBaseFile(BaseFileDTO dto) {\n     if (null == dto) {\n       return null;\n     }\n \n-    HoodieBaseFile dataFile = null;\n+    HoodieBaseFile baseFile;\n     if (null != dto.fileStatus) {\n-      dataFile = new HoodieBaseFile(FileStatusDTO.toFileStatus(dto.fileStatus));\n+      baseFile = new HoodieBaseFile(FileStatusDTO.toFileStatus(dto.fileStatus));\n     } else {\n-      dataFile = new HoodieBaseFile(dto.fullPath);\n-      dataFile.setFileLen(dto.fileLen);\n+      baseFile = new HoodieBaseFile(dto.fullPath);\n+      baseFile.setFileLen(dto.fileLen);\n     }\n-    return dataFile;\n+    return baseFile;\n   }\n \n-  public static DataFileDTO fromHoodieDataFile(HoodieBaseFile dataFile) {\n+  public static BaseFileDTO fromHoodieBaseFile(HoodieBaseFile dataFile) {\n     if (null == dataFile) {\n       return null;\n     }\n \n-    DataFileDTO dto = new DataFileDTO();\n+    BaseFileDTO dto = new BaseFileDTO();\n     dto.fileStatus = FileStatusDTO.fromFileStatus(dataFile.getFileStatus());\n     dto.fullPath = dataFile.getPath();\n     dto.fileLen = dataFile.getFileLen();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3ODI0NQ==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367678245", "bodyText": "'fromHoodieBaseFile' instead ?", "author": "bhasudha", "createdAt": "2020-01-16T22:14:49Z", "path": "hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java", "diffHunk": "@@ -36,22 +36,22 @@\n   @JsonProperty(\"fileLen\")\n   private long fileLen;\n \n-  public static HoodieDataFile toHoodieDataFile(DataFileDTO dto) {\n+  public static HoodieBaseFile toHoodieDataFile(DataFileDTO dto) {\n     if (null == dto) {\n       return null;\n     }\n \n-    HoodieDataFile dataFile = null;\n+    HoodieBaseFile dataFile = null;\n     if (null != dto.fileStatus) {\n-      dataFile = new HoodieDataFile(FileStatusDTO.toFileStatus(dto.fileStatus));\n+      dataFile = new HoodieBaseFile(FileStatusDTO.toFileStatus(dto.fileStatus));\n     } else {\n-      dataFile = new HoodieDataFile(dto.fullPath);\n+      dataFile = new HoodieBaseFile(dto.fullPath);\n       dataFile.setFileLen(dto.fileLen);\n     }\n     return dataFile;\n   }\n \n-  public static DataFileDTO fromHoodieDataFile(HoodieDataFile dataFile) {\n+  public static DataFileDTO fromHoodieDataFile(HoodieBaseFile dataFile) {", "originalCommit": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY4NzA5NA==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367687094", "bodyText": "+1", "author": "n3nash", "createdAt": "2020-01-16T22:39:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3ODI0NQ=="}], "type": "inlineReview", "revised_code": {"commit": "b12cd461484a70133445af8713378ede52f13de6", "chunk": "diff --git a/hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java b/hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/BaseFileDTO.java\nsimilarity index 80%\nrename from hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java\nrename to hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/BaseFileDTO.java\nindex d668a8154..408aafda9 100644\n--- a/hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java\n+++ b/hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/BaseFileDTO.java\n\n@@ -36,27 +36,27 @@ public class DataFileDTO {\n   @JsonProperty(\"fileLen\")\n   private long fileLen;\n \n-  public static HoodieBaseFile toHoodieDataFile(DataFileDTO dto) {\n+  public static HoodieBaseFile toHoodieBaseFile(BaseFileDTO dto) {\n     if (null == dto) {\n       return null;\n     }\n \n-    HoodieBaseFile dataFile = null;\n+    HoodieBaseFile baseFile;\n     if (null != dto.fileStatus) {\n-      dataFile = new HoodieBaseFile(FileStatusDTO.toFileStatus(dto.fileStatus));\n+      baseFile = new HoodieBaseFile(FileStatusDTO.toFileStatus(dto.fileStatus));\n     } else {\n-      dataFile = new HoodieBaseFile(dto.fullPath);\n-      dataFile.setFileLen(dto.fileLen);\n+      baseFile = new HoodieBaseFile(dto.fullPath);\n+      baseFile.setFileLen(dto.fileLen);\n     }\n-    return dataFile;\n+    return baseFile;\n   }\n \n-  public static DataFileDTO fromHoodieDataFile(HoodieBaseFile dataFile) {\n+  public static BaseFileDTO fromHoodieBaseFile(HoodieBaseFile dataFile) {\n     if (null == dataFile) {\n       return null;\n     }\n \n-    DataFileDTO dto = new DataFileDTO();\n+    BaseFileDTO dto = new BaseFileDTO();\n     dto.fileStatus = FileStatusDTO.fromFileStatus(dataFile.getFileStatus());\n     dto.fullPath = dataFile.getPath();\n     dto.fileLen = dataFile.getFileLen();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3OTg3Nw==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367679877", "bodyText": "convertFileStatusesToBaseFiles instead ? No strong opinion on these. I think it should be okay to leave it as is since the return type is indicative already.", "author": "bhasudha", "createdAt": "2020-01-16T22:19:18Z", "path": "hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java", "diffHunk": "@@ -249,10 +249,10 @@ private void ensurePartitionLoadedCorrectly(String partition) {\n    *\n    * @param statuses List of File-Status\n    */\n-  private Stream<HoodieDataFile> convertFileStatusesToDataFiles(FileStatus[] statuses) {\n+  private Stream<HoodieBaseFile> convertFileStatusesToDataFiles(FileStatus[] statuses) {", "originalCommit": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY4NzE3Mg==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367687172", "bodyText": "+1", "author": "n3nash", "createdAt": "2020-01-16T22:39:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3OTg3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "b12cd461484a70133445af8713378ede52f13de6", "chunk": "diff --git a/hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java b/hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java\nindex 2bf194c9c..ee28cdc49 100644\n--- a/hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java\n+++ b/hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java\n\n@@ -245,11 +245,11 @@ public abstract class AbstractTableFileSystemView implements SyncableFileSystemV\n   }\n \n   /**\n-   * Helper to convert file-status to data-files.\n+   * Helper to convert file-status to base-files.\n    *\n    * @param statuses List of File-Status\n    */\n-  private Stream<HoodieBaseFile> convertFileStatusesToDataFiles(FileStatus[] statuses) {\n+  private Stream<HoodieBaseFile> convertFileStatusesToBaseFiles(FileStatus[] statuses) {\n     Predicate<FileStatus> roFilePredicate = fileStatus -> fileStatus.getPath().getName()\n         .contains(metaClient.getTableConfig().getBaseFileFormat().getFileExtension());\n     return Arrays.stream(statuses).filter(roFilePredicate).map(HoodieBaseFile::new);\n"}}, {"oid": "b12cd461484a70133445af8713378ede52f13de6", "url": "https://github.com/apache/hudi/commit/b12cd461484a70133445af8713378ede52f13de6", "message": "Renaming DataFile to BaseFile across DTOs, HoodieFileSlice and AbstractTableFileSystemView", "committedDate": "2020-01-17T07:27:11Z", "type": "commit"}]}