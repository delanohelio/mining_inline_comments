{"pr_number": 2008, "pr_title": "[MINOR] fix get classname for hive sync", "pr_createdAt": "2020-08-22T16:34:47Z", "pr_url": "https://github.com/apache/hudi/pull/2008", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI1Mzc4OQ==", "url": "https://github.com/apache/hudi/pull/2008#discussion_r480253789", "bodyText": "this is going to fail now, probably given we have a HFile base now. @garyli1019 can you please rebase and fix.", "author": "vinothchandar", "createdAt": "2020-08-31T16:44:24Z", "path": "hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java", "diffHunk": "@@ -87,9 +87,17 @@ public static FileInputFormat getInputFormat(HoodieFileFormat baseFileFormat, bo\n     }\n   }\n \n-  public static String getInputFormatClassName(HoodieFileFormat baseFileFormat, boolean realtime, Configuration conf) {\n-    FileInputFormat inputFormat = getInputFormat(baseFileFormat, realtime, conf);\n-    return inputFormat.getClass().getName();\n+  public static String getInputFormatClassName(HoodieFileFormat baseFileFormat, boolean realtime) {\n+    switch (baseFileFormat) {\n+      case PARQUET:", "originalCommit": "7087ca069ab9ce5dde1a2495d4e5b56146b6c571", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQxOTAxMQ==", "url": "https://github.com/apache/hudi/pull/2008#discussion_r480419011", "bodyText": "thanks for letting me know", "author": "garyli1019", "createdAt": "2020-08-31T21:50:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI1Mzc4OQ=="}], "type": "inlineReview", "revised_code": {"commit": "9c9205d1003d260d3caf0d7e47830205a8e579cb", "chunk": "diff --git a/hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java b/hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java\nindex 945d922d12..b36885106c 100644\n--- a/hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java\n+++ b/hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java\n\n@@ -82,6 +84,16 @@ public class HoodieInputFormatUtils {\n           inputFormat.setConf(conf);\n           return inputFormat;\n         }\n+      case HFILE:\n+        if (realtime) {\n+          HoodieHFileRealtimeInputFormat inputFormat = new HoodieHFileRealtimeInputFormat();\n+          inputFormat.setConf(conf);\n+          return inputFormat;\n+        } else {\n+          HoodieHFileInputFormat inputFormat = new HoodieHFileInputFormat();\n+          inputFormat.setConf(conf);\n+          return inputFormat;\n+        }\n       default:\n         throw new HoodieIOException(\"Hoodie InputFormat not implemented for base file format \" + baseFileFormat);\n     }\n"}}, {"oid": "9c9205d1003d260d3caf0d7e47830205a8e579cb", "url": "https://github.com/apache/hudi/commit/9c9205d1003d260d3caf0d7e47830205a8e579cb", "message": "[MINOR] fix get classname for hive sync", "committedDate": "2020-08-31T21:49:33Z", "type": "commit"}, {"oid": "9c9205d1003d260d3caf0d7e47830205a8e579cb", "url": "https://github.com/apache/hudi/commit/9c9205d1003d260d3caf0d7e47830205a8e579cb", "message": "[MINOR] fix get classname for hive sync", "committedDate": "2020-08-31T21:49:33Z", "type": "forcePushed"}]}