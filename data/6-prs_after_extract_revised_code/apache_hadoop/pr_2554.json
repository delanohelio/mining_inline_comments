{"pr_number": 2554, "pr_title": "YARN-10536. Client in distributedShell swallows interrupt exceptions", "pr_createdAt": "2020-12-17T03:30:54Z", "pr_url": "https://github.com/apache/hadoop/pull/2554", "timeline": [{"oid": "c0c7b394c9fcbbe2e0dff61d8231f90dab540407", "url": "https://github.com/apache/hadoop/commit/c0c7b394c9fcbbe2e0dff61d8231f90dab540407", "message": "YARN-10536. distributedshell client handles interrupt", "committedDate": "2020-12-17T14:25:40Z", "type": "commit"}, {"oid": "c0c7b394c9fcbbe2e0dff61d8231f90dab540407", "url": "https://github.com/apache/hadoop/commit/c0c7b394c9fcbbe2e0dff61d8231f90dab540407", "message": "YARN-10536. distributedshell client handles interrupt", "committedDate": "2020-12-17T14:25:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NTIwNQ==", "url": "https://github.com/apache/hadoop/pull/2554#discussion_r545265205", "bodyText": "No need for toString()", "author": "goiri", "createdAt": "2020-12-17T17:23:39Z", "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/src/main/java/org/apache/hadoop/yarn/applications/distributedshell/Client.java", "diffHunk": "@@ -1139,34 +1147,38 @@ private boolean monitorApplication(ApplicationId appId)\n       FinalApplicationStatus dsStatus = report.getFinalApplicationStatus();\n       if (YarnApplicationState.FINISHED == state) {\n         if (FinalApplicationStatus.SUCCEEDED == dsStatus) {\n-          LOG.info(\"Application has completed successfully. Breaking monitoring loop\");\n-          return true;        \n-        }\n-        else {\n-          LOG.info(\"Application did finished unsuccessfully.\"\n-              + \" YarnState=\" + state.toString() + \", DSFinalStatus=\" + dsStatus.toString()\n-              + \". Breaking monitoring loop\");\n-          return false;\n+          LOG.info(\"Application has completed successfully. \"\n+                  + \"Breaking monitoring loop\");\n+          res = true;\n+        } else {\n+          LOG.info(\"Application did finished unsuccessfully. \"\n+                  + \"YarnState={}, DSFinalStatus={}. Breaking monitoring loop\",\n+              state.toString(), dsStatus.toString());\n         }\n-      }\n-      else if (YarnApplicationState.KILLED == state\n+        break;\n+      } else if (YarnApplicationState.KILLED == state\n           || YarnApplicationState.FAILED == state) {\n-        LOG.info(\"Application did not finish.\"\n-            + \" YarnState=\" + state.toString() + \", DSFinalStatus=\" + dsStatus.toString()\n-            + \". Breaking monitoring loop\");\n-        return false;\n+        LOG.info(\"Application did not finish. YarnState={}, DSFinalStatus={}. \"\n+                + \"Breaking monitoring loop\",\n+            state.toString(), dsStatus.toString());", "originalCommit": "c0c7b394c9fcbbe2e0dff61d8231f90dab540407", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTMxNDU2OQ==", "url": "https://github.com/apache/hadoop/pull/2554#discussion_r545314569", "bodyText": "Thanks @goiri ! I added a commit to get rid of the \"toString()\".", "author": "amahussein", "createdAt": "2020-12-17T18:37:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NTIwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "c9853426c9cb491d352ed4ecbc3f31656e6acce9", "chunk": "diff --git a/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/src/main/java/org/apache/hadoop/yarn/applications/distributedshell/Client.java b/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/src/main/java/org/apache/hadoop/yarn/applications/distributedshell/Client.java\nindex b9f79b10e20..d7114d0481c 100644\n--- a/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/src/main/java/org/apache/hadoop/yarn/applications/distributedshell/Client.java\n+++ b/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/src/main/java/org/apache/hadoop/yarn/applications/distributedshell/Client.java\n\n@@ -1153,14 +1153,13 @@ private boolean monitorApplication(ApplicationId appId)\n         } else {\n           LOG.info(\"Application did finished unsuccessfully. \"\n                   + \"YarnState={}, DSFinalStatus={}. Breaking monitoring loop\",\n-              state.toString(), dsStatus.toString());\n+              state, dsStatus);\n         }\n         break;\n       } else if (YarnApplicationState.KILLED == state\n           || YarnApplicationState.FAILED == state) {\n         LOG.info(\"Application did not finish. YarnState={}, DSFinalStatus={}. \"\n-                + \"Breaking monitoring loop\",\n-            state.toString(), dsStatus.toString());\n+                + \"Breaking monitoring loop\", state, dsStatus);\n         break;\n       }\n \n"}}, {"oid": "c9853426c9cb491d352ed4ecbc3f31656e6acce9", "url": "https://github.com/apache/hadoop/commit/c9853426c9cb491d352ed4ecbc3f31656e6acce9", "message": "YARN-10536. address code reviews.", "committedDate": "2020-12-17T18:35:10Z", "type": "commit"}]}