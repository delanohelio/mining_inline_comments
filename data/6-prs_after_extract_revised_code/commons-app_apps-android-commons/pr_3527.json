{"pr_number": 3527, "pr_title": "Fix p18 issue For an item with P18 item, do not add another one", "pr_createdAt": "2020-03-16T14:11:56Z", "pr_url": "https://github.com/commons-app/apps-android-commons/pull/3527", "timeline": [{"oid": "01d47cfe3ceb505c8da18902e9273d9954048e22", "url": "https://github.com/commons-app/apps-android-commons/commit/01d47cfe3ceb505c8da18902e9273d9954048e22", "message": "Add p18value variable to contrib", "committedDate": "2020-03-12T15:17:55Z", "type": "commit"}, {"oid": "3a59e063fd26d0c7999d0184ce3b2ffbd1066955", "url": "https://github.com/commons-app/apps-android-commons/commit/3a59e063fd26d0c7999d0184ce3b2ffbd1066955", "message": "set place.pic to candidate contribution", "committedDate": "2020-03-12T15:19:42Z", "type": "commit"}, {"oid": "196cb9d7959e13df55b9da3381d4ebc7b0054653", "url": "https://github.com/commons-app/apps-android-commons/commit/196cb9d7959e13df55b9da3381d4ebc7b0054653", "message": "Add p18 value to contrib", "committedDate": "2020-03-16T14:05:23Z", "type": "commit"}, {"oid": "048e519d93b21e5b45d1c8faa32ac179d154f862", "url": "https://github.com/commons-app/apps-android-commons/commit/048e519d93b21e5b45d1c8faa32ac179d154f862", "message": "Passes p18 value to wikidata upload service", "committedDate": "2020-03-16T14:06:57Z", "type": "commit"}, {"oid": "9ca94073711f10b79427934739d25988f2088645", "url": "https://github.com/commons-app/apps-android-commons/commit/9ca94073711f10b79427934739d25988f2088645", "message": "Checks if pic parameter of the wikidata item is empty or not. If not, it does not overrides the existing image, it is just a regular commons upload.", "committedDate": "2020-03-16T14:07:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA2NjYwNg==", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#discussion_r393066606", "bodyText": "Why is it public when it has a getter and a setter?", "author": "macgills", "createdAt": "2020-03-16T14:27:59Z", "path": "app/src/main/java/fr/free/nrw/commons/contributions/Contribution.java", "diffHunk": "@@ -68,6 +68,7 @@ public Contribution createFromParcel(Parcel parcel) {\n     public String decimalCoords;\n     public boolean isMultiple;\n     public String wikiDataEntityId;\n+    public String p18Value;", "originalCommit": "9ca94073711f10b79427934739d25988f2088645", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE3NzU1Ng==", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#discussion_r393177556", "bodyText": "Very true, sorry \u0131 just ctrl+D from previous line, will fix it ASAP:)", "author": "neslihanturan", "createdAt": "2020-03-16T17:03:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA2NjYwNg=="}], "type": "inlineReview", "revised_code": {"commit": "662db929beb6238bb12d6b80cc13d5ee5eaeaa6b", "chunk": "diff --git a/app/src/main/java/fr/free/nrw/commons/contributions/Contribution.java b/app/src/main/java/fr/free/nrw/commons/contributions/Contribution.java\nindex 37d357a94..f71df7d8d 100644\n--- a/app/src/main/java/fr/free/nrw/commons/contributions/Contribution.java\n+++ b/app/src/main/java/fr/free/nrw/commons/contributions/Contribution.java\n\n@@ -68,7 +68,7 @@ public class  Contribution extends Media {\n     public String decimalCoords;\n     public boolean isMultiple;\n     public String wikiDataEntityId;\n-    public String p18Value;\n+    private String p18Value;\n     public Uri contentProviderUri;\n     public String dateCreatedSource;\n \n"}}, {"oid": "662db929beb6238bb12d6b80cc13d5ee5eaeaa6b", "url": "https://github.com/commons-app/apps-android-commons/commit/662db929beb6238bb12d6b80cc13d5ee5eaeaa6b", "message": "Make public var private", "committedDate": "2020-03-16T17:55:55Z", "type": "commit"}, {"oid": "60e6224c58a5ec9347567062851bd42009607cc8", "url": "https://github.com/commons-app/apps-android-commons/commit/60e6224c58a5ec9347567062851bd42009607cc8", "message": "Make current tests pass", "committedDate": "2020-03-16T17:59:18Z", "type": "commit"}, {"oid": "286823566b49b3240ce5cc36c0bb3fa574af7fdf", "url": "https://github.com/commons-app/apps-android-commons/commit/286823566b49b3240ce5cc36c0bb3fa574af7fdf", "message": "Add test case for p18 value is not empty", "committedDate": "2020-03-16T18:03:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyMDc2OQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#discussion_r393520769", "bodyText": "This log is lying, this isn't \"not null\" it is \"not blank\"(to borrow the expression from the kotlin standard library), if this method accepts null values for the p18 then this is a guaranteed NPE", "author": "macgills", "createdAt": "2020-03-17T08:46:03Z", "path": "app/src/main/java/fr/free/nrw/commons/wikidata/WikidataEditService.java", "diffHunk": "@@ -64,6 +64,11 @@ public void createClaimWithLogging(String wikidataEntityId, String fileName) {\n             return;\n         }\n \n+        if (!p18Value.trim().isEmpty()) {\n+            Timber.d(\"Skipping creation of claim as p18Value is not null, we won't override existing image\");", "originalCommit": "286823566b49b3240ce5cc36c0bb3fa574af7fdf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzMzEwOA==", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#discussion_r393533108", "bodyText": "Yeah, fixed:) it is never null, empty or value", "author": "neslihanturan", "createdAt": "2020-03-17T09:08:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyMDc2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU1MjYzOA==", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#discussion_r393552638", "bodyText": "Excellent, please mark the parameter @NonNull", "author": "macgills", "createdAt": "2020-03-17T09:42:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyMDc2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU2Mzc5Ng==", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#discussion_r393563796", "bodyText": "Done @macgills thanks a lot:)", "author": "neslihanturan", "createdAt": "2020-03-17T10:00:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyMDc2OQ=="}], "type": "inlineReview", "revised_code": {"commit": "82950aa74ae182f95ea7e1328b27476515606483", "chunk": "diff --git a/app/src/main/java/fr/free/nrw/commons/wikidata/WikidataEditService.java b/app/src/main/java/fr/free/nrw/commons/wikidata/WikidataEditService.java\nindex 3a8a3b4e9..0d1017a06 100644\n--- a/app/src/main/java/fr/free/nrw/commons/wikidata/WikidataEditService.java\n+++ b/app/src/main/java/fr/free/nrw/commons/wikidata/WikidataEditService.java\n\n@@ -65,7 +65,7 @@ public class WikidataEditService {\n         }\n \n         if (!p18Value.trim().isEmpty()) {\n-            Timber.d(\"Skipping creation of claim as p18Value is not null, we won't override existing image\");\n+            Timber.d(\"Skipping creation of claim as p18Value is not empty, we won't override existing image\");\n             return;\n         }\n \n"}}, {"oid": "82950aa74ae182f95ea7e1328b27476515606483", "url": "https://github.com/commons-app/apps-android-commons/commit/82950aa74ae182f95ea7e1328b27476515606483", "message": "Fix wrong log message", "committedDate": "2020-03-17T09:06:53Z", "type": "commit"}, {"oid": "325919a0695e96c134ab0ee97cd17fe326aff3c4", "url": "https://github.com/commons-app/apps-android-commons/commit/325919a0695e96c134ab0ee97cd17fe326aff3c4", "message": "Add nonnul annotation and fix method javadoc", "committedDate": "2020-03-17T09:59:59Z", "type": "commit"}]}