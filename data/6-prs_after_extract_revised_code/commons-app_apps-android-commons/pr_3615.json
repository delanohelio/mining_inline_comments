{"pr_number": 3615, "pr_title": "Add nearby presenter unit tests ", "pr_createdAt": "2020-04-01T15:52:15Z", "pr_url": "https://github.com/commons-app/apps-android-commons/pull/3615", "timeline": [{"oid": "2fc55e19b083e47e33b1cc6c8ed0e364a4428049", "url": "https://github.com/commons-app/apps-android-commons/commit/2fc55e19b083e47e33b1cc6c8ed0e364a4428049", "message": "init the test file", "committedDate": "2020-04-01T10:56:05Z", "type": "commit"}, {"oid": "8b1d62cdb1cccf74c7649071f63b83722e0ff150", "url": "https://github.com/commons-app/apps-android-commons/commit/8b1d62cdb1cccf74c7649071f63b83722e0ff150", "message": "Add tests to check if searchthisarea button action and checkbox actions are added after initialize test", "committedDate": "2020-04-01T12:32:18Z", "type": "commit"}, {"oid": "2f395169daa824ca99b3b36fd1eaea6ce21936bb", "url": "https://github.com/commons-app/apps-android-commons/commit/2f395169daa824ca99b3b36fd1eaea6ce21936bb", "message": "Add tests to locked unlocked nearby cases", "committedDate": "2020-04-01T12:42:09Z", "type": "commit"}, {"oid": "8a743348eca782fe1317c7921f301226b9c77981", "url": "https://github.com/commons-app/apps-android-commons/commit/8a743348eca782fe1317c7921f301226b9c77981", "message": "Add tests for null cases in updateMapAndList method", "committedDate": "2020-04-01T13:19:31Z", "type": "commit"}, {"oid": "bb4e8e0c467b0b7ee6be39ae0ae7cc91fd4cf0f9", "url": "https://github.com/commons-app/apps-android-commons/commit/bb4e8e0c467b0b7ee6be39ae0ae7cc91fd4cf0f9", "message": "Add test to check which locations are used to populate places, depending to LocationChangeType", "committedDate": "2020-04-01T13:34:24Z", "type": "commit"}, {"oid": "f0fef8ae5bbc78d1959555f5503a2d2c265374bf", "url": "https://github.com/commons-app/apps-android-commons/commit/f0fef8ae5bbc78d1959555f5503a2d2c265374bf", "message": "Add tests to test users position is not followed if blue dot (current location marker) is not visible", "committedDate": "2020-04-01T14:23:44Z", "type": "commit"}, {"oid": "5300c6fa6697d68cabadeebcc9a4e368e69affb7", "url": "https://github.com/commons-app/apps-android-commons/commit/5300c6fa6697d68cabadeebcc9a4e368e69affb7", "message": "Add tests to decide search this area method visibility on camera move", "committedDate": "2020-04-02T10:37:07Z", "type": "commit"}, {"oid": "677126f7f9482bf3df86514b1232a344ccf13fc7", "url": "https://github.com/commons-app/apps-android-commons/commit/677126f7f9482bf3df86514b1232a344ccf13fc7", "message": "Add tests for multi filteirng of placetypes", "committedDate": "2020-04-02T11:03:44Z", "type": "commit"}, {"oid": "c597ea5b0f7bbe4c7768dd6e935a006d6de560e5", "url": "https://github.com/commons-app/apps-android-commons/commit/c597ea5b0f7bbe4c7768dd6e935a006d6de560e5", "message": "add tests for single place type selection too", "committedDate": "2020-04-02T11:31:04Z", "type": "commit"}, {"oid": "ec37b1e294fb92efddc2a0b63c2746c81ef6e47c", "url": "https://github.com/commons-app/apps-android-commons/commit/ec37b1e294fb92efddc2a0b63c2746c81ef6e47c", "message": "Add tests to tests search view focus gain and bottom sheet visibilities", "committedDate": "2020-04-02T12:07:20Z", "type": "commit"}, {"oid": "d66c7be7cff34035be2611a9202e65148f822cf6", "url": "https://github.com/commons-app/apps-android-commons/commit/d66c7be7cff34035be2611a9202e65148f822cf6", "message": "Add tests for SearchCloseToCurrentLocation", "committedDate": "2020-04-02T13:17:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk3ODExMw==", "url": "https://github.com/commons-app/apps-android-commons/pull/3615#discussion_r403978113", "bodyText": "Exposing code for test is a code smell. The option is to rewrite or use the nasty @VisibleForTesting annotation.\nI'd say rewrite because lockUnlockNearby sets it quite easily for you.", "author": "macgills", "createdAt": "2020-04-06T10:13:00Z", "path": "app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java", "diffHunk": "@@ -373,4 +373,12 @@ public boolean areLocationsClose(LatLng cameraTarget, LatLng lastKnownLocation)\n             return true;\n         }\n     }\n+\n+    public boolean isNearbyLocked() {", "originalCommit": "d66c7be7cff34035be2611a9202e65148f822cf6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA0Nzk4Mg==", "url": "https://github.com/commons-app/apps-android-commons/pull/3615#discussion_r404047982", "bodyText": "I didn't know about the annotation will do! Thanks:)", "author": "neslihanturan", "createdAt": "2020-04-06T12:22:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk3ODExMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2NDA5OQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3615#discussion_r404064099", "bodyText": "I meant for you to rewrite the test, @VisibleForTesting is an ugly bandaid and should only be used in extreme scenarios", "author": "macgills", "createdAt": "2020-04-06T12:49:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk3ODExMw=="}], "type": "inlineReview", "revised_code": {"commit": "fe1f1b8c80d8a8031013a096ea3c3451acfde90f", "chunk": "diff --git a/app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java b/app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java\nindex 1bd8b5e13..a36bf483d 100644\n--- a/app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java\n+++ b/app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java\n\n@@ -373,12 +375,4 @@ public class NearbyParentFragmentPresenter\n             return true;\n         }\n     }\n-\n-    public boolean isNearbyLocked() {\n-        return isNearbyLocked;\n-    }\n-\n-    public void setNearbyLocked(boolean nearbyLocked) {\n-        isNearbyLocked = nearbyLocked;\n-    }\n }\n"}}, {"oid": "fe1f1b8c80d8a8031013a096ea3c3451acfde90f", "url": "https://github.com/commons-app/apps-android-commons/commit/fe1f1b8c80d8a8031013a096ea3c3451acfde90f", "message": "Remove two unneeded getter and setter for isNearbyLocked, use @VisibleForTesting annotation instead", "committedDate": "2020-04-06T12:33:34Z", "type": "commit"}, {"oid": "0178f3c74d84f618b1251a5b2ae77ea16fc03c20", "url": "https://github.com/commons-app/apps-android-commons/commit/0178f3c74d84f618b1251a5b2ae77ea16fc03c20", "message": "Add VisibleForTesting annotation to initializeNearbyOperations method so that it will be private by default", "committedDate": "2020-04-06T13:08:13Z", "type": "commit"}, {"oid": "6ba4ef691ff7cdd9cff77602b5f5860bffd90e84", "url": "https://github.com/commons-app/apps-android-commons/commit/6ba4ef691ff7cdd9cff77602b5f5860bffd90e84", "message": "Add missing tests", "committedDate": "2020-04-06T13:15:06Z", "type": "commit"}, {"oid": "53abcace89bf8a94380d79c4aa17bc314b33dd21", "url": "https://github.com/commons-app/apps-android-commons/commit/53abcace89bf8a94380d79c4aa17bc314b33dd21", "message": "Add tests for map updated case and add missing lines those are being tested", "committedDate": "2020-04-06T13:33:39Z", "type": "commit"}, {"oid": "ca775b9eb5dc03c59752c21f36a513ce71d95dcd", "url": "https://github.com/commons-app/apps-android-commons/commit/ca775b9eb5dc03c59752c21f36a513ce71d95dcd", "message": "Add some missind method verifications", "committedDate": "2020-04-06T14:49:39Z", "type": "commit"}, {"oid": "f691149eeff24a5caca1abd5650025a6dc7e8d9a", "url": "https://github.com/commons-app/apps-android-commons/commit/f691149eeff24a5caca1abd5650025a6dc7e8d9a", "message": "Create real latlang objects isntead of spying them", "committedDate": "2020-04-06T15:02:35Z", "type": "commit"}, {"oid": "98fc8a0c294e097f398e315ad227f89ea483b5ba", "url": "https://github.com/commons-app/apps-android-commons/commit/98fc8a0c294e097f398e315ad227f89ea483b5ba", "message": "Use a real presenter object instead of a spy", "committedDate": "2020-04-06T15:36:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY1MzgzMQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3615#discussion_r404653831", "bodyText": "As per the thread where I first mentioned this annotation\n\nI meant for you to rewrite the test, @VisibleForTesting is an ugly bandaid and should only be used in extreme scenarios", "author": "macgills", "createdAt": "2020-04-07T09:06:04Z", "path": "app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java", "diffHunk": "@@ -2,6 +2,7 @@\n \n import android.view.View;\n \n+import androidx.annotation.VisibleForTesting;", "originalCommit": "98fc8a0c294e097f398e315ad227f89ea483b5ba", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "86a0a93ceb7a9239f15916c8fe7d1e9e72bc0a7c", "chunk": "diff --git a/app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java b/app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java\nindex ed81e739a..770039295 100644\n--- a/app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java\n+++ b/app/src/main/java/fr/free/nrw/commons/nearby/presenter/NearbyParentFragmentPresenter.java\n\n@@ -2,7 +2,6 @@ package fr.free.nrw.commons.nearby.presenter;\n \n import android.view.View;\n \n-import androidx.annotation.VisibleForTesting;\n import com.mapbox.mapboxsdk.annotations.Marker;\n \n import java.lang.reflect.Proxy;\n"}}, {"oid": "c6c5796c12e3f33b9b09c5201d498df757dccd2d", "url": "https://github.com/commons-app/apps-android-commons/commit/c6c5796c12e3f33b9b09c5201d498df757dccd2d", "message": "Merge remote-tracking branch 'upstream/master' into addNearbyTests", "committedDate": "2020-04-20T11:16:08Z", "type": "commit"}, {"oid": "0ab622523c583d577d857ebbd7314d7c75d3f8c1", "url": "https://github.com/commons-app/apps-android-commons/commit/0ab622523c583d577d857ebbd7314d7c75d3f8c1", "message": "Revert nonneeded @VisibleForTest annotations, instead reach via lockUnlock method", "committedDate": "2020-04-20T11:31:22Z", "type": "commit"}, {"oid": "86a0a93ceb7a9239f15916c8fe7d1e9e72bc0a7c", "url": "https://github.com/commons-app/apps-android-commons/commit/86a0a93ceb7a9239f15916c8fe7d1e9e72bc0a7c", "message": "Reduce code repetitions", "committedDate": "2020-04-20T15:12:15Z", "type": "commit"}, {"oid": "cd0b1609f3f848812d0beb05c18387d8315b0aba", "url": "https://github.com/commons-app/apps-android-commons/commit/cd0b1609f3f848812d0beb05c18387d8315b0aba", "message": "Do not call a test from another test method", "committedDate": "2020-04-20T15:20:17Z", "type": "commit"}, {"oid": "002ccda44b8f5fb31a459eedfff385684d7a13e9", "url": "https://github.com/commons-app/apps-android-commons/commit/002ccda44b8f5fb31a459eedfff385684d7a13e9", "message": "Add some more tests", "committedDate": "2020-04-29T20:24:25Z", "type": "commit"}, {"oid": "e3347e514ae1921ae6428bd67343f93b2f766312", "url": "https://github.com/commons-app/apps-android-commons/commit/e3347e514ae1921ae6428bd67343f93b2f766312", "message": "Fix minor issues", "committedDate": "2020-04-29T20:49:30Z", "type": "commit"}]}