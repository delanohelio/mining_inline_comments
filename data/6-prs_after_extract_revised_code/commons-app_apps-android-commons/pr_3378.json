{"pr_number": 3378, "pr_title": "Fixes #3295: Ultimate achievement: Too many contributions", "pr_createdAt": "2020-02-06T00:09:33Z", "pr_url": "https://github.com/commons-app/apps-android-commons/pull/3378", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjExMzc1MQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3378#discussion_r386113751", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                numberOfEdits += edits;\n          \n          \n            \n                                numberOfEdits = edits;", "author": "domdomegg", "createdAt": "2020-03-01T14:45:06Z", "path": "app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java", "diffHunk": "@@ -259,7 +274,10 @@ private void setWikidataEditCount() {\n                 .getWikidataEdits(userName)\n                 .subscribeOn(Schedulers.io())\n                 .observeOn(AndroidSchedulers.mainThread())\n-                .subscribe(edits -> wikidataEditsText.setText(String.valueOf(edits)), e -> {\n+                .subscribe(edits -> {\n+                    numberOfEdits += edits;", "originalCommit": "c626bab5ac9356572366b1ad4aeae33a3ac1ebbb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5c60f777ef75203dc42d173039a46be1df7db6f6", "chunk": "diff --git a/app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java b/app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java\nindex ee98c54a1..d12ec942e 100644\n--- a/app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java\n+++ b/app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java\n\n@@ -275,7 +275,7 @@ public class AchievementsActivity extends NavigationBaseActivity {\n                 .subscribeOn(Schedulers.io())\n                 .observeOn(AndroidSchedulers.mainThread())\n                 .subscribe(edits -> {\n-                    numberOfEdits += edits;\n+                    numberOfEdits = edits;\n                     wikidataEditsText.setText(String.valueOf(edits));\n                 }, e -> {\n                     Timber.e(\"Error:\" + e);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjExNDAzMw==", "url": "https://github.com/commons-app/apps-android-commons/pull/3378#discussion_r386114033", "bodyText": "nit: Making this just showSnackBarWithRetry(int numberOfEdits), which would remove a lot of duplicate logic.", "author": "domdomegg", "createdAt": "2020-03-01T14:48:49Z", "path": "app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java", "diffHunk": "@@ -274,6 +292,17 @@ private void showSnackBarWithRetry() {\n                 R.string.achievements_fetch_failed, R.string.retry, view -> setAchievements());\n     }\n \n+    /**\n+     * Shows a snack bar which tells the users that their wiki edit count is so high that it (in some cases)\n+     * wreks havoc with the Achievements calculator due to which request may time out\n+     * Well this is the Ultimate Achievement \n+     */\n+    private void showSnackBarUltimateAchievementWithRetry() {", "originalCommit": "c626bab5ac9356572366b1ad4aeae33a3ac1ebbb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5c60f777ef75203dc42d173039a46be1df7db6f6", "chunk": "diff --git a/app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java b/app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java\nindex ee98c54a1..d12ec942e 100644\n--- a/app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java\n+++ b/app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java\n\n@@ -285,22 +285,20 @@ public class AchievementsActivity extends NavigationBaseActivity {\n     /**\n      * Shows a snack bar which has an action button which on click dismisses the snackbar and invokes the\n      * listener passed\n+     * @param tooManyAchievements if this value is true it means that the number of achievements of the \n+     * user are so high that it wrecks havoc with the Achievements calculator due to which request may time \n+     * out. Well this is the Ultimate Achievement\n      */\n-    private void showSnackBarWithRetry() {\n-        progressBar.setVisibility(View.GONE);\n-        ViewUtil.showDismissibleSnackBar(findViewById(android.R.id.content),\n-                R.string.achievements_fetch_failed, R.string.retry, view -> setAchievements());\n-    }\n-\n-    /**\n-     * Shows a snack bar which tells the users that their wiki edit count is so high that it (in some cases)\n-     * wreks havoc with the Achievements calculator due to which request may time out\n-     * Well this is the Ultimate Achievement \n-     */\n-    private void showSnackBarUltimateAchievementWithRetry() {\n-        progressBar.setVisibility(View.GONE);\n-        ViewUtil.showDismissibleSnackBar(findViewById(android.R.id.content),\n-                R.string.achievements_fetch_failed_ultimate_achievement, R.string.retry, view -> setAchievements());\n+    private void showSnackBarWithRetry(boolean tooManyAchievements) {\n+        if (tooManyAchievements) {\n+            progressBar.setVisibility(View.GONE);\n+            ViewUtil.showDismissibleSnackBar(findViewById(android.R.id.content),\n+                    R.string.achievements_fetch_failed_ultimate_achievement, R.string.retry, view -> setAchievements());\n+        } else {\n+            progressBar.setVisibility(View.GONE);\n+            ViewUtil.showDismissibleSnackBar(findViewById(android.R.id.content),\n+                    R.string.achievements_fetch_failed, R.string.retry, view -> setAchievements());\n+        }\n     }\n \n     /**\n"}}, {"oid": "ccfe44ae7aa604bff5f0e44449c7e474d3c5f6fd", "url": "https://github.com/commons-app/apps-android-commons/commit/ccfe44ae7aa604bff5f0e44449c7e474d3c5f6fd", "message": "fixing travis ci failed", "committedDate": "2020-03-08T14:49:30Z", "type": "commit"}, {"oid": "5c60f777ef75203dc42d173039a46be1df7db6f6", "url": "https://github.com/commons-app/apps-android-commons/commit/5c60f777ef75203dc42d173039a46be1df7db6f6", "message": "AchievementsActivity: make requested changes", "committedDate": "2020-03-08T14:54:42Z", "type": "commit"}, {"oid": "5c60f777ef75203dc42d173039a46be1df7db6f6", "url": "https://github.com/commons-app/apps-android-commons/commit/5c60f777ef75203dc42d173039a46be1df7db6f6", "message": "AchievementsActivity: make requested changes", "committedDate": "2020-03-08T14:54:42Z", "type": "forcePushed"}]}