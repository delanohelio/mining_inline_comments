{"pr_number": 4093, "pr_title": "DB-10194 Create new database through JDBC connect", "pr_createdAt": "2020-09-07T13:23:00Z", "pr_url": "https://github.com/splicemachine/spliceengine/pull/4093", "timeline": [{"oid": "abcedeadf685b103279d8825531f3755c88b1fed", "url": "https://github.com/splicemachine/spliceengine/commit/abcedeadf685b103279d8825531f3755c88b1fed", "message": "DB-10194 Multidatabase first commit", "committedDate": "2020-09-07T13:21:46Z", "type": "commit"}, {"oid": "12ec3394e5f2a9f304a861b887d80bbd8851c480", "url": "https://github.com/splicemachine/spliceengine/commit/12ec3394e5f2a9f304a861b887d80bbd8851c480", "message": "DB-10194 Support 'show databases' in sqlshell", "committedDate": "2020-09-07T13:21:58Z", "type": "commit"}, {"oid": "9501b63d987c662b8fa1183ae24f0e84bc8c4351", "url": "https://github.com/splicemachine/spliceengine/commit/9501b63d987c662b8fa1183ae24f0e84bc8c4351", "message": "DB-10194 Create new database with correct uuid. New schemas use that uuid", "committedDate": "2020-09-07T13:22:02Z", "type": "commit"}, {"oid": "9d6262470187844dbb180354b71a4e60b9bb64aa", "url": "https://github.com/splicemachine/spliceengine/commit/9d6262470187844dbb180354b71a4e60b9bb64aa", "message": "DB-10194 Use placeholders in database authorizationId", "committedDate": "2020-09-07T13:22:08Z", "type": "commit"}, {"oid": "2f2ccd4b963bd8c79109c5f524990a3a0119c478", "url": "https://github.com/splicemachine/spliceengine/commit/2f2ccd4b963bd8c79109c5f524990a3a0119c478", "message": "DB-10194 Fix spotbugs", "committedDate": "2020-09-07T17:26:57Z", "type": "commit"}, {"oid": "2f2ccd4b963bd8c79109c5f524990a3a0119c478", "url": "https://github.com/splicemachine/spliceengine/commit/2f2ccd4b963bd8c79109c5f524990a3a0119c478", "message": "DB-10194 Fix spotbugs", "committedDate": "2020-09-07T17:26:57Z", "type": "forcePushed"}, {"oid": "71fe88feb22ffbeb20c871532504e87e5a757229", "url": "https://github.com/splicemachine/spliceengine/commit/71fe88feb22ffbeb20c871532504e87e5a757229", "message": "DB-10194 Fix more spotbugs", "committedDate": "2020-09-08T08:24:51Z", "type": "commit"}, {"oid": "48c4bbf426ce5b81f6a89da0c10edf0c3a29fe35", "url": "https://github.com/splicemachine/spliceengine/commit/48c4bbf426ce5b81f6a89da0c10edf0c3a29fe35", "message": "DB-10194 Fix even more spotbugs", "committedDate": "2020-09-08T11:53:37Z", "type": "commit"}, {"oid": "3bc871ce0ff9e97edd16d380bdf41f4f5e01e833", "url": "https://github.com/splicemachine/spliceengine/commit/3bc871ce0ff9e97edd16d380bdf41f4f5e01e833", "message": "DB-10194 Fix even more spotbugs", "committedDate": "2020-09-08T12:05:47Z", "type": "commit"}, {"oid": "09a33748eaf83acd39ca0ac3bd9375ac5bb29294", "url": "https://github.com/splicemachine/spliceengine/commit/09a33748eaf83acd39ca0ac3bd9375ac5bb29294", "message": "DB-10194 Fix aggressive assert", "committedDate": "2020-09-08T20:28:42Z", "type": "commit"}, {"oid": "d080b39e81b476882b750fc41fdaf85254ab3f30", "url": "https://github.com/splicemachine/spliceengine/commit/d080b39e81b476882b750fc41fdaf85254ab3f30", "message": "DB-10194 Use sysvw instead of sys in 'show databases'", "committedDate": "2020-09-10T12:19:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzgyMDE3NQ==", "url": "https://github.com/splicemachine/spliceengine/pull/4093#discussion_r487820175", "bodyText": "this call is not assign to any variable, usually paramType. Looks like not needed any more and can be removed.", "author": "ipraznik-splice", "createdAt": "2020-09-14T10:47:49Z", "path": "db-client/src/main/java/com/splicemachine/db/client/am/PreparedStatement.java", "diffHunk": "@@ -941,8 +944,8 @@ public void setRowId(int parameterIndex, java.sql.RowId x) throws SQLException{\n                     agent_.logWriter_.traceEntry(this, \"setRowId\", parameterIndex, x);\n                 }\n \n-                final int paramType =\n-                        getColumnMetaDataX().getColumnType(parameterIndex);\n+                getColumnMetaDataX().getColumnType(parameterIndex);", "originalCommit": "d080b39e81b476882b750fc41fdaf85254ab3f30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAxOTQ1Mw==", "url": "https://github.com/splicemachine/spliceengine/pull/4093#discussion_r488019453", "bodyText": "(spotbug) I would leave this like this since getColumnType can throw. We never used paramType, but if we want to keep the current behaviour, then we should continue calling this function.", "author": "arnaud-splice", "createdAt": "2020-09-14T15:24:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzgyMDE3NQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzgyMjk5MA==", "url": "https://github.com/splicemachine/spliceengine/pull/4093#discussion_r487822990", "bodyText": "this call is not assign to any variable", "author": "ipraznik-splice", "createdAt": "2020-09-14T10:53:20Z", "path": "db-client/src/main/java/com/splicemachine/db/client/net/NetConnectionReply.java", "diffHunk": "@@ -296,8 +289,9 @@ private void parseSECCHKreply(NetConnection netConnection) throws DisconnectExce\n             // incorrect but consider it a conversation protocol error\n             // 0x03 - OBJDSS sent when not allowed.\n             //parseSECTKN (true);\n-            boolean done = false;\n-            byte[] bytes = parseSECTKN(false);\n+            //boolean done = false;\n+            //byte[] bytes = parseSECTKN(false);\n+            parseSECTKN(false);", "originalCommit": "d080b39e81b476882b750fc41fdaf85254ab3f30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAyMDIyMw==", "url": "https://github.com/splicemachine/spliceengine/pull/4093#discussion_r488020223", "bodyText": "(spotbug) It simply moves the parser forward. We don't do anything with the result.", "author": "arnaud-splice", "createdAt": "2020-09-14T15:25:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzgyMjk5MA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzgzNDI3OQ==", "url": "https://github.com/splicemachine/spliceengine/pull/4093#discussion_r487834279", "bodyText": "is it used somewhere in subclasses? in EmbedConnection I see only .set and .remove", "author": "ipraznik-splice", "createdAt": "2020-09-14T11:15:23Z", "path": "db-engine/src/main/java/com/splicemachine/db/impl/jdbc/EmbedConnection.java", "diffHunk": "@@ -101,7 +102,8 @@\n  */\n public abstract class EmbedConnection implements EngineConnection\n {\n-\tprotected static final StandardException exceptionClose = StandardException.closeException();\n+    public static final ThreadLocal<Boolean> isCreate = new ThreadLocal<>();", "originalCommit": "d080b39e81b476882b750fc41fdaf85254ab3f30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAyMjYzNQ==", "url": "https://github.com/splicemachine/spliceengine/pull/4093#discussion_r488022635", "bodyText": "It is used in SpliceDatabase.bootStore\nIt is quite similar to EngineLifecycleService.isCreate that we use when creating the very first splicedb. However, when we create a new database, we don't go all the way to EngineLifecycleService.start() so we cannot use that one class variable.", "author": "arnaud-splice", "createdAt": "2020-09-14T15:27:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzgzNDI3OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg2NTc0Ng==", "url": "https://github.com/splicemachine/spliceengine/pull/4093#discussion_r487865746", "bodyText": "Should be removed?:)", "author": "ipraznik-splice", "createdAt": "2020-09-14T12:17:00Z", "path": "splice_machine/src/main/java/com/splicemachine/derby/jdbc/SpliceTransactionResourceImpl.java", "diffHunk": "@@ -51,14 +51,18 @@\n     protected LanguageConnectionContext lcc;\n     protected String ipAddress;\n \n-    public SpliceTransactionResourceImpl() throws SQLException{\n-        this(CONNECTION_STRING, new Properties());\n+    public SpliceTransactionResourceImpl() throws SQLException{ // XXX Remove this one and properly pass the right DB", "originalCommit": "d080b39e81b476882b750fc41fdaf85254ab3f30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAyMzI2MA==", "url": "https://github.com/splicemachine/spliceengine/pull/4093#discussion_r488023260", "bodyText": "This will be addressed in the following jiras", "author": "arnaud-splice", "createdAt": "2020-09-14T15:28:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg2NTc0Ng=="}], "type": "inlineReview", "revised_code": null}]}