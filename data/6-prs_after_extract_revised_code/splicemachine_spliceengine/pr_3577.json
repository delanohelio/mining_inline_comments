{"pr_number": 3577, "pr_title": "DB-9374: refetch region locations if cache is stale", "pr_createdAt": "2020-05-15T19:10:31Z", "pr_url": "https://github.com/splicemachine/spliceengine/pull/3577", "timeline": [{"oid": "6f4070870cdec067f05c46e491b7b733d0d80e53", "url": "https://github.com/splicemachine/spliceengine/commit/6f4070870cdec067f05c46e491b7b733d0d80e53", "message": "DB-9374: refetch region locations if cache is stale", "committedDate": "2020-05-15T18:52:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA2MzQ5MA==", "url": "https://github.com/splicemachine/spliceengine/pull/3577#discussion_r427063490", "bodyText": "Is it better to use \"false\" explicitly than the variable \"refresh\" to force not to use the cache?", "author": "yxia92", "createdAt": "2020-05-19T06:40:27Z", "path": "hbase_storage/src/main/java/com/splicemachine/storage/ClientPartition.java", "diffHunk": "@@ -157,6 +157,9 @@ public boolean checkAndPut(byte[] key,byte[] family,byte[] qualifier,byte[] expe\n                 }\n             }\n             List<HRegionLocation> tableLocations = ((ClusterConnection) connection).locateRegions(tableName, !refresh, false);\n+            if (outdated(tableLocations)) {\n+                tableLocations = ((ClusterConnection) connection).locateRegions(tableName, refresh, false);", "originalCommit": "6f4070870cdec067f05c46e491b7b733d0d80e53", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b5bc7311941f0b6b7c46a410237e7430c49b7741", "chunk": "diff --git a/hbase_storage/src/main/java/com/splicemachine/storage/ClientPartition.java b/hbase_storage/src/main/java/com/splicemachine/storage/ClientPartition.java\nindex 4fa0001f47..417525f33a 100644\n--- a/hbase_storage/src/main/java/com/splicemachine/storage/ClientPartition.java\n+++ b/hbase_storage/src/main/java/com/splicemachine/storage/ClientPartition.java\n\n@@ -158,7 +158,7 @@ public class ClientPartition extends SkeletonHBaseClientPartition{\n             }\n             List<HRegionLocation> tableLocations = ((ClusterConnection) connection).locateRegions(tableName, !refresh, false);\n             if (outdated(tableLocations)) {\n-                tableLocations = ((ClusterConnection) connection).locateRegions(tableName, refresh, false);\n+                tableLocations = ((ClusterConnection) connection).locateRegions(tableName, false, false);\n             }\n             partitions = new ArrayList<>(tableLocations.size());\n             for (HRegionLocation location : tableLocations){\n"}}, {"oid": "b5bc7311941f0b6b7c46a410237e7430c49b7741", "url": "https://github.com/splicemachine/spliceengine/commit/b5bc7311941f0b6b7c46a410237e7430c49b7741", "message": "address review comments", "committedDate": "2020-05-19T14:52:44Z", "type": "commit"}]}