{"pr_number": 514, "pr_title": "refactor(api): clean up model-based apis", "pr_createdAt": "2020-05-22T19:51:56Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/514", "timeline": [{"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "url": "https://github.com/aws-amplify/amplify-android/commit/3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "message": "refactor(api): clean up model-based apis", "committedDate": "2020-05-22T19:49:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMTQyMQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429431421", "bodyText": "Change to default system runtime exception - such as InvalidParameter", "author": "TrekSoft", "createdAt": "2020-05-22T20:01:36Z", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -93,18 +93,17 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new InvalidGraphQLRequestRuntimeException(", "originalCommit": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "21064d45ffdc71f48050d70508939dc96b0e48d5", "chunk": "diff --git a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\nindex 2f6d72ce..d0667279 100644\n--- a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n+++ b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n\n@@ -93,7 +93,7 @@ final class AppSyncGraphQLRequestFactory {\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new InvalidGraphQLRequestRuntimeException(\n+            throw new IllegalStateException(\n                     \"Could not generate a schema for the specified class\",\n                     exception\n             );\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMjMwOA==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429432308", "bodyText": "Don't use Report bug for these types", "author": "TrekSoft", "createdAt": "2020-05-22T20:04:17Z", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -468,4 +458,17 @@ private static String getModelFields(Class<? extends Model> clazz, int levelsDee\n \n         return result.toString();\n     }\n+\n+    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {\n+\n+        private static final long serialVersionUID = 1L;\n+\n+        InvalidGraphQLRequestRuntimeException(final String message, final Exception rootCause) {\n+            super(message + \"\\n\" + AmplifyException.REPORT_BUG_TO_AWS_SUGGESTION, rootCause);", "originalCommit": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ0OTg2Nw==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429449867", "bodyText": "Yea, the AmplifyException has the strongly modeled recovery exception. I don't think we should inline the recovery suggestions into causes. I'm imagining that this InvalidGraphQLRequestRuntimeException gets composed into an ApiException, before being returned to the customer. If that's so, then we'd have two recovery suggestions. This one, then the one in ApiException.", "author": "jamesonwilliams", "createdAt": "2020-05-22T21:01:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMjMwOA=="}], "type": "inlineReview", "revised_code": {"commit": "21064d45ffdc71f48050d70508939dc96b0e48d5", "chunk": "diff --git a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\nindex 2f6d72ce..d0667279 100644\n--- a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n+++ b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n\n@@ -458,17 +458,4 @@ final class AppSyncGraphQLRequestFactory {\n \n         return result.toString();\n     }\n-\n-    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {\n-\n-        private static final long serialVersionUID = 1L;\n-\n-        InvalidGraphQLRequestRuntimeException(final String message, final Exception rootCause) {\n-            super(message + \"\\n\" + AmplifyException.REPORT_BUG_TO_AWS_SUGGESTION, rootCause);\n-        }\n-\n-        InvalidGraphQLRequestRuntimeException(final String message) {\n-            this(message + \"\\n\" + AmplifyException.REPORT_BUG_TO_AWS_SUGGESTION, null);\n-        }\n-    }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNTY5MQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429435691", "bodyText": "Unused param", "author": "TrekSoft", "createdAt": "2020-05-22T20:14:14Z", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.Nullable;\n+\n+/**\n+ * TODO.\n+ */\n+public final class ModelPagination {\n+\n+    private static final int DEFAULT_LIMIT = 1000;\n+\n+    private int limit;\n+    private final String nextToken;\n+\n+    private ModelPagination(int limit, String nextToken) {\n+        this.limit = limit;\n+        this.nextToken = nextToken;\n+    }\n+\n+    /**\n+     * TODO.\n+     * @return todo.\n+     */\n+    public static ModelPagination firstPage() {\n+        return nextToken(null);\n+    }\n+\n+    /**\n+     * TODO.\n+     * @param nextToken todo.\n+     * @return todo.\n+     */\n+    public static ModelPagination nextToken(@Nullable String nextToken) {", "originalCommit": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MDI5MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429450290", "bodyText": "It's a public API, the implementation needs to be updated after release to use the token. At least, I think that's whats being stated here, right, @drochetti?", "author": "jamesonwilliams", "createdAt": "2020-05-22T21:02:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNTY5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ2NzUyMg==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429467522", "bodyText": "That's correct. It was a mistake, already fixed.", "author": "drochetti", "createdAt": "2020-05-22T21:53:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNTY5MQ=="}], "type": "inlineReview", "revised_code": {"commit": "21064d45ffdc71f48050d70508939dc96b0e48d5", "chunk": "diff --git a/aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java b/aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java\nindex 05a4b427..e557723d 100644\n--- a/aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java\n+++ b/aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java\n\n@@ -46,7 +46,7 @@ public final class ModelPagination {\n      * @return todo.\n      */\n     public static ModelPagination nextToken(@Nullable String nextToken) {\n-        return new ModelPagination(DEFAULT_LIMIT, null);\n+        return new ModelPagination(DEFAULT_LIMIT, nextToken);\n     }\n \n     /**\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNzkxNw==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429437917", "bodyText": "Remove comment", "author": "TrekSoft", "createdAt": "2020-05-22T20:23:44Z", "path": "aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java", "diffHunk": "@@ -121,6 +121,7 @@ public void syncUpToCloudIsWorking() throws AmplifyException {\n         publishedMutationsAccumulator.await();\n \n         // Try to get Charley from the backend.\n+//        BlogOwner remoteCharley = api.get(BlogOwner.class, localCharley.getId());", "originalCommit": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "21064d45ffdc71f48050d70508939dc96b0e48d5", "chunk": "diff --git a/aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java b/aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java\nindex 07cf70c4..a6f7d3dd 100644\n--- a/aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java\n+++ b/aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java\n\n@@ -121,7 +121,6 @@ public final class AWSDataStorePluginInstrumentedTest {\n         publishedMutationsAccumulator.await();\n \n         // Try to get Charley from the backend.\n-//        BlogOwner remoteCharley = api.get(BlogOwner.class, localCharley.getId());\n         BlogOwner remoteCharley = api.get(BlogOwner.class, localCharley.getId());\n \n         // A Charley is a Charley is a Charley, right?\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzODc4NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429438784", "bodyText": "Not important for this PR, but this should be R, not T.   This was something I missed in my PR.  We can fix it later without it being a breaking change though.", "author": "richardmcclellan", "createdAt": "2020-05-22T20:27:07Z", "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxApiBinding.java", "diffHunk": "@@ -50,134 +46,44 @@\n         this.api = api;\n     }\n \n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(@NonNull Class<T> modelClass) {\n-        return toSingle((onResult, onError) -> api.query(modelClass, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> query(\n-            @NonNull Class<T> modelClass, @NonNull String modelId) {\n-        return toSingle((onResult, onError) -> api.query(modelClass, modelId, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(\n-            @NonNull Class<T> modelClass, @NonNull QueryPredicate searchCriteria) {\n-        return toSingle((onResult, onError) -> api.query(modelClass, searchCriteria, onResult, onError));\n-\n-    }\n-\n     @NonNull\n     public <R> Single<GraphQLResponse<R>> query(@NonNull GraphQLRequest<R> graphQlRequest) {\n         return toSingle((onResult, onError) -> api.query(graphQlRequest, onResult, onError));\n     }\n \n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(\n-            @NonNull String apiName, @NonNull Class<T> modelClass) {\n-        return toSingle((onResult, onError) -> api.query(apiName, modelClass, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> query(\n-            @NonNull String apiName, @NonNull Class<T> modelClass, @NonNull String modelId) {\n-        return toSingle((onResult, onError) -> api.query(apiName, modelClass, modelId, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(\n-            @NonNull String apiName, @NonNull Class<T> modelClass, @NonNull QueryPredicate searchCriteria) {\n-        return toSingle((onResult, onError) -> api.query(apiName, modelClass, searchCriteria, onResult, onError));\n-    }\n-\n     @NonNull\n     @Override\n     public <R> Single<GraphQLResponse<R>> query(\n             @NonNull String apiName, @NonNull GraphQLRequest<R> graphQlRequest) {\n         return toSingle((onResult, onError) -> api.query(apiName, graphQlRequest, onResult, onError));\n     }\n \n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> mutate(\n-            @NonNull T model, @NonNull MutationType mutationType) {\n-        return toSingle((onResult, onError) -> api.mutate(model, mutationType, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> mutate(\n-            @NonNull T model, @NonNull QueryPredicate mutationCriteria, @NonNull MutationType mutationType) {\n-        return toSingle((onResult, onError) -> api.mutate(model, mutationCriteria, mutationType, onResult, onError));\n-    }\n-\n     @NonNull\n     @Override\n     public <T> Single<GraphQLResponse<T>> mutate(@NonNull GraphQLRequest<T> graphQlRequest) {", "originalCommit": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f112e0dc57e72a54b80d06bd9024b481df2c9b0d", "chunk": "diff --git a/rxbindings/src/main/java/com/amplifyframework/rx/RxApiBinding.java b/rxbindings/src/main/java/com/amplifyframework/rx/RxApiBinding.java\nindex 16b1f937..f5242b12 100644\n--- a/rxbindings/src/main/java/com/amplifyframework/rx/RxApiBinding.java\n+++ b/rxbindings/src/main/java/com/amplifyframework/rx/RxApiBinding.java\n\n@@ -60,7 +60,7 @@ final class RxApiBinding implements RxApiCategoryBehavior {\n \n     @NonNull\n     @Override\n-    public <T> Single<GraphQLResponse<T>> mutate(@NonNull GraphQLRequest<T> graphQlRequest) {\n+    public <R> Single<GraphQLResponse<R>> mutate(@NonNull GraphQLRequest<R> graphQlRequest) {\n         return toSingle((onResult, onError) -> api.mutate(graphQlRequest, onResult, onError));\n     }\n \n"}}, {"oid": "21064d45ffdc71f48050d70508939dc96b0e48d5", "url": "https://github.com/aws-amplify/amplify-android/commit/21064d45ffdc71f48050d70508939dc96b0e48d5", "message": "address initial PR feedback", "committedDate": "2020-05-22T21:07:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMDc0NQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429430745", "bodyText": "So long as it gets caught internally and then composed into an ApiException, this is probably good", "author": "jamesonwilliams", "createdAt": "2020-05-22T19:59:17Z", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -237,10 +235,9 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new InvalidGraphQLRequestRuntimeException(", "originalCommit": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "21064d45ffdc71f48050d70508939dc96b0e48d5", "chunk": "diff --git a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\nindex 2f6d72ce..d0667279 100644\n--- a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n+++ b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n\n@@ -235,7 +235,7 @@ final class AppSyncGraphQLRequestFactory {\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new InvalidGraphQLRequestRuntimeException(\n+            throw new IllegalStateException(\n                     \"Could not generate a schema for the specified class\",\n                     exception\n             );\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMTAzNQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429431035", "bodyText": "By the time you reference this as Outer.Inner, it\u2019ll be quite long. Can we shorten the expression of this exception, somehow?", "author": "jamesonwilliams", "createdAt": "2020-05-22T20:00:21Z", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -468,4 +458,17 @@ private static String getModelFields(Class<? extends Model> clazz, int levelsDee\n \n         return result.toString();\n     }\n+\n+    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {", "originalCommit": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ3NjIwOQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429476209", "bodyText": "I changed this to use IllegalStateException. I talked to @TrekSoft about this offline and the idea here is that those methods should only throw errors in case there's a problem with the ode during development time. Only a faulty ModelSchema will result in that code throwing an error which means either the CLI generated something wrong, that although it compiles, our code is not prepare to handle (a bug) or customers changed their models manually and produced something invalid (highly unlikely, can't think of a real scenario here).\nTherefore, I think it's fair to have a RuntimeException here, no app user input can really result in a failure, at least not in this layer of the logic.", "author": "drochetti", "createdAt": "2020-05-22T22:15:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMTAzNQ=="}], "type": "inlineReview", "revised_code": {"commit": "21064d45ffdc71f48050d70508939dc96b0e48d5", "chunk": "diff --git a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\nindex 2f6d72ce..d0667279 100644\n--- a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n+++ b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n\n@@ -458,17 +458,4 @@ final class AppSyncGraphQLRequestFactory {\n \n         return result.toString();\n     }\n-\n-    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {\n-\n-        private static final long serialVersionUID = 1L;\n-\n-        InvalidGraphQLRequestRuntimeException(final String message, final Exception rootCause) {\n-            super(message + \"\\n\" + AmplifyException.REPORT_BUG_TO_AWS_SUGGESTION, rootCause);\n-        }\n-\n-        InvalidGraphQLRequestRuntimeException(final String message) {\n-            this(message + \"\\n\" + AmplifyException.REPORT_BUG_TO_AWS_SUGGESTION, null);\n-        }\n-    }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MDg4MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429450880", "bodyText": "ModelQuery is a good name, based on what the class does.\nHowever, when a customer uses it, they might prefer to write like:\napi.query(Where.modelClass(BlogOwner.class), ..., ...)\n\nor something like what we did for the QueryOptions.\nMaybe just,\napi.query(Models.ofType(BlogOwner.class)\n\nThat way we at least have a separate Models.java to put factory methods into, that know about <T extends Model> (I forget where it landed, but Where doesn't know about <T extends Model>, right?", "author": "jamesonwilliams", "createdAt": "2020-05-22T21:05:00Z", "path": "aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java", "diffHunk": "@@ -145,7 +143,7 @@ public void graphQlQueryRendersValidResponse() throws ApiException {\n \n         GraphQLResponse<Iterable<BlogOwner>> actualResponse =\n             Await.<GraphQLResponse<Iterable<BlogOwner>>, ApiException>result(((onResult, onError) ->\n-                plugin.query(BlogOwner.class, onResult, onError)\n+                plugin.query(ModelQuery.list(BlogOwner.class), onResult, onError)", "originalCommit": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ3NTU1MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429475550", "bodyText": "I think there's a difference here between that solution in DataStore and this one in API. Here we're not trying to hide the fact that it's GraphQL behind the scenes. Actually Amplify.API.mutate() and Amplify.API.query() makes that very explicit.\nTherefore, the factory methods here resemble the GraphQL statements:\nModelQuery.get(Todo.class) is query getTodo()\nModelMutation.create(todo) is mutation createTodo({})\netc\nWith static imports the syntax becomes even closer:\nAmplify.API.query(get(Todo.class)); // query getTodo()\nAmplify.API.mutate(update(todo)); // mutation updateTodo()\nThe PR description in the iOS repo also gives an idea of the experience there and how this Android builders were design to follow that same path: aws-amplify/amplify-ios#470", "author": "drochetti", "createdAt": "2020-05-22T22:12:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MDg4MA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MTU3MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429451570", "bodyText": "Can you remove the full qualification here, by adding an import for it?", "author": "jamesonwilliams", "createdAt": "2020-05-22T21:07:31Z", "path": "aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java", "diffHunk": "@@ -159,7 +157,7 @@ public void graphQlQueryRendersValidResponse() throws ApiException {\n \n     /**\n      * It should be possible to perform a successful call to\n-     * {@link AWSApiPlugin#mutate(Model, MutationType, Consumer, Consumer)}.\n+     * {@link AWSApiPlugin#mutate(com.amplifyframework.api.graphql.GraphQLRequest, Consumer, Consumer)}.", "originalCommit": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8765666f6d8e6932d4f439dbed4cf7cc5096828d", "chunk": "diff --git a/aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java b/aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java\nindex 9f73505e..852ecbdc 100644\n--- a/aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java\n+++ b/aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java\n\n@@ -157,7 +160,7 @@ public final class AWSApiPluginTest {\n \n     /**\n      * It should be possible to perform a successful call to\n-     * {@link AWSApiPlugin#mutate(com.amplifyframework.api.graphql.GraphQLRequest, Consumer, Consumer)}.\n+     * {@link AWSApiPlugin#mutate(GraphQLRequest, Consumer, Consumer)}.\n      * When the server returns a valid response, then the mutate methods should\n      * emit content via their value consumer.\n      * @throws ApiException If call to mutate(...) itself emits such an exception\n"}}, {"oid": "862581a9fe7637476b29915cfaa37dc0ce7fab87", "url": "https://github.com/aws-amplify/amplify-android/commit/862581a9fe7637476b29915cfaa37dc0ce7fab87", "message": "move the model-based builders to core.model.graphql package", "committedDate": "2020-05-22T21:49:18Z", "type": "commit"}, {"oid": "de881cd4fee3b6d0f93d269f94e706771f9809ef", "url": "https://github.com/aws-amplify/amplify-android/commit/de881cd4fee3b6d0f93d269f94e706771f9809ef", "message": "fix checkstyle violations", "committedDate": "2020-05-22T22:05:58Z", "type": "commit"}, {"oid": "60bbb6befac90e30ffe0287fa7829c9b250d18cc", "url": "https://github.com/aws-amplify/amplify-android/commit/60bbb6befac90e30ffe0287fa7829c9b250d18cc", "message": "more checkstyle and lgtm violations fixed", "committedDate": "2020-05-22T22:24:14Z", "type": "commit"}, {"oid": "f112e0dc57e72a54b80d06bd9024b481df2c9b0d", "url": "https://github.com/aws-amplify/amplify-android/commit/f112e0dc57e72a54b80d06bd9024b481df2c9b0d", "message": "fix rxbindings tests", "committedDate": "2020-05-22T23:10:59Z", "type": "commit"}, {"oid": "b5dd32d9483240e584563bd49b5e2f79c3745a31", "url": "https://github.com/aws-amplify/amplify-android/commit/b5dd32d9483240e584563bd49b5e2f79c3745a31", "message": "add ModelMutation docs", "committedDate": "2020-05-22T23:29:12Z", "type": "commit"}, {"oid": "32123080c800bf0cd23ab3055aef69862ffcfce9", "url": "https://github.com/aws-amplify/amplify-android/commit/32123080c800bf0cd23ab3055aef69862ffcfce9", "message": "fix testutils dependency and move model+graphql integration", "committedDate": "2020-05-22T23:37:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ5MDcwNw==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429490707", "bodyText": "Hmm..\nR represents the data on a GraphQLResponse\nT represents the Model type (or actually it looks like you've renamed most of these to M in this PR, which makes more sense than T anyway.\nSo, this should either return a GraphQLRequest<R> or a GraphQLRequest<Iterable<T>>, NOT a GraphQLRequest<Iterable<R>>", "author": "richardmcclellan", "createdAt": "2020-05-22T23:44:36Z", "path": "rxbindings/src/test/java/com/amplifyframework/rx/RxApiBindingTest.java", "diffHunk": "@@ -381,4 +378,16 @@ public void httpPostEmitsResult() {\n         verify(delegate)\n             .post(eq(options), anyConsumer(), anyConsumer());\n     }\n+\n+    private static <R> GraphQLRequest<R> createMockMutationRequest(Class<R> responseType) {\n+        return new GraphQLRequest<R>(\"\", responseType, null);\n+    }\n+\n+    private static <R> GraphQLRequest<Iterable<R>> createMockListRequest(Class<R> responseType) {", "originalCommit": "f112e0dc57e72a54b80d06bd9024b481df2c9b0d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ5NDcxNw==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429494717", "bodyText": "updated everything here to T", "author": "drochetti", "createdAt": "2020-05-23T00:13:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ5MDcwNw=="}], "type": "inlineReview", "revised_code": {"commit": "5147c0949f790b60af8e550303eaa10f15e6895a", "chunk": "diff --git a/rxbindings/src/test/java/com/amplifyframework/rx/RxApiBindingTest.java b/rxbindings/src/test/java/com/amplifyframework/rx/RxApiBindingTest.java\nindex e4237707..a0d5918a 100644\n--- a/rxbindings/src/test/java/com/amplifyframework/rx/RxApiBindingTest.java\n+++ b/rxbindings/src/test/java/com/amplifyframework/rx/RxApiBindingTest.java\n\n@@ -379,15 +379,15 @@ public final class RxApiBindingTest {\n             .post(eq(options), anyConsumer(), anyConsumer());\n     }\n \n-    private static <R> GraphQLRequest<R> createMockMutationRequest(Class<R> responseType) {\n-        return new GraphQLRequest<R>(\"\", responseType, null);\n+    private static <T> GraphQLRequest<T> createMockMutationRequest(Class<T> responseType) {\n+        return new GraphQLRequest<>(\"\", responseType, null);\n     }\n \n-    private static <R> GraphQLRequest<Iterable<R>> createMockListRequest(Class<R> responseType) {\n-        return new GraphQLRequest<Iterable<R>>(\"\", responseType, null);\n+    private static <T> GraphQLRequest<Iterable<T>> createMockListRequest(Class<T> responseType) {\n+        return new GraphQLRequest<>(\"\", responseType, null);\n     }\n \n-    private static <R> GraphQLRequest<R> createMockSubscriptionRequest(Class<R> responseType) {\n-        return new GraphQLRequest<R>(\"\", responseType, null);\n+    private static <T> GraphQLRequest<T> createMockSubscriptionRequest(Class<T> responseType) {\n+        return new GraphQLRequest<>(\"\", responseType, null);\n     }\n }\n"}}, {"oid": "410037a2ab395c15965cf490b0460ff364f8f220", "url": "https://github.com/aws-amplify/amplify-android/commit/410037a2ab395c15965cf490b0460ff364f8f220", "message": "add more javadoc\n\nps: adding javadoc to getters/setters is a delightful experience.", "committedDate": "2020-05-22T23:50:18Z", "type": "commit"}, {"oid": "5147c0949f790b60af8e550303eaa10f15e6895a", "url": "https://github.com/aws-amplify/amplify-android/commit/5147c0949f790b60af8e550303eaa10f15e6895a", "message": "fix parameter naming", "committedDate": "2020-05-22T23:59:14Z", "type": "commit"}, {"oid": "12df073aef71222660cc85b744a0de7b1a5bbbac", "url": "https://github.com/aws-amplify/amplify-android/commit/12df073aef71222660cc85b744a0de7b1a5bbbac", "message": "add ModelQuery javadoc", "committedDate": "2020-05-23T00:11:56Z", "type": "commit"}, {"oid": "7bd3414b94de545aedee3388f7f5b27f29047795", "url": "https://github.com/aws-amplify/amplify-android/commit/7bd3414b94de545aedee3388f7f5b27f29047795", "message": "add ModelSubscription javadoc", "committedDate": "2020-05-23T00:23:57Z", "type": "commit"}, {"oid": "95d0c59e9337045055c9f46c8a8c54e86b8b6561", "url": "https://github.com/aws-amplify/amplify-android/commit/95d0c59e9337045055c9f46c8a8c54e86b8b6561", "message": "add javadoc to the appsync graphql request factory", "committedDate": "2020-05-23T00:51:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwMDg2MQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429500861", "bodyText": "Instead of all of these, you can do:\n@SuppressWarnings(\"checkstyle:MissingJavadocMethod\")\n\nOn top of the class definition. This will disable the check for the entire class.\nOf rouse, better would be to write the docs. But, the suppression is still better than the not-filled-in stuff, I think.", "author": "jamesonwilliams", "createdAt": "2020-05-23T01:13:44Z", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -160,20 +186,29 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new IllegalStateException(\n                     \"Could not generate a schema for the specified class\",\n-                    exception,\n-                    \"Check the included exception for more details\"\n+                    exception\n             );\n         }\n     }\n \n+    /**", "originalCommit": "7bd3414b94de545aedee3388f7f5b27f29047795", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwMzg4NQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429503885", "bodyText": "I added the docs. Most of them are very similar to the ones in ModelQuery/ModelMutation/ModelSubscription", "author": "drochetti", "createdAt": "2020-05-23T01:52:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwMDg2MQ=="}], "type": "inlineReview", "revised_code": {"commit": "8765666f6d8e6932d4f439dbed4cf7cc5096828d", "chunk": "diff --git a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\nindex 989bed56..cf9f7b3d 100644\n--- a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n+++ b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n\n@@ -194,14 +206,15 @@ public final class AppSyncGraphQLRequestFactory {\n     }\n \n     /**\n-     * TODO.\n-     * @param model todo.\n-     * @param predicate todo.\n-     * @param type todo.\n-     * @param <R> todo.\n-     * @param <T> todo.\n-     * @return todo.\n-     * @throws IllegalStateException todo.\n+     * Creates a {@link GraphQLRequest} that represents a mutation of a given type.\n+     *\n+     * @param model the model instance.\n+     * @param predicate the model predicate.\n+     * @param type the mutation type.\n+     * @param <R> the response type.\n+     * @param <T> the concrete model type.\n+     * @return a valid {@link GraphQLRequest} instance.\n+     * @throws IllegalStateException when the model schema does not contain the expected information.\n      */\n     @SuppressWarnings(\"unchecked\")\n     public static <R, T extends Model> GraphQLRequest<R> buildMutation(\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwNTM2OQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429505369", "bodyText": "correct correct => correct", "author": "jamesonwilliams", "createdAt": "2020-05-23T02:13:49Z", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -65,13 +65,16 @@\n     private AppSyncGraphQLRequestFactory() { }\n \n     /**\n-     * TODO.\n-     * @param modelClass todo.\n-     * @param objectId todo.\n-     * @param <R> todo.\n-     * @param <T> todo.\n-     * @return todo.\n-     * @throws IllegalStateException todo.\n+     * Creates a {@link GraphQLRequest} that represents a query that expects a single value as a result.\n+     * The request will be created with the correct correct document based on the model schema and", "originalCommit": "95d0c59e9337045055c9f46c8a8c54e86b8b6561", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8765666f6d8e6932d4f439dbed4cf7cc5096828d", "chunk": "diff --git a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\nindex 93af0af3..cf9f7b3d 100644\n--- a/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n+++ b/aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java\n\n@@ -66,7 +66,7 @@ public final class AppSyncGraphQLRequestFactory {\n \n     /**\n      * Creates a {@link GraphQLRequest} that represents a query that expects a single value as a result.\n-     * The request will be created with the correct correct document based on the model schema and\n+     * The request will be created with the correct document based on the model schema and\n      * variables based on given {@code objectId}.\n      *\n      * @param modelClass the model class.\n"}}, {"oid": "8765666f6d8e6932d4f439dbed4cf7cc5096828d", "url": "https://github.com/aws-amplify/amplify-android/commit/8765666f6d8e6932d4f439dbed4cf7cc5096828d", "message": "minor fixes", "committedDate": "2020-05-23T02:58:08Z", "type": "commit"}]}