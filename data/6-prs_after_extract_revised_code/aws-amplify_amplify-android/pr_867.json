{"pr_number": 867, "pr_title": "chore(api) remove JAVA_DATE since codegen does not generate java.lang.Date", "pr_createdAt": "2020-09-28T20:31:01Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/867", "timeline": [{"oid": "e997933e5450bb9c6f7ba4997e592026a1e625c5", "url": "https://github.com/aws-amplify/amplify-android/commit/e997933e5450bb9c6f7ba4997e592026a1e625c5", "message": "chore(api) remove JAVA_DATE since this is not a type that codegen will ever translate", "committedDate": "2020-09-28T20:05:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjIxNjg2OQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/867#discussion_r496216869", "bodyText": "This is a bit of a hack because I cannot reference Temporal.Date.class from here, since it is in the aws-api-appsync module, which I can't reference from core, so I have to get it using reflection.   A better solution for another day could be to move ModelSchema (and other related Model classes) from core to aws-api-appsync.\nPreviously, this test was only passing by coincidence - it was comparing java.lang.Date.class.getSimpleName() with the Temporal.Date.class.getSimpleName(), and it passed since they are equal.  Now that we are comparing the actual class, this test started failing (as it should), so this needs to be updated to actually reference the correct Class.", "author": "richardmcclellan", "createdAt": "2020-09-28T20:36:03Z", "path": "core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java", "diffHunk": "@@ -70,7 +70,7 @@ public void modelSchemaIsGeneratedForPersonModel() throws AmplifyException {\n         expectedFields.put(\"dob\", ModelField.builder()\n             .targetType(\"AWSDate\")\n             .name(\"dob\")\n-            .type(Date.class)\n+            .type(Class.forName(\"com.amplifyframework.core.model.temporal.Temporal$Date\"))", "originalCommit": "e997933e5450bb9c6f7ba4997e592026a1e625c5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjI4Mzc2OA==", "url": "https://github.com/aws-amplify/amplify-android/pull/867#discussion_r496283768", "bodyText": "aws-api-appsync module, which I can't reference from core\n\nCertainly not from src code. But what about as a testImplementation?\nYou could also access it through the testutils module, perhaps -- an additional level of indirection?", "author": "jamesonwilliams", "createdAt": "2020-09-28T23:07:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjIxNjg2OQ=="}], "type": "inlineReview", "revised_code": {"commit": "2ddb854b1f228aac7507af4f307825ee3b80b986", "chunk": "diff --git a/core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java b/core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java\nindex d2c828b5..29152147 100644\n--- a/core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java\n+++ b/core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java\n\n@@ -70,7 +71,7 @@ public final class ModelSchemaTest {\n         expectedFields.put(\"dob\", ModelField.builder()\n             .targetType(\"AWSDate\")\n             .name(\"dob\")\n-            .type(Class.forName(\"com.amplifyframework.core.model.temporal.Temporal$Date\"))\n+            .type(Temporal.Date.class)\n             .build());\n         expectedFields.put(\"age\", ModelField.builder()\n             .targetType(\"Int\")\n"}}, {"oid": "2ddb854b1f228aac7507af4f307825ee3b80b986", "url": "https://github.com/aws-amplify/amplify-android/commit/2ddb854b1f228aac7507af4f307825ee3b80b986", "message": "Avoid reflection by adding testImplementation dependency on aws-api-appsync", "committedDate": "2020-10-02T16:07:58Z", "type": "commit"}, {"oid": "42e8b380ec35e0dcd0ad87c01a8e60e20012ae9e", "url": "https://github.com/aws-amplify/amplify-android/commit/42e8b380ec35e0dcd0ad87c01a8e60e20012ae9e", "message": "Merge branch 'main' into rm/remove-java-date", "committedDate": "2020-10-02T17:59:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk2ODU3MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/867#discussion_r498968570", "bodyText": "The ClassNotFoundException has gone away now, too.", "author": "jamesonwilliams", "createdAt": "2020-10-02T17:58:39Z", "path": "core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java", "diffHunk": "@@ -45,9 +45,10 @@\n      * The factory {@link ModelSchema#fromModelClass(Class)} will produce\n      * an {@link ModelSchema} that meets our expectations for the {@link Person} model.\n      * @throws AmplifyException from model schema parsing\n+     * @throws ClassNotFoundException from Class.forName(\"com.amplifyframework.core.model.temporal.Temporal$Date\")\n      */\n     @Test\n-    public void modelSchemaIsGeneratedForPersonModel() throws AmplifyException {\n+    public void modelSchemaIsGeneratedForPersonModel() throws AmplifyException, ClassNotFoundException {", "originalCommit": "2ddb854b1f228aac7507af4f307825ee3b80b986", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk2OTg0Mg==", "url": "https://github.com/aws-amplify/amplify-android/pull/867#discussion_r498969842", "bodyText": "Just fixed!", "author": "richardmcclellan", "createdAt": "2020-10-02T18:01:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk2ODU3MA=="}], "type": "inlineReview", "revised_code": {"commit": "0b40fcbc03ec8d8df55af3e12fef4d0cc5932c93", "chunk": "diff --git a/core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java b/core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java\nindex 29152147..de25ea75 100644\n--- a/core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java\n+++ b/core/src/test/java/com/amplifyframework/core/model/ModelSchemaTest.java\n\n@@ -45,10 +45,9 @@ public final class ModelSchemaTest {\n      * The factory {@link ModelSchema#fromModelClass(Class)} will produce\n      * an {@link ModelSchema} that meets our expectations for the {@link Person} model.\n      * @throws AmplifyException from model schema parsing\n-     * @throws ClassNotFoundException from Class.forName(\"com.amplifyframework.core.model.temporal.Temporal$Date\")\n      */\n     @Test\n-    public void modelSchemaIsGeneratedForPersonModel() throws AmplifyException, ClassNotFoundException {\n+    public void modelSchemaIsGeneratedForPersonModel() throws AmplifyException {\n         Map<String, ModelField> expectedFields = new HashMap<>();\n         expectedFields.put(\"id\", ModelField.builder()\n             .targetType(\"ID\")\n"}}, {"oid": "0b40fcbc03ec8d8df55af3e12fef4d0cc5932c93", "url": "https://github.com/aws-amplify/amplify-android/commit/0b40fcbc03ec8d8df55af3e12fef4d0cc5932c93", "message": "Remove ClassNotFoundException", "committedDate": "2020-10-02T18:00:58Z", "type": "commit"}]}