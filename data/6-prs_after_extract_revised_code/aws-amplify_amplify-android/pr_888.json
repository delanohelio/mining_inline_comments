{"pr_number": 888, "pr_title": "(fix) Fail early and throw useful exception if customer forgets to call Amplify.configure", "pr_createdAt": "2020-10-07T17:18:42Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/888", "timeline": [{"oid": "a27631d1639251586e853ad70524e6b4897154e4", "url": "https://github.com/aws-amplify/amplify-android/commit/a27631d1639251586e853ad70524e6b4897154e4", "message": "(fix) Fail early and throw useful exception if customer forgets to call Amplify.configure", "committedDate": "2020-10-07T15:40:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyODk0NQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/888#discussion_r501328945", "bodyText": "Suggested change", "author": "richardmcclellan", "createdAt": "2020-10-07T21:47:25Z", "path": "aws-datastore/src/test/java/com/amplifyframework/datastore/AWSDataStorePluginTest.java", "diffHunk": "@@ -323,6 +324,7 @@ private void assertSyncProcessorNotStarted(ApiCategory mockApi) {\n     private ApiCategory mockApiCategoryWithGraphQlApi() throws AmplifyException {\n         ApiCategory mockApiCategory = spy(ApiCategory.class);\n         ApiPlugin<?> mockApiPlugin = mock(ApiPlugin.class);\n+", "originalCommit": "a27631d1639251586e853ad70524e6b4897154e4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e8a6e1cc18fc0e663e585f0591d03587ff849880", "chunk": "diff --git a/aws-datastore/src/test/java/com/amplifyframework/datastore/AWSDataStorePluginTest.java b/aws-datastore/src/test/java/com/amplifyframework/datastore/AWSDataStorePluginTest.java\nindex 5e28a63e..8b6f74f8 100644\n--- a/aws-datastore/src/test/java/com/amplifyframework/datastore/AWSDataStorePluginTest.java\n+++ b/aws-datastore/src/test/java/com/amplifyframework/datastore/AWSDataStorePluginTest.java\n\n@@ -324,7 +324,6 @@ public final class AWSDataStorePluginTest {\n     private ApiCategory mockApiCategoryWithGraphQlApi() throws AmplifyException {\n         ApiCategory mockApiCategory = spy(ApiCategory.class);\n         ApiPlugin<?> mockApiPlugin = mock(ApiPlugin.class);\n-\n         when(mockApiPlugin.getPluginKey()).thenReturn(MOCK_API_PLUGIN_NAME);\n         when(mockApiPlugin.getCategoryType()).thenReturn(CategoryType.API);\n \n"}}, {"oid": "e8a6e1cc18fc0e663e585f0591d03587ff849880", "url": "https://github.com/aws-amplify/amplify-android/commit/e8a6e1cc18fc0e663e585f0591d03587ff849880", "message": "Update aws-datastore/src/test/java/com/amplifyframework/datastore/AWSDataStorePluginTest.java", "committedDate": "2020-10-07T21:47:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyOTAzNQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/888#discussion_r501329035", "bodyText": "Suggested change", "author": "richardmcclellan", "createdAt": "2020-10-07T21:47:38Z", "path": "aws-auth-cognito/src/test/java/com/amplifyframework/auth/cognito/AuthComponentTest.java", "diffHunk": "@@ -1124,6 +1081,7 @@ public void signedInSessionWithExpiredTokens() throws AuthException {\n     @Test\n     public void getCurrentUser() {\n         doAnswer(invocation -> USERNAME).when(mobileClient).getUsername();\n+", "originalCommit": "e8a6e1cc18fc0e663e585f0591d03587ff849880", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e4969657434073b8fa87bdc1da3c1429a0206b66", "chunk": "diff --git a/aws-auth-cognito/src/test/java/com/amplifyframework/auth/cognito/AuthComponentTest.java b/aws-auth-cognito/src/test/java/com/amplifyframework/auth/cognito/AuthComponentTest.java\nindex 7b1d02f2..55923c24 100644\n--- a/aws-auth-cognito/src/test/java/com/amplifyframework/auth/cognito/AuthComponentTest.java\n+++ b/aws-auth-cognito/src/test/java/com/amplifyframework/auth/cognito/AuthComponentTest.java\n\n@@ -1081,7 +1081,6 @@ public final class AuthComponentTest {\n     @Test\n     public void getCurrentUser() {\n         doAnswer(invocation -> USERNAME).when(mobileClient).getUsername();\n-\n         AuthUser user = authCategory.getCurrentUser();\n \n         assertEquals(USER_SUB, user.getUserId());\n"}}, {"oid": "e4969657434073b8fa87bdc1da3c1429a0206b66", "url": "https://github.com/aws-amplify/amplify-android/commit/e4969657434073b8fa87bdc1da3c1429a0206b66", "message": "Update aws-auth-cognito/src/test/java/com/amplifyframework/auth/cognito/AuthComponentTest.java", "committedDate": "2020-10-07T21:47:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyOTM0NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/888#discussion_r501329344", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                \"Tried to get a plugin but that plugin was not present. \" +\n          \n          \n            \n                            \"Tried to get a plugin but that plugin was not present. \" +", "author": "richardmcclellan", "createdAt": "2020-10-07T21:48:24Z", "path": "core/src/main/java/com/amplifyframework/core/category/Category.java", "diffHunk": "@@ -172,18 +174,21 @@ public final void removePlugin(@NonNull P plugin) {\n      * Retrieve a plugin by its key.\n      * @param pluginKey A key that identifies a plugin implementation\n      * @return The plugin object associated to pluginKey, if registered\n-     * @throws IllegalStateException If the requested plugin does not exist\n+     * @throws IllegalStateException If the requested plugin does not exist, or has not been configured.\n      */\n     @NonNull\n     public final P getPlugin(@NonNull final String pluginKey) throws IllegalStateException {\n         P plugin = plugins.get(pluginKey);\n-        if (plugin != null) {\n-            return plugin;\n-        } else {\n+        if (plugin == null) {\n             throw new IllegalStateException(\n-                \"Tried to get a plugin but that plugin was not present. \" +\n-                \"Check if the plugin was added originally or perhaps was already removed.\"\n+                    \"Tried to get a plugin but that plugin was not present. \" +", "originalCommit": "e4969657434073b8fa87bdc1da3c1429a0206b66", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4d09d7fa1ccf5a05e98e7570a934ae35eed1dd43", "chunk": "diff --git a/core/src/main/java/com/amplifyframework/core/category/Category.java b/core/src/main/java/com/amplifyframework/core/category/Category.java\nindex 75e8ff5b..789d1f0e 100644\n--- a/core/src/main/java/com/amplifyframework/core/category/Category.java\n+++ b/core/src/main/java/com/amplifyframework/core/category/Category.java\n\n@@ -181,7 +181,7 @@ public abstract class Category<P extends Plugin<?>> implements CategoryTypeable\n         P plugin = plugins.get(pluginKey);\n         if (plugin == null) {\n             throw new IllegalStateException(\n-                    \"Tried to get a plugin but that plugin was not present. \" +\n+                \"Tried to get a plugin but that plugin was not present. \" +\n                             \"Check if the plugin was added originally or perhaps was already removed.\"\n             );\n         } else if (!isConfigured()) {\n"}}, {"oid": "4d09d7fa1ccf5a05e98e7570a934ae35eed1dd43", "url": "https://github.com/aws-amplify/amplify-android/commit/4d09d7fa1ccf5a05e98e7570a934ae35eed1dd43", "message": "Update core/src/main/java/com/amplifyframework/core/category/Category.java", "committedDate": "2020-10-07T21:48:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyOTQ2NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/888#discussion_r501329464", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        \"Check if the plugin was added originally or perhaps was already removed.\"\n          \n          \n            \n                                \"Check if the plugin was added originally or perhaps was already removed.\"", "author": "richardmcclellan", "createdAt": "2020-10-07T21:48:43Z", "path": "core/src/main/java/com/amplifyframework/core/category/Category.java", "diffHunk": "@@ -172,18 +174,21 @@ public final void removePlugin(@NonNull P plugin) {\n      * Retrieve a plugin by its key.\n      * @param pluginKey A key that identifies a plugin implementation\n      * @return The plugin object associated to pluginKey, if registered\n-     * @throws IllegalStateException If the requested plugin does not exist\n+     * @throws IllegalStateException If the requested plugin does not exist, or has not been configured.\n      */\n     @NonNull\n     public final P getPlugin(@NonNull final String pluginKey) throws IllegalStateException {\n         P plugin = plugins.get(pluginKey);\n-        if (plugin != null) {\n-            return plugin;\n-        } else {\n+        if (plugin == null) {\n             throw new IllegalStateException(\n                 \"Tried to get a plugin but that plugin was not present. \" +\n-                \"Check if the plugin was added originally or perhaps was already removed.\"\n+                            \"Check if the plugin was added originally or perhaps was already removed.\"", "originalCommit": "4d09d7fa1ccf5a05e98e7570a934ae35eed1dd43", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "906fd31557f3e3e5211925a6d5918af633be1a45", "chunk": "diff --git a/core/src/main/java/com/amplifyframework/core/category/Category.java b/core/src/main/java/com/amplifyframework/core/category/Category.java\nindex 789d1f0e..5ae9bb98 100644\n--- a/core/src/main/java/com/amplifyframework/core/category/Category.java\n+++ b/core/src/main/java/com/amplifyframework/core/category/Category.java\n\n@@ -182,7 +182,7 @@ public abstract class Category<P extends Plugin<?>> implements CategoryTypeable\n         if (plugin == null) {\n             throw new IllegalStateException(\n                 \"Tried to get a plugin but that plugin was not present. \" +\n-                            \"Check if the plugin was added originally or perhaps was already removed.\"\n+                    \"Check if the plugin was added originally or perhaps was already removed.\"\n             );\n         } else if (!isConfigured()) {\n             throw new IllegalStateException(\n"}}, {"oid": "906fd31557f3e3e5211925a6d5918af633be1a45", "url": "https://github.com/aws-amplify/amplify-android/commit/906fd31557f3e3e5211925a6d5918af633be1a45", "message": "Update core/src/main/java/com/amplifyframework/core/category/Category.java", "committedDate": "2020-10-07T21:48:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyOTU2NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/888#discussion_r501329564", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                \"Check if the plugin was added originally or perhaps was already removed.\"\n          \n          \n            \n                            \"Check if the plugin was added originally or perhaps was already removed.\"", "author": "richardmcclellan", "createdAt": "2020-10-07T21:48:59Z", "path": "core/src/main/java/com/amplifyframework/core/category/Category.java", "diffHunk": "@@ -172,18 +174,21 @@ public final void removePlugin(@NonNull P plugin) {\n      * Retrieve a plugin by its key.\n      * @param pluginKey A key that identifies a plugin implementation\n      * @return The plugin object associated to pluginKey, if registered\n-     * @throws IllegalStateException If the requested plugin does not exist\n+     * @throws IllegalStateException If the requested plugin does not exist, or has not been configured.\n      */\n     @NonNull\n     public final P getPlugin(@NonNull final String pluginKey) throws IllegalStateException {\n         P plugin = plugins.get(pluginKey);\n-        if (plugin != null) {\n-            return plugin;\n-        } else {\n+        if (plugin == null) {\n             throw new IllegalStateException(\n                 \"Tried to get a plugin but that plugin was not present. \" +\n-                \"Check if the plugin was added originally or perhaps was already removed.\"\n+                    \"Check if the plugin was added originally or perhaps was already removed.\"", "originalCommit": "906fd31557f3e3e5211925a6d5918af633be1a45", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "76ce438e82de6d795a2a1b46e109e5b351adf1c9", "chunk": "diff --git a/core/src/main/java/com/amplifyframework/core/category/Category.java b/core/src/main/java/com/amplifyframework/core/category/Category.java\nindex 5ae9bb98..ed87b245 100644\n--- a/core/src/main/java/com/amplifyframework/core/category/Category.java\n+++ b/core/src/main/java/com/amplifyframework/core/category/Category.java\n\n@@ -182,7 +182,7 @@ public abstract class Category<P extends Plugin<?>> implements CategoryTypeable\n         if (plugin == null) {\n             throw new IllegalStateException(\n                 \"Tried to get a plugin but that plugin was not present. \" +\n-                    \"Check if the plugin was added originally or perhaps was already removed.\"\n+                \"Check if the plugin was added originally or perhaps was already removed.\"\n             );\n         } else if (!isConfigured()) {\n             throw new IllegalStateException(\n"}}, {"oid": "76ce438e82de6d795a2a1b46e109e5b351adf1c9", "url": "https://github.com/aws-amplify/amplify-android/commit/76ce438e82de6d795a2a1b46e109e5b351adf1c9", "message": "Update core/src/main/java/com/amplifyframework/core/category/Category.java", "committedDate": "2020-10-07T21:49:02Z", "type": "commit"}]}