{"pr_number": 1030, "pr_title": "feat(Auth): Adds the ability to specify a custom browser for web UI sign in/out", "pr_createdAt": "2020-12-07T20:41:12Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/1030", "timeline": [{"oid": "237a1b794283baccb4cafc0c2a6a09bdac88d5a2", "url": "https://github.com/aws-amplify/amplify-android/commit/237a1b794283baccb4cafc0c2a6a09bdac88d5a2", "message": "Adds the ability to specify a custom browser for web UI sign in/out", "committedDate": "2020-12-07T20:38:33Z", "type": "commit"}, {"oid": "3775200291f52a7408a5a0612edd9f810e6fffec", "url": "https://github.com/aws-amplify/amplify-android/commit/3775200291f52a7408a5a0612edd9f810e6fffec", "message": "Self code review fixes", "committedDate": "2020-12-07T20:50:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgzODM4OQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/1030#discussion_r537838389", "bodyText": "Instead of setting signOutGlobally to false, should we be getting this from the passed in options variable?", "author": "richardmcclellan", "createdAt": "2020-12-07T21:16:02Z", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -962,9 +963,19 @@ public String getVersion() {\n         return BuildConfig.VERSION_NAME;\n     }\n \n-    private void signOutLocally(@NonNull Action onSuccess, @NonNull Consumer<AuthException> onError) {\n+    private void signOutLocally(\n+            @NonNull AuthSignOutOptions options,\n+            @NonNull Action onSuccess,\n+            @NonNull Consumer<AuthException> onError) {\n+        SignOutOptions.Builder signOutOptionsBuilder =\n+                SignOutOptions.builder().signOutGlobally(false).invalidateTokens(true);", "originalCommit": "3775200291f52a7408a5a0612edd9f810e6fffec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgzOTgzOQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/1030#discussion_r537839839", "bodyText": "In short, no per our conversation :)", "author": "TrekSoft", "createdAt": "2020-12-07T21:18:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgzODM4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0MDcyMQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/1030#discussion_r537840721", "bodyText": "For sign out locally (which this helper method is) it needs to be set to false with invalidateTokens set to true. The isGlobalSignOut option is examined in the main method which uses this helper method.", "author": "TrekSoft", "createdAt": "2020-12-07T21:20:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgzODM4OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0NzM2Nw==", "url": "https://github.com/aws-amplify/amplify-android/pull/1030#discussion_r537847367", "bodyText": "\ud83d\udc4d", "author": "richardmcclellan", "createdAt": "2020-12-07T21:31:18Z", "path": "core/src/main/java/com/amplifyframework/auth/options/AuthSignOutOptions.java", "diffHunk": "@@ -26,7 +26,7 @@\n \n     /**\n      * Advanced options for signing up.\n-     * @param globalSignOut Sign out of all devices\n+     * @param globalSignOut Sign out of all devices (do not use when signing out of a WebUI experience)", "originalCommit": "3775200291f52a7408a5a0612edd9f810e6fffec", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg5NzIwNw==", "url": "https://github.com/aws-amplify/amplify-android/pull/1030#discussion_r537897207", "bodyText": "Richard added a VoidResult sentinel object that could be used here", "author": "jamesonwilliams", "createdAt": "2020-12-07T22:58:24Z", "path": "testutils/src/main/java/com/amplifyframework/testutils/sync/SynchronousAuth.java", "diffHunk": "@@ -392,4 +393,19 @@ public void signOut() throws AuthException {\n                 )\n         );\n     }\n+\n+    /**\n+     * Sign out synchronously with options.\n+     * @param options Advanced options for signing out\n+     * @throws AuthException exception\n+     */\n+    public void signOut(AuthSignOutOptions options) throws AuthException {\n+        Await.<Object, AuthException>result(AUTH_OPERATION_TIMEOUT_MS, (onResult, onError) ->\n+                asyncDelegate.signOut(\n+                    options,\n+                    () -> onResult.accept(new Object()),", "originalCommit": "3775200291f52a7408a5a0612edd9f810e6fffec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzkwMjUyMQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/1030#discussion_r537902521", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                () -> onResult.accept(new Object()),\n          \n          \n            \n                                () -> onResult.accept(VoidResult.instance()),", "author": "richardmcclellan", "createdAt": "2020-12-07T23:09:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg5NzIwNw=="}], "type": "inlineReview", "revised_code": {"commit": "aaecb4109a70a3190dfee67581a547e60f2baab7", "chunk": "diff --git a/testutils/src/main/java/com/amplifyframework/testutils/sync/SynchronousAuth.java b/testutils/src/main/java/com/amplifyframework/testutils/sync/SynchronousAuth.java\nindex c17143b9..7e5e9178 100644\n--- a/testutils/src/main/java/com/amplifyframework/testutils/sync/SynchronousAuth.java\n+++ b/testutils/src/main/java/com/amplifyframework/testutils/sync/SynchronousAuth.java\n\n@@ -388,7 +390,7 @@ public final class SynchronousAuth {\n     public void signOut() throws AuthException {\n         Await.<Object, AuthException>result(AUTH_OPERATION_TIMEOUT_MS, (onResult, onError) ->\n                 asyncDelegate.signOut(\n-                    () -> onResult.accept(new Object()),\n+                    () -> onResult.accept(VoidResult.instance()),\n                     onError\n                 )\n         );\n"}}, {"oid": "aaecb4109a70a3190dfee67581a547e60f2baab7", "url": "https://github.com/aws-amplify/amplify-android/commit/aaecb4109a70a3190dfee67581a547e60f2baab7", "message": "VoidResult.instance() instead of new Object()", "committedDate": "2020-12-08T15:30:26Z", "type": "commit"}, {"oid": "aaecb4109a70a3190dfee67581a547e60f2baab7", "url": "https://github.com/aws-amplify/amplify-android/commit/aaecb4109a70a3190dfee67581a547e60f2baab7", "message": "VoidResult.instance() instead of new Object()", "committedDate": "2020-12-08T15:30:26Z", "type": "forcePushed"}]}