{"pr_number": 494, "pr_title": "[aws-datastore] Consider the model version before merging", "pr_createdAt": "2020-05-20T08:18:31Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/494", "timeline": [{"oid": "39e58d4fbc750a561ca74da7e73694400de613f9", "url": "https://github.com/aws-amplify/amplify-android/commit/39e58d4fbc750a561ca74da7e73694400de613f9", "message": "[aws-datastore] Consider the model version before merging\n\nUpon merging a model from sync, mutation response, subscription data,\ninspect the model version. If the version is equal to or less than the\ncurrent version in the system, refuse to merge.", "committedDate": "2020-05-20T09:09:33Z", "type": "commit"}, {"oid": "39e58d4fbc750a561ca74da7e73694400de613f9", "url": "https://github.com/aws-amplify/amplify-android/commit/39e58d4fbc750a561ca74da7e73694400de613f9", "message": "[aws-datastore] Consider the model version before merging\n\nUpon merging a model from sync, mutation response, subscription data,\ninspect the model version. If the version is equal to or less than the\ncurrent version in the system, refuse to merge.", "committedDate": "2020-05-20T09:09:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzk2MzMxNA==", "url": "https://github.com/aws-amplify/amplify-android/pull/494#discussion_r427963314", "bodyText": "This comment doesn't square with the commented out code.", "author": "jpignata", "createdAt": "2020-05-20T12:20:15Z", "path": "aws-datastore/src/test/java/com/amplifyframework/datastore/syncengine/MergerTest.java", "diffHunk": "@@ -139,7 +138,7 @@ public void mergeSaveForNotExistingItem() throws DataStoreException {\n             .build();\n         ModelMetadata metadata = new ModelMetadata(blogOwner.getId(), false, 1, Time.now());\n         // Note that putInStore is NOT called!", "originalCommit": "39e58d4fbc750a561ca74da7e73694400de613f9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODEzNzAxMQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/494#discussion_r428137011", "bodyText": "Will fix!", "author": "jamesonwilliams", "createdAt": "2020-05-20T16:13:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzk2MzMxNA=="}], "type": "inlineReview", "revised_code": {"commit": "68ad70313974bc3e76cbbc6927c22147a2a18336", "chunk": "diff --git a/aws-datastore/src/test/java/com/amplifyframework/datastore/syncengine/MergerTest.java b/aws-datastore/src/test/java/com/amplifyframework/datastore/syncengine/MergerTest.java\nindex e3864ead..2d9bd78b 100644\n--- a/aws-datastore/src/test/java/com/amplifyframework/datastore/syncengine/MergerTest.java\n+++ b/aws-datastore/src/test/java/com/amplifyframework/datastore/syncengine/MergerTest.java\n\n@@ -137,7 +137,7 @@ public final class MergerTest {\n             .name(\"Jameson\")\n             .build();\n         ModelMetadata metadata = new ModelMetadata(blogOwner.getId(), false, 1, Time.now());\n-        // Note that putInStore is NOT called!\n+        // Note that storageAdapter.save(...) is NOT called!\n         // storageAdapter.save(blogOwner, metadata);\n \n         // Act: merge a creation for an item\n"}}, {"oid": "68ad70313974bc3e76cbbc6927c22147a2a18336", "url": "https://github.com/aws-amplify/amplify-android/commit/68ad70313974bc3e76cbbc6927c22147a2a18336", "message": "fixup", "committedDate": "2020-05-20T16:15:54Z", "type": "commit"}, {"oid": "3718464bdb69a5d66073cba3d63f9b1bce74d99a", "url": "https://github.com/aws-amplify/amplify-android/commit/3718464bdb69a5d66073cba3d63f9b1bce74d99a", "message": "Merge remote-tracking branch 'origin/master' into consider_version_when_merging", "committedDate": "2020-05-20T16:16:31Z", "type": "commit"}]}