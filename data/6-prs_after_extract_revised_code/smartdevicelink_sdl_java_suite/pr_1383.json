{"pr_number": 1383, "pr_title": "[SDL 0306] Use Taskmaster To Handle Queuing Operations in Managers", "pr_createdAt": "2020-06-12T15:19:10Z", "pr_url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1383", "timeline": [{"oid": "f246f22e16aab9b95cd0a3fd0af084e7a1fc6fcb", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/f246f22e16aab9b95cd0a3fd0af084e7a1fc6fcb", "message": "Add Taskmaster dependency", "committedDate": "2020-06-12T15:12:58Z", "type": "commit"}, {"oid": "1b15fb34eceec0b7715477c23f9073824638719c", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/1b15fb34eceec0b7715477c23f9073824638719c", "message": "Update ChoiceSetManager to use Taskmaster", "committedDate": "2020-06-12T15:17:21Z", "type": "commit"}, {"oid": "fe0b4dd829c6f2c1598102638f877b1da8595276", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/fe0b4dd829c6f2c1598102638f877b1da8595276", "message": "Fix unit tests", "committedDate": "2020-06-12T17:46:19Z", "type": "commit"}, {"oid": "9d2b2b13cbc4e0d9892fd41b5a25a9e8e49f74e1", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/9d2b2b13cbc4e0d9892fd41b5a25a9e8e49f74e1", "message": "Remove calling run() in onExecute()", "committedDate": "2020-06-15T19:56:55Z", "type": "commit"}, {"oid": "a915ec357cf31f457639b2da9ac46a4bcdc26f08", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/a915ec357cf31f457639b2da9ac46a4bcdc26f08", "message": "Add Taskmaster to javaEE", "committedDate": "2020-06-15T20:56:21Z", "type": "commit"}, {"oid": "a0220a1978cf5dff2d8374b4e8f20cf8be7c4e32", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/a0220a1978cf5dff2d8374b4e8f20cf8be7c4e32", "message": "Refactor SoftButtonState & SoftButtonObject", "committedDate": "2020-06-17T14:46:44Z", "type": "commit"}, {"oid": "efc3385f7d836e4d87e4117cbbb991a5f100cdce", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/efc3385f7d836e4d87e4117cbbb991a5f100cdce", "message": "Fix an issue in SoftButtonState tests", "committedDate": "2020-06-17T15:03:44Z", "type": "commit"}, {"oid": "aa57a6ea0df39be036f4b328366c41349ce435fe", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/aa57a6ea0df39be036f4b328366c41349ce435fe", "message": "Update ScreenManager.commit()", "committedDate": "2020-06-17T15:12:43Z", "type": "commit"}, {"oid": "c6b963b39dc70dc7716f92f162f2975569c6bad6", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c6b963b39dc70dc7716f92f162f2975569c6bad6", "message": "Rename operationQueue to transactionQueue", "committedDate": "2020-06-17T15:58:28Z", "type": "commit"}, {"oid": "a17e6aa2cb1c606ebd2d2d9e1660250010612f93", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/a17e6aa2cb1c606ebd2d2d9e1660250010612f93", "message": "Update SoftButtonObject.hashCode()", "committedDate": "2020-06-17T19:33:09Z", "type": "commit"}, {"oid": "0626034061f290c46a89399e0e1a616fe990f5cb", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/0626034061f290c46a89399e0e1a616fe990f5cb", "message": "Update Taskmaster to 0.3.0", "committedDate": "2020-06-17T20:57:30Z", "type": "commit"}, {"oid": "98964c9d2d49cbde88b0aa8b148b4fbff7b95977", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/98964c9d2d49cbde88b0aa8b148b4fbff7b95977", "message": "Add SoftButtonManager operations", "committedDate": "2020-06-18T18:08:33Z", "type": "commit"}, {"oid": "61afaf40d93e4e17aae66929a61d53fddd12340e", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/61afaf40d93e4e17aae66929a61d53fddd12340e", "message": "Fix an issue in uploading imges for other states", "committedDate": "2020-06-18T21:47:45Z", "type": "commit"}, {"oid": "f18454b4442997d2b77688e87b59f0b0365faf02", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/f18454b4442997d2b77688e87b59f0b0365faf02", "message": "Merge branch 'develop' into feature/use_taskmaster", "committedDate": "2020-06-19T20:33:13Z", "type": "commit"}, {"oid": "9e382aa8f4400934407a88b2bd5fb7e37bad2b2d", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/9e382aa8f4400934407a88b2bd5fb7e37bad2b2d", "message": "Fix SoftButtonManager unit tests", "committedDate": "2020-06-22T19:09:00Z", "type": "commit"}, {"oid": "fdccce599b335862bfe4e65619b9ea135f852c97", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/fdccce599b335862bfe4e65619b9ea135f852c97", "message": "Test that the soft button listeners got called correctly", "committedDate": "2020-06-22T19:20:35Z", "type": "commit"}, {"oid": "8e45380d4f50bbca5a1bbac36d56e2cbbcd35276", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/8e45380d4f50bbca5a1bbac36d56e2cbbcd35276", "message": "Fix potential NPE", "committedDate": "2020-06-23T15:14:13Z", "type": "commit"}, {"oid": "0ec281aa5cc383e3ef8d54703c0ea91df9a5e3d9", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/0ec281aa5cc383e3ef8d54703c0ea91df9a5e3d9", "message": "Update SoftButtonManagerTests", "committedDate": "2020-06-23T21:19:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTc4NTg4OA==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1383#discussion_r445785888", "bodyText": "Can we remove this space", "author": "RHenigan", "createdAt": "2020-06-25T19:21:23Z", "path": "base/src/main/java/com/smartdevicelink/managers/screen/BaseSoftButtonManager.java", "diffHunk": "@@ -76,101 +69,106 @@\n  */\n abstract class BaseSoftButtonManager extends BaseSubManager {\n \n-    private static final String TAG = \"SoftButtonManager\";\n-    private WeakReference<FileManager> fileManager;\n-    WindowCapability defaultMainWindowCapability;\n+    private final WeakReference<FileManager> fileManager;\n+    SoftButtonCapabilities softButtonCapabilities;\n     private CopyOnWriteArrayList<SoftButtonObject> softButtonObjects;\n     private HMILevel currentHMILevel;\n-    private Show inProgressShowRPC;\n-    private CompletionListener inProgressListener, queuedUpdateListener, cachedListener;\n-    private boolean hasQueuedUpdate, batchUpdates, waitingOnHMILevelUpdateToSetButtons;\n     private final OnSystemCapabilityListener onDisplayCapabilityListener;\n     private final OnRPCNotificationListener onHMIStatusListener, onButtonPressListener, onButtonEventListener;\n+    private Queue transactionQueue;\n+    private final List<Task> batchQueue;\n+    private boolean batchUpdates;\n     private final SoftButtonObject.UpdateListener updateListener;\n \n     /**\n      * HAX: This is necessary due to a Ford Sync 3 bug that doesn't like Show requests without a main field being set (it will accept them, but with a GENERIC_ERROR, and 10-15 seconds late...)\n      */\n     private String currentMainField1;\n \n-\n     /**\n      * Creates a new instance of the SoftButtonManager\n      * @param internalInterface an instance of the ISdl interface that can be used for common SDL operations (sendRpc, addRpcListener, etc)\n-     * @param fileManager an instance of the FileManager so that button graphics can be sent\n+     * @param fileManager       an instance of the FileManager so that button graphics can be sent", "originalCommit": "0ec281aa5cc383e3ef8d54703c0ea91df9a5e3d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTgxODkyMw==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1383#discussion_r445818923", "bodyText": "Sure. Fixed.", "author": "bilal-alsharifi", "createdAt": "2020-06-25T20:28:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTc4NTg4OA=="}], "type": "inlineReview", "revised_code": {"commit": "82ea818b5941a5321ef71815611f271d731a67f9", "chunk": "diff --git a/base/src/main/java/com/smartdevicelink/managers/screen/BaseSoftButtonManager.java b/base/src/main/java/com/smartdevicelink/managers/screen/BaseSoftButtonManager.java\nindex 98e13b9f5..cd61a31f0 100644\n--- a/base/src/main/java/com/smartdevicelink/managers/screen/BaseSoftButtonManager.java\n+++ b/base/src/main/java/com/smartdevicelink/managers/screen/BaseSoftButtonManager.java\n\n@@ -88,7 +88,7 @@ abstract class BaseSoftButtonManager extends BaseSubManager {\n     /**\n      * Creates a new instance of the SoftButtonManager\n      * @param internalInterface an instance of the ISdl interface that can be used for common SDL operations (sendRpc, addRpcListener, etc)\n-     * @param fileManager       an instance of the FileManager so that button graphics can be sent\n+     * @param fileManager an instance of the FileManager so that button graphics can be sent\n      */\n     BaseSoftButtonManager(@NonNull final ISdl internalInterface, @NonNull final FileManager fileManager) {\n         super(internalInterface);\n"}}, {"oid": "82ea818b5941a5321ef71815611f271d731a67f9", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/82ea818b5941a5321ef71815611f271d731a67f9", "message": "Fix spacing issue", "committedDate": "2020-06-25T20:27:21Z", "type": "commit"}]}