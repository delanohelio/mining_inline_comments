{"pr_number": 441, "pr_title": "Added async tests for blob", "pr_createdAt": "2020-10-30T19:20:36Z", "pr_url": "https://github.com/Azure/azure-sdk-for-android/pull/441", "timeline": [{"oid": "d882d84083d2de00706db5404c14c849ee4397bc", "url": "https://github.com/Azure/azure-sdk-for-android/commit/d882d84083d2de00706db5404c14c849ee4397bc", "message": "Added async tests", "committedDate": "2020-10-30T19:19:43Z", "type": "commit"}, {"oid": "a5058abf79eab119a11ab8dea13c1e24ff6e7300", "url": "https://github.com/Azure/azure-sdk-for-android/commit/a5058abf79eab119a11ab8dea13c1e24ff6e7300", "message": "REmoved ignore", "committedDate": "2020-10-30T19:20:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQyMDI3Ng==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/441#discussion_r515420276", "bodyText": "Should we check that the header's contents are correct like we check the body contents in rawRownloadAsync()?", "author": "vcolin7", "createdAt": "2020-10-30T23:16:36Z", "path": "sdk/storage/azure-storage-blob/src/test/java/com/azure/android/storage/blob/BlobTest.java", "diffHunk": "@@ -288,6 +290,32 @@ public void getPropertiesError() {\n         assertEquals(404, ex.getStatusCode());\n     }\n \n+    @Test\n+    public void getPropertiesAsync() {\n+        // Setup\n+        CountDownLatch latch = new CountDownLatch(1);\n+\n+        // When\n+        asyncClient.getBlobProperties(containerName, blobName, new CallbackWithHeader<Void, BlobGetPropertiesHeaders>() {\n+                @Override\n+                public void onSuccess(Void result, BlobGetPropertiesHeaders header, Response response) {\n+                    assertEquals(200, response.code());\n+                    latch.countDown();", "originalCommit": "a5058abf79eab119a11ab8dea13c1e24ff6e7300", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIwOTc3NQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/441#discussion_r516209775", "bodyText": "I think we have sync tests that validate the header values, and that logic should be shared between sync and async, so we didn't feel the need to test that redundantly. The async test is more to check that the request goes in and out correctly. Let me know what you think about that approach.", "author": "rickle-msft", "createdAt": "2020-11-02T19:37:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQyMDI3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMDEyNw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/441#discussion_r516220127", "bodyText": "Sounds good to me as long as we have good coverage :)", "author": "vcolin7", "createdAt": "2020-11-02T19:57:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQyMDI3Ng=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQyMDMzNA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/441#discussion_r515420334", "bodyText": "Should we check that the result's contents are correct like we check the body contents in rawRownloadAsync()?", "author": "vcolin7", "createdAt": "2020-10-30T23:16:55Z", "path": "sdk/storage/azure-storage-blob/src/test/java/com/azure/android/storage/blob/BlobTest.java", "diffHunk": "@@ -929,4 +1042,30 @@ public void onFailure(Throwable throwable, Response response) {\n     }\n \n     // setTagsError tested in AC fail as it throws BlobStorageException\n+\n+    @Test\n+    public void getTagsAsync() {\n+        // Setup\n+        CountDownLatch latch = new CountDownLatch(1);\n+\n+        // When\n+        asyncClient.getBlobTags(containerName, blobName, new CallbackWithHeader<Map<String, String>, BlobGetTagsHeaders>() {\n+                @Override\n+                public void onSuccess(Map<String, String> result, BlobGetTagsHeaders header, Response response) {\n+                    assertEquals(200, response.code());", "originalCommit": "a5058abf79eab119a11ab8dea13c1e24ff6e7300", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f134c338adf2346e5afef0acaf44ec6caa7bc069", "chunk": "diff --git a/sdk/storage/azure-storage-blob/src/test/java/com/azure/android/storage/blob/BlobTest.java b/sdk/storage/azure-storage-blob/src/test/java/com/azure/android/storage/blob/BlobTest.java\nindex e6720cb66..76f20348e 100644\n--- a/sdk/storage/azure-storage-blob/src/test/java/com/azure/android/storage/blob/BlobTest.java\n+++ b/sdk/storage/azure-storage-blob/src/test/java/com/azure/android/storage/blob/BlobTest.java\n\n@@ -1042,6 +1071,23 @@ public class BlobTest {\n     }\n \n     // setTagsError tested in AC fail as it throws BlobStorageException\n+    @Test\n+    public void getTagsAC() {\n+        // Setup\n+        setupTagsCondition(syncClient, containerName, blobName);\n+\n+        // Expect\n+        assertEquals(200, syncClient.getBlobTagsWithRestResponse(containerName, blobName, null, null, correctTagsCondition,\n+            null).getStatusCode());\n+    }\n+\n+    @Test\n+    public void getTagsACFail() {\n+        // Expect\n+        assertThrows(BlobStorageException.class,\n+            () -> syncClient.getBlobTagsWithRestResponse(containerName, blobName, null, null, garbageTagsCondition,\n+                null));\n+    }\n \n     @Test\n     public void getTagsAsync() {\n"}}, {"oid": "f134c338adf2346e5afef0acaf44ec6caa7bc069", "url": "https://github.com/Azure/azure-sdk-for-android/commit/f134c338adf2346e5afef0acaf44ec6caa7bc069", "message": "Merge branch 'master' into storage/asyncTests", "committedDate": "2020-11-02T20:00:50Z", "type": "commit"}]}