{"pr_number": 4584, "pr_title": "[ISSUE #4583] Fix DOMAIN mode retry logic", "pr_createdAt": "2020-12-26T19:33:50Z", "pr_url": "https://github.com/alibaba/nacos/pull/4584", "timeline": [{"oid": "a2ea808b7d19a77289e11eaf6db21c9d52e470ff", "url": "https://github.com/alibaba/nacos/commit/a2ea808b7d19a77289e11eaf6db21c9d52e470ff", "message": "[ISSUE-#4567] Refactor nacos-client Load Logging Configuration code. (#4572)\n\n* for #4567, refactor nacos-client logging load Configuration code.\r\n\r\n* Modify exception handling.\r\n\r\n* When customizing AbstractNacosLogging Load Configuration Fail, use the default Logging Load Configuration.\r\n\r\n* NacosLogging has been modified to a single-column mode.", "committedDate": "2020-12-26T05:18:30Z", "type": "forcePushed"}, {"oid": "78ba829e8ef9cce5d241dea0dc74c29855bb5a98", "url": "https://github.com/alibaba/nacos/commit/78ba829e8ef9cce5d241dea0dc74c29855bb5a98", "message": "fix namingProxy domain retry logic; add retry param namingRequestDomainMaxRetryCount", "committedDate": "2020-12-27T08:58:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTEwMDQ1Ng==", "url": "https://github.com/alibaba/nacos/pull/4584#discussion_r549100456", "bodyText": "Where is the place maxRetry  used?  The count limit should be maxRetry", "author": "horizonzy", "createdAt": "2020-12-27T11:23:13Z", "path": "client/src/main/java/com/alibaba/nacos/client/naming/net/NamingProxy.java", "diffHunk": "@@ -513,7 +519,20 @@ public String reqApi(String api, Map<String, String> params, Map<String, String>\n         }\n         \n         NacosException exception = new NacosException();\n-        \n+\n+        if (StringUtils.isNotBlank(nacosDomain)) {\n+            for (int i = 0; i < UtilAndComs.REQUEST_DOMAIN_RETRY_COUNT; i++) {", "originalCommit": "78ba829e8ef9cce5d241dea0dc74c29855bb5a98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTExMTY4Mg==", "url": "https://github.com/alibaba/nacos/pull/4584#discussion_r549111682", "bodyText": "my fault, fixed.", "author": "lexburner", "createdAt": "2020-12-27T13:10:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTEwMDQ1Ng=="}], "type": "inlineReview", "revised_code": {"commit": "2a88dcecfdf52e526eed0d426896b37cae712215", "chunk": "diff --git a/client/src/main/java/com/alibaba/nacos/client/naming/net/NamingProxy.java b/client/src/main/java/com/alibaba/nacos/client/naming/net/NamingProxy.java\nindex ad9850547..e40127984 100644\n--- a/client/src/main/java/com/alibaba/nacos/client/naming/net/NamingProxy.java\n+++ b/client/src/main/java/com/alibaba/nacos/client/naming/net/NamingProxy.java\n\n@@ -521,7 +521,7 @@ public class NamingProxy implements Closeable {\n         NacosException exception = new NacosException();\n \n         if (StringUtils.isNotBlank(nacosDomain)) {\n-            for (int i = 0; i < UtilAndComs.REQUEST_DOMAIN_RETRY_COUNT; i++) {\n+            for (int i = 0; i < maxRetry; i++) {\n                 try {\n                     return callServer(api, params, body, nacosDomain, method);\n                 } catch (NacosException e) {\n"}}, {"oid": "2a88dcecfdf52e526eed0d426896b37cae712215", "url": "https://github.com/alibaba/nacos/commit/2a88dcecfdf52e526eed0d426896b37cae712215", "message": "add maxRetry param", "committedDate": "2020-12-27T13:09:17Z", "type": "commit"}]}