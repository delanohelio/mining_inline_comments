{"pr_number": 3104, "pr_title": "Method name optimization", "pr_createdAt": "2020-06-18T02:17:07Z", "pr_url": "https://github.com/alibaba/nacos/pull/3104", "timeline": [{"oid": "488ae6a2511a68b7323cd5d0a5955dd18743b91c", "url": "https://github.com/alibaba/nacos/commit/488ae6a2511a68b7323cd5d0a5955dd18743b91c", "message": "Instance eliminate module naming optimization", "committedDate": "2020-06-17T08:24:02Z", "type": "commit"}, {"oid": "501bc80bc7e8427cb6557256ae09bb2aa6f47709", "url": "https://github.com/alibaba/nacos/commit/501bc80bc7e8427cb6557256ae09bb2aa6f47709", "message": "Solve PMD check failed", "committedDate": "2020-06-17T09:58:25Z", "type": "commit"}, {"oid": "9f4f1c45934bb8bb9a1ea5d4307f4c4450a048e6", "url": "https://github.com/alibaba/nacos/commit/9f4f1c45934bb8bb9a1ea5d4307f4c4450a048e6", "message": "Merge branch 'develop' into develop", "committedDate": "2020-06-17T12:17:10Z", "type": "commit"}, {"oid": "cb802e3ef969f13db5a8581b205102d01d392480", "url": "https://github.com/alibaba/nacos/commit/cb802e3ef969f13db5a8581b205102d01d392480", "message": "Method name optimization", "committedDate": "2020-06-18T02:12:14Z", "type": "commit"}, {"oid": "25efb81cf3f0b74d9e6e864d7a956ed36a0fa395", "url": "https://github.com/alibaba/nacos/commit/25efb81cf3f0b74d9e6e864d7a956ed36a0fa395", "message": "Merge branch 'develop' into develop", "committedDate": "2020-06-18T02:18:01Z", "type": "commit"}, {"oid": "a56c550d8afe45febb7b77f93dd03ee0645c96e9", "url": "https://github.com/alibaba/nacos/commit/a56c550d8afe45febb7b77f93dd03ee0645c96e9", "message": "Solve code space problem", "committedDate": "2020-06-18T05:13:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk4MzYxMg==", "url": "https://github.com/alibaba/nacos/pull/3104#discussion_r441983612", "bodyText": "I read method again and I think we should change instanceMap to updatedInstancesMap\nchange instanceMap1  to newInstancesMap", "author": "KomachiSion", "createdAt": "2020-06-18T05:53:55Z", "path": "naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java", "diffHunk": "@@ -312,7 +312,7 @@ public void updateIps(List<Instance> ips, boolean ephemeral) {\n         \n         Map<String, Integer> intersectMap = new ConcurrentHashMap<>(newInstance.size() + oldInstance.size());\n         Map<String, Instance> instanceMap = new ConcurrentHashMap<>(newInstance.size());\n-        Map<String, Instance> instanceMap1 = new ConcurrentHashMap<>(newInstance.size());\n+        Map<String, Instance> instancesMap = new ConcurrentHashMap<>(newInstance.size());", "originalCommit": "a56c550d8afe45febb7b77f93dd03ee0645c96e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxMDg2NQ==", "url": "https://github.com/alibaba/nacos/pull/3104#discussion_r442010865", "bodyText": "Ok, I change", "author": "pengzhengfa", "createdAt": "2020-06-18T07:04:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk4MzYxMg=="}], "type": "inlineReview", "revised_code": {"commit": "e21ba6241d637ead918385522859214dd454077a", "chunk": "diff --git a/naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java b/naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java\nindex b01482ab9..ed8765821 100644\n--- a/naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java\n+++ b/naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java\n\n@@ -311,8 +311,8 @@ public class Cluster extends com.alibaba.nacos.api.naming.pojo.Cluster implement\n         }\n         \n         Map<String, Integer> intersectMap = new ConcurrentHashMap<>(newInstance.size() + oldInstance.size());\n-        Map<String, Instance> instanceMap = new ConcurrentHashMap<>(newInstance.size());\n-        Map<String, Instance> instancesMap = new ConcurrentHashMap<>(newInstance.size());\n+        Map<String, Instance> updatedInstancesMap = new ConcurrentHashMap<>(newInstance.size());\n+        Map<String, Instance> newInstancesMap = new ConcurrentHashMap<>(newInstance.size());\n         \n         for (Instance instance : oldInstance) {\n             if (stringIpAddressMap.containsKey(instance.getIp() + \":\" + instance.getPort())) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk4Mzg0MQ==", "url": "https://github.com/alibaba/nacos/pull/3104#discussion_r441983841", "bodyText": "Do not change the Indentation.", "author": "KomachiSion", "createdAt": "2020-06-18T05:54:38Z", "path": "naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java", "diffHunk": "@@ -329,8 +329,8 @@ public void updateIps(List<Instance> ips, boolean ephemeral) {\n                     intersectMap.put(instance.toString(), 1);\n                 }\n             }\n-            \n-            instanceMap1.put(instance.toString(), instance);\n+    ", "originalCommit": "a56c550d8afe45febb7b77f93dd03ee0645c96e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxMDkxOQ==", "url": "https://github.com/alibaba/nacos/pull/3104#discussion_r442010919", "bodyText": "Ok, I change", "author": "pengzhengfa", "createdAt": "2020-06-18T07:04:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk4Mzg0MQ=="}], "type": "inlineReview", "revised_code": {"commit": "e21ba6241d637ead918385522859214dd454077a", "chunk": "diff --git a/naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java b/naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java\nindex b01482ab9..ed8765821 100644\n--- a/naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java\n+++ b/naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java\n\n@@ -329,8 +329,8 @@ public class Cluster extends com.alibaba.nacos.api.naming.pojo.Cluster implement\n                     intersectMap.put(instance.toString(), 1);\n                 }\n             }\n-    \n-            instancesMap.put(instance.toString(), instance);\n+            \n+            newInstancesMap.put(instance.toString(), instance);\n             \n         }\n         \n"}}, {"oid": "e21ba6241d637ead918385522859214dd454077a", "url": "https://github.com/alibaba/nacos/commit/e21ba6241d637ead918385522859214dd454077a", "message": "Method name optimization", "committedDate": "2020-06-18T07:15:48Z", "type": "commit"}, {"oid": "49b579f4cfbc0a4b43de7f1149159aea4b27ea69", "url": "https://github.com/alibaba/nacos/commit/49b579f4cfbc0a4b43de7f1149159aea4b27ea69", "message": "Optimize the naming of persistence layer", "committedDate": "2020-06-18T08:12:10Z", "type": "commit"}]}