{"pr_number": 4439, "pr_title": "[ISSUE-3917] Enhance service detail console web, add metadata filter", "pr_createdAt": "2020-12-09T10:59:31Z", "pr_url": "https://github.com/alibaba/nacos/pull/4439", "timeline": [{"oid": "656e79e118975b72ae164392e2847c3ab0071c0c", "url": "https://github.com/alibaba/nacos/commit/656e79e118975b72ae164392e2847c3ab0071c0c", "message": "add metadata filter at back-end of nacos naming console", "committedDate": "2020-11-28T10:14:40Z", "type": "commit"}, {"oid": "764390ae7953345df5e5fd7fae54a7da12ac9dd6", "url": "https://github.com/alibaba/nacos/commit/764390ae7953345df5e5fd7fae54a7da12ac9dd6", "message": "code enhance", "committedDate": "2020-11-28T10:14:44Z", "type": "commit"}, {"oid": "971dd7a62879d428265c6adb1e48ae7858cd1645", "url": "https://github.com/alibaba/nacos/commit/971dd7a62879d428265c6adb1e48ae7858cd1645", "message": "\u6dfb\u52a0input\uff0ctag\u7b49\u7ec4\u4ef6\uff0c\u521d\u6b65\u5e03\u5c40", "committedDate": "2020-12-02T08:46:35Z", "type": "commit"}, {"oid": "924ecdbc339bdc7476d05b088273672557eae179", "url": "https://github.com/alibaba/nacos/commit/924ecdbc339bdc7476d05b088273672557eae179", "message": "\u5b9e\u73b0\u9875\u9762\u4ea4\u4e92\uff0c\u53ef\u6dfb\u52a0\uff0c\u5220\u9664filter", "committedDate": "2020-12-04T04:34:07Z", "type": "commit"}, {"oid": "26f55cc2ec1133348812f1da97c7d52368aafcf3", "url": "https://github.com/alibaba/nacos/commit/26f55cc2ec1133348812f1da97c7d52368aafcf3", "message": "\u66f4\u65b0filter\u5411\u540e\u7aef\u53d1\u8d77\u8bf7\u6c42\u83b7\u53d6\u6570\u636e", "committedDate": "2020-12-04T10:22:36Z", "type": "commit"}, {"oid": "f0572cdb52e34c45a461515698844572ba3aa14f", "url": "https://github.com/alibaba/nacos/commit/f0572cdb52e34c45a461515698844572ba3aa14f", "message": "\u5b9e\u73b0\u66f4\u65b0\u66f4\u6539\u8fc7\u6ee4\u6761\u4ef6\uff0c\u5237\u65b0\u8868\u683c", "committedDate": "2020-12-07T06:35:27Z", "type": "commit"}, {"oid": "c713ccd5a8cf8db59aaa9dabf7ecd06f0713843d", "url": "https://github.com/alibaba/nacos/commit/c713ccd5a8cf8db59aaa9dabf7ecd06f0713843d", "message": "\u6dfb\u52a0\u56fd\u9645\u5316\u914d\u7f6e", "committedDate": "2020-12-07T06:45:52Z", "type": "commit"}, {"oid": "71db48b70ca07b18e59fa39d5822cc7f9e7db583", "url": "https://github.com/alibaba/nacos/commit/71db48b70ca07b18e59fa39d5822cc7f9e7db583", "message": "\u8f93\u5165\u5b8c\u540e\u6309\u7a7a\u683c\u76f4\u63a5\u6dfb\u52a0\uff0c\u6ca1\u8f93\u5165\u7684input\u7ed9\u51fa\u54cd\u5e94", "committedDate": "2020-12-07T07:35:39Z", "type": "commit"}, {"oid": "d37079c579583de7754f279464ba51a9f128e1a5", "url": "https://github.com/alibaba/nacos/commit/d37079c579583de7754f279464ba51a9f128e1a5", "message": "\u63d0\u4ea4\u5355\u5143\u6d4b\u8bd5\uff0c\u66f4\u65b0\u6253\u5305\u540e\u7684\u9759\u6001\u8d44\u6e90", "committedDate": "2020-12-07T07:50:13Z", "type": "commit"}, {"oid": "d57a1d24c5da058bc27f1d63f0a78068cab07700", "url": "https://github.com/alibaba/nacos/commit/d57a1d24c5da058bc27f1d63f0a78068cab07700", "message": "Merge pull request #1 from jzhishu/fix-3917\n\nFix 3917", "committedDate": "2020-12-07T08:51:26Z", "type": "commit"}, {"oid": "78ed94555688b4039b5729c72359372c0cfccdd8", "url": "https://github.com/alibaba/nacos/commit/78ed94555688b4039b5729c72359372c0cfccdd8", "message": "\u4fee\u6539\u914d\u7f6e \u89e3\u51b3\u751f\u4ea7\u73af\u5883\u4e0asourcemap\u4e0d\u751f\u6548\u7684\u95ee\u9898", "committedDate": "2020-12-08T08:38:49Z", "type": "commit"}, {"oid": "acc6dd3bc788aa952deb26fe0ee31167610f4d1c", "url": "https://github.com/alibaba/nacos/commit/acc6dd3bc788aa952deb26fe0ee31167610f4d1c", "message": "Merge pull request #2 from jzhishu/fix-3917\n\n\u4fee\u6539\u914d\u7f6e \u89e3\u51b3\u751f\u4ea7\u73af\u5883\u4e0asourcemap\u4e0d\u751f\u6548\u7684\u95ee\u9898", "committedDate": "2020-12-08T09:23:06Z", "type": "commit"}, {"oid": "b8dca3e0c40958cc58995fd8e16cb89c83d3b076", "url": "https://github.com/alibaba/nacos/commit/b8dca3e0c40958cc58995fd8e16cb89c83d3b076", "message": "\u7528hook\u91cd\u6784\u7ec4\u4ef6InstanceFilter", "committedDate": "2020-12-09T08:58:27Z", "type": "commit"}, {"oid": "fea93007f7b034b9f278d137c64ac62bc6b35b03", "url": "https://github.com/alibaba/nacos/commit/fea93007f7b034b9f278d137c64ac62bc6b35b03", "message": "\u591a\u4e2a\u96c6\u7fa4\u5404\u81ea\u4f7f\u7528\u8fc7\u6ee4", "committedDate": "2020-12-09T09:33:22Z", "type": "commit"}, {"oid": "0f268de556f5e28c12c73bd94e4176730520a11c", "url": "https://github.com/alibaba/nacos/commit/0f268de556f5e28c12c73bd94e4176730520a11c", "message": "\u89e3\u51b3\u591a\u96c6\u7fa4\u65f6\uff0c\u5143\u6570\u636e\u8fc7\u6ee4\u65e0\u6cd5\u5355\u72ec\u4f7f\u7528\u7684\u95ee\u9898", "committedDate": "2020-12-09T09:35:04Z", "type": "commit"}, {"oid": "9cdd27ab137f4d8f3700acdcb3578b35e5f4bf5c", "url": "https://github.com/alibaba/nacos/commit/9cdd27ab137f4d8f3700acdcb3578b35e5f4bf5c", "message": "Merge pull request #3 from jzhishu/fix-3917\n\nFix 3917", "committedDate": "2020-12-09T09:36:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTIyNTAzNA==", "url": "https://github.com/alibaba/nacos/pull/4439#discussion_r539225034", "bodyText": "\u53ef\u4ee5\u8003\u8651\u5e76\u53d1\u7684Stream", "author": "chuntaojun", "createdAt": "2020-12-09T11:23:41Z", "path": "naming/src/main/java/com/alibaba/nacos/naming/controllers/CatalogController.java", "diffHunk": "@@ -306,4 +317,18 @@ public ObjectNode rt4Service(HttpServletRequest request) {\n         return ipAddressInfos;\n     }\n     \n+    private List<Instance> filterInstance(List<Instance> instances, Map<String, String> metadata) {\n+        if (MapUtils.isEmpty(metadata)) {\n+            return instances;\n+        }\n+        return instances.stream().filter(instance -> {", "originalCommit": "9cdd27ab137f4d8f3700acdcb3578b35e5f4bf5c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTIyOTM0OQ==", "url": "https://github.com/alibaba/nacos/pull/4439#discussion_r539229349", "bodyText": "\u5c0f\u6570\u636e\u91cf\u7528\u8fd9\u4e2a\u5c31\u884c\u4e86", "author": "horizonzy", "createdAt": "2020-12-09T11:30:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTIyNTAzNA=="}], "type": "inlineReview", "revised_code": {"commit": "38bb8cd700ddb2f80aff8ef1ad31f90be360a79e", "chunk": "diff --git a/naming/src/main/java/com/alibaba/nacos/naming/controllers/CatalogController.java b/naming/src/main/java/com/alibaba/nacos/naming/controllers/CatalogController.java\nindex 62739baeb..49b04da9f 100644\n--- a/naming/src/main/java/com/alibaba/nacos/naming/controllers/CatalogController.java\n+++ b/naming/src/main/java/com/alibaba/nacos/naming/controllers/CatalogController.java\n\n@@ -317,18 +307,4 @@ public class CatalogController {\n         return ipAddressInfos;\n     }\n     \n-    private List<Instance> filterInstance(List<Instance> instances, Map<String, String> metadata) {\n-        if (MapUtils.isEmpty(metadata)) {\n-            return instances;\n-        }\n-        return instances.stream().filter(instance -> {\n-            for (Map.Entry<String, String> entry : metadata.entrySet()) {\n-                if (!instance.getMetadata().containsKey(entry.getKey()) || !Objects\n-                        .equals(instance.getMetadata().get(entry.getKey()), entry.getValue())) {\n-                    return false;\n-                }\n-            }\n-            return true;\n-        }).collect(Collectors.toList());\n-    }\n }\n"}}, {"oid": "38bb8cd700ddb2f80aff8ef1ad31f90be360a79e", "url": "https://github.com/alibaba/nacos/commit/38bb8cd700ddb2f80aff8ef1ad31f90be360a79e", "message": "revert backend code", "committedDate": "2020-12-10T03:46:26Z", "type": "commit"}, {"oid": "84e1bf50d6cb6cada72c2ce6fd0314e2bb00d747", "url": "https://github.com/alibaba/nacos/commit/84e1bf50d6cb6cada72c2ce6fd0314e2bb00d747", "message": "revert metadata filter test", "committedDate": "2020-12-10T04:28:36Z", "type": "commit"}, {"oid": "b00fbf198258eb3b4d3d8df79346eb8c87afaf9f", "url": "https://github.com/alibaba/nacos/commit/b00fbf198258eb3b4d3d8df79346eb8c87afaf9f", "message": "\u53ea\u4ece\u5ba2\u6237\u7aef\u5df2\u83b7\u53d6\u5230\u7684\u5b9e\u4f8b\u4e2d\u8fc7\u6ee4", "committedDate": "2020-12-16T15:16:32Z", "type": "commit"}, {"oid": "6d27a665558d2c54a70bce61bf7c8fb1e376f064", "url": "https://github.com/alibaba/nacos/commit/6d27a665558d2c54a70bce61bf7c8fb1e376f064", "message": "Merge pull request #4 from jzhishu/fix-3917\n\n\u53ea\u4ece\u5ba2\u6237\u7aef\u5df2\u83b7\u53d6\u5230\u7684\u5b9e\u4f8b\u4e2d\u8fc7\u6ee4", "committedDate": "2020-12-16T15:19:39Z", "type": "commit"}, {"oid": "eeb62b100d98709fcb0d05d0ca1882270c39b1cf", "url": "https://github.com/alibaba/nacos/commit/eeb62b100d98709fcb0d05d0ca1882270c39b1cf", "message": "\u53d8\u52a8\u66f4\u65b0\u5230\u6253\u5305\u540e\u7684mian.js", "committedDate": "2020-12-17T02:03:51Z", "type": "commit"}, {"oid": "160dfda5c3d76c23d05a0109ac5bd2b5eef21325", "url": "https://github.com/alibaba/nacos/commit/160dfda5c3d76c23d05a0109ac5bd2b5eef21325", "message": "Merge pull request #6 from jzhishu/fix-3917\n\n\u53d8\u52a8\u66f4\u65b0\u5230\u6253\u5305\u540e\u7684mian.js", "committedDate": "2020-12-17T04:37:56Z", "type": "commit"}]}