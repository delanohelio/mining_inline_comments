{"pr_number": 4568, "pr_title": "make code more readable.", "pr_createdAt": "2020-12-24T15:46:59Z", "pr_url": "https://github.com/alibaba/nacos/pull/4568", "timeline": [{"oid": "e46fc4e418208047331411e95c51c605fc5797b0", "url": "https://github.com/alibaba/nacos/commit/e46fc4e418208047331411e95c51c605fc5797b0", "message": "make code more readable.", "committedDate": "2020-12-24T15:41:32Z", "type": "commit"}, {"oid": "e6935dd5b5778237abfa6badfeea4f65cbc168c8", "url": "https://github.com/alibaba/nacos/commit/e6935dd5b5778237abfa6badfeea4f65cbc168c8", "message": "code enhance", "committedDate": "2020-12-24T16:02:46Z", "type": "commit"}, {"oid": "08e7f2e35ac6d9b726bfbd069d8521b14c050d23", "url": "https://github.com/alibaba/nacos/commit/08e7f2e35ac6d9b726bfbd069d8521b14c050d23", "message": "code enhance", "committedDate": "2020-12-24T16:22:19Z", "type": "commit"}, {"oid": "256feb076ce5daed979076449a2369c461f45400", "url": "https://github.com/alibaba/nacos/commit/256feb076ce5daed979076449a2369c461f45400", "message": "fix comment for grpc client", "committedDate": "2020-12-24T16:58:32Z", "type": "commit"}, {"oid": "9cdff85535e6b2e55b24a43c2b527a5a9d29eaca", "url": "https://github.com/alibaba/nacos/commit/9cdff85535e6b2e55b24a43c2b527a5a9d29eaca", "message": "initHandlerRpcClient -> initRpcClientHandler", "committedDate": "2020-12-24T17:01:04Z", "type": "commit"}, {"oid": "a5f0f7f5cd3cb224970fb66c93856e588205e27c", "url": "https://github.com/alibaba/nacos/commit/a5f0f7f5cd3cb224970fb66c93856e588205e27c", "message": "rename some method and modify some comments", "committedDate": "2020-12-24T17:08:59Z", "type": "commit"}, {"oid": "7d2446da37a6529882df373e6716687c6114d4d9", "url": "https://github.com/alibaba/nacos/commit/7d2446da37a6529882df373e6716687c6114d4d9", "message": "code enhance.", "committedDate": "2020-12-24T17:17:45Z", "type": "commit"}, {"oid": "e4d2ce7b33970dfa6f5be0d4f31215e02516206f", "url": "https://github.com/alibaba/nacos/commit/e4d2ce7b33970dfa6f5be0d4f31215e02516206f", "message": "code enhance.", "committedDate": "2020-12-24T17:20:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODgxMzc3OQ==", "url": "https://github.com/alibaba/nacos/pull/4568#discussion_r548813779", "bodyText": "registerServerResponseHandler?", "author": "mingjliu9", "createdAt": "2020-12-25T06:29:34Z", "path": "client/src/main/java/com/alibaba/nacos/client/naming/remote/gprc/NamingGrpcClientProxy.java", "diffHunk": "@@ -86,7 +86,7 @@ public NamingGrpcClientProxy(String namespaceId, ServerListFactory serverListFac\n     private void start(ServerListFactory serverListFactory, ServiceInfoHolder serviceInfoHolder) throws NacosException {\n         rpcClient.init(serverListFactory);\n         rpcClient.start();\n-        rpcClient.registerServerPushResponseHandler(new NamingPushResponseHandler(serviceInfoHolder));\n+        rpcClient.registerServerRequestHandler(new NamingPushResponseHandler(serviceInfoHolder));", "originalCommit": "e4d2ce7b33970dfa6f5be0d4f31215e02516206f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODgxNTgzNA==", "url": "https://github.com/alibaba/nacos/pull/4568#discussion_r548815834", "bodyText": "The handler is to process request from server.", "author": "horizonzy", "createdAt": "2020-12-25T06:42:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODgxMzc3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIxNzE0OQ==", "url": "https://github.com/alibaba/nacos/pull/4568#discussion_r549217149", "bodyText": "Honestly speaking, it is bit counter-intuitive to inject a response handler to a request handler registry.", "author": "mingjliu9", "createdAt": "2020-12-28T05:08:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODgxMzc3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIyMDc2Mg==", "url": "https://github.com/alibaba/nacos/pull/4568#discussion_r549220762", "bodyText": "In my opinion. For this case, the client is requested side, the server is request side. Client received request from server, it process the request and then return reponse to server.", "author": "horizonzy", "createdAt": "2020-12-28T05:33:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODgxMzc3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "c768fe2b3f11d16eb6027c30fe0451ab397dc295", "chunk": "diff --git a/client/src/main/java/com/alibaba/nacos/client/naming/remote/gprc/NamingGrpcClientProxy.java b/client/src/main/java/com/alibaba/nacos/client/naming/remote/gprc/NamingGrpcClientProxy.java\nindex 69988743b..347cc5b52 100644\n--- a/client/src/main/java/com/alibaba/nacos/client/naming/remote/gprc/NamingGrpcClientProxy.java\n+++ b/client/src/main/java/com/alibaba/nacos/client/naming/remote/gprc/NamingGrpcClientProxy.java\n\n@@ -86,7 +86,7 @@ public class NamingGrpcClientProxy implements NamingClientProxy {\n     private void start(ServerListFactory serverListFactory, ServiceInfoHolder serviceInfoHolder) throws NacosException {\n         rpcClient.init(serverListFactory);\n         rpcClient.start();\n-        rpcClient.registerServerRequestHandler(new NamingPushResponseHandler(serviceInfoHolder));\n+        rpcClient.registerServerRequestHandler(new NamingPushRequestHandler(serviceInfoHolder));\n         rpcClient.registerConnectionListener(namingGrpcConnectionEventListener);\n     }\n     \n"}}, {"oid": "c768fe2b3f11d16eb6027c30fe0451ab397dc295", "url": "https://github.com/alibaba/nacos/commit/c768fe2b3f11d16eb6027c30fe0451ab397dc295", "message": "rename NamingPushResponseHandler -> NamingPushRequestHandler", "committedDate": "2020-12-25T06:47:04Z", "type": "commit"}, {"oid": "bec5a084d99d202603601cac515da50ecc8e6112", "url": "https://github.com/alibaba/nacos/commit/bec5a084d99d202603601cac515da50ecc8e6112", "message": "fix connectionId typo", "committedDate": "2020-12-25T15:32:49Z", "type": "commit"}, {"oid": "41568f37a74b980c41902a3d86de15b08c9380dd", "url": "https://github.com/alibaba/nacos/commit/41568f37a74b980c41902a3d86de15b08c9380dd", "message": "Merge remote-tracking branch 'upstream/feature_support_grpc_core' into grpc-code-enhance\n\n# Conflicts:\n#\tclient/src/main/java/com/alibaba/nacos/client/config/impl/ClientWorker.java\n#\tcommon/src/main/java/com/alibaba/nacos/common/remote/client/RpcClient.java\n#\tcommon/src/main/java/com/alibaba/nacos/common/remote/client/grpc/GrpcUtils.java", "committedDate": "2020-12-28T07:56:36Z", "type": "commit"}]}