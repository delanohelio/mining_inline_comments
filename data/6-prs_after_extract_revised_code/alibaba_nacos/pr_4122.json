{"pr_number": 4122, "pr_title": "[ISSUE#3831]Delete the old http client code", "pr_createdAt": "2020-11-03T09:32:28Z", "pr_url": "https://github.com/alibaba/nacos/pull/4122", "timeline": [{"oid": "7b4456e4d0b6a37c7af1ac455cb5f162121d7d40", "url": "https://github.com/alibaba/nacos/commit/7b4456e4d0b6a37c7af1ac455cb5f162121d7d40", "message": "refactor: delete the old http client code marked as @Deprecated", "committedDate": "2020-11-03T09:29:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY0MzAzNg==", "url": "https://github.com/alibaba/nacos/pull/4122#discussion_r516643036", "bodyText": "The speed limit function here needs to be preserved for now, so don't delete this HTTP code", "author": "chuntaojun", "createdAt": "2020-11-03T12:51:42Z", "path": "client/src/main/java/com/alibaba/nacos/client/config/impl/HttpSimpleClient.java", "diffHunk": "@@ -1,305 +0,0 @@\n-/*\n- * Copyright 1999-2018 Alibaba Group Holding Ltd.\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-\n-package com.alibaba.nacos.client.config.impl;\n-\n-import com.alibaba.nacos.api.common.Constants;\n-import com.alibaba.nacos.api.exception.NacosException;\n-import com.alibaba.nacos.client.utils.ParamUtil;\n-import com.alibaba.nacos.common.constant.HttpHeaderConsts;\n-import com.alibaba.nacos.common.http.client.NacosRestTemplate;\n-import com.alibaba.nacos.common.utils.IoUtils;\n-import com.alibaba.nacos.common.utils.MD5Utils;\n-import com.alibaba.nacos.common.utils.UuidUtils;\n-import com.alibaba.nacos.common.utils.VersionUtils;\n-\n-import java.io.IOException;\n-import java.io.UnsupportedEncodingException;\n-import java.net.HttpURLConnection;\n-import java.net.URL;\n-import java.net.URLEncoder;\n-import java.util.ArrayList;\n-import java.util.Iterator;\n-import java.util.List;\n-import java.util.Map;\n-\n-/**\n- * Http tool.\n- *\n- * @author Nacos\n- * @deprecated Use NacosRestTemplate{@link NacosRestTemplate} unified http client\n- */\n-@Deprecated\n-public class HttpSimpleClient {\n-    \n-    /**\n-     * Get method.\n-     *\n-     * @param url           url\n-     * @param headers       headers\n-     * @param paramValues   paramValues\n-     * @param encoding      encoding\n-     * @param readTimeoutMs readTimeoutMs\n-     * @param isSsl         isSsl\n-     * @return result\n-     * @throws IOException io exception\n-     */\n-    public static HttpResult httpGet(String url, List<String> headers, List<String> paramValues, String encoding,\n-            long readTimeoutMs, boolean isSsl) throws IOException {\n-        String encodedContent = encodingParams(paramValues, encoding);\n-        url += (null == encodedContent) ? \"\" : (\"?\" + encodedContent);\n-        if (Limiter", "originalCommit": "7b4456e4d0b6a37c7af1ac455cb5f162121d7d40", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY2MTU1OQ==", "url": "https://github.com/alibaba/nacos/pull/4122#discussion_r516661559", "bodyText": "This has been added in the new http client implementation, see com.alibaba.nacos.client.config.impl.ConfigHttpClientManager.LimiterHttpClientRequestInterceptor", "author": "Maijh97", "createdAt": "2020-11-03T13:22:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY0MzAzNg=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzE5MzkzMA==", "url": "https://github.com/alibaba/nacos/pull/4122#discussion_r517193930", "bodyText": "HttpClientBeanHolder should be shutdown in here?", "author": "KomachiSion", "createdAt": "2020-11-04T09:10:06Z", "path": "core/src/main/java/com/alibaba/nacos/core/code/StartingSpringApplicationRunListener.java", "diffHunk": "@@ -142,8 +141,6 @@ public void failed(ConfigurableApplicationContext context, Throwable exception)\n         logFilePath();\n         \n         LOGGER.error(\"Startup errors : {}\", exception);\n-        \n-        HttpClientManager.shutdown();", "originalCommit": "7b4456e4d0b6a37c7af1ac455cb5f162121d7d40", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyNDAxNw==", "url": "https://github.com/alibaba/nacos/pull/4122#discussion_r517224017", "bodyText": "Will submit a new pr to solve this problem, link #3832", "author": "Maijh97", "createdAt": "2020-11-04T09:57:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzE5MzkzMA=="}], "type": "inlineReview", "revised_code": null}]}