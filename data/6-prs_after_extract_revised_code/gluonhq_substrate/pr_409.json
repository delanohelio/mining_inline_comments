{"pr_number": 409, "pr_title": "#408 Add AttachAdapter with lifecycle events", "pr_createdAt": "2020-03-06T14:10:38Z", "pr_url": "https://github.com/gluonhq/substrate/pull/409", "timeline": [{"oid": "408301565ce6617fe0843b037a701850f2c9e146", "url": "https://github.com/gluonhq/substrate/commit/408301565ce6617fe0843b037a701850f2c9e146", "message": "Add missing license headers", "committedDate": "2020-03-06T13:48:48Z", "type": "commit"}, {"oid": "086df579ac45b1f7304236a8ff8ee90dcfd0ed55", "url": "https://github.com/gluonhq/substrate/commit/086df579ac45b1f7304236a8ff8ee90dcfd0ed55", "message": "#408 Add AttachAdapter with lifecycle events", "committedDate": "2020-03-06T14:08:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkzNzg2OQ==", "url": "https://github.com/gluonhq/substrate/pull/409#discussion_r388937869", "bodyText": "I was wondering if passing an int instead of a string might be easier? The int values can be easily mapped to the matching LifecycleEvent enum in Attach?", "author": "tiainen", "createdAt": "2020-03-06T14:37:13Z", "path": "src/main/resources/native/android/dalvik/source/MainActivity.java", "diffHunk": "@@ -230,39 +257,51 @@ public boolean dispatchKeyEvent(final KeyEvent event) {\n     protected void onDestroy() {\n         Log.v(TAG, \"onDestroy\");\n         super.onDestroy();\n+        notifyLifecycleEvent(\"destroy\");\n         android.os.Process.killProcess(android.os.Process.myPid());\n     }\n \n     @Override\n     protected void onPause() {\n         Log.v(TAG, \"onPause\");\n         super.onPause();\n+        notifyLifecycleEvent(\"pause\");\n     }\n \n     @Override\n     protected void onResume() {\n         Log.v(TAG, \"onResume\");\n         super.onResume();\n+        notifyLifecycleEvent(\"resume\");\n         Log.v(TAG, \"onResume done\");\n     }\n \n     @Override\n     protected void onStart() {\n         Log.v(TAG, \"onStart\");\n         super.onStart();\n+        notifyLifecycleEvent(\"start\");\n         Log.v(TAG, \"onStart done\");\n     }\n \n     @Override\n     protected void onRestart() {\n         Log.v(TAG, \"onRestart\");\n         super.onRestart();\n+        notifyLifecycleEvent(\"restart\");\n     }\n \n     @Override\n     protected void onStop() {\n         Log.v(TAG, \"onStop\");\n         super.onStop();\n+        notifyLifecycleEvent(\"stop\");\n+    }\n+\n+    private void notifyLifecycleEvent(String event) {\n+        if (graalStarted) {\n+            nativeDispatchLifecycleEvent(event, event.length());", "originalCommit": "086df579ac45b1f7304236a8ff8ee90dcfd0ed55", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTUyNDgzNQ==", "url": "https://github.com/gluonhq/substrate/pull/409#discussion_r389524835", "bodyText": "So far we only listen for pause/resume lifecycle events, but there are more (start, stop, ...). Adding an int could cause issues if we later on add any of those events.", "author": "jperedadnr", "createdAt": "2020-03-09T08:48:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkzNzg2OQ=="}], "type": "inlineReview", "revised_code": {"commit": "584397b6e67abb637a00c453a854afe48c51aa65", "chunk": "diff --git a/src/main/resources/native/android/dalvik/source/MainActivity.java b/src/main/resources/native/android/dalvik/source/MainActivity.java\nindex 4710eb2..0028d39 100644\n--- a/src/main/resources/native/android/dalvik/source/MainActivity.java\n+++ b/src/main/resources/native/android/dalvik/source/MainActivity.java\n\n@@ -300,7 +301,7 @@ public class MainActivity extends Activity implements SurfaceHolder.Callback,\n \n     private void notifyLifecycleEvent(String event) {\n         if (graalStarted) {\n-            nativeDispatchLifecycleEvent(event, event.length());\n+            nativeDispatchLifecycleEvent(event.toCharArray(), event.length());\n         }\n     }\n \n"}}, {"oid": "955f9138e51d36ed60153dc4f257ea5598809fa0", "url": "https://github.com/gluonhq/substrate/commit/955f9138e51d36ed60153dc4f257ea5598809fa0", "message": "Missing native signature", "committedDate": "2020-03-06T14:40:48Z", "type": "commit"}, {"oid": "584397b6e67abb637a00c453a854afe48c51aa65", "url": "https://github.com/gluonhq/substrate/commit/584397b6e67abb637a00c453a854afe48c51aa65", "message": "Use char array instead of String", "committedDate": "2020-03-06T14:43:19Z", "type": "commit"}, {"oid": "a1d72cba170501385cc6e10e70ef363a805451ce", "url": "https://github.com/gluonhq/substrate/commit/a1d72cba170501385cc6e10e70ef363a805451ce", "message": "Use string instead of char array", "committedDate": "2020-03-06T16:02:49Z", "type": "commit"}, {"oid": "39bf4e69b79e44c1af9c6fcf20ef5c12b04499e1", "url": "https://github.com/gluonhq/substrate/commit/39bf4e69b79e44c1af9c6fcf20ef5c12b04499e1", "message": "Use const", "committedDate": "2020-03-06T16:06:25Z", "type": "commit"}, {"oid": "fcc264ab19d68b61523856953ad94ca4bf548a82", "url": "https://github.com/gluonhq/substrate/commit/fcc264ab19d68b61523856953ad94ca4bf548a82", "message": "Use jstring and const char. Fix headers", "committedDate": "2020-03-06T18:59:21Z", "type": "commit"}, {"oid": "28b5bd39589dbb9227d7cc2f918bd871c062ad51", "url": "https://github.com/gluonhq/substrate/commit/28b5bd39589dbb9227d7cc2f918bd871c062ad51", "message": "Update compiled classes", "committedDate": "2020-03-06T19:28:36Z", "type": "commit"}]}