{"pr_number": 335, "pr_title": "#292  Check if Keychain was locked and try to unlock it", "pr_createdAt": "2020-02-11T17:38:57Z", "pr_url": "https://github.com/gluonhq/substrate/pull/335", "timeline": [{"oid": "ab548bc984883ec803c446dcdf61606b7a941fae", "url": "https://github.com/gluonhq/substrate/commit/ab548bc984883ec803c446dcdf61606b7a941fae", "message": "#292 Check if Keychain was locked and try to unlock it if codesign fails", "committedDate": "2020-02-11T17:06:41Z", "type": "commit"}, {"oid": "0e2ccf03e4a372fabc5bcbaae813ac51e5202860", "url": "https://github.com/gluonhq/substrate/commit/0e2ccf03e4a372fabc5bcbaae813ac51e5202860", "message": "Add javadoc", "committedDate": "2020-02-11T17:37:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzc5ODgxNg==", "url": "https://github.com/gluonhq/substrate/pull/335#discussion_r377798816", "bodyText": "That sounds like the operation is halted, but from the code it seems you're continuing trying to solve this.\nIt would be good if the developer got feedback (e.g. \"You will know be shown a dialog\" or so)", "author": "johanvos", "createdAt": "2020-02-11T17:53:33Z", "path": "src/main/java/com/gluonhq/substrate/util/ios/CodeSigning.java", "diffHunk": "@@ -243,6 +246,15 @@ private boolean sign(Path entitlementsPath, Path appPath) throws IOException, In\n             Logger.logSevere(\"Codesign process failed\");\n             return false;\n         }\n+        for (String line : runner.getResponses()) {\n+            if (line.contains(KEYCHAIN_ERROR_MESSAGE)) {\n+                Logger.logInfo(\"Error signing the application: keychain was locked\");", "originalCommit": "0e2ccf03e4a372fabc5bcbaae813ac51e5202860", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgwMTE2Nw==", "url": "https://github.com/gluonhq/substrate/pull/335#discussion_r377801167", "bodyText": "Makes sense, modified.", "author": "jperedadnr", "createdAt": "2020-02-11T17:57:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzc5ODgxNg=="}], "type": "inlineReview", "revised_code": {"commit": "3fe321ac1cac61366cc72e4bce88c2419a0e4d24", "chunk": "diff --git a/src/main/java/com/gluonhq/substrate/util/ios/CodeSigning.java b/src/main/java/com/gluonhq/substrate/util/ios/CodeSigning.java\nindex 78f0414..e5f94da 100644\n--- a/src/main/java/com/gluonhq/substrate/util/ios/CodeSigning.java\n+++ b/src/main/java/com/gluonhq/substrate/util/ios/CodeSigning.java\n\n@@ -248,7 +248,7 @@ public class CodeSigning {\n         }\n         for (String line : runner.getResponses()) {\n             if (line.contains(KEYCHAIN_ERROR_MESSAGE)) {\n-                Logger.logInfo(\"Error signing the application: keychain was locked\");\n+                Logger.logInfo(\"Error signing the application: the keychain was locked.\\nYou will be required now to unlock the keychain\");\n                 if (unlockKeychain()) {\n                     return sign(entitlementsPath, appPath);\n                 }\n"}}, {"oid": "3fe321ac1cac61366cc72e4bce88c2419a0e4d24", "url": "https://github.com/gluonhq/substrate/commit/3fe321ac1cac61366cc72e4bce88c2419a0e4d24", "message": "Fix message shown to the user", "committedDate": "2020-02-11T17:57:20Z", "type": "commit"}]}