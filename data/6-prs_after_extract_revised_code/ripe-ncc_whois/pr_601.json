{"pr_number": 601, "pr_title": "Restrict maximum size of object.", "pr_createdAt": "2020-02-03T15:21:26Z", "pr_url": "https://github.com/RIPE-NCC/whois/pull/601", "timeline": [{"oid": "6038d115c3ec9bbd5bbaf311ac20ba3cc96254ae", "url": "https://github.com/RIPE-NCC/whois/commit/6038d115c3ec9bbd5bbaf311ac20ba3cc96254ae", "message": "Restrict maximum size of object.", "committedDate": "2020-02-03T15:20:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NzA0Nw==", "url": "https://github.com/RIPE-NCC/whois/pull/601#discussion_r374167047", "bodyText": "minor suggestion to move length check outside unrelated try-catch, and put in a continue statement instead.", "author": "eshryane", "createdAt": "2020-02-03T15:27:51Z", "path": "whois-api/src/main/java/net/ripe/db/whois/api/UpdatesParser.java", "diffHunk": "@@ -179,7 +182,12 @@ private String extractOverride(final Set<Credential> credentials, final String p\n             }\n \n             try {\n-                updates.add(createUpdate(paragraph, operation, deleteReasons, content, updateContext));\n+                if (content.length() > MAXIMUM_OBJECT_SIZE) {", "originalCommit": "6038d115c3ec9bbd5bbaf311ac20ba3cc96254ae", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7949f3325dfeec181c80b4040fdd1faeae0fc796", "chunk": "diff --git a/whois-api/src/main/java/net/ripe/db/whois/api/UpdatesParser.java b/whois-api/src/main/java/net/ripe/db/whois/api/UpdatesParser.java\nindex e95842dca..07d666154 100644\n--- a/whois-api/src/main/java/net/ripe/db/whois/api/UpdatesParser.java\n+++ b/whois-api/src/main/java/net/ripe/db/whois/api/UpdatesParser.java\n\n@@ -181,13 +181,14 @@ public class UpdatesParser {\n                 content = matcher.reset().replaceAll(\"\");\n             }\n \n+            if (content.length() > MAXIMUM_OBJECT_SIZE) {\n+                updateContext.ignore(paragraph);\n+                updateContext.addGlobalMessage(UpdateMessages.maximumObjectSizeExceeded(content.length(), MAXIMUM_OBJECT_SIZE));\n+                continue;\n+            }\n+\n             try {\n-                if (content.length() > MAXIMUM_OBJECT_SIZE) {\n-                    updateContext.ignore(paragraph);\n-                    updateContext.addGlobalMessage(UpdateMessages.maximumObjectSizeExceeded(content.length(), MAXIMUM_OBJECT_SIZE));\n-                } else {\n-                    updates.add(createUpdate(paragraph, operation, deleteReasons, content, updateContext));\n-                }\n+                updates.add(createUpdate(paragraph, operation, deleteReasons, content, updateContext));\n             } catch (IllegalArgumentException e) {\n                 updateContext.ignore(paragraph);\n             }\n"}}, {"oid": "7949f3325dfeec181c80b4040fdd1faeae0fc796", "url": "https://github.com/RIPE-NCC/whois/commit/7949f3325dfeec181c80b4040fdd1faeae0fc796", "message": "Processed review comments.", "committedDate": "2020-02-04T15:49:13Z", "type": "commit"}, {"oid": "ab545faeaa1206f89e11a26255edac952a247417", "url": "https://github.com/RIPE-NCC/whois/commit/ab545faeaa1206f89e11a26255edac952a247417", "message": "Make maximum object size configurable, default to 5MB.", "committedDate": "2020-02-04T16:17:21Z", "type": "commit"}]}