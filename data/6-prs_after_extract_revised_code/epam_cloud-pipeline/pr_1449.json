{"pr_number": 1449, "pr_title": "Issue #1405: Implemented tests for CloudRegionController", "pr_createdAt": "2020-09-30T12:54:37Z", "pr_url": "https://github.com/epam/cloud-pipeline/pull/1449", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODExMDY1Nw==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r498110657", "bodyText": "Lets make the CloudRegionInfo a mutable object: add no args constructor, remove final and change @Value to @Data  to use ControllerTestUtils#assertResponse method", "author": "ekazachkova", "createdAt": "2020-10-01T09:33:41Z", "path": "api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java", "diffHunk": "@@ -0,0 +1,333 @@\n+/*\n+ * Copyright 2017-2020 EPAM Systems, Inc. (https://www.epam.com/)\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.epam.pipeline.controller.region;\n+\n+import com.epam.pipeline.config.JsonMapper;\n+import com.epam.pipeline.test.web.AbstractControllerTest;\n+import com.epam.pipeline.controller.ResponseResult;\n+import com.epam.pipeline.controller.Result;\n+import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n+import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AbstractCloudRegion;\n+import com.epam.pipeline.entity.region.AwsRegion;\n+import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.manager.region.CloudRegionApiService;\n+import com.epam.pipeline.util.ControllerTestUtils;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import org.apache.commons.lang3.StringUtils;\n+import org.assertj.core.api.Assertions;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Mockito;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n+import org.springframework.security.test.context.support.WithMockUser;\n+import org.springframework.test.web.servlet.MvcResult;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n+\n+@WebMvcTest(controllers = CloudRegionController.class)\n+public class CloudRegionControllerTest extends AbstractControllerTest {\n+\n+    public static final long ID = 1L;\n+    private static final String REGION_URL = SERVLET_PATH + \"/cloud/region\";\n+    public static final String LOAD_PROVIDERS_URL = REGION_URL + \"/provider\";\n+    public static final String LOAD_REGIONS_INFO_URL = REGION_URL + \"/info\";\n+    public static final String LOAD_AVAILABLE_REGIONS_URL = REGION_URL + \"/available\";\n+    private static final String REGION_ID_URL = REGION_URL + \"/%d\";\n+    private AwsRegion awsRegion;\n+    private ResponseResult<AwsRegion> expectedAwsRegionResult;\n+\n+    @Autowired\n+    private CloudRegionApiService mockCloudRegionApiService;\n+\n+    @Before\n+    public void setUp() {\n+        awsRegion = new AwsRegion();\n+        awsRegion.setId(ID);\n+        awsRegion.setName(\"testName\");\n+        awsRegion.setRegionCode(\"7367\");\n+\n+        expectedAwsRegionResult = ControllerTestUtils.buildExpectedResult(awsRegion);\n+    }\n+\n+    @Test\n+    public void shouldFailLoadProvidersForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadProviders() throws Exception {\n+        final List<CloudProvider> cloudProviders = Collections.singletonList(CloudProvider.AWS);\n+\n+        Mockito.doReturn(cloudProviders).when(mockCloudRegionApiService).loadProviders();\n+\n+        final MvcResult mvcResult = mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadProviders();\n+\n+        final ResponseResult<List<CloudProvider>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudProviders);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+                new TypeReference<Result<List<CloudProvider>>>() { });\n+    }\n+\n+    @Test\n+    public void shouldFailLoadAllForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(REGION_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadAll() throws Exception {\n+        final List<AwsRegion> cloudRegions = Collections.singletonList(awsRegion);\n+\n+        Mockito.doReturn(cloudRegions).when(mockCloudRegionApiService).loadAll();\n+\n+        final MvcResult mvcResult = mvc().perform(get(REGION_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadAll();\n+\n+        final ResponseResult<List<AwsRegion>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudRegions);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+                new TypeReference<Result<List<AwsRegion>>>() { });\n+    }\n+\n+    @Test\n+    public void shouldFailLoadAllRegionsInfoForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(LOAD_REGIONS_INFO_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadAllRegionsInfo() throws Exception {\n+        final CloudRegionInfo awsRegionInfo = new CloudRegionInfo(awsRegion);\n+        final List<CloudRegionInfo> cloudRegionInfos = Collections.singletonList(awsRegionInfo);\n+\n+        Mockito.doReturn(cloudRegionInfos).when(mockCloudRegionApiService).loadAllRegionsInfo();\n+\n+        final MvcResult mvcResult = mvc().perform(get(LOAD_REGIONS_INFO_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadAllRegionsInfo();\n+\n+        final ResponseResult<List<CloudRegionInfo>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudRegionInfos);\n+\n+        final String actual= mvcResult.getResponse().getContentAsString();\n+        Assert.assertTrue(StringUtils.isNotBlank(actual));\n+        Assertions.assertThat(actual).isEqualToIgnoringWhitespace(getObjectMapper().writeValueAsString(expectedResult));\n+\n+        final Result<List<AbstractCloudRegion>> actualResult =", "originalCommit": "19fc1f53ace3a35ac810c265a79386d99c9451ec", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f0ab3900701f60a72970e2d20bf7b1f6430c0ba6", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\nindex 40d8274b6..c1f3076b6 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n\n@@ -16,24 +16,23 @@\n \n package com.epam.pipeline.controller.region;\n \n-import com.epam.pipeline.config.JsonMapper;\n+import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n+import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n+import com.epam.pipeline.entity.region.AzureRegion;\n+import com.epam.pipeline.entity.region.GCPRegion;\n+import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n import com.epam.pipeline.test.web.AbstractControllerTest;\n import com.epam.pipeline.controller.ResponseResult;\n import com.epam.pipeline.controller.Result;\n import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n import com.epam.pipeline.entity.info.CloudRegionInfo;\n-import com.epam.pipeline.entity.region.AbstractCloudRegion;\n import com.epam.pipeline.entity.region.AwsRegion;\n import com.epam.pipeline.entity.region.CloudProvider;\n import com.epam.pipeline.manager.region.CloudRegionApiService;\n import com.epam.pipeline.util.ControllerTestUtils;\n import com.fasterxml.jackson.core.type.TypeReference;\n-import org.apache.commons.lang3.StringUtils;\n-import org.assertj.core.api.Assertions;\n-import org.junit.Assert;\n import org.junit.Before;\n import org.junit.Test;\n-import org.mockito.ArgumentCaptor;\n import org.mockito.Mockito;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIyOTI3OQ==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r498229279", "bodyText": "Could you please replace constructor creation with @NoArgsConstructor?", "author": "ekazachkova", "createdAt": "2020-10-01T13:07:20Z", "path": "api/src/main/java/com/epam/pipeline/entity/info/CloudRegionInfo.java", "diffHunk": "@@ -18,15 +18,19 @@\n \n import com.epam.pipeline.entity.region.AbstractCloudRegion;\n import com.epam.pipeline.entity.region.CloudProvider;\n-import lombok.Value;\n+import lombok.Data;\n \n-@Value\n+@Data\n public class CloudRegionInfo {\n \n-    private final Long id;\n-    private final String name;\n-    private final CloudProvider provider;\n-    private final String regionId;\n+    private Long id;\n+    private String name;\n+    private CloudProvider provider;\n+    private String regionId;\n+\n+    public CloudRegionInfo() {", "originalCommit": "cd1167ee7a9470cf2122e42a02e3a0cc48778b8d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f0ab3900701f60a72970e2d20bf7b1f6430c0ba6", "chunk": "diff --git a/api/src/main/java/com/epam/pipeline/entity/info/CloudRegionInfo.java b/api/src/main/java/com/epam/pipeline/entity/info/CloudRegionInfo.java\nindex 83dd11245..e13040047 100644\n--- a/api/src/main/java/com/epam/pipeline/entity/info/CloudRegionInfo.java\n+++ b/api/src/main/java/com/epam/pipeline/entity/info/CloudRegionInfo.java\n\n@@ -19,8 +19,10 @@ package com.epam.pipeline.entity.info;\n import com.epam.pipeline.entity.region.AbstractCloudRegion;\n import com.epam.pipeline.entity.region.CloudProvider;\n import lombok.Data;\n+import lombok.NoArgsConstructor;\n \n @Data\n+@NoArgsConstructor\n public class CloudRegionInfo {\n \n     private Long id;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIzMDM1NA==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r498230354", "bodyText": "Are this constants shall be public?", "author": "ekazachkova", "createdAt": "2020-10-01T13:08:58Z", "path": "api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java", "diffHunk": "@@ -0,0 +1,322 @@\n+/*\n+ * Copyright 2017-2020 EPAM Systems, Inc. (https://www.epam.com/)\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.epam.pipeline.controller.region;\n+\n+import com.epam.pipeline.test.web.AbstractControllerTest;\n+import com.epam.pipeline.controller.ResponseResult;\n+import com.epam.pipeline.controller.Result;\n+import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n+import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AwsRegion;\n+import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.manager.region.CloudRegionApiService;\n+import com.epam.pipeline.util.ControllerTestUtils;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import org.assertj.core.api.Assertions;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Mockito;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n+import org.springframework.security.test.context.support.WithMockUser;\n+import org.springframework.test.web.servlet.MvcResult;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n+\n+@WebMvcTest(controllers = CloudRegionController.class)\n+public class CloudRegionControllerTest extends AbstractControllerTest {\n+\n+    public static final long ID = 1L;", "originalCommit": "cd1167ee7a9470cf2122e42a02e3a0cc48778b8d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f0ab3900701f60a72970e2d20bf7b1f6430c0ba6", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\nindex 04ed6653d..c1f3076b6 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n\n@@ -16,6 +16,11 @@\n \n package com.epam.pipeline.controller.region;\n \n+import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n+import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n+import com.epam.pipeline.entity.region.AzureRegion;\n+import com.epam.pipeline.entity.region.GCPRegion;\n+import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n import com.epam.pipeline.test.web.AbstractControllerTest;\n import com.epam.pipeline.controller.ResponseResult;\n import com.epam.pipeline.controller.Result;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNzQ5Nw==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r501117497", "bodyText": "Could you please move constants to fields as much as it possible to avoid magic values?\nDo not forget to add final", "author": "ekazachkova", "createdAt": "2020-10-07T15:44:08Z", "path": "api/src/test/java/com/epam/pipeline/controller/region/RegionCreatorUtils.java", "diffHunk": "@@ -0,0 +1,104 @@\n+/*\n+ * Copyright 2017-2020 EPAM Systems, Inc. (https://www.epam.com/)\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.epam.pipeline.controller.region;\n+\n+import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n+import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n+import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n+import com.epam.pipeline.entity.region.AwsRegion;\n+import com.epam.pipeline.entity.region.AzurePolicy;\n+import com.epam.pipeline.entity.region.AzureRegion;\n+import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.entity.region.GCPCustomInstanceType;\n+import com.epam.pipeline.entity.region.GCPRegion;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+public final class RegionCreatorUtils {", "originalCommit": "3f3427f566509ccc2d95175594321ecead889311", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f0ab3900701f60a72970e2d20bf7b1f6430c0ba6", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/region/RegionCreatorUtils.java b/api/src/test/java/com/epam/pipeline/test/creator/region/RegionCreatorUtils.java\nsimilarity index 52%\nrename from api/src/test/java/com/epam/pipeline/controller/region/RegionCreatorUtils.java\nrename to api/src/test/java/com/epam/pipeline/test/creator/region/RegionCreatorUtils.java\nindex 9b477b233..c50d33b90 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/region/RegionCreatorUtils.java\n+++ b/api/src/test/java/com/epam/pipeline/test/creator/region/RegionCreatorUtils.java\n\n@@ -14,7 +14,7 @@\n  * limitations under the License.\n  */\n \n-package com.epam.pipeline.controller.region;\n+package com.epam.pipeline.test.creator.region;\n \n import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTEzOTIxNg==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r501139216", "bodyText": "In general, I see no point to use argument captor here and elsewhere in this class. But if for some reasons it necessary let's discuss it.", "author": "ekazachkova", "createdAt": "2020-10-07T16:14:07Z", "path": "api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java", "diffHunk": "@@ -0,0 +1,514 @@\n+/*\n+ * Copyright 2017-2020 EPAM Systems, Inc. (https://www.epam.com/)\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.epam.pipeline.controller.region;\n+\n+import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n+import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n+import com.epam.pipeline.entity.region.AzureRegion;\n+import com.epam.pipeline.entity.region.GCPRegion;\n+import com.epam.pipeline.test.web.AbstractControllerTest;\n+import com.epam.pipeline.controller.ResponseResult;\n+import com.epam.pipeline.controller.Result;\n+import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n+import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AwsRegion;\n+import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.manager.region.CloudRegionApiService;\n+import com.epam.pipeline.util.ControllerTestUtils;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import org.assertj.core.api.Assertions;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Mockito;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n+import org.springframework.security.test.context.support.WithMockUser;\n+import org.springframework.test.web.servlet.MvcResult;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n+\n+@WebMvcTest(controllers = CloudRegionController.class)\n+public class CloudRegionControllerTest extends AbstractControllerTest {\n+\n+    private static final long ID = 1L;\n+    private static final String REGION_URL = SERVLET_PATH + \"/cloud/region\";\n+    private static final String LOAD_PROVIDERS_URL = REGION_URL + \"/provider\";\n+    private static final String LOAD_REGIONS_INFO_URL = REGION_URL + \"/info\";\n+    private static final String LOAD_AVAILABLE_REGIONS_URL = REGION_URL + \"/available\";\n+    private static final String REGION_ID_URL = REGION_URL + \"/%d\";\n+    private AwsRegion awsRegion;\n+    private AWSRegionDTO awsRegionDTO;\n+    private AzureRegion azureRegion;\n+    private AzureRegionDTO azureRegionDTO;\n+    private GCPRegion gcpRegion;\n+    private GCPRegionDTO gcpRegionDTO;\n+    private ResponseResult<AwsRegion> expectedAwsRegionResult;\n+    private ResponseResult<AzureRegion> expectedAzureResult;\n+    private ResponseResult<GCPRegion> expectedGcpResult;\n+\n+    @Autowired\n+    private CloudRegionApiService mockCloudRegionApiService;\n+\n+    @Before\n+    public void setUp() {\n+        awsRegion = RegionCreatorUtils.getDefaultAwsRegion();\n+        azureRegion = RegionCreatorUtils.getDefaultAzureRegion();\n+        gcpRegion = RegionCreatorUtils.getDefaultGcpRegion();\n+\n+        awsRegionDTO = RegionCreatorUtils.getDefaultAwsRegionDTO();\n+        azureRegionDTO = RegionCreatorUtils.getDefaultAzureRegionDTO();\n+        gcpRegionDTO = RegionCreatorUtils.getDefaultGcpRegionDTO();\n+\n+        expectedAwsRegionResult = ControllerTestUtils.buildExpectedResult(awsRegion);\n+        expectedAzureResult = ControllerTestUtils.buildExpectedResult(azureRegion);\n+        expectedGcpResult = ControllerTestUtils.buildExpectedResult(gcpRegion);\n+    }\n+\n+    @Test\n+    public void shouldFailLoadProvidersForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadProviders() throws Exception {\n+        final List<CloudProvider> cloudProviders = Collections.singletonList(CloudProvider.AWS);\n+\n+        Mockito.doReturn(cloudProviders).when(mockCloudRegionApiService).loadProviders();\n+\n+        final MvcResult mvcResult = mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadProviders();\n+\n+        final ResponseResult<List<CloudProvider>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudProviders);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+                new TypeReference<Result<List<CloudProvider>>>() { });\n+    }\n+\n+    @Test\n+    public void shouldFailLoadAllForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(REGION_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadAll() throws Exception {\n+        final List<AwsRegion> cloudRegions = Collections.singletonList(awsRegion);\n+\n+        Mockito.doReturn(cloudRegions).when(mockCloudRegionApiService).loadAll();\n+\n+        final MvcResult mvcResult = mvc().perform(get(REGION_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadAll();\n+\n+        final ResponseResult<List<AwsRegion>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudRegions);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+                new TypeReference<Result<List<AwsRegion>>>() { });\n+    }\n+\n+    @Test\n+    public void shouldFailLoadAllRegionsInfoForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(LOAD_REGIONS_INFO_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadAllRegionsInfo() throws Exception {\n+        final CloudRegionInfo awsRegionInfo = new CloudRegionInfo(awsRegion);\n+        final List<CloudRegionInfo> cloudRegionInfos = Collections.singletonList(awsRegionInfo);\n+\n+        Mockito.doReturn(cloudRegionInfos).when(mockCloudRegionApiService).loadAllRegionsInfo();\n+\n+        final MvcResult mvcResult = mvc().perform(get(LOAD_REGIONS_INFO_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadAllRegionsInfo();\n+\n+        final ResponseResult<List<CloudRegionInfo>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudRegionInfos);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+                new TypeReference<Result<List<CloudRegionInfo>>>() { });\n+    }\n+\n+    @Test\n+    public void shouldFailLoadForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(String.format(REGION_ID_URL, ID))\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadAwsRegionById() throws Exception{\n+        Mockito.doReturn(awsRegion).when(mockCloudRegionApiService).load(ID);\n+\n+        final MvcResult mvcResult = mvc().perform(get(String.format(REGION_ID_URL, ID))\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        final ArgumentCaptor<Long> longCaptor = ArgumentCaptor.forClass(Long.class);\n+        Mockito.verify(mockCloudRegionApiService).load(longCaptor.capture());\n+        Assertions.assertThat(longCaptor.getValue()).isEqualTo(ID);\n+\n+        Mockito.verify(mockCloudRegionApiService).load(ID);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedAwsRegionResult,\n+                new TypeReference<Result<AwsRegion>>() { });\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadAzureRegionById() throws Exception{\n+        Mockito.doReturn(azureRegion).when(mockCloudRegionApiService).load(ID);\n+\n+        final MvcResult mvcResult = mvc().perform(get(String.format(REGION_ID_URL, ID))\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        final ArgumentCaptor<Long> longCaptor = ArgumentCaptor.forClass(Long.class);\n+        Mockito.verify(mockCloudRegionApiService).load(longCaptor.capture());\n+        Assertions.assertThat(longCaptor.getValue()).isEqualTo(ID);\n+\n+        Mockito.verify(mockCloudRegionApiService).load(ID);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedAzureResult,\n+                new TypeReference<Result<AzureRegion>>() { });\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadGcpRegionById() throws Exception{\n+        Mockito.doReturn(gcpRegion).when(mockCloudRegionApiService).load(ID);\n+\n+        final MvcResult mvcResult = mvc().perform(get(String.format(REGION_ID_URL, ID))\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        final ArgumentCaptor<Long> longCaptor = ArgumentCaptor.forClass(Long.class);\n+        Mockito.verify(mockCloudRegionApiService).load(longCaptor.capture());\n+        Assertions.assertThat(longCaptor.getValue()).isEqualTo(ID);\n+\n+        Mockito.verify(mockCloudRegionApiService).load(ID);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedGcpResult,\n+                new TypeReference<Result<GCPRegion>>() { });\n+    }\n+\n+    @Test\n+    public void shouldFailLoadAllAvailableRegionsForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(LOAD_AVAILABLE_REGIONS_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadAllAvailableRegions() throws Exception {\n+        final List<String> regions = Collections.singletonList(\"testRegion\");\n+        Mockito.doReturn(regions).when(mockCloudRegionApiService).loadAllAvailable(CloudProvider.AWS);\n+\n+        final MvcResult mvcResult = mvc().perform(get(LOAD_AVAILABLE_REGIONS_URL)\n+                .param(\"provider\", CloudProvider.AWS.name())\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        final ArgumentCaptor<CloudProvider> cloudProviderCaptor = ArgumentCaptor.forClass(CloudProvider.class);\n+        Mockito.verify(mockCloudRegionApiService).loadAllAvailable(cloudProviderCaptor.capture());\n+        Assertions.assertThat(cloudProviderCaptor.getValue()).isEqualTo(CloudProvider.AWS);\n+\n+        Mockito.verify(mockCloudRegionApiService).loadAllAvailable(CloudProvider.AWS);\n+\n+        final ResponseResult<List<String>> expectedResult = ControllerTestUtils.buildExpectedResult(regions);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+                new TypeReference<Result<List<String>>>() { });\n+    }\n+\n+    @Test\n+    public void shouldFailCreateForUnauthorizedUser() throws Exception {\n+        mvc().perform(post(REGION_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldCreateAwsRegion() throws Exception {\n+        Mockito.doReturn(awsRegion).when(mockCloudRegionApiService).create(Mockito.refEq(awsRegionDTO));\n+\n+        final MvcResult mvcResult = mvc().perform(post(REGION_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE)\n+                .content(getObjectMapper().writeValueAsString(awsRegionDTO)))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        final ArgumentCaptor<AWSRegionDTO> awsRegionDTOCaptor = ArgumentCaptor.forClass(AWSRegionDTO.class);\n+        Mockito.verify(mockCloudRegionApiService).create(awsRegionDTOCaptor.capture());\n+        Assertions.assertThat(awsRegionDTOCaptor.getValue()).isEqualToComparingFieldByField(awsRegionDTO);\n+\n+        Mockito.verify(mockCloudRegionApiService).create(Mockito.refEq(awsRegionDTO));\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedAwsRegionResult,\n+                new TypeReference<Result<AwsRegion>>() { });\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldCreateAzureRegion() throws Exception {\n+        Mockito.doReturn(azureRegion).when(mockCloudRegionApiService).create(Mockito.refEq(azureRegionDTO));\n+\n+        final MvcResult mvcResult = mvc().perform(post(REGION_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE)\n+                .content(getObjectMapper().writeValueAsString(azureRegionDTO)))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        final ArgumentCaptor<AzureRegionDTO> azureRegionDTOCaptor = ArgumentCaptor.forClass(AzureRegionDTO.class);\n+        Mockito.verify(mockCloudRegionApiService).create(azureRegionDTOCaptor.capture());\n+        Assertions.assertThat(azureRegionDTOCaptor.getValue().getAuthFile())\n+                .isEqualTo(azureRegionDTO.getAuthFile());\n+\n+        Mockito.verify(mockCloudRegionApiService).create(Mockito.refEq(azureRegionDTO));\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedAzureResult,\n+                new TypeReference<Result<AzureRegion>>() { });\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldCreateGcpRegion() throws Exception {\n+        Mockito.doReturn(gcpRegion).when(mockCloudRegionApiService).create(Mockito.refEq(gcpRegionDTO));\n+\n+        final MvcResult mvcResult = mvc().perform(post(REGION_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE)\n+                .content(getObjectMapper().writeValueAsString(gcpRegionDTO)))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        final ArgumentCaptor<GCPRegionDTO> gcpRegionDTOCaptor = ArgumentCaptor.forClass(GCPRegionDTO.class);", "originalCommit": "3f3427f566509ccc2d95175594321ecead889311", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f0ab3900701f60a72970e2d20bf7b1f6430c0ba6", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\nindex 98a391ad6..c1f3076b6 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n\n@@ -20,6 +20,7 @@ import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n import com.epam.pipeline.entity.region.AzureRegion;\n import com.epam.pipeline.entity.region.GCPRegion;\n+import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n import com.epam.pipeline.test.web.AbstractControllerTest;\n import com.epam.pipeline.controller.ResponseResult;\n import com.epam.pipeline.controller.Result;\n"}}, {"oid": "f0ab3900701f60a72970e2d20bf7b1f6430c0ba6", "url": "https://github.com/epam/cloud-pipeline/commit/f0ab3900701f60a72970e2d20bf7b1f6430c0ba6", "message": "Issue #1405: RegionCreatorUtils moved to creator package, created constant fields", "committedDate": "2020-10-09T09:55:54Z", "type": "forcePushed"}, {"oid": "183e3deea861b11c422687ac26539d26931f833b", "url": "https://github.com/epam/cloud-pipeline/commit/183e3deea861b11c422687ac26539d26931f833b", "message": "Issue #1405: Fixed CloudRegionApiService import", "committedDate": "2020-10-09T13:17:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQwOTI0Mw==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r503409243", "bodyText": "Maybe we should consider implementation common method to avoid such routine? Also, it would be grate to add same method for unauthorized case.", "author": "ekazachkova", "createdAt": "2020-10-12T16:33:33Z", "path": "api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java", "diffHunk": "@@ -0,0 +1,460 @@\n+/*\n+ * Copyright 2017-2020 EPAM Systems, Inc. (https://www.epam.com/)\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.epam.pipeline.controller.region;\n+\n+import com.epam.pipeline.acl.region.CloudRegionApiService;\n+import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n+import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n+import com.epam.pipeline.entity.region.AzureRegion;\n+import com.epam.pipeline.entity.region.GCPRegion;\n+import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n+import com.epam.pipeline.test.web.AbstractControllerTest;\n+import com.epam.pipeline.controller.ResponseResult;\n+import com.epam.pipeline.controller.Result;\n+import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n+import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AwsRegion;\n+import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.util.ControllerTestUtils;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n+import org.springframework.security.test.context.support.WithMockUser;\n+import org.springframework.test.web.servlet.MvcResult;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n+\n+@WebMvcTest(controllers = CloudRegionController.class)\n+public class CloudRegionControllerTest extends AbstractControllerTest {\n+\n+    private static final long ID = 1L;\n+    private static final String TEST_STRING = \"TEST\";\n+    private static final String REGION_URL = SERVLET_PATH + \"/cloud/region\";\n+    private static final String LOAD_PROVIDERS_URL = REGION_URL + \"/provider\";\n+    private static final String LOAD_REGIONS_INFO_URL = REGION_URL + \"/info\";\n+    private static final String LOAD_AVAILABLE_REGIONS_URL = REGION_URL + \"/available\";\n+    private static final String REGION_ID_URL = REGION_URL + \"/%d\";\n+    private AwsRegion awsRegion;\n+    private AWSRegionDTO awsRegionDTO;\n+    private AzureRegion azureRegion;\n+    private AzureRegionDTO azureRegionDTO;\n+    private GCPRegion gcpRegion;\n+    private GCPRegionDTO gcpRegionDTO;\n+    private ResponseResult<AwsRegion> expectedAwsRegionResult;\n+    private ResponseResult<AzureRegion> expectedAzureResult;\n+    private ResponseResult<GCPRegion> expectedGcpResult;\n+\n+    @Autowired\n+    private CloudRegionApiService mockCloudRegionApiService;\n+\n+    @Before\n+    public void setUp() {\n+        awsRegion = RegionCreatorUtils.getDefaultAwsRegion();\n+        azureRegion = RegionCreatorUtils.getDefaultAzureRegion();\n+        gcpRegion = RegionCreatorUtils.getDefaultGcpRegion();\n+\n+        awsRegionDTO = RegionCreatorUtils.getDefaultAwsRegionDTO();\n+        azureRegionDTO = RegionCreatorUtils.getDefaultAzureRegionDTO();\n+        gcpRegionDTO = RegionCreatorUtils.getDefaultGcpRegionDTO();\n+\n+        expectedAwsRegionResult = ControllerTestUtils.buildExpectedResult(awsRegion);\n+        expectedAzureResult = ControllerTestUtils.buildExpectedResult(azureRegion);\n+        expectedGcpResult = ControllerTestUtils.buildExpectedResult(gcpRegion);\n+    }\n+\n+    @Test\n+    public void shouldFailLoadProvidersForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadProviders() throws Exception {\n+        final List<CloudProvider> cloudProviders = Collections.singletonList(CloudProvider.AWS);\n+\n+        Mockito.doReturn(cloudProviders).when(mockCloudRegionApiService).loadProviders();\n+\n+        final MvcResult mvcResult = mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadProviders();\n+\n+        final ResponseResult<List<CloudProvider>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudProviders);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+                new TypeReference<Result<List<CloudProvider>>>() { });\n+    }\n+\n+    @Test\n+    public void shouldFailLoadAllForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(REGION_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadAll() throws Exception {\n+        final List<AwsRegion> cloudRegions = Collections.singletonList(awsRegion);\n+\n+        Mockito.doReturn(cloudRegions).when(mockCloudRegionApiService).loadAll();\n+\n+        final MvcResult mvcResult = mvc().perform(get(REGION_URL)", "originalCommit": "183e3deea861b11c422687ac26539d26931f833b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\nindex 009c14bab..40d8274b6 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n\n@@ -16,23 +16,24 @@\n \n package com.epam.pipeline.controller.region;\n \n-import com.epam.pipeline.acl.region.CloudRegionApiService;\n-import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n-import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n-import com.epam.pipeline.entity.region.AzureRegion;\n-import com.epam.pipeline.entity.region.GCPRegion;\n-import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n+import com.epam.pipeline.config.JsonMapper;\n import com.epam.pipeline.test.web.AbstractControllerTest;\n import com.epam.pipeline.controller.ResponseResult;\n import com.epam.pipeline.controller.Result;\n import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AbstractCloudRegion;\n import com.epam.pipeline.entity.region.AwsRegion;\n import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.manager.region.CloudRegionApiService;\n import com.epam.pipeline.util.ControllerTestUtils;\n import com.fasterxml.jackson.core.type.TypeReference;\n+import org.apache.commons.lang3.StringUtils;\n+import org.assertj.core.api.Assertions;\n+import org.junit.Assert;\n import org.junit.Before;\n import org.junit.Test;\n+import org.mockito.ArgumentCaptor;\n import org.mockito.Mockito;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQxMjQ0Mg==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r503412442", "bodyText": "Could we move it to class fields to reuse? (new TypeReference<Result<List<AwsRegion>>>() { })", "author": "ekazachkova", "createdAt": "2020-10-12T16:39:35Z", "path": "api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java", "diffHunk": "@@ -0,0 +1,460 @@\n+/*\n+ * Copyright 2017-2020 EPAM Systems, Inc. (https://www.epam.com/)\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.epam.pipeline.controller.region;\n+\n+import com.epam.pipeline.acl.region.CloudRegionApiService;\n+import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n+import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n+import com.epam.pipeline.entity.region.AzureRegion;\n+import com.epam.pipeline.entity.region.GCPRegion;\n+import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n+import com.epam.pipeline.test.web.AbstractControllerTest;\n+import com.epam.pipeline.controller.ResponseResult;\n+import com.epam.pipeline.controller.Result;\n+import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n+import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AwsRegion;\n+import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.util.ControllerTestUtils;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n+import org.springframework.security.test.context.support.WithMockUser;\n+import org.springframework.test.web.servlet.MvcResult;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n+\n+@WebMvcTest(controllers = CloudRegionController.class)\n+public class CloudRegionControllerTest extends AbstractControllerTest {\n+\n+    private static final long ID = 1L;\n+    private static final String TEST_STRING = \"TEST\";\n+    private static final String REGION_URL = SERVLET_PATH + \"/cloud/region\";\n+    private static final String LOAD_PROVIDERS_URL = REGION_URL + \"/provider\";\n+    private static final String LOAD_REGIONS_INFO_URL = REGION_URL + \"/info\";\n+    private static final String LOAD_AVAILABLE_REGIONS_URL = REGION_URL + \"/available\";\n+    private static final String REGION_ID_URL = REGION_URL + \"/%d\";\n+    private AwsRegion awsRegion;\n+    private AWSRegionDTO awsRegionDTO;\n+    private AzureRegion azureRegion;\n+    private AzureRegionDTO azureRegionDTO;\n+    private GCPRegion gcpRegion;\n+    private GCPRegionDTO gcpRegionDTO;\n+    private ResponseResult<AwsRegion> expectedAwsRegionResult;\n+    private ResponseResult<AzureRegion> expectedAzureResult;\n+    private ResponseResult<GCPRegion> expectedGcpResult;\n+\n+    @Autowired\n+    private CloudRegionApiService mockCloudRegionApiService;\n+\n+    @Before\n+    public void setUp() {\n+        awsRegion = RegionCreatorUtils.getDefaultAwsRegion();\n+        azureRegion = RegionCreatorUtils.getDefaultAzureRegion();\n+        gcpRegion = RegionCreatorUtils.getDefaultGcpRegion();\n+\n+        awsRegionDTO = RegionCreatorUtils.getDefaultAwsRegionDTO();\n+        azureRegionDTO = RegionCreatorUtils.getDefaultAzureRegionDTO();\n+        gcpRegionDTO = RegionCreatorUtils.getDefaultGcpRegionDTO();\n+\n+        expectedAwsRegionResult = ControllerTestUtils.buildExpectedResult(awsRegion);\n+        expectedAzureResult = ControllerTestUtils.buildExpectedResult(azureRegion);\n+        expectedGcpResult = ControllerTestUtils.buildExpectedResult(gcpRegion);\n+    }\n+\n+    @Test\n+    public void shouldFailLoadProvidersForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadProviders() throws Exception {\n+        final List<CloudProvider> cloudProviders = Collections.singletonList(CloudProvider.AWS);\n+\n+        Mockito.doReturn(cloudProviders).when(mockCloudRegionApiService).loadProviders();\n+\n+        final MvcResult mvcResult = mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadProviders();\n+\n+        final ResponseResult<List<CloudProvider>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudProviders);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+                new TypeReference<Result<List<CloudProvider>>>() { });\n+    }\n+\n+    @Test\n+    public void shouldFailLoadAllForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(REGION_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadAll() throws Exception {\n+        final List<AwsRegion> cloudRegions = Collections.singletonList(awsRegion);\n+\n+        Mockito.doReturn(cloudRegions).when(mockCloudRegionApiService).loadAll();\n+\n+        final MvcResult mvcResult = mvc().perform(get(REGION_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadAll();\n+\n+        final ResponseResult<List<AwsRegion>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudRegions);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+                new TypeReference<Result<List<AwsRegion>>>() { });", "originalCommit": "183e3deea861b11c422687ac26539d26931f833b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\nindex 009c14bab..40d8274b6 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n\n@@ -16,23 +16,24 @@\n \n package com.epam.pipeline.controller.region;\n \n-import com.epam.pipeline.acl.region.CloudRegionApiService;\n-import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n-import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n-import com.epam.pipeline.entity.region.AzureRegion;\n-import com.epam.pipeline.entity.region.GCPRegion;\n-import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n+import com.epam.pipeline.config.JsonMapper;\n import com.epam.pipeline.test.web.AbstractControllerTest;\n import com.epam.pipeline.controller.ResponseResult;\n import com.epam.pipeline.controller.Result;\n import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AbstractCloudRegion;\n import com.epam.pipeline.entity.region.AwsRegion;\n import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.manager.region.CloudRegionApiService;\n import com.epam.pipeline.util.ControllerTestUtils;\n import com.fasterxml.jackson.core.type.TypeReference;\n+import org.apache.commons.lang3.StringUtils;\n+import org.assertj.core.api.Assertions;\n+import org.junit.Assert;\n import org.junit.Before;\n import org.junit.Test;\n+import org.mockito.ArgumentCaptor;\n import org.mockito.Mockito;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzY2ODcxNw==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r503668717", "bodyText": "Let's get rid of the setUp method and move all the assignments right to the declarations to keep everything simple.\npublic class CloudRegionControllerTest extends AbstractControllerTest {\n    ...\n    private final AwsRegion awsRegion = RegionCreatorUtils.getDefaultAwsRegion();\n    ...\n}", "author": "tcibinan", "createdAt": "2020-10-13T05:04:28Z", "path": "api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java", "diffHunk": "@@ -0,0 +1,460 @@\n+/*\n+ * Copyright 2017-2020 EPAM Systems, Inc. (https://www.epam.com/)\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.epam.pipeline.controller.region;\n+\n+import com.epam.pipeline.acl.region.CloudRegionApiService;\n+import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n+import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n+import com.epam.pipeline.entity.region.AzureRegion;\n+import com.epam.pipeline.entity.region.GCPRegion;\n+import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n+import com.epam.pipeline.test.web.AbstractControllerTest;\n+import com.epam.pipeline.controller.ResponseResult;\n+import com.epam.pipeline.controller.Result;\n+import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n+import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AwsRegion;\n+import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.util.ControllerTestUtils;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n+import org.springframework.security.test.context.support.WithMockUser;\n+import org.springframework.test.web.servlet.MvcResult;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n+\n+@WebMvcTest(controllers = CloudRegionController.class)\n+public class CloudRegionControllerTest extends AbstractControllerTest {\n+\n+    private static final long ID = 1L;\n+    private static final String TEST_STRING = \"TEST\";\n+    private static final String REGION_URL = SERVLET_PATH + \"/cloud/region\";\n+    private static final String LOAD_PROVIDERS_URL = REGION_URL + \"/provider\";\n+    private static final String LOAD_REGIONS_INFO_URL = REGION_URL + \"/info\";\n+    private static final String LOAD_AVAILABLE_REGIONS_URL = REGION_URL + \"/available\";\n+    private static final String REGION_ID_URL = REGION_URL + \"/%d\";\n+    private AwsRegion awsRegion;\n+    private AWSRegionDTO awsRegionDTO;\n+    private AzureRegion azureRegion;\n+    private AzureRegionDTO azureRegionDTO;\n+    private GCPRegion gcpRegion;\n+    private GCPRegionDTO gcpRegionDTO;\n+    private ResponseResult<AwsRegion> expectedAwsRegionResult;\n+    private ResponseResult<AzureRegion> expectedAzureResult;\n+    private ResponseResult<GCPRegion> expectedGcpResult;\n+\n+    @Autowired\n+    private CloudRegionApiService mockCloudRegionApiService;\n+\n+    @Before\n+    public void setUp() {\n+        awsRegion = RegionCreatorUtils.getDefaultAwsRegion();\n+        azureRegion = RegionCreatorUtils.getDefaultAzureRegion();\n+        gcpRegion = RegionCreatorUtils.getDefaultGcpRegion();\n+\n+        awsRegionDTO = RegionCreatorUtils.getDefaultAwsRegionDTO();\n+        azureRegionDTO = RegionCreatorUtils.getDefaultAzureRegionDTO();\n+        gcpRegionDTO = RegionCreatorUtils.getDefaultGcpRegionDTO();\n+\n+        expectedAwsRegionResult = ControllerTestUtils.buildExpectedResult(awsRegion);\n+        expectedAzureResult = ControllerTestUtils.buildExpectedResult(azureRegion);\n+        expectedGcpResult = ControllerTestUtils.buildExpectedResult(gcpRegion);\n+    }", "originalCommit": "183e3deea861b11c422687ac26539d26931f833b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\nindex 009c14bab..40d8274b6 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n\n@@ -16,23 +16,24 @@\n \n package com.epam.pipeline.controller.region;\n \n-import com.epam.pipeline.acl.region.CloudRegionApiService;\n-import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n-import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n-import com.epam.pipeline.entity.region.AzureRegion;\n-import com.epam.pipeline.entity.region.GCPRegion;\n-import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n+import com.epam.pipeline.config.JsonMapper;\n import com.epam.pipeline.test.web.AbstractControllerTest;\n import com.epam.pipeline.controller.ResponseResult;\n import com.epam.pipeline.controller.Result;\n import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AbstractCloudRegion;\n import com.epam.pipeline.entity.region.AwsRegion;\n import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.manager.region.CloudRegionApiService;\n import com.epam.pipeline.util.ControllerTestUtils;\n import com.fasterxml.jackson.core.type.TypeReference;\n+import org.apache.commons.lang3.StringUtils;\n+import org.assertj.core.api.Assertions;\n+import org.junit.Assert;\n import org.junit.Before;\n import org.junit.Test;\n+import org.mockito.ArgumentCaptor;\n import org.mockito.Mockito;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczMTcwNQ==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r503731705", "bodyText": "It looks like all the calls to ControllerTestUtils.assertResponse in this test class as well as all the others have the same second argument. Moreover in order to use assertResponse expected result should be built beforehand using ControllerTestUtils.buildExpectedResult method.\nI suppose we can introduce overloaded ControllerTestUtils.assertResponse method with only three arguments which builds expected result and compares it with an actual result. In order to do that ControllerTestUtils can be transformed to a regular bean.\nWhat do you think @ekazachkova? Does it worth trying?", "author": "tcibinan", "createdAt": "2020-10-13T07:38:40Z", "path": "api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java", "diffHunk": "@@ -0,0 +1,460 @@\n+/*\n+ * Copyright 2017-2020 EPAM Systems, Inc. (https://www.epam.com/)\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.epam.pipeline.controller.region;\n+\n+import com.epam.pipeline.acl.region.CloudRegionApiService;\n+import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n+import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n+import com.epam.pipeline.entity.region.AzureRegion;\n+import com.epam.pipeline.entity.region.GCPRegion;\n+import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n+import com.epam.pipeline.test.web.AbstractControllerTest;\n+import com.epam.pipeline.controller.ResponseResult;\n+import com.epam.pipeline.controller.Result;\n+import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n+import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AwsRegion;\n+import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.util.ControllerTestUtils;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n+import org.springframework.security.test.context.support.WithMockUser;\n+import org.springframework.test.web.servlet.MvcResult;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n+\n+@WebMvcTest(controllers = CloudRegionController.class)\n+public class CloudRegionControllerTest extends AbstractControllerTest {\n+\n+    private static final long ID = 1L;\n+    private static final String TEST_STRING = \"TEST\";\n+    private static final String REGION_URL = SERVLET_PATH + \"/cloud/region\";\n+    private static final String LOAD_PROVIDERS_URL = REGION_URL + \"/provider\";\n+    private static final String LOAD_REGIONS_INFO_URL = REGION_URL + \"/info\";\n+    private static final String LOAD_AVAILABLE_REGIONS_URL = REGION_URL + \"/available\";\n+    private static final String REGION_ID_URL = REGION_URL + \"/%d\";\n+    private AwsRegion awsRegion;\n+    private AWSRegionDTO awsRegionDTO;\n+    private AzureRegion azureRegion;\n+    private AzureRegionDTO azureRegionDTO;\n+    private GCPRegion gcpRegion;\n+    private GCPRegionDTO gcpRegionDTO;\n+    private ResponseResult<AwsRegion> expectedAwsRegionResult;\n+    private ResponseResult<AzureRegion> expectedAzureResult;\n+    private ResponseResult<GCPRegion> expectedGcpResult;\n+\n+    @Autowired\n+    private CloudRegionApiService mockCloudRegionApiService;\n+\n+    @Before\n+    public void setUp() {\n+        awsRegion = RegionCreatorUtils.getDefaultAwsRegion();\n+        azureRegion = RegionCreatorUtils.getDefaultAzureRegion();\n+        gcpRegion = RegionCreatorUtils.getDefaultGcpRegion();\n+\n+        awsRegionDTO = RegionCreatorUtils.getDefaultAwsRegionDTO();\n+        azureRegionDTO = RegionCreatorUtils.getDefaultAzureRegionDTO();\n+        gcpRegionDTO = RegionCreatorUtils.getDefaultGcpRegionDTO();\n+\n+        expectedAwsRegionResult = ControllerTestUtils.buildExpectedResult(awsRegion);\n+        expectedAzureResult = ControllerTestUtils.buildExpectedResult(azureRegion);\n+        expectedGcpResult = ControllerTestUtils.buildExpectedResult(gcpRegion);\n+    }\n+\n+    @Test\n+    public void shouldFailLoadProvidersForUnauthorizedUser() throws Exception {\n+        mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n+    }\n+\n+    @Test\n+    @WithMockUser\n+    public void shouldLoadProviders() throws Exception {\n+        final List<CloudProvider> cloudProviders = Collections.singletonList(CloudProvider.AWS);\n+\n+        Mockito.doReturn(cloudProviders).when(mockCloudRegionApiService).loadProviders();\n+\n+        final MvcResult mvcResult = mvc().perform(get(LOAD_PROVIDERS_URL)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n+\n+        Mockito.verify(mockCloudRegionApiService).loadProviders();\n+\n+        final ResponseResult<List<CloudProvider>> expectedResult =\n+                ControllerTestUtils.buildExpectedResult(cloudProviders);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,", "originalCommit": "183e3deea861b11c422687ac26539d26931f833b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzgwODA5Ng==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r503808096", "bodyText": "@tcibinan  Great idea! Let's implement it.", "author": "ekazachkova", "createdAt": "2020-10-13T09:34:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczMTcwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\nindex 009c14bab..40d8274b6 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/region/CloudRegionControllerTest.java\n\n@@ -16,23 +16,24 @@\n \n package com.epam.pipeline.controller.region;\n \n-import com.epam.pipeline.acl.region.CloudRegionApiService;\n-import com.epam.pipeline.controller.vo.region.AzureRegionDTO;\n-import com.epam.pipeline.controller.vo.region.GCPRegionDTO;\n-import com.epam.pipeline.entity.region.AzureRegion;\n-import com.epam.pipeline.entity.region.GCPRegion;\n-import com.epam.pipeline.test.creator.region.RegionCreatorUtils;\n+import com.epam.pipeline.config.JsonMapper;\n import com.epam.pipeline.test.web.AbstractControllerTest;\n import com.epam.pipeline.controller.ResponseResult;\n import com.epam.pipeline.controller.Result;\n import com.epam.pipeline.controller.vo.region.AWSRegionDTO;\n import com.epam.pipeline.entity.info.CloudRegionInfo;\n+import com.epam.pipeline.entity.region.AbstractCloudRegion;\n import com.epam.pipeline.entity.region.AwsRegion;\n import com.epam.pipeline.entity.region.CloudProvider;\n+import com.epam.pipeline.manager.region.CloudRegionApiService;\n import com.epam.pipeline.util.ControllerTestUtils;\n import com.fasterxml.jackson.core.type.TypeReference;\n+import org.apache.commons.lang3.StringUtils;\n+import org.assertj.core.api.Assertions;\n+import org.junit.Assert;\n import org.junit.Before;\n import org.junit.Test;\n+import org.mockito.ArgumentCaptor;\n import org.mockito.Mockito;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDYwOTIyOQ==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r504609229", "bodyText": "Let's remove ControllerTestUtils class and place all it's methods to  AbstractControllerTest", "author": "ekazachkova", "createdAt": "2020-10-14T11:42:08Z", "path": "api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java", "diffHunk": "@@ -59,12 +55,16 @@\n                                                 \"\\\"loadDetails\\\":true,\" +\n                                                 \"\\\"pageSize\\\":5,\" +\n                                                 \"\\\"pageNum\\\":1}\";\n+    private static final MultiValueMap<String, String> EMPTY_PARAMS = new LinkedMultiValueMap<>();\n     private BillingChartRequest billingChartRequest;\n     private List<BillingChartInfo> billingChartInfos;\n \n     @Autowired\n     private BillingApiService mockBillingApiService;\n \n+    @Autowired\n+    private ControllerTestUtils controllerTestUtils;", "originalCommit": "ffd2eb10f613520d9c3bbc48e84b7ca3306f22f0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\nindex 164a32491..ed7a925a4 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\n\n@@ -55,16 +59,12 @@ public class BillingControllerTest extends AbstractControllerTest {\n                                                 \"\\\"loadDetails\\\":true,\" +\n                                                 \"\\\"pageSize\\\":5,\" +\n                                                 \"\\\"pageNum\\\":1}\";\n-    private static final MultiValueMap<String, String> EMPTY_PARAMS = new LinkedMultiValueMap<>();\n     private BillingChartRequest billingChartRequest;\n     private List<BillingChartInfo> billingChartInfos;\n \n     @Autowired\n     private BillingApiService mockBillingApiService;\n \n-    @Autowired\n-    private ControllerTestUtils controllerTestUtils;\n-\n     @Before\n     public void setUp() {\n         final BillingChartInfo billingChartInfo = BillingChartInfo.builder()\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDYxMTQ1OA==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r504611458", "bodyText": "Could you please pass request to method arguments (to my mind it would be more flexible):\npublic void performUnauthorizedRequest(final MockHttpServletRequestBuilder requestBuilder) throws Exception {\n        mvc.perform(requestBuilder\n                .servletPath(SERVLET_PATH))\n                .andExpect(status().isUnauthorized());\n    }\n\nThis way the method calling will be:\ncontrollerTestUtils.performUnauthorizedRequest(post(GET_BILLING_CHART_INFO_URL));", "author": "ekazachkova", "createdAt": "2020-10-14T11:46:15Z", "path": "api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java", "diffHunk": "@@ -80,38 +80,26 @@ public void setUp() {\n \n     @Test\n     public void shouldFailGetBillingChartInfoForUnauthorizedUser() throws Exception {\n-        mvc().perform(post(GET_BILLING_CHART_INFO_URL)\n-                .servletPath(SERVLET_PATH))\n-                .andExpect(status().isUnauthorized());\n+        controllerTestUtils.postRequestUnauthorized(mvc(), GET_BILLING_CHART_INFO_URL);", "originalCommit": "ffd2eb10f613520d9c3bbc48e84b7ca3306f22f0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\nindex 164a32491..ed7a925a4 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\n\n@@ -80,7 +80,9 @@ public class BillingControllerTest extends AbstractControllerTest {\n \n     @Test\n     public void shouldFailGetBillingChartInfoForUnauthorizedUser() throws Exception {\n-        controllerTestUtils.postRequestUnauthorized(mvc(), GET_BILLING_CHART_INFO_URL);\n+        mvc().perform(post(GET_BILLING_CHART_INFO_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n     }\n \n     @Test\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDYyMzMxMw==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r504623313", "bodyText": "Could you please pass request to method arguments (to my mind it would be more flexible):\npublic MvcResult performRequest(final MockHttpServletRequestBuilder requestBuilder) throws Exception {\n        return mvc.perform(requestBuilder\n                .servletPath(SERVLET_PATH)\n                .contentType(CONTENT_TYPE))\n                .andExpect(status().isOk())\n                .andExpect(MockMvcResultMatchers.content().contentType(CONTENT_TYPE))\n                .andReturn();\n    }\n\nThis way the method calling will be:\nfinal MvcResult mvcResult = controllerTestUtils\n                .performRequest(post(GET_BILLING_CHART_INFO_URL)\n                        .content(REQUEST_JSON));", "author": "ekazachkova", "createdAt": "2020-10-14T12:07:53Z", "path": "api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java", "diffHunk": "@@ -80,38 +80,26 @@ public void setUp() {\n \n     @Test\n     public void shouldFailGetBillingChartInfoForUnauthorizedUser() throws Exception {\n-        mvc().perform(post(GET_BILLING_CHART_INFO_URL)\n-                .servletPath(SERVLET_PATH))\n-                .andExpect(status().isUnauthorized());\n+        controllerTestUtils.postRequestUnauthorized(mvc(), GET_BILLING_CHART_INFO_URL);\n     }\n \n     @Test\n     @WithMockUser\n     public void shouldReturnBillingChartInfo() throws Exception {\n         Mockito.doReturn(billingChartInfos).when(mockBillingApiService).getBillingChartInfo(billingChartRequest);\n \n-        final MvcResult mvcResult = mvc().perform(post(GET_BILLING_CHART_INFO_URL)\n-                .servletPath(SERVLET_PATH)\n-                .contentType(EXPECTED_CONTENT_TYPE)\n-                .content(REQUEST_JSON))\n-                .andExpect(status().isOk())\n-                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n-                .andReturn();\n+        final MvcResult mvcResult = controllerTestUtils", "originalCommit": "ffd2eb10f613520d9c3bbc48e84b7ca3306f22f0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\nindex 164a32491..ed7a925a4 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\n\n@@ -80,7 +80,9 @@ public class BillingControllerTest extends AbstractControllerTest {\n \n     @Test\n     public void shouldFailGetBillingChartInfoForUnauthorizedUser() throws Exception {\n-        controllerTestUtils.postRequestUnauthorized(mvc(), GET_BILLING_CHART_INFO_URL);\n+        mvc().perform(post(GET_BILLING_CHART_INFO_URL)\n+                .servletPath(SERVLET_PATH))\n+                .andExpect(status().isUnauthorized());\n     }\n \n     @Test\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDYyNDMxMA==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r504624310", "bodyText": "Could you move it to class fields?", "author": "ekazachkova", "createdAt": "2020-10-14T12:09:44Z", "path": "api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java", "diffHunk": "@@ -151,18 +129,11 @@ public void shouldGetAllBillingCenters() throws Exception {\n \n         Mockito.doReturn(centers).when(mockBillingApiService).getAllBillingCenters();\n \n-        final MvcResult mvcResult = mvc().perform(get(GET_BILLING_CENTERS)\n-                .servletPath(SERVLET_PATH)\n-                .contentType(EXPECTED_CONTENT_TYPE))\n-                .andExpect(status().isOk())\n-                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n-                .andReturn();\n+        final MvcResult mvcResult = controllerTestUtils.getRequest(mvc(), GET_BILLING_CENTERS, EMPTY_PARAMS, \"\");\n \n         Mockito.verify(mockBillingApiService).getAllBillingCenters();\n \n-        final ResponseResult<List<String>> expectedResult = ControllerTestUtils.buildExpectedResult(centers);\n-\n-        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n+        controllerTestUtils.assertResponse(mvcResult, centers,\n                 new TypeReference<Result<List<String>>>() { });", "originalCommit": "ffd2eb10f613520d9c3bbc48e84b7ca3306f22f0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java b/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\nindex 164a32491..ed7a925a4 100644\n--- a/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\n+++ b/api/src/test/java/com/epam/pipeline/controller/billing/BillingControllerTest.java\n\n@@ -129,11 +151,18 @@ public class BillingControllerTest extends AbstractControllerTest {\n \n         Mockito.doReturn(centers).when(mockBillingApiService).getAllBillingCenters();\n \n-        final MvcResult mvcResult = controllerTestUtils.getRequest(mvc(), GET_BILLING_CENTERS, EMPTY_PARAMS, \"\");\n+        final MvcResult mvcResult = mvc().perform(get(GET_BILLING_CENTERS)\n+                .servletPath(SERVLET_PATH)\n+                .contentType(EXPECTED_CONTENT_TYPE))\n+                .andExpect(status().isOk())\n+                .andExpect(content().contentType(EXPECTED_CONTENT_TYPE))\n+                .andReturn();\n \n         Mockito.verify(mockBillingApiService).getAllBillingCenters();\n \n-        controllerTestUtils.assertResponse(mvcResult, centers,\n+        final ResponseResult<List<String>> expectedResult = ControllerTestUtils.buildExpectedResult(centers);\n+\n+        ControllerTestUtils.assertResponse(mvcResult, getObjectMapper(), expectedResult,\n                 new TypeReference<Result<List<String>>>() { });\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDYyNzA1OQ==", "url": "https://github.com/epam/cloud-pipeline/pull/1449#discussion_r504627059", "bodyText": "I would prefer to use constructor injection. (add @RequiredArgsConstructor and make fields public)", "author": "ekazachkova", "createdAt": "2020-10-14T12:14:28Z", "path": "api/src/test/java/com/epam/pipeline/util/ControllerTestUtils.java", "diffHunk": "@@ -21,33 +21,130 @@\n import com.epam.pipeline.controller.Result;\n import com.fasterxml.jackson.core.type.TypeReference;\n import org.apache.commons.lang3.StringUtils;\n+import org.junit.Assert;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.test.web.servlet.MockMvc;\n import org.springframework.test.web.servlet.MvcResult;\n+import org.springframework.test.web.servlet.result.MockMvcResultMatchers;\n+import org.springframework.util.MultiValueMap;\n \n import static org.assertj.core.api.Assertions.assertThat;\n-import static org.junit.Assert.assertEquals;\n-import static org.junit.Assert.assertTrue;\n \n-public final class ControllerTestUtils {\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\n+import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;\n+import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n \n-    private ControllerTestUtils() {\n-    }\n+public class ControllerTestUtils {\n+\n+    private static final String SERVLET_PATH = \"/restapi\";\n+    private static final String CONTENT_TYPE = \"application/json;charset=UTF-8\";\n \n-    public static <T> ResponseResult<T> buildExpectedResult(final T payload) {\n+    @Autowired\n+    private JsonMapper jsonMapper;", "originalCommit": "ffd2eb10f613520d9c3bbc48e84b7ca3306f22f0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "chunk": "diff --git a/api/src/test/java/com/epam/pipeline/util/ControllerTestUtils.java b/api/src/test/java/com/epam/pipeline/util/ControllerTestUtils.java\nindex cb6318af6..6a825bcd1 100644\n--- a/api/src/test/java/com/epam/pipeline/util/ControllerTestUtils.java\n+++ b/api/src/test/java/com/epam/pipeline/util/ControllerTestUtils.java\n\n@@ -21,130 +21,33 @@ import com.epam.pipeline.controller.ResponseResult;\n import com.epam.pipeline.controller.Result;\n import com.fasterxml.jackson.core.type.TypeReference;\n import org.apache.commons.lang3.StringUtils;\n-import org.junit.Assert;\n-import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.test.web.servlet.MockMvc;\n import org.springframework.test.web.servlet.MvcResult;\n-import org.springframework.test.web.servlet.result.MockMvcResultMatchers;\n-import org.springframework.util.MultiValueMap;\n \n import static org.assertj.core.api.Assertions.assertThat;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertTrue;\n \n-import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;\n-import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\n-import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\n-import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;\n-import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n+public final class ControllerTestUtils {\n \n-public class ControllerTestUtils {\n-\n-    private static final String SERVLET_PATH = \"/restapi\";\n-    private static final String CONTENT_TYPE = \"application/json;charset=UTF-8\";\n-\n-    @Autowired\n-    private JsonMapper jsonMapper;\n+    private ControllerTestUtils() {\n+    }\n \n-    public <T> ResponseResult<T> buildExpectedResult(final T payload) {\n+    public static <T> ResponseResult<T> buildExpectedResult(final T payload) {\n         final ResponseResult<T> expectedResult = new ResponseResult<>();\n         expectedResult.setStatus(\"OK\");\n         expectedResult.setPayload(payload);\n         return expectedResult;\n     }\n \n-    public <T> void assertResponse(final MvcResult mvcResult,\n+    public static <T> void assertResponse(final MvcResult mvcResult,\n                                           final JsonMapper objectMapper,\n                                           final ResponseResult<T> expectedResult,\n                                           final TypeReference<Result<T>> typeReference) throws Exception {\n         final String actual = mvcResult.getResponse().getContentAsString();\n-        Assert.assertTrue(StringUtils.isNotBlank(actual));\n+        assertTrue(StringUtils.isNotBlank(actual));\n         assertThat(actual).isEqualToIgnoringWhitespace(objectMapper.writeValueAsString(expectedResult));\n \n         final Result<T> actualResult = JsonMapper.parseData(actual, typeReference);\n-        Assert.assertEquals(expectedResult.getPayload(), actualResult.getPayload());\n-    }\n-\n-    public <T> void assertResponse(final MvcResult mvcResult,\n-                                          final T payload,\n-                                          final TypeReference<Result<T>> typeReference) throws Exception {\n-        final ResponseResult<T> expectedResult = buildExpectedResult(payload);\n-\n-        final String actual = mvcResult.getResponse().getContentAsString();\n-        Assert.assertTrue(StringUtils.isNotBlank(actual));\n-        assertThat(actual).isEqualToIgnoringWhitespace(jsonMapper.writeValueAsString(expectedResult));\n-\n-        final Result<T> actualResult = JsonMapper.parseData(actual, typeReference);\n-        Assert.assertEquals(expectedResult.getPayload(), actualResult.getPayload());\n-    }\n-\n-    public void getRequestUnauthorized(MockMvc mvc, String url) throws Exception {\n-        mvc.perform(get(url)\n-                .servletPath(SERVLET_PATH))\n-                .andExpect(status().isUnauthorized());\n-    }\n-\n-    public MvcResult getRequest(MockMvc mvc, String url, MultiValueMap<String, String> params, String content)\n-            throws Exception {\n-        return mvc.perform(get(url)\n-                .servletPath(SERVLET_PATH)\n-                .contentType(CONTENT_TYPE)\n-                .params(params)\n-                .content(content))\n-                .andExpect(status().isOk())\n-                .andExpect(MockMvcResultMatchers.content().contentType(CONTENT_TYPE))\n-                .andReturn();\n-    }\n-\n-    public void postRequestUnauthorized(MockMvc mvc, String url) throws Exception {\n-        mvc.perform(post(url)\n-                .servletPath(SERVLET_PATH))\n-                .andExpect(status().isUnauthorized());\n-    }\n-\n-    public MvcResult postRequest(MockMvc mvc, String url, MultiValueMap<String, String> params, String content)\n-            throws Exception {\n-        return mvc.perform(post(url)\n-                .servletPath(SERVLET_PATH)\n-                .contentType(CONTENT_TYPE)\n-                .params(params)\n-                .content(content))\n-                .andExpect(status().isOk())\n-                .andExpect(MockMvcResultMatchers.content().contentType(CONTENT_TYPE))\n-                .andReturn();\n-    }\n-\n-    public void putRequestUnauthorized(MockMvc mvc, String url) throws Exception {\n-        mvc.perform(put(url)\n-                .servletPath(SERVLET_PATH))\n-                .andExpect(status().isUnauthorized());\n-    }\n-\n-    public MvcResult putRequest(MockMvc mvc, String url, MultiValueMap<String, String> params, String content)\n-            throws Exception {\n-        return mvc.perform(put(url)\n-                .servletPath(SERVLET_PATH)\n-                .contentType(CONTENT_TYPE)\n-                .params(params)\n-                .content(content))\n-                .andExpect(status().isOk())\n-                .andExpect(MockMvcResultMatchers.content().contentType(CONTENT_TYPE))\n-                .andReturn();\n-    }\n-\n-    public void deleteRequestUnauthorized(MockMvc mvc, String url) throws Exception {\n-        mvc.perform(delete(url)\n-                .servletPath(SERVLET_PATH))\n-                .andExpect(status().isUnauthorized());\n-    }\n-\n-    public MvcResult deleteRequest(MockMvc mvc, String url, MultiValueMap<String, String> params, String content)\n-            throws Exception {\n-        return mvc.perform(delete(url)\n-                .servletPath(SERVLET_PATH)\n-                .contentType(CONTENT_TYPE)\n-                .params(params)\n-                .content(content))\n-                .andExpect(status().isOk())\n-                .andExpect(MockMvcResultMatchers.content().contentType(CONTENT_TYPE))\n-                .andReturn();\n+        assertEquals(expectedResult.getPayload(), actualResult.getPayload());\n     }\n }\n"}}, {"oid": "c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "url": "https://github.com/epam/cloud-pipeline/commit/c72105f8a49be19f27f04d9a6e8eb97d2e42577e", "message": "Issue #1405: Implemented tests for CloudRegionController", "committedDate": "2020-10-16T10:38:17Z", "type": "commit"}, {"oid": "7c9c47821f5a60f344c9e43bdd4e46172f7ba3e9", "url": "https://github.com/epam/cloud-pipeline/commit/7c9c47821f5a60f344c9e43bdd4e46172f7ba3e9", "message": "Issue #1405: Checkstyle fixes, CloudRegionInfo made mutable", "committedDate": "2020-10-16T10:38:24Z", "type": "commit"}, {"oid": "d35c8b4bc088b297ab95fa68090caf82d7b35a71", "url": "https://github.com/epam/cloud-pipeline/commit/d35c8b4bc088b297ab95fa68090caf82d7b35a71", "message": "Issue #1405: Constants scope changed, constructor replaced with lombok annotation", "committedDate": "2020-10-16T10:38:24Z", "type": "commit"}, {"oid": "ad3ada14762c9f7f574f8d14f5ec1fcf0de5f53d", "url": "https://github.com/epam/cloud-pipeline/commit/ad3ada14762c9f7f574f8d14f5ec1fcf0de5f53d", "message": "Issue #1405: Created RegionCreatorUtils, added tests for different CloudRegions", "committedDate": "2020-10-16T10:38:24Z", "type": "commit"}, {"oid": "7e4af871794af90cec128d2b5c12e0d479779b05", "url": "https://github.com/epam/cloud-pipeline/commit/7e4af871794af90cec128d2b5c12e0d479779b05", "message": "Issue #1405: Removed redundant ArgumentCaptor assertions", "committedDate": "2020-10-16T10:38:25Z", "type": "commit"}, {"oid": "b1c2d5824b97f46c178b77a9ce9297365a2b4eba", "url": "https://github.com/epam/cloud-pipeline/commit/b1c2d5824b97f46c178b77a9ce9297365a2b4eba", "message": "Issue #1405: RegionCreatorUtils moved to creator package, created constant fields", "committedDate": "2020-10-16T10:38:25Z", "type": "commit"}, {"oid": "076b147d0c981acdc7ab8144be60f1013cc2dda6", "url": "https://github.com/epam/cloud-pipeline/commit/076b147d0c981acdc7ab8144be60f1013cc2dda6", "message": "Issue #1405: Fixed CloudRegionApiService import", "committedDate": "2020-10-16T10:38:25Z", "type": "commit"}, {"oid": "2b1b4850a05736c978412ce3ca47203c97b98ff4", "url": "https://github.com/epam/cloud-pipeline/commit/2b1b4850a05736c978412ce3ca47203c97b98ff4", "message": "Issue #1405: ControllerTestUtils refactored, mock requests extracted", "committedDate": "2020-10-16T10:38:26Z", "type": "commit"}, {"oid": "f3238dce837134aed1056324e67bdc67875edf7a", "url": "https://github.com/epam/cloud-pipeline/commit/f3238dce837134aed1056324e67bdc67875edf7a", "message": "Issue #1405: ControllerTestUtils methods moved to AbstractControllerTest, moved TypeReference creation to CreatorUtils", "committedDate": "2020-10-16T10:38:26Z", "type": "commit"}, {"oid": "f3238dce837134aed1056324e67bdc67875edf7a", "url": "https://github.com/epam/cloud-pipeline/commit/f3238dce837134aed1056324e67bdc67875edf7a", "message": "Issue #1405: ControllerTestUtils methods moved to AbstractControllerTest, moved TypeReference creation to CreatorUtils", "committedDate": "2020-10-16T10:38:26Z", "type": "forcePushed"}]}