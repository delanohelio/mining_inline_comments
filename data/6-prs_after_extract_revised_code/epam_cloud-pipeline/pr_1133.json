{"pr_number": 1133, "pr_title": "Issue #1126: `pipe run` custom parameters parsing issue", "pr_createdAt": "2020-05-22T14:59:01Z", "pr_url": "https://github.com/epam/cloud-pipeline/pull/1133", "timeline": [{"oid": "a811fc6255a6bd9b8cb3048501a6b2cd37d59544", "url": "https://github.com/epam/cloud-pipeline/commit/a811fc6255a6bd9b8cb3048501a6b2cd37d59544", "message": "Issue #1126: `pipe run` custom parameters parsing issue - fix for run parameters; each options group (option name + value) is separated by new line", "committedDate": "2020-05-22T14:37:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwMTE2MA==", "url": "https://github.com/epam/cloud-pipeline/pull/1133#discussion_r429301160", "bodyText": "If parameters are empty, we need to add '--' here as well", "author": "mzueva", "createdAt": "2020-05-22T15:04:17Z", "path": "api/src/main/java/com/epam/pipeline/manager/pipeline/runner/PipeRunCmdBuilder.java", "diffHunk": "@@ -130,49 +133,50 @@ public PipeRunCmdBuilder config() {\n \n     public PipeRunCmdBuilder yes() {\n         if (startVO.isYes()) {\n-            cmd.add(\"-y\");\n+            addCmd(\"-y\");\n         }\n         return this;\n     }\n \n     public PipeRunCmdBuilder quite() {\n         if (startVO.isQuite()) {\n-            cmd.add(\"-q\");\n+            addCmd(\"-q\");\n         }\n         return this;\n     }\n \n     public PipeRunCmdBuilder sync() {\n         if (startVO.isSync()) {\n-            cmd.add(\"-s\");\n+            addCmd(\"-s\");\n         }\n         return this;\n     }\n \n     public PipeRunCmdBuilder parameters() {\n         if (startVO.isShowParams()) {\n-            cmd.add(\"-p\");\n+            addCmd(\"-p\");\n         }\n         return this;\n     }\n \n     public PipeRunCmdBuilder runParameters() {\n         if (MapUtils.isNotEmpty(runVO.getParams())) {\n+            addCmd(CMD_OPTIONS_DELIMITER);\n             final String parametersCommand = runVO.getParams().entrySet()\n                     .stream()\n                     .map(this::prepareParams)\n-                    .collect(Collectors.joining(WHITESPACE));\n+                    .collect(Collectors.joining(WHITESPACE + getNewLineIndicator() + WHITESPACE));\n             cmd.add(parametersCommand);\n         }\n         if (Objects.nonNull(runVO.getParentRunId())) {\n-            cmd.add(String.format(\"parent-id %d\", runVO.getParentRunId()));", "originalCommit": "a811fc6255a6bd9b8cb3048501a6b2cd37d59544", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxMDQyMg==", "url": "https://github.com/epam/cloud-pipeline/pull/1133#discussion_r429310422", "bodyText": "added", "author": "ekazachkova", "createdAt": "2020-05-22T15:21:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwMTE2MA=="}], "type": "inlineReview", "revised_code": {"commit": "b4bb0c9ceda8491cc3eb8462f9aa3caa96be9974", "chunk": "diff --git a/api/src/main/java/com/epam/pipeline/manager/pipeline/runner/PipeRunCmdBuilder.java b/api/src/main/java/com/epam/pipeline/manager/pipeline/runner/PipeRunCmdBuilder.java\nindex b3958efa5..cefe7d1d1 100644\n--- a/api/src/main/java/com/epam/pipeline/manager/pipeline/runner/PipeRunCmdBuilder.java\n+++ b/api/src/main/java/com/epam/pipeline/manager/pipeline/runner/PipeRunCmdBuilder.java\n\n@@ -169,7 +169,11 @@ public class PipeRunCmdBuilder {\n             cmd.add(parametersCommand);\n         }\n         if (Objects.nonNull(runVO.getParentRunId())) {\n-            addCmd(String.format(\"parent-id %d\", runVO.getParentRunId()));\n+            cmd.add(getNewLineIndicator());\n+            if (MapUtils.isEmpty(runVO.getParams())) {\n+                cmd.add(CMD_OPTIONS_DELIMITER);\n+            }\n+            cmd.add(String.format(\"parent-id %d\", runVO.getParentRunId()));\n         }\n         return this;\n     }\n"}}, {"oid": "b4bb0c9ceda8491cc3eb8462f9aa3caa96be9974", "url": "https://github.com/epam/cloud-pipeline/commit/b4bb0c9ceda8491cc3eb8462f9aa3caa96be9974", "message": "Issue #1126: `pipe run` custom parameters parsing issue - fix for parent-id run parameter", "committedDate": "2020-05-22T15:19:59Z", "type": "commit"}]}