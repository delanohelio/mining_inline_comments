{"pr_number": 1558, "pr_title": "fix: stored procedures are not updatable due to a missing boolean = true", "pr_createdAt": "2020-10-06T13:17:12Z", "pr_url": "https://github.com/IBM/FHIR/pull/1558", "timeline": [{"oid": "27239a865d214edd6361a939fbdd9322d19b5100", "url": "https://github.com/IBM/FHIR/commit/27239a865d214edd6361a939fbdd9322d19b5100", "message": "fix: stored procedures are not updatable due to a missing boolean = true\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-10-06T13:16:13Z", "type": "commit"}, {"oid": "200aae710df02551eb8b0baa8b759c374af1b3d8", "url": "https://github.com/IBM/FHIR/commit/200aae710df02551eb8b0baa8b759c374af1b3d8", "message": "fix: base version history service ignores the current version of the Stored Proc and does not reapply\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-10-07T12:40:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk4MjQ2Nw==", "url": "https://github.com/IBM/FHIR/pull/1558#discussion_r500982467", "bodyText": "wonder if we should add a comment to explaining the why.\nbasically we just want the procedures to get re-written every time (whether its a newer version or not)?", "author": "lmsurpre", "createdAt": "2020-10-07T12:46:21Z", "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/model/BaseObject.java", "diffHunk": "@@ -255,7 +255,7 @@ public void applyTx(IDatabaseAdapter target, ITransactionProvider tp, IVersionHi\n      */\n     @Override\n     public void applyVersion(IDatabaseAdapter target, IVersionHistoryService vhs) {\n-        if (vhs.applies(getSchemaName(), getObjectType().name(), getObjectName(), version)) {\n+        if (vhs.applies(getSchemaName(), getObjectType().name(), getObjectName(), version) || getObjectType().equals(DatabaseObjectType.PROCEDURE)) {", "originalCommit": "200aae710df02551eb8b0baa8b759c374af1b3d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTAwNTYxOA==", "url": "https://github.com/IBM/FHIR/pull/1558#discussion_r501005618", "bodyText": "Right.  I can add a comment", "author": "prb112", "createdAt": "2020-10-07T13:20:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk4MjQ2Nw=="}], "type": "inlineReview", "revised_code": {"commit": "0970e333cb9976c9c117bc5d0bf6dfdfea391689", "chunk": "diff --git a/fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/model/BaseObject.java b/fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/model/BaseObject.java\nindex 79c0d1c3b4..c3cb00e9f9 100644\n--- a/fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/model/BaseObject.java\n+++ b/fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/model/BaseObject.java\n\n@@ -255,6 +255,7 @@ public abstract class BaseObject implements IDatabaseObject {\n      */\n     @Override\n     public void applyVersion(IDatabaseAdapter target, IVersionHistoryService vhs) {\n+        // Only for Procedures do we skip the Version History Service check, and apply.\n         if (vhs.applies(getSchemaName(), getObjectType().name(), getObjectName(), version) || getObjectType().equals(DatabaseObjectType.PROCEDURE)) {\n             logger.fine(\"Applying change [v\" + version + \"]: \" + this.getTypeNameVersion());\n \n"}}, {"oid": "0970e333cb9976c9c117bc5d0bf6dfdfea391689", "url": "https://github.com/IBM/FHIR/commit/0970e333cb9976c9c117bc5d0bf6dfdfea391689", "message": "fix: update the BaseObject with a comment\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-10-07T13:21:57Z", "type": "commit"}]}