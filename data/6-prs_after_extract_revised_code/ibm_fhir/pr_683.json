{"pr_number": 683, "pr_title": "Refactoring and addition of FHIRUtil.createStandaloneBundle", "pr_createdAt": "2020-02-06T17:03:22Z", "pr_url": "https://github.com/IBM/FHIR/pull/683", "timeline": [{"oid": "aacd9363fafa247d1134d1710fee65b4c6e47cf1", "url": "https://github.com/IBM/FHIR/commit/aacd9363fafa247d1134d1710fee65b4c6e47cf1", "message": "Refactoring and addition of FHIRUtil.createStandaloneBundle\n\n1. Moved ReferenceMappingVisitor from fhir-server to fhir-model and\nrefactored it to allow any mapping (not just UUID -> logical id)\n\n2. Introduced FHIRUtil.createStandaloneBundle for adding resources to a\nbundle and replacing internal references with bundle-local UUID values\n\n3. Removed deprecated FHIRUtil methods and added deprecated flag to\nFHIRUtil.getResourceTypeName(Resource resource)\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-02-06T17:15:48Z", "type": "forcePushed"}, {"oid": "1d667e92564ce73f3442891886e33eabec642294", "url": "https://github.com/IBM/FHIR/commit/1d667e92564ce73f3442891886e33eabec642294", "message": "Refactoring and addition of FHIRUtil.createStandaloneBundle\n\n1. Moved ReferenceMappingVisitor from fhir-server to fhir-model and\nrefactored it to allow any mapping (not just UUID -> logical id)\n\n2. Introduced FHIRUtil.createStandaloneBundle for adding resources to a\nbundle and replacing internal references with bundle-local UUID values\n\n3. Removed deprecated FHIRUtil methods and added deprecated flag to\nFHIRUtil.getResourceTypeName(Resource resource)\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-02-06T17:19:40Z", "type": "forcePushed"}, {"oid": "800b5c91e83cc7f81b4dfd88f083a3f28b11caee", "url": "https://github.com/IBM/FHIR/commit/800b5c91e83cc7f81b4dfd88f083a3f28b11caee", "message": "Refactoring and addition of FHIRUtil.createStandaloneBundle\n\n1. Moved ReferenceMappingVisitor from fhir-server to fhir-model and\nrefactored it to allow any mapping (not just UUID -> logical id)\n\n2. Introduced FHIRUtil.createStandaloneBundle for adding resources to a\nbundle and replacing internal references with bundle-local UUID values\n\n3. Removed deprecated FHIRUtil methods and added deprecated flag to\nFHIRUtil.getResourceTypeName(Resource resource)\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-02-06T17:53:57Z", "type": "commit"}, {"oid": "800b5c91e83cc7f81b4dfd88f083a3f28b11caee", "url": "https://github.com/IBM/FHIR/commit/800b5c91e83cc7f81b4dfd88f083a3f28b11caee", "message": "Refactoring and addition of FHIRUtil.createStandaloneBundle\n\n1. Moved ReferenceMappingVisitor from fhir-server to fhir-model and\nrefactored it to allow any mapping (not just UUID -> logical id)\n\n2. Introduced FHIRUtil.createStandaloneBundle for adding resources to a\nbundle and replacing internal references with bundle-local UUID values\n\n3. Removed deprecated FHIRUtil methods and added deprecated flag to\nFHIRUtil.getResourceTypeName(Resource resource)\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-02-06T17:53:57Z", "type": "forcePushed"}, {"oid": "a9c81cf039ae60c90b87489dff15f2384e0d16bf", "url": "https://github.com/IBM/FHIR/commit/a9c81cf039ae60c90b87489dff15f2384e0d16bf", "message": "Updated build.yml to make powershell step fail on test error\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-02-06T18:23:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE0NjkyNw==", "url": "https://github.com/IBM/FHIR/pull/683#discussion_r376146927", "bodyText": "this should set to false", "author": "albertwang-ibm", "createdAt": "2020-02-06T23:51:09Z", "path": "fhir-server-test/src/test/java/com/ibm/fhir/server/test/BundleTest.java", "diffHunk": "@@ -57,7 +57,7 @@\n public class BundleTest extends FHIRServerTestBase {\n     // Set this to true to have the request and response bundles displayed on the\n     // console.\n-    private boolean debug = false;\n+    private boolean DEBUG = true;", "originalCommit": "a9c81cf039ae60c90b87489dff15f2384e0d16bf", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE1MDU1NQ==", "url": "https://github.com/IBM/FHIR/pull/683#discussion_r376150555", "bodyText": "Is this function used now? seems I can not find any caller ...", "author": "albertwang-ibm", "createdAt": "2020-02-07T00:04:01Z", "path": "fhir-model/src/main/java/com/ibm/fhir/model/util/FHIRUtil.java", "diffHunk": "@@ -790,4 +521,38 @@ public static boolean isFailure(IssueSeverity severity) {\n             return true;\n         }\n     }\n+    \n+    /**\n+     * Create a self-contained bundle from the passed map of resources, replacing Resource.id values and \n+     * references with a generated UUID.\n+     * \n+     * @param bundleType\n+     *            The type of bundle to create\n+     * @param resources\n+     *            A mapping from String identifiers to Resources. For resources with no logical id, the key can be any\n+     *            string\n+     * @return a Bundle with the passed resources with ids and references replaced by UUIDs\n+     */\n+    public static Bundle createStandaloneBundle(BundleType bundleType, Map<String,Resource> resources) {", "originalCommit": "a9c81cf039ae60c90b87489dff15f2384e0d16bf", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}