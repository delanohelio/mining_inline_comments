{"pr_number": 842, "pr_title": "Reduce the Default Pool Size for the Schema Generator #841", "pr_createdAt": "2020-03-24T12:39:59Z", "pr_url": "https://github.com/IBM/FHIR/pull/842", "timeline": [{"oid": "0f9f2d2e600fc3bc3e82b1fd01495a72b3731fb0", "url": "https://github.com/IBM/FHIR/commit/0f9f2d2e600fc3bc3e82b1fd01495a72b3731fb0", "message": "Reduce the Default Pool Size for the Schema Generator #841\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-03-24T12:38:54Z", "type": "commit"}, {"oid": "e5cab4c8ea0ccd657773ec61dc619ed0d4cf141e", "url": "https://github.com/IBM/FHIR/commit/e5cab4c8ea0ccd657773ec61dc619ed0d4cf141e", "message": "Reduce the Default Pool Size for the Schema Generator #841\n\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-03-24T12:41:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEzMzE5OQ==", "url": "https://github.com/IBM/FHIR/pull/842#discussion_r397133199", "bodyText": "As I remember, when updateschema, we can only set the poolsize to 1, but we don't have to set it for the other operations. not sure if the other operations are using the pool or not, if they are using, will this change make the other operations slower?", "author": "albertwang-ibm", "createdAt": "2020-03-24T13:00:50Z", "path": "fhir-persistence-schema/src/main/java/com/ibm/fhir/schema/control/FhirSchemaConstants.java", "diffHunk": "@@ -11,8 +11,9 @@\n  */\n public class FhirSchemaConstants {\n \n+    // A lower pool size is selected as default to limit the likelihood of contention on the DBMS.\n     // Standard connection/thread pool size\n-    public static final int DEFAULT_POOL_SIZE = 80;", "originalCommit": "e5cab4c8ea0ccd657773ec61dc619ed0d4cf141e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEzNTg5MQ==", "url": "https://github.com/IBM/FHIR/pull/842#discussion_r397135891", "bodyText": "you can always chose to up to 80.\nit may make them sequential, and avoid the resource contention from a higher number.\nI personally want lower than 8, but 8 is what Lee and I thought made sense.", "author": "prb112", "createdAt": "2020-03-24T13:05:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEzMzE5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzE0NDE1MA==", "url": "https://github.com/IBM/FHIR/pull/842#discussion_r397144150", "bodyText": "my point is that this change could make us have to set pool size for every other operations, the current setting only makes us have to set it for maybe only one operation ... but anyway, I'm fine with the change. we can always set the pool size as parameter if need to.", "author": "albertwang-ibm", "createdAt": "2020-03-24T13:18:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEzMzE5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzE0NjIxMA==", "url": "https://github.com/IBM/FHIR/pull/842#discussion_r397146210", "bodyText": "or if the pool is only used by updateschema, then maybe we should make it even smaller... :) double checking the codes now ...", "author": "albertwang-ibm", "createdAt": "2020-03-24T13:21:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEzMzE5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzE0OTA0NA==", "url": "https://github.com/IBM/FHIR/pull/842#discussion_r397149044", "bodyText": "it's essentially used in the PoolConnectionProvider (underneath)", "author": "prb112", "createdAt": "2020-03-24T13:26:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEzMzE5OQ=="}], "type": "inlineReview", "revised_code": {"commit": "5b18487a1a66c7a34f2b74ec79b44c5ecb97d029", "chunk": "diff --git a/fhir-persistence-schema/src/main/java/com/ibm/fhir/schema/control/FhirSchemaConstants.java b/fhir-persistence-schema/src/main/java/com/ibm/fhir/schema/control/FhirSchemaConstants.java\nindex 5e3a03649a..511b0c6436 100644\n--- a/fhir-persistence-schema/src/main/java/com/ibm/fhir/schema/control/FhirSchemaConstants.java\n+++ b/fhir-persistence-schema/src/main/java/com/ibm/fhir/schema/control/FhirSchemaConstants.java\n\n@@ -13,7 +13,7 @@ public class FhirSchemaConstants {\n \n     // A lower pool size is selected as default to limit the likelihood of contention on the DBMS.\n     // Standard connection/thread pool size\n-    public static final int DEFAULT_POOL_SIZE = 8;\n+    public static final int DEFAULT_POOL_SIZE = 1;\n     \n     // Size of string columns in the search tables. DSTU2 was 511\n     public static final int MAX_SEARCH_STRING_BYTES = 1024;\n"}}, {"oid": "5b18487a1a66c7a34f2b74ec79b44c5ecb97d029", "url": "https://github.com/IBM/FHIR/commit/5b18487a1a66c7a34f2b74ec79b44c5ecb97d029", "message": "Reduce the Default Pool Size for the Schema Generator #841\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-03-24T14:18:41Z", "type": "commit"}]}