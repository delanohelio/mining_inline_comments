{"pr_number": 1119, "pr_title": "Minor swagger definition changes", "pr_createdAt": "2020-05-18T22:33:01Z", "pr_url": "https://github.com/IBM/FHIR/pull/1119", "timeline": [{"oid": "e7f600b6c71a3bc006a18e763a53824cbcbc6a90", "url": "https://github.com/IBM/FHIR/commit/e7f600b6c71a3bc006a18e763a53824cbcbc6a90", "message": "move extension array example up one level in the tree\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-05-18T22:32:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NjcwMA==", "url": "https://github.com/IBM/FHIR/pull/1119#discussion_r426966700", "bodyText": "Is this always false?", "author": "albertwang-ibm", "createdAt": "2020-05-19T00:43:18Z", "path": "fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java", "diffHunk": "@@ -1286,8 +1288,14 @@ private static void generateProperty(StructureDefinition structureDefinition, Cl\n             JsonObjectBuilder wrapper = factory.createObjectBuilder();\n             wrapper.add(\"type\", \"array\");\n             wrapper.add(\"items\", property);\n+            if (example != null) {\n+                wrapper.add(\"example\", example);\n+            }\n             properties.add(elementName, wrapper);\n         } else {\n+            if (example != null) {", "originalCommit": "e7f600b6c71a3bc006a18e763a53824cbcbc6a90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk3MDE5Mw==", "url": "https://github.com/IBM/FHIR/pull/1119#discussion_r426970193", "bodyText": "no, I think github was just hiding the lines in the middle on you.  be sure to expand the\n to see the full context", "author": "lmsurpre", "createdAt": "2020-05-19T00:56:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NjcwMA=="}], "type": "inlineReview", "revised_code": {"commit": "aa188f8932334f919d415c50735b8654371700f8", "chunk": "diff --git a/fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java b/fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java\nindex 9ee03280ba..a973036b25 100644\n--- a/fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java\n+++ b/fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java\n\n@@ -1281,7 +1283,6 @@ public class FHIROpenApiGenerator {\n                     .add(\"display\", \"The Assigning Organization\")\n                     // skip assigner to break the recursion\n                     .build();\n-            property.add(\"example\", example);\n         }\n \n         if (many) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2Njk2MQ==", "url": "https://github.com/IBM/FHIR/pull/1119#discussion_r426966961", "bodyText": "is this always false?", "author": "albertwang-ibm", "createdAt": "2020-05-19T00:44:27Z", "path": "fhir-swagger-generator/src/main/java/com/ibm/fhir/swagger/generator/FHIRSwaggerGenerator.java", "diffHunk": "@@ -1018,8 +1021,14 @@ private static void generateProperty(StructureDefinition structureDefinition, Cl\n             JsonObjectBuilder wrapper = factory.createObjectBuilder();\n             wrapper.add(\"type\", \"array\");\n             wrapper.add(\"items\", property);\n+            if (example != null) {\n+                wrapper.add(\"example\", example);\n+            }\n             properties.add(elementName, wrapper);\n         } else {\n+            if (example != null) {", "originalCommit": "e7f600b6c71a3bc006a18e763a53824cbcbc6a90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk3MDMyNw==", "url": "https://github.com/IBM/FHIR/pull/1119#discussion_r426970327", "bodyText": "nope, see other comment", "author": "lmsurpre", "createdAt": "2020-05-19T00:57:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2Njk2MQ=="}], "type": "inlineReview", "revised_code": {"commit": "aa188f8932334f919d415c50735b8654371700f8", "chunk": "diff --git a/fhir-swagger-generator/src/main/java/com/ibm/fhir/swagger/generator/FHIRSwaggerGenerator.java b/fhir-swagger-generator/src/main/java/com/ibm/fhir/swagger/generator/FHIRSwaggerGenerator.java\nindex 86d7e99874..649e6eae84 100644\n--- a/fhir-swagger-generator/src/main/java/com/ibm/fhir/swagger/generator/FHIRSwaggerGenerator.java\n+++ b/fhir-swagger-generator/src/main/java/com/ibm/fhir/swagger/generator/FHIRSwaggerGenerator.java\n\n@@ -1014,7 +1016,6 @@ public class FHIRSwaggerGenerator {\n                     .add(\"display\", \"The Assigning Organization\")\n                     // skip assigner to break the recursion\n                     .build();\n-            property.add(\"example\", example);\n         }\n \n         if (many) {\n"}}, {"oid": "e65d15c8a277c61ca2714070efd6d4e5c8b5f447", "url": "https://github.com/IBM/FHIR/commit/e65d15c8a277c61ca2714070efd6d4e5c8b5f447", "message": "move required fields down one level in the hierarchy\n\nThis makes the object definitions slightly more composable and also\nworks a little better in Rational Software Architect.\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-05-19T02:09:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI4NDA4NQ==", "url": "https://github.com/IBM/FHIR/pull/1119#discussion_r427284085", "bodyText": "So, looks like these following lines are the key of the fix. the old codes didn't really add the example. correct?", "author": "albertwang-ibm", "createdAt": "2020-05-19T13:03:08Z", "path": "fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java", "diffHunk": "@@ -1286,8 +1291,14 @@ private static void generateProperty(StructureDefinition structureDefinition, Cl\n             JsonObjectBuilder wrapper = factory.createObjectBuilder();\n             wrapper.add(\"type\", \"array\");\n             wrapper.add(\"items\", property);\n+            if (example != null) {", "originalCommit": "e65d15c8a277c61ca2714070efd6d4e5c8b5f447", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5NzYxMQ==", "url": "https://github.com/IBM/FHIR/pull/1119#discussion_r427297611", "bodyText": "not quite; the old code added the examples at the property level (lines 1276 and 1282 respectively).  now that we're adding the examples one level up, i actually meant to remove those lines...so thanks for the reminder!", "author": "lmsurpre", "createdAt": "2020-05-19T13:22:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI4NDA4NQ=="}], "type": "inlineReview", "revised_code": {"commit": "aa188f8932334f919d415c50735b8654371700f8", "chunk": "diff --git a/fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java b/fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java\nindex 0becbf933e..a973036b25 100644\n--- a/fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java\n+++ b/fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java\n\n@@ -1284,7 +1283,6 @@ public class FHIROpenApiGenerator {\n                     .add(\"display\", \"The Assigning Organization\")\n                     // skip assigner to break the recursion\n                     .build();\n-            property.add(\"example\", example);\n         }\n \n         if (many) {\n"}}, {"oid": "aa188f8932334f919d415c50735b8654371700f8", "url": "https://github.com/IBM/FHIR/commit/aa188f8932334f919d415c50735b8654371700f8", "message": "Remove extension and indentifier examples from the inner level\n\nI meant to move them to the outer level before, but I accidentally just\nadded them a second time...this commit fixes that.\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-05-19T13:17:28Z", "type": "commit"}]}