{"pr_number": 3677, "pr_title": "QOL interface changes/redundancy removal ", "pr_createdAt": "2020-01-30T18:06:22Z", "pr_url": "https://github.com/TownyAdvanced/Towny/pull/3677", "timeline": [{"oid": "172f99398d6a0e892cc8e32d04a5360f9de0b494", "url": "https://github.com/TownyAdvanced/Towny/commit/172f99398d6a0e892cc8e32d04a5360f9de0b494", "message": "QOL changes/redundancy removal\n\n- Removed TownyAllySender, and ResidentModes.java because they were only being used in singular classes defeating the purpose of the interface, so they were combined into their respective classes.\n- Made PlotGroup conform to TownBlockOwner to introduce more standard implementation.\n- New interface Nameable introduced in order for objects that don't extend `TownyObject` to be operated on i.e PlotGroups.", "committedDate": "2020-01-29T22:28:26Z", "type": "commit"}, {"oid": "943d3e1c0d499946432e554eb9f18fafb17024bf", "url": "https://github.com/TownyAdvanced/Towny/commit/943d3e1c0d499946432e554eb9f18fafb17024bf", "message": "New Bank interface\n\n- Added Bank interface to generify objects that contain banks.", "committedDate": "2020-02-01T03:51:48Z", "type": "commit"}, {"oid": "a476f6000f2c0b0cffba04a0f22975f9715024d0", "url": "https://github.com/TownyAdvanced/Towny/commit/a476f6000f2c0b0cffba04a0f22975f9715024d0", "message": "Remove and clean up Town/Nation code\n\n- Simplified a lot of Town/Nation code and removed some that didn't do anything.", "committedDate": "2020-02-01T04:02:19Z", "type": "commit"}, {"oid": "e8df02c3ebd21645a6f82807c69085020ae72e10", "url": "https://github.com/TownyAdvanced/Towny/commit/e8df02c3ebd21645a6f82807c69085020ae72e10", "message": "Clean up Town, Resident, and TownyObject", "committedDate": "2020-02-01T04:08:03Z", "type": "commit"}, {"oid": "199dbdf3f8cc9233a16db3bbc2ec6334fe68c58e", "url": "https://github.com/TownyAdvanced/Towny/commit/199dbdf3f8cc9233a16db3bbc2ec6334fe68c58e", "message": "Add push compile github action.", "committedDate": "2020-02-01T04:23:46Z", "type": "commit"}, {"oid": "cabf8b249fe93509c365d344f95e4a50e67067e3", "url": "https://github.com/TownyAdvanced/Towny/commit/cabf8b249fe93509c365d344f95e4a50e67067e3", "message": "Fix workflow not fetching repo data.", "committedDate": "2020-02-01T04:29:47Z", "type": "commit"}, {"oid": "dc8451ca84843edc2fe9ce93d9e2707eb5e23efc", "url": "https://github.com/TownyAdvanced/Towny/commit/dc8451ca84843edc2fe9ce93d9e2707eb5e23efc", "message": "Update workflow name", "committedDate": "2020-02-01T04:33:49Z", "type": "commit"}, {"oid": "f5b5d15b6302d02c4c58170afa28bc29e1b13eb8", "url": "https://github.com/TownyAdvanced/Towny/commit/f5b5d15b6302d02c4c58170afa28bc29e1b13eb8", "message": "Last workflow update \ud83d\ude05", "committedDate": "2020-02-01T04:55:28Z", "type": "commit"}, {"oid": "fc93c0d9b9b3bede1551ba82f3316478f8040c78", "url": "https://github.com/TownyAdvanced/Towny/commit/fc93c0d9b9b3bede1551ba82f3316478f8040c78", "message": "Last workflow update \ud83d\ude05", "committedDate": "2020-02-01T04:57:46Z", "type": "commit"}, {"oid": "6a94c50b3c05b2740a9a8f129a763422ee7aed69", "url": "https://github.com/TownyAdvanced/Towny/commit/6a94c50b3c05b2740a9a8f129a763422ee7aed69", "message": "Merge remote-tracking branch 'upstream/refactor/interface-redux' into refactor/interface-redux\n\n# Conflicts:\n#\t.github/workflows/compile-on-push.yml", "committedDate": "2020-02-01T04:58:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTg1MA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r376739850", "bodyText": "Why is case 0 being removed here?", "author": "LlmDl", "createdAt": "2020-02-08T22:58:06Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -901,12 +886,8 @@ public double getPlotPrice() {\n \n \tpublic double getPlotTypePrice(TownBlockType type) {\n \n-\t\tdouble plotPrice = 0;\n+\t\tdouble plotPrice;\n \t\tswitch (type.ordinal()) {", "originalCommit": "6a94c50b3c05b2740a9a8f129a763422ee7aed69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5NzgwMQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r377297801", "bodyText": "Because the double is always initialized in the switch statement (there's a default case).", "author": "silverwolfg11", "createdAt": "2020-02-10T20:27:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTg1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5OTY2Mw==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r377299663", "bodyText": "Ah I see that now.", "author": "LlmDl", "createdAt": "2020-02-10T20:31:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTg1MA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTg2OQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r376739869", "bodyText": "I'd feel more comfortable knowing this was tested. Make sure that percentage increasing is used as well.", "author": "LlmDl", "createdAt": "2020-02-08T22:58:42Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -379,28 +374,25 @@ public int getBonusBlocks() {\n \t}\n \t\n \tpublic double getBonusBlockCost() {\n-\t\tdouble nextprice = (Math.pow(TownySettings.getPurchasedBonusBlocksIncreaseValue() , getPurchasedBlocks()) * TownySettings.getPurchasedBonusBlocksCost());\n-\t\treturn nextprice;\n+\t\treturn (Math.pow(TownySettings.getPurchasedBonusBlocksIncreaseValue() , getPurchasedBlocks()) * TownySettings.getPurchasedBonusBlocksCost());", "originalCommit": "6a94c50b3c05b2740a9a8f129a763422ee7aed69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc0NjM3Ng==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r376746376", "bodyText": "This is logically equivalent to the previous code only changes that were made were for the propose of code clarity.", "author": null, "createdAt": "2020-02-09T01:06:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTg2OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTg3NA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r376739874", "bodyText": "I'd feel more comfortable knowing this was tested. Make sure that percentage increasing is used as well.", "author": "LlmDl", "createdAt": "2020-02-08T22:58:47Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -379,28 +374,25 @@ public int getBonusBlocks() {\n \t}\n \t\n \tpublic double getBonusBlockCost() {\n-\t\tdouble nextprice = (Math.pow(TownySettings.getPurchasedBonusBlocksIncreaseValue() , getPurchasedBlocks()) * TownySettings.getPurchasedBonusBlocksCost());\n-\t\treturn nextprice;\n+\t\treturn (Math.pow(TownySettings.getPurchasedBonusBlocksIncreaseValue() , getPurchasedBlocks()) * TownySettings.getPurchasedBonusBlocksCost());\n \t}\n \t\n \tpublic double getTownBlockCost() {\n-\t\tdouble nextprice = (Math.pow(TownySettings.getClaimPriceIncreaseValue(), getTownBlocks().size()) * TownySettings.getClaimPrice());\n-\t\treturn nextprice;\n+\t\treturn (Math.pow(TownySettings.getClaimPriceIncreaseValue(), getTownBlocks().size()) * TownySettings.getClaimPrice());", "originalCommit": "6a94c50b3c05b2740a9a8f129a763422ee7aed69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5NjM5OA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r377296398", "bodyText": "As mentioned above this is logically equivalent. The code was just inlined.", "author": "silverwolfg11", "createdAt": "2020-02-10T20:24:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTg3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzMwMTc1MA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r377301750", "bodyText": "Yes, this PR doesn't have the \"i tested this\" checkbox checked is all.", "author": "LlmDl", "createdAt": "2020-02-10T20:36:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTg3NA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTkyNg==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r376739926", "bodyText": "I don't know why this continue was removed. Would this not end up making each assistant mayor until the last one is finally made mayor?", "author": "LlmDl", "createdAt": "2020-02-08T23:00:11Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -651,7 +643,6 @@ private void remove(Resident resident) {\n \t\t\t\t\tif ((assistant != resident) && (resident.hasTownRank(\"assistant\"))) {\n \t\t\t\t\t\ttry {\n \t\t\t\t\t\t\tsetMayor(assistant);", "originalCommit": "6a94c50b3c05b2740a9a8f129a763422ee7aed69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5NzI3MA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r377297270", "bodyText": "The readability of the for-loop is difficult because the brackets are missing from them (should add the brackets around the for-loop), but the continue was redundant as the try-catch block is the only thing executed in the loop. Applies for the same comment below.", "author": "silverwolfg11", "createdAt": "2020-02-10T20:26:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTkyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5NzgzMg==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r377297832", "bodyText": "The continue was probably a typo (or maybe it wasn't at a different time,) and has since been replaced with breaks.", "author": "LlmDl", "createdAt": "2020-02-10T20:27:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTkyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzMwMjQ0Nw==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r377302447", "bodyText": "I mean I can add brackets \ud83d\ude04", "author": null, "createdAt": "2020-02-10T20:37:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTkyNg=="}], "type": "inlineReview", "revised_code": {"commit": "d053506bc907c35d230ed268e5f3f8b637e62f9d", "chunk": "diff --git a/src/com/palmergames/bukkit/towny/object/Town.java b/src/com/palmergames/bukkit/towny/object/Town.java\nindex 1a077ed2d..5c13d897e 100644\n--- a/src/com/palmergames/bukkit/towny/object/Town.java\n+++ b/src/com/palmergames/bukkit/towny/object/Town.java\n\n@@ -643,6 +643,7 @@ public class Town extends TownyObject implements ResidentList, TownyInviter, Obj\n \t\t\t\t\tif ((assistant != resident) && (resident.hasTownRank(\"assistant\"))) {\n \t\t\t\t\t\ttry {\n \t\t\t\t\t\t\tsetMayor(assistant);\n+\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t} catch (TownyException e) {\n \t\t\t\t\t\t\t// Error setting mayor.\n \t\t\t\t\t\t\te.printStackTrace();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczOTk0NA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3677#discussion_r376739944", "bodyText": "I don't know why this continue was removed. Would this not end up making each resident mayor until the last one is finally made mayor?", "author": "LlmDl", "createdAt": "2020-02-08T23:00:40Z", "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -663,7 +654,6 @@ private void remove(Resident resident) {\n \t\t\t\t\t\tif (newMayor != resident) {\n \t\t\t\t\t\t\ttry {\n \t\t\t\t\t\t\t\tsetMayor(newMayor);", "originalCommit": "6a94c50b3c05b2740a9a8f129a763422ee7aed69", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d053506bc907c35d230ed268e5f3f8b637e62f9d", "chunk": "diff --git a/src/com/palmergames/bukkit/towny/object/Town.java b/src/com/palmergames/bukkit/towny/object/Town.java\nindex 1a077ed2d..5c13d897e 100644\n--- a/src/com/palmergames/bukkit/towny/object/Town.java\n+++ b/src/com/palmergames/bukkit/towny/object/Town.java\n\n@@ -654,6 +655,7 @@ public class Town extends TownyObject implements ResidentList, TownyInviter, Obj\n \t\t\t\t\t\tif (newMayor != resident) {\n \t\t\t\t\t\t\ttry {\n \t\t\t\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t\t} catch (TownyException e) {\n \t\t\t\t\t\t\t\t// Error setting mayor.\n \t\t\t\t\t\t\t\te.printStackTrace();\n"}}, {"oid": "d053506bc907c35d230ed268e5f3f8b637e62f9d", "url": "https://github.com/TownyAdvanced/Towny/commit/d053506bc907c35d230ed268e5f3f8b637e62f9d", "message": "Merge branches 'master' and 'refactor/interface-redux' of https://github.com/TownyAdvanced/Towny into refactor/interface-redux\n\n\u0001 Conflicts:\n\u0001\tsrc/com/palmergames/bukkit/towny/object/Town.java", "committedDate": "2020-02-10T20:35:01Z", "type": "commit"}]}