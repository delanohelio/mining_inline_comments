{"pr_number": 4523, "pr_title": "Move neutral setting to Government, allowing Towns to become neutral.", "pr_createdAt": "2020-12-04T19:24:36Z", "pr_url": "https://github.com/TownyAdvanced/Towny/pull/4523", "timeline": [{"oid": "ebac00d41cb7cf02a8245eedf132e23ddad6d3e3", "url": "https://github.com/TownyAdvanced/Towny/commit/ebac00d41cb7cf02a8245eedf132e23ddad6d3e3", "message": "Move neutral setting to Government, allowing Towns to become neutral.\n\n- Add towny.command.town.toggle.neutral permission node.\n- Adds setNeutral, isNeutral to Government.\n- Adds neutral setting to Towns in the database.\n- Deprecates the Nation toggleNeutral.\n- Does NOT add the /town toggle neutral|peaceful command yet.", "committedDate": "2020-12-04T18:54:35Z", "type": "forcePushed"}, {"oid": "cfcc5ece24c7d0965fe1b2fa868b0529b1c22b40", "url": "https://github.com/TownyAdvanced/Towny/commit/cfcc5ece24c7d0965fe1b2fa868b0529b1c22b40", "message": "Move neutral setting to Government, allowing Towns to become neutral.\n\n- Add towny.command.town.toggle.neutral permission node.\n- Adds setNeutral, isNeutral to Government.\n- Adds neutral setting to Towns in the database.\n- Deprecates the Nation toggleNeutral.\n- Does NOT add the /town toggle neutral|peaceful command yet.", "committedDate": "2020-12-06T16:28:58Z", "type": "commit"}, {"oid": "e8dc58ec6f05b4b8dd2bb68c02293f1a266508ed", "url": "https://github.com/TownyAdvanced/Towny/commit/e8dc58ec6f05b4b8dd2bb68c02293f1a266508ed", "message": "Remove Nation#toggleNeutral() logic into war listeners.", "committedDate": "2020-12-06T16:30:32Z", "type": "commit"}, {"oid": "e8dc58ec6f05b4b8dd2bb68c02293f1a266508ed", "url": "https://github.com/TownyAdvanced/Towny/commit/e8dc58ec6f05b4b8dd2bb68c02293f1a266508ed", "message": "Remove Nation#toggleNeutral() logic into war listeners.", "committedDate": "2020-12-06T16:30:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzA5MDU4Mw==", "url": "https://github.com/TownyAdvanced/Towny/pull/4523#discussion_r537090583", "bodyText": "If we're catching an exception, we either need to say why it is ignored, or do something with it; like get a stacktrace or send a debug logger message.\nAdditionally, this try-catch doesn't seem to throw anything and appears as if it can be omitted. If it does happen to throw something, the parent catch would be the first to find out.", "author": "TheFlagCourier", "createdAt": "2020-12-06T17:55:45Z", "path": "src/com/palmergames/bukkit/towny/db/TownyFlatFileSource.java", "diffHunk": "@@ -818,6 +818,14 @@ public boolean loadTown(Town town) {\n \t\t\t\t\t} catch (Exception ee) {\n \t\t\t\t\t\ttown.setRuinedTime(0);\n \t\t\t\t\t}\n+\t\t\t\t\n+\t\t\t\tline = keys.get(\"neutral\");\n+\t\t\t\tif (line != null)\n+\t\t\t\t\ttry {\n+\t\t\t\t\t\ttown.setNeutral(Boolean.parseBoolean(line));\n+\t\t\t\t\t} catch (Exception ignored) {", "originalCommit": "e8dc58ec6f05b4b8dd2bb68c02293f1a266508ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzA5NTgwOQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/4523#discussion_r537095809", "bodyText": "That is actually probably just a left-over from when the nation toggling neutral could throw an exception due to war. I'll remove it off town and nation loading.", "author": "LlmDl", "createdAt": "2020-12-06T18:23:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzA5MDU4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "e9eaf5d976694436886a47637de94f703815e10e", "chunk": "diff --git a/src/com/palmergames/bukkit/towny/db/TownyFlatFileSource.java b/src/com/palmergames/bukkit/towny/db/TownyFlatFileSource.java\nindex 48dfab2fe..ea025efea 100644\n--- a/src/com/palmergames/bukkit/towny/db/TownyFlatFileSource.java\n+++ b/src/com/palmergames/bukkit/towny/db/TownyFlatFileSource.java\n\n@@ -821,11 +821,7 @@ public final class TownyFlatFileSource extends TownyDatabaseHandler {\n \t\t\t\t\n \t\t\t\tline = keys.get(\"neutral\");\n \t\t\t\tif (line != null)\n-\t\t\t\t\ttry {\n-\t\t\t\t\t\ttown.setNeutral(Boolean.parseBoolean(line));\n-\t\t\t\t\t} catch (Exception ignored) {\n-\t\t\t\t\t}\n-\n+\t\t\t\t\ttown.setNeutral(Boolean.parseBoolean(line));\n \n \t\t\t} catch (Exception e) {\n \t\t\t\tTownyMessaging.sendErrorMsg(\"Loading Error: Exception while reading town file \" + town.getName() + \" at line: \" + line + \", in towny\\\\data\\\\towns\\\\\" + town.getName() + \".txt\");\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzA5MDk3OA==", "url": "https://github.com/TownyAdvanced/Towny/pull/4523#discussion_r537090978", "bodyText": "Might be a good idea to add a @since tag, with the upcoming version's number. Same for the isNeutral() check below.", "author": "TheFlagCourier", "createdAt": "2020-12-06T17:57:26Z", "path": "src/com/palmergames/bukkit/towny/object/Government.java", "diffHunk": "@@ -142,7 +143,25 @@ public final void setOpen(boolean isOpen) {\n \tpublic final boolean isOpen() { \n \t\treturn isOpen; \n \t}\n+\t\n+\t/**\n+\t * Sets the neutrality/peacefulness of the object. \n+\t * \n+\t * @param neutral whether the object will be neutral or peaceful.\n+\t */", "originalCommit": "e8dc58ec6f05b4b8dd2bb68c02293f1a266508ed", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e9eaf5d976694436886a47637de94f703815e10e", "chunk": "diff --git a/src/com/palmergames/bukkit/towny/object/Government.java b/src/com/palmergames/bukkit/towny/object/Government.java\nindex a5d5c6397..ecf90427f 100644\n--- a/src/com/palmergames/bukkit/towny/object/Government.java\n+++ b/src/com/palmergames/bukkit/towny/object/Government.java\n\n@@ -147,6 +147,7 @@ public abstract class Government extends TownyObject implements BankEconomyHandl\n \t/**\n \t * Sets the neutrality/peacefulness of the object. \n \t * \n+\t * @since 0.96.5.4\n \t * @param neutral whether the object will be neutral or peaceful.\n \t */\n \tpublic final void setNeutral(boolean neutral) {\n"}}, {"oid": "e9eaf5d976694436886a47637de94f703815e10e", "url": "https://github.com/TownyAdvanced/Towny/commit/e9eaf5d976694436886a47637de94f703815e10e", "message": "Removes unneeded exception catching, adds @since javadocing.", "committedDate": "2020-12-06T18:25:52Z", "type": "commit"}]}