{"pr_number": 3810, "pr_title": "Add economy commands to towny admin.", "pr_createdAt": "2020-03-22T06:24:38Z", "pr_url": "https://github.com/TownyAdvanced/Towny/pull/3810", "timeline": [{"oid": "09c788978a31f1149c6a9db657230d107f664644", "url": "https://github.com/TownyAdvanced/Towny/commit/09c788978a31f1149c6a9db657230d107f664644", "message": "Add deposit and withdraw sub-command to town and nation options in /townyadmin.", "committedDate": "2020-03-22T06:19:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4MjE4MA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3810#discussion_r396082180", "bodyText": "TownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"msg_xx_withdrew_xx\"), (isConsole ? \"console\" : player.getName()), amount,  TownySettings.getLangString(\"town_sign\")));\nTownyMessaging.sendPrefixedTownMessage(town, String.format(TownySettings.getLangString(\"msg_xx_withdrew_xx\"), (isConsole ? \"console\" : player.getName()), amount,  TownySettings.getLangString(\"town_sign\")));", "author": "LlmDl", "createdAt": "2020-03-22T11:23:57Z", "path": "src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java", "diffHunk": "@@ -932,6 +939,32 @@ public void parseAdminTownCommand(String[] split) throws TownyException {\n \t\t\t\tTownCommand.townSet(player, StringMgmt.remArgs(split, 2), true, town);\r\n \t\t\t} else if (split[1].equalsIgnoreCase(\"meta\")) {\r\n \t\t\t\thandleTownMetaCommand(player, town, split);\r\n+\t\t\t}\r\n+\t\t\telse if (split[1].equalsIgnoreCase(\"deposit\")) {\r\n+\t\t\t\tint amount;\r\n+\t\t\t\t\r\n+\t\t\t\ttry {\r\n+\t\t\t\t\tamount = Integer.parseInt(split[2]);\r\n+\t\t\t\t} catch (NumberFormatException ex) {\r\n+\t\t\t\t\tTownyMessaging.sendErrorMsg(player, TownySettings.getLangString(\"msg_error_must_be_int\"));\r\n+\t\t\t\t\treturn;\r\n+\t\t\t\t}\r\n+\t\t\t\t\r\n+\t\t\t\ttown.getAccount().collect(amount, \"Admin Deposit\");\r\n+\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Town Deposit Language String\r\n+\t\t\t}\r\n+\t\t\telse if (split[1].equalsIgnoreCase(\"withdraw\")) {\r\n+\t\t\t\tint amount;\r\n+\r\n+\t\t\t\ttry {\r\n+\t\t\t\t\tamount = Integer.parseInt(split[2]);\r\n+\t\t\t\t} catch (NumberFormatException ex) {\r\n+\t\t\t\t\tTownyMessaging.sendErrorMsg(player, TownySettings.getLangString(\"msg_error_must_be_int\"));\r\n+\t\t\t\t\treturn;\r\n+\t\t\t\t}\r\n+\r\n+\t\t\t\ttown.getAccount().pay(amount, \"Admin Withdraw\");\r\n+\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Town Withdraw Language String\r", "originalCommit": "09c788978a31f1149c6a9db657230d107f664644", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "08bb616f651a7d7bdfe759d3a4f06613c60c9f26", "chunk": "diff --git a/src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java b/src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java\nindex c26ad5d6..ae2861a7 100644\n--- a/src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java\n+++ b/src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java\n\n@@ -951,7 +951,11 @@ public class TownyAdminCommand extends BaseCommand implements CommandExecutor {\n \t\t\t\t}\n \t\t\t\t\n \t\t\t\ttown.getAccount().collect(amount, \"Admin Deposit\");\n-\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Town Deposit Language String\n+\t\t\t\t\n+\t\t\t\t// Send notifications\n+\t\t\t\tString depositMessage = String.format(TownySettings.getLangString(\"msg_xx_deposited_xx\"), (isConsole ? \"Console\" : player.getName()), amount,  TownySettings.getLangString(\"town_sing\"));\n+\t\t\t\tTownyMessaging.sendMessage(sender, depositMessage);\n+\t\t\t\tTownyMessaging.sendPrefixedTownMessage(town, depositMessage);\n \t\t\t}\n \t\t\telse if (split[1].equalsIgnoreCase(\"withdraw\")) {\n \t\t\t\tint amount;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4MjQwOQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/3810#discussion_r396082409", "bodyText": "TownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"msg_xx_withdrew_xx\"), (isConsole ? \"console\" : player.getName()), amount, TownySettings.getLangString(\"nation_sign\")));\nTownyMessaging.sendPrefixedNationMessage(nation, String.format(TownySettings.getLangString(\"msg_xx_withdrew_xx\"), (isConsole ? \"console\" : player.getName()), amount,  TownySettings.getLangString(\"nation_sign\")));", "author": "LlmDl", "createdAt": "2020-03-22T11:26:39Z", "path": "src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java", "diffHunk": "@@ -1126,9 +1163,34 @@ public void parseAdminNationCommand(String[] split) throws TownyException {\n \t\t\t} else if(split[1].equalsIgnoreCase(\"toggle\")) {\r\n \t\t\t\t\r\n \t\t\t\tNationCommand.nationToggle(player, StringMgmt.remArgs(split, 2), true, nation);\r\n+\t\t\t} else if (split[1].equalsIgnoreCase(\"deposit\")) {\r\n+\t\t\t\tint amount;\r\n+\r\n+\t\t\t\ttry {\r\n+\t\t\t\t\tamount = Integer.parseInt(split[2]);\r\n+\t\t\t\t} catch (NumberFormatException ex) {\r\n+\t\t\t\t\tTownyMessaging.sendErrorMsg(player, TownySettings.getLangString(\"msg_error_must_be_int\"));\r\n+\t\t\t\t\treturn;\r\n+\t\t\t\t}\r\n+\r\n+\t\t\t\tnation.getAccount().collect(amount, \"Admin Deposit\");\r\n+\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Nation Deposit Language String\r\n+\t\t\t}\r\n+\t\t\telse if (split[1].equalsIgnoreCase(\"withdraw\")) {\r\n+\t\t\t\tint amount;\r\n+\r\n+\t\t\t\ttry {\r\n+\t\t\t\t\tamount = Integer.parseInt(split[2]);\r\n+\t\t\t\t} catch (NumberFormatException ex) {\r\n+\t\t\t\t\tTownyMessaging.sendErrorMsg(player, TownySettings.getLangString(\"msg_error_must_be_int\"));\r\n+\t\t\t\t\treturn;\r\n+\t\t\t\t}\r\n+\r\n+\t\t\t\tnation.getAccount().pay(amount, \"Admin Withdraw\");\r\n+\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Nation Withdraw Language String\r", "originalCommit": "09c788978a31f1149c6a9db657230d107f664644", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "08bb616f651a7d7bdfe759d3a4f06613c60c9f26", "chunk": "diff --git a/src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java b/src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java\nindex c26ad5d6..ae2861a7 100644\n--- a/src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java\n+++ b/src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java\n\n@@ -1174,7 +1182,11 @@ public class TownyAdminCommand extends BaseCommand implements CommandExecutor {\n \t\t\t\t}\n \n \t\t\t\tnation.getAccount().collect(amount, \"Admin Deposit\");\n-\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Nation Deposit Language String\n+\t\t\t\t\n+\t\t\t\t// Send notifications\n+\t\t\t\tString depositMessage = String.format(TownySettings.getLangString(\"msg_xx_deposited_xx\"), (isConsole ? \"Console\" : player.getName()), amount,  TownySettings.getLangString(\"nation_sing\"));\n+\t\t\t\tTownyMessaging.sendMessage(sender, depositMessage);\n+\t\t\t\tTownyMessaging.sendPrefixedNationMessage(nation, depositMessage);\n \t\t\t}\n \t\t\telse if (split[1].equalsIgnoreCase(\"withdraw\")) {\n \t\t\t\tint amount;\n"}}, {"oid": "08bb616f651a7d7bdfe759d3a4f06613c60c9f26", "url": "https://github.com/TownyAdvanced/Towny/commit/08bb616f651a7d7bdfe759d3a4f06613c60c9f26", "message": "Use language strings for admin economy sub-cmds.", "committedDate": "2020-03-22T19:22:46Z", "type": "commit"}]}