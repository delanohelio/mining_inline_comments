{"pr_number": 3877, "pr_title": "Hotfix/save queue", "pr_createdAt": "2020-04-05T05:18:07Z", "pr_url": "https://github.com/TownyAdvanced/Towny/pull/3877", "timeline": [{"oid": "36de6868996509f44d05ab2bffe0f07e9d86f070", "url": "https://github.com/TownyAdvanced/Towny/commit/36de6868996509f44d05ab2bffe0f07e9d86f070", "message": "Shade in paperlib for async chunk loading.", "committedDate": "2020-04-03T18:31:01Z", "type": "commit"}, {"oid": "a2a201e502c010b8f078ed0e45b35d3da8aaa67e", "url": "https://github.com/TownyAdvanced/Towny/commit/a2a201e502c010b8f078ed0e45b35d3da8aaa67e", "message": "Merge remote-tracking branch 'origin/master'", "committedDate": "2020-04-04T03:37:21Z", "type": "commit"}, {"oid": "e58883e989335f9de67f3d9b0c2e6e36ab7e09c9", "url": "https://github.com/TownyAdvanced/Towny/commit/e58883e989335f9de67f3d9b0c2e6e36ab7e09c9", "message": "actually save everything in the queue on shutdown.", "committedDate": "2020-04-05T05:14:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY5NDU2NQ==", "url": "https://github.com/TownyAdvanced/Towny/pull/3877#discussion_r403694565", "bodyText": "looks like it needs a little\n\t\t\tbufferedWriter.close();\n\t\t\tosw.close();\n\nno?", "author": "LlmDl", "createdAt": "2020-04-05T12:23:38Z", "path": "src/com/palmergames/util/FileMgmt.java", "diffHunk": "@@ -227,12 +228,10 @@ public static void stringToFile(String source, String FileName) {\n \t */\n \tpublic static void stringToFile(String source, File file) {\n \n-\t\ttry {\n-\t\t\tOutputStreamWriter out = new OutputStreamWriter(new FileOutputStream(file), StandardCharsets.UTF_8);\n-\n-\t\t\tout.write(source);\n-\t\t\tout.close();\n-\n+\t\ttry (OutputStreamWriter osw = new OutputStreamWriter(new FileOutputStream(file), StandardCharsets.UTF_8);\n+\t\t\t BufferedWriter bufferedWriter = new BufferedWriter(osw)) {\n+\t\t\t\n+\t\t\tbufferedWriter.write(source);", "originalCommit": "e58883e989335f9de67f3d9b0c2e6e36ab7e09c9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "71587bcb2dae122e5e780cfd09ff2b02090c5c40", "chunk": "diff --git a/src/com/palmergames/util/FileMgmt.java b/src/com/palmergames/util/FileMgmt.java\nindex 5dc7d9908..ea95e5e46 100644\n--- a/src/com/palmergames/util/FileMgmt.java\n+++ b/src/com/palmergames/util/FileMgmt.java\n\n@@ -232,6 +232,7 @@ public class FileMgmt {\n \t\t\t BufferedWriter bufferedWriter = new BufferedWriter(osw)) {\n \t\t\t\n \t\t\tbufferedWriter.write(source);\n+\t\t\t\n \t\t} catch (IOException e) {\n \t\t\tSystem.out.println(\"Exception \");\n \t\t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMyOTQwNA==", "url": "https://github.com/TownyAdvanced/Towny/pull/3877#discussion_r404329404", "bodyText": "Redundant since you're using try-with-resources anyway and they will be closed on scope exit.", "author": "silverwolfg11", "createdAt": "2020-04-06T19:18:07Z", "path": "src/com/palmergames/util/FileMgmt.java", "diffHunk": "@@ -247,18 +246,16 @@ public static void stringToFile(String source, File file) {\n \t */\n \tpublic static boolean listToFile(List<String> source, String targetLocation) {\n \n-\t\ttry {\n-\n-\t\t\tFile file = new File(targetLocation);\n-\t\t\tOutputStreamWriter out = new OutputStreamWriter(new FileOutputStream(file), StandardCharsets.UTF_8);\n-\n+\t\tFile file = new File(targetLocation);\n+\t\ttry(OutputStreamWriter osw = new OutputStreamWriter(new FileOutputStream(file), StandardCharsets.UTF_8);\n+\t\t\tBufferedWriter bufferedWriter = new BufferedWriter(osw)) {\n+\t\t\t\n \t\t\tfor (String aSource : source) {\n-\n-\t\t\t\tout.write(aSource + System.getProperty(\"line.separator\"));\n-\n+\t\t\t\tbufferedWriter.write(aSource + System.getProperty(\"line.separator\"));\n \t\t\t}\n \n-\t\t\tout.close();\n+\t\t\tbufferedWriter.close();\n+\t\t\tosw.close();", "originalCommit": "e58883e989335f9de67f3d9b0c2e6e36ab7e09c9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "71587bcb2dae122e5e780cfd09ff2b02090c5c40", "chunk": "diff --git a/src/com/palmergames/util/FileMgmt.java b/src/com/palmergames/util/FileMgmt.java\nindex 5dc7d9908..ea95e5e46 100644\n--- a/src/com/palmergames/util/FileMgmt.java\n+++ b/src/com/palmergames/util/FileMgmt.java\n\n@@ -245,7 +246,6 @@ public class FileMgmt {\n \t * @return true on success, false on IOException\n \t */\n \tpublic static boolean listToFile(List<String> source, String targetLocation) {\n-\n \t\tFile file = new File(targetLocation);\n \t\ttry(OutputStreamWriter osw = new OutputStreamWriter(new FileOutputStream(file), StandardCharsets.UTF_8);\n \t\t\tBufferedWriter bufferedWriter = new BufferedWriter(osw)) {\n"}}, {"oid": "71587bcb2dae122e5e780cfd09ff2b02090c5c40", "url": "https://github.com/TownyAdvanced/Towny/commit/71587bcb2dae122e5e780cfd09ff2b02090c5c40", "message": "Remove redundancy", "committedDate": "2020-04-06T20:06:12Z", "type": "commit"}]}