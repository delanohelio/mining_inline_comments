{"pr_number": 3823, "pr_title": "Handle unexpected (old or weird) OSes that may not support our directory detection.", "pr_createdAt": "2020-01-13T19:19:41Z", "pr_url": "https://github.com/MovingBlocks/Terasology/pull/3823", "timeline": [{"oid": "b5ee1519140ec4159ba61ace6051d88c132f9a21", "url": "https://github.com/MovingBlocks/Terasology/commit/b5ee1519140ec4159ba61ace6051d88c132f9a21", "message": "Added manual path chooser", "committedDate": "2020-01-09T13:52:23Z", "type": "commit"}, {"oid": "55de00b1c71128f805390dfa47cdd607660fa9f8", "url": "https://github.com/MovingBlocks/Terasology/commit/55de00b1c71128f805390dfa47cdd607660fa9f8", "message": "PathManager.java: Added user prompt on failure due to error in windowsXP. Giving the user a second chance to run the game.\nAdded a headless server condition to set the homepath as current directory.", "committedDate": "2020-01-13T19:15:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0NjI2NA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3823#discussion_r367146264", "bodyText": "ex/e?", "author": "SoniEx2", "createdAt": "2020-01-15T22:42:22Z", "path": "facades/PC/src/main/java/org/terasology/engine/Terasology.java", "diffHunk": "@@ -363,6 +364,12 @@ private static void handleLaunchArguments(String[] args) {\n \n         } catch (IOException e) {\n             reportException(e);\n+            try {\n+                PathManager.getInstance().chooseHomePathManually();\n+            } catch (IOException ex) {\n+                reportException(e);", "originalCommit": "55de00b1c71128f805390dfa47cdd607660fa9f8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzUwNTE1Ng==", "url": "https://github.com/MovingBlocks/Terasology/pull/3823#discussion_r367505156", "bodyText": "Yeah Correcting \ud83d\udc4d", "author": "sladyn98", "createdAt": "2020-01-16T16:04:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0NjI2NA=="}], "type": "inlineReview", "revised_code": {"commit": "2dce469b1d75e8e1c675430c1094344500132c26", "chunk": "diff --git a/facades/PC/src/main/java/org/terasology/engine/Terasology.java b/facades/PC/src/main/java/org/terasology/engine/Terasology.java\nindex 06da6e468..271cf7d8b 100644\n--- a/facades/PC/src/main/java/org/terasology/engine/Terasology.java\n+++ b/facades/PC/src/main/java/org/terasology/engine/Terasology.java\n\n@@ -367,10 +367,9 @@ private static void handleLaunchArguments(String[] args) {\n             try {\n                 PathManager.getInstance().chooseHomePathManually();\n             } catch (IOException ex) {\n-                reportException(e);\n+                reportException(ex);\n                 System.exit(0);\n             }\n-            System.exit(0);\n         }\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0NjQxMg==", "url": "https://github.com/MovingBlocks/Terasology/pull/3823#discussion_r367146412", "bodyText": "shouldn't this be taken out?", "author": "SoniEx2", "createdAt": "2020-01-15T22:42:48Z", "path": "facades/PC/src/main/java/org/terasology/engine/Terasology.java", "diffHunk": "@@ -363,6 +364,12 @@ private static void handleLaunchArguments(String[] args) {\n \n         } catch (IOException e) {\n             reportException(e);\n+            try {\n+                PathManager.getInstance().chooseHomePathManually();\n+            } catch (IOException ex) {\n+                reportException(e);\n+                System.exit(0);\n+            }\n             System.exit(0);", "originalCommit": "55de00b1c71128f805390dfa47cdd607660fa9f8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzUwNTI0Mg==", "url": "https://github.com/MovingBlocks/Terasology/pull/3823#discussion_r367505242", "bodyText": "Yes it should \ud83d\udc4d", "author": "sladyn98", "createdAt": "2020-01-16T16:04:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0NjQxMg=="}], "type": "inlineReview", "revised_code": {"commit": "2dce469b1d75e8e1c675430c1094344500132c26", "chunk": "diff --git a/facades/PC/src/main/java/org/terasology/engine/Terasology.java b/facades/PC/src/main/java/org/terasology/engine/Terasology.java\nindex 06da6e468..271cf7d8b 100644\n--- a/facades/PC/src/main/java/org/terasology/engine/Terasology.java\n+++ b/facades/PC/src/main/java/org/terasology/engine/Terasology.java\n\n@@ -367,10 +367,9 @@ private static void handleLaunchArguments(String[] args) {\n             try {\n                 PathManager.getInstance().chooseHomePathManually();\n             } catch (IOException ex) {\n-                reportException(e);\n+                reportException(ex);\n                 System.exit(0);\n             }\n-            System.exit(0);\n         }\n     }\n \n"}}, {"oid": "2dce469b1d75e8e1c675430c1094344500132c26", "url": "https://github.com/MovingBlocks/Terasology/commit/2dce469b1d75e8e1c675430c1094344500132c26", "message": "Corrected typos", "committedDate": "2020-01-18T13:24:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODczOTY3NA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3823#discussion_r368739674", "bodyText": "Should/can this be part of useDefaultHomePath?", "author": "skaldarnar", "createdAt": "2020-01-20T22:02:44Z", "path": "engine/src/main/java/org/terasology/engine/paths/PathManager.java", "diffHunk": "@@ -188,6 +196,24 @@ public void useDefaultHomePath() throws IOException {\n         updateDirs();\n     }\n \n+    /**\n+     * Gives user the option to manually choose home path.\n+     * @throws IOException Thrown when required directories cannot be accessed.\n+     */\n+    public void chooseHomePathManually() throws IOException {", "originalCommit": "2dce469b1d75e8e1c675430c1094344500132c26", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA0ODk5MA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3823#discussion_r369048990", "bodyText": "It could be but then it would have to catch the exception inside the useDefaultHomePath, moreover this provides a much modular approach and a generic solution to all further weird OSeS", "author": "sladyn98", "createdAt": "2020-01-21T14:56:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODczOTY3NA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODczOTk5NA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3823#discussion_r368739994", "bodyText": "If this can recover any exception that was thrown before, there is no need to reportException before trying the backup. At least, it should not be reported as an error (maybe as a warning, or probably just on INFO level).", "author": "skaldarnar", "createdAt": "2020-01-20T22:04:18Z", "path": "facades/PC/src/main/java/org/terasology/engine/Terasology.java", "diffHunk": "@@ -363,7 +364,12 @@ private static void handleLaunchArguments(String[] args) {\n \n         } catch (IOException e) {\n             reportException(e);\n-            System.exit(0);\n+            try {\n+                PathManager.getInstance().chooseHomePathManually();", "originalCommit": "2dce469b1d75e8e1c675430c1094344500132c26", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA0NTk2Ng==", "url": "https://github.com/MovingBlocks/Terasology/pull/3823#discussion_r369045966", "bodyText": "Yeah , you have a valid point I just thought that it would be good to report an exception without stopping execution. A Warning sounds like a much better approach  :)", "author": "sladyn98", "createdAt": "2020-01-21T14:51:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODczOTk5NA=="}], "type": "inlineReview", "revised_code": {"commit": "f6874fe045f76c5d5c617b6cda0ad2c045294b4d", "chunk": "diff --git a/facades/PC/src/main/java/org/terasology/engine/Terasology.java b/facades/PC/src/main/java/org/terasology/engine/Terasology.java\nindex 271cf7d8b..9924035d3 100644\n--- a/facades/PC/src/main/java/org/terasology/engine/Terasology.java\n+++ b/facades/PC/src/main/java/org/terasology/engine/Terasology.java\n\n@@ -363,7 +368,7 @@ private static void handleLaunchArguments(String[] args) {\n             }\n \n         } catch (IOException e) {\n-            reportException(e);\n+            logger.warn(\"The game cannot detect default home directory\");\n             try {\n                 PathManager.getInstance().chooseHomePathManually();\n             } catch (IOException ex) {\n"}}, {"oid": "f6874fe045f76c5d5c617b6cda0ad2c045294b4d", "url": "https://github.com/MovingBlocks/Terasology/commit/f6874fe045f76c5d5c617b6cda0ad2c045294b4d", "message": "Added logger", "committedDate": "2020-01-21T15:02:40Z", "type": "commit"}]}