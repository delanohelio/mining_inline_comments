{"pr_number": 3899, "pr_title": "feat(JOML): Migrate methods of WorldProvider", "pr_createdAt": "2020-04-20T15:26:16Z", "pr_url": "https://github.com/MovingBlocks/Terasology/pull/3899", "timeline": [{"oid": "6e6e8c8b7df948212c798211c28bf2d02e080195", "url": "https://github.com/MovingBlocks/Terasology/commit/6e6e8c8b7df948212c798211c28bf2d02e080195", "message": "vector3ic for setBlock", "committedDate": "2020-04-20T15:24:40Z", "type": "commit"}, {"oid": "1f51efb56d24e33662ec958b41ae69275afe8f5b", "url": "https://github.com/MovingBlocks/Terasology/commit/1f51efb56d24e33662ec958b41ae69275afe8f5b", "message": "updated block", "committedDate": "2020-04-20T15:32:49Z", "type": "commit"}, {"oid": "220b894553cde8ad023b3947145653dbbfe78698", "url": "https://github.com/MovingBlocks/Terasology/commit/220b894553cde8ad023b3947145653dbbfe78698", "message": "added some test cases", "committedDate": "2020-04-20T16:41:50Z", "type": "commit"}, {"oid": "9292d99201c75d8c9ab7a21dfd6f97eef7a28809", "url": "https://github.com/MovingBlocks/Terasology/commit/9292d99201c75d8c9ab7a21dfd6f97eef7a28809", "message": "added isBlockRelevant case to world provider", "committedDate": "2020-04-20T21:43:46Z", "type": "commit"}, {"oid": "2f4abaa4a4a0be4702da89ed143580d8ee0d096e", "url": "https://github.com/MovingBlocks/Terasology/commit/2f4abaa4a4a0be4702da89ed143580d8ee0d096e", "message": "updated javadocs for @Deprecated", "committedDate": "2020-04-21T21:16:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYxOTM3NQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3899#discussion_r412619375", "bodyText": "I love this test name \ud83d\udc4d", "author": "Cervator", "createdAt": "2020-04-22T02:18:41Z", "path": "engine-tests/src/test/java/org/terasology/world/EntityAwareWorldProviderTest.java", "diffHunk": "@@ -269,6 +269,16 @@ public void testEntityBecomesTemporaryWhenChangedFromAKeepActiveBlock() {\n         assertFalse(blockEntity.isActive());\n     }\n \n+    @Test\n+    public void testEntityBecomesTemporaryWhenChangedFromAKeepActiveBlockJoml() {", "originalCommit": "2f4abaa4a4a0be4702da89ed143580d8ee0d096e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMDI3OA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3899#discussion_r412620278", "bodyText": "Should we consider (in general) adding default interface implementations when adding new methods like this? That could avoid having to update some things in modulespace. In this case I'm not sure it makes sense as I only see one non-engine usage over in FlexiblePathfinding.", "author": "Cervator", "createdAt": "2020-04-22T02:21:19Z", "path": "engine/src/main/java/org/terasology/world/WorldProvider.java", "diffHunk": "@@ -29,19 +31,49 @@\n     /**\n      * An active block is in a chunk that is available and fully generated.\n      *\n-     * @param pos\n+     * @param pos The position\n      * @return Whether the given block is active\n+     * @deprecated This is scheduled for removal in an upcoming version\n+     *             method will be replaced with JOML implementation {@link #isBlockRelevant(Vector3ic)}.\n      */\n+    @Deprecated\n     boolean isBlockRelevant(Vector3i pos);\n \n+    /**\n+     *\n+     * @param pos The position\n+     * @return Whether the given block is active\n+     */\n+    boolean isBlockRelevant(Vector3ic pos);", "originalCommit": "2f4abaa4a4a0be4702da89ed143580d8ee0d096e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MTY4OA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3899#discussion_r412671688", "bodyText": "It can't hurt at the moment but a lot of this is temporary and all the old methods are going to go away anyways. It can't hurt to implement it even if the use case is limited.", "author": "pollend", "createdAt": "2020-04-22T05:03:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMDI3OA=="}], "type": "inlineReview", "revised_code": {"commit": "f8cc3bb8cf5ef4723866e600604fdec546e8877c", "chunk": "diff --git a/engine/src/main/java/org/terasology/world/WorldProvider.java b/engine/src/main/java/org/terasology/world/WorldProvider.java\nindex 2778766c4..09bff85e1 100644\n--- a/engine/src/main/java/org/terasology/world/WorldProvider.java\n+++ b/engine/src/main/java/org/terasology/world/WorldProvider.java\n\n@@ -40,7 +40,7 @@\n     boolean isBlockRelevant(Vector3i pos);\n \n     /**\n-     *\n+     * An active block is in a chunk that is available and fully generated.\n      * @param pos The position\n      * @return Whether the given block is active\n      */\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMDU5Nw==", "url": "https://github.com/MovingBlocks/Terasology/pull/3899#discussion_r412620597", "bodyText": "Some sort of descriptor for the method itself here please :-) Looks like the old method has one, can just copy it forward.", "author": "Cervator", "createdAt": "2020-04-22T02:22:11Z", "path": "engine/src/main/java/org/terasology/world/WorldProvider.java", "diffHunk": "@@ -29,19 +31,49 @@\n     /**\n      * An active block is in a chunk that is available and fully generated.\n      *\n-     * @param pos\n+     * @param pos The position\n      * @return Whether the given block is active\n+     * @deprecated This is scheduled for removal in an upcoming version\n+     *             method will be replaced with JOML implementation {@link #isBlockRelevant(Vector3ic)}.\n      */\n+    @Deprecated\n     boolean isBlockRelevant(Vector3i pos);\n \n+    /**\n+     *", "originalCommit": "2f4abaa4a4a0be4702da89ed143580d8ee0d096e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzg0Mjc3NQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3899#discussion_r417842775", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 *\n          \n          \n            \n                 * An active block is in a chunk that is available and fully generated.", "author": "skaldarnar", "createdAt": "2020-04-30T08:28:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMDU5Nw=="}], "type": "inlineReview", "revised_code": {"commit": "f8cc3bb8cf5ef4723866e600604fdec546e8877c", "chunk": "diff --git a/engine/src/main/java/org/terasology/world/WorldProvider.java b/engine/src/main/java/org/terasology/world/WorldProvider.java\nindex 2778766c4..09bff85e1 100644\n--- a/engine/src/main/java/org/terasology/world/WorldProvider.java\n+++ b/engine/src/main/java/org/terasology/world/WorldProvider.java\n\n@@ -40,7 +40,7 @@\n     boolean isBlockRelevant(Vector3i pos);\n \n     /**\n-     *\n+     * An active block is in a chunk that is available and fully generated.\n      * @param pos The position\n      * @return Whether the given block is active\n      */\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMTU5MA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3899#discussion_r412621590", "bodyText": "Explicit package like this makes me sad - can we avoid it via imports or is something in the way of that?", "author": "Cervator", "createdAt": "2020-04-22T02:25:10Z", "path": "engine/src/main/java/org/terasology/world/internal/WorldProviderWrapper.java", "diffHunk": "@@ -44,26 +46,51 @@ public boolean isBlockRelevant(Vector3i pos) {\n         return core.isBlockRelevant(pos.x, pos.y, pos.z);\n     }\n \n+    @Override\n+    public boolean isBlockRelevant(Vector3ic pos) {\n+        return core.isBlockRelevant(pos.x(), pos.y(), pos.z());\n+    }\n+\n     @Override\n     public boolean isBlockRelevant(Vector3f pos) {\n         return isBlockRelevant(new Vector3i(pos, RoundingMode.HALF_UP));\n     }\n \n+    @Override\n+    public boolean isBlockRelevant(Vector3fc pos) {\n+        return isBlockRelevant(new org.joml.Vector3i(pos, org.joml.RoundingMode.HALF_UP));", "originalCommit": "2f4abaa4a4a0be4702da89ed143580d8ee0d096e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyODEwNA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3899#discussion_r412628104", "bodyText": "nope, Vector3i conflicts with Vector3i from termath.  I expect this to be temporary until we get to the point of removing all the old methods. we can use an alias but that somehow feels worse.", "author": "pollend", "createdAt": "2020-04-22T02:45:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMTU5MA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "f8cc3bb8cf5ef4723866e600604fdec546e8877c", "url": "https://github.com/MovingBlocks/Terasology/commit/f8cc3bb8cf5ef4723866e600604fdec546e8877c", "message": "Update engine/src/main/java/org/terasology/world/WorldProvider.java", "committedDate": "2020-04-30T08:29:57Z", "type": "commit"}]}