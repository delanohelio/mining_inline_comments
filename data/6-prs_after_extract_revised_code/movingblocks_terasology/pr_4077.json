{"pr_number": 4077, "pr_title": "Derive player height from CharacterMovementComponent instead of BoxShapeComponent", "pr_createdAt": "2020-07-12T14:38:55Z", "pr_url": "https://github.com/MovingBlocks/Terasology/pull/4077", "timeline": [{"oid": "7564923b6314cd6c282cb82d3ef2eb44d2a9cee0", "url": "https://github.com/MovingBlocks/Terasology/commit/7564923b6314cd6c282cb82d3ef2eb44d2a9cee0", "message": "Derive player height from CharacterMovementComponent instead of BoxShapeComponent.", "committedDate": "2020-07-12T14:32:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyNzA4NA==", "url": "https://github.com/MovingBlocks/Terasology/pull/4077#discussion_r453327084", "bodyText": "This can be a bit more specific now stating that the player entity does not have a CharacterMovementComponent.", "author": "skaldarnar", "createdAt": "2020-07-12T15:00:13Z", "path": "engine/src/main/java/org/terasology/logic/players/PlayerFactory.java", "diffHunk": "@@ -99,30 +94,9 @@ public Vector3f findSpawnPositionFromLocationComponent(LocationComponent locatio\n     }\n \n     private float getHeightOf(ComponentContainer prefab) {\n-        BoxShapeComponent box = prefab.getComponent(BoxShapeComponent.class);\n-        if (box != null) {\n-            return box.extents.getY();\n-        }\n-\n-        CylinderShapeComponent cylinder = prefab.getComponent(CylinderShapeComponent.class);\n-        if (cylinder != null) {\n-            return cylinder.height;\n-        }\n-\n-        CapsuleShapeComponent capsule = prefab.getComponent(CapsuleShapeComponent.class);\n-        if (capsule != null) {\n-            return capsule.height;\n-        }\n-\n-        SphereShapeComponent sphere = prefab.getComponent(SphereShapeComponent.class);\n-        if (sphere != null) {\n-            return sphere.radius * 2.0f;\n-        }\n-\n-        HullShapeComponent hull = prefab.getComponent(HullShapeComponent.class);\n-        if (hull != null) {\n-            AABB aabb = hull.sourceMesh.getAABB();\n-            return aabb.maxY() - aabb.minY();\n+        CharacterMovementComponent movementComponent = prefab.getComponent(CharacterMovementComponent.class);\n+        if (movementComponent != null) {\n+            return movementComponent.height;\n         }\n \n         logger.warn(\"entity {} does not have any known extent specification - using default\", prefab);", "originalCommit": "7564923b6314cd6c282cb82d3ef2eb44d2a9cee0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2412e6f21564544833fe3971990b638720936d1b", "chunk": "diff --git a/engine/src/main/java/org/terasology/logic/players/PlayerFactory.java b/engine/src/main/java/org/terasology/logic/players/PlayerFactory.java\nindex b73850e13..4de225794 100644\n--- a/engine/src/main/java/org/terasology/logic/players/PlayerFactory.java\n+++ b/engine/src/main/java/org/terasology/logic/players/PlayerFactory.java\n\n@@ -99,7 +99,7 @@ private float getHeightOf(ComponentContainer prefab) {\n             return movementComponent.height;\n         }\n \n-        logger.warn(\"entity {} does not have any known extent specification - using default\", prefab);\n+        logger.warn(\"entity {} does not have a CharacterMovementComponent - using default height\", prefab);\n         return 1.0f;\n     }\n \n"}}, {"oid": "2412e6f21564544833fe3971990b638720936d1b", "url": "https://github.com/MovingBlocks/Terasology/commit/2412e6f21564544833fe3971990b638720936d1b", "message": "Add a bit more documentation.", "committedDate": "2020-07-12T16:25:12Z", "type": "commit"}]}