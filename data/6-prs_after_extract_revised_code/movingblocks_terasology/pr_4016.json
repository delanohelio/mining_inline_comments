{"pr_number": 4016, "pr_title": "refactor: remove dead code", "pr_createdAt": "2020-06-01T13:07:58Z", "pr_url": "https://github.com/MovingBlocks/Terasology/pull/4016", "timeline": [{"oid": "d91250967f9f03342d17fb62a2cae35b760d1b97", "url": "https://github.com/MovingBlocks/Terasology/commit/d91250967f9f03342d17fb62a2cae35b760d1b97", "message": "refactor: remove dead code; reduce logging", "committedDate": "2020-06-01T12:45:22Z", "type": "commit"}, {"oid": "59c45e2e14fa02bf000765db89bb335985bc4cf2", "url": "https://github.com/MovingBlocks/Terasology/commit/59c45e2e14fa02bf000765db89bb335985bc4cf2", "message": "chore: remove unused internal class BlockUpdate", "committedDate": "2020-06-01T12:45:47Z", "type": "commit"}, {"oid": "345951bccbe04ce6b7cd6ef09a21c21f6925b2a5", "url": "https://github.com/MovingBlocks/Terasology/commit/345951bccbe04ce6b7cd6ef09a21c21f6925b2a5", "message": "chore: remove unused imports", "committedDate": "2020-06-01T13:42:37Z", "type": "commit"}, {"oid": "993e7164a9f22164b96a578086f8d48e285ed3c3", "url": "https://github.com/MovingBlocks/Terasology/commit/993e7164a9f22164b96a578086f8d48e285ed3c3", "message": "chore: remove duplicated ComponentClassTypeHandler", "committedDate": "2020-06-01T14:09:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzM2MzE3Mw==", "url": "https://github.com/MovingBlocks/Terasology/pull/4016#discussion_r433363173", "bodyText": "newline\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            }\n          \n          \n            \n            }", "author": "jdrueckert", "createdAt": "2020-06-01T16:56:58Z", "path": "engine/src/main/java/org/terasology/persistence/typeHandling/extensionTypes/ComponentClassTypeHandler.java", "diffHunk": "@@ -17,22 +17,23 @@\n \n import org.terasology.entitySystem.Component;\n import org.terasology.persistence.typeHandling.StringRepresentationTypeHandler;\n+import org.terasology.persistence.typeHandling.TypeHandlerContext;\n \n public class ComponentClassTypeHandler extends StringRepresentationTypeHandler<Class<? extends Component>> {\n \n+    TypeHandlerContext context;\n+\n+    public ComponentClassTypeHandler(final TypeHandlerContext context) {\n+        this.context = context;\n+    }\n+\n     @Override\n     public String getAsString(Class<? extends Component> item) {\n-        return item.getName();\n+        return context.getSandbox().getSubTypeIdentifier(item, Component.class);\n     }\n \n     @Override\n     public Class<? extends Component> getFromString(String representation) {\n-        try {\n-            final Class<? extends Component> clazz = Class.forName(representation).asSubclass(Component.class);\n-            return clazz;\n-        } catch (ClassNotFoundException e) {\n-            e.printStackTrace();\n-            return null;\n-        }\n+        return context.getSandbox().findSubTypeOf(representation, Component.class).orElse(null);\n     }\n-}\n+}", "originalCommit": "993e7164a9f22164b96a578086f8d48e285ed3c3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "bfd81e3909ae5a5d8e19f21dccfb55481ea0c5b7", "chunk": "diff --git a/engine/src/main/java/org/terasology/persistence/typeHandling/extensionTypes/ComponentClassTypeHandler.java b/engine/src/main/java/org/terasology/persistence/typeHandling/extensionTypes/ComponentClassTypeHandler.java\nindex 4e581c183..04c2d666f 100644\n--- a/engine/src/main/java/org/terasology/persistence/typeHandling/extensionTypes/ComponentClassTypeHandler.java\n+++ b/engine/src/main/java/org/terasology/persistence/typeHandling/extensionTypes/ComponentClassTypeHandler.java\n\n@@ -36,4 +36,4 @@ public String getAsString(Class<? extends Component> item) {\n     public Class<? extends Component> getFromString(String representation) {\n         return context.getSandbox().findSubTypeOf(representation, Component.class).orElse(null);\n     }\n-}\n\\ No newline at end of file\n+}\n"}}, {"oid": "bfd81e3909ae5a5d8e19f21dccfb55481ea0c5b7", "url": "https://github.com/MovingBlocks/Terasology/commit/bfd81e3909ae5a5d8e19f21dccfb55481ea0c5b7", "message": "Update engine/src/main/java/org/terasology/persistence/typeHandling/extensionTypes/ComponentClassTypeHandler.java", "committedDate": "2020-06-01T21:15:58Z", "type": "commit"}, {"oid": "aa506136c1dd3e265bef84df667ae8ad4c1737c3", "url": "https://github.com/MovingBlocks/Terasology/commit/aa506136c1dd3e265bef84df667ae8ad4c1737c3", "message": "Merge branch 'develop' into topic/remove-dead-code", "committedDate": "2020-06-01T21:21:47Z", "type": "commit"}, {"oid": "0a20f22e15ed660e32d68538e833653a53e2c8a9", "url": "https://github.com/MovingBlocks/Terasology/commit/0a20f22e15ed660e32d68538e833653a53e2c8a9", "message": "fix: reset WorldRendererImpl", "committedDate": "2020-06-01T21:33:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU3ODgxMw==", "url": "https://github.com/MovingBlocks/Terasology/pull/4016#discussion_r433578813", "bodyText": "This is the only thing in this PR that's not just a straight deletion. And it looks okay from here.\nIt does change the constructor, but presumably that's the sort of thing that you'd find out pretty fast as soon as you tried to compile against it.\nActually ... where is this class used? it's not in my workspace.", "author": "keturn", "createdAt": "2020-06-02T01:53:10Z", "path": "engine/src/main/java/org/terasology/persistence/typeHandling/extensionTypes/ComponentClassTypeHandler.java", "diffHunk": "@@ -17,22 +17,23 @@\n \n import org.terasology.entitySystem.Component;\n import org.terasology.persistence.typeHandling.StringRepresentationTypeHandler;\n+import org.terasology.persistence.typeHandling.TypeHandlerContext;\n \n public class ComponentClassTypeHandler extends StringRepresentationTypeHandler<Class<? extends Component>> {\n \n+    TypeHandlerContext context;\n+\n+    public ComponentClassTypeHandler(final TypeHandlerContext context) {\n+        this.context = context;\n+    }\n+\n     @Override\n     public String getAsString(Class<? extends Component> item) {\n-        return item.getName();\n+        return context.getSandbox().getSubTypeIdentifier(item, Component.class);\n     }\n \n     @Override\n     public Class<? extends Component> getFromString(String representation) {\n-        try {\n-            final Class<? extends Component> clazz = Class.forName(representation).asSubclass(Component.class);\n-            return clazz;\n-        } catch (ClassNotFoundException e) {\n-            e.printStackTrace();\n-            return null;\n-        }\n+        return context.getSandbox().findSubTypeOf(representation, Component.class).orElse(null);", "originalCommit": "0a20f22e15ed660e32d68538e833653a53e2c8a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI3NzE5Mw==", "url": "https://github.com/MovingBlocks/Terasology/pull/4016#discussion_r436277193", "bodyText": "Ah, this is actually some sneaky little code cleanup \ud83e\udd13\nThis class here existed, but was never used. However, there existed another inner class with exact same name (and purpose) in ComponentClassTypeHandlerFactory. As I don't like inner classes, I thought it would be better to have the correct code in this class, which is now used by the factory.\nSee https://github.com/MovingBlocks/Terasology/pull/4016/files#diff-7fd63f399c356366e5f1abab7dc34ebcL40-L57", "author": "skaldarnar", "createdAt": "2020-06-06T15:26:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU3ODgxMw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "9990c160b227c0b0dca79e98db185b81fdcea673", "url": "https://github.com/MovingBlocks/Terasology/commit/9990c160b227c0b0dca79e98db185b81fdcea673", "message": "Merge remote-tracking branch 'origin/develop' into topic/remove-dead-code", "committedDate": "2020-06-06T15:34:57Z", "type": "commit"}]}