{"pr_number": 3757, "pr_title": "Feature/3741/fix hiding tool versions", "pr_createdAt": "2020-08-26T00:10:26Z", "pr_url": "https://github.com/dockstore/dockstore/pull/3757", "timeline": [{"oid": "b6d4b7255e6ab3538b8cb47eeae39259c306e92c", "url": "https://github.com/dockstore/dockstore/commit/b6d4b7255e6ab3538b8cb47eeae39259c306e92c", "message": "Fixed hiding tool versions\n\ndockstore/dockstore#3741\n\nHiding a tool version no longer returns a 400 error: Unable to process\nJSON\n\nCause of the issue was that versionMetadata that is passed from the UI\ncan be null, which causes a NullPointerException when used with addAll()\n\nAdded a check to ensure that parsedInformationSet is not NULL", "committedDate": "2020-08-25T23:02:54Z", "type": "commit"}, {"oid": "910b8c4ac484eb4ec114550c89f4db1e8944b750", "url": "https://github.com/dockstore/dockstore/commit/910b8c4ac484eb4ec114550c89f4db1e8944b750", "message": "Added an additional test for the fix", "committedDate": "2020-08-26T00:03:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM0NjA3NQ==", "url": "https://github.com/dockstore/dockstore/pull/3757#discussion_r477346075", "bodyText": "Oh, I see the reason for Gary's comment. We should not be able to blank the version data by API this way.\nSet just the hidden attribute to avoid breakage when we fix this", "author": "denis-yuen", "createdAt": "2020-08-26T14:29:20Z", "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/GeneralIT.java", "diffHunk": "@@ -711,6 +711,17 @@ public void testVersionTagHide() {\n         final long count2 = testingPostgres\n             .runSelectStatement(\"select count(*) from tag t, version_metadata vm where vm.hidden = 't' and t.id = vm.id\", long.class);\n         assertEquals(\"there should be 0 hidden tag\", 0, count2);\n+\n+        tags = new ArrayList<>();\n+        updatedTag = tag.get();\n+        updatedTag.setHidden(true);\n+        updatedTag.setVersionMetadata(null);", "originalCommit": "910b8c4ac484eb4ec114550c89f4db1e8944b750", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM1MTU0MQ==", "url": "https://github.com/dockstore/dockstore/pull/3757#discussion_r477351541", "bodyText": "@garyluu Yeah I misunderstood, I also agree we should not be able to blank the version metadata directly.", "author": "agduncan94", "createdAt": "2020-08-26T14:36:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM0NjA3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ5NjM0Mg==", "url": "https://github.com/dockstore/dockstore/pull/3757#discussion_r477496342", "bodyText": "Reverted the integration test to what it was on develop. No need to add new tests as current tests already set the hidden attribute.", "author": "ByteMap", "createdAt": "2020-08-26T18:17:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM0NjA3NQ=="}], "type": "inlineReview", "revised_code": {"commit": "0ea4d1db63136e6d0ddf987388383bdae64c314b", "chunk": "diff --git a/dockstore-integration-testing/src/test/java/io/dockstore/client/cli/GeneralIT.java b/dockstore-integration-testing/src/test/java/io/dockstore/client/cli/GeneralIT.java\nindex 0ce06c5b1..d5516c180 100644\n--- a/dockstore-integration-testing/src/test/java/io/dockstore/client/cli/GeneralIT.java\n+++ b/dockstore-integration-testing/src/test/java/io/dockstore/client/cli/GeneralIT.java\n\n@@ -711,17 +711,6 @@ public class GeneralIT extends BaseIT {\n         final long count2 = testingPostgres\n             .runSelectStatement(\"select count(*) from tag t, version_metadata vm where vm.hidden = 't' and t.id = vm.id\", long.class);\n         assertEquals(\"there should be 0 hidden tag\", 0, count2);\n-\n-        tags = new ArrayList<>();\n-        updatedTag = tag.get();\n-        updatedTag.setHidden(true);\n-        updatedTag.setVersionMetadata(null);\n-        tags.add(updatedTag);\n-        toolTagsApi.updateTags(tool.getId(), tags);\n-        toolApi.refresh(tool.getId());\n-        final long count3 = testingPostgres\n-                .runSelectStatement(\"select count(*) from tag t, version_metadata vm where vm.hidden = 't' and t.id = vm.id\", long.class);\n-        assertEquals(\"there should be 1 hidden tag\", 1, count3);\n     }\n \n     /**\n"}}, {"oid": "0ea4d1db63136e6d0ddf987388383bdae64c314b", "url": "https://github.com/dockstore/dockstore/commit/0ea4d1db63136e6d0ddf987388383bdae64c314b", "message": "Reverted THIRD-PARTY-LICENSES.txt and CI test", "committedDate": "2020-08-26T18:15:57Z", "type": "commit"}, {"oid": "23ad4363b45c117c737a35ed10ae8a8a87c806dc", "url": "https://github.com/dockstore/dockstore/commit/23ad4363b45c117c737a35ed10ae8a8a87c806dc", "message": "Merge branch 'develop' into feature/3741/fixHidingToolVersions", "committedDate": "2020-08-27T18:56:08Z", "type": "commit"}, {"oid": "90819a7719eb8d9c00a87cc5f765cb2cc1e106dd", "url": "https://github.com/dockstore/dockstore/commit/90819a7719eb8d9c00a87cc5f765cb2cc1e106dd", "message": "Updated comment specifying deserializer as the reason for checker", "committedDate": "2020-08-27T21:30:18Z", "type": "commit"}, {"oid": "b61ceb10575a72130c374be1543973494b0ce256", "url": "https://github.com/dockstore/dockstore/commit/b61ceb10575a72130c374be1543973494b0ce256", "message": "Merge branch 'feature/3741/fixHidingToolVersions' of github.com:dockstore/dockstore into feature/3741/fixHidingToolVersions", "committedDate": "2020-08-27T21:30:50Z", "type": "commit"}, {"oid": "2596837d7d9da35e75b3edc0367c7856fab2c7f0", "url": "https://github.com/dockstore/dockstore/commit/2596837d7d9da35e75b3edc0367c7856fab2c7f0", "message": "Merge branch 'develop' into feature/3741/fixHidingToolVersions", "committedDate": "2020-08-28T17:11:40Z", "type": "commit"}]}