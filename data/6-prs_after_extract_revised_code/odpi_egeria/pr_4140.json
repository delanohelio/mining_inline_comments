{"pr_number": 4140, "pr_title": "Initial load trigger load for single asset", "pr_createdAt": "2020-11-24T14:56:08Z", "pr_url": "https://github.com/odpi/egeria/pull/4140", "timeline": [{"oid": "798da5f11077c8ff34a616e6e9b0fcfa8799c3ce", "url": "https://github.com/odpi/egeria/commit/798da5f11077c8ff34a616e6e9b0fcfa8799c3ce", "message": "Created endpoint to trigger initial load for a single entity\n\nSigned-off-by: marius-patrascu <marius-florin.patrascu@ing.com>", "committedDate": "2020-11-24T14:42:54Z", "type": "commit"}, {"oid": "55d88fa802b1d56a57076896e6cc790c1e274504", "url": "https://github.com/odpi/egeria/commit/55d88fa802b1d56a57076896e6cc790c1e274504", "message": "fixd javadoc\n\nSigned-off-by: marius-patrascu <marius-florin.patrascu@ing.com>", "committedDate": "2020-11-24T14:50:40Z", "type": "commit"}, {"oid": "3ff401f871b7554395e954e5b295d8dc1f30bcb3", "url": "https://github.com/odpi/egeria/commit/3ff401f871b7554395e954e5b295d8dc1f30bcb3", "message": "small fixes\n\nSigned-off-by: marius-patrascu <marius-florin.patrascu@ing.com>", "committedDate": "2020-11-24T14:55:01Z", "type": "commit"}, {"oid": "b87d70565e7cea40f1bcb4d521b77336ed76fe78", "url": "https://github.com/odpi/egeria/commit/b87d70565e7cea40f1bcb4d521b77336ed76fe78", "message": "Merge branch 'master' into Initial-Load-trigger-load-for-single-asset", "committedDate": "2020-11-24T14:56:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTYwOTc3Mg==", "url": "https://github.com/odpi/egeria/pull/4140#discussion_r529609772", "bodyText": "method name does not match should be \"publishEntity\" for better traceability", "author": "lpalashevski", "createdAt": "2020-11-24T14:58:47Z", "path": "open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/AssetLineageRestServices.java", "diffHunk": "@@ -91,6 +91,38 @@ public GUIDListResponse publishEntities(String serverName, String userId, String\n         return response;\n     }\n \n+\n+    public GUIDListResponse publishEntity(String serverName, String userId, String entityType, String guid) {\n+        GUIDListResponse response = new GUIDListResponse();\n+\n+        String methodName = \"publishEntities\";", "originalCommit": "b87d70565e7cea40f1bcb4d521b77336ed76fe78", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "540ccd3f8e0d5efc7e29ddf4957a5ed8874933f3", "chunk": "diff --git a/open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/AssetLineageRestServices.java b/open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/AssetLineageRestServices.java\nindex 4deccaab12..0918f136a2 100644\n--- a/open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/AssetLineageRestServices.java\n+++ b/open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/AssetLineageRestServices.java\n\n@@ -95,7 +95,7 @@ public class AssetLineageRestServices {\n     public GUIDListResponse publishEntity(String serverName, String userId, String entityType, String guid) {\n         GUIDListResponse response = new GUIDListResponse();\n \n-        String methodName = \"publishEntities\";\n+        String methodName = \"publishEntity\";\n         try {\n             AssetContextHandler assetContextHandler = instanceHandler.getAssetContextHandler(userId, serverName, methodName);\n             EntityDetail entityByTypeAndGuid = assetContextHandler.getEntityByTypeAndGuid(userId, guid, entityType);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTYxNjYwOA==", "url": "https://github.com/odpi/egeria/pull/4140#discussion_r529616608", "bodyText": "I am not sure if we have agreed on Egeria-wide REST API endpoint design practices but having /guid/ in the path seems bit odd to me. I would prefer to have it without this part and call parameter id instead. The fact that is guid is just a choice and format of an identifier.\nSo my proposal for this endpoint is: /publish-entity/{entityType}/{id}\n@popa-raluca any thoughts from the previous practice with rest endpoints?", "author": "lpalashevski", "createdAt": "2020-11-24T15:07:33Z", "path": "open-metadata-implementation/access-services/asset-lineage/asset-lineage-spring/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/spring/AssetLineageResource.java", "diffHunk": "@@ -37,4 +37,21 @@ public GUIDListResponse publishEntities(@PathVariable String serverName,\n                                             @PathVariable String entityType) {\n         return restAPI.publishEntities(serverName, userId, entityType);\n     }\n+\n+    /**\n+     * Find the entity by guid and publish the context for it\n+     *\n+     * @param serverName name of server instance to call\n+     * @param userId     the name of the calling user\n+     * @param guid       the guid of the entity to build context\n+     * @param entityType the name of the relationship type\n+     * @return a list of unique identifiers (guids) of the available entity with the given type provided as a response\n+     */\n+    @GetMapping(path = \"/publish-entity/{entityType}/guid/{guid}\")", "originalCommit": "b87d70565e7cea40f1bcb4d521b77336ed76fe78", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "540ccd3f8e0d5efc7e29ddf4957a5ed8874933f3", "chunk": "diff --git a/open-metadata-implementation/access-services/asset-lineage/asset-lineage-spring/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/spring/AssetLineageResource.java b/open-metadata-implementation/access-services/asset-lineage/asset-lineage-spring/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/spring/AssetLineageResource.java\nindex 790d16afd8..5f984b6f59 100644\n--- a/open-metadata-implementation/access-services/asset-lineage/asset-lineage-spring/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/spring/AssetLineageResource.java\n+++ b/open-metadata-implementation/access-services/asset-lineage/asset-lineage-spring/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/server/spring/AssetLineageResource.java\n\n@@ -47,7 +47,7 @@ public class AssetLineageResource {\n      * @param entityType the name of the relationship type\n      * @return a list of unique identifiers (guids) of the available entity with the given type provided as a response\n      */\n-    @GetMapping(path = \"/publish-entity/{entityType}/guid/{guid}\")\n+    @GetMapping(path = \"/publish-entity/{entityType}/{guid}\")\n     public GUIDListResponse publishEntitiesTest(@PathVariable String serverName,\n                                             @PathVariable String userId,\n                                             @PathVariable String guid,\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTY0NDgyMA==", "url": "https://github.com/odpi/egeria/pull/4140#discussion_r529644820", "bodyText": "Thinking about this better now, does not seem like ERROR. There can be valid entity that does not have relationships and what asset lineage should do is log this as INFO because of the fact that it is filtering it out. Also suggesting to skip sending the lineage event (otherwise we are sending empty lineage events). This also applies for similar method \"publishProcessContext\"", "author": "lpalashevski", "createdAt": "2020-11-24T15:35:09Z", "path": "open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/outtopic/AssetLineagePublisher.java", "diffHunk": "@@ -113,7 +113,7 @@ public void publishGlossaryContext(String glossaryTermGUID) throws OCFCheckedExc\n         Map<String, Set<GraphContext>> context = glossaryHandler.buildGlossaryTermContext(serverUserName, entityDetail);\n \n         if (MapUtils.isEmpty(context)) {\n-            log.debug(\"Context not found for the entity {} \", entityDetail.getGUID());\n+            log.error(\"Context not found for the entity {} \", entityDetail.getGUID());", "originalCommit": "b87d70565e7cea40f1bcb4d521b77336ed76fe78", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "540ccd3f8e0d5efc7e29ddf4957a5ed8874933f3", "chunk": "diff --git a/open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/outtopic/AssetLineagePublisher.java b/open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/outtopic/AssetLineagePublisher.java\nindex a9e8c73f49..88899149ce 100644\n--- a/open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/outtopic/AssetLineagePublisher.java\n+++ b/open-metadata-implementation/access-services/asset-lineage/asset-lineage-server/src/main/java/org/odpi/openmetadata/accessservices/assetlineage/outtopic/AssetLineagePublisher.java\n\n@@ -113,7 +113,7 @@ public class AssetLineagePublisher {\n         Map<String, Set<GraphContext>> context = glossaryHandler.buildGlossaryTermContext(serverUserName, entityDetail);\n \n         if (MapUtils.isEmpty(context)) {\n-            log.error(\"Context not found for the entity {} \", entityDetail.getGUID());\n+            log.info(\"Context not found for the entity {} \", entityDetail.getGUID());\n             return Collections.emptyMap();\n         }\n \n"}}, {"oid": "540ccd3f8e0d5efc7e29ddf4957a5ed8874933f3", "url": "https://github.com/odpi/egeria/commit/540ccd3f8e0d5efc7e29ddf4957a5ed8874933f3", "message": "changes after pull review\n\nSigned-off-by: marius-patrascu <marius-florin.patrascu@ing.com>", "committedDate": "2020-11-24T16:06:36Z", "type": "commit"}, {"oid": "7472408a8dde7106ce6947fbe8be09676589bd01", "url": "https://github.com/odpi/egeria/commit/7472408a8dde7106ce6947fbe8be09676589bd01", "message": "merge", "committedDate": "2020-11-24T16:07:27Z", "type": "commit"}]}