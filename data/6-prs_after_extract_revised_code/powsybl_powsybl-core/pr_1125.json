{"pr_number": 1125, "pr_title": "Tck", "pr_createdAt": "2020-01-20T16:48:38Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1125", "timeline": [{"oid": "77165791e9c11aff88b385ac33aca40dc0656fdf", "url": "https://github.com/powsybl/powsybl-core/commit/77165791e9c11aff88b385ac33aca40dc0656fdf", "message": "Move Validable, ValidationException and ValidationUtil to iidm-api, Extract iidm-impl tests in a tck\n\nSome tests that are too tied to the implementations\nare not yet moved\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-01-20T17:22:24Z", "type": "forcePushed"}, {"oid": "a4ee7e5b61f3b819956e1d78b7cb14c0690e1272", "url": "https://github.com/powsybl/powsybl-core/commit/a4ee7e5b61f3b819956e1d78b7cb14c0690e1272", "message": "fix sonar issues\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-01-20T18:18:14Z", "type": "forcePushed"}, {"oid": "86e76759c98a979a051c6f576846b9a3b51723ed", "url": "https://github.com/powsybl/powsybl-core/commit/86e76759c98a979a051c6f576846b9a3b51723ed", "message": "fix sonar issues\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-01-20T18:24:54Z", "type": "forcePushed"}, {"oid": "c8222d2dd86760a3e6de12f45255474316f8e63c", "url": "https://github.com/powsybl/powsybl-core/commit/c8222d2dd86760a3e6de12f45255474316f8e63c", "message": "fix sonar issues\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-01-20T18:44:43Z", "type": "forcePushed"}, {"oid": "a9e733e6f1bfed64a6c50a8bf311335729a7d5f2", "url": "https://github.com/powsybl/powsybl-core/commit/a9e733e6f1bfed64a6c50a8bf311335729a7d5f2", "message": "fix sonar issues\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-01-20T18:49:25Z", "type": "forcePushed"}, {"oid": "df49edfed7aafa227a0ab02d463f8209c7ee39fc", "url": "https://github.com/powsybl/powsybl-core/commit/df49edfed7aafa227a0ab02d463f8209c7ee39fc", "message": "fix sonar issues\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-01-20T19:09:12Z", "type": "forcePushed"}, {"oid": "5fdd608e8b62e3f10f63193f8af052a9f1fff0ce", "url": "https://github.com/powsybl/powsybl-core/commit/5fdd608e8b62e3f10f63193f8af052a9f1fff0ce", "message": "tck AbstractThreeWindingTransformerTest, improve coverage\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-01-22T14:31:11Z", "type": "forcePushed"}, {"oid": "e0445aa3e209f3c0d9a0a518df9e4e8635aac846", "url": "https://github.com/powsybl/powsybl-core/commit/e0445aa3e209f3c0d9a0a518df9e4e8635aac846", "message": "Move Validable, ValidationException and ValidationUtil to iidm-api, Extract iidm-impl tests in a tck\n\nSome tests that are too tied to the implementations\nare not yet moved\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-03T13:22:45Z", "type": "commit"}, {"oid": "c48120210c7d8078c1ce0c0818e64d285c97dd4d", "url": "https://github.com/powsybl/powsybl-core/commit/c48120210c7d8078c1ce0c0818e64d285c97dd4d", "message": "fix sonar issues\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-03T13:22:46Z", "type": "commit"}, {"oid": "9d4dc1b402318a1435ea06ee8395562730038ce9", "url": "https://github.com/powsybl/powsybl-core/commit/9d4dc1b402318a1435ea06ee8395562730038ce9", "message": "don't disable sonar on iidm-tck\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-03T13:22:46Z", "type": "commit"}, {"oid": "2e60872d73791256028e323032a3e8c14c61c530", "url": "https://github.com/powsybl/powsybl-core/commit/2e60872d73791256028e323032a3e8c14c61c530", "message": "Fix sonar issues\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-03T13:22:46Z", "type": "commit"}, {"oid": "622cc4f64b831017ffd99b021c59877522dd6000", "url": "https://github.com/powsybl/powsybl-core/commit/622cc4f64b831017ffd99b021c59877522dd6000", "message": "Move iidm-tck to its own package to avoid split packages\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-03T13:22:46Z", "type": "commit"}, {"oid": "eafd31046f97b10ec6d6f08991c935b2576acbda", "url": "https://github.com/powsybl/powsybl-core/commit/eafd31046f97b10ec6d6f08991c935b2576acbda", "message": "tck AbstractThreeWindingTransformerTest, improve coverage\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-03T13:22:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDEyNjE0Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1125#discussion_r374126142", "bodyText": "i < 6?", "author": "mathbagu", "createdAt": "2020-02-03T14:18:17Z", "path": "iidm/iidm-tck/src/main/java/com/powsybl/iidm/network/tck/AbstractNodeBreakerInternalConnectionsTest.java", "diffHunk": "@@ -13,29 +13,25 @@\n import static com.powsybl.iidm.network.VoltageLevel.NodeBreakerView.InternalConnection;\n import static org.junit.Assert.assertEquals;\n \n-public class NodeBreakerInternalConnectionsTest {\n+public abstract class AbstractNodeBreakerInternalConnectionsTest {\n+\n+    private static final String S5_10K_V = \"S5 10kV\";\n \n     @Test\n     public void testTraversalInternalConnections() {\n         Network network = Network.create(\"testTraversalInternalConnections\", \"test\");\n         InternalConnections all = new InternalConnections();\n         createNetwork(network, all);\n-        VoltageLevel vl = network.getVoltageLevel(\"S5 10kV\");\n+        VoltageLevel vl = network.getVoltageLevel(S5_10K_V);\n \n         assertEquals(6, vl.getNodeBreakerView().getInternalConnectionCount());\n         List<InternalConnection> internalConnections = vl.getNodeBreakerView().getInternalConnectionStream().collect(Collectors.toList());\n-        assertEquals(7, internalConnections.get(0).getNode1());\n-        assertEquals(0, internalConnections.get(0).getNode2());\n-        assertEquals(6, internalConnections.get(1).getNode1());\n-        assertEquals(3, internalConnections.get(1).getNode2());\n-        assertEquals(4, internalConnections.get(2).getNode1());\n-        assertEquals(3, internalConnections.get(2).getNode2());\n-        assertEquals(5, internalConnections.get(3).getNode1());\n-        assertEquals(2, internalConnections.get(3).getNode2());\n-        assertEquals(9, internalConnections.get(4).getNode1());\n-        assertEquals(2, internalConnections.get(4).getNode2());\n-        assertEquals(8, internalConnections.get(5).getNode1());\n-        assertEquals(1, internalConnections.get(5).getNode2());\n+        int[] expecteds1 = new int[] {7, 6, 4, 5, 9, 8 };\n+        int[] expecteds2 = new int[] {0, 3, 3, 2, 2, 1 };\n+        for (int i = 0; i < 5; i++) {", "originalCommit": "eafd31046f97b10ec6d6f08991c935b2576acbda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDEzMjk2MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1125#discussion_r374132960", "bodyText": "good catch, i < expecteds1.length ?", "author": "jonenst", "createdAt": "2020-02-03T14:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDEyNjE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE0ODI5NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1125#discussion_r374148294", "bodyText": "why not", "author": "mathbagu", "createdAt": "2020-02-03T14:56:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDEyNjE0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "528456dbc2b8c0d671badb59123d992051d84301", "chunk": "diff --git a/iidm/iidm-tck/src/main/java/com/powsybl/iidm/network/tck/AbstractNodeBreakerInternalConnectionsTest.java b/iidm/iidm-tck/src/main/java/com/powsybl/iidm/network/tck/AbstractNodeBreakerInternalConnectionsTest.java\nindex a006a8938..8aec5461e 100644\n--- a/iidm/iidm-tck/src/main/java/com/powsybl/iidm/network/tck/AbstractNodeBreakerInternalConnectionsTest.java\n+++ b/iidm/iidm-tck/src/main/java/com/powsybl/iidm/network/tck/AbstractNodeBreakerInternalConnectionsTest.java\n\n@@ -28,7 +28,8 @@ public abstract class AbstractNodeBreakerInternalConnectionsTest {\n         List<InternalConnection> internalConnections = vl.getNodeBreakerView().getInternalConnectionStream().collect(Collectors.toList());\n         int[] expecteds1 = new int[] {7, 6, 4, 5, 9, 8 };\n         int[] expecteds2 = new int[] {0, 3, 3, 2, 2, 1 };\n-        for (int i = 0; i < 5; i++) {\n+        assertEquals(expecteds1.length, expecteds2.length);\n+        for (int i = 0; i < expecteds1.length; i++) {\n             assertEquals(expecteds1[i], internalConnections.get(i).getNode1());\n             assertEquals(expecteds2[i], internalConnections.get(i).getNode2());\n         }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDEyNjg2Nw==", "url": "https://github.com/powsybl/powsybl-core/pull/1125#discussion_r374126867", "bodyText": "Could you certify this is equivalent?", "author": "mathbagu", "createdAt": "2020-02-03T14:19:37Z", "path": "iidm/iidm-tck/src/main/java/com/powsybl/iidm/network/tck/AbstractTapChangerTest.java", "diffHunk": "@@ -220,18 +222,7 @@ public void testTapChangerSetterGetterInMultiVariants() {\n \n         variantManager.setWorkingVariant(\"s4\");\n         // check values cloned by extend\n-        assertEquals(1, phaseTapChanger.getTapPosition());\n-        assertFalse(phaseTapChanger.isRegulating());\n-        assertEquals(1.0, phaseTapChanger.getRegulationValue(), 0.0);\n-        assertEquals(1, ratioTapChanger.getTapPosition());\n-        assertTrue(ratioTapChanger.isRegulating());\n-        assertEquals(10.0, ratioTapChanger.getTargetV(), 0.0);\n-        assertEquals(1, ratioTapChangerInLeg2.getTapPosition());\n-        assertTrue(ratioTapChangerInLeg2.isRegulating());\n-        assertEquals(10.0, ratioTapChangerInLeg2.getTargetV(), 0.0);\n-        assertEquals(3, ratioTapChangerInLeg3.getTapPosition());\n-        assertFalse(ratioTapChangerInLeg3.isRegulating());\n-        assertEquals(11.0, ratioTapChangerInLeg3.getTargetV(), 0.0);\n+        assertKnownState(phaseTapChanger, ratioTapChanger, ratioTapChangerInLeg2, ratioTapChangerInLeg3);", "originalCommit": "eafd31046f97b10ec6d6f08991c935b2576acbda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDEzMzk4Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1125#discussion_r374133983", "bodyText": "If I did this correctly, it is equivalent (asserKnownState is juste a newly extracted method to avoid code duplication detected by sonar).", "author": "jonenst", "createdAt": "2020-02-03T14:32:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDEyNjg2Nw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "528456dbc2b8c0d671badb59123d992051d84301", "url": "https://github.com/powsybl/powsybl-core/commit/528456dbc2b8c0d671badb59123d992051d84301", "message": "tck AbstractThreeWindingTransformerTest, improve coverage\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-03T14:43:21Z", "type": "forcePushed"}, {"oid": "48ef4ff6faef96e8d5db3cc2c11c385330d3c266", "url": "https://github.com/powsybl/powsybl-core/commit/48ef4ff6faef96e8d5db3cc2c11c385330d3c266", "message": "fix sonar issues\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-03T14:43:21Z", "type": "commit"}, {"oid": "528456dbc2b8c0d671badb59123d992051d84301", "url": "https://github.com/powsybl/powsybl-core/commit/528456dbc2b8c0d671badb59123d992051d84301", "message": "tck AbstractThreeWindingTransformerTest, improve coverage\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-03T14:43:21Z", "type": "commit"}, {"oid": "dd317cef846f81835cc68c8b403a2f1fe9e010d6", "url": "https://github.com/powsybl/powsybl-core/commit/dd317cef846f81835cc68c8b403a2f1fe9e010d6", "message": "Merge branch 'master' into tck", "committedDate": "2020-02-07T17:13:59Z", "type": "commit"}, {"oid": "628ab9025642d6fc6e0ce9b495b88fdf434d7d78", "url": "https://github.com/powsybl/powsybl-core/commit/628ab9025642d6fc6e0ce9b495b88fdf434d7d78", "message": "cleanup\n\nSigned-off-by: Jon Harper <jon.harper87@gmail.com>", "committedDate": "2020-02-07T17:31:38Z", "type": "commit"}]}