{"pr_number": 1329, "pr_title": "Implement getLineStream(), getLines(), getDanglingLineStream() and getDanglingLines() in BusAdapter", "pr_createdAt": "2020-05-27T15:16:56Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1329", "timeline": [{"oid": "8c7d124947656a3b5531c3ca8cf80a3e6325ceb2", "url": "https://github.com/powsybl/powsybl-core/commit/8c7d124947656a3b5531c3ca8cf80a3e6325ceb2", "message": "Implement getLineStream(), getLines(), getDanglingLineStream() and getDanglingLines() in BusAdapter\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-05-27T15:14:55Z", "type": "commit"}, {"oid": "130bcf89a93b63799696ec31e2d3234e81568ebb", "url": "https://github.com/powsybl/powsybl-core/commit/130bcf89a93b63799696ec31e2d3234e81568ebb", "message": "add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-05-28T08:19:28Z", "type": "commit"}, {"oid": "fa37ac5844bed26a332199960090b475c99b39fa", "url": "https://github.com/powsybl/powsybl-core/commit/fa37ac5844bed26a332199960090b475c99b39fa", "message": "Correction: return wrapped objects\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-05-28T13:03:33Z", "type": "commit"}, {"oid": "fa37ac5844bed26a332199960090b475c99b39fa", "url": "https://github.com/powsybl/powsybl-core/commit/fa37ac5844bed26a332199960090b475c99b39fa", "message": "Correction: return wrapped objects\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-05-28T13:03:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc2MjQ1NQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1329#discussion_r435762455", "bodyText": "I think it's not efficient to implement thinks like this: to create the Iterable, you will iterate over all the elements (collect), and then the client of the API will also do it, so the list is read twice.\nI think it would be better to use Iterables.concat(). There is exactly the same issue in the MergingViewIndex... we should fix", "author": "mathbagu", "createdAt": "2020-06-05T08:17:13Z", "path": "iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/BusAdapter.java", "diffHunk": "@@ -188,22 +189,28 @@ public int getConnectedTerminalCount() {\n \n     @Override\n     public Iterable<Line> getLines() {\n-        throw MergingView.createNotImplementedException();\n+        return getLineStream().collect(Collectors.toList());", "originalCommit": "fa37ac5844bed26a332199960090b475c99b39fa", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5b0252b9413056b81d75c2ce0bbfc0616fe33e6e", "chunk": "diff --git a/iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/BusAdapter.java b/iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/BusAdapter.java\nindex 8650b9b9e..96eed3ff4 100644\n--- a/iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/BusAdapter.java\n+++ b/iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/BusAdapter.java\n\n@@ -187,32 +213,6 @@ class BusAdapter extends AbstractIdentifiableAdapter<Bus> implements Bus {\n         throw MergingView.createNotImplementedException();\n     }\n \n-    @Override\n-    public Iterable<Line> getLines() {\n-        return getLineStream().collect(Collectors.toList());\n-    }\n-\n-    @Override\n-    public Stream<Line> getLineStream() {\n-        return Stream.concat(getDelegate().getLineStream()\n-                        .map(l -> getIndex().getLine(l)),\n-                getDelegate().getDanglingLineStream()\n-                        .filter(dl -> getIndex().isMerged(dl))\n-                        .map(dl -> getIndex().getMergedLineByCode(dl.getUcteXnodeCode())));\n-    }\n-\n-    @Override\n-    public Iterable<DanglingLine> getDanglingLines() {\n-        return getDanglingLineStream().collect(Collectors.toList());\n-    }\n-\n-    @Override\n-    public Stream<DanglingLine> getDanglingLineStream() {\n-        return getDelegate().getDanglingLineStream()\n-                .filter(dl -> !getIndex().isMerged(dl))\n-                .map(dl -> getIndex().getDanglingLine(dl));\n-    }\n-\n     @Override\n     public Component getSynchronousComponent() {\n         throw MergingView.createNotImplementedException();\n"}}, {"oid": "5b0252b9413056b81d75c2ce0bbfc0616fe33e6e", "url": "https://github.com/powsybl/powsybl-core/commit/5b0252b9413056b81d75c2ce0bbfc0616fe33e6e", "message": "Move the methods\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>", "committedDate": "2020-06-05T08:34:11Z", "type": "commit"}]}