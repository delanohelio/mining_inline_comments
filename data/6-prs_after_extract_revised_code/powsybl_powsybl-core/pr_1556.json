{"pr_number": 1556, "pr_title": "Contingency.setId removed, Contingency.addElement/removeElement added\u2026", "pr_createdAt": "2020-12-03T13:59:57Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1556", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI1MzM2NQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1556#discussion_r535253365", "bodyText": "Fix the getElements() method: the list should not be modifiable, except using addElement and removeElement", "author": "mathbagu", "createdAt": "2020-12-03T14:05:48Z", "path": "contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java", "diffHunk": "@@ -32,12 +31,12 @@\n \n     public Contingency(String id, ContingencyElement... elements) {\n         this.id = Objects.requireNonNull(id);\n-        this.elements = ImmutableList.copyOf(elements);\n+        this.elements = Arrays.asList(elements);\n     }\n \n     public Contingency(String id, List<ContingencyElement> elements) {\n         this.id = Objects.requireNonNull(id);\n-        this.elements = ImmutableList.copyOf(elements);\n+        this.elements = new ArrayList<>(Objects.requireNonNull(elements));", "originalCommit": "7919f53971ac289dcdc3449c5315af7808981b9e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "12cf8ec7b901eed1128a333acf2ab862d65c30aa", "chunk": "diff --git a/contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java b/contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java\nindex 59504886f..26f42b10b 100644\n--- a/contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java\n+++ b/contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java\n\n@@ -44,7 +44,7 @@ public class Contingency extends AbstractExtendable<Contingency> {\n     }\n \n     public List<ContingencyElement> getElements() {\n-        return elements;\n+        return Collections.unmodifiableList(elements);\n     }\n \n     @Override\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI1NDQ0Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1556#discussion_r535254442", "bodyText": "Make this method public so I could use it. I thought we agreed that the name was not well chosen", "author": "mathbagu", "createdAt": "2020-12-03T14:07:14Z", "path": "contingency/contingency-api/src/main/java/com/powsybl/contingency/ContingencyList.java", "diffHunk": "@@ -72,4 +74,12 @@ static ContingencyList load(String filename, InputStream stream) {\n     static ContingencyList of(Contingency... contingencies) {\n         return new DefaultContingencyList(contingencies);\n     }\n+\n+    static List<Contingency> checkValidity(List<Contingency> contingencies, Network network) {", "originalCommit": "7919f53971ac289dcdc3449c5315af7808981b9e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "12cf8ec7b901eed1128a333acf2ab862d65c30aa", "chunk": "diff --git a/contingency/contingency-api/src/main/java/com/powsybl/contingency/ContingencyList.java b/contingency/contingency-api/src/main/java/com/powsybl/contingency/ContingencyList.java\nindex 0c14cd82a..9acdbe281 100644\n--- a/contingency/contingency-api/src/main/java/com/powsybl/contingency/ContingencyList.java\n+++ b/contingency/contingency-api/src/main/java/com/powsybl/contingency/ContingencyList.java\n\n@@ -75,7 +75,10 @@ public interface ContingencyList {\n         return new DefaultContingencyList(contingencies);\n     }\n \n-    static List<Contingency> checkValidity(List<Contingency> contingencies, Network network) {\n+    /**\n+     * Return only valid contingencies based on given list of contingencies and network\n+     */\n+    static List<Contingency> getValidContingencies(List<Contingency> contingencies, Network network) {\n         Objects.requireNonNull(contingencies);\n         Objects.requireNonNull(network);\n         return contingencies.stream()\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI1NDcwMQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1556#discussion_r535254701", "bodyText": "Call the new method instead of duplicating its implementation", "author": "mathbagu", "createdAt": "2020-12-03T14:07:34Z", "path": "contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java", "diffHunk": "@@ -119,6 +128,19 @@ boolean isValid(Network network) {\n         return valid;\n     }\n \n+    /**\n+     * Return a list of valid contingencies.\n+     * @deprecated Use {@link ContingencyList#checkValidity(List, Network)} ()} instead.\n+     */\n+    @Deprecated\n+    public static List<Contingency> checkValidity(List<Contingency> contingencies, Network network) {\n+        Objects.requireNonNull(contingencies);\n+        Objects.requireNonNull(network);\n+        return contingencies.stream()\n+                .filter(c -> c.isValid(network))\n+                .collect(Collectors.toList());\n+    }", "originalCommit": "7919f53971ac289dcdc3449c5315af7808981b9e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "12cf8ec7b901eed1128a333acf2ab862d65c30aa", "chunk": "diff --git a/contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java b/contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java\nindex 59504886f..26f42b10b 100644\n--- a/contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java\n+++ b/contingency/contingency-api/src/main/java/com/powsybl/contingency/Contingency.java\n\n@@ -130,15 +130,11 @@ public class Contingency extends AbstractExtendable<Contingency> {\n \n     /**\n      * Return a list of valid contingencies.\n-     * @deprecated Use {@link ContingencyList#checkValidity(List, Network)} ()} instead.\n+     * @deprecated Use {@link ContingencyList#getValidContingencies(List, Network)} ()} instead.\n      */\n     @Deprecated\n     public static List<Contingency> checkValidity(List<Contingency> contingencies, Network network) {\n-        Objects.requireNonNull(contingencies);\n-        Objects.requireNonNull(network);\n-        return contingencies.stream()\n-                .filter(c -> c.isValid(network))\n-                .collect(Collectors.toList());\n+        return ContingencyList.getValidContingencies(contingencies, network);\n     }\n \n     private static boolean checkGeneratorContingency(Contingency contingency, GeneratorContingency element, Network network) {\n"}}, {"oid": "5d30aba2ebac99fa0fd56033036a6180d3bced37", "url": "https://github.com/powsybl/powsybl-core/commit/5d30aba2ebac99fa0fd56033036a6180d3bced37", "message": "Contingency.setId removed, Contingency.addElement/removeElement added, Contingency.checkValidy moved to ContingencyList\n\nSigned-off-by: Thomas ADAM <tadam@silicom.fr>", "committedDate": "2020-12-03T16:13:31Z", "type": "commit"}, {"oid": "12cf8ec7b901eed1128a333acf2ab862d65c30aa", "url": "https://github.com/powsybl/powsybl-core/commit/12cf8ec7b901eed1128a333acf2ab862d65c30aa", "message": "Taking into account PR review\n\nSigned-off-by: Thomas ADAM <tadam@silicom.fr>", "committedDate": "2020-12-03T16:13:31Z", "type": "commit"}, {"oid": "12cf8ec7b901eed1128a333acf2ab862d65c30aa", "url": "https://github.com/powsybl/powsybl-core/commit/12cf8ec7b901eed1128a333acf2ab862d65c30aa", "message": "Taking into account PR review\n\nSigned-off-by: Thomas ADAM <tadam@silicom.fr>", "committedDate": "2020-12-03T16:13:31Z", "type": "forcePushed"}, {"oid": "e131cf5f83e036ad76f970e0b7b17a83013fd5f4", "url": "https://github.com/powsybl/powsybl-core/commit/e131cf5f83e036ad76f970e0b7b17a83013fd5f4", "message": "Fix Contingency constructor\n\nSigned-off-by: Thomas ADAM <tadam@silicom.fr>", "committedDate": "2020-12-04T13:53:00Z", "type": "commit"}, {"oid": "0fc99ee0eb8afa3849fdbce41041feacf7a0c161", "url": "https://github.com/powsybl/powsybl-core/commit/0fc99ee0eb8afa3849fdbce41041feacf7a0c161", "message": "Merge branch 'master' into fix_pr_925", "committedDate": "2020-12-04T13:55:10Z", "type": "commit"}]}