{"pr_number": 1346, "pr_title": "add optional getter for ratio and phase tap changer", "pr_createdAt": "2020-06-11T08:47:26Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1346", "timeline": [{"oid": "3cb4edf62a1f1d8d0f1d8a01c43475f9977554d5", "url": "https://github.com/powsybl/powsybl-core/commit/3cb4edf62a1f1d8d0f1d8a01c43475f9977554d5", "message": "add optional getter for ratio and phase tap changer\n\nSigned-off-by: J\u00e9r\u00e9my LABOUS <jlabous@silicom.fr>", "committedDate": "2020-06-11T07:53:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMjk2Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1346#discussion_r438932962", "bodyText": "This is an API: adding a new method will break existing code that could implement this interface. Please provide a behavior.\nreturn Optional.ofNullable(getPhaseTapChanger());\n\nseems fine in that case.", "author": "mathbagu", "createdAt": "2020-06-11T16:56:22Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/PhaseTapChangerHolder.java", "diffHunk": "@@ -25,4 +27,8 @@\n      */\n     PhaseTapChanger getPhaseTapChanger();\n \n+    /**\n+     * Get the optional ratio tap changer.\n+     */\n+    Optional<PhaseTapChanger> getOptionalPhaseTapChanger();", "originalCommit": "3cb4edf62a1f1d8d0f1d8a01c43475f9977554d5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3388f0caf0744075a586428f17b2319baf746a80", "chunk": "diff --git a/iidm/iidm-api/src/main/java/com/powsybl/iidm/network/PhaseTapChangerHolder.java b/iidm/iidm-api/src/main/java/com/powsybl/iidm/network/PhaseTapChangerHolder.java\nindex c9eef0250..e16c2b00e 100644\n--- a/iidm/iidm-api/src/main/java/com/powsybl/iidm/network/PhaseTapChangerHolder.java\n+++ b/iidm/iidm-api/src/main/java/com/powsybl/iidm/network/PhaseTapChangerHolder.java\n\n@@ -30,5 +30,14 @@ public interface PhaseTapChangerHolder {\n     /**\n      * Get the optional ratio tap changer.\n      */\n-    Optional<PhaseTapChanger> getOptionalPhaseTapChanger();\n+    default Optional<PhaseTapChanger> getOptionalPhaseTapChanger() {\n+        return Optional.ofNullable(getPhaseTapChanger());\n+    }\n+\n+    /**\n+     *  Check if a phase tap changer is present\n+     */\n+    default boolean hasPhaseTapChanger() {\n+        return getPhaseTapChanger() != null;\n+    }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMzA0MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1346#discussion_r438933041", "bodyText": "Same remark here", "author": "mathbagu", "createdAt": "2020-06-11T16:56:30Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/RatioTapChangerHolder.java", "diffHunk": "@@ -25,4 +27,8 @@\n      */\n     RatioTapChanger getRatioTapChanger();\n \n+    /**\n+     * Get the optional ratio tap changer.\n+     */\n+    Optional<RatioTapChanger> getOptionalRatioTapChanger();", "originalCommit": "3cb4edf62a1f1d8d0f1d8a01c43475f9977554d5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3388f0caf0744075a586428f17b2319baf746a80", "chunk": "diff --git a/iidm/iidm-api/src/main/java/com/powsybl/iidm/network/RatioTapChangerHolder.java b/iidm/iidm-api/src/main/java/com/powsybl/iidm/network/RatioTapChangerHolder.java\nindex e19ae9362..9d06fb921 100644\n--- a/iidm/iidm-api/src/main/java/com/powsybl/iidm/network/RatioTapChangerHolder.java\n+++ b/iidm/iidm-api/src/main/java/com/powsybl/iidm/network/RatioTapChangerHolder.java\n\n@@ -30,5 +30,14 @@ public interface RatioTapChangerHolder {\n     /**\n      * Get the optional ratio tap changer.\n      */\n-    Optional<RatioTapChanger> getOptionalRatioTapChanger();\n+    default Optional<RatioTapChanger> getOptionalRatioTapChanger() {\n+        return Optional.ofNullable(getRatioTapChanger());\n+    }\n+\n+    /**\n+     * Check if a phase tap changer is present\n+     */\n+    default boolean hasRatioTapChanger() {\n+        return getRatioTapChanger() != null;\n+    }\n }\n"}}, {"oid": "3388f0caf0744075a586428f17b2319baf746a80", "url": "https://github.com/powsybl/powsybl-core/commit/3388f0caf0744075a586428f17b2319baf746a80", "message": "take remarks in account\n\nSigned-off-by: J\u00e9r\u00e9my LABOUS <jlabous@silicom.fr>", "committedDate": "2020-06-12T15:15:04Z", "type": "commit"}, {"oid": "ce2c282638cfd6587bfb102fd4480fdeef7b747d", "url": "https://github.com/powsybl/powsybl-core/commit/ce2c282638cfd6587bfb102fd4480fdeef7b747d", "message": "improve test coverage and remove useless implementation of method\n\nSigned-off-by: J\u00e9r\u00e9my LABOUS <jlabous@silicom.fr>", "committedDate": "2020-06-12T15:45:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk5MDgxMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1346#discussion_r439990812", "bodyText": "Not sure you should remove this implementation (even if this method has a default implementation with the same behavior), it makes it explicit that you are using the ratioTapChanger field", "author": "MioRtia", "createdAt": "2020-06-15T07:51:31Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java", "diffHunk": "@@ -139,10 +138,6 @@ public RatioTapChangerImpl getRatioTapChanger() {\n             return ratioTapChanger;\n         }\n \n-        public Optional<RatioTapChanger> getOptionalRatioTapChanger() {\n-            return Optional.ofNullable(ratioTapChanger);", "originalCommit": "3388f0caf0744075a586428f17b2319baf746a80", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4e046c81afe21566911942c3ff3ab914dcc277eb", "chunk": "diff --git a/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java b/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java\nindex ae12408dc..9e497c819 100644\n--- a/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java\n+++ b/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java\n\n@@ -138,6 +139,11 @@ class ThreeWindingsTransformerImpl extends AbstractConnectable<ThreeWindingsTran\n             return ratioTapChanger;\n         }\n \n+        @Override\n+        public Optional<RatioTapChanger> getOptionalRatioTapChanger() {\n+            return Optional.ofNullable(ratioTapChanger);\n+        }\n+\n         public PhaseTapChangerAdderImpl newPhaseTapChanger() {\n             return new PhaseTapChangerAdderImpl(this);\n         }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk5MDg5MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1346#discussion_r439990890", "bodyText": "Same remark", "author": "MioRtia", "createdAt": "2020-06-15T07:51:40Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java", "diffHunk": "@@ -151,11 +146,6 @@ public PhaseTapChangerImpl getPhaseTapChanger() {\n             return phaseTapChanger;\n         }\n \n-        @Override\n-        public Optional<PhaseTapChanger> getOptionalPhaseTapChanger() {\n-            return Optional.ofNullable(phaseTapChanger);", "originalCommit": "3388f0caf0744075a586428f17b2319baf746a80", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4e046c81afe21566911942c3ff3ab914dcc277eb", "chunk": "diff --git a/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java b/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java\nindex ae12408dc..9e497c819 100644\n--- a/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java\n+++ b/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ThreeWindingsTransformerImpl.java\n\n@@ -146,6 +152,11 @@ class ThreeWindingsTransformerImpl extends AbstractConnectable<ThreeWindingsTran\n             return phaseTapChanger;\n         }\n \n+        @Override\n+        public Optional<PhaseTapChanger> getOptionalPhaseTapChanger() {\n+            return Optional.ofNullable(phaseTapChanger);\n+        }\n+\n         @Override\n         public NetworkImpl getNetwork() {\n             return transformer.getSubstation().getNetwork();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk5MDk5Ng==", "url": "https://github.com/powsybl/powsybl-core/pull/1346#discussion_r439990996", "bodyText": "Same remark", "author": "MioRtia", "createdAt": "2020-06-15T07:51:51Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java", "diffHunk": "@@ -171,11 +170,6 @@ public RatioTapChangerImpl getRatioTapChanger() {\n         return ratioTapChanger;\n     }\n \n-    @Override\n-    public Optional<RatioTapChanger> getOptionalRatioTapChanger() {\n-        return Optional.ofNullable(ratioTapChanger);", "originalCommit": "3388f0caf0744075a586428f17b2319baf746a80", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4e046c81afe21566911942c3ff3ab914dcc277eb", "chunk": "diff --git a/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java b/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java\nindex 6ab2b7fcd..75831c52d 100644\n--- a/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java\n+++ b/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java\n\n@@ -170,6 +171,11 @@ class TwoWindingsTransformerImpl extends AbstractBranch<TwoWindingsTransformer>\n         return ratioTapChanger;\n     }\n \n+    @Override\n+    public Optional<RatioTapChanger> getOptionalRatioTapChanger() {\n+        return Optional.ofNullable(ratioTapChanger);\n+    }\n+\n     @Override\n     public PhaseTapChangerAdderImpl newPhaseTapChanger() {\n         return new PhaseTapChangerAdderImpl(this);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk5MTA1OA==", "url": "https://github.com/powsybl/powsybl-core/pull/1346#discussion_r439991058", "bodyText": "Same remark", "author": "MioRtia", "createdAt": "2020-06-15T07:51:58Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java", "diffHunk": "@@ -186,11 +180,6 @@ public PhaseTapChangerImpl getPhaseTapChanger() {\n         return phaseTapChanger;\n     }\n \n-    @Override\n-    public Optional<PhaseTapChanger> getOptionalPhaseTapChanger() {\n-        return Optional.ofNullable(phaseTapChanger);", "originalCommit": "3388f0caf0744075a586428f17b2319baf746a80", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4e046c81afe21566911942c3ff3ab914dcc277eb", "chunk": "diff --git a/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java b/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java\nindex 6ab2b7fcd..75831c52d 100644\n--- a/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java\n+++ b/iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/TwoWindingsTransformerImpl.java\n\n@@ -180,6 +186,11 @@ class TwoWindingsTransformerImpl extends AbstractBranch<TwoWindingsTransformer>\n         return phaseTapChanger;\n     }\n \n+    @Override\n+    public Optional<PhaseTapChanger> getOptionalPhaseTapChanger() {\n+        return Optional.ofNullable(phaseTapChanger);\n+    }\n+\n     @Override\n     public Set<TapChanger> getAllTapChangers() {\n         Set<TapChanger> tapChangers = new HashSet<>();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk5MTM0OA==", "url": "https://github.com/powsybl/powsybl-core/pull/1346#discussion_r439991348", "bodyText": "You can add an implementation in iidm-impl (even if it is the same behavior) using the field in the impl class rather than the getPhaseTapChanger method", "author": "MioRtia", "createdAt": "2020-06-15T07:52:29Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/PhaseTapChangerHolder.java", "diffHunk": "@@ -30,5 +30,14 @@\n     /**\n      * Get the optional ratio tap changer.\n      */\n-    Optional<PhaseTapChanger> getOptionalPhaseTapChanger();\n+    default Optional<PhaseTapChanger> getOptionalPhaseTapChanger() {\n+        return Optional.ofNullable(getPhaseTapChanger());\n+    }\n+\n+    /**\n+     *  Check if a phase tap changer is present\n+     */\n+    default boolean hasPhaseTapChanger() {\n+        return getPhaseTapChanger() != null;", "originalCommit": "3388f0caf0744075a586428f17b2319baf746a80", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk5MTQyMA==", "url": "https://github.com/powsybl/powsybl-core/pull/1346#discussion_r439991420", "bodyText": "Same remark", "author": "MioRtia", "createdAt": "2020-06-15T07:52:37Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/RatioTapChangerHolder.java", "diffHunk": "@@ -30,5 +30,14 @@\n     /**\n      * Get the optional ratio tap changer.\n      */\n-    Optional<RatioTapChanger> getOptionalRatioTapChanger();\n+    default Optional<RatioTapChanger> getOptionalRatioTapChanger() {\n+        return Optional.ofNullable(getRatioTapChanger());\n+    }\n+\n+    /**\n+     * Check if a phase tap changer is present\n+     */\n+    default boolean hasRatioTapChanger() {\n+        return getRatioTapChanger() != null;", "originalCommit": "3388f0caf0744075a586428f17b2319baf746a80", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "4e046c81afe21566911942c3ff3ab914dcc277eb", "url": "https://github.com/powsybl/powsybl-core/commit/4e046c81afe21566911942c3ff3ab914dcc277eb", "message": "rollback on delete methods\n\nSigned-off-by: J\u00e9r\u00e9my LABOUS <jlabous@silicom.fr>", "committedDate": "2020-06-15T15:58:51Z", "type": "commit"}, {"oid": "3b637d2b88ffb00084efb26c3b9ba346c549b676", "url": "https://github.com/powsybl/powsybl-core/commit/3b637d2b88ffb00084efb26c3b9ba346c549b676", "message": "Merge branch 'master' into issue_1227_add_optional_getter_for_ratio_and_phaseTapChanger", "committedDate": "2020-06-16T14:48:01Z", "type": "commit"}, {"oid": "e650e22ceb906f767cd0895abbcfcd5aa0c2f762", "url": "https://github.com/powsybl/powsybl-core/commit/e650e22ceb906f767cd0895abbcfcd5aa0c2f762", "message": "Merge branch 'master' into issue_1227_add_optional_getter_for_ratio_and_phaseTapChanger", "committedDate": "2020-06-19T08:09:44Z", "type": "commit"}]}