{"pr_number": 882, "pr_title": "Change the REST call for delete CloudConfig ", "pr_createdAt": "2020-03-10T04:34:31Z", "pr_url": "https://github.com/apache/helix/pull/882", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUxNDY0OQ==", "url": "https://github.com/apache/helix/pull/882#discussion_r390514649", "bodyText": "Can you have another PR like Molly's work? The update/delete for a cloudConfig is working on update/delete entry of the CloudConfig.", "author": "junkaixue", "createdAt": "2020-03-10T18:12:10Z", "path": "helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java", "diffHunk": "@@ -617,10 +630,6 @@ public Response updateCloudConfig(@PathParam(\"clusterId\") String clusterId,\n     }\n     try {\n       switch (command) {\n-      case delete: {\n-        admin.removeCloudConfig(clusterId);\n-      }\n-      break;\n       case update: {\n         try {\n           CloudConfig cloudConfig = new CloudConfig.Builder(record).build();", "originalCommit": "993290cdde029546bcd039a9635c05c95d84ce27", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTI1NTAwMQ==", "url": "https://github.com/apache/helix/pull/882#discussion_r391255001", "bodyText": "I will do new PR for update/delete the entries.", "author": "alirezazamani", "createdAt": "2020-03-11T20:39:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUxNDY0OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUxNDkzNA==", "url": "https://github.com/apache/helix/pull/882#discussion_r390514934", "bodyText": "Move the logic to configAccessor.", "author": "junkaixue", "createdAt": "2020-03-10T18:12:39Z", "path": "helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java", "diffHunk": "@@ -584,6 +584,19 @@ public Response getCloudConfig(@PathParam(\"clusterId\") String clusterId) {\n     return notFound();\n   }\n \n+  @DELETE\n+  @Path(\"{clusterId}/cloudconfig\")\n+  public Response deleteCloudConfig(@PathParam(\"clusterId\") String clusterId) {\n+    HelixZkClient zkClient = getHelixZkClient();\n+    if (!ZKUtil.isClusterSetup(clusterId, zkClient)) {\n+      return notFound();\n+    }\n+\n+    HelixAdmin admin = getHelixAdmin();\n+    admin.removeCloudConfig(clusterId);\n+    return OK();", "originalCommit": "993290cdde029546bcd039a9635c05c95d84ce27", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTI1NDc4OQ==", "url": "https://github.com/apache/helix/pull/882#discussion_r391254789", "bodyText": "Done.", "author": "alirezazamani", "createdAt": "2020-03-11T20:39:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUxNDkzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTI1NTQzMQ==", "url": "https://github.com/apache/helix/pull/882#discussion_r391255431", "bodyText": "I also changed the tests accordingly.", "author": "alirezazamani", "createdAt": "2020-03-11T20:40:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUxNDkzNA=="}], "type": "inlineReview", "revised_code": {"commit": "40aca9d854f4ecd89759b5e5a42297a8603f0f28", "chunk": "diff --git a/helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java b/helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java\nindex 1a5bb608e..9c0f42fe0 100644\n--- a/helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java\n+++ b/helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java\n\n@@ -588,10 +588,6 @@ public class ClusterAccessor extends AbstractHelixResource {\n   @Path(\"{clusterId}/cloudconfig\")\n   public Response deleteCloudConfig(@PathParam(\"clusterId\") String clusterId) {\n     HelixZkClient zkClient = getHelixZkClient();\n-    if (!ZKUtil.isClusterSetup(clusterId, zkClient)) {\n-      return notFound();\n-    }\n-\n     HelixAdmin admin = getHelixAdmin();\n     admin.removeCloudConfig(clusterId);\n     return OK();\n"}}, {"oid": "40aca9d854f4ecd89759b5e5a42297a8603f0f28", "url": "https://github.com/apache/helix/commit/40aca9d854f4ecd89759b5e5a42297a8603f0f28", "message": "Change the delete CloudConfig\n\nUse DELETE instead of POST for deletion of the CloudConfig in REST.", "committedDate": "2020-03-12T18:13:00Z", "type": "commit"}, {"oid": "40aca9d854f4ecd89759b5e5a42297a8603f0f28", "url": "https://github.com/apache/helix/commit/40aca9d854f4ecd89759b5e5a42297a8603f0f28", "message": "Change the delete CloudConfig\n\nUse DELETE instead of POST for deletion of the CloudConfig in REST.", "committedDate": "2020-03-12T18:13:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM4MTA5OA==", "url": "https://github.com/apache/helix/pull/882#discussion_r392381098", "bodyText": "This is not necessary.", "author": "junkaixue", "createdAt": "2020-03-13T17:48:36Z", "path": "helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java", "diffHunk": "@@ -584,6 +584,15 @@ public Response getCloudConfig(@PathParam(\"clusterId\") String clusterId) {\n     return notFound();\n   }\n \n+  @DELETE\n+  @Path(\"{clusterId}/cloudconfig\")\n+  public Response deleteCloudConfig(@PathParam(\"clusterId\") String clusterId) {\n+    HelixZkClient zkClient = getHelixZkClient();", "originalCommit": "40aca9d854f4ecd89759b5e5a42297a8603f0f28", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM5MDk0MQ==", "url": "https://github.com/apache/helix/pull/882#discussion_r392390941", "bodyText": "Done.", "author": "alirezazamani", "createdAt": "2020-03-13T18:08:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM4MTA5OA=="}], "type": "inlineReview", "revised_code": {"commit": "df7ce93acd25d00af88bc7384e41dfb7e42856d3", "chunk": "diff --git a/helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java b/helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java\nindex 9c0f42fe0..4e6edaf63 100644\n--- a/helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java\n+++ b/helix-rest/src/main/java/org/apache/helix/rest/server/resources/helix/ClusterAccessor.java\n\n@@ -587,7 +587,6 @@ public class ClusterAccessor extends AbstractHelixResource {\n   @DELETE\n   @Path(\"{clusterId}/cloudconfig\")\n   public Response deleteCloudConfig(@PathParam(\"clusterId\") String clusterId) {\n-    HelixZkClient zkClient = getHelixZkClient();\n     HelixAdmin admin = getHelixAdmin();\n     admin.removeCloudConfig(clusterId);\n     return OK();\n"}}, {"oid": "df7ce93acd25d00af88bc7384e41dfb7e42856d3", "url": "https://github.com/apache/helix/commit/df7ce93acd25d00af88bc7384e41dfb7e42856d3", "message": "remove one line", "committedDate": "2020-03-13T18:07:42Z", "type": "commit"}]}