{"pr_number": 717, "pr_title": "Upgrade AbstractTestClass with multi-ZK support in helix-rest", "pr_createdAt": "2020-02-01T07:37:31Z", "pr_url": "https://github.com/apache/helix/pull/717", "timeline": [{"oid": "f664bdc2fcd4594acdf7c3392e8bad0ac2c4ea72", "url": "https://github.com/apache/helix/commit/f664bdc2fcd4594acdf7c3392e8bad0ac2c4ea72", "message": "Upgrade ZkTestBase with multi-ZK support in helix-rest", "committedDate": "2020-02-01T07:34:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQxNzAyNQ==", "url": "https://github.com/apache/helix/pull/717#discussion_r374417025", "bodyText": "Question: In the test suit, where do we set MULTI_ZK_PROPERTY_KEY and NUM_ZK_PROPERTY_KEY?", "author": "alirezazamani", "createdAt": "2020-02-04T00:26:59Z", "path": "helix-rest/src/test/java/org/apache/helix/rest/server/AbstractTestClass.java", "diffHunk": "@@ -149,20 +155,43 @@ public void clearupLogs() {\n   @Override\n   protected Application configure() {\n     // start zk\n+    _zkServerMap = new HashMap<>();\n     try {\n       if (_zkServer == null) {\n         _zkServer = TestHelper.startZkServer(ZK_ADDR);\n-        Assert.assertTrue(_zkServer != null);\n+        Assert.assertNotNull(_zkServer);\n+        _zkServerMap.put(ZK_ADDR, _zkServer);\n         ZKClientPool.reset();\n       }\n \n       if (_zkServerTestNS == null) {\n         _zkServerTestNS = TestHelper.startZkServer(_zkAddrTestNS);\n-        Assert.assertTrue(_zkServerTestNS != null);\n+        Assert.assertNotNull(_zkServerTestNS);\n+        _zkServerMap.put(_zkAddrTestNS, _zkServerTestNS);\n         ZKClientPool.reset();\n       }\n     } catch (Exception e) {\n-      Assert.assertTrue(false, String.format(\"Failed to start ZK server: %s\", e.toString()));\n+      Assert.fail(String.format(\"Failed to start ZK server: %s\", e.toString()));\n+    }\n+\n+    // Start additional ZKs in a multi-ZK setup\n+    String multiZkConfig = System.getProperty(MULTI_ZK_PROPERTY_KEY);", "originalCommit": "f664bdc2fcd4594acdf7c3392e8bad0ac2c4ea72", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQyNzAwOA==", "url": "https://github.com/apache/helix/pull/717#discussion_r374427008", "bodyText": "pom.xml. That change is in the other PR (for helix-core).", "author": "narendly", "createdAt": "2020-02-04T01:05:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQxNzAyNQ=="}], "type": "inlineReview", "revised_code": null}]}