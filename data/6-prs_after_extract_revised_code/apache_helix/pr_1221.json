{"pr_number": 1221, "pr_title": "Drop the task related current states for new session", "pr_createdAt": "2020-08-05T22:25:37Z", "pr_url": "https://github.com/apache/helix/pull/1221", "timeline": [{"oid": "5d80d69fde9bf4b78a0eb6f11e2d4ebef3ab0e03", "url": "https://github.com/apache/helix/commit/5d80d69fde9bf4b78a0eb6f11e2d4ebef3ab0e03", "message": "Drop the task related current states for new session\n\nSince the controller is not calculating quota based on current state,\nthere is no need to set requested state to DROPPED and ask controller\nto drop the current state. Instead, in this commit, the participant\ncan drop the current state right away.", "committedDate": "2020-08-05T20:10:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjg4Mg==", "url": "https://github.com/apache/helix/pull/1221#discussion_r467216882", "bodyText": "If we skip it, do we skip the operation for deleting old current states?", "author": "junkaixue", "createdAt": "2020-08-07T18:59:34Z", "path": "helix-core/src/main/java/org/apache/helix/manager/zk/ParticipantManager.java", "diffHunk": "@@ -350,6 +351,12 @@ private void carryOverPreviousCurrentState() {\n                   + lastCurState);\n           continue;\n         }\n+\n+        // If the the current state is related to tasks, there is no need to carry it over to new session.\n+        if (stateModelDefRef.equals(TaskConstants.STATE_MODEL_NAME)) {\n+          continue;\n+        }", "originalCommit": "5d80d69fde9bf4b78a0eb6f11e2d4ebef3ab0e03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzI3MDkwMA==", "url": "https://github.com/apache/helix/pull/1221#discussion_r467270900", "bodyText": "When we establishing new session, we will carryover the old current states. If we skip this carry over for the task related current states, then the session will no longer have task related current states. Hence, there is no need to the controller to drop the current state in this case.", "author": "alirezazamani", "createdAt": "2020-08-07T21:12:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjg4Mg=="}], "type": "inlineReview", "revised_code": null}]}