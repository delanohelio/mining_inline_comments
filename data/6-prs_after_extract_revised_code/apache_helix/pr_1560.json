{"pr_number": 1560, "pr_title": "fix test Helix-rest testAddConfigFields", "pr_createdAt": "2020-11-25T19:33:06Z", "pr_url": "https://github.com/apache/helix/pull/1560", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzA4Njc3OA==", "url": "https://github.com/apache/helix/pull/1560#discussion_r533086778", "bodyText": "This fix could work, but it is not very intuitive for writing future tests. People may easily overlook the guideline. Do you think it's possible to reset the cluster back to normal after waged related tests? If it's not feasible, we may want to add more description for this guideline or not to name it simply as 0, 1, 2.", "author": "zhangmeng916", "createdAt": "2020-12-01T05:45:54Z", "path": "helix-rest/src/test/java/org/apache/helix/rest/server/TestClusterAccessor.java", "diffHunk": "@@ -224,7 +224,7 @@ public void testGetClusterTopologyAndFaultZoneMap() throws IOException {\n   @Test(dependsOnMethods = \"testGetClusterTopologyAndFaultZoneMap\")\n   public void testAddConfigFields() throws IOException {\n     System.out.println(\"Start test :\" + TestHelper.getTestMethodName());\n-    String cluster = _clusters.iterator().next();\n+    String cluster = \"TestCluster_1\";", "originalCommit": "3a56240bdaf604006f3db8d6158d711e71ffb51e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc0MjA3OQ==", "url": "https://github.com/apache/helix/pull/1560#discussion_r533742079", "bodyText": "TFTR. I think adding more description for these clusters might be a better option here. Let me update.", "author": "xyuanlu", "createdAt": "2020-12-01T21:46:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzA4Njc3OA=="}], "type": "inlineReview", "revised_code": {"commit": "6064e29b4b525492039a6f2603cb43386d88e5a9", "chunk": "diff --git a/helix-rest/src/test/java/org/apache/helix/rest/server/TestClusterAccessor.java b/helix-rest/src/test/java/org/apache/helix/rest/server/TestClusterAccessor.java\nindex 180407541..f73738f36 100644\n--- a/helix-rest/src/test/java/org/apache/helix/rest/server/TestClusterAccessor.java\n+++ b/helix-rest/src/test/java/org/apache/helix/rest/server/TestClusterAccessor.java\n\n@@ -224,6 +224,7 @@ public class TestClusterAccessor extends AbstractTestClass {\n   @Test(dependsOnMethods = \"testGetClusterTopologyAndFaultZoneMap\")\n   public void testAddConfigFields() throws IOException {\n     System.out.println(\"Start test :\" + TestHelper.getTestMethodName());\n+    //Need to use TestCluster_1 here since other test may add unwanted key to listField. issue-1336\n     String cluster = \"TestCluster_1\";\n     ClusterConfig oldConfig = getClusterConfigFromRest(cluster);\n \n"}}, {"oid": "c3698e9a1edd6e8e9f1ca8683f6c04fdfba1a081", "url": "https://github.com/apache/helix/commit/c3698e9a1edd6e8e9f1ca8683f6c04fdfba1a081", "message": "fix test", "committedDate": "2020-12-03T20:30:28Z", "type": "commit"}, {"oid": "6064e29b4b525492039a6f2603cb43386d88e5a9", "url": "https://github.com/apache/helix/commit/6064e29b4b525492039a6f2603cb43386d88e5a9", "message": "address comment", "committedDate": "2020-12-03T20:30:28Z", "type": "commit"}, {"oid": "6064e29b4b525492039a6f2603cb43386d88e5a9", "url": "https://github.com/apache/helix/commit/6064e29b4b525492039a6f2603cb43386d88e5a9", "message": "address comment", "committedDate": "2020-12-03T20:30:28Z", "type": "forcePushed"}]}