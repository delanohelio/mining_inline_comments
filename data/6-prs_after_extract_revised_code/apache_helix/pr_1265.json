{"pr_number": 1265, "pr_title": "Change TestInstanceAutoJoin to adapt to cloud environment", "pr_createdAt": "2020-08-13T05:23:13Z", "pr_url": "https://github.com/apache/helix/pull/1265", "timeline": [{"oid": "9d001042fda45e70e388fa4dd7e545fba2f4f4bf", "url": "https://github.com/apache/helix/commit/9d001042fda45e70e388fa4dd7e545fba2f4f4bf", "message": "Change TestInstanceAutoJoin to adapt to cloud environment", "committedDate": "2020-08-13T05:20:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI0ODk3Mg==", "url": "https://github.com/apache/helix/pull/1265#discussion_r470248972", "bodyText": "Why this line is needed?", "author": "kaisun2000", "createdAt": "2020-08-13T21:07:37Z", "path": "helix-core/src/test/java/org/apache/helix/integration/paticipant/TestInstanceAutoJoin.java", "diffHunk": "@@ -110,14 +108,23 @@ public void testAutoRegistrationShouldFailWhenWaitingResponse() throws Exception\n         new MockParticipantManager(ZK_ADDR, CLUSTER_NAME, instance3);\n     autoParticipant.syncStart();\n \n-    Assert.assertTrue(null == manager.getHelixDataAccessor()\n-        .getProperty(accessor.keyBuilder().liveInstance(instance3)));\n+    // if the test is run in cloud environment, auto registration will succeed and live instance\n+    // will be added, otherwise, auto registration will fail and instance config will not be\n+    // populated. An exception will be thrown.\n     try {\n       manager.getConfigAccessor().getInstanceConfig(CLUSTER_NAME, instance3);", "originalCommit": "9d001042fda45e70e388fa4dd7e545fba2f4f4bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI1MDUyMg==", "url": "https://github.com/apache/helix/pull/1265#discussion_r470250522", "bodyText": "This line is used to trigger the exception to be thrown as the instance config is not there.", "author": "zhangmeng916", "createdAt": "2020-08-13T21:10:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI0ODk3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI2Mzk5Ng==", "url": "https://github.com/apache/helix/pull/1265#discussion_r470263996", "bodyText": "Got it. You are right.", "author": "kaisun2000", "createdAt": "2020-08-13T21:38:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI0ODk3Mg=="}], "type": "inlineReview", "revised_code": null}]}