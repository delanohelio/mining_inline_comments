{"pr_number": 23726, "pr_title": "Add @icon annotation definition", "pr_createdAt": "2020-06-04T09:09:22Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/23726", "timeline": [{"oid": "00ec9bbec685d275ffd505fe8cb6b9d5627bc5da", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/00ec9bbec685d275ffd505fe8cb6b9d5627bc5da", "message": "Add @icon annotation definition", "committedDate": "2020-06-04T09:11:22Z", "type": "commit"}, {"oid": "00ec9bbec685d275ffd505fe8cb6b9d5627bc5da", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/00ec9bbec685d275ffd505fe8cb6b9d5627bc5da", "message": "Add @icon annotation definition", "committedDate": "2020-06-04T09:11:22Z", "type": "forcePushed"}, {"oid": "45b2fb9b64ff83d5fae4c07c3f1dbc7f940927e1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/45b2fb9b64ff83d5fae4c07c3f1dbc7f940927e1", "message": "Add unit test cases for icon annotation", "committedDate": "2020-06-08T12:22:05Z", "type": "commit"}, {"oid": "7a57a147b2d63289c03be3f1c43a74f4e45597f2", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7a57a147b2d63289c03be3f1c43a74f4e45597f2", "message": "Apply review suggestions", "committedDate": "2020-06-08T13:37:22Z", "type": "commit"}, {"oid": "82a2b74a8cc82fb705d5299c61ac527474f4c910", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/82a2b74a8cc82fb705d5299c61ac527474f4c910", "message": "Apply review suggestions", "committedDate": "2020-06-08T17:25:02Z", "type": "forcePushed"}, {"oid": "7a57a147b2d63289c03be3f1c43a74f4e45597f2", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7a57a147b2d63289c03be3f1c43a74f4e45597f2", "message": "Apply review suggestions", "committedDate": "2020-06-08T13:37:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk0MDI1NA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23726#discussion_r437940254", "bodyText": "Should we assert the method attachment too?", "author": "MaryamZi", "createdAt": "2020-06-10T08:10:52Z", "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/annotations/IconAnnotationTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.ballerinalang.test.annotations;\n+\n+import org.ballerinalang.model.tree.AnnotationAttachmentNode;\n+import org.ballerinalang.model.tree.TypeDefinition;\n+import org.ballerinalang.test.util.BAssertUtil;\n+import org.ballerinalang.test.util.BCompileUtil;\n+import org.ballerinalang.test.util.CompileResult;\n+import org.testng.Assert;\n+import org.testng.annotations.BeforeClass;\n+import org.testng.annotations.Test;\n+import org.wso2.ballerinalang.compiler.tree.BLangAnnotationAttachment;\n+import org.wso2.ballerinalang.compiler.tree.BLangFunction;\n+import org.wso2.ballerinalang.compiler.tree.BLangPackage;\n+\n+import java.util.List;\n+\n+/**\n+ * Class to test icon annotation.\n+ *\n+ * @since 2.0\n+ */\n+public class IconAnnotationTest {\n+\n+    private CompileResult result;\n+    private CompileResult negative;\n+\n+    @BeforeClass\n+    public void setup() {\n+        negative = BCompileUtil.compile(\"test-src/annotations/icon_annot_negative.bal\");\n+        result = BCompileUtil.compile(\"test-src/annotations/icon_annot.bal\");\n+    }\n+\n+    @Test\n+    public void testIconOnFunction() {\n+        BLangFunction fooFunction = (BLangFunction) ((List) ((BLangPackage) result.getAST()).functions).get(0);\n+        BLangAnnotationAttachment annot = (BLangAnnotationAttachment) ((List) fooFunction.annAttachments).get(0);\n+        Assert.assertEquals(annot.expr.toString(), \" {path: /fooIconPath.icon}\");\n+    }\n+\n+    @Test\n+    public void testIconOnObjectAndMemberFunction() {\n+        TypeDefinition objType = result.getAST().getTypeDefinitions().get(0);\n+        List<? extends AnnotationAttachmentNode> objAnnot = objType.getAnnotationAttachments();\n+        Assert.assertEquals(objAnnot.size(), 1);\n+        Assert.assertEquals(objAnnot.get(0).getExpression().toString(), \" {path: /barIconPath.icon}\");", "originalCommit": "7a57a147b2d63289c03be3f1c43a74f4e45597f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODEyNjQ1OA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23726#discussion_r438126458", "bodyText": "Oh thank you, I was meaning to add that and then forgot, will add asap.", "author": "rdhananjaya", "createdAt": "2020-06-10T13:35:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk0MDI1NA=="}], "type": "inlineReview", "revised_code": {"commit": "2dd21bbe4ce00f0be0a7e90f7d7e38dd9087209c", "chunk": "diff --git a/tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/annotations/IconAnnotationTest.java b/tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/annotations/IconAnnotationTest.java\nindex 55c07714d9f..562e90728d2 100644\n--- a/tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/annotations/IconAnnotationTest.java\n+++ b/tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/annotations/IconAnnotationTest.java\n\n@@ -27,6 +27,7 @@ import org.testng.annotations.Test;\n import org.wso2.ballerinalang.compiler.tree.BLangAnnotationAttachment;\n import org.wso2.ballerinalang.compiler.tree.BLangFunction;\n import org.wso2.ballerinalang.compiler.tree.BLangPackage;\n+import org.wso2.ballerinalang.compiler.tree.types.BLangObjectTypeNode;\n \n import java.util.List;\n \n"}}, {"oid": "2dd21bbe4ce00f0be0a7e90f7d7e38dd9087209c", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2dd21bbe4ce00f0be0a7e90f7d7e38dd9087209c", "message": "Add attached function test case for @icon annot", "committedDate": "2020-06-10T14:03:18Z", "type": "commit"}, {"oid": "4648f5502c0ba3748d590410e05d68c3b9bd3c62", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4648f5502c0ba3748d590410e05d68c3b9bd3c62", "message": "fix failing annotation completion tests", "committedDate": "2020-06-12T05:06:02Z", "type": "commit"}, {"oid": "5d0fbd05849e3eec0534bb6c31853d7039a738dd", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5d0fbd05849e3eec0534bb6c31853d7039a738dd", "message": "Merge pull request #3 from nadeeshaan/icon-annotation-local\n\nFix failing annotation completion tests", "committedDate": "2020-06-15T04:30:52Z", "type": "commit"}, {"oid": "af85d01147a31880218d0b75ce5564a9fe2ee9de", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/af85d01147a31880218d0b75ce5564a9fe2ee9de", "message": "Merge branch 'master' of github.com:ballerina-platform/ballerina-lang into icon-annotation", "committedDate": "2020-06-15T04:32:56Z", "type": "commit"}, {"oid": "640f14bfc9e684fc0da6cc696905c0d49bcd87fd", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/640f14bfc9e684fc0da6cc696905c0d49bcd87fd", "message": "Merge branch 'icon-annotation' of github.com:rdhananjaya/ballerina-lang into icon-annotation\n\n\u0001 Conflicts:\n\u0001\tlanguage-server/modules/langserver-core/src/test/resources/completion/annotation/annotationInSameModule5.json\n\u0001\tlanguage-server/modules/langserver-core/src/test/resources/completion/annotation/resourceAnnotation1.json\n\u0001\tlanguage-server/modules/langserver-core/src/test/resources/completion/annotation/resourceAnnotation2.json\n\u0001\tlanguage-server/modules/langserver-core/src/test/resources/completion/annotation/resourceAnnotation3.json\n\u0001\tlanguage-server/modules/langserver-core/src/test/resources/completion/annotation/resourceAnnotation6.json", "committedDate": "2020-06-15T04:35:55Z", "type": "commit"}, {"oid": "aa9f80ded2e8fd066c6262360074a98ce2359d87", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/aa9f80ded2e8fd066c6262360074a98ce2359d87", "message": "fix failing lang server tests", "committedDate": "2020-06-15T06:26:55Z", "type": "commit"}, {"oid": "1172101adcae68d5c1aa6ba4a1d424a381d0abb1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1172101adcae68d5c1aa6ba4a1d424a381d0abb1", "message": "Merge pull request #4 from nadeeshaan/icon-annotation-local\n\nFix failing lang server tests", "committedDate": "2020-06-15T06:37:11Z", "type": "commit"}, {"oid": "126f7c6e5ef709575b343b8d3afa79a1170a4291", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/126f7c6e5ef709575b343b8d3afa79a1170a4291", "message": "Merge branch 'master' of github.com:ballerina-platform/ballerina-lang into icon-annotation", "committedDate": "2020-06-15T06:45:44Z", "type": "commit"}, {"oid": "d722318cdaec8cf5312124f506f6f9faedd8662b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d722318cdaec8cf5312124f506f6f9faedd8662b", "message": "Merge branch 'icon-annotation' of github.com:rdhananjaya/ballerina-lang into icon-annotation", "committedDate": "2020-06-15T06:47:28Z", "type": "commit"}, {"oid": "ef4304675bc97917b9fbdd078e654ea76ac46d2b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ef4304675bc97917b9fbdd078e654ea76ac46d2b", "message": "Merge branch 'master' of github.com:ballerina-platform/ballerina-lang into icon-annotation", "committedDate": "2020-06-15T16:24:41Z", "type": "commit"}]}