{"pr_number": 25423, "pr_title": "Introduce support for isolated functions", "pr_createdAt": "2020-08-26T05:29:38Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/25423", "timeline": [{"oid": "9c9f8b1e0cd5dc43bf36229d6116104dd452fba2", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9c9f8b1e0cd5dc43bf36229d6116104dd452fba2", "message": "Add initial parser changes for isolated", "committedDate": "2020-08-12T11:04:25Z", "type": "commit"}, {"oid": "0f0c01d31c78e6fbd5338768e36470e21cb245e1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0f0c01d31c78e6fbd5338768e36470e21cb245e1", "message": "Merge master", "committedDate": "2020-08-13T17:26:07Z", "type": "commit"}, {"oid": "8ae42478a37cd49a7c3cdc28f107d3e25d995460", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8ae42478a37cd49a7c3cdc28f107d3e25d995460", "message": "Intro initial error handling for isolated", "committedDate": "2020-08-15T07:38:46Z", "type": "commit"}, {"oid": "8971f5a8cbfeb1548fdfb875f14303e75c254603", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8971f5a8cbfeb1548fdfb875f14303e75c254603", "message": "Merge master", "committedDate": "2020-08-15T14:11:10Z", "type": "commit"}, {"oid": "3d891d301eade59d759ba5d6353b094f951594b8", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3d891d301eade59d759ba5d6353b094f951594b8", "message": "Add positive parser tests for isolated", "committedDate": "2020-08-18T05:49:07Z", "type": "commit"}, {"oid": "9ee0c49459f3b20320edba8968dcf623bb5a3e40", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9ee0c49459f3b20320edba8968dcf623bb5a3e40", "message": "Add parser error recovery tests for isolated", "committedDate": "2020-08-18T06:36:50Z", "type": "commit"}, {"oid": "979ba62525314c2335edfe829722a6d4a1eb3191", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/979ba62525314c2335edfe829722a6d4a1eb3191", "message": "Resolve conflicts and merge master", "committedDate": "2020-08-18T06:49:09Z", "type": "commit"}, {"oid": "997686f76d3f6c8a2de716448b7ba6ad1de0b811", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/997686f76d3f6c8a2de716448b7ba6ad1de0b811", "message": "Introduce IsolationAnalyzer - Take I", "committedDate": "2020-08-23T07:14:57Z", "type": "commit"}, {"oid": "5ac894b148985d03fe05fd5b409e5b8e40ff96ad", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5ac894b148985d03fe05fd5b409e5b8e40ff96ad", "message": "Change isolation check to see if ref belongs to current invokable", "committedDate": "2020-08-24T05:47:05Z", "type": "commit"}, {"oid": "d3163997a546e8c83c74d0af0cc88f5a61e3ca01", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d3163997a546e8c83c74d0af0cc88f5a61e3ca01", "message": "Implement remaining visits and enable isolation analysis\n\nAlso changes  to return only non-note diagnostics.", "committedDate": "2020-08-25T10:03:50Z", "type": "commit"}, {"oid": "ce1dfb5d3355005c559490b8ea22f02cbab879ab", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ce1dfb5d3355005c559490b8ea22f02cbab879ab", "message": "Add object method isolation analysis", "committedDate": "2020-08-25T14:46:53Z", "type": "commit"}, {"oid": "6222a6eb0c634681fd3b1d3beb9ed8cef195105b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6222a6eb0c634681fd3b1d3beb9ed8cef195105b", "message": "Merge master", "committedDate": "2020-08-25T14:53:37Z", "type": "commit"}, {"oid": "052690b892ca97f1f553d1d904e82a2abad932c9", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/052690b892ca97f1f553d1d904e82a2abad932c9", "message": "Rename the method that retrieves all non-note diagnostics", "committedDate": "2020-08-25T17:50:55Z", "type": "commit"}, {"oid": "bc44fcd8f5e325ea6d9c1a786186b4e107f8052b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bc44fcd8f5e325ea6d9c1a786186b4e107f8052b", "message": "Fix parser tests", "committedDate": "2020-08-25T18:35:45Z", "type": "commit"}, {"oid": "eb4457fed608870ee0a068a5ba54d15bc7f35c83", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/eb4457fed608870ee0a068a5ba54d15bc7f35c83", "message": "Comment out logging note logs to the console", "committedDate": "2020-08-26T07:30:56Z", "type": "commit"}, {"oid": "596dc60696aa739f6724a69f2934407233641e18", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/596dc60696aa739f6724a69f2934407233641e18", "message": "Perform isolation analysis w/out class var and fix error constr. analysis", "committedDate": "2020-08-29T14:45:41Z", "type": "commit"}, {"oid": "eac7a716819ec88097fe47b179371b7e7bf182a7", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/eac7a716819ec88097fe47b179371b7e7bf182a7", "message": "Add tests", "committedDate": "2020-08-31T09:51:10Z", "type": "commit"}, {"oid": "2b8a8f5bf4babdfe4abe5e720e357bc62ef5a3a2", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2b8a8f5bf4babdfe4abe5e720e357bc62ef5a3a2", "message": "Visit args for isolation analysis and add object method/service function tests", "committedDate": "2020-08-31T18:27:36Z", "type": "commit"}, {"oid": "a576621e221c428e8b455935ac16a24c17353153", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a576621e221c428e8b455935ac16a24c17353153", "message": "Merge master", "committedDate": "2020-09-01T03:44:24Z", "type": "commit"}, {"oid": "2b71a450f1e915e5f14b3eefa5f362d3631758a3", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2b71a450f1e915e5f14b3eefa5f362d3631758a3", "message": "Fix BLangOnClause visit for upstream changes", "committedDate": "2020-09-01T03:57:51Z", "type": "commit"}, {"oid": "c70ceb89e470d1b1bea355c23f0e2a443763ede5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c70ceb89e470d1b1bea355c23f0e2a443763ede5", "message": "Consider isolated flag for type-checking", "committedDate": "2020-09-01T12:30:20Z", "type": "commit"}, {"oid": "f32adee59ba7990e2ddb90c1508d24fefc7780a0", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f32adee59ba7990e2ddb90c1508d24fefc7780a0", "message": "Merge master", "committedDate": "2020-09-02T11:51:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjA1ODM5Nw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25423#discussion_r482058397", "bodyText": "Since we r seeing isolated keyword we can directly consume it. So we can use consume() here. Other places will also be changed to consume() in future :-)", "author": "rdulmina", "createdAt": "2020-09-02T13:14:19Z", "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java", "diffHunk": "@@ -4694,6 +4701,9 @@ private STNode parseFunctionQualifiers(ParserRuleContext context, List<STNode> q\n                 case RESOURCE_KEYWORD:\n                     qualifier = parseResourceKeyword();\n                     break;\n+                case ISOLATED_KEYWORD:\n+                    qualifier = parseIsolatedKeyword();", "originalCommit": "f32adee59ba7990e2ddb90c1508d24fefc7780a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjcyMDE2MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25423#discussion_r482720160", "bodyText": "Ack, fixed just this for now with becd1b0, thanks!", "author": "MaryamZi", "createdAt": "2020-09-03T05:54:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjA1ODM5Nw=="}], "type": "inlineReview", "revised_code": {"commit": "becd1b0c7542b4bb5202203bbd4c227c8d8c527b", "chunk": "diff --git a/compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java b/compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java\nindex 4059d299fe4..8c5000e675b 100644\n--- a/compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java\n+++ b/compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java\n\n@@ -4702,7 +4702,7 @@ public class BallerinaParser extends AbstractParser {\n                     qualifier = parseResourceKeyword();\n                     break;\n                 case ISOLATED_KEYWORD:\n-                    qualifier = parseIsolatedKeyword();\n+                    qualifier = consume();\n                     break;\n                 default:\n                     recover(peek(), context, context, qualifierList);\n"}}, {"oid": "becd1b0c7542b4bb5202203bbd4c227c8d8c527b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/becd1b0c7542b4bb5202203bbd4c227c8d8c527b", "message": "Use consume to parse the isolated keyword", "committedDate": "2020-09-02T18:25:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgzNTQwOA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25423#discussion_r482835408", "bodyText": "Looks like committed by mistake?", "author": "dulvinw", "createdAt": "2020-09-03T09:22:11Z", "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/util/diagnotic/DefaultDiagnosticListener.java", "diffHunk": "@@ -44,6 +44,7 @@ public void received(Diagnostic diagnostic) {\n                 console.println(\"warning: \" + pos + \" \" + diag.msg);\n                 break;\n             case NOTE:\n+                // console.println(\"note: \" + pos + \" \" + diag.msg);", "originalCommit": "becd1b0c7542b4bb5202203bbd4c227c8d8c527b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxNjAyNA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25423#discussion_r483416024", "bodyText": "This is actually to help stdlib folks to identify which functions can be marked as isolated. As discussed during the meeting, we can alternatively make this a warning, the issue with that though is that the build fails unless we special case that warning too.", "author": "MaryamZi", "createdAt": "2020-09-04T06:35:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgzNTQwOA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "70d40fec4b1b7c653519c76094b7249b0e5fa4fe", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/70d40fec4b1b7c653519c76094b7249b0e5fa4fe", "message": "Fix function string repr. and add tests for function typedescs/anon funcs\n\nThe tests are commented out until support for isolated function typedescs and anon functions is added", "committedDate": "2020-09-03T14:41:41Z", "type": "commit"}, {"oid": "dbe90b38fc4813a768d261a5b97c46e062a32b5a", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/dbe90b38fc4813a768d261a5b97c46e062a32b5a", "message": "Resolve conflicts and merge master", "committedDate": "2020-09-04T04:58:25Z", "type": "commit"}, {"oid": "3537de0bfefc61b5e59515168f28f1a88445fc5b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3537de0bfefc61b5e59515168f28f1a88445fc5b", "message": "Resolve conflicts and merge master", "committedDate": "2020-09-06T17:57:53Z", "type": "commit"}, {"oid": "a880323b598fbf349b28075d3659cb31ee3d9f19", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a880323b598fbf349b28075d3659cb31ee3d9f19", "message": "Resolve conflicts and merge master", "committedDate": "2020-09-10T06:45:47Z", "type": "commit"}, {"oid": "d364d2a61a0f1baec95667da8dc37afd020a6cfc", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d364d2a61a0f1baec95667da8dc37afd020a6cfc", "message": "Merge master", "committedDate": "2020-09-10T09:40:09Z", "type": "commit"}, {"oid": "b43064b3bca1a3b7dcd8787a4af7be5526a29d22", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b43064b3bca1a3b7dcd8787a4af7be5526a29d22", "message": "Resolve conflicts and merge master", "committedDate": "2020-09-11T18:37:39Z", "type": "commit"}, {"oid": "ee363eb9b449ea85d3641332fefd27a76ad171e5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ee363eb9b449ea85d3641332fefd27a76ad171e5", "message": "Fix isolation analysis for class changes", "committedDate": "2020-09-12T03:45:50Z", "type": "commit"}, {"oid": "7429dcd947658b972faacabc4a1e0927a960db23", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7429dcd947658b972faacabc4a1e0927a960db23", "message": "Fix isolated error handling for class/object member and fix tests", "committedDate": "2020-09-12T17:36:38Z", "type": "commit"}, {"oid": "fc0a1ecab87b0189243df1e39e45326386a1a187", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fc0a1ecab87b0189243df1e39e45326386a1a187", "message": "Change object tests to use classes", "committedDate": "2020-09-12T17:52:45Z", "type": "commit"}, {"oid": "ea0fe6ee0fd3301edb7a14e01cee2f44f6c02cdb", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ea0fe6ee0fd3301edb7a14e01cee2f44f6c02cdb", "message": "Merge master", "committedDate": "2020-09-12T18:15:06Z", "type": "commit"}, {"oid": "a1314ec0cc2ba07f38fbd93362a5539d6a5fefac", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a1314ec0cc2ba07f38fbd93362a5539d6a5fefac", "message": "Fix tests", "committedDate": "2020-09-12T18:26:58Z", "type": "commit"}, {"oid": "93b2070ad0e7c1f7566969c3d789b73b8229dff1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/93b2070ad0e7c1f7566969c3d789b73b8229dff1", "message": "Add isolation validation for record field defaults\n\nThis is temporarily introduced as a note log until stdlibs are fixed", "committedDate": "2020-09-13T18:01:30Z", "type": "commit"}]}