{"pr_number": 20874, "pr_title": "Implement test functionality for single test files", "pr_createdAt": "2020-02-06T04:34:37Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874", "timeline": [{"oid": "2a79b089a5e9d0e443dddbd4ad857769ce975ee0", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2a79b089a5e9d0e443dddbd4ad857769ce975ee0", "message": "Implement test functionality for single test files", "committedDate": "2020-02-03T11:15:24Z", "type": "forcePushed"}, {"oid": "50736dd48777fa7e73e5e0a205f774ca26955a20", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/50736dd48777fa7e73e5e0a205f774ca26955a20", "message": "Implement test functionality for single test files", "committedDate": "2020-02-06T04:59:36Z", "type": "forcePushed"}, {"oid": "38a84d634b599159262b1b4e14a87a4f4230700b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/38a84d634b599159262b1b4e14a87a4f4230700b", "message": "Implement test functionality for single test files", "committedDate": "2020-02-06T08:39:06Z", "type": "forcePushed"}, {"oid": "90e05a425322fb8760cdaafda9d2d69667e2f37d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/90e05a425322fb8760cdaafda9d2d69667e2f37d", "message": "Implement test functionality for single test files", "committedDate": "2020-02-06T11:21:36Z", "type": "forcePushed"}, {"oid": "a3d071805bc89836c1bf24bc2cfcb11c73901df1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a3d071805bc89836c1bf24bc2cfcb11c73901df1", "message": "Implement test functionality for single test files", "committedDate": "2020-02-07T05:32:24Z", "type": "forcePushed"}, {"oid": "21aee960c95f272b55c4165a8736ad17a062b8d5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/21aee960c95f272b55c4165a8736ad17a062b8d5", "message": "Implement test functionality for single test files", "committedDate": "2020-02-07T07:01:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc1NTUxMg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#discussion_r376755512", "bodyText": "If the code is not required shall we remove ?\nWhat will be the behavior if you run ballerina test moduleName if the module do not have tests.", "author": "hevayo", "createdAt": "2020-02-09T05:06:21Z", "path": "misc/testerina/modules/testerina-core/src/main/java/org/ballerinalang/testerina/core/BTestRunner.java", "diffHunk": "@@ -331,9 +336,9 @@ public void packageProcessed(BLangPackage bLangPackage, TestarinaClassLoader cla\n         // TODO the below line is required since this method is currently getting explicitly called from BTestRunner\n         TestSuite suite = TesterinaRegistry.getInstance().getTestSuites().get(bLangPackage.packageID.toString());\n \n-        if (!bLangPackage.hasTestablePackage()) {\n-            return;\n-        }\n+//        if (!bLangPackage.hasTestablePackage()) {\n+//            return;\n+//        }", "originalCommit": "21aee960c95f272b55c4165a8736ad17a062b8d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg1Mzk0NA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#discussion_r376853944", "bodyText": "I will remove this particular block out.\nWhen we run ballerina test <moduleName>, we get the following output on the command line\nCompiling source\n        mohamedaquibzulfikar/module1:0.1.0\n\nCreating balos\n        target/balo/module1-2019r3-any-0.1.0.balo\n\nRunning tests\n        mohamedaquibzulfikar/module1:0.1.0\n        No tests found", "author": "Ibaqu", "createdAt": "2020-02-10T03:18:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc1NTUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg1NDMzMA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#discussion_r376854330", "bodyText": "Done", "author": "Ibaqu", "createdAt": "2020-02-10T03:20:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc1NTUxMg=="}], "type": "inlineReview", "revised_code": {"commit": "3ec489a531fc3dded26138e7aba00c83bbb6812f", "chunk": "diff --git a/misc/testerina/modules/testerina-core/src/main/java/org/ballerinalang/testerina/core/BTestRunner.java b/misc/testerina/modules/testerina-core/src/main/java/org/ballerinalang/testerina/core/BTestRunner.java\nindex db691d97d8e..9a0d09827f5 100644\n--- a/misc/testerina/modules/testerina-core/src/main/java/org/ballerinalang/testerina/core/BTestRunner.java\n+++ b/misc/testerina/modules/testerina-core/src/main/java/org/ballerinalang/testerina/core/BTestRunner.java\n\n@@ -336,10 +336,6 @@ public class BTestRunner {\n         // TODO the below line is required since this method is currently getting explicitly called from BTestRunner\n         TestSuite suite = TesterinaRegistry.getInstance().getTestSuites().get(bLangPackage.packageID.toString());\n \n-//        if (!bLangPackage.hasTestablePackage()) {\n-//            return;\n-//        }\n-\n         if (suite == null) {\n             throw LauncherUtils.createLauncherException(\"No test suite found for [module]: \"\n                     + bLangPackage.packageID.getName());\n"}}, {"oid": "3ec489a531fc3dded26138e7aba00c83bbb6812f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3ec489a531fc3dded26138e7aba00c83bbb6812f", "message": "Implement test functionality for single test files", "committedDate": "2020-02-10T03:19:31Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg3NzY3MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#discussion_r376877670", "bodyText": "@Ibaqu Shall we get rid of the unnecessary new lines that are introduced?", "author": "Dilhasha", "createdAt": "2020-02-10T05:50:30Z", "path": "cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/TestCommand.java", "diffHunk": "@@ -181,13 +183,57 @@ public void execute() {\n \n                 this.sourceRootPath = findRoot;\n             }\n+\n         } else if (this.argList.get(0).endsWith(BLangConstants.BLANG_SRC_FILE_SUFFIX)) {\n-            // when a single bal file is provided.\n-            CommandUtil.printError(this.errStream,\n-                    \"test command is only supported inside a Ballerina project\",\n-                    null,\n-                    false);\n-            CommandUtil.exitError(this.exitWhenFinish);\n+            // when a single bal file is provided\n+            // Check if path given is an absolute path. Update the root accordingly\n+            if (Paths.get(this.argList.get(0)).isAbsolute()) {\n+                sourcePath = Paths.get(this.argList.get(0));\n+            } else {\n+                sourcePath = sourceRootPath.resolve(this.argList.get(0));\n+            }\n+", "originalCommit": "3ec489a531fc3dded26138e7aba00c83bbb6812f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkwNTIzMw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#discussion_r376905233", "bodyText": "Done", "author": "Ibaqu", "createdAt": "2020-02-10T07:47:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg3NzY3MA=="}], "type": "inlineReview", "revised_code": {"commit": "57a341581a477d433ce93119d502ef3bf8a47e15", "chunk": "diff --git a/cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/TestCommand.java b/cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/TestCommand.java\nindex 16ddeca716b..eddd5d1de26 100644\n--- a/cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/TestCommand.java\n+++ b/cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/TestCommand.java\n\n@@ -183,16 +183,11 @@ public class TestCommand implements BLauncherCmd {\n \n                 this.sourceRootPath = findRoot;\n             }\n-\n         } else if (this.argList.get(0).endsWith(BLangConstants.BLANG_SRC_FILE_SUFFIX)) {\n             // when a single bal file is provided\n             // Check if path given is an absolute path. Update the root accordingly\n-            if (Paths.get(this.argList.get(0)).isAbsolute()) {\n-                sourcePath = Paths.get(this.argList.get(0));\n-            } else {\n-                sourcePath = sourceRootPath.resolve(this.argList.get(0));\n-            }\n-\n+            sourcePath = (Paths.get(this.argList.get(0)).isAbsolute()) ?\n+                    Paths.get(this.argList.get(0)) : sourceRootPath.resolve(this.argList.get(0));\n             sourceRootPath = sourcePath.getParent();\n \n             // Check if the command is executed from a ballerina project\n"}}, {"oid": "57a341581a477d433ce93119d502ef3bf8a47e15", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/57a341581a477d433ce93119d502ef3bf8a47e15", "message": "Implement test functionality for single test files", "committedDate": "2020-02-10T06:35:22Z", "type": "forcePushed"}, {"oid": "17a88a9178c60f110392cfe8145b7676674a66ce", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/17a88a9178c60f110392cfe8145b7676674a66ce", "message": "Implement test functionality for single test files", "committedDate": "2020-02-10T08:56:52Z", "type": "commit"}, {"oid": "a13bea3fd22ed5c6abd2e23f322c3ddeacd31ecd", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a13bea3fd22ed5c6abd2e23f322c3ddeacd31ecd", "message": "Change help instructions for test command and output for test examples", "committedDate": "2020-02-10T08:56:52Z", "type": "commit"}, {"oid": "a13bea3fd22ed5c6abd2e23f322c3ddeacd31ecd", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a13bea3fd22ed5c6abd2e23f322c3ddeacd31ecd", "message": "Change help instructions for test command and output for test examples", "committedDate": "2020-02-10T08:56:52Z", "type": "forcePushed"}]}