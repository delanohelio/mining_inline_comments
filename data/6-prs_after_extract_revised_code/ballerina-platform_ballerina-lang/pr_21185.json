{"pr_number": 21185, "pr_title": "Add \"Optimize All Imports\" code action", "pr_createdAt": "2020-02-20T11:32:28Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/21185", "timeline": [{"oid": "7ff2f7f299b17edbf4761a7798a70da14312710a", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7ff2f7f299b17edbf4761a7798a70da14312710a", "message": "Fix test failure\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-25T08:14:55Z", "type": "forcePushed"}, {"oid": "ff2da98299332b544ab3864e2e5ef416c2f9c2e1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ff2da98299332b544ab3864e2e5ef416c2f9c2e1", "message": "Fix test failures\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:04:53Z", "type": "forcePushed"}, {"oid": "37f620f286d9540ed47c2c7b506d793f73b3238b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/37f620f286d9540ed47c2c7b506d793f73b3238b", "message": "Make compile once for the diagnostics\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:10:23Z", "type": "commit"}, {"oid": "3ecf67397a4fd229ef0bf49991e98a686ce8ee7a", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3ecf67397a4fd229ef0bf49991e98a686ce8ee7a", "message": "Remove redundant keys DOCUMENT_MANAGER_KEY, FILE_URI_KEY\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:10:23Z", "type": "commit"}, {"oid": "e05007852ad2d04e726649339fc145043c81e687", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e05007852ad2d04e726649339fc145043c81e687", "message": "Fix NPE when running language server tests\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:11:26Z", "type": "commit"}, {"oid": "1fbb4777c35e67ac686e87526403bcb974d8e0f4", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1fbb4777c35e67ac686e87526403bcb974d8e0f4", "message": "Add \"IMPORTS\" top-level node\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:11:27Z", "type": "commit"}, {"oid": "7385ccbb22343ff5c5be4398c517932ee8cb4bc8", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7385ccbb22343ff5c5be4398c517932ee8cb4bc8", "message": "Move getLSDiagnostics of the CodeActionTest into CodeActionUtil\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:11:28Z", "type": "commit"}, {"oid": "180b3649c6e212171aa9e0bcc05c5e644dce96f9", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/180b3649c6e212171aa9e0bcc05c5e644dce96f9", "message": "Revamp code action context builder\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:11:29Z", "type": "commit"}, {"oid": "ec7777aa8e95ea7799ca2a83d8b5d21f9c5ef784", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ec7777aa8e95ea7799ca2a83d8b5d21f9c5ef784", "message": "Revamp code actions\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:14:11Z", "type": "commit"}, {"oid": "8831e40b25231f1ac5d9743ea28d1993b0f9a995", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8831e40b25231f1ac5d9743ea28d1993b0f9a995", "message": "Add \"Optimize All Imports\" code action\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:14:12Z", "type": "commit"}, {"oid": "3236ebbbd0747d6645b99c5d66d92488b153a308", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3236ebbbd0747d6645b99c5d66d92488b153a308", "message": "Fix test failures\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:14:12Z", "type": "commit"}, {"oid": "3236ebbbd0747d6645b99c5d66d92488b153a308", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3236ebbbd0747d6645b99c5d66d92488b153a308", "message": "Fix test failures\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-26T09:14:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwOTA3NA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21185#discussion_r384909074", "bodyText": "Can we use https://github.com/ballerina-platform/ballerina-lang/blob/master/language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/common/utils/CommonUtil.java#L186 to convert the diagnostic position to zero-based positioning?", "author": "nadeeshaan", "createdAt": "2020-02-27T04:34:59Z", "path": "language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/codeaction/CodeActionUtil.java", "diffHunk": "@@ -140,4 +156,42 @@ public static CodeActionNodeType topLevelNodeInLine(TextDocumentIdentifier ident\n             return null;\n         }\n     }\n+\n+    /**\n+     * Translates ballerina diagnostics into lsp4j diagnostics.\n+     *\n+     * @param ballerinaDiags a list of {@link org.ballerinalang.util.diagnostic.Diagnostic}\n+     * @return a list of {@link Diagnostic}\n+     */\n+    public static List<org.eclipse.lsp4j.Diagnostic> toDiagnostics(\n+            List<org.ballerinalang.util.diagnostic.Diagnostic> ballerinaDiags) {\n+        List<org.eclipse.lsp4j.Diagnostic> lsDiagnostics = new ArrayList<>();\n+        ballerinaDiags.forEach(diagnostic -> {\n+            org.eclipse.lsp4j.Diagnostic lsDiagnostic = new org.eclipse.lsp4j.Diagnostic();\n+            lsDiagnostic.setSeverity(DiagnosticSeverity.Error);\n+            lsDiagnostic.setMessage(diagnostic.getMessage());\n+            Range r = new Range();\n+\n+            int startLine = diagnostic.getPosition().getStartLine() - 1; // LSP diagnostics range is 0 based\n+            int startChar = diagnostic.getPosition().getStartColumn() - 1;\n+            int endLine = diagnostic.getPosition().getEndLine() - 1;\n+            int endChar = diagnostic.getPosition().getEndColumn() - 1;", "originalCommit": "3236ebbbd0747d6645b99c5d66d92488b153a308", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkxMjM3OQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21185#discussion_r384912379", "bodyText": "Will fix in a separate PR", "author": "rasika", "createdAt": "2020-02-27T04:51:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwOTA3NA=="}], "type": "inlineReview", "revised_code": null}]}