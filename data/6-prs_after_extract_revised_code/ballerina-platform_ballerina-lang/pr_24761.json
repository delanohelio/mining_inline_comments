{"pr_number": 24761, "pr_title": "Fix issue in parsing invalid mapping constructure expression", "pr_createdAt": "2020-07-15T11:57:06Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/24761", "timeline": [{"oid": "b1bd3ed3712b3943629761bc7a45ffc48e0288a5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b1bd3ed3712b3943629761bc7a45ffc48e0288a5", "message": "Enable testFunctionPointersWithNamedArgs", "committedDate": "2020-07-14T12:18:58Z", "type": "commit"}, {"oid": "cc22a257e748417d47ff6cba90b9974f7b6d0a2f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/cc22a257e748417d47ff6cba90b9974f7b6d0a2f", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang", "committedDate": "2020-07-15T04:15:40Z", "type": "commit"}, {"oid": "973287c87d8fa573b68b735ac00abff63f5f0092", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/973287c87d8fa573b68b735ac00abff63f5f0092", "message": "Fix issue in parsing mapping constructure expression", "committedDate": "2020-07-15T11:41:51Z", "type": "commit"}, {"oid": "19c2fd47ec7c6546c7bf6649709331e3808ee5a6", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/19c2fd47ec7c6546c7bf6649709331e3808ee5a6", "message": "Add test case.", "committedDate": "2020-07-15T11:55:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NDQ4Mw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24761#discussion_r455044483", "bodyText": "Would it be possible to incorporate the above change to the existing method?\nThere are other places that uses the same getExpression method, and the issue may also be there for those as well.", "author": "SupunS", "createdAt": "2020-07-15T13:19:25Z", "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java", "diffHunk": "@@ -15446,7 +15480,7 @@ private STNode parseStmtAsMappingBPOrMappingConsStart(STNode openBrace, STNode m\n \n                 // else treat as expression.\n                 switchContext(ParserRuleContext.EXPRESSION_STATEMENT);\n-                expr = getExpression(bpOrConstructor);\n+                expr = getMappingConstructureExpr(bpOrConstructor);", "originalCommit": "19c2fd47ec7c6546c7bf6649709331e3808ee5a6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTExMzExMQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24761#discussion_r455113111", "bodyText": "This is very specific case, we can not use the existing method since getExpression is used in other places. If we r to change QUALIFIED_NAME_REFERENCE case in getExpression It will affect others", "author": "rdulmina", "createdAt": "2020-07-15T14:51:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NDQ4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4MTg3NA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24761#discussion_r455481874", "bodyText": "Yeah thats true. But we can change the way we construct the MAPPING_BP_OR_MAPPING_CONSTRUCTOR content, inside getExpression..", "author": "SupunS", "createdAt": "2020-07-16T03:04:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NDQ4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIxNjI5NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24761#discussion_r456216295", "bodyText": "Changes done", "author": "rdulmina", "createdAt": "2020-07-17T04:48:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NDQ4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "570984ebb4dbbe3c143e182b2baa74aa382c476b", "chunk": "diff --git a/compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java b/compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java\nindex 049d0e697d8..9da0a796241 100644\n--- a/compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java\n+++ b/compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java\n\n@@ -15480,7 +15446,7 @@ public class BallerinaParser extends AbstractParser {\n \n                 // else treat as expression.\n                 switchContext(ParserRuleContext.EXPRESSION_STATEMENT);\n-                expr = getMappingConstructureExpr(bpOrConstructor);\n+                expr = getExpression(bpOrConstructor);\n                 expr = parseExpressionRhs(DEFAULT_OP_PRECEDENCE, expr, false, true);\n                 return parseStatementStartWithExprRhs(expr);\n         }\n"}}, {"oid": "c821c1e0c994443bc2bae429f4b7b1c2654e3d1c", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c821c1e0c994443bc2bae429f4b7b1c2654e3d1c", "message": "Enabled testObjSubtypingSemanticsNegative", "committedDate": "2020-07-15T16:34:50Z", "type": "commit"}, {"oid": "c57ab9226d2a94c92d346eb72bc8efbeac9ee907", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c57ab9226d2a94c92d346eb72bc8efbeac9ee907", "message": "Enable invalidMainFunctionSignatureTest", "committedDate": "2020-07-16T03:16:31Z", "type": "commit"}, {"oid": "570984ebb4dbbe3c143e182b2baa74aa382c476b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/570984ebb4dbbe3c143e182b2baa74aa382c476b", "message": "Embed get getMappingConstructureExpr method into the getExpression method.", "committedDate": "2020-07-17T04:48:02Z", "type": "commit"}, {"oid": "e7356b3b198fa9f9e6ff52fbc7998b4a3bcecfae", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e7356b3b198fa9f9e6ff52fbc7998b4a3bcecfae", "message": "Fix checkstyle issue", "committedDate": "2020-07-17T05:14:57Z", "type": "commit"}, {"oid": "71c64ce9daf7cda24c1b14e8fa927fe79157bfac", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/71c64ce9daf7cda24c1b14e8fa927fe79157bfac", "message": "Fix checkstyle issue.", "committedDate": "2020-07-17T05:36:40Z", "type": "commit"}]}