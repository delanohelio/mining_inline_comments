{"pr_number": 25134, "pr_title": "Fix create function code action generate invalid source", "pr_createdAt": "2020-08-04T15:15:29Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/25134", "timeline": [{"oid": "43fc6200748a73717b25fb11f078322678f92479", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/43fc6200748a73717b25fb11f078322678f92479", "message": "Enable command execution tests\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-08-04T15:12:34Z", "type": "commit"}, {"oid": "d8552623e90c72d9766fe97250bcfb3b6e528184", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d8552623e90c72d9766fe97250bcfb3b6e528184", "message": "Add record return-typed test for function-gen\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-08-04T15:13:09Z", "type": "commit"}, {"oid": "15a2c3b3eb16e820c3a63498dd80f23d20e245a4", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/15a2c3b3eb16e820c3a63498dd80f23d20e245a4", "message": "Disabled failing test\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-08-04T15:13:57Z", "type": "commit"}, {"oid": "4fe080d35d3e4880935aa37b15feff96f5f302de", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4fe080d35d3e4880935aa37b15feff96f5f302de", "message": "Fix create function fails for record return-types\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-08-04T15:14:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ3NTg0MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25134#discussion_r465475840", "bodyText": "Shall we use isInvalidSymbol() util method in CommonUtil.java?", "author": "nadeeshaan", "createdAt": "2020-08-05T05:08:43Z", "path": "language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/common/utils/FunctionGenerator.java", "diffHunk": "@@ -577,6 +577,16 @@ public static String generateReturnValue(ImportsAcceptor importsAcceptor, Packag\n             String paramsStr = String.join(\", \", list);\n             String newObjStr = \"new \" + pkgPrefix + bStruct.name.getValue() + \"(\" + paramsStr + \")\";\n             return template.replace(\"{%1}\", newObjStr);\n+        } else if (bType instanceof BRecordType) {\n+            BRecordType recordType = (BRecordType) bType;\n+            StringJoiner sb = new StringJoiner(\", \");\n+            if (recordType.tsymbol != null && recordType.tsymbol.name != null &&", "originalCommit": "4fe080d35d3e4880935aa37b15feff96f5f302de", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0129f98f418081142a7535391eb2cd1655f509c1", "chunk": "diff --git a/language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/common/utils/FunctionGenerator.java b/language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/common/utils/FunctionGenerator.java\nindex 6e14920c5e5..b9fc6368ca9 100644\n--- a/language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/common/utils/FunctionGenerator.java\n+++ b/language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/common/utils/FunctionGenerator.java\n\n@@ -580,8 +580,7 @@ public class FunctionGenerator {\n         } else if (bType instanceof BRecordType) {\n             BRecordType recordType = (BRecordType) bType;\n             StringJoiner sb = new StringJoiner(\", \");\n-            if (recordType.tsymbol != null && recordType.tsymbol.name != null &&\n-                    (recordType.tsymbol.name.value.isEmpty() || recordType.tsymbol.name.value.startsWith(\"$\"))) {\n+            if (CommonUtil.isInvalidSymbol(recordType.tsymbol)) {\n                 for (BField field : recordType.fields.values()) {\n                     sb.add(field.name.value + \": \" + generateReturnValue(field.type.tsymbol, \"{%1}\"));\n                 }\n"}}, {"oid": "0129f98f418081142a7535391eb2cd1655f509c1", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0129f98f418081142a7535391eb2cd1655f509c1", "message": "Use isInvalidSymbol\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-08-05T07:45:46Z", "type": "commit"}]}