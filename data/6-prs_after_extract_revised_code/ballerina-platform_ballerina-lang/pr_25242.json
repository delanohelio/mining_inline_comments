{"pr_number": 25242, "pr_title": "Use ListNode for all delimited lists in the parser", "pr_createdAt": "2020-08-12T20:42:17Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/25242", "timeline": [{"oid": "72d8e49bb9d68000508b025122d817aa4a259da5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/72d8e49bb9d68000508b025122d817aa4a259da5", "message": "Use NodeList for service listeners", "committedDate": "2020-08-11T10:11:04Z", "type": "commit"}, {"oid": "0f2650f639223fb6ddae28bd7f74ba52bc9cae5f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0f2650f639223fb6ddae28bd7f74ba52bc9cae5f", "message": "Update assertions with service declaration", "committedDate": "2020-08-11T11:55:15Z", "type": "commit"}, {"oid": "4ebf201e1d3787f21da556fd79970126036c2130", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4ebf201e1d3787f21da556fd79970126036c2130", "message": "Use NodeList for function parameters", "committedDate": "2020-08-12T13:35:41Z", "type": "commit"}, {"oid": "2a188f8717bf0140bdf51ebfbe9ce4605ae55d0b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2a188f8717bf0140bdf51ebfbe9ce4605ae55d0b", "message": "Update assertions with function parameters", "committedDate": "2020-08-12T13:49:37Z", "type": "commit"}, {"oid": "b140bc1ba6219bb23dcaa7b0fc1626a6a0df2cfd", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b140bc1ba6219bb23dcaa7b0fc1626a6a0df2cfd", "message": "Use NodeList for import version number", "committedDate": "2020-08-12T19:32:19Z", "type": "commit"}, {"oid": "6d3148c0e87a526a277c2789eff57dbd365824a2", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6d3148c0e87a526a277c2789eff57dbd365824a2", "message": "Update assertions with import version number", "committedDate": "2020-08-12T19:39:34Z", "type": "commit"}, {"oid": "400c6aa027a3565e195619781d8ed3ab038d2f83", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/400c6aa027a3565e195619781d8ed3ab038d2f83", "message": "Fix VariableDeclarationNode metadata parsing", "committedDate": "2020-08-12T20:18:28Z", "type": "commit"}, {"oid": "0e89bac6be3681b4ede816e07ab63ce8cb70d5be", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0e89bac6be3681b4ede816e07ab63ce8cb70d5be", "message": "Refactor code", "committedDate": "2020-08-12T20:38:12Z", "type": "commit"}, {"oid": "1aa73265549f45ca8395de84cb6923db33afdfac", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1aa73265549f45ca8395de84cb6923db33afdfac", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into fix-delimited-lists", "committedDate": "2020-08-12T21:14:58Z", "type": "commit"}, {"oid": "794ac0d411ea4a2bc2e7768c36a0464d32dac744", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/794ac0d411ea4a2bc2e7768c36a0464d32dac744", "message": "Update FormattingTreeModifier for syntax tree changes", "committedDate": "2020-08-13T06:13:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyNzg1Mw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25242#discussion_r469727853", "bodyText": "Found a bug in TreeModifier.java. \n  \n    \n      ballerina-lang/compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/syntax/tree/TreeModifier.java\n    \n    \n        Lines 3100 to 3101\n      in\n      c4f3e10\n    \n    \n    \n    \n\n        \n          \n           protected <T extends Node> SeparatedNodeList<T> modifySeparatedNodeList(SeparatedNodeList<T> nodeList) { \n        \n\n        \n          \n               return modifyGenericNodeList(nodeList, SeparatedNodeList::new); \n        \n    \n  \n\n\n\n\nHere we have used modifyGenericNodeList() which only iterates through the alternative elements as we are parsing a SeparatedNodeList object, not  NodeList\n\n\nSo when there's no modification that method simply returns the original SeparatedNodeList which is fine.\nBut when there's a modification it return SeparatedNodeList which does not contain separators as no processing has been added with getSeparator().\n\n\nSubsequently, when we are formatting and when there's a modification, separators just get vanished.\n\n\n@sameerajayasoma @SupunS shall I create an issue for the root cause?", "author": "lochana-chathura", "createdAt": "2020-08-13T06:36:21Z", "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -278,7 +258,7 @@ public FunctionSignatureNode transform(FunctionSignatureNode functionSignatureNo\n         Token openPara = getToken(functionSignatureNode.openParenToken());\n         Token closePara = getToken(functionSignatureNode.closeParenToken());\n \n-        NodeList<ParameterNode> parameters = this.modifyNodeList(functionSignatureNode.parameters());\n+        SeparatedNodeList<ParameterNode> parameters = this.modifySeparatedNodeList(functionSignatureNode.parameters());", "originalCommit": "794ac0d411ea4a2bc2e7768c36a0464d32dac744", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg4NDMyOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25242#discussion_r469884329", "bodyText": "+1. Please create an issue", "author": "SupunS", "createdAt": "2020-08-13T11:30:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyNzg1Mw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "d136c0fb829ccd82bc5025b53e65122ffeee51df", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d136c0fb829ccd82bc5025b53e65122ffeee51df", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into fix-delimited-lists", "committedDate": "2020-08-13T06:53:46Z", "type": "commit"}, {"oid": "1fd03923d6bba4555ce827a1c79d25294bd151ad", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1fd03923d6bba4555ce827a1c79d25294bd151ad", "message": "Update failing assertions and relocate QuotedIdentifierTest", "committedDate": "2020-08-13T07:39:34Z", "type": "commit"}, {"oid": "c8e8c25745ccccc9f98ca9875d689460943da55f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c8e8c25745ccccc9f98ca9875d689460943da55f", "message": "Fix jballerina-unit-test failures due to upstream changes", "committedDate": "2020-08-13T10:26:13Z", "type": "commit"}]}