{"pr_number": 27561, "pr_title": "Change 'validatePackageVersion' to use semver library", "pr_createdAt": "2020-12-17T12:05:34Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/27561", "timeline": [{"oid": "152e30fe7be19c5aa01ecec209f1afab1a446480", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/152e30fe7be19c5aa01ecec209f1afab1a446480", "message": "Change 'validatePackageVersion' to use semver library", "committedDate": "2020-12-17T12:04:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4MzIzOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27561#discussion_r545183239", "bodyText": "We need to improve this error message. Please have a look at the SemanticVersion class", "author": "sameerajayasoma", "createdAt": "2020-12-17T15:34:39Z", "path": "cli/central-client/src/main/java/org/ballerinalang/central/client/Utils.java", "diffHunk": "@@ -128,9 +129,13 @@ public static void createBaloInHomeRepo(HttpURLConnection conn, Path pkgPathInBa\n      *\n      * @param pkgVersion   package version\n      * @param logFormatter log formatter\n+     * @return valid package version\n      */\n-    static void validatePackageVersion(String pkgVersion, LogFormatter logFormatter) throws CentralClientException {\n-        if (!pkgVersion.matches(VERSION_REGEX)) {\n+    static String validatePackageVersion(String pkgVersion, LogFormatter logFormatter) throws CentralClientException {\n+        try {\n+            Version version = Version.valueOf(pkgVersion);\n+            return version.toString();\n+        } catch (IllegalArgumentException | ParseException e) {\n             throw new CentralClientException(logFormatter.formatLog(\"package version could not be detected\"));", "originalCommit": "152e30fe7be19c5aa01ecec209f1afab1a446480", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4ODIyNw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27561#discussion_r545188227", "bodyText": "Pls check now", "author": "pramodya1994", "createdAt": "2020-12-17T15:40:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4MzIzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE5ODE0MQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27561#discussion_r545198141", "bodyText": "Looks good", "author": "sameerajayasoma", "createdAt": "2020-12-17T15:53:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4MzIzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "9526e2c7a182ff6b6aae4e6199bf7b617f9bd8c0", "chunk": "diff --git a/cli/central-client/src/main/java/org/ballerinalang/central/client/Utils.java b/cli/central-client/src/main/java/org/ballerinalang/central/client/Utils.java\nindex 8206e668296..178ee0319c4 100644\n--- a/cli/central-client/src/main/java/org/ballerinalang/central/client/Utils.java\n+++ b/cli/central-client/src/main/java/org/ballerinalang/central/client/Utils.java\n\n@@ -135,8 +136,14 @@ public class Utils {\n         try {\n             Version version = Version.valueOf(pkgVersion);\n             return version.toString();\n-        } catch (IllegalArgumentException | ParseException e) {\n-            throw new CentralClientException(logFormatter.formatLog(\"package version could not be detected\"));\n+        } catch (IllegalArgumentException e) {\n+            throw new CentralClientException(logFormatter.formatLog(\"Version cannot be empty\"));\n+        } catch (UnexpectedCharacterException e) {\n+            throw new CentralClientException(\n+                    logFormatter.formatLog(\"Invalid version: '\" + pkgVersion + \"'. \" + e.toString()));\n+        } catch (ParseException e) {\n+            throw new CentralClientException(\n+                    logFormatter.formatLog(\"Invalid version: '\" + pkgVersion + \"'. \" + e.toString()));\n         }\n     }\n \n"}}, {"oid": "9526e2c7a182ff6b6aae4e6199bf7b617f9bd8c0", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9526e2c7a182ff6b6aae4e6199bf7b617f9bd8c0", "message": "Resolve PR Comments", "committedDate": "2020-12-17T15:39:39Z", "type": "commit"}, {"oid": "9f473850cabbe136adbb94df38dac64389c0ead5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9f473850cabbe136adbb94df38dac64389c0ead5", "message": "Fix testValidatePackageVersion test failure", "committedDate": "2020-12-17T16:06:11Z", "type": "commit"}]}