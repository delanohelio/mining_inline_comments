{"pr_number": 24653, "pr_title": "Enable StartActionTest. testStartActionNegative", "pr_createdAt": "2020-07-08T10:27:18Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/24653", "timeline": [{"oid": "b0149e513594dffcd255ed94e8eb979ab3c01e63", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b0149e513594dffcd255ed94e8eb979ab3c01e63", "message": "Enable StartActionTest. testStartActionNegative", "committedDate": "2020-07-08T10:25:50Z", "type": "commit"}, {"oid": "1fd12e742b2eaee496d154653a1324ba082ea843", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1fd12e742b2eaee496d154653a1324ba082ea843", "message": "Correct error count", "committedDate": "2020-07-08T11:49:36Z", "type": "commit"}, {"oid": "3614fe01b3847753c96321d9006b5bb482757f5d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3614fe01b3847753c96321d9006b5bb482757f5d", "message": "Fix conflict", "committedDate": "2020-07-08T11:53:51Z", "type": "commit"}, {"oid": "0e6a1c67984c56ebc4e3ea15c90a30f2f59aa13f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0e6a1c67984c56ebc4e3ea15c90a30f2f59aa13f", "message": "Fix Error count", "committedDate": "2020-07-08T12:45:37Z", "type": "commit"}, {"oid": "165af7bc96a8af666e0afa77333497366d4ddbf4", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/165af7bc96a8af666e0afa77333497366d4ddbf4", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into UnitTestFix", "committedDate": "2020-07-09T07:07:41Z", "type": "commit"}, {"oid": "55c0fe0d4307eb89f9f0b50fedfeab3d9188dc19", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/55c0fe0d4307eb89f9f0b50fedfeab3d9188dc19", "message": "Enable testNegativeWorkerActions", "committedDate": "2020-07-09T12:29:43Z", "type": "commit"}, {"oid": "553f96e40705cce500f7f086f571f5b9fe2468f4", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/553f96e40705cce500f7f086f571f5b9fe2468f4", "message": "Move adding diagnostics for action invocation a level up", "committedDate": "2020-07-09T13:49:25Z", "type": "commit"}, {"oid": "5bc0edae8676081ebdf1b16734fbe65cbdfc50eb", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5bc0edae8676081ebdf1b16734fbe65cbdfc50eb", "message": "Fix checkstyle", "committedDate": "2020-07-10T04:44:23Z", "type": "commit"}, {"oid": "2c5619dfb6ffc87d0648e76fab42a179dc10638a", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2c5619dfb6ffc87d0648e76fab42a179dc10638a", "message": "Add test to test, action instead of expression", "committedDate": "2020-07-10T05:57:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1MTY1NA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24653#discussion_r452651654", "bodyText": "Any clue on why do we need to special-case start-acton here?", "author": "SupunS", "createdAt": "2020-07-10T06:43:09Z", "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/parser/BLangNodeTransformer.java", "diffHunk": "@@ -2457,6 +2457,20 @@ public BLangNode transform(ExpressionStatementNode expressionStatement) {\n         switch (kind) {\n             case ASYNC_SEND_ACTION:\n                 return expressionStatement.expression().apply(this);\n+            case WAIT_ACTION:\n+                WaitActionNode waitActionNode =\n+                        (WaitActionNode) expressionStatement.expression();\n+                if (waitActionNode.waitFutureExpr().kind() == SyntaxKind.START_ACTION) {\n+                    BLangWorkerSend bLangWorkerSend =\n+                            (BLangWorkerSend) TreeBuilder.createWorkerSendNode();\n+                    bLangWorkerSend.expr = createExpression(expressionStatement.expression());\n+                    bLangWorkerSend.pos = getPosition(expressionStatement);\n+                    AsyncSendActionNode asyncSendActionNode =\n+                            (AsyncSendActionNode) ((StartActionNode) waitActionNode.waitFutureExpr()).expression();\n+                    bLangWorkerSend.setWorkerName(createIdentifier(asyncSendActionNode.peerWorker().name()));\n+                    return bLangWorkerSend;\n+                }", "originalCommit": "2c5619dfb6ffc87d0648e76fab42a179dc10638a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1MzA1Ng==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24653#discussion_r452653056", "bodyText": "no Idea, that's just the way the node is getting transformed. it doesn't follow that path for anything else.", "author": "m36dot", "createdAt": "2020-07-10T06:47:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1MTY1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1NDA4Nw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24653#discussion_r452654087", "bodyText": "no i meant, what was the reason to special case the start-action?", "author": "SupunS", "createdAt": "2020-07-10T06:49:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1MTY1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1NDc0MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24653#discussion_r452654740", "bodyText": "well when we have a start action inside a wait action the old parser doesnt return an expressionstmt node but rather a workersendNode. so thats the reason", "author": "m36dot", "createdAt": "2020-07-10T06:51:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1MTY1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY2NTMxOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24653#discussion_r452665319", "bodyText": "even when the original node is an expressionstatement node", "author": "m36dot", "createdAt": "2020-07-10T07:15:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1MTY1NA=="}], "type": "inlineReview", "revised_code": null}]}