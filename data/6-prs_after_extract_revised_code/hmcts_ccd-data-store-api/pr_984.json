{"pr_number": 984, "pr_title": "Rdm 8747: supplementary data db changes", "pr_createdAt": "2020-06-19T08:00:23Z", "pr_url": "https://github.com/hmcts/ccd-data-store-api/pull/984", "timeline": [{"oid": "290950af7555176c6417b9e53e4d162e1bee76fe", "url": "https://github.com/hmcts/ccd-data-store-api/commit/290950af7555176c6417b9e53e4d162e1bee76fe", "message": "work in progress.", "committedDate": "2020-06-19T07:59:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjcwNDI4NA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#discussion_r442704284", "bodyText": "we don't want to allow getting and setting the whole supplementary data. Consider providing methods to instead get and set specific properties", "author": "mario-paniccia", "createdAt": "2020-06-19T08:23:07Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java", "diffHunk": "@@ -208,6 +215,22 @@ public void setLastStateModifiedDate(LocalDateTime lastStateModifiedDate) {\n         this.lastStateModifiedDate = lastStateModifiedDate;\n     }\n \n+    public Map<String, JsonNode> getSupplementaryData() {\n+        return supplementaryData;\n+    }\n+\n+    public void setSupplementaryData(Map<String, JsonNode> supplementaryData) {\n+        this.supplementaryData = supplementaryData;\n+    }", "originalCommit": "290950af7555176c6417b9e53e4d162e1bee76fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjc4NzE4Mg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#discussion_r442787182", "bodyText": "it is work in progress I added for my own benefit while I am doing the work . But understood", "author": "Thor-tech-of-metal", "createdAt": "2020-06-19T11:29:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjcwNDI4NA=="}], "type": "inlineReview", "revised_code": {"commit": "86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java b/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java\nindex 78b4126d2..5ccfe9d25 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java\n\n@@ -215,22 +208,6 @@ public class CaseDetails implements Cloneable {\n         this.lastStateModifiedDate = lastStateModifiedDate;\n     }\n \n-    public Map<String, JsonNode> getSupplementaryData() {\n-        return supplementaryData;\n-    }\n-\n-    public void setSupplementaryData(Map<String, JsonNode> supplementaryData) {\n-        this.supplementaryData = supplementaryData;\n-    }\n-\n-    public LocalDateTime getSupplementaryDataLastModified() {\n-        return supplementaryDataLastModified;\n-    }\n-\n-    public void setSupplementaryDataLastModified(LocalDateTime supplementaryDataLastModified) {\n-        this.supplementaryDataLastModified = supplementaryDataLastModified;\n-    }\n-\n     /**\n      * @deprecated Will be removed in version 2.x. Use {@link CaseDetails#dataClassification} instead.\n      */\n"}}, {"oid": "95a9061f27d9d059fab03aaba5b20704fe20b58e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/95a9061f27d9d059fab03aaba5b20704fe20b58e", "message": "RDM-8747: New fields for supplementary data to CCD and ES case\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [RDM-8747] (https://tools.hmcts.net/jira/browse/RDM-8747).\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 New fields for supplementary data to CCD and ES case", "committedDate": "2020-06-19T11:36:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE0NDI4MA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#discussion_r444144280", "bodyText": "src/main/java/uk/gov/hmcts/ccd/data/casedetails/CaseDetailsEntity.java will be removed from the PR", "author": "Thor-tech-of-metal", "createdAt": "2020-06-23T11:10:35Z", "path": "src/main/java/uk/gov/hmcts/ccd/data/casedetails/CaseDetailsEntity.java", "diffHunk": "@@ -1,31 +1,43 @@\n package uk.gov.hmcts.ccd.data.casedetails;", "originalCommit": "95a9061f27d9d059fab03aaba5b20704fe20b58e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/data/casedetails/CaseDetailsEntity.java b/src/main/java/uk/gov/hmcts/ccd/data/casedetails/CaseDetailsEntity.java\nindex d3423ea8b..de870ee92 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/data/casedetails/CaseDetailsEntity.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/data/casedetails/CaseDetailsEntity.java\n\n@@ -1,43 +1,31 @@\n package uk.gov.hmcts.ccd.data.casedetails;\n \n+import javax.persistence.*;\n+import java.time.LocalDateTime;\n+\n import com.fasterxml.jackson.databind.JsonNode;\n import uk.gov.hmcts.ccd.data.JsonDataConverter;\n \n-import javax.persistence.Column;\n-import javax.persistence.Convert;\n-import javax.persistence.Entity;\n-import javax.persistence.EnumType;\n-import javax.persistence.Enumerated;\n-import javax.persistence.GeneratedValue;\n-import javax.persistence.GenerationType;\n-import javax.persistence.Id;\n-import javax.persistence.NamedQueries;\n-import javax.persistence.NamedQuery;\n-import javax.persistence.Table;\n-import javax.persistence.Version;\n-import java.time.LocalDateTime;\n-\n-@SuppressWarnings(\"checkstyle:OperatorWrap\")\n-// too many legacy OperatorWrap occurrences on JSON strings so suppress until move to Java12+\n+@SuppressWarnings(\"checkstyle:OperatorWrap\") // too many legacy OperatorWrap occurrences on JSON strings so suppress until move to Java12+\n @NamedQueries({\n     @NamedQuery(name = CaseDetailsEntity.FIND_BY_METADATA, query =\n         \"SELECT cd FROM CaseDetailsEntity cd \" +\n-            \"WHERE UPPER(cd.jurisdiction) LIKE UPPER(:\" + CaseDetailsEntity.JURISDICTION_ID_PARAM + \") \" +\n-            \"AND UPPER(cd.caseType) LIKE UPPER(:\" + CaseDetailsEntity.CASE_TYPE_PARAM + \") \" +\n-            \"AND UPPER(cd.state) LIKE UPPER(:\" + CaseDetailsEntity.STATE_PARAM + \") \" +\n-            \"ORDER BY cd.createdDate ASC \"\n+        \"WHERE UPPER(cd.jurisdiction) LIKE UPPER(:\" + CaseDetailsEntity.JURISDICTION_ID_PARAM + \") \" +\n+        \"AND UPPER(cd.caseType) LIKE UPPER(:\" + CaseDetailsEntity.CASE_TYPE_PARAM + \") \" +\n+        \"AND UPPER(cd.state) LIKE UPPER(:\" + CaseDetailsEntity.STATE_PARAM + \") \" +\n+        \"ORDER BY cd.createdDate ASC \"\n     ),\n \n     @NamedQuery(name = CaseDetailsEntity.FIND_CASE, query =\n         \"SELECT cd FROM CaseDetailsEntity cd \" +\n-            \"WHERE UPPER(cd.jurisdiction) = UPPER(:\" + CaseDetailsEntity.JURISDICTION_ID_PARAM + \") \" +\n-            \"AND UPPER(cd.caseType) = UPPER(:\" + CaseDetailsEntity.CASE_TYPE_PARAM + \") \" +\n-            \"AND cd.reference = :\" + CaseDetailsEntity.CASE_REFERENCE_PARAM\n+        \"WHERE UPPER(cd.jurisdiction) = UPPER(:\" + CaseDetailsEntity.JURISDICTION_ID_PARAM + \") \" +\n+        \"AND UPPER(cd.caseType) = UPPER(:\" + CaseDetailsEntity.CASE_TYPE_PARAM + \") \" +\n+        \"AND cd.reference = :\" + CaseDetailsEntity.CASE_REFERENCE_PARAM\n     ),\n \n     @NamedQuery(name = CaseDetailsEntity.FIND_BY_REFERENCE, query =\n         \"SELECT cd FROM CaseDetailsEntity cd \" +\n-            \"WHERE cd.reference = :\" + CaseDetailsEntity.CASE_REFERENCE_PARAM\n+        \"WHERE cd.reference = :\" + CaseDetailsEntity.CASE_REFERENCE_PARAM\n     ),\n \n     @NamedQuery(\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE0NDQ4NA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#discussion_r444144484", "bodyText": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java  will be removed from the PR", "author": "Thor-tech-of-metal", "createdAt": "2020-06-23T11:11:02Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java", "diffHunk": "@@ -30,7 +30,8 @@\n import static uk.gov.hmcts.ccd.domain.model.definition.FieldTypeDefinition.CASE_PAYMENT_HISTORY_VIEWER;", "originalCommit": "95a9061f27d9d059fab03aaba5b20704fe20b58e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java b/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java\nindex 78b4126d2..5ccfe9d25 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java\n\n@@ -30,8 +30,7 @@ import static uk.gov.hmcts.ccd.data.casedetails.search.MetaData.CaseField.STATE;\n import static uk.gov.hmcts.ccd.domain.model.definition.FieldTypeDefinition.CASE_PAYMENT_HISTORY_VIEWER;\n import static uk.gov.hmcts.ccd.domain.model.definition.FieldTypeDefinition.LABEL;\n \n-@SuppressWarnings(\"checkstyle:SummaryJavadoc\")\n-// partial javadoc attributes added prior to checkstyle implementation in module\n+@SuppressWarnings(\"checkstyle:SummaryJavadoc\") // partial javadoc attributes added prior to checkstyle implementation in module\n public class CaseDetails implements Cloneable {\n     private static final Logger LOG = LoggerFactory.getLogger(CaseDetails.class);\n     public static final String DRAFT_ID = \"DRAFT%s\";\n"}}, {"oid": "86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755", "url": "https://github.com/hmcts/ccd-data-store-api/commit/86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755", "message": "RDM-8747: New fields for supplementary data to CCD and ES case\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [RDM-8747] (https://tools.hmcts.net/jira/browse/RDM-8747).\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 New fields for supplementary data to CCD and ES case", "committedDate": "2020-06-23T14:22:48Z", "type": "commit"}, {"oid": "b3302ab2e87bbdc4667e8b6650a045ca79de87d3", "url": "https://github.com/hmcts/ccd-data-store-api/commit/b3302ab2e87bbdc4667e8b6650a045ca79de87d3", "message": "Merge branch 'develop' into RDM-8747", "committedDate": "2020-07-07T10:36:50Z", "type": "commit"}]}