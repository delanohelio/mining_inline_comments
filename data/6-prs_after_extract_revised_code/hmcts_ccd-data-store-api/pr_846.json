{"pr_number": 846, "pr_title": "RDM-7630", "pr_createdAt": "2020-03-12T15:08:45Z", "pr_url": "https://github.com/hmcts/ccd-data-store-api/pull/846", "timeline": [{"oid": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "url": "https://github.com/hmcts/ccd-data-store-api/commit/19101d5fc91a714a1f84b5e67facf5c7da82d919", "message": "RDM-8113 updated functional test", "committedDate": "2020-04-10T06:29:56Z", "type": "commit"}, {"oid": "a6bcba95f56c01f40df1f522ac4eaebc0d63c172", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a6bcba95f56c01f40df1f522ac4eaebc0d63c172", "message": "RDM-8113 updated functional test", "committedDate": "2020-04-10T06:54:11Z", "type": "commit"}, {"oid": "e8220490c5ce02151f34908079418a5fbb38a95f", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e8220490c5ce02151f34908079418a5fbb38a95f", "message": "Merge pull request #899 from hmcts/RDM-8113\n\nRDM-8113 handle display without seconds or milliseconds", "committedDate": "2020-04-15T08:44:22Z", "type": "commit"}, {"oid": "a8ee11163138570d3e8a528bcb5d270f583b17a4", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a8ee11163138570d3e8a528bcb5d270f583b17a4", "message": "Merge pull request #855 from hmcts/RDM-7694\n\nRDM-7694 - DCP for workbasket and search input/results", "committedDate": "2020-04-15T12:57:25Z", "type": "commit"}, {"oid": "b4f49ac5bbae5bca7e9f713489494830edf34205", "url": "https://github.com/hmcts/ccd-data-store-api/commit/b4f49ac5bbae5bca7e9f713489494830edf34205", "message": "Merge pull request #851 from hmcts/RDM-7692\n\nRDM-7692 - DateTime Display Formatting", "committedDate": "2020-04-15T14:24:09Z", "type": "commit"}, {"oid": "c74b3c983243259d93650bb9e87b3e523f0d7967", "url": "https://github.com/hmcts/ccd-data-store-api/commit/c74b3c983243259d93650bb9e87b3e523f0d7967", "message": "RDM-7630 - WIP", "committedDate": "2020-02-27T10:17:16Z", "type": "commit"}, {"oid": "05f6febcb2bf3c73284fd3f9b710aa5572e922e3", "url": "https://github.com/hmcts/ccd-data-store-api/commit/05f6febcb2bf3c73284fd3f9b710aa5572e922e3", "message": "RDM-7630 - WIP", "committedDate": "2020-02-28T08:46:32Z", "type": "commit"}, {"oid": "a4ccdb0a8f35d08be153c281d5f1c78b19b21709", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a4ccdb0a8f35d08be153c281d5f1c78b19b21709", "message": "Update simple DateTime fields", "committedDate": "2020-03-09T11:51:06Z", "type": "commit"}, {"oid": "12bac4712dbf4300cdf52d3782da3ffde1cdb70c", "url": "https://github.com/hmcts/ccd-data-store-api/commit/12bac4712dbf4300cdf52d3782da3ffde1cdb70c", "message": "Abstract processor", "committedDate": "2020-03-10T12:22:49Z", "type": "commit"}, {"oid": "95426ea27e7b09d42f32cdf9c21029a4cced8217", "url": "https://github.com/hmcts/ccd-data-store-api/commit/95426ea27e7b09d42f32cdf9c21029a4cced8217", "message": "Missing commit", "committedDate": "2020-03-10T12:23:50Z", "type": "commit"}, {"oid": "e9de6bab069e53e8b605e7b69166534f3846139d", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e9de6bab069e53e8b605e7b69166534f3846139d", "message": "Fix build issues", "committedDate": "2020-03-10T15:40:48Z", "type": "commit"}, {"oid": "cde8b3ec563635ff0ead76ca53d47ab0e8fa50b2", "url": "https://github.com/hmcts/ccd-data-store-api/commit/cde8b3ec563635ff0ead76ca53d47ab0e8fa50b2", "message": "Move processor prior to commonly used validate operation; further complex type handling", "committedDate": "2020-03-11T11:12:12Z", "type": "commit"}, {"oid": "94dd9b0d8b16f0513f02d0cd41ffef7009c1f937", "url": "https://github.com/hmcts/ccd-data-store-api/commit/94dd9b0d8b16f0513f02d0cd41ffef7009c1f937", "message": "Merge branch 'develop' into RDM-7630", "committedDate": "2020-03-11T11:45:34Z", "type": "commit"}, {"oid": "abd0b19eedfbbb62c263b9e26fc22b7ec4118a2c", "url": "https://github.com/hmcts/ccd-data-store-api/commit/abd0b19eedfbbb62c263b9e26fc22b7ec4118a2c", "message": "Update DCP with def store equivalent; minor cleanup", "committedDate": "2020-03-12T15:06:03Z", "type": "commit"}, {"oid": "ec186789cd4600d9ac965f6f1dd8b5711d6b5bee", "url": "https://github.com/hmcts/ccd-data-store-api/commit/ec186789cd4600d9ac965f6f1dd8b5711d6b5bee", "message": "Merge branch 'develop' into RDM-7630", "committedDate": "2020-03-12T15:09:03Z", "type": "commit"}, {"oid": "77086d938fd3d08cc67bddd0aa827d3f75958ccf", "url": "https://github.com/hmcts/ccd-data-store-api/commit/77086d938fd3d08cc67bddd0aa827d3f75958ccf", "message": "RDM-7630 Added unit tests for DefaultValidateCaseFieldsOperation.java", "committedDate": "2020-03-13T08:24:38Z", "type": "commit"}, {"oid": "a2f2c451a0db6698fa9e3d506c1c3f3d653eb024", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a2f2c451a0db6698fa9e3d506c1c3f3d653eb024", "message": "Merge remote-tracking branch 'origin/RDM-7630' into RDM-7630", "committedDate": "2020-03-13T08:24:56Z", "type": "commit"}, {"oid": "0d3e7745e16156810a7b0ad9fb9ff1407dbe6312", "url": "https://github.com/hmcts/ccd-data-store-api/commit/0d3e7745e16156810a7b0ad9fb9ff1407dbe6312", "message": "RDM-7630 Added missing unit test scenario for DefaultCreateCaseOperationTest.java", "committedDate": "2020-03-13T12:24:14Z", "type": "commit"}, {"oid": "7df5c010bf56cef7044e9557eb6bdcdd8badcb68", "url": "https://github.com/hmcts/ccd-data-store-api/commit/7df5c010bf56cef7044e9557eb6bdcdd8badcb68", "message": "Move common functionality to abstract; handle processing errors", "committedDate": "2020-03-13T12:33:08Z", "type": "commit"}, {"oid": "a326a1e137393e00b257ae5b62a61be2e1d51c5c", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a326a1e137393e00b257ae5b62a61be2e1d51c5c", "message": "Merge branch 'RDM-7630' of github.com:hmcts/ccd-data-store-api into RDM-7630", "committedDate": "2020-03-13T12:33:11Z", "type": "commit"}, {"oid": "8d68b183daf51e9415b2840c74670f5d9e9577a3", "url": "https://github.com/hmcts/ccd-data-store-api/commit/8d68b183daf51e9415b2840c74670f5d9e9577a3", "message": "Fix some tests", "committedDate": "2020-03-13T13:08:04Z", "type": "commit"}, {"oid": "7b397e54f9983237c31166aee24527b8658808eb", "url": "https://github.com/hmcts/ccd-data-store-api/commit/7b397e54f9983237c31166aee24527b8658808eb", "message": "Sonar fix", "committedDate": "2020-03-13T13:25:59Z", "type": "commit"}, {"oid": "8dcf4eb161c2eb82c65187f962f5a0fc8ce35a6f", "url": "https://github.com/hmcts/ccd-data-store-api/commit/8dcf4eb161c2eb82c65187f962f5a0fc8ce35a6f", "message": "update to DateTimeFormatParser", "committedDate": "2020-03-16T14:38:49Z", "type": "commit"}, {"oid": "d732878f90c961c933e76a7e90dcd3459c206d1e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/d732878f90c961c933e76a7e90dcd3459c206d1e", "message": "RDM-7630 added more unit tests", "committedDate": "2020-03-16T15:03:13Z", "type": "commit"}, {"oid": "48b540373383c4a4c36f5157b603a9bfaab0767e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/48b540373383c4a4c36f5157b603a9bfaab0767e", "message": "Rename and refactor for further reuse", "committedDate": "2020-03-17T14:31:07Z", "type": "commit"}, {"oid": "e351903417675640ade4355586cf05528ac7ebbc", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e351903417675640ade4355586cf05528ac7ebbc", "message": "Merge branch 'RDM-7630' of github.com:hmcts/ccd-data-store-api into RDM-7630", "committedDate": "2020-03-17T14:31:42Z", "type": "commit"}, {"oid": "1b534a43d4ced94ee73c81ac43095ee79c83a118", "url": "https://github.com/hmcts/ccd-data-store-api/commit/1b534a43d4ced94ee73c81ac43095ee79c83a118", "message": "Merge branch 'RDM-7630' into RDM-7692", "committedDate": "2020-03-17T14:32:42Z", "type": "commit"}, {"oid": "a544a963bc276e99cfd9e119bd8d7d56808bb4fb", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a544a963bc276e99cfd9e119bd8d7d56808bb4fb", "message": "RDM-7692 - Initial functionality", "committedDate": "2020-03-17T17:31:01Z", "type": "commit"}, {"oid": "522955b5157bec8047e6292513c2baa7c261e58a", "url": "https://github.com/hmcts/ccd-data-store-api/commit/522955b5157bec8047e6292513c2baa7c261e58a", "message": "Add null check", "committedDate": "2020-03-18T08:30:01Z", "type": "commit"}, {"oid": "ebe73497b6823407f43364cb11421980d2d306cf", "url": "https://github.com/hmcts/ccd-data-store-api/commit/ebe73497b6823407f43364cb11421980d2d306cf", "message": "Move null logic for FT", "committedDate": "2020-03-18T09:02:51Z", "type": "commit"}, {"oid": "2f6395a3d45687530f40410c9c0c11700e339b3d", "url": "https://github.com/hmcts/ccd-data-store-api/commit/2f6395a3d45687530f40410c9c0c11700e339b3d", "message": "FT testing", "committedDate": "2020-03-18T09:47:08Z", "type": "commit"}, {"oid": "c44b5a00163ff993914fc3ad0299d1260e41c399", "url": "https://github.com/hmcts/ccd-data-store-api/commit/c44b5a00163ff993914fc3ad0299d1260e41c399", "message": "FT testing", "committedDate": "2020-03-18T10:45:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0NzY2MQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394247661", "bodyText": "Cosmetic: Given that a new constructor was added we can make all attribute immutable and remove setters.", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T10:33:43Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseEventFieldComplex.java", "diffHunk": "@@ -11,15 +11,25 @@\n \n     private Integer order;\n \n+    private String displayContextParameter;\n+\n     public CaseEventFieldComplex() {\n     }\n \n     public CaseEventFieldComplex(String reference,\n-                                 Integer order) {\n+                                  Integer order) {\n         this.reference = reference;\n         this.order = order;\n     }\n \n+    public CaseEventFieldComplex(String reference,", "originalCommit": "2f6395a3d45687530f40410c9c0c11700e339b3d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0ODAzOA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394248038", "bodyText": "Not sure if checkstyle likes .*  organise imports", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T10:34:28Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseTypeTab.java", "diffHunk": "@@ -1,7 +1,7 @@\n package uk.gov.hmcts.ccd.domain.model.definition;\n \n import com.fasterxml.jackson.annotation.JsonProperty;\n-import io.swagger.annotations.ApiModel;\n+import io.swagger.annotations.*;\n ", "originalCommit": "2f6395a3d45687530f40410c9c0c11700e339b3d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseTypeTab.java b/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseTypeTab.java\nindex 0dcbead1f..8c5e0bb89 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseTypeTab.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseTypeTab.java\n\n@@ -1,7 +1,7 @@\n package uk.gov.hmcts.ccd.domain.model.definition;\n \n import com.fasterxml.jackson.annotation.JsonProperty;\n-import io.swagger.annotations.*;\n+import io.swagger.annotations.ApiModel;\n \n import java.io.Serializable;\n import java.util.ArrayList;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0ODQ5Mg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394248492", "bodyText": "Do we need the  @ApiModelProperty(value = \"\") ?", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T10:35:18Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CriteriaField.java", "diffHunk": "@@ -69,4 +70,14 @@ public String getRole() {\n     public void setRole(final String role) {\n         this.role = role;\n     }\n+\n+    @ApiModelProperty(value = \"\")\n+    @JsonProperty(\"display_context_parameter\")", "originalCommit": "2f6395a3d45687530f40410c9c0c11700e339b3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY2MTM2MA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r395661360", "bodyText": "Purely added for consistency with rest of this class.", "author": "danlysiak", "createdAt": "2020-03-20T14:10:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0ODQ5Mg=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0OTQ5OQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394249499", "bodyText": "Not sure if checkstyle likes .*  organise imports", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T10:37:03Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createcase/DefaultCreateCaseOperation.java", "diffHunk": "@@ -14,9 +14,7 @@\n import uk.gov.hmcts.ccd.data.user.UserRepository;\n import uk.gov.hmcts.ccd.domain.model.aggregated.IdamUser;\n import uk.gov.hmcts.ccd.domain.model.callbacks.AfterSubmitCallbackResponse;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseDetails;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseEvent;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseType;\n+import uk.gov.hmcts.ccd.domain.model.definition.*;", "originalCommit": "2f6395a3d45687530f40410c9c0c11700e339b3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY3Nzc1NQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394677755", "bodyText": "Better to create one code template file so that every one can use the same template file in their IDE. So all these import specific warnings/error messages will be handled properly", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-18T22:33:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0OTQ5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjI5NzM0NQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396297345", "bodyText": "agree with you Kiran. I did raise a ticket for this it's been in Kanban for a while but never gets picked up :)", "author": "mario-paniccia", "createdAt": "2020-03-23T09:01:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0OTQ5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg3NDAzOA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397874038", "bodyText": "resolving conversation as it's nothing particular relate to this PR.", "author": "smathangi", "createdAt": "2020-03-25T13:58:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0OTQ5OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1MjE0Nw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394252147", "bodyText": "Do we need the @ApiModelProperty(value = \"\") as value=\"\" ?", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T10:41:29Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/WorkbasketInputDefinition.java", "diffHunk": "@@ -37,4 +38,16 @@ public void setCaseTypeId(String caseTypeId) {\n     public void setFields(List<WorkbasketInputField> fields) {\n         this.fields = fields;\n     }\n+\n+    /**\n+     **/\n+    @ApiModelProperty(value = \"\")", "originalCommit": "2f6395a3d45687530f40410c9c0c11700e339b3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY2MTQzNw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r395661437", "bodyText": "Purely added for consistency with rest of this class.", "author": "danlysiak", "createdAt": "2020-03-20T14:10:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1MjE0Nw=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1MjQ1OA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394252458", "bodyText": "@ApiModelProperty(value = \"\")  do we need the value=\"\" ?", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T10:42:03Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/SearchInputDefinition.java", "diffHunk": "@@ -40,4 +41,16 @@ public void setFields(List<SearchInputField> fields) {\n         this.fields = fields;\n     }\n \n+    /**\n+     **/\n+    @ApiModelProperty(value = \"\")", "originalCommit": "2f6395a3d45687530f40410c9c0c11700e339b3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY2MTQ4OQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r395661489", "bodyText": "Purely added for consistency with rest of this class.", "author": "danlysiak", "createdAt": "2020-03-20T14:10:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1MjQ1OA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1NjUyNQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394256525", "bodyText": "I am not sure about the  requirements . Can we create a \"\" format ?  Would that be default ? or it will lead directly in exception.   If we know before it we can treat it  as  throw new DataProcessingException() . in Common  error handling place.", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T10:49:13Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.node.ArrayNode;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.fasterxml.jackson.databind.node.TextNode;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n+import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameter.*;\n+\n+@Component\n+public class DateTimeEntryProcessor extends CaseDataFieldProcessor {\n+\n+    private static final List<String> SUPPORTED_TYPES = Arrays.asList(DATETIME, DATE);\n+\n+    private final DateTimeFormatParser dateTimeFormatParser;\n+\n+    @Autowired\n+    public DateTimeEntryProcessor(CaseViewFieldBuilder caseViewFieldBuilder,\n+                                  DateTimeFormatParser dateTimeFormatParser) {\n+        super(caseViewFieldBuilder);\n+        this.dateTimeFormatParser = dateTimeFormatParser;\n+    }\n+\n+    @Override\n+    protected JsonNode executeSimple(JsonNode node, CommonField field, BaseType baseType, String fieldPath) {\n+        return !isNullOrEmpty(node)\n+            && hasDisplayContextParameterType(field.getDisplayContextParameter(), DisplayContextParameterType.DATETIMEENTRY)\n+            && isSupportedBaseType(baseType, SUPPORTED_TYPES) ?\n+            createNode(field.getDisplayContextParameter(), node.asText(), baseType, fieldPath) :\n+            node;\n+    }\n+\n+    @Override\n+    protected JsonNode executeCollection(JsonNode collectionNode, CommonField caseViewField, String fieldPath) {\n+        final BaseType collectionFieldType = BaseType.get(caseViewField.getFieldType().getCollectionFieldType().getType());\n+\n+        if (hasDisplayContextParameterType(caseViewField.getDisplayContextParameter(), DisplayContextParameterType.DATETIMEENTRY)\n+            && isSupportedBaseType(collectionFieldType, SUPPORTED_TYPES)) {\n+            ArrayNode newNode = MAPPER.createArrayNode();\n+            collectionNode.forEach(item -> {\n+                JsonNode newItem = item.deepCopy();\n+                ((ObjectNode)newItem).replace(CollectionValidator.VALUE,\n+                    createNode(caseViewField.getDisplayContextParameter(), item.get(CollectionValidator.VALUE).asText(), collectionFieldType, fieldPath));\n+                newNode.add(newItem);\n+            });\n+\n+            return newNode;\n+        }\n+\n+        return collectionNode;\n+    }\n+\n+    private TextNode createNode(String displayContextParameter, String valueToConvert, BaseType baseType, String fieldPath) {\n+        String format = getDisplayContextParameterOfType(displayContextParameter, DisplayContextParameterType.DATETIMEENTRY)\n+            .map(DisplayContextParameter::getValue)\n+            .orElse(\"\");", "originalCommit": "2f6395a3d45687530f40410c9c0c11700e339b3d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\nindex ef4b8c9e8..8fd86f40c 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n\n@@ -4,10 +4,12 @@ import com.fasterxml.jackson.databind.JsonNode;\n import com.fasterxml.jackson.databind.node.ArrayNode;\n import com.fasterxml.jackson.databind.node.ObjectNode;\n import com.fasterxml.jackson.databind.node.TextNode;\n+import com.google.common.base.Strings;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageComplexFieldOverride;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1Nzc5OA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394257798", "bodyText": "The same .* .", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T10:51:27Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.node.ArrayNode;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.fasterxml.jackson.databind.node.TextNode;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n+import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameter.*;\n+", "originalCommit": "2f6395a3d45687530f40410c9c0c11700e339b3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzkwNDM0Ng==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397904346", "bodyText": "done", "author": "smathangi", "createdAt": "2020-03-25T14:36:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1Nzc5OA=="}], "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\nindex ef4b8c9e8..8fd86f40c 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n\n@@ -4,10 +4,12 @@ import com.fasterxml.jackson.databind.JsonNode;\n import com.fasterxml.jackson.databind.node.ArrayNode;\n import com.fasterxml.jackson.databind.node.ObjectNode;\n import com.fasterxml.jackson.databind.node.TextNode;\n+import com.google.common.base.Strings;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageComplexFieldOverride;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1ODk0MA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394258940", "bodyText": "you can organise imports in inteliJ and add the option to  implicit add each import . It is very cosmetic but sometimes checkstyle tends to complaint about \" .* \" .", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T10:53:22Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java", "diffHunk": "@@ -0,0 +1,38 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.google.common.base.Strings;\n+\n+import java.util.*;\n+import java.util.regex.Matcher;", "originalCommit": "2f6395a3d45687530f40410c9c0c11700e339b3d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java\nindex c9b650a82..6181ee08e 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java\n\n@@ -28,7 +28,7 @@ public enum DisplayContextParameterType {\n         return Optional.empty();\n     }\n \n-    public static Optional<String> getParameterValueFor(String displayContextParameter) throws IllegalArgumentException {\n+    public static Optional<String> getParameterValueFor(String displayContextParameter) {\n         Matcher m = PATTERN.matcher(displayContextParameter);\n         if (m.matches() && !Strings.isNullOrEmpty(m.group(VALUE_GROUP))) {\n             return Optional.of(m.group(VALUE_GROUP));\n"}}, {"oid": "a775e2360f6dd74746700acb4662434a36836557", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a775e2360f6dd74746700acb4662434a36836557", "message": "Use Optional", "committedDate": "2020-03-18T12:16:07Z", "type": "commit"}, {"oid": "81dab26d46c14ae631706fa8ee83b5d711dacc68", "url": "https://github.com/hmcts/ccd-data-store-api/commit/81dab26d46c14ae631706fa8ee83b5d711dacc68", "message": "Merge branch 'RDM-7630' into RDM-7692", "committedDate": "2020-03-18T12:16:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQxNTU4NA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394415584", "bodyText": "protected boolean isNullOrEmpty(final JsonNode node)  is quite duplicated any. any places . We could create a util class .", "author": "Thor-tech-of-metal", "createdAt": "2020-03-18T15:03:59Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java", "diffHunk": "@@ -0,0 +1,91 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+\n+public abstract class FieldProcessor {\n+\n+    protected static final ObjectMapper MAPPER = new ObjectMapper();\n+    protected static final String FIELD_SEPARATOR = \".\";\n+\n+    private final CaseViewFieldBuilder caseViewFieldBuilder;\n+\n+    public FieldProcessor(CaseViewFieldBuilder caseViewFieldBuilder) {\n+        this.caseViewFieldBuilder = caseViewFieldBuilder;\n+    }\n+\n+    public JsonNode execute(JsonNode node, CaseField caseField, CaseEventField caseEventField, WizardPageField wizardPageField) {\n+        CaseViewField caseViewField = caseViewFieldBuilder.build(caseField, caseEventField);\n+\n+        if (!BaseType.contains(caseViewField.getFieldType().getType())) {\n+            return node;\n+        }\n+\n+        final BaseType fieldType = BaseType.get(caseViewField.getFieldType().getType());\n+\n+        if (BaseType.get(COMPLEX) == fieldType) {\n+            return executeComplex(node, caseField.getFieldType().getComplexFields(), caseEventField, wizardPageField, caseField.getId());\n+        } else if (BaseType.get(COLLECTION) == fieldType) {\n+            return executeCollection(node, caseViewField, caseField.getId());\n+        } else {\n+            return executeSimple(node, caseViewField, fieldType, caseField.getId());\n+        }\n+    }\n+\n+    protected JsonNode executeComplex(JsonNode complexNode,\n+                                      List<CaseField> complexCaseFields,\n+                                      CaseEventField caseEventField,\n+                                      WizardPageField wizardPageField,\n+                                      String fieldPrefix) {\n+        if (complexNode == null) {\n+            return null;\n+        }\n+        ObjectNode newNode = MAPPER.createObjectNode();\n+        complexCaseFields.stream().forEach(complexCaseField -> {\n+            final BaseType complexFieldType = BaseType.get(complexCaseField.getFieldType().getType());\n+            final String fieldId = complexCaseField.getId();\n+            final JsonNode caseFieldNode = complexNode.get(fieldId);\n+            final String fieldPath = fieldPrefix + FIELD_SEPARATOR + fieldId;\n+\n+            if (complexFieldType == BaseType.get(COLLECTION)) {\n+                newNode.set(fieldId, executeCollection(caseFieldNode, complexCaseField, fieldPath));\n+            } else if (complexFieldType == BaseType.get(COMPLEX)) {\n+                Optional.ofNullable(\n+                    executeComplex(caseFieldNode, complexCaseField.getFieldType().getComplexFields(), caseEventField, wizardPageField, fieldPath))\n+                    .ifPresent(result -> newNode.set(fieldId, result));\n+            } else {\n+                newNode.set(fieldId, executeSimple(caseFieldNode, complexCaseField, complexFieldType, fieldPath));\n+            }\n+        });\n+\n+        return newNode;\n+    }\n+\n+    protected abstract JsonNode executeSimple(JsonNode node, CommonField field, BaseType baseType, String fieldPath);\n+\n+    protected abstract JsonNode executeCollection(JsonNode collectionNode, CommonField field, String fieldPath);\n+\n+    protected boolean isNullOrEmpty(final JsonNode node) {", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\nindex f206c4b5e..5e51259d0 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n\n@@ -6,9 +6,7 @@ import com.fasterxml.jackson.databind.node.ObjectNode;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n-import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.model.definition.*;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n \n import java.util.List;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4MDU3Nw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394680577", "bodyText": "Better to throw the exception from this method. Rather than catching global Exception from the calling method.", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-18T22:41:17Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java", "diffHunk": "@@ -0,0 +1,59 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import java.time.LocalDate;\n+import java.time.LocalDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.time.format.DateTimeFormatterBuilder;\n+import java.time.format.DateTimeParseException;\n+import java.time.temporal.ChronoField;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class DateTimeFormatParser {\n+\n+    private static final Logger LOG = LoggerFactory.getLogger(DateTimeFormatParser.class);\n+\n+    private static final String DATE_TIME_FORMAT = \"yyyy-MM-dd'T'HH:mm:ss.SSS\";\n+    private static final String DATE_FORMAT = \"yyyy-MM-dd\";\n+\n+    public void parseDateTimeFormat(String dateTimeFormat, String value) throws Exception {\n+        try {\n+            DateTimeFormatter formatter = DateTimeFormatter.ofPattern(dateTimeFormat);\n+            formatter.parse(value);\n+        } catch (IllegalArgumentException | DateTimeParseException e) {\n+            LOG.error(\"Error occurred while parsing date time format \" + dateTimeFormat, e);\n+            throw new Exception(dateTimeFormat);\n+        }\n+    }\n+\n+    public String convertDateTimeToIso8601(String dateTimeFormat, String value) {\n+        DateTimeFormatter inputFormat = new DateTimeFormatterBuilder()\n+            .appendPattern(dateTimeFormat)\n+            .parseDefaulting(ChronoField.YEAR_OF_ERA, LocalDate.now().getYear())", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\nindex e92259e5b..e0ec4f3a8 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\n\n@@ -4,56 +4,74 @@ import java.time.LocalDate;\n import java.time.LocalDateTime;\n import java.time.format.DateTimeFormatter;\n import java.time.format.DateTimeFormatterBuilder;\n-import java.time.format.DateTimeParseException;\n-import java.time.temporal.ChronoField;\n+import java.time.temporal.*;\n \n-import org.slf4j.Logger;\n-import org.slf4j.LoggerFactory;\n+import lombok.extern.slf4j.Slf4j;\n+import org.joda.time.format.*;\n import org.springframework.stereotype.Component;\n \n @Component\n+@Slf4j\n public class DateTimeFormatParser {\n \n-    private static final Logger LOG = LoggerFactory.getLogger(DateTimeFormatParser.class);\n+    static final DateTimeFormatter DATE_TIME_FORMAT = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSS\");\n+    static final DateTimeFormatter DATE_TIME_FORMAT_MILLISECOND = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SS\");\n+    static final DateTimeFormatter DATE_FORMAT = DateTimeFormatter.ofPattern(\"yyyy-MM-dd\");\n+    private static final int DEFAULT_YEAR = 1970;\n \n-    private static final String DATE_TIME_FORMAT = \"yyyy-MM-dd'T'HH:mm:ss.SSS\";\n-    private static final String DATE_FORMAT = \"yyyy-MM-dd\";\n+    public String convertDateTimeToIso8601(String dateTimeFormat, String value) {\n+        LocalDateTime dateTime;\n+        try {\n+            DateTimeFormatter inputFormat = (dateTimeFormat == null) ? DATE_TIME_FORMAT : getDateTimeFormatter(dateTimeFormat);\n+            dateTime = LocalDateTime.parse(value, inputFormat);\n+        } catch (Exception e) {\n+            log.warn(\"Failed to parse following dateTime value {} with format {} attempting to parse with {}\", value, dateTimeFormat, DATE_TIME_FORMAT);\n+            dateTime = LocalDateTime.parse(value, DATE_TIME_FORMAT);\n+        }\n+        return dateTime.format(DATE_TIME_FORMAT);\n+    }\n \n-    public void parseDateTimeFormat(String dateTimeFormat, String value) throws Exception {\n+    public String convertDateToIso8601(String dateFormat, String value) {\n+        LocalDate date;\n         try {\n-            DateTimeFormatter formatter = DateTimeFormatter.ofPattern(dateTimeFormat);\n-            formatter.parse(value);\n-        } catch (IllegalArgumentException | DateTimeParseException e) {\n-            LOG.error(\"Error occurred while parsing date time format \" + dateTimeFormat, e);\n-            throw new Exception(dateTimeFormat);\n+            DateTimeFormatter inputFormat = (dateFormat == null) ? DATE_FORMAT : getDateFormatter(dateFormat);\n+            date = LocalDate.parse(value, inputFormat);\n+        } catch (Exception e) {\n+            log.warn(\"Failed to parse following date value {} with format {} attempting to parse with {}\", value, dateFormat, DATE_FORMAT);\n+            date = LocalDate.parse(value, DATE_FORMAT);\n         }\n+        return date.format(DATE_FORMAT);\n     }\n \n-    public String convertDateTimeToIso8601(String dateTimeFormat, String value) {\n-        DateTimeFormatter inputFormat = new DateTimeFormatterBuilder()\n+    public String convertIso8601ToDateTime(String dateTimeFormat, String value) {\n+        LocalDateTime dateTime = LocalDateTime.parse(value);\n+        return dateTime.format(DateTimeFormatter.ofPattern(dateTimeFormat));\n+    }\n+\n+    public String convertIso8601ToDate(String dateFormat, String value) {\n+        LocalDate date = LocalDate.parse(value, DATE_FORMAT);\n+        return date.format(DateTimeFormatter.ofPattern(dateFormat));\n+    }\n+\n+    private DateTimeFormatter getDateTimeFormatter(String dateTimeFormat) {\n+        return new DateTimeFormatterBuilder()\n             .appendPattern(dateTimeFormat)\n-            .parseDefaulting(ChronoField.YEAR_OF_ERA, LocalDate.now().getYear())\n-            .parseDefaulting(ChronoField.MONTH_OF_YEAR, LocalDate.now().getMonthValue())\n-            .parseDefaulting(ChronoField.DAY_OF_MONTH, LocalDate.now().getDayOfMonth())\n+            .parseDefaulting(ChronoField.YEAR_OF_ERA, DEFAULT_YEAR)\n+            .parseDefaulting(ChronoField.MONTH_OF_YEAR, 1)\n+            .parseDefaulting(ChronoField.DAY_OF_MONTH, 1)\n             .parseDefaulting(ChronoField.HOUR_OF_DAY, 0)\n             .parseDefaulting(ChronoField.MINUTE_OF_HOUR, 0)\n             .parseDefaulting(ChronoField.SECOND_OF_MINUTE, 0)\n             .parseDefaulting(ChronoField.MILLI_OF_SECOND, 0)\n             .toFormatter();\n-\n-        LocalDateTime dateTime = LocalDateTime.parse(value, inputFormat);\n-        return dateTime.format(DateTimeFormatter.ofPattern(DATE_TIME_FORMAT));\n     }\n \n-    public String convertDateToIso8601(String dateFormat, String value) {\n-        DateTimeFormatter inputFormat = new DateTimeFormatterBuilder()\n+    private DateTimeFormatter getDateFormatter(String dateFormat) {\n+        return new DateTimeFormatterBuilder()\n             .appendPattern(dateFormat)\n-            .parseDefaulting(ChronoField.YEAR_OF_ERA, LocalDate.now().getYear())\n-            .parseDefaulting(ChronoField.MONTH_OF_YEAR, LocalDate.now().getMonthValue())\n-            .parseDefaulting(ChronoField.DAY_OF_MONTH, LocalDate.now().getDayOfMonth())\n+            .parseDefaulting(ChronoField.YEAR_OF_ERA, DEFAULT_YEAR)\n+            .parseDefaulting(ChronoField.MONTH_OF_YEAR, 1)\n+            .parseDefaulting(ChronoField.DAY_OF_MONTH, 1)\n             .toFormatter();\n-\n-        LocalDate date = LocalDate.parse(value, inputFormat);\n-        return date.format(DateTimeFormatter.ofPattern(DATE_FORMAT));\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4MDYzMg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394680632", "bodyText": "Better to throw the exception from this method. Rather than catching global Exception from the calling method.", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-18T22:41:28Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java", "diffHunk": "@@ -0,0 +1,59 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import java.time.LocalDate;\n+import java.time.LocalDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.time.format.DateTimeFormatterBuilder;\n+import java.time.format.DateTimeParseException;\n+import java.time.temporal.ChronoField;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class DateTimeFormatParser {\n+\n+    private static final Logger LOG = LoggerFactory.getLogger(DateTimeFormatParser.class);\n+\n+    private static final String DATE_TIME_FORMAT = \"yyyy-MM-dd'T'HH:mm:ss.SSS\";\n+    private static final String DATE_FORMAT = \"yyyy-MM-dd\";\n+\n+    public void parseDateTimeFormat(String dateTimeFormat, String value) throws Exception {\n+        try {\n+            DateTimeFormatter formatter = DateTimeFormatter.ofPattern(dateTimeFormat);\n+            formatter.parse(value);\n+        } catch (IllegalArgumentException | DateTimeParseException e) {\n+            LOG.error(\"Error occurred while parsing date time format \" + dateTimeFormat, e);\n+            throw new Exception(dateTimeFormat);\n+        }\n+    }\n+\n+    public String convertDateTimeToIso8601(String dateTimeFormat, String value) {\n+        DateTimeFormatter inputFormat = new DateTimeFormatterBuilder()\n+            .appendPattern(dateTimeFormat)\n+            .parseDefaulting(ChronoField.YEAR_OF_ERA, LocalDate.now().getYear())\n+            .parseDefaulting(ChronoField.MONTH_OF_YEAR, LocalDate.now().getMonthValue())\n+            .parseDefaulting(ChronoField.DAY_OF_MONTH, LocalDate.now().getDayOfMonth())\n+            .parseDefaulting(ChronoField.HOUR_OF_DAY, 0)\n+            .parseDefaulting(ChronoField.MINUTE_OF_HOUR, 0)\n+            .parseDefaulting(ChronoField.SECOND_OF_MINUTE, 0)\n+            .parseDefaulting(ChronoField.MILLI_OF_SECOND, 0)\n+            .toFormatter();\n+\n+        LocalDateTime dateTime = LocalDateTime.parse(value, inputFormat);\n+        return dateTime.format(DateTimeFormatter.ofPattern(DATE_TIME_FORMAT));\n+    }\n+\n+    public String convertDateToIso8601(String dateFormat, String value) {\n+        DateTimeFormatter inputFormat = new DateTimeFormatterBuilder()\n+            .appendPattern(dateFormat)", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\nindex e92259e5b..e0ec4f3a8 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\n\n@@ -4,56 +4,74 @@ import java.time.LocalDate;\n import java.time.LocalDateTime;\n import java.time.format.DateTimeFormatter;\n import java.time.format.DateTimeFormatterBuilder;\n-import java.time.format.DateTimeParseException;\n-import java.time.temporal.ChronoField;\n+import java.time.temporal.*;\n \n-import org.slf4j.Logger;\n-import org.slf4j.LoggerFactory;\n+import lombok.extern.slf4j.Slf4j;\n+import org.joda.time.format.*;\n import org.springframework.stereotype.Component;\n \n @Component\n+@Slf4j\n public class DateTimeFormatParser {\n \n-    private static final Logger LOG = LoggerFactory.getLogger(DateTimeFormatParser.class);\n+    static final DateTimeFormatter DATE_TIME_FORMAT = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSS\");\n+    static final DateTimeFormatter DATE_TIME_FORMAT_MILLISECOND = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SS\");\n+    static final DateTimeFormatter DATE_FORMAT = DateTimeFormatter.ofPattern(\"yyyy-MM-dd\");\n+    private static final int DEFAULT_YEAR = 1970;\n \n-    private static final String DATE_TIME_FORMAT = \"yyyy-MM-dd'T'HH:mm:ss.SSS\";\n-    private static final String DATE_FORMAT = \"yyyy-MM-dd\";\n+    public String convertDateTimeToIso8601(String dateTimeFormat, String value) {\n+        LocalDateTime dateTime;\n+        try {\n+            DateTimeFormatter inputFormat = (dateTimeFormat == null) ? DATE_TIME_FORMAT : getDateTimeFormatter(dateTimeFormat);\n+            dateTime = LocalDateTime.parse(value, inputFormat);\n+        } catch (Exception e) {\n+            log.warn(\"Failed to parse following dateTime value {} with format {} attempting to parse with {}\", value, dateTimeFormat, DATE_TIME_FORMAT);\n+            dateTime = LocalDateTime.parse(value, DATE_TIME_FORMAT);\n+        }\n+        return dateTime.format(DATE_TIME_FORMAT);\n+    }\n \n-    public void parseDateTimeFormat(String dateTimeFormat, String value) throws Exception {\n+    public String convertDateToIso8601(String dateFormat, String value) {\n+        LocalDate date;\n         try {\n-            DateTimeFormatter formatter = DateTimeFormatter.ofPattern(dateTimeFormat);\n-            formatter.parse(value);\n-        } catch (IllegalArgumentException | DateTimeParseException e) {\n-            LOG.error(\"Error occurred while parsing date time format \" + dateTimeFormat, e);\n-            throw new Exception(dateTimeFormat);\n+            DateTimeFormatter inputFormat = (dateFormat == null) ? DATE_FORMAT : getDateFormatter(dateFormat);\n+            date = LocalDate.parse(value, inputFormat);\n+        } catch (Exception e) {\n+            log.warn(\"Failed to parse following date value {} with format {} attempting to parse with {}\", value, dateFormat, DATE_FORMAT);\n+            date = LocalDate.parse(value, DATE_FORMAT);\n         }\n+        return date.format(DATE_FORMAT);\n     }\n \n-    public String convertDateTimeToIso8601(String dateTimeFormat, String value) {\n-        DateTimeFormatter inputFormat = new DateTimeFormatterBuilder()\n+    public String convertIso8601ToDateTime(String dateTimeFormat, String value) {\n+        LocalDateTime dateTime = LocalDateTime.parse(value);\n+        return dateTime.format(DateTimeFormatter.ofPattern(dateTimeFormat));\n+    }\n+\n+    public String convertIso8601ToDate(String dateFormat, String value) {\n+        LocalDate date = LocalDate.parse(value, DATE_FORMAT);\n+        return date.format(DateTimeFormatter.ofPattern(dateFormat));\n+    }\n+\n+    private DateTimeFormatter getDateTimeFormatter(String dateTimeFormat) {\n+        return new DateTimeFormatterBuilder()\n             .appendPattern(dateTimeFormat)\n-            .parseDefaulting(ChronoField.YEAR_OF_ERA, LocalDate.now().getYear())\n-            .parseDefaulting(ChronoField.MONTH_OF_YEAR, LocalDate.now().getMonthValue())\n-            .parseDefaulting(ChronoField.DAY_OF_MONTH, LocalDate.now().getDayOfMonth())\n+            .parseDefaulting(ChronoField.YEAR_OF_ERA, DEFAULT_YEAR)\n+            .parseDefaulting(ChronoField.MONTH_OF_YEAR, 1)\n+            .parseDefaulting(ChronoField.DAY_OF_MONTH, 1)\n             .parseDefaulting(ChronoField.HOUR_OF_DAY, 0)\n             .parseDefaulting(ChronoField.MINUTE_OF_HOUR, 0)\n             .parseDefaulting(ChronoField.SECOND_OF_MINUTE, 0)\n             .parseDefaulting(ChronoField.MILLI_OF_SECOND, 0)\n             .toFormatter();\n-\n-        LocalDateTime dateTime = LocalDateTime.parse(value, inputFormat);\n-        return dateTime.format(DateTimeFormatter.ofPattern(DATE_TIME_FORMAT));\n     }\n \n-    public String convertDateToIso8601(String dateFormat, String value) {\n-        DateTimeFormatter inputFormat = new DateTimeFormatterBuilder()\n+    private DateTimeFormatter getDateFormatter(String dateFormat) {\n+        return new DateTimeFormatterBuilder()\n             .appendPattern(dateFormat)\n-            .parseDefaulting(ChronoField.YEAR_OF_ERA, LocalDate.now().getYear())\n-            .parseDefaulting(ChronoField.MONTH_OF_YEAR, LocalDate.now().getMonthValue())\n-            .parseDefaulting(ChronoField.DAY_OF_MONTH, LocalDate.now().getDayOfMonth())\n+            .parseDefaulting(ChronoField.YEAR_OF_ERA, DEFAULT_YEAR)\n+            .parseDefaulting(ChronoField.MONTH_OF_YEAR, 1)\n+            .parseDefaulting(ChronoField.DAY_OF_MONTH, 1)\n             .toFormatter();\n-\n-        LocalDate date = LocalDate.parse(value, inputFormat);\n-        return date.format(DateTimeFormatter.ofPattern(DATE_FORMAT));\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4MjIwOQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394682209", "bodyText": "Do we really need to throw IllegalArgumentException here? as it is RuntimeException, if you want to customise the behaviour on exception. Handle that here itself", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-18T22:46:16Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java", "diffHunk": "@@ -0,0 +1,38 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.google.common.base.Strings;\n+\n+import java.util.*;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+public enum DisplayContextParameterType {\n+    DATETIMEENTRY,\n+    DATETIMEDISPLAY,\n+    TABLE,\n+    LIST;\n+\n+    private static final Pattern PATTERN = Pattern.compile(\"#(.+)\\\\((.+)\\\\)\");\n+    private static final int TYPE_GROUP = 1;\n+    private static final int VALUE_GROUP = 2;\n+\n+    public static Optional<DisplayContextParameterType> getParameterTypeFor(String displayContextParameter) {\n+        Matcher m = PATTERN.matcher(displayContextParameter);\n+        if (m.matches()) {\n+            try {\n+                return Optional.of(valueOf(m.group(TYPE_GROUP)));\n+            } catch (IllegalArgumentException e) {\n+                return Optional.empty();\n+            }\n+        }\n+        return Optional.empty();\n+    }\n+\n+    public static Optional<String> getParameterValueFor(String displayContextParameter) throws IllegalArgumentException {", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java\nindex c9b650a82..6181ee08e 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java\n\n@@ -28,7 +28,7 @@ public enum DisplayContextParameterType {\n         return Optional.empty();\n     }\n \n-    public static Optional<String> getParameterValueFor(String displayContextParameter) throws IllegalArgumentException {\n+    public static Optional<String> getParameterValueFor(String displayContextParameter) {\n         Matcher m = PATTERN.matcher(displayContextParameter);\n         if (m.matches() && !Strings.isNullOrEmpty(m.group(VALUE_GROUP))) {\n             return Optional.of(m.group(VALUE_GROUP));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4NjU3MA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394686570", "bodyText": "Can we use this option to rename this class to something meaningful. Better to move all constants to enum.\nName is misleading.. This class has more functionality than simple Type class.", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-18T22:58:49Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/FieldType.java", "diffHunk": "@@ -26,6 +26,8 @@\n     public static final String PREDEFINED_COMPLEX_ADDRESS_UK = \"AddressUK\";\n     public static final String PREDEFINED_COMPLEX_ORDER_SUMMARY = \"OrderSummary\";\n     public static final String PREDEFINED_COMPLEX_CASELINK = \"CaseLink\";\n+    public static final String DATETIME = \"DateTime\";", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzkwMjYwOA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397902608", "bodyText": "Agree. But that'll be an improvement on existing code - nothing specific to this PR changes.", "author": "smathangi", "createdAt": "2020-03-25T14:34:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4NjU3MA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4Nzc3Mw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394687773", "bodyText": "instead of defining the displayContextParameter in each class, Can we create an AbstractDisplayContextParamterField and extend that class?", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-18T23:02:24Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/SearchResultField.java", "diffHunk": "@@ -98,4 +100,12 @@ public String buildCaseFieldId() {\n         }\n         return getCaseFieldId();\n     }\n+\n+    public String getDisplayContextParameter() {", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY4NDQzNw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r395684437", "bodyText": "Another potential improvement ticket maybe? There are various fields which are on different models (DCP being one of them) so this kind of idea could apply to a number of fields. Naturally abstract wouldn't work in that case but I get the general point!", "author": "danlysiak", "createdAt": "2020-03-20T14:45:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4Nzc3Mw=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4OTE0Ng==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394689146", "bodyText": "Do we need CaseDataFieldProcessor class? instead we can extend directly from FieldProcessor class.\nCaseDataFieldProcessor has no specific logic implemented...", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-18T23:06:33Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.node.ArrayNode;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.fasterxml.jackson.databind.node.TextNode;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n+import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameter.*;\n+\n+@Component\n+public class DateTimeEntryProcessor extends CaseDataFieldProcessor {", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY4MTc5NA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r395681794", "bodyText": "This is to cater for the next PR #851 where there are two different types of FieldProcessor (CaseDataFieldProcessor being one of them).", "author": "danlysiak", "createdAt": "2020-03-20T14:41:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4OTE0Ng=="}], "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\nindex ef4b8c9e8..8fd86f40c 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n\n@@ -4,10 +4,12 @@ import com.fasterxml.jackson.databind.JsonNode;\n import com.fasterxml.jackson.databind.node.ArrayNode;\n import com.fasterxml.jackson.databind.node.ObjectNode;\n import com.fasterxml.jackson.databind.node.TextNode;\n+import com.google.common.base.Strings;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageComplexFieldOverride;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk1MTU2OQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394951569", "bodyText": "isNullOrEmpty check is already done in getDisplayContextParameterOfType. No need to call this again here.", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-19T11:14:53Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java", "diffHunk": "@@ -0,0 +1,63 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.google.common.base.Strings;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Optional;\n+\n+import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameterType.getParameterTypeFor;\n+import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameterType.getParameterValueFor;\n+\n+public class DisplayContextParameter {\n+\n+    private DisplayContextParameterType type;\n+\n+    private String value;\n+\n+    public DisplayContextParameter(DisplayContextParameterType type, String value) {\n+        this.type = type;\n+        this.value = value;\n+    }\n+\n+    public DisplayContextParameterType getType() {\n+        return type;\n+    }\n+\n+    public String getValue() {\n+        return value;\n+    }\n+\n+    public static List<DisplayContextParameter> getDisplayContextParameterFor(String displayContextParameter) {\n+        List<DisplayContextParameter> displayContextParameterTypeList = new ArrayList<>();\n+\n+        String[] displayContextParameters = displayContextParameter.split(\",\");\n+        for (String s : displayContextParameters) {\n+            Optional<DisplayContextParameterType> type = getParameterTypeFor(s);\n+            Optional<String> value = getParameterValueFor(s);\n+\n+            if (!type.isPresent() || !value.isPresent()) {\n+                displayContextParameterTypeList.add(new DisplayContextParameter(null, null));\n+            } else {\n+                displayContextParameterTypeList.add(new DisplayContextParameter(type.get(), value.get()));\n+            }\n+\n+        }\n+        return displayContextParameterTypeList;\n+    }\n+\n+    public static Optional<DisplayContextParameter> getDisplayContextParameterOfType(String displayContextParameter,\n+                                                                                     DisplayContextParameterType type) {\n+        return Strings.isNullOrEmpty(displayContextParameter) ?\n+            Optional.empty() :\n+            getDisplayContextParameterFor(displayContextParameter).stream()\n+                .filter(param -> param.getType() == type)\n+                .findAny();\n+    }\n+\n+    public static boolean hasDisplayContextParameterType(String displayContextParameter, DisplayContextParameterType type) {\n+        return !Strings.isNullOrEmpty(displayContextParameter) &&", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java\nindex 9de8a4e24..aa2a94c32 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java\n\n@@ -1,16 +1,17 @@\n package uk.gov.hmcts.ccd.domain.service.processor;\n \n import com.google.common.base.Strings;\n+import com.hazelcast.util.*;\n \n-import java.util.ArrayList;\n-import java.util.List;\n-import java.util.Optional;\n+import java.util.*;\n \n import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameterType.getParameterTypeFor;\n import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameterType.getParameterValueFor;\n \n public class DisplayContextParameter {\n \n+    private static String MULTIPLE_PARAMETERS_STRING = \"),\";\n+\n     private DisplayContextParameterType type;\n \n     private String value;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk2NjE1NA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394966154", "bodyText": "we can make this method private. as this call either executeCollection or executeSimple only.", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-19T11:43:02Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java", "diffHunk": "@@ -0,0 +1,91 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+\n+public abstract class FieldProcessor {\n+\n+    protected static final ObjectMapper MAPPER = new ObjectMapper();\n+    protected static final String FIELD_SEPARATOR = \".\";\n+\n+    private final CaseViewFieldBuilder caseViewFieldBuilder;\n+\n+    public FieldProcessor(CaseViewFieldBuilder caseViewFieldBuilder) {\n+        this.caseViewFieldBuilder = caseViewFieldBuilder;\n+    }\n+\n+    public JsonNode execute(JsonNode node, CaseField caseField, CaseEventField caseEventField, WizardPageField wizardPageField) {\n+        CaseViewField caseViewField = caseViewFieldBuilder.build(caseField, caseEventField);\n+\n+        if (!BaseType.contains(caseViewField.getFieldType().getType())) {\n+            return node;\n+        }\n+\n+        final BaseType fieldType = BaseType.get(caseViewField.getFieldType().getType());\n+\n+        if (BaseType.get(COMPLEX) == fieldType) {\n+            return executeComplex(node, caseField.getFieldType().getComplexFields(), caseEventField, wizardPageField, caseField.getId());\n+        } else if (BaseType.get(COLLECTION) == fieldType) {\n+            return executeCollection(node, caseViewField, caseField.getId());\n+        } else {\n+            return executeSimple(node, caseViewField, fieldType, caseField.getId());\n+        }\n+    }\n+\n+    protected JsonNode executeComplex(JsonNode complexNode,", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\nindex f206c4b5e..5e51259d0 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n\n@@ -6,9 +6,7 @@ import com.fasterxml.jackson.databind.node.ObjectNode;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n-import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.model.definition.*;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n \n import java.util.List;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk2OTQ4MQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394969481", "bodyText": "Why we need to call with 'null'. Default value is 'null. anyway.", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-19T11:49:38Z", "path": "src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java", "diffHunk": "@@ -161,6 +161,7 @@ void shouldHydrateCaseHistoryViewerIfFieldPresentInTabs() {\n                                                                                                                            .withType(\n                                                                                                                                CASE_HISTORY_VIEWER)\n                                                                                                                            .build())\n+                                                                                                        .withDisplayContextParameter(null)", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java b/src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java\nindex 660aac09a..72a1bc264 100644\n--- a/src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java\n+++ b/src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java\n\n@@ -161,7 +167,6 @@ class DefaultGetCaseViewOperationTest {\n                                                                                                                            .withType(\n                                                                                                                                CASE_HISTORY_VIEWER)\n                                                                                                                            .build())\n-                                                                                                        .withDisplayContextParameter(null)\n                                                                                                         .build())\n                                                                                      .build())\n                                                                    .build())\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk2OTUxOA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394969518", "bodyText": "Why we need to call with 'null'. Default value is 'null. anyway.", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-19T11:49:43Z", "path": "src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java", "diffHunk": "@@ -194,6 +195,7 @@ void shouldNotHydrateCaseHistoryViewerIfFieldIsNotPresentInTabs() {\n                                                                                                                            .withType(\n                                                                                                                                \"NotACaseHistoryViewer\")\n                                                                                                                            .build())\n+                                                                                                        .withDisplayContextParameter(null)", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java b/src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java\nindex 660aac09a..72a1bc264 100644\n--- a/src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java\n+++ b/src/test/java/uk/gov/hmcts/ccd/domain/service/aggregated/DefaultGetCaseViewOperationTest.java\n\n@@ -195,7 +200,6 @@ class DefaultGetCaseViewOperationTest {\n                                                                                                                            .withType(\n                                                                                                                                \"NotACaseHistoryViewer\")\n                                                                                                                            .build())\n-                                                                                                        .withDisplayContextParameter(null)\n                                                                                                         .build())\n                                                                                      .build())\n                                                                    .build())\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk3MDQ1NQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394970455", "bodyText": "Why we need to call with 'null'. Default value is 'null. anyway.", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-19T11:51:44Z", "path": "src/test/java/uk/gov/hmcts/ccd/domain/service/common/TestBuildersUtil.java", "diffHunk": "@@ -1432,6 +1442,7 @@ private CaseTypeTabBuilder() {\n             this.caseTypeTabFields = newArrayList();\n             this.caseTypeTab = new CaseTypeTab();\n             this.caseTypeTab.setTabFields(caseTypeTabFields);\n+            this.caseTypeTab.setDisplayContextParameter(null);", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/test/java/uk/gov/hmcts/ccd/domain/service/common/TestBuildersUtil.java b/src/test/java/uk/gov/hmcts/ccd/domain/service/common/TestBuildersUtil.java\nindex 5e87b3eb2..935a160c8 100644\n--- a/src/test/java/uk/gov/hmcts/ccd/domain/service/common/TestBuildersUtil.java\n+++ b/src/test/java/uk/gov/hmcts/ccd/domain/service/common/TestBuildersUtil.java\n\n@@ -1442,7 +1468,6 @@ public class TestBuildersUtil {\n             this.caseTypeTabFields = newArrayList();\n             this.caseTypeTab = new CaseTypeTab();\n             this.caseTypeTab.setTabFields(caseTypeTabFields);\n-            this.caseTypeTab.setDisplayContextParameter(null);\n         }\n \n         public CaseTypeTabBuilder withTabField(CaseTypeTabField field) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk3NDgxOA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r394974818", "bodyText": "Please add test cases for convertDateToIso8601 and some failure cases as well for the below exceptions\nIllegalArgumentException and DateTimeParseException", "author": "kiran-yenigala-hmcts", "createdAt": "2020-03-19T12:00:38Z", "path": "src/test/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParserTest.java", "diffHunk": "@@ -0,0 +1,30 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.*;\n+import static org.junit.jupiter.api.Assertions.assertAll;\n+\n+class DateTimeFormatParserTest {\n+\n+    private DateTimeFormatParser dateTimeFormatParser;\n+\n+    @BeforeEach\n+    void setUp() {\n+        dateTimeFormatParser = new DateTimeFormatParser();\n+    }\n+\n+    @Test\n+    void shouldConvertDateTimeToIso8601() {\n+        final String dateTimeFormat = \"HHmmssSSS dd/MM/yyyy\";\n+        final String value = \"123059000 20/10/2000\";\n+\n+        final String result = dateTimeFormatParser.convertDateTimeToIso8601(dateTimeFormat, value);\n+\n+        assertAll(\n+            () -> assertThat(result, is(\"2000-10-20T12:30:59.000\"))\n+        );\n+    }", "originalCommit": "a775e2360f6dd74746700acb4662434a36836557", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/test/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParserTest.java b/src/test/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParserTest.java\nindex 52751be8a..d3a32ede0 100644\n--- a/src/test/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParserTest.java\n+++ b/src/test/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParserTest.java\n\n@@ -17,14 +17,207 @@ class DateTimeFormatParserTest {\n     }\n \n     @Test\n-    void shouldConvertDateTimeToIso8601() {\n+    void shouldConvertDateTimeToIso8601Format() {\n         final String dateTimeFormat = \"HHmmssSSS dd/MM/yyyy\";\n         final String value = \"123059000 20/10/2000\";\n+        final String result = dateTimeFormatParser.convertDateTimeToIso8601(dateTimeFormat, value);\n+        assertAll(\n+            () -> assertThat(result, is(\"2000-10-20T12:30:59.000\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertDateToIso8601() {\n+        final String dateTimeFormat = \"dd/MM/yyyy\";\n+        final String value = \"20/10/2000\";\n+\n+        final String result = dateTimeFormatParser.convertDateToIso8601(dateTimeFormat, value);\n+    }\n+\n+    @Test\n+    void shouldConvertDateToIso8601Format() {\n+        final String dateTimeFormat = \"dd/MM/yyyy\";\n+        final String value = \"20/10/2000\";\n+        final String result = dateTimeFormatParser.convertDateToIso8601(dateTimeFormat, value);\n+        assertAll(\n+            () -> assertThat(result, is(\"2000-10-20\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertIso8601ToDateTimeFormat1() {\n+        final String dateTimeFormat = \"dd/MM/yyyy HH-mm-ss\";\n+        final String value = \"2000-10-20T12:30:59.000\";\n+\n+        final String result = dateTimeFormatParser.convertIso8601ToDateTime(dateTimeFormat, value);\n+\n+        assertAll(\n+            () -> assertThat(result, is(\"20/10/2000 12-30-59\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertIso8601ToDateTimeFormat2() {\n+        final String dateTimeFormat = \"dd MMM yy H:mm a\";\n+        final String value = \"2000-10-20T12:30:59.000\";\n+\n+        final String result = dateTimeFormatParser.convertIso8601ToDateTime(dateTimeFormat, value);\n+\n+        assertAll(\n+            () -> assertThat(result, is(\"20 Oct 00 12:30 PM\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertIso8601ToDateTimeFormat3() {\n+        final String dateTimeFormat = \"dd/MM/yyyy HH-mm-ss-SSS\";\n+        final String value = \"2000-10-20T12:30\";\n+\n+        final String result = dateTimeFormatParser.convertIso8601ToDateTime(dateTimeFormat, value);\n+\n+        assertAll(\n+            () -> assertThat(result, is(\"20/10/2000 12-30-00-000\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertIso8601ToDateTimeFormat4() {\n+        final String dateTimeFormat = \"dd/MM/yyyy HH-mm-ss-SSS\";\n+        final String value = \"2000-10-20T12:30:00\";\n+\n+        final String result = dateTimeFormatParser.convertIso8601ToDateTime(dateTimeFormat, value);\n+\n+        assertAll(\n+            () -> assertThat(result, is(\"20/10/2000 12-30-00-000\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertIso8601ToDateTimeFormat5() {\n+        final String dateTimeFormat = \"dd/MM/yyyy HH-mm-ss-SSS\";\n+        final String value = \"2012-04-21T00:00:00.5\";\n+\n+        final String result = dateTimeFormatParser.convertIso8601ToDateTime(dateTimeFormat, value);\n+\n+        assertAll(\n+            () -> assertThat(result, is(\"21/04/2012 00-00-00-500\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertIso8601ToDateTimeFormat6() {\n+        final String dateTimeFormat = \"dd/MM/yyyy HH-mm-ss-SSS\";\n+        final String value = \"2012-04-21T00:00:30.01\";\n+\n+        final String result = dateTimeFormatParser.convertIso8601ToDateTime(dateTimeFormat, value);\n+\n+        assertAll(\n+            () -> assertThat(result, is(\"21/04/2012 00-00-30-010\"))\n+        );\n+    }\n \n+\n+    @Test\n+    void shouldConvertIso8601ToDateFormat1() {\n+        final String dateTimeFormat = \"dd/MM/yyyy\";\n+        final String value = \"2000-10-20\";\n+\n+        final String result = dateTimeFormatParser.convertIso8601ToDate(dateTimeFormat, value);\n+\n+        assertAll(\n+            () -> assertThat(result, is(\"20/10/2000\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertIso8601ToDateFormat2() {\n+        final String dateTimeFormat = \"MMM d yy\";\n+        final String value = \"2010-10-09\";\n+\n+        final String result = dateTimeFormatParser.convertIso8601ToDate(dateTimeFormat, value);\n+\n+        assertAll(\n+            () -> assertThat(result, is(\"Oct 9 10\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldDefaultMonthAndDayTo1WhenNotProvidedInDateFormat() {\n+        final String dateTimeFormat = \"yyyy\";\n+        final String value = \"2000\";\n+        final String result = dateTimeFormatParser.convertDateToIso8601(dateTimeFormat, value);\n+        assertAll(\n+            () -> assertThat(result, is(\"2000-01-01\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldDefaultMonthAndDayTo1WhenNotProvidedInDateTimeFormat() {\n+        final String dateTimeFormat = \"yyyy\";\n+        final String value = \"2000\";\n         final String result = dateTimeFormatParser.convertDateTimeToIso8601(dateTimeFormat, value);\n+        assertAll(\n+            () -> assertThat(result, is(\"2000-01-01T00:00:00.000\"))\n+        );\n+    }\n \n+    @Test\n+    void shouldDefaultYearWhenNotProvidedInDateFormat() {\n+        final String dateTimeFormat = \"MM\";\n+        final String value = \"12\";\n+        final String result = dateTimeFormatParser.convertDateToIso8601(dateTimeFormat, value);\n+        assertAll(\n+            () -> assertThat(result, is(\"1970-12-01\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldDefaultYearWhenNotProvidedInDateTimeFormat() {\n+        final String dateTimeFormat = \"MM\";\n+        final String value = \"12\";\n+        final String result = dateTimeFormatParser.convertDateTimeToIso8601(dateTimeFormat, value);\n+        assertAll(\n+            () -> assertThat(result, is(\"1970-12-01T00:00:00.000\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertDateTimeToIso8601FormatNullDisplayContextParameter() {\n+        final String dateTimeFormat = null;\n+        final String value = \"2000-10-20T12:30:59.000\";\n+        final String result = dateTimeFormatParser.convertDateTimeToIso8601(dateTimeFormat, value);\n         assertAll(\n             () -> assertThat(result, is(\"2000-10-20T12:30:59.000\"))\n         );\n     }\n+\n+    @Test\n+    void shouldConvertDateTimeToIso8601FormatIncorrectDisplayContextParameter() {\n+        final String dateTimeFormat = \"HHmmssSSS dd/MM/yyyy\";\n+        final String value = \"2000-10-20T12:30:59.000\";\n+        final String result = dateTimeFormatParser.convertDateTimeToIso8601(dateTimeFormat, value);\n+        assertAll(\n+            () -> assertThat(result, is(\"2000-10-20T12:30:59.000\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertDateToIso8601FormatNullDisplayContextParameter() {\n+        final String dateTimeFormat = null;\n+        final String value = \"2000-10-20\";\n+        final String result = dateTimeFormatParser.convertDateToIso8601(dateTimeFormat, value);\n+        assertAll(\n+            () -> assertThat(result, is(\"2000-10-20\"))\n+        );\n+    }\n+\n+    @Test\n+    void shouldConvertDateToIso8601FormatIncorrectDisplayContextParameter() {\n+        final String dateTimeFormat = \"dd/MM/yyyy\";\n+        final String value = \"2000-10-20\";\n+        final String result = dateTimeFormatParser.convertDateToIso8601(dateTimeFormat, value);\n+        assertAll(\n+            () -> assertThat(result, is(\"2000-10-20\"))\n+        );\n+    }\n }\n"}}, {"oid": "c36866b5b2485925b25e2d9b50e18c6a116d7fe7", "url": "https://github.com/hmcts/ccd-data-store-api/commit/c36866b5b2485925b25e2d9b50e18c6a116d7fe7", "message": "Support for complex type overrides; rename to formatted_value", "committedDate": "2020-03-20T09:33:45Z", "type": "commit"}, {"oid": "5400186a1b506d62dd02859850cf063ac53cf350", "url": "https://github.com/hmcts/ccd-data-store-api/commit/5400186a1b506d62dd02859850cf063ac53cf350", "message": "DateTimeFormatParserTest", "committedDate": "2020-03-20T17:54:23Z", "type": "commit"}, {"oid": "74d37003a74c8d8b6ad6063688b8d2255047f707", "url": "https://github.com/hmcts/ccd-data-store-api/commit/74d37003a74c8d8b6ad6063688b8d2255047f707", "message": "Merge remote-tracking branch 'origin/RDM-7692' into RDM-7692", "committedDate": "2020-03-20T17:54:45Z", "type": "commit"}, {"oid": "6c92dacfea4f55e13046b21504c32073fbda136a", "url": "https://github.com/hmcts/ccd-data-store-api/commit/6c92dacfea4f55e13046b21504c32073fbda136a", "message": "Merge branch 'RDM-7575-DateTime-Formatting' into RDM-7630", "committedDate": "2020-03-22T15:14:27Z", "type": "commit"}, {"oid": "ed5bc5d03506d66331469da5ac87a9928cd38036", "url": "https://github.com/hmcts/ccd-data-store-api/commit/ed5bc5d03506d66331469da5ac87a9928cd38036", "message": "Some review comments", "committedDate": "2020-03-22T15:27:05Z", "type": "commit"}, {"oid": "a821060c503e267e4e136e933a3dd7990b75e76c", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a821060c503e267e4e136e933a3dd7990b75e76c", "message": "Merge branch 'RDM-7630' into RDM-7692", "committedDate": "2020-03-22T15:36:21Z", "type": "commit"}, {"oid": "c0612b3e41728e1b153e3641026b44854b1e96a5", "url": "https://github.com/hmcts/ccd-data-store-api/commit/c0612b3e41728e1b153e3641026b44854b1e96a5", "message": "Unit tests and minor refactoring", "committedDate": "2020-03-22T22:31:21Z", "type": "commit"}, {"oid": "8e8f6cb84763a0137ddc1f67375f925406b31646", "url": "https://github.com/hmcts/ccd-data-store-api/commit/8e8f6cb84763a0137ddc1f67375f925406b31646", "message": "Update FT data", "committedDate": "2020-03-22T23:39:10Z", "type": "commit"}, {"oid": "175a662112b2cdcc5ba99435df0e9a8952530b46", "url": "https://github.com/hmcts/ccd-data-store-api/commit/175a662112b2cdcc5ba99435df0e9a8952530b46", "message": "RDM-7694 - DCP for workbasket and search input/results", "committedDate": "2020-03-23T08:41:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjI5MjQxNA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396292414", "bodyText": "minor:\nconsider introducing a builder for CaseEventFieldComplex rather than telescoping constructors:\nhttps://www.vojtechruzicka.com/avoid-telescoping-constructor-pattern/", "author": "mario-paniccia", "createdAt": "2020-03-23T08:53:40Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseEventFieldComplex.java", "diffHunk": "@@ -11,15 +11,25 @@\n \n     private Integer order;\n \n+    private String displayContextParameter;\n+\n     public CaseEventFieldComplex() {\n     }\n \n     public CaseEventFieldComplex(String reference,\n-                                 Integer order) {\n+                                  Integer order) {\n         this.reference = reference;\n         this.order = order;\n     }\n \n+    public CaseEventFieldComplex(String reference,", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM3MTk2OA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396371968", "bodyText": "can we use\ncaseField.isCollectionFieldType()\ncaseField.isComplexFieldType()\n?", "author": "mario-paniccia", "createdAt": "2020-03-23T11:09:07Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java", "diffHunk": "@@ -0,0 +1,91 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+\n+public abstract class FieldProcessor {\n+\n+    protected static final ObjectMapper MAPPER = new ObjectMapper();\n+    protected static final String FIELD_SEPARATOR = \".\";\n+\n+    private final CaseViewFieldBuilder caseViewFieldBuilder;\n+\n+    public FieldProcessor(CaseViewFieldBuilder caseViewFieldBuilder) {\n+        this.caseViewFieldBuilder = caseViewFieldBuilder;\n+    }\n+\n+    public JsonNode execute(JsonNode node, CaseField caseField, CaseEventField caseEventField, WizardPageField wizardPageField) {\n+        CaseViewField caseViewField = caseViewFieldBuilder.build(caseField, caseEventField);\n+\n+        if (!BaseType.contains(caseViewField.getFieldType().getType())) {\n+            return node;\n+        }\n+\n+        final BaseType fieldType = BaseType.get(caseViewField.getFieldType().getType());\n+\n+        if (BaseType.get(COMPLEX) == fieldType) {\n+            return executeComplex(node, caseField.getFieldType().getComplexFields(), caseEventField, wizardPageField, caseField.getId());\n+        } else if (BaseType.get(COLLECTION) == fieldType) {\n+            return executeCollection(node, caseViewField, caseField.getId());\n+        } else {\n+            return executeSimple(node, caseViewField, fieldType, caseField.getId());\n+        }", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\nindex bbcd89832..5e51259d0 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n\n@@ -6,9 +6,7 @@ import com.fasterxml.jackson.databind.node.ObjectNode;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n-import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.model.definition.*;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n \n import java.util.List;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM5NDA0Mw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396394043", "bodyText": "To improve code readability it is essential to introduce utility methods to the domain classes whenever possible.\nhasDisplayContextParameterType could be removed. We could introduce a method in DisplayContextParameter class that allows to check the type of a DCP. For example:\ndisplayContextParameter.hasType(DisplayContextParameterType.DATETIMEENTRY)\nThen we could add a method to CommonField that returns the display context parameter as an instance of DisplayContextParameter other than a String.\nIf we do that this will simplify in:\nfield.getDisplayContextParameter.hasType(DisplayContextParameterType.DATETIMEENTRY)\nThis is much more reusable and readable", "author": "mario-paniccia", "createdAt": "2020-03-23T11:50:42Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java", "diffHunk": "@@ -0,0 +1,87 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.node.ArrayNode;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.fasterxml.jackson.databind.node.TextNode;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n+import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameter.*;\n+\n+@Component\n+public class DateTimeEntryProcessor extends CaseDataFieldProcessor {\n+\n+    private static final List<String> SUPPORTED_TYPES = Arrays.asList(DATETIME, DATE);\n+\n+    private final DateTimeFormatParser dateTimeFormatParser;\n+\n+    @Autowired\n+    public DateTimeEntryProcessor(CaseViewFieldBuilder caseViewFieldBuilder,\n+                                  DateTimeFormatParser dateTimeFormatParser) {\n+        super(caseViewFieldBuilder);\n+        this.dateTimeFormatParser = dateTimeFormatParser;\n+    }\n+\n+    @Override\n+    protected JsonNode executeSimple(JsonNode node, CommonField field, BaseType baseType, String fieldPath) {\n+        return !isNullOrEmpty(node)\n+            && hasDisplayContextParameterType(field.getDisplayContextParameter(), DisplayContextParameterType.DATETIMEENTRY)", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\nindex b74d7762a..8fd86f40c 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n\n@@ -4,10 +4,12 @@ import com.fasterxml.jackson.databind.JsonNode;\n import com.fasterxml.jackson.databind.node.ArrayNode;\n import com.fasterxml.jackson.databind.node.ObjectNode;\n import com.fasterxml.jackson.databind.node.TextNode;\n+import com.google.common.base.Strings;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageComplexFieldOverride;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQzMDY4NA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396430684", "bodyText": "getDisplayContextParameterOfType(displayContextParameter, DisplayContextParameterType.DATETIMEENTRY)\nI think the code would be simpler if CommonField had the diplay context parameter already converted into a list of DisplayContextParameter rather than a raw String. Same as it has a List<AccessControlList>.\nIf that was the case, then CommonField could have a method getDisplayContextParameterOfType(DisplayContextParameterType.DATETIMEENTRY)", "author": "mario-paniccia", "createdAt": "2020-03-23T12:58:26Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java", "diffHunk": "@@ -0,0 +1,87 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.node.ArrayNode;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.fasterxml.jackson.databind.node.TextNode;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n+import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameter.*;\n+\n+@Component\n+public class DateTimeEntryProcessor extends CaseDataFieldProcessor {\n+\n+    private static final List<String> SUPPORTED_TYPES = Arrays.asList(DATETIME, DATE);\n+\n+    private final DateTimeFormatParser dateTimeFormatParser;\n+\n+    @Autowired\n+    public DateTimeEntryProcessor(CaseViewFieldBuilder caseViewFieldBuilder,\n+                                  DateTimeFormatParser dateTimeFormatParser) {\n+        super(caseViewFieldBuilder);\n+        this.dateTimeFormatParser = dateTimeFormatParser;\n+    }\n+\n+    @Override\n+    protected JsonNode executeSimple(JsonNode node, CommonField field, BaseType baseType, String fieldPath) {\n+        return !isNullOrEmpty(node)\n+            && hasDisplayContextParameterType(field.getDisplayContextParameter(), DisplayContextParameterType.DATETIMEENTRY)\n+            && isSupportedBaseType(baseType, SUPPORTED_TYPES) ?\n+            createNode(field.getDisplayContextParameter(), node.asText(), baseType, fieldPath) :\n+            node;\n+    }\n+\n+    @Override\n+    protected JsonNode executeCollection(JsonNode collectionNode, CommonField caseViewField, String fieldPath) {\n+        final BaseType collectionFieldType = BaseType.get(caseViewField.getFieldType().getCollectionFieldType().getType());\n+\n+        if (hasDisplayContextParameterType(caseViewField.getDisplayContextParameter(), DisplayContextParameterType.DATETIMEENTRY)\n+            && isSupportedBaseType(collectionFieldType, SUPPORTED_TYPES)) {\n+            ArrayNode newNode = MAPPER.createArrayNode();\n+            collectionNode.forEach(item -> {\n+                JsonNode newItem = item.deepCopy();\n+                ((ObjectNode)newItem).replace(CollectionValidator.VALUE,\n+                    createNode(caseViewField.getDisplayContextParameter(), item.get(CollectionValidator.VALUE).asText(), collectionFieldType, fieldPath));\n+                newNode.add(newItem);\n+            });\n+\n+            return newNode;\n+        }\n+\n+        return collectionNode;\n+    }\n+\n+    private TextNode createNode(String displayContextParameter, String valueToConvert, BaseType baseType, String fieldPath) {\n+        String format = getDisplayContextParameterOfType(displayContextParameter, DisplayContextParameterType.DATETIMEENTRY)", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\nindex b74d7762a..8fd86f40c 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n\n@@ -4,10 +4,12 @@ import com.fasterxml.jackson.databind.JsonNode;\n import com.fasterxml.jackson.databind.node.ArrayNode;\n import com.fasterxml.jackson.databind.node.ObjectNode;\n import com.fasterxml.jackson.databind.node.TextNode;\n+import com.google.common.base.Strings;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageComplexFieldOverride;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ0MDY2Mg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396440662", "bodyText": "If I'm not wrong here we are failing the case update operation if the date field is not in the format specified in the DisplayContextParameter. This won't be an issue with the UI because it's going to send us the date fields in the correct format.\nBut what about Services that are invoking the update event programmatically? They will still be passing unformatted date fields probably (in ISO8601 format)? will those calls throw exception?\nIn case the date is already in ISO8601 format, does the dateTimeFormatParser.convertDateTimeToIso8601 throws exception?\nWe should allow date fields that are already in ISO8601 format rather than throwing exception. Can you make sure we have an integration test for this please.\nWe need to speak with BAs to understand the behaviour in this situation and state it clearly in the ticket for future reference", "author": "mario-paniccia", "createdAt": "2020-03-23T13:15:07Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java", "diffHunk": "@@ -0,0 +1,87 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.node.ArrayNode;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.fasterxml.jackson.databind.node.TextNode;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n+import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameter.*;\n+\n+@Component\n+public class DateTimeEntryProcessor extends CaseDataFieldProcessor {\n+\n+    private static final List<String> SUPPORTED_TYPES = Arrays.asList(DATETIME, DATE);\n+\n+    private final DateTimeFormatParser dateTimeFormatParser;\n+\n+    @Autowired\n+    public DateTimeEntryProcessor(CaseViewFieldBuilder caseViewFieldBuilder,\n+                                  DateTimeFormatParser dateTimeFormatParser) {\n+        super(caseViewFieldBuilder);\n+        this.dateTimeFormatParser = dateTimeFormatParser;\n+    }\n+\n+    @Override\n+    protected JsonNode executeSimple(JsonNode node, CommonField field, BaseType baseType, String fieldPath) {\n+        return !isNullOrEmpty(node)\n+            && hasDisplayContextParameterType(field.getDisplayContextParameter(), DisplayContextParameterType.DATETIMEENTRY)\n+            && isSupportedBaseType(baseType, SUPPORTED_TYPES) ?\n+            createNode(field.getDisplayContextParameter(), node.asText(), baseType, fieldPath) :\n+            node;\n+    }\n+\n+    @Override\n+    protected JsonNode executeCollection(JsonNode collectionNode, CommonField caseViewField, String fieldPath) {\n+        final BaseType collectionFieldType = BaseType.get(caseViewField.getFieldType().getCollectionFieldType().getType());\n+\n+        if (hasDisplayContextParameterType(caseViewField.getDisplayContextParameter(), DisplayContextParameterType.DATETIMEENTRY)\n+            && isSupportedBaseType(collectionFieldType, SUPPORTED_TYPES)) {\n+            ArrayNode newNode = MAPPER.createArrayNode();\n+            collectionNode.forEach(item -> {\n+                JsonNode newItem = item.deepCopy();\n+                ((ObjectNode)newItem).replace(CollectionValidator.VALUE,\n+                    createNode(caseViewField.getDisplayContextParameter(), item.get(CollectionValidator.VALUE).asText(), collectionFieldType, fieldPath));\n+                newNode.add(newItem);\n+            });\n+\n+            return newNode;\n+        }\n+\n+        return collectionNode;\n+    }\n+\n+    private TextNode createNode(String displayContextParameter, String valueToConvert, BaseType baseType, String fieldPath) {\n+        String format = getDisplayContextParameterOfType(displayContextParameter, DisplayContextParameterType.DATETIMEENTRY)\n+            .map(DisplayContextParameter::getValue)\n+            .orElseThrow(() -> new DataProcessingException().withDetails(\n+                String.format(\"Unable to obtain datetime format for field %s with display context parameter %s\",\n+                    fieldPath,\n+                    displayContextParameter)\n+            ));\n+        try {\n+            if (baseType == BaseType.get(DATETIME)) {\n+                return new TextNode(dateTimeFormatParser.convertDateTimeToIso8601(format, valueToConvert));\n+            } else {\n+                return new TextNode(dateTimeFormatParser.convertDateToIso8601(format, valueToConvert));\n+            }\n+        } catch (Exception e) {\n+            throw new DataProcessingException().withDetails(\n+                String.format(\"Unable to process field %s with value %s. Expected format: %s\",", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\nindex b74d7762a..8fd86f40c 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeEntryProcessor.java\n\n@@ -4,10 +4,12 @@ import com.fasterxml.jackson.databind.JsonNode;\n import com.fasterxml.jackson.databind.node.ArrayNode;\n import com.fasterxml.jackson.databind.node.ObjectNode;\n import com.fasterxml.jackson.databind.node.TextNode;\n+import com.google.common.base.Strings;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageComplexFieldOverride;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n import uk.gov.hmcts.ccd.domain.types.CollectionValidator;\n import uk.gov.hmcts.ccd.endpoint.exceptions.DataProcessingException;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk4MDY3Ng==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396980676", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (complexFieldType == BaseType.get(COLLECTION)) {\n          \n          \n            \n                       complexCaseField.isCollectionFieldType()", "author": "mario-paniccia", "createdAt": "2020-03-24T08:39:05Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java", "diffHunk": "@@ -0,0 +1,91 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+\n+public abstract class FieldProcessor {\n+\n+    protected static final ObjectMapper MAPPER = new ObjectMapper();\n+    protected static final String FIELD_SEPARATOR = \".\";\n+\n+    private final CaseViewFieldBuilder caseViewFieldBuilder;\n+\n+    public FieldProcessor(CaseViewFieldBuilder caseViewFieldBuilder) {\n+        this.caseViewFieldBuilder = caseViewFieldBuilder;\n+    }\n+\n+    public JsonNode execute(JsonNode node, CaseField caseField, CaseEventField caseEventField, WizardPageField wizardPageField) {\n+        CaseViewField caseViewField = caseViewFieldBuilder.build(caseField, caseEventField);\n+\n+        if (!BaseType.contains(caseViewField.getFieldType().getType())) {\n+            return node;\n+        }\n+\n+        final BaseType fieldType = BaseType.get(caseViewField.getFieldType().getType());\n+\n+        if (BaseType.get(COMPLEX) == fieldType) {\n+            return executeComplex(node, caseField.getFieldType().getComplexFields(), caseEventField, wizardPageField, caseField.getId());\n+        } else if (BaseType.get(COLLECTION) == fieldType) {\n+            return executeCollection(node, caseViewField, caseField.getId());\n+        } else {\n+            return executeSimple(node, caseViewField, fieldType, caseField.getId());\n+        }\n+    }\n+\n+    private JsonNode executeComplex(JsonNode complexNode,\n+                                      List<CaseField> complexCaseFields,\n+                                      CaseEventField caseEventField,\n+                                      WizardPageField wizardPageField,\n+                                      String fieldPrefix) {\n+        if (complexNode == null) {\n+            return null;\n+        }\n+        ObjectNode newNode = MAPPER.createObjectNode();\n+        complexCaseFields.stream().forEach(complexCaseField -> {\n+            final BaseType complexFieldType = BaseType.get(complexCaseField.getFieldType().getType());\n+            final String fieldId = complexCaseField.getId();\n+            final JsonNode caseFieldNode = complexNode.get(fieldId);\n+            final String fieldPath = fieldPrefix + FIELD_SEPARATOR + fieldId;\n+\n+            if (complexFieldType == BaseType.get(COLLECTION)) {", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\nindex bbcd89832..5e51259d0 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n\n@@ -6,9 +6,7 @@ import com.fasterxml.jackson.databind.node.ObjectNode;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n-import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.model.definition.*;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n \n import java.util.List;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk4MTE3Mg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396981172", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        } else if (complexFieldType == BaseType.get(COMPLEX)) {\n          \n          \n            \n                        } else if (complexCaseField.isComplexFieldType()) {", "author": "mario-paniccia", "createdAt": "2020-03-24T08:40:03Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java", "diffHunk": "@@ -0,0 +1,91 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+\n+public abstract class FieldProcessor {\n+\n+    protected static final ObjectMapper MAPPER = new ObjectMapper();\n+    protected static final String FIELD_SEPARATOR = \".\";\n+\n+    private final CaseViewFieldBuilder caseViewFieldBuilder;\n+\n+    public FieldProcessor(CaseViewFieldBuilder caseViewFieldBuilder) {\n+        this.caseViewFieldBuilder = caseViewFieldBuilder;\n+    }\n+\n+    public JsonNode execute(JsonNode node, CaseField caseField, CaseEventField caseEventField, WizardPageField wizardPageField) {\n+        CaseViewField caseViewField = caseViewFieldBuilder.build(caseField, caseEventField);\n+\n+        if (!BaseType.contains(caseViewField.getFieldType().getType())) {\n+            return node;\n+        }\n+\n+        final BaseType fieldType = BaseType.get(caseViewField.getFieldType().getType());\n+\n+        if (BaseType.get(COMPLEX) == fieldType) {\n+            return executeComplex(node, caseField.getFieldType().getComplexFields(), caseEventField, wizardPageField, caseField.getId());\n+        } else if (BaseType.get(COLLECTION) == fieldType) {\n+            return executeCollection(node, caseViewField, caseField.getId());\n+        } else {\n+            return executeSimple(node, caseViewField, fieldType, caseField.getId());\n+        }\n+    }\n+\n+    private JsonNode executeComplex(JsonNode complexNode,\n+                                      List<CaseField> complexCaseFields,\n+                                      CaseEventField caseEventField,\n+                                      WizardPageField wizardPageField,\n+                                      String fieldPrefix) {\n+        if (complexNode == null) {\n+            return null;\n+        }\n+        ObjectNode newNode = MAPPER.createObjectNode();\n+        complexCaseFields.stream().forEach(complexCaseField -> {\n+            final BaseType complexFieldType = BaseType.get(complexCaseField.getFieldType().getType());\n+            final String fieldId = complexCaseField.getId();\n+            final JsonNode caseFieldNode = complexNode.get(fieldId);\n+            final String fieldPath = fieldPrefix + FIELD_SEPARATOR + fieldId;\n+\n+            if (complexFieldType == BaseType.get(COLLECTION)) {\n+                newNode.set(fieldId, executeCollection(caseFieldNode, complexCaseField, fieldPath));\n+            } else if (complexFieldType == BaseType.get(COMPLEX)) {", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\nindex bbcd89832..5e51259d0 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n\n@@ -6,9 +6,7 @@ import com.fasterxml.jackson.databind.node.ObjectNode;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n-import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.model.definition.*;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n \n import java.util.List;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk4NDA2Mg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396984062", "bodyText": "minor: building a field's path it's common logic that could be encapsulated in a common class or utility method. If we don't have something we can reuse already", "author": "mario-paniccia", "createdAt": "2020-03-24T08:45:21Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java", "diffHunk": "@@ -0,0 +1,91 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+\n+public abstract class FieldProcessor {\n+\n+    protected static final ObjectMapper MAPPER = new ObjectMapper();\n+    protected static final String FIELD_SEPARATOR = \".\";\n+\n+    private final CaseViewFieldBuilder caseViewFieldBuilder;\n+\n+    public FieldProcessor(CaseViewFieldBuilder caseViewFieldBuilder) {\n+        this.caseViewFieldBuilder = caseViewFieldBuilder;\n+    }\n+\n+    public JsonNode execute(JsonNode node, CaseField caseField, CaseEventField caseEventField, WizardPageField wizardPageField) {\n+        CaseViewField caseViewField = caseViewFieldBuilder.build(caseField, caseEventField);\n+\n+        if (!BaseType.contains(caseViewField.getFieldType().getType())) {\n+            return node;\n+        }\n+\n+        final BaseType fieldType = BaseType.get(caseViewField.getFieldType().getType());\n+\n+        if (BaseType.get(COMPLEX) == fieldType) {\n+            return executeComplex(node, caseField.getFieldType().getComplexFields(), caseEventField, wizardPageField, caseField.getId());\n+        } else if (BaseType.get(COLLECTION) == fieldType) {\n+            return executeCollection(node, caseViewField, caseField.getId());\n+        } else {\n+            return executeSimple(node, caseViewField, fieldType, caseField.getId());\n+        }\n+    }\n+\n+    private JsonNode executeComplex(JsonNode complexNode,\n+                                      List<CaseField> complexCaseFields,\n+                                      CaseEventField caseEventField,\n+                                      WizardPageField wizardPageField,\n+                                      String fieldPrefix) {\n+        if (complexNode == null) {\n+            return null;\n+        }\n+        ObjectNode newNode = MAPPER.createObjectNode();\n+        complexCaseFields.stream().forEach(complexCaseField -> {\n+            final BaseType complexFieldType = BaseType.get(complexCaseField.getFieldType().getType());\n+            final String fieldId = complexCaseField.getId();\n+            final JsonNode caseFieldNode = complexNode.get(fieldId);\n+            final String fieldPath = fieldPrefix + FIELD_SEPARATOR + fieldId;", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\nindex bbcd89832..5e51259d0 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n\n@@ -6,9 +6,7 @@ import com.fasterxml.jackson.databind.node.ObjectNode;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n-import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.model.definition.*;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n \n import java.util.List;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk4OTcyMg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r396989722", "bodyText": "I wouldn't bother wrapping a null with an optional just so I can call ifPresent. Either you have the method you are calling return itself an Optional, or just do a null check:\nJsonNode jsonNode = executeComplex(.....);\n if (jsonNode != null) {\n       newNode.set(fieldId, jsonNode);\n}\n\nPlease see: https://stackoverflow.com/questions/53197393/wrap-object-in-optional-to-use-ifpresent-method\nCan you correct this everywhere it has been introduced please?", "author": "mario-paniccia", "createdAt": "2020-03-24T08:54:57Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java", "diffHunk": "@@ -0,0 +1,91 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n+import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n+import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n+import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.types.BaseType;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import static uk.gov.hmcts.ccd.domain.model.definition.FieldType.*;\n+\n+public abstract class FieldProcessor {\n+\n+    protected static final ObjectMapper MAPPER = new ObjectMapper();\n+    protected static final String FIELD_SEPARATOR = \".\";\n+\n+    private final CaseViewFieldBuilder caseViewFieldBuilder;\n+\n+    public FieldProcessor(CaseViewFieldBuilder caseViewFieldBuilder) {\n+        this.caseViewFieldBuilder = caseViewFieldBuilder;\n+    }\n+\n+    public JsonNode execute(JsonNode node, CaseField caseField, CaseEventField caseEventField, WizardPageField wizardPageField) {\n+        CaseViewField caseViewField = caseViewFieldBuilder.build(caseField, caseEventField);\n+\n+        if (!BaseType.contains(caseViewField.getFieldType().getType())) {\n+            return node;\n+        }\n+\n+        final BaseType fieldType = BaseType.get(caseViewField.getFieldType().getType());\n+\n+        if (BaseType.get(COMPLEX) == fieldType) {\n+            return executeComplex(node, caseField.getFieldType().getComplexFields(), caseEventField, wizardPageField, caseField.getId());\n+        } else if (BaseType.get(COLLECTION) == fieldType) {\n+            return executeCollection(node, caseViewField, caseField.getId());\n+        } else {\n+            return executeSimple(node, caseViewField, fieldType, caseField.getId());\n+        }\n+    }\n+\n+    private JsonNode executeComplex(JsonNode complexNode,\n+                                      List<CaseField> complexCaseFields,\n+                                      CaseEventField caseEventField,\n+                                      WizardPageField wizardPageField,\n+                                      String fieldPrefix) {\n+        if (complexNode == null) {\n+            return null;\n+        }\n+        ObjectNode newNode = MAPPER.createObjectNode();\n+        complexCaseFields.stream().forEach(complexCaseField -> {\n+            final BaseType complexFieldType = BaseType.get(complexCaseField.getFieldType().getType());\n+            final String fieldId = complexCaseField.getId();\n+            final JsonNode caseFieldNode = complexNode.get(fieldId);\n+            final String fieldPath = fieldPrefix + FIELD_SEPARATOR + fieldId;\n+\n+            if (complexFieldType == BaseType.get(COLLECTION)) {\n+                newNode.set(fieldId, executeCollection(caseFieldNode, complexCaseField, fieldPath));\n+            } else if (complexFieldType == BaseType.get(COMPLEX)) {\n+                Optional.ofNullable(\n+                    executeComplex(caseFieldNode, complexCaseField.getFieldType().getComplexFields(), caseEventField, wizardPageField, fieldPath))\n+                    .ifPresent(result -> newNode.set(fieldId, result));", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\nindex bbcd89832..5e51259d0 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/FieldProcessor.java\n\n@@ -6,9 +6,7 @@ import com.fasterxml.jackson.databind.node.ObjectNode;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewField;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CaseViewFieldBuilder;\n import uk.gov.hmcts.ccd.domain.model.aggregated.CommonField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseEventField;\n-import uk.gov.hmcts.ccd.domain.model.definition.CaseField;\n-import uk.gov.hmcts.ccd.domain.model.definition.WizardPageField;\n+import uk.gov.hmcts.ccd.domain.model.definition.*;\n import uk.gov.hmcts.ccd.domain.types.BaseType;\n \n import java.util.List;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyODY2Nw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397028667", "bodyText": "maybe better move this into a processor.date package?", "author": "mario-paniccia", "createdAt": "2020-03-24T09:57:01Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java", "diffHunk": "@@ -0,0 +1,44 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\nindex 1c5758883..e0ec4f3a8 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\n\n@@ -4,41 +4,74 @@ import java.time.LocalDate;\n import java.time.LocalDateTime;\n import java.time.format.DateTimeFormatter;\n import java.time.format.DateTimeFormatterBuilder;\n-import java.time.temporal.ChronoField;\n+import java.time.temporal.*;\n \n+import lombok.extern.slf4j.Slf4j;\n+import org.joda.time.format.*;\n import org.springframework.stereotype.Component;\n \n @Component\n+@Slf4j\n public class DateTimeFormatParser {\n \n-    private static final String DATE_TIME_FORMAT = \"yyyy-MM-dd'T'HH:mm:ss.SSS\";\n-    private static final String DATE_FORMAT = \"yyyy-MM-dd\";\n+    static final DateTimeFormatter DATE_TIME_FORMAT = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSS\");\n+    static final DateTimeFormatter DATE_TIME_FORMAT_MILLISECOND = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SS\");\n+    static final DateTimeFormatter DATE_FORMAT = DateTimeFormatter.ofPattern(\"yyyy-MM-dd\");\n+    private static final int DEFAULT_YEAR = 1970;\n \n     public String convertDateTimeToIso8601(String dateTimeFormat, String value) {\n-        DateTimeFormatter inputFormat = new DateTimeFormatterBuilder()\n+        LocalDateTime dateTime;\n+        try {\n+            DateTimeFormatter inputFormat = (dateTimeFormat == null) ? DATE_TIME_FORMAT : getDateTimeFormatter(dateTimeFormat);\n+            dateTime = LocalDateTime.parse(value, inputFormat);\n+        } catch (Exception e) {\n+            log.warn(\"Failed to parse following dateTime value {} with format {} attempting to parse with {}\", value, dateTimeFormat, DATE_TIME_FORMAT);\n+            dateTime = LocalDateTime.parse(value, DATE_TIME_FORMAT);\n+        }\n+        return dateTime.format(DATE_TIME_FORMAT);\n+    }\n+\n+    public String convertDateToIso8601(String dateFormat, String value) {\n+        LocalDate date;\n+        try {\n+            DateTimeFormatter inputFormat = (dateFormat == null) ? DATE_FORMAT : getDateFormatter(dateFormat);\n+            date = LocalDate.parse(value, inputFormat);\n+        } catch (Exception e) {\n+            log.warn(\"Failed to parse following date value {} with format {} attempting to parse with {}\", value, dateFormat, DATE_FORMAT);\n+            date = LocalDate.parse(value, DATE_FORMAT);\n+        }\n+        return date.format(DATE_FORMAT);\n+    }\n+\n+    public String convertIso8601ToDateTime(String dateTimeFormat, String value) {\n+        LocalDateTime dateTime = LocalDateTime.parse(value);\n+        return dateTime.format(DateTimeFormatter.ofPattern(dateTimeFormat));\n+    }\n+\n+    public String convertIso8601ToDate(String dateFormat, String value) {\n+        LocalDate date = LocalDate.parse(value, DATE_FORMAT);\n+        return date.format(DateTimeFormatter.ofPattern(dateFormat));\n+    }\n+\n+    private DateTimeFormatter getDateTimeFormatter(String dateTimeFormat) {\n+        return new DateTimeFormatterBuilder()\n             .appendPattern(dateTimeFormat)\n-            .parseDefaulting(ChronoField.YEAR_OF_ERA, LocalDate.now().getYear())\n-            .parseDefaulting(ChronoField.MONTH_OF_YEAR, LocalDate.now().getMonthValue())\n-            .parseDefaulting(ChronoField.DAY_OF_MONTH, LocalDate.now().getDayOfMonth())\n+            .parseDefaulting(ChronoField.YEAR_OF_ERA, DEFAULT_YEAR)\n+            .parseDefaulting(ChronoField.MONTH_OF_YEAR, 1)\n+            .parseDefaulting(ChronoField.DAY_OF_MONTH, 1)\n             .parseDefaulting(ChronoField.HOUR_OF_DAY, 0)\n             .parseDefaulting(ChronoField.MINUTE_OF_HOUR, 0)\n             .parseDefaulting(ChronoField.SECOND_OF_MINUTE, 0)\n             .parseDefaulting(ChronoField.MILLI_OF_SECOND, 0)\n             .toFormatter();\n-\n-        LocalDateTime dateTime = LocalDateTime.parse(value, inputFormat);\n-        return dateTime.format(DateTimeFormatter.ofPattern(DATE_TIME_FORMAT));\n     }\n \n-    public String convertDateToIso8601(String dateFormat, String value) {\n-        DateTimeFormatter inputFormat = new DateTimeFormatterBuilder()\n+    private DateTimeFormatter getDateFormatter(String dateFormat) {\n+        return new DateTimeFormatterBuilder()\n             .appendPattern(dateFormat)\n-            .parseDefaulting(ChronoField.YEAR_OF_ERA, LocalDate.now().getYear())\n-            .parseDefaulting(ChronoField.MONTH_OF_YEAR, LocalDate.now().getMonthValue())\n-            .parseDefaulting(ChronoField.DAY_OF_MONTH, LocalDate.now().getDayOfMonth())\n+            .parseDefaulting(ChronoField.YEAR_OF_ERA, DEFAULT_YEAR)\n+            .parseDefaulting(ChronoField.MONTH_OF_YEAR, 1)\n+            .parseDefaulting(ChronoField.DAY_OF_MONTH, 1)\n             .toFormatter();\n-\n-        LocalDate date = LocalDate.parse(value, inputFormat);\n-        return date.format(DateTimeFormatter.ofPattern(DATE_FORMAT));\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzA0NDQ1MA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397044450", "bodyText": "DisplayContextParameter it's a core domain concept that should be outside the processor package", "author": "mario-paniccia", "createdAt": "2020-03-24T10:22:59Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java", "diffHunk": "@@ -0,0 +1,61 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "19101d5fc91a714a1f84b5e67facf5c7da82d919", "chunk": "diff --git a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java\nindex f4a24eb93..aa2a94c32 100644\n--- a/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java\n+++ b/src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameter.java\n\n@@ -1,16 +1,17 @@\n package uk.gov.hmcts.ccd.domain.service.processor;\n \n import com.google.common.base.Strings;\n+import com.hazelcast.util.*;\n \n-import java.util.ArrayList;\n-import java.util.List;\n-import java.util.Optional;\n+import java.util.*;\n \n import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameterType.getParameterTypeFor;\n import static uk.gov.hmcts.ccd.domain.service.processor.DisplayContextParameterType.getParameterValueFor;\n \n public class DisplayContextParameter {\n \n+    private static String MULTIPLE_PARAMETERS_STRING = \"),\";\n+\n     private DisplayContextParameterType type;\n \n     private String value;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzA1NTQ5MQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397055491", "bodyText": "Optional.empty should be used to model missing values, not incorrect or unknown values as we are doing here", "author": "mario-paniccia", "createdAt": "2020-03-24T10:41:22Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java", "diffHunk": "@@ -0,0 +1,38 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.google.common.base.Strings;\n+\n+import java.util.*;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+public enum DisplayContextParameterType {\n+    DATETIMEENTRY,\n+    DATETIMEDISPLAY,\n+    TABLE,\n+    LIST;\n+\n+    private static final Pattern PATTERN = Pattern.compile(\"#(.+)\\\\((.+)\\\\)\");\n+    private static final int TYPE_GROUP = 1;\n+    private static final int VALUE_GROUP = 2;\n+\n+    public static Optional<DisplayContextParameterType> getParameterTypeFor(String displayContextParameter) {\n+        Matcher m = PATTERN.matcher(displayContextParameter);\n+        if (m.matches()) {\n+            try {\n+                return Optional.of(valueOf(m.group(TYPE_GROUP)));\n+            } catch (IllegalArgumentException e) {\n+                return Optional.empty();", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzA1NTYyNA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397055624", "bodyText": "Optional.empty should be used to model missing values, not incorrect or unknown values as we are doing here", "author": "mario-paniccia", "createdAt": "2020-03-24T10:41:36Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java", "diffHunk": "@@ -0,0 +1,38 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.google.common.base.Strings;\n+\n+import java.util.*;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+public enum DisplayContextParameterType {\n+    DATETIMEENTRY,\n+    DATETIMEDISPLAY,\n+    TABLE,\n+    LIST;\n+\n+    private static final Pattern PATTERN = Pattern.compile(\"#(.+)\\\\((.+)\\\\)\");\n+    private static final int TYPE_GROUP = 1;\n+    private static final int VALUE_GROUP = 2;\n+\n+    public static Optional<DisplayContextParameterType> getParameterTypeFor(String displayContextParameter) {\n+        Matcher m = PATTERN.matcher(displayContextParameter);\n+        if (m.matches()) {\n+            try {\n+                return Optional.of(valueOf(m.group(TYPE_GROUP)));\n+            } catch (IllegalArgumentException e) {\n+                return Optional.empty();\n+            }\n+        }\n+        return Optional.empty();", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzA1NjI4Ng==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397056286", "bodyText": "Optional.empty should be used to model missing values, not incorrect or unknown values as we are doing here", "author": "mario-paniccia", "createdAt": "2020-03-24T10:42:50Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java", "diffHunk": "@@ -0,0 +1,38 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.google.common.base.Strings;\n+\n+import java.util.*;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+public enum DisplayContextParameterType {\n+    DATETIMEENTRY,\n+    DATETIMEDISPLAY,\n+    TABLE,\n+    LIST;\n+\n+    private static final Pattern PATTERN = Pattern.compile(\"#(.+)\\\\((.+)\\\\)\");\n+    private static final int TYPE_GROUP = 1;\n+    private static final int VALUE_GROUP = 2;\n+\n+    public static Optional<DisplayContextParameterType> getParameterTypeFor(String displayContextParameter) {\n+        Matcher m = PATTERN.matcher(displayContextParameter);\n+        if (m.matches()) {\n+            try {\n+                return Optional.of(valueOf(m.group(TYPE_GROUP)));\n+            } catch (IllegalArgumentException e) {\n+                return Optional.empty();\n+            }\n+        }\n+        return Optional.empty();\n+    }\n+\n+    public static Optional<String> getParameterValueFor(String displayContextParameter) {\n+        Matcher m = PATTERN.matcher(displayContextParameter);\n+        if (m.matches() && !Strings.isNullOrEmpty(m.group(VALUE_GROUP))) {\n+            return Optional.of(m.group(VALUE_GROUP));\n+        }\n+        return Optional.empty();", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzA1NzI5Ng==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397057296", "bodyText": "is the null check required here? if value group of the pattern (.+) is matching that means there is at least on char right?", "author": "mario-paniccia", "createdAt": "2020-03-24T10:44:30Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/processor/DisplayContextParameterType.java", "diffHunk": "@@ -0,0 +1,38 @@\n+package uk.gov.hmcts.ccd.domain.service.processor;\n+\n+import com.google.common.base.Strings;\n+\n+import java.util.*;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+public enum DisplayContextParameterType {\n+    DATETIMEENTRY,\n+    DATETIMEDISPLAY,\n+    TABLE,\n+    LIST;\n+\n+    private static final Pattern PATTERN = Pattern.compile(\"#(.+)\\\\((.+)\\\\)\");\n+    private static final int TYPE_GROUP = 1;\n+    private static final int VALUE_GROUP = 2;\n+\n+    public static Optional<DisplayContextParameterType> getParameterTypeFor(String displayContextParameter) {\n+        Matcher m = PATTERN.matcher(displayContextParameter);\n+        if (m.matches()) {\n+            try {\n+                return Optional.of(valueOf(m.group(TYPE_GROUP)));\n+            } catch (IllegalArgumentException e) {\n+                return Optional.empty();\n+            }\n+        }\n+        return Optional.empty();\n+    }\n+\n+    public static Optional<String> getParameterValueFor(String displayContextParameter) {\n+        Matcher m = PATTERN.matcher(displayContextParameter);\n+        if (m.matches() && !Strings.isNullOrEmpty(m.group(VALUE_GROUP))) {", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEwMjU4OA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397102588", "bodyText": "I'm a bit puzzled by this choice. Wouldn't it be more consistent with the current design if we had enhanced the DateTimeValidator and DateValidator to do the validation of the formatted date. And if successful then do the conversion?\nInstead we are converting to the internal unformatted date before doing the validation", "author": "mario-paniccia", "createdAt": "2020-03-24T12:06:59Z", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/validate/DefaultValidateCaseFieldsOperation.java", "diffHunk": "@@ -11,33 +11,38 @@\n import uk.gov.hmcts.ccd.domain.model.definition.CaseType;\n import uk.gov.hmcts.ccd.domain.model.std.CaseDataContent;\n import uk.gov.hmcts.ccd.domain.service.common.CaseTypeService;\n+import uk.gov.hmcts.ccd.domain.service.processor.FieldProcessorService;\n import uk.gov.hmcts.ccd.endpoint.exceptions.ValidationException;\n \n @Service\n public class DefaultValidateCaseFieldsOperation implements ValidateCaseFieldsOperation {\n \n     private final CaseDefinitionRepository caseDefinitionRepository;\n     private final CaseTypeService caseTypeService;\n+    private final FieldProcessorService fieldProcessorService;\n \n     @Inject DefaultValidateCaseFieldsOperation(\n         @Qualifier(CachedCaseDefinitionRepository.QUALIFIER) final CaseDefinitionRepository caseDefinitionRepository,\n-        final CaseTypeService caseTypeService) {\n+        final CaseTypeService caseTypeService,\n+        final FieldProcessorService fieldProcessorService) {\n         this.caseDefinitionRepository = caseDefinitionRepository;\n         this.caseTypeService = caseTypeService;\n+        this.fieldProcessorService = fieldProcessorService;\n     }\n \n     @Override\n     public final Map<String, JsonNode> validateCaseDetails(String caseTypeId, CaseDataContent content) {\n-        if (content == null || content.getEvent().getEventId() == null) {\n+        if (content == null || content.getEvent() == null || content.getEventId() == null) {\n             throw new ValidationException(\"Cannot validate case field because of event is not specified\");\n         }\n         final CaseType caseType = caseDefinitionRepository.getCaseType(caseTypeId);\n         if (caseType == null) {\n-            throw new ValidationException(\"Cannot find case type definition for  \" + caseTypeId);\n+            throw new ValidationException(\"Cannot find case type definition for \" + caseTypeId);\n         }\n         if (!hasEventId(caseType, content.getEventId())) {\n-            throw new ValidationException(\"Cannot validate case field because of event\" + content.getEventId() + \" is not found in case type definition\");\n+            throw new ValidationException(\"Cannot validate case field because of event \" + content.getEventId() + \" is not found in case type definition\");\n         }\n+        content.setData(fieldProcessorService.processData(content.getData(), caseType, content.getEventId()));", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEwNTk0Ng==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397105946", "bodyText": "why DataProcessing exception should be a subclass of ValidationException? in theory we could have processing errors that have nothing to do with validation", "author": "mario-paniccia", "createdAt": "2020-03-24T12:13:01Z", "path": "src/main/java/uk/gov/hmcts/ccd/endpoint/exceptions/DataProcessingException.java", "diffHunk": "@@ -0,0 +1,12 @@\n+package uk.gov.hmcts.ccd.endpoint.exceptions;\n+\n+import org.springframework.http.HttpStatus;\n+import org.springframework.web.bind.annotation.ResponseStatus;\n+\n+@ResponseStatus(code = HttpStatus.UNPROCESSABLE_ENTITY)\n+public class DataProcessingException extends ValidationException {", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMyNDc3Mg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397324772", "bodyText": "not enough unit testing probably", "author": "mario-paniccia", "createdAt": "2020-03-24T17:14:49Z", "path": "src/test/java/uk/gov/hmcts/ccd/domain/service/createcase/DefaultCreateCaseOperationTest.java", "diffHunk": "@@ -169,6 +169,33 @@ void shouldThrowValidationException_whenCaseTypeIsNotDefinedForJurisdiction() {\n                      \"Cannot create case because of cti is not defined as case type for jid\");", "originalCommit": "ed5bc5d03506d66331469da5ac87a9928cd38036", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMyNTMyNg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/846#discussion_r397325326", "bodyText": "and we absolutely must have a good suite of integration tests", "author": "mario-paniccia", "createdAt": "2020-03-24T17:15:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMyNDc3Mg=="}], "type": "inlineReview", "revised_code": null}, {"oid": "4116431b907ea5a6bc469d65874babfb78b1e6da", "url": "https://github.com/hmcts/ccd-data-store-api/commit/4116431b907ea5a6bc469d65874babfb78b1e6da", "message": "Merge branch 'RDM-7575-DateTime-Formatting' into RDM-7630", "committedDate": "2020-03-25T09:51:14Z", "type": "commit"}, {"oid": "a621679cbe24209b65bcfa1e1b33acad841a31cd", "url": "https://github.com/hmcts/ccd-data-store-api/commit/a621679cbe24209b65bcfa1e1b33acad841a31cd", "message": "Merge branch 'RDM-7630' into RDM-7692", "committedDate": "2020-03-25T09:52:28Z", "type": "commit"}, {"oid": "d608e2c450bd04b5b02e6b7f9cef771fdae8fa51", "url": "https://github.com/hmcts/ccd-data-store-api/commit/d608e2c450bd04b5b02e6b7f9cef771fdae8fa51", "message": "Merge branch 'RDM-7692' into RDM-7694\n\n# Conflicts:\n#\tsrc/main/java/uk/gov/hmcts/ccd/domain/model/search/CriteriaInput.java\n#\tsrc/test/java/uk/gov/hmcts/ccd/domain/service/common/TestBuildersUtil.java", "committedDate": "2020-03-25T09:54:21Z", "type": "commit"}, {"oid": "e8f2348681d20619700e0cc5b29c86ff4f3b616e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e8f2348681d20619700e0cc5b29c86ff4f3b616e", "message": "RDM-7630 fixed build issue", "committedDate": "2020-03-25T11:20:17Z", "type": "commit"}, {"oid": "b0bb310ea0dca398727db3cb9c78d581cada711e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/b0bb310ea0dca398727db3cb9c78d581cada711e", "message": "RDM-7630 extended logic to be more robust", "committedDate": "2020-03-27T08:30:59Z", "type": "commit"}, {"oid": "2521b22a66a6b810a0af89dc333c3df8013d22bf", "url": "https://github.com/hmcts/ccd-data-store-api/commit/2521b22a66a6b810a0af89dc333c3df8013d22bf", "message": "Merge branch 'RDM-7575-DateTime-Formatting' into RDM-7630", "committedDate": "2020-03-27T10:21:00Z", "type": "commit"}, {"oid": "4bfa1ca7ad351423338a2a0ccf5bdb9f650fb170", "url": "https://github.com/hmcts/ccd-data-store-api/commit/4bfa1ca7ad351423338a2a0ccf5bdb9f650fb170", "message": "Merge branch 'RDM-7630' into RDM-7692\n\n# Conflicts:\n#\tsrc/main/java/uk/gov/hmcts/ccd/domain/model/definition/WizardPageComplexFieldOverride.java\n#\tsrc/main/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParser.java\n#\tsrc/test/java/uk/gov/hmcts/ccd/domain/service/processor/DateTimeFormatParserTest.java", "committedDate": "2020-03-27T10:34:10Z", "type": "commit"}, {"oid": "296066aee5343e4502982736c1195e03a2b35710", "url": "https://github.com/hmcts/ccd-data-store-api/commit/296066aee5343e4502982736c1195e03a2b35710", "message": "Merge branch 'RDM-7692' into RDM-7694", "committedDate": "2020-03-27T10:34:41Z", "type": "commit"}, {"oid": "b505896b8a3bff0756fd6cb31a59aa0a7e379d9e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/b505896b8a3bff0756fd6cb31a59aa0a7e379d9e", "message": "Merge branch 'RDM-7575-DateTime-Formatting' into RDM-7630", "committedDate": "2020-03-30T08:39:32Z", "type": "commit"}, {"oid": "dd6d583cf1aedcbc3d2e5d50db9f861f26bec3e7", "url": "https://github.com/hmcts/ccd-data-store-api/commit/dd6d583cf1aedcbc3d2e5d50db9f861f26bec3e7", "message": "Merge branch 'RDM-7630' into RDM-7692", "committedDate": "2020-03-30T08:41:28Z", "type": "commit"}, {"oid": "11bf69bb49fb30da55064b802d60b99ca2cbe472", "url": "https://github.com/hmcts/ccd-data-store-api/commit/11bf69bb49fb30da55064b802d60b99ca2cbe472", "message": "RDM-7692 - fixed compilation issue.", "committedDate": "2020-03-30T08:48:07Z", "type": "commit"}, {"oid": "8015087b60db2208d545e2d8024ffe94fcb18a1e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/8015087b60db2208d545e2d8024ffe94fcb18a1e", "message": "Merge branch 'RDM-7692' into RDM-7694", "committedDate": "2020-03-30T08:48:55Z", "type": "commit"}, {"oid": "c8141b8143b6065498a75f8b8054dfc170481cdc", "url": "https://github.com/hmcts/ccd-data-store-api/commit/c8141b8143b6065498a75f8b8054dfc170481cdc", "message": "Merge branch 'RDM-7575-DateTime-Formatting' into RDM-7630", "committedDate": "2020-03-30T09:24:27Z", "type": "commit"}, {"oid": "e29ddd3fd024c34d3bc3a63a9a1e00715fe4ff1a", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e29ddd3fd024c34d3bc3a63a9a1e00715fe4ff1a", "message": "Merge branch 'RDM-7630' into RDM-7692", "committedDate": "2020-03-30T09:25:12Z", "type": "commit"}, {"oid": "b9e5d2a15e73fc7852bd66338ed2ed76c5b6f00e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/b9e5d2a15e73fc7852bd66338ed2ed76c5b6f00e", "message": "Merge branch 'RDM-7692' into RDM-7694", "committedDate": "2020-03-30T09:25:36Z", "type": "commit"}, {"oid": "2cb425bf27e04ecc38930d3ca6c5e68392dc7f11", "url": "https://github.com/hmcts/ccd-data-store-api/commit/2cb425bf27e04ecc38930d3ca6c5e68392dc7f11", "message": "DateTimeFormatParser updates to support other branches", "committedDate": "2020-03-30T12:01:18Z", "type": "commit"}, {"oid": "0b1be4e3352ec7bcb5b84df82e11d6d6d99a0fc7", "url": "https://github.com/hmcts/ccd-data-store-api/commit/0b1be4e3352ec7bcb5b84df82e11d6d6d99a0fc7", "message": "Merge branch 'RDM-7630' into RDM-7692", "committedDate": "2020-03-30T12:05:56Z", "type": "commit"}, {"oid": "5a58ca28950c5b1acb38f6a201bee26357dec6f5", "url": "https://github.com/hmcts/ccd-data-store-api/commit/5a58ca28950c5b1acb38f6a201bee26357dec6f5", "message": "Merge branch 'RDM-7692' into RDM-7694", "committedDate": "2020-03-30T12:06:17Z", "type": "commit"}, {"oid": "9ed8f3aa934a5df994e9d444f052ff02e62f2c1e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/9ed8f3aa934a5df994e9d444f052ff02e62f2c1e", "message": "Add formatted values to search/workbasket results", "committedDate": "2020-03-30T14:02:41Z", "type": "commit"}, {"oid": "195894c5f200cbf218d4af3109236131fa1cfadf", "url": "https://github.com/hmcts/ccd-data-store-api/commit/195894c5f200cbf218d4af3109236131fa1cfadf", "message": "RDM-8079 - Default day/month to 1", "committedDate": "2020-03-31T12:01:35Z", "type": "commit"}, {"oid": "cc9c17ab6fcfe36563a1b1fd4282026b1a032edf", "url": "https://github.com/hmcts/ccd-data-store-api/commit/cc9c17ab6fcfe36563a1b1fd4282026b1a032edf", "message": "Merge branch 'RDM-7630' into RDM-7692", "committedDate": "2020-03-31T12:02:44Z", "type": "commit"}, {"oid": "8a4ae4951803d3b2b1b3d3bb68464a41f777eed1", "url": "https://github.com/hmcts/ccd-data-store-api/commit/8a4ae4951803d3b2b1b3d3bb68464a41f777eed1", "message": "Merge branch 'RDM-7692' into RDM-7694", "committedDate": "2020-03-31T12:02:55Z", "type": "commit"}, {"oid": "7fa20156ff4df437cb78330d256bd3bf9573083b", "url": "https://github.com/hmcts/ccd-data-store-api/commit/7fa20156ff4df437cb78330d256bd3bf9573083b", "message": "RDM-8071 - Enable processors on collections of complex", "committedDate": "2020-04-01T10:57:25Z", "type": "commit"}, {"oid": "f7256532c9bdaa1b400f8bfa8a216fe9d9d75394", "url": "https://github.com/hmcts/ccd-data-store-api/commit/f7256532c9bdaa1b400f8bfa8a216fe9d9d75394", "message": "Merge branch 'RDM-7692' into RDM-7694", "committedDate": "2020-04-01T12:00:05Z", "type": "commit"}, {"oid": "1bd8276e4b9ab23deffd5b39346509c03eb4e4ca", "url": "https://github.com/hmcts/ccd-data-store-api/commit/1bd8276e4b9ab23deffd5b39346509c03eb4e4ca", "message": "Handle TextNodes with empty strings", "committedDate": "2020-04-01T12:16:47Z", "type": "commit"}, {"oid": "92906be40e2b64f6e386a76c01f89928c6cb2a42", "url": "https://github.com/hmcts/ccd-data-store-api/commit/92906be40e2b64f6e386a76c01f89928c6cb2a42", "message": "Support complex fields in search/workbasket results", "committedDate": "2020-04-06T08:28:27Z", "type": "commit"}, {"oid": "5f28e7a93e315c4d6886aba0e2aa201bf331a308", "url": "https://github.com/hmcts/ccd-data-store-api/commit/5f28e7a93e315c4d6886aba0e2aa201bf331a308", "message": "Update mappings for failing tests", "committedDate": "2020-04-06T10:30:23Z", "type": "commit"}, {"oid": "92d070641693b8f9d6c2242bd2e5958d9f3cd52f", "url": "https://github.com/hmcts/ccd-data-store-api/commit/92d070641693b8f9d6c2242bd2e5958d9f3cd52f", "message": "Merge branch 'RDM-7575-DateTime-Formatting' into RDM-7630", "committedDate": "2020-04-06T11:25:46Z", "type": "commit"}, {"oid": "4389b3046b64724519a18bc3a2d431b0ffec987e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/4389b3046b64724519a18bc3a2d431b0ffec987e", "message": "Merge branch 'RDM-7630' into RDM-7692", "committedDate": "2020-04-06T11:26:17Z", "type": "commit"}, {"oid": "524c8a0a24e93365c03f3d7ad3c139e5f2653745", "url": "https://github.com/hmcts/ccd-data-store-api/commit/524c8a0a24e93365c03f3d7ad3c139e5f2653745", "message": "Merge branch 'RDM-7692' into RDM-7694", "committedDate": "2020-04-06T11:26:31Z", "type": "commit"}, {"oid": "17dc665970fdec9df13dfe3762bf296399cf8f63", "url": "https://github.com/hmcts/ccd-data-store-api/commit/17dc665970fdec9df13dfe3762bf296399cf8f63", "message": "Handle metadata data fields", "committedDate": "2020-04-06T13:53:20Z", "type": "commit"}, {"oid": "35a9dfaf6e2ece49ca31dd880aef3966459de0a9", "url": "https://github.com/hmcts/ccd-data-store-api/commit/35a9dfaf6e2ece49ca31dd880aef3966459de0a9", "message": "Minor checkstyle", "committedDate": "2020-04-06T14:11:57Z", "type": "commit"}, {"oid": "792401bf6505699b6e711c72b1563975bb834e52", "url": "https://github.com/hmcts/ccd-data-store-api/commit/792401bf6505699b6e711c72b1563975bb834e52", "message": "Add DCP to FT data", "committedDate": "2020-04-06T14:59:24Z", "type": "commit"}, {"oid": "e7f8784041eea43e1bea615e061fe72ea2bddb45", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e7f8784041eea43e1bea615e061fe72ea2bddb45", "message": "Unit tests for nested field logic", "committedDate": "2020-04-06T17:47:58Z", "type": "commit"}, {"oid": "11e1c6c0167f431eb493543ee428b13a2ccf5b0b", "url": "https://github.com/hmcts/ccd-data-store-api/commit/11e1c6c0167f431eb493543ee428b13a2ccf5b0b", "message": "RDM-8070 - Default year to 1970", "committedDate": "2020-04-07T11:56:40Z", "type": "commit"}, {"oid": "e48623b6665c787599aa70f1a4139ca1b2a74d95", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e48623b6665c787599aa70f1a4139ca1b2a74d95", "message": "Merge branch 'RDM-7692' into RDM-7694", "committedDate": "2020-04-07T11:57:23Z", "type": "commit"}, {"oid": "61be3bdf38361f6631f7ea3bb27a81a8a95539ea", "url": "https://github.com/hmcts/ccd-data-store-api/commit/61be3bdf38361f6631f7ea3bb27a81a8a95539ea", "message": "RDM-8113 handle display without seconds or milliseconds\nRDM-8057 split DCP correctly when there is multiple params", "committedDate": "2020-04-09T12:21:01Z", "type": "commit"}, {"oid": "622181fc4cb20ff67c626dd5a860a6f97189da10", "url": "https://github.com/hmcts/ccd-data-store-api/commit/622181fc4cb20ff67c626dd5a860a6f97189da10", "message": "RDM-8113 updated functional response", "committedDate": "2020-04-09T12:53:42Z", "type": "commit"}, {"oid": "b02cbadefeece8e4fab9f120e48db5d0c5bb3cdc", "url": "https://github.com/hmcts/ccd-data-store-api/commit/b02cbadefeece8e4fab9f120e48db5d0c5bb3cdc", "message": "RDM-8113 added unit tests for partial milliseconds", "committedDate": "2020-04-09T14:19:05Z", "type": "commit"}]}