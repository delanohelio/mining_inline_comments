{"pr_number": 1405, "pr_title": "Add 'Generate constructor' option to 'Show Fixes' options for fields", "pr_createdAt": "2020-04-06T16:40:51Z", "pr_url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1405", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI0NDY4Ng==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1405#discussion_r404244686", "bodyText": "we're basically recomputing the actions a 2nd time, seems suboptimal. Couldn't we just copy the ones we have already and change their kind?", "author": "fbricon", "createdAt": "2020-04-06T16:56:57Z", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/text/correction/SourceAssistProcessor.java", "diffHunk": "@@ -140,7 +144,7 @@ public SourceAssistProcessor(PreferenceManager preferenceManager) {\n \t\t}\r\n \r\n \t\t// Generate Constructors\r\n-\t\tOptional<Either<Command, CodeAction>> generateConstructors = getGenerateConstructorsAction(params, context, type);\r\n+\t\tgenerateConstructors = getGenerateConstructorsAction(params, context, type, JavaCodeActionKind.SOURCE_GENERATE_CONSTRUCTORS);\r", "originalCommit": "09fbf80547cfaf9813a31cf8bb413bf1a00d8673", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM0NjE2Mw==", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1405#discussion_r404346163", "bodyText": "Fixed.", "author": "snjeza", "createdAt": "2020-04-06T19:48:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI0NDY4Ng=="}], "type": "inlineReview", "revised_code": {"commit": "f38521a2304b11b011d25c696d7a8b477c765e5f", "chunk": "diff --git a/org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/text/correction/SourceAssistProcessor.java b/org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/text/correction/SourceAssistProcessor.java\nindex 516c73bc..7a73b081 100644\n--- a/org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/text/correction/SourceAssistProcessor.java\n+++ b/org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/text/correction/SourceAssistProcessor.java\n\n@@ -144,7 +154,20 @@ public class SourceAssistProcessor {\n \t\t}\n \n \t\t// Generate Constructors\n-\t\tgenerateConstructors = getGenerateConstructorsAction(params, context, type, JavaCodeActionKind.SOURCE_GENERATE_CONSTRUCTORS);\n+\t\tif (generateConstructors == null) {\n+\t\t\tgenerateConstructors = getGenerateConstructorsAction(params, context, type, JavaCodeActionKind.SOURCE_GENERATE_CONSTRUCTORS);\n+\t\t} else if (generateConstructors.isPresent()) {\n+\t\t\tCommand command = new Command(ActionMessages.GenerateConstructorsAction_ellipsisLabel, COMMAND_ID_ACTION_GENERATECONSTRUCTORSPROMPT, Collections.singletonList(params));\n+\t\t\tif (preferenceManager.getClientPreferences().isSupportedCodeActionKind(JavaCodeActionKind.SOURCE_GENERATE_CONSTRUCTORS)) {\n+\t\t\t\tCodeAction codeAction = new CodeAction(ActionMessages.GenerateConstructorsAction_ellipsisLabel);\n+\t\t\t\tcodeAction.setKind(JavaCodeActionKind.SOURCE_GENERATE_CONSTRUCTORS);\n+\t\t\t\tcodeAction.setCommand(command);\n+\t\t\t\tcodeAction.setDiagnostics(Collections.emptyList());\n+\t\t\t\tgenerateConstructors = Optional.of(Either.forRight(codeAction));\n+\t\t\t} else {\n+\t\t\t\tgenerateConstructors = Optional.of(Either.forLeft(command));\n+\t\t\t}\n+\t\t}\n \t\taddSourceActionCommand($, params.getContext(), generateConstructors);\n \n \t\t// Generate Delegate Methods\n"}}, {"oid": "f38521a2304b11b011d25c696d7a8b477c765e5f", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/f38521a2304b11b011d25c696d7a8b477c765e5f", "message": "Add 'Generate constructor' option to 'Show Fixes' options for fields\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-04-06T19:47:53Z", "type": "commit"}, {"oid": "f38521a2304b11b011d25c696d7a8b477c765e5f", "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/f38521a2304b11b011d25c696d7a8b477c765e5f", "message": "Add 'Generate constructor' option to 'Show Fixes' options for fields\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>", "committedDate": "2020-04-06T19:47:53Z", "type": "forcePushed"}]}