{"pr_number": 716, "pr_title": "feat(sql): Add PostgreSQL test container utils", "pr_createdAt": "2020-07-10T08:55:23Z", "pr_url": "https://github.com/spinnaker/kork/pull/716", "timeline": [{"oid": "be189b59102f9fb02111f46c111ca645d7c76365", "url": "https://github.com/spinnaker/kork/commit/be189b59102f9fb02111f46c111ca645d7c76365", "message": "feat(sql): Add PostgreSQL test container utils", "committedDate": "2020-07-10T08:56:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzAwMDgxMQ==", "url": "https://github.com/spinnaker/kork/pull/716#discussion_r453000811", "bodyText": "When adding @Deprecated annotations, we require javadoc about the deprecation as well, since the annotation on its own isn't very useful.", "author": "robzienert", "createdAt": "2020-07-10T18:18:42Z", "path": "kork-sql-test/src/main/java/com/netflix/spinnaker/kork/sql/test/SqlTestUtil.java", "diffHunk": "@@ -44,16 +44,22 @@\n import org.jooq.impl.DataSourceConnectionProvider;\n import org.jooq.impl.DefaultConfiguration;\n import org.jooq.impl.DefaultDSLContext;\n+import org.testcontainers.containers.JdbcDatabaseContainer;\n import org.testcontainers.containers.MySQLContainer;\n+import org.testcontainers.containers.PostgreSQLContainer;\n \n public class SqlTestUtil {\n \n   public static String tcJdbcUrl = \"jdbc:tc:mysql:5.7.22://somehostname:someport/somedb\";\n \n+  public static String tcPgJdbcUrl = \"jdbc:tc:postgres:10.13:///test\";\n+\n+  @Deprecated", "originalCommit": "be189b59102f9fb02111f46c111ca645d7c76365", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAyODQ2Ng==", "url": "https://github.com/spinnaker/kork/pull/716#discussion_r454028466", "bodyText": "No problem - I've added a short comment to use the TestContainers implementations instead.  Please let me know if you'd prefer more or different detail.", "author": "jcavanagh", "createdAt": "2020-07-14T00:38:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzAwMDgxMQ=="}], "type": "inlineReview", "revised_code": {"commit": "e28bd323bce425ce6e344319c42cca96449bda80", "chunk": "diff --git a/kork-sql-test/src/main/java/com/netflix/spinnaker/kork/sql/test/SqlTestUtil.java b/kork-sql-test/src/main/java/com/netflix/spinnaker/kork/sql/test/SqlTestUtil.java\nindex 4ebff40..c04cf7b 100644\n--- a/kork-sql-test/src/main/java/com/netflix/spinnaker/kork/sql/test/SqlTestUtil.java\n+++ b/kork-sql-test/src/main/java/com/netflix/spinnaker/kork/sql/test/SqlTestUtil.java\n\n@@ -54,11 +54,13 @@ public class SqlTestUtil {\n \n   public static String tcPgJdbcUrl = \"jdbc:tc:postgres:10.13:///test\";\n \n+  /** @deprecated Please use the TestContainers db initializers where possible, instead of H2 */\n   @Deprecated\n   public static TestDatabase initDatabase() {\n     return initDatabase(\"jdbc:h2:mem:test;MODE=MYSQL\");\n   }\n \n+  /** @deprecated Please use the TestContainers db initializers where possible, instead of H2 */\n   @Deprecated\n   public static TestDatabase initPreviousDatabase() {\n     return initDatabase(\"jdbc:h2:mem:test_previous;MODE=MYSQL\");\n"}}, {"oid": "e28bd323bce425ce6e344319c42cca96449bda80", "url": "https://github.com/spinnaker/kork/commit/e28bd323bce425ce6e344319c42cca96449bda80", "message": "feat(sql): Add PostgreSQL test container utils", "committedDate": "2020-07-14T00:36:54Z", "type": "commit"}, {"oid": "e28bd323bce425ce6e344319c42cca96449bda80", "url": "https://github.com/spinnaker/kork/commit/e28bd323bce425ce6e344319c42cca96449bda80", "message": "feat(sql): Add PostgreSQL test container utils", "committedDate": "2020-07-14T00:36:54Z", "type": "forcePushed"}, {"oid": "9ab1da6aecaffe96ade7310bafc233cc097cefb5", "url": "https://github.com/spinnaker/kork/commit/9ab1da6aecaffe96ade7310bafc233cc097cefb5", "message": "Merge branch 'master' into pg-compat-upstream", "committedDate": "2020-07-14T03:31:31Z", "type": "commit"}]}