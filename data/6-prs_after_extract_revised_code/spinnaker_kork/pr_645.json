{"pr_number": 645, "pr_title": "fix(misc): Add package level annotations", "pr_createdAt": "2020-05-12T02:26:05Z", "pr_url": "https://github.com/spinnaker/kork/pull/645", "timeline": [{"oid": "199e01052e44af95d40587a74dcd2d6edee17054", "url": "https://github.com/spinnaker/kork/commit/199e01052e44af95d40587a74dcd2d6edee17054", "message": "fix(misc): Add package level annotations", "committedDate": "2020-05-12T03:47:29Z", "type": "forcePushed"}, {"oid": "e5affa749ee877186aa39b1aabf68aa3b9b8fb76", "url": "https://github.com/spinnaker/kork/commit/e5affa749ee877186aa39b1aabf68aa3b9b8fb76", "message": "fix(misc): Add package level annotations", "committedDate": "2020-05-12T06:58:19Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgxOTM4OA==", "url": "https://github.com/spinnaker/kork/pull/645#discussion_r423819388", "bodyText": "TIL - cool!", "author": "cfieber", "createdAt": "2020-05-12T15:19:11Z", "path": "kork-web/src/main/java/com/netflix/spinnaker/config/package-info.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * Copyright 2020 Netflix, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+@NonNullFields\n+@NonNullApi\n+package com.netflix.spinnaker.config;\n+\n+import org.springframework.lang.NonNullApi;", "originalCommit": "e5affa749ee877186aa39b1aabf68aa3b9b8fb76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgyMDQ4Mg==", "url": "https://github.com/spinnaker/kork/pull/645#discussion_r423820482", "bodyText": "are these assertions true for everything in this package?\ngiven this is the component scanned package that lives in almost every jar in spinnaker, is there any impact to having this package-info.java in this jar?", "author": "cfieber", "createdAt": "2020-05-12T15:20:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgxOTM4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg0MDU0OQ==", "url": "https://github.com/spinnaker/kork/pull/645#discussion_r423840549", "bodyText": "Question: if using spring's NonNullApi + NonNullFields annotations has the same behavior as using the NonNullByDefault annotation that @ezimanyi added to kork-annotations, should we standardize on one or the other?", "author": "maggieneterval", "createdAt": "2020-05-12T15:46:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgxOTM4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg1NDA4MA==", "url": "https://github.com/spinnaker/kork/pull/645#discussion_r423854080", "bodyText": "good point. Standardizing seems like a good idea. I suspect having our own flavor of this annotation is worthwhile so that we can use it when building plugin api modules without forcing a spring-core dependency on those APIs", "author": "cfieber", "createdAt": "2020-05-12T16:05:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgxOTM4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg1NzQ1NA==", "url": "https://github.com/spinnaker/kork/pull/645#discussion_r423857454", "bodyText": "are these assertions true for everything in this package?\ngiven this is the component scanned package that lives in almost every jar in spinnaker, is there any impact to having this package-info.java in this jar?\n\nOops. Verified that IDE applies to all classes with the same package namespace across the entire project.  Removed for com.netflix.spinnaker.config package and left it for the okhttp3 package.", "author": "srekapalli", "createdAt": "2020-05-12T16:10:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgxOTM4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg4MTgzNw==", "url": "https://github.com/spinnaker/kork/pull/645#discussion_r423881837", "bodyText": "Oops. Verified that IDE applies to all classes with the same package namespace across the entire project. Removed for com.netflix.spinnaker.config package and left it for the okhttp3 package.\n\nAh good to know.  I also wonder if it would be applied when in services with the kork-web dependency if the package happens to match?", "author": "jonsie", "createdAt": "2020-05-12T16:46:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgxOTM4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk3MDAxOA==", "url": "https://github.com/spinnaker/kork/pull/645#discussion_r423970018", "bodyText": "Ah good to know. I also wonder if it would be applied when in services with the kork-web dependency if the package happens to match?\n\nYes. It applies for that too. Not sure if that is good or bad ? Although we can relax any of this locally with more specific annotation.", "author": "srekapalli", "createdAt": "2020-05-12T19:10:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgxOTM4OA=="}], "type": "inlineReview", "revised_code": {"commit": "7ae2b73d09237ce2e2bce6fcc3486df673796269", "chunk": "diff --git a/kork-web/src/main/java/com/netflix/spinnaker/config/package-info.java b/kork-web/src/main/java/com/netflix/spinnaker/config/package-info.java\ndeleted file mode 100644\nindex 832498b8..00000000\n--- a/kork-web/src/main/java/com/netflix/spinnaker/config/package-info.java\n+++ /dev/null\n\n@@ -1,22 +0,0 @@\n-/*\n- * Copyright 2020 Netflix, Inc.\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *   http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- *\n- */\n-@NonNullFields\n-@NonNullApi\n-package com.netflix.spinnaker.config;\n-\n-import org.springframework.lang.NonNullApi;\n-import org.springframework.lang.NonNullFields;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgyMjA4MQ==", "url": "https://github.com/spinnaker/kork/pull/645#discussion_r423822081", "bodyText": "I don't know if we have lombok turned on for this packge, and I don't know if lombok was injecting a null-check on javax.annotation.Nonnull (I know it does on lombok.NotNull), but maybe worth adding an Objects.requireNonNull on these assignments", "author": "cfieber", "createdAt": "2020-05-12T15:22:35Z", "path": "kork-web/src/main/java/com/netflix/spinnaker/config/DefaultServiceEndpoint.java", "diffHunk": "@@ -17,18 +17,16 @@\n \n package com.netflix.spinnaker.config;\n \n-import javax.annotation.Nonnull;\n-\n /** Represents a service endpoint URL and name. */\n public class DefaultServiceEndpoint implements ServiceEndpoint {\n \n   /** Name of the service */\n-  @Nonnull private final String name;\n+  private final String name;\n \n   /** Base API url */\n-  @Nonnull private final String baseUrl;\n+  private final String baseUrl;\n \n-  public DefaultServiceEndpoint(@Nonnull String name, @Nonnull String baseUrl) {\n+  public DefaultServiceEndpoint(String name, String baseUrl) {\n     this.name = name;", "originalCommit": "e5affa749ee877186aa39b1aabf68aa3b9b8fb76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg1MzQ2NQ==", "url": "https://github.com/spinnaker/kork/pull/645#discussion_r423853465", "bodyText": "No lombok on this package. Added requireNonNull checks.", "author": "srekapalli", "createdAt": "2020-05-12T16:04:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgyMjA4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "7ae2b73d09237ce2e2bce6fcc3486df673796269", "chunk": "diff --git a/kork-web/src/main/java/com/netflix/spinnaker/config/DefaultServiceEndpoint.java b/kork-web/src/main/java/com/netflix/spinnaker/config/DefaultServiceEndpoint.java\nindex f2b3bff3..7cfb8551 100644\n--- a/kork-web/src/main/java/com/netflix/spinnaker/config/DefaultServiceEndpoint.java\n+++ b/kork-web/src/main/java/com/netflix/spinnaker/config/DefaultServiceEndpoint.java\n\n@@ -17,6 +17,10 @@\n \n package com.netflix.spinnaker.config;\n \n+import java.util.Objects;\n+import javax.annotation.Nonnull;\n+import org.springframework.lang.NonNull;\n+\n /** Represents a service endpoint URL and name. */\n public class DefaultServiceEndpoint implements ServiceEndpoint {\n \n"}}, {"oid": "7ae2b73d09237ce2e2bce6fcc3486df673796269", "url": "https://github.com/spinnaker/kork/commit/7ae2b73d09237ce2e2bce6fcc3486df673796269", "message": "fix(misc): Add package level annotations", "committedDate": "2020-05-12T16:04:59Z", "type": "forcePushed"}, {"oid": "65018664b21a8d74a45a6ee9509611d3dcffccc3", "url": "https://github.com/spinnaker/kork/commit/65018664b21a8d74a45a6ee9509611d3dcffccc3", "message": "fix(misc): Add package level annotations", "committedDate": "2020-05-12T16:17:53Z", "type": "forcePushed"}, {"oid": "3a1dad0529447d6b4c7c0d0fb65340ca3e71c6cd", "url": "https://github.com/spinnaker/kork/commit/3a1dad0529447d6b4c7c0d0fb65340ca3e71c6cd", "message": "fix(misc): Add package level annotations", "committedDate": "2020-05-12T16:21:19Z", "type": "forcePushed"}, {"oid": "a02364e4b4e45c3fb1a86bc4dece88f977ad2a57", "url": "https://github.com/spinnaker/kork/commit/a02364e4b4e45c3fb1a86bc4dece88f977ad2a57", "message": "fix(misc): Add package level annotations", "committedDate": "2020-05-12T16:23:33Z", "type": "commit"}, {"oid": "a02364e4b4e45c3fb1a86bc4dece88f977ad2a57", "url": "https://github.com/spinnaker/kork/commit/a02364e4b4e45c3fb1a86bc4dece88f977ad2a57", "message": "fix(misc): Add package level annotations", "committedDate": "2020-05-12T16:23:33Z", "type": "forcePushed"}, {"oid": "ffbb3a5c62bdfbf3ad3860147df8f9a252f0daa7", "url": "https://github.com/spinnaker/kork/commit/ffbb3a5c62bdfbf3ad3860147df8f9a252f0daa7", "message": "Merge branch 'master' into pkg_annotation", "committedDate": "2020-05-12T19:31:55Z", "type": "commit"}]}