{"pr_number": 5271, "pr_title": "test: add group by test to ensure useful error on unknown function", "pr_createdAt": "2020-05-05T16:56:54Z", "pr_url": "https://github.com/confluentinc/ksql/pull/5271", "timeline": [{"oid": "28a8c8cce2a55334eb308a6539ef740e372e8dc7", "url": "https://github.com/confluentinc/ksql/commit/28a8c8cce2a55334eb308a6539ef740e372e8dc7", "message": "test: add group by test to ensure useful error on unknown function\n\nfixes: https://github.com/confluentinc/ksql/issues/5114\n\nAdded test to ensure the latest version of ksqlDb gives a meaningful error message if an unknown function is called with a non-aggregate select expression.  Previous versions failed with somewhat confusing error e.g.\n\n```\nNon-aggregate SELECT expression(s) not part of GROUP BY: [WONT_FIND_ME(ID)]\n```\n\nNow fails with:\n\n```\nCan't find any functions with the name 'WONT_FIND_ME'\n```", "committedDate": "2020-05-05T16:56:18Z", "type": "commit"}, {"oid": "3e5ae1d18291da3ff857ffec5d2061fdecda0cdd", "url": "https://github.com/confluentinc/ksql/commit/3e5ae1d18291da3ff857ffec5d2061fdecda0cdd", "message": "test: add tests covering non-table UDAFs used on tables", "committedDate": "2020-05-05T17:13:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI3MzY2MA==", "url": "https://github.com/confluentinc/ksql/pull/5271#discussion_r420273660", "bodyText": "Note: poached from #5257, which includes tests for the new class.", "author": "big-andy-coates", "createdAt": "2020-05-05T17:14:07Z", "path": "ksqldb-common/src/main/java/io/confluent/ksql/util/GrammaticalJoiner.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.util;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+import java.util.Iterator;\n+import java.util.Objects;\n+import java.util.stream.Stream;\n+\n+/**\n+ * An object which joins pieces of text, with a separator and additional final word, allowing more\n+ * grammatically correct joining, e,g. \"a, b, c or d\".\n+ */\n+public final class GrammaticalJoiner {", "originalCommit": "3e5ae1d18291da3ff857ffec5d2061fdecda0cdd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "24a193c792aceabf1b47f1d0788115acdf0feb9e", "chunk": "diff --git a/ksqldb-common/src/main/java/io/confluent/ksql/util/GrammaticalJoiner.java b/ksqldb-common/src/main/java/io/confluent/ksql/util/GrammaticalJoiner.java\nindex ce9f041644..f81b438ae5 100644\n--- a/ksqldb-common/src/main/java/io/confluent/ksql/util/GrammaticalJoiner.java\n+++ b/ksqldb-common/src/main/java/io/confluent/ksql/util/GrammaticalJoiner.java\n\n@@ -75,4 +75,4 @@ public final class GrammaticalJoiner {\n \n     return builder.toString();\n   }\n-}\n\\ No newline at end of file\n+}\n"}}, {"oid": "24a193c792aceabf1b47f1d0788115acdf0feb9e", "url": "https://github.com/confluentinc/ksql/commit/24a193c792aceabf1b47f1d0788115acdf0feb9e", "message": "chore: merge from master\n\nConflicting files\nksqldb-common/src/main/java/io/confluent/ksql/util/GrammaticalJoiner.java\nksqldb-functional-tests/src/test/resources/query-validation-tests/group-by.json", "committedDate": "2020-05-06T17:20:06Z", "type": "commit"}]}