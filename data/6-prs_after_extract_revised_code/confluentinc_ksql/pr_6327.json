{"pr_number": 6327, "pr_title": "chore: ensure CLI works with other key formats", "pr_createdAt": "2020-09-30T18:29:13Z", "pr_url": "https://github.com/confluentinc/ksql/pull/6327", "timeline": [{"oid": "19ff4272c7e3008c0364888333a26da073d2c203", "url": "https://github.com/confluentinc/ksql/commit/19ff4272c7e3008c0364888333a26da073d2c203", "message": "chore: ensure CLI works with other key formats\n\nfixes: https://github.com/confluentinc/ksql/issues/6218\n\nUpdates a few places in the rest api, cli and the new Java client to specify the key format as well as the value format.\n\nUnfortunately, the value format was called `format`.  This change introduces a `keyFormat` and `valueFormat` to hold the two formats, but both the CLI and new Java client are backwards compatible with the old JSON schema.\n\nAlso in this commit, streams also indicate if there key is windowed.  This means the key is serialized using the windowed serializer. It is possible to have a stream over a topic with a windowed key. Now the CLI and Java client expose this info.\n\nMain change was to `show tables` and `show streams` response.  Previously, these returned\n\n```\nksql> show streams;\n\n Stream Name | Kafka Topic | Format\n---------------------------------------\n PAGEVIEWS   | pageviews   | DELIMITED\n---------------------------------------\n\nksql> show tables;\n\n Table Name | Kafka Topic | Format | Windowed\n----------------------------------------------\n USERS      | users       | JSON   | false\n----------------------------------------------\n```\n\nAnd now return:\n\n```\nksql> show streams;\n\n Stream Name | Kafka Topic | Key Format | Value Format | Windowed\n-----------------------------------------------------------------\n PAGEVIEWS   | pageviews   | KAFKA      | DELIMITED    | false\n-----------------------------------------------------------------\n\nksql> show tables;\n\n Table Name | Kafka Topic | Key Format | Value Format | Windowed\n----------------------------------------------------------------\n USERS      | users       | KAFKA      | JSON          | false\n----------------------------------------------------------------\n```", "committedDate": "2020-09-30T18:28:05Z", "type": "commit"}, {"oid": "12d0728b23019c2878b0d8a9c11e8e5c770b74e2", "url": "https://github.com/confluentinc/ksql/commit/12d0728b23019c2878b0d8a9c11e8e5c770b74e2", "message": "chore: fix test", "committedDate": "2020-10-01T09:13:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE5MzI4Mg==", "url": "https://github.com/confluentinc/ksql/pull/6327#discussion_r498193282", "bodyText": "This is a public API. Should we leave it here and mark as deprecated, to be removed in a future release?", "author": "vcrfxia", "createdAt": "2020-10-01T12:08:32Z", "path": "ksqldb-api-client/src/main/java/io/confluent/ksql/api/client/impl/StreamInfoImpl.java", "diffHunk": "@@ -41,8 +51,18 @@ public String getTopic() {\n   }\n \n   @Override\n-  public String getFormat() {", "originalCommit": "12d0728b23019c2878b0d8a9c11e8e5c770b74e2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE5ODA4Nw==", "url": "https://github.com/confluentinc/ksql/pull/6327#discussion_r498198087", "bodyText": "My personal view is no, I think the Java client is new enough we can get away with just changing this. People will get a compilation error and will just switch to the new method. But... we don't actually have a defined policy for this yet.", "author": "big-andy-coates", "createdAt": "2020-10-01T12:17:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE5MzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIxMTk1Ng==", "url": "https://github.com/confluentinc/ksql/pull/6327#discussion_r498211956", "bodyText": "Meh... done.", "author": "big-andy-coates", "createdAt": "2020-10-01T12:40:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE5MzI4Mg=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE5MzMyOA==", "url": "https://github.com/confluentinc/ksql/pull/6327#discussion_r498193328", "bodyText": "As above.", "author": "vcrfxia", "createdAt": "2020-10-01T12:08:37Z", "path": "ksqldb-api-client/src/main/java/io/confluent/ksql/api/client/impl/TableInfoImpl.java", "diffHunk": "@@ -48,13 +51,18 @@ public String getTopic() {\n   }\n \n   @Override\n-  public String getFormat() {", "originalCommit": "12d0728b23019c2878b0d8a9c11e8e5c770b74e2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "efb66c5b9f5437da162c35305d676ae0a0ea0075", "url": "https://github.com/confluentinc/ksql/commit/efb66c5b9f5437da162c35305d676ae0a0ea0075", "message": "chore: add back deprecated methods", "committedDate": "2020-10-01T12:39:57Z", "type": "commit"}]}