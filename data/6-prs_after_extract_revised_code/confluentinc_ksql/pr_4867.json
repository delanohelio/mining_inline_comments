{"pr_number": 4867, "pr_title": "fix: avoid long possible format lists on PRINT TOPIC for nulls", "pr_createdAt": "2020-03-23T12:53:49Z", "pr_url": "https://github.com/confluentinc/ksql/pull/4867", "timeline": [{"oid": "c14dfdc0906f4adbc4107f06b9d0f33fdbb053fb", "url": "https://github.com/confluentinc/ksql/commit/c14dfdc0906f4adbc4107f06b9d0f33fdbb053fb", "message": "fix: avoid long possible format lists on PRINT TOPIC for nulls\n\nfixes: https://github.com/confluentinc/ksql/issues/4852\n\nIf processing data with NULL key or values, (generally keys), then PRINT TOPIC would output a long list of possible formats for the key, i.e. ALL the possible formats for the key.  This isn't really very useful.\n\nThe cause was that no data had been processed, so no formats had been rejected.\n\nThis commit changes the behaviour in the situation where no data has been processed to output a shorter message, for example:\n\n```\nksql> print Topic_with_null_keys from beginning;\nKey format: \u00af\\_(\u30c4)_/\u00af - no data processed\nValue format: JSON or KAFKA_STRING\nrowtime: 23/03/20 12:45:33 GMT, key: <null>, value: {\"NAME\": \"bob\"}\n```", "committedDate": "2020-03-23T12:53:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUxNzk1NQ==", "url": "https://github.com/confluentinc/ksql/pull/4867#discussion_r396517955", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return ImmutableList.of(\"\u00af\\\\_(\u30c4)_/\u00af - no data processed\");\n          \n          \n            \n                    return ImmutableList.of(\"\u00af\\\\_(\u30c4)_/\u00af - undetermined key format (no data processed)\");", "author": "agavra", "createdAt": "2020-03-23T15:02:28Z", "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/rest/server/resources/streaming/RecordFormatter.java", "diffHunk": "@@ -232,6 +234,10 @@ private String formatRowTime(final long timestamp) {\n     }\n \n     List<String> getPossibleFormats() {\n+      if (!seenData) {\n+        return ImmutableList.of(\"\u00af\\\\_(\u30c4)_/\u00af - no data processed\");", "originalCommit": "c14dfdc0906f4adbc4107f06b9d0f33fdbb053fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjYzMTY4OQ==", "url": "https://github.com/confluentinc/ksql/pull/4867#discussion_r396631689", "bodyText": "Feel strongly about this?", "author": "big-andy-coates", "createdAt": "2020-03-23T17:34:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUxNzk1NQ=="}], "type": "inlineReview", "revised_code": null}]}