{"pr_number": 4246, "pr_title": "chore: ensure sensible error on use of unsupported primitive key type", "pr_createdAt": "2020-01-08T10:48:11Z", "pr_url": "https://github.com/confluentinc/ksql/pull/4246", "timeline": [{"oid": "ed0e90a8de51bf9c0095befb42661dd7f856aad4", "url": "https://github.com/confluentinc/ksql/commit/ed0e90a8de51bf9c0095befb42661dd7f856aad4", "message": "chore: ensure sensible error on use of unsupported primitive key type\n\nfixes: https://github.com/confluentinc/ksql/issues/4113\n\nAdded QTT tests to ensure sensible error messages are output from `CT`/`CS` and `CTAS`/`CSAS` statements where the key format, (currently always `KAFKA`), does not support the Sql type of the key column, e.g. the `KAFKA` format does not support `BOOLEAN`, `DECIMAL`, `MAP`, ARRAY` or `STRUCT` types.\n\nError message will look something like:\n\n```\nKey format does not support key schema.\nformat: KAFKA\nschema: Persistence{schema=STRUCT<ROWKEY MAP<VARCHAR, INT>> NOT NULL, unwrapped=false}\nreason: The 'KAFKA' format does not support type 'MAP'\n```", "committedDate": "2020-01-08T10:47:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDU3MDg1OA==", "url": "https://github.com/confluentinc/ksql/pull/4246#discussion_r364570858", "bodyText": "why'd we need to add this?", "author": "rodesai", "createdAt": "2020-01-09T06:02:52Z", "path": "ksql-common/src/test/java/io/confluent/ksql/serde/FormatInfoTest.java", "diffHunk": "@@ -30,6 +30,7 @@\n import org.junit.Test;\n import org.junit.rules.ExpectedException;\n \n+@SuppressWarnings(\"UnstableApiUsage\")", "originalCommit": "ed0e90a8de51bf9c0095befb42661dd7f856aad4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDc1NTY4MA==", "url": "https://github.com/confluentinc/ksql/pull/4246#discussion_r364755680", "bodyText": "Gets rid of warnings in the IDE.", "author": "big-andy-coates", "createdAt": "2020-01-09T14:06:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDU3MDg1OA=="}], "type": "inlineReview", "revised_code": null}]}