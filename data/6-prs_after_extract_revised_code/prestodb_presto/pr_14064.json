{"pr_number": 14064, "pr_title": "Add join pushdown predicate at the end of the exisiting predicate", "pr_createdAt": "2020-02-05T23:55:05Z", "pr_url": "https://github.com/prestodb/presto/pull/14064", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4MDc4MA==", "url": "https://github.com/prestodb/presto/pull/14064#discussion_r375580780", "bodyText": "nit: space is missing after //\nnit: wrong capitalization of KEYS and CARDINALITY\nthe query can be simplified and the check can be stronger\n\n        // filter functions with join predicate pushdown\n        assertQueryReturnsEmptyResult(\"SELECT * FROM orders o, lineitem_ex l \" +\n                \"WHERE o.orderkey <> 100 AND cardinality(l.keys) >= 5 AND l.keys[5] <> 1 AND l.keys[5] = o.orderkey\");", "author": "mbasmanova", "createdAt": "2020-02-06T00:17:55Z", "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHivePushdownFilterQueries.java", "diffHunk": "@@ -729,6 +729,9 @@ public void testFilterFunctions()\n         // filter function on numeric and boolean columns\n         assertFilterProject(\"if(is_returned, linenumber, orderkey) % 5 = 0\", \"linenumber\");\n \n+        //filter functions with join predicate pushdown", "originalCommit": "01f36c945fc179978133814bcd53a80d53b7d767", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ebe41896b32a7c41cfda031f790baa7c0707b078", "chunk": "diff --git a/presto-hive/src/test/java/com/facebook/presto/hive/TestHivePushdownFilterQueries.java b/presto-hive/src/test/java/com/facebook/presto/hive/TestHivePushdownFilterQueries.java\nindex f4b9926417..0e2848d060 100644\n--- a/presto-hive/src/test/java/com/facebook/presto/hive/TestHivePushdownFilterQueries.java\n+++ b/presto-hive/src/test/java/com/facebook/presto/hive/TestHivePushdownFilterQueries.java\n\n@@ -729,8 +729,9 @@ public class TestHivePushdownFilterQueries\n         // filter function on numeric and boolean columns\n         assertFilterProject(\"if(is_returned, linenumber, orderkey) % 5 = 0\", \"linenumber\");\n \n-        //filter functions with join predicate pushdown\n-        assertQuerySucceeds(\"SELECT * FROM ( ( SELECT * FROM orders WHERE orderkey <> 100 ) T1 INNER JOIN ( SELECT * FROM lineitem_ex WHERE CARDINALITY(KEYS) >= 5 AND KEYS[5] <> 1 ) T2 ON (T2.keys[5] = T1.orderkey) )\") ;\n+        // filter functions with join predicate pushdown\n+        assertQueryReturnsEmptyResult(\"SELECT * FROM orders o, lineitem_ex l \" +\n+                \"WHERE o.orderkey <> 100 AND cardinality(l.keys) >= 5 AND l.keys[5] <> 1 AND l.keys[5] = o.orderkey\");\n \n         // filter functions on array columns\n         assertFilterProject(\"keys[1] % 5 = 0\", \"orderkey\");\n"}}, {"oid": "ebe41896b32a7c41cfda031f790baa7c0707b078", "url": "https://github.com/prestodb/presto/commit/ebe41896b32a7c41cfda031f790baa7c0707b078", "message": "Add join pushdown predicate at the end of the exisiting predicate", "committedDate": "2020-02-06T00:38:03Z", "type": "commit"}, {"oid": "ebe41896b32a7c41cfda031f790baa7c0707b078", "url": "https://github.com/prestodb/presto/commit/ebe41896b32a7c41cfda031f790baa7c0707b078", "message": "Add join pushdown predicate at the end of the exisiting predicate", "committedDate": "2020-02-06T00:38:03Z", "type": "forcePushed"}]}