{"pr_number": 14601, "pr_title": "Adding Task State to RunningSplitInfo", "pr_createdAt": "2020-06-03T18:29:44Z", "pr_url": "https://github.com/prestodb/presto/pull/14601", "timeline": [{"oid": "5d8127876e4256828b319d0c6656b4fbc3550c38", "url": "https://github.com/prestodb/presto/commit/5d8127876e4256828b319d0c6656b4fbc3550c38", "message": "Adding Task State to RunningSplitInfo\n\nIt was observed that there was a long running split\nafter the query was abandoned/cancelled. Adding the\ntask state info to do better troubleshooting.", "committedDate": "2020-06-03T18:30:31Z", "type": "forcePushed"}, {"oid": "797abc72330656961e2519765d070f51ab93989c", "url": "https://github.com/prestodb/presto/commit/797abc72330656961e2519765d070f51ab93989c", "message": "Adding Task State to RunningSplitInfo\n\nIt was observed that there was a long running split\nafter the query was abandoned/cancelled. Adding the\ntask state info to do better troubleshooting.", "committedDate": "2020-06-03T20:00:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1NTgzMA==", "url": "https://github.com/prestodb/presto/pull/14601#discussion_r434955830", "bodyText": "final and put it before printed", "author": "highker", "createdAt": "2020-06-04T02:23:53Z", "path": "presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java", "diffHunk": "@@ -898,13 +898,15 @@ public long getRunAwaySplitCount()\n         private final String threadId;\n         private final Thread thread;\n         private boolean printed;\n+        private PrioritizedSplitRunner split;", "originalCommit": "797abc72330656961e2519765d070f51ab93989c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9dc63184c729cae94aaa50a304d83221b58acfa9", "chunk": "diff --git a/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java b/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java\nindex ff9e015fbc..552567274a 100644\n--- a/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java\n+++ b/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java\n\n@@ -897,10 +897,10 @@ public class TaskExecutor\n         private final long startTime;\n         private final String threadId;\n         private final Thread thread;\n+        private final PrioritizedSplitRunner split;\n         private boolean printed;\n-        private PrioritizedSplitRunner split;\n \n-        public RunningSplitInfo(long startTime, Thread thread, String threadId, PrioritizedSplitRunner split)\n+        public RunningSplitInfo(long startTime, String threadId, Thread thread, PrioritizedSplitRunner split)\n         {\n             this.startTime = startTime;\n             this.threadId = threadId;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1NTkwMg==", "url": "https://github.com/prestodb/presto/pull/14601#discussion_r434955902", "bodyText": "Keep the same param order as the ones on stack", "author": "highker", "createdAt": "2020-06-04T02:24:08Z", "path": "presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java", "diffHunk": "@@ -898,13 +898,15 @@ public long getRunAwaySplitCount()\n         private final String threadId;\n         private final Thread thread;\n         private boolean printed;\n+        private PrioritizedSplitRunner split;\n \n-        public RunningSplitInfo(long startTime, String threadId, Thread thread)\n+        public RunningSplitInfo(long startTime, Thread thread, String threadId, PrioritizedSplitRunner split)", "originalCommit": "797abc72330656961e2519765d070f51ab93989c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9dc63184c729cae94aaa50a304d83221b58acfa9", "chunk": "diff --git a/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java b/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java\nindex ff9e015fbc..552567274a 100644\n--- a/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java\n+++ b/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java\n\n@@ -897,10 +897,10 @@ public class TaskExecutor\n         private final long startTime;\n         private final String threadId;\n         private final Thread thread;\n+        private final PrioritizedSplitRunner split;\n         private boolean printed;\n-        private PrioritizedSplitRunner split;\n \n-        public RunningSplitInfo(long startTime, Thread thread, String threadId, PrioritizedSplitRunner split)\n+        public RunningSplitInfo(long startTime, String threadId, Thread thread, PrioritizedSplitRunner split)\n         {\n             this.startTime = startTime;\n             this.threadId = threadId;\n"}}, {"oid": "9dc63184c729cae94aaa50a304d83221b58acfa9", "url": "https://github.com/prestodb/presto/commit/9dc63184c729cae94aaa50a304d83221b58acfa9", "message": "Adding Task State to RunningSplitInfo\n\nIt was observed that there was a long running split\nafter the query was abandoned/cancelled. Adding the\ntask state info to do better troubleshooting.", "committedDate": "2020-06-04T03:23:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk4OTQ0OA==", "url": "https://github.com/prestodb/presto/pull/14601#discussion_r434989448", "bodyText": "move this above this.printed = false; to align with stack order", "author": "highker", "createdAt": "2020-06-04T04:44:19Z", "path": "presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java", "diffHunk": "@@ -897,14 +897,16 @@ public long getRunAwaySplitCount()\n         private final long startTime;\n         private final String threadId;\n         private final Thread thread;\n+        private final PrioritizedSplitRunner split;\n         private boolean printed;\n \n-        public RunningSplitInfo(long startTime, String threadId, Thread thread)\n+        public RunningSplitInfo(long startTime, String threadId, Thread thread, PrioritizedSplitRunner split)\n         {\n             this.startTime = startTime;\n             this.threadId = threadId;\n             this.thread = thread;\n             this.printed = false;\n+            this.split = split;", "originalCommit": "9dc63184c729cae94aaa50a304d83221b58acfa9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxMTMzNA==", "url": "https://github.com/prestodb/presto/pull/14601#discussion_r435411334", "bodyText": "done", "author": "cemcayiroglu", "createdAt": "2020-06-04T17:02:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk4OTQ0OA=="}], "type": "inlineReview", "revised_code": {"commit": "0ae11c15a476d0c3e823328bdb1542905e7a1695", "chunk": "diff --git a/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java b/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java\nindex 552567274a..834393e977 100644\n--- a/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java\n+++ b/presto-main/src/main/java/com/facebook/presto/execution/executor/TaskExecutor.java\n\n@@ -905,8 +905,8 @@ public class TaskExecutor\n             this.startTime = startTime;\n             this.threadId = threadId;\n             this.thread = thread;\n-            this.printed = false;\n             this.split = split;\n+            this.printed = false;\n         }\n \n         public long getStartTime()\n"}}, {"oid": "0ae11c15a476d0c3e823328bdb1542905e7a1695", "url": "https://github.com/prestodb/presto/commit/0ae11c15a476d0c3e823328bdb1542905e7a1695", "message": "Adding Task State to RunningSplitInfo\n\nIt was observed that there was a long running split\nafter the query was abandoned/cancelled. Adding the\ntask state info to do better troubleshooting.", "committedDate": "2020-06-04T17:01:18Z", "type": "forcePushed"}, {"oid": "6a87abff08c3920d8423280c444f6724a1fbb081", "url": "https://github.com/prestodb/presto/commit/6a87abff08c3920d8423280c444f6724a1fbb081", "message": "Adding Task State to RunningSplitInfo\n\nIt was observed that there was a long running split\nafter the query was abandoned/cancelled. Adding the\ntask state info to do better troubleshooting.", "committedDate": "2020-06-05T04:00:52Z", "type": "commit"}, {"oid": "6a87abff08c3920d8423280c444f6724a1fbb081", "url": "https://github.com/prestodb/presto/commit/6a87abff08c3920d8423280c444f6724a1fbb081", "message": "Adding Task State to RunningSplitInfo\n\nIt was observed that there was a long running split\nafter the query was abandoned/cancelled. Adding the\ntask state info to do better troubleshooting.", "committedDate": "2020-06-05T04:00:52Z", "type": "forcePushed"}]}