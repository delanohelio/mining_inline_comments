{"pr_number": 14203, "pr_title": "Allow column pruning in SHOW STATS", "pr_createdAt": "2020-03-04T01:14:25Z", "pr_url": "https://github.com/prestodb/presto/pull/14203", "timeline": [{"oid": "e5c2f1563f86b5349911d77b721bc91260ef96b6", "url": "https://github.com/prestodb/presto/commit/e5c2f1563f86b5349911d77b721bc91260ef96b6", "message": "Allow column pruning in SHOW STATS", "committedDate": "2020-03-04T01:09:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk0MjE2MQ==", "url": "https://github.com/prestodb/presto/pull/14203#discussion_r387942161", "bodyText": "nit:  break?", "author": "arhimondr", "createdAt": "2020-03-04T21:22:49Z", "path": "presto-main/src/main/java/com/facebook/presto/sql/rewrite/ShowStatsRewrite.java", "diffHunk": "@@ -158,14 +163,32 @@ private void validateShowStatsSubquery(ShowStats node, Query query, QuerySpecifi\n             check(!querySpecification.getGroupBy().isPresent(), node, \"GROUP BY is not supported in SHOW STATS SELECT clause\");\n             check(!querySpecification.getSelect().isDistinct(), node, \"DISTINCT is not supported by SHOW STATS SELECT clause\");\n \n+            ImmutableSet.Builder<String> columnsBuilder = ImmutableSet.builder();\n+            boolean allColumns = false;\n             List<SelectItem> selectItems = querySpecification.getSelect().getSelectItems();\n-            check(selectItems.size() == 1 && selectItems.get(0) instanceof AllColumns, node, \"Only SELECT * is supported in SHOW STATS SELECT clause\");\n+            for (SelectItem selectItem : selectItems) {\n+                if (selectItem instanceof AllColumns) {\n+                    allColumns = true;\n+                    continue;", "originalCommit": "e5c2f1563f86b5349911d77b721bc91260ef96b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk2MjU5Mg==", "url": "https://github.com/prestodb/presto/pull/14203#discussion_r387962592", "bodyText": "@arhimondr I'm using continue to make sure I check all the selectItems, e.g. I want the following query to fail:\nSHOW STATS FOR (SELECT *, nationkey + 1 FROM nation)", "author": "mbasmanova", "createdAt": "2020-03-04T22:04:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk0MjE2MQ=="}], "type": "inlineReview", "revised_code": null}]}