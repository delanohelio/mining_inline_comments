{"pr_number": 14435, "pr_title": "Add session property for druid connector", "pr_createdAt": "2020-04-25T00:04:25Z", "pr_url": "https://github.com/prestodb/presto/pull/14435", "timeline": [{"oid": "e56fe8a2a73b2a28aca63e19a8f319b8b912593c", "url": "https://github.com/prestodb/presto/commit/e56fe8a2a73b2a28aca63e19a8f319b8b912593c", "message": "Add session property for druid connector", "committedDate": "2020-04-25T00:42:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM4NjEzMQ==", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415386131", "bodyText": "compute_pushdown_enabled", "author": "highker", "createdAt": "2020-04-26T19:48:07Z", "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.facebook.presto.druid;\n+\n+import com.facebook.presto.spi.ConnectorSession;\n+import com.facebook.presto.spi.session.PropertyMetadata;\n+import com.google.common.collect.ImmutableList;\n+\n+import javax.inject.Inject;\n+\n+import java.util.List;\n+\n+import static com.facebook.presto.spi.session.PropertyMetadata.booleanProperty;\n+\n+public class DruidSessionProperties\n+{\n+    private static final String PUSHDOWN = \"pushdown\";", "originalCommit": "e56fe8a2a73b2a28aca63e19a8f319b8b912593c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d99e4e57830451ee7968b061373299dcc7d24356", "chunk": "diff --git a/presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java b/presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java\nindex b14cd1d8fd..04a8968673 100644\n--- a/presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java\n+++ b/presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java\n\n@@ -26,13 +26,13 @@ import static com.facebook.presto.spi.session.PropertyMetadata.booleanProperty;\n \n public class DruidSessionProperties\n {\n-    private static final String PUSHDOWN = \"pushdown\";\n+    private static final String COMPUTE_PUSHDOWN = \"compute_pushdown_enabled\";\n \n     private final List<PropertyMetadata<?>> sessionProperties;\n \n     public static boolean isPushdown(ConnectorSession session)\n     {\n-        return session.getProperty(PUSHDOWN, Boolean.class);\n+        return session.getProperty(COMPUTE_PUSHDOWN, Boolean.class);\n     }\n \n     @Inject\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM4NjI5Ng==", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415386296", "bodyText": "druid.compute-pushdown-enabled", "author": "highker", "createdAt": "2020-04-26T19:49:02Z", "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java", "diffHunk": "@@ -65,4 +66,17 @@ public DruidConfig setDruidSchema(String schema)\n         this.schema = schema;\n         return this;\n     }\n+\n+    public boolean getPushdown()\n+    {\n+        return pushdown;\n+    }\n+\n+    @Config(\"druid.pushdown\")", "originalCommit": "e56fe8a2a73b2a28aca63e19a8f319b8b912593c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d99e4e57830451ee7968b061373299dcc7d24356", "chunk": "diff --git a/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java b/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java\nindex 31f32194d6..b6c88bb5c9 100644\n--- a/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java\n+++ b/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java\n\n@@ -72,7 +72,7 @@ public class DruidConfig\n         return pushdown;\n     }\n \n-    @Config(\"druid.pushdown\")\n+    @Config(\"druid.compute-pushdown-enabled\")\n     @ConfigDescription(\"pushdown query processing to druid\")\n     public DruidConfig setPushdown(boolean pushdown)\n     {\n"}}, {"oid": "d99e4e57830451ee7968b061373299dcc7d24356", "url": "https://github.com/prestodb/presto/commit/d99e4e57830451ee7968b061373299dcc7d24356", "message": "Add session property for druid connector", "committedDate": "2020-04-26T21:12:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwNzc1Ng==", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415407756", "bodyText": "isComputePushdownEnabled", "author": "highker", "createdAt": "2020-04-26T21:43:43Z", "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java", "diffHunk": "@@ -65,4 +66,17 @@ public DruidConfig setDruidSchema(String schema)\n         this.schema = schema;\n         return this;\n     }\n+\n+    public boolean getPushdown()", "originalCommit": "d99e4e57830451ee7968b061373299dcc7d24356", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7c458389246663d553eb1b154bd46e10bfa6218d", "chunk": "diff --git a/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java b/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java\nindex b6c88bb5c9..6958018711 100644\n--- a/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java\n+++ b/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java\n\n@@ -67,14 +67,14 @@ public class DruidConfig\n         return this;\n     }\n \n-    public boolean getPushdown()\n+    public boolean isComputePushdownEnabled()\n     {\n         return pushdown;\n     }\n \n     @Config(\"druid.compute-pushdown-enabled\")\n     @ConfigDescription(\"pushdown query processing to druid\")\n-    public DruidConfig setPushdown(boolean pushdown)\n+    public DruidConfig setComputePushdownEnabled(boolean pushdown)\n     {\n         this.pushdown = pushdown;\n         return this;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwNzc5MQ==", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415407791", "bodyText": "setComputePushdownEnabled", "author": "highker", "createdAt": "2020-04-26T21:43:50Z", "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java", "diffHunk": "@@ -65,4 +66,17 @@ public DruidConfig setDruidSchema(String schema)\n         this.schema = schema;\n         return this;\n     }\n+\n+    public boolean getPushdown()\n+    {\n+        return pushdown;\n+    }\n+\n+    @Config(\"druid.compute-pushdown-enabled\")\n+    @ConfigDescription(\"pushdown query processing to druid\")\n+    public DruidConfig setPushdown(boolean pushdown)", "originalCommit": "d99e4e57830451ee7968b061373299dcc7d24356", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7c458389246663d553eb1b154bd46e10bfa6218d", "chunk": "diff --git a/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java b/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java\nindex b6c88bb5c9..6958018711 100644\n--- a/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java\n+++ b/presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java\n\n@@ -67,14 +67,14 @@ public class DruidConfig\n         return this;\n     }\n \n-    public boolean getPushdown()\n+    public boolean isComputePushdownEnabled()\n     {\n         return pushdown;\n     }\n \n     @Config(\"druid.compute-pushdown-enabled\")\n     @ConfigDescription(\"pushdown query processing to druid\")\n-    public DruidConfig setPushdown(boolean pushdown)\n+    public DruidConfig setComputePushdownEnabled(boolean pushdown)\n     {\n         this.pushdown = pushdown;\n         return this;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwNzg2Ng==", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415407866", "bodyText": "same", "author": "highker", "createdAt": "2020-04-26T21:44:18Z", "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.facebook.presto.druid;\n+\n+import com.facebook.presto.spi.ConnectorSession;\n+import com.facebook.presto.spi.session.PropertyMetadata;\n+import com.google.common.collect.ImmutableList;\n+\n+import javax.inject.Inject;\n+\n+import java.util.List;\n+\n+import static com.facebook.presto.spi.session.PropertyMetadata.booleanProperty;\n+\n+public class DruidSessionProperties\n+{\n+    private static final String COMPUTE_PUSHDOWN = \"compute_pushdown_enabled\";\n+\n+    private final List<PropertyMetadata<?>> sessionProperties;\n+\n+    public static boolean isPushdown(ConnectorSession session)", "originalCommit": "d99e4e57830451ee7968b061373299dcc7d24356", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7c458389246663d553eb1b154bd46e10bfa6218d", "chunk": "diff --git a/presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java b/presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java\nindex 04a8968673..b717ff69a8 100644\n--- a/presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java\n+++ b/presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java\n\n@@ -30,7 +30,7 @@ public class DruidSessionProperties\n \n     private final List<PropertyMetadata<?>> sessionProperties;\n \n-    public static boolean isPushdown(ConnectorSession session)\n+    public static boolean isComputePushdownEnabled(ConnectorSession session)\n     {\n         return session.getProperty(COMPUTE_PUSHDOWN, Boolean.class);\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwNzkzMw==", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415407933", "bodyText": "need to change as well", "author": "highker", "createdAt": "2020-04-26T21:44:37Z", "path": "presto-druid/src/test/java/com/facebook/presto/druid/TestDruidConfig.java", "diffHunk": "@@ -40,12 +41,14 @@ public void testExplicitPropertyMappings()\n                 .put(\"druid.broker-url\", \"http://druid.broker:1234\")\n                 .put(\"druid.coordinator-url\", \"http://druid.coordinator:4321\")\n                 .put(\"druid.schema-name\", \"test\")\n+                .put(\"druid.pushdown\", \"true\")", "originalCommit": "d99e4e57830451ee7968b061373299dcc7d24356", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7c458389246663d553eb1b154bd46e10bfa6218d", "chunk": "diff --git a/presto-druid/src/test/java/com/facebook/presto/druid/TestDruidConfig.java b/presto-druid/src/test/java/com/facebook/presto/druid/TestDruidConfig.java\nindex 5364e84fec..c4cfc00e3d 100644\n--- a/presto-druid/src/test/java/com/facebook/presto/druid/TestDruidConfig.java\n+++ b/presto-druid/src/test/java/com/facebook/presto/druid/TestDruidConfig.java\n\n@@ -41,14 +41,14 @@ public class TestDruidConfig\n                 .put(\"druid.broker-url\", \"http://druid.broker:1234\")\n                 .put(\"druid.coordinator-url\", \"http://druid.coordinator:4321\")\n                 .put(\"druid.schema-name\", \"test\")\n-                .put(\"druid.pushdown\", \"true\")\n+                .put(\"druid.compute-pushdown-enabled\", \"true\")\n                 .build();\n \n         DruidConfig expected = new DruidConfig()\n                 .setDruidBrokerUrl(\"http://druid.broker:1234\")\n                 .setDruidCoordinatorUrl(\"http://druid.coordinator:4321\")\n                 .setDruidSchema(\"test\")\n-                .setPushdown(true);\n+                .setComputePushdownEnabled(true);\n \n         ConfigAssertions.assertFullMapping(properties, expected);\n     }\n"}}, {"oid": "7c458389246663d553eb1b154bd46e10bfa6218d", "url": "https://github.com/prestodb/presto/commit/7c458389246663d553eb1b154bd46e10bfa6218d", "message": "Add session property for druid connector", "committedDate": "2020-04-26T21:50:48Z", "type": "commit"}, {"oid": "7c458389246663d553eb1b154bd46e10bfa6218d", "url": "https://github.com/prestodb/presto/commit/7c458389246663d553eb1b154bd46e10bfa6218d", "message": "Add session property for druid connector", "committedDate": "2020-04-26T21:50:48Z", "type": "forcePushed"}]}