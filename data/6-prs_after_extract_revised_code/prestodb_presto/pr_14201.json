{"pr_number": 14201, "pr_title": "Always use JSON for PlanFragment serialization", "pr_createdAt": "2020-03-04T01:03:41Z", "pr_url": "https://github.com/prestodb/presto/pull/14201", "timeline": [{"oid": "93eaf58aeb26f851b0b85c41938aed0154c38b6f", "url": "https://github.com/prestodb/presto/commit/93eaf58aeb26f851b0b85c41938aed0154c38b6f", "message": "Always use JSON for PlanFragment serialization\n\nSMILE support has flaky edge cases, and we cache the\nserialization now which already has reduced the cost.", "committedDate": "2020-03-04T00:57:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ0OTkxMw==", "url": "https://github.com/prestodb/presto/pull/14201#discussion_r387449913", "bodyText": "Maybe add a comment that plan fragment always use json due to flaky edge cases in smile as follow up?", "author": "wenleix", "createdAt": "2020-03-04T05:01:47Z", "path": "presto-main/src/main/java/com/facebook/presto/server/TaskResource.java", "diffHunk": "@@ -114,12 +114,7 @@ public TaskResource(\n         this.sessionPropertyManager = requireNonNull(sessionPropertyManager, \"sessionPropertyManager is null\");\n         this.responseExecutor = requireNonNull(responseExecutor, \"responseExecutor is null\");\n         this.timeoutExecutor = requireNonNull(timeoutExecutor, \"timeoutExecutor is null\");\n-        if (communicationConfig.isBinaryTransportEnabled()) {\n-            this.planFragmentCodec = planFragmentSmileCodec;\n-        }\n-        else {\n-            this.planFragmentCodec = wrapJsonCodec(planFragmentJsonCodec);\n-        }\n+        this.planFragmentCodec = wrapJsonCodec(planFragmentJsonCodec);", "originalCommit": "93eaf58aeb26f851b0b85c41938aed0154c38b6f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}