{"pr_number": 15450, "pr_title": "Fix LongEnum deserialization in map keys", "pr_createdAt": "2020-11-18T00:55:22Z", "pr_url": "https://github.com/prestodb/presto/pull/15450", "timeline": [{"oid": "097305a27a5dacf72de5141cc0eaa0bb49d069e3", "url": "https://github.com/prestodb/presto/commit/097305a27a5dacf72de5141cc0eaa0bb49d069e3", "message": "Fix LongEnum deserialization in map keys", "committedDate": "2020-11-18T00:08:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQxNjcxNA==", "url": "https://github.com/prestodb/presto/pull/15450#discussion_r526416714", "bodyText": "Why would the value be string is the enum is long?", "author": "rongrong", "createdAt": "2020-11-18T20:59:40Z", "path": "presto-client/src/main/java/com/facebook/presto/client/FixJsonDataUtils.java", "diffHunk": "@@ -127,6 +127,12 @@ private static Object fixValue(TypeSignature signature, Object value)\n         if (signature.isVarcharEnum()) {\n             return String.class.cast(value);\n         }\n+        if (signature.isLongEnum()) {\n+            if (value instanceof String) {", "originalCommit": "097305a27a5dacf72de5141cc0eaa0bb49d069e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQzNjI2MQ==", "url": "https://github.com/prestodb/presto/pull/15450#discussion_r526436261", "bodyText": "that happens because of JSON serialization \u2013\u00a0in JSON, keys are always strings (this is why we have a similar check a few lines below \u2013 line 138).", "author": "daniel-ohayon", "createdAt": "2020-11-18T21:35:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQxNjcxNA=="}], "type": "inlineReview", "revised_code": null}]}