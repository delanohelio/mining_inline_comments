{"pr_number": 2586, "pr_title": "Retry initialization of PythonService context", "pr_createdAt": "2020-10-05T21:23:32Z", "pr_url": "https://github.com/hazelcast/hazelcast-jet/pull/2586", "timeline": [{"oid": "0ca2968dcc9498e28ff2360b53e1c1fa5080bdc0", "url": "https://github.com/hazelcast/hazelcast-jet/commit/0ca2968dcc9498e28ff2360b53e1c1fa5080bdc0", "message": "Retry initialization of PythonService context", "committedDate": "2020-10-05T21:19:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDAyNzE2Mg==", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2586#discussion_r500027162", "bodyText": "Why remove this?", "author": "jbartok", "createdAt": "2020-10-06T06:12:26Z", "path": "extensions/python/src/main/java/com/hazelcast/jet/python/PythonServiceContext.java", "diffHunk": "@@ -133,8 +132,6 @@ void destroy() {\n             }\n         } catch (Exception e) {\n             throw new JetException(\"PythonService cleanup failed: \" + e, e);\n-        } finally {\n-            IOUtil.delete(runtimeBaseDir);", "originalCommit": "0ca2968dcc9498e28ff2360b53e1c1fa5080bdc0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDAzMjQxMA==", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2586#discussion_r500032410", "bodyText": "We delete the directory passed to us which contains the init script and the actual python handler code. This directory is created by the user prior to submitting the job, user may have other resources in the directory or user may want to re-use the job related scripts for further use. I think it was wrong to delete this directory.", "author": "gurbuzali", "createdAt": "2020-10-06T06:26:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDAyNzE2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA0NDA5MA==", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2586#discussion_r500044090", "bodyText": "Ok, but let's wait for Marko's 5 cents too, because I wouldn't be surprised if he had a good reason for adding this delete.", "author": "jbartok", "createdAt": "2020-10-06T06:54:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDAyNzE2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDgyMDA0Mw==", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2586#discussion_r500820043", "bodyText": "Yes, this deletes the temp directory created in the PythonServiceContext constructor, the context.attachedDirectory call. However, ProcSupplierCtx remembers for which atttached directories it already created a temp directory, so a repeated call to attachedDirectory won't repeat this.", "author": "mtopolnik", "createdAt": "2020-10-07T08:12:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDAyNzE2Mg=="}], "type": "inlineReview", "revised_code": null}, {"oid": "1b35937deb11bf99decf6f55026bc470388bac93", "url": "https://github.com/hazelcast/hazelcast-jet/commit/1b35937deb11bf99decf6f55026bc470388bac93", "message": "Improve Python init failure warning message", "committedDate": "2020-10-07T07:09:54Z", "type": "commit"}, {"oid": "54c0711a52a31b1db4e6f9ff36af18c93b4aa504", "url": "https://github.com/hazelcast/hazelcast-jet/commit/54c0711a52a31b1db4e6f9ff36af18c93b4aa504", "message": "remove runtimeBaseDir at the end of the job", "committedDate": "2020-10-07T08:47:19Z", "type": "commit"}, {"oid": "613bfaf83f17f1206bd92801d3115270f8f7ef8e", "url": "https://github.com/hazelcast/hazelcast-jet/commit/613bfaf83f17f1206bd92801d3115270f8f7ef8e", "message": "Fix attachedDirectory -> attachedFile", "committedDate": "2020-10-07T10:23:53Z", "type": "commit"}]}