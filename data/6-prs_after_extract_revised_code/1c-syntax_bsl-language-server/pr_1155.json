{"pr_number": 1155, "pr_title": "\u0414\u043e\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0434\u0438\u0430\u0433\u043d\u043e\u0441\u0442\u0438\u043a\u0438 \u041e\u0448\u0438\u0431\u043a\u0430 \u043d\u0435\u044f\u0432\u043d\u043e\u0433\u043e \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439\u0420\u0435\u0436\u0438\u043c", "pr_createdAt": "2020-05-06T21:42:17Z", "pr_url": "https://github.com/1c-syntax/bsl-language-server/pull/1155", "timeline": [{"oid": "6e1a862653752d2036aaadbb850968201a3de492", "url": "https://github.com/1c-syntax/bsl-language-server/commit/6e1a862653752d2036aaadbb850968201a3de492", "message": "\u0434\u043e\u0431\u0430\u0432\u0438\u043b \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u043f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u0442\u0435\u0441\u0442-\u043a\u0435\u0439\u0441\u043e\u0432\n\n\u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0441\u044f \u0448\u0442\u0430\u0442\u043d\u044b\u043c \u043c\u0435\u0442\u043e\u0434\u043e\u0432 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f \u0441 \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u043a\u043e\u0439\n\u0443\u0441\u043a\u043e\u0440\u0438\u043b \u0440\u0430\u0431\u043e\u0442\u0443 \u043f\u0440\u0430\u0432\u0438\u043b\u0430", "committedDate": "2020-05-06T16:22:12Z", "type": "commit"}, {"oid": "c77f0dc24628ad9c4070debb221b2ea3237e6fba", "url": "https://github.com/1c-syntax/bsl-language-server/commit/c77f0dc24628ad9c4070debb221b2ea3237e6fba", "message": "\u043f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u0442\u0435\u0441\u0442-\u043a\u0435\u0439\u0441\u044b", "committedDate": "2020-05-06T16:24:09Z", "type": "commit"}, {"oid": "ab23128d9e1193ee1a8bf3cdebd356177be6ae06", "url": "https://github.com/1c-syntax/bsl-language-server/commit/ab23128d9e1193ee1a8bf3cdebd356177be6ae06", "message": "\u043f\u0430\u0434\u0430\u044e\u0449\u0438\u0435 \u0442\u0435\u0441\u0442\u044b", "committedDate": "2020-05-06T21:19:11Z", "type": "commit"}, {"oid": "1c4631581fce444d9b28ba20b4250bc557b6759e", "url": "https://github.com/1c-syntax/bsl-language-server/commit/1c4631581fce444d9b28ba20b4250bc557b6759e", "message": "\u0438\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f - \u043b\u043e\u0432\u044f\u0442\u0441\u044f \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0432 \u0415\u0441\u043b\u0438\\\u0418\u043d\u0430\u0447\u0435\u0415\u0441\u043b\u0438 + \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0432 \u043e\u0431\u044b\u0447\u043d\u044b\u0445 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f\u0445", "committedDate": "2020-05-06T21:36:27Z", "type": "commit"}, {"oid": "60763957e932467297e30e620f1845bacb916295", "url": "https://github.com/1c-syntax/bsl-language-server/commit/60763957e932467297e30e620f1845bacb916295", "message": "\u0434\u043e\u0431\u0430\u0432\u0438\u043b \u0441\u0430\u043c\u044b\u0439 \u043f\u0440\u043e\u0441\u0442\u043e\u0439 \u043a\u0435\u0439\u0441", "committedDate": "2020-05-06T21:36:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MDgxNg==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421540816", "bodyText": "\u043d\u0435 \u043d\u0430\u0434\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c List, \u0435\u0441\u043b\u0438 \u043e\u0442 \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0438 \u043d\u0443\u0436\u0435\u043d \u0442\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0448\u044c contains. \u0434\u043b\u044f \u044d\u0442\u0438\u0445 \u0446\u0435\u043b\u0435\u0439 \u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c Set.", "author": "nixel2007", "createdAt": "2020-05-07T14:18:42Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java", "diffHunk": "@@ -52,6 +54,11 @@\n     \"(\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439\u0420\u0435\u0436\u0438\u043c|SafeMode)\",\n     Pattern.CASE_INSENSITIVE | Pattern.UNICODE_CASE\n   );\n+  private static final List<Integer> ROOT_LIST = Arrays.asList(", "originalCommit": "60763957e932467297e30e620f1845bacb916295", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYxMjY2Ng==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421612666", "bodyText": "@nixel2007 \u0435\u0441\u043b\u0438 \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438 \u043c\u0430\u043b\u0430, \u043a\u0430\u043a \u0443 \u043c\u0435\u043d\u044f 2-3 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u0442\u043e\u0433\u0434\u0430 \u0432\u0440\u043e\u0434\u0435 \u0431\u044b \u0438 List \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 )", "author": "artbear", "createdAt": "2020-05-07T15:53:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MDgxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYxMzAzNg==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421613036", "bodyText": "\u0443 \u0421\u043e\u043d\u0430\u0440\u0430 \u0434\u0430\u0436\u0435 \u0432 \u043f\u0440\u0430\u0432\u0438\u043b\u0435 \u043f\u043e contains \u043e\u0431 \u044d\u0442\u043e\u043c \u0441\u043a\u0430\u0437\u0430\u043d\u043e", "author": "artbear", "createdAt": "2020-05-07T15:54:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MDgxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzNzY3Mg==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421637672", "bodyText": "\u0438\u0441\u043f\u0440\u0430\u0432\u0438\u043b \u043d\u0430 Set", "author": "artbear", "createdAt": "2020-05-07T16:31:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MDgxNg=="}], "type": "inlineReview", "revised_code": {"commit": "ac38cbede5480c9da9ca912231b389ce71fc8afd", "chunk": "diff --git a/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java b/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java\nindex 4732e7ab9..44d94f411 100644\n--- a/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java\n+++ b/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java\n\n@@ -54,10 +53,10 @@ public class UnsafeSafeModeMethodCallDiagnostic extends AbstractFindMethodDiagno\n     \"(\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439\u0420\u0435\u0436\u0438\u043c|SafeMode)\",\n     Pattern.CASE_INSENSITIVE | Pattern.UNICODE_CASE\n   );\n-  private static final List<Integer> ROOT_LIST = Arrays.asList(\n+  private static final Set<Integer> ROOT_LIST = Set.of(\n     BSLParser.RULE_ifBranch, BSLParser.RULE_elsifBranch, BSLParser.RULE_expression,\n     BSLParser.RULE_codeBlock, BSLParser.RULE_assignment);\n-  private static final List<Integer> IF_BRANCHES = Arrays.asList(\n+  private static final Set<Integer> IF_BRANCHES = Set.of(\n     BSLParser.RULE_ifBranch, BSLParser.RULE_elsifBranch);\n \n   public UnsafeSafeModeMethodCallDiagnostic(DiagnosticInfo info) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MTA4OQ==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421541089", "bodyText": "\u0442\u0435\u043f\u0435\u0440\u044c \u043e\u0447\u0435\u043d\u044c \u043c\u043d\u043e\u0433\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u043e\u0432. \u0441\u043e\u043d\u0430\u0440 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u043d\u0435 \u0431\u043e\u043b\u044c\u0448\u0435 \u0442\u0440\u0435\u0445.", "author": "nixel2007", "createdAt": "2020-05-07T14:19:05Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java", "diffHunk": "@@ -65,26 +72,52 @@ protected boolean checkMethodCall(BSLParser.MethodCallContext ctx) {\n   @Override\n   protected boolean checkGlobalMethodCall(BSLParser.GlobalMethodCallContext ctx) {\n \n-    BSLParserRuleContext rootIfNode = null;\n-    BSLParserRuleContext rootExpressionNode = null;\n-    BSLParserRuleContext currentRootMember = null;\n+    if (!super.checkGlobalMethodCall(ctx)){\n+      return false;", "originalCommit": "60763957e932467297e30e620f1845bacb916295", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYxMzU5Nw==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421613597", "bodyText": "\u0434\u0430, \u043f\u0440\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u044b \u044f \u043f\u043e\u043d\u0438\u043c\u0430\u044e, \u0447\u0430\u0441\u0442\u044c \u0443\u0436\u0435 \u0443\u0431\u0440\u0430\u043b.\n\u0432\u0441\u0435 \u0434\u043b\u044f \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 )\n\u043f\u043e\u0434\u0443\u043c\u0430\u044e, \u043a\u0430\u043a \u0443\u043f\u0440\u043e\u0441\u0442\u0438\u0442\u044c.", "author": "artbear", "createdAt": "2020-05-07T15:55:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MTA4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzNzU3NA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421637574", "bodyText": "\u0443\u043f\u0440\u043e\u0441\u0442\u0438\u043b, \u043d\u043e \u0432\u0441\u0435 \u0440\u0430\u0432\u043d\u043e \u0432 \u043e\u0434\u043d\u043e\u043c \u043c\u0435\u0442\u043e\u0434\u0435 \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c 4 \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u0430 (", "author": "artbear", "createdAt": "2020-05-07T16:31:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MTA4OQ=="}], "type": "inlineReview", "revised_code": {"commit": "ac38cbede5480c9da9ca912231b389ce71fc8afd", "chunk": "diff --git a/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java b/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java\nindex 4732e7ab9..44d94f411 100644\n--- a/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java\n+++ b/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java\n\n@@ -76,11 +75,15 @@ public class UnsafeSafeModeMethodCallDiagnostic extends AbstractFindMethodDiagno\n       return false;\n     }\n \n-    BSLParserRuleContext currentRootMember = Trees.getRootParent(ctx, BSLParser.RULE_member);\n+    BSLParser.MemberContext currentRootMember = (BSLParser.MemberContext)Trees.getRootParent(ctx, BSLParser.RULE_member);\n     if (currentRootMember == null) {\n       return false;\n     }\n-    if (((BSLParserRuleContext)currentRootMember.getChild(0)).getRuleIndex() == BSLParser.RULE_unaryModifier){\n+    return nonValidExpression(currentRootMember);\n+  }\n+\n+  private static boolean nonValidExpression(BSLParser.MemberContext currentRootMember) {\n+    if (currentRootMember.unaryModifier() != null){\n       return true;\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MTg5MA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421541890", "bodyText": "\u0435\u0441\u043b\u0438 \u044d\u0442\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430 currentRootMember.unary() != null, \u0442\u043e \u0435\u0435 \u0441\u0442\u043e\u0438\u0442 \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u0430\u0442\u044c", "author": "nixel2007", "createdAt": "2020-05-07T14:20:05Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java", "diffHunk": "@@ -65,26 +72,52 @@ protected boolean checkMethodCall(BSLParser.MethodCallContext ctx) {\n   @Override\n   protected boolean checkGlobalMethodCall(BSLParser.GlobalMethodCallContext ctx) {\n \n-    BSLParserRuleContext rootIfNode = null;\n-    BSLParserRuleContext rootExpressionNode = null;\n-    BSLParserRuleContext currentRootMember = null;\n+    if (!super.checkGlobalMethodCall(ctx)){\n+      return false;\n+    }\n \n-    if (SAFE_MODE_METHOD_NAME.matcher(ctx.methodName().getText()).matches()) {\n-      rootIfNode = Trees.getRootParent(ctx, BSLParser.RULE_ifStatement);\n-      rootExpressionNode = Trees.getRootParent(ctx, BSLParser.RULE_expression);\n-      currentRootMember = Trees.getRootParent(ctx, BSLParser.RULE_member);\n+    BSLParserRuleContext currentRootMember = Trees.getRootParent(ctx, BSLParser.RULE_member);\n+    if (currentRootMember == null) {\n+      return false;\n     }\n+    if (((BSLParserRuleContext)currentRootMember.getChild(0)).getRuleIndex() == BSLParser.RULE_unaryModifier){", "originalCommit": "60763957e932467297e30e620f1845bacb916295", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzNzMwOQ==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421637309", "bodyText": "\u043f\u0435\u0440\u0435\u043f\u0438\u0441\u0430\u043b", "author": "artbear", "createdAt": "2020-05-07T16:31:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MTg5MA=="}], "type": "inlineReview", "revised_code": {"commit": "ac38cbede5480c9da9ca912231b389ce71fc8afd", "chunk": "diff --git a/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java b/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java\nindex 4732e7ab9..44d94f411 100644\n--- a/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java\n+++ b/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/UnsafeSafeModeMethodCallDiagnostic.java\n\n@@ -76,11 +75,15 @@ public class UnsafeSafeModeMethodCallDiagnostic extends AbstractFindMethodDiagno\n       return false;\n     }\n \n-    BSLParserRuleContext currentRootMember = Trees.getRootParent(ctx, BSLParser.RULE_member);\n+    BSLParser.MemberContext currentRootMember = (BSLParser.MemberContext)Trees.getRootParent(ctx, BSLParser.RULE_member);\n     if (currentRootMember == null) {\n       return false;\n     }\n-    if (((BSLParserRuleContext)currentRootMember.getChild(0)).getRuleIndex() == BSLParser.RULE_unaryModifier){\n+    return nonValidExpression(currentRootMember);\n+  }\n+\n+  private static boolean nonValidExpression(BSLParser.MemberContext currentRootMember) {\n+    if (currentRootMember.unaryModifier() != null){\n       return true;\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MzcwOA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421543708", "bodyText": "\u0435\u043c\u043d\u0438\u043f, \u0432 \u0441\u043e\u0441\u0435\u0434\u043d\u0438\u0445 \u043c\u0435\u0442\u043e\u0434\u0430\u0445 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f varargs \u0441 \u043f\u0440\u0438\u043c\u0438\u0442\u0438\u0432\u0430\u043c\u0438", "author": "nixel2007", "createdAt": "2020-05-07T14:22:19Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java", "diffHunk": "@@ -222,17 +222,34 @@ public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc) {\n   }\n \n   /**\n-   * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043d\u0443\u0436\u043d\u043e \u0442\u0438\u043f\u0430\n+   * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430\n    */\n   public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc, int ruleindex) {\n-    if (tnc.getParent() == null) {\n+    final var parent = tnc.getParent();\n+    if (parent == null) {\n+      return null;\n+    }\n+\n+    if (getRuleIndex(parent) == ruleindex) {\n+      return (BSLParserRuleContext) parent;\n+    } else {\n+      return getRootParent((BSLParserRuleContext) parent, ruleindex);\n+    }\n+  }\n+\n+  /**\n+   * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u0437 \u043d\u0443\u0436\u043d\u044b\u0445 \u0442\u0438\u043f\u043e\u0432\n+   */\n+  public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc, List<Integer> indexes) {", "originalCommit": "60763957e932467297e30e620f1845bacb916295", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYxNDk0MQ==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421614941", "bodyText": "\u043d\u0435\u0442, \u0434\u043b\u044f \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0430\u043a\u043e\u0433\u043e \u043c\u0435\u0442\u043e\u0434\u0430 \u043d\u0435\u0442.\n\u043c\u043d\u0435 \u0441\u043c\u0443\u0442\u043d\u043e \u0432\u0441\u043f\u043e\u043c\u0438\u043d\u0430\u0435\u0442\u0441\u044f, \u0447\u0442\u043e \u044f \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e \u0432\u0438\u0434\u0435\u043b \u0432 \u043a\u0430\u043a\u043e\u0439-\u0442\u043e \u0434\u0438\u0430\u0433\u043d\u043e\u0441\u0442\u0438\u043a\u0435 \u043c\u0435\u0442\u043e\u0434 \u043f\u043e\u0438\u0441\u043a\u0430 Ancestor. \u043d\u0435 \u0432 \u0445\u0435\u043b\u043f\u0435\u0440\u0435, \u0430 \u0432 \u0434\u0438\u0430\u0433\u043d\u043e\u0441\u0442\u0438\u043a\u0435.\n\u043f\u0440\u043e\u0432\u0435\u0440\u044e \u0435\u0449\u0435 \u0440\u0430\u0437.", "author": "artbear", "createdAt": "2020-05-07T15:56:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MzcwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYxNjczMA==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421616730", "bodyText": "\u043c\u043d\u0435 \u0432\u043e\u043e\u0431\u0449\u0435 varargs \u043d\u0435 \u043d\u0440\u0430\u0432\u0438\u0442\u0441\u044f, \u0434\u0430 \u0438 \u0421\u043e\u043d\u0430\u0440 \u043d\u0430 \u043d\u0435\u0433\u043e \u043d\u0435 \u0437\u0440\u044f \u0440\u0443\u0433\u0430\u0435\u0442\u0441\u044f.\n\u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0438 \u043b\u0443\u0447\u0448\u0435 \u044e\u0437\u0430\u0442\u044c, \u043a\u0430\u043a \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u044b \u043c\u043e\u0436\u043d\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0442\u044c,\n\u0430 c varargs \u043d\u0435\u0442 \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442 ( \u0438\u043b\u0438 \u043f\u0440\u0438\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0438\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c\u0441\u044f.", "author": "artbear", "createdAt": "2020-05-07T15:59:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MzcwOA=="}], "type": "inlineReview", "revised_code": {"commit": "60d5118c4ad84ea05110bf8d9176870e85b70bfd", "chunk": "diff --git a/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java b/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java\nindex d4b9ca775..ad05adb4c 100644\n--- a/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java\n+++ b/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java\n\n@@ -223,6 +223,10 @@ public final class Trees {\n \n   /**\n    * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430\n+   *\n+   * @param tnc       - \u043d\u043e\u0434\u0430, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0438\u0449\u0435\u043c \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f\n+   * @param ruleindex - BSLParser.RULE_*\n+   * @return tnc - \u0435\u0441\u043b\u0438 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d, \u0432\u0435\u0440\u043d\u0435\u0442 null\n    */\n   public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc, int ruleindex) {\n     final var parent = tnc.getParent();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0NDE1Nw==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421544157", "bodyText": "\u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u043e\u0434 \u043d\u043e\u0432\u044b\u0439, \u0442\u043e \u043d\u0443\u0436\u043d\u043e \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c javadoc", "author": "nixel2007", "createdAt": "2020-05-07T14:22:54Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java", "diffHunk": "@@ -222,17 +222,34 @@ public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc) {\n   }\n \n   /**\n-   * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043d\u0443\u0436\u043d\u043e \u0442\u0438\u043f\u0430\n+   * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430\n    */\n   public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc, int ruleindex) {\n-    if (tnc.getParent() == null) {\n+    final var parent = tnc.getParent();\n+    if (parent == null) {\n+      return null;\n+    }\n+\n+    if (getRuleIndex(parent) == ruleindex) {\n+      return (BSLParserRuleContext) parent;\n+    } else {\n+      return getRootParent((BSLParserRuleContext) parent, ruleindex);\n+    }\n+  }\n+\n+  /**\n+   * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u0437 \u043d\u0443\u0436\u043d\u044b\u0445 \u0442\u0438\u043f\u043e\u0432\n+   */\n+  public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc, List<Integer> indexes) {", "originalCommit": "60763957e932467297e30e620f1845bacb916295", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzNzIyNQ==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421637225", "bodyText": "\u0434\u043e\u0431\u0430\u0432\u0438\u043b javadoc", "author": "artbear", "createdAt": "2020-05-07T16:31:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0NDE1Nw=="}], "type": "inlineReview", "revised_code": {"commit": "60d5118c4ad84ea05110bf8d9176870e85b70bfd", "chunk": "diff --git a/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java b/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java\nindex d4b9ca775..ad05adb4c 100644\n--- a/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java\n+++ b/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java\n\n@@ -223,6 +223,10 @@ public final class Trees {\n \n   /**\n    * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430\n+   *\n+   * @param tnc       - \u043d\u043e\u0434\u0430, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0438\u0449\u0435\u043c \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f\n+   * @param ruleindex - BSLParser.RULE_*\n+   * @return tnc - \u0435\u0441\u043b\u0438 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d, \u0432\u0435\u0440\u043d\u0435\u0442 null\n    */\n   public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc, int ruleindex) {\n     final var parent = tnc.getParent();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0NDQ3Mg==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421544472", "bodyText": "List#contains - \u044d\u0442\u043e \u043f\u043b\u043e\u0445\u043e.", "author": "nixel2007", "createdAt": "2020-05-07T14:23:18Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java", "diffHunk": "@@ -222,17 +222,34 @@ public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc) {\n   }\n \n   /**\n-   * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043d\u0443\u0436\u043d\u043e \u0442\u0438\u043f\u0430\n+   * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430\n    */\n   public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc, int ruleindex) {\n-    if (tnc.getParent() == null) {\n+    final var parent = tnc.getParent();\n+    if (parent == null) {\n+      return null;\n+    }\n+\n+    if (getRuleIndex(parent) == ruleindex) {\n+      return (BSLParserRuleContext) parent;\n+    } else {\n+      return getRootParent((BSLParserRuleContext) parent, ruleindex);\n+    }\n+  }\n+\n+  /**\n+   * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u0437 \u043d\u0443\u0436\u043d\u044b\u0445 \u0442\u0438\u043f\u043e\u0432\n+   */\n+  public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc, List<Integer> indexes) {\n+    final var parent = tnc.getParent();\n+    if (parent == null) {\n       return null;\n     }\n \n-    if (getRuleIndex(tnc.getParent()) == ruleindex) {\n-      return (BSLParserRuleContext) tnc.getParent();\n+    if (indexes.contains(getRuleIndex(parent))) {", "originalCommit": "60763957e932467297e30e620f1845bacb916295", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzNzEwOQ==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1155#discussion_r421637109", "bodyText": "\u0438\u0441\u043f\u0440\u0430\u0432\u0438\u043b \u043d\u0430 Set", "author": "artbear", "createdAt": "2020-05-07T16:30:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0NDQ3Mg=="}], "type": "inlineReview", "revised_code": {"commit": "60d5118c4ad84ea05110bf8d9176870e85b70bfd", "chunk": "diff --git a/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java b/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java\nindex d4b9ca775..ad05adb4c 100644\n--- a/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java\n+++ b/src/main/java/com/github/_1c_syntax/bsl/languageserver/utils/Trees.java\n\n@@ -223,6 +223,10 @@ public final class Trees {\n \n   /**\n    * \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u043e\u0434\u044b \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430\n+   *\n+   * @param tnc       - \u043d\u043e\u0434\u0430, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0438\u0449\u0435\u043c \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f\n+   * @param ruleindex - BSLParser.RULE_*\n+   * @return tnc - \u0435\u0441\u043b\u0438 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d, \u0432\u0435\u0440\u043d\u0435\u0442 null\n    */\n   public static BSLParserRuleContext getRootParent(BSLParserRuleContext tnc, int ruleindex) {\n     final var parent = tnc.getParent();\n"}}, {"oid": "60d5118c4ad84ea05110bf8d9176870e85b70bfd", "url": "https://github.com/1c-syntax/bsl-language-server/commit/60d5118c4ad84ea05110bf8d9176870e85b70bfd", "message": "\u0434\u043e\u0431\u0430\u0432\u0438\u043b javadoc \u0438 \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u043b \u0442\u0438\u043f \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0438 \u0434\u043b\u044f \u0443\u043d\u0438\u0432\u0435\u0440\u0441\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u0438", "committedDate": "2020-05-07T16:29:20Z", "type": "commit"}, {"oid": "ac38cbede5480c9da9ca912231b389ce71fc8afd", "url": "https://github.com/1c-syntax/bsl-language-server/commit/ac38cbede5480c9da9ca912231b389ce71fc8afd", "message": "\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e Set  + \u0443\u043f\u0440\u043e\u0441\u0442\u0438\u043b \u043a\u043e\u0434", "committedDate": "2020-05-07T16:30:26Z", "type": "commit"}]}