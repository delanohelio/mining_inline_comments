{"pr_number": 1095, "pr_title": "DataExchangeLoadingDiagnostic npe fix", "pr_createdAt": "2020-04-20T19:03:19Z", "pr_url": "https://github.com/1c-syntax/bsl-language-server/pull/1095", "timeline": [{"oid": "43d785167cf1a7ed4c25c0b99405f4447a03144c", "url": "https://github.com/1c-syntax/bsl-language-server/commit/43d785167cf1a7ed4c25c0b99405f4447a03144c", "message": "DataExchangeLoadingDiagnostic npe fix", "committedDate": "2020-04-20T21:37:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcxMDc4MQ==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1095#discussion_r411710781", "bodyText": "\u0411\u0435\u0437 \u044d\u0442\u043e\u0433\u043e \u0432\u0441\u0435 \u0440\u0430\u0432\u043d\u043e \u043f\u0430\u0434\u0430\u0435\u0442", "author": "asosnoviy", "createdAt": "2020-04-20T21:39:56Z", "path": "src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/DataExchangeLoadingDiagnostic.java", "diffHunk": "@@ -129,7 +130,9 @@ private static boolean foundReturnStatement(BSLParser.IfBranchContext ifBranch)\n       .map(BSLParser.CodeBlockContext::statement)\n       .flatMap(context -> context.stream()\n         .map(BSLParser.StatementContext::compoundStatement)\n+        .filter(Objects::nonNull)", "originalCommit": "43d785167cf1a7ed4c25c0b99405f4447a03144c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTkwNTkyNg==", "url": "https://github.com/1c-syntax/bsl-language-server/pull/1095#discussion_r411905926", "bodyText": "\u044f \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u044e", "author": "otymko", "createdAt": "2020-04-21T06:29:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcxMDc4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "69ece37ba908371a5aee181226b708b2a2bad0b7", "chunk": "diff --git a/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/DataExchangeLoadingDiagnostic.java b/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/DataExchangeLoadingDiagnostic.java\nindex c262706ce..2a692d5c7 100644\n--- a/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/DataExchangeLoadingDiagnostic.java\n+++ b/src/main/java/com/github/_1c_syntax/bsl/languageserver/diagnostics/DataExchangeLoadingDiagnostic.java\n\n@@ -125,15 +124,14 @@ public class DataExchangeLoadingDiagnostic extends AbstractVisitorDiagnostic {\n   }\n \n   private static boolean foundReturnStatement(BSLParser.IfBranchContext ifBranch) {\n-    return Optional.of(ifBranch)\n-      .map(BSLParser.IfBranchContext::codeBlock)\n+\n+    return Optional.ofNullable(ifBranch.codeBlock())\n       .map(BSLParser.CodeBlockContext::statement)\n-      .flatMap(context -> context.stream()\n+      .flatMap(statementContexts -> statementContexts.stream()\n         .map(BSLParser.StatementContext::compoundStatement)\n-        .filter(Objects::nonNull)\n         .map(BSLParser.CompoundStatementContext::returnStatement)\n-        .filter(Objects::nonNull)\n-        .findFirst())\n+        .map(Optional::ofNullable)\n+        .findAny())\n       .isPresent();\n   }\n \n"}}, {"oid": "b54ffd9f068c6286aeeb02bf1b3892cb186e1a8d", "url": "https://github.com/1c-syntax/bsl-language-server/commit/b54ffd9f068c6286aeeb02bf1b3892cb186e1a8d", "message": "DataExchangeLoadingDiagnostic npe fix", "committedDate": "2020-04-21T05:23:05Z", "type": "forcePushed"}, {"oid": "69ece37ba908371a5aee181226b708b2a2bad0b7", "url": "https://github.com/1c-syntax/bsl-language-server/commit/69ece37ba908371a5aee181226b708b2a2bad0b7", "message": "DataExchangeLoadingDiagnostic npe fix", "committedDate": "2020-04-21T07:50:21Z", "type": "forcePushed"}, {"oid": "5626489b2031972ecfd4ffc14e35554cd3bec50b", "url": "https://github.com/1c-syntax/bsl-language-server/commit/5626489b2031972ecfd4ffc14e35554cd3bec50b", "message": "DataExchangeLoadingDiagnostic npe fix", "committedDate": "2020-04-21T07:57:24Z", "type": "commit"}, {"oid": "5626489b2031972ecfd4ffc14e35554cd3bec50b", "url": "https://github.com/1c-syntax/bsl-language-server/commit/5626489b2031972ecfd4ffc14e35554cd3bec50b", "message": "DataExchangeLoadingDiagnostic npe fix", "committedDate": "2020-04-21T07:57:24Z", "type": "forcePushed"}]}