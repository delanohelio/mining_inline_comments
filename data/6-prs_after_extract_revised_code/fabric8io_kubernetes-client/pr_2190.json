{"pr_number": 2190, "pr_title": "Fix #2189: Change package names of Resource Operation classes in order to avoid duplicates", "pr_createdAt": "2020-05-04T17:19:23Z", "pr_url": "https://github.com/fabric8io/kubernetes-client/pull/2190", "timeline": [{"oid": "29c98553e599abc9e5751acddcef59daf6bdcc41", "url": "https://github.com/fabric8io/kubernetes-client/commit/29c98553e599abc9e5751acddcef59daf6bdcc41", "message": "Modify KubernetesTypeAnnotator to add @Namespaced annotation in Resource Classes", "committedDate": "2020-05-04T18:58:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY4OTA4OA==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2190#discussion_r419689088", "bodyText": "if we can avoid hardcoding strings here and here, that would be great. Otherwise everything looks good to me.", "author": "dev-gaur", "createdAt": "2020-05-04T19:54:02Z", "path": "kubernetes-model/kubernetes-model-annotator/src/main/java/io/fabric8/kubernetes/annotator/KubernetesCoreTypeAnnotator.java", "diffHunk": "@@ -102,6 +104,26 @@ public void propertyOrder(JDefinedClass clazz, JsonNode propertiesNode) {\n     }\n   }\n \n+  private boolean isResourceNamespaced(JDefinedClass resourceClass) {\n+    switch (resourceClass.name()) {", "originalCommit": "29c98553e599abc9e5751acddcef59daf6bdcc41", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "66c054b8b127ca32acd0c14d6f3407817f7eb5fd", "chunk": "diff --git a/kubernetes-model/kubernetes-model-annotator/src/main/java/io/fabric8/kubernetes/annotator/KubernetesCoreTypeAnnotator.java b/kubernetes-model/kubernetes-model-annotator/src/main/java/io/fabric8/kubernetes/annotator/KubernetesCoreTypeAnnotator.java\nindex a428e5b26..a8aa484ae 100644\n--- a/kubernetes-model/kubernetes-model-annotator/src/main/java/io/fabric8/kubernetes/annotator/KubernetesCoreTypeAnnotator.java\n+++ b/kubernetes-model/kubernetes-model-annotator/src/main/java/io/fabric8/kubernetes/annotator/KubernetesCoreTypeAnnotator.java\n\n@@ -82,46 +97,30 @@ public class KubernetesCoreTypeAnnotator extends Jackson2Annotator {\n         JDefinedClass resourceClass = pendingResources.get(resourceName);\n         JDefinedClass resourceListClass = pendingLists.get(resourceName);\n \n-        String apiVersion = propertiesNode.get(\"apiVersion\").get(\"default\").toString().replaceAll(Pattern.quote(\"\\\"\"), \"\");\n+        String apiVersion = propertiesNode.get(API_VERSION).get(\"default\").toString().replaceAll(Pattern.quote(\"\\\"\"), \"\");\n         String apiGroup = \"\";\n         if (apiVersion.contains(\"/\")) {\n-          apiGroup = apiVersion.substring(0, apiVersion.lastIndexOf(\"/\"));\n+          apiGroup = apiVersion.substring(0, apiVersion.lastIndexOf('/'));\n           apiVersion = apiVersion.substring(apiGroup.length() + 1);\n         }\n         String packageSuffix = getPackageSuffix(apiVersion);\n \n-        resourceClass.annotate(ApiVersion.class).param(\"value\", apiVersion);\n-        resourceClass.annotate(ApiGroup.class).param(\"value\", apiGroup);\n-        resourceClass.annotate(PackageSuffix.class).param(\"value\", packageSuffix);\n-        resourceClass.annotate(Namespaced.class).param(\"value\", isResourceNamespaced(resourceClass));\n-        resourceListClass.annotate(ApiVersion.class).param(\"value\", apiVersion);\n-        resourceListClass.annotate(ApiGroup.class).param(\"value\", apiGroup);\n-        resourceListClass.annotate(PackageSuffix.class).param(\"value\", packageSuffix);\n+        resourceClass.annotate(ApiVersion.class).param(ANNOTATION_VALUE, apiVersion);\n+        resourceClass.annotate(ApiGroup.class).param(ANNOTATION_VALUE, apiGroup);\n+        resourceClass.annotate(PackageSuffix.class).param(ANNOTATION_VALUE, packageSuffix);\n+        resourceClass.annotate(Namespaced.class).param(ANNOTATION_VALUE, isResourceNamespaced(resourceClass));\n+        resourceListClass.annotate(ApiVersion.class).param(ANNOTATION_VALUE, apiVersion);\n+        resourceListClass.annotate(ApiGroup.class).param(ANNOTATION_VALUE, apiGroup);\n+        resourceListClass.annotate(PackageSuffix.class).param(ANNOTATION_VALUE, packageSuffix);\n         pendingLists.remove(resourceName);\n         pendingResources.remove(resourceName);\n+        addClassesToPropertyFiles(resourceClass);\n       }\n-      addClassesToPropertyFiles(clazz);\n     }\n   }\n \n   private boolean isResourceNamespaced(JDefinedClass resourceClass) {\n-    switch (resourceClass.name()) {\n-      case \"MutatingWebhookConfiguration\":\n-      case \"ValidatingWebhookConfiguration\":\n-      case \"CustomResourceDefinition\":\n-      case \"ComponentStatus\":\n-      case \"Namespace\":\n-      case \"Node\":\n-      case \"PersistentVolume\":\n-      case \"PodSecurityPolicy\":\n-      case \"ClusterRoleBinding\":\n-      case \"ClusterRole\":\n-      case \"PriorityClass\":\n-      case \"StorageClass\":\n-        return false;\n-      default:\n-        return true;\n-    }\n+    return !NON_NAMESPACED_RESOURCES.contains(resourceClass.name());\n   }\n \n   @Override\n"}}, {"oid": "66c054b8b127ca32acd0c14d6f3407817f7eb5fd", "url": "https://github.com/fabric8io/kubernetes-client/commit/66c054b8b127ca32acd0c14d6f3407817f7eb5fd", "message": "Modify KubernetesTypeAnnotator to add @Namespaced annotation in Resource Classes", "committedDate": "2020-05-05T10:24:39Z", "type": "forcePushed"}, {"oid": "03b261dbf184dcadb69f1690bf9e1386405de6a6", "url": "https://github.com/fabric8io/kubernetes-client/commit/03b261dbf184dcadb69f1690bf9e1386405de6a6", "message": "Fix #2189: Change package names of Resource Operation classes in order to avoid duplicates", "committedDate": "2020-05-05T10:31:30Z", "type": "commit"}, {"oid": "5f3d73e03ed2f25044bd5a1e3e856c696b811b45", "url": "https://github.com/fabric8io/kubernetes-client/commit/5f3d73e03ed2f25044bd5a1e3e856c696b811b45", "message": "Modify KubernetesTypeAnnotator to add @Namespaced annotation in Resource Classes", "committedDate": "2020-05-05T10:32:24Z", "type": "commit"}, {"oid": "5f3d73e03ed2f25044bd5a1e3e856c696b811b45", "url": "https://github.com/fabric8io/kubernetes-client/commit/5f3d73e03ed2f25044bd5a1e3e856c696b811b45", "message": "Modify KubernetesTypeAnnotator to add @Namespaced annotation in Resource Classes", "committedDate": "2020-05-05T10:32:24Z", "type": "forcePushed"}]}