{"pr_number": 2025, "pr_title": "Fix #2023", "pr_createdAt": "2020-02-26T08:09:35Z", "pr_url": "https://github.com/fabric8io/kubernetes-client/pull/2025", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM0MzQwOA==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2025#discussion_r384343408", "bodyText": "Umm, won't response.body().string() close the response body?", "author": "rohanKanojia", "createdAt": "2020-02-26T08:45:21Z", "path": "kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java", "diffHunk": "@@ -745,7 +746,10 @@ private String getLabelsQueryParam(Map<String, String> labels) {\n     Request request = (body == null) ? getRequest(url, callMethod) : getRequest(url, body, callMethod);\n     try (Response response = client.newCall(request).execute()) {\n       if (response.isSuccessful()) {\n-        return objectMapper.readValue(response.body().string(), HashMap.class);\n+        if(StringUtils.isBlank(response.body().string()))", "originalCommit": "58617fe996c3ad78b39d8a42824b37911fe2b23a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM0NDM0Nw==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2025#discussion_r384344347", "bodyText": "correct, fixing it in few minutes ;)", "author": "reste85", "createdAt": "2020-02-26T08:47:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM0MzQwOA=="}], "type": "inlineReview", "revised_code": {"commit": "cf933b9f0c3d736feb1d0c7382c9167a47aae63e", "chunk": "diff --git a/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java b/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java\nindex a6c85da4d..be1184a6d 100644\n--- a/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java\n+++ b/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java\n\n@@ -746,10 +745,11 @@ public class RawCustomResourceOperationsImpl extends OperationSupport {\n     Request request = (body == null) ? getRequest(url, callMethod) : getRequest(url, body, callMethod);\n     try (Response response = client.newCall(request).execute()) {\n       if (response.isSuccessful()) {\n-        if(StringUtils.isBlank(response.body().string()))\n+        String respBody = response.body().string();\n+        if(Utils.isNullOrEmpty(respBody))\n           return new HashMap<>();\n         else\n-          return objectMapper.readValue(response.body().string(), HashMap.class);\n+          return objectMapper.readValue(respBody, HashMap.class);\n       } else {\n         throw requestFailure(request, createStatus(response));\n       }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM0NTA4Nw==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2025#discussion_r384345087", "bodyText": "commons-lang is an optional dependency.\nWe shouldn't use it unless we handle the case that its not present.\nIn any case we have our internal StringUtils called Strings and should always use that.", "author": "iocanel", "createdAt": "2020-02-26T08:48:41Z", "path": "kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java", "diffHunk": "@@ -34,6 +34,7 @@\n import okhttp3.Request;\n import okhttp3.RequestBody;\n import okhttp3.Response;\n+import org.apache.commons.lang.StringUtils;", "originalCommit": "58617fe996c3ad78b39d8a42824b37911fe2b23a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM1MDI3MQ==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2025#discussion_r384350271", "bodyText": "Ok, fixing it right now", "author": "reste85", "createdAt": "2020-02-26T08:58:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM0NTA4Nw=="}], "type": "inlineReview", "revised_code": {"commit": "cf933b9f0c3d736feb1d0c7382c9167a47aae63e", "chunk": "diff --git a/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java b/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java\nindex a6c85da4d..be1184a6d 100644\n--- a/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java\n+++ b/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java\n\n@@ -34,7 +34,6 @@ import okhttp3.OkHttpClient;\n import okhttp3.Request;\n import okhttp3.RequestBody;\n import okhttp3.Response;\n-import org.apache.commons.lang.StringUtils;\n \n import java.io.IOException;\n import java.io.InputStream;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM1OTI3NA==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2025#discussion_r384359274", "bodyText": "Please use this: https://github.com/fabric8io/kubernetes-client/blob/master/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/utils/Utils.java#L289", "author": "iocanel", "createdAt": "2020-02-26T09:11:16Z", "path": "kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java", "diffHunk": "@@ -28,6 +28,7 @@\n import io.fabric8.kubernetes.client.utils.Serialization;\n import io.fabric8.kubernetes.client.utils.Utils;\n import io.fabric8.kubernetes.client.utils.WatcherToggle;\n+import io.fabric8.zjsonpatch.internal.guava.Strings;", "originalCommit": "7d99f26ca240e4c7ed1ad73b6d57184d7e726c4d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM2MDU0MQ==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2025#discussion_r384360541", "bodyText": "Ok \ud83d\udc4d", "author": "reste85", "createdAt": "2020-02-26T09:13:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM1OTI3NA=="}], "type": "inlineReview", "revised_code": {"commit": "92627382e089e98a08aa0fb372d1fc9ca239be65", "chunk": "diff --git a/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java b/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java\nindex f3e249f87..937c2f0fb 100644\n--- a/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java\n+++ b/kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java\n\n@@ -28,7 +28,6 @@ import io.fabric8.kubernetes.client.utils.IOHelpers;\n import io.fabric8.kubernetes.client.utils.Serialization;\n import io.fabric8.kubernetes.client.utils.Utils;\n import io.fabric8.kubernetes.client.utils.WatcherToggle;\n-import io.fabric8.zjsonpatch.internal.guava.Strings;\n import okhttp3.HttpUrl;\n import okhttp3.MediaType;\n import okhttp3.OkHttpClient;\n"}}, {"oid": "92627382e089e98a08aa0fb372d1fc9ca239be65", "url": "https://github.com/fabric8io/kubernetes-client/commit/92627382e089e98a08aa0fb372d1fc9ca239be65", "message": "Squashing commits", "committedDate": "2020-02-26T09:27:07Z", "type": "forcePushed"}, {"oid": "cf933b9f0c3d736feb1d0c7382c9167a47aae63e", "url": "https://github.com/fabric8io/kubernetes-client/commit/cf933b9f0c3d736feb1d0c7382c9167a47aae63e", "message": "Squashing commits", "committedDate": "2020-02-26T09:59:10Z", "type": "forcePushed"}, {"oid": "ec0749b9632c63e8c15aee82f48ac83f63a65a90", "url": "https://github.com/fabric8io/kubernetes-client/commit/ec0749b9632c63e8c15aee82f48ac83f63a65a90", "message": "Fix #2023", "committedDate": "2020-02-28T20:19:18Z", "type": "commit"}, {"oid": "ec0749b9632c63e8c15aee82f48ac83f63a65a90", "url": "https://github.com/fabric8io/kubernetes-client/commit/ec0749b9632c63e8c15aee82f48ac83f63a65a90", "message": "Fix #2023", "committedDate": "2020-02-28T20:19:18Z", "type": "forcePushed"}]}