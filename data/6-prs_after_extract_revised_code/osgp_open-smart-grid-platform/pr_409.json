{"pr_number": 409, "pr_title": "Bug/flex 5335 updated device model", "pr_createdAt": "2020-08-28T15:22:49Z", "pr_url": "https://github.com/OSGP/open-smart-grid-platform/pull/409", "timeline": [{"oid": "e6e453004b198625f26ca7b8eb134c2465d3268d", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/e6e453004b198625f26ca7b8eb134c2465d3268d", "message": "WIP", "committedDate": "2020-08-24T07:56:20Z", "type": "commit"}, {"oid": "3248efa14cfc554fac70fa2f02c2ed3b3eeb7e68", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/3248efa14cfc554fac70fa2f02c2ed3b3eeb7e68", "message": "Removing the UpdatedDeviceConverter", "committedDate": "2020-08-26T14:49:51Z", "type": "commit"}, {"oid": "21609aba1af780bfbc415d76519adbe377def8d3", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/21609aba1af780bfbc415d76519adbe377def8d3", "message": "DeviceModelConverters creation", "committedDate": "2020-08-28T09:28:09Z", "type": "commit"}, {"oid": "34acedd829c023bc0cc5aac6ea0297853801a4ca", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/34acedd829c023bc0cc5aac6ea0297853801a4ca", "message": "Merge remote-tracking branch 'origin/development' into bug/FLEX-5335-updated-device-model", "committedDate": "2020-08-28T15:15:19Z", "type": "commit"}, {"oid": "cf80dd4d9bdf3c84eb89126d9874814a5a48d55c", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/cf80dd4d9bdf3c84eb89126d9874814a5a48d55c", "message": "Adding headers", "committedDate": "2020-08-28T15:22:27Z", "type": "commit"}, {"oid": "7e151e89f773c6007252759e36520459a0c6ec39", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/7e151e89f773c6007252759e36520459a0c6ec39", "message": "Sonarqube", "committedDate": "2020-08-31T07:20:59Z", "type": "commit"}, {"oid": "837efdbd2b6630409d4de2745b812ed721e15580", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/837efdbd2b6630409d4de2745b812ed721e15580", "message": "Merge tag 'development-587' into bug/FLEX-5335-updated-device-model", "committedDate": "2020-09-02T10:47:04Z", "type": "commit"}, {"oid": "4021af7008addf1d043b8b167cb22dd8822a5fc0", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/4021af7008addf1d043b8b167cb22dd8822a5fc0", "message": "Removing of devicemodel from UpdateDeviceRequest", "committedDate": "2020-09-02T10:49:08Z", "type": "commit"}, {"oid": "964bb46224f828e3098e473894ecb0cd366bd717", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/964bb46224f828e3098e473894ecb0cd366bd717", "message": "FLEX-5335 ~ Fixes conversions", "committedDate": "2020-09-08T13:09:49Z", "type": "commit"}, {"oid": "8c0969f6d464e9be6129c3168367847c6b1423fe", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/8c0969f6d464e9be6129c3168367847c6b1423fe", "message": "FLEX-5335 ~ Removes unused import", "committedDate": "2020-09-08T13:10:09Z", "type": "commit"}, {"oid": "5119005282e34f91d6bacd1879cc92ca6e5a4857", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/5119005282e34f91d6bacd1879cc92ca6e5a4857", "message": "Merge branch 'development' of github.com:OSGP/open-smart-grid-platform into bug/FLEX-5335-updated-device-model", "committedDate": "2020-09-08T13:37:53Z", "type": "commit"}, {"oid": "426a634f31bd11ae724fc2f469634b4e7b7a9997", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/426a634f31bd11ae724fc2f469634b4e7b7a9997", "message": "FLEX-5335 ~ Fixes converter for unit test", "committedDate": "2020-09-08T14:00:54Z", "type": "commit"}, {"oid": "b7a1dde5ed6da16c4b0588870a132b793c1bc532", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/b7a1dde5ed6da16c4b0588870a132b793c1bc532", "message": "Merge branch 'development' of github.com:OSGP/open-smart-grid-platform into bug/FLEX-5335-updated-device-model", "committedDate": "2020-09-11T17:49:49Z", "type": "commit"}, {"oid": "e97338c75c2fda703a047ef2a03430411a1eac35", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/e97338c75c2fda703a047ef2a03430411a1eac35", "message": "Merge remote-tracking branch 'origin/development' into bug/FLEX-5335-updated-device-model", "committedDate": "2020-09-16T08:07:21Z", "type": "commit"}, {"oid": "2dc5811ed265ad640a22919900565d1b63fef541", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/2dc5811ed265ad640a22919900565d1b63fef541", "message": "FLEX-5335 ~ Reverts changes converter", "committedDate": "2020-09-16T19:59:49Z", "type": "commit"}, {"oid": "f130ad346140a0c09bdd8514f81edefe10afcc0b", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/f130ad346140a0c09bdd8514f81edefe10afcc0b", "message": "Merge branch 'bug/FLEX-5335-updated-device-model' of github.com:OSGP/open-smart-grid-platform into bug/FLEX-5335-updated-device-model", "committedDate": "2020-09-16T20:00:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDEyMDEyNQ==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/409#discussion_r490120125", "bodyText": "Wouldn't it be better when using constructor chaining, if the constructor with the least number of parameters calls a constructor with a larger number of parameters, providing sane defaults for the missing arguments?\nOr consider using a builder pattern...", "author": "smvdheijden", "createdAt": "2020-09-17T09:56:13Z", "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/DeviceModel.java", "diffHunk": "@@ -46,19 +46,22 @@ public DeviceModel() {\n \n     public DeviceModel(final Manufacturer manufacturer, final String modelCode, final String description,\n             final boolean metered) {\n-        this.manufacturer = manufacturer;\n-        this.modelCode = modelCode;\n+        this(manufacturer, modelCode);", "originalCommit": "f130ad346140a0c09bdd8514f81edefe10afcc0b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "06c89dabd0c31dac187cbbced71e78554434e411", "chunk": "diff --git a/osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/DeviceModel.java b/osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/DeviceModel.java\nindex 11e302e8a3..cddb3c4e35 100644\n--- a/osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/DeviceModel.java\n+++ b/osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/DeviceModel.java\n\n@@ -37,33 +37,35 @@ public class DeviceModel extends AbstractEntity implements Comparable<DeviceMode\n     @Column\n     private boolean fileStorage;\n \n-    @Column\n-    private boolean metered;\n-\n     public DeviceModel() {\n         // Default constructor\n     }\n \n-    public DeviceModel(final Manufacturer manufacturer, final String modelCode, final String description,\n-            final boolean metered) {\n-        this(manufacturer, modelCode);\n-        this.description = description;\n-        this.metered = metered;\n+    public DeviceModel(final Manufacturer manufacturer, final String modelCode, final String description) {\n+        this(manufacturer, modelCode, description, true);\n     }\n \n     public DeviceModel(final Manufacturer manufacturer, final String modelCode, final String description,\n-            final boolean fileStorage, final boolean metered) {\n-        this(manufacturer, modelCode, description, metered);\n-        this.fileStorage = fileStorage;\n-    }\n-\n-    public DeviceModel(final Manufacturer manufacturer, final String modelCode) {\n+            final boolean fileStorage) {\n         this.manufacturer = manufacturer;\n         this.modelCode = modelCode;\n-        // default behavior is true\n-        this.fileStorage = true;\n+        this.description = description;\n+        this.fileStorage = fileStorage;\n     }\n \n+//    public DeviceModel(final Manufacturer manufacturer, final String modelCode, final String description,\n+//            final boolean fileStorage, final boolean metered) {\n+//        this(manufacturer, modelCode, description, metered);\n+//        this.fileStorage = fileStorage;\n+//    }\n+\n+//    public DeviceModel(final Manufacturer manufacturer, final String modelCode) {\n+//        this.manufacturer = manufacturer;\n+//        this.modelCode = modelCode;\n+//        // default behavior is true\n+//        this.fileStorage = true;\n+//    }\n+\n     @Override\n     public boolean equals(final Object obj) {\n         if (this == obj) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE5ODY3OQ==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/409#discussion_r490198679", "bodyText": "This seems like an improvement of the previous code, where it looks like the deviceModel is never set on the destination Device object. Could this potentially lead to unexpected side effects?", "author": "smvdheijden", "createdAt": "2020-09-17T12:20:07Z", "path": "osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/DeviceConverterHelper.java", "diffHunk": "@@ -82,9 +83,10 @@ T initEntity(final Device source) {\n                     source.getTechnicalInstallationDate().toGregorianCalendar().getTime());\n         }\n \n-        if (source.getDeviceModel() != null) {\n-            final DeviceModel deviceModel = new DeviceModel();\n-            deviceModel.setModelCode(source.getDeviceModel().getModelCode());\n+        if (source instanceof Device) {\n+            final Device sourceDevice = (Device) source;\n+            destination.setDeviceModel(this.mapper.map(sourceDevice.getDeviceModel(),", "originalCommit": "f130ad346140a0c09bdd8514f81edefe10afcc0b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "6f04a97e7b104ad6a7128ae92493ec538a9c52e3", "chunk": "diff --git a/osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/DeviceConverterHelper.java b/osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/DeviceConverterHelper.java\nindex 4c89204144..441ee4022d 100644\n--- a/osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/DeviceConverterHelper.java\n+++ b/osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/DeviceConverterHelper.java\n\n@@ -83,11 +82,8 @@ class DeviceConverterHelper<T extends org.opensmartgridplatform.domain.core.enti\n                     source.getTechnicalInstallationDate().toGregorianCalendar().getTime());\n         }\n \n-        if (source instanceof Device) {\n-            final Device sourceDevice = (Device) source;\n-            destination.setDeviceModel(this.mapper.map(sourceDevice.getDeviceModel(),\n-                    org.opensmartgridplatform.domain.core.entities.DeviceModel.class));\n-        }\n+        destination.setDeviceModel(this.mapper.map(source.getDeviceModel(),\n+                org.opensmartgridplatform.domain.core.entities.DeviceModel.class));\n \n         return destination;\n     }\n"}}, {"oid": "f9835d351b0e4a8d0d5bca4268dff7db7bcfcf70", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/f9835d351b0e4a8d0d5bca4268dff7db7bcfcf70", "message": "Merges branch 'development' into bug/FLEX-5335-updated-device-model", "committedDate": "2020-09-21T17:11:01Z", "type": "commit"}, {"oid": "6f04a97e7b104ad6a7128ae92493ec538a9c52e3", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/6f04a97e7b104ad6a7128ae92493ec538a9c52e3", "message": "FLEX-5335 ~ Use UpdatedDevice in xsd", "committedDate": "2020-10-08T16:04:11Z", "type": "commit"}, {"oid": "2dd16cab70e9a9e8ac059b44278ed2a2a87aaee7", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/2dd16cab70e9a9e8ac059b44278ed2a2a87aaee7", "message": "Merge branch 'development' of github.com:OSGP/open-smart-grid-platform into bug/FLEX-5335-updated-device-model", "committedDate": "2020-10-08T16:04:32Z", "type": "commit"}, {"oid": "35e2ed7617d666793566e4066aabc96ce113aa1e", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/35e2ed7617d666793566e4066aabc96ce113aa1e", "message": "FLEX-5335 ~ Processes review comments", "committedDate": "2020-10-13T08:41:22Z", "type": "commit"}, {"oid": "c5f664d085bdcccd92f545d872f4badb5481718b", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/c5f664d085bdcccd92f545d872f4badb5481718b", "message": "FLEX-5335 ~ Moves deviceIdentification in xsd", "committedDate": "2020-10-13T13:07:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI4NzIyNQ==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/409#discussion_r505287225", "bodyText": "Is this canConvert update related to earlier changes with a BaseDevice - Device hierarchy that has been removed with the addition of UpdatedDevice (in which case it seems this would be no longer needed) or does it stand on its own?", "author": "bvdzwet", "createdAt": "2020-10-15T07:48:10Z", "path": "osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/SsldConverter.java", "diffHunk": "@@ -181,4 +182,13 @@ public boolean equals(final Object obj) {\n                 && Objects.equals(this.ssldRepository, ((SsldConverter) obj).ssldRepository);\n     }\n \n+    @Override\n+    public boolean canConvert(final Type<?> sourceType, final Type<?> destinationType) {", "originalCommit": "c5f664d085bdcccd92f545d872f4badb5481718b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c10966151cf88854d89c5636223d14563fef76c5", "chunk": "diff --git a/osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/SsldConverter.java b/osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/SsldConverter.java\nindex 31ee5be4c1..23c7c22c2e 100644\n--- a/osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/SsldConverter.java\n+++ b/osgp/platform/osgp-adapter-ws-core/src/main/java/org/opensmartgridplatform/adapter/ws/core/application/mapping/SsldConverter.java\n\n@@ -182,13 +182,4 @@ class SsldConverter extends BidirectionalConverter<Ssld, Device> {\n                 && Objects.equals(this.ssldRepository, ((SsldConverter) obj).ssldRepository);\n     }\n \n-    @Override\n-    public boolean canConvert(final Type<?> sourceType, final Type<?> destinationType) {\n-\n-        return super.canConvert(sourceType, destinationType)\n-                || super.canConvert(sourceType, destinationType.getSuperType())\n-                || super.canConvert(sourceType.getSuperType(), destinationType);\n-\n-    }\n-\n }\n"}}, {"oid": "06c89dabd0c31dac187cbbced71e78554434e411", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/06c89dabd0c31dac187cbbced71e78554434e411", "message": "Merge branch 'development' of github.com:OSGP/open-smart-grid-platform into bug/FLEX-5335-updated-device-model", "committedDate": "2020-10-15T15:10:44Z", "type": "commit"}, {"oid": "c10966151cf88854d89c5636223d14563fef76c5", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/c10966151cf88854d89c5636223d14563fef76c5", "message": "FLEX-5335 ~ Processes review comments", "committedDate": "2020-10-15T22:30:15Z", "type": "commit"}, {"oid": "f9a0ac648b0767ceec268b168f6a71e639717bf3", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/f9a0ac648b0767ceec268b168f6a71e639717bf3", "message": "FLEX-5335 ~ Removes commented code", "committedDate": "2020-10-15T22:34:36Z", "type": "commit"}]}