{"pr_number": 279, "pr_title": "FLEX-4693: Removes MD5 functionality.", "pr_createdAt": "2020-04-14T11:14:41Z", "pr_url": "https://github.com/OSGP/open-smart-grid-platform/pull/279", "timeline": [{"oid": "3d89c000b7b74249cac0908f47e12e93a061236f", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/3d89c000b7b74249cac0908f47e12e93a061236f", "message": "FLEX-4693: Removes MD5 functionality.", "committedDate": "2020-04-14T11:12:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM5NDY2MA==", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/279#discussion_r408394660", "bodyText": "The class already had 5 constructors, which were doing more or less the same. Instead of adding two more constructors, use a builder.", "author": "rlemmers", "createdAt": "2020-04-14T19:51:54Z", "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/FirmwareFile.java", "diffHunk": "@@ -95,6 +95,11 @@ public FirmwareFile(final String identification, final String filename, final St\n         this.hash = hash;\n     }\n \n+    public FirmwareFile(final String identification, final String filename, final String description,", "originalCommit": "3d89c000b7b74249cac0908f47e12e93a061236f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "607935a587de00439d79a25e817604fdf11ad063", "chunk": "diff --git a/osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/FirmwareFile.java b/osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/FirmwareFile.java\nindex 517662bd9e..3b4a59afeb 100644\n--- a/osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/FirmwareFile.java\n+++ b/osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/entities/FirmwareFile.java\n\n@@ -81,54 +81,22 @@ public class FirmwareFile extends AbstractEntity {\n     @Column()\n     private String hash;\n \n-    public FirmwareFile() {\n+    protected FirmwareFile() {\n         // Default constructor\n     }\n \n-    public FirmwareFile(final String identification, final String filename, final String description,\n-            final boolean pushToNewDevices, final byte[] file, final String hash) {\n-        this.identification = identification;\n-        this.filename = filename;\n-        this.description = description;\n-        this.pushToNewDevices = pushToNewDevices;\n-        this.file = file;\n-        this.hash = hash;\n-    }\n-\n-    public FirmwareFile(final String identification, final String filename, final String description,\n-            final boolean pushToNewDevices, final byte[] file) {\n-        this(identification, filename, description, pushToNewDevices, file, null);\n-    }\n-\n-    public FirmwareFile(final String identification, final String filename, final String description,\n-            final boolean pushToNewDevices) {\n-        this(identification, filename, description, pushToNewDevices, null, null);\n-    }\n-\n-    public FirmwareFile(final String filename, final String description, final boolean pushToNewDevices,\n-            final byte[] file, final String hash) {\n-        this(newRandomIdentification(), filename, description, pushToNewDevices, file, hash);\n-    }\n-\n-    public FirmwareFile(final String filename, final String description, final boolean pushToNewDevices,\n-            final byte[] file) {\n-        this(filename, description, pushToNewDevices, file, null);\n-    }\n-\n-    public FirmwareFile(final String filename, final String description, final boolean pushToNewDevices) {\n-        this(filename, description, pushToNewDevices, null, null);\n-    }\n-\n-    private static String newRandomIdentification() {\n-        return UUID.randomUUID().toString().replace(\"-\", \"\");\n+    private FirmwareFile(final Builder builder) {\n+        this.identification = builder.identification;\n+        this.filename = builder.filename;\n+        this.description = builder.description;\n+        this.pushToNewDevices = builder.pushToNewDevices;\n+        this.file = builder.file;\n+        this.hash = builder.hash;\n     }\n \n     public void updateFirmwareModuleData(final Map<FirmwareModule, String> versionsByModule) {\n         this.firmwareModules.clear();\n-\n-        for (final Entry<FirmwareModule, String> versionByModule : versionsByModule.entrySet()) {\n-            this.addFirmwareModule(versionByModule.getKey(), versionByModule.getValue());\n-        }\n+        versionsByModule.forEach(this::addFirmwareModule);\n     }\n \n     public String getIdentification() {\n"}}, {"oid": "607935a587de00439d79a25e817604fdf11ad063", "url": "https://github.com/OSGP/open-smart-grid-platform/commit/607935a587de00439d79a25e817604fdf11ad063", "message": "FLEX-4693 Replaces FirmwareFile constructors with Builder\n\nBased on a review comment indicating there were too many constructors\nwith growing and confusing lists of arguments, a Builder is added to\nFirmwareFile replacing the constructors.\n\nDevice models and firmware modules with versions were kept outside the\nbuilder, because of comments in FirmwareManagementService with\naddFirmware that the FirmwareFile needs to be saved before relating\nother existing entities to prevent issues with Hibernate.", "committedDate": "2020-04-15T13:58:03Z", "type": "commit"}]}