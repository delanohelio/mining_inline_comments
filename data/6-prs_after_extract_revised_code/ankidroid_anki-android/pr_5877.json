{"pr_number": 5877, "pr_title": "ImageField: Stop parsing images using Regex", "pr_createdAt": "2020-03-29T19:13:14Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/5877", "timeline": [{"oid": "b0c5237fd3d0564ce905c38b13af8f23e066af47", "url": "https://github.com/ankidroid/Anki-Android/commit/b0c5237fd3d0564ce905c38b13af8f23e066af47", "message": "Parse Image HTML using HTML Parser\n\nWe were previously using Regex, which is a bad thing.\n\nFixes #5874", "committedDate": "2020-03-29T19:05:01Z", "type": "commit"}, {"oid": "460e3849d6b9ff240628eb9350e87d112c81a1d7", "url": "https://github.com/ankidroid/Anki-Android/commit/460e3849d6b9ff240628eb9350e87d112c81a1d7", "message": "Do not preview invalid images\n\nPreviously, we were trying to decode images which were not valid.\n\nThere was no point in doing this.", "committedDate": "2020-03-29T19:05:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg0NzIyNA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5877#discussion_r399847224", "bodyText": "jetbrains annotation", "author": "mikehardy", "createdAt": "2020-03-29T20:12:45Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/fields/ImageField.java", "diffHunk": "@@ -21,10 +21,14 @@\n \n import com.ichi2.libanki.Collection;\n \n+import org.jetbrains.annotations.NotNull;", "originalCommit": "0186d3eced14cd4717422956c8945e48972fbf8e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg0Nzg5NA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5877#discussion_r399847894", "bodyText": "\ud83e\udd26\u200d\u2642", "author": "david-allison-1", "createdAt": "2020-03-29T20:17:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg0NzIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg1MDMxNQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/5877#discussion_r399850315", "bodyText": "Any way I can contribute to an auto-review for this? It'll happen again, and It's a bad habit that I don't need to waste your time with", "author": "david-allison-1", "createdAt": "2020-03-29T20:36:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg0NzIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg1MTAyMw==", "url": "https://github.com/ankidroid/Anki-Android/pull/5877#discussion_r399851023", "bodyText": "might just be a config thing you can change? https://www.jetbrains.com/help/idea/nullable-notnull-configuration.html#", "author": "mikehardy", "createdAt": "2020-03-29T20:41:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg0NzIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg1MTIxOA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5877#discussion_r399851218", "bodyText": "\ud83e\udd26\u200d\u2640 Thanks", "author": "david-allison-1", "createdAt": "2020-03-29T20:43:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg0NzIyNA=="}], "type": "inlineReview", "revised_code": {"commit": "09e11ce78e5b52764d67374ccc740702208e1c16", "chunk": "diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/fields/ImageField.java b/AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/fields/ImageField.java\nindex 8a8e27dbd..2991fb2d3 100644\n--- a/AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/fields/ImageField.java\n+++ b/AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/fields/ImageField.java\n\n@@ -21,7 +21,6 @@ package com.ichi2.anki.multimediacard.fields;\n \n import com.ichi2.libanki.Collection;\n \n-import org.jetbrains.annotations.NotNull;\n import org.jsoup.Jsoup;\n import org.jsoup.nodes.Document;\n import org.jsoup.nodes.Element;\n"}}, {"oid": "09e11ce78e5b52764d67374ccc740702208e1c16", "url": "https://github.com/ankidroid/Anki-Android/commit/09e11ce78e5b52764d67374ccc740702208e1c16", "message": "NF: Extract getImageFullPath", "committedDate": "2020-03-29T20:32:11Z", "type": "commit"}, {"oid": "d5e4bc140de2287fd364ca3859e4a7d339f4da91", "url": "https://github.com/ankidroid/Anki-Android/commit/d5e4bc140de2287fd364ca3859e4a7d339f4da91", "message": "Ensure we don't try to preview collection.media\n\nAn empty path was concatenated with nothing, which returned\ncollection.media, which was also a valid file.", "committedDate": "2020-03-29T20:32:14Z", "type": "commit"}, {"oid": "d5e4bc140de2287fd364ca3859e4a7d339f4da91", "url": "https://github.com/ankidroid/Anki-Android/commit/d5e4bc140de2287fd364ca3859e4a7d339f4da91", "message": "Ensure we don't try to preview collection.media\n\nAn empty path was concatenated with nothing, which returned\ncollection.media, which was also a valid file.", "committedDate": "2020-03-29T20:32:14Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg1MTQ0OQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/5877#discussion_r399851449", "bodyText": "Issue found: Avoid reassigning parameters such as 'bmp'", "author": "timrae", "createdAt": "2020-03-29T20:45:09Z", "path": "AnkiDroid/src/main/java/com/ichi2/utils/ExifUtil.java", "diffHunk": "@@ -21,12 +21,15 @@\n \n import android.graphics.Bitmap;\n import android.graphics.Matrix;\n+\n+import androidx.annotation.NonNull;\n import androidx.exifinterface.media.ExifInterface;\n \n import java.io.File;\n \n public class ExifUtil {\n-    public static Bitmap rotateFromCamera(File theFile, Bitmap bmp) {\n+    @NonNull\n+    public static Bitmap rotateFromCamera(File theFile, @NonNull Bitmap bmp) {", "originalCommit": "d5e4bc140de2287fd364ca3859e4a7d339f4da91", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}