{"pr_number": 6387, "pr_title": "Show options menu & navigation drawer using WebView", "pr_createdAt": "2020-06-06T18:32:29Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/6387", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI5MDM1OQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6387#discussion_r436290359", "bodyText": "@david-allison-1\nI tried it, but it showing error as not defined.\nsuper.onNavigationPressed()", "author": "infinyte7", "createdAt": "2020-06-06T18:33:47Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -3080,6 +3082,29 @@ private boolean filterUrl(String url) {\n                 mFlipCardLayout.performClick();\n                 return true;\n             }\n+            // Show options menu from WebView\n+            // Show options menu\n+            if (url.startsWith(\"signal:anki_show_options_menu\")) {\n+                if (!getSupportActionBar().isShowing()) {\n+                    openOptionsMenu();\n+                } else {\n+                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen,\"ankiShowOptionsMenu\"), true);\n+                }\n+                return true;\n+            }\n+\n+            // Show Navigation Drawer from WebView\n+            // Show side menu\n+            if (url.startsWith(\"signal:anki_show_navigation_drawer\")) {\n+                if (!getSupportActionBar().isShowing()) {\n+                    DrawerLayout mDrawerLayout = (DrawerLayout)findViewById(R.id.drawer_layout);", "originalCommit": "3e24b9caa615eb37407662fa7b6386a2090b3499", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU0MDUzMQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6387#discussion_r437540531", "bodyText": "Sorry... AbstractFlashcardViewer.this.onNavigationPressed();", "author": "david-allison-1", "createdAt": "2020-06-09T15:54:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI5MDM1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "f67ef8aa71bb5841c17ee922e0e91177cf669dbe", "chunk": "diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\nindex 362a8bbbde..23e83e81bf 100644\n--- a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\n+++ b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\n\n@@ -3083,7 +3083,6 @@ public abstract class AbstractFlashcardViewer extends NavigationDrawerActivity i\n                 return true;\n             }\n             // Show options menu from WebView\n-            // Show options menu\n             if (url.startsWith(\"signal:anki_show_options_menu\")) {\n                 if (!getSupportActionBar().isShowing()) {\n                     openOptionsMenu();\n"}}, {"oid": "f67ef8aa71bb5841c17ee922e0e91177cf669dbe", "url": "https://github.com/ankidroid/Anki-Android/commit/f67ef8aa71bb5841c17ee922e0e91177cf669dbe", "message": "\tAdded Show options Menu & Nav Drawer Using WebView\n\n\tUpdated AbstractFlashcardViewer.java\n\n\tUpdated AbstractFlashcardViewer.java", "committedDate": "2020-06-06T19:04:56Z", "type": "commit"}, {"oid": "f67ef8aa71bb5841c17ee922e0e91177cf669dbe", "url": "https://github.com/ankidroid/Anki-Android/commit/f67ef8aa71bb5841c17ee922e0e91177cf669dbe", "message": "\tAdded Show options Menu & Nav Drawer Using WebView\n\n\tUpdated AbstractFlashcardViewer.java\n\n\tUpdated AbstractFlashcardViewer.java", "committedDate": "2020-06-06T19:04:56Z", "type": "forcePushed"}, {"oid": "9dd1c55ea69409dd3b2b1216655d58107e736b9f", "url": "https://github.com/ankidroid/Anki-Android/commit/9dd1c55ea69409dd3b2b1216655d58107e736b9f", "message": "\tUpdated AbstractFlashcardViewer.java", "committedDate": "2020-06-09T16:21:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU2NDE2Ng==", "url": "https://github.com/ankidroid/Anki-Android/pull/6387#discussion_r437564166", "bodyText": "nit: extract to isInFullScreen", "author": "david-allison-1", "createdAt": "2020-06-09T16:30:11Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -3080,6 +3082,26 @@ private boolean filterUrl(String url) {\n                 mFlipCardLayout.performClick();\n                 return true;\n             }\n+            // Show options menu from WebView\n+            if (url.startsWith(\"signal:anki_show_options_menu\")) {\n+                if (!getSupportActionBar().isShowing()) {\n+                    openOptionsMenu();\n+                } else {\n+                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen,\"ankiShowOptionsMenu\"), true);\n+                }\n+                return true;\n+            }\n+\n+            // Show Navigation Drawer from WebView\n+            if (url.startsWith(\"signal:anki_show_navigation_drawer\")) {\n+                if (!getSupportActionBar().isShowing()) {", "originalCommit": "9dd1c55ea69409dd3b2b1216655d58107e736b9f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "771dbe63da837aae4357c1a27023867b7dd3b7f9", "chunk": "diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\nindex 419e894a39..1c4e0e03ae 100644\n--- a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\n+++ b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\n\n@@ -3084,17 +3088,17 @@ public abstract class AbstractFlashcardViewer extends NavigationDrawerActivity i\n             }\n             // Show options menu from WebView\n             if (url.startsWith(\"signal:anki_show_options_menu\")) {\n-                if (!getSupportActionBar().isShowing()) {\n+                if (isInFullscreen) {\n                     openOptionsMenu();\n                 } else {\n-                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen,\"ankiShowOptionsMenu\"), true);\n+                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen, \"ankiShowOptionsMenu\"), true);\n                 }\n                 return true;\n             }\n \n             // Show Navigation Drawer from WebView\n             if (url.startsWith(\"signal:anki_show_navigation_drawer\")) {\n-                if (!getSupportActionBar().isShowing()) {\n+                if (isInFullscreen) {\n                     AbstractFlashcardViewer.this.onNavigationPressed();\n                 } else {\n                     UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen, \"ankiShowNavDrawer\"), true);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU2NDMxNw==", "url": "https://github.com/ankidroid/Anki-Android/pull/6387#discussion_r437564317", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen,\"ankiShowOptionsMenu\"), true);\n          \n          \n            \n                                UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen, \"ankiShowOptionsMenu\"), true);", "author": "david-allison-1", "createdAt": "2020-06-09T16:30:28Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -3080,6 +3082,26 @@ private boolean filterUrl(String url) {\n                 mFlipCardLayout.performClick();\n                 return true;\n             }\n+            // Show options menu from WebView\n+            if (url.startsWith(\"signal:anki_show_options_menu\")) {\n+                if (!getSupportActionBar().isShowing()) {\n+                    openOptionsMenu();\n+                } else {\n+                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen,\"ankiShowOptionsMenu\"), true);", "originalCommit": "9dd1c55ea69409dd3b2b1216655d58107e736b9f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "771dbe63da837aae4357c1a27023867b7dd3b7f9", "chunk": "diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\nindex 419e894a39..1c4e0e03ae 100644\n--- a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\n+++ b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\n\n@@ -3084,17 +3088,17 @@ public abstract class AbstractFlashcardViewer extends NavigationDrawerActivity i\n             }\n             // Show options menu from WebView\n             if (url.startsWith(\"signal:anki_show_options_menu\")) {\n-                if (!getSupportActionBar().isShowing()) {\n+                if (isInFullscreen) {\n                     openOptionsMenu();\n                 } else {\n-                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen,\"ankiShowOptionsMenu\"), true);\n+                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen, \"ankiShowOptionsMenu\"), true);\n                 }\n                 return true;\n             }\n \n             // Show Navigation Drawer from WebView\n             if (url.startsWith(\"signal:anki_show_navigation_drawer\")) {\n-                if (!getSupportActionBar().isShowing()) {\n+                if (isInFullscreen) {\n                     AbstractFlashcardViewer.this.onNavigationPressed();\n                 } else {\n                     UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen, \"ankiShowNavDrawer\"), true);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU2NTE0Mg==", "url": "https://github.com/ankidroid/Anki-Android/pull/6387#discussion_r437565142", "bodyText": "I'm not sure if we want a toast here. It'll mean nothing to the end-user. what do you think?", "author": "david-allison-1", "createdAt": "2020-06-09T16:31:48Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -3080,6 +3082,26 @@ private boolean filterUrl(String url) {\n                 mFlipCardLayout.performClick();\n                 return true;\n             }\n+            // Show options menu from WebView\n+            if (url.startsWith(\"signal:anki_show_options_menu\")) {\n+                if (!getSupportActionBar().isShowing()) {\n+                    openOptionsMenu();\n+                } else {\n+                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen,\"ankiShowOptionsMenu\"), true);\n+                }\n+                return true;\n+            }\n+\n+            // Show Navigation Drawer from WebView\n+            if (url.startsWith(\"signal:anki_show_navigation_drawer\")) {\n+                if (!getSupportActionBar().isShowing()) {\n+                    AbstractFlashcardViewer.this.onNavigationPressed();\n+                } else {\n+                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen, \"ankiShowNavDrawer\"), true);", "originalCommit": "9dd1c55ea69409dd3b2b1216655d58107e736b9f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU3NDMwMg==", "url": "https://github.com/ankidroid/Anki-Android/pull/6387#discussion_r437574302", "bodyText": "If a button present on screen for showing options menu and navigation menu then, but pressing  on button do nothing, then might be one message should be shown, \"Why that button not working?\"\nOne thing may be done, it should be added in manual, how it can be used and implemented.", "author": "infinyte7", "createdAt": "2020-06-09T16:47:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU2NTE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY5NzQ5Mw==", "url": "https://github.com/ankidroid/Anki-Android/pull/6387#discussion_r439697493", "bodyText": "I'm not sure about including the javascript function name, rather than the name of the feature.\nAside from that, it seems fine. Implementer's choice", "author": "david-allison-1", "createdAt": "2020-06-13T01:40:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU2NTE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcxMTkyMQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6387#discussion_r439711921", "bodyText": "I have added different message now.\nMay be better than earlier.", "author": "infinyte7", "createdAt": "2020-06-13T05:43:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU2NTE0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "771dbe63da837aae4357c1a27023867b7dd3b7f9", "chunk": "diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\nindex 419e894a39..1c4e0e03ae 100644\n--- a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\n+++ b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java\n\n@@ -3084,17 +3088,17 @@ public abstract class AbstractFlashcardViewer extends NavigationDrawerActivity i\n             }\n             // Show options menu from WebView\n             if (url.startsWith(\"signal:anki_show_options_menu\")) {\n-                if (!getSupportActionBar().isShowing()) {\n+                if (isInFullscreen) {\n                     openOptionsMenu();\n                 } else {\n-                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen,\"ankiShowOptionsMenu\"), true);\n+                    UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen, \"ankiShowOptionsMenu\"), true);\n                 }\n                 return true;\n             }\n \n             // Show Navigation Drawer from WebView\n             if (url.startsWith(\"signal:anki_show_navigation_drawer\")) {\n-                if (!getSupportActionBar().isShowing()) {\n+                if (isInFullscreen) {\n                     AbstractFlashcardViewer.this.onNavigationPressed();\n                 } else {\n                     UIUtils.showThemedToast(AbstractFlashcardViewer.this, getString(R.string.ankidroid_turn_on_fullscreen, \"ankiShowNavDrawer\"), true);\n"}}, {"oid": "771dbe63da837aae4357c1a27023867b7dd3b7f9", "url": "https://github.com/ankidroid/Anki-Android/commit/771dbe63da837aae4357c1a27023867b7dd3b7f9", "message": "\tUpdated AbstractFlashcardViewer.java", "committedDate": "2020-06-09T16:49:31Z", "type": "commit"}, {"oid": "4146240ae97d940cea17c98d9cfbab8f3da74e90", "url": "https://github.com/ankidroid/Anki-Android/commit/4146240ae97d940cea17c98d9cfbab8f3da74e90", "message": "\tAdded Show options Menu & Nav Drawer Using WebView\n\n\tUpdated AbstractFlashcardViewer.java\n\n\tUpdated AbstractFlashcardViewer.java\n\n\tUpdated AbstractFlashcardViewer.java\n\n\tUpdated AbstractFlashcardViewer.java\n\n\tUpdated AbstractFlashcardViewer.java", "committedDate": "2020-06-09T16:58:06Z", "type": "commit"}, {"oid": "27f734eafe0491e1033dcb6c7cdd1b34c00cc927", "url": "https://github.com/ankidroid/Anki-Android/commit/27f734eafe0491e1033dcb6c7cdd1b34c00cc927", "message": "Merge branch 'feature-branch-2' of https://github.com/infinyte7/Anki-Android into feature-branch-2", "committedDate": "2020-06-09T16:59:49Z", "type": "commit"}, {"oid": "cb67d112b45242107f4dd334724c2ea66f56702c", "url": "https://github.com/ankidroid/Anki-Android/commit/cb67d112b45242107f4dd334724c2ea66f56702c", "message": "\tUpdated AbstractFlashcardViewer.java", "committedDate": "2020-06-09T17:06:27Z", "type": "commit"}, {"oid": "aa3bf848cd596563a4214aeb1b21ffd6c71df0c7", "url": "https://github.com/ankidroid/Anki-Android/commit/aa3bf848cd596563a4214aeb1b21ffd6c71df0c7", "message": "\tUpdated AbstractFlashcardViewer.java", "committedDate": "2020-06-09T17:14:45Z", "type": "commit"}, {"oid": "0e8a652c642a5791cd6d0eadd2697bb0cebbab2b", "url": "https://github.com/ankidroid/Anki-Android/commit/0e8a652c642a5791cd6d0eadd2697bb0cebbab2b", "message": "Updated 02-string.xml", "committedDate": "2020-06-13T05:42:51Z", "type": "commit"}]}