{"pr_number": 7916, "pr_title": "Expender", "pr_createdAt": "2020-12-20T02:14:59Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/7916", "timeline": [{"oid": "0c151c3be0a558045e81191c3499aa2a90799afe", "url": "https://github.com/ankidroid/Anki-Android/commit/0c151c3be0a558045e81191c3499aa2a90799afe", "message": "remove deck expander instead of hiding it\n\nThis is NF when you use Anki's screen. However, it's not NF when you use helper, since the button where still\npresent. This means that this change remove an accessibility problem, shown by the scanner.", "committedDate": "2020-12-20T02:15:23Z", "type": "forcePushed"}, {"oid": "8135ef6f67d954decf0e1e57f5dcb643b6676aaf", "url": "https://github.com/ankidroid/Anki-Android/commit/8135ef6f67d954decf0e1e57f5dcb643b6676aaf", "message": "remove deck expander instead of hiding it\n\nThis is NF when you use Anki's screen. However, it's not NF when you use helper, since the button where still\npresent. This means that this change remove an accessibility problem, shown by the scanner.", "committedDate": "2020-12-20T02:29:02Z", "type": "forcePushed"}, {"oid": "49b0311f766ab614f1c06226c2b654f432049872", "url": "https://github.com/ankidroid/Anki-Android/commit/49b0311f766ab614f1c06226c2b654f432049872", "message": "remove deck expander instead of hiding it\n\nThis is NF when you use Anki's screen. However, it's not NF when you use helper, since the button where still\npresent. This means that this change remove an accessibility problem, shown by the scanner.", "committedDate": "2020-12-20T04:37:09Z", "type": "forcePushed"}, {"oid": "0f01db31014a66d28926b55b26a04fd337aa09c6", "url": "https://github.com/ankidroid/Anki-Android/commit/0f01db31014a66d28926b55b26a04fd337aa09c6", "message": "Expander content description set to null when not used\n\nAccording to android doc, it seems it should be put to @null to indicate to screen reader it should not be considered.\nIt's not clear whether null should be a string or how to do it in general.", "committedDate": "2020-12-20T06:32:25Z", "type": "forcePushed"}, {"oid": "50c765a5deaa41d48e2aed22ec807fd1b38bbc54", "url": "https://github.com/ankidroid/Anki-Android/commit/50c765a5deaa41d48e2aed22ec807fd1b38bbc54", "message": "Accessibility of expander indicated\n\nIdeally, I'd like just to delete the expender when it is not necessary. However, the same expender may be used for\ndifferent before and after collapse, so it must keep existing (or be added again, which is hard).\nInstead, indicating that it is not required for accessibility, but here only for UI is okay", "committedDate": "2020-12-20T06:53:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM4NzY3NA==", "url": "https://github.com/ankidroid/Anki-Android/pull/7916#discussion_r546387674", "bodyText": "Optional: It'd be useful to add an integration test to confirm that if a child is added, the expander is visible.\nI believe this is fine currently, as the control is fully refreshed, but this behaviour is subject to change in the future.", "author": "david-allison-1", "createdAt": "2020-12-20T14:56:14Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/widgets/DeckAdapter.java", "diffHunk": "@@ -217,7 +220,7 @@ public void onBindViewHolder(ViewHolder holder, int position) {\n             holder.deckExpander.setTag(node.getDid());\n             holder.deckExpander.setOnClickListener(mDeckExpanderClickListener);\n         } else {\n-            holder.deckExpander.setOnClickListener(null);\n+            holder.deckExpander.setClickable(false);", "originalCommit": "50c765a5deaa41d48e2aed22ec807fd1b38bbc54", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM5OTYxNA==", "url": "https://github.com/ankidroid/Anki-Android/pull/7916#discussion_r546399614", "bodyText": "Can you please let me know what you mean by \"child is added\". As far as I understand, there is no notion of \"adding\" in the deck picker process. Checking whether a collection is displayed properly seems useful. Checking changes does not seems to have sens here as far as I can tell", "author": "Arthur-Milchior", "createdAt": "2020-12-20T16:34:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM4NzY3NA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "d43d20f20ac4e2f67b2407251d6210cafdfc8867", "url": "https://github.com/ankidroid/Anki-Android/commit/d43d20f20ac4e2f67b2407251d6210cafdfc8867", "message": "Deactivate deck expander button instead of just nullifying its action", "committedDate": "2020-12-21T17:33:26Z", "type": "commit"}, {"oid": "261cab2609a3bbe1abcade7d19c5ac16eb31ed07", "url": "https://github.com/ankidroid/Anki-Android/commit/261cab2609a3bbe1abcade7d19c5ac16eb31ed07", "message": "Accessibility of expander indicated\n\nIdeally, I'd like just to delete the expender when it is not necessary. However, the same expender may be used for\ndifferent before and after collapse, so it must keep existing (or be added again, which is hard).\nInstead, indicating that it is not required for accessibility, but here only for UI is okay", "committedDate": "2020-12-21T17:33:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjgzODc2NQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/7916#discussion_r546838765", "bodyText": "the YES constant here is unused it appears?", "author": "mikehardy", "createdAt": "2020-12-21T17:37:38Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/widgets/DeckAdapter.java", "diffHunk": "@@ -51,6 +51,9 @@\n import java.util.List;\n import java.util.Locale;\n \n+import static android.view.View.IMPORTANT_FOR_ACCESSIBILITY_NO;\n+import static android.view.View.IMPORTANT_FOR_ACCESSIBILITY_YES;", "originalCommit": "261cab2609a3bbe1abcade7d19c5ac16eb31ed07", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg1MzYwMQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/7916#discussion_r546853601", "bodyText": "Bad merge. Thanks for catching it. It's important, because without this extra line, when the first subdeck is added to a deck, the \"collapse\" button would not have been found by accessibility app I fear", "author": "Arthur-Milchior", "createdAt": "2020-12-21T18:09:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjgzODc2NQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "30be3e93207509ef22e2683a166c3828280239cd", "url": "https://github.com/ankidroid/Anki-Android/commit/30be3e93207509ef22e2683a166c3828280239cd", "message": "Accessibility of expander indicated\n\nIdeally, I'd like just to delete the expender when it is not necessary. However, the same expender may be used for\ndifferent before and after collapse, so it must keep existing (or be added again, which is hard).\nInstead, indicating that it is not required for accessibility, but here only for UI is okay", "committedDate": "2020-12-21T18:08:24Z", "type": "commit"}, {"oid": "30be3e93207509ef22e2683a166c3828280239cd", "url": "https://github.com/ankidroid/Anki-Android/commit/30be3e93207509ef22e2683a166c3828280239cd", "message": "Accessibility of expander indicated\n\nIdeally, I'd like just to delete the expender when it is not necessary. However, the same expender may be used for\ndifferent before and after collapse, so it must keep existing (or be added again, which is hard).\nInstead, indicating that it is not required for accessibility, but here only for UI is okay", "committedDate": "2020-12-21T18:08:24Z", "type": "forcePushed"}]}