{"pr_number": 6250, "pr_title": "Card Browser: \"Search All Decks\" button if no results", "pr_createdAt": "2020-05-22T14:00:41Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/6250", "timeline": [{"oid": "f39d27f9648aad7d8755604b10dc9c9e69ce2666", "url": "https://github.com/ankidroid/Anki-Android/commit/f39d27f9648aad7d8755604b10dc9c9e69ce2666", "message": "NF: Extract handleSearchResult", "committedDate": "2020-05-22T12:26:19Z", "type": "commit"}, {"oid": "1dddd1cf47f5bb0cf60d9d0be129f1ecae069e3e", "url": "https://github.com/ankidroid/Anki-Android/commit/1dddd1cf47f5bb0cf60d9d0be129f1ecae069e3e", "message": "NF: Extract getCardCount", "committedDate": "2020-05-22T14:09:42Z", "type": "commit"}, {"oid": "67415a0ad4820eb62662ee6a363dc33a4797c7f2", "url": "https://github.com/ankidroid/Anki-Android/commit/67415a0ad4820eb62662ee6a363dc33a4797c7f2", "message": "Browser: \"Search All Decks\" button if no results\n\nAllow a user to search all decks if there was no results for a search\n\nThis is fairly simple and makes the 'Card Browser' item much more\neffective.\n\nFixes #5159", "committedDate": "2020-05-22T14:11:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2MzI0NQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6250#discussion_r429363245", "bodyText": "I hesitate on this choice - is it occluding / hiding elements by being on top of them? If so the material guidelines used to state transient elements should never be permanent, and indefinite length is actually sort of new here. Maybe 2*LONG but not permanent? Or if it is not hiding anything (and actually, it may not be) then this is okay, but any new set of results or another search  should dismiss it", "author": "mikehardy", "createdAt": "2020-05-22T17:13:18Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/CardBrowser.java", "diffHunk": "@@ -1699,11 +1701,54 @@ private void handleSearchResult() {\n             Timber.i(\"CardBrowser:: Completed doInBackgroundSearchCards Successfully\");\n             updateList();\n             if ((mSearchView != null) && !mSearchView.isIconified()) {\n-                UIUtils.showSimpleSnackbar(CardBrowser.this, getSubtitleText(), true);\n+                if (getCardCount() == 0 && !hasSelectedAllDecks()) {\n+                    View root = CardBrowser.this.findViewById(R.id.root_layout);\n+                    UIUtils.showSnackbar(CardBrowser.this,\n+                            getString(R.string.card_browser_no_cards_in_deck, getSelectedDeckNameForUi()),\n+                            LENGTH_INDEFINITE,", "originalCommit": "67415a0ad4820eb62662ee6a363dc33a4797c7f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2ODkyNQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6250#discussion_r429368925", "bodyText": "Today I learned, let's use CardBrowser.SNACKBAR_DURATION (8000)?", "author": "david-allison-1", "createdAt": "2020-05-22T17:26:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2MzI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM4MTYzMw==", "url": "https://github.com/ankidroid/Anki-Android/pull/6250#discussion_r429381633", "bodyText": "8000 would certainly be transient so wouldn't ever really have a problem and then you won't have to worry about dismissing. Still might be strange if they do any other search and the snackbar stays there, but they'll be racing an 8 second timer at that point. Possible some people could win but not by much. 8's fine by me", "author": "mikehardy", "createdAt": "2020-05-22T17:54:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM2MzI0NQ=="}], "type": "inlineReview", "revised_code": {"commit": "9826af9d7a9178d17ce4e8534b0ae48e26b466d5", "chunk": "diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/CardBrowser.java b/AnkiDroid/src/main/java/com/ichi2/anki/CardBrowser.java\nindex 65b60cc281..5090ede3e3 100644\n--- a/AnkiDroid/src/main/java/com/ichi2/anki/CardBrowser.java\n+++ b/AnkiDroid/src/main/java/com/ichi2/anki/CardBrowser.java\n\n@@ -1705,7 +1703,7 @@ public class CardBrowser extends NavigationDrawerActivity implements\n                     View root = CardBrowser.this.findViewById(R.id.root_layout);\n                     UIUtils.showSnackbar(CardBrowser.this,\n                             getString(R.string.card_browser_no_cards_in_deck, getSelectedDeckNameForUi()),\n-                            LENGTH_INDEFINITE,\n+                            SNACKBAR_DURATION,\n                             R.string.card_browser_search_all_decks,\n                             (v) -> searchAllDecks(),\n                             root,\n"}}, {"oid": "9826af9d7a9178d17ce4e8534b0ae48e26b466d5", "url": "https://github.com/ankidroid/Anki-Android/commit/9826af9d7a9178d17ce4e8534b0ae48e26b466d5", "message": "Browser: \"Search All Decks\" button if no results\n\nAllow a user to search all decks if there was no results for a search\n\nThis is fairly simple and makes the 'Card Browser' item much more\neffective.\n\nFixes #5159", "committedDate": "2020-05-22T17:54:31Z", "type": "forcePushed"}, {"oid": "a7157ce395bc58cf2bcd9d2ecc72106395d4d1d7", "url": "https://github.com/ankidroid/Anki-Android/commit/a7157ce395bc58cf2bcd9d2ecc72106395d4d1d7", "message": "NF: Extract selectAllDecks", "committedDate": "2020-05-22T17:57:12Z", "type": "commit"}, {"oid": "079b268e88a7114eb0b383ef552b206978e56260", "url": "https://github.com/ankidroid/Anki-Android/commit/079b268e88a7114eb0b383ef552b206978e56260", "message": "Browser: \"Search All Decks\" button if no results\n\nAllow a user to search all decks if there was no results for a search\n\nThis is fairly simple and makes the 'Card Browser' item much more\neffective.\n\nFixes #5159", "committedDate": "2020-05-22T17:57:12Z", "type": "commit"}, {"oid": "079b268e88a7114eb0b383ef552b206978e56260", "url": "https://github.com/ankidroid/Anki-Android/commit/079b268e88a7114eb0b383ef552b206978e56260", "message": "Browser: \"Search All Decks\" button if no results\n\nAllow a user to search all decks if there was no results for a search\n\nThis is fairly simple and makes the 'Card Browser' item much more\neffective.\n\nFixes #5159", "committedDate": "2020-05-22T17:57:12Z", "type": "forcePushed"}]}