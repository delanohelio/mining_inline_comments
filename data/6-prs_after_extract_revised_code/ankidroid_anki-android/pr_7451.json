{"pr_number": 7451, "pr_title": "Empty card: update at most once by second", "pr_createdAt": "2020-10-23T14:17:35Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/7451", "timeline": [{"oid": "0d742eda1159549d5e0f5074fd1f8f4eb2b774a1", "url": "https://github.com/ankidroid/Anki-Android/commit/0d742eda1159549d5e0f5074fd1f8f4eb2b774a1", "message": "Empty card: update at most once by second\n\nChecking the profiler, I see that some significant amount of time is spent enqueuing various update. This is uselessly\nlong when empty card is optimized", "committedDate": "2020-10-23T20:27:05Z", "type": "forcePushed"}, {"oid": "1a2cccecdf4b936514fbd02c03497bff0e2d8f6b", "url": "https://github.com/ankidroid/Anki-Android/commit/1a2cccecdf4b936514fbd02c03497bff0e2d8f6b", "message": "Empty card: update at most once by second\n\nChecking the profiler, I see that some significant amount of time is spent enqueuing various update. This is uselessly\nlong when empty card is optimized", "committedDate": "2020-10-23T20:30:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE0Nzg2Nw==", "url": "https://github.com/ankidroid/Anki-Android/pull/7451#discussion_r511147867", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        // Time in second, so this ensure one update by second at most\n          \n          \n            \n                        // Ensure updates only happen if more than a percent of progress happened", "author": "mikehardy", "createdAt": "2020-10-23T20:46:51Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java", "diffHunk": "@@ -2818,7 +2821,12 @@ public void actualOnPreExecute(@NonNull DeckPicker deckPicker) {\n \n         @Override\n         public void actualOnProgressUpdate(@NonNull DeckPicker deckPicker, @NonNull TaskData progress) {\n-            deckPicker.mProgressDialog.incrementProgress(progress.getInt());\n+            mIncreaseSinceLastUpdate += progress.getInt();\n+            // Time in second, so this ensure one update by second at most", "originalCommit": "1a2cccecdf4b936514fbd02c03497bff0e2d8f6b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f273541ff8ce7893820f52522270cb2c4ed27353", "chunk": "diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java b/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java\nindex dae3c5c20..73e80f22e 100644\n--- a/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java\n+++ b/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java\n\n@@ -2822,7 +2822,7 @@ public class DeckPicker extends NavigationDrawerActivity implements\n         @Override\n         public void actualOnProgressUpdate(@NonNull DeckPicker deckPicker, @NonNull TaskData progress) {\n             mIncreaseSinceLastUpdate += progress.getInt();\n-            // Time in second, so this ensure one update by second at most\n+            // Increase each time at least a percent of card has been processed since last update\n             if (mIncreaseSinceLastUpdate > mOnePercent) {\n                 deckPicker.mProgressDialog.incrementProgress(mIncreaseSinceLastUpdate);\n                 mIncreaseSinceLastUpdate = 0;\n"}}, {"oid": "f273541ff8ce7893820f52522270cb2c4ed27353", "url": "https://github.com/ankidroid/Anki-Android/commit/f273541ff8ce7893820f52522270cb2c4ed27353", "message": "Empty card: update at most once by second\n\nChecking the profiler, I see that some significant amount of time is spent enqueuing various update. This is uselessly\nlong when empty card is optimized", "committedDate": "2020-10-23T21:03:51Z", "type": "commit"}, {"oid": "f273541ff8ce7893820f52522270cb2c4ed27353", "url": "https://github.com/ankidroid/Anki-Android/commit/f273541ff8ce7893820f52522270cb2c4ed27353", "message": "Empty card: update at most once by second\n\nChecking the profiler, I see that some significant amount of time is spent enqueuing various update. This is uselessly\nlong when empty card is optimized", "committedDate": "2020-10-23T21:03:51Z", "type": "forcePushed"}]}