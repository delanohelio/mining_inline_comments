{"pr_number": 1933, "pr_title": "1481: Adding Option to Disable Mothball Information Save", "pr_createdAt": "2020-08-17T18:28:27Z", "pr_url": "https://github.com/MegaMek/mekhq/pull/1933", "timeline": [{"oid": "628a6594b6010d0ea061eb44ae314863d86d09f8", "url": "https://github.com/MegaMek/mekhq/commit/628a6594b6010d0ea061eb44ae314863d86d09f8", "message": "fixing mothball info xml save indent", "committedDate": "2020-08-17T18:01:24Z", "type": "commit"}, {"oid": "fbe00d14fddbaacd67b6e15031bfdcf4ebfac323", "url": "https://github.com/MegaMek/mekhq/commit/fbe00d14fddbaacd67b6e15031bfdcf4ebfac323", "message": "Adding an option to disable mothball info save", "committedDate": "2020-08-17T18:27:17Z", "type": "commit"}, {"oid": "484089a0bf2f5970d4b50ad0681f9c7952924cd5", "url": "https://github.com/MegaMek/mekhq/commit/484089a0bf2f5970d4b50ad0681f9c7952924cd5", "message": "Fixing GM mothball unit and activate unit menu item names", "committedDate": "2020-08-17T18:28:04Z", "type": "commit"}, {"oid": "07693870e9f4fd374a0fce054cc389a5fd19404e", "url": "https://github.com/MegaMek/mekhq/commit/07693870e9f4fd374a0fce054cc389a5fd19404e", "message": "Merge branch 'master' into dev_Windchild_1481", "committedDate": "2020-08-26T23:43:58Z", "type": "commit"}, {"oid": "68d2a902843218d27a5a5f1b86901419664c2919", "url": "https://github.com/MegaMek/mekhq/commit/68d2a902843218d27a5a5f1b86901419664c2919", "message": "Merge remote-tracking branch 'upstream/master' into dev_Windchild_1481", "committedDate": "2020-08-29T14:29:15Z", "type": "commit"}, {"oid": "6ae819a8a4903a5509c757fb934c3298619a1027", "url": "https://github.com/MegaMek/mekhq/commit/6ae819a8a4903a5509c757fb934c3298619a1027", "message": "Converting to use MekHQConstants", "committedDate": "2020-08-29T14:54:28Z", "type": "commit"}, {"oid": "76a9f538934f7e8d36d8b45ef3e7c0fcf3ffdd3f", "url": "https://github.com/MegaMek/mekhq/commit/76a9f538934f7e8d36d8b45ef3e7c0fcf3ffdd3f", "message": "Fixing merge conflicts", "committedDate": "2020-09-17T05:09:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0MTMxNA==", "url": "https://github.com/MegaMek/mekhq/pull/1933#discussion_r491641314", "bodyText": "Why add campaign as a parameter here? We already have a pointer to the campaign in the Unit class, so it seems unnecessary.", "author": "NickAragua", "createdAt": "2020-09-20T01:57:53Z", "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -4508,8 +4508,8 @@ public void startMothballing(UUID id) {\n      * @param isGM A value indicating if the mothball action should\n      *             be performed immediately by the GM.\n      */\n-    public void startMothballing(UUID id, boolean isGM) {\n-        if (!isMothballed()) {\n+    public void startMothballing(Campaign campaign, UUID id, boolean isGM) {\n+        if (!isMothballed() && MekHQ.getMekHQOptions().getSaveMothballState()) {", "originalCommit": "76a9f538934f7e8d36d8b45ef3e7c0fcf3ffdd3f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0NjU1Ng==", "url": "https://github.com/MegaMek/mekhq/pull/1933#discussion_r491646556", "bodyText": "Better code style, and unit should not include a pointer to campaign for OOP.", "author": "Windchild292", "createdAt": "2020-09-20T03:21:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0MTMxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0OTc1Ng==", "url": "https://github.com/MegaMek/mekhq/pull/1933#discussion_r491649756", "bodyText": "Eye of the beholder (I personally find it highly annoying to pass campaign objects around every time I call a method), and not sure object-oriented programming principles recommend one way or the other in terms of keeping pointers to frequently-referenced objects.\nYou can make the argument that \"startMothballing\" doesn't necessarily belong in the Unit class and instead should be moved to some kind of static(?) method in a worker class (e.g. \"UnitActionProcessor.startMothballing\"), if you want to say that we should avoid mixing data and \"business logic\" in the same class. As it is, this particular change does nothing to either simplify or improve the code in any meaningful way.", "author": "NickAragua", "createdAt": "2020-09-20T04:12:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0MTMxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM2NjI4Mg==", "url": "https://github.com/MegaMek/mekhq/pull/1933#discussion_r496366282", "bodyText": "I actually agree with you that it is annoying, but it is part of how to handle Objects. Namely, you are supposed to pass the reference in methods when they do not need to be stored with the data for that Object and are entirely external.. and this decoupling may make some future code easier (including a few bits of a longer project I'm working on with person and unit)\nThe rest is arguable from my experience, and not something I would say.", "author": "Windchild292", "createdAt": "2020-09-29T04:09:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0MTMxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcxOTU0OA==", "url": "https://github.com/MegaMek/mekhq/pull/1933#discussion_r496719548", "bodyText": "If this isn't going to get a different Campaign object than the unit's, then it shouldn't be added, just adds an argument without benefit. We can dream to refactor Unit to not include the Campaign, but until then best to follow \"When in Rome.\"", "author": "sixlettervariables", "createdAt": "2020-09-29T13:32:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0MTMxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njc0MDIwMw==", "url": "https://github.com/MegaMek/mekhq/pull/1933#discussion_r496740203", "bodyText": "Reverted.", "author": "Windchild292", "createdAt": "2020-09-29T13:58:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0MTMxNA=="}], "type": "inlineReview", "revised_code": {"commit": "63a3bfbb95207bc7662d65ae05c83e61eff90f2e", "chunk": "diff --git a/MekHQ/src/mekhq/campaign/unit/Unit.java b/MekHQ/src/mekhq/campaign/unit/Unit.java\nindex 67511e5bd..48e81c385 100644\n--- a/MekHQ/src/mekhq/campaign/unit/Unit.java\n+++ b/MekHQ/src/mekhq/campaign/unit/Unit.java\n\n@@ -4508,13 +4505,13 @@ public class Unit implements MekHqXmlSerializable, ITechnology {\n      * @param isGM A value indicating if the mothball action should\n      *             be performed immediately by the GM.\n      */\n-    public void startMothballing(Campaign campaign, UUID id, boolean isGM) {\n+    public void startMothballing(UUID id, boolean isGM) {\n         if (!isMothballed() && MekHQ.getMekHQOptions().getSaveMothballState()) {\n             mothballInfo = new MothballInfo(this);\n         }\n \n         //set this person as tech\n-        if (!isSelfCrewed() && null != tech && !tech.equals(id)) {\n+        if (!isSelfCrewed() && (null != tech) && !tech.equals(id)) {\n             if (null != getTech()) {\n                 remove(getTech(), true);\n             }\n"}}, {"oid": "c88636664e79d40e98886f243901046ddf9f8bf4", "url": "https://github.com/MegaMek/mekhq/commit/c88636664e79d40e98886f243901046ddf9f8bf4", "message": "Fixing merge conflicts", "committedDate": "2020-09-20T03:51:58Z", "type": "commit"}, {"oid": "594175ad8ac9d6d45d71f8ab41ece31a048a74be", "url": "https://github.com/MegaMek/mekhq/commit/594175ad8ac9d6d45d71f8ab41ece31a048a74be", "message": "Merge branch 'master' into dev_Windchild_1481", "committedDate": "2020-09-22T02:54:55Z", "type": "commit"}, {"oid": "697d9367b3183d3734d3d0492c09c795bd41e0e5", "url": "https://github.com/MegaMek/mekhq/commit/697d9367b3183d3734d3d0492c09c795bd41e0e5", "message": "Merge remote-tracking branch 'upstream/master' into dev_Windchild_1481", "committedDate": "2020-09-29T13:52:57Z", "type": "commit"}, {"oid": "63a3bfbb95207bc7662d65ae05c83e61eff90f2e", "url": "https://github.com/MegaMek/mekhq/commit/63a3bfbb95207bc7662d65ae05c83e61eff90f2e", "message": "Reverting campaign parameter addition", "committedDate": "2020-09-29T13:57:54Z", "type": "commit"}]}