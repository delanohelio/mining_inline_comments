{"pr_number": 976, "pr_title": "Fix #967", "pr_createdAt": "2020-03-18T22:38:26Z", "pr_url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/976", "timeline": [{"oid": "97c5d9fa6f5d666a592a4e8994065fb3c5468bb7", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/97c5d9fa6f5d666a592a4e8994065fb3c5468bb7", "message": "Fix #967", "committedDate": "2020-03-18T22:12:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4NDM1OQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/976#discussion_r394684359", "bodyText": "nit: move these inside \"else\"? (line 1837 to 1846)", "author": "rpdome", "createdAt": "2020-03-18T22:52:22Z", "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java", "diffHunk": "@@ -1821,4 +1832,41 @@ public void onError(MsalException exception) {\n             throw result.getException();\n         }\n     }\n+\n+    void performMigration(@NonNull final TokenMigrationCallback callback) {\n+        // Create the SharedPreferencesFileManager for the legacy accounts/credentials", "originalCommit": "97c5d9fa6f5d666a592a4e8994065fb3c5468bb7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTEzMzM4Ng==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/976#discussion_r395133386", "bodyText": "Addressed", "author": "shahzaibj", "createdAt": "2020-03-19T15:54:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4NDM1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "d4d36d2ab71767a33014e3d7c3aab5be4edaca07", "chunk": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java\nindex 2fae3407..97f32a4b 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java\n\n@@ -1834,18 +1834,6 @@ public class PublicClientApplication implements IPublicClientApplication, IToken\n     }\n \n     void performMigration(@NonNull final TokenMigrationCallback callback) {\n-        // Create the SharedPreferencesFileManager for the legacy accounts/credentials\n-        final IStorageHelper storageHelper = new StorageHelper(mPublicClientConfiguration.getAppContext());\n-        final ISharedPreferencesFileManager sharedPreferencesFileManager =\n-                new SharedPreferencesFileManager(\n-                        mPublicClientConfiguration.getAppContext(),\n-                        \"com.microsoft.aad.adal.cache\",\n-                        storageHelper\n-                );\n-\n-        // Load the old TokenCacheItems as key/value JSON\n-        final Map<String, String> credentials = sharedPreferencesFileManager.getAll();\n-\n         final Map<String, String> redirects = new HashMap<>();\n         redirects.put(\n                 mPublicClientConfiguration.getClientId(), // Our client id\n"}}, {"oid": "d4d36d2ab71767a33014e3d7c3aab5be4edaca07", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/d4d36d2ab71767a33014e3d7c3aab5be4edaca07", "message": "Address comment", "committedDate": "2020-03-19T15:54:22Z", "type": "commit"}, {"oid": "89aab9279aa57a4ee1eb2bc940cfa22338a5b8ff", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/89aab9279aa57a4ee1eb2bc940cfa22338a5b8ff", "message": "Merge branch 'dev' into shahzaibj/migration-fixes", "committedDate": "2020-03-20T06:22:35Z", "type": "commit"}]}