{"pr_number": 4898, "pr_title": "Refactor HttpServletMapping to avoid tracking servletPath separately", "pr_createdAt": "2020-05-20T20:47:27Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/4898", "timeline": [{"oid": "b69e2704c33aa654842347c57cd91744a607fa9b", "url": "https://github.com/eclipse/jetty.project/commit/b69e2704c33aa654842347c57cd91744a607fa9b", "message": "Issue #4741 HttpServletMapping\n\nThis completes the refactoring started in #4851, using\nthe HttpServletMapping field to avoid having the servletPath field\nin the Request and instead have a pathInContext field.\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-05-20T20:46:01Z", "type": "commit"}, {"oid": "75f5d5a95a075392a4437a3152fbd0be675d5d53", "url": "https://github.com/eclipse/jetty.project/commit/75f5d5a95a075392a4437a3152fbd0be675d5d53", "message": "Issue #4741 HttpServletMapping\n\nreverted ResourceService changes\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-05-21T12:49:30Z", "type": "commit"}, {"oid": "e6a1b4bec308ff140ed9789cbc9e0a8150d5817b", "url": "https://github.com/eclipse/jetty.project/commit/e6a1b4bec308ff140ed9789cbc9e0a8150d5817b", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4741-NoServletPath", "committedDate": "2020-05-25T10:32:59Z", "type": "commit"}, {"oid": "d8e4ca3fe3d0b4ee477b05fe7a43b9c18ab25250", "url": "https://github.com/eclipse/jetty.project/commit/d8e4ca3fe3d0b4ee477b05fe7a43b9c18ab25250", "message": "Issue #4741 HttpServletMapping\n\nfixed gzip handler\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-05-25T10:36:17Z", "type": "commit"}, {"oid": "47bbccd55f25ed0618fe059e2d759c1d304688d4", "url": "https://github.com/eclipse/jetty.project/commit/47bbccd55f25ed0618fe059e2d759c1d304688d4", "message": "Issue #4741 HttpServletMapping\n\nFixed several TODOs left in the code\nremoved _contextPath field and used an attributes lookup for include\nreplaced setContextPaths with setContext\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-05-26T12:09:11Z", "type": "commit"}, {"oid": "eae013f351a1fbb960b3fa81034b2123ced4202c", "url": "https://github.com/eclipse/jetty.project/commit/eae013f351a1fbb960b3fa81034b2123ced4202c", "message": "Issue #4741 HttpServletMapping\n\nUsed the same pattern from the contextPath changes for servletPath and pathInfo.   Now the servletPathMapping is always set on the request and only if the dispatch is an include do the effected methods look deeper for the source values.\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-05-26T16:49:34Z", "type": "commit"}, {"oid": "f469e7943035de8861848dd3ee86ebc571c86606", "url": "https://github.com/eclipse/jetty.project/commit/f469e7943035de8861848dd3ee86ebc571c86606", "message": "Issue #4741 HttpServletMapping\n\nImproved javadoc\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-05-27T09:51:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTYzODUwNQ==", "url": "https://github.com/eclipse/jetty.project/pull/4898#discussion_r431638505", "bodyText": "All these variable names should break CheckStyle, we don't use snake_case.", "author": "sbordet", "createdAt": "2020-05-28T07:35:51Z", "path": "jetty-server/src/main/java/org/eclipse/jetty/server/Dispatcher.java", "diffHunk": "@@ -90,6 +90,8 @@ public void include(ServletRequest request, ServletResponse response) throws Ser\n         final DispatcherType old_type = baseRequest.getDispatcherType();\n         final Attributes old_attr = baseRequest.getAttributes();\n         final MultiMap<String> old_query_params = baseRequest.getQueryParameters();\n+        final ContextHandler.Context old_context = baseRequest.getContext();\n+        final ServletPathMapping old_mapping = baseRequest.getServletPathMapping();", "originalCommit": "f469e7943035de8861848dd3ee86ebc571c86606", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTYzODY4MQ==", "url": "https://github.com/eclipse/jetty.project/pull/4898#discussion_r431638681", "bodyText": "Don't use snake_case in variable names.", "author": "sbordet", "createdAt": "2020-05-28T07:36:12Z", "path": "jetty-server/src/main/java/org/eclipse/jetty/server/Dispatcher.java", "diffHunk": "@@ -136,11 +145,10 @@ protected void forward(ServletRequest request, ServletResponse response, Dispatc\n             response = new ServletResponseHttpWrapper(response);\n \n         final HttpURI old_uri = baseRequest.getHttpURI();\n-        final String old_context_path = baseRequest.getContextPath();\n-        final String old_servlet_path = baseRequest.getServletPath();\n-        final String old_path_info = baseRequest.getPathInfo();\n+        final ContextHandler.Context old_context = baseRequest.getContext();\n+        final String old_path_in_context = baseRequest.getPathInContext();\n         final ServletPathMapping old_mapping = baseRequest.getServletPathMapping();\n-\n+        final ServletPathMapping source_mapping = baseRequest.findServletPathMapping();", "originalCommit": "f469e7943035de8861848dd3ee86ebc571c86606", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "0ae84cffca23711949e3ce4c6dbd025d8ee1c3a5", "url": "https://github.com/eclipse/jetty.project/commit/0ae84cffca23711949e3ce4c6dbd025d8ee1c3a5", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4741-NoServletPath", "committedDate": "2020-05-28T09:15:22Z", "type": "commit"}]}