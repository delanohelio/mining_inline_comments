{"pr_number": 4455, "pr_title": "Issue #4434 Implement context default request/response encodings.", "pr_createdAt": "2020-01-06T06:40:26Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/4455", "timeline": [{"oid": "6705e10addcead688cdcf26cc4453f42b8ee13e0", "url": "https://github.com/eclipse/jetty.project/commit/6705e10addcead688cdcf26cc4453f42b8ee13e0", "message": "Issue #4434 Implement context default request/response encodings.\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-01-06T06:35:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxMTUzMw==", "url": "https://github.com/eclipse/jetty.project/pull/4455#discussion_r363511533", "bodyText": "Should not the new constant be called CONTEXT?", "author": "sbordet", "createdAt": "2020-01-06T22:22:15Z", "path": "jetty-server/src/main/java/org/eclipse/jetty/server/Response.java", "diffHunk": "@@ -103,7 +104,7 @@\n \n     private enum EncodingFrom\n     {\n-        NOT_SET, INFERRED, SET_LOCALE, SET_CONTENT_TYPE, SET_CHARACTER_ENCODING\n+        NOT_SET, INFERRED, SET_LOCALE, SET_CONTENT_TYPE, SET_CHARACTER_ENCODING, DEFAULT", "originalCommit": "6705e10addcead688cdcf26cc4453f42b8ee13e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU3MzE5MA==", "url": "https://github.com/eclipse/jetty.project/pull/4455#discussion_r363573190", "bodyText": "I'm removing the constant, as we never set the encoding on the response explicitly if it is via the context default.", "author": "janbartel", "createdAt": "2020-01-07T02:54:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxMTUzMw=="}], "type": "inlineReview", "revised_code": {"commit": "5df02df21ebb1987e55691dd59b1d325d2029cd2", "chunk": "diff --git a/jetty-server/src/main/java/org/eclipse/jetty/server/Response.java b/jetty-server/src/main/java/org/eclipse/jetty/server/Response.java\nindex ab57c3543d..f15ae6834c 100644\n--- a/jetty-server/src/main/java/org/eclipse/jetty/server/Response.java\n+++ b/jetty-server/src/main/java/org/eclipse/jetty/server/Response.java\n\n@@ -104,7 +104,7 @@ public class Response implements HttpServletResponse\n \n     private enum EncodingFrom\n     {\n-        NOT_SET, INFERRED, SET_LOCALE, SET_CONTENT_TYPE, SET_CHARACTER_ENCODING, DEFAULT\n+        NOT_SET, INFERRED, SET_LOCALE, SET_CONTENT_TYPE, SET_CHARACTER_ENCODING\n     }\n \n     private static final EnumSet<EncodingFrom> __localeOverride = EnumSet.of(EncodingFrom.NOT_SET, EncodingFrom.INFERRED);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxMjQwMA==", "url": "https://github.com/eclipse/jetty.project/pull/4455#discussion_r363512400", "bodyText": "Remove unnecessary newline.", "author": "sbordet", "createdAt": "2020-01-06T22:24:48Z", "path": "jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java", "diffHunk": "@@ -0,0 +1,51 @@\n+//\n+//  ========================================================================\n+//  Copyright (c) 1995-2019 Mort Bay Consulting Pty. Ltd.\n+//  ------------------------------------------------------------------------\n+//  All rights reserved. This program and the accompanying materials\n+//  are made available under the terms of the Eclipse Public License v1.0\n+//  and Apache License v2.0 which accompanies this distribution.\n+//\n+//      The Eclipse Public License is available at\n+//      http://www.eclipse.org/legal/epl-v10.html\n+//\n+//      The Apache License v2.0 is available at\n+//      http://www.opensource.org/licenses/apache2.0.php\n+//\n+//  You may elect to redistribute this code under either of these licenses.\n+//  ========================================================================\n+//\n+\n+package org.eclipse.jetty.server;\n+", "originalCommit": "6705e10addcead688cdcf26cc4453f42b8ee13e0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5df02df21ebb1987e55691dd59b1d325d2029cd2", "chunk": "diff --git a/jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java b/jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java\nindex c3f0686240..985e3ed964 100644\n--- a/jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java\n+++ b/jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java\n\n@@ -18,13 +18,11 @@\n \n package org.eclipse.jetty.server;\n \n-\n import org.eclipse.jetty.server.handler.ContextHandler;\n \n /**\n  * ContextHandler for testing that implements some\n  * CharEncoding methods from the servlet spec.\n- *\n  */\n public class CharEncodingContextHandler extends ContextHandler\n {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxMjQ1OA==", "url": "https://github.com/eclipse/jetty.project/pull/4455#discussion_r363512458", "bodyText": "Remove empty javadoc line.", "author": "sbordet", "createdAt": "2020-01-06T22:25:00Z", "path": "jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java", "diffHunk": "@@ -0,0 +1,51 @@\n+//\n+//  ========================================================================\n+//  Copyright (c) 1995-2019 Mort Bay Consulting Pty. Ltd.\n+//  ------------------------------------------------------------------------\n+//  All rights reserved. This program and the accompanying materials\n+//  are made available under the terms of the Eclipse Public License v1.0\n+//  and Apache License v2.0 which accompanies this distribution.\n+//\n+//      The Eclipse Public License is available at\n+//      http://www.eclipse.org/legal/epl-v10.html\n+//\n+//      The Apache License v2.0 is available at\n+//      http://www.opensource.org/licenses/apache2.0.php\n+//\n+//  You may elect to redistribute this code under either of these licenses.\n+//  ========================================================================\n+//\n+\n+package org.eclipse.jetty.server;\n+\n+\n+import org.eclipse.jetty.server.handler.ContextHandler;\n+\n+/**\n+ * ContextHandler for testing that implements some\n+ * CharEncoding methods from the servlet spec.\n+ *", "originalCommit": "6705e10addcead688cdcf26cc4453f42b8ee13e0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5df02df21ebb1987e55691dd59b1d325d2029cd2", "chunk": "diff --git a/jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java b/jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java\nindex c3f0686240..985e3ed964 100644\n--- a/jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java\n+++ b/jetty-server/src/test/java/org/eclipse/jetty/server/CharEncodingContextHandler.java\n\n@@ -18,13 +18,11 @@\n \n package org.eclipse.jetty.server;\n \n-\n import org.eclipse.jetty.server.handler.ContextHandler;\n \n /**\n  * ContextHandler for testing that implements some\n  * CharEncoding methods from the servlet spec.\n- *\n  */\n public class CharEncodingContextHandler extends ContextHandler\n {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxMzg1Ng==", "url": "https://github.com/eclipse/jetty.project/pull/4455#discussion_r363513856", "bodyText": "Is there a reason these fields and methods have \"default\" in their name?\nI would just called them without \"default\" as they are in ServletContext.", "author": "sbordet", "createdAt": "2020-01-06T22:29:05Z", "path": "jetty-server/src/main/java/org/eclipse/jetty/server/handler/ContextHandler.java", "diffHunk": "@@ -177,6 +177,8 @@ public static void setServerInfo(String serverInfo)\n     private final Map<String, String> _initParams;\n     private ClassLoader _classLoader;\n     private boolean _contextPathDefault = true;\n+    private String _defaultRequestCharacterEncoding;\n+    private String _defaultResponseCharacterEncoding;", "originalCommit": "6705e10addcead688cdcf26cc4453f42b8ee13e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU3MzQ0MA==", "url": "https://github.com/eclipse/jetty.project/pull/4455#discussion_r363573440", "bodyText": "I'm disinclined to change the name. The \"default\" arises from the fact that it is the default for the context. Without \"default\" in the name, where the getters are accessed, it gets very confusing with so many different sources of character encoding flying around, so I like that it is obvious that it is the default only.", "author": "janbartel", "createdAt": "2020-01-07T02:56:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxMzg1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzY0NDA4MQ==", "url": "https://github.com/eclipse/jetty.project/pull/4455#discussion_r363644081", "bodyText": "It is not the default for the context, it is the default for the requests or the responses. This is the only place \"default\" is used.\nIt is not used in ServletContext, it is not used in web.xml, it is not used in StandardDescriptorProcessor, and not even used in test method names, so I don't see any reason to change a name used in so many other places and add \"default\" (which really adds no additional clarity) in just this place.", "author": "sbordet", "createdAt": "2020-01-07T08:49:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzUxMzg1Ng=="}], "type": "inlineReview", "revised_code": null}, {"oid": "5df02df21ebb1987e55691dd59b1d325d2029cd2", "url": "https://github.com/eclipse/jetty.project/commit/5df02df21ebb1987e55691dd59b1d325d2029cd2", "message": "Issue #4434 Updates post review\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-01-07T03:01:06Z", "type": "commit"}, {"oid": "b62986f01ba6843248fae809e35f4290d559647f", "url": "https://github.com/eclipse/jetty.project/commit/b62986f01ba6843248fae809e35f4290d559647f", "message": "Issue #4434 remove TODOs\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-01-07T04:48:16Z", "type": "commit"}, {"oid": "c3c6301a88ec69128fda78763288ba26b08967fb", "url": "https://github.com/eclipse/jetty.project/commit/c3c6301a88ec69128fda78763288ba26b08967fb", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10-0.x-4434-default-request-response-encodings\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-01-08T00:19:26Z", "type": "commit"}, {"oid": "bbcfcec03933af0cd08bdb66687a4f036a45f590", "url": "https://github.com/eclipse/jetty.project/commit/bbcfcec03933af0cd08bdb66687a4f036a45f590", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10-0.x-4434-default-request-response-encodings", "committedDate": "2020-01-13T20:41:44Z", "type": "commit"}, {"oid": "4362dc58379cf5fe8d2ac9afa9d8b0cb38bc622e", "url": "https://github.com/eclipse/jetty.project/commit/4362dc58379cf5fe8d2ac9afa9d8b0cb38bc622e", "message": "Updating license text\n\nSigned-off-by: Joakim Erdfelt <joakim.erdfelt@gmail.com>", "committedDate": "2020-01-13T20:43:05Z", "type": "commit"}, {"oid": "188f2a57f1ad3ec78474f15a0e8aa22c61bb8d19", "url": "https://github.com/eclipse/jetty.project/commit/188f2a57f1ad3ec78474f15a0e8aa22c61bb8d19", "message": "Fixing checkstyle violation\n\nSigned-off-by: Joakim Erdfelt <joakim.erdfelt@gmail.com>", "committedDate": "2020-01-13T21:40:21Z", "type": "commit"}]}