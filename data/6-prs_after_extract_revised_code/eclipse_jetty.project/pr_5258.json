{"pr_number": 5258, "pr_title": "Issue #5256 Adding start.jar --add-module", "pr_createdAt": "2020-09-12T11:28:50Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/5258", "timeline": [{"oid": "6077658fd13dbfd18529c108a60f54b61f2d6e77", "url": "https://github.com/eclipse/jetty.project/commit/6077658fd13dbfd18529c108a60f54b61f2d6e77", "message": "Issue #5256 --add-modules\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-09-12T11:27:01Z", "type": "commit"}, {"oid": "a73bd7f6b41354b9dbce807ac5c1a13c22182a2b", "url": "https://github.com/eclipse/jetty.project/commit/a73bd7f6b41354b9dbce807ac5c1a13c22182a2b", "message": "main.ini\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-09-12T11:27:38Z", "type": "commit"}, {"oid": "877fd4ac7771bf295b840b9500bd2302851d078d", "url": "https://github.com/eclipse/jetty.project/commit/877fd4ac7771bf295b840b9500bd2302851d078d", "message": "Issue #5256 --add-modules\n\nusage.txt\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-09-12T12:10:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY5Mjk5Mg==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487692992", "bodyText": "I kind of liked the previous format, although it was not consistent (e.g. was using INFO for module activity).\nIf you go this direction, then there are 3 occurrences of StartLog.log(\"COPY\", ...) and 1 of StartLog.log(\"DOWNLD\", ...) to replace.", "author": "sbordet", "createdAt": "2020-09-14T07:05:12Z", "path": "jetty-start/src/main/java/org/eclipse/jetty/start/FileInitializer.java", "diffHunk": "@@ -128,7 +128,7 @@ protected Path getDestination(URI uri, String location) throws IOException\n     protected void download(URI uri, Path destination) throws IOException\n     {\n         if (FS.ensureDirectoryExists(destination.getParent()))\n-            StartLog.log(\"MKDIR\", _basehome.toShortForm(destination.getParent()));\n+            StartLog.log(\"INFO\", \"mkdir \" + _basehome.toShortForm(destination.getParent()));", "originalCommit": "877fd4ac7771bf295b840b9500bd2302851d078d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzgwMjQ0Mw==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487802443", "bodyText": "I'm torn.... but on balance I think that INFO/WARN are least surprise.", "author": "gregw", "createdAt": "2020-09-14T10:14:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY5Mjk5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "46f051d7e264f907c98d5ec4dd44102b436ee165", "chunk": "diff --git a/jetty-start/src/main/java/org/eclipse/jetty/start/FileInitializer.java b/jetty-start/src/main/java/org/eclipse/jetty/start/FileInitializer.java\nindex 037bf054fc..4f6cfa4eda 100644\n--- a/jetty-start/src/main/java/org/eclipse/jetty/start/FileInitializer.java\n+++ b/jetty-start/src/main/java/org/eclipse/jetty/start/FileInitializer.java\n\n@@ -128,9 +128,9 @@ public abstract class FileInitializer\n     protected void download(URI uri, Path destination) throws IOException\n     {\n         if (FS.ensureDirectoryExists(destination.getParent()))\n-            StartLog.log(\"INFO\", \"mkdir \" + _basehome.toShortForm(destination.getParent()));\n+            StartLog.info(\"mkdir \" + _basehome.toShortForm(destination.getParent()));\n \n-        StartLog.log(\"DOWNLD\", \"%s to %s\", uri, _basehome.toShortForm(destination));\n+        StartLog.info(\"download %s to %s\", uri, _basehome.toShortForm(destination));\n \n         HttpURLConnection http = (HttpURLConnection)uri.toURL().openConnection();\n         http.setInstanceFollowRedirects(true);\n"}}, {"oid": "46f051d7e264f907c98d5ec4dd44102b436ee165", "url": "https://github.com/eclipse/jetty.project/commit/46f051d7e264f907c98d5ec4dd44102b436ee165", "message": "Issue #5256 --add-modules\n\nupdates from review\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-09-14T10:33:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkxMjQ4NA==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487912484", "bodyText": "This should be mkdir for consistency with other logs, not create.", "author": "sbordet", "createdAt": "2020-09-14T13:29:02Z", "path": "jetty-start/src/main/java/org/eclipse/jetty/start/BaseBuilder.java", "diffHunk": "@@ -169,35 +172,70 @@ else if (!licensing.acknowledgeLicenses())\n         Path startd = getBaseHome().getBasePath(\"start.d\");\n         Path startini = getBaseHome().getBasePath(\"start.ini\");\n \n-        if (startArgs.isCreateStartd() && !Files.exists(startd))\n+        if (startArgs.isCreateStartIni())\n         {\n-            if (FS.ensureDirectoryExists(startd))\n+            if (!Files.exists(startini))\n             {\n-                StartLog.log(\"MKDIR\", baseHome.toShortForm(startd));\n+                StartLog.info(\"create \" + baseHome.toShortForm(startini));", "originalCommit": "46f051d7e264f907c98d5ec4dd44102b436ee165", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkyNDIzMA==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487924230", "bodyText": "but it is not a directory!  \"touch\" ?", "author": "gregw", "createdAt": "2020-09-14T13:40:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkxMjQ4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkyNjQ2OA==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487926468", "bodyText": "Changed from startd to startini ?", "author": "joakime", "createdAt": "2020-09-14T13:42:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkxMjQ4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkzMTk5NA==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487931994", "bodyText": "@joakime exectly because the option is now --create-start-ini and --create-startd is a noop", "author": "gregw", "createdAt": "2020-09-14T13:48:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkxMjQ4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkzMjcwMw==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487932703", "bodyText": "Note that --create-start-ini  takes all the files in start.d and concats them into a start.ini and then removes start.d", "author": "gregw", "createdAt": "2020-09-14T13:48:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkxMjQ4NA=="}], "type": "inlineReview", "revised_code": {"commit": "f4567a4dd6f036fe31a10506bf7c5d0ef7a6e0fa", "chunk": "diff --git a/jetty-start/src/main/java/org/eclipse/jetty/start/BaseBuilder.java b/jetty-start/src/main/java/org/eclipse/jetty/start/BaseBuilder.java\nindex df5e4154d1..b9f9f694cf 100644\n--- a/jetty-start/src/main/java/org/eclipse/jetty/start/BaseBuilder.java\n+++ b/jetty-start/src/main/java/org/eclipse/jetty/start/BaseBuilder.java\n\n@@ -202,7 +202,7 @@ public class BaseBuilder\n                 List<String> startLines = new ArrayList<>();\n                 for (Path path : paths)\n                 {\n-                    StartLog.info(\"cp \" + baseHome.toShortForm(path) + \" to \" + baseHome.toShortForm(startini));\n+                    StartLog.info(\"copy \" + baseHome.toShortForm(path) + \" to \" + baseHome.toShortForm(startini));\n                     startLines.add(\"\");\n                     startLines.add(\"# Config from \" + baseHome.toShortForm(path));\n                     startLines.addAll(Files.readAllLines(path));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkxNDA4MA==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487914080", "bodyText": "You used cp in BaseBuilder:205 so I would be consistent - I like better \"copy\" than \"cp\".", "author": "sbordet", "createdAt": "2020-09-14T13:30:56Z", "path": "jetty-start/src/main/java/org/eclipse/jetty/start/FileInitializer.java", "diffHunk": "@@ -215,7 +215,7 @@ public boolean copyDirectory(Path source, Path destination) throws IOException\n                 }\n                 else if (!Files.exists(to))\n                 {\n-                    StartLog.log(\"COPY \", \"%s to %s\", _basehome.toShortForm(from), _basehome.toShortForm(to));\n+                    StartLog.info(\"copy %s to %s\", _basehome.toShortForm(from), _basehome.toShortForm(to));", "originalCommit": "46f051d7e264f907c98d5ec4dd44102b436ee165", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkxNTYxMw==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487915613", "bodyText": "\"Programmatic ACK\" -> \"Automatic License Acknowledgment\" - these are sysops or beginners, they don't know what \"ACK\" is.", "author": "sbordet", "createdAt": "2020-09-14T13:32:19Z", "path": "jetty-start/src/main/java/org/eclipse/jetty/start/Licensing.java", "diffHunk": "@@ -85,7 +85,7 @@ public boolean acknowledgeLicenses() throws IOException\n         String propBasedAckValue = System.getProperty(PROP_ACK_LICENSES);\n         if (propBasedAckValue != null)\n         {\n-            StartLog.log(\"TESTING MODE\", \"Programmatic ACK - %s=%s\", PROP_ACK_LICENSES, propBasedAckValue);\n+            StartLog.info(\"Programmatic ACK - %s=%s\", PROP_ACK_LICENSES, propBasedAckValue);", "originalCommit": "46f051d7e264f907c98d5ec4dd44102b436ee165", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f4567a4dd6f036fe31a10506bf7c5d0ef7a6e0fa", "chunk": "diff --git a/jetty-start/src/main/java/org/eclipse/jetty/start/Licensing.java b/jetty-start/src/main/java/org/eclipse/jetty/start/Licensing.java\nindex d0e8915e75..71bb4c5cc6 100644\n--- a/jetty-start/src/main/java/org/eclipse/jetty/start/Licensing.java\n+++ b/jetty-start/src/main/java/org/eclipse/jetty/start/Licensing.java\n\n@@ -85,7 +85,7 @@ public class Licensing\n         String propBasedAckValue = System.getProperty(PROP_ACK_LICENSES);\n         if (propBasedAckValue != null)\n         {\n-            StartLog.info(\"Programmatic ACK - %s=%s\", PROP_ACK_LICENSES, propBasedAckValue);\n+            StartLog.info(\"Automatic License Acknowledgment - %s=%s\", PROP_ACK_LICENSES, propBasedAckValue);\n             licenseAck = Boolean.parseBoolean(propBasedAckValue);\n         }\n         else\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkxNzIxMQ==", "url": "https://github.com/eclipse/jetty.project/pull/5258#discussion_r487917211", "bodyText": "Typo: modues -> modules.", "author": "sbordet", "createdAt": "2020-09-14T13:33:51Z", "path": "jetty-start/src/main/java/org/eclipse/jetty/start/builders/StartDirBuilder.java", "diffHunk": "@@ -35,7 +35,7 @@\n /**\n  * Management of the <code>${jetty.base}/start.d/</code> based configuration.\n  * <p>\n- * Implementation of the <code>--add-to-startd=[name]</code> command line behavior\n+ * Implementation of the <code>--add-modues=[name]</code> command line behavior", "originalCommit": "46f051d7e264f907c98d5ec4dd44102b436ee165", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f4567a4dd6f036fe31a10506bf7c5d0ef7a6e0fa", "chunk": "diff --git a/jetty-start/src/main/java/org/eclipse/jetty/start/builders/StartDirBuilder.java b/jetty-start/src/main/java/org/eclipse/jetty/start/builders/StartDirBuilder.java\nindex 0eb24ff678..8d51181f51 100644\n--- a/jetty-start/src/main/java/org/eclipse/jetty/start/builders/StartDirBuilder.java\n+++ b/jetty-start/src/main/java/org/eclipse/jetty/start/builders/StartDirBuilder.java\n\n@@ -35,7 +35,7 @@ import org.eclipse.jetty.start.StartLog;\n /**\n  * Management of the <code>${jetty.base}/start.d/</code> based configuration.\n  * <p>\n- * Implementation of the <code>--add-modues=[name]</code> command line behavior\n+ * Implementation of the <code>--add-modules=[name]</code> command line behavior\n  */\n public class StartDirBuilder implements BaseBuilder.Config\n {\n"}}, {"oid": "f4567a4dd6f036fe31a10506bf7c5d0ef7a6e0fa", "url": "https://github.com/eclipse/jetty.project/commit/f4567a4dd6f036fe31a10506bf7c5d0ef7a6e0fa", "message": "Issue #5256 --add-modules\n\nupdates from review\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-09-14T13:45:28Z", "type": "commit"}, {"oid": "94999dead66ba1dd56a95b49dc9d1a4e46d9dc24", "url": "https://github.com/eclipse/jetty.project/commit/94999dead66ba1dd56a95b49dc9d1a4e46d9dc24", "message": "fixed test\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>", "committedDate": "2020-09-14T15:32:40Z", "type": "commit"}]}