{"pr_number": 5847, "pr_title": "Fixes #5845 - Use UTF-8 encoding for client basic auth if requested.", "pr_createdAt": "2020-12-29T16:59:23Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/5847", "timeline": [{"oid": "f4caf07b172fa198be95d0353c5fd96735978683", "url": "https://github.com/eclipse/jetty.project/commit/f4caf07b172fa198be95d0353c5fd96735978683", "message": "Fixes #5845 - Use UTF-8 encoding for client basic auth if requested.\n\n* Introduced get/setCharset in BasicAuthenticator on server-side.\n* Looking for the \"charset\" parameter on the client-side, and if there, use it.\n* Added test case.\n* Code cleanups.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>", "committedDate": "2020-12-29T16:58:43Z", "type": "commit"}, {"oid": "655c2e3eb11390a4f8702406fa739d14be8253b9", "url": "https://github.com/eclipse/jetty.project/commit/655c2e3eb11390a4f8702406fa739d14be8253b9", "message": "Fixes #5845 - Use UTF-8 encoding for client basic auth if requested.\n\nDon't use unicode sequences to please CheckStyle.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>", "committedDate": "2020-12-30T11:05:29Z", "type": "commit"}, {"oid": "6535f2d6e77b5db2432895fdbc2edd915e85be71", "url": "https://github.com/eclipse/jetty.project/commit/6535f2d6e77b5db2432895fdbc2edd915e85be71", "message": "Fixes #5845 - Use UTF-8 encoding for client basic auth if requested.\n\nDisable CheckStyle check so that the unicode sequence in the test matches that in realm.properties.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>", "committedDate": "2020-12-30T11:08:13Z", "type": "commit"}, {"oid": "b050bdbc9e47350b2807504eb5c7e1601ab3b967", "url": "https://github.com/eclipse/jetty.project/commit/b050bdbc9e47350b2807504eb5c7e1601ab3b967", "message": "Merged branch 'jetty-9.4.x' into 'jetty-9.4.x-5845-basic_auth_charset'.", "committedDate": "2020-12-30T15:09:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDkwMzQ0Mg==", "url": "https://github.com/eclipse/jetty.project/pull/5847#discussion_r554903442", "bodyText": "Maybe pre compute this string rather than recreate on every request?", "author": "gregw", "createdAt": "2021-01-11T09:07:33Z", "path": "jetty-security/src/main/java/org/eclipse/jetty/security/authentication/BasicAuthenticator.java", "diffHunk": "@@ -97,7 +97,11 @@ public Authentication validateRequest(ServletRequest req, ServletResponse res, b\n             if (DeferredAuthentication.isDeferred(response))\n                 return Authentication.UNAUTHENTICATED;\n \n-            response.setHeader(HttpHeader.WWW_AUTHENTICATE.asString(), \"basic realm=\\\"\" + _loginService.getName() + '\"');\n+            String value = \"basic realm=\\\"\" + _loginService.getName() + \"\\\"\";\n+            Charset charset = getCharset();\n+            if (charset != null)\n+                value += \", charset=\\\"\" + charset.name() + \"\\\"\";\n+            response.setHeader(HttpHeader.WWW_AUTHENTICATE.asString(), value);", "originalCommit": "b050bdbc9e47350b2807504eb5c7e1601ab3b967", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}