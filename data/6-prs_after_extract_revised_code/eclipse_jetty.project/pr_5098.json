{"pr_number": 5098, "pr_title": "Issue #5093 Static UrlEncoded", "pr_createdAt": "2020-07-29T09:43:24Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/5098", "timeline": [{"oid": "0aa4b681cfb6dcf121383b4a3176076de99cc51e", "url": "https://github.com/eclipse/jetty.project/commit/0aa4b681cfb6dcf121383b4a3176076de99cc51e", "message": "Issue #5093 Static UrlEncoded\n\nUpdated UrlEncoded to static only class with no synchronization", "committedDate": "2020-07-29T09:41:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjIxNTI3MA==", "url": "https://github.com/eclipse/jetty.project/pull/5098#discussion_r462215270", "bodyText": "Shouldn't this now be?\nMultiMap<String> query = new MultiMap<>();\nHow did this compile with new UrlEncoded() now being private?", "author": "joakime", "createdAt": "2020-07-29T11:00:28Z", "path": "jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java", "diffHunk": "@@ -835,13 +836,13 @@ protected void doGet(HttpServletRequest request, HttpServletResponse response) t\n             assertEquals(null, request.getPathTranslated());\n \n             UrlEncoded query = new UrlEncoded();", "originalCommit": "0aa4b681cfb6dcf121383b4a3176076de99cc51e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "6071018b03d40a8c14b71380b6639ec0ae2eb094", "chunk": "diff --git a/jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java b/jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java\nindex 9023b1d98c..816cde4232 100644\n--- a/jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java\n+++ b/jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java\n\n@@ -835,14 +835,14 @@ public class DispatcherTest\n             assertEquals(null, request.getPathInfo());\n             assertEquals(null, request.getPathTranslated());\n \n-            UrlEncoded query = new UrlEncoded();\n-            UrlEncoded.decodeTo(request.getQueryString(), new MultiMap<>(), UrlEncoded.ENCODING);\n+            MultiMap<String> query = new MultiMap<>();\n+            UrlEncoded.decodeTo(request.getQueryString(), query, UrlEncoded.ENCODING);\n             assertThat(query.getString(\"do\"), is(\"end\"));\n \n             // Russian for \"selected=Temperature\"\n-            UrlEncoded q2 = new UrlEncoded();\n-            UrlEncoded.decodeTo(query.getString(\"else\"), new MultiMap<>(), UrlEncoded.ENCODING);\n-            String russian = UrlEncoded.encode(new MultiMap<>(), UrlEncoded.ENCODING, false);\n+            MultiMap<String> q2 = new MultiMap<>();\n+            UrlEncoded.decodeTo(query.getString(\"else\"), q2, UrlEncoded.ENCODING);\n+            String russian = UrlEncoded.encode(q2, UrlEncoded.ENCODING, false);\n             assertThat(russian, is(\"%D0%B2%D1%8B%D0%B1%D1%80%D0%B0%D0%BD%D0%BE=%D0%A2%D0%B5%D0%BC%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D1%83%D1%80%D0%B0\"));\n             assertThat(query.containsKey(\"test\"), is(false));\n             assertThat(query.containsKey(\"foreign\"), is(false));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjIxNTQ4OQ==", "url": "https://github.com/eclipse/jetty.project/pull/5098#discussion_r462215489", "bodyText": "Ditto..\nMultiMap<String> q2 = new MultiMap<>();", "author": "joakime", "createdAt": "2020-07-29T11:00:54Z", "path": "jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java", "diffHunk": "@@ -835,13 +836,13 @@ protected void doGet(HttpServletRequest request, HttpServletResponse response) t\n             assertEquals(null, request.getPathTranslated());\n \n             UrlEncoded query = new UrlEncoded();\n-            query.decode(request.getQueryString());\n+            UrlEncoded.decodeTo(request.getQueryString(), new MultiMap<>(), UrlEncoded.ENCODING);\n             assertThat(query.getString(\"do\"), is(\"end\"));\n \n             // Russian for \"selected=Temperature\"\n             UrlEncoded q2 = new UrlEncoded();", "originalCommit": "0aa4b681cfb6dcf121383b4a3176076de99cc51e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjIzNDUzNg==", "url": "https://github.com/eclipse/jetty.project/pull/5098#discussion_r462234536", "bodyText": "yep! oops!", "author": "gregw", "createdAt": "2020-07-29T11:40:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjIxNTQ4OQ=="}], "type": "inlineReview", "revised_code": {"commit": "6071018b03d40a8c14b71380b6639ec0ae2eb094", "chunk": "diff --git a/jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java b/jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java\nindex 9023b1d98c..816cde4232 100644\n--- a/jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java\n+++ b/jetty-servlet/src/test/java/org/eclipse/jetty/servlet/DispatcherTest.java\n\n@@ -835,14 +835,14 @@ public class DispatcherTest\n             assertEquals(null, request.getPathInfo());\n             assertEquals(null, request.getPathTranslated());\n \n-            UrlEncoded query = new UrlEncoded();\n-            UrlEncoded.decodeTo(request.getQueryString(), new MultiMap<>(), UrlEncoded.ENCODING);\n+            MultiMap<String> query = new MultiMap<>();\n+            UrlEncoded.decodeTo(request.getQueryString(), query, UrlEncoded.ENCODING);\n             assertThat(query.getString(\"do\"), is(\"end\"));\n \n             // Russian for \"selected=Temperature\"\n-            UrlEncoded q2 = new UrlEncoded();\n-            UrlEncoded.decodeTo(query.getString(\"else\"), new MultiMap<>(), UrlEncoded.ENCODING);\n-            String russian = UrlEncoded.encode(new MultiMap<>(), UrlEncoded.ENCODING, false);\n+            MultiMap<String> q2 = new MultiMap<>();\n+            UrlEncoded.decodeTo(query.getString(\"else\"), q2, UrlEncoded.ENCODING);\n+            String russian = UrlEncoded.encode(q2, UrlEncoded.ENCODING, false);\n             assertThat(russian, is(\"%D0%B2%D1%8B%D0%B1%D1%80%D0%B0%D0%BD%D0%BE=%D0%A2%D0%B5%D0%BC%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D1%83%D1%80%D0%B0\"));\n             assertThat(query.containsKey(\"test\"), is(false));\n             assertThat(query.containsKey(\"foreign\"), is(false));\n"}}, {"oid": "6071018b03d40a8c14b71380b6639ec0ae2eb094", "url": "https://github.com/eclipse/jetty.project/commit/6071018b03d40a8c14b71380b6639ec0ae2eb094", "message": "Fixed additional tests", "committedDate": "2020-07-29T11:47:54Z", "type": "commit"}, {"oid": "5a044fbdcdde2486439cdc6453b23f8338bcec69", "url": "https://github.com/eclipse/jetty.project/commit/5a044fbdcdde2486439cdc6453b23f8338bcec69", "message": "fixed formatting\n\nSigned-off-by: gregw <gregw@webtide.com>", "committedDate": "2020-07-29T21:19:43Z", "type": "commit"}]}