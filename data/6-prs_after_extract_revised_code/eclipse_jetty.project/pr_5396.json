{"pr_number": 5396, "pr_title": "Issue #5394 Fix injection for quickstart", "pr_createdAt": "2020-10-05T11:41:59Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/5396", "timeline": [{"oid": "fa2c3b2e93a8ce973e6bde06c0b53e48869d49e0", "url": "https://github.com/eclipse/jetty.project/commit/fa2c3b2e93a8ce973e6bde06c0b53e48869d49e0", "message": "Issue #5394 Fix injection for quickstart\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-10-05T10:59:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk0ODEwNg==", "url": "https://github.com/eclipse/jetty.project/pull/5396#discussion_r499948106", "bodyText": "take care when merging to 11 ;)", "author": "olamy", "createdAt": "2020-10-06T00:51:03Z", "path": "jetty-quickstart/src/main/java/org/eclipse/jetty/quickstart/PreconfigureQuickStartWar.java", "diffHunk": "@@ -109,7 +110,7 @@ public static void preconfigure(Resource war, Resource dir, Resource xml) throws\n                                 new AnnotationConfiguration());\n         webapp.setAttribute(QuickStartConfiguration.MODE, QuickStartConfiguration.Mode.GENERATE);\n         webapp.setAttribute(QuickStartConfiguration.ORIGIN_ATTRIBUTE, \"\");\n-\n+        webapp.setAttribute(MetaInfConfiguration.CONTAINER_JAR_PATTERN, \".*/jetty-servlet-api-[^/]*\\\\.jar$|.*/javax.servlet.jsp.jstl-.*\\\\.jar$|.*/org.apache.taglibs.taglibs-standard-impl-.*\\\\.jar$\");", "originalCommit": "fa2c3b2e93a8ce973e6bde06c0b53e48869d49e0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2MTA4MQ==", "url": "https://github.com/eclipse/jetty.project/pull/5396#discussion_r500061081", "bodyText": "Surely this should not be hard coded to false, but take the value from the main web.xml\nOf course there will be issues if some fragments are complete and others are not!!!", "author": "gregw", "createdAt": "2020-10-06T07:28:46Z", "path": "jetty-quickstart/src/main/java/org/eclipse/jetty/quickstart/QuickStartGeneratorConfiguration.java", "diffHunk": "@@ -157,7 +157,7 @@ public void generateQuickStartWebXml(WebAppContext context, OutputStream stream)\n         webappAttr.put(\"xmlns\", \"http://xmlns.jcp.org/xml/ns/javaee\");\n         webappAttr.put(\"xmlns:xsi\", \"http://www.w3.org/2001/XMLSchema-instance\");\n         webappAttr.put(\"xsi:schemaLocation\", \"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_\" + (major + \"_\" + minor) + \".xsd\");\n-        webappAttr.put(\"metadata-complete\", \"true\");\n+        webappAttr.put(\"metadata-complete\", \"false\");", "originalCommit": "fa2c3b2e93a8ce973e6bde06c0b53e48869d49e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA3OTUxNA==", "url": "https://github.com/eclipse/jetty.project/pull/5396#discussion_r500079514", "bodyText": "Ah, good point. I'll fix.", "author": "janbartel", "createdAt": "2020-10-06T08:00:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA2MTA4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "3f6e0ee51bca25909ea0e7cb62d7d384476a910c", "chunk": "diff --git a/jetty-quickstart/src/main/java/org/eclipse/jetty/quickstart/QuickStartGeneratorConfiguration.java b/jetty-quickstart/src/main/java/org/eclipse/jetty/quickstart/QuickStartGeneratorConfiguration.java\nindex 1cf6bfab94..b1530eaa1b 100644\n--- a/jetty-quickstart/src/main/java/org/eclipse/jetty/quickstart/QuickStartGeneratorConfiguration.java\n+++ b/jetty-quickstart/src/main/java/org/eclipse/jetty/quickstart/QuickStartGeneratorConfiguration.java\n\n@@ -157,7 +157,7 @@ public class QuickStartGeneratorConfiguration extends AbstractConfiguration\n         webappAttr.put(\"xmlns\", \"http://xmlns.jcp.org/xml/ns/javaee\");\n         webappAttr.put(\"xmlns:xsi\", \"http://www.w3.org/2001/XMLSchema-instance\");\n         webappAttr.put(\"xsi:schemaLocation\", \"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_\" + (major + \"_\" + minor) + \".xsd\");\n-        webappAttr.put(\"metadata-complete\", \"false\");\n+        webappAttr.put(\"metadata-complete\", Boolean.toString(context.getMetaData().isMetaDataComplete()));\n         webappAttr.put(\"version\", major + \".\" + minor);\n \n         XmlAppendable out = new XmlAppendable(stream, \"UTF-8\");\n"}}, {"oid": "3f6e0ee51bca25909ea0e7cb62d7d384476a910c", "url": "https://github.com/eclipse/jetty.project/commit/3f6e0ee51bca25909ea0e7cb62d7d384476a910c", "message": "Issue #5394 Set quickstart metadatacomplete based on web.xml value\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-10-06T08:58:23Z", "type": "commit"}]}