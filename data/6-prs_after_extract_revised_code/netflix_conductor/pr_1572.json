{"pr_number": 1572, "pr_title": "Event execution deduplication interval", "pr_createdAt": "2020-03-10T20:23:43Z", "pr_url": "https://github.com/Netflix/conductor/pull/1572", "timeline": [{"oid": "49ceef1095a5ef0e6954942effec0d9f3fc53b35", "url": "https://github.com/Netflix/conductor/commit/49ceef1095a5ef0e6954942effec0d9f3fc53b35", "message": "Added event execution keys ttl to support a event de-duplication window", "committedDate": "2020-03-05T21:21:35Z", "type": "commit"}, {"oid": "650c8aebcb28d7a559d4d6af8c40b296af54032b", "url": "https://github.com/Netflix/conductor/commit/650c8aebcb28d7a559d4d6af8c40b296af54032b", "message": "Fix unit tests", "committedDate": "2020-03-05T22:09:24Z", "type": "commit"}, {"oid": "2b336127e88d67678e6445890fcc6e68c3cfba0b", "url": "https://github.com/Netflix/conductor/commit/2b336127e88d67678e6445890fcc6e68c3cfba0b", "message": "Minor formatting", "committedDate": "2020-03-10T20:08:01Z", "type": "commit"}, {"oid": "da3db3cc1132f6997cd3e3acc174aa5104ae46f8", "url": "https://github.com/Netflix/conductor/commit/da3db3cc1132f6997cd3e3acc174aa5104ae46f8", "message": "Merge remote-tracking branch 'upstream/dev' into event-execution-deduplication-interval\n\n# Conflicts:\n#\tcassandra-persistence/src/main/java/com/netflix/conductor/dao/cassandra/CassandraExecutionDAO.java", "committedDate": "2020-03-16T04:19:44Z", "type": "commit"}, {"oid": "0dd2ea1b77a54845fca65499ef2f50e534279d7c", "url": "https://github.com/Netflix/conductor/commit/0dd2ea1b77a54845fca65499ef2f50e534279d7c", "message": "Minor refactoring", "committedDate": "2020-03-16T06:02:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjgyODcxOQ==", "url": "https://github.com/Netflix/conductor/pull/1572#discussion_r396828719", "bodyText": "Please update method name to indexEventExecution to avoid confusion.", "author": "apanicker-nflx", "createdAt": "2020-03-23T23:56:52Z", "path": "core/src/main/java/com/netflix/conductor/core/orchestration/ExecutionDAOFacade.java", "diffHunk": "@@ -387,18 +387,21 @@ public void updateTaskLastPoll(String taskName, String domain, String workerId)\n      */\n     public boolean addEventExecution(EventExecution eventExecution) {\n         boolean added = executionDAO.addEventExecution(eventExecution);\n+\n         if (added) {\n-            if (config.enableAsyncIndexing()) {\n-                indexDAO.asyncAddEventExecution(eventExecution);\n-            } else {\n-                indexDAO.addEventExecution(eventExecution);\n-            }\n+            addEventExecutionIndex(eventExecution);\n         }\n+\n         return added;\n     }\n \n     public void updateEventExecution(EventExecution eventExecution) {\n         executionDAO.updateEventExecution(eventExecution);\n+        addEventExecutionIndex(eventExecution);", "originalCommit": "0dd2ea1b77a54845fca65499ef2f50e534279d7c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1dabe0098ada3cd6babd589fd2715e9aaeec0d51", "chunk": "diff --git a/core/src/main/java/com/netflix/conductor/core/orchestration/ExecutionDAOFacade.java b/core/src/main/java/com/netflix/conductor/core/orchestration/ExecutionDAOFacade.java\nindex 165bfad2..f9733cac 100644\n--- a/core/src/main/java/com/netflix/conductor/core/orchestration/ExecutionDAOFacade.java\n+++ b/core/src/main/java/com/netflix/conductor/core/orchestration/ExecutionDAOFacade.java\n\n@@ -389,7 +389,7 @@ public class ExecutionDAOFacade {\n         boolean added = executionDAO.addEventExecution(eventExecution);\n \n         if (added) {\n-            addEventExecutionIndex(eventExecution);\n+            indexEventExecution(eventExecution);\n         }\n \n         return added;\n"}}, {"oid": "1dabe0098ada3cd6babd589fd2715e9aaeec0d51", "url": "https://github.com/Netflix/conductor/commit/1dabe0098ada3cd6babd589fd2715e9aaeec0d51", "message": "Incorporate review comments", "committedDate": "2020-03-24T00:51:56Z", "type": "commit"}, {"oid": "65f323ea33f41266a9481b56c4cdbab76a25c24b", "url": "https://github.com/Netflix/conductor/commit/65f323ea33f41266a9481b56c4cdbab76a25c24b", "message": "Merge branch 'dev' into event-execution-deduplication-interval", "committedDate": "2020-03-24T00:54:42Z", "type": "commit"}]}