{"pr_number": 1336, "pr_title": "Fixes - Honor Doc Version in SwaggerController and Use ISO8601Dates Serde Format in Date Formatting ", "pr_createdAt": "2020-05-21T16:34:26Z", "pr_url": "https://github.com/yahoo/elide/pull/1336", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg4MzgzNg==", "url": "https://github.com/yahoo/elide/pull/1336#discussion_r428883836", "bodyText": "This breaks correctness.", "author": "aklish", "createdAt": "2020-05-21T20:04:19Z", "path": "elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQueryResult.java", "diffHunk": "@@ -29,6 +30,7 @@\n @CreatePermission(expression = \"Prefab.Role.None\")\n @DeletePermission(expression = \"Prefab.Role.None\")\n @Data\n+@EqualsAndHashCode(callSuper = false)", "originalCommit": "c7843ecab0922abbff3f745c31384ccd93e41fdb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e626af2bf15f06f93c5a28cf6921e7919979b58e", "chunk": "diff --git a/elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQueryResult.java b/elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQueryResult.java\nindex a8d06ae5f..fc3e19205 100644\n--- a/elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQueryResult.java\n+++ b/elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQueryResult.java\n\n@@ -30,7 +29,6 @@ import javax.persistence.OneToOne;\n @CreatePermission(expression = \"Prefab.Role.None\")\n @DeletePermission(expression = \"Prefab.Role.None\")\n @Data\n-@EqualsAndHashCode(callSuper = false)\n public class AsyncQueryResult extends AsyncBase implements PrincipalOwned {\n     @Id\n     @Column(columnDefinition = \"varchar(36)\")\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg4NDAwNA==", "url": "https://github.com/yahoo/elide/pull/1336#discussion_r428884004", "bodyText": "We have to use the natural key for equals/hashcode for Hibernate.", "author": "aklish", "createdAt": "2020-05-21T20:04:39Z", "path": "elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQuery.java", "diffHunk": "@@ -32,6 +33,7 @@\n @UpdatePermission(expression = \"Prefab.Role.None\")\n @DeletePermission(expression = \"Prefab.Role.None\")\n @Data\n+@EqualsAndHashCode(callSuper = false)", "originalCommit": "c7843ecab0922abbff3f745c31384ccd93e41fdb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e626af2bf15f06f93c5a28cf6921e7919979b58e", "chunk": "diff --git a/elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQuery.java b/elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQuery.java\nindex 5562eab20..2443509aa 100644\n--- a/elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQuery.java\n+++ b/elide-async/src/main/java/com/yahoo/elide/async/models/AsyncQuery.java\n\n@@ -33,7 +32,6 @@ import javax.validation.constraints.Pattern;\n @UpdatePermission(expression = \"Prefab.Role.None\")\n @DeletePermission(expression = \"Prefab.Role.None\")\n @Data\n-@EqualsAndHashCode(callSuper = false)\n public class AsyncQuery extends AsyncBase implements PrincipalOwned {\n     @Id\n     @Column(columnDefinition = \"varchar(36)\")\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg4NTc3NQ==", "url": "https://github.com/yahoo/elide/pull/1336#discussion_r428885775", "bodyText": "Same - you can remove callSuper = false.", "author": "aklish", "createdAt": "2020-05-21T20:08:15Z", "path": "elide-spring/elide-spring-boot-autoconfigure/src/main/java/com/yahoo/elide/spring/config/SwaggerControllerProperties.java", "diffHunk": "@@ -6,11 +6,13 @@\n package com.yahoo.elide.spring.config;\n \n import lombok.Data;\n+import lombok.EqualsAndHashCode;\n \n /**\n  * Extra controller properties for the Swagger document endpoint.\n  */\n @Data\n+@EqualsAndHashCode(callSuper = false)", "originalCommit": "c7843ecab0922abbff3f745c31384ccd93e41fdb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e626af2bf15f06f93c5a28cf6921e7919979b58e", "chunk": "diff --git a/elide-spring/elide-spring-boot-autoconfigure/src/main/java/com/yahoo/elide/spring/config/SwaggerControllerProperties.java b/elide-spring/elide-spring-boot-autoconfigure/src/main/java/com/yahoo/elide/spring/config/SwaggerControllerProperties.java\nindex 75b025acb..b13002116 100644\n--- a/elide-spring/elide-spring-boot-autoconfigure/src/main/java/com/yahoo/elide/spring/config/SwaggerControllerProperties.java\n+++ b/elide-spring/elide-spring-boot-autoconfigure/src/main/java/com/yahoo/elide/spring/config/SwaggerControllerProperties.java\n\n@@ -6,13 +6,11 @@\n package com.yahoo.elide.spring.config;\n \n import lombok.Data;\n-import lombok.EqualsAndHashCode;\n \n /**\n  * Extra controller properties for the Swagger document endpoint.\n  */\n @Data\n-@EqualsAndHashCode(callSuper = false)\n public class SwaggerControllerProperties extends ControllerProperties {\n \n     /**\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0ODk4Mw==", "url": "https://github.com/yahoo/elide/pull/1336#discussion_r430648983", "bodyText": "This may not be a safe cast.  There are other Serde's for Date besides ISO8601.  Also, the client has control over this so let's figure out what can work in all circumstances.", "author": "aklish", "createdAt": "2020-05-26T19:18:51Z", "path": "elide-async/src/main/java/com/yahoo/elide/async/service/AsyncQueryCleanerThread.java", "diffHunk": "@@ -77,7 +78,8 @@ private String evaluateFormattedFilterDate(int calendarUnit, int amount) {\n         cal.setTime(new Date());\n         cal.add(calendarUnit, -(amount));\n         Date filterDate = cal.getTime();\n-        Format dateFormat = new SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm'Z'\");\n+        ISO8601DateSerde serde = (ISO8601DateSerde) elide.getElideSettings().getSerdes().get(Date.class);", "originalCommit": "8b73b9c2c4c21ddeae135cdfed9cce930bec84ec", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "15261c31fbff9aef6476cae0a7509b346c8a63b0", "chunk": "diff --git a/elide-async/src/main/java/com/yahoo/elide/async/service/AsyncQueryCleanerThread.java b/elide-async/src/main/java/com/yahoo/elide/async/service/AsyncQueryCleanerThread.java\nindex 654bdbbc9..fb24bb487 100644\n--- a/elide-async/src/main/java/com/yahoo/elide/async/service/AsyncQueryCleanerThread.java\n+++ b/elide-async/src/main/java/com/yahoo/elide/async/service/AsyncQueryCleanerThread.java\n\n@@ -78,8 +77,7 @@ public class AsyncQueryCleanerThread implements Runnable {\n         cal.setTime(new Date());\n         cal.add(calendarUnit, -(amount));\n         Date filterDate = cal.getTime();\n-        ISO8601DateSerde serde = (ISO8601DateSerde) elide.getElideSettings().getSerdes().get(Date.class);\n-        Format dateFormat = new SimpleDateFormat(serde.getFormat());\n+        Format dateFormat = new SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm'Z'\");\n         String filterDateFormatted = dateFormat.format(filterDate);\n         log.debug(\"FilterDateFormatted = {}\", filterDateFormatted);\n         return filterDateFormatted;\n"}}, {"oid": "3a84c6816678825fa241cbeef8c4ac2b1f88590b", "url": "https://github.com/yahoo/elide/commit/3a84c6816678825fa241cbeef8c4ac2b1f88590b", "message": "misc_fixes", "committedDate": "2020-05-28T21:07:32Z", "type": "commit"}, {"oid": "e626af2bf15f06f93c5a28cf6921e7919979b58e", "url": "https://github.com/yahoo/elide/commit/e626af2bf15f06f93c5a28cf6921e7919979b58e", "message": "review comments", "committedDate": "2020-05-28T21:07:43Z", "type": "commit"}, {"oid": "e626af2bf15f06f93c5a28cf6921e7919979b58e", "url": "https://github.com/yahoo/elide/commit/e626af2bf15f06f93c5a28cf6921e7919979b58e", "message": "review comments", "committedDate": "2020-05-28T21:07:43Z", "type": "forcePushed"}, {"oid": "15261c31fbff9aef6476cae0a7509b346c8a63b0", "url": "https://github.com/yahoo/elide/commit/15261c31fbff9aef6476cae0a7509b346c8a63b0", "message": "Review Comments", "committedDate": "2020-05-29T01:08:19Z", "type": "commit"}, {"oid": "9ac355f553692847c39b08445521a2d721f9c33d", "url": "https://github.com/yahoo/elide/commit/9ac355f553692847c39b08445521a2d721f9c33d", "message": "DyFixes", "committedDate": "2020-06-02T21:37:54Z", "type": "commit"}, {"oid": "ddd24533afc09dc606f8ac08f8515ec3d204dd7e", "url": "https://github.com/yahoo/elide/commit/ddd24533afc09dc606f8ac08f8515ec3d204dd7e", "message": "DyFixes", "committedDate": "2020-06-02T22:58:22Z", "type": "commit"}]}