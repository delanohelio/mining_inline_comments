{"pr_number": 1662, "pr_title": "Display user friendly messages for Json Schema validation failures", "pr_createdAt": "2020-11-13T15:44:20Z", "pr_url": "https://github.com/yahoo/elide/pull/1662", "timeline": [{"oid": "8d69525ca1df092abc91c9c3b698b308b4ab076c", "url": "https://github.com/yahoo/elide/commit/8d69525ca1df092abc91c9c3b698b308b4ab076c", "message": "test custom errors", "committedDate": "2020-11-16T17:30:14Z", "type": "forcePushed"}, {"oid": "cd3dee4c4e435e0e605493e446f8d0a164395a99", "url": "https://github.com/yahoo/elide/commit/cd3dee4c4e435e0e605493e446f8d0a164395a99", "message": "aa", "committedDate": "2020-11-16T18:14:00Z", "type": "forcePushed"}, {"oid": "4baeb6f87029a165de57dc903948e6363537408a", "url": "https://github.com/yahoo/elide/commit/4baeb6f87029a165de57dc903948e6363537408a", "message": "aa", "committedDate": "2020-11-16T19:05:48Z", "type": "forcePushed"}, {"oid": "6962c198b5c540530bdb98c857b27910d2390148", "url": "https://github.com/yahoo/elide/commit/6962c198b5c540530bdb98c857b27910d2390148", "message": "Display user friendly messages for Json Schema validation failures", "committedDate": "2020-11-16T19:28:23Z", "type": "forcePushed"}, {"oid": "3b45a410cdb1081e67f936bf2fab0ff01e248964", "url": "https://github.com/yahoo/elide/commit/3b45a410cdb1081e67f936bf2fab0ff01e248964", "message": "Display user friendly messages for Json Schema validation failures", "committedDate": "2020-11-16T21:51:35Z", "type": "forcePushed"}, {"oid": "52141a9f7ad01a068373470e7f1f48823a19efdb", "url": "https://github.com/yahoo/elide/commit/52141a9f7ad01a068373470e7f1f48823a19efdb", "message": "Display user friendly messages for Json Schema validation failures", "committedDate": "2020-11-16T21:58:28Z", "type": "forcePushed"}, {"oid": "676ec8ec04b1d64b4e63f74a8b487a22524a591d", "url": "https://github.com/yahoo/elide/commit/676ec8ec04b1d64b4e63f74a8b487a22524a591d", "message": "Display user friendly messages for Json Schema validation failures", "committedDate": "2020-11-16T21:59:59Z", "type": "forcePushed"}, {"oid": "fd1dd43a477afc4a91a6ff2d9f5ca8e51484c09e", "url": "https://github.com/yahoo/elide/commit/fd1dd43a477afc4a91a6ff2d9f5ca8e51484c09e", "message": "Display user friendly messages for Json Schema validation failures", "committedDate": "2020-11-16T22:08:11Z", "type": "forcePushed"}, {"oid": "9a97b49ee862de53288184e76db6b6be704d2789", "url": "https://github.com/yahoo/elide/commit/9a97b49ee862de53288184e76db6b6be704d2789", "message": "Display user friendly messages for Json Schema validation failures", "committedDate": "2020-11-16T22:10:01Z", "type": "commit"}, {"oid": "9a97b49ee862de53288184e76db6b6be704d2789", "url": "https://github.com/yahoo/elide/commit/9a97b49ee862de53288184e76db6b6be704d2789", "message": "Display user friendly messages for Json Schema validation failures", "committedDate": "2020-11-16T22:10:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDcyNjYzMg==", "url": "https://github.com/yahoo/elide/pull/1662#discussion_r524726632", "bodyText": "Any reason not to build this once in the constructor of the DynamicConfigSchemaValidator?", "author": "aklish", "createdAt": "2020-11-16T23:12:34Z", "path": "elide-model-config/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/DynamicConfigSchemaValidator.java", "diffHunk": "@@ -122,11 +123,36 @@ private static void addEmbeddedMessages(JsonNode root, List<String> list, int de\n         }\n     }\n \n+    private static String extractPointer(JsonNode root, String fieldName) {\n+        String pointer = null;\n+        if (root.has(fieldName)) {\n+            JsonNode node = root.get(fieldName);\n+            if (node.has(\"pointer\")) {\n+                pointer = node.get(\"pointer\").asText();\n+            }\n+        }\n+\n+        return pointer;\n+    }\n+\n     private JsonSchema loadSchema(String resource) {\n-        ObjectMapper objectMapper = new ObjectMapper();\n-        Reader reader = new InputStreamReader(DynamicConfigHelpers.class.getResourceAsStream(resource));\n+\n+        Library library = DraftV4LibraryWithElideFormatAttr.getInstance();\n+\n+        MessageBundle bundle = MessageBundleWithElideMessages.getInstance();\n+\n+        ValidationConfiguration cfg = ValidationConfiguration.newBuilder()\n+                        .setDefaultLibrary(\"http://my.site/myschema#\", library)\n+                        .setValidationMessages(bundle)\n+                        .freeze();\n+\n+        JsonSchemaFactory factory = JsonSchemaFactory.newBuilder()", "originalCommit": "9a97b49ee862de53288184e76db6b6be704d2789", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDc0ODU0OQ==", "url": "https://github.com/yahoo/elide/pull/1662#discussion_r524748549", "bodyText": "updated.", "author": "rishi-aga", "createdAt": "2020-11-16T23:29:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDcyNjYzMg=="}], "type": "inlineReview", "revised_code": {"commit": "32320789e53827486c6f89b10569af877483e6b1", "chunk": "diff --git a/elide-model-config/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/DynamicConfigSchemaValidator.java b/elide-model-config/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/DynamicConfigSchemaValidator.java\nindex 293437699..1e4532c26 100644\n--- a/elide-model-config/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/DynamicConfigSchemaValidator.java\n+++ b/elide-model-config/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/DynamicConfigSchemaValidator.java\n\n@@ -135,20 +149,7 @@ public class DynamicConfigSchemaValidator {\n         return pointer;\n     }\n \n-    private JsonSchema loadSchema(String resource) {\n-\n-        Library library = DraftV4LibraryWithElideFormatAttr.getInstance();\n-\n-        MessageBundle bundle = MessageBundleWithElideMessages.getInstance();\n-\n-        ValidationConfiguration cfg = ValidationConfiguration.newBuilder()\n-                        .setDefaultLibrary(\"http://my.site/myschema#\", library)\n-                        .setValidationMessages(bundle)\n-                        .freeze();\n-\n-        JsonSchemaFactory factory = JsonSchemaFactory.newBuilder()\n-                        .setValidationConfiguration(cfg)\n-                        .freeze();\n+    private static JsonSchema loadSchema(JsonSchemaFactory factory, String resource) {\n \n         try {\n             return factory.getJsonSchema(\n"}}, {"oid": "32320789e53827486c6f89b10569af877483e6b1", "url": "https://github.com/yahoo/elide/commit/32320789e53827486c6f89b10569af877483e6b1", "message": "Review Comments", "committedDate": "2020-11-16T23:38:53Z", "type": "commit"}]}