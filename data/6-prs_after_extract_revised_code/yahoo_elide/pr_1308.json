{"pr_number": 1308, "pr_title": "Fixing bug where legacy hibernate 5 entity manager store recycles the\u2026", "pr_createdAt": "2020-05-07T20:03:49Z", "pr_url": "https://github.com/yahoo/elide/pull/1308", "timeline": [{"oid": "1634b6d4773b0b438c11b4ff8f640e0e9b3de5d6", "url": "https://github.com/yahoo/elide/commit/1634b6d4773b0b438c11b4ff8f640e0e9b3de5d6", "message": "Fixing bug where legacy hibernate 5 entity manager store recycles the entity manager", "committedDate": "2020-05-07T20:01:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc2ODg3NA==", "url": "https://github.com/yahoo/elide/pull/1308#discussion_r421768874", "bodyText": "Should we keep the deprecated function so we do not break existing code?\n    @Deprecated\n    public HibernateEntityManagerStore(HibernateEntityManager entityManager,\n                                       boolean isScrollEnabled,\n                                       ScrollMode scrollMode) {\n        this(entityManager.getEntityManagerFactory(), isScrollEnabled, scrollMode);\n    }", "author": "wcekan", "createdAt": "2020-05-07T20:18:52Z", "path": "elide-datastore/elide-datastore-hibernate5/src/main/java/com/yahoo/elide/datastores/hibernate5/HibernateEntityManagerStore.java", "diffHunk": "@@ -10,40 +10,22 @@\n \n import org.hibernate.ScrollMode;\n import org.hibernate.Session;\n-import org.hibernate.jpa.HibernateEntityManager;\n \n import javax.persistence.EntityManager;\n+import javax.persistence.EntityManagerFactory;\n import javax.persistence.metamodel.EntityType;\n \n /**\n  * Hibernate5 store supporting the EntityManager.\n  */\n public class HibernateEntityManagerStore extends AbstractHibernateStore {\n-    protected final EntityManager entityManager;\n+    protected final EntityManagerFactory entityManagerFactory;\n \n-    @Deprecated\n-    public HibernateEntityManagerStore(HibernateEntityManager entityManager,\n+    public HibernateEntityManagerStore(EntityManagerFactory entityManagerFactory,", "originalCommit": "1634b6d4773b0b438c11b4ff8f640e0e9b3de5d6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc2OTY2Mg==", "url": "https://github.com/yahoo/elide/pull/1308#discussion_r421769662", "bodyText": "Here too?\n@Deprecated\npublic HibernateEntityManagerStore(EntityManager entityManager,\n                                   boolean isScrollEnabled,\n                                   ScrollMode scrollMode) {\n    this(entityManager.getEntityManagerFactory(), isScrollEnabled, scrollMode);\n}", "author": "wcekan", "createdAt": "2020-05-07T20:20:21Z", "path": "elide-datastore/elide-datastore-hibernate5/src/main/java/com/yahoo/elide/datastores/hibernate5/HibernateEntityManagerStore.java", "diffHunk": "@@ -10,40 +10,22 @@\n \n import org.hibernate.ScrollMode;\n import org.hibernate.Session;\n-import org.hibernate.jpa.HibernateEntityManager;\n \n import javax.persistence.EntityManager;\n+import javax.persistence.EntityManagerFactory;\n import javax.persistence.metamodel.EntityType;\n \n /**\n  * Hibernate5 store supporting the EntityManager.\n  */\n public class HibernateEntityManagerStore extends AbstractHibernateStore {\n-    protected final EntityManager entityManager;\n+    protected final EntityManagerFactory entityManagerFactory;\n \n-    @Deprecated\n-    public HibernateEntityManagerStore(HibernateEntityManager entityManager,\n+    public HibernateEntityManagerStore(EntityManagerFactory entityManagerFactory,\n                                        boolean isScrollEnabled,\n                                        ScrollMode scrollMode) {\n         super(null, isScrollEnabled, scrollMode);\n-        this.entityManager = entityManager;\n-    }\n-\n-    public HibernateEntityManagerStore(EntityManager entityManager,", "originalCommit": "1634b6d4773b0b438c11b4ff8f640e0e9b3de5d6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}