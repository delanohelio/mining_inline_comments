{"pr_number": 1696, "pr_title": "Elide 5.x MetaDataStore enable/disable flag", "pr_createdAt": "2020-11-25T18:13:02Z", "pr_url": "https://github.com/yahoo/elide/pull/1696", "timeline": [{"oid": "4f649d95da933ed63c1b861c29b860673307b11e", "url": "https://github.com/yahoo/elide/commit/4f649d95da933ed63c1b861c29b860673307b11e", "message": "metadatastore api enable flag", "committedDate": "2020-11-25T18:07:38Z", "type": "commit"}, {"oid": "63bab552f9cbd77fef7ac9ca154319839b249226", "url": "https://github.com/yahoo/elide/commit/63bab552f9cbd77fef7ac9ca154319839b249226", "message": "metadatastore api enable flag", "committedDate": "2020-11-30T16:07:05Z", "type": "commit"}, {"oid": "a34217743fe47a62d91ee4f9cce3348759cba24a", "url": "https://github.com/yahoo/elide/commit/a34217743fe47a62d91ee4f9cce3348759cba24a", "message": "Merge branch 'elide-5.x-metadatastore-flag' of https://github.com/yahoo/elide into elide-5.x-metadatastore-flag", "committedDate": "2020-11-30T16:07:20Z", "type": "commit"}, {"oid": "407b342a210a286db3bc5a2041de64c0b94f3d3c", "url": "https://github.com/yahoo/elide/commit/407b342a210a286db3bc5a2041de64c0b94f3d3c", "message": "testcase update", "committedDate": "2020-11-30T16:48:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyMzg0OA==", "url": "https://github.com/yahoo/elide/pull/1696#discussion_r533023848", "bodyText": "Just curious, what change in this PR would need this test case to be updated.", "author": "moizarafat", "createdAt": "2020-12-01T02:01:56Z", "path": "elide-model-config/src/test/java/com/yahoo/elide/modelconfig/validator/DynamicConfigValidatorTest.java", "diffHunk": "@@ -140,7 +140,7 @@ public void testInheritanceCycle() throws Exception {\n             assertEquals(2, exitStatus);\n         });\n \n-        assertEquals(\"Inheriting from table 'B' creates an illegal cyclic dependency.\\n\", error);\n+        assertEquals(\"Inheriting from table 'A' creates an illegal cyclic dependency.\\n\", error);", "originalCommit": "407b342a210a286db3bc5a2041de64c0b94f3d3c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1a5d4a95eff2c337a06ae729de2d2244d6fa9c60", "chunk": "diff --git a/elide-model-config/src/test/java/com/yahoo/elide/modelconfig/validator/DynamicConfigValidatorTest.java b/elide-model-config/src/test/java/com/yahoo/elide/modelconfig/validator/DynamicConfigValidatorTest.java\nindex a643fe0a8..21a78fb59 100644\n--- a/elide-model-config/src/test/java/com/yahoo/elide/modelconfig/validator/DynamicConfigValidatorTest.java\n+++ b/elide-model-config/src/test/java/com/yahoo/elide/modelconfig/validator/DynamicConfigValidatorTest.java\n\n@@ -140,7 +140,8 @@ public class DynamicConfigValidatorTest {\n             assertEquals(2, exitStatus);\n         });\n \n-        assertEquals(\"Inheriting from table 'A' creates an illegal cyclic dependency.\\n\", error);\n+        assertTrue(error.contains(\"Inheriting from table\"));\n+        assertTrue(error.contains(\"creates an illegal cyclic dependency.\"));\n     }\n \n     @Test\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyNjc0Ng==", "url": "https://github.com/yahoo/elide/pull/1696#discussion_r533026746", "bodyText": "Can we set this to false? I think this does not need to be true for the test cases relying on SQLUnitTest to work. If it can work with false, then it will test the other scenario that we can do analytical queries without populating /table, /column etc.", "author": "moizarafat", "createdAt": "2020-12-01T02:11:35Z", "path": "elide-datastore/elide-datastore-aggregation/src/test/java/com/yahoo/elide/datastores/aggregation/framework/SQLUnitTest.java", "diffHunk": "@@ -348,7 +348,7 @@ public static void init(String sqlDialect) {\n             throw new IllegalStateException(e);\n         }\n \n-        metaDataStore = new MetaDataStore(ClassScanner.getAllClasses(\"com.yahoo.elide.datastores.aggregation.example\"));\n+        metaDataStore = new MetaDataStore(ClassScanner.getAllClasses(\"com.yahoo.elide.datastores.aggregation.example\"), true);", "originalCommit": "407b342a210a286db3bc5a2041de64c0b94f3d3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyNzIxNw==", "url": "https://github.com/yahoo/elide/pull/1696#discussion_r533027217", "bodyText": "If it does not work then we need test cases which verify that we can do analytical queries without populating /table, /column etc.", "author": "moizarafat", "createdAt": "2020-12-01T02:13:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyNjc0Ng=="}], "type": "inlineReview", "revised_code": {"commit": "805b1ddf5b2e6626c8603c0a023faeb034009aec", "chunk": "diff --git a/elide-datastore/elide-datastore-aggregation/src/test/java/com/yahoo/elide/datastores/aggregation/framework/SQLUnitTest.java b/elide-datastore/elide-datastore-aggregation/src/test/java/com/yahoo/elide/datastores/aggregation/framework/SQLUnitTest.java\nindex 94d7ed53b..fee51e721 100644\n--- a/elide-datastore/elide-datastore-aggregation/src/test/java/com/yahoo/elide/datastores/aggregation/framework/SQLUnitTest.java\n+++ b/elide-datastore/elide-datastore-aggregation/src/test/java/com/yahoo/elide/datastores/aggregation/framework/SQLUnitTest.java\n\n@@ -348,7 +348,7 @@ public abstract class SQLUnitTest {\n             throw new IllegalStateException(e);\n         }\n \n-        metaDataStore = new MetaDataStore(ClassScanner.getAllClasses(\"com.yahoo.elide.datastores.aggregation.example\"), true);\n+        metaDataStore = new MetaDataStore(ClassScanner.getAllClasses(\"com.yahoo.elide.datastores.aggregation.example\"), false);\n \n         dictionary = new EntityDictionary(new HashMap<>());\n         dictionary.bindEntity(PlayerStatsWithView.class);\n"}}, {"oid": "805b1ddf5b2e6626c8603c0a023faeb034009aec", "url": "https://github.com/yahoo/elide/commit/805b1ddf5b2e6626c8603c0a023faeb034009aec", "message": "sqlunittest update", "committedDate": "2020-12-01T17:29:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY2MDAxOA==", "url": "https://github.com/yahoo/elide/pull/1696#discussion_r533660018", "bodyText": "nice", "author": "aklish", "createdAt": "2020-12-01T19:17:16Z", "path": "elide-spring/elide-spring-boot-autoconfigure/src/test/java/example/tests/DisableMetaDataStoreControllerTest.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Copyright 2020, Yahoo Inc.\n+ * Licensed under the Apache License, Version 2.0\n+ * See LICENSE file in project root for terms.\n+ */\n+package example.tests;\n+\n+import static io.restassured.RestAssured.when;\n+import static org.hamcrest.Matchers.containsInAnyOrder;\n+import com.yahoo.elide.core.exceptions.HttpStatus;\n+import org.junit.jupiter.api.Test;\n+import org.springframework.test.context.ActiveProfiles;\n+\n+/**\n+ * Executes Controller tests with Aggregation Store disabled.\n+ */\n+@ActiveProfiles(\"disableMetaDataStore\")", "originalCommit": "805b1ddf5b2e6626c8603c0a023faeb034009aec", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "1a5d4a95eff2c337a06ae729de2d2244d6fa9c60", "url": "https://github.com/yahoo/elide/commit/1a5d4a95eff2c337a06ae729de2d2244d6fa9c60", "message": "Merge branch 'elide-5.x' into elide-5.x-metadatastore-flag", "committedDate": "2020-12-01T19:18:56Z", "type": "commit"}, {"oid": "f464ec00ed54cac126a7d8534330b4cb01d765d4", "url": "https://github.com/yahoo/elide/commit/f464ec00ed54cac126a7d8534330b4cb01d765d4", "message": "Merge branch 'elide-5.x' into elide-5.x-metadatastore-flag", "committedDate": "2020-12-01T19:45:14Z", "type": "commit"}]}