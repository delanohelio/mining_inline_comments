{"pr_number": 1370, "pr_title": "Validate request tenant domain in tenant qualified URL mode", "pr_createdAt": "2020-04-29T05:21:28Z", "pr_url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1370", "timeline": [{"oid": "1be33535e19932ad74b984efb31bb6b1a3e97602", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/1be33535e19932ad74b984efb31bb6b1a3e97602", "message": "Validate request tenant domain against the app tenant domain in tenant qualified URL mode", "committedDate": "2020-04-29T05:13:44Z", "type": "commit"}, {"oid": "dae8ef91484ac38286d59137606d81bcb7130184", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/dae8ef91484ac38286d59137606d81bcb7130184", "message": "Code improvements", "committedDate": "2020-04-29T05:17:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzExNDQzNw==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1370#discussion_r417114437", "bodyText": "why are we creating array with one element here?", "author": "denuwanthi", "createdAt": "2020-04-29T07:22:30Z", "path": "components/org.wso2.carbon.identity.oauth.endpoint/src/main/java/org/wso2/carbon/identity/oauth/endpoint/token/OAuth2TokenEndpoint.java", "diffHunk": "@@ -328,7 +276,7 @@ private OAuth2AccessTokenReqDTO buildAccessTokenReqDTO(CarbonOAuthTokenRequest o\n         tokenReqDTO.setClientId(oauthClientAuthnContext.getClientId());\n         tokenReqDTO.setClientSecret(oauthRequest.getClientSecret());\n         tokenReqDTO.setCallbackURI(oauthRequest.getRedirectURI());\n-        tokenReqDTO.setScope(oauthRequest.getScopes().toArray(new String[oauthRequest.getScopes().size()]));\n+        tokenReqDTO.setScope(oauthRequest.getScopes().toArray(new String[0]));", "originalCommit": "dae8ef91484ac38286d59137606d81bcb7130184", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzEzMjk0Nw==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1370#discussion_r417132947", "bodyText": "It was a suggestion from the IDE.\nThe inspection says\n\nCall to 'toArray()' with pre-sized array argument 'new IdentityProviderProperty[newProperties.size()]'\n\n\nInspection info: There are two styles to convert a collection to an array: either using a pre-sized array (like c.toArray(new String[c.size()])) or using an empty array (like c.toArray(new String[0]).\n\n\nIn older Java versions using pre-sized array was recommended, as the reflection call which is necessary to create an array of proper size was quite slow. However since late updates of OpenJDK 6 this call was intrinsified, making the performance of the empty array version the same and sometimes even better, compared to the pre-sized version. Also passing pre-sized array is dangerous for a concurrent or synchronized collection as a data race is possible between the size and toArray call which may result in extra nulls at the end of the array, if the collection was concurrently shrunk during the operation.\nThis inspection allows to follow the uniform style: either using an empty array (which is recommended in modern Java) or using a pre-sized array (which might be faster in older Java versions or non-HotSpot based JVMs).", "author": "mefarazath", "createdAt": "2020-04-29T07:58:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzExNDQzNw=="}], "type": "inlineReview", "revised_code": null}]}