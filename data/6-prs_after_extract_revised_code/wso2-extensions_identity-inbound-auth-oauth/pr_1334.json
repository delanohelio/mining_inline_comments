{"pr_number": 1334, "pr_title": "Fix the state issue when client secret regenerates", "pr_createdAt": "2020-02-26T10:27:45Z", "pr_url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1334", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQxOTM3MA==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1334#discussion_r384419370", "bodyText": "Start the comment with a capital letter. Check other places as well.", "author": "nilasini", "createdAt": "2020-02-26T10:57:28Z", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/dao/TokenManagementDAOImpl.java", "diffHunk": "@@ -520,21 +520,31 @@ public void updateAppAndRevokeTokensAndAuthzCodes(String consumerKey, Properties\n                     throw new IdentityOAuth2Exception(\"New Consumer Secret is not specified.\");\n                 }\n \n+                if (properties.containsKey(OAuthConstants.OAUTH_APP_NEW_STATE)) {\n+                    // update the consumer secret of the oauth app when the new app state is available.", "originalCommit": "ea129a73ed3a123ac0d5b2348ca93dfc7e4b01b7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDYyODk5Mw==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1334#discussion_r384628993", "bodyText": "Edited the comments.", "author": "ShanChathusanda93", "createdAt": "2020-02-26T16:57:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQxOTM3MA=="}], "type": "inlineReview", "revised_code": {"commit": "02d35a9ecea236695f65e451c0a33aa985ecbf7e", "chunk": "diff --git a/components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/dao/TokenManagementDAOImpl.java b/components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/dao/TokenManagementDAOImpl.java\nindex 8827a427c..14070a171 100644\n--- a/components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/dao/TokenManagementDAOImpl.java\n+++ b/components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/dao/TokenManagementDAOImpl.java\n\n@@ -521,7 +521,7 @@ public class TokenManagementDAOImpl extends AbstractOAuthDAO implements TokenMan\n                 }\n \n                 if (properties.containsKey(OAuthConstants.OAUTH_APP_NEW_STATE)) {\n-                    // update the consumer secret of the oauth app when the new app state is available.\n+                    // Update the consumer secret of the oauth app when the new app state is available.\n                     updateStateStatement = connection.prepareStatement\n                             (org.wso2.carbon.identity.oauth.dao.SQLQueries.OAuthAppDAOSQLQueries.\n                                     UPDATE_OAUTH_SECRET_KEY_AND_STATE);\n"}}, {"oid": "02d35a9ecea236695f65e451c0a33aa985ecbf7e", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/02d35a9ecea236695f65e451c0a33aa985ecbf7e", "message": "Fix the state issue when client secret regenerates", "committedDate": "2020-02-26T16:56:15Z", "type": "commit"}, {"oid": "02d35a9ecea236695f65e451c0a33aa985ecbf7e", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/02d35a9ecea236695f65e451c0a33aa985ecbf7e", "message": "Fix the state issue when client secret regenerates", "committedDate": "2020-02-26T16:56:15Z", "type": "forcePushed"}]}