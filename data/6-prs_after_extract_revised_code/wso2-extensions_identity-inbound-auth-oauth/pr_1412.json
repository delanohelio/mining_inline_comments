{"pr_number": 1412, "pr_title": "Fix issue end tenant flow without calling start.", "pr_createdAt": "2020-07-10T13:52:34Z", "pr_url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1412", "timeline": [{"oid": "d30c22972e641b2fdcf09766269009f52244d08f", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/d30c22972e641b2fdcf09766269009f52244d08f", "message": "End tenant flow without calling start.\n\nFix: https://github.com/wso2-extensions/identity-inbound-auth-oauth/issues/1409", "committedDate": "2020-07-10T13:49:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjg2NDkyNg==", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1412#discussion_r452864926", "bodyText": "we can remove this since we are already doing the tenant validation in rewrite valve.. https://github.com/wso2-extensions/identity-carbon-auth-rest/blob/3d37c882f4b96701b8d333c2fc82b42b18da0348/components/org.wso2.carbon.identity.context.rewrite.valve/src/main/java/org/wso2/carbon/identity/context/rewrite/valve/TenantContextRewriteValve.java#L111-L112", "author": "emswbandara", "createdAt": "2020-07-10T14:05:09Z", "path": "components/org.wso2.carbon.identity.oauth.endpoint/src/main/java/org/wso2/carbon/identity/oauth/endpoint/jwks/JwksEndpoint.java", "diffHunk": "@@ -86,9 +86,13 @@ public String jwks() {\n                     String errorMessage = \"Invalid Tenant: \" + tenantDomain;", "originalCommit": "d30c22972e641b2fdcf09766269009f52244d08f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "262dffc215507d7b73a72dc93c769de4c3c1257e", "chunk": "diff --git a/components/org.wso2.carbon.identity.oauth.endpoint/src/main/java/org/wso2/carbon/identity/oauth/endpoint/jwks/JwksEndpoint.java b/components/org.wso2.carbon.identity.oauth.endpoint/src/main/java/org/wso2/carbon/identity/oauth/endpoint/jwks/JwksEndpoint.java\nindex e2d39d1e6..f31de8ce1 100644\n--- a/components/org.wso2.carbon.identity.oauth.endpoint/src/main/java/org/wso2/carbon/identity/oauth/endpoint/jwks/JwksEndpoint.java\n+++ b/components/org.wso2.carbon.identity.oauth.endpoint/src/main/java/org/wso2/carbon/identity/oauth/endpoint/jwks/JwksEndpoint.java\n\n@@ -82,11 +81,8 @@ public class JwksEndpoint {\n                 String password = CarbonUtils.getServerConfiguration().getFirstProperty(SECURITY_KEY_STORE_PW);\n                 keystore.load(file, password.toCharArray());\n             } else {\n-                if (isInvalidTenantId(tenantId)) {\n-                    String errorMessage = \"Invalid Tenant: \" + tenantDomain;\n-                    return logAndReturnError(errorMessage, null);\n-                }\n                 try {\n+                    int tenantId = IdentityTenantUtil.getTenantId(tenantDomain);\n                     FrameworkUtils.startTenantFlow(tenantDomain);\n                     KeyStoreManager keyStoreManager = KeyStoreManager.getInstance(tenantId);\n                     keystore = keyStoreManager.getKeyStore(generateKSNameFromDomainName(tenantDomain));\n"}}, {"oid": "262dffc215507d7b73a72dc93c769de4c3c1257e", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/262dffc215507d7b73a72dc93c769de4c3c1257e", "message": "Remove tenant validation from JWKS.", "committedDate": "2020-07-16T09:56:54Z", "type": "commit"}]}