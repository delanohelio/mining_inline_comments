{"pr_number": 10307, "pr_title": "Fix _id value computation for  PK lookups", "pr_createdAt": "2020-08-04T06:33:24Z", "pr_url": "https://github.com/crate/crate/pull/10307", "timeline": [{"oid": "f3bf7e4cf8ae886a4b3e9cd1e340ddf390ada65d", "url": "https://github.com/crate/crate/commit/f3bf7e4cf8ae886a4b3e9cd1e340ddf390ada65d", "message": "Fix _id value computation for  PK lookups\n\nThe `RowShardResolver` uses `nullOrString` to turn all values to a\nstring before computing the final `_id` value.\n\n`DocKeys#getId` insted used `DataTypes.STRING.implicitCast`.\n\nDue to this boolean values were treated differently. One used `'true'`\nwhile the other used `'t'`, leading to different `_id` value on primary\nlookups than what was inserted.\n\nWe cannot change the insert part, because the data has already been\npersisted in many installations, so this changed the lookup instead.\n\nCloses https://github.com/crate/crate/issues/10302", "committedDate": "2020-08-04T06:30:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDgyOTUyNg==", "url": "https://github.com/crate/crate/pull/10307#discussion_r464829526", "bodyText": "Lists2.map already includes this optimization", "author": "mfussenegger", "createdAt": "2020-08-04T06:34:24Z", "path": "server/src/main/java/io/crate/execution/engine/collect/RowShardResolver.java", "diffHunk": "@@ -86,9 +86,6 @@ public void setNextRow(Row row) {\n     }\n \n     private static List<String> pkValues(List<Input<?>> primaryKeyInputs) {\n-        if (primaryKeyInputs.isEmpty()) {", "originalCommit": "f3bf7e4cf8ae886a4b3e9cd1e340ddf390ada65d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}