{"pr_number": 9850, "pr_title": "Use new function registry for all existing window functions.", "pr_createdAt": "2020-04-03T09:23:21Z", "pr_url": "https://github.com/crate/crate/pull/9850", "timeline": [{"oid": "bfd4e574a7cdd6dba7abefbeaa4d20d22d9b2a71", "url": "https://github.com/crate/crate/commit/bfd4e574a7cdd6dba7abefbeaa4d20d22d9b2a71", "message": "Use new function registry for the row_number window function.", "committedDate": "2020-04-03T11:00:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkzNzQ1Mw==", "url": "https://github.com/crate/crate/pull/9850#discussion_r402937453", "bodyText": "not sure about this specific case, though.", "author": "kovrus", "createdAt": "2020-04-03T11:22:43Z", "path": "enterprise/functions/src/test/java/io/crate/window/OffsetValueFunctionsTest.java", "diffHunk": "@@ -101,7 +101,7 @@ public void testLagNegativeOffsetAndEmptyOver() throws Throwable {\n     public void testLagWithDefaultValueAndEmptyOver() throws Throwable {\n         assertEvaluate(\n             \"lag(x, 1, -1) over()\",\n-            contains(new Object[]{-1, 1, 2, 3}),", "originalCommit": "27b586c72ccb1bfba306103b5304a32edf7e8af8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk4NTIyOA==", "url": "https://github.com/crate/crate/pull/9850#discussion_r402985228", "bodyText": "The new outcome is fine, the signature binder don't support implicit literal downcasts which the old FuncParams did. This is known and should be re-added later on on a different level as this is mostly lucene related.", "author": "seut", "createdAt": "2020-04-03T12:56:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkzNzQ1Mw=="}], "type": "inlineReview", "revised_code": {"commit": "433af5c7391549fb767c324837912c90e05ff490", "chunk": "diff --git a/enterprise/functions/src/test/java/io/crate/window/OffsetValueFunctionsTest.java b/enterprise/functions/src/test/java/io/crate/window/OffsetValueFunctionsTest.java\nindex 8dddd330a6..137942a433 100644\n--- a/enterprise/functions/src/test/java/io/crate/window/OffsetValueFunctionsTest.java\n+++ b/enterprise/functions/src/test/java/io/crate/window/OffsetValueFunctionsTest.java\n\n@@ -101,7 +101,7 @@ public class OffsetValueFunctionsTest extends AbstractWindowFunctionTest {\n     public void testLagWithDefaultValueAndEmptyOver() throws Throwable {\n         assertEvaluate(\n             \"lag(x, 1, -1) over()\",\n-            contains(new Object[]{-1L, 1L, 2L, 3L}),\n+            contains(new Object[]{-1, 1, 2, 3}),\n             List.of(new ColumnIdent(\"x\")),\n             new Object[]{1},\n             new Object[]{2},\n"}}, {"oid": "433af5c7391549fb767c324837912c90e05ff490", "url": "https://github.com/crate/crate/commit/433af5c7391549fb767c324837912c90e05ff490", "message": "Use new function registry for nth/last/first value window functions.", "committedDate": "2020-04-03T13:05:15Z", "type": "commit"}, {"oid": "49890b63a5fec61df22feaa5b66c16eff53d7002", "url": "https://github.com/crate/crate/commit/49890b63a5fec61df22feaa5b66c16eff53d7002", "message": "Use new function registry for offset window functions.", "committedDate": "2020-04-03T13:05:15Z", "type": "commit"}, {"oid": "e31974fd3ca6ff0a000a8bc91a574e56539956cf", "url": "https://github.com/crate/crate/commit/e31974fd3ca6ff0a000a8bc91a574e56539956cf", "message": "Use new function registry for the row_number window function.", "committedDate": "2020-04-03T13:05:15Z", "type": "commit"}, {"oid": "e31974fd3ca6ff0a000a8bc91a574e56539956cf", "url": "https://github.com/crate/crate/commit/e31974fd3ca6ff0a000a8bc91a574e56539956cf", "message": "Use new function registry for the row_number window function.", "committedDate": "2020-04-03T13:05:15Z", "type": "forcePushed"}]}