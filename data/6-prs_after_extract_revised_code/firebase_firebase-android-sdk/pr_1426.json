{"pr_number": 1426, "pr_title": "Add new version of setAutomaticDataCollectionEnabled api", "pr_createdAt": "2020-04-06T19:17:18Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/1426", "timeline": [{"oid": "4de7af3ba3ff0c6b222373e2c813c5dbf05104df", "url": "https://github.com/firebase/firebase-android-sdk/commit/4de7af3ba3ff0c6b222373e2c813c5dbf05104df", "message": "add inappmessaging support", "committedDate": "2020-04-06T18:37:32Z", "type": "commit"}, {"oid": "1789dc08f0e60e19b1b6d92937e60367e56e35e5", "url": "https://github.com/firebase/firebase-android-sdk/commit/1789dc08f0e60e19b1b6d92937e60367e56e35e5", "message": "small changes", "committedDate": "2020-04-06T19:16:34Z", "type": "commit"}, {"oid": "dfef30b3c6eb859b1dfdd55e93bfebead8a075df", "url": "https://github.com/firebase/firebase-android-sdk/commit/dfef30b3c6eb859b1dfdd55e93bfebead8a075df", "message": "update tests", "committedDate": "2020-04-06T19:44:24Z", "type": "commit"}, {"oid": "1944ffb122464ad7dbe9ba989f678342fe958aac", "url": "https://github.com/firebase/firebase-android-sdk/commit/1944ffb122464ad7dbe9ba989f678342fe958aac", "message": "add setter api call for inappmessaging", "committedDate": "2020-04-06T19:56:33Z", "type": "commit"}, {"oid": "e827c0b207a4ab9b13d90ef75a218a9ae3c47a9d", "url": "https://github.com/firebase/firebase-android-sdk/commit/e827c0b207a4ab9b13d90ef75a218a9ae3c47a9d", "message": "add tristate to inappmessaging", "committedDate": "2020-04-06T20:00:01Z", "type": "commit"}, {"oid": "a1714add03ebf7176a4315633756191334922a48", "url": "https://github.com/firebase/firebase-android-sdk/commit/a1714add03ebf7176a4315633756191334922a48", "message": "update api txt file and version", "committedDate": "2020-04-06T20:03:01Z", "type": "commit"}, {"oid": "34185c15b29f6597f1fb064579d31ad67d5689b9", "url": "https://github.com/firebase/firebase-android-sdk/commit/34185c15b29f6597f1fb064579d31ad67d5689b9", "message": "Merge branch 'master' into updateinappmessagingapi", "committedDate": "2020-04-07T16:11:15Z", "type": "commit"}, {"oid": "34185c15b29f6597f1fb064579d31ad67d5689b9", "url": "https://github.com/firebase/firebase-android-sdk/commit/34185c15b29f6597f1fb064579d31ad67d5689b9", "message": "Merge branch 'master' into updateinappmessagingapi", "committedDate": "2020-04-07T16:11:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAzOTcxMQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405039711", "bodyText": "@rachelsaunders  can you have a look at this? Thanks!", "author": "VinayGuthal", "createdAt": "2020-04-07T18:55:20Z", "path": "firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java", "diffHunk": "@@ -109,6 +110,42 @@ public boolean isAutomaticDataCollectionEnabled() {\n     return dataCollectionHelper.isAutomaticDataCollectionEnabled();\n   }\n \n+  /**", "originalCommit": "34185c15b29f6597f1fb064579d31ad67d5689b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4MDU1Nw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405080557", "bodyText": "@markarndt Please have a look :)", "author": "VinayGuthal", "createdAt": "2020-04-07T20:08:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAzOTcxMQ=="}], "type": "inlineReview", "revised_code": {"commit": "83283659558c4e335f97227231c1a4af84294e88", "chunk": "diff --git a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\nindex 50225e724..0b836211a 100644\n--- a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\n+++ b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\n\n@@ -124,7 +124,8 @@ public class FirebaseInAppMessaging {\n    * enabled by default.\n    *\n    * <p>If you need to change the default, (for example, because you want to prompt the user before\n-   * generates/refreshes a registration token on app startup), add to your application\u2019s manifest:\n+   * generates/refreshes a registration token on app startup), add the following\n+   * to your application\u2019s manifest:\n    *\n    * <pre>{@code\n    * <meta-data android:name=\"firebase_inapp_messaging_auto_init_enabled\" android:value=\"false\" />\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MjE5Ng==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405142196", "bodyText": "@VinayGuthal\nNot sure what's intended here, so perhaps \"...a registration token is generated/refreshed on app startup....\"", "author": "markarndt", "createdAt": "2020-04-07T22:07:54Z", "path": "firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java", "diffHunk": "@@ -109,6 +110,42 @@ public boolean isAutomaticDataCollectionEnabled() {\n     return dataCollectionHelper.isAutomaticDataCollectionEnabled();\n   }\n \n+  /**\n+   * Enable, disable or clear automatic data collection for Firebase In-App Messaging.\n+   *\n+   * <p>When enabled, generates a registration token on app startup if there is no valid one and\n+   * generates a new token when it is deleted (which prevents {@link\n+   * com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId} from stopping the periodic sending\n+   * of data). This setting is persisted across app restarts and overrides the setting specified in\n+   * your manifest.\n+   *\n+   * <p>When null, the enablement of the auto-initialization depends on the manifest and then on the\n+   * global enablement setting in this order. If none of these settings are present then it is\n+   * enabled by default.\n+   *\n+   * <p>If you need to change the default, (for example, because you want to prompt the user before\n+   * generates/refreshes a registration token on app startup), add to your application\u2019s manifest:", "originalCommit": "34185c15b29f6597f1fb064579d31ad67d5689b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg0MjY5NA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405842694", "bodyText": "hmm I just copied this from the existing documentation for the older function", "author": "VinayGuthal", "createdAt": "2020-04-08T22:06:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MjE5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg0Mzk3MA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405843970", "bodyText": "@JasonAHeron what do you think?", "author": "VinayGuthal", "createdAt": "2020-04-08T22:09:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MjE5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM3OTA1MA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r410379050", "bodyText": "This seems clear to me, what are you hoping to change with the docs?", "author": "JasonAHeron", "createdAt": "2020-04-17T17:51:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MjE5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQwMTQxNg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r410401416", "bodyText": "I was just confirming if this was okay!", "author": "VinayGuthal", "createdAt": "2020-04-17T18:34:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MjE5Ng=="}], "type": "inlineReview", "revised_code": {"commit": "83283659558c4e335f97227231c1a4af84294e88", "chunk": "diff --git a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\nindex 50225e724..0b836211a 100644\n--- a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\n+++ b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\n\n@@ -124,7 +124,8 @@ public class FirebaseInAppMessaging {\n    * enabled by default.\n    *\n    * <p>If you need to change the default, (for example, because you want to prompt the user before\n-   * generates/refreshes a registration token on app startup), add to your application\u2019s manifest:\n+   * generates/refreshes a registration token on app startup), add the following\n+   * to your application\u2019s manifest:\n    *\n    * <pre>{@code\n    * <meta-data android:name=\"firebase_inapp_messaging_auto_init_enabled\" android:value=\"false\" />\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MjQ3MQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405142471", "bodyText": "@VinayGuthal\n\"...add the following to your application's manifest:\"", "author": "markarndt", "createdAt": "2020-04-07T22:08:34Z", "path": "firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java", "diffHunk": "@@ -109,6 +110,42 @@ public boolean isAutomaticDataCollectionEnabled() {\n     return dataCollectionHelper.isAutomaticDataCollectionEnabled();\n   }\n \n+  /**\n+   * Enable, disable or clear automatic data collection for Firebase In-App Messaging.\n+   *\n+   * <p>When enabled, generates a registration token on app startup if there is no valid one and\n+   * generates a new token when it is deleted (which prevents {@link\n+   * com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId} from stopping the periodic sending\n+   * of data). This setting is persisted across app restarts and overrides the setting specified in\n+   * your manifest.\n+   *\n+   * <p>When null, the enablement of the auto-initialization depends on the manifest and then on the\n+   * global enablement setting in this order. If none of these settings are present then it is\n+   * enabled by default.\n+   *\n+   * <p>If you need to change the default, (for example, because you want to prompt the user before\n+   * generates/refreshes a registration token on app startup), add to your application\u2019s manifest:", "originalCommit": "34185c15b29f6597f1fb064579d31ad67d5689b9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "83283659558c4e335f97227231c1a4af84294e88", "chunk": "diff --git a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\nindex 50225e724..0b836211a 100644\n--- a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\n+++ b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\n\n@@ -124,7 +124,8 @@ public class FirebaseInAppMessaging {\n    * enabled by default.\n    *\n    * <p>If you need to change the default, (for example, because you want to prompt the user before\n-   * generates/refreshes a registration token on app startup), add to your application\u2019s manifest:\n+   * generates/refreshes a registration token on app startup), add the following\n+   * to your application\u2019s manifest:\n    *\n    * <pre>{@code\n    * <meta-data android:name=\"firebase_inapp_messaging_auto_init_enabled\" android:value=\"false\" />\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0Mjc2OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405142768", "bodyText": "@VinayGuthal\nJust confirming that unclosed  tags will get processed correctly?", "author": "markarndt", "createdAt": "2020-04-07T22:09:13Z", "path": "firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java", "diffHunk": "@@ -109,6 +110,42 @@ public boolean isAutomaticDataCollectionEnabled() {\n     return dataCollectionHelper.isAutomaticDataCollectionEnabled();\n   }\n \n+  /**\n+   * Enable, disable or clear automatic data collection for Firebase In-App Messaging.\n+   *\n+   * <p>When enabled, generates a registration token on app startup if there is no valid one and", "originalCommit": "34185c15b29f6597f1fb064579d31ad67d5689b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg0NDY3NQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405844675", "bodyText": "yes as per https://stackoverflow.com/questions/33787753/javadoc-closing-tags", "author": "VinayGuthal", "createdAt": "2020-04-08T22:11:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0Mjc2OA=="}], "type": "inlineReview", "revised_code": {"commit": "83283659558c4e335f97227231c1a4af84294e88", "chunk": "diff --git a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\nindex 50225e724..0b836211a 100644\n--- a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\n+++ b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessaging.java\n\n@@ -124,7 +124,8 @@ public class FirebaseInAppMessaging {\n    * enabled by default.\n    *\n    * <p>If you need to change the default, (for example, because you want to prompt the user before\n-   * generates/refreshes a registration token on app startup), add to your application\u2019s manifest:\n+   * generates/refreshes a registration token on app startup), add the following\n+   * to your application\u2019s manifest:\n    *\n    * <pre>{@code\n    * <meta-data android:name=\"firebase_inapp_messaging_auto_init_enabled\" android:value=\"false\" />\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MzMxNA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405143314", "bodyText": "@VinayGuthal\nSee above comments....", "author": "markarndt", "createdAt": "2020-04-07T22:10:34Z", "path": "firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/DataCollectionHelper.java", "diffHunk": "@@ -121,6 +121,47 @@ public void setAutomaticDataCollectionEnabled(boolean isEnabled) {\n     sharedPreferencesUtils.setBooleanPreference(AUTO_INIT_PREFERENCES, isEnabled);\n   }\n \n+  /**\n+   * Enable, disable or clear automatic data collection for Firebase In-App Messaging.\n+   *\n+   * <p>When enabled, generates a registration token on app startup if there is no valid one and", "originalCommit": "34185c15b29f6597f1fb064579d31ad67d5689b9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "83283659558c4e335f97227231c1a4af84294e88", "chunk": "diff --git a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/DataCollectionHelper.java b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/DataCollectionHelper.java\nindex ff7e7cad5..6845411e3 100644\n--- a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/DataCollectionHelper.java\n+++ b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/DataCollectionHelper.java\n\n@@ -135,7 +135,8 @@ public class DataCollectionHelper {\n    * enabled by default.\n    *\n    * <p>If you need to change the default, (for example, because you want to prompt the user before\n-   * generates/refreshes a registration token on app startup), add to your application\u2019s manifest:\n+   * generates/refreshes a registration token on app startup), add the following\n+   * to your application\u2019s manifest:\n    *\n    * <pre>{@code\n    * <meta-data android:name=\"firebase_inapp_messaging_auto_init_enabled\" android:value=\"false\" />\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MzczMA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1426#discussion_r405143730", "bodyText": "@VinayGuthal\n\"...in the app's stored preferences.\"", "author": "markarndt", "createdAt": "2020-04-07T22:11:35Z", "path": "firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/SharedPreferencesUtils.java", "diffHunk": "@@ -50,6 +50,19 @@ public void setBooleanPreference(String preference, boolean value) {\n     preferencesEditor.apply();\n   }\n \n+  /**\n+   * Helper method for clearing the value in the apps stored preferences.", "originalCommit": "34185c15b29f6597f1fb064579d31ad67d5689b9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "83283659558c4e335f97227231c1a4af84294e88", "chunk": "diff --git a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/SharedPreferencesUtils.java b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/SharedPreferencesUtils.java\nindex 41042b8cf..f06f05d19 100644\n--- a/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/SharedPreferencesUtils.java\n+++ b/firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/internal/SharedPreferencesUtils.java\n\n@@ -51,7 +51,7 @@ public class SharedPreferencesUtils {\n   }\n \n   /**\n-   * Helper method for clearing the value in the apps stored preferences.\n+   * Helper method for clearing the value in the app's stored preferences.\n    *\n    * @param preference the preference key.\n    */\n"}}, {"oid": "83283659558c4e335f97227231c1a4af84294e88", "url": "https://github.com/firebase/firebase-android-sdk/commit/83283659558c4e335f97227231c1a4af84294e88", "message": "java doc changes", "committedDate": "2020-04-08T22:11:36Z", "type": "commit"}, {"oid": "24963013cb88e47112fa434db2d50b1a0e69b28f", "url": "https://github.com/firebase/firebase-android-sdk/commit/24963013cb88e47112fa434db2d50b1a0e69b28f", "message": "gJF", "committedDate": "2020-04-08T22:48:45Z", "type": "commit"}]}