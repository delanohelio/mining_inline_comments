{"pr_number": 2131, "pr_title": "Add support for Application build field in CCT Transport Backend.", "pr_createdAt": "2020-11-02T23:38:30Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/2131", "timeline": [{"oid": "cdb2ef9de80b097562c47d7ccec87b5f76baff98", "url": "https://github.com/firebase/firebase-android-sdk/commit/cdb2ef9de80b097562c47d7ccec87b5f76baff98", "message": "Add transport support for Android application build field.", "committedDate": "2020-11-02T23:35:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM3MjkwNA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2131#discussion_r516372904", "bodyText": "For completeness, should we call it packageVersionCode?", "author": "visumickey", "createdAt": "2020-11-03T00:56:12Z", "path": "transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java", "diffHunk": "@@ -130,6 +133,20 @@ private static TelephonyManager getTelephonyManager(Context context) {\n     return (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);\n   }\n \n+  private static int getVersionCode(Context context) {", "originalCommit": "cdb2ef9de80b097562c47d7ccec87b5f76baff98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc1MTI1Nw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2131#discussion_r516751257", "bodyText": "Sounds good! Fixed.", "author": "jeremyjiang-dev", "createdAt": "2020-11-03T15:26:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM3MjkwNA=="}], "type": "inlineReview", "revised_code": {"commit": "1353e88e12278662db1b0e7e6be3c6ff93d1b1c0", "chunk": "diff --git a/transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java b/transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java\nindex 5a058569..8b1b5d3f 100644\n--- a/transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java\n+++ b/transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java\n\n@@ -133,7 +133,7 @@ final class CctTransportBackend implements TransportBackend {\n     return (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);\n   }\n \n-  private static int getVersionCode(Context context) {\n+  private static int getPackageVersionCode(Context context) {\n     try {\n       int packageVersionCode =\n           context\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM3MzM1NQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2131#discussion_r516373355", "bodyText": "Do you want to qualify this error a bit better? \"Unable to find version code for package - \". This would enable the developer fix quickly rather than being too abstract.", "author": "visumickey", "createdAt": "2020-11-03T00:57:07Z", "path": "transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java", "diffHunk": "@@ -130,6 +133,20 @@ private static TelephonyManager getTelephonyManager(Context context) {\n     return (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);\n   }\n \n+  private static int getVersionCode(Context context) {\n+    try {\n+      int packageVersionCode =\n+          context\n+              .getPackageManager()\n+              .getPackageInfo(context.getPackageName(), /* flags= */ 0)\n+              .versionCode;\n+      return packageVersionCode;\n+    } catch (PackageManager.NameNotFoundException e) {\n+      Logging.e(LOG_TAG, \"Couldn't find version code\", e);", "originalCommit": "cdb2ef9de80b097562c47d7ccec87b5f76baff98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc1MTIwMw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2131#discussion_r516751203", "bodyText": "Sounds good! Fixed.", "author": "jeremyjiang-dev", "createdAt": "2020-11-03T15:26:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM3MzM1NQ=="}], "type": "inlineReview", "revised_code": {"commit": "1353e88e12278662db1b0e7e6be3c6ff93d1b1c0", "chunk": "diff --git a/transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java b/transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java\nindex 5a058569..8b1b5d3f 100644\n--- a/transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java\n+++ b/transport/transport-backend-cct/src/main/java/com/google/android/datatransport/cct/CctTransportBackend.java\n\n@@ -133,7 +133,7 @@ final class CctTransportBackend implements TransportBackend {\n     return (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);\n   }\n \n-  private static int getVersionCode(Context context) {\n+  private static int getPackageVersionCode(Context context) {\n     try {\n       int packageVersionCode =\n           context\n"}}, {"oid": "1353e88e12278662db1b0e7e6be3c6ff93d1b1c0", "url": "https://github.com/firebase/firebase-android-sdk/commit/1353e88e12278662db1b0e7e6be3c6ff93d1b1c0", "message": "Incorporate comments.", "committedDate": "2020-11-03T15:25:51Z", "type": "commit"}]}