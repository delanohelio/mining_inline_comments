{"pr_number": 2216, "pr_title": "Don't crash SDK is socket.close() fails", "pr_createdAt": "2020-12-01T18:10:48Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/2216", "timeline": [{"oid": "8ebe2b4909bd17a422c853778e2924f264b94a23", "url": "https://github.com/firebase/firebase-android-sdk/commit/8ebe2b4909bd17a422c853778e2924f264b94a23", "message": "Don't crash SDK is socket.close() fails", "committedDate": "2020-12-01T18:09:42Z", "type": "commit"}, {"oid": "f0904b8c9243ba907dcc93aa4f306a4a6f450a85", "url": "https://github.com/firebase/firebase-android-sdk/commit/f0904b8c9243ba907dcc93aa4f306a4a6f450a85", "message": "Add Changelog for Query.get()", "committedDate": "2020-12-01T18:16:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzgzMzk1OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2216#discussion_r533833959", "bodyText": "catching Throwable seems a little bit aggressive as it will also catch java.lang.Errors which, according to its javadoc, \"a reasonable application should not try to catch\". Would it be sufficient to only catch Exception for example?", "author": "vkryachko", "createdAt": "2020-12-02T01:24:54Z", "path": "firebase-database/src/main/java/com/google/firebase/database/tubesock/WebSocket.java", "diffHunk": "@@ -261,8 +261,8 @@ private synchronized void closeSocket() {\n     if (socket != null) {\n       try {\n         socket.close();\n-      } catch (IOException e) {\n-        throw new RuntimeException(e);\n+      } catch (Throwable e) {", "originalCommit": "f0904b8c9243ba907dcc93aa4f306a4a6f450a85", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDI4OTkzMg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/2216#discussion_r534289932", "bodyText": "Fixed. I only mean to catch IOException and NPEs here.", "author": "schmidt-sebastian", "createdAt": "2020-12-02T16:08:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzgzMzk1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "eb4f8f8f539b69c0e9da467f3f182ef6c62416fb", "chunk": "diff --git a/firebase-database/src/main/java/com/google/firebase/database/tubesock/WebSocket.java b/firebase-database/src/main/java/com/google/firebase/database/tubesock/WebSocket.java\nindex ba26b2c9..532cfce1 100644\n--- a/firebase-database/src/main/java/com/google/firebase/database/tubesock/WebSocket.java\n+++ b/firebase-database/src/main/java/com/google/firebase/database/tubesock/WebSocket.java\n\n@@ -261,7 +261,7 @@ public class WebSocket {\n     if (socket != null) {\n       try {\n         socket.close();\n-      } catch (Throwable e) {\n+      } catch (Exception e) {\n         eventHandler.onError(new WebSocketException(\"Failed to close\", e));\n       }\n     }\n"}}, {"oid": "eb4f8f8f539b69c0e9da467f3f182ef6c62416fb", "url": "https://github.com/firebase/firebase-android-sdk/commit/eb4f8f8f539b69c0e9da467f3f182ef6c62416fb", "message": "s/Throwable/Exception", "committedDate": "2020-12-02T16:08:36Z", "type": "commit"}]}