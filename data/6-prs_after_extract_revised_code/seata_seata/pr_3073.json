{"pr_number": 3073, "pr_title": "bugfix: do not proxy connections without an xid", "pr_createdAt": "2020-08-31T06:55:22Z", "pr_url": "https://github.com/seata/seata/pull/3073", "timeline": [{"oid": "bebfe2a50510a9a483139aa3eddae034c7e7bd69", "url": "https://github.com/seata/seata/commit/bebfe2a50510a9a483139aa3eddae034c7e7bd69", "message": "Do not proxy connections without an XID", "committedDate": "2020-08-31T06:53:24Z", "type": "commit"}, {"oid": "58214fd3575243ef31155c20c122f9559d5bac35", "url": "https://github.com/seata/seata/commit/58214fd3575243ef31155c20c122f9559d5bac35", "message": "optimize the code", "committedDate": "2020-08-31T07:30:34Z", "type": "commit"}, {"oid": "2c2d88781b59e865c47d863b5708b4626df85341", "url": "https://github.com/seata/seata/commit/2c2d88781b59e865c47d863b5708b4626df85341", "message": "optimize the test case", "committedDate": "2020-08-31T07:36:57Z", "type": "commit"}, {"oid": "aa34899a018611011c45b56fb998f51e7cfa3c21", "url": "https://github.com/seata/seata/commit/aa34899a018611011c45b56fb998f51e7cfa3c21", "message": "optimize the test case", "committedDate": "2020-08-31T07:45:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU3NTIwNQ==", "url": "https://github.com/seata/seata/pull/3073#discussion_r481575205", "bodyText": "\u591a\u4f59\u7684\u7a7a\u884c", "author": "wangliang181230", "createdAt": "2020-09-02T02:43:32Z", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/xa/DataSourceProxyXA.java", "diffHunk": "@@ -56,6 +56,20 @@ public Connection getConnection(String username, String password) throws SQLExce\n     }\n \n     protected Connection getConnectionProxy(Connection connection) throws SQLException {\n+        if (!RootContext.inGlobalTransaction()) {\n+            return connection;\n+        }\n+        return getConnectionProxyXA(connection);\n+", "originalCommit": "aa34899a018611011c45b56fb998f51e7cfa3c21", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU5NTIxNg==", "url": "https://github.com/seata/seata/pull/3073#discussion_r481595216", "bodyText": "ok", "author": "a364176773", "createdAt": "2020-09-02T03:14:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU3NTIwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "eb4238e20c0e1aa0249c892bce61e039e30acb02", "chunk": "diff --git a/rm-datasource/src/main/java/io/seata/rm/datasource/xa/DataSourceProxyXA.java b/rm-datasource/src/main/java/io/seata/rm/datasource/xa/DataSourceProxyXA.java\nindex 29d33e6ad1..e87fd1016f 100644\n--- a/rm-datasource/src/main/java/io/seata/rm/datasource/xa/DataSourceProxyXA.java\n+++ b/rm-datasource/src/main/java/io/seata/rm/datasource/xa/DataSourceProxyXA.java\n\n@@ -60,7 +60,6 @@ public class DataSourceProxyXA extends AbstractDataSourceProxyXA {\n             return connection;\n         }\n         return getConnectionProxyXA(connection);\n-\n     }\n \n     @Override\n"}}, {"oid": "eb4238e20c0e1aa0249c892bce61e039e30acb02", "url": "https://github.com/seata/seata/commit/eb4238e20c0e1aa0249c892bce61e039e30acb02", "message": "optimize code", "committedDate": "2020-09-03T05:39:22Z", "type": "commit"}, {"oid": "4d8f80a259ecfcd29a72a73f1a5510ca8fcbff5e", "url": "https://github.com/seata/seata/commit/4d8f80a259ecfcd29a72a73f1a5510ca8fcbff5e", "message": "Merge branch 'develop' into 0831_2", "committedDate": "2020-09-04T07:31:35Z", "type": "commit"}, {"oid": "31d79d5aa694d5eaacd1205ec5583aef21522256", "url": "https://github.com/seata/seata/commit/31d79d5aa694d5eaacd1205ec5583aef21522256", "message": "Merge branch 'develop' into 0831_2", "committedDate": "2020-09-14T15:17:57Z", "type": "commit"}, {"oid": "69d079a04d61c662bd5452abfedd4179e1d06383", "url": "https://github.com/seata/seata/commit/69d079a04d61c662bd5452abfedd4179e1d06383", "message": "merge seata develop", "committedDate": "2020-09-15T05:32:13Z", "type": "commit"}]}