{"pr_number": 2367, "pr_title": "feature:added permission configuration support for nacos 1.2", "pr_createdAt": "2020-03-06T08:51:31Z", "pr_url": "https://github.com/seata/seata/pull/2367", "timeline": [{"oid": "392cb9eb0742171505c9a0f43a756958bd2dcf2d", "url": "https://github.com/seata/seata/commit/392cb9eb0742171505c9a0f43a756958bd2dcf2d", "message": "added permission configuration support for nacos 1.2", "committedDate": "2020-03-06T08:45:44Z", "type": "commit"}, {"oid": "e804abf19407cb0db8bff53a273092f17a6ae864", "url": "https://github.com/seata/seata/commit/e804abf19407cb0db8bff53a273092f17a6ae864", "message": "remove excess dependencies", "committedDate": "2020-03-06T08:54:07Z", "type": "commit"}, {"oid": "c5613e063e269bd47ee7d1802f004209841e3eeb", "url": "https://github.com/seata/seata/commit/c5613e063e269bd47ee7d1802f004209841e3eeb", "message": "server added nacos configuration", "committedDate": "2020-03-06T09:02:33Z", "type": "commit"}, {"oid": "8e308be09b644de4d244a9db73bcafc00f4c9b55", "url": "https://github.com/seata/seata/commit/8e308be09b644de4d244a9db73bcafc00f4c9b55", "message": "supplement", "committedDate": "2020-03-06T09:08:34Z", "type": "commit"}, {"oid": "45b2471fd1b28165883f903c55cffd77f7216f02", "url": "https://github.com/seata/seata/commit/45b2471fd1b28165883f903c55cffd77f7216f02", "message": "uniform code style", "committedDate": "2020-03-06T09:29:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM3NDM0Ng==", "url": "https://github.com/seata/seata/pull/2367#discussion_r389374346", "bodyText": "Would it be better to write like this\uff1a\nString userName = StringUtils.isNotBlank(System.getProperty(USER_NAME))\n            ? System.getProperty(USER_NAME)\n            : FILE_CONFIG.getConfig(getNacosUserName());\n        String password = StringUtils.isNotBlank(System.getProperty(PASSWORD))\n            ? System.getProperty(PASSWORD)\n            : FILE_CONFIG.getConfig(getNacosPassword());\n        if (StringUtils.isNotBlank(userName) && StringUtils.isNotBlank(password)) {\n            properties.setProperty(USER_NAME, userName);\n            properties.setProperty(PASSWORD, password);\n        }", "author": "objcoding", "createdAt": "2020-03-08T14:26:57Z", "path": "config/seata-config-nacos/src/main/java/io/seata/config/nacos/NacosConfiguration.java", "diffHunk": "@@ -191,6 +194,17 @@ private static Properties getConfigProperties() {\n             }\n             properties.setProperty(PRO_NAMESPACE_KEY, namespace);\n         }\n+        if (StringUtils.isNotBlank(System.getProperty(USER_NAME))", "originalCommit": "45b2471fd1b28165883f903c55cffd77f7216f02", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM3NTQyMQ==", "url": "https://github.com/seata/seata/pull/2367#discussion_r389375421", "bodyText": "Would it be better to write like this\uff1a\nString userName = StringUtils.isNotBlank(System.getProperty(USER_NAME))\n            ? System.getProperty(USER_NAME)\n            : FILE_CONFIG.getConfig(getNacosUserName());\n        String password = StringUtils.isNotBlank(System.getProperty(PASSWORD))\n            ? System.getProperty(PASSWORD)\n            : FILE_CONFIG.getConfig(getNacosPassword());\n        if (StringUtils.isNotBlank(userName) && StringUtils.isNotBlank(password)) {\n            properties.setProperty(USER_NAME, userName);\n            properties.setProperty(PASSWORD, password);\n        }\n\nthx,i under reference", "author": "a364176773", "createdAt": "2020-03-08T14:40:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM3NDM0Ng=="}], "type": "inlineReview", "revised_code": {"commit": "c72ea0fef327fe27754e77ddfb7e8291e6da6c31", "chunk": "diff --git a/config/seata-config-nacos/src/main/java/io/seata/config/nacos/NacosConfiguration.java b/config/seata-config-nacos/src/main/java/io/seata/config/nacos/NacosConfiguration.java\nindex 9ab72847ae..52970258d1 100644\n--- a/config/seata-config-nacos/src/main/java/io/seata/config/nacos/NacosConfiguration.java\n+++ b/config/seata-config-nacos/src/main/java/io/seata/config/nacos/NacosConfiguration.java\n\n@@ -194,15 +194,14 @@ public class NacosConfiguration extends AbstractConfiguration {\n             }\n             properties.setProperty(PRO_NAMESPACE_KEY, namespace);\n         }\n-        if (StringUtils.isNotBlank(System.getProperty(USER_NAME))\n-            && StringUtils.isNotBlank(System.getProperty(PASSWORD))) {\n-            properties.setProperty(USER_NAME, System.getProperty(USER_NAME));\n-            properties.setProperty(PASSWORD, System.getProperty(PASSWORD));\n-        } else {\n-            String userName = FILE_CONFIG.getConfig(getNacosUserName());\n-            if (StringUtils.isNotBlank(userName)) {\n+        String userName = StringUtils.isNotBlank(System.getProperty(USER_NAME)) ? System.getProperty(USER_NAME)\n+            : FILE_CONFIG.getConfig(getNacosUserName());\n+        if (StringUtils.isNotBlank(userName)) {\n+            String password = StringUtils.isNotBlank(System.getProperty(PASSWORD)) ? System.getProperty(PASSWORD)\n+                : FILE_CONFIG.getConfig(getNacosPassword());\n+            if (StringUtils.isNotBlank(password)) {\n                 properties.setProperty(USER_NAME, userName);\n-                properties.setProperty(PASSWORD, FILE_CONFIG.getConfig(getNacosPassword()));\n+                properties.setProperty(PASSWORD, password);\n             }\n         }\n         return properties;\n"}}, {"oid": "c72ea0fef327fe27754e77ddfb7e8291e6da6c31", "url": "https://github.com/seata/seata/commit/c72ea0fef327fe27754e77ddfb7e8291e6da6c31", "message": "modify code logic", "committedDate": "2020-03-08T14:45:25Z", "type": "commit"}, {"oid": "b8a9e121494116063ec0aed88c6ace469b2c4ee8", "url": "https://github.com/seata/seata/commit/b8a9e121494116063ec0aed88c6ace469b2c4ee8", "message": "nacos the registry supports authentication", "committedDate": "2020-03-08T15:27:48Z", "type": "commit"}, {"oid": "b95395653462887d9923cad9baf6b2e0ac99f8c3", "url": "https://github.com/seata/seata/commit/b95395653462887d9923cad9baf6b2e0ac99f8c3", "message": "supplement", "committedDate": "2020-03-08T15:37:17Z", "type": "commit"}, {"oid": "340639ef9a1800a9d3d53f8f34d3c46777d5c988", "url": "https://github.com/seata/seata/commit/340639ef9a1800a9d3d53f8f34d3c46777d5c988", "message": "Merge branch 'develop' into nacos1.2", "committedDate": "2020-03-10T09:43:13Z", "type": "commit"}, {"oid": "0c4fa389b6fc8c7f2ec7362781c564200e34b051", "url": "https://github.com/seata/seata/commit/0c4fa389b6fc8c7f2ec7362781c564200e34b051", "message": "Merge branch 'develop' into nacos1.2", "committedDate": "2020-03-11T12:13:52Z", "type": "commit"}, {"oid": "e0a2830e56c664c9d7a1224b6fe11daf0eae4b4c", "url": "https://github.com/seata/seata/commit/e0a2830e56c664c9d7a1224b6fe11daf0eae4b4c", "message": "Merge branch 'develop' into nacos1.2", "committedDate": "2020-03-12T07:45:00Z", "type": "commit"}, {"oid": "078af3f921affd2d53b77d580b15b593ba8dd6db", "url": "https://github.com/seata/seata/commit/078af3f921affd2d53b77d580b15b593ba8dd6db", "message": "Merge branch 'develop' into nacos1.2", "committedDate": "2020-03-15T16:12:31Z", "type": "commit"}, {"oid": "b9e37de5b3eb222e60f67b4f730d0f9f94cacbff", "url": "https://github.com/seata/seata/commit/b9e37de5b3eb222e60f67b4f730d0f9f94cacbff", "message": "Merge branch 'develop' into nacos1.2", "committedDate": "2020-03-17T05:14:34Z", "type": "commit"}, {"oid": "dd99eb31062b66015d20962d06ab2cbadc46a1b2", "url": "https://github.com/seata/seata/commit/dd99eb31062b66015d20962d06ab2cbadc46a1b2", "message": "Merge branch 'develop' into nacos1.2", "committedDate": "2020-03-18T01:22:31Z", "type": "commit"}, {"oid": "daa3fad04f38aa17e968ee52485832eb74c741d3", "url": "https://github.com/seata/seata/commit/daa3fad04f38aa17e968ee52485832eb74c741d3", "message": "Merge branch 'develop' into nacos1.2", "committedDate": "2020-03-19T01:43:26Z", "type": "commit"}, {"oid": "682997b3a8c630fb4f392b98c55e73b585662178", "url": "https://github.com/seata/seata/commit/682997b3a8c630fb4f392b98c55e73b585662178", "message": "Merge branch 'develop' into nacos1.2", "committedDate": "2020-03-19T11:14:48Z", "type": "commit"}]}