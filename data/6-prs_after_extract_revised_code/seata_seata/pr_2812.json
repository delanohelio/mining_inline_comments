{"pr_number": 2812, "pr_title": "bugfix: fix get PostgreSQL tableMeta error when using sharding JDBC", "pr_createdAt": "2020-06-18T08:01:04Z", "pr_url": "https://github.com/seata/seata/pull/2812", "timeline": [{"oid": "dc75abaca21343e088c1637dba217e7292663d0d", "url": "https://github.com/seata/seata/commit/dc75abaca21343e088c1637dba217e7292663d0d", "message": "Modify data type compatible with PostgreSQL", "committedDate": "2020-06-18T07:59:09Z", "type": "commit"}, {"oid": "b233fe6da506542ce7eaabf36cd0b356a83c85c3", "url": "https://github.com/seata/seata/commit/b233fe6da506542ce7eaabf36cd0b356a83c85c3", "message": "Modify data type compatible with PostgreSQL", "committedDate": "2020-06-18T08:07:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjYxNDQ0MQ==", "url": "https://github.com/seata/seata/pull/2812#discussion_r442614441", "bodyText": "getObject?", "author": "jsbxyyx", "createdAt": "2020-06-19T03:40:18Z", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/sql/struct/cache/PostgresqlTableMetaCache.java", "diffHunk": "@@ -137,7 +137,7 @@ private TableMeta resultSetMetaToSchema(DatabaseMetaData dbmd, String tableName)\n                 col.setColumnDef(rsColumns.getString(\"COLUMN_DEF\"));\n                 col.setSqlDataType(rsColumns.getInt(\"SQL_DATA_TYPE\"));\n                 col.setSqlDatetimeSub(rsColumns.getInt(\"SQL_DATETIME_SUB\"));\n-                col.setCharOctetLength(rsColumns.getInt(\"CHAR_OCTET_LENGTH\"));\n+                col.setCharOctetLength(rsColumns.getString(\"CHAR_OCTET_LENGTH\"));", "originalCommit": "b233fe6da506542ce7eaabf36cd0b356a83c85c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjYzMjM1NQ==", "url": "https://github.com/seata/seata/pull/2812#discussion_r442632355", "bodyText": "\u4e0e\u6d4b\u8bd5\u7528\u4f8b\u4e2d\u7684\u4ee3\u7801\u51b2\u7a81\u4e86\uff0c\u8fd8\u662f\u6539\u6210getObject\u5427\u3002", "author": "wangliang181230", "createdAt": "2020-06-19T05:04:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjYxNDQ0MQ=="}], "type": "inlineReview", "revised_code": {"commit": "ee59ba490a1949a61f44a09fc12a866e0f02f892", "chunk": "diff --git a/rm-datasource/src/main/java/io/seata/rm/datasource/sql/struct/cache/PostgresqlTableMetaCache.java b/rm-datasource/src/main/java/io/seata/rm/datasource/sql/struct/cache/PostgresqlTableMetaCache.java\nindex 0b75129ce..168fcef55 100644\n--- a/rm-datasource/src/main/java/io/seata/rm/datasource/sql/struct/cache/PostgresqlTableMetaCache.java\n+++ b/rm-datasource/src/main/java/io/seata/rm/datasource/sql/struct/cache/PostgresqlTableMetaCache.java\n\n@@ -137,7 +128,7 @@ public class PostgresqlTableMetaCache extends AbstractTableMetaCache {\n                 col.setColumnDef(rsColumns.getString(\"COLUMN_DEF\"));\n                 col.setSqlDataType(rsColumns.getInt(\"SQL_DATA_TYPE\"));\n                 col.setSqlDatetimeSub(rsColumns.getInt(\"SQL_DATETIME_SUB\"));\n-                col.setCharOctetLength(rsColumns.getString(\"CHAR_OCTET_LENGTH\"));\n+                col.setCharOctetLength(rsColumns.getObject(\"CHAR_OCTET_LENGTH\"));\n                 col.setOrdinalPosition(rsColumns.getInt(\"ORDINAL_POSITION\"));\n                 col.setIsNullAble(rsColumns.getString(\"IS_NULLABLE\"));\n                 col.setIsAutoincrement(rsColumns.getString(\"IS_AUTOINCREMENT\"));\n"}}, {"oid": "940a8654579a97fd28651b00df5a80e8293229a9", "url": "https://github.com/seata/seata/commit/940a8654579a97fd28651b00df5a80e8293229a9", "message": "Merge branch 'develop' into 1.2.0", "committedDate": "2020-06-19T03:55:59Z", "type": "commit"}, {"oid": "ee59ba490a1949a61f44a09fc12a866e0f02f892", "url": "https://github.com/seata/seata/commit/ee59ba490a1949a61f44a09fc12a866e0f02f892", "message": "Modify data type compatible with PostgreSQL", "committedDate": "2020-06-19T06:32:32Z", "type": "commit"}]}