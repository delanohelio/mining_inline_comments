{"pr_number": 2242, "pr_title": "optimize: optimize PreparedStatementProxy initialization logic", "pr_createdAt": "2020-02-12T03:02:58Z", "pr_url": "https://github.com/seata/seata/pull/2242", "timeline": [{"oid": "8454613ba69e659ff745874ccec193d0a36b146e", "url": "https://github.com/seata/seata/commit/8454613ba69e659ff745874ccec193d0a36b146e", "message": "restructure", "committedDate": "2019-11-09T03:11:47Z", "type": "commit"}, {"oid": "387b7cbb08becf632ec62633c456e7c1fc77badc", "url": "https://github.com/seata/seata/commit/387b7cbb08becf632ec62633c456e7c1fc77badc", "message": "Restructure SQLRecognizer and UndoExecutor", "committedDate": "2019-11-09T06:38:09Z", "type": "commit"}, {"oid": "472cb658328284dedb9b66d3369419428ce2616d", "url": "https://github.com/seata/seata/commit/472cb658328284dedb9b66d3369419428ce2616d", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-11-11T06:35:24Z", "type": "commit"}, {"oid": "96de7fd8499b1a8344532465b92661485b59b2e1", "url": "https://github.com/seata/seata/commit/96de7fd8499b1a8344532465b92661485b59b2e1", "message": "optimize concurrency of UndoExecutorGruopFactory and SQLRecognizerGroupFactory", "committedDate": "2019-11-11T06:37:05Z", "type": "commit"}, {"oid": "d4f090ff64ca12f4d9a47a51d8d88f70cba90804", "url": "https://github.com/seata/seata/commit/d4f090ff64ca12f4d9a47a51d8d88f70cba90804", "message": "remove @version tags", "committedDate": "2019-11-11T07:14:20Z", "type": "commit"}, {"oid": "550f6e12e528e0b891f7fa5244cfd75ad40aa9dc", "url": "https://github.com/seata/seata/commit/550f6e12e528e0b891f7fa5244cfd75ad40aa9dc", "message": "add javaDoc;optimize UndoExecutorGroupFactory and SQLOperateRecognizerGroupFactory", "committedDate": "2019-11-11T08:13:55Z", "type": "commit"}, {"oid": "b0e250e7424b5c023e29c8cb302c90257fc6865f", "url": "https://github.com/seata/seata/commit/b0e250e7424b5c023e29c8cb302c90257fc6865f", "message": "Merge branch 'develop' into develop", "committedDate": "2019-11-11T09:17:47Z", "type": "commit"}, {"oid": "d06df2e0f95590f70c50cede0e91a0769b88047a", "url": "https://github.com/seata/seata/commit/d06df2e0f95590f70c50cede0e91a0769b88047a", "message": "rename **Group to **Holder", "committedDate": "2019-11-12T01:04:52Z", "type": "commit"}, {"oid": "3d46a4660cb487c73ddfc6da7bbab5122f7cda9f", "url": "https://github.com/seata/seata/commit/3d46a4660cb487c73ddfc6da7bbab5122f7cda9f", "message": "Merge branch 'develop' of https://github.com/CharmingRabbit/seata into develop", "committedDate": "2019-11-12T01:06:40Z", "type": "commit"}, {"oid": "28322ac0b56e79b26f156d9e927371ece2799c8b", "url": "https://github.com/seata/seata/commit/28322ac0b56e79b26f156d9e927371ece2799c8b", "message": "Merge branch 'develop' into develop", "committedDate": "2019-11-12T10:07:28Z", "type": "commit"}, {"oid": "57fb2d033e654890bc34adf3f5f2a3001c7600a7", "url": "https://github.com/seata/seata/commit/57fb2d033e654890bc34adf3f5f2a3001c7600a7", "message": "remove @data", "committedDate": "2019-11-12T11:08:51Z", "type": "commit"}, {"oid": "c3ae74a5359eec9b2d6fa7051cbe22f27ec79426", "url": "https://github.com/seata/seata/commit/c3ae74a5359eec9b2d6fa7051cbe22f27ec79426", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-11-12T11:10:06Z", "type": "commit"}, {"oid": "e9a163e1535ded6ad4d93884a7e4e6d38b938423", "url": "https://github.com/seata/seata/commit/e9a163e1535ded6ad4d93884a7e4e6d38b938423", "message": "Merge branch 'develop' of https://github.com/CharmingRabbit/seata into develop", "committedDate": "2019-11-12T11:10:36Z", "type": "commit"}, {"oid": "78f456fc5e4af3f86fc117f43d6f21acd16dac86", "url": "https://github.com/seata/seata/commit/78f456fc5e4af3f86fc117f43d6f21acd16dac86", "message": "Merge branch 'develop' into develop", "committedDate": "2019-11-13T04:52:40Z", "type": "commit"}, {"oid": "8c0f5d28d0fe236ef2cb783435b2df1e28d672e1", "url": "https://github.com/seata/seata/commit/8c0f5d28d0fe236ef2cb783435b2df1e28d672e1", "message": "Merge branch 'develop' into develop", "committedDate": "2019-11-13T09:24:52Z", "type": "commit"}, {"oid": "3e9a6bdbc44384652899470b6185958fc11a69b4", "url": "https://github.com/seata/seata/commit/3e9a6bdbc44384652899470b6185958fc11a69b4", "message": "fix NPE in UndoExecutorFactory", "committedDate": "2019-11-14T01:18:52Z", "type": "commit"}, {"oid": "19ef256b49f428f07e88a4600850cccc2d900e47", "url": "https://github.com/seata/seata/commit/19ef256b49f428f07e88a4600850cccc2d900e47", "message": "restructure", "committedDate": "2019-11-14T01:21:18Z", "type": "commit"}, {"oid": "43bc2c344dd8f44ad4f60dcadcbe54a6ba4ddbb1", "url": "https://github.com/seata/seata/commit/43bc2c344dd8f44ad4f60dcadcbe54a6ba4ddbb1", "message": "Restructure SQLRecognizer and UndoExecutor", "committedDate": "2019-11-14T01:21:19Z", "type": "commit"}, {"oid": "45a275caf806f3d9aae5edd7f27fcc27f5d1b9d8", "url": "https://github.com/seata/seata/commit/45a275caf806f3d9aae5edd7f27fcc27f5d1b9d8", "message": "optimize concurrency of UndoExecutorGruopFactory and SQLRecognizerGroupFactory", "committedDate": "2019-11-14T01:21:19Z", "type": "commit"}, {"oid": "a96fe5e8e36bbd242ad44d05c767c3263a2e75be", "url": "https://github.com/seata/seata/commit/a96fe5e8e36bbd242ad44d05c767c3263a2e75be", "message": "remove @version tags", "committedDate": "2019-11-14T01:21:20Z", "type": "commit"}, {"oid": "5febb227411c5594506c9c8eb1fabf7ad7e40a0a", "url": "https://github.com/seata/seata/commit/5febb227411c5594506c9c8eb1fabf7ad7e40a0a", "message": "add javaDoc;optimize UndoExecutorGroupFactory and SQLOperateRecognizerGroupFactory", "committedDate": "2019-11-14T01:21:21Z", "type": "commit"}, {"oid": "b9a3696a94eecda0715732aff2eca04b0ec5bc8c", "url": "https://github.com/seata/seata/commit/b9a3696a94eecda0715732aff2eca04b0ec5bc8c", "message": "rename **Group to **Holder", "committedDate": "2019-11-14T01:21:21Z", "type": "commit"}, {"oid": "ca8813429e12ef93c754c05efd3c496a9acab069", "url": "https://github.com/seata/seata/commit/ca8813429e12ef93c754c05efd3c496a9acab069", "message": "remove @data", "committedDate": "2019-11-14T01:21:21Z", "type": "commit"}, {"oid": "05adb694c15ddff8379f3858afa8e821c44497f0", "url": "https://github.com/seata/seata/commit/05adb694c15ddff8379f3858afa8e821c44497f0", "message": "optimize: xid header lowercase (#1789)", "committedDate": "2019-11-14T01:21:21Z", "type": "commit"}, {"oid": "b1b05a94656883c8ad4582dffa1581426715fce7", "url": "https://github.com/seata/seata/commit/b1b05a94656883c8ad4582dffa1581426715fce7", "message": "clean: reformat saga module (#1890)", "committedDate": "2019-11-14T01:21:21Z", "type": "commit"}, {"oid": "2c5fe29ea4352dc7a01713e405ad228c4bdd52b5", "url": "https://github.com/seata/seata/commit/2c5fe29ea4352dc7a01713e405ad228c4bdd52b5", "message": "fix NPE in UndoExecutorFactory", "committedDate": "2019-11-14T01:21:21Z", "type": "commit"}, {"oid": "92bba972a2d761ca185dc256749b5194e199ffdc", "url": "https://github.com/seata/seata/commit/92bba972a2d761ca185dc256749b5194e199ffdc", "message": "Merge branch 'develop' of https://github.com/CharmingRabbit/seata into develop", "committedDate": "2019-11-14T02:54:43Z", "type": "commit"}, {"oid": "c116c9b0fb4b1e3e6cb6ff7c1ef77c2d453c8cd9", "url": "https://github.com/seata/seata/commit/c116c9b0fb4b1e3e6cb6ff7c1ef77c2d453c8cd9", "message": "merge latest code", "committedDate": "2019-11-14T12:02:14Z", "type": "commit"}, {"oid": "59fe1cf5118baed2467d3d9b5471fc9a415f96fa", "url": "https://github.com/seata/seata/commit/59fe1cf5118baed2467d3d9b5471fc9a415f96fa", "message": "bugfix:fix NPE in UndoExecutorFactory", "committedDate": "2019-11-14T12:04:39Z", "type": "commit"}, {"oid": "378e89c316845148800674914e9c740a03091178", "url": "https://github.com/seata/seata/commit/378e89c316845148800674914e9c740a03091178", "message": "local commit", "committedDate": "2019-11-21T07:16:01Z", "type": "commit"}, {"oid": "b8dcb893e02ee7d11f4692267c650a412aa4891e", "url": "https://github.com/seata/seata/commit/b8dcb893e02ee7d11f4692267c650a412aa4891e", "message": "merge remote", "committedDate": "2019-11-22T02:59:42Z", "type": "commit"}, {"oid": "9755622cb16b6014a7a8ed8a2ecb1c0e23551a65", "url": "https://github.com/seata/seata/commit/9755622cb16b6014a7a8ed8a2ecb1c0e23551a65", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-11-22T02:59:54Z", "type": "commit"}, {"oid": "ade3c8529a29485631b6f639d29fb255a52cb24a", "url": "https://github.com/seata/seata/commit/ade3c8529a29485631b6f639d29fb255a52cb24a", "message": "bugfix:A bug that will appear when the default constructor is declared private", "committedDate": "2019-11-22T03:03:21Z", "type": "commit"}, {"oid": "c0867c6aac833153e6eeddef3b3929a5fd3fc162", "url": "https://github.com/seata/seata/commit/c0867c6aac833153e6eeddef3b3929a5fd3fc162", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-11-22T08:51:55Z", "type": "commit"}, {"oid": "9fc4f5eacf38028b5bddbe726dfaff86159110f9", "url": "https://github.com/seata/seata/commit/9fc4f5eacf38028b5bddbe726dfaff86159110f9", "message": "code", "committedDate": "2019-11-22T08:53:44Z", "type": "commit"}, {"oid": "dbf102fa9528b7cc8e6b2b40182520f589392731", "url": "https://github.com/seata/seata/commit/dbf102fa9528b7cc8e6b2b40182520f589392731", "message": "Merge branch 'develop' into develop", "committedDate": "2019-11-23T09:00:46Z", "type": "commit"}, {"oid": "ea397a7bf89d48a98a29385e5a3836edad7bdf5f", "url": "https://github.com/seata/seata/commit/ea397a7bf89d48a98a29385e5a3836edad7bdf5f", "message": "Merge branch 'develop' into develop", "committedDate": "2019-11-24T07:24:40Z", "type": "commit"}, {"oid": "3f4dd2bed800b7291fb6bbe69b82fd86340a6a85", "url": "https://github.com/seata/seata/commit/3f4dd2bed800b7291fb6bbe69b82fd86340a6a85", "message": "Merge branch 'develop' into develop", "committedDate": "2019-11-29T03:44:56Z", "type": "commit"}, {"oid": "028a80d963f9393724256bd6bcb0b54429b94404", "url": "https://github.com/seata/seata/commit/028a80d963f9393724256bd6bcb0b54429b94404", "message": "Merge branch 'develop' into develop", "committedDate": "2019-11-29T13:10:28Z", "type": "commit"}, {"oid": "e1968bb425a2ce25123fff1de6165f596e876be8", "url": "https://github.com/seata/seata/commit/e1968bb425a2ce25123fff1de6165f596e876be8", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-12-02T07:34:12Z", "type": "commit"}, {"oid": "fd36c51a528ee06691ca976f0c44f0fa4b0f25b7", "url": "https://github.com/seata/seata/commit/fd36c51a528ee06691ca976f0c44f0fa4b0f25b7", "message": "Merge branch 'develop' of https://github.com/CharmingRabbit/seata into develop", "committedDate": "2019-12-02T07:34:45Z", "type": "commit"}, {"oid": "f01d15f86cb359c5fe59826b7572352548afd378", "url": "https://github.com/seata/seata/commit/f01d15f86cb359c5fe59826b7572352548afd378", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-12-05T11:26:23Z", "type": "commit"}, {"oid": "c9aa49b922a67e8257b420166e2a1da724cd3eb0", "url": "https://github.com/seata/seata/commit/c9aa49b922a67e8257b420166e2a1da724cd3eb0", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-12-17T07:57:43Z", "type": "commit"}, {"oid": "f195d869e57125771712dc79439fb61241bfd3b4", "url": "https://github.com/seata/seata/commit/f195d869e57125771712dc79439fb61241bfd3b4", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-12-30T00:55:57Z", "type": "commit"}, {"oid": "c3399fff0c4bfd65b79afae3c8a55a66560f7410", "url": "https://github.com/seata/seata/commit/c3399fff0c4bfd65b79afae3c8a55a66560f7410", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2020-01-04T06:59:02Z", "type": "commit"}, {"oid": "ac3a43e717e5601dc658016db28f4b40a60b35cb", "url": "https://github.com/seata/seata/commit/ac3a43e717e5601dc658016db28f4b40a60b35cb", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2020-01-17T00:57:17Z", "type": "commit"}, {"oid": "7c5fbdfeeec3905e9faf378d64ded71783021ab8", "url": "https://github.com/seata/seata/commit/7c5fbdfeeec3905e9faf378d64ded71783021ab8", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2020-02-10T09:04:42Z", "type": "commit"}, {"oid": "b41d9f1c3920d3eeeee746e4ebf43ab4e99e24ed", "url": "https://github.com/seata/seata/commit/b41d9f1c3920d3eeeee746e4ebf43ab4e99e24ed", "message": "Merge remote-tracking branch 'upstream/develop' into f_parameters", "committedDate": "2020-02-11T07:12:43Z", "type": "commit"}, {"oid": "5eef46b9ca605b46c74e9cb574024df9105ae02b", "url": "https://github.com/seata/seata/commit/5eef46b9ca605b46c74e9cb574024df9105ae02b", "message": "optimize: optimize PreparedStatementProxy initialization logic", "committedDate": "2020-02-12T02:48:32Z", "type": "commit"}, {"oid": "4272645971da0acadbb7d0e8ebd2eede272fc162", "url": "https://github.com/seata/seata/commit/4272645971da0acadbb7d0e8ebd2eede272fc162", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-02-12T09:33:56Z", "type": "commit"}, {"oid": "b0be6a4f3caa85efc0c3db138129bedf9b5ac577", "url": "https://github.com/seata/seata/commit/b0be6a4f3caa85efc0c3db138129bedf9b5ac577", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-02-20T15:05:08Z", "type": "commit"}, {"oid": "05cf5c4896b97be0e8f58cfa4fcd3ff440b1343d", "url": "https://github.com/seata/seata/commit/05cf5c4896b97be0e8f58cfa4fcd3ff440b1343d", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-02-22T08:10:21Z", "type": "commit"}, {"oid": "d678cf8ce76024a928d074d34185e79566d6cadf", "url": "https://github.com/seata/seata/commit/d678cf8ce76024a928d074d34185e79566d6cadf", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-02-28T16:57:45Z", "type": "commit"}, {"oid": "7ebbedcae1dcd3953a1636541e2718d364c8c657", "url": "https://github.com/seata/seata/commit/7ebbedcae1dcd3953a1636541e2718d364c8c657", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-03-05T01:09:29Z", "type": "commit"}, {"oid": "39319068a3f8e44b91edb4e3fbb7fa567a693f42", "url": "https://github.com/seata/seata/commit/39319068a3f8e44b91edb4e3fbb7fa567a693f42", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-03-06T12:58:05Z", "type": "commit"}, {"oid": "9aff40a6b4a1649b6ca33bebc42e401ac7137934", "url": "https://github.com/seata/seata/commit/9aff40a6b4a1649b6ca33bebc42e401ac7137934", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-03-15T16:11:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg5MDEwNg==", "url": "https://github.com/seata/seata/pull/2242#discussion_r394890106", "bodyText": "I think we should use a dynamic array instead of HashMap, because only random access capability is needed.", "author": "ggndnn", "createdAt": "2020-03-19T09:25:50Z", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/AbstractPreparedStatementProxy.java", "diffHunk": "@@ -49,14 +51,10 @@\n     /**\n      * The Parameters.\n      */\n-    protected ArrayList<Object>[] parameters;\n+    protected Map<Integer,ArrayList<Object>> parameters;", "originalCommit": "9aff40a6b4a1649b6ca33bebc42e401ac7137934", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg5MDg5MA==", "url": "https://github.com/seata/seata/pull/2242#discussion_r394890890", "bodyText": "What's the purpose of op --? It looks inconsistent with method getParamsByIndex .", "author": "ggndnn", "createdAt": "2020-03-19T09:27:09Z", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/AbstractPreparedStatementProxy.java", "diffHunk": "@@ -103,7 +101,10 @@ public AbstractPreparedStatementProxy(AbstractConnectionProxy connectionProxy, P\n      * @param x     the x\n      */\n     protected void setParamByIndex(int index, Object x) {\n-        parameters[--index].add(x);\n+        if (!parameters.containsKey(--index)) {", "originalCommit": "9aff40a6b4a1649b6ca33bebc42e401ac7137934", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk0MjE5Nw==", "url": "https://github.com/seata/seata/pull/2242#discussion_r394942197", "bodyText": "The base class method of set()  will pass param from 1,and we should ensure that it is taken from 0, so we handle the index with --.", "author": "booogu", "createdAt": "2020-03-19T10:56:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg5MDg5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTU2NzkzMg==", "url": "https://github.com/seata/seata/pull/2242#discussion_r395567932", "bodyText": "We should keep the index parameter of setParamByIndex and getParamByIndex the same meaning.", "author": "ggndnn", "createdAt": "2020-03-20T11:08:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg5MDg5MA=="}], "type": "inlineReview", "revised_code": {"commit": "6d7da987508c139dc8d5f4709f15cf1e594fb421", "chunk": "diff --git a/rm-datasource/src/main/java/io/seata/rm/datasource/AbstractPreparedStatementProxy.java b/rm-datasource/src/main/java/io/seata/rm/datasource/AbstractPreparedStatementProxy.java\nindex 07c9bdd98..93792ef8c 100644\n--- a/rm-datasource/src/main/java/io/seata/rm/datasource/AbstractPreparedStatementProxy.java\n+++ b/rm-datasource/src/main/java/io/seata/rm/datasource/AbstractPreparedStatementProxy.java\n\n@@ -101,10 +101,7 @@ public abstract class AbstractPreparedStatementProxy extends StatementProxy<Prep\n      * @param x     the x\n      */\n     protected void setParamByIndex(int index, Object x) {\n-        if (!parameters.containsKey(--index)) {\n-            parameters.put(index, new ArrayList<>());\n-        }\n-        parameters.get(index).add(x);\n+        parameters.computeIfAbsent(index,e -> new ArrayList<>()).add(x);\n     }\n \n     @Override\n"}}, {"oid": "530940f7df3ad0ebbefb8e3a62aef4ba9f787fb8", "url": "https://github.com/seata/seata/commit/530940f7df3ad0ebbefb8e3a62aef4ba9f787fb8", "message": "Merge remote-tracking branch 'upstream/develop' into f_parameters", "committedDate": "2020-03-23T07:16:17Z", "type": "commit"}, {"oid": "6d7da987508c139dc8d5f4709f15cf1e594fb421", "url": "https://github.com/seata/seata/commit/6d7da987508c139dc8d5f4709f15cf1e594fb421", "message": "make get() and set() in AbsPreparedStmtProxy has the same meaning", "committedDate": "2020-03-24T05:41:31Z", "type": "commit"}, {"oid": "92c00900223385921da828e782a8636572a4c0df", "url": "https://github.com/seata/seata/commit/92c00900223385921da828e782a8636572a4c0df", "message": "Merge remote-tracking branch 'upstream/develop' into f_parameters", "committedDate": "2020-03-24T05:42:03Z", "type": "commit"}, {"oid": "04b9bef84926f063f970b3923a412e594132990d", "url": "https://github.com/seata/seata/commit/04b9bef84926f063f970b3923a412e594132990d", "message": "Merge remote-tracking branch 'upstream/develop' into f_parameters", "committedDate": "2020-03-25T00:42:24Z", "type": "commit"}, {"oid": "2a4a0f24aafcde1bd82e048dec447f67c9315f5e", "url": "https://github.com/seata/seata/commit/2a4a0f24aafcde1bd82e048dec447f67c9315f5e", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-04-10T03:41:19Z", "type": "commit"}, {"oid": "d8afec660b3aee3a65e9b3931fa851ce1196558e", "url": "https://github.com/seata/seata/commit/d8afec660b3aee3a65e9b3931fa851ce1196558e", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-04-10T13:31:44Z", "type": "commit"}, {"oid": "2271663002fc3406fa96480647ccc1e9981be888", "url": "https://github.com/seata/seata/commit/2271663002fc3406fa96480647ccc1e9981be888", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-04-23T15:29:56Z", "type": "commit"}, {"oid": "ca2eca31bce273c9d18751024152ca69b234da05", "url": "https://github.com/seata/seata/commit/ca2eca31bce273c9d18751024152ca69b234da05", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-05-09T04:18:49Z", "type": "commit"}, {"oid": "022a9112b7cd41cb4ed0f5103f371fd8b9397b36", "url": "https://github.com/seata/seata/commit/022a9112b7cd41cb4ed0f5103f371fd8b9397b36", "message": "resolve conflicts", "committedDate": "2020-06-30T08:02:32Z", "type": "commit"}, {"oid": "c3f06625d68d1e0b7acdcaf13a54974a57d6744b", "url": "https://github.com/seata/seata/commit/c3f06625d68d1e0b7acdcaf13a54974a57d6744b", "message": "adjust unitTests to the new parameters data structure", "committedDate": "2020-06-30T08:52:04Z", "type": "commit"}, {"oid": "2d6f8fefe9757646fdac5e43acc4c536da5b1f6a", "url": "https://github.com/seata/seata/commit/2d6f8fefe9757646fdac5e43acc4c536da5b1f6a", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-06-30T09:20:09Z", "type": "commit"}, {"oid": "b0b05c19aa9e6536d136784a23578c945d824ce2", "url": "https://github.com/seata/seata/commit/b0b05c19aa9e6536d136784a23578c945d824ce2", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-06-30T10:17:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODI0NzM1OQ==", "url": "https://github.com/seata/seata/pull/2242#discussion_r448247359", "bodyText": "if  need index+1 ?", "author": "slievrly", "createdAt": "2020-07-01T09:46:36Z", "path": "sqlparser/seata-sqlparser-druid/src/main/java/io/seata/sqlparser/druid/oracle/BaseOracleRecognizer.java", "diffHunk": "@@ -50,7 +50,7 @@ public OracleOutputVisitor createOutputVisitor(final ParametersHolder parameters\n             @Override\n             public boolean visit(SQLVariantRefExpr x) {\n                 if (\"?\".equals(x.getName())) {\n-                    ArrayList<Object> oneParamValues = parametersHolder.getParameters()[x.getIndex()];\n+                    ArrayList<Object> oneParamValues = parametersHolder.getParameters().get(x.getIndex());", "originalCommit": "b0b05c19aa9e6536d136784a23578c945d824ce2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODI2NDg0MQ==", "url": "https://github.com/seata/seata/pull/2242#discussion_r448264841", "bodyText": "Yeah, my fault.", "author": "booogu", "createdAt": "2020-07-01T10:18:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODI0NzM1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODY4Nzg1NA==", "url": "https://github.com/seata/seata/pull/2242#discussion_r448687854", "bodyText": "Corrected\uff0cplease take a look.", "author": "booogu", "createdAt": "2020-07-02T00:46:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODI0NzM1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "bbbcf9f3a786218566299f4f34d1c9c850d26e3d", "chunk": "diff --git a/sqlparser/seata-sqlparser-druid/src/main/java/io/seata/sqlparser/druid/oracle/BaseOracleRecognizer.java b/sqlparser/seata-sqlparser-druid/src/main/java/io/seata/sqlparser/druid/oracle/BaseOracleRecognizer.java\nindex ccad9451d..0be85bce0 100644\n--- a/sqlparser/seata-sqlparser-druid/src/main/java/io/seata/sqlparser/druid/oracle/BaseOracleRecognizer.java\n+++ b/sqlparser/seata-sqlparser-druid/src/main/java/io/seata/sqlparser/druid/oracle/BaseOracleRecognizer.java\n\n@@ -50,7 +48,7 @@ public abstract class BaseOracleRecognizer extends BaseRecognizer {\n             @Override\n             public boolean visit(SQLVariantRefExpr x) {\n                 if (\"?\".equals(x.getName())) {\n-                    ArrayList<Object> oneParamValues = parametersHolder.getParameters().get(x.getIndex());\n+                    ArrayList<Object> oneParamValues = parametersHolder.getParameters().get(x.getIndex() + 1);\n                     if (paramAppenderList.isEmpty()) {\n                         oneParamValues.forEach(t -> paramAppenderList.add(new ArrayList<>()));\n                     }\n"}}, {"oid": "626ccdb8e0ecdbd8f53c42043a646b3980676131", "url": "https://github.com/seata/seata/commit/626ccdb8e0ecdbd8f53c42043a646b3980676131", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-07-01T09:46:49Z", "type": "commit"}, {"oid": "bbbcf9f3a786218566299f4f34d1c9c850d26e3d", "url": "https://github.com/seata/seata/commit/bbbcf9f3a786218566299f4f34d1c9c850d26e3d", "message": "fix getParamByIndex in BaseDBRecognizer", "committedDate": "2020-07-01T12:33:32Z", "type": "commit"}, {"oid": "bee5400d3be346dcce0653d30530422c6999e20a", "url": "https://github.com/seata/seata/commit/bee5400d3be346dcce0653d30530422c6999e20a", "message": "code format and adjust test cases", "committedDate": "2020-07-01T13:12:07Z", "type": "commit"}, {"oid": "17cec1014ba332fa3886b5907d7f4e52baa4c454", "url": "https://github.com/seata/seata/commit/17cec1014ba332fa3886b5907d7f4e52baa4c454", "message": "Merge branch 'develop' into f_parameters", "committedDate": "2020-07-02T10:06:56Z", "type": "commit"}, {"oid": "b3b2ede8860867a9b4c490926c7bebbd16c380ab", "url": "https://github.com/seata/seata/commit/b3b2ede8860867a9b4c490926c7bebbd16c380ab", "message": "resolve conflicts with the feature multiPK", "committedDate": "2020-07-03T06:40:18Z", "type": "commit"}]}