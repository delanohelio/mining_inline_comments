{"pr_number": 2777, "pr_title": "bugfix: fix can't rollback when set rollback retry count was zero.", "pr_createdAt": "2020-06-08T03:52:32Z", "pr_url": "https://github.com/seata/seata/pull/2777", "timeline": [{"oid": "db0f50a497b4ce48dd691008773b0942519d589c", "url": "https://github.com/seata/seata/commit/db0f50a497b4ce48dd691008773b0942519d589c", "message": "fix could not rollback when set rollback retry count was zero.", "committedDate": "2020-06-08T03:51:39Z", "type": "commit"}, {"oid": "60d95ee3b4bbc4881cb7dafc819c7a4901013575", "url": "https://github.com/seata/seata/commit/60d95ee3b4bbc4881cb7dafc819c7a4901013575", "message": "Merge branch 'develop' into fix_rollback_retry_count_zero", "committedDate": "2020-06-08T04:20:51Z", "type": "commit"}, {"oid": "ee25aa5f4d5f3162fd423c18a56db86b1533088c", "url": "https://github.com/seata/seata/commit/ee25aa5f4d5f3162fd423c18a56db86b1533088c", "message": "fix could not commit when set commit retry count was zero.", "committedDate": "2020-06-08T06:06:50Z", "type": "commit"}, {"oid": "581fb806b6e3467de80812aaf3fdf28b3547270a", "url": "https://github.com/seata/seata/commit/581fb806b6e3467de80812aaf3fdf28b3547270a", "message": "Merge remote-tracking branch 'me/fix_rollback_retry_count_zero' into fix_rollback_retry_count_zero", "committedDate": "2020-06-08T06:07:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ3ODIzMQ==", "url": "https://github.com/seata/seata/pull/2777#discussion_r436478231", "bodyText": "Is it better to use the default value when <=0?", "author": "slievrly", "createdAt": "2020-06-08T06:23:09Z", "path": "tm/src/main/java/io/seata/tm/api/DefaultGlobalTransaction.java", "diffHunk": "@@ -120,7 +120,7 @@ public void commit() throws TransactionException {\n             return;\n         }\n         assertXIDNotNull();\n-        int retry = COMMIT_RETRY_COUNT;\n+        int retry = COMMIT_RETRY_COUNT <= 0 ? 1 : COMMIT_RETRY_COUNT;;", "originalCommit": "581fb806b6e3467de80812aaf3fdf28b3547270a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ3OTQ1NQ==", "url": "https://github.com/seata/seata/pull/2777#discussion_r436479455", "bodyText": "fixed.", "author": "l81893521", "createdAt": "2020-06-08T06:26:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ3ODIzMQ=="}], "type": "inlineReview", "revised_code": {"commit": "951854f9206fde694b5ad4eaa70402b46e370678", "chunk": "diff --git a/tm/src/main/java/io/seata/tm/api/DefaultGlobalTransaction.java b/tm/src/main/java/io/seata/tm/api/DefaultGlobalTransaction.java\nindex d944ea71..2f08330e 100644\n--- a/tm/src/main/java/io/seata/tm/api/DefaultGlobalTransaction.java\n+++ b/tm/src/main/java/io/seata/tm/api/DefaultGlobalTransaction.java\n\n@@ -120,7 +120,7 @@ public class DefaultGlobalTransaction implements GlobalTransaction {\n             return;\n         }\n         assertXIDNotNull();\n-        int retry = COMMIT_RETRY_COUNT <= 0 ? 1 : COMMIT_RETRY_COUNT;;\n+        int retry = COMMIT_RETRY_COUNT <= 0 ? DEFAULT_TM_COMMIT_RETRY_COUNT : COMMIT_RETRY_COUNT;;\n         try {\n             while (retry > 0) {\n                 try {\n"}}, {"oid": "a9efaa652d666ed741350c7c2879138c9bf646e0", "url": "https://github.com/seata/seata/commit/a9efaa652d666ed741350c7c2879138c9bf646e0", "message": "Merge branch 'develop' into fix_rollback_retry_count_zero", "committedDate": "2020-06-08T06:23:22Z", "type": "commit"}, {"oid": "951854f9206fde694b5ad4eaa70402b46e370678", "url": "https://github.com/seata/seata/commit/951854f9206fde694b5ad4eaa70402b46e370678", "message": "fix issue", "committedDate": "2020-06-08T06:25:52Z", "type": "commit"}, {"oid": "a1a87f814cb3c33d31a1cada03ff1dccb214581e", "url": "https://github.com/seata/seata/commit/a1a87f814cb3c33d31a1cada03ff1dccb214581e", "message": "Merge remote-tracking branch 'me/fix_rollback_retry_count_zero' into fix_rollback_retry_count_zero", "committedDate": "2020-06-08T06:26:08Z", "type": "commit"}, {"oid": "06c93114404b1fa1545f36afa7db54cac511d29a", "url": "https://github.com/seata/seata/commit/06c93114404b1fa1545f36afa7db54cac511d29a", "message": "fix ci.", "committedDate": "2020-06-08T07:25:34Z", "type": "commit"}, {"oid": "6ff8f7ebbcd16e19c6df2d21e8e08ba7158e84ef", "url": "https://github.com/seata/seata/commit/6ff8f7ebbcd16e19c6df2d21e8e08ba7158e84ef", "message": "disable unit test", "committedDate": "2020-06-08T08:10:50Z", "type": "commit"}]}