{"pr_number": 3841, "pr_title": "Fix for #3287", "pr_createdAt": "2020-10-28T17:38:12Z", "pr_url": "https://github.com/typetools/checker-framework/pull/3841", "timeline": [{"oid": "1c36335ce1bd3039a89d628516f036ffe4b32448", "url": "https://github.com/typetools/checker-framework/commit/1c36335ce1bd3039a89d628516f036ffe4b32448", "message": "add test reproducing typetools/checker-framework#3287 and some variants", "committedDate": "2020-06-03T01:17:41Z", "type": "commit"}, {"oid": "ec82c45de325a1086b1228453c27dce17eaf402f", "url": "https://github.com/typetools/checker-framework/commit/ec82c45de325a1086b1228453c27dce17eaf402f", "message": "fix test for typetools/checker-framework#3287 to require errors, not warnings", "committedDate": "2020-06-03T01:59:11Z", "type": "commit"}, {"oid": "0a6afb48a58212a9ecf4fde3e2690dca9add1b08", "url": "https://github.com/typetools/checker-framework/commit/0a6afb48a58212a9ecf4fde3e2690dca9add1b08", "message": "update test for typetools/checker-framework#3287 to check for an additional manifestation", "committedDate": "2020-06-03T15:27:14Z", "type": "commit"}, {"oid": "6d0bedae3072693af589526b939467dbd891c9c2", "url": "https://github.com/typetools/checker-framework/commit/6d0bedae3072693af589526b939467dbd891c9c2", "message": "partial fix, broke what should have been dead code", "committedDate": "2020-10-06T00:07:23Z", "type": "commit"}, {"oid": "82a4311e98208087373a8b728bb09e5f60c7b62c", "url": "https://github.com/typetools/checker-framework/commit/82a4311e98208087373a8b728bb09e5f60c7b62c", "message": "Likely fix for typetools/checker-framework#3287.\n\nCleaned up the override checking code significantly, offloading some work to existing utility methods in the process.", "committedDate": "2020-10-27T18:38:39Z", "type": "commit"}, {"oid": "23c6458b9e45b301b655e618157f88108c1b8745", "url": "https://github.com/typetools/checker-framework/commit/23c6458b9e45b301b655e618157f88108c1b8745", "message": "Merge branch 'master' of github.com:typetools/checker-framework into master\n\nMerge upstream into fix for typetools/checker-framework#3287", "committedDate": "2020-10-27T18:59:15Z", "type": "commit"}, {"oid": "30f45a4ca21661e5a6e5f06c70867499e21275a5", "url": "https://github.com/typetools/checker-framework/commit/30f45a4ca21661e5a6e5f06c70867499e21275a5", "message": "Remove variable that is now unused", "committedDate": "2020-10-27T19:23:51Z", "type": "commit"}, {"oid": "033fc652bedb2787f1dfa3c36594e7f6d2b94a90", "url": "https://github.com/typetools/checker-framework/commit/033fc652bedb2787f1dfa3c36594e7f6d2b94a90", "message": "better document the usage of GuiEffectTypeFactory#findInheritedEffectRange", "committedDate": "2020-10-28T18:07:51Z", "type": "commit"}, {"oid": "534747c54a3128e0ba19e5a59c7f580c8bae6f2e", "url": "https://github.com/typetools/checker-framework/commit/534747c54a3128e0ba19e5a59c7f580c8bae6f2e", "message": "Document why nested class is not static", "committedDate": "2020-10-29T21:30:59Z", "type": "commit"}, {"oid": "4100cd3dff80d3174e93b53704abceb1ddf0b5a4", "url": "https://github.com/typetools/checker-framework/commit/4100cd3dff80d3174e93b53704abceb1ddf0b5a4", "message": "Merge ../checker-framework-branch-master", "committedDate": "2020-10-30T00:45:09Z", "type": "commit"}, {"oid": "321d8d36080d5f8ce268ee4182949061510bb701", "url": "https://github.com/typetools/checker-framework/commit/321d8d36080d5f8ce268ee4182949061510bb701", "message": "Merge branch 'master' of github.com:typetools/checker-framework", "committedDate": "2020-10-30T03:14:14Z", "type": "commit"}, {"oid": "a29903a52b1843d730fdf727a4039ecbdcf12184", "url": "https://github.com/typetools/checker-framework/commit/a29903a52b1843d730fdf727a4039ecbdcf12184", "message": "Punctuation in comments", "committedDate": "2020-10-30T03:20:06Z", "type": "commit"}, {"oid": "981d25194621856266b8d59bc50e406e4d3fcd9b", "url": "https://github.com/typetools/checker-framework/commit/981d25194621856266b8d59bc50e406e4d3fcd9b", "message": "Merge ../checker-framework-branch-master", "committedDate": "2020-10-30T03:23:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDc3MTkyMA==", "url": "https://github.com/typetools/checker-framework/pull/3841#discussion_r514771920", "bodyText": "Should \"inheriting from\" be \"overriding\"?", "author": "mernst", "createdAt": "2020-10-30T03:22:03Z", "path": "checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java", "diffHunk": "@@ -548,7 +519,7 @@ public AnnotatedTypeMirror getAnnotatedType(Tree tree) {\n         // We don't need to issue warnings for inheriting from poly and a concrete effect.", "originalCommit": "a29903a52b1843d730fdf727a4039ecbdcf12184", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzYwOTU3MQ==", "url": "https://github.com/typetools/checker-framework/pull/3841#discussion_r517609571", "bodyText": "I've fixed this bit.", "author": "csgordon", "createdAt": "2020-11-04T20:23:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDc3MTkyMA=="}], "type": "inlineReview", "revised_code": {"commit": "45445bfdaca1dda2451105f6f8958aa42da6aef0", "chunk": "diff --git a/checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java b/checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java\nindex 4a568c0831..c8d1043711 100644\n--- a/checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java\n+++ b/checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java\n\n@@ -509,15 +509,15 @@ public class GuiEffectTypeFactory extends BaseAnnotatedTypeFactory {\n                                 \"override.effect.invalid.nonui\",\n                                 overridingMethod,\n                                 declaringType,\n-                                polyOverride,\n+                                polyOverriden,\n                                 overriddenType);\n                     }\n                 }\n             }\n         }\n \n-        // We don't need to issue warnings for inheriting from poly and a concrete effect.\n-        if (uiOverride != null && safeOverride != null && issueConflictWarning) {\n+        // We don't need to issue warnings for overriding both poly and a concrete effect.\n+        if (uiOverriden != null && safeOverriden != null && issueConflictWarning) {\n             // There may be more than two parent methods, but for now it's\n             // enough to know there are at least 2 in conflict.\n             checker.reportWarning(\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDc3MjAwNw==", "url": "https://github.com/typetools/checker-framework/pull/3841#discussion_r514772007", "bodyText": "As a minor comment, I think the above 3 variables would be better named *Overridden rather than *Override, since they contain a method of the given effect that is overridden.", "author": "mernst", "createdAt": "2020-10-30T03:22:10Z", "path": "checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java", "diffHunk": "@@ -420,126 +441,76 @@ public AnnotatedTypeMirror getAnnotatedType(Tree tree) {\n         ExecutableElement polyOverride = null;", "originalCommit": "a29903a52b1843d730fdf727a4039ecbdcf12184", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzYwOTcxNg==", "url": "https://github.com/typetools/checker-framework/pull/3841#discussion_r517609716", "bodyText": "Good suggestions, I've renamed them.", "author": "csgordon", "createdAt": "2020-11-04T20:23:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDc3MjAwNw=="}], "type": "inlineReview", "revised_code": {"commit": "45445bfdaca1dda2451105f6f8958aa42da6aef0", "chunk": "diff --git a/checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java b/checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java\nindex 4a568c0831..c8d1043711 100644\n--- a/checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java\n+++ b/checker/src/main/java/org/checkerframework/checker/guieffect/GuiEffectTypeFactory.java\n\n@@ -436,9 +436,9 @@ public class GuiEffectTypeFactory extends BaseAnnotatedTypeFactory {\n             boolean issueConflictWarning,\n             Tree errorNode) {\n         assert (declaringType != null);\n-        ExecutableElement uiOverride = null;\n-        ExecutableElement safeOverride = null;\n-        ExecutableElement polyOverride = null;\n+        ExecutableElement uiOverriden = null;\n+        ExecutableElement safeOverriden = null;\n+        ExecutableElement polyOverriden = null;\n \n         // We must account for explicit annotation, type declaration annotations, and package\n         // annotations.\n"}}, {"oid": "45445bfdaca1dda2451105f6f8958aa42da6aef0", "url": "https://github.com/typetools/checker-framework/commit/45445bfdaca1dda2451105f6f8958aa42da6aef0", "message": "address some minor style feedback from Mike", "committedDate": "2020-11-04T20:15:03Z", "type": "commit"}]}