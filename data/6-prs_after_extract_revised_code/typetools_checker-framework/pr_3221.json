{"pr_number": 3221, "pr_title": "Ignore getting classpath from SystemClassLoader on Java 9+", "pr_createdAt": "2020-04-01T17:40:53Z", "pr_url": "https://github.com/typetools/checker-framework/pull/3221", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxNjQxMg==", "url": "https://github.com/typetools/checker-framework/pull/3221#discussion_r402416412", "bodyText": "As this code is building a diagnostic message, you should try to make it fail more gracefully.\nHow about moving this into the then part and adding an else part that mentions that Java 9+ is used?\nThe comment explaining the TODO should then move into the else part.", "author": "wmdietl", "createdAt": "2020-04-02T15:44:59Z", "path": "framework/src/main/java/org/checkerframework/framework/source/SourceChecker.java", "diffHunk": "@@ -2367,9 +2367,15 @@ private void logBugInCF(BugInCF ce) {\n             if (printClasspath) {\n                 msg.add(\"Classpath:\");", "originalCommit": "c050b70843c23fb22701a4f17efe0e5b610531cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzgxNzI5Ng==", "url": "https://github.com/typetools/checker-framework/pull/3221#discussion_r403817296", "bodyText": "feedback addressed", "author": "zcai1", "createdAt": "2020-04-06T03:56:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxNjQxMg=="}], "type": "inlineReview", "revised_code": {"commit": "b33cecfc8d654283e31e04f842141208018ea7ff", "chunk": "diff --git a/framework/src/main/java/org/checkerframework/framework/source/SourceChecker.java b/framework/src/main/java/org/checkerframework/framework/source/SourceChecker.java\nindex 511318034c..566d43d5b5 100644\n--- a/framework/src/main/java/org/checkerframework/framework/source/SourceChecker.java\n+++ b/framework/src/main/java/org/checkerframework/framework/source/SourceChecker.java\n\n@@ -2365,17 +2365,21 @@ public abstract class SourceChecker extends AbstractTypeProcessor\n             }\n \n             if (printClasspath) {\n-                msg.add(\"Classpath:\");\n                 ClassLoader cl = ClassLoader.getSystemClassLoader();\n \n-                // TODO: Java 9+ use an internal classloader that doesn't support getting URLs,\n-                //       so we will need an alternative approach to retrieve the classpath on\n-                //       Java 9+\n                 if (cl instanceof URLClassLoader) {\n+                    msg.add(\"Classpath:\");\n                     URL[] urls = ((URLClassLoader) cl).getURLs();\n                     for (URL url : urls) {\n                         msg.add(url.getFile());\n                     }\n+                } else {\n+                    // TODO: Java 9+ use an internal classloader that doesn't support getting URLs,\n+                    //       so we will need an alternative approach to retrieve the classpath on\n+                    //       Java 9+\n+                    msg.add(\n+                            \"Printing classpath is currently unavailable on Java 9+. Please \"\n+                                    + \"try using Java 8 if this information is very important.\");\n                 }\n             }\n         }\n"}}, {"oid": "b33cecfc8d654283e31e04f842141208018ea7ff", "url": "https://github.com/typetools/checker-framework/commit/b33cecfc8d654283e31e04f842141208018ea7ff", "message": "Ignore getting classpath from SystemClassLoader on Java 9+", "committedDate": "2020-04-06T03:55:29Z", "type": "commit"}, {"oid": "b33cecfc8d654283e31e04f842141208018ea7ff", "url": "https://github.com/typetools/checker-framework/commit/b33cecfc8d654283e31e04f842141208018ea7ff", "message": "Ignore getting classpath from SystemClassLoader on Java 9+", "committedDate": "2020-04-06T03:55:29Z", "type": "forcePushed"}, {"oid": "3d856f8d41db0e12a66884fa7d23305685a10cb3", "url": "https://github.com/typetools/checker-framework/commit/3d856f8d41db0e12a66884fa7d23305685a10cb3", "message": "Tweak message and comments", "committedDate": "2020-04-06T14:51:40Z", "type": "commit"}, {"oid": "51afbc0f62958d45fd2a619ae09f7458ab855dfa", "url": "https://github.com/typetools/checker-framework/commit/51afbc0f62958d45fd2a619ae09f7458ab855dfa", "message": "Merge ../checker-framework-fork-zcai1-branch-ignore-getting-classpath-from-SystemClassLoader-on-java-9+ into zcai1-ignore-getting-classpath-from-SystemClassLoader-on-java-9", "committedDate": "2020-04-06T14:53:54Z", "type": "commit"}, {"oid": "4fc61788da4700eb79485f270c93b8bc8abfffc6", "url": "https://github.com/typetools/checker-framework/commit/4fc61788da4700eb79485f270c93b8bc8abfffc6", "message": "Merge pull request #1 from mernst/zcai1-ignore-getting-classpath-from-SystemClassLoader-on-java-9\n\nUpdate message and comment", "committedDate": "2020-04-06T15:31:09Z", "type": "commit"}]}