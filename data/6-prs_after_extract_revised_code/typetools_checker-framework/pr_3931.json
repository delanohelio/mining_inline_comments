{"pr_number": 3931, "pr_title": "When building a type tree, don't recur infinitely on wildcards", "pr_createdAt": "2020-11-24T21:39:03Z", "pr_url": "https://github.com/typetools/checker-framework/pull/3931", "timeline": [{"oid": "6c60423aa3212e313b1eeff76f2ccf1aa8446dcd", "url": "https://github.com/typetools/checker-framework/commit/6c60423aa3212e313b1eeff76f2ccf1aa8446dcd", "message": "Don't recur infinitely on wildcards.", "committedDate": "2020-11-24T20:20:30Z", "type": "commit"}, {"oid": "7fcb88a3758345de5f8c42950a56eb28419bf6d1", "url": "https://github.com/typetools/checker-framework/commit/7fcb88a3758345de5f8c42950a56eb28419bf6d1", "message": "Add another testcase.", "committedDate": "2020-11-24T20:32:14Z", "type": "commit"}, {"oid": "f4814382ad671200ec4af345cd3319ae30ac6e8e", "url": "https://github.com/typetools/checker-framework/commit/f4814382ad671200ec4af345cd3319ae30ac6e8e", "message": "Merge remote-tracking branch 'origin/master' into issue3929", "committedDate": "2020-11-24T20:34:41Z", "type": "commit"}, {"oid": "a7a4081b0b06b28c08fbe3f5731cc0d5d9468d22", "url": "https://github.com/typetools/checker-framework/commit/a7a4081b0b06b28c08fbe3f5731cc0d5d9468d22", "message": "Merge remote-tracking branch 'origin/master' into issue3929", "committedDate": "2020-11-24T22:06:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTkzMTMxNA==", "url": "https://github.com/typetools/checker-framework/pull/3931#discussion_r529931314", "bodyText": "The field could be final.", "author": "wmdietl", "createdAt": "2020-11-24T22:18:23Z", "path": "framework/src/main/java/org/checkerframework/framework/flow/CFTreeBuilder.java", "diffHunk": "@@ -33,6 +34,17 @@\n  */\n public class CFTreeBuilder extends TreeBuilder {\n \n+    /**\n+     * To avoid infinite recursions, record each wildcard that has been converted to a tree. This\n+     * set is cleared each time {@link #buildAnnotatedType(AnnotatedTypeMirror)} is called.\n+     */\n+    private Set<AnnotatedWildcardType> visitedWildcards = new HashSet<>();", "originalCommit": "a7a4081b0b06b28c08fbe3f5731cc0d5d9468d22", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f6d0fbdb1ca1e5efe8f49aed5646eb4028e6c1f8", "chunk": "diff --git a/framework/src/main/java/org/checkerframework/framework/flow/CFTreeBuilder.java b/framework/src/main/java/org/checkerframework/framework/flow/CFTreeBuilder.java\nindex 98853d13a6..b6f7ab2f9f 100644\n--- a/framework/src/main/java/org/checkerframework/framework/flow/CFTreeBuilder.java\n+++ b/framework/src/main/java/org/checkerframework/framework/flow/CFTreeBuilder.java\n\n@@ -38,7 +38,7 @@ public class CFTreeBuilder extends TreeBuilder {\n      * To avoid infinite recursions, record each wildcard that has been converted to a tree. This\n      * set is cleared each time {@link #buildAnnotatedType(AnnotatedTypeMirror)} is called.\n      */\n-    private Set<AnnotatedWildcardType> visitedWildcards = new HashSet<>();\n+    private final Set<AnnotatedWildcardType> visitedWildcards = new HashSet<>();\n \n     /**\n      * Creates a {@code CFTreeBuilder}.\n"}}, {"oid": "f6d0fbdb1ca1e5efe8f49aed5646eb4028e6c1f8", "url": "https://github.com/typetools/checker-framework/commit/f6d0fbdb1ca1e5efe8f49aed5646eb4028e6c1f8", "message": "Make final.", "committedDate": "2020-11-24T22:28:48Z", "type": "commit"}]}