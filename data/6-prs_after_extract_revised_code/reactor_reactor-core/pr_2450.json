{"pr_number": 2450, "pr_title": "Fix groupBy initial request off by one", "pr_createdAt": "2020-10-20T10:31:48Z", "pr_url": "https://github.com/reactor/reactor-core/pull/2450", "timeline": [{"oid": "c40e3598ff07c12d7d1a0311e386b8aff5526644", "url": "https://github.com/reactor/reactor-core/commit/c40e3598ff07c12d7d1a0311e386b8aff5526644", "message": "fixes GroupBy overflow issue\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-10-20T10:46:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQ0Mzg0Ng==", "url": "https://github.com/reactor/reactor-core/pull/2450#discussion_r508443846", "bodyText": "should isFirstRequest be volatile? it seems it is updated in two different places that could be run on different threads", "author": "simonbasle", "createdAt": "2020-10-20T12:05:24Z", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxGroupBy.java", "diffHunk": "@@ -751,7 +761,16 @@ void tryReplenish() {\n \t\t\t\tproduced = 0;\n \t\t\t\tGroupByMain<?, K, V> main = parent;\n \t\t\t\tif (main != null) {\n-\t\t\t\t\tmain.s.request(p);\n+\t\t\t\t\tif (this.isFirstRequest) {", "originalCommit": "c40e3598ff07c12d7d1a0311e386b8aff5526644", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQ1MTkwMQ==", "url": "https://github.com/reactor/reactor-core/pull/2450#discussion_r508451901", "bodyText": "should isFirstRequest be volatile? it seems it is updated in two different places that could be run on different threads\n\nIt should not be volatile since it is done in 2 different path. One within drain Regular, another if there is fusi\u00f3n.\nThat said, there is no contention on modifying this field", "author": "OlegDokuka", "createdAt": "2020-10-20T12:18:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQ0Mzg0Ng=="}], "type": "inlineReview", "revised_code": null}, {"oid": "8b0c1d85ce004380ee00c07d237ae896a643b317", "url": "https://github.com/reactor/reactor-core/commit/8b0c1d85ce004380ee00c07d237ae896a643b317", "message": "fixes GroupBy overflow issue\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-12-09T13:09:41Z", "type": "commit"}, {"oid": "5ba8625f9fa3ed100b35de57258c2aaa6b7b51ee", "url": "https://github.com/reactor/reactor-core/commit/5ba8625f9fa3ed100b35de57258c2aaa6b7b51ee", "message": "adds tests\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-12-09T13:09:42Z", "type": "commit"}, {"oid": "5ba8625f9fa3ed100b35de57258c2aaa6b7b51ee", "url": "https://github.com/reactor/reactor-core/commit/5ba8625f9fa3ed100b35de57258c2aaa6b7b51ee", "message": "adds tests\n\nSigned-off-by: Oleh Dokuka <shadowgun@i.ua>", "committedDate": "2020-12-09T13:09:42Z", "type": "forcePushed"}]}