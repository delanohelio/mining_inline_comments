{"pr_number": 4187, "pr_title": "Fix block status of repair point and battery", "pr_createdAt": "2020-12-30T17:33:39Z", "pr_url": "https://github.com/Anuken/Mindustry/pull/4187", "timeline": [{"oid": "b2670fd70507cacbc8db07c8c155f4444ee91cd1", "url": "https://github.com/Anuken/Mindustry/commit/b2670fd70507cacbc8db07c8c155f4444ee91cd1", "message": "Fix block status of repair point and battery", "committedDate": "2020-12-30T17:31:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDI3OTM2OA==", "url": "https://github.com/Anuken/Mindustry/pull/4187#discussion_r550279368", "bodyText": "Use Mathf.equals() with a range; comparing floats directly is a bad idea.", "author": "Anuken", "createdAt": "2020-12-30T18:01:33Z", "path": "core/src/mindustry/world/blocks/power/Battery.java", "diffHunk": "@@ -42,5 +42,12 @@ public void overwrote(Seq<Building> previous){\n                 }\n             }\n         }\n+\n+        @Override\n+        public BlockStatus status(){\n+            if(power.status == 0f) return BlockStatus.noInput;", "originalCommit": "b2670fd70507cacbc8db07c8c155f4444ee91cd1", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "283ee09b8e7de71efe0515d3dc4a50c5949edbf6", "chunk": "diff --git a/core/src/mindustry/world/blocks/power/Battery.java b/core/src/mindustry/world/blocks/power/Battery.java\nindex 16e3786b3..9ed13ebc4 100644\n--- a/core/src/mindustry/world/blocks/power/Battery.java\n+++ b/core/src/mindustry/world/blocks/power/Battery.java\n\n@@ -45,8 +45,8 @@ public class Battery extends PowerDistributor{\n \n         @Override\n         public BlockStatus status(){\n-            if(power.status == 0f) return BlockStatus.noInput;\n-            if(power.status == 1f) return BlockStatus.active;\n+            if(Mathf.equal(power.status, 0f, 0.01f)) return BlockStatus.noInput;\n+            if(Mathf.equal(power.status, 1f, 0.01f)) return BlockStatus.active;\n             return BlockStatus.noOutput;\n         }\n     }\n"}}, {"oid": "283ee09b8e7de71efe0515d3dc4a50c5949edbf6", "url": "https://github.com/Anuken/Mindustry/commit/283ee09b8e7de71efe0515d3dc4a50c5949edbf6", "message": "Update Battery.java", "committedDate": "2020-12-30T18:07:19Z", "type": "commit"}, {"oid": "0678a8d573e7f16b82567eda2c20661075e93bae", "url": "https://github.com/Anuken/Mindustry/commit/0678a8d573e7f16b82567eda2c20661075e93bae", "message": "Update RepairPoint.java", "committedDate": "2020-12-30T18:08:08Z", "type": "commit"}]}