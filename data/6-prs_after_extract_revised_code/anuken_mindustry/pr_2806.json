{"pr_number": 2806, "pr_title": "Incendiary Bullets Make Fires When Hitting Tiles", "pr_createdAt": "2020-10-03T01:19:03Z", "pr_url": "https://github.com/Anuken/Mindustry/pull/2806", "timeline": [{"oid": "d2bc2b07a9bd90a690c4008855976884bb89efb3", "url": "https://github.com/Anuken/Mindustry/commit/d2bc2b07a9bd90a690c4008855976884bb89efb3", "message": "the statud effect burning affects tiles", "committedDate": "2020-08-02T20:31:16Z", "type": "commit"}, {"oid": "e17ad7a4292cd86d80caaa64617121c12c841e56", "url": "https://github.com/Anuken/Mindustry/commit/e17ad7a4292cd86d80caaa64617121c12c841e56", "message": "Merge remote-tracking branch 'upstream/master' into burning-affects-tiles", "committedDate": "2020-10-03T00:47:11Z", "type": "commit"}, {"oid": "88639fffc5f5b1cadaf5367f25c2086e9c1138d3", "url": "https://github.com/Anuken/Mindustry/commit/88639fffc5f5b1cadaf5367f25c2086e9c1138d3", "message": "fix", "committedDate": "2020-10-03T01:17:51Z", "type": "commit"}, {"oid": "39e956c934261d8d2ec6a0aa015807c9fe9c3fb4", "url": "https://github.com/Anuken/Mindustry/commit/39e956c934261d8d2ec6a0aa015807c9fe9c3fb4", "message": "Update BulletType.java", "committedDate": "2020-10-03T01:26:17Z", "type": "commit"}, {"oid": "5aa0ce97b82aeac34cd01dd41331e8ebb9e278b4", "url": "https://github.com/Anuken/Mindustry/commit/5aa0ce97b82aeac34cd01dd41331e8ebb9e278b4", "message": "fix", "committedDate": "2020-10-03T01:27:33Z", "type": "commit"}, {"oid": "ca70b9c705fc9fd32fa0d3e7ef5ec30b5fe8947d", "url": "https://github.com/Anuken/Mindustry/commit/ca70b9c705fc9fd32fa0d3e7ef5ec30b5fe8947d", "message": "fix\n\n(again)", "committedDate": "2020-10-03T01:28:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEwNDY5NA==", "url": "https://github.com/Anuken/Mindustry/pull/2806#discussion_r499104694", "bodyText": "This should create exactly one Fire; createIncend may create multiple in a range, and that's not desirable here, especially considering damage can be 0 but splash damage can be >0.", "author": "Anuken", "createdAt": "2020-10-03T01:44:35Z", "path": "core/src/mindustry/entities/bullet/BulletType.java", "diffHunk": "@@ -144,6 +144,9 @@ public boolean collides(Bullet bullet, Building tile){\n     }\n \n     public void hitTile(Bullet b, Building tile, float initialHealth){\n+        if(status == StatusEffects.burning) {\n+            Damage.createIncend(b.x, b.y, damage / 10f, (int)damage / 10);", "originalCommit": "ca70b9c705fc9fd32fa0d3e7ef5ec30b5fe8947d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEwODIwNw==", "url": "https://github.com/Anuken/Mindustry/pull/2806#discussion_r499108207", "bodyText": "I changed it to Fires.create();", "author": "genNAowl", "createdAt": "2020-10-03T02:33:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEwNDY5NA=="}], "type": "inlineReview", "revised_code": {"commit": "74c0d0d0fdbc2947171004047e39050b296658fa", "chunk": "diff --git a/core/src/mindustry/entities/bullet/BulletType.java b/core/src/mindustry/entities/bullet/BulletType.java\nindex 814fb489e..a4d287862 100644\n--- a/core/src/mindustry/entities/bullet/BulletType.java\n+++ b/core/src/mindustry/entities/bullet/BulletType.java\n\n@@ -145,7 +145,10 @@ public abstract class BulletType extends Content{\n \n     public void hitTile(Bullet b, Building tile, float initialHealth){\n         if(status == StatusEffects.burning) {\n-            Damage.createIncend(b.x, b.y, damage / 10f, (int)damage / 10);\n+            Tile buildTile = world.tileWorld(tile.x, tile.y);\n+            if(buildTile != null){\n+                Fires.create(buildTile);\n+            }\n         }\n         hit(b);\n     }\n"}}, {"oid": "74c0d0d0fdbc2947171004047e39050b296658fa", "url": "https://github.com/Anuken/Mindustry/commit/74c0d0d0fdbc2947171004047e39050b296658fa", "message": "Update BulletType.java", "committedDate": "2020-10-03T02:33:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEwODk3Mg==", "url": "https://github.com/Anuken/Mindustry/pull/2806#discussion_r499108972", "bodyText": "this can't be null, because other isn't null: use other.tile", "author": "Anuken", "createdAt": "2020-10-03T02:46:17Z", "path": "core/src/mindustry/entities/bullet/BulletType.java", "diffHunk": "@@ -192,7 +195,10 @@ public void hit(Bullet b, float x, float y){\n \n             if(status == StatusEffects.burning) {\n                 indexer.eachBlock(null, x, y, splashDamageRadius, other -> other.team != b.team, other -> {\n-                    Damage.createIncend(x, y, damage / 10f, (int)damage / 10);\n+                    Tile tile = world.tileWorld(other.x, other.y);", "originalCommit": "74c0d0d0fdbc2947171004047e39050b296658fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEwOTA4OA==", "url": "https://github.com/Anuken/Mindustry/pull/2806#discussion_r499109088", "bodyText": "changed it to Fires.create(other.tile);", "author": "genNAowl", "createdAt": "2020-10-03T02:48:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEwODk3Mg=="}], "type": "inlineReview", "revised_code": {"commit": "e53a1d04725c56ab5d3cbe9402431c8d87562bcb", "chunk": "diff --git a/core/src/mindustry/entities/bullet/BulletType.java b/core/src/mindustry/entities/bullet/BulletType.java\nindex a4d287862..a828f5723 100644\n--- a/core/src/mindustry/entities/bullet/BulletType.java\n+++ b/core/src/mindustry/entities/bullet/BulletType.java\n\n@@ -195,10 +195,7 @@ public abstract class BulletType extends Content{\n \n             if(status == StatusEffects.burning) {\n                 indexer.eachBlock(null, x, y, splashDamageRadius, other -> other.team != b.team, other -> {\n-                    Tile tile = world.tileWorld(other.x, other.y);\n-                    if(tile != null){\n-                        Fires.create(tile);\n-                    }\n+                    Fires.create(other.tile);\n                 });\n             }\n         }\n"}}, {"oid": "e53a1d04725c56ab5d3cbe9402431c8d87562bcb", "url": "https://github.com/Anuken/Mindustry/commit/e53a1d04725c56ab5d3cbe9402431c8d87562bcb", "message": "Update BulletType.java", "committedDate": "2020-10-03T02:47:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEwOTgyNg==", "url": "https://github.com/Anuken/Mindustry/pull/2806#discussion_r499109826", "bodyText": "...same here, tile can't be null, so use tile.tile", "author": "Anuken", "createdAt": "2020-10-03T03:00:04Z", "path": "core/src/mindustry/entities/bullet/BulletType.java", "diffHunk": "@@ -144,6 +144,12 @@ public boolean collides(Bullet bullet, Building tile){\n     }\n \n     public void hitTile(Bullet b, Building tile, float initialHealth){\n+        if(status == StatusEffects.burning) {\n+            Tile buildTile = world.tileWorld(tile.x, tile.y);", "originalCommit": "e53a1d04725c56ab5d3cbe9402431c8d87562bcb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTExNDczOQ==", "url": "https://github.com/Anuken/Mindustry/pull/2806#discussion_r499114739", "bodyText": "Changed to Fires.create(tile.tile);", "author": "genNAowl", "createdAt": "2020-10-03T04:25:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEwOTgyNg=="}], "type": "inlineReview", "revised_code": {"commit": "60d50481406e3a2d1f203b8dc7a6737dfb0ca32f", "chunk": "diff --git a/core/src/mindustry/entities/bullet/BulletType.java b/core/src/mindustry/entities/bullet/BulletType.java\nindex a828f5723..870a79034 100644\n--- a/core/src/mindustry/entities/bullet/BulletType.java\n+++ b/core/src/mindustry/entities/bullet/BulletType.java\n\n@@ -145,10 +145,7 @@ public abstract class BulletType extends Content{\n \n     public void hitTile(Bullet b, Building tile, float initialHealth){\n         if(status == StatusEffects.burning) {\n-            Tile buildTile = world.tileWorld(tile.x, tile.y);\n-            if(buildTile != null){\n-                Fires.create(buildTile);\n-            }\n+            Fires.create(tile.tile);\n         }\n         hit(b);\n     }\n"}}, {"oid": "60d50481406e3a2d1f203b8dc7a6737dfb0ca32f", "url": "https://github.com/Anuken/Mindustry/commit/60d50481406e3a2d1f203b8dc7a6737dfb0ca32f", "message": "Update BulletType.java", "committedDate": "2020-10-03T04:25:05Z", "type": "commit"}]}