{"pr_number": 3653, "pr_title": "[#3652] attempt to fix NPE", "pr_createdAt": "2020-10-13T17:27:44Z", "pr_url": "https://github.com/akvo/akvo-flow/pull/3653", "timeline": [{"oid": "757155a918a44db85ec5f64a844cc6527decfec5", "url": "https://github.com/akvo/akvo-flow/commit/757155a918a44db85ec5f64a844cc6527decfec5", "message": "[#3652] attempt to fix NPE\n\nCo-authored-by: Iv\u00e1n Perdomo <ivan@akvo.org>", "committedDate": "2020-10-13T17:26:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2OTEwMg==", "url": "https://github.com/akvo/akvo-flow/pull/3653#discussion_r504169102", "bodyText": "There are lots of changes to import style and order that are not directly to the change business logic change we want.", "author": "iperdomo", "createdAt": "2020-10-13T18:25:22Z", "path": "GAE/src/org/akvo/flow/api/app/DataPointUtil.java", "diffHunk": "@@ -35,10 +33,18 @@\n import org.waterforpeople.mapping.domain.SurveyInstance;\n import org.waterforpeople.mapping.serialization.response.MediaResponse;\n \n-import com.gallatinsystems.survey.dao.QuestionDao;\n-import com.gallatinsystems.survey.domain.Question;\n-import com.gallatinsystems.surveyal.domain.SurveyedLocale;\n import javax.annotation.Nullable;\n+import java.util.ArrayList;", "originalCommit": "757155a918a44db85ec5f64a844cc6527decfec5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0NzYzNw==", "url": "https://github.com/akvo/akvo-flow/pull/3653#discussion_r504447637", "bodyText": "the IDE does this, we need a common code style for all IDEs so this does not happen", "author": "valllllll2000", "createdAt": "2020-10-14T07:06:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2OTEwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ1MDgyNA==", "url": "https://github.com/akvo/akvo-flow/pull/3653#discussion_r504450824", "bodyText": "it does it with you reformat the whole file. We had a common style defined for Eclipse but not for IntelliJ IDEA", "author": "iperdomo", "createdAt": "2020-10-14T07:12:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2OTEwMg=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2OTQ0Mg==", "url": "https://github.com/akvo/akvo-flow/pull/3653#discussion_r504169442", "bodyText": "IDEM. Import re-ordering, not directly related to business logic changes.", "author": "iperdomo", "createdAt": "2020-10-13T18:25:57Z", "path": "GAE/src/org/waterforpeople/mapping/dao/SurveyInstanceDAO.java", "diffHunk": "@@ -67,6 +44,26 @@\n import com.google.appengine.api.taskqueue.Queue;\n import com.google.appengine.api.taskqueue.QueueFactory;\n import com.google.appengine.api.taskqueue.TaskOptions;\n+import org.akvo.flow.domain.DataUtils;", "originalCommit": "757155a918a44db85ec5f64a844cc6527decfec5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE3MDU5OA==", "url": "https://github.com/akvo/akvo-flow/pull/3653#discussion_r504170598", "bodyText": "We're changing the logic and introduce a corner case. We should add a test in SurveyInstanceDAOTest", "author": "iperdomo", "createdAt": "2020-10-13T18:28:07Z", "path": "GAE/src/org/waterforpeople/mapping/dao/SurveyInstanceDAO.java", "diffHunk": "@@ -774,13 +771,14 @@ public SurveyInstance getRegistrationSurveyInstance(SurveyedLocale locale,\n     public List<SurveyInstance> getMonitoringData(@Nonnull List<SurveyedLocale> surveyedLocales, int numberOfInstances) {\n         List<SurveyInstance> result = new ArrayList<>();\n \n-        surveyedLocales.forEach(surveyedLocale ->\n-                result.add(getRegistrationSurveyInstance(surveyedLocale, surveyedLocale.getCreationSurveyId())));\n-\n-        surveyedLocales.forEach(surveyedLocale ->\n+        for (SurveyedLocale s: surveyedLocales) {", "originalCommit": "757155a918a44db85ec5f64a844cc6527decfec5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "52a274ffa49f6536e10e7677452c9281cbb8fdac", "url": "https://github.com/akvo/akvo-flow/commit/52a274ffa49f6536e10e7677452c9281cbb8fdac", "message": "[#3652] Adds test for data points with no registration form instance", "committedDate": "2020-10-14T05:16:21Z", "type": "commit"}]}