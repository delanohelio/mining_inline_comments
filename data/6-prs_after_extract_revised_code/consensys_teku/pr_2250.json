{"pr_number": 2250, "pr_title": "Avoid reprocessing the last stored deposit block on startup", "pr_createdAt": "2020-06-29T03:40:41Z", "pr_url": "https://github.com/ConsenSys/teku/pull/2250", "timeline": [{"oid": "f2d434a14b291c09bdb3a567af9f0b6f7439169a", "url": "https://github.com/ConsenSys/teku/commit/f2d434a14b291c09bdb3a567af9f0b6f7439169a", "message": "Avoid reprocessing the last stored deposit block on startup", "committedDate": "2020-06-29T03:33:54Z", "type": "commit"}, {"oid": "eb32f03a777e4caac92346e9ae897c6bf8823d89", "url": "https://github.com/ConsenSys/teku/commit/eb32f03a777e4caac92346e9ae897c6bf8823d89", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into fix-duplicate-deposits", "committedDate": "2020-06-29T03:48:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjgwNDEzNw==", "url": "https://github.com/ConsenSys/teku/pull/2250#discussion_r446804137", "bodyText": "nit: should use constant since its defined", "author": "rolfyone", "createdAt": "2020-06-29T06:42:43Z", "path": "storage/src/main/java/tech/pegasys/teku/storage/server/DepositStorage.java", "diffHunk": "@@ -104,14 +98,14 @@ public void onMinGenesisTimeBlock(final MinGenesisTimeBlockEvent event) {\n     private final Eth1EventsChannel eth1EventsChannel;\n     private final Optional<MinGenesisTimeBlockEvent> genesis;\n     private boolean isGenesisDone;\n-    private UnsignedLong lastDeposit;\n+    private BigInteger lastDeposit;\n \n     public DepositSequencer(\n         final Eth1EventsChannel eventChannel, final Optional<MinGenesisTimeBlockEvent> genesis) {\n       this.eth1EventsChannel = eventChannel;\n       this.genesis = genesis;\n       this.isGenesisDone = false;\n-      this.lastDeposit = UnsignedLong.ZERO;\n+      this.lastDeposit = BigInteger.valueOf(-1);", "originalCommit": "eb32f03a777e4caac92346e9ae897c6bf8823d89", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cf70922a95ace5c458c2b70789c2404bdb45f737", "chunk": "diff --git a/storage/src/main/java/tech/pegasys/teku/storage/server/DepositStorage.java b/storage/src/main/java/tech/pegasys/teku/storage/server/DepositStorage.java\nindex da6a6083f1..27b342eb3e 100644\n--- a/storage/src/main/java/tech/pegasys/teku/storage/server/DepositStorage.java\n+++ b/storage/src/main/java/tech/pegasys/teku/storage/server/DepositStorage.java\n\n@@ -105,7 +105,7 @@ public class DepositStorage implements Eth1DepositStorageChannel, Eth1EventsChan\n       this.eth1EventsChannel = eventChannel;\n       this.genesis = genesis;\n       this.isGenesisDone = false;\n-      this.lastDeposit = BigInteger.valueOf(-1);\n+      this.lastDeposit = NEGATIVE_ONE;\n     }\n \n     public void depositEvent(final DepositsFromBlockEvent event) {\n"}}, {"oid": "cf70922a95ace5c458c2b70789c2404bdb45f737", "url": "https://github.com/ConsenSys/teku/commit/cf70922a95ace5c458c2b70789c2404bdb45f737", "message": "Use constant.", "committedDate": "2020-06-29T07:37:16Z", "type": "commit"}, {"oid": "6a178a7cf8c23060ecb5bf6d5a607749ce75bdfb", "url": "https://github.com/ConsenSys/teku/commit/6a178a7cf8c23060ecb5bf6d5a607749ce75bdfb", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into fix-duplicate-deposits", "committedDate": "2020-06-29T07:37:23Z", "type": "commit"}]}