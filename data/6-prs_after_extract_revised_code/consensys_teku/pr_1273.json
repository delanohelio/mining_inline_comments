{"pr_number": 1273, "pr_title": "Add custom serialization for CommitteeAssignments.", "pr_createdAt": "2020-03-04T02:10:20Z", "pr_url": "https://github.com/ConsenSys/teku/pull/1273", "timeline": [{"oid": "ad2ef74fb9ba319ac4941887a428d6f0672ef44d", "url": "https://github.com/ConsenSys/teku/commit/ad2ef74fb9ba319ac4941887a428d6f0672ef44d", "message": "Add custom serialization for CommitteeAssignments.\n\nStubbed object definition for Jackson to understand the structure of the returned object.", "committedDate": "2020-03-04T02:08:49Z", "type": "commit"}, {"oid": "df9242ff91ed201efbdddf93c66d3538fd54c24b", "url": "https://github.com/ConsenSys/teku/commit/df9242ff91ed201efbdddf93c66d3538fd54c24b", "message": "Merge remote-tracking branch 'upstream/master' into committee-response-standardise", "committedDate": "2020-03-04T02:15:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQyNDc2NQ==", "url": "https://github.com/ConsenSys/teku/pull/1273#discussion_r387424765", "bodyText": "I'm assuming this can be deleted if we go the CommitteeAssignmentSerializer route.", "author": "ajsutton", "createdAt": "2020-03-04T02:59:37Z", "path": "data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/schema/CommitteesResponse.java", "diffHunk": "@@ -13,13 +13,25 @@\n \n package tech.pegasys.artemis.beaconrestapi.schema;\n \n+import com.google.common.primitives.UnsignedLong;\n import java.util.List;\n-import tech.pegasys.artemis.datastructures.state.CommitteeAssignment;\n \n public class CommitteesResponse {\n   public final List<CommitteeAssignment> committeeAssignments;\n \n   public CommitteesResponse(List<CommitteeAssignment> committeeAssignments) {\n     this.committeeAssignments = committeeAssignments;\n   }\n+\n+  public static class CommitteeAssignment {", "originalCommit": "df9242ff91ed201efbdddf93c66d3538fd54c24b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQyOTQ0OA==", "url": "https://github.com/ConsenSys/teku/pull/1273#discussion_r387429448", "bodyText": "this is to get the JacksonSerializer to 'see' what the object structure is... without it, its reporting on the real object...\ni guess more correctly, it's so openApi knows about the structure...", "author": "rolfyone", "createdAt": "2020-03-04T03:20:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQyNDc2NQ=="}], "type": "inlineReview", "revised_code": {"commit": "d0e6be194ba25180984ffab1cf2733071257e81e", "chunk": "diff --git a/data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/schema/CommitteesResponse.java b/data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/schema/CommitteesResponse.java\nindex f346b2650..ebe47f310 100644\n--- a/data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/schema/CommitteesResponse.java\n+++ b/data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/schema/CommitteesResponse.java\n\n@@ -13,25 +13,15 @@\n \n package tech.pegasys.artemis.beaconrestapi.schema;\n \n-import com.google.common.primitives.UnsignedLong;\n import java.util.List;\n+import java.util.stream.Collectors;\n \n public class CommitteesResponse {\n   public final List<CommitteeAssignment> committeeAssignments;\n \n-  public CommitteesResponse(List<CommitteeAssignment> committeeAssignments) {\n-    this.committeeAssignments = committeeAssignments;\n-  }\n-\n-  public static class CommitteeAssignment {\n-    public final UnsignedLong slot;\n-    public final UnsignedLong index;\n-    public final List<Integer> committee;\n-\n-    public CommitteeAssignment(UnsignedLong slot, UnsignedLong index, List<Integer> committee) {\n-      this.slot = slot;\n-      this.index = index;\n-      this.committee = committee;\n-    }\n+  public CommitteesResponse(\n+      List<tech.pegasys.artemis.datastructures.state.CommitteeAssignment> committeeAssignments) {\n+    this.committeeAssignments =\n+        committeeAssignments.stream().map(CommitteeAssignment::new).collect(Collectors.toList());\n   }\n }\n"}}, {"oid": "d0e6be194ba25180984ffab1cf2733071257e81e", "url": "https://github.com/ConsenSys/teku/commit/d0e6be194ba25180984ffab1cf2733071257e81e", "message": "changes from review feedback.", "committedDate": "2020-03-04T04:17:41Z", "type": "commit"}, {"oid": "f0951375529aa207c2234a17a829f4bd875c4186", "url": "https://github.com/ConsenSys/teku/commit/f0951375529aa207c2234a17a829f4bd875c4186", "message": "changes from review feedback.", "committedDate": "2020-03-04T07:39:40Z", "type": "commit"}, {"oid": "b0d921c53db7fcd31b318a03f2597a4c7d381120", "url": "https://github.com/ConsenSys/teku/commit/b0d921c53db7fcd31b318a03f2597a4c7d381120", "message": "Merge remote-tracking branch 'upstream/master' into committee-response-standardise", "committedDate": "2020-03-04T20:39:16Z", "type": "commit"}, {"oid": "b43a4e241cd7c504e5985de64d0398f33387f4eb", "url": "https://github.com/ConsenSys/teku/commit/b43a4e241cd7c504e5985de64d0398f33387f4eb", "message": "Merge remote-tracking branch 'upstream/master' into committee-response-standardise", "committedDate": "2020-03-04T20:53:33Z", "type": "commit"}, {"oid": "fca56cb753e49b5f804b259cbc640119b5a0c257", "url": "https://github.com/ConsenSys/teku/commit/fca56cb753e49b5f804b259cbc640119b5a0c257", "message": "Merge remote-tracking branch 'upstream/master' into committee-response-standardise", "committedDate": "2020-03-04T21:04:34Z", "type": "commit"}]}