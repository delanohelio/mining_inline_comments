{"pr_number": 2971, "pr_title": "Update config and reference tests to v1.0.0-rc.0 + Reject BLS infinity pubkeys and signatures", "pr_createdAt": "2020-10-14T18:16:17Z", "pr_url": "https://github.com/ConsenSys/teku/pull/2971", "timeline": [{"oid": "9e53aea8422a05e442f65874757d078d8c2f43f9", "url": "https://github.com/ConsenSys/teku/commit/9e53aea8422a05e442f65874757d078d8c2f43f9", "message": "Apply new config for 1.0.0-rc.0", "committedDate": "2020-10-12T22:33:44Z", "type": "commit"}, {"oid": "45c683f66726e34170c7cac81ca7048b1aad9c26", "url": "https://github.com/ConsenSys/teku/commit/45c683f66726e34170c7cac81ca7048b1aad9c26", "message": "Apply the right version of config.", "committedDate": "2020-10-12T22:54:05Z", "type": "commit"}, {"oid": "c52e42272d649e3cf1ca4fbc298e2cba9e9f3798", "url": "https://github.com/ConsenSys/teku/commit/c52e42272d649e3cf1ca4fbc298e2cba9e9f3798", "message": "No really, the phase 0 constants from 1.0.0-rc.0", "committedDate": "2020-10-12T22:56:20Z", "type": "commit"}, {"oid": "81b9ade17f63ee57a45045f26e8f2b138b34ec1f", "url": "https://github.com/ConsenSys/teku/commit/81b9ade17f63ee57a45045f26e8f2b138b34ec1f", "message": "Update expected length bounds.  New constants allow beacon state to be larger.", "committedDate": "2020-10-12T23:07:11Z", "type": "commit"}, {"oid": "215d6bf82a9cefac5078254a0e6ddb62b4558866", "url": "https://github.com/ConsenSys/teku/commit/215d6bf82a9cefac5078254a0e6ddb62b4558866", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into rc1", "committedDate": "2020-10-13T00:04:25Z", "type": "commit"}, {"oid": "14795cc3870707769d589958ae0834adb43f984b", "url": "https://github.com/ConsenSys/teku/commit/14795cc3870707769d589958ae0834adb43f984b", "message": "Update states in FuzzUtilTest to match new constants.", "committedDate": "2020-10-13T00:12:25Z", "type": "commit"}, {"oid": "463362084c644aa41bee18b8fcd157faafa3c820", "url": "https://github.com/ConsenSys/teku/commit/463362084c644aa41bee18b8fcd157faafa3c820", "message": "Support weird case of one test using messages instead of message.", "committedDate": "2020-10-13T00:38:26Z", "type": "commit"}, {"oid": "4df2638a060e691e0094a8cac9a6ec23f99cf8d1", "url": "https://github.com/ConsenSys/teku/commit/4df2638a060e691e0094a8cac9a6ec23f99cf8d1", "message": "Handle signing tests that are expected to fail.", "committedDate": "2020-10-13T00:40:22Z", "type": "commit"}, {"oid": "7f9dccbdeb58f3baa9cb7b8aac319c326c164b9b", "url": "https://github.com/ConsenSys/teku/commit/7f9dccbdeb58f3baa9cb7b8aac319c326c164b9b", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into rc1", "committedDate": "2020-10-13T00:40:44Z", "type": "commit"}, {"oid": "3aadfb274fca7504bca1d715ac56c063627ff63d", "url": "https://github.com/ConsenSys/teku/commit/3aadfb274fca7504bca1d715ac56c063627ff63d", "message": "Fix the original issue with  BlstSignature.verify(List<PublicKeyMessagePair> keysToMessages) and Infinity pub key", "committedDate": "2020-10-13T15:04:03Z", "type": "commit"}, {"oid": "cf76b2f2b786053746ad5d3c2bf62fb94d71d1a4", "url": "https://github.com/ConsenSys/teku/commit/cf76b2f2b786053746ad5d3c2bf62fb94d71d1a4", "message": "Add global BLSConstants.VALID_INFINITY variable and make use of it for Blst implementation", "committedDate": "2020-10-13T15:19:14Z", "type": "commit"}, {"oid": "7bf299fd3e8884c6d8814a0a4438c5a76db3f3e8", "url": "https://github.com/ConsenSys/teku/commit/7bf299fd3e8884c6d8814a0a4438c5a76db3f3e8", "message": "Convert invalid signature test cases from Mikuli specific to generic", "committedDate": "2020-10-13T16:22:35Z", "type": "commit"}, {"oid": "92087a1c590d4e1611791af7675b1279305e9265", "url": "https://github.com/ConsenSys/teku/commit/92087a1c590d4e1611791af7675b1279305e9265", "message": "Use dedicated DeserializeException when failed to deserialize G1/G2 points from bytes", "committedDate": "2020-10-14T09:50:20Z", "type": "commit"}, {"oid": "4eacd8fa60472742c276bac47651677a6f703c0a", "url": "https://github.com/ConsenSys/teku/commit/4eacd8fa60472742c276bac47651677a6f703c0a", "message": "Cleanup Mikuli implementation. Handle malformed serialized pkeys and signatures on a higher level", "committedDate": "2020-10-14T11:06:54Z", "type": "commit"}, {"oid": "2fcdc0ffa7108d8b6a3fb4af8847fff63c8030a2", "url": "https://github.com/ConsenSys/teku/commit/2fcdc0ffa7108d8b6a3fb4af8847fff63c8030a2", "message": "A bit more Mikuli clean up", "committedDate": "2020-10-14T16:13:52Z", "type": "commit"}, {"oid": "a98fa087a0344139d83ca6b4a38cc39903227c28", "url": "https://github.com/ConsenSys/teku/commit/a98fa087a0344139d83ca6b4a38cc39903227c28", "message": "More Mikuli BLS code cleanup", "committedDate": "2020-10-14T17:02:04Z", "type": "commit"}, {"oid": "a071d94ae0dda187d957b36ecd4edece66fe389e", "url": "https://github.com/ConsenSys/teku/commit/a071d94ae0dda187d957b36ecd4edece66fe389e", "message": "Make reference BLS tests executing on both BLS implementations", "committedDate": "2020-10-14T17:30:46Z", "type": "commit"}, {"oid": "3d4c0cfc87b55775276af901bd803ef05af2e21e", "url": "https://github.com/ConsenSys/teku/commit/3d4c0cfc87b55775276af901bd803ef05af2e21e", "message": "Handle Infinity pubkey in mikuli implementation", "committedDate": "2020-10-14T17:33:19Z", "type": "commit"}, {"oid": "425f1e3766ff45d38d74ba2ae37ee6238d265096", "url": "https://github.com/ConsenSys/teku/commit/425f1e3766ff45d38d74ba2ae37ee6238d265096", "message": "Spotless apply", "committedDate": "2020-10-14T17:33:34Z", "type": "commit"}, {"oid": "3cceb096af6e14c3fdf29db2977449629a75f846", "url": "https://github.com/ConsenSys/teku/commit/3cceb096af6e14c3fdf29db2977449629a75f846", "message": "Fix unit tests to conform new BLS spec draft: Infinite pubkey/sig are invalid, not allowed to sign with Zero privkey", "committedDate": "2020-10-14T18:04:13Z", "type": "commit"}, {"oid": "71143774ce40f7b80e98d4e7ff526bce5a24006f", "url": "https://github.com/ConsenSys/teku/commit/71143774ce40f7b80e98d4e7ff526bce5a24006f", "message": "Fix batchVerify with respect to Infinite pubkeys in both implementations", "committedDate": "2020-10-14T18:04:48Z", "type": "commit"}, {"oid": "ac93af65c91a3753cf97457f83c9987b33251792", "url": "https://github.com/ConsenSys/teku/commit/ac93af65c91a3753cf97457f83c9987b33251792", "message": "Merge remote-tracking branch 'pegasys/master' into feature/rc1-bls", "committedDate": "2020-10-14T18:05:59Z", "type": "commit"}, {"oid": "145d5039594c09d8279564453493fd26de9ebac6", "url": "https://github.com/ConsenSys/teku/commit/145d5039594c09d8279564453493fd26de9ebac6", "message": "Fix warnings", "committedDate": "2020-10-14T18:35:24Z", "type": "commit"}, {"oid": "373732ff8b8b5ff2b9d0eae4933fd1e55398f3d0", "url": "https://github.com/ConsenSys/teku/commit/373732ff8b8b5ff2b9d0eae4933fd1e55398f3d0", "message": "Return back accidentally removed @Disabled", "committedDate": "2020-10-14T18:41:14Z", "type": "commit"}, {"oid": "c80cdb9c73d9f99d7f82b1ee5d717c14b21bb45e", "url": "https://github.com/ConsenSys/teku/commit/c80cdb9c73d9f99d7f82b1ee5d717c14b21bb45e", "message": "Specify BLSConstants.VALID_INFINITY by custom Constants const", "committedDate": "2020-10-15T09:20:21Z", "type": "commit"}, {"oid": "8422bd2e307e40166eca9eab260153bc6b401ead", "url": "https://github.com/ConsenSys/teku/commit/8422bd2e307e40166eca9eab260153bc6b401ead", "message": "Fix the test", "committedDate": "2020-10-15T09:33:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkzODY4Mg==", "url": "https://github.com/ConsenSys/teku/pull/2971#discussion_r505938682", "bodyText": "Can we make this a boolean instead of 0 or 1?", "author": "ajsutton", "createdAt": "2020-10-16T00:34:43Z", "path": "util/src/main/java/tech/pegasys/teku/util/config/Constants.java", "diffHunk": "@@ -167,13 +169,19 @@\n   public static final int VALID_VALIDATOR_SET_SIZE = 10000;\n   public static final int NETWORKING_FAILURE_REPEAT_INTERVAL = 3; // in sec\n \n+  // Custom\n+  // Temporary BLS backward compatibility flag\n+  // Set to 1 if required BLS to be pre rc-1 spec compatible\n+  public static int BLS_INFINITY_VALID = 0;", "originalCommit": "8422bd2e307e40166eca9eab260153bc6b401ead", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b3cfcc5a6caaa816c4ab674621a3fca88678f6fe", "chunk": "diff --git a/util/src/main/java/tech/pegasys/teku/util/config/Constants.java b/util/src/main/java/tech/pegasys/teku/util/config/Constants.java\nindex 0182920f65..28433c85e0 100644\n--- a/util/src/main/java/tech/pegasys/teku/util/config/Constants.java\n+++ b/util/src/main/java/tech/pegasys/teku/util/config/Constants.java\n\n@@ -172,7 +172,7 @@ public class Constants {\n   // Custom\n   // Temporary BLS backward compatibility flag\n   // Set to 1 if required BLS to be pre rc-1 spec compatible\n-  public static int BLS_INFINITY_VALID = 0;\n+  public static boolean BLS_INFINITY_VALID = false;\n \n   static {\n     setConstants(\"minimal\");\n"}}, {"oid": "b3cfcc5a6caaa816c4ab674621a3fca88678f6fe", "url": "https://github.com/ConsenSys/teku/commit/b3cfcc5a6caaa816c4ab674621a3fca88678f6fe", "message": "Make BLS_INFINITY_VALID boolean", "committedDate": "2020-10-16T10:35:31Z", "type": "commit"}, {"oid": "7d0ae75e1b753cbb6144a03f3ee8dd87ea3d3248", "url": "https://github.com/ConsenSys/teku/commit/7d0ae75e1b753cbb6144a03f3ee8dd87ea3d3248", "message": "Merge remote-tracking branch 'pegasys/master' into feature/rc1-bls", "committedDate": "2020-10-16T10:54:08Z", "type": "commit"}]}