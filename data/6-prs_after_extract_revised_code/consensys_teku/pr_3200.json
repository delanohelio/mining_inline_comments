{"pr_number": 3200, "pr_title": "Update slashing-protection interchange format version to v.5.", "pr_createdAt": "2020-11-11T23:46:14Z", "pr_url": "https://github.com/ConsenSys/teku/pull/3200", "timeline": [{"oid": "08569d89fc6f6c0e78d24ad57930c374cb0a0f38", "url": "https://github.com/ConsenSys/teku/commit/08569d89fc6f6c0e78d24ad57930c374cb0a0f38", "message": "Update slashing-protection interchange format version to v.5.\n\nThe difference is 'interchange_format' is no longer required. If you have v.4 and want to import it with v.5, delete that field from metadata, and update the version.\n\nfixes #3197\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-11-11T23:44:48Z", "type": "commit"}, {"oid": "d15c7c06d34c40decbdc8806fdd6872c818e5043", "url": "https://github.com/ConsenSys/teku/commit/d15c7c06d34c40decbdc8806fdd6872c818e5043", "message": "Merge remote-tracking branch 'upstream/master' into 3197", "committedDate": "2020-11-11T23:45:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTczNTUxMQ==", "url": "https://github.com/ConsenSys/teku/pull/3200#discussion_r521735511", "bodyText": "This doesn't seem ideal. If the only change is removing this field, can we support both version 4 and 5 and just mark the field optional?", "author": "ajsutton", "createdAt": "2020-11-12T00:35:37Z", "path": "data/dataexchange/src/main/java/tech/pegasys/teku/data/SlashingProtectionImporter.java", "diffHunk": "@@ -81,6 +81,9 @@ public void initialise(final File inputFile) throws IOException {\n \n     } catch (JsonMappingException e) {\n       String cause = e.getCause() != null ? e.getCause().getMessage() : e.getMessage();\n+      if (cause.contains(\"\\\"interchange_format\\\"\")) {\n+        cause = \"Required version is \" + INTERCHANGE_VERSION;\n+      }", "originalCommit": "d15c7c06d34c40decbdc8806fdd6872c818e5043", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9394604af7bed24cc45b10d2169671bd299c9a5c", "chunk": "diff --git a/data/dataexchange/src/main/java/tech/pegasys/teku/data/SlashingProtectionImporter.java b/data/dataexchange/src/main/java/tech/pegasys/teku/data/SlashingProtectionImporter.java\nindex 3fb590ab0e..edc79f242c 100644\n--- a/data/dataexchange/src/main/java/tech/pegasys/teku/data/SlashingProtectionImporter.java\n+++ b/data/dataexchange/src/main/java/tech/pegasys/teku/data/SlashingProtectionImporter.java\n\n@@ -81,9 +81,6 @@ public class SlashingProtectionImporter {\n \n     } catch (JsonMappingException e) {\n       String cause = e.getCause() != null ? e.getCause().getMessage() : e.getMessage();\n-      if (cause.contains(\"\\\"interchange_format\\\"\")) {\n-        cause = \"Required version is \" + INTERCHANGE_VERSION;\n-      }\n       log.exit(1, \"Failed to load data from \" + inputFile.getName() + \". \" + cause);\n     } catch (JsonParseException e) {\n       String cause = e.getCause() != null ? e.getCause().getMessage() : e.getMessage();\n"}}, {"oid": "9394604af7bed24cc45b10d2169671bd299c9a5c", "url": "https://github.com/ConsenSys/teku/commit/9394604af7bed24cc45b10d2169671bd299c9a5c", "message": "make interchange-format optional rather than removing it.\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-11-12T02:02:09Z", "type": "commit"}, {"oid": "e3f28a6ad927aea7112b77f35fee6ea1dbb50dfc", "url": "https://github.com/ConsenSys/teku/commit/e3f28a6ad927aea7112b77f35fee6ea1dbb50dfc", "message": "make interchange-format optional rather than removing it.\n\nallow v.4 or v.5 to be taken in, it's only the interchange_format that's been removed.\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-11-12T02:19:32Z", "type": "commit"}, {"oid": "359574910cf3a4312c8d4dbfd65ca5689ed9197a", "url": "https://github.com/ConsenSys/teku/commit/359574910cf3a4312c8d4dbfd65ca5689ed9197a", "message": "Merge remote-tracking branch 'upstream/master' into 3197", "committedDate": "2020-11-12T02:20:46Z", "type": "commit"}]}