{"pr_number": 2370, "pr_title": "Extract a separate async module", "pr_createdAt": "2020-07-17T03:43:09Z", "pr_url": "https://github.com/ConsenSys/teku/pull/2370", "timeline": [{"oid": "521c2b4ae52e0e8da9bb4e58b43a9200f7022cac", "url": "https://github.com/ConsenSys/teku/commit/521c2b4ae52e0e8da9bb4e58b43a9200f7022cac", "message": "Extract a separate async module, separate to utils.", "committedDate": "2020-07-17T03:39:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIwMTk5Nw==", "url": "https://github.com/ConsenSys/teku/pull/2370#discussion_r456201997", "bodyText": "Somehow these didn't make it into #2362.  Should be the only actual code changes in here (the rest being build files and imports changing).", "author": "ajsutton", "createdAt": "2020-07-17T03:45:18Z", "path": "infrastructure/async/src/test/java/tech/pegasys/teku/infrastructure/async/SafeFutureTest.java", "diffHunk": "@@ -441,6 +441,33 @@ public void propagateTo_propagatesExceptionalResult() {\n     assertThatSafeFuture(target).isCompletedExceptionallyWith(exception);\n   }\n \n+  @Test\n+  public void propagateToAsync_propagatesSuccessfulResult() {\n+    final StubAsyncRunner asyncRunner = new StubAsyncRunner();\n+    final SafeFuture<String> target = new SafeFuture<>();\n+    final SafeFuture<String> source = new SafeFuture<>();\n+    source.propagateToAsync(target, asyncRunner);\n+    source.complete(\"Yay\");\n+    assertThat(target).isNotDone();\n+\n+    asyncRunner.executeQueuedActions();\n+    assertThat(target).isCompletedWithValue(\"Yay\");\n+  }\n+\n+  @Test\n+  public void propagateToAsync_propagatesExceptionalResult() {\n+    final StubAsyncRunner asyncRunner = new StubAsyncRunner();\n+    final SafeFuture<String> target = new SafeFuture<>();\n+    final SafeFuture<String> source = new SafeFuture<>();\n+    source.propagateToAsync(target, asyncRunner);\n+    final RuntimeException exception = new RuntimeException(\"Oh no!\");\n+    source.completeExceptionally(exception);\n+    assertThat(target).isNotDone();\n+\n+    asyncRunner.executeQueuedActions();\n+    assertThatSafeFuture(target).isCompletedExceptionallyWith(exception);\n+  }", "originalCommit": "521c2b4ae52e0e8da9bb4e58b43a9200f7022cac", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "eb0ec2593237ec2ac0325d7815b755142e870274", "url": "https://github.com/ConsenSys/teku/commit/eb0ec2593237ec2ac0325d7815b755142e870274", "message": "Fix license for new module.", "committedDate": "2020-07-17T03:46:32Z", "type": "commit"}, {"oid": "7768dce5816f5f91a8beb696c9a53e1c1f63d0c5", "url": "https://github.com/ConsenSys/teku/commit/7768dce5816f5f91a8beb696c9a53e1c1f63d0c5", "message": "Merge branch 'master' into extract-async-module", "committedDate": "2020-07-17T21:23:45Z", "type": "commit"}, {"oid": "198c194b7a1d4ce639e00d74960b774e305459dd", "url": "https://github.com/ConsenSys/teku/commit/198c194b7a1d4ce639e00d74960b774e305459dd", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into extract-async-module", "committedDate": "2020-07-17T22:29:51Z", "type": "commit"}]}