{"pr_number": 3059, "pr_title": "Update external signing API to pass data for computing signing root", "pr_createdAt": "2020-10-23T02:10:00Z", "pr_url": "https://github.com/ConsenSys/teku/pull/3059", "timeline": [{"oid": "25936dd2bfc3c2f68bfeac87c619d421927ee844", "url": "https://github.com/ConsenSys/teku/commit/25936dd2bfc3c2f68bfeac87c619d421927ee844", "message": "Update external signing API to pass through data to allow local computing of signing root and slashing protection verification", "committedDate": "2020-10-23T01:57:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU3ODg1NQ==", "url": "https://github.com/ConsenSys/teku/pull/3059#discussion_r510578855", "bodyText": "you can possibly use the constant FORK_INFO here as well.", "author": "usmansaleem", "createdAt": "2020-10-23T03:52:31Z", "path": "validator/client/src/main/java/tech/pegasys/teku/validator/client/signer/ExternalSigner.java", "diffHunk": "@@ -62,7 +63,12 @@ public ExternalSigner(\n \n   @Override\n   public SafeFuture<BLSSignature> createRandaoReveal(final UInt64 epoch, final ForkInfo forkInfo) {\n-    return sign(signingRootForRandaoReveal(epoch, forkInfo), SignType.RANDAO_REVEAL, emptyMap());\n+    return sign(\n+        signingRootForRandaoReveal(epoch, forkInfo),\n+        SignType.RANDAO_REVEAL,\n+        Map.of(\n+            \"randao_reveal\", Map.of(\"epoch\", epoch),\n+            \"fork_info\", forkInfo(forkInfo)));", "originalCommit": "25936dd2bfc3c2f68bfeac87c619d421927ee844", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU4MzQ1OA==", "url": "https://github.com/ConsenSys/teku/pull/3059#discussion_r510583458", "bodyText": "done", "author": "jframe", "createdAt": "2020-10-23T04:14:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU3ODg1NQ=="}], "type": "inlineReview", "revised_code": {"commit": "d0157edc6d9db167281b804eed03e69ca703ef59", "chunk": "diff --git a/validator/client/src/main/java/tech/pegasys/teku/validator/client/signer/ExternalSigner.java b/validator/client/src/main/java/tech/pegasys/teku/validator/client/signer/ExternalSigner.java\nindex e16b81303..0b851a6a3 100644\n--- a/validator/client/src/main/java/tech/pegasys/teku/validator/client/signer/ExternalSigner.java\n+++ b/validator/client/src/main/java/tech/pegasys/teku/validator/client/signer/ExternalSigner.java\n\n@@ -68,7 +68,7 @@ public class ExternalSigner implements Signer {\n         SignType.RANDAO_REVEAL,\n         Map.of(\n             \"randao_reveal\", Map.of(\"epoch\", epoch),\n-            \"fork_info\", forkInfo(forkInfo)));\n+            FORK_INFO, forkInfo(forkInfo)));\n   }\n \n   @Override\n"}}, {"oid": "d0157edc6d9db167281b804eed03e69ca703ef59", "url": "https://github.com/ConsenSys/teku/commit/d0157edc6d9db167281b804eed03e69ca703ef59", "message": "use FORK_INFO constant", "committedDate": "2020-10-23T04:14:27Z", "type": "commit"}, {"oid": "5f3d3853e8d65a2703e4c343221919e488c85f44", "url": "https://github.com/ConsenSys/teku/commit/5f3d3853e8d65a2703e4c343221919e488c85f44", "message": "spotless", "committedDate": "2020-10-23T04:20:26Z", "type": "commit"}, {"oid": "53d340b008c9e418b903c16ea24fe0b597ae8d9f", "url": "https://github.com/ConsenSys/teku/commit/53d340b008c9e418b903c16ea24fe0b597ae8d9f", "message": "Merge branch 'master' into external_signing_api_compute_signing_root", "committedDate": "2020-10-23T04:23:21Z", "type": "commit"}]}