{"pr_number": 1491, "pr_title": "Add integration tests that show returning of data from the local chain", "pr_createdAt": "2020-03-27T01:37:11Z", "pr_url": "https://github.com/ConsenSys/teku/pull/1491", "timeline": [{"oid": "d875c99b8255020d9f1a3ce5d2a66d67340e58f5", "url": "https://github.com/ConsenSys/teku/commit/d875c99b8255020d9f1a3ce5d2a66d67340e58f5", "message": "Add integration tests that show returning of data from the local chain\n\nPartially addresses #1473\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-03-27T01:36:24Z", "type": "commit"}, {"oid": "26a7c56e62b5299a03ea258693dc2e7d99baef69", "url": "https://github.com/ConsenSys/teku/commit/26a7c56e62b5299a03ea258693dc2e7d99baef69", "message": "Merge remote-tracking branch 'upstream/master' into 1473-integration-tests-get-beaconBlock\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>", "committedDate": "2020-03-27T01:48:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTAxNzk1OQ==", "url": "https://github.com/ConsenSys/teku/pull/1491#discussion_r399017959", "bodyText": "Could add final in plenty of spots here.", "author": "mark-terry", "createdAt": "2020-03-27T03:39:02Z", "path": "data/beaconrestapi/src/integration-test/java/tech/pegasys/artemis/beaconrestapi/AbstractDataBackedRestAPIIntegrationTest.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.beaconrestapi;\n+\n+import com.google.common.eventbus.EventBus;\n+import com.google.common.primitives.UnsignedLong;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.concurrent.TimeUnit;\n+import okhttp3.OkHttpClient;\n+import org.junit.jupiter.api.BeforeEach;\n+import tech.pegasys.artemis.api.DataProvider;\n+import tech.pegasys.artemis.api.schema.SignedBeaconBlock;\n+import tech.pegasys.artemis.statetransition.BeaconChainUtil;\n+import tech.pegasys.artemis.storage.ChainStorageClient;\n+import tech.pegasys.artemis.storage.CombinedChainDataClient;\n+import tech.pegasys.artemis.storage.HistoricalChainData;\n+import tech.pegasys.artemis.util.config.ArtemisConfiguration;\n+\n+public abstract class AbstractDataBackedRestAPIIntegrationTest\n+    extends AbstractBeaconRestAPIIntegrationTest {\n+  private BeaconChainUtil beaconChainUtil;\n+\n+  @Override\n+  @BeforeEach\n+  public void setup() {\n+    final EventBus eventBus = new EventBus();\n+    chainStorageClient = ChainStorageClient.memoryOnlyClient(eventBus);", "originalCommit": "26a7c56e62b5299a03ea258693dc2e7d99baef69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg1NzY5NA==", "url": "https://github.com/ConsenSys/teku/pull/1491#discussion_r399857694", "bodyText": "not as many as you might think... most of these are setting variables on the AbstractBeaconRestApiIntegrationTest class so that i can have data storage..", "author": "rolfyone", "createdAt": "2020-03-29T21:40:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTAxNzk1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "35efcf5d3b4ff8081d74bf243c5638992886213a", "chunk": "diff --git a/data/beaconrestapi/src/integration-test/java/tech/pegasys/artemis/beaconrestapi/AbstractDataBackedRestAPIIntegrationTest.java b/data/beaconrestapi/src/integration-test/java/tech/pegasys/artemis/beaconrestapi/AbstractDataBackedRestAPIIntegrationTest.java\nindex 5a80a16452..b747cfb1ce 100644\n--- a/data/beaconrestapi/src/integration-test/java/tech/pegasys/artemis/beaconrestapi/AbstractDataBackedRestAPIIntegrationTest.java\n+++ b/data/beaconrestapi/src/integration-test/java/tech/pegasys/artemis/beaconrestapi/AbstractDataBackedRestAPIIntegrationTest.java\n\n@@ -13,6 +13,8 @@\n \n package tech.pegasys.artemis.beaconrestapi;\n \n+import static org.mockito.Mockito.mock;\n+\n import com.google.common.eventbus.EventBus;\n import com.google.common.primitives.UnsignedLong;\n import java.util.ArrayList;\n"}}, {"oid": "35efcf5d3b4ff8081d74bf243c5638992886213a", "url": "https://github.com/ConsenSys/teku/commit/35efcf5d3b4ff8081d74bf243c5638992886213a", "message": " Merge remote-tracking branch 'upstream/master' into 1473-integration-tests-get-beaconBlock", "committedDate": "2020-03-29T22:17:22Z", "type": "commit"}, {"oid": "8f0972c44bed5c65db80b3a4e8f8400907f47296", "url": "https://github.com/ConsenSys/teku/commit/8f0972c44bed5c65db80b3a4e8f8400907f47296", "message": "Merge remote-tracking branch 'upstream/master' into 1473-integration-tests-get-beaconBlock", "committedDate": "2020-03-30T10:10:27Z", "type": "commit"}, {"oid": "31ee5f7d452804658f09d6d038293816044fcdb3", "url": "https://github.com/ConsenSys/teku/commit/31ee5f7d452804658f09d6d038293816044fcdb3", "message": "fix tests.", "committedDate": "2020-03-30T21:29:03Z", "type": "commit"}, {"oid": "9633447ab032fddfb2716a62c8d68367bbe02f5f", "url": "https://github.com/ConsenSys/teku/commit/9633447ab032fddfb2716a62c8d68367bbe02f5f", "message": "fix tests.", "committedDate": "2020-03-30T22:06:52Z", "type": "commit"}, {"oid": "48794a8bee6c1a05341b869e98e8ab4308aa7f9d", "url": "https://github.com/ConsenSys/teku/commit/48794a8bee6c1a05341b869e98e8ab4308aa7f9d", "message": "Merge remote-tracking branch 'upstream/master' into 1473-integration-tests-get-beaconBlock", "committedDate": "2020-03-31T01:12:54Z", "type": "commit"}, {"oid": "44d52b9265568b72cd3b89149ccc14da1ccf0ec5", "url": "https://github.com/ConsenSys/teku/commit/44d52b9265568b72cd3b89149ccc14da1ccf0ec5", "message": "Merge remote-tracking branch 'upstream/master' into 1473-integration-tests-get-beaconBlock", "committedDate": "2020-03-31T01:13:05Z", "type": "commit"}]}