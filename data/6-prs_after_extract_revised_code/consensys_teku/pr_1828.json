{"pr_number": 1828, "pr_title": "Refactor attestation manager and processing", "pr_createdAt": "2020-05-20T23:20:16Z", "pr_url": "https://github.com/ConsenSys/teku/pull/1828", "timeline": [{"oid": "7e5a9919b31c83f1e7255c5d419af9273152e9de", "url": "https://github.com/ConsenSys/teku/commit/7e5a9919b31c83f1e7255c5d419af9273152e9de", "message": "Refactor attestation processing at AttestationManager", "committedDate": "2020-05-20T22:57:08Z", "type": "commit"}, {"oid": "04693571ff46e1ff427fc257922c6acf7100a1c5", "url": "https://github.com/ConsenSys/teku/commit/04693571ff46e1ff427fc257922c6acf7100a1c5", "message": "Run spotless", "committedDate": "2020-05-20T23:18:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM3ODI0OA==", "url": "https://github.com/ConsenSys/teku/pull/1828#discussion_r428378248", "bodyText": "nit: Would probably good to add the isSuccessful() method to the enum as it reads quite well.", "author": "ajsutton", "createdAt": "2020-05-21T00:16:51Z", "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/attestation/ForkChoiceAttestationProcessor.java", "diffHunk": "@@ -33,7 +33,7 @@ public ForkChoiceAttestationProcessor(\n   public AttestationProcessingResult processAttestation(final Attestation attestation) {\n     final Store.Transaction transaction = recentChainData.startStoreTransaction();\n     final AttestationProcessingResult result = forkChoice.onAttestation(transaction, attestation);\n-    if (result.isSuccessful()) {\n+    if (result == AttestationProcessingResult.SUCCESSFUL) {", "originalCommit": "04693571ff46e1ff427fc257922c6acf7100a1c5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODc3ODI1Mg==", "url": "https://github.com/ConsenSys/teku/pull/1828#discussion_r428778252", "bodyText": "done.", "author": "cemozerr", "createdAt": "2020-05-21T16:47:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM3ODI0OA=="}], "type": "inlineReview", "revised_code": {"commit": "e89ac4291a9392d04cc85db8dcbf77a28ff25487", "chunk": "diff --git a/ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/attestation/ForkChoiceAttestationProcessor.java b/ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/attestation/ForkChoiceAttestationProcessor.java\nindex 1c98b90a8d..23417c211c 100644\n--- a/ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/attestation/ForkChoiceAttestationProcessor.java\n+++ b/ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/attestation/ForkChoiceAttestationProcessor.java\n\n@@ -33,7 +33,7 @@ public class ForkChoiceAttestationProcessor {\n   public AttestationProcessingResult processAttestation(final Attestation attestation) {\n     final Store.Transaction transaction = recentChainData.startStoreTransaction();\n     final AttestationProcessingResult result = forkChoice.onAttestation(transaction, attestation);\n-    if (result == AttestationProcessingResult.SUCCESSFUL) {\n+    if (result.isSuccessful()) {\n       transaction.commit(() -> {}, \"Failed to persist attestation result\");\n     }\n     return result;\n"}}, {"oid": "e89ac4291a9392d04cc85db8dcbf77a28ff25487", "url": "https://github.com/ConsenSys/teku/commit/e89ac4291a9392d04cc85db8dcbf77a28ff25487", "message": "Add isSuccessful method", "committedDate": "2020-05-21T16:53:02Z", "type": "commit"}, {"oid": "e20226ae11aa950f38b4279327532992e0d78117", "url": "https://github.com/ConsenSys/teku/commit/e20226ae11aa950f38b4279327532992e0d78117", "message": "Merge branch 'master' into refactorAttestationManagerAndProcessing", "committedDate": "2020-05-21T16:53:15Z", "type": "commit"}]}