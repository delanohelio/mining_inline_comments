{"pr_number": 1275, "pr_title": "Handle duplicate peers", "pr_createdAt": "2020-03-04T04:48:53Z", "pr_url": "https://github.com/ConsenSys/teku/pull/1275", "timeline": [{"oid": "02cd4c53d6b0566e11ed134fe85f78b1e5ec4796", "url": "https://github.com/ConsenSys/teku/commit/02cd4c53d6b0566e11ed134fe85f78b1e5ec4796", "message": "Handle duplicate connections to the same peer correctly.", "committedDate": "2020-03-04T05:07:36Z", "type": "forcePushed"}, {"oid": "063d8e015861b11afb93d93ddc112e3fca1060f3", "url": "https://github.com/ConsenSys/teku/commit/063d8e015861b11afb93d93ddc112e3fca1060f3", "message": "Handle duplicate connections to the same peer correctly.", "committedDate": "2020-03-04T05:17:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc1ODkwMg==", "url": "https://github.com/ConsenSys/teku/pull/1275#discussion_r387758902", "bodyText": "Why cut these assertions?", "author": "mbaxter", "createdAt": "2020-03-04T15:53:14Z", "path": "networking/eth2/src/integration-test/java/tech/pegasys/artemis/networking/eth2/GoodbyeIntegrationTest.java", "diffHunk": "@@ -48,7 +46,5 @@ public void shouldCloseConnectionAfterGoodbyeReceived() throws Exception {\n     waitFor(peer1.sendGoodbye(GoodbyeMessage.REASON_CLIENT_SHUT_DOWN));\n     Waiter.waitFor(() -> assertThat(peer1.isConnected()).isFalse());\n     Waiter.waitFor(() -> assertThat(peer2.isConnected()).isFalse());\n-    assertThat(network1.getPeerCount()).isZero();\n-    assertThat(network2.getPeerCount()).isZero();", "originalCommit": "063d8e015861b11afb93d93ddc112e3fca1060f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkxOTk3OA==", "url": "https://github.com/ConsenSys/teku/pull/1275#discussion_r387919978", "bodyText": "Because it reconnects a lot faster now so while the explicit peer instance is guaranteed to be disconnected, it may have reconnected again before we get to the peerCount is zero check.", "author": "ajsutton", "createdAt": "2020-03-04T20:37:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc1ODkwMg=="}], "type": "inlineReview", "revised_code": null}, {"oid": "2ac503ef38aded2bc6be51eab11ab4ff44bdf263", "url": "https://github.com/ConsenSys/teku/commit/2ac503ef38aded2bc6be51eab11ab4ff44bdf263", "message": "Handle duplicate connections to the same peer correctly.", "committedDate": "2020-03-04T20:39:01Z", "type": "commit"}, {"oid": "2ac503ef38aded2bc6be51eab11ab4ff44bdf263", "url": "https://github.com/ConsenSys/teku/commit/2ac503ef38aded2bc6be51eab11ab4ff44bdf263", "message": "Handle duplicate connections to the same peer correctly.", "committedDate": "2020-03-04T20:39:01Z", "type": "forcePushed"}]}