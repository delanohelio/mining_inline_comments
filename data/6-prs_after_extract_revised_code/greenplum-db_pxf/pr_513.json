{"pr_number": 513, "pr_title": "Separate out the parquet prune and transform logic", "pr_createdAt": "2020-12-08T15:01:01Z", "pr_url": "https://github.com/greenplum-db/pxf/pull/513", "timeline": [{"oid": "0926d83d26e15a41db7255b7375ba93147e730e6", "url": "https://github.com/greenplum-db/pxf/commit/0926d83d26e15a41db7255b7375ba93147e730e6", "message": "Fix README when initializing default server config", "committedDate": "2020-12-08T14:23:37Z", "type": "commit"}, {"oid": "497108ee0fc91b1d605d37bf89d86a2f44308d23", "url": "https://github.com/greenplum-db/pxf/commit/497108ee0fc91b1d605d37bf89d86a2f44308d23", "message": "Separate out the parquet prune and transform logic\n\nThe ParquetOperatorPrunerAndTransformer functionality is overloaded. We\nwould like to extract out the Prune and Transform functionalities into\ntheir own classes to separate out functionality and for a cleaner\nimplementation.", "committedDate": "2020-12-08T16:38:31Z", "type": "commit"}, {"oid": "497108ee0fc91b1d605d37bf89d86a2f44308d23", "url": "https://github.com/greenplum-db/pxf/commit/497108ee0fc91b1d605d37bf89d86a2f44308d23", "message": "Separate out the parquet prune and transform logic\n\nThe ParquetOperatorPrunerAndTransformer functionality is overloaded. We\nwould like to extract out the Prune and Transform functionalities into\ntheir own classes to separate out functionality and for a cleaner\nimplementation.", "committedDate": "2020-12-08T16:38:31Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODY5MTI2NA==", "url": "https://github.com/greenplum-db/pxf/pull/513#discussion_r538691264", "bodyText": "will this almost always be 0 as we unlikely will reach 1tuple/ns speed and the variable is not float. Why not measure in tuples / ms units ?", "author": "denalex", "createdAt": "2020-12-08T18:22:20Z", "path": "server/pxf-api/src/main/java/org/greenplum/pxf/api/model/BasePlugin.java", "diffHunk": "@@ -31,4 +33,27 @@ public void setRequestContext(RequestContext context) {\n     @Override\n     public void afterPropertiesSet() {\n     }\n+\n+    /**\n+     * When DEBUG mode is enabled, logs the total number of rows read, the\n+     * amount of time it took to read the file, and the average read speed\n+     * in nanoseconds\n+     *\n+     * @param totalRowsRead        the total number of rows read\n+     * @param totalReadTimeInNanos the total nanoseconds it took to read the file\n+     */\n+    protected void logReadStats(long totalRowsRead, long totalReadTimeInNanos) {\n+        if (LOG.isDebugEnabled()) {\n+            final long millis = TimeUnit.NANOSECONDS.toMillis(totalReadTimeInNanos);\n+            long tuplesPerNanos = totalReadTimeInNanos == 0 ? 0 : totalRowsRead / totalReadTimeInNanos;\n+            LOG.debug(\"{}-{}: Read TOTAL of {} rows from file {} on server {} in {} ms. Average speed: {} tuples/nanoseconds\",", "originalCommit": "497108ee0fc91b1d605d37bf89d86a2f44308d23", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODgxNTkyOA==", "url": "https://github.com/greenplum-db/pxf/pull/513#discussion_r538815928", "bodyText": "sure, let me change that", "author": "frankgh", "createdAt": "2020-12-08T21:20:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODY5MTI2NA=="}], "type": "inlineReview", "revised_code": null}]}