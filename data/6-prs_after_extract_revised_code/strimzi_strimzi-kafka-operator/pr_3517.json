{"pr_number": 3517, "pr_title": "[systemtest] Change labels to use strimzi.io/kind instead of type", "pr_createdAt": "2020-08-17T13:19:32Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3517", "timeline": [{"oid": "081699dbec5f72acb7ee2287487e280454c8f999", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/081699dbec5f72acb7ee2287487e280454c8f999", "message": "change resources to contain the type labels\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-08-17T13:21:00Z", "type": "forcePushed"}, {"oid": "e88f249eabf5fefad53227ccd5dc3c37d61b1976", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e88f249eabf5fefad53227ccd5dc3c37d61b1976", "message": "change resources to contain the type labels\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-08-17T13:23:50Z", "type": "forcePushed"}, {"oid": "a8dd448a7b358daab30929ca0cbea1144f2d0020", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a8dd448a7b358daab30929ca0cbea1144f2d0020", "message": "change resources to contain the type labels\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-08-17T13:33:42Z", "type": "forcePushed"}, {"oid": "f0c710d2761c63ebab64c18526b63038846a673f", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f0c710d2761c63ebab64c18526b63038846a673f", "message": "change resources to contain the type labels\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-08-17T13:36:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTUzMjg5NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3517#discussion_r471532894", "bodyText": "Isto to je spravne?\n    public static final String RESOURCE_KIND = \"KafkaBridge\"; != (\"type\", \"kafka-bridge\")", "author": "michalxo", "createdAt": "2020-08-17T14:50:59Z", "path": "systemtest/src/test/java/io/strimzi/systemtest/bridge/HttpBridgeST.java", "diffHunk": "@@ -229,13 +226,9 @@ void testDiscoveryAnnotation() {\n     void testScaleBridgeToZero() {\n         String bridgeName = \"scaling-bridge\";\n \n-        KafkaBridgeResource.kafkaBridge(bridgeName, KafkaResources.plainBootstrapAddress(CLUSTER_NAME), 1)\n-            .editMetadata()\n-                .addToLabels(\"type\", \"kafka-bridge\")\n-            .endMetadata()\n-            .done();\n+        KafkaBridgeResource.kafkaBridge(bridgeName, KafkaResources.plainBootstrapAddress(CLUSTER_NAME), 1).done();\n \n-        List<String> bridgePods = kubeClient().listPodNames(\"type\", \"kafka-bridge\");\n+        List<String> bridgePods = kubeClient().listPodNames(\"type\", KafkaBridge.RESOURCE_KIND);", "originalCommit": "f0c710d2761c63ebab64c18526b63038846a673f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTUzODQ3Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3517#discussion_r471538477", "bodyText": "discussed offline, misunderstanding", "author": "im-konge", "createdAt": "2020-08-17T14:59:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTUzMjg5NA=="}], "type": "inlineReview", "revised_code": {"commit": "6763fa0650c962a6a75cf09a705ed11d794bde7c", "chunk": "diff --git a/systemtest/src/test/java/io/strimzi/systemtest/bridge/HttpBridgeST.java b/systemtest/src/test/java/io/strimzi/systemtest/bridge/HttpBridgeST.java\nindex d143e71ad4..b55ebb89b5 100644\n--- a/systemtest/src/test/java/io/strimzi/systemtest/bridge/HttpBridgeST.java\n+++ b/systemtest/src/test/java/io/strimzi/systemtest/bridge/HttpBridgeST.java\n\n@@ -228,7 +229,7 @@ class HttpBridgeST extends HttpBridgeAbstractST {\n \n         KafkaBridgeResource.kafkaBridge(bridgeName, KafkaResources.plainBootstrapAddress(CLUSTER_NAME), 1).done();\n \n-        List<String> bridgePods = kubeClient().listPodNames(\"type\", KafkaBridge.RESOURCE_KIND);\n+        List<String> bridgePods = kubeClient().listPodNames(Labels.STRIMZI_KIND_LABEL, KafkaBridge.RESOURCE_KIND);\n         String deploymentName = KafkaBridgeResources.deploymentName(bridgeName);\n \n         assertThat(bridgePods.size(), is(1));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTUzMzc5MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3517#discussion_r471533790", "bodyText": "listPods(\"type\", \"kafka-connect-s2i\") vs String RESOURCE_KIND = \"KafkaConnectS2I\";\nje to ok?", "author": "michalxo", "createdAt": "2020-08-17T14:52:18Z", "path": "systemtest/src/test/java/io/strimzi/systemtest/connect/ConnectS2IST.java", "diffHunk": "@@ -234,7 +231,7 @@ void testSecretsWithKafkaConnectS2IWithTlsAndScramShaAuthentication() {\n             .withKafkaUsername(userName)\n             .build();\n \n-        String kafkaConnectS2IPodName = kubeClient().listPods(\"type\", \"kafka-connect-s2i\").get(0).getMetadata().getName();\n+        String kafkaConnectS2IPodName = kubeClient().listPods(\"type\", KafkaConnectS2I.RESOURCE_KIND).get(0).getMetadata().getName();", "originalCommit": "f0c710d2761c63ebab64c18526b63038846a673f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "6763fa0650c962a6a75cf09a705ed11d794bde7c", "chunk": "diff --git a/systemtest/src/test/java/io/strimzi/systemtest/connect/ConnectS2IST.java b/systemtest/src/test/java/io/strimzi/systemtest/connect/ConnectS2IST.java\nindex 782a38055b..831e80f538 100644\n--- a/systemtest/src/test/java/io/strimzi/systemtest/connect/ConnectS2IST.java\n+++ b/systemtest/src/test/java/io/strimzi/systemtest/connect/ConnectS2IST.java\n\n@@ -231,7 +231,7 @@ class ConnectS2IST extends AbstractST {\n             .withKafkaUsername(userName)\n             .build();\n \n-        String kafkaConnectS2IPodName = kubeClient().listPods(\"type\", KafkaConnectS2I.RESOURCE_KIND).get(0).getMetadata().getName();\n+        String kafkaConnectS2IPodName = kubeClient().listPods(Labels.STRIMZI_KIND_LABEL, KafkaConnectS2I.RESOURCE_KIND).get(0).getMetadata().getName();\n         String kafkaConnectS2ILogs = kubeClient().logs(kafkaConnectS2IPodName);\n \n         LOGGER.info(\"Verifying that in KafkaConnect logs not contain ERRORs\");\n"}}, {"oid": "2d69f741a31b47e8c0d95ecd87f9fdca1bf1ad98", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2d69f741a31b47e8c0d95ecd87f9fdca1bf1ad98", "message": "change resources to contain the type labels\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-08-19T09:14:32Z", "type": "commit"}, {"oid": "6763fa0650c962a6a75cf09a705ed11d794bde7c", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/6763fa0650c962a6a75cf09a705ed11d794bde7c", "message": "change the labeling to strimzi.io/kind\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-08-19T09:14:32Z", "type": "commit"}, {"oid": "f528aa3475208ade075a38b8729f2559ae07cba4", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f528aa3475208ade075a38b8729f2559ae07cba4", "message": "fixes\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-08-19T09:14:32Z", "type": "commit"}, {"oid": "f528aa3475208ade075a38b8729f2559ae07cba4", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f528aa3475208ade075a38b8729f2559ae07cba4", "message": "fixes\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-08-19T09:14:32Z", "type": "forcePushed"}]}