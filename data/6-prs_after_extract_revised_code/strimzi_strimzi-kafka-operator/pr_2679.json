{"pr_number": 2679, "pr_title": "[systemtest] Add asserts for checking java options in EO", "pr_createdAt": "2020-03-10T14:40:08Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2679", "timeline": [{"oid": "bacacb77b4027d73a869409fad65a46db240efff", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/bacacb77b4027d73a869409fad65a46db240efff", "message": "add checks for java options\n\nSigned-off-by: Lukas Kral <lkral@redhat.com>", "committedDate": "2020-03-10T14:37:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQwMTQ4MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2679#discussion_r390401481", "bodyText": "Maybe this looks simpler\nString value = container.getEnv().stream().filter(envVar ->\n                        envVar.getName().equals(\"STRIMZI_JAVA_SYSTEM_PROPERTIES\")).findFirst().get().getValue();", "author": "sknot-rh", "createdAt": "2020-03-10T15:28:40Z", "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "diffHunk": "@@ -771,6 +783,16 @@ void testJvmAndResources() {\n         assertResources(cmdKubeClient().namespace(), pod.get().getMetadata().getName(), \"user-operator\",\n                 \"512M\", \"300m\", \"256M\", \"300m\");\n \n+        String eoPod = eoPods.keySet().toArray()[0].toString();\n+        kubeClient().getPod(eoPod).getSpec().getContainers().forEach(container -> {\n+            if (!container.getName().equals(\"tls-sidecar\")) {\n+                LOGGER.info(\"Check if -D java options are present in {}\", container.getName());\n+                String value = container.getEnv().stream().filter(envVar ->\n+                        envVar.getName().equals(\"STRIMZI_JAVA_SYSTEM_PROPERTIES\")).collect(Collectors.toList()).get(0).getValue();\n+                assertThat(value, is(\"-Djavax.net.debug=verbose\"));", "originalCommit": "bacacb77b4027d73a869409fad65a46db240efff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQxMjAyNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2679#discussion_r390412024", "bodyText": "yeah, good point, thanks :)", "author": "im-konge", "createdAt": "2020-03-10T15:42:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQwMTQ4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "8b4c63300821c12dce163b1e22a9003651c547bd", "chunk": "diff --git a/systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java b/systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java\nindex c956ce4a47..b30baffb2c 100644\n--- a/systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java\n+++ b/systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java\n\n@@ -788,7 +788,7 @@ class KafkaST extends BaseST {\n             if (!container.getName().equals(\"tls-sidecar\")) {\n                 LOGGER.info(\"Check if -D java options are present in {}\", container.getName());\n                 String value = container.getEnv().stream().filter(envVar ->\n-                        envVar.getName().equals(\"STRIMZI_JAVA_SYSTEM_PROPERTIES\")).collect(Collectors.toList()).get(0).getValue();\n+                        envVar.getName().equals(\"STRIMZI_JAVA_SYSTEM_PROPERTIES\")).findFirst().get().getValue();\n                 assertThat(value, is(\"-Djavax.net.debug=verbose\"));\n             }\n         });\n"}}, {"oid": "8b4c63300821c12dce163b1e22a9003651c547bd", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8b4c63300821c12dce163b1e22a9003651c547bd", "message": "fixup! add checks for java options\n\nSigned-off-by: Lukas Kral <lkral@redhat.com>", "committedDate": "2020-03-10T15:42:21Z", "type": "commit"}]}