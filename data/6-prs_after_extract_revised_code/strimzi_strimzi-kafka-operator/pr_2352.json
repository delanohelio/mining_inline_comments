{"pr_number": 2352, "pr_title": "Fix user quotas", "pr_createdAt": "2020-01-02T09:22:07Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2352", "timeline": [{"oid": "199239361d55fb1c03753e043acd47e090339abc", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/199239361d55fb1c03753e043acd47e090339abc", "message": "Fix user quotas\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-01-02T09:20:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQxNjAxMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2352#discussion_r362416012", "bodyText": "createUserJson() constructs some JsonNode and then serializes it to a String, which you're passing to readTree. I think you should instead factor a method out of createUserJson() which will return the JsonNode, and call that method directly here, avoiding the need to use readTree().", "author": "tombentley", "createdAt": "2020-01-02T09:48:33Z", "path": "user-operator/src/main/java/io/strimzi/operator/user/operator/KafkaUserQuotasOperator.java", "diffHunk": "@@ -77,7 +77,7 @@ public void createOrUpdate(String username, KafkaUserQuotas quotas) {\n             JsonNode diff = null;\n             try {\n                 ObjectMapper objectMapper = new ObjectMapper();\n-                diff = JsonDiff.asJson(objectMapper.readTree(data), objectMapper.readTree(quotas.toString()));\n+                diff = JsonDiff.asJson(objectMapper.readTree(data), objectMapper.readTree(createUserJson(quotas)));", "originalCommit": "199239361d55fb1c03753e043acd47e090339abc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ0MTkxOA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2352#discussion_r362441918", "bodyText": "Looks like this is a mixture of vertx and jackson APIs, so it's fine for now.", "author": "tombentley", "createdAt": "2020-01-02T11:23:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQxNjAxMg=="}], "type": "inlineReview", "revised_code": null}]}