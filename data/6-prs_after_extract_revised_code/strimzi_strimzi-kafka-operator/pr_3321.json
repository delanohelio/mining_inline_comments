{"pr_number": 3321, "pr_title": "ST: Add test to cover labels and annotations for user secrets", "pr_createdAt": "2020-07-15T08:36:14Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3321", "timeline": [{"oid": "e07288e235d57647c0c0ab54dc035ab534eaaf23", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e07288e235d57647c0c0ab54dc035ab534eaaf23", "message": "Add test to cover labels and annotations for user secrets\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-07-15T08:29:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkwNDk5OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3321#discussion_r454904998", "bodyText": "I think that in general it is better to use different keys and values - that way the test can make sure that the code doesn't not use the the other way around for example.", "author": "scholzj", "createdAt": "2020-07-15T09:06:43Z", "path": "systemtest/src/test/java/io/strimzi/systemtest/operators/user/UserST.java", "diffHunk": "@@ -148,6 +149,27 @@ void testScramUserWithQuotas() {\n         testUserWithQuotas(KafkaUserResource.scramShaUser(CLUSTER_NAME, \"scramed-arnost\").done());\n     }\n \n+    @Test\n+    void testUserTemplate() {\n+        String label = \"test-label\";\n+        String annotation = \"test-annotation\";\n+        KafkaUserResource.tlsUser(CLUSTER_NAME, USER_NAME)\n+            .editSpec()\n+                .editOrNewTemplate()\n+                    .editOrNewSecret()\n+                        .editOrNewMetadata()\n+                            .addToLabels(label, label)\n+                            .addToAnnotations(annotation, annotation)", "originalCommit": "e07288e235d57647c0c0ab54dc035ab534eaaf23", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "15d16f4310f16dfcbc3b4f4933d328aae11d70aa", "chunk": "diff --git a/systemtest/src/test/java/io/strimzi/systemtest/operators/user/UserST.java b/systemtest/src/test/java/io/strimzi/systemtest/operators/user/UserST.java\nindex b6952e2541..531ee242d4 100644\n--- a/systemtest/src/test/java/io/strimzi/systemtest/operators/user/UserST.java\n+++ b/systemtest/src/test/java/io/strimzi/systemtest/operators/user/UserST.java\n\n@@ -151,23 +151,25 @@ class UserST extends AbstractST {\n \n     @Test\n     void testUserTemplate() {\n-        String label = \"test-label\";\n-        String annotation = \"test-annotation\";\n+        String labelKey = \"test-label-key\";\n+        String labelValue = \"test-label-value\";\n+        String annotationKey = \"test-annotation-key\";\n+        String annotationValue = \"test-annotation-value\";\n         KafkaUserResource.tlsUser(CLUSTER_NAME, USER_NAME)\n             .editSpec()\n                 .editOrNewTemplate()\n                     .editOrNewSecret()\n                         .editOrNewMetadata()\n-                            .addToLabels(label, label)\n-                            .addToAnnotations(annotation, annotation)\n+                            .addToLabels(labelKey, labelValue)\n+                            .addToAnnotations(annotationKey, annotationValue)\n                         .endMetadata()\n                     .endSecret()\n                 .endTemplate()\n             .endSpec().done();\n \n         Secret userSecret = kubeClient().getSecret(USER_NAME);\n-        assertThat(userSecret.getMetadata().getLabels().get(label), is(label));\n-        assertThat(userSecret.getMetadata().getAnnotations().get(annotation), is(annotation));\n+        assertThat(userSecret.getMetadata().getLabels().get(labelKey), is(labelValue));\n+        assertThat(userSecret.getMetadata().getAnnotations().get(annotationKey), is(annotationValue));\n     }\n \n     void testUserWithQuotas(KafkaUser user) {\n"}}, {"oid": "15d16f4310f16dfcbc3b4f4933d328aae11d70aa", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/15d16f4310f16dfcbc3b4f4933d328aae11d70aa", "message": "Comments\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-07-15T09:10:55Z", "type": "commit"}, {"oid": "d78ee286b9b5940bcd185cff4a38cd2dc79a9d40", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d78ee286b9b5940bcd185cff4a38cd2dc79a9d40", "message": "try to fix azure\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-07-15T13:30:39Z", "type": "commit"}, {"oid": "f4df9f3e93fb435cedb5204563d3aafa6b723541", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f4df9f3e93fb435cedb5204563d3aafa6b723541", "message": "fixup! try to fix azure\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-07-15T13:34:34Z", "type": "commit"}, {"oid": "1d5e908732d62a4aac6945bbb1a75ee317e1c458", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1d5e908732d62a4aac6945bbb1a75ee317e1c458", "message": "fixup! fixup! try to fix azure\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-07-15T13:37:19Z", "type": "commit"}, {"oid": "1584d1848ec4dd66ea8db3aea0d9bdb2d2cfe7f9", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1584d1848ec4dd66ea8db3aea0d9bdb2d2cfe7f9", "message": "fixup! fixup! fixup! try to fix azure\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-07-15T13:42:06Z", "type": "commit"}, {"oid": "3d25adddbba9ea0e1be16daca186e6a51275c5cd", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3d25adddbba9ea0e1be16daca186e6a51275c5cd", "message": "fixup! fixup! fixup! fixup! try to fix azure\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-07-15T13:47:50Z", "type": "commit"}, {"oid": "1f7ca7402ad7f300ea268ae3bca192509c050896", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1f7ca7402ad7f300ea268ae3bca192509c050896", "message": "fixup! fixup! fixup! fixup! fixup! try to fix azure\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-07-15T13:53:02Z", "type": "commit"}, {"oid": "de9229521ad9ee11934e27b39df93c60ec3e42bc", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/de9229521ad9ee11934e27b39df93c60ec3e42bc", "message": "fixup! fixup! fixup! fixup! fixup! fixup! try to fix azure\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-07-15T16:52:23Z", "type": "commit"}]}