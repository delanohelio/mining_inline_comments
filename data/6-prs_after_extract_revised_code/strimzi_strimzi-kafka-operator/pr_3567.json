{"pr_number": 3567, "pr_title": "feat: Move probe builders to ProbeGenerator class", "pr_createdAt": "2020-08-30T11:50:42Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3567", "timeline": [{"oid": "391fcbf254bb687be6b0d00eb138d179b5da33b2", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/391fcbf254bb687be6b0d00eb138d179b5da33b2", "message": "feat: Move probe builders to abstractmodel\n\nProbe builders for now belong in abstractmodel\nThis will allow for non static referencing in future\nchanges.\nModelUtils whilst useful is an antipattern that encourages\nlarge code groupings.\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-08-30T11:48:46Z", "type": "commit"}, {"oid": "38237d0303b49bd785807bb7b3029570bab2fa7a", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/38237d0303b49bd785807bb7b3029570bab2fa7a", "message": "feat: ProbeGenerator class\n\nFrom review comments, move logic to new independent class\nwith static constructor method and varying generator methods\nfor repeated calls if necessary.\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-08-30T16:32:59Z", "type": "commit"}, {"oid": "4a8aef63c8c97c0e611624994bc110847ae7f571", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/4a8aef63c8c97c0e611624994bc110847ae7f571", "message": "feat: Re-add static probe creation\n\nThe builders are now part of the underlying implementation\nstatic creators have now been added as a short hand for\nbuilding each of the probe types\n+ added tests\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-08-31T13:09:27Z", "type": "commit"}, {"oid": "20a49fad3b3b4c1f2a4e353a4ddd66d401dfd285", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/20a49fad3b3b4c1f2a4e353a4ddd66d401dfd285", "message": "Merge branch 'master' into move-probe-builders-to-abstractmodel", "committedDate": "2020-08-31T13:18:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM4NDM1MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3567#discussion_r480384350", "bodyText": "This is really what my concern with regards to the memory was. If you are sure it has no impact I'm fine. I admit that  I have no clue how things like memory work in Java or any other language :-o.", "author": "scholzj", "createdAt": "2020-08-31T20:35:46Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/ProbeGenerator.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.operator.cluster.model;\n+\n+import io.fabric8.kubernetes.api.model.ProbeBuilder;\n+import io.strimzi.api.kafka.model.Probe;\n+import io.strimzi.api.kafka.model.TlsSidecar;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+public class ProbeGenerator {\n+\n+    private final Probe probeConfig;\n+\n+    private ProbeGenerator(Probe probeConfig) {\n+        this.probeConfig = probeConfig;\n+    }\n+\n+    public static ProbeGenerator of(Probe probeConfig) {\n+        if (probeConfig == null) {\n+            throw new IllegalArgumentException();\n+        }\n+        return new ProbeGenerator(probeConfig);", "originalCommit": "20a49fad3b3b4c1f2a4e353a4ddd66d401dfd285", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b2b288904f03729da6da4160a6e5ce5d9f0f95c4", "chunk": "diff --git a/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/ProbeGenerator.java b/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/ProbeGenerator.java\nindex 8a7e814dc7..079fc8593a 100644\n--- a/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/ProbeGenerator.java\n+++ b/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/ProbeGenerator.java\n\n@@ -13,25 +13,19 @@ import java.util.List;\n \n public class ProbeGenerator {\n \n-    private final Probe probeConfig;\n-\n-    private ProbeGenerator(Probe probeConfig) {\n-        this.probeConfig = probeConfig;\n-    }\n-\n-    public static ProbeGenerator of(Probe probeConfig) {\n-        if (probeConfig == null) {\n-            throw new IllegalArgumentException();\n-        }\n-        return new ProbeGenerator(probeConfig);\n-    }\n+    private ProbeGenerator() { }\n \n     /**\n      * probeBuilder returns a ProbeBuilder pre-configured with the supplied properties\n      *\n+     * @param probeConfig the initial config for the ProbeBuilder\n      * @return ProbeBuilder\n      */\n-    public ProbeBuilder defaultBuilder() {\n+    public static ProbeBuilder defaultBuilder(Probe probeConfig) {\n+        if (probeConfig == null) {\n+            throw new IllegalArgumentException();\n+        }\n+\n         return new ProbeBuilder()\n                 .withInitialDelaySeconds(probeConfig.getInitialDelaySeconds())\n                 .withTimeoutSeconds(probeConfig.getTimeoutSeconds())\n"}}, {"oid": "b2b288904f03729da6da4160a6e5ce5d9f0f95c4", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b2b288904f03729da6da4160a6e5ce5d9f0f95c4", "message": "chore: Remove field and constructor\n\nRemoved as never useful\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-09-02T08:47:25Z", "type": "commit"}, {"oid": "e0ba1020c2a18d209f64651eab7cf29ecdc8b11a", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e0ba1020c2a18d209f64651eab7cf29ecdc8b11a", "message": "Merge branch 'move-probe-builders-to-abstractmodel' of https://github.com/samuel-hawker/strimzi-kafka-operator into move-probe-builders-to-abstractmodel", "committedDate": "2020-09-02T08:48:53Z", "type": "commit"}]}