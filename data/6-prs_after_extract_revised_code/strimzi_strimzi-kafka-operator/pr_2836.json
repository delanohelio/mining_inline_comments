{"pr_number": 2836, "pr_title": "[systemtest] Update KafkaST's testLabelsAndAnnotationForPVC", "pr_createdAt": "2020-04-15T12:29:01Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2836", "timeline": [{"oid": "8b21075387897f25f74821155ef6e66681314d31", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8b21075387897f25f74821155ef6e66681314d31", "message": "add kubernetes labels to statefulset\n\nSigned-off-by: Lukas Kral <lkral@redhat.com>", "committedDate": "2020-04-15T12:20:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgxMDEwMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2836#discussion_r408810103", "bodyText": "Does this work? I thought that the app.kubernetes.io/managed-by should not be configurable by user.", "author": "scholzj", "createdAt": "2020-04-15T12:40:34Z", "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "diffHunk": "@@ -2064,6 +2073,12 @@ void testLabelsAndAnnotationForPVC() {\n             .endSpec()\n             .done();\n \n+        LOGGER.info(\"Check if Kubernetes labels are applied\");\n+        Map<String,String> actualStatefulSetLabels = KafkaResource.kafkaClient().inNamespace(NAMESPACE).withName(CLUSTER_NAME).get()\n+                .getSpec().getKafka().getTemplate().getStatefulset().getMetadata().getLabels();\n+        assertThat(actualStatefulSetLabels, is(statefulSetLabels));", "originalCommit": "8b21075387897f25f74821155ef6e66681314d31", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgxMDk4NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2836#discussion_r408810984", "bodyText": "TBH I found that on Kubernetes website and tried that -> both labels were set", "author": "im-konge", "createdAt": "2020-04-15T12:42:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgxMDEwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgxMTcyNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2836#discussion_r408811724", "bodyText": "@scholzj is it some kind of issue or is it correct?", "author": "im-konge", "createdAt": "2020-04-15T12:43:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODgxMDEwMw=="}], "type": "inlineReview", "revised_code": {"commit": "33c0ed14447e26cdffeaeffedf3a52f34d1ab422", "chunk": "diff --git a/systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java b/systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java\nindex 1120c6062e..e1b6c5b97b 100644\n--- a/systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java\n+++ b/systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java\n\n@@ -2074,9 +2074,9 @@ class KafkaST extends BaseST {\n             .done();\n \n         LOGGER.info(\"Check if Kubernetes labels are applied\");\n-        Map<String,String> actualStatefulSetLabels = KafkaResource.kafkaClient().inNamespace(NAMESPACE).withName(CLUSTER_NAME).get()\n-                .getSpec().getKafka().getTemplate().getStatefulset().getMetadata().getLabels();\n-        assertThat(actualStatefulSetLabels, is(statefulSetLabels));\n+        Map<String, String> actualStatefulSetLabels = kubeClient().getStatefulSet(KafkaResources.kafkaStatefulSetName(CLUSTER_NAME)).getMetadata().getLabels();\n+        assertThat(actualStatefulSetLabels.get(\"app.kubernetes.io/part-of\"), is(\"some-app\"));\n+        assertThat(actualStatefulSetLabels.get(\"app.kubernetes.io/managed-by\"), is(not(\"some-app\")));\n         LOGGER.info(\"Kubernetes labels are correctly set and present\");\n \n         List<PersistentVolumeClaim> pvcs = kubeClient().listPersistentVolumeClaims();\n"}}, {"oid": "33c0ed14447e26cdffeaeffedf3a52f34d1ab422", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/33c0ed14447e26cdffeaeffedf3a52f34d1ab422", "message": "fixup! add kubernetes labels to statefulset\n\nSigned-off-by: Lukas Kral <lkral@redhat.com>", "committedDate": "2020-04-15T18:27:44Z", "type": "commit"}, {"oid": "33c0ed14447e26cdffeaeffedf3a52f34d1ab422", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/33c0ed14447e26cdffeaeffedf3a52f34d1ab422", "message": "fixup! add kubernetes labels to statefulset\n\nSigned-off-by: Lukas Kral <lkral@redhat.com>", "committedDate": "2020-04-15T18:27:44Z", "type": "forcePushed"}]}