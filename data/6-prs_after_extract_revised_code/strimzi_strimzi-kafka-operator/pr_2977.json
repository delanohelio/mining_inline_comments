{"pr_number": 2977, "pr_title": "Try to optimize sizes of some maps and arrays", "pr_createdAt": "2020-05-07T21:20:03Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2977", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg4MTkyNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2977#discussion_r422881924", "bodyText": "This is fine, but it's better still to use the null pattern and allocate a HashMap only when there is an additional property.", "author": "tombentley", "createdAt": "2020-05-11T08:46:44Z", "path": "api/src/main/java/io/strimzi/api/kafka/model/InlineLogging.java", "diffHunk": "@@ -27,7 +27,7 @@\n \n     public static final String TYPE_INLINE = \"inline\";\n \n-    private Map<String, String> loggers = new HashMap<>();\n+    private Map<String, String> loggers = new HashMap<>(0);", "originalCommit": "967bd59d88a6dbe7a9415797d80563bad1e41a61", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8218ede6d3cdd47c16f04aa7a351a9c3d8ba1c4b", "chunk": "diff --git a/api/src/main/java/io/strimzi/api/kafka/model/InlineLogging.java b/api/src/main/java/io/strimzi/api/kafka/model/InlineLogging.java\nindex 2db0e2b985..339e2e68e6 100644\n--- a/api/src/main/java/io/strimzi/api/kafka/model/InlineLogging.java\n+++ b/api/src/main/java/io/strimzi/api/kafka/model/InlineLogging.java\n\n@@ -27,7 +27,7 @@ public class InlineLogging extends Logging {\n \n     public static final String TYPE_INLINE = \"inline\";\n \n-    private Map<String, String> loggers = new HashMap<>(0);\n+    private Map<String, String> loggers = null;\n \n     @Description(\"Must be `\" + TYPE_INLINE + \"`\")\n     @Override\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg4MzA1OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2977#discussion_r422883059", "bodyText": "New, not Mew \ud83d\udc31", "author": "tombentley", "createdAt": "2020-05-11T08:48:38Z", "path": "operator-common/src/main/java/io/strimzi/operator/cluster/model/Ca.java", "diffHunk": "@@ -352,11 +352,12 @@ public CertAndKey generateSignedCert(String commonName, String organization) thr\n         File brokerCertFile = File.createTempFile(\"tls\", \"broker-cert\");\n         File brokerKeyStoreFile = File.createTempFile(\"tls\", \"broker-p12\");\n \n-        Map<String, CertAndKey> certs = new HashMap<>();\n+        int replicasInMewSecret = Math.min(replicasInSecret, replicas);", "originalCommit": "967bd59d88a6dbe7a9415797d80563bad1e41a61", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8218ede6d3cdd47c16f04aa7a351a9c3d8ba1c4b", "chunk": "diff --git a/operator-common/src/main/java/io/strimzi/operator/cluster/model/Ca.java b/operator-common/src/main/java/io/strimzi/operator/cluster/model/Ca.java\nindex 2812b82a4e..c3444d7f45 100644\n--- a/operator-common/src/main/java/io/strimzi/operator/cluster/model/Ca.java\n+++ b/operator-common/src/main/java/io/strimzi/operator/cluster/model/Ca.java\n\n@@ -352,12 +352,12 @@ public abstract class Ca {\n         File brokerCertFile = File.createTempFile(\"tls\", \"broker-cert\");\n         File brokerKeyStoreFile = File.createTempFile(\"tls\", \"broker-p12\");\n \n-        int replicasInMewSecret = Math.min(replicasInSecret, replicas);\n-        Map<String, CertAndKey> certs = new HashMap<>(replicasInMewSecret);\n+        int replicasInNewSecret = Math.min(replicasInSecret, replicas);\n+        Map<String, CertAndKey> certs = new HashMap<>(replicasInNewSecret);\n         // copying the minimum number of certificates already existing in the secret\n         // scale up -> it will copy all certificates\n         // scale down -> it will copy just the requested number of replicas\n-        for (int i = 0; i < replicasInMewSecret; i++) {\n+        for (int i = 0; i < replicasInNewSecret; i++) {\n             String podName = podNameFn.apply(i);\n             log.debug(\"Certificate for {} already exists\", podName);\n             Subject subject = subjectFn.apply(i);\n"}}, {"oid": "51497135eb4d00fd80eddd9079b0a55a88c3b957", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/51497135eb4d00fd80eddd9079b0a55a88c3b957", "message": "Try to optimize sizes of some maps and arrays\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-05-11T14:14:36Z", "type": "commit"}, {"oid": "f18005f34285d10793c41c72db498a3ffc5edfd1", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f18005f34285d10793c41c72db498a3ffc5edfd1", "message": "Fix API tests caused by wrong fields\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-05-11T14:14:36Z", "type": "commit"}, {"oid": "76e1aa630b4f2d438302ab94cadde95cd801e873", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/76e1aa630b4f2d438302ab94cadde95cd801e873", "message": "Fix some more tests\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-05-11T14:14:36Z", "type": "commit"}, {"oid": "8218ede6d3cdd47c16f04aa7a351a9c3d8ba1c4b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8218ede6d3cdd47c16f04aa7a351a9c3d8ba1c4b", "message": "Review comments\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-05-11T14:14:36Z", "type": "commit"}, {"oid": "8218ede6d3cdd47c16f04aa7a351a9c3d8ba1c4b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8218ede6d3cdd47c16f04aa7a351a9c3d8ba1c4b", "message": "Review comments\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-05-11T14:14:36Z", "type": "forcePushed"}, {"oid": "87e148387cd490c021a788d78a1c8b8e815c65c2", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/87e148387cd490c021a788d78a1c8b8e815c65c2", "message": "Fix import\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-05-11T14:28:38Z", "type": "commit"}, {"oid": "7e510c39d580a8a6038fdf89a3db83b719741ce6", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7e510c39d580a8a6038fdf89a3db83b719741ce6", "message": "Fix tests\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-05-11T16:14:34Z", "type": "commit"}]}