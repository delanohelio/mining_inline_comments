{"pr_number": 3283, "pr_title": "[systemtest] Add tests for checking tini and KafkaConnectS2I logging", "pr_createdAt": "2020-07-03T21:46:23Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3283", "timeline": [{"oid": "0b974df84f23b34e9375ade4015498b65eb54766", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/0b974df84f23b34e9375ade4015498b65eb54766", "message": "add tests for checking log setting and tini in pod containers\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-07-03T21:41:00Z", "type": "commit"}, {"oid": "3ff52d289b74d0faf3352bbf4ba408f3ee2656ff", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3ff52d289b74d0faf3352bbf4ba408f3ee2656ff", "message": "add checks to more tests\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-07-03T22:09:14Z", "type": "commit"}, {"oid": "5170ba96588eac6ae9456e267f2df07a92fedfa2", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/5170ba96588eac6ae9456e267f2df07a92fedfa2", "message": "fixup! add checks to more tests\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-07-03T22:34:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5OTU4NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3283#discussion_r449799584", "bodyText": "testCheckContainersHaveProcessOneAsTini", "author": "samuel-hawker", "createdAt": "2020-07-04T19:35:08Z", "path": "systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java", "diffHunk": "@@ -318,6 +334,28 @@ void testKubectlGetStrimzi() {\n         assertThat(strimziCRs, containsString(topicName));\n     }\n \n+    @Test\n+    @Order(14)\n+    void checkPodsAndContainersForTiniProcess() {", "originalCommit": "5170ba96588eac6ae9456e267f2df07a92fedfa2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5eb9be203fc27ad693408a071ae8552b8bfc62e3", "chunk": "diff --git a/systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java b/systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java\nindex 5a7444df34..7d50f3d1cf 100644\n--- a/systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java\n+++ b/systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java\n\n@@ -336,12 +335,8 @@ class LogSettingST extends BaseST {\n \n     @Test\n     @Order(14)\n-    void checkPodsAndContainersForTiniProcess() {\n-        /*\n-        Reason why I used [/] in my grep command is, that when we only do 'grep /usr/bin/tini' the grep process will be printed\n-        with the tini process, if we do the [/], it will take only the process that will continue with usr/bin/tini and exclude\n-        the grep process. Second choice is adding the `grep -v 'grep /usr/bin/tini'`.\n-         */\n+    void testCheckContainersHaveProcessOneAsTini() {\n+        //Used [/] in the grep command so that grep process does not return itself\n         String command = \"ps -ef | grep '[/]usr/bin/tini' | awk '{ print $2}'\";\n \n         for (Pod pod : kubeClient().listPods()) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5OTkzOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3283#discussion_r449799939", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Reason why I used [/] in my grep command is, that when we only do 'grep /usr/bin/tini' the grep process will be printed\n          \n          \n            \n                    with the tini process, if we do the [/], it will take only the process that will continue with usr/bin/tini and exclude\n          \n          \n            \n                    the grep process. Second choice is adding the `grep -v 'grep /usr/bin/tini'`.\n          \n          \n            \n                     */\n          \n          \n            \n                    String command = \"ps -ef | grep '[/]usr/bin/tini' | awk '{ print $2}'\";\n          \n          \n            \n                     Used [/] in the grep command so that grep process does not return itself \n          \n          \n            \n                     */\n          \n          \n            \n                    String tiniProcessGetCommand = \"ps -ef | grep '[/]usr/bin/tini' | awk '{ print $2}'\";", "author": "samuel-hawker", "createdAt": "2020-07-04T19:40:11Z", "path": "systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java", "diffHunk": "@@ -318,6 +334,28 @@ void testKubectlGetStrimzi() {\n         assertThat(strimziCRs, containsString(topicName));\n     }\n \n+    @Test\n+    @Order(14)\n+    void checkPodsAndContainersForTiniProcess() {\n+        /*\n+        Reason why I used [/] in my grep command is, that when we only do 'grep /usr/bin/tini' the grep process will be printed\n+        with the tini process, if we do the [/], it will take only the process that will continue with usr/bin/tini and exclude\n+        the grep process. Second choice is adding the `grep -v 'grep /usr/bin/tini'`.\n+         */\n+        String command = \"ps -ef | grep '[/]usr/bin/tini' | awk '{ print $2}'\";", "originalCommit": "5170ba96588eac6ae9456e267f2df07a92fedfa2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5eb9be203fc27ad693408a071ae8552b8bfc62e3", "chunk": "diff --git a/systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java b/systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java\nindex 5a7444df34..7d50f3d1cf 100644\n--- a/systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java\n+++ b/systemtest/src/test/java/io/strimzi/systemtest/log/LogSettingST.java\n\n@@ -336,12 +335,8 @@ class LogSettingST extends BaseST {\n \n     @Test\n     @Order(14)\n-    void checkPodsAndContainersForTiniProcess() {\n-        /*\n-        Reason why I used [/] in my grep command is, that when we only do 'grep /usr/bin/tini' the grep process will be printed\n-        with the tini process, if we do the [/], it will take only the process that will continue with usr/bin/tini and exclude\n-        the grep process. Second choice is adding the `grep -v 'grep /usr/bin/tini'`.\n-         */\n+    void testCheckContainersHaveProcessOneAsTini() {\n+        //Used [/] in the grep command so that grep process does not return itself\n         String command = \"ps -ef | grep '[/]usr/bin/tini' | awk '{ print $2}'\";\n \n         for (Pod pod : kubeClient().listPods()) {\n"}}, {"oid": "1858d884d7c436e2e7477236053e4fc77a940644", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1858d884d7c436e2e7477236053e4fc77a940644", "message": "fix method for connects2i\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-07-07T10:02:13Z", "type": "commit"}, {"oid": "5eb9be203fc27ad693408a071ae8552b8bfc62e3", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/5eb9be203fc27ad693408a071ae8552b8bfc62e3", "message": "comment\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>", "committedDate": "2020-07-07T10:06:22Z", "type": "commit"}]}