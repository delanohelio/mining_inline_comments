{"pr_number": 2534, "pr_title": "feat: Refactor tests to use pre-defined constants", "pr_createdAt": "2020-02-11T11:57:02Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2534", "timeline": [{"oid": "d4f9f004624d277e3e2f4518a56cdb2e303f5ad3", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d4f9f004624d277e3e2f4518a56cdb2e303f5ad3", "message": "feat: Checking in\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-02-07T23:40:23Z", "type": "commit"}, {"oid": "d434e4e251d3239fe34b5f69e42f526da6e1a97c", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d434e4e251d3239fe34b5f69e42f526da6e1a97c", "message": "feat: More test fixes\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-02-08T18:10:25Z", "type": "commit"}, {"oid": "2c55511d897fdb2e4a8d5d87568f990d63a79579", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2c55511d897fdb2e4a8d5d87568f990d63a79579", "message": "feat: Checking in\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-02-10T11:16:02Z", "type": "commit"}, {"oid": "ee04175e70b015e7920356a2ece9471df3359fa3", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ee04175e70b015e7920356a2ece9471df3359fa3", "message": "feat: Move annotations\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-02-10T20:15:13Z", "type": "commit"}, {"oid": "7db1509c4b9f56de53d96708d8a28a692e2d0c47", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7db1509c4b9f56de53d96708d8a28a692e2d0c47", "message": "feat: Final tests\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-02-10T21:07:11Z", "type": "commit"}, {"oid": "13ea4b03d98d57dcccbf4a76a7524fae8dc27f91", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/13ea4b03d98d57dcccbf4a76a7524fae8dc27f91", "message": "chore: Revert changes to check tests\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-02-11T11:21:35Z", "type": "commit"}, {"oid": "ddbfe869bdcaba2ccbf6514bcf5a60d51fd7963b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ddbfe869bdcaba2ccbf6514bcf5a60d51fd7963b", "message": "Merge branch 'master' into test-refactor", "committedDate": "2020-02-12T14:51:14Z", "type": "commit"}, {"oid": "152a08d755644bdcf0b6a75915d113882710f271", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/152a08d755644bdcf0b6a75915d113882710f271", "message": "Merge branch 'master' into test-refactor", "committedDate": "2020-02-18T13:16:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDk1MjU1Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2534#discussion_r380952556", "bodyText": "I do not see any changes in ClusterOperator. Which I guess means that the strimzi.io is still hardcoded there as:\npublic static final String STRIMZI_CLUSTER_OPERATOR_DOMAIN = \"cluster.operator.strimzi.io\";\n\nwhich should be probably changed? Or did I missed this change somewhere in this PR?", "author": "scholzj", "createdAt": "2020-02-18T21:43:12Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java", "diffHunk": "@@ -96,11 +97,11 @@\n     public static final String ENV_VAR_STRIMZI_JAVA_SYSTEM_PROPERTIES = \"STRIMZI_JAVA_SYSTEM_PROPERTIES\";\n     public static final String ENV_VAR_STRIMZI_GC_LOG_ENABLED = \"STRIMZI_GC_LOG_ENABLED\";\n \n-    public static final String ANNO_STRIMZI_IO_DELETE_CLAIM = Annotations.STRIMZI_DOMAIN + \"/delete-claim\";\n+    public static final String ANNO_STRIMZI_IO_DELETE_CLAIM = Annotations.STRIMZI_DOMAIN + \"delete-claim\";\n     /** Annotation on PVCs storing the original configuration (so we can revert changes). */\n-    public static final String ANNO_STRIMZI_IO_STORAGE = Annotations.STRIMZI_DOMAIN + \"/storage\";\n+    public static final String ANNO_STRIMZI_IO_STORAGE = Annotations.STRIMZI_DOMAIN + \"storage\";\n     @Deprecated\n-    public static final String ANNO_CO_STRIMZI_IO_DELETE_CLAIM = \"cluster.operator.strimzi.io/delete-claim\";\n+    public static final String ANNO_CO_STRIMZI_IO_DELETE_CLAIM = ClusterOperator.STRIMZI_CLUSTER_OPERATOR_DOMAIN + \"/delete-claim\";", "originalCommit": "152a08d755644bdcf0b6a75915d113882710f271", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE3Njk0OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2534#discussion_r381176949", "bodyText": "It is still hardcoded there, the string itself is used so infrequently and its relationship to the other strimzi labels was slightly unclear to me.\nFor instance I didn't know if this string was truly dependent on the STRIMZI_DOMAIN, e.g.\npublic static final String STRIMZI_CLUSTER_OPERATOR_DOMAIN = \"cluster.operator.\" + Labels.STRIMZI_DOMAIN;\n\nif you are happy to confirm the relationship is as above, then I am happy to modify it. :)", "author": "samuel-hawker", "createdAt": "2020-02-19T09:41:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDk1MjU1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjUzNTg5MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2534#discussion_r382535891", "bodyText": "Just to add it is only in used in one place\n    @Deprecated\n    public static final String ANNO_CO_STRIMZI_IO_DELETE_CLAIM = \"cluster.operator.strimzi.io/delete-claim\";\n\nI also noted this string is deprecated, so though we could change it, I would argue that since it is probably going to be removed, defining its relationship to the rest of the Strimzi Labels might not be needed. Do you have any thoughts on this?", "author": "samuel-hawker", "createdAt": "2020-02-21T11:36:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDk1MjU1Ng=="}], "type": "inlineReview", "revised_code": {"commit": "85e5bf20911be295626dcdfdf0b0659cb2f127a1", "chunk": "diff --git a/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java b/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java\nindex d8e6c61424..c63e864fcb 100644\n--- a/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java\n+++ b/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java\n\n@@ -103,7 +103,7 @@ public abstract class AbstractModel {\n     @Deprecated\n     public static final String ANNO_CO_STRIMZI_IO_DELETE_CLAIM = ClusterOperator.STRIMZI_CLUSTER_OPERATOR_DOMAIN + \"/delete-claim\";\n \n-    public static final String ANNO_STRIMZI_CM_GENERATION = Annotations.STRIMZI_DOMAIN + \"/cm-generation\";\n+    public static final String ANNO_STRIMZI_CM_GENERATION = Annotations.STRIMZI_DOMAIN + \"cm-generation\";\n \n     protected final String cluster;\n     protected final String namespace;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE0OTAwMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2534#discussion_r381149003", "bodyText": "I guess this also needs to be changed to avoid //.", "author": "tombentley", "createdAt": "2020-02-19T08:49:38Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java", "diffHunk": "@@ -96,11 +97,11 @@\n     public static final String ENV_VAR_STRIMZI_JAVA_SYSTEM_PROPERTIES = \"STRIMZI_JAVA_SYSTEM_PROPERTIES\";\n     public static final String ENV_VAR_STRIMZI_GC_LOG_ENABLED = \"STRIMZI_GC_LOG_ENABLED\";\n \n-    public static final String ANNO_STRIMZI_IO_DELETE_CLAIM = Annotations.STRIMZI_DOMAIN + \"/delete-claim\";\n+    public static final String ANNO_STRIMZI_IO_DELETE_CLAIM = Annotations.STRIMZI_DOMAIN + \"delete-claim\";\n     /** Annotation on PVCs storing the original configuration (so we can revert changes). */\n-    public static final String ANNO_STRIMZI_IO_STORAGE = Annotations.STRIMZI_DOMAIN + \"/storage\";\n+    public static final String ANNO_STRIMZI_IO_STORAGE = Annotations.STRIMZI_DOMAIN + \"storage\";\n     @Deprecated\n-    public static final String ANNO_CO_STRIMZI_IO_DELETE_CLAIM = \"cluster.operator.strimzi.io/delete-claim\";\n+    public static final String ANNO_CO_STRIMZI_IO_DELETE_CLAIM = ClusterOperator.STRIMZI_CLUSTER_OPERATOR_DOMAIN + \"/delete-claim\";\n \n     public static final String ANNO_STRIMZI_CM_GENERATION = Annotations.STRIMZI_DOMAIN + \"/cm-generation\";", "originalCommit": "152a08d755644bdcf0b6a75915d113882710f271", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE4NjI3Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2534#discussion_r381186272", "bodyText": "Fixed, good spot, sorry this somehow got missed.", "author": "samuel-hawker", "createdAt": "2020-02-19T09:56:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE0OTAwMw=="}], "type": "inlineReview", "revised_code": {"commit": "85e5bf20911be295626dcdfdf0b0659cb2f127a1", "chunk": "diff --git a/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java b/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java\nindex d8e6c61424..c63e864fcb 100644\n--- a/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java\n+++ b/cluster-operator/src/main/java/io/strimzi/operator/cluster/model/AbstractModel.java\n\n@@ -103,7 +103,7 @@ public abstract class AbstractModel {\n     @Deprecated\n     public static final String ANNO_CO_STRIMZI_IO_DELETE_CLAIM = ClusterOperator.STRIMZI_CLUSTER_OPERATOR_DOMAIN + \"/delete-claim\";\n \n-    public static final String ANNO_STRIMZI_CM_GENERATION = Annotations.STRIMZI_DOMAIN + \"/cm-generation\";\n+    public static final String ANNO_STRIMZI_CM_GENERATION = Annotations.STRIMZI_DOMAIN + \"cm-generation\";\n \n     protected final String cluster;\n     protected final String namespace;\n"}}, {"oid": "85e5bf20911be295626dcdfdf0b0659cb2f127a1", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/85e5bf20911be295626dcdfdf0b0659cb2f127a1", "message": "fix: Remove typo slash\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-02-19T09:45:45Z", "type": "commit"}, {"oid": "739a92e7b3a13ed6d69d0734045d03d199ab4761", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/739a92e7b3a13ed6d69d0734045d03d199ab4761", "message": "Merge branch 'master' into test-refactor", "committedDate": "2020-02-19T09:57:57Z", "type": "commit"}, {"oid": "a646998b3ce49c2302fec054a30a9c31f02e8260", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a646998b3ce49c2302fec054a30a9c31f02e8260", "message": "Merge branch 'master' into test-refactor", "committedDate": "2020-02-23T16:36:23Z", "type": "commit"}, {"oid": "050ee77c2e5afe4b9f82b08a6fca233c44ac7afd", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/050ee77c2e5afe4b9f82b08a6fca233c44ac7afd", "message": "Merge branch 'master' into test-refactor", "committedDate": "2020-02-24T20:55:14Z", "type": "commit"}, {"oid": "050ee77c2e5afe4b9f82b08a6fca233c44ac7afd", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/050ee77c2e5afe4b9f82b08a6fca233c44ac7afd", "message": "Merge branch 'master' into test-refactor", "committedDate": "2020-02-24T20:55:14Z", "type": "forcePushed"}]}