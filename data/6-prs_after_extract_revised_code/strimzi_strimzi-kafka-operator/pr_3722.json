{"pr_number": 3722, "pr_title": "Move test for introspection endpoint to make it valuable", "pr_createdAt": "2020-09-29T20:32:05Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3722", "timeline": [{"oid": "d3f85e2ea58a118cef4f9dead4357f065b122253", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d3f85e2ea58a118cef4f9dead4357f065b122253", "message": "Move test for introspection endpoint to make it valuable\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>", "committedDate": "2020-09-29T20:28:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQyNzY4Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3722#discussion_r497427682", "bodyText": "I think I getting your point here. You are using the kafkaReplicas parameter that is dependent on the zookeeperReplicas. Wouldn't be better using some Math.min(kafkaReplicas / 3, 3) meaning if we specify 3 Kafka replicas we will deploy 1 zookeeper instead of 3, which are not needed? WDYT?", "author": "see-quick", "createdAt": "2020-09-30T11:11:59Z", "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/crd/KafkaResource.java", "diffHunk": "@@ -55,7 +55,7 @@ public static DoneableKafka kafkaEphemeral(String name, int kafkaReplicas, int z\n     }\n \n     public static DoneableKafka kafkaPersistent(String name, int kafkaReplicas) {\n-        return kafkaPersistent(name, kafkaReplicas, 3);\n+        return kafkaPersistent(name, kafkaReplicas, Math.min(kafkaReplicas, 3));", "originalCommit": "d3f85e2ea58a118cef4f9dead4357f065b122253", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ0MTk1OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3722#discussion_r497441959", "bodyText": "Well in that case we will need at least 9 brokers to have 3 zk. It doesn't sound me like a good idea. You always can specify zk replicas by third param.", "author": "Frawless", "createdAt": "2020-09-30T11:40:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQyNzY4Mg=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgyOTk0Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3722#discussion_r497829946", "bodyText": "Why are we using the min(...) here and on line 58? I think it deserves some explanation.", "author": "scholzj", "createdAt": "2020-09-30T22:11:32Z", "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/crd/KafkaResource.java", "diffHunk": "@@ -46,7 +46,7 @@\n     }\n \n     public static DoneableKafka kafkaEphemeral(String name, int kafkaReplicas) {\n-        return kafkaEphemeral(name, kafkaReplicas, 3);\n+        return kafkaEphemeral(name, kafkaReplicas, Math.min(kafkaReplicas, 3));", "originalCommit": "d3f85e2ea58a118cef4f9dead4357f065b122253", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzk5NjM0Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3722#discussion_r497996346", "bodyText": "AFAIK, It is because sometimes, we deploy Kafka cluster with only 1 Kafka broker and if we don't specify zookeeper replicas it will create the cluster with 1 Kafka and 3 zookeepers. So, for instance. with this change we will deploy only 1 Kafka and 1 zookeeper.", "author": "see-quick", "createdAt": "2020-10-01T05:46:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgyOTk0Ng=="}], "type": "inlineReview", "revised_code": null}]}