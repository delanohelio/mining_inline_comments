{"pr_number": 6609, "pr_title": "Fixed interval summary files being empty in DepthOfCoverage", "pr_createdAt": "2020-05-18T20:59:53Z", "pr_url": "https://github.com/broadinstitute/gatk/pull/6609", "timeline": [{"oid": "8c0c803fe96576efaeb5772471cc996e1ac42b80", "url": "https://github.com/broadinstitute/gatk/commit/8c0c803fe96576efaeb5772471cc996e1ac42b80", "message": "Remember kids, always add tests for empty files in your test suite or you end up missing something important", "committedDate": "2020-05-18T20:58:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg5MTUyNA==", "url": "https://github.com/broadinstitute/gatk/pull/6609#discussion_r426891524", "bodyText": "Ah, heh.", "author": "lbergelson", "createdAt": "2020-05-18T21:02:39Z", "path": "src/test/java/org/broadinstitute/hellbender/tools/walkers/coverage/DepthOfCoverageIntegrationTest.java", "diffHunk": "@@ -256,6 +256,11 @@ private void compareLinesByColumn(File actualFile, File expectedFile, List<Strin\n                 }\n             }\n         }\n+        if (actualLines.hasNext()) {\n+            Assert.fail(\"Finished parsing expected file and found lines remaining in the actual file  \"+actualFile.getName());", "originalCommit": "8c0c803fe96576efaeb5772471cc996e1ac42b80", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg5MTg0OA==", "url": "https://github.com/broadinstitute/gatk/pull/6609#discussion_r426891848", "bodyText": "This seems like a fairly significant bug... did no one ever look at the output file? or are there multiple?", "author": "lbergelson", "createdAt": "2020-05-18T21:03:21Z", "path": "src/main/java/org/broadinstitute/hellbender/tools/walkers/coverage/DepthOfCoverage.java", "diffHunk": "@@ -345,6 +345,7 @@ public void onIntervalEnd(final Locatable activeInterval) {\n                 for (DoCOutputType.Partition p : partitionTypes) {\n                     // Write the per-interval depth information as necessary\n                     final DepthOfCoverageStats coverageByAggregationPartitionType = partitionerToRemove.getCoverageByAggregationType(p);\n+                    writer.writePerIntervalDepthInformation(p, (SimpleInterval) activeInterval, coverageByAggregationPartitionType, globalIdentifierMap.get(p));", "originalCommit": "8c0c803fe96576efaeb5772471cc996e1ac42b80", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg5MjY4OQ==", "url": "https://github.com/broadinstitute/gatk/pull/6609#discussion_r426892689", "bodyText": "There are 25 output files for each of these tests, and the one that was checked in was generated correctly before the rebase in question so it was missed. This only affects 4 of the 25 output files from this tool.", "author": "jamesemery", "createdAt": "2020-05-18T21:05:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg5MTg0OA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "87d7b6fabe211878f8b3472f85f72a3f43b6f22f", "url": "https://github.com/broadinstitute/gatk/commit/87d7b6fabe211878f8b3472f85f72a3f43b6f22f", "message": "added another layer of safety", "committedDate": "2020-05-18T21:08:19Z", "type": "commit"}]}