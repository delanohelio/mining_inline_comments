{"pr_number": 8548, "pr_title": "KAFKA-9823: Follow-up, check state for handling commit error response", "pr_createdAt": "2020-04-25T02:46:01Z", "pr_url": "https://github.com/apache/kafka/pull/8548", "timeline": [{"oid": "00e18d34c4e215ea064dae89ac535c3e8f446adc", "url": "https://github.com/apache/kafka/commit/00e18d34c4e215ea064dae89ac535c3e8f446adc", "message": "follow-up", "committedDate": "2020-04-25T02:44:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk5MTAzNA==", "url": "https://github.com/apache/kafka/pull/8548#discussion_r415991034", "bodyText": "Should we update the comment here (and on line 1205)?", "author": "ableegoldman", "createdAt": "2020-04-27T17:05:53Z", "path": "clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java", "diffHunk": "@@ -1231,13 +1235,13 @@ public void handle(OffsetCommitResponse commitResponse, RequestFuture<Void> futu\n \n                             // only need to reset generation and re-join group if generation has not changed;\n                             // otherwise only raise rebalance-in-progress error", "originalCommit": "00e18d34c4e215ea064dae89ac535c3e8f446adc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "70d35ac0310646fee0c441b965dda4ca97052e2f", "chunk": "diff --git a/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java b/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java\nindex 8c47426b05..914071bb38 100644\n--- a/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java\n+++ b/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java\n\n@@ -1233,7 +1233,7 @@ public final class ConsumerCoordinator extends AbstractCoordinator {\n                                 || error == Errors.ILLEGAL_GENERATION) {\n                             log.info(\"OffsetCommit failed with {}: {}\", sentGeneration, error.message());\n \n-                            // only need to reset generation and re-join group if generation has not changed;\n+                            // only need to reset generation and re-join group if generation has not changed or we are not in rebalancing;\n                             // otherwise only raise rebalance-in-progress error\n                             if (!generationUnchanged() && ConsumerCoordinator.this.state == MemberState.REBALANCING) {\n                                 future.raise(new RebalanceInProgressException(\"Offset commit cannot be completed since the \" +\n"}}, {"oid": "97bb83b023335b8d1d073f1d01e13d156e3e3e64", "url": "https://github.com/apache/kafka/commit/97bb83b023335b8d1d073f1d01e13d156e3e3e64", "message": "Merge branch 'trunk' of https://github.com/apache/kafka into K9823-follow-up", "committedDate": "2020-04-28T00:11:43Z", "type": "commit"}, {"oid": "70d35ac0310646fee0c441b965dda4ca97052e2f", "url": "https://github.com/apache/kafka/commit/70d35ac0310646fee0c441b965dda4ca97052e2f", "message": "github comments", "committedDate": "2020-04-28T00:13:21Z", "type": "commit"}]}