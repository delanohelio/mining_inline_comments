{"pr_number": 8626, "pr_title": "KAFKA-9921: explicit handling of null values with retainDuplicates", "pr_createdAt": "2020-05-06T19:52:03Z", "pr_url": "https://github.com/apache/kafka/pull/8626", "timeline": [{"oid": "c98525450cb40cd062391d1f12077f5d5ce7a3be", "url": "https://github.com/apache/kafka/commit/c98525450cb40cd062391d1f12077f5d5ce7a3be", "message": "add missing test, clarify nulls in jvadocs", "committedDate": "2020-05-06T19:37:34Z", "type": "commit"}, {"oid": "0c223e0faaeaefdc1f361311b41e6dd4b5a3b8f0", "url": "https://github.com/apache/kafka/commit/0c223e0faaeaefdc1f361311b41e6dd4b5a3b8f0", "message": "skip delete with duplicates", "committedDate": "2020-05-06T19:48:24Z", "type": "commit"}, {"oid": "bf73d40632d232592b972653803a679386748307", "url": "https://github.com/apache/kafka/commit/bf73d40632d232592b972653803a679386748307", "message": "add to WindowStore#put docs", "committedDate": "2020-05-08T20:05:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM2MzA1OA==", "url": "https://github.com/apache/kafka/pull/8626#discussion_r422363058", "bodyText": "I would use the 'interpreted' instead of 'treated' to be more consistent with the rest of the javadoc (at least in this file). The behavior is not really due to an optimization and that's not really the point IMO. Also, 'retain duplicates' in the more common term instead of 'allow duplicates'. I would rephrase it to something like this:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * If serialized value bytes are null it is treated as delete. Note that as an optimization, deletes will be\n          \n          \n            \n                 * skipped in the case of an underlying store that allows duplicates.\n          \n          \n            \n                 * If serialized value bytes are null it is treated as delete. Note that deletes will be\n          \n          \n            \n                 * ignored in the case of an underlying store that retains duplicates.", "author": "GeorgiPetkov", "createdAt": "2020-05-08T20:40:59Z", "path": "streams/src/main/java/org/apache/kafka/streams/state/WindowStore.java", "diffHunk": "@@ -57,6 +57,10 @@\n \n     /**\n      * Put a key-value pair into the window with given window start timestamp\n+     * <p>\n+     * If serialized value bytes are null it is treated as delete. Note that as an optimization, deletes will be\n+     * skipped in the case of an underlying store that allows duplicates.", "originalCommit": "bf73d40632d232592b972653803a679386748307", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM2OTMyNg==", "url": "https://github.com/apache/kafka/pull/8626#discussion_r422369326", "bodyText": "lol, I forgot to apply my own suggestion to use 'interpreted', good catch.", "author": "GeorgiPetkov", "createdAt": "2020-05-08T20:54:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM2MzA1OA=="}], "type": "inlineReview", "revised_code": {"commit": "d565d18e3f06f1f4665c273ad7938e9aed4d93dd", "chunk": "diff --git a/streams/src/main/java/org/apache/kafka/streams/state/WindowStore.java b/streams/src/main/java/org/apache/kafka/streams/state/WindowStore.java\nindex 2eab04b194..b5d95f4c98 100644\n--- a/streams/src/main/java/org/apache/kafka/streams/state/WindowStore.java\n+++ b/streams/src/main/java/org/apache/kafka/streams/state/WindowStore.java\n\n@@ -58,8 +58,8 @@ public interface WindowStore<K, V> extends StateStore, ReadOnlyWindowStore<K, V>\n     /**\n      * Put a key-value pair into the window with given window start timestamp\n      * <p>\n-     * If serialized value bytes are null it is treated as delete. Note that as an optimization, deletes will be\n-     * skipped in the case of an underlying store that allows duplicates.\n+     * If serialized value bytes are null it is treated as delete. Note that deletes will be\n+     * ignored in the case of an underlying store that retains duplicates.\n      *\n      * @param key The key to associate the value to\n      * @param value The value; can be null\n"}}, {"oid": "d565d18e3f06f1f4665c273ad7938e9aed4d93dd", "url": "https://github.com/apache/kafka/commit/d565d18e3f06f1f4665c273ad7938e9aed4d93dd", "message": "CR suggestion\n\nCo-authored-by: GeorgiPetkov <gp000077@gmail.com>", "committedDate": "2020-05-08T20:46:46Z", "type": "commit"}, {"oid": "5fbe78afd19250fc5dc1d476967ced6ec3c687d7", "url": "https://github.com/apache/kafka/commit/5fbe78afd19250fc5dc1d476967ced6ec3c687d7", "message": "use ineterpreted", "committedDate": "2020-05-08T20:51:41Z", "type": "commit"}]}