{"pr_number": 8671, "pr_title": "KAFKA-9859 / Add topics generated by KTable FK join to internal topic matching logic", "pr_createdAt": "2020-05-15T08:07:49Z", "pr_url": "https://github.com/apache/kafka/pull/8671", "timeline": [{"oid": "8b6b045f3c0bd6114055211fee4804e4100919e5", "url": "https://github.com/apache/kafka/commit/8b6b045f3c0bd6114055211fee4804e4100919e5", "message": "KAFKA-9859 / kafka-streams-application-reset tool doesn't take into account topics generated by KTable foreign key join operation", "committedDate": "2020-05-15T08:04:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE3MDU1NA==", "url": "https://github.com/apache/kafka/pull/8671#discussion_r426170554", "bodyText": "Not a suggestion comment: now looking at this I think maybe we should not add the -topic suffix for those topics since we did not for repartition and changelog :)", "author": "guozhangwang", "createdAt": "2020-05-16T16:53:30Z", "path": "core/src/main/scala/kafka/tools/StreamsResetter.java", "diffHunk": "@@ -673,11 +673,17 @@ private boolean isInternalTopic(final String topicName) {\n         // Even is this is not expected in general, we need to exclude those topics here\n         // and don't consider them as internal topics even if they follow the same naming schema.\n         // Cf. https://issues.apache.org/jira/browse/KAFKA-7930\n-        return !isInputTopic(topicName) && !isIntermediateTopic(topicName)\n-            && topicName.startsWith(options.valueOf(applicationIdOption) + \"-\")\n-            && (topicName.endsWith(\"-changelog\") || topicName.endsWith(\"-repartition\")\n-                || topicName.endsWith(\"-subscription-registration-topic\")\n-                || topicName.endsWith(\"-subscription-response-topic\"));\n+        return !isInputTopic(topicName) && !isIntermediateTopic(topicName) && topicName.startsWith(options.valueOf(applicationIdOption) + \"-\")\n+               && matchesInternalTopicFormat(topicName);\n+    }\n+\n+    // visible for testing\n+    public boolean matchesInternalTopicFormat(final String topicName) {\n+        return topicName.endsWith(\"-changelog\") || topicName.endsWith(\"-repartition\")\n+               || topicName.endsWith(\"-subscription-registration-topic\")", "originalCommit": "8b6b045f3c0bd6114055211fee4804e4100919e5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}