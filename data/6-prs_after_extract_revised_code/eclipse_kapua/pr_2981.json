{"pr_number": 2981, "pr_title": "Sort order parameter for data messages request", "pr_createdAt": "2020-05-17T15:29:11Z", "pr_url": "https://github.com/eclipse/kapua/pull/2981", "timeline": [{"oid": "8cfc59e61581582f733f25b3ea59b8c02647772e", "url": "https://github.com/eclipse/kapua/commit/8cfc59e61581582f733f25b3ea59b8c02647772e", "message": "Sort order parameter for data messages request\n\nSigned-off-by: Artem Shilin <xshiart@protonmail.com>", "committedDate": "2020-05-17T15:40:23Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUzNjcwNQ==", "url": "https://github.com/eclipse/kapua/pull/2981#discussion_r426536705", "bodyText": "A few of things:\n\nInstead of a String, you could use the SortDirection type itself so it's automatically parsed, and invalid values are rejected earlier. Also, to have it case-insensitive, please implement the fromString() method in SortDirection. You can draw inspiration from #2891\nAlso, for coherence with #2891, I would rather name the parameter sortDir, and the default should be in uppercase\nThis is just a stylistic preference, but I'd like to keep offset and limit to end of the signature, so could you please move sortDir just below metricMax?", "author": "lorthirk", "createdAt": "2020-05-18T10:48:08Z", "path": "rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessages.java", "diffHunk": "@@ -88,7 +93,8 @@\n             @QueryParam(\"metricMin\") String metricMinValue, //\n             @QueryParam(\"metricMax\") String metricMaxValue, //\n             @QueryParam(\"offset\") @DefaultValue(\"0\") int offset,//\n-            @QueryParam(\"limit\") @DefaultValue(\"50\") int limit) throws KapuaException {\n+            @QueryParam(\"limit\") @DefaultValue(\"50\") int limit,\n+            @QueryParam(\"order\") @DefaultValue(\"desc\") String order) throws KapuaException {", "originalCommit": "8cfc59e61581582f733f25b3ea59b8c02647772e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f8b245182a06dde43a5d5569a9ab7044a3fc1db2", "chunk": "diff --git a/rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessages.java b/rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessages.java\nindex 960034a36..3f39c16de 100644\n--- a/rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessages.java\n+++ b/rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessages.java\n\n@@ -92,9 +92,9 @@ public class DataMessages extends AbstractKapuaResource {\n             @QueryParam(\"metricType\") MetricType<V> metricType, //\n             @QueryParam(\"metricMin\") String metricMinValue, //\n             @QueryParam(\"metricMax\") String metricMaxValue, //\n+            @QueryParam(\"sortDir\") @DefaultValue(\"DESC\") SortDirection sortDir, //\n             @QueryParam(\"offset\") @DefaultValue(\"0\") int offset,//\n-            @QueryParam(\"limit\") @DefaultValue(\"50\") int limit,\n-            @QueryParam(\"order\") @DefaultValue(\"desc\") String order) throws KapuaException {\n+            @QueryParam(\"limit\") @DefaultValue(\"50\") int limit) throws KapuaException {\n \n         AndPredicate andPredicate = STORABLE_PREDICATE_FACTORY.newAndPredicate();\n         if (!Strings.isNullOrEmpty(clientId)) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUzODY2Mw==", "url": "https://github.com/eclipse/kapua/pull/2981#discussion_r426538663", "bodyText": "Of course, here you should reflect all the changes from DataMessages.java", "author": "lorthirk", "createdAt": "2020-05-18T10:51:59Z", "path": "rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessagesJson.java", "diffHunk": "@@ -91,7 +91,8 @@\n             @QueryParam(\"metricMin\") String metricMinValue,\n             @QueryParam(\"metricMax\") String metricMaxValue,\n             @QueryParam(\"offset\") @DefaultValue(\"0\") int offset,\n-            @QueryParam(\"limit\") @DefaultValue(\"50\") int limit) throws KapuaException {\n+            @QueryParam(\"limit\") @DefaultValue(\"50\") int limit,\n+            @QueryParam(\"order\") @DefaultValue(\"desc\") String order) throws KapuaException {", "originalCommit": "8cfc59e61581582f733f25b3ea59b8c02647772e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f8b245182a06dde43a5d5569a9ab7044a3fc1db2", "chunk": "diff --git a/rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessagesJson.java b/rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessagesJson.java\nindex 31999ee9c..bf326bb53 100644\n--- a/rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessagesJson.java\n+++ b/rest-api/resources/src/main/java/org/eclipse/kapua/app/api/resources/v1/resources/DataMessagesJson.java\n\n@@ -90,9 +91,9 @@ public class DataMessagesJson extends AbstractKapuaResource implements JsonSeria\n             @QueryParam(\"metricType\") MetricType<V> metricType,\n             @QueryParam(\"metricMin\") String metricMinValue,\n             @QueryParam(\"metricMax\") String metricMaxValue,\n+            @QueryParam(\"sortDir\") @DefaultValue(\"DESC\") SortDirection sortDir,\n             @QueryParam(\"offset\") @DefaultValue(\"0\") int offset,\n-            @QueryParam(\"limit\") @DefaultValue(\"50\") int limit,\n-            @QueryParam(\"order\") @DefaultValue(\"desc\") String order) throws KapuaException {\n+            @QueryParam(\"limit\") @DefaultValue(\"50\") int limit) throws KapuaException {\n \n         MessageListResult result = DATA_MESSAGES.simpleQuery(\n                 scopeId,\n"}}, {"oid": "f8b245182a06dde43a5d5569a9ab7044a3fc1db2", "url": "https://github.com/eclipse/kapua/commit/f8b245182a06dde43a5d5569a9ab7044a3fc1db2", "message": "Sort order parameter for data messages request\n\nSigned-off-by: Artem Shilin <xshiart@protonmail.com>", "committedDate": "2020-05-19T11:14:52Z", "type": "forcePushed"}, {"oid": "754a68ce58eb651b0f5794651e3be36c25f93d3a", "url": "https://github.com/eclipse/kapua/commit/754a68ce58eb651b0f5794651e3be36c25f93d3a", "message": "Sort order parameter for data messages request\n\nSigned-off-by: Artem Shilin <xshiart@protonmail.com>", "committedDate": "2020-05-19T12:38:20Z", "type": "forcePushed"}, {"oid": "f0dada0fcaab0535db3af954a9f9dd57b9111ec9", "url": "https://github.com/eclipse/kapua/commit/f0dada0fcaab0535db3af954a9f9dd57b9111ec9", "message": "Sort order parameter for data messages request\n\nSigned-off-by: Artem Shilin <xshiart@protonmail.com>", "committedDate": "2020-05-19T15:10:57Z", "type": "commit"}, {"oid": "f0dada0fcaab0535db3af954a9f9dd57b9111ec9", "url": "https://github.com/eclipse/kapua/commit/f0dada0fcaab0535db3af954a9f9dd57b9111ec9", "message": "Sort order parameter for data messages request\n\nSigned-off-by: Artem Shilin <xshiart@protonmail.com>", "committedDate": "2020-05-19T15:10:57Z", "type": "forcePushed"}]}