{"pr_number": 6996, "pr_title": "#1253 No longer showing 'Clone Line' action when subtab's table is the same as the document's.", "pr_createdAt": "2020-07-10T10:08:44Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/6996", "timeline": [{"oid": "7ac0f6b9f8bddccab3d0f6c9fd1237b261401a6f", "url": "https://github.com/metasfresh/metasfresh/commit/7ac0f6b9f8bddccab3d0f6c9fd1237b261401a6f", "message": "#1253 No longer showing 'Clone Line' action when subtab's table is the same as the document's.", "committedDate": "2020-07-10T10:07:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc2MjE2OQ==", "url": "https://github.com/metasfresh/metasfresh/pull/6996#discussion_r452762169", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\treturn ProcessPreconditionsResolution.rejectWithInternalReason(\"Same Table as in document in sub-tab, can only have one line.\");\n          \n          \n            \n            \t\t\t// we have e.g. in the C_BPartner-window two subtabs (\"Customer\" and \"Vendor\") that show a different view on the same C_BPartner record. \n          \n          \n            \n            \t\t\t// There, cloning the subtab-line makes no sense\n          \n          \n            \n            \t\t\treturn ProcessPreconditionsResolution.rejectWithInternalReason(\"The main-window has the same Record as the sub-tab, there can only be one line.\");", "author": "metas-ts", "createdAt": "2020-07-10T10:30:19Z", "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/WEBUI_CloneLine.java", "diffHunk": "@@ -73,6 +73,11 @@ public ProcessPreconditionsResolution checkPreconditionsApplicable(final @NonNul\n \t\t{\n \t\t\treturn ProcessPreconditionsResolution.rejectWithInternalReason(\"CopyRecordFactory not enabled for the table the row belongs to.\");\n \t\t}\n+\n+\t\tif (ref.getTableName().equals(context.getTableName()))\n+\t\t{\n+\t\t\treturn ProcessPreconditionsResolution.rejectWithInternalReason(\"Same Table as in document in sub-tab, can only have one line.\");", "originalCommit": "7ac0f6b9f8bddccab3d0f6c9fd1237b261401a6f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "24b676556f1caaa64be91c7684db943c34cb5203", "chunk": "diff --git a/backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/WEBUI_CloneLine.java b/backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/WEBUI_CloneLine.java\nindex e5d2bb3846..928c848b04 100644\n--- a/backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/WEBUI_CloneLine.java\n+++ b/backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/WEBUI_CloneLine.java\n\n@@ -76,7 +76,9 @@ public class WEBUI_CloneLine extends JavaProcess implements IProcessPrecondition\n \n \t\tif (ref.getTableName().equals(context.getTableName()))\n \t\t{\n-\t\t\treturn ProcessPreconditionsResolution.rejectWithInternalReason(\"Same Table as in document in sub-tab, can only have one line.\");\n+\t\t\t// we have e.g. in the C_BPartner-window two subtabs (\"Customer\" and \"Vendor\") that show a different view on the same C_BPartner record. \n+\t\t\t// There, cloning the subtab-line makes no sense\n+\t\t\treturn ProcessPreconditionsResolution.rejectWithInternalReason(\"The main-window has the same Record as the sub-tab, there can only be one line.\");\n \t\t}\n \t\treturn ProcessPreconditionsResolution.accept();\n \t}\n"}}, {"oid": "24b676556f1caaa64be91c7684db943c34cb5203", "url": "https://github.com/metasfresh/metasfresh/commit/24b676556f1caaa64be91c7684db943c34cb5203", "message": "Improve clarity - i hope\r\n\r\nhttps://github.com/metasfresh/metasfresh/pull/6911", "committedDate": "2020-07-10T10:30:57Z", "type": "commit"}]}