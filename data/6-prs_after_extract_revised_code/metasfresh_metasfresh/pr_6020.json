{"pr_number": 6020, "pr_title": "Gh5987 4 ", "pr_createdAt": "2020-01-10T09:14:53Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/6020", "timeline": [{"oid": "f06d5a1a09a75b82250f459a2882fbf72a4bbea0", "url": "https://github.com/metasfresh/metasfresh/commit/f06d5a1a09a75b82250f459a2882fbf72a4bbea0", "message": "#5987 Delete CustomsTariff string column from M_Product\n\nhttps://github.com/metasfresh/metasfresh/issues/5987", "committedDate": "2020-01-09T11:34:27Z", "type": "commit"}, {"oid": "1f85b21b057722aca7c227f6c92219eb8ba44ada", "url": "https://github.com/metasfresh/metasfresh/commit/1f85b21b057722aca7c227f6c92219eb8ba44ada", "message": "#5987 delete C_Customs_Invoice_ID from M_InOut\n\nhttps://github.com/metasfresh/metasfresh/issues/5987", "committedDate": "2020-01-09T11:35:01Z", "type": "commit"}, {"oid": "e2da3ef45968d537322d39070afc8d050f3cfe98", "url": "https://github.com/metasfresh/metasfresh/commit/e2da3ef45968d537322d39070afc8d050f3cfe98", "message": "#5987 drop C_Customs_Invoice_Line_ID form M_InOutLine\n\nhttps://github.com/metasfresh/metasfresh/issues/5987", "committedDate": "2020-01-09T11:35:20Z", "type": "commit"}, {"oid": "edd1f6bf266970a8bc3cd0387851c2efcc2124bb", "url": "https://github.com/metasfresh/metasfresh/commit/edd1f6bf266970a8bc3cd0387851c2efcc2124bb", "message": "#5987 translate the allocation window name\n\nhttps://github.com/metasfresh/metasfresh/issues/5987", "committedDate": "2020-01-09T11:35:41Z", "type": "commit"}, {"oid": "3c861aae8288cc6442b5a6f2c457f4368d29fe33", "url": "https://github.com/metasfresh/metasfresh/commit/3c861aae8288cc6442b5a6f2c457f4368d29fe33", "message": "#5987 small repairment after interface generation\n\nhttps://github.com/metasfresh/metasfresh/issues/5987", "committedDate": "2020-01-09T11:36:16Z", "type": "commit"}, {"oid": "1e09c571b4eec84f330a52c0b9f2178921597558", "url": "https://github.com/metasfresh/metasfresh/commit/1e09c571b4eec84f330a52c0b9f2178921597558", "message": "Merge branch '5.132_last_christmas' into gh5987_4", "committedDate": "2020-01-10T08:22:40Z", "type": "commit"}, {"oid": "8cddf6ee61d0add3e5912e292f5da2234496ad50", "url": "https://github.com/metasfresh/metasfresh/commit/8cddf6ee61d0add3e5912e292f5da2234496ad50", "message": "#5987 make sure the exported flag is set when a shipment goes to a customs invoice\n\nhttps://github.com/metasfresh/metasfresh/issues/5987", "committedDate": "2020-01-10T08:45:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE5MjA4NA==", "url": "https://github.com/metasfresh/metasfresh/pull/6020#discussion_r365192084", "bodyText": "A repository should be about loading and storing entities. Thi that regard, this repo is already pretty much f'ed up, but we should not make things worse. Therefore, i would say please move this method to IInoutDAO", "author": "metas-ts", "createdAt": "2020-01-10T11:30:05Z", "path": "de.metas.business/src/main/java/de/metas/customs/CustomsInvoiceRepository.java", "diffHunk": "@@ -382,4 +385,18 @@ private static CustomsInvoiceLineId extractCustomsInvoiceLineId(final I_M_InOutL\n \t\treturn CustomsInvoiceLineId.ofRepoId(record.getC_Customs_Invoice_ID(), record.getC_Customs_Invoice_Line_ID());\n \t}\n \n+\tpublic void setExportedInCustomsInvoice(final InOutId shipmentId)", "originalCommit": "8cddf6ee61d0add3e5912e292f5da2234496ad50", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIwMTI5NA==", "url": "https://github.com/metasfresh/metasfresh/pull/6020#discussion_r365201294", "bodyText": "done", "author": "metas-rc", "createdAt": "2020-01-10T11:57:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE5MjA4NA=="}], "type": "inlineReview", "revised_code": {"commit": "87dc4a51c2a2b376e7bbcd11ad0fc542107128de", "chunk": "diff --git a/de.metas.business/src/main/java/de/metas/customs/CustomsInvoiceRepository.java b/de.metas.business/src/main/java/de/metas/customs/CustomsInvoiceRepository.java\nindex 53140708cc..7356e9b38b 100644\n--- a/de.metas.business/src/main/java/de/metas/customs/CustomsInvoiceRepository.java\n+++ b/de.metas.business/src/main/java/de/metas/customs/CustomsInvoiceRepository.java\n\n@@ -385,18 +382,6 @@ public class CustomsInvoiceRepository\n \t\treturn CustomsInvoiceLineId.ofRepoId(record.getC_Customs_Invoice_ID(), record.getC_Customs_Invoice_Line_ID());\n \t}\n \n-\tpublic void setExportedInCustomsInvoice(final InOutId shipmentId)\n-\t{\n-\t\tfinal IInOutDAO inoutDAO = Services.get(IInOutDAO.class);\n-\n-\t\tfinal I_M_InOut shipment = inoutDAO.getById(shipmentId, I_M_InOut.class);\n-\n-\t\tif (!shipment.isExportedToCustomsInvoice())\n-\t\t{\n-\t\t\tshipment.setIsExportedToCustomsInvoice(true);\n \n-\t\t\tsaveRecord(shipment);\n-\t\t}\n-\t}\n \n }\n"}}, {"oid": "87dc4a51c2a2b376e7bbcd11ad0fc542107128de", "url": "https://github.com/metasfresh/metasfresh/commit/87dc4a51c2a2b376e7bbcd11ad0fc542107128de", "message": "#5987 refactoring: move the flag setter to inout dao\n\nhttps://github.com/metasfresh/metasfresh/issues/5987", "committedDate": "2020-01-10T11:49:10Z", "type": "commit"}]}