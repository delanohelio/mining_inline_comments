{"pr_number": 6083, "pr_title": "6081-app - Generate Invoices Action Parm \"Invoicedate\" is not taken", "pr_createdAt": "2020-01-23T14:58:20Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/6083", "timeline": [{"oid": "17bd9d59f39bb44cf25fbdafe56628eb1317f9a3", "url": "https://github.com/metasfresh/metasfresh/commit/17bd9d59f39bb44cf25fbdafe56628eb1317f9a3", "message": "6081-app - Generate Invoices Action Parm \"Invoicedate\" is not taken\n\n* AggregationEngine:\n  * give precedence to the dataAcct and dateInvoiced parameters, if specified\n  * if the resp date is not given as paremt, then give precedence to the ICs DateInvoiced resp DateAcct\n  * also enhance logging with MDCs here and there\n* InvoiceCandidate2WorkpackageAggregator:\n  * when enqueing ICs for invoicing, then provide the process parameters to the respective workpackages\n  * (=> this is more or less the actual fix)\n\nhttps://github.com/metasfresh/metasfresh/issues/6081", "committedDate": "2020-01-23T14:55:42Z", "type": "commit"}, {"oid": "0f59a28547bd80c6baf54cb2fcfd42d725bd9df7", "url": "https://github.com/metasfresh/metasfresh/commit/0f59a28547bd80c6baf54cb2fcfd42d725bd9df7", "message": "6081-app - Generate Invoices Action Parm \"Invoicedate\" is not taken\n\nAggregationEngine: give precedence to the \"preset\" dates over DateInvoiced/DateAcct (that's how it was anyways)\nhttps://github.com/metasfresh/metasfresh/issues/6081", "committedDate": "2020-01-23T15:04:23Z", "type": "commit"}, {"oid": "d581948b54398ea979f1528034504f3bee261486", "url": "https://github.com/metasfresh/metasfresh/commit/d581948b54398ea979f1528034504f3bee261486", "message": "6070-app - EDI credit-memo QA\n\nadd current C_Invoice record to MDC\n#6070\n\n(cherry picked from commit 7d88f103771ffabf1e6edaec524717207484b8ec)", "committedDate": "2020-01-23T15:23:54Z", "type": "commit"}, {"oid": "cd5a9261324fcad34a4178011ea4ba715c17d3bb", "url": "https://github.com/metasfresh/metasfresh/commit/cd5a9261324fcad34a4178011ea4ba715c17d3bb", "message": "6081-app - Generate Invoices Action Parm \"Invoicedate\" is not taken\n\nfix compile issues\nhttps://github.com/metasfresh/metasfresh/issues/6081", "committedDate": "2020-01-23T15:59:59Z", "type": "commit"}, {"oid": "074e5376fd330cbc45c7e145ad281242d0ea13c6", "url": "https://github.com/metasfresh/metasfresh/commit/074e5376fd330cbc45c7e145ad281242d0ea13c6", "message": "6081-app - Generate Invoices Action Parm \"Invoicedate\" is not taken\n\nfix unit test; add logging\nhttps://github.com/metasfresh/metasfresh/issues/6081", "committedDate": "2020-01-24T06:13:18Z", "type": "commit"}, {"oid": "574014c443281dd40364c81e28f040968e23c5fc", "url": "https://github.com/metasfresh/metasfresh/commit/574014c443281dd40364c81e28f040968e23c5fc", "message": "improve logging during dev-tests", "committedDate": "2020-01-24T06:52:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDUwNDA2NQ==", "url": "https://github.com/metasfresh/metasfresh/pull/6083#discussion_r370504065", "bodyText": "note: this is an unrelated fix; not sure how long this was broken..", "author": "metas-ts", "createdAt": "2020-01-24T07:40:18Z", "path": "de.metas.adempiere.adempiere/base/src/main/java/org/adempiere/ad/callout/api/impl/CalloutExecutor.java", "diffHunk": "@@ -167,7 +168,7 @@ public void executeAll(final Function<String, ICalloutField> calloutFieldsSuppli\n \t\t\t\tfor (final ICalloutInstance callout : callouts)\n \t\t\t\t{\n \t\t\t\t\t// Optimization: don't fire this callout if it was indirectly already fired.\n-\t\t\t\t\tif (executedCalloutsTrace.contains(callout))\n+\t\t\t\t\tif (executedCalloutsTrace.contains(Util.mkKey(field.getColumnName(), callout)))", "originalCommit": "574014c443281dd40364c81e28f040968e23c5fc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDUwNTA2OA==", "url": "https://github.com/metasfresh/metasfresh/pull/6083#discussion_r370505068", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\treturn MDC.putCloseable(\"AD_PInstance_ID\", Integer.toString(selectionId.getRepoId()));\n          \n          \n            \n            \t\treturn MDC.putCloseable(\"RevalidationId\", Integer.toString(selectionId.getRepoId()));", "author": "metas-ts", "createdAt": "2020-01-24T07:44:45Z", "path": "de.metas.swat/de.metas.swat.base/src/main/java/de/metas/inoutcandidate/api/ShipmentSchedulesMDC.java", "diffHunk": "@@ -33,17 +34,17 @@\n @UtilityClass\n public class ShipmentSchedulesMDC\n {\n-\tpublic static MDCCloseable withShipmentScheduleId(@NonNull final ShipmentScheduleId shipmentScheduleId)\n+\tpublic MDCCloseable withShipmentScheduleId(@NonNull final ShipmentScheduleId shipmentScheduleId)\n \t{\n-\t\treturn MDC.putCloseable(I_M_ShipmentSchedule.COLUMNNAME_M_ShipmentSchedule_ID, Integer.toString(shipmentScheduleId.getRepoId()));\n+\t\treturn TableRecordMDC.withTableRecordReference(I_M_ShipmentSchedule.Table_Name, shipmentScheduleId);\n \t}\n \n-\tpublic static MDCCloseable withShipmentScheduleUpdateRunNo(final int runNo)\n+\tpublic MDCCloseable withShipmentScheduleUpdateRunNo(final int runNo)\n \t{\n \t\treturn MDC.putCloseable(\"ShipmentScheduleUpdater-Run#\", Integer.toString(runNo));\n \t}\n \n-\tpublic static MDCCloseable withRevalidationId(@NonNull final PInstanceId selectionId)\n+\tpublic MDCCloseable withRevalidationId(@NonNull final PInstanceId selectionId)\n \t{\n \t\treturn MDC.putCloseable(\"AD_PInstance_ID\", Integer.toString(selectionId.getRepoId()));", "originalCommit": "574014c443281dd40364c81e28f040968e23c5fc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e4028791efc7ea4b39f8a3b2a81910c1c7fbd68d", "chunk": "diff --git a/de.metas.swat/de.metas.swat.base/src/main/java/de/metas/inoutcandidate/api/ShipmentSchedulesMDC.java b/de.metas.swat/de.metas.swat.base/src/main/java/de/metas/inoutcandidate/api/ShipmentSchedulesMDC.java\nindex dd4362c343..6f0c2cff96 100644\n--- a/de.metas.swat/de.metas.swat.base/src/main/java/de/metas/inoutcandidate/api/ShipmentSchedulesMDC.java\n+++ b/de.metas.swat/de.metas.swat.base/src/main/java/de/metas/inoutcandidate/api/ShipmentSchedulesMDC.java\n\n@@ -46,6 +46,6 @@ public class ShipmentSchedulesMDC\n \n \tpublic MDCCloseable withRevalidationId(@NonNull final PInstanceId selectionId)\n \t{\n-\t\treturn MDC.putCloseable(\"AD_PInstance_ID\", Integer.toString(selectionId.getRepoId()));\n+\t\treturn MDC.putCloseable(\"RevalidationId\", Integer.toString(selectionId.getRepoId()));\n \t}\n }\n"}}, {"oid": "e4028791efc7ea4b39f8a3b2a81910c1c7fbd68d", "url": "https://github.com/metasfresh/metasfresh/commit/e4028791efc7ea4b39f8a3b2a81910c1c7fbd68d", "message": "Apply suggestions from code review\r\n\r\n#6081", "committedDate": "2020-01-24T07:50:57Z", "type": "commit"}, {"oid": "4104f1495e1542d8ba8f9c78c11bf5706f995e00", "url": "https://github.com/metasfresh/metasfresh/commit/4104f1495e1542d8ba8f9c78c11bf5706f995e00", "message": "minor codacy issue fix\n\n#6081", "committedDate": "2020-01-24T16:26:03Z", "type": "commit"}]}