{"pr_number": 7068, "pr_title": "Facettes Optimization + Billing Candidates updates", "pr_createdAt": "2020-07-28T07:12:05Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/7068", "timeline": [{"oid": "3603fa27740d6bf0e6a793b21251c7539d6da533", "url": "https://github.com/metasfresh/metasfresh/commit/3603fa27740d6bf0e6a793b21251c7539d6da533", "message": "prototyping: ViewHeaderPropertiesProvider", "committedDate": "2020-07-27T10:28:05Z", "type": "commit"}, {"oid": "49f108093dfe7eaa9bfba6d247a575e365fbbe70", "url": "https://github.com/metasfresh/metasfresh/commit/49f108093dfe7eaa9bfba6d247a575e365fbbe70", "message": "fix compile errors", "committedDate": "2020-07-27T10:36:40Z", "type": "commit"}, {"oid": "747d56c99ea1f390d59f8131c94c1e2281730b6c", "url": "https://github.com/metasfresh/metasfresh/commit/747d56c99ea1f390d59f8131c94c1e2281730b6c", "message": "Add OrderCandidate Header Properties Provider with dummy data for frontend development\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-28T08:04:20Z", "type": "commit"}, {"oid": "d191356c470413700c0812d8d93f52f9ce6f1905", "url": "https://github.com/metasfresh/metasfresh/commit/d191356c470413700c0812d8d93f52f9ce6f1905", "message": "Add nullability info\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-28T08:05:49Z", "type": "commit"}, {"oid": "f54a322e647540bf55d456e2bbff2dba71aecc59", "url": "https://github.com/metasfresh/metasfresh/commit/f54a322e647540bf55d456e2bbff2dba71aecc59", "message": "Remove extra space\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-28T08:23:28Z", "type": "commit"}, {"oid": "4ea8408d3b116fe822af8a270bd0f78898ec3517", "url": "https://github.com/metasfresh/metasfresh/commit/4ea8408d3b116fe822af8a270bd0f78898ec3517", "message": "Fix/Ignore warnings\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-28T09:03:04Z", "type": "commit"}, {"oid": "d60583c667c1ac2d9d76488c3bf4ec981907e443", "url": "https://github.com/metasfresh/metasfresh/commit/d60583c667c1ac2d9d76488c3bf4ec981907e443", "message": "Fix/Ignore warnings\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-28T10:49:42Z", "type": "commit"}, {"oid": "8db1f7ecd68ef6152a2b137b0f770c23f9534585", "url": "https://github.com/metasfresh/metasfresh/commit/8db1f7ecd68ef6152a2b137b0f770c23f9534585", "message": "Use `ExtendedMemorizingSupplier` for storing `DefaultView.headerProperties`\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-28T10:50:51Z", "type": "commit"}, {"oid": "3d8ed4d69a7a865e7f0cb9e29659524aac2fe4e0", "url": "https://github.com/metasfresh/metasfresh/commit/3d8ed4d69a7a865e7f0cb9e29659524aac2fe4e0", "message": "Better method name\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-28T11:16:06Z", "type": "commit"}, {"oid": "346fa86c5fa21d6eed59ce1ffb319bc6837ebce2", "url": "https://github.com/metasfresh/metasfresh/commit/346fa86c5fa21d6eed59ce1ffb319bc6837ebce2", "message": "Show `InvoiceCandidates.ApprovedForInvoicing` in grid view\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-28T11:29:13Z", "type": "commit"}, {"oid": "f83d09b0ad28b16edd3ea39699c7e581c970aab9", "url": "https://github.com/metasfresh/metasfresh/commit/f83d09b0ad28b16edd3ea39699c7e581c970aab9", "message": "Introduce ViewHeaderPropertiesGroup and its JSON counterpart\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-28T11:48:47Z", "type": "commit"}, {"oid": "34e271ee6b0c06a01aa931379393887ab48c9269", "url": "https://github.com/metasfresh/metasfresh/commit/34e271ee6b0c06a01aa931379393887ab48c9269", "message": "Introduce InvoiceCandidatesAmtSelectionSummary and Command which computes it\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-29T06:37:09Z", "type": "commit"}, {"oid": "7cd5793f52d409ed95aa288e014174838c75845f", "url": "https://github.com/metasfresh/metasfresh/commit/7cd5793f52d409ed95aa288e014174838c75845f", "message": "Fix warnings; cleanup\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-29T08:49:14Z", "type": "commit"}, {"oid": "70e3297595855916db9e6b2cf877f164ad91e9ef", "url": "https://github.com/metasfresh/metasfresh/commit/70e3297595855916db9e6b2cf877f164ad91e9ef", "message": "Parse InvoiceCandidatesAmtSelectionSummary to HeaderProperties\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-29T10:11:22Z", "type": "commit"}, {"oid": "7d3224cc1504e8fe271e1a3be6474bc957e1170e", "url": "https://github.com/metasfresh/metasfresh/commit/7d3224cc1504e8fe271e1a3be6474bc957e1170e", "message": "#7062 show header properties in grid views", "committedDate": "2020-07-29T11:10:35Z", "type": "commit"}, {"oid": "b015de9124d01dd9169eaec4f46c60866ea2e751", "url": "https://github.com/metasfresh/metasfresh/commit/b015de9124d01dd9169eaec4f46c60866ea2e751", "message": "#7062 cleanup styles a bit", "committedDate": "2020-07-29T11:10:35Z", "type": "commit"}, {"oid": "2808fc8d28aa0984b54d859c57caf1716d6a5e9b", "url": "https://github.com/metasfresh/metasfresh/commit/2808fc8d28aa0984b54d859c57caf1716d6a5e9b", "message": "#7062 make the actions button wider", "committedDate": "2020-07-29T11:10:35Z", "type": "commit"}, {"oid": "793026e676a7abecb7f7be76db9c01d6a181816d", "url": "https://github.com/metasfresh/metasfresh/commit/793026e676a7abecb7f7be76db9c01d6a181816d", "message": "Show the Money amount in process `C_Invoice_Candidate_ApproveForInvoicing`\n\nSimilar to how we show it in `C_Invoice_Candidate_EnqueueSelectionForInvoicing`\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-29T11:25:15Z", "type": "commit"}, {"oid": "869bb11f2d1bdfdb37a0a174fff378c5609f3b5f", "url": "https://github.com/metasfresh/metasfresh/commit/869bb11f2d1bdfdb37a0a174fff378c5609f3b5f", "message": "Add TRLs\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-29T11:41:53Z", "type": "commit"}, {"oid": "3e8df637dd0bb2c13880bb20d11f49bd190b4611", "url": "https://github.com/metasfresh/metasfresh/commit/3e8df637dd0bb2c13880bb20d11f49bd190b4611", "message": "Rename\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-29T11:53:52Z", "type": "commit"}, {"oid": "26f8b10c78e3e0175c79c81b13bbdcd7fe330b12", "url": "https://github.com/metasfresh/metasfresh/commit/26f8b10c78e3e0175c79c81b13bbdcd7fe330b12", "message": "Return an empty `InvoiceCandidatesAmtSelectionSummary` instead of null\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-29T12:01:25Z", "type": "commit"}, {"oid": "21f97a79ec818a7e716bf0c76d70b52ea599d037", "url": "https://github.com/metasfresh/metasfresh/commit/21f97a79ec818a7e716bf0c76d70b52ea599d037", "message": "Notify frontend if  HeaderPropertiesChanged via websocket\n\nAdd rest endpoint for retrieving HeaderProperties\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-07-30T09:41:32Z", "type": "commit"}, {"oid": "ba94f8a1615116a0c6de680a67d40a821273691e", "url": "https://github.com/metasfresh/metasfresh/commit/ba94f8a1615116a0c6de680a67d40a821273691e", "message": "#7062 add request for header properties", "committedDate": "2020-07-31T16:25:08Z", "type": "commit"}, {"oid": "504b9fe6c25c95770d63301dfb3755bd806f384e", "url": "https://github.com/metasfresh/metasfresh/commit/504b9fe6c25c95770d63301dfb3755bd806f384e", "message": "#7062 fix positioning of the header properties element", "committedDate": "2020-07-31T16:25:08Z", "type": "commit"}, {"oid": "8c9558cd9dca8bbc43ea7511c58905f9dd5dcd05", "url": "https://github.com/metasfresh/metasfresh/commit/8c9558cd9dca8bbc43ea7511c58905f9dd5dcd05", "message": "#7062 add action creator for fetching header properties", "committedDate": "2020-07-31T16:25:08Z", "type": "commit"}, {"oid": "2a1846e7f11797257acdc38d936b85d3b60e682e", "url": "https://github.com/metasfresh/metasfresh/commit/2a1846e7f11797257acdc38d936b85d3b60e682e", "message": "Merge branch 'master' into gh7062-Facets-BillingCandidates", "committedDate": "2020-08-03T13:12:49Z", "type": "commit"}, {"oid": "2bfcce89fa0c60085111003c67a1085bae3b272c", "url": "https://github.com/metasfresh/metasfresh/commit/2bfcce89fa0c60085111003c67a1085bae3b272c", "message": "#7062 add and update tests", "committedDate": "2020-08-03T13:51:45Z", "type": "commit"}, {"oid": "5b1914bf4e91941d79bcb91129146b42663d93bf", "url": "https://github.com/metasfresh/metasfresh/commit/5b1914bf4e91941d79bcb91129146b42663d93bf", "message": "QA", "committedDate": "2020-08-03T14:15:01Z", "type": "commit"}, {"oid": "f3e785e9cb539261c7014a4f76b5adf01b1a1646", "url": "https://github.com/metasfresh/metasfresh/commit/f3e785e9cb539261c7014a4f76b5adf01b1a1646", "message": "QA", "committedDate": "2020-08-03T14:21:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQxMzgyMg==", "url": "https://github.com/metasfresh/metasfresh/pull/7068#discussion_r464413822", "bodyText": "yes it can, null is supported.\npls delete it and replace it with @Nullable.", "author": "teosarca", "createdAt": "2020-08-03T13:30:01Z", "path": "backend/de.metas.util/src/main/java/org/adempiere/util/lang/ExtendedMemorizingSupplier.java", "diffHunk": "@@ -48,13 +49,15 @@\n \t// on volatile read of \"initialized\".\n \t// metas-ts: Setting it to be volatile none the less, because we somehow managed to get an NPE with a delegate supplier that could not have returned null.\n \t// See https://github.com/metasfresh/metasfresh/issues/4985\n+\t@Nullable\n \tprivate transient volatile T value;\n \n \tprivate ExtendedMemorizingSupplier(final java.util.function.Supplier<T> delegate)\n \t{\n \t\tthis.delegate = delegate;\n \t}\n \n+\t@SuppressWarnings(\"ConstantConditions\") // TODO not sure if this is NonNull or Nullable. Can the supplier return null?", "originalCommit": "2a1846e7f11797257acdc38d936b85d3b60e682e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDgwMzE1OQ==", "url": "https://github.com/metasfresh/metasfresh/pull/7068#discussion_r464803159", "bodyText": "thx for clarifying. Done", "author": "TheBestPessimist", "createdAt": "2020-08-04T05:11:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQxMzgyMg=="}], "type": "inlineReview", "revised_code": {"commit": "e93f0919c3f3a53511d2108f1d748c63dd10cad0", "chunk": "diff --git a/backend/de.metas.util/src/main/java/org/adempiere/util/lang/ExtendedMemorizingSupplier.java b/backend/de.metas.util/src/main/java/org/adempiere/util/lang/ExtendedMemorizingSupplier.java\nindex 425116ca9c..1348d18d1e 100644\n--- a/backend/de.metas.util/src/main/java/org/adempiere/util/lang/ExtendedMemorizingSupplier.java\n+++ b/backend/de.metas.util/src/main/java/org/adempiere/util/lang/ExtendedMemorizingSupplier.java\n\n@@ -57,8 +57,8 @@ public final class ExtendedMemorizingSupplier<T> implements java.util.function.S\n \t\tthis.delegate = delegate;\n \t}\n \n-\t@SuppressWarnings(\"ConstantConditions\") // TODO not sure if this is NonNull or Nullable. Can the supplier return null?\n \t@Override\n+\t@Nullable\n \tpublic T get()\n \t{\n \t\t// A 2-field variant of Double Checked Locking.\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQyNjA5MA==", "url": "https://github.com/metasfresh/metasfresh/pull/7068#discussion_r464426090", "bodyText": "InvoiceCandidate...", "author": "teosarca", "createdAt": "2020-08-03T13:50:34Z", "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/view/OrderCandidateViewHeaderPropertiesProvider.java", "diffHunk": "@@ -0,0 +1,136 @@\n+/*\n+ * #%L\n+ * metasfresh-webui-api\n+ * %%\n+ * Copyright (C) 2020 metas GmbH\n+ * %%\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as\n+ * published by the Free Software Foundation, either version 2 of the\n+ * License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public\n+ * License along with this program. If not, see\n+ * <http://www.gnu.org/licenses/gpl-2.0.html>.\n+ * #L%\n+ */\n+\n+package de.metas.ui.web.view;\n+\n+import com.google.common.collect.ImmutableList;\n+import de.metas.handlingunits.invoicecandidate.ui.spi.impl.HUInvoiceCandidatesSelectionSummaryInfo;\n+import de.metas.i18n.IMsgBL;\n+import de.metas.invoicecandidate.api.IInvoiceCandBL;\n+import de.metas.invoicecandidate.api.impl.InvoiceCandidatesAmtSelectionSummary;\n+import de.metas.invoicecandidate.model.I_C_Invoice_Candidate;\n+import de.metas.ui.web.view.descriptor.SqlAndParams;\n+import de.metas.ui.web.view.descriptor.SqlViewRowsWhereClause;\n+import de.metas.ui.web.window.datatypes.DocumentIdsSelection;\n+import de.metas.ui.web.window.model.sql.SqlOptions;\n+import de.metas.util.Services;\n+import lombok.NonNull;\n+import org.springframework.stereotype.Component;\n+\n+import java.util.List;\n+\n+@Component\n+public class OrderCandidateViewHeaderPropertiesProvider implements ViewHeaderPropertiesProvider", "originalCommit": "2a1846e7f11797257acdc38d936b85d3b60e682e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDgwMzM2Mw==", "url": "https://github.com/metasfresh/metasfresh/pull/7068#discussion_r464803363", "bodyText": "You already fixed this. \ud83d\udc4d", "author": "TheBestPessimist", "createdAt": "2020-08-04T05:12:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQyNjA5MA=="}], "type": "inlineReview", "revised_code": {"commit": "5b1914bf4e91941d79bcb91129146b42663d93bf", "chunk": "diff --git a/backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/view/OrderCandidateViewHeaderPropertiesProvider.java b/backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/view/InvoiceCandidateViewHeaderPropertiesProvider.java\nsimilarity index 61%\nrename from backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/view/OrderCandidateViewHeaderPropertiesProvider.java\nrename to backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/view/InvoiceCandidateViewHeaderPropertiesProvider.java\nindex 0caa7b196e..c1e6b5905c 100644\n--- a/backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/view/OrderCandidateViewHeaderPropertiesProvider.java\n+++ b/backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/view/InvoiceCandidateViewHeaderPropertiesProvider.java\n\n@@ -22,7 +22,12 @@\n \n package de.metas.ui.web.view;\n \n+import java.util.List;\n+\n+import org.springframework.stereotype.Component;\n+\n import com.google.common.collect.ImmutableList;\n+\n import de.metas.handlingunits.invoicecandidate.ui.spi.impl.HUInvoiceCandidatesSelectionSummaryInfo;\n import de.metas.i18n.IMsgBL;\n import de.metas.invoicecandidate.api.IInvoiceCandBL;\n"}}, {"oid": "e93f0919c3f3a53511d2108f1d748c63dd10cad0", "url": "https://github.com/metasfresh/metasfresh/commit/e93f0919c3f3a53511d2108f1d748c63dd10cad0", "message": "Add nullability info\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-08-04T05:37:50Z", "type": "commit"}, {"oid": "c696202f016ac8d479e2bbceae076b6e7ea05279", "url": "https://github.com/metasfresh/metasfresh/commit/c696202f016ac8d479e2bbceae076b6e7ea05279", "message": "#7062 export rendering header properties to a helper function\n#7062 use it in modals too ^", "committedDate": "2020-08-04T10:19:20Z", "type": "commit"}, {"oid": "25a78cac8fffef71395ff027aab692d6ad28ce2f", "url": "https://github.com/metasfresh/metasfresh/commit/25a78cac8fffef71395ff027aab692d6ad28ce2f", "message": "Update command name\n\nhttps://github.com/metasfresh/metasfresh/issues/7062", "committedDate": "2020-08-04T10:32:17Z", "type": "commit"}]}