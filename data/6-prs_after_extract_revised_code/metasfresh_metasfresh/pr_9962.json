{"pr_number": 9962, "pr_title": "#9935 C_project_id propagation and window adjustments", "pr_createdAt": "2020-09-17T14:15:00Z", "pr_url": "https://github.com/metasfresh/metasfresh/pull/9962", "timeline": [{"oid": "0560e1487d40517acacba07f039be334b57cbd5a", "url": "https://github.com/metasfresh/metasfresh/commit/0560e1487d40517acacba07f039be334b57cbd5a", "message": "#9935\n - Setting the project from the order's header to an orderline when adding a new orderline\n - Setting the project from the orderline to a shipmentline when generating shipments\n - Setting the project from the orderline to an invoiceline when generating Invoices\n - Ad_Rel_type entries to show sidelist references between\n            - c_order(so) <-> c_project\n            - m_inout(so) <-> c_project\n            - c_invoice(so) <-> c_project\n            - fact_acct <-> c_project\n - Displaying project field in shipment line and invoice line", "committedDate": "2020-09-17T14:13:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc4OTQ3Mw==", "url": "https://github.com/metasfresh/metasfresh/pull/9962#discussion_r490789473", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tfinal I_C_Order order = orderline.getC_Order();\n          \n          \n            \n            \t\tif (order != null)\n          \n          \n            \n            \t\t{\n          \n          \n            \n            \t\t\torderline.setC_Project_ID(order.getC_Project_ID());\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \t\tif (orderline.getC_Order_ID() > 0 && orderLine.getC_Project_ID() <= 0)\n          \n          \n            \n            \t\t{\n          \n          \n            \n            \t\t\tfinal I_C_Order order = orderline.getC_Order();\n          \n          \n            \n            \t\t\torderline.setC_Project_ID(order.getC_Project_ID());\n          \n          \n            \n            \t\t}\n          \n      \n    \n    \n  \n\nimprovements:\n\ndon't overwrite a rpoject that a used just set in the add-new modal\ndon't load the order if you don't have to", "author": "metas-ts", "createdAt": "2020-09-18T08:33:00Z", "path": "backend/de.metas.business/src/main/java/de/metas/order/model/interceptor/C_OrderLine.java", "diffHunk": "@@ -126,6 +126,16 @@ public void setQtyEnteredInPriceUOM(final I_C_OrderLine orderLine)\n \t\torderLine.setQtyEnteredInPriceUOM(qtyEnteredInPriceUOM);\n \t}\n \n+\t@ModelChange(timings = { ModelValidator.TYPE_BEFORE_NEW })\n+\tpublic void setProjectToOrderline(final I_C_OrderLine orderline)\n+\t{\n+\t\tfinal I_C_Order order = orderline.getC_Order();\n+\t\tif (order != null)\n+\t\t{\n+\t\t\torderline.setC_Project_ID(order.getC_Project_ID());\n+\t\t}", "originalCommit": "0560e1487d40517acacba07f039be334b57cbd5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc5NDIwMw==", "url": "https://github.com/metasfresh/metasfresh/pull/9962#discussion_r490794203", "bodyText": "applied changes.", "author": "dragospodariu96", "createdAt": "2020-09-18T08:41:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc4OTQ3Mw=="}], "type": "inlineReview", "revised_code": {"commit": "7a860f817a5cd9f5b828ded5757453d780645806", "chunk": "diff --git a/backend/de.metas.business/src/main/java/de/metas/order/model/interceptor/C_OrderLine.java b/backend/de.metas.business/src/main/java/de/metas/order/model/interceptor/C_OrderLine.java\nindex ec97c64693..905fcf1c5e 100644\n--- a/backend/de.metas.business/src/main/java/de/metas/order/model/interceptor/C_OrderLine.java\n+++ b/backend/de.metas.business/src/main/java/de/metas/order/model/interceptor/C_OrderLine.java\n\n@@ -127,12 +127,12 @@ public class C_OrderLine\n \t}\n \n \t@ModelChange(timings = { ModelValidator.TYPE_BEFORE_NEW })\n-\tpublic void setProjectToOrderline(final I_C_OrderLine orderline)\n+\tpublic void setProjectToOrderline(final I_C_OrderLine orderLine)\n \t{\n-\t\tfinal I_C_Order order = orderline.getC_Order();\n-\t\tif (order != null)\n+\t\tif (orderLine.getC_Order_ID() > 0 && orderLine.getC_Project_ID() <= 0)\n \t\t{\n-\t\t\torderline.setC_Project_ID(order.getC_Project_ID());\n+\t\t\tfinal I_C_Order order = orderLine.getC_Order();\n+\t\t\torderLine.setC_Project_ID(order.getC_Project_ID());\n \t\t}\n \t}\n \n"}}, {"oid": "7a860f817a5cd9f5b828ded5757453d780645806", "url": "https://github.com/metasfresh/metasfresh/commit/7a860f817a5cd9f5b828ded5757453d780645806", "message": "#9935\n - applied review requested changes.", "committedDate": "2020-09-18T08:41:18Z", "type": "commit"}]}