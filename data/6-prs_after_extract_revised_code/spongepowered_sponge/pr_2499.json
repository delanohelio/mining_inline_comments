{"pr_number": 2499, "pr_title": "Start moving some simpler things to new tracker package [API-8].", "pr_createdAt": "2020-02-07T04:13:07Z", "pr_url": "https://github.com/SpongePowered/Sponge/pull/2499", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjIwOTU2OA==", "url": "https://github.com/SpongePowered/Sponge/pull/2499#discussion_r376209568", "bodyText": "Update the redirect method name to like tracker$wrapGrowWithPhaseEntry", "author": "gabizou", "createdAt": "2020-02-07T04:27:48Z", "path": "src/main/java/org/spongepowered/common/mixin/tracker/item/BoneMealItemMixin_Tracker.java", "diffHunk": "@@ -74,7 +74,7 @@\n         method = \"applyBonemeal\",\n         at = @At(\n             value = \"INVOKE\",\n-            target = \"Lnet/minecraft/block/IGrowable;grow(Lnet/minecraft/world/World;Ljava/util/Random;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/state/IBlockState;)V\"\n+            target = \"Lnet/minecraft/block/IGrowable;grow(Lnet/minecraft/world/World;Ljava/util/Random;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;)V\"\n         ),\n         require = 0, // Will be removed once the above github issue is resolved with a proper solution\n         // Even though we're in a group, expecting this to succeed in forge environments will not work since there is a different mixin", "originalCommit": "98e8d33fff21eac1a75224f620ba2fcdb7dc29a0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "00f41269d526f7192178cfed44f9ba2d48bc541e", "chunk": "diff --git a/src/main/java/org/spongepowered/common/mixin/tracker/item/BoneMealItemMixin_Tracker.java b/src/main/java/org/spongepowered/common/mixin/tracker/item/BoneMealItemMixin_Tracker.java\nindex ce900dcec..45649e5a0 100644\n--- a/src/main/java/org/spongepowered/common/mixin/tracker/item/BoneMealItemMixin_Tracker.java\n+++ b/src/main/java/org/spongepowered/common/mixin/tracker/item/BoneMealItemMixin_Tracker.java\n\n@@ -80,7 +80,7 @@\n         // Even though we're in a group, expecting this to succeed in forge environments will not work since there is a different mixin\n         expect = 0\n     )\n-    private static void onGrowableVanilla(IGrowable iGrowable, World worldIn, Random rand, BlockPos pos, BlockState blockState, ItemStack stack, World sameWorld, BlockPos target) {\n+    private static void tracker$wrapGrowWithPhaseEntry(IGrowable iGrowable, World worldIn, Random rand, BlockPos pos, BlockState blockState, ItemStack stack, World sameWorld, BlockPos target) {\n         if (((WorldBridge) worldIn).bridge$isFake() || !ShouldFire.CHANGE_BLOCK_EVENT_GROW) {\n             iGrowable.grow(worldIn, rand, pos, blockState);\n             return;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjIwOTcxMw==", "url": "https://github.com/SpongePowered/Sponge/pull/2499#discussion_r376209713", "bodyText": "The method name should follow the wiki conventions still: tracker$wrapSpawnStateWithPhaseEntry or think of a better name \ud83d\ude06", "author": "gabizou", "createdAt": "2020-02-07T04:28:33Z", "path": "src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java", "diffHunk": "@@ -0,0 +1,39 @@\n+package org.spongepowered.common.mixin.tracker.world.end;\n+\n+import net.minecraft.entity.item.EnderCrystalEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.end.DragonFightManager;\n+import net.minecraft.world.end.DragonSpawnState;\n+import net.minecraft.world.server.ServerWorld;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Redirect;\n+import org.spongepowered.common.event.tracking.PhaseTracker;\n+import org.spongepowered.common.event.tracking.context.GeneralizedContext;\n+import org.spongepowered.common.event.tracking.phase.world.dragon.DragonPhase;\n+\n+import java.util.List;\n+\n+@Mixin(DragonFightManager.class)\n+public abstract class DragonFightManagerMixin_Tracker {\n+\n+    /**\n+     * @author i509vcb - February 6th 2020\n+     * @reason Add sponge necessary phase state switches\n+     *\n+     * @param dragonSpawnState The dragon spawn state.\n+     * @param worldIn The world this respawnState is occuring in.\n+     * @param manager The current DragonFightManager.\n+     * @param crystals List of all currently present end crystals.\n+     * @param respawnStateTicks The amount of this this respawn state has been running for.\n+     * @param exitPortalLocation The position of the exit portal.\n+     */\n+    @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/end/DragonSpawnState;process(Lnet/minecraft/world/server/ServerWorld;Lnet/minecraft/world/end/DragonFightManager;Ljava/util/List;ILnet/minecraft/util/math/BlockPos;)V\"))\n+    private void trackDragonRespawn(DragonSpawnState dragonSpawnState, ServerWorld worldIn, DragonFightManager manager, List<EnderCrystalEntity> crystals, int respawnStateTicks, BlockPos exitPortalLocation) {", "originalCommit": "98e8d33fff21eac1a75224f620ba2fcdb7dc29a0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "00f41269d526f7192178cfed44f9ba2d48bc541e", "chunk": "diff --git a/src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java b/src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java\nindex 1ca6a6efb..c9b1f7a38 100644\n--- a/src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java\n+++ b/src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java\n\n@@ -29,7 +29,7 @@\n      * @param exitPortalLocation The position of the exit portal.\n      */\n     @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/end/DragonSpawnState;process(Lnet/minecraft/world/server/ServerWorld;Lnet/minecraft/world/end/DragonFightManager;Ljava/util/List;ILnet/minecraft/util/math/BlockPos;)V\"))\n-    private void trackDragonRespawn(DragonSpawnState dragonSpawnState, ServerWorld worldIn, DragonFightManager manager, List<EnderCrystalEntity> crystals, int respawnStateTicks, BlockPos exitPortalLocation) {\n+    private void tracker$wrapSpawnStateWithPhaseEntry(DragonSpawnState dragonSpawnState, ServerWorld worldIn, DragonFightManager manager, List<EnderCrystalEntity> crystals, int respawnStateTicks, BlockPos exitPortalLocation) {\n         try (final GeneralizedContext context = DragonPhase.State.RESPAWN_DRAGON.createPhaseContext(PhaseTracker.SERVER)) {\n             context.buildAndSwitch();\n             ++respawnStateTicks;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjM3NzAyOQ==", "url": "https://github.com/SpongePowered/Sponge/pull/2499#discussion_r376377029", "bodyText": "Missing license", "author": "ImMorpheus", "createdAt": "2020-02-07T12:59:01Z", "path": "src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java", "diffHunk": "@@ -0,0 +1,39 @@\n+package org.spongepowered.common.mixin.tracker.world.end;", "originalCommit": "98e8d33fff21eac1a75224f620ba2fcdb7dc29a0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "00f41269d526f7192178cfed44f9ba2d48bc541e", "chunk": "diff --git a/src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java b/src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java\nindex 1ca6a6efb..c9b1f7a38 100644\n--- a/src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java\n+++ b/src/main/java/org/spongepowered/common/mixin/tracker/world/end/DragonFightManagerMixin_Tracker.java\n\n@@ -29,7 +29,7 @@\n      * @param exitPortalLocation The position of the exit portal.\n      */\n     @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/end/DragonSpawnState;process(Lnet/minecraft/world/server/ServerWorld;Lnet/minecraft/world/end/DragonFightManager;Ljava/util/List;ILnet/minecraft/util/math/BlockPos;)V\"))\n-    private void trackDragonRespawn(DragonSpawnState dragonSpawnState, ServerWorld worldIn, DragonFightManager manager, List<EnderCrystalEntity> crystals, int respawnStateTicks, BlockPos exitPortalLocation) {\n+    private void tracker$wrapSpawnStateWithPhaseEntry(DragonSpawnState dragonSpawnState, ServerWorld worldIn, DragonFightManager manager, List<EnderCrystalEntity> crystals, int respawnStateTicks, BlockPos exitPortalLocation) {\n         try (final GeneralizedContext context = DragonPhase.State.RESPAWN_DRAGON.createPhaseContext(PhaseTracker.SERVER)) {\n             context.buildAndSwitch();\n             ++respawnStateTicks;\n"}}, {"oid": "00f41269d526f7192178cfed44f9ba2d48bc541e", "url": "https://github.com/SpongePowered/Sponge/commit/00f41269d526f7192178cfed44f9ba2d48bc541e", "message": "Start moving some simpler things to new tracker package.", "committedDate": "2020-02-07T20:09:32Z", "type": "forcePushed"}, {"oid": "706e4b3bb95eb5d1ca27f0aa511c6142faaf61cb", "url": "https://github.com/SpongePowered/Sponge/commit/706e4b3bb95eb5d1ca27f0aa511c6142faaf61cb", "message": "Start moving some simpler things to new tracker package.", "committedDate": "2020-02-07T20:11:38Z", "type": "commit"}, {"oid": "706e4b3bb95eb5d1ca27f0aa511c6142faaf61cb", "url": "https://github.com/SpongePowered/Sponge/commit/706e4b3bb95eb5d1ca27f0aa511c6142faaf61cb", "message": "Start moving some simpler things to new tracker package.", "committedDate": "2020-02-07T20:11:38Z", "type": "forcePushed"}]}