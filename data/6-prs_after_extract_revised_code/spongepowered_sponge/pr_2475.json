{"pr_number": 2475, "pr_title": "Fix and optimize DestructEntityEvent for non-living entities", "pr_createdAt": "2020-01-12T00:02:35Z", "pr_url": "https://github.com/SpongePowered/Sponge/pull/2475", "timeline": [{"oid": "e5bcc3d54247590d4e955b87f92d9833d2f2afb0", "url": "https://github.com/SpongePowered/Sponge/commit/e5bcc3d54247590d4e955b87f92d9833d2f2afb0", "message": "Fix and optimize DestructEntityEvent for non-living entities", "committedDate": "2020-01-11T23:46:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU0ODg1NA==", "url": "https://github.com/SpongePowered/Sponge/pull/2475#discussion_r365548854", "bodyText": "Is this an API call or an implementation (native) method call?", "author": "gabizou", "createdAt": "2020-01-12T00:08:39Z", "path": "src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java", "diffHunk": "@@ -447,7 +447,7 @@ public boolean isLoaded() {\n \n     @Override\n     public void remove() {\n-        this.isDead = true;\n+        setDead();", "originalCommit": "e5bcc3d54247590d4e955b87f92d9833d2f2afb0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU0OTQ5Nw==", "url": "https://github.com/SpongePowered/Sponge/pull/2475#discussion_r365549497", "bodyText": "remove is from the API and setDead is from NMS. There is an injection in setDead to fire the DestructEntityEvent.", "author": "Yeregorix", "createdAt": "2020-01-12T00:27:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU0ODg1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU1MjYwMw==", "url": "https://github.com/SpongePowered/Sponge/pull/2475#discussion_r365552603", "bodyText": "Then rename the setDead() to shadow$setDead(). It's easier/clearer to see where the method comes from that way.", "author": "gabizou", "createdAt": "2020-01-12T02:04:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU0ODg1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NTU4OQ==", "url": "https://github.com/SpongePowered/Sponge/pull/2475#discussion_r365565589", "bodyText": "It will affect many other classes extending EntityMixin_API and calling setDead.\nsetDead is also shadowed in EntityMixin and EntityMixin_Activation.\nShould I rename everywhere or just in EntityMixin_API and its subclasses ?", "author": "Yeregorix", "createdAt": "2020-01-12T08:23:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU0ODg1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NTY2NA==", "url": "https://github.com/SpongePowered/Sponge/pull/2475#discussion_r365565664", "bodyText": "It will affect many other classes extending EntityMixin_API and calling setDead.\n\n\nAh, never mind then. Thought it was an overall addition.", "author": "gabizou", "createdAt": "2020-01-12T08:24:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU0ODg1NA=="}], "type": "inlineReview", "revised_code": {"commit": "27f3e5c6f1746af40d590f6b44c82ea054b944b1", "chunk": "diff --git a/src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java b/src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java\nindex 23711de19..4e02317ad 100644\n--- a/src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java\n+++ b/src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java\n\n@@ -447,7 +447,7 @@ public boolean isLoaded() {\n \n     @Override\n     public void remove() {\n-        setDead();\n+        this.setDead();\n     }\n \n     @Override\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU2NTcxOQ==", "url": "https://github.com/SpongePowered/Sponge/pull/2475#discussion_r365565719", "bodyText": "Just remember to always qualify field and method calls, so this should be\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    setDead();\n          \n          \n            \n                    this.setDead();", "author": "gabizou", "createdAt": "2020-01-12T08:25:46Z", "path": "src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java", "diffHunk": "@@ -447,7 +447,7 @@ public boolean isLoaded() {\n \n     @Override\n     public void remove() {\n-        this.isDead = true;\n+        setDead();", "originalCommit": "e5bcc3d54247590d4e955b87f92d9833d2f2afb0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "27f3e5c6f1746af40d590f6b44c82ea054b944b1", "chunk": "diff --git a/src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java b/src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java\nindex 23711de19..4e02317ad 100644\n--- a/src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java\n+++ b/src/main/java/org/spongepowered/common/mixin/api/mcp/entity/EntityMixin_API.java\n\n@@ -447,7 +447,7 @@ public boolean isLoaded() {\n \n     @Override\n     public void remove() {\n-        setDead();\n+        this.setDead();\n     }\n \n     @Override\n"}}, {"oid": "27f3e5c6f1746af40d590f6b44c82ea054b944b1", "url": "https://github.com/SpongePowered/Sponge/commit/27f3e5c6f1746af40d590f6b44c82ea054b944b1", "message": "Qualify method call\n\nCo-Authored-By: Gabriel Harris-Rouquette <github@gabizou.com>", "committedDate": "2020-01-12T08:40:13Z", "type": "commit"}]}