{"pr_number": 1706, "pr_title": "Related #1664. Allow Candidate batch size to be user configurable", "pr_createdAt": "2020-09-16T17:33:22Z", "pr_url": "https://github.com/apache/accumulo/pull/1706", "timeline": [{"oid": "9708a3b8849dac0a38ddfb7d04eee136263796dd", "url": "https://github.com/apache/accumulo/commit/9708a3b8849dac0a38ddfb7d04eee136263796dd", "message": "make gc_batch configurable", "committedDate": "2020-09-16T17:10:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTYzNzk2NQ==", "url": "https://github.com/apache/accumulo/pull/1706#discussion_r489637965", "bodyText": "If we make this property of type PropertyType.BYTES, then it may be more user friendly, and the comment about the default can be removed, because it would be redundant. If you do that, then it's a simple matter to divide by 2 to get the approximate number of characters for the count in the implementation. Using PropertyType.BYTES will also make it more user friendly, because users can use the typed-strings, like 16M or 1G or 512K when they change the configuration (and the default can be 8M).", "author": "ctubbsii", "createdAt": "2020-09-16T18:27:31Z", "path": "core/src/main/java/org/apache/accumulo/core/conf/Property.java", "diffHunk": "@@ -568,6 +568,8 @@\n   // accumulo garbage collector properties\n   GC_PREFIX(\"gc.\", null, PropertyType.PREFIX,\n       \"Properties in this category affect the behavior of the accumulo garbage collector.\"),\n+  GC_CANDIDATE_BATCH_SIZE(\"gc.candidate.batch.size\", \"4000000\", PropertyType.COUNT,\n+          \"The batch size used for garbage collection. The default is effectively 8MB\"),", "originalCommit": "9708a3b8849dac0a38ddfb7d04eee136263796dd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9ac567cbf2453f190a68a1dd5c903ba2ab7a838a", "chunk": "diff --git a/core/src/main/java/org/apache/accumulo/core/conf/Property.java b/core/src/main/java/org/apache/accumulo/core/conf/Property.java\nindex 9a02cb9bbc..4c507b1dab 100644\n--- a/core/src/main/java/org/apache/accumulo/core/conf/Property.java\n+++ b/core/src/main/java/org/apache/accumulo/core/conf/Property.java\n\n@@ -568,8 +568,8 @@ public enum Property {\n   // accumulo garbage collector properties\n   GC_PREFIX(\"gc.\", null, PropertyType.PREFIX,\n       \"Properties in this category affect the behavior of the accumulo garbage collector.\"),\n-  GC_CANDIDATE_BATCH_SIZE(\"gc.candidate.batch.size\", \"4000000\", PropertyType.COUNT,\n-          \"The batch size used for garbage collection. The default is effectively 8MB\"),\n+  GC_CANDIDATE_BATCH_SIZE(\"gc.candidate.batch.size\", \"8m\", PropertyType.BYTES,\n+          \"The batch size used for garbage collection.\"),\n   GC_CYCLE_START(\"gc.cycle.start\", \"30s\", PropertyType.TIMEDURATION,\n       \"Time to wait before attempting to garbage collect any old RFiles or write-ahead logs.\"),\n   GC_CYCLE_DELAY(\"gc.cycle.delay\", \"5m\", PropertyType.TIMEDURATION,\n"}}, {"oid": "9ac567cbf2453f190a68a1dd5c903ba2ab7a838a", "url": "https://github.com/apache/accumulo/commit/9ac567cbf2453f190a68a1dd5c903ba2ab7a838a", "message": "Property to bytes and convert to long", "committedDate": "2020-09-17T11:47:59Z", "type": "commit"}, {"oid": "8bdb74bad3494e6564a86026f318e677966089d4", "url": "https://github.com/apache/accumulo/commit/8bdb74bad3494e6564a86026f318e677966089d4", "message": "Formatting", "committedDate": "2020-09-17T12:44:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI1NTMzNg==", "url": "https://github.com/apache/accumulo/pull/1706#discussion_r490255336", "bodyText": "Although our type engine is case-insensitive, it is better to use upper-case, so it looks like MegaBytes, and not milliBytes. \ud83d\ude3a\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              GC_CANDIDATE_BATCH_SIZE(\"gc.candidate.batch.size\", \"8m\", PropertyType.BYTES,\n          \n          \n            \n              GC_CANDIDATE_BATCH_SIZE(\"gc.candidate.batch.size\", \"8M\", PropertyType.BYTES,", "author": "ctubbsii", "createdAt": "2020-09-17T13:41:31Z", "path": "core/src/main/java/org/apache/accumulo/core/conf/Property.java", "diffHunk": "@@ -568,8 +568,8 @@\n   // accumulo garbage collector properties\n   GC_PREFIX(\"gc.\", null, PropertyType.PREFIX,\n       \"Properties in this category affect the behavior of the accumulo garbage collector.\"),\n-  GC_CANDIDATE_BATCH_SIZE(\"gc.candidate.batch.size\", \"4000000\", PropertyType.COUNT,\n-          \"The batch size used for garbage collection. The default is effectively 8MB\"),\n+  GC_CANDIDATE_BATCH_SIZE(\"gc.candidate.batch.size\", \"8m\", PropertyType.BYTES,", "originalCommit": "8bdb74bad3494e6564a86026f318e677966089d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI2NTMyMg==", "url": "https://github.com/apache/accumulo/pull/1706#discussion_r490265322", "bodyText": "Fair, I had it capitalized but I didn't like the way it looked and saw we had a 1g somewhere.", "author": "Manno15", "createdAt": "2020-09-17T13:55:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI1NTMzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQwNTYwMg==", "url": "https://github.com/apache/accumulo/pull/1706#discussion_r490405602", "bodyText": "I'll take a look and make a separate PR to standardize everything on the case used by SI conventions, for all of our property descriptions and default values (uppercase for everything, except kilo, which is lowercase). It probably doesn't matter to anybody but me. \ud83d\ude3a", "author": "ctubbsii", "createdAt": "2020-09-17T16:40:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI1NTMzNg=="}], "type": "inlineReview", "revised_code": {"commit": "ee3c3bc026179142b3c236c473a8ce4053d28831", "chunk": "diff --git a/core/src/main/java/org/apache/accumulo/core/conf/Property.java b/core/src/main/java/org/apache/accumulo/core/conf/Property.java\nindex 327f045233..26c54af063 100644\n--- a/core/src/main/java/org/apache/accumulo/core/conf/Property.java\n+++ b/core/src/main/java/org/apache/accumulo/core/conf/Property.java\n\n@@ -568,7 +568,7 @@ public enum Property {\n   // accumulo garbage collector properties\n   GC_PREFIX(\"gc.\", null, PropertyType.PREFIX,\n       \"Properties in this category affect the behavior of the accumulo garbage collector.\"),\n-  GC_CANDIDATE_BATCH_SIZE(\"gc.candidate.batch.size\", \"8m\", PropertyType.BYTES,\n+  GC_CANDIDATE_BATCH_SIZE(\"gc.candidate.batch.size\", \"8M\", PropertyType.BYTES,\n       \"The batch size used for garbage collection.\"),\n   GC_CYCLE_START(\"gc.cycle.start\", \"30s\", PropertyType.TIMEDURATION,\n       \"Time to wait before attempting to garbage collect any old RFiles or write-ahead logs.\"),\n"}}, {"oid": "ee3c3bc026179142b3c236c473a8ce4053d28831", "url": "https://github.com/apache/accumulo/commit/ee3c3bc026179142b3c236c473a8ce4053d28831", "message": "capitalized that M", "committedDate": "2020-09-17T13:56:00Z", "type": "commit"}]}