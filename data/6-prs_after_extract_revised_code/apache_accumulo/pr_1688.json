{"pr_number": 1688, "pr_title": "Fix issues in prep for 1.10 release", "pr_createdAt": "2020-08-18T04:14:48Z", "pr_url": "https://github.com/apache/accumulo/pull/1688", "timeline": [{"oid": "921c1117214b818aaa6ba37080f960761a5cc915", "url": "https://github.com/apache/accumulo/commit/921c1117214b818aaa6ba37080f960761a5cc915", "message": "Bump snapshot versions to 1.10.0-SNAPSHOT", "committedDate": "2020-08-17T18:44:09Z", "type": "commit"}, {"oid": "7fa4d7d738da78592287041c11f1a6445a06c006", "url": "https://github.com/apache/accumulo/commit/7fa4d7d738da78592287041c11f1a6445a06c006", "message": "Fix quality issues in prep for 1.10 release\n\n* Converge the Hadoop 2 and Hadoop 3 assemblies, so only one is\n  necessary (tested both on Hadoop 2.6.5, 3.0.3, and 3.3.0 using\n  fluo-uno)\n* Bumped plugin versions and added timestamp flag for increased build\n  reproducibility; timestamp should automatically update during release\n  process; verified the built jars differ only in the contents of the\n  generated META-INF/DEPENDENCIES file when building with the Hadoop2\n  vs. the Hadoop3 profiles, and since this file doesn't matter, they are\n  now provably equivalent builds\n* Fixed some Hadoop profile issues, and updated Hadoop versions to\n  latest patch version in the minor release lines we had previously been\n  building with as our minimum supported versions\n* Bump Guava, and related code to work with both Hadoop 2 and 3;\n  suppress warnings or migrate code to avoid code paths that won't work\n  across Guava versions, for fewer class path surprises related to\n  Guava\n* Update asciidoc plugin, and fix various doc build issues warned about\n  by the plugin", "committedDate": "2020-08-18T04:02:20Z", "type": "commit"}, {"oid": "72bd9dd46dd3b46bfbf508da9838a86b0a121198", "url": "https://github.com/apache/accumulo/commit/72bd9dd46dd3b46bfbf508da9838a86b0a121198", "message": "Go back to Guava 14, for vfs2 on Hadoop 2\n\nMake assembly build with different bundled Guava and commons-vfs2, based\non whether it is intended for Hadoop 2 or 3.\n\nMake Accumulo code work with either version of Guava.", "committedDate": "2020-08-18T16:50:46Z", "type": "commit"}, {"oid": "70b2bf960a6194b358a566b1c65f2ef32e086bf8", "url": "https://github.com/apache/accumulo/commit/70b2bf960a6194b358a566b1c65f2ef32e086bf8", "message": "Undo dependency updates that break the build", "committedDate": "2020-08-18T19:33:46Z", "type": "commit"}, {"oid": "2eec612863e78114c41c48457afeb6074d5b3b3e", "url": "https://github.com/apache/accumulo/commit/2eec612863e78114c41c48457afeb6074d5b3b3e", "message": "Use last commons-io that doesn't break vfs2", "committedDate": "2020-08-18T19:40:21Z", "type": "commit"}, {"oid": "fa5a19260685905e843703f5fbd651407426cd6d", "url": "https://github.com/apache/accumulo/commit/fa5a19260685905e843703f5fbd651407426cd6d", "message": "Make Guava version configurable at build time", "committedDate": "2020-08-20T15:30:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4MzU3Nw==", "url": "https://github.com/apache/accumulo/pull/1688#discussion_r474183577", "bodyText": "Probably just a nit, but does changing the output format matter?  Duration will print out like: PT0.021850552S , Stopwatch is more \"user\" friendly with \"333.2 ms\"\nAlso, maybe unrelated by anything other than name, but there is a StopWatch class in org.apache.accumulo.core.util - it seems to be referenced only in org.apache.accumulo.server.client.BulkImporter.", "author": "EdColeman", "createdAt": "2020-08-20T18:20:59Z", "path": "server/gc/src/main/java/org/apache/accumulo/gc/replication/CloseWriteAheadLogReferences.java", "diffHunk": "@@ -104,28 +105,27 @@ public void run() {\n     Span findWalsSpan = Trace.start(\"findReferencedWals\");\n     HashSet<String> closed = null;\n     try {\n-      sw.start();\n+      startTime = System.nanoTime();\n       closed = getClosedLogs(conn);\n+      duration = Duration.ofNanos(System.nanoTime() - startTime);\n     } finally {\n-      sw.stop();\n       findWalsSpan.stop();\n     }\n \n-    log.info(\"Found \" + closed.size() + \" WALs referenced in metadata in \" + sw.toString());\n-    sw.reset();\n+    log.info(\"Found \" + closed.size() + \" WALs referenced in metadata in \" + duration);", "originalCommit": "fa5a19260685905e843703f5fbd651407426cd6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4NzEyNQ==", "url": "https://github.com/apache/accumulo/pull/1688#discussion_r474187125", "bodyText": "I tried really hard to preserve the format, without writing or copying code, and still supporting the various Guava versions, which had breaking changes in Stopwatch, and finally gave up. I don't think the format matters as much as the information... and I'm not sure the information even matters that much.", "author": "ctubbsii", "createdAt": "2020-08-20T18:27:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4MzU3Nw=="}], "type": "inlineReview", "revised_code": null}]}