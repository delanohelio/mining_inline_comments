{"pr_number": 461, "pr_title": "regex-update", "pr_createdAt": "2020-04-24T12:30:18Z", "pr_url": "https://github.com/constellation-app/constellation/pull/461", "timeline": [{"oid": "1660b7a23ef4816753512447fb89dba39bb271c2", "url": "https://github.com/constellation-app/constellation/commit/1660b7a23ef4816753512447fb89dba39bb271c2", "message": ":art: fixed some sonarqube security hotspots and bugs", "committedDate": "2020-04-24T03:24:04Z", "type": "commit"}, {"oid": "208070d51608109b8fe8478830a60787f30ae534", "url": "https://github.com/constellation-app/constellation/commit/208070d51608109b8fe8478830a60787f30ae534", "message": "Merge branch 'master' of https://github.com/constellation-app/constellation", "committedDate": "2020-04-24T03:24:15Z", "type": "commit"}, {"oid": "91f7ef99de562397e37c2413e2cc99a0bbb0ebc5", "url": "https://github.com/constellation-app/constellation/commit/91f7ef99de562397e37c2413e2cc99a0bbb0ebc5", "message": ":art: added default javafx stylesheets (caspian and modena)\n:art: added unit test for vertex type detection and validation\n:bug: fixed a couple of issues with type regex strings", "committedDate": "2020-04-24T10:05:06Z", "type": "commit"}, {"oid": "05dee16620cf2a24435bb5de722e4235b554a553", "url": "https://github.com/constellation-app/constellation/commit/05dee16620cf2a24435bb5de722e4235b554a553", "message": ":bug: updated PasswordObfuscator and PasswordDeobfuscator to use a secure mode and padding scheme\n:art: fixed an incorrect assignment in UndoGraphEditState", "committedDate": "2020-04-24T12:16:59Z", "type": "commit"}, {"oid": "9670743dde2a068b103ed1db6a96c3385e17fcac", "url": "https://github.com/constellation-app/constellation/commit/9670743dde2a068b103ed1db6a96c3385e17fcac", "message": "oops... i forgot to all all files in the last commit...\n:bug: updated PasswordObfuscator and PasswordDeobfuscator to use a secure mode and padding scheme\n:art: fixed an incorrect assignment in UndoGraphEditState", "committedDate": "2020-04-24T12:17:50Z", "type": "commit"}, {"oid": "2b5775e42bae290301be4603a1b22d86d5d37170", "url": "https://github.com/constellation-app/constellation/commit/2b5775e42bae290301be4603a1b22d86d5d37170", "message": "Merge branch 'master' of https://github.com/constellation-app/constellation", "committedDate": "2020-04-24T12:18:10Z", "type": "commit"}, {"oid": "91ae5a1ca65e88e500d72bdff821749d6fce8e5e", "url": "https://github.com/constellation-app/constellation/commit/91ae5a1ca65e88e500d72bdff821749d6fce8e5e", "message": ":art: renamed scatter arrangement to \"Scatter 3D\" and updated arrangement menu ordering", "committedDate": "2020-04-24T12:56:48Z", "type": "commit"}, {"oid": "6c5a2d7e9cbac4b7f4e12ec6979063ae73e98949", "url": "https://github.com/constellation-app/constellation/commit/6c5a2d7e9cbac4b7f4e12ec6979063ae73e98949", "message": ":art: updated author name", "committedDate": "2020-04-24T13:01:43Z", "type": "commit"}, {"oid": "9128b03f2f6ae18a5e95b3185bd06602920a9f8d", "url": "https://github.com/constellation-app/constellation/commit/9128b03f2f6ae18a5e95b3185bd06602920a9f8d", "message": ":art: fixed a minor typo\n:art: updated to latest JRE11 (in a previous commit)", "committedDate": "2020-04-24T13:03:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjI3MDE5OA==", "url": "https://github.com/constellation-app/constellation/pull/461#discussion_r416270198", "bodyText": "This is interesting. I didn't know we had to add this jar to work. I'll assume this was based on testing you did. Thanks!", "author": "arcturus2", "createdAt": "2020-04-28T01:56:15Z", "path": "CoreSecurity/src/au/gov/asd/tac/constellation/security/password/PasswordDeobfuscator.java", "diffHunk": "@@ -79,7 +80,7 @@ public static CharSequence deobfuscate(final ObfuscatedPassword pwd) {\n      * constellation\\CoreSecurity\\build\\classes on the command prompt and run\n      * the following command:\n      * <pre>\n-     * java -cp . au.gov.asd.tac.constellation.security.password.PasswordDeobfuscator\n+     * java -cp {path/to/org-openide-util-lookup.jar};. au.gov.asd.tac.constellation.security.password.PasswordDeobfuscator", "originalCommit": "9128b03f2f6ae18a5e95b3185bd06602920a9f8d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjI4Mzc0OQ==", "url": "https://github.com/constellation-app/constellation/pull/461#discussion_r416283749", "bodyText": "The lookup service is used for discovering the secret key (and now init vector) needed to encrypt/decrypt.", "author": "cygnus-x-1", "createdAt": "2020-04-28T02:38:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjI3MDE5OA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "ba92ea25a093c4c4c35236091984329181f2bb88", "url": "https://github.com/constellation-app/constellation/commit/ba92ea25a093c4c4c35236091984329181f2bb88", "message": ":art: updated build script with the correct jre references", "committedDate": "2020-04-28T02:46:26Z", "type": "commit"}, {"oid": "8e1ed55423c7850c475a5d56b4bd06aca5f33369", "url": "https://github.com/constellation-app/constellation/commit/8e1ed55423c7850c475a5d56b4bd06aca5f33369", "message": "Merge branch 'master' into regex-update", "committedDate": "2020-04-28T02:49:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODUyMTM3OQ==", "url": "https://github.com/constellation-app/constellation/pull/461#discussion_r418521379", "bodyText": "I'll fix this after merging @cygnus-x-1", "author": "arcturus2", "createdAt": "2020-05-01T12:28:47Z", "path": "CoreAnalyticSchema/test/unit/src/au/gov/asd/tac/constellation/graph/schema/analytic/concept/AnalyticConceptNGTest.java", "diffHunk": "@@ -0,0 +1,425 @@\n+/*\n+ * To change this license header, choose License Headers in Project Properties.\n+ * To change this template file, choose Tools | Templates\n+ * and open the template in the editor.\n+ */", "originalCommit": "8e1ed55423c7850c475a5d56b4bd06aca5f33369", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2MTA2MQ==", "url": "https://github.com/constellation-app/constellation/pull/461#discussion_r418561061", "bodyText": "Oops... I'll fix that.", "author": "cygnus-x-1", "createdAt": "2020-05-01T14:18:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODUyMTM3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "edf64cf6bf4726bd18f9f5b89f4dd308d4f13164", "chunk": "diff --git a/CoreAnalyticSchema/test/unit/src/au/gov/asd/tac/constellation/graph/schema/analytic/concept/AnalyticConceptNGTest.java b/CoreAnalyticSchema/test/unit/src/au/gov/asd/tac/constellation/graph/schema/analytic/concept/AnalyticConceptNGTest.java\nindex 3904ab521..cabc724d4 100644\n--- a/CoreAnalyticSchema/test/unit/src/au/gov/asd/tac/constellation/graph/schema/analytic/concept/AnalyticConceptNGTest.java\n+++ b/CoreAnalyticSchema/test/unit/src/au/gov/asd/tac/constellation/graph/schema/analytic/concept/AnalyticConceptNGTest.java\n\n@@ -1,7 +1,17 @@\n /*\n- * To change this license header, choose License Headers in Project Properties.\n- * To change this template file, choose Tools | Templates\n- * and open the template in the editor.\n+ * Copyright 2010-2019 Australian Signals Directorate\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n  */\n package au.gov.asd.tac.constellation.graph.schema.analytic.concept;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODUyNjAzMA==", "url": "https://github.com/constellation-app/constellation/pull/461#discussion_r418526030", "bodyText": "@cygnus-x-1 i don't get why we need to do this. I tested undo and redo and it works fine in this PR but doing a forEach inside the for loop is going to be a performance hit and feels unnecessary. objectMap gets added to in addObject().", "author": "arcturus2", "createdAt": "2020-05-01T12:44:34Z", "path": "CoreGraphFramework/src/au/gov/asd/tac/constellation/graph/undo/UndoGraphEditState.java", "diffHunk": "@@ -138,6 +136,7 @@ public UndoGraphEditState(DataInputStream in) throws Exception {\n                 objectClass = Class.forName(objectName);\n                 classMap.put(objectClassIndex, objectClass);\n             }\n+            classMap.forEach((k, v) -> objectMap.put(v, k));", "originalCommit": "8e1ed55423c7850c475a5d56b4bd06aca5f33369", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2MzQyMw==", "url": "https://github.com/constellation-app/constellation/pull/461#discussion_r418563423", "bodyText": "addObject is irrelevant here as the intention here is to construct the class from a previous state. I get what I was going for here, as objectMap was not being initialized properly, but I'm not sure why I did it this way when I could have just added each entry to objectMap alongside classMap. This is a bug (that we didn't notice because it's not used), but I'll update it to a more efficient implementation.", "author": "cygnus-x-1", "createdAt": "2020-05-01T14:24:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODUyNjAzMA=="}], "type": "inlineReview", "revised_code": {"commit": "edf64cf6bf4726bd18f9f5b89f4dd308d4f13164", "chunk": "diff --git a/CoreGraphFramework/src/au/gov/asd/tac/constellation/graph/undo/UndoGraphEditState.java b/CoreGraphFramework/src/au/gov/asd/tac/constellation/graph/undo/UndoGraphEditState.java\nindex d3dde6936..15a7dc713 100644\n--- a/CoreGraphFramework/src/au/gov/asd/tac/constellation/graph/undo/UndoGraphEditState.java\n+++ b/CoreGraphFramework/src/au/gov/asd/tac/constellation/graph/undo/UndoGraphEditState.java\n\n@@ -117,34 +118,38 @@ public class UndoGraphEditState {\n             longStack[i] = in.readLong();\n         }\n \n+        final Map<Integer, Class<?>> classMap = new HashMap<>();\n+        classMap.put(0, null);\n+        \n         objectCount = in.readInt();\n-        objectStack = new Object[objectCount];\n         byte[] buffer = new byte[1024];\n-        Map<Integer, Class<?>> classMap = new HashMap<>();\n         for (int i = 0; i < objectCount; i++) {\n-            int objectClassIndex = in.readInt();\n-            Class<?> objectClass;\n+            final int objectClassIndex = in.readInt();\n+            final Class<?> objectClass;\n             if (classMap.containsKey(objectClassIndex)) {\n                 objectClass = classMap.get(objectClassIndex);\n             } else {\n-                int classLength = in.readInt();\n+                final int classLength = in.readInt();\n                 if (classLength > buffer.length) {\n                     buffer = Arrays.copyOf(buffer, classLength);\n                 }\n                 in.read(buffer, 0, classLength);\n-                String objectName = new String(buffer, 0, classLength, UTF8);\n+                final String objectName = new String(buffer, 0, classLength, UTF8);\n                 objectClass = Class.forName(objectName);\n-                classMap.put(objectClassIndex, objectClass);\n             }\n-            classMap.forEach((k, v) -> objectMap.put(v, k));\n+            classMap.put(objectClassIndex, objectClass);\n+            objectMap.put(objectClass, objectClassIndex);\n         }\n+        \n+        objectStack = new Object[objectCount];\n+        Arrays.setAll(objectStack, index -> classMap.get(index));\n     }\n \n     public byte[] getByteStack() {\n         return byteStack;\n     }\n \n-    public void setByteStack(byte[] byteStack) {\n+    public void setByteStack(final byte[] byteStack) {\n         this.byteStack = byteStack;\n     }\n \n"}}, {"oid": "edf64cf6bf4726bd18f9f5b89f4dd308d4f13164", "url": "https://github.com/constellation-app/constellation/commit/edf64cf6bf4726bd18f9f5b89f4dd308d4f13164", "message": ":art: changes based on pull request feedback", "committedDate": "2020-05-01T14:47:10Z", "type": "commit"}, {"oid": "65c013395a1f0597d5a6860c45b1876b4f33e2d7", "url": "https://github.com/constellation-app/constellation/commit/65c013395a1f0597d5a6860c45b1876b4f33e2d7", "message": "Merge branch 'master' into regex-update", "committedDate": "2020-05-01T14:47:56Z", "type": "commit"}]}