{"pr_number": 570, "pr_title": "Table View Pagination", "pr_createdAt": "2020-06-09T06:09:52Z", "pr_url": "https://github.com/constellation-app/constellation/pull/570", "timeline": [{"oid": "799e51ab0515eab48082064ce24d12d6435795ae", "url": "https://github.com/constellation-app/constellation/commit/799e51ab0515eab48082064ce24d12d6435795ae", "message": "added pagination to table view", "committedDate": "2020-06-09T06:04:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzIzOTQxNA==", "url": "https://github.com/constellation-app/constellation/pull/570#discussion_r437239414", "bodyText": "Have you checked whether sorting and filtering still work across all table data?", "author": "cygnus-x-1", "createdAt": "2020-06-09T08:45:56Z", "path": "CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java", "diffHunk": "@@ -941,6 +944,25 @@ private void loadPreferences() {\n             }\n         }\n     }\n+    \n+    private Node createPage(final int pageIndex, final List<ObservableList<String>> rows) {\n+        if (rows != null) {\n+            final int fromIndex = pageIndex * MAX_ROWS_PER_PAGE;\n+            final int toIndex = Math.min(fromIndex + MAX_ROWS_PER_PAGE, rows.size());\n+\n+            table.setItems(FXCollections.observableArrayList(rows.subList(fromIndex, toIndex)));\n+        }\n+        \n+        return new BorderPane(table);\n+    }\n+    \n+    private void paginate(final List<ObservableList<String>> rows) {\n+        final Pagination pagination = new Pagination(table.getItems().size() / MAX_ROWS_PER_PAGE + 1);", "originalCommit": "799e51ab0515eab48082064ce24d12d6435795ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzg0MTU0Ng==", "url": "https://github.com/constellation-app/constellation/pull/570#discussion_r437841546", "bodyText": "Haven't gotten to that yet. Like I said previously, there is still a bit of testing to be done and this would be part of it", "author": "antares1470", "createdAt": "2020-06-10T03:37:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzIzOTQxNA=="}], "type": "inlineReview", "revised_code": {"commit": "945801f8d06790b72496f141ff5da2944e3afd56", "chunk": "diff --git a/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java b/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java\nindex bb16acf47..2b561ff40 100644\n--- a/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java\n+++ b/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java\n\n@@ -958,7 +958,7 @@ public final class TableViewPane extends BorderPane {\n     \n     private void paginate(final List<ObservableList<String>> rows) {\n         final Pagination pagination = new Pagination(table.getItems().size() / MAX_ROWS_PER_PAGE + 1);\n-        pagination.setPageFactory((index) -> createPage(index, rows));\n+        pagination.setPageFactory(index -> createPage(index, rows));\n         Platform.runLater(() -> {\n             setCenter(pagination);\n         });\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzIzOTg0NA==", "url": "https://github.com/constellation-app/constellation/pull/570#discussion_r437239844", "bodyText": "Why do you pass null in here initially?", "author": "cygnus-x-1", "createdAt": "2020-06-09T08:46:33Z", "path": "CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java", "diffHunk": "@@ -181,8 +184,8 @@ public TableViewPane(final TableViewTopComponent parent) {\n         this.table = new TableView<>();\n         table.itemsProperty().addListener((v, o, n) -> table.refresh());\n         table.getSelectionModel().setSelectionMode(SelectionMode.MULTIPLE);\n-        table.setPadding(new Insets(5));\n-        setCenter(table);\n+        table.setPadding(new Insets(5));      \n+        paginate(null);", "originalCommit": "799e51ab0515eab48082064ce24d12d6435795ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzg0MjUzMw==", "url": "https://github.com/constellation-app/constellation/pull/570#discussion_r437842533", "bodyText": "The case I happened to be testing before I made the PR was with Table View already open when starting Constellation. Passing null here is more because I couldn't find a better object to pass here (since there doesn't appear to be a useful field I could find containing a list of the data). There probably is a better value to pass for other cases.. I just haven't come up with it yet :) (I could probably create it if all else fails)", "author": "antares1470", "createdAt": "2020-06-10T03:42:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzIzOTg0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzg0MjkyNQ==", "url": "https://github.com/constellation-app/constellation/pull/570#discussion_r437842925", "bodyText": "Note: If there is a useful field with the data I'm after, there probably won't be a need to pass any parameters into paginate", "author": "antares1470", "createdAt": "2020-06-10T03:44:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzIzOTg0NA=="}], "type": "inlineReview", "revised_code": {"commit": "047d4b92f1e7f98f8eb69c4d01ceaf1c8582d675", "chunk": "diff --git a/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java b/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java\nindex bb16acf47..3f8055a15 100644\n--- a/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java\n+++ b/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewPane.java\n\n@@ -185,7 +188,7 @@ public final class TableViewPane extends BorderPane {\n         table.itemsProperty().addListener((v, o, n) -> table.refresh());\n         table.getSelectionModel().setSelectionMode(SelectionMode.MULTIPLE);\n         table.setPadding(new Insets(5));      \n-        paginate(null);\n+        paginate(rowList);\n \n         // TODO: experiment with caching\n         table.setCache(false);\n"}}, {"oid": "326f769b889dee2c1f0515c180f5eecd734ca815", "url": "https://github.com/constellation-app/constellation/commit/326f769b889dee2c1f0515c180f5eecd734ca815", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-06-14T22:37:50Z", "type": "commit"}, {"oid": "945801f8d06790b72496f141ff5da2944e3afd56", "url": "https://github.com/constellation-app/constellation/commit/945801f8d06790b72496f141ff5da2944e3afd56", "message": "fixed sonar smell", "committedDate": "2020-06-14T22:58:12Z", "type": "commit"}, {"oid": "047d4b92f1e7f98f8eb69c4d01ceaf1c8582d675", "url": "https://github.com/constellation-app/constellation/commit/047d4b92f1e7f98f8eb69c4d01ceaf1c8582d675", "message": "fixed filtering", "committedDate": "2020-06-16T01:51:38Z", "type": "commit"}, {"oid": "04aef022b429dc05acf5b7c26a79365bac836603", "url": "https://github.com/constellation-app/constellation/commit/04aef022b429dc05acf5b7c26a79365bac836603", "message": "fixed sonar smell", "committedDate": "2020-06-16T02:12:20Z", "type": "commit"}, {"oid": "9a82d9ed39c97ad69c9ed3f632c4190f11e4c224", "url": "https://github.com/constellation-app/constellation/commit/9a82d9ed39c97ad69c9ed3f632c4190f11e4c224", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-06-16T02:13:13Z", "type": "commit"}, {"oid": "af63d538db19b2608d4608f1808a9aeddf225eb3", "url": "https://github.com/constellation-app/constellation/commit/af63d538db19b2608d4608f1808a9aeddf225eb3", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-06-25T23:51:15Z", "type": "commit"}, {"oid": "aa0a4ac7479b6568161473afc72f80ab6bda8c7e", "url": "https://github.com/constellation-app/constellation/commit/aa0a4ac7479b6568161473afc72f80ab6bda8c7e", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-06-29T03:29:42Z", "type": "commit"}, {"oid": "0066e45456e086853d175f0cff1e622df0901a86", "url": "https://github.com/constellation-app/constellation/commit/0066e45456e086853d175f0cff1e622df0901a86", "message": "mostly got sorting fixed", "committedDate": "2020-07-06T05:38:25Z", "type": "commit"}, {"oid": "f4bb9d3046ed3227f8a7fc6f82298e76839d34e4", "url": "https://github.com/constellation-app/constellation/commit/f4bb9d3046ed3227f8a7fc6f82298e76839d34e4", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-07-06T05:40:09Z", "type": "commit"}, {"oid": "1c64dce8d3952816b1257443569d242322e30917", "url": "https://github.com/constellation-app/constellation/commit/1c64dce8d3952816b1257443569d242322e30917", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-07-06T22:36:11Z", "type": "commit"}, {"oid": "0610cbc28a05150b79f2d075fb002d7d2ce85475", "url": "https://github.com/constellation-app/constellation/commit/0610cbc28a05150b79f2d075fb002d7d2ce85475", "message": "fixed sorting", "committedDate": "2020-07-07T01:25:37Z", "type": "commit"}, {"oid": "12a0f476952ef36241ae609600c7867c3bf1ee78", "url": "https://github.com/constellation-app/constellation/commit/12a0f476952ef36241ae609600c7867c3bf1ee78", "message": "fixed sonar smell", "committedDate": "2020-07-07T01:33:00Z", "type": "commit"}, {"oid": "bb65ee147179369edbd09d35eb43c1ade6c9240d", "url": "https://github.com/constellation-app/constellation/commit/bb65ee147179369edbd09d35eb43c1ade6c9240d", "message": "started fixing selection", "committedDate": "2020-07-09T03:27:44Z", "type": "commit"}, {"oid": "435942eedbe6e8a1154a47c6d8b608b8f7776ad6", "url": "https://github.com/constellation-app/constellation/commit/435942eedbe6e8a1154a47c6d8b608b8f7776ad6", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-07-09T03:41:29Z", "type": "commit"}, {"oid": "496a7b8719959d9f4d05a893597eb5a1f5c044c1", "url": "https://github.com/constellation-app/constellation/commit/496a7b8719959d9f4d05a893597eb5a1f5c044c1", "message": "resolved merge conflicts", "committedDate": "2020-07-20T00:52:31Z", "type": "commit"}, {"oid": "dea65018299c5bbc9527862a1115893988a3a94b", "url": "https://github.com/constellation-app/constellation/commit/dea65018299c5bbc9527862a1115893988a3a94b", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-07-26T23:50:51Z", "type": "commit"}, {"oid": "e7dd4ce5735805dc8ea61aa32315888a205ec7b0", "url": "https://github.com/constellation-app/constellation/commit/e7dd4ce5735805dc8ea61aa32315888a205ec7b0", "message": "fixed selection and sorting in table", "committedDate": "2020-07-29T02:30:46Z", "type": "commit"}, {"oid": "eff9e5d0e7a35baf0014de4fe5778a9762ebb8f4", "url": "https://github.com/constellation-app/constellation/commit/eff9e5d0e7a35baf0014de4fe5778a9762ebb8f4", "message": "minor update", "committedDate": "2020-07-31T02:19:27Z", "type": "commit"}, {"oid": "29b0c8117a52711973d176e5c92c667e1f16b520", "url": "https://github.com/constellation-app/constellation/commit/29b0c8117a52711973d176e5c92c667e1f16b520", "message": "resolved problems in selected only mode", "committedDate": "2020-08-06T00:11:58Z", "type": "commit"}, {"oid": "033382b98763aa53747b996f8e47710a7d2222b8", "url": "https://github.com/constellation-app/constellation/commit/033382b98763aa53747b996f8e47710a7d2222b8", "message": "fixed issues with sorting + filtering", "committedDate": "2020-08-07T00:00:21Z", "type": "commit"}, {"oid": "87bbf0f84007954144fec430643c36929a417748", "url": "https://github.com/constellation-app/constellation/commit/87bbf0f84007954144fec430643c36929a417748", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-08-07T00:00:57Z", "type": "commit"}, {"oid": "ccf438bf849a1a848bc7e94db2ad4814e568f2b1", "url": "https://github.com/constellation-app/constellation/commit/ccf438bf849a1a848bc7e94db2ad4814e568f2b1", "message": "resolved merge conflict", "committedDate": "2020-08-10T01:36:26Z", "type": "commit"}, {"oid": "1585c08b97ad05a26d167cc5eac5c5ecebefd9d6", "url": "https://github.com/constellation-app/constellation/commit/1585c08b97ad05a26d167cc5eac5c5ecebefd9d6", "message": "updated with settings option to change page size", "committedDate": "2020-08-10T04:59:18Z", "type": "commit"}, {"oid": "db9221cfa54b09cd91bc22ef29f2cc1dd8069a58", "url": "https://github.com/constellation-app/constellation/commit/db9221cfa54b09cd91bc22ef29f2cc1dd8069a58", "message": "removed a static modifier", "committedDate": "2020-08-10T05:25:32Z", "type": "commit"}, {"oid": "39a9262e35627ade1489c50444eccc2f6c8719a8", "url": "https://github.com/constellation-app/constellation/commit/39a9262e35627ade1489c50444eccc2f6c8719a8", "message": "handled paging when graph is closed", "committedDate": "2020-08-12T04:28:35Z", "type": "commit"}, {"oid": "54b020cda7689b13b61964ffe3196bbc54fee623", "url": "https://github.com/constellation-app/constellation/commit/54b020cda7689b13b61964ffe3196bbc54fee623", "message": "first draft adding page size to load/save preferences", "committedDate": "2020-08-13T05:27:28Z", "type": "commit"}, {"oid": "d3136e1ea0d497eefad482bf335a3e0842c29ad4", "url": "https://github.com/constellation-app/constellation/commit/d3136e1ea0d497eefad482bf335a3e0842c29ad4", "message": "sonar fix", "committedDate": "2020-08-14T01:28:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQwNTgwNw==", "url": "https://github.com/constellation-app/constellation/pull/570#discussion_r470405807", "bodyText": "I managed a null pointer here by loading an old preference. Maybe check is necessary?", "author": "aldebaran30701", "createdAt": "2020-08-14T04:38:23Z", "path": "CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/io/TableViewPreferencesIOUtilities.java", "diffHunk": "@@ -141,8 +146,11 @@ public static void savePreferences(GraphElementType tableType, final TableView<O\n                 if (colSortNode.get(sortColumn).asText().equals(\"DESCENDING\")) {\n                     sortType = TableColumn.SortType.DESCENDING;\n                 }\n+                \n+                // Extract page size details\n+                pageSize = pageSizeNode.intValue();", "originalCommit": "d3136e1ea0d497eefad482bf335a3e0842c29ad4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQxMTc2MQ==", "url": "https://github.com/constellation-app/constellation/pull/570#discussion_r470411761", "bodyText": "Good pick up. Will add a null check for old preferences", "author": "antares1470", "createdAt": "2020-08-14T05:04:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQwNTgwNw=="}], "type": "inlineReview", "revised_code": {"commit": "82c50655c0de52bb215178768afc16e8d8c69b78", "chunk": "diff --git a/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/io/TableViewPreferencesIOUtilities.java b/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/io/TableViewPreferencesIOUtilities.java\nindex b485fa657..4152c0228 100644\n--- a/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/io/TableViewPreferencesIOUtilities.java\n+++ b/CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/io/TableViewPreferencesIOUtilities.java\n\n@@ -148,7 +150,11 @@ public class TableViewPreferencesIOUtilities {\n                 }\n                 \n                 // Extract page size details\n-                pageSize = pageSizeNode.intValue();\n+                if (pageSizeNode == null) {\n+                    pageSize = defaultPageSize;\n+                } else {\n+                    pageSize = pageSizeNode.intValue();\n+                }\n             }\n         }\n         return new ThreeTuple<>(colOrder, new Tuple<>(sortColumn, sortType), pageSize);\n"}}, {"oid": "82c50655c0de52bb215178768afc16e8d8c69b78", "url": "https://github.com/constellation-app/constellation/commit/82c50655c0de52bb215178768afc16e8d8c69b78", "message": "added default page size preference for old preference saves", "committedDate": "2020-08-14T05:44:24Z", "type": "commit"}, {"oid": "da39c2e7c44aca96af19cfab9fbbcc897792231e", "url": "https://github.com/constellation-app/constellation/commit/da39c2e7c44aca96af19cfab9fbbcc897792231e", "message": "updated algorithm for number of pages required", "committedDate": "2020-08-17T02:32:06Z", "type": "commit"}, {"oid": "d1635575c369ca29c314c7375ed8621dcd0d9fc8", "url": "https://github.com/constellation-app/constellation/commit/d1635575c369ca29c314c7375ed8621dcd0d9fc8", "message": "Merge branch 'master' into table-performance", "committedDate": "2020-08-17T03:57:36Z", "type": "commit"}, {"oid": "f4cc9efd6d464b78b5f13513ab7afa554216f23d", "url": "https://github.com/constellation-app/constellation/commit/f4cc9efd6d464b78b5f13513ab7afa554216f23d", "message": "resolved merge conflict", "committedDate": "2020-08-25T00:23:56Z", "type": "commit"}, {"oid": "3300e4b6d1e65fb90fef6345ceeea7868c584854", "url": "https://github.com/constellation-app/constellation/commit/3300e4b6d1e65fb90fef6345ceeea7868c584854", "message": "fixed merge conflicts", "committedDate": "2020-08-28T03:38:31Z", "type": "commit"}, {"oid": "e1b336e3892dd39150e2c5419626eefdf2c05152", "url": "https://github.com/constellation-app/constellation/commit/e1b336e3892dd39150e2c5419626eefdf2c05152", "message": "resolved merge conflict", "committedDate": "2020-09-02T05:48:52Z", "type": "commit"}]}