{"pr_number": 317, "pr_title": "Rest Service", "pr_createdAt": "2020-03-21T05:09:24Z", "pr_url": "https://github.com/constellation-app/constellation/pull/317", "timeline": [{"oid": "ee282d18e4cc6d74eec34e21f55723666e858aa0", "url": "https://github.com/constellation-app/constellation/commit/ee282d18e4cc6d74eec34e21f55723666e858aa0", "message": "REST services initial checkin - working list_services and list_plugins.", "committedDate": "2020-03-06T07:26:06Z", "type": "commit"}, {"oid": "e767613fb5d4cbde6a927462c6284350b54fafa3", "url": "https://github.com/constellation-app/constellation/commit/e767613fb5d4cbde6a927462c6284350b54fafa3", "message": "Use PluginParameters; GetPluginParameters service.", "committedDate": "2020-03-09T05:49:13Z", "type": "commit"}, {"oid": "5e103034664a7eba001c6369c54cde168b04d044", "url": "https://github.com/constellation-app/constellation/commit/5e103034664a7eba001c6369c54cde168b04d044", "message": "RestServices functionality and tidying up.\n\n- Add HTTP method for services.\n- Implement icon services.\n- Implement service description service.\n- Swagger JSON updated for new servlet.\n- Python client mods to allow error discovery.", "committedDate": "2020-03-10T04:59:33Z", "type": "commit"}, {"oid": "2b5ca9677851732b42ba2c90c45d1bfcba03650e", "url": "https://github.com/constellation-app/constellation/commit/2b5ca9677851732b42ba2c90c45d1bfcba03650e", "message": "Remove obsolete imports.", "committedDate": "2020-03-10T08:43:26Z", "type": "commit"}, {"oid": "f7d128eed17732730d9aee25544e8b7e60517b7f", "url": "https://github.com/constellation-app/constellation/commit/f7d128eed17732730d9aee25544e8b7e60517b7f", "message": "Add reflection and named color services.", "committedDate": "2020-03-10T10:12:09Z", "type": "commit"}, {"oid": "ee5d530efb812c32a5aeebb9e7552b052afb09f8", "url": "https://github.com/constellation-app/constellation/commit/ee5d530efb812c32a5aeebb9e7552b052afb09f8", "message": "Add ServiceRegistry; tidy up various things.", "committedDate": "2020-03-13T06:22:44Z", "type": "commit"}, {"oid": "0bce9ea1b8a055c2a6a40214203fb288f6d9ec37", "url": "https://github.com/constellation-app/constellation/commit/0bce9ea1b8a055c2a6a40214203fb288f6d9ec37", "message": "Dynamically update the swagger JSON with service info.", "committedDate": "2020-03-13T09:53:20Z", "type": "commit"}, {"oid": "20357ad9471c96e1ac9e49cc5d4ec1e9300dd72f", "url": "https://github.com/constellation-app/constellation/commit/20357ad9471c96e1ac9e49cc5d4ec1e9300dd72f", "message": "Factor out parameter parsing from JSON; fix REST file transport for services.", "committedDate": "2020-03-13T11:23:39Z", "type": "commit"}, {"oid": "4ca615fbe9c4b0828035854b108294b32b2d68af", "url": "https://github.com/constellation-app/constellation/commit/4ca615fbe9c4b0828035854b108294b32b2d68af", "message": "Remove IconServlet and associated code; use new icon service.", "committedDate": "2020-03-17T22:36:02Z", "type": "commit"}, {"oid": "bdc969ffc0b3691e1af2d2924634fd38b1600a37", "url": "https://github.com/constellation-app/constellation/commit/bdc969ffc0b3691e1af2d2924634fd38b1600a37", "message": "More services.", "committedDate": "2020-03-18T00:44:51Z", "type": "commit"}, {"oid": "be07fcbeff963128162e34a4d83d8fe105743efe", "url": "https://github.com/constellation-app/constellation/commit/be07fcbeff963128162e34a4d83d8fe105743efe", "message": "A bunch more services.", "committedDate": "2020-03-18T06:09:34Z", "type": "commit"}, {"oid": "a4598c861e96e24cdfffc980dec8fb94ebea8f8c", "url": "https://github.com/constellation-app/constellation/commit/a4598c861e96e24cdfffc980dec8fb94ebea8f8c", "message": "Even more services.", "committedDate": "2020-03-18T10:21:10Z", "type": "commit"}, {"oid": "e8a6d425213051b66bdc92a26ca0e42ba59fc8f3", "url": "https://github.com/constellation-app/constellation/commit/e8a6d425213051b66bdc92a26ca0e42ba59fc8f3", "message": "Nearly there with the services.", "committedDate": "2020-03-18T11:31:25Z", "type": "commit"}, {"oid": "2583c1061805f8655c7c88daa473097a90378b3e", "url": "https://github.com/constellation-app/constellation/commit/2583c1061805f8655c7c88daa473097a90378b3e", "message": "Tidy up Swagger JSON.", "committedDate": "2020-03-18T11:41:51Z", "type": "commit"}, {"oid": "7c115a729c93c81fd895a22487e0ebc6e666ebab", "url": "https://github.com/constellation-app/constellation/commit/7c115a729c93c81fd895a22487e0ebc6e666ebab", "message": "The last of the services; add icons for REST stuff.", "committedDate": "2020-03-19T04:11:24Z", "type": "commit"}, {"oid": "478ec7e5543f1aee0b8d897aeb83c4d59fb4ef89", "url": "https://github.com/constellation-app/constellation/commit/478ec7e5543f1aee0b8d897aeb83c4d59fb4ef89", "message": "New version of Swagger, so new JSON template.", "committedDate": "2020-03-19T06:35:18Z", "type": "commit"}, {"oid": "900ce6bec17d077c663ad43e173c8b73851d11b1", "url": "https://github.com/constellation-app/constellation/commit/900ce6bec17d077c663ad43e173c8b73851d11b1", "message": "Merge branch 'master-nb11' into rest-services", "committedDate": "2020-03-20T00:23:41Z", "type": "commit"}, {"oid": "0dd64c5b71b41fbc33c269cd096098c757ae29e2", "url": "https://github.com/constellation-app/constellation/commit/0dd64c5b71b41fbc33c269cd096098c757ae29e2", "message": "Remove deprecated BooleanStateAction; remove deprecated .newInstance().", "committedDate": "2020-03-20T05:05:32Z", "type": "commit"}, {"oid": "dae9550e31e425925556d02f71273f118e4b980e", "url": "https://github.com/constellation-app/constellation/commit/dae9550e31e425925556d02f71273f118e4b980e", "message": "Merge branch 'master-nb11' into rest-services", "committedDate": "2020-03-20T05:21:15Z", "type": "commit"}, {"oid": "6b23561ca367b346e2d5209be8168aeed9a9fd87", "url": "https://github.com/constellation-app/constellation/commit/6b23561ca367b346e2d5209be8168aeed9a9fd87", "message": "Fix for color structure change.", "committedDate": "2020-03-20T06:12:50Z", "type": "commit"}, {"oid": "98f83e5fbd279202d9bf27d2a6a9c815401e41a6", "url": "https://github.com/constellation-app/constellation/commit/98f83e5fbd279202d9bf27d2a6a9c815401e41a6", "message": "Unqualify service parameter names; add javadocs.", "committedDate": "2020-03-21T01:54:38Z", "type": "commit"}, {"oid": "4a48fe6c30f0c264e2c05c9ec749573c62afeb5e", "url": "https://github.com/constellation-app/constellation/commit/4a48fe6c30f0c264e2c05c9ec749573c62afeb5e", "message": "Merge branch 'master-nb11' into rest-services", "committedDate": "2020-03-21T04:32:42Z", "type": "commit"}, {"oid": "95f85ac85271e141befe4d0320382216f0e4d59b", "url": "https://github.com/constellation-app/constellation/commit/95f85ac85271e141befe4d0320382216f0e4d59b", "message": "Merge pull request #279 from algol60/rest-services\n\nRest services", "committedDate": "2020-03-21T05:07:45Z", "type": "commit"}, {"oid": "26a0081d629d0228912cdc9c005f5d514cafef54", "url": "https://github.com/constellation-app/constellation/commit/26a0081d629d0228912cdc9c005f5d514cafef54", "message": "Fix a bunch of SonarCloud issues.", "committedDate": "2020-03-22T10:10:10Z", "type": "commit"}, {"oid": "65b01a4cd969e0d0588a8e13d2ed7cbbea9c2c4a", "url": "https://github.com/constellation-app/constellation/commit/65b01a4cd969e0d0588a8e13d2ed7cbbea9c2c4a", "message": "Merge pull request #318 from algol60/rest-services\n\nFix a bunch of SonarCloud issues.", "committedDate": "2020-03-22T12:03:13Z", "type": "commit"}, {"oid": "b5897ad95d42c8f5c9455ba5584d46ac9f3a35c1", "url": "https://github.com/constellation-app/constellation/commit/b5897ad95d42c8f5c9455ba5584d46ac9f3a35c1", "message": "Sonar cleanups.", "committedDate": "2020-03-23T01:35:15Z", "type": "commit"}, {"oid": "aa87843d4197bcb924572e249c8ba265f4216f93", "url": "https://github.com/constellation-app/constellation/commit/aa87843d4197bcb924572e249c8ba265f4216f93", "message": "Fix #319.\n\nWhen you do a get_dataframe, colors end up as Python lists, so red is the Python list [1.0, 0.0, 0.0, 1.0].\n\nFirst problem: the AddRecordStore service used:\n\nrs.set(h, jn.asText());\n\nto set a header value, and when jn is an array, this comes out as \"\", so no color. Fixed that.\n\nThis eventually ends up as the string \"[1.0, 0.0, 0.0, 1.0]\", which is passed to ConstellationColor.fromRgbWithCommaColor() (because ConstellationColor.getColorValue() spots a comma), which falls over because of the surrounding brackets.\n\nI added:\n\n        final String c = color.startsWith(\"[\") && color.endsWith(\"]\") ? color.substring(1, color.length()-1) : color;\n\nin there, and it works.", "committedDate": "2020-03-23T02:41:43Z", "type": "commit"}, {"oid": "a93dabb06e985774bf13938fb2ccb87a59eb1bfe", "url": "https://github.com/constellation-app/constellation/commit/a93dabb06e985774bf13938fb2ccb87a59eb1bfe", "message": "Merge branch 'master-nb11' into master-nb11-rest-service", "committedDate": "2020-03-23T03:41:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwODg5Nw==", "url": "https://github.com/constellation-app/constellation/pull/317#discussion_r396208897", "bodyText": "Was this meant to be removed?", "author": "antares1470", "createdAt": "2020-03-23T04:33:52Z", "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java", "diffHunk": "@@ -180,7 +179,6 @@ public static synchronized int start() {\n                     try {\n                         server.join();\n                     } catch (InterruptedException e) {\n-                        Thread.currentThread().interrupt();", "originalCommit": "a93dabb06e985774bf13938fb2ccb87a59eb1bfe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIxNTc0MQ==", "url": "https://github.com/constellation-app/constellation/pull/317#discussion_r396215741", "bodyText": "nope I will have it added back in.", "author": "arcturus2", "createdAt": "2020-03-23T05:08:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwODg5Nw=="}], "type": "inlineReview", "revised_code": {"commit": "60889e762e3ca9e551a7eaf92233c8b072de8fdb", "chunk": "diff --git a/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java b/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java\nindex 83d2694ac..1d00c1a94 100644\n--- a/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java\n+++ b/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java\n\n@@ -178,8 +179,9 @@ public class WebServer {\n                 final Thread webserver = new Thread(() -> {\n                     try {\n                         server.join();\n-                    } catch (InterruptedException e) {\n-                        throw new RuntimeException(e);\n+                    } catch (final InterruptedException ex) {\n+                        Thread.currentThread().interrupt();\n+                        throw new RuntimeException(ex);\n                     } finally {\n                         // Play nice and clean up (if Netbeans lets us).\n                         restFile.delete();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwOTEzMQ==", "url": "https://github.com/constellation-app/constellation/pull/317#discussion_r396209131", "bodyText": "Is there a reason why a constant isn't being used anymore?", "author": "antares1470", "createdAt": "2020-03-23T04:35:00Z", "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java", "diffHunk": "@@ -120,7 +120,6 @@ public static boolean checkSecret(final HttpServletRequest request, final HttpSe\n     private static int port = 0;\n \n     static final String CONSTELLATION_CLIENT = \"constellation_client.py\";\n-    static final String RESOURCES = \"resources/\";", "originalCommit": "a93dabb06e985774bf13938fb2ccb87a59eb1bfe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIxNjA4MQ==", "url": "https://github.com/constellation-app/constellation/pull/317#discussion_r396216081", "bodyText": "@antares1470 i think the issue was dealing with merge conflicts and some of your changes being accidentally overridden.", "author": "arcturus2", "createdAt": "2020-03-23T05:10:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwOTEzMQ=="}], "type": "inlineReview", "revised_code": {"commit": "60889e762e3ca9e551a7eaf92233c8b072de8fdb", "chunk": "diff --git a/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java b/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java\nindex 83d2694ac..1d00c1a94 100644\n--- a/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java\n+++ b/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/WebServer.java\n\n@@ -119,8 +119,9 @@ public class WebServer {\n     private static boolean running = false;\n     private static int port = 0;\n \n-    static final String CONSTELLATION_CLIENT = \"constellation_client.py\";\n+    private static final String CONSTELLATION_CLIENT = \"constellation_client.py\";\n     private static final String IPYTHON = \".ipython\";\n+    private static final String RESOURCES = \"resources/\";\n \n     public static synchronized int start() {\n         if (!running) {\n"}}, {"oid": "60889e762e3ca9e551a7eaf92233c8b072de8fdb", "url": "https://github.com/constellation-app/constellation/commit/60889e762e3ca9e551a7eaf92233c8b072de8fdb", "message": ":bug: fixed some broken ui references\n:art: fixed some merge conflict issues", "committedDate": "2020-03-23T07:11:17Z", "type": "commit"}, {"oid": "f0b0dec2a54bfe8bca47eb0132dc01096071fe15", "url": "https://github.com/constellation-app/constellation/commit/f0b0dec2a54bfe8bca47eb0132dc01096071fe15", "message": "Merge pull request #336 from cygnus-x-1/master-nb11-rest-service\n\nmaster-nb11-rest-service-fix", "committedDate": "2020-03-23T12:02:14Z", "type": "commit"}]}