{"pr_number": 661, "pr_title": "Fix the Body type parameters in the Rest API", "pr_createdAt": "2020-07-10T03:34:15Z", "pr_url": "https://github.com/constellation-app/constellation/pull/661", "timeline": [{"oid": "76a3d1edfcada3471540d8e6a8243b981f69d2ee", "url": "https://github.com/constellation-app/constellation/commit/76a3d1edfcada3471540d8e6a8243b981f69d2ee", "message": "Fix the Body type parameters in the Rest API", "committedDate": "2020-07-10T03:14:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYxNDUyNw==", "url": "https://github.com/constellation-app/constellation/pull/661#discussion_r452614527", "bodyText": "Are you able to change Locale.US to Locale.ENGLISH? This just keeps it consistent with the rest of the codebase", "author": "antares1470", "createdAt": "2020-07-10T04:22:20Z", "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java", "diffHunk": "@@ -122,13 +122,24 @@ protected void doGet(final HttpServletRequest request, final HttpServletResponse\n                     final ArrayNode params = httpMethod.putArray(\"parameters\");\n                     rs.createParameters().getParameters().entrySet().forEach(entry -> {\n                         final PluginParameter<?> pp = entry.getValue();\n+\n+                        if (pp.getName().toLowerCase(Locale.US).contains(\"(body)\")) {", "originalCommit": "76a3d1edfcada3471540d8e6a8243b981f69d2ee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYyODgxMA==", "url": "https://github.com/constellation-app/constellation/pull/661#discussion_r452628810", "bodyText": "@antares1470 It appears in 3 files : FontInfo, GlyphsFrame as well. Shall I change them all?", "author": "Auriga2", "createdAt": "2020-07-10T05:26:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYxNDUyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1NTgyNA==", "url": "https://github.com/constellation-app/constellation/pull/661#discussion_r452655824", "bodyText": "Fixed them all.", "author": "Auriga2", "createdAt": "2020-07-10T06:54:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYxNDUyNw=="}], "type": "inlineReview", "revised_code": {"commit": "c478cf50f88e1cf51368f0dbe58c87b335521870", "chunk": "diff --git a/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java b/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java\nindex 536ab08be..a3b1cb4b8 100644\n--- a/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java\n+++ b/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java\n\n@@ -123,9 +123,9 @@ public class SwaggerServlet extends ConstellationHttpServlet {\n                     rs.createParameters().getParameters().entrySet().forEach(entry -> {\n                         final PluginParameter<?> pp = entry.getValue();\n \n-                        if (pp.getName().toLowerCase(Locale.US).contains(\"(body)\")) {\n+                        if (pp.getName().toLowerCase(Locale.ENGLISH).contains(\"(body)\")) {\n                             final ObjectNode requestBody = httpMethod.putObject(\"requestBody\");\n-                            requestBody.put(DESCRIPTION, pp.getDescription());\n+                            requestBody.put(DESCRIPTION, pp.getName().replace(\"(body)\", \" - \") + pp.getDescription());\n                             requestBody.put(\"required\", false); //fix in the other ticket\n                             final ObjectNode content = requestBody.putObject(\"content\");\n                             final ObjectNode mime = content.putObject(RestServiceUtilities.APPLICATION_JSON);\n"}}, {"oid": "c478cf50f88e1cf51368f0dbe58c87b335521870", "url": "https://github.com/constellation-app/constellation/commit/c478cf50f88e1cf51368f0dbe58c87b335521870", "message": "Fixed the locale, and improved the response body description by including the name", "committedDate": "2020-07-10T06:04:17Z", "type": "commit"}, {"oid": "0c0fe68ac4e311f8f158fff5d005ca934962bbe0", "url": "https://github.com/constellation-app/constellation/commit/0c0fe68ac4e311f8f158fff5d005ca934962bbe0", "message": "Fix the code smells", "committedDate": "2020-07-10T06:18:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA5MjMxOQ==", "url": "https://github.com/constellation-app/constellation/pull/661#discussion_r453092319", "bodyText": "@Auriga2 can you please prefix this comment with \"TODO\" and you can mention the GitHub issue like #123. Thanks.", "author": "arcturus2", "createdAt": "2020-07-10T21:49:22Z", "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java", "diffHunk": "@@ -122,20 +124,31 @@ protected void doGet(final HttpServletRequest request, final HttpServletResponse\n                     final ArrayNode params = httpMethod.putArray(\"parameters\");\n                     rs.createParameters().getParameters().entrySet().forEach(entry -> {\n                         final PluginParameter<?> pp = entry.getValue();\n-                        final ObjectNode param = params.addObject();\n-                        param.put(\"name\", pp.getId());\n-                        param.put(\"in\", pp.getName().toLowerCase(Locale.US).contains(\"(body)\") ? \"body\" : \"query\");\n-                        param.put(\"required\", false); // TODO Hard-code this until PluginParameters grows a required field.\n-                        param.put(DESCRIPTION, pp.getDescription());\n-                        final ObjectNode schema = param.putObject(SCHEMA);\n-                        schema.put(\"type\", pp.getType().getId());\n+\n+                        if (pp.getName().toLowerCase(Locale.ENGLISH).contains(\"(body)\")) {\n+                            final ObjectNode requestBody = httpMethod.putObject(\"requestBody\");\n+                            requestBody.put(DESCRIPTION, pp.getName().replace(\"(body)\", \" - \") + pp.getDescription());\n+                            requestBody.put(REQUIRED, false); //fix in the other ticket", "originalCommit": "0c0fe68ac4e311f8f158fff5d005ca934962bbe0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyNTA3OQ==", "url": "https://github.com/constellation-app/constellation/pull/661#discussion_r453425079", "bodyText": "Fixed.", "author": "Auriga2", "createdAt": "2020-07-13T04:12:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA5MjMxOQ=="}], "type": "inlineReview", "revised_code": {"commit": "5ea4af64e171f76b5c3494daba16333bdeb813b9", "chunk": "diff --git a/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java b/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java\nindex 4e34c2325..627325f3e 100644\n--- a/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java\n+++ b/CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java\n\n@@ -128,7 +128,7 @@ public class SwaggerServlet extends ConstellationHttpServlet {\n                         if (pp.getName().toLowerCase(Locale.ENGLISH).contains(\"(body)\")) {\n                             final ObjectNode requestBody = httpMethod.putObject(\"requestBody\");\n                             requestBody.put(DESCRIPTION, pp.getName().replace(\"(body)\", \" - \") + pp.getDescription());\n-                            requestBody.put(REQUIRED, false); //fix in the other ticket\n+                            requestBody.put(REQUIRED, false); //TODO Remove hard-code in #633\n                             final ObjectNode content = requestBody.putObject(\"content\");\n                             final ObjectNode mime = content.putObject(RestServiceUtilities.APPLICATION_JSON);\n                             final ObjectNode schema = mime.putObject(SCHEMA);\n"}}, {"oid": "5ea4af64e171f76b5c3494daba16333bdeb813b9", "url": "https://github.com/constellation-app/constellation/commit/5ea4af64e171f76b5c3494daba16333bdeb813b9", "message": "Fix the comment", "committedDate": "2020-07-13T04:11:35Z", "type": "commit"}]}