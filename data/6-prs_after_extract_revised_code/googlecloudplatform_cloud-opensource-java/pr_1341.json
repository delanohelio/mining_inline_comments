{"pr_number": 1341, "pr_title": "LinkageCheckerArguments.getArtifacts to return empty list if the argument is not specified", "pr_createdAt": "2020-04-09T14:49:08Z", "pr_url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1341", "timeline": [{"oid": "4c0a7e0ba9c69967485277f9aca30c39ec8b91d5", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/4c0a7e0ba9c69967485277f9aca30c39ec8b91d5", "message": "Test that fails", "committedDate": "2020-04-09T14:38:09Z", "type": "commit"}, {"oid": "792502536ce5c58bf2e5641bf0afa3ee0938c120", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/792502536ce5c58bf2e5641bf0afa3ee0938c120", "message": "Fixed the problem", "committedDate": "2020-04-09T14:47:44Z", "type": "commit"}, {"oid": "a8a7756d47e2b9b66cd98c9dda327c51d798d8dc", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/a8a7756d47e2b9b66cd98c9dda327c51d798d8dc", "message": "not to rely on path", "committedDate": "2020-04-09T14:48:39Z", "type": "commit"}, {"oid": "170bdd7e889bf076df07bd6e380df34a70db40e6", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/170bdd7e889bf076df07bd6e380df34a70db40e6", "message": "Format", "committedDate": "2020-04-09T14:50:53Z", "type": "commit"}, {"oid": "b67a2701a01554f398d1a35876a2e2814d1ab8b1", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/b67a2701a01554f398d1a35876a2e2814d1ab8b1", "message": "More test", "committedDate": "2020-04-09T14:56:13Z", "type": "commit"}, {"oid": "e394bf3306d83b447a9413a1ce85e6f59c1c1b3e", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/e394bf3306d83b447a9413a1ce85e6f59c1c1b3e", "message": "Test field initialization", "committedDate": "2020-04-09T14:58:07Z", "type": "commit"}, {"oid": "8d64a92d490955a15e051b1eb88849e9ec2dea2a", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/8d64a92d490955a15e051b1eb88849e9ec2dea2a", "message": "captured output", "committedDate": "2020-04-09T15:01:04Z", "type": "commit"}, {"oid": "9250558288ba1a4e9bee4ea451667cbf351f52e6", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/9250558288ba1a4e9bee4ea451667cbf351f52e6", "message": "Format", "committedDate": "2020-04-09T15:01:17Z", "type": "commit"}, {"oid": "e013e67a4fec3fff3242e265bcb7d5b907c3a592", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/e013e67a4fec3fff3242e265bcb7d5b907c3a592", "message": "removed fixme", "committedDate": "2020-04-09T15:15:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI3MDU0Nw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1341#discussion_r406270547", "bodyText": "This was throwing exception (#1341 )", "author": "suztomo", "createdAt": "2020-04-09T15:02:33Z", "path": "dependencies/src/test/java/com/google/cloud/tools/opensource/classpath/LinkageCheckerMainIntegrationTest.java", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.cloud.tools.opensource.classpath;\n+\n+import static com.google.cloud.tools.opensource.classpath.TestHelper.absolutePathOfResource;\n+\n+import com.google.common.truth.Truth;\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+import java.io.PrintStream;\n+import java.net.URISyntaxException;\n+import java.nio.file.Path;\n+import org.eclipse.aether.RepositoryException;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+public class LinkageCheckerMainIntegrationTest {\n+\n+  private static final PrintStream originalStandardOut = System.out;\n+  private ByteArrayOutputStream capturedOutputStream;\n+\n+  @Before\n+  public void setup() {\n+    capturedOutputStream = new ByteArrayOutputStream();\n+    System.setOut(new PrintStream(capturedOutputStream));\n+  }\n+\n+  @After\n+  public void cleanup() {\n+    System.setOut(originalStandardOut);\n+  }\n+\n+  private String readCapturedStdout() {\n+    System.out.flush();\n+    String output = new String(capturedOutputStream.toByteArray());\n+    return output;\n+  }\n+\n+  @Test\n+  public void testJarFiles() throws IOException, URISyntaxException, RepositoryException {\n+\n+    Path googleCloudCore = absolutePathOfResource(\"testdata/google-cloud-core-1.48.0.jar\");\n+    Path googleCloudFirestore =\n+        absolutePathOfResource(\"testdata/google-cloud-firestore-0.65.0-beta.jar\");\n+    Path guava = absolutePathOfResource(\"testdata/guava-23.5-jre.jar\");\n+\n+    String jarArgument = googleCloudCore + \",\" + googleCloudFirestore + \",\" + guava;\n+\n+    // This should not raise Exception\n+    LinkageCheckerMain.main(new String[] {\"-j\", jarArgument});", "originalCommit": "9250558288ba1a4e9bee4ea451667cbf351f52e6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ed54eca466b7ae3d316c6b92a995901b530116c8", "chunk": "diff --git a/dependencies/src/test/java/com/google/cloud/tools/opensource/classpath/LinkageCheckerMainIntegrationTest.java b/dependencies/src/test/java/com/google/cloud/tools/opensource/classpath/LinkageCheckerMainIntegrationTest.java\nindex 2c12380d..41510cf9 100644\n--- a/dependencies/src/test/java/com/google/cloud/tools/opensource/classpath/LinkageCheckerMainIntegrationTest.java\n+++ b/dependencies/src/test/java/com/google/cloud/tools/opensource/classpath/LinkageCheckerMainIntegrationTest.java\n\n@@ -95,4 +95,26 @@ public class LinkageCheckerMainIntegrationTest {\n                 + \" io.grpc:grpc-netty-shaded:1.13.1 (compile)\\n\"\n                 + \"  and 1 dependency path.\");\n   }\n+\n+  @Test\n+  public void testBom() throws IOException, RepositoryException {\n+    LinkageCheckerMain.main(new String[] {\"-b\", \"com.google.cloud:libraries-bom:1.0.0\"});\n+\n+    String output = readCapturedStdout();\n+\n+    // Appengine-api-sdk is known to have invalid references\n+    Truth.assertThat(output)\n+        .contains(\n+            \"Class com.google.net.rpc3.client.RpcStubDescriptor is not found;\\n\"\n+                + \"  referenced by 21 class files\\n\"\n+                + \"    com.google.appengine.api.appidentity.AppIdentityServicePb\"\n+                + \" (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\");\n+\n+    // Show the dependency path to the problematic artifact\n+    Truth.assertThat(output)\n+        .contains(\n+            \"com.google.appengine:appengine-api-1.0-sdk:1.9.71 is at:\\n\"\n+                + \"  com.google.http-client:google-http-client-appengine:1.29.1 (compile) \"\n+                + \"/ com.google.appengine:appengine-api-1.0-sdk:1.9.71 (provided)\");\n+  }\n }\n"}}, {"oid": "ed54eca466b7ae3d316c6b92a995901b530116c8", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/ed54eca466b7ae3d316c6b92a995901b530116c8", "message": "bom test", "committedDate": "2020-04-09T15:29:08Z", "type": "commit"}]}