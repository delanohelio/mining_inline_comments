{"pr_number": 1830, "pr_title": "add send-analytics flag", "pr_createdAt": "2020-11-23T20:00:24Z", "pr_url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1830", "timeline": [{"oid": "0c4f6fd6949358f673396099e3512ec6c3bb16e1", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/0c4f6fd6949358f673396099e3512ec6c3bb16e1", "message": "add send-analytics flag", "committedDate": "2020-11-23T19:59:14Z", "type": "commit"}, {"oid": "40c25d814febd075a8e58b72a6c752902c0e2723", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/40c25d814febd075a8e58b72a6c752902c0e2723", "message": "Merge branch 'master' into flags", "committedDate": "2020-11-23T20:14:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAwODI0MA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1830#discussion_r529008240", "bodyText": "Google rule is not to abbreviate words.", "author": "suztomo", "createdAt": "2020-11-23T21:29:19Z", "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -85,17 +90,22 @@\n   private final ImmutableMap<String, String> localArtifacts =\n       findLocalArtifacts(repositorySystem, session, Paths.get(\".\").toAbsolutePath());\n \n-  public static void main(String[] arguments)\n+  public static void main(String[] args)", "originalCommit": "40c25d814febd075a8e58b72a6c752902c0e2723", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTA4Njk4NA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1830#discussion_r529086984", "bodyText": "done", "author": "elharo", "createdAt": "2020-11-24T00:37:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAwODI0MA=="}], "type": "inlineReview", "revised_code": {"commit": "1929a4bfb1d621dc3e1dafbda15eb64a31a65d31", "chunk": "diff --git a/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java b/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java\nindex 2662228f..bf199e0d 100644\n--- a/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java\n+++ b/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java\n\n@@ -90,13 +90,11 @@ public class LinkageMonitor {\n   private final ImmutableMap<String, String> localArtifacts =\n       findLocalArtifacts(repositorySystem, session, Paths.get(\".\").toAbsolutePath());\n \n-  public static void main(String[] args)\n+  public static void main(String[] arguments)\n       throws RepositoryException, IOException, MavenRepositoryException, ModelBuildingException {\n     \n-    CommandLine commandLine = parseCommandLine(args);\n-    List<String> arguments = commandLine.getArgList();\n-    \n-    String bomCoordinates = arguments.get(0);\n+    CommandLine commandLine = parseCommandLine(arguments);\n+    String bomCoordinates = commandLine.getArgList().get(0);\n     List<String> coordinatesElements = Splitter.on(':').splitToList(bomCoordinates);\n \n     if (coordinatesElements.size() != 2) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAxMDM2Ng==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1830#discussion_r529010366", "bodyText": "Would you make this more explicit about this tool uploading the result to Google Analytics.", "author": "suztomo", "createdAt": "2020-11-23T21:33:17Z", "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -111,6 +121,29 @@ public static void main(String[] arguments)\n     }\n   }\n \n+  private static CommandLine parseCommandLine(String[] arguments) {\n+    Options options = new Options();\n+    options.addOption(\"send-analytics\", false, \"track results from each run\");", "originalCommit": "40c25d814febd075a8e58b72a6c752902c0e2723", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTA4NzE4Mg==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1830#discussion_r529087182", "bodyText": "what language do you suggest? This needs to be a short string for help, not complete documentation.", "author": "elharo", "createdAt": "2020-11-24T00:38:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAxMDM2Ng=="}], "type": "inlineReview", "revised_code": {"commit": "1929a4bfb1d621dc3e1dafbda15eb64a31a65d31", "chunk": "diff --git a/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java b/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java\nindex 2662228f..bf199e0d 100644\n--- a/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java\n+++ b/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java\n\n@@ -140,7 +138,7 @@ public class LinkageMonitor {\n   private static void printUsageAndDie() {\n     logger.severe(\n         \"Usage: java com.google.cloud.tools.dependencies.linkagemonitor.LinkageMonitor\"\n-        + \" --[no]send-analytics com.google.cloud:libraries-bom\");\n+        + \" [--send-analytics] com.google.cloud:libraries-bom\");\n     System.exit(1);\n   }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAxMjA5Nw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1830#discussion_r529012097", "bodyText": "I don't see option for --nosend-analytics (yet?)", "author": "suztomo", "createdAt": "2020-11-23T21:36:46Z", "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -111,6 +121,29 @@ public static void main(String[] arguments)\n     }\n   }\n \n+  private static CommandLine parseCommandLine(String[] arguments) {\n+    Options options = new Options();\n+    options.addOption(\"send-analytics\", false, \"track results from each run\");\n+    CommandLineParser parser = new DefaultParser();\n+    try {\n+      CommandLine commandLine = parser.parse(options, arguments);\n+      if (commandLine.getArgList().size() != 1) {\n+        printUsageAndDie();\n+      }\n+      return commandLine;\n+    } catch (ParseException ex) {\n+      printUsageAndDie();\n+      return null;\n+    }\n+  }\n+\n+  private static void printUsageAndDie() {\n+    logger.severe(\n+        \"Usage: java com.google.cloud.tools.dependencies.linkagemonitor.LinkageMonitor\"\n+        + \" --[no]send-analytics com.google.cloud:libraries-bom\");", "originalCommit": "40c25d814febd075a8e58b72a6c752902c0e2723", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTA4ODY5MA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1830#discussion_r529088690", "bodyText": "I'm too used to gnu. Fixed.", "author": "elharo", "createdAt": "2020-11-24T00:42:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAxMjA5Nw=="}], "type": "inlineReview", "revised_code": {"commit": "1929a4bfb1d621dc3e1dafbda15eb64a31a65d31", "chunk": "diff --git a/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java b/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java\nindex 2662228f..bf199e0d 100644\n--- a/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java\n+++ b/linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java\n\n@@ -140,7 +138,7 @@ public class LinkageMonitor {\n   private static void printUsageAndDie() {\n     logger.severe(\n         \"Usage: java com.google.cloud.tools.dependencies.linkagemonitor.LinkageMonitor\"\n-        + \" --[no]send-analytics com.google.cloud:libraries-bom\");\n+        + \" [--send-analytics] com.google.cloud:libraries-bom\");\n     System.exit(1);\n   }\n \n"}}, {"oid": "1929a4bfb1d621dc3e1dafbda15eb64a31a65d31", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/1929a4bfb1d621dc3e1dafbda15eb64a31a65d31", "message": "review", "committedDate": "2020-11-24T00:42:49Z", "type": "commit"}]}