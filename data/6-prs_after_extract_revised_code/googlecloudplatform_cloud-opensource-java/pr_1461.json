{"pr_number": 1461, "pr_title": "not all graphs are trees", "pr_createdAt": "2020-06-10T16:32:08Z", "pr_url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1461", "timeline": [{"oid": "55afde068bb4797e84867b3e9a5c0ddada69e3cd", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/55afde068bb4797e84867b3e9a5c0ddada69e3cd", "message": "not all graphs are trees", "committedDate": "2020-06-10T16:30:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI4NDk3OQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1461#discussion_r438284979", "bodyText": "This statement still holds because they may have different scopes and optional flag.\nDependencyNode(Artifact(\"com.google.guava:20.0\"), scope:\"provided\") and DependencyNode(Artifact(\"com.google.guava:20.0\"), scope:\"compile\") are different nodes.", "author": "suztomo", "createdAt": "2020-06-10T17:16:15Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java", "diffHunk": "@@ -55,12 +54,10 @@\n  *   <li>It does not contain optional dependencies of transitive dependencies.\n  * </ul>\n  *\n- * <p>A full dependency graph is a dependency tree where each node's dependencies are resolved\n+ * <p>In a full dependency graph each node's dependencies are resolved\n  * recursively. This graph has the following attributes:\n  *\n  * <ul>\n- *   <li>The same artifact, which has the same group:artifact:version, appears in different nodes in\n- *       the graph.", "originalCommit": "55afde068bb4797e84867b3e9a5c0ddada69e3cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyMTk5MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1461#discussion_r438421991", "bodyText": "I see the javadoc of buildFullDependencyGraph contains \"including duplicates, conflicting versions\".", "author": "suztomo", "createdAt": "2020-06-10T21:36:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI4NDk3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODc4NjgzOQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1461#discussion_r438786839", "bodyText": "Are you proposing a change here?", "author": "elharo", "createdAt": "2020-06-11T13:36:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI4NDk3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODc5Mjg2MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1461#discussion_r438792861", "bodyText": "No, that was my note.", "author": "suztomo", "createdAt": "2020-06-11T13:42:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI4NDk3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "f785e96d89e864bb3a25a4d48616452d3289d5a9", "chunk": "diff --git a/dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java b/dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java\nindex 0fb5120f..4aff7c78 100644\n--- a/dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java\n+++ b/dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java\n\n@@ -39,29 +39,8 @@ import org.eclipse.aether.resolution.DependencyResolutionException;\n import org.eclipse.aether.resolution.DependencyResult;\n \n /**\n- * This class builds dependency graphs for Maven artifacts.\n- *\n- * <p>A Maven dependency graph has the following attributes:\n- *\n- * <ul>\n- *   <li>It contains at most one node with the same group ID and artifact ID. (<a\n- *       href=\"https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Transitive_Dependencies\">dependency\n- *       mediation</a>)\n- *   <li>The scope of a dependency affects the scope of its children's dependencies as per <a\n- *       href=\"https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Dependency_Scope\">Maven:\n- *       Dependency Scope</a>\n- *   <li>It does not contain provided-scope dependencies of transitive dependencies.\n- *   <li>It does not contain optional dependencies of transitive dependencies.\n- * </ul>\n- *\n- * <p>In a full dependency graph each node's dependencies are resolved\n- * recursively. This graph has the following attributes:\n- *\n- * <ul>\n- *   <li>The scope of a dependency does not affect the scope of its children's dependencies.\n- *   <li>Provided-scope and optional dependencies are not treated differently than any other\n- *       dependency.\n- * </ul>\n+ * Builds dependency graphs for Maven artifacts by querying repositories for\n+ * pom.xml files and following the dependency chains therein.\n  */\n public final class DependencyGraphBuilder {\n \n"}}, {"oid": "5d9772cbf2eb586c03e3a19c5a7f483db5e4b677", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/5d9772cbf2eb586c03e3a19c5a7f483db5e4b677", "message": "Merge branch 'master' into opt", "committedDate": "2020-06-10T20:20:40Z", "type": "commit"}, {"oid": "f785e96d89e864bb3a25a4d48616452d3289d5a9", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/f785e96d89e864bb3a25a4d48616452d3289d5a9", "message": "further rewrite", "committedDate": "2020-06-10T20:26:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyMTQxMw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1461#discussion_r438421413", "bodyText": "Use list. (without a list, the items of \"the following attributes\" are unclear)", "author": "suztomo", "createdAt": "2020-06-10T21:35:10Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java", "diffHunk": "@@ -147,7 +123,11 @@ private DependencyNode resolveCompileTimeDependencies(\n   /**\n    * Finds the full compile time, transitive dependency graph including duplicates, conflicting\n    * versions, and provided and optional dependencies. In the event of I/O errors, missing\n-   * artifacts, and other problems, it can return an incomplete graph.\n+   * artifacts, and other problems, it can return an incomplete graph. Each node's dependencies\n+   * are resolved recursively. This graph has the following attributes:\n+   * The scope of a dependency does not affect the scope of its children's dependencies.\n+   * Provided and optional dependencies are not treated differently than any other\n+   * dependency.", "originalCommit": "f785e96d89e864bb3a25a4d48616452d3289d5a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODc4NjYwNQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1461#discussion_r438786605", "bodyText": "I'm not sure I follow this. Do you want to duplicate the type in the @param for artifacts? JavaDoc fills that in automatically.", "author": "elharo", "createdAt": "2020-06-11T13:36:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyMTQxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODc5NTc1Nw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1461#discussion_r438795757", "bodyText": "I meant the formatting around \"the following attributes\":\n   * are resolved recursively. This graph has the following attributes:\n   *\n   * <ul>\n   *   <li>The scope of a dependency does not affect the scope of its children's dependencies.\n   *   <li>Provided and optional dependencies are not treated differently than any other dependency.\n   * </ul>", "author": "suztomo", "createdAt": "2020-06-11T13:45:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyMTQxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgxMTczNw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1461#discussion_r438811737", "bodyText": "got it. fixed.", "author": "elharo", "createdAt": "2020-06-11T14:04:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyMTQxMw=="}], "type": "inlineReview", "revised_code": {"commit": "f51f9794a4281f01283578d492de29cf22abc743", "chunk": "diff --git a/dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java b/dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java\nindex 4aff7c78..9e7c3060 100644\n--- a/dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java\n+++ b/dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java\n\n@@ -123,13 +123,12 @@ public final class DependencyGraphBuilder {\n   /**\n    * Finds the full compile time, transitive dependency graph including duplicates, conflicting\n    * versions, and provided and optional dependencies. In the event of I/O errors, missing\n-   * artifacts, and other problems, it can return an incomplete graph. Each node's dependencies\n-   * are resolved recursively. This graph has the following attributes:\n-   * The scope of a dependency does not affect the scope of its children's dependencies.\n-   * Provided and optional dependencies are not treated differently than any other\n+   * artifacts, and other problems, it can return an incomplete graph. Each node's dependencies are\n+   * resolved recursively. The scope of a dependency does not affect the scope of its children's\n+   * dependencies. Provided and optional dependencies are not treated differently than any other\n    * dependency.\n    *\n-   * @param artifacts Maven artifacts to retrieve their dependencies\n+   * @param artifacts Maven artifacts whose dependencies to retrieve\n    * @return dependency graph representing the tree of Maven artifacts\n    */\n   public DependencyGraph buildFullDependencyGraph(List<Artifact> artifacts) {\n"}}, {"oid": "712456a9f7d3735ca4fc56426c6c277d6a701691", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/712456a9f7d3735ca4fc56426c6c277d6a701691", "message": "Merge branch 'master' into opt", "committedDate": "2020-06-11T13:32:32Z", "type": "commit"}, {"oid": "f51f9794a4281f01283578d492de29cf22abc743", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/f51f9794a4281f01283578d492de29cf22abc743", "message": "fix wording", "committedDate": "2020-06-11T14:03:55Z", "type": "commit"}, {"oid": "8589aa9edcbb07d2b4c262b01064eb3f52b34e3b", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/8589aa9edcbb07d2b4c262b01064eb3f52b34e3b", "message": "Merge branch 'opt' of github.com:GoogleCloudPlatform/cloud-opensource-java into opt", "committedDate": "2020-06-11T14:04:31Z", "type": "commit"}]}