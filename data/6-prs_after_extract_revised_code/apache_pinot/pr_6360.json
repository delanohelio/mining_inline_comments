{"pr_number": 6360, "pr_title": "compatibility test: create/delete table operations", "pr_createdAt": "2020-12-16T00:50:58Z", "pr_url": "https://github.com/apache/pinot/pull/6360", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAyNTQ0Nw==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r544025447", "bodyText": "You can use ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forSchemaCreate()\nSame for table creation/deletion, the constructor should all inside ControllerRequestURLBuilder (If not, please add it there).", "author": "xiangfu0", "createdAt": "2020-12-16T06:31:36Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java", "diffHunk": "@@ -92,4 +102,34 @@ boolean runOp() {\n     }\n     return true;\n   }\n+\n+  private boolean createSchema() {\n+    try {\n+      RequestProcessor.sendPostRequestWithFile(CONTROLLER_URL + \"/schemas\", new File(_schemaFileName));", "originalCommit": "6359fb577d1cac1c38c840cae958039661304ef3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "92156f942d357781a3b6fa4adebec1089a047ed3", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\nindex cf136ccef0..fc9e67f812 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n\n@@ -105,7 +102,9 @@ public class TableOp extends BaseOp {\n \n   private boolean createSchema() {\n     try {\n-      RequestProcessor.sendPostRequestWithFile(CONTROLLER_URL + \"/schemas\", new File(_schemaFileName));\n+      CompatTestRequestProcessor.sendPostRequestWithFile(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forSchemaCreate(),\n+          _schemaFileName);\n       return true;\n     } catch (Exception e) {\n       System.out.println(e.getMessage());\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAyODc5NA==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r544028794", "bodyText": "I somehow feel we should wrapper something in pinot-client for management APIs. So both users and devs can reuse the code.\n@mayankshriv @mcvsubbu @Jackie-Jiang", "author": "xiangfu0", "createdAt": "2020-12-16T06:35:18Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/RequestProcessor.java", "diffHunk": "@@ -0,0 +1,88 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.compat.tests;\n+\n+import java.io.File;\n+import java.net.URI;\n+import org.apache.http.HttpEntity;\n+import org.apache.http.HttpVersion;\n+import org.apache.http.StatusLine;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpDelete;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.methods.HttpUriRequest;\n+import org.apache.http.client.methods.RequestBuilder;\n+import org.apache.http.entity.ContentType;\n+import org.apache.http.entity.mime.HttpMultipartMode;\n+import org.apache.http.entity.mime.MultipartEntityBuilder;\n+import org.apache.http.entity.mime.content.ContentBody;\n+import org.apache.http.entity.mime.content.FileBody;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.http.util.EntityUtils;\n+import org.apache.pinot.spi.utils.JsonUtils;\n+\n+\n+public class RequestProcessor {", "originalCommit": "6359fb577d1cac1c38c840cae958039661304ef3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ3NTgzMg==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r544475832", "bodyText": "If we do expose management APIs, then instead of using the same jar, I feel like adding another jar is better. The management API may have more dependencies on other internal things that we may not want pinot-client to depend on.\nBut then most admins will not be coding in java, and may be just fine with a well-defined REST API. So, a management API may not add much value.", "author": "mcvsubbu", "createdAt": "2020-12-16T17:14:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAyODc5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk5MjQ5Ng==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r545992496", "bodyText": "In general, I tend to confirm with DRY principle. There can be modularization as well as packaging to expose the right library to the right audience. Whether it is worth it in this particular case (especially if it increases the scope of the changes drastically), I am unsure. My $0.02.", "author": "mayankshriv", "createdAt": "2020-12-18T17:51:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAyODc5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAwNjA5OQ==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546006099", "bodyText": "I don't think (or, at least, I hope not) @fx19880617 is proposing to do it as a part of the testing scope. I think it was a general question. We should take that elsewhere, since it definitely does not fit into this scope (of compat tests)", "author": "mcvsubbu", "createdAt": "2020-12-18T18:17:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAyODc5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAxMDYzMg==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546010632", "bodyText": "Yep, and that's why my response started with \"In general\" :-)", "author": "mayankshriv", "createdAt": "2020-12-18T18:24:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAyODc5NA=="}], "type": "inlineReview", "revised_code": {"commit": "92156f942d357781a3b6fa4adebec1089a047ed3", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/RequestProcessor.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestRequestProcessor.java\nsimilarity index 95%\nrename from pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/RequestProcessor.java\nrename to pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestRequestProcessor.java\nindex f835ec9740..f02f84139c 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/RequestProcessor.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestRequestProcessor.java\n\n@@ -40,7 +40,7 @@ import org.apache.http.util.EntityUtils;\n import org.apache.pinot.spi.utils.JsonUtils;\n \n \n-public class RequestProcessor {\n+public class CompatTestRequestProcessor {\n   private static CloseableHttpClient _httpClient = HttpClients.createDefault();\n \n   public static String sendGetRequest(String request) throws Exception {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mzc5NjY4NQ==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r543796685", "bodyText": "pull this from the table config file", "author": "mcvsubbu", "createdAt": "2020-12-16T00:54:28Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java", "diffHunk": "@@ -44,6 +45,9 @@\n   private String _schemaFileName;\n   private Op _op;\n   private String _tableConfigFileName;\n+  private String _tableName;", "originalCommit": "6359fb577d1cac1c38c840cae958039661304ef3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "92156f942d357781a3b6fa4adebec1089a047ed3", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\nindex cf136ccef0..fc9e67f812 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n\n@@ -45,9 +51,8 @@ public class TableOp extends BaseOp {\n   private String _schemaFileName;\n   private Op _op;\n   private String _tableConfigFileName;\n-  private String _tableName;\n \n-  private static final String CONTROLLER_URL = \"localhost:9000\";\n+  private static final String TABLE_NAME = \"tableName\";\n \n   public TableOp() {\n     super(OpType.TABLE_OP);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ3MzY2NA==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r544473664", "bodyText": "You may want to put this in another file, it will be needed in all the ops.", "author": "mcvsubbu", "createdAt": "2020-12-16T17:11:36Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java", "diffHunk": "@@ -44,6 +45,9 @@\n   private String _schemaFileName;\n   private Op _op;\n   private String _tableConfigFileName;\n+  private String _tableName;\n+\n+  private static final String CONTROLLER_URL = \"localhost:9000\";", "originalCommit": "6359fb577d1cac1c38c840cae958039661304ef3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjE0NTg2Nw==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546145867", "bodyText": "Let me create a CompatTestConstants class, and put it in that file.", "author": "jtao15", "createdAt": "2020-12-18T23:33:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ3MzY2NA=="}], "type": "inlineReview", "revised_code": {"commit": "92156f942d357781a3b6fa4adebec1089a047ed3", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\nindex cf136ccef0..fc9e67f812 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n\n@@ -45,9 +51,8 @@ public class TableOp extends BaseOp {\n   private String _schemaFileName;\n   private Op _op;\n   private String _tableConfigFileName;\n-  private String _tableName;\n \n-  private static final String CONTROLLER_URL = \"localhost:9000\";\n+  private static final String TABLE_NAME = \"tableName\";\n \n   public TableOp() {\n     super(OpType.TABLE_OP);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk3MjUxNQ==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r545972515", "bodyText": "RequestProcessor is too generic a name, can we use a more readable name? This is just a soft suggestion, and not a blocking comment.", "author": "mayankshriv", "createdAt": "2020-12-18T17:15:13Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/RequestProcessor.java", "diffHunk": "@@ -0,0 +1,88 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.compat.tests;\n+\n+import java.io.File;\n+import java.net.URI;\n+import org.apache.http.HttpEntity;\n+import org.apache.http.HttpVersion;\n+import org.apache.http.StatusLine;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpDelete;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.methods.HttpUriRequest;\n+import org.apache.http.client.methods.RequestBuilder;\n+import org.apache.http.entity.ContentType;\n+import org.apache.http.entity.mime.HttpMultipartMode;\n+import org.apache.http.entity.mime.MultipartEntityBuilder;\n+import org.apache.http.entity.mime.content.ContentBody;\n+import org.apache.http.entity.mime.content.FileBody;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.http.util.EntityUtils;\n+import org.apache.pinot.spi.utils.JsonUtils;\n+\n+\n+public class RequestProcessor {", "originalCommit": "6359fb577d1cac1c38c840cae958039661304ef3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjE0NTUwNg==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546145506", "bodyText": "Let's call it CompatTestRequestProcessor then.", "author": "jtao15", "createdAt": "2020-12-18T23:31:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk3MjUxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjE1NzU3OA==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546157578", "bodyText": "Perhaps HttpRequestProcessor but let us see if we can leverage the existing request processor code from tests , like @fx19880617  suggested", "author": "mcvsubbu", "createdAt": "2020-12-19T00:14:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk3MjUxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjE2NzEyOQ==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546167129", "bodyText": "I see now, let me use ControllerTest functions instead.", "author": "jtao15", "createdAt": "2020-12-19T01:06:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk3MjUxNQ=="}], "type": "inlineReview", "revised_code": {"commit": "92156f942d357781a3b6fa4adebec1089a047ed3", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/RequestProcessor.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestRequestProcessor.java\nsimilarity index 95%\nrename from pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/RequestProcessor.java\nrename to pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestRequestProcessor.java\nindex f835ec9740..f02f84139c 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/RequestProcessor.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestRequestProcessor.java\n\n@@ -40,7 +40,7 @@ import org.apache.http.util.EntityUtils;\n import org.apache.pinot.spi.utils.JsonUtils;\n \n \n-public class RequestProcessor {\n+public class CompatTestRequestProcessor {\n   private static CloseableHttpClient _httpClient = HttpClients.createDefault();\n \n   public static String sendGetRequest(String request) throws Exception {\n"}}, {"oid": "92156f942d357781a3b6fa4adebec1089a047ed3", "url": "https://github.com/apache/pinot/commit/92156f942d357781a3b6fa4adebec1089a047ed3", "message": "compatibility test: create/delete table operations", "committedDate": "2020-12-18T23:39:18Z", "type": "forcePushed"}, {"oid": "1ae9ec0ad00ad430146b139a14ce43d31a6fb77b", "url": "https://github.com/apache/pinot/commit/1ae9ec0ad00ad430146b139a14ce43d31a6fb77b", "message": "compatibility test: create/delete table operations", "committedDate": "2020-12-19T01:04:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjE1OTMwMg==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546159302", "bodyText": "We are already in compat.tests package, so let us not call it CompatTestConstants\nFor now, call it ClusterDescriptor we will evolve it as we add more operators. My thought is that eventually we will get these from env variables", "author": "mcvsubbu", "createdAt": "2020-12-19T00:23:27Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestConstants.java", "diffHunk": "@@ -0,0 +1,23 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.compat.tests;\n+\n+public class CompatTestConstants {", "originalCommit": "92156f942d357781a3b6fa4adebec1089a047ed3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "52aa498eb04f784fda46d631e0cf097974a01a0f", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestConstants.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/ClusterDescriptor.java\nsimilarity index 96%\nrename from pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestConstants.java\nrename to pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/ClusterDescriptor.java\nindex e9bf19cccb..46dbcd0464 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/CompatTestConstants.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/ClusterDescriptor.java\n\n@@ -18,6 +18,6 @@\n  */\n package org.apache.pinot.compat.tests;\n \n-public class CompatTestConstants {\n+public class ClusterDescriptor {\n   public static final String CONTROLLER_URL = \"localhost:9000\";\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwODc0NA==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546908744", "bodyText": "Use JsonUtils.fileToObject() method. Already there.", "author": "mcvsubbu", "createdAt": "2020-12-21T20:13:33Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java", "diffHunk": "@@ -92,4 +101,45 @@ boolean runOp() {\n     }\n     return true;\n   }\n+\n+  private boolean createSchema() {\n+    try {\n+      ControllerTest.sendPostRequest(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forSchemaCreate(),\n+          FileUtils.readFileToString(new File(_schemaFileName)));\n+      return true;\n+    } catch (IOException e) {\n+      System.out.println(e.getMessage());\n+      return false;\n+    }\n+  }\n+\n+  private boolean createTable() {\n+    try {\n+      ControllerTest.sendPostRequest(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forSchemaCreate(),\n+          FileUtils.readFileToString(new File(_schemaFileName)));\n+      return true;\n+    } catch (IOException e) {\n+      System.out.println(e.getMessage());\n+      return false;\n+    }\n+  }\n+\n+  private boolean deleteTable() {\n+    try {\n+      ControllerTest.sendDeleteRequest(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forTableDelete(getTableNameFromTableConfigFile()));\n+      return true;\n+    } catch (IOException e) {\n+      System.out.println(e.getMessage());\n+      return false;\n+    }\n+  }\n+\n+  private String getTableNameFromTableConfigFile() throws IOException {", "originalCommit": "1ae9ec0ad00ad430146b139a14ce43d31a6fb77b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "52aa498eb04f784fda46d631e0cf097974a01a0f", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\nindex 279384bbcd..cbee5193e0 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n\n@@ -128,18 +128,13 @@ public class TableOp extends BaseOp {\n \n   private boolean deleteTable() {\n     try {\n+      TableConfig tableConfig = JsonUtils.fileToObject(new File(_tableConfigFileName), TableConfig.class);\n       ControllerTest.sendDeleteRequest(\n-          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forTableDelete(getTableNameFromTableConfigFile()));\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forTableDelete(tableConfig.getTableName()));\n       return true;\n     } catch (IOException e) {\n       System.out.println(e.getMessage());\n       return false;\n     }\n   }\n-\n-  private String getTableNameFromTableConfigFile() throws IOException {\n-    File file = new File(_tableConfigFileName);\n-    JsonNode node = JsonUtils.fileToJsonNode(file);\n-    return node.get(TABLE_NAME).asText();\n-  }\n }\n"}}, {"oid": "52aa498eb04f784fda46d631e0cf097974a01a0f", "url": "https://github.com/apache/pinot/commit/52aa498eb04f784fda46d631e0cf097974a01a0f", "message": "compatibility test: create/delete table operations", "committedDate": "2020-12-21T23:34:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk5OTI0Mw==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546999243", "bodyText": "Let us change this to an error log for now. We can then configure logs appropriately to get whatever we want on the console.\nAlso, include the  table config file path on all log messages", "author": "mcvsubbu", "createdAt": "2020-12-22T00:26:13Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java", "diffHunk": "@@ -92,4 +101,40 @@ boolean runOp() {\n     }\n     return true;\n   }\n+\n+  private boolean createSchema() {\n+    try {\n+      ControllerTest.sendPostRequest(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forSchemaCreate(),\n+          FileUtils.readFileToString(new File(_schemaFileName)));\n+      return true;\n+    } catch (IOException e) {\n+      System.out.println(e.getMessage());", "originalCommit": "52aa498eb04f784fda46d631e0cf097974a01a0f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1e632205207a504503659226b906525f8eeb59ed", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\nindex cbee5193e0..24e9b87bb1 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n\n@@ -109,7 +111,7 @@ public class TableOp extends BaseOp {\n           FileUtils.readFileToString(new File(_schemaFileName)));\n       return true;\n     } catch (IOException e) {\n-      System.out.println(e.getMessage());\n+      LOGGER.error(\"Failed to create schema with file: {}\", _schemaFileName, e);\n       return false;\n     }\n   }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk5OTI4Ng==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546999286", "bodyText": "error log", "author": "mcvsubbu", "createdAt": "2020-12-22T00:26:21Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java", "diffHunk": "@@ -92,4 +101,40 @@ boolean runOp() {\n     }\n     return true;\n   }\n+\n+  private boolean createSchema() {\n+    try {\n+      ControllerTest.sendPostRequest(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forSchemaCreate(),\n+          FileUtils.readFileToString(new File(_schemaFileName)));\n+      return true;\n+    } catch (IOException e) {\n+      System.out.println(e.getMessage());\n+      return false;\n+    }\n+  }\n+\n+  private boolean createTable() {\n+    try {\n+      ControllerTest.sendPostRequest(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forSchemaCreate(),\n+          FileUtils.readFileToString(new File(_schemaFileName)));\n+      return true;\n+    } catch (IOException e) {\n+      System.out.println(e.getMessage());", "originalCommit": "52aa498eb04f784fda46d631e0cf097974a01a0f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1e632205207a504503659226b906525f8eeb59ed", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\nindex cbee5193e0..24e9b87bb1 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n\n@@ -109,7 +111,7 @@ public class TableOp extends BaseOp {\n           FileUtils.readFileToString(new File(_schemaFileName)));\n       return true;\n     } catch (IOException e) {\n-      System.out.println(e.getMessage());\n+      LOGGER.error(\"Failed to create schema with file: {}\", _schemaFileName, e);\n       return false;\n     }\n   }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk5OTM3Nw==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546999377", "bodyText": "change to error log", "author": "mcvsubbu", "createdAt": "2020-12-22T00:26:40Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java", "diffHunk": "@@ -92,4 +101,40 @@ boolean runOp() {\n     }\n     return true;\n   }\n+\n+  private boolean createSchema() {\n+    try {\n+      ControllerTest.sendPostRequest(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forSchemaCreate(),\n+          FileUtils.readFileToString(new File(_schemaFileName)));\n+      return true;\n+    } catch (IOException e) {\n+      System.out.println(e.getMessage());\n+      return false;\n+    }\n+  }\n+\n+  private boolean createTable() {\n+    try {\n+      ControllerTest.sendPostRequest(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forSchemaCreate(),\n+          FileUtils.readFileToString(new File(_schemaFileName)));\n+      return true;\n+    } catch (IOException e) {\n+      System.out.println(e.getMessage());\n+      return false;\n+    }\n+  }\n+\n+  private boolean deleteTable() {\n+    try {\n+      TableConfig tableConfig = JsonUtils.fileToObject(new File(_tableConfigFileName), TableConfig.class);\n+      ControllerTest.sendDeleteRequest(\n+          ControllerRequestURLBuilder.baseUrl(CONTROLLER_URL).forTableDelete(tableConfig.getTableName()));\n+      return true;\n+    } catch (IOException e) {\n+      System.out.println(e.getMessage());", "originalCommit": "52aa498eb04f784fda46d631e0cf097974a01a0f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1e632205207a504503659226b906525f8eeb59ed", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\nindex cbee5193e0..24e9b87bb1 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n\n@@ -109,7 +111,7 @@ public class TableOp extends BaseOp {\n           FileUtils.readFileToString(new File(_schemaFileName)));\n       return true;\n     } catch (IOException e) {\n-      System.out.println(e.getMessage());\n+      LOGGER.error(\"Failed to create schema with file: {}\", _schemaFileName, e);\n       return false;\n     }\n   }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk5OTg0Mg==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r546999842", "bodyText": "dont need this anymore", "author": "mcvsubbu", "createdAt": "2020-12-22T00:28:34Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java", "diffHunk": "@@ -45,6 +54,8 @@\n   private Op _op;\n   private String _tableConfigFileName;\n \n+  private static final String TABLE_NAME = \"tableName\";", "originalCommit": "52aa498eb04f784fda46d631e0cf097974a01a0f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1e632205207a504503659226b906525f8eeb59ed", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\nindex cbee5193e0..24e9b87bb1 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n\n@@ -54,7 +56,7 @@ public class TableOp extends BaseOp {\n   private Op _op;\n   private String _tableConfigFileName;\n \n-  private static final String TABLE_NAME = \"tableName\";\n+  private static final Logger LOGGER = LoggerFactory.getLogger(TableOp.class);\n \n   public TableOp() {\n     super(OpType.TABLE_OP);\n"}}, {"oid": "1e632205207a504503659226b906525f8eeb59ed", "url": "https://github.com/apache/pinot/commit/1e632205207a504503659226b906525f8eeb59ed", "message": "compatibility test: create/delete table operations", "committedDate": "2020-12-22T01:13:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzAyODk1MA==", "url": "https://github.com/apache/pinot/pull/6360#discussion_r547028950", "bodyText": "Please avoid import static", "author": "mcvsubbu", "createdAt": "2020-12-22T02:17:54Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java", "diffHunk": "@@ -19,6 +19,17 @@\n package org.apache.pinot.compat.tests;\n \n import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import java.io.File;\n+import java.io.IOException;\n+import org.apache.commons.io.FileUtils;\n+import org.apache.pinot.controller.helix.ControllerRequestURLBuilder;\n+import org.apache.pinot.controller.helix.ControllerTest;\n+import org.apache.pinot.spi.config.table.TableConfig;\n+import org.apache.pinot.spi.utils.JsonUtils;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import static org.apache.pinot.compat.tests.ClusterDescriptor.CONTROLLER_URL;", "originalCommit": "1e632205207a504503659226b906525f8eeb59ed", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4df903121e605022ee4c0781a89e59764a0ca823", "chunk": "diff --git a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\nindex 24e9b87bb1..1eeb01ea01 100644\n--- a/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n+++ b/pinot-integration-tests/src/test/java/org/apache/pinot/compat/tests/TableOp.java\n\n@@ -29,8 +29,6 @@ import org.apache.pinot.spi.utils.JsonUtils;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n-import static org.apache.pinot.compat.tests.ClusterDescriptor.CONTROLLER_URL;\n-\n \n /**\n  * TableOp creates, or deletes a table, or updates the table config.\n"}}, {"oid": "4df903121e605022ee4c0781a89e59764a0ca823", "url": "https://github.com/apache/pinot/commit/4df903121e605022ee4c0781a89e59764a0ca823", "message": "compatibility test: create/delete table operations", "committedDate": "2020-12-22T02:27:41Z", "type": "commit"}, {"oid": "4df903121e605022ee4c0781a89e59764a0ca823", "url": "https://github.com/apache/pinot/commit/4df903121e605022ee4c0781a89e59764a0ca823", "message": "compatibility test: create/delete table operations", "committedDate": "2020-12-22T02:27:41Z", "type": "forcePushed"}]}