{"pr_number": 5788, "pr_title": "[TE] Error handling refactor of EntityManagerResource", "pr_createdAt": "2020-08-01T20:51:04Z", "pr_url": "https://github.com/apache/pinot/pull/5788", "timeline": [{"oid": "f73abbb13bcc8773ceec6fe3d46fa14062d42df2", "url": "https://github.com/apache/pinot/commit/f73abbb13bcc8773ceec6fe3d46fa14062d42df2", "message": "[TE] Error handling refactor of EntityManagerResource\n\nChanges:\n- Throw 400 instead of 500 for invalid query params\n- Added a placeholder for resource utility methods: ResourceUtils\n- Added BadRequestWebException to better handle invalid requests\n\nThe long term goal is to have a suite of utilities to make the Resource code\nsimple by easing out validations and error handling", "committedDate": "2020-08-01T20:48:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEzNTcyOQ==", "url": "https://github.com/apache/pinot/pull/5788#discussion_r464135729", "bodyText": "can you copy over and include the license header on new files.", "author": "akshayrai", "createdAt": "2020-08-02T23:22:52Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java", "diffHunk": "@@ -0,0 +1,29 @@\n+package org.apache.pinot.thirdeye.dashboard.resources;", "originalCommit": "f73abbb13bcc8773ceec6fe3d46fa14062d42df2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "870b406f0571f581e15ff1f9814e7e7de1a4f6b3", "chunk": "diff --git a/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java b/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java\nindex d3f94553ea..70ec629409 100644\n--- a/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java\n+++ b/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java\n\n@@ -1,3 +1,23 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ *\n+ */\n+\n package org.apache.pinot.thirdeye.dashboard.resources;\n \n import javax.ws.rs.WebApplicationException;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEzNTkyNA==", "url": "https://github.com/apache/pinot/pull/5788#discussion_r464135924", "bodyText": "consider including some javadocs for this utility class", "author": "akshayrai", "createdAt": "2020-08-02T23:24:50Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/ResourceUtils.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package org.apache.pinot.thirdeye.dashboard.resources;\n+\n+public class ResourceUtils {", "originalCommit": "f73abbb13bcc8773ceec6fe3d46fa14062d42df2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "870b406f0571f581e15ff1f9814e7e7de1a4f6b3", "chunk": "diff --git a/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/ResourceUtils.java b/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/ResourceUtils.java\nindex dc3f795266..046e4d173c 100644\n--- a/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/ResourceUtils.java\n+++ b/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/ResourceUtils.java\n\n@@ -1,18 +1,58 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ *\n+ */\n+\n package org.apache.pinot.thirdeye.dashboard.resources;\n \n+/**\n+ * This class is expected to house static utilities that help responding to resource requests.\n+ */\n public class ResourceUtils {\n \n+  /**\n+   * ensure a condition is true and respond with bad request otherwise\n+   *\n+   * @param condition ensure this condition is true\n+   * @param message message sent in the 400 response to the user in plain text\n+   */\n   public static void ensure(boolean condition, String message) {\n     if (!condition) {\n       throw new BadRequestWebException(message);\n     }\n   }\n \n+  /**\n+   * ensure the object exists and respond with bad request otherwise\n+   *\n+   * @param o ensure this object is not null\n+   * @param message message sent in the 400 response to the user in plain text\n+   */\n   public static <T> T ensureExists(T o, String message) {\n     ensure(o != null, message);\n     return o;\n   }\n \n+  /**\n+   * Utility method to throw badRequest\n+   * @param errorMsg msg to be sent to user\n+   * @return instance of BadRequestWebException\n+   */\n   public static BadRequestWebException badRequest(String errorMsg) {\n     return new BadRequestWebException(errorMsg);\n   }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEzNjc3MQ==", "url": "https://github.com/apache/pinot/pull/5788#discussion_r464136771", "bodyText": "javadocs", "author": "akshayrai", "createdAt": "2020-08-02T23:32:25Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java", "diffHunk": "@@ -0,0 +1,29 @@\n+package org.apache.pinot.thirdeye.dashboard.resources;\n+\n+import javax.ws.rs.WebApplicationException;\n+import javax.ws.rs.core.MediaType;\n+import javax.ws.rs.core.Response;\n+import javax.ws.rs.core.Response.Status;\n+\n+public class BadRequestWebException extends WebApplicationException {", "originalCommit": "f73abbb13bcc8773ceec6fe3d46fa14062d42df2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "870b406f0571f581e15ff1f9814e7e7de1a4f6b3", "chunk": "diff --git a/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java b/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java\nindex d3f94553ea..70ec629409 100644\n--- a/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java\n+++ b/thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/BadRequestWebException.java\n\n@@ -1,3 +1,23 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ *\n+ */\n+\n package org.apache.pinot.thirdeye.dashboard.resources;\n \n import javax.ws.rs.WebApplicationException;\n"}}, {"oid": "870b406f0571f581e15ff1f9814e7e7de1a4f6b3", "url": "https://github.com/apache/pinot/commit/870b406f0571f581e15ff1f9814e7e7de1a4f6b3", "message": "[TE] Updated  copyright and added documentation", "committedDate": "2020-08-03T18:53:18Z", "type": "commit"}, {"oid": "f613745b5a278f4a0182f57511bbb56cb0c2d5ed", "url": "https://github.com/apache/pinot/commit/f613745b5a278f4a0182f57511bbb56cb0c2d5ed", "message": "[TE] Updated  copyright and added documentation", "committedDate": "2020-08-03T18:55:37Z", "type": "commit"}]}