{"pr_number": 5657, "pr_title": "Using dictionary based aggregation operator when there is no filter/g\u2026", "pr_createdAt": "2020-07-02T22:58:47Z", "pr_url": "https://github.com/apache/pinot/pull/5657", "timeline": [{"oid": "1f9227858121bcaa35cbcabde08e79310cd5820f", "url": "https://github.com/apache/pinot/commit/1f9227858121bcaa35cbcabde08e79310cd5820f", "message": "Using dictionary based aggregation operator when there is no filter/group by", "committedDate": "2020-07-02T22:53:05Z", "type": "commit"}, {"oid": "ddd3f5f450b7579bc62d8b07efb101c4af1d94ef", "url": "https://github.com/apache/pinot/commit/ddd3f5f450b7579bc62d8b07efb101c4af1d94ef", "message": "Fixing test cases, numEntriesScannedPostFilter has changed if there is a filter", "committedDate": "2020-07-03T19:45:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgyNDY1MA==", "url": "https://github.com/apache/pinot/pull/5657#discussion_r449824650", "bodyText": "Would be good to use AggregationFunctionType instead of string name. Also, would be good to factor out as isFunctionFitForDictionaryBasedComputation in say AggregationFunctionUtils, for readability.", "author": "mayankshriv", "createdAt": "2020-07-05T02:55:17Z", "path": "pinot-core/src/main/java/org/apache/pinot/core/plan/maker/InstancePlanMakerImplV2.java", "diffHunk": "@@ -164,7 +164,8 @@ static boolean isFitForDictionaryBasedPlan(QueryContext queryContext, IndexSegme\n     for (ExpressionContext expression : selectExpressions) {\n       FunctionContext function = expression.getFunction();\n       String functionName = function.getFunctionName();\n-      if (!functionName.equals(\"min\") && !functionName.equals(\"max\") && !functionName.equals(\"minmaxrange\")) {\n+      if (!functionName.equals(\"min\") && !functionName.equals(\"max\") && !functionName.equals(\"minmaxrange\")", "originalCommit": "ddd3f5f450b7579bc62d8b07efb101c4af1d94ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgzNzI3Mg==", "url": "https://github.com/apache/pinot/pull/5657#discussion_r449837272", "bodyText": "Done", "author": "kishoreg", "createdAt": "2020-07-05T05:46:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgyNDY1MA=="}], "type": "inlineReview", "revised_code": {"commit": "a07b16c45858598c68c9be6bc723206a27acfb80", "chunk": "diff --git a/pinot-core/src/main/java/org/apache/pinot/core/plan/maker/InstancePlanMakerImplV2.java b/pinot-core/src/main/java/org/apache/pinot/core/plan/maker/InstancePlanMakerImplV2.java\nindex ae6ce044a0..1658a50f43 100644\n--- a/pinot-core/src/main/java/org/apache/pinot/core/plan/maker/InstancePlanMakerImplV2.java\n+++ b/pinot-core/src/main/java/org/apache/pinot/core/plan/maker/InstancePlanMakerImplV2.java\n\n@@ -156,7 +157,7 @@ public class InstancePlanMakerImplV2 implements PlanMaker {\n   /**\n    * Returns {@code true} if the given aggregation-only without filter QueryContext can be solved with dictionary,\n    * {@code false} otherwise.\n-   * <p>Aggregations supported: MIN, MAX, MINMAXRANGE\n+   * <p>Aggregations supported: MIN, MAX, MINMAXRANGE, DISTINCTCOUNT\n    */\n   @VisibleForTesting\n   static boolean isFitForDictionaryBasedPlan(QueryContext queryContext, IndexSegment indexSegment) {\n"}}, {"oid": "a07b16c45858598c68c9be6bc723206a27acfb80", "url": "https://github.com/apache/pinot/commit/a07b16c45858598c68c9be6bc723206a27acfb80", "message": "Addressing comments", "committedDate": "2020-07-05T05:55:31Z", "type": "commit"}]}