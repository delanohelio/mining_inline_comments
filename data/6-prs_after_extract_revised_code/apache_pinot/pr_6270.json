{"pr_number": 6270, "pr_title": "Allow setting HTTP headers and parameters during schema upload", "pr_createdAt": "2020-11-17T02:02:33Z", "pr_url": "https://github.com/apache/pinot/pull/6270", "timeline": [{"oid": "1b49e43e3bc2f925e103c4a0de784a7b72ac70c6", "url": "https://github.com/apache/pinot/commit/1b49e43e3bc2f925e103c4a0de784a7b72ac70c6", "message": "Allow setting HTTP headers and parameters during schema upload", "committedDate": "2020-11-17T01:55:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg2NjE4NA==", "url": "https://github.com/apache/pinot/pull/6270#discussion_r524866184", "bodyText": "Add nullable annotation to headers and parameters", "author": "Jackie-Jiang", "createdAt": "2020-11-17T03:45:51Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java", "diffHunk": "@@ -243,8 +243,9 @@ private static HttpUriRequest constructDeleteRequest(URI uri) {\n     return requestBuilder.build();\n   }\n \n-  private static HttpUriRequest getAddSchemaRequest(URI uri, String schemaName, File schemaFile) {\n-    return getUploadFileRequest(HttpPost.METHOD_NAME, uri, getContentBody(schemaName, schemaFile), null, null,\n+  private static HttpUriRequest getAddSchemaRequest(URI uri, String schemaName, File schemaFile, List<Header> headers,", "originalCommit": "1b49e43e3bc2f925e103c4a0de784a7b72ac70c6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0c5cb6fadb1e501be370d36315b56d2671b572dc", "chunk": "diff --git a/pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java b/pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java\nindex d11d21b7d..0c24b766f 100644\n--- a/pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java\n+++ b/pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java\n\n@@ -243,8 +243,8 @@ public class FileUploadDownloadClient implements Closeable {\n     return requestBuilder.build();\n   }\n \n-  private static HttpUriRequest getAddSchemaRequest(URI uri, String schemaName, File schemaFile, List<Header> headers,\n-      List<NameValuePair> parameters) {\n+  private static HttpUriRequest getAddSchemaRequest(URI uri, String schemaName, File schemaFile,\n+      @Nullable List<Header> headers, @Nullable List<NameValuePair> parameters) {\n     return getUploadFileRequest(HttpPost.METHOD_NAME, uri, getContentBody(schemaName, schemaFile), headers, parameters,\n         DEFAULT_SOCKET_TIMEOUT_MS);\n   }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg2NjIwMA==", "url": "https://github.com/apache/pinot/pull/6270#discussion_r524866200", "bodyText": "Add nullable annotation to headers and parameters", "author": "Jackie-Jiang", "createdAt": "2020-11-17T03:45:55Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java", "diffHunk": "@@ -419,7 +420,25 @@ public SimpleHttpResponse sendDeleteRequest(URI uri)\n    */\n   public SimpleHttpResponse addSchema(URI uri, String schemaName, File schemaFile)\n       throws IOException, HttpErrorStatusException {\n-    return sendRequest(getAddSchemaRequest(uri, schemaName, schemaFile));\n+    return sendRequest(getAddSchemaRequest(uri, schemaName, schemaFile, null, null));\n+  }\n+\n+  /**\n+   * Add schema.\n+   *\n+   * @param uri URI\n+   * @param schemaName Schema name\n+   * @param schemaFile Schema file\n+   * @param headers HTTP headers\n+   * @param parameters HTTP parameters\n+   * @return Response\n+   * @throws IOException\n+   * @throws HttpErrorStatusException\n+   */\n+  public SimpleHttpResponse addSchema(URI uri, String schemaName, File schemaFile, List<Header> headers,", "originalCommit": "1b49e43e3bc2f925e103c4a0de784a7b72ac70c6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0c5cb6fadb1e501be370d36315b56d2671b572dc", "chunk": "diff --git a/pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java b/pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java\nindex d11d21b7d..0c24b766f 100644\n--- a/pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java\n+++ b/pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java\n\n@@ -435,8 +435,8 @@ public class FileUploadDownloadClient implements Closeable {\n    * @throws IOException\n    * @throws HttpErrorStatusException\n    */\n-  public SimpleHttpResponse addSchema(URI uri, String schemaName, File schemaFile, List<Header> headers,\n-      List<NameValuePair> parameters)\n+  public SimpleHttpResponse addSchema(URI uri, String schemaName, File schemaFile, @Nullable List<Header> headers,\n+      @Nullable List<NameValuePair> parameters)\n       throws IOException, HttpErrorStatusException {\n     return sendRequest(getAddSchemaRequest(uri, schemaName, schemaFile, headers, parameters));\n   }\n"}}, {"oid": "0c5cb6fadb1e501be370d36315b56d2671b572dc", "url": "https://github.com/apache/pinot/commit/0c5cb6fadb1e501be370d36315b56d2671b572dc", "message": "comments", "committedDate": "2020-11-17T04:04:04Z", "type": "commit"}]}