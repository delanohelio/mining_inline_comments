{"pr_number": 5370, "pr_title": "Schema method to fetch field spec of time column", "pr_createdAt": "2020-05-12T02:04:15Z", "pr_url": "https://github.com/apache/pinot/pull/5370", "timeline": [{"oid": "eb8faeb6d5835b6ea4d46b75474917653b061524", "url": "https://github.com/apache/pinot/commit/eb8faeb6d5835b6ea4d46b75474917653b061524", "message": "Schema method to fetch field spec of time column", "committedDate": "2020-05-12T01:58:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzNTIyMw==", "url": "https://github.com/apache/pinot/pull/5370#discussion_r423435223", "bodyText": "Can we throw IllegalStateException here?", "author": "siddharthteotia", "createdAt": "2020-05-12T03:06:30Z", "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java", "diffHunk": "@@ -299,6 +299,24 @@ public DateTimeFieldSpec getDateTimeSpec(String dateTimeName) {\n     return null;\n   }\n \n+  /**\n+   * Fetches the DateTimeFieldSpec for the given time column name.\n+   * If the columnName is a DATE_TIME column, returns the DateTimeFieldSpec\n+   * If the columnName is a TIME column, converts to DateTimeFieldSpec before returning\n+   */\n+  public DateTimeFieldSpec getSpecForTimeColumn(String timeColumnName) {\n+    FieldSpec fieldSpec = _fieldSpecMap.get(timeColumnName);\n+    if (fieldSpec != null) {\n+      if (fieldSpec.getFieldType() == FieldType.DATE_TIME) {\n+        return (DateTimeFieldSpec) fieldSpec;\n+      }\n+      if (fieldSpec.getFieldType() == FieldType.TIME) {\n+        return convertToDateTimeFieldSpec((TimeFieldSpec) fieldSpec);\n+      }\n+    }\n+    return null;", "originalCommit": "eb8faeb6d5835b6ea4d46b75474917653b061524", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg1NTEyNw==", "url": "https://github.com/apache/pinot/pull/5370#discussion_r423855127", "bodyText": "I'm trying to maintain the behavior exhibited by the old method that this new one will replace. Marked the method Nullable as an additional measure.", "author": "npawar", "createdAt": "2020-05-12T16:06:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzNTIyMw=="}], "type": "inlineReview", "revised_code": {"commit": "386123c09b7613224513f8c7b3c36f7f88a558ed", "chunk": "diff --git a/pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java b/pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java\nindex ce55b9e369..a3a2b64e89 100644\n--- a/pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java\n+++ b/pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java\n\n@@ -304,6 +304,8 @@ public final class Schema {\n    * If the columnName is a DATE_TIME column, returns the DateTimeFieldSpec\n    * If the columnName is a TIME column, converts to DateTimeFieldSpec before returning\n    */\n+  @JsonIgnore\n+  @Nullable\n   public DateTimeFieldSpec getSpecForTimeColumn(String timeColumnName) {\n     FieldSpec fieldSpec = _fieldSpecMap.get(timeColumnName);\n     if (fieldSpec != null) {\n"}}, {"oid": "386123c09b7613224513f8c7b3c36f7f88a558ed", "url": "https://github.com/apache/pinot/commit/386123c09b7613224513f8c7b3c36f7f88a558ed", "message": "Mark Nullable", "committedDate": "2020-05-12T16:03:43Z", "type": "commit"}]}