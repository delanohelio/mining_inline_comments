{"pr_number": 5546, "pr_title": "Handle case sensitivity for PinotQuery within BrokerRequest", "pr_createdAt": "2020-06-12T01:42:42Z", "pr_url": "https://github.com/apache/pinot/pull/5546", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE3NjUzNw==", "url": "https://github.com/apache/pinot/pull/5546#discussion_r439176537", "bodyText": "We can add something like enable.case.sensitivity and fall back to enable.case.insensitive.pql? Since it's a pretty simple change, we can include to this PR?", "author": "snleee", "createdAt": "2020-06-12T02:39:59Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/utils/CommonConstants.java", "diffHunk": "@@ -40,6 +40,7 @@\n     public static final String LEAD_CONTROLLER_RESOURCE_NAME = \"leadControllerResource\";\n \n     public static final String LEAD_CONTROLLER_RESOURCE_ENABLED_KEY = \"RESOURCE_ENABLED\";\n+    // TODO: Rename this config because it applies to both SQL and PQL\n     public static final String ENABLE_CASE_INSENSITIVE_PQL_KEY = \"enable.case.insensitive.pql\";", "originalCommit": "e74d3f070c495e45096f12c038640e8108062fef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY0NTEwNQ==", "url": "https://github.com/apache/pinot/pull/5546#discussion_r439645105", "bodyText": "Done", "author": "Jackie-Jiang", "createdAt": "2020-06-12T21:14:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE3NjUzNw=="}], "type": "inlineReview", "revised_code": {"commit": "4c5f17c6f1efc31839353f6054d039382b962390", "chunk": "diff --git a/pinot-common/src/main/java/org/apache/pinot/common/utils/CommonConstants.java b/pinot-common/src/main/java/org/apache/pinot/common/utils/CommonConstants.java\nindex a403b2b5f7..8ed27dd178 100644\n--- a/pinot-common/src/main/java/org/apache/pinot/common/utils/CommonConstants.java\n+++ b/pinot-common/src/main/java/org/apache/pinot/common/utils/CommonConstants.java\n\n@@ -40,8 +40,9 @@ public class CommonConstants {\n     public static final String LEAD_CONTROLLER_RESOURCE_NAME = \"leadControllerResource\";\n \n     public static final String LEAD_CONTROLLER_RESOURCE_ENABLED_KEY = \"RESOURCE_ENABLED\";\n-    // TODO: Rename this config because it applies to both SQL and PQL\n-    public static final String ENABLE_CASE_INSENSITIVE_PQL_KEY = \"enable.case.insensitive.pql\";\n+\n+    public static final String ENABLE_CASE_INSENSITIVE_KEY = \"enable.case.insensitive\";\n+    public static final String DEPRECATED_ENABLE_CASE_INSENSITIVE_KEY = \"enable.case.insensitive.pql\";\n \n     // More information on why these numbers are set can be found in the following doc:\n     // https://cwiki.apache.org/confluence/display/PINOT/Controller+Separation+between+Helix+and+Pinot\n"}}, {"oid": "4c5f17c6f1efc31839353f6054d039382b962390", "url": "https://github.com/apache/pinot/commit/4c5f17c6f1efc31839353f6054d039382b962390", "message": "Handle case sensitivity for PinotQuery within BrokerRequest\n\nCurrently the case sensitivity handling only applies to the BrokerRequest, but not to the PinotQuery inside the BrokerRequest.\nThis will cause inconsistent and unexpected behavior when the query engine uses PinotQuery.\n\nFix this issue by extending the case sensitivity handling to the PinotQuery if it exists.\nNote that because SQL queries are also compiled to BrokerRequest, the case sensitivity handling already applies to both PQL and SQL.\n\nDeprecate the config key `enable.case.insensitive.pql` in Helix cluster config and replace it with `enable.case.insensitive`, but keep backward compatibility.", "committedDate": "2020-06-12T21:13:36Z", "type": "forcePushed"}, {"oid": "b71fa29a3753f09d4432b0e771dbb632d0b3568d", "url": "https://github.com/apache/pinot/commit/b71fa29a3753f09d4432b0e771dbb632d0b3568d", "message": "Handle case sensitivity for PinotQuery within BrokerRequest\n\nCurrently the case sensitivity handling only applies to the BrokerRequest, but not to the PinotQuery inside the BrokerRequest.\nThis will cause inconsistent and unexpected behavior when the query engine uses PinotQuery.\n\nFix this issue by extending the case sensitivity handling to the PinotQuery if it exists.\nNote that because SQL queries are also compiled to BrokerRequest, the case sensitivity handling already applies to both PQL and SQL.\n\nDeprecate the config key `enable.case.insensitive.pql` in Helix cluster config and replace it with `enable.case.insensitive`, but keep backward compatibility.", "committedDate": "2020-06-12T21:20:26Z", "type": "commit"}, {"oid": "b71fa29a3753f09d4432b0e771dbb632d0b3568d", "url": "https://github.com/apache/pinot/commit/b71fa29a3753f09d4432b0e771dbb632d0b3568d", "message": "Handle case sensitivity for PinotQuery within BrokerRequest\n\nCurrently the case sensitivity handling only applies to the BrokerRequest, but not to the PinotQuery inside the BrokerRequest.\nThis will cause inconsistent and unexpected behavior when the query engine uses PinotQuery.\n\nFix this issue by extending the case sensitivity handling to the PinotQuery if it exists.\nNote that because SQL queries are also compiled to BrokerRequest, the case sensitivity handling already applies to both PQL and SQL.\n\nDeprecate the config key `enable.case.insensitive.pql` in Helix cluster config and replace it with `enable.case.insensitive`, but keep backward compatibility.", "committedDate": "2020-06-12T21:20:26Z", "type": "forcePushed"}]}