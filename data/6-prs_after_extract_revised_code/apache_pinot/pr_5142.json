{"pr_number": 5142, "pr_title": "[TE] Detection creation endpoints should trigger Replay & Tuning", "pr_createdAt": "2020-03-11T19:35:35Z", "pr_url": "https://github.com/apache/pinot/pull/5142", "timeline": [{"oid": "595d5c3d7bcbe083015676f04e07e470d20f69dd", "url": "https://github.com/apache/pinot/commit/595d5c3d7bcbe083015676f04e07e470d20f69dd", "message": "[TE] Detection creation endpoints should trigger Replay & Tuning", "committedDate": "2020-03-11T19:33:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIzNzMxMQ==", "url": "https://github.com/apache/pinot/pull/5142#discussion_r391237311", "bodyText": "Will this cause lot of system burden if user bulk onboarding using API?", "author": "xiaohui-sun", "createdAt": "2020-03-11T20:08:51Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/yaml/YamlResource.java", "diffHunk": "@@ -380,6 +380,9 @@ long createDetectionConfig(@NotNull String payload, long startTime, long endTime\n     Long id = this.detectionConfigDAO.save(detectionConfig);\n     Preconditions.checkNotNull(id, \"Error while saving the detection pipeline\");\n \n+    // create an yaml onboarding task to run replay and tuning\n+    createYamlOnboardingTask(detectionConfig.getId(), startTime, endTime);", "originalCommit": "595d5c3d7bcbe083015676f04e07e470d20f69dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTI5NTI4OQ==", "url": "https://github.com/apache/pinot/pull/5142#discussion_r391295289", "bodyText": "The onboarding jobs complete within half a minute on an average case and I don't think it should be a problem. In addition, I am not sure if bulk-onboarding of alerts is a common use-case or whether we should even encourage such use-cases except for some special cases like \"onboard all UMP metrics\" in which case we should anyways take precaution. Alerts are typically created by users on various portals and the throughput(requests/sec) is typically not that high.\nOn the other hand, if we do not trigger the onboarding job, then apart from the replay, even the tuning component isn't triggered.", "author": "akshayrai", "createdAt": "2020-03-11T22:08:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIzNzMxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTI5NzY1MQ==", "url": "https://github.com/apache/pinot/pull/5142#discussion_r391297651", "bodyText": "One approach could be having a flag - like 'ui=true' - in the API, so that the frontend could get the error messages and non-UI clients can skip the messages.", "author": "harleyjj", "createdAt": "2020-03-11T22:12:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIzNzMxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwODk2OQ==", "url": "https://github.com/apache/pinot/pull/5142#discussion_r391408969", "bodyText": "The onboarding jobs complete within half a minute on an average case and I don't think it should be a problem. In addition, I am not sure if bulk-onboarding of alerts is a common use-case or whether we should even encourage such use-cases except for some special cases like \"onboard all UMP metrics\" in which case we should anyways take precaution. Alerts are typically created by users on various portals and the throughput(requests/sec) is typically not that high.\nOn the other hand, if we do not trigger the onboarding job, then apart from the replay, even the tuning component isn't triggered.\n\nDefinitely this is not encouraged. We need to have a fuse mechanism somewhere to avoid bringing down the whole site if it happens. Maybe we should throttle the replay tasks.", "author": "xiaohui-sun", "createdAt": "2020-03-12T05:31:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIzNzMxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM0MzIxMA==", "url": "https://github.com/apache/pinot/pull/5142#discussion_r392343210", "bodyText": "@xiaohui-sun +1, I have filed a separate ticket to track the fuse mechanism.", "author": "akshayrai", "createdAt": "2020-03-13T16:40:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIzNzMxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUzOTg5MQ==", "url": "https://github.com/apache/pinot/pull/5142#discussion_r392539891", "bodyText": "Thanks!", "author": "xiaohui-sun", "createdAt": "2020-03-14T00:44:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIzNzMxMQ=="}], "type": "inlineReview", "revised_code": null}]}