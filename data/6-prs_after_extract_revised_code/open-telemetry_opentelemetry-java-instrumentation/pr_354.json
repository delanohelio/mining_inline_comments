{"pr_number": 354, "pr_title": "Fix some sporadic test failures", "pr_createdAt": "2020-04-26T17:43:22Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/354", "timeline": [{"oid": "da061d04594ea6a3ccd87b2e7b69974cbdd019ab", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/da061d04594ea6a3ccd87b2e7b69974cbdd019ab", "message": "Revert \"Fix some sporadic failures (#349)\"\n\nThis reverts commit 2d2f4a953e869b6a5bc380990820e923374d519b.", "committedDate": "2020-04-26T17:24:31Z", "type": "commit"}, {"oid": "f436499883d16a530faaa4383bc868ca0d4d14e3", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/f436499883d16a530faaa4383bc868ca0d4d14e3", "message": "Fix some sporadic test failures", "committedDate": "2020-04-26T17:24:31Z", "type": "commit"}, {"oid": "364d215f0439db14247d6b7c94739a315ea46116", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/364d215f0439db14247d6b7c94739a315ea46116", "message": "Fix smore sporadic test failures", "committedDate": "2020-04-26T17:25:16Z", "type": "commit"}, {"oid": "b57847155d869158e8454aa2ab339b735b844a86", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/b57847155d869158e8454aa2ab339b735b844a86", "message": "Improve Jetty test advice", "committedDate": "2020-04-26T17:25:16Z", "type": "commit"}, {"oid": "704a23affc5d8ade3ec9737ec59bfae8be5c6ac9", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/704a23affc5d8ade3ec9737ec59bfae8be5c6ac9", "message": "Improve test consistency", "committedDate": "2020-04-26T17:42:36Z", "type": "commit"}, {"oid": "209467d21d94b16e3dbe1e04db84b5448dff72ea", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/209467d21d94b16e3dbe1e04db84b5448dff72ea", "message": "Debug AkkaActorTest sporadic failure", "committedDate": "2020-04-26T21:51:16Z", "type": "forcePushed"}, {"oid": "704a23affc5d8ade3ec9737ec59bfae8be5c6ac9", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/704a23affc5d8ade3ec9737ec59bfae8be5c6ac9", "message": "Improve test consistency", "committedDate": "2020-04-26T17:42:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjA1MjIxOA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/354#discussion_r416052218", "bodyText": "Was this causing failures, or just simplifying things?", "author": "tylerbenson", "createdAt": "2020-04-27T18:31:52Z", "path": "instrumentation/jetty-8.0/src/test/groovy/JettyTestInstrumentation.java", "diffHunk": "@@ -26,21 +26,7 @@\n   @Override\n   public AgentBuilder instrument(final AgentBuilder agentBuilder) {\n     return agentBuilder\n-        // Jetty 8.0\n-        .type(named(\"org.eclipse.jetty.server.HttpConnection\"))\n-        .transform(\n-            new AgentBuilder.Transformer.ForAdvice()\n-                .advice(\n-                    named(\"handleRequest\"), HttpServerTestAdvice.ServerEntryAdvice.class.getName()))\n-        // Jetty 8.?\n-        .type(named(\"org.eclipse.jetty.server.AbstractHttpConnection\"))\n-        .transform(\n-            new AgentBuilder.Transformer.ForAdvice()\n-                .advice(\n-                    named(\"headerComplete\"),\n-                    HttpServerTestAdvice.ServerEntryAdvice.class.getName()))\n-        // Jetty 9\n-        .type(named(\"org.eclipse.jetty.server.HttpChannel\"))\n+        .type(named(\"org.eclipse.jetty.server.Server\"))\n         .transform(", "originalCommit": "704a23affc5d8ade3ec9737ec59bfae8be5c6ac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjA1NjEyNQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/354#discussion_r416056125", "bodyText": "when i removed the conditional on creating TEST_SPAN spans, the existing jetty instrumentation ended up creating 2 TEST_SPAN spans, because it was also called under async context handler", "author": "trask", "createdAt": "2020-04-27T18:37:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjA1MjIxOA=="}], "type": "inlineReview", "revised_code": null}]}