{"pr_number": 1690, "pr_title": "Update to SDK 0.11.0", "pr_createdAt": "2020-11-19T07:54:10Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1690", "timeline": [{"oid": "634511fadd59ff4499b1aed545c94040caf49b49", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/634511fadd59ff4499b1aed545c94040caf49b49", "message": "Update to SDK 0.11.0", "committedDate": "2020-11-19T07:09:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY4ODk4Mg==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1690#discussion_r526688982", "bodyText": "Minor reuse suggestion:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  OpenTelemetry.set(\n          \n          \n            \n                      OpenTelemetrySdk.builder()\n          \n          \n            \n                          .setResource(OpenTelemetrySdk.get().getResource())\n          \n          \n            \n                          .setClock(OpenTelemetrySdk.get().getClock())\n          \n          \n            \n                          .setMeterProvider(OpenTelemetry.getGlobalMeterProvider())\n          \n          \n            \n                          .setTracerProvider(unobfuscate(OpenTelemetry.getGlobalTracerProvider()))\n          \n          \n            \n                          .setPropagators(\n          \n          \n            \n                              DefaultContextPropagators.builder()\n          \n          \n            \n                                  .addTextMapPropagator(HttpTraceContext.getInstance())\n          \n          \n            \n                                  .build())\n          \n          \n            \n                          .build());\n          \n          \n            \n                  setGlobalPropagators(DefaultContextPropagators.builder()\n          \n          \n            \n                          .addTextMapPropagator(HttpTraceContext.getInstance())\n          \n          \n            \n                          .build());", "author": "mateuszrzeszutek", "createdAt": "2020-11-19T08:51:21Z", "path": "testing-common/src/main/groovy/io/opentelemetry/instrumentation/test/AgentTestRunner.java", "diffHunk": "@@ -109,9 +112,17 @@\n         .getClass()\n         .getSimpleName()\n         .equals(\"NoopTextMapPropagator\")) {\n-      OpenTelemetry.setGlobalPropagators(\n-          DefaultContextPropagators.builder()\n-              .addTextMapPropagator(HttpTraceContext.getInstance())\n+      // Workaround https://github.com/open-telemetry/opentelemetry-java/pull/2096\n+      OpenTelemetry.set(\n+          OpenTelemetrySdk.builder()\n+              .setResource(OpenTelemetrySdk.get().getResource())\n+              .setClock(OpenTelemetrySdk.get().getClock())\n+              .setMeterProvider(OpenTelemetry.getGlobalMeterProvider())\n+              .setTracerProvider(unobfuscate(OpenTelemetry.getGlobalTracerProvider()))\n+              .setPropagators(\n+                  DefaultContextPropagators.builder()\n+                      .addTextMapPropagator(HttpTraceContext.getInstance())\n+                      .build())\n               .build());", "originalCommit": "634511fadd59ff4499b1aed545c94040caf49b49", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "465bf4d933d41dbaf261efe63f07701a0f2ae7a8", "chunk": "diff --git a/testing-common/src/main/groovy/io/opentelemetry/instrumentation/test/AgentTestRunner.java b/testing-common/src/main/groovy/io/opentelemetry/instrumentation/test/AgentTestRunner.java\nindex ff9f1c113..0b32252ce 100644\n--- a/testing-common/src/main/groovy/io/opentelemetry/instrumentation/test/AgentTestRunner.java\n+++ b/testing-common/src/main/groovy/io/opentelemetry/instrumentation/test/AgentTestRunner.java\n\n@@ -113,16 +113,9 @@ public abstract class AgentTestRunner extends Specification {\n         .getSimpleName()\n         .equals(\"NoopTextMapPropagator\")) {\n       // Workaround https://github.com/open-telemetry/opentelemetry-java/pull/2096\n-      OpenTelemetry.set(\n-          OpenTelemetrySdk.builder()\n-              .setResource(OpenTelemetrySdk.get().getResource())\n-              .setClock(OpenTelemetrySdk.get().getClock())\n-              .setMeterProvider(OpenTelemetry.getGlobalMeterProvider())\n-              .setTracerProvider(unobfuscate(OpenTelemetry.getGlobalTracerProvider()))\n-              .setPropagators(\n-                  DefaultContextPropagators.builder()\n-                      .addTextMapPropagator(HttpTraceContext.getInstance())\n-                      .build())\n+      setGlobalPropagators(\n+          DefaultContextPropagators.builder()\n+              .addTextMapPropagator(HttpTraceContext.getInstance())\n               .build());\n     }\n     OpenTelemetrySdk.getGlobalTracerManagement().addSpanProcessor(TEST_WRITER);\n"}}, {"oid": "fb462e031be48584db28a61b0de462a72b3c6752", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/fb462e031be48584db28a61b0de462a72b3c6752", "message": "Merge remote-tracking branch 'upstream/master' into pr-otel-0.11", "committedDate": "2020-11-19T22:43:15Z", "type": "commit"}, {"oid": "96394ff2ea2f55b43b3d360a17936b932e4f9826", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/96394ff2ea2f55b43b3d360a17936b932e4f9826", "message": "Shade OTel SPI", "committedDate": "2020-11-19T22:47:18Z", "type": "commit"}, {"oid": "465bf4d933d41dbaf261efe63f07701a0f2ae7a8", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/465bf4d933d41dbaf261efe63f07701a0f2ae7a8", "message": "Accept review feedback", "committedDate": "2020-11-19T22:53:15Z", "type": "commit"}, {"oid": "54718914d0132899517a92c00209e92faff5c088", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/54718914d0132899517a92c00209e92faff5c088", "message": "Cleanup", "committedDate": "2020-11-19T23:40:40Z", "type": "commit"}, {"oid": "467875bfe6d2caca0e5c4680cce398e0c52801e0", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/467875bfe6d2caca0e5c4680cce398e0c52801e0", "message": "Spotless", "committedDate": "2020-11-20T00:30:40Z", "type": "commit"}]}