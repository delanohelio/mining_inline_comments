{"pr_number": 1796, "pr_title": "Don't use ConfigUtils outside of AgentTestRunner tests", "pr_createdAt": "2020-11-29T19:33:38Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1796", "timeline": [{"oid": "143031243d9e6c372e6bb82f29e6b9730e6bbc91", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/143031243d9e6c372e6bb82f29e6b9730e6bbc91", "message": "NetPeerUtilsTest", "committedDate": "2020-11-29T19:21:53Z", "type": "commit"}, {"oid": "ca4e3b4d8b8cdc8df4b76a2f2fc4ebc4efb34ad7", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/ca4e3b4d8b8cdc8df4b76a2f2fc4ebc4efb34ad7", "message": "RedisCommandNormalizerTest", "committedDate": "2020-11-29T19:21:53Z", "type": "commit"}, {"oid": "df7346241f80dbd983bad7535343103e022edff5", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/df7346241f80dbd983bad7535343103e022edff5", "message": "InstrumentationModuleTest", "committedDate": "2020-11-29T19:21:53Z", "type": "commit"}, {"oid": "ea23fbbd5126312c5cb7ed1b87dc0f759073e41b", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/ea23fbbd5126312c5cb7ed1b87dc0f759073e41b", "message": "HttpClientTracerTest", "committedDate": "2020-11-29T19:21:53Z", "type": "commit"}, {"oid": "5c9083cd51b10416ae687b4c69aa4621db4a61cc", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/5c9083cd51b10416ae687b4c69aa4621db4a61cc", "message": "Normalize test config properties", "committedDate": "2020-11-29T20:48:12Z", "type": "commit"}, {"oid": "f063af5bb7bcb66fda50dc5e263aa91b47cf3803", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/f063af5bb7bcb66fda50dc5e263aa91b47cf3803", "message": "fixup! Normalize test config properties", "committedDate": "2020-11-29T23:23:38Z", "type": "commit"}, {"oid": "34fdc7317c5b7b3e8b65a9b9f02a835ba945f3b8", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/34fdc7317c5b7b3e8b65a9b9f02a835ba945f3b8", "message": "Remove left behind printlns", "committedDate": "2020-11-29T23:26:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjMyNzUyNg==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1796#discussion_r532327526", "bodyText": "A bit obtuse name - maybe create with some javadoc is ok?", "author": "anuraaga", "createdAt": "2020-11-30T03:19:57Z", "path": "instrumentation-api/src/main/java/io/opentelemetry/instrumentation/api/config/Config.java", "diffHunk": "@@ -46,10 +47,17 @@ public static Config get() {\n     return INSTANCE;\n   }\n \n-  public static Config create(Map<String, String> allProperties) {\n+  public static Config createFromAlreadyNormalized(Map<String, String> allProperties) {", "originalCommit": "34fdc7317c5b7b3e8b65a9b9f02a835ba945f3b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjM1MDU0OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1796#discussion_r532350549", "bodyText": "ya, reworked it, moved AgentConfigBuilder to this module (renamed now as ConfigBuilder) so that tests can use it", "author": "trask", "createdAt": "2020-11-30T05:08:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjMyNzUyNg=="}], "type": "inlineReview", "revised_code": {"commit": "ffeef17c9acf072bde422ca08d6007b0c1a01a90", "chunk": "diff --git a/instrumentation-api/src/main/java/io/opentelemetry/instrumentation/api/config/Config.java b/instrumentation-api/src/main/java/io/opentelemetry/instrumentation/api/config/Config.java\nindex 94842669cb..fc2e603340 100644\n--- a/instrumentation-api/src/main/java/io/opentelemetry/instrumentation/api/config/Config.java\n+++ b/instrumentation-api/src/main/java/io/opentelemetry/instrumentation/api/config/Config.java\n\n@@ -47,17 +44,10 @@ public abstract class Config {\n     return INSTANCE;\n   }\n \n-  public static Config createFromAlreadyNormalized(Map<String, String> allProperties) {\n+  public static Config create(Map<String, String> allProperties) {\n     return new AutoValue_Config(allProperties);\n   }\n \n-  // only used by tests\n-  static Config create(Map<String, String> allProperties) {\n-    Map<String, String> normalized = new HashMap<>(allProperties.size());\n-    allProperties.forEach((key, value) -> normalized.put(normalizePropertyName(key), value));\n-    return createFromAlreadyNormalized(normalized);\n-  }\n-\n   abstract Map<String, String> getAllProperties();\n \n   /**\n"}}, {"oid": "ffeef17c9acf072bde422ca08d6007b0c1a01a90", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/ffeef17c9acf072bde422ca08d6007b0c1a01a90", "message": "Create ConfigBuilder in instrumentation-api", "committedDate": "2020-11-30T04:30:07Z", "type": "commit"}, {"oid": "72d72a7cbe5409608e00f74adcf7e209cd9d146c", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/72d72a7cbe5409608e00f74adcf7e209cd9d146c", "message": "Comment", "committedDate": "2020-11-30T04:40:47Z", "type": "commit"}, {"oid": "521b8c5a78e89497717fd7bb88e7ad7ddc0a101e", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/521b8c5a78e89497717fd7bb88e7ad7ddc0a101e", "message": "Fix test", "committedDate": "2020-12-01T20:00:33Z", "type": "commit"}, {"oid": "aa27e0242e806e8ca08195753d4c6f1c00aef1d5", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/aa27e0242e806e8ca08195753d4c6f1c00aef1d5", "message": "Keep config properties compatible with SDK", "committedDate": "2020-12-01T23:59:57Z", "type": "commit"}]}