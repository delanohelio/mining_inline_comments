{"pr_number": 561, "pr_title": "CLDR-13954 Make sure child SEED locales are included.", "pr_createdAt": "2020-07-13T22:02:23Z", "pr_url": "https://github.com/unicode-org/cldr/pull/561", "timeline": [{"oid": "863bb624af867203f55d5489a4d9c750d94636fd", "url": "https://github.com/unicode-org/cldr/commit/863bb624af867203f55d5489a4d9c750d94636fd", "message": "CLDR-13954 Make sure child SEED locales are included.", "committedDate": "2020-07-13T22:01:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzk3MzcyOA==", "url": "https://github.com/unicode-org/cldr/pull/561#discussion_r453973728", "bodyText": "Sets.difference(es.getRawExtraPaths(), es_US.getRawExtraPaths()) perhaps?\nIt's use the ordering of the first set, so maybe not ordered the same.", "author": "hagbard", "createdAt": "2020-07-13T22:17:22Z", "path": "tools/cldr-unittest/src/org/unicode/cldr/unittest/TestCLDRFile.java", "diffHunk": "@@ -844,4 +844,13 @@ public void TestExtraPaths() {\n         assertTrue(\"Should be empty\", missing.isEmpty());\n     }\n \n+    public void TestExtraPaths13954() {\n+        CLDRFile es = cldrFactory.make(\"es\", true);\n+        CLDRFile es_US = cldrFactory.make(\"es_US\", true);\n+        if (!es_US.getRawExtraPaths().containsAll(es.getRawExtraPaths())) {\n+            TreeSet<String> missing = new TreeSet<>(es.getRawExtraPaths());", "originalCommit": "863bb624af867203f55d5489a4d9c750d94636fd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9625f13d38fbf91ed75aa038d6827f9c2f80126f", "chunk": "diff --git a/tools/cldr-unittest/src/org/unicode/cldr/unittest/TestCLDRFile.java b/tools/cldr-unittest/src/org/unicode/cldr/unittest/TestCLDRFile.java\nindex a99f325ba1..9137bf2e88 100644\n--- a/tools/cldr-unittest/src/org/unicode/cldr/unittest/TestCLDRFile.java\n+++ b/tools/cldr-unittest/src/org/unicode/cldr/unittest/TestCLDRFile.java\n\n@@ -848,9 +849,7 @@ public class TestCLDRFile extends TestFmwk {\n         CLDRFile es = cldrFactory.make(\"es\", true);\n         CLDRFile es_US = cldrFactory.make(\"es_US\", true);\n         if (!es_US.getRawExtraPaths().containsAll(es.getRawExtraPaths())) {\n-            TreeSet<String> missing = new TreeSet<>(es.getRawExtraPaths());\n-            missing.removeAll(es_US.getRawExtraPaths());\n-            errln(\"Failure: \" + Joiner.on('\\n').join(missing));\n+            errln(\"Failure: \" + Joiner.on('\\n').join(Sets.difference(es.getRawExtraPaths(), es_US.getRawExtraPaths())));\n         }\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzk3NDkwOQ==", "url": "https://github.com/unicode-org/cldr/pull/561#discussion_r453974909", "bodyText": "Maybe use an enum over a boolean here (readability).\nsupplementalData.getGrammarInfo(cldrFile.getLocaleID(), ALL_LOCALES)\nseems to read better than:\nsupplementalData.getGrammarInfo(cldrFile.getLocaleID(), false)", "author": "hagbard", "createdAt": "2020-07-13T22:18:57Z", "path": "tools/java/org/unicode/cldr/util/SupplementalDataInfo.java", "diffHunk": "@@ -4494,14 +4494,17 @@ public UnitPreferences getUnitPreferences() {\n \n     /**\n      * Grammar info for locales, with inheritance\n+     * @param seedOnly TODO\n      */\n-    public GrammarInfo getGrammarInfo(String locale) {\n-        while (locale != null) {\n+    public GrammarInfo getGrammarInfo(String locale, boolean seedOnly) {", "originalCommit": "863bb624af867203f55d5489a4d9c750d94636fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAyMTc0Mw==", "url": "https://github.com/unicode-org/cldr/pull/561#discussion_r454021743", "bodyText": "This is temporary, since we'll be removing SEED next release. Did make a few other changes for simplicity", "author": "macchiati", "createdAt": "2020-07-14T00:17:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzk3NDkwOQ=="}], "type": "inlineReview", "revised_code": {"commit": "9625f13d38fbf91ed75aa038d6827f9c2f80126f", "chunk": "diff --git a/tools/java/org/unicode/cldr/util/SupplementalDataInfo.java b/tools/java/org/unicode/cldr/util/SupplementalDataInfo.java\nindex cececf256d..6bdad9578f 100644\n--- a/tools/java/org/unicode/cldr/util/SupplementalDataInfo.java\n+++ b/tools/java/org/unicode/cldr/util/SupplementalDataInfo.java\n\n@@ -4494,8 +4494,20 @@ public class SupplementalDataInfo {\n \n     /**\n      * Grammar info for locales, with inheritance\n-     * @param seedOnly TODO\n+     * @param seedOnly\n+     * @return\n+     */\n+    public GrammarInfo getGrammarInfo(String locale) {\n+        return getGrammarInfo(locale, false);\n+    }\n+\n+    /**\n+     * Special hack for v38; should drop seedOnly later.\n+     * @param locale\n+     * @param seedOnly\n+     * @return\n      */\n+    @Deprecated\n     public GrammarInfo getGrammarInfo(String locale, boolean seedOnly) {\n         for (;locale != null; locale = LocaleIDParser.getParent(locale)) {\n             if (seedOnly && !GrammarInfo.SEED_LOCALES.contains(locale)) {\n"}}, {"oid": "9625f13d38fbf91ed75aa038d6827f9c2f80126f", "url": "https://github.com/unicode-org/cldr/commit/9625f13d38fbf91ed75aa038d6827f9c2f80126f", "message": "CLDR-13954 clean up code a bit.", "committedDate": "2020-07-14T00:15:53Z", "type": "commit"}]}