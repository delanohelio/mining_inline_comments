{"pr_number": 838, "pr_title": "CLDR-14268 improve vetting participation page", "pr_createdAt": "2020-11-11T00:33:15Z", "pr_url": "https://github.com/unicode-org/cldr/pull/838", "timeline": [{"oid": "41c885dc2abd6efc34857c12b8161b6137db4df1", "url": "https://github.com/unicode-org/cldr/commit/41c885dc2abd6efc34857c12b8161b6137db4df1", "message": "CLDR-14268 improve vetting participation page\n\n- major rewrite of 'vetting participation' to a speedy query + new UI (non JSP)\n- also fix Utilka CLDR-6320\n- also cleanup a leaking Statement from UserRegistry", "committedDate": "2020-11-11T15:03:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ1ODk3NQ==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521458975", "bodyText": "getJson is over 100 lines, way more than one screenful -- shorter methods with subroutines are more maintainable", "author": "btangmu", "createdAt": "2020-11-11T15:58:17Z", "path": "tools/cldr-apps/src/main/java/org/unicode/cldr/web/SurveyVettingParticipation.java", "diffHunk": "@@ -0,0 +1,175 @@\n+package org.unicode.cldr.web;\n+\n+import java.sql.Connection;\n+import java.sql.PreparedStatement;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+import java.util.HashSet;\n+import java.util.Hashtable;\n+import java.util.Iterator;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.TreeMap;\n+import java.util.TreeSet;\n+\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+import org.unicode.cldr.util.CLDRLocale;\n+import org.unicode.cldr.util.StandardCodes;\n+import org.unicode.cldr.util.VoteResolver;\n+import org.unicode.cldr.web.SurveyAjax.JSONWriter;\n+import org.unicode.cldr.web.UserRegistry.User;\n+\n+\n+public class SurveyVettingParticipation {\n+    static final int STREET_STLEVEL = VoteResolver.Level.street.getSTLevel();\n+\n+    final private String org;\n+    final String missingLocalesForOrg;\n+    private SurveyMain sm;\n+    boolean showCodes = false;\n+\n+    public SurveyVettingParticipation(String org, SurveyMain sm) {\n+        this.sm = sm;\n+        this.org = org;\n+        this.missingLocalesForOrg = org; // TODO\n+    }\n+\n+    public void getJson(JSONWriter r) throws SQLException, JSONException {\n+       final StandardCodes sc = StandardCodes.make();", "originalCommit": "41c885dc2abd6efc34857c12b8161b6137db4df1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU3MzcyMA==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521573720", "bodyText": "done", "author": "srl295", "createdAt": "2020-11-11T19:00:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ1ODk3NQ=="}], "type": "inlineReview", "revised_code": {"commit": "5a53e2d2d5baa1e4cad4ef0e452edc25d49f0058", "chunk": "diff --git a/tools/cldr-apps/src/main/java/org/unicode/cldr/web/SurveyVettingParticipation.java b/tools/cldr-apps/src/main/java/org/unicode/cldr/web/SurveyVettingParticipation.java\nindex 8b76809a79..bce438b179 100644\n--- a/tools/cldr-apps/src/main/java/org/unicode/cldr/web/SurveyVettingParticipation.java\n+++ b/tools/cldr-apps/src/main/java/org/unicode/cldr/web/SurveyVettingParticipation.java\n\n@@ -98,7 +98,9 @@ public class SurveyVettingParticipation {\n                int theirId = rsu.getInt(\"id\");\n                final User theUser = sm.reg.getInfo(theirId);\n \n-               if((theUser.userlevel > STREET_STLEVEL) || UserRegistry.userIsLocked(theUser)) {\n+               if((theUser.userlevel > STREET_STLEVEL) ||\n+                   UserRegistry.userIsLocked(theUser)          // skip these\n+                   ) {\n                    continue;\n                }\n                final JSONObject json = JSONWriter.wrap(theUser);\n"}}, {"oid": "5a53e2d2d5baa1e4cad4ef0e452edc25d49f0058", "url": "https://github.com/unicode-org/cldr/commit/5a53e2d2d5baa1e4cad4ef0e452edc25d49f0058", "message": "CLDR-14268 improve vetting participation page\n\n- major rewrite of 'vetting participation' to a speedy query + new UI (non JSP)\n- also fix Utilka CLDR-6320\n- also cleanup a leaking Statement from UserRegistry", "committedDate": "2020-11-11T18:59:57Z", "type": "forcePushed"}, {"oid": "b19105ad0d1b09506f6e6a8cd4f592e83b9b21b2", "url": "https://github.com/unicode-org/cldr/commit/b19105ad0d1b09506f6e6a8cd4f592e83b9b21b2", "message": "CLDR-14268 improve vetting participation page\n\n- major rewrite of 'vetting participation' to a speedy query + new UI (non JSP)\n- also fix Utilka CLDR-6320\n- also cleanup a leaking Statement from UserRegistry", "committedDate": "2020-11-11T20:48:52Z", "type": "commit"}, {"oid": "b19105ad0d1b09506f6e6a8cd4f592e83b9b21b2", "url": "https://github.com/unicode-org/cldr/commit/b19105ad0d1b09506f6e6a8cd4f592e83b9b21b2", "message": "CLDR-14268 improve vetting participation page\n\n- major rewrite of 'vetting participation' to a speedy query + new UI (non JSP)\n- also fix Utilka CLDR-6320\n- also cleanup a leaking Statement from UserRegistry", "committedDate": "2020-11-11T20:48:52Z", "type": "forcePushed"}]}