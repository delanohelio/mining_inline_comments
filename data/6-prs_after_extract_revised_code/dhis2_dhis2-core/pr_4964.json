{"pr_number": 4964, "pr_title": "feat: Apply new audit services for Tracker", "pr_createdAt": "2020-02-27T07:45:58Z", "pr_url": "https://github.com/dhis2/dhis2-core/pull/4964", "timeline": [{"oid": "ff2e3ec3dd347b191c2195124f20200a8d30ab6a", "url": "https://github.com/dhis2/dhis2-core/commit/ff2e3ec3dd347b191c2195124f20200a8d30ab6a", "message": "Use hibernate post commit event listener", "committedDate": "2020-02-27T07:44:53Z", "type": "commit"}, {"oid": "dc05829b96c08d7e892239133f7bb71f2eeed534", "url": "https://github.com/dhis2/dhis2-core/commit/dc05829b96c08d7e892239133f7bb71f2eeed534", "message": "fix lazy load exception in AuditManager", "committedDate": "2020-02-27T08:59:32Z", "type": "commit"}, {"oid": "1b9a4e5c6b5393ab2dca3a7044dc916c650d30d6", "url": "https://github.com/dhis2/dhis2-core/commit/1b9a4e5c6b5393ab2dca3a7044dc916c650d30d6", "message": "Fix lazy load exception for TrackedEntityAttributeValue", "committedDate": "2020-02-27T10:37:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1MzA0Nw==", "url": "https://github.com/dhis2/dhis2-core/pull/4964#discussion_r385053047", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.warn( \"onPostUpdateCommitFailed: \"+ event );\n          \n          \n            \n                    log.warn( \"onPostUpdateCommitFailed: \" + event );", "author": "stian-sandvold", "createdAt": "2020-02-27T10:54:52Z", "path": "dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostUpdateAuditListener.java", "diffHunk": "@@ -81,6 +83,12 @@ public void onPostUpdate( PostUpdateEvent postUpdateEvent )\n     @Override\n     public boolean requiresPostCommitHanding( EntityPersister entityPersister )\n     {\n-        return false;\n+        return true;\n+    }\n+\n+    @Override\n+    public void onPostUpdateCommitFailed( PostUpdateEvent event )\n+    {\n+        log.warn( \"onPostUpdateCommitFailed: \"+ event );", "originalCommit": "1b9a4e5c6b5393ab2dca3a7044dc916c650d30d6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4db44827016dcf19f8bd0e5b97756193f4e085f3", "chunk": "diff --git a/dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostUpdateAuditListener.java b/dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostUpdateAuditListener.java\nindex d649a89e16..575d77700d 100644\n--- a/dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostUpdateAuditListener.java\n+++ b/dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostUpdateAuditListener.java\n\n@@ -89,6 +89,6 @@ public class PostUpdateAuditListener\n     @Override\n     public void onPostUpdateCommitFailed( PostUpdateEvent event )\n     {\n-        log.warn( \"onPostUpdateCommitFailed: \"+ event );\n+        log.warn( \"onPostUpdateCommitFailed: \" + event );\n     }\n }\n"}}, {"oid": "4db44827016dcf19f8bd0e5b97756193f4e085f3", "url": "https://github.com/dhis2/dhis2-core/commit/4db44827016dcf19f8bd0e5b97756193f4e085f3", "message": "Update dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostUpdateAuditListener.java", "committedDate": "2020-02-27T10:54:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1MzI1Nw==", "url": "https://github.com/dhis2/dhis2-core/pull/4964#discussion_r385053257", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.warn( \"onPostInsertCommitFailed: \"+ event );\n          \n          \n            \n                    log.warn( \"onPostInsertCommitFailed: \" + event );", "author": "stian-sandvold", "createdAt": "2020-02-27T10:55:17Z", "path": "dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostInsertAuditListener.java", "diffHunk": "@@ -80,6 +81,12 @@ public void onPostInsert( PostInsertEvent postInsertEvent )\n     @Override\n     public boolean requiresPostCommitHanding( EntityPersister entityPersister )\n     {\n-        return false;\n+        return true;\n+    }\n+\n+    @Override\n+    public void onPostInsertCommitFailed( PostInsertEvent event )\n+    {\n+        log.warn( \"onPostInsertCommitFailed: \"+ event );", "originalCommit": "4db44827016dcf19f8bd0e5b97756193f4e085f3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "57038a29240f930f2f298b7da5b70d5e6af0818c", "chunk": "diff --git a/dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostInsertAuditListener.java b/dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostInsertAuditListener.java\nindex 2b753abb1b..492b9b55cb 100644\n--- a/dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostInsertAuditListener.java\n+++ b/dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostInsertAuditListener.java\n\n@@ -87,6 +87,6 @@ public class PostInsertAuditListener\n     @Override\n     public void onPostInsertCommitFailed( PostInsertEvent event )\n     {\n-        log.warn( \"onPostInsertCommitFailed: \"+ event );\n+        log.warn( \"onPostInsertCommitFailed: \" + event );\n     }\n }\n"}}, {"oid": "57038a29240f930f2f298b7da5b70d5e6af0818c", "url": "https://github.com/dhis2/dhis2-core/commit/57038a29240f930f2f298b7da5b70d5e6af0818c", "message": "Update dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostInsertAuditListener.java", "committedDate": "2020-02-27T10:55:26Z", "type": "commit"}]}