{"pr_number": 1073, "pr_title": "Clean up to tool-attributes, add annotations and add test for custom \u2026", "pr_createdAt": "2020-09-11T03:12:02Z", "pr_url": "https://github.com/FabricMC/fabric/pull/1073", "timeline": [{"oid": "e547826ca035eb84fa23a7937fb0e76d7fd528bf", "url": "https://github.com/FabricMC/fabric/commit/e547826ca035eb84fa23a7937fb0e76d7fd528bf", "message": "Clean up to tool-attributes, add annotations and add test for custom tool types.\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T03:08:36Z", "type": "commit"}, {"oid": "cd1f96a487708f8635cc5d8f4089b1f206692875", "url": "https://github.com/FabricMC/fabric/commit/cd1f96a487708f8635cc5d8f4089b1f206692875", "message": "Change version to 1.2.3\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T03:12:34Z", "type": "commit"}, {"oid": "a9482427aef02905ba088e2723714cca7750ebcb", "url": "https://github.com/FabricMC/fabric/commit/a9482427aef02905ba088e2723714cca7750ebcb", "message": "remove unrelated change\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T03:13:23Z", "type": "commit"}, {"oid": "eba9da1ad8906a14d5189f97f0ce1ff5cef3a330", "url": "https://github.com/FabricMC/fabric/commit/eba9da1ad8906a14d5189f97f0ce1ff5cef3a330", "message": "Turn build.gradle to tabs\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T03:26:55Z", "type": "commit"}, {"oid": "6fad981c15e29dd5bf573f8816f5542406a375f9", "url": "https://github.com/FabricMC/fabric/commit/6fad981c15e29dd5bf573f8816f5542406a375f9", "message": "Fix checkstyle\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-09-11T03:59:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzE1NjI2NQ==", "url": "https://github.com/FabricMC/fabric/pull/1073#discussion_r487156265", "bodyText": "General question: Do we want this on all internal classes?\nIf so would some way to enforce it for the whole of fabric api be a good idea?", "author": "modmuss50", "createdAt": "2020-09-11T16:28:38Z", "path": "fabric-tool-attribute-api-v1/src/main/java/net/fabricmc/fabric/impl/tool/attribute/AttributeManager.java", "diffHunk": "@@ -23,10 +23,12 @@\n \n import com.google.common.collect.HashMultimap;\n import com.google.common.collect.Multimap;\n+import org.jetbrains.annotations.ApiStatus;\n \n import net.minecraft.entity.attribute.EntityAttribute;\n import net.minecraft.entity.attribute.EntityAttributeModifier;\n \n+@ApiStatus.Internal", "originalCommit": "6fad981c15e29dd5bf573f8816f5542406a375f9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzE1OTEwMQ==", "url": "https://github.com/FabricMC/fabric/pull/1073#discussion_r487159101", "bodyText": "This could be applied via package info I assume", "author": "shedaniel", "createdAt": "2020-09-11T16:34:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzE1NjI2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzE2MDI5NA==", "url": "https://github.com/FabricMC/fabric/pull/1073#discussion_r487160294", "bodyText": "Yes, that would be better.", "author": "modmuss50", "createdAt": "2020-09-11T16:36:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzE1NjI2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQzMjMwNg==", "url": "https://github.com/FabricMC/fabric/pull/1073#discussion_r500432306", "bodyText": "Fixed.", "author": "shedaniel", "createdAt": "2020-10-06T16:24:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzE1NjI2NQ=="}], "type": "inlineReview", "revised_code": {"commit": "f2d55126f71f02e9a6ca54e0712fe491bb3928a1", "chunk": "diff --git a/fabric-tool-attribute-api-v1/src/main/java/net/fabricmc/fabric/impl/tool/attribute/AttributeManager.java b/fabric-tool-attribute-api-v1/src/main/java/net/fabricmc/fabric/impl/tool/attribute/AttributeManager.java\nindex 175f3de3..8ccbba5e 100644\n--- a/fabric-tool-attribute-api-v1/src/main/java/net/fabricmc/fabric/impl/tool/attribute/AttributeManager.java\n+++ b/fabric-tool-attribute-api-v1/src/main/java/net/fabricmc/fabric/impl/tool/attribute/AttributeManager.java\n\n@@ -23,12 +23,10 @@ import java.util.Set;\n \n import com.google.common.collect.HashMultimap;\n import com.google.common.collect.Multimap;\n-import org.jetbrains.annotations.ApiStatus;\n \n import net.minecraft.entity.attribute.EntityAttribute;\n import net.minecraft.entity.attribute.EntityAttributeModifier;\n \n-@ApiStatus.Internal\n public final class AttributeManager {\n \tprivate AttributeManager() { }\n \n"}}, {"oid": "81c1b43362e592ec30a1247ff87da8ebb7c5c118", "url": "https://github.com/FabricMC/fabric/commit/81c1b43362e592ec30a1247ff87da8ebb7c5c118", "message": "Merge remote-tracking branch 'fabric/1.16' into custom_tool_tags\n\n# Conflicts:\n#\tfabric-tool-attribute-api-v1/src/main/java/net/fabricmc/fabric/impl/tool/attribute/ToolManagerImpl.java", "committedDate": "2020-10-06T16:16:44Z", "type": "commit"}, {"oid": "f2d55126f71f02e9a6ca54e0712fe491bb3928a1", "url": "https://github.com/FabricMC/fabric/commit/f2d55126f71f02e9a6ca54e0712fe491bb3928a1", "message": "Fix some review issues\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-10-06T16:19:54Z", "type": "commit"}, {"oid": "e574833471a1a4f79087dc1bd721c1766c344e9e", "url": "https://github.com/FabricMC/fabric/commit/e574833471a1a4f79087dc1bd721c1766c344e9e", "message": "Add license to package-info.java\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-10-06T16:30:07Z", "type": "commit"}, {"oid": "6170c708156c6193e9bb753c369aeb346979a04c", "url": "https://github.com/FabricMC/fabric/commit/6170c708156c6193e9bb753c369aeb346979a04c", "message": "Remove line between the javadoc and the package line\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-10-06T16:37:00Z", "type": "commit"}, {"oid": "2496f3f50b4583b090cf6d3ce4a097ac9e23655f", "url": "https://github.com/FabricMC/fabric/commit/2496f3f50b4583b090cf6d3ce4a097ac9e23655f", "message": "Move the @NotNull annotation\n\nSigned-off-by: shedaniel <daniel@shedaniel.me>", "committedDate": "2020-10-06T16:39:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ4MDgzMQ==", "url": "https://github.com/FabricMC/fabric/pull/1073#discussion_r500480831", "bodyText": "Is there a reason the tag check is dropped here?", "author": "i509VCB", "createdAt": "2020-10-06T17:41:39Z", "path": "fabric-tool-attribute-api-v1/src/main/java/net/fabricmc/fabric/impl/tool/attribute/handlers/VanillaToolsModdedBlocksToolHandler.java", "diffHunk": "@@ -51,12 +54,13 @@ public ActionResult isEffectiveOn(Tag<Item> tag, BlockState state, ItemStack sta\n \t\treturn ActionResult.PASS;\n \t}\n \n+\t@NotNull\n \t@Override\n \tpublic TypedActionResult<Float> getMiningSpeedMultiplier(Tag<Item> tag, BlockState state, ItemStack stack, LivingEntity user) {\n \t\tif (!(stack.getItem() instanceof DynamicAttributeTool)) {\n \t\t\tToolManagerImpl.Entry entry = ToolManagerImpl.entryNullable(state.getBlock());\n \n-\t\t\tif (entry != null && entry.getMiningLevel(tag) >= 0 && tag.contains(stack.getItem())) {\n+\t\t\tif (entry != null && entry.getMiningLevel(tag) >= 0) {", "originalCommit": "2496f3f50b4583b090cf6d3ce4a097ac9e23655f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ4NDI3Mw==", "url": "https://github.com/FabricMC/fabric/pull/1073#discussion_r500484273", "bodyText": "Mentioned in the first message", "author": "shedaniel", "createdAt": "2020-10-06T17:47:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ4MDgzMQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ4MTUyNg==", "url": "https://github.com/FabricMC/fabric/pull/1073#discussion_r500481526", "bodyText": "Was there a reason this was null?", "author": "i509VCB", "createdAt": "2020-10-06T17:42:52Z", "path": "fabric-tool-attribute-api-v1/src/main/java/net/fabricmc/fabric/impl/tool/attribute/ToolManagerImpl.java", "diffHunk": "@@ -253,8 +258,9 @@ default ActionResult isEffectiveOn(Tag<Item> tag, BlockState state, ItemStack st\n \t\t * @param user  the user involved in breaking the block, null if not applicable.\n \t\t * @return the result of mining speed.\n \t\t */\n+\t\t@NotNull\n \t\tdefault TypedActionResult<Float> getMiningSpeedMultiplier(Tag<Item> tag, BlockState state, ItemStack stack, @Nullable LivingEntity user) {\n-\t\t\treturn null;\n+\t\t\treturn TypedActionResult.pass(1.0F);", "originalCommit": "2496f3f50b4583b090cf6d3ce4a097ac9e23655f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ4NDE0OQ==", "url": "https://github.com/FabricMC/fabric/pull/1073#discussion_r500484149", "bodyText": "There is actually an Objects#requireNonNull check originally anyways, this was just a wrong default value.", "author": "shedaniel", "createdAt": "2020-10-06T17:47:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ4MTUyNg=="}], "type": "inlineReview", "revised_code": null}]}