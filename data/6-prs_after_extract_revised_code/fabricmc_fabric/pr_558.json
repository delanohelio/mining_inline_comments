{"pr_number": 558, "pr_title": "fabric-climbable-api-v1 - Re-implementing minecraft:climbable on 1.15", "pr_createdAt": "2020-04-08T02:24:23Z", "pr_url": "https://github.com/FabricMC/fabric/pull/558", "timeline": [{"oid": "892b077795de00877fbbbe4493e68e03eaddcb8e", "url": "https://github.com/FabricMC/fabric/commit/892b077795de00877fbbbe4493e68e03eaddcb8e", "message": "Reimplement 1.16's minecraft:climbable tag in 1.15 as fabric-climbable-api-v1", "committedDate": "2020-04-08T02:13:05Z", "type": "commit"}, {"oid": "49782c3037455b6488b56783c30088cfa10cfbdf", "url": "https://github.com/FabricMC/fabric/commit/49782c3037455b6488b56783c30088cfa10cfbdf", "message": "Add license headers + fix non-package name checkstyle violations", "committedDate": "2020-04-08T03:08:04Z", "type": "commit"}, {"oid": "61163d4a34d5aec3c342927176b7b76d547198c1", "url": "https://github.com/FabricMC/fabric/commit/61163d4a34d5aec3c342927176b7b76d547198c1", "message": "Fix package checkstyle violations", "committedDate": "2020-04-08T19:10:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg2MTU3Nw==", "url": "https://github.com/FabricMC/fabric/pull/558#discussion_r405861577", "bodyText": "Why not capture the blockState local var, to save an extra blockstate lookup.", "author": "modmuss50", "createdAt": "2020-04-08T22:57:05Z", "path": "fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/mixin/climbable/MixinLivingEntity.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.climbable;\n+\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.Shadow;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.entity.Entity;\n+import net.minecraft.entity.EntityType;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.climbable.v1.FabricClimbableTags;\n+\n+@Mixin(LivingEntity.class)\n+public abstract class MixinLivingEntity extends Entity {\n+\tpublic MixinLivingEntity(EntityType<?> type, World world) {\n+\t\tsuper(type, world);\n+\t}\n+\n+\t@Shadow\n+\tpublic abstract BlockState getBlockState();\n+\n+\t@Inject(method = \"isClimbing\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/LivingEntity;getBlockState()Lnet/minecraft/block/BlockState;\"), cancellable = true)\n+\tpublic void onIsClimbing(CallbackInfoReturnable<Boolean> info) {\n+\t\tif (this.getBlockState().matches(FabricClimbableTags.CLIMBABLE)) {", "originalCommit": "61163d4a34d5aec3c342927176b7b76d547198c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg2MjY1Nw==", "url": "https://github.com/FabricMC/fabric/pull/558#discussion_r405862657", "bodyText": "is that an issue? I figured a more stable mixin would be the better move but I can switch it if you wish", "author": "Prospector", "createdAt": "2020-04-08T23:00:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg2MTU3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg2MzE2MQ==", "url": "https://github.com/FabricMC/fabric/pull/558#discussion_r405863161", "bodyText": "Its not getting pulled forward, so stablity is guaranteed.", "author": "modmuss50", "createdAt": "2020-04-08T23:01:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg2MTU3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "73b6e5607b3a9a188436641c8c7cafafef57b49b", "chunk": "diff --git a/fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/mixin/climbable/MixinLivingEntity.java b/fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/mixin/climbable/MixinLivingEntity.java\nindex 8cb97fd6..7099efc5 100644\n--- a/fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/mixin/climbable/MixinLivingEntity.java\n+++ b/fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/mixin/climbable/MixinLivingEntity.java\n\n@@ -16,19 +16,17 @@\n \n package net.fabricmc.fabric.mixin.climbable;\n \n-import org.spongepowered.asm.mixin.Mixin;\n-import org.spongepowered.asm.mixin.Shadow;\n-import org.spongepowered.asm.mixin.injection.At;\n-import org.spongepowered.asm.mixin.injection.Inject;\n-import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n-\n+import net.fabricmc.fabric.impl.climbable.FabricClimbableImpl;\n import net.minecraft.block.BlockState;\n import net.minecraft.entity.Entity;\n import net.minecraft.entity.EntityType;\n import net.minecraft.entity.LivingEntity;\n import net.minecraft.world.World;\n-\n-import net.fabricmc.fabric.api.climbable.v1.FabricClimbableTags;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n+import org.spongepowered.asm.mixin.injection.callback.LocalCapture;\n \n @Mixin(LivingEntity.class)\n public abstract class MixinLivingEntity extends Entity {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg2MTg2NQ==", "url": "https://github.com/FabricMC/fabric/pull/558#discussion_r405861865", "bodyText": "Does this really need to be exposed as an API?\nI dont think it does, esp since its being removed in 1.16?", "author": "modmuss50", "createdAt": "2020-04-08T22:57:53Z", "path": "fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/api/climbable/v1/FabricClimbableTags.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.climbable.v1;", "originalCommit": "61163d4a34d5aec3c342927176b7b76d547198c1", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "73b6e5607b3a9a188436641c8c7cafafef57b49b", "chunk": "diff --git a/fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/api/climbable/v1/FabricClimbableTags.java b/fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/impl/climbable/FabricClimbableImpl.java\nsimilarity index 88%\nrename from fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/api/climbable/v1/FabricClimbableTags.java\nrename to fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/impl/climbable/FabricClimbableImpl.java\nindex 8f275e03..693da3a3 100644\n--- a/fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/api/climbable/v1/FabricClimbableTags.java\n+++ b/fabric-climbable-api-v1/src/main/java/net/fabricmc/fabric/impl/climbable/FabricClimbableImpl.java\n\n@@ -14,7 +14,7 @@\n  * limitations under the License.\n  */\n \n-package net.fabricmc.fabric.api.climbable.v1;\n+package net.fabricmc.fabric.impl.climbable;\n \n import net.minecraft.block.Block;\n import net.minecraft.tag.Tag;\n"}}, {"oid": "73b6e5607b3a9a188436641c8c7cafafef57b49b", "url": "https://github.com/FabricMC/fabric/commit/73b6e5607b3a9a188436641c8c7cafafef57b49b", "message": "Remove API since it won't be ported to 1.16 and move to local capture", "committedDate": "2020-04-09T00:10:50Z", "type": "commit"}, {"oid": "df3902189fca3f834032df369fdcd3fd75e45be9", "url": "https://github.com/FabricMC/fabric/commit/df3902189fca3f834032df369fdcd3fd75e45be9", "message": "Merge branch '1.15' into feature/climbable-api-v1", "committedDate": "2020-04-22T04:28:48Z", "type": "commit"}, {"oid": "3a0f1ac951834344983a4f3ece0053a47449f349", "url": "https://github.com/FabricMC/fabric/commit/3a0f1ac951834344983a4f3ece0053a47449f349", "message": "Bump version", "committedDate": "2020-04-22T08:38:54Z", "type": "commit"}, {"oid": "05c74427594165f75f7513e07bd81e5e8e12b233", "url": "https://github.com/FabricMC/fabric/commit/05c74427594165f75f7513e07bd81e5e8e12b233", "message": "Merge branch '1.15' into feature/climbable-api-v1", "committedDate": "2020-04-22T08:39:33Z", "type": "commit"}]}