{"pr_number": 980, "pr_title": "Block break event", "pr_createdAt": "2020-08-01T04:44:59Z", "pr_url": "https://github.com/FabricMC/fabric/pull/980", "timeline": [{"oid": "d0ecebb524346cdf3b7dd5068f3aa63968fda813", "url": "https://github.com/FabricMC/fabric/commit/d0ecebb524346cdf3b7dd5068f3aa63968fda813", "message": "Block break event", "committedDate": "2020-08-01T04:44:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkyMTkwMQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463921901", "bodyText": "Imo we also need a After event so mods can react to the block being broken if it occurs.\nSo this would probably become a Before event\nEDIT: The after event should not be cancellable.", "author": "i509VCB", "createdAt": "2020-08-01T04:47:03Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BreakBlockCallback.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.Hand;\n+import net.minecraft.util.hit.BlockHitResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n+\n+/**\n+ * Callback for when a block is broken.\n+ * Only called on the server, however updates are synced with the client.\n+ *\n+ * <p>Upon return:\n+ * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+ * <li>FAIL cancels the block breaking action\n+ */\n+public interface BreakBlockCallback {\n+\tEvent<BreakBlockCallback> EVENT = EventFactory.createArrayBacked(BreakBlockCallback.class,", "originalCommit": "d0ecebb524346cdf3b7dd5068f3aa63968fda813", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkyMjE4Ng==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463922186", "bodyText": "I'll add that", "author": "Geometrically", "createdAt": "2020-08-01T04:49:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkyMTkwMQ=="}], "type": "inlineReview", "revised_code": {"commit": "38554143290eb2761b23d3bc27efa96cce5d54e3", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BreakBlockCallback.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BreakBlockCallback.java\ndeleted file mode 100644\nindex b727126e..00000000\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BreakBlockCallback.java\n+++ /dev/null\n\n@@ -1,40 +0,0 @@\n-package net.fabricmc.fabric.api.event.player;\n-\n-import net.fabricmc.fabric.api.event.Event;\n-import net.fabricmc.fabric.api.event.EventFactory;\n-import net.minecraft.block.Block;\n-import net.minecraft.block.BlockState;\n-import net.minecraft.block.entity.BlockEntity;\n-import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.util.ActionResult;\n-import net.minecraft.util.Hand;\n-import net.minecraft.util.hit.BlockHitResult;\n-import net.minecraft.util.math.BlockPos;\n-import net.minecraft.world.World;\n-import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n-\n-/**\n- * Callback for when a block is broken.\n- * Only called on the server, however updates are synced with the client.\n- *\n- * <p>Upon return:\n- * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n- * <li>FAIL cancels the block breaking action\n- */\n-public interface BreakBlockCallback {\n-\tEvent<BreakBlockCallback> EVENT = EventFactory.createArrayBacked(BreakBlockCallback.class,\n-\t\t\t(listeners) -> (pos, state, entity, block) -> {\n-\t\t\t\tfor (BreakBlockCallback event : listeners) {\n-\t\t\t\t\tActionResult result = event.interact(pos, state, entity, block);\n-\n-\t\t\t\t\tif (result != ActionResult.PASS) {\n-\t\t\t\t\t\treturn result;\n-\t\t\t\t\t}\n-\t\t\t\t}\n-\n-\t\t\t\treturn ActionResult.PASS;\n-\t\t\t}\n-\t);\n-\n-\tActionResult interact(BlockPos pos, BlockState state, BlockEntity entity, Block block);\n-}\n"}}, {"oid": "38554143290eb2761b23d3bc27efa96cce5d54e3", "url": "https://github.com/FabricMC/fabric/commit/38554143290eb2761b23d3bc27efa96cce5d54e3", "message": "License headers + after event", "committedDate": "2020-08-01T05:21:39Z", "type": "commit"}, {"oid": "b044d490241a23fdeac8e14d4d4bd8fb1f89bb3a", "url": "https://github.com/FabricMC/fabric/commit/b044d490241a23fdeac8e14d4d4bd8fb1f89bb3a", "message": "Before and after events, testmod", "committedDate": "2020-08-01T15:44:58Z", "type": "commit"}, {"oid": "328f32cccfca4316ba352ebdba4966181f82ad51", "url": "https://github.com/FabricMC/fabric/commit/328f32cccfca4316ba352ebdba4966181f82ad51", "message": "Fix checkstyle", "committedDate": "2020-08-01T16:00:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk3Njc5Ng==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463976796", "bodyText": "toShortString() is client-only.", "author": "Shnupbups", "createdAt": "2020-08-01T16:16:47Z", "path": "fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.test.event.interaction;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.block.Blocks;\n+import net.minecraft.util.ActionResult;\n+\n+import net.fabricmc.api.ModInitializer;\n+import net.fabricmc.fabric.api.event.player.AfterBreakBlockCallback;\n+import net.fabricmc.fabric.api.event.player.BeforeBreakBlockCallback;\n+\n+public class InteractionEventsTest implements ModInitializer {\n+\tpublic static final Logger LOGGER = LogManager.getLogger(\"InteractionEventsTest\");\n+\n+\t@Override\n+\tpublic void onInitialize() {\n+\t\tBeforeBreakBlockCallback.EVENT.register(((pos, state, entity, block) -> {\n+\t\t\treturn block == Blocks.BEDROCK ? ActionResult.FAIL : ActionResult.PASS;\n+\t\t}));\n+\n+\t\tAfterBreakBlockCallback.EVENT.register(((pos, state, entity, block) -> {\n+\t\t\tLOGGER.info(\"Block broken at \" + pos.toShortString());", "originalCommit": "328f32cccfca4316ba352ebdba4966181f82ad51", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk3ODUzOQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463978539", "bodyText": "also remove ur debug statement :tiny_potato:", "author": "Devan-Kerman", "createdAt": "2020-08-01T16:38:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk3Njc5Ng=="}], "type": "inlineReview", "revised_code": {"commit": "640185e26c20e4fca486d6068071667a1edd23f2", "chunk": "diff --git a/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java b/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java\nindex 47c404c1..0ed05a98 100644\n--- a/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java\n+++ b/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java\n\n@@ -23,20 +23,20 @@ import net.minecraft.block.Blocks;\n import net.minecraft.util.ActionResult;\n \n import net.fabricmc.api.ModInitializer;\n-import net.fabricmc.fabric.api.event.player.AfterBreakBlockCallback;\n-import net.fabricmc.fabric.api.event.player.BeforeBreakBlockCallback;\n+import net.fabricmc.fabric.api.event.player.PreBreakBlockCallback;\n+import net.fabricmc.fabric.api.event.player.PostBreakBlockCallback;\n \n public class InteractionEventsTest implements ModInitializer {\n \tpublic static final Logger LOGGER = LogManager.getLogger(\"InteractionEventsTest\");\n \n \t@Override\n \tpublic void onInitialize() {\n-\t\tBeforeBreakBlockCallback.EVENT.register(((pos, state, entity, block) -> {\n+\t\tPostBreakBlockCallback.EVENT.register(((pos, state, entity, block) -> {\n \t\t\treturn block == Blocks.BEDROCK ? ActionResult.FAIL : ActionResult.PASS;\n \t\t}));\n \n-\t\tAfterBreakBlockCallback.EVENT.register(((pos, state, entity, block) -> {\n-\t\t\tLOGGER.info(\"Block broken at \" + pos.toShortString());\n+\t\tPreBreakBlockCallback.EVENT.register(((pos, state, entity, block) -> {\n+\t\t\tLOGGER.info(\"Block broken at \" + pos.getX() + \", \" + pos.getY() + \", \" + pos.getZ());\n \t\t}));\n \t}\n }\n"}}, {"oid": "640185e26c20e4fca486d6068071667a1edd23f2", "url": "https://github.com/FabricMC/fabric/commit/640185e26c20e4fca486d6068071667a1edd23f2", "message": "Version bump, fix client method call", "committedDate": "2020-08-01T16:54:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MDY0OA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463980648", "bodyText": "Named post but the event is called before? Something is wrong here.", "author": "LambdAurora", "createdAt": "2020-08-01T17:03:20Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PostBreakBlockCallback.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+/**\n+ * Callback before a block is broken.\n+ * Only called on the server, however updates are synced with the client.\n+ *\n+ * <p>Upon return:\n+ * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+ * <li>FAIL cancels the block breaking action</ul>\n+ */\n+public interface PostBreakBlockCallback {", "originalCommit": "640185e26c20e4fca486d6068071667a1edd23f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MjIyNg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463982226", "bodyText": "Imo just make a BlockBreakEvents class and move the individual callback interfaces to subclasses there with simple names like Pre Post. Btw @Geometrically you messed up pre and post as lambd said", "author": "liach", "createdAt": "2020-08-01T17:23:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MDY0OA=="}], "type": "inlineReview", "revised_code": {"commit": "c37539787f4ca20ae8baadf45a26bad38b957ebf", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PostBreakBlockCallback.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PostBreakBlockCallback.java\ndeleted file mode 100644\nindex d499cd01..00000000\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PostBreakBlockCallback.java\n+++ /dev/null\n\n@@ -1,52 +0,0 @@\n-/*\n- * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *     http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-\n-package net.fabricmc.fabric.api.event.player;\n-\n-import net.minecraft.block.Block;\n-import net.minecraft.block.BlockState;\n-import net.minecraft.block.entity.BlockEntity;\n-import net.minecraft.util.ActionResult;\n-import net.minecraft.util.math.BlockPos;\n-\n-import net.fabricmc.fabric.api.event.Event;\n-import net.fabricmc.fabric.api.event.EventFactory;\n-\n-/**\n- * Callback before a block is broken.\n- * Only called on the server, however updates are synced with the client.\n- *\n- * <p>Upon return:\n- * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n- * <li>FAIL cancels the block breaking action</ul>\n- */\n-public interface PostBreakBlockCallback {\n-\tEvent<PostBreakBlockCallback> EVENT = EventFactory.createArrayBacked(PostBreakBlockCallback.class,\n-\t\t\t(listeners) -> (pos, state, entity, block) -> {\n-\t\t\t\tfor (PostBreakBlockCallback event : listeners) {\n-\t\t\t\t\tActionResult result = event.beforeBlockBreak(pos, state, entity, block);\n-\n-\t\t\t\t\tif (result != ActionResult.PASS) {\n-\t\t\t\t\t\treturn result;\n-\t\t\t\t\t}\n-\t\t\t\t}\n-\n-\t\t\t\treturn ActionResult.PASS;\n-\t\t\t}\n-\t);\n-\n-\tActionResult beforeBlockBreak(BlockPos pos, BlockState state, BlockEntity entity, Block block);\n-}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MDY2MA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463980660", "bodyText": "The injection point of the event is in ServerPlayerInteractionManager, why the event doesn't give the player handle as its triggered when the player does the action?", "author": "LambdAurora", "createdAt": "2020-08-01T17:03:25Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PostBreakBlockCallback.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+/**\n+ * Callback before a block is broken.\n+ * Only called on the server, however updates are synced with the client.\n+ *\n+ * <p>Upon return:\n+ * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+ * <li>FAIL cancels the block breaking action</ul>\n+ */\n+public interface PostBreakBlockCallback {\n+\tEvent<PostBreakBlockCallback> EVENT = EventFactory.createArrayBacked(PostBreakBlockCallback.class,\n+\t\t\t(listeners) -> (pos, state, entity, block) -> {\n+\t\t\t\tfor (PostBreakBlockCallback event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(pos, state, entity, block);\n+\n+\t\t\t\t\tif (result != ActionResult.PASS) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.PASS;\n+\t\t\t}\n+\t);\n+\n+\tActionResult beforeBlockBreak(BlockPos pos, BlockState state, BlockEntity entity, Block block);", "originalCommit": "640185e26c20e4fca486d6068071667a1edd23f2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c37539787f4ca20ae8baadf45a26bad38b957ebf", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PostBreakBlockCallback.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PostBreakBlockCallback.java\ndeleted file mode 100644\nindex d499cd01..00000000\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PostBreakBlockCallback.java\n+++ /dev/null\n\n@@ -1,52 +0,0 @@\n-/*\n- * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *     http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-\n-package net.fabricmc.fabric.api.event.player;\n-\n-import net.minecraft.block.Block;\n-import net.minecraft.block.BlockState;\n-import net.minecraft.block.entity.BlockEntity;\n-import net.minecraft.util.ActionResult;\n-import net.minecraft.util.math.BlockPos;\n-\n-import net.fabricmc.fabric.api.event.Event;\n-import net.fabricmc.fabric.api.event.EventFactory;\n-\n-/**\n- * Callback before a block is broken.\n- * Only called on the server, however updates are synced with the client.\n- *\n- * <p>Upon return:\n- * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n- * <li>FAIL cancels the block breaking action</ul>\n- */\n-public interface PostBreakBlockCallback {\n-\tEvent<PostBreakBlockCallback> EVENT = EventFactory.createArrayBacked(PostBreakBlockCallback.class,\n-\t\t\t(listeners) -> (pos, state, entity, block) -> {\n-\t\t\t\tfor (PostBreakBlockCallback event : listeners) {\n-\t\t\t\t\tActionResult result = event.beforeBlockBreak(pos, state, entity, block);\n-\n-\t\t\t\t\tif (result != ActionResult.PASS) {\n-\t\t\t\t\t\treturn result;\n-\t\t\t\t\t}\n-\t\t\t\t}\n-\n-\t\t\t\treturn ActionResult.PASS;\n-\t\t\t}\n-\t);\n-\n-\tActionResult beforeBlockBreak(BlockPos pos, BlockState state, BlockEntity entity, Block block);\n-}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MDY2Mg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463980662", "bodyText": "Same issue with player handle.", "author": "LambdAurora", "createdAt": "2020-08-01T17:03:29Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PreBreakBlockCallback.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.util.math.BlockPos;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+/**\n+ * Callback after a block is broken.\n+ * Only called on the server, however updates are synced with the client.\n+ */\n+public interface PreBreakBlockCallback {\n+\tEvent<PreBreakBlockCallback> EVENT = EventFactory.createArrayBacked(PreBreakBlockCallback.class,\n+\t\t\t(listeners) -> (pos, state, entity, block) -> {\n+\t\t\t\tfor (PreBreakBlockCallback event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(pos, state, entity, block);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\tvoid afterBlockBreak(BlockPos pos, BlockState state, BlockEntity entity, Block block);", "originalCommit": "640185e26c20e4fca486d6068071667a1edd23f2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c37539787f4ca20ae8baadf45a26bad38b957ebf", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PreBreakBlockCallback.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PreBreakBlockCallback.java\ndeleted file mode 100644\nindex 14eb95b8..00000000\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PreBreakBlockCallback.java\n+++ /dev/null\n\n@@ -1,41 +0,0 @@\n-/*\n- * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *     http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-\n-package net.fabricmc.fabric.api.event.player;\n-\n-import net.minecraft.block.Block;\n-import net.minecraft.block.BlockState;\n-import net.minecraft.block.entity.BlockEntity;\n-import net.minecraft.util.math.BlockPos;\n-\n-import net.fabricmc.fabric.api.event.Event;\n-import net.fabricmc.fabric.api.event.EventFactory;\n-\n-/**\n- * Callback after a block is broken.\n- * Only called on the server, however updates are synced with the client.\n- */\n-public interface PreBreakBlockCallback {\n-\tEvent<PreBreakBlockCallback> EVENT = EventFactory.createArrayBacked(PreBreakBlockCallback.class,\n-\t\t\t(listeners) -> (pos, state, entity, block) -> {\n-\t\t\t\tfor (PreBreakBlockCallback event : listeners) {\n-\t\t\t\t\tevent.afterBlockBreak(pos, state, entity, block);\n-\t\t\t\t}\n-\t\t\t}\n-\t);\n-\n-\tvoid afterBlockBreak(BlockPos pos, BlockState state, BlockEntity entity, Block block);\n-}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MjYyMg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463982622", "bodyText": "Are we really to send 27 packets? Like is 7 packets not sufficient (send packet at pos and do a for loop for direction values and send packet for pos offset at each direction)\nAlso if you do need to send by radius, there is method in block pos that allow you to iterate block pos in a radius (3d) from closest to furthest.", "author": "liach", "createdAt": "2020-08-01T17:27:51Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java", "diffHunk": "@@ -81,4 +87,28 @@ public void interactItem(ServerPlayerEntity player, World world, ItemStack stack\n \t\t\treturn;\n \t\t}\n \t}\n+\n+\t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBreak(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/entity/player/PlayerEntity;)V\"), method = \"tryBreakBlock\", locals = LocalCapture.CAPTURE_FAILHARD, cancellable = true)\n+\tprivate void breakBlock(BlockPos pos, CallbackInfoReturnable<Boolean> cir, BlockState state, BlockEntity entity, Block block) {\n+\t\tActionResult result = PostBreakBlockCallback.EVENT.invoker().beforeBlockBreak(pos, state, entity, block);\n+\n+\t\tif (result == ActionResult.FAIL) {\n+\t\t\tBlockPos cornerPos = pos.add(-1, -1, -1);\n+\n+\t\t\tfor (int x = 0; x < 3; x++) {\n+\t\t\t\tfor (int y = 0; y < 3; y++) {\n+\t\t\t\t\tfor (int z = 0; z < 3; z++) {\n+\t\t\t\t\t\tthis.player.networkHandler.sendPacket(new BlockUpdateS2CPacket(world, cornerPos.add(x, y, z)));", "originalCommit": "640185e26c20e4fca486d6068071667a1edd23f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MzMzMg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463983332", "bodyText": "yes u do need all 27 packets because of redstone dust", "author": "Devan-Kerman", "createdAt": "2020-08-01T17:36:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MjYyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MzY2NA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463983664", "bodyText": "Does redstone dust update block that far? And how can we make sure modded blocks don't update further?", "author": "liach", "createdAt": "2020-08-01T17:40:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MjYyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4Mzk1MA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463983950", "bodyText": "does vanilla do this?", "author": "shedaniel", "createdAt": "2020-08-01T17:44:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MjYyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4OTUxNw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r463989517", "bodyText": "Does redstone dust update block that far? And how can we make sure modded blocks don't update further?\n\nwe don't, mods will just have to listen in and send packets themselves most likely, but it might not be an issue I'm not sure.\nand redstone dust\nX\nBX\nx = redstone dust\nb = block\nbreak the bottom redstone dust, the top one will change it's state, that's why we need the 27.\nif your concern is performance this is nothing I wouldn't worry about it", "author": "Devan-Kerman", "createdAt": "2020-08-01T18:52:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MjYyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzAyMw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464037023", "bodyText": "but isnt this the failed condition? failed shouldn't change anything right", "author": "shedaniel", "createdAt": "2020-08-02T06:11:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MjYyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU1MzQyNQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464553425", "bodyText": "I still don't understand why the redstone will get updated if the block didn't change", "author": "shedaniel", "createdAt": "2020-08-03T17:24:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk4MjYyMg=="}], "type": "inlineReview", "revised_code": {"commit": "c37539787f4ca20ae8baadf45a26bad38b957ebf", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\nindex fae8ba46..3c1ac1e0 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n\n@@ -90,7 +85,7 @@ public class MixinServerPlayerInteractionManager {\n \n \t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBreak(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/entity/player/PlayerEntity;)V\"), method = \"tryBreakBlock\", locals = LocalCapture.CAPTURE_FAILHARD, cancellable = true)\n \tprivate void breakBlock(BlockPos pos, CallbackInfoReturnable<Boolean> cir, BlockState state, BlockEntity entity, Block block) {\n-\t\tActionResult result = PostBreakBlockCallback.EVENT.invoker().beforeBlockBreak(pos, state, entity, block);\n+\t\tActionResult result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.player, pos, state, entity, block);\n \n \t\tif (result == ActionResult.FAIL) {\n \t\t\tBlockPos cornerPos = pos.add(-1, -1, -1);\n"}}, {"oid": "c37539787f4ca20ae8baadf45a26bad38b957ebf", "url": "https://github.com/FabricMC/fabric/commit/c37539787f4ca20ae8baadf45a26bad38b957ebf", "message": "Move to one event class", "committedDate": "2020-08-02T01:27:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODM3OQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464018379", "bodyText": "You know you can set IJ to not static import and order imports properly.", "author": "i509VCB", "createdAt": "2020-08-02T01:32:59Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java", "diffHunk": "@@ -16,6 +16,11 @@\n \n package net.fabricmc.fabric.mixin.event.interaction;\n \n+import net.fabricmc.fabric.api.event.player.*;", "originalCommit": "c37539787f4ca20ae8baadf45a26bad38b957ebf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAyNTI5MQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464025291", "bodyText": "haha, ill be switching the vscode soon completely, it shouldn't happen there", "author": "Geometrically", "createdAt": "2020-08-02T03:16:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODM3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java\nindex a81e4374..ec35e1d4 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java\n\n@@ -16,18 +16,17 @@\n \n package net.fabricmc.fabric.mixin.event.interaction;\n \n-import net.fabricmc.fabric.api.event.player.*;\n-import net.minecraft.block.Block;\n-import net.minecraft.block.BlockState;\n-import net.minecraft.block.entity.BlockEntity;\n-import net.minecraft.fluid.FluidState;\n import org.spongepowered.asm.mixin.Mixin;\n import org.spongepowered.asm.mixin.Shadow;\n import org.spongepowered.asm.mixin.injection.At;\n import org.spongepowered.asm.mixin.injection.Inject;\n import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n+import org.spongepowered.asm.mixin.injection.callback.LocalCapture;\n \n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.fluid.FluidState;\n import net.minecraft.client.MinecraftClient;\n import net.minecraft.client.network.ClientPlayNetworkHandler;\n import net.minecraft.client.network.ClientPlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODYxNA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464018614", "bodyText": "I think we should pass the world in the parameters.\nThe BlockEntity can be obtained using getBlockEntity in world. Also I don't think the block param at the end is really necessary since you can get that from the block state.\nAlso please document the fields, I have no idea whether the block state is the state being broken or the resulting state.", "author": "i509VCB", "createdAt": "2020-08-02T01:36:33Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,56 @@\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+\n+public class BlockBreakEvents {\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<BeforeBreakBlockCallback> BEFORE = EventFactory.createArrayBacked(BeforeBreakBlockCallback.class,\n+\t\t\t(listeners) -> (player, pos, state, entity, block) -> {\n+\t\t\t\tfor (BeforeBreakBlockCallback event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(player, pos, state, entity, block);\n+\n+\t\t\t\t\tif (result != ActionResult.FAIL) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.FAIL;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t * Called on both Client and Server\n+\t */\n+\tpublic static final Event<AfterBreakBlockCallback> AFTER = EventFactory.createArrayBacked(AfterBreakBlockCallback.class,\n+\t\t\t(listeners) -> (player, pos, state, entity, block) -> {\n+\t\t\t\tfor (AfterBreakBlockCallback event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(player, pos, state, entity, block);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface BeforeBreakBlockCallback {\n+\t\tActionResult beforeBlockBreak(PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity, Block block);", "originalCommit": "c37539787f4ca20ae8baadf45a26bad38b957ebf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAyNTU4NA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464025584", "bodyText": "I added world to the parameters, and I am documenting it now. The blockentity is there as the method where the event is injected to already has a blockentity there, so there is no point of the double computation.", "author": "Geometrically", "createdAt": "2020-08-02T03:21:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODYxNA=="}], "type": "inlineReview", "revised_code": {"commit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex 7a08b483..e89580c9 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -1,13 +1,31 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n package net.fabricmc.fabric.api.event.player;\n \n-import net.fabricmc.fabric.api.event.Event;\n-import net.fabricmc.fabric.api.event.EventFactory;\n import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n import net.minecraft.util.ActionResult;\n import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n \n public class BlockBreakEvents {\n \t/**\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODcwNQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464018705", "bodyText": "Would a mutable block pos be possible to use here if it's beneficial for performance.", "author": "i509VCB", "createdAt": "2020-08-02T01:38:13Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java", "diffHunk": "@@ -81,4 +82,28 @@ public void interactItem(ServerPlayerEntity player, World world, ItemStack stack\n \t\t\treturn;\n \t\t}\n \t}\n+\n+\t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBreak(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/entity/player/PlayerEntity;)V\"), method = \"tryBreakBlock\", locals = LocalCapture.CAPTURE_FAILHARD, cancellable = true)\n+\tprivate void breakBlock(BlockPos pos, CallbackInfoReturnable<Boolean> cir, BlockState state, BlockEntity entity, Block block) {\n+\t\tActionResult result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.player, pos, state, entity, block);\n+\n+\t\tif (result == ActionResult.FAIL) {\n+\t\t\tBlockPos cornerPos = pos.add(-1, -1, -1);", "originalCommit": "c37539787f4ca20ae8baadf45a26bad38b957ebf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAyNjE1Mw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464026153", "bodyText": "I don't know if it's possible, as the packet might change as the loop iterates", "author": "Geometrically", "createdAt": "2020-08-02T03:31:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODcwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzMDA5Nw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464030097", "bodyText": "Unfortunately cannot, as the packet is lazily encoded.  This really is a garbage factory as-is, with all the block positions and packets.  Would consider using a custom packet that does the iteration client-side.\nThis probably won't matter in single player with mostly vanilla content, but in a multi-player environment with expanded-area tools or quarries that impersonate players it could become A Problem.", "author": "grondag", "createdAt": "2020-08-02T04:31:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODcwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzMTAzNA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464031034", "bodyText": "Even in modded I doubt it, even at 1 block/tick that's like 27 Objects per tick which is pretty much nothing compared to the other stuff vanilla does :p", "author": "Devan-Kerman", "createdAt": "2020-08-02T04:45:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODcwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA3MDk0NA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464070944", "bodyText": "1 block per tick? How about a Project E Destruction Catalyst or Botania TerraSteel Pick on max settings?", "author": "grondag", "createdAt": "2020-08-02T12:23:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODcwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEwMjU3MA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464102570", "bodyText": "I think the reason for these packets is to tell the client what the neighboring blocks actually are (since the client also calculates this).", "author": "i509VCB", "createdAt": "2020-08-02T17:29:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODcwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDExMTAwNQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464111005", "bodyText": "shouldn't the block and it's neighbor not change if it is failing?", "author": "shedaniel", "createdAt": "2020-08-02T18:52:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODcwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\nindex 3c1ac1e0..d24e472b 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n\n@@ -85,7 +89,7 @@ public class MixinServerPlayerInteractionManager {\n \n \t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBreak(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/entity/player/PlayerEntity;)V\"), method = \"tryBreakBlock\", locals = LocalCapture.CAPTURE_FAILHARD, cancellable = true)\n \tprivate void breakBlock(BlockPos pos, CallbackInfoReturnable<Boolean> cir, BlockState state, BlockEntity entity, Block block) {\n-\t\tActionResult result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.player, pos, state, entity, block);\n+\t\tActionResult result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.world, this.player, pos, state, entity, block);\n \n \t\tif (result == ActionResult.FAIL) {\n \t\t\tBlockPos cornerPos = pos.add(-1, -1, -1);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODgxNA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464018814", "bodyText": "I'd test the item in the player's main hand if it's bedrock imo.", "author": "i509VCB", "createdAt": "2020-08-02T01:39:57Z", "path": "fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.test.event.interaction;\n+\n+import net.fabricmc.fabric.api.event.player.BlockBreakEvents;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.block.Blocks;\n+import net.minecraft.util.ActionResult;\n+\n+import net.fabricmc.api.ModInitializer;\n+\n+public class InteractionEventsTest implements ModInitializer {\n+\tpublic static final Logger LOGGER = LogManager.getLogger(\"InteractionEventsTest\");\n+\n+\t@Override\n+\tpublic void onInitialize() {\n+\t\tBlockBreakEvents.BEFORE.register(((player, pos, state, entity, block) -> {\n+\t\t\treturn block == Blocks.BEDROCK ? ActionResult.FAIL : ActionResult.PASS;", "originalCommit": "c37539787f4ca20ae8baadf45a26bad38b957ebf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAyNTM2MQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464025361", "bodyText": "what do you mean? all the test mod does it make it so bedrock can't be broken", "author": "Geometrically", "createdAt": "2020-08-02T03:18:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODgxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAyNTYxMw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464025613", "bodyText": "That is fine tbh, but honestly the time it takes to place bedrock is negligible", "author": "i509VCB", "createdAt": "2020-08-02T03:22:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAxODgxNA=="}], "type": "inlineReview", "revised_code": {"commit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "chunk": "diff --git a/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java b/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java\nindex 837131f8..ad487651 100644\n--- a/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java\n+++ b/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.test.event.interaction;\n \n-import net.fabricmc.fabric.api.event.player.BlockBreakEvents;\n import org.apache.logging.log4j.LogManager;\n import org.apache.logging.log4j.Logger;\n \n"}}, {"oid": "35509367dbbe84f6aa04cafecb8b899ad241c680", "url": "https://github.com/FabricMC/fabric/commit/35509367dbbe84f6aa04cafecb8b899ad241c680", "message": "Expand event parameters + javadoc", "committedDate": "2020-08-02T03:30:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzUzNg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464037536", "bodyText": "FAIL as default? what?", "author": "shedaniel", "createdAt": "2020-08-02T06:18:12Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public class BlockBreakEvents {\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world at which the block is being broken\n+\t * <li> player - The player who is breaking the block\n+\t * <li> pos - The position at which the block is being broken\n+\t * <li> state - The block state from BEFORE the block is broken\n+\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t * <li> block - The block instance of the block that is being broken</ul>\n+\t */\n+\tpublic static final Event<BeforeBreakBlockCallback> BEFORE = EventFactory.createArrayBacked(BeforeBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (BeforeBreakBlockCallback event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity, block);\n+\n+\t\t\t\t\tif (result != ActionResult.FAIL) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.FAIL;", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex e89580c9..b7874cf3 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.api.event.player;\n \n-import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzU4NQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464037585", "bodyText": "shouldn't this check with PASS? PASS should pass the callback to the next one.", "author": "shedaniel", "createdAt": "2020-08-02T06:18:55Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public class BlockBreakEvents {\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world at which the block is being broken\n+\t * <li> player - The player who is breaking the block\n+\t * <li> pos - The position at which the block is being broken\n+\t * <li> state - The block state from BEFORE the block is broken\n+\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t * <li> block - The block instance of the block that is being broken</ul>\n+\t */\n+\tpublic static final Event<BeforeBreakBlockCallback> BEFORE = EventFactory.createArrayBacked(BeforeBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (BeforeBreakBlockCallback event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity, block);\n+\n+\t\t\t\t\tif (result != ActionResult.FAIL) {", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex e89580c9..b7874cf3 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.api.event.player;\n \n-import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzc2Mw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464037763", "bodyText": "didn't you change it to pre/post", "author": "shedaniel", "createdAt": "2020-08-02T06:20:33Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public class BlockBreakEvents {\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world at which the block is being broken\n+\t * <li> player - The player who is breaking the block\n+\t * <li> pos - The position at which the block is being broken\n+\t * <li> state - The block state from BEFORE the block is broken\n+\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t * <li> block - The block instance of the block that is being broken</ul>\n+\t */\n+\tpublic static final Event<BeforeBreakBlockCallback> BEFORE = EventFactory.createArrayBacked(BeforeBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (BeforeBreakBlockCallback event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity, block);\n+\n+\t\t\t\t\tif (result != ActionResult.FAIL) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.FAIL;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t * Called on both Client and Server\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world where the block was broken\n+\t * <li> player - The player who broke the block\n+\t * <li> pos - The position where the block was broken\n+\t * <li> state - The block state from AFTER the block was broken\n+\t * <li> entity - The block entity of the broken block (can be null)\n+\t * <li> block - The block instance of the block that was broken</ul>\n+\t */\n+\tpublic static final Event<AfterBreakBlockCallback> AFTER = EventFactory.createArrayBacked(AfterBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (AfterBreakBlockCallback event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity, block);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface BeforeBreakBlockCallback {", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEwMTU4Nw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464101587", "bodyText": "Before and after is consistent with lifecycle events.", "author": "i509VCB", "createdAt": "2020-08-02T17:18:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzc2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDUxMTUxMQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464511511", "bodyText": "Then fix lifecycle events iritat", "author": "Devan-Kerman", "createdAt": "2020-08-03T16:06:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzc2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex e89580c9..b7874cf3 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.api.event.player;\n \n-import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzk0Mg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464037942", "bodyText": "will it be weird if you run post block break in the client but not pre block break? I would just not call it in the client or make a new callback especially for the client since you are calling World#getBlockEntity", "author": "shedaniel", "createdAt": "2020-08-02T06:22:45Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java", "diffHunk": "@@ -141,4 +146,9 @@ public void interactEntityAtLocation(PlayerEntity player, Entity entity, EntityH\n \t\t\treturn;\n \t\t}\n \t}\n+\n+\t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBroken(Lnet/minecraft/world/WorldAccess;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;)V\"), method = \"breakBlock\", locals = LocalCapture.CAPTURE_FAILHARD)\n+\tprivate void onBlockBroken(BlockPos pos, CallbackInfoReturnable<Boolean> cir, World world, BlockState state, Block block, FluidState fluidState, boolean bl) {", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEwMTY5MA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464101690", "bodyText": "Client/Server distinction isn't a big issue since we have a world.", "author": "i509VCB", "createdAt": "2020-08-02T17:19:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDExMDkxOA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464110918", "bodyText": "what I meant is that it will get confusing how there is only the after block break for the client, there isn't before block break for the client", "author": "shedaniel", "createdAt": "2020-08-02T18:51:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzk0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java\nindex ec35e1d4..a35359d1 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinClientPlayerInteractionManager.java\n\n@@ -146,9 +141,4 @@ public class MixinClientPlayerInteractionManager {\n \t\t\treturn;\n \t\t}\n \t}\n-\n-\t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBroken(Lnet/minecraft/world/WorldAccess;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;)V\"), method = \"breakBlock\", locals = LocalCapture.CAPTURE_FAILHARD)\n-\tprivate void onBlockBroken(BlockPos pos, CallbackInfoReturnable<Boolean> cir, World world, BlockState state, Block block, FluidState fluidState, boolean bl) {\n-\t\tBlockBreakEvents.AFTER.invoker().afterBlockBreak(world, this.client.player, pos, state, world.getBlockEntity(pos), block);\n-\t}\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzk0NA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464037944", "bodyText": "we don't need the extra block probably", "author": "shedaniel", "createdAt": "2020-08-02T06:22:49Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public class BlockBreakEvents {\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world at which the block is being broken\n+\t * <li> player - The player who is breaking the block\n+\t * <li> pos - The position at which the block is being broken\n+\t * <li> state - The block state from BEFORE the block is broken\n+\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t * <li> block - The block instance of the block that is being broken</ul>\n+\t */\n+\tpublic static final Event<BeforeBreakBlockCallback> BEFORE = EventFactory.createArrayBacked(BeforeBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (BeforeBreakBlockCallback event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity, block);\n+\n+\t\t\t\t\tif (result != ActionResult.FAIL) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.FAIL;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t * Called on both Client and Server\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world where the block was broken\n+\t * <li> player - The player who broke the block\n+\t * <li> pos - The position where the block was broken\n+\t * <li> state - The block state from AFTER the block was broken\n+\t * <li> entity - The block entity of the broken block (can be null)\n+\t * <li> block - The block instance of the block that was broken</ul>\n+\t */\n+\tpublic static final Event<AfterBreakBlockCallback> AFTER = EventFactory.createArrayBacked(AfterBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (AfterBreakBlockCallback event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity, block);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface BeforeBreakBlockCallback {\n+\t\tActionResult beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity, Block block);", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA5NTgzNw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464095837", "bodyText": "yes", "author": "Devan-Kerman", "createdAt": "2020-08-02T16:15:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDAzNzk0NA=="}], "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex e89580c9..b7874cf3 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.api.event.player;\n \n-import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEwMTg1NQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464101855", "bodyText": "Yeet Callback from the interface names since the parent class has Events in the name", "author": "i509VCB", "createdAt": "2020-08-02T17:21:07Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public class BlockBreakEvents {\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world at which the block is being broken\n+\t * <li> player - The player who is breaking the block\n+\t * <li> pos - The position at which the block is being broken\n+\t * <li> state - The block state from BEFORE the block is broken\n+\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t * <li> block - The block instance of the block that is being broken</ul>\n+\t */\n+\tpublic static final Event<BeforeBreakBlockCallback> BEFORE = EventFactory.createArrayBacked(BeforeBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (BeforeBreakBlockCallback event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity, block);\n+\n+\t\t\t\t\tif (result != ActionResult.FAIL) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.FAIL;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t * Called on both Client and Server\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world where the block was broken\n+\t * <li> player - The player who broke the block\n+\t * <li> pos - The position where the block was broken\n+\t * <li> state - The block state from AFTER the block was broken\n+\t * <li> entity - The block entity of the broken block (can be null)\n+\t * <li> block - The block instance of the block that was broken</ul>\n+\t */\n+\tpublic static final Event<AfterBreakBlockCallback> AFTER = EventFactory.createArrayBacked(AfterBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (AfterBreakBlockCallback event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity, block);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface BeforeBreakBlockCallback {\n+\t\tActionResult beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity, Block block);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface AfterBreakBlockCallback {", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMDcyNQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464120725", "bodyText": "Yes, just call this After. We know this is a callback, and this is in BlockBreakEvents so BreakBlock is redundant context as well.", "author": "liach", "createdAt": "2020-08-02T20:34:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEwMTg1NQ=="}], "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex e89580c9..b7874cf3 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.api.event.player;\n \n-import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEwMjE1Ng==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464102156", "bodyText": "Yeet the Block off the end. It's negligable the time you'll save by getting the block instance from the block state, but I'd say it's worth making the method signature slightly cleaner.", "author": "i509VCB", "createdAt": "2020-08-02T17:24:35Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public class BlockBreakEvents {\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world at which the block is being broken\n+\t * <li> player - The player who is breaking the block\n+\t * <li> pos - The position at which the block is being broken\n+\t * <li> state - The block state from BEFORE the block is broken\n+\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t * <li> block - The block instance of the block that is being broken</ul>\n+\t */\n+\tpublic static final Event<BeforeBreakBlockCallback> BEFORE = EventFactory.createArrayBacked(BeforeBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (BeforeBreakBlockCallback event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity, block);\n+\n+\t\t\t\t\tif (result != ActionResult.FAIL) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.FAIL;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t * Called on both Client and Server\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world where the block was broken\n+\t * <li> player - The player who broke the block\n+\t * <li> pos - The position where the block was broken\n+\t * <li> state - The block state from AFTER the block was broken\n+\t * <li> entity - The block entity of the broken block (can be null)\n+\t * <li> block - The block instance of the block that was broken</ul>\n+\t */\n+\tpublic static final Event<AfterBreakBlockCallback> AFTER = EventFactory.createArrayBacked(AfterBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (AfterBreakBlockCallback event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity, block);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface BeforeBreakBlockCallback {\n+\t\tActionResult beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity, Block block);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface AfterBreakBlockCallback {\n+\t\tvoid afterBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity, Block block);", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex e89580c9..b7874cf3 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.api.event.player;\n \n-import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEwMjIzOA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464102238", "bodyText": "final with private constructor please", "author": "i509VCB", "createdAt": "2020-08-02T17:25:16Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public class BlockBreakEvents {", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex e89580c9..b7874cf3 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.api.event.player;\n \n-import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMDUzOQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464120539", "bodyText": "Document on the method in the functional interface, not here. This is an absolute mess", "author": "liach", "createdAt": "2020-08-02T20:33:30Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public class BlockBreakEvents {\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world at which the block is being broken\n+\t * <li> player - The player who is breaking the block\n+\t * <li> pos - The position at which the block is being broken\n+\t * <li> state - The block state from BEFORE the block is broken\n+\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t * <li> block - The block instance of the block that is being broken</ul>", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIwMTEwNw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464201107", "bodyText": "I don't normally document my code, I will move it there", "author": "Geometrically", "createdAt": "2020-08-03T05:29:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMDUzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDM0MTA2Mg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464341062", "bodyText": "I actually think this is the right place.\nSee the lifecycle events for example: https://github.com/FabricMC/fabric/blob/1.16/fabric-lifecycle-events-v1/src/main/java/net/fabricmc/fabric/api/client/event/lifecycle/v1/ClientChunkEvents.java\nThe description of parameters can be moved to the method though.", "author": "shartte", "createdAt": "2020-08-03T10:56:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMDUzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex e89580c9..b7874cf3 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.api.event.player;\n \n-import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMDY1OA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464120658", "bodyText": "Same, document on method in functional interface.", "author": "liach", "createdAt": "2020-08-02T20:34:05Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.Block;\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public class BlockBreakEvents {\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS/CONSUME continues the default code for breaking the block\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world at which the block is being broken\n+\t * <li> player - The player who is breaking the block\n+\t * <li> pos - The position at which the block is being broken\n+\t * <li> state - The block state from BEFORE the block is broken\n+\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t * <li> block - The block instance of the block that is being broken</ul>\n+\t */\n+\tpublic static final Event<BeforeBreakBlockCallback> BEFORE = EventFactory.createArrayBacked(BeforeBreakBlockCallback.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n+\t\t\t\tfor (BeforeBreakBlockCallback event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity, block);\n+\n+\t\t\t\t\tif (result != ActionResult.FAIL) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.FAIL;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t * Called on both Client and Server\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world where the block was broken\n+\t * <li> player - The player who broke the block\n+\t * <li> pos - The position where the block was broken\n+\t * <li> state - The block state from AFTER the block was broken\n+\t * <li> entity - The block entity of the broken block (can be null)\n+\t * <li> block - The block instance of the block that was broken</ul>", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDM0MTIwMA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464341200", "bodyText": "See above, I think this is the right place to at least describe what the event is and when it is triggered.\nThe description of parameters can be moved to the method.", "author": "shartte", "createdAt": "2020-08-03T10:56:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMDY1OA=="}], "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex e89580c9..b7874cf3 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -16,7 +16,6 @@\n \n package net.fabricmc.fabric.api.event.player;\n \n-import net.minecraft.block.Block;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMTAyOQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464121029", "bodyText": "Instead of doing this loop, add a Cancellation sub functioal interface that allow mods to handle custom server-side block break cancellation logic. In this setup, you only consider vanilla redstone but disregard other mods that can have a bigger volume of influence.\nhttps://github.com/FabricMC/fabric/pull/980/files#r463989517\nPreferably, this loop should be moved to an event handler listening to the cancellation event than left in this mixin body.", "author": "liach", "createdAt": "2020-08-02T20:37:58Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java", "diffHunk": "@@ -81,4 +86,28 @@ public void interactItem(ServerPlayerEntity player, World world, ItemStack stack\n \t\t\treturn;\n \t\t}\n \t}\n+\n+\t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBreak(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/entity/player/PlayerEntity;)V\"), method = \"tryBreakBlock\", locals = LocalCapture.CAPTURE_FAILHARD, cancellable = true)\n+\tprivate void breakBlock(BlockPos pos, CallbackInfoReturnable<Boolean> cir, BlockState state, BlockEntity entity, Block block) {\n+\t\tActionResult result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.world, this.player, pos, state, entity, block);\n+\n+\t\tif (result == ActionResult.FAIL) {\n+\t\t\tBlockPos cornerPos = pos.add(-1, -1, -1);\n+\n+\t\t\tfor (int x = 0; x < 3; x++) {\n+\t\t\t\tfor (int y = 0; y < 3; y++) {\n+\t\t\t\t\tfor (int z = 0; z < 3; z++) {\n+\t\t\t\t\t\tthis.player.networkHandler.sendPacket(new BlockUpdateS2CPacket(world, cornerPos.add(x, y, z)));", "originalCommit": "35509367dbbe84f6aa04cafecb8b899ad241c680", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDUxMDM4MA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464510380", "bodyText": "Mods could just send the packet themselves by listening to the event, though then we'd have to not short circuit the pre event", "author": "Devan-Kerman", "createdAt": "2020-08-03T16:05:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMTAyOQ=="}], "type": "inlineReview", "revised_code": {"commit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\nindex d24e472b..fcad41de 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n\n@@ -89,9 +89,11 @@ public class MixinServerPlayerInteractionManager {\n \n \t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBreak(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/entity/player/PlayerEntity;)V\"), method = \"tryBreakBlock\", locals = LocalCapture.CAPTURE_FAILHARD, cancellable = true)\n \tprivate void breakBlock(BlockPos pos, CallbackInfoReturnable<Boolean> cir, BlockState state, BlockEntity entity, Block block) {\n-\t\tActionResult result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.world, this.player, pos, state, entity, block);\n+\t\tActionResult result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.world, this.player, pos, state, entity);\n \n \t\tif (result == ActionResult.FAIL) {\n+\t\t\tBlockBreakEvents.CANCEL.invoker().onBlockBreakCancel(this.world, this.player, pos, state, entity);\n+\n \t\t\tBlockPos cornerPos = pos.add(-1, -1, -1);\n \n \t\t\tfor (int x = 0; x < 3; x++) {\n"}}, {"oid": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "url": "https://github.com/FabricMC/fabric/commit/c6c8990db9659a947c952e5fdab2da45dbd1439f", "message": "Add cancelation event and move javadocs", "committedDate": "2020-08-03T17:18:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU1MTg3Nw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464551877", "bodyText": "Please move the fields onto the method javadoc. It's going to be easier to read that way.", "author": "i509VCB", "createdAt": "2020-08-03T17:21:03Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -70,21 +100,23 @@\n \t * <li> entity - The block entity of the broken block (can be null)\n \t * <li> block - The block instance of the block that was broken</ul>\n \t */\n-\tpublic static final Event<AfterBreakBlockCallback> AFTER = EventFactory.createArrayBacked(AfterBreakBlockCallback.class,\n-\t\t\t(listeners) -> (world, player, pos, state, entity, block) -> {\n-\t\t\t\tfor (AfterBreakBlockCallback event : listeners) {\n-\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity, block);\n-\t\t\t\t}\n-\t\t\t}\n-\t);\n-\n \t@FunctionalInterface\n-\tpublic interface BeforeBreakBlockCallback {\n-\t\tActionResult beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity, Block block);\n+\tpublic interface After {\n+\t\tvoid afterBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n \n+\t/* Called when a block break has been canceled\n+\t *\n+\t * <p>Fields:\n+\t * <ul><li> world - The world where the block was going to be broken\n+\t * <li> player - The player was going to break the block\n+\t * <li> pos - The position where the block was going to be broken\n+\t * <li> state - The block state of the block that was going to be broken\n+\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n+\t * <li> block - The block instance of the block that was going to be broken</ul>", "originalCommit": "c6c8990db9659a947c952e5fdab2da45dbd1439f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU3ODkxMg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464578912", "bodyText": "Done", "author": "Geometrically", "createdAt": "2020-08-03T18:08:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU1MTg3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex b7874cf3..045202b0 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -76,47 +76,47 @@ public final class BlockBreakEvents {\n \t\t\t}\n \t);\n \n-\t/* Called before a block is broken\n-\t *\n-\t * <p>Fields:\n-\t * <ul><li> world - The world at which the block is being broken\n-\t * <li> player - The player who is breaking the block\n-\t * <li> pos - The position at which the block is being broken\n-\t * <li> state - The block state from BEFORE the block is broken\n-\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n-\t */\n \t@FunctionalInterface\n \tpublic interface Before {\n+\t\t/* Called before a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world at which the block is being broken\n+\t\t * <li> player - The player who is breaking the block\n+\t\t * <li> pos - The position at which the block is being broken\n+\t\t * <li> state - The block state from BEFORE the block is broken\n+\t\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t\t */\n \t\tActionResult beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n \n-\t/* Called after a block is broken\n-\t *\n-\t * <p>Fields:\n-\t * <ul><li> world - The world where the block was broken\n-\t * <li> player - The player who broke the block\n-\t * <li> pos - The position where the block was broken\n-\t * <li> state - The block state from AFTER the block was broken\n-\t * <li> entity - The block entity of the broken block (can be null)\n-\t * <li> block - The block instance of the block that was broken</ul>\n-\t */\n \t@FunctionalInterface\n \tpublic interface After {\n+\t\t/* Called after a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was broken\n+\t\t * <li> player - The player who broke the block\n+\t\t * <li> pos - The position where the block was broken\n+\t\t * <li> state - The block state from AFTER the block was broken\n+\t\t * <li> entity - The block entity of the broken block (can be null)\n+\t\t * <li> block - The block instance of the block that was broken</ul>\n+\t\t */\n \t\tvoid afterBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n \n-\t/* Called when a block break has been canceled\n-\t *\n-\t * <p>Fields:\n-\t * <ul><li> world - The world where the block was going to be broken\n-\t * <li> player - The player was going to break the block\n-\t * <li> pos - The position where the block was going to be broken\n-\t * <li> state - The block state of the block that was going to be broken\n-\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n-\t * <li> block - The block instance of the block that was going to be broken</ul>\n-\t */\n \t@FunctionalInterface\n \tpublic interface Cancel {\n+\t\t/* Called when a block break has been canceled\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was going to be broken\n+\t\t * <li> player - The player was going to break the block\n+\t\t * <li> pos - The position where the block was going to be broken\n+\t\t * <li> state - The block state of the block that was going to be broken\n+\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n+\t\t * <li> block - The block instance of the block that was going to be broken</ul>\n+\t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n }\n"}}, {"oid": "2d81e83a379aa66281bca815a9c7493c363f7baa", "url": "https://github.com/FabricMC/fabric/commit/2d81e83a379aa66281bca815a9c7493c363f7baa", "message": "Move JavaDoc + Make success have same function as pass", "committedDate": "2020-08-03T18:07:36Z", "type": "commit"}, {"oid": "eb4bcf3d5fa5d679e351ba52b3bdf48c81729089", "url": "https://github.com/FabricMC/fabric/commit/eb4bcf3d5fa5d679e351ba52b3bdf48c81729089", "message": "Fix success bug", "committedDate": "2020-08-03T18:29:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MDgyNg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464590826", "bodyText": "Why even make this event cancellable? We alreday have the attack block callback that provides a better UX for preventing the breaking of blocks.\nI do see the need for a BlockBreakEvent that happens once the block is definitely going to be broken.", "author": "modmuss50", "createdAt": "2020-08-03T18:32:17Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS passes on the callback to the next listener\n+\t * <li>CONSUME continues the default code for breaking the block and ignores all other listeners\n+\t * <li>FAIL cancels the block breaking action</ul>", "originalCommit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5NDE2MA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464594160", "bodyText": "Logging is one use, which is useful for more than just core protect", "author": "Devan-Kerman", "createdAt": "2020-08-03T18:39:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MDgyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5NDE5Mw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464594193", "bodyText": "Hmm, how about hack clients?", "author": "liach", "createdAt": "2020-08-03T18:39:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MDgyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5NjI4MA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464596280", "bodyText": "Attack block is purely for UX, it doesn't actually prevent the breaking. As the JavaDoc on it says:\nATTACK_BLOCK does not let you control the packet sending process yet.", "author": "Geometrically", "createdAt": "2020-08-03T18:43:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MDgyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5Njg0Mg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464596842", "bodyText": "Yes, it does allow you to stop the breaking of blocks. ive used it for this exact reason.", "author": "modmuss50", "createdAt": "2020-08-03T18:45:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MDgyNg=="}], "type": "inlineReview", "revised_code": {"commit": "ba58c66061a306d34fd1013d35ce88e8364749c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex 045202b0..d14bb0ac 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -19,7 +19,6 @@ package net.fabricmc.fabric.api.event.player;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.util.ActionResult;\n import net.minecraft.util.math.BlockPos;\n import net.minecraft.world.World;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTE0NQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464591145", "bodyText": "Humm, really not a fan of this...", "author": "modmuss50", "createdAt": "2020-08-03T18:33:03Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS passes on the callback to the next listener\n+\t * <li>CONSUME continues the default code for breaking the block and ignores all other listeners\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (result != ActionResult.PASS) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.PASS;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<Cancel> CANCEL = EventFactory.createArrayBacked(Cancel.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Cancel event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);", "originalCommit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5NDcxMw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464594713", "bodyText": "This should cover the case in which a mod's block can effect a more than 3x3 like redstone dust. It's simpler than any alternative I can think of tbh", "author": "Devan-Kerman", "createdAt": "2020-08-03T18:40:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTE0NQ=="}], "type": "inlineReview", "revised_code": {"commit": "ba58c66061a306d34fd1013d35ce88e8364749c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex 045202b0..d14bb0ac 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -19,7 +19,6 @@ package net.fabricmc.fabric.api.event.player;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.util.ActionResult;\n import net.minecraft.util.math.BlockPos;\n import net.minecraft.world.World;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTQzOA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464591438", "bodyText": "the params are messsed up here.", "author": "modmuss50", "createdAt": "2020-08-03T18:33:44Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS passes on the callback to the next listener\n+\t * <li>CONSUME continues the default code for breaking the block and ignores all other listeners\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (result != ActionResult.PASS) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.PASS;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<Cancel> CANCEL = EventFactory.createArrayBacked(Cancel.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Cancel event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/* Called before a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world at which the block is being broken\n+\t\t * <li> player - The player who is breaking the block\n+\t\t * <li> pos - The position at which the block is being broken\n+\t\t * <li> state - The block state from BEFORE the block is broken\n+\t\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t\t */\n+\t\tActionResult beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface After {\n+\t\t/* Called after a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was broken\n+\t\t * <li> player - The player who broke the block\n+\t\t * <li> pos - The position where the block was broken\n+\t\t * <li> state - The block state from AFTER the block was broken\n+\t\t * <li> entity - The block entity of the broken block (can be null)\n+\t\t * <li> block - The block instance of the block that was broken</ul>", "originalCommit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDYwMDE4Mw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464600183", "bodyText": "What do you mean", "author": "Geometrically", "createdAt": "2020-08-03T18:51:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTQzOA=="}], "type": "inlineReview", "revised_code": {"commit": "ba58c66061a306d34fd1013d35ce88e8364749c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex 045202b0..d14bb0ac 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -19,7 +19,6 @@ package net.fabricmc.fabric.api.event.player;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.util.ActionResult;\n import net.minecraft.util.math.BlockPos;\n import net.minecraft.world.World;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTQ5OA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464591498", "bodyText": "and here, no block", "author": "modmuss50", "createdAt": "2020-08-03T18:33:53Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS passes on the callback to the next listener\n+\t * <li>CONSUME continues the default code for breaking the block and ignores all other listeners\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (result != ActionResult.PASS) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.PASS;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<Cancel> CANCEL = EventFactory.createArrayBacked(Cancel.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Cancel event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/* Called before a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world at which the block is being broken\n+\t\t * <li> player - The player who is breaking the block\n+\t\t * <li> pos - The position at which the block is being broken\n+\t\t * <li> state - The block state from BEFORE the block is broken\n+\t\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t\t */\n+\t\tActionResult beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface After {\n+\t\t/* Called after a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was broken\n+\t\t * <li> player - The player who broke the block\n+\t\t * <li> pos - The position where the block was broken\n+\t\t * <li> state - The block state from AFTER the block was broken\n+\t\t * <li> entity - The block entity of the broken block (can be null)\n+\t\t * <li> block - The block instance of the block that was broken</ul>\n+\t\t */\n+\t\tvoid afterBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface Cancel {\n+\t\t/* Called when a block break has been canceled\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was going to be broken\n+\t\t * <li> player - The player was going to break the block\n+\t\t * <li> pos - The position where the block was going to be broken\n+\t\t * <li> state - The block state of the block that was going to be broken\n+\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n+\t\t * <li> block - The block instance of the block that was going to be broken</ul>", "originalCommit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ba58c66061a306d34fd1013d35ce88e8364749c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex 045202b0..d14bb0ac 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -19,7 +19,6 @@ package net.fabricmc.fabric.api.event.player;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.util.ActionResult;\n import net.minecraft.util.math.BlockPos;\n import net.minecraft.world.World;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTU4NQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464591585", "bodyText": "Do we need this if you pass the world and pos? I dont think so.", "author": "modmuss50", "createdAt": "2020-08-03T18:34:06Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS passes on the callback to the next listener\n+\t * <li>CONSUME continues the default code for breaking the block and ignores all other listeners\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (result != ActionResult.PASS) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.PASS;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<Cancel> CANCEL = EventFactory.createArrayBacked(Cancel.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Cancel event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/* Called before a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world at which the block is being broken\n+\t\t * <li> player - The player who is breaking the block\n+\t\t * <li> pos - The position at which the block is being broken\n+\t\t * <li> state - The block state from BEFORE the block is broken\n+\t\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t\t */\n+\t\tActionResult beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface After {\n+\t\t/* Called after a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was broken\n+\t\t * <li> player - The player who broke the block\n+\t\t * <li> pos - The position where the block was broken\n+\t\t * <li> state - The block state from AFTER the block was broken\n+\t\t * <li> entity - The block entity of the broken block (can be null)", "originalCommit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5Mzc5Nw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464593797", "bodyText": "well, if this is available already without a get block entity call, passing this is better than not since calling get block entity has a map lookup", "author": "liach", "createdAt": "2020-08-03T18:38:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTU4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5NDM3Ng==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464594376", "bodyText": "The player and the original state are needed since the block has changed in the world then.", "author": "i509VCB", "createdAt": "2020-08-03T18:39:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTU4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5NjgzOA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464596838", "bodyText": "It's useful, as the stuff is already provided in the mixin. It's barebones not to have it and the user shouldn't have to use world.getBlockState() when the mixin already has access to that.", "author": "Geometrically", "createdAt": "2020-08-03T18:45:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTU4NQ=="}], "type": "inlineReview", "revised_code": {"commit": "ba58c66061a306d34fd1013d35ce88e8364749c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex 045202b0..d14bb0ac 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -19,7 +19,6 @@ package net.fabricmc.fabric.api.event.player;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.util.ActionResult;\n import net.minecraft.util.math.BlockPos;\n import net.minecraft.world.World;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTY0OQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464591649", "bodyText": "same again here I dont think we need this?", "author": "modmuss50", "createdAt": "2020-08-03T18:34:13Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS passes on the callback to the next listener\n+\t * <li>CONSUME continues the default code for breaking the block and ignores all other listeners\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (result != ActionResult.PASS) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.PASS;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<Cancel> CANCEL = EventFactory.createArrayBacked(Cancel.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Cancel event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/* Called before a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world at which the block is being broken\n+\t\t * <li> player - The player who is breaking the block\n+\t\t * <li> pos - The position at which the block is being broken\n+\t\t * <li> state - The block state from BEFORE the block is broken\n+\t\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t\t */\n+\t\tActionResult beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface After {\n+\t\t/* Called after a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was broken\n+\t\t * <li> player - The player who broke the block\n+\t\t * <li> pos - The position where the block was broken\n+\t\t * <li> state - The block state from AFTER the block was broken\n+\t\t * <li> entity - The block entity of the broken block (can be null)\n+\t\t * <li> block - The block instance of the block that was broken</ul>\n+\t\t */\n+\t\tvoid afterBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface Cancel {\n+\t\t/* Called when a block break has been canceled\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was going to be broken\n+\t\t * <li> player - The player was going to break the block\n+\t\t * <li> pos - The position where the block was going to be broken\n+\t\t * <li> state - The block state of the block that was going to be broken\n+\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)", "originalCommit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5NjkzNA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464596934", "bodyText": "See above.", "author": "Geometrically", "createdAt": "2020-08-03T18:45:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTY0OQ=="}], "type": "inlineReview", "revised_code": {"commit": "ba58c66061a306d34fd1013d35ce88e8364749c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex 045202b0..d14bb0ac 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -19,7 +19,6 @@ package net.fabricmc.fabric.api.event.player;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.util.ActionResult;\n import net.minecraft.util.math.BlockPos;\n import net.minecraft.world.World;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTg1Mw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464591853", "bodyText": "Why 3 interfaces? these all seem the same to me? Just make it one?", "author": "modmuss50", "createdAt": "2020-08-03T18:34:38Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS passes on the callback to the next listener\n+\t * <li>CONSUME continues the default code for breaking the block and ignores all other listeners\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (result != ActionResult.PASS) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.PASS;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<Cancel> CANCEL = EventFactory.createArrayBacked(Cancel.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Cancel event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {", "originalCommit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MzgxMw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464593813", "bodyText": "We need two interfaces minimum for an After event if someone wants to know if a block changed.", "author": "i509VCB", "createdAt": "2020-08-03T18:38:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTg1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5ODE4MA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464598180", "bodyText": "Organization and flexibility, just in case one needs to change.", "author": "Geometrically", "createdAt": "2020-08-03T18:47:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MTg1Mw=="}], "type": "inlineReview", "revised_code": {"commit": "ba58c66061a306d34fd1013d35ce88e8364749c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex 045202b0..d14bb0ac 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -19,7 +19,6 @@ package net.fabricmc.fabric.api.event.player;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.util.ActionResult;\n import net.minecraft.util.math.BlockPos;\n import net.minecraft.world.World;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MjE4Ng==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464592186", "bodyText": "Yeah, really not a fan of this, ill need to look at the vanilla code but there has to be a better way. atleast add a comment saying what it does.", "author": "modmuss50", "createdAt": "2020-08-03T18:35:13Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java", "diffHunk": "@@ -81,4 +86,30 @@ public void interactItem(ServerPlayerEntity player, World world, ItemStack stack\n \t\t\treturn;\n \t\t}\n \t}\n+\n+\t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBreak(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/entity/player/PlayerEntity;)V\"), method = \"tryBreakBlock\", locals = LocalCapture.CAPTURE_FAILHARD, cancellable = true)\n+\tprivate void breakBlock(BlockPos pos, CallbackInfoReturnable<Boolean> cir, BlockState state, BlockEntity entity, Block block) {\n+\t\tActionResult result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.world, this.player, pos, state, entity);\n+\n+\t\tif (result == ActionResult.FAIL) {\n+\t\t\tBlockBreakEvents.CANCEL.invoker().onBlockBreakCancel(this.world, this.player, pos, state, entity);\n+\n+\t\t\tBlockPos cornerPos = pos.add(-1, -1, -1);\n+\n+\t\t\tfor (int x = 0; x < 3; x++) {\n+\t\t\t\tfor (int y = 0; y < 3; y++) {\n+\t\t\t\t\tfor (int z = 0; z < 3; z++) {\n+\t\t\t\t\t\tthis.player.networkHandler.sendPacket(new BlockUpdateS2CPacket(world, cornerPos.add(x, y, z)));", "originalCommit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwMzA1NQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r466603055", "bodyText": "Geo, you need to still explain why the packets are sent if the event is canclled.", "author": "i509VCB", "createdAt": "2020-08-06T18:23:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MjE4Ng=="}], "type": "inlineReview", "revised_code": {"commit": "ba58c66061a306d34fd1013d35ce88e8364749c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\nindex fcad41de..f860cce9 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n\n@@ -89,9 +89,9 @@ public class MixinServerPlayerInteractionManager {\n \n \t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBreak(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/entity/player/PlayerEntity;)V\"), method = \"tryBreakBlock\", locals = LocalCapture.CAPTURE_FAILHARD, cancellable = true)\n \tprivate void breakBlock(BlockPos pos, CallbackInfoReturnable<Boolean> cir, BlockState state, BlockEntity entity, Block block) {\n-\t\tActionResult result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.world, this.player, pos, state, entity);\n+\t\tboolean result = BlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.world, this.player, pos, state, entity);\n \n-\t\tif (result == ActionResult.FAIL) {\n+\t\tif (!result) {\n \t\t\tBlockBreakEvents.CANCEL.invoker().onBlockBreakCancel(this.world, this.player, pos, state, entity);\n \n \t\t\tBlockPos cornerPos = pos.add(-1, -1, -1);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MjYwNQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464592605", "bodyText": "Whats the use case for this?", "author": "modmuss50", "createdAt": "2020-08-03T18:36:06Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.ActionResult;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>SUCCESS/PASS passes on the callback to the next listener\n+\t * <li>CONSUME continues the default code for breaking the block and ignores all other listeners\n+\t * <li>FAIL cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tActionResult result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (result != ActionResult.PASS) {\n+\t\t\t\t\t\treturn result;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn ActionResult.PASS;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled", "originalCommit": "2d81e83a379aa66281bca815a9c7493c363f7baa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MzQ1Mg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464593452", "bodyText": "Because mods can have blocks that need to revert more changes than the 3 by 3 by 3 volume needed by vanilla redstone dusts", "author": "liach", "createdAt": "2020-08-03T18:37:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MjYwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5NzUyNQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r464597525", "bodyText": "If a custom mod's block has an update that extends further than vanilla redstone. It is nice to have.", "author": "Geometrically", "createdAt": "2020-08-03T18:46:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU5MjYwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "ba58c66061a306d34fd1013d35ce88e8364749c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex 045202b0..d14bb0ac 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -19,7 +19,6 @@ package net.fabricmc.fabric.api.event.player;\n import net.minecraft.block.BlockState;\n import net.minecraft.block.entity.BlockEntity;\n import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.util.ActionResult;\n import net.minecraft.util.math.BlockPos;\n import net.minecraft.world.World;\n \n"}}, {"oid": "ba58c66061a306d34fd1013d35ce88e8364749c4", "url": "https://github.com/FabricMC/fabric/commit/ba58c66061a306d34fd1013d35ce88e8364749c4", "message": "Fix documentation again, change approach", "committedDate": "2020-08-03T18:54:52Z", "type": "commit"}, {"oid": "7174955516e8f3ca264cfa48963f74f3cadba82e", "url": "https://github.com/FabricMC/fabric/commit/7174955516e8f3ca264cfa48963f74f3cadba82e", "message": "Fix checkstyle", "committedDate": "2020-08-03T19:41:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNDgyNg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r465324826", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t/* Called before a block is broken\n          \n          \n            \n            \t\t *\n          \n          \n            \n            \t\t * <p>Fields:\n          \n          \n            \n            \t\t * <ul><li> world - The world at which the block is being broken\n          \n          \n            \n            \t\t * <li> player - The player who is breaking the block\n          \n          \n            \n            \t\t * <li> pos - The position at which the block is being broken\n          \n          \n            \n            \t\t * <li> state - The block state from BEFORE the block is broken\n          \n          \n            \n            \t\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n          \n          \n            \n            \t\t */\n          \n          \n            \n            \t\t/**\n          \n          \n            \n            \t\t * Called before a block is broken and allows cancelling the block breaking.\n          \n          \n            \n            \t\t *\n          \n          \n            \n            \t\t * <p>Implementations should not modify the world or assume the block break has completed or failed.</p>\n          \n          \n            \n            \t\t *\n          \n          \n            \n            \t\t * @param world the world in which the block is broken\n          \n          \n            \n            \t\t * @param player the player breaking the block\n          \n          \n            \n            \t\t * @param pos the position at which the block is broken\n          \n          \n            \n            \t\t * @param state the block state <strong>before</strong> the block is broken\n          \n          \n            \n            \t\t * @param entity the block entity <strong>before</strong> the block is broken, can be {@code null}\n          \n          \n            \n            \t\t * @return {@code false} to cancel block breaking action, or {@code true} to pass to next listener\n          \n          \n            \n            \t\t */", "author": "liach", "createdAt": "2020-08-04T20:55:25Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>`true` passes on the callback to the next listener\n+\t * <li>`false` cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<Cancel> CANCEL = EventFactory.createArrayBacked(Cancel.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Cancel event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/* Called before a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world at which the block is being broken\n+\t\t * <li> player - The player who is breaking the block\n+\t\t * <li> pos - The position at which the block is being broken\n+\t\t * <li> state - The block state from BEFORE the block is broken\n+\t\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t\t */", "originalCommit": "7174955516e8f3ca264cfa48963f74f3cadba82e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b7a1d42389d51183c51aaa313741d908cee458c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex d14bb0ac..7390f22d 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -104,14 +104,14 @@ public final class BlockBreakEvents {\n \n \t@FunctionalInterface\n \tpublic interface Cancel {\n-\t\t/* Called when a block break has been canceled\n+\t\t/**\n+\t\t * Called when a block break has been canceled.\n \t\t *\n-\t\t * <p>Fields:\n-\t\t * <ul><li> world - The world where the block was going to be broken\n-\t\t * <li> player - The player was going to break the block\n-\t\t * <li> pos - The position where the block was going to be broken\n-\t\t * <li> state - The block state of the block that was going to be broken\n-\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n+\t\t * @param world the world where the block was going to be broken\n+\t\t * @param player the player who was going to break the block\n+\t\t * @param pos the position where the block was going to be broken\n+\t\t * @param state the block state of the block that was going to be broken\n+\t\t * @param entity the block entity of the block that was going to be broken, can be {@code null}\n \t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNTk5Mg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r465325992", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t/* Called after a block is broken\n          \n          \n            \n            \t\t *\n          \n          \n            \n            \t\t * <p>Fields:\n          \n          \n            \n            \t\t * <ul><li> world - The world where the block was broken\n          \n          \n            \n            \t\t * <li> player - The player who broke the block\n          \n          \n            \n            \t\t * <li> pos - The position where the block was broken\n          \n          \n            \n            \t\t * <li> state - The block state from AFTER the block was broken\n          \n          \n            \n            \t\t * <li> entity - The block entity of the broken block (can be null)\n          \n          \n            \n            \t\t/**\n          \n          \n            \n            \t\t * Called after a block is successfully broken.\n          \n          \n            \n            \t\t *\n          \n          \n            \n            \t\t * @param world the world where the block was broken\n          \n          \n            \n            \t\t * @param player the player who broke the block\n          \n          \n            \n            \t\t * @param pos the position where the block was broken\n          \n          \n            \n            \t\t * @param state the block state <strong>after</strong> the block was broken\n          \n          \n            \n            \t\t * @param entity the block entity of the broken block, can be {@code null}", "author": "liach", "createdAt": "2020-08-04T20:57:26Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>`true` passes on the callback to the next listener\n+\t * <li>`false` cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<Cancel> CANCEL = EventFactory.createArrayBacked(Cancel.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Cancel event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/* Called before a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world at which the block is being broken\n+\t\t * <li> player - The player who is breaking the block\n+\t\t * <li> pos - The position at which the block is being broken\n+\t\t * <li> state - The block state from BEFORE the block is broken\n+\t\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t\t */\n+\t\tboolean beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface After {\n+\t\t/* Called after a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was broken\n+\t\t * <li> player - The player who broke the block\n+\t\t * <li> pos - The position where the block was broken\n+\t\t * <li> state - The block state from AFTER the block was broken\n+\t\t * <li> entity - The block entity of the broken block (can be null)", "originalCommit": "7174955516e8f3ca264cfa48963f74f3cadba82e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b7a1d42389d51183c51aaa313741d908cee458c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex d14bb0ac..7390f22d 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -104,14 +104,14 @@ public final class BlockBreakEvents {\n \n \t@FunctionalInterface\n \tpublic interface Cancel {\n-\t\t/* Called when a block break has been canceled\n+\t\t/**\n+\t\t * Called when a block break has been canceled.\n \t\t *\n-\t\t * <p>Fields:\n-\t\t * <ul><li> world - The world where the block was going to be broken\n-\t\t * <li> player - The player was going to break the block\n-\t\t * <li> pos - The position where the block was going to be broken\n-\t\t * <li> state - The block state of the block that was going to be broken\n-\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n+\t\t * @param world the world where the block was going to be broken\n+\t\t * @param player the player who was going to break the block\n+\t\t * @param pos the position where the block was going to be broken\n+\t\t * @param state the block state of the block that was going to be broken\n+\t\t * @param entity the block entity of the block that was going to be broken, can be {@code null}\n \t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNjg0NA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r465326844", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t/* Called when a block break has been canceled\n          \n          \n            \n            \t\t *\n          \n          \n            \n            \t\t * <p>Fields:\n          \n          \n            \n            \t\t * <ul><li> world - The world where the block was going to be broken\n          \n          \n            \n            \t\t * <li> player - The player was going to break the block\n          \n          \n            \n            \t\t * <li> pos - The position where the block was going to be broken\n          \n          \n            \n            \t\t * <li> state - The block state of the block that was going to be broken\n          \n          \n            \n            \t\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n          \n          \n            \n            \t\t/**\n          \n          \n            \n            \t\t * Called when a block break has been canceled.\n          \n          \n            \n            \t\t *\n          \n          \n            \n            \t\t * @param world the world where the block was going to be broken\n          \n          \n            \n            \t\t * @param player the player who was going to break the block\n          \n          \n            \n            \t\t * @param pos the position where the block was going to be broken\n          \n          \n            \n            \t\t * @param state the block state of the block that was going to be broken\n          \n          \n            \n            \t\t * @param entity the block entity of the block that was going to be broken, can be {@code null}", "author": "liach", "createdAt": "2020-08-04T20:59:15Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>`true` passes on the callback to the next listener\n+\t * <li>`false` cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<Cancel> CANCEL = EventFactory.createArrayBacked(Cancel.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Cancel event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/* Called before a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world at which the block is being broken\n+\t\t * <li> player - The player who is breaking the block\n+\t\t * <li> pos - The position at which the block is being broken\n+\t\t * <li> state - The block state from BEFORE the block is broken\n+\t\t * <li> entity - The block entity from BEFORE the block is broken (can be null)\n+\t\t */\n+\t\tboolean beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface After {\n+\t\t/* Called after a block is broken\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was broken\n+\t\t * <li> player - The player who broke the block\n+\t\t * <li> pos - The position where the block was broken\n+\t\t * <li> state - The block state from AFTER the block was broken\n+\t\t * <li> entity - The block entity of the broken block (can be null)\n+\t\t */\n+\t\tvoid afterBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface Cancel {\n+\t\t/* Called when a block break has been canceled\n+\t\t *\n+\t\t * <p>Fields:\n+\t\t * <ul><li> world - The world where the block was going to be broken\n+\t\t * <li> player - The player was going to break the block\n+\t\t * <li> pos - The position where the block was going to be broken\n+\t\t * <li> state - The block state of the block that was going to be broken\n+\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)", "originalCommit": "7174955516e8f3ca264cfa48963f74f3cadba82e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b7a1d42389d51183c51aaa313741d908cee458c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex d14bb0ac..7390f22d 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -104,14 +104,14 @@ public final class BlockBreakEvents {\n \n \t@FunctionalInterface\n \tpublic interface Cancel {\n-\t\t/* Called when a block break has been canceled\n+\t\t/**\n+\t\t * Called when a block break has been canceled.\n \t\t *\n-\t\t * <p>Fields:\n-\t\t * <ul><li> world - The world where the block was going to be broken\n-\t\t * <li> player - The player was going to break the block\n-\t\t * <li> pos - The position where the block was going to be broken\n-\t\t * <li> state - The block state of the block that was going to be broken\n-\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n+\t\t * @param world the world where the block was going to be broken\n+\t\t * @param player the player who was going to break the block\n+\t\t * @param pos the position where the block was going to be broken\n+\t\t * @param state the block state of the block that was going to be broken\n+\t\t * @param entity the block entity of the block that was going to be broken, can be {@code null}\n \t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNzcxMw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r465327713", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t/*\n          \n          \n            \n            \t * Callback when a block break has been canceled\n          \n          \n            \n            \t * Called on the Server only\n          \n          \n            \n            \t/**\n          \n          \n            \n            \t * Callback when a block break has been canceled.\n          \n          \n            \n            \t * \n          \n          \n            \n            \t * <p>Called on the logical server only. May be used to send packets to revert client-side block changes.</p>", "author": "liach", "createdAt": "2020-08-04T21:00:54Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>`true` passes on the callback to the next listener\n+\t * <li>`false` cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback when a block break has been canceled\n+\t * Called on the Server only", "originalCommit": "7174955516e8f3ca264cfa48963f74f3cadba82e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b7a1d42389d51183c51aaa313741d908cee458c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex d14bb0ac..7390f22d 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -104,14 +104,14 @@ public final class BlockBreakEvents {\n \n \t@FunctionalInterface\n \tpublic interface Cancel {\n-\t\t/* Called when a block break has been canceled\n+\t\t/**\n+\t\t * Called when a block break has been canceled.\n \t\t *\n-\t\t * <p>Fields:\n-\t\t * <ul><li> world - The world where the block was going to be broken\n-\t\t * <li> player - The player was going to break the block\n-\t\t * <li> pos - The position where the block was going to be broken\n-\t\t * <li> state - The block state of the block that was going to be broken\n-\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n+\t\t * @param world the world where the block was going to be broken\n+\t\t * @param player the player who was going to break the block\n+\t\t * @param pos the position where the block was going to be broken\n+\t\t * @param state the block state of the block that was going to be broken\n+\t\t * @param entity the block entity of the block that was going to be broken, can be {@code null}\n \t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNzk1MQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r465327951", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t/*\n          \n          \n            \n            \t * Callback after a block is broken.\n          \n          \n            \n            \t * Called on the Server only\n          \n          \n            \n            \t */\n          \n          \n            \n            \t/**\n          \n          \n            \n            \t * Callback after a block is broken.\n          \n          \n            \n            \t * \n          \n          \n            \n            \t * <p>Called on the Server only.</p>\n          \n          \n            \n            \t */", "author": "liach", "createdAt": "2020-08-04T21:01:24Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>`true` passes on the callback to the next listener\n+\t * <li>`false` cancels the block breaking action</ul>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/*\n+\t * Callback after a block is broken.\n+\t * Called on the Server only\n+\t */", "originalCommit": "7174955516e8f3ca264cfa48963f74f3cadba82e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b7a1d42389d51183c51aaa313741d908cee458c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex d14bb0ac..7390f22d 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -104,14 +104,14 @@ public final class BlockBreakEvents {\n \n \t@FunctionalInterface\n \tpublic interface Cancel {\n-\t\t/* Called when a block break has been canceled\n+\t\t/**\n+\t\t * Called when a block break has been canceled.\n \t\t *\n-\t\t * <p>Fields:\n-\t\t * <ul><li> world - The world where the block was going to be broken\n-\t\t * <li> player - The player was going to break the block\n-\t\t * <li> pos - The position where the block was going to be broken\n-\t\t * <li> state - The block state of the block that was going to be broken\n-\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n+\t\t * @param world the world where the block was going to be broken\n+\t\t * @param player the player who was going to break the block\n+\t\t * @param pos the position where the block was going to be broken\n+\t\t * @param state the block state of the block that was going to be broken\n+\t\t * @param entity the block entity of the block that was going to be broken, can be {@code null}\n \t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyOTM1MQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r465329351", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * <p>Upon return:\n          \n          \n            \n            \t * <ul><li>`true` passes on the callback to the next listener\n          \n          \n            \n            \t * <li>`false` cancels the block breaking action</ul>\n          \n          \n            \n            \t * <p>If any listener cancels a block breaking action, that block breaking\n          \n          \n            \n            \t * action is cancelled and {@link CANCEL} event is fired. Otherwise, the\n          \n          \n            \n            \t * {@link AFTER} event is fired.</p>\n          \n      \n    \n    \n  \n\nReturn value described in method already", "author": "liach", "createdAt": "2020-08-04T21:04:24Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>Upon return:\n+\t * <ul><li>`true` passes on the callback to the next listener\n+\t * <li>`false` cancels the block breaking action</ul>", "originalCommit": "7174955516e8f3ca264cfa48963f74f3cadba82e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b7a1d42389d51183c51aaa313741d908cee458c4", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex d14bb0ac..7390f22d 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -104,14 +104,14 @@ public final class BlockBreakEvents {\n \n \t@FunctionalInterface\n \tpublic interface Cancel {\n-\t\t/* Called when a block break has been canceled\n+\t\t/**\n+\t\t * Called when a block break has been canceled.\n \t\t *\n-\t\t * <p>Fields:\n-\t\t * <ul><li> world - The world where the block was going to be broken\n-\t\t * <li> player - The player was going to break the block\n-\t\t * <li> pos - The position where the block was going to be broken\n-\t\t * <li> state - The block state of the block that was going to be broken\n-\t\t * <li> entity - The block entity of the block that was going to be broken (can be null)\n+\t\t * @param world the world where the block was going to be broken\n+\t\t * @param player the player who was going to break the block\n+\t\t * @param pos the position where the block was going to be broken\n+\t\t * @param state the block state of the block that was going to be broken\n+\t\t * @param entity the block entity of the block that was going to be broken, can be {@code null}\n \t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n \t}\n"}}, {"oid": "b7a1d42389d51183c51aaa313741d908cee458c4", "url": "https://github.com/FabricMC/fabric/commit/b7a1d42389d51183c51aaa313741d908cee458c4", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\nCo-authored-by: liach <7806504+liach@users.noreply.github.com>", "committedDate": "2020-08-04T21:08:03Z", "type": "commit"}, {"oid": "6bc1f00eb978244b76b0de1761481b291fdef168", "url": "https://github.com/FabricMC/fabric/commit/6bc1f00eb978244b76b0de1761481b291fdef168", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\nCo-authored-by: liach <7806504+liach@users.noreply.github.com>", "committedDate": "2020-08-04T21:08:11Z", "type": "commit"}, {"oid": "f7edf7527baf4c080588d3fafff43eab52684f83", "url": "https://github.com/FabricMC/fabric/commit/f7edf7527baf4c080588d3fafff43eab52684f83", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\nCo-authored-by: liach <7806504+liach@users.noreply.github.com>", "committedDate": "2020-08-04T21:08:22Z", "type": "commit"}, {"oid": "c1ba20c50d8b53cfce37dc0919beb85484f6bd03", "url": "https://github.com/FabricMC/fabric/commit/c1ba20c50d8b53cfce37dc0919beb85484f6bd03", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\nCo-authored-by: liach <7806504+liach@users.noreply.github.com>", "committedDate": "2020-08-04T21:08:32Z", "type": "commit"}, {"oid": "dd887c8c97b9c915c3e2dd744de6258a50f2a7f9", "url": "https://github.com/FabricMC/fabric/commit/dd887c8c97b9c915c3e2dd744de6258a50f2a7f9", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\nCo-authored-by: liach <7806504+liach@users.noreply.github.com>", "committedDate": "2020-08-04T21:08:41Z", "type": "commit"}, {"oid": "49039a3c83cd696b02cbcc6120a83dd194b20749", "url": "https://github.com/FabricMC/fabric/commit/49039a3c83cd696b02cbcc6120a83dd194b20749", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\nCo-authored-by: liach <7806504+liach@users.noreply.github.com>", "committedDate": "2020-08-04T21:08:49Z", "type": "commit"}, {"oid": "8df6d36e2a57987499863b9343f9fb659e20a9c8", "url": "https://github.com/FabricMC/fabric/commit/8df6d36e2a57987499863b9343f9fb659e20a9c8", "message": "Fix checkstyle", "committedDate": "2020-08-04T21:16:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMzNTIxMw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r465335213", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * \n          \n          \n            \n            \t *", "author": "liach", "createdAt": "2020-08-04T21:16:20Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>If any listener cancels a block breaking action, that block breaking\n+\t * action is cancelled and {@link CANCEL} event is fired. Otherwise, the\n+\t * {@link AFTER} event is fired.</p>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t * ", "originalCommit": "49039a3c83cd696b02cbcc6120a83dd194b20749", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8df6d36e2a57987499863b9343f9fb659e20a9c8", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nindex b1378a16..f5a6cf62 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n\n@@ -52,7 +52,7 @@ public final class BlockBreakEvents {\n \n \t/**\n \t * Callback after a block is broken.\n-\t * \n+\t *\n \t * <p>Called on the Server only.</p>\n \t */\n \tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMzNTI1Mw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r465335253", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * \n          \n          \n            \n            \t *", "author": "liach", "createdAt": "2020-08-04T21:16:25Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class BlockBreakEvents {\n+\tprivate BlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>If any listener cancels a block breaking action, that block breaking\n+\t * action is cancelled and {@link CANCEL} event is fired. Otherwise, the\n+\t * {@link AFTER} event is fired.</p>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t * \n+\t * <p>Called on the Server only.</p>\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback when a block break has been canceled.\n+\t * ", "originalCommit": "49039a3c83cd696b02cbcc6120a83dd194b20749", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMzNTcxOA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r465335718", "bodyText": "I fixed in last commit", "author": "Geometrically", "createdAt": "2020-08-04T21:17:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMzNTI1Mw=="}], "type": "inlineReview", "revised_code": {"commit": "da0c4f43b351eb40bbd9131c5591b4b33a9cc7be", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\nsimilarity index 92%\nrename from fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\nrename to fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\nindex b1378a16..4f0c2224 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/BlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n\n@@ -25,15 +25,15 @@ import net.minecraft.world.World;\n import net.fabricmc.fabric.api.event.Event;\n import net.fabricmc.fabric.api.event.EventFactory;\n \n-public final class BlockBreakEvents {\n-\tprivate BlockBreakEvents() { }\n+public final class PlayerBlockBreakEvents {\n+\tprivate PlayerBlockBreakEvents() { }\n \n \t/**\n \t * Callback before a block is broken.\n \t * Only called on the server, however updates are synced with the client.\n \t *\n \t * <p>If any listener cancels a block breaking action, that block breaking\n-\t * action is cancelled and {@link CANCEL} event is fired. Otherwise, the\n+\t * action is cancelled and {@link CANCELED} event is fired. Otherwise, the\n \t * {@link AFTER} event is fired.</p>\n \t */\n \tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n"}}, {"oid": "da0c4f43b351eb40bbd9131c5591b4b33a9cc7be", "url": "https://github.com/FabricMC/fabric/commit/da0c4f43b351eb40bbd9131c5591b4b33a9cc7be", "message": "Rename stuff", "committedDate": "2020-08-05T19:55:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwMDM3Ng==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r466600376", "bodyText": "Wouldn't it be more useful to provide the state of the block that was broken as anyone who wants to query the currently state can get it from the world.\nOr is this a mistake in javadoc as the the state from impl seems to be from local capture", "author": "i509VCB", "createdAt": "2020-08-06T18:18:15Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class PlayerBlockBreakEvents {\n+\tprivate PlayerBlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>If any listener cancels a block breaking action, that block breaking\n+\t * action is cancelled and {@link CANCELED} event is fired. Otherwise, the\n+\t * {@link AFTER} event is fired.</p>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t *\n+\t * <p>Called on the Server only.</p>\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback when a block break has been canceled.\n+\t *\n+\t * <p>Called on the logical server only. May be used to send packets to revert client-side block changes.</p>\n+\t */\n+\tpublic static final Event<Canceled> CANCELED = EventFactory.createArrayBacked(Canceled.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Canceled event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/**\n+\t\t * Called before a block is broken and allows cancelling the block breaking.\n+\t\t *\n+\t\t * <p>Implementations should not modify the world or assume the block break has completed or failed.</p>\n+\t\t *\n+\t\t * @param world the world in which the block is broken\n+\t\t * @param player the player breaking the block\n+\t\t * @param pos the position at which the block is broken\n+\t\t * @param state the block state <strong>before</strong> the block is broken\n+\t\t * @param entity the block entity <strong>before</strong> the block is broken, can be {@code null}\n+\t\t * @return {@code false} to cancel block breaking action, or {@code true} to pass to next listener\n+\t\t */\n+\t\tboolean beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface After {\n+\t\t/**\n+\t\t * Called after a block is successfully broken.\n+\t\t *\n+\t\t * @param world the world where the block was broken\n+\t\t * @param player the player who broke the block\n+\t\t * @param pos the position where the block was broken\n+\t\t * @param state the block state <strong>after</strong> the block was broken", "originalCommit": "da0c4f43b351eb40bbd9131c5591b4b33a9cc7be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA4NDcyOQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r467084729", "bodyText": "The state is from before the block is broken, thanks for saying, changing javadoc now", "author": "Geometrically", "createdAt": "2020-08-07T14:42:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwMDM3Ng=="}], "type": "inlineReview", "revised_code": {"commit": "d95bb88eb184b0c811295b1052f969c89e8440e5", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\nindex 4f0c2224..11e1065f 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n\n@@ -87,10 +87,10 @@ public final class PlayerBlockBreakEvents {\n \t\t * @param player the player breaking the block\n \t\t * @param pos the position at which the block is broken\n \t\t * @param state the block state <strong>before</strong> the block is broken\n-\t\t * @param entity the block entity <strong>before</strong> the block is broken, can be {@code null}\n+\t\t * @param blockEntity the block entity <strong>before</strong> the block is broken, can be {@code null}\n \t\t * @return {@code false} to cancel block breaking action, or {@code true} to pass to next listener\n \t\t */\n-\t\tboolean beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t\tboolean beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity blockEntity);\n \t}\n \n \t@FunctionalInterface\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwMjM5MQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r466602391", "bodyText": "Parameter should be blockEntity  on all of these methods", "author": "i509VCB", "createdAt": "2020-08-06T18:22:03Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class PlayerBlockBreakEvents {\n+\tprivate PlayerBlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>If any listener cancels a block breaking action, that block breaking\n+\t * action is cancelled and {@link CANCELED} event is fired. Otherwise, the\n+\t * {@link AFTER} event is fired.</p>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t *\n+\t * <p>Called on the Server only.</p>\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback when a block break has been canceled.\n+\t *\n+\t * <p>Called on the logical server only. May be used to send packets to revert client-side block changes.</p>\n+\t */\n+\tpublic static final Event<Canceled> CANCELED = EventFactory.createArrayBacked(Canceled.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Canceled event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/**\n+\t\t * Called before a block is broken and allows cancelling the block breaking.\n+\t\t *\n+\t\t * <p>Implementations should not modify the world or assume the block break has completed or failed.</p>\n+\t\t *\n+\t\t * @param world the world in which the block is broken\n+\t\t * @param player the player breaking the block\n+\t\t * @param pos the position at which the block is broken\n+\t\t * @param state the block state <strong>before</strong> the block is broken\n+\t\t * @param entity the block entity <strong>before</strong> the block is broken, can be {@code null}", "originalCommit": "da0c4f43b351eb40bbd9131c5591b4b33a9cc7be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA4NTg4OQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r467085889", "bodyText": "fixing", "author": "Geometrically", "createdAt": "2020-08-07T14:44:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwMjM5MQ=="}], "type": "inlineReview", "revised_code": {"commit": "d95bb88eb184b0c811295b1052f969c89e8440e5", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\nindex 4f0c2224..11e1065f 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n\n@@ -87,10 +87,10 @@ public final class PlayerBlockBreakEvents {\n \t\t * @param player the player breaking the block\n \t\t * @param pos the position at which the block is broken\n \t\t * @param state the block state <strong>before</strong> the block is broken\n-\t\t * @param entity the block entity <strong>before</strong> the block is broken, can be {@code null}\n+\t\t * @param blockEntity the block entity <strong>before</strong> the block is broken, can be {@code null}\n \t\t * @return {@code false} to cancel block breaking action, or {@code true} to pass to next listener\n \t\t */\n-\t\tboolean beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity entity);\n+\t\tboolean beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity blockEntity);\n \t}\n \n \t@FunctionalInterface\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwMzkyMg==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r466603922", "bodyText": "Since the cancel event is fired first before the normal vanilla packet, wouldn't this cause a double update on some blocks?\nMaybe only call vanilla logic if the result of cancel even explicitly says to fallback to vanilla logic (likely true return value).", "author": "i509VCB", "createdAt": "2020-08-06T18:24:45Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java", "diffHunk": "@@ -81,4 +86,30 @@ public void interactItem(ServerPlayerEntity player, World world, ItemStack stack\n \t\t\treturn;\n \t\t}\n \t}\n+\n+\t@Inject(at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onBreak(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/entity/player/PlayerEntity;)V\"), method = \"tryBreakBlock\", locals = LocalCapture.CAPTURE_FAILHARD, cancellable = true)\n+\tprivate void breakBlock(BlockPos pos, CallbackInfoReturnable<Boolean> cir, BlockState state, BlockEntity entity, Block block) {\n+\t\tboolean result = PlayerBlockBreakEvents.BEFORE.invoker().beforeBlockBreak(this.world, this.player, pos, state, entity);\n+\n+\t\tif (!result) {\n+\t\t\tPlayerBlockBreakEvents.CANCELED.invoker().onBlockBreakCancel(this.world, this.player, pos, state, entity);", "originalCommit": "da0c4f43b351eb40bbd9131c5591b4b33a9cc7be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA4NTc1OQ==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r467085759", "bodyText": "The double update is fine. This is for modded blocks which would need the update to extend further than a three by three, since the client thinks the block was broken.", "author": "Geometrically", "createdAt": "2020-08-07T14:43:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwMzkyMg=="}], "type": "inlineReview", "revised_code": {"commit": "d95bb88eb184b0c811295b1052f969c89e8440e5", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\nindex b61668ca..a28176e7 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/mixin/event/interaction/MixinServerPlayerInteractionManager.java\n\n@@ -94,16 +94,6 @@ public class MixinServerPlayerInteractionManager {\n \t\tif (!result) {\n \t\t\tPlayerBlockBreakEvents.CANCELED.invoker().onBlockBreakCancel(this.world, this.player, pos, state, entity);\n \n-\t\t\tBlockPos cornerPos = pos.add(-1, -1, -1);\n-\n-\t\t\tfor (int x = 0; x < 3; x++) {\n-\t\t\t\tfor (int y = 0; y < 3; y++) {\n-\t\t\t\t\tfor (int z = 0; z < 3; z++) {\n-\t\t\t\t\t\tthis.player.networkHandler.sendPacket(new BlockUpdateS2CPacket(world, cornerPos.add(x, y, z)));\n-\t\t\t\t\t}\n-\t\t\t\t}\n-\t\t\t}\n-\n \t\t\tcir.setReturnValue(false);\n \t\t}\n \t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwNDcyMA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r466604720", "bodyText": "I'd argue this should be named PlayerBreakBlockTests since we can introduce more entrypoints for future events.", "author": "i509VCB", "createdAt": "2020-08-06T18:26:08Z", "path": "fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.test.event.interaction;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.block.Blocks;\n+\n+import net.fabricmc.api.ModInitializer;\n+import net.fabricmc.fabric.api.event.player.PlayerBlockBreakEvents;\n+\n+public class InteractionEventsTest implements ModInitializer {", "originalCommit": "da0c4f43b351eb40bbd9131c5591b4b33a9cc7be", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d95bb88eb184b0c811295b1052f969c89e8440e5", "chunk": "diff --git a/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java b/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/PlayerBreakBlockTests.java\nsimilarity index 93%\nrename from fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java\nrename to fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/PlayerBreakBlockTests.java\nindex 3343b0a8..402cadc2 100644\n--- a/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/InteractionEventsTest.java\n+++ b/fabric-events-interaction-v0/src/testmod/java/net/fabricmc/fabric/test/event/interaction/PlayerBreakBlockTests.java\n\n@@ -24,13 +24,13 @@ import net.minecraft.block.Blocks;\n import net.fabricmc.api.ModInitializer;\n import net.fabricmc.fabric.api.event.player.PlayerBlockBreakEvents;\n \n-public class InteractionEventsTest implements ModInitializer {\n+public class PlayerBreakBlockTests implements ModInitializer {\n \tpublic static final Logger LOGGER = LogManager.getLogger(\"InteractionEventsTest\");\n \n \t@Override\n \tpublic void onInitialize() {\n \t\tPlayerBlockBreakEvents.BEFORE.register(((world, player, pos, state, entity) -> {\n-\t\t\treturn state.getBlock() == Blocks.BEDROCK;\n+\t\t\treturn state.getBlock() != Blocks.BEDROCK;\n \t\t}));\n \n \t\tPlayerBlockBreakEvents.CANCELED.register(((world, player, pos, state, entity) -> {\n"}}, {"oid": "d95bb88eb184b0c811295b1052f969c89e8440e5", "url": "https://github.com/FabricMC/fabric/commit/d95bb88eb184b0c811295b1052f969c89e8440e5", "message": "fixes", "committedDate": "2020-08-07T15:43:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY1MjQ3Nw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r467652477", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * <p>Called on the Server only.</p>\n          \n          \n            \n            \t * <p>Only called on a logical server.\n          \n      \n    \n    \n  \n\nYou can omit the closing </p> in the style but it isn't required of course", "author": "i509VCB", "createdAt": "2020-08-10T01:04:35Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class PlayerBlockBreakEvents {\n+\tprivate PlayerBlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>If any listener cancels a block breaking action, that block breaking\n+\t * action is cancelled and {@link CANCELED} event is fired. Otherwise, the\n+\t * {@link AFTER} event is fired.</p>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t *\n+\t * <p>Called on the Server only.</p>", "originalCommit": "d95bb88eb184b0c811295b1052f969c89e8440e5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "94437bb441fe8bd7ebe852b8560d01a9eb697d3f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\nindex 11e1065f..a42a5489 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n\n@@ -116,7 +116,7 @@ public final class PlayerBlockBreakEvents {\n \t\t * @param player the player who was going to break the block\n \t\t * @param pos the position where the block was going to be broken\n \t\t * @param state the block state of the block that was going to be broken\n-\t\t * @param blockEntity  entity the block entity of the block that was going to be broken, can be {@code null}\n+\t\t * @param blockEntity the block entity of the block that was going to be broken, can be {@code null}\n \t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity blockEntity);\n \t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY1MjUzNw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r467652537", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * <p>Called on the logical server only. May be used to send packets to revert client-side block changes.</p>\n          \n          \n            \n            \t * <p>Only called on a logical server. May be used to send packets to revert client-side block changes.", "author": "i509VCB", "createdAt": "2020-08-10T01:05:08Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class PlayerBlockBreakEvents {\n+\tprivate PlayerBlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>If any listener cancels a block breaking action, that block breaking\n+\t * action is cancelled and {@link CANCELED} event is fired. Otherwise, the\n+\t * {@link AFTER} event is fired.</p>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t *\n+\t * <p>Called on the Server only.</p>\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback when a block break has been canceled.\n+\t *\n+\t * <p>Called on the logical server only. May be used to send packets to revert client-side block changes.</p>", "originalCommit": "d95bb88eb184b0c811295b1052f969c89e8440e5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "94437bb441fe8bd7ebe852b8560d01a9eb697d3f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\nindex 11e1065f..a42a5489 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n\n@@ -116,7 +116,7 @@ public final class PlayerBlockBreakEvents {\n \t\t * @param player the player who was going to break the block\n \t\t * @param pos the position where the block was going to be broken\n \t\t * @param state the block state of the block that was going to be broken\n-\t\t * @param blockEntity  entity the block entity of the block that was going to be broken, can be {@code null}\n+\t\t * @param blockEntity the block entity of the block that was going to be broken, can be {@code null}\n \t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity blockEntity);\n \t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY1MjYxNw==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r467652617", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t * @param blockEntity  entity the block entity of the block that was going to be broken, can be {@code null}\n          \n          \n            \n            \t\t * @param blockEntity the block entity of the block that was going to be broken, can be {@code null}", "author": "i509VCB", "createdAt": "2020-08-10T01:05:41Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.event.player;\n+\n+import net.minecraft.block.BlockState;\n+import net.minecraft.block.entity.BlockEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+public final class PlayerBlockBreakEvents {\n+\tprivate PlayerBlockBreakEvents() { }\n+\n+\t/**\n+\t * Callback before a block is broken.\n+\t * Only called on the server, however updates are synced with the client.\n+\t *\n+\t * <p>If any listener cancels a block breaking action, that block breaking\n+\t * action is cancelled and {@link CANCELED} event is fired. Otherwise, the\n+\t * {@link AFTER} event is fired.</p>\n+\t */\n+\tpublic static final Event<Before> BEFORE = EventFactory.createArrayBacked(Before.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Before event : listeners) {\n+\t\t\t\t\tboolean result = event.beforeBlockBreak(world, player, pos, state, entity);\n+\n+\t\t\t\t\tif (!result) {\n+\t\t\t\t\t\treturn false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback after a block is broken.\n+\t *\n+\t * <p>Called on the Server only.</p>\n+\t */\n+\tpublic static final Event<After> AFTER = EventFactory.createArrayBacked(After.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (After event : listeners) {\n+\t\t\t\t\tevent.afterBlockBreak(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t/**\n+\t * Callback when a block break has been canceled.\n+\t *\n+\t * <p>Called on the logical server only. May be used to send packets to revert client-side block changes.</p>\n+\t */\n+\tpublic static final Event<Canceled> CANCELED = EventFactory.createArrayBacked(Canceled.class,\n+\t\t\t(listeners) -> (world, player, pos, state, entity) -> {\n+\t\t\t\tfor (Canceled event : listeners) {\n+\t\t\t\t\tevent.onBlockBreakCancel(world, player, pos, state, entity);\n+\t\t\t\t}\n+\t\t\t}\n+\t);\n+\n+\t@FunctionalInterface\n+\tpublic interface Before {\n+\t\t/**\n+\t\t * Called before a block is broken and allows cancelling the block breaking.\n+\t\t *\n+\t\t * <p>Implementations should not modify the world or assume the block break has completed or failed.</p>\n+\t\t *\n+\t\t * @param world the world in which the block is broken\n+\t\t * @param player the player breaking the block\n+\t\t * @param pos the position at which the block is broken\n+\t\t * @param state the block state <strong>before</strong> the block is broken\n+\t\t * @param blockEntity the block entity <strong>before</strong> the block is broken, can be {@code null}\n+\t\t * @return {@code false} to cancel block breaking action, or {@code true} to pass to next listener\n+\t\t */\n+\t\tboolean beforeBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity blockEntity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface After {\n+\t\t/**\n+\t\t * Called after a block is successfully broken.\n+\t\t *\n+\t\t * @param world the world where the block was broken\n+\t\t * @param player the player who broke the block\n+\t\t * @param pos the position where the block was broken\n+\t\t * @param state the block state <strong>before</strong> the block was broken\n+\t\t * @param blockEntity the block entity of the broken block, can be {@code null}\n+\t\t */\n+\t\tvoid afterBlockBreak(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity blockEntity);\n+\t}\n+\n+\t@FunctionalInterface\n+\tpublic interface Canceled {\n+\t\t/**\n+\t\t * Called when a block break has been canceled.\n+\t\t *\n+\t\t * @param world the world where the block was going to be broken\n+\t\t * @param player the player who was going to break the block\n+\t\t * @param pos the position where the block was going to be broken\n+\t\t * @param state the block state of the block that was going to be broken\n+\t\t * @param blockEntity  entity the block entity of the block that was going to be broken, can be {@code null}", "originalCommit": "d95bb88eb184b0c811295b1052f969c89e8440e5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "94437bb441fe8bd7ebe852b8560d01a9eb697d3f", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\nindex 11e1065f..a42a5489 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n\n@@ -116,7 +116,7 @@ public final class PlayerBlockBreakEvents {\n \t\t * @param player the player who was going to break the block\n \t\t * @param pos the position where the block was going to be broken\n \t\t * @param state the block state of the block that was going to be broken\n-\t\t * @param blockEntity  entity the block entity of the block that was going to be broken, can be {@code null}\n+\t\t * @param blockEntity the block entity of the block that was going to be broken, can be {@code null}\n \t\t */\n \t\tvoid onBlockBreakCancel(World world, PlayerEntity player, BlockPos pos, BlockState state, /* Nullable */ BlockEntity blockEntity);\n \t}\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY1MjY5MA==", "url": "https://github.com/FabricMC/fabric/pull/980#discussion_r467652690", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t* It is in a 3x3 area due to how vanilla redstone handles updates, as it considers\n          \n          \n            \n            \t\t* This covers a 3x3 area due to how vanilla redstone handles updates, as it considers", "author": "i509VCB", "createdAt": "2020-08-10T01:06:33Z", "path": "fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/impl/event/interaction/InteractionEventsRouter.java", "diffHunk": "@@ -41,5 +45,22 @@ public void onInitialize() {\n \n \t\t\treturn ActionResult.PASS;\n \t\t});\n+\n+\t\t/*\n+\t\t* This code is for telling the client that the block wasn't actually broken.\n+\t\t* It is in a 3x3 area due to how vanilla redstone handles updates, as it considers", "originalCommit": "d95bb88eb184b0c811295b1052f969c89e8440e5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f62b978c6fec1cf526fb47b1e2b3eef0565f7ed6", "chunk": "diff --git a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/impl/event/interaction/InteractionEventsRouter.java b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/impl/event/interaction/InteractionEventsRouter.java\nindex b7cfbb96..6b5d28cc 100644\n--- a/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/impl/event/interaction/InteractionEventsRouter.java\n+++ b/fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/impl/event/interaction/InteractionEventsRouter.java\n\n@@ -48,7 +48,7 @@ public class InteractionEventsRouter implements ModInitializer {\n \n \t\t/*\n \t\t* This code is for telling the client that the block wasn't actually broken.\n-\t\t* It is in a 3x3 area due to how vanilla redstone handles updates, as it considers\n+\t\t* This covers a 3x3 area due to how vanilla redstone handles updates, as it considers\n \t\t* important functions like quasi-connectivity and redstone dust logic\n \t\t */\n \t\tPlayerBlockBreakEvents.CANCELED.register(((world, player, pos, state, blockEntity) -> {\n"}}, {"oid": "94437bb441fe8bd7ebe852b8560d01a9eb697d3f", "url": "https://github.com/FabricMC/fabric/commit/94437bb441fe8bd7ebe852b8560d01a9eb697d3f", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n\nCo-authored-by: i509VCB <i509vcb@gmail.com>", "committedDate": "2020-08-10T01:10:22Z", "type": "commit"}, {"oid": "7c486a335ec54dd33bc9281f291f11d1d9683c18", "url": "https://github.com/FabricMC/fabric/commit/7c486a335ec54dd33bc9281f291f11d1d9683c18", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n\nCo-authored-by: i509VCB <i509vcb@gmail.com>", "committedDate": "2020-08-10T01:10:35Z", "type": "commit"}, {"oid": "f62b978c6fec1cf526fb47b1e2b3eef0565f7ed6", "url": "https://github.com/FabricMC/fabric/commit/f62b978c6fec1cf526fb47b1e2b3eef0565f7ed6", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/impl/event/interaction/InteractionEventsRouter.java\n\nCo-authored-by: i509VCB <i509vcb@gmail.com>", "committedDate": "2020-08-10T01:10:43Z", "type": "commit"}, {"oid": "1f752be122e0643bf89d5f2399c9d2b466f5f244", "url": "https://github.com/FabricMC/fabric/commit/1f752be122e0643bf89d5f2399c9d2b466f5f244", "message": "Update fabric-events-interaction-v0/src/main/java/net/fabricmc/fabric/api/event/player/PlayerBlockBreakEvents.java\n\nCo-authored-by: i509VCB <i509vcb@gmail.com>", "committedDate": "2020-08-10T01:10:59Z", "type": "commit"}, {"oid": "34108255e77e11438696096b2a61c9c8655c1f9c", "url": "https://github.com/FabricMC/fabric/commit/34108255e77e11438696096b2a61c9c8655c1f9c", "message": "Rename Canceled Event Method Name", "committedDate": "2020-08-12T03:46:49Z", "type": "commit"}]}