{"pr_number": 733, "pr_title": "Make getTeambySlug faster", "pr_createdAt": "2020-03-09T15:23:38Z", "pr_url": "https://github.com/hub4j/github-api/pull/733", "timeline": [{"oid": "fbf6c7322605f899dbbf3a7e81643f8d60a8ae6a", "url": "https://github.com/hub4j/github-api/commit/fbf6c7322605f899dbbf3a7e81643f8d60a8ae6a", "message": "Make getTeambySlug fast enought", "committedDate": "2020-03-09T15:04:01Z", "type": "commit"}, {"oid": "2e25f37433e3aaa98ed2b3bb904a6dceaf86310b", "url": "https://github.com/hub4j/github-api/commit/2e25f37433e3aaa98ed2b3bb904a6dceaf86310b", "message": "Format code", "committedDate": "2020-03-09T15:39:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI2NDMxMA==", "url": "https://github.com/hub4j/github-api/pull/733#discussion_r393264310", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @deprecated Use {@link GHOrganization#getTeam(int)}\n          \n          \n            \n                 * @deprecated Use {@link GHOrganization#getTeam(int)} \n          \n          \n            \n                 * @see <a href= \"https://developer.github.com/v3/teams/#get-team-legacy\">deprecation notice</a>", "author": "bitwiseman", "createdAt": "2020-03-16T19:31:32Z", "path": "src/main/java/org/kohsuke/github/GitHub.java", "diffHunk": "@@ -724,7 +724,10 @@ public GHLicense getLicense(String key) throws IOException {\n      * @return the team\n      * @throws IOException\n      *             the io exception\n+     * \n+     * @deprecated Use {@link GHOrganization#getTeam(int)}", "originalCommit": "2e25f37433e3aaa98ed2b3bb904a6dceaf86310b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9213f80435a1a9d6a0532b260895641a9cd700cf", "chunk": "diff --git a/src/main/java/org/kohsuke/github/GitHub.java b/src/main/java/org/kohsuke/github/GitHub.java\nindex 9d1c66eb3..f0451362c 100644\n--- a/src/main/java/org/kohsuke/github/GitHub.java\n+++ b/src/main/java/org/kohsuke/github/GitHub.java\n\n@@ -725,7 +725,8 @@ public class GitHub {\n      * @throws IOException\n      *             the io exception\n      * \n-     * @deprecated Use {@link GHOrganization#getTeam(int)}\n+     * @deprecated Use {@link GHOrganization#getTeam(int)} \n+     * @see <a href= \"https://developer.github.com/v3/teams/#get-team-legacy\">deprecation notice</a>\n      */\n     @Deprecated\n     public GHTeam getTeam(int id) throws IOException {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI2NTIxOQ==", "url": "https://github.com/hub4j/github-api/pull/733#discussion_r393265219", "bodyText": "This is great!  But you'll need to update the test data for this test.  See CONTRIBUTING.md.", "author": "bitwiseman", "createdAt": "2020-03-16T19:33:23Z", "path": "src/main/java/org/kohsuke/github/GHOrganization.java", "diffHunk": "@@ -147,19 +165,19 @@ public GHTeam getTeamByName(String name) throws IOException {\n \n     /**\n      * Finds a team that has the given slug in its {@link GHTeam#getSlug()}\n-     *\n+     * \n      * @param slug\n      *            the slug\n      * @return the team by slug\n      * @throws IOException\n      *             the io exception\n+     * @see <a href= \"https://developer.github.com/v3/teams/#get-team-by-name\">documentation</a>\n      */\n     public GHTeam getTeamBySlug(String slug) throws IOException {\n-        for (GHTeam t : listTeams()) {\n-            if (t.getSlug().equals(slug))\n-                return t;\n-        }\n-        return null;\n+        return root.createRequest()", "originalCommit": "2e25f37433e3aaa98ed2b3bb904a6dceaf86310b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI2NjQwNA==", "url": "https://github.com/hub4j/github-api/pull/733#discussion_r393266404", "bodyText": "The reference docs say you need org_id with when passing team_id.  Please add tests showing this working correctly.", "author": "bitwiseman", "createdAt": "2020-03-16T19:35:56Z", "path": "src/main/java/org/kohsuke/github/GHOrganization.java", "diffHunk": "@@ -128,6 +128,24 @@ public GHCreateRepositoryBuilder createRepository(String name) {\n                 .toIterable(GHTeam[].class, item -> item.wrapUp(this));\n     }\n \n+    /**\n+     * Gets a single team by ID.\n+     *\n+     * @param id\n+     *            the id\n+     * @return the team\n+     * @throws IOException\n+     *             the io exception\n+     *\n+     * @see <a href= \"https://developer.github.com/v3/teams/#get-team-by-name\">documentation</a>\n+     */\n+    public GHTeam getTeam(int id) throws IOException {\n+        return root.createRequest()\n+                .withUrlPath(String.format(\"/orgs/%s/teams/%d\", login, id))", "originalCommit": "2e25f37433e3aaa98ed2b3bb904a6dceaf86310b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU3MTcxMw==", "url": "https://github.com/hub4j/github-api/pull/733#discussion_r393571713", "bodyText": "I see that all path is different..\nFixed when fixing tests..", "author": "ingwarsw", "createdAt": "2020-03-17T10:15:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI2NjQwNA=="}], "type": "inlineReview", "revised_code": {"commit": "2aebe97f9f91c1624ac201a59ce547ed9946ba5d", "chunk": "diff --git a/src/main/java/org/kohsuke/github/GHOrganization.java b/src/main/java/org/kohsuke/github/GHOrganization.java\nindex a48f0897f..5e88411d4 100644\n--- a/src/main/java/org/kohsuke/github/GHOrganization.java\n+++ b/src/main/java/org/kohsuke/github/GHOrganization.java\n\n@@ -139,9 +139,9 @@ public class GHOrganization extends GHPerson {\n      *\n      * @see <a href= \"https://developer.github.com/v3/teams/#get-team-by-name\">documentation</a>\n      */\n-    public GHTeam getTeam(int id) throws IOException {\n+    public GHTeam getTeam(int teamId) throws IOException {\n         return root.createRequest()\n-                .withUrlPath(String.format(\"/orgs/%s/teams/%d\", login, id))\n+                .withUrlPath(String.format(\"/organizations/%d/team/%d\", id, teamId))\n                 .fetch(GHTeam.class)\n                 .wrapUp(this);\n     }\n"}}, {"oid": "9213f80435a1a9d6a0532b260895641a9cd700cf", "url": "https://github.com/hub4j/github-api/commit/9213f80435a1a9d6a0532b260895641a9cd700cf", "message": "Add comment to deprecation\n\nCo-Authored-By: Liam Newman <bitwiseman@gmail.com>", "committedDate": "2020-03-17T08:07:37Z", "type": "commit"}, {"oid": "960a13dd38c1b97f98d51ee8b54880a8832a8aa2", "url": "https://github.com/hub4j/github-api/commit/960a13dd38c1b97f98d51ee8b54880a8832a8aa2", "message": "Merge branch 'master' into add_get_team_by_slug", "committedDate": "2020-03-17T08:08:34Z", "type": "commit"}, {"oid": "6cbb1a0beea40a8a12a8471934001fc19e951901", "url": "https://github.com/hub4j/github-api/commit/6cbb1a0beea40a8a12a8471934001fc19e951901", "message": "Fix tests partially", "committedDate": "2020-03-17T09:13:43Z", "type": "commit"}, {"oid": "157724bff8343956f5bd0a613fd9708bfb30fd73", "url": "https://github.com/hub4j/github-api/commit/157724bff8343956f5bd0a613fd9708bfb30fd73", "message": "Fix rest of tests", "committedDate": "2020-03-17T09:20:42Z", "type": "commit"}, {"oid": "2aebe97f9f91c1624ac201a59ce547ed9946ba5d", "url": "https://github.com/hub4j/github-api/commit/2aebe97f9f91c1624ac201a59ce547ed9946ba5d", "message": "Add/restore test for getTeam", "committedDate": "2020-03-17T10:18:33Z", "type": "commit"}, {"oid": "6c8b466e59f37368fc7adbe81ddd9ccbc6135d39", "url": "https://github.com/hub4j/github-api/commit/6c8b466e59f37368fc7adbe81ddd9ccbc6135d39", "message": "Add mocks for tests", "committedDate": "2020-03-17T10:18:50Z", "type": "commit"}, {"oid": "f6210cc01477a0c5ef3ff95acf6c21d7c3caac39", "url": "https://github.com/hub4j/github-api/commit/f6210cc01477a0c5ef3ff95acf6c21d7c3caac39", "message": "Change variable name to something meningfull", "committedDate": "2020-03-17T10:21:58Z", "type": "commit"}, {"oid": "1a4238156c0bce87023f5b2d95b77e60c284061d", "url": "https://github.com/hub4j/github-api/commit/1a4238156c0bce87023f5b2d95b77e60c284061d", "message": "Fix javadocs", "committedDate": "2020-03-17T10:34:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzkxMTQ5Mw==", "url": "https://github.com/hub4j/github-api/pull/733#discussion_r393911493", "bodyText": "Sorry, just because it is deprecated doesn't mean we can remove the test for it.  We must ensure it continues to work until it is removed.", "author": "bitwiseman", "createdAt": "2020-03-17T19:14:32Z", "path": "src/test/java/org/kohsuke/github/AppTest.java", "diffHunk": "@@ -234,16 +234,16 @@ private boolean shouldBelongToTeam(String organizationName, String teamName) thr\n         return team.hasMember(gitHub.getMyself());\n     }\n \n-    @Ignore(\"Needs mocking check\")\n     @Test\n     public void testShouldFetchTeam() throws Exception {\n-        GHOrganization j = gitHub.getOrganization(GITHUB_API_TEST_ORG);\n-        GHTeam teamByName = j.getTeams().get(\"Core Developers\");\n+        GHOrganization organization = gitHub.getOrganization(GITHUB_API_TEST_ORG);\n+        GHTeam teamByName = organization.getTeams().get(\"Core Developers\");\n \n-        GHTeam teamById = gitHub.getTeam(teamByName.getId());", "originalCommit": "1a4238156c0bce87023f5b2d95b77e60c284061d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fca425d25eb2bcd88b0697019e53ba21ab56e708", "chunk": "diff --git a/src/test/java/org/kohsuke/github/AppTest.java b/src/test/java/org/kohsuke/github/AppTest.java\nindex bf8a8cf38..cdef41090 100755\n--- a/src/test/java/org/kohsuke/github/AppTest.java\n+++ b/src/test/java/org/kohsuke/github/AppTest.java\n\n@@ -239,6 +239,18 @@ public class AppTest extends AbstractGitHubWireMockTest {\n         GHOrganization organization = gitHub.getOrganization(GITHUB_API_TEST_ORG);\n         GHTeam teamByName = organization.getTeams().get(\"Core Developers\");\n \n+        GHTeam teamById = gitHub.getTeam(teamByName.getId());\n+        assertNotNull(teamById);\n+\n+        assertEquals(teamByName.getId(), teamById.getId());\n+        assertEquals(teamByName.getDescription(), teamById.getDescription());\n+    }\n+    \n+    @Test\n+    public void testShouldFetchTeamFromOrganization() throws Exception {\n+        GHOrganization organization = gitHub.getOrganization(GITHUB_API_TEST_ORG);\n+        GHTeam teamByName = organization.getTeams().get(\"Core Developers\");\n+\n         GHTeam teamById = organization.getTeam(teamByName.getId());\n         assertNotNull(teamById);\n \n"}}, {"oid": "fca425d25eb2bcd88b0697019e53ba21ab56e708", "url": "https://github.com/hub4j/github-api/commit/fca425d25eb2bcd88b0697019e53ba21ab56e708", "message": "Add test for old getteam method", "committedDate": "2020-03-17T21:34:13Z", "type": "commit"}, {"oid": "78b9ff49d47daaa158eb373c4e2e040f739df8b9", "url": "https://github.com/hub4j/github-api/commit/78b9ff49d47daaa158eb373c4e2e040f739df8b9", "message": "Fix tests", "committedDate": "2020-03-17T21:36:54Z", "type": "commit"}]}