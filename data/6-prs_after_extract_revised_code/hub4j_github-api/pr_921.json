{"pr_number": 921, "pr_title": "update branch & change base on PRs", "pr_createdAt": "2020-08-11T22:44:23Z", "pr_url": "https://github.com/hub4j/github-api/pull/921", "timeline": [{"oid": "1baab00abc08cf42e9401c04e3fc0c184fa30a36", "url": "https://github.com/hub4j/github-api/commit/1baab00abc08cf42e9401c04e3fc0c184fa30a36", "message": "update branch & change base on PRs", "committedDate": "2020-08-11T23:13:39Z", "type": "forcePushed"}, {"oid": "73e7c99ca327f2d811259e4bdef5bfdfbfcd138c", "url": "https://github.com/hub4j/github-api/commit/73e7c99ca327f2d811259e4bdef5bfdfbfcd138c", "message": "update branch & change base on PRs", "committedDate": "2020-08-11T23:35:18Z", "type": "forcePushed"}, {"oid": "7f7c61d1c318d9645e2077574a02db05d24aa644", "url": "https://github.com/hub4j/github-api/commit/7f7c61d1c318d9645e2077574a02db05d24aa644", "message": "add GHPullRequest tests", "committedDate": "2020-08-13T09:35:57Z", "type": "forcePushed"}, {"oid": "4b9df795b772b686280cd0a90f4f94c58137e749", "url": "https://github.com/hub4j/github-api/commit/4b9df795b772b686280cd0a90f4f94c58137e749", "message": "add GHPullRequest tests", "committedDate": "2020-08-13T09:38:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE2NTI3NQ==", "url": "https://github.com/hub4j/github-api/pull/921#discussion_r470165275", "bodyText": "Use Requester.send().", "author": "bitwiseman", "createdAt": "2020-08-13T18:36:24Z", "path": "src/main/java/org/kohsuke/github/GHPullRequest.java", "diffHunk": "@@ -565,6 +566,40 @@ public void requestTeamReviewers(List<GHTeam> teams) throws IOException {\n                 .send();\n     }\n \n+    /**\n+     * Set the base branch on the pull request\n+     *\n+     * @param newBaseBranch\n+     *            the name of the new base branch\n+     * @throws IOException\n+     *             the io exception\n+     */\n+    public void setBaseBranch(String newBaseBranch) throws IOException {\n+        owner.root.getClient()\n+                .sendRequest(\n+                        root.createRequest().method(\"PATCH\").with(\"base\", newBaseBranch).withUrlPath(getApiRoute()),\n+                        null);\n+    }\n+\n+    /**\n+     * Updates the branch. The same as pressing the button in the web GUI.\n+     *\n+     * @throws IOException\n+     *             the io exception\n+     */\n+    @Preview\n+    @Deprecated\n+    public void updateBranch() throws IOException {\n+        owner.root.getClient()\n+                .sendRequest(\n+                        root.createRequest()\n+                                .withPreview(LYDIAN)\n+                                .method(\"PUT\")\n+                                .with(\"expected_head_sha\", head.getSha())\n+                                .withUrlPath(getApiRoute() + \"/update-branch\"),\n+                        null);", "originalCommit": "4b9df795b772b686280cd0a90f4f94c58137e749", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4a0d7542b454639deafb53da278455d61ae66381", "chunk": "diff --git a/src/main/java/org/kohsuke/github/GHPullRequest.java b/src/main/java/org/kohsuke/github/GHPullRequest.java\nindex 21afad3fb..c63e7b7eb 100644\n--- a/src/main/java/org/kohsuke/github/GHPullRequest.java\n+++ b/src/main/java/org/kohsuke/github/GHPullRequest.java\n\n@@ -573,12 +573,15 @@ public class GHPullRequest extends GHIssue implements Refreshable {\n      *            the name of the new base branch\n      * @throws IOException\n      *             the io exception\n+     * @return the updated pull request\n      */\n-    public void setBaseBranch(String newBaseBranch) throws IOException {\n-        owner.root.getClient()\n-                .sendRequest(\n-                        root.createRequest().method(\"PATCH\").with(\"base\", newBaseBranch).withUrlPath(getApiRoute()),\n-                        null);\n+    public GHPullRequest setBaseBranch(String newBaseBranch) throws IOException {\n+        return root.createRequest()\n+                .method(\"PATCH\")\n+                .with(\"base\", newBaseBranch)\n+                .withUrlPath(getApiRoute())\n+                .fetch(GHPullRequest.class)\n+                .wrapUp(root);\n     }\n \n     /**\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE3MDAxOQ==", "url": "https://github.com/hub4j/github-api/pull/921#discussion_r470170019", "bodyText": "This call returns the updated GHPullRequest in JSON. We should parse it and return it.", "author": "bitwiseman", "createdAt": "2020-08-13T18:44:19Z", "path": "src/main/java/org/kohsuke/github/GHPullRequest.java", "diffHunk": "@@ -565,6 +566,40 @@ public void requestTeamReviewers(List<GHTeam> teams) throws IOException {\n                 .send();\n     }\n \n+    /**\n+     * Set the base branch on the pull request\n+     *\n+     * @param newBaseBranch\n+     *            the name of the new base branch\n+     * @throws IOException\n+     *             the io exception\n+     */\n+    public void setBaseBranch(String newBaseBranch) throws IOException {\n+        owner.root.getClient()\n+                .sendRequest(\n+                        root.createRequest().method(\"PATCH\").with(\"base\", newBaseBranch).withUrlPath(getApiRoute()),\n+                        null);\n+    }", "originalCommit": "4b9df795b772b686280cd0a90f4f94c58137e749", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4a0d7542b454639deafb53da278455d61ae66381", "chunk": "diff --git a/src/main/java/org/kohsuke/github/GHPullRequest.java b/src/main/java/org/kohsuke/github/GHPullRequest.java\nindex 21afad3fb..c63e7b7eb 100644\n--- a/src/main/java/org/kohsuke/github/GHPullRequest.java\n+++ b/src/main/java/org/kohsuke/github/GHPullRequest.java\n\n@@ -573,12 +573,15 @@ public class GHPullRequest extends GHIssue implements Refreshable {\n      *            the name of the new base branch\n      * @throws IOException\n      *             the io exception\n+     * @return the updated pull request\n      */\n-    public void setBaseBranch(String newBaseBranch) throws IOException {\n-        owner.root.getClient()\n-                .sendRequest(\n-                        root.createRequest().method(\"PATCH\").with(\"base\", newBaseBranch).withUrlPath(getApiRoute()),\n-                        null);\n+    public GHPullRequest setBaseBranch(String newBaseBranch) throws IOException {\n+        return root.createRequest()\n+                .method(\"PATCH\")\n+                .with(\"base\", newBaseBranch)\n+                .withUrlPath(getApiRoute())\n+                .fetch(GHPullRequest.class)\n+                .wrapUp(root);\n     }\n \n     /**\n"}}, {"oid": "4a0d7542b454639deafb53da278455d61ae66381", "url": "https://github.com/hub4j/github-api/commit/4a0d7542b454639deafb53da278455d61ae66381", "message": "add GHPullRequest tests", "committedDate": "2020-09-03T19:06:57Z", "type": "forcePushed"}, {"oid": "ceb2d35f9f38f181c714c69cefcb07a527da0f45", "url": "https://github.com/hub4j/github-api/commit/ceb2d35f9f38f181c714c69cefcb07a527da0f45", "message": "update branch & change base on PRs", "committedDate": "2020-09-03T19:10:33Z", "type": "commit"}, {"oid": "de395136f7d8710fa682447ef62ba60fe45d6995", "url": "https://github.com/hub4j/github-api/commit/de395136f7d8710fa682447ef62ba60fe45d6995", "message": "add GHPullRequest tests", "committedDate": "2020-09-03T19:10:33Z", "type": "forcePushed"}, {"oid": "5d7479a3dd06b99a14688965e8977662fceda7c8", "url": "https://github.com/hub4j/github-api/commit/5d7479a3dd06b99a14688965e8977662fceda7c8", "message": "add GHPullRequest tests", "committedDate": "2020-09-03T19:13:28Z", "type": "commit"}, {"oid": "5d7479a3dd06b99a14688965e8977662fceda7c8", "url": "https://github.com/hub4j/github-api/commit/5d7479a3dd06b99a14688965e8977662fceda7c8", "message": "add GHPullRequest tests", "committedDate": "2020-09-03T19:13:28Z", "type": "forcePushed"}]}