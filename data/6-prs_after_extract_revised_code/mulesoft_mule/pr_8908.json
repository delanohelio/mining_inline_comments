{"pr_number": 8908, "pr_title": "MTS-434: Metadata cache doesn't work properly on Salesforce Query Operation", "pr_createdAt": "2020-06-09T18:57:00Z", "pr_url": "https://github.com/mulesoft/mule/pull/8908", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODc5NzkzMQ==", "url": "https://github.com/mulesoft/mule/pull/8908#discussion_r438797931", "bodyText": "I think that if you use DSQL, you cannot have input resolvers nor metadata key resolvers. You are adding the to the TypeResolversModelProperty, but they are not in the ResolversFactory.", "author": "ndinu", "createdAt": "2020-06-11T13:48:17Z", "path": "tests/test-extensions/metadata-extension/src/main/java/org/mule/test/metadata/extension/MetadataOperations.java", "diffHunk": "@@ -276,6 +278,15 @@ public String returnQuery(@MetadataKeyId String query) {\n     return query;\n   }\n \n+  @Query(translator = MetadataExtensionQueryTranslator.class,\n+      entityResolver = MetadataExtensionEntityResolver.class,\n+      nativeOutputResolver = NativeQueryOutputResolver.class)\n+  @MediaType(TEXT_PLAIN)\n+  public String queryWithOtherMetadata(@MetadataKeyId(QueryExtraResolver.class) String query,", "originalCommit": "910d6efb26b6df6d7819dad05215e4e29d1b41fb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c9df05c65149d266959479b704d519b6b0cbf628", "chunk": "diff --git a/tests/test-extensions/metadata-extension/src/main/java/org/mule/test/metadata/extension/MetadataOperations.java b/tests/test-extensions/metadata-extension/src/main/java/org/mule/test/metadata/extension/MetadataOperations.java\nindex 2701218d2b6..bc1821b4527 100644\n--- a/tests/test-extensions/metadata-extension/src/main/java/org/mule/test/metadata/extension/MetadataOperations.java\n+++ b/tests/test-extensions/metadata-extension/src/main/java/org/mule/test/metadata/extension/MetadataOperations.java\n\n@@ -278,15 +276,6 @@ public class MetadataOperations {\n     return query;\n   }\n \n-  @Query(translator = MetadataExtensionQueryTranslator.class,\n-      entityResolver = MetadataExtensionEntityResolver.class,\n-      nativeOutputResolver = NativeQueryOutputResolver.class)\n-  @MediaType(TEXT_PLAIN)\n-  public String queryWithOtherMetadata(@MetadataKeyId(QueryExtraResolver.class) String query,\n-                                       @TypeResolver(QueryExtraResolver.class) Object input) {\n-    return query;\n-  }\n-\n   @OutputResolver(output = TestOutputResolverWithoutKeyResolver.class)\n   public PagingProvider<MetadataConnection, Result<Object, Animal>> pagedOperationResult(@MetadataKeyId String type) {\n     return generateDummyPagingProvider();\n"}}, {"oid": "c9df05c65149d266959479b704d519b6b0cbf628", "url": "https://github.com/mulesoft/mule/commit/c9df05c65149d266959479b704d519b6b0cbf628", "message": "added query resolver name", "committedDate": "2020-06-16T12:49:16Z", "type": "forcePushed"}, {"oid": "caf30ec38314799c3c8c6b63c3d507928f518a31", "url": "https://github.com/mulesoft/mule/commit/caf30ec38314799c3c8c6b63c3d507928f518a31", "message": "addiong model property for Query annotation", "committedDate": "2020-06-16T17:10:37Z", "type": "commit"}, {"oid": "6b78bc5932a2640bc8a2540292ca63b6e73c2e2a", "url": "https://github.com/mulesoft/mule/commit/6b78bc5932a2640bc8a2540292ca63b6e73c2e2a", "message": "formatter", "committedDate": "2020-06-16T17:10:37Z", "type": "commit"}, {"oid": "7a043114827fe35ea7d6eb70e3f080211d333cd9", "url": "https://github.com/mulesoft/mule/commit/7a043114827fe35ea7d6eb70e3f080211d333cd9", "message": "setting wrapper OutputTypeResolver instead of inner instance", "committedDate": "2020-06-16T17:10:37Z", "type": "commit"}, {"oid": "4246f36d5d5ae80e04c94e3b8012634b69b50e02", "url": "https://github.com/mulesoft/mule/commit/4246f36d5d5ae80e04c94e3b8012634b69b50e02", "message": "formatter", "committedDate": "2020-06-16T17:10:37Z", "type": "commit"}, {"oid": "50d40fde86b02b122ec74c163c253ed0c05bb38d", "url": "https://github.com/mulesoft/mule/commit/50d40fde86b02b122ec74c163c253ed0c05bb38d", "message": "all null resolvers but the output", "committedDate": "2020-06-16T17:10:37Z", "type": "commit"}, {"oid": "063ec402acfcff716f56c9b01bb6757f4adb8434", "url": "https://github.com/mulesoft/mule/commit/063ec402acfcff716f56c9b01bb6757f4adb8434", "message": "missing changes", "committedDate": "2020-06-16T17:10:37Z", "type": "commit"}, {"oid": "c85e1a53e0ef7a7cde186edbe03003b04207bf81", "url": "https://github.com/mulesoft/mule/commit/c85e1a53e0ef7a7cde186edbe03003b04207bf81", "message": "added query resolver name", "committedDate": "2020-06-16T17:10:37Z", "type": "commit"}, {"oid": "f316d526e4f7b1f9f8c53c42860317ec5c6a9725", "url": "https://github.com/mulesoft/mule/commit/f316d526e4f7b1f9f8c53c42860317ec5c6a9725", "message": "fixing tests", "committedDate": "2020-06-16T18:38:26Z", "type": "commit"}, {"oid": "f316d526e4f7b1f9f8c53c42860317ec5c6a9725", "url": "https://github.com/mulesoft/mule/commit/f316d526e4f7b1f9f8c53c42860317ec5c6a9725", "message": "fixing tests", "committedDate": "2020-06-16T18:38:26Z", "type": "forcePushed"}]}