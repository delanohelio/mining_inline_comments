{"pr_number": 9337, "pr_title": "MULE-18720: `PayloadStatisticsIterator` must implement `HasSize`", "pr_createdAt": "2020-09-01T23:13:57Z", "pr_url": "https://github.com/mulesoft/mule/pull/9337", "timeline": [{"oid": "fa78fe46c4c7cc4c8ebcf62b0798f76053aff9fc", "url": "https://github.com/mulesoft/mule/commit/fa78fe46c4c7cc4c8ebcf62b0798f76053aff9fc", "message": "MULE-18720: `PayloadStatisticsIterator` must implement `HasSize`", "committedDate": "2020-09-01T23:12:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjAxNTc2NA==", "url": "https://github.com/mulesoft/mule/pull/9337#discussion_r482015764", "bodyText": "use constants", "author": "fsgonz", "createdAt": "2020-09-02T12:03:46Z", "path": "modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java", "diffHunk": "@@ -126,16 +142,20 @@ public void typedValueForDoorMapAsChild() throws Exception {\n   @Test\n   public void typedValueOperationStringMapListParameter() throws Exception {\n     Map<Object, Object> mapStringList = new LinkedHashMap<>();\n-    mapStringList.put(\"key\", Collections.singletonList(\"string\"));\n+    mapStringList.put(\"key\", singletonList(\"string\"));\n     runAndAssertTypedValue(\"typedValueOperationStringMapListParameter\", mapStringList, ANY, null);\n   }\n \n   @Test\n   public void typedValueForStringOnSourceOnSuccess() throws Exception {\n     Flow flow = (Flow) getFlowConstruct(\"typedValueForStringOnSourceOnSuccess\");\n     flow.start();\n-    new PollingProber(100000, 100).check(new JUnitLambdaProbe(() -> TypedValueSource.onSuccessValue != null));\n-    assertTypedValue(TypedValueSource.onSuccessValue, STRING_VALUE, WILDCARD, null);\n+    try {\n+      new PollingProber(100000, 100).check(new JUnitLambdaProbe(() -> TypedValueSource.onSuccessValue != null));", "originalCommit": "fa78fe46c4c7cc4c8ebcf62b0798f76053aff9fc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ecb1c9b6d88cce1d9bfd103485f21b39eb135e0f", "chunk": "diff --git a/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java b/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java\nindex 61ae0608a16..60d50242b21 100644\n--- a/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java\n+++ b/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java\n\n@@ -151,8 +151,8 @@ public class TypedValueParameterOperationExecutionTestCase extends AbstractTyped\n     Flow flow = (Flow) getFlowConstruct(\"typedValueForStringOnSourceOnSuccess\");\n     flow.start();\n     try {\n-      new PollingProber(100000, 100).check(new JUnitLambdaProbe(() -> TypedValueSource.onSuccessValue != null));\n-      assertTypedValue(TypedValueSource.onSuccessValue, STRING_VALUE, WILDCARD, null);\n+      probe(() -> onSuccessValue != null);\n+      assertTypedValue(onSuccessValue, STRING_VALUE, WILDCARD, null);\n     } finally {\n       flow.stop();\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjAxNjE0MA==", "url": "https://github.com/mulesoft/mule/pull/9337#discussion_r482016140", "bodyText": "I would set the comment before the annotation.", "author": "fsgonz", "createdAt": "2020-09-02T12:04:34Z", "path": "modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/streaming/ObjectStreamingExtensionTestCase.java", "diffHunk": "@@ -45,6 +48,10 @@\n   @Rule\n   public ExpectedException expectedException = none();\n \n+  @Rule\n+  // This test asserts internals that are modified when statistics are enabled", "originalCommit": "fa78fe46c4c7cc4c8ebcf62b0798f76053aff9fc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ecb1c9b6d88cce1d9bfd103485f21b39eb135e0f", "chunk": "diff --git a/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/streaming/ObjectStreamingExtensionTestCase.java b/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/streaming/ObjectStreamingExtensionTestCase.java\nindex b9a2533158a..9dec0c8a02f 100644\n--- a/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/streaming/ObjectStreamingExtensionTestCase.java\n+++ b/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/streaming/ObjectStreamingExtensionTestCase.java\n\n@@ -48,8 +48,8 @@ public class ObjectStreamingExtensionTestCase extends AbstractStreamingExtension\n   @Rule\n   public ExpectedException expectedException = none();\n \n-  @Rule\n   // This test asserts internals that are modified when statistics are enabled\n+  @Rule\n   public SystemProperty withStatistics = new SystemProperty(MULE_DISABLE_PAYLOAD_STATISTICS, \"true\");\n \n   @Override\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjAxNjQzNg==", "url": "https://github.com/mulesoft/mule/pull/9337#discussion_r482016436", "bodyText": "static import", "author": "fsgonz", "createdAt": "2020-09-02T12:05:13Z", "path": "modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java", "diffHunk": "@@ -126,16 +142,20 @@ public void typedValueForDoorMapAsChild() throws Exception {\n   @Test\n   public void typedValueOperationStringMapListParameter() throws Exception {\n     Map<Object, Object> mapStringList = new LinkedHashMap<>();\n-    mapStringList.put(\"key\", Collections.singletonList(\"string\"));\n+    mapStringList.put(\"key\", singletonList(\"string\"));\n     runAndAssertTypedValue(\"typedValueOperationStringMapListParameter\", mapStringList, ANY, null);\n   }\n \n   @Test\n   public void typedValueForStringOnSourceOnSuccess() throws Exception {\n     Flow flow = (Flow) getFlowConstruct(\"typedValueForStringOnSourceOnSuccess\");\n     flow.start();\n-    new PollingProber(100000, 100).check(new JUnitLambdaProbe(() -> TypedValueSource.onSuccessValue != null));\n-    assertTypedValue(TypedValueSource.onSuccessValue, STRING_VALUE, WILDCARD, null);\n+    try {\n+      new PollingProber(100000, 100).check(new JUnitLambdaProbe(() -> TypedValueSource.onSuccessValue != null));\n+      assertTypedValue(TypedValueSource.onSuccessValue, STRING_VALUE, WILDCARD, null);", "originalCommit": "fa78fe46c4c7cc4c8ebcf62b0798f76053aff9fc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ecb1c9b6d88cce1d9bfd103485f21b39eb135e0f", "chunk": "diff --git a/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java b/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java\nindex 61ae0608a16..60d50242b21 100644\n--- a/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java\n+++ b/modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/typed/value/TypedValueParameterOperationExecutionTestCase.java\n\n@@ -151,8 +151,8 @@ public class TypedValueParameterOperationExecutionTestCase extends AbstractTyped\n     Flow flow = (Flow) getFlowConstruct(\"typedValueForStringOnSourceOnSuccess\");\n     flow.start();\n     try {\n-      new PollingProber(100000, 100).check(new JUnitLambdaProbe(() -> TypedValueSource.onSuccessValue != null));\n-      assertTypedValue(TypedValueSource.onSuccessValue, STRING_VALUE, WILDCARD, null);\n+      probe(() -> onSuccessValue != null);\n+      assertTypedValue(onSuccessValue, STRING_VALUE, WILDCARD, null);\n     } finally {\n       flow.stop();\n     }\n"}}, {"oid": "ecb1c9b6d88cce1d9bfd103485f21b39eb135e0f", "url": "https://github.com/mulesoft/mule/commit/ecb1c9b6d88cce1d9bfd103485f21b39eb135e0f", "message": "review", "committedDate": "2020-09-02T12:43:51Z", "type": "commit"}]}