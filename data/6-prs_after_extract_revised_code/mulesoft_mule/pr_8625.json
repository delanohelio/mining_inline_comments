{"pr_number": 8625, "pr_title": "MULE-18029: Fine grained Error resolution for the runtime core and ex\u2026", "pr_createdAt": "2020-02-03T21:01:39Z", "pr_url": "https://github.com/mulesoft/mule/pull/8625", "timeline": [{"oid": "a13115294ae128b6062141fbedc444ff4756a383", "url": "https://github.com/mulesoft/mule/commit/a13115294ae128b6062141fbedc444ff4756a383", "message": "MULE-18029: Fine grained Error resolution for the runtime core and extensions", "committedDate": "2020-02-03T20:35:20Z", "type": "commit"}, {"oid": "6e59ee33a6f8a7f13a141a3fe619d9fc15beaa1c", "url": "https://github.com/mulesoft/mule/commit/6e59ee33a6f8a7f13a141a3fe619d9fc15beaa1c", "message": "MULE-18029: Self review modifications", "committedDate": "2020-02-03T20:55:52Z", "type": "commit"}, {"oid": "6d40a2fc591f3d556a92755a07d2476caed7576e", "url": "https://github.com/mulesoft/mule/commit/6d40a2fc591f3d556a92755a07d2476caed7576e", "message": "MULE-18029: Self review changes", "committedDate": "2020-02-03T20:59:29Z", "type": "commit"}, {"oid": "96d7f933e3003a452afae0c63b56a7af01654573", "url": "https://github.com/mulesoft/mule/commit/96d7f933e3003a452afae0c63b56a7af01654573", "message": "MULE-18029: Self review changes", "committedDate": "2020-02-03T21:00:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY2NjgyOA==", "url": "https://github.com/mulesoft/mule/pull/8625#discussion_r374666828", "bodyText": "handle this inside getExceptionsAsList(me), so adding unwanted elements to the list is avoided from the start", "author": "elrodro83", "createdAt": "2020-02-04T13:24:23Z", "path": "core/src/main/java/org/mule/runtime/core/internal/util/MessagingExceptionResolver.java", "diffHunk": "@@ -148,13 +149,18 @@ private void propagateAlreadyLogged(MessagingException origin, MuleException res\n         .findFirst();\n   }\n \n-  private List<Pair<Throwable, ErrorType>> collectErrors(Component obj, MessagingException me, ErrorTypeLocator locator) {\n+  private List<Pair<Throwable, ErrorType>> collectUnsuppressedErrors(Component obj, MessagingException me,\n+                                                                     ErrorTypeLocator locator) {\n     List<Pair<Throwable, ErrorType>> errors = new ArrayList<>(4);\n     final List<Throwable> exceptionsAsList = getExceptionsAsList(me);\n     for (Throwable e : exceptionsAsList) {\n-      ErrorType type = errorTypeFromException(obj, locator, e);\n-      if (!isUnknownMuleError(type) && !isCriticalMuleError(type)) {\n-        errors.add(new Pair<>(e, type));\n+      if (e instanceof SuppressedMuleException) {", "originalCommit": "96d7f933e3003a452afae0c63b56a7af01654573", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "df1a90f3c05ef5bb6947c2f35908b6ff61ad4e6e", "chunk": "diff --git a/core/src/main/java/org/mule/runtime/core/internal/util/MessagingExceptionResolver.java b/core/src/main/java/org/mule/runtime/core/internal/util/MessagingExceptionResolver.java\nindex 9c52b84dec5..b99b8f2580c 100644\n--- a/core/src/main/java/org/mule/runtime/core/internal/util/MessagingExceptionResolver.java\n+++ b/core/src/main/java/org/mule/runtime/core/internal/util/MessagingExceptionResolver.java\n\n@@ -154,13 +153,9 @@ public class MessagingExceptionResolver {\n     List<Pair<Throwable, ErrorType>> errors = new ArrayList<>(4);\n     final List<Throwable> exceptionsAsList = getExceptionsAsList(me);\n     for (Throwable e : exceptionsAsList) {\n-      if (e instanceof SuppressedMuleException) {\n-        break;\n-      } else {\n-        ErrorType type = errorTypeFromException(obj, locator, e);\n-        if (!isUnknownMuleError(type) && !isCriticalMuleError(type)) {\n-          errors.add(new Pair<>(e, type));\n-        }\n+      ErrorType type = errorTypeFromException(obj, locator, e);\n+      if (!isUnknownMuleError(type) && !isCriticalMuleError(type)) {\n+        errors.add(new Pair<>(e, type));\n       }\n     }\n     return errors;\n"}}, {"oid": "df1a90f3c05ef5bb6947c2f35908b6ff61ad4e6e", "url": "https://github.com/mulesoft/mule/commit/df1a90f3c05ef5bb6947c2f35908b6ff61ad4e6e", "message": "MULE-18029: Changes due to SuppressedMuleException moving to internal", "committedDate": "2020-02-05T21:05:09Z", "type": "commit"}, {"oid": "13c251bc412e414b72ed73d29946e8142b674127", "url": "https://github.com/mulesoft/mule/commit/13c251bc412e414b72ed73d29946e8142b674127", "message": "MULE-18029: New matcher for class names (needed for integration tests)", "committedDate": "2020-02-06T15:05:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk5NTkxMw==", "url": "https://github.com/mulesoft/mule/pull/8625#discussion_r375995913", "bodyText": "where is this used? Also, the format is wrong", "author": "elrodro83", "createdAt": "2020-02-06T18:06:30Z", "path": "tests/unit/src/main/java/org/mule/functional/junit4/matchers/ClassNameMatcher.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.functional.junit4.matchers;\n+\n+import org.hamcrest.Description;\n+import org.hamcrest.Factory;\n+import org.hamcrest.Matcher;\n+import org.hamcrest.TypeSafeMatcher;\n+\n+/**\n+ * Matcher to check the class name of an {@link Object}\n+ * @param <T> the type of {@link Object} to match\n+ */\n+public class ClassNameMatcher<T> extends TypeSafeMatcher<T> {", "originalCommit": "13c251bc412e414b72ed73d29946e8142b674127", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjAxNDgyOA==", "url": "https://github.com/mulesoft/mule/pull/8625#discussion_r376014828", "bodyText": "Sorry for the unformatted code. It is used by our integration tests.", "author": "IvanAndresFritzler", "createdAt": "2020-02-06T18:45:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk5NTkxMw=="}], "type": "inlineReview", "revised_code": {"commit": "334a9a83b194dc60bc0d63aec2069b1a92e6441d", "chunk": "diff --git a/tests/unit/src/main/java/org/mule/functional/junit4/matchers/ClassNameMatcher.java b/tests/unit/src/main/java/org/mule/functional/junit4/matchers/ClassNameMatcher.java\nindex 9c610dde6ad..60167f4014e 100644\n--- a/tests/unit/src/main/java/org/mule/functional/junit4/matchers/ClassNameMatcher.java\n+++ b/tests/unit/src/main/java/org/mule/functional/junit4/matchers/ClassNameMatcher.java\n\n@@ -17,31 +17,31 @@ import org.hamcrest.TypeSafeMatcher;\n  */\n public class ClassNameMatcher<T> extends TypeSafeMatcher<T> {\n \n-        private final Matcher<String> matcher;\n-\n-        private ClassNameMatcher(Matcher<String> matcher) {\n-            this.matcher = matcher;\n-        }\n-\n-        public void describeTo(Description description) {\n-            description.appendText(\"object with class name \");\n-            description.appendDescriptionOf(matcher);\n-        }\n-\n-        @Override\n-        protected boolean matchesSafely(T item) {\n-            return matcher.matches(item.getClass().getName());\n-        }\n-\n-        @Override\n-        protected void describeMismatchSafely(T item, Description description) {\n-            description.appendText(\"class name \");\n-            matcher.describeMismatch(item.getClass().getName(), description);\n-        }\n-\n-        @Factory\n-        public static <T> Matcher<T> hasClassName(final Matcher<String> matcher) {\n-            return new ClassNameMatcher<T>(matcher);\n-        }\n+  private final Matcher<String> matcher;\n+\n+  private ClassNameMatcher(Matcher<String> matcher) {\n+    this.matcher = matcher;\n+  }\n+\n+  public void describeTo(Description description) {\n+    description.appendText(\"object with class name \");\n+    description.appendDescriptionOf(matcher);\n+  }\n+\n+  @Override\n+  protected boolean matchesSafely(T item) {\n+    return matcher.matches(item.getClass().getName());\n+  }\n+\n+  @Override\n+  protected void describeMismatchSafely(T item, Description description) {\n+    description.appendText(\"class name \");\n+    matcher.describeMismatch(item.getClass().getName(), description);\n+  }\n+\n+  @Factory\n+  public static <T> Matcher<T> hasClassName(final Matcher<String> matcher) {\n+    return new ClassNameMatcher<T>(matcher);\n+  }\n \n }\n"}}, {"oid": "334a9a83b194dc60bc0d63aec2069b1a92e6441d", "url": "https://github.com/mulesoft/mule/commit/334a9a83b194dc60bc0d63aec2069b1a92e6441d", "message": "MULE-18029: Code review changes", "committedDate": "2020-02-06T19:05:33Z", "type": "commit"}]}