{"pr_number": 9469, "pr_title": "MULE-18803: Premature completion of choice/round-robin route causes", "pr_createdAt": "2020-09-28T20:12:57Z", "pr_url": "https://github.com/mulesoft/mule/pull/9469", "timeline": [{"oid": "2af6504a1fa64c96bf5defab7cd4a52ab662db8b", "url": "https://github.com/mulesoft/mule/commit/2af6504a1fa64c96bf5defab7cd4a52ab662db8b", "message": "MULE-18803: Premature completion of choice/round-robin route causes\ndropped events", "committedDate": "2020-09-28T19:40:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjIwNjg4OQ==", "url": "https://github.com/mulesoft/mule/pull/9469#discussion_r496206889", "bodyText": "Avoid shadowing the attribute routes", "author": "eze210", "createdAt": "2020-09-28T20:16:19Z", "path": "core/src/main/java/org/mule/runtime/core/internal/routing/AbstractSinkRouter.java", "diffHunk": "@@ -45,16 +51,12 @@ protected AbstractSinkRouter(Publisher<CoreEvent> publisher, List<ProcessorRoute\n    */\n   List<Flux<CoreEvent>> collectPublishers() {\n     List<Flux<CoreEvent>> routes = new ArrayList<>();", "originalCommit": "2af6504a1fa64c96bf5defab7cd4a52ab662db8b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b6cc11d817ac89c5a70b91ccd2d2991cf80f1c43", "chunk": "diff --git a/core/src/main/java/org/mule/runtime/core/internal/routing/AbstractSinkRouter.java b/core/src/main/java/org/mule/runtime/core/internal/routing/AbstractSinkRouter.java\nindex ca9ac862319..3b3406d88f8 100644\n--- a/core/src/main/java/org/mule/runtime/core/internal/routing/AbstractSinkRouter.java\n+++ b/core/src/main/java/org/mule/runtime/core/internal/routing/AbstractSinkRouter.java\n\n@@ -50,14 +50,14 @@ abstract class AbstractSinkRouter {\n    *         subscription of the router occurs after all routes and with the general context.\n    */\n   List<Flux<CoreEvent>> collectPublishers() {\n-    List<Flux<CoreEvent>> routes = new ArrayList<>();\n+    List<Flux<CoreEvent>> routePublishers = new ArrayList<>();\n     for (ExecutableRoute nextRoute : this.routes) {\n-      routes.add(nextRoute.getPublisher());\n+      routePublishers.add(nextRoute.getPublisher());\n     }\n \n-    routes.add(subscribeFluxOnPublisherSubscription(phantomRoute.getPublisher(), router));\n+    routePublishers.add(subscribeFluxOnPublisherSubscription(phantomRoute.getPublisher(), router));\n \n-    return routes;\n+    return routePublishers;\n   }\n \n   /**\n"}}, {"oid": "b6cc11d817ac89c5a70b91ccd2d2991cf80f1c43", "url": "https://github.com/mulesoft/mule/commit/b6cc11d817ac89c5a70b91ccd2d2991cf80f1c43", "message": "review", "committedDate": "2020-09-28T20:20:39Z", "type": "commit"}]}