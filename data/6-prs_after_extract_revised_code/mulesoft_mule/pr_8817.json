{"pr_number": 8817, "pr_title": "MULE-18284: ErrorType of an extension not found in a policy, when the", "pr_createdAt": "2020-04-21T22:41:48Z", "pr_url": "https://github.com/mulesoft/mule/pull/8817", "timeline": [{"oid": "ff0569132cee6c442cdea74299d4a08ebcd70a0d", "url": "https://github.com/mulesoft/mule/commit/ff0569132cee6c442cdea74299d4a08ebcd70a0d", "message": "MULE-18284: ErrorType of an extension not found in a policy, when the\nextension is also in the app", "committedDate": "2020-04-21T22:36:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzAzMTMxMQ==", "url": "https://github.com/mulesoft/mule/pull/8817#discussion_r413031311", "bodyText": "I have tried to understand why this needs to be done only in the context of Policies and not with Applications. Still not clear to me the reason but seems that descriptors have different plugin registered. As this fixes the issue we should merge this and I would add a comment to https://www.mulesoft.org/jira/browse/MULE-15842 which also related to hardcoded code for HTTP on policies.", "author": "gsfernandes", "createdAt": "2020-04-22T14:27:30Z", "path": "modules/deployment-model-impl/src/main/java/org/mule/runtime/module/deployment/impl/internal/policy/DefaultPolicyTemplateFactory.java", "diffHunk": "@@ -73,13 +77,38 @@ public PolicyTemplate createArtifact(Application application, PolicyTemplateDesc\n     application.getRegionClassLoader().addClassLoader(policyClassLoader, NULL_CLASSLOADER_FILTER);\n \n     List<ArtifactPlugin> artifactPlugins = createArtifactPluginList(policyClassLoader, resolvedPolicyPluginsDescriptors);\n+    return new DefaultPolicyTemplate(policyClassLoader.getArtifactId(), descriptor, policyClassLoader,\n+                                     artifactPlugins,\n+                                     resolveOwnArtifactPlugins(application, descriptor, policyClassLoader, artifactPlugins));\n+  }\n \n-    validateArtifactLicense(policyClassLoader.getClassLoader(), artifactPlugins, licenseValidator);\n+  // Need all the plugins that the policy itself depends on, while keeping a relationship with the appropriate classloader.\n+  private List<ArtifactPlugin> resolveOwnArtifactPlugins(Application application, PolicyTemplateDescriptor descriptor,", "originalCommit": "ff0569132cee6c442cdea74299d4a08ebcd70a0d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}