{"pr_number": 3684, "pr_title": "Add retries for grpc calls in functional tests", "pr_createdAt": "2020-08-11T13:35:16Z", "pr_url": "https://github.com/telstra/open-kilda/pull/3684", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwMjY5NA==", "url": "https://github.com/telstra/open-kilda/pull/3684#discussion_r469102694", "bodyText": "unfortunately @Retryable won't work with negative tests\nwe need to exclude some exception", "author": "andriidovhan", "createdAt": "2020-08-12T08:44:32Z", "path": "src-java/testing/test-library/src/main/java/org/openkilda/testing/service/grpc/GrpcServiceImpl.java", "diffHunk": "@@ -63,13 +66,15 @@ public SwitchInfoStatus getSwitchStatus(String switchAddress) {\n     }\n \n     @Override\n+    @Retryable", "originalCommit": "fb1b8078eeda863dd9488cb235cd06324ee6bd79", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTkwNjE0MA==", "url": "https://github.com/telstra/open-kilda/pull/3684#discussion_r469906140", "bodyText": "added conditions", "author": "rtretyak", "createdAt": "2020-08-13T12:14:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwMjY5NA=="}], "type": "inlineReview", "revised_code": {"commit": "24a2b9be897798f6a8aef6f9946787cdbf885805", "chunk": "diff --git a/src-java/testing/test-library/src/main/java/org/openkilda/testing/service/grpc/GrpcServiceImpl.java b/src-java/testing/test-library/src/main/java/org/openkilda/testing/service/grpc/GrpcServiceImpl.java\nindex c0f31fd9d..f2bb7ffed 100644\n--- a/src-java/testing/test-library/src/main/java/org/openkilda/testing/service/grpc/GrpcServiceImpl.java\n+++ b/src-java/testing/test-library/src/main/java/org/openkilda/testing/service/grpc/GrpcServiceImpl.java\n\n@@ -66,7 +66,7 @@ public class GrpcServiceImpl implements GrpcService {\n     }\n \n     @Override\n-    @Retryable\n+    @Retryable(exceptionExpression = \"#{responseBodyAsString.contains('Response code of gRPC request is 458')}\")\n     public LogicalPortDto createLogicalPort(String switchAddress, LogicalPortDto payload) {\n         HttpEntity<LogicalPortDto> httpEntity = new HttpEntity<>(payload, buildHeadersWithCorrelationId());\n         return restTemplate.exchange(\"/api/v1/noviflow/{switch_address}/logicalports\", HttpMethod.PUT, httpEntity,\n"}}, {"oid": "24a2b9be897798f6a8aef6f9946787cdbf885805", "url": "https://github.com/telstra/open-kilda/commit/24a2b9be897798f6a8aef6f9946787cdbf885805", "message": "Add retries for grpc calls in functional tests", "committedDate": "2020-08-13T11:46:05Z", "type": "forcePushed"}, {"oid": "4007bd5438354f4c2a278a7ab38131876f010f63", "url": "https://github.com/telstra/open-kilda/commit/4007bd5438354f4c2a278a7ab38131876f010f63", "message": "Add retries for grpc calls in functional tests", "committedDate": "2020-08-13T12:12:37Z", "type": "commit"}, {"oid": "4007bd5438354f4c2a278a7ab38131876f010f63", "url": "https://github.com/telstra/open-kilda/commit/4007bd5438354f4c2a278a7ab38131876f010f63", "message": "Add retries for grpc calls in functional tests", "committedDate": "2020-08-13T12:12:37Z", "type": "forcePushed"}]}