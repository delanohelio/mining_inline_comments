{"pr_number": 3879, "pr_title": "Zero downtime Switch Manager", "pr_createdAt": "2020-11-27T12:14:29Z", "pr_url": "https://github.com/telstra/open-kilda/pull/3879", "timeline": [{"oid": "a56f56880d0a554d486a2a73087ea2b32df0ba50", "url": "https://github.com/telstra/open-kilda/commit/a56f56880d0a554d486a2a73087ea2b32df0ba50", "message": "Zero-downtime switch manager", "committedDate": "2020-12-03T06:32:28Z", "type": "forcePushed"}, {"oid": "821a66248ee48bbd25b6ff94a622d259e96fdfe5", "url": "https://github.com/telstra/open-kilda/commit/821a66248ee48bbd25b6ff94a622d259e96fdfe5", "message": "Zero-downtime switch manager", "committedDate": "2020-12-09T12:00:06Z", "type": "forcePushed"}, {"oid": "5b7cfbb2f36360b7e1a189cfe5915156e26495d1", "url": "https://github.com/telstra/open-kilda/commit/5b7cfbb2f36360b7e1a189cfe5915156e26495d1", "message": "Zero-downtime switch manager", "committedDate": "2020-12-09T13:46:42Z", "type": "forcePushed"}, {"oid": "669763803926cce4b50a3e8b0e5e05bf089c5406", "url": "https://github.com/telstra/open-kilda/commit/669763803926cce4b50a3e8b0e5e05bf089c5406", "message": "Zero-downtime switch manager", "committedDate": "2020-12-11T15:19:08Z", "type": "forcePushed"}, {"oid": "0852721286b865f732167319a9a93e6c6f119714", "url": "https://github.com/telstra/open-kilda/commit/0852721286b865f732167319a9a93e6c6f119714", "message": "Zero-downtime switch manager", "committedDate": "2020-12-11T15:27:55Z", "type": "forcePushed"}, {"oid": "0ade0005c503cac350e5a2d3eb1f1f7558517956", "url": "https://github.com/telstra/open-kilda/commit/0ade0005c503cac350e5a2d3eb1f1f7558517956", "message": "Zero-downtime switch manager", "committedDate": "2020-12-17T12:43:04Z", "type": "forcePushed"}, {"oid": "f36a09ebea456190d1cdf6e416575f51e17e38bc", "url": "https://github.com/telstra/open-kilda/commit/f36a09ebea456190d1cdf6e416575f51e17e38bc", "message": "Zero-downtime switch manager", "committedDate": "2020-12-21T19:52:52Z", "type": "forcePushed"}, {"oid": "7f81dc1e17d7bff4b753514c27b95d8b35aa2213", "url": "https://github.com/telstra/open-kilda/commit/7f81dc1e17d7bff4b753514c27b95d8b35aa2213", "message": "Zero-downtime switch manager", "committedDate": "2020-12-23T06:28:03Z", "type": "forcePushed"}, {"oid": "ea003ebd1d9619ccdc892b4eb4edd19b5d8c461e", "url": "https://github.com/telstra/open-kilda/commit/ea003ebd1d9619ccdc892b4eb4edd19b5d8c461e", "message": "Zero-downtime switch manager", "committedDate": "2020-12-28T10:44:14Z", "type": "forcePushed"}, {"oid": "d969d67fff3957473a8f72925a9b10cb8aebf21b", "url": "https://github.com/telstra/open-kilda/commit/d969d67fff3957473a8f72925a9b10cb8aebf21b", "message": "Zero-downtime switch manager", "committedDate": "2021-01-14T14:25:04Z", "type": "forcePushed"}, {"oid": "25a689b2d1c289547648e56d4f6658a9a0c6b70a", "url": "https://github.com/telstra/open-kilda/commit/25a689b2d1c289547648e56d4f6658a9a0c6b70a", "message": "Zero-downtime switch manager", "committedDate": "2021-01-20T13:18:06Z", "type": "forcePushed"}, {"oid": "08dee2a6e7135c7ad76a4b610c1444f2216651e6", "url": "https://github.com/telstra/open-kilda/commit/08dee2a6e7135c7ad76a4b610c1444f2216651e6", "message": "Zero-downtime switch manager", "committedDate": "2021-01-27T08:12:12Z", "type": "forcePushed"}, {"oid": "5862f71a800d7a0ae717512c4a5d0dfd0b850d83", "url": "https://github.com/telstra/open-kilda/commit/5862f71a800d7a0ae717512c4a5d0dfd0b850d83", "message": "Zero-downtime switch manager", "committedDate": "2021-01-29T06:02:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NzUxNDkyNw==", "url": "https://github.com/telstra/open-kilda/pull/3879#discussion_r567514927", "bodyText": "Does it make sense to introduce a dedicated \"build\" method instead of repeating \"getZkTopoName(), getConfig().getBlueGreenMode()\" each time?", "author": "sergii-iakovenko", "createdAt": "2021-02-01T01:00:59Z", "path": "src-java/swmanager-topology/swmanager-storm-topology/src/main/java/org/openkilda/wfm/topology/switchmanager/SwitchManagerTopology.java", "diffHunk": "@@ -85,22 +94,34 @@ public StormTopology createTopology() {\n                 .workerSpoutComponent(WORKER_SPOUT)\n                 .defaultTimeout((int) TimeUnit.SECONDS.toMillis(topologyConfig.getOperationTimeout()))\n                 .build();\n-        declareKafkaSpout(builder, topologyConfig.getKafkaSwitchManagerTopic(), WORKER_SPOUT);\n+        declareKafkaSpout(builder, topologyConfig.getKafkaSwitchManagerTopic(), WORKER_SPOUT,\n+                getZkTopoName(), getConfig().getBlueGreenMode());\n         declareBolt(builder, new SpeakerWorkerBolt(speakerWorkerConfig),\n                 SpeakerWorkerBolt.ID)\n                 .fieldsGrouping(WORKER_SPOUT, FIELDS_KEY)\n                 .fieldsGrouping(SwitchManagerHub.ID, SpeakerWorkerBolt.INCOME_STREAM, FIELDS_KEY)\n                 .directGrouping(CoordinatorBolt.ID);\n \n-        declareBolt(builder, buildKafkaBolt(topologyConfig.getKafkaNorthboundTopic()), NB_KAFKA_BOLT)\n+        declareBolt(builder, buildKafkaBolt(topologyConfig.getKafkaNorthboundTopic(),\n+                getZkTopoName(), getConfig().getBlueGreenMode()), NB_KAFKA_BOLT)", "originalCommit": "5862f71a800d7a0ae717512c4a5d0dfd0b850d83", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "6c7e15895d1585570ac248a802d9efd52d16e32d", "url": "https://github.com/telstra/open-kilda/commit/6c7e15895d1585570ac248a802d9efd52d16e32d", "message": "Zero-downtime switch manager", "committedDate": "2021-02-03T13:02:17Z", "type": "commit"}, {"oid": "6c7e15895d1585570ac248a802d9efd52d16e32d", "url": "https://github.com/telstra/open-kilda/commit/6c7e15895d1585570ac248a802d9efd52d16e32d", "message": "Zero-downtime switch manager", "committedDate": "2021-02-03T13:02:17Z", "type": "forcePushed"}]}