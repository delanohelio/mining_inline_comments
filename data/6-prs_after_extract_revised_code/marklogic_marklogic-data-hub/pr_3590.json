{"pr_number": 3590, "pr_title": "DHFPROD-3581: And DHFPROD-3720 - Adding dataservice endpoints to search on facet values", "pr_createdAt": "2020-02-19T01:12:17Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3590", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMyMjYxNw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3590#discussion_r381322617", "bodyText": "I think this is a good example of where moving this code to a separate private method is a good way to document what it's doing - i.e. \"copyTestIndexesFileToProject\".", "author": "rjrudin", "createdAt": "2020-02-19T14:25:20Z", "path": "marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java", "diffHunk": "@@ -40,6 +46,14 @@ public void bootstrapHub() {\n         }\n \n         if (!isInstalled) {\n+            try {", "originalCommit": "bbb1122ffcf1742abc194d78cc25ebcaa5e24c18", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "89a506da79ecd3575284d4408a5a0f8a1d135a8e", "chunk": "diff --git a/marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java b/marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java\nindex d8ba75fb3..913a93048 100644\n--- a/marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java\n+++ b/marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java\n\n@@ -46,14 +46,7 @@ public class Installer extends HubTestBase {\n         }\n \n         if (!isInstalled) {\n-            try {\n-                Path srcDir = Paths.get(\"src\", \"test\", \"ml-config\", \"databases\",\"final-database.json\");\n-                Path dstDir = Paths.get(adminHubConfig.getUserDatabaseDir().toString(), \"test-final-database.json\");\n-                FileUtils.copyFile(srcDir.toAbsolutePath().toFile(), dstDir.toAbsolutePath().toFile());\n-            } catch (IOException ioe) {\n-                ioe.printStackTrace();\n-            }\n-\n+            copyTestIndexesFileToProject();\n             dataHub.install();\n \n             User dataHubDeveloper = new User(new API(adminHubConfig.getManageClient()), \"test-data-hub-developer\");\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMyMzE5Mw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3590#discussion_r381323193", "bodyText": "If this file can't be copied, then the tests that depend on it are going to fail. Best to throw an exception now as opposed to letting the system be in a misconfigured state - e.g. throw new RuntimeException(\"Unable to copy test indexes file to project\", ioe);", "author": "rjrudin", "createdAt": "2020-02-19T14:26:11Z", "path": "marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java", "diffHunk": "@@ -40,6 +46,14 @@ public void bootstrapHub() {\n         }\n \n         if (!isInstalled) {\n+            try {\n+                Path srcDir = Paths.get(\"src\", \"test\", \"ml-config\", \"databases\",\"final-database.json\");\n+                Path dstDir = Paths.get(adminHubConfig.getUserDatabaseDir().toString(), \"test-final-database.json\");\n+                FileUtils.copyFile(srcDir.toAbsolutePath().toFile(), dstDir.toAbsolutePath().toFile());\n+            } catch (IOException ioe) {\n+                ioe.printStackTrace();", "originalCommit": "bbb1122ffcf1742abc194d78cc25ebcaa5e24c18", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "89a506da79ecd3575284d4408a5a0f8a1d135a8e", "chunk": "diff --git a/marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java b/marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java\nindex d8ba75fb3..913a93048 100644\n--- a/marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java\n+++ b/marklogic-data-hub/src/test/java/com/marklogic/bootstrap/Installer.java\n\n@@ -46,14 +46,7 @@ public class Installer extends HubTestBase {\n         }\n \n         if (!isInstalled) {\n-            try {\n-                Path srcDir = Paths.get(\"src\", \"test\", \"ml-config\", \"databases\",\"final-database.json\");\n-                Path dstDir = Paths.get(adminHubConfig.getUserDatabaseDir().toString(), \"test-final-database.json\");\n-                FileUtils.copyFile(srcDir.toAbsolutePath().toFile(), dstDir.toAbsolutePath().toFile());\n-            } catch (IOException ioe) {\n-                ioe.printStackTrace();\n-            }\n-\n+            copyTestIndexesFileToProject();\n             dataHub.install();\n \n             User dataHubDeveloper = new User(new API(adminHubConfig.getManageClient()), \"test-data-hub-developer\");\n"}}, {"oid": "90c233c821a377ea5619ae1dc6b0f488e4202d20", "url": "https://github.com/marklogic/marklogic-data-hub/commit/90c233c821a377ea5619ae1dc6b0f488e4202d20", "message": "DHFPROD-3581: Search within a specific facet of string datatype", "committedDate": "2020-02-27T15:44:00Z", "type": "commit"}, {"oid": "4490705bdcaec9d9c7ac84e29aa436b86eb50667", "url": "https://github.com/marklogic/marklogic-data-hub/commit/4490705bdcaec9d9c7ac84e29aa436b86eb50667", "message": "DHFPROD-3720: Show range for facets based on numeric data type", "committedDate": "2020-02-27T15:44:00Z", "type": "commit"}, {"oid": "89a506da79ecd3575284d4408a5a0f8a1d135a8e", "url": "https://github.com/marklogic/marklogic-data-hub/commit/89a506da79ecd3575284d4408a5a0f8a1d135a8e", "message": "DHFPROD-3581: Adding indexes to final-database.json and throwing error if file is not copied", "committedDate": "2020-02-27T15:52:17Z", "type": "commit"}, {"oid": "60ebe66ce78ae4250bb4aa04b571969fd639bcbb", "url": "https://github.com/marklogic/marklogic-data-hub/commit/60ebe66ce78ae4250bb4aa04b571969fd639bcbb", "message": "DHFPROD-3581: Adding hub entity services library and tests", "committedDate": "2020-02-27T16:02:18Z", "type": "commit"}, {"oid": "62e619c9ca3104dca7215b7264e895adee8a2fe8", "url": "https://github.com/marklogic/marklogic-data-hub/commit/62e619c9ca3104dca7215b7264e895adee8a2fe8", "message": "DHFPROD-3581: Moving all ds endpoints related to entitySearch under EntitySearch Interface", "committedDate": "2020-02-27T16:12:56Z", "type": "commit"}, {"oid": "62e619c9ca3104dca7215b7264e895adee8a2fe8", "url": "https://github.com/marklogic/marklogic-data-hub/commit/62e619c9ca3104dca7215b7264e895adee8a2fe8", "message": "DHFPROD-3581: Moving all ds endpoints related to entitySearch under EntitySearch Interface", "committedDate": "2020-02-27T16:12:56Z", "type": "forcePushed"}, {"oid": "29a949075af6111684504508f31beffeb5a7e370", "url": "https://github.com/marklogic/marklogic-data-hub/commit/29a949075af6111684504508f31beffeb5a7e370", "message": "DHFPROD-3581: Renaming properties to match ES naming conventions", "committedDate": "2020-02-27T17:57:34Z", "type": "commit"}, {"oid": "62d488df07e59842d1475605b4b35eda17510c8d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/62d488df07e59842d1475605b4b35eda17510c8d", "message": "DHFPROD-3581: Renaming EntityModels for tests", "committedDate": "2020-02-27T18:51:16Z", "type": "commit"}, {"oid": "95a8728d693ad123c130b16b6a5749c886ea9844", "url": "https://github.com/marklogic/marklogic-data-hub/commit/95a8728d693ad123c130b16b6a5749c886ea9844", "message": "DHFPROD-3581: Fixing tests", "committedDate": "2020-02-27T21:37:10Z", "type": "commit"}]}