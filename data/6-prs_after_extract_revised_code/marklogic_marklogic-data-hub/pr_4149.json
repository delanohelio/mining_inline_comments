{"pr_number": 4149, "pr_title": "DHFPROD-5112: Display default properties for \"all entities\" search results", "pr_createdAt": "2020-06-25T19:15:55Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4149", "timeline": [{"oid": "161296c3aaf23d417e5a7532665c7486722b65f0", "url": "https://github.com/marklogic/marklogic-data-hub/commit/161296c3aaf23d417e5a7532665c7486722b65f0", "message": "DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Removing uneccessary logs (+1 squashed commit)\nSquashed commits:\n[ba151e0ab] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Add test cases for newly added properties in search response (+2 squashed commits)\nSquashed commits:\n[64ddb2fd9] DHFPROD-5112: Adding properties for All Entities option in backend\n[0626e8c2e] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112- Fixing entity-search-lib (+1 squashed commit)\nSquashed commits:\n[d3975769a] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Adding test cases for backend changes for 5112 (+2 squashed commits)\nSquashed commits:\n[87803c3ca] DHFPROD-5112: Display default properties for \"all entities\" search results\n[501931450] DHFPROD-5152: Detail view column in the tabular view is missing\n\nDHFPROD-5152: Updated test cases for the detail view column (+1 squashed commit)\nSquashed commits:\n[91ff6ffae] DHFPROD-5152: Detail view column in the tabular view is missing", "committedDate": "2020-06-25T19:21:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg0NTU0NA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4149#discussion_r445845544", "bodyText": "I'd rather this still be \"entityName\", and then if the request has multiple entity names (which corresponds to \"all entities\", though in the future, this ideally will be captured via some other mechanism than the UI sending all entity names), then don't include this parameter.\nI think that keeps the search transform cleaner. Instead of throwing an error if entityName isn't specified, it'll say - Oh, there's no entityName selected, so the user is searching all entities. Thus, I'll return a generic set of properties instead of an entity-specific set of properties.", "author": "rjrudin", "createdAt": "2020-06-25T21:22:20Z", "path": "marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java", "diffHunk": "@@ -104,7 +104,7 @@ public StringHandle search(SearchQuery searchQuery) {\n                 // We have some awkwardness here where the input is 'entityName', but as of 5.3.0, the \"entityTypeIds\"\n                 // property is capturing entity names, which are expected to double as collection names as well\n                 ServerTransform searchResultsTransform = new ServerTransform(\"hubEntitySearchTransform\");\n-                searchResultsTransform.put(\"entityName\", entityTypeCollections[0]);\n+                searchResultsTransform.put(\"entityNames\", entityTypeCollections);", "originalCommit": "161296c3aaf23d417e5a7532665c7486722b65f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAwODU3NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4149#discussion_r446008575", "bodyText": "Done.", "author": "xnikhil08", "createdAt": "2020-06-26T07:14:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg0NTU0NA=="}], "type": "inlineReview", "revised_code": {"commit": "db79f1fd49436c23710e162b7a3b48fce734078d", "chunk": "diff --git a/marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java b/marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java\nindex ddf74586d..14f5e4bd0 100644\n--- a/marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java\n+++ b/marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java\n\n@@ -100,11 +100,14 @@ public class EntitySearchManager {\n \n             // If an entity has been selected, then apply this transform\n             String[] entityTypeCollections = searchQuery.getQuery().getEntityTypeCollections();\n+            System.out.println(\"entityTypeCollections-sysOut \"+Arrays.toString(entityTypeCollections) + entityTypeCollections);\n             if (entityTypeCollections != null && entityTypeCollections.length > 0) {\n                 // We have some awkwardness here where the input is 'entityName', but as of 5.3.0, the \"entityTypeIds\"\n                 // property is capturing entity names, which are expected to double as collection names as well\n                 ServerTransform searchResultsTransform = new ServerTransform(\"hubEntitySearchTransform\");\n-                searchResultsTransform.put(\"entityNames\", entityTypeCollections);\n+                if(entityTypeCollections.length == 1) {\n+                    searchResultsTransform.put(\"entityName\", entityTypeCollections);\n+                }\n                 searchResultsTransform.put(\"propertiesToDisplay\", searchQuery.getPropertiesToDisplay());\n                 rcQueryDef.setResponseTransform(searchResultsTransform);\n             }\n"}}, {"oid": "db79f1fd49436c23710e162b7a3b48fce734078d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/db79f1fd49436c23710e162b7a3b48fce734078d", "message": "DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Fixing rebase issues. (+2 squashed commits)\nSquashed commits:\n[4fa5bd63c] DHFPROD-5112: Refactoring the code based on review comments\n[9dffb9a7b] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Removing uneccessary logs (+1 squashed commit)\nSquashed commits:\n[ba151e0ab] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Add test cases for newly added properties in search response (+2 squashed commits)\nSquashed commits:\n[64ddb2fd9] DHFPROD-5112: Adding properties for All Entities option in backend\n[0626e8c2e] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112- Fixing entity-search-lib (+1 squashed commit)\nSquashed commits:\n[d3975769a] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Adding test cases for backend changes for 5112 (+2 squashed commits)\nSquashed commits:\n[87803c3ca] DHFPROD-5112: Display default properties for \"all entities\" search results\n[501931450] DHFPROD-5152: Detail view column in the tabular view is missing\n\nDHFPROD-5152: Updated test cases for the detail view column (+1 squashed commit)\nSquashed commits:\n[91ff6ffae] DHFPROD-5152: Detail view column in the tabular view is missing", "committedDate": "2020-06-26T07:12:38Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjE1Mjc3MQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4149#discussion_r446152771", "bodyText": "This should be removed", "author": "rjrudin", "createdAt": "2020-06-26T12:27:49Z", "path": "marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java", "diffHunk": "@@ -100,11 +100,14 @@ public StringHandle search(SearchQuery searchQuery) {\n \n             // If an entity has been selected, then apply this transform\n             String[] entityTypeCollections = searchQuery.getQuery().getEntityTypeCollections();\n+            System.out.println(\"entityTypeCollections-sysOut \"+Arrays.toString(entityTypeCollections) + entityTypeCollections);", "originalCommit": "db79f1fd49436c23710e162b7a3b48fce734078d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjM4MjAwNw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4149#discussion_r446382007", "bodyText": "Removed.", "author": "xnikhil08", "createdAt": "2020-06-26T19:56:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjE1Mjc3MQ=="}], "type": "inlineReview", "revised_code": {"commit": "4ab53bdddd4b35e0c456069c829eb278e3d6cd24", "chunk": "diff --git a/marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java b/marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java\nindex 14f5e4bd0..81d5782f5 100644\n--- a/marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java\n+++ b/marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/entities/search/EntitySearchManager.java\n\n@@ -100,7 +100,6 @@ public class EntitySearchManager {\n \n             // If an entity has been selected, then apply this transform\n             String[] entityTypeCollections = searchQuery.getQuery().getEntityTypeCollections();\n-            System.out.println(\"entityTypeCollections-sysOut \"+Arrays.toString(entityTypeCollections) + entityTypeCollections);\n             if (entityTypeCollections != null && entityTypeCollections.length > 0) {\n                 // We have some awkwardness here where the input is 'entityName', but as of 5.3.0, the \"entityTypeIds\"\n                 // property is capturing entity names, which are expected to double as collection names as well\n"}}, {"oid": "4ab53bdddd4b35e0c456069c829eb278e3d6cd24", "url": "https://github.com/marklogic/marklogic-data-hub/commit/4ab53bdddd4b35e0c456069c829eb278e3d6cd24", "message": "DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPRDO-5112: Test fixes after rebase (+1 squashed commit)\nSquashed commits:\n[5e4efafe3] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Make changes based on review comments (+1 squashed commit)\nSquashed commits:\n[db79f1fd4] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Fixing rebase issues. (+2 squashed commits)\nSquashed commits:\n[4fa5bd63c] DHFPROD-5112: Refactoring the code based on review comments\n[9dffb9a7b] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Removing uneccessary logs (+1 squashed commit)\nSquashed commits:\n[ba151e0ab] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Add test cases for newly added properties in search response (+2 squashed commits)\nSquashed commits:\n[64ddb2fd9] DHFPROD-5112: Adding properties for All Entities option in backend\n[0626e8c2e] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112- Fixing entity-search-lib (+1 squashed commit)\nSquashed commits:\n[d3975769a] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Adding test cases for backend changes for 5112 (+2 squashed commits)\nSquashed commits:\n[87803c3ca] DHFPROD-5112: Display default properties for \"all entities\" search results\n[501931450] DHFPROD-5152: Detail view column in the tabular view is missing\n\nDHFPROD-5152: Updated test cases for the detail view column (+1 squashed commit)\nSquashed commits:\n[91ff6ffae] DHFPROD-5152: Detail view column in the tabular view is missing", "committedDate": "2020-06-26T19:55:13Z", "type": "forcePushed"}, {"oid": "3187b857cbd29559278fad1565db861b3e2df520", "url": "https://github.com/marklogic/marklogic-data-hub/commit/3187b857cbd29559278fad1565db861b3e2df520", "message": "DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Hiding column selector for All Entities (+1 squashed commit)\nSquashed commits:\n[e0e2c5e02] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPRDO-5112: Test fixes after rebase (+1 squashed commit)\nSquashed commits:\n[5e4efafe3] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Make changes based on review comments (+1 squashed commit)\nSquashed commits:\n[db79f1fd4] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Fixing rebase issues. (+2 squashed commits)\nSquashed commits:\n[4fa5bd63c] DHFPROD-5112: Refactoring the code based on review comments\n[9dffb9a7b] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Removing uneccessary logs (+1 squashed commit)\nSquashed commits:\n[ba151e0ab] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Add test cases for newly added properties in search response (+2 squashed commits)\nSquashed commits:\n[64ddb2fd9] DHFPROD-5112: Adding properties for All Entities option in backend\n[0626e8c2e] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112- Fixing entity-search-lib (+1 squashed commit)\nSquashed commits:\n[d3975769a] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Adding test cases for backend changes for 5112 (+2 squashed commits)\nSquashed commits:\n[87803c3ca] DHFPROD-5112: Display default properties for \"all entities\" search results\n[501931450] DHFPROD-5152: Detail view column in the tabular view is missing\n\nDHFPROD-5152: Updated test cases for the detail view column (+1 squashed commit)\nSquashed commits:\n[91ff6ffae] DHFPROD-5152: Detail view column in the tabular view is missing", "committedDate": "2020-06-26T23:26:48Z", "type": "forcePushed"}, {"oid": "d71623fac449ed74b07425b14cc54b74798425ed", "url": "https://github.com/marklogic/marklogic-data-hub/commit/d71623fac449ed74b07425b14cc54b74798425ed", "message": "DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Fixing the UI unit test (+1 squashed commit)\nSquashed commits:\n[4103653d0] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Hiding column selector for All Entities (+1 squashed commit)\nSquashed commits:\n[e0e2c5e02] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPRDO-5112: Test fixes after rebase (+1 squashed commit)\nSquashed commits:\n[5e4efafe3] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Make changes based on review comments (+1 squashed commit)\nSquashed commits:\n[db79f1fd4] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Fixing rebase issues. (+2 squashed commits)\nSquashed commits:\n[4fa5bd63c] DHFPROD-5112: Refactoring the code based on review comments\n[9dffb9a7b] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Removing uneccessary logs (+1 squashed commit)\nSquashed commits:\n[ba151e0ab] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Add test cases for newly added properties in search response (+2 squashed commits)\nSquashed commits:\n[64ddb2fd9] DHFPROD-5112: Adding properties for All Entities option in backend\n[0626e8c2e] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112- Fixing entity-search-lib (+1 squashed commit)\nSquashed commits:\n[d3975769a] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Adding test cases for backend changes for 5112 (+2 squashed commits)\nSquashed commits:\n[87803c3ca] DHFPROD-5112: Display default properties for \"all entities\" search results\n[501931450] DHFPROD-5152: Detail view column in the tabular view is missing\n\nDHFPROD-5152: Updated test cases for the detail view column (+1 squashed commit)\nSquashed commits:\n[91ff6ffae] DHFPROD-5152: Detail view column in the tabular view is missing", "committedDate": "2020-06-29T17:01:33Z", "type": "commit"}, {"oid": "d71623fac449ed74b07425b14cc54b74798425ed", "url": "https://github.com/marklogic/marklogic-data-hub/commit/d71623fac449ed74b07425b14cc54b74798425ed", "message": "DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Fixing the UI unit test (+1 squashed commit)\nSquashed commits:\n[4103653d0] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Hiding column selector for All Entities (+1 squashed commit)\nSquashed commits:\n[e0e2c5e02] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPRDO-5112: Test fixes after rebase (+1 squashed commit)\nSquashed commits:\n[5e4efafe3] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Make changes based on review comments (+1 squashed commit)\nSquashed commits:\n[db79f1fd4] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Fixing rebase issues. (+2 squashed commits)\nSquashed commits:\n[4fa5bd63c] DHFPROD-5112: Refactoring the code based on review comments\n[9dffb9a7b] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Removing uneccessary logs (+1 squashed commit)\nSquashed commits:\n[ba151e0ab] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Add test cases for newly added properties in search response (+2 squashed commits)\nSquashed commits:\n[64ddb2fd9] DHFPROD-5112: Adding properties for All Entities option in backend\n[0626e8c2e] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112- Fixing entity-search-lib (+1 squashed commit)\nSquashed commits:\n[d3975769a] DHFPROD-5112: Display default properties for \"all entities\" search results\n\nDHFPROD-5112: Adding test cases for backend changes for 5112 (+2 squashed commits)\nSquashed commits:\n[87803c3ca] DHFPROD-5112: Display default properties for \"all entities\" search results\n[501931450] DHFPROD-5152: Detail view column in the tabular view is missing\n\nDHFPROD-5152: Updated test cases for the detail view column (+1 squashed commit)\nSquashed commits:\n[91ff6ffae] DHFPROD-5152: Detail view column in the tabular view is missing", "committedDate": "2020-06-29T17:01:33Z", "type": "forcePushed"}]}