{"pr_number": 6372, "pr_title": "Migate file details and share details to User model", "pr_createdAt": "2020-06-26T22:06:22Z", "pr_url": "https://github.com/nextcloud/android/pull/6372", "timeline": [{"oid": "e13a3ca7cb9796129758a669276a697648ed014b", "url": "https://github.com/nextcloud/android/commit/e13a3ca7cb9796129758a669276a697648ed014b", "message": "Migate file details and share details to User model\n\nUserAccountManager:\n - added userOwnsFile API that replaces accountOwnsFile\n - deprecated accountOwnsFile\n\nFileDisplayActivity:\n - simplified initFragmentWithFile by passing non-null instanecs\n   of user and file and thus avoiding numerous redundant null-checks\n - fragments are initialized using User model instead of Account\n - transfer and download callbacks use getUser() instead of getAccount()\n   and pass user instance to framents\n\nShareActivity\n - initlize fragment using user model instead of account\n - close acivity immediately if current user is not available\n   (cannot reach such state not, but historically account was nullable)\n\nFileDetailTabAdapter\n - framents are initialized using User model instead of Account\n\nFileDetailActivitiesFragment\n - migrated to User\n - removed dependency on constants from FileActivity\n\nFileDetailFragment\n - migrated to User\n - removed dependency on constants from FileActivity\n\nFileDetailsSharingFragment\n - migrated to User\n - removed dependency on constants from FileActivity\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>", "committedDate": "2020-06-26T22:07:40Z", "type": "commit"}, {"oid": "e13a3ca7cb9796129758a669276a697648ed014b", "url": "https://github.com/nextcloud/android/commit/e13a3ca7cb9796129758a669276a697648ed014b", "message": "Migate file details and share details to User model\n\nUserAccountManager:\n - added userOwnsFile API that replaces accountOwnsFile\n - deprecated accountOwnsFile\n\nFileDisplayActivity:\n - simplified initFragmentWithFile by passing non-null instanecs\n   of user and file and thus avoiding numerous redundant null-checks\n - fragments are initialized using User model instead of Account\n - transfer and download callbacks use getUser() instead of getAccount()\n   and pass user instance to framents\n\nShareActivity\n - initlize fragment using user model instead of account\n - close acivity immediately if current user is not available\n   (cannot reach such state not, but historically account was nullable)\n\nFileDetailTabAdapter\n - framents are initialized using User model instead of Account\n\nFileDetailActivitiesFragment\n - migrated to User\n - removed dependency on constants from FileActivity\n\nFileDetailFragment\n - migrated to User\n - removed dependency on constants from FileActivity\n\nFileDetailsSharingFragment\n - migrated to User\n - removed dependency on constants from FileActivity\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>", "committedDate": "2020-06-26T22:07:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQzNTMyMw==", "url": "https://github.com/nextcloud/android/pull/6372#discussion_r446435323", "bodyText": "Codacy found an issue: Useless parentheses.", "author": "nextcloud-android-bot", "createdAt": "2020-06-26T22:22:03Z", "path": "src/main/java/com/owncloud/android/ui/fragment/FileDetailFragment.java", "diffHunk": "@@ -564,8 +564,8 @@ public void updateFileDetails(boolean transferring, boolean refresh) {\n             FileDownloaderBinder downloaderBinder = containerActivity.getFileDownloaderBinder();\n             FileUploaderBinder uploaderBinder = containerActivity.getFileUploaderBinder();\n             if (transferring\n-                    || (downloaderBinder != null && downloaderBinder.isDownloading(account, file))\n-                    || (uploaderBinder != null && uploaderBinder.isUploading(account, file))) {\n+                    || (downloaderBinder != null && downloaderBinder.isDownloading(user.toPlatformAccount(), file))", "originalCommit": "e13a3ca7cb9796129758a669276a697648ed014b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQzNTMzMA==", "url": "https://github.com/nextcloud/android/pull/6372#discussion_r446435330", "bodyText": "Codacy found an issue: Useless parentheses.", "author": "nextcloud-android-bot", "createdAt": "2020-06-26T22:22:05Z", "path": "src/main/java/com/owncloud/android/ui/fragment/FileDetailFragment.java", "diffHunk": "@@ -564,8 +564,8 @@ public void updateFileDetails(boolean transferring, boolean refresh) {\n             FileDownloaderBinder downloaderBinder = containerActivity.getFileDownloaderBinder();\n             FileUploaderBinder uploaderBinder = containerActivity.getFileUploaderBinder();\n             if (transferring\n-                    || (downloaderBinder != null && downloaderBinder.isDownloading(account, file))\n-                    || (uploaderBinder != null && uploaderBinder.isUploading(account, file))) {\n+                    || (downloaderBinder != null && downloaderBinder.isDownloading(user.toPlatformAccount(), file))\n+                    || (uploaderBinder != null && uploaderBinder.isUploading(user.toPlatformAccount(), file))) {", "originalCommit": "e13a3ca7cb9796129758a669276a697648ed014b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQ0MTMxOA==", "url": "https://github.com/nextcloud/android/pull/6372#discussion_r446441318", "bodyText": "tbh I have nothing against parentheses - it helps readability a bit", "author": "ezaquarii", "createdAt": "2020-06-26T22:45:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQzNTMzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk3NTMzNw==", "url": "https://github.com/nextcloud/android/pull/6372#discussion_r446975337", "bodyText": "Same for me, if they are useful, keep them.", "author": "tobiasKaminsky", "createdAt": "2020-06-29T13:34:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQzNTMzMA=="}], "type": "inlineReview", "revised_code": null}]}