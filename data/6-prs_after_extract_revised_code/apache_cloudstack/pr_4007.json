{"pr_number": 4007, "pr_title": "Restarting all networks that needs a restart in a VPC", "pr_createdAt": "2020-04-01T14:49:26Z", "pr_url": "https://github.com/apache/cloudstack/pull/4007", "timeline": [{"oid": "5f50dbad1ae497a92f6053a3165a8fdd22690d3c", "url": "https://github.com/apache/cloudstack/commit/5f50dbad1ae497a92f6053a3165a8fdd22690d3c", "message": "Restarting all networks that needs a restart in a VPC", "committedDate": "2020-04-01T14:31:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkwNjE0Mw==", "url": "https://github.com/apache/cloudstack/pull/4007#discussion_r401906143", "bodyText": "instead of a comment can you extract this into a method with good name, please?", "author": "DaanHoogland", "createdAt": "2020-04-01T21:00:14Z", "path": "server/src/main/java/com/cloud/network/vpc/VpcManagerImpl.java", "diffHunk": "@@ -1747,6 +1747,14 @@ public boolean restartVpc(final long vpcId, final boolean cleanUp, final boolean\n                 return true;\n             }\n \n+            // Restart all networks in this VPC that needs a restart\n+            List<? extends Network> networks = _ntwkModel.listNetworksByVpc(vpcId);\n+            for (Network network: networks){\n+                if (network.isRestartRequired()){\n+                    _ntwkMgr.restartNetwork(network.getId(), callerAccount, callerUser, cleanUp);\n+                }\n+            }", "originalCommit": "5f50dbad1ae497a92f6053a3165a8fdd22690d3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjE1OTI5OA==", "url": "https://github.com/apache/cloudstack/pull/4007#discussion_r402159298", "bodyText": "Done", "author": "Spaceman1984", "createdAt": "2020-04-02T09:01:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkwNjE0Mw=="}], "type": "inlineReview", "revised_code": {"commit": "d6cbdf3f989e37fe98641e5a1c38da5f43737168", "chunk": "diff --git a/server/src/main/java/com/cloud/network/vpc/VpcManagerImpl.java b/server/src/main/java/com/cloud/network/vpc/VpcManagerImpl.java\nindex fc4e59de70..620e5510dd 100644\n--- a/server/src/main/java/com/cloud/network/vpc/VpcManagerImpl.java\n+++ b/server/src/main/java/com/cloud/network/vpc/VpcManagerImpl.java\n\n@@ -1747,13 +1747,7 @@ public class VpcManagerImpl extends ManagerBase implements VpcManager, VpcProvis\n                 return true;\n             }\n \n-            // Restart all networks in this VPC that needs a restart\n-            List<? extends Network> networks = _ntwkModel.listNetworksByVpc(vpcId);\n-            for (Network network: networks){\n-                if (network.isRestartRequired()){\n-                    _ntwkMgr.restartNetwork(network.getId(), callerAccount, callerUser, cleanUp);\n-                }\n-            }\n+            restartVPCNetworks(vpcId, callerAccount, callerUser, cleanUp);\n \n             s_logger.debug(\"Starting VPC \" + vpc + \" as a part of VPC restart process without cleanup\");\n             if (!startVpc(vpcId, false)) {\n"}}, {"oid": "d6cbdf3f989e37fe98641e5a1c38da5f43737168", "url": "https://github.com/apache/cloudstack/commit/d6cbdf3f989e37fe98641e5a1c38da5f43737168", "message": "Refactored restart into a method", "committedDate": "2020-04-02T08:36:15Z", "type": "commit"}]}