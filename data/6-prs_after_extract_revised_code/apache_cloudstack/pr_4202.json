{"pr_number": 4202, "pr_title": "server: don't export B&R APIs if feature is not enabled globally", "pr_createdAt": "2020-07-05T14:23:03Z", "pr_url": "https://github.com/apache/cloudstack/pull/4202", "timeline": [{"oid": "a60fc8c9697a52e42a54943dd3ba4fc1daf4b9f2", "url": "https://github.com/apache/cloudstack/commit/a60fc8c9697a52e42a54943dd3ba4fc1daf4b9f2", "message": "server: don't export APIs if feature is not enabled in any zones\n\nThis change will ensure that B&R APIs are not exported if the feature\nis not enabled in any of the zones.\n\nSigned-off-by: Rohit Yadav <rohit.yadav@shapeblue.com>", "committedDate": "2020-07-05T14:21:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTkzMjQyOA==", "url": "https://github.com/apache/cloudstack/pull/4202#discussion_r449932428", "bodyText": "According to the description, ADMIN needs to restart the management server and therefore this is not a dynamic setting.\nWhat do you think of changing the isDynamic param to false?\nConfigKey constructor:\npublic ConfigKey(String category, Class<T> type, String name, String defaultValue, String description, boolean isDynamic, Scope scope) {\n    this(type, name, category, defaultValue, description, isDynamic, scope, null);\n}", "author": "GabrielBrascher", "createdAt": "2020-07-05T23:48:24Z", "path": "api/src/main/java/org/apache/cloudstack/backup/BackupManager.java", "diffHunk": "@@ -38,7 +38,7 @@\n     ConfigKey<Boolean> BackupFrameworkEnabled = new ConfigKey<>(\"Advanced\", Boolean.class,\n             \"backup.framework.enabled\",\n             \"false\",\n-            \"Is backup and recovery framework enabled.\", true, ConfigKey.Scope.Zone);\n+            \"Is backup and recovery framework enabled. Restart management server on global value change.\", true, ConfigKey.Scope.Zone);", "originalCommit": "a60fc8c9697a52e42a54943dd3ba4fc1daf4b9f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA3MjQ3MQ==", "url": "https://github.com/apache/cloudstack/pull/4202#discussion_r450072471", "bodyText": "I'll change that.", "author": "rhtyd", "createdAt": "2020-07-06T08:43:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTkzMjQyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA3ODAzOA==", "url": "https://github.com/apache/cloudstack/pull/4202#discussion_r450078038", "bodyText": "Fixed thanks", "author": "rhtyd", "createdAt": "2020-07-06T08:53:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTkzMjQyOA=="}], "type": "inlineReview", "revised_code": {"commit": "549d822a823b90784174303651d28f6ded7bdcac", "chunk": "diff --git a/api/src/main/java/org/apache/cloudstack/backup/BackupManager.java b/api/src/main/java/org/apache/cloudstack/backup/BackupManager.java\nindex 1ed061687a..7b4c1c5c68 100644\n--- a/api/src/main/java/org/apache/cloudstack/backup/BackupManager.java\n+++ b/api/src/main/java/org/apache/cloudstack/backup/BackupManager.java\n\n@@ -38,7 +38,7 @@ public interface BackupManager extends BackupService, Configurable, PluggableSer\n     ConfigKey<Boolean> BackupFrameworkEnabled = new ConfigKey<>(\"Advanced\", Boolean.class,\n             \"backup.framework.enabled\",\n             \"false\",\n-            \"Is backup and recovery framework enabled. Restart management server on global value change.\", true, ConfigKey.Scope.Zone);\n+            \"Is backup and recovery framework enabled. Restart management server on global value change.\", false, ConfigKey.Scope.Zone);\n \n     ConfigKey<String> BackupProviderPlugin = new ConfigKey<>(\"Advanced\", String.class,\n             \"backup.framework.provider.plugin\",\n"}}, {"oid": "549d822a823b90784174303651d28f6ded7bdcac", "url": "https://github.com/apache/cloudstack/commit/549d822a823b90784174303651d28f6ded7bdcac", "message": "don't enable feature if it's globally disabled\n\nSigned-off-by: Rohit Yadav <rohit.yadav@shapeblue.com>", "committedDate": "2020-07-06T08:46:02Z", "type": "commit"}, {"oid": "85aa93143a3de1b8a8dce0a53b037b8c65733403", "url": "https://github.com/apache/cloudstack/commit/85aa93143a3de1b8a8dce0a53b037b8c65733403", "message": "run the dummy B&R test only on simulator\n\nSigned-off-by: Rohit Yadav <rohit.yadav@shapeblue.com>", "committedDate": "2020-07-06T08:53:02Z", "type": "commit"}, {"oid": "1a11c2a74fa9ec735487963d42f4d2fb63eddee0", "url": "https://github.com/apache/cloudstack/commit/1a11c2a74fa9ec735487963d42f4d2fb63eddee0", "message": "Update BackupManager.java", "committedDate": "2020-07-06T08:53:53Z", "type": "commit"}, {"oid": "2c06c8491c64c82162f3434ebf5da23fe1de17ac", "url": "https://github.com/apache/cloudstack/commit/2c06c8491c64c82162f3434ebf5da23fe1de17ac", "message": "Update test_backup_recovery_dummy.py", "committedDate": "2020-07-07T05:15:49Z", "type": "commit"}, {"oid": "90ca880f3025f86c7f1ba8241ec2e67bf36daa82", "url": "https://github.com/apache/cloudstack/commit/90ca880f3025f86c7f1ba8241ec2e67bf36daa82", "message": "Update test_backup_recovery_dummy.py", "committedDate": "2020-07-07T12:58:41Z", "type": "commit"}]}