{"pr_number": 13916, "pr_title": "[FLINK-19959][table-planner-blink] Multiple input creation algorithm now considers related inputs when deducing input priorities", "pr_createdAt": "2020-11-04T04:37:57Z", "pr_url": "https://github.com/apache/flink/pull/13916", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI5NzcxOQ==", "url": "https://github.com/apache/flink/pull/13916#discussion_r517297719", "bodyText": "Bby -> B by\nby adding edge from all inputs of node B to node A.", "author": "godfreyhe", "createdAt": "2020-11-04T12:07:45Z", "path": "flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraph.java", "diffHunk": "@@ -139,6 +139,18 @@ void unlink(ExecNode<?, ?> from, ExecNode<?, ?> to) {\n \t\treturn result;\n \t}\n \n+\t/**\n+\t * Make the distance of node A at least as far as node Bby adding all inputs of node B to node A.", "originalCommit": "cf70db9dd8fcedc6b2d852c7da925d4325cf7806", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "515c44460e5e923d34f725e2fcbecf2dcacc1f8e", "chunk": "diff --git a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraph.java b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraph.java\nindex 50d2c65aff..6be70604b5 100644\n--- a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraph.java\n+++ b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraph.java\n\n@@ -140,7 +140,8 @@ class TopologyGraph {\n \t}\n \n \t/**\n-\t * Make the distance of node A at least as far as node Bby adding all inputs of node B to node A.\n+\t * Make the distance of node A at least as far as node B by adding edges\n+\t * from all inputs of node B to node A.\n \t */\n \tvoid makeAsFarAs(ExecNode<?, ?> a, ExecNode<?, ?> b) {\n \t\tTopologyNode nodeA = getOrCreateTopologyNode(a);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzMwMzA3Nw==", "url": "https://github.com/apache/flink/pull/13916#discussion_r517303077", "bodyText": "testMakeAsFarAs", "author": "godfreyhe", "createdAt": "2020-11-04T12:18:38Z", "path": "flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraphTest.java", "diffHunk": "@@ -157,4 +157,16 @@ public void testBoundedCalculateMaximumDistance() {\n \t\tAssert.assertEquals(2, result.get(nodes[5]).intValue());\n \t\tAssert.assertEquals(2, result.get(nodes[7]).intValue());\n \t}\n+\n+\t@Test\n+\tpublic void testAsFarAs() {", "originalCommit": "cf70db9dd8fcedc6b2d852c7da925d4325cf7806", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "515c44460e5e923d34f725e2fcbecf2dcacc1f8e", "chunk": "diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraphTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraphTest.java\nindex e14726e4ca..ca948fe981 100644\n--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraphTest.java\n+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/plan/processors/utils/TopologyGraphTest.java\n\n@@ -159,7 +159,7 @@ public class TopologyGraphTest {\n \t}\n \n \t@Test\n-\tpublic void testAsFarAs() {\n+\tpublic void testMakeAsFarAs() {\n \t\tTuple2<TopologyGraph, TestingBatchExecNode[]> tuple2 = buildTopologyGraph();\n \t\tTopologyGraph graph = tuple2.f0;\n \t\tTestingBatchExecNode[] nodes = tuple2.f1;\n"}}, {"oid": "515c44460e5e923d34f725e2fcbecf2dcacc1f8e", "url": "https://github.com/apache/flink/commit/515c44460e5e923d34f725e2fcbecf2dcacc1f8e", "message": "[FLINK-19959][table-planner-blink] Multiple input creation algorithm now considers related inputs when deducing input priorities", "committedDate": "2020-11-04T13:39:54Z", "type": "commit"}, {"oid": "38cde69ae357fe4d24a0aadd15704ecbd9e89ad9", "url": "https://github.com/apache/flink/commit/38cde69ae357fe4d24a0aadd15704ecbd9e89ad9", "message": "[FLINK-19959][table-planner-blink] Add IT cases for multiple input", "committedDate": "2020-11-05T02:10:05Z", "type": "commit"}]}