{"pr_number": 12201, "pr_title": "[hotfix] Remove raw class usages in Configuration.", "pr_createdAt": "2020-05-17T13:36:20Z", "pr_url": "https://github.com/apache/flink/pull/12201", "timeline": [{"oid": "588ce664f742721564c5bef23309a73db843e5a7", "url": "https://github.com/apache/flink/commit/588ce664f742721564c5bef23309a73db843e5a7", "message": "[hotfix] Remove raw class usages in Configuration.", "committedDate": "2020-05-17T13:22:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM2NTEyNw==", "url": "https://github.com/apache/flink/pull/12201#discussion_r426365127", "bodyText": "not sure if we should use peek here: https://stackoverflow.com/questions/44370676/java-8-peek-vs-map", "author": "twalthr", "createdAt": "2020-05-18T04:35:37Z", "path": "flink-core/src/main/java/org/apache/flink/configuration/Configuration.java", "diffHunk": "@@ -909,12 +909,10 @@ private void loggingFallback(FallbackKey fallbackKey, ConfigOption<?> configOpti\n \t\t\tList<String> listOfRawProperties = StructuredOptionsSplitter.splitEscaped(o.toString(), ',');\n \t\t\treturn listOfRawProperties.stream()\n \t\t\t\t.map(s -> StructuredOptionsSplitter.splitEscaped(s, ':'))\n-\t\t\t\t.map(pair -> {\n+\t\t\t\t.peek(pair -> {", "originalCommit": "588ce664f742721564c5bef23309a73db843e5a7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjQwNzQ1Mg==", "url": "https://github.com/apache/flink/pull/12201#discussion_r426407452", "bodyText": "Peek and map behave exactly the same in respect to the use cases described in that thread. I'd say the thread discusses the declarative aspect of the stream API.\nIn a code:\nstream()\n.map()/peek()\n.count()\n\nNeither map nor peek will be executed (depends on the jvm though) as they cannot change the result of count(). The linked thread rather compares forEach vs peek, in my opinion.\nIn our use case particularly, the purpose of the peek is to add a sanity check right before the collection. We do not have any side effects in the peek that we want applied to all results in the input collection. We want it to be applied only to results we will collect. In this case in my opinion it is absolutely safe to use peek and the code with peek is no different than previous version with map (minus the return value).\nPersonally, I'd prefer to change it to peek as it removes IDE warning.", "author": "dawidwys", "createdAt": "2020-05-18T07:02:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM2NTEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjQ2Nzk0OQ==", "url": "https://github.com/apache/flink/pull/12201#discussion_r426467949", "bodyText": "Thanks for the explanation. +1", "author": "twalthr", "createdAt": "2020-05-18T08:51:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM2NTEyNw=="}], "type": "inlineReview", "revised_code": null}]}