{"pr_number": 12171, "pr_title": "[FLINK-17715][sql client] Supports function DDLs in SQL-CLI", "pr_createdAt": "2020-05-15T12:12:45Z", "pr_url": "https://github.com/apache/flink/pull/12171", "timeline": [{"oid": "2d508f776da68adffc61555a5bea2fe6a1b4d3e9", "url": "https://github.com/apache/flink/commit/2d508f776da68adffc61555a5bea2fe6a1b4d3e9", "message": "[FLINK-17715][sql client] Supports function DDLs in SQL-CLI\n\nThis patch supports CREATE/DROP/ALTER function DDLs for SQL-CLI.", "committedDate": "2020-05-15T12:13:08Z", "type": "commit"}, {"oid": "2d508f776da68adffc61555a5bea2fe6a1b4d3e9", "url": "https://github.com/apache/flink/commit/2d508f776da68adffc61555a5bea2fe6a1b4d3e9", "message": "[FLINK-17715][sql client] Supports function DDLs in SQL-CLI\n\nThis patch supports CREATE/DROP/ALTER function DDLs for SQL-CLI.", "committedDate": "2020-05-15T12:13:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEyNDU1MQ==", "url": "https://github.com/apache/flink/pull/12171#discussion_r426124551", "bodyText": "add some tests for CREATE TEMPORARY SYSTEM FUNCTION", "author": "godfreyhe", "createdAt": "2020-05-16T06:29:29Z", "path": "flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/SqlCommandParserTest.java", "diffHunk": "@@ -134,6 +134,34 @@ public void testCommands() {\n \t\ttestValidSqlCommand(\"DROP TABLE IF EXISTS t1\", new SqlCommandCall(SqlCommand.DROP_TABLE, new String[]{\"DROP TABLE IF EXISTS t1\"}));\n \t\ttestValidSqlCommand(\"DROP TABLE IF EXISTS catalog1.db1.t1\", new SqlCommandCall(SqlCommand.DROP_TABLE, new String[]{\"DROP TABLE IF EXISTS catalog1.db1.t1\"}));\n \t\ttestValidSqlCommand(\"DROP TABLE IF EXISTS db1.t1\", new SqlCommandCall(SqlCommand.DROP_TABLE, new String[]{\"DROP TABLE IF EXISTS db1.t1\"}));\n+\t\t// Test create function.", "originalCommit": "2d508f776da68adffc61555a5bea2fe6a1b4d3e9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c96c7e2cfaa3ca243d8e777b7e1c6c60e62cf0d2", "chunk": "diff --git a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/SqlCommandParserTest.java b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/SqlCommandParserTest.java\nindex f89376ff8f3..d1067ba1283 100644\n--- a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/SqlCommandParserTest.java\n+++ b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/SqlCommandParserTest.java\n\n@@ -142,6 +142,8 @@ public class SqlCommandParserTest {\n \t\t\t\tnew SqlCommandCall(SqlCommand.CREATE_FUNCTION, new String[] {\"CREATE FUNCTION catalog1.db1.func1 as 'class_name'\"}));\n \t\ttestValidSqlCommand(\"CREATE TEMPORARY FUNCTION catalog1.db1.func1 as 'class_name' LANGUAGE JAVA\",\n \t\t\t\tnew SqlCommandCall(SqlCommand.CREATE_FUNCTION, new String[] {\"CREATE TEMPORARY FUNCTION catalog1.db1.func1 as 'class_name' LANGUAGE JAVA\"}));\n+\t\ttestValidSqlCommand(\"CREATE TEMPORARY SYSTEM FUNCTION catalog1.db1.func1 as 'class_name' LANGUAGE JAVA\",\n+\t\t\t\tnew SqlCommandCall(SqlCommand.CREATE_FUNCTION, new String[] {\"CREATE TEMPORARY SYSTEM FUNCTION catalog1.db1.func1 as 'class_name' LANGUAGE JAVA\"}));\n \t\t// Test drop function.\n \t\ttestInvalidSqlCommand(\"DROP FUNCTION\");\n \t\ttestInvalidSqlCommand(\"DROP FUNCTIONS\");\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEyNTIwMQ==", "url": "https://github.com/apache/flink/pull/12171#discussion_r426125201", "bodyText": "I still think we should introduce executeSql method instead of three methods, and i will remove other methods in #12188", "author": "godfreyhe", "createdAt": "2020-05-16T06:39:34Z", "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java", "diffHunk": "@@ -133,6 +133,21 @@\n \t */\n \tList<String> listUserDefinedFunctions(String sessionId) throws SqlExecutionException;\n \n+\t/**\n+\t * Creates a function with a DDL statement.\n+\t */\n+\tvoid createFunction(String sessionId, String ddl) throws SqlExecutionException;", "originalCommit": "2d508f776da68adffc61555a5bea2fe6a1b4d3e9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c96c7e2cfaa3ca243d8e777b7e1c6c60e62cf0d2", "chunk": "diff --git a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java\nindex c5e980ae023..53b71504eb8 100644\n--- a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java\n+++ b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java\n\n@@ -134,19 +134,9 @@ public interface Executor {\n \tList<String> listUserDefinedFunctions(String sessionId) throws SqlExecutionException;\n \n \t/**\n-\t * Creates a function with a DDL statement.\n+\t * Executes a SQL DDL statement.\n \t */\n-\tvoid createFunction(String sessionId, String ddl) throws SqlExecutionException;\n-\n-\t/**\n-\t * Drops a function with a DDL statement.\n-\t */\n-\tvoid dropFunction(String sessionId, String ddl) throws SqlExecutionException;\n-\n-\t/**\n-\t * Alters a function with a DDL statement.\n-\t */\n-\tvoid alterFunction(String sessionId, String ddl) throws SqlExecutionException;\n+\tvoid executeSql(String sessionId, String ddl) throws SqlExecutionException;\n \n \t/**\n \t * Lists all functions known to the executor.\n"}}, {"oid": "c96c7e2cfaa3ca243d8e777b7e1c6c60e62cf0d2", "url": "https://github.com/apache/flink/commit/c96c7e2cfaa3ca243d8e777b7e1c6c60e62cf0d2", "message": "Fix godfre's review comment address", "committedDate": "2020-05-16T07:56:47Z", "type": "commit"}, {"oid": "14bc25ea3f1f55ff6d6d67cbca3b02199a2bee31", "url": "https://github.com/apache/flink/commit/14bc25ea3f1f55ff6d6d67cbca3b02199a2bee31", "message": "Address godfrey's review comment address", "committedDate": "2020-05-16T10:17:52Z", "type": "commit"}, {"oid": "f807fd2e590f6bc6fe0a8022c94486a96de3dcb4", "url": "https://github.com/apache/flink/commit/f807fd2e590f6bc6fe0a8022c94486a96de3dcb4", "message": "Fix checkstyle", "committedDate": "2020-05-18T02:31:43Z", "type": "commit"}]}