{"pr_number": 13657, "pr_title": "[FLINK-19669][coordination] PipelinedRegionSchedulingStrategy#init ResultPartitionType blocking check use isBlocking method", "pr_createdAt": "2020-10-16T03:50:46Z", "pr_url": "https://github.com/apache/flink/pull/13657", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA0NTA3OA==", "url": "https://github.com/apache/flink/pull/13657#discussion_r506045078", "bodyText": "I prefer to not change the topology for existing tests and not change unrelated tests.\nI think it's better to add a new case testSchedulingTopologyWithPersistentBlockingEdges() which initializes a PipelinedRegionSchedulingStrategy from a topology which contains BLOCKING_PERSISTENT results.", "author": "zhuzhurk", "createdAt": "2020-10-16T04:30:08Z", "path": "flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/strategy/PipelinedRegionSchedulingStrategyTest.java", "diffHunk": "@@ -67,13 +69,18 @@ private void buildTopology() {\n \n \t\tsource = testingSchedulingTopology.addExecutionVertices().withParallelism(PARALLELISM).finish();\n \t\tmap = testingSchedulingTopology.addExecutionVertices().withParallelism(PARALLELISM).finish();\n+\t\tmap2 = testingSchedulingTopology.addExecutionVertices().withParallelism(PARALLELISM).finish();", "originalCommit": "5601e4a459216b255fa629c3d5c753963a61a533", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5Mjg4MQ==", "url": "https://github.com/apache/flink/pull/13657#discussion_r506092881", "bodyText": "You are right. I made the change in 7461070, please have another look.", "author": "Sxnan", "createdAt": "2020-10-16T06:44:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA0NTA3OA=="}], "type": "inlineReview", "revised_code": {"commit": "7461070175526095fd5741748f413ba4f78246d9", "chunk": "diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/strategy/PipelinedRegionSchedulingStrategyTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/strategy/PipelinedRegionSchedulingStrategyTest.java\nindex cb9472deac..25c4e710c4 100644\n--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/strategy/PipelinedRegionSchedulingStrategyTest.java\n+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/strategy/PipelinedRegionSchedulingStrategyTest.java\n\n@@ -69,18 +67,13 @@ public class PipelinedRegionSchedulingStrategyTest extends TestLogger {\n \n \t\tsource = testingSchedulingTopology.addExecutionVertices().withParallelism(PARALLELISM).finish();\n \t\tmap = testingSchedulingTopology.addExecutionVertices().withParallelism(PARALLELISM).finish();\n-\t\tmap2 = testingSchedulingTopology.addExecutionVertices().withParallelism(PARALLELISM).finish();\n \t\tsink =  testingSchedulingTopology.addExecutionVertices().withParallelism(PARALLELISM).finish();\n \n \t\ttestingSchedulingTopology.connectPointwise(source, map)\n \t\t\t.withResultPartitionState(ResultPartitionState.CREATED)\n \t\t\t.withResultPartitionType(ResultPartitionType.PIPELINED_BOUNDED)\n \t\t\t.finish();\n-\t\ttestingSchedulingTopology.connectPointwise(map, map2)\n-\t\t\t.withResultPartitionState(ResultPartitionState.CREATED)\n-\t\t\t.withResultPartitionType(ResultPartitionType.BLOCKING_PERSISTENT)\n-\t\t\t.finish();\n-\t\ttestingSchedulingTopology.connectAllToAll(map2, sink)\n+\t\ttestingSchedulingTopology.connectAllToAll(map, sink)\n \t\t\t.withResultPartitionState(ResultPartitionState.CREATED)\n \t\t\t.withResultPartitionType(ResultPartitionType.BLOCKING)\n \t\t\t.finish();\n"}}, {"oid": "7461070175526095fd5741748f413ba4f78246d9", "url": "https://github.com/apache/flink/commit/7461070175526095fd5741748f413ba4f78246d9", "message": "[FLINK-19669][coordination] PipelinedRegionSchedulingStrategy#init ResultPartitionType blocking check use isBlocking method", "committedDate": "2020-10-16T06:37:27Z", "type": "commit"}, {"oid": "7461070175526095fd5741748f413ba4f78246d9", "url": "https://github.com/apache/flink/commit/7461070175526095fd5741748f413ba4f78246d9", "message": "[FLINK-19669][coordination] PipelinedRegionSchedulingStrategy#init ResultPartitionType blocking check use isBlocking method", "committedDate": "2020-10-16T06:37:27Z", "type": "forcePushed"}]}