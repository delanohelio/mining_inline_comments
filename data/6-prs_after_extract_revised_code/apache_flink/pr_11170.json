{"pr_number": 11170, "pr_title": " [FLINK-16033][table-api] Expose catalog lookup function calls in Scala's expression dsl.", "pr_createdAt": "2020-02-21T09:27:06Z", "pr_url": "https://github.com/apache/flink/pull/11170", "timeline": [{"oid": "e13785504108e6e6373e30df43d245a6b47bb1ce", "url": "https://github.com/apache/flink/commit/e13785504108e6e6373e30df43d245a6b47bb1ce", "message": "[FLINK-16033][table-api] Expose catalog lookup function calls in Scala's\nexpression dsl.", "committedDate": "2020-02-21T09:52:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzIxMjIwMg==", "url": "https://github.com/apache/flink/pull/11170#discussion_r383212202", "bodyText": "How about we integrate the identifierParser into FunctionLookup. DataTypeFactory has also a method that takes (String). I would like to reduce the number of instances that we need to pass around.", "author": "twalthr", "createdAt": "2020-02-24T11:26:49Z", "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/expressions/resolver/ExpressionResolver.java", "diffHunk": "@@ -382,11 +395,13 @@ public CallExpression get(ResolvedExpression composite, ValueLiteralExpression k\n \t\tprivate ExpressionResolverBuilder(\n \t\t\t\tQueryOperation[] queryOperations,\n \t\t\t\tTableConfig config,\n+\t\t\t\tFunction<String, UnresolvedIdentifier> identifierParser,\n \t\t\t\tTableReferenceLookup tableCatalog,\n \t\t\t\tFunctionLookup functionLookup,\n \t\t\t\tDataTypeFactory typeFactory) {\n \t\t\tthis.config = config;\n \t\t\tthis.queryOperations = Arrays.asList(queryOperations);\n+\t\t\tthis.identifierParser = identifierParser;", "originalCommit": "d4eef40b743be60e236da67edb9b1f5fdd4436d3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "6b38701e19f3818b2336f247d5bf183ee48b5abe", "chunk": "diff --git a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/expressions/resolver/ExpressionResolver.java b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/expressions/resolver/ExpressionResolver.java\nindex c8b09ae7ae..434697da12 100644\n--- a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/expressions/resolver/ExpressionResolver.java\n+++ b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/expressions/resolver/ExpressionResolver.java\n\n@@ -395,13 +382,11 @@ public class ExpressionResolver {\n \t\tprivate ExpressionResolverBuilder(\n \t\t\t\tQueryOperation[] queryOperations,\n \t\t\t\tTableConfig config,\n-\t\t\t\tFunction<String, UnresolvedIdentifier> identifierParser,\n \t\t\t\tTableReferenceLookup tableCatalog,\n \t\t\t\tFunctionLookup functionLookup,\n \t\t\t\tDataTypeFactory typeFactory) {\n \t\t\tthis.config = config;\n \t\t\tthis.queryOperations = Arrays.asList(queryOperations);\n-\t\t\tthis.identifierParser = identifierParser;\n \t\t\tthis.tableCatalog = tableCatalog;\n \t\t\tthis.functionLookup = functionLookup;\n \t\t\tthis.typeFactory = typeFactory;\n"}}, {"oid": "6b38701e19f3818b2336f247d5bf183ee48b5abe", "url": "https://github.com/apache/flink/commit/6b38701e19f3818b2336f247d5bf183ee48b5abe", "message": "other comments addressed", "committedDate": "2020-02-24T14:50:02Z", "type": "forcePushed"}, {"oid": "1bbc82f17cc56dade152b0657f745785a6118c1f", "url": "https://github.com/apache/flink/commit/1bbc82f17cc56dade152b0657f745785a6118c1f", "message": "[FLINK-16033][table-api] Fix loosing function identifier in ExpressionResolver rules", "committedDate": "2020-02-24T15:04:20Z", "type": "commit"}, {"oid": "6bef14e4c89dc24d6c202ac0e3315e540bb81bc9", "url": "https://github.com/apache/flink/commit/6bef14e4c89dc24d6c202ac0e3315e540bb81bc9", "message": "[FLINK-16033][table-api] Parse identifiers in FunctionLookup.\n\nThis change effectively enables querying catalogs for catalog functions\nwith qualified names.", "committedDate": "2020-02-24T15:04:20Z", "type": "commit"}, {"oid": "65c4ef141c744fd8a51b17c02861225370f08a79", "url": "https://github.com/apache/flink/commit/65c4ef141c744fd8a51b17c02861225370f08a79", "message": "[FLINK-16033][table-api] Expose catalog lookup function calls in Scala's\nexpression dsl.", "committedDate": "2020-02-24T15:04:47Z", "type": "commit"}, {"oid": "65c4ef141c744fd8a51b17c02861225370f08a79", "url": "https://github.com/apache/flink/commit/65c4ef141c744fd8a51b17c02861225370f08a79", "message": "[FLINK-16033][table-api] Expose catalog lookup function calls in Scala's\nexpression dsl.", "committedDate": "2020-02-24T15:04:47Z", "type": "forcePushed"}]}