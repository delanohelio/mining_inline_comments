{"pr_number": 14129, "pr_title": "[hotfix] Reduce logging verbosity from the Checkpoint-related REST handlers", "pr_createdAt": "2020-11-19T09:00:54Z", "pr_url": "https://github.com/apache/flink/pull/14129", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA0NDE2NQ==", "url": "https://github.com/apache/flink/pull/14129#discussion_r527044165", "bodyText": "Instead of a boolean I would suggest to use an enum because then one could give (true/false) a more meaningful name.", "author": "tillrohrmann", "createdAt": "2020-11-19T16:55:42Z", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/RestHandlerException.java", "diffHunk": "@@ -30,17 +30,32 @@\n \n \tprivate final int responseCode;\n \n+\t// This flag indicates whether the AbstractHandler should log about this exception on INFO level or not.\n+\tprivate final boolean logException;", "originalCommit": "89144ae4ffb688a9ca039b311c0f2a9434a71be6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8773590fc0706ddd93ee910084e6151b3a581c44", "chunk": "diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/RestHandlerException.java b/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/RestHandlerException.java\nindex 4cc4c9fdb53..f8bb92057da 100644\n--- a/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/RestHandlerException.java\n+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/RestHandlerException.java\n\n@@ -31,24 +31,24 @@ public class RestHandlerException extends FlinkException {\n \tprivate final int responseCode;\n \n \t// This flag indicates whether the AbstractHandler should log about this exception on INFO level or not.\n-\tprivate final boolean logException;\n+\tprivate final LoggingBehavior loggingBehavior;\n \n \tpublic RestHandlerException(String errorMessage, HttpResponseStatus httpResponseStatus) {\n \t\tsuper(errorMessage);\n \t\tthis.responseCode = httpResponseStatus.code();\n-\t\tthis.logException = true;\n+\t\tthis.loggingBehavior = LoggingBehavior.LOG;\n \t}\n \n-\tpublic RestHandlerException(String errorMessage, HttpResponseStatus httpResponseStatus, boolean logException) {\n+\tpublic RestHandlerException(String errorMessage, HttpResponseStatus httpResponseStatus, LoggingBehavior loggingBehavior) {\n \t\tsuper(errorMessage);\n \t\tthis.responseCode = httpResponseStatus.code();\n-\t\tthis.logException = logException;\n+\t\tthis.loggingBehavior = loggingBehavior;\n \t}\n \n \tpublic RestHandlerException(String errorMessage, HttpResponseStatus httpResponseStatus, Throwable cause) {\n \t\tsuper(errorMessage, cause);\n \t\tthis.responseCode = httpResponseStatus.code();\n-\t\tthis.logException = true;\n+\t\tthis.loggingBehavior = LoggingBehavior.LOG;\n \t}\n \n \tpublic HttpResponseStatus getHttpResponseStatus() {\n"}}, {"oid": "8773590fc0706ddd93ee910084e6151b3a581c44", "url": "https://github.com/apache/flink/commit/8773590fc0706ddd93ee910084e6151b3a581c44", "message": "[hotfix] Reduce logging verbosity from the checkpoint-related REST handlers\n\nBefore the change, everytime the REST UI tried to access the checkpointing statistics, an ERROR message was logged.\n\nWhen using a BATCH job, this leads to log files looking like this:\n\n2020-11-13 15:27:38,785 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,788 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,788 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n2020-11-13 15:27:38,793 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n2020-11-13 15:27:38,793 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,797 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n2020-11-13 15:27:38,797 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,802 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n\nWith this change, these log messages are surpressed.", "committedDate": "2020-11-20T05:54:56Z", "type": "forcePushed"}, {"oid": "6e4ce598d82761026e8da8af6b6236e45e760ac2", "url": "https://github.com/apache/flink/commit/6e4ce598d82761026e8da8af6b6236e45e760ac2", "message": "[hotfix] Reduce logging verbosity from the checkpoint-related REST handlers\n\nBefore the change, everytime the REST UI tried to access the checkpointing statistics, an ERROR message was logged.\n\nWhen using a BATCH job, this leads to log files looking like this:\n\n2020-11-13 15:27:38,785 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,788 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,788 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n2020-11-13 15:27:38,793 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n2020-11-13 15:27:38,793 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,797 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n2020-11-13 15:27:38,797 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,802 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n\nWith this change, these log messages are surpressed.", "committedDate": "2020-11-20T13:52:57Z", "type": "commit"}, {"oid": "6e4ce598d82761026e8da8af6b6236e45e760ac2", "url": "https://github.com/apache/flink/commit/6e4ce598d82761026e8da8af6b6236e45e760ac2", "message": "[hotfix] Reduce logging verbosity from the checkpoint-related REST handlers\n\nBefore the change, everytime the REST UI tried to access the checkpointing statistics, an ERROR message was logged.\n\nWhen using a BATCH job, this leads to log files looking like this:\n\n2020-11-13 15:27:38,785 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,788 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,788 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n2020-11-13 15:27:38,793 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n2020-11-13 15:27:38,793 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,797 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n2020-11-13 15:27:38,797 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointConfigHandler [] - Exception occurred in REST handler: Checkpointing is not enabled for this job (6df1c639d1904f8b7a54cf6a649ab567).\n2020-11-13 15:27:38,802 ERROR org.apache.flink.runtime.rest.handler.job.checkpoints.CheckpointingStatisticsHandler [] - Exception occurred in REST handler: Checkpointing has not been enabled.\n\nWith this change, these log messages are surpressed.", "committedDate": "2020-11-20T13:52:57Z", "type": "forcePushed"}]}