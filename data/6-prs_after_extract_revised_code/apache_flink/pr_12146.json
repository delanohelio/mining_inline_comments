{"pr_number": 12146, "pr_title": "[FLINK-17968][hbase] Fix Hadoop Configuration is not properly serialized in HBaseRowInputFormat", "pr_createdAt": "2020-05-14T08:32:38Z", "pr_url": "https://github.com/apache/flink/pull/12146", "timeline": [{"oid": "59820867eb46cdb2870ca6500ac93858923590f9", "url": "https://github.com/apache/flink/commit/59820867eb46cdb2870ca6500ac93858923590f9", "message": "[FLINK-17968][hbase] Fix Hadoop Configuration is not properly serialized in HBaseRowInputFormat", "committedDate": "2020-05-29T13:40:58Z", "type": "commit"}, {"oid": "59820867eb46cdb2870ca6500ac93858923590f9", "url": "https://github.com/apache/flink/commit/59820867eb46cdb2870ca6500ac93858923590f9", "message": "[FLINK-17968][hbase] Fix Hadoop Configuration is not properly serialized in HBaseRowInputFormat", "committedDate": "2020-05-29T13:40:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0Njk2Nw==", "url": "https://github.com/apache/flink/pull/12146#discussion_r432946967", "bodyText": "How about to call it getHadoopConfiguration ? Because the returned value is not \"serialized\".", "author": "wuchong", "createdAt": "2020-05-31T13:25:07Z", "path": "flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java", "diffHunk": "@@ -99,6 +108,14 @@\n \t */\n \tpublic abstract void configure(Configuration parameters);\n \n+\tprotected void setSerializedConfig(org.apache.hadoop.conf.Configuration hConf) {\n+\t\tserializedConfig = HBaseConfigurationUtil.serializeConfiguration(hConf);\n+\t}\n+\n+\tprotected org.apache.hadoop.conf.Configuration getSerializedConfig() {", "originalCommit": "59820867eb46cdb2870ca6500ac93858923590f9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea008e0dffab41f7f3ac373746605cdc3f6a2388", "chunk": "diff --git a/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java b/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java\nindex 29c5bbe5bdb..94d36d3c06b 100644\n--- a/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java\n+++ b/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java\n\n@@ -108,11 +108,7 @@ abstract class AbstractTableInputFormat<T> extends RichInputFormat<T, TableInput\n \t */\n \tpublic abstract void configure(Configuration parameters);\n \n-\tprotected void setSerializedConfig(org.apache.hadoop.conf.Configuration hConf) {\n-\t\tserializedConfig = HBaseConfigurationUtil.serializeConfiguration(hConf);\n-\t}\n-\n-\tprotected org.apache.hadoop.conf.Configuration getSerializedConfig() {\n+\tprotected org.apache.hadoop.conf.Configuration getHadoopConfiguration() {\n \t\treturn HBaseConfigurationUtil.deserializeConfiguration(serializedConfig, HBaseConfiguration.create());\n \t}\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0Njk5NQ==", "url": "https://github.com/apache/flink/pull/12146#discussion_r432946995", "bodyText": "I think we don't need such method, we can directly call HBaseConfigurationUtil.serializeConfiguration in the construct?", "author": "wuchong", "createdAt": "2020-05-31T13:25:30Z", "path": "flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java", "diffHunk": "@@ -99,6 +108,14 @@\n \t */\n \tpublic abstract void configure(Configuration parameters);\n \n+\tprotected void setSerializedConfig(org.apache.hadoop.conf.Configuration hConf) {", "originalCommit": "59820867eb46cdb2870ca6500ac93858923590f9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea008e0dffab41f7f3ac373746605cdc3f6a2388", "chunk": "diff --git a/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java b/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java\nindex 29c5bbe5bdb..94d36d3c06b 100644\n--- a/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java\n+++ b/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java\n\n@@ -108,11 +108,7 @@ abstract class AbstractTableInputFormat<T> extends RichInputFormat<T, TableInput\n \t */\n \tpublic abstract void configure(Configuration parameters);\n \n-\tprotected void setSerializedConfig(org.apache.hadoop.conf.Configuration hConf) {\n-\t\tserializedConfig = HBaseConfigurationUtil.serializeConfiguration(hConf);\n-\t}\n-\n-\tprotected org.apache.hadoop.conf.Configuration getSerializedConfig() {\n+\tprotected org.apache.hadoop.conf.Configuration getHadoopConfiguration() {\n \t\treturn HBaseConfigurationUtil.deserializeConfiguration(serializedConfig, HBaseConfiguration.create());\n \t}\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0NzE5Ng==", "url": "https://github.com/apache/flink/pull/12146#discussion_r432947196", "bodyText": "Could you add some Javadoc on this? What is the hConf and what values should be contained in the hConf?", "author": "wuchong", "createdAt": "2020-05-31T13:27:53Z", "path": "flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/HBaseInputFormat.java", "diffHunk": "@@ -36,6 +35,10 @@\n \n \tprivate static final long serialVersionUID = 1L;\n \n+\tpublic HBaseInputFormat(org.apache.hadoop.conf.Configuration hConf) {", "originalCommit": "59820867eb46cdb2870ca6500ac93858923590f9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ea008e0dffab41f7f3ac373746605cdc3f6a2388", "chunk": "diff --git a/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/HBaseInputFormat.java b/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/HBaseInputFormat.java\nindex 98c1fab3a0c..45d5b3fc935 100644\n--- a/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/HBaseInputFormat.java\n+++ b/flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/HBaseInputFormat.java\n\n@@ -35,6 +35,11 @@ public abstract class HBaseInputFormat<T extends Tuple> extends AbstractTableInp\n \n \tprivate static final long serialVersionUID = 1L;\n \n+\t/**\n+\t * Constructs a {@link InputFormat} with hbase configuration to read data from hbase.\n+\t * @param hConf The configuration that connect to hbase.\n+\t *              At least hbase.zookeeper.quorum and zookeeper.znode.parent need to be set.\n+\t */\n \tpublic HBaseInputFormat(org.apache.hadoop.conf.Configuration hConf) {\n \t\tsuper(hConf);\n \t}\n"}}, {"oid": "ea008e0dffab41f7f3ac373746605cdc3f6a2388", "url": "https://github.com/apache/flink/commit/ea008e0dffab41f7f3ac373746605cdc3f6a2388", "message": "[FLINK-17968][hbase] Fix Hadoop Configuration is not properly serialized in HBaseRowInputFormat", "committedDate": "2020-06-01T02:37:16Z", "type": "commit"}]}