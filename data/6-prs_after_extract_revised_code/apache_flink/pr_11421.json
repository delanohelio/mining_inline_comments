{"pr_number": 11421, "pr_title": "[FLINK-15962][network] Reduce the default chunk size to 4M in netty stack", "pr_createdAt": "2020-03-17T00:53:49Z", "pr_url": "https://github.com/apache/flink/pull/11421", "timeline": [{"oid": "dd9c079d6024bcae4216bdc3004660018e41f938", "url": "https://github.com/apache/flink/commit/dd9c079d6024bcae4216bdc3004660018e41f938", "message": "[FLINK-15962][network] Reduce the default chunk size to 4M in netty stack", "committedDate": "2020-03-17T07:20:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc3NzU0OA==", "url": "https://github.com/apache/flink/pull/11421#discussion_r394777548", "bodyText": "There are also many other places mentioned 16 MB in comments, and we should still adjust them.", "author": "zhijiangW", "createdAt": "2020-03-19T03:54:36Z", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyBufferPool.java", "diffHunk": "@@ -61,11 +61,11 @@\n \n \t/**\n \t * Arenas allocate chunks of pageSize << maxOrder bytes. With these defaults, this results in\n-\t * chunks of 16 MB.\n+\t * chunks of 4 MB.", "originalCommit": "dd9c079d6024bcae4216bdc3004660018e41f938", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "394192b70d312009146b91bda454b5297ad3b036", "chunk": "diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyBufferPool.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyBufferPool.java\nindex 2c2fc5d5ca..b98c088db9 100644\n--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyBufferPool.java\n+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyBufferPool.java\n\n@@ -53,7 +53,8 @@ public class NettyBufferPool extends PooledByteBufAllocator {\n \n \t/**\n \t * Arenas allocate chunks of pageSize << maxOrder bytes. With these defaults, this results in\n-\t * chunks of 16 MB.\n+\t * chunks of 4 MB. According to the manual test result, after introducing client side zero-copy\n+\t * in FLINK-10742, 4 MB is enough to support large-scale netty shuffle.\n \t *\n \t * @see #MAX_ORDER\n \t */\n"}}, {"oid": "394192b70d312009146b91bda454b5297ad3b036", "url": "https://github.com/apache/flink/commit/394192b70d312009146b91bda454b5297ad3b036", "message": "[FLINK-15962][network] Reduce the default chunk size to 4M in netty stack", "committedDate": "2020-03-20T00:12:26Z", "type": "forcePushed"}, {"oid": "58a6e5f75b628dd8b2afb85e7658cabf3fc0fde9", "url": "https://github.com/apache/flink/commit/58a6e5f75b628dd8b2afb85e7658cabf3fc0fde9", "message": "[FLINK-15962][network] Reduce the default chunk size to 4M in netty stack", "committedDate": "2020-03-20T07:09:58Z", "type": "commit"}, {"oid": "58a6e5f75b628dd8b2afb85e7658cabf3fc0fde9", "url": "https://github.com/apache/flink/commit/58a6e5f75b628dd8b2afb85e7658cabf3fc0fde9", "message": "[FLINK-15962][network] Reduce the default chunk size to 4M in netty stack", "committedDate": "2020-03-20T07:09:58Z", "type": "forcePushed"}]}