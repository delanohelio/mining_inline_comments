{"pr_number": 12934, "pr_title": "[FLINK-18616][table sql/api]Add SHOW CURRENT DDLs", "pr_createdAt": "2020-07-20T07:01:45Z", "pr_url": "https://github.com/apache/flink/pull/12934", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzExODY3OA==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457118678", "bodyText": "Leave one empty line above.", "author": "JingsongLi", "createdAt": "2020-07-20T07:11:25Z", "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/operations/ShowCurrentDatabaseOperation.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.table.operations;\n+\n+/**\n+ * Operation to describe SHOW CURRENT DATABASE operation.\n+ */\n+public class ShowCurrentDatabaseOperation implements ShowOperation{\n+\t@Override", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzExODk1MA==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457118950", "bodyText": "Leave one empty line above.", "author": "JingsongLi", "createdAt": "2020-07-20T07:11:52Z", "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/operations/ShowCurrentCatalogOperation.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.table.operations;\n+\n+/**\n+ * Operation to describe a SHOW CURRENT CATALOG statement.\n+ */\n+public class ShowCurrentCatalogOperation implements ShowOperation{\n+\t@Override", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzExOTY3OA==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457119678", "bodyText": "current catalog name?", "author": "JingsongLi", "createdAt": "2020-07-20T07:13:00Z", "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java", "diffHunk": "@@ -1007,8 +1009,12 @@ private TableResult executeOperation(Operation operation) {\n \t\t\treturn TableResultImpl.TABLE_RESULT_OK;\n \t\t} else if (operation instanceof ShowCatalogsOperation) {\n \t\t\treturn buildShowResult(\"catalog name\", listCatalogs());\n+\t\t} else if (operation instanceof ShowCurrentCatalogOperation){\n+\t\t\treturn buildShowResult(\"catalog name\", new String[]{catalogManager.getCurrentCatalog()});", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a6485e7990e33fdf45e8a18753cbca8749bba262", "chunk": "diff --git a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java\nindex 5e6d2840945..0724e9f832a 100644\n--- a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java\n+++ b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java\n\n@@ -1010,11 +1010,11 @@ public class TableEnvironmentImpl implements TableEnvironmentInternal {\n \t\t} else if (operation instanceof ShowCatalogsOperation) {\n \t\t\treturn buildShowResult(\"catalog name\", listCatalogs());\n \t\t} else if (operation instanceof ShowCurrentCatalogOperation){\n-\t\t\treturn buildShowResult(\"catalog name\", new String[]{catalogManager.getCurrentCatalog()});\n+\t\t\treturn buildShowResult(\"current catalog name\", new String[]{catalogManager.getCurrentCatalog()});\n \t\t} else if (operation instanceof ShowDatabasesOperation) {\n \t\t\treturn buildShowResult(\"database name\", listDatabases());\n \t\t} else if (operation instanceof ShowCurrentDatabaseOperation) {\n-\t\t\treturn buildShowResult(\"database name\", new String[]{catalogManager.getCurrentDatabase()});\n+\t\t\treturn buildShowResult(\"current database name\", new String[]{catalogManager.getCurrentDatabase()});\n \t\t} else if (operation instanceof ShowTablesOperation) {\n \t\t\treturn buildShowResult(\"table name\", listTables());\n \t\t} else if (operation instanceof ShowFunctionsOperation) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzExOTg1MQ==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457119851", "bodyText": "current database name?", "author": "JingsongLi", "createdAt": "2020-07-20T07:13:14Z", "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java", "diffHunk": "@@ -1007,8 +1009,12 @@ private TableResult executeOperation(Operation operation) {\n \t\t\treturn TableResultImpl.TABLE_RESULT_OK;\n \t\t} else if (operation instanceof ShowCatalogsOperation) {\n \t\t\treturn buildShowResult(\"catalog name\", listCatalogs());\n+\t\t} else if (operation instanceof ShowCurrentCatalogOperation){\n+\t\t\treturn buildShowResult(\"catalog name\", new String[]{catalogManager.getCurrentCatalog()});\n \t\t} else if (operation instanceof ShowDatabasesOperation) {\n \t\t\treturn buildShowResult(\"database name\", listDatabases());\n+\t\t} else if (operation instanceof ShowCurrentDatabaseOperation) {\n+\t\t\treturn buildShowResult(\"database name\", new String[]{catalogManager.getCurrentDatabase()});", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a6485e7990e33fdf45e8a18753cbca8749bba262", "chunk": "diff --git a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java\nindex 5e6d2840945..0724e9f832a 100644\n--- a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java\n+++ b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java\n\n@@ -1010,11 +1010,11 @@ public class TableEnvironmentImpl implements TableEnvironmentInternal {\n \t\t} else if (operation instanceof ShowCatalogsOperation) {\n \t\t\treturn buildShowResult(\"catalog name\", listCatalogs());\n \t\t} else if (operation instanceof ShowCurrentCatalogOperation){\n-\t\t\treturn buildShowResult(\"catalog name\", new String[]{catalogManager.getCurrentCatalog()});\n+\t\t\treturn buildShowResult(\"current catalog name\", new String[]{catalogManager.getCurrentCatalog()});\n \t\t} else if (operation instanceof ShowDatabasesOperation) {\n \t\t\treturn buildShowResult(\"database name\", listDatabases());\n \t\t} else if (operation instanceof ShowCurrentDatabaseOperation) {\n-\t\t\treturn buildShowResult(\"database name\", new String[]{catalogManager.getCurrentDatabase()});\n+\t\t\treturn buildShowResult(\"current database name\", new String[]{catalogManager.getCurrentDatabase()});\n \t\t} else if (operation instanceof ShowTablesOperation) {\n \t\t\treturn buildShowResult(\"table name\", listTables());\n \t\t} else if (operation instanceof ShowFunctionsOperation) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEyMDU4OQ==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457120589", "bodyText": "Leave one empty line above.", "author": "JingsongLi", "createdAt": "2020-07-20T07:14:18Z", "path": "flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.sql.parser.dql;\n+\n+import org.apache.calcite.sql.SqlCall;\n+import org.apache.calcite.sql.SqlKind;\n+import org.apache.calcite.sql.SqlNode;\n+import org.apache.calcite.sql.SqlOperator;\n+import org.apache.calcite.sql.SqlSpecialOperator;\n+import org.apache.calcite.sql.SqlWriter;\n+import org.apache.calcite.sql.parser.SqlParserPos;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+/**\n+* Show current database.\n+ */\n+public class SqlShowCurrentDatabase extends SqlCall {\n+\tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT DATABASE\", SqlKind.OTHER);", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a6485e7990e33fdf45e8a18753cbca8749bba262", "chunk": "diff --git a/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java b/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java\nindex 58be06faf6f..942c4f51ae6 100644\n--- a/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java\n+++ b/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java\n\n@@ -33,6 +33,7 @@ import java.util.List;\n * Show current database.\n  */\n public class SqlShowCurrentDatabase extends SqlCall {\n+\n \tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT DATABASE\", SqlKind.OTHER);\n \n \tpublic SqlShowCurrentDatabase(SqlParserPos pos) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEyMTMyMw==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457121323", "bodyText": "Two indents instead of one. Others should be the same.", "author": "JingsongLi", "createdAt": "2020-07-20T07:15:24Z", "path": "flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.sql.parser.dql;\n+\n+import org.apache.calcite.sql.SqlCall;\n+import org.apache.calcite.sql.SqlKind;\n+import org.apache.calcite.sql.SqlNode;\n+import org.apache.calcite.sql.SqlOperator;\n+import org.apache.calcite.sql.SqlSpecialOperator;\n+import org.apache.calcite.sql.SqlWriter;\n+import org.apache.calcite.sql.parser.SqlParserPos;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+/**\n+* Show current database.\n+ */\n+public class SqlShowCurrentDatabase extends SqlCall {\n+\tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT DATABASE\", SqlKind.OTHER);\n+\n+\tpublic SqlShowCurrentDatabase(SqlParserPos pos) {\n+\t\tsuper(pos);\n+\t}\n+\n+\t@Override\n+\tpublic SqlOperator getOperator() {\n+\t\treturn OPERATOR;\n+\t}\n+\n+\t@Override\n+\tpublic List<SqlNode> getOperandList() {\n+\t\treturn Collections.EMPTY_LIST;\n+\t}\n+\n+\t@Override\n+\tpublic void unparse(\n+\t\tSqlWriter writer,", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a6485e7990e33fdf45e8a18753cbca8749bba262", "chunk": "diff --git a/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java b/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java\nindex 58be06faf6f..942c4f51ae6 100644\n--- a/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java\n+++ b/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java\n\n@@ -33,6 +33,7 @@ import java.util.List;\n * Show current database.\n  */\n public class SqlShowCurrentDatabase extends SqlCall {\n+\n \tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT DATABASE\", SqlKind.OTHER);\n \n \tpublic SqlShowCurrentDatabase(SqlParserPos pos) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEyMTU2Nw==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457121567", "bodyText": "Two indents instead of one.", "author": "JingsongLi", "createdAt": "2020-07-20T07:15:45Z", "path": "flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.sql.parser.dql;\n+\n+import org.apache.calcite.sql.SqlCall;\n+import org.apache.calcite.sql.SqlKind;\n+import org.apache.calcite.sql.SqlNode;\n+import org.apache.calcite.sql.SqlOperator;\n+import org.apache.calcite.sql.SqlSpecialOperator;\n+import org.apache.calcite.sql.SqlWriter;\n+import org.apache.calcite.sql.parser.SqlParserPos;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+/**\n+ * SHOW CURRENT CATALOG sql call.\n+ */\n+public class SqlShowCurrentCatalog extends SqlCall {\n+\tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT CATALOG\", SqlKind.OTHER);\n+\n+\tpublic SqlShowCurrentCatalog(SqlParserPos pos) {\n+\t\tsuper(pos);\n+\t}\n+\n+\t@Override\n+\tpublic SqlOperator getOperator() {\n+\t\treturn OPERATOR;\n+\t}\n+\n+\t@Override\n+\tpublic List<SqlNode> getOperandList() {\n+\t\treturn Collections.emptyList();\n+\t}\n+\n+\t@Override\n+\tpublic void unparse(\n+\t\tSqlWriter writer,", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a6485e7990e33fdf45e8a18753cbca8749bba262", "chunk": "diff --git a/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java b/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java\nindex fbfbf4758a0..6ef7afd73fe 100644\n--- a/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java\n+++ b/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java\n\n@@ -33,6 +33,7 @@ import java.util.List;\n  * SHOW CURRENT CATALOG sql call.\n  */\n public class SqlShowCurrentCatalog extends SqlCall {\n+\n \tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT CATALOG\", SqlKind.OTHER);\n \n \tpublic SqlShowCurrentCatalog(SqlParserPos pos) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEyMTYxOQ==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457121619", "bodyText": "Leave one empty line above.", "author": "JingsongLi", "createdAt": "2020-07-20T07:15:51Z", "path": "flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.sql.parser.dql;\n+\n+import org.apache.calcite.sql.SqlCall;\n+import org.apache.calcite.sql.SqlKind;\n+import org.apache.calcite.sql.SqlNode;\n+import org.apache.calcite.sql.SqlOperator;\n+import org.apache.calcite.sql.SqlSpecialOperator;\n+import org.apache.calcite.sql.SqlWriter;\n+import org.apache.calcite.sql.parser.SqlParserPos;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+/**\n+ * SHOW CURRENT CATALOG sql call.\n+ */\n+public class SqlShowCurrentCatalog extends SqlCall {\n+\tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT CATALOG\", SqlKind.OTHER);", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a6485e7990e33fdf45e8a18753cbca8749bba262", "chunk": "diff --git a/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java b/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java\nindex fbfbf4758a0..6ef7afd73fe 100644\n--- a/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java\n+++ b/flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java\n\n@@ -33,6 +33,7 @@ import java.util.List;\n  * SHOW CURRENT CATALOG sql call.\n  */\n public class SqlShowCurrentCatalog extends SqlCall {\n+\n \tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT CATALOG\", SqlKind.OTHER);\n \n \tpublic SqlShowCurrentCatalog(SqlParserPos pos) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEzMzE2OA==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457133168", "bodyText": "getCurrentCatalog?", "author": "JingsongLi", "createdAt": "2020-07-20T07:33:35Z", "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "diffHunk": "@@ -309,13 +309,27 @@ public void setSessionProperty(String sessionId, String key, String value) throw\n \t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listCatalogs()));\n \t}\n \n+\t@Override\n+\tpublic String listCurrentCatalog(String sessionId) throws SqlExecutionException {", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "905fd299573bf766f2bec65ee6d710698063b6bb", "chunk": "diff --git a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java\nindex 789bdad8332..e76044d09c8 100644\n--- a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java\n+++ b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java\n\n@@ -302,70 +301,6 @@ public class LocalExecutor implements Executor {\n \t\tthis.contextMap.put(sessionId, newContext);\n \t}\n \n-\t@Override\n-\tpublic List<String> listCatalogs(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listCatalogs()));\n-\t}\n-\n-\t@Override\n-\tpublic String listCurrentCatalog(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> tableEnv.getCurrentCatalog());\n-\t}\n-\n-\t@Override\n-\tpublic List<String> listDatabases(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listDatabases()));\n-\t}\n-\n-\t@Override\n-\tpublic String listCurrentDatabase(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> tableEnv.getCurrentDatabase());\n-\t}\n-\n-\t@Override\n-\tpublic void createTable(String sessionId, String ddl) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tEnv = context.getTableEnvironment();\n-\t\ttry {\n-\t\t\tcontext.wrapClassLoader(() -> tEnv.executeSql(ddl));\n-\t\t} catch (Exception e) {\n-\t\t\tthrow new SqlExecutionException(\"Could not create a table from statement: \" + ddl, e);\n-\t\t}\n-\t}\n-\n-\t@Override\n-\tpublic void dropTable(String sessionId, String ddl) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tEnv = context.getTableEnvironment();\n-\t\ttry {\n-\t\t\tcontext.wrapClassLoader(() -> tEnv.executeSql(ddl));\n-\t\t} catch (Exception e) {\n-\t\t\tthrow new SqlExecutionException(\"Could not drop table from statement: \" + ddl, e);\n-\t\t}\n-\t}\n-\n-\t@Override\n-\tpublic List<String> listTables(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listTables()));\n-\t}\n-\n-\t@Override\n-\tpublic List<String> listUserDefinedFunctions(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listUserDefinedFunctions()));\n-\t}\n-\n \t@Override\n \tpublic TableResult executeSql(String sessionId, String statement) throws SqlExecutionException {\n \t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEzMzE5NA==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457133194", "bodyText": "getCurrentDatabase?", "author": "JingsongLi", "createdAt": "2020-07-20T07:33:37Z", "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "diffHunk": "@@ -309,13 +309,27 @@ public void setSessionProperty(String sessionId, String key, String value) throw\n \t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listCatalogs()));\n \t}\n \n+\t@Override\n+\tpublic String listCurrentCatalog(String sessionId) throws SqlExecutionException {\n+\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n+\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n+\t\treturn context.wrapClassLoader(() -> tableEnv.getCurrentCatalog());\n+\t}\n+\n \t@Override\n \tpublic List<String> listDatabases(String sessionId) throws SqlExecutionException {\n \t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n \t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n \t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listDatabases()));\n \t}\n \n+\t@Override\n+\tpublic String listCurrentDatabase(String sessionId) throws SqlExecutionException {", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "905fd299573bf766f2bec65ee6d710698063b6bb", "chunk": "diff --git a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java\nindex 789bdad8332..e76044d09c8 100644\n--- a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java\n+++ b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java\n\n@@ -302,70 +301,6 @@ public class LocalExecutor implements Executor {\n \t\tthis.contextMap.put(sessionId, newContext);\n \t}\n \n-\t@Override\n-\tpublic List<String> listCatalogs(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listCatalogs()));\n-\t}\n-\n-\t@Override\n-\tpublic String listCurrentCatalog(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> tableEnv.getCurrentCatalog());\n-\t}\n-\n-\t@Override\n-\tpublic List<String> listDatabases(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listDatabases()));\n-\t}\n-\n-\t@Override\n-\tpublic String listCurrentDatabase(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> tableEnv.getCurrentDatabase());\n-\t}\n-\n-\t@Override\n-\tpublic void createTable(String sessionId, String ddl) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tEnv = context.getTableEnvironment();\n-\t\ttry {\n-\t\t\tcontext.wrapClassLoader(() -> tEnv.executeSql(ddl));\n-\t\t} catch (Exception e) {\n-\t\t\tthrow new SqlExecutionException(\"Could not create a table from statement: \" + ddl, e);\n-\t\t}\n-\t}\n-\n-\t@Override\n-\tpublic void dropTable(String sessionId, String ddl) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tEnv = context.getTableEnvironment();\n-\t\ttry {\n-\t\t\tcontext.wrapClassLoader(() -> tEnv.executeSql(ddl));\n-\t\t} catch (Exception e) {\n-\t\t\tthrow new SqlExecutionException(\"Could not drop table from statement: \" + ddl, e);\n-\t\t}\n-\t}\n-\n-\t@Override\n-\tpublic List<String> listTables(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listTables()));\n-\t}\n-\n-\t@Override\n-\tpublic List<String> listUserDefinedFunctions(String sessionId) throws SqlExecutionException {\n-\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n-\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n-\t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listUserDefinedFunctions()));\n-\t}\n-\n \t@Override\n \tpublic TableResult executeSql(String sessionId, String statement) throws SqlExecutionException {\n \t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE0MTg2NA==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457141864", "bodyText": "we should not introduce new methods, instead, we can call executeSql directly", "author": "godfreyhe", "createdAt": "2020-07-20T07:46:41Z", "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java", "diffHunk": "@@ -79,13 +79,23 @@\n \t/**\n \t * Lists all registered catalogs.\n \t */\n-\tList<String> listCatalogs(String sessionid) throws SqlExecutionException;\n+\tList<String> listCatalogs(String sessionId) throws SqlExecutionException;\n+\n+\t/**\n+\t * List current catalog.\n+\t */\n+\tString listCurrentCatalog(String sessionId) throws SqlExecutionException;", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE1MzU0MQ==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457153541", "bodyText": "@fsk119 I think you can create a new PR for cleaning methods in Executor first...", "author": "JingsongLi", "createdAt": "2020-07-20T08:03:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE0MTg2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE1NDY1NQ==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457154655", "bodyText": "#12923", "author": "godfreyhe", "createdAt": "2020-07-20T08:04:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE0MTg2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE2MTI1NQ==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457161255", "bodyText": "I don't notice Executor has executeSql  method...\nSounds good to clean up these dulicate method as my next work!", "author": "fsk119", "createdAt": "2020-07-20T08:13:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE0MTg2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE4NTc4NA==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457185784", "bodyText": "I don't notice Executor has executeSql method...\nSounds good to clean up these dulicate method as my next work!\n\nI had opened a pr last week", "author": "godfreyhe", "createdAt": "2020-07-20T08:45:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE0MTg2NA=="}], "type": "inlineReview", "revised_code": {"commit": "905fd299573bf766f2bec65ee6d710698063b6bb", "chunk": "diff --git a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java\nindex 104c6b0790a..275a0a7d726 100644\n--- a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java\n+++ b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java\n\n@@ -77,76 +76,15 @@ public interface Executor {\n \tvoid setSessionProperty(String sessionId, String key, String value) throws SqlExecutionException;\n \n \t/**\n-\t * Lists all registered catalogs.\n-\t */\n-\tList<String> listCatalogs(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * List current catalog.\n-\t */\n-\tString listCurrentCatalog(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * Lists all databases in the current catalog.\n-\t */\n-\tList<String> listDatabases(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * List current database.\n-\t */\n-\tString listCurrentDatabase(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * Create a table with a DDL statement.\n-\t */\n-\tvoid createTable(String sessionId, String ddl) throws SqlExecutionException;\n-\n-\t/**\n-\t * Drop a table with a DDL statement.\n-\t */\n-\tvoid dropTable(String sessionId, String ddl) throws SqlExecutionException;\n-\n-\t/**\n-\t * Lists all tables in the current database of the current catalog.\n-\t */\n-\tList<String> listTables(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * Lists all user-defined functions known to the executor.\n-\t */\n-\tList<String> listUserDefinedFunctions(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * Executes a SQL statement.\n+\t * Executes a SQL statement, and return {@link TableResult} as execution result.\n \t */\n \tTableResult executeSql(String sessionId, String statement) throws SqlExecutionException;\n \n-\t/**\n-\t * Lists all functions known to the executor.\n-\t */\n-\tList<String> listFunctions(String sessionId) throws SqlExecutionException;\n-\n \t/**\n \t * Lists all modules known to the executor in their loaded order.\n \t */\n \tList<String> listModules(String sessionId) throws SqlExecutionException;\n \n-\t/**\n-\t * Sets a catalog with given name as the current catalog.\n-\t */\n-\tvoid useCatalog(String sessionId, String catalogName) throws SqlExecutionException;\n-\n-\t/**\n-\t * Sets a database with given name as the current database of the current catalog.\n-\t */\n-\tvoid useDatabase(String sessionId, String databaseName) throws SqlExecutionException;\n-\n-\t/**\n-\t * Returns the schema of a table. Throws an exception if the table could not be found. The\n-\t * schema might contain time attribute types for helping the user during debugging a query.\n-\t */\n-\tTableSchema getTableSchema(String sessionId, String name) throws SqlExecutionException;\n-\n \t/**\n \t * Returns a sql parser instance.\n \t */\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE0MjE0MA==", "url": "https://github.com/apache/flink/pull/12934#discussion_r457142140", "bodyText": "ditto", "author": "godfreyhe", "createdAt": "2020-07-20T07:47:02Z", "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java", "diffHunk": "@@ -79,13 +79,23 @@\n \t/**\n \t * Lists all registered catalogs.\n \t */\n-\tList<String> listCatalogs(String sessionid) throws SqlExecutionException;\n+\tList<String> listCatalogs(String sessionId) throws SqlExecutionException;\n+\n+\t/**\n+\t * List current catalog.\n+\t */\n+\tString listCurrentCatalog(String sessionId) throws SqlExecutionException;\n \n \t/**\n \t * Lists all databases in the current catalog.\n \t */\n \tList<String> listDatabases(String sessionId) throws SqlExecutionException;\n \n+\t/**\n+\t * List current database.\n+\t */\n+\tString listCurrentDatabase(String sessionId) throws SqlExecutionException;", "originalCommit": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "905fd299573bf766f2bec65ee6d710698063b6bb", "chunk": "diff --git a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java\nindex 104c6b0790a..275a0a7d726 100644\n--- a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java\n+++ b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java\n\n@@ -77,76 +76,15 @@ public interface Executor {\n \tvoid setSessionProperty(String sessionId, String key, String value) throws SqlExecutionException;\n \n \t/**\n-\t * Lists all registered catalogs.\n-\t */\n-\tList<String> listCatalogs(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * List current catalog.\n-\t */\n-\tString listCurrentCatalog(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * Lists all databases in the current catalog.\n-\t */\n-\tList<String> listDatabases(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * List current database.\n-\t */\n-\tString listCurrentDatabase(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * Create a table with a DDL statement.\n-\t */\n-\tvoid createTable(String sessionId, String ddl) throws SqlExecutionException;\n-\n-\t/**\n-\t * Drop a table with a DDL statement.\n-\t */\n-\tvoid dropTable(String sessionId, String ddl) throws SqlExecutionException;\n-\n-\t/**\n-\t * Lists all tables in the current database of the current catalog.\n-\t */\n-\tList<String> listTables(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * Lists all user-defined functions known to the executor.\n-\t */\n-\tList<String> listUserDefinedFunctions(String sessionId) throws SqlExecutionException;\n-\n-\t/**\n-\t * Executes a SQL statement.\n+\t * Executes a SQL statement, and return {@link TableResult} as execution result.\n \t */\n \tTableResult executeSql(String sessionId, String statement) throws SqlExecutionException;\n \n-\t/**\n-\t * Lists all functions known to the executor.\n-\t */\n-\tList<String> listFunctions(String sessionId) throws SqlExecutionException;\n-\n \t/**\n \t * Lists all modules known to the executor in their loaded order.\n \t */\n \tList<String> listModules(String sessionId) throws SqlExecutionException;\n \n-\t/**\n-\t * Sets a catalog with given name as the current catalog.\n-\t */\n-\tvoid useCatalog(String sessionId, String catalogName) throws SqlExecutionException;\n-\n-\t/**\n-\t * Sets a database with given name as the current database of the current catalog.\n-\t */\n-\tvoid useDatabase(String sessionId, String databaseName) throws SqlExecutionException;\n-\n-\t/**\n-\t * Returns the schema of a table. Throws an exception if the table could not be found. The\n-\t * schema might contain time attribute types for helping the user during debugging a query.\n-\t */\n-\tTableSchema getTableSchema(String sessionId, String name) throws SqlExecutionException;\n-\n \t/**\n \t * Returns a sql parser instance.\n \t */\n"}}, {"oid": "905fd299573bf766f2bec65ee6d710698063b6bb", "url": "https://github.com/apache/flink/commit/905fd299573bf766f2bec65ee6d710698063b6bb", "message": "[FLINK-18616][table sql/api]Add SHOW CURRENT DDLs", "committedDate": "2020-07-23T07:20:39Z", "type": "commit"}, {"oid": "a6485e7990e33fdf45e8a18753cbca8749bba262", "url": "https://github.com/apache/flink/commit/a6485e7990e33fdf45e8a18753cbca8749bba262", "message": "fix godfrey and Jinsong's comment:\n1. modify format problem(add blank line and space idents)\n2. replace showCurrentCatalog/Database in executor with executeSql", "committedDate": "2020-07-23T09:09:36Z", "type": "commit"}, {"oid": "a6485e7990e33fdf45e8a18753cbca8749bba262", "url": "https://github.com/apache/flink/commit/a6485e7990e33fdf45e8a18753cbca8749bba262", "message": "fix godfrey and Jinsong's comment:\n1. modify format problem(add blank line and space idents)\n2. replace showCurrentCatalog/Database in executor with executeSql", "committedDate": "2020-07-23T09:09:36Z", "type": "forcePushed"}]}