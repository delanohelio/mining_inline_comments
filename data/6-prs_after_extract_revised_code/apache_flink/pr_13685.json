{"pr_number": 13685, "pr_title": "[FLINK-19702][hive] Avoid using HiveConf::hiveSiteURL", "pr_createdAt": "2020-10-19T08:53:25Z", "pr_url": "https://github.com/apache/flink/pull/13685", "timeline": [{"oid": "3d45d334af2088324327734d65e9cbe599a533c4", "url": "https://github.com/apache/flink/commit/3d45d334af2088324327734d65e9cbe599a533c4", "message": "[FLINK-19702][hive] Avoid using HiveConf::hiveSiteURL", "committedDate": "2020-10-27T11:56:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE1ODM1Ng==", "url": "https://github.com/apache/flink/pull/13685#discussion_r513158356", "bodyText": "Maybe you should use new File(..).toURI()", "author": "JingsongLi", "createdAt": "2020-10-28T03:28:59Z", "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/HiveCatalog.java", "diffHunk": "@@ -214,7 +202,19 @@ private static HiveConf createHiveConf(@Nullable String hiveConfDir, @Nullable S\n \t\t} else {\n \t\t\thadoopConf = getHadoopConfiguration(hadoopConfDir);\n \t\t}\n-\t\treturn new HiveConf(hadoopConf == null ? new Configuration() : hadoopConf, HiveConf.class);\n+\t\tHiveConf hiveConf = new HiveConf(hadoopConf == null ? new Configuration() : hadoopConf, HiveConf.class);\n+\n+\t\tLOG.info(\"Setting hive conf dir as {}\", hiveConfDir);\n+\n+\t\tif (hiveConfDir != null) {\n+\t\t\tPath hiveSite = new Path(hiveConfDir, \"hive-site.xml\");", "originalCommit": "3d45d334af2088324327734d65e9cbe599a533c4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b49b477343603ef7568ec9c1de8c59807d85d232", "chunk": "diff --git a/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/HiveCatalog.java b/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/HiveCatalog.java\nindex 03dc7279b26..03c9c417e0f 100644\n--- a/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/HiveCatalog.java\n+++ b/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/HiveCatalog.java\n\n@@ -202,7 +205,10 @@ public class HiveCatalog extends AbstractCatalog {\n \t\t} else {\n \t\t\thadoopConf = getHadoopConfiguration(hadoopConfDir);\n \t\t}\n-\t\tHiveConf hiveConf = new HiveConf(hadoopConf == null ? new Configuration() : hadoopConf, HiveConf.class);\n+\t\tif (hadoopConf == null) {\n+\t\t\thadoopConf = new Configuration();\n+\t\t}\n+\t\tHiveConf hiveConf = new HiveConf(hadoopConf, HiveConf.class);\n \n \t\tLOG.info(\"Setting hive conf dir as {}\", hiveConfDir);\n \n"}}, {"oid": "b49b477343603ef7568ec9c1de8c59807d85d232", "url": "https://github.com/apache/flink/commit/b49b477343603ef7568ec9c1de8c59807d85d232", "message": "add input stream as resource", "committedDate": "2020-10-28T13:30:26Z", "type": "forcePushed"}, {"oid": "380912d40fc1213d88483eab06b3c2fb39284d42", "url": "https://github.com/apache/flink/commit/380912d40fc1213d88483eab06b3c2fb39284d42", "message": "[FLINK-19702][hive] Avoid using HiveConf::hiveSiteURL", "committedDate": "2020-10-29T03:36:08Z", "type": "commit"}, {"oid": "70d18351b010c737c4dad8562a810fb50851f932", "url": "https://github.com/apache/flink/commit/70d18351b010c737c4dad8562a810fb50851f932", "message": "add input stream as resource", "committedDate": "2020-10-29T03:36:08Z", "type": "commit"}, {"oid": "5c973d952e126afd81b88646af666713e30835f0", "url": "https://github.com/apache/flink/commit/5c973d952e126afd81b88646af666713e30835f0", "message": "add test", "committedDate": "2020-10-29T03:36:08Z", "type": "commit"}, {"oid": "5c973d952e126afd81b88646af666713e30835f0", "url": "https://github.com/apache/flink/commit/5c973d952e126afd81b88646af666713e30835f0", "message": "add test", "committedDate": "2020-10-29T03:36:08Z", "type": "forcePushed"}]}