{"pr_number": 3248, "pr_title": "Add serialization support to kits", "pr_createdAt": "2020-05-09T15:48:13Z", "pr_url": "https://github.com/EssentialsX/Essentials/pull/3248", "timeline": [{"oid": "f471e61e2410e269ba08edf884dfe233a5d62cc9", "url": "https://github.com/EssentialsX/Essentials/commit/f471e61e2410e269ba08edf884dfe233a5d62cc9", "message": "Fix kits forever", "committedDate": "2020-05-09T02:28:28Z", "type": "commit"}, {"oid": "42cb735ec2be8f92c0787e9875b4536e50dddce7", "url": "https://github.com/EssentialsX/Essentials/commit/42cb735ec2be8f92c0787e9875b4536e50dddce7", "message": "Add config option", "committedDate": "2020-05-09T15:16:12Z", "type": "commit"}, {"oid": "e53deaa2091db2808db7e240b17248af8428e794", "url": "https://github.com/EssentialsX/Essentials/commit/e53deaa2091db2808db7e240b17248af8428e794", "message": "Default to false", "committedDate": "2020-05-09T16:48:36Z", "type": "commit"}, {"oid": "240f4711b9feee79e4b21e8e167b2586a82cb10b", "url": "https://github.com/EssentialsX/Essentials/commit/240f4711b9feee79e4b21e8e167b2586a82cb10b", "message": "Clarify further", "committedDate": "2020-05-17T16:30:44Z", "type": "commit"}, {"oid": "b952b3fbe70dc68981e6b48d61e519c678e79efe", "url": "https://github.com/EssentialsX/Essentials/commit/b952b3fbe70dc68981e6b48d61e519c678e79efe", "message": "Fix kits forever", "committedDate": "2020-07-01T14:33:37Z", "type": "commit"}, {"oid": "f295bc302d7fc290ebe9593474e3cfd959520c6c", "url": "https://github.com/EssentialsX/Essentials/commit/f295bc302d7fc290ebe9593474e3cfd959520c6c", "message": "Add config option", "committedDate": "2020-07-01T14:33:44Z", "type": "commit"}, {"oid": "820bdbfdb44021ff06bc51c0e6b58f3aab81ca84", "url": "https://github.com/EssentialsX/Essentials/commit/820bdbfdb44021ff06bc51c0e6b58f3aab81ca84", "message": "Default to false", "committedDate": "2020-07-01T14:33:44Z", "type": "commit"}, {"oid": "c396893b8b8696c902bc9fc9fc978dbaf2636712", "url": "https://github.com/EssentialsX/Essentials/commit/c396893b8b8696c902bc9fc9fc978dbaf2636712", "message": "Clarify further", "committedDate": "2020-07-01T14:33:45Z", "type": "commit"}, {"oid": "9e553db82a941d83d7a118138c393ed795b564b9", "url": "https://github.com/EssentialsX/Essentials/commit/9e553db82a941d83d7a118138c393ed795b564b9", "message": "Merge remote-tracking branch 'origin/feature/usable-kits' into feature/usable-kits", "committedDate": "2020-07-01T14:42:21Z", "type": "commit"}, {"oid": "9e553db82a941d83d7a118138c393ed795b564b9", "url": "https://github.com/EssentialsX/Essentials/commit/9e553db82a941d83d7a118138c393ed795b564b9", "message": "Merge remote-tracking branch 'origin/feature/usable-kits' into feature/usable-kits", "committedDate": "2020-07-01T14:42:21Z", "type": "forcePushed"}, {"oid": "f5c58e797d4827a2a4890b6a563cdf609e78c784", "url": "https://github.com/EssentialsX/Essentials/commit/f5c58e797d4827a2a4890b6a563cdf609e78c784", "message": "Use paper serialization and say yolo to spigot", "committedDate": "2020-07-01T16:30:50Z", "type": "commit"}, {"oid": "36be08759d7ed4929a3e4f14fa898ad88000aca5", "url": "https://github.com/EssentialsX/Essentials/commit/36be08759d7ed4929a3e4f14fa898ad88000aca5", "message": "Fix default value", "committedDate": "2020-07-01T16:32:19Z", "type": "commit"}, {"oid": "b7a96bbf254d7fc2388bba07c3d86471a112cb71", "url": "https://github.com/EssentialsX/Essentials/commit/b7a96bbf254d7fc2388bba07c3d86471a112cb71", "message": "FURTHER clarify config option", "committedDate": "2020-07-01T16:33:11Z", "type": "commit"}, {"oid": "b12ff883cf3c9eb805b696d2db6fb2442fe7df20", "url": "https://github.com/EssentialsX/Essentials/commit/b12ff883cf3c9eb805b696d2db6fb2442fe7df20", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2020-07-02T21:59:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA3Mzc1Mw==", "url": "https://github.com/EssentialsX/Essentials/pull/3248#discussion_r465073753", "bodyText": "Should be translated", "author": "mdcfe", "createdAt": "2020-08-04T14:03:23Z", "path": "Essentials/src/com/earth2me/essentials/Kit.java", "diffHunk": "@@ -178,6 +182,15 @@ public boolean expandItems(final User user, final List<String> items) throws Exc\n                     continue;\n                 }\n \n+                if (kitItem.startsWith(\"@\")) {\n+                    if (ess.getSerializationProvider() == null) {\n+                        ess.getLogger().log(Level.WARNING, \"Cannot give kit item in kit \\\"\" + kitName + \"\\\" to user \" + user.getName() + \" as kit item requires Paper 1.15.2+ to deserialize.\");", "originalCommit": "b12ff883cf3c9eb805b696d2db6fb2442fe7df20", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "35dd6e64c2b43ee806e2d689b306026ddf2cf78b", "chunk": "diff --git a/Essentials/src/com/earth2me/essentials/Kit.java b/Essentials/src/com/earth2me/essentials/Kit.java\nindex c34e3fcc1..6743454ef 100644\n--- a/Essentials/src/com/earth2me/essentials/Kit.java\n+++ b/Essentials/src/com/earth2me/essentials/Kit.java\n\n@@ -184,7 +184,7 @@ public class Kit {\n \n                 if (kitItem.startsWith(\"@\")) {\n                     if (ess.getSerializationProvider() == null) {\n-                        ess.getLogger().log(Level.WARNING, \"Cannot give kit item in kit \\\"\" + kitName + \"\\\" to user \" + user.getName() + \" as kit item requires Paper 1.15.2+ to deserialize.\");\n+                        ess.getLogger().log(Level.WARNING, tl(\"kitError3\", kitName, user.getName()));\n                         continue;\n                     }\n                     itemList.add(ess.getSerializationProvider().deserializeItem(Base64Coder.decodeLines(kitItem.substring(1))));\n"}}, {"oid": "d74ecb526ce273fa1cc09dc94690be9063715668", "url": "https://github.com/EssentialsX/Essentials/commit/d74ecb526ce273fa1cc09dc94690be9063715668", "message": "Update Essentials/src/messages.properties\n\nCo-authored-by: MD <1917406+md678685@users.noreply.github.com>", "committedDate": "2020-08-04T15:41:52Z", "type": "commit"}, {"oid": "1c54694cdbc7ce97312f9b8e6615dc59e9c888e0", "url": "https://github.com/EssentialsX/Essentials/commit/1c54694cdbc7ce97312f9b8e6615dc59e9c888e0", "message": "Update Essentials/src/config.yml\n\nCo-authored-by: MD <1917406+md678685@users.noreply.github.com>", "committedDate": "2020-08-04T15:42:03Z", "type": "commit"}, {"oid": "35dd6e64c2b43ee806e2d689b306026ddf2cf78b", "url": "https://github.com/EssentialsX/Essentials/commit/35dd6e64c2b43ee806e2d689b306026ddf2cf78b", "message": "Translate warning", "committedDate": "2020-08-22T18:03:45Z", "type": "commit"}, {"oid": "302ff37f2360964b61d05c95e5d42b413e4e0f03", "url": "https://github.com/EssentialsX/Essentials/commit/302ff37f2360964b61d05c95e5d42b413e4e0f03", "message": "Merge branch '2.x' into feature/usable-kits\n\n# Conflicts:\n#\tEssentials/src/com/earth2me/essentials/Essentials.java\n#\tEssentials/src/com/earth2me/essentials/IEssentials.java\n#\tEssentials/src/com/earth2me/essentials/commands/Commandcreatekit.java", "committedDate": "2020-10-05T06:44:48Z", "type": "commit"}, {"oid": "bed31e806ed50fd86793f1e377773c5c72010602", "url": "https://github.com/EssentialsX/Essentials/commit/bed31e806ed50fd86793f1e377773c5c72010602", "message": "Merge branch '2.x' into feature/usable-kits\n\n# Conflicts:\n#\tEssentials/src/com/earth2me/essentials/Essentials.java\n#\tEssentials/src/com/earth2me/essentials/IEssentials.java", "committedDate": "2020-10-09T21:19:56Z", "type": "commit"}, {"oid": "7b98ad26353977f958741325646c4aa127b0b577", "url": "https://github.com/EssentialsX/Essentials/commit/7b98ad26353977f958741325646c4aa127b0b577", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2020-10-20T12:58:40Z", "type": "commit"}, {"oid": "6fb7d04dc8f8c4950fc15ee5b87bca98005c18cd", "url": "https://github.com/EssentialsX/Essentials/commit/6fb7d04dc8f8c4950fc15ee5b87bca98005c18cd", "message": "Add note about downgrading", "committedDate": "2020-10-22T15:40:14Z", "type": "commit"}, {"oid": "1c0fd6f03e2f8d839260e5c63c2e829312f42d73", "url": "https://github.com/EssentialsX/Essentials/commit/1c0fd6f03e2f8d839260e5c63c2e829312f42d73", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2020-11-25T22:04:08Z", "type": "commit"}, {"oid": "118d138109b004044272563bc6f7ba560244d809", "url": "https://github.com/EssentialsX/Essentials/commit/118d138109b004044272563bc6f7ba560244d809", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-01-22T12:40:37Z", "type": "commit"}, {"oid": "55a90dca7f3233f2589b701c0108f3dbfbf09d12", "url": "https://github.com/EssentialsX/Essentials/commit/55a90dca7f3233f2589b701c0108f3dbfbf09d12", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-02-20T16:32:12Z", "type": "commit"}, {"oid": "d18b70a99c3dd88d89f4703a5f1de1d4cc1c7fcb", "url": "https://github.com/EssentialsX/Essentials/commit/d18b70a99c3dd88d89f4703a5f1de1d4cc1c7fcb", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-03-06T23:39:12Z", "type": "commit"}, {"oid": "3cbc9fc876107157fe43a409164487b30947d4ff", "url": "https://github.com/EssentialsX/Essentials/commit/3cbc9fc876107157fe43a409164487b30947d4ff", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-03-19T04:17:51Z", "type": "commit"}, {"oid": "3ae508dc46697db073dccbdc196ecdbdca3e4d03", "url": "https://github.com/EssentialsX/Essentials/commit/3ae508dc46697db073dccbdc196ecdbdca3e4d03", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-04-08T01:43:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgxNTk5OA==", "url": "https://github.com/EssentialsX/Essentials/pull/3248#discussion_r611815998", "bodyText": "A non-primitive is by default null; this breaks the style around unnecessarily.", "author": "Proximyst", "createdAt": "2021-04-12T17:20:50Z", "path": "Essentials/src/main/java/com/earth2me/essentials/Essentials.java", "diffHunk": "@@ -144,6 +146,7 @@\n     private transient PotionMetaProvider potionMetaProvider;\n     private transient ServerStateProvider serverStateProvider;\n     private transient ContainerProvider containerProvider;\n+    private transient SerializationProvider serializationProvider = null;", "originalCommit": "3ae508dc46697db073dccbdc196ecdbdca3e4d03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgxODA2Ng==", "url": "https://github.com/EssentialsX/Essentials/pull/3248#discussion_r611818066", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private transient SerializationProvider serializationProvider = null;\n          \n          \n            \n                private transient SerializationProvider serializationProvider;", "author": "JRoy", "createdAt": "2021-04-12T17:24:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgxNTk5OA=="}], "type": "inlineReview", "revised_code": {"commit": "20c2628ac2b2678392daa4847b8a5d288be2f2fd", "chunk": "diff --git a/Essentials/src/main/java/com/earth2me/essentials/Essentials.java b/Essentials/src/main/java/com/earth2me/essentials/Essentials.java\nindex 26a3879e5..8a7eb8b32 100644\n--- a/Essentials/src/main/java/com/earth2me/essentials/Essentials.java\n+++ b/Essentials/src/main/java/com/earth2me/essentials/Essentials.java\n\n@@ -146,7 +146,7 @@ public class Essentials extends JavaPlugin implements net.ess3.api.IEssentials {\n     private transient PotionMetaProvider potionMetaProvider;\n     private transient ServerStateProvider serverStateProvider;\n     private transient ContainerProvider containerProvider;\n-    private transient SerializationProvider serializationProvider = null;\n+    private transient SerializationProvider serializationProvider;\n     private transient KnownCommandsProvider knownCommandsProvider;\n     private transient FormattedCommandAliasProvider formattedCommandAliasProvider;\n     private transient ProviderListener recipeBookEventProvider;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgxNjc4OQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3248#discussion_r611816789", "bodyText": "Perhaps rename this as it may not be unique to Paper forever? E.g. useSerializationProvider", "author": "Proximyst", "createdAt": "2021-04-12T17:22:03Z", "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java", "diffHunk": "@@ -60,9 +61,22 @@ public void run(final Server server, final User user, final String commandLabel,\n         final String kitname = args[0];\n         final ItemStack[] items = user.getBase().getInventory().getContents();\n         final List<String> list = new ArrayList<>();\n-        for (final ItemStack is : items) {\n+\n+        boolean usePaperSerial = ess.getSettings().isUseBetterKits();", "originalCommit": "3ae508dc46697db073dccbdc196ecdbdca3e4d03", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "20c2628ac2b2678392daa4847b8a5d288be2f2fd", "chunk": "diff --git a/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java b/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\nindex 40272ab04..c4f1cf61f 100644\n--- a/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\n+++ b/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\n\n@@ -62,17 +62,17 @@ public class Commandcreatekit extends EssentialsCommand {\n         final ItemStack[] items = user.getBase().getInventory().getContents();\n         final List<String> list = new ArrayList<>();\n \n-        boolean usePaperSerial = ess.getSettings().isUseBetterKits();\n+        boolean useSerializationProvider = ess.getSettings().isUseBetterKits();\n \n-        if (usePaperSerial && ess.getSerializationProvider() == null) {\n+        if (useSerializationProvider && ess.getSerializationProvider() == null) {\n             ess.showError(user.getSource(), new Exception(tl(\"createKitUnsupported\")), commandLabel);\n-            usePaperSerial = false;\n+            useSerializationProvider = false;\n         }\n \n         for (ItemStack is : items) {\n             if (is != null && is.getType() != null && is.getType() != Material.AIR) {\n                 final String serialized;\n-                if (usePaperSerial) {\n+                if (useSerializationProvider) {\n                     serialized = \"@\" + Base64Coder.encodeLines(ess.getSerializationProvider().serializeItem(is));\n                 } else {\n                     serialized = ess.getItemDb().serialize(is);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgxOTE5Mg==", "url": "https://github.com/EssentialsX/Essentials/pull/3248#discussion_r611819192", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    boolean usePaperSerial = ess.getSettings().isUseBetterKits();\n          \n          \n            \n                    boolean useSerializationProvider = ess.getSettings().isUseBetterKits();", "author": "JRoy", "createdAt": "2021-04-12T17:25:41Z", "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java", "diffHunk": "@@ -60,9 +61,22 @@ public void run(final Server server, final User user, final String commandLabel,\n         final String kitname = args[0];\n         final ItemStack[] items = user.getBase().getInventory().getContents();\n         final List<String> list = new ArrayList<>();\n-        for (final ItemStack is : items) {\n+\n+        boolean usePaperSerial = ess.getSettings().isUseBetterKits();", "originalCommit": "3ae508dc46697db073dccbdc196ecdbdca3e4d03", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "20c2628ac2b2678392daa4847b8a5d288be2f2fd", "chunk": "diff --git a/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java b/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\nindex 40272ab04..c4f1cf61f 100644\n--- a/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\n+++ b/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\n\n@@ -62,17 +62,17 @@ public class Commandcreatekit extends EssentialsCommand {\n         final ItemStack[] items = user.getBase().getInventory().getContents();\n         final List<String> list = new ArrayList<>();\n \n-        boolean usePaperSerial = ess.getSettings().isUseBetterKits();\n+        boolean useSerializationProvider = ess.getSettings().isUseBetterKits();\n \n-        if (usePaperSerial && ess.getSerializationProvider() == null) {\n+        if (useSerializationProvider && ess.getSerializationProvider() == null) {\n             ess.showError(user.getSource(), new Exception(tl(\"createKitUnsupported\")), commandLabel);\n-            usePaperSerial = false;\n+            useSerializationProvider = false;\n         }\n \n         for (ItemStack is : items) {\n             if (is != null && is.getType() != null && is.getType() != Material.AIR) {\n                 final String serialized;\n-                if (usePaperSerial) {\n+                if (useSerializationProvider) {\n                     serialized = \"@\" + Base64Coder.encodeLines(ess.getSerializationProvider().serializeItem(is));\n                 } else {\n                     serialized = ess.getItemDb().serialize(is);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgxOTY4Nw==", "url": "https://github.com/EssentialsX/Essentials/pull/3248#discussion_r611819687", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (usePaperSerial && ess.getSerializationProvider() == null) {\n          \n          \n            \n                        ess.showError(user.getSource(), new Exception(tl(\"createKitUnsupported\")), commandLabel);\n          \n          \n            \n                        usePaperSerial = false;\n          \n          \n            \n                    if (useSerializationProvider && ess.getSerializationProvider() == null) {\n          \n          \n            \n                        ess.showError(user.getSource(), new Exception(tl(\"createKitUnsupported\")), commandLabel);\n          \n          \n            \n                        useSerializationProvider = false;", "author": "JRoy", "createdAt": "2021-04-12T17:26:19Z", "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java", "diffHunk": "@@ -60,9 +61,22 @@ public void run(final Server server, final User user, final String commandLabel,\n         final String kitname = args[0];\n         final ItemStack[] items = user.getBase().getInventory().getContents();\n         final List<String> list = new ArrayList<>();\n-        for (final ItemStack is : items) {\n+\n+        boolean usePaperSerial = ess.getSettings().isUseBetterKits();\n+\n+        if (usePaperSerial && ess.getSerializationProvider() == null) {\n+            ess.showError(user.getSource(), new Exception(tl(\"createKitUnsupported\")), commandLabel);\n+            usePaperSerial = false;", "originalCommit": "3ae508dc46697db073dccbdc196ecdbdca3e4d03", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "20c2628ac2b2678392daa4847b8a5d288be2f2fd", "chunk": "diff --git a/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java b/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\nindex 40272ab04..c4f1cf61f 100644\n--- a/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\n+++ b/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\n\n@@ -62,17 +62,17 @@ public class Commandcreatekit extends EssentialsCommand {\n         final ItemStack[] items = user.getBase().getInventory().getContents();\n         final List<String> list = new ArrayList<>();\n \n-        boolean usePaperSerial = ess.getSettings().isUseBetterKits();\n+        boolean useSerializationProvider = ess.getSettings().isUseBetterKits();\n \n-        if (usePaperSerial && ess.getSerializationProvider() == null) {\n+        if (useSerializationProvider && ess.getSerializationProvider() == null) {\n             ess.showError(user.getSource(), new Exception(tl(\"createKitUnsupported\")), commandLabel);\n-            usePaperSerial = false;\n+            useSerializationProvider = false;\n         }\n \n         for (ItemStack is : items) {\n             if (is != null && is.getType() != null && is.getType() != Material.AIR) {\n                 final String serialized;\n-                if (usePaperSerial) {\n+                if (useSerializationProvider) {\n                     serialized = \"@\" + Base64Coder.encodeLines(ess.getSerializationProvider().serializeItem(is));\n                 } else {\n                     serialized = ess.getItemDb().serialize(is);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgxOTc5Mw==", "url": "https://github.com/EssentialsX/Essentials/pull/3248#discussion_r611819793", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (usePaperSerial) {\n          \n          \n            \n                            if (useSerializationProvider) {", "author": "JRoy", "createdAt": "2021-04-12T17:26:27Z", "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java", "diffHunk": "@@ -60,9 +61,22 @@ public void run(final Server server, final User user, final String commandLabel,\n         final String kitname = args[0];\n         final ItemStack[] items = user.getBase().getInventory().getContents();\n         final List<String> list = new ArrayList<>();\n-        for (final ItemStack is : items) {\n+\n+        boolean usePaperSerial = ess.getSettings().isUseBetterKits();\n+\n+        if (usePaperSerial && ess.getSerializationProvider() == null) {\n+            ess.showError(user.getSource(), new Exception(tl(\"createKitUnsupported\")), commandLabel);\n+            usePaperSerial = false;\n+        }\n+\n+        for (ItemStack is : items) {\n             if (is != null && is.getType() != null && is.getType() != Material.AIR) {\n-                final String serialized = ess.getItemDb().serialize(is);\n+                final String serialized;\n+                if (usePaperSerial) {", "originalCommit": "3ae508dc46697db073dccbdc196ecdbdca3e4d03", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "20c2628ac2b2678392daa4847b8a5d288be2f2fd", "chunk": "diff --git a/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java b/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\nindex 40272ab04..c4f1cf61f 100644\n--- a/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\n+++ b/Essentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java\n\n@@ -62,17 +62,17 @@ public class Commandcreatekit extends EssentialsCommand {\n         final ItemStack[] items = user.getBase().getInventory().getContents();\n         final List<String> list = new ArrayList<>();\n \n-        boolean usePaperSerial = ess.getSettings().isUseBetterKits();\n+        boolean useSerializationProvider = ess.getSettings().isUseBetterKits();\n \n-        if (usePaperSerial && ess.getSerializationProvider() == null) {\n+        if (useSerializationProvider && ess.getSerializationProvider() == null) {\n             ess.showError(user.getSource(), new Exception(tl(\"createKitUnsupported\")), commandLabel);\n-            usePaperSerial = false;\n+            useSerializationProvider = false;\n         }\n \n         for (ItemStack is : items) {\n             if (is != null && is.getType() != null && is.getType() != Material.AIR) {\n                 final String serialized;\n-                if (usePaperSerial) {\n+                if (useSerializationProvider) {\n                     serialized = \"@\" + Base64Coder.encodeLines(ess.getSerializationProvider().serializeItem(is));\n                 } else {\n                     serialized = ess.getItemDb().serialize(is);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgyMDI4OQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3248#discussion_r611820289", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return config.getBoolean(\"use-paper-serialization-in-createkit\", false);\n          \n          \n            \n                    return config.getBoolean(\"use-nbt-serialization-in-createkit\", false);", "author": "JRoy", "createdAt": "2021-04-12T17:27:11Z", "path": "Essentials/src/main/java/com/earth2me/essentials/Settings.java", "diffHunk": "@@ -1645,6 +1645,11 @@ public boolean isPastebinCreateKit() {\n         return config.getBoolean(\"pastebin-createkit\", false);\n     }\n \n+    @Override\n+    public boolean isUseBetterKits() {\n+        return config.getBoolean(\"use-paper-serialization-in-createkit\", false);", "originalCommit": "3ae508dc46697db073dccbdc196ecdbdca3e4d03", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "20c2628ac2b2678392daa4847b8a5d288be2f2fd", "chunk": "diff --git a/Essentials/src/main/java/com/earth2me/essentials/Settings.java b/Essentials/src/main/java/com/earth2me/essentials/Settings.java\nindex c6c5f9d74..51dc1141d 100644\n--- a/Essentials/src/main/java/com/earth2me/essentials/Settings.java\n+++ b/Essentials/src/main/java/com/earth2me/essentials/Settings.java\n\n@@ -1647,7 +1647,7 @@ public class Settings implements net.ess3.api.ISettings {\n \n     @Override\n     public boolean isUseBetterKits() {\n-        return config.getBoolean(\"use-paper-serialization-in-createkit\", false);\n+        return config.getBoolean(\"use-nbt-serialization-in-createkit\", false);\n     }\n \n     @Override\n"}}, {"oid": "20c2628ac2b2678392daa4847b8a5d288be2f2fd", "url": "https://github.com/EssentialsX/Essentials/commit/20c2628ac2b2678392daa4847b8a5d288be2f2fd", "message": "Apply suggestions from code review", "committedDate": "2021-04-12T17:27:22Z", "type": "commit"}, {"oid": "b01c2cb0ad643d5af8cbf81078cca93147e8e59b", "url": "https://github.com/EssentialsX/Essentials/commit/b01c2cb0ad643d5af8cbf81078cca93147e8e59b", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-04-26T13:21:05Z", "type": "commit"}, {"oid": "8f8642b53bc08d4c21b2d0d9539d4a476e3599c4", "url": "https://github.com/EssentialsX/Essentials/commit/8f8642b53bc08d4c21b2d0d9539d4a476e3599c4", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-05-13T04:27:38Z", "type": "commit"}, {"oid": "e427d4b475f6b6869d94916bc38d9aed0fc4e249", "url": "https://github.com/EssentialsX/Essentials/commit/e427d4b475f6b6869d94916bc38d9aed0fc4e249", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-05-19T14:01:25Z", "type": "commit"}, {"oid": "f04158ce6da878ae7fc206db57f5fc4a72e6762a", "url": "https://github.com/EssentialsX/Essentials/commit/f04158ce6da878ae7fc206db57f5fc4a72e6762a", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-06-03T11:40:13Z", "type": "commit"}, {"oid": "da9521ed3fbb6d02f5aaf7b8a033eb54c899ff16", "url": "https://github.com/EssentialsX/Essentials/commit/da9521ed3fbb6d02f5aaf7b8a033eb54c899ff16", "message": "Merge branch '2.x' into feature/usable-kits\n\n# Conflicts:\n#\tEssentials/src/main/java/com/earth2me/essentials/Essentials.java\n#\tEssentials/src/main/java/com/earth2me/essentials/commands/Commandcreatekit.java", "committedDate": "2021-06-07T13:43:46Z", "type": "commit"}, {"oid": "f840ffb8cf2330445ca79e1af0addaa5d724b9d7", "url": "https://github.com/EssentialsX/Essentials/commit/f840ffb8cf2330445ca79e1af0addaa5d724b9d7", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-06-08T20:52:39Z", "type": "commit"}, {"oid": "2aeb2935766ee300d63fdede41ca9c1bfaa2d2c8", "url": "https://github.com/EssentialsX/Essentials/commit/2aeb2935766ee300d63fdede41ca9c1bfaa2d2c8", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-06-11T15:15:13Z", "type": "commit"}, {"oid": "1a99188f1e288d22e698497b6f9015f5c8daf1f8", "url": "https://github.com/EssentialsX/Essentials/commit/1a99188f1e288d22e698497b6f9015f5c8daf1f8", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-06-12T20:53:48Z", "type": "commit"}, {"oid": "4b23be95ede6e7b4a8234c33178dbaceefeae9d7", "url": "https://github.com/EssentialsX/Essentials/commit/4b23be95ede6e7b4a8234c33178dbaceefeae9d7", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-06-14T11:31:37Z", "type": "commit"}, {"oid": "5ce93568911509d6ebdb101fdb1d6b76aff9e8a1", "url": "https://github.com/EssentialsX/Essentials/commit/5ce93568911509d6ebdb101fdb1d6b76aff9e8a1", "message": "Merge branch '2.x' into feature/usable-kits", "committedDate": "2021-06-26T20:01:18Z", "type": "commit"}]}