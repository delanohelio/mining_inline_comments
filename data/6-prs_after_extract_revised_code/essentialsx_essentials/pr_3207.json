{"pr_number": 3207, "pr_title": "send-info-after-death", "pr_createdAt": "2020-04-29T07:54:00Z", "pr_url": "https://github.com/EssentialsX/Essentials/pull/3207", "timeline": [{"oid": "42c7a2a8f40c82d84210be2ae95dff05c2667121", "url": "https://github.com/EssentialsX/Essentials/commit/42c7a2a8f40c82d84210be2ae95dff05c2667121", "message": "I think I know what caused the problem with #3032, but I couldn't figure out how to fix it without making a new pull request, so here's that.\n\nCloses #2896", "committedDate": "2020-04-29T07:49:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI4NjA5OQ==", "url": "https://github.com/EssentialsX/Essentials/pull/3207#discussion_r427286099", "bodyText": "This is a tiny nitpick but IMO we should send this message before the /back message, rather than after it.", "author": "mdcfe", "createdAt": "2020-05-19T13:06:26Z", "path": "Essentials/src/com/earth2me/essentials/EssentialsEntityListener.java", "diffHunk": "@@ -152,6 +153,10 @@ public void onPlayerDeathEvent(final PlayerDeathEvent event) {\n         if (!ess.getSettings().areDeathMessagesEnabled()) {\n             event.setDeathMessage(\"\");\n         }\n+        if (ess.getSettings().infoAfterDeath()) {\n+            final Location loc = user.getLocation();\n+            user.sendMessage(tl(\"infoAfterDeath\", loc.getWorld().getName(), loc.getBlockX(), loc.getBlockY(), loc.getBlockZ()));", "originalCommit": "42c7a2a8f40c82d84210be2ae95dff05c2667121", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2076500ff42c53f3add3bc89414d74caedc358e6", "chunk": "diff --git a/Essentials/src/com/earth2me/essentials/EssentialsEntityListener.java b/Essentials/src/com/earth2me/essentials/EssentialsEntityListener.java\nindex c7df71be0..bad908628 100644\n--- a/Essentials/src/com/earth2me/essentials/EssentialsEntityListener.java\n+++ b/Essentials/src/com/earth2me/essentials/EssentialsEntityListener.java\n\n@@ -146,6 +146,10 @@ public class EssentialsEntityListener implements Listener {\n             return;\n         }\n         final User user = ess.getUser(event.getEntity());\n+        if (ess.getSettings().infoAfterDeath()) {\n+            final Location loc = user.getLocation();\n+            user.sendMessage(tl(\"infoAfterDeath\", loc.getWorld().getName(), loc.getBlockX(), loc.getBlockY(), loc.getBlockZ()));\n+        }\n         if (user.isAuthorized(\"essentials.back.ondeath\") && !ess.getSettings().isCommandDisabled(\"back\")) {\n             user.setLastLocation();\n             user.sendMessage(tl(\"backAfterDeath\"));\n"}}, {"oid": "2076500ff42c53f3add3bc89414d74caedc358e6", "url": "https://github.com/EssentialsX/Essentials/commit/2076500ff42c53f3add3bc89414d74caedc358e6", "message": "infoAfterDeath is now sent before the /back message", "committedDate": "2020-05-19T18:41:03Z", "type": "commit"}]}