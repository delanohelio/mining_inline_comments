{"pr_number": 2388, "pr_title": "Add child collection to the entity class in Firestore sample", "pr_createdAt": "2020-05-21T21:50:04Z", "pr_url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2388", "timeline": [{"oid": "09b054cb87b30825bf8081edcd0eebba2c58d70a", "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/09b054cb87b30825bf8081edcd0eebba2c58d70a", "message": "add child collection to the entity class", "committedDate": "2020-05-21T21:44:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU4ODgwOA==", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2388#discussion_r429588808", "bodyText": "Can we add assertions for verifying that these pets were added?", "author": "meltsufin", "createdAt": "2020-05-24T00:39:39Z", "path": "spring-cloud-gcp-samples/spring-cloud-gcp-data-firestore-sample/src/test/java/com/example/FirestoreSampleApplicationTests.java", "diffHunk": "@@ -70,9 +70,9 @@ public void saveUserTest() {\n \t\tUser[] users = restTemplate.getForObject(\"/users\", User[].class);\n \t\tassertThat(users).isEmpty();\n \n-\t\tsendPostRequestForUser(\"Alpha\", 49);\n-\t\tsendPostRequestForUser(\"Beta\", 23);\n-\t\tsendPostRequestForUser(\"Delta\", 49);\n+\t\tsendPostRequestForUser(\"Alpha\", 49, \"rat-Snowflake\");\n+\t\tsendPostRequestForUser(\"Beta\", 23, \"\");\n+\t\tsendPostRequestForUser(\"Delta\", 49, \"fish-Dory,spider-Man\");", "originalCommit": "09b054cb87b30825bf8081edcd0eebba2c58d70a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "120c6b6f2a5b60ac59f4b95488567295032345c3", "chunk": "diff --git a/spring-cloud-gcp-samples/spring-cloud-gcp-data-firestore-sample/src/test/java/com/example/FirestoreSampleApplicationTests.java b/spring-cloud-gcp-samples/spring-cloud-gcp-data-firestore-sample/src/test/java/com/example/FirestoreSampleApplicationTests.java\nindex 8a16de652..bea3454d6 100644\n--- a/spring-cloud-gcp-samples/spring-cloud-gcp-data-firestore-sample/src/test/java/com/example/FirestoreSampleApplicationTests.java\n+++ b/spring-cloud-gcp-samples/spring-cloud-gcp-data-firestore-sample/src/test/java/com/example/FirestoreSampleApplicationTests.java\n\n@@ -74,13 +75,18 @@ public class FirestoreSampleApplicationTests {\n \t\tsendPostRequestForUser(\"Beta\", 23, \"\");\n \t\tsendPostRequestForUser(\"Delta\", 49, \"fish-Dory,spider-Man\");\n \n-\t\tusers = restTemplate.getForObject(\"/users\", User[].class);\n-\t\tList<String> names = Arrays.stream(users).map(User::getName).collect(Collectors.toList());\n+\t\tUser[] allUsers = restTemplate.getForObject(\"/users\", User[].class);\n+\t\tList<String> names = Arrays.stream(allUsers).map(User::getName).collect(Collectors.toList());\n \t\tassertThat(names).containsExactlyInAnyOrder(\"Alpha\", \"Beta\", \"Delta\");\n \n-\t\tusers = restTemplate.getForObject(\"/users/age?age=49\", User[].class);\n-\t\tList<String> filterNames = Arrays.stream(users).map(User::getName).collect(Collectors.toList());\n-\t\tassertThat(filterNames).containsExactlyInAnyOrder(\"Alpha\", \"Delta\");\n+\t\tUser[] users49 = restTemplate.getForObject(\"/users/age?age=49\", User[].class);\n+\t\tassertThat(users49).containsExactlyInAnyOrder(\n+\t\t\t\tnew User(\"Alpha\", 49,\n+\t\t\t\t\t\tCollections.singletonList(new Pet(\"rat\", \"Snowflake\"))),\n+\t\t\t\tnew User(\"Delta\", 49,\n+\t\t\t\t\t\tArrays.asList(new Pet(\"fish\", \"Dory\"),\n+\t\t\t\t\t\t\t\tnew Pet(\"spider\", \"Man\")))\n+\t\t\t\t);\n \t}\n \n \t/**\n"}}, {"oid": "120c6b6f2a5b60ac59f4b95488567295032345c3", "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/120c6b6f2a5b60ac59f4b95488567295032345c3", "message": "make sure that pets have been saved", "committedDate": "2020-05-26T18:46:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNjg0Nw==", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2388#discussion_r430636847", "bodyText": "Might be helpful to add an extra comment here to draw attention to it, like:\n// This represents a Firestore child collection\nList<Pet> pets;", "author": "dzou", "createdAt": "2020-05-26T18:56:45Z", "path": "spring-cloud-gcp-samples/spring-cloud-gcp-data-firestore-sample/src/main/java/com/example/User.java", "diffHunk": "@@ -33,12 +37,16 @@\n \n \tint age;\n \n+\tList<Pet> pets;", "originalCommit": "120c6b6f2a5b60ac59f4b95488567295032345c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzODkzNA==", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2388#discussion_r430638934", "bodyText": "I think that should be clear from the context.", "author": "dmitry-s", "createdAt": "2020-05-26T19:00:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNjg0Nw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "844929fb58d86177e452ec2988af89ceb44867bd", "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/844929fb58d86177e452ec2988af89ceb44867bd", "message": "Update spring-cloud-gcp-samples/spring-cloud-gcp-data-firestore-sample/src/main/resources/static/index.html\n\nCo-authored-by: Daniel Zou <dzou@users.noreply.github.com>", "committedDate": "2020-05-26T18:59:18Z", "type": "commit"}]}