{"pr_number": 6020, "pr_title": "Fast/compost", "pr_createdAt": "2020-11-01T18:46:22Z", "pr_url": "https://github.com/ldtteam/minecolonies/pull/6020", "timeline": [{"oid": "802989a7978f56bebd6e81141f9f1d4fe646079c", "url": "https://github.com/ldtteam/minecolonies/commit/802989a7978f56bebd6e81141f9f1d4fe646079c", "message": "add barrel acceleration", "committedDate": "2020-11-01T18:44:47Z", "type": "commit"}, {"oid": "13eb0ee0d45d23955473a98aa05b95fe562a3514", "url": "https://github.com/ldtteam/minecolonies/commit/13eb0ee0d45d23955473a98aa05b95fe562a3514", "message": "ensure that we don't block when accellerating", "committedDate": "2020-11-01T18:45:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2NDY5OQ==", "url": "https://github.com/ldtteam/minecolonies/pull/6020#discussion_r515664699", "bodyText": "Is this even valid?\nThis should probably return some same default state.", "author": "OrionDevelopment", "createdAt": "2020-11-01T19:57:27Z", "path": "src/main/java/com/minecolonies/coremod/entity/ai/basic/AbstractEntityAIUsesFurnace.java", "diffHunk": "@@ -231,7 +231,7 @@ private IAIState accelerateFurnaces()\n                 }\n             }\n         }\n-        return getState();\n+        return null;", "originalCommit": "13eb0ee0d45d23955473a98aa05b95fe562a3514", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY4Njk5OQ==", "url": "https://github.com/ldtteam/minecolonies/pull/6020#discussion_r515686999", "bodyText": "Actually, there is a significant behavior difference between null and getState. Returning a valid state here stops further execution on that tick, where returning null allows further execution. I can add comments here, though I found that documentation in AbstractEntityAIBasic", "author": "Mekle001", "createdAt": "2020-11-01T23:24:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2NDY5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY4ODI3MQ==", "url": "https://github.com/ldtteam/minecolonies/pull/6020#discussion_r515688271", "bodyText": "@someaddons can probably confirm", "author": "Raycoms", "createdAt": "2020-11-01T23:34:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2NDY5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY5MDI0OA==", "url": "https://github.com/ldtteam/minecolonies/pull/6020#discussion_r515690248", "bodyText": "ye null state return means no action, not null means we traverse into that state and do not check further transitions of this state in the current tick. I thought about changing it, but back then this was needed for backwards compat due to the way our AI is structured/used.", "author": "someaddons", "createdAt": "2020-11-01T23:52:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2NDY5OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2NDc5MA==", "url": "https://github.com/ldtteam/minecolonies/pull/6020#discussion_r515664790", "bodyText": "Again return some same default state here.", "author": "OrionDevelopment", "createdAt": "2020-11-01T19:58:29Z", "path": "src/main/java/com/minecolonies/coremod/entity/ai/citizen/composter/EntityAIWorkComposter.java", "diffHunk": "@@ -92,6 +97,35 @@ public EntityAIWorkComposter(@NotNull final JobComposter job)\n         worker.setCanPickUpLoot(true);\n     }\n \n+    /**\n+     * Actually accelerate the Barrels\n+     */\n+    private IAIState accelerateBarrels()\n+    {\n+        final int accelerationTicks = (worker.getCitizenData().getCitizenSkillHandler().getLevel(getOwnBuilding().getPrimarySkill()) / 10) * 2;\n+        final World world = getOwnBuilding().getColony().getWorld();\n+        for (final BlockPos pos : getOwnBuilding().getBarrels())\n+        {\n+            if (WorldUtil.isBlockLoaded(world, pos))\n+            {\n+                final TileEntity entity = world.getTileEntity(pos);\n+                if (entity instanceof TileEntityBarrel)\n+                {\n+                    final TileEntityBarrel barrel = (TileEntityBarrel) entity;\n+                    for(int i = 0; i < accelerationTicks; i++)\n+                    {\n+                        if (barrel.checkIfWorking() && !barrel.isDone())\n+                        {\n+                            barrel.tick();\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+        return null;", "originalCommit": "13eb0ee0d45d23955473a98aa05b95fe562a3514", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY4NzAzNA==", "url": "https://github.com/ldtteam/minecolonies/pull/6020#discussion_r515687034", "bodyText": "See previous comments", "author": "Mekle001", "createdAt": "2020-11-01T23:24:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2NDc5MA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "df9401f921d77016bdd65fd3634d2f72b274e673", "url": "https://github.com/ldtteam/minecolonies/commit/df9401f921d77016bdd65fd3634d2f72b274e673", "message": "Merge branch 'version/1.15' into fast/compost", "committedDate": "2020-11-03T09:10:26Z", "type": "commit"}]}