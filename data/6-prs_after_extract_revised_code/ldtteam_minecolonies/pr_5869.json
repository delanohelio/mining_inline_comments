{"pr_number": 5869, "pr_title": "Feature/research improvements", "pr_createdAt": "2020-10-04T09:14:21Z", "pr_url": "https://github.com/ldtteam/minecolonies/pull/5869", "timeline": [{"oid": "e42f60dd42c98dd9ee0df831fecd150b1f234a19", "url": "https://github.com/ldtteam/minecolonies/commit/e42f60dd42c98dd9ee0df831fecd150b1f234a19", "message": "first setup for some research improvements", "committedDate": "2020-10-04T08:35:56Z", "type": "commit"}, {"oid": "4862ce0e2c18a8558f3a6f63f061ff0930376db8", "url": "https://github.com/ldtteam/minecolonies/commit/4862ce0e2c18a8558f3a6f63f061ff0930376db8", "message": "Adjust research tree slightly", "committedDate": "2020-10-04T09:12:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI0NTIwMQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5869#discussion_r499245201", "bodyText": "leveling bonus for xp applied to happiness?", "author": "someaddons", "createdAt": "2020-10-04T13:11:05Z", "path": "src/main/java/com/minecolonies/coremod/entity/citizen/citizenhandlers/CitizenHappinessHandler.java", "diffHunk": "@@ -140,7 +142,15 @@ public double getHappiness()\n                 totalWeight += happinessModifier.getWeight();\n             }\n \n-            cachedHappiness = Math.min(10.0 * (total / totalWeight), 10);\n+            double happinessResult = (total / totalWeight);\n+            final MultiplierModifierResearchEffect xpBonus =\n+              colony.getResearchManager().getResearchEffects().getEffect(LEVELING, MultiplierModifierResearchEffect.class);", "originalCommit": "4862ce0e2c18a8558f3a6f63f061ff0930376db8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI2MzkyNA==", "url": "https://github.com/ldtteam/minecolonies/pull/5869#discussion_r499263924", "bodyText": "yee, fixed", "author": "Raycoms", "createdAt": "2020-10-04T16:27:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI0NTIwMQ=="}], "type": "inlineReview", "revised_code": {"commit": "f4510827da38711a90bfbd3429128ce8eb4c53e1", "chunk": "diff --git a/src/main/java/com/minecolonies/coremod/entity/citizen/citizenhandlers/CitizenHappinessHandler.java b/src/main/java/com/minecolonies/coremod/entity/citizen/citizenhandlers/CitizenHappinessHandler.java\nindex f2354f4227..5f268a2254 100755\n--- a/src/main/java/com/minecolonies/coremod/entity/citizen/citizenhandlers/CitizenHappinessHandler.java\n+++ b/src/main/java/com/minecolonies/coremod/entity/citizen/citizenhandlers/CitizenHappinessHandler.java\n\n@@ -144,7 +144,7 @@ public class CitizenHappinessHandler implements ICitizenHappinessHandler\n \n             double happinessResult = (total / totalWeight);\n             final MultiplierModifierResearchEffect xpBonus =\n-              colony.getResearchManager().getResearchEffects().getEffect(LEVELING, MultiplierModifierResearchEffect.class);\n+              colony.getResearchManager().getResearchEffects().getEffect(HAPPINESS, MultiplierModifierResearchEffect.class);\n             if (xpBonus != null)\n             {\n                 happinessResult *= (1 + xpBonus.getEffect());\n"}}, {"oid": "f4510827da38711a90bfbd3429128ce8eb4c53e1", "url": "https://github.com/ldtteam/minecolonies/commit/f4510827da38711a90bfbd3429128ce8eb4c53e1", "message": "Improve GUI handling", "committedDate": "2020-10-04T16:26:56Z", "type": "commit"}, {"oid": "415e87619ec3f50c1e1f083f85f092141af2c9cb", "url": "https://github.com/ldtteam/minecolonies/commit/415e87619ec3f50c1e1f083f85f092141af2c9cb", "message": "Merge branch 'version/1.15' into feature/research-improvements", "committedDate": "2020-10-04T16:28:09Z", "type": "commit"}]}