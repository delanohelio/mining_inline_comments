{"pr_number": 1561, "pr_title": "Make loggers static final when possible", "pr_createdAt": "2020-06-12T01:07:32Z", "pr_url": "https://github.com/linkedin/ambry/pull/1561", "timeline": [{"oid": "e1c25ca41d9fd442866133f0784eae85daf0cbf1", "url": "https://github.com/linkedin/ambry/commit/e1c25ca41d9fd442866133f0784eae85daf0cbf1", "message": "Make loggers static final when possible\n\nIn almost all cases, loggers should be static. When run with log4j2,\nthere is more overhead to get a Logger instance, whereas with log4j1,\nusually on the first request to get a logger for a given name would be\nexpensive. This means that instantiating loggers for classes with many\ninstances such as BlobReadOptions, which is instantiated for every blob\nserved, have a visible impact when analyzed with a sampling profiler.\n\nThis commit is a mass find and replace of non-static loggers.", "committedDate": "2020-06-12T01:02:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUyNTY5Nw==", "url": "https://github.com/linkedin/ambry/pull/1561#discussion_r439525697", "bodyText": "Can you rename LOGGER to logger?", "author": "lightningrob", "createdAt": "2020-06-12T16:35:00Z", "path": "ambry-clustermap/src/main/java/com/github/ambry/clustermap/CompositeClusterManager.java", "diffHunk": "@@ -39,7 +39,6 @@\n   final StaticClusterManager staticClusterManager;\n   final HelixClusterManager helixClusterManager;\n   final HelixClusterManagerMetrics helixClusterManagerMetrics;\n-  private final Logger logger = LoggerFactory.getLogger(CompositeClusterManager.class);", "originalCommit": "e1c25ca41d9fd442866133f0784eae85daf0cbf1", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2900f0f78649c2d0d22f5bb762c130bcef2a8436", "chunk": "diff --git a/ambry-clustermap/src/main/java/com/github/ambry/clustermap/CompositeClusterManager.java b/ambry-clustermap/src/main/java/com/github/ambry/clustermap/CompositeClusterManager.java\nindex f7f20aa5f..700a74466 100644\n--- a/ambry-clustermap/src/main/java/com/github/ambry/clustermap/CompositeClusterManager.java\n+++ b/ambry-clustermap/src/main/java/com/github/ambry/clustermap/CompositeClusterManager.java\n\n@@ -35,7 +35,7 @@ import org.slf4j.LoggerFactory;\n  * and reports inconsistencies in the views from the two underlying cluster managers.\n  */\n class CompositeClusterManager implements ClusterMap {\n-  private static final Logger LOGGER = LoggerFactory.getLogger(CompositeClusterManager.class);\n+  private static final Logger logger = LoggerFactory.getLogger(CompositeClusterManager.class);\n   final StaticClusterManager staticClusterManager;\n   final HelixClusterManager helixClusterManager;\n   final HelixClusterManagerMetrics helixClusterManagerMetrics;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzMjA2MA==", "url": "https://github.com/linkedin/ambry/pull/1561#discussion_r439532060", "bodyText": "We can probably remove this second logger, it's only used in one trace message.", "author": "lightningrob", "createdAt": "2020-06-12T16:48:11Z", "path": "ambry-rest/src/main/java/com/github/ambry/rest/PublicAccessLogger.java", "diffHunk": "@@ -22,11 +22,11 @@\n  */\n public class PublicAccessLogger {\n \n-  private Logger publicAccessLogger = LoggerFactory.getLogger(\"PublicAccessLogger\");\n+  private static final Logger publicAccessLogger = LoggerFactory.getLogger(\"PublicAccessLogger\");\n \n   private final String[] requestHeaders;\n   private final String[] responseHeaders;\n-  private final Logger logger = LoggerFactory.getLogger(getClass());\n+  private static final Logger logger = LoggerFactory.getLogger(PublicAccessLogger.class);", "originalCommit": "e1c25ca41d9fd442866133f0784eae85daf0cbf1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0MDYyMA==", "url": "https://github.com/linkedin/ambry/pull/1561#discussion_r439540620", "bodyText": "Good idea, that was not a very useful log message anyways.", "author": "cgtz", "createdAt": "2020-06-12T17:05:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzMjA2MA=="}], "type": "inlineReview", "revised_code": {"commit": "2900f0f78649c2d0d22f5bb762c130bcef2a8436", "chunk": "diff --git a/ambry-rest/src/main/java/com/github/ambry/rest/PublicAccessLogger.java b/ambry-rest/src/main/java/com/github/ambry/rest/PublicAccessLogger.java\nindex 715cd4991..23ff2ddbc 100644\n--- a/ambry-rest/src/main/java/com/github/ambry/rest/PublicAccessLogger.java\n+++ b/ambry-rest/src/main/java/com/github/ambry/rest/PublicAccessLogger.java\n\n@@ -26,7 +26,6 @@ public class PublicAccessLogger {\n \n   private final String[] requestHeaders;\n   private final String[] responseHeaders;\n-  private static final Logger logger = LoggerFactory.getLogger(PublicAccessLogger.class);\n \n   /**\n    * @param requestHeaders the request headers to log.\n"}}, {"oid": "2900f0f78649c2d0d22f5bb762c130bcef2a8436", "url": "https://github.com/linkedin/ambry/commit/2900f0f78649c2d0d22f5bb762c130bcef2a8436", "message": "Address Rob's comments", "committedDate": "2020-06-12T17:07:56Z", "type": "commit"}]}