{"pr_number": 1647, "pr_title": "[Container API] Attach account id to response header for container update", "pr_createdAt": "2020-10-06T20:48:43Z", "pr_url": "https://github.com/linkedin/ambry/pull/1647", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDU4OTY3OQ==", "url": "https://github.com/linkedin/ambry/pull/1647#discussion_r500589679", "bodyText": "Most of changes in this file are made by auto-reformat in Intellij, I'll try to revert them.", "author": "jsjtzyy", "createdAt": "2020-10-06T20:54:39Z", "path": "ambry-frontend/src/test/java/com/github/ambry/frontend/FrontendIntegrationTest.java", "diffHunk": "@@ -124,30 +124,22 @@\n   private static final String HOST_NAME = \"localhost\";\n   private static final String CLUSTER_NAME = \"Cluster-name\";\n   private static boolean enableUndeleteTested = false;\n-", "originalCommit": "7d5d07838739dfeb71d1d7f8d76d43b8c898b66f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "047be28680d790d3771057a47da3c787c85fc73c", "chunk": "diff --git a/ambry-frontend/src/test/java/com/github/ambry/frontend/FrontendIntegrationTest.java b/ambry-frontend/src/test/java/com/github/ambry/frontend/FrontendIntegrationTest.java\nindex 795e57d26..3c9a52127 100644\n--- a/ambry-frontend/src/test/java/com/github/ambry/frontend/FrontendIntegrationTest.java\n+++ b/ambry-frontend/src/test/java/com/github/ambry/frontend/FrontendIntegrationTest.java\n\n@@ -124,22 +124,30 @@ public class FrontendIntegrationTest {\n   private static final String HOST_NAME = \"localhost\";\n   private static final String CLUSTER_NAME = \"Cluster-name\";\n   private static boolean enableUndeleteTested = false;\n+\n+  static {\n+    try {\n+      CLUSTER_MAP = new MockClusterMap();\n+      File trustStoreFile = File.createTempFile(\"truststore\", \".jks\");\n+      trustStoreFile.deleteOnExit();\n+      FRONTEND_VERIFIABLE_PROPS = buildFrontendVProps(trustStoreFile);\n+      SSL_CLIENT_VERIFIABLE_PROPS = TestSSLUtils.createSslProps(\"\", SSLFactory.Mode.CLIENT, trustStoreFile, \"client\");\n+      FRONTEND_CONFIG = new FrontendConfig(FRONTEND_VERIFIABLE_PROPS);\n+      ACCOUNT_SERVICE.clear();\n+      ACCOUNT_SERVICE.updateAccounts(Collections.singletonList(InMemAccountService.UNKNOWN_ACCOUNT));\n+    } catch (IOException | GeneralSecurityException e) {\n+      throw new IllegalStateException(e);\n+    }\n+  }\n+\n   private static RestServer ambryRestServer = null;\n   private static NettyClient plaintextNettyClient = null;\n   private static NettyClient sslNettyClient = null;\n+\n   private final NettyClient nettyClient;\n   private final boolean addClusterPrefix;\n   private final boolean useSSL;\n \n-  /**\n-   * @param useSSL {@code true} if SSL should be tested.\n-   */\n-  public FrontendIntegrationTest(boolean useSSL, boolean addClusterPrefix) {\n-    this.useSSL = useSSL;\n-    nettyClient = useSSL ? sslNettyClient : plaintextNettyClient;\n-    this.addClusterPrefix = addClusterPrefix;\n-  }\n-\n   /**\n    * Running it many times so that keep-alive bugs are caught.\n    * We also want to test using both the SSL and plaintext ports.\n"}}, {"oid": "047be28680d790d3771057a47da3c787c85fc73c", "url": "https://github.com/linkedin/ambry/commit/047be28680d790d3771057a47da3c787c85fc73c", "message": "[Container API] Attach account id to response header for container update\n\nPreviously, container update returns a collecion of updated result in the format of JSON.\nTo deserialize containers from JSON on client side, account id is needed bub not available\nin response. This PR attaches account id to response header which will be returned together\nwith response body (updated containers).", "committedDate": "2020-10-06T21:05:05Z", "type": "commit"}, {"oid": "047be28680d790d3771057a47da3c787c85fc73c", "url": "https://github.com/linkedin/ambry/commit/047be28680d790d3771057a47da3c787c85fc73c", "message": "[Container API] Attach account id to response header for container update\n\nPreviously, container update returns a collecion of updated result in the format of JSON.\nTo deserialize containers from JSON on client side, account id is needed bub not available\nin response. This PR attaches account id to response header which will be returned together\nwith response body (updated containers).", "committedDate": "2020-10-06T21:05:05Z", "type": "forcePushed"}, {"oid": "c407dacebee0df305d07afbc823dcd60b7e47cf7", "url": "https://github.com/linkedin/ambry/commit/c407dacebee0df305d07afbc823dcd60b7e47cf7", "message": "remove one test case (already covered)", "committedDate": "2020-10-06T21:08:01Z", "type": "commit"}]}