{"pr_number": 1653, "pr_title": "[Container API] Support getting single container from given account in ambry-frontend", "pr_createdAt": "2020-10-09T23:16:10Z", "pr_url": "https://github.com/linkedin/ambry/pull/1653", "timeline": [{"oid": "b53784f6c1cf9cc4e39b28ad133ec8ed35a74588", "url": "https://github.com/linkedin/ambry/commit/b53784f6c1cf9cc4e39b28ad133ec8ed35a74588", "message": "[Container API] Support getting single container from given account in ambry-frontend\n\nThis PR makes changes in GetAccountsHandler to support getting single container if the\nrequest path matches \"/accounts/containers\". This can avoid transmitting whole account\ninfo when number of containers in this account is super large. The account id is also attached\nto response header to help deserialize container.", "committedDate": "2020-10-09T23:59:24Z", "type": "commit"}, {"oid": "b53784f6c1cf9cc4e39b28ad133ec8ed35a74588", "url": "https://github.com/linkedin/ambry/commit/b53784f6c1cf9cc4e39b28ad133ec8ed35a74588", "message": "[Container API] Support getting single container from given account in ambry-frontend\n\nThis PR makes changes in GetAccountsHandler to support getting single container if the\nrequest path matches \"/accounts/containers\". This can avoid transmitting whole account\ninfo when number of containers in this account is super large. The account id is also attached\nto response header to help deserialize container.", "committedDate": "2020-10-09T23:59:24Z", "type": "forcePushed"}, {"oid": "8f17da781e7c7fdafe7b44caecfccc70a6416acb", "url": "https://github.com/linkedin/ambry/commit/8f17da781e7c7fdafe7b44caecfccc70a6416acb", "message": "Rename one of the account service error codes", "committedDate": "2020-10-12T00:55:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU2NTU3Nw==", "url": "https://github.com/linkedin/ambry/pull/1653#discussion_r503565577", "bodyText": "Why does this method return account along with container?  I saw you are setting the account id in the response, but can't you get that from container.getParentAccountId()?", "author": "lightningrob", "createdAt": "2020-10-12T22:29:25Z", "path": "ambry-frontend/src/main/java/com/github/ambry/frontend/GetAccountsHandler.java", "diffHunk": "@@ -152,5 +165,30 @@ private void start() {\n       }\n       return accounts;\n     }\n+\n+    /**\n+     * @return a pair of account and the container to get.\n+     * @throws RestServiceException\n+     */\n+    private Pair<Account, Container> getContainer() throws RestServiceException {", "originalCommit": "8f17da781e7c7fdafe7b44caecfccc70a6416acb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU2NzQ5MA==", "url": "https://github.com/linkedin/ambry/pull/1653#discussion_r503567490", "bodyText": "oh, that's true. Let me remove the account.", "author": "jsjtzyy", "createdAt": "2020-10-12T22:35:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU2NTU3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "4f258add53a8d4d26a46e932e0977ea3922987da", "chunk": "diff --git a/ambry-frontend/src/main/java/com/github/ambry/frontend/GetAccountsHandler.java b/ambry-frontend/src/main/java/com/github/ambry/frontend/GetAccountsHandler.java\nindex 9e4aeb03c..154dbf9cc 100644\n--- a/ambry-frontend/src/main/java/com/github/ambry/frontend/GetAccountsHandler.java\n+++ b/ambry-frontend/src/main/java/com/github/ambry/frontend/GetAccountsHandler.java\n\n@@ -167,17 +166,13 @@ class GetAccountsHandler {\n     }\n \n     /**\n-     * @return a pair of account and the container to get.\n+     * @return requested container.\n      * @throws RestServiceException\n      */\n-    private Pair<Account, Container> getContainer() throws RestServiceException {\n+    private Container getContainer() throws RestServiceException {\n       String accountName = RestUtils.getHeader(restRequest.getArgs(), RestUtils.Headers.TARGET_ACCOUNT_NAME, true);\n       String containerName = RestUtils.getHeader(restRequest.getArgs(), RestUtils.Headers.TARGET_CONTAINER_NAME, true);\n       Container container;\n-      Account account = accountService.getAccountByName(accountName);\n-      if (account == null) {\n-        throw new RestServiceException(\"Account \" + accountName + \" is not found.\", RestServiceErrorCode.NotFound);\n-      }\n       try {\n         container = accountService.getContainer(accountName, containerName);\n       } catch (AccountServiceException e) {\n"}}, {"oid": "4f258add53a8d4d26a46e932e0977ea3922987da", "url": "https://github.com/linkedin/ambry/commit/4f258add53a8d4d26a46e932e0977ea3922987da", "message": "address comment", "committedDate": "2020-10-12T22:40:17Z", "type": "commit"}]}