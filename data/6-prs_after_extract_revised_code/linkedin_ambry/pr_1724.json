{"pr_number": 1724, "pr_title": "[StorageQuota] Fix a string manipulation bug in HostnameHelper and backup file mismatch", "pr_createdAt": "2020-12-09T19:43:48Z", "pr_url": "https://github.com/linkedin/ambry/pull/1724", "timeline": [{"oid": "47c31c3358764fbd317758da0e92b65cf878d2e4", "url": "https://github.com/linkedin/ambry/commit/47c31c3358764fbd317758da0e92b65cf878d2e4", "message": "[StorageQuota] Fix a string manipulation bug in HostnameHelper", "committedDate": "2020-12-10T21:08:02Z", "type": "commit"}, {"oid": "5d036c586e7ec4ce4e92ceec1f1b014869ecde62", "url": "https://github.com/linkedin/ambry/commit/5d036c586e7ec4ce4e92ceec1f1b014869ecde62", "message": "Fix backup error", "committedDate": "2020-12-11T00:58:56Z", "type": "commit"}, {"oid": "5d036c586e7ec4ce4e92ceec1f1b014869ecde62", "url": "https://github.com/linkedin/ambry/commit/5d036c586e7ec4ce4e92ceec1f1b014869ecde62", "message": "Fix backup error", "committedDate": "2020-12-11T00:58:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTExMzEyMQ==", "url": "https://github.com/linkedin/ambry/pull/1724#discussion_r541113121", "bodyText": "minor: I would suggest this:\nif (domainName != null) {\n   domainName = domainName.trim();\n   if (!domainName.isEmpty() && domainName.charAt(0) != '.') {\n     ...\n   }\n    ...\n}", "author": "jsjtzyy", "createdAt": "2020-12-11T17:35:54Z", "path": "ambry-server/src/main/java/com/github/ambry/server/mysql/HostnameHelper.java", "diffHunk": "@@ -42,10 +48,12 @@ public HostnameHelper(AccountStatsMySqlConfig config, int port) {\n    */\n   public String simplifyHostname(String hostname) {\n     for (String domainName : domainNamesToRemove) {\n-      if (domainName.charAt(0) != '.') {\n-        domainName = \".\" + domainName;\n+      if (domainName != null && !domainName.isEmpty()) {\n+        if (domainName.charAt(0) != '.') {", "originalCommit": "5d036c586e7ec4ce4e92ceec1f1b014869ecde62", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f94041e52439d74d8f0f4b2986b9046e8bb1baed", "chunk": "diff --git a/ambry-server/src/main/java/com/github/ambry/server/mysql/HostnameHelper.java b/ambry-server/src/main/java/com/github/ambry/server/mysql/HostnameHelper.java\nindex adf308e6d..8a8a3d87e 100644\n--- a/ambry-server/src/main/java/com/github/ambry/server/mysql/HostnameHelper.java\n+++ b/ambry-server/src/main/java/com/github/ambry/server/mysql/HostnameHelper.java\n\n@@ -48,7 +48,7 @@ public class HostnameHelper {\n    */\n   public String simplifyHostname(String hostname) {\n     for (String domainName : domainNamesToRemove) {\n-      if (domainName != null && !domainName.isEmpty()) {\n+      if (domainName != null && !(domainName = domainName.trim()).isEmpty()) {\n         if (domainName.charAt(0) != '.') {\n           domainName = \".\" + domainName;\n         }\n"}}, {"oid": "f94041e52439d74d8f0f4b2986b9046e8bb1baed", "url": "https://github.com/linkedin/ambry/commit/f94041e52439d74d8f0f4b2986b9046e8bb1baed", "message": "Comments and add tests", "committedDate": "2020-12-11T18:09:19Z", "type": "commit"}]}