{"pr_number": 1499, "pr_title": "Adding extra ChannelHandlers to RestServer and RestRequestContext", "pr_createdAt": "2020-05-01T19:48:10Z", "pr_url": "https://github.com/linkedin/ambry/pull/1499", "timeline": [{"oid": "6eb4ae95359b2b0af1a1c634789a86f32c730e58", "url": "https://github.com/linkedin/ambry/commit/6eb4ae95359b2b0af1a1c634789a86f32c730e58", "message": "Add extra ChannelHandlers to RestServer", "committedDate": "2020-04-30T17:45:01Z", "type": "commit"}, {"oid": "abd53f6540f9e8ae419b88b6b2dd06a7619466e7", "url": "https://github.com/linkedin/ambry/commit/abd53f6540f9e8ae419b88b6b2dd06a7619466e7", "message": "Adding RestRequestContext", "committedDate": "2020-05-01T19:11:06Z", "type": "commit"}, {"oid": "4ff1fecec7834bd8c9af7114b886c174fcf179c4", "url": "https://github.com/linkedin/ambry/commit/4ff1fecec7834bd8c9af7114b886c174fcf179c4", "message": "Fix test", "committedDate": "2020-05-01T20:01:50Z", "type": "commit"}, {"oid": "7b683d6f8926159fc79b9a047b7980902c862cc6", "url": "https://github.com/linkedin/ambry/commit/7b683d6f8926159fc79b9a047b7980902c862cc6", "message": "Publish NettyRequest", "committedDate": "2020-05-01T21:07:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYxNzc1NQ==", "url": "https://github.com/linkedin/ambry/pull/1499#discussion_r419617755", "bodyText": "make this static, if possible", "author": "cgtz", "createdAt": "2020-05-04T17:53:05Z", "path": "ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java", "diffHunk": "@@ -661,4 +661,42 @@ public void invokeCallback(Exception exception) {\n       }\n     }\n   }\n+\n+  /**\n+   * The {@link NettyRequest}'s implementation of {@link com.github.ambry.rest.RestRequest.RestRequestContext}. It carries\n+   * {@link Channel} and {@link HttpRequest}.\n+   */\n+  public class NettyRequestContext implements RestRequestContext {", "originalCommit": "4ff1fecec7834bd8c9af7114b886c174fcf179c4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "6e30394916d73afa062ebaa2c75356e73b827157", "chunk": "diff --git a/ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java b/ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java\nindex 5ac5db6b1..5abb20544 100644\n--- a/ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java\n+++ b/ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java\n\n@@ -666,18 +666,15 @@ class NettyRequest implements RestRequest {\n    * The {@link NettyRequest}'s implementation of {@link com.github.ambry.rest.RestRequest.RestRequestContext}. It carries\n    * {@link Channel} and {@link HttpRequest}.\n    */\n-  public class NettyRequestContext implements RestRequestContext {\n+  public static class NettyRequestContext implements RestRequestContext {\n     private final Channel channel;\n-    private final HttpRequest httpRequest;\n \n     /**\n      * Constructor to create a {@link NettyRequestContext}.\n      * @param channel The netty {@link Channel}\n-     * @param httpRequest The netty {@link HttpRequest}.\n      */\n-    NettyRequestContext(final Channel channel, final HttpRequest httpRequest) {\n+    NettyRequestContext(final Channel channel) {\n       this.channel = channel;\n-      this.httpRequest = httpRequest;\n     }\n \n     /**\n"}}, {"oid": "6e30394916d73afa062ebaa2c75356e73b827157", "url": "https://github.com/linkedin/ambry/commit/6e30394916d73afa062ebaa2c75356e73b827157", "message": "Adding tests", "committedDate": "2020-05-04T19:53:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTcwMzQ1Nw==", "url": "https://github.com/linkedin/ambry/pull/1499#discussion_r419703457", "bodyText": "The comment says it carries both Channel and HttpRequest, could you tell me why it only keeps Channel inside and no HttpRequest?", "author": "jsjtzyy", "createdAt": "2020-05-04T20:20:36Z", "path": "ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java", "diffHunk": "@@ -661,4 +661,32 @@ public void invokeCallback(Exception exception) {\n       }\n     }\n   }\n+\n+  /**\n+   * The {@link NettyRequest}'s implementation of {@link com.github.ambry.rest.RestRequest.RestRequestContext}. It carries\n+   * {@link Channel} and {@link HttpRequest}.", "originalCommit": "6e30394916d73afa062ebaa2c75356e73b827157", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTcwNDEwMg==", "url": "https://github.com/linkedin/ambry/pull/1499#discussion_r419704102", "bodyText": "sorry, i already removed the http request, will update the comments", "author": "justinlin-linkedin", "createdAt": "2020-05-04T20:21:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTcwMzQ1Nw=="}], "type": "inlineReview", "revised_code": {"commit": "0d49d59da4d3c0e4242d387c8891a93fccf74894", "chunk": "diff --git a/ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java b/ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java\nindex 5abb20544..0f60c664f 100644\n--- a/ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java\n+++ b/ambry-rest/src/main/java/com/github/ambry/rest/NettyRequest.java\n\n@@ -663,8 +663,8 @@ public class NettyRequest implements RestRequest {\n   }\n \n   /**\n-   * The {@link NettyRequest}'s implementation of {@link com.github.ambry.rest.RestRequest.RestRequestContext}. It carries\n-   * {@link Channel} and {@link HttpRequest}.\n+   * The {@link NettyRequest}'s implementation of {@link com.github.ambry.rest.RestRequest.RestRequestContext}.\n+   * It carries the netty {@link Channel} instance.\n    */\n   public static class NettyRequestContext implements RestRequestContext {\n     private final Channel channel;\n"}}, {"oid": "0d49d59da4d3c0e4242d387c8891a93fccf74894", "url": "https://github.com/linkedin/ambry/commit/0d49d59da4d3c0e4242d387c8891a93fccf74894", "message": "Comments", "committedDate": "2020-05-04T20:22:38Z", "type": "commit"}]}