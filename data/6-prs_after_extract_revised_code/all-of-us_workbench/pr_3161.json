{"pr_number": 3161, "pr_title": "[RW-4285][RISK=NO] Changes to workspace description page -Send data to RDR", "pr_createdAt": "2020-02-20T14:26:52Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3161", "timeline": [{"oid": "48423cda2d0510b9455704f18606ac0d560f3e71", "url": "https://github.com/all-of-us/workbench/commit/48423cda2d0510b9455704f18606ac0d560f3e71", "message": "send Workspace parameters to RDR", "committedDate": "2020-02-20T14:25:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjExMjIzMQ==", "url": "https://github.com/all-of-us/workbench/pull/3161#discussion_r382112231", "bodyText": "This is existing, but there's a star import here and we're trying to not use those, could you driveby fix?", "author": "s-rubenstein", "createdAt": "2020-02-20T16:28:01Z", "path": "api/src/main/java/org/pmiops/workbench/rdr/RdrExportEnums.java", "diffHunk": "@@ -3,6 +3,7 @@\n import com.google.common.collect.BiMap;\n import com.google.common.collect.ImmutableBiMap;\n import org.pmiops.workbench.model.*;", "originalCommit": "48423cda2d0510b9455704f18606ac0d560f3e71", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3b8edb2f9fa7a2c37df2a9383dad1ab638431cd1", "chunk": "diff --git a/api/src/main/java/org/pmiops/workbench/rdr/RdrExportEnums.java b/api/src/main/java/org/pmiops/workbench/rdr/RdrExportEnums.java\nindex 38deb0a3e..37e5e061c 100644\n--- a/api/src/main/java/org/pmiops/workbench/rdr/RdrExportEnums.java\n+++ b/api/src/main/java/org/pmiops/workbench/rdr/RdrExportEnums.java\n\n@@ -3,7 +3,7 @@ package org.pmiops.workbench.rdr;\n import com.google.common.collect.BiMap;\n import com.google.common.collect.ImmutableBiMap;\n import org.pmiops.workbench.model.*;\n-import org.pmiops.workbench.rdr.model.WorkspaceDemographic;\n+import org.pmiops.workbench.rdr.model.RdrWorkspaceDemographic;\n \n public class RdrExportEnums {\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjExMzA2Ng==", "url": "https://github.com/all-of-us/workbench/pull/3161#discussion_r382113066", "bodyText": "Same existing problem but * import.", "author": "s-rubenstein", "createdAt": "2020-02-20T16:29:14Z", "path": "api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java", "diffHunk": "@@ -22,6 +23,7 @@\n import org.pmiops.workbench.db.model.DbWorkspace;\n import org.pmiops.workbench.firecloud.FireCloudService;\n import org.pmiops.workbench.model.RdrEntity;\n+import org.pmiops.workbench.model.SpecificPopulationEnum;\n import org.pmiops.workbench.model.UserRole;\n import org.pmiops.workbench.rdr.api.RdrApi;\n import org.pmiops.workbench.rdr.model.*;", "originalCommit": "48423cda2d0510b9455704f18606ac0d560f3e71", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3b8edb2f9fa7a2c37df2a9383dad1ab638431cd1", "chunk": "diff --git a/api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java b/api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java\nindex 431bfa0b1..613cca3e3 100644\n--- a/api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java\n+++ b/api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java\n\n@@ -26,7 +26,14 @@ import org.pmiops.workbench.model.RdrEntity;\n import org.pmiops.workbench.model.SpecificPopulationEnum;\n import org.pmiops.workbench.model.UserRole;\n import org.pmiops.workbench.rdr.api.RdrApi;\n-import org.pmiops.workbench.rdr.model.*;\n+import org.pmiops.workbench.rdr.model.Gender;\n+import org.pmiops.workbench.rdr.model.Race;\n+import org.pmiops.workbench.rdr.model.RdrResearcher;\n+import org.pmiops.workbench.rdr.model.RdrWorkspace;\n+import org.pmiops.workbench.rdr.model.RdrWorkspaceDemographic;\n+import org.pmiops.workbench.rdr.model.RdrWorkspaceUser;\n+import org.pmiops.workbench.rdr.model.ResearcherAffiliation;\n+import org.pmiops.workbench.rdr.model.SexAtBirth;\n import org.pmiops.workbench.workspaces.WorkspaceService;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Service;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjExNjE1OQ==", "url": "https://github.com/all-of-us/workbench/pull/3161#discussion_r382116159", "bodyText": "What are these setters doing? I', a little confused why it's converting to names that are different?", "author": "s-rubenstein", "createdAt": "2020-02-20T16:33:49Z", "path": "api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java", "diffHunk": "@@ -289,6 +303,72 @@ private RdrWorkspace toRdrWorkspace(DbWorkspace dbWorkspace) {\n     return rdrWorkspace;\n   }\n \n+  WorkspaceDemographic toWorkspaceDemographics(Set<SpecificPopulationEnum> dbPopulationEnumSet) {\n+    WorkspaceDemographic demographic = new WorkspaceDemographic();\n+\n+    demographic.setAccessToCare(\n+        dbPopulationEnumSet.contains(SpecificPopulationEnum.ACCESS_TO_CARE)\n+            ? WorkspaceDemographic.AccessToCareEnum.NOT_EASILY_ACCESS_CARE\n+            : WorkspaceDemographic.AccessToCareEnum.UNSET);", "originalCommit": "48423cda2d0510b9455704f18606ac0d560f3e71", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjE3MTYzNQ==", "url": "https://github.com/all-of-us/workbench/pull/3161#discussion_r382171635", "bodyText": "Its because WorkspceDemographic is RDR object so its converting it from what we have in our DB to Workspace Demographic. Our DB store all the population selection as an ArrayList while RDR has different attributes for each cateogory, I can change the name in the yaml to make it easier to understand.", "author": "NehaBroad", "createdAt": "2020-02-20T18:13:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjExNjE1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "3b8edb2f9fa7a2c37df2a9383dad1ab638431cd1", "chunk": "diff --git a/api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java b/api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java\nindex 431bfa0b1..613cca3e3 100644\n--- a/api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java\n+++ b/api/src/main/java/org/pmiops/workbench/rdr/RdrExportServiceImpl.java\n\n@@ -303,70 +310,72 @@ public class RdrExportServiceImpl implements RdrExportService {\n     return rdrWorkspace;\n   }\n \n-  WorkspaceDemographic toWorkspaceDemographics(Set<SpecificPopulationEnum> dbPopulationEnumSet) {\n-    WorkspaceDemographic demographic = new WorkspaceDemographic();\n+  RdrWorkspaceDemographic toRdrWorkspaceDemographics(\n+      Set<SpecificPopulationEnum> dbPopulationEnumSet) {\n+    RdrWorkspaceDemographic rdrDemographic = new RdrWorkspaceDemographic();\n \n-    demographic.setAccessToCare(\n+    rdrDemographic.setAccessToCare(\n         dbPopulationEnumSet.contains(SpecificPopulationEnum.ACCESS_TO_CARE)\n-            ? WorkspaceDemographic.AccessToCareEnum.NOT_EASILY_ACCESS_CARE\n-            : WorkspaceDemographic.AccessToCareEnum.UNSET);\n+            ? RdrWorkspaceDemographic.AccessToCareEnum.NOT_EASILY_ACCESS_CARE\n+            : RdrWorkspaceDemographic.AccessToCareEnum.UNSET);\n \n-    demographic.setDisabilityStatus(\n+    rdrDemographic.setDisabilityStatus(\n         dbPopulationEnumSet.contains(SpecificPopulationEnum.DISABILITY_STATUS)\n-            ? WorkspaceDemographic.DisabilityStatusEnum.DISABILITY\n-            : WorkspaceDemographic.DisabilityStatusEnum.UNSET);\n+            ? RdrWorkspaceDemographic.DisabilityStatusEnum.DISABILITY\n+            : RdrWorkspaceDemographic.DisabilityStatusEnum.UNSET);\n \n-    demographic.setEducationLevel(\n+    rdrDemographic.setEducationLevel(\n         dbPopulationEnumSet.contains(SpecificPopulationEnum.EDUCATION_LEVEL)\n-            ? WorkspaceDemographic.EducationLevelEnum.LESS_THAN_HIGH_SCHOOL\n-            : WorkspaceDemographic.EducationLevelEnum.UNSET);\n+            ? RdrWorkspaceDemographic.EducationLevelEnum.LESS_THAN_HIGH_SCHOOL\n+            : RdrWorkspaceDemographic.EducationLevelEnum.UNSET);\n \n-    demographic.setIncomeLevel(\n+    rdrDemographic.setIncomeLevel(\n         dbPopulationEnumSet.contains(SpecificPopulationEnum.INCOME_LEVEL)\n-            ? WorkspaceDemographic.IncomeLevelEnum.BELOW_FEDERAL_POVERTY_LEVEL_200_PERCENT\n-            : WorkspaceDemographic.IncomeLevelEnum.UNSET);\n+            ? RdrWorkspaceDemographic.IncomeLevelEnum.BELOW_FEDERAL_POVERTY_LEVEL_200_PERCENT\n+            : RdrWorkspaceDemographic.IncomeLevelEnum.UNSET);\n \n-    demographic.setGeography(\n+    rdrDemographic.setGeography(\n         dbPopulationEnumSet.contains(SpecificPopulationEnum.GEOGRAPHY)\n-            ? WorkspaceDemographic.GeographyEnum.RURAL\n-            : WorkspaceDemographic.GeographyEnum.UNSET);\n+            ? RdrWorkspaceDemographic.GeographyEnum.RURAL\n+            : RdrWorkspaceDemographic.GeographyEnum.UNSET);\n \n-    demographic.setSexualOrientation(\n+    rdrDemographic.setSexualOrientation(\n         dbPopulationEnumSet.contains(SpecificPopulationEnum.SEXUAL_ORIENTATION)\n-            ? WorkspaceDemographic.SexualOrientationEnum.OTHER_THAN_STRAIGHT\n-            : WorkspaceDemographic.SexualOrientationEnum.UNSET);\n+            ? RdrWorkspaceDemographic.SexualOrientationEnum.OTHER_THAN_STRAIGHT\n+            : RdrWorkspaceDemographic.SexualOrientationEnum.UNSET);\n \n-    demographic.setGenderIdentity(\n+    rdrDemographic.setGenderIdentity(\n         dbPopulationEnumSet.contains(SpecificPopulationEnum.GENDER_IDENTITY)\n-            ? WorkspaceDemographic.GenderIdentityEnum.OTHER_THAN_MAN_WOMAN\n-            : WorkspaceDemographic.GenderIdentityEnum.UNSET);\n+            ? RdrWorkspaceDemographic.GenderIdentityEnum.OTHER_THAN_MAN_WOMAN\n+            : RdrWorkspaceDemographic.GenderIdentityEnum.UNSET);\n \n-    demographic.setSexAtBirth(\n+    rdrDemographic.setSexAtBirth(\n         dbPopulationEnumSet.contains(SpecificPopulationEnum.SEX)\n-            ? WorkspaceDemographic.SexAtBirthEnum.INTERSEX\n-            : WorkspaceDemographic.SexAtBirthEnum.UNSET);\n+            ? RdrWorkspaceDemographic.SexAtBirthEnum.INTERSEX\n+            : RdrWorkspaceDemographic.SexAtBirthEnum.UNSET);\n \n-    demographic.setRaceEthnicity(\n+    rdrDemographic.setRaceEthnicity(\n         dbPopulationEnumSet.stream()\n             .map(RdrExportEnums::specificPopulationToRaceEthnicity)\n             .filter(Objects::nonNull)\n             .collect(Collectors.toList()));\n \n-    if (demographic.getRaceEthnicity().isEmpty()) {\n-      demographic.setRaceEthnicity(Arrays.asList(WorkspaceDemographic.RaceEthnicityEnum.UNSET));\n+    if (rdrDemographic.getRaceEthnicity().isEmpty()) {\n+      rdrDemographic.setRaceEthnicity(\n+          Arrays.asList(RdrWorkspaceDemographic.RaceEthnicityEnum.UNSET));\n     }\n \n-    demographic.setAge(\n+    rdrDemographic.setAge(\n         dbPopulationEnumSet.stream()\n             .map(RdrExportEnums::specificPopulationToAge)\n             .filter(Objects::nonNull)\n             .collect(Collectors.toList()));\n \n-    if (demographic.getAge().isEmpty()) {\n-      demographic.setAge(Arrays.asList(WorkspaceDemographic.AgeEnum.UNSET));\n+    if (rdrDemographic.getAge().isEmpty()) {\n+      rdrDemographic.setAge(Arrays.asList(RdrWorkspaceDemographic.AgeEnum.UNSET));\n     }\n \n-    return demographic;\n+    return rdrDemographic;\n   }\n \n   /**\n"}}, {"oid": "3b8edb2f9fa7a2c37df2a9383dad1ab638431cd1", "url": "https://github.com/all-of-us/workbench/commit/3b8edb2f9fa7a2c37df2a9383dad1ab638431cd1", "message": "Change object name to specify RDR Object", "committedDate": "2020-02-20T18:49:11Z", "type": "commit"}]}