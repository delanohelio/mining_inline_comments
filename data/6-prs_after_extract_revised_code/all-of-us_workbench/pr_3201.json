{"pr_number": 3201, "pr_title": "[RW-4135][risk=no] Add non null constraint for user.contact_email", "pr_createdAt": "2020-02-28T17:23:53Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3201", "timeline": [{"oid": "46613db86b5cf7139663f5f4457133bbe2c04e64", "url": "https://github.com/all-of-us/workbench/commit/46613db86b5cf7139663f5f4457133bbe2c04e64", "message": "add non null constraint", "committedDate": "2020-02-28T17:02:36Z", "type": "commit"}, {"oid": "a74204924133ad5acf23278e15b2f26dccd4534c", "url": "https://github.com/all-of-us/workbench/commit/a74204924133ad5acf23278e15b2f26dccd4534c", "message": "use username as contact email in edge case where user pre exists in environment", "committedDate": "2020-02-28T21:57:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk0MjgwNQ==", "url": "https://github.com/all-of-us/workbench/pull/3201#discussion_r385942805", "bodyText": "This covers the edge case where the user already exists in Gsuite when accessing the workbench for the first time.\nIn this case, I decided to just set it to the workbench username email (what we did for the backfill).\nIt's not the best solution since this email is non reachable but this is an edge case that should only occur in test/local environments.", "author": "ericsong", "createdAt": "2020-02-28T22:01:39Z", "path": "api/src/main/java/org/pmiops/workbench/db/dao/UserServiceImpl.java", "diffHunk": "@@ -307,7 +307,7 @@ public DbUser createUser(final Userinfoplus oAuth2Userinfo) {\n         oAuth2Userinfo.getGivenName(),\n         oAuth2Userinfo.getFamilyName(),\n         oAuth2Userinfo.getEmail(),\n-        null,\n+        oAuth2Userinfo.getEmail(),", "originalCommit": "a74204924133ad5acf23278e15b2f26dccd4534c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}