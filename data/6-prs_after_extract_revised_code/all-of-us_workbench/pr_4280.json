{"pr_number": 4280, "pr_title": "[RW-5902][risk=moderate] Create Fitbit flag part of CDR version metadata", "pr_createdAt": "2020-11-12T06:25:39Z", "pr_url": "https://github.com/all-of-us/workbench/pull/4280", "timeline": [{"oid": "d4386b36b68920ca01da1f8a0a2a050857591467", "url": "https://github.com/all-of-us/workbench/commit/d4386b36b68920ca01da1f8a0a2a050857591467", "message": "Add Fitbit flag to CDR Metadata", "committedDate": "2020-11-12T06:21:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjE5NTMwMw==", "url": "https://github.com/all-of-us/workbench/pull/4280#discussion_r522195303", "bodyText": "This can be type: boolean", "author": "freemabd", "createdAt": "2020-11-12T15:31:11Z", "path": "api/src/main/java/org/pmiops/workbench/db/model/DbCdrVersion.java", "diffHunk": "@@ -30,6 +31,7 @@\n   private String cdrDbName;\n   private String elasticIndexBaseName;\n   private String microarrayBigqueryDataset;\n+  private Short hasFitbitData;", "originalCommit": "d4386b36b68920ca01da1f8a0a2a050857591467", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9a81d26de18f6ac9de64cdd75c8b6028359099ff", "chunk": "diff --git a/api/src/main/java/org/pmiops/workbench/db/model/DbCdrVersion.java b/api/src/main/java/org/pmiops/workbench/db/model/DbCdrVersion.java\nindex d99e8be1d..f18b5cb5e 100644\n--- a/api/src/main/java/org/pmiops/workbench/db/model/DbCdrVersion.java\n+++ b/api/src/main/java/org/pmiops/workbench/db/model/DbCdrVersion.java\n\n@@ -31,7 +31,7 @@ public class DbCdrVersion {\n   private String cdrDbName;\n   private String elasticIndexBaseName;\n   private String microarrayBigqueryDataset;\n-  private Short hasFitbitData;\n+  private Boolean hasFitbitData;\n \n   @Id\n   @GeneratedValue(strategy = GenerationType.IDENTITY)\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjE5NTk2Mw==", "url": "https://github.com/all-of-us/workbench/pull/4280#discussion_r522195963", "bodyText": "If we use type boolean, there is not need for these mthods.", "author": "freemabd", "createdAt": "2020-11-12T15:32:02Z", "path": "api/src/main/java/org/pmiops/workbench/db/model/DbStorageEnums.java", "diffHunk": "@@ -207,6 +208,21 @@ public static Short dataAccessLevelToStorage(DataAccessLevel level) {\n     return CLIENT_TO_STORAGE_DATA_ACCESS_LEVEL.get(level);\n   }\n \n+  // Cdr has Fitbit\n+  private static final BiMap<CdrFitBitData, Short> CLIENT_TO_STORAGE_FITBIT =\n+      ImmutableBiMap.<CdrFitBitData, Short>builder()\n+          .put(CdrFitBitData.FALSE, (short) 0)\n+          .put(CdrFitBitData.TRUE, (short) 1)\n+          .build();\n+\n+  public static CdrFitBitData cdrFitBitDataFromStorage(Short level) {\n+    return CLIENT_TO_STORAGE_FITBIT.inverse().get(level);\n+  }\n+\n+  public static Short cdrFitBitDataToStorage(CdrFitBitData level) {\n+    return CLIENT_TO_STORAGE_FITBIT.get(level);\n+  }\n+", "originalCommit": "d4386b36b68920ca01da1f8a0a2a050857591467", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjUzMDA3Mw==", "url": "https://github.com/all-of-us/workbench/pull/4280#discussion_r522530073", "bodyText": "Done", "author": "NehaBroad", "createdAt": "2020-11-13T00:40:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjE5NTk2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "dc4bfe95e541ab26bddfb63b9dcb2f55d47c297d", "chunk": "diff --git a/api/src/main/java/org/pmiops/workbench/db/model/DbStorageEnums.java b/api/src/main/java/org/pmiops/workbench/db/model/DbStorageEnums.java\nindex e2727eb28..4dcd2b99b 100644\n--- a/api/src/main/java/org/pmiops/workbench/db/model/DbStorageEnums.java\n+++ b/api/src/main/java/org/pmiops/workbench/db/model/DbStorageEnums.java\n\n@@ -208,21 +207,6 @@ public final class DbStorageEnums {\n     return CLIENT_TO_STORAGE_DATA_ACCESS_LEVEL.get(level);\n   }\n \n-  // Cdr has Fitbit\n-  private static final BiMap<CdrFitBitData, Short> CLIENT_TO_STORAGE_FITBIT =\n-      ImmutableBiMap.<CdrFitBitData, Short>builder()\n-          .put(CdrFitBitData.FALSE, (short) 0)\n-          .put(CdrFitBitData.TRUE, (short) 1)\n-          .build();\n-\n-  public static CdrFitBitData cdrFitBitDataFromStorage(Short level) {\n-    return CLIENT_TO_STORAGE_FITBIT.inverse().get(level);\n-  }\n-\n-  public static Short cdrFitBitDataToStorage(CdrFitBitData level) {\n-    return CLIENT_TO_STORAGE_FITBIT.get(level);\n-  }\n-\n   // Degree\n   private static final BiMap<Degree, Short> CLIENT_TO_STORAGE_DEGREE =\n       ImmutableBiMap.<Degree, Short>builder()\n"}}, {"oid": "9a81d26de18f6ac9de64cdd75c8b6028359099ff", "url": "https://github.com/all-of-us/workbench/commit/9a81d26de18f6ac9de64cdd75c8b6028359099ff", "message": "Change hasFitbit from enum to boolean", "committedDate": "2020-11-13T00:14:46Z", "type": "commit"}, {"oid": "05320f8329ed07df152710c0db3df29d03e72d10", "url": "https://github.com/all-of-us/workbench/commit/05320f8329ed07df152710c0db3df29d03e72d10", "message": "Test for CDR version", "committedDate": "2020-11-13T00:32:53Z", "type": "commit"}, {"oid": "dc4bfe95e541ab26bddfb63b9dcb2f55d47c297d", "url": "https://github.com/all-of-us/workbench/commit/dc4bfe95e541ab26bddfb63b9dcb2f55d47c297d", "message": "Removing code using enum", "committedDate": "2020-11-13T00:39:25Z", "type": "commit"}]}