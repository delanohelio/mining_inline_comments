{"pr_number": 3967, "pr_title": "[RW-5426][risk=low] Teardown now-unused Workbench cluster endpoints", "pr_createdAt": "2020-09-03T22:37:04Z", "pr_url": "https://github.com/all-of-us/workbench/pull/3967", "timeline": [{"oid": "59ff469b30b8d7592694693e4d78b826b2c123e7", "url": "https://github.com/all-of-us/workbench/commit/59ff469b30b8d7592694693e4d78b826b2c123e7", "message": "actually rename..", "committedDate": "2020-09-03T23:03:27Z", "type": "forcePushed"}, {"oid": "2f0efea56af8551cf7ac6b43f22788a7c60e1cd4", "url": "https://github.com/all-of-us/workbench/commit/2f0efea56af8551cf7ac6b43f22788a7c60e1cd4", "message": "actually rename..", "committedDate": "2020-09-10T18:58:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA0ODgwMg==", "url": "https://github.com/all-of-us/workbench/pull/3967#discussion_r487048802", "bodyText": "a few missed cluster -> runtime", "author": "jmthibault79", "createdAt": "2020-09-11T13:35:23Z", "path": "api/src/main/java/org/pmiops/workbench/db/model/DbUser.java", "diffHunk": "@@ -34,10 +34,12 @@\n @Table(name = \"user\")\n public class DbUser {\n \n-  private static final String CLUSTER_NAME_PREFIX = \"all-of-us-\";\n+  private static final String RUNTIME_NAME_PREFIX = \"all-of-us-\";\n \n   /**\n-   * This is a Gson compatible class for encoding a JSON blob which is stored in MySQL. This\n+   * TODO(RW-5406): Remove cluster config overrides.\n+   *\n+   * <p>This is a Gson compatible class for encoding a JSON blob which is stored in MySQL. This\n    * represents cluster configuration overrides we support on a per-user basis for their notebook", "originalCommit": "3658f5e171177339074972f6ddee3a5026bdc4b2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyNjc0Mw==", "url": "https://github.com/all-of-us/workbench/pull/3967#discussion_r487226743", "bodyText": "In this case, I haven't bothered renaming these models / comments since they are slotted for deletion, per above RW-5406.", "author": "calbach", "createdAt": "2020-09-11T18:48:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA0ODgwMg=="}], "type": "inlineReview", "revised_code": {"commit": "cc9800b9c23f77ecdc12c0c975a7268aba407080", "chunk": "diff --git a/api/src/main/java/org/pmiops/workbench/db/model/DbUser.java b/api/src/main/java/org/pmiops/workbench/db/model/DbUser.java\nindex 77a33ace4..67b4e9527 100644\n--- a/api/src/main/java/org/pmiops/workbench/db/model/DbUser.java\n+++ b/api/src/main/java/org/pmiops/workbench/db/model/DbUser.java\n\n@@ -34,12 +34,10 @@ import org.pmiops.workbench.model.EmailVerificationStatus;\n @Table(name = \"user\")\n public class DbUser {\n \n-  private static final String RUNTIME_NAME_PREFIX = \"all-of-us-\";\n+  private static final String CLUSTER_NAME_PREFIX = \"all-of-us-\";\n \n   /**\n-   * TODO(RW-5406): Remove cluster config overrides.\n-   *\n-   * <p>This is a Gson compatible class for encoding a JSON blob which is stored in MySQL. This\n+   * This is a Gson compatible class for encoding a JSON blob which is stored in MySQL. This\n    * represents cluster configuration overrides we support on a per-user basis for their notebook\n    * cluster. Corresponds to Leonardo's MachineConfig model. All fields are optional.\n    *\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA1NTc5Mg==", "url": "https://github.com/all-of-us/workbench/pull/3967#discussion_r487055792", "bodyText": "What is the context for removing this one?", "author": "jmthibault79", "createdAt": "2020-09-11T13:46:19Z", "path": "api/src/main/java/org/pmiops/workbench/utils/mappers/LeonardoMapper.java", "diffHunk": "@@ -2,62 +2,26 @@\n \n import org.mapstruct.Mapper;\n import org.mapstruct.Mapping;\n-import org.pmiops.workbench.leonardo.model.LeonardoCluster;\n import org.pmiops.workbench.leonardo.model.LeonardoGetRuntimeResponse;\n-import org.pmiops.workbench.leonardo.model.LeonardoListClusterResponse;\n import org.pmiops.workbench.leonardo.model.LeonardoListRuntimeResponse;\n import org.pmiops.workbench.leonardo.model.LeonardoRuntimeStatus;\n-import org.pmiops.workbench.model.Cluster;\n-import org.pmiops.workbench.model.ClusterLocalizeRequest;\n-import org.pmiops.workbench.model.ClusterLocalizeResponse;\n-import org.pmiops.workbench.model.ClusterStatus;\n-import org.pmiops.workbench.model.ListClusterResponse;\n import org.pmiops.workbench.model.ListRuntimeResponse;\n import org.pmiops.workbench.model.Runtime;\n-import org.pmiops.workbench.model.RuntimeLocalizeRequest;\n-import org.pmiops.workbench.model.RuntimeLocalizeResponse;\n import org.pmiops.workbench.model.RuntimeStatus;\n \n @Mapper(config = MapStructConfig.class)\n public interface LeonardoMapper {\n-  @Mapping(target = \"internalId\", source = \"id\")\n-  @Mapping(target = \"jupyterUserScriptUri\", ignore = true)\n-  LeonardoListClusterResponse toListClusterResponse(LeonardoCluster cluster);\n-\n   @Mapping(target = \"patchInProgress\", ignore = true)\n   LeonardoListRuntimeResponse toListRuntimeResponse(LeonardoGetRuntimeResponse runtime);\n \n-  @Mapping(target = \"clusterName\", source = \"runtimeName\")\n-  @Mapping(target = \"createdDate\", source = \"auditInfo.createdDate\")\n-  @Mapping(target = \"dateAccessed\", source = \"auditInfo.dateAccessed\")\n-  ListClusterResponse toApiListClusterResponse(\n-      LeonardoListRuntimeResponse leonardoListRuntimeResponse);\n-\n   @Mapping(target = \"createdDate\", source = \"auditInfo.createdDate\")\n   @Mapping(target = \"dateAccessed\", source = \"auditInfo.dateAccessed\")\n   ListRuntimeResponse toApiListRuntimeResponse(\n       LeonardoListRuntimeResponse leonardoListRuntimeResponse);\n \n-  @Mapping(target = \"clusterName\", source = \"runtimeName\")\n-  @Mapping(target = \"clusterNamespace\", source = \"googleProject\")\n-  @Mapping(target = \"createdDate\", source = \"auditInfo.createdDate\")\n-  Cluster toApiCluster(LeonardoGetRuntimeResponse runtime);\n-\n   @Mapping(target = \"createdDate\", source = \"auditInfo.createdDate\")\n   Runtime toApiRuntime(LeonardoGetRuntimeResponse runtime);\n \n-  RuntimeLocalizeRequest clusterToRuntimeLocalizeRequest(ClusterLocalizeRequest req);", "originalCommit": "3658f5e171177339074972f6ddee3a5026bdc4b2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyMTA1Mg==", "url": "https://github.com/all-of-us/workbench/pull/3967#discussion_r487221052", "bodyText": "It only existed to support mapping between the old and new types, since I temporarily implemented deprecatedLocalize as a shim on top of localize", "author": "calbach", "createdAt": "2020-09-11T18:35:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA1NTc5Mg=="}], "type": "inlineReview", "revised_code": null}, {"oid": "cc9800b9c23f77ecdc12c0c975a7268aba407080", "url": "https://github.com/all-of-us/workbench/commit/cc9800b9c23f77ecdc12c0c975a7268aba407080", "message": "drop code, update docs", "committedDate": "2020-09-11T18:48:41Z", "type": "commit"}, {"oid": "9205304538748f5ae807ce3d1544c45c2459b68d", "url": "https://github.com/all-of-us/workbench/commit/9205304538748f5ae807ce3d1544c45c2459b68d", "message": "lingering references", "committedDate": "2020-09-11T18:48:41Z", "type": "commit"}, {"oid": "7f549aa0b8208e9c138c1c95b19ad35a4787b63d", "url": "https://github.com/all-of-us/workbench/commit/7f549aa0b8208e9c138c1c95b19ad35a4787b63d", "message": "actually rename..", "committedDate": "2020-09-11T18:48:41Z", "type": "commit"}, {"oid": "f346309062551c30f603e258eb17c9ca6545bdc3", "url": "https://github.com/all-of-us/workbench/commit/f346309062551c30f603e258eb17c9ca6545bdc3", "message": "spotless", "committedDate": "2020-09-11T18:48:41Z", "type": "commit"}, {"oid": "79b00c48b5e6a4cffc2957fa3f73eb5b3741bdaa", "url": "https://github.com/all-of-us/workbench/commit/79b00c48b5e6a4cffc2957fa3f73eb5b3741bdaa", "message": "delete unused stub", "committedDate": "2020-09-11T18:48:41Z", "type": "commit"}, {"oid": "8b501e3388ae26956e8a5cf53616bdd087c84100", "url": "https://github.com/all-of-us/workbench/commit/8b501e3388ae26956e8a5cf53616bdd087c84100", "message": "Comment update", "committedDate": "2020-09-11T18:48:42Z", "type": "commit"}, {"oid": "8b501e3388ae26956e8a5cf53616bdd087c84100", "url": "https://github.com/all-of-us/workbench/commit/8b501e3388ae26956e8a5cf53616bdd087c84100", "message": "Comment update", "committedDate": "2020-09-11T18:48:42Z", "type": "forcePushed"}]}