{"pr_number": 4521, "pr_title": "CreateTable component should use given connection", "pr_createdAt": "2020-03-11T10:26:42Z", "pr_url": "https://github.com/Talend/tdi-studio-se/pull/4521", "timeline": [{"oid": "0642d443c7881f6883e204d2b7759906b3495834", "url": "https://github.com/Talend/tdi-studio-se/commit/0642d443c7881f6883e204d2b7759906b3495834", "message": "CreateTable component should use given connection", "committedDate": "2020-03-11T10:22:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3MDcyOQ==", "url": "https://github.com/Talend/tdi-studio-se/pull/4521#discussion_r394170729", "bodyText": "I don't think it is specific for tCreateTable and we already have another constructure\npublic RepositoryReviewDialog(Shell parentShell, ERepositoryObjectType type, String repositoryType, String[] itemFilter) , itemFilter is used to filter the repository item to select .\nIf can't reuse this constructor , you can refer to this implementation.", "author": "wchen-talend", "createdAt": "2020-03-18T08:19:11Z", "path": "main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/processor/RepositoryTypeProcessor.java", "diffHunk": "@@ -236,6 +246,16 @@ protected boolean selectRepositoryNode(Viewer viewer, RepositoryNode parentNode,\n                         return false;\n                     }\n                 }\n+\n+                if (connection instanceof DatabaseConnectionImpl) {\n+                    String databaseType = ((DatabaseConnectionImpl) connection).getDatabaseType();\n+                    if (StringUtils.equals(\"tCreateTable\", this.componentName) && listItemsDisplayName != null) {", "originalCommit": "0642d443c7881f6883e204d2b7759906b3495834", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d299fcad48ac2f1f3ed9df6b3f66c39e4381d3ee", "chunk": "diff --git a/main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/processor/RepositoryTypeProcessor.java b/main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/processor/RepositoryTypeProcessor.java\nindex 70bb8c8e8a..591e15184f 100644\n--- a/main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/processor/RepositoryTypeProcessor.java\n+++ b/main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/processor/RepositoryTypeProcessor.java\n\n@@ -246,16 +236,6 @@ public class RepositoryTypeProcessor extends SingleTypeProcessor {\n                         return false;\n                     }\n                 }\n-\n-                if (connection instanceof DatabaseConnectionImpl) {\n-                    String databaseType = ((DatabaseConnectionImpl) connection).getDatabaseType();\n-                    if (StringUtils.equals(\"tCreateTable\", this.componentName) && listItemsDisplayName != null) {\n-                        if (!ArrayUtils.contains(listItemsDisplayName, databaseType)) {\n-                            return false;\n-                        }\n-                    }\n-                }\n-\n             }\n         }\n         if (repositoryType.startsWith(ERepositoryCategoryType.HEADERFOOTER.getName())) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3MTY4NQ==", "url": "https://github.com/Talend/tdi-studio-se/pull/4521#discussion_r394171685", "bodyText": "https://github.com/Talend/tdi-studio-se/blob/master/main/plugins/org.talend.designer.core/src/main/java/org/talend/designer/core/ui/editor/properties/controllers/PropertyTypeController.java#L342\nCan we reuse the code in PropertyTypeController instead of here ?", "author": "wchen-talend", "createdAt": "2020-03-18T08:21:10Z", "path": "main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/dialog/RepositoryReviewDialog.java", "diffHunk": "@@ -305,6 +305,13 @@ private IRepositoryTypeProcessor createTypeProcessor() {\n                 return processor;\n             }\n         }\n+        String componentName = null;\n+        String[] listItemsDisplayName = null;\n+        if (this.elem != null && (this.elem instanceof INode)) {\n+            componentName = ((INode) elem).getComponent().getName();\n+            IElementParameter elementParameter = ((INode) elem).getElementParameter(\"DBTYPE\");\n+            listItemsDisplayName = elementParameter.getListItemsDisplayName();", "originalCommit": "0642d443c7881f6883e204d2b7759906b3495834", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d299fcad48ac2f1f3ed9df6b3f66c39e4381d3ee", "chunk": "diff --git a/main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/dialog/RepositoryReviewDialog.java b/main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/dialog/RepositoryReviewDialog.java\nindex 776f64b163..2a18376177 100644\n--- a/main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/dialog/RepositoryReviewDialog.java\n+++ b/main/plugins/org.talend.repository/src/main/java/org/talend/repository/ui/dialog/RepositoryReviewDialog.java\n\n@@ -305,13 +305,6 @@ public class RepositoryReviewDialog extends Dialog {\n                 return processor;\n             }\n         }\n-        String componentName = null;\n-        String[] listItemsDisplayName = null;\n-        if (this.elem != null && (this.elem instanceof INode)) {\n-            componentName = ((INode) elem).getComponent().getName();\n-            IElementParameter elementParameter = ((INode) elem).getElementParameter(\"DBTYPE\");\n-            listItemsDisplayName = elementParameter.getListItemsDisplayName();\n-        }\n         boolean isGeneric = false;\n         if(this.elem != null && (this.elem instanceof INode)\n                 && ((INode)elem).getComponent().getComponentType() == EComponentType.GENERIC){\n"}}, {"oid": "d299fcad48ac2f1f3ed9df6b3f66c39e4381d3ee", "url": "https://github.com/Talend/tdi-studio-se/commit/d299fcad48ac2f1f3ed9df6b3f66c39e4381d3ee", "message": "fix(TUP-23956)CreateTable component should not to use JDBC connection", "committedDate": "2020-03-18T10:14:46Z", "type": "commit"}, {"oid": "2bb06e61e8d234c7cd9e221f148185b2b7452d19", "url": "https://github.com/Talend/tdi-studio-se/commit/2bb06e61e8d234c7cd9e221f148185b2b7452d19", "message": "fix(TUP-23956)CreateTable component should not to use JDBC connection", "committedDate": "2020-03-18T14:35:14Z", "type": "commit"}, {"oid": "fa03502347a666a423d52027c3887c63a12b27da", "url": "https://github.com/Talend/tdi-studio-se/commit/fa03502347a666a423d52027c3887c63a12b27da", "message": "fix some metadata connection could not select tCreateTable when drag and\ndrop", "committedDate": "2020-03-24T07:27:55Z", "type": "commit"}, {"oid": "3fda6b5a93c2e9e4b2bfd79365af596b4ebf4284", "url": "https://github.com/Talend/tdi-studio-se/commit/3fda6b5a93c2e9e4b2bfd79365af596b4ebf4284", "message": "Merge branch 'master' into jzhang/bugfix/TUP-23956_CreateTable_should_use_given_connection", "committedDate": "2020-04-16T01:46:48Z", "type": "commit"}, {"oid": "8f4010359a3a301a56c3ac369ace7cbb4e3f1b09", "url": "https://github.com/Talend/tdi-studio-se/commit/8f4010359a3a301a56c3ac369ace7cbb4e3f1b09", "message": "fix(TUP-23956)CreateTable component should not to use JDBC connection", "committedDate": "2020-04-16T06:33:57Z", "type": "commit"}]}