{"pr_number": 125, "pr_title": "feat: new sample - Models: List model resources contained in a dataset", "pr_createdAt": "2020-01-24T22:26:07Z", "pr_url": "https://github.com/googleapis/java-bigquery/pull/125", "timeline": [{"oid": "17d96af5d616aba0866b8740c408b595efb81fb7", "url": "https://github.com/googleapis/java-bigquery/commit/17d96af5d616aba0866b8740c408b595efb81fb7", "message": "feat: new sample - Models: List Models", "committedDate": "2020-01-24T21:24:30Z", "type": "commit"}, {"oid": "9198d8593371c6f2600f3f77aee76b4ddd1ffe1a", "url": "https://github.com/googleapis/java-bigquery/commit/9198d8593371c6f2600f3f77aee76b4ddd1ffe1a", "message": "update to use hamcrest truth", "committedDate": "2020-01-24T22:20:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM2NTE0Nw==", "url": "https://github.com/googleapis/java-bigquery/pull/125#discussion_r371365147", "bodyText": "Is this if models is null? We should check models if it'snull and (and throw an error if it is) instead of try/catching", "author": "kurtisvg", "createdAt": "2020-01-27T17:03:41Z", "path": "samples/src/main/java/com/example/bigquery/ListModels.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+import com.google.api.gax.paging.Page;\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQuery.ModelListOption;\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.Model;\n+\n+// [START bigquery_list_models]\n+public class ListModels {\n+\n+  public static void runListModels() {\n+    // TODO(developer): Replace these variables before running the sample.\n+    String datasetName = \"MY_DATASET_NAME\";\n+    listModels(datasetName);\n+  }\n+\n+  public static void listModels(String datasetName) {\n+    try {\n+      // Initialize client that will be used to send requests. This client only needs to be created\n+      // once, and can be reused for multiple requests.\n+      BigQuery bigquery = BigQueryOptions.getDefaultInstance().getService();\n+\n+      try {\n+        Page<Model> models = bigquery.listModels(datasetName, ModelListOption.pageSize(100));\n+        models\n+            .iterateAll()\n+            .forEach(\n+                model ->\n+                    System.out.println(\n+                        model.getModelId() + \" models in dataset listed successfully.\"));\n+      } catch (NullPointerException e) {", "originalCommit": "9198d8593371c6f2600f3f77aee76b4ddd1ffe1a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQxNzI1Mg==", "url": "https://github.com/googleapis/java-bigquery/pull/125#discussion_r371417252", "bodyText": "okay", "author": "stephaniewang526", "createdAt": "2020-01-27T18:49:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM2NTE0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQ5NzI0Mg==", "url": "https://github.com/googleapis/java-bigquery/pull/125#discussion_r371497242", "bodyText": "You shouldn't catch NullPointers - prevent it from happening instead.", "author": "kurtisvg", "createdAt": "2020-01-27T21:39:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM2NTE0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUwNjgzNg==", "url": "https://github.com/googleapis/java-bigquery/pull/125#discussion_r371506836", "bodyText": "ok", "author": "stephaniewang526", "createdAt": "2020-01-27T22:00:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM2NTE0Nw=="}], "type": "inlineReview", "revised_code": {"commit": "635d891bccd2a6cdfb30ee4a8a067d74ca2f5c90", "chunk": "diff --git a/samples/src/main/java/com/example/bigquery/ListModels.java b/samples/src/main/java/com/example/bigquery/ListModels.java\nindex 4f21052d..c0a261a6 100644\n--- a/samples/src/main/java/com/example/bigquery/ListModels.java\n+++ b/samples/src/main/java/com/example/bigquery/ListModels.java\n\n@@ -47,7 +47,7 @@ public class ListModels {\n                     System.out.println(\n                         model.getModelId() + \" models in dataset listed successfully.\"));\n       } catch (NullPointerException e) {\n-        System.out.print(\"Dataset does not contain any models\");\n+        throw new NullPointerException(\"Dataset does not contain any models\");\n       }\n     } catch (BigQueryException e) {\n       System.out.println(\"Models not listed in dataset due to error: \\n\" + e.toString());\n"}}, {"oid": "635d891bccd2a6cdfb30ee4a8a067d74ca2f5c90", "url": "https://github.com/googleapis/java-bigquery/commit/635d891bccd2a6cdfb30ee4a8a067d74ca2f5c90", "message": "update base on comments", "committedDate": "2020-01-27T19:04:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQ5NzEwMg==", "url": "https://github.com/googleapis/java-bigquery/pull/125#discussion_r371497102", "bodyText": "This doesn't look right - this is printing as \"$ModelId models in dataset listed successfully\".\nI think you want probably want to do is print something like `Model: modelId = $modelId, modelName = $modelName", "author": "kurtisvg", "createdAt": "2020-01-27T21:39:40Z", "path": "samples/src/main/java/com/example/bigquery/ListModels.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+import com.google.api.gax.paging.Page;\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQuery.ModelListOption;\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.Model;\n+\n+// [START bigquery_list_models]\n+public class ListModels {\n+\n+  public static void runListModels() {\n+    // TODO(developer): Replace these variables before running the sample.\n+    String datasetName = \"MY_DATASET_NAME\";\n+    listModels(datasetName);\n+  }\n+\n+  public static void listModels(String datasetName) {\n+    try {\n+      // Initialize client that will be used to send requests. This client only needs to be created\n+      // once, and can be reused for multiple requests.\n+      BigQuery bigquery = BigQueryOptions.getDefaultInstance().getService();\n+\n+      try {\n+        Page<Model> models = bigquery.listModels(datasetName, ModelListOption.pageSize(100));\n+        models\n+            .iterateAll()\n+            .forEach(\n+                model ->\n+                    System.out.println(\n+                        model.getModelId() + \" models in dataset listed successfully.\"));", "originalCommit": "635d891bccd2a6cdfb30ee4a8a067d74ca2f5c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUwNjczNw==", "url": "https://github.com/googleapis/java-bigquery/pull/125#discussion_r371506737", "bodyText": "Looks like there's only getModelId method to get the model Id. I think I will leave it this way but update to just \"model\" (instead of \"models\").", "author": "stephaniewang526", "createdAt": "2020-01-27T22:00:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQ5NzEwMg=="}], "type": "inlineReview", "revised_code": {"commit": "3c6a4f6e9e331a283d432bca1562369ea77cb129", "chunk": "diff --git a/samples/src/main/java/com/example/bigquery/ListModels.java b/samples/src/main/java/com/example/bigquery/ListModels.java\nindex c0a261a6..934e728c 100644\n--- a/samples/src/main/java/com/example/bigquery/ListModels.java\n+++ b/samples/src/main/java/com/example/bigquery/ListModels.java\n\n@@ -38,16 +38,16 @@ public class ListModels {\n       // once, and can be reused for multiple requests.\n       BigQuery bigquery = BigQueryOptions.getDefaultInstance().getService();\n \n-      try {\n-        Page<Model> models = bigquery.listModels(datasetName, ModelListOption.pageSize(100));\n+      Page<Model> models = bigquery.listModels(datasetName, ModelListOption.pageSize(100));\n+      if (models == null) {\n+        System.out.println(\"Dataset does not contain any models\");\n+      } else {\n         models\n             .iterateAll()\n             .forEach(\n                 model ->\n                     System.out.println(\n                         model.getModelId() + \" models in dataset listed successfully.\"));\n-      } catch (NullPointerException e) {\n-        throw new NullPointerException(\"Dataset does not contain any models\");\n       }\n     } catch (BigQueryException e) {\n       System.out.println(\"Models not listed in dataset due to error: \\n\" + e.toString());\n"}}, {"oid": "3c6a4f6e9e331a283d432bca1562369ea77cb129", "url": "https://github.com/googleapis/java-bigquery/commit/3c6a4f6e9e331a283d432bca1562369ea77cb129", "message": "update base on comment", "committedDate": "2020-01-27T21:57:12Z", "type": "commit"}, {"oid": "f44e683fd4338b221060798b4d1a972b56362d46", "url": "https://github.com/googleapis/java-bigquery/commit/f44e683fd4338b221060798b4d1a972b56362d46", "message": "nit", "committedDate": "2020-01-27T21:58:57Z", "type": "commit"}, {"oid": "4fc6d59c4355295870159d57d51d21eb2451079f", "url": "https://github.com/googleapis/java-bigquery/commit/4fc6d59c4355295870159d57d51d21eb2451079f", "message": "nit", "committedDate": "2020-01-27T22:09:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUxNjUyMA==", "url": "https://github.com/googleapis/java-bigquery/pull/125#discussion_r371516520", "bodyText": "nit: You should use if/break over if/else here. It simplifies the control flow and makes it easier to read, and easier for people to write code after the if/else block that might rely on models (since it's guaranteed to be non-null at that point).\nif (models == null) {\n  System.out.println(\"Dataset does not contain any models.\");\n  return;\n}\nSystem.out.printf(\"Dataset contains %s models:\\n\", models.getLength());\nmodels\n  .iterateAll()\n  .forEach(\n     model -> System.out.printf(\"Model ID: %s\", model.getModelId()));", "author": "kurtisvg", "createdAt": "2020-01-27T22:23:20Z", "path": "samples/src/main/java/com/example/bigquery/ListModels.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+import com.google.api.gax.paging.Page;\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQuery.ModelListOption;\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.Model;\n+\n+// [START bigquery_list_models]\n+public class ListModels {\n+\n+  public static void runListModels() {\n+    // TODO(developer): Replace these variables before running the sample.\n+    String datasetName = \"MY_DATASET_NAME\";\n+    listModels(datasetName);\n+  }\n+\n+  public static void listModels(String datasetName) {\n+    try {\n+      // Initialize client that will be used to send requests. This client only needs to be created\n+      // once, and can be reused for multiple requests.\n+      BigQuery bigquery = BigQueryOptions.getDefaultInstance().getService();\n+\n+      Page<Model> models = bigquery.listModels(datasetName, ModelListOption.pageSize(100));\n+      if (models == null) {\n+        System.out.println(\"Dataset does not contain any models\");", "originalCommit": "4fc6d59c4355295870159d57d51d21eb2451079f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTU0MzI2Ng==", "url": "https://github.com/googleapis/java-bigquery/pull/125#discussion_r371543266", "bodyText": "okay - updated", "author": "stephaniewang526", "createdAt": "2020-01-27T23:38:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUxNjUyMA=="}], "type": "inlineReview", "revised_code": {"commit": "734876952a39e2f0ccb1df32b7211d026b1379a0", "chunk": "diff --git a/samples/src/main/java/com/example/bigquery/ListModels.java b/samples/src/main/java/com/example/bigquery/ListModels.java\nindex 4905fde4..fe6a149a 100644\n--- a/samples/src/main/java/com/example/bigquery/ListModels.java\n+++ b/samples/src/main/java/com/example/bigquery/ListModels.java\n\n@@ -40,15 +40,10 @@ public class ListModels {\n \n       Page<Model> models = bigquery.listModels(datasetName, ModelListOption.pageSize(100));\n       if (models == null) {\n-        System.out.println(\"Dataset does not contain any models\");\n-      } else {\n-        models\n-            .iterateAll()\n-            .forEach(\n-                model ->\n-                    System.out.println(\n-                        model.getModelId() + \" model in dataset listed successfully.\"));\n+        System.out.println(\"Dataset does not contain any models.\");\n+        return;\n       }\n+      models.iterateAll().forEach(model -> System.out.printf(\"Success! Model ID: %s\", model.getModelId()));\n     } catch (BigQueryException e) {\n       System.out.println(\"Models not listed in dataset due to error: \\n\" + e.toString());\n     }\n"}}, {"oid": "734876952a39e2f0ccb1df32b7211d026b1379a0", "url": "https://github.com/googleapis/java-bigquery/commit/734876952a39e2f0ccb1df32b7211d026b1379a0", "message": "nit update", "committedDate": "2020-01-27T23:38:31Z", "type": "commit"}, {"oid": "8b4a09b48159d3c99e2df27d36aa119586b02fb5", "url": "https://github.com/googleapis/java-bigquery/commit/8b4a09b48159d3c99e2df27d36aa119586b02fb5", "message": "nit update", "committedDate": "2020-01-28T00:28:37Z", "type": "commit"}]}