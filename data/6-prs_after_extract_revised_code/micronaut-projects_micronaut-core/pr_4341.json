{"pr_number": 4341, "pr_title": "Adds a new marker interface HttpRequestTenantResolver", "pr_createdAt": "2020-10-19T10:55:44Z", "pr_url": "https://github.com/micronaut-projects/micronaut-core/pull/4341", "timeline": [{"oid": "73a0361425f51077bfa6e204936e695a093adf5c", "url": "https://github.com/micronaut-projects/micronaut-core/commit/73a0361425f51077bfa6e204936e695a093adf5c", "message": "delete unimplemented test", "committedDate": "2020-10-19T10:51:33Z", "type": "commit"}, {"oid": "44ad7c183766a21389cd9525edc6828e1a62a691", "url": "https://github.com/micronaut-projects/micronaut-core/commit/44ad7c183766a21389cd9525edc6828e1a62a691", "message": "feat: add HttpRequestTenantResolver\n\nprincipal, cookie, subdomain, http header implement interface", "committedDate": "2020-10-19T11:51:58Z", "type": "commit"}, {"oid": "44ad7c183766a21389cd9525edc6828e1a62a691", "url": "https://github.com/micronaut-projects/micronaut-core/commit/44ad7c183766a21389cd9525edc6828e1a62a691", "message": "feat: add HttpRequestTenantResolver\n\nprincipal, cookie, subdomain, http header implement interface", "committedDate": "2020-10-19T11:51:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcxMjQ4MQ==", "url": "https://github.com/micronaut-projects/micronaut-core/pull/4341#discussion_r507712481", "bodyText": "Needs to expression whether the return type is nullable or not", "author": "graemerocher", "createdAt": "2020-10-19T12:39:29Z", "path": "multitenancy/src/main/java/io/micronaut/multitenancy/tenantresolver/HttpRequestTenantResolver.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Copyright 2017-2020 original authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package io.micronaut.multitenancy.tenantresolver;\n+\n+import edu.umd.cs.findbugs.annotations.NonNull;\n+import io.micronaut.http.HttpRequest;\n+import io.micronaut.multitenancy.exceptions.TenantNotFoundException;\n+\n+import javax.validation.constraints.NotNull;\n+import java.io.Serializable;\n+\n+/**\n+ * An interface for multi-tenant aware applications which resolve the current identifier for the current request.\n+ *\n+ * @author Sergio del Amo\n+ * @since 2.1.2\n+ */\n+public interface HttpRequestTenantResolver {\n+    /**\n+     * Resolves the current tenant identifier.\n+     * @param request The HTTP request\n+     * @return The tenant identifier\n+     * @throws TenantNotFoundException if tenant not found\n+     */\n+    Serializable resolveTenantIdentifier(@NonNull @NotNull HttpRequest<?> request) throws TenantNotFoundException;", "originalCommit": "44ad7c183766a21389cd9525edc6828e1a62a691", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzczMzQ4MQ==", "url": "https://github.com/micronaut-projects/micronaut-core/pull/4341#discussion_r507733481", "bodyText": "I've added the @NonNull annotation to both TenantResolver::resolveIdentifier  and HttpRequestTenantResolver::resolveIdentifier(HttpRequest) methods.", "author": "sdelamo", "createdAt": "2020-10-19T13:12:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcxMjQ4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "969bd961bd6a8aae49c96a2ef27af203da9b0fad", "chunk": "diff --git a/multitenancy/src/main/java/io/micronaut/multitenancy/tenantresolver/HttpRequestTenantResolver.java b/multitenancy/src/main/java/io/micronaut/multitenancy/tenantresolver/HttpRequestTenantResolver.java\nindex 52a18175b..ded86c973 100644\n--- a/multitenancy/src/main/java/io/micronaut/multitenancy/tenantresolver/HttpRequestTenantResolver.java\n+++ b/multitenancy/src/main/java/io/micronaut/multitenancy/tenantresolver/HttpRequestTenantResolver.java\n\n@@ -35,5 +35,6 @@ public interface HttpRequestTenantResolver {\n      * @return The tenant identifier\n      * @throws TenantNotFoundException if tenant not found\n      */\n+    @NonNull\n     Serializable resolveTenantIdentifier(@NonNull @NotNull HttpRequest<?> request) throws TenantNotFoundException;\n }\n"}}, {"oid": "969bd961bd6a8aae49c96a2ef27af203da9b0fad", "url": "https://github.com/micronaut-projects/micronaut-core/commit/969bd961bd6a8aae49c96a2ef27af203da9b0fad", "message": "refactor: @NonNull return HttpRequestTenantResolver", "committedDate": "2020-10-19T13:10:05Z", "type": "commit"}, {"oid": "a4201b51db4e37633ea65c67b2ded6ea93d75aee", "url": "https://github.com/micronaut-projects/micronaut-core/commit/a4201b51db4e37633ea65c67b2ded6ea93d75aee", "message": "refactor: TenantResolver @FunctionalInterface", "committedDate": "2020-10-19T13:10:10Z", "type": "commit"}, {"oid": "294f3e435fad02efeaa9f87dec4472bbdff52e33", "url": "https://github.com/micronaut-projects/micronaut-core/commit/294f3e435fad02efeaa9f87dec4472bbdff52e33", "message": "refactor: HttpRequestTenant.. @FunctionalInterface", "committedDate": "2020-10-19T13:10:10Z", "type": "commit"}, {"oid": "c301231f35af34964e81518eac3d71d877a676b1", "url": "https://github.com/micronaut-projects/micronaut-core/commit/c301231f35af34964e81518eac3d71d877a676b1", "message": "refactor: @NonNull to TenantResolver return", "committedDate": "2020-10-19T13:10:50Z", "type": "commit"}, {"oid": "ab3db2125b980c37138d8d244f57c68b8e8e845c", "url": "https://github.com/micronaut-projects/micronaut-core/commit/ab3db2125b980c37138d8d244f57c68b8e8e845c", "message": "Merge branch '2.2.x' into http-request-tenant-resolver", "committedDate": "2020-10-19T16:10:48Z", "type": "commit"}, {"oid": "b98c768d8811a3fc7bcb8620499668a57f8c75fd", "url": "https://github.com/micronaut-projects/micronaut-core/commit/b98c768d8811a3fc7bcb8620499668a57f8c75fd", "message": "Merge branch '2.2.x' into http-request-tenant-resolver", "committedDate": "2020-11-16T20:10:37Z", "type": "commit"}]}