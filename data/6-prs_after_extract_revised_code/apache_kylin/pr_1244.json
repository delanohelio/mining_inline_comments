{"pr_number": 1244, "pr_title": "Minor, refactor", "pr_createdAt": "2020-06-08T06:37:37Z", "pr_url": "https://github.com/apache/kylin/pull/1244", "timeline": [{"oid": "1763c16b5439a5e0e2443315de093fe129d84659", "url": "https://github.com/apache/kylin/commit/1763c16b5439a5e0e2443315de093fe129d84659", "message": "Minor, refactor\n\n- disbale setting kylin config\n- add check for database name\n- add check for command parameter", "committedDate": "2020-06-08T06:44:52Z", "type": "forcePushed"}, {"oid": "e477eeba9c4a780a37fce6a9039078be8422bf0b", "url": "https://github.com/apache/kylin/commit/e477eeba9c4a780a37fce6a9039078be8422bf0b", "message": "Minor, refactor\n\n- disbale setting kylin config\n- add check for database name\n- add check for command parameter", "committedDate": "2020-06-08T07:06:33Z", "type": "forcePushed"}, {"oid": "e666776bf4b1d63d1e3b7cdc860eba88127f5627", "url": "https://github.com/apache/kylin/commit/e666776bf4b1d63d1e3b7cdc860eba88127f5627", "message": "Minor, refactor\n\n- disbale setting kylin config\n- add check for database name\n- add check for command parameter", "committedDate": "2020-06-08T07:17:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2ODA2MQ==", "url": "https://github.com/apache/kylin/pull/1244#discussion_r436668061", "bodyText": "White or black, it is a question!\ud83d\ude01", "author": "hit-lacus", "createdAt": "2020-06-08T12:51:08Z", "path": "core-common/src/main/java/org/apache/kylin/common/util/CliCommandExecutor.java", "diffHunk": "@@ -195,10 +197,14 @@ public static String checkParameterWhiteList(String commandParameter) {\n         return checkParameter(commandParameter, COMMAND_WHITE_LIST);\n     }\n \n+    public static String checkHivePropertyWhiteList(String hiveProperty) {", "originalCommit": "e666776bf4b1d63d1e3b7cdc860eba88127f5627", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5a731db36ae04c47c6a184ec5aa8e36be6aa8c7e", "chunk": "diff --git a/core-common/src/main/java/org/apache/kylin/common/util/CliCommandExecutor.java b/core-common/src/main/java/org/apache/kylin/common/util/CliCommandExecutor.java\nindex 6f44aa51a..94d89e37a 100644\n--- a/core-common/src/main/java/org/apache/kylin/common/util/CliCommandExecutor.java\n+++ b/core-common/src/main/java/org/apache/kylin/common/util/CliCommandExecutor.java\n\n@@ -190,14 +190,14 @@ public class CliCommandExecutor {\n      * </pre>\n      */\n     public static String checkParameter(String commandParameter) {\n-        return checkParameter(commandParameter, COMMAND_INJECT_REX);\n+        return checkParameter(commandParameter, COMMAND_BLOCK_LIST);\n     }\n \n     public static String checkParameterWhiteList(String commandParameter) {\n         return checkParameter(commandParameter, COMMAND_WHITE_LIST);\n     }\n \n-    public static String checkHivePropertyWhiteList(String hiveProperty) {\n+    public static String checkHiveProperty(String hiveProperty) {\n         return checkParameter(hiveProperty, HIVE_INJECT_LIST);\n     }\n \n"}}, {"oid": "5a731db36ae04c47c6a184ec5aa8e36be6aa8c7e", "url": "https://github.com/apache/kylin/commit/5a731db36ae04c47c6a184ec5aa8e36be6aa8c7e", "message": "Minor, refactor\n\n- disbale setting kylin config\n- add check for database name\n- add check for command parameter", "committedDate": "2020-06-09T02:47:06Z", "type": "forcePushed"}, {"oid": "0a411b46af39933c1fae02fa9b87cb91863567a6", "url": "https://github.com/apache/kylin/commit/0a411b46af39933c1fae02fa9b87cb91863567a6", "message": "Minor, refactor\n\n- disbale setting kylin config\n- add check for database name\n- add check for command parameter", "committedDate": "2020-06-09T06:59:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4MDM5NQ==", "url": "https://github.com/apache/kylin/pull/1244#discussion_r437480395", "bodyText": "I'm not quite sure how many users are using this API. If we can provide another way to enable it (on their own risk), that can be more flexible.", "author": "shaofengshi", "createdAt": "2020-06-09T14:45:28Z", "path": "server-base/src/main/java/org/apache/kylin/rest/controller/AdminController.java", "diffHunk": "@@ -118,11 +116,6 @@ public void cleanupStorage() {\n         adminService.cleanupStorage();\n     }\n \n-    @RequestMapping(value = \"/config\", method = { RequestMethod.PUT }, produces = { \"application/json\" })", "originalCommit": "0a411b46af39933c1fae02fa9b87cb91863567a6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxNjcxMg==", "url": "https://github.com/apache/kylin/pull/1244#discussion_r437816712", "bodyText": "Yes I aggree, it's better to enable or disable this API with kylin.properties configuration. I'm working on it.", "author": "RupengWang", "createdAt": "2020-06-10T01:56:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4MDM5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU2MjI3Mw==", "url": "https://github.com/apache/kylin/pull/1244#discussion_r438562273", "bodyText": "Currently the function that setting config from the front end only can be enable or disable at the backend by modify the property  \"kylin.web.set-config-enable\" at kylin.properties and it's disable by default.\nIf \"kylin.web.set-config-enable\" is set to false, kylin will throw an exception when user try to  set config from website or restful API.", "author": "RupengWang", "createdAt": "2020-06-11T06:09:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4MDM5NQ=="}], "type": "inlineReview", "revised_code": {"commit": "e86bbd6dbf21ddabe01e4ad92a3e72555f4a2796", "chunk": "diff --git a/server-base/src/main/java/org/apache/kylin/rest/controller/AdminController.java b/server-base/src/main/java/org/apache/kylin/rest/controller/AdminController.java\nindex b2c29f547..5c8161469 100644\n--- a/server-base/src/main/java/org/apache/kylin/rest/controller/AdminController.java\n+++ b/server-base/src/main/java/org/apache/kylin/rest/controller/AdminController.java\n\n@@ -116,6 +119,14 @@ public class AdminController extends BasicController {\n         adminService.cleanupStorage();\n     }\n \n+    @RequestMapping(value = \"/config\", method = { RequestMethod.PUT }, produces = { \"application/json\" })\n+    public void updateKylinConfig(@RequestBody UpdateConfigRequest updateConfigRequest) {\n+        if (!adminService.configWritableStatus()) {\n+            throw new BadRequestException(\"Set config is not enabled by default!\");\n+        }\n+        adminService.updateConfig(updateConfigRequest.getKey(), updateConfigRequest.getValue());\n+    }\n+\n     public void setAdminService(AdminService adminService) {\n         this.adminService = adminService;\n     }\n"}}, {"oid": "e86bbd6dbf21ddabe01e4ad92a3e72555f4a2796", "url": "https://github.com/apache/kylin/commit/e86bbd6dbf21ddabe01e4ad92a3e72555f4a2796", "message": "Minor, refactor\n\n- disbale setting kylin config\n- add check for database name\n- add check for command parameter", "committedDate": "2020-06-11T05:54:59Z", "type": "forcePushed"}, {"oid": "51d76e76cad31ea1c6e8876e589896a911a3d7e9", "url": "https://github.com/apache/kylin/commit/51d76e76cad31ea1c6e8876e589896a911a3d7e9", "message": "Minor, refactor\n\n- disbale setting kylin config\n- add check for database name\n- add check for command parameter", "committedDate": "2020-06-11T06:18:33Z", "type": "commit"}, {"oid": "51d76e76cad31ea1c6e8876e589896a911a3d7e9", "url": "https://github.com/apache/kylin/commit/51d76e76cad31ea1c6e8876e589896a911a3d7e9", "message": "Minor, refactor\n\n- disbale setting kylin config\n- add check for database name\n- add check for command parameter", "committedDate": "2020-06-11T06:18:33Z", "type": "forcePushed"}]}