{"pr_number": 1732, "pr_title": "[JBPM-9298] Serialized session id is not written to .ser file in windows", "pr_createdAt": "2020-08-19T16:29:59Z", "pr_url": "https://github.com/kiegroup/jbpm/pull/1732", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY4NTkxMg==", "url": "https://github.com/kiegroup/jbpm/pull/1732#discussion_r473685912", "bodyText": "we have  commons lang3 in kie-server distribution. I would feel more comfortable using something like\nhttps://commons.apache.org/proper/commons-lang/javadocs/api-3.4/src-html/org/apache/commons/lang3/SystemUtils.html#line.1273\nwdyt ?", "author": "elguardian", "createdAt": "2020-08-20T07:20:04Z", "path": "jbpm-runtime-manager/src/main/java/org/jbpm/runtime/manager/impl/SingletonRuntimeManager.java", "diffHunk": "@@ -237,14 +237,19 @@ public void close() {\n         this.singleton = null;   \n     }\n     \n+    private File getPersistedFile(String location, String identifier) {\n+        // if windows, replace ':' by '_'\n+        return new File(location + File.separatorChar +\n+                        (File.separatorChar == '/' ? identifier : identifier.replace(':', '_')) + \"-jbpmSessionId.ser\");", "originalCommit": "227b67b70db1e4d33cead1a6841fa2ca8163f343", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc1ODc0OA==", "url": "https://github.com/kiegroup/jbpm/pull/1732#discussion_r473758748", "bodyText": "yes, that seems safer. Thanks for pointing out that commons-lang was available.", "author": "fjtirado", "createdAt": "2020-08-20T08:28:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY4NTkxMg=="}], "type": "inlineReview", "revised_code": {"commit": "571294f4fb0db89edd7563785d7c9ab8e91ade7f", "chunk": "diff --git a/jbpm-runtime-manager/src/main/java/org/jbpm/runtime/manager/impl/SingletonRuntimeManager.java b/jbpm-runtime-manager/src/main/java/org/jbpm/runtime/manager/impl/SingletonRuntimeManager.java\nindex 72582a435..0c8a6c063 100644\n--- a/jbpm-runtime-manager/src/main/java/org/jbpm/runtime/manager/impl/SingletonRuntimeManager.java\n+++ b/jbpm-runtime-manager/src/main/java/org/jbpm/runtime/manager/impl/SingletonRuntimeManager.java\n\n@@ -240,7 +241,7 @@ public class SingletonRuntimeManager extends AbstractRuntimeManager {\n     private File getPersistedFile(String location, String identifier) {\n         // if windows, replace ':' by '_'\n         return new File(location + File.separatorChar +\n-                        (File.separatorChar == '/' ? identifier : identifier.replace(':', '_')) + \"-jbpmSessionId.ser\");\n+                        (SystemUtils.IS_OS_WINDOWS ? identifier.replace(':', '_') : identifier) + \"-jbpmSessionId.ser\");\n     }\n     /**\n      * Retrieves session id from serialized file named jbpmSessionId.ser from given location.\n"}}, {"oid": "571294f4fb0db89edd7563785d7c9ab8e91ade7f", "url": "https://github.com/kiegroup/jbpm/commit/571294f4fb0db89edd7563785d7c9ab8e91ade7f", "message": "[JBPM-9298] Serialized session id is not written to .ser file in windows\n\nHere we are facing an OS related issue. Windows does not support ':' as\nfile name, so file writing always fails.\nIn order to fix it, we replace ':' by '_' if os is windows.\nTo determine OS we rely on apache common lang library", "committedDate": "2020-08-20T08:27:37Z", "type": "commit"}, {"oid": "571294f4fb0db89edd7563785d7c9ab8e91ade7f", "url": "https://github.com/kiegroup/jbpm/commit/571294f4fb0db89edd7563785d7c9ab8e91ade7f", "message": "[JBPM-9298] Serialized session id is not written to .ser file in windows\n\nHere we are facing an OS related issue. Windows does not support ':' as\nfile name, so file writing always fails.\nIn order to fix it, we replace ':' by '_' if os is windows.\nTo determine OS we rely on apache common lang library", "committedDate": "2020-08-20T08:27:37Z", "type": "forcePushed"}]}