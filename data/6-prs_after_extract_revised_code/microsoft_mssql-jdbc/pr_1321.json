{"pr_number": 1321, "pr_title": "Fix | Add certificate expire validation when using Always Encrypted with secure enclaves", "pr_createdAt": "2020-04-28T17:10:01Z", "pr_url": "https://github.com/microsoft/mssql-jdbc/pull/1321", "timeline": [{"oid": "c1752dff0f535d6164189045f82b750e422ae296", "url": "https://github.com/microsoft/mssql-jdbc/commit/c1752dff0f535d6164189045f82b750e422ae296", "message": "Check certificate expiry", "committedDate": "2020-04-20T17:16:04Z", "type": "commit"}, {"oid": "4f144fed1197baed87538c4f01b911978fbb1af3", "url": "https://github.com/microsoft/mssql-jdbc/commit/4f144fed1197baed87538c4f01b911978fbb1af3", "message": "Merge branch 'dev' of https://github.com/microsoft/mssql-jdbc into CertExpiry", "committedDate": "2020-04-28T17:09:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA4NzQ0Mw==", "url": "https://github.com/microsoft/mssql-jdbc/pull/1321#discussion_r417087443", "bodyText": "should we log a warning?", "author": "lilgreenbird", "createdAt": "2020-04-29T06:14:25Z", "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerVSMEnclaveProvider.java", "diffHunk": "@@ -275,9 +276,10 @@ void validateCert(byte[] b) throws SQLServerException {\n                         .generateCertificates(new ByteArrayInputStream(b));\n                 for (X509Certificate cert : certs) {\n                     try {\n+                        cert.checkValidity();\n                         healthCert.verify(cert.getPublicKey());\n                         return;\n-                    } catch (SignatureException e) {\n+                    } catch (SignatureException | CertificateExpiredException e) {\n                         // Doesn't match, but continue looping through the rest of the certificates", "originalCommit": "4f144fed1197baed87538c4f01b911978fbb1af3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzYzNTE1Nw==", "url": "https://github.com/microsoft/mssql-jdbc/pull/1321#discussion_r417635157", "bodyText": "I don't think it's necessary, up to the user to make sure their certificates haven't expired.", "author": "rene-ye", "createdAt": "2020-04-29T21:53:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA4NzQ0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY0OTYxMQ==", "url": "https://github.com/microsoft/mssql-jdbc/pull/1321#discussion_r417649611", "bodyText": "I think would be helpful if someone complains that they do have the certificate why isn't it working. But, I don't feel strongly about it so ok.", "author": "lilgreenbird", "createdAt": "2020-04-29T22:28:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA4NzQ0Mw=="}], "type": "inlineReview", "revised_code": null}]}