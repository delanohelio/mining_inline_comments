{"pr_number": 1390, "pr_title": "Check certificate expiry explicitly", "pr_createdAt": "2020-07-20T17:44:20Z", "pr_url": "https://github.com/microsoft/mssql-jdbc/pull/1390", "timeline": [{"oid": "7c9d4e0f02673ac072132cdf3472a743d64839e1", "url": "https://github.com/microsoft/mssql-jdbc/commit/7c9d4e0f02673ac072132cdf3472a743d64839e1", "message": "check exp", "committedDate": "2020-07-15T18:21:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzYxMzM2Mw==", "url": "https://github.com/microsoft/mssql-jdbc/pull/1390#discussion_r457613363", "bodyText": "state should be \"\"?", "author": "lilgreenbird", "createdAt": "2020-07-20T18:36:43Z", "path": "src/main/java/com/microsoft/sqlserver/jdbc/KeyStoreProviderCommon.java", "diffHunk": "@@ -30,8 +32,13 @@\n     X509Certificate certificate;\r\n     Key privateKey;\r\n \r\n-    CertificateDetails(X509Certificate certificate, Key privateKey) {\r\n+    CertificateDetails(X509Certificate certificate, Key privateKey) throws SQLServerException {\r\n         this.certificate = certificate;\r\n+        try {\r\n+            certificate.checkValidity();\r\n+        } catch (CertificateExpiredException | CertificateNotYetValidException e) {\r\n+            SQLServerException.makeFromDriverError(null, this, e.getLocalizedMessage(), \"0\", false);\r\n+        }\r", "originalCommit": "7c9d4e0f02673ac072132cdf3472a743d64839e1", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0c88dabd961a6b7af59ee009e0ba684974b53cdd", "chunk": "diff --git a/src/main/java/com/microsoft/sqlserver/jdbc/KeyStoreProviderCommon.java b/src/main/java/com/microsoft/sqlserver/jdbc/KeyStoreProviderCommon.java\nindex e0fcba5c..06753384 100644\n--- a/src/main/java/com/microsoft/sqlserver/jdbc/KeyStoreProviderCommon.java\n+++ b/src/main/java/com/microsoft/sqlserver/jdbc/KeyStoreProviderCommon.java\n\n@@ -37,7 +37,7 @@ class CertificateDetails {\n         try {\n             certificate.checkValidity();\n         } catch (CertificateExpiredException | CertificateNotYetValidException e) {\n-            SQLServerException.makeFromDriverError(null, this, e.getLocalizedMessage(), \"0\", false);\n+            SQLServerException.makeFromDriverError(null, this, e.getLocalizedMessage(), \"\", false);\n         }\n         this.privateKey = privateKey;\n     }\n"}}, {"oid": "0c88dabd961a6b7af59ee009e0ba684974b53cdd", "url": "https://github.com/microsoft/mssql-jdbc/commit/0c88dabd961a6b7af59ee009e0ba684974b53cdd", "message": "Change \"0\" to \"\"", "committedDate": "2020-07-20T21:45:34Z", "type": "commit"}]}