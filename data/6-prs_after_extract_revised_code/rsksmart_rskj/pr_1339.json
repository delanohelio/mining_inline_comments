{"pr_number": 1339, "pr_title": "Fixed length of root field in tx receipt response", "pr_createdAt": "2020-10-20T16:21:28Z", "pr_url": "https://github.com/rsksmart/rskj/pull/1339", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQyNzA3OA==", "url": "https://github.com/rsksmart/rskj/pull/1339#discussion_r510427078", "bodyText": "I would add an assert of the last byte, matching the src.", "author": "patogallaiovlabs", "createdAt": "2020-10-22T20:09:36Z", "path": "rskj-core/src/test/java/org/ethereum/util/ByteUtilTest.java", "diffHunk": "@@ -466,7 +466,47 @@ public void testParseBytes() {\n         for (int i=0; i < b3.length; i++) {\n             assertEquals(b3[i],normalByteArrayOffset3LeadingZeroes[i]);\n         }\n+    }\n+\n+    @Test(expected = IllegalArgumentException.class)\n+    public void testToBytesWithLeadingZeros_InvalidLen() {\n+        ByteUtil.toBytesWithLeadingZeros(new byte[0], -1);\n+    }\n+\n+    @Test\n+    public void testToBytesWithLeadingZeros_NullSource() {\n+        byte[] actualResult = ByteUtil.toBytesWithLeadingZeros(null, 1);\n+\n+        assertNull(actualResult);\n+    }\n+\n+    @Test\n+    public void testToBytesWithLeadingZeros_EmptySource() {\n+        byte[] src = new byte[0];\n+\n+        byte[] actualResult = ByteUtil.toBytesWithLeadingZeros(src, 0);\n \n+        assertEquals(src, actualResult);\n     }\n \n+    @Test\n+    public void testToBytesWithLeadingZeros_SameSource() {\n+        byte[] src = new byte[]{0};\n+\n+        byte[] actualResult = ByteUtil.toBytesWithLeadingZeros(src, 0);\n+\n+        assertEquals(src, actualResult);\n+    }\n+\n+    @Test\n+    public void testToBytesWithLeadingZeros_WithLeadingZeros() {\n+        byte[] src = new byte[]{1};\n+\n+        byte[] actualResult = ByteUtil.toBytesWithLeadingZeros(src, 10);\n+\n+        assertEquals(10, actualResult.length);\n+        for (int i = 0; i < actualResult.length - src.length; i++) {\n+            assertEquals(0, actualResult[i]);\n+        }", "originalCommit": "d3fecfe2363ac67db63e21659c29d6bf34b9f139", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fa57fe8843d7871936a82751d9e0b0dd5c5fbaf3", "chunk": "diff --git a/rskj-core/src/test/java/org/ethereum/util/ByteUtilTest.java b/rskj-core/src/test/java/org/ethereum/util/ByteUtilTest.java\nindex 2d194e128..118ca645b 100644\n--- a/rskj-core/src/test/java/org/ethereum/util/ByteUtilTest.java\n+++ b/rskj-core/src/test/java/org/ethereum/util/ByteUtilTest.java\n\n@@ -500,13 +500,18 @@ public class ByteUtilTest {\n \n     @Test\n     public void testToBytesWithLeadingZeros_WithLeadingZeros() {\n-        byte[] src = new byte[]{1};\n+        byte[] src = new byte[]{1, 2};\n \n         byte[] actualResult = ByteUtil.toBytesWithLeadingZeros(src, 10);\n \n         assertEquals(10, actualResult.length);\n-        for (int i = 0; i < actualResult.length - src.length; i++) {\n+\n+        int srcStart = actualResult.length - src.length;\n+        for (int i = 0; i < srcStart; i++) {\n             assertEquals(0, actualResult[i]);\n         }\n+        for (int i = srcStart; i < actualResult.length; i++) {\n+            assertEquals(src[i - srcStart], actualResult[i]);\n+        }\n     }\n }\n"}}, {"oid": "f7051035eb78516e99dcca714689224fb908d9e4", "url": "https://github.com/rsksmart/rskj/commit/f7051035eb78516e99dcca714689224fb908d9e4", "message": "Fixed length of root field in tx receipt response", "committedDate": "2020-11-09T13:40:59Z", "type": "commit"}, {"oid": "fa57fe8843d7871936a82751d9e0b0dd5c5fbaf3", "url": "https://github.com/rsksmart/rskj/commit/fa57fe8843d7871936a82751d9e0b0dd5c5fbaf3", "message": "Updated testToBytesWithLeadingZeros_WithLeadingZeros test", "committedDate": "2020-11-09T13:40:59Z", "type": "commit"}, {"oid": "bf9e2f19c1bc2c18393ae5614dae1e39f76b62fe", "url": "https://github.com/rsksmart/rskj/commit/bf9e2f19c1bc2c18393ae5614dae1e39f76b62fe", "message": "Added test for TransactionReceiptDTO.root field", "committedDate": "2020-11-09T13:40:59Z", "type": "commit"}, {"oid": "bf9e2f19c1bc2c18393ae5614dae1e39f76b62fe", "url": "https://github.com/rsksmart/rskj/commit/bf9e2f19c1bc2c18393ae5614dae1e39f76b62fe", "message": "Added test for TransactionReceiptDTO.root field", "committedDate": "2020-11-09T13:40:59Z", "type": "forcePushed"}]}