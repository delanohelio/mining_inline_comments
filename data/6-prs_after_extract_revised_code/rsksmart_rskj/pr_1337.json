{"pr_number": 1337, "pr_title": "Save to the StorageProvider the DerivationArguments and FastBridgeP2S\u2026", "pr_createdAt": "2020-10-13T19:04:28Z", "pr_url": "https://github.com/rsksmart/rskj/pull/1337", "timeline": [{"oid": "1ba8a7b31f0ac90194b13e064485c12ac0bf1a98", "url": "https://github.com/rsksmart/rskj/commit/1ba8a7b31f0ac90194b13e064485c12ac0bf1a98", "message": "Save to the StorageProvider the DerivationArguments and FastBridgeP2SH hash pair.\n\nIt is stored in StorageProvider using as key \"derivationArguments- <hash>\".\nGiven the derivationAargumentsdevuelve hash saved value of FastBridgeP2SH.", "committedDate": "2020-10-13T20:55:26Z", "type": "forcePushed"}, {"oid": "8f3fd5ef8fdf8ad4e7e0d613c84096e4e29b3225", "url": "https://github.com/rsksmart/rskj/commit/8f3fd5ef8fdf8ad4e7e0d613c84096e4e29b3225", "message": "Save to the StorageProvider the DerivationArguments and FastBridgeP2SH hash pair.\n\nIt is stored in StorageProvider using as key \"derivationArguments- <hash>\".\nGiven the derivationAargumentsdevuelve hash saved value of FastBridgeP2SH.", "committedDate": "2020-10-15T14:08:30Z", "type": "forcePushed"}, {"oid": "47f904a340703bd3c66b35be1c448482a7289349", "url": "https://github.com/rsksmart/rskj/commit/47f904a340703bd3c66b35be1c448482a7289349", "message": "Save to the StorageProvider the DerivationArguments and FastBridgeP2SH hash pair.\n\nIt is stored in StorageProvider using as key \"derivationArguments- <hash>\".\nGiven the derivationAargumentsdevuelve hash saved value of FastBridgeP2SH.", "committedDate": "2020-10-15T14:30:19Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcyNTg4Mw==", "url": "https://github.com/rsksmart/rskj/pull/1337#discussion_r505725883", "bodyText": "Is not it more clear activating specifically the expected fork?\nActivationConfig.ForBlock activations = mock(ActivationConfig.ForBlock.class);\nwhen(activations.isActive(ConsensusRule.RSKIP176)).thenReturn(true);", "author": "guidohernan93", "createdAt": "2020-10-15T17:44:13Z", "path": "rskj-core/src/test/java/co/rsk/peg/BridgeStorageProviderTest.java", "diffHunk": "@@ -2149,6 +2149,219 @@ public void saveCoinBaseInformation_after_RSKIP143() throws IOException {\n         );\n     }\n \n+    @Test\n+    public void getFastBridgeFederationScriptHash_afterRSKIP176_Ok() {\n+        Repository repository = mock(Repository.class);\n+\n+        Sha256Hash hash = Sha256Hash.ZERO_HASH;\n+        byte[] fastBridgeFedP2SH = new byte[]{(byte) 0xaa};\n+\n+        when(repository.getStorageBytes(PrecompiledContracts.BRIDGE_ADDR, DataWord.fromLongString(\"fastBridgeP2SH-\" + hash.toString())))\n+                .thenReturn(fastBridgeFedP2SH);\n+\n+        BridgeStorageProvider provider = new BridgeStorageProvider(\n+                repository,\n+                PrecompiledContracts.BRIDGE_ADDR,\n+                config.getNetworkConstants().getBridgeConstants(),\n+                activationsAllForks", "originalCommit": "47f904a340703bd3c66b35be1c448482a7289349", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc0NjYwNg==", "url": "https://github.com/rsksmart/rskj/pull/1337#discussion_r505746606", "bodyText": "We will do it. I did it in this way only to maintain the format comparing the rest of the code", "author": "pamgonzalez", "createdAt": "2020-10-15T18:16:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcyNTg4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "43e7f15af5be9fa4c63ee452468dc31fa6ec40d9", "chunk": "diff --git a/rskj-core/src/test/java/co/rsk/peg/BridgeStorageProviderTest.java b/rskj-core/src/test/java/co/rsk/peg/BridgeStorageProviderTest.java\nindex e39d71196..92617337d 100644\n--- a/rskj-core/src/test/java/co/rsk/peg/BridgeStorageProviderTest.java\n+++ b/rskj-core/src/test/java/co/rsk/peg/BridgeStorageProviderTest.java\n\n@@ -2156,6 +2156,9 @@ public class BridgeStorageProviderTest {\n         Sha256Hash hash = Sha256Hash.ZERO_HASH;\n         byte[] fastBridgeFedP2SH = new byte[]{(byte) 0xaa};\n \n+        ActivationConfig.ForBlock activations = mock(ActivationConfig.ForBlock.class);\n+        when(activations.isActive(ConsensusRule.RSKIP176)).thenReturn(true);\n+\n         when(repository.getStorageBytes(PrecompiledContracts.BRIDGE_ADDR, DataWord.fromLongString(\"fastBridgeP2SH-\" + hash.toString())))\n                 .thenReturn(fastBridgeFedP2SH);\n \n"}}, {"oid": "43e7f15af5be9fa4c63ee452468dc31fa6ec40d9", "url": "https://github.com/rsksmart/rskj/commit/43e7f15af5be9fa4c63ee452468dc31fa6ec40d9", "message": "Save to the StorageProvider the DerivationArguments and FastBridgeP2SH hash pair.\n\nIt is stored in StorageProvider using as key \"derivationArguments- <hash>\".\nGiven the derivationAargumentsdevuelve hash saved value of FastBridgeP2SH.", "committedDate": "2020-10-15T18:46:03Z", "type": "commit"}, {"oid": "43e7f15af5be9fa4c63ee452468dc31fa6ec40d9", "url": "https://github.com/rsksmart/rskj/commit/43e7f15af5be9fa4c63ee452468dc31fa6ec40d9", "message": "Save to the StorageProvider the DerivationArguments and FastBridgeP2SH hash pair.\n\nIt is stored in StorageProvider using as key \"derivationArguments- <hash>\".\nGiven the derivationAargumentsdevuelve hash saved value of FastBridgeP2SH.", "committedDate": "2020-10-15T18:46:03Z", "type": "forcePushed"}]}