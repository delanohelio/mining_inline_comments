{"pr_number": 1268, "pr_title": "Start Round Sync State", "pr_createdAt": "2020-07-07T15:29:21Z", "pr_url": "https://github.com/rsksmart/rskj/pull/1268", "timeline": [{"oid": "596afdd310d45fe9c688b215af40b26919aae4bc", "url": "https://github.com/rsksmart/rskj/commit/596afdd310d45fe9c688b215af40b26919aae4bc", "message": "change variable of blockHeader message bestblock to startBlockHash", "committedDate": "2020-06-25T13:56:58Z", "type": "commit"}, {"oid": "95fe5bfb55efd68a66ea1c6ad3537d027f6a7d9d", "url": "https://github.com/rsksmart/rskj/commit/95fe5bfb55efd68a66ea1c6ad3537d027f6a7d9d", "message": "syncProcessor works only with headers", "committedDate": "2020-06-25T13:58:52Z", "type": "commit"}, {"oid": "a261e71067649b005d40742056f4243bd5a180a1", "url": "https://github.com/rsksmart/rskj/commit/a261e71067649b005d40742056f4243bd5a180a1", "message": "Enhance testing and add tests for StartRoundSyncState", "committedDate": "2020-07-07T17:02:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA2NTUzNg==", "url": "https://github.com/rsksmart/rskj/pull/1268#discussion_r451065536", "bodyText": "the method naming is a little confusing, I know they do the same thing, but with different messages, you should rename it reflecting that", "author": "smcsicardi", "createdAt": "2020-07-07T18:35:14Z", "path": "rskj-core/src/main/java/co/rsk/net/light/LightSyncProcessor.java", "diffHunk": "@@ -120,44 +123,77 @@ public void sendStatusMessage(LightPeer lightPeer) {\n                 block.getNumber(), lightPeer.getPeerIdShort());\n     }\n \n-    public void sendBlockHeadersMessage(LightPeer lightPeer, byte[] bestBlock, int max, int skip, boolean reverse) {\n-        GetBlockHeadersByHashMessage blockHeaderMessage = new GetBlockHeadersByHashMessage(++lastRequestedId, bestBlock, max, skip, reverse);\n+    public void sendBlockHeadersMessage(LightPeer lightPeer, byte[] startBlockHash, int maxAmountOfHeaders, int skip, boolean reverse) {", "originalCommit": "b13980cb644da21638c9b90e11aec5d3dd796b9c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9419dc06861784092542e723d4b5dcb2f2f00fdf", "chunk": "diff --git a/rskj-core/src/main/java/co/rsk/net/light/LightSyncProcessor.java b/rskj-core/src/main/java/co/rsk/net/light/LightSyncProcessor.java\nindex 307399c62..abb88e0fb 100644\n--- a/rskj-core/src/main/java/co/rsk/net/light/LightSyncProcessor.java\n+++ b/rskj-core/src/main/java/co/rsk/net/light/LightSyncProcessor.java\n\n@@ -123,13 +122,13 @@ public class LightSyncProcessor {\n                 block.getNumber(), lightPeer.getPeerIdShort());\n     }\n \n-    public void sendBlockHeadersMessage(LightPeer lightPeer, byte[] startBlockHash, int maxAmountOfHeaders, int skip, boolean reverse) {\n-        GetBlockHeadersByHashMessage blockHeaderMessage = new GetBlockHeadersByHashMessage(++lastRequestedId, startBlockHash, maxAmountOfHeaders, skip, reverse);\n+    public void sendBlockHeadersByHashMessage(LightPeer lightPeer, byte[] startBlockHash, int max, int skip, boolean reverse) {\n+        GetBlockHeadersByHashMessage blockHeaderMessage = new GetBlockHeadersByHashMessage(++lastRequestedId, startBlockHash, max, skip, reverse);\n         sendMessage(lightPeer, blockHeaderMessage);\n     }\n \n-    public void sendBlockHeadersMessage(LightPeer lightPeer, long startBlockNumber, int maxAmountOfHeaders, int skip, boolean reverse) {\n-        GetBlockHeadersByNumberMessage blockHeaderMessage = new GetBlockHeadersByNumberMessage(++lastRequestedId, startBlockNumber, maxAmountOfHeaders, skip, reverse);\n+    public void sendBlockHeadersByNumberMessage(LightPeer lightPeer, long startBlockNumber, int max, int skip, boolean reverse) {\n+        GetBlockHeadersByNumberMessage blockHeaderMessage = new GetBlockHeadersByNumberMessage(++lastRequestedId, startBlockNumber, max, skip, reverse);\n         sendMessage(lightPeer, blockHeaderMessage);\n     }\n \n"}}, {"oid": "9419dc06861784092542e723d4b5dcb2f2f00fdf", "url": "https://github.com/rsksmart/rskj/commit/9419dc06861784092542e723d4b5dcb2f2f00fdf", "message": "StartRoundSync state added as the transition from FindCommonAncestor", "committedDate": "2020-07-07T18:50:05Z", "type": "commit"}, {"oid": "9cb40e45681dce4e699a8bd64de030b4565c7202", "url": "https://github.com/rsksmart/rskj/commit/9cb40e45681dce4e699a8bd64de030b4565c7202", "message": "Enhance testing and add tests for StartRoundSyncState", "committedDate": "2020-07-07T18:50:06Z", "type": "commit"}, {"oid": "924332904345c30028607bddcb83a3d28d446f49", "url": "https://github.com/rsksmart/rskj/commit/924332904345c30028607bddcb83a3d28d446f49", "message": "MAX_REQUESTED_HEADERS used as max amount of headers and modified tests of LightSyncProcessor", "committedDate": "2020-07-07T18:53:25Z", "type": "commit"}, {"oid": "9669b25dfcbf5634cfa616ccd267f9cf83cf4324", "url": "https://github.com/rsksmart/rskj/commit/9669b25dfcbf5634cfa616ccd267f9cf83cf4324", "message": "max variable in GetBlockHeaderMessage replaced by maxAmountOfHeaders", "committedDate": "2020-07-07T18:53:32Z", "type": "commit"}, {"oid": "9669b25dfcbf5634cfa616ccd267f9cf83cf4324", "url": "https://github.com/rsksmart/rskj/commit/9669b25dfcbf5634cfa616ccd267f9cf83cf4324", "message": "max variable in GetBlockHeaderMessage replaced by maxAmountOfHeaders", "committedDate": "2020-07-07T18:53:32Z", "type": "forcePushed"}]}