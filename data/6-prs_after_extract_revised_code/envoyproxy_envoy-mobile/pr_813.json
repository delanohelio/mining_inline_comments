{"pr_number": 813, "pr_title": "error handling: add attempt counts to the library's error types", "pr_createdAt": "2020-04-24T23:27:05Z", "pr_url": "https://github.com/envoyproxy/envoy-mobile/pull/813", "timeline": [{"oid": "ad3bf7571c04f9202fbdfd5933f689246fb6cfd2", "url": "https://github.com/envoyproxy/envoy-mobile/commit/ad3bf7571c04f9202fbdfd5933f689246fb6cfd2", "message": "first pass\n\nSigned-off-by: Jose Nino <jnino@lyft.com>", "committedDate": "2020-04-24T22:37:33Z", "type": "commit"}, {"oid": "b806deb0ca0796296142a0cac8a9a8e468b8d625", "url": "https://github.com/envoyproxy/envoy-mobile/commit/b806deb0ca0796296142a0cac8a9a8e468b8d625", "message": "tests\n\nSigned-off-by: Jose Nino <jnino@lyft.com>", "committedDate": "2020-04-24T23:23:18Z", "type": "commit"}, {"oid": "4be12e39be3e58af6ea3d90c15ab8c14b0cdc676", "url": "https://github.com/envoyproxy/envoy-mobile/commit/4be12e39be3e58af6ea3d90c15ab8c14b0cdc676", "message": "fmt\n\nSigned-off-by: Jose Nino <jnino@lyft.com>", "committedDate": "2020-04-24T23:24:37Z", "type": "commit"}, {"oid": "19b1e37ba1617934f458e10e779dafe3e69e9275", "url": "https://github.com/envoyproxy/envoy-mobile/commit/19b1e37ba1617934f458e10e779dafe3e69e9275", "message": "swiftlint\n\nSigned-off-by: Jose Nino <jnino@lyft.com>", "committedDate": "2020-04-24T23:31:50Z", "type": "commit"}, {"oid": "678e45339f906c82a8f2996716e756e0d10f5e96", "url": "https://github.com/envoyproxy/envoy-mobile/commit/678e45339f906c82a8f2996716e756e0d10f5e96", "message": "fix\n\nSigned-off-by: Jose Nino <jnino@lyft.com>", "committedDate": "2020-04-24T23:38:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDkyMDkyMw==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/813#discussion_r414920923", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                          String msg = new String(\"failed with error after \" + error.getAttemptCount() +\n          \n          \n            \n                                                  \" attempts: \" + error.getMessage());\n          \n          \n            \n                          Log.d(\"MainActivity\", msg);\n          \n          \n            \n                          Log.d(\"MainActivity\", \"failed with error after \" + error.getAttemptCount() +\n          \n          \n            \n                                                  \" attempts: \" + error.getMessage());", "author": "buildbreaker", "createdAt": "2020-04-24T23:41:49Z", "path": "examples/java/hello_world/MainActivity.java", "diffHunk": "@@ -104,8 +104,10 @@ private void makeRequest() {\n               return Unit.INSTANCE;\n             })\n             .onError((error) -> {\n-              recyclerView.post(\n-                  () -> viewAdapter.add(new Failure(\"failed with error \" + error.getMessage())));\n+              String msg = new String(\"failed with error after \" + error.getAttemptCount() +\n+                                      \" attempts: \" + error.getMessage());\n+              Log.d(\"MainActivity\", msg);", "originalCommit": "678e45339f906c82a8f2996716e756e0d10f5e96", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjA5ODY4MA==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/813#discussion_r416098680", "bodyText": "I want to give the Failure object the same string, though", "author": "junr03", "createdAt": "2020-04-27T19:44:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDkyMDkyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjEwMDM0Mw==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/813#discussion_r416100343", "bodyText": "uhh how about\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                          String msg = new String(\"failed with error after \" + error.getAttemptCount() +\n          \n          \n            \n                                                  \" attempts: \" + error.getMessage());\n          \n          \n            \n                          Log.d(\"MainActivity\", msg);\n          \n          \n            \n                          String msg = \"failed with error after \" + error.getAttemptCount() +\n          \n          \n            \n                                                  \" attempts: \" + error.getMessage();\n          \n          \n            \n                          Log.d(\"MainActivity\", msg);\n          \n      \n    \n    \n  \n\nSince the new String() is redundant here", "author": "buildbreaker", "createdAt": "2020-04-27T19:47:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDkyMDkyMw=="}], "type": "inlineReview", "revised_code": {"commit": "e8a1416fdecac3bcf8846011765d9ca2d31dfc8c", "chunk": "diff --git a/examples/java/hello_world/MainActivity.java b/examples/java/hello_world/MainActivity.java\nindex 8d5dcb44..88fe7648 100644\n--- a/examples/java/hello_world/MainActivity.java\n+++ b/examples/java/hello_world/MainActivity.java\n\n@@ -104,8 +104,8 @@ public class MainActivity extends Activity {\n               return Unit.INSTANCE;\n             })\n             .onError((error) -> {\n-              String msg = new String(\"failed with error after \" + error.getAttemptCount() +\n-                                      \" attempts: \" + error.getMessage());\n+              String msg = \"failed with error after \" + error.getAttemptCount() +\n+                           \" attempts: \" + error.getMessage();\n               Log.d(\"MainActivity\", msg);\n               recyclerView.post(() -> viewAdapter.add(new Failure(msg)));\n               return Unit.INSTANCE;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDkyOTk1MQ==", "url": "https://github.com/envoyproxy/envoy-mobile/pull/813#discussion_r414929951", "bodyText": "Thi\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @param errorCode,    the envoy_error_code_t.\n          \n          \n            \n               * @param errorCode,    the error code.", "author": "rebello95", "createdAt": "2020-04-25T00:15:03Z", "path": "library/java/src/io/envoyproxy/envoymobile/engine/JvmCallbackContext.java", "diffHunk": "@@ -127,14 +127,15 @@ public void run() {\n   /**\n    * Dispatches error received from the JNI layer up to the platform.\n    *\n-   * @param message,   the error message.\n-   * @param errorCode, the envoy_error_code_t.\n+   * @param errorCode,    the envoy_error_code_t.", "originalCommit": "678e45339f906c82a8f2996716e756e0d10f5e96", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e8a1416fdecac3bcf8846011765d9ca2d31dfc8c", "chunk": "diff --git a/library/java/src/io/envoyproxy/envoymobile/engine/JvmCallbackContext.java b/library/java/src/io/envoyproxy/envoymobile/engine/JvmCallbackContext.java\nindex f406f45d..aa61bdd7 100644\n--- a/library/java/src/io/envoyproxy/envoymobile/engine/JvmCallbackContext.java\n+++ b/library/java/src/io/envoyproxy/envoymobile/engine/JvmCallbackContext.java\n\n@@ -127,7 +127,7 @@ class JvmCallbackContext {\n   /**\n    * Dispatches error received from the JNI layer up to the platform.\n    *\n-   * @param errorCode,    the envoy_error_code_t.\n+   * @param errorCode,    the error code.\n    * @param message,      the error message.\n    * @param attemptCount, the number of times an operation was attempted before firing this error.\n    */\n"}}, {"oid": "e8a1416fdecac3bcf8846011765d9ca2d31dfc8c", "url": "https://github.com/envoyproxy/envoy-mobile/commit/e8a1416fdecac3bcf8846011765d9ca2d31dfc8c", "message": "optional\n\nSigned-off-by: Jose Nino <jnino@lyft.com>", "committedDate": "2020-04-27T22:10:51Z", "type": "commit"}, {"oid": "d8881a88f5fae21d955d7abcd41b4768c6e29a2d", "url": "https://github.com/envoyproxy/envoy-mobile/commit/d8881a88f5fae21d955d7abcd41b4768c6e29a2d", "message": "comments\n\nSigned-off-by: Jose Nino <jnino@lyft.com>", "committedDate": "2020-04-28T00:04:09Z", "type": "commit"}]}