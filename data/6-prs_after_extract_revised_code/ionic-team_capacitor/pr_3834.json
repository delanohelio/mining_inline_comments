{"pr_number": 3834, "pr_title": "fix(android): load local assets when using wildcard on allowNavigation", "pr_createdAt": "2020-11-20T15:48:34Z", "pr_url": "https://github.com/ionic-team/capacitor/pull/3834", "timeline": [{"oid": "f5793f7a86e4aa50a861278e1d06dc7f03252898", "url": "https://github.com/ionic-team/capacitor/commit/f5793f7a86e4aa50a861278e1d06dc7f03252898", "message": "fix(android): load local assets when using wildcard on allowNavigation", "committedDate": "2020-11-20T15:46:25Z", "type": "commit"}, {"oid": "7e6f2085b5741fa8de6fa0b6de22a42f6d6b36c9", "url": "https://github.com/ionic-team/capacitor/commit/7e6f2085b5741fa8de6fa0b6de22a42f6d6b36c9", "message": "Merge branch '2.x' into fix-wildcard", "committedDate": "2020-11-20T17:31:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzg1NzcxMg==", "url": "https://github.com/ionic-team/capacitor/pull/3834#discussion_r527857712", "bodyText": "Would this incorrectly trigger if loadingUrl.getHost() = \"something.app\" and bridge.getHost() = \"app\"?", "author": "imhoffd", "createdAt": "2020-11-20T17:38:23Z", "path": "android/capacitor/src/main/java/com/getcapacitor/WebViewLocalServer.java", "diffHunk": "@@ -172,7 +172,7 @@ public WebResourceResponse shouldInterceptRequest(WebResourceRequest request) {\n       return null;\n     }\n \n-    if (isLocalFile(loadingUrl) || (bridge.getConfig().getString(\"server.url\") == null && !bridge.getAppAllowNavigationMask().matches(loadingUrl.getHost()))) {\n+    if (isLocalFile(loadingUrl) || loadingUrl.getHost().contains(bridge.getHost()) || (bridge.getServerUrl() == null && !bridge.getAppAllowNavigationMask().matches(loadingUrl.getHost()))) {", "originalCommit": "7e6f2085b5741fa8de6fa0b6de22a42f6d6b36c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODgyMjY3NQ==", "url": "https://github.com/ionic-team/capacitor/pull/3834#discussion_r528822675", "bodyText": "changed the contains to equalsIgnoreCase", "author": "jcesarmobile", "createdAt": "2020-11-23T16:11:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzg1NzcxMg=="}], "type": "inlineReview", "revised_code": {"commit": "54dafb7a663dddc6b311f216faa2195af863d677", "chunk": "diff --git a/android/capacitor/src/main/java/com/getcapacitor/WebViewLocalServer.java b/android/capacitor/src/main/java/com/getcapacitor/WebViewLocalServer.java\nindex d15946a6..44bccc32 100755\n--- a/android/capacitor/src/main/java/com/getcapacitor/WebViewLocalServer.java\n+++ b/android/capacitor/src/main/java/com/getcapacitor/WebViewLocalServer.java\n\n@@ -172,7 +172,7 @@ public class WebViewLocalServer {\n       return null;\n     }\n \n-    if (isLocalFile(loadingUrl) || loadingUrl.getHost().contains(bridge.getHost()) || (bridge.getServerUrl() == null && !bridge.getAppAllowNavigationMask().matches(loadingUrl.getHost()))) {\n+    if (isLocalFile(loadingUrl) || loadingUrl.getHost().equalsIgnoreCase(bridge.getHost()) || (bridge.getServerUrl() == null && !bridge.getAppAllowNavigationMask().matches(loadingUrl.getHost()))) {\n       Logger.debug(\"Handling local request: \" + request.getUrl().toString());\n       return handleLocalRequest(request, handler);\n     } else {\n"}}, {"oid": "54dafb7a663dddc6b311f216faa2195af863d677", "url": "https://github.com/ionic-team/capacitor/commit/54dafb7a663dddc6b311f216faa2195af863d677", "message": "use equals instead of contains", "committedDate": "2020-11-23T16:10:13Z", "type": "commit"}]}