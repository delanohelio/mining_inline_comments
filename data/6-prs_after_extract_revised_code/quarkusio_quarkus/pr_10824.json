{"pr_number": 10824, "pr_title": "Knative fixes", "pr_createdAt": "2020-07-18T07:26:18Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10824", "timeline": [{"oid": "fb8e2a5c66868ee95bd51ccd0857c250d1fa1ae3", "url": "https://github.com/quarkusio/quarkus/commit/fb8e2a5c66868ee95bd51ccd0857c250d1fa1ae3", "message": "fix(#8659): knative probe ports are removed.", "committedDate": "2020-07-18T07:17:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc5NTA0Nw==", "url": "https://github.com/quarkusio/quarkus/pull/10824#discussion_r456795047", "bodyText": "Very minor but is there a reason why you use a string here rather than using the KNATIVE constant as below?", "author": "gsmet", "createdAt": "2020-07-18T14:26:06Z", "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeployer.java", "diffHunk": "@@ -168,7 +168,11 @@ private DeploymentResultBuildItem deploy(DeploymentTargetEntry deploymentTarget,\n         try (FileInputStream fis = new FileInputStream(manifest)) {\n             KubernetesList list = Serialization.unmarshalAsList(fis);\n             distinct(list.getItems()).forEach(i -> {\n-                client.resource(i).inNamespace(namespace).createOrReplace();\n+                if (\"knative\".equals(deploymentTarget.getName().toLowerCase())) {", "originalCommit": "5720d2a721756d79ed5a602182169cea3000d60d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA2OTY5Ng==", "url": "https://github.com/quarkusio/quarkus/pull/10824#discussion_r457069696", "bodyText": "Indeed, @iocanel can you fix this so we can merge?", "author": "geoand", "createdAt": "2020-07-20T05:40:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc5NTA0Nw=="}], "type": "inlineReview", "revised_code": {"commit": "acf233eeef62c5b3d556d3412f957579fdb17afb", "chunk": "diff --git a/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeployer.java b/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeployer.java\nindex 31da2489e4..d8daee6e3a 100644\n--- a/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeployer.java\n+++ b/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeployer.java\n\n@@ -168,7 +169,7 @@ public class KubernetesDeployer {\n         try (FileInputStream fis = new FileInputStream(manifest)) {\n             KubernetesList list = Serialization.unmarshalAsList(fis);\n             distinct(list.getItems()).forEach(i -> {\n-                if (\"knative\".equals(deploymentTarget.getName().toLowerCase())) {\n+                if (KNATIVE.equals(deploymentTarget.getName().toLowerCase())) {\n                     client.resource(i).inNamespace(namespace).deletingExisting().createOrReplace();\n                 } else {\n                     client.resource(i).inNamespace(namespace).createOrReplace();\n"}}, {"oid": "acf233eeef62c5b3d556d3412f957579fdb17afb", "url": "https://github.com/quarkusio/quarkus/commit/acf233eeef62c5b3d556d3412f957579fdb17afb", "message": "fix(#10823): use delete existing when applying knative resources", "committedDate": "2020-07-20T06:59:15Z", "type": "commit"}, {"oid": "acf233eeef62c5b3d556d3412f957579fdb17afb", "url": "https://github.com/quarkusio/quarkus/commit/acf233eeef62c5b3d556d3412f957579fdb17afb", "message": "fix(#10823): use delete existing when applying knative resources", "committedDate": "2020-07-20T06:59:15Z", "type": "forcePushed"}]}