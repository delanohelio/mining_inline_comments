{"pr_number": 10421, "pr_title": "Ensure that duplicates don't end up in dev mode CP in multi-module projects", "pr_createdAt": "2020-07-02T07:12:02Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10421", "timeline": [{"oid": "967200d4c1cda9cac7428fc4ce2ab9fc76b632dc", "url": "https://github.com/quarkusio/quarkus/commit/967200d4c1cda9cac7428fc4ce2ab9fc76b632dc", "message": "Ensure that duplicates don't end up in dev mode CP in multi-module projects\n\nFixes: #10411", "committedDate": "2020-07-02T07:12:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc5OTY0MA==", "url": "https://github.com/quarkusio/quarkus/pull/10421#discussion_r448799640", "bodyText": "appDep.getArtifactHandler().getExtension() perhaps would be a more accurate one.", "author": "aloubyansky", "createdAt": "2020-07-02T07:23:49Z", "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -657,7 +657,12 @@ void prepare(final boolean triggerCompile) throws Exception {\n             //in most cases these are not used, however they need to be present for some\n             //parent-first cases such as logging\n             for (Artifact appDep : project.getArtifacts()) {\n-                addToClassPaths(classPathManifest, appDep.getFile());\n+                // only add the artifact if it's present in the dev mode context\n+                // we need this to avoid having jars on the classpath multiple times\n+                if (!devModeContext.getLocalArtifacts().contains(new AppArtifactKey(appDep.getGroupId(), appDep.getArtifactId(),\n+                        appDep.getClassifier(), appDep.getType()))) {", "originalCommit": "967200d4c1cda9cac7428fc4ce2ab9fc76b632dc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODgwMTE5Ng==", "url": "https://github.com/quarkusio/quarkus/pull/10421#discussion_r448801196", "bodyText": "Didn't know that one, thanks!", "author": "geoand", "createdAt": "2020-07-02T07:26:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc5OTY0MA=="}], "type": "inlineReview", "revised_code": {"commit": "dbb37830762b100d82c5c08df6c08dfb320d0ba0", "chunk": "diff --git a/devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java b/devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java\nindex 520628af03..9288cc522b 100644\n--- a/devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java\n+++ b/devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java\n\n@@ -660,7 +660,7 @@ public class DevMojo extends AbstractMojo {\n                 // only add the artifact if it's present in the dev mode context\n                 // we need this to avoid having jars on the classpath multiple times\n                 if (!devModeContext.getLocalArtifacts().contains(new AppArtifactKey(appDep.getGroupId(), appDep.getArtifactId(),\n-                        appDep.getClassifier(), appDep.getType()))) {\n+                        appDep.getClassifier(), appDep.getArtifactHandler().getExtension()))) {\n                     addToClassPaths(classPathManifest, appDep.getFile());\n                 }\n             }\n"}}, {"oid": "dbb37830762b100d82c5c08df6c08dfb320d0ba0", "url": "https://github.com/quarkusio/quarkus/commit/dbb37830762b100d82c5c08df6c08dfb320d0ba0", "message": "Ensure that duplicates don't end up in dev mode CP in multi-module projects\n\nFixes: #10411", "committedDate": "2020-07-02T07:26:46Z", "type": "forcePushed"}, {"oid": "b8fc5a2caeffa6a29813dda4a7ce28422998cbb7", "url": "https://github.com/quarkusio/quarkus/commit/b8fc5a2caeffa6a29813dda4a7ce28422998cbb7", "message": "Ensure that duplicates don't end up in dev mode CP in multi-module projects\n\nFixes: #10411", "committedDate": "2020-07-02T10:42:44Z", "type": "commit"}, {"oid": "b8fc5a2caeffa6a29813dda4a7ce28422998cbb7", "url": "https://github.com/quarkusio/quarkus/commit/b8fc5a2caeffa6a29813dda4a7ce28422998cbb7", "message": "Ensure that duplicates don't end up in dev mode CP in multi-module projects\n\nFixes: #10411", "committedDate": "2020-07-02T10:42:44Z", "type": "forcePushed"}]}