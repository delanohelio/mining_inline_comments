{"pr_number": 7948, "pr_title": "Throw exception if using blocking mailer from IO thread", "pr_createdAt": "2020-03-19T00:57:03Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7948", "timeline": [{"oid": "d2544a6d1ce75f10dbbbb2d3bcc64d7db640b672", "url": "https://github.com/quarkusio/quarkus/commit/d2544a6d1ce75f10dbbbb2d3bcc64d7db640b672", "message": "Throw exception if using blocking mailer from IO thread\n\nThis prevents a potential deadlock.\n\nFixes #3223", "committedDate": "2020-03-19T02:10:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc2ODA2NQ==", "url": "https://github.com/quarkusio/quarkus/pull/7948#discussion_r394768065", "bodyText": "There's a typo in the error message:\n\nIf you want to send main from...\n\nShould have been \"If you want to send mail from...\"", "author": "jaikiran", "createdAt": "2020-03-19T03:16:27Z", "path": "extensions/mailer/runtime/src/main/java/io/quarkus/mailer/runtime/BlockingMailerImpl.java", "diffHunk": "@@ -18,6 +19,10 @@\n \n     @Override\n     public void send(Mail... mails) {\n+        if (!BlockingOperationControl.isBlockingAllowed()) {\n+            throw new RuntimeException(\n+                    \"Attempted a blocking operation from the IO thread. If you want to send main from an IO thread please use ReactiveMailer instead, or dispatch to a worker thread to use the blocking mailer.\");", "originalCommit": "d2544a6d1ce75f10dbbbb2d3bcc64d7db640b672", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fd98d59afbe353791b32bf4cbcec07e59c070c5d", "chunk": "diff --git a/extensions/mailer/runtime/src/main/java/io/quarkus/mailer/runtime/BlockingMailerImpl.java b/extensions/mailer/runtime/src/main/java/io/quarkus/mailer/runtime/BlockingMailerImpl.java\nindex 92e818f8a3..89db004415 100644\n--- a/extensions/mailer/runtime/src/main/java/io/quarkus/mailer/runtime/BlockingMailerImpl.java\n+++ b/extensions/mailer/runtime/src/main/java/io/quarkus/mailer/runtime/BlockingMailerImpl.java\n\n@@ -21,7 +21,7 @@ public class BlockingMailerImpl implements Mailer {\n     public void send(Mail... mails) {\n         if (!BlockingOperationControl.isBlockingAllowed()) {\n             throw new RuntimeException(\n-                    \"Attempted a blocking operation from the IO thread. If you want to send main from an IO thread please use ReactiveMailer instead, or dispatch to a worker thread to use the blocking mailer.\");\n+                    \"Attempted a blocking operation from the IO thread. If you want to send mail from an IO thread please use ReactiveMailer instead, or dispatch to a worker thread to use the blocking mailer.\");\n         }\n         mailer.send(mails).toCompletableFuture().join();\n     }\n"}}, {"oid": "fd98d59afbe353791b32bf4cbcec07e59c070c5d", "url": "https://github.com/quarkusio/quarkus/commit/fd98d59afbe353791b32bf4cbcec07e59c070c5d", "message": "Throw exception if using blocking mailer from IO thread\n\nThis prevents a potential deadlock.\n\nFixes #3223", "committedDate": "2020-03-19T03:59:34Z", "type": "commit"}, {"oid": "fd98d59afbe353791b32bf4cbcec07e59c070c5d", "url": "https://github.com/quarkusio/quarkus/commit/fd98d59afbe353791b32bf4cbcec07e59c070c5d", "message": "Throw exception if using blocking mailer from IO thread\n\nThis prevents a potential deadlock.\n\nFixes #3223", "committedDate": "2020-03-19T03:59:34Z", "type": "forcePushed"}]}