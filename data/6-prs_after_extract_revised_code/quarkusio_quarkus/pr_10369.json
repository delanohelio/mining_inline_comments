{"pr_number": 10369, "pr_title": "ArC - introduce CacheGet annotation", "pr_createdAt": "2020-06-30T13:16:14Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10369", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE5NzgyOQ==", "url": "https://github.com/quarkusio/quarkus/pull/10369#discussion_r448197829", "bodyText": "Maybe add a notion of being able to clear the cache?", "author": "manovotn", "createdAt": "2020-07-01T08:20:32Z", "path": "independent-projects/arc/runtime/src/main/java/io/quarkus/arc/CacheGet.java", "diffHunk": "@@ -0,0 +1,70 @@\n+package io.quarkus.arc;\n+\n+import static java.lang.annotation.ElementType.FIELD;\n+import static java.lang.annotation.ElementType.PARAMETER;\n+import static java.lang.annotation.RetentionPolicy.RUNTIME;\n+\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.Target;\n+import javax.enterprise.context.Dependent;\n+import javax.enterprise.inject.Instance;\n+\n+/**\n+ * Instructs an injected {@link Instance} to cache the result of the {@link Instance#get()} operation\n+ * <p>\n+ * The result is \"computed\" on the first call to {@link Instance#get()} and the same value is returned for all subsequent calls,", "originalCommit": "0a95830a554da828412184b320c478c804541a20", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIwMjA1MA==", "url": "https://github.com/quarkusio/quarkus/pull/10369#discussion_r448202050", "bodyText": "Good point.", "author": "mkouba", "createdAt": "2020-07-01T08:27:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE5NzgyOQ=="}], "type": "inlineReview", "revised_code": {"commit": "588681d97603a1c3566e9e2713ad4d0012602eac", "chunk": "diff --git a/independent-projects/arc/runtime/src/main/java/io/quarkus/arc/CacheGet.java b/independent-projects/arc/runtime/src/main/java/io/quarkus/arc/WithCaching.java\nsimilarity index 66%\nrename from independent-projects/arc/runtime/src/main/java/io/quarkus/arc/CacheGet.java\nrename to independent-projects/arc/runtime/src/main/java/io/quarkus/arc/WithCaching.java\nindex ef6f2c6b01..e9609a3d1e 100644\n--- a/independent-projects/arc/runtime/src/main/java/io/quarkus/arc/CacheGet.java\n+++ b/independent-projects/arc/runtime/src/main/java/io/quarkus/arc/WithCaching.java\n\n@@ -10,14 +10,14 @@ import javax.enterprise.context.Dependent;\n import javax.enterprise.inject.Instance;\n \n /**\n- * Instructs an injected {@link Instance} to cache the result of the {@link Instance#get()} operation\n+ * An injected {@link Instance} annotated with this annotation will cache the result of the {@link Instance#get()} operation.\n+ * \n  * <p>\n  * The result is \"computed\" on the first call to {@link Instance#get()} and the same value is returned for all subsequent calls,\n  * even for {@link Dependent} beans.\n  * </p>\n  * \n  * <h2>Example</h2>\n- *\n  * <pre>\n  * <code>\n  *  class Producer {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE5OTczMA==", "url": "https://github.com/quarkusio/quarkus/pull/10369#discussion_r448199730", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Removes the cached result of the {@link #get()} operation. If the cached result was a contextual reference of\n          \n          \n            \n                 * Removes all cached results of the {@link #get()} operations. If any of cached results was a contextual reference of", "author": "manovotn", "createdAt": "2020-07-01T08:23:40Z", "path": "independent-projects/arc/runtime/src/main/java/io/quarkus/arc/InjectableInstance.java", "diffHunk": "@@ -24,4 +25,12 @@\n     @Override\n     <U extends T> InjectableInstance<U> select(TypeLiteral<U> subtype, Annotation... qualifiers);\n \n+    /**\n+     * Removes the cached result of the {@link #get()} operation. If the cached result was a contextual reference of", "originalCommit": "0a95830a554da828412184b320c478c804541a20", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIwMTk2NQ==", "url": "https://github.com/quarkusio/quarkus/pull/10369#discussion_r448201965", "bodyText": "There is only one cached result of get()...", "author": "mkouba", "createdAt": "2020-07-01T08:27:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE5OTczMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxODE2Ng==", "url": "https://github.com/quarkusio/quarkus/pull/10369#discussion_r448218166", "bodyText": "Yeah, my bad, sorry.", "author": "manovotn", "createdAt": "2020-07-01T08:55:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE5OTczMA=="}], "type": "inlineReview", "revised_code": {"commit": "588681d97603a1c3566e9e2713ad4d0012602eac", "chunk": "diff --git a/independent-projects/arc/runtime/src/main/java/io/quarkus/arc/InjectableInstance.java b/independent-projects/arc/runtime/src/main/java/io/quarkus/arc/InjectableInstance.java\nindex 98f6fabadb..41ffcb3fce 100644\n--- a/independent-projects/arc/runtime/src/main/java/io/quarkus/arc/InjectableInstance.java\n+++ b/independent-projects/arc/runtime/src/main/java/io/quarkus/arc/InjectableInstance.java\n\n@@ -29,7 +29,7 @@ public interface InjectableInstance<T> extends Instance<T> {\n      * Removes the cached result of the {@link #get()} operation. If the cached result was a contextual reference of\n      * a {@link Dependent} bean, destroy the reference as well.\n      * \n-     * @see CacheGet\n+     * @see WithCaching\n      */\n     void clearCache();\n \n"}}, {"oid": "588681d97603a1c3566e9e2713ad4d0012602eac", "url": "https://github.com/quarkusio/quarkus/commit/588681d97603a1c3566e9e2713ad4d0012602eac", "message": "ArC - introduce WichCaching annotation\n\n- that instructs an injected Instance<> to cache the result of the get()\nmethod\n- makes it possible to use Instance<> to lazily fetch a dependent bean\nand reuse the instance for subsequent get() invocations", "committedDate": "2020-07-01T08:45:51Z", "type": "forcePushed"}, {"oid": "1600d499273828379adcfb2ee45e6b540214427d", "url": "https://github.com/quarkusio/quarkus/commit/1600d499273828379adcfb2ee45e6b540214427d", "message": "ArC - introduce WichCaching annotation\n\n- that instructs an injected Instance<> to cache the result of the get()\nmethod\n- makes it possible to use Instance<> to lazily fetch a dependent bean\nand reuse the instance for subsequent get() invocations", "committedDate": "2020-07-01T08:47:25Z", "type": "forcePushed"}, {"oid": "e623c75a04e140d32cf344fe11c3463732467664", "url": "https://github.com/quarkusio/quarkus/commit/e623c75a04e140d32cf344fe11c3463732467664", "message": "ArC - introduce WichCaching annotation\n\n- that instructs an injected Instance<> to cache the result of the get()\nmethod\n- makes it possible to use Instance<> to lazily fetch a dependent bean\nand reuse the instance for subsequent get() invocations", "committedDate": "2020-07-01T09:10:12Z", "type": "commit"}, {"oid": "e623c75a04e140d32cf344fe11c3463732467664", "url": "https://github.com/quarkusio/quarkus/commit/e623c75a04e140d32cf344fe11c3463732467664", "message": "ArC - introduce WichCaching annotation\n\n- that instructs an injected Instance<> to cache the result of the get()\nmethod\n- makes it possible to use Instance<> to lazily fetch a dependent bean\nand reuse the instance for subsequent get() invocations", "committedDate": "2020-07-01T09:10:12Z", "type": "forcePushed"}]}