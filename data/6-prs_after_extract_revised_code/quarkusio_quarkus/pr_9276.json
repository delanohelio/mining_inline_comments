{"pr_number": 9276, "pr_title": "Use /version when checking Kubernetes API server", "pr_createdAt": "2020-05-13T18:12:15Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9276", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0MjY2OQ==", "url": "https://github.com/quarkusio/quarkus/pull/9276#discussion_r424642669", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        //Let's check id we can connect.\n          \n          \n            \n                        //Let's check if we can connect.\n          \n      \n    \n    \n  \n\nwhile we're at it.", "author": "gsmet", "createdAt": "2020-05-13T18:23:51Z", "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java", "diffHunk": "@@ -69,7 +69,7 @@ private Result doCheck() {\n         try {\n             masterURL = client.getConfiguration().getMasterUrl();\n             //Let's check id we can connect.", "originalCommit": "ac68768c1460af4eb4f7f706572b7cfed9511107", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0MzUyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/9276#discussion_r424643521", "bodyText": "Fixed", "author": "geoand", "createdAt": "2020-05-13T18:25:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0MjY2OQ=="}], "type": "inlineReview", "revised_code": {"commit": "abaf8d64bbff7c1db7326264c1aa50e20087ae88", "chunk": "diff --git a/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java b/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java\nindex f7fb1add66..4fef420d09 100644\n--- a/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java\n+++ b/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java\n\n@@ -68,7 +68,7 @@ public class KubernetesDeploy {\n         String masterURL = client.getConfiguration().getMasterUrl();\n         try {\n             masterURL = client.getConfiguration().getMasterUrl();\n-            //Let's check id we can connect.\n+            //Let's check if we can connect.\n             client.getVersion();\n             log.info(\"Kubernetes API Server at '\" + masterURL + \"' successfully contacted.\");\n             serverFound = true;\n"}}, {"oid": "abaf8d64bbff7c1db7326264c1aa50e20087ae88", "url": "https://github.com/quarkusio/quarkus/commit/abaf8d64bbff7c1db7326264c1aa50e20087ae88", "message": "Use /version when checking Kubernetes API server", "committedDate": "2020-05-13T18:25:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0OTUzOQ==", "url": "https://github.com/quarkusio/quarkus/pull/9276#discussion_r424649539", "bodyText": "Show the version returned above here \ud83d\ude09", "author": "gastaldi", "createdAt": "2020-05-13T18:35:12Z", "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java", "diffHunk": "@@ -68,8 +68,8 @@ private Result doCheck() {\n         String masterURL = client.getConfiguration().getMasterUrl();\n         try {\n             masterURL = client.getConfiguration().getMasterUrl();\n-            //Let's check id we can connect.\n-            RootPaths paths = client.rootPaths();\n+            //Let's check if we can connect.\n+            client.getVersion();\n             log.info(\"Kubernetes API Server at '\" + masterURL + \"' successfully contacted.\");", "originalCommit": "abaf8d64bbff7c1db7326264c1aa50e20087ae88", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY1MDYyMg==", "url": "https://github.com/quarkusio/quarkus/pull/9276#discussion_r424650622", "bodyText": "We could do that, but maybe it's a little to verbose?", "author": "geoand", "createdAt": "2020-05-13T18:37:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0OTUzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY1MzE3Mg==", "url": "https://github.com/quarkusio/quarkus/pull/9276#discussion_r424653172", "bodyText": "Maybe, perhaps it should be shown in a log.debug instead", "author": "gastaldi", "createdAt": "2020-05-13T18:41:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0OTUzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY1NjY5OA==", "url": "https://github.com/quarkusio/quarkus/pull/9276#discussion_r424656698", "bodyText": "Done", "author": "geoand", "createdAt": "2020-05-13T18:47:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0OTUzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "cdb06e3d5d24c0e20a0ac50f60aba42cad52ee83", "chunk": "diff --git a/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java b/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java\nindex 4fef420d09..a9fec4e9b1 100644\n--- a/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java\n+++ b/extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesDeploy.java\n\n@@ -69,8 +69,9 @@ public class KubernetesDeploy {\n         try {\n             masterURL = client.getConfiguration().getMasterUrl();\n             //Let's check if we can connect.\n-            client.getVersion();\n+            VersionInfo version = client.getVersion();\n             log.info(\"Kubernetes API Server at '\" + masterURL + \"' successfully contacted.\");\n+            log.debugf(\"Kubernetes Version: %s.%s\", version.getMajor(), version.getMinor());\n             serverFound = true;\n             client.close();\n             return Result.enabled();\n"}}, {"oid": "cdb06e3d5d24c0e20a0ac50f60aba42cad52ee83", "url": "https://github.com/quarkusio/quarkus/commit/cdb06e3d5d24c0e20a0ac50f60aba42cad52ee83", "message": "Use /version when checking Kubernetes API server", "committedDate": "2020-05-13T18:47:13Z", "type": "commit"}, {"oid": "cdb06e3d5d24c0e20a0ac50f60aba42cad52ee83", "url": "https://github.com/quarkusio/quarkus/commit/cdb06e3d5d24c0e20a0ac50f60aba42cad52ee83", "message": "Use /version when checking Kubernetes API server", "committedDate": "2020-05-13T18:47:13Z", "type": "forcePushed"}]}