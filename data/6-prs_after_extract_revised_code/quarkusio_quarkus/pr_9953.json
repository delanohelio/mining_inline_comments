{"pr_number": 9953, "pr_title": "A lot of devtools-common important fixes", "pr_createdAt": "2020-06-11T13:53:55Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9953", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgxODk5Nw==", "url": "https://github.com/quarkusio/quarkus/pull/9953#discussion_r438818997", "bodyText": "Folder? Is that a Windows jargon? :) I think all the Java API I've seen uses \"directory\" or \"dir\".", "author": "aloubyansky", "createdAt": "2020-06-11T14:14:56Z", "path": "independent-projects/tools/devtools-common/src/main/java/io/quarkus/devtools/project/compress/QuarkusProjectCompress.java", "diffHunk": "@@ -17,34 +16,33 @@\n \n public final class QuarkusProjectCompress {\n \n-    private static final List<String> EXECUTABLES = ImmutableList.of(\n+    private static final List<String> EXECUTABLES = Collections.unmodifiableList(Arrays.asList(\n             \"gradlew\",\n             \"gradlew.bat\",\n             \"mvnw\",\n-            \"mvnw.bat\");\n+            \"mvnw.bat\"));\n \n-    @VisibleForTesting\n+    // Visible for testing\n     static final int DIR_UNIX_MODE = UnixStat.DIR_FLAG | UnixStat.DEFAULT_DIR_PERM;\n \n     private QuarkusProjectCompress() {\n     }\n \n-    public static void zip(final QuarkusProject quarkusProject, final Path targetZipPath, final boolean includeProjectFolder)\n+    public static void zip(final Path quarkusProjectFolderPath, final Path targetZipPath, final boolean includeProjectFolder)", "originalCommit": "7f3e4b81dd8821517623de87b86f8ddfcbd64323", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgyNDU5MQ==", "url": "https://github.com/quarkusio/quarkus/pull/9953#discussion_r438824591", "bodyText": "oh boy, I've used folder at many places \ud83d\ude2c\nlet me rename it all \ud83d\ude05", "author": "ia3andy", "createdAt": "2020-06-11T14:23:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgxODk5Nw=="}], "type": "inlineReview", "revised_code": {"commit": "fc55110671bd612d4b1da918fcc756b03ef5fa77", "chunk": "diff --git a/independent-projects/tools/devtools-common/src/main/java/io/quarkus/devtools/project/compress/QuarkusProjectCompress.java b/independent-projects/tools/common/src/main/java/io/quarkus/devtools/project/compress/QuarkusProjectCompress.java\nsimilarity index 83%\nrename from independent-projects/tools/devtools-common/src/main/java/io/quarkus/devtools/project/compress/QuarkusProjectCompress.java\nrename to independent-projects/tools/common/src/main/java/io/quarkus/devtools/project/compress/QuarkusProjectCompress.java\nindex b4dab3fa4d..493884309a 100644\n--- a/independent-projects/tools/devtools-common/src/main/java/io/quarkus/devtools/project/compress/QuarkusProjectCompress.java\n+++ b/independent-projects/tools/common/src/main/java/io/quarkus/devtools/project/compress/QuarkusProjectCompress.java\n\n@@ -28,21 +29,22 @@ public final class QuarkusProjectCompress {\n     private QuarkusProjectCompress() {\n     }\n \n-    public static void zip(final Path quarkusProjectFolderPath, final Path targetZipPath, final boolean includeProjectFolder)\n+    public static void zip(final QuarkusProject quarkusProject, final Path targetZipPath, final boolean includeProjectFolder)\n             throws IOException {\n-        zip(quarkusProjectFolderPath, targetZipPath, includeProjectFolder, null);\n+        zip(quarkusProject, targetZipPath, includeProjectFolder, null);\n     }\n \n-    public static void zip(final Path quarkusProjectFolderPath, final Path targetZipPath, final boolean includeProjectFolder,\n+    public static void zip(final QuarkusProject quarkusProject, final Path targetZipPath, final boolean includeProjectFolder,\n             final Long withSpecificFilesTime) throws IOException {\n         try (final ZipArchiveOutputStream zaos = new ZipArchiveOutputStream(Files.newOutputStream(targetZipPath))) {\n-            Files.walk(quarkusProjectFolderPath)\n-                    .filter((path) -> includeProjectFolder || !quarkusProjectFolderPath.equals(path))\n+            final Path projectFolderPath = quarkusProject.getProjectFolderPath();\n+            Files.walk(projectFolderPath)\n+                    .filter((path) -> includeProjectFolder || !projectFolderPath.equals(path))\n                     .forEach((path) -> {\n                         try {\n-                            String entryName = quarkusProjectFolderPath.relativize(path).toString().replace('\\\\', '/');\n+                            String entryName = projectFolderPath.relativize(path).toString().replace('\\\\', '/');\n                             if (includeProjectFolder) {\n-                                entryName = quarkusProjectFolderPath.getFileName() + \"/\" + entryName;\n+                                entryName = projectFolderPath.getFileName() + \"/\" + entryName;\n                             }\n                             int unixMode;\n                             if (Files.isDirectory(path)) {\n"}}, {"oid": "fc55110671bd612d4b1da918fcc756b03ef5fa77", "url": "https://github.com/quarkusio/quarkus/commit/fc55110671bd612d4b1da918fcc756b03ef5fa77", "message": "Remove Guava usage\nUse requireNonNull instead of checkNotNull, and ArrayList as builder.", "committedDate": "2020-06-11T15:17:19Z", "type": "commit"}, {"oid": "b7fc01bc36b1629c17e504f62c9f1c127acc00cc", "url": "https://github.com/quarkusio/quarkus/commit/b7fc01bc36b1629c17e504f62c9f1c127acc00cc", "message": "Use folder Path instead of QuarkusProject in QuarkusProjectCompress#zip", "committedDate": "2020-06-11T15:17:19Z", "type": "commit"}, {"oid": "f62f32ce6e97dd03129c1cc250175429d14a8e3d", "url": "https://github.com/quarkusio/quarkus/commit/f62f32ce6e97dd03129c1cc250175429d14a8e3d", "message": "Remove wrongly named common folder to devtools-common", "committedDate": "2020-06-11T15:17:20Z", "type": "commit"}, {"oid": "88514c98b47a9a328396988ae1edf1670243bb97", "url": "https://github.com/quarkusio/quarkus/commit/88514c98b47a9a328396988ae1edf1670243bb97", "message": "Fix bug where add/remove extension query parsing doesn't work without version", "committedDate": "2020-06-11T15:17:20Z", "type": "commit"}, {"oid": "6d4857b9b996fa8576a4a6bf3f1614815568dcb7", "url": "https://github.com/quarkusio/quarkus/commit/6d4857b9b996fa8576a4a6bf3f1614815568dcb7", "message": "Fix QuarkusProjectCompress when including parent directory", "committedDate": "2020-06-11T15:17:20Z", "type": "commit"}, {"oid": "c9c214ea1c8f91ef39f9cf60fc24d13b909f4e36", "url": "https://github.com/quarkusio/quarkus/commit/c9c214ea1c8f91ef39f9cf60fc24d13b909f4e36", "message": "Fix wrong assignement in AppArtifactCoords constructor", "committedDate": "2020-06-11T15:17:20Z", "type": "commit"}, {"oid": "aa5127d55fe223d40125845945af89875c06154e", "url": "https://github.com/quarkusio/quarkus/commit/aa5127d55fe223d40125845945af89875c06154e", "message": "Rename projectFolderPath to projectDirPath", "committedDate": "2020-06-11T15:17:20Z", "type": "commit"}, {"oid": "aa5127d55fe223d40125845945af89875c06154e", "url": "https://github.com/quarkusio/quarkus/commit/aa5127d55fe223d40125845945af89875c06154e", "message": "Rename projectFolderPath to projectDirPath", "committedDate": "2020-06-11T15:17:20Z", "type": "forcePushed"}]}