{"pr_number": 7638, "pr_title": "Gradle: don't rely on presence of the JavaPlugin.JAR_TASK_NAME", "pr_createdAt": "2020-03-06T11:50:07Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7638", "timeline": [{"oid": "2c62b5f1cd6943cebc4437c6270391c87356bd09", "url": "https://github.com/quarkusio/quarkus/commit/2c62b5f1cd6943cebc4437c6270391c87356bd09", "message": "Gradle: don't rely on presence of the JavaPlugin.JAR_TASK_NAME in a local project dependency", "committedDate": "2020-03-06T11:49:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3Nzc3Mg==", "url": "https://github.com/quarkusio/quarkus/pull/7638#discussion_r388877772", "bodyText": "Better project.getLogger().debug(...) this exception, just in case", "author": "gastaldi", "createdAt": "2020-03-06T12:34:08Z", "path": "devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java", "diffHunk": "@@ -141,10 +142,14 @@ private void afterEvaluate(Project project) {\n     }\n \n     private void configProjectDependency(Project project, Project dep) {\n-        project.getLogger().debug(\"Configuring %s task dependencies on %s tasks\", project, dep);\n-        final Task quarkusBuild = project.getTasks().findByName(QUARKUS_BUILD_TASK_NAME);\n-        final Task jarTask = dep.getTasks().getByName(JavaPlugin.JAR_TASK_NAME);\n-        quarkusBuild.dependsOn(jarTask);\n-        extension.addProjectDepJarTask(dep, jarTask);\n+        try {\n+            final Task quarkusBuild = project.getTasks().findByName(QUARKUS_BUILD_TASK_NAME);\n+            final Task jarTask = dep.getTasks().getByName(JavaPlugin.JAR_TASK_NAME);\n+            project.getLogger().debug(\"Configuring %s task dependencies on %s tasks\", project, dep);\n+            quarkusBuild.dependsOn(jarTask);\n+            extension.addProjectDepJarTask(dep, jarTask);\n+        } catch (UnknownTaskException e) {\n+            // expected tasks aren't present", "originalCommit": "2c62b5f1cd6943cebc4437c6270391c87356bd09", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "329672022b434996ee1545358b89111075dde042", "chunk": "diff --git a/devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java b/devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java\nindex 60c8200f6a..a5015c420e 100644\n--- a/devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java\n+++ b/devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java\n\n@@ -136,20 +136,22 @@ public class QuarkusPlugin implements Plugin<Project> {\n                 .getIncoming().getDependencies()\n                 .forEach(d -> {\n                     if (d instanceof ProjectDependency) {\n-                        configProjectDependency(project, project.getRootProject().findProject(d.getName()));\n+                        configProjectDependency(project, ((ProjectDependency) d).getDependencyProject());\n                     }\n                 });\n     }\n \n     private void configProjectDependency(Project project, Project dep) {\n         try {\n-            final Task quarkusBuild = project.getTasks().findByName(QUARKUS_BUILD_TASK_NAME);\n             final Task jarTask = dep.getTasks().getByName(JavaPlugin.JAR_TASK_NAME);\n+            final Task quarkusBuild = project.getTasks().findByName(QUARKUS_BUILD_TASK_NAME);\n             project.getLogger().debug(\"Configuring %s task dependencies on %s tasks\", project, dep);\n-            quarkusBuild.dependsOn(jarTask);\n+            if (quarkusBuild != null) {\n+                quarkusBuild.dependsOn(jarTask);\n+            }\n             extension.addProjectDepJarTask(dep, jarTask);\n         } catch (UnknownTaskException e) {\n-            // expected tasks aren't present\n+            project.getLogger().debug(\"Expected tasks not present\", e);\n         }\n     }\n }\n"}}, {"oid": "329672022b434996ee1545358b89111075dde042", "url": "https://github.com/quarkusio/quarkus/commit/329672022b434996ee1545358b89111075dde042", "message": "Minor changes", "committedDate": "2020-03-06T12:44:40Z", "type": "commit"}]}