{"pr_number": 9190, "pr_title": "Ignore BigDecimal and BigInteger reflection hierarchy warnings", "pr_createdAt": "2020-05-09T15:38:57Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/9190", "timeline": [{"oid": "1fb98be7d6cd3702acb7eca73013ad39fd5eab8f", "url": "https://github.com/quarkusio/quarkus/commit/1fb98be7d6cd3702acb7eca73013ad39fd5eab8f", "message": "Ignore BigDecimal and BigInteger reflection hierarchy warnings\n\nThese classes are never part of the Jandex index so there\nis not point in warning about them.\n\nFixes: #9189", "committedDate": "2020-05-09T15:46:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg4MDc0Mw==", "url": "https://github.com/quarkusio/quarkus/pull/9190#discussion_r422880743", "bodyText": "then the ensure?", "author": "gsmet", "createdAt": "2020-05-11T08:44:47Z", "path": "core/deployment/src/main/java/io/quarkus/deployment/steps/ReflectiveHierarchyStep.java", "diffHunk": "@@ -82,9 +74,26 @@ public void build() throws Exception {\n         }\n     }\n \n-    private void addReflectiveHierarchy(ReflectiveHierarchyBuildItem reflectiveHierarchyBuildItem, Type type,\n+    private void removeIgnored(Set<DotName> unindexedClasses, List<ReflectiveHierarchyIgnoreWarningBuildItem> ignored) {\n+        if (ignored.isEmpty()) {\n+            return;\n+        }\n+        Set<DotName> ignoredWarnings = new HashSet<>();\n+        // if at least one of the predicates indicates that warning should be ignored, then the ensure that it is ignored", "originalCommit": "1fb98be7d6cd3702acb7eca73013ad39fd5eab8f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg4ODQzMg==", "url": "https://github.com/quarkusio/quarkus/pull/9190#discussion_r422888432", "bodyText": "Fixed", "author": "geoand", "createdAt": "2020-05-11T08:57:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg4MDc0Mw=="}], "type": "inlineReview", "revised_code": {"commit": "341b54ff25e24a80eb7dc3d2233622b77bbe4ef9", "chunk": "diff --git a/core/deployment/src/main/java/io/quarkus/deployment/steps/ReflectiveHierarchyStep.java b/core/deployment/src/main/java/io/quarkus/deployment/steps/ReflectiveHierarchyStep.java\nindex efde69068a..a8499ee5f2 100644\n--- a/core/deployment/src/main/java/io/quarkus/deployment/steps/ReflectiveHierarchyStep.java\n+++ b/core/deployment/src/main/java/io/quarkus/deployment/steps/ReflectiveHierarchyStep.java\n\n@@ -79,7 +79,7 @@ public class ReflectiveHierarchyStep {\n             return;\n         }\n         Set<DotName> ignoredWarnings = new HashSet<>();\n-        // if at least one of the predicates indicates that warning should be ignored, then the ensure that it is ignored\n+        // the final predicate ignores a DotName if and only if at least one of the predicates indicates that warning should be ignored\n         Predicate<DotName> finalPredicate = ignored.stream().map(ReflectiveHierarchyIgnoreWarningBuildItem::getPredicate)\n                 .reduce(x -> false, Predicate::or);\n         for (DotName unindexedClass : unindexedClasses) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg4MzMzMg==", "url": "https://github.com/quarkusio/quarkus/pull/9190#discussion_r422883332", "bodyText": "Please do that in a separate commit next time. It makes the review far harder than it needs to be.", "author": "gsmet", "createdAt": "2020-05-11T08:49:09Z", "path": "core/deployment/src/main/java/io/quarkus/deployment/steps/ReflectiveHierarchyStep.java", "diffHunk": "@@ -36,23 +34,17 @@\n \n     private static final Logger log = Logger.getLogger(ReflectiveHierarchyStep.class);\n \n-    @Inject\n-    List<ReflectiveHierarchyBuildItem> hierarchy;\n-\n-    @Inject\n-    CombinedIndexBuildItem combinedIndexBuildItem;\n-\n-    @Inject\n-    BuildProducer<ReflectiveClassBuildItem> reflectiveClass;\n-\n-    @Inject\n-    List<ReflectiveHierarchyIgnoreWarningBuildItem> ignored;\n-\n-    @Inject\n-    List<ReflectiveClassFinalFieldsWritablePredicateBuildItem> finalFieldsWritablePredicates;", "originalCommit": "1fb98be7d6cd3702acb7eca73013ad39fd5eab8f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg4NjA3Mg==", "url": "https://github.com/quarkusio/quarkus/pull/9190#discussion_r422886072", "bodyText": "You are absolutely right. I thought of it myself, but I guess I decided against it because I (stupidly) decided it would be best to economize on commits \ud83d\ude06", "author": "geoand", "createdAt": "2020-05-11T08:53:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg4MzMzMg=="}], "type": "inlineReview", "revised_code": null}, {"oid": "341b54ff25e24a80eb7dc3d2233622b77bbe4ef9", "url": "https://github.com/quarkusio/quarkus/commit/341b54ff25e24a80eb7dc3d2233622b77bbe4ef9", "message": "Ignore BigDecimal and BigInteger reflection hierarchy warnings\n\nThese classes are never part of the Jandex index so there\nis not point in warning about them.\n\nFixes: #9189", "committedDate": "2020-05-11T08:57:01Z", "type": "commit"}, {"oid": "341b54ff25e24a80eb7dc3d2233622b77bbe4ef9", "url": "https://github.com/quarkusio/quarkus/commit/341b54ff25e24a80eb7dc3d2233622b77bbe4ef9", "message": "Ignore BigDecimal and BigInteger reflection hierarchy warnings\n\nThese classes are never part of the Jandex index so there\nis not point in warning about them.\n\nFixes: #9189", "committedDate": "2020-05-11T08:57:01Z", "type": "forcePushed"}]}