{"pr_number": 7898, "pr_title": "Support for access log in Vert.x HTTP", "pr_createdAt": "2020-03-17T02:22:23Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7898", "timeline": [{"oid": "e8bcafc03f8b7c8919878a98ee2af12cc80964d9", "url": "https://github.com/quarkusio/quarkus/commit/e8bcafc03f8b7c8919878a98ee2af12cc80964d9", "message": "Support for access log in Vert.x HTTP\n\nFixes #5556", "committedDate": "2020-03-17T04:16:05Z", "type": "forcePushed"}, {"oid": "d46578e04ca93e46ae99ce2c1316edec7d6a5756", "url": "https://github.com/quarkusio/quarkus/commit/d46578e04ca93e46ae99ce2c1316edec7d6a5756", "message": "Support for access log in Vert.x HTTP\n\nFixes #5556", "committedDate": "2020-03-17T05:45:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ5OTE3NQ==", "url": "https://github.com/quarkusio/quarkus/pull/7898#discussion_r393499175", "bodyText": "Can we use DateTimeFormatter.ofPattern instead?", "author": "gastaldi", "createdAt": "2020-03-17T08:01:32Z", "path": "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/attribute/DateTimeAttribute.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * JBoss, Home of Professional Open Source.\n+ * Copyright 2014 Red Hat, Inc., and individual contributors\n+ * as indicated by the @author tags.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+\n+package io.quarkus.vertx.http.runtime.attribute;\n+\n+import java.text.SimpleDateFormat;\n+import java.util.Date;\n+import java.util.Locale;\n+import java.util.TimeZone;\n+\n+import io.vertx.ext.web.RoutingContext;\n+\n+/**\n+ * The current time\n+ *\n+ * @author Stuart Douglas\n+ */\n+public class DateTimeAttribute implements ExchangeAttribute {\n+\n+    private static final String COMMON_LOG_PATTERN = \"[dd/MMM/yyyy:HH:mm:ss Z]\";\n+\n+    private static final ThreadLocal<SimpleDateFormat> COMMON_LOG_PATTERN_FORMAT = new ThreadLocal<SimpleDateFormat>() {", "originalCommit": "d46578e04ca93e46ae99ce2c1316edec7d6a5756", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY0ODY4Ng==", "url": "https://github.com/quarkusio/quarkus/pull/7898#discussion_r393648686", "bodyText": "This is all just copied from Undertow, there are probably lots of things that could be better.", "author": "stuartwdouglas", "createdAt": "2020-03-17T12:39:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ5OTE3NQ=="}], "type": "inlineReview", "revised_code": {"commit": "7b9c1332e6a6df97fa56b9a3f63aee9c8d8a83a4", "chunk": "diff --git a/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/attribute/DateTimeAttribute.java b/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/attribute/DateTimeAttribute.java\nindex 8befa554b4..b3ce6f4083 100644\n--- a/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/attribute/DateTimeAttribute.java\n+++ b/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/attribute/DateTimeAttribute.java\n\n@@ -1,21 +1,3 @@\n-/*\n- * JBoss, Home of Professional Open Source.\n- * Copyright 2014 Red Hat, Inc., and individual contributors\n- * as indicated by the @author tags.\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *     http://www.apache.org/licenses/LICENSE-2.0\n- *\n- *  Unless required by applicable law or agreed to in writing, software\n- *  distributed under the License is distributed on an \"AS IS\" BASIS,\n- *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n package io.quarkus.vertx.http.runtime.attribute;\n \n import java.text.SimpleDateFormat;\n"}}, {"oid": "a7d72294bd4b814f2cf99269bb709a28a813a5aa", "url": "https://github.com/quarkusio/quarkus/commit/a7d72294bd4b814f2cf99269bb709a28a813a5aa", "message": "Support for access log in Vert.x HTTP\n\nFixes #5556", "committedDate": "2020-03-18T00:04:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIyMDMyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/7898#discussion_r397220321", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The access log file name\n          \n          \n            \n                 * The access log file name (set this to log access to a file).\n          \n          \n            \n                 *\n          \n          \n            \n                 * When empty, the standard log mechanism is used to output access logs.\n          \n      \n    \n    \n  \n\nI would find it clearer with this \u2b06\ufe0f", "author": "ia3andy", "createdAt": "2020-03-24T14:59:53Z", "path": "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package io.quarkus.vertx.http.runtime;\n+\n+import java.util.Optional;\n+\n+import io.quarkus.runtime.annotations.ConfigGroup;\n+import io.quarkus.runtime.annotations.ConfigItem;\n+\n+@ConfigGroup\n+public class AccessLogConfig {\n+\n+    /**\n+     * If access logging is enabled\n+     */\n+    @ConfigItem(defaultValue = \"false\")\n+    public boolean enabled;\n+\n+    /**\n+     * The access log pattern:\n+     *\n+     * If this is the string 'common' or 'combined' then this will use one of the specified named formats:\n+     *\n+     * common: %h %l %u %t \"%r\" %s %b\n+     * combined: %h %l %u %t \"%r\" %s %b \"%{i,Referer}\" \"%{i,User-Agent}\"\n+     *\n+     * Otherwise consult the Quarkus documentation for the full list of variables that can be used.\n+     *\n+     */\n+    @ConfigItem(defaultValue = \"common\")\n+    public String pattern;\n+\n+    /**\n+     * The access log file name", "originalCommit": "a7d72294bd4b814f2cf99269bb709a28a813a5aa", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d4328e648645de18178a121bd7b87cdef067837c", "chunk": "diff --git a/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java b/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java\nindex afb0ca217b..9bfe1a8975 100644\n--- a/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java\n+++ b/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java\n\n@@ -9,7 +9,7 @@ import io.quarkus.runtime.annotations.ConfigItem;\n public class AccessLogConfig {\n \n     /**\n-     * If access logging is enabled\n+     * If access logging is enabled. By default this will log via the standard logging facility\n      */\n     @ConfigItem(defaultValue = \"false\")\n     public boolean enabled;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIyMjExNA==", "url": "https://github.com/quarkusio/quarkus/pull/7898#discussion_r397222114", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The log directory to use if the base file name is set.\n          \n          \n            \n                 * The log directory to use when logging access to a file.", "author": "ia3andy", "createdAt": "2020-03-24T15:02:09Z", "path": "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package io.quarkus.vertx.http.runtime;\n+\n+import java.util.Optional;\n+\n+import io.quarkus.runtime.annotations.ConfigGroup;\n+import io.quarkus.runtime.annotations.ConfigItem;\n+\n+@ConfigGroup\n+public class AccessLogConfig {\n+\n+    /**\n+     * If access logging is enabled\n+     */\n+    @ConfigItem(defaultValue = \"false\")\n+    public boolean enabled;\n+\n+    /**\n+     * The access log pattern:\n+     *\n+     * If this is the string 'common' or 'combined' then this will use one of the specified named formats:\n+     *\n+     * common: %h %l %u %t \"%r\" %s %b\n+     * combined: %h %l %u %t \"%r\" %s %b \"%{i,Referer}\" \"%{i,User-Agent}\"\n+     *\n+     * Otherwise consult the Quarkus documentation for the full list of variables that can be used.\n+     *\n+     */\n+    @ConfigItem(defaultValue = \"common\")\n+    public String pattern;\n+\n+    /**\n+     * The access log file name\n+     */\n+    @ConfigItem\n+    public Optional<String> baseFileName;\n+\n+    /**\n+     * The log directory to use if the base file name is set.", "originalCommit": "a7d72294bd4b814f2cf99269bb709a28a813a5aa", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d4328e648645de18178a121bd7b87cdef067837c", "chunk": "diff --git a/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java b/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java\nindex afb0ca217b..9bfe1a8975 100644\n--- a/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java\n+++ b/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/AccessLogConfig.java\n\n@@ -9,7 +9,7 @@ import io.quarkus.runtime.annotations.ConfigItem;\n public class AccessLogConfig {\n \n     /**\n-     * If access logging is enabled\n+     * If access logging is enabled. By default this will log via the standard logging facility\n      */\n     @ConfigItem(defaultValue = \"false\")\n     public boolean enabled;\n"}}, {"oid": "d4328e648645de18178a121bd7b87cdef067837c", "url": "https://github.com/quarkusio/quarkus/commit/d4328e648645de18178a121bd7b87cdef067837c", "message": "Support for access log in Vert.x HTTP\n\nFixes #5556", "committedDate": "2020-03-25T00:13:32Z", "type": "forcePushed"}, {"oid": "7b9c1332e6a6df97fa56b9a3f63aee9c8d8a83a4", "url": "https://github.com/quarkusio/quarkus/commit/7b9c1332e6a6df97fa56b9a3f63aee9c8d8a83a4", "message": "Support for access log in Vert.x HTTP\n\nFixes #5556", "committedDate": "2020-04-06T02:42:14Z", "type": "commit"}, {"oid": "7b9c1332e6a6df97fa56b9a3f63aee9c8d8a83a4", "url": "https://github.com/quarkusio/quarkus/commit/7b9c1332e6a6df97fa56b9a3f63aee9c8d8a83a4", "message": "Support for access log in Vert.x HTTP\n\nFixes #5556", "committedDate": "2020-04-06T02:42:14Z", "type": "forcePushed"}]}