{"pr_number": 7775, "pr_title": "Properly support dependency on a java-library module", "pr_createdAt": "2020-03-11T13:32:42Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7775", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3MzI0Mw==", "url": "https://github.com/quarkusio/quarkus/pull/7775#discussion_r390973243", "bodyText": "Maybe remove this first parameter?", "author": "gastaldi", "createdAt": "2020-03-11T13:35:19Z", "path": "devtools/gradle/src/main/java/io/quarkus/gradle/AppModelGradleResolver.java", "diffHunk": "@@ -306,7 +337,7 @@ static AppDependency toAppDependency(ResolvedArtifact a) {\n         return new AppDependency(appArtifact, \"runtime\");\n     }\n \n-    private Dependency processQuarkusDir(ResolvedArtifact a, Path quarkusDir, AppModel.Builder appBuilder) {\n+    private Dependency processQuarkusDir(Object a, Path quarkusDir, AppModel.Builder appBuilder) {", "originalCommit": "47d3b4b75bea49213667d46adc39dd196c963f36", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NTMxOQ==", "url": "https://github.com/quarkusio/quarkus/pull/7775#discussion_r390975319", "bodyText": "oh, that's a left-over, sure. Thanks.", "author": "aloubyansky", "createdAt": "2020-03-11T13:38:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3MzI0Mw=="}], "type": "inlineReview", "revised_code": {"commit": "33f9fc1abc320f4db87a30717ede7a5672b07696", "chunk": "diff --git a/devtools/gradle/src/main/java/io/quarkus/gradle/AppModelGradleResolver.java b/devtools/gradle/src/main/java/io/quarkus/gradle/AppModelGradleResolver.java\nindex 23a9b5a703..ab4988df38 100644\n--- a/devtools/gradle/src/main/java/io/quarkus/gradle/AppModelGradleResolver.java\n+++ b/devtools/gradle/src/main/java/io/quarkus/gradle/AppModelGradleResolver.java\n\n@@ -337,7 +337,7 @@ public class AppModelGradleResolver implements AppModelResolver {\n         return new AppDependency(appArtifact, \"runtime\");\n     }\n \n-    private Dependency processQuarkusDir(Object a, Path quarkusDir, AppModel.Builder appBuilder) {\n+    private Dependency processQuarkusDir(AppArtifact a, Path quarkusDir, AppModel.Builder appBuilder) {\n         if (!Files.exists(quarkusDir)) {\n             return null;\n         }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3OTA3OA==", "url": "https://github.com/quarkusio/quarkus/pull/7775#discussion_r390979078", "bodyText": "This if is not necessary", "author": "gastaldi", "createdAt": "2020-03-11T13:44:15Z", "path": "devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java", "diffHunk": "@@ -142,16 +143,36 @@ private void afterEvaluate(Project project) {\n     }\n \n     private void configProjectDependency(Project project, Project dep) {\n+        dep.afterEvaluate(p -> {\n+            setupTaskDependencies(project, p);\n+            final Map<String, Project> childProjects = dep.getChildProjects();\n+            if (!childProjects.isEmpty()) {", "originalCommit": "47d3b4b75bea49213667d46adc39dd196c963f36", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "33f9fc1abc320f4db87a30717ede7a5672b07696", "chunk": "diff --git a/devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java b/devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java\nindex b423f66117..875c7cebfd 100644\n--- a/devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java\n+++ b/devtools/gradle/src/main/java/io/quarkus/gradle/QuarkusPlugin.java\n\n@@ -145,11 +145,8 @@ public class QuarkusPlugin implements Plugin<Project> {\n     private void configProjectDependency(Project project, Project dep) {\n         dep.afterEvaluate(p -> {\n             setupTaskDependencies(project, p);\n-            final Map<String, Project> childProjects = dep.getChildProjects();\n-            if (!childProjects.isEmpty()) {\n-                for (Map.Entry<String, Project> entry : childProjects.entrySet()) {\n-                    configProjectDependency(project, entry.getValue());\n-                }\n+            for (Map.Entry<String, Project> entry : dep.getChildProjects().entrySet()) {\n+                configProjectDependency(project, entry.getValue());\n             }\n         });\n     }\n"}}, {"oid": "33f9fc1abc320f4db87a30717ede7a5672b07696", "url": "https://github.com/quarkusio/quarkus/commit/33f9fc1abc320f4db87a30717ede7a5672b07696", "message": "Properly support dependency on a java-library module and collect first-level extension dependencies", "committedDate": "2020-03-11T17:48:07Z", "type": "commit"}, {"oid": "33f9fc1abc320f4db87a30717ede7a5672b07696", "url": "https://github.com/quarkusio/quarkus/commit/33f9fc1abc320f4db87a30717ede7a5672b07696", "message": "Properly support dependency on a java-library module and collect first-level extension dependencies", "committedDate": "2020-03-11T17:48:07Z", "type": "forcePushed"}]}