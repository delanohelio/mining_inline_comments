{"pr_number": 13577, "pr_title": "DevMojo: pick up invoked plugin goal configs from executions", "pr_createdAt": "2020-12-01T08:38:59Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/13577", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwODQ3MA==", "url": "https://github.com/quarkusio/quarkus/pull/13577#discussion_r533708470", "bodyText": "To avoid confusion I would move this to the bottom of this method and rename it to filteredConfig.\nI would also rename dominantConfig to mergedConfig or similar, but your mileage may vary.", "author": "famod", "createdAt": "2020-12-01T20:42:44Z", "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -419,24 +420,40 @@ private void executeIfConfigured(String pluginGroupId, String pluginArtifactId,\n                         version(plugin.getVersion()),\n                         plugin.getDependencies()),\n                 goal(goal),\n-                getPluginConfig(plugin),\n+                getPluginConfig(plugin, goal),\n                 executionEnvironment(\n                         project,\n                         session,\n                         pluginManager));\n     }\n \n-    private Xpp3Dom getPluginConfig(Plugin plugin) {\n-        Xpp3Dom configuration = configuration();\n-        Xpp3Dom pluginConfiguration = (Xpp3Dom) plugin.getConfiguration();\n-        if (pluginConfiguration != null) {\n-            //Filter out `test*` configurations\n-            for (Xpp3Dom child : pluginConfiguration.getChildren()) {\n+    private Xpp3Dom getPluginConfig(Plugin plugin, String goal) {\n+        final Xpp3Dom configuration = configuration();", "originalCommit": "3f1dc8fefbbb1df1487627dc5e586c1a47308424", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcxNjg3OA==", "url": "https://github.com/quarkusio/quarkus/pull/13577#discussion_r533716878", "bodyText": "Ok, thanks, adjusted.", "author": "aloubyansky", "createdAt": "2020-12-01T20:58:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwODQ3MA=="}], "type": "inlineReview", "revised_code": {"commit": "d4250ca24adbe991dadc9eb10cacdc176327837a", "chunk": "diff --git a/devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java b/devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java\nindex 55e06e4919..d39e789955 100644\n--- a/devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java\n+++ b/devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java\n\n@@ -428,26 +428,25 @@ public class DevMojo extends AbstractMojo {\n     }\n \n     private Xpp3Dom getPluginConfig(Plugin plugin, String goal) {\n-        final Xpp3Dom configuration = configuration();\n-\n-        Xpp3Dom dominantConfig = null;\n+        Xpp3Dom mergedConfig = null;\n         if (!plugin.getExecutions().isEmpty()) {\n             for (PluginExecution exec : plugin.getExecutions()) {\n                 if (exec.getConfiguration() != null && exec.getGoals().contains(goal)) {\n-                    dominantConfig = dominantConfig == null ? (Xpp3Dom) exec.getConfiguration()\n-                            : Xpp3Dom.mergeXpp3Dom(dominantConfig, (Xpp3Dom) exec.getConfiguration(), true);\n+                    mergedConfig = mergedConfig == null ? (Xpp3Dom) exec.getConfiguration()\n+                            : Xpp3Dom.mergeXpp3Dom(mergedConfig, (Xpp3Dom) exec.getConfiguration(), true);\n                 }\n             }\n         }\n \n         if ((Xpp3Dom) plugin.getConfiguration() != null) {\n-            dominantConfig = dominantConfig == null ? (Xpp3Dom) plugin.getConfiguration()\n-                    : Xpp3Dom.mergeXpp3Dom(dominantConfig, (Xpp3Dom) plugin.getConfiguration(), true);\n+            mergedConfig = mergedConfig == null ? (Xpp3Dom) plugin.getConfiguration()\n+                    : Xpp3Dom.mergeXpp3Dom(mergedConfig, (Xpp3Dom) plugin.getConfiguration(), true);\n         }\n \n-        if (dominantConfig != null) {\n+        final Xpp3Dom configuration = configuration();\n+        if (mergedConfig != null) {\n             // Filter out `test*` configurations\n-            for (Xpp3Dom child : dominantConfig.getChildren()) {\n+            for (Xpp3Dom child : mergedConfig.getChildren()) {\n                 if (!child.getName().startsWith(\"test\")) {\n                     configuration.addChild(child);\n                 }\n"}}, {"oid": "d4250ca24adbe991dadc9eb10cacdc176327837a", "url": "https://github.com/quarkusio/quarkus/commit/d4250ca24adbe991dadc9eb10cacdc176327837a", "message": "DevMojo: pick up invoked plugin goal configs from executions", "committedDate": "2020-12-01T20:57:21Z", "type": "commit"}, {"oid": "d4250ca24adbe991dadc9eb10cacdc176327837a", "url": "https://github.com/quarkusio/quarkus/commit/d4250ca24adbe991dadc9eb10cacdc176327837a", "message": "DevMojo: pick up invoked plugin goal configs from executions", "committedDate": "2020-12-01T20:57:21Z", "type": "forcePushed"}]}