{"pr_number": 10365, "pr_title": "Fix auth handling in Spring Cloud Config Client", "pr_createdAt": "2020-06-30T08:28:05Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10365", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUwOTIyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/10365#discussion_r447509221", "bodyText": "Maybe we could have a message here?", "author": "gsmet", "createdAt": "2020-06-30T08:33:24Z", "path": "extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java", "diffHunk": "@@ -30,57 +34,74 @@\n             .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n \n     private final SpringCloudConfigClientConfig springCloudConfigClientConfig;\n-    private final String baseUri;\n+    private final URI baseURI;\n \n     public DefaultSpringCloudConfigClientGateway(SpringCloudConfigClientConfig springCloudConfigClientConfig) {\n         this.springCloudConfigClientConfig = springCloudConfigClientConfig;\n-        this.baseUri = determineBaseUri(springCloudConfigClientConfig);\n+        try {\n+            this.baseURI = determineBaseUri(springCloudConfigClientConfig);\n+        } catch (URISyntaxException e) {\n+            throw new RuntimeException(e);", "originalCommit": "c88de6da48b85b26a802f4f0ac3ce6cbd03f1a0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyODQ2Mw==", "url": "https://github.com/quarkusio/quarkus/pull/10365#discussion_r447528463", "bodyText": "Sure", "author": "geoand", "createdAt": "2020-06-30T09:02:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUwOTIyMQ=="}], "type": "inlineReview", "revised_code": {"commit": "f1b9dd401ef598ec94e583e275473330eaec42ac", "chunk": "diff --git a/extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java b/extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java\nindex 661776753e..12bc0949b9 100644\n--- a/extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java\n+++ b/extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java\n\n@@ -41,14 +41,16 @@ class DefaultSpringCloudConfigClientGateway implements SpringCloudConfigClientGa\n         try {\n             this.baseURI = determineBaseUri(springCloudConfigClientConfig);\n         } catch (URISyntaxException e) {\n-            throw new RuntimeException(e);\n+            throw new IllegalArgumentException(\"Value: '\" + springCloudConfigClientConfig.url\n+                    + \"' of property 'quarkus.spring-cloud-config.url' is invalid\", e);\n         }\n     }\n \n     private URI determineBaseUri(SpringCloudConfigClientConfig springCloudConfigClientConfig) throws URISyntaxException {\n         String url = springCloudConfigClientConfig.url;\n         if (null == url || url.isEmpty()) {\n-            throw new IllegalArgumentException(\"baseUrl cannot be empty\");\n+            throw new IllegalArgumentException(\n+                    \"The 'quarkus.spring-cloud-config.url' property cannot be empty\");\n         }\n         if (url.endsWith(\"/\")) {\n             return new URI(url.substring(0, url.length() - 1));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUwOTU3Ng==", "url": "https://github.com/quarkusio/quarkus/pull/10365#discussion_r447509576", "bodyText": "I would make the message more explicit by adding some context (typically which extension or the full property name)?", "author": "gsmet", "createdAt": "2020-06-30T08:33:54Z", "path": "extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java", "diffHunk": "@@ -30,57 +34,74 @@\n             .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n \n     private final SpringCloudConfigClientConfig springCloudConfigClientConfig;\n-    private final String baseUri;\n+    private final URI baseURI;\n \n     public DefaultSpringCloudConfigClientGateway(SpringCloudConfigClientConfig springCloudConfigClientConfig) {\n         this.springCloudConfigClientConfig = springCloudConfigClientConfig;\n-        this.baseUri = determineBaseUri(springCloudConfigClientConfig);\n+        try {\n+            this.baseURI = determineBaseUri(springCloudConfigClientConfig);\n+        } catch (URISyntaxException e) {\n+            throw new RuntimeException(e);\n+        }\n     }\n \n-    private String determineBaseUri(SpringCloudConfigClientConfig springCloudConfigClientConfig) {\n-        String baseUri = springCloudConfigClientConfig.url;\n-        if (null == baseUri || baseUri.isEmpty()) {\n-            throw new IllegalArgumentException(\"baseUri cannot be empty\");\n+    private URI determineBaseUri(SpringCloudConfigClientConfig springCloudConfigClientConfig) throws URISyntaxException {\n+        String url = springCloudConfigClientConfig.url;\n+        if (null == url || url.isEmpty()) {\n+            throw new IllegalArgumentException(\"baseUrl cannot be empty\");", "originalCommit": "c88de6da48b85b26a802f4f0ac3ce6cbd03f1a0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyODQzMg==", "url": "https://github.com/quarkusio/quarkus/pull/10365#discussion_r447528432", "bodyText": "Right, that makes sense", "author": "geoand", "createdAt": "2020-06-30T09:02:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUwOTU3Ng=="}], "type": "inlineReview", "revised_code": {"commit": "f1b9dd401ef598ec94e583e275473330eaec42ac", "chunk": "diff --git a/extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java b/extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java\nindex 661776753e..12bc0949b9 100644\n--- a/extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java\n+++ b/extensions/spring-cloud-config-client/runtime/src/main/java/io/quarkus/spring/cloud/config/client/runtime/DefaultSpringCloudConfigClientGateway.java\n\n@@ -41,14 +41,16 @@ class DefaultSpringCloudConfigClientGateway implements SpringCloudConfigClientGa\n         try {\n             this.baseURI = determineBaseUri(springCloudConfigClientConfig);\n         } catch (URISyntaxException e) {\n-            throw new RuntimeException(e);\n+            throw new IllegalArgumentException(\"Value: '\" + springCloudConfigClientConfig.url\n+                    + \"' of property 'quarkus.spring-cloud-config.url' is invalid\", e);\n         }\n     }\n \n     private URI determineBaseUri(SpringCloudConfigClientConfig springCloudConfigClientConfig) throws URISyntaxException {\n         String url = springCloudConfigClientConfig.url;\n         if (null == url || url.isEmpty()) {\n-            throw new IllegalArgumentException(\"baseUrl cannot be empty\");\n+            throw new IllegalArgumentException(\n+                    \"The 'quarkus.spring-cloud-config.url' property cannot be empty\");\n         }\n         if (url.endsWith(\"/\")) {\n             return new URI(url.substring(0, url.length() - 1));\n"}}, {"oid": "f1b9dd401ef598ec94e583e275473330eaec42ac", "url": "https://github.com/quarkusio/quarkus/commit/f1b9dd401ef598ec94e583e275473330eaec42ac", "message": "Fix auth handling in Spring Cloud Config Client\n\nFixes: #10350", "committedDate": "2020-06-30T09:02:30Z", "type": "commit"}, {"oid": "f1b9dd401ef598ec94e583e275473330eaec42ac", "url": "https://github.com/quarkusio/quarkus/commit/f1b9dd401ef598ec94e583e275473330eaec42ac", "message": "Fix auth handling in Spring Cloud Config Client\n\nFixes: #10350", "committedDate": "2020-06-30T09:02:30Z", "type": "forcePushed"}]}